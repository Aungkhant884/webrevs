{"files":[{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2015, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2015, 2021 Oracle and\/or its affiliates. All rights reserved.\n@@ -39,1 +39,1 @@\n-    private static boolean done;\n+    private static Robot robot = null;\n@@ -42,6 +42,0 @@\n-        synchronized (this) {\n-            if (done) {\n-                return;\n-            }\n-        }\n-\n@@ -67,3 +61,9 @@\n-        synchronized (this) {\n-            done = true;\n-            notifyAll();\n+        BufferedImage capture = null;\n+        try {\n+            Thread.sleep(500);\n+            if (robot == null) robot = new Robot();\n+            Point pt1 = getLocationOnScreen();\n+            Rectangle rect = new Rectangle(pt1.x, pt1.y, 400, 400);\n+            capture = robot.createScreenCapture(rect);\n+        } catch (Exception e) {\n+            throw new RuntimeException(\"Problems handling Robot\");\n@@ -71,0 +71,7 @@\n+        \/\/ Test pixels\n+        testRegion(capture, \"green\",          0,   0, 400,  10, 0xff00ff00);\n+        testRegion(capture, \"original red\",   0,  10,  50, 400, 0xffff0000);\n+        testRegion(capture, \"background\",    50,  10,  60, 400, 0xff000000);\n+        testRegion(capture, \"in-between\",    60,  10, 110,  20, 0xff000000);\n+        testRegion(capture, \"copied red\",    60,  20, 110, 400, 0xffff0000);\n+        testRegion(capture, \"background\",   110,  10, 400, 400, 0xff000000);\n@@ -108,11 +115,0 @@\n-        \/\/ Wait until the component's been painted\n-        synchronized (test) {\n-            while (!done) {\n-                try {\n-                    test.wait();\n-                } catch (InterruptedException e) {\n-                    throw new RuntimeException(\"Failed: Interrupted\");\n-                }\n-            }\n-        }\n-\n@@ -120,1 +116,1 @@\n-            Thread.sleep(2000);\n+            Thread.sleep(3000);\n@@ -122,14 +118,2 @@\n-\n-        \/\/ Grab the screen region\n-        BufferedImage capture = null;\n-        try {\n-            Robot robot = new Robot();\n-            Point pt1 = test.getLocationOnScreen();\n-            Rectangle rect = new Rectangle(pt1.x, pt1.y, 400, 400);\n-            capture = robot.createScreenCapture(rect);\n-        } catch (Exception e) {\n-            throw new RuntimeException(\"Problems creating Robot\");\n-        } finally {\n-            if (!show) {\n-                frame.dispose();\n-            }\n+        if (!show) {\n+            frame.dispose();\n@@ -137,8 +121,0 @@\n-\n-        \/\/ Test pixels\n-        testRegion(capture, \"green\",          0,   0, 400,  10, 0xff00ff00);\n-        testRegion(capture, \"original red\",   0,  10,  50, 400, 0xffff0000);\n-        testRegion(capture, \"background\",    50,  10,  60, 400, 0xff000000);\n-        testRegion(capture, \"in-between\",    60,  10, 110,  20, 0xff000000);\n-        testRegion(capture, \"copied red\",    60,  20, 110, 400, 0xffff0000);\n-        testRegion(capture, \"background\",   110,  10, 400, 400, 0xff000000);\n","filename":"jdk\/test\/sun\/java2d\/OpenGL\/CopyAreaOOB.java","additions":21,"deletions":45,"binary":false,"changes":66,"status":"modified"}]}