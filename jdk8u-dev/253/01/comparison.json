{"files":[{"patch":"@@ -28,6 +28,2 @@\n-import java.util.ArrayList;\n-import java.util.Arrays;\n-import java.util.Collection;\n-import java.util.Collections;\n-import java.util.LinkedList;\n-import java.util.List;\n+import java.util.*;\n+\n@@ -877,0 +873,33 @@\n+    private static final Map<Integer, CipherSuite> cipherSuiteIds;\n+    private static final Map<String, CipherSuite> cipherSuiteNames;\n+    private static final List<CipherSuite> allowedCipherSuites;\n+    private static final List<CipherSuite> defaultCipherSuites;\n+\n+    static {\n+        Map<Integer, CipherSuite> ids = new HashMap<>();\n+        Map<String, CipherSuite> names = new HashMap<>();\n+        List<CipherSuite> allowedCS = new ArrayList<>();\n+        List<CipherSuite> defaultCS = new ArrayList<>();\n+\n+        for(CipherSuite cs : CipherSuite.values()) {\n+            ids.put(cs.id, cs);\n+            names.put(cs.name, cs);\n+            for (String alias : cs.aliases) {\n+                names.put(alias, cs);\n+            }\n+\n+            if (!cs.supportedProtocols.isEmpty()) {\n+                allowedCS.add(cs);\n+            }\n+\n+            if (cs.isDefaultEnabled) {\n+                defaultCS.add(cs);\n+            }\n+        }\n+\n+        cipherSuiteIds = Collections.unmodifiableMap(ids);\n+        cipherSuiteNames = Collections.unmodifiableMap(names);\n+        allowedCipherSuites = Collections.unmodifiableList(allowedCS);\n+        defaultCipherSuites = Collections.unmodifiableList(defaultCS);\n+    }\n+\n@@ -914,8 +943,1 @@\n-        for (CipherSuite cs : CipherSuite.values()) {\n-            if (cs.name.equals(ciperSuiteName) ||\n-                    cs.aliases.contains(ciperSuiteName)) {\n-                return cs;\n-            }\n-        }\n-\n-        return null;\n+        return cipherSuiteNames.get(ciperSuiteName);\n@@ -925,7 +947,1 @@\n-        for (CipherSuite cs : CipherSuite.values()) {\n-            if (cs.id == id) {\n-                return cs;\n-            }\n-        }\n-\n-        return null;\n+        return cipherSuiteIds.get(id);\n@@ -935,4 +951,4 @@\n-        for (CipherSuite cs : CipherSuite.values()) {\n-            if (cs.id == id) {\n-                return cs.name;\n-            }\n+        CipherSuite cs = cipherSuiteIds.get(id);\n+\n+        if (cs != null) {\n+            return cs.name;\n@@ -945,11 +961,1 @@\n-        Collection<CipherSuite> cipherSuites = new LinkedList<>();\n-        for (CipherSuite cs : CipherSuite.values()) {\n-            if (!cs.supportedProtocols.isEmpty()) {\n-                cipherSuites.add(cs);\n-            } else {\n-                \/\/ values() is ordered, remaining cipher suites are\n-                \/\/ not supported.\n-                break;\n-            }\n-        }\n-        return cipherSuites;\n+        return allowedCipherSuites;\n@@ -959,11 +965,1 @@\n-        Collection<CipherSuite> cipherSuites = new LinkedList<>();\n-        for (CipherSuite cs : CipherSuite.values()) {\n-            if (cs.isDefaultEnabled) {\n-                cipherSuites.add(cs);\n-            } else {\n-                \/\/ values() is ordered, remaining cipher suites are\n-                \/\/ not enabled.\n-                break;\n-            }\n-        }\n-        return cipherSuites;\n+        return defaultCipherSuites;\n@@ -992,13 +988,5 @@\n-            for (CipherSuite cs : CipherSuite.values()) {\n-                if (!cs.supportedProtocols.isEmpty()) {\n-                    if (cs.name.equals(name) ||\n-                            cs.aliases.contains(name)) {\n-                        cipherSuites.add(cs);\n-                        found = true;\n-                        break;\n-                    }\n-                } else {\n-                    \/\/ values() is ordered, remaining cipher suites are\n-                    \/\/ not supported.\n-                    break;\n-                }\n+            CipherSuite cs;\n+            if ((cs = cipherSuiteNames.get(name)) != null\n+                    && !cs.supportedProtocols.isEmpty()) {\n+                cipherSuites.add(cs);\n+                found = true;\n","filename":"jdk\/src\/share\/classes\/sun\/security\/ssl\/CipherSuite.java","additions":48,"deletions":60,"binary":false,"changes":108,"status":"modified"}]}