{"files":[{"patch":"@@ -3,1 +3,1 @@\n- * Copyright (c) 2008, 2012, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2008, 2021, Oracle and\/or its affiliates. All rights reserved.\n@@ -29,1 +29,0 @@\n- * @author Denis Sharypov\n@@ -32,2 +31,8 @@\n-import java.awt.*;\n-import javax.swing.*;\n+\n+import java.awt.Color;\n+import java.awt.Dimension;\n+import java.awt.Point;\n+import java.awt.Robot;\n+import javax.swing.JFrame;\n+import javax.swing.SwingUtilities;\n+import javax.swing.JLabel;\n@@ -38,0 +43,1 @@\n+    private static JFrame mainFrame;\n@@ -41,1 +47,0 @@\n-        robot.setAutoDelay(50);\n@@ -43,1 +48,2 @@\n-        SwingUtilities.invokeAndWait(new Runnable() {\n+        try {\n+            SwingUtilities.invokeAndWait(new Runnable() {\n@@ -45,5 +51,5 @@\n-            @Override\n-            public void run() {\n-                createAndShowGUI();\n-            }\n-        });\n+                @Override\n+                public void run() {\n+                    createAndShowGUI();\n+                }\n+            });\n@@ -51,1 +57,2 @@\n-        robot.waitForIdle();\n+            robot.waitForIdle();\n+            robot.delay(1000);\n@@ -53,1 +60,1 @@\n-        SwingUtilities.invokeAndWait(new Runnable() {\n+            SwingUtilities.invokeAndWait(new Runnable() {\n@@ -55,3 +62,3 @@\n-            @Override\n-            public void run() {\n-                boolean passed = false;\n+                @Override\n+                public void run() {\n+                    boolean passed = false;\n@@ -59,4 +66,4 @@\n-                Point p = htmlComponent.getLocationOnScreen();\n-                Dimension d = htmlComponent.getSize();\n-                int x0 = p.x;\n-                int y = p.y + d.height \/ 2;\n+                    Point p = htmlComponent.getLocationOnScreen();\n+                    Dimension d = htmlComponent.getSize();\n+                    int x0 = p.x;\n+                    int y = p.y + d.height \/ 2;\n@@ -64,4 +71,5 @@\n-                for (int x = x0; x < x0 + d.width; x++) {\n-                    if (robot.getPixelColor(x, y).equals(Color.blue)) {\n-                        passed = true;\n-                        break;\n+                    for (int x = x0; x < x0 + d.width; x++) {\n+                        if (robot.getPixelColor(x, y).equals(Color.blue)) {\n+                            passed = true;\n+                            break;\n+                        }\n@@ -69,1 +77,0 @@\n-                }\n@@ -71,3 +78,3 @@\n-                if (!passed) {\n-                    throw new RuntimeException(\"Test failed.\");\n-                }\n+                    if (!passed) {\n+                        throw new RuntimeException(\"Test failed.\");\n+                    }\n@@ -75,2 +82,9 @@\n-            }\n-        });\n+                }\n+            });\n+        } finally {\n+            SwingUtilities.invokeAndWait(() -> {\n+                if (mainFrame != null) {\n+                    mainFrame.dispose();\n+                }\n+            });\n+        }\n@@ -88,1 +102,1 @@\n-        JFrame mainFrame = new JFrame(\"bug4251579\");\n+        mainFrame = new JFrame(\"bug4251579\");\n@@ -94,0 +108,1 @@\n+        mainFrame.setLocationRelativeTo(null);\n","filename":"jdk\/test\/javax\/swing\/plaf\/basic\/BasicHTML\/4251579\/bug4251579.java","additions":46,"deletions":31,"binary":false,"changes":77,"status":"modified"}]}