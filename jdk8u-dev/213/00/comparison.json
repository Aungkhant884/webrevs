{"files":[{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2004, 2013, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2004, 2020, Oracle and\/or its affiliates. All rights reserved.\n@@ -58,0 +58,2 @@\n+    public static final String INVALID_JMXREMOTE_LOCAL_PORT =\n+        \"agent.err.invalid.jmxremote.local.port\";\n","filename":"jdk\/src\/share\/classes\/sun\/management\/AgentConfigurationError.java","additions":3,"deletions":1,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2003, 2016, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2003, 2020, Oracle and\/or its affiliates. All rights reserved.\n@@ -120,0 +120,2 @@\n+        public static final String LOCAL_PORT =\n+                \"com.sun.management.jmxremote.local.port\";\n@@ -534,0 +536,2 @@\n+\n+        Properties props = null;\n@@ -535,3 +539,1 @@\n-            JMXServiceURL url = new JMXServiceURL(\"rmi\", localhost, 0);\n-            \/\/ Do we accept connections from local interfaces only?\n-            Properties props = Agent.getManagementProperties();\n+            props = Agent.getManagementProperties();\n@@ -541,0 +543,22 @@\n+        } catch (Exception e) {\n+            throw new AgentConfigurationError(AGENT_EXCEPTION, e, e.toString());\n+        }\n+\n+        \/\/ User can specify a port to be used to start local connector server.\n+        \/\/ Random one will be allocated if port is not specified.\n+        int localPort = 0;\n+        String localPortStr = props.getProperty(PropertyNames.LOCAL_PORT);\n+        try {\n+            if (localPortStr != null) {\n+                localPort = Integer.parseInt(localPortStr);\n+            }\n+        } catch (NumberFormatException x) {\n+            throw new AgentConfigurationError(INVALID_JMXREMOTE_LOCAL_PORT, x, localPortStr);\n+        }\n+        if (localPort < 0) {\n+            throw new AgentConfigurationError(INVALID_JMXREMOTE_LOCAL_PORT, localPortStr);\n+        }\n+\n+        try {\n+            JMXServiceURL url = new JMXServiceURL(\"rmi\", localhost, localPort);\n+            \/\/ Do we accept connections from local interfaces only?\n","filename":"jdk\/src\/share\/classes\/sun\/management\/jmxremote\/ConnectorBootstrap.java","additions":28,"deletions":4,"binary":false,"changes":32,"status":"modified"},{"patch":"@@ -29,0 +29,2 @@\n+# For setting the JMX local server port use the following line\n+# com.sun.management.jmxremote.local.port=<port-number>\n","filename":"jdk\/src\/share\/lib\/management\/management.properties","additions":2,"deletions":0,"binary":false,"changes":2,"status":"modified"}]}