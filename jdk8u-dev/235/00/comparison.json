{"files":[{"patch":"@@ -46,1 +46,1 @@\n- * @run main\/native jdk.jfr.event.sampling.TestNative\n+ * @run shell TestNative.sh\n","filename":"jdk\/test\/jdk\/jfr\/event\/sampling\/TestNative.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -0,0 +1,63 @@\n+#!\/bin\/bash\n+\n+set -ex\n+\n+OS=`uname -s`\n+if [  \"${OS}\" != \"Linux\" -a \"${OS}\" != \"Darwin\" ]; then\n+    echo \"This is a Linux\/MacOSX only test\"\n+    exit 0;\n+fi\n+\n+if [ \"x$TESTGCC\" = \"x\" ]; then\n+  TESTGCC=$(readlink -f $(which gcc))\n+fi\n+\n+if [ \"x$TESTGCC\" = \"x\" ]; then\n+  echo \"WARNING: gcc not found. Cannot execute test.\" 2>&1\n+  exit 1;\n+fi\n+\n+if [ \"x$TESTROOT\" = \"x\" ]; then\n+  echo \"TESTROOT pointintg to top level sources is not set. that is fatal\"\n+  exit 2;\n+fi\n+\n+if [ \"x$TESTJAVA\" = \"x\" ]; then\n+  TESTJAVA=$(dirname $(dirname $(readlink -f $(which java))))\n+fi\n+\n+JDK_TOPDIR=\"${TESTROOT}\/..\"\n+JAVAC=\"${TESTJAVA}\/bin\/javac\"\n+JAVA=\"${TESTJAVA}\/bin\/java\"\n+TEST_ENV_SH=\"${JDK_TOPDIR}\/..\/hotspot\/test\/test_env.sh\"\n+\n+ls -l \"${TEST_ENV_SH}\"\n+set +e\n+  source \"${TEST_ENV_SH}\"\n+set -e\n+\n+\"${TESTGCC}\" \\\n+    -shared \\\n+    ${CFLAGBITS} \\\n+    -o ${TESTCLASSES}\/libTestNative.so \\\n+    -I${JDK_TOPDIR}\/src\/share\/bin \\\n+    -I${JDK_TOPDIR}\/src\/share\/javavm\/export \\\n+    -I${JDK_TOPDIR}\/src\/macosx\/javavm\/export \\\n+    -I${JDK_TOPDIR}\/src\/solaris\/bin \\\n+    ${TESTSRC}\/libTestNative.c\n+\n+\"${JAVAC}\" -d ${TESTCLASSES} \\\n+           ${TESTROOT}\/lib\/jdk\/test\/lib\/Utils.java \\\n+           ${TESTROOT}\/lib\/jdk\/test\/lib\/JDKToolLauncher.java \\\n+           ${TESTROOT}\/lib\/jdk\/test\/lib\/Platform.java \\\n+           ${TESTROOT}\/lib\/jdk\/test\/lib\/Asserts.java \\\n+           ${TESTROOT}\/lib\/jdk\/test\/lib\/jfr\/EventNames.java \\\n+           ${TESTROOT}\/lib\/jdk\/test\/lib\/JDKToolFinder.java \\\n+           ${TESTROOT}\/lib\/jdk\/test\/lib\/process\/*.java\n+\n+\"${JAVAC}\" -cp ${TESTCLASSPATH}:${TESTCLASSES} -d ${TESTCLASSES} ${TESTSRC}\/TestNative.java\n+\n+\"${JAVA}\"  -Dtest.jdk=${TESTJAVA} \\\n+           -Dtest.nativepath=${TESTCLASSES} \\\n+           -Djava.library.path=${TESTCLASSES} \\\n+           -cp ${TESTCLASSPATH}:${TESTCLASSES} jdk.jfr.event.sampling.TestNative\n","filename":"jdk\/test\/jdk\/jfr\/event\/sampling\/TestNative.sh","additions":63,"deletions":0,"binary":false,"changes":63,"status":"added"}]}