{"files":[{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2003, 2013, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2003, 2021, Oracle and\/or its affiliates. All rights reserved.\n@@ -805,1 +805,2 @@\n-static bool read_exec_segments(struct ps_prochandle* ph, ELF_EHDR* exec_ehdr) {\n+\/\/ returns base address of executable.\n+static uintptr_t read_exec_segments(struct ps_prochandle* ph, ELF_EHDR* exec_ehdr) {\n@@ -809,0 +810,1 @@\n+   uintptr_t result = 0L;\n@@ -811,1 +813,1 @@\n-      return false;\n+      return 0L;\n@@ -842,0 +844,1 @@\n+                result = exec_php->p_vaddr;\n@@ -844,2 +847,1 @@\n-                \/\/ dynamic_addr has entry point of executable.\n-                \/\/ Thus we should substract it.\n+                result = ph->core->dynamic_addr - exec_ehdr->e_entry;\n@@ -857,1 +859,1 @@\n-   return true;\n+   return result;\n@@ -860,1 +862,1 @@\n-   return false;\n+   return 0L;\n@@ -1111,1 +1113,2 @@\n-  if (read_exec_segments(ph, &exec_ehdr) != true) {\n+  uintptr_t exec_base_addr = read_exec_segments(ph, &exec_ehdr);\n+  if (exec_base_addr == 0L) {\n@@ -1114,4 +1117,2 @@\n-\n-  \/\/ exec file is also treated like a shared object for symbol search\n-  if (add_lib_info_fd(ph, exec_file, ph->core->exec_fd,\n-                      (uintptr_t)0 + find_base_address(ph->core->exec_fd, &exec_ehdr)) == NULL) {\n+  print_debug(\"exec_base_addr = 0x%lx\\n\", exec_base_addr);\n+  if (add_lib_info_fd(ph, exec_file, ph->core->exec_fd, exec_base_addr) == NULL) {\n","filename":"hotspot\/agent\/src\/os\/linux\/ps_core.c","additions":13,"deletions":12,"binary":false,"changes":25,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2003, 2012, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2003, 2021, Oracle and\/or its affiliates. All rights reserved.\n@@ -71,1 +71,1 @@\n-      if ( pc.greaterThanOrEqual(base) && pc.lessThan(base.addOffsetTo(size))) {\n+      if (pc.greaterThanOrEqual(base) && pc.lessThan(base.addOffsetTo(size))) {\n","filename":"hotspot\/agent\/src\/share\/classes\/sun\/jvm\/hotspot\/debugger\/linux\/LinuxCDebugger.java","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"}]}