{"files":[{"patch":"@@ -81,0 +81,1 @@\n+  int parent_held_monitor_count() const { return _parent_held_monitor_count; }\n","filename":"src\/hotspot\/share\/runtime\/continuationEntry.hpp","additions":1,"deletions":0,"binary":false,"changes":1,"status":"modified"},{"patch":"@@ -1272,18 +1272,0 @@\n-static freeze_result is_pinned(const frame& f, RegisterMap* map) {\n-  if (f.is_interpreted_frame()) {\n-    if (ContinuationHelper::InterpretedFrame::is_owning_locks(f)) {\n-      return freeze_pinned_monitor;\n-    }\n-    if (f.interpreter_frame_method()->is_native()) {\n-      return freeze_pinned_native; \/\/ interpreter native entry\n-    }\n-  } else if (f.is_compiled_frame()) {\n-    if (ContinuationHelper::CompiledFrame::is_owning_locks(map->thread(), map, f)) {\n-      return freeze_pinned_monitor;\n-    }\n-  } else {\n-    return freeze_pinned_native;\n-  }\n-  return freeze_ok;\n-}\n-\n@@ -1296,1 +1278,2 @@\n-    if (is_pinned(f, &map) == freeze_pinned_monitor) {\n+    if (f.is_interpreted_frame() && ContinuationHelper::InterpretedFrame::is_owning_locks(f) ||\n+        f.is_compiled_frame() && ContinuationHelper::CompiledFrame::is_owning_locks(map.thread(), &map, f)) {\n@@ -1410,0 +1393,2 @@\n+  } else if (thread->held_monitor_count() > 0) {\n+    return freeze_pinned_monitor;\n@@ -1432,3 +1417,2 @@\n-    freeze_result res = is_pinned(f, &map);\n-    if (res != freeze_ok) {\n-      return res;\n+    if (f.is_interpreted_frame() && f.interpreter_frame_method()->is_native() || f.is_native_frame()) {\n+      return freeze_pinned_native;\n@@ -1443,0 +1427,1 @@\n+      int monitor_count = entry->parent_held_monitor_count();\n@@ -1449,0 +1434,2 @@\n+      } else if (monitor_count > 0) {\n+        return freeze_pinned_monitor;\n","filename":"src\/hotspot\/share\/runtime\/continuationFreezeThaw.cpp","additions":9,"deletions":22,"binary":false,"changes":31,"status":"modified"},{"patch":"@@ -103,0 +103,2 @@\n+\n+#ifdef ASSERT\n@@ -104,0 +106,1 @@\n+#endif\n@@ -132,0 +135,1 @@\n+#ifdef ASSERT\n@@ -134,0 +138,1 @@\n+#endif\n","filename":"src\/hotspot\/share\/runtime\/continuationHelper.hpp","additions":5,"deletions":0,"binary":false,"changes":5,"status":"modified"},{"patch":"@@ -109,0 +109,1 @@\n+#ifdef ASSERT\n@@ -126,0 +127,1 @@\n+#endif\n@@ -170,0 +172,1 @@\n+#ifdef ASSERT\n@@ -206,0 +209,1 @@\n+#endif\n","filename":"src\/hotspot\/share\/runtime\/continuationHelper.inline.hpp","additions":4,"deletions":0,"binary":false,"changes":4,"status":"modified"}]}