{"files":[{"patch":"@@ -130,0 +130,8 @@\n+inline void ContinuationHelper::InterpretedFrame::patch_unextended_sp(frame& f) {\n+  assert((f.at(frame::interpreter_frame_last_sp_offset) != 0) || (f.unextended_sp() == f.sp()), \"\");\n+  intptr_t* real_unextended_sp = (intptr_t*)f.at(frame::interpreter_frame_last_sp_offset);\n+  if (real_unextended_sp != nullptr) {\n+    f.set_unextended_sp(real_unextended_sp); \/\/ can be null at a safepoint\n+  }\n+}\n+\n","filename":"src\/hotspot\/cpu\/aarch64\/continuationHelper_aarch64.inline.hpp","additions":8,"deletions":0,"binary":false,"changes":8,"status":"modified"},{"patch":"@@ -242,6 +242,0 @@\n-inline int frame::num_oops() const {\n-  assert(!is_interpreted_frame(), \"interpreted\");\n-  assert(oop_map() != NULL, \"\");\n-  return oop_map()->num_oops() ;\n-}\n-\n","filename":"src\/hotspot\/cpu\/aarch64\/frame_aarch64.inline.hpp","additions":0,"deletions":6,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -93,0 +93,4 @@\n+inline void ContinuationHelper::InterpretedFrame::patch_unextended_sp(frame& f) {\n+  Unimplemented();\n+}\n+\n","filename":"src\/hotspot\/cpu\/arm\/continuationHelper_arm.inline.hpp","additions":4,"deletions":0,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -103,5 +103,0 @@\n-intptr_t* ThawBase::push_interpreter_return_frame(intptr_t* sp) {\n-  Unimplemented();\n-  return NULL;\n-}\n-\n","filename":"src\/hotspot\/cpu\/arm\/continuation_arm.inline.hpp","additions":0,"deletions":5,"binary":false,"changes":5,"status":"modified"},{"patch":"@@ -57,1 +57,5 @@\n-    entry_frame_call_wrapper_offset                  =  0\n+    entry_frame_call_wrapper_offset                  =  0,\n+    metadata_words                                   = sender_sp_offset,\n+    frame_alignment                                  = 16,\n+    \/\/ size, in words, of maximum shift in frame position due to alignment\n+    align_wiggle                                     =  1\n","filename":"src\/hotspot\/cpu\/arm\/frame_arm.hpp","additions":5,"deletions":1,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -43,0 +43,1 @@\n+  DEBUG_ONLY(_frame_index = -1;)\n@@ -57,0 +58,1 @@\n+  DEBUG_ONLY(_frame_index = -1;)\n@@ -80,0 +82,1 @@\n+  DEBUG_ONLY(_frame_index = -1;)\n@@ -103,0 +106,1 @@\n+  DEBUG_ONLY(_frame_index = -1;)\n","filename":"src\/hotspot\/cpu\/arm\/frame_arm.inline.hpp","additions":4,"deletions":0,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -93,0 +93,4 @@\n+inline void ContinuationHelper::InterpretedFrame::patch_unextended_sp(frame& f) {\n+  Unimplemented();\n+}\n+\n","filename":"src\/hotspot\/cpu\/ppc\/continuationHelper_ppc.inline.hpp","additions":4,"deletions":0,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -103,5 +103,0 @@\n-intptr_t* ThawBase::push_interpreter_return_frame(intptr_t* sp) {\n-  Unimplemented();\n-  return NULL;\n-}\n-\n","filename":"src\/hotspot\/cpu\/ppc\/continuation_ppc.inline.hpp","additions":0,"deletions":5,"binary":false,"changes":5,"status":"modified"},{"patch":"@@ -422,1 +422,5 @@\n-    pc_return_offset = 0\n+    pc_return_offset = 0,\n+    metadata_words   = 0,\n+    frame_alignment  = 16,\n+    \/\/ size, in words, of maximum shift in frame position due to alignment\n+    align_wiggle     =  1\n","filename":"src\/hotspot\/cpu\/ppc\/frame_ppc.hpp","additions":5,"deletions":1,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -59,0 +59,3 @@\n+#ifdef ASSERT\n+                        _frame_index(-1),\n+#endif\n@@ -61,1 +64,5 @@\n-inline frame::frame(intptr_t* sp) : _sp(sp), _on_heap(false), _unextended_sp(sp) {\n+inline frame::frame(intptr_t* sp) : _sp(sp), _on_heap(false),\n+#ifdef ASSERT\n+                        _frame_index(-1),\n+#endif\n+                        _unextended_sp(sp) {\n@@ -65,1 +72,5 @@\n-inline frame::frame(intptr_t* sp, address pc) : _sp(sp), _on_heap(false), _unextended_sp(sp) {\n+inline frame::frame(intptr_t* sp, address pc) : _sp(sp), _on_heap(false),\n+#ifdef ASSERT\n+                         _frame_index(-1),\n+#endif\n+                        _unextended_sp(sp) {\n@@ -70,0 +81,3 @@\n+#ifdef ASSERT\n+                    _frame_index(-1),\n+#endif\n","filename":"src\/hotspot\/cpu\/ppc\/frame_ppc.inline.hpp","additions":16,"deletions":2,"binary":false,"changes":18,"status":"modified"},{"patch":"@@ -93,0 +93,4 @@\n+inline void ContinuationHelper::InterpretedFrame::patch_unextended_sp(frame& f) {\n+  Unimplemented();\n+}\n+\n","filename":"src\/hotspot\/cpu\/s390\/continuationHelper_s390.inline.hpp","additions":4,"deletions":0,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -103,5 +103,0 @@\n-intptr_t* ThawBase::push_interpreter_return_frame(intptr_t* sp) {\n-  Unimplemented();\n-  return NULL;\n-}\n-\n","filename":"src\/hotspot\/cpu\/s390\/continuation_s390.inline.hpp","additions":0,"deletions":5,"binary":false,"changes":5,"status":"modified"},{"patch":"@@ -557,0 +557,4 @@\n+    metadata_words   = 0,\n+    frame_alignment  = 16,\n+    \/\/ size, in words, of maximum shift in frame position due to alignment\n+    align_wiggle     =  1\n","filename":"src\/hotspot\/cpu\/s390\/frame_s390.hpp","additions":4,"deletions":0,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -58,0 +58,3 @@\n+#ifdef ASSERT\n+                        _frame_index(-1),\n+#endif\n@@ -60,1 +63,5 @@\n-inline frame::frame(intptr_t* sp) : _sp(sp), _on_heap(false), _unextended_sp(sp) {\n+inline frame::frame(intptr_t* sp) : _sp(sp), _on_heap(false),\n+#ifdef ASSERT\n+                        _frame_index(-1),\n+#endif\n+                        _unextended_sp(sp) {\n@@ -64,1 +71,5 @@\n-inline frame::frame(intptr_t* sp, address pc) : _sp(sp), _on_heap(false), _unextended_sp(sp) {\n+inline frame::frame(intptr_t* sp, address pc) : _sp(sp), _on_heap(false),\n+#ifdef ASSERT\n+                        _frame_index(-1),\n+#endif\n+                        _unextended_sp(sp) {\n@@ -69,0 +80,3 @@\n+#ifdef ASSERT\n+                                                                         _frame_index(-1),\n+#endif\n@@ -77,0 +91,3 @@\n+#ifdef ASSERT\n+  _frame_index(-1),\n+#endif\n","filename":"src\/hotspot\/cpu\/s390\/frame_s390.inline.hpp","additions":19,"deletions":2,"binary":false,"changes":21,"status":"modified"},{"patch":"@@ -113,0 +113,8 @@\n+inline void ContinuationHelper::InterpretedFrame::patch_unextended_sp(frame& f) {\n+  assert((f.at(frame::interpreter_frame_last_sp_offset) != 0) || (f.unextended_sp() == f.sp()), \"\");\n+  intptr_t* real_unextended_sp = (intptr_t*)f.at(frame::interpreter_frame_last_sp_offset);\n+  if (real_unextended_sp != nullptr) {\n+    f.set_unextended_sp(real_unextended_sp); \/\/ can be null at a safepoint\n+  }\n+}\n+\n","filename":"src\/hotspot\/cpu\/x86\/continuationHelper_x86.inline.hpp","additions":8,"deletions":0,"binary":false,"changes":8,"status":"modified"},{"patch":"@@ -231,6 +231,0 @@\n-inline int frame::num_oops() const {\n-  assert(!is_interpreted_frame(), \"interpreted\");\n-  assert(oop_map() != NULL, \"\");\n-  return oop_map()->num_oops() ;\n-}\n-\n","filename":"src\/hotspot\/cpu\/x86\/frame_x86.inline.hpp","additions":0,"deletions":6,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -92,0 +92,4 @@\n+inline void ContinuationHelper::InterpretedFrame::patch_unextended_sp(frame& f) {\n+  Unimplemented();\n+}\n+\n","filename":"src\/hotspot\/cpu\/zero\/continuationHelper_zero.inline.hpp","additions":4,"deletions":0,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -103,5 +103,0 @@\n-intptr_t* ThawBase::push_interpreter_return_frame(intptr_t* sp) {\n-  Unimplemented();\n-  return NULL;\n-}\n-\n","filename":"src\/hotspot\/cpu\/zero\/continuation_zero.inline.hpp","additions":0,"deletions":5,"binary":false,"changes":5,"status":"modified"},{"patch":"@@ -33,1 +33,5 @@\n-    pc_return_offset = 0\n+    pc_return_offset = 0,\n+    metadata_words   = 0,\n+    frame_alignment  = 16,\n+    \/\/ size, in words, of maximum shift in frame position due to alignment\n+    align_wiggle     =  1\n","filename":"src\/hotspot\/cpu\/zero\/frame_zero.hpp","additions":5,"deletions":1,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -40,0 +40,1 @@\n+  DEBUG_ONLY(_frame_index = -1;)\n@@ -52,0 +53,1 @@\n+  DEBUG_ONLY(_frame_index = -1;)\n","filename":"src\/hotspot\/cpu\/zero\/frame_zero.inline.hpp","additions":2,"deletions":0,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -1574,14 +1574,1 @@\n-#if (defined(X86) || defined(AARCH64)) && !defined(ZERO)\n-  { \/\/ TODO PD\n-    \/\/ yes.\n-    \/\/ ContinuationHelper::InterpretedFrame::adjust_unextended_sp(f)  ?? but why?\n-    assert((f.at(frame::interpreter_frame_last_sp_offset) != 0) || (f.unextended_sp() == f.sp()), \"\");\n-    intptr_t* real_unextended_sp = (intptr_t*)f.at(frame::interpreter_frame_last_sp_offset);\n-    if (real_unextended_sp != nullptr) {\n-      f.set_unextended_sp(real_unextended_sp); \/\/ can be null at a safepoint\n-                 \/\/ is this ever at safepoint? maybe was for preempt?\n-    }\n-  }\n-#else\n-  Unimplemented();\n-#endif\n+  ContinuationHelper::InterpretedFrame::patch_unextended_sp(f);\n","filename":"src\/hotspot\/share\/runtime\/continuation.cpp","additions":1,"deletions":14,"binary":false,"changes":15,"status":"modified"},{"patch":"@@ -98,0 +98,1 @@\n+  static void patch_unextended_sp(frame& f);\n","filename":"src\/hotspot\/share\/runtime\/continuationHelper.hpp","additions":1,"deletions":0,"binary":false,"changes":1,"status":"modified"},{"patch":"@@ -107,0 +107,7 @@\n+inline int frame::num_oops() const {\n+  assert(!is_interpreted_frame(), \"interpreted\");\n+  assert(oop_map() != NULL, \"\");\n+  return oop_map()->num_oops() ;\n+}\n+\n+\n","filename":"src\/hotspot\/share\/runtime\/frame.inline.hpp","additions":7,"deletions":0,"binary":false,"changes":7,"status":"modified"},{"patch":"@@ -1050,1 +1050,0 @@\n-  _carrier_thread_suspended(false),\n@@ -1052,0 +1051,1 @@\n+  _carrier_thread_suspended(false),\n","filename":"src\/hotspot\/share\/runtime\/thread.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"}]}