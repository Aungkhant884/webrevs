{"files":[{"patch":"@@ -1003,1 +1003,1 @@\n-  intptr_t* const frame_top = ContinuationHelper::InterpretedFrame::frame_top(f, callee_argsize, callee_interpreted);\n+  intptr_t* const stack_frame_top = ContinuationHelper::InterpretedFrame::frame_top(f, callee_argsize, callee_interpreted);\n@@ -1005,1 +1005,1 @@\n-  const int fsize = f.fp() + frame::metadata_words + locals - frame_top;\n+  const int fsize = f.fp() + frame::metadata_words + locals - stack_frame_top;\n@@ -1007,2 +1007,2 @@\n-  intptr_t* const frame_bottom = ContinuationHelper::InterpretedFrame::frame_bottom(f);\n-  assert(frame_bottom - frame_top >= fsize, \"\"); \/\/ == on x86\n+  intptr_t* const stack_frame_bottom = ContinuationHelper::InterpretedFrame::frame_bottom(f);\n+  assert(stack_frame_bottom - stack_frame_top >= fsize, \"\"); \/\/ == on x86\n@@ -1010,1 +1010,1 @@\n-  DEBUG_ONLY(verify_frame_top(f, frame_top));\n+  DEBUG_ONLY(verify_frame_top(f, stack_frame_top));\n@@ -1032,3 +1032,3 @@\n-  intptr_t* heap_top = ContinuationHelper::InterpretedFrame::frame_top(hf, callee_argsize, callee_interpreted);\n-  intptr_t* heap_bottom = ContinuationHelper::InterpretedFrame::frame_bottom(hf);\n-  assert(heap_bottom == heap_top + fsize, \"\");\n+  intptr_t* heap_frame_top = ContinuationHelper::InterpretedFrame::frame_top(hf, callee_argsize, callee_interpreted);\n+  intptr_t* heap_frame_bottom = ContinuationHelper::InterpretedFrame::frame_bottom(hf);\n+  assert(heap_frame_bottom == heap_frame_top + fsize, \"\");\n@@ -1037,3 +1037,3 @@\n-  copy_to_chunk(frame_bottom - locals, heap_bottom - locals, locals); \/\/ copy locals\n-  copy_to_chunk(frame_top, heap_top, fsize - locals);                 \/\/ copy rest\n-  assert(!is_bottom_frame || !caller.is_interpreted_frame() || (heap_top + fsize) == (caller.unextended_sp() + argsize), \"\");\n+  copy_to_chunk(stack_frame_bottom - locals, heap_frame_bottom - locals, locals); \/\/ copy locals\n+  copy_to_chunk(stack_frame_top, heap_frame_top, fsize - locals);                 \/\/ copy rest\n+  assert(!is_bottom_frame || !caller.is_interpreted_frame() || (heap_frame_top + fsize) == (caller.unextended_sp() + argsize), \"\");\n@@ -1056,2 +1056,2 @@\n-  intptr_t* const frame_top = ContinuationHelper::CompiledFrame::frame_top(f, callee_argsize, callee_interpreted);\n-  intptr_t* const frame_bottom = ContinuationHelper::CompiledFrame::frame_bottom(f);\n+  intptr_t* const stack_frame_top = ContinuationHelper::CompiledFrame::frame_top(f, callee_argsize, callee_interpreted);\n+  intptr_t* const stack_frame_bottom = ContinuationHelper::CompiledFrame::frame_bottom(f);\n@@ -1059,1 +1059,1 @@\n-  const int fsize = frame_bottom + argsize - frame_top;\n+  const int fsize = stack_frame_bottom + argsize - stack_frame_top;\n@@ -1079,1 +1079,1 @@\n-  intptr_t* heap_top = ContinuationHelper::CompiledFrame::frame_top(hf, callee_argsize, callee_interpreted);\n+  intptr_t* heap_frame_top = ContinuationHelper::CompiledFrame::frame_top(hf, callee_argsize, callee_interpreted);\n@@ -1081,2 +1081,2 @@\n-  copy_to_chunk(frame_top, heap_top, fsize);\n-  assert(!is_bottom_frame || !caller.is_compiled_frame() || (heap_top + fsize) == (caller.unextended_sp() + argsize), \"\");\n+  copy_to_chunk(stack_frame_top, heap_frame_top, fsize);\n+  assert(!is_bottom_frame || !caller.is_compiled_frame() || (heap_frame_top + fsize) == (caller.unextended_sp() + argsize), \"\");\n@@ -1098,1 +1098,1 @@\n-  intptr_t* const frame_top = ContinuationHelper::StubFrame::frame_top(f, 0, 0);\n+  intptr_t* const stack_frame_top = ContinuationHelper::StubFrame::frame_top(f, 0, 0);\n@@ -1102,1 +1102,1 @@\n-    f.cb()->name(), _freeze_size, fsize, p2i(frame_top), p2i(frame_top+fsize));\n+    f.cb()->name(), _freeze_size, fsize, p2i(stack_frame_top), p2i(stack_frame_top+fsize));\n@@ -1130,2 +1130,2 @@\n-  intptr_t* heap_top = ContinuationHelper::StubFrame::frame_top(hf, 0, 0);\n-  copy_to_chunk(frame_top, heap_top, fsize);\n+  intptr_t* heap_frame_top = ContinuationHelper::StubFrame::frame_top(hf, 0, 0);\n+  copy_to_chunk(stack_frame_top, heap_frame_top, fsize);\n@@ -1942,4 +1942,4 @@\n-  intptr_t* const frame_top = f.sp();\n-  intptr_t* const frame_bottom = ContinuationHelper::InterpretedFrame::frame_bottom(f);\n-  intptr_t* const heap_top = hf.unextended_sp();\n-  intptr_t* const heap_bottom = ContinuationHelper::InterpretedFrame::frame_bottom(hf);\n+  intptr_t* const stack_frame_top = f.sp();\n+  intptr_t* const stack_frame_bottom = ContinuationHelper::InterpretedFrame::frame_bottom(f);\n+  intptr_t* const heap_frame_top = hf.unextended_sp();\n+  intptr_t* const heap_frame_bottom = ContinuationHelper::InterpretedFrame::frame_bottom(hf);\n@@ -1948,1 +1948,1 @@\n-  const int fsize = heap_bottom - heap_top;\n+  const int fsize = heap_frame_bottom - heap_frame_top;\n@@ -1950,2 +1950,2 @@\n-  assert(!is_bottom_frame || frame_top + fsize >= _cont.entrySP() - 2, \"\");\n-  assert(!is_bottom_frame || frame_top + fsize <= _cont.entrySP(), \"\");\n+  assert(!is_bottom_frame || stack_frame_top + fsize >= _cont.entrySP() - 2, \"\");\n+  assert(!is_bottom_frame || stack_frame_top + fsize <= _cont.entrySP(), \"\");\n@@ -1953,1 +1953,1 @@\n-  assert(frame_bottom == frame_top + fsize, \"\");\n+  assert(stack_frame_bottom == stack_frame_top + fsize, \"\");\n@@ -1960,2 +1960,2 @@\n-  copy_from_chunk(heap_bottom - locals, frame_bottom - locals, locals); \/\/ copy locals\n-  copy_from_chunk(heap_top, frame_top, fsize - locals);                 \/\/ copy rest\n+  copy_from_chunk(heap_frame_bottom - locals, stack_frame_bottom - locals, locals); \/\/ copy locals\n+  copy_from_chunk(heap_frame_top, stack_frame_top, fsize - locals);                 \/\/ copy rest\n@@ -1963,1 +1963,1 @@\n-  set_interpreter_frame_bottom(f, frame_bottom); \/\/ the copy overwrites the metadata\n+  set_interpreter_frame_bottom(f, stack_frame_bottom); \/\/ the copy overwrites the metadata\n@@ -1968,1 +1968,1 @@\n-  assert(frame_bottom <= ContinuationHelper::Frame::frame_top(caller), \"\");\n+  assert(stack_frame_bottom <= ContinuationHelper::Frame::frame_top(caller), \"\");\n@@ -1979,1 +1979,1 @@\n-    clear_bitmap_bits(heap_bottom - locals, locals);\n+    clear_bitmap_bits(heap_frame_bottom - locals, locals);\n@@ -2005,2 +2005,2 @@\n-  intptr_t* const frame_top = f.sp();\n-  intptr_t* const heap_top = hf.unextended_sp();\n+  intptr_t* const stack_frame_top = f.sp();\n+  intptr_t* const heap_frame_top = hf.unextended_sp();\n@@ -2012,2 +2012,2 @@\n-  intptr_t* from = heap_top - frame::metadata_words;\n-  intptr_t* to   = frame_top - frame::metadata_words;\n+  intptr_t* from = heap_frame_top - frame::metadata_words;\n+  intptr_t* to   = stack_frame_top - frame::metadata_words;\n@@ -2048,1 +2048,1 @@\n-    clear_bitmap_bits(heap_top + ContinuationHelper::CompiledFrame::size(hf), added_argsize);\n+    clear_bitmap_bits(heap_frame_top + ContinuationHelper::CompiledFrame::size(hf), added_argsize);\n@@ -2080,2 +2080,2 @@\n-  intptr_t* frame_top = f.sp();\n-  intptr_t* heap_top = hf.sp();\n+  intptr_t* stack_frame_top = f.sp();\n+  intptr_t* heap_frame_top = hf.sp();\n@@ -2083,1 +2083,1 @@\n-  copy_from_chunk(heap_top - frame::metadata_words, frame_top - frame::metadata_words,\n+  copy_from_chunk(heap_frame_top - frame::metadata_words, stack_frame_top - frame::metadata_words,\n","filename":"src\/hotspot\/share\/runtime\/continuationFreezeThaw.cpp","additions":42,"deletions":42,"binary":false,"changes":84,"status":"modified"}]}