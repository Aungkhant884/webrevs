{"files":[{"patch":"@@ -247,2 +247,1 @@\n-  jvmti_env = jvmti;\n-  err = init_agent_data(jvmti_env, &agent_data);\n+  err = init_agent_data(jvmti, &agent_data);\n","filename":"test\/hotspot\/jtreg\/serviceability\/jvmti\/events\/MonitorContendedEnter\/mcontenter001\/libmcontenter.cpp","additions":1,"deletions":2,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -270,2 +270,1 @@\n-  jvmti_env = jvmti;\n-  err = init_agent_data(jvmti_env, &agent_data);\n+  err = init_agent_data(jvmti, &agent_data);\n","filename":"test\/hotspot\/jtreg\/serviceability\/jvmti\/events\/MonitorContendedEntered\/mcontentered001\/libmcontentered.cpp","additions":1,"deletions":2,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -246,2 +246,1 @@\n-  jvmti_env = jvmti;\n-  err = init_agent_data(jvmti_env, &agent_data);\n+  err = init_agent_data(jvmti, &agent_data);\n","filename":"test\/hotspot\/jtreg\/serviceability\/jvmti\/events\/MonitorWait\/monitorwait001\/libmonitorwait.cpp","additions":1,"deletions":2,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -248,2 +248,1 @@\n-  jvmti_env = jvmti;\n-  err = init_agent_data(jvmti_env, &agent_data);\n+  err = init_agent_data(jvmti, &agent_data);\n","filename":"test\/hotspot\/jtreg\/serviceability\/jvmti\/events\/MonitorWaited\/monitorwaited001\/libmonitorwaited.cpp","additions":1,"deletions":2,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -132,2 +132,1 @@\n-  jvmti_env = jvmti;\n-  err = init_agent_data(jvmti_env, &agent_data);\n+  err = init_agent_data(jvmti, &agent_data);\n","filename":"test\/hotspot\/jtreg\/serviceability\/jvmti\/events\/VMObjectAlloc\/vmobjalloc001\/libvmobjalloc.cpp","additions":1,"deletions":2,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -47,20 +47,0 @@\n-\n-\n-#ifdef _WIN32\n-\n-#define LL \"I64\"\n-#include <STDDEF.H>\n-\n-#else \/\/ !_WIN32\n-\n-#include <stdint.h>\n-\n-#ifdef _LP64\n-#define LL \"l\"\n-#else\n-#define LL \"ll\"\n-#endif\n-\n-#endif \/\/ !_WIN32\n-\n-\n@@ -69,3 +49,0 @@\n-#define NSK_STATUS_PASSED       0\n-#define NSK_STATUS_FAILED       2\n-\n","filename":"test\/lib\/jdk\/test\/lib\/jvmti\/jvmti_common.h","additions":0,"deletions":23,"binary":false,"changes":23,"status":"modified"},{"patch":"@@ -33,0 +33,20 @@\n+\n+\n+#ifdef _WIN32\n+\n+#define LL \"I64\"\n+#include <STDDEF.H>\n+\n+#else \/\/ !_WIN32\n+\n+#include <stdint.h>\n+\n+#ifdef _LP64\n+#define LL \"l\"\n+#else\n+#define LL \"ll\"\n+#endif\n+\n+#endif \/\/ !_WIN32\n+\n+\n@@ -35,3 +55,6 @@\n-static jvmtiEnv* jvmti_env = NULL;\n-static JavaVM* jvm = NULL;\n-static JNIEnv* jni_env = NULL;\n+\n+#define NSK_STATUS_PASSED       0\n+#define NSK_STATUS_FAILED       2\n+\n+static jvmtiEnv* agent_jvmti_env = NULL;\n+static JNIEnv* agent_jni_env = NULL;\n@@ -73,1 +96,1 @@\n-\n+  agent_jvmti_env = jvmti_env;\n@@ -119,1 +142,1 @@\n-  rawMonitorEnter(jvmti_env, agent_data.monitor);\n+  rawMonitorEnter(agent_jvmti_env, agent_data.monitor);\n@@ -125,1 +148,1 @@\n-  rawMonitorNotify(jvmti_env, agent_data.monitor);\n+  rawMonitorNotify(agent_jvmti_env, agent_data.monitor);\n@@ -130,1 +153,1 @@\n-    rawMonitorWait(jvmti_env, agent_data.monitor, inc_timeout);\n+    rawMonitorWait(agent_jvmti_env, agent_data.monitor, inc_timeout);\n@@ -145,1 +168,1 @@\n-  rawMonitorExit(jvmti_env, agent_data.monitor);\n+  rawMonitorExit(agent_jvmti_env, agent_data.monitor);\n@@ -153,1 +176,1 @@\n-  rawMonitorEnter(jvmti_env, agent_data.monitor);\n+  rawMonitorEnter(agent_jvmti_env, agent_data.monitor);\n@@ -160,1 +183,1 @@\n-    rawMonitorNotify(jvmti_env, agent_data.monitor);\n+    rawMonitorNotify(agent_jvmti_env, agent_data.monitor);\n@@ -168,1 +191,1 @@\n-  rawMonitorExit(jvmti_env, agent_data.monitor);\n+  rawMonitorExit(agent_jvmti_env, agent_data.monitor);\n@@ -174,1 +197,1 @@\n-  rawMonitorEnter(jvmti_env, agent_data.monitor);\n+  rawMonitorEnter(agent_jvmti_env, agent_data.monitor);\n@@ -176,2 +199,2 @@\n-  rawMonitorNotify(jvmti_env, agent_data.monitor);\n-  rawMonitorExit(jvmti_env, agent_data.monitor);\n+  rawMonitorNotify(agent_jvmti_env, agent_data.monitor);\n+  rawMonitorExit(agent_jvmti_env, agent_data.monitor);\n@@ -183,1 +206,1 @@\n-  jni_env = agentJNI;\n+  agent_jni_env = agentJNI;\n@@ -330,1 +353,1 @@\n-  status = syncDebuggeeStatus(jni_env, jvmti_env, debuggeeStatus);\n+  status = syncDebuggeeStatus(jni_env, agent_jvmti_env, debuggeeStatus);\n@@ -334,16 +357,0 @@\n-\/** Create JVMTI environment. *\/\n-jvmtiEnv* nsk_jvmti_createJVMTIEnv(JavaVM* javaVM, void* reserved) {\n-  jvm = javaVM;\n-  if (javaVM->GetEnv((void **)&jvmti_env, JVMTI_VERSION_1_1) != JNI_OK) {\n-    nsk_jvmti_setFailStatus();\n-    return NULL;\n-  }\n-\n-  if (init_agent_data(jvmti_env, &agent_data) != 0) {\n-    nsk_jvmti_setFailStatus();\n-    return NULL;\n-  }\n-\n-  return jvmti_env;\n-}\n-\n","filename":"test\/lib\/jdk\/test\/lib\/jvmti\/jvmti_thread.h","additions":39,"deletions":32,"binary":false,"changes":71,"status":"modified"}]}