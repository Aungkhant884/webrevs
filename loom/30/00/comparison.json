{"files":[{"patch":"@@ -197,1 +197,1 @@\n-      if (concurrent_gc) { \/\/  && UseZG\n+      if (concurrent_gc && UseZGC) {\n@@ -202,0 +202,7 @@\n+#if INCLUDE_SHENANDOAHGC\n+      if (concurrent_gc && UseShenandoahGC) {\n+        if (!ShenandoahHeap::heap()->in_collection_set(base)) {\n+          continue;\n+        }\n+      }\n+#endif\n@@ -395,1 +402,1 @@\n-    if (UseZGC) {\n+    if (UseZGC || UseShenandoahGC) {\n@@ -507,2 +514,2 @@\n-      \n-      oop obj = omv.type() == OopMapValue::narrowoop_value ? (oop)HeapAccess<>::oop_load((narrowOop*)p) : (oop)HeapAccess<>::oop_load((oop*)p);\n+      intptr_t val = *(intptr_t*)p;\n+      oop obj = omv.type() == OopMapValue::narrowoop_value ? (oop)NativeAccess<>::oop_load((narrowOop*)&val) : (oop)NativeAccess<>::oop_load((oop*)&val);\n@@ -530,1 +537,1 @@\n-      oop base = (oop)NativeAccess<>::oop_load((oop*)base_loc); \/\/ *(oop*)base_loc;\n+      oop base = *base_loc;\n","filename":"src\/hotspot\/share\/oops\/instanceStackChunkKlass.cpp","additions":12,"deletions":5,"binary":false,"changes":17,"status":"modified"},{"patch":"@@ -44,0 +44,3 @@\n+#if INCLUDE_SHENANDOAHGC\n+#define FIX_DERIVED_POINTERS true\n+#endif\n@@ -199,1 +202,1 @@\n-  UseZGC\n+  (UseZGC || UseShenandoahGC)\n@@ -209,1 +212,1 @@\n-  UseZGC\n+  (UseZGC || UseShenandoahGC)\n","filename":"src\/hotspot\/share\/oops\/instanceStackChunkKlass.inline.hpp","additions":5,"deletions":2,"binary":false,"changes":7,"status":"modified"}]}