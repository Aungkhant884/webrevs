{"files":[{"patch":"@@ -2,1 +2,11 @@\n- * @test\n+ * Note: to run this test manually, you need to build the tests first to get native\n+ * libraries compiled, and then execute it with plain jtreg, like:\n+ *\n+ *  $ bin\/jtreg -jdk:<path-to-tested-jdk> \\\n+ *              -nativepath:<path-to-build-dir>\/support\/test\/jdk\/jtreg\/native\/lib\/ \\\n+ *              -concurrency:auto \\\n+ *              .\/test\/jdk\/java\/foreign\/TestMatrix.java\n+ *\/\n+\n+\/*\n+ * @test id=UpcallHighArity-FFTT\n@@ -5,1 +15,1 @@\n- * @build NativeTestHelper CallGeneratorHelper TestUpcallHighArity TestUpcall TestDowncall\n+ * @build NativeTestHelper CallGeneratorHelper TestUpcallHighArity\n@@ -7,1 +17,1 @@\n- * @run testng\/othervm\/native\n+ * @run testng\/othervm\/native\/manual\n@@ -14,1 +24,8 @@\n- * @run testng\/othervm\/native\n+ *\/\n+\n+\/* @test id=UpcallHighArity-TFTT\n+ * @requires ((os.arch == \"amd64\" | os.arch == \"x86_64\") & sun.arch.data.model == \"64\") | os.arch == \"aarch64\"\n+ * @modules jdk.incubator.foreign\/jdk.internal.foreign\n+ * @build NativeTestHelper CallGeneratorHelper TestUpcallHighArity\n+ *\n+ * @run testng\/othervm\/native\/manual\n@@ -21,1 +38,8 @@\n- * @run testng\/othervm\/native\n+ *\/\n+\n+\/* @test id=UpcallHighArity-FTTT\n+ * @requires ((os.arch == \"amd64\" | os.arch == \"x86_64\") & sun.arch.data.model == \"64\") | os.arch == \"aarch64\"\n+ * @modules jdk.incubator.foreign\/jdk.internal.foreign\n+ * @build NativeTestHelper CallGeneratorHelper TestUpcallHighArity\n+ *\n+ * @run testng\/othervm\/native\/manual\n@@ -28,1 +52,8 @@\n- * @run testng\/othervm\/native\n+ *\/\n+\n+\/* @test id=UpcallHighArity-TTTT\n+ * @requires ((os.arch == \"amd64\" | os.arch == \"x86_64\") & sun.arch.data.model == \"64\") | os.arch == \"aarch64\"\n+ * @modules jdk.incubator.foreign\/jdk.internal.foreign\n+ * @build NativeTestHelper CallGeneratorHelper TestUpcallHighArity\n+ *\n+ * @run testng\/othervm\/native\/manual\n@@ -35,0 +66,6 @@\n+ *\/\n+\n+\/* @test id=UpcallHighArity-FFTF\n+ * @requires ((os.arch == \"amd64\" | os.arch == \"x86_64\") & sun.arch.data.model == \"64\") | os.arch == \"aarch64\"\n+ * @modules jdk.incubator.foreign\/jdk.internal.foreign\n+ * @build NativeTestHelper CallGeneratorHelper TestUpcallHighArity\n@@ -36,1 +73,1 @@\n-  * @run testng\/othervm\/native\n+ * @run testng\/othervm\/native\/manual\n@@ -43,1 +80,8 @@\n- * @run testng\/othervm\/native\n+ *\/\n+\n+\/* @test id=UpcallHighArity-TFTF\n+ * @requires ((os.arch == \"amd64\" | os.arch == \"x86_64\") & sun.arch.data.model == \"64\") | os.arch == \"aarch64\"\n+ * @modules jdk.incubator.foreign\/jdk.internal.foreign\n+ * @build NativeTestHelper CallGeneratorHelper TestUpcallHighArity\n+ *\n+ * @run testng\/othervm\/native\/manual\n@@ -50,1 +94,8 @@\n- * @run testng\/othervm\/native\n+ *\/\n+\n+\/* @test id=UpcallHighArity-FTTF\n+ * @requires ((os.arch == \"amd64\" | os.arch == \"x86_64\") & sun.arch.data.model == \"64\") | os.arch == \"aarch64\"\n+ * @modules jdk.incubator.foreign\/jdk.internal.foreign\n+ * @build NativeTestHelper CallGeneratorHelper TestUpcallHighArity\n+ *\n+ * @run testng\/othervm\/native\/manual\n@@ -57,1 +108,8 @@\n- * @run testng\/othervm\/native\n+ *\/\n+\n+\/* @test id=UpcallHighArity-TTTF\n+ * @requires ((os.arch == \"amd64\" | os.arch == \"x86_64\") & sun.arch.data.model == \"64\") | os.arch == \"aarch64\"\n+ * @modules jdk.incubator.foreign\/jdk.internal.foreign\n+ * @build NativeTestHelper CallGeneratorHelper TestUpcallHighArity\n+ *\n+ * @run testng\/othervm\/native\/manual\n@@ -64,0 +122,6 @@\n+ *\/\n+\n+\/* @test id=UpcallHighArity-FFFT\n+ * @requires ((os.arch == \"amd64\" | os.arch == \"x86_64\") & sun.arch.data.model == \"64\") | os.arch == \"aarch64\"\n+ * @modules jdk.incubator.foreign\/jdk.internal.foreign\n+ * @build NativeTestHelper CallGeneratorHelper TestUpcallHighArity\n@@ -65,1 +129,1 @@\n- * @run testng\/othervm\/native\n+ * @run testng\/othervm\/native\/manual\n@@ -72,1 +136,8 @@\n- * @run testng\/othervm\/native\n+ *\/\n+\n+\/* @test id=UpcallHighArity-TFFT\n+ * @requires ((os.arch == \"amd64\" | os.arch == \"x86_64\") & sun.arch.data.model == \"64\") | os.arch == \"aarch64\"\n+ * @modules jdk.incubator.foreign\/jdk.internal.foreign\n+ * @build NativeTestHelper CallGeneratorHelper TestUpcallHighArity\n+ *\n+ * @run testng\/othervm\/native\/manual\n@@ -79,1 +150,8 @@\n- * @run testng\/othervm\/native\n+ *\/\n+\n+\/* @test id=UpcallHighArity-FTFT\n+ * @requires ((os.arch == \"amd64\" | os.arch == \"x86_64\") & sun.arch.data.model == \"64\") | os.arch == \"aarch64\"\n+ * @modules jdk.incubator.foreign\/jdk.internal.foreign\n+ * @build NativeTestHelper CallGeneratorHelper TestUpcallHighArity\n+ *\n+ * @run testng\/othervm\/native\/manual\n@@ -86,1 +164,8 @@\n- * @run testng\/othervm\/native\n+ *\/\n+\n+\/* @test id=UpcallHighArity-TTFT\n+ * @requires ((os.arch == \"amd64\" | os.arch == \"x86_64\") & sun.arch.data.model == \"64\") | os.arch == \"aarch64\"\n+ * @modules jdk.incubator.foreign\/jdk.internal.foreign\n+ * @build NativeTestHelper CallGeneratorHelper TestUpcallHighArity\n+ *\n+ * @run testng\/othervm\/native\/manual\n@@ -93,0 +178,6 @@\n+ *\/\n+\n+\/* @test id=UpcallHighArity-FFFF\n+ * @requires ((os.arch == \"amd64\" | os.arch == \"x86_64\") & sun.arch.data.model == \"64\") | os.arch == \"aarch64\"\n+ * @modules jdk.incubator.foreign\/jdk.internal.foreign\n+ * @build NativeTestHelper CallGeneratorHelper TestUpcallHighArity\n@@ -94,1 +185,1 @@\n- * @run testng\/othervm\/native\n+ * @run testng\/othervm\/native\/manual\n@@ -101,1 +192,8 @@\n- * @run testng\/othervm\/native\n+ *\/\n+\n+\/* @test id=UpcallHighArity-TFFF\n+ * @requires ((os.arch == \"amd64\" | os.arch == \"x86_64\") & sun.arch.data.model == \"64\") | os.arch == \"aarch64\"\n+ * @modules jdk.incubator.foreign\/jdk.internal.foreign\n+ * @build NativeTestHelper CallGeneratorHelper TestUpcallHighArity\n+ *\n+ * @run testng\/othervm\/native\/manual\n@@ -108,1 +206,8 @@\n- * @run testng\/othervm\/native\n+ *\/\n+\n+\/* @test id=UpcallHighArity-FTFF\n+ * @requires ((os.arch == \"amd64\" | os.arch == \"x86_64\") & sun.arch.data.model == \"64\") | os.arch == \"aarch64\"\n+ * @modules jdk.incubator.foreign\/jdk.internal.foreign\n+ * @build NativeTestHelper CallGeneratorHelper TestUpcallHighArity\n+ *\n+ * @run testng\/othervm\/native\/manual\n@@ -115,1 +220,8 @@\n- * @run testng\/othervm\/native\n+ *\/\n+\n+\/* @test id=UpcallHighArity-TTFF\n+ * @requires ((os.arch == \"amd64\" | os.arch == \"x86_64\") & sun.arch.data.model == \"64\") | os.arch == \"aarch64\"\n+ * @modules jdk.incubator.foreign\/jdk.internal.foreign\n+ * @build NativeTestHelper CallGeneratorHelper TestUpcallHighArity\n+ *\n+ * @run testng\/othervm\/native\/manual\n@@ -122,0 +234,6 @@\n+ *\/\n+\n+\/* @test id=Downcall-FF\n+ * @requires ((os.arch == \"amd64\" | os.arch == \"x86_64\") & sun.arch.data.model == \"64\") | os.arch == \"aarch64\"\n+ * @modules jdk.incubator.foreign\/jdk.internal.foreign\n+ * @build NativeTestHelper CallGeneratorHelper TestDowncall\n@@ -123,1 +241,1 @@\n- * @run testng\/othervm\n+ * @run testng\/othervm\/manual\n@@ -128,1 +246,8 @@\n- * @run testng\/othervm\n+ *\/\n+\n+\/* @test id=Downcall-TF\n+ * @requires ((os.arch == \"amd64\" | os.arch == \"x86_64\") & sun.arch.data.model == \"64\") | os.arch == \"aarch64\"\n+ * @modules jdk.incubator.foreign\/jdk.internal.foreign\n+ * @build NativeTestHelper CallGeneratorHelper TestDowncall\n+ *\n+ * @run testng\/othervm\/manual\n@@ -133,1 +258,8 @@\n- * @run testng\/othervm\n+ *\/\n+\n+\/* @test id=Downcall-FT\n+ * @requires ((os.arch == \"amd64\" | os.arch == \"x86_64\") & sun.arch.data.model == \"64\") | os.arch == \"aarch64\"\n+ * @modules jdk.incubator.foreign\/jdk.internal.foreign\n+ * @build NativeTestHelper CallGeneratorHelper TestDowncall\n+ *\n+ * @run testng\/othervm\/manual\n@@ -138,1 +270,8 @@\n- * @run testng\/othervm\n+ *\/\n+\n+\/* @test id=Downcall-TT\n+ * @requires ((os.arch == \"amd64\" | os.arch == \"x86_64\") & sun.arch.data.model == \"64\") | os.arch == \"aarch64\"\n+ * @modules jdk.incubator.foreign\/jdk.internal.foreign\n+ * @build NativeTestHelper CallGeneratorHelper TestDowncall\n+ *\n+ * @run testng\/othervm\/manual\n@@ -143,0 +282,6 @@\n+ *\/\n+\n+\/* @test id=Upcall-TFTT\n+ * @requires ((os.arch == \"amd64\" | os.arch == \"x86_64\") & sun.arch.data.model == \"64\") | os.arch == \"aarch64\"\n+ * @modules jdk.incubator.foreign\/jdk.internal.foreign\n+ * @build NativeTestHelper CallGeneratorHelper TestUpcall\n@@ -144,8 +289,1 @@\n- * @run testng\/othervm\n- *   --enable-native-access=ALL-UNNAMED\n- *   -Djdk.internal.foreign.ProgrammableInvoker.USE_SPEC=true\n- *   -Djdk.internal.foreign.ProgrammableInvoker.USE_INTRINSICS=false\n- *   -Djdk.internal.foreign.ProgrammableUpcallHandler.USE_SPEC=true\n- *   -Djdk.internal.foreign.ProgrammableUpcallHandler.USE_INTRINSICS=true\n- *   TestUpcall\n- * @run testng\/othervm\n+ * @run testng\/othervm\/manual\n@@ -158,1 +296,8 @@\n- * @run testng\/othervm\n+ *\/\n+\n+\/* @test id=Upcall-FTTT\n+ * @requires ((os.arch == \"amd64\" | os.arch == \"x86_64\") & sun.arch.data.model == \"64\") | os.arch == \"aarch64\"\n+ * @modules jdk.incubator.foreign\/jdk.internal.foreign\n+ * @build NativeTestHelper CallGeneratorHelper TestUpcall\n+ *\n+ * @run testng\/othervm\/manual\n@@ -165,1 +310,8 @@\n- * @run testng\/othervm\n+ *\/\n+\n+\/* @test id=Upcall-TTTT\n+ * @requires ((os.arch == \"amd64\" | os.arch == \"x86_64\") & sun.arch.data.model == \"64\") | os.arch == \"aarch64\"\n+ * @modules jdk.incubator.foreign\/jdk.internal.foreign\n+ * @build NativeTestHelper CallGeneratorHelper TestUpcall\n+ *\n+ * @run testng\/othervm\/manual\n@@ -172,0 +324,6 @@\n+ *\/\n+\n+\/* @test id=Upcall-TFTF\n+ * @requires ((os.arch == \"amd64\" | os.arch == \"x86_64\") & sun.arch.data.model == \"64\") | os.arch == \"aarch64\"\n+ * @modules jdk.incubator.foreign\/jdk.internal.foreign\n+ * @build NativeTestHelper CallGeneratorHelper TestUpcall\n@@ -173,8 +331,1 @@\n- * @run testng\/othervm\n- *   --enable-native-access=ALL-UNNAMED\n- *   -Djdk.internal.foreign.ProgrammableInvoker.USE_SPEC=true\n- *   -Djdk.internal.foreign.ProgrammableInvoker.USE_INTRINSICS=false\n- *   -Djdk.internal.foreign.ProgrammableUpcallHandler.USE_SPEC=true\n- *   -Djdk.internal.foreign.ProgrammableUpcallHandler.USE_INTRINSICS=false\n- *   TestUpcall\n- * @run testng\/othervm\n+ * @run testng\/othervm\/manual\n@@ -187,1 +338,8 @@\n- * @run testng\/othervm\n+ *\/\n+\n+\/* @test id=Upcall-FTTF\n+ * @requires ((os.arch == \"amd64\" | os.arch == \"x86_64\") & sun.arch.data.model == \"64\") | os.arch == \"aarch64\"\n+ * @modules jdk.incubator.foreign\/jdk.internal.foreign\n+ * @build NativeTestHelper CallGeneratorHelper TestUpcall\n+ *\n+ * @run testng\/othervm\/manual\n@@ -194,1 +352,8 @@\n- * @run testng\/othervm\n+ *\/\n+\n+\/* @test id=Upcall-TTTF\n+ * @requires ((os.arch == \"amd64\" | os.arch == \"x86_64\") & sun.arch.data.model == \"64\") | os.arch == \"aarch64\"\n+ * @modules jdk.incubator.foreign\/jdk.internal.foreign\n+ * @build NativeTestHelper CallGeneratorHelper TestUpcall\n+ *\n+ * @run testng\/othervm\/manual\n@@ -201,0 +366,6 @@\n+ *\/\n+\n+\/* @test id=Upcall-TFFT\n+ * @requires ((os.arch == \"amd64\" | os.arch == \"x86_64\") & sun.arch.data.model == \"64\") | os.arch == \"aarch64\"\n+ * @modules jdk.incubator.foreign\/jdk.internal.foreign\n+ * @build NativeTestHelper CallGeneratorHelper TestUpcall\n@@ -202,8 +373,1 @@\n- * @run testng\/othervm\n- *   --enable-native-access=ALL-UNNAMED\n- *   -Djdk.internal.foreign.ProgrammableInvoker.USE_SPEC=true\n- *   -Djdk.internal.foreign.ProgrammableInvoker.USE_INTRINSICS=false\n- *   -Djdk.internal.foreign.ProgrammableUpcallHandler.USE_SPEC=false\n- *   -Djdk.internal.foreign.ProgrammableUpcallHandler.USE_INTRINSICS=true\n- *   TestUpcall\n- * @run testng\/othervm\n+ * @run testng\/othervm\/manual\n@@ -216,1 +380,8 @@\n- * @run testng\/othervm\n+ *\/\n+\n+\/* @test id=Upcall-FTFT\n+ * @requires ((os.arch == \"amd64\" | os.arch == \"x86_64\") & sun.arch.data.model == \"64\") | os.arch == \"aarch64\"\n+ * @modules jdk.incubator.foreign\/jdk.internal.foreign\n+ * @build NativeTestHelper CallGeneratorHelper TestUpcall\n+ *\n+ * @run testng\/othervm\/manual\n@@ -223,1 +394,8 @@\n- * @run testng\/othervm\n+ *\/\n+\n+\/* @test id=Upcall-TTFT\n+ * @requires ((os.arch == \"amd64\" | os.arch == \"x86_64\") & sun.arch.data.model == \"64\") | os.arch == \"aarch64\"\n+ * @modules jdk.incubator.foreign\/jdk.internal.foreign\n+ * @build NativeTestHelper CallGeneratorHelper TestUpcall\n+ *\n+ * @run testng\/othervm\/manual\n@@ -230,0 +408,6 @@\n+ *\/\n+\n+\/* @test id=Upcall-TFFF\n+ * @requires ((os.arch == \"amd64\" | os.arch == \"x86_64\") & sun.arch.data.model == \"64\") | os.arch == \"aarch64\"\n+ * @modules jdk.incubator.foreign\/jdk.internal.foreign\n+ * @build NativeTestHelper CallGeneratorHelper TestUpcall\n@@ -231,8 +415,1 @@\n- * @run testng\/othervm\n- *   --enable-native-access=ALL-UNNAMED\n- *   -Djdk.internal.foreign.ProgrammableInvoker.USE_SPEC=true\n- *   -Djdk.internal.foreign.ProgrammableInvoker.USE_INTRINSICS=false\n- *   -Djdk.internal.foreign.ProgrammableUpcallHandler.USE_SPEC=false\n- *   -Djdk.internal.foreign.ProgrammableUpcallHandler.USE_INTRINSICS=false\n- *   TestUpcall\n- * @run testng\/othervm\n+ * @run testng\/othervm\/manual\n@@ -245,1 +422,8 @@\n- * @run testng\/othervm\n+ *\/\n+\n+\/* @test id=Upcall-FTFF\n+ * @requires ((os.arch == \"amd64\" | os.arch == \"x86_64\") & sun.arch.data.model == \"64\") | os.arch == \"aarch64\"\n+ * @modules jdk.incubator.foreign\/jdk.internal.foreign\n+ * @build NativeTestHelper CallGeneratorHelper TestUpcall\n+ *\n+ * @run testng\/othervm\/manual\n@@ -252,1 +436,8 @@\n- * @run testng\/othervm\n+ *\/\n+\n+\/* @test id=Upcall-TTFF\n+ * @requires ((os.arch == \"amd64\" | os.arch == \"x86_64\") & sun.arch.data.model == \"64\") | os.arch == \"aarch64\"\n+ * @modules jdk.incubator.foreign\/jdk.internal.foreign\n+ * @build NativeTestHelper CallGeneratorHelper TestUpcall\n+ *\n+ * @run testng\/othervm\/manual\n","filename":"test\/jdk\/java\/foreign\/TestMatrix.java","additions":253,"deletions":62,"binary":false,"changes":315,"status":"modified"}]}