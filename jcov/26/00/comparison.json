{"files":[{"patch":"@@ -34,0 +34,2 @@\n+import java.util.Collections;\n+import java.util.HashMap;\n@@ -35,0 +37,1 @@\n+import java.util.Map;\n@@ -46,0 +49,24 @@\n+    final private static Map<String, Integer> map =\n+            Collections.synchronizedMap(new HashMap<String, Integer>());\n+    static volatile int invokeCount = 0;\n+\n+    public static int getInvokeID(String owner, String name, String descr) {\n+        String sig = owner + \".\" + name + descr;\n+        synchronized (map) {\n+            Integer id = map.get(sig);\n+            if (id != null) {\n+                return id;\n+            }\n+            \/\/return 0;\n+            id = invokeCount++;\n+            map.put(sig, id);\n+            return id;\n+        }\n+    }\n+\n+    \/\/never used\n+    public static void addID(String className, String name, String descr, int id) {\n+        String sig = className + \".\" + name + descr;\n+        map.put(sig, id);\n+    }\n+\n","filename":"src\/classes\/com\/sun\/tdk\/jcov\/instrument\/DataAbstract.java","additions":27,"deletions":0,"binary":false,"changes":27,"status":"modified"},{"patch":"@@ -27,1 +27,0 @@\n-import com.sun.tdk.jcov.instrument.asm.InvokeMethodAdapter;\n@@ -138,1 +137,1 @@\n-                return CollectDetect.wasInvokeHit(InvokeMethodAdapter.getInvokeID(k.getFullname(), name, desc));\n+                return CollectDetect.wasInvokeHit(DataAbstract.getInvokeID(k.getFullname(), name, desc));\n@@ -143,1 +142,1 @@\n-                return CollectDetect.invokeCountFor(InvokeMethodAdapter.getInvokeID(k.getFullname(), name, desc));\n+                return CollectDetect.invokeCountFor(DataAbstract.getInvokeID(k.getFullname(), name, desc));\n@@ -148,1 +147,1 @@\n-                CollectDetect.setInvokeCountFor(InvokeMethodAdapter.getInvokeID(k.getFullname(), name, desc), count);\n+                CollectDetect.setInvokeCountFor(DataAbstract.getInvokeID(k.getFullname(), name, desc), count);\n@@ -532,1 +531,1 @@\n-                return CollectDetect.wasInvokeHit(InvokeMethodAdapter.getInvokeID(c.getFullname(), name, vmSig));\n+                return CollectDetect.wasInvokeHit(DataAbstract.getInvokeID(c.getFullname(), name, vmSig));\n@@ -537,1 +536,1 @@\n-                return CollectDetect.invokeCountFor(InvokeMethodAdapter.getInvokeID(c.getFullname(), name, vmSig));\n+                return CollectDetect.invokeCountFor(DataAbstract.getInvokeID(c.getFullname(), name, vmSig));\n@@ -542,1 +541,1 @@\n-                CollectDetect.setInvokeCountFor(InvokeMethodAdapter.getInvokeID(c.getFullname(), name, vmSig), count);\n+                CollectDetect.setInvokeCountFor(DataAbstract.getInvokeID(c.getFullname(), name, vmSig), count);\n","filename":"src\/classes\/com\/sun\/tdk\/jcov\/instrument\/DataField.java","additions":6,"deletions":7,"binary":false,"changes":13,"status":"modified"},{"patch":"@@ -28,1 +28,0 @@\n-import com.sun.tdk.jcov.instrument.asm.InvokeMethodAdapter;\n@@ -114,1 +113,1 @@\n-                return CollectDetect.wasInvokeHit(InvokeMethodAdapter.getInvokeID(k.getFullname(), name, desc));\n+                return CollectDetect.wasInvokeHit(DataAbstract.getInvokeID(k.getFullname(), name, desc));\n@@ -119,1 +118,1 @@\n-                return CollectDetect.invokeCountFor(InvokeMethodAdapter.getInvokeID(k.getFullname(), name, desc));\n+                return CollectDetect.invokeCountFor(DataAbstract.getInvokeID(k.getFullname(), name, desc));\n@@ -124,1 +123,1 @@\n-                CollectDetect.setInvokeCountFor(InvokeMethodAdapter.getInvokeID(k.getFullname(), name, desc), count);\n+                CollectDetect.setInvokeCountFor(DataAbstract.getInvokeID(k.getFullname(), name, desc), count);\n@@ -265,1 +264,1 @@\n-                return CollectDetect.wasInvokeHit(InvokeMethodAdapter.getInvokeID(parent.getFullname(), name, vmSig));\n+                return CollectDetect.wasInvokeHit(DataAbstract.getInvokeID(parent.getFullname(), name, vmSig));\n@@ -270,1 +269,1 @@\n-                return CollectDetect.invokeCountFor(InvokeMethodAdapter.getInvokeID(parent.getFullname(), name, vmSig));\n+                return CollectDetect.invokeCountFor(DataAbstract.getInvokeID(parent.getFullname(), name, vmSig));\n@@ -275,1 +274,1 @@\n-                CollectDetect.setInvokeCountFor(InvokeMethodAdapter.getInvokeID(parent.getFullname(), name, vmSig), count);\n+                CollectDetect.setInvokeCountFor(DataAbstract.getInvokeID(parent.getFullname(), name, vmSig), count);\n","filename":"src\/classes\/com\/sun\/tdk\/jcov\/instrument\/DataMethodInvoked.java","additions":6,"deletions":7,"binary":false,"changes":13,"status":"modified"},{"patch":"@@ -29,3 +29,0 @@\n-import java.util.Collections;\n-import java.util.HashMap;\n-import java.util.Map;\n@@ -33,0 +30,1 @@\n+import com.sun.tdk.jcov.instrument.DataAbstract;\n@@ -34,1 +32,0 @@\n-import com.sun.tdk.jcov.util.Utils;\n@@ -55,1 +52,0 @@\n-    static volatile int invokeCount = 0;\n@@ -59,16 +55,0 @@\n-    public static int getInvokeID(String owner, String name, String descr) {\n-        String sig = owner + \".\" + name + descr;\n-        synchronized (map) {\n-            Integer id = map.get(sig);\n-            if (id != null) {\n-                return id;\n-            }\n-            \/\/return 0;\n-            id = invokeCount++;\n-            map.put(sig, id);\n-            return id;\n-        }\n-    }\n-    final private static Map<String, Integer> map =\n-            Collections.synchronizedMap(new HashMap<String, Integer>());\n-\n@@ -87,1 +67,1 @@\n-            il.add(new LdcInsnNode(getInvokeID(owner, name, desc)));\n+            il.add(new LdcInsnNode(DataAbstract.getInvokeID(owner, name, desc)));\n@@ -113,1 +93,1 @@\n-            super.visitLdcInsn(getInvokeID(owner, name, desc));\n+            super.visitLdcInsn(DataAbstract.getInvokeID(owner, name, desc));\n@@ -288,5 +268,0 @@\n-    \/\/never used\n-    public static void addID(String className, String name, String descr, int id) {\n-        String sig = className + \".\" + name + descr;\n-        map.put(sig, id);\n-    }\n","filename":"src\/classes\/com\/sun\/tdk\/jcov\/instrument\/asm\/InvokeMethodAdapter.java","additions":3,"deletions":28,"binary":false,"changes":31,"status":"modified"}]}