{"files":[{"patch":"@@ -627,1 +627,1 @@\n-uint64_t VM_Version::CPUFeatures_parse(const char *ccstr, uint64_t &glibc_features) {\n+uint64_t VM_Version::CPUFeatures_parse(const char *ccstr, uint64_t &glibc_features, bool &verify_glibc_by_reexec) {\n@@ -631,0 +631,15 @@\n+    glibc_features = _glibc_features;\n+    return _features;\n+  }\n+  if (strcmp(ccstr, \"verify\") == 0) {\n+    verify_glibc_by_reexec = true;\n+#if INCLUDE_CPU_FEATURE_ACTIVE || INCLUDE_LD_SO_LIST_DIAGNOSTICS\n+    tty->print_cr(\"-XX:CPUFeatures=verify has no effect as glibc \"\n+# if INCLUDE_CPU_FEATURE_ACTIVE\n+                  \"CPU_FEATURE_ACTIVE\"\n+# elif INCLUDE_LD_SO_LIST_DIAGNOSTICS\n+                  \"ld.so --list-diagnostics\"\n+# endif \/\/ INCLUDE_LD_SO_LIST_DIAGNOSTICS\n+                  \" feature is available\");\n+#endif \/\/ INCLUDE_CPU_FEATURE_ACTIVE || INCLUDE_LD_SO_LIST_DIAGNOSTICS\n+    glibc_features = _glibc_features;\n@@ -1267,0 +1282,3 @@\n+  uint64_t       features_expected =   CPU_MAX - 1;\n+  uint64_t glibc_features_expected = GLIBC_MAX - 1;\n+  bool verify_glibc_by_reexec = false;\n@@ -1269,1 +1287,1 @@\n-    uint64_t   CPUFeatures_x64 = CPUFeatures_parse(CPUFeatures, GLIBCFeatures_x64);\n+    uint64_t   CPUFeatures_x64 = CPUFeatures_parse(CPUFeatures, GLIBCFeatures_x64, verify_glibc_by_reexec);\n@@ -1295,0 +1313,4 @@\n+\n+    if (ShowCPUFeatures) {\n+      tty->print_cr(\"CPU features being used are: -XX:CPUFeatures=0x\" UINT64_FORMAT_X \",0x\" UINT64_FORMAT_X, _features, _glibc_features);\n+    }\n@@ -1297,1 +1319,8 @@\n-  glibc_not_using((CPU_MAX - 1) & ~_features, (GLIBC_MAX - 1) & ~_glibc_features);\n+#if !INCLUDE_CPU_FEATURE_ACTIVE && !INCLUDE_LD_SO_LIST_DIAGNOSTICS\n+  if (!verify_glibc_by_reexec) {\n+          features_expected =       _features;\n+    glibc_features_expected = _glibc_features;\n+  }\n+#endif\n+  glibc_not_using(      features_expected & ~      _features,\n+                  glibc_features_expected & ~_glibc_features);\n","filename":"src\/hotspot\/cpu\/x86\/vm_version_x86.cpp","additions":32,"deletions":3,"binary":false,"changes":35,"status":"modified"},{"patch":"@@ -769,1 +769,1 @@\n-  static uint64_t CPUFeatures_parse(const char *ccstr, uint64_t &glibc_features);\n+  static uint64_t CPUFeatures_parse(const char *ccstr, uint64_t &glibc_features, bool &verify_glibc_by_reexec);\n","filename":"src\/hotspot\/cpu\/x86\/vm_version_x86.hpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"}]}