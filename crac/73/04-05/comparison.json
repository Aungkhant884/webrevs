{"files":[{"patch":"@@ -64,1 +64,0 @@\n-    boolean cleanupComplete = false;\n@@ -154,2 +153,0 @@\n-                    cleanupComplete = true;\n-                    \/\/ prevent looping in the cleanup\n@@ -172,0 +169,6 @@\n+        synchronized (this) {\n+            \/\/ wakeup the checkpoint thread when we this thread terminates before noticing\n+            \/\/ the forced cleanup\n+            forceCleanup = false;\n+            notify();\n+        }\n@@ -176,1 +179,4 @@\n-        cleanupComplete = false;\n+        if (phantomCleanableList.isListEmpty()) {\n+            \/\/ The thread is already terminated; don't wait for anything\n+            return;\n+        }\n@@ -179,1 +185,1 @@\n-        while (!cleanupComplete) {\n+        while (forceCleanup) {\n@@ -185,1 +191,1 @@\n-    public synchronized void afterRestore(Context<? extends Resource> context) throws Exception {\n+    public void afterRestore(Context<? extends Resource> context) {\n","filename":"src\/java.base\/share\/classes\/jdk\/internal\/ref\/CleanerImpl.java","additions":12,"deletions":6,"binary":false,"changes":18,"status":"modified"}]}