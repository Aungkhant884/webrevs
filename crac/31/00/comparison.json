{"files":[{"patch":"@@ -109,0 +109,35 @@\n+#ifdef __linux__\n+        for (int i = 1; i < argc; ++i) {\n+            if (!strstr(argv[i], \"-XX:CRaCCheckpointTo\")) {\n+                continue;\n+            }\n+\n+            char* tunables = getenv(\"GLIBC_TUNABLES\");\n+            \/\/ do not try overwrite an existing tunable setting\n+            if (tunables && strstr(tunables, \"glibc.pthread.rseq\")) {\n+                break;\n+            }\n+\n+            char tunables_buf[4096];\n+            char* new_tunables = NULL;\n+            if (!tunables) {\n+                new_tunables = \"GLIBC_TUNABLES=glibc.pthread.rseq=0\";\n+            } else {\n+                int sz = snprintf(tunables_buf, sizeof(tunables_buf), \"GLIBC_TUNABLES=%s:glibc.pthread.rseq=0\", tunables);\n+                if (sz < 0 || (int)sizeof(tunables_buf) <= sz) {\n+                    fprintf(stderr, \"Cannot update GLIBC_TUNABLES: does not fit\\n\");\n+                    return 1;\n+                }\n+                new_tunables = tunables_buf;\n+            }\n+\n+            if (putenv(new_tunables) < 0) {\n+                perror(\"putenv\");\n+                return 1;\n+            }\n+            execv(\"\/proc\/self\/exe\", argv);\n+            perror(\"re-exec\");\n+            return 1;\n+        }\n+#endif\n+\n","filename":"src\/java.base\/share\/native\/launcher\/main.c","additions":35,"deletions":0,"binary":false,"changes":35,"status":"modified"}]}