{"files":[{"patch":"@@ -96,0 +96,28 @@\n+\n+#include <sys\/wait.h>\n+\n+static int is_checkpoint = 0;\n+\n+static void parse_checkpoint(const char *arg) {\n+    if (!is_checkpoint) {\n+        const char *checkpoint_arg = \"-XX:CRaCCheckpointTo\";\n+        const int len = strlen(checkpoint_arg);\n+        if (0 == strncmp(arg, checkpoint_arg, len)) {\n+            is_checkpoint = 1;\n+        }\n+    }\n+}\n+\n+static int wait_for_children() {\n+    int status = 0;\n+    pid_t pid;\n+    do {\n+        int st = 0;\n+        pid = wait(&st);\n+        if (!status) {\n+            status = st;\n+        }\n+    } while (!(-1 == pid && ECHILD == errno));\n+    return status;\n+}\n+\n@@ -186,0 +214,1 @@\n+            parse_checkpoint(argv[i]);\n@@ -205,0 +234,7 @@\n+\n+    if (is_checkpoint && 1 == getpid()) {\n+        if (0 < fork()) {\n+            const int status = wait_for_children();\n+            exit(status);\n+        }\n+    }\n","filename":"src\/java.base\/share\/native\/launcher\/main.c","additions":36,"deletions":0,"binary":false,"changes":36,"status":"modified"}]}