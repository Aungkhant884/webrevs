{"files":[{"patch":"@@ -98,1 +98,1 @@\n-        const char* args[] = {\n+        const char* args[32] = {\n@@ -105,1 +105,0 @@\n-            NULL\n@@ -107,0 +106,12 @@\n+        const char** arg = args + 10;\n+        char *criuopts = getenv(\"CRAC_CRIU_OPTS\");\n+        if (criuopts) {\n+            char* criuopt = strtok(criuopts, \" \");\n+            while (criuopt) {\n+                *arg++ = criuopt;\n+                criuopt = strtok(NULL, \" \");\n+            }\n+        }\n+        *arg++ = NULL;\n+        assert(ARRAY_SIZE(args) >= (size_t)(arg - args));\n+\n@@ -158,2 +169,10 @@\n-    const char* args[32] = { criu, \"restore\" };\n-    const char** arg = args + 2;\n+    const char* args[32] = {\n+        criu,\n+        \"restore\",\n+        \"-W\", \".\",\n+        \"--shell-job\",\n+        \"--action-script\", self,\n+        \"-D\", imagedir,\n+        \"-v1\"\n+    };\n+    const char** arg = args + 10;\n@@ -164,0 +183,8 @@\n+    char *criuopts = getenv(\"CRAC_CRIU_OPTS\");\n+    if (criuopts) {\n+        char* criuopt = strtok(criuopts, \" \");\n+        while (criuopt) {\n+            *arg++ = criuopt;\n+            criuopt = strtok(NULL, \" \");\n+        }\n+    }\n@@ -165,5 +192,0 @@\n-        \"-W\", \".\",\n-        \"--shell-job\",\n-        \"--action-script\", self,\n-        \"-D\", imagedir,\n-        \"-v1\",\n@@ -173,2 +195,1 @@\n-    static_assert(ARRAY_SIZE(args) >= 2 + ARRAY_SIZE(tail),\n-            \"all possible arguments should fit\");\n+    assert(ARRAY_SIZE(args) >= (size_t)(arg - args + ARRAY_SIZE(tail)));\n","filename":"src\/java.base\/unix\/native\/criuengine\/criuengine.c","additions":32,"deletions":11,"binary":false,"changes":43,"status":"modified"}]}