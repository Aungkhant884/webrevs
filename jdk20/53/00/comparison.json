{"files":[{"patch":"@@ -1034,1 +1034,1 @@\n-      ~G1MergeCardSetCache() {\n+      void flush() {\n@@ -1123,1 +1123,4 @@\n-    G1MergeCardSetStats stats() const { return _stats; }\n+    G1MergeCardSetStats stats() {\n+      _merge_card_set_cache.flush();\n+      return _stats;\n+    }\n@@ -1190,2 +1193,1 @@\n-    G1RemSetScanState* _scan_state;\n-    G1MergeCardSetStats _merge_stats;\n+    G1MergeCardSetClosure _cl;\n@@ -1194,1 +1196,1 @@\n-    G1FlushHumongousCandidateRemSets(G1RemSetScanState* scan_state) : _scan_state(scan_state), _merge_stats() { }\n+    G1FlushHumongousCandidateRemSets(G1RemSetScanState* scan_state) : _cl(scan_state) { }\n@@ -1211,6 +1213,2 @@\n-      G1MergeCardSetStats stats;\n-      {\n-        G1MergeCardSetClosure cl(_scan_state);\n-        cl.merge_card_set_for_region(r);\n-        stats = cl.stats();\n-      }\n+\n+      _cl.merge_card_set_for_region(r);\n@@ -1236,1 +1234,3 @@\n-    size_t merged(uint i) const { return _merge_stats.merged(i); }\n+    G1MergeCardSetStats stats() {\n+      return _cl.stats();\n+    }\n@@ -1350,0 +1350,1 @@\n+          G1MergeCardSetStats stats = cl.stats();\n@@ -1352,1 +1353,1 @@\n-            p->record_or_add_thread_work_item(merge_remset_phase, worker_id, cl.merged(i), i);\n+            p->record_or_add_thread_work_item(merge_remset_phase, worker_id, stats.merged(i), i);\n@@ -1359,5 +1360,3 @@\n-        G1MergeCardSetStats stats;\n-        {\n-          G1MergeCardSetClosure merge(_scan_state);\n-          G1ClearBitmapClosure clear(g1h);\n-          G1CombinedClosure combined(&merge, &clear);\n+        G1MergeCardSetClosure merge(_scan_state);\n+        G1ClearBitmapClosure clear(g1h);\n+        G1CombinedClosure combined(&merge, &clear);\n@@ -1365,3 +1364,2 @@\n-          g1h->collection_set_iterate_increment_from(&combined, nullptr, worker_id);\n-          stats = merge.stats();\n-        }\n+        g1h->collection_set_iterate_increment_from(&combined, nullptr, worker_id);\n+        G1MergeCardSetStats stats = merge.stats();\n","filename":"src\/hotspot\/share\/gc\/g1\/g1RemSet.cpp","additions":19,"deletions":21,"binary":false,"changes":40,"status":"modified"}]}