{"files":[{"patch":"@@ -2,1 +2,1 @@\n- *  Copyright (c) 2019, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ *  Copyright (c) 2019, 2023, Oracle and\/or its affiliates. All rights reserved.\n@@ -186,1 +186,1 @@\n-        return owner == thread;\n+        return owner == null || owner == thread;\n","filename":"src\/java.base\/share\/classes\/jdk\/internal\/foreign\/MemorySessionImpl.java","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- *  Copyright (c) 2019, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ *  Copyright (c) 2019, 2023, Oracle and\/or its affiliates. All rights reserved.\n@@ -194,0 +194,19 @@\n+    @DataProvider(name = \"scopes\")\n+    public Object[][] scopes() {\n+        return new Object[][] {\n+                { SegmentScope.auto(), false },\n+                { SegmentScope.global(), false },\n+                { Arena.openConfined().scope(), true },\n+                { Arena.openShared().scope(), false }\n+        };\n+    }\n+\n+    @Test(dataProvider = \"scopes\")\n+    public void testIsAccessibleBy(SegmentScope scope, boolean isConfined) {\n+        assertTrue(scope.isAccessibleBy(Thread.currentThread()));\n+        assertTrue(scope.isAccessibleBy(new Thread()) != isConfined);\n+        MemorySegment segment = MemorySegment.ofAddress(0, 0, scope);\n+        assertTrue(segment.scope().isAccessibleBy(Thread.currentThread()));\n+        assertTrue(segment.scope().isAccessibleBy(new Thread()) != isConfined);\n+    }\n+\n@@ -267,1 +286,1 @@\n-        if (segment.scope().isAccessibleBy(Thread.currentThread())) {\n+        if (!segment.scope().isAccessibleBy(Thread.currentThread())) {\n@@ -269,3 +288,1 @@\n-            if (!(e instanceof IllegalStateException)) {\n-                throw e;\n-            }\n+            throw e;\n","filename":"test\/jdk\/java\/foreign\/TestSegments.java","additions":22,"deletions":5,"binary":false,"changes":27,"status":"modified"}]}