{"files":[{"patch":"@@ -60,1 +60,1 @@\n-    private Path TIDY;\n+    private final Path TIDY;\n@@ -130,0 +130,1 @@\n+                \/\/ If not found, look for known old\/bad versions, to report in error message\n@@ -132,0 +133,1 @@\n+                    Pattern oldVersion = Pattern.compile(\"2006\");  \/\/ 2006 implies old macOS version\n@@ -133,2 +135,4 @@\n-                    log.error(\"Could not determine the version of 'tidy' on the PATH\\n\" +\n-                            String.join(lineSep, lines));\n+                    String message = lines.stream().anyMatch(line -> oldVersion.matcher(line).find())\n+                        ? \"old version of 'tidy' found of  the PATH\\n\"\n+                        : \"could not determine the version of 'tidy' on the PATH\\n\";\n+                    log.error(message + String.join(lineSep, lines));\n","filename":"src\/classes\/doccheck\/html\/TidyChecker.java","additions":7,"deletions":3,"binary":false,"changes":10,"status":"modified"},{"patch":"@@ -10,2 +10,2 @@\n-+   *HTML* -- `doccheck` leverages the standard [tidy] utility to check for HTML \n-    compliance, according to the declared version of HTML. The output from `tidy` \n++ *HTML* -- `doccheck` leverages the standard [tidy] utility to check for HTML\n+    compliance, according to the declared version of HTML. The output from `tidy`\n@@ -14,1 +14,1 @@\n-+   *Accessibility* -- `doccheck` provides some very basic checking for\n++ *Accessibility* -- `doccheck` provides some very basic checking for\n@@ -18,1 +18,1 @@\n-+   *Bad Characters* -- `doccheck` assumes that HTML files are encoded in UTF-8,\n++ *Bad Characters* -- `doccheck` assumes that HTML files are encoded in UTF-8,\n@@ -21,1 +21,1 @@\n-+   *DocType* -- `doccheck` assumes that HTML files should use HTML5, and reports\n++ *DocType* -- `doccheck` assumes that HTML files should use HTML5, and reports\n@@ -24,1 +24,1 @@\n-+   *Legal* -- `doccheck` checks for the presence of expected legal text, such as\n++ *Legal* -- `doccheck` checks for the presence of expected legal text, such as\n@@ -27,1 +27,1 @@\n-+   *Links* -- `doccheck` checks links within a set of files, and reports on links\n++ *Links* -- `doccheck` checks links within a set of files, and reports on links\n@@ -30,3 +30,3 @@\n-+   *External Links* -- `doccheck` scans the files for URLs that refer to\n-    external resources, and validates those references. Each external reference \n-    is only checked once; but if an issue is found, all the files containing the \n++ *External Links* -- `doccheck` scans the files for URLs that refer to\n+    external resources, and validates those references. Each external reference\n+    is only checked once; but if an issue is found, all the files containing the\n@@ -42,1 +42,1 @@\n-`$ java -jar` _\/path\/to\/_`doccheck.jar`  _options_  _files_  \n+`$ java -jar` _\/path\/to\/_`doccheck.jar`  _options_  _files_\n@@ -46,1 +46,1 @@\n-The _options_ include:  \n+The _options_ include:\n@@ -54,1 +54,1 @@\n-    \n+\n@@ -57,1 +57,1 @@\n-    `all`            Enable all checks \n+    `all`            Enable all checks\n@@ -66,1 +66,1 @@\n-  \n+\n@@ -72,1 +72,1 @@\n-    The option may be given multiple times.  \n+    The option may be given multiple times.\n@@ -83,1 +83,1 @@\n-:   Specify one or more regular expressions, separated by white-space, for URLs to \n+:   Specify one or more regular expressions, separated by white-space, for URLs to\n@@ -86,1 +86,1 @@\n-   \n+\n@@ -91,1 +91,1 @@\n-   \n+\n@@ -94,1 +94,1 @@\n-    \n+\n@@ -98,1 +98,1 @@\n-    \n+\n@@ -105,1 +105,1 @@\n-    subdirectory. \n+    subdirectory.\n@@ -107,1 +107,1 @@\n-    \n+\n@@ -112,1 +112,1 @@\n-    \n+\n@@ -115,1 +115,1 @@\n-    \n+\n@@ -118,1 +118,1 @@\n-    \n+\n@@ -121,2 +121,2 @@\n-    If the file is an existing directory, or ends with `\/`, \n-    the report will be split into separate files in the directory; \n+    If the file is an existing directory, or ends with `\/`,\n+    the report will be split into separate files in the directory;\n@@ -125,0 +125,16 @@\n+### `tidy`\n+\n+A suitable version of `tidy` should be available on the execution `PATH`.\n+The output from the `--version` option should include a line containing the\n+string `version 5`.  You can also override which version of `tidy` to use\n+by setting the `tidy` system property.\n+\n+<div style=\"border: 1px solid red; border-radius: 10px; padding: 10px\">\n+Note that the version of <code>tidy<\/code> on macOS available by default in\n+<code>\/usr\/bin\/tidy<\/code> is old and should <b>not<\/b> be used.\n+It does not support HTML&nbsp;5. This version identifies itself as:\n+\n+> HTML Tidy for Mac OS X released on 31 October 2006 - Apple Inc. build 2649\n+<\/div>\n+\n+\n@@ -130,1 +146,1 @@\n-details of any errors that are found. \n+details of any errors that are found.\n@@ -136,3 +152,3 @@\n-When the `--jdk` option is used, a special mode is invoked, such that the checks \n-are invoked separately on the set of files for each of the specified modules, \n-writing a report for each invocation into subdirectories of the output directory. \n+When the `--jdk` option is used, a special mode is invoked, such that the checks\n+are invoked separately on the set of files for each of the specified modules,\n+writing a report for each invocation into subdirectories of the output directory.\n@@ -140,1 +156,1 @@\n-this report is a table containing one line per module, giving a simple visual \n+this report is a table containing one line per module, giving a simple visual\n@@ -143,1 +159,1 @@\n-A title for the report can be specified with the `--title` option; \n+A title for the report can be specified with the `--title` option;\n@@ -168,1 +184,1 @@\n-Also, some external URLs may not be available before a version of JDK is released. \n+Also, some external URLs may not be available before a version of JDK is released.\n@@ -172,1 +188,1 @@\n-When using the 'legal' checker, it is recommended to specify one or more regular expressions \n+When using the 'legal' checker, it is recommended to specify one or more regular expressions\n@@ -205,1 +221,1 @@\n-When using the `--jdk` option, you should not specify any additional files on \n+When using the `--jdk` option, you should not specify any additional files on\n","filename":"src\/doc\/doccheck.md","additions":53,"deletions":37,"binary":false,"changes":90,"status":"modified"}]}