{"files":[{"patch":"@@ -3,1 +3,1 @@\n- * Copyright (c) 2016, 2019 SAP SE. All rights reserved.\n+ * Copyright (c) 2016, 2023 SAP SE. All rights reserved.\n@@ -2987,1 +2987,1 @@\n-    __ asm_assert_ne(\"unexpected null obj\", __LINE__);\n+    __ asm_assert(Assembler::bcondNotZero, \"unexpected null obj\", __LINE__);\n@@ -2998,1 +2998,1 @@\n-      __ asm_assert_eq(\"exact klass and actual klass differ\", __LINE__);\n+      __ asm_assert(Assembler::bcondEqual, \"exact klass and actual klass differ\", __LINE__);\n","filename":"src\/hotspot\/cpu\/s390\/c1_LIRAssembler_s390.cpp","additions":3,"deletions":3,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -3,1 +3,1 @@\n- * Copyright (c) 2018, 2019 SAP SE. All rights reserved.\n+ * Copyright (c) 2018, 2023 SAP SE. All rights reserved.\n@@ -180,1 +180,1 @@\n-    __ asm_assert_ne(\"null oop not allowed (G1 pre)\", 0x321); \/\/ Checked by caller.\n+    __ asm_assert(Assembler::bcondNotZero, \"null oop not allowed (G1 pre)\", 0x321); \/\/ Checked by caller.\n@@ -292,1 +292,1 @@\n-    __ asm_assert_ne(\"null oop not allowed (G1 post)\", 0x322); \/\/ Checked by caller.\n+    __ asm_assert(Assembler::bcondNotZero, \"null oop not allowed (G1 post)\", 0x322); \/\/ Checked by caller.\n","filename":"src\/hotspot\/cpu\/s390\/gc\/g1\/g1BarrierSetAssembler_s390.cpp","additions":3,"deletions":3,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -2077,1 +2077,1 @@\n-    asm_assert_eq(\"[old_sp]!=[Z_SP]\", 0x211);\n+    asm_assert(bcondEqual, \"[old_sp]!=[Z_SP]\", 0x211);\n@@ -5329,23 +5329,2 @@\n-#ifndef PRODUCT\n-\/\/ Assert if CC indicates \"not equal\" (check_equal==true) or \"equal\" (check_equal==false).\n-void MacroAssembler::asm_assert(bool check_equal, const char *msg, int id) {\n-  Label ok;\n-  if (check_equal) {\n-    z_bre(ok);\n-  } else {\n-    z_brne(ok);\n-  }\n-  stop(msg, id);\n-  bind(ok);\n-}\n-\n-\/\/ Assert if CC indicates \"low\".\n-void MacroAssembler::asm_assert_low(const char *msg, int id) {\n-  Label ok;\n-  z_brnl(ok);\n-  stop(msg, id);\n-  bind(ok);\n-}\n-\n-\/\/ Assert if CC indicates \"high\".\n-void MacroAssembler::asm_assert_high(const char *msg, int id) {\n+void MacroAssembler::asm_assert(branch_condition cond, const char* msg, int id, bool is_static) {\n+#ifdef ASSERT\n@@ -5353,2 +5332,2 @@\n-  z_brnh(ok);\n-  stop(msg, id);\n+  z_brc(cond, ok);\n+  is_static ? stop_static(msg, id) : stop(msg, id);\n@@ -5356,0 +5335,1 @@\n+#endif \/\/ ASSERT\n@@ -5358,8 +5338,5 @@\n-\/\/ Assert if CC indicates \"not equal\" (check_equal==true) or \"equal\" (check_equal==false)\n-\/\/ generate non-relocatable code.\n-void MacroAssembler::asm_assert_static(bool check_equal, const char *msg, int id) {\n-  Label ok;\n-  if (check_equal) { z_bre(ok); }\n-  else             { z_brne(ok); }\n-  stop_static(msg, id);\n-  bind(ok);\n+\/\/ Assert if CC indicates \"not equal\" (check_equal==true) or \"equal\" (check_equal==false).\n+void MacroAssembler::asm_assert(bool check_equal, const char *msg, int id) {\n+#ifdef ASSERT\n+  asm_assert(check_equal ? bcondEqual : bcondNotEqual, msg, id);\n+#endif \/\/ ASSERT\n@@ -5370,0 +5347,1 @@\n+#ifdef ASSERT\n@@ -5380,2 +5358,3 @@\n-  if (allow_relocation) { asm_assert(check_equal, msg, id); }\n-  else                  { asm_assert_static(check_equal, msg, id); }\n+  \/\/ if relocation is not allowed then stop_static() will be called otherwise call stop()\n+  asm_assert(check_equal ? bcondEqual : bcondNotEqual, msg, id, !allow_relocation);\n+#endif \/\/ ASSERT\n@@ -5390,10 +5369,6 @@\n-  if (tmp == noreg) {\n-    tmp = expected_size;\n-  } else {\n-    if (tmp != expected_size) {\n-      z_lgr(tmp, expected_size);\n-    }\n-    z_algr(tmp, Z_SP);\n-    z_slg(tmp, 0, Z_R0, Z_SP);\n-    asm_assert_eq(msg, id);\n-  }\n+#ifdef ASSERT\n+  lgr_if_needed(tmp, expected_size);\n+  z_algr(tmp, Z_SP);\n+  z_slg(tmp, 0, Z_R0, Z_SP);\n+  asm_assert(bcondEqual, msg, id);\n+#endif \/\/ ASSERT\n@@ -5401,1 +5376,0 @@\n-#endif \/\/ !PRODUCT\n@@ -5522,2 +5496,2 @@\n-  z_illtrap(); \/\/ Illegal instruction.\n-  z_illtrap(); \/\/ Illegal instruction.\n+  z_illtrap(id); \/\/ Illegal instruction.\n+  z_illtrap(id); \/\/ Illegal instruction.\n@@ -5562,1 +5536,1 @@\n-    z_illtrap(); \/\/ Illegal instruction as emergency stop, should the above call return.\n+    z_illtrap(id); \/\/ Illegal instruction as emergency stop, should the above call return.\n","filename":"src\/hotspot\/cpu\/s390\/macroAssembler_s390.cpp","additions":24,"deletions":50,"binary":false,"changes":74,"status":"modified"},{"patch":"@@ -3,1 +3,1 @@\n- * Copyright (c) 2016, 2022 SAP SE. All rights reserved.\n+ * Copyright (c) 2016, 2023 SAP SE. All rights reserved.\n@@ -866,7 +866,2 @@\n-  void asm_assert(bool check_equal, const char* msg, int id) PRODUCT_RETURN;\n-  void asm_assert_low(const char *msg, int id) PRODUCT_RETURN;\n-  void asm_assert_high(const char *msg, int id) PRODUCT_RETURN;\n-  void asm_assert_eq(const char* msg, int id) { asm_assert(true, msg, id); }\n-  void asm_assert_ne(const char* msg, int id) { asm_assert(false, msg, id); }\n-\n-  void asm_assert_static(bool check_equal, const char* msg, int id) PRODUCT_RETURN;\n+  void asm_assert(branch_condition cond, const char* msg, int id, bool is_static=true);\n+  void asm_assert(bool check_equal, const char* msg, int id);\n@@ -877,1 +872,1 @@\n-                            Register mem_base, const char* msg, int id) PRODUCT_RETURN;\n+                            Register mem_base, const char* msg, int id);\n@@ -892,1 +887,0 @@\n-\n@@ -905,1 +899,1 @@\n-  void asm_assert_frame_size(Register expected_size, Register tmp, const char* msg, int id) PRODUCT_RETURN;\n+  void asm_assert_frame_size(Register expected_size, Register tmp, const char* msg, int id);\n","filename":"src\/hotspot\/cpu\/s390\/macroAssembler_s390.hpp","additions":5,"deletions":11,"binary":false,"changes":16,"status":"modified"},{"patch":"@@ -122,1 +122,1 @@\n-  __ asm_assert_ne(\"handler must not be null\", 0x852);\n+  __ asm_assert(Assembler::bcondNotZero, \"handler must not be null\", 0x852);\n","filename":"src\/hotspot\/cpu\/s390\/runtime_s390.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -3,1 +3,1 @@\n- * Copyright (c) 2016, 2019 SAP SE. All rights reserved.\n+ * Copyright (c) 2016, 2023 SAP SE. All rights reserved.\n@@ -2481,1 +2481,1 @@\n-  __ asm_assert_ne(\"array_size must be > 0\", 0x205);\n+  __ asm_assert(Assembler::bcondNotZero, \"array_size must be > 0\", 0x205);\n@@ -2791,1 +2791,1 @@\n-  __ asm_assert_eq(\"SharedRuntime::generate_deopt_blob: expected Unpack_uncommon_trap\", 0);\n+  __ asm_assert(Assembler::bcondEqual, \"SharedRuntime::generate_deopt_blob: expected Unpack_uncommon_trap\", 0);\n","filename":"src\/hotspot\/cpu\/s390\/sharedRuntime_s390.cpp","additions":3,"deletions":3,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -375,1 +375,1 @@\n-      __ asm_assert_low(assertMsg, 0x0234);\n+      __ asm_assert(Assembler::bcondNotLow, assertMsg, 0x0234);\n@@ -377,1 +377,1 @@\n-      __ asm_assert_high(assertMsg, 0x0235);\n+      __ asm_assert(Assembler::bcondNotHigh, assertMsg, 0x0235);\n@@ -743,1 +743,1 @@\n-    __ asm_assert_eq(\"missing zero extend\", 0xAFFE);\n+    __ asm_assert(Assembler::bcondZero, \"missing zero extend\", 0xAFFE);\n","filename":"src\/hotspot\/cpu\/s390\/stubGenerator_s390.cpp","additions":3,"deletions":3,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -3,1 +3,1 @@\n- * Copyright (c) 2016, 2017 SAP SE. All rights reserved.\n+ * Copyright (c) 2016, 2023 SAP SE. All rights reserved.\n@@ -58,0 +58,1 @@\n+    __ stop(\"crc_table: external word relocation required for load_absolute_address\", 0x33);\n@@ -59,1 +60,0 @@\n-    __ asm_assert_eq(\"crc_table: external word relocation required for load_absolute_address\", 0x33);\n@@ -68,0 +68,1 @@\n+    __ asm_assert(Assembler::bcondEqual, \"crc_table: address or contents seems to be messed up\", 0x22);\n@@ -69,1 +70,0 @@\n-    __ asm_assert_eq(\"crc_table: address or contents seems to be messed up\", 0x22);\n@@ -103,0 +103,1 @@\n+      __ stop(\"crc_table: external word relocation does not work for load_absolute_address\", 0x33);\n@@ -104,1 +105,0 @@\n-      __ asm_assert_eq(\"crc_table: external word relocation does not work for load_absolute_address\", 0x33);\n@@ -113,0 +113,1 @@\n+      __ asm_assert(Assembler::bcondEqual, \"trot_table: address or contents seems to be messed up\", 0x22);\n@@ -114,1 +115,0 @@\n-      __ asm_assert_eq(\"trot_table: address or contents seems to be messed up\", 0x22);\n","filename":"src\/hotspot\/cpu\/s390\/stubRoutines_s390.cpp","additions":5,"deletions":5,"binary":false,"changes":10,"status":"modified"},{"patch":"@@ -1091,1 +1091,1 @@\n-  NOT_PRODUCT(__ asm_assert_eq(\"killed Z_R14\", 0));\n+  NOT_PRODUCT(__ asm_assert(Assembler::bcondEqual, \"killed Z_R14\", 0));\n","filename":"src\/hotspot\/cpu\/s390\/templateInterpreterGenerator_s390.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"}]}