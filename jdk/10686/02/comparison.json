{"files":[{"patch":"@@ -1009,1 +1009,1 @@\n-    return -1;\n+    return OS_ERR;\n@@ -1176,2 +1176,0 @@\n-  ResourceMark rm;\n-\n@@ -1199,0 +1197,1 @@\n+  \/\/ open the shared memory file for the give vmid\n@@ -1201,6 +1200,2 @@\n-  \/\/ copy heap memory to resource memory. the open_sharedmem_file\n-  \/\/ method below need to use the filename, but could throw an\n-  \/\/ exception. using a resource array prevents the leak that\n-  \/\/ would otherwise occur.\n-  char* rfilename = NEW_RESOURCE_ARRAY(char, strlen(filename) + 1);\n-  strcpy(rfilename, filename);\n+  \/\/ We don't use CHECK as we need to free the strings even if an exception occurred.\n+  int fd = open_sharedmem_file(filename, file_flags, THREAD);\n@@ -1213,9 +1208,1 @@\n-  \/\/ open the shared memory file for the give vmid\n-  int fd = open_sharedmem_file(rfilename, file_flags, THREAD);\n-\n-  if (fd == OS_ERR) {\n-    return;\n-  }\n-\n-  if (HAS_PENDING_EXCEPTION) {\n-    ::close(fd);\n+  if (fd == OS_ERR || HAS_PENDING_EXCEPTION) {\n","filename":"src\/hotspot\/os\/posix\/perfMemory_posix.cpp","additions":5,"deletions":18,"binary":false,"changes":23,"status":"modified"}]}