{"files":[{"patch":"@@ -39,0 +39,2 @@\n+import java.math.BigDecimal;\n+import java.math.RoundingMode;\n@@ -256,1 +258,1 @@\n-        private static int roundDown(double d)\n+        private static int roundHalfDown(double d)\n@@ -291,1 +293,1 @@\n-                stkWidth = roundDown(Math.min(at.getScaleX(), at.getScaleY()));\n+                stkWidth = roundHalfDown(Math.min(at.getScaleX(), at.getScaleY()));\n@@ -301,4 +303,4 @@\n-                width = roundDown(at.getScaleX() * w);\n-                height = roundDown(at.getScaleY() * h);\n-                xtranslation = roundDown(at.getScaleX() * x + at.getTranslateX());\n-                ytranslation = roundDown(at.getScaleY() * y + at.getTranslateY());\n+                width = roundHalfDown(at.getScaleX() * w);\n+                height = roundHalfDown(at.getScaleY() * h);\n+                xtranslation = roundHalfDown(at.getScaleX() * x + at.getTranslateX());\n+                ytranslation = roundHalfDown(at.getScaleY() * y + at.getTranslateY());\n","filename":"src\/java.desktop\/share\/classes\/javax\/swing\/plaf\/metal\/MetalBorders.java","additions":8,"deletions":6,"binary":false,"changes":14,"status":"modified"},{"patch":"@@ -24,6 +24,0 @@\n-import javax.imageio.ImageIO;\n-import javax.swing.JFrame;\n-import javax.swing.JInternalFrame;\n-import javax.swing.JLabel;\n-import javax.swing.SwingUtilities;\n-import javax.swing.UIManager;\n@@ -32,1 +26,0 @@\n-import java.awt.Graphics2D;\n@@ -34,0 +27,1 @@\n+import java.awt.Image;\n@@ -37,1 +31,2 @@\n-import java.awt.image.BufferedImage;\n+import java.awt.image.MultiResolutionImage;\n+import java.awt.image.RenderedImage;\n@@ -40,0 +35,8 @@\n+import java.util.List;\n+\n+import javax.imageio.ImageIO;\n+import javax.swing.JFrame;\n+import javax.swing.JInternalFrame;\n+import javax.swing.JLabel;\n+import javax.swing.SwingUtilities;\n+import javax.swing.UIManager;\n@@ -88,1 +91,1 @@\n-    private static float uiScale;\n+    private static String uiScale;\n@@ -102,1 +105,1 @@\n-            uiScale = Float.parseFloat(System.getProperty(\"sun.java2d.uiScale\"));\n+            uiScale =System.getProperty(\"sun.java2d.uiScale\");\n@@ -182,1 +185,1 @@\n-                saveScreenCapture(borderDirection + \"_\" + uiScale + \".png\", uiScale);\n+                saveMRImage(borderDirection + \"_uiScale\" + uiScale + \".png\");\n@@ -216,1 +219,1 @@\n-            saveScreenCapture(cornerLocation + \"_\" + uiScale + \".png\", uiScale);\n+            saveMRImage(cornerLocation + \"_uiScale\" + uiScale + \".png\");\n@@ -244,4 +247,4 @@\n-    private static void saveScreenCapture(String filename, float scale) {\n-        BufferedImage image = robot.createScreenCapture(jFrameBounds);\n-        BufferedImage scaledImage = new BufferedImage((int) (scale * image.getWidth(null)),\n-            (int) (scale * image.getHeight(null)), BufferedImage.TYPE_INT_ARGB);\n+    private static void saveMRImage(String filename) {\n+        Image nativeResImage;\n+        MultiResolutionImage mrImage = robot.createMultiResolutionScreenCapture(jFrameBounds);\n+        List<Image> resolutionVariants = mrImage.getResolutionVariants();\n@@ -249,4 +252,5 @@\n-        Graphics2D g2d = (Graphics2D) scaledImage.getGraphics();\n-        g2d.scale(scale, scale);\n-        g2d.drawImage(image, 0, 0, null);\n-        g2d.dispose();\n+        if (resolutionVariants.size() > 1) {\n+            nativeResImage = resolutionVariants.get(1);\n+        } else {\n+            nativeResImage = resolutionVariants.get(0);\n+        }\n@@ -255,1 +259,2 @@\n-            ImageIO.write(scaledImage, \"png\", new File(filename));\n+            ImageIO.write((RenderedImage) nativeResImage,\n+                    \"png\", new File(filename));\n","filename":"test\/jdk\/javax\/swing\/JInternalFrame\/InternalFrameBorderTest.java","additions":26,"deletions":21,"binary":false,"changes":47,"status":"modified"}]}