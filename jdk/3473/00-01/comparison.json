{"files":[{"patch":"@@ -47,0 +47,1 @@\n+import  java.util.concurrent.atomic.AtomicReference;\n@@ -59,1 +60,1 @@\n-        final IOException [] exception = { (IOException) null };\n+        final AtomicReference<IOException> exception = new AtomicReference<>();\n@@ -74,4 +75,2 @@\n-                } catch (IOException e) {\n-                    if (exception[0] == null) {\n-                        exception[0] = e;\n-                    }\n+                } catch (IOException ex) {\n+                    exception.compareAndSet(ex, null);\n@@ -97,3 +96,1 @@\n-                    if (exception[0] == null) {\n-                        exception[0] = ex;\n-                    }\n+                    exception.compareAndSet(ex, null);\n@@ -104,2 +101,2 @@\n-        if (exception[0] != null) {\n-            throw exception[0];\n+        if (exception.get() != null) {\n+            throw exception.get();\n","filename":"src\/jdk.jpackage\/share\/classes\/jdk\/jpackage\/internal\/IOUtils.java","additions":7,"deletions":10,"binary":false,"changes":17,"status":"modified"},{"patch":"@@ -92,2 +92,2 @@\n-    public Executor setTmpDir(String tmp) {\n-        tmpDir = tmp;\n+    public Executor setWindowsTmpDir(String tmp) {\n+        winTmpDir = tmp;\n@@ -287,2 +287,2 @@\n-        if (tmpDir != null) {\n-            builder.environment().put(\"TMP\", tmpDir);\n+        if (winTmpDir != null) {\n+            builder.environment().put(\"TMP\", winTmpDir);\n@@ -437,1 +437,1 @@\n-    private String tmpDir = null;\n+    private String winTmpDir = null;\n","filename":"test\/jdk\/tools\/jpackage\/helpers\/jdk\/jpackage\/test\/Executor.java","additions":5,"deletions":5,"binary":false,"changes":10,"status":"modified"},{"patch":"@@ -646,1 +646,3 @@\n-            exec.setTmpDir(System.getProperty(\"java.io.tmpdir\"));\n+            if (TKit.isWindows()) {\n+                exec.setWindowsTmpDir(System.getProperty(\"java.io.tmpdir\"));\n+            }\n","filename":"test\/jdk\/tools\/jpackage\/helpers\/jdk\/jpackage\/test\/JPackageCommand.java","additions":3,"deletions":1,"binary":false,"changes":4,"status":"modified"}]}