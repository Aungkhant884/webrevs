{"files":[{"patch":"@@ -145,20 +145,22 @@\n-                        int exitValue = waitForProcessExit0(pid, shouldReap);\n-                        if (exitValue == NOT_A_CHILD) {\n-                            \/\/ pid not alive or not a child of this process\n-                            \/\/ If it is alive wait for it to terminate\n-                            long sleep = 300;     \/\/ initial milliseconds to sleep\n-                            int incr = 30;        \/\/ increment to the sleep time\n-\n-                            long startTime = isAlive0(pid);\n-                            long origStart = startTime;\n-                            while (startTime >= 0) {\n-                                try {\n-                                    Thread.sleep(Math.min(sleep, 5000L)); \/\/ no more than 5 sec\n-                                    sleep += incr;\n-                                } catch (InterruptedException ie) {\n-                                    \/\/ ignore and retry\n-                                }\n-                                startTime = isAlive0(pid);  \/\/ recheck if it is alive\n-                                if (startTime > 0 && origStart > 0 && startTime != origStart) {\n-                                    \/\/ start time changed (and is not zero), pid is not the same process\n-                                    break;\n+                        try {\n+                            int exitValue = waitForProcessExit0(pid, shouldReap);\n+                            if (exitValue == NOT_A_CHILD) {\n+                                \/\/ pid not alive or not a child of this process\n+                                \/\/ If it is alive wait for it to terminate\n+                                long sleep = 300;     \/\/ initial milliseconds to sleep\n+                                int incr = 30;        \/\/ increment to the sleep time\n+\n+                                long startTime = isAlive0(pid);\n+                                long origStart = startTime;\n+                                while (startTime >= 0) {\n+                                    try {\n+                                        Thread.sleep(Math.min(sleep, 5000L)); \/\/ no more than 5 sec\n+                                        sleep += incr;\n+                                    } catch (InterruptedException ie) {\n+                                        \/\/ ignore and retry\n+                                    }\n+                                    startTime = isAlive0(pid);  \/\/ recheck if it is alive\n+                                    if (startTime > 0 && origStart > 0 && startTime != origStart) {\n+                                        \/\/ start time changed (and is not zero), pid is not the same process\n+                                        break;\n+                                    }\n@@ -166,0 +168,1 @@\n+                                exitValue = 0;\n@@ -167,1 +170,6 @@\n-                            exitValue = 0;\n+                            newCompletion.complete(exitValue);\n+                            \/\/ remove from cache afterwards\n+                            completions.remove(pid, newCompletion);\n+                        } finally {\n+                            \/\/ Restore thread name\n+                            Thread.currentThread().setName(threadName);\n@@ -169,5 +177,0 @@\n-                        newCompletion.complete(exitValue);\n-                        \/\/ remove from cache afterwards\n-                        completions.remove(pid, newCompletion);\n-                        \/\/ Restore thread name\n-                        Thread.currentThread().setName(threadName);\n","filename":"src\/java.base\/share\/classes\/java\/lang\/ProcessHandleImpl.java","additions":29,"deletions":26,"binary":false,"changes":55,"status":"modified"}]}