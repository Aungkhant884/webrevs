[{"commit":{"message":"4200096: removing whitespace diffs\n\nprrace pointed out this branch introduced some pointless whitespace changes.\nhttps:\/\/github.com\/openjdk\/jdk\/pull\/13408#discussion_r1164740594"},"files":[{"filename":"src\/java.desktop\/share\/classes\/sun\/awt\/image\/OffScreenImageSource.java"}],"sha":"fd751f577d35686542ef7c894256d5d8b6dc19a5"},{"commit":{"message":"4200096: updating test class header to better describe test"},"files":[{"filename":"test\/jdk\/sun\/awt\/image\/OffScreenImageSource\/bug4200096\/AddNullConsumerTest.java"}],"sha":"ff469b23e434df0fb09baf7536634d31bcef3cf6"},{"commit":{"message":"4200096: rewrite solution, only print stacktrace if theConsumer != null\n\nI don't like that we're *expecting* a NullPointerException to get thrown in the course of an allowed use case, but that's probably just a preferences on my part. More importantly: this branch passes all new unit tests. Plus it's readable and easy to code review.\n\nThis is related to the latest round of PR feedback here:\nhttps:\/\/github.com\/openjdk\/jdk\/pull\/13408#issuecomment-1504605358"},"files":[{"filename":"src\/java.desktop\/share\/classes\/sun\/awt\/image\/OffScreenImageSource.java"}],"sha":"1a6c1774865fb1b6e355e986202bd4325f199b2d"},{"commit":{"message":"4200096: rewrite solution, add LegitimateNullPointerTest\n\nAlso I'm breaking out the unit tests (now there are 4 of them) into their own directory.\n\nThe new LegitimateNullPointerTest confirms that we DO want to see NullPointerExceptions printed to System.err IF they come from the ImageConsumer itself.\n\nIn this ticket most of our focus has been on the NPE's that stem from removing an ImageConsumer from OSIS mid-production (so the NPE was when OSIS tried to interact with its `theConsumer` field). This test tries to add other possible NPE's to our consideration.\n\nThis new test passed in the master branch before this branch. I want to preserve this existing behavior if this proposal is accepted."},"files":[{"filename":"src\/java.desktop\/share\/classes\/sun\/awt\/image\/OffScreenImageSource.java"},{"filename":"test\/jdk\/sun\/awt\/image\/OffScreenImageSource\/bug4200096\/AddNullConsumerTest.java"},{"filename":"test\/jdk\/sun\/awt\/image\/OffScreenImageSource\/bug4200096\/ImageSizeTest.java"},{"filename":"test\/jdk\/sun\/awt\/image\/OffScreenImageSource\/bug4200096\/LegitimateNullPointerTest.java"},{"filename":"test\/jdk\/sun\/awt\/image\/OffScreenImageSource\/bug4200096\/bug4200096.java"}],"sha":"573bdd3a62043c5d0f9b783d36d0bd13d1c5b725"},{"commit":{"message":"4200096: OffScreenImageSource.removeConsumer NullPointerException\n\nMake sure OffScreenImageSource#addConsumer doesn't throw a NPE if the argument is null.\n\nThe rationale here is:\nThe preexisting implementation wouldn't throw a NPE, so we shouldn't change that now.\n\n(Or more specifically: the preexisting implementation *would* throw a NPE, but it would also catch it and print it to System.err. The caller wouldn't need to anticipate a NPE.)"},"files":[{"filename":"src\/java.desktop\/share\/classes\/sun\/awt\/image\/OffScreenImageSource.java"}],"sha":"36feaad061150eededede76008919f34d7268b7b"},{"commit":{"message":"4200096: OffScreenImageSource.removeConsumer NullPointerException\n\nChanging `runImageConsumerTest` to make sure we're explicitly testing a `OffScreenImageSource`.\n\nBy contrast: the `runImageDimensionTest` is more of an integration-style test that *happens* to test the `OffScreenImageSource`."},"files":[],"sha":"8434bfbcb96af0c463d273cba4fec9cc656233eb"},{"commit":{"message":"4200096: OffScreenImageSource.removeConsumer NullPointerException\n\nAdding createAbstractImage() with a little documentation to clarify why we're creating an image the way we are."},"files":[],"sha":"39d3bb31dd154e6342d32672b12f2ce44722b495"},{"commit":{"message":"4200096: OffScreenImageSource.removeConsumer NullPointerException\n\nRe-adding the 'synchronized' keyword.\n\nWe can probably do without it now, but I'm just trying to minimize possible unintended side-effects of this PR. Nobody asked for improved multithreaded support. And this class is used to iterate over BufferedImages (which are already in memory), so (as long as the ImageConsumer isn't taking too long -- or blocking) this should be very fast."},"files":[{"filename":"src\/java.desktop\/share\/classes\/sun\/awt\/image\/OffScreenImageSource.java"}],"sha":"ef9d263a2fd2a2fb8c785bcf4e8113e631909d5a"},{"commit":{"message":"4200096: OffScreenImageSource.removeConsumer NullPointerException\n\nIn code review prrace pointed out:\n> I'd capture \"theConsumer\" into a local var in each of the methods sendPixel() and produce() and check and use the local var\n\nhttps:\/\/github.com\/openjdk\/jdk\/pull\/13408#issuecomment-1502348061\n\nThis is actually my previous\/original draft for JDK-4200096 ( 49a49ee8585e8a4b5f33a6af04f2ce0165bf1199 ), but I shied way from this approach because I was afraid code reviewers would point out its changes are excessively invasive for the original complaint. (For ex: now OSIS supports multithreading, which nobody asked for. Should I re-add the `synchronized` method modifiers? (although they are theoretically no longer necessary, keeping them reduces the risk of unintended consequences...) Or if multithreaded support is worth keeping: should I at least add a unit test for it? These questions seemed like they're straying off-topic from the original bug.)"},"files":[{"filename":"src\/java.desktop\/share\/classes\/sun\/awt\/image\/OffScreenImageSource.java"}],"sha":"3a125e05ccee2077c1264128890fd748c9f49f40"},{"commit":{"message":"4200096: OffScreenImageSource.removeConsumer NullPointerException\n\nIn code review mrserb pointed out we shouldn't use System.exit(1) as an error condition.\n\nhttps:\/\/github.com\/openjdk\/jdk\/pull\/13408#discussion_r1162182212"},"files":[],"sha":"c1e8353b5a23aced59e83d5a4afb1bc4b1b677f0"},{"commit":{"message":"4200096: OffScreenImageSource.removeConsumer NullPointerException\n\nRewriting this resolution. I think the previous approach would be too big a change for such a low priority bug."},"files":[{"filename":"src\/java.desktop\/share\/classes\/sun\/awt\/image\/OffScreenImageSource.java"}],"sha":"73e9f010b3c356c2cf405855f5a33f387e7bb7ee"},{"commit":{"message":"4200096: OffScreenImageSource.removeConsumer NullPointerException\n\nCode cleanup: fixing error condition, remove redundant 'this'."},"files":[],"sha":"95fae9e28a25af2a68b8283b4b298a8321c743a3"},{"commit":{"message":"4200096: OffScreenImageSource.removeConsumer NullPointerException\n\nRemoving a consumer (which can happen implicitly if an ImageObserve returns false) could cause a NPE in OffScreenImageSource. This NPE was caught, but it was printed to System.err.\n\nThis came to my attention when a particular set of steps flooded our log with NPEs that were actually harmless\/meaningless.\n\nThe new attached test case includes two related tests: one mimics the NPE I observed, and the other is more aligned with the original wording in ticket JDK-4200096."},"files":[{"filename":"src\/java.desktop\/share\/classes\/sun\/awt\/image\/OffScreenImageSource.java"}],"sha":"49a49ee8585e8a4b5f33a6af04f2ce0165bf1199"},{"commit":{"message":"Merge pull request #4 from openjdk\/master\n\nUpdating mickleness\/jdk from openjdk\/jdk"},"files":[],"sha":"69481fc38f4021224ec4a8d1a75b275a89dfa832"},{"commit":{"message":"Merge pull request #3 from openjdk\/master\n\nMerge from openjdk\/jdk"},"files":[],"sha":"57346a421446d51192ceada277626ba1ae92d8d7"},{"commit":{"message":"Merge pull request #2 from openjdk\/master\n\nMerge openjdk\/jdk"},"files":[],"sha":"333c87c2107262532815db6978c5e8f59c5a967e"},{"commit":{"message":"Merge pull request #1 from openjdk\/master\n\nMerge openjdk\/jdk into mickleness\/jdk"},"files":[],"sha":"5dbf0a67ad41a53e03f02c41b1b6364fc3a633ee"}]