{"files":[{"patch":"@@ -249,1 +249,2 @@\n-        java.net.http;\n+        java.net.http,\n+        jdk.naming.dns;\n","filename":"src\/java.base\/share\/classes\/module-info.java","additions":2,"deletions":1,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2000, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2000, 2023, Oracle and\/or its affiliates. All rights reserved.\n@@ -30,0 +30,1 @@\n+import java.lang.ref.Cleaner;\n@@ -54,0 +55,1 @@\n+import jdk.internal.ref.CleanerFactory;\n@@ -106,0 +108,1 @@\n+    private final Cleaner.Cleanable selectorCleanup;\n@@ -161,0 +164,10 @@\n+        \/\/ register a cleaning action to close the Selector\n+        \/\/ when this DNS client becomes phantom reachable\n+        Selector sel = udpChannelSelector;\n+        selectorCleanup = CleanerFactory.cleaner().register(this, () -> {\n+            try {\n+                sel.close();\n+            } catch (IOException ignore) {\n+            }\n+        });\n+\n@@ -176,5 +189,0 @@\n-    @SuppressWarnings(\"removal\")\n-    protected void finalize() {\n-        close();\n-    }\n-\n@@ -185,4 +193,1 @@\n-        try {\n-            udpChannelSelector.close();\n-        } catch (IOException ioException) {\n-        }\n+        selectorCleanup.clean();\n","filename":"src\/jdk.naming.dns\/share\/classes\/com\/sun\/jndi\/dns\/DnsClient.java","additions":15,"deletions":10,"binary":false,"changes":25,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2000, 2013, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2000, 2023, Oracle and\/or its affiliates. All rights reserved.\n@@ -1053,5 +1053,0 @@\n-    \/\/ Finalizer not needed since it's safe to leave ctx unclosed.\n-\/\/  protected void finalize() {\n-\/\/      close();\n-\/\/  }\n-\n","filename":"src\/jdk.naming.dns\/share\/classes\/com\/sun\/jndi\/dns\/DnsContext.java","additions":1,"deletions":6,"binary":false,"changes":7,"status":"modified"}]}