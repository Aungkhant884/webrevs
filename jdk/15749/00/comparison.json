{"files":[{"patch":"@@ -542,3 +542,3 @@\n-                \/\/ First batch, use estimateDepth if not exceed the large batch size\n-                int initialBatchSize = Math.max(walker.estimateDepth()+RESERVED_ELEMENTS, MIN_BATCH_SIZE);\n-                return Math.min(initialBatchSize, LARGE_BATCH_SIZE);\n+                return walker.estimateDepth() == 0\n+                        ? SMALL_BATCH\n+                        : Math.min(walker.estimateDepth() + RESERVED_ELEMENTS, LARGE_BATCH_SIZE);\n@@ -546,5 +546,4 @@\n-                if (lastBatchFrameCount > BATCH_SIZE) {\n-                    return lastBatchFrameCount;\n-                } else {\n-                    return Math.min(lastBatchFrameCount*2, BATCH_SIZE);\n-                }\n+                \/\/ limit the batch size to 32\n+                return lastBatchFrameCount > BATCH_SIZE\n+                        ? lastBatchFrameCount\n+                        : Math.min(lastBatchFrameCount*2, BATCH_SIZE);\n","filename":"src\/java.base\/share\/classes\/java\/lang\/StackStreamFactory.java","additions":7,"deletions":8,"binary":false,"changes":15,"status":"modified"}]}