{"files":[{"patch":"@@ -2063,0 +2063,14 @@\n+\/\/ Get the total size in bytes of a read only region\n+size_t FileMapInfo::readonly_total() {\n+  size_t total = 0;\n+  if (current_info() != nullptr) {\n+    FileMapRegion* r = FileMapInfo::current_info()->region_at(MetaspaceShared::ro);\n+    if (r->read_only()) total += r->used();\n+  }\n+  if (dynamic_info() != nullptr) {\n+    FileMapRegion* r = FileMapInfo::dynamic_info()->region_at(MetaspaceShared::ro);\n+    if (r->read_only()) total += r->used();\n+  }\n+  return total;\n+}\n+\n","filename":"src\/hotspot\/share\/cds\/filemap.cpp","additions":14,"deletions":0,"binary":false,"changes":14,"status":"modified"},{"patch":"@@ -463,0 +463,1 @@\n+  static size_t readonly_total();\n","filename":"src\/hotspot\/share\/cds\/filemap.hpp","additions":1,"deletions":0,"binary":false,"changes":1,"status":"modified"},{"patch":"@@ -25,0 +25,1 @@\n+#include \"cds\/filemap.hpp\"\n@@ -45,1 +46,2 @@\n-    amount_in_current_scale(reserved), scale, amount_in_current_scale(committed), scale);\n+                  amount_in_current_scale(reserved), scale,\n+                  amount_in_current_scale(committed), scale);\n@@ -173,0 +175,5 @@\n+  size_t read_only_bytes = 0;\n+\n+#if INCLUDE_CDS\n+  read_only_bytes = FileMapInfo::readonly_total();\n+#endif\n@@ -198,0 +205,4 @@\n+    if (flag == mtClassShared) {\n+      output()->print(\", readonly=\" SIZE_FORMAT \"%s\",\n+                      amount_in_current_scale(read_only_bytes), scale);\n+    }\n","filename":"src\/hotspot\/share\/services\/memReporter.cpp","additions":12,"deletions":1,"binary":false,"changes":13,"status":"modified"},{"patch":"@@ -67,2 +67,2 @@\n-    \/\/ Match '- <mtType> (reserved=<reserved>KB, committed=<committed>KB)\n-    Pattern mtTypePattern = Pattern.compile(\"-\\\\s+(?<typename>[\\\\w\\\\s]+)\\\\(reserved=(?<reserved>\\\\d+)KB,\\\\scommitted=(?<committed>\\\\d+)KB\\\\)\");\n+    \/\/ Match '- <mtType> (reserved=<reserved>KB, committed=<committed>KB) and some times readonly=<readonly>KB\n+    Pattern mtTypePattern = Pattern.compile(\"-\\\\s+(?<typename>[\\\\w\\\\s]+)\\\\(reserved=(?<reserved>\\\\d+)KB,\\\\scommitted=(?<committed>\\\\d+)KB((,\\\\sreadonly=(?<readonly>\\\\d+)KB)|)\\\\)\");\n@@ -88,0 +88,9 @@\n+          if(typeMatcher.group(\"readonly\") != null) {\n+            long typeReadOnly = Long.parseLong(typeMatcher.group(\"readonly\"));\n+            \/\/ Make sure readonly is always less or equal to committed\n+            if (typeReadOnly > typeCommitted) {\n+              throwTestException(\"Readonly (\" + typeReadOnly + \") was more than Committed (\"\n+                  + typeCommitted + \") for mtType: \" + typeMatcher.group(\"typename\"));\n+            }\n+          }\n+\n","filename":"test\/hotspot\/jtreg\/runtime\/NMT\/SummarySanityCheck.java","additions":11,"deletions":2,"binary":false,"changes":13,"status":"modified"}]}