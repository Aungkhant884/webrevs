{"files":[{"patch":"@@ -455,2 +455,2 @@\n-        const int klass_ref_index = cp->klass_ref_index_at(index);\n-        const int name_and_type_ref_index = cp->name_and_type_ref_index_at(index);\n+        const int klass_ref_index = cp->uncached_klass_ref_index_at(index);\n+        const int name_and_type_ref_index = cp->uncached_name_and_type_ref_index_at(index);\n@@ -658,1 +658,1 @@\n-          cp->name_and_type_ref_index_at(index);\n+          cp->uncached_name_and_type_ref_index_at(index);\n@@ -681,1 +681,1 @@\n-          cp->name_and_type_ref_index_at(index);\n+          cp->uncached_name_and_type_ref_index_at(index);\n@@ -732,1 +732,1 @@\n-              cp->name_and_type_ref_index_at(ref_index);\n+              cp->uncached_name_and_type_ref_index_at(ref_index);\n","filename":"src\/hotspot\/share\/classfile\/classFileParser.cpp","additions":5,"deletions":5,"binary":false,"changes":10,"status":"modified"},{"patch":"@@ -2313,2 +2313,2 @@\n-  Symbol* field_name = cp->name_ref_at(index);\n-  Symbol* field_sig = cp->signature_ref_at(index);\n+  Symbol* field_name = cp->uncached_name_ref_at(index);\n+  Symbol* field_sig = cp->uncached_signature_ref_at(index);\n@@ -2404,1 +2404,1 @@\n-        cp->klass_name_at(cp->klass_ref_index_at(index));\n+        cp->klass_name_at(cp->uncached_klass_ref_index_at(index));\n@@ -2728,1 +2728,1 @@\n-        cp->signature_ref_at(bcs->get_index_u2()),\n+        cp->uncached_signature_ref_at(bcs->get_index_u2()),\n@@ -2807,2 +2807,2 @@\n-  Symbol* method_name = cp->name_ref_at(index);\n-  Symbol* method_sig = cp->signature_ref_at(index);\n+  Symbol* method_name = cp->uncached_name_ref_at(index);\n+  Symbol* method_sig = cp->uncached_signature_ref_at(index);\n@@ -2831,1 +2831,1 @@\n-  int sig_index = cp->signature_ref_index_at(cp->name_and_type_ref_index_at(index));\n+  int sig_index = cp->signature_ref_index_at(cp->uncached_name_and_type_ref_index_at(index));\n@@ -2937,1 +2937,1 @@\n-            cp->klass_name_at(cp->klass_ref_index_at(index));\n+            cp->klass_name_at(cp->uncached_klass_ref_index_at(index));\n","filename":"src\/hotspot\/share\/classfile\/verifier.cpp","additions":8,"deletions":8,"binary":false,"changes":16,"status":"modified"},{"patch":"@@ -300,1 +300,1 @@\n-    return cp_index_to_type(cp->klass_ref_index_at(index), cp, THREAD);\n+    return cp_index_to_type(cp->uncached_klass_ref_index_at(index), cp, THREAD);\n","filename":"src\/hotspot\/share\/classfile\/verifier.hpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -229,1 +229,1 @@\n-        if (_pool->klass_ref_at_noresolve(cp_index) == vmSymbols::java_lang_invoke_MethodHandle() &&\n+        if (_pool->uncached_klass_ref_at_noresolve(cp_index) == vmSymbols::java_lang_invoke_MethodHandle() &&\n@@ -231,1 +231,1 @@\n-                                                         _pool->name_ref_at(cp_index))) {\n+                                                         _pool->uncached_name_ref_at(cp_index))) {\n@@ -235,1 +235,1 @@\n-        } else if (_pool->klass_ref_at_noresolve(cp_index) == vmSymbols::java_lang_invoke_VarHandle() &&\n+        } else if (_pool->uncached_klass_ref_at_noresolve(cp_index) == vmSymbols::java_lang_invoke_VarHandle() &&\n@@ -237,1 +237,1 @@\n-                                                                _pool->name_ref_at(cp_index))) {\n+                                                                _pool->uncached_name_ref_at(cp_index))) {\n@@ -424,1 +424,1 @@\n-          Symbol* ref_class_name = cp->klass_name_at(cp->klass_ref_index_at(bc_index));\n+          Symbol* ref_class_name = cp->klass_name_at(cp->uncached_klass_ref_index_at(bc_index));\n@@ -427,2 +427,2 @@\n-            Symbol* field_name = cp->name_ref_at(bc_index);\n-            Symbol* field_sig = cp->signature_ref_at(bc_index);\n+            Symbol* field_name = cp->uncached_name_ref_at(bc_index);\n+            Symbol* field_sig = cp->uncached_signature_ref_at(bc_index);\n","filename":"src\/hotspot\/share\/interpreter\/rewriter.cpp","additions":7,"deletions":7,"binary":false,"changes":14,"status":"modified"},{"patch":"@@ -691,1 +691,2 @@\n-  if (!uncached && cache() != nullptr) {\n+  if (!uncached) {\n+    assert(cache() != nullptr, \"'which' is a rewritten index so this class must have been rewritten\");\n@@ -716,1 +717,2 @@\n-  if (!uncached && cache() != nullptr) {\n+  if (!uncached) {\n+    assert(cache() != nullptr, \"'which' is a rewritten index so this class must have been rewritten\");\n@@ -732,1 +734,2 @@\n-  if (!uncached && cache() != nullptr) {\n+  if (!uncached) {\n+    assert(cache() != nullptr, \"'which' is a rewritten index so this class must have been rewritten\");\n","filename":"src\/hotspot\/share\/oops\/constantPool.cpp","additions":6,"deletions":3,"binary":false,"changes":9,"status":"modified"}]}