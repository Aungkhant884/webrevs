{"files":[{"patch":"@@ -586,1 +586,4 @@\n-  release_C_heap_structures_internal();\n+  \/\/ Can't release the constant pool here because the constant pool can be\n+  \/\/ deallocated separately from the InstanceKlass for default methods and\n+  \/\/ redefine classes.\n+  release_C_heap_structures(\/* release_constant_pool *\/ false);\n@@ -2685,1 +2688,2 @@\n-void InstanceKlass::release_C_heap_structures() {\n+\/\/ Called also by InstanceKlass::deallocate_contents, with false for release_constant_pool.\n+void InstanceKlass::release_C_heap_structures(bool release_constant_pool) {\n@@ -2687,6 +2691,0 @@\n-  release_C_heap_structures_internal();\n-  constants()->release_C_heap_structures();\n-}\n-\n-\/\/ Called also by InstanceKlass::deallocate_contents\n-void InstanceKlass::release_C_heap_structures_internal() {\n@@ -2694,4 +2692,3 @@\n-\n-  \/\/ Can't release the constant pool here because the constant pool can be\n-  \/\/ deallocated separately from the InstanceKlass for default methods and\n-  \/\/ redefine classes.\n+  if (release_constant_pool) {\n+    constants()->release_C_heap_structures();\n+  }\n","filename":"src\/hotspot\/share\/oops\/instanceKlass.cpp","additions":9,"deletions":12,"binary":false,"changes":21,"status":"modified"},{"patch":"@@ -1104,1 +1104,1 @@\n-  virtual void release_C_heap_structures();\n+  virtual void release_C_heap_structures(bool release_constant_pool = true);\n@@ -1221,3 +1221,0 @@\n-  \/\/ Free CHeap allocated fields.\n-  void release_C_heap_structures_internal();\n-\n","filename":"src\/hotspot\/share\/oops\/instanceKlass.hpp","additions":1,"deletions":4,"binary":false,"changes":5,"status":"modified"},{"patch":"@@ -108,1 +108,1 @@\n-void Klass::release_C_heap_structures() {\n+void Klass::release_C_heap_structures(bool release_constant_pool) {\n","filename":"src\/hotspot\/share\/oops\/klass.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -664,1 +664,1 @@\n-  virtual void release_C_heap_structures();\n+  virtual void release_C_heap_structures(bool release_constant_pool = true);\n","filename":"src\/hotspot\/share\/oops\/klass.hpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"}]}