{"files":[{"patch":"@@ -155,0 +155,4 @@\n+        if (content == null) {\n+            throw new ParsingException(\"content is null\");\n+        }\n+\n","filename":"src\/java.base\/share\/classes\/sun\/security\/pkcs\/PKCS7.java","additions":4,"deletions":0,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2004, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2004, 2023, Oracle and\/or its affiliates. All rights reserved.\n@@ -26,1 +26,2 @@\n- * @bug 5052433\n+ * @library \/test\/lib\n+ * @bug 5052433 8315042\n@@ -32,0 +33,3 @@\n+import java.util.Base64;\n+\n+import jdk.test.lib.Utils;\n@@ -35,0 +39,1 @@\n+    private static final String in = \"MAsGCSqGSMP7TQEHAjI1Bgn\/\/\/\/\/\/\/8wCwUyAQ==\";\n@@ -42,0 +47,1 @@\n+        byte[] decodedBytes = Base64.getDecoder().decode(in);\n@@ -45,11 +51,4 @@\n-        if(!unpe.run(encoded_1)) {\n-            throw new SecurityException(\"CRLException has not been thrown\");\n-        }\n-\n-        if(!unpe.run(encoded_2)) {\n-            throw new SecurityException(\"CRLException has not been thrown\");\n-        }\n-\n-        if(!unpe.run(encoded_2)) {\n-            throw new SecurityException(\"CRLException has not been thrown\");\n-        }\n+        unpe.run(encoded_1);\n+        unpe.run(encoded_2);\n+        unpe.run(encoded_3);\n+        unpe.run(decodedBytes);\n@@ -58,1 +57,1 @@\n-    private boolean run(byte[] buf) {\n+    private void run(byte[] buf) {\n@@ -68,6 +67,0 @@\n-        try {\n-            cf.generateCRL(new ByteArrayInputStream(buf));\n-        } catch (CRLException ce) {\n-            System.out.println(\"NPE checking passed\");\n-            return true;\n-        }\n@@ -75,2 +68,7 @@\n-        System.out.println(\"CRLException has not been thrown\");\n-        return false;\n+        Utils.runAndCheckException(\n+                () -> cf.generateCRL(new ByteArrayInputStream(buf)),\n+                CRLException.class);\n+        Utils.runAndCheckException(\n+                () -> cf.generateCRLs(new ByteArrayInputStream(buf)),\n+                CRLException.class);\n+        System.out.println(\"NPE checking passed\");\n","filename":"test\/jdk\/sun\/security\/x509\/X509CRLImpl\/UnexpectedNPE.java","additions":20,"deletions":22,"binary":false,"changes":42,"status":"modified"}]}