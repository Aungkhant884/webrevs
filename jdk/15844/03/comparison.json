{"files":[{"patch":"@@ -155,0 +155,4 @@\n+        if (content == null) {\n+            throw new ParsingException(\"content is null\");\n+        }\n+\n","filename":"src\/java.base\/share\/classes\/sun\/security\/pkcs\/PKCS7.java","additions":4,"deletions":0,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2004, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2004, 2023, Oracle and\/or its affiliates. All rights reserved.\n@@ -26,1 +26,1 @@\n- * @bug 5052433\n+ * @bug 5052433 8315042\n@@ -28,0 +28,1 @@\n+ * @library \/test\/lib\n@@ -32,0 +33,1 @@\n+import java.util.Base64;\n@@ -33,2 +35,1 @@\n-public class UnexpectedNPE {\n-    CertificateFactory cf = null ;\n+import jdk.test.lib.Utils;\n@@ -36,1 +37,2 @@\n-    public UnexpectedNPE() {}\n+public class UnexpectedNPE {\n+    static CertificateFactory cf = null ;\n@@ -42,0 +44,2 @@\n+        byte[] encoded_4 = Base64.getDecoder().decode(\n+                \"MAsGCSqGSMP7TQEHAjI1Bgn\/\/\/\/\/\/\/8wCwUyAQ==\");\n@@ -43,16 +47,0 @@\n-        UnexpectedNPE unpe = new UnexpectedNPE() ;\n-\n-        if(!unpe.run(encoded_1)) {\n-            throw new SecurityException(\"CRLException has not been thrown\");\n-        }\n-\n-        if(!unpe.run(encoded_2)) {\n-            throw new SecurityException(\"CRLException has not been thrown\");\n-        }\n-\n-        if(!unpe.run(encoded_2)) {\n-            throw new SecurityException(\"CRLException has not been thrown\");\n-        }\n-    }\n-\n-    private boolean run(byte[] buf) {\n@@ -68,6 +56,0 @@\n-        try {\n-            cf.generateCRL(new ByteArrayInputStream(buf));\n-        } catch (CRLException ce) {\n-            System.out.println(\"NPE checking passed\");\n-            return true;\n-        }\n@@ -75,2 +57,11 @@\n-        System.out.println(\"CRLException has not been thrown\");\n-        return false;\n+        run(encoded_1);\n+        run(encoded_2);\n+        run(encoded_3);\n+        run(encoded_4);\n+    }\n+\n+    private static void run(byte[] buf) {\n+        Utils.runAndCheckException(\n+                () -> cf.generateCRLs(new ByteArrayInputStream(buf)),\n+                CRLException.class);\n+        System.out.println(\"NPE checking passed\");\n","filename":"test\/jdk\/sun\/security\/x509\/X509CRLImpl\/UnexpectedNPE.java","additions":20,"deletions":29,"binary":false,"changes":49,"status":"modified"}]}