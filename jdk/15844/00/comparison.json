{"files":[{"patch":"@@ -155,0 +155,4 @@\n+        if (content == null) {\n+            throw new ParsingException(\"content is null\");\n+        }\n+\n","filename":"src\/java.base\/share\/classes\/sun\/security\/pkcs\/PKCS7.java","additions":4,"deletions":0,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2004, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2004, 2023 Oracle and\/or its affiliates. All rights reserved.\n@@ -26,1 +26,1 @@\n- * @bug 5052433\n+ * @bug 5052433 8315042\n@@ -32,0 +32,1 @@\n+import java.util.Base64;\n@@ -35,0 +36,1 @@\n+    private static final String INPUT = \"MAsGCSqGSMP7TQEHAjI1Bgn\/\/\/\/\/\/\/8wCwUyAQ==\";\n@@ -42,0 +44,2 @@\n+        byte[] decodedBytes = Base64.getDecoder().decode(INPUT);\n+        boolean generateCRL = true;\n@@ -45,1 +49,1 @@\n-        if(!unpe.run(encoded_1)) {\n+        if (!unpe.run(encoded_1, generateCRL)) {\n@@ -49,1 +53,1 @@\n-        if(!unpe.run(encoded_2)) {\n+        if (!unpe.run(encoded_2, generateCRL)) {\n@@ -53,1 +57,5 @@\n-        if(!unpe.run(encoded_2)) {\n+        if (!unpe.run(encoded_3, generateCRL)) {\n+            throw new SecurityException(\"CRLException has not been thrown\");\n+        }\n+\n+        if (!unpe.run(decodedBytes, generateCRL = false)) {\n@@ -58,1 +66,1 @@\n-    private boolean run(byte[] buf) {\n+    private boolean run(byte[] buf, boolean generateCRL) {\n@@ -69,1 +77,5 @@\n-            cf.generateCRL(new ByteArrayInputStream(buf));\n+            if (generateCRL) {\n+                cf.generateCRL(new ByteArrayInputStream(buf));\n+            } else {\n+                cf.generateCRLs(new ByteArrayInputStream(buf));\n+            }\n","filename":"test\/jdk\/sun\/security\/x509\/X509CRLImpl\/UnexpectedNPE.java","additions":19,"deletions":7,"binary":false,"changes":26,"status":"modified"}]}