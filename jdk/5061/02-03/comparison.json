{"files":[{"patch":"@@ -39,3 +39,0 @@\n-    private static File file;\n-    private static FileChannel channel;\n-\n@@ -43,1 +40,1 @@\n-        file = File.createTempFile(\"readingin\", null);\n+        File file = File.createTempFile(\"readingin\", null);\n@@ -47,7 +44,8 @@\n-        channel = raf.getChannel();\n-        transferToNoOverlap();\n-        transferToOverlap();\n-        transferFromNoOverlap();\n-        transferFromOverlap();\n-        channel.close();\n-        file.delete();\n+        try (FileChannel channel = raf.getChannel()) {\n+            transferToNoOverlap(file, channel);\n+            transferToOverlap(file, channel);\n+            transferFromNoOverlap(file, channel);\n+            transferFromOverlap(file, channel);\n+        } finally {\n+            file.delete();\n+        }\n@@ -56,1 +54,2 @@\n-    private static void transferToNoOverlap() throws IOException {\n+    private static void transferToNoOverlap(File file, FileChannel channel)\n+        throws IOException {\n@@ -68,1 +67,2 @@\n-    private static void transferToOverlap() throws IOException {\n+    private static void transferToOverlap(File file, FileChannel channel)\n+        throws IOException {\n@@ -80,1 +80,2 @@\n-    private static void transferFromNoOverlap() throws IOException {\n+    private static void transferFromNoOverlap(File file, FileChannel channel)\n+        throws IOException {\n@@ -92,1 +93,2 @@\n-    private static void transferFromOverlap() throws IOException {\n+    private static void transferFromOverlap(File file, FileChannel channel)\n+        throws IOException {\n@@ -104,8 +106,10 @@\n-    static void generateBigFile(File file) throws Exception {\n-        OutputStream out = new BufferedOutputStream(\n-                new FileOutputStream(file));\n-        byte[] randomBytes = new byte[1024];\n-        Random rand = new Random(0);\n-        rand.nextBytes(randomBytes);\n-        for (int i = 0; i < 1024; i++) {\n-            out.write(randomBytes);\n+    private static void generateBigFile(File file) throws Exception {\n+        try (OutputStream out = new BufferedOutputStream(\n+                new FileOutputStream(file))) {\n+            byte[] randomBytes = new byte[1024];\n+            Random rand = new Random(0);\n+            rand.nextBytes(randomBytes);\n+            for (int i = 0; i < 1024; i++) {\n+                out.write(randomBytes);\n+            }\n+            out.flush();\n@@ -113,2 +117,0 @@\n-        out.flush();\n-        out.close();\n","filename":"test\/jdk\/java\/nio\/channels\/FileChannel\/TransferOverlappedFileChannel.java","additions":27,"deletions":25,"binary":false,"changes":52,"status":"modified"}]}