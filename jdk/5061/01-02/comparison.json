{"files":[{"patch":"@@ -589,5 +589,7 @@\n-            long posTarget = ((FileChannel)target).position();\n-            if (position() - count + 1 <= posTarget &&\n-                posTarget - count + 1 <= position() &&\n-                !nd.canTransferToFromOverlappedMap()) {\n-                return IOStatus.UNSUPPORTED_CASE;\n+            synchronized (positionLock) {\n+                long posThis = position();\n+                if (posThis - count + 1 <= position &&\n+                    position - count + 1 <= posThis &&\n+                    !nd.canTransferToFromOverlappedMap()) {\n+                    return IOStatus.UNSUPPORTED_CASE;\n+                }\n@@ -689,1 +691,1 @@\n-            count = (int)(sz - position);\n+            count = sz - position;\n","filename":"src\/java.base\/share\/classes\/sun\/nio\/ch\/FileChannelImpl.java","additions":8,"deletions":6,"binary":false,"changes":14,"status":"modified"}]}