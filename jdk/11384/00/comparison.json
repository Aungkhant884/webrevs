{"files":[{"patch":"@@ -101,2 +101,2 @@\n-static JavaVMOption *options;\n-static int numOptions, maxOptions;\n+static JavaVMOption *options = NULL;\n+static int numOptions = 0, maxOptions = 0;\n@@ -121,0 +121,2 @@\n+static void AddOption(const char *str);\n+static void FreeOptions();\n@@ -268,1 +270,1 @@\n-        AddOption(\"-Dsun.java.launcher.diag=true\", NULL);\n+        AddOption(\"-Dsun.java.launcher.diag=true\");\n@@ -840,1 +842,1 @@\n-AddOption(char *str, void *info)\n+AddOption(const char *str)\n@@ -859,2 +861,2 @@\n-    options[numOptions].optionString = str;\n-    options[numOptions++].extraInfo = info;\n+    options[numOptions].optionString = JLI_StringDup(str);\n+    options[numOptions++].extraInfo = NULL;\n@@ -894,0 +896,11 @@\n+void\n+FreeOptions() {\n+  for (int i = 0; i < numOptions; i++) {\n+    JLI_MemFree(options[i].optionString);\n+    options[i].optionString = NULL;\n+  }\n+  JLI_MemFree(options);\n+  options = NULL;\n+  numOptions = maxOptions = 0;\n+}\n+\n@@ -915,1 +928,2 @@\n-    AddOption(def, NULL);\n+    AddOption(def);\n+    JLI_MemFree(def);\n@@ -931,1 +945,2 @@\n-    AddOption(def, NULL);\n+    AddOption(def);\n+    JLI_MemFree(def);\n@@ -953,1 +968,2 @@\n-    AddOption(def, NULL);\n+    AddOption(def);\n+    JLI_MemFree(def);\n@@ -1244,1 +1260,2 @@\n-                AddOption(propValue, NULL);\n+                AddOption(propValue);\n+                JLI_MemFree(propValue);\n@@ -1260,1 +1277,1 @@\n-            AddOption(\"-Djdk.module.validation=true\", NULL);\n+            AddOption(\"-Djdk.module.validation=true\");\n@@ -1272,1 +1289,1 @@\n-                AddOption(option, NULL);\n+                AddOption(option);\n@@ -1327,1 +1344,1 @@\n-            AddOption(\"-Dsun.java.launcher.diag=true\", NULL);\n+            AddOption(\"-Dsun.java.launcher.diag=true\");\n@@ -1329,1 +1346,1 @@\n-            AddOption(\"-Djdk.module.showModuleResolution=true\", NULL);\n+            AddOption(\"-Djdk.module.showModuleResolution=true\");\n@@ -1341,1 +1358,1 @@\n-            AddOption(\"-verbose:gc\", NULL);\n+            AddOption(\"-verbose:gc\");\n@@ -1343,1 +1360,1 @@\n-            AddOption(\"-Xt\", NULL);\n+            AddOption(\"-Xt\");\n@@ -1345,1 +1362,1 @@\n-            AddOption(\"-Xtm\", NULL);\n+            AddOption(\"-Xtm\");\n@@ -1347,1 +1364,1 @@\n-            AddOption(\"-Xdebug\", NULL);\n+            AddOption(\"-Xdebug\");\n@@ -1349,1 +1366,1 @@\n-            AddOption(\"-Xnoclassgc\", NULL);\n+            AddOption(\"-Xnoclassgc\");\n@@ -1352,1 +1369,1 @@\n-            AddOption(\"-Xverify:all\", NULL);\n+            AddOption(\"-Xverify:all\");\n@@ -1354,1 +1371,1 @@\n-            AddOption(\"-Xverify:all\", NULL);\n+            AddOption(\"-Xverify:all\");\n@@ -1356,1 +1373,1 @@\n-            AddOption(\"-Xverify:remote\", NULL);\n+            AddOption(\"-Xverify:remote\");\n@@ -1362,1 +1379,1 @@\n-            AddOption(\"-Xverify:none\", NULL);\n+            AddOption(\"-Xverify:none\");\n@@ -1369,1 +1386,2 @@\n-            AddOption(tmp, NULL);\n+            AddOption(tmp);\n+            JLI_MemFree(tmp);\n@@ -1386,1 +1404,1 @@\n-            AddOption(arg, NULL);\n+            AddOption(arg);\n@@ -1412,1 +1430,1 @@\n-        AddOption(\"--add-modules=ALL-DEFAULT\", NULL);\n+        AddOption(\"--add-modules=ALL-DEFAULT\");\n@@ -1460,1 +1478,1 @@\n-    JLI_MemFree(options);\n+    FreeOptions();\n@@ -1704,1 +1722,2 @@\n-                AddOption(envcp, NULL);\n+                AddOption(envcp);\n+                JLI_MemFree(envcp);\n@@ -1717,1 +1736,2 @@\n-    AddOption(apphome, NULL);\n+    AddOption(apphome);\n+    JLI_MemFree(apphome);\n@@ -1733,1 +1753,2 @@\n-        AddOption(appcp, NULL);\n+        AddOption(appcp);\n+        JLI_MemFree(appcp);\n@@ -1790,1 +1811,2 @@\n-    AddOption(javaCommand, NULL);\n+    AddOption(javaCommand);\n+    JLI_MemFree(javaCommand);\n@@ -1798,1 +1820,1 @@\n-  AddOption(\"-Dsun.java.launcher=SUN_STANDARD\", NULL);\n+  AddOption(\"-Dsun.java.launcher=SUN_STANDARD\");\n","filename":"src\/java.base\/share\/native\/libjli\/java.c","additions":54,"deletions":32,"binary":false,"changes":86,"status":"modified"},{"patch":"@@ -171,1 +171,0 @@\n-void AddOption(char *str, void *info);\n","filename":"src\/java.base\/share\/native\/libjli\/java.h","additions":0,"deletions":1,"binary":false,"changes":1,"status":"modified"}]}