{"files":[{"patch":"@@ -29,3 +29,0 @@\n- * @author Mikhail Lapshin\n- * @library \/lib\/client\/\n- * @build ExtendedRobot\n@@ -42,0 +39,1 @@\n+    private Point iconloc;\n@@ -43,1 +41,1 @@\n-    private static ExtendedRobot robot = createRobot();\n+    private static Robot robot;\n@@ -46,0 +44,1 @@\n+        robot = new Robot();\n@@ -48,5 +47,3 @@\n-            SwingUtilities.invokeAndWait(new Runnable() {\n-                public void run() {\n-                    test.setupUI();\n-                }\n-            });\n+            SwingUtilities.invokeAndWait(() -> test.setupUI());\n+            robot.waitForIdle();\n+            robot.delay(1000);\n@@ -56,1 +53,1 @@\n-                test.frame.dispose();\n+                SwingUtilities.invokeAndWait(() -> test.frame.dispose());\n@@ -80,1 +77,0 @@\n-        sync();\n@@ -82,1 +78,3 @@\n-        sync();\n+\n+        robot.waitForIdle();\n+        robot.delay(500);\n@@ -84,1 +82,2 @@\n-        sync();\n+        robot.waitForIdle();\n+\n@@ -86,1 +85,2 @@\n-        sync();\n+        robot.waitForIdle();\n+        robot.delay(500);\n@@ -91,7 +91,5 @@\n-        SwingUtilities.invokeAndWait(new Runnable() {\n-            public void run() {\n-                setIcon(true);\n-                location = jif.getDesktopIcon().getLocation();\n-                Dimension size = frame.getSize();\n-                frame.setSize(size.width + 100, size.height + 100);\n-            }\n+        SwingUtilities.invokeAndWait(() -> {\n+            setIcon(true);\n+            location = jif.getDesktopIcon().getLocation();\n+            Dimension size = frame.getSize();\n+            frame.setSize(size.width + 100, size.height + 100);\n@@ -102,4 +100,2 @@\n-        SwingUtilities.invokeAndWait(new Runnable() {\n-            public void run() {\n-                setIcon(false);\n-            }\n+        SwingUtilities.invokeAndWait(() -> {\n+            setIcon(false);\n@@ -107,6 +103,6 @@\n-        sync();\n-        SwingUtilities.invokeAndWait(new Runnable() {\n-            public void run() {\n-                Dimension size = frame.getSize();\n-                frame.setSize(size.width - 100, size.height - 100);\n-            }\n+        robot.waitForIdle();\n+        robot.delay(500);\n+\n+        SwingUtilities.invokeAndWait(() -> {\n+            Dimension size = frame.getSize();\n+            frame.setSize(size.width - 100, size.height - 100);\n@@ -114,5 +110,5 @@\n-        sync();\n-        SwingUtilities.invokeAndWait(new Runnable() {\n-            public void run() {\n-                setIcon(true);\n-            }\n+        robot.waitForIdle();\n+        robot.delay(500);\n+\n+        SwingUtilities.invokeAndWait(() -> {\n+            setIcon(true);\n@@ -122,2 +118,5 @@\n-    private void check1() {\n-        if (!jif.getDesktopIcon().getLocation().equals(location)) {\n+    private void check1() throws Exception {\n+        SwingUtilities.invokeAndWait(() -> {\n+            iconloc = jif.getDesktopIcon().getLocation();\n+        });\n+        if (!iconloc.equals(location)) {\n@@ -130,2 +129,5 @@\n-    private void check2() {\n-        if (jif.getDesktopIcon().getLocation().equals(location)) {\n+    private void check2() throws Exception {\n+        SwingUtilities.invokeAndWait(() -> {\n+            iconloc = jif.getDesktopIcon().getLocation();\n+        });\n+        if (iconloc.equals(location)) {\n@@ -138,13 +140,0 @@\n-    private static void sync() {\n-        robot.waitForIdle();\n-    }\n-    private static ExtendedRobot createRobot() {\n-        try {\n-             ExtendedRobot robot = new ExtendedRobot();\n-             return robot;\n-         }catch(Exception ex) {\n-             ex.printStackTrace();\n-             throw new Error(\"Unexpected Failure\");\n-         }\n-    }\n-\n","filename":"test\/jdk\/javax\/swing\/JInternalFrame\/6647340\/bug6647340.java","additions":42,"deletions":53,"binary":false,"changes":95,"status":"modified"}]}