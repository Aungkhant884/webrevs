{"files":[{"patch":"@@ -1686,0 +1686,16 @@\n+\/*\n+ * Same as os::map_memory() but also pretouches if AlwaysPreTouch is enabled.\n+ *\/\n+char* map_memory(int fd, const char* file_name, size_t file_offset,\n+                 char *addr, size_t bytes, bool read_only,\n+                 bool allow_exec, MEMFLAGS flags = mtNone) {\n+  if (AlwaysPreTouch) {\n+    read_only = false;\n+  }\n+  char* mem = os::map_memory(fd, file_name, file_offset, addr, bytes,\n+                             read_only, allow_exec, flags);\n+  if (mem != nullptr && AlwaysPreTouch) {\n+    os::pretouch_memory(mem, mem + bytes, os::vm_page_size());\n+  }\n+  return mem;\n+}\n@@ -1821,3 +1837,3 @@\n-    char* base = os::map_memory(_fd, _full_path, r->file_offset(),\n-                                requested_addr, size, r->read_only(),\n-                                r->allow_exec(), mtClassShared);\n+    char* base = map_memory(_fd, _full_path, r->file_offset(),\n+                            requested_addr, size, r->read_only(),\n+                            r->allow_exec(), mtClassShared);\n@@ -1849,2 +1865,2 @@\n-  char* bitmap_base = os::map_memory(_fd, _full_path, r->file_offset(),\n-                                     requested_addr, r->used_aligned(), read_only, allow_exec, mtClassShared);\n+  char* bitmap_base = map_memory(_fd, _full_path, r->file_offset(),\n+                                 requested_addr, r->used_aligned(), read_only, allow_exec, mtClassShared);\n@@ -2130,3 +2146,3 @@\n-  char* base = os::map_memory(_fd, _full_path, r->file_offset(),\n-                              addr, _mapped_heap_memregion.byte_size(), r->read_only(),\n-                              r->allow_exec());\n+  char* base = map_memory(_fd, _full_path, r->file_offset(),\n+                          addr, _mapped_heap_memregion.byte_size(), r->read_only(),\n+                          r->allow_exec());\n","filename":"src\/hotspot\/share\/cds\/filemap.cpp","additions":24,"deletions":8,"binary":false,"changes":32,"status":"modified"}]}