{"files":[{"patch":"@@ -42,5 +42,14 @@\n-        \/\/ null => don't change\n-        if (lastModifiedTime == null && lastAccessTime == null &&\n-            createTime == null) {\n-            \/\/ no effect\n-            return;\n+        if (createTime == null) {\n+            \/\/ all times null => don't change\n+            if (lastModifiedTime == null && lastAccessTime == null)\n+                return; \/\/ no effect\n+\n+            if (lastAccessTime != null) {\n+                \/\/ if the last access time is being set, defer to Unix\n+                \/\/ implementation in case the file is on an HFS store on\n+                \/\/ which setattrlist(2) does not work for this purpose\n+                UnixFileAttributeViews.Basic basic =\n+                    new UnixFileAttributeViews.Basic(path, followLinks);\n+                basic.setTimes(lastModifiedTime, lastAccessTime, null);\n+                return;\n+            }\n@@ -60,2 +69,8 @@\n-            accValue = lastAccessTime.to(TimeUnit.NANOSECONDS);\n-            commonattr |= UnixConstants.ATTR_CMN_ACCTIME;\n+            String fstype =\n+                path.getFileSystem().provider().getFileStore(path).type();\n+\n+            \/\/ setattrlist(2) fails to set last access time on HFS\n+            if (!\"hfs\".equals(fstype)) {\n+                accValue = lastAccessTime.to(TimeUnit.NANOSECONDS);\n+                commonattr |= UnixConstants.ATTR_CMN_ACCTIME;\n+            }\n@@ -72,0 +87,10 @@\n+\n+            \/\/ if the last access time is given but its commonattr bit is not\n+            \/\/ set, then the path must be on an HFS store, so use the Unix\n+            \/\/ implementation to set the last access time\n+            if (lastAccessTime != null &&\n+                (commonattr & UnixConstants.ATTR_CMN_ACCTIME) == 0) {\n+                UnixFileAttributeViews.Basic basic =\n+                    new UnixFileAttributeViews.Basic(path, followLinks);\n+                basic.setTimes(null, lastAccessTime, null);\n+            }\n","filename":"src\/java.base\/macosx\/classes\/sun\/nio\/fs\/BsdFileAttributeViews.java","additions":32,"deletions":7,"binary":false,"changes":39,"status":"modified"}]}