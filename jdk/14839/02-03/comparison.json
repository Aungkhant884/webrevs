{"files":[{"patch":"@@ -222,7 +222,1 @@\n-            if (!MessageDigest.isEqual(padded, decrypted)) {\n-                byte[] encoded2 = RSAUtil.encodeSignatureOmitNull\n-                        (digestOID, digest);\n-                byte[] padded2 = padding.pad(encoded2);\n-                return MessageDigest.isEqual(padded2, decrypted);\n-            }\n-            return true;\n+            return MessageDigest.isEqual(padded, decrypted);\n","filename":"src\/java.base\/share\/classes\/sun\/security\/rsa\/RSASignature.java","additions":1,"deletions":7,"binary":false,"changes":8,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2018, 2023, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2018, 2022, Oracle and\/or its affiliates. All rights reserved.\n@@ -182,14 +182,0 @@\n-    \/**\n-     * Encode the digest with NULL parameter value omitted, return the\n-     * to-be-signed data.\n-     *\/\n-    public static byte[] encodeSignatureOmitNull(ObjectIdentifier oid,\n-            byte[] digest) {\n-        DerOutputStream out = new DerOutputStream();\n-        new AlgorithmId(oid, true).encode(out);\n-        out.putOctetString(digest);\n-        DerValue result =\n-            new DerValue(DerValue.tag_Sequence, out.toByteArray());\n-        return result.toByteArray();\n-    }\n-\n","filename":"src\/java.base\/share\/classes\/sun\/security\/rsa\/RSAUtil.java","additions":1,"deletions":15,"binary":false,"changes":16,"status":"modified"},{"patch":"@@ -81,4 +81,0 @@\n-    \/\/ this flag will override the oid-specific NULL handling\n-    \/\/ when set to true, NULL params will be omitted from the encoding\n-    private transient boolean omitNull = false;\n-\n@@ -102,13 +98,0 @@\n-    \/**\n-     * Constructs a parameterless algorithm ID with flag controlling\n-     * whether NULL params is omitted.\n-     *\n-     * @param oid the identifier for the algorithm\n-     * @param omitNull the flag controlling whether NULL is encoded for\n-     *     NULL params\n-     *\/\n-    public AlgorithmId(ObjectIdentifier oid, boolean omitNull) {\n-        algid = oid;\n-        this.omitNull = omitNull;\n-    }\n-\n@@ -186,1 +169,1 @@\n-            if (!omitNull && (algid.equals(RSAEncryption_oid)\n+            if (algid.equals(RSAEncryption_oid)\n@@ -212,1 +195,1 @@\n-                    || algid.equals(SHA3_512withRSA_oid))) {\n+                    || algid.equals(SHA3_512withRSA_oid)) {\n","filename":"src\/java.base\/share\/classes\/sun\/security\/x509\/AlgorithmId.java","additions":2,"deletions":19,"binary":false,"changes":21,"status":"modified"}]}