{"files":[{"patch":"@@ -242,2 +242,1 @@\n-  template <typename KlassProxy>\n-  inline bool must_be_preserved(KlassProxy klass) const;\n+  inline bool must_be_preserved(const oopDesc* obj) const;\n@@ -262,2 +261,1 @@\n-  template <typename KlassProxy>\n-  inline bool must_be_preserved_for_promotion_failure(KlassProxy klass) const;\n+  inline bool must_be_preserved_for_promotion_failure(const oopDesc* obj) const;\n","filename":"src\/hotspot\/share\/oops\/markWord.hpp","additions":2,"deletions":4,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -31,0 +31,1 @@\n+#include \"oops\/oop.inline.hpp\"\n@@ -34,2 +35,1 @@\n-template <typename KlassProxy>\n-inline bool markWord::must_be_preserved(KlassProxy klass) const {\n+inline bool markWord::must_be_preserved(const oopDesc* obj) const {\n@@ -42,1 +42,1 @@\n-    markWord prototype_header = prototype_for_klass(klass);\n+    markWord prototype_header = prototype_for_klass(obj->klass());\n@@ -53,2 +53,1 @@\n-template <typename KlassProxy>\n-inline bool markWord::must_be_preserved_for_promotion_failure(KlassProxy klass) const {\n+inline bool markWord::must_be_preserved_for_promotion_failure(const oopDesc* obj) const {\n@@ -65,1 +64,1 @@\n-    if (has_bias_pattern() || prototype_for_klass(klass).has_bias_pattern()) {\n+    if (has_bias_pattern() || prototype_for_klass(obj->klass()).has_bias_pattern()) {\n","filename":"src\/hotspot\/share\/oops\/markWord.inline.hpp","additions":5,"deletions":6,"binary":false,"changes":11,"status":"modified"},{"patch":"@@ -400,13 +400,0 @@\n-\/\/ Supports deferred calling of obj->klass().\n-class DeferredObjectToKlass {\n-  const oopDesc* _obj;\n-\n-public:\n-  DeferredObjectToKlass(const oopDesc* obj) : _obj(obj) {}\n-\n-  \/\/ Implicitly convertible to const Klass*.\n-  operator const Klass*() const {\n-    return _obj->klass();\n-  }\n-};\n-\n@@ -418,6 +405,1 @@\n-  \/\/ There's a circular dependency between oop.inline.hpp and\n-  \/\/ markWord.inline.hpp because markWord::must_be_preserved wants to call\n-  \/\/ oopDesc::klass(). This could be solved by calling klass() here. However,\n-  \/\/ not all paths inside must_be_preserved calls klass(). Defer the call until\n-  \/\/ the klass is actually needed.\n-  return m.must_be_preserved(DeferredObjectToKlass(this));\n+  return m.must_be_preserved(this);\n@@ -427,1 +409,1 @@\n-  return m.must_be_preserved_for_promotion_failure(DeferredObjectToKlass(this));\n+  return m.must_be_preserved_for_promotion_failure(this);\n","filename":"src\/hotspot\/share\/oops\/oop.inline.hpp","additions":2,"deletions":20,"binary":false,"changes":22,"status":"modified"}]}