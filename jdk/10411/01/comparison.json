{"files":[{"patch":"@@ -46,2 +46,1 @@\n-outputStream::outputStream(int width) {\n-  _width       = width;\n+outputStream::outputStream() {\n@@ -49,1 +48,0 @@\n-  _newlines    = 0;\n@@ -56,2 +54,1 @@\n-outputStream::outputStream(int width, bool has_time_stamps) {\n-  _width       = width;\n+outputStream::outputStream(bool has_time_stamps) {\n@@ -59,1 +56,0 @@\n-  _newlines    = 0;\n@@ -67,1 +63,2 @@\n-void outputStream::update_position(const char* s, size_t len) {\n+bool outputStream::update_position(const char* s, size_t len) {\n+  bool saw_newline = false;\n@@ -71,1 +68,1 @@\n-      _newlines += 1;\n+      saw_newline = true;\n@@ -82,0 +79,1 @@\n+  return saw_newline;\n@@ -403,1 +401,0 @@\n-  _newlines = 0;\n@@ -896,1 +893,1 @@\n-      (_outer_xmlStream == NULL || !_outer_xmlStream->inside_attrs())) {\n+      (_outer_xmlStream == nullptr || !_outer_xmlStream->inside_attrs())) {\n@@ -902,3 +899,3 @@\n-  if (has_log_file()) {\n-    int nl0 = _newlines;\n-    xmlTextStream::write(s, len);\n+  if (has_log_file() && _outer_xmlStream != nullptr) {\n+     _outer_xmlStream->write_text(s, len);\n+    bool nl = update_position(s, len);\n@@ -906,1 +903,1 @@\n-    if (nl0 != _newlines){\n+    if (nl) {\n","filename":"src\/hotspot\/share\/utilities\/ostream.cpp","additions":11,"deletions":14,"binary":false,"changes":25,"status":"modified"},{"patch":"@@ -51,4 +51,2 @@\n-   int _width;       \/\/ width of the page\n-   int _position;    \/\/ position on the current line\n-   int _newlines;    \/\/ number of '\\n' output so far\n-   julong _precount; \/\/ number of chars output, less _position\n+   int _position;    \/\/ visual position on the current line\n+   uint64_t _precount; \/\/ number of chars output, less than _position\n@@ -59,1 +57,2 @@\n-   void update_position(const char* s, size_t len);\n+  \/\/ Returns whether a newline was seen or not\n+   bool update_position(const char* s, size_t len);\n@@ -74,2 +73,2 @@\n-   outputStream(int width = 80);\n-   outputStream(int width, bool has_time_stamps);\n+   outputStream();\n+   outputStream(bool has_time_stamps);\n@@ -89,1 +88,0 @@\n-   int width()    const { return _width;    }\n","filename":"src\/hotspot\/share\/utilities\/ostream.hpp","additions":6,"deletions":8,"binary":false,"changes":14,"status":"modified"}]}