{"files":[{"patch":"@@ -689,3 +689,5 @@\n-    or the library is (in effect) unloaded by the termination of the VM whether through\n-    normal termination or VM failure, including start-up failure.\n-    Uncontrolled shutdown is, of course, an exception to this rule.\n+    or the library is (in effect) unloaded by the termination of the VM.\n+    VM termination includes normal termination and VM failure, including start-up failure,\n+    but not, of course, uncontrolled shutdown. An implementation may also\n+    choose to not call this function if the <code>Agent_OnAttach<\/code>\/\n+    <code>Agent_OnAttach_L<\/code> function reported an error (returned a non-zero value).\n","filename":"src\/hotspot\/share\/prims\/jvmti.xml","additions":5,"deletions":3,"binary":false,"changes":8,"status":"modified"},{"patch":"@@ -2703,0 +2703,3 @@\n+        if (!agent_lib->is_static_lib()) {\n+          os::dll_unload(library);\n+        }\n","filename":"src\/hotspot\/share\/prims\/jvmtiExport.cpp","additions":3,"deletions":0,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2017, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2017, 2020, Oracle and\/or its affiliates. All rights reserved.\n@@ -28,1 +28,1 @@\n- * @bug 8165736\n+ * @bug 8165736 8252657\n@@ -39,0 +39,1 @@\n+            \/\/ Check return code\n@@ -41,0 +42,4 @@\n+\n+            \/\/ Check loaded libraries\n+            output = executor.execute(\"VM.dynlibs\");\n+            output.shouldNotContain(libpath);\n","filename":"test\/hotspot\/jtreg\/serviceability\/dcmd\/jvmti\/AttachFailed\/AttachReturnError.java","additions":7,"deletions":2,"binary":false,"changes":9,"status":"modified"}]}