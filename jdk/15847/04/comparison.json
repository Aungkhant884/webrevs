{"files":[{"patch":"@@ -31,3 +31,0 @@\n-import java.awt.Dimension;\n-import java.awt.Robot;\n-\n@@ -37,1 +34,0 @@\n-import javax.swing.SwingUtilities;\n@@ -40,3 +36,6 @@\n-    static JScrollPane scrollpane;\n-    static JScrollBar sbar;\n-    static volatile boolean viewChanged;\n+    public static void main(String[] args) {\n+        JPanel panel = new JPanel();\n+        JScrollPane scrollpane = new JScrollPane(panel,\n+                JScrollPane.VERTICAL_SCROLLBAR_ALWAYS,\n+                JScrollPane.HORIZONTAL_SCROLLBAR_NEVER);\n+        JScrollBar sbar = scrollpane.getVerticalScrollBar();\n@@ -44,9 +43,1 @@\n-    public static void main(String[] args) throws Exception {\n-        SwingUtilities.invokeAndWait(() -> {\n-            JPanel panel = new JPanel();\n-            panel.setPreferredSize(new Dimension(500, 500));\n-            scrollpane = new JScrollPane(panel,\n-                    JScrollPane.VERTICAL_SCROLLBAR_ALWAYS,\n-                    JScrollPane.HORIZONTAL_SCROLLBAR_NEVER);\n-            sbar = scrollpane.getVerticalScrollBar();\n-        });\n+        scrollpane.setViewportView(null);\n@@ -54,9 +45,3 @@\n-        Robot robot = new Robot();\n-        robot.delay(500);\n-        SwingUtilities.invokeAndWait(() -> {\n-            sbar.addAdjustmentListener(e -> viewChanged = true);\n-            scrollpane.setViewportView(null);\n-        });\n-        robot.delay(500);\n-        if (!viewChanged) {\n-            viewChanged = true;\n+        if (sbar.getVisibleAmount() > 0) {\n+            throw new RuntimeException(\"Vertical scrollbar is not \" +\n+                    \"updated when viewport is replaced\");\n@@ -64,8 +49,0 @@\n-        robot.delay(500);\n-\n-        SwingUtilities.invokeAndWait(() -> {\n-            if (sbar.getVisibleAmount() > 0) {\n-                throw new RuntimeException(\"Vertical scrollbar is not \" +\n-                        \"updated when viewport is replaced\");\n-            }\n-        });\n","filename":"test\/jdk\/javax\/swing\/JViewport\/bug4546474.java","additions":10,"deletions":33,"binary":false,"changes":43,"status":"modified"}]}