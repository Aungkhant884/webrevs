{"files":[{"patch":"@@ -226,1 +226,1 @@\n-        input.readInt(); \/\/ size\n+        input.readPaddedInt(); \/\/ size\n","filename":"src\/jdk.jfr\/share\/classes\/jdk\/jfr\/internal\/consumer\/ChunkHeader.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -231,1 +231,1 @@\n-            int size = input.readInt();\n+            int size = input.readPaddedInt();\n@@ -246,1 +246,1 @@\n-                            input.readInt(); \/\/ size\n+                            input.readPaddedInt(); \/\/ size\n@@ -313,1 +313,1 @@\n-            int size = input.readInt(); \/\/ size\n+            int size = input.readPaddedInt(); \/\/ size\n","filename":"src\/jdk.jfr\/share\/classes\/jdk\/jfr\/internal\/consumer\/ChunkParser.java","additions":3,"deletions":3,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -409,0 +409,20 @@\n+    public int readPaddedInt() throws IOException {\n+        return (int) readPadded(4);\n+    }\n+\n+    private long readPadded(int size) throws IOException {\n+        long ret = 0L;\n+        int shift = 0;\n+        for (int i = 0; i < size; i++) {\n+            long b = readByte();\n+            boolean isLastByte = (i == size - 1);\n+            long mask = isLastByte ? 0XFFL : 0x7FL;\n+            ret += ((b & mask) << shift);\n+            if (b >= 0) {\n+                return ret;\n+            }\n+            shift += 7;\n+        }\n+        return ret;\n+    }\n+\n","filename":"src\/jdk.jfr\/share\/classes\/jdk\/jfr\/internal\/consumer\/RecordingInput.java","additions":20,"deletions":0,"binary":false,"changes":20,"status":"modified"},{"patch":"@@ -186,1 +186,1 @@\n-        long size = input.readLong();\n+        long size = input.readPaddedInt();\n@@ -197,1 +197,1 @@\n-        input.readLong(); \/\/ Read size\n+        input.readPaddedInt(); \/\/ Read size\n","filename":"src\/jdk.jfr\/share\/classes\/jdk\/jfr\/internal\/consumer\/filter\/ChunkWriter.java","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -119,1 +119,1 @@\n-                    int size = input.readInt();\n+                    int size = input.readPaddedInt();\n","filename":"src\/jdk.jfr\/share\/classes\/jdk\/jfr\/internal\/tool\/Summary.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"}]}