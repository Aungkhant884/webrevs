{"files":[{"patch":"@@ -140,2 +140,0 @@\n-        boolean clientPropSet = false;\n-        boolean serverPropSet = false;\n@@ -144,1 +142,1 @@\n-        Integer certLen = GetIntegerAction.privilegedGetProperty(\n+        Integer maxCertificateChainLength = GetIntegerAction.privilegedGetProperty(\n@@ -146,3 +144,1 @@\n-        if (certLen == null || certLen < 0) {\n-            certLen = 0;\n-        } else {\n+        if (maxCertificateChainLength != null && maxCertificateChainLength >= 0) {\n@@ -151,1 +147,0 @@\n-        int maxCertificateChainLength = certLen;\n@@ -153,1 +148,16 @@\n-        \/\/ Default for jdk.tls.server.maxInboundCertificateChainLength is 8\n+        \/*\n+         * If either jdk.tls.server.maxInboundCertificateChainLength or\n+         * jdk.tls.client.maxInboundCertificateChainLength is set, it will\n+         * override jdk.tls.maxCertificateChainLength, regardless of whether\n+         * jdk.tls.maxCertificateChainLength is set or not.\n+         * If neither jdk.tls.server.maxInboundCertificateChainLength nor\n+         * jdk.tls.client.maxInboundCertificateChainLength is set, the behavior\n+         * depends on the setting of jdk.tls.maxCertificateChainLength. If\n+         * jdk.tls.maxCertificateChainLength is set, it falls back to that\n+         * value; otherwise, it defaults to 8 for\n+         * jdk.tls.server.maxInboundCertificateChainLength\n+         * and 10 for jdk.tls.client.maxInboundCertificateChainLength.\n+         * Usesrs can independently set either\n+         * jdk.tls.server.maxInboundCertificateChainLength or\n+         * jdk.tls.client.maxInboundCertificateChainLength.\n+         *\/\n@@ -156,0 +166,2 @@\n+\n+        \/\/ Default for jdk.tls.server.maxInboundCertificateChainLength is 8\n@@ -157,1 +169,1 @@\n-            inboundClientLen = 8;\n+            maxInboundClientCertChainLen = globalPropSet ? maxCertificateChainLength : 8;\n@@ -159,1 +171,1 @@\n-            serverPropSet = true;\n+            maxInboundClientCertChainLen = inboundClientLen;\n@@ -162,1 +174,0 @@\n-        \/\/ Default for jdk.tls.client.maxInboundCertificateChainLength is 10\n@@ -165,0 +176,2 @@\n+\n+        \/\/ Default for jdk.tls.client.maxInboundCertificateChainLength is 10\n@@ -166,1 +179,1 @@\n-            inboundServerLen = 10;\n+            maxInboundServerCertChainLen = globalPropSet ? maxCertificateChainLength : 10;\n@@ -168,18 +181,1 @@\n-            clientPropSet = true;\n-        }\n-\n-        \/*\n-         * When jdk.tls.maxCertificateChainLength is set, it will override\n-         * the defaults for jdk.tls.server.maxInboundCertificateChainLength and\n-         * jdk.tls.client.maxInboundCertificateChainLength if they are not explicitly\n-         * set. That means if either of those properties have been set,\n-         * the jdk.tls.maxCertificateChainLength property will not override\n-         * the values.\n-         *\/\n-        if (globalPropSet) {\n-            if (!serverPropSet) {\n-                inboundClientLen = maxCertificateChainLength;\n-            }\n-            if (!clientPropSet) {\n-                inboundServerLen = maxCertificateChainLength;\n-            }\n+            maxInboundServerCertChainLen = inboundServerLen;\n@@ -187,3 +183,0 @@\n-\n-        maxInboundClientCertChainLen = inboundClientLen;\n-        maxInboundServerCertChainLen = inboundServerLen;\n","filename":"src\/java.base\/share\/classes\/sun\/security\/ssl\/SSLConfiguration.java","additions":26,"deletions":33,"binary":false,"changes":59,"status":"modified"}]}