{"files":[{"patch":"@@ -111,3 +111,2 @@\n-    \/\/ Set the max certificate chain length to 10\n-    static final int maxCertificateChainLength = GetIntegerAction.privilegedGetProperty(\n-            \"jdk.tls.maxCertificateChainLength\", 10);\n+    \/\/ Maximum allowed certificate chain length\n+    static final int maxCertificateChainLength;\n@@ -142,7 +141,0 @@\n-    \/*\n-     * If the jdk.tls.maxClientCertificateChainLength or jdk.tls.maxServerCertificateChainLength\n-     * system property is not set, it will default to the value of the\n-     * jdk.tls.maxCertificateChainLength system property. If either of them is\n-     * set, it will supersede the value of the jdk.tls.maxCertificateChainLength\n-     * system property.\n-     *\/\n@@ -150,9 +142,27 @@\n-        Integer clientLen = GetIntegerAction.privilegedGetProperty(\n-                \"jdk.tls.maxClientCertificateChainLength\");\n-        maxClientCertificateChainLength = (clientLen != null) ?\n-                clientLen : maxCertificateChainLength;\n-\n-        Integer serverLen = GetIntegerAction.privilegedGetProperty(\n-                \"jdk.tls.maxServerCertificateChainLength\");\n-        maxServerCertificateChainLength = (serverLen != null) ?\n-                serverLen : maxCertificateChainLength;\n+        int certLen = GetIntegerAction.privilegedGetProperty(\n+                \"jdk.tls.maxCertificateChainLength\", 10);\n+        if (certLen < 0) {\n+            certLen = 10;\n+        }\n+        maxCertificateChainLength = certLen;\n+\n+        \/*\n+         * If the jdk.tls.maxClientCertificateChainLength or jdk.tls.maxServerCertificateChainLength\n+         * system property is not set, it will default to the value of the\n+         * jdk.tls.maxCertificateChainLength system property. If either of them is\n+         * set, it will supersede the value of the jdk.tls.maxCertificateChainLength\n+         * system property.\n+         *\/\n+        int clientLen = GetIntegerAction.privilegedGetProperty(\n+                \"jdk.tls.maxClientCertificateChainLength\", maxCertificateChainLength);\n+        if (clientLen < 0) {\n+            clientLen = maxCertificateChainLength;\n+        }\n+        maxClientCertificateChainLength = clientLen;\n+\n+        int serverLen = GetIntegerAction.privilegedGetProperty(\n+                \"jdk.tls.maxServerCertificateChainLength\", maxCertificateChainLength);\n+        if (serverLen < 0) {\n+            serverLen = maxCertificateChainLength;\n+        }\n+        maxServerCertificateChainLength = serverLen;\n","filename":"src\/java.base\/share\/classes\/sun\/security\/ssl\/SSLConfiguration.java","additions":29,"deletions":19,"binary":false,"changes":48,"status":"modified"}]}