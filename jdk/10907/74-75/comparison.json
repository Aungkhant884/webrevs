{"files":[{"patch":"@@ -66,5 +66,10 @@\n-  int top = to_index(_top);\n-  for (int i = 0; i < top; i++) {\n-    assert(_base[i] != nullptr || !is_owning_thread(), \"no zapped before top\");\n-    for (int j = i + 1; j < top; j++) {\n-      assert(_base[i] != _base[j], \"entries must be unique: %s\", msg);\n+  if (is_owning_thread()) {\n+    int top = to_index(_top);\n+    for (int i = 0; i < top; i++) {\n+      assert(_base[i] != nullptr, \"no zapped before top\");\n+      for (int j = i + 1; j < top; j++) {\n+        assert(_base[i] != _base[j], \"entries must be unique: %s\", msg);\n+      }\n+    }\n+    for (int i = top; i < CAPACITY; i++) {\n+      assert(_base[i] == nullptr, \"only zapped entries after top: i: %d, top: %d, entry: \" PTR_FORMAT, i, top, p2i(_base[i]));\n@@ -72,3 +77,0 @@\n-  }\n-  for (int i = top; i < CAPACITY; i++) {\n-    assert(_base[i] == nullptr, \"only zapped entries after top: i: %d, top: %d, entry: \" PTR_FORMAT, i, top, p2i(_base[i]));\n","filename":"src\/hotspot\/share\/runtime\/lockStack.cpp","additions":10,"deletions":8,"binary":false,"changes":18,"status":"modified"}]}