{"files":[{"patch":"@@ -144,1 +144,0 @@\n-     * @throws UnsupportedOperationException if this variable argument list has been allocated using heap segments.\n","filename":"src\/jdk.incubator.foreign\/share\/classes\/jdk\/incubator\/foreign\/VaList.java","additions":0,"deletions":1,"binary":false,"changes":1,"status":"modified"},{"patch":"@@ -146,4 +146,2 @@\n-                ResourceCleanup prev = (ResourceCleanup) FST.getAcquire(this);\n-                cleanup.next = prev;\n-                ResourceCleanup newSegment = (ResourceCleanup) FST.compareAndExchangeRelease(this, prev, cleanup);\n-                if (newSegment == ResourceCleanup.CLOSED_LIST) {\n+                ResourceCleanup prev = (ResourceCleanup) FST.getVolatile(this);\n+                if (prev == ResourceCleanup.CLOSED_LIST) {\n@@ -152,1 +150,3 @@\n-                } else if (newSegment == prev) {\n+                }\n+                cleanup.next = prev;\n+                if (FST.compareAndSet(this, prev, cleanup)) {\n@@ -168,1 +168,1 @@\n-                    prev = (ResourceCleanup) FST.getAcquire(this);\n+                    prev = (ResourceCleanup) FST.getVolatile(this);\n@@ -170,1 +170,1 @@\n-                    if (FST.weakCompareAndSetRelease(this, prev, ResourceCleanup.CLOSED_LIST)) {\n+                    if (FST.compareAndSet(this, prev, ResourceCleanup.CLOSED_LIST)) {\n","filename":"src\/jdk.incubator.foreign\/share\/classes\/jdk\/internal\/foreign\/SharedScope.java","additions":7,"deletions":7,"binary":false,"changes":14,"status":"modified"}]}