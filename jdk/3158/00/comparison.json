{"files":[{"patch":"@@ -99,0 +99,1 @@\n+  uintx _claim_token;\n@@ -103,1 +104,2 @@\n-    _cl(cl) {}\n+    _cl(cl),\n+    _claim_token(Threads::thread_claim_token()) {}\n@@ -106,6 +108,8 @@\n-    \/\/ Transfer any partial buffer to the qset for completed buffer processing.\n-    _satb_qset.flush_queue(ShenandoahThreadLocalData::satb_mark_queue(thread));\n-    if (thread->is_Java_thread()) {\n-      if (_cl != NULL) {\n-        ResourceMark rm;\n-        thread->oops_do(_cl, NULL);\n+    if (thread->claim_threads_do(true, _claim_token)) {\n+      \/\/ Transfer any partial buffer to the qset for completed buffer processing.\n+      _satb_qset.flush_queue(ShenandoahThreadLocalData::satb_mark_queue(thread));\n+      if (thread->is_Java_thread()) {\n+        if (_cl != NULL) {\n+          ResourceMark rm;\n+          thread->oops_do(_cl, NULL);\n+        }\n@@ -146,1 +150,1 @@\n-      Threads::possibly_parallel_threads_do(true \/*par*\/, &tc);\n+      Threads::threads_do(&tc);\n","filename":"src\/hotspot\/share\/gc\/shenandoah\/shenandoahConcurrentMark.cpp","additions":12,"deletions":8,"binary":false,"changes":20,"status":"modified"}]}