{"files":[{"patch":"@@ -405,1 +405,1 @@\n-            this.value = Arrays.copyOfRange(ascii, offset, offset + count);\n+            this.value = copyBytes(ascii, offset, count);\n@@ -539,1 +539,1 @@\n-                    this.value = Arrays.copyOfRange(bytes, offset, offset + length);\n+                    this.value = copyBytes(bytes, offset, length);\n@@ -596,1 +596,1 @@\n-                this.value = Arrays.copyOfRange(bytes, offset, offset + length);\n+                this.value = copyBytes(bytes, offset, length);\n@@ -604,1 +604,1 @@\n-                this.value = Arrays.copyOfRange(bytes, offset, offset + length);\n+                this.value = copyBytes(bytes, offset, length);\n@@ -631,1 +631,1 @@\n-                        this.value = Arrays.copyOfRange(bytes, offset, offset + length);\n+                        this.value = copyBytes(bytes, offset, length);\n@@ -674,1 +674,1 @@\n-                bytes = Arrays.copyOfRange(bytes, offset, offset + length);\n+                bytes = copyBytes(bytes, offset, length);\n@@ -698,0 +698,6 @@\n+    static byte[] copyBytes(byte[] bytes, int offset, int length) {\n+        byte[] dst = new byte[length];\n+        System.arraycopy(bytes, offset, dst, 0, length);\n+        return dst;\n+    }\n+\n@@ -712,1 +718,1 @@\n-                return new String(Arrays.copyOfRange(bytes, offset, offset + length), LATIN1);\n+                return new String(copyBytes(bytes, offset, length), LATIN1);\n@@ -4538,0 +4544,3 @@\n+        \/\/ To avoid surprises due to data races (which would either truncate or throw an exception)\n+        \/\/ we should check that length <= val.length up front\n+        checkOffset(length, val.length);\n@@ -4540,1 +4549,1 @@\n-            this.value = Arrays.copyOfRange(val, 0, length);\n+            this.value = copyBytes(val, 0, length);\n@@ -4552,1 +4561,1 @@\n-            this.value = Arrays.copyOfRange(val, 0, length << 1);\n+            this.value = copyBytes(val, 0, length << 1);\n","filename":"src\/java.base\/share\/classes\/java\/lang\/String.java","additions":18,"deletions":9,"binary":false,"changes":27,"status":"modified"},{"patch":"@@ -763,2 +763,1 @@\n-        return new String(Arrays.copyOfRange(val, index, index + len),\n-                          LATIN1);\n+        return new String(String.copyBytes(val, index, len), LATIN1);\n","filename":"src\/java.base\/share\/classes\/java\/lang\/StringLatin1.java","additions":1,"deletions":2,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -1014,1 +1014,1 @@\n-            new String(Arrays.copyOfRange(value, st << 1, len << 1), UTF16) :\n+            new String(String.copyBytes(value, st << 1, len << 1), UTF16) :\n","filename":"src\/java.base\/share\/classes\/java\/lang\/StringUTF16.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -31,1 +31,0 @@\n-@Fork(5)\n@@ -35,2 +34,3 @@\n-@Warmup(iterations = 5, time = 5)\n-@Measurement(iterations = 10, time = 5)\n+@Warmup(iterations = 5, time = 3)\n+@Measurement(iterations = 5, time = 3)\n+@Fork(3)\n@@ -38,0 +38,4 @@\n+\n+  @Param({\"0\", \"7\", \"64\"})\n+  public int size;\n+\n@@ -42,1 +46,1 @@\n-    array = \"\".getBytes(StandardCharsets.UTF_8);\n+      array = \"a\".repeat(size).getBytes(StandardCharsets.UTF_8);\n@@ -47,1 +51,1 @@\n-    return new String(array);\n+      return new String(array);\n@@ -52,1 +56,1 @@\n-    return new String(array, StandardCharsets.UTF_8);\n+      return new String(array, StandardCharsets.UTF_8);\n@@ -57,1 +61,1 @@\n-    return new String(array, StandardCharsets.UTF_8.name());\n+      return new String(array, StandardCharsets.UTF_8.name());\n@@ -62,1 +66,1 @@\n-    return new String(array, 0, 0);\n+    return new String(array, 0, array.length);\n@@ -67,1 +71,1 @@\n-    return new String(array, 0, 0, StandardCharsets.UTF_8);\n+      return new String(array, 0, array.length, StandardCharsets.UTF_8);\n@@ -72,1 +76,1 @@\n-    return new String(array, 0, 0, StandardCharsets.UTF_8.name());\n+      return new String(array, 0, array.length, StandardCharsets.UTF_8.name());\n","filename":"test\/micro\/org\/openjdk\/bench\/java\/lang\/StringConstructor.java","additions":14,"deletions":10,"binary":false,"changes":24,"status":"modified"}]}