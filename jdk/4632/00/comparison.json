{"files":[{"patch":"@@ -4207,2 +4207,6 @@\n-  template <class T> void do_oop_work(T* p) {\n-    T heap_oop = RawAccess<>::oop_load(p);\n+public:\n+  RegisterNMethodOopClosure(G1CollectedHeap* g1h, nmethod* nm) :\n+    _g1h(g1h), _nm(nm) {}\n+\n+  void do_oop(oop* p) {\n+    oop heap_oop = RawAccess<>::oop_load(p);\n@@ -4212,4 +4216,0 @@\n-      assert(!hr->is_continues_humongous(),\n-             \"trying to add code root \" PTR_FORMAT \" in continuation of humongous region \" HR_FORMAT\n-             \" starting at \" HR_FORMAT,\n-             p2i(_nm), HR_FORMAT_PARAMS(hr), HR_FORMAT_PARAMS(hr->humongous_start_region()));\n@@ -4222,6 +4222,1 @@\n-public:\n-  RegisterNMethodOopClosure(G1CollectedHeap* g1h, nmethod* nm) :\n-    _g1h(g1h), _nm(nm) {}\n-\n-  void do_oop(oop* p)       { do_oop_work(p); }\n-  void do_oop(narrowOop* p) { do_oop_work(p); }\n+  void do_oop(narrowOop* p) { ShouldNotReachHere(); }\n@@ -4234,2 +4229,6 @@\n-  template <class T> void do_oop_work(T* p) {\n-    T heap_oop = RawAccess<>::oop_load(p);\n+public:\n+  UnregisterNMethodOopClosure(G1CollectedHeap* g1h, nmethod* nm) :\n+    _g1h(g1h), _nm(nm) {}\n+\n+  void do_oop(oop* p) {\n+    oop heap_oop = RawAccess<>::oop_load(p);\n@@ -4239,4 +4238,0 @@\n-      assert(!hr->is_continues_humongous(),\n-             \"trying to remove code root \" PTR_FORMAT \" in continuation of humongous region \" HR_FORMAT\n-             \" starting at \" HR_FORMAT,\n-             p2i(_nm), HR_FORMAT_PARAMS(hr), HR_FORMAT_PARAMS(hr->humongous_start_region()));\n@@ -4248,6 +4243,1 @@\n-public:\n-  UnregisterNMethodOopClosure(G1CollectedHeap* g1h, nmethod* nm) :\n-    _g1h(g1h), _nm(nm) {}\n-\n-  void do_oop(oop* p)       { do_oop_work(p); }\n-  void do_oop(narrowOop* p) { do_oop_work(p); }\n+  void do_oop(narrowOop* p) { ShouldNotReachHere(); }\n","filename":"src\/hotspot\/share\/gc\/g1\/g1CollectedHeap.cpp","additions":14,"deletions":24,"binary":false,"changes":38,"status":"modified"}]}