{"files":[{"patch":"@@ -51,0 +51,2 @@\n+import java.nio.file.Path;\n+import java.nio.file.Paths;\n@@ -102,1 +104,1 @@\n- * @LastModified: May 2021\n+ * @LastModified: June 2021\n@@ -513,3 +515,0 @@\n-                    \/\/ if StreamResult(File) or setSystemID(File) was used,\n-                    \/\/ the systemId will be URI encoded as a result of File.toURI(),\n-                    \/\/ it must be decoded for use by URL\n@@ -517,16 +516,4 @@\n-                        URI uri = new URI(systemId) ;\n-                        systemId = \"file:\";\n-\n-                        String host = uri.getHost(); \/\/ decoded String\n-                        String path = uri.getPath(); \/\/decoded String\n-                        if (path == null) {\n-                         path = \"\";\n-                        }\n-\n-                        \/\/ if host (URI authority) then file:\/\/ + host + path\n-                        \/\/ else just path (may be absolute or relative)\n-                        if (host != null) {\n-                         systemId += \"\/\/\" + host + path;\n-                        } else {\n-                         systemId += \"\/\/\" + path;\n-                        }\n+                        Path p = Paths.get(new URI(systemId));\n+                        _ostream = new FileOutputStream(p.toFile());\n+                        _tohFactory.setOutputStream(_ostream);\n+                        return _tohFactory.getSerializationHandler();\n@@ -534,2 +521,2 @@\n-                    catch (Exception  exception) {\n-                        \/\/ URI exception which means nothing can be done so OK to ignore\n+                    catch (Exception e) {\n+                        throw new TransformerException(e);\n@@ -537,5 +524,0 @@\n-\n-                    url = new URL(systemId);\n-                    _ostream = new FileOutputStream(url.getFile());\n-                    _tohFactory.setOutputStream(_ostream);\n-                    return _tohFactory.getSerializationHandler();\n","filename":"src\/java.xml\/share\/classes\/com\/sun\/org\/apache\/xalan\/internal\/xsltc\/trax\/TransformerImpl.java","additions":9,"deletions":27,"binary":false,"changes":36,"status":"modified"},{"patch":"@@ -31,2 +31,0 @@\n-import java.io.FileNotFoundException;\n-import java.io.FileOutputStream;\n@@ -99,6 +97,4 @@\n-        try {\n-            outputStream = new FileOutputStream(f);\n-        } catch (FileNotFoundException ex) {\n-            \/\/ fall back to the original implementation for compatibility\n-            setSystemId(f.toURI().toASCIIString());\n-        }\n+        \/\/convert file to appropriate URI, f.toURI().toASCIIString()\n+        \/\/converts the URI to string as per rule specified in\n+        \/\/RFC 2396,\n+        setSystemId(f.toURI().toASCIIString());\n","filename":"src\/java.xml\/share\/classes\/javax\/xml\/transform\/stream\/StreamResult.java","additions":4,"deletions":8,"binary":false,"changes":12,"status":"modified"}]}