{"files":[{"patch":"@@ -28,0 +28,1 @@\n+import java.util.Arrays;\n@@ -607,3 +608,9 @@\n-        if (getClass() == BufferedInputStream.class\n-                && ((count - pos) <= 0) && (markpos == -1)) {\n-            return getInIfOpen().transferTo(out);\n+        if (getClass() == BufferedInputStream.class && markpos == -1) {\n+            int avail = count - pos;\n+            if (avail > 0) {\n+                \/\/ Prevent poisoning and leaking of buf\n+                byte[] buffer = Arrays.copyOfRange(getBufIfOpen(), pos, count);\n+                out.write(buffer);\n+                pos = count;\n+            }\n+            return avail + getInIfOpen().transferTo(out);\n","filename":"src\/java.base\/share\/classes\/java\/io\/BufferedInputStream.java","additions":10,"deletions":3,"binary":false,"changes":13,"status":"modified"}]}