{"files":[{"patch":"@@ -28,0 +28,1 @@\n+import java.util.Arrays;\n@@ -611,3 +612,0 @@\n-                out.write(buffer, pos, avail);\n-                count = 0;\n-                pos = 0;\n@@ -615,1 +613,1 @@\n-                \/\/ Allow GC before reallocating possibly large buffer to prevent OOME\n+                \/\/ Prevent buffer poisoning (by out.write throwing IOException)\n@@ -625,0 +623,10 @@\n+\n+                \/\/ Prevent leaking of \"confidential\" buffer content\n+                Arrays.fill(buffer, 0, pos, (byte) 0);\n+                Arrays.fill(buffer, count, buffer.length, (byte) 0);\n+\n+                out.write(buffer, pos, avail);\n+                count = 0;\n+                pos = 0;\n+\n+                \/\/ Allow GC before reallocating possibly large buffer to prevent OOME\n@@ -628,0 +636,1 @@\n+                \/\/ Resizing the buffer to respect user's buffer size choice\n","filename":"src\/java.base\/share\/classes\/java\/io\/BufferedInputStream.java","additions":13,"deletions":4,"binary":false,"changes":17,"status":"modified"}]}