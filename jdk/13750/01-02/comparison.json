{"files":[{"patch":"@@ -774,1 +774,1 @@\n-ssize_t os::pd_write(int fd, const void *buf, unsigned int nBytes) {\n+ssize_t os::pd_write(int fd, const void *buf, size_t nBytes) {\n@@ -776,1 +776,1 @@\n-  RESTARTABLE(::write(fd, buf, (size_t)nBytes), res);\n+  RESTARTABLE(::write(fd, buf, nBytes), res);\n","filename":"src\/hotspot\/os\/posix\/os_posix.cpp","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -106,1 +106,1 @@\n-    if (result == OS_ERR) {\n+    if (result < 0) {\n@@ -953,1 +953,1 @@\n-    if (result != 1) {\n+    if (result != 0) {\n","filename":"src\/hotspot\/os\/posix\/perfMemory_posix.cpp","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -4774,2 +4774,2 @@\n-ssize_t os::pd_write(int fd, const void *buf, unsigned int nBytes) {\n-  return ::write(fd, buf, (size_t)nBytes);\n+ssize_t os::pd_write(int fd, const void *buf, size_t nBytes) {\n+  return ::write(fd, buf, nBytes);\n","filename":"src\/hotspot\/os\/windows\/os_windows.cpp","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -1687,1 +1687,1 @@\n-  ssize_t n = os::write(_fd, buffer, (unsigned int)nbytes);\n+  ssize_t n = os::write(_fd, buffer, nbytes);\n","filename":"src\/hotspot\/share\/cds\/filemap.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -394,2 +394,1 @@\n-        bytes_written += write_result;\n-        assert(bytes_read == bytes_written, \"invariant\");\n+        bytes_written = bytes_read;\n","filename":"src\/hotspot\/share\/jfr\/recorder\/repository\/jfrEmergencyDump.cpp","additions":1,"deletions":2,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -79,1 +79,1 @@\n-  if (errno == ENOSPC) {\n+  if (num_written < 0 && errno == ENOSPC) {\n@@ -82,2 +82,2 @@\n-  guarantee(num_written > 0, \"Nothing got written, or os::write() failed\");\n-  _stream_pos += num_written;\n+  guarantee(num_written == 0, \"Not all the bytes got written, or os::write() failed\");\n+  _stream_pos += nBytes;\n","filename":"src\/hotspot\/share\/jfr\/writers\/jfrStreamWriterHost.inline.hpp","additions":3,"deletions":3,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -2900,1 +2900,1 @@\n-    ssize_t count = os::write(defaultStream::output_fd(), s, (int)len);\n+    ssize_t count = os::write(defaultStream::output_fd(), s, len);\n","filename":"src\/hotspot\/share\/prims\/jvm.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -1381,1 +1381,1 @@\n-ssize_t os::write(int fd, const void *buf, unsigned int nBytes) {\n+ssize_t os::write(int fd, const void *buf, size_t nBytes) {\n@@ -1383,3 +1383,3 @@\n-  size_t len = nBytes;\n-  while (len > 0) {\n-    res = pd_write(fd, buf, (unsigned int)len);\n+\n+  while (nBytes > 0) {\n+    res = pd_write(fd, buf, nBytes);\n@@ -1387,1 +1387,1 @@\n-      return res;\n+      return -1;\n@@ -1389,2 +1389,2 @@\n-    buf = (void *)((char *)buf + len);\n-    len -= res;\n+    buf = (void *)((char *)buf + nBytes);\n+    nBytes -= res;\n@@ -1393,1 +1393,1 @@\n-  return res;\n+  return 0;\n","filename":"src\/hotspot\/share\/runtime\/os.cpp","additions":8,"deletions":8,"binary":false,"changes":16,"status":"modified"},{"patch":"@@ -232,1 +232,1 @@\n-  static ssize_t pd_write(int fd, const void *buf, unsigned int nBytes);\n+  static ssize_t pd_write(int fd, const void *buf, size_t nBytes);\n@@ -648,1 +648,2 @@\n-  static ssize_t write(int fd, const void *buf, unsigned int nBytes);\n+  \/\/ Writes the bytes completely. Returns 0 on success, -1 otherwise.\n+  static ssize_t write(int fd, const void *buf, size_t nBytes);\n","filename":"src\/hotspot\/share\/runtime\/os.hpp","additions":3,"deletions":2,"binary":false,"changes":5,"status":"modified"},{"patch":"@@ -58,2 +58,2 @@\n-  ssize_t n = os::write(_fd, buf, (uint)size);\n-  if (n <= 0) {\n+  ssize_t n = os::write(_fd, buf, (size_t)size);\n+  if (n < 0) {\n","filename":"src\/hotspot\/share\/services\/heapDumperCompression.cpp","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"}]}