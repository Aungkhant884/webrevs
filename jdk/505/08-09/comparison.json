{"files":[{"patch":"@@ -981,3 +981,1 @@\n-  if (is_native) {\n-    __ call_VM_leaf(CAST_FROM_FN_PTR(address, ShenandoahRuntime::load_reference_barrier_native), rax, rbx);\n-  } else {\n+  if (kind == ShenandoahBarrierSet::NORMAL) {\n@@ -985,0 +983,2 @@\n+  } else {\n+    __ call_VM_leaf(CAST_FROM_FN_PTR(address, ShenandoahRuntime::load_reference_barrier_native), rax, rbx);\n","filename":"src\/hotspot\/cpu\/x86\/gc\/shenandoah\/shenandoahBarrierSetAssembler_x86.cpp","additions":3,"deletions":3,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -137,1 +137,1 @@\n-      bool pushed = q->push(ShenandoahMarkTask(array, 1, pow));\n+      bool pushed = q->push(ShenandoahMarkTask(array, false, false, 1, pow));\n@@ -150,1 +150,1 @@\n-        bool pushed = q->push(ShenandoahMarkTask(array, left_chunk, pow));\n+        bool pushed = q->push(ShenandoahMarkTask(array, false, false, left_chunk, pow));\n@@ -179,1 +179,1 @@\n-    bool pushed = q->push(ShenandoahMarkTask(array, chunk - 1, pow));\n+    bool pushed = q->push(ShenandoahMarkTask(array, false, false, chunk - 1, pow));\n","filename":"src\/hotspot\/share\/gc\/shenandoah\/shenandoahConcurrentMark.inline.hpp","additions":3,"deletions":3,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -157,2 +157,2 @@\n-  ObjArrayChunkedTask(oop o, int chunk, int pow) {\n-    assert(decode_oop(encode_oop(o, true, true)) == o, \"oop can be encoded: \" PTR_FORMAT, p2i(o));\n+  ObjArrayChunkedTask(oop o, bool count_liveness, bool strong, int chunk, int pow) {\n+    assert(decode_oop(encode_oop(o, count_liveness, strong)) == o, \"oop can be encoded: \" PTR_FORMAT, p2i(o));\n@@ -161,1 +161,1 @@\n-    _obj = encode_oop(o, true, true) | encode_chunk(chunk) | encode_pow(pow);\n+    _obj = encode_oop(o, count_liveness, strong) | encode_chunk(chunk) | encode_pow(pow);\n@@ -226,1 +226,2 @@\n-  ObjArrayChunkedTask(oop o = NULL, int chunk = 0, int pow = 0): _obj(o) {\n+  ObjArrayChunkedTask(oop o = NULL, bool count_liveness = true, bool strong = true, int chunk = 0, int pow = 0):\n+    _obj(o), _count_liveness(count_liveness), _strong(strong) {\n@@ -235,4 +236,5 @@\n-  inline oop obj()   const { return _obj; }\n-  inline int chunk() const { return _chunk; }\n-  inline int pow()  const { return _pow; }\n-\n+  inline oop obj()             const { return _obj; }\n+  inline int chunk()           const { return _chunk; }\n+  inline int pow()             const { return _pow; }\n+  inline bool is_strong()      const { return _strong; };\n+  inline bool count_liveness() const { return _count_liveness; }\n@@ -253,0 +255,2 @@\n+  bool _count_liveness;\n+  bool _strong;\n","filename":"src\/hotspot\/share\/gc\/shenandoah\/shenandoahTaskqueue.hpp","additions":12,"deletions":8,"binary":false,"changes":20,"status":"modified"}]}