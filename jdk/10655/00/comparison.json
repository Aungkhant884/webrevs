{"files":[{"patch":"@@ -36,0 +36,1 @@\n+import java.awt.event.MouseAdapter;\n@@ -37,1 +38,6 @@\n-import java.awt.event.*;\n+import java.io.File;\n+import java.util.concurrent.atomic.AtomicReference;\n+import java.util.stream.IntStream;\n+import javax.imageio.ImageIO;\n+import javax.swing.SwingUtilities;\n+\n@@ -51,0 +57,4 @@\n+    private static Robot robot;\n+    private static Frame frame;\n+    private static Rectangle currentScreenBounds;\n+\n@@ -53,0 +63,2 @@\n+        robot = new Robot();\n+        robot.setAutoDelay(200);\n@@ -58,2 +70,2 @@\n-            Rectangle bounds = gc.getBounds();\n-            Point point = new Point(bounds.x, bounds.y);\n+            currentScreenBounds = gc.getBounds();\n+            Point point = new Point(currentScreenBounds.x, currentScreenBounds.y);\n@@ -61,3 +73,3 @@\n-            while (point.y < bounds.y + bounds.height - insets.bottom - SIZE) {\n-                while (point.x\n-                        < bounds.x + bounds.width - insets.right - SIZE) {\n+            while (point.y < currentScreenBounds.y + currentScreenBounds.height - insets.bottom - SIZE) {\n+                while (point.x <\n+                           currentScreenBounds.x + currentScreenBounds.width - insets.right - SIZE) {\n@@ -65,1 +77,3 @@\n-                    point.translate(bounds.width \/ 5, 0);\n+                    point.translate(currentScreenBounds.width \/ 5, 0);\n+                   }\n+                   point.setLocation(currentScreenBounds.x, point.y + currentScreenBounds.height \/ 5);\n@@ -67,1 +81,0 @@\n-                point.setLocation(bounds.x, point.y + bounds.height \/ 5);\n@@ -70,1 +83,0 @@\n-    }\n@@ -73,0 +85,1 @@\n+        frame = new Frame();\n@@ -74,5 +87,6 @@\n-        for (int i = 1; i < 7; i++) {\n-            pm.add(TEXT + i);\n-        }\n-        pm.addActionListener(e -> action = true);\n-        Frame frame = new Frame();\n+        IntStream.rangeClosed(1, 6).forEach(i -> pm.add(TEXT + i));\n+        pm.addActionListener(e -> {\n+            action = true;\n+            System.out.println(\" Got action event \" + e);\n+        });\n+\n@@ -80,0 +94,1 @@\n+            frame.setUndecorated(true);\n@@ -87,0 +102,1 @@\n+\n@@ -98,0 +114,1 @@\n+                        System.out.println(\"Going to show popup \"+pm+\" on \"+frame);\n@@ -109,2 +126,0 @@\n-        Robot robot = new Robot();\n-        robot.setAutoDelay(200);\n@@ -113,1 +128,3 @@\n-        robot.mouseMove(pt.x + frame.getWidth() \/ 2, pt.y + 50);\n+        int x = pt.x + frame.getWidth() \/ 2;\n+        int y = pt.y + 50;\n+        robot.mouseMove(x, y);\n@@ -116,2 +133,2 @@\n-        int x = pt.x + frame.getWidth() \/ 2;\n-        int y = pt.y + 130;\n+        robot.waitForIdle();\n+         y = y+50;\n@@ -123,1 +140,4 @@\n-            throw new RuntimeException();\n+            captureScreen();\n+            throw new RuntimeException(\n+                    \"Failed, Not received the PopupMenu ActionEvent yet on \" +\n+                    \"frame= \"+frame+\", isFocused = \"+frame.isFocused());\n@@ -127,0 +147,11 @@\n+\n+    private static void captureScreen() {\n+        try {\n+            ImageIO.write(robot.createScreenCapture(currentScreenBounds), \"png\",\n+                          new File(\"screen1.png\"));\n+        } catch (Exception exception) {\n+            exception.printStackTrace();\n+        }\n+        action = false;\n+    }\n+\n","filename":"test\/jdk\/java\/awt\/PopupMenu\/PopupMenuLocation.java","additions":51,"deletions":20,"binary":false,"changes":71,"status":"modified"}]}