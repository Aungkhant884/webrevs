{"files":[{"patch":"@@ -109,2 +109,0 @@\n-    \/\/ The maximum size of array to allocate. Some VMs reserve some header words in an array.\n-    private static final int MAX_ARRAY_SIZE = Integer.MAX_VALUE - 8;\n@@ -126,1 +124,0 @@\n-    private static final int DEFAULT_TEMP_FILE_CREATION_THRESHOLD = 10 * 1024 * 1024; \/\/ 10 MB\n@@ -128,3 +125,2 @@\n-    \/\/ for outputstream of a zip entry, when useTempFile\n-    \/\/ isn't explicitly enabled\n-    private final int tempFileCreationThreshold;\n+    \/\/ for outputstream of a zip entry\n+    private final int tempFileCreationThreshold = 10 * 1024 * 1024; \/\/ 10 MB\n@@ -156,1 +152,0 @@\n-        this.tempFileCreationThreshold = initTempFileThreshold(env);\n@@ -249,18 +244,0 @@\n-    private static int initTempFileThreshold(Map<String, ?> env) {\n-        final Object val = env.get(\"tempFileThreshold\");\n-        if (val == null) {\n-            return DEFAULT_TEMP_FILE_CREATION_THRESHOLD;\n-        }\n-        if (val instanceof String v) {\n-            try {\n-                return Math.min(Integer.parseInt(v), MAX_ARRAY_SIZE);\n-            } catch (NumberFormatException nfe) {\n-                return DEFAULT_TEMP_FILE_CREATION_THRESHOLD;\n-            }\n-        }\n-        if (val instanceof Integer v) {\n-            return Math.min(v, MAX_ARRAY_SIZE);\n-        }\n-        return DEFAULT_TEMP_FILE_CREATION_THRESHOLD;\n-    }\n-\n@@ -1976,1 +1953,1 @@\n-        if (useTempFile || (tempFileCreationThreshold > 0 && e.size >= tempFileCreationThreshold)) {\n+        if (useTempFile || e.size >= tempFileCreationThreshold) {\n@@ -2172,3 +2149,1 @@\n-            super(tempFileCreationThreshold <= 0\n-                    ? ((e.size > 0 && e.size <= MAX_ARRAY_SIZE) ? (int) e.size : 8192)\n-                    : ((e.size > 0 && e.size <= tempFileCreationThreshold) ? (int) e.size : 8192));\n+            super(8192);\n@@ -2185,1 +2160,1 @@\n-            if (tempFileCreationThreshold <= 0 || (totalWritten + 1 < tempFileCreationThreshold)) {\n+            if (totalWritten + 1 < tempFileCreationThreshold) {\n@@ -2207,1 +2182,1 @@\n-            if (tempFileCreationThreshold <= 0 || (totalWritten + len < tempFileCreationThreshold)) {\n+            if (totalWritten + len < tempFileCreationThreshold) {\n","filename":"src\/jdk.zipfs\/share\/classes\/jdk\/nio\/zipfs\/ZipFileSystem.java","additions":6,"deletions":31,"binary":false,"changes":37,"status":"modified"},{"patch":"@@ -43,0 +43,1 @@\n+ * @test\n@@ -46,1 +47,1 @@\n- * @run testng\/othervm\/timeout=300 LargeCompressedEntrySizeTest\n+ * @run testng\/manual\/othervm LargeCompressedEntrySizeTest\n","filename":"test\/jdk\/jdk\/nio\/zipfs\/LargeCompressedEntrySizeTest.java","additions":2,"deletions":1,"binary":false,"changes":3,"status":"modified"}]}