{"files":[{"patch":"@@ -61,1 +61,0 @@\n-    BOOL _clipReady;\n@@ -76,1 +75,0 @@\n-        _clipReady = NO;\n@@ -192,1 +190,0 @@\n-    _clipReady = NO;\n","filename":"src\/java.desktop\/macosx\/native\/libawt_lwawt\/java2d\/metal\/MTLClip.m","additions":0,"deletions":3,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -110,8 +110,11 @@\n-\/\/ Bits in pipeline state index\n-enum state_index_bits {\n-  ST_SRC_PRE_BIT,\n-  ST_SRC_OPQ_BIT,\n-  ST_STN_BIT,\n-  ST_AA_BIT,\n-  ST_EXTA_BIT,\n-  ST_MAX_BIT\n+\/\/ Pipeline state index\n+union StateIndex {\n+  uint32_t value;\n+  struct {\n+    uint32_t srcPremultiplied : 1,\n+             srcOpaque        : 1,\n+             stencil          : 1,\n+             aa               : 1,\n+             extAlpha         : 1,\n+             compositeRule    : 27;\n+  } bits;\n@@ -136,1 +139,2 @@\n-    int subIndex = 0;\n+    union StateIndex index;\n+    index.value = 0;\n@@ -142,4 +146,2 @@\n-            if (!renderOptions->srcFlags.isPremultiplied)\n-                subIndex |= 1 << ST_SRC_PRE_BIT;\n-            if (renderOptions->srcFlags.isOpaque)\n-                subIndex |= 1 << ST_SRC_OPQ_BIT;\n+            index.bits.srcPremultiplied = renderOptions->srcFlags.isPremultiplied;\n+            index.bits.srcOpaque = renderOptions->srcFlags.isOpaque;\n@@ -150,13 +152,4 @@\n-    if (stencilNeeded) {\n-        subIndex |= 1 << ST_STN_BIT;\n-    }\n-\n-    if (renderOptions->isAA) {\n-        subIndex |= 1 << ST_AA_BIT;\n-    }\n-\n-    if ((composite != nil && FLT_LT([composite getExtraAlpha], 1.0f))) {\n-        subIndex |= 1 << ST_EXTA_BIT;\n-    }\n-\n-    int index = (compositeRule << ST_MAX_BIT) + subIndex;\n+    index.bits.stencil = stencilNeeded;\n+    index.bits.aa = renderOptions->isAA;\n+    index.bits.extAlpha = composite != nil && FLT_LT([composite getExtraAlpha], 1.0f);\n+    index.bits.compositeRule = compositeRule;\n@@ -166,2 +159,2 @@\n-    if (index >= subStates.count) {\n-        subStates.count = (NSUInteger) (index + 1);\n+    if (index.value >= subStates.count) {\n+        subStates.count = index.value + 1;\n@@ -170,1 +163,1 @@\n-    id<MTLRenderPipelineState> result = [subStates pointerAtIndex:index];\n+    id<MTLRenderPipelineState> result = [subStates pointerAtIndex:index.value];\n@@ -231,1 +224,1 @@\n-            [subStates insertPointer:result atIndex:index];\n+            [subStates replacePointerAtIndex:index.value withPointer:result];\n","filename":"src\/java.desktop\/macosx\/native\/libawt_lwawt\/java2d\/metal\/MTLPipelineStatesStorage.m","additions":23,"deletions":30,"binary":false,"changes":53,"status":"modified"}]}