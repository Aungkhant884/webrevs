{"files":[{"patch":"@@ -76,1 +76,1 @@\n-ShenandoahGCPauseMark::ShenandoahGCPauseMark(uint gc_id, SvcGCMarker::reason_type type) :\n+ShenandoahGCPauseMark::ShenandoahGCPauseMark(uint gc_id, const char* notification_message, SvcGCMarker::reason_type type) :\n@@ -86,1 +86,2 @@\n-          \/* countCollection = *\/         true\n+          \/* countCollection = *\/         true,\n+          \/* notificationMessage = *\/     notification_message\n","filename":"src\/hotspot\/share\/gc\/shenandoah\/shenandoahUtils.cpp","additions":3,"deletions":2,"binary":false,"changes":5,"status":"modified"},{"patch":"@@ -139,1 +139,1 @@\n-  ShenandoahGCPauseMark(uint gc_id, SvcGCMarker::reason_type type);\n+  ShenandoahGCPauseMark(uint gc_id, const char* notification_action, SvcGCMarker::reason_type type);\n","filename":"src\/hotspot\/share\/gc\/shenandoah\/shenandoahUtils.hpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -50,1 +50,1 @@\n-  ShenandoahGCPauseMark mark(_gc_id, SvcGCMarker::CONCURRENT);\n+  ShenandoahGCPauseMark mark(_gc_id, \"Init Mark\", SvcGCMarker::CONCURRENT);\n@@ -55,1 +55,1 @@\n-  ShenandoahGCPauseMark mark(_gc_id, SvcGCMarker::CONCURRENT);\n+  ShenandoahGCPauseMark mark(_gc_id, \"Final Mark\", SvcGCMarker::CONCURRENT);\n@@ -60,1 +60,1 @@\n-  ShenandoahGCPauseMark mark(_gc_id, SvcGCMarker::FULL);\n+  ShenandoahGCPauseMark mark(_gc_id, \"Full GC\", SvcGCMarker::FULL);\n@@ -65,1 +65,1 @@\n-  ShenandoahGCPauseMark mark(_gc_id, SvcGCMarker::CONCURRENT);\n+  ShenandoahGCPauseMark mark(_gc_id, \"Degenerated GC\", SvcGCMarker::CONCURRENT);\n@@ -70,1 +70,1 @@\n-  ShenandoahGCPauseMark mark(_gc_id, SvcGCMarker::CONCURRENT);\n+  ShenandoahGCPauseMark mark(_gc_id, \"Init Update Refs\", SvcGCMarker::CONCURRENT);\n@@ -75,1 +75,1 @@\n-  ShenandoahGCPauseMark mark(_gc_id, SvcGCMarker::CONCURRENT);\n+  ShenandoahGCPauseMark mark(_gc_id, \"Final Update Refs\", SvcGCMarker::CONCURRENT);\n@@ -80,1 +80,1 @@\n-  ShenandoahGCPauseMark mark(_gc_id, SvcGCMarker::CONCURRENT);\n+  ShenandoahGCPauseMark mark(_gc_id, \"Final Roots\", SvcGCMarker::CONCURRENT);\n","filename":"src\/hotspot\/share\/gc\/shenandoah\/shenandoahVMOperations.cpp","additions":7,"deletions":7,"binary":false,"changes":14,"status":"modified"},{"patch":"@@ -246,1 +246,1 @@\n-                             bool allMemoryPoolsAffected) {\n+                             bool allMemoryPoolsAffected, const char* notificationMessage) {\n@@ -296,1 +296,2 @@\n-      GCNotifier::pushNotification(this, _gc_end_message, GCCause::to_string(cause));\n+      const char* message = notificationMessage != nullptr ? notificationMessage : _gc_end_message;\n+      GCNotifier::pushNotification(this, message, GCCause::to_string(cause));\n","filename":"src\/hotspot\/share\/services\/memoryManager.cpp","additions":3,"deletions":2,"binary":false,"changes":5,"status":"modified"},{"patch":"@@ -170,1 +170,1 @@\n-                bool allMemoryPoolsAffected);\n+                bool allMemoryPoolsAffected, const char* notificationMessage = nullptr);\n","filename":"src\/hotspot\/share\/services\/memoryManager.hpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -186,1 +186,1 @@\n-                           bool allMemoryPoolsAffected) {\n+                           bool allMemoryPoolsAffected, const char* notificationMessage) {\n@@ -189,1 +189,1 @@\n-                  countCollection, cause, allMemoryPoolsAffected);\n+                  countCollection, cause, allMemoryPoolsAffected, notificationMessage);\n@@ -230,1 +230,2 @@\n-                                                 bool countCollection) {\n+                                                 bool countCollection,\n+                                                 const char* notificationMessage) {\n@@ -234,1 +235,1 @@\n-             countCollection);\n+             countCollection, notificationMessage);\n@@ -248,1 +249,2 @@\n-                                         bool countCollection) {\n+                                         bool countCollection,\n+                                         const char* notificationMessage) {\n@@ -259,0 +261,1 @@\n+  _notificationMessage = notificationMessage;\n@@ -266,1 +269,2 @@\n-                        _recordGCEndTime, _countCollection, _cause, _allMemoryPoolsAffected);\n+                        _recordGCEndTime, _countCollection, _cause, _allMemoryPoolsAffected,\n+                        _notificationMessage);\n","filename":"src\/hotspot\/share\/services\/memoryService.cpp","additions":10,"deletions":6,"binary":false,"changes":16,"status":"modified"},{"patch":"@@ -107,1 +107,1 @@\n-                     bool allMemoryPoolsAffected);\n+                     bool allMemoryPoolsAffected, const char* notificationMessage = nullptr);\n@@ -128,0 +128,1 @@\n+  const char*  _notificationMessage;\n@@ -139,1 +140,2 @@\n-                          bool countCollection = true);\n+                          bool countCollection = true,\n+                          const char* notificationMessage = nullptr);\n@@ -150,1 +152,2 @@\n-                  bool countCollection);\n+                  bool countCollection,\n+                  const char* notificationMessage = nullptr);\n","filename":"src\/hotspot\/share\/services\/memoryService.hpp","additions":6,"deletions":3,"binary":false,"changes":9,"status":"modified"},{"patch":"@@ -118,0 +118,6 @@\n+    private static boolean isExpectedPauseAction(String action) {\n+        return \"Init Mark\".equals(action) || \"Final Mark\".equals(action) || \"Full GC\".equals(action)\n+            || \"Degenerated GC\".equals(action) || \"Init Update Refs\".equals(action)\n+            || \"Final Update Refs\".equals(action) || \"Final Roots\".equals(action);\n+    }\n+\n@@ -132,1 +138,2 @@\n-                    System.out.println(\"Received: \" + info.getGcName());\n+                    System.out.println(\"Received: \" + info.getGcName() + \"\/\" + info.getGcAction());\n+\n@@ -141,0 +148,3 @@\n+                            if (!isExpectedPauseAction(info.getGcAction())) {\n+                                throw new IllegalStateException(\"Unknown action: \" + info.getGcAction());\n+                            }\n","filename":"test\/hotspot\/jtreg\/gc\/shenandoah\/mxbeans\/TestPauseNotifications.java","additions":11,"deletions":1,"binary":false,"changes":12,"status":"modified"}]}