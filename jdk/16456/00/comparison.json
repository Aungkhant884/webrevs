{"files":[{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2005, 2015, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2005, 2023, Oracle and\/or its affiliates. All rights reserved.\n@@ -52,0 +52,2 @@\n+    public static final int MAX_TRIES = 30;\n+\n@@ -140,2 +142,12 @@\n-            while(!testPrincipals(monitored, monitorNames, monitor, principals));\n-\n+            sleep(500); \/\/ wait for getX method to be called, which calls setPrincipal\n+            boolean ok = false;\n+            for (int i = 0; i < MAX_TRIES; i++) {\n+                ok = testPrincipals(monitored, monitorNames, monitor, principals);\n+                if (ok) {\n+                    break;\n+                }\n+                sleep(1000);\n+            }\n+            if (!ok) {\n+                throw new Exception(\"Failed: testPrincipals fails repeatedly.\");\n+            }\n@@ -154,0 +166,3 @@\n+\n+            echo(\"testPrincipals: monitored: \" + monitored[i] + \" principal: \" + principal + \" expected: \" + expected);\n+\n@@ -175,0 +190,8 @@\n+\n+    public static void sleep(int ms) {\n+        try {\n+            Thread.currentThread().sleep(ms);\n+        } catch (InterruptedException ie) {\n+            \/\/ ignore\n+        }\n+   }\n","filename":"test\/jdk\/javax\/management\/monitor\/ThreadPoolAccTest.java","additions":26,"deletions":3,"binary":false,"changes":29,"status":"modified"}]}