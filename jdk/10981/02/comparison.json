{"files":[{"patch":"@@ -244,6 +244,22 @@\n-    protected static final int EXPR = 0x1;\n-    protected static final int TYPE = 0x2;\n-    protected static final int NOPARAMS = 0x4;\n-    protected static final int TYPEARG = 0x8;\n-    protected static final int DIAMOND = 0x10;\n-    protected static final int NOLAMBDA = 0x20;\n+    protected static final int EXPR          = 1 << 0;\n+    protected static final int TYPE          = 1 << 1;\n+    protected static final int NOPARAMS      = 1 << 2;\n+    protected static final int TYPEARG       = 1 << 3;\n+    protected static final int DIAMOND       = 1 << 4;\n+    protected static final int NOLAMBDA      = 1 << 5;\n+\n+    protected void setMode(int mode) {\n+        this.mode = mode;\n+    }\n+\n+    protected void setLastMode(int mode) {\n+        lastmode = mode;\n+    }\n+\n+    protected boolean isMode(int mode) {\n+        return (this.mode & mode) != 0;\n+    }\n+\n+    protected boolean wasTypeMode() {\n+        return (lastmode & TYPE) != 0;\n+    }\n@@ -252,1 +268,1 @@\n-        mode = (mode & NOLAMBDA) | EXPR;\n+        setMode((mode & NOLAMBDA) | EXPR);\n@@ -256,1 +272,1 @@\n-        mode = (mode & NOLAMBDA) | TYPE;\n+        setMode((mode & NOLAMBDA) | TYPE);\n@@ -480,1 +496,1 @@\n-        if ((mode & EXPR) != 0)\n+        if (isMode(EXPR))\n@@ -860,1 +876,1 @@\n-        mode = newmode;\n+        setMode(newmode);\n@@ -862,2 +878,2 @@\n-        lastmode = mode;\n-        mode = prevmode;\n+        setLastMode(mode);\n+        setMode(prevmode);\n@@ -882,1 +898,1 @@\n-        if ((mode & EXPR) != 0 &&\n+        if (isMode(EXPR) &&\n@@ -926,1 +942,1 @@\n-        if ((mode & EXPR) != 0 && token.kind == QUES) {\n+        if (isMode(EXPR) && token.kind == QUES) {\n@@ -955,1 +971,1 @@\n-        if ((mode & EXPR) != 0 && prec(token.kind) >= TreeInfo.orPrec) {\n+        if (isMode(EXPR) && prec(token.kind) >= TreeInfo.orPrec) {\n@@ -1180,1 +1196,1 @@\n-            if ((mode & TYPE) != 0 && (mode & (TYPEARG|NOPARAMS)) == TYPEARG) {\n+            if (isMode(TYPE) && isMode(TYPEARG) && !isMode(NOPARAMS)) {\n@@ -1186,1 +1202,1 @@\n-            if (typeArgs == null && (mode & EXPR) != 0) {\n+            if (typeArgs == null && isMode(EXPR)) {\n@@ -1202,1 +1218,1 @@\n-            if (typeArgs == null && (mode & EXPR) != 0) {\n+            if (typeArgs == null && isMode(EXPR)) {\n@@ -1238,1 +1254,1 @@\n-            if ((mode & EXPR) != 0) {\n+            if (isMode(EXPR)) {\n@@ -1250,1 +1266,1 @@\n-            if ((mode & EXPR) != 0) {\n+            if (isMode(EXPR)) {\n@@ -1260,1 +1276,1 @@\n-            if (typeArgs == null && (mode & EXPR) != 0) {\n+            if (typeArgs == null && isMode(EXPR)) {\n@@ -1267,1 +1283,1 @@\n-            if ((mode & EXPR) != 0) {\n+            if (isMode(EXPR)) {\n@@ -1285,1 +1301,1 @@\n-            if ((mode & TYPE) == 0) {\n+            if (!isMode(TYPE)) {\n@@ -1315,1 +1331,1 @@\n-            if ((mode & EXPR) != 0 && (mode & NOLAMBDA) == 0 && peekToken(ARROW)) {\n+            if (isMode(EXPR) && !isMode(NOLAMBDA) && peekToken(ARROW)) {\n@@ -1340,1 +1356,1 @@\n-                            if ((mode & EXPR) != 0) {\n+                            if (isMode(EXPR)) {\n@@ -1350,1 +1366,1 @@\n-                        if ((mode & EXPR) != 0) {\n+                        if (isMode(EXPR)) {\n@@ -1362,2 +1378,2 @@\n-                        int oldmode = mode;\n-                        mode &= ~NOPARAMS;\n+                        int prevmode = mode;\n+                        setMode(mode & ~NOPARAMS);\n@@ -1365,2 +1381,2 @@\n-                        mode = oldmode;\n-                        if ((mode & EXPR) != 0) {\n+                        setMode(prevmode);\n+                        if (isMode(EXPR)) {\n@@ -1399,1 +1415,1 @@\n-                        if ((mode & TYPE) != 0 && token.kind == MONKEYS_AT) {\n+                        if (isMode(TYPE) && token.kind == MONKEYS_AT) {\n@@ -1425,1 +1441,1 @@\n-                        if ((mode & TYPE) == 0 && isUnboundMemberRef()) {\n+                        if (!isMode(TYPE) && isUnboundMemberRef()) {\n@@ -1468,1 +1484,1 @@\n-            if ((mode & EXPR) != 0) {\n+            if (isMode(EXPR)) {\n@@ -1512,0 +1528,1 @@\n+            \/\/ Not reachable.\n@@ -1575,2 +1592,2 @@\n-                if ((mode & TYPE) != 0) {\n-                    int oldmode = mode;\n+                if (isMode(TYPE)) {\n+                    int prevmode = mode;\n@@ -1591,1 +1608,1 @@\n-                    mode = oldmode;\n+                    setMode(prevmode);\n@@ -1593,1 +1610,1 @@\n-                if ((mode & EXPR) != 0) {\n+                if (isMode(EXPR)) {\n@@ -1602,1 +1619,1 @@\n-                if (token.kind == SUPER && (mode & EXPR) != 0) {\n+                if (token.kind == SUPER && isMode(EXPR)) {\n@@ -1608,1 +1625,1 @@\n-                } else if (token.kind == NEW && (mode & EXPR) != 0) {\n+                } else if (token.kind == NEW && isMode(EXPR)) {\n@@ -1618,1 +1635,1 @@\n-                    if ((mode & TYPE) != 0 && token.kind == MONKEYS_AT) {\n+                    if (isMode(TYPE) && token.kind == MONKEYS_AT) {\n@@ -1636,1 +1653,1 @@\n-            } else if ((mode & EXPR) != 0 && token.kind == COLCOL) {\n+            } else if (isMode(EXPR) && token.kind == COLCOL) {\n@@ -1651,1 +1668,1 @@\n-        while ((token.kind == PLUSPLUS || token.kind == SUBSUB) && (mode & EXPR) != 0) {\n+        while ((token.kind == PLUSPLUS || token.kind == SUBSUB) && isMode(EXPR)) {\n@@ -1793,2 +1810,2 @@\n-                        return (mode & NOLAMBDA) == 0 ? ParensResult.IMPLICIT_LAMBDA\n-                                                      : ParensResult.PARENS;\n+                        return !isMode(NOLAMBDA) ? ParensResult.IMPLICIT_LAMBDA\n+                                                 : ParensResult.PARENS;\n@@ -2043,1 +2060,1 @@\n-        if ((mode & EXPR) != 0 && token.kind == LPAREN || typeArgs != null) {\n+        if (isMode(EXPR) && token.kind == LPAREN || typeArgs != null) {\n@@ -2098,2 +2115,2 @@\n-            (mode & TYPE) != 0 &&\n-            (mode & NOPARAMS) == 0) {\n+            isMode(TYPE) &&\n+            !isMode(NOPARAMS)) {\n@@ -2112,2 +2129,2 @@\n-            if ((mode & useMode) == 0 ||\n-                (mode & NOPARAMS) != 0) {\n+            if (!isMode(useMode) ||\n+                isMode(NOPARAMS)) {\n@@ -2116,1 +2133,1 @@\n-            mode = useMode;\n+            setMode(useMode);\n@@ -2131,1 +2148,1 @@\n-                mode |= DIAMOND;\n+                setMode(mode | DIAMOND);\n@@ -2136,1 +2153,1 @@\n-                args.append(((mode & EXPR) == 0) ? typeArgument() : parseType());\n+                args.append(!isMode(EXPR) ? typeArgument() : parseType());\n@@ -2139,1 +2156,1 @@\n-                    args.append(((mode & EXPR) == 0) ? typeArgument() : parseType());\n+                    args.append(!isMode(EXPR) ? typeArgument() : parseType());\n@@ -2260,1 +2277,1 @@\n-        if ((mode & EXPR) != 0 && token.kind == DOT) {\n+        if (isMode(EXPR) && token.kind == DOT) {\n@@ -2284,1 +2301,1 @@\n-        } else if ((mode & TYPE) != 0) {\n+        } else if (isMode(TYPE)) {\n@@ -2343,1 +2360,1 @@\n-        int oldmode = mode;\n+        int prevmode = mode;\n@@ -2350,1 +2367,1 @@\n-            diamondFound = (mode & DIAMOND) != 0;\n+            diamondFound = isMode(DIAMOND);\n@@ -2369,1 +2386,1 @@\n-                diamondFound = (mode & DIAMOND) != 0;\n+                diamondFound = isMode(DIAMOND);\n@@ -2372,1 +2389,1 @@\n-        mode = oldmode;\n+        setMode(prevmode);\n@@ -2424,1 +2441,1 @@\n-            int oldmode = mode;\n+            int prevmode = mode;\n@@ -2426,1 +2443,1 @@\n-            mode = oldmode;\n+            setMode(prevmode);\n@@ -2759,1 +2776,1 @@\n-            } else if ((lastmode & TYPE) != 0 && LAX_IDENTIFIER.test(token.kind)) {\n+            } else if (wasTypeMode() && LAX_IDENTIFIER.test(token.kind)) {\n@@ -3321,1 +3338,1 @@\n-            if ((lastmode & TYPE) != 0 && LAX_IDENTIFIER.test(token.kind)) {\n+            if (wasTypeMode() && LAX_IDENTIFIER.test(token.kind)) {\n@@ -3323,1 +3340,1 @@\n-            } else if ((lastmode & TYPE) != 0 && token.kind == COLON) {\n+            } else if (wasTypeMode() && token.kind == COLON) {\n@@ -3353,2 +3370,2 @@\n-        lastmode = mode;\n-        mode = prevmode;\n+        setLastMode(mode);\n+        setMode(prevmode);\n@@ -3776,1 +3793,1 @@\n-        if ((lastmode & TYPE) != 0 && LAX_IDENTIFIER.test(token.kind)) {\n+        if (wasTypeMode() && LAX_IDENTIFIER.test(token.kind)) {\n","filename":"src\/jdk.compiler\/share\/classes\/com\/sun\/tools\/javac\/parser\/JavacParser.java","additions":84,"deletions":67,"binary":false,"changes":151,"status":"modified"}]}