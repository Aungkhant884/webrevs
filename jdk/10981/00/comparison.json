{"files":[{"patch":"@@ -243,6 +243,22 @@\n-    protected static final int EXPR = 0x1;\n-    protected static final int TYPE = 0x2;\n-    protected static final int NOPARAMS = 0x4;\n-    protected static final int TYPEARG = 0x8;\n-    protected static final int DIAMOND = 0x10;\n-    protected static final int NOLAMBDA = 0x20;\n+    protected static final int EXPR          = 1 << 0;\n+    protected static final int TYPE          = 1 << 1;\n+    protected static final int NOPARAMS      = 1 << 2;\n+    protected static final int TYPEARG       = 1 << 3;\n+    protected static final int DIAMOND       = 1 << 4;\n+    protected static final int NOLAMBDA      = 1 << 5;\n+\n+    protected void setMode(int mode) {\n+        this.mode = mode;\n+    }\n+\n+    protected void setLastMode(int mode) {\n+        lastmode = mode;\n+    }\n+\n+    protected boolean isMode(int mode) {\n+        return (this.mode & mode) != 0;\n+    }\n+\n+    protected boolean wasTypeMode() {\n+        return (lastmode & TYPE) != 0;\n+    }\n@@ -251,1 +267,1 @@\n-        mode = (mode & NOLAMBDA) | EXPR;\n+        setMode((mode & NOLAMBDA) | EXPR);\n@@ -255,1 +271,1 @@\n-        mode = (mode & NOLAMBDA) | TYPE;\n+        setMode((mode & NOLAMBDA) | TYPE);\n@@ -479,1 +495,1 @@\n-        if ((mode & EXPR) != 0)\n+        if (isMode(EXPR))\n@@ -871,1 +887,1 @@\n-        mode = newmode;\n+        setMode(newmode);\n@@ -873,2 +889,2 @@\n-        lastmode = mode;\n-        mode = prevmode;\n+        setLastMode(mode);\n+        setMode(prevmode);\n@@ -893,1 +909,1 @@\n-        if ((mode & EXPR) != 0 &&\n+        if (isMode(EXPR) &&\n@@ -937,1 +953,1 @@\n-        if ((mode & EXPR) != 0 && token.kind == QUES) {\n+        if (isMode(EXPR) && token.kind == QUES) {\n@@ -966,1 +982,1 @@\n-        if ((mode & EXPR) != 0 && prec(token.kind) >= TreeInfo.orPrec) {\n+        if (isMode(EXPR) && prec(token.kind) >= TreeInfo.orPrec) {\n@@ -1191,1 +1207,1 @@\n-            if ((mode & TYPE) != 0 && (mode & (TYPEARG|NOPARAMS)) == TYPEARG) {\n+            if (isMode(TYPE) && isMode(TYPEARG) && !isMode(NOPARAMS)) {\n@@ -1197,1 +1213,1 @@\n-            if (typeArgs == null && (mode & EXPR) != 0) {\n+            if (typeArgs == null && isMode(EXPR)) {\n@@ -1213,1 +1229,1 @@\n-            if (typeArgs == null && (mode & EXPR) != 0) {\n+            if (typeArgs == null && isMode(EXPR)) {\n@@ -1249,1 +1265,1 @@\n-            if ((mode & EXPR) != 0) {\n+            if (isMode(EXPR)) {\n@@ -1261,1 +1277,1 @@\n-            if ((mode & EXPR) != 0) {\n+            if (isMode(EXPR)) {\n@@ -1271,1 +1287,1 @@\n-            if (typeArgs == null && (mode & EXPR) != 0) {\n+            if (typeArgs == null && isMode(EXPR)) {\n@@ -1278,1 +1294,1 @@\n-            if ((mode & EXPR) != 0) {\n+            if (isMode(EXPR)) {\n@@ -1296,1 +1312,1 @@\n-            if ((mode & TYPE) == 0) {\n+            if (!isMode(TYPE)) {\n@@ -1326,1 +1342,1 @@\n-            if ((mode & EXPR) != 0 && (mode & NOLAMBDA) == 0 && peekToken(ARROW)) {\n+            if (isMode(EXPR) && !isMode(NOLAMBDA) && peekToken(ARROW)) {\n@@ -1351,1 +1367,1 @@\n-                            if ((mode & EXPR) != 0) {\n+                            if (isMode(EXPR)) {\n@@ -1361,1 +1377,1 @@\n-                        if ((mode & EXPR) != 0) {\n+                        if (isMode(EXPR)) {\n@@ -1373,1 +1389,1 @@\n-                        int oldmode = mode;\n+                        int prevmode = mode;\n@@ -1376,2 +1392,2 @@\n-                        mode = oldmode;\n-                        if ((mode & EXPR) != 0) {\n+                        setMode(prevmode);\n+                        if (isMode(EXPR)) {\n@@ -1410,1 +1426,1 @@\n-                        if ((mode & TYPE) != 0 && token.kind == MONKEYS_AT) {\n+                        if (isMode(TYPE) && token.kind == MONKEYS_AT) {\n@@ -1436,1 +1452,1 @@\n-                        if ((mode & TYPE) == 0 && isUnboundMemberRef()) {\n+                        if (!isMode(TYPE) && isUnboundMemberRef()) {\n@@ -1479,1 +1495,1 @@\n-            if ((mode & EXPR) != 0) {\n+            if (isMode(EXPR)) {\n@@ -1523,0 +1539,1 @@\n+            \/\/ Not reachable.\n@@ -1584,2 +1601,2 @@\n-                if ((mode & TYPE) != 0) {\n-                    int oldmode = mode;\n+                if (isMode(TYPE)) {\n+                    int prevmode = mode;\n@@ -1600,1 +1617,1 @@\n-                    mode = oldmode;\n+                    setMode(prevmode);\n@@ -1602,1 +1619,1 @@\n-                if ((mode & EXPR) != 0) {\n+                if (isMode(EXPR)) {\n@@ -1611,1 +1628,1 @@\n-                if (token.kind == SUPER && (mode & EXPR) != 0) {\n+                if (token.kind == SUPER && isMode(EXPR)) {\n@@ -1617,1 +1634,1 @@\n-                } else if (token.kind == NEW && (mode & EXPR) != 0) {\n+                } else if (token.kind == NEW && isMode(EXPR)) {\n@@ -1627,1 +1644,1 @@\n-                    if ((mode & TYPE) != 0 && token.kind == MONKEYS_AT) {\n+                    if (isMode(TYPE) && token.kind == MONKEYS_AT) {\n@@ -1645,1 +1662,1 @@\n-            } else if ((mode & EXPR) != 0 && token.kind == COLCOL) {\n+            } else if (isMode(EXPR) && token.kind == COLCOL) {\n@@ -1660,1 +1677,1 @@\n-        while ((token.kind == PLUSPLUS || token.kind == SUBSUB) && (mode & EXPR) != 0) {\n+        while ((token.kind == PLUSPLUS || token.kind == SUBSUB) && isMode(EXPR)) {\n@@ -1802,2 +1819,2 @@\n-                        return (mode & NOLAMBDA) == 0 ? ParensResult.IMPLICIT_LAMBDA\n-                                                      : ParensResult.PARENS;\n+                        return !isMode(NOLAMBDA) ? ParensResult.IMPLICIT_LAMBDA\n+                                                 : ParensResult.PARENS;\n@@ -2052,1 +2069,1 @@\n-        if ((mode & EXPR) != 0 && token.kind == LPAREN || typeArgs != null) {\n+        if (isMode(EXPR) && token.kind == LPAREN || typeArgs != null) {\n@@ -2107,2 +2124,2 @@\n-            (mode & TYPE) != 0 &&\n-            (mode & NOPARAMS) == 0) {\n+            isMode(TYPE) &&\n+            !isMode(NOPARAMS)) {\n@@ -2121,2 +2138,2 @@\n-            if ((mode & useMode) == 0 ||\n-                (mode & NOPARAMS) != 0) {\n+            if (!isMode(useMode) ||\n+                isMode(NOPARAMS)) {\n@@ -2125,1 +2142,1 @@\n-            mode = useMode;\n+            setMode(useMode);\n@@ -2145,1 +2162,1 @@\n-                args.append(((mode & EXPR) == 0) ? typeArgument() : parseType());\n+                args.append(!isMode(EXPR) ? typeArgument() : parseType());\n@@ -2148,1 +2165,1 @@\n-                    args.append(((mode & EXPR) == 0) ? typeArgument() : parseType());\n+                    args.append(!isMode(EXPR) ? typeArgument() : parseType());\n@@ -2269,1 +2286,1 @@\n-        if ((mode & EXPR) != 0 && token.kind == DOT) {\n+        if (isMode(EXPR) && token.kind == DOT) {\n@@ -2293,1 +2310,1 @@\n-        } else if ((mode & TYPE) != 0) {\n+        } else if (isMode(TYPE)) {\n@@ -2352,1 +2369,1 @@\n-        int oldmode = mode;\n+        int prevmode = mode;\n@@ -2359,1 +2376,1 @@\n-            diamondFound = (mode & DIAMOND) != 0;\n+            diamondFound = isMode(DIAMOND);\n@@ -2378,1 +2395,1 @@\n-                diamondFound = (mode & DIAMOND) != 0;\n+                diamondFound = isMode(DIAMOND);\n@@ -2381,1 +2398,1 @@\n-        mode = oldmode;\n+        setMode(prevmode);\n@@ -2433,1 +2450,1 @@\n-            int oldmode = mode;\n+            int prevmode = mode;\n@@ -2435,1 +2452,1 @@\n-            mode = oldmode;\n+            setMode(prevmode);\n@@ -2768,1 +2785,1 @@\n-            } else if ((lastmode & TYPE) != 0 && LAX_IDENTIFIER.test(token.kind)) {\n+            } else if (wasTypeMode() && LAX_IDENTIFIER.test(token.kind)) {\n@@ -3216,1 +3233,1 @@\n-            if ((lastmode & TYPE) != 0 && LAX_IDENTIFIER.test(token.kind)) {\n+            if (wasTypeMode() && LAX_IDENTIFIER.test(token.kind)) {\n@@ -3218,1 +3235,1 @@\n-            } else if ((lastmode & TYPE) != 0 && token.kind == COLON) {\n+            } else if (wasTypeMode() && token.kind == COLON) {\n@@ -3248,2 +3265,2 @@\n-        lastmode = mode;\n-        mode = prevmode;\n+        setLastMode(mode);\n+        setMode(prevmode);\n@@ -3671,1 +3688,1 @@\n-        if ((lastmode & TYPE) != 0 && LAX_IDENTIFIER.test(token.kind)) {\n+        if (wasTypeMode() && LAX_IDENTIFIER.test(token.kind)) {\n","filename":"src\/jdk.compiler\/share\/classes\/com\/sun\/tools\/javac\/parser\/JavacParser.java","additions":82,"deletions":65,"binary":false,"changes":147,"status":"modified"}]}