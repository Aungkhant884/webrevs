{"files":[{"patch":"@@ -28,1 +28,1 @@\n- *\n+ * @build sun.hotspot.WhiteBox\n@@ -33,1 +33,2 @@\n-\n+ * @run driver jdk.test.lib.helpers.ClassFileInstaller sun.hotspot.WhiteBox\n+ *\n@@ -37,0 +38,1 @@\n+ *                   -XX:+WhiteBoxAPI\n@@ -53,0 +55,2 @@\n+import sun.hotspot.code.Compiler;\n+\n@@ -217,7 +221,6 @@\n-    static void testMatched(Callable<?> c, Runnable setDefaultAction) throws Exception {\n-        run(c, setDefaultAction, null);\n-        Setter.reset();\n-    }\n-\n-    static void testMismatched(Callable<?> c, Runnable setDefaultAction) throws Exception {\n-        run(c, null, setDefaultAction);\n+    static void test(Callable<?> c, Runnable setDefaultAction, boolean matched) throws Exception {\n+        if (matched) {\n+            run(c, setDefaultAction, null);\n+        } else {\n+            run(c, null, setDefaultAction);\n+        }\n@@ -228,0 +231,2 @@\n+        boolean graal = Compiler.isGraalEnabled();\n+\n@@ -229,8 +234,8 @@\n-        testMatched(   Test::testZ_Z, Test::changeZ);\n-        testMismatched(Test::testZ_B, Test::changeZ);\n-        testMismatched(Test::testZ_S, Test::changeZ);\n-        testMismatched(Test::testZ_C, Test::changeZ);\n-        testMismatched(Test::testZ_I, Test::changeZ);\n-        testMismatched(Test::testZ_J, Test::changeZ);\n-        testMismatched(Test::testZ_F, Test::changeZ);\n-        testMismatched(Test::testZ_D, Test::changeZ);\n+        test(Test::testZ_Z, Test::changeZ, true);\n+        test(Test::testZ_B, Test::changeZ, graal);\n+        test(Test::testZ_S, Test::changeZ, graal);\n+        test(Test::testZ_C, Test::changeZ, graal);\n+        test(Test::testZ_I, Test::changeZ, graal);\n+        test(Test::testZ_J, Test::changeZ, graal);\n+        test(Test::testZ_F, Test::changeZ, graal);\n+        test(Test::testZ_D, Test::changeZ, graal);\n@@ -239,8 +244,8 @@\n-        testMismatched(Test::testB_Z, Test::changeB);\n-        testMatched(   Test::testB_B, Test::changeB);\n-        testMismatched(Test::testB_S, Test::changeB);\n-        testMismatched(Test::testB_C, Test::changeB);\n-        testMismatched(Test::testB_I, Test::changeB);\n-        testMismatched(Test::testB_J, Test::changeB);\n-        testMismatched(Test::testB_F, Test::changeB);\n-        testMismatched(Test::testB_D, Test::changeB);\n+        test(Test::testB_Z, Test::changeB, graal);\n+        test(Test::testB_B, Test::changeB, true);\n+        test(Test::testB_S, Test::changeB, graal);\n+        test(Test::testB_C, Test::changeB, graal);\n+        test(Test::testB_I, Test::changeB, graal);\n+        test(Test::testB_J, Test::changeB, graal);\n+        test(Test::testB_F, Test::changeB, graal);\n+        test(Test::testB_D, Test::changeB, graal);\n@@ -249,8 +254,8 @@\n-        testMismatched(Test::testS_Z, Test::changeS);\n-        testMismatched(Test::testS_B, Test::changeS);\n-        testMatched(   Test::testS_S, Test::changeS);\n-        testMismatched(Test::testS_C, Test::changeS);\n-        testMismatched(Test::testS_I, Test::changeS);\n-        testMismatched(Test::testS_J, Test::changeS);\n-        testMismatched(Test::testS_F, Test::changeS);\n-        testMismatched(Test::testS_D, Test::changeS);\n+        test(Test::testS_Z, Test::changeS, graal);\n+        test(Test::testS_B, Test::changeS, graal);\n+        test(Test::testS_S, Test::changeS, true);\n+        test(Test::testS_C, Test::changeS, graal);\n+        test(Test::testS_I, Test::changeS, graal);\n+        test(Test::testS_J, Test::changeS, graal);\n+        test(Test::testS_F, Test::changeS, graal);\n+        test(Test::testS_D, Test::changeS, graal);\n@@ -259,8 +264,8 @@\n-        testMismatched(Test::testC_Z, Test::changeC);\n-        testMismatched(Test::testC_B, Test::changeC);\n-        testMismatched(Test::testC_S, Test::changeC);\n-        testMatched(   Test::testC_C, Test::changeC);\n-        testMismatched(Test::testC_I, Test::changeC);\n-        testMismatched(Test::testC_J, Test::changeC);\n-        testMismatched(Test::testC_F, Test::changeC);\n-        testMismatched(Test::testC_D, Test::changeC);\n+        test(Test::testC_Z, Test::changeC, graal);\n+        test(Test::testC_B, Test::changeC, graal);\n+        test(Test::testC_S, Test::changeC, graal);\n+        test(Test::testC_C, Test::changeC, true);\n+        test(Test::testC_I, Test::changeC, graal);\n+        test(Test::testC_J, Test::changeC, graal);\n+        test(Test::testC_F, Test::changeC, graal);\n+        test(Test::testC_D, Test::changeC, graal);\n@@ -269,8 +274,8 @@\n-        testMismatched(Test::testI_Z, Test::changeI);\n-        testMismatched(Test::testI_B, Test::changeI);\n-        testMismatched(Test::testI_S, Test::changeI);\n-        testMismatched(Test::testI_C, Test::changeI);\n-        testMatched(   Test::testI_I, Test::changeI);\n-        testMismatched(Test::testI_J, Test::changeI);\n-        testMismatched(Test::testI_F, Test::changeI);\n-        testMismatched(Test::testI_D, Test::changeI);\n+        test(Test::testI_Z, Test::changeI, graal);\n+        test(Test::testI_B, Test::changeI, graal);\n+        test(Test::testI_S, Test::changeI, graal);\n+        test(Test::testI_C, Test::changeI, graal);\n+        test(Test::testI_I, Test::changeI, true);\n+        test(Test::testI_J, Test::changeI, graal);\n+        test(Test::testI_F, Test::changeI, graal);\n+        test(Test::testI_D, Test::changeI, graal);\n@@ -279,8 +284,8 @@\n-        testMismatched(Test::testJ_Z, Test::changeJ);\n-        testMismatched(Test::testJ_B, Test::changeJ);\n-        testMismatched(Test::testJ_S, Test::changeJ);\n-        testMismatched(Test::testJ_C, Test::changeJ);\n-        testMismatched(Test::testJ_I, Test::changeJ);\n-        testMatched(   Test::testJ_J, Test::changeJ);\n-        testMismatched(Test::testJ_F, Test::changeJ);\n-        testMismatched(Test::testJ_D, Test::changeJ);\n+        test(Test::testJ_Z, Test::changeJ, graal);\n+        test(Test::testJ_B, Test::changeJ, graal);\n+        test(Test::testJ_S, Test::changeJ, graal);\n+        test(Test::testJ_C, Test::changeJ, graal);\n+        test(Test::testJ_I, Test::changeJ, graal);\n+        test(Test::testJ_J, Test::changeJ, true);\n+        test(Test::testJ_F, Test::changeJ, graal);\n+        test(Test::testJ_D, Test::changeJ, graal);\n@@ -289,8 +294,8 @@\n-        testMismatched(Test::testF_Z, Test::changeF);\n-        testMismatched(Test::testF_B, Test::changeF);\n-        testMismatched(Test::testF_S, Test::changeF);\n-        testMismatched(Test::testF_C, Test::changeF);\n-        testMismatched(Test::testF_I, Test::changeF);\n-        testMismatched(Test::testF_J, Test::changeF);\n-        testMatched(   Test::testF_F, Test::changeF);\n-        testMismatched(Test::testF_D, Test::changeF);\n+        test(Test::testF_Z, Test::changeF, graal);\n+        test(Test::testF_B, Test::changeF, graal);\n+        test(Test::testF_S, Test::changeF, graal);\n+        test(Test::testF_C, Test::changeF, graal);\n+        test(Test::testF_I, Test::changeF, graal);\n+        test(Test::testF_J, Test::changeF, graal);\n+        test(Test::testF_F, Test::changeF, true);\n+        test(Test::testF_D, Test::changeF, graal);\n@@ -299,8 +304,8 @@\n-        testMismatched(Test::testD_Z, Test::changeD);\n-        testMismatched(Test::testD_B, Test::changeD);\n-        testMismatched(Test::testD_S, Test::changeD);\n-        testMismatched(Test::testD_C, Test::changeD);\n-        testMismatched(Test::testD_I, Test::changeD);\n-        testMismatched(Test::testD_J, Test::changeD);\n-        testMismatched(Test::testD_F, Test::changeD);\n-        testMatched(   Test::testD_D, Test::changeD);\n+        test(Test::testD_Z, Test::changeD, graal);\n+        test(Test::testD_B, Test::changeD, graal);\n+        test(Test::testD_S, Test::changeD, graal);\n+        test(Test::testD_C, Test::changeD, graal);\n+        test(Test::testD_I, Test::changeD, graal);\n+        test(Test::testD_J, Test::changeD, graal);\n+        test(Test::testD_F, Test::changeD, graal);\n+        test(Test::testD_D, Test::changeD, true);\n@@ -309,3 +314,3 @@\n-        testMismatched(Test::testL_J, Test::changeL); \/\/ long & double are always as large as an OOP\n-        testMismatched(Test::testL_D, Test::changeL);\n-        testMatched(   Test::testL_L, Test::changeL);\n+        test(Test::testL_J, Test::changeL, false); \/\/ long & double are always as large as an OOP\n+        test(Test::testL_D, Test::changeL, false);\n+        test(Test::testL_L, Test::changeL, true);\n@@ -314,4 +319,4 @@\n-        testMismatched(Test::testS_U, Test::changeS);\n-        testMismatched(Test::testC_U, Test::changeC);\n-        testMismatched(Test::testI_U, Test::changeI);\n-        testMismatched(Test::testJ_U, Test::changeJ);\n+        test(Test::testS_U, Test::changeS, graal);\n+        test(Test::testC_U, Test::changeC, graal);\n+        test(Test::testI_U, Test::changeI, graal);\n+        test(Test::testJ_U, Test::changeJ, graal);\n","filename":"test\/hotspot\/jtreg\/compiler\/unsafe\/UnsafeGetStableArrayElement.java","additions":85,"deletions":80,"binary":false,"changes":165,"status":"modified"}]}