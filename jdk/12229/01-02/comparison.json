{"files":[{"patch":"@@ -49,1 +49,1 @@\n-\/\/ shutdown cleaning at the moment and some leaks occur, we want to ignore these. Instead we\n+\/\/ shutdown cleanly at the moment and some leaks occur, we want to ignore these. Instead we\n","filename":"make\/data\/lsan\/lsan_default_options.c","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -3975,13 +3975,0 @@\n-#ifdef LEAK_SANITIZER\n-#ifdef _LP64\n-  \/\/ LSAN relies on pointers to be natively aligned. Using compressed class pointers breaks this\n-  \/\/ expectation and results in nondeterministic leak reports.\n-  if (FLAG_SET_CMDLINE(UseCompressedOops, false) != JVMFlag::SUCCESS) {\n-    return JNI_EINVAL;\n-  }\n-  if (FLAG_SET_CMDLINE(UseCompressedClassPointers, false) != JVMFlag::SUCCESS) {\n-    return JNI_EINVAL;\n-  }\n-#endif \/\/ _LP64\n-#endif \/\/ LEAK_SANITIZER\n-\n","filename":"src\/hotspot\/share\/runtime\/arguments.cpp","additions":0,"deletions":13,"binary":false,"changes":13,"status":"modified"},{"patch":"@@ -128,0 +128,1 @@\n+#ifdef LEAK_SANITIZER\n@@ -133,0 +134,1 @@\n+#endif \/\/ LEAK_SANITIZER\n@@ -194,0 +196,1 @@\n+#ifdef LEAK_SANITIZER\n@@ -199,0 +202,1 @@\n+#endif \/\/ LEAK_SANITIZER\n","filename":"src\/hotspot\/share\/runtime\/init.cpp","additions":4,"deletions":0,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -420,0 +420,9 @@\n+  \/\/ At this point only one thread is executing this logic. Any other threads\n+  \/\/ attempting to invoke before_exit() will wait above and return early once\n+  \/\/ this thread finishes before_exit().\n+\n+  \/\/ Do not add any additional shutdown logic between the above mutex logic and\n+  \/\/ leak sanitizer logic below. Any additional shutdown code which performs some\n+  \/\/ cleanup should be added after the leak sanitizer logic below.\n+\n+#ifdef LEAK_SANITIZER\n@@ -428,1 +437,0 @@\n-    int result = LSAN_DO_RECOVERABLE_LEAK_CHECK();\n@@ -430,1 +438,1 @@\n-    static_cast<void>(result);\n+    static_cast<void>(LSAN_DO_RECOVERABLE_LEAK_CHECK());\n@@ -432,0 +440,3 @@\n+#endif\n+\n+  \/\/ Actual shutdown logic begins here.\n","filename":"src\/hotspot\/share\/runtime\/java.cpp","additions":13,"deletions":2,"binary":false,"changes":15,"status":"modified"}]}