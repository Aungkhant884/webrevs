{"files":[{"patch":"@@ -41,0 +41,2 @@\n+import javax.swing.UIManager;\n+import javax.swing.UnsupportedLookAndFeelException;\n@@ -70,2 +72,1 @@\n-    public static void main(String[] args) throws  Exception {\n-\n+    private static void setLookAndFeel(UIManager.LookAndFeelInfo laf) {\n@@ -73,23 +74,10 @@\n-            SwingUtilities.invokeAndWait(() -> {\n-                frame = new JFrame();\n-                frame.setLayout(new BorderLayout());\n-\n-                firstMenu = new JMenu(\"first\");\n-                a = new JMenuItem(\"a\");\n-                b = new JMenuItem(\"b\");\n-                firstMenu.add(a);\n-                firstMenu.add(b);\n-\n-                secondMenu = new JMenu(\"second\");\n-                c = new JMenuItem(\"c\");\n-                d = new JMenuItem(\"d\");\n-                secondMenu.add(c);\n-                secondMenu.add(d);\n-                secondMenu.addMenuListener(new MenuListener() {\n-                    @Override\n-                    public void menuSelected(MenuEvent e) {\n-                        passed = true;\n-                    }\n-                    @Override\n-                    public void menuDeselected(MenuEvent e) {\n-                    }\n+            UIManager.setLookAndFeel(laf.getClassName());\n+        } catch (UnsupportedLookAndFeelException ignored) {\n+            System.out.println(\"Unsupported L&F: \" + laf.getClassName());\n+        } catch (ClassNotFoundException | InstantiationException\n+                 | IllegalAccessException e) {\n+            throw new RuntimeException(e);\n+        }\n+    }\n+\n+    public static void main(String[] args) throws  Exception {\n@@ -97,2 +85,88 @@\n-                    @Override\n-                    public void menuCanceled(MenuEvent e) {\n+        for (UIManager.LookAndFeelInfo laf : UIManager.getInstalledLookAndFeels()) {\n+            System.out.println(\"Testing L&F: \" + laf.getClassName());\n+            passed = false;\n+            SwingUtilities.invokeAndWait(() -> setLookAndFeel(laf));\n+            try {\n+                SwingUtilities.invokeAndWait(() -> {\n+                    frame = new JFrame();\n+                    frame.setLayout(new BorderLayout());\n+\n+                    firstMenu = new JMenu(\"first\");\n+                    a = new JMenuItem(\"a\");\n+                    b = new JMenuItem(\"b\");\n+                    firstMenu.add(a);\n+                    firstMenu.add(b);\n+\n+                    secondMenu = new JMenu(\"second\");\n+                    c = new JMenuItem(\"c\");\n+                    d = new JMenuItem(\"d\");\n+                    secondMenu.add(c);\n+                    secondMenu.add(d);\n+                    secondMenu.addMenuListener(new MenuListener() {\n+                        @Override\n+                        public void menuSelected(MenuEvent e) {\n+                            passed = true;\n+                        }\n+                        @Override\n+                        public void menuDeselected(MenuEvent e) {\n+                        }\n+\n+                        @Override\n+                        public void menuCanceled(MenuEvent e) {\n+                        }\n+                    });\n+\n+                    thirdMenu = new JMenu(\"third\");\n+                    e = new JMenuItem(\"e\");\n+                    f = new JMenuItem(\"f\");\n+                    thirdMenu.add(e);\n+                    thirdMenu.add(f);\n+\n+                    forthMenu = new JMenu(\"fourth\");\n+                    e = new JMenuItem(\"e\");\n+                    f = new JMenuItem(\"f\");\n+                    forthMenu.add(e);\n+                    forthMenu.add(f);\n+\n+                    fifthMenu = new JMenu(\"fifth\");\n+                    e = new JMenuItem(\"e\");\n+                    f = new JMenuItem(\"f\");\n+                    fifthMenu.add(e);\n+                    fifthMenu.add(f);\n+\n+                    menuBar = new JMenuBar();\n+                    menuBar.setComponentOrientation(ComponentOrientation.RIGHT_TO_LEFT);\n+                    menuBar.add(firstMenu);\n+                    menuBar.add(secondMenu);\n+                    menuBar.add(thirdMenu);\n+                    menuBar.add(forthMenu);\n+                    menuBar.add(fifthMenu);\n+                    frame.setJMenuBar(menuBar);\n+\n+                    frame.setLocationRelativeTo(null);\n+                    frame.pack();\n+                    frame.setVisible(true);\n+                });\n+                Robot robot = new Robot();\n+                robot.setAutoDelay(100);\n+                robot.waitForIdle();\n+                robot.delay(1000);\n+                SwingUtilities.invokeAndWait(() -> {\n+                    p = thirdMenu.getLocationOnScreen();\n+                    width = thirdMenu.getWidth();\n+                    height = thirdMenu.getHeight();\n+                });\n+                robot.mouseMove(p.x + width \/ 2, p.y + height \/ 2);\n+                robot.mousePress(InputEvent.BUTTON1_DOWN_MASK);\n+                robot.mouseRelease(InputEvent.BUTTON1_DOWN_MASK);\n+                robot.delay(1000);\n+                robot.keyPress(KeyEvent.VK_RIGHT);\n+                robot.keyRelease(KeyEvent.VK_RIGHT);\n+                robot.delay(1000);\n+                if (!passed) {\n+                    throw new RuntimeException(\"Arrow traversal order not correct in RTL orientation\");\n+                }\n+            } finally {\n+                SwingUtilities.invokeAndWait(() -> {\n+                    if (frame != null) {\n+                        frame.dispose();\n@@ -101,51 +175,0 @@\n-\n-\n-                thirdMenu = new JMenu(\"third\");\n-                e = new JMenuItem(\"e\");\n-                f = new JMenuItem(\"f\");\n-                thirdMenu.add(e);\n-                thirdMenu.add(f);\n-\n-                forthMenu = new JMenu(\"fourth\");\n-                e = new JMenuItem(\"e\");\n-                f = new JMenuItem(\"f\");\n-                forthMenu.add(e);\n-                forthMenu.add(f);\n-\n-                fifthMenu = new JMenu(\"fifth\");\n-                e = new JMenuItem(\"e\");\n-                f = new JMenuItem(\"f\");\n-                fifthMenu.add(e);\n-                fifthMenu.add(f);\n-\n-                menuBar = new JMenuBar();\n-                menuBar.setComponentOrientation(ComponentOrientation.RIGHT_TO_LEFT);\n-                menuBar.add(firstMenu);\n-                menuBar.add(secondMenu);\n-                menuBar.add(thirdMenu);\n-                menuBar.add(forthMenu);\n-                menuBar.add(fifthMenu);\n-                frame.setJMenuBar(menuBar);\n-\n-                frame.setLocationRelativeTo(null);\n-                frame.pack();\n-                frame.setVisible(true);\n-            });\n-            Robot robot = new Robot();\n-            robot.setAutoDelay(100);\n-            robot.waitForIdle();\n-            robot.delay(1000);\n-            SwingUtilities.invokeAndWait(() -> {\n-                p = thirdMenu.getLocationOnScreen();\n-                width = thirdMenu.getWidth();\n-                height = thirdMenu.getHeight();\n-            });\n-            robot.mouseMove(p.x + width \/ 2, p.y + height \/ 2);\n-            robot.mousePress(InputEvent.BUTTON1_DOWN_MASK);\n-            robot.mouseRelease(InputEvent.BUTTON1_DOWN_MASK);\n-            robot.delay(1000);\n-            robot.keyPress(KeyEvent.VK_RIGHT);\n-            robot.keyRelease(KeyEvent.VK_RIGHT);\n-            robot.delay(1000);\n-            if (!passed) {\n-                throw new RuntimeException(\"Arrow traversal order not correct in RTL orientation\");\n@@ -153,7 +176,1 @@\n-        } finally {\n-            SwingUtilities.invokeAndWait(() -> {\n-                if (frame != null) {\n-                    frame.dispose();\n-                }\n-            });\n-        }\n+\t}\n","filename":"test\/jdk\/javax\/swing\/JMenuBar\/MenuBarRTLBug.java","additions":102,"deletions":85,"binary":false,"changes":187,"status":"modified"}]}