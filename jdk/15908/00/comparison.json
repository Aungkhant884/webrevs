{"files":[{"patch":"@@ -1099,1 +1099,4 @@\n-            SocketReadEvent.offer(start, nbytes, parent.getRemoteSocketAddress(), getSoTimeout());\n+            long duration = SocketReadEvent.timestamp() - start;\n+            if (SocketReadEvent.shouldCommit(duration)) {\n+                SocketReadEvent.emit(start, duration, nbytes, parent.getRemoteSocketAddress(), getSoTimeout());\n+            }\n@@ -1212,1 +1215,4 @@\n-            SocketWriteEvent.offer(start, len, parent.getRemoteSocketAddress());\n+            long duration = SocketWriteEvent.timestamp() - start;\n+            if (SocketWriteEvent.shouldCommit(duration)) {\n+                SocketWriteEvent.emit(start, duration, len, parent.getRemoteSocketAddress());\n+            }\n","filename":"src\/java.base\/share\/classes\/java\/net\/Socket.java","additions":8,"deletions":2,"binary":false,"changes":10,"status":"modified"},{"patch":"@@ -116,0 +116,1 @@\n+     * @param duration the duration\n@@ -120,11 +121,8 @@\n-    public static void offer(long start, long nbytes, SocketAddress remote, long timeout) {\n-        long duration = timestamp() - start;\n-        if (shouldCommit(duration)) {\n-            boolean eof = nbytes < 0 ? true : false;\n-            nbytes = nbytes < 0 ? 0 : nbytes;\n-            if (remote instanceof InetSocketAddress isa) {\n-                commit(start, duration, isa.getHostString(), isa.getAddress().getHostAddress(), isa.getPort(), timeout, nbytes, eof);\n-            } else if (remote instanceof UnixDomainSocketAddress udsa) {\n-                String path = \"[\" + udsa.getPath().toString() + \"]\";\n-                commit(start, duration, \"Unix domain socket\", path, 0, timeout, nbytes, eof);\n-            }\n+    public static void emit(long start, long duration, long nbytes, SocketAddress remote, long timeout) {\n+        boolean eof = nbytes < 0 ? true : false;\n+        nbytes = nbytes < 0 ? 0 : nbytes;\n+        if (remote instanceof InetSocketAddress isa) {\n+            commit(start, duration, isa.getHostString(), isa.getAddress().getHostAddress(), isa.getPort(), timeout, nbytes, eof);\n+        } else if (remote instanceof UnixDomainSocketAddress udsa) {\n+            String path = \"[\" + udsa.getPath().toString() + \"]\";\n+            commit(start, duration, \"Unix domain socket\", path, 0, timeout, nbytes, eof);\n","filename":"src\/java.base\/share\/classes\/jdk\/internal\/event\/SocketReadEvent.java","additions":9,"deletions":11,"binary":false,"changes":20,"status":"modified"},{"patch":"@@ -111,0 +111,1 @@\n+     * @param duration the duration\n@@ -114,10 +115,7 @@\n-    public static void offer(long start, long bytesWritten, SocketAddress remote) {\n-        long duration = timestamp() - start;\n-        if (shouldCommit(duration)) {\n-            long bytes = bytesWritten < 0 ? 0 : bytesWritten;\n-            if (remote instanceof InetSocketAddress isa) {\n-                commit(start, duration, isa.getHostString(), isa.getAddress().getHostAddress(), isa.getPort(), bytes);\n-            } else if (remote instanceof UnixDomainSocketAddress udsa) {\n-                String path = \"[\" + udsa.getPath().toString() + \"]\";\n-                commit(start, duration, \"Unix domain socket\", path, 0, bytes);\n-            }\n+    public static void emit(long start, long duration, long bytesWritten, SocketAddress remote) {\n+        long bytes = bytesWritten < 0 ? 0 : bytesWritten;\n+        if (remote instanceof InetSocketAddress isa) {\n+            commit(start, duration, isa.getHostString(), isa.getAddress().getHostAddress(), isa.getPort(), bytes);\n+        } else if (remote instanceof UnixDomainSocketAddress udsa) {\n+            String path = \"[\" + udsa.getPath().toString() + \"]\";\n+            commit(start, duration, \"Unix domain socket\", path, 0, bytes);\n","filename":"src\/java.base\/share\/classes\/jdk\/internal\/event\/SocketWriteEvent.java","additions":8,"deletions":10,"binary":false,"changes":18,"status":"modified"},{"patch":"@@ -497,1 +497,4 @@\n-        SocketReadEvent.offer(start, nbytes, remoteAddress(), 0);\n+        long duration = SocketReadEvent.timestamp() - start;\n+        if (SocketReadEvent.shouldCommit(duration)) {\n+            SocketReadEvent.emit(start, duration, nbytes, remoteAddress(), 0);\n+        }\n@@ -511,1 +514,4 @@\n-        SocketReadEvent.offer(start, nbytes, remoteAddress(), 0);\n+        long duration = SocketReadEvent.timestamp() - start;\n+        if (SocketReadEvent.shouldCommit(duration)) {\n+            SocketReadEvent.emit(start, duration, nbytes, remoteAddress(), 0);\n+        }\n@@ -622,1 +628,4 @@\n-        SocketWriteEvent.offer(start, nbytes, remoteAddress());\n+        long duration = SocketWriteEvent.timestamp() - start;\n+        if (SocketWriteEvent.shouldCommit(duration)) {\n+            SocketWriteEvent.emit(start, duration, nbytes, remoteAddress());\n+        }\n@@ -635,1 +644,4 @@\n-        SocketWriteEvent.offer(start, nbytes, remoteAddress());\n+        long duration = SocketWriteEvent.timestamp() - start;\n+        if (SocketWriteEvent.shouldCommit(duration)) {\n+            SocketWriteEvent.emit(start, duration, nbytes, remoteAddress());\n+        }\n","filename":"src\/java.base\/share\/classes\/sun\/nio\/ch\/SocketChannelImpl.java","additions":16,"deletions":4,"binary":false,"changes":20,"status":"modified"}]}