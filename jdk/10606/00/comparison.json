{"files":[{"patch":"@@ -24,0 +24,1 @@\n+import java.awt.Dimension;\n@@ -36,0 +37,1 @@\n+import java.awt.event.MouseAdapter;\n@@ -37,1 +39,7 @@\n-import java.awt.event.*;\n+import java.io.File;\n+import java.io.IOException;\n+import java.util.concurrent.atomic.AtomicReference;\n+import java.util.stream.IntStream;\n+import javax.imageio.ImageIO;\n+import javax.swing.SwingUtilities;\n+\n@@ -51,0 +59,2 @@\n+    private static Robot robot;\n+\n@@ -53,0 +63,2 @@\n+        robot = new Robot();\n+        robot.setAutoDelay(200);\n@@ -74,4 +86,5 @@\n-        for (int i = 1; i < 7; i++) {\n-            pm.add(TEXT + i);\n-        }\n-        pm.addActionListener(e -> action = true);\n+        IntStream.rangeClosed(1, 6).forEach(i -> pm.add(TEXT + i));\n+        pm.addActionListener(e -> {\n+            action = true;\n+            System.out.println(\" Got action event \" + e);\n+        });\n@@ -109,2 +122,0 @@\n-        Robot robot = new Robot();\n-        robot.setAutoDelay(200);\n@@ -112,2 +123,6 @@\n-        Point pt = frame.getLocationOnScreen();\n-        robot.mouseMove(pt.x + frame.getWidth() \/ 2, pt.y + 50);\n+        final AtomicReference<Point> pointObj = new AtomicReference<>();\n+        SwingUtilities.invokeAndWait(() -> pointObj.set(frame.getLocationOnScreen()));\n+        Point pt = pointObj.get();\n+        int x = pt.x + frame.getWidth() \/ 2;\n+        int y = pt.y + 50;\n+        robot.mouseMove(x, y);\n@@ -116,2 +131,1 @@\n-        int x = pt.x + frame.getWidth() \/ 2;\n-        int y = pt.y + 130;\n+         y = y+50;\n@@ -123,1 +137,3 @@\n-            throw new RuntimeException();\n+            captureScreen();\n+            throw new RuntimeException(\n+                    \"Failed, Not received the PopupMenu ActionEvent yet\");\n@@ -127,0 +143,12 @@\n+\n+    private static void captureScreen() {\n+        Dimension screenSize = Toolkit.getDefaultToolkit().getScreenSize();\n+        try {\n+            ImageIO.write(robot.createScreenCapture(\n+                    new Rectangle(0, 0, screenSize.width, screenSize.height)),\n+                          \"png\", new File(\"screen1.png\"));\n+        } catch (IOException ignore) {\n+        }\n+        action = false;\n+    }\n+\n","filename":"test\/jdk\/java\/awt\/PopupMenu\/PopupMenuLocation.java","additions":40,"deletions":12,"binary":false,"changes":52,"status":"modified"}]}