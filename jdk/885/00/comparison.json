{"files":[{"patch":"@@ -4441,7 +4441,1 @@\n-      ResourceMark rm(THREAD);\n-      Exceptions::fthrow(\n-        THREAD_AND_LOCATION,\n-        vmSymbols::java_lang_VerifyError(),\n-        \"class %s cannot inherit from final class %s\",\n-        this_klass->external_name(),\n-        super_ik->external_name());\n+      classfile_icce_error(\"class %s cannot inherit from final class %s\", super_ik, THREAD);\n@@ -4592,9 +4586,6 @@\n-              Exceptions::fthrow(THREAD_AND_LOCATION,\n-                                 vmSymbols::java_lang_VerifyError(),\n-                                 \"class %s overrides final method %s.%s%s\",\n-                                 this_klass->external_name(),\n-                                 super_m->method_holder()->external_name(),\n-                                 name->as_C_string(),\n-                                 signature->as_C_string()\n-                                 );\n-              return;\n+              THROW_MSG(vmSymbols::java_lang_IncompatibleClassChangeError(),\n+                        err_msg(\"class %s overrides final method %s.%s%s\",\n+                                this_klass->external_name(),\n+                                super_m->method_holder()->external_name(),\n+                                name->as_C_string(),\n+                                signature->as_C_string()));\n","filename":"src\/hotspot\/share\/classfile\/classFileParser.cpp","additions":7,"deletions":16,"binary":false,"changes":23,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2014, 2016, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2014, 2020, Oracle and\/or its affiliates. All rights reserved.\n@@ -131,1 +131,1 @@\n-            \"java.lang.VerifyError: class Overrider overrides final method HasFinal.m(Ljava\/lang\/String;)V\");\n+            \"java.lang.IncompatibleClassChangeError: class Overrider overrides final method HasFinal.m(Ljava\/lang\/String;)V\");\n","filename":"test\/hotspot\/jtreg\/runtime\/verifier\/OverriderMsg.java","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -33,3 +33,3 @@\n- *     Try to load anonymous class derived from java.lang.System. The verification\n- *     system (split verifier and system class loader) should reject such attempt and\n- *     throw VerifyError.\n+ *     Try to load anonymous class derived from java.lang.System. The class file\n+ *     loader should reject such attempt and throw IncompatibleClassChangeError\n+ *     because java.lang.System is a final class.\n@@ -47,1 +47,1 @@\n- *      -requireExceptions java.lang.VerifyError\n+ *      -requireExceptions java.lang.IncompatibleClassChangeError\n","filename":"test\/hotspot\/jtreg\/vmTestbase\/vm\/mlvm\/anonloader\/func\/finalSuperclass\/TestDescription.java","additions":4,"deletions":4,"binary":false,"changes":8,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2013, 2018, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2013, 2020, Oracle and\/or its affiliates. All rights reserved.\n@@ -126,1 +126,1 @@\n-        b.test().loadClass(I).throws_(VerifyError.class).done()\n+        b.test().loadClass(I).throws_(IncompatibleClassChangeError.class).done()\n@@ -161,1 +161,1 @@\n-        b.test().loadClass(I).throws_(VerifyError.class).done()\n+        b.test().loadClass(I).throws_(IncompatibleClassChangeError.class).done()\n@@ -177,1 +177,1 @@\n-        b.test().loadClass(I).throws_(VerifyError.class).done()\n+        b.test().loadClass(I).throws_(IncompatibleClassChangeError.class).done()\n@@ -211,1 +211,1 @@\n-        b.test().loadClass(I).throws_(VerifyError.class).done()\n+        b.test().loadClass(I).throws_(IncompatibleClassChangeError.class).done()\n@@ -227,1 +227,1 @@\n-        b.test().loadClass(I).throws_(VerifyError.class).done()\n+        b.test().loadClass(I).throws_(IncompatibleClassChangeError.class).done()\n@@ -243,1 +243,1 @@\n-        b.test().loadClass(I).throws_(VerifyError.class).done()\n+        b.test().loadClass(I).throws_(IncompatibleClassChangeError.class).done()\n","filename":"test\/hotspot\/jtreg\/vmTestbase\/vm\/runtime\/defmeth\/ObjectMethodOverridesTest.java","additions":7,"deletions":7,"binary":false,"changes":14,"status":"modified"}]}