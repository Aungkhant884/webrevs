{"files":[{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2007, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2007, 2021, Oracle and\/or its affiliates. All rights reserved.\n@@ -28,1 +28,1 @@\n- * @run main\/manual=yesno LCDTextAndGraphicsState\n+ * @run main\/manual LCDTextAndGraphicsState\n@@ -30,2 +30,25 @@\n-import java.awt.*;\n-import java.awt.geom.*;\n+\n+import java.awt.BorderLayout;\n+import java.awt.Button;\n+import java.awt.Color;\n+import java.awt.Component;\n+import java.awt.Dimension;\n+import java.awt.Frame;\n+import java.awt.Graphics;\n+import java.awt.Graphics2D;\n+import java.awt.GridBagLayout;\n+import java.awt.GridBagConstraints;\n+import java.awt.RenderingHints;\n+import java.awt.AlphaComposite;\n+import java.awt.GradientPaint;\n+import java.awt.TextArea;\n+import java.awt.Shape;\n+import java.awt.Panel;\n+import java.awt.Insets;\n+\n+import java.awt.event.ActionEvent;\n+import java.awt.geom.RoundRectangle2D;\n+import java.awt.event.WindowAdapter;\n+import java.awt.event.WindowEvent;\n+import java.util.concurrent.CountDownLatch;\n+import java.util.concurrent.TimeUnit;\n@@ -35,1 +58,7 @@\n-    String text = \"This test passes only if this text appears SIX TIMES\";\n+    private static final Frame instructionFrame = new Frame();\n+    private static volatile boolean testResult = false;\n+    private static volatile CountDownLatch countDownLatch;\n+    private static String text = \"This test passes only if this text appears SIX TIMES\";\n+    private static final String INSTRUCTIONS = \"INSTRUCTIONS:\\n\\n\" +\n+            \"You should see the text \\' \" + text + \" \\' on the frame. \\n\" +\n+            \"If you see the same then test pass else test fail.\";\n@@ -38,2 +67,1 @@\n-\n-        Graphics2D g2d = (Graphics2D)g.create();\n+        Graphics2D g2d = (Graphics2D) g.create();\n@@ -41,1 +69,1 @@\n-        g2d.fillRect(0,0,getSize().width, getSize().height);\n+        g2d.fillRect(0, 0, getSize().width, getSize().height);\n@@ -43,1 +71,1 @@\n-        test1(g.create(0,   0, 500, 200));\n+        test1(g.create(0, 0, 500, 200));\n@@ -49,1 +77,1 @@\n-        Graphics2D g2d = (Graphics2D)g;\n+        Graphics2D g2d = (Graphics2D) g;\n@@ -51,1 +79,1 @@\n-                             RenderingHints.VALUE_TEXT_ANTIALIAS_LCD_HRGB);\n+                RenderingHints.VALUE_TEXT_ANTIALIAS_LCD_HRGB);\n@@ -55,1 +83,1 @@\n-                         AlphaComposite.SRC_OVER, 0.9f));\n+                AlphaComposite.SRC_OVER, 0.9f));\n@@ -60,1 +88,1 @@\n-        Graphics2D g2d = (Graphics2D)g;\n+        Graphics2D g2d = (Graphics2D) g;\n@@ -62,1 +90,1 @@\n-                             RenderingHints.VALUE_TEXT_ANTIALIAS_LCD_HRGB);\n+                RenderingHints.VALUE_TEXT_ANTIALIAS_LCD_HRGB);\n@@ -66,1 +94,1 @@\n-                     0f, 0f, Color.BLACK, 100f, 100f, Color.GRAY));\n+                0f, 0f, Color.BLACK, 100f, 100f, Color.GRAY));\n@@ -71,1 +99,1 @@\n-        Graphics2D g2d = (Graphics2D)g;\n+        Graphics2D g2d = (Graphics2D) g;\n@@ -73,1 +101,1 @@\n-                             RenderingHints.VALUE_TEXT_ANTIALIAS_LCD_HRGB);\n+                RenderingHints.VALUE_TEXT_ANTIALIAS_LCD_HRGB);\n@@ -82,1 +110,1 @@\n-        return new Dimension(500,600);\n+        return new Dimension(500, 600);\n@@ -85,1 +113,31 @@\n-    public static void main(String[] args) throws Exception {\n+    private static void createInstructionUI() {\n+        GridBagLayout layout = new GridBagLayout();\n+        Panel mainControlPanel = new Panel(layout);\n+        Panel resultButtonPanel = new Panel(layout);\n+        GridBagConstraints gbc = new GridBagConstraints();\n+        gbc.gridx = 0;\n+        gbc.gridy = 0;\n+        gbc.insets = new Insets(5, 15, 5, 15);\n+        gbc.fill = GridBagConstraints.HORIZONTAL;\n+\n+        TextArea instructionTextArea = new TextArea();\n+        instructionTextArea.setText(INSTRUCTIONS);\n+        instructionTextArea.setEditable(false);\n+        instructionTextArea.setBackground(Color.white);\n+        mainControlPanel.add(instructionTextArea, gbc);\n+\n+        Button passButton = new Button(\"Pass\");\n+        passButton.setActionCommand(\"Pass\");\n+        passButton.addActionListener((ActionEvent e) -> {\n+            testResult = true;\n+            countDownLatch.countDown();\n+        });\n+\n+        Button failButton = new Button(\"Fail\");\n+        failButton.setActionCommand(\"Fail\");\n+        failButton.addActionListener(e -> {\n+            countDownLatch.countDown();\n+        });\n+\n+        gbc.gridx = 0;\n+        gbc.gridy = 0;\n@@ -87,0 +145,24 @@\n+        resultButtonPanel.add(passButton, gbc);\n+\n+        gbc.gridx = 1;\n+        gbc.gridy = 0;\n+        resultButtonPanel.add(failButton, gbc);\n+\n+        gbc.gridx = 0;\n+        gbc.gridy = 2;\n+        mainControlPanel.add(resultButtonPanel, gbc);\n+\n+        instructionFrame.addWindowListener(new WindowAdapter() {\n+            @Override\n+            public void windowClosing(WindowEvent e) {\n+                super.windowClosing(e);\n+                countDownLatch.countDown();\n+            }\n+        });\n+        instructionFrame.pack();\n+        instructionFrame.add(mainControlPanel);\n+        instructionFrame.pack();\n+        instructionFrame.setVisible(true);\n+    }\n+\n+    public static void creatUI() {\n@@ -90,0 +172,1 @@\n+        f.setLocationRelativeTo(null);\n@@ -92,0 +175,12 @@\n+\n+    public static void main(String[] args) throws InterruptedException {\n+        countDownLatch = new CountDownLatch(1);\n+        createInstructionUI();\n+        creatUI();\n+        if (!countDownLatch.await(15, TimeUnit.MINUTES)) {\n+            throw new RuntimeException(\"Timeout : No action was performed on the test UI.\");\n+        }\n+        if (!testResult) {\n+            throw new RuntimeException(\"Test failed!\");\n+        }\n+    }\n","filename":"test\/jdk\/java\/awt\/Graphics\/LCDTextAndGraphicsState.java","additions":114,"deletions":19,"binary":false,"changes":133,"status":"modified"}]}