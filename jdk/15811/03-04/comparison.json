{"files":[{"patch":"@@ -988,1 +988,1 @@\n-void CodeCache::flush_unlinked_nmethods(bool do_unregister_nmethod) {\n+void CodeCache::flush_unlinked_nmethods(bool do_unregister_nmethods) {\n@@ -995,1 +995,1 @@\n-    nm->flush(do_unregister_nmethod);\n+    nm->flush(do_unregister_nmethods);\n@@ -1026,2 +1026,2 @@\n-CodeCache::UnloadingScope::UnloadingScope(BoolObjectClosure* is_alive)\n-  : _is_unloading_behaviour(is_alive)\n+CodeCache::UnloadingScope::UnloadingScope(BoolObjectClosure* is_alive, bool do_unregister_nmethods)\n+  : _is_unloading_behaviour(is_alive), _do_unregister_nmethods(do_unregister_nmethods)\n@@ -1038,1 +1038,1 @@\n-  CodeCache::flush_unlinked_nmethods();\n+  CodeCache::flush_unlinked_nmethods(_do_unregister_nmethods);\n","filename":"src\/hotspot\/share\/code\/codeCache.cpp","additions":5,"deletions":5,"binary":false,"changes":10,"status":"modified"},{"patch":"@@ -189,0 +189,1 @@\n+    bool                        _do_unregister_nmethods;\n@@ -191,1 +192,1 @@\n-    UnloadingScope(BoolObjectClosure* is_alive);\n+    UnloadingScope(BoolObjectClosure* is_alive, bool do_unregister_nmethods);\n@@ -216,1 +217,1 @@\n-  \/\/ do_unregister_nmethod controls whether CollectedHeap::unregister_nmethod is\n+  \/\/ do_unregister_nmethods controls whether CollectedHeap::unregister_nmethod is\n@@ -218,2 +219,2 @@\n-  \/\/ do an equivalent operation before calling this.\n-  static void flush_unlinked_nmethods(bool do_unregister_nmethod = true);\n+  \/\/ perform an equivalent operation at the appropriate time.\n+  static void flush_unlinked_nmethods(bool do_unregister_nmethods);\n","filename":"src\/hotspot\/share\/code\/codeCache.hpp","additions":5,"deletions":4,"binary":false,"changes":9,"status":"modified"},{"patch":"@@ -1697,1 +1697,1 @@\n-    CodeCache::UnloadingScope scope(&g1_is_alive);\n+    CodeCache::UnloadingScope scope(&g1_is_alive, false \/* do_unregister_nmethods *\/);\n","filename":"src\/hotspot\/share\/gc\/g1\/g1ConcurrentMark.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -322,1 +322,1 @@\n-    CodeCache::UnloadingScope unloading_scope(&_is_alive);\n+    CodeCache::UnloadingScope unloading_scope(&_is_alive, false \/* do_unregister_nmethods *\/);\n","filename":"src\/hotspot\/share\/gc\/g1\/g1FullCollector.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -2055,1 +2055,1 @@\n-    CodeCache::UnloadingScope scope(is_alive_closure());\n+    CodeCache::UnloadingScope scope(is_alive_closure(), true \/* do_unregister_nmethods *\/);\n","filename":"src\/hotspot\/share\/gc\/parallel\/psParallelCompact.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -202,1 +202,1 @@\n-    CodeCache::UnloadingScope scope(&is_alive);\n+    CodeCache::UnloadingScope scope(&is_alive, true \/* do_unregister_nmethods *\/);\n","filename":"src\/hotspot\/share\/gc\/serial\/genMarkSweep.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -302,1 +302,1 @@\n-  CodeCache::flush_unlinked_nmethods();\n+  CodeCache::flush_unlinked_nmethods(true \/* do_unregister_nmethods *\/);\n","filename":"src\/hotspot\/share\/gc\/shenandoah\/shenandoahCodeRoots.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -1814,1 +1814,1 @@\n-    CodeCache::UnloadingScope scope(is_alive.is_alive_closure());\n+    CodeCache::UnloadingScope scope(is_alive.is_alive_closure(), true \/* do_unregister_nmethods *\/);\n","filename":"src\/hotspot\/share\/gc\/shenandoah\/shenandoahHeap.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -365,1 +365,1 @@\n-  CodeCache::flush_unlinked_nmethods();\n+  CodeCache::flush_unlinked_nmethods(true \/* do_unregister_nmethods *\/);\n","filename":"src\/hotspot\/share\/gc\/x\/xNMethod.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -446,1 +446,1 @@\n-  CodeCache::flush_unlinked_nmethods();\n+  CodeCache::flush_unlinked_nmethods(true \/* do_unregister_nmethods *\/);\n","filename":"src\/hotspot\/share\/gc\/z\/zNMethod.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"}]}