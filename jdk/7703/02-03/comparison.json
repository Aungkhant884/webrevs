{"files":[{"patch":"@@ -180,0 +180,14 @@\n+        \/\/ Copy cache to avoid race.\n+        DecimalFormatSymbols dfsyms = cache;\n+         \/\/ Use cached value if same locale.\n+        if (dfsyms != null && dfsyms.locale.equals(locale)) {\n+            return dfsyms;\n+        }\n+        \/\/ Fetch DecimalFormatSymbols from provider.\n+        dfsyms = getInstanceFromProvider(locale);\n+        \/\/ Update cache. Race collisions are benign.\n+        cache = dfsyms;\n+        return dfsyms;\n+    }\n+\n+    private static final DecimalFormatSymbols getInstanceFromProvider(Locale locale) {\n@@ -191,0 +205,3 @@\n+    \/\/ Cache most recent use. Deliberately non-volatile heuristic.\n+    private static DecimalFormatSymbols cache = null;\n+\n@@ -192,3 +209,1 @@\n-     * Gets the locale used to create this instance.\n-     *\n-     * @return locale used to create this instance\n+     * {@return locale used to create this instance}\n","filename":"src\/java.base\/share\/classes\/java\/text\/DecimalFormatSymbols.java","additions":18,"deletions":3,"binary":false,"changes":21,"status":"modified"},{"patch":"@@ -2011,10 +2011,3 @@\n-    \/\/ Caching DecimalFormatSymbols\n-    static DecimalFormatSymbols DFS = null;\n-    static DecimalFormatSymbols getDecimalFormatSymbols(Locale locale) {\n-        DecimalFormatSymbols dfs = DFS;\n-        if (dfs != null && dfs.getLocale().equals(locale)) {\n-            return dfs;\n-        }\n-        dfs = DecimalFormatSymbols.getInstance(locale);\n-        DFS = dfs;\n-        return dfs;\n+    \/\/ Caching DecimalFormatSymbols. Non-volatile to avoid thread slamming.\n+    private static DecimalFormatSymbols getDecimalFormatSymbols(Locale locale) {\n+        return DecimalFormatSymbols.getInstance(locale);\n@@ -2023,2 +2016,2 @@\n-    \/\/ Caching zero.\n-    static char getZero(Locale locale) {\n+    \/\/ Use zero from cached DecimalFormatSymbols.\n+    private static char getZero(Locale locale) {\n@@ -2028,2 +2021,2 @@\n-    \/\/ Caching decimal separator.\n-    static char getDecimalSeparator(Locale locale) {\n+    \/\/ Use decimal separator from cached DecimalFormatSymbols.\n+    private static char getDecimalSeparator(Locale locale) {\n@@ -2033,2 +2026,2 @@\n-    \/\/ Caching grouping separator.\n-    static char getGroupingSeparator(Locale locale) {\n+    \/\/ Use grouping separator from cached DecimalFormatSymbols.\n+    private static char getGroupingSeparator(Locale locale) {\n","filename":"src\/java.base\/share\/classes\/java\/util\/Formatter.java","additions":9,"deletions":16,"binary":false,"changes":25,"status":"modified"}]}