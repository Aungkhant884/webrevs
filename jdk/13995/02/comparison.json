{"files":[{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2008, 2021, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2008, 2023, Oracle and\/or its affiliates. All rights reserved.\n@@ -245,5 +245,32 @@\n-  strcpy(buf, close);\n-  char* p = buf;\n-  if (type)    sprintf(p += strlen(p), \" type='%s'\", type);\n-  if (dsize)   sprintf(p += strlen(p), \" dsize='%d'\", dsize);\n-  if (delays)  sprintf(p += strlen(p), \" delay='%d'\", delays);\n+  size_t used_size = snprintf(buf, bufsize, \"%s\", close);\n+  if ((used_size < 0) || (used_size >= bufsize)) {\n+    return close;\n+  }\n+  char* p = buf + used_size;\n+  bufsize -= used_size;\n+\n+  if (type) {\n+    used_size = snprintf(p, bufsize, \" type='%s'\", type);\n+    if ((used_size < 0) || (used_size >= bufsize)) {\n+      return close;\n+    }\n+    p += used_size;\n+    bufsize -= used_size;\n+  }\n+\n+  if (dsize) {\n+    used_size = snprintf(p, bufsize, \" dsize='%d'\", dsize);\n+    if ((used_size < 0) || (used_size >= bufsize)) {\n+      return close;\n+    }\n+    p += used_size;\n+    bufsize -= used_size;\n+  }\n+\n+  if (delays) {\n+    used_size = snprintf(p, bufsize, \" delay='%d'\", delays);\n+    if ((used_size < 0) || (used_size >= bufsize)) {\n+      return close;\n+    }\n+  }\n+\n","filename":"src\/utils\/hsdis\/binutils\/hsdis-binutils.c","additions":33,"deletions":6,"binary":false,"changes":39,"status":"modified"}]}