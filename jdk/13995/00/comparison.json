{"files":[{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2008, 2021, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2008, 2023, Oracle and\/or its affiliates. All rights reserved.\n@@ -246,4 +246,21 @@\n-  char* p = buf;\n-  if (type)    sprintf(p += strlen(p), \" type='%s'\", type);\n-  if (dsize)   sprintf(p += strlen(p), \" dsize='%d'\", dsize);\n-  if (delays)  sprintf(p += strlen(p), \" delay='%d'\", delays);\n+  size_t used_size = strlen(close);\n+  char* p = buf + used_size;\n+  bufsize -= used_size;\n+  if (type) {\n+    \/* the buf capacity has been checked previously *\/\n+    used_size = snprintf(p, bufsize, \" type='%s'\", type);\n+    p += used_size;\n+    bufsize -= used_size;\n+  }\n+\n+  if (dsize) {\n+    \/* the buf capacity has been checked previously *\/\n+    used_size = snprintf(p, bufsize, \" dsize='%d'\", dsize);\n+    p += used_size;\n+    bufsize -= used_size;\n+  }\n+\n+  if (delays) {\n+    snprintf(p, bufsize, \" delay='%d'\", delays);\n+  }\n+\n","filename":"src\/utils\/hsdis\/binutils\/hsdis-binutils.c","additions":22,"deletions":5,"binary":false,"changes":27,"status":"modified"}]}