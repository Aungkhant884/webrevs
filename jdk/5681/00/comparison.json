{"files":[{"patch":"@@ -751,1 +751,1 @@\n-    _lock = new (std::nothrow) PaddedMonitor(Mutex::leaf, \"Parallel HProf writer lock\", Mutex::_safepoint_check_never);\n+    _lock = new (std::nothrow) PaddedMonitor(Mutex::leaf, \"ParallelHProfWriter_lock\", Mutex::_safepoint_check_always);\n@@ -1817,2 +1817,2 @@\n-     _lock(new (std::nothrow) PaddedMonitor(Mutex::leaf, \"Dumper Controller lock\",\n-    Mutex::_safepoint_check_never)),\n+     _lock(new (std::nothrow) PaddedMonitor(Mutex::leaf, \"DumperController_lock\",\n+    Mutex::_safepoint_check_always)),\n@@ -1913,2 +1913,0 @@\n-    \/\/ Number of dumper threads that only iterate heap.\n-    uint _heap_only_dumper_threads = _num_dumper_threads - 1 \/* VMDumper thread *\/;\n@@ -1918,0 +1916,2 @@\n+      \/\/ Number of dumper threads that only iterate heap.\n+      uint _heap_only_dumper_threads = _num_dumper_threads - 1 \/* VMDumper thread *\/;\n@@ -2255,0 +2255,3 @@\n+    \/\/ Use serial dump, set dumper threads and writer threads number to 1.\n+    _num_dumper_threads=1;\n+    _num_writer_threads=1;\n@@ -2308,16 +2311,0 @@\n-\n-    \/\/ HPROF_GC_ROOT_THREAD_OBJ + frames + jni locals\n-    do_threads();\n-\n-    \/\/ HPROF_GC_ROOT_JNI_GLOBAL\n-    JNIGlobalsDumper jni_dumper(writer());\n-    JNIHandles::oops_do(&jni_dumper);\n-    \/\/ technically not jni roots, but global roots\n-    \/\/ for things like preallocated throwable backtraces\n-    Universe::vm_global()->oops_do(&jni_dumper);\n-\n-    \/\/ HPROF_GC_ROOT_STICKY_CLASS\n-    \/\/ These should be classes in the NULL class loader data, and not all classes\n-    \/\/ if !ClassUnloading\n-    StickyClassDumper class_dumper(writer());\n-    ClassLoaderData::the_null_class_loader_data()->classes_do(&class_dumper);\n@@ -2325,0 +2312,1 @@\n+\n@@ -2356,1 +2344,0 @@\n-\n@@ -2359,1 +2346,0 @@\n-\n@@ -2369,0 +2355,16 @@\n+  \/\/ HPROF_GC_ROOT_THREAD_OBJ + frames + jni locals\n+  do_threads();\n+\n+  \/\/ HPROF_GC_ROOT_JNI_GLOBAL\n+  JNIGlobalsDumper jni_dumper(writer());\n+  JNIHandles::oops_do(&jni_dumper);\n+  \/\/ technically not jni roots, but global roots\n+  \/\/ for things like preallocated throwable backtraces\n+  Universe::vm_global()->oops_do(&jni_dumper);\n+\n+  \/\/ HPROF_GC_ROOT_STICKY_CLASS\n+  \/\/ These should be classes in the NULL class loader data, and not all classes\n+  \/\/ if !ClassUnloading\n+  StickyClassDumper class_dumper(writer());\n+  ClassLoaderData::the_null_class_loader_data()->classes_do(&class_dumper);\n+\n","filename":"src\/hotspot\/share\/services\/heapDumper.cpp","additions":25,"deletions":23,"binary":false,"changes":48,"status":"modified"},{"patch":"@@ -47,3 +47,0 @@\n-\n-serviceability\/dcmd\/gc\/HeapDumpAllTest.java                   8274196   linux-all,windows-all\n-serviceability\/dcmd\/gc\/HeapDumpTest.java                      8274196   linux-all,windows-all\n","filename":"test\/hotspot\/jtreg\/ProblemList-zgc.txt","additions":0,"deletions":3,"binary":false,"changes":3,"status":"modified"}]}