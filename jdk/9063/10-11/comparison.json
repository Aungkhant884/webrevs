{"files":[{"patch":"@@ -285,0 +285,47 @@\n+\n+  # Remove bundles so they are not misconstrued as binary distributions from the JDK project\n+  remove-bundles:\n+    name: 'Remove bundle artifacts'\n+    runs-on: ubuntu-20.04\n+    if: always()\n+    needs:\n+      - build-linux-x64\n+      - build-linux-x86\n+      - build-linux-x64-hs-nopch\n+      - build-linux-x64-hs-zero\n+      - build-linux-x64-hs-minimal\n+      - build-linux-x64-hs-optimized\n+      - build-linux-cross-compile\n+      - build-macos-x64\n+      - build-macos-aarch64\n+      - build-windows-x64\n+      - build-windows-aarch64\n+      - test-linux-x64\n+      - test-linux-x86\n+      - test-macos-x64\n+      - test-windows-x64\n+\n+    steps:\n+        # Hack to get hold of the api environment variables that are only defined for actions\n+      - name: 'Get API configuration'\n+        id: api\n+        uses: actions\/github-script@v6\n+        with:\n+          script: 'return { url: process.env[\"ACTIONS_RUNTIME_URL\"], token: process.env[\"ACTIONS_RUNTIME_TOKEN\"] }'\n+\n+      - name: 'Remove bundle artifacts'\n+        run: |\n+          # Find and remove all bundle artifacts\n+          ALL_ARTIFACT_URLS=\"$(curl -s \\\n+              -H 'Accept: application\/json;api-version=6.0-preview' \\\n+              -H 'Authorization: Bearer ${{ fromJson(steps.api.outputs.result).token }}' \\\n+              '${{ fromJson(steps.api.outputs.result).url }}_apis\/pipelines\/workflows\/${{ github.run_id }}\/artifacts?api-version=6.0-preview')\"\n+          BUNDLE_ARTIFACT_URLS=\"$(echo \"$ALL_ARTIFACT_URLS\" | jq -r -c '.value | map(select(.name|startswith(\"bundles-\"))) | .[].url')\"\n+          for url in $BUNDLE_ARTIFACT_URLS; do\n+            echo \"Removing $url\"\n+            curl -s \\\n+                -H 'Accept: application\/json;api-version=6.0-preview' \\\n+                -H 'Authorization: Bearer ${{ fromJson(steps.api.outputs.result).token }}' \\\n+                -X DELETE \"$url\" \\\n+            || echo \"Failed to remove bundle\"\n+          done\n","filename":".github\/workflows\/main.yml","additions":47,"deletions":0,"binary":false,"changes":47,"status":"modified"}]}