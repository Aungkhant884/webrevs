{"files":[{"patch":"@@ -1052,0 +1052,4 @@\n+  if (*p == '[') {\n+    \/\/ Disallow array classes\n+    return NULL;\n+  }\n@@ -1053,0 +1057,4 @@\n+    if (*p == '\/') {\n+      \/\/ Disallow slashes in input\n+      return NULL;\n+    }\n","filename":"src\/hotspot\/share\/prims\/jvm.cpp","additions":8,"deletions":0,"binary":false,"changes":8,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2013, 2020, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2013, 2021, Oracle and\/or its affiliates. All rights reserved.\n@@ -1258,2 +1258,0 @@\n-        if (!checkName(name)) return null;\n-\n@@ -1281,2 +1279,0 @@\n-        if (!checkName(name))\n-            return null;\n","filename":"src\/java.base\/share\/classes\/java\/lang\/ClassLoader.java","additions":1,"deletions":5,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 1996, 2020, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 1996, 2021, Oracle and\/or its affiliates. All rights reserved.\n@@ -293,3 +293,6 @@\n-    fixClassname(clname);\n-\n-    if (!verifyClassname(clname, JNI_TRUE)) {  \/* expects slashed name *\/\n+    \/\/ disallow slashes in input, change '.' to '\/'\n+    if (verifyFixClassname(clname)) {\n+        goto done;\n+    }\n+    \/\/ expect slashed name, disallow array names\n+    if (!verifyClassname(clname, JNI_FALSE)) {\n","filename":"src\/java.base\/share\/native\/libjava\/ClassLoader.c","additions":7,"deletions":4,"binary":false,"changes":11,"status":"modified"}]}