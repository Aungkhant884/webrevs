{"files":[{"patch":"@@ -500,1 +500,0 @@\n-java\/awt\/FullScreen\/NoResizeEventOnDMChangeTest\/NoResizeEventOnDMChangeTest.java 8169468 macosx-all\n","filename":"test\/jdk\/ProblemList.txt","additions":0,"deletions":1,"binary":false,"changes":1,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2007, 2016, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2007, 2021, Oracle and\/or its affiliates. All rights reserved.\n@@ -29,1 +29,0 @@\n- * @author Dmitri.Trembovetski@sun.com: area=Graphics\n@@ -43,0 +42,2 @@\n+import java.awt.Point;\n+import java.awt.Rectangle;\n@@ -48,0 +49,1 @@\n+import java.util.concurrent.atomic.AtomicBoolean;\n@@ -154,0 +156,2 @@\n+                                Frame f = fsWin instanceof Frame ? (Frame) fsWin : (Frame) fsWin.getOwner();\n+                                DisplayMode oldMode = f.getGraphicsConfiguration().getDevice().getDisplayMode();\n@@ -155,2 +159,12 @@\n-                                r1.incDmChanges();\n-                                r2.incDmChanges();\n+                                \/\/ Check if setting new display mode actually results in frame being\n+                                \/\/ placed onto display with different resolution.\n+                                DisplayMode newMode = f.getGraphicsConfiguration().getDevice().getDisplayMode();\n+                                if (oldMode.getWidth() != newMode.getWidth()\n+                                        || oldMode.getHeight() != newMode.getHeight()) {\n+                                    r1.incDmChanges();\n+                                    r2.incDmChanges();\n+                                } else {\n+                                    System.out.println(\"Skipping this iteration. Details:\");\n+                                    System.out.println(\"Requested device = \" + gd);\n+                                    System.out.println(\"Actual device = \" + f.getGraphicsConfiguration().getDevice());\n+                                }\n@@ -169,0 +183,1 @@\n+\n@@ -194,3 +209,6 @@\n-        try {\n-            Thread.sleep(ms);\n-        } catch (InterruptedException ex) {}\n+        long targetTime = System.currentTimeMillis() + ms;\n+        do {\n+            try {\n+                Thread.sleep(targetTime - System.currentTimeMillis());\n+            } catch (InterruptedException ex) {}\n+        } while (System.currentTimeMillis() < targetTime);\n@@ -198,0 +216,1 @@\n+\n","filename":"test\/jdk\/java\/awt\/FullScreen\/NoResizeEventOnDMChangeTest\/NoResizeEventOnDMChangeTest.java","additions":26,"deletions":7,"binary":false,"changes":33,"status":"modified"}]}