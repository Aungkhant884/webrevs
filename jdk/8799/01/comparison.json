{"files":[{"patch":"@@ -412,0 +412,19 @@\n+    \/\/ Helper method for calling FileChannel.transferFrom and checking the\n+    \/\/ return value.\n+    private static void transferFrom(FileChannel inputChannel,\n+                                     FileChannel outputChannel,\n+                                     long offset,\n+                                     long length) throws Exception {\n+        long position = offset;\n+        long count = length;\n+        while (count > 0 && inputChannel.position() < inputChannel.size()) {\n+            long n = outputChannel.transferFrom(inputChannel, position, count);\n+            if (n < 0 || n > count) {\n+                throw new RuntimeException(\"Incorrect transfer length n = \" + n\n+                                           + \" (expected 0 <= n <= \" + length + \")\");\n+            }\n+            position += n;\n+            count -= n;\n+        }\n+    }\n+\n@@ -419,1 +438,1 @@\n-            outputChannel.transferFrom(inputChannel, 0, offset);\n+            transferFrom(inputChannel, outputChannel, 0, offset);\n@@ -422,1 +441,1 @@\n-            outputChannel.transferFrom(inputChannel, offset + bytes.length, orgSize - bytes.length);\n+            transferFrom(inputChannel, outputChannel, offset + bytes.length, orgSize - bytes.length);\n@@ -434,1 +453,1 @@\n-            outputChannel.transferFrom(inputChannel, 0, offset);\n+            transferFrom(inputChannel, outputChannel, 0, offset);\n@@ -436,1 +455,1 @@\n-            outputChannel.transferFrom(inputChannel, offset, orgSize - nBytes);\n+            transferFrom(inputChannel, outputChannel, offset, orgSize - nBytes);\n","filename":"test\/lib\/jdk\/test\/lib\/cds\/CDSArchiveUtils.java","additions":23,"deletions":4,"binary":false,"changes":27,"status":"modified"}]}