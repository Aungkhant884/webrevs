{"files":[{"patch":"@@ -209,20 +209,15 @@\n-        try {\n-            AlgorithmParameterSpec keyParams = rsaKey.getParams();\n-            \/\/ validate key parameters\n-            if (!isCompatible(rsaKey.getParams(), this.sigParams)) {\n-                throw new InvalidKeyException\n-                    (\"Key contains incompatible PSS parameter values\");\n-            }\n-            \/\/ validate key length\n-            if (this.sigParams != null) {\n-                String digestAlgo = this.sigParams.getDigestAlgorithm();\n-                KnownOIDs ko = KnownOIDs.findMatch(digestAlgo);\n-                if (ko != null) {\n-                    Integer hLen = DIGEST_LENGTHS.get(ko);\n-                    if (hLen != null) {\n-                        checkKeyLength(rsaKey, hLen,\n-                                this.sigParams.getSaltLength());\n-                    } else {\n-                        throw new ProviderException\n-                                (\"Unsupported digest algo: \" + digestAlgo);\n-                    }\n+        AlgorithmParameterSpec keyParams = rsaKey.getParams();\n+        \/\/ validate key parameters\n+        if (!isCompatible(rsaKey.getParams(), this.sigParams)) {\n+            throw new InvalidKeyException\n+                (\"Key contains incompatible PSS parameter values\");\n+        }\n+        \/\/ validate key length\n+        if (this.sigParams != null) {\n+            String digestAlgo = this.sigParams.getDigestAlgorithm();\n+            KnownOIDs ko = KnownOIDs.findMatch(digestAlgo);\n+            if (ko != null) {\n+                Integer hLen = DIGEST_LENGTHS.get(ko);\n+                if (hLen != null) {\n+                    checkKeyLength(rsaKey, hLen,\n+                            this.sigParams.getSaltLength());\n@@ -230,0 +225,1 @@\n+                    \/\/ should never happen; checked in validateSigParams()\n@@ -231,1 +227,1 @@\n-                            (\"Unrecognized digest algo: \" + digestAlgo);\n+                            (\"Unsupported digest algo: \" + digestAlgo);\n@@ -233,0 +229,4 @@\n+            } else {\n+                \/\/ should never happen; checked in validateSigParams()\n+                throw new ProviderException\n+                        (\"Unrecognized digest algo: \" + digestAlgo);\n@@ -234,3 +234,0 @@\n-            return rsaKey;\n-        } catch (SignatureException e) {\n-            throw new InvalidKeyException(e);\n@@ -238,0 +235,1 @@\n+        return rsaKey;\n@@ -275,1 +273,1 @@\n-        String digestAlgo = params.getDigestAlgorithm();\n+\n@@ -278,5 +276,17 @@\n-            try {\n-                int hLen = DIGEST_LENGTHS.get(KnownOIDs.findMatch(digestAlgo));\n-                checkKeyLength(key, hLen, params.getSaltLength());\n-            } catch (SignatureException e) {\n-                throw new InvalidAlgorithmParameterException(e);\n+            String digestAlgo = params.getDigestAlgorithm();\n+            KnownOIDs ko = KnownOIDs.findMatch(digestAlgo);\n+            if (ko != null) {\n+                Integer hLen = DIGEST_LENGTHS.get(ko);\n+                if (hLen != null) {\n+                    try {\n+                        checkKeyLength(key, hLen, params.getSaltLength());\n+                    } catch (InvalidKeyException e) {\n+                        throw new InvalidAlgorithmParameterException(e);\n+                    }\n+                } else {\n+                    throw new InvalidAlgorithmParameterException\n+                            (\"Unsupported digest algo: \" + digestAlgo);\n+                }\n+            } else {\n+                throw new InvalidAlgorithmParameterException\n+                        (\"Unrecognized digest algo: \" + digestAlgo);\n@@ -309,1 +319,1 @@\n-            int saltLen) throws SignatureException {\n+            int saltLen) throws InvalidKeyException {\n@@ -314,1 +324,1 @@\n-                throw new SignatureException\n+                throw new InvalidKeyException\n","filename":"src\/java.base\/share\/classes\/sun\/security\/rsa\/RSAPSSSignature.java","additions":42,"deletions":32,"binary":false,"changes":74,"status":"modified"}]}