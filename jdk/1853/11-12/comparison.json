{"files":[{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2000, 2021, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2000, 2019, Oracle and\/or its affiliates. All rights reserved.\n@@ -29,0 +29,1 @@\n+import java.io.ByteArrayOutputStream;\n@@ -187,1 +188,1 @@\n-            DerInputStream dis = new DerInputStream(is.readAllBytes());\n+            DerInputStream dis = new DerInputStream(readAllBytes(is));\n@@ -227,1 +228,6 @@\n-            PKCS7 pkcs7 = new PKCS7(is.readAllBytes());\n+            if (is.markSupported() == false) {\n+                \/\/ Copy the entire input stream into an InputStream that does\n+                \/\/ support mark\n+                is = new ByteArrayInputStream(readAllBytes(is));\n+            }\n+            PKCS7 pkcs7 = new PKCS7(is);\n@@ -248,0 +254,16 @@\n+    \/*\n+     * Reads the entire contents of an InputStream into a byte array.\n+     *\n+     * @param is the InputStream to read from\n+     * @return the bytes read from the InputStream\n+     *\/\n+    private static byte[] readAllBytes(InputStream is) throws IOException {\n+        byte[] buffer = new byte[8192];\n+        ByteArrayOutputStream baos = new ByteArrayOutputStream(2048);\n+        int n;\n+        while ((n = is.read(buffer)) != -1) {\n+            baos.write(buffer, 0, n);\n+        }\n+        return baos.toByteArray();\n+    }\n+\n","filename":"src\/java.base\/share\/classes\/sun\/security\/provider\/certpath\/X509CertPath.java","additions":25,"deletions":3,"binary":false,"changes":28,"status":"modified"}]}