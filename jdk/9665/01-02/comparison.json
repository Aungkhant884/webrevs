{"files":[{"patch":"@@ -359,4 +359,7 @@\n-        int length = 0;\n-        boolean prefixClassLoader = false;\n-        boolean prefixModule = false;\n-        boolean prefixModuleVersion = false;\n+        int estimatedLength = Objects.requireNonNullElse(classLoaderName, \"\").length() + 1\n+                + Objects.requireNonNullElse(moduleName, \"\").length() + 1\n+                + Objects.requireNonNullElse(moduleVersion, \"\").length() + 1\n+                + declaringClass.length() + 1\n+                + methodName.length() + 1\n+                + Math.max(\"Unknown Source\".length(), Objects.requireNonNullElse(fileName, \"\").length()) + 1\n+                + Integer.stringSize(lineNumber) + 1;\n@@ -364,0 +367,1 @@\n+        StringBuilder sb = new StringBuilder(estimatedLength);\n@@ -365,2 +369,1 @@\n-            prefixClassLoader = true;\n-            length += classLoaderName.length() + 1;\n+            sb.append(classLoaderName).append('\/');\n@@ -370,2 +373,1 @@\n-            prefixModule = true;\n-            length += moduleName.length();\n+            sb.append(moduleName);\n@@ -373,14 +375,1 @@\n-                prefixModuleVersion = true;\n-                length += 1 + moduleVersion.length();\n-            }\n-        }\n-\n-        length += declaringClass.length() + methodName.length() + 2;\n-        if (isNativeMethod()) {\n-            length += \"Native Method\".length();\n-        } else if (fileName == null) {\n-            length += \"Unknown Source\".length();\n-        } else {\n-            length += fileName.length() + 1;\n-            if (lineNumber >= 0) {\n-                length += Integer.stringSize(lineNumber);\n+                sb.append('@').append(moduleVersion);\n@@ -389,1 +378,0 @@\n-        length++;\n@@ -391,9 +379,1 @@\n-        StringBuilder sb = new StringBuilder(length);\n-        if (prefixClassLoader) {\n-            sb.append(classLoaderName).append('\/');\n-        }\n-        if (prefixModule) {\n-            sb.append(moduleName);\n-            if (prefixModuleVersion) {\n-                sb.append('@').append(moduleVersion);\n-            }\n+        if (sb.length() > 0) {\n","filename":"src\/java.base\/share\/classes\/java\/lang\/StackTraceElement.java","additions":12,"deletions":32,"binary":false,"changes":44,"status":"modified"}]}