{"files":[{"patch":"@@ -1840,8 +1840,4 @@\n-            String[] weakAlgs = new String[] {\"DES\", \"DESEDE\", \"MD5\", \"SHA1\", \"RC2\", \"RC4\"};\n-            boolean isWeak = Arrays.stream(weakAlgs).anyMatch(\n-                    keyAlgName.toUpperCase(Locale.ENGLISH)::contains);\n-            if (isWeak) {\n-                weakWarnings.add(String.format(\n-                        rb.getString(\"key.algorithm.weak\"),\n-                        rb.getString(\"the.generated.secretkey\"), keyAlgName));\n-            }\n+            SecretKeyConstraintsParameters skcp =\n+                    new SecretKeyConstraintsParameters(secKey);\n+            checkWeakConstraint(rb.getString(\"the.generated.secretkey\"),\n+                    keyAlgName, skcp);\n@@ -5080,0 +5076,10 @@\n+    private void checkWeakConstraint(String label, String keyAlg,\n+            SecretKeyConstraintsParameters skcp) {\n+        try {\n+            LEGACY_CHECK.permits(keyAlg, skcp, false);\n+        } catch (CertPathValidatorException e) {\n+            weakWarnings.add(String.format(\n+                    rb.getString(\"key.algorithm.weak\"), label, keyAlg));\n+        }\n+    }\n+\n","filename":"src\/java.base\/share\/classes\/sun\/security\/tools\/keytool\/Main.java","additions":14,"deletions":8,"binary":false,"changes":22,"status":"modified"}]}