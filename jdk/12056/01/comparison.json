{"files":[{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 1997, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 1997, 2023, Oracle and\/or its affiliates. All rights reserved.\n@@ -1840,0 +1840,5 @@\n+            SecretKeyConstraintsParameters skcp =\n+                    new SecretKeyConstraintsParameters(secKey);\n+            checkWeakConstraint(rb.getString(\"the.generated.secretkey\"),\n+                    keyAlgName, skcp);\n+\n@@ -5071,0 +5076,10 @@\n+    private void checkWeakConstraint(String label, String keyAlg,\n+            SecretKeyConstraintsParameters skcp) {\n+        try {\n+            LEGACY_CHECK.permits(keyAlg, skcp, false);\n+        } catch (CertPathValidatorException e) {\n+            weakWarnings.add(String.format(\n+                    rb.getString(\"key.algorithm.weak\"), label, keyAlg));\n+        }\n+    }\n+\n","filename":"src\/java.base\/share\/classes\/sun\/security\/tools\/keytool\/Main.java","additions":16,"deletions":1,"binary":false,"changes":17,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2023, Oracle and\/or its affiliates. All rights reserved.\n@@ -26,1 +26,1 @@\n- * @bug 8255552 8286090\n+ * @bug 8255552 8286090 8286907\n@@ -111,0 +111,19 @@\n+\n+        SecurityTools.keytool(\"-keystore ks.p12 -storepass changeit \" +\n+                \"-genseckey -keyalg PBEWithMD5AndDES -alias pbekey1\")\n+                .shouldContain(\"Warning\")\n+                .shouldMatch(\"The generated secret key uses the PBEWithMD5AndDES algorithm.*considered a security risk\")\n+                .shouldHaveExitValue(0);\n+\n+        SecurityTools.keytool(\"-keystore ks.p12 -storepass changeit \" +\n+                \"-genseckey -keyalg PBEWithSHA1AndDESede -alias pbekey2\")\n+                .shouldContain(\"Warning\")\n+                .shouldMatch(\"The generated secret key uses the PBEWithSHA1AndDESede algorithm.*considered a security risk\")\n+                .shouldHaveExitValue(0);\n+\n+        SecurityTools.setResponse(\"changeit\", \"changeit\");\n+        SecurityTools.keytool(\"-keystore ks.p12 -storepass changeit \" +\n+                \"-importpass -keyalg PBEWithMD5AndDES -alias newentry\")\n+                .shouldContain(\"Warning\")\n+                .shouldMatch(\"The generated secret key uses the PBEWithMD5AndDES algorithm.*considered a security risk\")\n+                .shouldHaveExitValue(0);\n","filename":"test\/jdk\/sun\/security\/tools\/keytool\/WeakSecretKeyTest.java","additions":21,"deletions":2,"binary":false,"changes":23,"status":"modified"}]}