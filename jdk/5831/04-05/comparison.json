{"files":[{"patch":"@@ -182,0 +182,3 @@\n+\/\/\n+\/\/ Returns the Darwin version or -1 if it is indeterminate\n+\/\/\n@@ -187,8 +190,9 @@\n-    int version_number = -1;\n-    char major_version[_SYS_NAMELEN];\n-    char *dot = strchr(name.release, '.');\n-    if (dot != NULL) {\n-        size_t len = dot - name.release;\n-        strncpy(major_version, name.release, len);\n-        major_version[len]= '\\0';\n-        version_number = atoi(major_version);\n+    char *dotp = strchr(name.release, '.');\n+    if (dotp != NULL) {\n+        size_t len = dotp - name.release;\n+        if (len > 0) {\n+            char major_version[_SYS_NAMELEN];\n+            strncpy(major_version, name.release, len);\n+            major_version[len]= '\\0';\n+            return atoi(major_version);\n+        }\n@@ -197,1 +201,1 @@\n-    return version_number;\n+    return -1;\n@@ -212,1 +216,5 @@\n-    if (get_darwin_version() >= 20)\n+    int darwin_version = get_darwin_version();\n+\n+    \/\/ Return a conservative value if the Darwin version is either\n+    \/\/ indeterminate or at least 20.\n+    if (darwin_version < 0 || darwin_version >= 20)\n","filename":"src\/java.base\/unix\/native\/libnio\/ch\/IOUtil.c","additions":18,"deletions":10,"binary":false,"changes":28,"status":"modified"}]}