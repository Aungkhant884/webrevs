{"files":[{"patch":"@@ -155,0 +155,7 @@\n+    \/**\n+     * The maximum size of array to allocate.\n+     * Some VMs reserve some header words in an array.\n+     * Attempts to allocate larger arrays may result in\n+     * OutOfMemoryError: Required array size too large\n+     *\/\n+    private static final int MAX_BUFFER_SIZE = Integer.MAX_VALUE - 8;\n@@ -791,1 +798,4 @@\n-            int len = (int)ze.getSize();\n+            long len = ze.getSize();\n+            if (len > MAX_BUFFER_SIZE) {\n+                throw new OutOfMemoryError(\"Required array size too large\");\n+            }\n@@ -794,6 +804,4 @@\n-            if (len == 0) {\n-                b = new byte[0];\n-                bytesRead = 0;\n-            } else if (len > 0 && len <= 65535) { \/\/ trust specified entry sizes when reasonably small\n-                b = new byte[len];\n-                bytesRead = is.readNBytes(b, 0, len);\n+            \/\/ trust specified entry sizes when reasonably small\n+            if (len >= 0 && len <= 65535) {\n+                b = new byte[(int) len];\n+                bytesRead = is.readNBytes(b, 0, (int) len);\n","filename":"src\/java.base\/share\/classes\/java\/util\/jar\/JarFile.java","additions":15,"deletions":7,"binary":false,"changes":22,"status":"modified"}]}