{"files":[{"patch":"@@ -455,1 +455,2 @@\n-  } else if (strcmp(UseBranchProtection, \"standard\") == 0) {\n+  } else if (strcmp(UseBranchProtection, \"standard\") == 0 ||\n+             strcmp(UseBranchProtection, \"pac-ret\") == 0) {\n@@ -457,9 +458,4 @@\n-    \/\/ Enable PAC if this code has been built with branch-protection, the CPU\/OS\n-    \/\/ supports it, and incompatible preview features aren't enabled.\n-#ifdef __ARM_FEATURE_PAC_DEFAULT\n-    if (VM_Version::supports_paca() && !Arguments::enable_preview()) {\n-      _rop_protection = true;\n-    }\n-#endif\n-  } else if (strcmp(UseBranchProtection, \"pac-ret\") == 0) {\n-    _rop_protection = true;\n+    \/\/ Enable ROP-protection if\n+    \/\/ 1) this code has been built with branch-protection,\n+    \/\/ 2) the CPU\/OS supports it, and\n+    \/\/ 3) incompatible virtual threads feature isn't enabled.\n@@ -468,1 +464,0 @@\n-      warning(\"ROP-protection specified, but not supported on this CPU.\");\n@@ -470,2 +465,2 @@\n-      _rop_protection = false;\n-    } else if (Arguments::enable_preview()) {\n+      warning(\"ROP-protection specified, but not supported on this CPU. Disabling ROP-protection.\");\n+    } else if (VMContinuations) {\n@@ -473,2 +468,3 @@\n-      warning(\"PAC-RET is incompatible with virtual threads preview feature.\");\n-      _rop_protection = false;\n+      warning(\"ROP-protection is incompatible with virtual threads feature. Disabling ROP-protection.\");\n+    } else {\n+      _rop_protection = true;\n@@ -477,1 +473,1 @@\n-    warning(\"ROP-protection specified, but this VM was built without ROP-protection support.\");\n+    warning(\"ROP-protection specified, but this VM was built without ROP-protection support. Disabling ROP-protection.\");\n","filename":"src\/hotspot\/cpu\/aarch64\/vm_version_aarch64.cpp","additions":12,"deletions":16,"binary":false,"changes":28,"status":"modified"}]}