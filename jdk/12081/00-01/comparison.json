{"files":[{"patch":"@@ -176,3 +176,4 @@\n-        boolean found = false;\n-        while (listenersReferenceQueue.poll() != null) {\n-            found = true;\n+        \/\/ If there are no listeners on the ReferenceQueue, then that means none\n+        \/\/ are unreachable and we can just return.\n+        if (listenersReferenceQueue.poll() == null) {\n+            return; \/\/ There are no unreachable listeners\n@@ -180,7 +181,11 @@\n-        if (found) {\n-            Iterator<WeakReference<VMListener>> iter = listeners.iterator();\n-            while (iter.hasNext()) {\n-                VMListener l = iter.next().get();\n-                if (l == null) {\n-                    iter.remove();\n-                }\n+\n+        \/\/ We always need to clear the ReferenceQueue\n+        while (listenersReferenceQueue.poll() != null)\n+            ;\n+\n+        \/\/ Remove unreachable listeners since we know there is at least one.\n+        Iterator<WeakReference<VMListener>> iter = listeners.iterator();\n+        while (iter.hasNext()) {\n+            VMListener l = iter.next().get();\n+            if (l == null) {\n+                iter.remove();\n@@ -188,1 +193,1 @@\n-         }\n+        }\n","filename":"src\/jdk.jdi\/share\/classes\/com\/sun\/tools\/jdi\/VMState.java","additions":16,"deletions":11,"binary":false,"changes":27,"status":"modified"}]}