{"files":[{"patch":"@@ -73,1 +73,1 @@\n-void VMOperationTimeoutTask::arm() {\n+jlong VMOperationTimeoutTask::arm() {\n@@ -76,0 +76,1 @@\n+  return _arm_time;\n@@ -406,0 +407,2 @@\n+  bool should_abort_on_timeout = AbortVMOnVMOperationTimeout;\n+  jlong vm_op_start_ns;\n@@ -409,2 +412,3 @@\n-    if (_timeout_task != NULL) {\n-      _timeout_task->arm();\n+    if (should_abort_on_timeout) {\n+      assert(_timeout_task != nullptr, \"must created\");\n+      vm_op_start_ns = _timeout_task->arm();\n@@ -418,1 +422,1 @@\n-    if (_timeout_task != NULL) {\n+    if (should_abort_on_timeout) {\n@@ -420,0 +424,5 @@\n+      jlong delay = nanos_to_millis(os::javaTimeNanos() - vm_op_start_ns);\n+      if (delay > AbortVMOnVMOperationTimeoutDelay) {\n+        fatal(\"%s VM operation took too long: completed in \" JLONG_FORMAT \" ms (timeout: \" INTX_FORMAT \" ms)\",\n+              _cur_vm_operation->name(), delay, AbortVMOnVMOperationTimeoutDelay);\n+      }\n","filename":"src\/hotspot\/share\/runtime\/vmThread.cpp","additions":13,"deletions":4,"binary":false,"changes":17,"status":"modified"},{"patch":"@@ -50,1 +50,1 @@\n-  void arm();\n+  jlong arm();\n","filename":"src\/hotspot\/share\/runtime\/vmThread.hpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"}]}