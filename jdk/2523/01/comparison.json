{"files":[{"patch":"@@ -2,1 +2,1 @@\n-# Copyright (c) 2016, 2020, Oracle and\/or its affiliates. All rights reserved.\n+# Copyright (c) 2016, 2021, Oracle and\/or its affiliates. All rights reserved.\n@@ -144,7 +144,1 @@\n-vmTestbase\/vm\/mlvm\/meth\/func\/java\/throwException\/Test.java 8058176 generic-all\n-vmTestbase\/vm\/mlvm\/meth\/stress\/compiler\/deoptimize\/Test.java#id1 8058176 generic-all\n-vmTestbase\/vm\/mlvm\/meth\/stress\/compiler\/i2c_c2i\/Test.java 8058176 generic-all\n-vmTestbase\/vm\/mlvm\/meth\/stress\/compiler\/sequences\/Test.java 8058176 generic-all\n-vmTestbase\/vm\/mlvm\/meth\/stress\/gc\/callSequencesDuringGC\/Test.java 8058176 generic-all\n-vmTestbase\/vm\/mlvm\/meth\/stress\/java\/sequences\/Test.java 8058176 generic-all\n-vmTestbase\/vm\/mlvm\/meth\/stress\/jdi\/breakpointInCompiledCode\/Test.java 8058176 generic-all\n+vmTestbase\/vm\/mlvm\/meth\/stress\/jdi\/breakpointInCompiledCode\/Test.java 8257761 generic-all\n","filename":"test\/hotspot\/jtreg\/ProblemList.txt","additions":2,"deletions":8,"binary":false,"changes":10,"status":"modified"},{"patch":"@@ -28,0 +28,3 @@\n+import java.lang.management.MemoryUsage;\n+import java.lang.management.MemoryPoolMXBean;\n+import java.lang.management.ManagementFactory;\n@@ -66,0 +69,4 @@\n+    private static final MemoryPoolMXBean CODE_CACHE_MX_BEAN = ManagementFactory\n+        .getMemoryPoolMXBeans().stream()\n+        .filter(pool -> pool.getName().equals(\"CodeCache\")).findFirst().get();\n+\n@@ -70,0 +77,7 @@\n+    private static final boolean isCodeCacheEffectivelyFull() {\n+        MemoryUsage usage = CODE_CACHE_MX_BEAN.getUsage();\n+\n+        \/\/ Number 2M is arbitrary, can be changed if need arises\n+        return usage.getMax() - usage.getUsed() < 2000000;\n+    }\n+\n@@ -91,0 +105,6 @@\n+            if (isCodeCacheEffectivelyFull()) {\n+                Env.traceNormal(\"Not enought code cache to build up MH sequences anymore. \" +\n+                        \" Has only been able to achieve \" + (MAX_CYCLES - i) + \" out of \" + MAX_CYCLES);\n+                break;\n+            }\n+\n","filename":"test\/hotspot\/jtreg\/vmTestbase\/vm\/mlvm\/meth\/share\/MHTransformationGen.java","additions":20,"deletions":0,"binary":false,"changes":20,"status":"modified"}]}