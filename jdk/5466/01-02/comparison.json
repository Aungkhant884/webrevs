{"files":[{"patch":"@@ -52,0 +52,55 @@\n+- (NSArray *)accessibilityChildren\n+{\n+    NSArray *children = [super accessibilityChildren];\n+    if (children == NULL) {\n+        JNIEnv *env = [ThreadUtilities getJNIEnv];\n+        CommonComponentAccessibility *parent = [self accessibilityParent];\n+        if (parent->fAccessible == NULL) return nil;\n+        GET_CHILDRENANDROLES_METHOD_RETURN(nil);\n+        jobjectArray jchildrenAndRoles = (jobjectArray)(*env)->CallStaticObjectMethod(env, sjc_CAccessibility, jm_getChildrenAndRoles,\n+                                                                                      parent->fAccessible, parent->fComponent, sun_lwawt_macosx_CAccessibility_JAVA_AX_ALL_CHILDREN, NO);\n+        CHECK_EXCEPTION();\n+        if (jchildrenAndRoles == NULL) return nil;\n+\n+        jsize arrayLen = (*env)->GetArrayLength(env, jchildrenAndRoles);\n+        NSMutableArray *childrenCells = [NSMutableArray arrayWithCapacity:arrayLen\/2];\n+\n+        NSUInteger childIndex = fIndex;\n+\n+        int inc = [(TableAccessibility *)[self accessibilityParent] accessibilityRowCount] * 2;\n+        NSInteger i = childIndex * 2;\n+        for(i; i < arrayLen; i += inc)\n+        {\n+            jobject \/* Accessible *\/ jchild = (*env)->GetObjectArrayElement(env, jchildrenAndRoles, i);\n+            jobject \/* String *\/ jchildJavaRole = (*env)->GetObjectArrayElement(env, jchildrenAndRoles, i+1);\n+\n+            NSString *childJavaRole = nil;\n+            if (jchildJavaRole != NULL) {\n+                DECLARE_CLASS_RETURN(sjc_AccessibleRole, \"javax\/accessibility\/AccessibleRole\", nil);\n+                DECLARE_FIELD_RETURN(sjf_key, sjc_AccessibleRole, \"key\", \"Ljava\/lang\/String;\", nil);\n+                jobject jkey = (*env)->GetObjectField(env, jchildJavaRole, sjf_key);\n+                CHECK_EXCEPTION();\n+                childJavaRole = JavaStringToNSString(env, jkey);\n+                (*env)->DeleteLocalRef(env, jkey);\n+            }\n+\n+            CellAccessibility *child = [[CellAccessibility alloc] initWithParent:self\n+                                                                         withEnv:env\n+                                                                  withAccessible:jchild\n+                                                                       withIndex:childIndex\n+                                                                        withView:self->fView\n+                                                                    withJavaRole:childJavaRole];\n+            [childrenCells addObject:[[child retain] autorelease]];\n+\n+            (*env)->DeleteLocalRef(env, jchild);\n+            (*env)->DeleteLocalRef(env, jchildJavaRole);\n+\n+            childIndex += (inc \/ 2);\n+        }\n+        (*env)->DeleteLocalRef(env, jchildrenAndRoles);\n+        return childrenCells;\n+    } else {\n+        return children;\n+    }\n+}\n+\n","filename":"src\/java.desktop\/macosx\/native\/libawt_lwawt\/awt\/a11y\/ColumnAccessibility.m","additions":55,"deletions":0,"binary":false,"changes":55,"status":"modified"}]}