{"files":[{"patch":"@@ -154,5 +154,2 @@\n-  auto ptr = (intptr_t **)addr_at(link_offset);\n-  if (os::is_readable_pointer((const void*)ptr)) {\n-    return *ptr;\n-  }\n-  return NULL;\n+  intptr_t** ptr = (intptr_t **)addr_at(link_offset);\n+  return os::is_readable_pointer(ptr) ? *ptr : NULL;\n","filename":"src\/hotspot\/cpu\/aarch64\/frame_aarch64.inline.hpp","additions":2,"deletions":5,"binary":false,"changes":7,"status":"modified"},{"patch":"@@ -130,5 +130,2 @@\n-  auto ptr = (intptr_t **)addr_at(link_offset);\n-  if (os::is_readable_pointer((const void*)ptr)) {\n-    return *ptr;\n-  }\n-  return NULL;\n+  intptr_t** ptr = (intptr_t **)addr_at(link_offset);\n+  return os::is_readable_pointer(ptr) ? *ptr : NULL;\n","filename":"src\/hotspot\/cpu\/arm\/frame_arm.inline.hpp","additions":2,"deletions":5,"binary":false,"changes":7,"status":"modified"},{"patch":"@@ -144,5 +144,2 @@\n-  auto ptr = (intptr_t **)addr_at(link_offset);\n-  if (os::is_readable_pointer((const void*)ptr)) {\n-    return *ptr;\n-  }\n-  return NULL;\n+  intptr_t** ptr = (intptr_t **)addr_at(link_offset);\n+  return os::is_readable_pointer(ptr) ? *ptr : NULL;\n","filename":"src\/hotspot\/cpu\/x86\/frame_x86.inline.hpp","additions":2,"deletions":5,"binary":false,"changes":7,"status":"modified"},{"patch":"@@ -1177,0 +1177,4 @@\n+bool is_pointer_bad(intptr_t* ptr) {\n+  return !is_aligned(ptr, sizeof(uintptr_t)) || !os::is_readable_pointer(ptr);\n+}\n+\n@@ -1184,1 +1188,1 @@\n-#else\n+#endif\n@@ -1188,3 +1192,0 @@\n-  uintptr_t fp_align_mask = (uintptr_t)(sizeof(address)-1);\n-  \/\/ sp on amd can be 32 bit aligned.\n-  uintptr_t sp_align_mask = (uintptr_t)(sizeof(int)-1);\n@@ -1192,2 +1193,1 @@\n-  uintptr_t usp    = (uintptr_t)fr->sp();\n-  if ((usp & sp_align_mask) != 0 || !os::is_readable_pointer((const void*)usp)) return true;\n+  if (is_pointer_bad(fr->sp())) return true;\n@@ -1196,1 +1196,1 @@\n-  if ((ufp & fp_align_mask) != 0 || !os::is_readable_pointer((const void*)ufp)) return true;\n+  if (is_pointer_bad(fr->fp())) return true;\n@@ -1199,3 +1199,1 @@\n-  if ((old_sp & sp_align_mask) != 0) return true;\n-  if (old_sp == 0 || old_sp == (uintptr_t)-1 ||\n-    !os::is_readable_pointer((const void*)old_sp)) return true;\n+  if ((uintptr_t)fr->sender_sp() == (uintptr_t)-1 || is_pointer_bad(fr->sender_sp())) return true;\n@@ -1204,1 +1202,0 @@\n-  if ((old_fp & fp_align_mask) != 0) return true;\n@@ -1206,1 +1203,1 @@\n-    !os::is_readable_pointer((const void*)old_fp)) return true;\n+    is_pointer_bad(fr->link_or_null())) return true;\n@@ -1216,2 +1213,0 @@\n-#endif\n-\n","filename":"src\/hotspot\/share\/runtime\/os.cpp","additions":9,"deletions":14,"binary":false,"changes":23,"status":"modified"},{"patch":"@@ -875,1 +875,1 @@\n-  auto cur_frame = os::current_frame(); \/\/ this frame has to have a sender\n+  frame cur_frame = os::current_frame(); \/\/ this frame has to have a sender\n@@ -878,1 +878,1 @@\n-}\n\\ No newline at end of file\n+}\n","filename":"test\/hotspot\/gtest\/runtime\/test_os.cpp","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"}]}