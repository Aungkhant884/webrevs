{"files":[{"patch":"@@ -30,2 +30,1 @@\n- * @modules java.base\/jdk.internal.misc\n- *          java.security.jgss\/sun.security.krb5\n+ * @modules java.security.jgss\/sun.security.krb5\n","filename":"test\/jdk\/sun\/security\/krb5\/ccache\/EmptyCC.java","additions":1,"deletions":2,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -29,1 +29,0 @@\n- * @modules java.base\/jdk.internal.misc\n","filename":"test\/jdk\/sun\/security\/util\/FilePermCompat\/CompatImpact.java","additions":0,"deletions":1,"binary":false,"changes":1,"status":"modified"},{"patch":"@@ -28,1 +28,0 @@\n- * @modules java.base\/jdk.internal.misc\n","filename":"test\/jdk\/sun\/security\/util\/FilePermCompat\/Flag.java","additions":0,"deletions":1,"binary":false,"changes":1,"status":"modified"},{"patch":"@@ -28,1 +28,0 @@\n- * @modules java.base\/jdk.internal.misc\n","filename":"test\/lib-test\/jdk\/test\/lib\/process\/ProcTest.java","additions":0,"deletions":1,"binary":false,"changes":1,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2013, 2019, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2013, 2021, Oracle and\/or its affiliates. All rights reserved.\n@@ -47,1 +47,0 @@\n-import java.util.stream.Stream;\n@@ -265,1 +264,0 @@\n-        boolean hasModules;\n@@ -269,2 +267,0 @@\n-            hasModules = new File(base, \"modules\").exists() ||\n-                    new File(base, \"jmods\").exists();\n@@ -274,1 +270,0 @@\n-            hasModules = true;\n@@ -277,5 +272,10 @@\n-        if (hasModules) {\n-            Stream.of(jdk.internal.misc.VM.getRuntimeArguments())\n-                    .filter(arg -> arg.startsWith(\"--add-exports=\") ||\n-                                   arg.startsWith(\"--add-opens=\"))\n-                    .forEach(cmd::add);\n+        String testModules = System.getProperty(\"test.modules\");\n+        if (testModules != null) {\n+            for (String module : testModules.split(\"\\\\s+\")) {\n+                if (module.endsWith(\":+open\")) {\n+                    String realModule = module.substring(0, module.length() - 6);\n+                    cmd.add(\"--add-opens=\" + realModule + \"=ALL-UNNAMED\");\n+                } else if (module.contains(\"\/\")) {\n+                    cmd.add(\"--add-exports=\" + module + \"=ALL-UNNAMED\");\n+                }\n+            }\n","filename":"test\/lib\/jdk\/test\/lib\/process\/Proc.java","additions":11,"deletions":11,"binary":false,"changes":22,"status":"modified"}]}