{"files":[{"patch":"@@ -108,0 +108,1 @@\n+    private static final int KU_NON_REPUDIATION = 1;\n@@ -359,1 +360,3 @@\n-        if (checkKeyUsage(cert, KU_SIGNATURE) == false) {\n+        \/\/ KU and EKU should be consistent\n+        if (!checkKeyUsage(cert, KU_SIGNATURE)\n+                && !checkKeyUsage(cert, KU_NON_REPUDIATION)) {\n@@ -361,1 +364,1 @@\n-                (\"KeyUsage does not allow digital signatures\",\n+                (\"KeyUsage does not allow digital signatures or non repudiation\",\n","filename":"src\/java.base\/share\/classes\/sun\/security\/validator\/EndEntityChecker.java","additions":5,"deletions":2,"binary":false,"changes":7,"status":"modified"},{"patch":"@@ -848,1 +848,1 @@\n-        gencert(\"ts\", \"-ext eku:critical=ts -validity 500\");\n+        gencert(\"ts\", \"-ext eku:critical=ts -ext ku=nonrep -validity 500\");\n","filename":"test\/jdk\/sun\/security\/tools\/jarsigner\/TimestampCheck.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"}]}