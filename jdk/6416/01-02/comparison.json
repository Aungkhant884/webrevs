{"files":[{"patch":"@@ -108,0 +108,1 @@\n+    private static final int KU_NON_REPUDIATION = 1;\n@@ -354,1 +355,1 @@\n-     * server. RFC 3161 section 2.3 only requires EKU with id-kp-timeStamping.\n+     * server (see RFC 3161, section 2.3).\n@@ -359,0 +360,8 @@\n+        \/\/ KU and EKU should be consistent\n+        if (!checkKeyUsage(cert, KU_SIGNATURE)\n+                && !checkKeyUsage(cert, KU_NON_REPUDIATION)) {\n+            throw new ValidatorException\n+                (\"KeyUsage does not allow digital signatures or non repudiation\",\n+                ValidatorException.T_EE_EXTENSIONS, cert);\n+        }\n+\n","filename":"src\/java.base\/share\/classes\/sun\/security\/validator\/EndEntityChecker.java","additions":10,"deletions":1,"binary":false,"changes":11,"status":"modified"}]}