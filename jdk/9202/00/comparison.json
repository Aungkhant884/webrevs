{"files":[{"patch":"@@ -40,0 +40,2 @@\n+import java.awt.event.FocusAdapter;\n+import java.awt.event.FocusEvent;\n@@ -41,0 +43,2 @@\n+import java.util.concurrent.CountDownLatch;\n+import java.util.concurrent.TimeUnit;\n@@ -61,4 +65,9 @@\n-\n-    private static final String[] COLUMNS = { \"Size\", \"Shape\" }; \/\/ NON-NLS: column names\n-    private static final String[] ITEMS = { \"a\", \"b\", \"c\", \"d\" }; \/\/ NON-NLS: combobox content\n-    private static final String KEY = \"terminateEditOnFocusLost\"; \/\/ NON-NLS: property name\n+    \/\/ NON-NLS: column names\n+    private static final String[] COLUMNS = {\"Size\", \"Shape\"};\n+    \/\/ NON-NLS: combobox content\n+    private static final String[] ITEMS = {\"a\", \"b\", \"c\", \"d\"};\n+    \/\/ NON-NLS: property name\n+    private static final String KEY = \"terminateEditOnFocusLost\";\n+    private static Robot robot;\n+    private static final CountDownLatch focusGainedLatch = new CountDownLatch(1);\n+    private final JTable table = new JTable(new DefaultTableModel(COLUMNS, 2));\n@@ -67,0 +76,1 @@\n+        robot = new Robot();\n@@ -70,2 +80,0 @@\n-    private final JTable table = new JTable(new DefaultTableModel(COLUMNS, 2));\n-\n@@ -89,1 +97,10 @@\n-        column.setCellEditor(new DefaultCellEditor(new JComboBox(ITEMS)));\n+        final JComboBox comboBox = new JComboBox(ITEMS);\n+        comboBox.addFocusListener(new FocusAdapter() {\n+            @Override\n+            public void focusGained(final FocusEvent e) {\n+                super.focusGained(e);\n+                focusGainedLatch.countDown();\n+            }\n+        });\n+\n+        column.setCellEditor(new DefaultCellEditor(comboBox));\n@@ -99,1 +116,0 @@\n-        Robot robot = new Robot();\n@@ -102,2 +118,2 @@\n-        robot.mousePress(InputEvent.BUTTON1_MASK);\n-        robot.mouseRelease(InputEvent.BUTTON1_MASK);\n+        robot.mousePress(InputEvent.BUTTON1_DOWN_MASK);\n+        robot.mouseRelease(InputEvent.BUTTON1_DOWN_MASK);\n@@ -106,2 +122,8 @@\n-    public static void validate() {\n-        Component component = KeyboardFocusManager.getCurrentKeyboardFocusManager().getFocusOwner();\n+    public static void validate() throws InterruptedException {\n+        if (!focusGainedLatch.await(5, TimeUnit.SECONDS)) {\n+            throw new RuntimeException(\"Waited too long, but JComboBox hasn't \" +\n+                                       \"gained the focus yet\");\n+        }\n+        Component component =\n+                KeyboardFocusManager.getCurrentKeyboardFocusManager()\n+                                    .getFocusOwner();\n@@ -112,0 +134,1 @@\n+\n","filename":"test\/jdk\/javax\/swing\/JInternalFrame\/Test6505027.java","additions":35,"deletions":12,"binary":false,"changes":47,"status":"modified"}]}