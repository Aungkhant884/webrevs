{"files":[{"patch":"@@ -171,1 +171,1 @@\n-  \/\/ CLDs finish their work. This ensures that we don't have a user-after-free\n+  \/\/ CLDs finish their work. This ensures that we don't have a use-after-free\n","filename":"src\/hotspot\/share\/classfile\/classLoaderData.hpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -506,11 +506,0 @@\n-      continue;\n-    }\n-\n-    \/\/ Found dead CLD.\n-    loaders_removed++;\n-    seen_dead_loader = true;\n-    data->unload();\n-\n-    \/\/ Move dead CLD to unloading list.\n-    if (prev != nullptr) {\n-      prev->unlink_next();\n@@ -518,3 +507,15 @@\n-      assert(data == _head, \"sanity check\");\n-      \/\/ The GC might be walking this concurrently\n-      Atomic::store(&_head, data->next());\n+      \/\/ Found dead CLD.\n+      loaders_removed++;\n+      seen_dead_loader = true;\n+      data->unload();\n+\n+      \/\/ Move dead CLD to unloading list.\n+      if (prev != nullptr) {\n+        prev->unlink_next();\n+      } else {\n+        assert(data == _head, \"sanity check\");\n+        \/\/ The GC might be walking this concurrently\n+        Atomic::store(&_head, data->next());\n+      }\n+      data->set_unloading_next(_unloading_head);\n+      _unloading_head = data;\n@@ -522,3 +523,0 @@\n-    data->set_unloading_next(_unloading_head);\n-    _unloading_head = data;\n-\n","filename":"src\/hotspot\/share\/classfile\/classLoaderDataGraph.cpp","additions":15,"deletions":17,"binary":false,"changes":32,"status":"modified"}]}