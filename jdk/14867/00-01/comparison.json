{"files":[{"patch":"@@ -4295,4 +4295,0 @@\n-          if (result != nullptr) {\n-            log_trace(os, map)(\"successfully reserved [\" PTR_FORMAT \"-\" PTR_FORMAT \")\",\n-                               p2i(result), p2i(result + bytes));\n-          }\n@@ -4300,0 +4296,4 @@\n+        if (result != nullptr) {\n+          log_trace(os, map)(\"successfully reserved [\" PTR_FORMAT \"-\" PTR_FORMAT \")\",\n+                             p2i(result), p2i(result + bytes));\n+        }\n","filename":"src\/hotspot\/os\/linux\/os_linux.cpp","additions":4,"deletions":4,"binary":false,"changes":8,"status":"modified"},{"patch":"@@ -592,2 +592,0 @@\n-  ReservedSpace rs;\n-\n@@ -597,1 +595,1 @@\n-  if (!rs.is_reserved()) {\n+  {\n@@ -599,1 +597,0 @@\n-    constexpr uintptr_t upper_limits[2] = { UINT_MAX, KlassEncodingMetaspaceMax };\n@@ -601,4 +598,3 @@\n-    char* addr = nullptr;\n-    for (int i = 0; i < 2 && addr == nullptr; i ++) {\n-      addr = os::attempt_reserve_memory_below((char*)upper_limits[i], size,\n-                                              Metaspace::reserve_alignment(), num_tries);\n+    char* addr = os::attempt_reserve_memory_below((char*)UINT_MAX + 1, size, Metaspace::reserve_alignment(), num_tries);\n+    if (addr == nullptr) {\n+      addr = os::attempt_reserve_memory_below((char*)KlassEncodingMetaspaceMax + 1, size, Metaspace::reserve_alignment(), num_tries);\n@@ -607,2 +603,5 @@\n-      rs = ReservedSpace::space_for_range(addr, size, Metaspace::reserve_alignment(),\n-                                          os::vm_page_size(), false, false);\n+      ReservedSpace rs = ReservedSpace::space_for_range(addr, size, Metaspace::reserve_alignment(),\n+                                                        os::vm_page_size(), false, false);\n+      if (rs.is_reserved()) {\n+        return rs;\n+      }\n@@ -612,4 +611,0 @@\n-  if (rs.is_reserved()) {\n-    return rs;\n-  }\n-\n","filename":"src\/hotspot\/share\/memory\/metaspace.cpp","additions":9,"deletions":14,"binary":false,"changes":23,"status":"modified"}]}