{"files":[{"patch":"@@ -66,1 +66,0 @@\n-\n@@ -70,0 +69,7 @@\n+      if (hr->is_young()) {\n+        \/\/ G1 updates the BOT for old region contents incrementally, but young regions\n+        \/\/ lack BOT information for performance reasons.\n+        \/\/ Recreate BOT information of high live ratio young regions here to keep expected\n+        \/\/ performance during scanning their card tables in the collection pauses later.\n+        update_bot(hr);\n+      }\n@@ -160,0 +166,16 @@\n+void G1FullGCPrepareTask::G1CalculatePointersClosure::update_bot(HeapRegion* hr) {\n+  HeapWord* const limit = hr->top();\n+  HeapWord* next_addr = hr->bottom();\n+  HeapWord* threshold = hr->initialize_threshold();\n+  HeapWord* prev_addr;\n+  while (next_addr < limit) {\n+    prev_addr = next_addr;\n+    next_addr = _bitmap->get_next_marked_addr(next_addr + 1, limit);\n+\n+    if (next_addr > threshold) {\n+      threshold = hr->cross_threshold(prev_addr, next_addr);\n+    }\n+  }\n+  assert(next_addr == limit, \"Should stop the scan at the limit.\");\n+}\n+\n","filename":"src\/hotspot\/share\/gc\/g1\/g1FullGCPrepareTask.cpp","additions":23,"deletions":1,"binary":false,"changes":24,"status":"modified"},{"patch":"@@ -66,0 +66,1 @@\n+    void update_bot(HeapRegion* hr);\n","filename":"src\/hotspot\/share\/gc\/g1\/g1FullGCPrepareTask.hpp","additions":1,"deletions":0,"binary":false,"changes":1,"status":"modified"}]}