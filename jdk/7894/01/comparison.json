{"files":[{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2002, 2021, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2002, 2022, Oracle and\/or its affiliates. All rights reserved.\n@@ -57,1 +57,1 @@\n-    \/\/    AES_128(GCM), AES_256, AES_128, 3DES-EDE.\n+    \/\/    AES_128(GCM), AES_256, AES_128.\n@@ -59,1 +59,1 @@\n-    \/\/    SHA256, SHA, MD5.\n+    \/\/    SHA256, SHA.\n@@ -330,35 +330,0 @@\n-    \/\/ 3DES_EDE, forward secrecy.\n-    TLS_ECDHE_ECDSA_WITH_3DES_EDE_CBC_SHA(\n-            0xC008, true, \"TLS_ECDHE_ECDSA_WITH_3DES_EDE_CBC_SHA\", \"\",\n-            ProtocolVersion.PROTOCOLS_TO_12,\n-            K_ECDHE_ECDSA, B_3DES, M_SHA, H_SHA256),\n-    TLS_ECDHE_RSA_WITH_3DES_EDE_CBC_SHA(\n-            0xC012, true, \"TLS_ECDHE_RSA_WITH_3DES_EDE_CBC_SHA\", \"\",\n-            ProtocolVersion.PROTOCOLS_TO_12,\n-            K_ECDHE_RSA, B_3DES, M_SHA, H_SHA256),\n-    SSL_DHE_RSA_WITH_3DES_EDE_CBC_SHA(\n-            0x0016, true, \"SSL_DHE_RSA_WITH_3DES_EDE_CBC_SHA\",\n-                          \"TLS_DHE_RSA_WITH_3DES_EDE_CBC_SHA\",\n-            ProtocolVersion.PROTOCOLS_TO_12,\n-            K_DHE_RSA, B_3DES, M_SHA, H_SHA256),\n-    SSL_DHE_DSS_WITH_3DES_EDE_CBC_SHA(\n-            0x0013, true, \"SSL_DHE_DSS_WITH_3DES_EDE_CBC_SHA\",\n-                          \"TLS_DHE_DSS_WITH_3DES_EDE_CBC_SHA\",\n-            ProtocolVersion.PROTOCOLS_TO_12,\n-            K_DHE_DSS, B_3DES, M_SHA, H_SHA256),\n-\n-    \/\/ 3DES_EDE, not forward secrecy.\n-    TLS_ECDH_ECDSA_WITH_3DES_EDE_CBC_SHA(\n-            0xC003, true, \"TLS_ECDH_ECDSA_WITH_3DES_EDE_CBC_SHA\", \"\",\n-            ProtocolVersion.PROTOCOLS_TO_12,\n-            K_ECDH_ECDSA, B_3DES, M_SHA, H_SHA256),\n-    TLS_ECDH_RSA_WITH_3DES_EDE_CBC_SHA(\n-            0xC00D, true, \"TLS_ECDH_RSA_WITH_3DES_EDE_CBC_SHA\", \"\",\n-            ProtocolVersion.PROTOCOLS_TO_12,\n-            K_ECDH_RSA, B_3DES, M_SHA, H_SHA256),\n-    SSL_RSA_WITH_3DES_EDE_CBC_SHA(\n-            0x000A, true, \"SSL_RSA_WITH_3DES_EDE_CBC_SHA\",\n-                          \"TLS_RSA_WITH_3DES_EDE_CBC_SHA\",\n-            ProtocolVersion.PROTOCOLS_TO_12,\n-            K_RSA, B_3DES, M_SHA, H_SHA256),\n-\n@@ -416,0 +381,35 @@\n+\n+    \/\/ 3DES_EDE, forward secrecy.\n+    TLS_ECDHE_ECDSA_WITH_3DES_EDE_CBC_SHA(\n+            0xC008, false, \"TLS_ECDHE_ECDSA_WITH_3DES_EDE_CBC_SHA\", \"\",\n+            ProtocolVersion.PROTOCOLS_TO_12,\n+            K_ECDHE_ECDSA, B_3DES, M_SHA, H_SHA256),\n+    TLS_ECDHE_RSA_WITH_3DES_EDE_CBC_SHA(\n+            0xC012, false, \"TLS_ECDHE_RSA_WITH_3DES_EDE_CBC_SHA\", \"\",\n+            ProtocolVersion.PROTOCOLS_TO_12,\n+            K_ECDHE_RSA, B_3DES, M_SHA, H_SHA256),\n+    SSL_DHE_RSA_WITH_3DES_EDE_CBC_SHA(\n+            0x0016, false, \"SSL_DHE_RSA_WITH_3DES_EDE_CBC_SHA\",\n+                           \"TLS_DHE_RSA_WITH_3DES_EDE_CBC_SHA\",\n+            ProtocolVersion.PROTOCOLS_TO_12,\n+            K_DHE_RSA, B_3DES, M_SHA, H_SHA256),\n+    SSL_DHE_DSS_WITH_3DES_EDE_CBC_SHA(\n+            0x0013, false, \"SSL_DHE_DSS_WITH_3DES_EDE_CBC_SHA\",\n+                           \"TLS_DHE_DSS_WITH_3DES_EDE_CBC_SHA\",\n+            ProtocolVersion.PROTOCOLS_TO_12,\n+            K_DHE_DSS, B_3DES, M_SHA, H_SHA256),\n+\n+    \/\/ 3DES_EDE, not forward secrecy.\n+    TLS_ECDH_ECDSA_WITH_3DES_EDE_CBC_SHA(\n+            0xC003, false, \"TLS_ECDH_ECDSA_WITH_3DES_EDE_CBC_SHA\", \"\",\n+            ProtocolVersion.PROTOCOLS_TO_12,\n+            K_ECDH_ECDSA, B_3DES, M_SHA, H_SHA256),\n+    TLS_ECDH_RSA_WITH_3DES_EDE_CBC_SHA(\n+            0xC00D, false, \"TLS_ECDH_RSA_WITH_3DES_EDE_CBC_SHA\", \"\",\n+            ProtocolVersion.PROTOCOLS_TO_12,\n+            K_ECDH_RSA, B_3DES, M_SHA, H_SHA256),\n+    SSL_RSA_WITH_3DES_EDE_CBC_SHA(\n+            0x000A, false, \"SSL_RSA_WITH_3DES_EDE_CBC_SHA\",\n+                           \"TLS_RSA_WITH_3DES_EDE_CBC_SHA\",\n+            ProtocolVersion.PROTOCOLS_TO_12,\n+            K_RSA, B_3DES, M_SHA, H_SHA256),\n","filename":"src\/java.base\/share\/classes\/sun\/security\/ssl\/CipherSuite.java","additions":38,"deletions":38,"binary":false,"changes":76,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2015, 2019, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2015, 2022, Oracle and\/or its affiliates. All rights reserved.\n@@ -54,0 +54,3 @@\n+import java.util.ArrayList;\n+import java.util.Arrays;\n+import java.util.List;\n@@ -62,0 +65,1 @@\n+    private static boolean reenable;\n@@ -66,0 +70,1 @@\n+            reenable = true;\n@@ -80,0 +85,5 @@\n+        } else if (reenable) {\n+            List<String> cipherSuites =\n+                new ArrayList(Arrays.asList(engine.getEnabledCipherSuites()));\n+            cipherSuites.add(cipherSuite);\n+            engine.setEnabledCipherSuites(cipherSuites.toArray(new String[0]));\n","filename":"test\/jdk\/javax\/net\/ssl\/DTLS\/CipherSuite.java","additions":11,"deletions":1,"binary":false,"changes":12,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2015, 2018, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2015, 2022, Oracle and\/or its affiliates. All rights reserved.\n@@ -26,1 +26,1 @@\n- * @bug 8076221 8211883\n+ * @bug 8076221 8211883 8163327\n@@ -63,1 +63,1 @@\n-    \/\/ supported RC4, NULL, and anon cipher suites\n+    \/\/ supported 3DES, DES, RC4, NULL, and anon cipher suites\n@@ -65,1 +65,2 @@\n-    private static final String[] rc4_null_anon_ciphersuites = new String[] {\n+    private static final String[] desede_des_rc4_null_anon_ciphersuites\n+        = new String[] {\n@@ -93,0 +94,7 @@\n+        \"SSL_RSA_WITH_DES_CBC_SHA\",\n+        \"SSL_DHE_RSA_WITH_DES_CBC_SHA\",\n+        \"SSL_DHE_DSS_WITH_DES_CBC_SHA\",\n+        \"SSL_RSA_EXPORT_WITH_DES40_CBC_SHA\",\n+        \"SSL_DHE_RSA_EXPORT_WITH_DES40_CBC_SHA\",\n+        \"SSL_DHE_DSS_EXPORT_WITH_DES40_CBC_SHA\",\n+        \"SSL_RSA_EXPORT_WITH_RC4_40_MD5\",\n@@ -97,1 +105,8 @@\n-        \"TLS_ECDH_anon_WITH_RC4_128_SHA\"\n+        \"TLS_ECDH_anon_WITH_RC4_128_SHA\",\n+        \"TLS_ECDHE_ECDSA_WITH_3DES_EDE_CBC_SHA\",\n+        \"TLS_ECDHE_RSA_WITH_3DES_EDE_CBC_SHA\",\n+        \"SSL_DHE_RSA_WITH_3DES_EDE_CBC_SHA\",\n+        \"SSL_DHE_DSS_WITH_3DES_EDE_CBC_SHA\",\n+        \"TLS_ECDH_ECDSA_WITH_3DES_EDE_CBC_SHA\",\n+        \"TLS_ECDH_RSA_WITH_3DES_EDE_CBC_SHA\",\n+        \"SSL_RSA_WITH_3DES_EDE_CBC_SHA\"\n@@ -116,1 +131,1 @@\n-                \/\/ check if RC4, NULL, and anon cipher suites\n+                \/\/ check if 3DES, DES, RC4, NULL, and anon cipher suites\n@@ -118,1 +133,1 @@\n-                checkFailure(rc4_null_anon_ciphersuites);\n+                checkFailure(desede_des_rc4_null_anon_ciphersuites);\n@@ -125,0 +140,6 @@\n+                \/\/ reset jdk.certpath.disabledAlgorithms. This is necessary\n+                \/\/ to allow the RSA_EXPORT suites to pass which use an RSA 512\n+                \/\/ bit key which violates the default certpath constraints.\n+                Security.setProperty(\"jdk.certpath.disabledAlgorithms\", \"\");\n+                System.out.println(\"jdk.certpath.disabledAlgorithms = \"\n+                    + Security.getProperty(\"jdk.certpath.disabledAlgorithms\"));\n@@ -126,3 +147,3 @@\n-                \/\/ check if RC4, NULL, and anon cipher suites can be used\n-                \/\/ if jdk.tls.disabledAlgorithms is empty\n-                checkSuccess(rc4_null_anon_ciphersuites);\n+                \/\/ check if 3DES, DES, RC4, NULL, and anon cipher suites\n+                \/\/ can be used if jdk.{tls,certpath}.disabledAlgorithms is empty\n+                checkSuccess(desede_des_rc4_null_anon_ciphersuites);\n","filename":"test\/jdk\/javax\/net\/ssl\/ciphersuites\/DisabledAlgorithms.java","additions":31,"deletions":10,"binary":false,"changes":41,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2018, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2018, 2022, Oracle and\/or its affiliates. All rights reserved.\n@@ -26,3 +26,3 @@\n- * @bug 8208350\n- * @summary Disable all DES cipher suites\n- * @run main\/othervm NoDesRC4CiphSuite\n+ * @bug 8208350 8163327\n+ * @summary Disable all DES, RC4, and 3DES\/DesEde cipher suites\n+ * @run main\/othervm NoDesRC4DesEdeCiphSuite\n@@ -46,1 +46,1 @@\n-public class NoDesRC4CiphSuite {\n+public class NoDesRC4DesEdeCiphSuite {\n@@ -83,0 +83,12 @@\n+    private static final List<Integer> DESEDE_CS_LIST = Arrays.asList(\n+        0xC008, 0xC012, 0x0016, 0x0013, 0xC003, 0xC00D, 0x000A\n+    );\n+    private static final String[] DESEDE_CS_LIST_NAMES = new String[] {\n+        \"TLS_ECDHE_ECDSA_WITH_3DES_EDE_CBC_SHA\",\n+        \"TLS_ECDHE_RSA_WITH_3DES_EDE_CBC_SHA\",\n+        \"SSL_DHE_RSA_WITH_3DES_EDE_CBC_SHA\",\n+        \"SSL_DHE_DSS_WITH_3DES_EDE_CBC_SHA\",\n+        \"TLS_ECDH_ECDSA_WITH_3DES_EDE_CBC_SHA\",\n+        \"TLS_ECDH_RSA_WITH_3DES_EDE_CBC_SHA\",\n+        \"SSL_RSA_WITH_3DES_EDE_CBC_SHA\"\n+    };\n@@ -102,0 +114,5 @@\n+        \/\/ Disabled 3DES tests\n+        allGood &= testDefaultCase(DESEDE_CS_LIST);\n+        allGood &= testEngAddDisabled(DESEDE_CS_LIST_NAMES, DESEDE_CS_LIST);\n+        allGood &= testEngOnlyDisabled(DESEDE_CS_LIST_NAMES);\n+\n","filename":"test\/jdk\/sun\/security\/ssl\/CipherSuite\/NoDesRC4DesEdeCiphSuite.java","additions":22,"deletions":5,"binary":false,"changes":27,"previous_filename":"test\/jdk\/sun\/security\/ssl\/CipherSuite\/NoDesRC4CiphSuite.java","status":"renamed"}]}