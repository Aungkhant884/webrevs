{"files":[{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 1997, 2018, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 1997, 2020, Oracle and\/or its affiliates. All rights reserved.\n@@ -28,3 +28,20 @@\n-import java.awt.event.*;\n-import java.awt.*;\n-import java.beans.*;\n+import java.awt.Color;\n+import java.awt.Component;\n+import java.awt.Dimension;\n+import java.awt.FontMetrics;\n+import java.awt.Graphics;\n+import java.awt.IllegalComponentStateException;\n+import java.awt.Insets;\n+import java.awt.Polygon;\n+import java.awt.Rectangle;\n+import java.awt.Toolkit;\n+import java.awt.event.ActionEvent;\n+import java.awt.event.ActionListener;\n+import java.awt.event.ComponentAdapter;\n+import java.awt.event.ComponentEvent;\n+import java.awt.event.ComponentListener;\n+import java.awt.event.FocusEvent;\n+import java.awt.event.FocusListener;\n+import java.awt.event.MouseEvent;\n+import java.beans.PropertyChangeEvent;\n+import java.beans.PropertyChangeListener;\n@@ -34,3 +51,19 @@\n-import javax.swing.*;\n-import javax.swing.event.*;\n-import javax.swing.plaf.*;\n+import javax.swing.AbstractAction;\n+import javax.swing.BoundedRangeModel;\n+import javax.swing.Icon;\n+import javax.swing.ImageIcon;\n+import javax.swing.InputMap;\n+import javax.swing.JComponent;\n+import javax.swing.JLabel;\n+import javax.swing.JSlider;\n+import javax.swing.LookAndFeel;\n+import javax.swing.SwingUtilities;\n+import javax.swing.Timer;\n+import javax.swing.UIManager;\n+import javax.swing.event.ChangeEvent;\n+import javax.swing.event.ChangeListener;\n+import javax.swing.event.MouseInputAdapter;\n+import javax.swing.plaf.ComponentUI;\n+import javax.swing.plaf.InsetsUIResource;\n+import javax.swing.plaf.SliderUI;\n+\n@@ -41,1 +74,0 @@\n-\n@@ -1489,0 +1521,2 @@\n+        Rectangle clip = g.getClipBounds();\n+        g.clipRect(0, 0, w, h);\n@@ -1584,1 +1618,1 @@\n-\n+        g.setClip(clip);\n","filename":"src\/java.desktop\/share\/classes\/javax\/swing\/plaf\/basic\/BasicSliderUI.java","additions":43,"deletions":9,"binary":false,"changes":52,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 1998, 2014, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 1998, 2020, Oracle and\/or its affiliates. All rights reserved.\n@@ -28,3 +28,10 @@\n-import javax.swing.*;\n-import javax.swing.plaf.UIResource;\n-import java.awt.*;\n+import java.awt.Color;\n+import java.awt.Component;\n+import java.awt.Dimension;\n+import java.awt.Graphics;\n+import java.awt.Graphics2D;\n+import java.awt.GraphicsConfiguration;\n+import java.awt.Image;\n+import java.awt.Polygon;\n+import java.awt.Rectangle;\n+import java.awt.Transparency;\n@@ -33,1 +40,0 @@\n-import java.util.Enumeration;\n@@ -35,0 +41,10 @@\n+\n+import javax.swing.ButtonModel;\n+import javax.swing.Icon;\n+import javax.swing.JButton;\n+import javax.swing.JCheckBox;\n+import javax.swing.JMenu;\n+import javax.swing.JMenuItem;\n+import javax.swing.JRadioButton;\n+import javax.swing.plaf.UIResource;\n+\n@@ -36,1 +52,1 @@\n-import static sun.swing.SwingUtilities2.setAntialiasingHintForScaledGraphics;\n+\n@@ -38,0 +54,1 @@\n+import static sun.swing.SwingUtilities2.setAntialiasingHintForScaledGraphics;\n@@ -2404,0 +2421,2 @@\n+        Rectangle clip = g.getClipBounds();\n+        g.clipRect(0, 0, getIconWidth(), getIconHeight());\n@@ -2482,0 +2501,1 @@\n+        g.setClip(clip);\n@@ -2511,0 +2531,2 @@\n+        Rectangle clip = g.getClipBounds();\n+        g.clipRect(0, 0, getIconWidth(), getIconHeight());\n@@ -2561,0 +2583,1 @@\n+        g.setClip(clip);\n","filename":"src\/java.desktop\/share\/classes\/javax\/swing\/plaf\/metal\/MetalIconFactory.java","additions":29,"deletions":6,"binary":false,"changes":35,"status":"modified"},{"patch":"@@ -0,0 +1,118 @@\n+\/*\n+ * Copyright (c) 2020, Oracle and\/or its affiliates. All rights reserved.\n+ * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+ *\n+ * This code is free software; you can redistribute it and\/or modify it\n+ * under the terms of the GNU General Public License version 2 only, as\n+ * published by the Free Software Foundation.\n+ *\n+ * This code is distributed in the hope that it will be useful, but WITHOUT\n+ * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+ * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+ * version 2 for more details (a copy is included in the LICENSE file that\n+ * accompanied this code).\n+ *\n+ * You should have received a copy of the GNU General Public License version\n+ * 2 along with this work; if not, write to the Free Software Foundation,\n+ * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n+ *\n+ * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n+ * or visit www.oracle.com if you need additional information or have any\n+ * questions.\n+ *\/\n+\n+import java.awt.Color;\n+import java.awt.EventQueue;\n+import java.awt.Graphics2D;\n+import java.awt.image.BufferedImage;\n+import java.io.File;\n+import java.io.IOException;\n+\n+import javax.imageio.ImageIO;\n+import javax.swing.JSlider;\n+import javax.swing.UIManager;\n+import javax.swing.UnsupportedLookAndFeelException;\n+import javax.swing.plaf.SliderUI;\n+import javax.swing.plaf.basic.BasicSliderUI;\n+import javax.swing.plaf.metal.DefaultMetalTheme;\n+import javax.swing.plaf.metal.MetalLookAndFeel;\n+\n+import static java.awt.image.BufferedImage.TYPE_INT_ARGB;\n+import static javax.swing.UIManager.getInstalledLookAndFeels;\n+\n+\/**\n+ * @test\n+ * @bug 8256713\n+ * @key headful\n+ * @summary The thumb should not touch pixels outside its location.\n+ *\/\n+public final class PaintThumbSize {\n+\n+    private static final int SCALE = 2;\n+    private static final int SHIFT = 100;\n+\n+    public static void main(String[] args) throws Exception {\n+        for (UIManager.LookAndFeelInfo laf : getInstalledLookAndFeels()) {\n+            EventQueue.invokeAndWait(() -> setLookAndFeel(laf));\n+            EventQueue.invokeAndWait(PaintThumbSize::test);\n+            if (laf.getClassName().contains(\"Metal\")) {\n+                EventQueue.invokeAndWait(() -> {\n+                    System.err.println(\"\\tAdditional theme: DefaultMetalTheme\");\n+                    MetalLookAndFeel.setCurrentTheme(new DefaultMetalTheme());\n+                    test();\n+                });\n+            }\n+        }\n+    }\n+\n+    private static void test() {\n+        BufferedImage bi = new BufferedImage(500, 500, TYPE_INT_ARGB);\n+        Graphics2D g = bi.createGraphics();\n+        g.setColor(Color.CYAN);\n+        g.fillRect(0, 0, bi.getWidth(), bi.getHeight());\n+        g.setColor(Color.BLACK);\n+\n+        g.scale(SCALE, SCALE);\n+        g.translate(SHIFT, SHIFT);\n+\n+        JSlider slider = new JSlider();\n+        SliderUI ui = slider.getUI();\n+        if (ui instanceof BasicSliderUI) {\n+            BasicSliderUI bui = (BasicSliderUI) ui;\n+            bui.setThumbLocation(0, 0);\n+            bui.paintThumb(g);\n+\n+            for (int y = 0; y < bi.getHeight(); ++y) {\n+                for (int x = 0; x < bi.getWidth(); ++x) {\n+                    if (x >= SHIFT * SCALE && y >= SHIFT * SCALE) {\n+                        continue;\n+                    }\n+                    if (bi.getRGB(x, y) != Color.CYAN.getRGB()) {\n+                        System.err.println(\"x = \" + x);\n+                        System.err.println(\"y = \" + y);\n+                        try {\n+                            ImageIO.write(bi,\"png\", new File(\"image.png\"));\n+                        } catch (IOException e) {\n+                            e.printStackTrace();\n+                        }\n+                        throw new RuntimeException(\"Wrong color\");\n+                    }\n+                }\n+            }\n+        }\n+        g.dispose();\n+    }\n+\n+\n+    private static void setLookAndFeel(UIManager.LookAndFeelInfo laf) {\n+        try {\n+            System.err.println(\"LookAndFeel: \" + laf.getClassName());\n+            UIManager.setLookAndFeel(laf.getClassName());\n+        } catch (UnsupportedLookAndFeelException ignored) {\n+            System.err.println(\"Unsupported LookAndFeel: \" + laf.getClassName());\n+        } catch (ClassNotFoundException | InstantiationException |\n+                IllegalAccessException e) {\n+            throw new RuntimeException(e);\n+        }\n+    }\n+}\n","filename":"test\/jdk\/javax\/swing\/JSlider\/Thumb\/PaintThumbSize.java","additions":118,"deletions":0,"binary":false,"changes":118,"status":"added"}]}