{"files":[{"patch":"@@ -121,1 +121,1 @@\n-        \/\/ target stream\n+        \/\/ target stream and random buffer level\n@@ -126,1 +126,3 @@\n-            checkTransferredContents(inputStreamProvider, outputStreamProvider, inBytes, posIn, posOut);\n+            int bufferBytes = RND.nextInt(inBytes.length - posIn);\n+            boolean mark = RND.nextBoolean();\n+            checkTransferredContents(inputStreamProvider, outputStreamProvider, inBytes, posIn, posOut, bufferBytes, mark);\n@@ -130,1 +132,1 @@\n-        checkTransferredContents(inputStreamProvider, outputStreamProvider, createRandomBytes(4096, 0), 4096, 0);\n+        checkTransferredContents(inputStreamProvider, outputStreamProvider, createRandomBytes(4096, 0), 4096, 0, 0, false);\n@@ -133,1 +135,1 @@\n-        checkTransferredContents(inputStreamProvider, outputStreamProvider, createRandomBytes(4096, 0), 0, 4096);\n+        checkTransferredContents(inputStreamProvider, outputStreamProvider, createRandomBytes(4096, 0), 0, 4096, 0, false);\n@@ -143,1 +145,1 @@\n-        checkTransferredContents(inputStreamProvider, outputStreamProvider, inBytes, 0, 0);\n+        checkTransferredContents(inputStreamProvider, outputStreamProvider, inBytes, 0, 0, 0, false);\n@@ -152,1 +154,1 @@\n-            OutputStreamProvider outputStreamProvider, byte[] inBytes, int posIn, int posOut) throws Exception {\n+            OutputStreamProvider outputStreamProvider, byte[] inBytes, int posIn, int posOut, int bufferBytes, boolean mark) throws Exception {\n@@ -160,0 +162,10 @@\n+            \/\/ fill buffer by reading some bytes before transformTo\n+            byte[] bytes = new byte[bufferBytes];\n+            in.read(bytes);\n+            out.write(bytes);\n+\n+            \/\/ set mark\n+            if (mark) {\n+              in.mark(1);\n+            }\n+\n@@ -162,0 +174,1 @@\n+            int expected = count - bufferBytes;\n@@ -163,1 +176,1 @@\n-            assertEquals(reported, count, format(\"reported %d bytes but should report %d\", reported, count));\n+            assertEquals(reported, expected, format(\"reported %d bytes but should report %d\", reported, expected));\n","filename":"test\/jdk\/java\/io\/BufferedInputStream\/TransferTo.java","additions":20,"deletions":7,"binary":false,"changes":27,"status":"modified"}]}