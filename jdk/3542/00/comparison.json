{"files":[{"patch":"@@ -46,2 +46,3 @@\n-  UnitTestThread(TestRunnable* const runnableArg, Semaphore* doneArg, const long testDurationArg) :\n-    JavaTestThread(doneArg), runnable(runnableArg), testDuration(testDurationArg) {}\n+  \/\/ maxIterationsArg - max iterations to do\n+  UnitTestThread(TestRunnable* const runnableArg, Semaphore* doneArg, const long testDurationArg, const int maxIterationsArgs) :\n+    JavaTestThread(doneArg), runnable(runnableArg), testDuration(testDurationArg), maxIterations(maxIterationsArgs) {}\n@@ -51,0 +52,1 @@\n+    int iters = 0;\n@@ -52,1 +54,1 @@\n-    while (os::javaTimeMillis() < stopTime) {\n+    while (os::javaTimeMillis() < stopTime && iters < maxIterations) {\n@@ -54,0 +56,1 @@\n+      iters++;\n@@ -59,0 +62,1 @@\n+  const int maxIterations;\n@@ -67,1 +71,2 @@\n-  ConcurrentTestRunner(TestRunnable* const runnableArg, int nrOfThreadsArg, long testDurationMillisArg) :\n+  \/\/ maxIterationsArg - max iterations to do in each thread\n+  ConcurrentTestRunner(TestRunnable* const runnableArg, int nrOfThreadsArg, long testDurationMillisArg, int maxIterationsArg) :\n@@ -70,1 +75,2 @@\n-    testDurationMillis(testDurationMillisArg) {}\n+    testDurationMillis(testDurationMillisArg),\n+    maxIterations(maxIterationsArg) {}\n@@ -78,1 +84,1 @@\n-      t[i] = new UnitTestThread(unitTestRunnable, &done, testDurationMillis);\n+      t[i] = new UnitTestThread(unitTestRunnable, &done, testDurationMillis, maxIterations);\n@@ -96,0 +102,1 @@\n+  const int maxIterations;\n","filename":"test\/hotspot\/gtest\/concurrentTestRunner.inline.hpp","additions":13,"deletions":6,"binary":false,"changes":19,"status":"modified"},{"patch":"@@ -665,1 +665,1 @@\n-  ConcurrentTestRunner testRunner(&runnable, 30, 15000);\n+  ConcurrentTestRunner testRunner(&runnable, 30, 15000, INT_MAX);\n@@ -678,1 +678,1 @@\n-  ConcurrentTestRunner testRunner(&runnable, 30, 15000);\n+  ConcurrentTestRunner testRunner(&runnable, 30, 15000, INT_MAX);\n","filename":"test\/hotspot\/gtest\/memory\/test_virtualspace.cpp","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -417,0 +417,3 @@\n+  \/\/ Enabled large pages can produce lots of warning messages, cap the iteration count.\n+  int maxIterations = UseLargePages ? 300 : INT_MAX;\n+\n@@ -418,1 +421,1 @@\n-  ConcurrentTestRunner testRunner(&runnable, 30, 15000);\n+  ConcurrentTestRunner testRunner(&runnable, 30, 15000, maxIterations);\n","filename":"test\/hotspot\/gtest\/runtime\/test_os_linux.cpp","additions":4,"deletions":1,"binary":false,"changes":5,"status":"modified"},{"patch":"@@ -704,0 +704,3 @@\n+  \/\/ Enabled large pages can produce lots of warning messages, cap the iteration count.\n+  int maxIterations = UseLargePages ? 300 : INT_MAX;\n+\n@@ -705,1 +708,1 @@\n-  ConcurrentTestRunner testRunner(&runnable, 30, 15000);\n+  ConcurrentTestRunner testRunner(&runnable, 30, 15000, maxIterations);\n","filename":"test\/hotspot\/gtest\/runtime\/test_os_windows.cpp","additions":4,"deletions":1,"binary":false,"changes":5,"status":"modified"}]}