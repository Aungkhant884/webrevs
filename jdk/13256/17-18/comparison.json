{"files":[{"patch":"@@ -62,1 +62,1 @@\n-    \/\/ Encapsulated comformance checks\n+    \/\/ Encapsulated conformance checks\n","filename":"test\/jdk\/com\/sun\/crypto\/provider\/DHKEM\/Compliance.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -26,1 +26,1 @@\n- * @bug 8149417\n+ * @bug 8297878\n@@ -338,1 +338,1 @@\n-            return new Handler(spec, rpk, null);\n+            return Handler.newEncapsulator(spec, rpk, secureRandom);\n@@ -348,1 +348,1 @@\n-            return new Handler(spec, null, rsk);\n+            return Handler.newDecapsulator(spec, rsk);\n@@ -353,3 +353,4 @@\n-            private RSAPublicKey rpk;\n-            private RSAPrivateKey rsk;\n-            private final RSAKEMParameterSpec kspec;\n+            private final RSAPublicKey rpk; \/\/ not null for encapsulator\n+            private final RSAPrivateKey rsk; \/\/ not null for decapsulator\n+            private final RSAKEMParameterSpec kspec; \/\/ not null\n+            private final SecureRandom sr; \/\/ not null for encapsulator\n@@ -357,1 +358,1 @@\n-            Handler(AlgorithmParameterSpec kspec, RSAPublicKey rpk, RSAPrivateCrtKey rsk)\n+            Handler(AlgorithmParameterSpec spec, RSAPublicKey rpk, RSAPrivateCrtKey rsk, SecureRandom sr)\n@@ -361,3 +362,3 @@\n-                SecureRandom sr = null;\n-                if (kspec != null) {\n-                    if (kspec instanceof RSAKEMParameterSpec rs) {\n+                this.sr = sr;\n+                if (spec != null) {\n+                    if (spec instanceof RSAKEMParameterSpec rs) {\n@@ -374,0 +375,13 @@\n+            static Handler newEncapsulator(AlgorithmParameterSpec spec, RSAPublicKey rpk, SecureRandom sr)\n+                    throws InvalidAlgorithmParameterException {\n+                if (sr == null) {\n+                    sr = JCAUtil.getDefSecureRandom();\n+                }\n+                return new Handler(spec, rpk, null, sr);\n+            }\n+\n+            static Handler newDecapsulator(AlgorithmParameterSpec spec, RSAPrivateCrtKey rsk)\n+                    throws InvalidAlgorithmParameterException {\n+                return new Handler(spec, null, rsk, null);\n+            }\n+\n@@ -401,1 +415,1 @@\n-                    z = new BigInteger(nLen, JCAUtil.getDefSecureRandom());\n+                    z = new BigInteger(nLen, sr);\n","filename":"test\/jdk\/javax\/crypto\/KEM\/RSA_KEM.java","additions":25,"deletions":11,"binary":false,"changes":36,"status":"modified"}]}