{"files":[{"patch":"@@ -226,3 +226,3 @@\n-  \/\/ - Mapping backed by a file\n-  \/\/ - Mapping backed by explicit large pages\n-  \/\/ - Mapping backed by normal pages or transparent huge pages\n+  \/\/ 1. Mapping backed by a file\n+  \/\/ 2. Mapping backed by explicit large pages\n+  \/\/ 3. Mapping backed by normal pages or transparent huge pages\n@@ -232,0 +232,1 @@\n+  \/\/ == Case 1 ==\n@@ -242,1 +243,4 @@\n-  } else if (use_explicit_large_pages(page_size)) {\n+  }\n+\n+  \/\/ == Case 2 ==\n+  if (use_explicit_large_pages(page_size)) {\n@@ -247,3 +251,0 @@\n-    size_t used_page_size = page_size;\n-    char* base = NULL;\n-\n@@ -251,1 +252,1 @@\n-      base = reserve_memory_special(requested_address, size, alignment, used_page_size, executable);\n+      char* base = reserve_memory_special(requested_address, size, alignment, page_size, executable);\n@@ -253,1 +254,3 @@\n-        break;\n+        \/\/ Successful reservation using large pages.\n+        initialize_members(base, size, alignment, page_size, true, executable);\n+        return;\n@@ -255,2 +258,2 @@\n-      used_page_size = os::page_sizes().next_smaller(used_page_size);\n-    } while (used_page_size > (size_t) os::vm_page_size());\n+      page_size = os::page_sizes().next_smaller(page_size);\n+    } while (page_size > (size_t) os::vm_page_size());\n@@ -258,5 +261,0 @@\n-    if (base != NULL) {\n-      \/\/ Successful reservation using large pages.\n-      initialize_members(base, size, alignment, used_page_size, true, executable);\n-      return;\n-    }\n@@ -266,1 +264,1 @@\n-    page_size = os::vm_page_size();\n+    assert(page_size == (size_t) os::vm_page_size(), \"inv\");\n@@ -269,1 +267,1 @@\n-  \/\/ Not a 'special' reservation.\n+  \/\/ == Case 3 ==\n","filename":"src\/hotspot\/share\/memory\/virtualspace.cpp","additions":16,"deletions":18,"binary":false,"changes":34,"status":"modified"}]}