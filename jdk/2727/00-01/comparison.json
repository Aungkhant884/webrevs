{"files":[{"patch":"@@ -40,1 +40,0 @@\n-  virtual bool is_concurrent_mode() const { return true; }\n","filename":"src\/hotspot\/share\/gc\/shenandoah\/mode\/shenandoahIUMode.hpp","additions":0,"deletions":1,"binary":false,"changes":1,"status":"modified"},{"patch":"@@ -52,1 +52,0 @@\n-  virtual bool is_concurrent_mode() const = 0;\n","filename":"src\/hotspot\/share\/gc\/shenandoah\/mode\/shenandoahMode.hpp","additions":0,"deletions":1,"binary":false,"changes":1,"status":"modified"},{"patch":"@@ -40,0 +40,8 @@\n+  if (FLAG_IS_DEFAULT(ShenandoahNMethodBarrier)) {\n+    FLAG_SET_DEFAULT(ShenandoahNMethodBarrier, false);\n+  }\n+\n+  if (FLAG_IS_DEFAULT(ShenandoahStackWatermarkBarrier)) {\n+    FLAG_SET_DEFAULT(ShenandoahStackWatermarkBarrier, false);\n+  }\n+\n","filename":"src\/hotspot\/share\/gc\/shenandoah\/mode\/shenandoahPassiveMode.cpp","additions":8,"deletions":0,"binary":false,"changes":8,"status":"modified"},{"patch":"@@ -38,1 +38,0 @@\n-  virtual bool is_concurrent_mode() const { return false; }\n","filename":"src\/hotspot\/share\/gc\/shenandoah\/mode\/shenandoahPassiveMode.hpp","additions":0,"deletions":1,"binary":false,"changes":1,"status":"modified"},{"patch":"@@ -39,1 +39,0 @@\n-  virtual bool is_concurrent_mode() const { return true; }\n","filename":"src\/hotspot\/share\/gc\/shenandoah\/mode\/shenandoahSATBMode.hpp","additions":0,"deletions":1,"binary":false,"changes":1,"status":"modified"},{"patch":"@@ -26,1 +26,0 @@\n-#include \"gc\/shenandoah\/mode\/shenandoahMode.hpp\"\n@@ -48,1 +47,1 @@\n-             heap->mode()->is_concurrent_mode() ? new ShenandoahBarrierSetNMethod(heap) : NULL,\n+             ShenandoahNMethodBarrier ? new ShenandoahBarrierSetNMethod(heap) : NULL,\n@@ -105,1 +104,1 @@\n-    if (_heap->mode()->is_concurrent_mode()) {\n+    if (ShenandoahStackWatermarkBarrier) {\n@@ -123,1 +122,1 @@\n-    if (_heap->mode()->is_concurrent_mode()) {\n+    if (ShenandoahStackWatermarkBarrier) {\n","filename":"src\/hotspot\/share\/gc\/shenandoah\/shenandoahBarrierSet.cpp","additions":3,"deletions":4,"binary":false,"changes":7,"status":"modified"},{"patch":"@@ -183,1 +183,1 @@\n-  if (heap->mode()->is_concurrent_mode()) {\n+  if (ShenandoahNMethodBarrier) {\n","filename":"src\/hotspot\/share\/gc\/shenandoah\/shenandoahCodeRoots.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -30,1 +30,0 @@\n-#include \"gc\/shenandoah\/mode\/shenandoahMode.hpp\"\n@@ -82,1 +81,1 @@\n-  assert(bs != NULL || !ShenandoahHeap::heap()->mode()->is_concurrent_mode(),\n+  assert(bs != NULL || !ShenandoahNMethodBarrier,\n","filename":"src\/hotspot\/share\/gc\/shenandoah\/shenandoahNMethod.inline.hpp","additions":1,"deletions":2,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -29,1 +29,0 @@\n-#include \"gc\/shenandoah\/mode\/shenandoahMode.hpp\"\n@@ -296,1 +295,1 @@\n-  CodeBlobToOopClosure* adjust_code_closure = (ClassUnloading && ShenandoahHeap::heap()->mode()->is_concurrent_mode()) ?\n+  CodeBlobToOopClosure* adjust_code_closure = (ClassUnloading && ShenandoahNMethodBarrier) ?\n","filename":"src\/hotspot\/share\/gc\/shenandoah\/shenandoahRootProcessor.cpp","additions":1,"deletions":2,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -179,1 +179,1 @@\n-  CodeBlobToOopClosure* codes_cl = ClassUnloading && ShenandoahHeap::heap()->mode()->is_concurrent_mode() ?\n+  CodeBlobToOopClosure* codes_cl = ClassUnloading && ShenandoahNMethodBarrier ?\n","filename":"src\/hotspot\/share\/gc\/shenandoah\/shenandoahRootProcessor.inline.hpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -355,0 +355,6 @@\n+  product(bool, ShenandoahNMethodBarrier, true, DIAGNOSTIC,                 \\\n+          \"Turn on\/off NMethod entry barriers in Shenandoah\")               \\\n+                                                                            \\\n+  product(bool, ShenandoahStackWatermarkBarrier, true, DIAGNOSTIC,          \\\n+          \"Turn on\/off stack watermark barriers in Shenandoah\")             \\\n+                                                                            \\\n","filename":"src\/hotspot\/share\/gc\/shenandoah\/shenandoah_globals.hpp","additions":6,"deletions":0,"binary":false,"changes":6,"status":"modified"}]}