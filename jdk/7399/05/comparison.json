{"files":[{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2018, 2021, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2018, 2022, Oracle and\/or its affiliates. All rights reserved.\n@@ -57,0 +57,1 @@\n+ * description\n@@ -114,0 +115,3 @@\n+        Arguments.putUnlessNull(bundleParams, CLIOptions.DESCRIPTION.getId(),\n+                getOptionValue(CLIOptions.DESCRIPTION));\n+\n","filename":"src\/jdk.jpackage\/share\/classes\/jdk\/jpackage\/internal\/AddLauncherArguments.java","additions":5,"deletions":1,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n-# Copyright (c) 2017, 2021, Oracle and\/or its affiliates. All rights reserved.\n+# Copyright (c) 2017, 2022, Oracle and\/or its affiliates. All rights reserved.\n@@ -141,1 +141,1 @@\n-\\          The keys \"module\", \"main-jar\", \"main-class\",\\n\\\n+\\          The keys \"module\", \"main-jar\", \"main-class\", \"description\",\\n\\\n","filename":"src\/jdk.jpackage\/share\/classes\/jdk\/jpackage\/internal\/resources\/HelpResources.properties","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n-# Copyright (c) 2017, 2021, Oracle and\/or its affiliates. All rights reserved.\n+# Copyright (c) 2017, 2022, Oracle and\/or its affiliates. All rights reserved.\n@@ -141,1 +141,1 @@\n-\\          The keys \"module\", \"main-jar\", \"main-class\",\\n\\\n+\\          The keys \"module\", \"main-jar\", \"main-class\", \"description\",\\n\\\n","filename":"src\/jdk.jpackage\/share\/classes\/jdk\/jpackage\/internal\/resources\/HelpResources_ja.properties","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n-# Copyright (c) 2017, 2021, Oracle and\/or its affiliates. All rights reserved.\n+# Copyright (c) 2017, 2022, Oracle and\/or its affiliates. All rights reserved.\n@@ -141,1 +141,1 @@\n-\\          The keys \"module\", \"main-jar\", \"main-class\",\\n\\\n+\\          The keys \"module\", \"main-jar\", \"main-class\", \"description\",\\n\\\n","filename":"src\/jdk.jpackage\/share\/classes\/jdk\/jpackage\/internal\/resources\/HelpResources_zh_CN.properties","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -35,0 +35,1 @@\n+import java.util.function.Supplier;\n@@ -89,0 +90,12 @@\n+    final public String getRawPropertyValue(\n+            String key, Supplier<String> getDefault) {\n+        return rawProperties.stream()\n+                .filter(item -> item.getKey().equals(key))\n+                .map(e -> e.getValue()).findAny().orElseGet(getDefault);\n+    }\n+\n+    private String getDesciption(JPackageCommand cmd) {\n+        return getRawPropertyValue(\"description\", () -> cmd.getArgumentValue(\n+                \"--description\", unused -> cmd.name()));\n+    }\n+\n@@ -284,0 +297,20 @@\n+    private void verifyDescription(JPackageCommand cmd) throws IOException {\n+        if (TKit.isWindows()) {\n+            String expectedDescription = getDesciption(cmd);\n+            Path launcherPath = cmd.appLauncherPath(name);\n+            String actualDescription =\n+                    WindowsHelper.getExecutableDesciption(launcherPath);\n+            TKit.assertEquals(expectedDescription, actualDescription,\n+                    String.format(\"Check file description of [%s]\", launcherPath));\n+        } else if (TKit.isLinux() && !cmd.isImagePackageType()) {\n+            String expectedDescription = getDesciption(cmd);\n+            Path desktopFile = LinuxHelper.getDesktopFile(cmd, name);\n+            if (Files.exists(desktopFile)) {\n+                TKit.assertTextStream(\"Comment=\" + expectedDescription)\n+                        .label(String.format(\"[%s] file\", desktopFile))\n+                        .predicate(String::equals)\n+                        .apply(Files.readAllLines(desktopFile).stream());\n+            }\n+        }\n+    }\n+\n@@ -287,0 +320,1 @@\n+        verifyDescription(cmd);\n","filename":"test\/jdk\/tools\/jpackage\/helpers\/jdk\/jpackage\/test\/AdditionalLauncher.java","additions":34,"deletions":0,"binary":false,"changes":34,"status":"modified"},{"patch":"@@ -166,0 +166,23 @@\n+    public static String getExecutableDesciption(Path pathToExeFile) {\n+        Executor exec = Executor.of(\"powershell\",\n+                \"-NoLogo\",\n+                \"-NoProfile\",\n+                \"-Command\",\n+                \"(Get-Item \\\\\\\"\"\n+                + pathToExeFile.toAbsolutePath()\n+                + \"\\\\\\\").VersionInfo | select FileDescription\");\n+\n+        var lineIt = exec.dumpOutput().executeAndGetOutput().iterator();\n+        while (lineIt.hasNext()) {\n+            var line = lineIt.next();\n+            if (line.trim().equals(\"FileDescription\")) {\n+                \/\/ Skip \"---------------\" and move to the description value\n+                lineIt.next();\n+                return lineIt.next().trim();\n+            }\n+        }\n+\n+        throw new RuntimeException(String.format(\n+                \"Failed to get file description of [%s]\", pathToExeFile));\n+    }\n+\n","filename":"test\/jdk\/tools\/jpackage\/helpers\/jdk\/jpackage\/test\/WindowsHelper.java","additions":23,"deletions":0,"binary":false,"changes":23,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2018, 2021, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2018, 2022, Oracle and\/or its affiliates. All rights reserved.\n@@ -43,1 +43,1 @@\n- * launchers.\n+ * launchers with unique description (\"LauncherName Description\").\n@@ -83,1 +83,2 @@\n-                    \"--arguments\", \"the\", \"--arguments\", \"King\");\n+                    \"--arguments\", \"the\", \"--arguments\", \"King\",\n+                    \"--description\", \"AddLauncherTest Description\");\n@@ -92,0 +93,1 @@\n+                .addRawProperties(Map.entry(\"description\", \"Baz2 Description\"))\n@@ -96,0 +98,1 @@\n+                .addRawProperties(Map.entry(\"description\", \"foo Description\"))\n@@ -100,0 +103,1 @@\n+                .addRawProperties(Map.entry(\"description\", \"Bar Description\"))\n","filename":"test\/jdk\/tools\/jpackage\/share\/AddLauncherTest.java","additions":7,"deletions":3,"binary":false,"changes":10,"status":"modified"}]}