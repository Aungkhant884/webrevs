{"files":[{"patch":"@@ -322,2 +322,2 @@\n-        \/\/ The lower (BitsPerWord - size) bits should be 1 since it is split case.\n-        uintptr_t set = (bit >> (BitsPerWord - bit_index)) - 1;\n+        \/\/ The lower bits should be 1 since it is split case.\n+        uintptr_t set = (bit >> (BitsPerWord - size)) - 1;\n","filename":"src\/hotspot\/share\/opto\/regmask.cpp","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -26,0 +26,1 @@\n+#include \"opto\/opcodes.hpp\"\n@@ -149,1 +150,2 @@\n-    ASSERT_TRUE(rm.is_bound1());\n+    ASSERT_TRUE(rm.is_bound1())       << \"Index \" << i;\n+    ASSERT_TRUE(rm.is_bound(Op_RegI)) << \"Index \" << i;\n@@ -157,0 +159,41 @@\n+\n+TEST_VM(RegMask, is_bound_pair) {\n+  RegMask rm;\n+  ASSERT_TRUE(rm.is_bound_pair());\n+  for (int i = 0; i < RegMask::CHUNK_SIZE - 2; i++) {\n+    rm.Insert(i);\n+    rm.Insert(i + 1);\n+    ASSERT_TRUE(rm.is_bound_pair())   << \"Index \" << i;\n+    ASSERT_TRUE(rm.is_bound_set(2))   << \"Index \" << i;\n+    ASSERT_TRUE(rm.is_bound(Op_RegI)) << \"Index \" << i;\n+    contains_expected_num_of_registers(rm, 2);\n+    rm.Clear();\n+  }\n+  \/\/ A pair with the AllStack bit does not count as a bound pair\n+  rm.Clear();\n+  rm.Insert(RegMask::CHUNK_SIZE - 2);\n+  rm.Insert(RegMask::CHUNK_SIZE - 1);\n+  ASSERT_FALSE(rm.is_bound_pair());\n+}\n+\n+TEST_VM(RegMask, is_bound_set) {\n+  RegMask rm;\n+  for (int size = 1; size <= 16; size++) {\n+    rm.Clear();\n+    ASSERT_TRUE(rm.is_bound_set(size));\n+    for (int i = 0; i < RegMask::CHUNK_SIZE - size; i++) {\n+      for (int j = i; j < i + size; j++) {\n+        rm.Insert(j);\n+      }\n+      ASSERT_TRUE(rm.is_bound_set(size))   << \"Size \" << size << \" Index \" << i;\n+      contains_expected_num_of_registers(rm, size);\n+      rm.Clear();\n+    }\n+    \/\/ A set with the AllStack bit does not count as a bound set\n+    rm.Clear();\n+    for (int j = RegMask::CHUNK_SIZE - size; j < RegMask::CHUNK_SIZE; j++) {\n+        rm.Insert(j);\n+    }\n+    ASSERT_FALSE(rm.is_bound_set(size));\n+  }\n+}\n\\ No newline at end of file\n","filename":"test\/hotspot\/gtest\/opto\/test_regmask.cpp","additions":44,"deletions":1,"binary":false,"changes":45,"status":"modified"}]}