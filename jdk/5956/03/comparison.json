{"files":[{"patch":"@@ -115,1 +115,1 @@\n-    if (count == ERROR_INSUFFICIENT_BUFFER || count == ERROR_BUFFER_OVERFLOW) {\n+    if (count == ERROR_INSUFFICIENT_BUFFER) {\n@@ -190,1 +190,1 @@\n-    if (ret == ERROR_INSUFFICIENT_BUFFER || ret == ERROR_BUFFER_OVERFLOW) {\n+    if (ret == ERROR_INSUFFICIENT_BUFFER) {\n@@ -203,3 +203,13 @@\n-\n-        JNU_ThrowByName(env, \"java\/lang\/Error\",\n-                \"IP Helper Library GetIfTable function failed\");\n+        switch (ret) {\n+            case ERROR_INVALID_PARAMETER:\n+                JNU_ThrowInternalError(env,\n+                    \"IP Helper Library GetIfTable function failed: \"\n+                    \"invalid parameter\");\n+                break;\n+            default:\n+                SetLastError(ret);\n+                JNU_ThrowByNameWithMessageAndLastError(env,\n+                    JNU_JAVANETPKG \"SocketException\",\n+                    \"IP Helper Library GetIfTable function failed\");\n+                break;\n+        }\n@@ -311,2 +321,2 @@\n-                JNU_ThrowByName(env, \"java\/lang\/Error\",\n-                       \"Cannot get multibyte char for interface display name\");\n+                JNU_ThrowInternalError(env,\n+                    \"Cannot get multibyte char for interface display name\");\n@@ -377,1 +387,1 @@\n-    if (ret == ERROR_INSUFFICIENT_BUFFER || ret == ERROR_BUFFER_OVERFLOW) {\n+    if (ret == ERROR_INSUFFICIENT_BUFFER) {\n@@ -392,2 +402,13 @@\n-        JNU_ThrowByName(env, \"java\/lang\/Error\",\n-                \"IP Helper Library GetIpAddrTable function failed\");\n+        switch (ret) {\n+            case ERROR_INVALID_PARAMETER:\n+                JNU_ThrowInternalError(env,\n+                    \"IP Helper Library GetIpAddrTable function failed: \"\n+                    \"invalid parameter\");\n+                break;\n+            default:\n+                SetLastError(ret);\n+                JNU_ThrowByNameWithMessageAndLastError(env,\n+                    JNU_JAVANETPKG \"SocketException\",\n+                    \"IP Helper Library GetIpAddrTable function failed\");\n+                break;\n+        }\n","filename":"src\/java.base\/windows\/native\/libnet\/NetworkInterface.c","additions":31,"deletions":10,"binary":false,"changes":41,"status":"modified"},{"patch":"@@ -113,20 +113,21 @@\n-        if (ret == ERROR_INSUFFICIENT_BUFFER) {\n-            JNU_ThrowByName(env, \"java\/lang\/Error\",\n-                \"IP Helper Library GetAdaptersAddresses function failed \"\n-                \"with ERROR_INSUFFICIENT_BUFFER\");\n-        } else if (ret == ERROR_ADDRESS_NOT_ASSOCIATED ) {\n-            JNU_ThrowByName(env, \"java\/lang\/Error\",\n-                \"IP Helper Library GetAdaptersAddresses function failed \"\n-                \"with ERROR_ADDRESS_NOT_ASSOCIATED\");\n-        } else {\n-            char error_msg_buf[100];\n-            int _sr;\n-            _sr = _snprintf_s(error_msg_buf, sizeof(error_msg_buf),\n-                _TRUNCATE, \"IP Helper Library GetAdaptersAddresses \"\n-                            \"function failed with error == %d\", ret);\n-            if (_sr != -1) {\n-                JNU_ThrowByName(env, \"java\/lang\/Error\", error_msg_buf);\n-            } else {\n-                JNU_ThrowByName(env, \"java\/lang\/Error\",\n-                    \"IP Helper Library GetAdaptersAddresses function failure\");\n-            }\n+        switch (ret) {\n+            case ERROR_INVALID_PARAMETER:\n+                JNU_ThrowInternalError(env,\n+                    \"IP Helper Library GetAdaptersAddresses function failed: \"\n+                    \"invalid parameter\");\n+                break;\n+            case ERROR_NOT_ENOUGH_MEMORY:\n+                JNU_ThrowOutOfMemoryError(env,\n+                    \"IP Helper Library GetAdaptersAddresses function failed: \"\n+                    \"not enough memory\");\n+                break;\n+            case ERROR_NO_DATA:\n+                \/\/ not an error\n+                *adapters = NULL;\n+                return ERROR_SUCCESS;\n+            default:\n+                SetLastError(ret);\n+                JNU_ThrowByNameWithMessageAndLastError(env,\n+                    JNU_JAVANETPKG \"SocketException\",\n+                    \"IP Helper Library GetAdaptersAddresses function failed\");\n+                break;\n@@ -134,0 +135,1 @@\n+\n@@ -182,20 +184,20 @@\n-        if (val == ERROR_INSUFFICIENT_BUFFER) {\n-            JNU_ThrowByName(env, \"java\/lang\/Error\",\n-                \"IP Helper Library GetAdaptersAddresses function failed \"\n-                \"with ERROR_INSUFFICIENT_BUFFER\");\n-        } else if (val == ERROR_ADDRESS_NOT_ASSOCIATED ) {\n-            JNU_ThrowByName(env, \"java\/lang\/Error\",\n-                \"IP Helper Library GetAdaptersAddresses function failed \"\n-                \"with ERROR_ADDRESS_NOT_ASSOCIATED\");\n-        } else {\n-            char error_msg_buf[100];\n-            int _sr;\n-            _sr = _snprintf_s(error_msg_buf, sizeof(error_msg_buf),\n-                _TRUNCATE, \"IP Helper Library GetAdaptersAddresses function failed \"\n-                           \"with error == %d\", val);\n-            if (_sr != -1) {\n-                JNU_ThrowByName(env, \"java\/lang\/Error\", error_msg_buf);\n-            } else {\n-                JNU_ThrowByName(env, \"java\/lang\/Error\",\n-                    \"IP Helper Library GetAdaptersAddresses function failure\");\n-            }\n+        switch (val) {\n+            case ERROR_INVALID_PARAMETER:\n+                JNU_ThrowInternalError(env,\n+                    \"IP Helper Library GetAdaptersAddresses function failed: \"\n+                    \"invalid parameter\");\n+                break;\n+            case ERROR_NOT_ENOUGH_MEMORY:\n+                JNU_ThrowOutOfMemoryError(env,\n+                    \"IP Helper Library GetAdaptersAddresses function failed: \"\n+                    \"not enough memory\");\n+                break;\n+            case ERROR_NO_DATA:\n+                \/\/ not an error\n+                break;\n+            default:\n+                SetLastError(val);\n+                JNU_ThrowByNameWithMessageAndLastError(env,\n+                    JNU_JAVANETPKG \"SocketException\",\n+                    \"IP Helper Library GetAdaptersAddresses function failed\");\n+                break;\n@@ -240,1 +242,1 @@\n-    DWORD ret, flags;\n+    int ret, flags;\n","filename":"src\/java.base\/windows\/native\/libnet\/NetworkInterface_winXP.c","additions":43,"deletions":41,"binary":false,"changes":84,"status":"modified"}]}