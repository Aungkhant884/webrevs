{"files":[{"patch":"@@ -587,0 +587,2 @@\n+  GrowableArray<Handle> _loaded_cld_handles; \/\/ keep the CLDs alive\n+  Thread* _current_thread;\n@@ -588,1 +590,1 @@\n-  CollectCLDClosure() {}\n+  CollectCLDClosure(Thread* thread) : _current_thread(thread) {}\n@@ -592,1 +594,0 @@\n-      cld->dec_keep_alive();\n@@ -597,1 +598,0 @@\n-      cld->inc_keep_alive();\n@@ -599,0 +599,1 @@\n+      _loaded_cld_handles.append(Handle(_current_thread, cld->holder_phantom()));\n@@ -644,3 +645,0 @@\n-  \/\/ Collect all loaded ClassLoaderData.\n-  ResourceMark rm;\n-\n@@ -648,1 +646,3 @@\n-  CollectCLDClosure collect_cld;\n+\n+  \/\/ Collect all loaded ClassLoaderData.\n+  CollectCLDClosure collect_cld(THREAD);\n","filename":"src\/hotspot\/share\/cds\/metaspaceShared.cpp","additions":7,"deletions":7,"binary":false,"changes":14,"status":"modified"},{"patch":"@@ -305,3 +305,1 @@\n-    if (!Arguments::is_dumping_archive()) {\n-      assert(_keep_alive > 0, \"Invalid keep alive increment count\");\n-    }\n+    assert(_keep_alive > 0, \"Invalid keep alive increment count\");\n","filename":"src\/hotspot\/share\/classfile\/classLoaderData.cpp","additions":1,"deletions":3,"binary":false,"changes":4,"status":"modified"}]}