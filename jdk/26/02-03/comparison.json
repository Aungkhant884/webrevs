{"files":[{"patch":"@@ -30,1 +30,2 @@\n-import java.net.*;\n+import java.net.URL;\n+import java.net.URLConnection;\n@@ -34,0 +35,1 @@\n+import java.util.concurrent.Callable;\n@@ -52,1 +54,1 @@\n-        testSetRequestPropIllegalStateException();\n+        testRequestPropIllegalStateException();\n@@ -87,1 +89,1 @@\n-     * Test that {@link URLConnection#setRequestProperty(String, String)} throws\n+     * Test that various request property handling methods on {@link java.net.URLConnection}  throw\n@@ -89,2 +91,0 @@\n-     *\n-     * @throws Exception\n@@ -92,1 +92,1 @@\n-    private static void testSetRequestPropIllegalStateException() throws Exception {\n+    private static void testRequestPropIllegalStateException() throws Exception {\n@@ -97,5 +97,32 @@\n-            conn.setRequestProperty(\"foo\", \"bar\");\n-            throw new RuntimeException(\"setRequestProperty on \" + conn.getClass().getName() +\n-                    \" for \" + url + \" was expected to throw IllegalStateException, but didn't\");\n-        } catch (IllegalStateException ise) {\n-            \/\/ expected\n+            \/\/ test setRequestProperty\n+            expectIllegalStateException(\n+                    () -> {\n+                        conn.setRequestProperty(\"foo\", \"bar\");\n+                        return null;\n+                    }, \"setRequestProperty on \" + conn.getClass().getName()\n+                            + \" for \" + url + \" was expected to throw\"\n+                            + \" IllegalStateException, but didn't\");\n+            \/\/ test addRequestProperty\n+            expectIllegalStateException(\n+                    () -> {\n+                        conn.addRequestProperty(\"foo\", \"bar\");\n+                        return null;\n+                    }, \"addRequestProperty on \" + conn.getClass().getName()\n+                            + \" for \" + url + \" was expected to throw\"\n+                            + \" IllegalStateException, but didn't\");\n+            \/\/ test getRequestProperty\n+            expectIllegalStateException(\n+                    () -> {\n+                        conn.getRequestProperty(\"foo\");\n+                        return null;\n+                    }, \"getRequestProperty on \" + conn.getClass().getName()\n+                            + \" for \" + url + \" was expected to throw\"\n+                            + \" IllegalStateException, but didn't\");\n+            \/\/ test getRequestProperties\n+            expectIllegalStateException(\n+                    () -> {\n+                        conn.getRequestProperties();\n+                        return null;\n+                    }, \"getRequestProperties on \" + conn.getClass().getName()\n+                            + \" for \" + url + \" was expected to throw\"\n+                            + \" IllegalStateException, but didn't\");\n@@ -109,0 +136,23 @@\n+\n+    }\n+\n+    \/**\n+     * Calls the {@code operation} and expects it to throw an {@link IllegalStateException}.\n+     * If no such exception is thrown then this method throws a {@link RuntimeException}\n+     * with the passed {@code unmetExpectationErrorMessage} as the exception's message.\n+     *\n+     * @param operation                    The operation to invoke\n+     * @param unmetExpectationErrorMessage The error message to be set in the\n+     *                                     RuntimeException that will be thrown if the operation\n+     *                                     doesn't result in an IllegalStateException\n+     *\/\n+    private static void expectIllegalStateException(final Callable<Void> operation,\n+                                                    final String unmetExpectationErrorMessage)\n+            throws Exception {\n+        try {\n+            operation.call();\n+            \/\/ the expected IllegalStateException wasn't throw\n+            throw new RuntimeException(unmetExpectationErrorMessage);\n+        } catch (IllegalStateException ise) {\n+            \/\/ expected\n+        }\n","filename":"test\/jdk\/java\/net\/URLConnection\/RequestProperties.java","additions":61,"deletions":11,"binary":false,"changes":72,"status":"modified"}]}