{"files":[{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2001, 2013, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2001, 2020, Oracle and\/or its affiliates. All rights reserved.\n@@ -26,2 +26,2 @@\n- * @bug 4485208\n- * @summary  file: and ftp: URL handlers need to throw NPE in setRequestProperty\n+ * @bug 4485208 8252767\n+ * @summary  Validate java.net.URLConnection#setRequestProperty throws NPE and IllegalStateException\n@@ -46,1 +46,1 @@\n-            test(new URL(urlStr));\n+            testSetRequestPropNPE(new URL(urlStr));\n@@ -50,0 +50,2 @@\n+\n+        testSetRequestPropIllegalStateException();\n@@ -52,1 +54,1 @@\n-    static void test(URL url) throws Exception {\n+    static void testSetRequestPropNPE(URL url) throws Exception {\n@@ -82,0 +84,25 @@\n+\n+    \/**\n+     * Test that {@link URLConnection#setRequestProperty(String, String)} throws\n+     * an {@link IllegalStateException} when already connected\n+     *\n+     * @throws Exception\n+     *\/\n+    private static void testSetRequestPropIllegalStateException() throws Exception {\n+        final URL url = new URL(\"file:\/\/\" + System.getProperty(\"java.io.tmpdir\"));\n+        final java.net.URLConnection conn = url.openConnection();\n+        conn.connect();\n+        try {\n+            conn.setRequestProperty(\"foo\", \"bar\");\n+            throw new RuntimeException(\"setRequestProperty on \" + conn.getClass().getName() +\n+                    \" for \" + url + \" was expected to throw IllegalStateException, but didn't\");\n+        } catch (IllegalStateException ise) {\n+            \/\/ expected\n+        } finally {\n+            try {\n+                conn.getInputStream().close();\n+            } catch (Exception e) {\n+                \/\/ ignore\n+            }\n+        }\n+    }\n","filename":"test\/jdk\/java\/net\/URLConnection\/RequestProperties.java","additions":32,"deletions":5,"binary":false,"changes":37,"status":"modified"},{"patch":"@@ -1,63 +0,0 @@\n-\/*\n- * Copyright (c) 2020, Oracle and\/or its affiliates. All rights reserved.\n- * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n- *\n- * This code is free software; you can redistribute it and\/or modify it\n- * under the terms of the GNU General Public License version 2 only, as\n- * published by the Free Software Foundation.\n- *\n- * This code is distributed in the hope that it will be useful, but WITHOUT\n- * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n- * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n- * version 2 for more details (a copy is included in the LICENSE file that\n- * accompanied this code).\n- *\n- * You should have received a copy of the GNU General Public License version\n- * 2 along with this work; if not, write to the Free Software Foundation,\n- * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n- *\n- * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n- * or visit www.oracle.com if you need additional information or have any\n- * questions.\n- *\/\n-\n-import org.testng.Assert;\n-import org.testng.annotations.Test;\n-\n-import java.net.URL;\n-\n-\/*\n- * @test\n- * @bug 8252767\n- * @summary Tests sun.net.www.URLConnection\n- * when already connected\n- * @run testng URLConnectionTest\n- *\/\n-public class URLConnectionTest {\n-\n-    \/**\n-     * Test that {@link sun.net.www.URLConnection#setRequestProperty(String, String)} throws\n-     * an {@link IllegalStateException} when already connected\n-     *\n-     * @throws Exception\n-     *\/\n-    @Test\n-    public void testSetRequestProperty() throws Exception {\n-        final URL url = new URL(\"file:\/\/\" + System.getProperty(\"java.io.tmpdir\"));\n-        final java.net.URLConnection conn = url.openConnection();\n-        conn.connect();\n-        try {\n-            conn.setRequestProperty(\"foo\", \"bar\");\n-            Assert.fail(\"setRequestProperty on \" + conn.getClass().getName() +\n-                    \" for \" + url + \" was expected to throw IllegalStateException, but didn't\");\n-        } catch (IllegalStateException ise) {\n-            \/\/ expected\n-        } finally {\n-            try {\n-                conn.getInputStream().close();\n-            } catch (Exception e) {\n-                \/\/ ignore\n-            }\n-        }\n-    }\n-}\n","filename":"test\/jdk\/sun\/net\/www\/URLConnectionTest.java","additions":0,"deletions":63,"binary":false,"changes":63,"status":"deleted"}]}