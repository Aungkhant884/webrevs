{"files":[{"patch":"@@ -55,2 +55,1 @@\n-  JMM_VERSION_4   = 0x20040000, \/\/ JDK 18\n-  JMM_VERSION     = JMM_VERSION_4\n+  JMM_VERSION     = JMM_VERSION_3\n@@ -344,3 +343,0 @@\n-  void         (JNICALL *ReportFinalizationComplete)\n-                                                 (JNIEnv *env,\n-                                                  jobject finalizee);\n","filename":"src\/hotspot\/share\/include\/jmm.h","additions":1,"deletions":5,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -756,0 +756,6 @@\n+\/*\n+ * java.lang.ref.Finalizer\n+ *\/\n+JNIEXPORT void JNICALL\n+JVM_ReportFinalizationComplete(JNIEnv *env, jobject finalizee);\n+\n","filename":"src\/hotspot\/share\/include\/jvm.h","additions":6,"deletions":0,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -107,0 +107,3 @@\n+#if INCLUDE_MANAGEMENT\n+#include \"services\/finalizerService.hpp\"\n+#endif\n@@ -684,0 +687,6 @@\n+\/\/ java.lang.ref.Finalizer \/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\n+\n+JVM_ENTRY(void, JVM_ReportFinalizationComplete(JNIEnv * env, jobject finalizee))\n+  MANAGEMENT_ONLY(FinalizerService::on_complete(JNIHandles::resolve_non_null(finalizee), THREAD);)\n+JVM_END\n+\n@@ -3854,0 +3863,1 @@\n+\n","filename":"src\/hotspot\/share\/prims\/jvm.cpp","additions":10,"deletions":0,"binary":false,"changes":10,"status":"modified"},{"patch":"@@ -2085,5 +2085,0 @@\n-\n-JVM_ENTRY(void, jmm_ReportFinalizationComplete(JNIEnv* env, jobject finalizee))\n-  FinalizerService::on_complete(JNIHandles::resolve_non_null(finalizee), THREAD);\n-JVM_END\n-\n@@ -2224,0 +2219,2 @@\n+\n+\n@@ -2265,2 +2262,1 @@\n-  jmm_SetDiagnosticFrameworkNotificationEnabled,\n-  jmm_ReportFinalizationComplete\n+  jmm_SetDiagnosticFrameworkNotificationEnabled\n","filename":"src\/hotspot\/share\/services\/management.cpp","additions":3,"deletions":7,"binary":false,"changes":10,"status":"modified"},{"patch":"@@ -48,7 +48,0 @@\n-    static {\n-        initIDs();\n-    }\n-\n-    private static native void initIDs();\n-    private static native void reportComplete(Object finalizee);\n-\n@@ -71,2 +64,0 @@\n-\n-\n@@ -108,0 +99,2 @@\n+    private static native void reportComplete(Object finalizee);\n+\n","filename":"src\/java.base\/share\/classes\/java\/lang\/ref\/Finalizer.java","additions":2,"deletions":9,"binary":false,"changes":11,"status":"modified"},{"patch":"@@ -26,1 +26,0 @@\n-#include \"jmm.h\"\n@@ -31,7 +30,0 @@\n-static const JmmInterface* jmm_interface = NULL;\n-\n-JNIEXPORT void JNICALL\n-Java_java_lang_ref_Finalizer_initIDs(JNIEnv* env, jclass cls) {\n-  jmm_interface = (JmmInterface*)JVM_GetManagement(JMM_VERSION);\n-}\n-\n@@ -40,3 +32,1 @@\n-  if (jmm_interface != NULL) {\n-    jmm_interface->ReportFinalizationComplete(env, finalizee);\n-  }\n+    JVM_ReportFinalizationComplete(env, finalizee);\n","filename":"src\/java.base\/share\/native\/libjava\/Finalizer.c","additions":1,"deletions":11,"binary":false,"changes":12,"status":"modified"}]}