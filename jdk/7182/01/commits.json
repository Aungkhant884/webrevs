[{"commit":{"message":"Addressed PR comments\n\n1. Got rid of X11GraphicsDevice.configLock in favour of the AWT lock.\n2. Reduced the use of the screen number (and, consequently, AWT lock\ncontention) in XCanvasPeer."},"files":[{"filename":"src\/java.desktop\/unix\/classes\/sun\/awt\/X11\/XCanvasPeer.java"},{"filename":"src\/java.desktop\/unix\/classes\/sun\/awt\/X11GraphicsDevice.java"}],"sha":"88a9c340b96b83768b13813d1ffb93056a7f2c7c"},{"commit":{"message":"8280468: Crashes in getConfigColormap, getConfigVisualId, XVisualIDFromVisual on Linux\n\nThis fix addresses two possible causes of crashes:\n1. makeDefaultConfig() returning NULL. The fix is to die gracefully\ninstead of crashing in an attempt to de-reference a NULL pointer.\n\n2. A race condition when the number of screens change (this is only an\nissue with the number of xinerama screens; the number of X11 screens is\nstatic for the duration of the X session).\n\nThe race scenario: X11GraphisDevice.makeDefaultConfiguration() is called\non EDT so the call can race with X11GraphisDevice.invalidate() that\nre-sets the screen number of the device; the latter is invoked on the\n\"AWT-XAWT\" thread from X11GraphicsEnvironment.rebuildDevices(). So by\nthe time makeDefaultConfiguration() makes a native call with the\ndevice's current screen number, the x11Screens array maintained by the\nnative code could have become shorter. And the native methods like\nJava_sun_awt_X11GraphicsDevice_getConfigColormap() assume that the\nscreen number passed to them is always current and valid. The AWT lock\nonly protects against the changes during the native methods invocation,\nbut does not protect against them being called with an outdated screen\nnumber.\n\nThe fix is to eliminate the race by protecting X11GraphisDevice.screen\nwith the AWT lock."},"files":[{"filename":"src\/java.desktop\/unix\/classes\/sun\/awt\/X11\/XCanvasPeer.java"},{"filename":"src\/java.desktop\/unix\/classes\/sun\/awt\/X11GraphicsDevice.java"},{"filename":"src\/java.desktop\/unix\/native\/libawt_xawt\/awt\/awt_GraphicsEnv.c"}],"sha":"3710b04cfe60ac05210d5981872ec032877269f9"}]