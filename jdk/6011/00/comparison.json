{"files":[{"patch":"@@ -78,1 +78,1 @@\n-      COPY := .gif .png .xml .css .js .js.template .txt javax.tools.JavaCompilerTool, \\\n+      COPY := .gif .png .xml .css .svg .js .js.template .txt javax.tools.JavaCompilerTool, \\\n","filename":"make\/CompileInterimLangtools.gmk","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -26,1 +26,1 @@\n-COPY += .xml .css .js .js.template .png .txt\n+COPY += .xml .css .svg .js .js.template .png .txt\n","filename":"make\/modules\/jdk.javadoc\/Java.gmk","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -293,0 +293,2 @@\n+        f = DocFile.createFileForOutput(configuration, DocPaths.CLIPBOARD_SVG);\n+        f.copyResource(DocPaths.RESOURCES.resolve(DocPaths.CLIPBOARD_SVG), true, true);\n","filename":"src\/jdk.javadoc\/share\/classes\/jdk\/javadoc\/internal\/doclets\/formats\/html\/HtmlDoclet.java","additions":2,"deletions":0,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -56,0 +56,1 @@\n+import jdk.javadoc.internal.doclets.formats.html.markup.HtmlAttr;\n@@ -384,2 +385,13 @@\n-        HtmlTree result = new HtmlTree(TagName.PRE).setStyle(HtmlStyle.snippet);\n-        result.add(Text.of(utils.normalizeNewlines(\"\\n\")));\n+        String copyText = resources.getText(\"doclet.Copy_snippet_to_clipboard\");\n+        String copiedText = resources.getText(\"doclet.Copied_snippet_to_clipboard\");\n+        HtmlTree copy = HtmlTree.DIV(HtmlStyle.snippetContainer,\n+                HtmlTree.A(\"#\", new HtmlTree(TagName.IMG)\n+                                .put(HtmlAttr.SRC, htmlWriter.pathToRoot.resolve(DocPaths.CLIPBOARD_SVG).getPath())\n+                                .put(HtmlAttr.ALT, copyText))\n+                        .addStyle(HtmlStyle.snippetCopy)\n+                        .put(HtmlAttr.ONCLICK, \"copySnippet(this)\")\n+                        .put(HtmlAttr.ARIA_LABEL, copyText)\n+                        .put(HtmlAttr.DATA_COPIED, copiedText));\n+        HtmlTree pre = new HtmlTree(TagName.PRE)\n+                .setStyle(HtmlStyle.snippet);\n+        pre.add(Text.of(utils.normalizeNewlines(\"\\n\")));\n@@ -389,1 +401,1 @@\n-                result.add(text);\n+                pre.add(text);\n@@ -434,1 +446,1 @@\n-                result.add(c);\n+                pre.add(c);\n@@ -437,1 +449,1 @@\n-        return result;\n+        return copy.add(pre);\n","filename":"src\/jdk.javadoc\/share\/classes\/jdk\/javadoc\/internal\/doclets\/formats\/html\/TagletWriterImpl.java","additions":17,"deletions":5,"binary":false,"changes":22,"status":"modified"},{"patch":"@@ -50,0 +50,1 @@\n+    DATA_COPIED(\"data-copied\"), \/\/ custom HTML5 data attribute\n","filename":"src\/jdk.javadoc\/share\/classes\/jdk\/javadoc\/internal\/doclets\/formats\/html\/markup\/HtmlAttr.java","additions":1,"deletions":0,"binary":false,"changes":1,"status":"modified"},{"patch":"@@ -83,0 +83,10 @@\n+    \/**\n+     * The class of the {@code div} element containing a snippet element.\n+     *\/\n+    snippetContainer,\n+\n+    \/**\n+     * The class of the {@code a} element to copy snippet content to the clipboard.\n+     *\/\n+    snippetCopy,\n+\n","filename":"src\/jdk.javadoc\/share\/classes\/jdk\/javadoc\/internal\/doclets\/formats\/html\/markup\/HtmlStyle.java","additions":10,"deletions":0,"binary":false,"changes":10,"status":"modified"},{"patch":"@@ -0,0 +1,33 @@\n+<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n+\n+<!--\n+ Copyright (c) 2021, Oracle and\/or its affiliates. All rights reserved.\n+ DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+\n+ This code is free software; you can redistribute it and\/or modify it\n+ under the terms of the GNU General Public License version 2 only, as\n+ published by the Free Software Foundation.  Oracle designates this\n+ particular file as subject to the \"Classpath\" exception as provided\n+ by Oracle in the LICENSE file that accompanied this code.\n+\n+ This code is distributed in the hope that it will be useful, but WITHOUT\n+ ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+ FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+ version 2 for more details (a copy is included in the LICENSE file that\n+ accompanied this code).\n+\n+ You should have received a copy of the GNU General Public License version\n+ 2 along with this work; if not, write to the Free Software Foundation,\n+ Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n+\n+ Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n+ or visit www.oracle.com if you need additional information or have any\n+ questions.\n+-->\n+\n+<svg version=\"1.1\" xmlns=\"http:\/\/www.w3.org\/2000\/svg\" viewBox=\"0 0 380 460\" fill=\"#505050\">\n+  <path\n+     d=\"M 346,8 H 108 C 90,8 75,23 75,41 v 316 c 0,18 15,33 33,33 h 238 c 18,0 33,-15 33,-33 V 41 C 379,23 364,8 346,8 Z m -8,344 H 116 c -2,0 -3,-1 -3,-3 V 49 c 0,-2 1,-3 3,-3 h 222 c 2,0 3,1 3,3 v 300 h 10e-4 c 0,2 -1,3 -3,3 z\"\/>\n+  <path\n+     d=\"m 290,389 v 26 h 10e-4 c 0,2 -1,3 -3,3 H 49 c -2,0 -3,-1 -3,-3 V 99 c 0,-2 1,-3 3,-3 h 27 v 0 l -5e-4,-38 H 41 C 23,58 8,73 8,91 v 332 c 10e-4,18 15,33 33,33 h 254 c 18,0 33,-15 33,-33 v -34\"\/>\n+<\/svg>\n","filename":"src\/jdk.javadoc\/share\/classes\/jdk\/javadoc\/internal\/doclets\/toolkit\/resources\/copy.svg","additions":33,"deletions":0,"binary":false,"changes":33,"status":"added"},{"patch":"@@ -57,0 +57,2 @@\n+doclet.Copy_snippet_to_clipboard=Copy\n+doclet.Copied_snippet_to_clipboard=Copied!\n","filename":"src\/jdk.javadoc\/share\/classes\/jdk\/javadoc\/internal\/doclets\/toolkit\/resources\/doclets.properties","additions":2,"deletions":0,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2013, 2020, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2013, 2021, Oracle and\/or its affiliates. All rights reserved.\n@@ -109,0 +109,15 @@\n+function copySnippet(link) {\n+    var textarea = document.createElement(\"textarea\");\n+    textarea.style.height = 0;\n+    document.body.appendChild(textarea);\n+    textarea.value = link.nextElementSibling.innerText;\n+    textarea.select();\n+    document.execCommand(\"copy\");\n+    document.body.removeChild(textarea);\n+    link.classList.add(\"copied\");\n+    var parent = link.parentElement;\n+    parent.onmouseleave = parent.ontouchend = function() {\n+        link.classList.remove(\"copied\");\n+    };\n+}\n+\n","filename":"src\/jdk.javadoc\/share\/classes\/jdk\/javadoc\/internal\/doclets\/toolkit\/resources\/script.js","additions":16,"deletions":1,"binary":false,"changes":17,"status":"modified"},{"patch":"@@ -936,1 +936,61 @@\n-\n+div.snippet-container {\n+    position: relative;\n+}\n+a.snippet-copy {\n+    position: absolute;\n+    top: 8px;\n+    right: 8px;\n+}\n+a.snippet-copy img {\n+    width: 18px;\n+    height: 18px;\n+    padding: 0.05em 0;\n+    opacity: 50%;\n+    transition: opacity 0.2s;\n+}\n+div.snippet-container:hover a.snippet-copy img {\n+    opacity: 80%;\n+}\n+div.snippet-container a.snippet-copy:hover img {\n+    opacity: 100%;\n+}\n+a.snippet-copy:active img {\n+    background: #d3d3d3;\n+    opacity: 100%;\n+}\n+a.snippet-copy::before {\n+    color: #3d3d3d;\n+    content: attr(aria-label);\n+    font-family:'DejaVu Sans', Arial, Helvetica, sans-serif;\n+    font-size: 85%;\n+    line-height: 1.2em;\n+    padding: 0.2em;\n+    position: absolute;\n+    opacity: 80%;\n+    transition: opacity 0.2s;\n+    white-space: nowrap;\n+    top: -0.01em;\n+    right: 1.5em;\n+    display: none;\n+}\n+div.snippet-container:hover a.snippet-copy::before {\n+    display: inherit;\n+}\n+div.snippet-container a.snippet-copy:hover::before {\n+    opacity: 100%;\n+}\n+a.snippet-copy.copied::before {\n+    content: attr(data-copied);\n+}\n+a.snippet-copy:active::before {\n+    background-color: #dadada;\n+}\n+@media screen and (max-width: 800px) {\n+    pre.snippet {\n+        padding-top: 26px;\n+    }\n+    a.snippet-copy {\n+        top: 6px;\n+        right: 6px;\n+    }\n+}\n","filename":"src\/jdk.javadoc\/share\/classes\/jdk\/javadoc\/internal\/doclets\/toolkit\/resources\/stylesheet.css","additions":61,"deletions":1,"binary":false,"changes":62,"status":"modified"},{"patch":"@@ -100,0 +100,3 @@\n+    \/** The name of the copy-to-clipboard icon file. *\/\n+    public static final DocPath CLIPBOARD_SVG = DocPath.create(\"copy.svg\");\n+\n","filename":"src\/jdk.javadoc\/share\/classes\/jdk\/javadoc\/internal\/doclets\/toolkit\/util\/DocPaths.java","additions":3,"deletions":0,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -214,0 +214,3 @@\n+                        <div class=\"snippet-container\"><a href=\"#\" class=\"snippet-copy\" onclick=\"cop\\\n+                        ySnippet(this)\" aria-label=\"Copy\" data-copied=\"Copied!\"><img src=\"..\/copy.sv\\\n+                        g\" alt=\"Copy\"><\/a>\n@@ -855,0 +858,3 @@\n+                        <div class=\"snippet-container\"><a href=\"#\" class=\"snippet-copy\" onclick=\"cop\\\n+                        ySnippet(this)\" aria-label=\"Copy\" data-copied=\"Copied!\"><img src=\"..\/copy.sv\\\n+                        g\" alt=\"Copy\"><\/a>\n@@ -949,0 +955,3 @@\n+                        <div class=\"snippet-container\"><a href=\"#\" class=\"snippet-copy\" onclick=\"cop\\\n+                        ySnippet(this)\" aria-label=\"Copy\" data-copied=\"Copied!\"><img src=\"..\/copy.sv\\\n+                        g\" alt=\"Copy\"><\/a>\n@@ -1508,0 +1517,3 @@\n+                        <div class=\"snippet-container\"><a href=\"#\" class=\"snippet-copy\" onclick=\"cop\\\n+                        ySnippet(this)\" aria-label=\"Copy\" data-copied=\"Copied!\"><img src=\"..\/copy.sv\\\n+                        g\" alt=\"Copy\"><\/a>\n@@ -1623,0 +1635,3 @@\n+                    <div class=\"snippet-container\"><a href=\"#\" class=\"snippet-copy\" onclick=\"copySni\\\n+                    ppet(this)\" aria-label=\"Copy\" data-copied=\"Copied!\"><img src=\"..\/copy.svg\" alt=\"\\\n+                    Copy\"><\/a>\n@@ -1630,0 +1645,3 @@\n+                    <div class=\"snippet-container\"><a href=\"#\" class=\"snippet-copy\" onclick=\"copySni\\\n+                    ppet(this)\" aria-label=\"Copy\" data-copied=\"Copied!\"><img src=\"..\/copy.svg\" alt=\"\\\n+                    Copy\"><\/a>\n@@ -1729,0 +1747,3 @@\n+                        <div class=\"snippet-container\"><a href=\"#\" class=\"snippet-copy\" onclick=\"cop\\\n+                        ySnippet(this)\" aria-label=\"Copy\" data-copied=\"Copied!\"><img src=\"..\/copy.sv\\\n+                        g\" alt=\"Copy\"><\/a>\n@@ -1811,0 +1832,3 @@\n+                        <div class=\"snippet-container\"><a href=\"#\" class=\"snippet-copy\" onclick=\"cop\\\n+                        ySnippet(this)\" aria-label=\"Copy\" data-copied=\"Copied!\"><img src=\"..\/copy.sv\\\n+                        g\" alt=\"Copy\"><\/a>\n@@ -2141,0 +2165,3 @@\n+                        <div class=\"snippet-container\"><a href=\"#\" class=\"snippet-copy\" onclick=\"cop\\\n+                        ySnippet(this)\" aria-label=\"Copy\" data-copied=\"Copied!\"><img src=\"..\/copy.sv\\\n+                        g\" alt=\"Copy\"><\/a>\n","filename":"test\/langtools\/jdk\/javadoc\/doclet\/testSnippetTag\/TestSnippetTag.java","additions":27,"deletions":0,"binary":false,"changes":27,"status":"modified"},{"patch":"@@ -354,1 +354,1 @@\n-                if (name != null) {\n+                if (name != null && !name.isEmpty()) {\n@@ -371,1 +371,1 @@\n-                if (name != null && !id.declared) {\n+                if (name != null && !name.isEmpty() && !id.declared) {\n","filename":"test\/langtools\/jdk\/javadoc\/lib\/javadoc\/tester\/LinkChecker.java","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2012, 2020, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2012, 2021, Oracle and\/or its affiliates. All rights reserved.\n@@ -199,0 +199,1 @@\n+            \"copy.svg\",\n","filename":"test\/langtools\/jdk\/javadoc\/tool\/api\/basic\/APITest.java","additions":2,"deletions":1,"binary":false,"changes":3,"status":"modified"}]}