{"files":[{"patch":"@@ -105,0 +105,1 @@\n+#include <versionhelpers.h>\n@@ -1762,1 +1763,0 @@\n-  OSVERSIONINFOEX osvi;\n@@ -1767,10 +1767,1 @@\n-  \/\/ Use the GetVersionEx information to see if we're on a server or\n-  \/\/ workstation edition of Windows. Starting with Windows 8.1 we can't\n-  \/\/ trust the OS version information returned by this API.\n-  ZeroMemory(&osvi, sizeof(OSVERSIONINFOEX));\n-  osvi.dwOSVersionInfoSize = sizeof(OSVERSIONINFOEX);\n-  if (!GetVersionEx((OSVERSIONINFO *)&osvi)) {\n-    st->print_cr(\"Call to GetVersionEx failed\");\n-    return;\n-  }\n-  bool is_workstation = (osvi.wProductType == VER_NT_WORKSTATION);\n+  bool is_workstation = !IsWindowsServer();\n@@ -3919,15 +3910,1 @@\n-  OSVERSIONINFOEX oi;\n-  oi.dwOSVersionInfoSize = sizeof(OSVERSIONINFOEX);\n-  GetVersionEx((OSVERSIONINFO*)&oi);\n-  switch (oi.dwPlatformId) {\n-  case VER_PLATFORM_WIN32_NT:\n-    {\n-      int os_vers = oi.dwMajorVersion * 1000 + oi.dwMinorVersion;\n-      if (oi.wProductType == VER_NT_DOMAIN_CONTROLLER ||\n-          oi.wProductType == VER_NT_SERVER) {\n-        _is_windows_server = true;\n-      }\n-    }\n-    break;\n-  default: fatal(\"Unknown platform\");\n-  }\n+  _is_windows_server = IsWindowsServer();\n","filename":"src\/hotspot\/os\/windows\/os_windows.cpp","additions":3,"deletions":26,"binary":false,"changes":29,"status":"modified"}]}