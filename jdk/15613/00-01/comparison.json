{"files":[{"patch":"@@ -381,2 +381,6 @@\n-      \/\/ do not emit fence if it's not at least a StoreLoad fence\n-      if (!((predecessor & w) && (successor & r))) {\n+      if (pred_succ_to_membar_mask(predecessor, successor) & StoreLoad) {\n+        \/\/ TSO allows for stores to be reordered after loads. When the compiler\n+        \/\/ generates a fence to disallow that, we are required to generate the\n+        \/\/ fence for correctness.\n+      } else {\n+        \/\/ TSO guarantees other fences already.\n","filename":"src\/hotspot\/cpu\/riscv\/macroAssembler_riscv.hpp","additions":6,"deletions":2,"binary":false,"changes":8,"status":"modified"}]}