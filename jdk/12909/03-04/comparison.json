{"files":[{"patch":"@@ -8105,1 +8105,1 @@\n-    assert(shift_count % 4U == 0, \"\");\n+    int vlen_in_bytes = Matcher::vector_length_in_bytes(this);\n@@ -8107,0 +8107,2 @@\n+    assert(shift_count % 4U == 0, \"\");\n+    assert(shift_count != vlen_in_bytes, \"\");\n","filename":"src\/hotspot\/cpu\/x86\/x86.ad","additions":3,"deletions":1,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -1991,0 +1991,16 @@\n+Node* VectorSliceNode::Identity(PhaseGVN* phase) {\n+  const TypeInt* origin = phase->type(in(3))->isa_int();\n+  if (origin == nullptr) {\n+    return this;\n+  }\n+\n+  \/\/ (VectorSlice X Y 0) => X\n+  \/\/ (VectorSlice X Y VLENGTH) => Y\n+  if (origin->is_con(0)) {\n+    return in(1);\n+  } else if (origin->is_con(Matcher::vector_length(this))) {\n+    return in(2);\n+  }\n+  return this;\n+}\n+\n","filename":"src\/hotspot\/share\/opto\/vectornode.cpp","additions":16,"deletions":0,"binary":false,"changes":16,"status":"modified"},{"patch":"@@ -1468,0 +1468,1 @@\n+  virtual Node* Identity(PhaseGVN* phase);\n","filename":"src\/hotspot\/share\/opto\/vectornode.hpp","additions":1,"deletions":0,"binary":false,"changes":1,"status":"modified"},{"patch":"@@ -327,1 +327,1 @@\n-    @IR(counts = {IRNode.VECTOR_SLICE, \"9\"})\n+    @IR(counts = {IRNode.VECTOR_SLICE, \"7\"}, applyIfCPUFeature = {\"sse2\", \"true\"})\n@@ -342,1 +342,1 @@\n-    @IR(counts = {IRNode.VECTOR_SLICE, \"17\"})\n+    @IR(counts = {IRNode.VECTOR_SLICE, \"15\"}, applyIfCPUFeature = {\"sse2\", \"true\"})\n@@ -365,1 +365,1 @@\n-    @IR(counts = {IRNode.VECTOR_SLICE, \"33\"}, applyIfCPUFeature = {\"avx2\", \"true\"})\n+    @IR(counts = {IRNode.VECTOR_SLICE, \"31\"}, applyIfCPUFeature = {\"avx2\", \"true\"})\n@@ -404,1 +404,1 @@\n-    @IR(counts = {IRNode.VECTOR_SLICE, \"65\"}, applyIfCPUFeature = {\"avx512bw\", \"true\"})\n+    @IR(counts = {IRNode.VECTOR_SLICE, \"63\"}, applyIfCPUFeature = {\"avx512bw\", \"true\"})\n@@ -475,1 +475,1 @@\n-    @IR(counts = {IRNode.VECTOR_SLICE, \"5\"})\n+    @IR(counts = {IRNode.VECTOR_SLICE, \"3\"}, applyIfCPUFeature = {\"sse2\", \"true\"})\n@@ -486,1 +486,1 @@\n-    @IR(counts = {IRNode.VECTOR_SLICE, \"9\"})\n+    @IR(counts = {IRNode.VECTOR_SLICE, \"7\"}, applyIfCPUFeature = {\"sse2\", \"true\"})\n@@ -501,1 +501,1 @@\n-    @IR(counts = {IRNode.VECTOR_SLICE, \"17\"}, applyIfCPUFeature = {\"avx2\", \"true\"})\n+    @IR(counts = {IRNode.VECTOR_SLICE, \"15\"}, applyIfCPUFeature = {\"avx2\", \"true\"})\n@@ -524,1 +524,1 @@\n-    @IR(counts = {IRNode.VECTOR_SLICE, \"33\"}, applyIfCPUFeature = {\"avx512bw\", \"true\"})\n+    @IR(counts = {IRNode.VECTOR_SLICE, \"31\"}, applyIfCPUFeature = {\"avx512bw\", \"true\"})\n@@ -563,1 +563,1 @@\n-    @IR(counts = {IRNode.VECTOR_SLICE, \"3\"})\n+    @IR(counts = {IRNode.VECTOR_SLICE, \"1\"}, applyIfCPUFeature = {\"sse2\", \"true\"})\n@@ -572,1 +572,1 @@\n-    @IR(counts = {IRNode.VECTOR_SLICE, \"5\"})\n+    @IR(counts = {IRNode.VECTOR_SLICE, \"3\"}, applyIfCPUFeature = {\"sse2\", \"true\"})\n@@ -583,1 +583,1 @@\n-    @IR(counts = {IRNode.VECTOR_SLICE, \"9\"}, applyIfCPUFeature = {\"avx2\", \"true\"})\n+    @IR(counts = {IRNode.VECTOR_SLICE, \"7\"}, applyIfCPUFeature = {\"avx2\", \"true\"})\n@@ -598,1 +598,1 @@\n-    @IR(counts = {IRNode.VECTOR_SLICE, \"17\"}, applyIfCPUFeature = {\"avx512f\", \"true\"})\n+    @IR(counts = {IRNode.VECTOR_SLICE, \"15\"}, applyIfCPUFeature = {\"avx512f\", \"true\"})\n@@ -621,1 +621,1 @@\n-    @IR(counts = {IRNode.VECTOR_SLICE, \"3\"})\n+    @IR(counts = {IRNode.VECTOR_SLICE, \"1\"}, applyIfCPUFeature = {\"sse2\", \"true\"})\n@@ -630,1 +630,1 @@\n-    @IR(counts = {IRNode.VECTOR_SLICE, \"5\"}, applyIfCPUFeature = {\"avx2\", \"true\"})\n+    @IR(counts = {IRNode.VECTOR_SLICE, \"3\"}, applyIfCPUFeature = {\"avx2\", \"true\"})\n@@ -641,1 +641,1 @@\n-    @IR(counts = {IRNode.VECTOR_SLICE, \"9\"}, applyIfCPUFeature = {\"avx512f\", \"true\"})\n+    @IR(counts = {IRNode.VECTOR_SLICE, \"7\"}, applyIfCPUFeature = {\"avx512f\", \"true\"})\n@@ -656,1 +656,1 @@\n-    @IR(counts = {IRNode.VECTOR_SLICE, \"3\"})\n+    @IR(counts = {IRNode.VECTOR_SLICE, \"1\"}, applyIfCPUFeature = {\"sse2\", \"true\"})\n@@ -665,1 +665,1 @@\n-    @IR(counts = {IRNode.VECTOR_SLICE, \"5\"})\n+    @IR(counts = {IRNode.VECTOR_SLICE, \"3\"}, applyIfCPUFeature = {\"sse2\", \"true\"})\n@@ -676,1 +676,1 @@\n-    @IR(counts = {IRNode.VECTOR_SLICE, \"9\"}, applyIfCPUFeature = {\"avx\", \"true\"})\n+    @IR(counts = {IRNode.VECTOR_SLICE, \"7\"}, applyIfCPUFeature = {\"avx\", \"true\"})\n@@ -691,1 +691,1 @@\n-    @IR(counts = {IRNode.VECTOR_SLICE, \"17\"}, applyIfCPUFeature = {\"avx512f\", \"true\"})\n+    @IR(counts = {IRNode.VECTOR_SLICE, \"15\"}, applyIfCPUFeature = {\"avx512f\", \"true\"})\n@@ -714,1 +714,1 @@\n-    @IR(counts = {IRNode.VECTOR_SLICE, \"3\"})\n+    @IR(counts = {IRNode.VECTOR_SLICE, \"1\"}, applyIfCPUFeature = {\"sse2\", \"true\"})\n@@ -723,1 +723,1 @@\n-    @IR(counts = {IRNode.VECTOR_SLICE, \"5\"}, applyIfCPUFeature = {\"avx\", \"true\"})\n+    @IR(counts = {IRNode.VECTOR_SLICE, \"3\"}, applyIfCPUFeature = {\"avx\", \"true\"})\n@@ -734,1 +734,1 @@\n-    @IR(counts = {IRNode.VECTOR_SLICE, \"9\"}, applyIfCPUFeature = {\"avx512f\", \"true\"})\n+    @IR(counts = {IRNode.VECTOR_SLICE, \"7\"}, applyIfCPUFeature = {\"avx512f\", \"true\"})\n","filename":"test\/hotspot\/jtreg\/compiler\/vectorapi\/TestVectorSlice.java","additions":22,"deletions":22,"binary":false,"changes":44,"status":"modified"}]}