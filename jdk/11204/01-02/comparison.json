{"files":[{"patch":"@@ -385,6 +385,4 @@\n-    if (!java_lang_VirtualThread ::notify_jvmti_events()) {\n-      java_lang_VirtualThread::set_notify_jvmti_events(true);\n-      if (Thread::current_or_null() != NULL) { \/\/ need this for attached threads only\n-        ThreadInVMfromNative tiv(JavaThread::current());\n-        java_lang_VirtualThread::init_static_notify_jvmti_events();\n-      }\n+    java_lang_VirtualThread::set_notify_jvmti_events(true);\n+    if (JvmtiEnv::get_phase() == JVMTI_PHASE_LIVE) {\n+      ThreadInVMfromNative __tiv(JavaThread::current());\n+      java_lang_VirtualThread::init_static_notify_jvmti_events();\n","filename":"src\/hotspot\/share\/prims\/jvmtiExport.cpp","additions":4,"deletions":6,"binary":false,"changes":10,"status":"modified"}]}