{"files":[{"patch":"@@ -398,6 +398,2 @@\n-  \/\/ Mark\n-  {\n-    ShenandoahConcurrentMark mark;\n-\n-    \/\/ Start initial mark under STW\n-    heap->vmop_entry_init_mark(&mark);\n+  \/\/ Start initial mark under STW\n+  heap->vmop_entry_init_mark();\n@@ -405,3 +401,3 @@\n-    \/\/ Concurrent mark roots\n-    heap->entry_mark_roots(&mark);\n-    if (check_cancellation_or_degen(ShenandoahHeap::_degenerated_outside_cycle)) return;\n+  \/\/ Concurrent mark roots\n+  heap->entry_mark_roots();\n+  if (check_cancellation_or_degen(ShenandoahHeap::_degenerated_outside_cycle)) return;\n@@ -409,3 +405,3 @@\n-    \/\/ Continue concurrent mark\n-    heap->entry_mark(&mark);\n-    if (check_cancellation_or_degen(ShenandoahHeap::_degenerated_mark)) return;\n+  \/\/ Continue concurrent mark\n+  heap->entry_mark();\n+  if (check_cancellation_or_degen(ShenandoahHeap::_degenerated_mark)) return;\n@@ -413,3 +409,2 @@\n-    \/\/ Complete marking under STW, and start evacuation\n-    heap->vmop_entry_final_mark(&mark);\n-  }\n+  \/\/ Complete marking under STW, and start evacuation\n+  heap->vmop_entry_final_mark();\n","filename":"src\/hotspot\/share\/gc\/shenandoah\/shenandoahControlThread.cpp","additions":10,"deletions":15,"binary":false,"changes":25,"status":"modified"},{"patch":"@@ -1570,1 +1570,1 @@\n-void ShenandoahHeap::op_init_mark(ShenandoahConcurrentMark* mark) {\n+void ShenandoahHeap::op_init_mark() {\n@@ -1609,1 +1609,2 @@\n-  mark->mark_stw_roots();\n+  ShenandoahConcurrentMark mark;\n+  mark.mark_stw_roots();\n@@ -1623,2 +1624,3 @@\n-void ShenandoahHeap::op_mark_roots(ShenandoahConcurrentMark* mark) {\n-  mark->mark_concurrent_roots();\n+void ShenandoahHeap::op_mark_roots() {\n+  ShenandoahConcurrentMark mark;\n+  mark.mark_concurrent_roots();\n@@ -1627,2 +1629,3 @@\n-void ShenandoahHeap::op_mark(ShenandoahConcurrentMark* mark) {\n-  mark->concurrent_mark();\n+void ShenandoahHeap::op_mark() {\n+  ShenandoahConcurrentMark mark;\n+  mark.concurrent_mark();\n@@ -1678,1 +1681,1 @@\n-void ShenandoahHeap::op_final_mark(ShenandoahConcurrentMark* mark) {\n+void ShenandoahHeap::op_final_mark() {\n@@ -1683,1 +1686,1 @@\n-    finish_mark(mark);\n+    finish_mark();\n@@ -1741,1 +1744,1 @@\n-void ShenandoahHeap::finish_mark(ShenandoahConcurrentMark* mark) {\n+void ShenandoahHeap::finish_mark() {\n@@ -1743,1 +1746,2 @@\n-  mark->finish_mark();\n+  ShenandoahConcurrentMark mark;\n+  mark.finish_mark();\n@@ -2196,2 +2200,1 @@\n-        ShenandoahConcurrentMark mark;\n-        finish_mark(&mark);\n+        finish_mark();\n@@ -2927,1 +2930,1 @@\n-void ShenandoahHeap::vmop_entry_init_mark(ShenandoahConcurrentMark* mark) {\n+void ShenandoahHeap::vmop_entry_init_mark() {\n@@ -2932,1 +2935,1 @@\n-  VM_ShenandoahInitMark op(mark);\n+  VM_ShenandoahInitMark op;\n@@ -2936,1 +2939,1 @@\n-void ShenandoahHeap::vmop_entry_final_mark(ShenandoahConcurrentMark* mark) {\n+void ShenandoahHeap::vmop_entry_final_mark() {\n@@ -2941,1 +2944,1 @@\n-  VM_ShenandoahFinalMarkStartEvac op(mark);\n+  VM_ShenandoahFinalMarkStartEvac op;\n@@ -2980,1 +2983,1 @@\n-void ShenandoahHeap::entry_init_mark(ShenandoahConcurrentMark* mark) {\n+void ShenandoahHeap::entry_init_mark() {\n@@ -2989,1 +2992,1 @@\n-  op_init_mark(mark);\n+  op_init_mark();\n@@ -2992,1 +2995,1 @@\n-void ShenandoahHeap::entry_final_mark(ShenandoahConcurrentMark* mark) {\n+void ShenandoahHeap::entry_final_mark() {\n@@ -3001,1 +3004,1 @@\n-  op_final_mark(mark);\n+  op_final_mark();\n@@ -3053,1 +3056,1 @@\n-void ShenandoahHeap::entry_mark_roots(ShenandoahConcurrentMark* mark) {\n+void ShenandoahHeap::entry_mark_roots() {\n@@ -3065,1 +3068,1 @@\n-  op_mark_roots(mark);\n+  op_mark_roots();\n@@ -3068,1 +3071,1 @@\n-void ShenandoahHeap::entry_mark(ShenandoahConcurrentMark* mark) {\n+void ShenandoahHeap::entry_mark() {\n@@ -3080,1 +3083,1 @@\n-  op_mark(mark);\n+  op_mark();\n","filename":"src\/hotspot\/share\/gc\/shenandoah\/shenandoahHeap.cpp","additions":27,"deletions":24,"binary":false,"changes":51,"status":"modified"},{"patch":"@@ -51,1 +51,0 @@\n-class ShenandoahMarkCompact;\n@@ -59,2 +58,0 @@\n-class ShenandoahConcurrentMark;\n-class ShenandoahMarkCompact;\n@@ -372,2 +369,2 @@\n-  void vmop_entry_init_mark(ShenandoahConcurrentMark* mark);\n-  void vmop_entry_final_mark(ShenandoahConcurrentMark* mark);\n+  void vmop_entry_init_mark();\n+  void vmop_entry_final_mark();\n@@ -381,2 +378,2 @@\n-  void entry_init_mark(ShenandoahConcurrentMark* mark);\n-  void entry_final_mark(ShenandoahConcurrentMark* mark);\n+  void entry_init_mark();\n+  void entry_final_mark();\n@@ -391,2 +388,2 @@\n-  void entry_mark_roots(ShenandoahConcurrentMark* mark);\n-  void entry_mark(ShenandoahConcurrentMark* mark);\n+  void entry_mark_roots();\n+  void entry_mark();\n@@ -407,2 +404,2 @@\n-  void op_init_mark(ShenandoahConcurrentMark* mark);\n-  void op_final_mark(ShenandoahConcurrentMark* mark);\n+  void op_init_mark();\n+  void op_final_mark();\n@@ -417,2 +414,2 @@\n-  void op_mark_roots(ShenandoahConcurrentMark* mark);\n-  void op_mark(ShenandoahConcurrentMark* mark);\n+  void op_mark_roots();\n+  void op_mark();\n@@ -442,1 +439,1 @@\n-  void finish_mark(ShenandoahConcurrentMark* mark);\n+  void finish_mark();\n","filename":"src\/hotspot\/share\/gc\/shenandoah\/shenandoahHeap.hpp","additions":11,"deletions":14,"binary":false,"changes":25,"status":"modified"},{"patch":"@@ -46,1 +46,1 @@\n-  ShenandoahHeap::heap()->entry_init_mark(_mark);\n+  ShenandoahHeap::heap()->entry_init_mark();\n@@ -51,1 +51,1 @@\n-  ShenandoahHeap::heap()->entry_final_mark(_mark);\n+  ShenandoahHeap::heap()->entry_final_mark();\n","filename":"src\/hotspot\/share\/gc\/shenandoah\/shenandoahVMOperations.cpp","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -30,2 +30,0 @@\n-class ShenandoahConcurrentMark;\n-\n@@ -57,2 +55,0 @@\n-private:\n-  ShenandoahConcurrentMark* const _mark;\n@@ -60,3 +56,1 @@\n-  VM_ShenandoahInitMark(ShenandoahConcurrentMark* mark) :\n-    VM_ShenandoahOperation(),\n-    _mark(mark) {};\n+  VM_ShenandoahInitMark() : VM_ShenandoahOperation() {}\n@@ -69,2 +63,0 @@\n-private:\n-  ShenandoahConcurrentMark* const _mark;\n@@ -72,3 +64,1 @@\n-  VM_ShenandoahFinalMarkStartEvac(ShenandoahConcurrentMark* mark) :\n-    VM_ShenandoahOperation(),\n-    _mark(mark) {};\n+  VM_ShenandoahFinalMarkStartEvac() : VM_ShenandoahOperation() {}\n","filename":"src\/hotspot\/share\/gc\/shenandoah\/shenandoahVMOperations.hpp","additions":2,"deletions":12,"binary":false,"changes":14,"status":"modified"}]}