{"files":[{"patch":"@@ -1711,1 +1711,1 @@\n-void C2_MacroAssembler::rvv_vsetvli(BasicType bt, int length_in_bytes, Register tmp) {\n+void C2_MacroAssembler::rvv_vsetvli(BasicType bt, int length_in_bytes, LMUL vlmul, Register tmp) {\n@@ -1714,1 +1714,1 @@\n-    vsetvli(tmp, x0, sew);\n+    vsetvli(tmp, x0, sew, vlmul);\n@@ -1718,1 +1718,1 @@\n-      vsetivli(tmp, num_elements, sew);\n+      vsetivli(tmp, num_elements, sew, vlmul);\n@@ -1721,1 +1721,1 @@\n-      vsetvli(tmp, tmp, sew);\n+      vsetvli(tmp, tmp, sew, vlmul);\n@@ -1787,1 +1787,1 @@\n-void C2_MacroAssembler::vector_integer_extend(VectorRegister dst, BasicType dst_bt,\n+void C2_MacroAssembler::vector_integer_extend(VectorRegister dst, BasicType dst_bt, int length_in_bytes,\n@@ -1797,2 +1797,1 @@\n-  Assembler::SEW sew = Assembler::elemtype_to_sew(dst_bt);\n-  vsetvli(t0, x0, sew);\n+  rvv_vsetvli(dst_bt, length_in_bytes);\n","filename":"src\/hotspot\/cpu\/riscv\/c2_MacroAssembler_riscv.cpp","additions":6,"deletions":7,"binary":false,"changes":13,"status":"modified"},{"patch":"@@ -201,1 +201,1 @@\n- void rvv_vsetvli(BasicType bt, int length_in_bytes, Register tmp = t0);\n+ void rvv_vsetvli(BasicType bt, int length_in_bytes, LMUL vlmul = Assembler::m1, Register tmp = t0);\n@@ -233,1 +233,1 @@\n-  void vector_integer_extend(VectorRegister dst, BasicType dst_bt,\n+  void vector_integer_extend(VectorRegister dst, BasicType dst_bt, int length_in_bytes,\n","filename":"src\/hotspot\/cpu\/riscv\/c2_MacroAssembler_riscv.hpp","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -2687,1 +2687,1 @@\n-                               as_VectorRegister($src$$reg), T_BYTE);\n+                               Matcher::vector_length_in_bytes(this), as_VectorRegister($src$$reg), T_BYTE);\n@@ -2690,2 +2690,2 @@\n-      __ vector_integer_extend(as_VectorRegister($dst$$reg), bt,\n-                               as_VectorRegister($src$$reg), T_BYTE);\n+      __ vector_integer_extend(as_VectorRegister($dst$$reg), bt, \n+                               Matcher::vector_length_in_bytes(this), as_VectorRegister($src$$reg), T_BYTE);\n@@ -2720,1 +2720,1 @@\n-                               as_VectorRegister($src$$reg), T_SHORT);\n+                               Matcher::vector_length_in_bytes(this), as_VectorRegister($src$$reg), T_SHORT);\n@@ -2724,1 +2724,1 @@\n-                               as_VectorRegister($src$$reg), T_SHORT);\n+                               Matcher::vector_length_in_bytes(this), as_VectorRegister($src$$reg), T_SHORT);\n@@ -2754,1 +2754,1 @@\n-      __ vsetvli(t0, x0, Assembler::e32);\n+      __ rvv_vsetvli(bt, Matcher::vector_length_in_bytes(this));\n@@ -2758,1 +2758,1 @@\n-                               as_VectorRegister($src$$reg), T_INT);\n+                               Matcher::vector_length_in_bytes(this), as_VectorRegister($src$$reg), T_INT);\n@@ -2802,1 +2802,1 @@\n-    __ vsetvli(t0, x0, Assembler::e64);\n+    __ rvv_vsetvli(T_DOUBLE, Matcher::vector_length_in_bytes(this));\n@@ -2817,1 +2817,1 @@\n-    __ vsetvli(t0, x0, Assembler::e32);\n+    __ rvv_vsetvli(T_FLOAT, Matcher::vector_length_in_bytes(this, $src));\n@@ -2832,1 +2832,1 @@\n-    __ vsetvli(t0, x0, Assembler::e32);\n+    __ rvv_vsetvli(T_FLOAT, Matcher::vector_length_in_bytes(this, $src));\n@@ -2837,1 +2837,1 @@\n-                               as_VectorRegister($dst$$reg), T_INT);\n+                               Matcher::vector_length_in_bytes(this), as_VectorRegister($dst$$reg), T_INT);\n@@ -2849,1 +2849,1 @@\n-    __ vsetvli(t0, x0, Assembler::e32, Assembler::mf2);\n+    __ rvv_vsetvli(T_FLOAT, Matcher::vector_length_in_bytes(this, $src), Assembler::mf2);\n@@ -2865,1 +2865,1 @@\n-    __ vsetvli(t0, x0, Assembler::e64);\n+    __ rvv_vsetvli(T_DOUBLE, Matcher::vector_length_in_bytes(this, $src));\n@@ -2879,1 +2879,1 @@\n-    __ vsetvli(t0, x0, Assembler::e64);\n+    __ rvv_vsetvli(T_LONG, Matcher::vector_length_in_bytes(this));\n@@ -2891,1 +2891,1 @@\n-    __ vsetvli(t0, x0, Assembler::e32, Assembler::mf2);\n+    __ rvv_vsetvli(T_FLOAT, Matcher::vector_length_in_bytes(this), Assembler::mf2);\n","filename":"src\/hotspot\/cpu\/riscv\/riscv_v.ad","additions":15,"deletions":15,"binary":false,"changes":30,"status":"modified"}]}