{"files":[{"patch":"@@ -552,2 +552,2 @@\n-    \/\/ Assume that the underlying kernel sendfile\/equivalent will work if the target\n-    \/\/ fd is a file; set this to true if we find out later that it doesn't\n+    \/\/ Assume at first that the underlying kernel supports copy_file_range\/equivalent;\n+    \/\/ set this to true if we find out later that it doesn't\n@@ -555,1 +555,1 @@\n-    private static volatile boolean transferToFileDirectNotSupported;\n+    private static volatile boolean transferFromDirectNotSupported;\n@@ -644,3 +644,0 @@\n-        if (transferToFileDirectNotSupported)\n-            return IOStatus.UNSUPPORTED_CASE;\n-\n@@ -656,8 +653,0 @@\n-                    if (n == IOStatus.UNSUPPORTED_CASE) {\n-                        transferToFileDirectNotSupported = true;\n-                        return IOStatus.UNSUPPORTED_CASE;\n-                    }\n-                    if (n == IOStatus.UNSUPPORTED) {\n-                        transferToDirectNotSupported = true;\n-                        return IOStatus.UNSUPPORTED;\n-                    }\n@@ -692,7 +681,0 @@\n-                    if (n == IOStatus.UNSUPPORTED_CASE) {\n-                        return IOStatus.UNSUPPORTED_CASE;\n-                    }\n-                    if (n == IOStatus.UNSUPPORTED) {\n-                        transferToDirectNotSupported = true;\n-                        return IOStatus.UNSUPPORTED;\n-                    }\n@@ -741,0 +723,1 @@\n+        long n;\n@@ -745,1 +728,1 @@\n-                    return transferToDirectInternal(position, count, target);\n+                    n = transferToDirectInternal(position, count, target);\n@@ -755,1 +738,4 @@\n-            return transferToDirectInternal(position, count, target);\n+            n = transferToDirectInternal(position, count, target);\n+        }\n+        if (n == IOStatus.UNSUPPORTED) {\n+            transferToDirectNotSupported = true;\n@@ -757,0 +743,1 @@\n+        return n;\n@@ -906,6 +893,0 @@\n-\n-    \/\/ Assume at first that the underlying kernel supports copy_file_range();\n-    \/\/ set this to true if we find out later that it doesn't\n-    \/\/\n-    private static volatile boolean transferFromDirectNotSupported;\n-\n","filename":"src\/java.base\/share\/classes\/sun\/nio\/ch\/FileChannelImpl.java","additions":10,"deletions":29,"binary":false,"changes":39,"status":"modified"}]}