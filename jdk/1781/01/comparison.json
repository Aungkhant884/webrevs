{"files":[{"patch":"@@ -29,0 +29,3 @@\n+# Hook to include the corresponding custom file, if present.\n+$(eval $(call IncludeCustomExtension, common\/Modules.gmk))\n+\n@@ -30,7 +33,1 @@\n-#\n-# BOOT_MODULES are modules defined by the boot loader\n-# PLATFORM_MODULES are modules defined by the platform loader\n-# JRE_TOOL_MODULES are tools included in JRE and defined by the application loader\n-#\n-# All other modules not declared below are defined by the application loader\n-# and are not included in JRE.\n+# Setup module sets for classloaders\n@@ -38,6 +35,1 @@\n-BOOT_MODULES :=\n-PLATFORM_MODULES :=\n-JRE_TOOL_MODULES :=\n-UPGRADEABLE_MODULES :=\n-AGGREGATOR_MODULES :=\n-DOCS_MODULES :=\n+include $(TOPDIR)\/make\/conf\/module-sets-classloaders.conf\n@@ -45,2 +37,2 @@\n-# Hook to include the corresponding custom file, if present.\n-$(eval $(call IncludeCustomExtension, common\/Modules.gmk))\n+# Append platform-specific modules\n+PLATFORM_MODULES += $(PLATFORM_MODULES_$(OPENJDK_TARGET_OS))\n@@ -48,77 +40,5 @@\n-BOOT_MODULES += \\\n-    java.base \\\n-    java.datatransfer \\\n-    java.desktop \\\n-    java.instrument \\\n-    java.logging \\\n-    java.management \\\n-    java.management.rmi \\\n-    java.naming \\\n-    java.prefs \\\n-    java.rmi \\\n-    java.security.sasl \\\n-    java.xml \\\n-    jdk.incubator.foreign \\\n-    jdk.incubator.vector \\\n-    jdk.internal.vm.ci \\\n-    jdk.jfr \\\n-    jdk.management \\\n-    jdk.management.jfr \\\n-    jdk.management.agent \\\n-    jdk.net \\\n-    jdk.nio.mapmode \\\n-    jdk.sctp \\\n-    jdk.unsupported \\\n-    #\n-\n-# to be deprivileged\n-BOOT_MODULES += \\\n-    jdk.naming.rmi \\\n-    #\n-\n-# Modules that directly or indirectly requiring upgradeable modules\n-# should carefully be considered if it should be upgradeable or not.\n-UPGRADEABLE_MODULES += \\\n-    java.compiler \\\n-    jdk.aot \\\n-    jdk.internal.vm.compiler \\\n-    jdk.internal.vm.compiler.management \\\n-    #\n-\n-\n-AGGREGATOR_MODULES += \\\n-    java.se \\\n-    #\n-\n-PLATFORM_MODULES += \\\n-    $(UPGRADEABLE_MODULES) \\\n-    $(AGGREGATOR_MODULES)\n-    #\n-\n-PLATFORM_MODULES += \\\n-    java.net.http \\\n-    java.scripting \\\n-    java.security.jgss \\\n-    java.smartcardio \\\n-    java.sql \\\n-    java.sql.rowset \\\n-    java.transaction.xa \\\n-    java.xml.crypto \\\n-    jdk.accessibility \\\n-    jdk.charsets \\\n-    jdk.crypto.cryptoki \\\n-    jdk.crypto.ec \\\n-    jdk.dynalink \\\n-    jdk.httpserver \\\n-    jdk.jsobject \\\n-    jdk.localedata \\\n-    jdk.naming.dns \\\n-    jdk.security.auth \\\n-    jdk.security.jgss \\\n-    jdk.xml.dom \\\n-    jdk.zipfs \\\n-    #\n-\n-ifeq ($(call isTargetOs, windows), true)\n-  PLATFORM_MODULES += jdk.crypto.mscapi\n-endif\n+# Extend platform modules to also cover upgradeable and aggregator modules\n+PLATFORM_MODULES += $(UPGRADEABLE_MODULES) $(AGGREGATOR_MODULES)\n+\n+################################################################################\n+# Setup module sets for docs\n@@ -126,3 +46,1 @@\n-JRE_TOOL_MODULES += \\\n-    jdk.jdwp.agent \\\n-    #\n+include $(TOPDIR)\/make\/conf\/module-sets-docs.conf\n@@ -131,0 +49,1 @@\n+# Setup module sets needed by the build system\n@@ -132,64 +51,1 @@\n-# DOCS_MODULES defines the root modules for javadoc generation.\n-# All of their `require transitive` modules directly and indirectly will be included.\n-DOCS_MODULES += \\\n-    java.se \\\n-    java.smartcardio \\\n-    jdk.accessibility \\\n-    jdk.attach \\\n-    jdk.charsets \\\n-    jdk.compiler \\\n-    jdk.crypto.cryptoki \\\n-    jdk.crypto.ec \\\n-    jdk.dynalink \\\n-    jdk.editpad \\\n-    jdk.hotspot.agent \\\n-    jdk.httpserver \\\n-    jdk.jpackage \\\n-    jdk.incubator.vector \\\n-    jdk.jartool \\\n-    jdk.javadoc \\\n-    jdk.jcmd \\\n-    jdk.jconsole \\\n-    jdk.jdeps \\\n-    jdk.jdi \\\n-    jdk.jdwp.agent \\\n-    jdk.jfr \\\n-    jdk.jlink \\\n-    jdk.jsobject \\\n-    jdk.jshell \\\n-    jdk.jstatd \\\n-    jdk.incubator.foreign \\\n-    jdk.localedata \\\n-    jdk.management \\\n-    jdk.management.agent \\\n-    jdk.management.jfr \\\n-    jdk.naming.dns \\\n-    jdk.naming.rmi \\\n-    jdk.net \\\n-    jdk.nio.mapmode \\\n-    jdk.sctp \\\n-    jdk.security.auth \\\n-    jdk.security.jgss \\\n-    jdk.xml.dom \\\n-    jdk.zipfs \\\n-    #\n-\n-# These modules are included in the interim image which is used to run profiling\n-# before building the real images.\n-INTERIM_IMAGE_MODULES := java.base java.logging\n-\n-LANGTOOLS_MODULES := \\\n-    java.compiler \\\n-    jdk.compiler \\\n-    jdk.javadoc \\\n-    jdk.jdeps \\\n-    jdk.jshell \\\n-    #\n-\n-HOTSPOT_MODULES := \\\n-    jdk.aot \\\n-    jdk.hotspot.agent \\\n-    jdk.internal.vm.ci \\\n-    jdk.internal.vm.compiler \\\n-    jdk.internal.vm.compiler.management \\\n-    #\n+include $(TOPDIR)\/make\/conf\/module-sets-build.conf\n@@ -198,1 +54,2 @@\n-# Some platforms don't have the serviceability agent\n+# Depending on the configuration, we might need to filter out some modules that\n+# normally should have been included\n@@ -200,0 +57,1 @@\n+# Some platforms don't have the serviceability agent\n@@ -204,1 +62,0 @@\n-################################################################################\n@@ -206,1 +63,0 @@\n-\n@@ -211,1 +67,0 @@\n-################################################################################\n@@ -213,1 +68,0 @@\n-\n@@ -219,1 +73,0 @@\n-################################################################################\n@@ -221,1 +74,0 @@\n-\n@@ -226,1 +78,0 @@\n-################################################################################\n@@ -228,1 +79,0 @@\n-\n","filename":"make\/common\/Modules.gmk","additions":18,"deletions":168,"binary":false,"changes":186,"status":"modified"},{"patch":"@@ -0,0 +1,52 @@\n+#\n+# Copyright (c) 2014, 2020, Oracle and\/or its affiliates. All rights reserved.\n+# DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+#\n+# This code is free software; you can redistribute it and\/or modify it\n+# under the terms of the GNU General Public License version 2 only, as\n+# published by the Free Software Foundation.  Oracle designates this\n+# particular file as subject to the \"Classpath\" exception as provided\n+# by Oracle in the LICENSE file that accompanied this code.\n+#\n+# This code is distributed in the hope that it will be useful, but WITHOUT\n+# ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+# FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+# version 2 for more details (a copy is included in the LICENSE file that\n+# accompanied this code).\n+#\n+# You should have received a copy of the GNU General Public License version\n+# 2 along with this work; if not, write to the Free Software Foundation,\n+# Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n+#\n+# Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n+# or visit www.oracle.com if you need additional information or have any\n+# questions.\n+#\n+\n+################################################################################\n+# Module sets needed by the build system\n+\n+# These modules are included in the interim image which is used to run profiling\n+# before building the real images.\n+INTERIM_IMAGE_MODULES= \\\n+    java.base \\\n+    java.logging \\\n+    #\n+\n+# These targets require buildtools-langtools to process for gensrc\n+LANGTOOLS_MODULES= \\\n+    java.compiler \\\n+    jdk.compiler \\\n+    jdk.javadoc \\\n+    jdk.jdeps \\\n+    jdk.jshell \\\n+    #\n+\n+# These models require buildtools-hotspot to process for gensrc\n+HOTSPOT_MODULES= \\\n+    jdk.aot \\\n+    jdk.hotspot.agent \\\n+    jdk.internal.vm.ci \\\n+    jdk.internal.vm.compiler \\\n+    jdk.internal.vm.compiler.management \\\n+    #\n","filename":"make\/conf\/module-sets-build.conf","additions":52,"deletions":0,"binary":false,"changes":52,"status":"added"},{"patch":"@@ -0,0 +1,104 @@\n+#\n+# Copyright (c) 2014, 2020, Oracle and\/or its affiliates. All rights reserved.\n+# DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+#\n+# This code is free software; you can redistribute it and\/or modify it\n+# under the terms of the GNU General Public License version 2 only, as\n+# published by the Free Software Foundation.  Oracle designates this\n+# particular file as subject to the \"Classpath\" exception as provided\n+# by Oracle in the LICENSE file that accompanied this code.\n+#\n+# This code is distributed in the hope that it will be useful, but WITHOUT\n+# ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+# FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+# version 2 for more details (a copy is included in the LICENSE file that\n+# accompanied this code).\n+#\n+# You should have received a copy of the GNU General Public License version\n+# 2 along with this work; if not, write to the Free Software Foundation,\n+# Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n+#\n+# Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n+# or visit www.oracle.com if you need additional information or have any\n+# questions.\n+#\n+\n+################################################################################\n+# BOOT_MODULES are modules defined by the boot loader\n+# PLATFORM_MODULES are modules defined by the platform loader\n+# JRE_TOOL_MODULES are tools included in JRE and defined by the application loader\n+#\n+# All other modules not declared below are defined by the application loader\n+# and are not included in JRE.\n+\n+BOOT_MODULES= \\\n+    java.base \\\n+    java.datatransfer \\\n+    java.desktop \\\n+    java.instrument \\\n+    java.logging \\\n+    java.management \\\n+    java.management.rmi \\\n+    java.naming \\\n+    java.prefs \\\n+    java.rmi \\\n+    java.security.sasl \\\n+    java.xml \\\n+    jdk.incubator.foreign \\\n+    jdk.incubator.vector \\\n+    jdk.internal.vm.ci \\\n+    jdk.jfr \\\n+    jdk.management \\\n+    jdk.management.jfr \\\n+    jdk.management.agent \\\n+    jdk.net \\\n+    jdk.nio.mapmode \\\n+    jdk.sctp \\\n+    jdk.unsupported \\\n+    jdk.naming.rmi \\\n+    #\n+\n+# Modules that directly or indirectly requiring upgradeable modules\n+# should carefully be considered if it should be upgradeable or not.\n+UPGRADEABLE_MODULES= \\\n+    java.compiler \\\n+    jdk.aot \\\n+    jdk.internal.vm.compiler \\\n+    jdk.internal.vm.compiler.management \\\n+    #\n+\n+AGGREGATOR_MODULES= \\\n+    java.se \\\n+    #\n+\n+PLATFORM_MODULES= \\\n+    java.net.http \\\n+    java.scripting \\\n+    java.security.jgss \\\n+    java.smartcardio \\\n+    java.sql \\\n+    java.sql.rowset \\\n+    java.transaction.xa \\\n+    java.xml.crypto \\\n+    jdk.accessibility \\\n+    jdk.charsets \\\n+    jdk.crypto.cryptoki \\\n+    jdk.crypto.ec \\\n+    jdk.dynalink \\\n+    jdk.httpserver \\\n+    jdk.jsobject \\\n+    jdk.localedata \\\n+    jdk.naming.dns \\\n+    jdk.security.auth \\\n+    jdk.security.jgss \\\n+    jdk.xml.dom \\\n+    jdk.zipfs \\\n+    #\n+\n+PLATFORM_MODULES_windows= \\\n+    jdk.crypto.mscapi \\\n+    #\n+\n+JRE_TOOL_MODULES= \\\n+    jdk.jdwp.agent \\\n+    #\n","filename":"make\/conf\/module-sets-classloaders.conf","additions":104,"deletions":0,"binary":false,"changes":104,"status":"added"},{"patch":"@@ -0,0 +1,72 @@\n+#\n+# Copyright (c) 2014, 2020, Oracle and\/or its affiliates. All rights reserved.\n+# DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+#\n+# This code is free software; you can redistribute it and\/or modify it\n+# under the terms of the GNU General Public License version 2 only, as\n+# published by the Free Software Foundation.  Oracle designates this\n+# particular file as subject to the \"Classpath\" exception as provided\n+# by Oracle in the LICENSE file that accompanied this code.\n+#\n+# This code is distributed in the hope that it will be useful, but WITHOUT\n+# ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+# FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+# version 2 for more details (a copy is included in the LICENSE file that\n+# accompanied this code).\n+#\n+# You should have received a copy of the GNU General Public License version\n+# 2 along with this work; if not, write to the Free Software Foundation,\n+# Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n+#\n+# Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n+# or visit www.oracle.com if you need additional information or have any\n+# questions.\n+#\n+\n+################################################################################\n+# Module sets needed to build docs.\n+#\n+# DOCS_MODULES defines the root modules for javadoc generation.\n+# All of their `require transitive` modules directly and indirectly will be included.\n+DOCS_MODULES= \\\n+    java.se \\\n+    java.smartcardio \\\n+    jdk.accessibility \\\n+    jdk.attach \\\n+    jdk.charsets \\\n+    jdk.compiler \\\n+    jdk.crypto.cryptoki \\\n+    jdk.crypto.ec \\\n+    jdk.dynalink \\\n+    jdk.editpad \\\n+    jdk.hotspot.agent \\\n+    jdk.httpserver \\\n+    jdk.jpackage \\\n+    jdk.incubator.vector \\\n+    jdk.jartool \\\n+    jdk.javadoc \\\n+    jdk.jcmd \\\n+    jdk.jconsole \\\n+    jdk.jdeps \\\n+    jdk.jdi \\\n+    jdk.jdwp.agent \\\n+    jdk.jfr \\\n+    jdk.jlink \\\n+    jdk.jsobject \\\n+    jdk.jshell \\\n+    jdk.jstatd \\\n+    jdk.incubator.foreign \\\n+    jdk.localedata \\\n+    jdk.management \\\n+    jdk.management.agent \\\n+    jdk.management.jfr \\\n+    jdk.naming.dns \\\n+    jdk.naming.rmi \\\n+    jdk.net \\\n+    jdk.nio.mapmode \\\n+    jdk.sctp \\\n+    jdk.security.auth \\\n+    jdk.security.jgss \\\n+    jdk.xml.dom \\\n+    jdk.zipfs \\\n+    #\n","filename":"make\/conf\/module-sets-docs.conf","additions":72,"deletions":0,"binary":false,"changes":72,"status":"added"}]}