{"files":[{"patch":"@@ -483,1 +483,3 @@\n-        MethodHandle[] filters = null;\n+        MethodHandle[] objFilters = null;\n+        MethodHandle[] floatFilters = null;\n+        MethodHandle[] doubleFilters = null;\n@@ -486,1 +488,3 @@\n-            MethodHandle filter = null;\n+            \/\/ Use int as the logical type for subword integral types\n+            \/\/ (byte and short). char and boolean require special\n+            \/\/ handling so don't change the logical type of those\n@@ -488,2 +492,0 @@\n-                \/\/ use int for subword integral types; still need special mixers\n-                \/\/ and prependers for char, boolean\n@@ -491,2 +493,11 @@\n-            } else if (cl == Object.class) {\n-                filter = objectStringifier();\n+            }\n+            \/\/ Object, float and double will be eagerly transformed\n+            \/\/ into a (non-null) String as a first step after invocation.\n+            \/\/ Set up to use String as the logical type for such arguments\n+            \/\/ internally.\n+            else if (cl == Object.class) {\n+                if (objFilters == null) {\n+                    objFilters = new MethodHandle[ptypes.length];\n+                }\n+                objFilters[i] = objectStringifier();\n+                ptypes[i] = String.class;\n@@ -494,1 +505,5 @@\n-                filter = floatStringifier();\n+                if (floatFilters == null) {\n+                    floatFilters = new MethodHandle[ptypes.length];\n+                }\n+                floatFilters[i] = floatStringifier();\n+                ptypes[i] = String.class;\n@@ -496,5 +511,2 @@\n-                filter = doubleStringifier();\n-            }\n-            if (filter != null) {\n-                if (filters == null) {\n-                    filters = new MethodHandle[ptypes.length];\n+                if (doubleFilters == null) {\n+                    doubleFilters = new MethodHandle[ptypes.length];\n@@ -502,1 +514,1 @@\n-                filters[i] = filter;\n+                doubleFilters[i] = doubleStringifier();\n@@ -570,2 +582,8 @@\n-        if (filters != null) {\n-            mh = MethodHandles.filterArguments(mh, 0, filters);\n+        if (objFilters != null) {\n+            mh = MethodHandles.filterArguments(mh, 0, objFilters);\n+        }\n+        if (floatFilters != null) {\n+            mh = MethodHandles.filterArguments(mh, 0, floatFilters);\n+        }\n+        if (doubleFilters != null) {\n+            mh = MethodHandles.filterArguments(mh, 0, doubleFilters);\n","filename":"src\/java.base\/share\/classes\/java\/lang\/invoke\/StringConcatFactory.java","additions":33,"deletions":15,"binary":false,"changes":48,"status":"modified"}]}