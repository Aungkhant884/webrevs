{"files":[{"patch":"@@ -40,0 +40,2 @@\n+import java.util.concurrent.CountDownLatch;\n+import java.util.concurrent.TimeUnit;\n@@ -60,2 +62,6 @@\n-    private volatile static Object focusLock = new Object();\n-    private volatile static int delay = 500;\n+    private volatile static int waitDelay = 500;\n+    private static final CountDownLatch butonFocusLatch = new CountDownLatch(1);\n+    private static final CountDownLatch checkboxFocusLatch =\n+        new CountDownLatch(1);\n+    private static final CountDownLatch choiceFocusLatch =\n+        new CountDownLatch(1);\n@@ -74,3 +80,0 @@\n-            synchronized (focusLock) {\n-                focusLock.notifyAll();\n-            }\n@@ -80,0 +83,43 @@\n+    private volatile static FocusListener choiceListener = new FocusListener() {\n+\n+        @Override\n+        public void focusLost(FocusEvent e) {\n+            System.out.println(e.getSource() + \": lost focus.\");\n+        }\n+\n+        @Override\n+        public void focusGained(FocusEvent e) {\n+            System.out.println(e.getSource() + \": gained focus.\");\n+            choiceFocusLatch.countDown();\n+        }\n+    };\n+\n+    private volatile static FocusListener butonListener = new FocusListener() {\n+\n+        @Override\n+        public void focusLost(FocusEvent e) {\n+            System.out.println(e.getSource() + \": lost focus.\");\n+        }\n+\n+        @Override\n+        public void focusGained(FocusEvent e) {\n+            System.out.println(e.getSource() + \": gained focus.\");\n+            butonFocusLatch.countDown();\n+        }\n+    };\n+\n+    private volatile static FocusListener checkboxListener =\n+        new FocusListener() {\n+\n+            @Override\n+            public void focusLost(FocusEvent e) {\n+                System.out.println(e.getSource() + \": lost focus.\");\n+            }\n+\n+            @Override\n+            public void focusGained(FocusEvent e) {\n+                System.out.println(e.getSource() + \": gained focus.\");\n+                checkboxFocusLatch.countDown();\n+            }\n+        };\n+\n@@ -84,1 +130,1 @@\n-        button.addFocusListener(listener);\n+        button.addFocusListener(butonListener);\n@@ -92,1 +138,1 @@\n-        choice.addFocusListener(listener);\n+        choice.addFocusListener(choiceListener);\n@@ -96,1 +142,1 @@\n-        checkbox.addFocusListener(listener);\n+        checkbox.addFocusListener(checkboxListener);\n@@ -126,1 +172,1 @@\n-            if (!button.hasFocus()) {\n+            if (!button.isFocusOwner()) {\n@@ -134,7 +180,1 @@\n-                if (!focusGained) {\n-                    synchronized (focusLock) {\n-                        focusLock.wait(delay * 10);\n-                    }\n-                }\n-\n-                if (!focusGained) {\n+                if (!butonFocusLatch.await(waitDelay, TimeUnit.MILLISECONDS)) {\n@@ -146,1 +186,0 @@\n-            focusGained = false;\n@@ -151,6 +190,0 @@\n-            if (!focusGained) {\n-                synchronized (focusLock) {\n-                    focusLock.wait(delay * 10);\n-                }\n-            }\n-\n@@ -162,1 +195,1 @@\n-            if (!focusGained) {\n+            if (!checkboxFocusLatch.await(waitDelay, TimeUnit.MILLISECONDS)) {\n@@ -165,1 +198,1 @@\n-                    + \"the focus to Checkbox\");\n+                        + \"the focus to Checkbox\");\n@@ -168,1 +201,1 @@\n-            if (!checkbox.hasFocus()) {\n+            if (!checkbox.isFocusOwner()) {\n@@ -170,2 +203,2 @@\n-                    \"FAIL: CheckBox.hasFocus for Checkbox returns false after calling\"\n-                        + \" Checkbox.requestFocusInWindow\");\n+                    \"FAIL: CheckBox.isFocusOwner for Checkbox returns false \"\n+                        + \"after calling Checkbox.requestFocusInWindow\");\n@@ -173,1 +206,0 @@\n-            focusGained = false;\n@@ -178,6 +210,0 @@\n-            if (!focusGained) {\n-                synchronized (focusLock) {\n-                    focusLock.wait(delay * 10);\n-                }\n-            }\n-\n@@ -187,1 +213,1 @@\n-                    + \" returned false\");\n+                        + \" returned false\");\n@@ -190,1 +216,1 @@\n-            if (!focusGained) {\n+            if (!choiceFocusLatch.await(waitDelay, TimeUnit.MILLISECONDS)) {\n@@ -193,1 +219,1 @@\n-                    + \" focus to disabled Choice\");\n+                        + \" focus to disabled Choice\");\n@@ -196,1 +222,1 @@\n-            if (!choice.hasFocus()) {\n+            if (!choice.isFocusOwner()) {\n@@ -198,2 +224,2 @@\n-                    \"FAIL: Choice.hasFocus for disabled Choice returns false\"\n-                    + \" after calling Choice.requestFocusInWindow\");\n+                    \"FAIL: Choice.isFocusOwner for disabled Choice returns false\"\n+                        + \" after calling Choice.requestFocusInWindow\");\n@@ -201,0 +227,1 @@\n+\n@@ -210,1 +237,1 @@\n-                    + \" hidden TextField\");\n+                        + \" hidden TextField\");\n@@ -217,1 +244,1 @@\n-            if (textField.hasFocus()) {\n+            if (textField.isFocusOwner()) {\n@@ -219,2 +246,2 @@\n-                    \"FAIL: TextField.hasFocus for hidden TextField returns true\"\n-                    + \" after calling TextField.requestFocusInWindow\");\n+                    \"FAIL: TextField.isFocusOwner for hidden TextField returns true\"\n+                        + \" after calling TextField.requestFocusInWindow\");\n@@ -233,1 +260,1 @@\n-                    + \" non-focusable List\");\n+                        + \" non-focusable List\");\n@@ -240,1 +267,1 @@\n-            if (list.hasFocus()) {\n+            if (list.isFocusOwner()) {\n@@ -242,2 +269,2 @@\n-                    \"FAIL: List.hasFocus for non-focusable List returns true\"\n-                    + \" after calling List.requestFocusInWindow\");\n+                    \"FAIL: List.isFocusOwner for non-focusable List returns true\"\n+                        + \" after calling List.requestFocusInWindow\");\n","filename":"test\/jdk\/java\/awt\/Focus\/RequestFocusOwnerTest\/RequestFocusOwnerTest.java","additions":76,"deletions":49,"binary":false,"changes":125,"status":"modified"}]}