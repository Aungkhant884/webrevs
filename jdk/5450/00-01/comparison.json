{"files":[{"patch":"@@ -26,0 +26,1 @@\n+\n@@ -32,13 +33,10 @@\n-struct {\n-  const char* _name;\n-  size_t _size;\n-} cds_offsets[] = {\n-  { \"CDSFileMapHeaderBase::_magic\",           offset_of(CDSFileMapHeaderBase, _magic)           },\n-  { \"CDSFileMapHeaderBase::_crc\",             offset_of(CDSFileMapHeaderBase, _crc)             },\n-  { \"CDSFileMapHeaderBase::_version\",         offset_of(CDSFileMapHeaderBase, _version)         },\n-  { \"CDSFileMapHeaderBase::_space[0]\",        offset_of(CDSFileMapHeaderBase, _space)           },\n-  { \"FileMapHeader::_jvm_ident\",              offset_of(FileMapHeader, _jvm_ident)              },\n-  { \"FileMapHeader::_base_archive_name_size\", offset_of(FileMapHeader, _base_archive_name_size) },\n-  { \"CDSFileMapRegion::_crc\",                 offset_of(CDSFileMapRegion, _crc)                 },\n-  { \"CDSFileMapRegion::_used\",                offset_of(CDSFileMapRegion, _used)                },\n-  { \"DynamicArchiveHeader::_base_region_crc\", offset_of(DynamicArchiveHeader, _base_region_crc) }\n+CDSConst CDSConstants::offsets[] = {\n+  { \"CDSFileMapHeaderBase::_magic\",           (int)offset_of(CDSFileMapHeaderBase, _magic)           },\n+  { \"CDSFileMapHeaderBase::_crc\",             (int)offset_of(CDSFileMapHeaderBase, _crc)             },\n+  { \"CDSFileMapHeaderBase::_version\",         (int)offset_of(CDSFileMapHeaderBase, _version)         },\n+  { \"CDSFileMapHeaderBase::_space[0]\",        (int)offset_of(CDSFileMapHeaderBase, _space)           },\n+  { \"FileMapHeader::_jvm_ident\",              (int)offset_of(FileMapHeader, _jvm_ident)              },\n+  { \"FileMapHeader::_base_archive_name_size\", (int)offset_of(FileMapHeader, _base_archive_name_size) },\n+  { \"CDSFileMapRegion::_crc\",                 (int)offset_of(CDSFileMapRegion, _crc)                 },\n+  { \"CDSFileMapRegion::_used\",                (int)offset_of(CDSFileMapRegion, _used)                },\n+  { \"DynamicArchiveHeader::_base_region_crc\", (int)offset_of(DynamicArchiveHeader, _base_region_crc) }\n@@ -47,4 +45,1 @@\n-constexpr struct {\n-  const char* _name;\n-  int         _value;\n-} cds_constants[] = {\n+CDSConst CDSConstants::constants[] = {\n@@ -60,4 +55,4 @@\n-size_t get_cds_offset(const char* name) {\n-  for (int i = 0; i < (int)(sizeof(cds_offsets)\/sizeof(cds_offsets[0])); i++) {\n-    if (strcmp(name, cds_offsets[i]._name) == 0) {\n-        return cds_offsets[i]._size;\n+int CDSConstants::get_cds_offset(const char* name) {\n+  for (int i = 0; i < (int)ARRAY_SIZE(offsets); i++) {\n+    if (strcmp(name, offsets[i]._name) == 0) {\n+        return offsets[i]._value;\n@@ -66,1 +61,1 @@\n-  return (size_t)-1;\n+  return -1;\n@@ -69,4 +64,4 @@\n-int get_cds_constant(const char* name) {\n-  for (int i = 0; i < (int)(sizeof(cds_constants)\/sizeof(cds_constants[0])); i++) {\n-    if (strcmp(name, cds_constants[i]._name) == 0) {\n-        return cds_constants[i]._value;\n+int CDSConstants::get_cds_constant(const char* name) {\n+  for (int i = 0; i < (int)ARRAY_SIZE(constants); i++) {\n+    if (strcmp(name, constants[i]._name) == 0) {\n+        return constants[i]._value;\n","filename":"src\/hotspot\/share\/cds\/cdsConstants.cpp","additions":21,"deletions":26,"binary":false,"changes":47,"status":"modified"},{"patch":"@@ -27,2 +27,14 @@\n-int    get_cds_constant(const char* name);\n-size_t get_cds_offset(const char* name);\n+\n+#include \"memory\/allStatic.hpp\"\n+typedef struct {\n+  const char* _name;\n+  int _value;\n+} CDSConst;\n+\n+class CDSConstants : AllStatic {\n+ public:\n+  static CDSConst offsets[];\n+  static CDSConst constants[];\n+  static int get_cds_constant(const char* name);\n+  static int get_cds_offset(const char* name);\n+};\n","filename":"src\/hotspot\/share\/cds\/cdsConstants.hpp","additions":14,"deletions":2,"binary":false,"changes":16,"status":"modified"},{"patch":"@@ -184,0 +184,1 @@\n+  friend class CDSConstants;\n@@ -211,1 +212,0 @@\n-public:\n@@ -215,1 +215,0 @@\n-private:\n","filename":"src\/hotspot\/share\/cds\/filemap.hpp","additions":1,"deletions":2,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -2022,1 +2022,1 @@\n-  jint result = (jint)get_cds_offset(c_name);\n+  jint result = (jint)CDSConstants::get_cds_offset(c_name);\n@@ -2029,1 +2029,1 @@\n-  jint result = (jint)get_cds_constant(c_name);\n+  jint result = (jint)CDSConstants::get_cds_constant(c_name);\n","filename":"src\/hotspot\/share\/prims\/whitebox.cpp","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"}]}