{"files":[{"patch":"@@ -32,0 +32,2 @@\n+import java.security.AccessController;\n+import java.security.PrivilegedAction;\n@@ -75,1 +77,8 @@\n-        Path system32 = Path.of(System.getenv(\"SystemRoot\"), \"System32\");\n+        @SuppressWarnings(\"removal\")\n+        String systemRoot = AccessController.doPrivileged(new PrivilegedAction<String>() {\n+            @Override\n+            public String run() {\n+                return System.getenv(\"SystemRoot\");\n+            }\n+        });\n+        Path system32 = Path.of(systemRoot, \"System32\");\n@@ -79,1 +88,7 @@\n-        boolean useUCRT = Files.exists(ucrtbase);\n+        @SuppressWarnings(\"removal\")\n+        boolean useUCRT = AccessController.doPrivileged(new PrivilegedAction<Boolean>() {\n+            @Override\n+            public Boolean run() {\n+                return Files.exists(ucrtbase);\n+            }\n+        });\n","filename":"src\/java.base\/share\/classes\/jdk\/internal\/foreign\/SystemLookup.java","additions":17,"deletions":2,"binary":false,"changes":19,"status":"modified"},{"patch":"@@ -30,0 +30,2 @@\n+ * @run testng\/othervm\/policy=security.policy\n+ *          -Djava.security.manager=default TestLinker\n","filename":"test\/jdk\/java\/foreign\/TestLinker.java","additions":2,"deletions":0,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -0,0 +1,7 @@\n+grant codeBase \"file:${test.classes}\/*\" {\n+    \/\/ Permissions needed to run the test\n+    permission java.util.PropertyPermission \"os.name\", \"read\";\n+    permission java.util.PropertyPermission \"NativeTestHelper.DEFAULT_RANDOM.seed\", \"read\";\n+    permission java.lang.RuntimePermission \"accessClassInPackage.jdk.internal.foreign\";\n+};\n+\n","filename":"test\/jdk\/java\/foreign\/security.policy","additions":7,"deletions":0,"binary":false,"changes":7,"status":"added"}]}