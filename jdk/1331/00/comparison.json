{"files":[{"patch":"@@ -221,1 +221,1 @@\n-            sb.append(String.format(\"in %s\", pb.directory().getAbsolutePath()));\n+            sb.append(String.format(\" in %s\", pb.directory().getAbsolutePath()));\n","filename":"src\/jdk.jpackage\/share\/classes\/jdk\/jpackage\/internal\/Executor.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -46,0 +46,1 @@\n+import java.util.regex.Matcher;\n@@ -838,0 +839,13 @@\n+    public static Stream<String> stripTimestamps(Stream<String> stream) {\n+        \/\/ [HH:mm:ss.SSS]\n+        final Pattern timestampRegexp = Pattern.compile(\n+                \"^\\\\[\\\\d\\\\d:\\\\d\\\\d:\\\\d\\\\d.\\\\d\\\\d\\\\d\\\\] \");\n+        return stream.map(str -> {\n+            Matcher m = timestampRegexp.matcher(str);\n+            if (m.find()) {\n+                str = str.substring(m.end());\n+            }\n+            return str;\n+        });\n+    }\n+\n","filename":"test\/jdk\/tools\/jpackage\/helpers\/jdk\/jpackage\/test\/JPackageCommand.java","additions":14,"deletions":0,"binary":false,"changes":14,"status":"modified"},{"patch":"@@ -0,0 +1,107 @@\n+\/*\n+ * Copyright (c) 2020, Oracle and\/or its affiliates. All rights reserved.\n+ * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+ *\n+ * This code is free software; you can redistribute it and\/or modify it\n+ * under the terms of the GNU General Public License version 2 only, as\n+ * published by the Free Software Foundation.\n+ *\n+ * This code is distributed in the hope that it will be useful, but WITHOUT\n+ * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+ * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+ * version 2 for more details (a copy is included in the LICENSE file that\n+ * accompanied this code).\n+ *\n+ * You should have received a copy of the GNU General Public License version\n+ * 2 along with this work; if not, write to the Free Software Foundation,\n+ * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n+ *\n+ * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n+ * or visit www.oracle.com if you need additional information or have any\n+ * questions.\n+ *\/\n+\n+package jdk.jpackage.tests;\n+\n+import jdk.jpackage.test.PackageTest;\n+import jdk.jpackage.test.PackageType;\n+import jdk.jpackage.test.Annotations.Test;\n+\n+\/**\n+ * Test --vendor parameter. Output of the test should be\n+ * vendortest*.* package bundle. The output package should provide the\n+ * same functionality as the default package with the default value of vendor\n+ * property overridden.\n+ *\n+ * Linux DEB:\n+ *\n+ * Value of \"Maintainer\" property of .deb package should start with \"Test Vendor\" string.\n+ *\n+ * Linux RPM:\n+ *\n+ * Value of \"Vendor\" property of .rpm package should be set to \"Test Vendor\" string.\n+ *\n+ * Mac:\n+ *\n+ * --vendor parameter is ignored.\n+ *\n+ * Windows:\n+ *\n+ * Publisher value displayed in the Add\/Remove Programs should be set\n+ * to \"Test Vendor\" string.\n+ *\/\n+\n+\/*\n+ * @test\n+ * @summary Test --vendor jpackage command option\n+ * @library ..\/..\/..\/..\/helpers\n+ * @key jpackagePlatformPackage\n+ * @requires (os.family == \"windows\")\n+ * @requires jpackage.test.SQETest != null\n+ * @build jdk.jpackage.test.*\n+ * @modules jdk.jpackage\/jdk.jpackage.internal\n+ * @compile VendorTest.java\n+ * @run main\/othervm\/timeout=360 -Xmx512m jdk.jpackage.test.Main\n+ *  --jpt-run=jdk.jpackage.tests.VendorTest\n+ *\/\n+\n+\/*\n+ * @test\n+ * @summary Test --vendor jpackage command option\n+ * @library ..\/..\/..\/..\/helpers\n+ * @key jpackagePlatformPackage\n+ * @requires (os.family != \"mac\")\n+ * @requires jpackage.test.SQETest == null\n+ * @build jdk.jpackage.test.*\n+ * @modules jdk.jpackage\/jdk.jpackage.internal\n+ * @compile VendorTest.java\n+ * @run main\/othervm\/timeout=360 -Xmx512m jdk.jpackage.test.Main\n+ *  --jpt-run=jdk.jpackage.tests.VendorTest\n+ *\/\n+public class VendorTest {\n+\n+    @Test\n+    public static void test() {\n+        final String vendorValue = \"Test Vendor\";\n+\n+        new PackageTest()\n+        .configureHelloApp()\n+        .addBundleDesktopIntegrationVerifier(false)\n+        .addInitializer(cmd -> {\n+            cmd.addArguments(\"--vendor\", vendorValue);\n+        })\n+        .forTypes(PackageType.LINUX_DEB)\n+        .addBundlePropertyVerifier(\"Maintainer\", value -> {\n+            return value.startsWith(vendorValue + \" \");\n+        }, \"starts with\")\n+        .forTypes(PackageType.LINUX_RPM)\n+        .addBundlePropertyVerifier(\"Vendor\", value -> {\n+            return value.equals(vendorValue);\n+        }, \"equals to\")\n+        .forTypes(PackageType.WIN_MSI)\n+        .addBundlePropertyVerifier(\"Manufacturer\", value -> {\n+            return value.equals(vendorValue);\n+        }, \"equals to\")\n+        .run();\n+    }\n+}\n","filename":"test\/jdk\/tools\/jpackage\/share\/jdk\/jpackage\/tests\/VendorTest.java","additions":107,"deletions":0,"binary":false,"changes":107,"status":"added"},{"patch":"@@ -29,0 +29,1 @@\n+import jdk.jpackage.test.JPackageCommand;\n@@ -88,1 +89,2 @@\n-                    .apply(result.getOutput().stream());\n+                    .apply(JPackageCommand.stripTimestamps(\n+                            result.getOutput().stream()));\n","filename":"test\/jdk\/tools\/jpackage\/windows\/WinResourceTest.java","additions":3,"deletions":1,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -127,1 +127,1 @@\n-            TKit.assertTextStream(String.format(\"jp: %s\", echoText))\n+            TKit.assertTextStream(String.format(\"    jp: %s\", echoText))\n@@ -131,1 +131,1 @@\n-            String cwdPattern = String.format(\"jp: CWD(%s)=\", envVarName);\n+            String cwdPattern = String.format(\"    jp: CWD(%s)=\", envVarName);\n@@ -138,1 +138,1 @@\n-            String envVarPattern = String.format(\"jp: %s=\", envVarName);\n+            String envVarPattern = String.format(\"    jp: %s=\", envVarName);\n","filename":"test\/jdk\/tools\/jpackage\/windows\/WinScriptTest.java","additions":3,"deletions":3,"binary":false,"changes":6,"status":"modified"}]}