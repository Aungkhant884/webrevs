{"files":[{"patch":"@@ -35,0 +35,1 @@\n+import java.lang.invoke.MethodHandles.Lookup.ClassOption;\n@@ -39,3 +40,0 @@\n-    \/\/ Prevent the following classes from being GC'ed too soon.\n-    static Class<?> keptC1 = null;\n-    static Class<?> keptC2 = null;\n@@ -70,6 +68,3 @@\n-        Class<?> c1 = lookup.defineHiddenClass(klassbuf, false, NESTMATE).lookupClass();\n-        Class<?> c2 = lookup.defineHiddenClass(klassbuf, false, NESTMATE).lookupClass();\n-        if (keepAlive) {\n-            keptC1 = c1;\n-            keptC2 = c2;\n-        }\n+        ClassOption classOption = keepAlive ? STRONG : NESTMATE;\n+        Class<?> c1 = lookup.defineHiddenClass(klassbuf, false, classOption).lookupClass();\n+        Class<?> c2 = lookup.defineHiddenClass(klassbuf, false, classOption).lookupClass();\n","filename":"test\/hotspot\/jtreg\/runtime\/HiddenClasses\/InstantiateHiddenClass.java","additions":4,"deletions":9,"binary":false,"changes":13,"status":"modified"}]}