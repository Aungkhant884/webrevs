{"files":[{"patch":"@@ -413,2 +413,2 @@\n-ifneq ($(filter docs-bundles, $(MAKECMDGOALS)), )\n-  DOCS_BUNDLE_FILES := $(call FindFiles, $(DOCS_IMAGE_DIR))\n+ifneq ($(filter docs-jdk-bundles, $(MAKECMDGOALS)), )\n+  DOCS_JDK_BUNDLE_FILES := $(call FindFiles, $(DOCS_JDK_IMAGE_DIR))\n@@ -416,4 +416,4 @@\n-  $(eval $(call SetupBundleFile, BUILD_DOCS_BUNDLE, \\\n-      BUNDLE_NAME := $(DOCS_BUNDLE_NAME), \\\n-      FILES := $(DOCS_BUNDLE_FILES), \\\n-      BASE_DIRS := $(DOCS_IMAGE_DIR), \\\n+  $(eval $(call SetupBundleFile, BUILD_DOCS_JDK_BUNDLE, \\\n+      BUNDLE_NAME := $(DOCS_JDK_BUNDLE_NAME), \\\n+      FILES := $(DOCS_JDK_BUNDLE_FILES), \\\n+      BASE_DIRS := $(DOCS_JDK_IMAGE_DIR), \\\n@@ -423,1 +423,27 @@\n-  DOCS_TARGETS += $(BUILD_DOCS_BUNDLE)\n+  DOCS_JDK_TARGETS += $(BUILD_DOCS_JDK_BUNDLE)\n+endif\n+\n+ifneq ($(filter docs-javase-bundles, $(MAKECMDGOALS)), )\n+  DOCS_JAVASE_BUNDLE_FILES := $(call FindFiles, $(DOCS_JAVASE_IMAGE_DIR))\n+\n+  $(eval $(call SetupBundleFile, BUILD_DOCS_JAVASE_BUNDLE, \\\n+      BUNDLE_NAME := $(DOCS_JAVASE_BUNDLE_NAME), \\\n+      FILES := $(DOCS_JAVASE_BUNDLE_FILES), \\\n+      BASE_DIRS := $(DOCS_JAVASE_IMAGE_DIR), \\\n+      SUBDIR := docs-javase, \\\n+  ))\n+\n+  DOCS_JAVASE_TARGETS += $(BUILD_DOCS_JAVASE_BUNDLE)\n+endif\n+\n+ifneq ($(filter docs-reference-bundles, $(MAKECMDGOALS)), )\n+  DOCS_REFERENCE_BUNDLE_FILES := $(call FindFiles, $(DOCS_REFERENCE_IMAGE_DIR))\n+\n+  $(eval $(call SetupBundleFile, BUILD_DOCS_REFERENCE_BUNDLE, \\\n+      BUNDLE_NAME := $(DOCS_REFERENCE_BUNDLE_NAME), \\\n+      FILES := $(DOCS_REFERENCE_BUNDLE_FILES), \\\n+      BASE_DIRS := $(DOCS_REFERENCE_IMAGE_DIR), \\\n+      SUBDIR := docs-reference, \\\n+  ))\n+\n+  DOCS_REFERENCE_TARGETS += $(BUILD_DOCS_REFERENCE_BUNDLE)\n@@ -472,1 +498,3 @@\n-docs-bundles: $(DOCS_TARGETS)\n+docs-jdk-bundles: $(DOCS_JDK_TARGETS)\n+docs-javase-bundles: $(DOCS_JAVASE_TARGETS)\n+docs-reference-bundles: $(DOCS_REFERENCE_TARGETS)\n@@ -476,1 +504,2 @@\n-.PHONY: all default product-bundles test-bundles docs-bundles \\\n+.PHONY: all default product-bundles test-bundles \\\n+    docs-jdk-bundles docs-javase-bundles docs-reference-bundles \\\n","filename":"make\/Bundles.gmk","additions":38,"deletions":9,"binary":false,"changes":47,"status":"modified"},{"patch":"@@ -36,0 +36,11 @@\n+# When using an external BUILDJDK, make it possible to shortcut building of\n+# these tools using the BUILD_JAVAC instead of having to build the complete\n+# exploded image first.\n+ifeq ($(EXTERNAL_BUILDJDK), true)\n+  COMPILER := buildjdk\n+  TARGET_RELEASE := $(TARGET_RELEASE_NEWJDK)\n+else\n+  COMPILER := interim\n+  TARGET_RELEASE := $(TARGET_RELEASE_NEWJDK_UPGRADED)\n+endif\n+\n@@ -37,1 +48,2 @@\n-    TARGET_RELEASE := $(TARGET_RELEASE_NEWJDK_UPGRADED), \\\n+    TARGET_RELEASE := $(TARGET_RELEASE), \\\n+    COMPILER := $(COMPILER), \\\n","filename":"make\/CompileModuleTools.gmk","additions":13,"deletions":1,"binary":false,"changes":14,"status":"modified"},{"patch":"@@ -461,1 +461,1 @@\n-    TARGET_DIR := $(IMAGES_OUTPUTDIR)\/javase-docs\/api, \\\n+    TARGET_DIR := $(DOCS_JAVASE_IMAGE_DIR)\/api, \\\n@@ -479,1 +479,1 @@\n-    TARGET_DIR := $(IMAGES_OUTPUTDIR)\/reference-docs\/api, \\\n+    TARGET_DIR := $(DOCS_REFERENCE_IMAGE_DIR)\/api, \\\n","filename":"make\/Docs.gmk","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -93,1 +93,0 @@\n-    DEPS := exploded-image-base, \\\n@@ -472,1 +471,1 @@\n-    DEPS := exploded-image buildtools-modules, \\\n+    DEPS := buildtools-modules, \\\n@@ -483,1 +482,1 @@\n-    DEPS := exploded-image buildtools-modules, \\\n+    DEPS := buildtools-modules, \\\n@@ -494,1 +493,1 @@\n-    DEPS := exploded-image buildtools-modules, \\\n+    DEPS := buildtools-modules, \\\n@@ -752,1 +751,1 @@\n-$(eval $(call SetupTarget, docs-bundles, \\\n+$(eval $(call SetupTarget, docs-jdk-bundles, \\\n@@ -754,1 +753,1 @@\n-    TARGET := docs-bundles, \\\n+    TARGET := docs-jdk-bundles, \\\n@@ -758,0 +757,12 @@\n+$(eval $(call SetupTarget, docs-javase-bundles, \\\n+    MAKEFILE := Bundles, \\\n+    TARGET := docs-javase-bundles, \\\n+    DEPS := docs-javase-image, \\\n+))\n+\n+$(eval $(call SetupTarget, docs-reference-bundles, \\\n+    MAKEFILE := Bundles, \\\n+    TARGET := docs-reference-bundles, \\\n+    DEPS := docs-reference-image, \\\n+))\n+\n@@ -948,2 +959,2 @@\n-  else\n-    # The normal non cross compilation case uses needs to wait for the full\n+  else ifeq ($(EXTERNAL_BUILDJDK), false)\n+    # The normal non cross compilation usecase needs to wait for the full\n@@ -952,0 +963,3 @@\n+    # The buildtools-modules are used for the exploded-image-optimize target,\n+    # but can be built either using the exploded-image or an external BUILDJDK.\n+    buildtools-modules: exploded-image-base\n@@ -1125,2 +1139,10 @@\n-# This target builds the documentation image\n-docs-image: docs-jdk\n+# These targets build the various documentation images\n+docs-jdk-image: docs-jdk\n+docs-javase-image: docs-javase\n+docs-reference-image: docs-reference\n+# The docs-jdk-image is what most users expect to be built\n+docs-image: docs-jdk-image\n+all-docs-images: docs-jdk-image docs-javase-image docs-reference-image\n+\n+docs-bundles: docs-jdk-bundles\n+all-docs-bundles: docs-jdk-bundles docs-javase-bundles docs-reference-bundles\n@@ -1159,1 +1181,1 @@\n-all-images: product-images test-image docs-image\n+all-images: product-images test-image all-docs-images\n@@ -1170,1 +1192,2 @@\n-    docs-image test-image all-images \\\n+    docs-image docs-javase-image docs-reference-image all-docs-images \\\n+    docs-bundles all-docs-bundles test-image all-images \\\n","filename":"make\/Main.gmk","additions":35,"deletions":12,"binary":false,"changes":47,"status":"modified"},{"patch":"@@ -647,0 +647,1 @@\n+BUILD_JAVAC=@FIXPATH@ $(BUILD_JDK)\/bin\/javac\n@@ -879,2 +880,6 @@\n-DOCS_IMAGE_SUBDIR := docs\n-DOCS_IMAGE_DIR = $(IMAGES_OUTPUTDIR)\/$(DOCS_IMAGE_SUBDIR)\n+DOCS_JDK_IMAGE_SUBDIR := docs\n+DOCS_JDK_IMAGE_DIR = $(IMAGES_OUTPUTDIR)\/$(DOCS_JDK_IMAGE_SUBDIR)\n+DOCS_JAVASE_IMAGE_SUBDIR := docs-javase\n+DOCS_JAVASE_IMAGE_DIR = $(IMAGES_OUTPUTDIR)\/$(DOCS_JAVASE_IMAGE_SUBDIR)\n+DOCS_REFERENCE_IMAGE_SUBDIR := docs-reference\n+DOCS_REFERENCE_IMAGE_DIR = $(IMAGES_OUTPUTDIR)\/$(DOCS_REFERENCE_IMAGE_SUBDIR)\n@@ -882,1 +887,1 @@\n-DOCS_OUTPUTDIR := $(DOCS_IMAGE_DIR)\n+DOCS_OUTPUTDIR := $(DOCS_JDK_IMAGE_DIR)\n@@ -925,1 +930,3 @@\n-DOCS_BUNDLE_NAME := jdk-$(BASE_NAME)_doc-api-spec$(DEBUG_PART).tar.gz\n+DOCS_JDK_BUNDLE_NAME := jdk-$(BASE_NAME)_doc-api-spec$(DEBUG_PART).tar.gz\n+DOCS_JAVASE_BUNDLE_NAME := javase-$(BASE_NAME)_doc-api-spec$(DEBUG_PART).tar.gz\n+DOCS_REFERENCE_BUNDLE_NAME := jdk-reference-$(BASE_NAME)_doc-api-spec$(DEBUG_PART).tar.gz\n@@ -934,1 +941,3 @@\n-DOCS_BUNDLE :=  $(BUNDLES_OUTPUTDIR)\/$(DOCS_BUNDLE_NAME)\n+DOCS_JDK_BUNDLE :=  $(BUNDLES_OUTPUTDIR)\/$(DOCS_JDK_BUNDLE_NAME)\n+DOCS_JAVASE_BUNDLE :=  $(BUNDLES_OUTPUTDIR)\/$(DOCS_JAVASE_BUNDLE_NAME)\n+DOCS_REFERENCE_BUNDLE :=  $(BUNDLES_OUTPUTDIR)\/$(DOCS_REFERENCE_BUNDLE_NAME)\n","filename":"make\/autoconf\/spec.gmk.in","additions":14,"deletions":5,"binary":false,"changes":19,"status":"modified"},{"patch":"@@ -205,0 +205,7 @@\n+  else ifeq ($$($1_COMPILER), buildjdk)\n+    $1_JAVAC_CMD := $$(BUILD_JAVAC)\n+\n+    ifeq ($$($1_TARGET_RELEASE), )\n+      # If unspecified, default to the new jdk we're building\n+      $1_TARGET_RELEASE := $$(TARGET_RELEASE_NEWJDK)\n+    endif\n","filename":"make\/common\/JavaCompilation.gmk","additions":7,"deletions":0,"binary":false,"changes":7,"status":"modified"},{"patch":"@@ -409,1 +409,1 @@\n-                \"--enable-full-docs\", \"--with-zlib=system\",\n+                \"--with-zlib=system\",\n@@ -412,1 +412,0 @@\n-            default_make_targets: [\"docs-bundles\"],\n@@ -683,2 +682,14 @@\n-    profilesArtifacts = {\n-        \"linux-x64\": {\n+    buildJdkDep = input.build_os + \"-\" + input.build_cpu + \".jdk\";\n+    docsProfiles = {\n+        \"docs\": {\n+            target_os: input.build_os,\n+            target_cpu: input.build_cpu,\n+            dependencies: [\n+                \"boot_jdk\", \"devkit\", \"graphviz\", \"pandoc\", buildJdkDep,\n+            ],\n+            configure_args: [\n+                \"--enable-full-docs\",\n+                \"--with-build-jdk=\" + input.get(buildJdkDep, \"home_path\")\n+                    + (input.build_os == \"macosx\" ? \"\/Contents\/Home\" : \"\")\n+            ],\n+            default_make_targets: [\"all-docs-bundles\"],\n@@ -687,1 +698,1 @@\n-                    local: \"bundles\/\\\\(jdk.*doc-api-spec.tar.gz\\\\)\",\n+                    local: \"bundles\/\\\\(jdk-\" + data.version + \".*doc-api-spec.tar.gz\\\\)\",\n@@ -693,0 +704,14 @@\n+                javase_doc_api_spec: {\n+                    local: \"bundles\/\\\\(javase-\" + data.version + \".*doc-api-spec.tar.gz\\\\)\",\n+                    remote: [\n+                        \"bundles\/common\/javase-\" + data.version + \"_doc-api-spec.tar.gz\",\n+                        \"bundles\/common\/\\\\1\"\n+                    ],\n+                },\n+                reference_doc_api_spec: {\n+                    local: \"bundles\/\\\\(jdk-reference-\" + data.version + \".*doc-api-spec.tar.gz\\\\)\",\n+                    remote: [\n+                        \"bundles\/common\/jdk-reference-\" + data.version + \"_doc-api-spec.tar.gz\",\n+                        \"bundles\/common\/\\\\1\"\n+                    ],\n+                },\n@@ -696,1 +721,1 @@\n-    profiles = concatObjects(profiles, profilesArtifacts);\n+    profiles = concatObjects(profiles, docsProfiles);\n","filename":"make\/conf\/jib-profiles.js","additions":31,"deletions":6,"binary":false,"changes":37,"status":"modified"}]}