{"files":[{"patch":"@@ -39,1 +39,1 @@\n-  attach pid | exec core  <font color=\"red\">attach SA to a process or core<\/font>\n+  attach pid | exec core | remote_server  <font color=\"red\">attach SA to a process, core, or remote debug server<\/font>\n","filename":"src\/jdk.hotspot.agent\/doc\/clhsdb.html","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -36,0 +36,4 @@\n+        pid = -1;\n+        execPath = null;\n+        coreFilename = null;\n+        remoteMachineName = null;\n@@ -45,2 +49,2 @@\n-        \/\/ Otherwise, if pidText != null we are supposed to attach to it.\n-        \/\/ Finally, if execPath != null, it is the path of a jdk\/bin\/java\n+        \/\/ Otherwise, if pid != -1 we are supposed to attach to it.\n+        \/\/ If execPath != null, it is the path of a jdk\/bin\/java\n@@ -49,0 +53,1 @@\n+        \/\/ Finally, if remoteMachineName != null, we are supposed to connect to remote debug server.\n@@ -60,2 +65,2 @@\n-        } else if (pidText != null) {\n-            attachDebugger(pidText);\n+        } else if (pid != -1) {\n+            attachDebugger(pid);\n@@ -64,0 +69,2 @@\n+        } else if (remoteMachineName != null) {\n+            connect(remoteMachineName);\n@@ -74,1 +81,1 @@\n-                public void attach(String pid) {\n+                public void attach(int pid) {\n@@ -80,2 +87,2 @@\n-                public void connect(String remoteServer) {\n-                    CLHSDB.this.connect(remoteServer);\n+                public void attach(String remoteMachineName) {\n+                    connect(remoteMachineName);\n@@ -90,3 +97,5 @@\n-                    if (pidText != null) {\n-                        attach(pidText);\n-                    } else if (execPath != null) {\n+                    if (pid != -1) {\n+                        attach(pid);\n+                    } else if (remoteMachineName != null) {\n+                        connect(remoteMachineName);\n+                    } else {\n@@ -94,2 +103,0 @@\n-                    } else if (remoteServer != null) {\n-                        connect(remoteServer);\n@@ -115,1 +122,0 @@\n-    private String pidText;\n@@ -119,1 +125,1 @@\n-    private String remoteServer;\n+    private String remoteMachineName;\n@@ -131,0 +137,5 @@\n+        pid = -1;\n+        execPath = null;\n+        coreFilename = null;\n+        remoteMachineName = null;\n+\n@@ -143,3 +154,1 @@\n-                int unused = Integer.parseInt(args[0]);\n-                \/\/ If we get here, we have a PID and not a core file name\n-                pidText = args[0];\n+                pid = Integer.parseInt(args[0]);\n@@ -172,1 +181,1 @@\n-    private void attachDebugger(String pidText) {\n+    private void attachDebugger(int pid) {\n@@ -174,2 +183,1 @@\n-            this.pidText = pidText;\n-            pid = Integer.parseInt(pidText);\n+            this.pid = pid;\n@@ -178,1 +186,1 @@\n-            System.err.print(\"Unable to parse process ID \\\"\" + pidText + \"\\\".\\nPlease enter a number.\");\n+            System.err.print(\"Unable to parse process ID \\\"\" + Integer.toString(pid) + \"\\\".\\nPlease enter a number.\");\n@@ -228,1 +236,1 @@\n-            remoteServer = remoteMachineName;\n+            this.remoteMachineName = remoteMachineName;\n","filename":"src\/jdk.hotspot.agent\/share\/classes\/sun\/jvm\/hotspot\/CLHSDB.java","additions":30,"deletions":22,"binary":false,"changes":52,"status":"modified"},{"patch":"@@ -117,1 +117,1 @@\n-        public abstract void attach(String pid);\n+        public abstract void attach(int pid);\n@@ -119,1 +119,1 @@\n-        public abstract void connect(String remoteServer);\n+        public abstract void attach(String remoteMachineName);\n@@ -386,1 +386,1 @@\n-        new Command(\"attach\", \"attach pid | exec core\", true) {\n+        new Command(\"attach\", \"attach pid | exec core | remote_server\", true) {\n@@ -391,1 +391,8 @@\n-                    debugger.attach(t.nextToken());\n+                    String arg = t.nextToken();\n+                    try {\n+                        \/\/ Attempt to attach as a PID\n+                        debugger.attach(Integer.parseInt(arg));\n+                    } catch (NumberFormatException e) {\n+                        \/\/ Attempt to connect to remote debug server\n+                        debugger.attach(arg);\n+                    }\n@@ -402,12 +409,0 @@\n-        new Command(\"connect\", \"connect remote_server\", true) {\n-            public void doit(Tokens t) {\n-                int tokens = t.countTokens();\n-                if (tokens == 1) {\n-                    preAttach();\n-                    debugger.connect(t.nextToken());\n-                    postAttach();\n-                } else {\n-                    usage();\n-                }\n-            }\n-        },\n","filename":"src\/jdk.hotspot.agent\/share\/classes\/sun\/jvm\/hotspot\/CommandProcessor.java","additions":11,"deletions":16,"binary":false,"changes":27,"status":"modified"},{"patch":"@@ -81,1 +81,0 @@\n-  private String pidText;\n@@ -85,1 +84,1 @@\n-  private String remoteServer;\n+  private String remoteMachineName;\n@@ -98,0 +97,4 @@\n+    pid = -1;\n+    execPath = null;\n+    coreFilename = null;\n+    remoteMachineName = null;\n@@ -102,0 +105,5 @@\n+    pid = -1;\n+    execPath = null;\n+    coreFilename = null;\n+    remoteMachineName = null;\n+\n@@ -113,3 +121,1 @@\n-        int unused = Integer.parseInt(args[0]);\n-        \/\/ If we get here, we have a PID and not a core file name\n-        pidText = args[0];\n+        pid = Integer.parseInt(args[0]);\n@@ -426,2 +432,2 @@\n-    \/\/ Otherwise, if pidText != null we are supposed to attach to it.\n-    \/\/ Finally, if execPath != null, it is the path of a jdk\/bin\/java\n+    \/\/ Otherwise, if pid != -1 we are supposed to attach to it.\n+    \/\/ If execPath != null, it is the path of a jdk\/bin\/java\n@@ -430,0 +436,1 @@\n+    \/\/ Finally, if remoteMachineName != null, we are supposed to connect to remote debug server.\n@@ -433,2 +440,2 @@\n-    } else if (pidText != null) {\n-      attach(pidText);\n+    } else if (pid != -1) {\n+      attach(pid);\n@@ -437,0 +444,2 @@\n+    } else if (remoteMachineName != null) {\n+      connect(remoteMachineName);\n@@ -460,1 +469,1 @@\n-                attach(pidTextField.getText());\n+                attach(Integer.parseInt(pidTextField.getText()));\n@@ -1176,1 +1185,1 @@\n-  private void attach(String pidText) {\n+  private void attach(int pid) {\n@@ -1178,2 +1187,1 @@\n-      this.pidText = pidText;\n-      pid = Integer.parseInt(pidText);\n+      this.pid = pid;\n@@ -1186,1 +1194,1 @@\n-                                                  \"Unable to parse process ID \\\"\" + HSDB.this.pidText + \"\\\".\\nPlease enter a number.\",\n+                                                  \"Unable to parse process ID \\\"\" + Integer.toString(HSDB.this.pid) + \"\\\".\\nPlease enter a number.\",\n@@ -1321,1 +1329,0 @@\n-      remoteServer = remoteMachineName;\n@@ -1504,1 +1511,1 @@\n-              public void attach(String pid) {\n+              public void attach(int pid) {\n@@ -1509,2 +1516,2 @@\n-              public void connect(String remoteServer) {\n-                  HSDB.this.connect(remoteServer);\n+              public void attach(String remoteMachineName) {\n+                  HSDB.this.connect(remoteMachineName);\n@@ -1519,3 +1526,5 @@\n-                  if (pidText != null) {\n-                      attach(pidText);\n-                  } else if (execPath != null) {\n+                  if (pid != -1) {\n+                      attach(pid);\n+                  } else if (remoteMachineName != null) {\n+                      connect(remoteMachineName);\n+                  } else {\n@@ -1523,2 +1532,0 @@\n-                  } else if (remoteServer != null) {\n-                      connect(remoteServer);\n","filename":"src\/jdk.hotspot.agent\/share\/classes\/sun\/jvm\/hotspot\/HSDB.java","additions":30,"deletions":23,"binary":false,"changes":53,"status":"modified"},{"patch":"@@ -41,1 +41,1 @@\n- * @run main\/othervm ClhsdbConnect\n+ * @run main\/othervm ClhsdbAttachToDebugServer\n@@ -44,1 +44,1 @@\n-public class ClhsdbConnect {\n+public class ClhsdbAttachToDebugServer {\n@@ -61,1 +61,1 @@\n-        System.out.println(\"Starting ClhsdbConnect test\");\n+        System.out.println(\"Starting ClhsdbAttachToDebugServer test\");\n@@ -80,1 +80,1 @@\n-                console.println(\"connect localhost\");\n+                console.println(\"attach localhost\");\n","filename":"test\/hotspot\/jtreg\/serviceability\/sa\/sadebugd\/ClhsdbAttachToDebugServer.java","additions":4,"deletions":4,"binary":false,"changes":8,"previous_filename":"test\/hotspot\/jtreg\/serviceability\/sa\/sadebugd\/ClhsdbConnect.java","status":"renamed"}]}