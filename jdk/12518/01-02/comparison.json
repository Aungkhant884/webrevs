{"files":[{"patch":"@@ -99,1 +99,1 @@\n-                                     out.printf(\"            isGB18030_2000() ? \\\"gb18030-2000\\\" : \\\"gb18030-2022\\\"%n\");\n+                                     out.printf(\"            GB18030.IS_2000 ? \\\"gb18030-2000\\\" : \\\"gb18030-2022\\\"%n\");\n","filename":"make\/jdk\/src\/classes\/build\/tools\/charsetmapping\/SPI.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -37,1 +37,0 @@\n-import jdk.internal.misc.VM;\n@@ -39,1 +38,0 @@\n-import sun.security.action.GetPropertyAction;\n@@ -64,3 +62,2 @@\n-            var is2000 = isGB18030_2000();\n-            return csn.equals(\"gb18030-2022\") && !is2000 ||\n-                   csn.equals(\"gb18030-2000\") && is2000 ? \"gb18030\" : csn;\n+            return csn.equals(\"gb18030-2022\") && !GB18030.IS_2000 ||\n+                   csn.equals(\"gb18030-2000\") && GB18030.IS_2000 ? \"gb18030\" : csn;\n@@ -209,15 +206,0 @@\n-\n-    \/\/ Lazily initialized system property value\n-    private @Stable static String GB18030_2000;\n-\n-    static boolean isGB18030_2000() {\n-        if (GB18030_2000 == null) {\n-            if (VM.initLevel() < 1) {\n-                \/\/ Cannot get the system property yet. Assumes non-2000\n-                GB18030_2000 = \"\";\n-            } else {\n-                GB18030_2000 = GetPropertyAction.privilegedGetProperty(\"jdk.charset.GB18030\", \"\");\n-            }\n-        }\n-        return \"2000\".equals(GB18030_2000);\n-    }\n","filename":"src\/java.base\/share\/classes\/sun\/nio\/cs\/StandardCharsets.java.template","additions":2,"deletions":20,"binary":false,"changes":22,"status":"modified"},{"patch":"@@ -37,0 +37,1 @@\n+import jdk.internal.misc.VM;\n@@ -38,0 +39,1 @@\n+import sun.security.action.GetPropertyAction;\n@@ -46,1 +48,5 @@\n-    private static final boolean IS_2000 = StandardCharsets.isGB18030_2000();\n+    \/\/ Assumes non-2000 standard if initialized during System.initPhase1(),\n+    \/\/ as the system property is not ready to be read in that case.\n+    static final boolean IS_2000 =\n+        VM.initLevel() >= 1 &&\n+        \"2000\".equals(GetPropertyAction.privilegedGetProperty(\"jdk.charset.GB18030\", \"\"));\n","filename":"src\/jdk.charsets\/share\/classes\/sun\/nio\/cs\/ext\/GB18030.java.template","additions":7,"deletions":1,"binary":false,"changes":8,"status":"modified"}]}