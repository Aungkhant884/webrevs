{"files":[{"patch":"@@ -39,0 +39,1 @@\n+import java.util.Objects;\n@@ -47,1 +48,1 @@\n- * @run main\/othervm JdwpNetProps\n+ * @run main\/othervm -Djava.net.preferIPv6Addresses=system JdwpNetProps\n@@ -63,0 +64,7 @@\n+        String preferIPv6Address = System.getProperty(\"java.net.preferIPv6Addresses\");\n+        if (!Objects.equals(preferIPv6Address, \"system\")) {\n+          throw new AssertionError(\n+              \"Expected -Djava.net.preferIPv6Address=system, was \" + preferIPv6Address);\n+        }\n+        boolean systemPrefersIPv6 = addrs[0] instanceof Inet6Address;\n+\n@@ -68,1 +76,2 @@\n-                    .preferIPv4Stack(false)\n+                    .preferIPv4Stack(true)\n+                    .preferIPv6Addresses(\"true\")\n@@ -74,0 +83,11 @@\n+            new ListenTest(\"localhost\", ipv4Address)\n+                    .preferIPv4Stack(false)\n+                    .run(TestResult.Success);\n+            new ListenTest(\"localhost\", ipv4Address)\n+                    .preferIPv4Stack(false)\n+                    .preferIPv6Addresses(\"true\")\n+                    .run(TestResult.AttachFailed);\n+            new ListenTest(\"localhost\", ipv4Address)\n+                    .preferIPv4Stack(false)\n+                    .preferIPv6Addresses(\"system\")\n+                    .run(systemPrefersIPv6 ? TestResult.AttachFailed : TestResult.Success);\n@@ -80,0 +100,4 @@\n+                new ListenTest(\"localhost\", ipv6Address)\n+                        .preferIPv4Stack(true)\n+                        .preferIPv6Addresses(\"system\")\n+                        .run(TestResult.AttachFailed);\n@@ -84,0 +108,3 @@\n+                \/\/ - listen on IPv4 (preferIPv6Addresses defaults to false)\n+                new ListenTest(\"localhost\", ipv6Address)\n+                        .run(TestResult.AttachFailed);\n@@ -90,1 +117,1 @@\n-                        .run(TestResult.Success);\n+                        .run(systemPrefersIPv6 ? TestResult.Success : TestResult.AttachFailed);\n@@ -97,0 +124,16 @@\n+            new ListenTest(\"localhost\", ipv6Address)\n+                    .preferIPv4Stack(true)\n+                    .preferIPv6Addresses(\"system\")\n+                    .run(TestResult.ListenFailed);\n+            new ListenTest(\"localhost\", ipv6Address)\n+                    .preferIPv4Stack(true)\n+                    .preferIPv6Addresses(\"true\")\n+                    .run(TestResult.ListenFailed);\n+            new ListenTest(\"localhost\", ipv6Address)\n+                    .run(TestResult.ListenFailed);\n+            new ListenTest(\"localhost\", ipv6Address)\n+                    .preferIPv6Addresses(\"system\")\n+                    .run(systemPrefersIPv6 ? TestResult.Success : TestResult.AttachFailed);\n+            new ListenTest(\"localhost\", ipv6Address)\n+                    .preferIPv6Addresses(\"true\")\n+                    .run(TestResult.Success);\n@@ -211,0 +254,1 @@\n+\n","filename":"test\/jdk\/com\/sun\/jdi\/JdwpNetProps.java","additions":47,"deletions":3,"binary":false,"changes":50,"status":"modified"}]}