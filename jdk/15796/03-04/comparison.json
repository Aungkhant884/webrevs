{"files":[{"patch":"@@ -730,5 +730,7 @@\n-    \/\/ Try to find bind address of preferred address family first.\n-    for (ai = addrInfo; ai != NULL; ai = ai->ai_next) {\n-        if (ai->ai_family == preferredAddressFamily) {\n-            listenAddr = ai;\n-            break;\n+    \/\/ Try to find bind address of preferred address family first (if java.net.preferIPv6Addresses != \"system\").\n+    if (preferredAddressFamily != AF_UNSPEC) {\n+        for (ai = addrInfo; ai != NULL; ai = ai->ai_next) {\n+            if (ai->ai_family == preferredAddressFamily) {\n+                listenAddr = ai;\n+                break;\n+            }\n@@ -970,2 +972,4 @@\n-    \/* 1st pass - preferredAddressFamily (by default IPv4), 2nd pass - the rest *\/\n-    for (pass = 0; pass < 2 && socketFD < 0; pass++) {\n+    \/\/ 1st pass - preferredAddressFamily (by default IPv4), 2nd pass - the rest;\n+    \/\/ if java.net.preferIPv6Addresses == \"system\", only 2nd pass is needed\n+    pass = preferredAddressFamily != AF_UNSPEC ? 0 : 1;\n+    for (; pass < 2 && socketFD < 0; pass++) {\n","filename":"src\/jdk.jdwp.agent\/share\/native\/libdt_socket\/socketTransport.c","additions":11,"deletions":7,"binary":false,"changes":18,"status":"modified"}]}