{"files":[{"patch":"@@ -433,1 +433,0 @@\n-java\/awt\/Mouse\/TitleBarDoubleClick\/TitleBarDoubleClick.java 8148041 linux-all\n","filename":"test\/jdk\/ProblemList.txt","additions":0,"deletions":1,"binary":false,"changes":1,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2002, 2018, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2002, 2022, Oracle and\/or its affiliates. All rights reserved.\n@@ -29,2 +29,0 @@\n-  @library    ..\/..\/regtesthelpers\n-  @build      Util\n@@ -34,3 +32,10 @@\n-import java.awt.*;\n-import java.awt.event.*;\n-import test.java.awt.regtesthelpers.Util;\n+import java.awt.AWTError;\n+import java.awt.AWTException;\n+import java.awt.Frame;\n+import java.awt.Rectangle;\n+import java.awt.Robot;\n+import java.awt.event.InputEvent;\n+import java.awt.event.MouseEvent;\n+import java.awt.event.MouseListener;\n+import java.awt.event.WindowEvent;\n+import java.awt.event.WindowListener;\n@@ -39,1 +44,1 @@\n- WindowListener\n+        WindowListener\n@@ -48,3 +53,4 @@\n-    public static void main(final String[] args) {\n-        TitleBarDoubleClick app = new TitleBarDoubleClick();\n-        app.start();\n+    private volatile boolean failed = false;\n+\n+    public static void main(final String[] args) throws AWTException {\n+        new TitleBarDoubleClick().doTest();\n@@ -53,6 +59,3 @@\n-    public void start ()\n-    {\n-            robot = Util.createRobot();\n-            robot.setAutoDelay(100);\n-            robot.mouseMove(BOUNDS.x + (BOUNDS.width \/ 2),\n-                            BOUNDS.y + (BOUNDS.height\/ 2));\n+    public TitleBarDoubleClick() throws AWTException {\n+        robot = new Robot();\n+        robot.setAutoDelay(100);\n@@ -60,6 +63,4 @@\n-            frame = new Frame(\"TitleBarDoubleClick\");\n-            frame.setBounds(BOUNDS);\n-            frame.addMouseListener(this);\n-            frame.addWindowListener(this);\n-            frame.setVisible(true);\n-    }\/\/ start()\n+        robot.mouseMove(\n+                BOUNDS.x + (BOUNDS.width \/ 2),\n+                BOUNDS.y + (BOUNDS.height\/ 2)\n+        );\n@@ -67,3 +68,5 @@\n-    \/\/ Move the mouse into the title bar and double click to maximize the\n-    \/\/ Frame\n-    static boolean hasRun = false;\n+        frame = new Frame(\"TitleBarDoubleClick\");\n+        frame.setBounds(BOUNDS);\n+        frame.addMouseListener(this);\n+        frame.addWindowListener(this);\n+        frame.setVisible(true);\n@@ -71,3 +74,3 @@\n-    private void doTest() {\n-        if (hasRun) return;\n-        hasRun = true;\n+        robot.waitForIdle();\n+        robot.delay(1000);\n+    }\n@@ -75,0 +78,1 @@\n+    public void doTest() throws AWTException {\n@@ -76,17 +80,24 @@\n-            robot.mouseMove(BOUNDS.x + (BOUNDS.width \/ 2),\n-                            BOUNDS.y + TITLE_BAR_OFFSET);\n-            robot.delay(50);\n-            \/\/ Util.waitForIdle(robot) seem always hangs here.\n-            \/\/ Need to use it instead robot.delay() when the bug become fixed.\n-            System.out.println(\"1st press:   currentTimeMillis: \" + System.currentTimeMillis());\n-            robot.mousePress(InputEvent.BUTTON1_MASK);\n-            robot.delay(50);\n-            System.out.println(\"1st release: currentTimeMillis: \" + System.currentTimeMillis());\n-            robot.mouseRelease(InputEvent.BUTTON1_MASK);\n-            robot.delay(50);\n-            System.out.println(\"2nd press:   currentTimeMillis: \" + System.currentTimeMillis());\n-            robot.mousePress(InputEvent.BUTTON1_MASK);\n-            robot.delay(50);\n-            System.out.println(\"2nd release: currentTimeMillis: \" + System.currentTimeMillis());\n-            robot.mouseRelease(InputEvent.BUTTON1_MASK);\n-            System.out.println(\"done:        currentTimeMillis: \" + System.currentTimeMillis());\n+        robot.mouseMove(\n+                BOUNDS.x + (BOUNDS.width \/ 2),\n+                BOUNDS.y + TITLE_BAR_OFFSET\n+        );\n+        robot.waitForIdle();\n+\n+        System.out.println(\"1st press:   currentTimeMillis: \" + System.currentTimeMillis());\n+        robot.mousePress(InputEvent.BUTTON1_DOWN_MASK);\n+        System.out.println(\"1st release: currentTimeMillis: \" + System.currentTimeMillis());\n+        robot.mouseRelease(InputEvent.BUTTON1_DOWN_MASK);\n+        System.out.println(\"2nd press:   currentTimeMillis: \" + System.currentTimeMillis());\n+        robot.mousePress(InputEvent.BUTTON1_DOWN_MASK);\n+        System.out.println(\"2nd release: currentTimeMillis: \" + System.currentTimeMillis());\n+        robot.mouseRelease(InputEvent.BUTTON1_DOWN_MASK);\n+        System.out.println(\"done:        currentTimeMillis: \" + System.currentTimeMillis());\n+\n+        robot.waitForIdle();\n+        robot.delay(500);\n+\n+        frame.dispose();\n+\n+        if (failed) {\n+            throw new AWTError(\"Test failed\");\n+        }\n@@ -95,2 +106,3 @@\n-    private void fail() {\n-        throw new AWTError(\"Test failed\");\n+    private void fail(MouseEvent e) {\n+        System.err.println(\"Failed: \" + e);\n+        failed = true;\n@@ -101,3 +113,3 @@\n-    public void mousePressed(MouseEvent e) {fail();}\n-    public void mouseReleased(MouseEvent e) {fail();}\n-    public void mouseClicked(MouseEvent e) {fail();}\n+    public void mousePressed(MouseEvent e) {fail(e);}\n+    public void mouseReleased(MouseEvent e) {fail(e);}\n+    public void mouseClicked(MouseEvent e) {fail(e);}\n@@ -105,1 +117,1 @@\n-    public void windowActivated(WindowEvent  e) {doTest();}\n+    public void windowActivated(WindowEvent  e) {}\n","filename":"test\/jdk\/java\/awt\/Mouse\/TitleBarDoubleClick\/TitleBarDoubleClick.java","additions":63,"deletions":51,"binary":false,"changes":114,"status":"modified"}]}