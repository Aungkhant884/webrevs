{"files":[{"patch":"@@ -2,1 +2,1 @@\n-# Copyright (c) 2022, Oracle and\/or its affiliates. All rights reserved.\n+# Copyright (c) 2022, 2023, Oracle and\/or its affiliates. All rights reserved.\n@@ -129,1 +129,0 @@\n-          --enable-jtreg-failure-handler\n","filename":".github\/workflows\/build-linux.yml","additions":1,"deletions":2,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n-# Copyright (c) 2022, Oracle and\/or its affiliates. All rights reserved.\n+# Copyright (c) 2022, 2023, Oracle and\/or its affiliates. All rights reserved.\n@@ -104,1 +104,0 @@\n-          --enable-jtreg-failure-handler\n","filename":".github\/workflows\/build-macos.yml","additions":1,"deletions":2,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n-# Copyright (c) 2022, Oracle and\/or its affiliates. All rights reserved.\n+# Copyright (c) 2022, 2023, Oracle and\/or its affiliates. All rights reserved.\n@@ -117,1 +117,0 @@\n-          --enable-jtreg-failure-handler\n","filename":".github\/workflows\/build-windows.yml","additions":1,"deletions":2,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n-# Copyright (c) 2011, 2022, Oracle and\/or its affiliates. All rights reserved.\n+# Copyright (c) 2011, 2023, Oracle and\/or its affiliates. All rights reserved.\n@@ -105,0 +105,23 @@\n+# Setup what kind of build environment type we have (CI or local developer)\n+AC_DEFUN_ONCE([BASIC_SETUP_BUILD_ENV],\n+[\n+  if test \"x$CI\" = \"xtrue\"; then\n+    DEFAULT_BUILD_ENV=\"ci\"\n+    AC_MSG_NOTICE([CI environment variable set to $CI])\n+  else\n+    DEFAULT_BUILD_ENV=\"dev\"\n+  fi\n+\n+  UTIL_ARG_WITH(NAME: build-env, TYPE: literal,\n+      RESULT: BUILD_ENV,\n+      VALID_VALUES: [auto dev ci], DEFAULT: auto,\n+      CHECKING_MSG: [for build environment type],\n+      DESC: [select build environment type (affects certain default values)],\n+      IF_AUTO: [\n+        RESULT=$DEFAULT_BUILD_ENV\n+      ]\n+  )\n+  AC_SUBST(BUILD_ENV)\n+])\n+\n+###############################################################################\n","filename":"make\/autoconf\/basic.m4","additions":24,"deletions":1,"binary":false,"changes":25,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n-# Copyright (c) 2011, 2022, Oracle and\/or its affiliates. All rights reserved.\n+# Copyright (c) 2011, 2023, Oracle and\/or its affiliates. All rights reserved.\n@@ -89,0 +89,1 @@\n+BASIC_SETUP_BUILD_ENV\n","filename":"make\/autoconf\/configure.ac","additions":2,"deletions":1,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n-# Copyright (c) 2018, 2022, Oracle and\/or its affiliates. All rights reserved.\n+# Copyright (c) 2018, 2023, Oracle and\/or its affiliates. All rights reserved.\n@@ -288,1 +288,7 @@\n-  UTIL_ARG_ENABLE(NAME: jtreg-failure-handler, DEFAULT: auto,\n+  if test \"x$BUILD_ENV\" = \"xci\"; then\n+    BUILD_FAILURE_HANDLER_DEFAULT=auto\n+  else\n+    BUILD_FAILURE_HANDLER_DEFAULT=false\n+  fi\n+\n+  UTIL_ARG_ENABLE(NAME: jtreg-failure-handler, DEFAULT: $BUILD_FAILURE_HANDLER_DEFAULT,\n@@ -291,1 +297,1 @@\n-      DEFAULT_DESC: [enabled if jtreg is present],\n+      DEFAULT_DESC: [enabled if jtreg is present and build env is CI],\n","filename":"make\/autoconf\/lib-tests.m4","additions":9,"deletions":3,"binary":false,"changes":12,"status":"modified"},{"patch":"@@ -252,1 +252,1 @@\n-        configure_args: concat(\"--enable-jtreg-failure-handler\",\n+        configure_args: concat(\n","filename":"make\/conf\/jib-profiles.js","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"}]}