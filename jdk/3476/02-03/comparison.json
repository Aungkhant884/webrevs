{"files":[{"patch":"@@ -64,1 +64,2 @@\n-    \/\/ Attempt to transfer within the kernel\n+    \/\/ Transfer within the kernel\n+    const size_t count = 1048576; \/\/ 1 MB to give cancellation a chance\n@@ -67,2 +68,6 @@\n-        \/\/ sendfile() will transfer at most 0x7ffff000 bytes\n-        RESTARTABLE(sendfile64(dst, src, NULL, 0x7ffff000), bytes_sent);\n+        \/\/ sendfile() can transfer at most 0x7ffff000 bytes\n+        RESTARTABLE(sendfile64(dst, src, NULL, count), bytes_sent);\n+        if (bytes_sent == -1) {\n+            throwUnixException(env, errno);\n+            return;\n+        }\n@@ -74,7 +79,1 @@\n-\n-    \/\/ sendfile() returns zero at src EOF\n-    if (bytes_sent == 0) {\n-        return;\n-    }\n-#endif\n-\n+#else\n@@ -110,0 +109,1 @@\n+#endif\n","filename":"src\/java.base\/unix\/native\/libnio\/fs\/UnixCopyFile.c","additions":10,"deletions":10,"binary":false,"changes":20,"status":"modified"}]}