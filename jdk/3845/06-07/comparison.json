{"files":[{"patch":"@@ -53,11 +53,9 @@\n-        FileInputStream fis = new FileInputStream(empty);\n-        try {\n-            fis.readNBytes(-1);\n-            throw new RuntimeException(\"IllegalArgumentException expecte\");\n-        } catch (IllegalArgumentException expected) {\n-        }\n-\n-        byte[] b = fis.readNBytes(1);\n-        fis.close();\n-        if (b.length != 0)\n-            throw new RuntimeException(\"Zero-length byte[] expected\");\n+        try (FileInputStream fis = new FileInputStream(empty)) {\n+            try {\n+                fis.readNBytes(-1);\n+                throw new RuntimeException(\"IllegalArgumentException expected\");\n+            } catch (IllegalArgumentException expected) {\n+            }\n+            byte[] nbytes = fis.readNBytes(0);\n+            if (nbytes.length != 0)\n+                throw new RuntimeException(\"readNBytes() zero length for empty\");\n@@ -65,5 +63,4 @@\n-        fis = new FileInputStream(empty);\n-        b = fis.readAllBytes();\n-        fis.close();\n-        if (b.length != 0)\n-            throw new RuntimeException(\"Zero-length byte[] expected\");\n+            byte[] b = fis.readNBytes(1);\n+            if (b.length != 0)\n+                throw new RuntimeException(\"Zero-length byte[] expected\");\n+        }\n@@ -71,1 +68,7 @@\n-        empty.delete();\n+        try (FileInputStream fis = new FileInputStream(empty)) {\n+            byte[] b = fis.readAllBytes();\n+            if (b.length != 0)\n+                throw new RuntimeException(\"Zero-length byte[] expected\");\n+        } finally {\n+            empty.delete();\n+        }\n@@ -81,3 +84,3 @@\n-            RandomAccessFile raf = new RandomAccessFile(file, \"rw\");\n-            raf.write(bytes);\n-            raf.close();\n+            try (RandomAccessFile raf = new RandomAccessFile(file, \"rw\")) {\n+                raf.write(bytes);\n+            }\n@@ -85,13 +88,13 @@\n-            fis = new FileInputStream(file);\n-            int pos = RND.nextInt(size);\n-            int len = RND.nextInt(size - pos);\n-            fis.getChannel().position(pos);\n-            byte[] nbytes = fis.readNBytes(0);\n-            if (nbytes.length != 0)\n-                throw new RuntimeException(\"readNBytes() zero length\");\n-            nbytes = fis.readNBytes(len);\n-            if (nbytes.length != len)\n-                throw new RuntimeException(\"readNBytes() length\");\n-            if (!Arrays.equals(nbytes, 0, len, bytes, pos, pos + len))\n-                throw new RuntimeException(\"readNBytes() content\");\n-            fis.close();\n+            try (FileInputStream fis = new FileInputStream(file)) {\n+                int pos = RND.nextInt(size);\n+                int len = RND.nextInt(size - pos);\n+                fis.getChannel().position(pos);\n+                byte[] nbytes = fis.readNBytes(0);\n+                if (nbytes.length != 0)\n+                    throw new RuntimeException(\"readNBytes() zero length\");\n+                nbytes = fis.readNBytes(len);\n+                if (nbytes.length != len)\n+                    throw new RuntimeException(\"readNBytes() length\");\n+                if (!Arrays.equals(nbytes, 0, len, bytes, pos, pos + len))\n+                    throw new RuntimeException(\"readNBytes() content\");\n+            }\n@@ -99,10 +102,10 @@\n-            fis = new FileInputStream(file);\n-            pos = RND.nextInt(size);\n-            fis.getChannel().position(pos);\n-            byte[] allbytes = fis.readAllBytes();\n-            if (allbytes.length != size - pos)\n-                throw new RuntimeException(\"readAllBytes() length\");\n-            if (!Arrays.equals(allbytes, 0, allbytes.length,\n-                               bytes, pos, pos + allbytes.length))\n-                throw new RuntimeException(\"readAllBytes() content\");\n-            fis.close();\n+            try (FileInputStream fis = new FileInputStream(file)) {\n+                int pos = RND.nextInt(size);\n+                fis.getChannel().position(pos);\n+                byte[] allbytes = fis.readAllBytes();\n+                if (allbytes.length != size - pos)\n+                    throw new RuntimeException(\"readAllBytes() length\");\n+                if (!Arrays.equals(allbytes, 0, allbytes.length,\n+                                   bytes, pos, pos + allbytes.length))\n+                    throw new RuntimeException(\"readAllBytes() content\");\n+            }\n","filename":"test\/jdk\/java\/io\/FileInputStream\/ReadXBytes.java","additions":46,"deletions":43,"binary":false,"changes":89,"status":"modified"}]}