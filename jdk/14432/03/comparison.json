{"files":[{"patch":"@@ -1147,2 +1147,0 @@\n-        \/\/ Process annotations if processing is not disabled and there\n-        \/\/ is at least one Processor available.\n@@ -1154,1 +1152,0 @@\n-            processAnnotations = procEnvImpl.atLeastOneProcessor();\n@@ -1156,5 +1153,4 @@\n-            if (processAnnotations) {\n-                if (!explicitAnnotationProcessingRequested() &&\n-                    !optionsCheckingInitiallyDisabled) {\n-                    log.note(Notes.ImplicitAnnotationProcessing);\n-                }\n+            \/\/ Process annotations if processing is requested and there\n+            \/\/ is at least one Processor available.\n+            processAnnotations = procEnvImpl.atLeastOneProcessor() &&\n+                explicitAnnotationProcessingRequested();\n@@ -1162,0 +1158,1 @@\n+            if (processAnnotations) {\n@@ -1170,2 +1167,0 @@\n-            } else { \/\/ free resources\n-                procEnvImpl.close();\n@@ -1173,0 +1168,2 @@\n+        } else { \/\/ free resources\n+            procEnvImpl.close();\n","filename":"src\/jdk.compiler\/share\/classes\/com\/sun\/tools\/javac\/main\/JavaCompiler.java","additions":7,"deletions":10,"binary":false,"changes":17,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2006, 2015, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2006, 2023, Oracle and\/or its affiliates. All rights reserved.\n@@ -59,2 +59,2 @@\n-        OPT_NONE(\"-implicit:none\"),     \/\/ implicit compilation wiith -implicit:none\n-        OPT_CLASS(\"-implicit:class\");   \/\/ implicit compilation wiith -implicit:class\n+        OPT_NONE(\"-implicit:none\"),     \/\/ implicit compilation with -implicit:none\n+        OPT_CLASS(\"-implicit:class\");   \/\/ implicit compilation with -implicit:class\n@@ -70,1 +70,1 @@\n-        SERVICE,        \/\/ implicit annotation processing, via ServiceLoader\n+     \/\/ SERVICE,        \/\/ implicit annotation processing, via ServiceLoader\n@@ -102,1 +102,4 @@\n-        opts.addAll(Arrays.asList(\"-d\", \".\", \"-sourcepath\", testSrc, \"-classpath\", testClasses, \"-Xlint:-options\"));\n+        opts.addAll(Arrays.asList(\"-d\", \".\",\n+                                  \"-sourcepath\", testSrc,\n+                                  \"-classpath\", testClasses,\n+                                  \"-proc:full\"));\n@@ -107,3 +110,3 @@\n-        case SERVICE:\n-            createProcessorServices(Anno.class.getName());\n-            break;\n+\/\/         case SERVICE:\n+\/\/             createProcessorServices(Anno.class.getName());\n+\/\/             break;\n@@ -148,3 +151,3 @@\n-                case SERVICE:\n-                    expectKey = \"compiler.warn.proc.use.proc.or.implicit\";\n-                    break;\n+\/\/                 case SERVICE:\n+\/\/                      expectKey = \"compiler.warn.proc.use.proc.or.implicit\";\n+\/\/                     break;\n","filename":"test\/langtools\/tools\/javac\/6341866\/T6341866.java","additions":14,"deletions":11,"binary":false,"changes":25,"status":"modified"},{"patch":"@@ -221,0 +221,4 @@\n+\n+# Pending removal\n+compiler.note.implicit.annotation.processing\n+compiler.warn.proc.use.proc.or.implicit\n","filename":"test\/langtools\/tools\/javac\/diags\/examples.not-yet.txt","additions":4,"deletions":0,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -24,2 +24,0 @@\n-\/\/ key: compiler.warn.proc.use.proc.or.implicit\n-\/\/ key: compiler.note.implicit.annotation.processing\n","filename":"test\/langtools\/tools\/javac\/diags\/examples\/ProcUseProcOrImplicit\/ProcUseProcOrImplicit.java","additions":0,"deletions":2,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -26,1 +26,1 @@\n- * @bug 8310061 8315534\n+ * @bug 8310061 8315534 8306819\n@@ -65,1 +65,1 @@\n- * Does _not_ generate a note and the processor runs:\n+ * Does _not_ generate a note and the processor does run:\n@@ -70,0 +70,2 @@\n+ *\n+ * Does _not_ generate a note and the processor does _not_run:\n@@ -168,2 +170,2 @@\n-        checkForProcessorMessage(javacResult, true);\n-        checkForCompilerNote(javacResult, true);\n+        checkForProcessorMessage(javacResult, false);\n+        checkForCompilerNote(javacResult, false);\n@@ -242,1 +244,1 @@\n-        checkForProcessorMessage(javacResult, true);\n+        checkForProcessorMessage(javacResult, false);\n@@ -257,1 +259,1 @@\n-        checkForProcessorMessage(javacResult, true);\n+        checkForProcessorMessage(javacResult, false);\n@@ -320,1 +322,1 @@\n-                verifyMessages(out, compilerOut, true);\n+                verifyMessages(out, compilerOut, false, false);\n@@ -332,1 +334,1 @@\n-                verifyMessages(out, compilerOut, false);\n+                verifyMessages(out, compilerOut, false, true);\n@@ -342,1 +344,1 @@\n-                verifyMessages(out, compilerOut, true);\n+                verifyMessages(out, compilerOut, false, false);\n@@ -356,1 +358,1 @@\n-                verifyMessages(out, compilerOut, false);\n+                verifyMessages(out, compilerOut, false, true);\n@@ -363,3 +365,8 @@\n-    private void verifyMessages(ByteArrayOutputStream out, StringWriter compilerOut, boolean expectedNotePresent) {\n-        if (!out.toString(StandardCharsets.UTF_8).contains(\"ImplicitProcTestProc run\")) {\n-            throw new RuntimeException(\"Expected processor message not printed\");\n+    private void verifyMessages(ByteArrayOutputStream out, StringWriter compilerOut, boolean expectedNotePresent,\n+                                boolean processorRunExpected) {\n+        boolean processorRun = out.toString(StandardCharsets.UTF_8).contains(\"ImplicitProcTestProc run\");\n+\n+        if (processorRun != processorRunExpected) {\n+            throw new RuntimeException(processorRunExpected ?\n+                                       \"Expected processor message not printed\" :\n+                                       \"Unexpected processor message printed\");\n","filename":"test\/langtools\/tools\/javac\/processing\/options\/TestNoteOnImplicitProcessing.java","additions":20,"deletions":13,"binary":false,"changes":33,"status":"modified"}]}