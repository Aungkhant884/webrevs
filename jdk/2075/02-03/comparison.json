{"files":[{"patch":"@@ -278,2 +278,3 @@\n-\/\/ Put all skeleton predicate projections on a list, starting at 'predicate' and going up in the tree.\n-void PhaseIdealLoop::get_skeleton_predicates(Node* predicate, Unique_Node_List& list) {\n+\/\/ Put all skeleton predicate projections on a list, starting at 'predicate' and going up in the tree. If 'get_opaque'\n+\/\/ is set, then the Opaque4 nodes of the skeleton predicates are put on the list instead of the projections.\n+void PhaseIdealLoop::get_skeleton_predicates(Node* predicate, Unique_Node_List& list, bool get_opaque) {\n@@ -293,1 +294,7 @@\n-      list.push(predicate);\n+      if (get_opaque) {\n+        \/\/ Collect the predicate Opaque4 node.\n+        list.push(iff->in(1));\n+      } else {\n+        \/\/ Collect the predicate projection.\n+        list.push(predicate);\n+      }\n","filename":"src\/hotspot\/share\/opto\/loopPredicate.cpp","additions":10,"deletions":3,"binary":false,"changes":13,"status":"modified"},{"patch":"@@ -3555,1 +3555,1 @@\n-        get_skeleton_predicate_opaque_nodes(entry, useful_predicates);\n+        get_skeleton_predicates(entry, useful_predicates, true);\n@@ -3564,1 +3564,1 @@\n-        get_skeleton_predicate_opaque_nodes(entry, useful_predicates);\n+        get_skeleton_predicates(entry, useful_predicates, true);\n@@ -3574,12 +3574,0 @@\n-\/\/ Get all skeleton predicate Opaque4 nodes and put them on the 'predicates' list.\n-void PhaseIdealLoop::get_skeleton_predicate_opaque_nodes(Node* entry, Unique_Node_List& predicates) {\n-  Unique_Node_List list;\n-  get_skeleton_predicates(entry, list); \/\/ List of projections.\n-  \/\/ Fetch the Opaque4 nodes and put them on the predicates list.\n-  for (uint i = 0; i < list.size(); i++) {\n-    Node* opaq = list.at(i)->in(0)->in(1);\n-    assert(opaq->Opcode() == Op_Opaque4, \"must be Opaque4\");\n-    predicates.push(opaq);\n-  }\n-}\n-\n","filename":"src\/hotspot\/share\/opto\/loopnode.cpp","additions":2,"deletions":14,"binary":false,"changes":16,"status":"modified"},{"patch":"@@ -918,1 +918,1 @@\n-  static void get_skeleton_predicates(Node* predicate, Unique_Node_List& list);\n+  static void get_skeleton_predicates(Node* predicate, Unique_Node_List& list, bool get_opaque = false);\n@@ -1317,1 +1317,0 @@\n-  static void get_skeleton_predicate_opaque_nodes(Node* entry, Unique_Node_List& predicates);\n","filename":"src\/hotspot\/share\/opto\/loopnode.hpp","additions":1,"deletions":2,"binary":false,"changes":3,"status":"modified"}]}