{"files":[{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 1999, 2011, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 1999, 2021, Oracle and\/or its affiliates. All rights reserved.\n@@ -62,6 +62,2 @@\n-                obj = AccessController.doPrivileged(new PrivilegedExceptionAction<Object>() {\n-                    @Override\n-                    public Object run() throws NamingException {\n-                        return Obj.decodeObject(attrs);\n-                    }\n-                }, acc);\n+                PrivilegedExceptionAction<Object> pa = () -> Obj.decodeObject(attrs);\n+                obj = AccessController.doPrivileged(pa, acc);\n","filename":"src\/java.naming\/share\/classes\/com\/sun\/jndi\/ldap\/LdapBindingEnumeration.java","additions":3,"deletions":7,"binary":false,"changes":10,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2002, 2013, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2002, 2021, Oracle and\/or its affiliates. All rights reserved.\n@@ -398,12 +398,3 @@\n-    private static final String getProperty(final String propName,\n-        final String defVal) {\n-        return AccessController.doPrivileged(\n-            new PrivilegedAction<String>() {\n-            public String run() {\n-                try {\n-                    return System.getProperty(propName, defVal);\n-                } catch (SecurityException e) {\n-                    return defVal;\n-                }\n-            }\n-        });\n+    private static final String getProperty(final String propName, final String defVal) {\n+        PrivilegedAction<String> pa = () -> System.getProperty(propName, defVal);\n+        return AccessController.doPrivileged(pa);\n@@ -412,13 +403,3 @@\n-    private static final int getInteger(final String propName,\n-        final int defVal) {\n-        Integer val = AccessController.doPrivileged(\n-            new PrivilegedAction<Integer>() {\n-            public Integer run() {\n-                try {\n-                    return Integer.getInteger(propName, defVal);\n-                } catch (SecurityException e) {\n-                    return defVal;\n-                }\n-            }\n-        });\n-        return val.intValue();\n+    private static final int getInteger(final String propName, final int defVal) {\n+        PrivilegedAction<Integer> pa = () -> Integer.getInteger(propName, defVal);\n+        return AccessController.doPrivileged(pa);\n@@ -427,13 +408,3 @@\n-    private static final long getLong(final String propName,\n-        final long defVal) {\n-        Long val = AccessController.doPrivileged(\n-            new PrivilegedAction<Long>() {\n-            public Long run() {\n-                try {\n-                    return Long.getLong(propName, defVal);\n-                } catch (SecurityException e) {\n-                    return defVal;\n-                }\n-            }\n-        });\n-        return val.longValue();\n+    private static final long getLong(final String propName, final long defVal) {\n+        PrivilegedAction<Long> pa = () -> Long.getLong(propName, defVal);\n+        return AccessController.doPrivileged(pa);\n","filename":"src\/java.naming\/share\/classes\/com\/sun\/jndi\/ldap\/LdapPoolManager.java","additions":10,"deletions":39,"binary":false,"changes":49,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 1999, 2011, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 1999, 2021, Oracle and\/or its affiliates. All rights reserved.\n@@ -122,6 +122,2 @@\n-                    obj = AccessController.doPrivileged(new PrivilegedExceptionAction<Object>() {\n-                        @Override\n-                        public Object run() throws NamingException {\n-                            return Obj.decodeObject(attrs);\n-                        }\n-                    }, acc);\n+                    PrivilegedExceptionAction<Object> pea = () -> Obj.decodeObject(attrs);\n+                    obj = AccessController.doPrivileged(pea, acc);\n","filename":"src\/java.naming\/share\/classes\/com\/sun\/jndi\/ldap\/LdapSearchEnumeration.java","additions":3,"deletions":7,"binary":false,"changes":10,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2000, 2020, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2000, 2021, Oracle and\/or its affiliates. All rights reserved.\n@@ -223,7 +223,2 @@\n-        return AccessController.doPrivileged(\n-            new PrivilegedAction<ClassLoader>() {\n-                public ClassLoader run() {\n-                    return Thread.currentThread().getContextClassLoader();\n-                }\n-            }\n-        );\n+        PrivilegedAction<ClassLoader> pa = () -> Thread.currentThread().getContextClassLoader();\n+        return AccessController.doPrivileged(pa);\n@@ -233,7 +228,2 @@\n-        Boolean answer = AccessController.doPrivileged(\n-            new PrivilegedAction<Boolean>() {\n-            public Boolean run() {\n-                return Boolean.valueOf(iter.hasNext());\n-            }\n-        });\n-        return answer.booleanValue();\n+        PrivilegedAction<Boolean> pa = iter::hasNext;\n+        return AccessController.doPrivileged(pa);\n","filename":"src\/java.naming\/share\/classes\/javax\/naming\/ldap\/StartTlsRequest.java","additions":5,"deletions":15,"binary":false,"changes":20,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2015, 2016, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2015, 2021, Oracle and\/or its affiliates. All rights reserved.\n@@ -76,5 +76,4 @@\n-        AccessController.doPrivileged(new PrivilegedAction<Void>() {\n-            public Void run() {\n-                HashMap<String, String> attrs = new HashMap<>(2);\n-                attrs.put(\"LDAPSchema\", \"RFC2587\");\n-                attrs.put(\"ImplementedIn\", \"Software\");\n+        PrivilegedAction<Void> pa = () -> {\n+            HashMap<String, String> attrs = new HashMap<>(2);\n+            attrs.put(\"LDAPSchema\", \"RFC2587\");\n+            attrs.put(\"ImplementedIn\", \"Software\");\n@@ -82,10 +81,10 @@\n-                \/*\n-                 * CertStore\n-                 * attrs: LDAPSchema, ImplementedIn\n-                 *\/\n-                putService(new ProviderService(p, \"CertStore\",\n-                           \"LDAP\", \"sun.security.provider.certpath.ldap.LDAPCertStore\",\n-                           null, attrs));\n-                return null;\n-            }\n-        });\n+            \/*\n+             * CertStore\n+             * attrs: LDAPSchema, ImplementedIn\n+             *\/\n+            putService(new ProviderService(p, \"CertStore\",\n+                       \"LDAP\", \"sun.security.provider.certpath.ldap.LDAPCertStore\",\n+                       null, attrs));\n+            return null;\n+        };\n+        AccessController.doPrivileged(pa);\n","filename":"src\/java.naming\/share\/classes\/sun\/security\/provider\/certpath\/ldap\/JdkLDAP.java","additions":15,"deletions":16,"binary":false,"changes":31,"status":"modified"}]}