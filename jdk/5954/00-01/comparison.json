{"files":[{"patch":"@@ -166,0 +166,1 @@\n+    boolean version = false; \/\/ print the program version\n@@ -311,0 +312,4 @@\n+        if (version) {\n+            doPrintVersion();\n+        }\n+\n@@ -342,8 +347,0 @@\n-        if (args.length == 0) fullusage();\n-        if ((collator.compare(args[0], \"-version\") == 0)) {\n-            if (args.length != 1) {\n-                usageTooManyArg();\n-            }\n-            doPrintVersion();\n-        }\n-\n@@ -488,0 +485,2 @@\n+            } else if (collator.compare(flags, \"-version\") ==0) {\n+                version = true;\n@@ -515,0 +514,6 @@\n+        \/\/ To handle \"jarsigner -version\" command\n+        if (args.length == 1 && version) {\n+            doPrintVersion();\n+            System.exit(0);\n+        }\n+\n@@ -600,6 +605,0 @@\n-    static void usageTooManyArg() {\n-        System.out.println(rb.getString(\n-                \"Option.should.not.be.specified.for.version\"));\n-        usage();\n-    }\n-\n@@ -614,1 +613,0 @@\n-        System.exit(0);\n@@ -655,0 +653,3 @@\n+        System.out.println(rb.getString\n+                (\".version.print.the.program.version\"));\n+        System.out.println();\n","filename":"src\/jdk.jartool\/share\/classes\/sun\/security\/tools\/jarsigner\/Main.java","additions":16,"deletions":15,"binary":false,"changes":31,"status":"modified"},{"patch":"@@ -82,0 +82,2 @@\n+        {\".version.print.the.program.version\",\n+                \"[-version]                  print the program version\"},\n@@ -127,1 +129,0 @@\n-        {\"Option.should.not.be.specified.for.version\", \"Option should not be specified for -version\"},\n","filename":"src\/jdk.jartool\/share\/classes\/sun\/security\/tools\/jarsigner\/Resources.java","additions":2,"deletions":1,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -32,0 +32,2 @@\n+import jdk.test.lib.util.JarUtils;\n+import java.nio.file.Path;\n@@ -40,1 +42,3 @@\n-        SecurityTools.jarsigner(\"-version -extraopt\")\n+        SecurityTools.jarsigner(\"-version -erropt\")\n+                .shouldContain(\"Illegal option: -erropt\")\n+                .shouldContain(\"Please type jarsigner --help for usage\")\n@@ -42,0 +46,48 @@\n+\n+        SecurityTools.jarsigner(\"-verify -erropt\")\n+                .shouldContain(\"Illegal option: -erropt\")\n+                .shouldContain(\"Please type jarsigner --help for usage\")\n+                .shouldHaveExitValue(1);\n+\n+        SecurityTools.jarsigner(\"-version --help\")\n+                .shouldContain(\"Usage: jarsigner [options] jar-file alias\")\n+                .shouldContain(\"[-verify]                   verify a signed JAR file\")\n+                .shouldContain(\"[-version]                  print the program version\")\n+                .shouldHaveExitValue(0);\n+\n+        SecurityTools.jarsigner(\"--help -version\")\n+                .shouldContain(\"Usage: jarsigner [options] jar-file alias\")\n+                .shouldContain(\"[-verify]                   verify a signed JAR file\")\n+                .shouldContain(\"[-version]                  print the program version\")\n+                .shouldHaveExitValue(0);\n+\n+        SecurityTools.jarsigner(\"-verify --help\")\n+                .shouldContain(\"Usage: jarsigner [options] jar-file alias\")\n+                .shouldContain(\"[-verify]                   verify a signed JAR file\")\n+                .shouldContain(\"[-version]                  print the program version\")\n+                .shouldHaveExitValue(0);\n+\n+        SecurityTools.jarsigner(\"--help\")\n+                .shouldContain(\"Usage: jarsigner [options] jar-file alias\")\n+                .shouldContain(\"[-verify]                   verify a signed JAR file\")\n+                .shouldContain(\"[-version]                  print the program version\")\n+                .shouldHaveExitValue(0);\n+\n+        SecurityTools.keytool(\"-genkeypair -keystore ks -storepass changeit\" +\n+                \" -keyalg rsa -dname CN=ee -alias ee\")\n+                .shouldHaveExitValue(0);\n+\n+        JarUtils.createJarFile(Path.of(\"a.jar\"), Path.of(\".\"), Path.of(\".\"));\n+\n+        \/\/ -version option is specified at the end with other options\n+        SecurityTools.jarsigner(\"-keystore ks -storepass changeit\" +\n+                \" -signedjar signeda.jar a.jar ee -version\")\n+                .shouldContain(\"jar signed.\")\n+                .shouldContain(\"jarsigner \")\n+                .shouldHaveExitValue(0);\n+\n+        \/\/ -version option is specified at the beginning with other options\n+        SecurityTools.jarsigner(\"-version -verify a.jar\")\n+                .shouldContain(\"jar is unsigned.\")\n+                .shouldContain(\"jarsigner \")\n+                .shouldHaveExitValue(0);\n","filename":"test\/jdk\/sun\/security\/tools\/jarsigner\/VersionTest.java","additions":53,"deletions":1,"binary":false,"changes":54,"status":"modified"},{"patch":"@@ -40,1 +40,4 @@\n-        SecurityTools.keytool(\"-version -extraopt\")\n+        SecurityTools.keytool(\"-version -erropt\")\n+                .shouldContain(\"Illegal option:  -erropt\")\n+                .shouldContain(\"Prints the program version\")\n+                .shouldContain(\"Use \\\"keytool -?, -h, or --help\\\" for this help message\")\n@@ -42,0 +45,26 @@\n+\n+        SecurityTools.keytool(\"-genkeypair -erropt\")\n+                .shouldContain(\"Illegal option:  -erropt\")\n+                .shouldContain(\"Generates a key pair\")\n+                .shouldContain(\"Use \\\"keytool -?, -h, or --help\\\" for this help message\")\n+                .shouldHaveExitValue(1);\n+\n+        SecurityTools.keytool(\"-version --help\")\n+                .shouldContain(\"Prints the program version\")\n+                .shouldContain(\"Use \\\"keytool -?, -h, or --help\\\" for this help message\")\n+                .shouldHaveExitValue(0);\n+\n+        SecurityTools.keytool(\"--help -version\")\n+                .shouldContain(\"Prints the program version\")\n+                .shouldContain(\"Use \\\"keytool -?, -h, or --help\\\" for this help message\")\n+                .shouldHaveExitValue(0);\n+\n+        SecurityTools.keytool(\"-genkeypair --help\")\n+                .shouldContain(\"Generates a key pair\")\n+                .shouldContain(\"Use \\\"keytool -?, -h, or --help\\\" for this help message\")\n+                .shouldHaveExitValue(0);\n+\n+        SecurityTools.keytool(\"--help\")\n+                .shouldContain(\"-genkeypair         Generates a key pair\")\n+                .shouldContain(\"-version            Prints the program version\")\n+                .shouldHaveExitValue(0);\n","filename":"test\/jdk\/sun\/security\/tools\/keytool\/VersionTest.java","additions":30,"deletions":1,"binary":false,"changes":31,"status":"modified"}]}