{"files":[{"patch":"@@ -27,0 +27,1 @@\n+#include \"cds\/cdsConfig.hpp\"\n@@ -141,1 +142,1 @@\n-  assert(DumpSharedSpaces, \"dump-time only\");\n+  assert(CDSConfig::is_dumping_heap(), \"dump-time only\");\n","filename":"src\/hotspot\/share\/cds\/archiveHeapWriter.cpp","additions":2,"deletions":1,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -29,0 +29,1 @@\n+#include \"cds\/cdsConfig.hpp\"\n@@ -176,1 +177,1 @@\n-  Arguments::assert_is_dumping_archive();\n+  assert(CDSConfig::is_dumping_archive(), \"sanity\");\n","filename":"src\/hotspot\/share\/cds\/archiveUtils.cpp","additions":2,"deletions":1,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -0,0 +1,46 @@\n+\/*\n+ * Copyright (c) 2023, Oracle and\/or its affiliates. All rights reserved.\n+ * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+ *\n+ * This code is free software; you can redistribute it and\/or modify it\n+ * under the terms of the GNU General Public License version 2 only, as\n+ * published by the Free Software Foundation.\n+ *\n+ * This code is distributed in the hope that it will be useful, but WITHOUT\n+ * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+ * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+ * version 2 for more details (a copy is included in the LICENSE file that\n+ * accompanied this code).\n+ *\n+ * You should have received a copy of the GNU General Public License version\n+ * 2 along with this work; if not, write to the Free Software Foundation,\n+ * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n+ *\n+ * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n+ * or visit www.oracle.com if you need additional information or have any\n+ * questions.\n+ *\n+ *\/\n+\n+#include \"precompiled.hpp\"\n+#include \"cds\/cdsConfig.hpp\"\n+#include \"cds\/heapShared.hpp\"\n+\n+bool CDSConfig::is_dumping_archive() {\n+  return is_dumping_static_archive() || is_dumping_dynamic_archive();\n+}\n+\n+bool CDSConfig::is_dumping_static_archive() {\n+  return DumpSharedSpaces;\n+}\n+\n+bool CDSConfig::is_dumping_dynamic_archive() {\n+  return DynamicDumpSharedSpaces;\n+}\n+\n+#if INCLUDE_CDS_JAVA_HEAP\n+bool CDSConfig::is_dumping_heap() {\n+  \/\/ heap dump is not supported in dynamic dump\n+  return is_dumping_static_archive() && HeapShared::can_write();\n+}\n+#endif \/\/ INCLUDE_CDS_JAVA_HEAP\n","filename":"src\/hotspot\/share\/cds\/cdsConfig.cpp","additions":46,"deletions":0,"binary":false,"changes":46,"status":"added"},{"patch":"@@ -0,0 +1,42 @@\n+\/*\n+ * Copyright (c) 2023, Oracle and\/or its affiliates. All rights reserved.\n+ * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+ *\n+ * This code is free software; you can redistribute it and\/or modify it\n+ * under the terms of the GNU General Public License version 2 only, as\n+ * published by the Free Software Foundation.\n+ *\n+ * This code is distributed in the hope that it will be useful, but WITHOUT\n+ * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+ * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+ * version 2 for more details (a copy is included in the LICENSE file that\n+ * accompanied this code).\n+ *\n+ * You should have received a copy of the GNU General Public License version\n+ * 2 along with this work; if not, write to the Free Software Foundation,\n+ * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n+ *\n+ * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n+ * or visit www.oracle.com if you need additional information or have any\n+ * questions.\n+ *\n+ *\/\n+\n+#ifndef SHARE_CDS_CDSCONFIG_HPP\n+#define SHARE_CDS_CDSCONFIG_HPP\n+\n+#include \"memory\/allStatic.hpp\"\n+#include \"utilities\/macros.hpp\"\n+\n+class CDSConfig : public AllStatic {\n+public:\n+  \/\/ Basic CDS features\n+  static bool      is_dumping_archive()                      NOT_CDS_RETURN_(false);\n+  static bool      is_dumping_static_archive()               NOT_CDS_RETURN_(false);\n+  static bool      is_dumping_dynamic_archive()              NOT_CDS_RETURN_(false);\n+\n+  \/\/ CDS archived heap\n+  static bool      is_dumping_heap()                         NOT_CDS_JAVA_HEAP_RETURN_(false);\n+};\n+\n+#endif \/\/ SHARE_CDS_CDSCONFIG_HPP\n","filename":"src\/hotspot\/share\/cds\/cdsConfig.hpp","additions":42,"deletions":0,"binary":false,"changes":42,"status":"added"},{"patch":"@@ -28,0 +28,1 @@\n+#include \"cds\/cdsConfig.hpp\"\n@@ -243,1 +244,1 @@\n-  Arguments::assert_is_dumping_archive();\n+  assert(CDSConfig::is_dumping_archive(), \"sanity\");\n","filename":"src\/hotspot\/share\/cds\/cppVtables.cpp","additions":2,"deletions":1,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -31,0 +31,1 @@\n+#include \"cds\/cdsConfig.hpp\"\n@@ -206,1 +207,1 @@\n-  if (DumpSharedSpaces && HeapShared::can_write()) {\n+  if (CDSConfig::is_dumping_heap()) {\n@@ -305,1 +306,1 @@\n-  Arguments::assert_is_dumping_archive();\n+  assert(CDSConfig::is_dumping_archive(), \"sanity\");\n@@ -465,1 +466,1 @@\n-  Arguments::assert_is_dumping_archive();\n+  assert(CDSConfig::is_dumping_archive(), \"sanity\");\n@@ -512,1 +513,1 @@\n-  Arguments::assert_is_dumping_archive();\n+  assert(CDSConfig::is_dumping_archive(), \"sanity\");\n@@ -539,1 +540,1 @@\n-  Arguments::assert_is_dumping_archive();\n+  assert(CDSConfig::is_dumping_archive(), \"sanity\");\n@@ -548,1 +549,1 @@\n-  Arguments::assert_is_dumping_archive();\n+  assert(CDSConfig::is_dumping_archive(), \"sanity\");\n@@ -689,1 +690,1 @@\n-  Arguments::assert_is_dumping_archive();\n+  assert(CDSConfig::is_dumping_archive(), \"sanity\");\n@@ -1511,1 +1512,1 @@\n-  Arguments::assert_is_dumping_archive();\n+  assert(CDSConfig::is_dumping_archive(), \"sanity\");\n","filename":"src\/hotspot\/share\/cds\/filemap.cpp","additions":9,"deletions":8,"binary":false,"changes":17,"status":"modified"},{"patch":"@@ -30,0 +30,1 @@\n+#include \"cds\/cdsConfig.hpp\"\n@@ -182,1 +183,1 @@\n-  assert(DumpSharedSpaces, \"dump-time only\");\n+  assert(CDSConfig::is_dumping_heap(), \"dump-time only\");\n@@ -209,1 +210,1 @@\n-  assert(DumpSharedSpaces, \"dump-time only\");\n+  assert(CDSConfig::is_dumping_heap(), \"dump-time only\");\n@@ -214,1 +215,1 @@\n-  assert(DumpSharedSpaces, \"dump-time only\");\n+  assert(CDSConfig::is_dumping_heap(), \"dump-time only\");\n@@ -227,1 +228,1 @@\n-  if (DumpSharedSpaces) {\n+  if (CDSConfig::is_dumping_heap()) {\n@@ -244,1 +245,1 @@\n-  assert(!DumpSharedSpaces && UseSharedSpaces, \"runtime only\");\n+  assert(!CDSConfig::is_dumping_heap() && UseSharedSpaces, \"runtime only\");\n@@ -266,1 +267,1 @@\n-  assert(DumpSharedSpaces, \"dump-time only\");\n+  assert(CDSConfig::is_dumping_heap(), \"dump-time only\");\n@@ -602,1 +603,1 @@\n-  assert(DumpSharedSpaces, \"dump time only\");\n+  assert(CDSConfig::is_dumping_heap(), \"dump time only\");\n@@ -613,1 +614,1 @@\n-  assert(DumpSharedSpaces, \"dump time only\");\n+  assert(CDSConfig::is_dumping_heap(), \"dump time only\");\n@@ -621,1 +622,1 @@\n-  assert(DumpSharedSpaces, \"dump time only\");\n+  assert(CDSConfig::is_dumping_heap(), \"dump time only\");\n@@ -633,1 +634,1 @@\n-  assert(DumpSharedSpaces, \"dump time only\");\n+  assert(CDSConfig::is_dumping_heap(), \"dump time only\");\n@@ -949,1 +950,1 @@\n-  assert(!DumpSharedSpaces, \"Should not be called with DumpSharedSpaces\");\n+  assert(!CDSConfig::is_dumping_heap(), \"Should not be called when dumping heap\");\n@@ -1246,1 +1247,1 @@\n-  assert(DumpSharedSpaces, \"dump time only\");\n+  assert(CDSConfig::is_dumping_heap(), \"dump time only\");\n@@ -1297,1 +1298,1 @@\n-  assert(DumpSharedSpaces, \"dump time only\");\n+  assert(CDSConfig::is_dumping_heap(), \"dump time only\");\n","filename":"src\/hotspot\/share\/cds\/heapShared.cpp","additions":14,"deletions":13,"binary":false,"changes":27,"status":"modified"},{"patch":"@@ -30,0 +30,1 @@\n+#include \"cds\/cdsConfig.hpp\"\n@@ -643,1 +644,1 @@\n-  Arguments::assert_is_dumping_archive();\n+  assert(CDSConfig::is_dumping_archive(), \"sanity\");\n@@ -670,1 +671,1 @@\n-  if (!DumpSharedSpaces || UseCompressedOops) {\n+  if (!CDSConfig::is_dumping_heap() || UseCompressedOops) {\n@@ -777,4 +778,6 @@\n-  StringTable::allocate_shared_strings_array(CHECK);\n-  ArchiveHeapWriter::init();\n-  if (use_full_module_graph()) {\n-    HeapShared::reset_archived_object_states(CHECK);\n+  if (CDSConfig::is_dumping_heap()) {\n+    StringTable::allocate_shared_strings_array(CHECK);\n+    ArchiveHeapWriter::init();\n+    if (use_full_module_graph()) {\n+      HeapShared::reset_archived_object_states(CHECK);\n+    }\n@@ -792,1 +795,1 @@\n-  Arguments::assert_is_dumping_archive();\n+  assert(CDSConfig::is_dumping_archive(), \"sanity\");\n","filename":"src\/hotspot\/share\/cds\/metaspaceShared.cpp","additions":10,"deletions":7,"binary":false,"changes":17,"status":"modified"},{"patch":"@@ -25,0 +25,1 @@\n+#include \"cds\/cdsConfig.hpp\"\n@@ -2855,1 +2856,1 @@\n-  if (JvmtiExport::can_maintain_original_method_order() || Arguments::is_dumping_archive()) {\n+  if (JvmtiExport::can_maintain_original_method_order() || CDSConfig::is_dumping_archive()) {\n@@ -2869,1 +2870,1 @@\n-  if (JvmtiExport::can_maintain_original_method_order() || Arguments::is_dumping_archive()) {\n+  if (JvmtiExport::can_maintain_original_method_order() || CDSConfig::is_dumping_archive()) {\n","filename":"src\/hotspot\/share\/classfile\/classFileParser.cpp","additions":3,"deletions":2,"binary":false,"changes":5,"status":"modified"},{"patch":"@@ -27,0 +27,1 @@\n+#include \"cds\/cdsConfig.hpp\"\n@@ -449,1 +450,1 @@\n-  Arguments::assert_is_dumping_archive();\n+  assert(CDSConfig::is_dumping_archive(), \"sanity\");\n@@ -519,1 +520,1 @@\n-  Arguments::assert_is_dumping_archive();\n+  assert(CDSConfig::is_dumping_archive(), \"sanity\");\n@@ -534,1 +535,1 @@\n-  Arguments::assert_is_dumping_archive();\n+  assert(CDSConfig::is_dumping_archive(), \"sanity\");\n@@ -548,1 +549,1 @@\n-  Arguments::assert_is_dumping_archive();\n+  assert(CDSConfig::is_dumping_archive(), \"sanity\");\n@@ -636,1 +637,1 @@\n-  if (Arguments::is_dumping_archive()) {\n+  if (CDSConfig::is_dumping_archive()) {\n@@ -1252,1 +1253,1 @@\n-  Arguments::assert_is_dumping_archive();\n+  assert(CDSConfig::is_dumping_archive(), \"sanity\");\n@@ -1446,1 +1447,1 @@\n-  if (Arguments::is_dumping_archive()) {\n+  if (CDSConfig::is_dumping_archive()) {\n@@ -1452,1 +1453,1 @@\n-  if (Arguments::is_dumping_archive()) {\n+  if (CDSConfig::is_dumping_archive()) {\n@@ -1461,1 +1462,1 @@\n-  Arguments::assert_is_dumping_archive();\n+  assert(CDSConfig::is_dumping_archive(), \"sanity\");\n","filename":"src\/hotspot\/share\/classfile\/classLoader.cpp","additions":10,"deletions":9,"binary":false,"changes":19,"status":"modified"},{"patch":"@@ -30,0 +30,1 @@\n+#include \"cds\/cdsConfig.hpp\"\n@@ -31,1 +32,0 @@\n-#include \"runtime\/arguments.hpp\"\n@@ -73,1 +73,1 @@\n-  Arguments::assert_is_dumping_archive();\n+  assert(CDSConfig::is_dumping_archive(), \"sanity\");\n@@ -95,1 +95,1 @@\n-  Arguments::assert_is_dumping_archive();\n+  assert(CDSConfig::is_dumping_archive(), \"sanity\");\n","filename":"src\/hotspot\/share\/classfile\/classLoader.inline.hpp","additions":3,"deletions":3,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -27,0 +27,1 @@\n+#include \"cds\/cdsConfig.hpp\"\n@@ -73,1 +74,1 @@\n-  Arguments::assert_is_dumping_archive();\n+  assert(CDSConfig::is_dumping_archive(), \"sanity\");\n@@ -124,1 +125,1 @@\n-  Arguments::assert_is_dumping_archive();\n+  assert(CDSConfig::is_dumping_archive(), \"sanity\");\n@@ -260,1 +261,1 @@\n-  Arguments::assert_is_dumping_archive();\n+  assert(CDSConfig::is_dumping_archive(), \"sanity\");\n","filename":"src\/hotspot\/share\/classfile\/classLoaderExt.cpp","additions":4,"deletions":3,"binary":false,"changes":7,"status":"modified"},{"patch":"@@ -28,0 +28,1 @@\n+#include \"cds\/cdsConfig.hpp\"\n@@ -33,1 +34,0 @@\n-#include \"runtime\/arguments.hpp\"\n@@ -35,0 +35,1 @@\n+#include \"runtime\/java.hpp\"\n@@ -47,1 +48,1 @@\n-  Arguments::assert_is_dumping_archive();\n+  assert(CDSConfig::is_dumping_archive(), \"sanity\");\n","filename":"src\/hotspot\/share\/classfile\/compactHashtable.cpp","additions":3,"deletions":2,"binary":false,"changes":5,"status":"modified"},{"patch":"@@ -26,0 +26,1 @@\n+#include \"cds\/cdsConfig.hpp\"\n@@ -39,1 +40,0 @@\n-#include \"runtime\/arguments.hpp\"\n@@ -1072,1 +1072,1 @@\n-  if (JvmtiExport::can_maintain_original_method_order() || Arguments::is_dumping_archive()) {\n+  if (JvmtiExport::can_maintain_original_method_order() || CDSConfig::is_dumping_archive()) {\n","filename":"src\/hotspot\/share\/classfile\/defaultMethods.cpp","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -26,0 +26,1 @@\n+#include \"cds\/cdsConfig.hpp\"\n@@ -42,1 +43,0 @@\n-#include \"runtime\/arguments.hpp\"\n@@ -214,1 +214,1 @@\n-  Arguments::assert_is_dumping_archive();\n+  assert(CDSConfig::is_dumping_archive(), \"sanity\");\n","filename":"src\/hotspot\/share\/classfile\/dictionary.cpp","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -28,0 +28,1 @@\n+#include \"cds\/cdsConfig.hpp\"\n@@ -1067,1 +1068,1 @@\n-    if (DumpSharedSpaces) {\n+    if (CDSConfig::is_dumping_heap()) {\n@@ -1369,1 +1370,1 @@\n-  if (DumpSharedSpaces) {\n+  if (CDSConfig::is_dumping_heap()) {\n","filename":"src\/hotspot\/share\/classfile\/javaClasses.cpp","additions":3,"deletions":2,"binary":false,"changes":5,"status":"modified"},{"patch":"@@ -26,0 +26,1 @@\n+#include \"cds\/cdsConfig.hpp\"\n@@ -37,1 +38,0 @@\n-#include \"runtime\/arguments.hpp\"\n@@ -215,1 +215,1 @@\n-  if (Arguments::is_dumping_archive()) {\n+  if (CDSConfig::is_dumping_archive()) {\n","filename":"src\/hotspot\/share\/classfile\/klassFactory.cpp","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -29,0 +29,1 @@\n+#include \"cds\/cdsConfig.hpp\"\n@@ -808,1 +809,1 @@\n-  assert(DumpSharedSpaces, \"must be\");\n+  assert(CDSConfig::is_dumping_heap(), \"must be\");\n","filename":"src\/hotspot\/share\/classfile\/stringTable.cpp","additions":2,"deletions":1,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -26,0 +26,1 @@\n+#include \"cds\/cdsConfig.hpp\"\n@@ -1785,1 +1786,1 @@\n-    if (Arguments::is_dumping_archive() && klass_being_linked != nullptr &&\n+    if (CDSConfig::is_dumping_archive() && klass_being_linked != nullptr &&\n","filename":"src\/hotspot\/share\/classfile\/systemDictionary.cpp","additions":2,"deletions":1,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -29,0 +29,1 @@\n+#include \"cds\/cdsConfig.hpp\"\n@@ -199,1 +200,1 @@\n-    assert(DynamicDumpSharedSpaces, \"must be\");\n+    assert(CDSConfig::is_dumping_dynamic_archive(), \"must be\");\n@@ -438,1 +439,1 @@\n-  assert(Arguments::is_dumping_archive() || ClassListWriter::is_enabled(), \"sanity\");\n+  assert(CDSConfig::is_dumping_archive() || ClassListWriter::is_enabled(), \"sanity\");\n@@ -492,1 +493,1 @@\n-  Arguments::assert_is_dumping_archive();\n+  assert(CDSConfig::is_dumping_archive(), \"sanity\");\n@@ -500,1 +501,1 @@\n-  if (Arguments::is_dumping_archive()) {\n+  if (CDSConfig::is_dumping_archive()) {\n@@ -519,1 +520,1 @@\n-  if (Arguments::is_dumping_archive()) {\n+  if (CDSConfig::is_dumping_archive()) {\n@@ -523,1 +524,1 @@\n-  if (Arguments::is_dumping_archive() || ClassListWriter::is_enabled()) {\n+  if (CDSConfig::is_dumping_archive() || ClassListWriter::is_enabled()) {\n@@ -628,1 +629,1 @@\n-  if (DynamicDumpSharedSpaces) {\n+  if (CDSConfig::is_dumping_dynamic_archive()) {\n@@ -649,1 +650,1 @@\n-  Arguments::assert_is_dumping_archive();\n+  assert(CDSConfig::is_dumping_archive(), \"sanity\");\n@@ -656,1 +657,1 @@\n-  Arguments::assert_is_dumping_archive();\n+  assert(CDSConfig::is_dumping_archive(), \"sanity\");\n@@ -662,1 +663,1 @@\n-  Arguments::assert_is_dumping_archive();\n+  assert(CDSConfig::is_dumping_archive(), \"sanity\");\n@@ -668,1 +669,1 @@\n-  Arguments::assert_is_dumping_archive();\n+  assert(CDSConfig::is_dumping_archive(), \"sanity\");\n@@ -674,1 +675,1 @@\n-  Arguments::assert_is_dumping_archive();\n+  assert(CDSConfig::is_dumping_archive(), \"sanity\");\n@@ -700,1 +701,1 @@\n-  Arguments::assert_is_dumping_archive();\n+  assert(CDSConfig::is_dumping_archive(), \"sanity\");\n@@ -705,1 +706,1 @@\n-  if (DynamicDumpSharedSpaces) {\n+  if (CDSConfig::is_dumping_dynamic_archive()) {\n@@ -996,1 +997,1 @@\n-  Arguments::assert_is_dumping_archive();\n+  assert(CDSConfig::is_dumping_archive(), \"sanity\");\n","filename":"src\/hotspot\/share\/classfile\/systemDictionaryShared.cpp","additions":16,"deletions":15,"binary":false,"changes":31,"status":"modified"},{"patch":"@@ -26,0 +26,1 @@\n+#include \"cds\/cdsConfig.hpp\"\n@@ -35,1 +36,0 @@\n-#include \"runtime\/arguments.hpp\"\n@@ -112,1 +112,1 @@\n-    if (Arguments::is_dumping_archive()) {\n+    if (CDSConfig::is_dumping_archive()) {\n","filename":"src\/hotspot\/share\/classfile\/verificationType.cpp","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -26,0 +26,1 @@\n+#include \"cds\/cdsConfig.hpp\"\n@@ -458,1 +459,1 @@\n-  if (DumpSharedSpaces) {\n+  if (CDSConfig::is_dumping_heap()) {\n","filename":"src\/hotspot\/share\/gc\/shared\/collectedHeap.cpp","additions":2,"deletions":1,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -26,0 +26,1 @@\n+#include \"cds\/cdsConfig.hpp\"\n@@ -38,1 +39,0 @@\n-#include \"runtime\/arguments.hpp\"\n@@ -121,1 +121,1 @@\n-  if (!HAS_PENDING_EXCEPTION && Arguments::is_dumping_archive()) {\n+  if (!HAS_PENDING_EXCEPTION && CDSConfig::is_dumping_archive()) {\n","filename":"src\/hotspot\/share\/interpreter\/rewriter.cpp","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -26,0 +26,1 @@\n+#include \"cds\/cdsConfig.hpp\"\n@@ -53,1 +54,0 @@\n-#include \"runtime\/arguments.hpp\"\n@@ -2448,1 +2448,1 @@\n-              if (REWRITE_BYTECODES && !UseSharedSpaces && !Arguments::is_dumping_archive()) {\n+              if (REWRITE_BYTECODES && !UseSharedSpaces && !CDSConfig::is_dumping_archive()) {\n","filename":"src\/hotspot\/share\/interpreter\/zero\/bytecodeInterpreter.cpp","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -26,0 +26,1 @@\n+#include \"cds\/cdsConfig.hpp\"\n@@ -188,1 +189,1 @@\n-  if (Arguments::is_dumping_archive() && JfrOptionSet::start_flight_recording_options() != nullptr) {\n+  if (CDSConfig::is_dumping_archive() && JfrOptionSet::start_flight_recording_options() != nullptr) {\n@@ -230,1 +231,1 @@\n-  return Arguments::is_dumping_archive() || launch_command_line_recordings(JavaThread::current());\n+  return CDSConfig::is_dumping_archive() || launch_command_line_recordings(JavaThread::current());\n","filename":"src\/hotspot\/share\/jfr\/recorder\/jfrRecorder.cpp","additions":3,"deletions":2,"binary":false,"changes":5,"status":"modified"},{"patch":"@@ -27,0 +27,1 @@\n+#include \"cds\/cdsConfig.hpp\"\n@@ -825,1 +826,1 @@\n-  if (Arguments::is_dumping_archive()) {\n+  if (CDSConfig::is_dumping_archive()) {\n","filename":"src\/hotspot\/share\/memory\/universe.cpp","additions":2,"deletions":1,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -29,0 +29,1 @@\n+#include \"cds\/cdsConfig.hpp\"\n@@ -222,1 +223,1 @@\n-    if (DumpSharedSpaces) {\n+    if (CDSConfig::is_dumping_heap()) {\n","filename":"src\/hotspot\/share\/oops\/constantPool.cpp","additions":2,"deletions":1,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -27,0 +27,1 @@\n+#include \"cds\/cdsConfig.hpp\"\n@@ -707,1 +708,1 @@\n-  Arguments::assert_is_dumping_archive();\n+  assert(CDSConfig::is_dumping_archive(), \"sanity\");\n@@ -741,1 +742,1 @@\n-    Arguments::assert_is_dumping_archive();\n+    assert(CDSConfig::is_dumping_archive(), \"sanity\");\n","filename":"src\/hotspot\/share\/oops\/cpCache.cpp","additions":3,"deletions":2,"binary":false,"changes":5,"status":"modified"},{"patch":"@@ -27,0 +27,1 @@\n+#include \"cds\/cdsConfig.hpp\"\n@@ -705,1 +706,1 @@\n-  if (DumpSharedSpaces) {\n+  if (CDSConfig::is_dumping_heap()) {\n@@ -4090,1 +4091,1 @@\n-        ((UseSharedSpaces || Arguments::is_dumping_archive()) && length != 0)) {\n+        ((UseSharedSpaces || CDSConfig::is_dumping_archive()) && length != 0)) {\n","filename":"src\/hotspot\/share\/oops\/instanceKlass.cpp","additions":3,"deletions":2,"binary":false,"changes":5,"status":"modified"},{"patch":"@@ -27,0 +27,1 @@\n+#include \"cds\/cdsConfig.hpp\"\n@@ -51,1 +52,0 @@\n-#include \"runtime\/arguments.hpp\"\n@@ -88,1 +88,1 @@\n-  if (Arguments::is_dumping_archive() && is_instance_klass()) {\n+  if (CDSConfig::is_dumping_archive() && is_instance_klass()) {\n@@ -523,1 +523,1 @@\n-  if (!Arguments::is_dumping_archive()) {\n+  if (!CDSConfig::is_dumping_archive()) {\n@@ -540,1 +540,1 @@\n-  assert (Arguments::is_dumping_archive(),\n+  assert(CDSConfig::is_dumping_archive(),\n@@ -558,1 +558,1 @@\n-  Arguments::assert_is_dumping_archive();\n+  assert(CDSConfig::is_dumping_archive(), \"sanity\");\n@@ -648,1 +648,1 @@\n-  assert(DumpSharedSpaces, \"called only during dumptime\");\n+  assert(CDSConfig::is_dumping_heap(), \"sanity\");\n","filename":"src\/hotspot\/share\/oops\/klass.cpp","additions":6,"deletions":6,"binary":false,"changes":12,"status":"modified"},{"patch":"@@ -26,0 +26,1 @@\n+#include \"cds\/cdsConfig.hpp\"\n@@ -62,1 +63,0 @@\n-#include \"runtime\/arguments.hpp\"\n@@ -68,0 +68,1 @@\n+#include \"runtime\/java.hpp\"\n@@ -1169,1 +1170,1 @@\n-  Arguments::assert_is_dumping_archive();\n+  assert(CDSConfig::is_dumping_archive(), \"sanity\");\n","filename":"src\/hotspot\/share\/oops\/method.cpp","additions":3,"deletions":2,"binary":false,"changes":5,"status":"modified"},{"patch":"@@ -26,0 +26,1 @@\n+#include \"cds\/cdsConfig.hpp\"\n@@ -165,1 +166,1 @@\n-  assert(DumpSharedSpaces, \"Used by CDS only. Do not abuse!\");\n+  assert(CDSConfig::is_dumping_heap(), \"Used by CDS only. Do not abuse!\");\n","filename":"src\/hotspot\/share\/oops\/oop.cpp","additions":2,"deletions":1,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -26,0 +26,1 @@\n+#include \"cds\/cdsConfig.hpp\"\n@@ -3609,1 +3610,1 @@\n-  if (!Arguments::is_dumping_archive()) {\n+  if (!CDSConfig::is_dumping_archive()) {\n@@ -3697,1 +3698,1 @@\n-  return Arguments::is_dumping_archive();\n+  return CDSConfig::is_dumping_archive();\n","filename":"src\/hotspot\/share\/prims\/jvm.cpp","additions":3,"deletions":2,"binary":false,"changes":5,"status":"modified"},{"patch":"@@ -28,0 +28,1 @@\n+#include \"cds\/cdsConfig.hpp\"\n@@ -626,1 +627,1 @@\n-  assert(Arguments::is_dumping_archive(), \"invariant\");\n+  assert(CDSConfig::is_dumping_archive(), \"invariant\");\n@@ -642,1 +643,1 @@\n-  if (Arguments::is_dumping_archive()) {\n+  if (CDSConfig::is_dumping_archive()) {\n","filename":"src\/hotspot\/share\/prims\/jvmtiAgent.cpp","additions":3,"deletions":2,"binary":false,"changes":5,"status":"modified"},{"patch":"@@ -27,0 +27,1 @@\n+#include \"cds\/cdsConfig.hpp\"\n@@ -1335,1 +1336,1 @@\n-  assert(is_dumping_archive(),\n+  assert(CDSConfig::is_dumping_archive(),\n@@ -3454,1 +3455,1 @@\n-    if (is_dumping_archive() && archives > 1) {\n+    if (CDSConfig::is_dumping_archive() && archives > 1) {\n","filename":"src\/hotspot\/share\/runtime\/arguments.cpp","additions":3,"deletions":2,"binary":false,"changes":5,"status":"modified"},{"patch":"@@ -528,6 +528,0 @@\n-  static bool is_dumping_archive() { return DumpSharedSpaces || DynamicDumpSharedSpaces; }\n-\n-  static void assert_is_dumping_archive() {\n-    assert(Arguments::is_dumping_archive(), \"dump time only\");\n-  }\n-\n","filename":"src\/hotspot\/share\/runtime\/arguments.hpp","additions":0,"deletions":6,"binary":false,"changes":6,"status":"modified"}]}