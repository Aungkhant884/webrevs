{"files":[{"patch":"@@ -596,0 +596,3 @@\n+  # Unset the following to suppress the link to the tool guides\n+  NAV_LINK_GUIDES = --nav-link-guides\n+  HEADER_RIGHT_SIDE_INFO = '<strong>$(subst &amp;,&,$(JDK_SHORT_NAME))$(DRAFT_MARKER_STR)<\/strong>'\n@@ -612,1 +615,2 @@\n-            POST_PROCESS := $(TOOL_FIXUPPANDOC), \\\n+            POST_PROCESS := $(TOOL_FIXUPPANDOC) --insert-nav --nav-right-info $(HEADER_RIGHT_SIDE_INFO) \\\n+                --nav-subdirs $($m_$f_NOF_SUBDIRS) $(NAV_LINK_GUIDES), \\\n@@ -646,1 +650,2 @@\n-            POST_PROCESS := $(TOOL_FIXUPPANDOC), \\\n+            POST_PROCESS := $(TOOL_FIXUPPANDOC) --insert-nav --nav-right-info $(HEADER_RIGHT_SIDE_INFO) \\\n+                --nav-subdirs 1 --nav-link-guides, \\\n","filename":"make\/Docs.gmk","additions":7,"deletions":2,"binary":false,"changes":9,"status":"modified"},{"patch":"@@ -160,1 +160,0 @@\n-  background-color: #CBDAE4;\n@@ -186,0 +185,52 @@\n+\n+header#title-block-header {\n+    margin-top:-2em;\n+}\n+\n+header#title-block-header div.navbar {\n+    margin: 0 -2.5em 2.5em -2.5em;\n+    padding: 0 2.5em;\n+    background-color:#4D7A97;\n+    color:#FFFFFF;\n+    float:left;\n+    width:100%;\n+    clear:right;\n+    min-height:2.8em;\n+    padding-top:10px;\n+    overflow:hidden;\n+    font-size:12px;\n+}\n+\n+header#title-block-header div.navbar div {\n+    float:right;\n+    font-size:11px;\n+    height:2.9em;\n+    margin: auto 0;\n+}\n+\n+header#title-block-header ul {\n+    display:block;\n+    margin:0 25px 0 0;\n+    padding:0;\n+}\n+header#title-block-header ul li {\n+    list-style:none;\n+    float:left;\n+    padding: 5px 6px;\n+    text-transform:uppercase;\n+}\n+\n+header#title-block-header li.no-link {\n+    background-color:#F8981D;\n+    color:#253441;\n+    margin: auto 5px;\n+}\n+\n+header#title-block-header a:link, header#title-block-header a:active, header#title-block-header a:visited {\n+    color:#ffffff;\n+    text-decoration:none;\n+    text-transform:uppercase;\n+}\n+header#title-block-header a:hover {\n+    color:#bb7a2a;\n+}\n","filename":"make\/data\/docs-resources\/resources\/jdk-default.css","additions":52,"deletions":1,"binary":false,"changes":53,"status":"modified"},{"patch":"@@ -40,0 +40,1 @@\n+import java.util.Arrays;\n@@ -49,0 +50,2 @@\n+import java.util.stream.Collectors;\n+\n@@ -123,0 +126,1 @@\n+        NavBar navbar = null;\n@@ -128,0 +132,8 @@\n+            } else if (arg.equals(\"--insert-nav\")) {\n+                navbar = new NavBar();\n+            } else if (arg.equals(\"--nav-right-info\") && i + 1 < args.length) {\n+                navbar.rightSideInfo(args[++i]);\n+            } else if (arg.equals(\"--nav-subdirs\") && i + 1 < args.length) {\n+                navbar.subdirs(Integer.parseInt(args[++i]));\n+            } else if (arg.equals(\"--nav-link-guides\")) {\n+                navbar.linkGuides(true);\n@@ -133,0 +145,1 @@\n+                System.err.println(\"ARGV: \" + Arrays.toString(args));\n@@ -137,1 +150,1 @@\n-        new Fixup().run(inFile, outFile);\n+        new Fixup(navbar).run(inFile, outFile);\n@@ -151,0 +164,3 @@\n+        \/** A manager for the navigation bar, null if not required. *\/\n+        NavBar navbar;\n+\n@@ -177,0 +193,4 @@\n+        Fixup(NavBar navbar) {\n+            this.navbar = navbar;\n+        }\n+\n@@ -285,1 +305,4 @@\n-                    if (name.equals(\"nav\") && Objects.equals(attrs.get(\"id\"), \"TOC\")) {\n+                    if (navbar != null && name.equals(\"header\") && Objects.equals(attrs.get(\"id\"), \"title-block-header\")) {\n+                        flushBuffer();\n+                        navbar.write(out);\n+                    } else if (name.equals(\"nav\") && Objects.equals(attrs.get(\"id\"), \"TOC\")) {\n@@ -439,0 +462,59 @@\n+    class NavBar {\n+        private int subdirs = 0;\n+        private boolean linkGuides = false;\n+        private String rightSideInfo = \"\";\n+\n+        void subdirs(int subdirs) {\n+            this.subdirs = subdirs;\n+        }\n+\n+        void linkGuides(boolean linkGuides) {\n+            this.linkGuides = linkGuides;\n+        }\n+\n+        void rightSideInfo(String rightSideInfo) {\n+            this.rightSideInfo = rightSideInfo;\n+        }\n+\n+        void write(PrintWriter out) {\n+            get().lines().forEach(out::println);\n+        }\n+\n+        String get() {\n+            String pathToSpecs = \"..\/\".repeat(subdirs);\n+            String api = pathToSpecs + \"..\/api\/index.html\";\n+            String specs = pathToSpecs + \"index.html\";\n+            String guides = pathToSpecs + \"man\/index.html\";\n+\n+            StringBuilder sb = new StringBuilder();\n+            sb.append(\"\\n\");\n+            sb.append(\"<div class=\\\"navbar\\\">\"); \/\/ full enclosing banner\n+            if (rightSideInfo != null) {\n+                sb.append(\"<div>\").append(rightSideInfo).append(\"<\/div>\");\n+            }\n+            sb.append(\"<nav>\"); \/\/ nav links\n+            var links = new ArrayList<>(List.of(\n+                    link(api, \"API\"),\n+                    link(specs, \"OTHER SPECIFICATIONS\")\n+                ));\n+            if (linkGuides) {\n+                links.add(link(guides, \"TOOL GUIDES\"));\n+            }\n+            sb.append(list(links));\n+            sb.append(\"<\/nav>\");\n+            sb.append(\"<\/div>\");\n+            sb.append(\"\\n\");\n+            return sb.toString();\n+        }\n+\n+        String list(List<String> items) {\n+            return items.stream()\n+                    .map(i -> \"<li>\" + i)\n+                    .collect(Collectors.joining(\"\\n\", \"<ul>\", \"<\/ul>\"));\n+        }\n+\n+        private String link(String href, String label) {\n+            return \"<a href=\\\"\" + href + \"\\\">\" + label + \"<\/a>\";\n+        }\n+    }\n+\n","filename":"make\/jdk\/src\/classes\/build\/tools\/fixuppandoc\/Main.java","additions":84,"deletions":2,"binary":false,"changes":86,"status":"modified"}]}