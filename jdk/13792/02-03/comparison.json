{"files":[{"patch":"@@ -1217,4 +1217,2 @@\n-  int vtable_base = in_bytes(Klass::vtable_start_offset());\n-  int itentry_off = in_bytes(itableMethodEntry::method_offset());\n-  int scan_step = itableOffsetEntry::size() * wordSize;\n-  int vte_size = vtableEntry::size_in_bytes();\n+  int vtable_start_offset = in_bytes(Klass::vtable_start_offset());\n+  int itable_offset_entry_size = itableOffsetEntry::size() * wordSize;\n@@ -1223,1 +1221,1 @@\n-  assert(vte_size == wordSize, \"else adjust times_vte_scale\");\n+  assert(vtableEntry::size_in_bytes() == wordSize, \"else adjust times_vte_scale\");\n@@ -1225,1 +1223,1 @@\n-  Label L_loop_scan_resolved_entry, L_resolved_found, L_holder_found;\n+  Label L_loop_search_resolved_entry, L_resolved_found, L_holder_found;\n@@ -1227,2 +1225,0 @@\n-  \/\/ temp_itbl_klass = recv_klass.itable[0]\n-  \/\/ scan_temp = &recv_klass.itable[0]\n@@ -1230,1 +1226,3 @@\n-  add(recv_klass, recv_klass, vtable_base + ioffset);\n+  add(recv_klass, recv_klass, vtable_start_offset + ioffset);\n+  \/\/ itableOffsetEntry[] itable = recv_klass + Klass::vtable_start_offset() + Klass::vtable_length_offset();\n+  \/\/ temp_itbl_klass = itable[0]._interface;\n@@ -1233,0 +1231,1 @@\n+  \/\/ scan_temp = &(itable[0]._interface)\n@@ -1240,1 +1239,1 @@\n-  br(Assembler::NE, L_loop_scan_resolved_entry);\n+  br(Assembler::NE, L_loop_search_resolved_entry);\n@@ -1247,1 +1246,1 @@\n-  \/\/     temp_itbl_klass = *(scan_temp += scan_step);\n+  \/\/     temp_itbl_klass = *(scan_temp += itable_offset_entry_size);\n@@ -1253,3 +1252,3 @@\n-  Label L_scan_holder;\n-  bind(L_scan_holder);\n-    ldr(temp_itbl_klass, Address(pre(scan_temp, scan_step)));\n+  Label L_search_holder;\n+  bind(L_search_holder);\n+    ldr(temp_itbl_klass, Address(pre(scan_temp, itable_offset_entry_size)));\n@@ -1258,1 +1257,1 @@\n-    cbnz(temp_itbl_klass, L_scan_holder);\n+    cbnz(temp_itbl_klass, L_search_holder);\n@@ -1264,1 +1263,1 @@\n-  \/\/     temp_itbl_klass = *(scan_temp += scan_step);\n+  \/\/     temp_itbl_klass = *(scan_temp += itable_offset_entry_size);\n@@ -1274,4 +1273,4 @@\n-  Label L_loop_scan_resolved;\n-  bind(L_loop_scan_resolved);\n-    ldr(temp_itbl_klass, Address(pre(scan_temp, scan_step)));\n-  bind(L_loop_scan_resolved_entry);\n+  Label L_loop_search_resolved;\n+  bind(L_loop_search_resolved);\n+    ldr(temp_itbl_klass, Address(pre(scan_temp, itable_offset_entry_size)));\n+  bind(L_loop_search_resolved_entry);\n@@ -1281,1 +1280,1 @@\n-    br(Assembler::NE, L_loop_scan_resolved);\n+    br(Assembler::NE, L_loop_search_resolved);\n@@ -1283,1 +1282,1 @@\n-    cbnz(temp_itbl_klass, L_loop_scan_resolved);\n+    cbnz(temp_itbl_klass, L_loop_search_resolved);\n@@ -1289,1 +1288,1 @@\n-  cbz(holder_offset, L_scan_holder);\n+  cbz(holder_offset, L_search_holder);\n@@ -1295,1 +1294,1 @@\n-  add(recv_klass, recv_klass, (itable_index << 3) + itentry_off - (vtable_base + ioffset));\n+  add(recv_klass, recv_klass, (itable_index << 3) + in_bytes(itableMethodEntry::method_offset()) - vtable_start_offset - ioffset);\n","filename":"src\/hotspot\/cpu\/aarch64\/macroAssembler_aarch64.cpp","additions":23,"deletions":24,"binary":false,"changes":47,"status":"modified"},{"patch":"@@ -200,2 +200,0 @@\n-  const ptrdiff_t lookupSize = __ pc() - start_pc;\n-\n@@ -204,1 +202,1 @@\n-  const ptrdiff_t codesize = lookupSize;\n+  const ptrdiff_t codesize = __ pc() - start_pc;\n","filename":"src\/hotspot\/cpu\/aarch64\/vtableStubs_aarch64.cpp","additions":1,"deletions":3,"binary":false,"changes":4,"status":"modified"}]}