{"files":[{"patch":"@@ -469,0 +469,2 @@\n+            \/\/ We load trust settings from domains kSecTrustSettingsDomainUser and kSecTrustSettingsDomainAdmin\n+            \/\/ kSecTrustSettingsDomainSystem is ignored because it seems to only contain data for root certificates\n@@ -472,3 +474,2 @@\n-            \/\/ Dump everything inside user trustSettings into inputTrust\n-            SecTrustSettingsCopyTrustSettings(certRef, kSecTrustSettingsDomainUser, &trustSettings);\n-            if (trustSettings != NULL) {\n+            \/\/ Load user trustSettings into inputTrust\n+            if (SecTrustSettingsCopyTrustSettings(certRef, kSecTrustSettingsDomainUser, &trustSettings) == errSecSuccess && trustSettings != NULL) {\n@@ -482,1 +483,0 @@\n-                trustSettings = NULL;\n@@ -484,3 +484,3 @@\n-            \/\/ Dump everything inside admin trustSettings into inputTrust\n-            SecTrustSettingsCopyTrustSettings(certRef, kSecTrustSettingsDomainAdmin, &trustSettings);\n-            if (trustSettings != NULL) {\n+            \/\/ Load admin trustSettings into inputTrust\n+            trustSettings = NULL;\n+            if (SecTrustSettingsCopyTrustSettings(certRef, kSecTrustSettingsDomainAdmin, &trustSettings) == errSecSuccess && trustSettings != NULL) {\n@@ -496,1 +496,0 @@\n-                trustSettings = NULL;\n","filename":"src\/java.base\/macosx\/native\/libosxsecurity\/KeystoreImpl.m","additions":7,"deletions":8,"binary":false,"changes":15,"status":"modified"}]}