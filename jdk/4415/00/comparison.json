{"files":[{"patch":"@@ -43,0 +43,1 @@\n+import java.util.Optional;\n@@ -49,0 +50,1 @@\n+import static jdk.jpackage.internal.StandardBundlerParam.ABOUT_URL;\n@@ -440,0 +442,3 @@\n+        data.put(\"APPLICATION_HOMEPAGE\", Optional.ofNullable(\n+                ABOUT_URL.fetchFrom(params)).map(value -> \"Homepage: \" + value).orElse(\n+                \"\"));\n","filename":"src\/jdk.jpackage\/linux\/classes\/jdk\/jpackage\/internal\/LinuxDebBundler.java","additions":5,"deletions":0,"binary":false,"changes":5,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2012, 2020, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2012, 2021, Oracle and\/or its affiliates. All rights reserved.\n@@ -36,0 +36,1 @@\n+import java.util.Optional;\n@@ -47,0 +48,1 @@\n+import static jdk.jpackage.internal.StandardBundlerParam.ABOUT_URL;\n@@ -190,0 +192,3 @@\n+        data.put(\"APPLICATION_URL\", Optional.ofNullable(ABOUT_URL.fetchFrom(\n+                params)).orElse(\"\"));\n+\n","filename":"src\/jdk.jpackage\/linux\/classes\/jdk\/jpackage\/internal\/LinuxRpmBundler.java","additions":6,"deletions":1,"binary":false,"changes":7,"status":"modified"},{"patch":"@@ -11,0 +11,1 @@\n+APPLICATION_HOMEPAGE\n","filename":"src\/jdk.jpackage\/linux\/classes\/jdk\/jpackage\/internal\/resources\/template.control","additions":1,"deletions":0,"binary":false,"changes":1,"status":"modified"},{"patch":"@@ -8,0 +8,4 @@\n+%if \"xAPPLICATION_URL\" != \"x\"\n+URL: APPLICATION_URL\n+%endif\n+\n","filename":"src\/jdk.jpackage\/linux\/classes\/jdk\/jpackage\/internal\/resources\/template.spec","additions":4,"deletions":0,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -0,0 +1,99 @@\n+\/*\n+ * Copyright (c) 2021, Oracle and\/or its affiliates. All rights reserved.\n+ * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+ *\n+ * This code is free software; you can redistribute it and\/or modify it\n+ * under the terms of the GNU General Public License version 2 only, as\n+ * published by the Free Software Foundation.\n+ *\n+ * This code is distributed in the hope that it will be useful, but WITHOUT\n+ * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+ * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+ * version 2 for more details (a copy is included in the LICENSE file that\n+ * accompanied this code).\n+ *\n+ * You should have received a copy of the GNU General Public License version\n+ * 2 along with this work; if not, write to the Free Software Foundation,\n+ * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n+ *\n+ * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n+ * or visit www.oracle.com if you need additional information or have any\n+ * questions.\n+ *\/\n+\n+import jdk.jpackage.test.Annotations.Test;\n+import jdk.jpackage.test.Functional.ThrowingConsumer;\n+import jdk.jpackage.test.JPackageCommand;\n+import jdk.jpackage.test.PackageTest;\n+import jdk.jpackage.test.PackageType;\n+\n+\n+\/**\n+ * Test --about-url parameter in Linux installers. Output of the test should be\n+ * appabouturltest_1.0-1_amd64.deb or appabouturltest-1.0-1.amd64.rpm package\n+ * bundle. The output package should provide the same functionality as the\n+ * default package.\n+ *\n+ * deb:\n+ * Homepage property of the package should be set to http:\/\/foo.com value.\n+ *\n+ * rpm:\n+ * URL property of the package should be set to http:\/\/foo.com value.\n+ *\/\n+\n+\/*\n+ * @test\n+ * @summary jpackage with --about-url\n+ * @library ..\/helpers\n+ * @key jpackagePlatformPackage\n+ * @build jdk.jpackage.test.*\n+ * @build AppAboutUrlTest\n+ * @requires (os.family == \"linux\")\n+ * @requires (jpackage.test.SQETest == null)\n+ * @modules jdk.jpackage\/jdk.jpackage.internal\n+ * @run main\/othervm\/timeout=360 -Xmx512m jdk.jpackage.test.Main\n+ *  --jpt-run=AppAboutUrlTest\n+ *\/\n+\n+\/*\n+ * @test\n+ * @summary jpackage with --about-url\n+ * @library ..\/helpers\n+ * @key jpackagePlatformPackage\n+ * @build jdk.jpackage.test.*\n+ * @build AppAboutUrlTest\n+ * @requires (os.family == \"linux\")\n+ * @requires (jpackage.test.SQETest != null)\n+ * @modules jdk.jpackage\/jdk.jpackage.internal\n+ * @run main\/othervm\/timeout=360 -Xmx512m jdk.jpackage.test.Main\n+ *  --jpt-run=AppAboutUrlTest.test\n+ *\/\n+public class AppAboutUrlTest {\n+\n+    @Test\n+    public static void test() {\n+        final String ABOUT_URL = \"http:\/\/foo.com\";\n+\n+        runTest(cmd -> {\n+            cmd.addArguments(\"--about-url\", ABOUT_URL);\n+        }, ABOUT_URL, ABOUT_URL);\n+    }\n+\n+    @Test\n+    public static void testDefaults() {\n+        runTest(JPackageCommand::setFakeRuntime, \"\", \"(none)\");\n+    }\n+\n+    private static void runTest(ThrowingConsumer<JPackageCommand> initializer,\n+            String expectedDebHomepage, String expectedRpmUrl) {\n+        new PackageTest()\n+                .forTypes(PackageType.LINUX)\n+                .configureHelloApp()\n+                .addInitializer(initializer)\n+                .forTypes(PackageType.LINUX_DEB)\n+                .addBundlePropertyVerifier(\"Homepage\", expectedDebHomepage)\n+                .forTypes(PackageType.LINUX_RPM)\n+                .addBundlePropertyVerifier(\"URL\", expectedRpmUrl)\n+                .run();\n+    }\n+}\n","filename":"test\/jdk\/tools\/jpackage\/linux\/AppAboutUrlTest.java","additions":99,"deletions":0,"binary":false,"changes":99,"status":"added"}]}