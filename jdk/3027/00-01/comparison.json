{"files":[{"patch":"@@ -48,12 +48,1 @@\n-\n-        if (SATestUtils.needsPrivileges()) {\n-            \/\/ This tests has issues if you try adding privileges on OSX. The debugd process cannot\n-            \/\/ be killed if you do this (because it is a root process and the test is not), so the destroy()\n-            \/\/ call fails to do anything, and then waitFor() will time out. If you try to manually kill it with\n-            \/\/ a \"sudo kill\" command, that seems to work, but then leaves the LingeredApp it was\n-            \/\/ attached to in a stuck state for some unknown reason, causing the stopApp() call\n-            \/\/ to timeout. For that reason we don't run this test when privileges are needed. Note\n-            \/\/ it does appear to run fine as root, so we still allow it to run on OSX when privileges\n-            \/\/ are not required.\n-            throw new SkippedException(\"Cannot run this test on OSX if adding privileges is required.\");\n-        }\n+        SATestUtils.validateSADebugDPrivileges();\n","filename":"test\/hotspot\/jtreg\/serviceability\/sa\/sadebugd\/ClhsdbAttachToDebugServer.java","additions":1,"deletions":12,"binary":false,"changes":13,"status":"modified"},{"patch":"@@ -36,1 +36,1 @@\n- * @requires os.family != \"windows\"\n+ * @requires (os.family != \"windows\") & (os.family != \"mac\")\n@@ -45,12 +45,1 @@\n-\n-        if (SATestUtils.needsPrivileges()) {\n-            \/\/ This tests has issues if you try adding privileges on OSX. The debugd process cannot\n-            \/\/ be killed if you do this (because it is a root process and the test is not), so the destroy()\n-            \/\/ call fails to do anything, and then waitFor() will time out. If you try to manually kill it with\n-            \/\/ a \"sudo kill\" command, that seems to work, but then leaves the LingeredApp it was\n-            \/\/ attached to in a stuck state for some unknown reason, causing the stopApp() call\n-            \/\/ to timeout. For that reason we don't run this test when privileges are needed. Note\n-            \/\/ it does appear to run fine as root, so we still allow it to run on OSX when privileges\n-            \/\/ are not required.\n-            throw new SkippedException(\"Cannot run this test on OSX if adding privileges is required.\");\n-        }\n+        SATestUtils.validateSADebugDPrivileges();\n@@ -79,1 +68,1 @@\n-            out.shouldMatch(\"^0x[0-9a-f]+.+jvm\\\\.(dll|dylib|so)$\"); \/\/ Find libjvm from output\n+            out.shouldMatch(\"^0x[0-9a-f]+.+libjvm\\\\.so$\"); \/\/ Find libjvm from output\n","filename":"test\/hotspot\/jtreg\/serviceability\/sa\/sadebugd\/PmapOnDebugdTest.java","additions":3,"deletions":14,"binary":false,"changes":17,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2016, 2020, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2016, 2021, Oracle and\/or its affiliates. All rights reserved.\n@@ -59,12 +59,1 @@\n-\n-        if (SATestUtils.needsPrivileges()) {\n-            \/\/ This tests has issues if you try adding privileges on OSX. The debugd process cannot\n-            \/\/ be killed if you do this (because it is a root process and the test is not), so the destroy()\n-            \/\/ call fails to do anything, and then waitFor() will time out. If you try to manually kill it with\n-            \/\/ a \"sudo kill\" command, that seems to work, but then leaves the LingeredApp it was\n-            \/\/ attached to in a stuck state for some unknown reason, causing the stopApp() call\n-            \/\/ to timeout. For that reason we don't run this test when privileges are needed. Note\n-            \/\/ it does appear to run fine as root, so we still allow it to run on OSX when privileges\n-            \/\/ are not required.\n-            throw new SkippedException(\"Cannot run this test on OSX if adding privileges is required.\");\n-        }\n+        SATestUtils.validateSADebugDPrivileges();\n","filename":"test\/hotspot\/jtreg\/serviceability\/sa\/sadebugd\/SADebugDTest.java","additions":2,"deletions":13,"binary":false,"changes":15,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2019, 2020, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2019, 2021, Oracle and\/or its affiliates. All rights reserved.\n@@ -210,0 +210,16 @@\n+\n+    \/**\n+     * This tests has issues if you try adding privileges on OSX. The debugd process cannot\n+     * be killed if you do this (because it is a root process and the test is not), so the destroy()\n+     * call fails to do anything, and then waitFor() will time out. If you try to manually kill it with\n+     * a \"sudo kill\" command, that seems to work, but then leaves the LingeredApp it was\n+     * attached to in a stuck state for some unknown reason, causing the stopApp() call\n+     * to timeout. For that reason we don't run this test when privileges are needed. Note\n+     * it does appear to run fine as root, so we still allow it to run on OSX when privileges\n+     * are not required.\n+     *\/\n+    public static void validateSADebugDPrivileges() {\n+        if (needsPrivileges()) {\n+            throw new SkippedException(\"Cannot run this test on OSX if adding privileges is required.\");\n+        }\n+    }\n","filename":"test\/lib\/jdk\/test\/lib\/SA\/SATestUtils.java","additions":17,"deletions":1,"binary":false,"changes":18,"status":"modified"}]}