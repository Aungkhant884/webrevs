{"files":[{"patch":"@@ -155,0 +155,1 @@\n+vmTestbase\/nsk\/jvmti\/scenarios\/jni_interception\/JI05\/ji05t001\/TestDescription.java 8219652 aix-ppc64\n","filename":"test\/hotspot\/jtreg\/ProblemList.txt","additions":1,"deletions":0,"binary":false,"changes":1,"status":"modified"},{"patch":"@@ -32,2 +32,0 @@\n-#define STACK_SIZE 1024*1024\n-\n@@ -85,4 +83,1 @@\n-  pthread_attr_t attr;\n-  pthread_attr_init(&attr);\n-  pthread_attr_setstacksize(&attr, STACK_SIZE);\n-  if ((res = pthread_create(&thread, &attr, thread_start, NULL)) != 0) {\n+  if ((res = pthread_create(&thread, NULL, thread_start, NULL)) != 0) {\n@@ -93,2 +88,0 @@\n-  pthread_attr_destroy(&attr);\n-\n","filename":"test\/hotspot\/jtreg\/runtime\/jni\/terminatedThread\/libterminatedThread.c","additions":1,"deletions":8,"binary":false,"changes":9,"status":"modified"},{"patch":"@@ -43,1 +43,0 @@\n-#define STACK_SIZE 1024*1024\n@@ -217,1 +216,1 @@\n-static void *waitingThread1(void *context) {\n+static int waitingThread(void *context) {\n@@ -231,1 +230,1 @@\n-        exit(STATUS_FAILED);\n+        return STATUS_FAILED;\n@@ -242,1 +241,1 @@\n-         exit(STATUS_FAILED);\n+        return STATUS_FAILED;\n@@ -247,18 +246,1 @@\n-    return 0;\n-}\n-\n-static int waitingThread(void *context) {\n-   pthread_t id;\n-   int result;\n-   pthread_attr_t attr;\n-   pthread_attr_init(&attr);\n-   pthread_attr_setstacksize(&attr, STACK_SIZE);\n-   if ((result = pthread_create(&id, &attr, waitingThread1, NULL)) != 0) {\n-      fprintf(stderr, \"Error: waitingThread failed with error code %d \\n\", result);\n-      exit(-1);\n-   }\n-   if ((result = pthread_join(id, NULL)) != 0) {\n-      fprintf(stderr, \"Failed to join thread %d \\n\", result);\n-      exit(-1);\n-   }\n-   return 0;\n+    return exitCode;\n@@ -340,29 +322,0 @@\n-static void *run(void *unused){\n-    JNIEnv *nextEnv = NULL;\n-    int res = vm->AttachCurrentThread((void **) &nextEnv, (void *) 0);\n-    if (res != 0) {\n-       printf(\"(%s,%d): TEST FAILURE: waitingThread: AttachCurrentThread() returns: %d\\n\",\n-             __FILE__, __LINE__, res);\n-       exit(STATUS_FAILED);\n-    }\n-    return 0;\n-}\n-\n-static int attachCurrentThread(){\n-   pthread_t id;\n-   int result;\n-   pthread_attr_t attr;\n-   pthread_attr_init(&attr);\n-   pthread_attr_setstacksize(&attr, STACK_SIZE);\n-   if ((result = pthread_create(&id, &attr, run, NULL)) != 0) {\n-      fprintf(stderr, \"Error: pthread_create failed with error code %d \\n\", result);\n-      exit(-1);\n-   }\n-   pthread_attr_destroy(&attr);\n-   if ((result = pthread_join(id, NULL)) != 0) {\n-      fprintf(stderr, \"Failed to join thread %d \\n\", result);\n-      exit(-1);\n-   }\n-   return 0;\n-}\n-\n@@ -416,1 +369,6 @@\n-        attachCurrentThread();\n+        res = vm->AttachCurrentThread((void **) &nextEnv, (void *) 0);\n+        if (res != 0) {\n+            printf(\"(%s,%d): TEST FAILURE: waitingThread: AttachCurrentThread() returns: %d\\n\",\n+                __FILE__, __LINE__, res);\n+            return STATUS_FAILED;\n+        }\n","filename":"test\/hotspot\/jtreg\/vmTestbase\/nsk\/jvmti\/SetJNIFunctionTable\/setjniftab001\/setjniftab001.cpp","additions":10,"deletions":52,"binary":false,"changes":62,"status":"modified"},{"patch":"@@ -44,1 +44,1 @@\n-#define STACK_SIZE 1024*1024\n+\n@@ -251,0 +251,1 @@\n+\n@@ -252,1 +253,1 @@\n-static void  *agentA_1(void *context) {\n+static int agentA(void *context) {\n@@ -314,1 +315,1 @@\n-    return 0;\n+    return exitCode;\n@@ -316,19 +317,2 @@\n-static int agentA(void *context){\n-    size_t adjusted_stack_size = 1024*1024;\n-    pthread_t id;\n-    int result;\n-    pthread_attr_t attr;\n-    pthread_attr_init(&attr);\n-    pthread_attr_setstacksize(&attr, adjusted_stack_size);\n-    if ((result = pthread_create(&id, &attr, agentA_1, NULL)) != 0) {\n-      fprintf(stderr, \"Error: agentA thread failed with error code %d \\n\", result);\n-       exit(-1);\n-    }\n-    pthread_attr_destroy(&attr);\n-    if ((result = pthread_join(id, NULL)) != 0) {\n-       fprintf(stderr, \"Error : failed to join thread %d \\n\", result);\n-       exit(-1);\n-    }\n-    return 0;\n- }\n-static  void  *agentB_1(void *context) {\n+\n+static int agentB(void *context) {\n@@ -395,20 +379,1 @@\n-    return 0;\n-}\n-\n-static int agentB(void* unused){\n-   size_t adjusted_stack_size = 1024*1024;\n-   pthread_t id;\n-   int result;\n-   pthread_attr_t attr;\n-   pthread_attr_init(&attr);\n-   pthread_attr_setstacksize(&attr, adjusted_stack_size);\n-   if ((result = pthread_create(&id, &attr, agentB_1, NULL)) != 0) {\n-     fprintf(stderr, \"Error: agentB thread failed with error code %d \\n\", result);\n-     exit(-1);\n-   }\n-   pthread_attr_destroy(&attr);\n-   if ((result = pthread_join(id, NULL)) != 0) {\n-     fprintf(stderr, \"Error : failed to join thread %d \\n\", result);\n-     exit(-1);\n-   }\n-   return 0;\n+    return exitCode;\n@@ -416,1 +381,0 @@\n-\n","filename":"test\/hotspot\/jtreg\/vmTestbase\/nsk\/jvmti\/scenarios\/jni_interception\/JI05\/ji05t001\/ji05t001.cpp","additions":7,"deletions":43,"binary":false,"changes":50,"status":"modified"},{"patch":"@@ -39,1 +39,2 @@\n-#define PASSED 0\n+#define PASSED  0\n+#define STATUS_FAILED  2\n@@ -43,1 +44,0 @@\n-#define STACK_SIZE 1024*1024\n@@ -49,1 +49,3 @@\n-      if (res == 0) \\\n+      if (res != 0) \\\n+          NSK_COMPLAIN1(\"TEST WARNING: DetachCurrentThread() returns: %d\\n\", res); \\\n+      else \\\n@@ -51,3 +53,3 @@\n-          return 0; \\\n-      exit(-1); \\\n-  } while(0)\n+      return status; \\\n+  } while (0)\n+\n@@ -59,1 +61,0 @@\n-static int STATUS_FAILED = 2;\n@@ -190,1 +191,1 @@\n-static void *waitingThread1(void *context) {\n+static int waitingThread(void *context) {\n@@ -206,1 +207,1 @@\n-        exit(STATUS_FAILED);\n+        return STATUS_FAILED;\n@@ -227,19 +228,1 @@\n-static int waitingThread(void *unused){\n-    pthread_t id;\n-    int result;\n-    pthread_attr_t attr;\n-    pthread_attr_init(&attr);\n-    pthread_attr_setstacksize(&attr, STACK_SIZE);\n-    if ((result = pthread_create(&id, &attr, waitingThread1, NULL)) != 0) {\n-     fprintf(stderr, \"Error: waitingThread failed with error code %d \\n\", result);\n-     exit( -1);\n-   }\n-   pthread_attr_destroy(&attr);\n-   if ((result = pthread_join(id, NULL)) != 0) {\n-     fprintf(stderr, \"Failed to join thread %d \\n\", result);\n-     exit(-1);\n-   }\n-   return 0;\n-}\n-\n-static void *ownerThread1(void *context) {\n+static int ownerThread(void *context) {\n@@ -256,1 +239,1 @@\n-        exit(STATUS_FAILED);\n+        return STATUS_FAILED;\n@@ -287,20 +270,1 @@\n-static int ownerThread(void *unused){\n-    pthread_t id;\n-    int result;\n-    pthread_attr_t attr;\n-    pthread_attr_init(&attr);\n-    pthread_attr_setstacksize(&attr, STACK_SIZE);\n-    if ((result = pthread_create(&id, &attr, ownerThread1, NULL)) != 0) {\n-        fprintf(stderr, \"Error: ownerThread failed with error code %d \\n\", result);\n-        exit(-1);\n-    }\n-    pthread_attr_destroy(&attr);\n-    if ((result = pthread_join(id, NULL)) != 0){\n-        fprintf(stderr, \"Failed to join thread %d \\n\", result);\n-        exit(-1);\n-    }\n-\n-    return 0;\n-}\n-\n-static void *redirectorThread1(void *context) {\n+static int redirectorThread(void *context) {\n@@ -317,1 +281,1 @@\n-        exit(STATUS_FAILED);\n+        return STATUS_FAILED;\n@@ -328,18 +292,0 @@\n-\n-static int redirectorThread(void *context) {\n-    pthread_t id;\n-    int result;\n-    pthread_attr_t attr;\n-    pthread_attr_init(&attr);\n-    pthread_attr_setstacksize(&attr, STACK_SIZE);\n-    if ((result = pthread_create(&id, &attr, redirectorThread1, NULL)) != 0) {\n-        fprintf(stderr, \"Error: redirectorThread failed with error code %d \\n\", result);\n-        exit(-1);\n-    }\n-    pthread_attr_destroy(&attr);\n-    if ((result = pthread_join(id, NULL)) != 0){\n-        fprintf(stderr, \"Failed to join thread %d \\n\", result);\n-        exit(-1);\n-    }\n-    return 0;\n-}\n","filename":"test\/hotspot\/jtreg\/vmTestbase\/nsk\/jvmti\/scenarios\/jni_interception\/JI06\/ji06t001\/ji06t001.cpp","additions":14,"deletions":68,"binary":false,"changes":82,"status":"modified"},{"patch":"@@ -131,1 +131,5 @@\n-    int result = pthread_create(&(thread->id),NULL,procedure,thread);\n+    pthread_attr_t attr;\n+    pthread_attr_init(&attr);\n+    size_t stack_size = 0x100000;\n+    pthread_attr_setstacksize(&attr, stack_size);\n+    int result = pthread_create(&(thread->id),&attr,procedure,thread);\n","filename":"test\/hotspot\/jtreg\/vmTestbase\/nsk\/share\/native\/native_thread.cpp","additions":5,"deletions":1,"binary":false,"changes":6,"status":"modified"}]}