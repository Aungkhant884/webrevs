{"files":[{"patch":"@@ -1248,1 +1248,1 @@\n-                        privateKey.getAlgorithm(), KeyUtil.getKeySize(privateKey)));\n+                        KeyUtil.fullDisplayAlgName(privateKey), KeyUtil.getKeySize(privateKey)));\n@@ -1278,1 +1278,1 @@\n-                        weakPublicKey.getAlgorithm(), KeyUtil.getKeySize(weakPublicKey)));\n+                        KeyUtil.fullDisplayAlgName(weakPublicKey), KeyUtil.getKeySize(weakPublicKey)));\n@@ -1472,1 +1472,6 @@\n-            return String.format(rb.getString(\"key.bit.weak\"), kLen);\n+            if (key instanceof ECKey) {\n+                return String.format(rb.getString(\"key.bit.eccurve.weak\"), kLen,\n+                        KeyUtil.fullDisplayAlgName(key));\n+            } else {\n+                return String.format(rb.getString(\"key.bit.weak\"), kLen);\n+            }\n@@ -1540,1 +1545,6 @@\n-            return String.format(rb.getString(\"key.bit.weak\"), kLen);\n+            if (key instanceof ECKey) {\n+                return String.format(rb.getString(\"key.bit.eccurve.weak\"), kLen,\n+                        KeyUtil.fullDisplayAlgName(key));\n+            } else {\n+                return String.format(rb.getString(\"key.bit.weak\"), kLen);\n+            }\n","filename":"src\/jdk.jartool\/share\/classes\/sun\/security\/tools\/jarsigner\/Main.java","additions":14,"deletions":4,"binary":false,"changes":18,"status":"modified"},{"patch":"@@ -184,0 +184,1 @@\n+        {\"key.bit.eccurve.weak\", \"%1$d-bit %2$s key (weak)\"},\n","filename":"src\/jdk.jartool\/share\/classes\/sun\/security\/tools\/jarsigner\/Resources.java","additions":1,"deletions":0,"binary":false,"changes":1,"status":"modified"},{"patch":"@@ -27,2 +27,2 @@\n- * @summary jarsigner should display the disabled named curve to better explain why\n- *          an EC key is disabled.\n+ * @summary jarsigner should display the named curve to better explain why\n+ *          an EC key is disabled or will be disabled.\n@@ -52,3 +52,2 @@\n-                \"jdk.disabled.namedCurves=secp256r1\\n\" +\n-                \"jdk.jar.disabledAlgorithms=include jdk.disabled.namedCurves\\n\" +\n-                \"jdk.certpath.disabledAlgorithms=include jdk.disabled.namedCurves\\n\");\n+                \"jdk.jar.disabledAlgorithms=secp256r1\\n\" +\n+                \"jdk.certpath.disabledAlgorithms=secp256r1\\n\");\n@@ -75,0 +74,25 @@\n+\n+        Files.deleteIfExists(Paths.get(JAVA_SECURITY_FILE));\n+        Files.writeString(Files.createFile(Paths.get(JAVA_SECURITY_FILE)),\n+                \"jdk.security.legacyAlgorithms=secp256r1\\n\");\n+\n+        SecurityTools.jarsigner(\"-keystore ks -storepass changeit \" +\n+                \"-signedjar signeda.jar -verbose \" +\n+                \"-J-Djava.security.properties=\" +\n+                JAVA_SECURITY_FILE +\n+                \" a.jar ca\")\n+                .shouldContain(\">>> Signer\")\n+                .shouldContain(\"Signature algorithm: SHA256withECDSA, 256-bit EC (secp256r1) key (weak)\")\n+                .shouldContain(\"Warning:\")\n+                .shouldContain(\"The EC (secp256r1) signing key has a keysize of 256 which is considered a security risk. This key size will be disabled in a future update\")\n+                .shouldHaveExitValue(0);\n+\n+        SecurityTools.jarsigner(\"-verify signeda.jar \" +\n+                \"-J-Djava.security.properties=\" +\n+                JAVA_SECURITY_FILE +\n+                \" -keystore ks -storepass changeit -verbose -debug\")\n+                .shouldContain(\"- Signed by\")\n+                .shouldContain(\"Signature algorithm: SHA256withECDSA, 256-bit EC (secp256r1) key (weak)\")\n+                .shouldContain(\"jar verified\")\n+                .shouldContain(\"The EC (secp256r1) signing key has a keysize of 256 which is considered a security risk. This key size will be disabled in a future update\")\n+                .shouldHaveExitValue(0);\n","filename":"test\/jdk\/sun\/security\/tools\/jarsigner\/DisableCurveTest.java","additions":29,"deletions":5,"binary":false,"changes":34,"status":"modified"}]}