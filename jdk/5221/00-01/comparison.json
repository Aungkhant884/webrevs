{"files":[{"patch":"@@ -96,3 +96,0 @@\n-        mdName = \"SHA-1\";\n-        mgfSpec = MGF1ParameterSpec.SHA1;\n-        p = new byte[0];\n@@ -104,0 +101,2 @@\n+        } else {\n+            mdName = \"SHA-1\";\n@@ -113,17 +112,9 @@\n-            String mgfDigestName = params.getName();\n-            if (mgfDigestName.equals(\"SHA-1\")) {\n-                mgfSpec = MGF1ParameterSpec.SHA1;\n-            } else if (mgfDigestName.equals(\"SHA-224\")) {\n-                mgfSpec = MGF1ParameterSpec.SHA224;\n-            } else if (mgfDigestName.equals(\"SHA-256\")) {\n-                mgfSpec = MGF1ParameterSpec.SHA256;\n-            } else if (mgfDigestName.equals(\"SHA-384\")) {\n-                mgfSpec = MGF1ParameterSpec.SHA384;\n-            } else if (mgfDigestName.equals(\"SHA-512\")) {\n-                mgfSpec = MGF1ParameterSpec.SHA512;\n-            } else if (mgfDigestName.equals(\"SHA-512\/224\")) {\n-                mgfSpec = MGF1ParameterSpec.SHA512_224;\n-            } else if (mgfDigestName.equals(\"SHA-512\/256\")) {\n-                mgfSpec = MGF1ParameterSpec.SHA512_256;\n-            } else {\n-                throw new IOException(\n+            mgfSpec = switch (params.getName()) {\n+                case \"SHA-1\" -> MGF1ParameterSpec.SHA1;\n+                case \"SHA-224\" -> MGF1ParameterSpec.SHA224;\n+                case \"SHA-256\" -> MGF1ParameterSpec.SHA256;\n+                case \"SHA-384\" -> MGF1ParameterSpec.SHA384;\n+                case \"SHA-512\" -> MGF1ParameterSpec.SHA512;\n+                case \"SHA-512\/224\" -> MGF1ParameterSpec.SHA512_224;\n+                case \"SHA-512\/256\" -> MGF1ParameterSpec.SHA512_256;\n+                default -> throw new IOException(\n@@ -131,1 +122,3 @@\n-            }\n+            };\n+        } else {\n+            mgfSpec = MGF1ParameterSpec.SHA1;\n@@ -139,5 +132,3 @@\n-            DerInputStream dis = new DerInputStream(val.getEncodedParams());\n-            p = dis.getOctetString();\n-            if (dis.available() != 0) {\n-                throw new IOException(\"Extra data for pSpecified\");\n-            }\n+            p = DerValue.wrap(val.getEncodedParams()).getOctetString();\n+        } else {\n+            p = new byte[0];\n","filename":"src\/java.base\/share\/classes\/com\/sun\/crypto\/provider\/OAEPParameters.java","additions":17,"deletions":26,"binary":false,"changes":43,"status":"modified"}]}