{"files":[{"patch":"@@ -3937,5 +3937,6 @@\n-            \/\/ (boolean, byte, char & short) should be promoted to int first. As\n-            \/\/ vector elements of small types don't have upper bits of int, for\n-            \/\/ RShiftI or AbsI operations, the compiler has to know the precise\n-            \/\/ signedness info of the 1st operand. These operations shouldn't be\n-            \/\/ vectorized if the signedness info is imprecise.\n+            \/\/ (boolean, byte, char & short) should be promoted to int first.\n+            \/\/ During narrowed integer type backward propagation, for some operations\n+            \/\/ like RShiftI, Abs, and ReverseBytesI,\n+            \/\/ the compiler has to know the higher order bits of the 1st operand,\n+            \/\/ which will be lost in the narrowed type. These operations shouldn't\n+            \/\/ be vectorized if the higher order bits info is imprecise.\n@@ -3944,1 +3945,1 @@\n-            if (VectorNode::is_shift_opcode(op) || op == Op_AbsI || op == Op_ReverseBytesI) {\n+            if (VectorNode::requires_higher_order_bits_of_integer(op)) {\n@@ -3950,1 +3951,1 @@\n-              } else if (op != Op_LShiftI) {\n+              } else {\n","filename":"src\/hotspot\/share\/opto\/superword.cpp","additions":8,"deletions":7,"binary":false,"changes":15,"status":"modified"},{"patch":"@@ -437,0 +437,15 @@\n+\/\/ Decide if an operation on integer requires information\n+\/\/ of its higher order bits\/bytes\n+bool VectorNode::requires_higher_order_bits_of_integer(int opc) {\n+  if (is_shift_opcode(opc) && opc != Op_LShiftI) {\n+    return true;\n+  }\n+  switch (opc) {\n+    case Op_AbsI:\n+    case Op_ReverseBytesI:\n+      return true;\n+    default:\n+      return false;\n+  }\n+}\n+\n","filename":"src\/hotspot\/share\/opto\/vectornode.cpp","additions":15,"deletions":0,"binary":false,"changes":15,"status":"modified"},{"patch":"@@ -85,0 +85,1 @@\n+  static bool requires_higher_order_bits_of_integer(int opc);\n","filename":"src\/hotspot\/share\/opto\/vectornode.hpp","additions":1,"deletions":0,"binary":false,"changes":1,"status":"modified"}]}