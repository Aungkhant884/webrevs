{"files":[{"patch":"@@ -1241,1 +1241,1 @@\n-  heap->report_full();\n+  int full_count = heap->report_full();\n@@ -1243,1 +1243,1 @@\n-  if ((heap->full_count() == 1) || print) {\n+  if ((full_count == 1) || print) {\n@@ -1280,1 +1280,1 @@\n-    if (heap->full_count() == 1) {\n+    if (full_count == 1) {\n","filename":"src\/hotspot\/share\/code\/codeCache.cpp","additions":3,"deletions":3,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 1997, 2021, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 1997, 2022, Oracle and\/or its affiliates. All rights reserved.\n@@ -31,0 +31,1 @@\n+#include \"runtime\/atomic.hpp\"\n@@ -219,1 +220,1 @@\n-  void        report_full()                      {        _full_count++; }\n+  int         report_full()                      { return Atomic::add(&_full_count, 1); }\n","filename":"src\/hotspot\/share\/memory\/heap.hpp","additions":3,"deletions":2,"binary":false,"changes":5,"status":"modified"},{"patch":"@@ -58,1 +58,1 @@\n-          \"-XX:ReservedCodeCacheSize=2496k\", \"-XX:-UseCodeCacheFlushing\", \"CodeCacheFullCountTest\", \"WasteCodeCache\");\n+          \"-XX:ReservedCodeCacheSize=2496k\", \"-XX:-UseCodeCacheFlushing\", \"-XX:-MethodFlushing\", \"CodeCacheFullCountTest\", \"WasteCodeCache\");\n@@ -67,1 +67,1 @@\n-            if (fullCount != 1) {\n+            if (fullCount == 0) {\n","filename":"test\/hotspot\/jtreg\/compiler\/codecache\/CodeCacheFullCountTest.java","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"}]}