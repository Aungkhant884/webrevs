{"files":[{"patch":"@@ -34,0 +34,1 @@\n+import org.junit.jupiter.api.BeforeAll;\n@@ -40,7 +41,9 @@\n-    \/*\n-     * Ensure that mutating the arrays passed to setChoices and setLimits as well\n-     * as the arrays returned by getChoices and getLimits does not affect\n-     * the internal representation of the original ChoiceFormat.\n-     *\/\n-    @Test\n-    public void immutableChoicesAndFormatsTest() {\n+    \/\/ Represents the expected output of formatting the ChoiceFormat\n+    private static String expectedFormattedOutput;\n+    private static ChoiceFormat cFmt;\n+    private static ParsePosition status;\n+    private static String[] originalSetterArray;\n+\n+    \/\/ Build the original ChoiceFormat to test if it can be mutated\n+    @BeforeAll\n+    static void setUpChoiceFormatAndOutput() {\n@@ -48,3 +51,4 @@\n-        String[] dayOfWeekNames = {\"Sun\", \"Mon\", \"Tue\", \"Wed\", \"Thu\", \"Fri\", \"Sat\"};\n-        ChoiceFormat form = new ChoiceFormat(limits, dayOfWeekNames);\n-        ParsePosition status = new ParsePosition(0);\n+        originalSetterArray = new String[]{\"Sun\", \"Mon\", \"Tue\", \"Wed\", \"Thu\", \"Fri\", \"Sat\"};\n+        \/\/ Constructor calls setChoices\n+        cFmt = new ChoiceFormat(limits, originalSetterArray);\n+        status = new ParsePosition(0);\n@@ -56,1 +60,1 @@\n-            String s = form.format(i);\n+            String s = cFmt.format(i);\n@@ -59,1 +63,1 @@\n-            before.append(form.parse(form.format(i), status));\n+            before.append(cFmt.parse(cFmt.format(i), status));\n@@ -61,1 +65,2 @@\n-        String original = before.toString();\n+        expectedFormattedOutput = before.toString();\n+    }\n@@ -63,0 +68,6 @@\n+    \/*\n+     * Ensure that mutating he arrays returned by getChoices and getLimits does\n+     * not affect the internal representation of the ChoiceFormat.\n+     *\/\n+    @Test\n+    public void immutableArraysFromGetters() {\n@@ -64,1 +75,1 @@\n-        String[] newFormats = (String[]) form.getFormats();\n+        String[] newFormats = (String[]) cFmt.getFormats();\n@@ -69,1 +80,1 @@\n-            String s = form.format(i);\n+            String s = cFmt.format(i);\n@@ -72,1 +83,1 @@\n-            after.append(form.parse(form.format(i), status));\n+            after.append(cFmt.parse(cFmt.format(i), status));\n@@ -75,1 +86,1 @@\n-        assertEquals(after.toString(), original,\n+        assertEquals(after.toString(), expectedFormattedOutput,\n@@ -77,0 +88,1 @@\n+    }\n@@ -78,0 +90,6 @@\n+    \/*\n+     * Ensure that mutating the arrays passed to setChoices\/constructor does\n+     * not affect the internal representation of the ChoiceFormat.\n+     *\/\n+    @Test\n+    public void immutableArraysFromSetter() {\n@@ -79,2 +97,2 @@\n-        dayOfWeekNames[6] = \"Saturday\";\n-        after = new StringBuilder();\n+        originalSetterArray[6] = \"Saturday\";\n+        StringBuilder after = new StringBuilder();\n@@ -83,1 +101,1 @@\n-            String s = form.format(i);\n+            String s = cFmt.format(i);\n@@ -86,1 +104,1 @@\n-            after.append(form.parse(form.format(i), status));\n+            after.append(cFmt.parse(cFmt.format(i), status));\n@@ -89,1 +107,1 @@\n-        assertEquals(after.toString(), original,\n+        assertEquals(after.toString(), expectedFormattedOutput,\n","filename":"test\/jdk\/java\/text\/Format\/ChoiceFormat\/Bug8001209.java","additions":40,"deletions":22,"binary":false,"changes":62,"status":"modified"}]}