{"files":[{"patch":"@@ -134,0 +134,13 @@\n+\n+void ZTracer::send_thread_debug(const char* name, const Ticks& start, const Ticks& end) {\n+  NoSafepointVerifier nsv;\n+\n+  EventZThreadDebug e(UNTIMED);\n+  if (e.should_commit()) {\n+    e.set_gcId(GCId::current_or_undefined());\n+    e.set_name(name);\n+    e.set_starttime(start);\n+    e.set_endtime(end);\n+    e.commit();\n+  }\n+}\n","filename":"src\/hotspot\/share\/gc\/z\/zTracer.cpp","additions":13,"deletions":0,"binary":false,"changes":13,"status":"modified"},{"patch":"@@ -42,0 +42,1 @@\n+  void send_thread_debug(const char* name, const Ticks& start, const Ticks& end);\n@@ -50,0 +51,1 @@\n+  void report_thread_debug(const char* name, const Ticks& start, const Ticks& end);\n@@ -52,1 +54,2 @@\n-class ZTraceThreadPhase : public StackObj {\n+\/\/ For temporary latency measurements during development and debugging\n+class ZTraceThreadDebug : public StackObj {\n@@ -58,2 +61,2 @@\n-  ZTraceThreadPhase(const char* name);\n-  ~ZTraceThreadPhase();\n+  ZTraceThreadDebug(const char* name);\n+  ~ZTraceThreadDebug();\n","filename":"src\/hotspot\/share\/gc\/z\/zTracer.hpp","additions":6,"deletions":3,"binary":false,"changes":9,"status":"modified"},{"patch":"@@ -53,1 +53,7 @@\n-inline ZTraceThreadPhase::ZTraceThreadPhase(const char* name) :\n+inline void ZTracer::report_thread_debug(const char* name, const Ticks& start, const Ticks& end) {\n+  if (EventZThreadDebug::is_enabled()) {\n+    send_thread_debug(name, start, end);\n+  }\n+}\n+\n+inline ZTraceThreadDebug::ZTraceThreadDebug(const char* name) :\n@@ -57,2 +63,2 @@\n-inline ZTraceThreadPhase::~ZTraceThreadPhase() {\n-  ZTracer::tracer()->report_thread_phase(_name, _start, Ticks::now());\n+inline ZTraceThreadDebug::~ZTraceThreadDebug() {\n+  ZTracer::tracer()->report_thread_debug(_name, _start, Ticks::now());\n","filename":"src\/hotspot\/share\/gc\/z\/zTracer.inline.hpp","additions":9,"deletions":3,"binary":false,"changes":12,"status":"modified"},{"patch":"@@ -1037,0 +1037,5 @@\n+  <Event name=\"ZThreadDebug\" category=\"Java Virtual Machine, GC, Detailed\" label=\"ZGC Thread Event\" description=\"Temporary latency measurements used during development and debugging of ZGC\" thread=\"true\" experimental=\"true\">\n+    <Field type=\"uint\" name=\"gcId\" label=\"GC Identifier\" relation=\"GcId\"\/>\n+    <Field type=\"string\" name=\"name\" label=\"Name\" \/>\n+  <\/Event>\n+\n","filename":"src\/hotspot\/share\/jfr\/metadata\/metadata.xml","additions":5,"deletions":0,"binary":false,"changes":5,"status":"modified"},{"patch":"@@ -778,0 +778,5 @@\n+    <event name=\"jdk.ZThreadDebug\">\n+      <setting name=\"enabled\">true<\/setting>\n+      <setting name=\"threshold\">0 ms<\/setting>\n+    <\/event>\n+\n","filename":"src\/jdk.jfr\/share\/conf\/jfr\/default.jfc","additions":5,"deletions":0,"binary":false,"changes":5,"status":"modified"},{"patch":"@@ -778,0 +778,5 @@\n+    <event name=\"jdk.ZThreadDebug\">\n+      <setting name=\"enabled\">true<\/setting>\n+      <setting name=\"threshold\">0 ms<\/setting>\n+    <\/event>\n+\n","filename":"src\/jdk.jfr\/share\/conf\/jfr\/profile.jfc","additions":5,"deletions":0,"binary":false,"changes":5,"status":"modified"}]}