{"files":[{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2016, 2020, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2016, 2021, Oracle and\/or its affiliates. All rights reserved.\n@@ -29,0 +29,1 @@\n+#include \"runtime\/globals_extension.hpp\"\n@@ -32,0 +33,14 @@\n+static bool check_get_mempolicy_support() {\n+  int dummy = 0;\n+  int mode = -1;\n+  \/\/ Check whether get_mempolicy is supported since most containers may disable it by default.\n+  if (ZSyscall::get_mempolicy(&mode, NULL, 0, (void*)&dummy, MPOL_F_NODE | MPOL_F_ADDR) == -1) {\n+    if (!FLAG_IS_DEFAULT(UseNUMA)) {\n+      warning(\"ZGC NUMA support is disabled since get_mempolicy is unsupported.\");\n+    }\n+    return false;\n+  }\n+\n+  return true;\n+}\n+\n@@ -33,1 +48,1 @@\n-  _enabled = UseNUMA;\n+  _enabled = UseNUMA && check_get_mempolicy_support();\n","filename":"src\/hotspot\/os\/linux\/gc\/z\/zNUMA_linux.cpp","additions":17,"deletions":2,"binary":false,"changes":19,"status":"modified"}]}