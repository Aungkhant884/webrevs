{"files":[{"patch":"@@ -2994,0 +2994,16 @@\n+  \/\/ Protection key features.\n+  if (_cpuid_info.sef_cpuid7_ecx.bits.pku != 0) {\n+    result |= CPU_PKU;\n+  }\n+  if (_cpuid_info.sef_cpuid7_ecx.bits.ospke != 0) {\n+    result |= CPU_OSPKE;\n+  }\n+\n+  \/\/ Control flow enforcement (CET) features.\n+  if (_cpuid_info.sef_cpuid7_ecx.bits.cet_ss != 0) {\n+    result |= CPU_CET_SS;\n+  }\n+  if (_cpuid_info.sef_cpuid7_edx.bits.cet_ibt != 0) {\n+    result |= CPU_CET_IBT;\n+  }\n+\n","filename":"src\/hotspot\/cpu\/x86\/vm_version_x86.cpp","additions":16,"deletions":0,"binary":false,"changes":16,"status":"modified"},{"patch":"@@ -249,1 +249,1 @@\n-                           : 1,\n+                    cet_ss : 1,\n@@ -274,1 +274,3 @@\n-                           : 17;\n+                           : 5,\n+                   cet_ibt : 1,\n+                           : 11;\n@@ -379,1 +381,5 @@\n-    decl(F16C,              \"f16c\",              53) \/* Half-precision and single precision FP conversion instructions*\/\n+    decl(F16C,              \"f16c\",              53) \/* Half-precision and single precision FP conversion instructions*\/ \\\n+    decl(PKU,               \"pku\",               54) \/* Protection keys for user-mode pages *\/ \\\n+    decl(OSPKE,             \"ospke\",             55) \/* OS enables protection keys *\/ \\\n+    decl(CET_IBT,           \"cet_ibt\",           56) \/* Control Flow Enforcement - Indirect Branch Tracking *\/ \\\n+    decl(CET_SS,            \"cet_ss\",            57) \/* Control Flow Enforcement - Shadow Stack *\/\n@@ -687,0 +693,4 @@\n+  static bool supports_pku()          { return (_features & CPU_PKU) != 0; }\n+  static bool supports_ospke()        { return (_features & CPU_OSPKE) != 0; }\n+  static bool supports_cet_ss()       { return (_features & CPU_CET_SS) != 0; }\n+  static bool supports_cet_ibt()      { return (_features & CPU_CET_IBT) != 0; }\n","filename":"src\/hotspot\/cpu\/x86\/vm_version_x86.hpp","additions":13,"deletions":3,"binary":false,"changes":16,"status":"modified"},{"patch":"@@ -230,0 +230,4 @@\n+        PKU,\n+        OSPKE,\n+        CET_IBT,\n+        CET_SS,\n","filename":"src\/jdk.internal.vm.ci\/share\/classes\/jdk.vm.ci.amd64\/src\/jdk\/vm\/ci\/amd64\/AMD64.java","additions":4,"deletions":0,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -86,0 +86,4 @@\n+    final long amd64PKU = getConstant(\"VM_Version::CPU_PKU\", Long.class);\n+    final long amd64OSPKE = getConstant(\"VM_Version::CPU_OSPKE\", Long.class);\n+    final long amd64CET_IBT = getConstant(\"VM_Version::CPU_CET_IBT\", Long.class);\n+    final long amd64CET_SS = getConstant(\"VM_Version::CPU_CET_SS\", Long.class);\n","filename":"src\/jdk.internal.vm.ci\/share\/classes\/jdk.vm.ci.hotspot.amd64\/src\/jdk\/vm\/ci\/hotspot\/amd64\/AMD64HotSpotVMConfig.java","additions":4,"deletions":0,"binary":false,"changes":4,"status":"modified"}]}