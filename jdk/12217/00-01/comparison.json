{"files":[{"patch":"@@ -568,1 +568,2 @@\n-static bool check_info_file(const char* fpath, const char* virt) {\n+static int check_info_file(const char* fpath, const char* virt1,\n+                           const char* virt2) {\n@@ -575,1 +576,1 @@\n-    if (strcasestr(line, virt) != 0) {\n+    if (strcasestr(line, virt1) != 0) {\n@@ -577,1 +578,5 @@\n-      return true;\n+      return 1;\n+    }\n+    if (virt2 != NULL && strcasestr(line, virt2) != 0) {\n+      fclose(fp);\n+      return 2;\n@@ -581,1 +586,1 @@\n-  return false;\n+  return 0;\n@@ -589,2 +594,4 @@\n-  if (check_info_file(pname_file, \"KVM\")) {\n-    Abstract_VM_Version::_detected_virtualization = KVM; return;\n+  int resp = check_info_file(pname_file, \"KVM\", \"VMWare\");\n+  if (resp == 1) {\n+    Abstract_VM_Version::_detected_virtualization = KVM;\n+    return;\n@@ -592,2 +599,3 @@\n-  if (check_info_file(pname_file, \"VMWare\")) {\n-    Abstract_VM_Version::_detected_virtualization = VMWare; return;\n+  if (resp == 2) {\n+    Abstract_VM_Version::_detected_virtualization = VMWare;\n+    return;\n@@ -595,1 +603,1 @@\n-  if (check_info_file(tname_file, \"Xen\")) {\n+  if (check_info_file(tname_file, \"Xen\", NULL) == 1) {\n","filename":"src\/hotspot\/cpu\/aarch64\/vm_version_aarch64.cpp","additions":17,"deletions":9,"binary":false,"changes":26,"status":"modified"}]}