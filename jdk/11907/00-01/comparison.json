{"files":[{"patch":"@@ -304,1 +304,0 @@\n-\n@@ -308,4 +307,9 @@\n-  bool does_overflow(const NativeType a, const NativeType b) const {\n-    NativeType x = java_multiply(a, b);\n-    return (a == -1 && b == _min_value) || \/\/ Special case 'MIN_VALUE * -1 = MIN_VALUE'.\n-           (a != 0 && x \/ a != b);\n+  bool does_overflow(const NativeType product_a_b, const NativeType a, const NativeType b) const {\n+    if (a == 0 || b == 0) {\n+      \/\/ Trivially no overflow.\n+      return false;\n+    } else if (a == -1 && b == _min_value) {\n+      \/\/ Special case 'MIN_VALUE * -1 = MIN_VALUE' does overflow.\n+      return true;\n+    }\n+    return product_a_b \/ a != b;\n@@ -325,5 +329,9 @@\n-\n-    if (does_overflow(lo_left, lo_right) ||\n-        does_overflow(lo_left, hi_right) ||\n-        does_overflow(hi_left, lo_right) ||\n-        does_overflow(hi_left, hi_right)) {\n+    const NativeType lo_lo_product = java_multiply(lo_left, lo_right);\n+    const NativeType lo_hi_product = java_multiply(lo_left, hi_right);\n+    const NativeType hi_lo_product = java_multiply(hi_left, lo_right);\n+    const NativeType hi_hi_product = java_multiply(hi_left, hi_right);\n+\n+    if (does_overflow(lo_lo_product, lo_left, lo_right) ||\n+        does_overflow(lo_hi_product, lo_left, hi_right) ||\n+        does_overflow(hi_lo_product, hi_left, lo_right) ||\n+        does_overflow(hi_hi_product, hi_left, hi_right)) {\n@@ -333,6 +341,2 @@\n-    NativeType lo_lo_product = java_multiply(lo_left, lo_right);\n-    NativeType lo_hi_product = java_multiply(lo_left, hi_right);\n-    NativeType hi_lo_product = java_multiply(hi_left, lo_right);\n-    NativeType hi_hi_product = java_multiply(hi_left, hi_right);\n-    NativeType min = MIN4(lo_lo_product, lo_hi_product, hi_lo_product, hi_hi_product);\n-    NativeType max = MAX4(lo_lo_product, lo_hi_product, hi_lo_product, hi_hi_product);\n+    const NativeType min = MIN4(lo_lo_product, lo_hi_product, hi_lo_product, hi_hi_product);\n+    const NativeType max = MAX4(lo_lo_product, lo_hi_product, hi_lo_product, hi_hi_product);\n","filename":"src\/hotspot\/share\/opto\/mulnode.cpp","additions":20,"deletions":16,"binary":false,"changes":36,"status":"modified"}]}