{"files":[{"patch":"@@ -4276,0 +4276,6 @@\n+      }\n+\n+      assert(current->vect_type() != nullptr, \"must have vector type\");\n+      if (current->vect_type() != last_ur->vect_type()) {\n+        \/\/ Reductions do not have the same vector type (length and element type).\n+        break; \/\/ Chain traversal fails.\n","filename":"src\/hotspot\/share\/opto\/loopopts.cpp","additions":6,"deletions":0,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -25,2 +25,2 @@\n- * @test\n- * @bug 8302652\n+ * @test id=vanilla-U\n+ * @bug 8302652 8314612\n@@ -29,1 +29,25 @@\n- * @run driver compiler.loopopts.superword.TestUnorderedReduction\n+ * @run driver compiler.loopopts.superword.TestUnorderedReduction vanilla-U\n+ *\/\n+\n+\/**\n+ * @test id=vanilla-A\n+ * @bug 8302652 8314612\n+ * @summary Special test cases for PhaseIdealLoop::move_unordered_reduction_out_of_loop\n+ * @library \/test\/lib \/\n+ * @run driver compiler.loopopts.superword.TestUnorderedReduction vanilla-A\n+ *\/\n+\n+\/**\n+ * @test id=v016-U\n+ * @bug 8302652 8314612\n+ * @summary Special test cases for PhaseIdealLoop::move_unordered_reduction_out_of_loop\n+ * @library \/test\/lib \/\n+ * @run driver compiler.loopopts.superword.TestUnorderedReduction v016-U\n+ *\/\n+\n+\/**\n+ * @test id=v032-A\n+ * @bug 8302652 8314612\n+ * @summary Special test cases for PhaseIdealLoop::move_unordered_reduction_out_of_loop\n+ * @library \/test\/lib \/\n+ * @run driver compiler.loopopts.superword.TestUnorderedReduction v032-A\n@@ -41,3 +65,16 @@\n-        TestFramework.runWithFlags(\"-Xbatch\",\n-                                   \"-XX:CompileCommand=compileonly,compiler.loopopts.superword.TestUnorderedReduction::test*\",\n-                                   \"-XX:MaxVectorSize=16\");\n+        TestFramework framework = new TestFramework(TestUnorderedReduction.class);\n+        framework.addFlags(\"-Xbatch\",\n+                           \"-XX:CompileCommand=compileonly,compiler.loopopts.superword.TestUnorderedReduction::test*\");\n+\n+        if (args.length != 1) {\n+            throw new RuntimeException(\"Test requires exactly one argument!\");\n+        }\n+\n+        switch (args[0]) {\n+            case \"vanilla-U\" -> { framework.addFlags(\"-XX:-AlignVector\"); }\n+            case \"vanilla-A\" -> { framework.addFlags(\"-XX:+AlignVector\"); }\n+            case \"v016-U\"    -> { framework.addFlags(\"-XX:MaxVectorSize=16\"); }\n+            case \"v032-A\"    -> { framework.addFlags(\"-XX:MaxVectorSize=32\", \"-XX:+AlignVector\"); }\n+            default -> { throw new RuntimeException(\"Test argument not recognized: \" + args[0]); }\n+        }\n+        framework.start();\n@@ -81,0 +118,1 @@\n+        applyIfAnd = {\"MaxVectorSize\", \"=16\", \"AlignVector\", \"false\"},\n@@ -121,0 +159,1 @@\n+        applyIfAnd = {\"MaxVectorSize\", \"=16\", \"AlignVector\", \"false\"},\n@@ -156,0 +195,1 @@\n+        applyIfAnd = {\"MaxVectorSize\", \"=16\", \"AlignVector\", \"false\"},\n","filename":"test\/hotspot\/jtreg\/compiler\/loopopts\/superword\/TestUnorderedReduction.java","additions":46,"deletions":6,"binary":false,"changes":52,"status":"modified"}]}