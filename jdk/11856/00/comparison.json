{"files":[{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2012, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2012, 2023, Oracle and\/or its affiliates. All rights reserved.\n@@ -53,1 +53,1 @@\n-#include \"classfile\/javaClasses.hpp\"\n+#include \"classfile\/javaClasses.inline.hpp\"\n@@ -70,1 +70,0 @@\n-#include \"oops\/objArrayKlass.hpp\"\n@@ -73,0 +72,1 @@\n+#include \"oops\/verifyOopClosure.hpp\"\n@@ -1014,0 +1014,17 @@\n+class VerifyHandleOops : public OopClosure {\n+ public:\n+  virtual void do_oop(oop* p) {\n+    if (p != nullptr && *p != nullptr) {\n+      oop o = *p;\n+      if (!java_lang_Class::is_instance(o)) {\n+        guarantee(oopDesc::is_oop(o), \"Should be some oop\");\n+      }\n+      if (o->is_objArray()) {\n+        VerifyOopClosure vc;\n+        o->oop_iterate(&vc);\n+      }\n+    }\n+  }\n+  virtual void do_oop(narrowOop* o) { ShouldNotReachHere(); }\n+};\n+\n@@ -1037,0 +1054,13 @@\n+\n+  if (_deallocate_list != nullptr) {\n+    for (int i = _deallocate_list->length() - 1; i >= 0; i--) {\n+      Metadata* m = _deallocate_list->at(i);\n+      if (m->is_klass()) {\n+        ((InstanceKlass*)m)->verify();\n+      }\n+    }\n+  }\n+\n+  \/\/ Check the oops in the handles area\n+  VerifyHandleOops vho;\n+  oops_do(&vho, _claim_none, false);\n","filename":"src\/hotspot\/share\/classfile\/classLoaderData.cpp","additions":33,"deletions":3,"binary":false,"changes":36,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 1997, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 1997, 2023, Oracle and\/or its affiliates. All rights reserved.\n@@ -31,0 +31,1 @@\n+#include \"memory\/iterator.inline.hpp\"\n","filename":"src\/hotspot\/share\/oops\/oop.inline.hpp","additions":2,"deletions":1,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2015, 2019, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2015, 2023, Oracle and\/or its affiliates. All rights reserved.\n@@ -30,1 +30,1 @@\n-class VerifyOopClosure: public OopClosure {\n+class VerifyOopClosure: public BasicOopIterateClosure {\n","filename":"src\/hotspot\/share\/oops\/verifyOopClosure.hpp","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"}]}