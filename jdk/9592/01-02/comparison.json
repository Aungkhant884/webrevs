{"files":[{"patch":"@@ -600,1 +600,1 @@\n-\/\/ Maybe emit a call via a trampoline.  If the code cache is small\n+\/\/ Maybe emit a call via a trampoline. If the code cache is small\n@@ -602,1 +602,2 @@\n-address MacroAssembler::trampoline_call(Address entry, CodeBuffer* cbuf) {\n+address MacroAssembler::trampoline_call(Address entry, CodeBuffer* cbuf,\n+                                        bool check_emit_size) {\n@@ -627,4 +628,4 @@\n-    \/\/ Make sure this is a C2 compilation. C1 allocates space only for\n-    \/\/ trampoline stubs generated by Call LIR ops.\n-    if (StubRoutines::aarch64::complete() &&\n-        Thread::current()->is_Compiler_thread()) {\n+    if (check_emit_size) {\n+      assert(StubRoutines::aarch64::complete() &&\n+             Thread::current()->is_Compiler_thread() &&\n+             Compile::current()->output() != NULL, \"not in output phase of C2 compilation\");\n@@ -634,3 +635,0 @@\n-      \/\/ We need to be in the output phase when we check the size of emitted\n-      \/\/ code.\n-      PhaseOutput* phase_output = Compile::current()->output();\n@@ -638,2 +636,2 @@\n-          (task != NULL && is_c2_compile(task->comp_level()) &&\n-           phase_output != NULL && phase_output->in_scratch_emit_size());\n+        (task != NULL && is_c2_compile(task->comp_level()) &&\n+         Compile::current()->output()->in_scratch_emit_size());\n@@ -663,1 +661,0 @@\n-\n","filename":"src\/hotspot\/cpu\/aarch64\/macroAssembler_aarch64.cpp","additions":9,"deletions":12,"binary":false,"changes":21,"status":"modified"},{"patch":"@@ -1185,1 +1185,1 @@\n-  address trampoline_call(Address entry, CodeBuffer* cbuf = NULL);\n+  address trampoline_call(Address entry, CodeBuffer* cbuf = NULL, bool check_emit_size = true);\n","filename":"src\/hotspot\/cpu\/aarch64\/macroAssembler_aarch64.hpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -1056,1 +1056,1 @@\n-    __ trampoline_call(resolve);\n+    __ trampoline_call(resolve, \/*cbuf=*\/ NULL, \/*check_emit_size=*\/ false);\n@@ -1082,1 +1082,1 @@\n-  __ trampoline_call(resolve);\n+  __ trampoline_call(resolve, \/*cbuf=*\/ NULL, \/*check_emit_size=*\/ false);\n","filename":"src\/hotspot\/cpu\/aarch64\/sharedRuntime_aarch64.cpp","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"}]}