{"files":[{"patch":"@@ -4737,1 +4737,1 @@\n-                return existingPattern instanceof JCBindingPattern;\n+                return existingPattern instanceof JCBindingPattern || existingPattern instanceof JCAnyPattern;\n@@ -4755,1 +4755,4 @@\n-                } else {\n+                } else if (existingPattern instanceof JCAnyPattern) {\n+                    return true;\n+                }\n+                else {\n@@ -4758,1 +4761,7 @@\n-            } else {\n+            } else if (currentPattern instanceof JCAnyPattern) {\n+                if(existingPattern instanceof JCAnyPattern) {\n+                    return true;\n+                } else {\n+                    return existingPattern instanceof JCBindingPattern;\n+                }\n+            } {\n","filename":"src\/jdk.compiler\/share\/classes\/com\/sun\/tools\/javac\/comp\/Check.java","additions":12,"deletions":3,"binary":false,"changes":15,"status":"modified"},{"patch":"@@ -882,0 +882,1 @@\n+            checkSourceLevel(Feature.UNNAMED_VARIABLES);\n","filename":"src\/jdk.compiler\/share\/classes\/com\/sun\/tools\/javac\/parser\/JavacParser.java","additions":1,"deletions":0,"binary":false,"changes":1,"status":"modified"},{"patch":"@@ -0,0 +1,57 @@\n+\/*\n+ * @test \/nodynamiccopyright\/\n+ * @bug 8312163\n+ * @summary Crash in dominance check when compiling unnamed patterns\n+ * @enablePreview\n+ * @compile\/fail\/ref=T8312163.out -XDrawDiagnostics T8312163.java\n+ *\/\n+public class T8312163 {\n+    sealed interface A permits B {}\n+    record B() implements A {}\n+\n+    record Rec(A a, A b) {}\n+\n+    public void test(Rec r)\n+    {\n+        switch (r) {\n+            case Rec(_, _): break;\n+            case Rec(_, B()):   \/\/ dominated\n+        }\n+\n+        switch (r) {\n+            case Rec(_, B()): break;\n+            case Rec(_, _):\n+        }\n+\n+        switch (r) {\n+            case Rec(_, _): break;\n+            case Rec(_, A a):   \/\/ dominated\n+        }\n+\n+        switch (r) {\n+            case Rec(_, A a): break;\n+            case Rec(_, _): \/\/ dominated\n+        }\n+\n+        \/\/ duplicated unnamed patterns with unnamed pattern variables for reference\n+        switch (r) {\n+            case Rec(var _, var _): break;\n+            case Rec(var _, B()):   \/\/ dominated\n+        }\n+\n+        switch (r) {\n+            case Rec(var _, B()): break;\n+            case Rec(var _, var _):\n+        }\n+\n+        switch (r) {\n+            case Rec(var _, var _): break;\n+            case Rec(var _, A a):   \/\/ dominated\n+        }\n+\n+        switch (r) {\n+            case Rec(var _, A a): break;\n+            case Rec(var _, var _): \/\/ dominated\n+        }\n+    }\n+}\n","filename":"test\/langtools\/tools\/javac\/T8312163.java","additions":57,"deletions":0,"binary":false,"changes":57,"status":"added"},{"patch":"@@ -0,0 +1,9 @@\n+T8312163.java:18:18: compiler.err.pattern.dominated\n+T8312163.java:28:18: compiler.err.pattern.dominated\n+T8312163.java:33:18: compiler.err.pattern.dominated\n+T8312163.java:39:18: compiler.err.pattern.dominated\n+T8312163.java:49:18: compiler.err.pattern.dominated\n+T8312163.java:54:18: compiler.err.pattern.dominated\n+- compiler.note.preview.filename: T8312163.java, DEFAULT\n+- compiler.note.preview.recompile\n+6 errors\n\\ No newline at end of file\n","filename":"test\/langtools\/tools\/javac\/T8312163.out","additions":9,"deletions":0,"binary":false,"changes":9,"status":"added"}]}