{"files":[{"patch":"@@ -35,0 +35,1 @@\n+import java.util.Optional;\n@@ -45,1 +46,1 @@\n-        volatile ServerSocket serverSocket;\n+        final ServerSocket serverSocket;\n@@ -48,1 +49,1 @@\n-        XServer (InetAddress address, Integer port) throws IOException {\n+        XServer (InetAddress address) throws IOException {\n@@ -50,1 +51,1 @@\n-            serversocket.bind(new InetSocketAddress(address, port));\n+            serversocket.bind(new InetSocketAddress(address, 0));\n@@ -54,0 +55,4 @@\n+        public int getLocalPort() {\n+            return serverSocket.getLocalPort();\n+        }\n+\n@@ -112,1 +117,3 @@\n-            clientSocket.close();\n+            if (clientSocket != null) {\n+                clientSocket.close();\n+            }\n@@ -120,1 +127,0 @@\n-        final Integer port = 61234;\n@@ -123,1 +129,1 @@\n-        try (XServer server = new XServer(loopback,port)) {\n+        try (XServer server = new XServer(loopback)) {\n@@ -129,1 +135,1 @@\n-                .port(port)\n+                .port(server.getLocalPort())\n@@ -144,3 +150,0 @@\n-        catch (Exception e) {\n-            e.printStackTrace();\n-        }\n","filename":"test\/jdk\/sun\/net\/www\/http\/KeepAliveStream\/KeepAliveStreamCloseWithWrongContentLength.java","additions":13,"deletions":10,"binary":false,"changes":23,"status":"modified"}]}