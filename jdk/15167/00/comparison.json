{"files":[{"patch":"@@ -33,0 +33,4 @@\n+#include \"logging\/log.hpp\"\n+#include \"logging\/logLevel.hpp\"\n+#include \"logging\/logMessage.hpp\"\n+#include \"logging\/logStream.hpp\"\n@@ -49,1 +53,9 @@\n-void trace_type_profile(Compile* C, ciMethod *method, int depth, int bci, ciMethod *prof_method, ciKlass *prof_klass, int site_count, int receiver_count) {\n+void print_trace_type_profile(outputStream* out, int depth, ciKlass* prof_klass, int site_count, int receiver_count) {\n+  CompileTask::print_inline_indent(depth, out);\n+  out->print(\" \\\\-> TypeProfile (%d\/%d counts) = \", receiver_count, site_count);\n+  prof_klass->name()->print_symbol_on(out);\n+  out->cr();\n+}\n+\n+void trace_type_profile(Compile* C, ciMethod* method, int depth, int bci, ciMethod* prof_method,\n+                        ciKlass* prof_klass, int site_count, int receiver_count) {\n@@ -61,6 +73,7 @@\n-    CompileTask::print_inline_indent(depth, out);\n-    out->print(\" \\\\-> TypeProfile (%d\/%d counts) = \", receiver_count, site_count);\n-    stringStream ss;\n-    prof_klass->name()->print_symbol_on(&ss);\n-    out->print(\"%s\", ss.freeze());\n-    out->cr();\n+    print_trace_type_profile(out, depth, prof_klass, site_count, receiver_count);\n+  }\n+\n+  LogTarget(Debug, jit, inlining) lt;\n+  if (lt.is_enabled()) {\n+    LogStream ls(lt);\n+    print_trace_type_profile(&ls, depth, prof_klass, site_count, receiver_count);\n","filename":"src\/hotspot\/share\/opto\/doCall.cpp","additions":20,"deletions":7,"binary":false,"changes":27,"status":"modified"},{"patch":"@@ -0,0 +1,36 @@\n+\/*\n+ * Copyright Amazon.com Inc. or its affiliates. All Rights Reserved.\n+ * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+ *\n+ * This code is free software; you can redistribute it and\/or modify it\n+ * under the terms of the GNU General Public License version 2 only, as\n+ * published by the Free Software Foundation. Amazon designates this\n+ * particular file as subject to the \"Classpath\" exception as provided\n+ * by Oracle in the LICENSE file that accompanied this code.\n+ *\n+ * This code is distributed in the hope that it will be useful, but WITHOUT\n+ * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+ * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+ * version 2 for more details (a copy is included in the LICENSE file that\n+ * accompanied this code).\n+ *\n+ * You should have received a copy of the GNU General Public License version\n+ * 2 along with this work; if not, write to the Free Software Foundation,\n+ * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n+ *\/\n+\n+\/*\n+ * @test\n+ * @summary Test running with log:jit*=debug enabled.\n+ * @run main\/othervm -Xlog:jit*=debug compiler.arguments.TestTraceTypeProfile\n+ *\/\n+\n+package compiler.arguments;\n+\n+public class TestLogJIT {\n+\n+    static public void main(String[] args) {\n+        System.out.println(\"Passed\");\n+    }\n+}\n+\n","filename":"test\/hotspot\/jtreg\/compiler\/arguments\/TestLogJIT.java","additions":36,"deletions":0,"binary":false,"changes":36,"status":"added"},{"patch":"@@ -0,0 +1,37 @@\n+\/*\n+ * Copyright Amazon.com Inc. or its affiliates. All Rights Reserved.\n+ * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+ *\n+ * This code is free software; you can redistribute it and\/or modify it\n+ * under the terms of the GNU General Public License version 2 only, as\n+ * published by the Free Software Foundation. Amazon designates this\n+ * particular file as subject to the \"Classpath\" exception as provided\n+ * by Oracle in the LICENSE file that accompanied this code.\n+ *\n+ * This code is distributed in the hope that it will be useful, but WITHOUT\n+ * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+ * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+ * version 2 for more details (a copy is included in the LICENSE file that\n+ * accompanied this code).\n+ *\n+ * You should have received a copy of the GNU General Public License version\n+ * 2 along with this work; if not, write to the Free Software Foundation,\n+ * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n+ *\/\n+\n+\/*\n+ * @test\n+ * @summary Test running TraceTypeProfile enabled.\n+ * @run main\/othervm -XX:+IgnoreUnrecognizedVMOptions -XX:+UnlockDiagnosticVMOptions\n+ *                   -XX:+TraceTypeProfile compiler.arguments.TestTraceTypeProfile\n+ *\/\n+\n+package compiler.arguments;\n+\n+public class TestTraceTypeProfile {\n+\n+    static public void main(String[] args) {\n+        System.out.println(\"Passed\");\n+    }\n+}\n+\n","filename":"test\/hotspot\/jtreg\/compiler\/arguments\/TestTraceTypeProfile.java","additions":37,"deletions":0,"binary":false,"changes":37,"status":"added"}]}