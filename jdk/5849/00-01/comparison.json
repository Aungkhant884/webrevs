{"files":[{"patch":"@@ -27,5 +27,23 @@\n- * @summary Test if a thread R can be resumed by ThreadReference.resume() and\n- *          check if another thread T is unblocked afterwards if T is blocked by\n- *          the JDWP agent (in blockOnDebuggerSuspend()) because it called\n- *          j.l.Thread.resume() on a thread R that was suspended by the\n- *          debugger.\n+ * @summary Test the special handling in the JDWP agent of threads that call\n+ *          j.l.Thread.resume().\n+ *\n+ *          This is the sequence of actions by the debugger and the threads\n+ *          \"main\" and \"resumee\" in the target vm.\n+ *\n+ *          \"resumee\": Reaches breakpoint in methodWithBreakpoint() and is\n+ *                     suspended then.\n+ *\n+ *          \"main\": Calls j.l.Thread.resume() for \"resumee\". There is an internal\n+ *                  breakpoint in Thread.resume() so the JDWP agent receives a\n+ *                  breakpoint event. It finds that \"resumee\" is suspended because\n+ *                  of JDWP actions. The resume() call would interfere with the\n+ *                  debugger therefore \"main\" is blocked.\n+ *\n+ *          Debugger: Resumes \"resumee\" by calling ThreadReference.resume().\n+ *                    Notifies \"main\" about it.\n+ *\n+ *          \"resumee\": Continues execution.\n+ *\n+ *          \"main\": Receives the notification, finds that \"resumee\" is not\n+ *                  suspended anymore and continues execution.\n+ *\n@@ -67,2 +85,2 @@\n-        \/\/ Start Resumee thread.\n-        ResumeAfterThreadResumeCallTarg resumee = new ResumeAfterThreadResumeCallTarg(\"Resumee\");\n+        \/\/ Start \"resumee\" thread.\n+        ResumeAfterThreadResumeCallTarg resumee = new ResumeAfterThreadResumeCallTarg(\"resumee\");\n@@ -71,1 +89,1 @@\n-        \/\/ Wait for Resumee to reach the breakpoint in methodWithBreakpoint().\n+        \/\/ Wait for \"resumee\" to reach the breakpoint in methodWithBreakpoint().\n@@ -78,1 +96,1 @@\n-        \/\/ Resumee is suspended now because of the breakpoint\n+        \/\/ \"resumee\" is suspended now because of the breakpoint\n@@ -136,1 +154,1 @@\n-        log(\"Resumee has reached the breakpoint and is suspended now.\");\n+        log(\"Thread \\\"resumee\\\" has reached the breakpoint and is suspended now.\");\n@@ -145,1 +163,1 @@\n-        log(\"Sleeping 500ms shows that the main thread is blocked calling Thread.resume() on 'Resumee' Thread.\");\n+        log(\"Sleeping 500ms shows that the main thread is blocked calling Thread.resume() on \\\"resumee\\\" Thread.\");\n@@ -158,1 +176,1 @@\n-                log(\"Resuming 'Resumee' will unblock the main thread.\");\n+                log(\"Resuming \\\"resumee\\\" will unblock the main thread.\");\n","filename":"test\/jdk\/com\/sun\/jdi\/ResumeAfterThreadResumeCallTest.java","additions":30,"deletions":12,"binary":false,"changes":42,"status":"modified"}]}