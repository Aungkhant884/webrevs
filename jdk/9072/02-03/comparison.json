{"files":[{"patch":"@@ -27,2 +27,1 @@\n- * @summary Test that KeyMaterial generator works with ChaCha20-Poly1305\n- * @author Zdenek Zambersky\n+ * @summary Tests that P11TlsKeyMaterialGenerator works with ChaCha20-Poly1305\n@@ -52,0 +51,1 @@\n+        KeyGenerator kg1, kg2, kg3;\n@@ -53,3 +53,15 @@\n-            KeyGenerator.getInstance(\"ChaCha20\", provider);\n-        } catch (NoSuchAlgorithmException e) {\n-            System.out.println(\"Skipping, ChaCha20 not supported\");\n+            kg1 = KeyGenerator.getInstance(\"SunTlsRsaPremasterSecret\", provider);\n+        } catch (Exception e) {\n+            System.out.println(\"Skipping, SunTlsRsaPremasterSecret KeyGenerator not supported\");\n+            return;\n+        }\n+        try {\n+            kg2 = KeyGenerator.getInstance(\"SunTls12MasterSecret\", provider);\n+        } catch (Exception e) {\n+            System.out.println(\"Skipping, SunTls12MasterSecret KeyGenerator not supported\");\n+            return;\n+        }\n+        try {\n+            kg3 = KeyGenerator.getInstance(\"SunTls12KeyMaterial\", provider);\n+        } catch (Exception e) {\n+            System.out.println(\"Skipping, SunTls12KeyMaterial KeyGenerator not supported\");\n@@ -59,1 +71,0 @@\n-        KeyGenerator kg1 = KeyGenerator.getInstance(\"SunTlsRsaPremasterSecret\", provider);\n@@ -69,1 +80,0 @@\n-        KeyGenerator kg2 = KeyGenerator.getInstance(\"SunTls12MasterSecret\", provider);\n@@ -73,2 +83,0 @@\n-        \/\/ https:\/\/github.com\/openjdk\/jdk\/blob\/ccec5d1e8529c8211cc678d8acc8d37fe461cb51\/src\/java.base\/share\/classes\/sun\/security\/ssl\/SSLTrafficKeyDerivation.java#L270\n-        \/\/ https:\/\/github.com\/openjdk\/jdk\/blob\/ccec5d1e8529c8211cc678d8acc8d37fe461cb51\/src\/java.base\/share\/classes\/sun\/security\/ssl\/CipherSuite.java#L93\n@@ -82,1 +90,0 @@\n-        KeyGenerator kg3 = KeyGenerator.getInstance(\"SunTls12KeyMaterial\", provider);\n","filename":"test\/jdk\/sun\/security\/pkcs11\/tls\/TestKeyMaterialChaCha20.java","additions":17,"deletions":10,"binary":false,"changes":27,"status":"modified"}]}