{"files":[{"patch":"@@ -58,15 +58,2 @@\n-    private static final class CachedSecureRandomHolder {\n-        private static Provider[] cachedConfig = Security.getProviders();\n-        private static SecureRandom instance = new SecureRandom();\n-        public static SecureRandom instance(boolean checkConfig) {\n-            synchronized (CachedSecureRandomHolder.class) {\n-                if (checkConfig) {\n-                    Provider[] currConfig = Security.getProviders();\n-                    if (!Arrays.equals(cachedConfig, currConfig)) {\n-                        instance = new SecureRandom();\n-                        cachedConfig = currConfig;\n-                    }\n-                }\n-            }\n-            return instance;\n-        }\n+    private static class CachedSecureRandomHolder {\n+        public static SecureRandom instance = new SecureRandom();\n@@ -75,0 +62,2 @@\n+    private static volatile SecureRandom def = null;\n+\n@@ -82,1 +71,6 @@\n-        return CachedSecureRandomHolder.instance(false);\n+        return CachedSecureRandomHolder.instance;\n+    }\n+\n+    \/\/ called by sun.security.jca.Providers class when provider list is changed\n+    static void clearDefSecureRandom() {\n+        def = null;\n@@ -91,1 +85,9 @@\n-        return CachedSecureRandomHolder.instance(true);\n+        if (def == null) {\n+            synchronized (JCAUtil.class) {\n+                if (def == null) {\n+                    def = new SecureRandom();\n+                }\n+            }\n+        }\n+        return def;\n+\n","filename":"src\/java.base\/share\/classes\/sun\/security\/jca\/JCAUtil.java","additions":19,"deletions":17,"binary":false,"changes":36,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2003, 2020, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2003, 2021, Oracle and\/or its affiliates. All rights reserved.\n@@ -153,0 +153,1 @@\n+        JCAUtil.clearDefSecureRandom();\n","filename":"src\/java.base\/share\/classes\/sun\/security\/jca\/Providers.java","additions":2,"deletions":1,"binary":false,"changes":3,"status":"modified"}]}