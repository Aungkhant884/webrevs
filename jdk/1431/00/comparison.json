{"files":[{"patch":"@@ -97,1 +97,3 @@\n-  return Atomic::load(entries() + *cursor);\n+  \/\/ Load acquire for correctness with regards to\n+  \/\/ accesses to the contents of the forwarded object.\n+  return Atomic::load_acquire(entries() + *cursor);\n","filename":"src\/hotspot\/share\/gc\/z\/zForwarding.inline.hpp","additions":3,"deletions":1,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -61,10 +61,1 @@\n-uintptr_t ZRelocate::relocate_object_inner(ZForwarding* forwarding, uintptr_t from_addr) const {\n-  ZForwardingCursor cursor;\n-\n-  \/\/ Lookup forwarding\n-  uintptr_t to_addr = forwarding_find(forwarding, from_addr, &cursor);\n-  if (to_addr != 0) {\n-    \/\/ Already relocated\n-    return to_addr;\n-  }\n-\n+static uintptr_t relocate_object_inner(ZForwarding* forwarding, uintptr_t from_addr, ZForwardingCursor* cursor) {\n@@ -75,1 +66,1 @@\n-  to_addr = ZHeap::heap()->alloc_object_non_blocking(size);\n+  const uintptr_t to_addr = ZHeap::heap()->alloc_object_non_blocking(size);\n@@ -85,1 +76,1 @@\n-  const uintptr_t to_addr_final = forwarding_insert(forwarding, from_addr, to_addr, &cursor);\n+  const uintptr_t to_addr_final = forwarding_insert(forwarding, from_addr, to_addr, cursor);\n@@ -95,0 +86,9 @@\n+  ZForwardingCursor cursor;\n+\n+  \/\/ Lookup forwarding\n+  uintptr_t to_addr = forwarding_find(forwarding, from_addr, &cursor);\n+  if (to_addr != 0) {\n+    \/\/ Already relocated\n+    return to_addr;\n+  }\n+\n@@ -97,1 +97,1 @@\n-    const uintptr_t to_addr = relocate_object_inner(forwarding, from_addr);\n+    to_addr = relocate_object_inner(forwarding, from_addr, &cursor);\n","filename":"src\/hotspot\/share\/gc\/z\/zRelocate.cpp","additions":13,"deletions":13,"binary":false,"changes":26,"status":"modified"},{"patch":"@@ -38,1 +38,0 @@\n-  uintptr_t relocate_object_inner(ZForwarding* forwarding, uintptr_t from_addr) const;\n","filename":"src\/hotspot\/share\/gc\/z\/zRelocate.hpp","additions":0,"deletions":1,"binary":false,"changes":1,"status":"modified"}]}