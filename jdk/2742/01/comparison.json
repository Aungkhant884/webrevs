{"files":[{"patch":"@@ -37,0 +37,1 @@\n+#include \"runtime\/interfaceSupport.inline.hpp\"\n@@ -909,1 +910,1 @@\n-void GenerateOopMap::do_interpretation()\n+void GenerateOopMap::do_interpretation(Thread* thread)\n@@ -911,2 +912,0 @@\n-  \/\/ \"i\" is just for debugging, so we can detect cases where this loop is\n-  \/\/ iterated more than once.\n@@ -915,0 +914,8 @@\n+    if (i != 0 && thread->is_Java_thread()) {\n+      JavaThread* jt = thread->as_Java_thread();\n+      if (jt->thread_state() == _thread_in_vm) {\n+        \/\/ Since this JavaThread has looped at least once and is _thread_in_vm,\n+        \/\/ we honor any pending blocking request.\n+        ThreadBlockInVM tbivm(jt);\n+      }\n+    }\n@@ -2132,1 +2139,1 @@\n-    do_interpretation();\n+    do_interpretation(THREAD);\n","filename":"src\/hotspot\/share\/oops\/generateOopMap.cpp","additions":11,"deletions":4,"binary":false,"changes":15,"status":"modified"},{"patch":"@@ -377,1 +377,1 @@\n-  void  do_interpretation                   ();\n+  void  do_interpretation                   (Thread* thread);\n","filename":"src\/hotspot\/share\/oops\/generateOopMap.hpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"}]}