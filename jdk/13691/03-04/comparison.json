{"files":[{"patch":"@@ -61,2 +61,7 @@\n-        if (!(publicKey instanceof HSSPublicKey pub)) {\n-            throw new InvalidKeyException(\"Not an HSS public key: \");\n+        HSSPublicKey pub;\n+        if (publicKey instanceof HSSPublicKey p) {\n+            pub = p;\n+        } else {\n+            KeyFactoryImpl factory = new HSS.KeyFactoryImpl();\n+            Key pk = factory.engineTranslateKey(publicKey);\n+            pub = (HSSPublicKey) pk;\n@@ -88,1 +93,0 @@\n-            messageStream.reset();\n@@ -91,1 +95,0 @@\n-            messageStream.reset();\n@@ -93,0 +96,2 @@\n+        } finally {\n+            messageStream.reset();\n@@ -585,0 +590,1 @@\n+\/*\n@@ -598,1 +604,0 @@\n-\/*\n","filename":"src\/java.base\/share\/classes\/sun\/security\/provider\/HSS.java","additions":10,"deletions":5,"binary":false,"changes":15,"status":"modified"}]}