{"files":[{"patch":"@@ -126,1 +126,1 @@\n-        X500Principal[] getAuthorities() throws SSLException{\n+        X500Principal[] getAuthorities() throws IllegalArgumentException {\n@@ -129,8 +129,3 @@\n-            try {\n-                int i = 0;\n-                for (byte[] encoded : authorities) {\n-                    principals[i++] = new X500Principal(encoded);\n-                }\n-            } catch (IllegalArgumentException iae) {\n-                throw new SSLException(\"X500Principal could not be parsed \" +\n-                        \"successfully\", iae);\n+            int i = 0;\n+            for (byte[] encoded : authorities) {\n+                principals[i++] = new X500Principal(encoded);\n@@ -291,1 +286,5 @@\n-            shc.peerSupportedAuthorities = spec.getAuthorities();\n+            try {\n+                shc.peerSupportedAuthorities = spec.getAuthorities();\n+            } catch (IllegalArgumentException iae) {\n+                shc.conContext.fatal(Alert.DECODE_ERROR, \"X500Principal could not be parsed\");\n+            }\n@@ -412,1 +411,5 @@\n-            chc.peerSupportedAuthorities = spec.getAuthorities();\n+            try {\n+                chc.peerSupportedAuthorities = spec.getAuthorities();\n+            } catch (IllegalArgumentException iae) {\n+                chc.conContext.fatal(Alert.DECODE_ERROR, \"X500Principal could not be parsed\");\n+            }\n","filename":"src\/java.base\/share\/classes\/sun\/security\/ssl\/CertificateAuthoritiesExtension.java","additions":14,"deletions":11,"binary":false,"changes":25,"status":"modified"},{"patch":"@@ -202,1 +202,1 @@\n-        X500Principal[] getAuthorities() throws SSLException {\n+        X500Principal[] getAuthorities() throws IllegalArgumentException {\n@@ -206,7 +206,2 @@\n-            try {\n-                for (byte[] encoded : authorities) {\n-                    principals[i++] = new X500Principal(encoded);\n-                }\n-            } catch (IllegalArgumentException iae) {\n-                throw new SSLException(\"X500Principal could not be parsed \" +\n-                        \"successfully\", iae);\n+            for (byte[] encoded : authorities) {\n+                principals[i++] = new X500Principal(encoded);\n@@ -384,6 +379,11 @@\n-            if (chc.conContext.transport instanceof SSLSocketImpl) {\n-                clientAlias = km.chooseClientAlias(crm.getKeyTypes(),\n-                    crm.getAuthorities(), (SSLSocket)chc.conContext.transport);\n-            } else if (chc.conContext.transport instanceof SSLEngineImpl) {\n-                clientAlias = km.chooseEngineClientAlias(crm.getKeyTypes(),\n-                    crm.getAuthorities(), (SSLEngine)chc.conContext.transport);\n+\n+            try {\n+                if (chc.conContext.transport instanceof SSLSocketImpl) {\n+                    clientAlias = km.chooseClientAlias(crm.getKeyTypes(),\n+                            crm.getAuthorities(), (SSLSocket) chc.conContext.transport);\n+                } else if (chc.conContext.transport instanceof SSLEngineImpl) {\n+                    clientAlias = km.chooseEngineClientAlias(crm.getKeyTypes(),\n+                            crm.getAuthorities(), (SSLEngine) chc.conContext.transport);\n+                }\n+            } catch (IllegalArgumentException iae) {\n+                chc.conContext.fatal(Alert.DECODE_ERROR, \"X500Principal could not be parsed\");\n@@ -526,1 +526,1 @@\n-        X500Principal[] getAuthorities() throws SSLException {\n+        X500Principal[] getAuthorities() throws IllegalArgumentException {\n@@ -530,7 +530,2 @@\n-            try {\n-                for (byte[] encoded : authorities) {\n-                    principals[i++] = new X500Principal(encoded);\n-                }\n-            } catch (IllegalArgumentException iae) {\n-                throw new SSLException(\"X500Principal could not be parsed \" +\n-                        \"successfully\", iae);\n+            for (byte[] encoded : authorities) {\n+                principals[i++] = new X500Principal(encoded);\n@@ -741,2 +736,6 @@\n-            chc.peerSupportedAuthorities = crm.getAuthorities();\n-\n+            try {\n+                chc.peerSupportedAuthorities = crm.getAuthorities();\n+            }\n+            catch (IllegalArgumentException iae) {\n+                chc.conContext.fatal(Alert.DECODE_ERROR, \"X500Principal could not be parsed\");\n+            }\n","filename":"src\/java.base\/share\/classes\/sun\/security\/ssl\/CertificateRequest.java","additions":23,"deletions":24,"binary":false,"changes":47,"status":"modified"}]}