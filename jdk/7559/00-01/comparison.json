{"files":[{"patch":"@@ -565,1 +565,5 @@\n-    if (trace->env_id == NULL || JavaThread::is_thread_from_jni_environment_terminated(trace->env_id)) {\n+\n+  JavaThread* thread;\n+\n+  if (trace->env_id == NULL ||\n+      (thread = JavaThread::thread_from_jni_environment(trace->env_id))->is_exiting()) {\n","filename":"src\/hotspot\/share\/prims\/forte.cpp","additions":5,"deletions":1,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -1328,2 +1328,4 @@\n-    \/\/ We can't get here in a thread that has completed its execution and so\n-    \/\/ \"is_terminated\", but a thread is also considered terminated if the VM\n+    \/\/ We can't normally get here in a thread that has completed its\n+    \/\/ execution and so \"is_terminated\", except when the call is from\n+    \/\/ AsyncGetCallTrace, which can be triggered by a signal at any point in\n+    \/\/ a thread's lifecycle. A thread is also considered terminated if the VM\n@@ -1335,1 +1337,0 @@\n-      ShouldNotReachHere();\n","filename":"src\/hotspot\/share\/runtime\/thread.hpp","additions":4,"deletions":3,"binary":false,"changes":7,"status":"modified"}]}