{"files":[{"patch":"@@ -69,1 +69,1 @@\n-    private static final long MAX_DIRECT_TRANSFER_SIZE;\n+    private static final int MAX_DIRECT_TRANSFER_SIZE;\n@@ -492,1 +492,1 @@\n-    private long transferToDirectlyInternal(long position, long count,\n+    private long transferToDirectlyInternal(long position, int icount,\n@@ -508,1 +508,1 @@\n-                n = transferTo0(fd, position, count, targetFD);\n+                n = transferTo0(fd, position, icount, targetFD);\n@@ -529,1 +529,1 @@\n-    private long transferToDirectly(long position, long count,\n+    private long transferToDirectly(long position, int icount,\n@@ -566,1 +566,1 @@\n-                    return transferToDirectlyInternal(position, count,\n+                    return transferToDirectlyInternal(position, icount,\n@@ -573,1 +573,1 @@\n-            return transferToDirectlyInternal(position, count, target, targetFD);\n+            return transferToDirectlyInternal(position, icount, target, targetFD);\n@@ -700,1 +700,1 @@\n-        long dcount = Math.min(count, MAX_DIRECT_TRANSFER_SIZE);\n+        int icount = (int)Math.min(count, MAX_DIRECT_TRANSFER_SIZE);\n@@ -702,1 +702,1 @@\n-        if ((n = transferToDirectly(position, dcount, target)) >= 0)\n+        if ((n = transferToDirectly(position, icount, target)) >= 0)\n@@ -1388,1 +1388,1 @@\n-    private static native long maxDirectTransferSize0();\n+    private static native int maxDirectTransferSize0();\n","filename":"src\/java.base\/share\/classes\/sun\/nio\/ch\/FileChannelImpl.java","additions":9,"deletions":9,"binary":false,"changes":18,"status":"modified"},{"patch":"@@ -33,1 +33,0 @@\n-#include <dlfcn.h>\n@@ -51,1 +50,1 @@\n-#include \"java_lang_Long.h\"\n+#include \"java_lang_Integer.h\"\n@@ -54,7 +53,0 @@\n-#if defined(__linux__)\n-typedef ssize_t copy_file_range_func(int fd_in, off64_t *off_in,\n-                                     int fd_out, off64_t *off_out,\n-                                     size_t len, unsigned int flags);\n-static copy_file_range_func* my_copy_file_range_func = NULL;\n-#endif\n-\n@@ -68,3 +60,0 @@\n-#if defined(__linux__)\n-    my_copy_file_range_func = (copy_file_range_func*)dlsym(RTLD_DEFAULT, \"copy_file_range\");\n-#endif\n@@ -183,8 +172,1 @@\n-    jlong n;\n-    if (my_copy_file_range_func != NULL) {\n-        size_t len = (size_t)count;\n-        n = my_copy_file_range_func(srcFD, &offset, dstFD, NULL, len, 0);\n-        if (n >= 0)\n-            return n;\n-    }\n-    n = sendfile64(dstFD, srcFD, &offset, (size_t)count);\n+    jlong n = sendfile64(dstFD, srcFD, &offset, (size_t)count);\n@@ -248,2 +230,2 @@\n-     * return 1 when partial bytes transfered and return -1 when an error has\n-     * Occured.\n+     * return 1 when partial bytes transferred and return -1 when an error has\n+     * occurred.\n@@ -273,1 +255,1 @@\n-JNIEXPORT jlong JNICALL\n+JNIEXPORT jint JNICALL\n@@ -277,3 +259,1 @@\n-    return my_copy_file_range_func != NULL ?\n-           java_lang_Long_MAX_VALUE : \/\/ maximum value of type ssize_t\n-           0x7ffff000;                \/\/ 2,147,479,552 maximum for sendfile()\n+    return 0x7ffff000; \/\/ 2,147,479,552 maximum for sendfile()\n@@ -281,1 +261,1 @@\n-    return java_lang_Long_MAX_VALUE;\n+    return java_lang_Integer_MAX_VALUE;\n","filename":"src\/java.base\/unix\/native\/libnio\/ch\/FileChannelImpl.c","additions":7,"deletions":27,"binary":false,"changes":34,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2000, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2000, 2021, Oracle and\/or its affiliates. All rights reserved.\n@@ -196,1 +196,2 @@\n-JNIEXPORT jlong JNICALL\n+\n+JNIEXPORT jint JNICALL\n","filename":"src\/java.base\/windows\/native\/libnio\/ch\/FileChannelImpl.c","additions":3,"deletions":2,"binary":false,"changes":5,"status":"modified"},{"patch":"@@ -58,2 +58,0 @@\n-    \/\/ This should be the same values as FCOPYFILE_THRESHOLD in\n-    \/\/ the Unix version of FileChannelImpl.c.\n","filename":"test\/jdk\/java\/nio\/channels\/FileChannel\/TransferToChannel.java","additions":0,"deletions":2,"binary":false,"changes":2,"status":"modified"}]}