{"files":[{"patch":"@@ -92,1 +92,5 @@\n-                setData(bytes, format);\n+                if (DataFlavor.javaFileListFlavor.equals(flavor)) {\n+                    writeObjects(bytes);\n+                } else {\n+                    setData(bytes, format);\n+                }\n@@ -130,0 +134,1 @@\n+    private native void writeObjects(byte[] data);\n","filename":"src\/java.desktop\/macosx\/classes\/sun\/lwawt\/macosx\/CClipboard.java","additions":6,"deletions":1,"binary":false,"changes":7,"status":"modified"},{"patch":"@@ -177,0 +177,41 @@\n+\n+\/*\n+ * Class:     sun_lwawt_macosx_CClipboard\n+ * Method:    writeObjects\n+ * Signature: ([BJ)V\n+*\/\n+JNIEXPORT void JNICALL Java_sun_lwawt_macosx_CClipboard_writeObjects\n+(JNIEnv *env, jobject inObject, jbyteArray inBytes, jlong inFormat)\n+{\n+    if (inBytes == NULL) {\n+        return;\n+    }\n+\n+JNI_COCOA_ENTER(env);\n+    jint nBytes = (*env)->GetArrayLength(env, inBytes);\n+    jbyte *rawBytes = (*env)->GetPrimitiveArrayCritical(env, inBytes, NULL);\n+    CHECK_NULL(rawBytes);\n+    NSData *bytesAsData = [NSData dataWithBytes:rawBytes length:nBytes];\n+    (*env)->ReleasePrimitiveArrayCritical(env, inBytes, rawBytes, JNI_ABORT);\n+    NSString *format = formatForIndex(inFormat);\n+    NSMutableArray *formatArray = [NSMutableArray arrayWithCapacity:2];\n+    const char *bytes = [bytesAsData bytes];\n+    BOOL isStart=YES;\n+    for (int i = 0; i < [bytesAsData length]; i++) {\n+        if ((unsigned char)bytes[i] == 0) {\n+            isStart = YES;\n+        } else {\n+            if (isStart) {\n+                isStart = NO;\n+                NSString *path = [NSString stringWithUTF8String:(const char *)&bytes[i]];\n+                NSURL *fileURL = [NSURL fileURLWithPath:path relativeToURL:nil];\n+                [formatArray addObject:fileURL];\n+            }\n+        }\n+    }\n+    [ThreadUtilities performOnMainThreadWaiting:YES block:^() {\n+        [[NSPasteboard generalPasteboard] writeObjects:formatArray];\n+    }];\n+JNI_COCOA_EXIT(env);\n+}\n+\n","filename":"src\/java.desktop\/macosx\/native\/libawt_lwawt\/awt\/CClipboard.m","additions":41,"deletions":0,"binary":false,"changes":41,"status":"modified"}]}