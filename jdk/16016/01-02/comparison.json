{"files":[{"patch":"@@ -581,7 +581,7 @@\n-    if (runtime_main_module == nullptr && _archived_main_module_name != nullptr) {\n-      log_info(cds)(\"Module %s specified during dump time but not during runtime\", _archived_main_module_name);\n-      log_info(cds)(\"Disabling optimized module handling\");\n-      MetaspaceShared::disable_optimized_module_handling();\n-      MetaspaceShared::disable_full_module_graph();\n-    }\n-    if (runtime_main_module != nullptr) {\n+    bool disable = false;\n+    if (runtime_main_module == nullptr) {\n+      if (_archived_main_module_name != nullptr) {\n+        log_info(cds)(\"Module %s specified during dump time but not during runtime\", _archived_main_module_name);\n+        disable = true;\n+      }\n+    } else {\n@@ -590,2 +590,1 @@\n-        log_info(cds)(\"Disabling optimized module handling\");\n-        MetaspaceShared::disable_optimized_module_handling();\n+        disable = true;\n@@ -594,2 +593,1 @@\n-        log_info(cds)(\"Disabling optimized module handling\");\n-        MetaspaceShared::disable_optimized_module_handling();\n+        disable = true;\n@@ -598,0 +596,5 @@\n+\n+    if (disable) {\n+      log_info(cds)(\"Disabling optimized module handling\");\n+      MetaspaceShared::disable_optimized_module_handling();\n+    }\n","filename":"src\/hotspot\/share\/classfile\/modules.cpp","additions":14,"deletions":11,"binary":false,"changes":25,"status":"modified"}]}