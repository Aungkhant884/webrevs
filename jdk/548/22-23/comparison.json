{"files":[{"patch":"@@ -45,1 +45,0 @@\n-import java.util.function.Function;\n@@ -60,1 +59,1 @@\n-    public void testHandshake(Function<MemorySegment, Runnable> accessorFactory) throws InterruptedException {\n+    public void testHandshake(String testName, AccessorFactory accessorFactory) throws InterruptedException {\n@@ -63,1 +62,1 @@\n-            System.err.println(\"ITERATION \" + it);\n+            System.out.println(\"ITERATION \" + it);\n@@ -66,1 +65,1 @@\n-                accessExecutor.execute(accessorFactory.apply(segment));\n+                accessExecutor.execute(accessorFactory.make(i, segment));\n@@ -68,1 +67,3 @@\n-            Thread.sleep(ThreadLocalRandom.current().nextInt(MAX_DELAY_MILLIS));\n+            int delay = ThreadLocalRandom.current().nextInt(MAX_DELAY_MILLIS);\n+            System.out.println(\"Starting handshaker with delay set to \" + delay + \" millis\");\n+            Thread.sleep(delay);\n@@ -78,0 +79,1 @@\n+        final int id;\n@@ -79,1 +81,2 @@\n-        AbstractSegmentAccessor(MemorySegment segment) {\n+        AbstractSegmentAccessor(int id, MemorySegment segment) {\n+            this.id = id;\n@@ -85,0 +88,1 @@\n+            long prev = System.currentTimeMillis();\n@@ -93,0 +97,2 @@\n+            long delay = System.currentTimeMillis() - prev;\n+            System.out.println(\"Accessor #\" + id + \" terminated - delay (ms): \" + delay);\n@@ -109,2 +115,2 @@\n-        AbstractBufferAccessor(MemorySegment segment) {\n-            super(segment);\n+        AbstractBufferAccessor(int id, MemorySegment segment) {\n+            super(id, segment);\n@@ -117,2 +123,2 @@\n-        SegmentAccessor(MemorySegment segment) {\n-            super(segment);\n+        SegmentAccessor(int id, MemorySegment segment) {\n+            super(id, segment);\n@@ -135,2 +141,2 @@\n-        SegmentCopyAccessor(MemorySegment segment) {\n-            super(segment);\n+        SegmentCopyAccessor(int id, MemorySegment segment) {\n+            super(id, segment);\n@@ -150,2 +156,2 @@\n-        SegmentFillAccessor(MemorySegment segment) {\n-            super(segment);\n+        SegmentFillAccessor(int id, MemorySegment segment) {\n+            super(id, segment);\n@@ -164,2 +170,2 @@\n-        SegmentMismatchAccessor(MemorySegment segment) {\n-            super(segment);\n+        SegmentMismatchAccessor(int id, MemorySegment segment) {\n+            super(id, segment);\n@@ -179,2 +185,2 @@\n-        BufferAccessor(MemorySegment segment) {\n-            super(segment);\n+        BufferAccessor(int id, MemorySegment segment) {\n+            super(id, segment);\n@@ -196,2 +202,2 @@\n-        public BufferHandleAccessor(MemorySegment segment) {\n-            super(segment);\n+        public BufferHandleAccessor(int id, MemorySegment segment) {\n+            super(id, segment);\n@@ -233,0 +239,4 @@\n+    interface AccessorFactory {\n+        AbstractSegmentAccessor make(int id, MemorySegment segment);\n+    }\n+\n@@ -236,6 +246,6 @@\n-                { (Function<MemorySegment, Runnable>)SegmentAccessor::new },\n-                { (Function<MemorySegment, Runnable>)SegmentCopyAccessor::new },\n-                { (Function<MemorySegment, Runnable>)SegmentMismatchAccessor::new },\n-                { (Function<MemorySegment, Runnable>)SegmentFillAccessor::new },\n-                { (Function<MemorySegment, Runnable>)BufferAccessor::new },\n-                { (Function<MemorySegment, Runnable>)BufferHandleAccessor::new }\n+                { \"SegmentAccessor\", (AccessorFactory)SegmentAccessor::new },\n+                { \"SegmentCopyAccessor\", (AccessorFactory)SegmentCopyAccessor::new },\n+                { \"SegmentMismatchAccesor\", (AccessorFactory)SegmentMismatchAccessor::new },\n+                { \"SegmentFillAccessor\", (AccessorFactory)SegmentFillAccessor::new },\n+                { \"BufferAccessor\", (AccessorFactory)BufferAccessor::new },\n+                { \"BufferHandleAccessor\", (AccessorFactory)BufferHandleAccessor::new }\n","filename":"test\/jdk\/java\/foreign\/TestHandshake.java","additions":36,"deletions":26,"binary":false,"changes":62,"status":"modified"}]}