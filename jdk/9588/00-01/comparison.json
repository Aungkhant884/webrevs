{"files":[{"patch":"@@ -122,7 +122,1 @@\n-\n-    \/**\n-     * Overrides <code>FilterInputStream.read<\/code>\n-     * to update the progress monitor after the read.\n-     *\/\n-    public int read(byte[] b) throws IOException {\n-        int nr = in.read(b);\n+    private void setProgress(int nr) throws IOException {\n@@ -133,1 +127,1 @@\n-                monitor.setProgress(monitor.getMaximum());\n+                monitor.setProgress(monitor.getMaximum() - 1);\n@@ -135,0 +129,2 @@\n+        } else { \/\/ if EOF reached\n+            monitor.setProgress(monitor.getMaximum());\n@@ -138,1 +134,1 @@\n-                                    new InterruptedIOException(\"progress\");\n+                    new InterruptedIOException(\"progress\");\n@@ -142,0 +138,9 @@\n+    }\n+\n+    \/**\n+     * Overrides <code>FilterInputStream.read<\/code>\n+     * to update the progress monitor after the read.\n+     *\/\n+    public int read(byte[] b) throws IOException {\n+        int nr = in.read(b);\n+        setProgress(nr);\n@@ -154,13 +159,1 @@\n-        if (nr > 0) {\n-            if (nread + nr > nread) {\n-                monitor.setProgress(nread += nr);\n-            } else {\n-                monitor.setProgress(monitor.getMaximum());\n-            }\n-        }\n-        if (monitor.isCanceled()) {\n-            InterruptedIOException exc =\n-                                    new InterruptedIOException(\"progress\");\n-            exc.bytesTransferred = nread;\n-            throw exc;\n-        }\n+        setProgress(nr);\n@@ -178,1 +171,1 @@\n-            if (nread + nr > nread) {\n+            if ((int)(nread + nr) > nread) {\n","filename":"src\/java.desktop\/share\/classes\/javax\/swing\/ProgressMonitorInputStream.java","additions":16,"deletions":23,"binary":false,"changes":39,"status":"modified"}]}