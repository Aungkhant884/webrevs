{"files":[{"patch":"@@ -81,1 +81,0 @@\n-#include \"utilities\/systemMemoryBarrier.hpp\"\n@@ -2334,6 +2333,0 @@\n-  if (UseSystemMemoryBarrier) {\n-    if (!FLAG_IS_DEFAULT(UseSystemMemoryBarrier)) {\n-      warning(\"UseSystemMemoryBarrier specified, but not supported on this OS.\");\n-    }\n-    FLAG_SET_ERGO(UseSystemMemoryBarrier, false);\n-  }\n","filename":"src\/hotspot\/os\/aix\/os_aix.cpp","additions":0,"deletions":7,"binary":false,"changes":7,"status":"modified"},{"patch":"@@ -71,1 +71,0 @@\n-#include \"utilities\/systemMemoryBarrier.hpp\"\n@@ -1967,6 +1966,0 @@\n-  if (UseSystemMemoryBarrier) {\n-    if (!FLAG_IS_DEFAULT(UseSystemMemoryBarrier)) {\n-      warning(\"UseSystemMemoryBarrier specified, but not supported on this OS.\");\n-    }\n-    FLAG_SET_ERGO(UseSystemMemoryBarrier, false);\n-  }\n","filename":"src\/hotspot\/os\/bsd\/os_bsd.cpp","additions":0,"deletions":7,"binary":false,"changes":7,"status":"modified"},{"patch":"@@ -79,1 +79,0 @@\n-#include \"utilities\/systemMemoryBarrier.hpp\"\n@@ -4493,8 +4492,0 @@\n-  if (UseSystemMemoryBarrier) {\n-    if (!SystemMemoryBarrier::initialize()) {\n-      if (!FLAG_IS_DEFAULT(UseSystemMemoryBarrier)) {\n-        warning(\"UseSystemMemoryBarrier specified, but not supported on this linux version. Use -Xlog:os=info for details.\");\n-      }\n-      FLAG_SET_ERGO(UseSystemMemoryBarrier, false);\n-    }\n-  }\n","filename":"src\/hotspot\/os\/linux\/os_linux.cpp","additions":0,"deletions":9,"binary":false,"changes":9,"status":"modified"},{"patch":"@@ -79,1 +79,0 @@\n-#include \"utilities\/systemMemoryBarrier.hpp\"\n@@ -4314,4 +4313,0 @@\n-  if (UseSystemMemoryBarrier) {\n-    bool SystemMemoryBarrier_usable = SystemMemoryBarrier::initialize();\n-    assert(SystemMemoryBarrier_usable, \"should be on Windows\");\n-  }\n","filename":"src\/hotspot\/os\/windows\/os_windows.cpp","additions":0,"deletions":5,"binary":false,"changes":5,"status":"modified"},{"patch":"@@ -67,0 +67,1 @@\n+#include \"utilities\/systemMemoryBarrier.hpp\"\n@@ -2144,0 +2145,2 @@\n+  SystemMemoryBarrier::initialize();\n+\n","filename":"src\/hotspot\/share\/runtime\/arguments.cpp","additions":3,"deletions":0,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -29,0 +29,2 @@\n+#include \"runtime\/globals.hpp\"\n+#include \"runtime\/globals_extension.hpp\"\n@@ -54,2 +56,11 @@\n-  static bool initialize() { return SystemMemoryBarrierImpl::initialize(); }\n-  static void emit()       { SystemMemoryBarrierImpl::emit(); }\n+  static void initialize() {\n+    if (UseSystemMemoryBarrier) {\n+      if (!SystemMemoryBarrierImpl::initialize()) {\n+        if (!FLAG_IS_DEFAULT(UseSystemMemoryBarrier)) {\n+          warning(\"UseSystemMemoryBarrier specified, but not supported on this OS version. Use -Xlog:os=info for details.\");\n+        }\n+        FLAG_SET_ERGO(UseSystemMemoryBarrier, false);\n+      }\n+    }\n+  }\n+  static void emit() { SystemMemoryBarrierImpl::emit(); }\n","filename":"src\/hotspot\/share\/utilities\/systemMemoryBarrier.hpp","additions":13,"deletions":2,"binary":false,"changes":15,"status":"modified"}]}