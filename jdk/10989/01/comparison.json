{"files":[{"patch":"@@ -975,0 +975,2 @@\n+    case _claim_strong_stw_fullgc_mark:     out->print_cr(\"stw full gc mark\"); break;\n+    case _claim_strong_stw_fullgc_adjust:   out->print_cr(\"stw full gc adjust\"); break;\n","filename":"src\/hotspot\/share\/classfile\/classLoaderData.cpp","additions":2,"deletions":0,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -205,4 +205,6 @@\n-    _claim_none         = 0,\n-    _claim_finalizable  = 2,\n-    _claim_strong       = 3,\n-    _claim_other        = 4\n+    _claim_none                     = 0,\n+    _claim_finalizable              = 2,\n+    _claim_strong                   = 3,\n+    _claim_strong_stw_fullgc_mark   = 4,\n+    _claim_strong_stw_fullgc_adjust = 8,\n+    _claim_other                    = 16\n","filename":"src\/hotspot\/share\/classfile\/classLoaderData.hpp","additions":6,"deletions":4,"binary":false,"changes":10,"status":"modified"},{"patch":"@@ -26,0 +26,1 @@\n+#include \"classfile\/classLoaderData.hpp\"\n@@ -2111,1 +2112,1 @@\n-  : MetadataVisitingOopIterateClosure(get_cm_oop_closure_ref_processor(g1h)),\n+  : ClaimMetadataVisitingOopIterateClosure(ClassLoaderData::_claim_strong, get_cm_oop_closure_ref_processor(g1h)),\n","filename":"src\/hotspot\/share\/gc\/g1\/g1ConcurrentMark.cpp","additions":2,"deletions":1,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -184,4 +184,0 @@\n-    \/\/ Need cleared claim bits for the mark phase.\n-    ClassLoaderDataGraph::clear_claimed_marks();\n-  } else {\n-    ClassLoaderDataGraph::verify_claimed_marks_cleared(ClassLoaderData::_claim_strong);\n@@ -230,1 +226,1 @@\n-  \/\/ Need cleared claim bits for the next concurrent marking.\n+  \/\/ Need completely cleared claim bits for the next concurrent marking or full gc.\n","filename":"src\/hotspot\/share\/gc\/g1\/g1FullCollector.cpp","additions":1,"deletions":5,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -26,0 +26,1 @@\n+#include \"classfile\/classLoaderData.hpp\"\n@@ -87,2 +88,1 @@\n-  \/\/ Need cleared claim bits for the roots processing\n-  ClassLoaderDataGraph::clear_claimed_marks();\n+  ClassLoaderDataGraph::verify_claimed_marks_cleared(ClassLoaderData::_claim_strong_stw_fullgc_adjust);\n@@ -105,1 +105,1 @@\n-  CLDToOopClosure adjust_cld(&_adjust, ClassLoaderData::_claim_strong);\n+  CLDToOopClosure adjust_cld(&_adjust, ClassLoaderData::_claim_strong_stw_fullgc_adjust);\n","filename":"src\/hotspot\/share\/gc\/g1\/g1FullGCAdjustTask.cpp","additions":3,"deletions":3,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -27,0 +27,1 @@\n+#include \"classfile\/classLoaderDataGraph.hpp\"\n@@ -46,1 +47,1 @@\n-    _cld_closure(mark_closure(), ClassLoaderData::_claim_strong),\n+    _cld_closure(mark_closure(), ClassLoaderData::_claim_strong_stw_fullgc_mark),\n@@ -48,0 +49,1 @@\n+  ClassLoaderDataGraph::verify_claimed_marks_cleared(ClassLoaderData::_claim_strong_stw_fullgc_mark);\n","filename":"src\/hotspot\/share\/gc\/g1\/g1FullGCMarker.cpp","additions":3,"deletions":1,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -28,0 +28,1 @@\n+#include \"classfile\/classLoaderData.hpp\"\n@@ -182,1 +183,1 @@\n-class G1CMOopClosure : public MetadataVisitingOopIterateClosure {\n+class G1CMOopClosure : public ClaimMetadataVisitingOopIterateClosure {\n@@ -193,2 +194,1 @@\n-class G1RootRegionScanClosure : public MetadataVisitingOopIterateClosure {\n-private:\n+class G1RootRegionScanClosure : public ClaimMetadataVisitingOopIterateClosure {\n@@ -200,0 +200,1 @@\n+    ClaimMetadataVisitingOopIterateClosure(ClassLoaderData::_claim_strong, nullptr),\n","filename":"src\/hotspot\/share\/gc\/g1\/g1OopClosures.hpp","additions":4,"deletions":3,"binary":false,"changes":7,"status":"modified"}]}