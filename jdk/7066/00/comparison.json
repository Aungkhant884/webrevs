{"files":[{"patch":"@@ -28,0 +28,1 @@\n+import java.io.FileReader;\n@@ -31,0 +32,1 @@\n+import java.io.StringReader;\n@@ -65,0 +67,1 @@\n+        private final SafePath path;\n@@ -68,0 +71,1 @@\n+            this.path = knownPath;\n@@ -273,0 +277,9 @@\n+\n+    public static Reader newReader(SafePath sf) throws IOException {\n+        for (KnownConfiguration c : getKnownConfigurations()) {\n+            if (c.path.equals(sf)) {\n+                return new StringReader(c.content);\n+            }\n+        }\n+        return new FileReader(sf.toFile(), StandardCharsets.UTF_8);\n+    }\n","filename":"src\/jdk.jfr\/share\/classes\/jdk\/jfr\/internal\/jfc\/JFC.java","additions":13,"deletions":0,"binary":false,"changes":13,"status":"modified"},{"patch":"@@ -29,0 +29,1 @@\n+import java.io.Reader;\n@@ -38,0 +39,1 @@\n+import jdk.jfr.internal.jfc.JFC;\n@@ -46,3 +48,7 @@\n-    public JFCModel(SafePath file, Consumer<String> logger) throws ParseException, IOException {\n-        this.configuration = createConfiguration(file);\n-        this.configuration.validate();\n+    private JFCModel(XmlConfiguration configuration) throws ParseException {\n+        configuration.validate();\n+        this.configuration = configuration;\n+    }\n+\n+    public JFCModel(Reader reader,  Consumer<String> logger) throws ParseException, IOException {\n+        this(Parser.parse(reader));\n@@ -58,1 +64,1 @@\n-            JFCModel model = new JFCModel(file, logger);\n+            JFCModel model = JFCModel.create(file, logger);\n@@ -73,0 +79,12 @@\n+    public static JFCModel create(SafePath file, Consumer<String> logger) throws ParseException, IOException {\n+        if (file.toString().equals(\"none\")) {\n+            XmlConfiguration configuration = new XmlConfiguration();\n+            configuration.setAttribute(\"version\", \"2.0\");\n+            configuration.setAttribute(\"label\", \"None\");\n+            return new JFCModel(configuration);\n+        }\n+        try (Reader r = JFC.newReader(file)) {\n+            return new JFCModel(r, logger);\n+        }\n+    }\n+\n@@ -208,10 +226,0 @@\n-\n-    private XmlConfiguration createConfiguration(SafePath file) throws ParseException, IOException {\n-        if (file.toString().equals(\"none\")) {\n-            XmlConfiguration configuration = new XmlConfiguration();\n-            configuration.setAttribute(\"version\", \"2.0\");\n-            configuration.setAttribute(\"label\", \"None\");\n-            return configuration;\n-        }\n-        return Parser.parse(file.toPath());\n-    }\n","filename":"src\/jdk.jfr\/share\/classes\/jdk\/jfr\/internal\/jfc\/model\/JFCModel.java","additions":22,"deletions":14,"binary":false,"changes":36,"status":"modified"},{"patch":"@@ -27,1 +27,0 @@\n-import java.io.FileReader;\n@@ -29,1 +28,1 @@\n-import java.nio.file.Path;\n+import java.io.Reader;\n@@ -41,2 +40,0 @@\n-import static java.nio.charset.StandardCharsets.UTF_8;\n-\n@@ -45,2 +42,2 @@\n-    static XmlConfiguration parse(Path path) throws ParseException, IOException {\n-        try (FileReader r = new FileReader(path.toFile(), UTF_8)) {\n+    static XmlConfiguration parse(Reader reader) throws ParseException, IOException {\n+        try {\n@@ -49,1 +46,1 @@\n-            saxParser.parse(new InputSource(r), handler);\n+            saxParser.parse(new InputSource(reader), handler);\n","filename":"src\/jdk.jfr\/share\/classes\/jdk\/jfr\/internal\/jfc\/model\/Parser.java","additions":4,"deletions":7,"binary":false,"changes":11,"status":"modified"},{"patch":"@@ -130,1 +130,1 @@\n-        JFCModel parameters = new JFCModel(path, l -> stream.println(\"Warning! \" + l));\n+        JFCModel parameters = JFCModel.create(path, l -> stream.println(\"Warning! \" + l));\n","filename":"src\/jdk.jfr\/share\/classes\/jdk\/jfr\/internal\/tool\/Configure.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"}]}