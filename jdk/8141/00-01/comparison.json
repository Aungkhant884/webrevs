{"files":[{"patch":"@@ -47,0 +47,4 @@\n+    static JFrame f;\n+    static JDialog dialog;\n+    static boolean testResult = false;\n+    static CountDownLatch latch = new CountDownLatch(1);\n@@ -49,5 +53,0 @@\n-        final CountDownLatch latch = new CountDownLatch(1);\n-\n-        PrintAllPages test = new PrintAllPages(latch);\n-        Thread T1 = new Thread(test);\n-        T1.start();\n@@ -55,2 +54,0 @@\n-        \/\/ wait for latch to complete\n-        boolean ret = false;\n@@ -58,14 +55,4 @@\n-            ret = latch.await(5, TimeUnit.MINUTES);\n-        } catch (InterruptedException ie) {\n-            throw ie;\n-        }\n-        if (!ret) {\n-            test.dispose();\n-            throw new RuntimeException(\" User has not executed the test\");\n-        }\n-\n-        if (test.testResult == false) {\n-            throw new RuntimeException(\"Only 1st page is printed out of multiple pages\");\n-        }\n-    }\n-}\n+            SwingUtilities.invokeAndWait(() -> {\n+                createUI();\n+                printAllPagesTest();\n+           });\n@@ -73,5 +60,3 @@\n-class PrintAllPages implements Runnable {\n-    static JFrame f;\n-    static JDialog dialog;\n-    public boolean testResult = false;\n-    private final CountDownLatch latch;\n+            \/\/ wait for latch to complete\n+            boolean ret = false;\n+            ret = latch.await(5, TimeUnit.MINUTES);\n@@ -79,3 +64,3 @@\n-    public PrintAllPages(CountDownLatch latch) throws Exception {\n-        this.latch = latch;\n-    }\n+            if (!ret) {\n+                throw new RuntimeException(\" User has not executed the test\");\n+            }\n@@ -83,8 +68,2 @@\n-    @Override\n-    public void run() {\n-        try {\n-            createUI();\n-            printAllPagesTest();\n-        } catch (Exception ex) {\n-            if (f != null) {\n-                f.dispose();\n+            if (testResult == false) {\n+                throw new RuntimeException(\"Only 1st page is printed out of multiple pages\");\n@@ -92,2 +71,4 @@\n-            latch.countDown();\n-            throw new RuntimeException(\"createUI Failed: \" + ex.getMessage());\n+        } finally {\n+            SwingUtilities.invokeAndWait(() -> {\n+                dispose();\n+            });\n@@ -95,1 +76,0 @@\n-\n@@ -98,43 +78,7 @@\n-    public void dispose() {\n-        dialog.dispose();\n-        f.dispose();\n-    }\n-\n-    private static void printAllPagesTest() throws Exception {\n-        SwingUtilities.invokeAndWait(() -> {\n-            TableModel dataModel = new AbstractTableModel() {\n-                @Override\n-                public int getColumnCount() {\n-                    return 10;\n-                }\n-\n-                @Override\n-                public int getRowCount() {\n-                    return 1000;\n-                }\n-\n-                @Override\n-                public Object getValueAt(int row, int col) {\n-                    return Integer.valueOf(0 == col ? row + 1 : row * col);\n-                }\n-            };\n-            JTable table = new JTable(dataModel) {\n-                @Override\n-                public Rectangle getBounds() {\n-                    Rectangle bounds = super.getBounds();\n-                    return bounds;\n-                }\n-            };\n-            JScrollPane scrollpane = new JScrollPane(table);\n-            table.scrollRectToVisible(table.getCellRect(table.getRowCount() - 1, 0, false));\n-\n-            f = new JFrame(\"Table test\");\n-            f.add(scrollpane);\n-            f.setSize(1000, 800);\n-            f.setLocationRelativeTo(null);\n-            f.setDefaultCloseOperation(WindowConstants.EXIT_ON_CLOSE);\n-            f.setVisible(true);\n-            try {\n-                table.print();\n-            } catch (Exception e) {}\n-        });\n+    private static void dispose() {\n+        if (dialog != null) {\n+            dialog.dispose();\n+        }\n+        if (f != null) {\n+            f.dispose();\n+        }\n@@ -143,2 +87,2 @@\n-    private final void createUI() throws Exception {\n-        SwingUtilities.invokeAndWait(new Runnable() {\n+    private static void printAllPagesTest() {\n+        TableModel dataModel = new AbstractTableModel() {\n@@ -146,1 +90,3 @@\n-            public void run() {\n+            public int getColumnCount() {\n+                return 10;\n+            }\n@@ -148,5 +94,4 @@\n-                String description\n-                        = \" INSTRUCTIONS:\\n\"\n-                        + \" A JTable will be shown.\\n\"\n-                        + \" If only 1 page is printed,\\n \"\n-                        + \" then press fail else press pass\";\n+            @Override\n+            public int getRowCount() {\n+                return 1000;\n+            }\n@@ -154,25 +99,3 @@\n-                dialog = new JDialog();\n-                dialog.setTitle(\"textselectionTest\");\n-                JTextArea textArea = new JTextArea(description);\n-                textArea.setEditable(false);\n-                final JButton passButton = new JButton(\"PASS\");\n-                passButton.addActionListener((e) -> {\n-                    testResult = true;\n-                    dispose();\n-                    latch.countDown();\n-                });\n-                final JButton failButton = new JButton(\"FAIL\");\n-                failButton.addActionListener((e) -> {\n-                    testResult = false;\n-                    dispose();\n-                    latch.countDown();\n-                });\n-                JPanel mainPanel = new JPanel(new BorderLayout());\n-                mainPanel.add(textArea, BorderLayout.CENTER);\n-                JPanel buttonPanel = new JPanel(new FlowLayout());\n-                buttonPanel.add(passButton);\n-                buttonPanel.add(failButton);\n-                mainPanel.add(buttonPanel, BorderLayout.SOUTH);\n-                dialog.add(mainPanel);\n-                dialog.pack();\n-                dialog.setVisible(true);\n+            @Override\n+            public Object getValueAt(int row, int col) {\n+                return Integer.valueOf(0 == col ? row + 1 : row * col);\n@@ -180,0 +103,38 @@\n+        };\n+        JTable table = new JTable(dataModel);\n+        JScrollPane scrollpane = new JScrollPane(table);\n+        table.scrollRectToVisible(table.getCellRect(table.getRowCount() - 1, 0, false));\n+\n+        f = new JFrame(\"Table test\");\n+        f.add(scrollpane);\n+        f.setSize(1000, 800);\n+        f.setLocationRelativeTo(null);\n+        f.setDefaultCloseOperation(WindowConstants.EXIT_ON_CLOSE);\n+        f.setVisible(true);\n+        try {\n+            table.print();\n+        } catch (Exception e) {}\n+    }\n+\n+    private static void createUI() {\n+        String description\n+                = \" INSTRUCTIONS:\\n\"\n+                + \" A JTable will be shown.\\n\"\n+                + \" If only 1 page is printed,\\n \"\n+                + \" then press fail else press pass\";\n+\n+        dialog = new JDialog();\n+        dialog.setTitle(\"textselectionTest\");\n+        JTextArea textArea = new JTextArea(description);\n+        textArea.setEditable(false);\n+        final JButton passButton = new JButton(\"PASS\");\n+        passButton.addActionListener((e) -> {\n+            testResult = true;\n+            dispose();\n+            latch.countDown();\n+        });\n+        final JButton failButton = new JButton(\"FAIL\");\n+        failButton.addActionListener((e) -> {\n+            testResult = false;\n+            dispose();\n+            latch.countDown();\n@@ -181,0 +142,9 @@\n+        JPanel mainPanel = new JPanel(new BorderLayout());\n+        mainPanel.add(textArea, BorderLayout.CENTER);\n+        JPanel buttonPanel = new JPanel(new FlowLayout());\n+        buttonPanel.add(passButton);\n+        buttonPanel.add(failButton);\n+        mainPanel.add(buttonPanel, BorderLayout.SOUTH);\n+        dialog.add(mainPanel);\n+        dialog.pack();\n+        dialog.setVisible(true);\n","filename":"test\/jdk\/javax\/swing\/JTable\/PrintAllPagesTest.java","additions":86,"deletions":116,"binary":false,"changes":202,"status":"modified"}]}