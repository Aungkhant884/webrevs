{"files":[{"patch":"@@ -349,0 +349,1 @@\n+            int maxUnexpected = 2;\n@@ -350,0 +351,1 @@\n+                boolean accepted = false;\n@@ -360,1 +362,3 @@\n-                    assert query != null;\n+                    if (query == null) {\n+                        throw new IOException(\"expected query not found in: \" + uriPath);\n+                    }\n@@ -366,1 +370,1 @@\n-                        len = Integer.parseInt(query.split(\"=\")[1]);\n+                        len = Integer.parseInt(qv);\n@@ -369,0 +373,4 @@\n+                    \/\/ if we get an exception past this point\n+                    \/\/ we will rethrow it\n+                    accepted = true;\n+\n@@ -371,1 +379,1 @@\n-                    out.println(name  + \": headers written, writing \" + len  + \" body bytes\");\n+                    out.println(name + \": headers written, writing \" + len + \" body bytes\");\n@@ -373,1 +381,1 @@\n-                    for (int i = 0; i< len; i++) {\n+                    for (int i = 0; i < len; i++) {\n@@ -377,3 +385,10 @@\n-                } catch (IOException e) {\n-                    if (!closed)\n-                        throw new UncheckedIOException(\"Unexpected\", e);\n+                } catch (IOException | RuntimeException e) {\n+                    if (!closed) {\n+                        if (--maxUnexpected <= 0 || accepted) {\n+                            if (e instanceof IOException io)\n+                                throw new UncheckedIOException(io);\n+                            else throw (RuntimeException) e;\n+                        }\n+                        out.println(\"ignoring unexpected exception: \" + e);\n+                        continue;\n+                    }\n","filename":"test\/jdk\/java\/net\/httpclient\/ResponseBodyBeforeError.java","additions":22,"deletions":7,"binary":false,"changes":29,"status":"modified"}]}