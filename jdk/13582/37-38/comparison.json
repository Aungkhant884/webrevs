{"files":[{"patch":"@@ -33,2 +33,0 @@\n-#include \"logging\/log.hpp\"\n-\n@@ -54,3 +52,7 @@\n-    if (UseSerialGC && heap.word_size() <= (1 << NUM_OFFSET_BITS)) {\n-      \/\/ In this case we can treat the whole heap as a single region and\n-      \/\/ make the encoding very simple.\n+    \/\/ If the heap is small enough to fit directly into the available offset bits,\n+    \/\/ and we are running Serial GC, we can treat the whole heap as a single region\n+    \/\/ if it happens to be aligned to allow biasing.\n+    size_t rounded_heap_size = round_up_power_of_2(heap.byte_size());\n+\n+    if (UseSerialGC && (heap.word_size() <= (1 << NUM_OFFSET_BITS)) &&\n+        is_aligned((uintptr_t)_heap_start, rounded_heap_size)) {\n@@ -59,1 +61,1 @@\n-      _region_size_bytes_shift = log2i_exact(round_up_power_of_2(_region_size_words)) + LogHeapWordSize;\n+      _region_size_bytes_shift = log2i_exact(rounded_heap_size);\n","filename":"src\/hotspot\/share\/gc\/shared\/slidingForwarding.cpp","additions":8,"deletions":6,"binary":false,"changes":14,"status":"modified"},{"patch":"@@ -48,0 +48,11 @@\n+\/*\n+ * @test id=alt-forwarding-unaligned\n+ * @key stress\n+ * @bug 8190703\n+ * @library \/\n+ * @requires vm.gc.Serial\n+ * @requires vm.debug\n+ * @summary Stress the Serial GC full GC by allocating objects of different lifetimes concurrently with System.gc().\n+ * @run main\/othervm\/timeout=300 -XX:+UseAltGCForwarding -Xlog:gc*=info -Xmx700m -XX:+UseSerialGC gc.stress.systemgc.TestSystemGCWithSerial 270\n+ *\/\n+\n","filename":"test\/hotspot\/jtreg\/gc\/stress\/systemgc\/TestSystemGCWithSerial.java","additions":11,"deletions":0,"binary":false,"changes":11,"status":"modified"}]}