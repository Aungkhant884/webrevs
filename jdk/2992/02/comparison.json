{"files":[{"patch":"@@ -28,1 +28,0 @@\n-import java.io.BufferedInputStream;\n@@ -55,2 +54,1 @@\n-        try (InputStream in = Files.newInputStream(file);\n-             BufferedInputStream bis = new BufferedInputStream(in)) {\n+        try (InputStream in = Files.newInputStream(file)) {\n@@ -58,2 +56,4 @@\n-            byte[] magic = new byte[4];\n-            bis.read(magic);\n+            byte[] magic = in.readNBytes(4);\n+            if (magic.length != 4) {\n+                throw new IOException(\"Header expected to be of length 4, but was \" + magic.length);\n+            }\n","filename":"src\/java.base\/share\/classes\/jdk\/internal\/jmod\/JmodFile.java","additions":5,"deletions":5,"binary":false,"changes":10,"status":"modified"},{"patch":"@@ -431,2 +431,1 @@\n-                BufferedInputStream tmpbuf =\n-                        new BufferedInputStream(serverSocket.getInputStream());\n+                InputStream tmpbuf = serverSocket.getInputStream();\n","filename":"src\/java.base\/share\/classes\/sun\/net\/www\/http\/HttpClient.java","additions":1,"deletions":2,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -30,1 +30,0 @@\n-import java.io.BufferedInputStream;\n@@ -55,4 +54,1 @@\n-        InputStream is =\n-            new BufferedInputStream(new ByteArrayInputStream(imagedata,\n-                                                             imageoffset,\n-                                                             imagelength));\n+        InputStream is = new ByteArrayInputStream(imagedata, imageoffset, imagelength);\n","filename":"src\/java.desktop\/share\/classes\/sun\/awt\/image\/ByteArrayImageSource.java","additions":1,"deletions":5,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -201,1 +201,1 @@\n-                    .call().assertFailure(\"Error: java.io.IOException: Invalid JMOD file\");\n+                    .call().assertFailure(\"Header expected to be of length 4, but was 0\");\n","filename":"test\/jdk\/tools\/jlink\/JLinkNegativeTest.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"}]}