{"files":[{"patch":"@@ -29,2 +29,0 @@\n-\n-com\/sun\/jdi\/EATests.java#id0 8255072 generic-all\n","filename":"test\/jdk\/ProblemList-zgc.txt","additions":0,"deletions":2,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -150,0 +150,1 @@\n+import sun.hotspot.gc.GC;\n@@ -300,0 +301,1 @@\n+        public final boolean ZGCIsSelected;\n@@ -312,0 +314,2 @@\n+            val = testCaseBaseTargetClass.getValue(testCaseBaseTargetClass.fieldByName(\"ZGCIsSelected\"));\n+            ZGCIsSelected = ((PrimitiveValue) val).booleanValue();\n@@ -783,0 +787,1 @@\n+    public static final boolean ZGCIsSelected        = GC.Z.isSelected();\n@@ -1079,6 +1084,1 @@\n-        public LinkedList l;\n-        public LinkedList(LinkedList l) {\n-            this.l = l;\n-        }\n-    }\n-    static class LinkedListOfLongArrays extends LinkedList {\n+        LinkedList l;\n@@ -1086,3 +1086,3 @@\n-        public LinkedListOfLongArrays(LinkedList l, int size) {\n-            super(l);\n-            this.array = new long[size];\n+        public LinkedList(LinkedList l, int size) {\n+            this.array = size > 0 ? new long[size] : null;\n+            this.l = l;\n@@ -1097,1 +1097,1 @@\n-        while(size > 0) {\n+        while(true) {\n@@ -1100,2 +1100,1 @@\n-                    consumedMemory =\n-                            size == 1 ? new LinkedList(consumedMemory) : new LinkedListOfLongArrays(consumedMemory, size);\n+                    consumedMemory = new LinkedList(consumedMemory, size);\n@@ -1104,0 +1103,1 @@\n+                if (size == 0) break;\n@@ -2611,3 +2611,3 @@\n-        \/\/ We succeeded to pop just one frame if OOM was raised. When we continue, we will call dontinline_brkpt() again.\n-        String expectedTopFrame =\n-                coughtOom ? \"dontinline_consume_all_memory_brkpt\" : \"dontinline_testMethod\";\n+        \/\/ We succeeded to pop just one frame. When we continue, we will call dontinline_brkpt() again.\n+        Asserts.assertTrue(coughtOom, \"PopFrame should have triggered an OOM exception in target\");\n+        String expectedTopFrame = \"dontinline_consume_all_memory_brkpt\";\n@@ -2624,0 +2624,2 @@\n+                \/\/ With ZGC the OOME is not always thrown as expected\n+                env.targetVMOptions.ZGCIsSelected ||\n@@ -2667,0 +2669,2 @@\n+                \/\/ With ZGC the OOME is not always thrown as expected\n+                ZGCIsSelected ||\n@@ -2707,2 +2711,2 @@\n-        String expectedTopFrame =\n-                coughtOom ? \"inlinedCallForcedToReturn\" : \"dontinline_testMethod\";\n+        Asserts.assertTrue(coughtOom, \"PopFrame should have triggered an OOM exception in target\");\n+        String expectedTopFrame = \"inlinedCallForcedToReturn\";\n@@ -2718,0 +2722,2 @@\n+                \/\/ With ZGC the OOME is not always thrown as expected\n+                env.targetVMOptions.ZGCIsSelected ||\n@@ -2777,0 +2783,2 @@\n+                \/\/ With ZGC the OOME is not always thrown as expected\n+                ZGCIsSelected ||\n@@ -2965,5 +2973,4 @@\n-        if (coughtOom) {\n-            printStack(thread);\n-            msg(\"ForceEarlyReturn(2)\");\n-            thread.forceEarlyReturn(env.vm().mirrorOf(43));\n-        }\n+        Asserts.assertTrue(coughtOom, \"ForceEarlyReturn should have triggered an OOM exception in target\");\n+        printStack(thread);\n+        msg(\"ForceEarlyReturn(2)\");\n+        thread.forceEarlyReturn(env.vm().mirrorOf(43));\n@@ -2982,0 +2989,2 @@\n+                \/\/ With ZGC the OOME is not always thrown as expected\n+                env.targetVMOptions.ZGCIsSelected ||\n@@ -3042,0 +3051,2 @@\n+                \/\/ With ZGC the OOME is not always thrown as expected\n+                ZGCIsSelected ||\n","filename":"test\/jdk\/com\/sun\/jdi\/EATests.java","additions":33,"deletions":22,"binary":false,"changes":55,"status":"modified"}]}