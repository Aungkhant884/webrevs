{"files":[{"patch":"@@ -1894,2 +1894,7 @@\n-  SYSTEM_INFO si;\n-  GetSystemInfo(&si);\n+  int proc_count = os::processor_count();\n+  \/\/ handle potential early cases where processor count is not yet set\n+  if (proc_count < 1) {\n+    SYSTEM_INFO si;\n+    GetSystemInfo(&si);\n+    proc_count = si.dwNumberOfProcessors;\n+  }\n@@ -1897,1 +1902,1 @@\n-  size_t sz_check = sizeof(PROCESSOR_POWER_INFORMATION) * (size_t)si.dwNumberOfProcessors;\n+  size_t sz_check = sizeof(PROCESSOR_POWER_INFORMATION) * (size_t)proc_count;\n@@ -1902,1 +1907,1 @@\n-    for (size_t i = 0; i < si.dwNumberOfProcessors; i++) {\n+    for (size_t i = 0; i < proc_count; i++) {\n@@ -1904,5 +1909,4 @@\n-      st->print_cr(\"  Max Mhz: %d\", (int) pppi->MaxMhz);\n-      st->print_cr(\"  Current Mhz: %d\", (int) pppi->CurrentMhz);\n-      st->print_cr(\"  Mhz Limit: %d\", (int) pppi->MhzLimit);\n-      st->print_cr(\"  MaxIdleState: %d\", (int) pppi->MaxIdleState);\n-      st->print_cr(\"  CurrentIdleState: %d\", (int) pppi->CurrentIdleState);\n+      st->print_cr(\"  Max Mhz: %d, Current Mhz: %d, Mhz Limit: %d\",\n+                   (int) pppi->MaxMhz, (int) pppi->CurrentMhz, (int) pppi->MhzLimit);\n+      st->print_cr(\"  MaxIdleState: %d, CurrentIdleState: %d\",\n+                   (int) pppi->MaxIdleState, (int) pppi->CurrentIdleState);\n","filename":"src\/hotspot\/os\/windows\/os_windows.cpp","additions":13,"deletions":9,"binary":false,"changes":22,"status":"modified"}]}