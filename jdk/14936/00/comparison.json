{"files":[{"patch":"@@ -114,11 +114,13 @@\n-  DIR *dir = opendir(sys_hugepages);\n-\n-  struct dirent *entry;\n-  size_t pagesize;\n-  while ((entry = readdir(dir)) != nullptr) {\n-    if (entry->d_type == DT_DIR &&\n-        sscanf(entry->d_name, \"hugepages-%zukB\", &pagesize) == 1) {\n-      \/\/ The kernel is using kB, hotspot uses bytes\n-      \/\/ Add each found Large Page Size to page_sizes\n-      pagesize *= K;\n-      pagesizes.add(pagesize);\n+  DIR* dir = opendir(sys_hugepages);\n+\n+  if (dir != nullptr) {\n+    struct dirent *entry;\n+    size_t pagesize;\n+    while ((entry = readdir(dir)) != nullptr) {\n+      if (entry->d_type == DT_DIR &&\n+          sscanf(entry->d_name, \"hugepages-%zukB\", &pagesize) == 1) {\n+        \/\/ The kernel is using kB, hotspot uses bytes\n+        \/\/ Add each found Large Page Size to page_sizes\n+        pagesize *= K;\n+        pagesizes.add(pagesize);\n+      }\n@@ -126,0 +128,1 @@\n+    closedir(dir);\n@@ -127,1 +130,0 @@\n-  closedir(dir);\n@@ -145,1 +147,0 @@\n-  _pagesizes = scan_hugepages();\n@@ -147,3 +148,6 @@\n-  assert(_pagesizes.contains(_default_hugepage_size),\n-         \"Unexpected configuration: default pagesize (\" SIZE_FORMAT \") \"\n-         \"has no associated directory in \/sys\/kernel\/mm\/hugepages..\", _default_hugepage_size);\n+  if (_default_hugepage_size > 0) {\n+    _pagesizes = scan_hugepages();\n+    assert(_pagesizes.contains(_default_hugepage_size),\n+           \"Unexpected configuration: default pagesize (\" SIZE_FORMAT \") \"\n+           \"has no associated directory in \/sys\/kernel\/mm\/hugepages..\", _default_hugepage_size);\n+  }\n","filename":"src\/hotspot\/os\/linux\/hugepages.cpp","additions":20,"deletions":16,"binary":false,"changes":36,"status":"modified"}]}