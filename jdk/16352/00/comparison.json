{"files":[{"patch":"@@ -146,0 +146,18 @@\n+    size_t num_entries = Atomic::load(&_num_entries);\n+    if (num_entries != 0) {\n+      auto do_value =\n+        [] (nmethod** value) {\n+          return true;\n+      };\n+\n+      size_t num_deleted = 0;\n+      auto do_delete =\n+        [&] (nmethod** value) {\n+          num_deleted++;\n+      };\n+\n+      bool succeeded = _table.try_bulk_delete(Thread::current(), do_value, do_delete);\n+      guarantee(succeeded, \"unable to clean table\");\n+      assert(num_entries == num_deleted, \"must empty the table\");\n+      Atomic::store(&_num_entries, (size_t)0);\n+    }\n@@ -147,1 +165,0 @@\n-    Atomic::store(&_num_entries, (size_t)0);\n","filename":"src\/hotspot\/share\/gc\/g1\/g1CodeRootSet.cpp","additions":18,"deletions":1,"binary":false,"changes":19,"status":"modified"}]}