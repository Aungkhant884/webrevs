{"files":[{"patch":"@@ -80,10 +80,0 @@\n- private:\n-  static inline void transition_and_process(JavaThread *thread, JavaThreadState to, bool check_asyncs) {\n-    \/\/ Check NoSafepointVerifier. This also clears unhandled oops if CheckUnhandledOops is used.\n-    thread->check_possible_safepoint();\n-\n-    thread->set_thread_state_fence(_thread_in_vm);\n-    SafepointMechanism::process_if_requested_with_exit_check(thread, check_asyncs);\n-    thread->set_thread_state(to);\n-  }\n-\n@@ -109,1 +99,4 @@\n-    transition_and_process(thread, to, to != _thread_in_Java ? false : check_asyncs);\n+\n+    thread->set_thread_state_fence(_thread_in_vm);\n+    SafepointMechanism::process_if_requested_with_exit_check(thread, to != _thread_in_Java ? false : check_asyncs);\n+    thread->set_thread_state(to);\n@@ -115,1 +108,2 @@\n-      transition_and_process(thread, _thread_in_Java, check_asyncs);\n+      SafepointMechanism::process_if_requested_with_exit_check(thread, check_asyncs);\n+      thread->set_thread_state(to);\n","filename":"src\/hotspot\/share\/runtime\/interfaceSupport.inline.hpp","additions":6,"deletions":12,"binary":false,"changes":18,"status":"modified"},{"patch":"@@ -88,9 +88,2 @@\n-\n-  \/\/ Macos\/aarch64 should be in the right state for safepoint (e.g.\n-  \/\/ deoptimization needs WXWrite).  Crashes caused by the wrong state rarely\n-  \/\/ happens in practice, making such issues hard to find and reproduce.\n-#if defined(ASSERT) && defined(__APPLE__) && defined(AARCH64)\n-  if (AssertWXAtThreadSync) {\n-    thread->assert_wx_state(WXWrite);\n-  }\n-#endif\n+  \/\/ Check NoSafepointVerifier. This also clears unhandled oops if CheckUnhandledOops is used.\n+  thread->check_possible_safepoint();\n","filename":"src\/hotspot\/share\/runtime\/safepointMechanism.inline.hpp","additions":2,"deletions":9,"binary":false,"changes":11,"status":"modified"},{"patch":"@@ -951,0 +951,9 @@\n+\n+  \/\/ Macos\/aarch64 should be in the right state for safepoint (e.g.\n+  \/\/ deoptimization needs WXWrite).  Crashes caused by the wrong state rarely\n+  \/\/ happens in practice, making such issues hard to find and reproduce.\n+#if defined(__APPLE__) && defined(AARCH64)\n+  if (AssertWXAtThreadSync) {\n+    assert_wx_state(WXWrite);\n+  }\n+#endif\n","filename":"src\/hotspot\/share\/runtime\/thread.cpp","additions":9,"deletions":0,"binary":false,"changes":9,"status":"modified"}]}