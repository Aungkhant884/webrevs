{"files":[{"patch":"@@ -266,2 +266,4 @@\n-            if (!fragment.hasRemaining()) {\n-                throw new SSLProtocolException(\"Handshake packets may not be zero-length\");\n+            if (contentLen == 0) {\n+                \/\/ From RFC 8446: \"Implementations MUST NOT send zero-length fragments\n+                \/\/ of Handshake types, even if those fragments contain padding.\"\n+                throw new SSLProtocolException(\"Handshake packets must not be zero-length\");\n","filename":"src\/java.base\/share\/classes\/sun\/security\/ssl\/SSLEngineInputRecord.java","additions":4,"deletions":2,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -287,2 +287,4 @@\n-            if (!handshakeFrag.hasRemaining()) {\n-                throw new SSLProtocolException(\"Handshake fragments cannot be zero length.\");\n+            if (contentLen == 0) {\n+                \/\/ From RFC 8446: \"Implementations MUST NOT send zero-length fragments\n+                \/\/ of Handshake types, even if those fragments contain padding.\"\n+                throw new SSLProtocolException(\"Handshake fragments must not be zero length.\");\n","filename":"src\/java.base\/share\/classes\/sun\/security\/ssl\/SSLSocketInputRecord.java","additions":4,"deletions":2,"binary":false,"changes":6,"status":"modified"}]}