{"files":[{"patch":"@@ -522,1 +522,1 @@\n-            if (responseCode < 100 || responseCode > 199)\n+            if (responseCode < 100 || responseCode > 199) {\n@@ -524,2 +524,7 @@\n-            if (responseCode == 100 && hf.getFlag(HeaderFrame.END_STREAM)\n-                    && !finalResponseCodeReceived) {\n+            } else if (hf.getFlag(HeaderFrame.END_STREAM)) {\n+                \/\/ see RFC 9113 section 8.1:\n+                \/\/ A HEADERS frame with the END_STREAM flag set that carries an\n+                \/\/ informational status code is malformed\n+                String msg = (\"Stream %s PROTOCOL_ERROR: \" +\n+                        \"HEADERS frame with status %s has END_STREAM flag set\")\n+                        .formatted(streamid, responseCode);\n@@ -527,1 +532,1 @@\n-                    debug.log(\"Received 100 statusCode, but FIN bit is set\");\n+                    debug.log(msg);\n@@ -529,1 +534,1 @@\n-                cancelImpl(new IOException(\"stream closed after 100, no other response expected\"));\n+                cancelImpl(new IOException(msg), ResetFrame.PROTOCOL_ERROR);\n@@ -532,1 +537,0 @@\n-\n","filename":"src\/java.net.http\/share\/classes\/jdk\/internal\/net\/http\/Stream.java","additions":10,"deletions":6,"binary":false,"changes":16,"status":"modified"}]}