{"files":[{"patch":"@@ -2630,1 +2630,1 @@\n-            h = h * 43 + Objects.hashCode(e.name());\n+            h = h + Objects.hashCode(e.name()) * 43;\n","filename":"src\/java.base\/share\/classes\/java\/lang\/module\/ModuleDescriptor.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2021, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2021, 2022, Oracle and\/or its affiliates. All rights reserved.\n@@ -24,2 +24,0 @@\n-import org.testng.annotations.Test;\n-\n@@ -31,0 +29,1 @@\n+import org.testng.annotations.Test;\n@@ -36,1 +35,2 @@\n- * @bug 8275509\n+ * @bug 8275509 8290041\n+ * @summary Tests the ModuleDescriptor.hashCode()\n@@ -39,1 +39,0 @@\n- * @summary Tests the ModuleDescriptor.hashCode() for boot layer modules\n@@ -66,0 +65,39 @@\n+    \/**\n+     * Verifies that two \"equal\" module descriptors which only differ in the order of\n+     * {@link ModuleDescriptor.Opens.Modifier opens modifiers}, that were used to construct the\n+     * descriptors, have the same hashcode.\n+     *\/\n+    @Test\n+    public void testModifiersOrdering() throws Exception {\n+        \/\/ create a module descriptor\n+\n+        \/\/ important to use Set.of() (i.e. backed by immutable set) to reproduce the issue\n+        final Set<ModuleDescriptor.Opens.Modifier> mod1 = Set.of(\n+                ModuleDescriptor.Opens.Modifier.SYNTHETIC, ModuleDescriptor.Opens.Modifier.MANDATED);\n+        final ModuleDescriptor desc1 = ModuleDescriptor.newModule(\"foobar\")\n+                .opens(mod1, \"a.p1\", Set.of(\"a.m1\"))\n+                .build();\n+\n+        \/\/ create the same module descriptor again and this time just change the order of the\n+        \/\/ \"opens\" modifiers' Set.\n+\n+        \/\/ important to use Set.of() (i.e. backed by immutable set) to reproduce the issue\n+        final Set<ModuleDescriptor.Opens.Modifier> mod2 = Set.of(\n+                ModuleDescriptor.Opens.Modifier.MANDATED, ModuleDescriptor.Opens.Modifier.SYNTHETIC);\n+        final ModuleDescriptor desc2 = ModuleDescriptor.newModule(\"foobar\")\n+                .opens(mod2, \"a.p1\", Set.of(\"a.m1\"))\n+                .build();\n+\n+        \/\/ basic verification of the modifiers themselves before we check the module descriptors\n+        assertEquals(mod1, mod2, \"Modifiers were expected to be equal\");\n+\n+        \/\/ now verify the module descriptors\n+        assertEquals(desc1, desc2, \"Module descriptors were expected to be equal\");\n+        assertEquals(desc1.compareTo(desc2), 0, \"compareTo was expected to return\" +\n+                \" 0 for module descriptors that are equal\");\n+        System.out.println(desc1 + \" hashcode = \" + desc1.hashCode());\n+        System.out.println(desc2 + \" hashcode = \" + desc2.hashCode());\n+        assertEquals(desc1.hashCode(), desc2.hashCode(), \"Module descriptor hashcodes\" +\n+                \" were expected to be equal\");\n+    }\n+\n","filename":"test\/jdk\/java\/lang\/module\/ModuleDescriptorHashCodeTest.java","additions":43,"deletions":5,"binary":false,"changes":48,"status":"modified"}]}