{"files":[{"patch":"@@ -53,0 +53,4 @@\n+#if defined(__APPLE__)\n+    \/\/ On macOS systems we use disconnectx\n+    rv = disconnectx(fd, SAE_ASSOCID_ANY, SAE_CONNID_ANY);\n+#else\n@@ -54,0 +58,6 @@\n+    memset(&sa, 0, sizeof(sa));\n+    #if defined(_ALLBSD_SOURCE)\n+        sa.sa.sa_family = isIPv6 ? AF_INET6 : AF_INET;\n+    #else\n+        sa.sa.sa_family = AF_UNSPEC;\n+    #endif\n@@ -56,8 +66,0 @@\n-\n-    memset(&sa, 0, sizeof(sa));\n-#if defined(_ALLBSD_SOURCE)\n-    sa.sa.sa_family = isIPv6 ? AF_INET6 : AF_INET;\n-#else\n-    sa.sa.sa_family = AF_UNSPEC;\n-#endif\n-\n@@ -65,0 +67,1 @@\n+#endif\n@@ -66,1 +69,6 @@\n-#if defined(_ALLBSD_SOURCE)\n+#if defined(_ALLBSD_SOURCE) && !defined(__APPLE__)\n+    \/\/ On _ALLBSD_SOURCE except __APPLE__ we consider EADDRNOTAVAIL\n+    \/\/ error to be OK and ignore it. __APPLE__ systems are excluded\n+    \/\/ in this check since for __APPLE__ systems, unlike other BSD systems,\n+    \/\/ we issue a \"disconnectx\" call (a few lines above),\n+    \/\/ which isn't expected to return this error code.\n","filename":"src\/java.base\/unix\/native\/libnio\/ch\/DatagramChannelImpl.c","additions":17,"deletions":9,"binary":false,"changes":26,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2019, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2019, 2022, Oracle and\/or its affiliates. All rights reserved.\n@@ -25,1 +25,1 @@\n- * @bug 8232673\n+ * @bug 8232673 8285515\n","filename":"test\/jdk\/java\/nio\/channels\/DatagramChannel\/AdaptorGetters.java","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2019, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2019, 2022, Oracle and\/or its affiliates. All rights reserved.\n@@ -25,1 +25,1 @@\n- * @bug 8231880 8231258\n+ * @bug 8231880 8231258 8285515\n","filename":"test\/jdk\/java\/nio\/channels\/DatagramChannel\/AfterDisconnect.java","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2020, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2020, 2022, Oracle and\/or its affiliates. All rights reserved.\n@@ -25,1 +25,1 @@\n- * @bug 6431343\n+ * @bug 6431343 8285515\n","filename":"test\/jdk\/java\/nio\/channels\/DatagramChannel\/ChangingAddress.java","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2012, 2017, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2012, 2022, Oracle and\/or its affiliates. All rights reserved.\n@@ -25,1 +25,1 @@\n- * @bug 7132924\n+ * @bug 7132924 8285515\n","filename":"test\/jdk\/java\/nio\/channels\/DatagramChannel\/Disconnect.java","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2010, 2011, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2010, 2022, Oracle and\/or its affiliates. All rights reserved.\n@@ -25,1 +25,1 @@\n- * @bug 6935563 7044870\n+ * @bug 6935563 7044870 8285515\n","filename":"test\/jdk\/java\/nio\/channels\/DatagramChannel\/SelectWhenRefused.java","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"}]}