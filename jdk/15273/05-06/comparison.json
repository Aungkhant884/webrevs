{"files":[{"patch":"@@ -1315,6 +1315,2 @@\n-            \/\/ Validate the Zip64 Extended Information Extra Field (0x0001)\n-            \/\/ length.\n-            if (!isZip64ExtBlockSizeValid(blockSize)) {\n-                zerror(\"Invalid CEN header (invalid zip64 extra data field size)\");\n-            }\n-            \/\/ if ZIP64_EXTID blocksize == 0, validate csize and size\n+            \/\/ if ZIP64_EXTID blocksize == 0 which may occur with some older\n+            \/\/ versions of Apache Ant and Commons Compress, validate csize and size\n@@ -1329,0 +1325,5 @@\n+            \/\/ Validate the Zip64 Extended Information Extra Field (0x0001)\n+            \/\/ length.\n+            if (!isZip64ExtBlockSizeValid(blockSize)) {\n+                zerror(\"Invalid CEN header (invalid zip64 extra data field size)\");\n+            }\n@@ -1364,1 +1365,0 @@\n-             *  0 - May be written out by Ant and Apache Commons Compress Library\n@@ -1372,1 +1372,1 @@\n-                case 0, 8, 16, 24, 28 -> true;\n+                case 8, 16, 24, 28 -> true;\n","filename":"src\/java.base\/share\/classes\/java\/util\/zip\/ZipFile.java","additions":8,"deletions":8,"binary":false,"changes":16,"status":"modified"},{"patch":"@@ -3095,6 +3095,3 @@\n-                    \/\/ Check to see if we have a valid block size\n-                    if (!isZip64ExtBlockSizeValid(sz)) {\n-                        throw new ZipException(\"Invalid CEN header (invalid zip64 extra data field size)\");\n-                    }\n-                    \/\/ if ZIP64_EXTID blocksize == 0, validate csize, size and\n-                    \/\/ locoff to make sure they do not == ZIP64_MINVAL\n+                    \/\/ if ZIP64_EXTID blocksize == 0 which may occur with some older\n+                    \/\/ versions of Apache Ant and Commons Compress, validate csize\n+                    \/\/ size, and locoff to make sure neither field == ZIP64_MAGICVAL\n@@ -3108,0 +3105,4 @@\n+                    \/\/ Check to see if we have a valid block size\n+                    if (!isZip64ExtBlockSizeValid(sz)) {\n+                        throw new ZipException(\"Invalid CEN header (invalid zip64 extra data field size)\");\n+                    }\n@@ -3208,1 +3209,0 @@\n-             *  0 - May be written out by Ant and Apache Commons Compress Library\n@@ -3216,1 +3216,1 @@\n-                case 0, 8, 16, 24, 28 -> true;\n+                case 8, 16, 24, 28 -> true;\n","filename":"src\/jdk.zipfs\/share\/classes\/jdk\/nio\/zipfs\/ZipFileSystem.java","additions":8,"deletions":8,"binary":false,"changes":16,"status":"modified"}]}