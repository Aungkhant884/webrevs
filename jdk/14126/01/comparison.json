{"files":[{"patch":"@@ -31,0 +31,1 @@\n+import jdk.internal.foreign.Utils;\n@@ -195,0 +196,1 @@\n+            if (Utils.containsNullChars(name)) return Optional.empty();\n@@ -232,0 +234,3 @@\n+        if (Utils.containsNullChars(name)) {\n+            throw new IllegalArgumentException(\"Cannot open library: \" + name);\n+        }\n@@ -282,0 +287,1 @@\n+            if (Utils.containsNullChars(name)) return Optional.empty();\n","filename":"src\/java.base\/share\/classes\/java\/lang\/foreign\/SymbolLookup.java","additions":6,"deletions":0,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -98,0 +98,1 @@\n+                if (Utils.containsNullChars(name)) return Optional.empty();\n@@ -109,0 +110,1 @@\n+            if (Utils.containsNullChars(name)) return Optional.empty();\n","filename":"src\/java.base\/share\/classes\/jdk\/internal\/foreign\/SystemLookup.java","additions":2,"deletions":0,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -254,0 +254,4 @@\n+\n+    public static boolean containsNullChars(String s) {\n+        return s.indexOf('\\u0000') >= 0;\n+    }\n","filename":"src\/java.base\/share\/classes\/jdk\/internal\/foreign\/Utils.java","additions":4,"deletions":0,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -70,0 +70,15 @@\n+    @Test(expectedExceptions = IllegalArgumentException.class)\n+    void testLoadLibraryBadName() {\n+        try (Arena arena = Arena.ofConfined()) {\n+            SymbolLookup.libraryLookup(LIB_PATH.toString() + \"\\u0000\", arena);\n+        }\n+    }\n+\n+    @Test\n+    void testLoadLibraryBadLookupName() {\n+        try (Arena arena = Arena.ofConfined()) {\n+            SymbolLookup lookup = SymbolLookup.libraryLookup(LIB_PATH, arena);\n+            assertTrue(lookup.find(\"inc\\u0000foobar\").isEmpty());\n+        }\n+    }\n+\n","filename":"test\/jdk\/java\/foreign\/LibraryLookupTest.java","additions":15,"deletions":0,"binary":false,"changes":15,"status":"modified"},{"patch":"@@ -137,0 +137,5 @@\n+    @Test\n+    void testSystemLibraryBadLookupName() {\n+        assertTrue(LINKER.defaultLookup().find(\"strlen\\u0000foobar\").isEmpty());\n+    }\n+\n","filename":"test\/jdk\/java\/foreign\/StdLibTest.java","additions":5,"deletions":0,"binary":false,"changes":5,"status":"modified"},{"patch":"@@ -31,0 +31,1 @@\n+import java.lang.foreign.Arena;\n@@ -63,0 +64,5 @@\n+\n+    @Test\n+    void testLoadLibraryBadLookupName() {\n+        assertTrue(SymbolLookup.loaderLookup().find(\"f\\u0000foobar\").isEmpty());\n+    }\n","filename":"test\/jdk\/java\/foreign\/TestClassLoaderFindNative.java","additions":6,"deletions":0,"binary":false,"changes":6,"status":"modified"}]}