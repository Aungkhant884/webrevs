{"files":[{"patch":"@@ -80,0 +80,19 @@\n+    private void checkBounds(int size, int l, int r, int len) {\n+        if (l >= size)      throw new IllegalStateException(\"l is out of bounds\");\n+        if (l + len > size) throw new IllegalStateException(\"l+len is out of bounds\");\n+        if (r >= size)      throw new IllegalStateException(\"r is out of bounds\");\n+        if (r + len > size) throw new IllegalStateException(\"r+len is out of bounds: \" + l + \" \" + r + \" \" + len + \" \" + size);\n+    }\n+\n+    private void checkDisjoint(int size, int l, int r, int len) {\n+        if (l == r)               throw new IllegalStateException(\"Not disjoint: l == r\");\n+        if (l < r && l + len > r) throw new IllegalStateException(\"Not disjoint\");\n+        if (l > r && r + len > l) throw new IllegalStateException(\"Not disjoint\");\n+    }\n+\n+    private void checkConjoint(int size, int l, int r, int len) {\n+        if (l == r) return; \/\/ Definitely conjoint, even with zero len\n+        if (l < r && l + len < r) throw new IllegalStateException(\"Not conjoint\");\n+        if (l > r && r + len < l) throw new IllegalStateException(\"Not conjoint\");\n+    }\n+\n@@ -85,0 +104,1 @@\n+                    checkBounds(size, l, r, len);\n@@ -100,1 +120,1 @@\n-            int r = (l + len) + rand.nextInt(size - 2*len - l);\n+            int r = (l + len + 1) + rand.nextInt(size - 2*len - l - 1);\n@@ -102,5 +122,2 @@\n-            if (l >= size)      throw new IllegalStateException(\"l is out of bounds\");\n-            if (l + len > size) throw new IllegalStateException(\"l+len is out of bounds\");\n-            if (r >= size)      throw new IllegalStateException(\"r is out of bounds\");\n-            if (r + len > size) throw new IllegalStateException(\"r+len is out of bounds: \" + l + \" \" + r + \" \" + len + \" \" + size);\n-            if (l + len > r)    throw new IllegalStateException(\"Not disjoint\");\n+            checkBounds(size, l, r, len);\n+            checkDisjoint(size, l, r, len);\n@@ -118,5 +135,2 @@\n-            if (l >= size)      throw new IllegalStateException(\"l is out of bounds\");\n-            if (l + len > size) throw new IllegalStateException(\"l+len is out of bounds\");\n-            if (r >= size)      throw new IllegalStateException(\"r is out of bounds\");\n-            if (r + len > size) throw new IllegalStateException(\"r+len is out of bounds: \" + l + \" \" + r + \" \" + len + \" \" + size);\n-            if (l + len < r)    throw new IllegalStateException(\"Not conjoint\");\n+            checkBounds(size, l, r, len);\n+            checkConjoint(size, l, r, len);\n","filename":"test\/hotspot\/jtreg\/compiler\/arraycopy\/stress\/AbstractStressArrayCopy.java","additions":25,"deletions":11,"binary":false,"changes":36,"status":"modified"}]}