{"files":[{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2015, 2018, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2015, 2023, Oracle and\/or its affiliates. All rights reserved.\n@@ -25,1 +25,1 @@\n- * @test\n+ * @test id=MD2withRSA\n@@ -30,1 +30,41 @@\n- * @run main SignedObjectChain\n+ * @run main\/othervm -DSigAlg=MD2withRSA SignedObjectChain\n+ * @summary Verify a chain of signed objects\n+ *\/\n+\n+\/*\n+ * @test id=MD5withRSA\n+ * @bug 8050374 8146293\n+ * @library \/test\/lib\n+ * @build jdk.test.lib.SigTestUtil\n+ * @compile ..\/..\/..\/java\/security\/SignedObject\/Chain.java\n+ * @run main\/othervm -DSigAlg=MD5withRSA SignedObjectChain\n+ * @summary Verify a chain of signed objects\n+ *\/\n+\n+\/*\n+ * @test id=SHA1withRSA\n+ * @bug 8050374 8146293\n+ * @library \/test\/lib\n+ * @build jdk.test.lib.SigTestUtil\n+ * @compile ..\/..\/..\/java\/security\/SignedObject\/Chain.java\n+ * @run main\/othervm -DSigAlg=SHA1withRSA SignedObjectChain\n+ * @summary Verify a chain of signed objects\n+ *\/\n+\n+\/*\n+ * @test id=SHA224withRSA\n+ * @bug 8050374 8146293\n+ * @library \/test\/lib\n+ * @build jdk.test.lib.SigTestUtil\n+ * @compile ..\/..\/..\/java\/security\/SignedObject\/Chain.java\n+ * @run main\/othervm -DSigAlg=SHA224withRSA SignedObjectChain\n+ * @summary Verify a chain of signed objects\n+ *\/\n+\n+\/*\n+ * @test id=SHA256withRSA\n+ * @bug 8050374 8146293\n+ * @library \/test\/lib\n+ * @build jdk.test.lib.SigTestUtil\n+ * @compile ..\/..\/..\/java\/security\/SignedObject\/Chain.java\n+ * @run main\/othervm -DSigAlg=SHA256withRSA SignedObjectChain\n@@ -33,1 +73,0 @@\n-public class SignedObjectChain {\n@@ -35,0 +74,40 @@\n+\/*\n+ * @test id=SHA384withRSA\n+ * @bug 8050374 8146293\n+ * @library \/test\/lib\n+ * @build jdk.test.lib.SigTestUtil\n+ * @compile ..\/..\/..\/java\/security\/SignedObject\/Chain.java\n+ * @run main\/othervm -DSigAlg=SHA384withRSA SignedObjectChain\n+ * @summary Verify a chain of signed objects\n+ *\/\n+\n+\/*\n+ * @test id=SHA512withRSA\n+ * @bug 8050374 8146293\n+ * @library \/test\/lib\n+ * @build jdk.test.lib.SigTestUtil\n+ * @compile ..\/..\/..\/java\/security\/SignedObject\/Chain.java\n+ * @run main\/othervm -DSigAlg=SHA512withRSA SignedObjectChain\n+ * @summary Verify a chain of signed objects\n+ *\/\n+\n+\/*\n+ * @test id=SHA512_224withRSA\n+ * @bug 8050374 8146293\n+ * @library \/test\/lib\n+ * @build jdk.test.lib.SigTestUtil\n+ * @compile ..\/..\/..\/java\/security\/SignedObject\/Chain.java\n+ * @run main\/othervm -DSigAlg=SHA512_224withRSA SignedObjectChain\n+ * @summary Verify a chain of signed objects\n+ *\/\n+\n+\/*\n+ * @test id=SHA512_256withRSA\n+ * @bug 8050374 8146293\n+ * @library \/test\/lib\n+ * @build jdk.test.lib.SigTestUtil\n+ * @compile ..\/..\/..\/java\/security\/SignedObject\/Chain.java\n+ * @run main\/othervm -DSigAlg=SHA512_256withRSA SignedObjectChain\n+ * @summary Verify a chain of signed objects\n+ *\/\n+public class SignedObjectChain {\n@@ -42,11 +121,0 @@\n-    private static final Test[] tests = {\n-        new Test(Chain.SigAlg.MD2withRSA),\n-        new Test(Chain.SigAlg.MD5withRSA),\n-        new Test(Chain.SigAlg.SHA1withRSA),\n-        new Test(Chain.SigAlg.SHA224withRSA),\n-        new Test(Chain.SigAlg.SHA256withRSA),\n-        new Test(Chain.SigAlg.SHA384withRSA),\n-        new Test(Chain.SigAlg.SHA512withRSA),\n-        new Test(Chain.SigAlg.SHA512_224withRSA),\n-        new Test(Chain.SigAlg.SHA512_256withRSA),\n-    };\n@@ -55,2 +123,1 @@\n-        boolean resutl = java.util.Arrays.stream(tests).allMatch(\n-                (test) -> Chain.runTest(test));\n+        boolean resutl = Chain.runTest(new Test(Chain.SigAlg.valueOf(System.getProperty(\"SigAlg\"))));\n","filename":"test\/jdk\/sun\/security\/rsa\/SignedObjectChain.java","additions":84,"deletions":17,"binary":false,"changes":101,"status":"modified"}]}