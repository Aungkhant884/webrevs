{"files":[{"patch":"@@ -381,1 +381,1 @@\n-        if (!clazz.isInstance(value)) {\n+        if (clazz == null || !clazz.isInstance(value)) {\n@@ -387,1 +387,1 @@\n-                           clazz.toString());\n+                           clazz);\n@@ -600,1 +600,1 @@\n-            throw new IOException(\"PKCS9 extended-certificate \" +\n+            throw new IllegalArgumentException(\"PKCS9 extended-certificate \" +\n@@ -604,1 +604,1 @@\n-            throw new IOException(\"PKCS9 IssuerAndSerialNumber \" +\n+            throw new IllegalArgumentException(\"PKCS9 IssuerAndSerialNumber \" +\n@@ -609,1 +609,1 @@\n-            throw new IOException(\"PKCS9 RSA DSI attributes \" +\n+            throw new IllegalArgumentException(\"PKCS9 RSA DSI attributes \" +\n@@ -613,1 +613,1 @@\n-            throw new IOException(\"PKCS9 attribute #13 not supported.\");\n+            throw new IllegalArgumentException(\"PKCS9 attribute #13 not supported.\");\n@@ -625,1 +625,1 @@\n-            throw new IOException(\"PKCS9 attribute #15 not supported.\");\n+            throw new IllegalArgumentException(\"PKCS9 attribute #15 not supported.\");\n@@ -629,4 +629,7 @@\n-            throw new IOException(\n-                \"PKCS9 SigningCertificate attribute not supported.\");\n-            \/\/ break unnecessary\n-\n+            {\n+                DerOutputStream temp2 = new DerOutputStream();\n+                SigningCertificateInfo info = (SigningCertificateInfo)value;\n+                temp2.writeBytes(info.toByteArray());\n+                temp.write(DerValue.tag_Set, temp2.toByteArray());\n+            }\n+            break;\n","filename":"src\/java.base\/share\/classes\/sun\/security\/pkcs\/PKCS9Attribute.java","additions":14,"deletions":11,"binary":false,"changes":25,"status":"modified"},{"patch":"@@ -84,0 +84,1 @@\n+    private byte[] ber;\n@@ -88,0 +89,5 @@\n+        this.ber = ber;\n+    }\n+\n+    public byte[] toByteArray() {\n+        return ber;\n","filename":"src\/java.base\/share\/classes\/sun\/security\/pkcs\/SigningCertificateInfo.java","additions":6,"deletions":0,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2020, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2020, 2022, Oracle and\/or its affiliates. All rights reserved.\n@@ -26,1 +26,1 @@\n- * @bug 8239950\n+ * @bug 8239950 8296736\n@@ -36,0 +36,1 @@\n+import sun.security.util.DerOutputStream;\n@@ -126,0 +127,3 @@\n+\n+                put(\"SigningCertificateInfo\",\n+                    \"3018060b2a864886f70d010910020c3109300730053003040100\");\n@@ -169,0 +173,5 @@\n+\n+                \/\/ Encoding is supported\n+                DerOutputStream dos = new DerOutputStream();\n+                p9Attr.encode(dos);\n+\n","filename":"test\/jdk\/sun\/security\/pkcs\/pkcs9\/PKCS9AttrTypeTests.java","additions":11,"deletions":2,"binary":false,"changes":13,"status":"modified"}]}