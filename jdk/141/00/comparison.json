{"files":[{"patch":"@@ -190,1 +190,0 @@\n-            Log.verbose(\"Using key '\" + matchedKey + \"'\");\n","filename":"src\/jdk.incubator.jpackage\/macosx\/classes\/jdk\/incubator\/jpackage\/internal\/MacBaseInstallerBundler.java","additions":0,"deletions":1,"binary":false,"changes":1,"status":"modified"},{"patch":"@@ -85,3 +85,0 @@\n-                    Log.verbose(MessageFormat.format(\n-                            I18N.getString(\"message.running-script\"),\n-                            configScript.toAbsolutePath().toString()));\n","filename":"src\/jdk.incubator.jpackage\/macosx\/classes\/jdk\/incubator\/jpackage\/internal\/MacDmgBundler.java","additions":0,"deletions":3,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -145,3 +145,0 @@\n-                    Log.verbose(MessageFormat.format(I18N.getString(\n-                            \"message.running-script\"),\n-                            configScript.toAbsolutePath().toString()));\n","filename":"src\/jdk.incubator.jpackage\/macosx\/classes\/jdk\/incubator\/jpackage\/internal\/MacPkgBundler.java","additions":0,"deletions":3,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -78,0 +78,5 @@\n+    Executor setQuiet(boolean v) {\n+        quietCommand = v;\n+        return this;\n+    }\n+\n@@ -87,1 +92,1 @@\n-                            createLogMessage(pb), ret));\n+                            createLogMessage(pb, false), ret));\n@@ -111,1 +116,1 @@\n-        Log.verbose(String.format(\"Running %s\", createLogMessage(pb)));\n+        Log.verbose(String.format(\"Running %s\", createLogMessage(pb, true)));\n@@ -129,1 +134,1 @@\n-                savedOutput = Files.readAllLines(outputFile);\n+                output = savedOutput = Files.readAllLines(outputFile);\n@@ -137,5 +142,0 @@\n-\n-                if (Log.isVerbose()) {\n-                    outputStream.get().forEach(Log::verbose);\n-                }\n-\n@@ -148,3 +148,3 @@\n-                    \/\/ Need to save output if explicitely requested (saveOutput=true) or\n-                    \/\/ if will be used used by multiple consumers\n-                    if ((outputConsumer != null && Log.isVerbose()) || saveOutput) {\n+\n+                    if ((outputConsumer != null || Log.isVerbose())\n+                            || saveOutput) {\n@@ -152,3 +152,0 @@\n-                        if (saveOutput) {\n-                            output = savedOutput;\n-                        }\n@@ -158,0 +155,1 @@\n+                    output = savedOutput;\n@@ -165,5 +163,0 @@\n-\n-                    if (Log.isVerbose()) {\n-                        outputStream.get().forEach(Log::verbose);\n-                    }\n-\n@@ -191,0 +184,3 @@\n+            if (!quietCommand) {\n+                Log.verbose(pb.command(), getOutput(), code);\n+            }\n@@ -206,1 +202,1 @@\n-                            createLogMessage(pb), timeout));\n+                            createLogMessage(pb, false), timeout));\n@@ -221,1 +217,1 @@\n-    private static String createLogMessage(ProcessBuilder pb) {\n+    private static String createLogMessage(ProcessBuilder pb, boolean quiet) {\n@@ -223,1 +219,1 @@\n-        sb.append(String.format(\"%s\", pb.command()));\n+        sb.append((quiet) ? pb.command().get(0) : pb.command());\n@@ -235,0 +231,1 @@\n+    private boolean quietCommand;\n","filename":"src\/jdk.incubator.jpackage\/share\/classes\/jdk\/incubator\/jpackage\/internal\/Executor.java","additions":19,"deletions":22,"binary":false,"changes":41,"status":"modified"},{"patch":"@@ -231,0 +231,1 @@\n+        Log.verbose(pb.command(), list, ret);\n","filename":"src\/jdk.incubator.jpackage\/share\/classes\/jdk\/incubator\/jpackage\/internal\/IOUtils.java","additions":1,"deletions":0,"binary":false,"changes":1,"status":"modified"},{"patch":"@@ -191,1 +191,0 @@\n-        Log.verbose(\"jlink arguments: \" + args);\n@@ -195,0 +194,4 @@\n+        args.add(0, \"jlink\");\n+        Log.verbose(args, List.of(jlinkOut), retVal);\n+\n+\n@@ -198,2 +201,0 @@\n-\n-        Log.verbose(\"jlink output: \" + jlinkOut);\n","filename":"src\/jdk.incubator.jpackage\/share\/classes\/jdk\/incubator\/jpackage\/internal\/JLinkBundlerHelper.java","additions":4,"deletions":3,"binary":false,"changes":7,"status":"modified"},{"patch":"@@ -31,0 +31,1 @@\n+import java.util.List;\n@@ -118,0 +119,19 @@\n+        public void verbose(List<String> strings,\n+                List<String> output, int returnCode) {\n+            if (verbose) {\n+                StringBuffer sb = new StringBuffer(\"Command:\\n   \");\n+                for (String s : strings) {\n+                    sb.append(\" \" + s);\n+                }\n+                verbose(new String(sb));\n+                if (output != null && !output.isEmpty()) {\n+                    sb = new StringBuffer(\"Output:\");\n+                    for (String s : output) {\n+                        sb.append(\"\\n    \" + s);\n+                    }\n+                    verbose(new String(sb));\n+                }\n+                verbose(\"Returned: \" + returnCode + \"\\n\");\n+            }\n+        }\n+\n@@ -176,0 +196,7 @@\n+\n+    public static void verbose(List<String> strings, List<String> out, int ret) {\n+        if (delegate != null) {\n+           delegate.verbose(strings, out, ret);\n+        }\n+    }\n+\n","filename":"src\/jdk.incubator.jpackage\/share\/classes\/jdk\/incubator\/jpackage\/internal\/Log.java","additions":27,"deletions":0,"binary":false,"changes":27,"status":"modified"},{"patch":"@@ -97,1 +97,1 @@\n-            Executor.of(pb).setOutputConsumer(lines -> {\n+            Executor.of(pb).setQuiet(true).setOutputConsumer(lines -> {\n","filename":"src\/jdk.incubator.jpackage\/share\/classes\/jdk\/incubator\/jpackage\/internal\/ToolValidator.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -98,3 +98,1 @@\n-                .filter(s -> s.contains(\"Running\"))\n-                .filter(s -> s.contains(\"light.exe\"))\n-                .filter(s -> !s.contains(\"\/?\"));\n+                .filter(s -> s.trim().startsWith(\"light.exe\"));\n","filename":"test\/jdk\/tools\/jpackage\/windows\/WinL10nTest.java","additions":1,"deletions":3,"binary":false,"changes":4,"status":"modified"}]}