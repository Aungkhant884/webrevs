{"files":[{"patch":"@@ -57,1 +57,1 @@\n-     * cleanup, which happens by calling cleanup(), or is done by the Cleaner.\n+     * cleanup.\n@@ -59,1 +59,1 @@\n-    private static class CleaningAction implements Runnable {\n+    private static class EnumCtx implements Runnable {\n@@ -64,1 +64,1 @@\n-        private CleaningAction(LdapCtx homeCtx, LdapResult answer, LdapClient client) {\n+        private EnumCtx(LdapCtx homeCtx, LdapResult answer, LdapClient client) {\n@@ -73,0 +73,1 @@\n+                assert homeCtx != null;\n@@ -83,2 +84,2 @@\n-    private CleaningAction state;\n-    private Cleanable cleanable;\n+    private final EnumCtx enumCtx;\n+    private final Cleanable cleanable;\n@@ -88,1 +89,1 @@\n-    protected final LdapCtx homeCtx() { return state.homeCtx; }\n+    protected final LdapCtx homeCtx() { return enumCtx.homeCtx; }\n@@ -130,1 +131,1 @@\n-            this.state = new CleaningAction(homeCtx, answer, homeCtx.clnt);\n+            this.enumCtx = new EnumCtx(homeCtx, answer, homeCtx.clnt);\n@@ -132,2 +133,2 @@\n-            this.state.homeCtx.incEnumCount();\n-            this.cleanable = CleanerFactory.cleaner().register(this, state);\n+            this.enumCtx.homeCtx.incEnumCount();\n+            this.cleanable = CleanerFactory.cleaner().register(this, enumCtx);\n@@ -163,2 +164,2 @@\n-        state.res = state.homeCtx.getSearchReply(state.enumClnt, state.res);\n-        if (state.res == null) {\n+        enumCtx.res = homeCtx().getSearchReply(enumCtx.enumClnt, enumCtx.res);\n+        if (enumCtx.res == null) {\n@@ -169,1 +170,1 @@\n-        entries = state.res.entries;\n+        entries = enumCtx.res.entries;\n@@ -175,3 +176,3 @@\n-        if ((state.res.status != LdapClient.LDAP_SUCCESS) ||\n-            ((state.res.status == LdapClient.LDAP_SUCCESS) &&\n-                (state.res.referrals != null))) {\n+        if ((enumCtx.res.status != LdapClient.LDAP_SUCCESS) ||\n+            ((enumCtx.res.status == LdapClient.LDAP_SUCCESS) &&\n+                (enumCtx.res.referrals != null))) {\n@@ -181,1 +182,1 @@\n-                state.homeCtx.processReturnCode(state.res, listArg);\n+                homeCtx().processReturnCode(enumCtx.res, listArg);\n@@ -190,1 +191,1 @@\n-        if (state.res.refEx != null) {\n+        if (enumCtx.res.refEx != null) {\n@@ -192,1 +193,1 @@\n-                refEx = state.res.refEx;\n+                refEx = enumCtx.res.refEx;\n@@ -194,1 +195,1 @@\n-                refEx = refEx.appendUnprocessedReferrals(state.res.refEx);\n+                refEx = refEx.appendUnprocessedReferrals(enumCtx.res.refEx);\n@@ -196,1 +197,1 @@\n-            state.res.refEx = null; \/\/ reset\n+            enumCtx.res.refEx = null; \/\/ reset\n@@ -199,2 +200,2 @@\n-        if (state.res.resControls != null) {\n-            state.homeCtx.respCtls = state.res.resControls;\n+        if (enumCtx.res.resControls != null) {\n+            homeCtx().respCtls = enumCtx.res.resControls;\n@@ -351,1 +352,1 @@\n-            if (state.homeCtx.handleReferrals == LdapClient.LDAP_REF_THROW) {\n+            if (homeCtx().handleReferrals == LdapClient.LDAP_REF_THROW) {\n@@ -360,1 +361,1 @@\n-                    state.homeCtx.envprops, state.homeCtx.reqCtls);\n+                    homeCtx().envprops, homeCtx().reqCtls);\n@@ -399,1 +400,1 @@\n-        state.homeCtx.decEnumCount();\n+        homeCtx().decEnumCount();\n@@ -402,2 +403,2 @@\n-        state.homeCtx = ne.state.homeCtx;\n-        state.enumClnt = ne.state.enumClnt;\n+        enumCtx.homeCtx = ne.enumCtx.homeCtx;\n+        enumCtx.enumClnt = ne.enumCtx.enumClnt;\n@@ -409,1 +410,1 @@\n-        ne.state.homeCtx = null;\n+        ne.enumCtx.homeCtx = null;\n@@ -414,1 +415,1 @@\n-        state.res = ne.state.res;\n+        enumCtx.res = ne.enumCtx.res;\n","filename":"src\/java.naming\/share\/classes\/com\/sun\/jndi\/ldap\/AbstractLdapNamingEnumeration.java","additions":30,"deletions":29,"binary":false,"changes":59,"status":"modified"}]}