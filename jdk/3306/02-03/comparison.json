{"files":[{"patch":"@@ -1881,1 +1881,0 @@\n-\n@@ -1883,1 +1882,0 @@\n-        MethodHandle storeFunc = ArrayAccessor.getAccessor(arrayType, ArrayAccess.SET);\n@@ -1885,1 +1883,1 @@\n-        LambdaForm form = makeCollectorForm(type.basicType(), storeFunc);\n+        LambdaForm form = makeCollectorForm(type.basicType(), arrayType);\n@@ -1898,1 +1896,1 @@\n-    private static LambdaForm makeCollectorForm(MethodType basicType, MethodHandle storeFunc) {\n+    private static LambdaForm makeCollectorForm(MethodType basicType, Class<?> arrayType) {\n@@ -1907,1 +1905,2 @@\n-        boolean isSharedLambdaForm = parameterCount == 0 || basicType.parameterType(0) == Object.class;\n+        boolean isReferenceType = !arrayType.componentType().isPrimitive();\n+        boolean isSharedLambdaForm = parameterCount == 0 || isReferenceType;\n@@ -1915,0 +1914,5 @@\n+        \/\/ use erased accessor for reference types\n+        MethodHandle storeFunc = isReferenceType\n+                ? ArrayAccessor.OBJECT_ARRAY_SETTER\n+                : makeArrayElementAccessor(arrayType, ArrayAccess.SET);\n+\n","filename":"src\/java.base\/share\/classes\/java\/lang\/invoke\/MethodHandleImpl.java","additions":9,"deletions":5,"binary":false,"changes":14,"status":"modified"}]}