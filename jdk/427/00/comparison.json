{"files":[{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 1999, 2019, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 1999, 2020, Oracle and\/or its affiliates. All rights reserved.\n@@ -40,1 +40,1 @@\n-    FULL_MEM_BARRIER;\n+    OrderAccess::fence();\n@@ -57,1 +57,1 @@\n-  FULL_MEM_BARRIER;\n+  OrderAccess::fence();\n@@ -76,1 +76,1 @@\n-    FULL_MEM_BARRIER;\n+    OrderAccess::fence();\n@@ -79,1 +79,1 @@\n-    FULL_MEM_BARRIER;\n+    OrderAccess::fence();\n","filename":"src\/hotspot\/os_cpu\/linux_aarch64\/atomic_linux_aarch64.hpp","additions":5,"deletions":5,"binary":false,"changes":10,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2003, 2019, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2003, 2020, Oracle and\/or its affiliates. All rights reserved.\n@@ -33,0 +33,2 @@\n+#define inlasm_dmb(opt) asm volatile(\"dmb \" #opt : : : \"memory\")\n+\n@@ -35,4 +37,11 @@\n-inline void OrderAccess::loadload()   { acquire(); }\n-inline void OrderAccess::storestore() { release(); }\n-inline void OrderAccess::loadstore()  { acquire(); }\n-inline void OrderAccess::storeload()  { fence(); }\n+inline void OrderAccess::loadload() {\n+  inlasm_dmb(ishld);\n+}\n+\n+inline void OrderAccess::storestore() {\n+  inlasm_dmb(ishst);\n+}\n+\n+inline void OrderAccess::loadstore() {\n+  inlasm_dmb(ishld);\n+}\n@@ -40,3 +49,3 @@\n-#define FULL_MEM_BARRIER  __sync_synchronize()\n-#define READ_MEM_BARRIER  __atomic_thread_fence(__ATOMIC_ACQUIRE);\n-#define WRITE_MEM_BARRIER __atomic_thread_fence(__ATOMIC_RELEASE);\n+inline void OrderAccess::storeload() {\n+  inlasm_dmb(ish);\n+}\n@@ -45,1 +54,1 @@\n-  READ_MEM_BARRIER;\n+  inlasm_dmb(ishld);\n@@ -49,1 +58,1 @@\n-  WRITE_MEM_BARRIER;\n+  inlasm_dmb(ish);\n@@ -53,1 +62,1 @@\n-  FULL_MEM_BARRIER;\n+  inlasm_dmb(ish);\n@@ -58,0 +67,2 @@\n+#undef inlasm_dmb\n+\n","filename":"src\/hotspot\/os_cpu\/linux_aarch64\/orderAccess_linux_aarch64.hpp","additions":22,"deletions":11,"binary":false,"changes":33,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2003, 2019, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2003, 2020, Oracle and\/or its affiliates. All rights reserved.\n@@ -123,3 +123,3 @@\n-\/\/                       Constraint     x86          sparc TSO          ppc\n-\/\/ ---------------------------------------------------------------------------\n-\/\/ fence                 LoadStore  |   lock         membar #StoreLoad  sync\n+\/\/                       Constraint     x86          sparc TSO          ppc      AArch64\n+\/\/ ---------------------------------------------------------------------------------------\n+\/\/ fence                 LoadStore  |   lock         membar #StoreLoad  sync     dmb ish\n@@ -130,1 +130,1 @@\n-\/\/ release               LoadStore  |                                   lwsync\n+\/\/ release               LoadStore  |                                   lwsync   dmb ish\n@@ -133,1 +133,1 @@\n-\/\/ acquire               LoadLoad   |                                   lwsync\n+\/\/ acquire               LoadLoad   |                                   lwsync   dmb ishld\n@@ -136,1 +136,1 @@\n-\/\/ release_store                        <store>      <store>            lwsync\n+\/\/ release_store                        <store>      <store>            lwsync   stlr\n@@ -139,2 +139,2 @@\n-\/\/ release_store_fence                  xchg         <store>            lwsync\n-\/\/                                                   membar #StoreLoad  <store>\n+\/\/ release_store_fence                  xchg         <store>            lwsync   stlr\n+\/\/                                                   membar #StoreLoad  <store>  dmb ish\n@@ -144,1 +144,1 @@\n-\/\/ load_acquire                         <load>       <load>             <load>\n+\/\/ load_acquire                         <load>       <load>             <load>   ldar\n","filename":"src\/hotspot\/share\/runtime\/orderAccess.hpp","additions":10,"deletions":10,"binary":false,"changes":20,"status":"modified"}]}