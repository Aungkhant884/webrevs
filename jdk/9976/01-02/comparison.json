{"files":[{"patch":"@@ -954,0 +954,1 @@\n+    assert(block->_pre_order == i, \"Block::pre_order does not match block index\");\n@@ -961,17 +962,8 @@\n-    for (uint i = 0; i < _number_of_blocks; i++) {\n-      Block* block = get_block(i);\n-      if (block == dead) {\n-        _blocks.remove(i);\n-        _number_of_blocks--;\n-        i--; \/\/ Ensure that we visit the block following the removed one.\n-        continue;\n-      }\n-      if (block->_pre_order > dead->_pre_order) {\n-        \/\/ When this code runs (after PhaseCFG::fixup_flow()), Block::_pre_order\n-        \/\/ does not contain pre-order indices but simple block list indices.\n-        \/\/ Ensure they stay contiguous.\n-        \/\/ Block::_rpo does not contain valid reverse post-order indices anymore\n-        \/\/ (they are invalidated by block insertions in PhaseCFG::fixup_flow()),\n-        \/\/ so there is no need to update them.\n-        block->_pre_order--;\n-      }\n+    \/\/ When this code runs (after PhaseCFG::fixup_flow()), Block::_pre_order\n+    \/\/ does not contain pre-order but block-list indices. Ensure they stay\n+    \/\/ contiguous by decrementing _pre_order for all elements after 'dead'.\n+    \/\/ Block::_rpo does not contain valid reverse post-order indices anymore\n+    \/\/ (they are invalidated by block insertions in PhaseCFG::fixup_flow()),\n+    \/\/ so there is no need to update them.\n+    for (uint i = dead->_pre_order + 1; i < number_of_blocks(); i++) {\n+      get_block(i)->_pre_order--;\n@@ -979,0 +971,2 @@\n+    _blocks.remove(dead->_pre_order);\n+    _number_of_blocks--;\n","filename":"src\/hotspot\/share\/opto\/block.cpp","additions":11,"deletions":17,"binary":false,"changes":28,"status":"modified"}]}