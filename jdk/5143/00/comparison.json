{"files":[{"patch":"@@ -113,0 +113,1 @@\n+  inline bool is_invalid(uint region_idx) const;\n","filename":"src\/hotspot\/share\/gc\/g1\/g1FullCollector.hpp","additions":1,"deletions":0,"binary":false,"changes":1,"status":"modified"},{"patch":"@@ -50,0 +50,4 @@\n+bool G1FullCollector::is_invalid(uint region_idx) const {\n+  return _region_attr_table.is_invalid(region_idx);\n+}\n+\n","filename":"src\/hotspot\/share\/gc\/g1\/g1FullCollector.inline.hpp","additions":4,"deletions":0,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -82,6 +82,9 @@\n-  G1CompactRegionClosure compact(collector()->mark_bitmap());\n-  hr->apply_to_marked_objects(collector()->mark_bitmap(), &compact);\n-  \/\/ Clear the liveness information for this region if necessary i.e. if we actually look at it\n-  \/\/ for bitmap verification. Otherwise it is sufficient that we move the TAMS to bottom().\n-  if (G1VerifyBitmaps) {\n-    collector()->mark_bitmap()->clear_region(hr);\n+\n+  if (!collector()->is_invalid(hr->hrm_index())) {\n+    G1CompactRegionClosure compact(collector()->mark_bitmap());\n+    hr->apply_to_marked_objects(collector()->mark_bitmap(), &compact);\n+    \/\/ Clear the liveness information for this region if necessary i.e. if we actually look at it\n+    \/\/ for bitmap verification. Otherwise it is sufficient that we move the TAMS to bottom().\n+    if (G1VerifyBitmaps) {\n+      collector()->mark_bitmap()->clear_region(hr);\n+    }\n@@ -89,0 +92,1 @@\n+\n","filename":"src\/hotspot\/share\/gc\/g1\/g1FullGCCompactTask.cpp","additions":10,"deletions":6,"binary":false,"changes":16,"status":"modified"},{"patch":"@@ -75,0 +75,4 @@\n+  bool is_invalid(uint idx) const {\n+    return get_by_index(idx) == Invalid;\n+  }\n+\n","filename":"src\/hotspot\/share\/gc\/g1\/g1FullGCHeapRegionAttr.hpp","additions":4,"deletions":0,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -50,1 +50,0 @@\n-  prepare_for_compaction(hr);\n@@ -52,0 +51,1 @@\n+  prepare_for_compaction(hr);\n@@ -185,1 +185,0 @@\n-  G1PrepareCompactLiveClosure prepare_compact(cp);\n@@ -187,1 +186,4 @@\n-  hr->apply_to_marked_objects(_bitmap, &prepare_compact);\n+  if (!_collector->is_invalid(hr->hrm_index())) {\n+    G1PrepareCompactLiveClosure prepare_compact(cp);\n+    hr->apply_to_marked_objects(_bitmap, &prepare_compact);\n+  }\n","filename":"src\/hotspot\/share\/gc\/g1\/g1FullGCPrepareTask.cpp","additions":5,"deletions":3,"binary":false,"changes":8,"status":"modified"}]}