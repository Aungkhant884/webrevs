{"files":[{"patch":"@@ -27,2 +27,1 @@\n- * @requires (sun.arch.data.model == \"64\")\n- * @run testng CenSizeTooLarge\n+ * @run junit CenSizeTooLarge\n@@ -31,2 +30,2 @@\n-import org.testng.annotations.BeforeTest;\n-import org.testng.annotations.Test;\n+import org.junit.Before;\n+import org.junit.Test;\n@@ -46,1 +45,2 @@\n-import static org.testng.Assert.*;\n+import static org.junit.jupiter.api.Assertions.assertEquals;\n+import static org.junit.jupiter.api.Assertions.assertThrows;\n@@ -52,2 +52,15 @@\n-    \/\/ Maximum size (unsigned short) of an extra field allowed by the standard\n-    static final int MAX_EXTRA_FIELD_SIZE = 0XFFFF;\n+    \/**\n+     * From the APPNOTE.txt specification:\n+     *    4.4.10 file name length: (2 bytes)\n+     *    4.4.11 extra field length: (2 bytes)\n+     *    4.4.12 file comment length: (2 bytes)\n+     *\n+     *        The length of the file name, extra field, and comment\n+     *        fields respectively.  The combined length of any\n+     *        directory record and these three fields SHOULD NOT\n+     *        generally exceed 65,535 bytes.\n+     *\n+     *  Since ZipOutputStream does not enforce the 'combined length' clause,\n+     *  we simply use 65,535 (0xFFFF) for the purpose of this test.\n+     *\/\n+    static final int MAX_EXTRA_FIELD_SIZE = 65_535;\n@@ -78,0 +91,3 @@\n+    \/\/ Expected ZipException message when the CEN does not fit in a Java byte array\n+    private static final String CEN_TOO_LARGE_MESSAGE = \"invalid END header (central directory size too large)\";\n+\n@@ -84,1 +100,1 @@\n-    @BeforeTest\n+    @Before\n@@ -138,2 +154,2 @@\n-        ZipException ex = expectThrows(ZipException.class, () -> new ZipFile(hugeZipFile));\n-        assertEquals(ex.getMessage(), \"invalid END header (central directory size too large)\");\n+        ZipException ex = assertThrows(ZipException.class, () -> new ZipFile(hugeZipFile));\n+        assertEquals(CEN_TOO_LARGE_MESSAGE, ex.getMessage());\n","filename":"test\/jdk\/java\/util\/zip\/ZipFile\/CenSizeTooLarge.java","additions":26,"deletions":10,"binary":false,"changes":36,"status":"modified"}]}