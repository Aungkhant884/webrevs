{"files":[{"patch":"@@ -72,1 +72,1 @@\n-    LIBS_macosx := -framework Foundation -framework JavaNativeFoundation \\\n+    LIBS_macosx := -framework Foundation \\\n","filename":"make\/modules\/jdk.hotspot.agent\/Lib.gmk","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -27,2 +27,0 @@\n-#import <JavaNativeFoundation\/JavaNativeFoundation.h>\n-#import <JavaRuntimeSupport\/JavaRuntimeSupport.h>\n@@ -263,0 +261,15 @@\n+static NSString* JavaStringToNSString(JNIEnv *env, jstring jstr) {\n+\n+    if (jstr == NULL) {\n+        return NULL;\n+    }\n+    jsize len = (*env)->GetStringLength(env, jstr);\n+    const jchar *chars = (*env)->GetStringChars(env, jstr, NULL);\n+    if (chars == NULL) {\n+        return NULL;\n+    }\n+    NSString *result = [NSString stringWithCharacters:(UniChar *)chars length:len];\n+    (*env)->ReleaseStringChars(env, jstr, chars);\n+    return result;\n+}\n+\n@@ -280,2 +293,4 @@\n-JNF_COCOA_ENTER(env);\n-  NSString *symbolNameString = JNFJavaToNSString(env, symbolName);\n+  NSAutoreleasePool *pool = [[NSAutoreleasePool alloc] init];\n+  @try {\n+\n+  NSString *symbolNameString = JavaStringToNSString(env, symbolName);\n@@ -292,1 +307,5 @@\n-JNF_COCOA_EXIT(env);\n+  } @catch (NSException *e) {\n+    NSLog(@\"%@\", [e callStackSymbols]);\n+  } @finally {\n+     [pool drain];\n+  }\n@@ -815,1 +834,2 @@\n-JNF_COCOA_ENTER(env);\n+  NSAutoreleasePool *pool = [[NSAutoreleasePool alloc] init];\n+  @try {\n@@ -929,1 +949,5 @@\n-JNF_COCOA_EXIT(env);\n+  } @catch (NSException *e) {\n+    NSLog(@\"%@\", [e callStackSymbols]);\n+  } @finally {\n+     [pool drain];\n+  }\n@@ -1023,1 +1047,3 @@\n-JNF_COCOA_ENTER(env);\n+\n+  NSAutoreleasePool *pool = [[NSAutoreleasePool alloc] init];\n+  @try {\n@@ -1074,1 +1100,5 @@\n-JNF_COCOA_EXIT(env);\n+  } @catch (NSException *e) {\n+    NSLog(@\"%@\", [e callStackSymbols]);\n+  } @finally {\n+     [pool drain];\n+  }\n","filename":"src\/jdk.hotspot.agent\/macosx\/native\/libsaproc\/MacosxDebuggerLocal.m","additions":39,"deletions":9,"binary":false,"changes":48,"status":"modified"}]}