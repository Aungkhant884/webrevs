{"files":[{"patch":"@@ -37,1 +37,0 @@\n-import javax.swing.text.JTextComponent;\n@@ -40,4 +39,0 @@\n-    private static volatile JTextField jTextField;\n-    private static volatile JTextArea jTextArea;\n-    private static volatile JEditorPane jEditorPane;\n-    private static volatile String actualAccessibleText;\n@@ -45,2 +40,6 @@\n-    public static void doTest() throws Exception {\n-        SwingUtilities.invokeAndWait(() -> createGUI());\n+    public static void doTest() {\n+        JTextField jTextField =\n+            new JTextField(\"Test1 Test2 Test3. Test4 Test5. Test6\");\n+        JTextArea jTextArea = new JTextArea(\"Test1 Test2 Test3.\\nTest4 Test5\");\n+        JEditorPane jEditorPane =\n+            new JEditorPane(\"text\/plain\", \"Test1 Test2 Test3.\\nTest4 Test5\");\n@@ -48,2 +47,3 @@\n-        if (!checkAccessibleText(jTextField, AccessibleText.CHARACTER, 5,\n-            \"T\")) {\n+        String actualAccessibleText = jTextField.getAccessibleContext()\n+            .getAccessibleText().getAfterIndex(AccessibleText.CHARACTER, 5);\n+        if (!(actualAccessibleText.equals(\"T\"))) {\n@@ -52,1 +52,1 @@\n-                    + \"expected: t, actual: \" + actualAccessibleText);\n+                    + \" expected:--T--, actual:--\" + actualAccessibleText + \"--\");\n@@ -54,1 +54,4 @@\n-        if (!checkAccessibleText(jTextField, AccessibleText.WORD, 5, \"Test2\")) {\n+\n+        actualAccessibleText = jTextField.getAccessibleContext()\n+            .getAccessibleText().getAfterIndex(AccessibleText.WORD, 5);\n+        if (!(actualAccessibleText.equals(\"Test2\"))) {\n@@ -57,1 +60,1 @@\n-                    + \"expected: Test2, actual: \" + actualAccessibleText);\n+                    + \" expected:--Test2--, actual:--\" + actualAccessibleText + \"--\");\n@@ -59,2 +62,4 @@\n-        if (!checkAccessibleText(jTextField, AccessibleText.SENTENCE, 5,\n-            \"Test4 Test5. \")) {\n+\n+        actualAccessibleText = jTextField.getAccessibleContext()\n+            .getAccessibleText().getAfterIndex(AccessibleText.SENTENCE, 5);\n+        if (!(actualAccessibleText.equals(\"Test4 Test5. \"))) {\n@@ -63,1 +68,1 @@\n-                + \"expected: Test4 Test5. , actual: \" + actualAccessibleText);\n+                + \" expected:--Test4 Test5. --, actual:--\" + actualAccessibleText + \"--\");\n@@ -65,1 +70,4 @@\n-        if (!checkAccessibleText(jTextArea, AccessibleText.CHARACTER, 5, \"T\")) {\n+\n+        actualAccessibleText = jTextArea.getAccessibleContext()\n+            .getAccessibleText().getAfterIndex(AccessibleText.CHARACTER, 5);\n+        if (!(actualAccessibleText.equals(\"T\"))) {\n@@ -68,1 +76,1 @@\n-                    + \"expected: T , actual: \" + actualAccessibleText);\n+                    + \" expected:--T--, actual:--\" + actualAccessibleText + \"--\");\n@@ -70,1 +78,4 @@\n-        if (!checkAccessibleText(jTextArea, AccessibleText.WORD, 5, \"Test2\")) {\n+\n+        actualAccessibleText = jTextArea.getAccessibleContext()\n+            .getAccessibleText().getAfterIndex(AccessibleText.WORD, 5);\n+        if (!(actualAccessibleText.equals(\"Test2\"))) {\n@@ -73,1 +84,1 @@\n-                    + \"expected: Test2 , actual: \" + actualAccessibleText);\n+                    + \" expected:--Test2--, actual:--\" + actualAccessibleText + \"--\");\n@@ -75,2 +86,4 @@\n-        if (!checkAccessibleText(jTextArea, AccessibleText.SENTENCE, 5,\n-            \"Test4 Test5\\n\")) {\n+\n+        actualAccessibleText = jTextArea.getAccessibleContext()\n+            .getAccessibleText().getAfterIndex(AccessibleText.SENTENCE, 5);\n+        if (!(actualAccessibleText.equals(\"Test4 Test5\\n\"))) {\n@@ -79,1 +92,1 @@\n-                + \"expected: Test4 Test5\\n, actual: \" + actualAccessibleText);\n+                + \" expected:--Test4 Test5\\n--, actual:--\" + actualAccessibleText + \"--\");\n@@ -81,2 +94,4 @@\n-        if (!checkAccessibleText(jEditorPane, AccessibleText.CHARACTER, 5,\n-            \"T\")) {\n+\n+        actualAccessibleText = jEditorPane.getAccessibleContext()\n+            .getAccessibleText().getAfterIndex(AccessibleText.CHARACTER, 5);\n+        if (!(actualAccessibleText.equals(\"T\"))) {\n@@ -84,2 +99,2 @@\n-                \"JTextArea - \" + \"getAfterIndex() CHARACTER parameter\"\n-                    + \"expected: T, actual: \" + actualAccessibleText);\n+                \"JEditorPane - \" + \"getAfterIndex() CHARACTER parameter\"\n+                    + \" expected:--T--, actual:--\" + actualAccessibleText +\"--\");\n@@ -87,2 +102,4 @@\n-        if (!checkAccessibleText(jEditorPane, AccessibleText.WORD, 5,\n-            \"Test2\")) {\n+\n+        actualAccessibleText = jEditorPane.getAccessibleContext()\n+            .getAccessibleText().getAfterIndex(AccessibleText.WORD, 5);\n+        if (!(actualAccessibleText.equals(\"Test2\"))) {\n@@ -91,1 +108,1 @@\n-                    + \"expected: Test2, actual: \" + actualAccessibleText);\n+                    + \" expected:--Test2--, actual:--\" + actualAccessibleText + \"--\");\n@@ -93,2 +110,4 @@\n-        if (!checkAccessibleText(jEditorPane, AccessibleText.SENTENCE, 5,\n-            \"Test4 Test5\\n\")) {\n+\n+        actualAccessibleText = jEditorPane.getAccessibleContext()\n+            .getAccessibleText().getAfterIndex(AccessibleText.SENTENCE, 5);\n+        if (!(actualAccessibleText.equals(\"Test4 Test5\\n\"))) {\n@@ -97,1 +116,1 @@\n-                + \"expected: Test4 Test5\\n, actual: \" + actualAccessibleText);\n+                + \" expected:--Test4 Test5\\n--, actual:--\" + actualAccessibleText +\"--\");\n@@ -101,17 +120,0 @@\n-    private static void createGUI() {\n-        jTextField = new JTextField(\"Test1 Test2 Test3. Test4 Test5. Test6\");\n-        jTextArea = new JTextArea(\"Test1 Test2 Test3.\\nTest4 Test5\");\n-        jEditorPane =\n-            new JEditorPane(\"text\/plain\", \"Test1 Test2 Test3.\\nTest4 Test5\");\n-    }\n-\n-    private static boolean checkAccessibleText(JTextComponent jTextComponent,\n-        int character, int characterPosition, String expectedString)\n-            throws Exception {\n-        SwingUtilities.invokeAndWait(() -> actualAccessibleText =\n-            jTextComponent.getAccessibleContext().getAccessibleText()\n-            .getAfterIndex(character, characterPosition));\n-\n-        return actualAccessibleText.equals(expectedString);\n-    }\n-\n@@ -119,1 +121,1 @@\n-        doTest();\n+        SwingUtilities.invokeAndWait(() -> doTest());\n","filename":"test\/jdk\/javax\/accessibility\/4170173\/AccessibleJTextAfterIndexTest.java","additions":52,"deletions":50,"binary":false,"changes":102,"status":"modified"},{"patch":"@@ -37,1 +37,0 @@\n-import javax.swing.text.JTextComponent;\n@@ -40,4 +39,0 @@\n-    private static volatile JTextField jTextField;\n-    private static volatile JTextArea jTextArea;\n-    private static volatile JEditorPane jEditorPane;\n-    private static volatile String actualAccessibleText;\n@@ -45,2 +40,6 @@\n-    public static void doTest() throws Exception {\n-        SwingUtilities.invokeAndWait(() -> createGUI());\n+    public static void doTest() {\n+        JTextField jTextField =\n+            new JTextField(\"Test1 Test2 Test3. Test4 Test5. Test6\");\n+        JTextArea jTextArea = new JTextArea(\"Test1 Test2 Test3.\\nTest4 Test5\");\n+        JEditorPane jEditorPane =\n+            new JEditorPane(\"text\/plain\", \"Test1 Test2 Test3.\\nTest4 Test5\");\n@@ -48,2 +47,3 @@\n-        if (!checkAccessibleText(jTextField, AccessibleText.CHARACTER, 5,\n-            \"1\")) {\n+        String actualAccessibleText = jTextField.getAccessibleContext()\n+            .getAccessibleText().getBeforeIndex(AccessibleText.CHARACTER, 5);\n+        if (!(actualAccessibleText.equals(\"1\"))) {\n@@ -52,1 +52,1 @@\n-                    + \"expected: 1, actual: \" + actualAccessibleText);\n+                    + \" expected:--1--, actual:--\" + actualAccessibleText + \"--\");\n@@ -54,1 +54,4 @@\n-        if (!checkAccessibleText(jTextField, AccessibleText.WORD, 5, \"Test1\")) {\n+\n+        actualAccessibleText = jTextField.getAccessibleContext()\n+            .getAccessibleText().getBeforeIndex(AccessibleText.WORD, 5);\n+        if (!(actualAccessibleText.equals(\"Test1\"))) {\n@@ -56,2 +59,2 @@\n-                \"JTextField - \" + \"getBeforeIndex() WORD parameter\"\n-                    + \"expected: Test1, actual: \" + actualAccessibleText);\n+                \"JTextField -\" + \"getBeforeIndex() WORD parameter\"\n+                    + \" expected:--Test1--, actual:--\" + actualAccessibleText + \"--\");\n@@ -59,2 +62,4 @@\n-        if (!checkAccessibleText(jTextField, AccessibleText.SENTENCE, 20,\n-            \"Test1 Test2 Test3. \")) {\n+\n+        actualAccessibleText = jTextField.getAccessibleContext()\n+            .getAccessibleText().getBeforeIndex(AccessibleText.SENTENCE, 20);\n+        if (!(actualAccessibleText.equals(\"Test1 Test2 Test3. \"))) {\n@@ -62,3 +67,3 @@\n-                \"JTextField - \" + \"getBeforeIndex() SENTENCE parameter\"\n-                    + \"expected: Test1 Test2 Test3. , \" + \"actual: \"\n-                    + actualAccessibleText);\n+                \"JTextField -\" + \"getBeforeIndex() SENTENCE parameter\"\n+                    + \" expected:--Test1 Test2 Test3. --, actual:--\"\n+                    + actualAccessibleText + \"--\");\n@@ -66,1 +71,4 @@\n-        if (!checkAccessibleText(jTextArea, AccessibleText.CHARACTER, 5, \"1\")) {\n+\n+        actualAccessibleText = jTextArea.getAccessibleContext()\n+            .getAccessibleText().getBeforeIndex(AccessibleText.CHARACTER, 5);\n+        if (!(actualAccessibleText.equals(\"1\"))) {\n@@ -68,2 +76,2 @@\n-                \"JTextArea - \" + \"getBeforeIndex() CHARACTER parameter\"\n-                    + \"expected: 1 , actual: \" + actualAccessibleText);\n+                \"JTextArea -\" + \"getBeforeIndex() CHARACTER parameter\"\n+                    + \" expected:--1--, actual:--\" + actualAccessibleText + \"--\");\n@@ -71,4 +79,7 @@\n-        if (!checkAccessibleText(jTextArea, AccessibleText.WORD, 5, \"Test1\")) {\n-            throw new RuntimeException(\n-                \"JTextArea - \" + \"getBeforeIndex() WORD parameter\"\n-                    + \"expected: Test1 , actual: \" + actualAccessibleText);\n+\n+        actualAccessibleText = jTextArea.getAccessibleContext()\n+            .getAccessibleText().getBeforeIndex(AccessibleText.WORD, 5);\n+        if (!(actualAccessibleText.equals(\"Test1\"))) {\n+            throw new RuntimeException(\"JTextArea -\"\n+                + \"getBeforeIndex() WORD parameter\"\n+                + \" expected:--Test1--, actual:--\" + actualAccessibleText + \"--\");\n@@ -76,2 +87,4 @@\n-        if (!checkAccessibleText(jTextArea, AccessibleText.SENTENCE, 20,\n-            \"Test1 Test2 Test3.\\n\")) {\n+\n+        actualAccessibleText = jTextArea.getAccessibleContext()\n+            .getAccessibleText().getBeforeIndex(AccessibleText.SENTENCE, 20);\n+        if (!(actualAccessibleText.equals(\"Test1 Test2 Test3.\\n\"))) {\n@@ -79,3 +92,3 @@\n-                \"JTextArea - \" + \"getBeforeIndex() SENTENCE parameter\"\n-                    + \"expected: Test1 Test2 Test3.\\n, actual: \"\n-                    + actualAccessibleText);\n+                \"JTextArea -\" + \"getBeforeIndex() SENTENCE parameter\"\n+                    + \" expected: Test1 Test2 Test3.\\n--, actual:--\"\n+                    + actualAccessibleText + \"--\");\n@@ -83,2 +96,4 @@\n-        if (!checkAccessibleText(jEditorPane, AccessibleText.CHARACTER, 5,\n-            \"1\")) {\n+\n+        actualAccessibleText = jEditorPane.getAccessibleContext()\n+            .getAccessibleText().getBeforeIndex(AccessibleText.CHARACTER, 5);\n+        if (!(actualAccessibleText.equals(\"1\"))) {\n@@ -86,2 +101,2 @@\n-                \"JTextArea - \" + \"getBeforeIndex() CHARACTER parameter\"\n-                    + \"expected: 1, actual: \" + actualAccessibleText);\n+                \"JEditorPane -\" + \"getBeforeIndex() CHARACTER parameter\"\n+                    + \" expected:--1--, actual:--\" + actualAccessibleText + \"--\");\n@@ -89,2 +104,4 @@\n-        if (!checkAccessibleText(jEditorPane, AccessibleText.WORD, 5,\n-            \"Test1\")) {\n+\n+        actualAccessibleText = jEditorPane.getAccessibleContext()\n+            .getAccessibleText().getBeforeIndex(AccessibleText.WORD, 5);\n+        if (!(actualAccessibleText.equals(\"Test1\"))) {\n@@ -92,2 +109,2 @@\n-                \"JEditorPane - \" + \"getBeforeIndex() WORD parameter\"\n-                    + \"expected: Test1, actual: \" + actualAccessibleText);\n+                \"JEditorPane -\" + \"getBeforeIndex() WORD parameter\"\n+                    + \" expected:--Test1--, actual:--\" + actualAccessibleText + \"--\");\n@@ -95,2 +112,4 @@\n-        if (!checkAccessibleText(jEditorPane, AccessibleText.SENTENCE, 20,\n-            \"Test1 Test2 Test3.\\n\")) {\n+\n+        actualAccessibleText = jEditorPane.getAccessibleContext()\n+            .getAccessibleText().getBeforeIndex(AccessibleText.SENTENCE, 20);\n+        if (!(actualAccessibleText.equals(\"Test1 Test2 Test3.\\n\"))) {\n@@ -98,3 +117,3 @@\n-                \"JEditorPane - \" + \"getBeforeIndex() Sentence parameter\"\n-                    + \"expected: Test1 Test2 Test3.\\n, actual: \"\n-                    + actualAccessibleText);\n+                \"JEditorPane -\" + \"getBeforeIndex() SENTENCE parameter\"\n+                    + \" expected:--Test1 Test2 Test3.\\n--, actual:--\"\n+                    + actualAccessibleText + \"--\");\n@@ -104,17 +123,0 @@\n-    private static void createGUI() {\n-        jTextField = new JTextField(\"Test1 Test2 Test3. Test4 Test5. Test6\");\n-        jTextArea = new JTextArea(\"Test1 Test2 Test3.\\nTest4 Test5\");\n-        jEditorPane =\n-            new JEditorPane(\"text\/plain\", \"Test1 Test2 Test3.\\nTest4 Test5\");\n-    }\n-\n-    private static boolean checkAccessibleText(JTextComponent jTextComponent,\n-        int character, int characterPosition, String expectedString)\n-            throws Exception {\n-        SwingUtilities.invokeAndWait(() -> actualAccessibleText =\n-            jTextComponent.getAccessibleContext().getAccessibleText()\n-            .getBeforeIndex(character, characterPosition));\n-\n-        return actualAccessibleText.equals(expectedString);\n-    }\n-\n@@ -122,1 +124,1 @@\n-        doTest();\n+        SwingUtilities.invokeAndWait(() -> doTest());\n","filename":"test\/jdk\/javax\/accessibility\/4170173\/AccessibleJTextBeforeIndexTest.java","additions":63,"deletions":61,"binary":false,"changes":124,"status":"modified"}]}