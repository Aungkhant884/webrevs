{"files":[{"patch":"@@ -877,1 +877,1 @@\n-instruct reduce_max2I(iRegINoSp dst, iRegIorL2I isrc, vecD vsrc, vecX tmp, rFlagsReg cr)\n+instruct reduce_max2I(iRegINoSp dst, iRegIorL2I isrc, vecD vsrc, vecD tmp, rFlagsReg cr)\n@@ -883,2 +883,1 @@\n-  format %{ \"dup   $tmp, T2D, $vsrc\\n\\t\"\n-            \"smaxv $tmp, T4S, $tmp\\n\\t\"\n+  format %{ \"smaxp $tmp, T2S, $vsrc, $vsrc\\n\\t\"\n@@ -890,2 +889,1 @@\n-    __ dup(as_FloatRegister($tmp$$reg), __ T2D, as_FloatRegister($vsrc$$reg));\n-    __ smaxv(as_FloatRegister($tmp$$reg), __ T4S, as_FloatRegister($tmp$$reg));\n+    __ smaxp(as_FloatRegister($tmp$$reg), __ T2S, as_FloatRegister($vsrc$$reg), as_FloatRegister($vsrc$$reg));\n@@ -899,1 +897,1 @@\n-instruct reduce_min2I(iRegINoSp dst, iRegIorL2I isrc, vecD vsrc, vecX tmp, rFlagsReg cr)\n+instruct reduce_min2I(iRegINoSp dst, iRegIorL2I isrc, vecD vsrc, vecD tmp, rFlagsReg cr)\n@@ -905,2 +903,1 @@\n-  format %{ \"dup   $tmp, T2D, $vsrc\\n\\t\"\n-            \"sminv $tmp, T4S, $tmp\\n\\t\"\n+  format %{ \"sminp $tmp, T2S, $vsrc, $vsrc\\n\\t\"\n@@ -912,2 +909,1 @@\n-    __ dup(as_FloatRegister($tmp$$reg), __ T2D, as_FloatRegister($vsrc$$reg));\n-    __ sminv(as_FloatRegister($tmp$$reg), __ T4S, as_FloatRegister($tmp$$reg));\n+    __ sminp(as_FloatRegister($tmp$$reg), __ T2S, as_FloatRegister($vsrc$$reg), as_FloatRegister($vsrc$$reg));\n@@ -4056,1 +4052,1 @@\n-instruct reduce_add2I(iRegINoSp dst, iRegIorL2I isrc, vecD vsrc, iRegINoSp tmp, iRegINoSp tmp2)\n+instruct reduce_add2I(iRegINoSp dst, iRegIorL2I isrc, vecD vsrc, vecD vtmp, iRegINoSp itmp)\n@@ -4061,5 +4057,4 @@\n-  effect(TEMP tmp, TEMP tmp2);\n-  format %{ \"umov  $tmp, $vsrc, S, 0\\n\\t\"\n-            \"umov  $tmp2, $vsrc, S, 1\\n\\t\"\n-            \"addw  $tmp, $isrc, $tmp\\n\\t\"\n-            \"addw  $dst, $tmp, $tmp2\\t# add reduction2I\"\n+  effect(TEMP vtmp, TEMP itmp);\n+  format %{ \"addpv  $vtmp, T2S, $vsrc, $vsrc\\n\\t\"\n+            \"umov  $itmp, $vtmp, S, 0\\n\\t\"\n+            \"addw  $dst, $itmp, $isrc\\t# add reduction4I\"\n@@ -4068,4 +4063,4 @@\n-    __ umov($tmp$$Register, as_FloatRegister($vsrc$$reg), __ S, 0);\n-    __ umov($tmp2$$Register, as_FloatRegister($vsrc$$reg), __ S, 1);\n-    __ addw($tmp$$Register, $isrc$$Register, $tmp$$Register);\n-    __ addw($dst$$Register, $tmp$$Register, $tmp2$$Register);\n+    __ addpv(as_FloatRegister($vtmp$$reg), __ T2S,\n+             as_FloatRegister($vsrc$$reg), as_FloatRegister($vsrc$$reg));\n+    __ umov($itmp$$Register, as_FloatRegister($vtmp$$reg), __ S, 0);\n+    __ addw($dst$$Register, $itmp$$Register, $isrc$$Register);\n","filename":"src\/hotspot\/cpu\/aarch64\/aarch64_neon.ad","additions":15,"deletions":20,"binary":false,"changes":35,"status":"modified"},{"patch":"@@ -499,1 +499,1 @@\n-instruct reduce_$1`'2I(iRegINoSp dst, iRegIorL2I isrc, vecD vsrc, vecX tmp, rFlagsReg cr)\n+instruct reduce_$1`'2I(iRegINoSp dst, iRegIorL2I isrc, vecD vsrc, vecD tmp, rFlagsReg cr)\n@@ -505,2 +505,1 @@\n-  format %{ \"dup   $tmp, T2D, $vsrc\\n\\t\"\n-            \"s$1v $tmp, T4S, $tmp\\n\\t\"\n+  format %{ \"s$1p $tmp, T2S, $vsrc, $vsrc\\n\\t\"\n@@ -512,2 +511,1 @@\n-    __ dup(as_FloatRegister($tmp$$reg), __ T2D, as_FloatRegister($vsrc$$reg));\n-    __ s$1v(as_FloatRegister($tmp$$reg), __ T4S, as_FloatRegister($tmp$$reg));\n+    __ s$1p(as_FloatRegister($tmp$$reg), __ T2S, as_FloatRegister($vsrc$$reg), as_FloatRegister($vsrc$$reg));\n@@ -1606,1 +1604,1 @@\n-instruct reduce_add$1$2`'(iRegINoSp dst, iRegIorL2I isrc, vec$3 vsrc, ifelse($1, 2, iRegINoSp tmp, vecX vtmp), iRegINoSp ifelse($1, 2, tmp2, itmp))\n+instruct reduce_add$1$2`'(iRegINoSp dst, iRegIorL2I isrc, vec$3 vsrc, vec$3 vtmp, iRegINoSp itmp)\n@@ -1611,5 +1609,2 @@\n-  effect(TEMP ifelse($1, 2, tmp, vtmp), TEMP ifelse($1, 2, tmp2, itmp));\n-  format %{ ifelse($1, 2, `\"umov  $tmp, $vsrc, S, 0\\n\\t\"\n-            \"umov  $tmp2, $vsrc, S, 1\\n\\t\"\n-            \"addw  $tmp, $isrc, $tmp\\n\\t\"\n-            \"addw  $dst, $tmp, $tmp2\\t# add reduction2I\"',`\"addv  $vtmp, T4S, $vsrc\\n\\t\"\n+  effect(TEMP vtmp, TEMP itmp);\n+  format %{ ifelse($1, 2, `\"addpv  $vtmp, T2S, $vsrc, $vsrc\\n\\t\"',`\"addv  $vtmp, T4S, $vsrc\\n\\t\"')\n@@ -1617,1 +1612,1 @@\n-            \"addw  $dst, $itmp, $isrc\\t# add reduction4I\"')\n+            \"addw  $dst, $itmp, $isrc\\t# add reduction4I\"\n@@ -1620,5 +1615,3 @@\n-    ifelse($1, 2, `__ umov($tmp$$Register, as_FloatRegister($vsrc$$reg), __ S, 0);\n-    __ umov($tmp2$$Register, as_FloatRegister($vsrc$$reg), __ S, 1);\n-    __ addw($tmp$$Register, $isrc$$Register, $tmp$$Register);\n-    __ addw($dst$$Register, $tmp$$Register, $tmp2$$Register);', `__ addv(as_FloatRegister($vtmp$$reg), __ T4S,\n-            as_FloatRegister($vsrc$$reg));\n+    ifelse($1, 2, `__ addpv(as_FloatRegister($vtmp$$reg), __ T2S,\n+             as_FloatRegister($vsrc$$reg), as_FloatRegister($vsrc$$reg));', `__ addv(as_FloatRegister($vtmp$$reg), __ T4S,\n+            as_FloatRegister($vsrc$$reg));')\n@@ -1626,1 +1619,1 @@\n-    __ addw($dst$$Register, $itmp$$Register, $isrc$$Register);')\n+    __ addw($dst$$Register, $itmp$$Register, $isrc$$Register);\n","filename":"src\/hotspot\/cpu\/aarch64\/aarch64_neon_ad.m4","additions":11,"deletions":18,"binary":false,"changes":29,"status":"modified"},{"patch":"@@ -2407,0 +2407,2 @@\n+  INSN(smaxp,  0, 0b101001, false); \/\/ accepted arrangements: T8B, T16B, T4H, T8H, T2S, T4S\n+  INSN(sminp,  0, 0b101011, false); \/\/ accepted arrangements: T8B, T16B, T4H, T8H, T2S, T4S\n","filename":"src\/hotspot\/cpu\/aarch64\/assembler_aarch64.hpp","additions":2,"deletions":0,"binary":false,"changes":2,"status":"modified"}]}