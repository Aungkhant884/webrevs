{"files":[{"patch":"@@ -116,7 +116,8 @@\n-serviceability\/sa\/ClhsdbCDSCore.java 8269982,8267433 macosx-aarch64,macosx-x64\n-serviceability\/sa\/ClhsdbFindPC.java#xcomp-core 8269982,8267433 macosx-aarch64,macosx-x64\n-serviceability\/sa\/ClhsdbFindPC.java#no-xcomp-core 8269982,8267433 macosx-aarch64,macosx-x64\n-serviceability\/sa\/ClhsdbPmap.java#core 8269982,8267433 macosx-aarch64,macosx-x64\n-serviceability\/sa\/ClhsdbPstack.java#core 8269982,8267433 macosx-aarch64,macosx-x64\n-serviceability\/sa\/TestJmapCore.java 8269982,8267433 macosx-aarch64,macosx-x64\n-serviceability\/sa\/TestJmapCoreMetaspace.java 8269982,8267433 macosx-aarch64,macosx-x64\n+serviceability\/sa\/ClhsdbCDSCore.java 8267433 macosx-x64\n+serviceability\/sa\/ClhsdbFindPC.java#xcomp-core 8267433 macosx-x64\n+serviceability\/sa\/ClhsdbFindPC.java#no-xcomp-core 8267433 macosx-x64\n+serviceability\/sa\/ClhsdbPmap.java#core 8267433 macosx-x64\n+serviceability\/sa\/ClhsdbPstack.java#core 8267433 macosx-x64\n+serviceability\/sa\/TestJmapCore.java 8267433 macosx-x64\n+serviceability\/sa\/TestJmapCoreMetaspace.java 8267433 macosx-x64\n+\n","filename":"test\/hotspot\/jtreg\/ProblemList.txt","additions":8,"deletions":7,"binary":false,"changes":15,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2018, 2021, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2018, 2022, Oracle and\/or its affiliates. All rights reserved.\n@@ -85,0 +85,1 @@\n+                CoreUtils.getAlwaysPretouchArg(true),\n","filename":"test\/hotspot\/jtreg\/serviceability\/sa\/ClhsdbCDSCore.java","additions":2,"deletions":1,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -96,1 +96,1 @@\n-                LingeredApp.startApp(theApp, \"-Xcomp\");\n+                LingeredApp.startApp(theApp, \"-Xcomp\", CoreUtils.getAlwaysPretouchArg(withCore));\n@@ -98,1 +98,1 @@\n-                LingeredApp.startApp(theApp, \"-Xint\");\n+                LingeredApp.startApp(theApp, \"-Xint\", CoreUtils.getAlwaysPretouchArg(withCore));\n","filename":"test\/hotspot\/jtreg\/serviceability\/sa\/ClhsdbFindPC.java","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2017, 2021, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2017, 2022, Oracle and\/or its affiliates. All rights reserved.\n@@ -63,1 +63,1 @@\n-            LingeredApp.startApp(theApp);\n+            LingeredApp.startApp(theApp, CoreUtils.getAlwaysPretouchArg(withCore));\n","filename":"test\/hotspot\/jtreg\/serviceability\/sa\/ClhsdbPmap.java","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2017, 2021, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2017, 2022, Oracle and\/or its affiliates. All rights reserved.\n@@ -63,1 +63,1 @@\n-            LingeredApp.startApp(theApp);\n+            LingeredApp.startApp(theApp, CoreUtils.getAlwaysPretouchArg(withCore));\n","filename":"test\/hotspot\/jtreg\/serviceability\/sa\/ClhsdbPstack.java","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2018, 2021, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2018, 2022, Oracle and\/or its affiliates. All rights reserved.\n@@ -76,0 +76,1 @@\n+                CoreUtils.getAlwaysPretouchArg(true),\n","filename":"test\/hotspot\/jtreg\/serviceability\/sa\/TestJmapCore.java","additions":2,"deletions":1,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -263,0 +263,10 @@\n+    public static String getAlwaysPretouchArg(boolean withCore) {\n+        \/\/ macosx-aarch64 has an issue where sometimes the java heap will not be dumped to the\n+        \/\/ core file. Using -XX:+AlwaysPreTouch fixes the problem.\n+        if (withCore && Platform.isOSX() && Platform.isAArch64()) {\n+            return \"-XX:+AlwaysPreTouch\";\n+        } else {\n+            return \"-XX:-AlwaysPreTouch\";\n+        }\n+    }\n+\n","filename":"test\/lib\/jdk\/test\/lib\/util\/CoreUtils.java","additions":10,"deletions":0,"binary":false,"changes":10,"status":"modified"}]}