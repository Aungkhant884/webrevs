{"files":[{"patch":"@@ -5015,1 +5015,1 @@\n-  bool use64byteVector = MaxVectorSize == 64 && AVX3Threshold == 0;\n+  bool use64byteVector = (MaxVectorSize == 64) && (VM_Version::avx3_threshold() == 0);\n@@ -5079,1 +5079,1 @@\n-  bool use64byteVector = MaxVectorSize > 32 && AVX3Threshold == 0;\n+  bool use64byteVector = (MaxVectorSize > 32) && (VM_Version::avx3_threshold() == 0);\n@@ -5322,2 +5322,2 @@\n-          \/\/ If number of bytes to fill < AVX3Threshold, perform fill using AVX2\n-          cmpl(count, AVX3Threshold);\n+          \/\/ If number of bytes to fill < VM_Version::avx3_threshold(), perform fill using AVX2\n+          cmpl(count, VM_Version::avx3_threshold());\n@@ -8709,0 +8709,1 @@\n+  int avx3threshold = VM_Version::avx3_threshold();\n@@ -8724,1 +8725,1 @@\n-  if (AVX3Threshold != 0  || MaxVectorSize == 32) {\n+  if ((avx3threshold != 0)  || (MaxVectorSize == 32)) {\n@@ -8727,1 +8728,1 @@\n-      cmpq(count, AVX3Threshold >> shift);\n+      cmpq(count, avx3threshold >> shift);\n","filename":"src\/hotspot\/cpu\/x86\/macroAssembler_x86.cpp","additions":7,"deletions":6,"binary":false,"changes":13,"status":"modified"},{"patch":"@@ -117,1 +117,1 @@\n-  bool avx3 = MaxVectorSize > 32 && AVX3Threshold == 0;\n+  bool avx3 = (MaxVectorSize > 32) && (VM_Version::avx3_threshold() == 0);\n","filename":"src\/hotspot\/cpu\/x86\/macroAssembler_x86_arrayCopy_avx3.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -1387,2 +1387,2 @@\n-\n-    bool use64byteVector = MaxVectorSize > 32 && AVX3Threshold == 0;\n+    int avx3threshold = VM_Version::avx3_threshold(); \n+    bool use64byteVector = (MaxVectorSize > 32) && (avx3threshold == 0);\n@@ -1451,1 +1451,1 @@\n-      if (AVX3Threshold != 0) {\n+      if (avx3threshold != 0) {\n@@ -1463,1 +1463,1 @@\n-      if (MaxVectorSize < 64  || AVX3Threshold != 0) {\n+      if ((MaxVectorSize < 64)  || (avx3threshold != 0)) {\n@@ -1606,1 +1606,2 @@\n-    bool use64byteVector = MaxVectorSize > 32 && AVX3Threshold == 0;\n+    int avx3threshold = VM_Version::avx3_threshold();\n+    bool use64byteVector = (MaxVectorSize > 32) && (avx3threshold == 0);\n@@ -1671,1 +1672,1 @@\n-      if (MaxVectorSize > 32 && AVX3Threshold != 0) {\n+      if ((MaxVectorSize > 32) && (avx3threshold != 0)) {\n@@ -1676,1 +1677,1 @@\n-      if (MaxVectorSize < 64  || AVX3Threshold != 0) {\n+      if ((MaxVectorSize < 64)  || (avx3threshold != 0)) {\n","filename":"src\/hotspot\/cpu\/x86\/stubGenerator_x86_64.cpp","additions":8,"deletions":7,"binary":false,"changes":15,"status":"modified"},{"patch":"@@ -1881,0 +1881,11 @@\n+\/\/ avx3_threshold() sets the threshold at which 64-byte instructions are used\n+\/\/ for implementing the array copy and clear operations.\n+\/\/ The Intel platforms that supports the serialize instruction\n+\/\/ has improved implementation of 64-byte load\/stores and so the default\n+\/\/ threshold is set to 0 for these platforms.\n+int VM_Version::avx3_threshold() {\n+  return (is_intel_family_core() &&\n+          supports_serialize() &&\n+          FLAG_IS_DEFAULT(AVX3Threshold)) ? 0 : AVX3Threshold;\n+}\n+\n","filename":"src\/hotspot\/cpu\/x86\/vm_version_x86.cpp","additions":11,"deletions":0,"binary":false,"changes":11,"status":"modified"},{"patch":"@@ -914,0 +914,2 @@\n+  static int avx3_threshold();\n+\n","filename":"src\/hotspot\/cpu\/x86\/vm_version_x86.hpp","additions":2,"deletions":0,"binary":false,"changes":2,"status":"modified"}]}