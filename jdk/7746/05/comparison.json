{"files":[{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2000, 2021, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2000, 2022, Oracle and\/or its affiliates. All rights reserved.\n@@ -28,4 +28,1 @@\n-import java.io.IOException;\n-import java.io.ObjectInputStream;\n-import java.io.ObjectOutputStream;\n-import java.io.ObjectStreamField;\n+import java.io.*;\n@@ -70,0 +67,1 @@\n+    @Serial\n@@ -180,1 +178,1 @@\n-        if (!(obj instanceof DelegationPermission)) {\n+        if (!(obj instanceof DelegationPermission that)) {\n@@ -184,2 +182,0 @@\n-        DelegationPermission that = (DelegationPermission) obj;\n-\n@@ -225,0 +221,1 @@\n+    @Serial\n@@ -239,0 +236,1 @@\n+    @Serial\n@@ -312,0 +310,1 @@\n+    @Serial\n@@ -321,0 +320,1 @@\n+    @Serial\n@@ -332,0 +332,1 @@\n+    @Serial\n@@ -346,0 +347,1 @@\n+    @Serial\n","filename":"src\/java.security.jgss\/share\/classes\/javax\/security\/auth\/kerberos\/DelegationPermission.java","additions":10,"deletions":8,"binary":false,"changes":18,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2014, 2015, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2014, 2022, Oracle and\/or its affiliates. All rights reserved.\n@@ -28,0 +28,1 @@\n+import java.io.Serial;\n@@ -51,0 +52,1 @@\n+    @Serial\n@@ -171,1 +173,1 @@\n-        return \"key \"  + key.toString();\n+        return \"key \"  + key;\n@@ -208,1 +210,1 @@\n-        if (! (other instanceof EncryptionKey)) {\n+        if (! (other instanceof EncryptionKey otherKey)) {\n@@ -212,1 +214,0 @@\n-        EncryptionKey otherKey = ((EncryptionKey) other);\n","filename":"src\/java.security.jgss\/share\/classes\/javax\/security\/auth\/kerberos\/EncryptionKey.java","additions":5,"deletions":4,"binary":false,"changes":9,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2014, 2015, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2014, 2022, Oracle and\/or its affiliates. All rights reserved.\n@@ -181,1 +181,1 @@\n-        if (! (other instanceof KerberosCredMessage)) {\n+        if (! (other instanceof KerberosCredMessage otherMessage)) {\n@@ -185,1 +185,0 @@\n-        KerberosCredMessage otherMessage = ((KerberosCredMessage) other);\n","filename":"src\/java.security.jgss\/share\/classes\/javax\/security\/auth\/kerberos\/KerberosCredMessage.java","additions":2,"deletions":3,"binary":false,"changes":5,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2000, 2020, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2000, 2022, Oracle and\/or its affiliates. All rights reserved.\n@@ -28,0 +28,1 @@\n+import java.io.Serial;\n@@ -89,0 +90,1 @@\n+    @Serial\n@@ -111,1 +113,1 @@\n-    private KeyImpl key;\n+    private final KeyImpl key;\n@@ -275,1 +277,1 @@\n-                \"key \"  + key.toString();\n+                \"key \"  + key;\n@@ -315,1 +317,1 @@\n-        if (! (other instanceof KerberosKey)) {\n+        if (! (other instanceof KerberosKey otherKey)) {\n@@ -319,1 +321,0 @@\n-        KerberosKey otherKey = ((KerberosKey) other);\n@@ -331,3 +332,1 @@\n-            if (otherKey.getPrincipal() != null) {\n-                return false;\n-            }\n+            return otherKey.getPrincipal() == null;\n@@ -335,3 +334,1 @@\n-            if (!principal.equals(otherKey.getPrincipal())) {\n-                return false;\n-            }\n+            return principal.equals(otherKey.getPrincipal());\n@@ -339,2 +336,0 @@\n-\n-        return true;\n","filename":"src\/java.security.jgss\/share\/classes\/javax\/security\/auth\/kerberos\/KerberosKey.java","additions":8,"deletions":13,"binary":false,"changes":21,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2000, 2021, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2000, 2022, Oracle and\/or its affiliates. All rights reserved.\n@@ -44,0 +44,1 @@\n+    @Serial\n@@ -193,1 +194,1 @@\n-        PrincipalName krb5Principal = null;\n+        PrincipalName krb5Principal;\n@@ -277,0 +278,1 @@\n+    @Serial\n@@ -297,0 +299,1 @@\n+    @Serial\n","filename":"src\/java.security.jgss\/share\/classes\/javax\/security\/auth\/kerberos\/KerberosPrincipal.java","additions":5,"deletions":2,"binary":false,"changes":7,"status":"modified"},{"patch":"@@ -85,0 +85,1 @@\n+    @Serial\n@@ -314,3 +315,1 @@\n-                for (int i = 0; i < flags.length; i++) {\n-                    this.flags[i] = flags[i];\n-                }\n+               System.arraycopy(flags, 0, this.flags, 0, flags.length);\n@@ -403,1 +402,1 @@\n-        return flags == null? false: flags[FORWARDABLE_TICKET_FLAG];\n+        return flags != null && flags[FORWARDABLE_TICKET_FLAG];\n@@ -415,1 +414,1 @@\n-        return flags == null? false: flags[FORWARDED_TICKET_FLAG];\n+        return flags != null && flags[FORWARDED_TICKET_FLAG];\n@@ -425,1 +424,1 @@\n-        return flags == null? false: flags[PROXIABLE_TICKET_FLAG];\n+        return flags != null && flags[PROXIABLE_TICKET_FLAG];\n@@ -435,1 +434,1 @@\n-        return flags == null? false: flags[PROXY_TICKET_FLAG];\n+        return flags != null && flags[PROXY_TICKET_FLAG];\n@@ -446,1 +445,1 @@\n-        return flags == null? false: flags[POSTDATED_TICKET_FLAG];\n+        return flags != null && flags[POSTDATED_TICKET_FLAG];\n@@ -458,1 +457,1 @@\n-        return flags == null? false: flags[RENEWABLE_TICKET_FLAG];\n+        return flags != null && flags[RENEWABLE_TICKET_FLAG];\n@@ -469,1 +468,1 @@\n-        return flags == null? false: flags[INITIAL_TICKET_FLAG];\n+        return flags != null && flags[INITIAL_TICKET_FLAG];\n@@ -558,1 +557,1 @@\n-        return endTime == null? false: (System.currentTimeMillis() <= endTime.getTime());\n+        return endTime != null && (System.currentTimeMillis() <= endTime.getTime());\n@@ -709,2 +708,2 @@\n-                \"Auth Time = \" + String.valueOf(authTime) + \"\\n\" +\n-                \"Start Time = \" + String.valueOf(startTime) + \"\\n\" +\n+                \"Auth Time = \" + authTime + \"\\n\" +\n+                \"Start Time = \" + startTime + \"\\n\" +\n@@ -712,1 +711,1 @@\n-                \"Renew Till = \" + String.valueOf(renewTill) + \"\\n\" +\n+                \"Renew Till = \" + renewTill + \"\\n\" +\n@@ -714,1 +713,1 @@\n-                (clientAddresses == null ? \" Null \" : caddrString.toString() +\n+                (clientAddresses == null ? \" Null \" : caddrString +\n@@ -778,1 +777,1 @@\n-        if (! (other instanceof KerberosTicket)) {\n+        if (! (other instanceof KerberosTicket otherTicket)) {\n@@ -782,1 +781,0 @@\n-        KerberosTicket otherTicket = ((KerberosTicket) other);\n@@ -829,5 +827,1 @@\n-        if (!Objects.equals(proxy, otherTicket.proxy)) {\n-            return false;\n-        }\n-\n-        return true;\n+        return Objects.equals(proxy, otherTicket.proxy);\n@@ -843,0 +837,1 @@\n+    @Serial\n","filename":"src\/java.security.jgss\/share\/classes\/javax\/security\/auth\/kerberos\/KerberosTicket.java","additions":17,"deletions":22,"binary":false,"changes":39,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2000, 2021, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2000, 2022, Oracle and\/or its affiliates. All rights reserved.\n@@ -52,0 +52,1 @@\n+    @Serial\n@@ -192,0 +193,1 @@\n+    @Serial\n@@ -212,0 +214,1 @@\n+    @Serial\n@@ -250,1 +253,1 @@\n-        if (! (other instanceof KeyImpl)) {\n+        if (! (other instanceof KeyImpl otherKey)) {\n@@ -254,1 +257,0 @@\n-        KeyImpl otherKey = ((KeyImpl) other);\n@@ -259,6 +261,2 @@\n-        if(keyType != otherKey.getKeyType() ||\n-                !Arrays.equals(keyBytes, otherKey.getEncoded())) {\n-            return false;\n-        }\n-\n-        return true;\n+        return keyType == otherKey.getKeyType() &&\n+                Arrays.equals(keyBytes, otherKey.getEncoded());\n","filename":"src\/java.security.jgss\/share\/classes\/javax\/security\/auth\/kerberos\/KeyImpl.java","additions":7,"deletions":9,"binary":false,"changes":16,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2011, 2021, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2011, 2022, Oracle and\/or its affiliates. All rights reserved.\n@@ -292,1 +292,1 @@\n-                        tmp == null ? 0 : tmp.intValue());\n+                        tmp == null ? 0 : tmp);\n@@ -352,1 +352,1 @@\n-        if (! (other instanceof KeyTab)) {\n+        if (! (other instanceof KeyTab otherKtab)) {\n@@ -356,1 +356,0 @@\n-        KeyTab otherKtab = (KeyTab) other;\n","filename":"src\/java.security.jgss\/share\/classes\/javax\/security\/auth\/kerberos\/KeyTab.java","additions":3,"deletions":4,"binary":false,"changes":7,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2000, 2021, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2000, 2022, Oracle and\/or its affiliates. All rights reserved.\n@@ -28,4 +28,1 @@\n-import java.io.IOException;\n-import java.io.ObjectInputStream;\n-import java.io.ObjectOutputStream;\n-import java.io.ObjectStreamField;\n+import java.io.*;\n@@ -41,1 +38,1 @@\n- * to access the service. Therefore granting access to a service\n+ * to access the service. Therefore, granting access to a service\n@@ -108,0 +105,1 @@\n+    @Serial\n@@ -189,1 +187,1 @@\n-     * More specifically, this method returns true if all of the following\n+     * More specifically, this method returns true if all the following\n@@ -206,1 +204,1 @@\n-        if (!(p instanceof ServicePermission))\n+        if (!(p instanceof ServicePermission that))\n@@ -209,2 +207,0 @@\n-        ServicePermission that = (ServicePermission) p;\n-\n@@ -237,1 +233,1 @@\n-        if (! (obj instanceof ServicePermission))\n+        if (! (obj instanceof ServicePermission that))\n@@ -240,1 +236,0 @@\n-        ServicePermission that = (ServicePermission) obj;\n@@ -273,2 +268,1 @@\n-            if (comma) sb.append(',');\n-            else comma = true;\n+            comma = true;\n@@ -280,1 +274,0 @@\n-            else comma = true;\n@@ -432,0 +425,1 @@\n+    @Serial\n@@ -450,0 +444,1 @@\n+    @Serial\n@@ -519,1 +514,1 @@\n-        if (! (permission instanceof ServicePermission))\n+        if (! (permission instanceof ServicePermission np))\n@@ -522,1 +517,0 @@\n-        ServicePermission np = (ServicePermission) permission;\n@@ -548,3 +542,1 @@\n-            if ((x.getMask() & desired) == desired) {\n-                return true;\n-            }\n+            return (x.getMask() & desired) == desired;\n@@ -569,1 +561,1 @@\n-        if (! (permission instanceof ServicePermission))\n+        if (! (permission instanceof ServicePermission sp))\n@@ -575,1 +567,0 @@\n-        ServicePermission sp = (ServicePermission)permission;\n@@ -586,2 +577,2 @@\n-                    int oldMask = ((ServicePermission)existingVal).getMask();\n-                    int newMask = ((ServicePermission)newVal).getMask();\n+                    int oldMask = ((ServicePermission) existingVal).getMask();\n+                    int newMask = ((ServicePermission) newVal).getMask();\n@@ -614,0 +605,1 @@\n+    @Serial\n@@ -624,0 +616,1 @@\n+    @Serial\n@@ -635,0 +628,1 @@\n+    @Serial\n@@ -649,0 +643,1 @@\n+    @Serial\n","filename":"src\/java.security.jgss\/share\/classes\/javax\/security\/auth\/kerberos\/ServicePermission.java","additions":19,"deletions":24,"binary":false,"changes":43,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2000, 2001, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2000, 2022, Oracle and\/or its affiliates. All rights reserved.\n@@ -82,2 +82,2 @@\n-    private InetAddress initiator;\n-    private InetAddress acceptor;\n+    private final InetAddress initiator;\n+    private final InetAddress acceptor;\n@@ -175,1 +175,1 @@\n-        if (! (obj instanceof ChannelBinding))\n+        if (! (obj instanceof ChannelBinding cb))\n@@ -178,2 +178,0 @@\n-        ChannelBinding cb = (ChannelBinding) obj;\n-\n","filename":"src\/java.security.jgss\/share\/classes\/org\/ietf\/jgss\/ChannelBinding.java","additions":4,"deletions":6,"binary":false,"changes":10,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2000, 2015, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2000, 2022, Oracle and\/or its affiliates. All rights reserved.\n@@ -219,1 +219,1 @@\n-    public static final int DEFAULT_LIFETIME = 0;\n+    int DEFAULT_LIFETIME = 0;\n@@ -226,1 +226,1 @@\n-    public static final int INDEFINITE_LIFETIME = Integer.MAX_VALUE;\n+    int INDEFINITE_LIFETIME = Integer.MAX_VALUE;\n@@ -275,1 +275,1 @@\n-    public byte[] initSecContext(byte inputBuf[], int offset, int len)\n+    byte[] initSecContext(byte inputBuf[], int offset, int len)\n@@ -363,2 +363,2 @@\n-    public int initSecContext(InputStream inStream,\n-                              OutputStream outStream) throws GSSException;\n+    int initSecContext(InputStream inStream,\n+                       OutputStream outStream) throws GSSException;\n@@ -430,1 +430,1 @@\n-    public byte[] acceptSecContext(byte inToken[], int offset, int len)\n+    byte[] acceptSecContext(byte inToken[], int offset, int len)\n@@ -522,2 +522,2 @@\n-    public void acceptSecContext(InputStream inStream,\n-                                 OutputStream outStream) throws GSSException;\n+    void acceptSecContext(InputStream inStream,\n+                          OutputStream outStream) throws GSSException;\n@@ -532,1 +532,1 @@\n-    public boolean isEstablished();\n+    boolean isEstablished();\n@@ -543,1 +543,1 @@\n-    public void dispose() throws GSSException;\n+    void dispose() throws GSSException;\n@@ -576,2 +576,2 @@\n-    public int getWrapSizeLimit(int qop, boolean confReq,\n-                                int maxTokenSize) throws GSSException;\n+    int getWrapSizeLimit(int qop, boolean confReq,\n+                         int maxTokenSize) throws GSSException;\n@@ -617,2 +617,2 @@\n-    public byte[] wrap(byte inBuf[], int offset, int len,\n-                       MessageProp msgProp) throws GSSException;\n+    byte[] wrap(byte inBuf[], int offset, int len,\n+                MessageProp msgProp) throws GSSException;\n@@ -648,1 +648,1 @@\n-     * protected. All of the data that is available in\n+     * protected. All the data that is available in\n@@ -668,2 +668,2 @@\n-    public void wrap(InputStream inStream, OutputStream outStream,\n-                     MessageProp msgProp) throws GSSException;\n+    void wrap(InputStream inStream, OutputStream outStream,\n+              MessageProp msgProp) throws GSSException;\n@@ -704,2 +704,2 @@\n-    public byte [] unwrap(byte[] inBuf, int offset, int len,\n-                          MessageProp msgProp) throws GSSException;\n+    byte [] unwrap(byte[] inBuf, int offset, int len,\n+                   MessageProp msgProp) throws GSSException;\n@@ -755,2 +755,2 @@\n-    public void unwrap(InputStream inStream, OutputStream outStream,\n-                       MessageProp msgProp) throws GSSException;\n+    void unwrap(InputStream inStream, OutputStream outStream,\n+                MessageProp msgProp) throws GSSException;\n@@ -787,2 +787,2 @@\n-    public byte[] getMIC(byte []inMsg, int offset, int len,\n-                         MessageProp msgProp) throws GSSException;\n+    byte[] getMIC(byte[] inMsg, int offset, int len,\n+                  MessageProp msgProp) throws GSSException;\n@@ -805,1 +805,1 @@\n-     * MIC over. All of the data that is available in\n+     * MIC over. All the data that is available in\n@@ -824,2 +824,2 @@\n-    public void getMIC(InputStream inStream, OutputStream outStream,\n-                       MessageProp msgProp) throws GSSException;\n+    void getMIC(InputStream inStream, OutputStream outStream,\n+                MessageProp msgProp) throws GSSException;\n@@ -859,3 +859,3 @@\n-    public void verifyMIC(byte[] inToken, int tokOffset, int tokLen,\n-                          byte[] inMsg, int msgOffset, int msgLen,\n-                          MessageProp msgProp) throws GSSException;\n+    void verifyMIC(byte[] inToken, int tokOffset, int tokLen,\n+                   byte[] inMsg, int msgOffset, int msgLen,\n+                   MessageProp msgProp) throws GSSException;\n@@ -894,1 +894,1 @@\n-     * verify the cryptographic MIC over. All of the data\n+     * verify the cryptographic MIC over. All the data\n@@ -912,2 +912,2 @@\n-    public void verifyMIC(InputStream tokStream, InputStream msgStream,\n-                          MessageProp msgProp) throws GSSException;\n+    void verifyMIC(InputStream tokStream, InputStream msgStream,\n+                   MessageProp msgProp) throws GSSException;\n@@ -917,1 +917,1 @@\n-     * import it.. Provided to support the sharing of work between\n+     * import it. Provided to support the sharing of work between\n@@ -944,1 +944,1 @@\n-     * possible.  Thus the application must take care to protect the\n+     * possible.  Thus, the application must take care to protect the\n@@ -968,1 +968,1 @@\n-    public byte [] export() throws GSSException;\n+    byte [] export() throws GSSException;\n@@ -973,1 +973,1 @@\n-     * initiator's side and it has to be done prior to the first call to\n+     * initiator's side, and it has to be done prior to the first call to\n@@ -990,1 +990,1 @@\n-    public void requestMutualAuth(boolean state) throws GSSException;\n+    void requestMutualAuth(boolean state) throws GSSException;\n@@ -995,1 +995,1 @@\n-     * request can only be made on the context initiator's side and it has\n+     * request can only be made on the context initiator's side, and it has\n@@ -1020,1 +1020,1 @@\n-    public void requestReplayDet(boolean state) throws GSSException;\n+    void requestReplayDet(boolean state) throws GSSException;\n@@ -1025,1 +1025,1 @@\n-     * request can only be made on the context initiator's side and it has\n+     * request can only be made on the context initiator's side, and it has\n@@ -1052,1 +1052,1 @@\n-    public void requestSequenceDet(boolean state) throws GSSException;\n+    void requestSequenceDet(boolean state) throws GSSException;\n@@ -1057,1 +1057,1 @@\n-     * request can only be made on the context initiator's side and it has\n+     * request can only be made on the context initiator's side, and it has\n@@ -1078,1 +1078,1 @@\n-    public void requestCredDeleg(boolean state) throws GSSException;\n+    void requestCredDeleg(boolean state) throws GSSException;\n@@ -1083,1 +1083,1 @@\n-     * context initiator's side and it has to be done prior to the first\n+     * context initiator's side, and it has to be done prior to the first\n@@ -1098,1 +1098,1 @@\n-    public void requestAnonymity(boolean state) throws GSSException;\n+    void requestAnonymity(boolean state) throws GSSException;\n@@ -1103,1 +1103,1 @@\n-     * the context initiator's side and it has to be done prior to the\n+     * the context initiator's side, and it has to be done prior to the\n@@ -1128,1 +1128,1 @@\n-    public void requestConf(boolean state) throws GSSException;\n+    void requestConf(boolean state) throws GSSException;\n@@ -1133,1 +1133,1 @@\n-     * request can only be made on the context initiator's side and it has\n+     * request can only be made on the context initiator's side, and it has\n@@ -1152,1 +1152,1 @@\n-    public void requestInteg(boolean state) throws GSSException;\n+    void requestInteg(boolean state) throws GSSException;\n@@ -1157,1 +1157,1 @@\n-     * side  and it has to be done prior to the first call to\n+     * side, and it has to be done prior to the first call to\n@@ -1173,1 +1173,1 @@\n-    public void requestLifetime(int lifetime) throws GSSException;\n+    void requestLifetime(int lifetime) throws GSSException;\n@@ -1190,1 +1190,1 @@\n-    public void setChannelBinding(ChannelBinding cb) throws GSSException;\n+    void setChannelBinding(ChannelBinding cb) throws GSSException;\n@@ -1205,1 +1205,1 @@\n-    public boolean getCredDelegState();\n+    boolean getCredDelegState();\n@@ -1219,1 +1219,1 @@\n-    public boolean getMutualAuthState();\n+    boolean getMutualAuthState();\n@@ -1233,1 +1233,1 @@\n-    public boolean getReplayDetState();\n+    boolean getReplayDetState();\n@@ -1247,1 +1247,1 @@\n-    public boolean getSequenceDetState();\n+    boolean getSequenceDetState();\n@@ -1268,1 +1268,1 @@\n-    public boolean getAnonymityState();\n+    boolean getAnonymityState();\n@@ -1281,1 +1281,1 @@\n-    public boolean isTransferable() throws GSSException;\n+    boolean isTransferable() throws GSSException;\n@@ -1293,1 +1293,1 @@\n-    public boolean isProtReady();\n+    boolean isProtReady();\n@@ -1308,1 +1308,1 @@\n-    public boolean getConfState();\n+    boolean getConfState();\n@@ -1322,1 +1322,1 @@\n-    public boolean getIntegState();\n+    boolean getIntegState();\n@@ -1334,1 +1334,1 @@\n-    public int getLifetime();\n+    int getLifetime();\n@@ -1349,1 +1349,1 @@\n-    public GSSName getSrcName() throws GSSException;\n+    GSSName getSrcName() throws GSSException;\n@@ -1363,1 +1363,1 @@\n-    public GSSName getTargName() throws GSSException;\n+    GSSName getTargName() throws GSSException;\n@@ -1377,1 +1377,1 @@\n-    public Oid getMech() throws GSSException;\n+    Oid getMech() throws GSSException;\n@@ -1395,1 +1395,1 @@\n-    public GSSCredential getDelegCred() throws GSSException;\n+    GSSCredential getDelegCred() throws GSSException;\n@@ -1409,1 +1409,1 @@\n-    public boolean isInitiator() throws GSSException;\n+    boolean isInitiator() throws GSSException;\n","filename":"src\/java.security.jgss\/share\/classes\/org\/ietf\/jgss\/GSSContext.java","additions":68,"deletions":68,"binary":false,"changes":136,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2000, 2015, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2000, 2022, Oracle and\/or its affiliates. All rights reserved.\n@@ -101,1 +101,1 @@\n-    public static final int INITIATE_AND_ACCEPT = 0;\n+    int INITIATE_AND_ACCEPT = 0;\n@@ -109,1 +109,1 @@\n-    public static final int INITIATE_ONLY = 1;\n+    int INITIATE_ONLY = 1;\n@@ -117,1 +117,1 @@\n-    public static final int ACCEPT_ONLY = 2;\n+    int ACCEPT_ONLY = 2;\n@@ -124,1 +124,1 @@\n-    public static final int DEFAULT_LIFETIME = 0;\n+    int DEFAULT_LIFETIME = 0;\n@@ -131,1 +131,1 @@\n-    public static final int INDEFINITE_LIFETIME = Integer.MAX_VALUE;\n+    int INDEFINITE_LIFETIME = Integer.MAX_VALUE;\n@@ -143,1 +143,1 @@\n-    public void dispose() throws GSSException;\n+    void dispose() throws GSSException;\n@@ -154,1 +154,1 @@\n-    public GSSName getName() throws GSSException;\n+    GSSName getName() throws GSSException;\n@@ -172,1 +172,1 @@\n-    public GSSName getName(Oid mech) throws GSSException;\n+    GSSName getName(Oid mech) throws GSSException;\n@@ -176,1 +176,1 @@\n-     * remaining lifetime is the minimum lifetime amongst all of the underlying\n+     * remaining lifetime is the minimum lifetime amongst all the underlying\n@@ -192,1 +192,1 @@\n-    public int getRemainingLifetime() throws GSSException;\n+    int getRemainingLifetime() throws GSSException;\n@@ -214,1 +214,1 @@\n-    public int getRemainingInitLifetime(Oid mech) throws GSSException;\n+    int getRemainingInitLifetime(Oid mech) throws GSSException;\n@@ -236,1 +236,1 @@\n-    public int getRemainingAcceptLifetime(Oid mech) throws GSSException;\n+    int getRemainingAcceptLifetime(Oid mech) throws GSSException;\n@@ -253,1 +253,1 @@\n-    public int getUsage() throws GSSException;\n+    int getUsage() throws GSSException;\n@@ -272,1 +272,1 @@\n-    public int getUsage(Oid mech) throws GSSException;\n+    int getUsage(Oid mech) throws GSSException;\n@@ -288,1 +288,1 @@\n-    public Oid[] getMechs() throws GSSException;\n+    Oid[] getMechs() throws GSSException;\n@@ -349,2 +349,2 @@\n-    public void add(GSSName name, int initLifetime, int acceptLifetime,\n-                    Oid mech, int usage) throws GSSException;\n+    void add(GSSName name, int initLifetime, int acceptLifetime,\n+             Oid mech, int usage) throws GSSException;\n@@ -361,1 +361,1 @@\n-    public boolean equals(Object another);\n+    boolean equals(Object another);\n@@ -368,1 +368,1 @@\n-    public int hashCode();\n+    int hashCode();\n","filename":"src\/java.security.jgss\/share\/classes\/org\/ietf\/jgss\/GSSCredential.java","additions":20,"deletions":20,"binary":false,"changes":40,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2000, 2015, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2000, 2022, Oracle and\/or its affiliates. All rights reserved.\n@@ -28,0 +28,3 @@\n+import java.io.Serial;\n+import java.util.Objects;\n+\n@@ -44,0 +47,1 @@\n+    @Serial\n@@ -178,1 +182,1 @@\n-    private static String[] messages = {\n+    private static final String[] messages = {\n@@ -209,1 +213,1 @@\n-    private int major;\n+    private final int major;\n@@ -236,1 +240,1 @@\n-     * @param majorCode the The GSS error code for the problem causing this\n+     * @param majorCode the GSS error code for the problem causing this\n@@ -252,1 +256,1 @@\n-     * @param majorString an expicit message to be included in this exception\n+     * @param majorString an explicit message to be included in this exception\n@@ -329,4 +333,1 @@\n-        if (majorString != null)\n-            return majorString;\n-        else\n-            return messages[major - 1];\n+        return Objects.requireNonNullElseGet(majorString, () -> messages[major - 1]);\n@@ -398,4 +399,1 @@\n-        if (major > 0 && major <= messages.length)\n-            return (true);\n-\n-        return (false);\n+        return major > 0 && major <= messages.length;\n","filename":"src\/java.security.jgss\/share\/classes\/org\/ietf\/jgss\/GSSException.java","additions":11,"deletions":13,"binary":false,"changes":24,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2000, 2020, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2000, 2022, Oracle and\/or its affiliates. All rights reserved.\n@@ -279,1 +279,1 @@\n-    public abstract GSSName createName(byte name[], Oid nameType)\n+    public abstract GSSName createName(byte[] name, Oid nameType)\n@@ -342,1 +342,1 @@\n-    public abstract GSSName createName(byte name[], Oid nameType, Oid mech)\n+    public abstract GSSName createName(byte[] name, Oid nameType, Oid mech)\n@@ -485,1 +485,1 @@\n-                                      int lifetime, Oid mechs[], int usage)\n+                                      int lifetime, Oid[] mechs, int usage)\n@@ -677,1 +677,1 @@\n-     * list of providers and Oid pairs that grows at the bottom. Thus the\n+     * list of providers and Oid pairs that grows at the bottom. Thus, the\n","filename":"src\/java.security.jgss\/share\/classes\/org\/ietf\/jgss\/GSSManager.java","additions":5,"deletions":5,"binary":false,"changes":10,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2000, 2015, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2000, 2022, Oracle and\/or its affiliates. All rights reserved.\n@@ -118,1 +118,1 @@\n-    public static final Oid NT_HOSTBASED_SERVICE\n+    Oid NT_HOSTBASED_SERVICE\n@@ -128,1 +128,1 @@\n-    public static final Oid NT_USER_NAME\n+    Oid NT_USER_NAME\n@@ -139,1 +139,1 @@\n-    public static final Oid NT_MACHINE_UID_NAME\n+    Oid NT_MACHINE_UID_NAME\n@@ -151,1 +151,1 @@\n-    public static final Oid NT_STRING_UID_NAME\n+    Oid NT_STRING_UID_NAME\n@@ -160,1 +160,1 @@\n-    public static final Oid NT_ANONYMOUS\n+    Oid NT_ANONYMOUS\n@@ -171,1 +171,1 @@\n-    public static final Oid NT_EXPORT_NAME\n+    Oid NT_EXPORT_NAME\n@@ -188,1 +188,1 @@\n-    public boolean equals(GSSName another) throws GSSException;\n+    boolean equals(GSSName another) throws GSSException;\n@@ -201,1 +201,1 @@\n-    public boolean equals(Object another);\n+    boolean equals(Object another);\n@@ -208,1 +208,1 @@\n-    public int hashCode();\n+    int hashCode();\n@@ -227,1 +227,1 @@\n-    public GSSName canonicalize(Oid mech) throws GSSException;\n+    GSSName canonicalize(Oid mech) throws GSSException;\n@@ -262,1 +262,1 @@\n-    public byte[] export() throws GSSException;\n+    byte[] export() throws GSSException;\n@@ -272,1 +272,1 @@\n-    public String toString();\n+    String toString();\n@@ -286,1 +286,1 @@\n-    public Oid getStringNameType() throws GSSException;\n+    Oid getStringNameType() throws GSSException;\n@@ -293,1 +293,1 @@\n-    public boolean isAnonymous();\n+    boolean isAnonymous();\n@@ -302,1 +302,1 @@\n-    public boolean isMN();\n+    boolean isMN();\n","filename":"src\/java.security.jgss\/share\/classes\/org\/ietf\/jgss\/GSSName.java","additions":16,"deletions":16,"binary":false,"changes":32,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2000, 2020, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2000, 2022, Oracle and\/or its affiliates. All rights reserved.\n@@ -53,1 +53,1 @@\n-    private ObjectIdentifier oid;\n+    private final ObjectIdentifier oid;\n@@ -103,1 +103,1 @@\n-     * method is identical in functionality to its InputStream conterpart.\n+     * method is identical in functionality to its InputStream counterpart.\n","filename":"src\/java.security.jgss\/share\/classes\/org\/ietf\/jgss\/Oid.java","additions":3,"deletions":3,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2000, 2019, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2000, 2022, Oracle and\/or its affiliates. All rights reserved.\n@@ -68,1 +68,1 @@\n- * the private credential set where as some other mechanism might look\n+ * the private credential set whereas some other mechanism might look\n","filename":"src\/java.security.jgss\/share\/classes\/org\/ietf\/jgss\/package-info.java","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -39,1 +39,1 @@\n-    private String name;\n+    private final String name;\n","filename":"src\/java.security.jgss\/share\/classes\/sun\/security\/jgss\/GSSCaller.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2000, 2020, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2000, 2022, Oracle and\/or its affiliates. All rights reserved.\n@@ -148,1 +148,1 @@\n-        if ((peer == null) || !(peer instanceof GSSNameImpl)) {\n+        if (!(peer instanceof GSSNameImpl)) {\n@@ -185,1 +185,1 @@\n-    public byte[] initSecContext(byte inputBuf[], int offset, int len)\n+    public byte[] initSecContext(byte[] inputBuf, int offset, int len)\n@@ -209,1 +209,1 @@\n-        GSSHeader gssHeader = null;\n+        GSSHeader gssHeader;\n@@ -295,1 +295,1 @@\n-    public byte[] acceptSecContext(byte inTok[], int offset, int len)\n+    public byte[] acceptSecContext(byte[] inTok, int offset, int len)\n@@ -318,1 +318,1 @@\n-        GSSHeader gssHeader = null;\n+        GSSHeader gssHeader;\n@@ -364,1 +364,0 @@\n-                int retVal = obuf.length;\n@@ -371,1 +370,1 @@\n-                    retVal += gssHeader.encode(outStream);\n+                    gssHeader.encode(outStream);\n@@ -401,1 +400,1 @@\n-    public byte[] wrap(byte inBuf[], int offset, int len,\n+    public byte[] wrap(byte[] inBuf, int offset, int len,\n","filename":"src\/java.security.jgss\/share\/classes\/sun\/security\/jgss\/GSSContextImpl.java","additions":8,"deletions":9,"binary":false,"changes":17,"status":"modified"},{"patch":"@@ -175,2 +175,2 @@\n-        SearchKey key = null;\n-        GSSCredentialSpi element = null;\n+        SearchKey key;\n+        GSSCredentialSpi element;\n@@ -216,1 +216,1 @@\n-        int tempLife = 0, tempInitLife = 0, tempAcceptLife = 0;\n+        int tempLife, tempInitLife, tempAcceptLife;\n@@ -230,3 +230,1 @@\n-                tempLife = (tempInitLife < tempAcceptLife ?\n-                            tempInitLife:\n-                            tempAcceptLife);\n+                tempLife = (Math.min(tempInitLife, tempAcceptLife));\n@@ -248,2 +246,2 @@\n-        GSSCredentialSpi element = null;\n-        SearchKey key = null;\n+        GSSCredentialSpi element;\n+        SearchKey key;\n@@ -288,2 +286,2 @@\n-        GSSCredentialSpi element = null;\n-        SearchKey key = null;\n+        GSSCredentialSpi element;\n+        SearchKey key;\n@@ -364,2 +362,2 @@\n-        GSSCredentialSpi element = null;\n-        SearchKey key = null;\n+        GSSCredentialSpi element;\n+        SearchKey key;\n@@ -621,1 +619,1 @@\n-                        new HashSet<GSSCredentialSpi>(hashtable.size());\n+                new HashSet<>(hashtable.size());\n@@ -652,1 +650,1 @@\n-        GSSCredentialSpi element = null;\n+        GSSCredentialSpi element;\n@@ -679,1 +677,1 @@\n-        private Oid mechOid = null;\n+        private final Oid mechOid;\n@@ -693,1 +691,1 @@\n-            if (! (other instanceof SearchKey))\n+            if (! (other instanceof SearchKey that))\n@@ -695,1 +693,0 @@\n-            SearchKey that = (SearchKey) other;\n","filename":"src\/java.security.jgss\/share\/classes\/sun\/security\/jgss\/GSSCredentialImpl.java","additions":14,"deletions":17,"binary":false,"changes":31,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2000, 2006, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2000, 2022, Oracle and\/or its affiliates. All rights reserved.\n@@ -30,0 +30,2 @@\n+import java.io.Serial;\n+\n@@ -37,0 +39,1 @@\n+    @Serial\n","filename":"src\/java.security.jgss\/share\/classes\/sun\/security\/jgss\/GSSExceptionImpl.java","additions":4,"deletions":1,"binary":false,"changes":5,"status":"modified"},{"patch":"@@ -48,1 +48,1 @@\n- * encoding scheme descibed in this section rather than use ASN.1\n+ * encoding scheme described in this section rather than use ASN.1\n@@ -55,3 +55,3 @@\n-    private ObjectIdentifier mechOid = null;\n-    private byte[] mechOidBytes = null;\n-    private int mechTokenLength = 0;\n+    private final ObjectIdentifier mechOid;\n+    private final byte[] mechOidBytes;\n+    private final int mechTokenLength;\n@@ -83,1 +83,1 @@\n-     * Reads in a GSSHeader from an InputStream. Typically this would be\n+     * Reads in a GSSHeader from an InputStream. Typically, this would be\n@@ -162,1 +162,1 @@\n-        } catch (IOException e) {\n+        } catch (IOException ignored) {\n@@ -199,1 +199,1 @@\n-        int retVal = 1;\n+        int retVal;\n@@ -264,1 +264,1 @@\n-            if (tmp < 0 || tmp > 4)\n+            if (tmp > 4)\n@@ -266,2 +266,1 @@\n-                                      + tmp + \", \"\n-                                      + ((tmp < 0) ? \"incorrect DER encoding.\" : \"too big.\"));\n+                                      + tmp + \", too big.\");\n@@ -290,1 +289,1 @@\n-        int retVal = 0;\n+        int retVal;\n@@ -336,1 +335,1 @@\n-            int b1 = (bytes[i]>>4) & 0x0f;\n+            int b1 = (bytes[i] >> 4) & 0x0f;\n","filename":"src\/java.security.jgss\/share\/classes\/sun\/security\/jgss\/GSSHeader.java","additions":11,"deletions":12,"binary":false,"changes":23,"status":"modified"},{"patch":"@@ -43,1 +43,1 @@\n-    private ProviderList list;\n+    private final ProviderList list;\n@@ -79,1 +79,1 @@\n-        \/\/ Iterate thru all mechs in GSS\n+        \/\/ Iterate through all mechs in GSS\n@@ -101,2 +101,1 @@\n-            for (int i = 0; i < pos; i++)\n-                temp[i] = retVal[i];\n+            System.arraycopy(retVal, 0, temp, 0, pos);\n","filename":"src\/java.security.jgss\/share\/classes\/sun\/security\/jgss\/GSSManagerImpl.java","additions":3,"deletions":4,"binary":false,"changes":7,"status":"modified"},{"patch":"@@ -57,1 +57,1 @@\n- * Assume that getting a mechanism to parse the applciation specified\n+ * Assume that getting a mechanism to parse the application specified\n@@ -228,1 +228,1 @@\n-        byte[] bytes = null;\n+        byte[] bytes;\n@@ -243,1 +243,1 @@\n-        ObjectIdentifier temp = null;\n+        ObjectIdentifier temp;\n@@ -288,1 +288,1 @@\n-        if (! (other instanceof GSSNameImpl))\n+        if (! (other instanceof GSSNameImpl that))\n@@ -297,2 +297,0 @@\n-        GSSNameImpl that = (GSSNameImpl) other;\n-\n@@ -402,2 +400,2 @@\n-        byte[] oidBytes = null;\n-        ObjectIdentifier oid = null;\n+        byte[] oidBytes;\n+        ObjectIdentifier oid;\n@@ -418,1 +416,1 @@\n-                                   + oid.toString());\n+                                   + oid);\n","filename":"src\/java.security.jgss\/share\/classes\/sun\/security\/jgss\/GSSNameImpl.java","additions":7,"deletions":9,"binary":false,"changes":16,"status":"modified"},{"patch":"@@ -28,0 +28,2 @@\n+import java.io.EOFException;\n+import java.io.IOException;\n@@ -30,3 +32,0 @@\n-import java.io.IOException;\n-import java.io.EOFException;\n-import sun.security.util.*;\n@@ -73,1 +72,1 @@\n-                                               int pos) {\n+                                            int pos) {\n@@ -156,1 +155,1 @@\n-     * @param src the byte arra to read from\n+     * @param src the byte array to read from\n@@ -206,1 +205,1 @@\n-    public static final  String getHexBytes(byte[] bytes) {\n+    public static final String getHexBytes(byte[] bytes) {\n@@ -210,1 +209,1 @@\n-    public static final  String getHexBytes(byte[] bytes, int len) {\n+    public static final String getHexBytes(byte[] bytes, int len) {\n","filename":"src\/java.security.jgss\/share\/classes\/sun\/security\/jgss\/GSSToken.java","additions":6,"deletions":7,"binary":false,"changes":13,"status":"modified"},{"patch":"@@ -121,2 +121,2 @@\n-        HashSet<Object> privCredentials = null;\n-        HashSet<Object> pubCredentials = new HashSet<Object>(); \/\/ empty Set\n+        HashSet<Object> privCredentials;\n+        HashSet<Object> pubCredentials = new HashSet<>(); \/\/ empty Set\n@@ -124,1 +124,1 @@\n-        Set<GSSCredentialSpi> gssCredentials = null;\n+        Set<GSSCredentialSpi> gssCredentials;\n@@ -127,1 +127,1 @@\n-                                new HashSet<KerberosPrincipal>();\n+                new HashSet<>();\n@@ -149,1 +149,1 @@\n-            privCredentials = new HashSet<Object>(gssCredentials.size());\n+            privCredentials = new HashSet<>(gssCredentials.size());\n@@ -152,1 +152,1 @@\n-            privCredentials = new HashSet<Object>(); \/\/ empty Set\n+            privCredentials = new HashSet<>(); \/\/ empty Set\n@@ -236,1 +236,1 @@\n-        CallbackHandler cb = null;\n+        CallbackHandler cb;\n@@ -262,1 +262,1 @@\n-     * the required credentials from outside of the current Subject. Our\n+     * the required credentials from outside the current Subject. Our\n@@ -327,11 +327,16 @@\n-                (new PrivilegedExceptionAction<Vector<T>>() {\n-                    public Vector<T> run() throws Exception {\n-                        Subject currSubj = Subject.current();\n-                        Vector<T> result = null;\n-                        if (currSubj != null) {\n-                            result = new Vector<T>();\n-                            Iterator<GSSCredentialImpl> iterator =\n-                                currSubj.getPrivateCredentials\n-                                (GSSCredentialImpl.class).iterator();\n-                            while (iterator.hasNext()) {\n-                                GSSCredentialImpl cred = iterator.next();\n+                ((PrivilegedExceptionAction<Vector<T>>) () -> {\n+                    Subject currSubj = Subject.current();\n+                    Vector<T> result = null;\n+                    if (currSubj != null) {\n+                        result = new Vector<>();\n+                        Iterator<GSSCredentialImpl> iterator =\n+                            currSubj.getPrivateCredentials\n+                            (GSSCredentialImpl.class).iterator();\n+                        while (iterator.hasNext()) {\n+                            GSSCredentialImpl cred = iterator.next();\n+                            if (DEBUG) {\n+                                debug(\"...Found cred\" + cred);\n+                            }\n+                            try {\n+                                GSSCredentialSpi ce =\n+                                    cred.getElement(mech, initiate);\n@@ -339,1 +344,1 @@\n-                                    debug(\"...Found cred\" + cred);\n+                                    debug(\"......Found element: \" + ce);\n@@ -341,16 +346,5 @@\n-                                try {\n-                                    GSSCredentialSpi ce =\n-                                        cred.getElement(mech, initiate);\n-                                    if (DEBUG) {\n-                                        debug(\"......Found element: \" + ce);\n-                                    }\n-                                    if (ce.getClass().equals(credCls) &&\n-                                        (name == null ||\n-                                         name.equals((Object) ce.getName()))) {\n-                                        result.add(credCls.cast(ce));\n-                                    } else {\n-                                        if (DEBUG) {\n-                                            debug(\"......Discard element\");\n-                                        }\n-                                    }\n-                                } catch (GSSException ge) {\n+                                if (ce.getClass().equals(credCls) &&\n+                                    (name == null ||\n+                                     name.equals((Object) ce.getName()))) {\n+                                    result.add(credCls.cast(ce));\n+                                } else {\n@@ -358,1 +352,1 @@\n-                                        debug(\"...Discard cred (\" + ge + \")\");\n+                                        debug(\"......Discard element\");\n@@ -361,0 +355,4 @@\n+                            } catch (GSSException ge) {\n+                                if (DEBUG) {\n+                                    debug(\"...Discard cred (\" + ge + \")\");\n+                                }\n@@ -362,2 +360,0 @@\n-                        } else if (DEBUG) {\n-                            debug(\"No Subject\");\n@@ -365,1 +361,2 @@\n-                        return result;\n+                    } else if (DEBUG) {\n+                        debug(\"No Subject\");\n@@ -367,0 +364,1 @@\n+                    return result;\n","filename":"src\/java.security.jgss\/share\/classes\/sun\/security\/jgss\/GSSUtil.java","additions":38,"deletions":40,"binary":false,"changes":78,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2014, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2014, 2022, Oracle and\/or its affiliates. All rights reserved.\n@@ -34,1 +34,1 @@\n- * If a module wants to extend basic JGSS-API classes, it should extends this\n+ * If a module wants to extend basic JGSS-API classes, it should extend this\n","filename":"src\/java.security.jgss\/share\/classes\/sun\/security\/jgss\/JgssExtender.java","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2005, 2021, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2005, 2022, Oracle and\/or its affiliates. All rights reserved.\n@@ -28,0 +28,1 @@\n+import java.security.PrivilegedAction;\n@@ -72,1 +73,1 @@\n-            throw new IllegalArgumentException(mech.toString() + \" not supported\");\n+            throw new IllegalArgumentException(mech + \" not supported\");\n@@ -75,5 +76,1 @@\n-                (new java.security.PrivilegedAction <Configuration> () {\n-            public Configuration run() {\n-                return Configuration.getConfiguration();\n-            }\n-        });\n+                ((PrivilegedAction<Configuration>) Configuration::getConfiguration);\n@@ -169,1 +166,1 @@\n-        HashMap <String, String> options = new HashMap <String, String> (2);\n+        HashMap <String, String> options = new HashMap<>(2);\n","filename":"src\/java.security.jgss\/share\/classes\/sun\/security\/jgss\/LoginConfigImpl.java","additions":5,"deletions":8,"binary":false,"changes":13,"status":"modified"},{"patch":"@@ -54,1 +54,1 @@\n- * system wide providers that contain a property of the form\n+ * system-wide providers that contain a property of the form\n@@ -76,1 +76,1 @@\n- * result of encountering a entryof the form {@code <provider, oid>} where\n+ * result of encountering an entry of the form {@code <provider, oid>} where\n@@ -78,1 +78,1 @@\n- * this entry and it wants this mechanism to be obtained from this\n+ * this entry, and it wants this mechanism to be obtained from this\n@@ -113,5 +113,5 @@\n-    private ArrayList<PreferencesEntry> preferences =\n-                        new ArrayList<PreferencesEntry>(5);\n-    private HashMap<PreferencesEntry, MechanismFactory> factories =\n-                        new HashMap<PreferencesEntry, MechanismFactory>(5);\n-    private HashSet<Oid> mechs = new HashSet<Oid>(5);\n+    private final ArrayList<PreferencesEntry> preferences =\n+            new ArrayList<>(5);\n+    private final HashMap<PreferencesEntry, MechanismFactory> factories =\n+            new HashMap<>(5);\n+    private final HashSet<Oid> mechs = new HashSet<>(5);\n@@ -189,2 +189,1 @@\n-            \/\/ Iterate thru all preferences to find right provider\n-            String className;\n+            \/\/ Iterate through all preferences to find right provider\n@@ -203,1 +202,1 @@\n-            \/\/ Use the impl from the specified provider; return null if the\n+            \/\/ Use the impl from the specified provider; return null if\n@@ -399,1 +398,1 @@\n-     * Helper routine to go through all properties contined in a\n+     * Helper routine to go through all properties contained in a\n@@ -401,1 +400,1 @@\n-     * mechanisms. If no default mechanism has been assinged so far,\n+     * mechanisms. If no default mechanism has been assigned so far,\n@@ -443,1 +442,1 @@\n-     *\n+     * <p>\n@@ -445,1 +444,1 @@\n-     * PreferencesEntry's and iterates thru them as it tries to\n+     * PreferencesEntry's and iterates through them as it tries to\n@@ -461,1 +460,1 @@\n-            if (!(other instanceof PreferencesEntry)) {\n+            if (!(other instanceof PreferencesEntry that)) {\n@@ -465,1 +464,0 @@\n-            PreferencesEntry that = (PreferencesEntry)other;\n@@ -497,2 +495,1 @@\n-            if (other instanceof PreferencesEntry) {\n-                PreferencesEntry temp = (PreferencesEntry) other;\n+            if (other instanceof PreferencesEntry temp) {\n@@ -501,1 +498,1 @@\n-                        oid == null);\n+                                oid == null);\n@@ -520,0 +517,1 @@\n+         *\n@@ -530,6 +528,4 @@\n-            StringBuilder sb = new StringBuilder(\"<\");\n-            sb.append(p.getName());\n-            sb.append(\", \");\n-            sb.append(oid);\n-            sb.append(\">\");\n-            return sb.toString();\n+            return \"<\" + p.getName() +\n+                    \", \" +\n+                    oid +\n+                    \">\";\n","filename":"src\/java.security.jgss\/share\/classes\/sun\/security\/jgss\/ProviderList.java","additions":22,"deletions":26,"binary":false,"changes":48,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2000, 2021, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2000, 2022, Oracle and\/or its affiliates. All rights reserved.\n@@ -28,0 +28,1 @@\n+import java.io.Serial;\n@@ -62,0 +63,1 @@\n+    @Serial\n@@ -107,10 +109,8 @@\n-        AccessController.doPrivileged(new PrivilegedAction<Void>() {\n-            public Void run() {\n-                putService(new ProviderService(p, \"GssApiMechanism\",\n-                           \"1.2.840.113554.1.2.2\",\n-                           \"sun.security.jgss.krb5.Krb5MechFactory\"));\n-                putService(new ProviderService(p, \"GssApiMechanism\",\n-                           \"1.3.6.1.5.5.2\",\n-                           \"sun.security.jgss.spnego.SpNegoMechFactory\"));\n-                return null;\n-            }\n+        AccessController.doPrivileged((PrivilegedAction<Void>) () -> {\n+            putService(new ProviderService(p, \"GssApiMechanism\",\n+                       \"1.2.840.113554.1.2.2\",\n+                       \"sun.security.jgss.krb5.Krb5MechFactory\"));\n+            putService(new ProviderService(p, \"GssApiMechanism\",\n+                       \"1.3.6.1.5.5.2\",\n+                       \"sun.security.jgss.spnego.SpNegoMechFactory\"));\n+            return null;\n","filename":"src\/java.security.jgss\/share\/classes\/sun\/security\/jgss\/SunProvider.java","additions":11,"deletions":11,"binary":false,"changes":22,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2000, 2021, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2000, 2022, Oracle and\/or its affiliates. All rights reserved.\n@@ -39,1 +39,1 @@\n- * numbers that fall in between two elements of the list. eg. {[a,b],\n+ * numbers that fall in between two elements of the list. e.g. {[a,b],\n@@ -44,1 +44,1 @@\n- * MAX_INTERVALS. Thus if there are too many gaps, then some of the older\n+ * MAX_INTERVALS. Thus, if there are too many gaps, then some older\n@@ -66,1 +66,1 @@\n-    private int initNumber;\n+    private final int initNumber;\n@@ -72,1 +72,1 @@\n-    private LinkedList<Entry> list = new LinkedList<Entry>();\n+    private final LinkedList<Entry> list = new LinkedList<>();\n@@ -81,1 +81,1 @@\n-        Entry entry = new Entry(initNumber-1);\n+        Entry entry = new Entry(initNumber - 1);\n@@ -93,1 +93,1 @@\n-        Entry entry = null;\n+        Entry entry;\n@@ -111,1 +111,1 @@\n-     * possibilites for tokens that fall in there.\n+     * possibilities for tokens that fall in there.\n@@ -238,1 +238,1 @@\n-        Entry entryAfter = null;\n+        Entry entryAfter;\n@@ -280,1 +280,1 @@\n-         * which needs to be added to the list. We might have to recyle an\n+         * which needs to be added to the list. We might have to recycle an\n@@ -332,1 +332,1 @@\n-        \/\/ Finally we are ready to actually add to the list at index\n+        \/\/ Finally, we are ready to actually add to the list at index\n@@ -356,1 +356,1 @@\n-     * tokens. Each entry is actaully an interval of numbers, all of which\n+     * tokens. Each entry is actually an interval of numbers, all of which\n@@ -359,1 +359,1 @@\n-    class Entry {\n+    static class Entry {\n","filename":"src\/java.security.jgss\/share\/classes\/sun\/security\/jgss\/TokenTracker.java","additions":13,"deletions":13,"binary":false,"changes":26,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2000, 2018, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2000, 2022, Oracle and\/or its affiliates. All rights reserved.\n@@ -59,1 +59,1 @@\n-        context.resetMySequenceNumber(apRep.getSeqNumber().intValue());\n+        context.resetMySequenceNumber(apRep.getSeqNumber());\n@@ -102,2 +102,1 @@\n-                             apRepSeqNumber.intValue() :\n-                             0);\n+                             apRepSeqNumber : 0);\n","filename":"src\/java.security.jgss\/share\/classes\/sun\/security\/jgss\/krb5\/AcceptSecContextToken.java","additions":3,"deletions":4,"binary":false,"changes":7,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2004, 2017, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2004, 2022, Oracle and\/or its affiliates. All rights reserved.\n@@ -79,3 +79,4 @@\n-    private int etype;\n-    private int sgnAlg, sealAlg;\n-    private byte[] keybytes;\n+    private final int etype;\n+    private final int sgnAlg;\n+    private final int sealAlg;\n+    private final byte[] keybytes;\n@@ -137,5 +138,1 @@\n-        boolean flag = false;\n-        if (etype == EncryptedData.ETYPE_ARCFOUR_HMAC) {\n-            flag = true;\n-        }\n-        return flag;\n+        return etype == EncryptedData.ETYPE_ARCFOUR_HMAC;\n@@ -387,1 +384,1 @@\n-                byte[] answer = Aes256Sha2.calculateChecksum(keybytes, key_usage,\n+                return Aes256Sha2.calculateChecksum(keybytes, key_usage,\n@@ -389,1 +386,0 @@\n-                return answer;\n@@ -847,1 +843,1 @@\n-        byte[] ctext = null;\n+        byte[] ctext;\n@@ -889,1 +885,1 @@\n-    private byte[] getDesCbcChecksum(byte key[],\n+    private byte[] getDesCbcChecksum(byte[] key,\n@@ -957,2 +953,2 @@\n-    private final Cipher getInitializedDes(boolean encryptMode, byte[] key,\n-                                          byte[] ivBytes)\n+    private Cipher getInitializedDes(boolean encryptMode, byte[] key,\n+                                     byte[] ivBytes)\n@@ -964,1 +960,1 @@\n-            SecretKey jceKey = (SecretKey) (new SecretKeySpec(key, \"DES\"));\n+            SecretKey jceKey = new SecretKeySpec(key, \"DES\");\n@@ -989,1 +985,1 @@\n-     * should be writte\n+     * should be written\n@@ -1080,2 +1076,2 @@\n-     * should be writte\n-     * @param dataOffset the offser where the application data should\n+     * should be written\n+     * @param dataOffset the offset where the application data should\n@@ -1090,1 +1086,1 @@\n-        int temp = 0;\n+        int temp;\n@@ -1095,1 +1091,1 @@\n-            new WrapTokenInputStream(is, len);\n+                new WrapTokenInputStream(is, len);\n@@ -1422,1 +1418,1 @@\n-        byte[] ptext = null;\n+        byte[] ptext;\n@@ -1459,1 +1455,1 @@\n-        byte[] ptext = null;\n+        byte[] ptext;\n@@ -1636,1 +1632,1 @@\n-    class WrapTokenInputStream extends InputStream {\n+    static class WrapTokenInputStream extends InputStream {\n@@ -1638,2 +1634,2 @@\n-        private InputStream is;\n-        private int length;\n+        private final InputStream is;\n+        private final int length;\n","filename":"src\/java.security.jgss\/share\/classes\/sun\/security\/jgss\/krb5\/CipherHelper.java","additions":22,"deletions":26,"binary":false,"changes":48,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2000, 2018, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2000, 2022, Oracle and\/or its affiliates. All rights reserved.\n@@ -42,1 +42,1 @@\n-    \/\/ initiator. In this case, the initiator and acceptor should has an\n+    \/\/ initiator. In this case, the initiator and acceptor should have an\n@@ -67,1 +67,1 @@\n-    private KrbApReq apReq = null;\n+    private final KrbApReq apReq;\n@@ -101,1 +101,1 @@\n-        context.resetMySequenceNumber(apReq.getSeqNumber().intValue());\n+        context.resetMySequenceNumber(apReq.getSeqNumber());\n@@ -112,1 +112,1 @@\n-                    ? apReq.getSeqNumber().intValue()\n+                    ? apReq.getSeqNumber()\n@@ -175,2 +175,1 @@\n-                             apReqSeqNumber.intValue() :\n-                             0);\n+                apReqSeqNumber : 0);\n","filename":"src\/java.security.jgss\/share\/classes\/sun\/security\/jgss\/krb5\/InitSecContextToken.java","additions":6,"deletions":7,"binary":false,"changes":13,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2000, 2021, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2000, 2022, Oracle and\/or its affiliates. All rights reserved.\n@@ -71,1 +71,1 @@\n-        private byte[] checksumBytes = null;\n+        private final byte[] checksumBytes;\n@@ -108,1 +108,1 @@\n-                KrbCred krbCred = null;\n+                KrbCred krbCred;\n@@ -220,2 +220,0 @@\n-            int pos = 0;\n-\n@@ -299,1 +297,0 @@\n-            boolean flag = true;\n@@ -301,4 +298,1 @@\n-            if ((ch.getProto() == 1) || ch.isArcFour()) {\n-                flag = false;\n-            }\n-            return flag;\n+            return (ch.getProto() != 1) && !ch.isArcFour();\n","filename":"src\/java.security.jgss\/share\/classes\/sun\/security\/jgss\/krb5\/InitialToken.java","additions":4,"deletions":10,"binary":false,"changes":14,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2000, 2021, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2000, 2022, Oracle and\/or its affiliates. All rights reserved.\n@@ -67,1 +67,1 @@\n-        ServiceCreds creds = null;\n+        ServiceCreds creds;\n@@ -181,1 +181,1 @@\n-     * service must starts as an initiator to get an initial TGT to complete\n+     * service must start as an initiator to get an initial TGT to complete\n","filename":"src\/java.security.jgss\/share\/classes\/sun\/security\/jgss\/krb5\/Krb5AcceptCredential.java","additions":3,"deletions":3,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2000, 2021, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2000, 2022, Oracle and\/or its affiliates. All rights reserved.\n@@ -38,5 +38,1 @@\n-import java.security.Provider;\n-import java.security.AccessController;\n-import java.security.Key;\n-import java.security.PrivilegedActionException;\n-import java.security.PrivilegedExceptionAction;\n+import java.security.*;\n@@ -91,1 +87,0 @@\n-    private int peerSeqNumber;\n@@ -106,2 +101,2 @@\n-    private Object mySeqNumberLock = new Object();\n-    private Object peerSeqNumberLock = new Object();\n+    private final Object mySeqNumberLock = new Object();\n+    private final Object peerSeqNumberLock = new Object();\n@@ -113,1 +108,1 @@\n-    private boolean initiator;\n+    private final boolean initiator;\n@@ -369,1 +364,1 @@\n-         EncryptionKey cipherKey = null;\n+         EncryptionKey cipherKey;\n@@ -402,2 +397,1 @@\n-            peerSeqNumber = seqNumber;\n-            peerTokenTracker = new TokenTracker(peerSeqNumber);\n+            peerTokenTracker = new TokenTracker(seqNumber);\n@@ -418,1 +412,1 @@\n-    private final EncryptionKey getKey() {\n+    private EncryptionKey getKey() {\n@@ -710,5 +704,1 @@\n-                                new java.security.PrivilegedAction<Subject>() {\n-                                    public Subject run() {\n-                                        return (Subject.current());\n-                                    }\n-                                });\n+                                        (PrivilegedAction<Subject>) Subject::current);\n@@ -728,6 +718,4 @@\n-                                    new java.security.PrivilegedAction<Void>() {\n-                                      public Void run() {\n-                                        subject.getPrivateCredentials().add(kt);\n-                                        return null;\n-                                      }\n-                                    });\n+                                        (PrivilegedAction<Void>) () -> {\n+                                          subject.getPrivateCredentials().add(kt);\n+                                          return null;\n+                                        });\n@@ -907,1 +895,1 @@\n-     * care about the local sequence number (mySeqNumber) where are unwrap\n+     * care about the local sequence number (mySeqNumber) whereas unwrap\n@@ -941,1 +929,0 @@\n-            encToken = null;\n@@ -975,1 +962,0 @@\n-            retVal = 0;\n@@ -1190,1 +1176,0 @@\n-            retVal = 0;\n@@ -1199,1 +1184,1 @@\n-     * Checksum calculation requires a byte[]. Hence might as well pass\n+     * Checksum calculation requires a byte[]. Hence, might as well pass\n@@ -1388,1 +1373,1 @@\n-        \/\/ Currently used by InitialToken only\n+        \/\/ Currently, used by InitialToken only\n","filename":"src\/java.security.jgss\/share\/classes\/sun\/security\/jgss\/krb5\/Krb5Context.java","additions":16,"deletions":31,"binary":false,"changes":47,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2000, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2000, 2022, Oracle and\/or its affiliates. All rights reserved.\n@@ -28,4 +28,1 @@\n-import org.ietf.jgss.*;\n-import sun.security.jgss.spi.*;\n-import sun.security.krb5.*;\n-import java.security.Provider;\n+import sun.security.jgss.spi.GSSCredentialSpi;\n","filename":"src\/java.security.jgss\/share\/classes\/sun\/security\/jgss\/krb5\/Krb5CredElement.java","additions":2,"deletions":5,"binary":false,"changes":7,"status":"modified"},{"patch":"@@ -34,0 +34,1 @@\n+import java.io.Serial;\n@@ -53,0 +54,1 @@\n+    @Serial\n@@ -56,1 +58,1 @@\n-    private Krb5NameElement name;\n+    private final Krb5NameElement name;\n@@ -58,1 +60,1 @@\n-    private Credentials krb5Credentials;\n+    private final Credentials krb5Credentials;\n@@ -201,2 +203,2 @@\n-         * all of the following data is optional in a KRB-CRED\n-         * messages. This check for each field.\n+         * All the following data is optional in a KRB-CRED\n+         * message. This check for each field.\n","filename":"src\/java.security.jgss\/share\/classes\/sun\/security\/jgss\/krb5\/Krb5InitCredential.java","additions":6,"deletions":4,"binary":false,"changes":10,"status":"modified"},{"patch":"@@ -57,1 +57,1 @@\n-    private static Oid[] nameTypes =\n+    private static final Oid[] nameTypes =\n@@ -217,1 +217,1 @@\n-    public final Oid getMechanismOid() {\n+    public Oid getMechanismOid() {\n","filename":"src\/java.security.jgss\/share\/classes\/sun\/security\/jgss\/krb5\/Krb5MechFactory.java","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -50,1 +50,1 @@\n-    private PrincipalName krb5PrincipalName;\n+    private final PrincipalName krb5PrincipalName;\n@@ -52,2 +52,2 @@\n-    private String gssNameStr = null;\n-    private Oid gssNameType = null;\n+    private final String gssNameStr;\n+    private final Oid gssNameType;\n@@ -85,1 +85,1 @@\n-                                       gssNameType.toString()\n+                                       gssNameType\n@@ -188,1 +188,1 @@\n-            StringBuffer temp = new StringBuffer(serviceName);\n+            StringBuilder temp = new StringBuilder(serviceName);\n@@ -202,1 +202,1 @@\n-            temp = temp.append('\/').append(hostName);\n+            temp.append('\/').append(hostName);\n@@ -225,3 +225,2 @@\n-        if (other instanceof Krb5NameElement) {\n-                Krb5NameElement that = (Krb5NameElement) other;\n-                return (this.krb5PrincipalName.getName().equals(\n+        if (other instanceof Krb5NameElement that) {\n+            return (this.krb5PrincipalName.getName().equals(\n","filename":"src\/java.security.jgss\/share\/classes\/sun\/security\/jgss\/krb5\/Krb5NameElement.java","additions":8,"deletions":9,"binary":false,"changes":17,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2003, 2021, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2003, 2022, Oracle and\/or its affiliates. All rights reserved.\n@@ -147,1 +147,1 @@\n-    };\n+    }\n","filename":"src\/java.security.jgss\/share\/classes\/sun\/security\/jgss\/krb5\/Krb5Util.java","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2000, 2015, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2000, 2022, Oracle and\/or its affiliates. All rights reserved.\n@@ -68,1 +68,1 @@\n- * As always, this is preceeded by a GSSHeader.\n+ * As always, this is preceded by a GSSHeader.\n@@ -144,1 +144,1 @@\n-     * in the array than needed, the extra bytes are simply ignroed.\n+     * in the array than needed, the extra bytes are simply ignored.\n@@ -397,5 +397,4 @@\n-            if ((seqNumberData[4] == directionByte) &&\n-                  (seqNumberData[5] == directionByte) &&\n-                  (seqNumberData[6] == directionByte) &&\n-                  (seqNumberData[7] == directionByte))\n-                return true;\n+            return (seqNumberData[4] == directionByte) &&\n+                    (seqNumberData[5] == directionByte) &&\n+                    (seqNumberData[6] == directionByte) &&\n+                    (seqNumberData[7] == directionByte);\n@@ -409,1 +408,1 @@\n-        int sequenceNum = 0;\n+        int sequenceNum;\n@@ -539,1 +538,1 @@\n-     * Obtains the conext key that is associated with this token.\n+     * Obtains the context key associated with this token.\n@@ -589,3 +588,3 @@\n-         private int tokenId;\n-         private int signAlg;\n-         private int sealAlg;\n+         private final int tokenId;\n+         private final int signAlg;\n+         private final int sealAlg;\n@@ -593,1 +592,1 @@\n-         private byte[] bytes = new byte[8];\n+         private final byte[] bytes = new byte[8];\n@@ -600,1 +599,1 @@\n-         * @param conf true if confidentiality will be resuested with this\n+         * @param conf true if confidentiality will be requested with this\n","filename":"src\/java.security.jgss\/share\/classes\/sun\/security\/jgss\/krb5\/MessageToken.java","additions":14,"deletions":15,"binary":false,"changes":29,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2004, 2018, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2004, 2022, Oracle and\/or its affiliates. All rights reserved.\n@@ -28,1 +28,5 @@\n-import org.ietf.jgss.*;\n+import org.ietf.jgss.GSSException;\n+import org.ietf.jgss.MessageProp;\n+\n+import java.io.ByteArrayInputStream;\n+import java.io.IOException;\n@@ -31,3 +35,0 @@\n-import java.io.IOException;\n-import java.io.ByteArrayInputStream;\n-import java.io.ByteArrayOutputStream;\n@@ -502,2 +503,2 @@\n-        private int tokenId;\n-        private byte[] bytes = new byte[TOKEN_HEADER_SIZE];\n+        private final int tokenId;\n+        private final byte[] bytes = new byte[TOKEN_HEADER_SIZE];\n@@ -514,1 +515,1 @@\n-            int flags = 0;\n+            int flags;\n@@ -579,6 +580,2 @@\n-            if ((conf_flag == FLAG_WRAP_CONFIDENTIAL) &&\n-                (tokenId == WRAP_ID_v2)) {\n-                prop.setPrivacy(true);\n-            } else {\n-                prop.setPrivacy(false);\n-            }\n+            prop.setPrivacy((conf_flag == FLAG_WRAP_CONFIDENTIAL) &&\n+                    (tokenId == WRAP_ID_v2));\n","filename":"src\/java.security.jgss\/share\/classes\/sun\/security\/jgss\/krb5\/MessageToken_v2.java","additions":11,"deletions":14,"binary":false,"changes":25,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2000, 2006, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2000, 2022, Oracle and\/or its affiliates. All rights reserved.\n@@ -28,5 +28,3 @@\n-import org.ietf.jgss.*;\n-import java.io.InputStream;\n-import java.io.OutputStream;\n-import java.io.IOException;\n-import java.io.ByteArrayInputStream;\n+import org.ietf.jgss.GSSException;\n+import org.ietf.jgss.MessageProp;\n+\n@@ -34,0 +32,2 @@\n+import java.io.IOException;\n+import java.io.InputStream;\n@@ -57,1 +57,1 @@\n-    byte[] dataBytes = null;\n+    byte[] dataBytes;\n","filename":"src\/java.security.jgss\/share\/classes\/sun\/security\/jgss\/krb5\/MicToken.java","additions":7,"deletions":7,"binary":false,"changes":14,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2004, 2010, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2004, 2022, Oracle and\/or its affiliates. All rights reserved.\n@@ -65,1 +65,1 @@\n-        byte[] dataBytes = null;\n+        byte[] dataBytes;\n","filename":"src\/java.security.jgss\/share\/classes\/sun\/security\/jgss\/krb5\/MicToken_v2.java","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2012, 2013, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2012, 2022, Oracle and\/or its affiliates. All rights reserved.\n@@ -39,0 +39,1 @@\n+import java.util.Collections;\n@@ -204,3 +205,1 @@\n-            for (KerberosKey k: ktab.getKeys(princ)) {\n-                keys.add(k);\n-            }\n+            Collections.addAll(keys, ktab.getKeys(princ));\n@@ -208,1 +207,1 @@\n-        return keys.toArray(new KerberosKey[keys.size()]);\n+        return keys.toArray(new KerberosKey[0]);\n","filename":"src\/java.security.jgss\/share\/classes\/sun\/security\/jgss\/krb5\/ServiceCreds.java","additions":4,"deletions":5,"binary":false,"changes":9,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2002, 2019, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2002, 2022, Oracle and\/or its affiliates. All rights reserved.\n@@ -89,1 +89,1 @@\n-            List<T> answer = (oneOnly ? null : new ArrayList<T>());\n+            List<T> answer = (oneOnly ? null : new ArrayList<>());\n@@ -154,1 +154,2 @@\n-                        if (!(obj instanceof KerberosTicket)) {\n+                        if (!(obj instanceof @SuppressWarnings(\"unchecked\")\n+                                KerberosTicket ticket)) {\n@@ -157,2 +158,0 @@\n-                        @SuppressWarnings(\"unchecked\")\n-                        KerberosTicket ticket = (KerberosTicket)obj;\n@@ -184,1 +183,1 @@\n-                                                \" detroyed successfully. \" + dfe);\n+                                                \" destroyed successfully. \" + dfe);\n","filename":"src\/java.security.jgss\/share\/classes\/sun\/security\/jgss\/krb5\/SubjectComber.java","additions":5,"deletions":6,"binary":false,"changes":11,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2000, 2010, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2000, 2022, Oracle and\/or its affiliates. All rights reserved.\n@@ -77,1 +77,1 @@\n-     * it's data only later when getData() is called and\n+     * its data only later when getData() is called and\n@@ -99,1 +99,1 @@\n-    private int dataSize = 0;\n+    private final int dataSize;\n@@ -105,1 +105,1 @@\n-    private boolean privacy = false;\n+    private final boolean privacy;\n@@ -306,2 +306,0 @@\n-        GSSHeader gssHeader = getGSSHeader();\n-\n@@ -388,1 +386,1 @@\n-        int padSize = 0;\n+        int padSize;\n","filename":"src\/java.security.jgss\/share\/classes\/sun\/security\/jgss\/krb5\/WrapToken.java","additions":5,"deletions":7,"binary":false,"changes":12,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2004, 2010, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2004, 2022, Oracle and\/or its affiliates. All rights reserved.\n@@ -223,1 +223,1 @@\n-    \/\/ This implementation is way to conservative. And it certainly\n+    \/\/ This implementation is way too conservative. And it certainly\n","filename":"src\/java.security.jgss\/share\/classes\/sun\/security\/jgss\/krb5\/WrapToken_v2.java","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2000, 2013, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2000, 2022, Oracle and\/or its affiliates. All rights reserved.\n@@ -84,1 +84,1 @@\n- * this, however we have accomodated those cases here with the expectation\n+ * this, however we have accommodated those cases here with the expectation\n@@ -92,1 +92,1 @@\n-    public Provider getProvider();\n+    Provider getProvider();\n@@ -98,1 +98,1 @@\n-    public void requestLifetime(int lifetime) throws GSSException;\n+    void requestLifetime(int lifetime) throws GSSException;\n@@ -100,1 +100,1 @@\n-    public void requestMutualAuth(boolean state) throws GSSException;\n+    void requestMutualAuth(boolean state) throws GSSException;\n@@ -102,1 +102,1 @@\n-    public void requestReplayDet(boolean state) throws GSSException;\n+    void requestReplayDet(boolean state) throws GSSException;\n@@ -104,1 +104,1 @@\n-    public void requestSequenceDet(boolean state) throws GSSException;\n+    void requestSequenceDet(boolean state) throws GSSException;\n@@ -106,1 +106,1 @@\n-    public void requestCredDeleg(boolean state) throws GSSException;\n+    void requestCredDeleg(boolean state) throws GSSException;\n@@ -108,1 +108,1 @@\n-    public void requestAnonymity(boolean state) throws GSSException;\n+    void requestAnonymity(boolean state) throws GSSException;\n@@ -110,1 +110,1 @@\n-    public void requestConf(boolean state) throws GSSException;\n+    void requestConf(boolean state) throws GSSException;\n@@ -112,1 +112,1 @@\n-    public void requestInteg(boolean state) throws GSSException;\n+    void requestInteg(boolean state) throws GSSException;\n@@ -114,1 +114,1 @@\n-    public void requestDelegPolicy(boolean state) throws GSSException;\n+    void requestDelegPolicy(boolean state) throws GSSException;\n@@ -116,1 +116,1 @@\n-    public void setChannelBinding(ChannelBinding cb) throws GSSException;\n+    void setChannelBinding(ChannelBinding cb) throws GSSException;\n@@ -118,1 +118,1 @@\n-    public boolean getCredDelegState();\n+    boolean getCredDelegState();\n@@ -120,1 +120,1 @@\n-    public boolean getMutualAuthState();\n+    boolean getMutualAuthState();\n@@ -122,1 +122,1 @@\n-    public boolean getReplayDetState();\n+    boolean getReplayDetState();\n@@ -124,1 +124,1 @@\n-    public boolean getSequenceDetState();\n+    boolean getSequenceDetState();\n@@ -126,1 +126,1 @@\n-    public boolean getAnonymityState();\n+    boolean getAnonymityState();\n@@ -128,1 +128,1 @@\n-    public boolean getDelegPolicyState();\n+    boolean getDelegPolicyState();\n@@ -130,1 +130,1 @@\n-    public boolean isTransferable() throws GSSException;\n+    boolean isTransferable() throws GSSException;\n@@ -132,1 +132,1 @@\n-    public boolean isProtReady();\n+    boolean isProtReady();\n@@ -134,1 +134,1 @@\n-    public boolean isInitiator();\n+    boolean isInitiator();\n@@ -136,1 +136,1 @@\n-    public boolean getConfState();\n+    boolean getConfState();\n@@ -138,1 +138,1 @@\n-    public boolean getIntegState();\n+    boolean getIntegState();\n@@ -140,1 +140,1 @@\n-    public int getLifetime();\n+    int getLifetime();\n@@ -142,1 +142,1 @@\n-    public boolean isEstablished();\n+    boolean isEstablished();\n@@ -144,1 +144,1 @@\n-    public GSSNameSpi getSrcName() throws GSSException;\n+    GSSNameSpi getSrcName() throws GSSException;\n@@ -146,1 +146,1 @@\n-    public GSSNameSpi getTargName() throws GSSException;\n+    GSSNameSpi getTargName() throws GSSException;\n@@ -148,1 +148,1 @@\n-    public Oid getMech() throws GSSException;\n+    Oid getMech() throws GSSException;\n@@ -150,1 +150,1 @@\n-    public GSSCredentialSpi getDelegCred() throws GSSException;\n+    GSSCredentialSpi getDelegCred() throws GSSException;\n@@ -164,1 +164,1 @@\n-     * from this method is a fixed size, not exeedingly large, and a one\n+     * from this method is a fixed size, not exceedingly large, and a one\n@@ -166,1 +166,1 @@\n-     * been defined. The GSS-Framwork can write the returned byte[] to any\n+     * been defined. The GSS-Framework can write the returned byte[] to any\n@@ -168,1 +168,1 @@\n-     * int he form of byte arrays will be wrapped in an input stream by the\n+     * in the form of byte arrays will be wrapped in an input stream by the\n@@ -190,1 +190,1 @@\n-    public byte[] initSecContext(InputStream is, int mechTokenSize)\n+    byte[] initSecContext(InputStream is, int mechTokenSize)\n@@ -205,1 +205,1 @@\n-     * from this method is a fixed size, not exeedingly large, and a one\n+     * from this method is a fixed size, not exceedingly large, and a one\n@@ -207,1 +207,1 @@\n-     * been defined. The GSS-Framwork can write the returned byte[] to any\n+     * been defined. The GSS-Framework can write the returned byte[] to any\n@@ -209,1 +209,1 @@\n-     * int he form of byte arrays will be wrapped in an input stream by the\n+     * in the form of byte arrays will be wrapped in an input stream by the\n@@ -230,1 +230,1 @@\n-    public byte[] acceptSecContext(InputStream is, int mechTokenSize)\n+    byte[] acceptSecContext(InputStream is, int mechTokenSize)\n@@ -235,1 +235,1 @@\n-     * the specified protection and for the token to remain less then\n+     * the specified protection and for the token to remain less than\n@@ -248,1 +248,1 @@\n-    public int getWrapSizeLimit(int qop, boolean confReq, int maxTokSize)\n+    int getWrapSizeLimit(int qop, boolean confReq, int maxTokSize)\n@@ -255,1 +255,1 @@\n-     * @param os the token to be sent to the peer. It includes\n+     * @param is the token to be sent to the peer. It includes\n@@ -257,1 +257,1 @@\n-     * @param msgProp on input it contains the requested qop and\n+     * @param msgProp on input, contains the requested qop and\n@@ -262,1 +262,1 @@\n-    public void wrap(InputStream is, OutputStream os, MessageProp msgProp)\n+    void wrap(InputStream is, OutputStream os, MessageProp msgProp)\n@@ -268,2 +268,2 @@\n-    public byte[] wrap(byte[] inBuf, int offset, int len,\n-                       MessageProp msgProp) throws GSSException;\n+    byte[] wrap(byte[] inBuf, int offset, int len,\n+                MessageProp msgProp) throws GSSException;\n@@ -311,2 +311,2 @@\n-    public void unwrap(InputStream is, OutputStream os,\n-                        MessageProp msgProp) throws GSSException;\n+    void unwrap(InputStream is, OutputStream os,\n+                MessageProp msgProp) throws GSSException;\n@@ -317,2 +317,2 @@\n-    public byte[] unwrap(byte[] inBuf, int offset, int len,\n-                         MessageProp msgProp) throws GSSException;\n+    byte[] unwrap(byte[] inBuf, int offset, int len,\n+                  MessageProp msgProp) throws GSSException;\n@@ -355,2 +355,2 @@\n-    public void getMIC(InputStream is, OutputStream os,\n-                        MessageProp msgProp)\n+    void getMIC(InputStream is, OutputStream os,\n+                MessageProp msgProp)\n@@ -359,2 +359,2 @@\n-    public byte[] getMIC(byte[] inMsg, int offset, int len,\n-                         MessageProp msgProp) throws GSSException;\n+    byte[] getMIC(byte[] inMsg, int offset, int len,\n+                  MessageProp msgProp) throws GSSException;\n@@ -372,2 +372,2 @@\n-    public void verifyMIC(InputStream is, InputStream msgStr,\n-                           MessageProp mProp) throws GSSException;\n+    void verifyMIC(InputStream is, InputStream msgStr,\n+                   MessageProp mProp) throws GSSException;\n@@ -375,3 +375,3 @@\n-    public void verifyMIC(byte[] inTok, int tokOffset, int tokLen,\n-                          byte[] inMsg, int msgOffset, int msgLen,\n-                          MessageProp msgProp) throws GSSException;\n+    void verifyMIC(byte[] inTok, int tokOffset, int tokLen,\n+                   byte[] inMsg, int msgOffset, int msgLen,\n+                   MessageProp msgProp) throws GSSException;\n@@ -387,1 +387,1 @@\n-    public byte[] export() throws GSSException;\n+    byte[] export() throws GSSException;\n@@ -395,1 +395,1 @@\n-    public void dispose() throws GSSException;\n+    void dispose() throws GSSException;\n@@ -405,1 +405,1 @@\n-    public Object inquireSecContext(String type)\n+    Object inquireSecContext(String type)\n","filename":"src\/java.security.jgss\/share\/classes\/sun\/security\/jgss\/spi\/GSSContextSpi.java","additions":61,"deletions":61,"binary":false,"changes":122,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2000, 2012, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2000, 2022, Oracle and\/or its affiliates. All rights reserved.\n@@ -40,1 +40,1 @@\n-    public Provider getProvider();\n+    Provider getProvider();\n@@ -49,1 +49,1 @@\n-    public void dispose() throws GSSException;\n+    void dispose() throws GSSException;\n@@ -58,1 +58,1 @@\n-    public GSSNameSpi getName() throws GSSException;\n+    GSSNameSpi getName() throws GSSException;\n@@ -66,1 +66,1 @@\n-    public int getInitLifetime() throws GSSException;\n+    int getInitLifetime() throws GSSException;\n@@ -75,1 +75,1 @@\n-    public int getAcceptLifetime() throws GSSException;\n+    int getAcceptLifetime() throws GSSException;\n@@ -82,1 +82,1 @@\n-    public boolean isInitiatorCredential() throws GSSException;\n+    boolean isInitiatorCredential() throws GSSException;\n@@ -89,1 +89,1 @@\n-    public boolean isAcceptorCredential() throws GSSException;\n+    boolean isAcceptorCredential() throws GSSException;\n@@ -98,1 +98,1 @@\n-    public Oid getMechanism();\n+    Oid getMechanism();\n@@ -107,1 +107,1 @@\n-    public GSSCredentialSpi impersonate(GSSNameSpi name) throws GSSException;\n+    GSSCredentialSpi impersonate(GSSNameSpi name) throws GSSException;\n","filename":"src\/java.security.jgss\/share\/classes\/sun\/security\/jgss\/spi\/GSSCredentialSpi.java","additions":10,"deletions":10,"binary":false,"changes":20,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2000, 2005, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2000, 2022, Oracle and\/or its affiliates. All rights reserved.\n@@ -41,1 +41,1 @@\n-    public Provider getProvider();\n+    Provider getProvider();\n@@ -53,1 +53,1 @@\n-    public boolean equals(GSSNameSpi name) throws GSSException;\n+    boolean equals(GSSNameSpi name) throws GSSException;\n@@ -66,1 +66,1 @@\n-    public boolean equals(Object another);\n+    boolean equals(Object another);\n@@ -73,1 +73,1 @@\n-    public int hashCode();\n+    int hashCode();\n@@ -83,1 +83,1 @@\n-    public byte[] export() throws GSSException;\n+    byte[] export() throws GSSException;\n@@ -91,1 +91,1 @@\n-    public Oid getMechanism();\n+    Oid getMechanism();\n@@ -101,1 +101,1 @@\n-    public String toString();\n+    String toString();\n@@ -109,1 +109,1 @@\n-    public Oid getStringNameType();\n+    Oid getStringNameType();\n@@ -114,1 +114,1 @@\n-    public boolean isAnonymousName();\n+    boolean isAnonymousName();\n","filename":"src\/java.security.jgss\/share\/classes\/sun\/security\/jgss\/spi\/GSSNameSpi.java","additions":10,"deletions":10,"binary":false,"changes":20,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2000, 2006, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2000, 2022, Oracle and\/or its affiliates. All rights reserved.\n@@ -40,1 +40,1 @@\n- * e.g., If a provider master file contained the a mapping from the\n+ * e.g., If a provider master file contained a mapping from the\n@@ -56,1 +56,1 @@\n-    public Oid getMechanismOid();\n+    Oid getMechanismOid();\n@@ -62,1 +62,1 @@\n-    public Provider getProvider();\n+    Provider getProvider();\n@@ -72,1 +72,1 @@\n-    public Oid[] getNameTypes() throws GSSException;\n+    Oid[] getNameTypes() throws GSSException;\n@@ -105,1 +105,1 @@\n-     * ACCEPT_ONLY. Predefined contants are available in the\n+     * ACCEPT_ONLY. Predefined constants are available in the\n@@ -110,1 +110,1 @@\n-     * INITIATE_ONLY. Predefined contants are available in the\n+     * INITIATE_ONLY. Predefined constants are available in the\n@@ -118,2 +118,2 @@\n-    public GSSCredentialSpi getCredentialElement(GSSNameSpi name,\n-      int initLifetime, int acceptLifetime, int usage) throws GSSException;\n+    GSSCredentialSpi getCredentialElement(GSSNameSpi name,\n+        int initLifetime, int acceptLifetime, int usage) throws GSSException;\n@@ -137,1 +137,1 @@\n-    public GSSNameSpi getNameElement(String nameStr, Oid nameType)\n+    GSSNameSpi getNameElement(String nameStr, Oid nameType)\n@@ -156,1 +156,1 @@\n-    public GSSNameSpi getNameElement(byte[] name, Oid nameType)\n+    GSSNameSpi getNameElement(byte[] name, Oid nameType)\n@@ -172,1 +172,1 @@\n-     * context. Predefined contants are available in the\n+     * context. Predefined constants are available in the\n@@ -177,3 +177,3 @@\n-    public GSSContextSpi getMechanismContext(GSSNameSpi peer,\n-                                             GSSCredentialSpi myInitiatorCred,\n-                                             int lifetime) throws GSSException;\n+    GSSContextSpi getMechanismContext(GSSNameSpi peer,\n+                                      GSSCredentialSpi myInitiatorCred,\n+                                      int lifetime) throws GSSException;\n@@ -182,1 +182,1 @@\n-     * Creates a security context for this mechanism so thatit can be used\n+     * Creates a security context for this mechanism so that it can be used\n@@ -195,1 +195,1 @@\n-    public GSSContextSpi getMechanismContext(GSSCredentialSpi myAcceptorCred)\n+    GSSContextSpi getMechanismContext(GSSCredentialSpi myAcceptorCred)\n@@ -211,1 +211,1 @@\n-    public GSSContextSpi getMechanismContext(byte[] exportedContext)\n+    GSSContextSpi getMechanismContext(byte[] exportedContext)\n","filename":"src\/java.security.jgss\/share\/classes\/sun\/security\/jgss\/spi\/MechanismFactory.java","additions":18,"deletions":18,"binary":false,"changes":36,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2005, 2011, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2005, 2022, Oracle and\/or its affiliates. All rights reserved.\n@@ -28,4 +28,3 @@\n-import java.io.*;\n-import java.util.*;\n-import org.ietf.jgss.*;\n-import sun.security.jgss.*;\n+import org.ietf.jgss.GSSException;\n+import org.ietf.jgss.Oid;\n+import sun.security.jgss.GSSUtil;\n@@ -34,0 +33,2 @@\n+import java.io.IOException;\n+\n@@ -168,1 +169,1 @@\n-                    ObjectIdentifier mech = null;\n+                    ObjectIdentifier mech;\n","filename":"src\/java.security.jgss\/share\/classes\/sun\/security\/jgss\/spnego\/NegTokenInit.java","additions":7,"deletions":6,"binary":false,"changes":13,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2005, 2021, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2005, 2022, Oracle and\/or its affiliates. All rights reserved.\n@@ -30,0 +30,2 @@\n+import java.util.Objects;\n+\n@@ -69,1 +71,1 @@\n-    private SpNegoCredElement myCred = null;\n+    private final SpNegoCredElement myCred;\n@@ -76,1 +78,1 @@\n-    private boolean initiator;\n+    private final boolean initiator;\n@@ -288,1 +290,1 @@\n-        NegTokenInit initToken = null;\n+        NegTokenInit initToken;\n@@ -585,1 +587,0 @@\n-                    negoResult = SpNegoToken.NegoResult.REJECT;\n@@ -645,1 +646,0 @@\n-                    negoResult = SpNegoToken.NegoResult.REJECT;\n@@ -699,1 +699,1 @@\n-     * get ther DER encoded MechList\n+     * get the DER encoded MechList\n@@ -712,2 +712,1 @@\n-        byte[] encoded = mechTypeList.toByteArray();\n-        return encoded;\n+        return mechTypeList.toByteArray();\n@@ -733,1 +732,1 @@\n-    \/\/ are already set at request. For those that might get chanegd,\n+    \/\/ are already set at request. For those that might get changed,\n@@ -827,1 +826,1 @@\n-        boolean valid = false;\n+        boolean valid;\n@@ -847,1 +846,1 @@\n-        byte[] tok = null;\n+        byte[] tok;\n@@ -877,5 +876,1 @@\n-        if (token != null) {\n-            tok = token;\n-        } else {\n-            tok = new byte[0];\n-        }\n+        tok = Objects.requireNonNullElseGet(token, () -> new byte[0]);\n@@ -914,1 +909,1 @@\n-     * This routine compares the recieved mechset to the mechset that\n+     * This routine compares the received mechset to the mechset that\n@@ -1102,4 +1097,1 @@\n-            boolean initiate = false;\n-            if (delegCred.getUsage() == GSSCredential.INITIATE_ONLY) {\n-                initiate = true;\n-            }\n+            boolean initiate = delegCred.getUsage() == GSSCredential.INITIATE_ONLY;\n@@ -1126,1 +1118,1 @@\n-    public final byte[] wrap(byte inBuf[], int offset, int len,\n+    public final byte[] wrap(byte[] inBuf, int offset, int len,\n@@ -1147,1 +1139,1 @@\n-    public final byte[] unwrap(byte inBuf[], int offset, int len,\n+    public final byte[] unwrap(byte[] inBuf, int offset, int len,\n","filename":"src\/java.security.jgss\/share\/classes\/sun\/security\/jgss\/spnego\/SpNegoContext.java","additions":16,"deletions":24,"binary":false,"changes":40,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2005, 2013, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2005, 2022, Oracle and\/or its affiliates. All rights reserved.\n@@ -43,1 +43,1 @@\n-    private GSSCredentialSpi cred = null;\n+    private final GSSCredentialSpi cred;\n","filename":"src\/java.security.jgss\/share\/classes\/sun\/security\/jgss\/spnego\/SpNegoCredElement.java","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2005, 2009, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2005, 2022, Oracle and\/or its affiliates. All rights reserved.\n@@ -55,1 +55,1 @@\n-    private static Oid[] nameTypes =\n+    private static final Oid[] nameTypes =\n@@ -185,1 +185,1 @@\n-    public final Oid getMechanismOid() {\n+    public Oid getMechanismOid() {\n","filename":"src\/java.security.jgss\/share\/classes\/sun\/security\/jgss\/spnego\/SpNegoMechFactory.java","additions":3,"deletions":3,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2005, 2020, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2005, 2022, Oracle and\/or its affiliates. All rights reserved.\n@@ -28,5 +28,7 @@\n-import java.io.*;\n-import java.util.*;\n-import org.ietf.jgss.*;\n-import sun.security.util.*;\n-import sun.security.jgss.*;\n+import org.ietf.jgss.GSSException;\n+import sun.security.jgss.GSSToken;\n+import sun.security.util.DerOutputStream;\n+import sun.security.util.DerValue;\n+import sun.security.util.ObjectIdentifier;\n+\n+import java.io.IOException;\n@@ -35,1 +37,1 @@\n- * Astract class for SPNEGO tokens.\n+ * Abstract class for SPNEGO tokens.\n@@ -52,1 +54,1 @@\n-    static enum NegoResult {\n+    enum NegoResult {\n@@ -56,1 +58,1 @@\n-    };\n+    }\n@@ -58,1 +60,1 @@\n-    private int tokenType;\n+    private final int tokenType;\n@@ -152,20 +154,0 @@\n-    \/**\n-     * Returns the enumerated type of the Negotiation result.\n-     *\n-     * @param result the negotiated result represented by integer\n-     * @return the enumerated type of Negotiated result\n-     *\/\n-    static NegoResult getNegoResultType(int result) {\n-        switch (result) {\n-        case 0:\n-                return NegoResult.ACCEPT_COMPLETE;\n-        case 1:\n-                return NegoResult.ACCEPT_INCOMPLETE;\n-        case 2:\n-                return NegoResult.REJECT;\n-        default:\n-                \/\/ unknown - return optimistic result\n-                return NegoResult.ACCEPT_COMPLETE;\n-        }\n-    }\n-\n","filename":"src\/java.security.jgss\/share\/classes\/sun\/security\/jgss\/spnego\/SpNegoToken.java","additions":12,"deletions":30,"binary":false,"changes":42,"status":"modified"},{"patch":"@@ -43,1 +43,1 @@\n-    private int usage;\n+    private final int usage;\n@@ -45,1 +45,1 @@\n-    private GSSNameElement name = null;\n+    private GSSNameElement name;\n","filename":"src\/java.security.jgss\/share\/classes\/sun\/security\/jgss\/wrapper\/GSSCredElement.java","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2005, 2019, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2005, 2022, Oracle and\/or its affiliates. All rights reserved.\n@@ -28,3 +28,0 @@\n-import java.util.Hashtable;\n-import org.ietf.jgss.Oid;\n-import org.ietf.jgss.GSSName;\n@@ -32,1 +29,0 @@\n-import org.ietf.jgss.MessageProp;\n@@ -34,1 +30,4 @@\n-import sun.security.jgss.GSSUtil;\n+import org.ietf.jgss.MessageProp;\n+import org.ietf.jgss.Oid;\n+\n+import java.util.Hashtable;\n@@ -45,1 +44,1 @@\n-    private Oid mech;\n+    private final Oid mech;\n@@ -97,2 +96,2 @@\n-    private static Hashtable<Oid, GSSLibStub>\n-        table = new Hashtable<Oid, GSSLibStub>(5);\n+    private static final Hashtable<Oid, GSSLibStub>\n+        table = new Hashtable<>(5);\n","filename":"src\/java.security.jgss\/share\/classes\/sun\/security\/jgss\/wrapper\/GSSLibStub.java","additions":8,"deletions":9,"binary":false,"changes":17,"status":"modified"},{"patch":"@@ -28,6 +28,4 @@\n-import org.ietf.jgss.*;\n-import java.lang.ref.Cleaner;\n-import java.security.Provider;\n-import java.security.Security;\n-import java.io.IOException;\n-import sun.security.krb5.Realm;\n+import org.ietf.jgss.GSSException;\n+import org.ietf.jgss.GSSName;\n+import org.ietf.jgss.Oid;\n+import sun.security.jgss.GSSExceptionImpl;\n@@ -35,1 +33,2 @@\n-import sun.security.util.ObjectIdentifier;\n+import sun.security.jgss.spi.GSSNameSpi;\n+import sun.security.krb5.Realm;\n@@ -38,3 +37,1 @@\n-import sun.security.jgss.GSSUtil;\n-import sun.security.jgss.GSSExceptionImpl;\n-import sun.security.jgss.spi.GSSNameSpi;\n+import sun.security.util.ObjectIdentifier;\n@@ -43,0 +40,3 @@\n+import java.io.IOException;\n+import java.lang.ref.Cleaner;\n+import java.security.Provider;\n@@ -136,1 +136,1 @@\n-                byte[] mechBytes = null;\n+                byte[] mechBytes;\n@@ -193,1 +193,1 @@\n-        Object[] printables = null;\n+        Object[] printables;\n@@ -206,1 +206,1 @@\n-        long mName = 0;\n+        long mName;\n@@ -256,1 +256,1 @@\n-        ObjectIdentifier temp = null;\n+        ObjectIdentifier temp;\n","filename":"src\/java.security.jgss\/share\/classes\/sun\/security\/jgss\/wrapper\/GSSNameElement.java","additions":14,"deletions":14,"binary":false,"changes":28,"status":"modified"},{"patch":"@@ -32,1 +32,1 @@\n- * This class is an utility class for Kerberos related stuff.\n+ * This class is a utility class for Kerberos related stuff.\n@@ -47,3 +47,1 @@\n-        StringBuilder sb = new StringBuilder(\"krbtgt\/\");\n-        sb.append(realm).append('@').append(realm);\n-        return sb.toString();\n+        return \"krbtgt\/\" + realm + '@' + realm;\n","filename":"src\/java.security.jgss\/share\/classes\/sun\/security\/jgss\/wrapper\/Krb5Util.java","additions":2,"deletions":4,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -68,1 +68,1 @@\n-    private boolean isInitiator;\n+    private final boolean isInitiator;\n@@ -92,1 +92,1 @@\n-            GSSHeader header = null;\n+            GSSHeader header;\n@@ -149,4 +149,2 @@\n-            StringBuilder sb = new StringBuilder(\"\\\"\");\n-            sb.append(targetStr).append(\"\\\" \\\"\");\n-            sb.append(tgsStr).append('\\\"');\n-            String krbPrincPair = sb.toString();\n+            String krbPrincPair = \"\\\"\" + targetStr + \"\\\" \\\"\" +\n+                    tgsStr + '\\\"';\n@@ -165,1 +163,1 @@\n-            byte[] result = null;\n+            byte[] result;\n@@ -464,1 +462,1 @@\n-        byte[] result = null;\n+        byte[] result;\n@@ -491,2 +489,2 @@\n-        byte[] wrapped = null;\n-        int wLength = 0;\n+        byte[] wrapped;\n+        int wLength;\n@@ -519,1 +517,1 @@\n-            int length = 0;\n+            int length;\n","filename":"src\/java.security.jgss\/share\/classes\/sun\/security\/jgss\/wrapper\/NativeGSSContext.java","additions":9,"deletions":11,"binary":false,"changes":20,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2005, 2019, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2005, 2022, Oracle and\/or its affiliates. All rights reserved.\n@@ -28,0 +28,10 @@\n+import org.ietf.jgss.GSSCredential;\n+import org.ietf.jgss.GSSException;\n+import org.ietf.jgss.Oid;\n+import sun.security.jgss.GSSCaller;\n+import sun.security.jgss.GSSUtil;\n+import sun.security.jgss.spi.GSSContextSpi;\n+import sun.security.jgss.spi.GSSCredentialSpi;\n+import sun.security.jgss.spi.GSSNameSpi;\n+import sun.security.jgss.spi.MechanismFactory;\n+\n@@ -30,5 +40,0 @@\n-import org.ietf.jgss.*;\n-import sun.security.jgss.GSSUtil;\n-import sun.security.jgss.GSSCaller;\n-import sun.security.jgss.GSSExceptionImpl;\n-import sun.security.jgss.spi.*;\n@@ -75,1 +80,1 @@\n-        \/\/ methods. Otherwise, NPE may be thrown unexpectantly\n+        \/\/ methods. Otherwise, NPE may be thrown unexpectedly\n@@ -99,1 +104,1 @@\n-        GSSNameElement nname = null;\n+        GSSNameElement nname;\n@@ -106,1 +111,1 @@\n-            \/\/ Force separate acqusition of cred element since\n+            \/\/ Force separate acquisition of cred element since\n@@ -140,2 +145,1 @@\n-            peer = (GSSNameElement)\n-                getNameElement(peer.toString(), peer.getStringNameType());\n+            peer = getNameElement(peer.toString(), peer.getStringNameType());\n@@ -168,1 +172,1 @@\n-    public final Oid getMechanismOid() {\n+    public Oid getMechanismOid() {\n","filename":"src\/java.security.jgss\/share\/classes\/sun\/security\/jgss\/wrapper\/NativeGSSFactory.java","additions":16,"deletions":12,"binary":false,"changes":28,"status":"modified"},{"patch":"@@ -28,0 +28,1 @@\n+import java.io.Serial;\n@@ -49,0 +50,1 @@\n+    @Serial\n","filename":"src\/java.security.jgss\/share\/classes\/sun\/security\/jgss\/wrapper\/SunNativeProvider.java","additions":2,"deletions":0,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -2,0 +2,1 @@\n+ * Copyright (c) 2022, Oracle and\/or its affiliates. All rights reserved.\n@@ -69,1 +70,1 @@\n-    private static boolean DEBUG = Krb5.DEBUG;\n+    private static final boolean DEBUG = Krb5.DEBUG;\n@@ -112,2 +113,1 @@\n-        int type, length, namelength, kret;\n-        String[] pname = null;\n+        int type, length, namelength;\n@@ -122,1 +122,1 @@\n-        List<String> result = new ArrayList<String>();\n+        List<String> result = new ArrayList<>();\n@@ -144,1 +144,1 @@\n-                    result.toArray(new String[result.size()]),\n+                    result.toArray(new String[0]),\n@@ -150,1 +150,1 @@\n-                    result.toArray(new String[result.size()]),\n+                    result.toArray(new String[0]),\n@@ -203,4 +203,1 @@\n-        if (read() == 0) {\n-            return false;\n-        }\n-        else return true;\n+        return read() != 0;\n@@ -228,1 +225,1 @@\n-            return addrs.toArray(new HostAddress[addrs.size()]);\n+            return addrs.toArray(new HostAddress[0]);\n@@ -238,1 +235,1 @@\n-            byte[] data = null;\n+            byte[] data;\n@@ -245,1 +242,1 @@\n-            return auData.toArray(new AuthorizationDataEntry[auData.size()]);\n+            return auData.toArray(new AuthorizationDataEntry[0]);\n@@ -332,1 +329,1 @@\n-     * bytes are consumed so it's safe to start reading the next element.\n+     * bytes are consumed, so it's safe to start reading the next element.\n@@ -334,1 +331,1 @@\n-    Object readCred(int version) throws IOException,RealmException, KrbApErrException, Asn1Exception {\n+    Object readCred(int version) throws IOException, RealmException, KrbApErrException, Asn1Exception {\n","filename":"src\/java.security.jgss\/share\/classes\/sun\/security\/krb5\/internal\/ccache\/CCacheInputStream.java","additions":12,"deletions":15,"binary":false,"changes":27,"status":"modified"},{"patch":"@@ -2,0 +2,1 @@\n+ * Copyright (c) 2022, Oracle and\/or its affiliates. All rights reserved.\n@@ -192,1 +193,1 @@\n-        \/\/ in TGS-REQ, therefore only stored with a service ticket. Currently\n+        \/\/ in TGS-REQ, therefore only stored with a service ticket. Currently,\n","filename":"src\/java.security.jgss\/share\/classes\/sun\/security\/krb5\/internal\/ccache\/Credentials.java","additions":2,"deletions":1,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -2,0 +2,1 @@\n+ * Copyright (c) 2022, Oracle and\/or its affiliates. All rights reserved.\n@@ -40,1 +41,1 @@\n- * CredentialsCache stores credentials(tickets, session keys, etc) in a semi-permanent store\n+ * CredentialsCache stores credentials(tickets, session keys, etc.) in a semi-permanent store\n@@ -46,1 +47,0 @@\n-    static CredentialsCache singleton = null;\n","filename":"src\/java.security.jgss\/share\/classes\/sun\/security\/krb5\/internal\/ccache\/CredentialsCache.java","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -2,0 +2,1 @@\n+ * Copyright (c) 2022, Oracle and\/or its affiliates. All rights reserved.\n@@ -46,17 +47,17 @@\n-    public final int KRB5_FCC_FVNO_1 = 0x501;\n-    public final int KRB5_FCC_FVNO_2 = 0x502;\n-    public final int KRB5_FCC_FVNO_3 = 0x503;\n-    public final int KRB5_FCC_FVNO_4 = 0x504;\n-    public final int FCC_TAG_DELTATIME = 1;\n-    public final int KRB5_NT_UNKNOWN = 0;\n-    public final int TKT_FLG_FORWARDABLE = 0x40000000;\n-    public final int TKT_FLG_FORWARDED  =  0x20000000;\n-    public final int TKT_FLG_PROXIABLE   = 0x10000000;\n-    public final int TKT_FLG_PROXY        = 0x08000000;\n-    public final int TKT_FLG_MAY_POSTDATE  = 0x04000000;\n-    public final int TKT_FLG_POSTDATED     = 0x02000000;\n-    public final int TKT_FLG_INVALID        = 0x01000000;\n-    public final int TKT_FLG_RENEWABLE     = 0x00800000;\n-    public final int TKT_FLG_INITIAL       = 0x00400000;\n-    public final int TKT_FLG_PRE_AUTH      = 0x00200000;\n-    public final int TKT_FLG_HW_AUTH       = 0x00100000;\n+    int KRB5_FCC_FVNO_1 = 0x501;\n+    int KRB5_FCC_FVNO_2 = 0x502;\n+    int KRB5_FCC_FVNO_3 = 0x503;\n+    int KRB5_FCC_FVNO_4 = 0x504;\n+    int FCC_TAG_DELTATIME = 1;\n+    int KRB5_NT_UNKNOWN = 0;\n+    int TKT_FLG_FORWARDABLE = 0x40000000;\n+    int TKT_FLG_FORWARDED  =  0x20000000;\n+    int TKT_FLG_PROXIABLE   = 0x10000000;\n+    int TKT_FLG_PROXY        = 0x08000000;\n+    int TKT_FLG_MAY_POSTDATE  = 0x04000000;\n+    int TKT_FLG_POSTDATED     = 0x02000000;\n+    int TKT_FLG_INVALID        = 0x01000000;\n+    int TKT_FLG_RENEWABLE     = 0x00800000;\n+    int TKT_FLG_INITIAL       = 0x00400000;\n+    int TKT_FLG_PRE_AUTH      = 0x00200000;\n+    int TKT_FLG_HW_AUTH       = 0x00100000;\n","filename":"src\/java.security.jgss\/share\/classes\/sun\/security\/krb5\/internal\/ccache\/FileCCacheConstants.java","additions":18,"deletions":17,"binary":false,"changes":35,"status":"modified"},{"patch":"@@ -42,0 +42,1 @@\n+import java.security.PrivilegedAction;\n@@ -57,1 +58,1 @@\n- * CredentialsCache stores credentials(tickets, session keys, etc) in a\n+ * CredentialsCache stores credentials(tickets, session keys, etc.) in a\n@@ -71,2 +72,1 @@\n-    private static String dir;\n-    private static boolean DEBUG = Krb5.DEBUG;\n+    private static final boolean DEBUG = Krb5.DEBUG;\n@@ -142,3 +142,1 @@\n-        if (file.exists()) {\n-            return true;\n-        } else return false;\n+        return file.exists();\n@@ -179,1 +177,1 @@\n-            credentialsList = new Vector<Credentials>();\n+            credentialsList = new Vector<>();\n@@ -206,1 +204,1 @@\n-                Credentials tmp = null;\n+                Credentials tmp;\n@@ -227,1 +225,1 @@\n-                if (matched == false) {\n+                if (!matched) {\n@@ -252,1 +250,1 @@\n-            Credentials[] tmp = null;\n+            Credentials[] tmp;\n@@ -313,1 +311,1 @@\n-    private List<ConfigEntry> configEntries = new ArrayList<>();\n+    private final List<ConfigEntry> configEntries = new ArrayList<>();\n@@ -454,12 +452,9 @@\n-                new java.security.PrivilegedAction<String>() {\n-            @Override\n-            public String run() {\n-                String cache = System.getenv(\"KRB5CCNAME\");\n-                if (cache != null &&\n-                        (cache.length() >= 5) &&\n-                        cache.regionMatches(true, 0, \"FILE:\", 0, 5)) {\n-                    cache = cache.substring(5);\n-                }\n-                return cache;\n-            }\n-        });\n+                (PrivilegedAction<String>) () -> {\n+                    String cache = System.getenv(\"KRB5CCNAME\");\n+                    if (cache != null &&\n+                            (cache.length() >= 5) &&\n+                            cache.regionMatches(true, 0, \"FILE:\", 0, 5)) {\n+                        cache = cache.substring(5);\n+                    }\n+                    return cache;\n+                });\n@@ -531,1 +526,1 @@\n-        String fullname = null;\n+        String fullname;\n@@ -568,10 +563,6 @@\n-                (new java.security.PrivilegedAction<Process> () {\n-                        public Process run() {\n-                            try {\n-                                return (Runtime.getRuntime().exec(command));\n-                            } catch (java.io.IOException e) {\n-                                if (DEBUG) {\n-                                    e.printStackTrace();\n-                                }\n-                                return null;\n-                            }\n+                ((PrivilegedAction<Process>) () -> {\n+                    try {\n+                        return (Runtime.getRuntime().exec(command));\n+                    } catch (IOException e) {\n+                        if (DEBUG) {\n+                            e.printStackTrace();\n@@ -579,1 +570,3 @@\n-                    });\n+                        return null;\n+                    }\n+                });\n@@ -588,1 +581,1 @@\n-            String s1 = null;\n+            String s1;\n","filename":"src\/java.security.jgss\/share\/classes\/sun\/security\/krb5\/internal\/ccache\/FileCredentialsCache.java","additions":29,"deletions":36,"binary":false,"changes":65,"status":"modified"},{"patch":"@@ -2,0 +2,1 @@\n+ * Copyright (c) 2022, Oracle and\/or its affiliates. All rights reserved.\n@@ -33,3 +34,3 @@\n-import sun.security.krb5.*;\n-import sun.security.krb5.internal.*;\n-import java.io.IOException;\n+import sun.security.krb5.KrbException;\n+import sun.security.krb5.PrincipalName;\n+\n@@ -37,0 +38,1 @@\n+import java.io.IOException;\n","filename":"src\/java.security.jgss\/share\/classes\/sun\/security\/krb5\/internal\/ccache\/MemoryCredentialsCache.java","additions":5,"deletions":3,"binary":false,"changes":8,"status":"modified"},{"patch":"@@ -2,0 +2,1 @@\n+ * Copyright (c) 2022, Oracle and\/or its affiliates. All rights reserved.\n@@ -33,1 +34,0 @@\n-import sun.security.krb5.*;\n@@ -66,1 +66,1 @@\n-            os.write(time_offset.intValue());\n+            os.write(time_offset);\n@@ -69,1 +69,1 @@\n-            os.write(usec_offset.intValue());\n+            os.write(usec_offset);\n","filename":"src\/java.security.jgss\/share\/classes\/sun\/security\/krb5\/internal\/ccache\/Tag.java","additions":3,"deletions":3,"binary":false,"changes":6,"status":"modified"}]}