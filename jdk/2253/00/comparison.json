{"files":[{"patch":"@@ -33,0 +33,1 @@\n+#include \"gc\/shared\/barrierSet.hpp\"\n@@ -416,9 +417,11 @@\n-    Node* vec_field_ld = LoadNode::make(gvn,\n-                                        ctrl,\n-                                        mem,\n-                                        vec_adr,\n-                                        vec_adr->bottom_type()->is_ptr(),\n-                                        TypeOopPtr::make_from_klass(field->type()->as_klass()),\n-                                        T_OBJECT,\n-                                        MemNode::unordered);\n-    vec_field_ld = gvn.transform(vec_field_ld);\n+    Node* vec_field_ld;\n+    {\n+      DecoratorSet decorators = C2_READ_ACCESS | C2_CONTROL_DEPENDENT_LOAD | IN_HEAP;\n+      C2AccessValuePtr addr(vec_adr, vec_adr->bottom_type()->is_ptr());\n+      MergeMemNode* local_mem = MergeMemNode::make(mem);\n+      gvn.record_for_igvn(local_mem);\n+      BarrierSetC2* bs = BarrierSet::barrier_set()->barrier_set_c2();\n+      C2OptAccess access(gvn, ctrl, local_mem, decorators, T_OBJECT, obj, addr);\n+      const Type* type = TypeOopPtr::make_from_klass(field->type()->as_klass());\n+      vec_field_ld = bs->load_at(access, type);\n+    }\n","filename":"src\/hotspot\/share\/opto\/vector.cpp","additions":12,"deletions":9,"binary":false,"changes":21,"status":"modified"}]}