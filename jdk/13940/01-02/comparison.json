{"files":[{"patch":"@@ -52,19 +52,0 @@\n-        \/\/ RFC 8554, Appendix F Test Cases\n-        if (!kat01()) {\n-            throw new RuntimeException(\"kat01 failed\");\n-        }\n-        if (!kat02()) {\n-            throw new RuntimeException(\"kat02 failed\");\n-        }\n-\n-        \/\/ Additional Parameter sets for LMS Hash-Based Signatures (fluhrer)\n-        \/\/ These should fail because neither SHA256_M24 nor SHAKE are supported.\n-        if (katf1()) {\n-            throw new RuntimeException(\"katf1 unexpected pass\");\n-        }\n-        if (katf2()) {\n-            throw new RuntimeException(\"katf2 unexpected pass\");\n-        }\n-        if (katf3()) {\n-            throw new RuntimeException(\"katf3 unexpected pass\");\n-        }\n@@ -72,1 +53,1 @@\n-        \/\/ Tests 3-10 were generated with Bouncy Castle using parameter sets\n+        \/\/ Tests 6-13 were generated with Bouncy Castle using parameter sets\n@@ -74,24 +55,0 @@\n-        if (!test03_h15_w8()) {\n-            throw new RuntimeException(\"test03_h15_w8 failed\");\n-        }\n-        if (!test04_h20_w8()) {\n-            throw new RuntimeException(\"test04_h20_w8 failed\");\n-        }\n-        if (!test05_h15_w4()) {\n-            throw new RuntimeException(\"test05_h15_w4 failed\");\n-        }\n-        if (!test06_h20_w4()) {\n-            throw new RuntimeException(\"test06_h20_w4 failed\");\n-        }\n-        if (!test07_h15_w4_h10_w4()) {\n-            throw new RuntimeException(\"test07_h15_w4_h10_w4 failed\");\n-        }\n-        if (!test08_h15_w4_h15_w4()) {\n-            throw new RuntimeException(\"test08_h15_w4_h15_w4 failed\");\n-        }\n-        if (!test09_h20_w4_h10_w4()) {\n-            throw new RuntimeException(\"test09_h20_w4_h10_w4 failed\");\n-        }\n-        if (!test10_h20_w4_h15_w4()) {\n-            throw new RuntimeException(\"test10_h20_w4_h15_w4 failed\");\n-        }\n@@ -99,17 +56,6 @@\n-        if (testBadSignature01()) {\n-            throw new RuntimeException(\"testBadSignature01 unexpected pass\");\n-        }\n-        if (testBadSignature02()) {\n-            throw new RuntimeException(\"testBadSignature02 unexpected pass\");\n-        }\n-        if (testBadSignature03()) {\n-            throw new RuntimeException(\"testBadSignature03 unexpected pass\");\n-        }\n-        if (testBadSignature04()) {\n-            throw new RuntimeException(\"testBadSignature04 unexpected pass\");\n-        }\n-        if (testBadSignature05()) {\n-            throw new RuntimeException(\"testBadSignature05 unexpected pass\");\n-        }\n-        if (testBadSignature06()) {\n-            throw new RuntimeException(\"testBadSignature06 unexpected pass\");\n+        int i = 1;\n+        for (TestCase t : TestCases) {\n+            if (!kat(t)) {\n+                throw new RuntimeException(\"test case #\" +i+ \" failed\");\n+            }\n+            i++;\n@@ -117,0 +63,1 @@\n+\n@@ -124,2 +71,20 @@\n-    static boolean kat01() throws Exception {\n-        \/\/ RFC 8554 Test Case 1\n+    static boolean kat(TestCase t) throws Exception {\n+        if (!t.exception) {\n+            if (verify(t.pk, t.sig, t.msg)) {\n+                return t.expected;\n+            } else {\n+                return !t.expected;\n+            }\n+        } else {\n+            \/\/ exception is expected and is a pass (true)\n+            try {\n+                verify(t.pk, t.sig, t.msg);\n+                return false;\n+            } catch (InvalidKeySpecException | SignatureException ex) {\n+                return true;\n+            }\n+        }\n+    }\n+\n+    static boolean serializeTest() throws Exception {\n+        final ObjectIdentifier oid;\n@@ -127,0 +92,100 @@\n+                00000002\n+                00000005\n+                00000004\n+                61a5d57d37f5e46bfb7520806b07a1b8\n+                50650e3b31fe4a773ea29a07f09cf2ea\n+                30e579f0df58ef8e298da0434cb2b878\n+                \"\"\");\n+\n+        \/\/ build x509 public key\n+        try {\n+            oid = ObjectIdentifier.of(OID);\n+        } catch (IOException e) {\n+            throw new AssertionError(e);\n+        }\n+\n+        var keyBits = new DerOutputStream().putOctetString(pk).toByteArray();\n+        var oidBytes = new DerOutputStream().write(DerValue.tag_Sequence,\n+                new DerOutputStream().putOID(oid));\n+        var x509encoding = new DerOutputStream().write(DerValue.tag_Sequence,\n+                oidBytes\n+                .putUnalignedBitString(new BitArray(keyBits.length * 8, keyBits)))\n+                .toByteArray();\n+\n+        var x509KeySpec = new X509EncodedKeySpec(x509encoding);\n+        var pk1 = KeyFactory.getInstance(ALG).generatePublic(x509KeySpec);\n+\n+        PublicKey pk2 = (PublicKey) SerializationUtils\n+                .deserialize(SerializationUtils.serialize(pk1));\n+        return pk2.equals(pk1);\n+    }\n+\n+    static boolean verify(byte[] pk, byte[] sig, byte[] msg) throws Exception {\n+        return verifyRawKey(pk, sig, msg) && verifyX509Key(pk, sig, msg);\n+    }\n+\n+    static boolean verifyX509Key(byte[] pk, byte[] sig, byte[] msg)\n+            throws Exception {\n+        final ObjectIdentifier oid;\n+\n+        \/\/ build x509 public key\n+        try {\n+            oid = ObjectIdentifier.of(OID);\n+        } catch (IOException e) {\n+            throw new AssertionError(e);\n+        }\n+\n+        var keyBits = new DerOutputStream().putOctetString(pk).toByteArray();\n+        var oidBytes = new DerOutputStream().write(DerValue.tag_Sequence,\n+                new DerOutputStream().putOID(oid));\n+        var x509encoding = new DerOutputStream().write(DerValue.tag_Sequence,\n+                oidBytes\n+                .putUnalignedBitString(new BitArray(keyBits.length * 8, keyBits)))\n+                .toByteArray();\n+\n+        var x509KeySpec = new X509EncodedKeySpec(x509encoding);\n+        var pk1 = KeyFactory.getInstance(ALG).generatePublic(x509KeySpec);\n+\n+        var v = Signature.getInstance(ALG);\n+        v.initVerify(pk1);\n+        v.update(msg);\n+        return v.verify(sig);\n+    }\n+\n+    static boolean verifyRawKey(byte[] pk, byte[] sig, byte[] msg)\n+            throws Exception {\n+        var  provider = Security.getProvider(\"SUN\");\n+        PublicKey pk1;\n+\n+        \/\/ build public key\n+        RawKeySpec rks = new RawKeySpec(pk);\n+        KeyFactory kf = KeyFactory.getInstance(ALG, provider);\n+        pk1 = kf.generatePublic(rks);\n+\n+        var v = Signature.getInstance(ALG);\n+        v.initVerify(pk1);\n+        v.update(msg);\n+        return v.verify(sig);\n+    }\n+\n+    static byte[] decode(String s) {\n+        return HexFormat.of().parseHex(s\n+                        .replaceAll(\"\/\/.*\", \"\")\n+                        .replaceAll(\"\\\\s\", \"\"));\n+    }\n+\n+    record TestCase(\n+            boolean exception,\n+            boolean expected,\n+            byte[] pk,\n+            byte[] msg,\n+            byte[] sig) {\n+    }\n+\n+    static TestCase[] TestCases = new TestCase[] {\n+        \/\/ Test Case #0\n+        \/\/ RFC 8554 Test Case 1\n+        new TestCase(\n+            false, \/\/ exception expected\n+            true,  \/\/ expected result\n+            decode(\"\"\"\n@@ -131,2 +196,2 @@\n-                30e579f0df58ef8e298da0434cb2b878\"\"\");\n-        var msg = decode(\"\"\"\n+                30e579f0df58ef8e298da0434cb2b878\"\"\"),\n+            decode(\"\"\"\n@@ -138,2 +203,2 @@\n-                2e0a\"\"\");\n-        var sig = decode(\"\"\"\n+                2e0a\"\"\"),\n+            decode(\"\"\"\n@@ -231,1 +296,2 @@\n-                \"\"\");\n+                \"\"\")\n+        ),\n@@ -233,4 +299,1 @@\n-        return verify(pk, sig, msg);\n-    }\n-\n-    static boolean kat02() throws Exception {\n+        \/\/ Test Case #1\n@@ -238,1 +301,4 @@\n-        var pk = decode(\"\"\"\n+        new TestCase(\n+            false, \/\/ exception expected\n+            true,  \/\/ expected result\n+            decode(\"\"\"\n@@ -243,2 +309,2 @@\n-                c92124404d45fa53cf161c28f1ad5a8e\"\"\");\n-        var msg = decode(\"\"\"\n+                c92124404d45fa53cf161c28f1ad5a8e\"\"\"),\n+            decode(\"\"\"\n@@ -249,2 +315,2 @@\n-                652e0a\"\"\");\n-        var sig = decode(\"\"\"\n+                652e0a\"\"\"),\n+            decode(\"\"\"\n@@ -380,1 +446,2 @@\n-                \"\"\");\n+                \"\"\")\n+        ),\n@@ -382,5 +449,7 @@\n-        return verify(pk, sig, msg);\n-    }\n-\n-    static boolean katf1() throws Exception {\n-        var pk = decode(\"\"\"\n+        \/\/ Test Case #3\n+        \/\/ Additional Parameter sets for LMS Hash-Based Signatures (fluhrer)\n+        \/\/ This test should fail because SHA256_M24 is supported.\n+        new TestCase(\n+            true,  \/\/ InvalidKeyException\n+            false, \/\/ expected result\n+            decode(\"\"\"\n@@ -391,4 +460,4 @@\n-                96618314508b12d2\"\"\");\n-        var msg = decode(\"\"\"\n-                54657374206d65737361676520666f72205348413235362d3139320a\"\"\");\n-        var sig = decode(\"\"\"\n+                96618314508b12d2\"\"\"),\n+            decode(\"\"\"\n+                54657374206d65737361676520666f72205348413235362d3139320a\"\"\"),\n+            decode(\"\"\"\n@@ -423,9 +492,2 @@\n-                5871cffd131d0e04ffe5065bc7875e82d34b40b69dd9f3c1\"\"\");\n-\n-        try {\n-            return verify(pk, sig, msg);\n-        } catch (InvalidKeySpecException ex) {\n-            \/\/ SHA256_M24 not supported\n-            return false;\n-        }\n-    }\n+                5871cffd131d0e04ffe5065bc7875e82d34b40b69dd9f3c1\"\"\")\n+        ),\n@@ -433,2 +495,7 @@\n-    static boolean katf2() throws Exception {\n-        var pk = decode(\"\"\"\n+        \/\/ Test Case #4\n+        \/\/ Additional Parameter sets for LMS Hash-Based Signatures (fluhrer)\n+        \/\/ This test should fail because SHAKE is not supported.\n+        new TestCase(\n+            true,  \/\/ exception expected\n+            false, \/\/ expected result\n+            decode(\"\"\"\n@@ -439,2 +506,2 @@\n-                7986da87924ff0b1\"\"\");\n-        var msg = decode(\"\"\"\n+                7986da87924ff0b1\"\"\"),\n+            decode(\"\"\"\n@@ -442,2 +509,2 @@\n-                \"\"\");\n-        var sig = decode(\"\"\"\n+                \"\"\"),\n+            decode(\"\"\"\n@@ -472,9 +539,2 @@\n-                cb495ba265f465c56291a902e62a461f6dfda232457fad14\"\"\");\n-\n-        try {\n-            return verify(pk, sig, msg);\n-        } catch (InvalidKeySpecException ex) {\n-            \/\/ SHAKE_M24 not supported\n-            return false;\n-        }\n-    }\n+                cb495ba265f465c56291a902e62a461f6dfda232457fad14\"\"\")\n+        ),\n@@ -482,2 +542,7 @@\n-    static boolean katf3() throws Exception {\n-        var pk = decode(\"\"\"\n+        \/\/ Test Case #5\n+        \/\/ Additional Parameter sets for LMS Hash-Based Signatures (fluhrer)\n+        \/\/ This test should fail because SHAKE is not supported.\n+        new TestCase(\n+            true,  \/\/ exception expected\n+            false, \/\/ expected result\n+            decode(\"\"\"\n@@ -488,4 +553,4 @@\n-                65d0ac31932bbf0c2d07c7a4a36379fe\"\"\");\n-        var msg = decode(\"\"\"\n-                54657374206d657361676520666f72205348414b453235362d3235360a\"\"\");\n-        var sig = decode(\"\"\"\n+                65d0ac31932bbf0c2d07c7a4a36379fe\"\"\"),\n+            decode(\"\"\"\n+                54657374206d657361676520666f72205348414b453235362d3235360a\"\"\"),\n+            decode(\"\"\"\n@@ -536,9 +601,2 @@\n-                \"\"\");\n-\n-        try {\n-            return verify(pk, sig, msg);\n-        } catch (InvalidKeySpecException ex) {\n-            \/\/ SHAKE_M24 not supported\n-            return false;\n-        }\n-    }\n+                \"\"\")\n+        ),\n@@ -546,3 +604,6 @@\n-    \/\/ LMSigParameters.lms_sha256_m32_h15, LMOtsParameters.sha256_n32_w8);\n-    static boolean test03_h15_w8() throws Exception {\n-        var pk = decode(\"\"\"\n+        \/\/ Test Case #6\n+        \/\/ LMSigParameters.lms_sha256_m32_h15, LMOtsParameters.sha256_n32_w8\n+        new TestCase(\n+            false, \/\/ exception expected\n+            true,  \/\/ expected result\n+            decode(\"\"\"\n@@ -553,2 +614,2 @@\n-                5ae5daea402617abb48a1f6b9e2c9f28\"\"\");\n-        var msg = decode(\"\"\"\n+                5ae5daea402617abb48a1f6b9e2c9f28\"\"\"),\n+            decode(\"\"\"\n@@ -587,2 +648,2 @@\n-                \"\"\");\n-        var sig = decode(\"\"\"\n+                \"\"\"),\n+            decode(\"\"\"\n@@ -643,4 +704,2 @@\n-                \"\"\");\n-\n-        return verify(pk, sig, msg);\n-    }\n+                \"\"\")\n+        ),\n@@ -648,3 +707,6 @@\n-    \/\/ LMSigParameters.lms_sha256_m32_h20, LMOtsParameters.sha256_n32_w8);\n-    static boolean test04_h20_w8() throws Exception {\n-        var pk = decode(\"\"\"\n+        \/\/ Test Case #7\n+        \/\/ LMSigParameters.lms_sha256_m32_h20, LMOtsParameters.sha256_n32_w8\n+        new TestCase(\n+            false, \/\/ exception expected\n+            true,  \/\/ expected result\n+            decode(\"\"\"\n@@ -655,2 +717,2 @@\n-                7fedc7e225ab0cce270d961ff9b1615b\"\"\");\n-        var msg = decode(\"\"\"\n+                7fedc7e225ab0cce270d961ff9b1615b\"\"\"),\n+            decode(\"\"\"\n@@ -689,2 +751,2 @@\n-                \"\"\");\n-        var sig = decode(\"\"\"\n+                \"\"\"),\n+            decode(\"\"\"\n@@ -750,4 +812,2 @@\n-                \"\"\");\n-\n-        return verify(pk, sig, msg);\n-    }\n+                \"\"\")\n+        ),\n@@ -755,3 +815,6 @@\n-    \/\/ LMSigParameters.lms_sha256_m32_h15, LMOtsParameters.sha256_n32_w4);\n-    static boolean test05_h15_w4() throws Exception {\n-        var pk = decode(\"\"\"\n+        \/\/ Test Case #8\n+        \/\/ LMSigParameters.lms_sha256_m32_h15, LMOtsParameters.sha256_n32_w4\n+        new TestCase(\n+            false, \/\/ exception expected\n+            true,  \/\/ expected result\n+            decode(\"\"\"\n@@ -762,2 +825,2 @@\n-                593d6dd0aa2c99feddc84f8242f6a002\"\"\");\n-        var msg = decode(\"\"\"\n+                593d6dd0aa2c99feddc84f8242f6a002\"\"\"),\n+            decode(\"\"\"\n@@ -796,2 +859,2 @@\n-                \"\"\");\n-        var sig = decode(\"\"\"\n+                \"\"\"),\n+            decode(\"\"\"\n@@ -885,4 +948,2 @@\n-                \"\"\");\n-\n-        return verify(pk, sig, msg);\n-    }\n+                \"\"\")\n+        ),\n@@ -890,3 +951,6 @@\n-    \/\/ LMSigParameters.lms_sha256_m32_h20, LMOtsParameters.sha256_n32_w4);\n-    static boolean test06_h20_w4() throws Exception {\n-        var pk = decode(\"\"\"\n+        \/\/ Test Case #9\n+        \/\/ LMSigParameters.lms_sha256_m32_h20, LMOtsParameters.sha256_n32_w4\n+        new TestCase(\n+            false, \/\/ exception expected\n+            true,  \/\/ expected result\n+            decode(\"\"\"\n@@ -897,2 +961,2 @@\n-                ebea5149fe955d36f911e528d2aaff42\"\"\");\n-        var msg = decode(\"\"\"\n+                ebea5149fe955d36f911e528d2aaff42\"\"\"),\n+            decode(\"\"\"\n@@ -931,2 +995,2 @@\n-                \"\"\");\n-        var sig = decode(\"\"\"\n+                \"\"\"),\n+            decode(\"\"\"\n@@ -1025,1 +1089,2 @@\n-                \"\"\");\n+                \"\"\")\n+        ),\n@@ -1027,7 +1092,7 @@\n-        return verify(pk, sig, msg);\n-    }\n-\n-    \/\/ LMSigParameters.lms_sha256_m32_h15, LMOtsParameters.sha256_n32_w4);\n-    \/\/ LMSigParameters.lms_sha256_m32_h10, LMOtsParameters.sha256_n32_w4);\n-    static boolean test07_h15_w4_h10_w4() throws Exception {\n-        var pk = decode(\"\"\"\n+        \/\/ Test Case #10\n+        \/\/ LMSigParameters.lms_sha256_m32_h15, LMOtsParameters.sha256_n32_w4\n+        \/\/ LMSigParameters.lms_sha256_m32_h10, LMOtsParameters.sha256_n32_w4\n+        new TestCase(\n+            false, \/\/ exception expected\n+            true,  \/\/ expected result\n+            decode(\"\"\"\n@@ -1038,2 +1103,2 @@\n-                e06d7f77bd11b4a6082bbf7a5429dd4b\"\"\");\n-        var msg = decode(\"\"\"\n+                e06d7f77bd11b4a6082bbf7a5429dd4b\"\"\"),\n+            decode(\"\"\"\n@@ -1072,2 +1137,2 @@\n-                \"\"\");\n-        var sig = decode(\"\"\"\n+                \"\"\"),\n+            decode(\"\"\"\n@@ -1246,4 +1311,2 @@\n-                \"\"\");\n-\n-        return verify(pk, sig, msg);\n-    }\n+                \"\"\")\n+        ),\n@@ -1251,4 +1314,7 @@\n-    \/\/ LMSigParameters.lms_sha256_m32_h15, LMOtsParameters.sha256_n32_w4);\n-    \/\/ LMSigParameters.lms_sha256_m32_h15, LMOtsParameters.sha256_n32_w4);\n-    static boolean test08_h15_w4_h15_w4() throws Exception {\n-        var pk = decode(\"\"\"\n+        \/\/ Test Case #11\n+        \/\/ LMSigParameters.lms_sha256_m32_h15, LMOtsParameters.sha256_n32_w4\n+        \/\/ LMSigParameters.lms_sha256_m32_h15, LMOtsParameters.sha256_n32_w4\n+        new TestCase(\n+            false, \/\/ exception expected\n+            true,  \/\/ expected result\n+            decode(\"\"\"\n@@ -1259,2 +1325,2 @@\n-                9d9786e59e41179854928ed5c5726bfb\"\"\");\n-        var msg = decode(\"\"\"\n+                9d9786e59e41179854928ed5c5726bfb\"\"\"),\n+            decode(\"\"\"\n@@ -1293,2 +1359,2 @@\n-                \"\"\");\n-        var sig = decode(\"\"\"\n+                \"\"\"),\n+            decode(\"\"\"\n@@ -1472,4 +1538,2 @@\n-                \"\"\");\n-\n-        return verify(pk, sig, msg);\n-    }\n+                \"\"\")\n+        ),\n@@ -1477,4 +1541,7 @@\n-    \/\/ LMSigParameters.lms_sha256_m32_h20, LMOtsParameters.sha256_n32_w4);\n-    \/\/ LMSigParameters.lms_sha256_m32_h10, LMOtsParameters.sha256_n32_w4);\n-    static boolean test09_h20_w4_h10_w4() throws Exception {\n-        var pk = decode(\"\"\"\n+        \/\/ Test Case #12\n+        \/\/ LMSigParameters.lms_sha256_m32_h20, LMOtsParameters.sha256_n32_w4\n+        \/\/ LMSigParameters.lms_sha256_m32_h10, LMOtsParameters.sha256_n32_w4\n+        new TestCase(\n+            false, \/\/ exception expected\n+            true,  \/\/ expected result\n+            decode(\"\"\"\n@@ -1485,2 +1552,2 @@\n-                f90dafc3d8f09f797b1b6cfa3636e18c\"\"\");\n-        var msg = decode(\"\"\"\n+                f90dafc3d8f09f797b1b6cfa3636e18c\"\"\"),\n+            decode(\"\"\"\n@@ -1519,2 +1586,2 @@\n-                \"\"\");\n-        var sig = decode(\"\"\"\n+                \"\"\"),\n+            decode(\"\"\"\n@@ -1698,4 +1765,2 @@\n-                \"\"\");\n-\n-        return verify(pk, sig, msg);\n-    }\n+                \"\"\")\n+        ),\n@@ -1703,4 +1768,7 @@\n-    \/\/ LMSigParameters.lms_sha256_m32_h20, LMOtsParameters.sha256_n32_w4);\n-    \/\/ LMSigParameters.lms_sha256_m32_h15, LMOtsParameters.sha256_n32_w4);\n-    static boolean test10_h20_w4_h15_w4() throws Exception {\n-        var pk = decode(\"\"\"\n+        \/\/ Test Case #13\n+        \/\/ LMSigParameters.lms_sha256_m32_h20, LMOtsParameters.sha256_n32_w4\n+        \/\/ LMSigParameters.lms_sha256_m32_h15, LMOtsParameters.sha256_n32_w4\n+        new TestCase(\n+            false, \/\/ exception expected\n+            true,  \/\/ expected result\n+            decode(\"\"\"\n@@ -1711,2 +1779,2 @@\n-                ff8083187b30a36242b11bac4bbb7e0c\"\"\");\n-        var msg = decode(\"\"\"\n+                ff8083187b30a36242b11bac4bbb7e0c\"\"\"),\n+            decode(\"\"\"\n@@ -1745,2 +1813,2 @@\n-                \"\"\");\n-        var sig = decode(\"\"\"\n+                \"\"\"),\n+            decode(\"\"\"\n@@ -1929,1 +1997,2 @@\n-                \"\"\");\n+                \"\"\")\n+        ),\n@@ -1931,5 +2000,7 @@\n-        return verify(pk, sig, msg);\n-    }\n-\n-    static boolean testBadSignature01() throws Exception {\n-        var pk = decode(\"\"\"\n+        \/\/ Test Case #14\n+        \/\/ SignatureException\n+        \/\/ LMS signature length is incorrect\n+        new TestCase(\n+            true,  \/\/ exception expected\n+            false, \/\/ expected result\n+            decode(\"\"\"\n@@ -1939,17 +2010,10 @@\n-                61a5d57d37f5e46bfb7520806b07a1b8\n-                50650e3b31fe4a773ea29a07f09cf2ea\n-                30e579f0df58ef8e298da0434cb2b878\n-                \"\"\");\n-        var msg = decode(\"\"\"\n-                54686520706f77657273206e6f742064\n-                656c65676174656420746f2074686520\n-                556e6974656420537461746573206279\n-                2074686520436f6e737469747574696f\n-                6e2c206e6f722070726f686962697465\n-                6420627920697420746f207468652053\n-                74617465732c20617265207265736572\n-                76656420746f20746865205374617465\n-                7320726573706563746976656c792c20\n-                6f7220746f207468652070656f706c65\n-                2e0a\"\"\");\n-        var sig = decode(\"\"\"\n+                61a5d57d37f5e46bfb7520806b07a1b850650e3b31fe4a773ea29a07f09cf2ea\n+                30e579f0df58ef8e298da0434cb2b878\"\"\"),\n+                decode(\"\"\"\n+                54686520706f77657273206e6f742064656c65676174656420746f2074686520\n+                556e69746564205374617465732062792074686520436f6e737469747574696f\n+                6e2c206e6f722070726f6869626974656420627920697420746f207468652053\n+                74617465732c2061726520726573657276656420746f20746865205374617465\n+                7320726573706563746976656c792c206f7220746f207468652070656f706c65\n+                2e0a\"\"\"),\n+            decode(\"\"\"\n@@ -1959,70 +2023,35 @@\n-                d32b56671d7eb98833c49b433c272586\n-                bc4a1c8a8970528ffa04b966f9426eb9\n-                965a25bfd37f196b9073f3d4a232feb6\n-                9128ec45146f86292f9dff9610a7bf95\n-                a64c7f60f6261a62043f86c70324b770\n-                7f5b4a8a6e19c114c7be866d488778a0\n-                e05fd5c6509a6e61d559cf1a77a970de\n-                927d60c70d3de31a7fa0100994e162a2\n-                582e8ff1b10cd99d4e8e413ef469559f\n-                7d7ed12c838342f9b9c96b83a4943d16\n-                81d84b15357ff48ca579f19f5e71f184\n-                66f2bbef4bf660c2518eb20de2f66e3b\n-                14784269d7d876f5d35d3fbfc7039a46\n-                2c716bb9f6891a7f41ad133e9e1f6d95\n-                60b960e7777c52f060492f2d7c660e14\n-                71e07e72655562035abc9a701b473ecb\n-                c3943c6b9c4f2405a3cb8bf8a691ca51\n-                d3f6ad2f428bab6f3a30f55dd9625563\n-                f0a75ee390e385e3ae0b906961ecf41a\n-                e073a0590c2eb6204f44831c26dd768c\n-                35b167b28ce8dc988a3748255230cef9\n-                9ebf14e730632f27414489808afab1d1\n-                e783ed04516de012498682212b078105\n-                79b250365941bcc98142da13609e9768\n-                aaf65de7620dabec29eb82a17fde35af\n-                15ad238c73f81bdb8dec2fc0e7f93270\n-                1099762b37f43c4a3c20010a3d72e2f6\n-                06be108d310e639f09ce7286800d9ef8\n-                a1a40281cc5a7ea98d2adc7c7400c2fe\n-                5a101552df4e3cccfd0cbf2ddf5dc677\n-                9cbbc68fee0c3efe4ec22b83a2caa3e4\n-                8e0809a0a750b73ccdcf3c79e6580c15\n-                4f8a58f7f24335eec5c5eb5e0cf01dcf\n-                4439424095fceb077f66ded5bec73b27\n-                c5b9f64a2a9af2f07c05e99e5cf80f00\n-                252e39db32f6c19674f190c9fbc506d8\n-                26857713afd2ca6bb85cd8c107347552\n-                f30575a5417816ab4db3f603f2df56fb\n-                c413e7d0acd8bdd81352b2471fc1bc4f\n-                1ef296fea1220403466b1afe78b94f7e\n-                cf7cc62fb92be14f18c2192384ebceaf\n-                8801afdf947f698ce9c6ceb696ed70e9\n-                e87b0144417e8d7baf25eb5f70f09f01\n-                6fc925b4db048ab8d8cb2a661ce3b57a\n-                da67571f5dd546fc22cb1f97e0ebd1a6\n-                5926b1234fd04f171cf469c76b884cf3\n-                115cce6f792cc84e36da58960c5f1d76\n-                0f32c12faef477e94c92eb75625b6a37\n-                1efc72d60ca5e908b3a7dd69fef02491\n-                50e3eebdfed39cbdc3ce9704882a2072\n-                c75e13527b7a581a556168783dc1e975\n-                45e31865ddc46b3c957835da252bb732\n-                8d3ee2062445dfb85ef8c35f8e1f3371\n-                af34023cef626e0af1e0bc017351aae2\n-                ab8f5c612ead0b729a1d059d02bfe18e\n-                fa971b7300e882360a93b025ff97e9e0\n-                eec0f3f3f13039a17f88b0cf808f4884\n-                31606cb13f9241f40f44e537d302c64a\n-                4f1f4ab949b9feefadcb71ab50ef27d6\n-                d6ca8510f150c85fb525bf25703df720\n-                9b6066f09c37280d59128d2f0f637c7d\n-                7d7fad4ed1c1ea04e628d221e3d8db77\n-                b7c878c9411cafc5071a34a00f4cf077\n-                38912753dfce48f07576f0d4f94f42c6\n-                d76f7ce973e9367095ba7e9a3649b7f4\n-                61d9f9ac1332a4d1044c96aefee67676\n-                401b64457c54d65fef6500c59cdfb69a\n-                f7b6dddfcb0f086278dd8ad0686078df\n-                b0f3f79cd893d314168648499898fbc0\n-                ced5f95b74e8ff14d735cdea968bee74\n+                d32b56671d7eb98833c49b433c272586bc4a1c8a8970528ffa04b966f9426eb9\n+                965a25bfd37f196b9073f3d4a232feb69128ec45146f86292f9dff9610a7bf95\n+                a64c7f60f6261a62043f86c70324b7707f5b4a8a6e19c114c7be866d488778a0\n+                e05fd5c6509a6e61d559cf1a77a970de927d60c70d3de31a7fa0100994e162a2\n+                582e8ff1b10cd99d4e8e413ef469559f7d7ed12c838342f9b9c96b83a4943d16\n+                81d84b15357ff48ca579f19f5e71f18466f2bbef4bf660c2518eb20de2f66e3b\n+                14784269d7d876f5d35d3fbfc7039a462c716bb9f6891a7f41ad133e9e1f6d95\n+                60b960e7777c52f060492f2d7c660e1471e07e72655562035abc9a701b473ecb\n+                c3943c6b9c4f2405a3cb8bf8a691ca51d3f6ad2f428bab6f3a30f55dd9625563\n+                f0a75ee390e385e3ae0b906961ecf41ae073a0590c2eb6204f44831c26dd768c\n+                35b167b28ce8dc988a3748255230cef99ebf14e730632f27414489808afab1d1\n+                e783ed04516de012498682212b07810579b250365941bcc98142da13609e9768\n+                aaf65de7620dabec29eb82a17fde35af15ad238c73f81bdb8dec2fc0e7f93270\n+                1099762b37f43c4a3c20010a3d72e2f606be108d310e639f09ce7286800d9ef8\n+                a1a40281cc5a7ea98d2adc7c7400c2fe5a101552df4e3cccfd0cbf2ddf5dc677\n+                9cbbc68fee0c3efe4ec22b83a2caa3e48e0809a0a750b73ccdcf3c79e6580c15\n+                4f8a58f7f24335eec5c5eb5e0cf01dcf4439424095fceb077f66ded5bec73b27\n+                c5b9f64a2a9af2f07c05e99e5cf80f00252e39db32f6c19674f190c9fbc506d8\n+                26857713afd2ca6bb85cd8c107347552f30575a5417816ab4db3f603f2df56fb\n+                c413e7d0acd8bdd81352b2471fc1bc4f1ef296fea1220403466b1afe78b94f7e\n+                cf7cc62fb92be14f18c2192384ebceaf8801afdf947f698ce9c6ceb696ed70e9\n+                e87b0144417e8d7baf25eb5f70f09f016fc925b4db048ab8d8cb2a661ce3b57a\n+                da67571f5dd546fc22cb1f97e0ebd1a65926b1234fd04f171cf469c76b884cf3\n+                115cce6f792cc84e36da58960c5f1d760f32c12faef477e94c92eb75625b6a37\n+                1efc72d60ca5e908b3a7dd69fef0249150e3eebdfed39cbdc3ce9704882a2072\n+                c75e13527b7a581a556168783dc1e97545e31865ddc46b3c957835da252bb732\n+                8d3ee2062445dfb85ef8c35f8e1f3371af34023cef626e0af1e0bc017351aae2\n+                ab8f5c612ead0b729a1d059d02bfe18efa971b7300e882360a93b025ff97e9e0\n+                eec0f3f3f13039a17f88b0cf808f488431606cb13f9241f40f44e537d302c64a\n+                4f1f4ab949b9feefadcb71ab50ef27d6d6ca8510f150c85fb525bf25703df720\n+                9b6066f09c37280d59128d2f0f637c7d7d7fad4ed1c1ea04e628d221e3d8db77\n+                b7c878c9411cafc5071a34a00f4cf07738912753dfce48f07576f0d4f94f42c6\n+                d76f7ce973e9367095ba7e9a3649b7f461d9f9ac1332a4d1044c96aefee67676\n+                401b64457c54d65fef6500c59cdfb69af7b6dddfcb0f086278dd8ad0686078df\n+                b0f3f79cd893d314168648499898fbc0ced5f95b74e8ff14d735cdea968bee74\n@@ -2030,10 +2059,5 @@\n-                d8b8112f9200a5e50c4a262165bd342c\n-                d800b8496810bc716277435ac376728d\n-                129ac6eda839a6f357b5a04387c5ce97\n-                382a78f2a4372917eefcbf93f63bb591\n-                12f5dbe400bd49e4501e859f885bf073\n-                6e90a509b30a26bfac8c17b5991c157e\n-                b5971115aa39efd8d564a6b90282c316\n-                8af2d30ef89d51bf14654510a12b8a14\n-                4cca1848cf7da59cc2b3d9d0692dd2a2\n-                0ba3863480e25b1b85ee860c62bf5136\n+                d8b8112f9200a5e50c4a262165bd342cd800b8496810bc716277435ac376728d\n+                129ac6eda839a6f357b5a04387c5ce97382a78f2a4372917eefcbf93f63bb591\n+                12f5dbe400bd49e4501e859f885bf0736e90a509b30a26bfac8c17b5991c157e\n+                b5971115aa39efd8d564a6b90282c3168af2d30ef89d51bf14654510a12b8a14\n+                4cca1848cf7da59cc2b3d9d0692dd2a20ba3863480e25b1b85ee860c62bf5136\n@@ -2042,2 +2066,1 @@\n-                d2f14ff6346af964569f7d6cb880a1b6\n-                6c5004917da6eafe4d9ef6c6407b3db0\n+                d2f14ff6346af964569f7d6cb880a1b66c5004917da6eafe4d9ef6c6407b3db0\n@@ -2047,203 +2070,112 @@\n-                0703c491e7558b35011ece3592eaa5da\n-                4d918786771233e8353bc4f62323185c\n-                95cae05b899e35dffd71705470620998\n-                8ebfdf6e37960bb5c38d7657e8bffeef\n-                9bc042da4b4525650485c66d0ce19b31\n-                7587c6ba4bffcc428e25d08931e72dfb\n-                6a120c5612344258b85efdb7db1db9e1\n-                865a73caf96557eb39ed3e3f426933ac\n-                9eeddb03a1d2374af7bf771855774562\n-                37f9de2d60113c23f846df26fa942008\n-                a698994c0827d90e86d43e0df7f4bfcd\n-                b09b86a373b98288b7094ad81a0185ac\n-                100e4f2c5fc38c003c1ab6fea479eb2f\n-                5ebe48f584d7159b8ada03586e65ad9c\n-                969f6aecbfe44cf356888a7b15a3ff07\n-                4f771760b26f9c04884ee1faa329fbf4\n-                e61af23aee7fa5d4d9a5dfcf43c4c26c\n-                e8aea2ce8a2990d7ba7b57108b47dabf\n-                beadb2b25b3cacc1ac0cef346cbb90fb\n-                044beee4fac2603a442bdf7e507243b7\n-                319c9944b1586e899d431c7f91bcccc8\n-                690dbf59b28386b2315f3d36ef2eaa3c\n-                f30b2b51f48b71b003dfb08249484201\n-                043f65f5a3ef6bbd61ddfee81aca9ce6\n-                0081262a00000480dcbc9a3da6fbef5c\n-                1c0a55e48a0e729f9184fcb1407c3152\n-                9db268f6fe50032a363c9801306837fa\n-                fabdf957fd97eafc80dbd165e435d0e2\n-                dfd836a28b354023924b6fb7e48bc0b3\n-                ed95eea64c2d402f4d734c8dc26f3ac5\n-                91825daef01eae3c38e3328d00a77dc6\n-                57034f287ccb0f0e1c9a7cbdc828f627\n-                205e4737b84b58376551d44c12c3c215\n-                c812a0970789c83de51d6ad787271963\n-                327f0a5fbb6b5907dec02c9a90934af5\n-                a1c63b72c82653605d1dcce51596b3c2\n-                b45696689f2eb382007497557692caac\n-                4d57b5de9f5569bc2ad0137fd47fb47e\n-                664fcb6db4971f5b3e07aceda9ac130e\n-                9f38182de994cff192ec0e82fd6d4cb7\n-                f3fe00812589b7a7ce51544045643301\n-                6b84a59bec6619a1c6c0b37dd1450ed4\n-                f2d8b584410ceda8025f5d2d8dd0d217\n-                6fc1cf2cc06fa8c82bed4d944e71339e\n-                ce780fd025bd41ec34ebff9d4270a322\n-                4e019fcb444474d482fd2dbe75efb203\n-                89cc10cd600abb54c47ede93e08c114e\n-                db04117d714dc1d525e11bed8756192f\n-                929d15462b939ff3f52f2252da2ed64d\n-                8fae88818b1efa2c7b08c8794fb1b214\n-                aa233db3162833141ea4383f1a6f120b\n-                e1db82ce3630b3429114463157a64e91\n-                234d475e2f79cbf05e4db6a9407d72c6\n-                bff7d1198b5c4d6aad2831db61274993\n-                715a0182c7dc8089e32c8531deed4f74\n-                31c07c02195eba2ef91efb5613c37af7\n-                ae0c066babc69369700e1dd26eddc0d2\n-                16c781d56e4ce47e3303fa73007ff7b9\n-                49ef23be2aa4dbf25206fe45c20dd888\n-                395b2526391a724996a44156beac8082\n-                12858792bf8e74cba49dee5e8812e019\n-                da87454bff9e847ed83db07af3137430\n-                82f880a278f682c2bd0ad6887cb59f65\n-                2e155987d61bbf6a88d36ee93b6072e6\n-                656d9ccbaae3d655852e38deb3a2dcf8\n-                058dc9fb6f2ab3d3b3539eb77b248a66\n-                1091d05eb6e2f297774fe6053598457c\n-                c61908318de4b826f0fc86d4bb117d33\n-                e865aa805009cc2918d9c2f840c4da43\n-                a703ad9f5b5806163d7161696b5a0adc\n-                00000006 \/\/ changed from 5 to 6\n-                d5c0d1bebb06048ed6fe2ef2c6cef305\n-                b3ed633941ebc8b3bec9738754cddd60\n-                e1920ada52f43d055b5031cee6192520\n-                d6a5115514851ce7fd448d4a39fae2ab\n-                2335b525f484e9b40d6a4a969394843b\n-                dcf6d14c48e8015e08ab92662c05c6e9\n-                f90b65a7a6201689999f32bfd368e5e3\n-                ec9cb70ac7b8399003f175c40885081a\n-                09ab3034911fe125631051df0408b394\n-                6b0bde790911e8978ba07dd56c73e7ee\n-                \"\"\");\n-\n-        try {\n-            verify(pk, sig, msg);\n-            return true;\n-        } catch (SignatureException ex) {\n-            \/\/ LMS signature length is incorrect\n-            return false;\n-        }\n-    }\n-\n-    static boolean testBadSignature02() throws Exception {\n-        var pk = decode(\"\"\"\n-                00000003 \/\/ level 2 changed to level 3\n-                00000005\n-                00000004\n-                61a5d57d37f5e46bfb7520806b07a1b8\n-                50650e3b31fe4a773ea29a07f09cf2ea\n-                30e579f0df58ef8e298da0434cb2b878\n-                \"\"\");\n-        var msg = decode(\"\"\"\n-                54686520706f77657273206e6f742064\n-                656c65676174656420746f2074686520\n-                556e6974656420537461746573206279\n-                2074686520436f6e737469747574696f\n-                6e2c206e6f722070726f686962697465\n-                6420627920697420746f207468652053\n-                74617465732c20617265207265736572\n-                76656420746f20746865205374617465\n-                7320726573706563746976656c792c20\n-                6f7220746f207468652070656f706c65\n-                2e0a\"\"\");\n-        var sig = decode(\"\"\"\n-                00000001\n-                00000005\n-                00000004\n-                d32b56671d7eb98833c49b433c272586\n-                bc4a1c8a8970528ffa04b966f9426eb9\n-                965a25bfd37f196b9073f3d4a232feb6\n-                9128ec45146f86292f9dff9610a7bf95\n-                a64c7f60f6261a62043f86c70324b770\n-                7f5b4a8a6e19c114c7be866d488778a0\n-                e05fd5c6509a6e61d559cf1a77a970de\n-                927d60c70d3de31a7fa0100994e162a2\n-                582e8ff1b10cd99d4e8e413ef469559f\n-                7d7ed12c838342f9b9c96b83a4943d16\n-                81d84b15357ff48ca579f19f5e71f184\n-                66f2bbef4bf660c2518eb20de2f66e3b\n-                14784269d7d876f5d35d3fbfc7039a46\n-                2c716bb9f6891a7f41ad133e9e1f6d95\n-                60b960e7777c52f060492f2d7c660e14\n-                71e07e72655562035abc9a701b473ecb\n-                c3943c6b9c4f2405a3cb8bf8a691ca51\n-                d3f6ad2f428bab6f3a30f55dd9625563\n-                f0a75ee390e385e3ae0b906961ecf41a\n-                e073a0590c2eb6204f44831c26dd768c\n-                35b167b28ce8dc988a3748255230cef9\n-                9ebf14e730632f27414489808afab1d1\n-                e783ed04516de012498682212b078105\n-                79b250365941bcc98142da13609e9768\n-                aaf65de7620dabec29eb82a17fde35af\n-                15ad238c73f81bdb8dec2fc0e7f93270\n-                1099762b37f43c4a3c20010a3d72e2f6\n-                06be108d310e639f09ce7286800d9ef8\n-                a1a40281cc5a7ea98d2adc7c7400c2fe\n-                5a101552df4e3cccfd0cbf2ddf5dc677\n-                9cbbc68fee0c3efe4ec22b83a2caa3e4\n-                8e0809a0a750b73ccdcf3c79e6580c15\n-                4f8a58f7f24335eec5c5eb5e0cf01dcf\n-                4439424095fceb077f66ded5bec73b27\n-                c5b9f64a2a9af2f07c05e99e5cf80f00\n-                252e39db32f6c19674f190c9fbc506d8\n-                26857713afd2ca6bb85cd8c107347552\n-                f30575a5417816ab4db3f603f2df56fb\n-                c413e7d0acd8bdd81352b2471fc1bc4f\n-                1ef296fea1220403466b1afe78b94f7e\n-                cf7cc62fb92be14f18c2192384ebceaf\n-                8801afdf947f698ce9c6ceb696ed70e9\n-                e87b0144417e8d7baf25eb5f70f09f01\n-                6fc925b4db048ab8d8cb2a661ce3b57a\n-                da67571f5dd546fc22cb1f97e0ebd1a6\n-                5926b1234fd04f171cf469c76b884cf3\n-                115cce6f792cc84e36da58960c5f1d76\n-                0f32c12faef477e94c92eb75625b6a37\n-                1efc72d60ca5e908b3a7dd69fef02491\n-                50e3eebdfed39cbdc3ce9704882a2072\n-                c75e13527b7a581a556168783dc1e975\n-                45e31865ddc46b3c957835da252bb732\n-                8d3ee2062445dfb85ef8c35f8e1f3371\n-                af34023cef626e0af1e0bc017351aae2\n-                ab8f5c612ead0b729a1d059d02bfe18e\n-                fa971b7300e882360a93b025ff97e9e0\n-                eec0f3f3f13039a17f88b0cf808f4884\n-                31606cb13f9241f40f44e537d302c64a\n-                4f1f4ab949b9feefadcb71ab50ef27d6\n-                d6ca8510f150c85fb525bf25703df720\n-                9b6066f09c37280d59128d2f0f637c7d\n-                7d7fad4ed1c1ea04e628d221e3d8db77\n-                b7c878c9411cafc5071a34a00f4cf077\n-                38912753dfce48f07576f0d4f94f42c6\n-                d76f7ce973e9367095ba7e9a3649b7f4\n-                61d9f9ac1332a4d1044c96aefee67676\n-                401b64457c54d65fef6500c59cdfb69a\n-                f7b6dddfcb0f086278dd8ad0686078df\n-                b0f3f79cd893d314168648499898fbc0\n-                ced5f95b74e8ff14d735cdea968bee74\n-                00000005\n-                d8b8112f9200a5e50c4a262165bd342c\n-                d800b8496810bc716277435ac376728d\n-                129ac6eda839a6f357b5a04387c5ce97\n-                382a78f2a4372917eefcbf93f63bb591\n-                12f5dbe400bd49e4501e859f885bf073\n-                6e90a509b30a26bfac8c17b5991c157e\n-                b5971115aa39efd8d564a6b90282c316\n-                8af2d30ef89d51bf14654510a12b8a14\n-                4cca1848cf7da59cc2b3d9d0692dd2a2\n-                0ba3863480e25b1b85ee860c62bf5136\n-                00000005\n-                00000004\n-                d2f14ff6346af964569f7d6cb880a1b6\n-                6c5004917da6eafe4d9ef6c6407b3db0\n-                e5485b122d9ebe15cda93cfec582d7ab\n+                0703c491e7558b35011ece3592eaa5da4d918786771233e8353bc4f62323185c\n+                95cae05b899e35dffd717054706209988ebfdf6e37960bb5c38d7657e8bffeef\n+                9bc042da4b4525650485c66d0ce19b317587c6ba4bffcc428e25d08931e72dfb\n+                6a120c5612344258b85efdb7db1db9e1865a73caf96557eb39ed3e3f426933ac\n+                9eeddb03a1d2374af7bf77185577456237f9de2d60113c23f846df26fa942008\n+                a698994c0827d90e86d43e0df7f4bfcdb09b86a373b98288b7094ad81a0185ac\n+                100e4f2c5fc38c003c1ab6fea479eb2f5ebe48f584d7159b8ada03586e65ad9c\n+                969f6aecbfe44cf356888a7b15a3ff074f771760b26f9c04884ee1faa329fbf4\n+                e61af23aee7fa5d4d9a5dfcf43c4c26ce8aea2ce8a2990d7ba7b57108b47dabf\n+                beadb2b25b3cacc1ac0cef346cbb90fb044beee4fac2603a442bdf7e507243b7\n+                319c9944b1586e899d431c7f91bcccc8690dbf59b28386b2315f3d36ef2eaa3c\n+                f30b2b51f48b71b003dfb08249484201043f65f5a3ef6bbd61ddfee81aca9ce6\n+                0081262a00000480dcbc9a3da6fbef5c1c0a55e48a0e729f9184fcb1407c3152\n+                9db268f6fe50032a363c9801306837fafabdf957fd97eafc80dbd165e435d0e2\n+                dfd836a28b354023924b6fb7e48bc0b3ed95eea64c2d402f4d734c8dc26f3ac5\n+                91825daef01eae3c38e3328d00a77dc657034f287ccb0f0e1c9a7cbdc828f627\n+                205e4737b84b58376551d44c12c3c215c812a0970789c83de51d6ad787271963\n+                327f0a5fbb6b5907dec02c9a90934af5a1c63b72c82653605d1dcce51596b3c2\n+                b45696689f2eb382007497557692caac4d57b5de9f5569bc2ad0137fd47fb47e\n+                664fcb6db4971f5b3e07aceda9ac130e9f38182de994cff192ec0e82fd6d4cb7\n+                f3fe00812589b7a7ce515440456433016b84a59bec6619a1c6c0b37dd1450ed4\n+                f2d8b584410ceda8025f5d2d8dd0d2176fc1cf2cc06fa8c82bed4d944e71339e\n+                ce780fd025bd41ec34ebff9d4270a3224e019fcb444474d482fd2dbe75efb203\n+                89cc10cd600abb54c47ede93e08c114edb04117d714dc1d525e11bed8756192f\n+                929d15462b939ff3f52f2252da2ed64d8fae88818b1efa2c7b08c8794fb1b214\n+                aa233db3162833141ea4383f1a6f120be1db82ce3630b3429114463157a64e91\n+                234d475e2f79cbf05e4db6a9407d72c6bff7d1198b5c4d6aad2831db61274993\n+                715a0182c7dc8089e32c8531deed4f7431c07c02195eba2ef91efb5613c37af7\n+                ae0c066babc69369700e1dd26eddc0d216c781d56e4ce47e3303fa73007ff7b9\n+                49ef23be2aa4dbf25206fe45c20dd888395b2526391a724996a44156beac8082\n+                12858792bf8e74cba49dee5e8812e019da87454bff9e847ed83db07af3137430\n+                82f880a278f682c2bd0ad6887cb59f652e155987d61bbf6a88d36ee93b6072e6\n+                656d9ccbaae3d655852e38deb3a2dcf8058dc9fb6f2ab3d3b3539eb77b248a66\n+                1091d05eb6e2f297774fe6053598457cc61908318de4b826f0fc86d4bb117d33\n+                e865aa805009cc2918d9c2f840c4da43a703ad9f5b5806163d7161696b5a0adc\n+                00000006 \/\/ changed from 5 to 6\n+                d5c0d1bebb06048ed6fe2ef2c6cef305b3ed633941ebc8b3bec9738754cddd60\n+                e1920ada52f43d055b5031cee6192520d6a5115514851ce7fd448d4a39fae2ab\n+                2335b525f484e9b40d6a4a969394843bdcf6d14c48e8015e08ab92662c05c6e9\n+                f90b65a7a6201689999f32bfd368e5e3ec9cb70ac7b8399003f175c40885081a\n+                09ab3034911fe125631051df0408b3946b0bde790911e8978ba07dd56c73e7ee\n+                \"\"\")\n+        ),\n+\n+        \/\/ Test Case #15\n+        \/\/ SignatureException\n+        \/\/ HSS signature and public key have different tree heights\n+        new TestCase(\n+            true,  \/\/ exception expected\n+            false, \/\/ expected result\n+            decode(\"\"\"\n+                00000003 \/\/ level 2 changed to level 3\n+                00000005\n+                00000004\n+                61a5d57d37f5e46bfb7520806b07a1b850650e3b31fe4a773ea29a07f09cf2ea\n+                30e579f0df58ef8e298da0434cb2b878\"\"\"),\n+            decode(\"\"\"\n+                54686520706f77657273206e6f742064656c65676174656420746f2074686520\n+                556e69746564205374617465732062792074686520436f6e737469747574696f\n+                6e2c206e6f722070726f6869626974656420627920697420746f207468652053\n+                74617465732c2061726520726573657276656420746f20746865205374617465\n+                7320726573706563746976656c792c206f7220746f207468652070656f706c65\n+                2e0a\"\"\"),\n+            decode(\"\"\"\n+                00000001\n+                00000005\n+                00000004\n+                d32b56671d7eb98833c49b433c272586bc4a1c8a8970528ffa04b966f9426eb9\n+                965a25bfd37f196b9073f3d4a232feb69128ec45146f86292f9dff9610a7bf95\n+                a64c7f60f6261a62043f86c70324b7707f5b4a8a6e19c114c7be866d488778a0\n+                e05fd5c6509a6e61d559cf1a77a970de927d60c70d3de31a7fa0100994e162a2\n+                582e8ff1b10cd99d4e8e413ef469559f7d7ed12c838342f9b9c96b83a4943d16\n+                81d84b15357ff48ca579f19f5e71f18466f2bbef4bf660c2518eb20de2f66e3b\n+                14784269d7d876f5d35d3fbfc7039a462c716bb9f6891a7f41ad133e9e1f6d95\n+                60b960e7777c52f060492f2d7c660e1471e07e72655562035abc9a701b473ecb\n+                c3943c6b9c4f2405a3cb8bf8a691ca51d3f6ad2f428bab6f3a30f55dd9625563\n+                f0a75ee390e385e3ae0b906961ecf41ae073a0590c2eb6204f44831c26dd768c\n+                35b167b28ce8dc988a3748255230cef99ebf14e730632f27414489808afab1d1\n+                e783ed04516de012498682212b07810579b250365941bcc98142da13609e9768\n+                aaf65de7620dabec29eb82a17fde35af15ad238c73f81bdb8dec2fc0e7f93270\n+                1099762b37f43c4a3c20010a3d72e2f606be108d310e639f09ce7286800d9ef8\n+                a1a40281cc5a7ea98d2adc7c7400c2fe5a101552df4e3cccfd0cbf2ddf5dc677\n+                9cbbc68fee0c3efe4ec22b83a2caa3e48e0809a0a750b73ccdcf3c79e6580c15\n+                4f8a58f7f24335eec5c5eb5e0cf01dcf4439424095fceb077f66ded5bec73b27\n+                c5b9f64a2a9af2f07c05e99e5cf80f00252e39db32f6c19674f190c9fbc506d8\n+                26857713afd2ca6bb85cd8c107347552f30575a5417816ab4db3f603f2df56fb\n+                c413e7d0acd8bdd81352b2471fc1bc4f1ef296fea1220403466b1afe78b94f7e\n+                cf7cc62fb92be14f18c2192384ebceaf8801afdf947f698ce9c6ceb696ed70e9\n+                e87b0144417e8d7baf25eb5f70f09f016fc925b4db048ab8d8cb2a661ce3b57a\n+                da67571f5dd546fc22cb1f97e0ebd1a65926b1234fd04f171cf469c76b884cf3\n+                115cce6f792cc84e36da58960c5f1d760f32c12faef477e94c92eb75625b6a37\n+                1efc72d60ca5e908b3a7dd69fef0249150e3eebdfed39cbdc3ce9704882a2072\n+                c75e13527b7a581a556168783dc1e97545e31865ddc46b3c957835da252bb732\n+                8d3ee2062445dfb85ef8c35f8e1f3371af34023cef626e0af1e0bc017351aae2\n+                ab8f5c612ead0b729a1d059d02bfe18efa971b7300e882360a93b025ff97e9e0\n+                eec0f3f3f13039a17f88b0cf808f488431606cb13f9241f40f44e537d302c64a\n+                4f1f4ab949b9feefadcb71ab50ef27d6d6ca8510f150c85fb525bf25703df720\n+                9b6066f09c37280d59128d2f0f637c7d7d7fad4ed1c1ea04e628d221e3d8db77\n+                b7c878c9411cafc5071a34a00f4cf07738912753dfce48f07576f0d4f94f42c6\n+                d76f7ce973e9367095ba7e9a3649b7f461d9f9ac1332a4d1044c96aefee67676\n+                401b64457c54d65fef6500c59cdfb69af7b6dddfcb0f086278dd8ad0686078df\n+                b0f3f79cd893d314168648499898fbc0ced5f95b74e8ff14d735cdea968bee74\n+                00000005\n+                d8b8112f9200a5e50c4a262165bd342cd800b8496810bc716277435ac376728d\n+                129ac6eda839a6f357b5a04387c5ce97382a78f2a4372917eefcbf93f63bb591\n+                12f5dbe400bd49e4501e859f885bf0736e90a509b30a26bfac8c17b5991c157e\n+                b5971115aa39efd8d564a6b90282c3168af2d30ef89d51bf14654510a12b8a14\n+                4cca1848cf7da59cc2b3d9d0692dd2a20ba3863480e25b1b85ee860c62bf5136\n+                00000005\n+                00000004\n+                d2f14ff6346af964569f7d6cb880a1b66c5004917da6eafe4d9ef6c6407b3db0\n+                e5485b122d9ebe15cda93cfec582d7ab\n@@ -2252,70 +2184,35 @@\n-                0703c491e7558b35011ece3592eaa5da\n-                4d918786771233e8353bc4f62323185c\n-                95cae05b899e35dffd71705470620998\n-                8ebfdf6e37960bb5c38d7657e8bffeef\n-                9bc042da4b4525650485c66d0ce19b31\n-                7587c6ba4bffcc428e25d08931e72dfb\n-                6a120c5612344258b85efdb7db1db9e1\n-                865a73caf96557eb39ed3e3f426933ac\n-                9eeddb03a1d2374af7bf771855774562\n-                37f9de2d60113c23f846df26fa942008\n-                a698994c0827d90e86d43e0df7f4bfcd\n-                b09b86a373b98288b7094ad81a0185ac\n-                100e4f2c5fc38c003c1ab6fea479eb2f\n-                5ebe48f584d7159b8ada03586e65ad9c\n-                969f6aecbfe44cf356888a7b15a3ff07\n-                4f771760b26f9c04884ee1faa329fbf4\n-                e61af23aee7fa5d4d9a5dfcf43c4c26c\n-                e8aea2ce8a2990d7ba7b57108b47dabf\n-                beadb2b25b3cacc1ac0cef346cbb90fb\n-                044beee4fac2603a442bdf7e507243b7\n-                319c9944b1586e899d431c7f91bcccc8\n-                690dbf59b28386b2315f3d36ef2eaa3c\n-                f30b2b51f48b71b003dfb08249484201\n-                043f65f5a3ef6bbd61ddfee81aca9ce6\n-                0081262a00000480dcbc9a3da6fbef5c\n-                1c0a55e48a0e729f9184fcb1407c3152\n-                9db268f6fe50032a363c9801306837fa\n-                fabdf957fd97eafc80dbd165e435d0e2\n-                dfd836a28b354023924b6fb7e48bc0b3\n-                ed95eea64c2d402f4d734c8dc26f3ac5\n-                91825daef01eae3c38e3328d00a77dc6\n-                57034f287ccb0f0e1c9a7cbdc828f627\n-                205e4737b84b58376551d44c12c3c215\n-                c812a0970789c83de51d6ad787271963\n-                327f0a5fbb6b5907dec02c9a90934af5\n-                a1c63b72c82653605d1dcce51596b3c2\n-                b45696689f2eb382007497557692caac\n-                4d57b5de9f5569bc2ad0137fd47fb47e\n-                664fcb6db4971f5b3e07aceda9ac130e\n-                9f38182de994cff192ec0e82fd6d4cb7\n-                f3fe00812589b7a7ce51544045643301\n-                6b84a59bec6619a1c6c0b37dd1450ed4\n-                f2d8b584410ceda8025f5d2d8dd0d217\n-                6fc1cf2cc06fa8c82bed4d944e71339e\n-                ce780fd025bd41ec34ebff9d4270a322\n-                4e019fcb444474d482fd2dbe75efb203\n-                89cc10cd600abb54c47ede93e08c114e\n-                db04117d714dc1d525e11bed8756192f\n-                929d15462b939ff3f52f2252da2ed64d\n-                8fae88818b1efa2c7b08c8794fb1b214\n-                aa233db3162833141ea4383f1a6f120b\n-                e1db82ce3630b3429114463157a64e91\n-                234d475e2f79cbf05e4db6a9407d72c6\n-                bff7d1198b5c4d6aad2831db61274993\n-                715a0182c7dc8089e32c8531deed4f74\n-                31c07c02195eba2ef91efb5613c37af7\n-                ae0c066babc69369700e1dd26eddc0d2\n-                16c781d56e4ce47e3303fa73007ff7b9\n-                49ef23be2aa4dbf25206fe45c20dd888\n-                395b2526391a724996a44156beac8082\n-                12858792bf8e74cba49dee5e8812e019\n-                da87454bff9e847ed83db07af3137430\n-                82f880a278f682c2bd0ad6887cb59f65\n-                2e155987d61bbf6a88d36ee93b6072e6\n-                656d9ccbaae3d655852e38deb3a2dcf8\n-                058dc9fb6f2ab3d3b3539eb77b248a66\n-                1091d05eb6e2f297774fe6053598457c\n-                c61908318de4b826f0fc86d4bb117d33\n-                e865aa805009cc2918d9c2f840c4da43\n-                a703ad9f5b5806163d7161696b5a0adc\n+                0703c491e7558b35011ece3592eaa5da4d918786771233e8353bc4f62323185c\n+                95cae05b899e35dffd717054706209988ebfdf6e37960bb5c38d7657e8bffeef\n+                9bc042da4b4525650485c66d0ce19b317587c6ba4bffcc428e25d08931e72dfb\n+                6a120c5612344258b85efdb7db1db9e1865a73caf96557eb39ed3e3f426933ac\n+                9eeddb03a1d2374af7bf77185577456237f9de2d60113c23f846df26fa942008\n+                a698994c0827d90e86d43e0df7f4bfcdb09b86a373b98288b7094ad81a0185ac\n+                100e4f2c5fc38c003c1ab6fea479eb2f5ebe48f584d7159b8ada03586e65ad9c\n+                969f6aecbfe44cf356888a7b15a3ff074f771760b26f9c04884ee1faa329fbf4\n+                e61af23aee7fa5d4d9a5dfcf43c4c26ce8aea2ce8a2990d7ba7b57108b47dabf\n+                beadb2b25b3cacc1ac0cef346cbb90fb044beee4fac2603a442bdf7e507243b7\n+                319c9944b1586e899d431c7f91bcccc8690dbf59b28386b2315f3d36ef2eaa3c\n+                f30b2b51f48b71b003dfb08249484201043f65f5a3ef6bbd61ddfee81aca9ce6\n+                0081262a00000480dcbc9a3da6fbef5c1c0a55e48a0e729f9184fcb1407c3152\n+                9db268f6fe50032a363c9801306837fafabdf957fd97eafc80dbd165e435d0e2\n+                dfd836a28b354023924b6fb7e48bc0b3ed95eea64c2d402f4d734c8dc26f3ac5\n+                91825daef01eae3c38e3328d00a77dc657034f287ccb0f0e1c9a7cbdc828f627\n+                205e4737b84b58376551d44c12c3c215c812a0970789c83de51d6ad787271963\n+                327f0a5fbb6b5907dec02c9a90934af5a1c63b72c82653605d1dcce51596b3c2\n+                b45696689f2eb382007497557692caac4d57b5de9f5569bc2ad0137fd47fb47e\n+                664fcb6db4971f5b3e07aceda9ac130e9f38182de994cff192ec0e82fd6d4cb7\n+                f3fe00812589b7a7ce515440456433016b84a59bec6619a1c6c0b37dd1450ed4\n+                f2d8b584410ceda8025f5d2d8dd0d2176fc1cf2cc06fa8c82bed4d944e71339e\n+                ce780fd025bd41ec34ebff9d4270a3224e019fcb444474d482fd2dbe75efb203\n+                89cc10cd600abb54c47ede93e08c114edb04117d714dc1d525e11bed8756192f\n+                929d15462b939ff3f52f2252da2ed64d8fae88818b1efa2c7b08c8794fb1b214\n+                aa233db3162833141ea4383f1a6f120be1db82ce3630b3429114463157a64e91\n+                234d475e2f79cbf05e4db6a9407d72c6bff7d1198b5c4d6aad2831db61274993\n+                715a0182c7dc8089e32c8531deed4f7431c07c02195eba2ef91efb5613c37af7\n+                ae0c066babc69369700e1dd26eddc0d216c781d56e4ce47e3303fa73007ff7b9\n+                49ef23be2aa4dbf25206fe45c20dd888395b2526391a724996a44156beac8082\n+                12858792bf8e74cba49dee5e8812e019da87454bff9e847ed83db07af3137430\n+                82f880a278f682c2bd0ad6887cb59f652e155987d61bbf6a88d36ee93b6072e6\n+                656d9ccbaae3d655852e38deb3a2dcf8058dc9fb6f2ab3d3b3539eb77b248a66\n+                1091d05eb6e2f297774fe6053598457cc61908318de4b826f0fc86d4bb117d33\n+                e865aa805009cc2918d9c2f840c4da43a703ad9f5b5806163d7161696b5a0adc\n@@ -2323,20 +2220,7 @@\n-                d5c0d1bebb06048ed6fe2ef2c6cef305\n-                b3ed633941ebc8b3bec9738754cddd60\n-                e1920ada52f43d055b5031cee6192520\n-                d6a5115514851ce7fd448d4a39fae2ab\n-                2335b525f484e9b40d6a4a969394843b\n-                dcf6d14c48e8015e08ab92662c05c6e9\n-                f90b65a7a6201689999f32bfd368e5e3\n-                ec9cb70ac7b8399003f175c40885081a\n-                09ab3034911fe125631051df0408b394\n-                6b0bde790911e8978ba07dd56c73e7ee\n-                \"\"\");\n-\n-        try {\n-            verify(pk, sig, msg);\n-            return true;\n-        } catch (SignatureException ex) {\n-            \/\/ HSS signature and public key have different tree heights\n-            return false;\n-        }\n-    }\n+                d5c0d1bebb06048ed6fe2ef2c6cef305b3ed633941ebc8b3bec9738754cddd60\n+                e1920ada52f43d055b5031cee6192520d6a5115514851ce7fd448d4a39fae2ab\n+                2335b525f484e9b40d6a4a969394843bdcf6d14c48e8015e08ab92662c05c6e9\n+                f90b65a7a6201689999f32bfd368e5e3ec9cb70ac7b8399003f175c40885081a\n+                09ab3034911fe125631051df0408b3946b0bde790911e8978ba07dd56c73e7ee\n+                \"\"\")\n+        ),\n@@ -2344,2 +2228,6 @@\n-    static boolean testBadSignature03() throws Exception {\n-        var pk = decode(\"\"\"\n+        \/\/ Test Case #16\n+        \/\/ bad signature\n+        new TestCase(\n+            false, \/\/ exception expected\n+            false, \/\/ expected result\n+            decode(\"\"\"\n@@ -2349,17 +2237,10 @@\n-                61a5d57d37f5e46bfb7520806b07a1b8\n-                50650e3b31fe4a773ea29a07f09cf2ea\n-                30e579f0df58ef8e298da0434cb2b878\n-                \"\"\");\n-        var msg = decode(\"\"\"\n-                54686520706f77657273206e6f742064\n-                656c65676174656420746f2074686520\n-                556e6974656420537461746573206279\n-                2074686520436f6e737469747574696f\n-                6e2c206e6f722070726f686962697465\n-                6420627920697420746f207468652053\n-                74617465732c20617265207265736572\n-                76656420746f20746865205374617465\n-                7320726573706563746976656c792c20\n-                6f7220746f207468652070656f706c65\n-                2e0a\"\"\");\n-        var sig = decode(\"\"\"\n+                61a5d57d37f5e46bfb7520806b07a1b850650e3b31fe4a773ea29a07f09cf2ea\n+                30e579f0df58ef8e298da0434cb2b878\"\"\"),\n+            decode(\"\"\"\n+                54686520706f77657273206e6f742064656c65676174656420746f2074686520\n+                556e69746564205374617465732062792074686520436f6e737469747574696f\n+                6e2c206e6f722070726f6869626974656420627920697420746f207468652053\n+                74617465732c2061726520726573657276656420746f20746865205374617465\n+                7320726573706563746976656c792c206f7220746f207468652070656f706c65\n+                2e0a\"\"\"),\n+            decode(\"\"\"\n@@ -2369,70 +2250,35 @@\n-                d32b56671d7eb98833c49b433c272586\n-                bc4a1c8a8970528ffa04b966f9426eb9\n-                965a25bfd37f196b9073f3d4a232feb6\n-                9128ec45146f86292f9dff9610a7bf95\n-                a64c7f60f6261a62043f86c70324b770\n-                7f5b4a8a6e19c114c7be866d488778a0\n-                e05fd5c6509a6e61d559cf1a77a970de\n-                927d60c70d3de31a7fa0100994e162a2\n-                582e8ff1b10cd99d4e8e413ef469559f\n-                7d7ed12c838342f9b9c96b83a4943d16\n-                81d84b15357ff48ca579f19f5e71f184\n-                66f2bbef4bf660c2518eb20de2f66e3b\n-                14784269d7d876f5d35d3fbfc7039a46\n-                2c716bb9f6891a7f41ad133e9e1f6d95\n-                60b960e7777c52f060492f2d7c660e14\n-                71e07e72655562035abc9a701b473ecb\n-                c3943c6b9c4f2405a3cb8bf8a691ca51\n-                d3f6ad2f428bab6f3a30f55dd9625563\n-                f0a75ee390e385e3ae0b906961ecf41a\n-                e073a0590c2eb6204f44831c26dd768c\n-                35b167b28ce8dc988a3748255230cef9\n-                9ebf14e730632f27414489808afab1d1\n-                e783ed04516de012498682212b078105\n-                79b250365941bcc98142da13609e9768\n-                aaf65de7620dabec29eb82a17fde35af\n-                15ad238c73f81bdb8dec2fc0e7f93270\n-                1099762b37f43c4a3c20010a3d72e2f6\n-                06be108d310e639f09ce7286800d9ef8\n-                a1a40281cc5a7ea98d2adc7c7400c2fe\n-                5a101552df4e3cccfd0cbf2ddf5dc677\n-                9cbbc68fee0c3efe4ec22b83a2caa3e4\n-                8e0809a0a750b73ccdcf3c79e6580c15\n-                4f8a58f7f24335eec5c5eb5e0cf01dcf\n-                4439424095fceb077f66ded5bec73b27\n-                c5b9f64a2a9af2f07c05e99e5cf80f00\n-                252e39db32f6c19674f190c9fbc506d8\n-                26857713afd2ca6bb85cd8c107347552\n-                f30575a5417816ab4db3f603f2df56fb\n-                c413e7d0acd8bdd81352b2471fc1bc4f\n-                1ef296fea1220403466b1afe78b94f7e\n-                cf7cc62fb92be14f18c2192384ebceaf\n-                8801afdf947f698ce9c6ceb696ed70e9\n-                e87b0144417e8d7baf25eb5f70f09f01\n-                6fc925b4db048ab8d8cb2a661ce3b57a\n-                da67571f5dd546fc22cb1f97e0ebd1a6\n-                5926b1234fd04f171cf469c76b884cf3\n-                115cce6f792cc84e36da58960c5f1d76\n-                0f32c12faef477e94c92eb75625b6a37\n-                1efc72d60ca5e908b3a7dd69fef02491\n-                50e3eebdfed39cbdc3ce9704882a2072\n-                c75e13527b7a581a556168783dc1e975\n-                45e31865ddc46b3c957835da252bb732\n-                8d3ee2062445dfb85ef8c35f8e1f3371\n-                af34023cef626e0af1e0bc017351aae2\n-                ab8f5c612ead0b729a1d059d02bfe18e\n-                fa971b7300e882360a93b025ff97e9e0\n-                eec0f3f3f13039a17f88b0cf808f4884\n-                31606cb13f9241f40f44e537d302c64a\n-                4f1f4ab949b9feefadcb71ab50ef27d6\n-                d6ca8510f150c85fb525bf25703df720\n-                9b6066f09c37280d59128d2f0f637c7d\n-                7d7fad4ed1c1ea04e628d221e3d8db77\n-                b7c878c9411cafc5071a34a00f4cf077\n-                38912753dfce48f07576f0d4f94f42c6\n-                d76f7ce973e9367095ba7e9a3649b7f4\n-                61d9f9ac1332a4d1044c96aefee67676\n-                401b64457c54d65fef6500c59cdfb69a\n-                f7b6dddfcb0f086278dd8ad0686078df\n-                b0f3f79cd893d314168648499898fbc0\n-                ced5f95b74e8ff14d735cdea968bee74\n+                d32b56671d7eb98833c49b433c272586bc4a1c8a8970528ffa04b966f9426eb9\n+                965a25bfd37f196b9073f3d4a232feb69128ec45146f86292f9dff9610a7bf95\n+                a64c7f60f6261a62043f86c70324b7707f5b4a8a6e19c114c7be866d488778a0\n+                e05fd5c6509a6e61d559cf1a77a970de927d60c70d3de31a7fa0100994e162a2\n+                582e8ff1b10cd99d4e8e413ef469559f7d7ed12c838342f9b9c96b83a4943d16\n+                81d84b15357ff48ca579f19f5e71f18466f2bbef4bf660c2518eb20de2f66e3b\n+                14784269d7d876f5d35d3fbfc7039a462c716bb9f6891a7f41ad133e9e1f6d95\n+                60b960e7777c52f060492f2d7c660e1471e07e72655562035abc9a701b473ecb\n+                c3943c6b9c4f2405a3cb8bf8a691ca51d3f6ad2f428bab6f3a30f55dd9625563\n+                f0a75ee390e385e3ae0b906961ecf41ae073a0590c2eb6204f44831c26dd768c\n+                35b167b28ce8dc988a3748255230cef99ebf14e730632f27414489808afab1d1\n+                e783ed04516de012498682212b07810579b250365941bcc98142da13609e9768\n+                aaf65de7620dabec29eb82a17fde35af15ad238c73f81bdb8dec2fc0e7f93270\n+                1099762b37f43c4a3c20010a3d72e2f606be108d310e639f09ce7286800d9ef8\n+                a1a40281cc5a7ea98d2adc7c7400c2fe5a101552df4e3cccfd0cbf2ddf5dc677\n+                9cbbc68fee0c3efe4ec22b83a2caa3e48e0809a0a750b73ccdcf3c79e6580c15\n+                4f8a58f7f24335eec5c5eb5e0cf01dcf4439424095fceb077f66ded5bec73b27\n+                c5b9f64a2a9af2f07c05e99e5cf80f00252e39db32f6c19674f190c9fbc506d8\n+                26857713afd2ca6bb85cd8c107347552f30575a5417816ab4db3f603f2df56fb\n+                c413e7d0acd8bdd81352b2471fc1bc4f1ef296fea1220403466b1afe78b94f7e\n+                cf7cc62fb92be14f18c2192384ebceaf8801afdf947f698ce9c6ceb696ed70e9\n+                e87b0144417e8d7baf25eb5f70f09f016fc925b4db048ab8d8cb2a661ce3b57a\n+                da67571f5dd546fc22cb1f97e0ebd1a65926b1234fd04f171cf469c76b884cf3\n+                115cce6f792cc84e36da58960c5f1d760f32c12faef477e94c92eb75625b6a37\n+                1efc72d60ca5e908b3a7dd69fef0249150e3eebdfed39cbdc3ce9704882a2072\n+                c75e13527b7a581a556168783dc1e97545e31865ddc46b3c957835da252bb732\n+                8d3ee2062445dfb85ef8c35f8e1f3371af34023cef626e0af1e0bc017351aae2\n+                ab8f5c612ead0b729a1d059d02bfe18efa971b7300e882360a93b025ff97e9e0\n+                eec0f3f3f13039a17f88b0cf808f488431606cb13f9241f40f44e537d302c64a\n+                4f1f4ab949b9feefadcb71ab50ef27d6d6ca8510f150c85fb525bf25703df720\n+                9b6066f09c37280d59128d2f0f637c7d7d7fad4ed1c1ea04e628d221e3d8db77\n+                b7c878c9411cafc5071a34a00f4cf07738912753dfce48f07576f0d4f94f42c6\n+                d76f7ce973e9367095ba7e9a3649b7f461d9f9ac1332a4d1044c96aefee67676\n+                401b64457c54d65fef6500c59cdfb69af7b6dddfcb0f086278dd8ad0686078df\n+                b0f3f79cd893d314168648499898fbc0ced5f95b74e8ff14d735cdea968bee74\n@@ -2440,10 +2286,5 @@\n-                d8b8112f9200a5e50c4a262165bd342c\n-                d800b8496810bc716277435ac376728d\n-                129ac6eda839a6f357b5a04387c5ce97\n-                382a78f2a4372917eefcbf93f63bb591\n-                12f5dbe400bd49e4501e859f885bf073\n-                6e90a509b30a26bfac8c17b5991c157e\n-                b5971115aa39efd8d564a6b90282c316\n-                8af2d30ef89d51bf14654510a12b8a14\n-                4cca1848cf7da59cc2b3d9d0692dd2a2\n-                0ba3863480e25b1b85ee860c62bf5136\n+                d8b8112f9200a5e50c4a262165bd342cd800b8496810bc716277435ac376728d\n+                129ac6eda839a6f357b5a04387c5ce97382a78f2a4372917eefcbf93f63bb591\n+                12f5dbe400bd49e4501e859f885bf0736e90a509b30a26bfac8c17b5991c157e\n+                b5971115aa39efd8d564a6b90282c3168af2d30ef89d51bf14654510a12b8a14\n+                4cca1848cf7da59cc2b3d9d0692dd2a20ba3863480e25b1b85ee860c62bf5136\n@@ -2452,2 +2293,1 @@\n-                d2f14ff6346af964569f7d6cb880a1b6\n-                6c5004917da6eafe4d9ef6c6407b3db0\n+                d2f14ff6346af964569f7d6cb880a1b66c5004917da6eafe4d9ef6c6407b3db0\n@@ -2457,70 +2297,35 @@\n-                0703c491e7558b35011ece3592eaa5da\n-                4d918786771233e8353bc4f62323185c\n-                95cae05b899e35dffd71705470620998\n-                8ebfdf6e37960bb5c38d7657e8bffeef\n-                9bc042da4b4525650485c66d0ce19b31\n-                7587c6ba4bffcc428e25d08931e72dfb\n-                6a120c5612344258b85efdb7db1db9e1\n-                865a73caf96557eb39ed3e3f426933ac\n-                9eeddb03a1d2374af7bf771855774562\n-                37f9de2d60113c23f846df26fa942008\n-                a698994c0827d90e86d43e0df7f4bfcd\n-                b09b86a373b98288b7094ad81a0185ac\n-                100e4f2c5fc38c003c1ab6fea479eb2f\n-                5ebe48f584d7159b8ada03586e65ad9c\n-                969f6aecbfe44cf356888a7b15a3ff07\n-                4f771760b26f9c04884ee1faa329fbf4\n-                e61af23aee7fa5d4d9a5dfcf43c4c26c\n-                e8aea2ce8a2990d7ba7b57108b47dabf\n-                beadb2b25b3cacc1ac0cef346cbb90fb\n-                044beee4fac2603a442bdf7e507243b7\n-                319c9944b1586e899d431c7f91bcccc8\n-                690dbf59b28386b2315f3d36ef2eaa3c\n-                f30b2b51f48b71b003dfb08249484201\n-                043f65f5a3ef6bbd61ddfee81aca9ce6\n-                0081262a00000480dcbc9a3da6fbef5c\n-                1c0a55e48a0e729f9184fcb1407c3152\n-                9db268f6fe50032a363c9801306837fa\n-                fabdf957fd97eafc80dbd165e435d0e2\n-                dfd836a28b354023924b6fb7e48bc0b3\n-                ed95eea64c2d402f4d734c8dc26f3ac5\n-                91825daef01eae3c38e3328d00a77dc6\n-                57034f287ccb0f0e1c9a7cbdc828f627\n-                205e4737b84b58376551d44c12c3c215\n-                c812a0970789c83de51d6ad787271963\n-                327f0a5fbb6b5907dec02c9a90934af5\n-                a1c63b72c82653605d1dcce51596b3c2\n-                b45696689f2eb382007497557692caac\n-                4d57b5de9f5569bc2ad0137fd47fb47e\n-                664fcb6db4971f5b3e07aceda9ac130e\n-                9f38182de994cff192ec0e82fd6d4cb7\n-                f3fe00812589b7a7ce51544045643301\n-                6b84a59bec6619a1c6c0b37dd1450ed4\n-                f2d8b584410ceda8025f5d2d8dd0d217\n-                6fc1cf2cc06fa8c82bed4d944e71339e\n-                ce780fd025bd41ec34ebff9d4270a322\n-                4e019fcb444474d482fd2dbe75efb203\n-                89cc10cd600abb54c47ede93e08c114e\n-                db04117d714dc1d525e11bed8756192f\n-                929d15462b939ff3f52f2252da2ed64d\n-                8fae88818b1efa2c7b08c8794fb1b214\n-                aa233db3162833141ea4383f1a6f120b\n-                e1db82ce3630b3429114463157a64e91\n-                234d475e2f79cbf05e4db6a9407d72c6\n-                bff7d1198b5c4d6aad2831db61274993\n-                715a0182c7dc8089e32c8531deed4f74\n-                31c07c02195eba2ef91efb5613c37af7\n-                ae0c066babc69369700e1dd26eddc0d2\n-                16c781d56e4ce47e3303fa73007ff7b9\n-                49ef23be2aa4dbf25206fe45c20dd888\n-                395b2526391a724996a44156beac8082\n-                12858792bf8e74cba49dee5e8812e019\n-                da87454bff9e847ed83db07af3137430\n-                82f880a278f682c2bd0ad6887cb59f65\n-                2e155987d61bbf6a88d36ee93b6072e6\n-                656d9ccbaae3d655852e38deb3a2dcf8\n-                058dc9fb6f2ab3d3b3539eb77b248a66\n-                1091d05eb6e2f297774fe6053598457c\n-                c61908318de4b826f0fc86d4bb117d33\n-                e865aa805009cc2918d9c2f840c4da43\n-                a703ad9f5b5806163d7161696b5a0adc\n+                0703c491e7558b35011ece3592eaa5da4d918786771233e8353bc4f62323185c\n+                95cae05b899e35dffd717054706209988ebfdf6e37960bb5c38d7657e8bffeef\n+                9bc042da4b4525650485c66d0ce19b317587c6ba4bffcc428e25d08931e72dfb\n+                6a120c5612344258b85efdb7db1db9e1865a73caf96557eb39ed3e3f426933ac\n+                9eeddb03a1d2374af7bf77185577456237f9de2d60113c23f846df26fa942008\n+                a698994c0827d90e86d43e0df7f4bfcdb09b86a373b98288b7094ad81a0185ac\n+                100e4f2c5fc38c003c1ab6fea479eb2f5ebe48f584d7159b8ada03586e65ad9c\n+                969f6aecbfe44cf356888a7b15a3ff074f771760b26f9c04884ee1faa329fbf4\n+                e61af23aee7fa5d4d9a5dfcf43c4c26ce8aea2ce8a2990d7ba7b57108b47dabf\n+                beadb2b25b3cacc1ac0cef346cbb90fb044beee4fac2603a442bdf7e507243b7\n+                319c9944b1586e899d431c7f91bcccc8690dbf59b28386b2315f3d36ef2eaa3c\n+                f30b2b51f48b71b003dfb08249484201043f65f5a3ef6bbd61ddfee81aca9ce6\n+                0081262a00000480dcbc9a3da6fbef5c1c0a55e48a0e729f9184fcb1407c3152\n+                9db268f6fe50032a363c9801306837fafabdf957fd97eafc80dbd165e435d0e2\n+                dfd836a28b354023924b6fb7e48bc0b3ed95eea64c2d402f4d734c8dc26f3ac5\n+                91825daef01eae3c38e3328d00a77dc657034f287ccb0f0e1c9a7cbdc828f627\n+                205e4737b84b58376551d44c12c3c215c812a0970789c83de51d6ad787271963\n+                327f0a5fbb6b5907dec02c9a90934af5a1c63b72c82653605d1dcce51596b3c2\n+                b45696689f2eb382007497557692caac4d57b5de9f5569bc2ad0137fd47fb47e\n+                664fcb6db4971f5b3e07aceda9ac130e9f38182de994cff192ec0e82fd6d4cb7\n+                f3fe00812589b7a7ce515440456433016b84a59bec6619a1c6c0b37dd1450ed4\n+                f2d8b584410ceda8025f5d2d8dd0d2176fc1cf2cc06fa8c82bed4d944e71339e\n+                ce780fd025bd41ec34ebff9d4270a3224e019fcb444474d482fd2dbe75efb203\n+                89cc10cd600abb54c47ede93e08c114edb04117d714dc1d525e11bed8756192f\n+                929d15462b939ff3f52f2252da2ed64d8fae88818b1efa2c7b08c8794fb1b214\n+                aa233db3162833141ea4383f1a6f120be1db82ce3630b3429114463157a64e91\n+                234d475e2f79cbf05e4db6a9407d72c6bff7d1198b5c4d6aad2831db61274993\n+                715a0182c7dc8089e32c8531deed4f7431c07c02195eba2ef91efb5613c37af7\n+                ae0c066babc69369700e1dd26eddc0d216c781d56e4ce47e3303fa73007ff7b9\n+                49ef23be2aa4dbf25206fe45c20dd888395b2526391a724996a44156beac8082\n+                12858792bf8e74cba49dee5e8812e019da87454bff9e847ed83db07af3137430\n+                82f880a278f682c2bd0ad6887cb59f652e155987d61bbf6a88d36ee93b6072e6\n+                656d9ccbaae3d655852e38deb3a2dcf8058dc9fb6f2ab3d3b3539eb77b248a66\n+                1091d05eb6e2f297774fe6053598457cc61908318de4b826f0fc86d4bb117d33\n+                e865aa805009cc2918d9c2f840c4da43a703ad9f5b5806163d7161696b5a0adc\n@@ -2528,18 +2333,7 @@\n-                d5c0d1bebb06048ed6fe2ef2c6cef305\n-                b3ed633941ebc8b3bec9738754cddd60\n-                e1920ada52f43d055b5031cee6192520\n-                d6a5115514851ce7fd448d4a39fae2ab\n-                2335b525f484e9b40d6a4a969394843b\n-                dcf6d14c48e8015e08ab92662c05c6e9\n-                f90b65a7a6201689999f32bfd368e5e3\n-                ec9cb70ac7b8399003f175c40885081a\n-                09ab3034911fe125631051df0408b394\n-                6b0bde790911e8978ba07dd56c73e7ee\n-                \"\"\");\n-\n-        try {\n-            return verify(pk, sig, msg);\n-        } catch (SignatureException ex) {\n-            return true;\n-        }\n-    }\n+                d5c0d1bebb06048ed6fe2ef2c6cef305b3ed633941ebc8b3bec9738754cddd60\n+                e1920ada52f43d055b5031cee6192520d6a5115514851ce7fd448d4a39fae2ab\n+                2335b525f484e9b40d6a4a969394843bdcf6d14c48e8015e08ab92662c05c6e9\n+                f90b65a7a6201689999f32bfd368e5e3ec9cb70ac7b8399003f175c40885081a\n+                09ab3034911fe125631051df0408b3946b0bde790911e8978ba07dd56c73e7ee\n+                \"\"\")\n+        ),\n@@ -2547,2 +2341,7 @@\n-    static boolean testBadSignature04() throws Exception {\n-        var pk = decode(\"\"\"\n+        \/\/ Test Case #17\n+        \/\/ SignatureException\n+        \/\/ Invalid key in HSS signature\n+        new TestCase(\n+            true,  \/\/ exception expected\n+            false, \/\/ expected result\n+            decode(\"\"\"\n@@ -2552,17 +2351,10 @@\n-                61a5d57d37f5e46bfb7520806b07a1b8\n-                50650e3b31fe4a773ea29a07f09cf2ea\n-                30e579f0df58ef8e298da0434cb2b878\n-                \"\"\");\n-        var msg = decode(\"\"\"\n-                54686520706f77657273206e6f742064\n-                656c65676174656420746f2074686520\n-                556e6974656420537461746573206279\n-                2074686520436f6e737469747574696f\n-                6e2c206e6f722070726f686962697465\n-                6420627920697420746f207468652053\n-                74617465732c20617265207265736572\n-                76656420746f20746865205374617465\n-                7320726573706563746976656c792c20\n-                6f7220746f207468652070656f706c65\n-                2e0a\"\"\");\n-        var sig = decode(\"\"\"\n+                61a5d57d37f5e46bfb7520806b07a1b850650e3b31fe4a773ea29a07f09cf2ea\n+                30e579f0df58ef8e298da0434cb2b878\"\"\"),\n+            decode(\"\"\"\n+                54686520706f77657273206e6f742064656c65676174656420746f2074686520\n+                556e69746564205374617465732062792074686520436f6e737469747574696f\n+                6e2c206e6f722070726f6869626974656420627920697420746f207468652053\n+                74617465732c2061726520726573657276656420746f20746865205374617465\n+                7320726573706563746976656c792c206f7220746f207468652070656f706c65\n+                2e0a\"\"\"),\n+            decode(\"\"\"\n@@ -2572,70 +2364,35 @@\n-                d32b56671d7eb98833c49b433c272586\n-                bc4a1c8a8970528ffa04b966f9426eb9\n-                965a25bfd37f196b9073f3d4a232feb6\n-                9128ec45146f86292f9dff9610a7bf95\n-                a64c7f60f6261a62043f86c70324b770\n-                7f5b4a8a6e19c114c7be866d488778a0\n-                e05fd5c6509a6e61d559cf1a77a970de\n-                927d60c70d3de31a7fa0100994e162a2\n-                582e8ff1b10cd99d4e8e413ef469559f\n-                7d7ed12c838342f9b9c96b83a4943d16\n-                81d84b15357ff48ca579f19f5e71f184\n-                66f2bbef4bf660c2518eb20de2f66e3b\n-                14784269d7d876f5d35d3fbfc7039a46\n-                2c716bb9f6891a7f41ad133e9e1f6d95\n-                60b960e7777c52f060492f2d7c660e14\n-                71e07e72655562035abc9a701b473ecb\n-                c3943c6b9c4f2405a3cb8bf8a691ca51\n-                d3f6ad2f428bab6f3a30f55dd9625563\n-                f0a75ee390e385e3ae0b906961ecf41a\n-                e073a0590c2eb6204f44831c26dd768c\n-                35b167b28ce8dc988a3748255230cef9\n-                9ebf14e730632f27414489808afab1d1\n-                e783ed04516de012498682212b078105\n-                79b250365941bcc98142da13609e9768\n-                aaf65de7620dabec29eb82a17fde35af\n-                15ad238c73f81bdb8dec2fc0e7f93270\n-                1099762b37f43c4a3c20010a3d72e2f6\n-                06be108d310e639f09ce7286800d9ef8\n-                a1a40281cc5a7ea98d2adc7c7400c2fe\n-                5a101552df4e3cccfd0cbf2ddf5dc677\n-                9cbbc68fee0c3efe4ec22b83a2caa3e4\n-                8e0809a0a750b73ccdcf3c79e6580c15\n-                4f8a58f7f24335eec5c5eb5e0cf01dcf\n-                4439424095fceb077f66ded5bec73b27\n-                c5b9f64a2a9af2f07c05e99e5cf80f00\n-                252e39db32f6c19674f190c9fbc506d8\n-                26857713afd2ca6bb85cd8c107347552\n-                f30575a5417816ab4db3f603f2df56fb\n-                c413e7d0acd8bdd81352b2471fc1bc4f\n-                1ef296fea1220403466b1afe78b94f7e\n-                cf7cc62fb92be14f18c2192384ebceaf\n-                8801afdf947f698ce9c6ceb696ed70e9\n-                e87b0144417e8d7baf25eb5f70f09f01\n-                6fc925b4db048ab8d8cb2a661ce3b57a\n-                da67571f5dd546fc22cb1f97e0ebd1a6\n-                5926b1234fd04f171cf469c76b884cf3\n-                115cce6f792cc84e36da58960c5f1d76\n-                0f32c12faef477e94c92eb75625b6a37\n-                1efc72d60ca5e908b3a7dd69fef02491\n-                50e3eebdfed39cbdc3ce9704882a2072\n-                c75e13527b7a581a556168783dc1e975\n-                45e31865ddc46b3c957835da252bb732\n-                8d3ee2062445dfb85ef8c35f8e1f3371\n-                af34023cef626e0af1e0bc017351aae2\n-                ab8f5c612ead0b729a1d059d02bfe18e\n-                fa971b7300e882360a93b025ff97e9e0\n-                eec0f3f3f13039a17f88b0cf808f4884\n-                31606cb13f9241f40f44e537d302c64a\n-                4f1f4ab949b9feefadcb71ab50ef27d6\n-                d6ca8510f150c85fb525bf25703df720\n-                9b6066f09c37280d59128d2f0f637c7d\n-                7d7fad4ed1c1ea04e628d221e3d8db77\n-                b7c878c9411cafc5071a34a00f4cf077\n-                38912753dfce48f07576f0d4f94f42c6\n-                d76f7ce973e9367095ba7e9a3649b7f4\n-                61d9f9ac1332a4d1044c96aefee67676\n-                401b64457c54d65fef6500c59cdfb69a\n-                f7b6dddfcb0f086278dd8ad0686078df\n-                b0f3f79cd893d314168648499898fbc0\n-                ced5f95b74e8ff14d735cdea968bee74\n+                d32b56671d7eb98833c49b433c272586bc4a1c8a8970528ffa04b966f9426eb9\n+                965a25bfd37f196b9073f3d4a232feb69128ec45146f86292f9dff9610a7bf95\n+                a64c7f60f6261a62043f86c70324b7707f5b4a8a6e19c114c7be866d488778a0\n+                e05fd5c6509a6e61d559cf1a77a970de927d60c70d3de31a7fa0100994e162a2\n+                582e8ff1b10cd99d4e8e413ef469559f7d7ed12c838342f9b9c96b83a4943d16\n+                81d84b15357ff48ca579f19f5e71f18466f2bbef4bf660c2518eb20de2f66e3b\n+                14784269d7d876f5d35d3fbfc7039a462c716bb9f6891a7f41ad133e9e1f6d95\n+                60b960e7777c52f060492f2d7c660e1471e07e72655562035abc9a701b473ecb\n+                c3943c6b9c4f2405a3cb8bf8a691ca51d3f6ad2f428bab6f3a30f55dd9625563\n+                f0a75ee390e385e3ae0b906961ecf41ae073a0590c2eb6204f44831c26dd768c\n+                35b167b28ce8dc988a3748255230cef99ebf14e730632f27414489808afab1d1\n+                e783ed04516de012498682212b07810579b250365941bcc98142da13609e9768\n+                aaf65de7620dabec29eb82a17fde35af15ad238c73f81bdb8dec2fc0e7f93270\n+                1099762b37f43c4a3c20010a3d72e2f606be108d310e639f09ce7286800d9ef8\n+                a1a40281cc5a7ea98d2adc7c7400c2fe5a101552df4e3cccfd0cbf2ddf5dc677\n+                9cbbc68fee0c3efe4ec22b83a2caa3e48e0809a0a750b73ccdcf3c79e6580c15\n+                4f8a58f7f24335eec5c5eb5e0cf01dcf4439424095fceb077f66ded5bec73b27\n+                c5b9f64a2a9af2f07c05e99e5cf80f00252e39db32f6c19674f190c9fbc506d8\n+                26857713afd2ca6bb85cd8c107347552f30575a5417816ab4db3f603f2df56fb\n+                c413e7d0acd8bdd81352b2471fc1bc4f1ef296fea1220403466b1afe78b94f7e\n+                cf7cc62fb92be14f18c2192384ebceaf8801afdf947f698ce9c6ceb696ed70e9\n+                e87b0144417e8d7baf25eb5f70f09f016fc925b4db048ab8d8cb2a661ce3b57a\n+                da67571f5dd546fc22cb1f97e0ebd1a65926b1234fd04f171cf469c76b884cf3\n+                115cce6f792cc84e36da58960c5f1d760f32c12faef477e94c92eb75625b6a37\n+                1efc72d60ca5e908b3a7dd69fef0249150e3eebdfed39cbdc3ce9704882a2072\n+                c75e13527b7a581a556168783dc1e97545e31865ddc46b3c957835da252bb732\n+                8d3ee2062445dfb85ef8c35f8e1f3371af34023cef626e0af1e0bc017351aae2\n+                ab8f5c612ead0b729a1d059d02bfe18efa971b7300e882360a93b025ff97e9e0\n+                eec0f3f3f13039a17f88b0cf808f488431606cb13f9241f40f44e537d302c64a\n+                4f1f4ab949b9feefadcb71ab50ef27d6d6ca8510f150c85fb525bf25703df720\n+                9b6066f09c37280d59128d2f0f637c7d7d7fad4ed1c1ea04e628d221e3d8db77\n+                b7c878c9411cafc5071a34a00f4cf07738912753dfce48f07576f0d4f94f42c6\n+                d76f7ce973e9367095ba7e9a3649b7f461d9f9ac1332a4d1044c96aefee67676\n+                401b64457c54d65fef6500c59cdfb69af7b6dddfcb0f086278dd8ad0686078df\n+                b0f3f79cd893d314168648499898fbc0ced5f95b74e8ff14d735cdea968bee74\n@@ -2643,10 +2400,5 @@\n-                d8b8112f9200a5e50c4a262165bd342c\n-                d800b8496810bc716277435ac376728d\n-                129ac6eda839a6f357b5a04387c5ce97\n-                382a78f2a4372917eefcbf93f63bb591\n-                12f5dbe400bd49e4501e859f885bf073\n-                6e90a509b30a26bfac8c17b5991c157e\n-                b5971115aa39efd8d564a6b90282c316\n-                8af2d30ef89d51bf14654510a12b8a14\n-                4cca1848cf7da59cc2b3d9d0692dd2a2\n-                0ba3863480e25b1b85ee860c62bf5136\n+                d8b8112f9200a5e50c4a262165bd342cd800b8496810bc716277435ac376728d\n+                129ac6eda839a6f357b5a04387c5ce97382a78f2a4372917eefcbf93f63bb591\n+                12f5dbe400bd49e4501e859f885bf0736e90a509b30a26bfac8c17b5991c157e\n+                b5971115aa39efd8d564a6b90282c3168af2d30ef89d51bf14654510a12b8a14\n+                4cca1848cf7da59cc2b3d9d0692dd2a20ba3863480e25b1b85ee860c62bf5136\n@@ -2655,2 +2407,1 @@\n-                d2f14ff6346af964569f7d6cb880a1b6\n-                6c5004917da6eafe4d9ef6c6407b3db0\n+                d2f14ff6346af964569f7d6cb880a1b66c5004917da6eafe4d9ef6c6407b3db0\n@@ -2660,70 +2411,35 @@\n-                0703c491e7558b35011ece3592eaa5da\n-                4d918786771233e8353bc4f62323185c\n-                95cae05b899e35dffd71705470620998\n-                8ebfdf6e37960bb5c38d7657e8bffeef\n-                9bc042da4b4525650485c66d0ce19b31\n-                7587c6ba4bffcc428e25d08931e72dfb\n-                6a120c5612344258b85efdb7db1db9e1\n-                865a73caf96557eb39ed3e3f426933ac\n-                9eeddb03a1d2374af7bf771855774562\n-                37f9de2d60113c23f846df26fa942008\n-                a698994c0827d90e86d43e0df7f4bfcd\n-                b09b86a373b98288b7094ad81a0185ac\n-                100e4f2c5fc38c003c1ab6fea479eb2f\n-                5ebe48f584d7159b8ada03586e65ad9c\n-                969f6aecbfe44cf356888a7b15a3ff07\n-                4f771760b26f9c04884ee1faa329fbf4\n-                e61af23aee7fa5d4d9a5dfcf43c4c26c\n-                e8aea2ce8a2990d7ba7b57108b47dabf\n-                beadb2b25b3cacc1ac0cef346cbb90fb\n-                044beee4fac2603a442bdf7e507243b7\n-                319c9944b1586e899d431c7f91bcccc8\n-                690dbf59b28386b2315f3d36ef2eaa3c\n-                f30b2b51f48b71b003dfb08249484201\n-                043f65f5a3ef6bbd61ddfee81aca9ce6\n-                0081262a00000480dcbc9a3da6fbef5c\n-                1c0a55e48a0e729f9184fcb1407c3152\n-                9db268f6fe50032a363c9801306837fa\n-                fabdf957fd97eafc80dbd165e435d0e2\n-                dfd836a28b354023924b6fb7e48bc0b3\n-                ed95eea64c2d402f4d734c8dc26f3ac5\n-                91825daef01eae3c38e3328d00a77dc6\n-                57034f287ccb0f0e1c9a7cbdc828f627\n-                205e4737b84b58376551d44c12c3c215\n-                c812a0970789c83de51d6ad787271963\n-                327f0a5fbb6b5907dec02c9a90934af5\n-                a1c63b72c82653605d1dcce51596b3c2\n-                b45696689f2eb382007497557692caac\n-                4d57b5de9f5569bc2ad0137fd47fb47e\n-                664fcb6db4971f5b3e07aceda9ac130e\n-                9f38182de994cff192ec0e82fd6d4cb7\n-                f3fe00812589b7a7ce51544045643301\n-                6b84a59bec6619a1c6c0b37dd1450ed4\n-                f2d8b584410ceda8025f5d2d8dd0d217\n-                6fc1cf2cc06fa8c82bed4d944e71339e\n-                ce780fd025bd41ec34ebff9d4270a322\n-                4e019fcb444474d482fd2dbe75efb203\n-                89cc10cd600abb54c47ede93e08c114e\n-                db04117d714dc1d525e11bed8756192f\n-                929d15462b939ff3f52f2252da2ed64d\n-                8fae88818b1efa2c7b08c8794fb1b214\n-                aa233db3162833141ea4383f1a6f120b\n-                e1db82ce3630b3429114463157a64e91\n-                234d475e2f79cbf05e4db6a9407d72c6\n-                bff7d1198b5c4d6aad2831db61274993\n-                715a0182c7dc8089e32c8531deed4f74\n-                31c07c02195eba2ef91efb5613c37af7\n-                ae0c066babc69369700e1dd26eddc0d2\n-                16c781d56e4ce47e3303fa73007ff7b9\n-                49ef23be2aa4dbf25206fe45c20dd888\n-                395b2526391a724996a44156beac8082\n-                12858792bf8e74cba49dee5e8812e019\n-                da87454bff9e847ed83db07af3137430\n-                82f880a278f682c2bd0ad6887cb59f65\n-                2e155987d61bbf6a88d36ee93b6072e6\n-                656d9ccbaae3d655852e38deb3a2dcf8\n-                058dc9fb6f2ab3d3b3539eb77b248a66\n-                1091d05eb6e2f297774fe6053598457c\n-                c61908318de4b826f0fc86d4bb117d33\n-                e865aa805009cc2918d9c2f840c4da43\n-                a703ad9f5b5806163d7161696b5a0adc\n+                0703c491e7558b35011ece3592eaa5da4d918786771233e8353bc4f62323185c\n+                95cae05b899e35dffd717054706209988ebfdf6e37960bb5c38d7657e8bffeef\n+                9bc042da4b4525650485c66d0ce19b317587c6ba4bffcc428e25d08931e72dfb\n+                6a120c5612344258b85efdb7db1db9e1865a73caf96557eb39ed3e3f426933ac\n+                9eeddb03a1d2374af7bf77185577456237f9de2d60113c23f846df26fa942008\n+                a698994c0827d90e86d43e0df7f4bfcdb09b86a373b98288b7094ad81a0185ac\n+                100e4f2c5fc38c003c1ab6fea479eb2f5ebe48f584d7159b8ada03586e65ad9c\n+                969f6aecbfe44cf356888a7b15a3ff074f771760b26f9c04884ee1faa329fbf4\n+                e61af23aee7fa5d4d9a5dfcf43c4c26ce8aea2ce8a2990d7ba7b57108b47dabf\n+                beadb2b25b3cacc1ac0cef346cbb90fb044beee4fac2603a442bdf7e507243b7\n+                319c9944b1586e899d431c7f91bcccc8690dbf59b28386b2315f3d36ef2eaa3c\n+                f30b2b51f48b71b003dfb08249484201043f65f5a3ef6bbd61ddfee81aca9ce6\n+                0081262a00000480dcbc9a3da6fbef5c1c0a55e48a0e729f9184fcb1407c3152\n+                9db268f6fe50032a363c9801306837fafabdf957fd97eafc80dbd165e435d0e2\n+                dfd836a28b354023924b6fb7e48bc0b3ed95eea64c2d402f4d734c8dc26f3ac5\n+                91825daef01eae3c38e3328d00a77dc657034f287ccb0f0e1c9a7cbdc828f627\n+                205e4737b84b58376551d44c12c3c215c812a0970789c83de51d6ad787271963\n+                327f0a5fbb6b5907dec02c9a90934af5a1c63b72c82653605d1dcce51596b3c2\n+                b45696689f2eb382007497557692caac4d57b5de9f5569bc2ad0137fd47fb47e\n+                664fcb6db4971f5b3e07aceda9ac130e9f38182de994cff192ec0e82fd6d4cb7\n+                f3fe00812589b7a7ce515440456433016b84a59bec6619a1c6c0b37dd1450ed4\n+                f2d8b584410ceda8025f5d2d8dd0d2176fc1cf2cc06fa8c82bed4d944e71339e\n+                ce780fd025bd41ec34ebff9d4270a3224e019fcb444474d482fd2dbe75efb203\n+                89cc10cd600abb54c47ede93e08c114edb04117d714dc1d525e11bed8756192f\n+                929d15462b939ff3f52f2252da2ed64d8fae88818b1efa2c7b08c8794fb1b214\n+                aa233db3162833141ea4383f1a6f120be1db82ce3630b3429114463157a64e91\n+                234d475e2f79cbf05e4db6a9407d72c6bff7d1198b5c4d6aad2831db61274993\n+                715a0182c7dc8089e32c8531deed4f7431c07c02195eba2ef91efb5613c37af7\n+                ae0c066babc69369700e1dd26eddc0d216c781d56e4ce47e3303fa73007ff7b9\n+                49ef23be2aa4dbf25206fe45c20dd888395b2526391a724996a44156beac8082\n+                12858792bf8e74cba49dee5e8812e019da87454bff9e847ed83db07af3137430\n+                82f880a278f682c2bd0ad6887cb59f652e155987d61bbf6a88d36ee93b6072e6\n+                656d9ccbaae3d655852e38deb3a2dcf8058dc9fb6f2ab3d3b3539eb77b248a66\n+                1091d05eb6e2f297774fe6053598457cc61908318de4b826f0fc86d4bb117d33\n+                e865aa805009cc2918d9c2f840c4da43a703ad9f5b5806163d7161696b5a0adc\n@@ -2731,20 +2447,7 @@\n-                d5c0d1bebb06048ed6fe2ef2c6cef305\n-                b3ed633941ebc8b3bec9738754cddd60\n-                e1920ada52f43d055b5031cee6192520\n-                d6a5115514851ce7fd448d4a39fae2ab\n-                2335b525f484e9b40d6a4a969394843b\n-                dcf6d14c48e8015e08ab92662c05c6e9\n-                f90b65a7a6201689999f32bfd368e5e3\n-                ec9cb70ac7b8399003f175c40885081a\n-                09ab3034911fe125631051df0408b394\n-                6b0bde790911e8978ba07dd56c73e7ee\n-                \"\"\");\n-\n-        try {\n-            verify(pk, sig, msg);\n-            return true;\n-        } catch (SignatureException ex) {\n-            \/\/ Invalid key in HSS signature\n-            return false;\n-        }\n-    }\n+                d5c0d1bebb06048ed6fe2ef2c6cef305b3ed633941ebc8b3bec9738754cddd60\n+                e1920ada52f43d055b5031cee6192520d6a5115514851ce7fd448d4a39fae2ab\n+                2335b525f484e9b40d6a4a969394843bdcf6d14c48e8015e08ab92662c05c6e9\n+                f90b65a7a6201689999f32bfd368e5e3ec9cb70ac7b8399003f175c40885081a\n+                09ab3034911fe125631051df0408b3946b0bde790911e8978ba07dd56c73e7ee\n+                \"\"\")\n+        ),\n@@ -2752,2 +2455,7 @@\n-    static boolean testBadSignature05() throws Exception {\n-        var pk = decode(\"\"\"\n+        \/\/ Test Case #18\n+        \/\/ SignatureException\n+        \/\/ LMS signature is too short\n+        new TestCase(\n+            true,  \/\/ exception expected\n+            false, \/\/ expected result\n+            decode(\"\"\"\n@@ -2757,17 +2465,10 @@\n-                61a5d57d37f5e46bfb7520806b07a1b8\n-                50650e3b31fe4a773ea29a07f09cf2ea\n-                30e579f0df58ef8e298da0434cb2b878\n-                \"\"\");\n-        var msg = decode(\"\"\"\n-                54686520706f77657273206e6f742064\n-                656c65676174656420746f2074686520\n-                556e6974656420537461746573206279\n-                2074686520436f6e737469747574696f\n-                6e2c206e6f722070726f686962697465\n-                6420627920697420746f207468652053\n-                74617465732c20617265207265736572\n-                76656420746f20746865205374617465\n-                7320726573706563746976656c792c20\n-                6f7220746f207468652070656f706c65\n-                2e0a\"\"\");\n-        var sig = decode(\"\"\"\n+                61a5d57d37f5e46bfb7520806b07a1b850650e3b31fe4a773ea29a07f09cf2ea\n+                30e579f0df58ef8e298da0434cb2b878\"\"\"),\n+            decode(\"\"\"\n+                54686520706f77657273206e6f742064656c65676174656420746f2074686520\n+                556e69746564205374617465732062792074686520436f6e737469747574696f\n+                6e2c206e6f722070726f6869626974656420627920697420746f207468652053\n+                74617465732c2061726520726573657276656420746f20746865205374617465\n+                7320726573706563746976656c792c206f7220746f207468652070656f706c65\n+                2e0a\"\"\"),\n+            decode(\"\"\"\n@@ -2777,3 +2478,0 @@\n-                d32b56671d7eb98833c49b433c272586\n-                bc4a1c8a8970528ffa04b966f9426eb9\n-                965a25bfd37f196b9073f3d4a232feb6\n@@ -2781,10 +2479,3 @@\n-                \"\"\");\n-\n-        try {\n-            verify(pk, sig, msg);\n-            return true;\n-        } catch (SignatureException ex) {\n-            \/\/ LMS signature is too short\n-            return false;\n-        }\n-    }\n+                d32b56671d7eb98833c49b433c272586bc4a1c8a8970528ffa04b966f9426eb9\n+                965a25bfd37f196b9073f3d4a232feb6\"\"\")\n+        ),\n@@ -2792,2 +2483,6 @@\n-    static boolean testBadSignature06() throws Exception {\n-        var pk = decode(\"\"\"\n+        \/\/ Test Case #19\n+        \/\/ bad signature\n+        new TestCase(\n+            false, \/\/ exception expected\n+            false, \/\/ expected result\n+            decode(\"\"\"\n@@ -2798,16 +2493,10 @@\n-                50650e3b31fe4a773ea29a07f09cf2ea\n-                30e579f0df58ef8e298da0434cb2b878\n-                \"\"\");\n-        var msg = decode(\"\"\"\n-                54686520706f77657273206e6f742064\n-                656c65676174656420746f2074686520\n-                556e6974656420537461746573206279\n-                2074686520436f6e737469747574696f\n-                6e2c206e6f722070726f686962697465\n-                6420627920697420746f207468652053\n-                74617465732c20617265207265736572\n-                76656420746f20746865205374617465\n-                7320726573706563746976656c792c20\n-                6f7220746f207468652070656f706c65\n-                2e0a\"\"\");\n-        var sig = decode(\"\"\"\n+                50650e3b31fe4a773ea29a07f09cf2ea30e579f0df58ef8e298da0434cb2b878\n+                \"\"\"),\n+            decode(\"\"\"\n+                54686520706f77657273206e6f742064656c65676174656420746f2074686520\n+                556e69746564205374617465732062792074686520436f6e737469747574696f\n+                6e2c206e6f722070726f6869626974656420627920697420746f207468652053\n+                74617465732c2061726520726573657276656420746f20746865205374617465\n+                7320726573706563746976656c792c206f7220746f207468652070656f706c65\n+                2e0a\"\"\"),\n+            decode(\"\"\"\n@@ -2817,70 +2506,35 @@\n-                d32b56671d7eb98833c49b433c272586\n-                bc4a1c8a8970528ffa04b966f9426eb9\n-                965a25bfd37f196b9073f3d4a232feb6\n-                9128ec45146f86292f9dff9610a7bf95\n-                a64c7f60f6261a62043f86c70324b770\n-                7f5b4a8a6e19c114c7be866d488778a0\n-                e05fd5c6509a6e61d559cf1a77a970de\n-                927d60c70d3de31a7fa0100994e162a2\n-                582e8ff1b10cd99d4e8e413ef469559f\n-                7d7ed12c838342f9b9c96b83a4943d16\n-                81d84b15357ff48ca579f19f5e71f184\n-                66f2bbef4bf660c2518eb20de2f66e3b\n-                14784269d7d876f5d35d3fbfc7039a46\n-                2c716bb9f6891a7f41ad133e9e1f6d95\n-                60b960e7777c52f060492f2d7c660e14\n-                71e07e72655562035abc9a701b473ecb\n-                c3943c6b9c4f2405a3cb8bf8a691ca51\n-                d3f6ad2f428bab6f3a30f55dd9625563\n-                f0a75ee390e385e3ae0b906961ecf41a\n-                e073a0590c2eb6204f44831c26dd768c\n-                35b167b28ce8dc988a3748255230cef9\n-                9ebf14e730632f27414489808afab1d1\n-                e783ed04516de012498682212b078105\n-                79b250365941bcc98142da13609e9768\n-                aaf65de7620dabec29eb82a17fde35af\n-                15ad238c73f81bdb8dec2fc0e7f93270\n-                1099762b37f43c4a3c20010a3d72e2f6\n-                06be108d310e639f09ce7286800d9ef8\n-                a1a40281cc5a7ea98d2adc7c7400c2fe\n-                5a101552df4e3cccfd0cbf2ddf5dc677\n-                9cbbc68fee0c3efe4ec22b83a2caa3e4\n-                8e0809a0a750b73ccdcf3c79e6580c15\n-                4f8a58f7f24335eec5c5eb5e0cf01dcf\n-                4439424095fceb077f66ded5bec73b27\n-                c5b9f64a2a9af2f07c05e99e5cf80f00\n-                252e39db32f6c19674f190c9fbc506d8\n-                26857713afd2ca6bb85cd8c107347552\n-                f30575a5417816ab4db3f603f2df56fb\n-                c413e7d0acd8bdd81352b2471fc1bc4f\n-                1ef296fea1220403466b1afe78b94f7e\n-                cf7cc62fb92be14f18c2192384ebceaf\n-                8801afdf947f698ce9c6ceb696ed70e9\n-                e87b0144417e8d7baf25eb5f70f09f01\n-                6fc925b4db048ab8d8cb2a661ce3b57a\n-                da67571f5dd546fc22cb1f97e0ebd1a6\n-                5926b1234fd04f171cf469c76b884cf3\n-                115cce6f792cc84e36da58960c5f1d76\n-                0f32c12faef477e94c92eb75625b6a37\n-                1efc72d60ca5e908b3a7dd69fef02491\n-                50e3eebdfed39cbdc3ce9704882a2072\n-                c75e13527b7a581a556168783dc1e975\n-                45e31865ddc46b3c957835da252bb732\n-                8d3ee2062445dfb85ef8c35f8e1f3371\n-                af34023cef626e0af1e0bc017351aae2\n-                ab8f5c612ead0b729a1d059d02bfe18e\n-                fa971b7300e882360a93b025ff97e9e0\n-                eec0f3f3f13039a17f88b0cf808f4884\n-                31606cb13f9241f40f44e537d302c64a\n-                4f1f4ab949b9feefadcb71ab50ef27d6\n-                d6ca8510f150c85fb525bf25703df720\n-                9b6066f09c37280d59128d2f0f637c7d\n-                7d7fad4ed1c1ea04e628d221e3d8db77\n-                b7c878c9411cafc5071a34a00f4cf077\n-                38912753dfce48f07576f0d4f94f42c6\n-                d76f7ce973e9367095ba7e9a3649b7f4\n-                61d9f9ac1332a4d1044c96aefee67676\n-                401b64457c54d65fef6500c59cdfb69a\n-                f7b6dddfcb0f086278dd8ad0686078df\n-                b0f3f79cd893d314168648499898fbc0\n-                ced5f95b74e8ff14d735cdea968bee74\n+                d32b56671d7eb98833c49b433c272586bc4a1c8a8970528ffa04b966f9426eb9\n+                965a25bfd37f196b9073f3d4a232feb69128ec45146f86292f9dff9610a7bf95\n+                a64c7f60f6261a62043f86c70324b7707f5b4a8a6e19c114c7be866d488778a0\n+                e05fd5c6509a6e61d559cf1a77a970de927d60c70d3de31a7fa0100994e162a2\n+                582e8ff1b10cd99d4e8e413ef469559f7d7ed12c838342f9b9c96b83a4943d16\n+                81d84b15357ff48ca579f19f5e71f18466f2bbef4bf660c2518eb20de2f66e3b\n+                14784269d7d876f5d35d3fbfc7039a462c716bb9f6891a7f41ad133e9e1f6d95\n+                60b960e7777c52f060492f2d7c660e1471e07e72655562035abc9a701b473ecb\n+                c3943c6b9c4f2405a3cb8bf8a691ca51d3f6ad2f428bab6f3a30f55dd9625563\n+                f0a75ee390e385e3ae0b906961ecf41ae073a0590c2eb6204f44831c26dd768c\n+                35b167b28ce8dc988a3748255230cef99ebf14e730632f27414489808afab1d1\n+                e783ed04516de012498682212b07810579b250365941bcc98142da13609e9768\n+                aaf65de7620dabec29eb82a17fde35af15ad238c73f81bdb8dec2fc0e7f93270\n+                1099762b37f43c4a3c20010a3d72e2f606be108d310e639f09ce7286800d9ef8\n+                a1a40281cc5a7ea98d2adc7c7400c2fe5a101552df4e3cccfd0cbf2ddf5dc677\n+                9cbbc68fee0c3efe4ec22b83a2caa3e48e0809a0a750b73ccdcf3c79e6580c15\n+                4f8a58f7f24335eec5c5eb5e0cf01dcf4439424095fceb077f66ded5bec73b27\n+                c5b9f64a2a9af2f07c05e99e5cf80f00252e39db32f6c19674f190c9fbc506d8\n+                26857713afd2ca6bb85cd8c107347552f30575a5417816ab4db3f603f2df56fb\n+                c413e7d0acd8bdd81352b2471fc1bc4f1ef296fea1220403466b1afe78b94f7e\n+                cf7cc62fb92be14f18c2192384ebceaf8801afdf947f698ce9c6ceb696ed70e9\n+                e87b0144417e8d7baf25eb5f70f09f016fc925b4db048ab8d8cb2a661ce3b57a\n+                da67571f5dd546fc22cb1f97e0ebd1a65926b1234fd04f171cf469c76b884cf3\n+                115cce6f792cc84e36da58960c5f1d760f32c12faef477e94c92eb75625b6a37\n+                1efc72d60ca5e908b3a7dd69fef0249150e3eebdfed39cbdc3ce9704882a2072\n+                c75e13527b7a581a556168783dc1e97545e31865ddc46b3c957835da252bb732\n+                8d3ee2062445dfb85ef8c35f8e1f3371af34023cef626e0af1e0bc017351aae2\n+                ab8f5c612ead0b729a1d059d02bfe18efa971b7300e882360a93b025ff97e9e0\n+                eec0f3f3f13039a17f88b0cf808f488431606cb13f9241f40f44e537d302c64a\n+                4f1f4ab949b9feefadcb71ab50ef27d6d6ca8510f150c85fb525bf25703df720\n+                9b6066f09c37280d59128d2f0f637c7d7d7fad4ed1c1ea04e628d221e3d8db77\n+                b7c878c9411cafc5071a34a00f4cf07738912753dfce48f07576f0d4f94f42c6\n+                d76f7ce973e9367095ba7e9a3649b7f461d9f9ac1332a4d1044c96aefee67676\n+                401b64457c54d65fef6500c59cdfb69af7b6dddfcb0f086278dd8ad0686078df\n+                b0f3f79cd893d314168648499898fbc0ced5f95b74e8ff14d735cdea968bee74\n@@ -2888,10 +2542,5 @@\n-                d8b8112f9200a5e50c4a262165bd342c\n-                d800b8496810bc716277435ac376728d\n-                129ac6eda839a6f357b5a04387c5ce97\n-                382a78f2a4372917eefcbf93f63bb591\n-                12f5dbe400bd49e4501e859f885bf073\n-                6e90a509b30a26bfac8c17b5991c157e\n-                b5971115aa39efd8d564a6b90282c316\n-                8af2d30ef89d51bf14654510a12b8a14\n-                4cca1848cf7da59cc2b3d9d0692dd2a2\n-                0ba3863480e25b1b85ee860c62bf5136\n+                d8b8112f9200a5e50c4a262165bd342cd800b8496810bc716277435ac376728d\n+                129ac6eda839a6f357b5a04387c5ce97382a78f2a4372917eefcbf93f63bb591\n+                12f5dbe400bd49e4501e859f885bf0736e90a509b30a26bfac8c17b5991c157e\n+                b5971115aa39efd8d564a6b90282c3168af2d30ef89d51bf14654510a12b8a14\n+                4cca1848cf7da59cc2b3d9d0692dd2a20ba3863480e25b1b85ee860c62bf5136\n@@ -2900,2 +2549,1 @@\n-                d2f14ff6346af964569f7d6cb880a1b6\n-                6c5004917da6eafe4d9ef6c6407b3db0\n+                d2f14ff6346af964569f7d6cb880a1b66c5004917da6eafe4d9ef6c6407b3db0\n@@ -2905,94 +2553,35 @@\n-                0703c491e7558b35011ece3592eaa5da\n-                4d918786771233e8353bc4f62323185c\n-                95cae05b899e35dffd71705470620998\n-                8ebfdf6e37960bb5c38d7657e8bffeef\n-                9bc042da4b4525650485c66d0ce19b31\n-                7587c6ba4bffcc428e25d08931e72dfb\n-                6a120c5612344258b85efdb7db1db9e1\n-                865a73caf96557eb39ed3e3f426933ac\n-                9eeddb03a1d2374af7bf771855774562\n-                37f9de2d60113c23f846df26fa942008\n-                a698994c0827d90e86d43e0df7f4bfcd\n-                b09b86a373b98288b7094ad81a0185ac\n-                100e4f2c5fc38c003c1ab6fea479eb2f\n-                5ebe48f584d7159b8ada03586e65ad9c\n-                969f6aecbfe44cf356888a7b15a3ff07\n-                4f771760b26f9c04884ee1faa329fbf4\n-                e61af23aee7fa5d4d9a5dfcf43c4c26c\n-                e8aea2ce8a2990d7ba7b57108b47dabf\n-                beadb2b25b3cacc1ac0cef346cbb90fb\n-                044beee4fac2603a442bdf7e507243b7\n-                319c9944b1586e899d431c7f91bcccc8\n-                690dbf59b28386b2315f3d36ef2eaa3c\n-                f30b2b51f48b71b003dfb08249484201\n-                043f65f5a3ef6bbd61ddfee81aca9ce6\n-                0081262a00000480dcbc9a3da6fbef5c\n-                1c0a55e48a0e729f9184fcb1407c3152\n-                9db268f6fe50032a363c9801306837fa\n-                fabdf957fd97eafc80dbd165e435d0e2\n-                dfd836a28b354023924b6fb7e48bc0b3\n-                ed95eea64c2d402f4d734c8dc26f3ac5\n-                91825daef01eae3c38e3328d00a77dc6\n-                57034f287ccb0f0e1c9a7cbdc828f627\n-                205e4737b84b58376551d44c12c3c215\n-                c812a0970789c83de51d6ad787271963\n-                327f0a5fbb6b5907dec02c9a90934af5\n-                a1c63b72c82653605d1dcce51596b3c2\n-                b45696689f2eb382007497557692caac\n-                4d57b5de9f5569bc2ad0137fd47fb47e\n-                664fcb6db4971f5b3e07aceda9ac130e\n-                9f38182de994cff192ec0e82fd6d4cb7\n-                f3fe00812589b7a7ce51544045643301\n-                6b84a59bec6619a1c6c0b37dd1450ed4\n-                f2d8b584410ceda8025f5d2d8dd0d217\n-                6fc1cf2cc06fa8c82bed4d944e71339e\n-                ce780fd025bd41ec34ebff9d4270a322\n-                4e019fcb444474d482fd2dbe75efb203\n-                89cc10cd600abb54c47ede93e08c114e\n-                db04117d714dc1d525e11bed8756192f\n-                929d15462b939ff3f52f2252da2ed64d\n-                8fae88818b1efa2c7b08c8794fb1b214\n-                aa233db3162833141ea4383f1a6f120b\n-                e1db82ce3630b3429114463157a64e91\n-                234d475e2f79cbf05e4db6a9407d72c6\n-                bff7d1198b5c4d6aad2831db61274993\n-                715a0182c7dc8089e32c8531deed4f74\n-                31c07c02195eba2ef91efb5613c37af7\n-                ae0c066babc69369700e1dd26eddc0d2\n-                16c781d56e4ce47e3303fa73007ff7b9\n-                49ef23be2aa4dbf25206fe45c20dd888\n-                395b2526391a724996a44156beac8082\n-                12858792bf8e74cba49dee5e8812e019\n-                da87454bff9e847ed83db07af3137430\n-                82f880a278f682c2bd0ad6887cb59f65\n-                2e155987d61bbf6a88d36ee93b6072e6\n-                656d9ccbaae3d655852e38deb3a2dcf8\n-                058dc9fb6f2ab3d3b3539eb77b248a66\n-                1091d05eb6e2f297774fe6053598457c\n-                c61908318de4b826f0fc86d4bb117d33\n-                e865aa805009cc2918d9c2f840c4da43\n-                a703ad9f5b5806163d7161696b5a0adc\n-                00000005\n-                d5c0d1bebb06048ed6fe2ef2c6cef305\n-                b3ed633941ebc8b3bec9738754cddd60\n-                e1920ada52f43d055b5031cee6192520\n-                d6a5115514851ce7fd448d4a39fae2ab\n-                2335b525f484e9b40d6a4a969394843b\n-                dcf6d14c48e8015e08ab92662c05c6e9\n-                f90b65a7a6201689999f32bfd368e5e3\n-                ec9cb70ac7b8399003f175c40885081a\n-                09ab3034911fe125631051df0408b394\n-                6b0bde790911e8978ba07dd56c73e7ee\n-                \"\"\");\n-\n-        try {\n-            return verify(pk, sig, msg);\n-        } catch (SignatureException ex) {\n-            return true;\n-        }\n-    }\n-\n-    static boolean serializeTest() throws Exception {\n-        final ObjectIdentifier oid;\n-        var pk = decode(\"\"\"\n-                00000002\n+                0703c491e7558b35011ece3592eaa5da4d918786771233e8353bc4f62323185c\n+                95cae05b899e35dffd717054706209988ebfdf6e37960bb5c38d7657e8bffeef\n+                9bc042da4b4525650485c66d0ce19b317587c6ba4bffcc428e25d08931e72dfb\n+                6a120c5612344258b85efdb7db1db9e1865a73caf96557eb39ed3e3f426933ac\n+                9eeddb03a1d2374af7bf77185577456237f9de2d60113c23f846df26fa942008\n+                a698994c0827d90e86d43e0df7f4bfcdb09b86a373b98288b7094ad81a0185ac\n+                100e4f2c5fc38c003c1ab6fea479eb2f5ebe48f584d7159b8ada03586e65ad9c\n+                969f6aecbfe44cf356888a7b15a3ff074f771760b26f9c04884ee1faa329fbf4\n+                e61af23aee7fa5d4d9a5dfcf43c4c26ce8aea2ce8a2990d7ba7b57108b47dabf\n+                beadb2b25b3cacc1ac0cef346cbb90fb044beee4fac2603a442bdf7e507243b7\n+                319c9944b1586e899d431c7f91bcccc8690dbf59b28386b2315f3d36ef2eaa3c\n+                f30b2b51f48b71b003dfb08249484201043f65f5a3ef6bbd61ddfee81aca9ce6\n+                0081262a00000480dcbc9a3da6fbef5c1c0a55e48a0e729f9184fcb1407c3152\n+                9db268f6fe50032a363c9801306837fafabdf957fd97eafc80dbd165e435d0e2\n+                dfd836a28b354023924b6fb7e48bc0b3ed95eea64c2d402f4d734c8dc26f3ac5\n+                91825daef01eae3c38e3328d00a77dc657034f287ccb0f0e1c9a7cbdc828f627\n+                205e4737b84b58376551d44c12c3c215c812a0970789c83de51d6ad787271963\n+                327f0a5fbb6b5907dec02c9a90934af5a1c63b72c82653605d1dcce51596b3c2\n+                b45696689f2eb382007497557692caac4d57b5de9f5569bc2ad0137fd47fb47e\n+                664fcb6db4971f5b3e07aceda9ac130e9f38182de994cff192ec0e82fd6d4cb7\n+                f3fe00812589b7a7ce515440456433016b84a59bec6619a1c6c0b37dd1450ed4\n+                f2d8b584410ceda8025f5d2d8dd0d2176fc1cf2cc06fa8c82bed4d944e71339e\n+                ce780fd025bd41ec34ebff9d4270a3224e019fcb444474d482fd2dbe75efb203\n+                89cc10cd600abb54c47ede93e08c114edb04117d714dc1d525e11bed8756192f\n+                929d15462b939ff3f52f2252da2ed64d8fae88818b1efa2c7b08c8794fb1b214\n+                aa233db3162833141ea4383f1a6f120be1db82ce3630b3429114463157a64e91\n+                234d475e2f79cbf05e4db6a9407d72c6bff7d1198b5c4d6aad2831db61274993\n+                715a0182c7dc8089e32c8531deed4f7431c07c02195eba2ef91efb5613c37af7\n+                ae0c066babc69369700e1dd26eddc0d216c781d56e4ce47e3303fa73007ff7b9\n+                49ef23be2aa4dbf25206fe45c20dd888395b2526391a724996a44156beac8082\n+                12858792bf8e74cba49dee5e8812e019da87454bff9e847ed83db07af3137430\n+                82f880a278f682c2bd0ad6887cb59f652e155987d61bbf6a88d36ee93b6072e6\n+                656d9ccbaae3d655852e38deb3a2dcf8058dc9fb6f2ab3d3b3539eb77b248a66\n+                1091d05eb6e2f297774fe6053598457cc61908318de4b826f0fc86d4bb117d33\n+                e865aa805009cc2918d9c2f840c4da43a703ad9f5b5806163d7161696b5a0adc\n@@ -3000,82 +2589,8 @@\n-                00000004\n-                61a5d57d37f5e46bfb7520806b07a1b8\n-                50650e3b31fe4a773ea29a07f09cf2ea\n-                30e579f0df58ef8e298da0434cb2b878\n-                \"\"\");\n-\n-        \/\/ build x509 public key\n-        try {\n-            oid = ObjectIdentifier.of(OID);\n-        } catch (IOException e) {\n-            throw new AssertionError(e);\n-        }\n-\n-        var keyBits = new DerOutputStream().putOctetString(pk).toByteArray();\n-        var oidBytes = new DerOutputStream().write(DerValue.tag_Sequence,\n-                new DerOutputStream().putOID(oid));\n-        var x509encoding = new DerOutputStream().write(DerValue.tag_Sequence,\n-                oidBytes\n-                .putUnalignedBitString(new BitArray(keyBits.length * 8, keyBits)))\n-                .toByteArray();\n-\n-        var x509KeySpec = new X509EncodedKeySpec(x509encoding);\n-        var pk1 = KeyFactory.getInstance(ALG).generatePublic(x509KeySpec);\n-\n-        PublicKey pk2 = (PublicKey) SerializationUtils\n-                .deserialize(SerializationUtils.serialize(pk1));\n-        return pk2.equals(pk1);\n-    }\n-\n-    static boolean verify(byte[] pk, byte[] sig, byte[] msg) throws Exception {\n-        return verifyRawKey(pk, sig, msg) && verifyX509Key(pk, sig, msg);\n-    }\n-\n-    static boolean verifyX509Key(byte[] pk, byte[] sig, byte[] msg)\n-            throws Exception {\n-        final ObjectIdentifier oid;\n-\n-        \/\/ build x509 public key\n-        try {\n-            oid = ObjectIdentifier.of(OID);\n-        } catch (IOException e) {\n-            throw new AssertionError(e);\n-        }\n-\n-        var keyBits = new DerOutputStream().putOctetString(pk).toByteArray();\n-        var oidBytes = new DerOutputStream().write(DerValue.tag_Sequence,\n-                new DerOutputStream().putOID(oid));\n-        var x509encoding = new DerOutputStream().write(DerValue.tag_Sequence,\n-                oidBytes\n-                .putUnalignedBitString(new BitArray(keyBits.length * 8, keyBits)))\n-                .toByteArray();\n-\n-        var x509KeySpec = new X509EncodedKeySpec(x509encoding);\n-        var pk1 = KeyFactory.getInstance(ALG).generatePublic(x509KeySpec);\n-\n-        var v = Signature.getInstance(ALG);\n-        v.initVerify(pk1);\n-        v.update(msg);\n-        return v.verify(sig);\n-    }\n-\n-    static boolean verifyRawKey(byte[] pk, byte[] sig, byte[] msg)\n-            throws Exception {\n-        var  provider = Security.getProvider(\"SUN\");\n-        PublicKey pk1;\n-\n-        \/\/ build public key\n-        RawKeySpec rks = new RawKeySpec(pk);\n-        KeyFactory kf = KeyFactory.getInstance(ALG, provider);\n-        pk1 = kf.generatePublic(rks);\n-\n-        var v = Signature.getInstance(ALG);\n-        v.initVerify(pk1);\n-        v.update(msg);\n-        return v.verify(sig);\n-    }\n-\n-    static byte[] decode(String s) {\n-        return HexFormat.of().parseHex(s\n-                        .replaceAll(\"\/\/.*\", \"\")\n-                        .replaceAll(\"\\\\s\", \"\"));\n-    }\n+                d5c0d1bebb06048ed6fe2ef2c6cef305b3ed633941ebc8b3bec9738754cddd60\n+                e1920ada52f43d055b5031cee6192520d6a5115514851ce7fd448d4a39fae2ab\n+                2335b525f484e9b40d6a4a969394843bdcf6d14c48e8015e08ab92662c05c6e9\n+                f90b65a7a6201689999f32bfd368e5e3ec9cb70ac7b8399003f175c40885081a\n+                09ab3034911fe125631051df0408b3946b0bde790911e8978ba07dd56c73e7ee\n+                \"\"\")\n+        )\n+    };\n","filename":"test\/jdk\/sun\/security\/provider\/lms\/TestLMS.java","additions":815,"deletions":1300,"binary":false,"changes":2115,"status":"modified"}]}