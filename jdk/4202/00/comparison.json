{"files":[{"patch":"@@ -677,1 +677,2 @@\n-                                  ((path, attrs) -> attrs.isRegularFile()))\n+                                  ((path, attrs) -> attrs.isRegularFile()),\n+                                  FileVisitOption.FOLLOW_LINKS)\n","filename":"src\/jdk.jlink\/share\/classes\/jdk\/tools\/jmod\/JmodTask.java","additions":2,"deletions":1,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -101,1 +101,1 @@\n-    public void testSymlinks() throws IOException {\n+    public void testDirSymlinks() throws IOException {\n@@ -113,0 +113,2 @@\n+            System.out.println(\"Creating symlink failed. Test passes vacuously.\");\n+            uoe.printStackTrace();\n@@ -122,0 +124,36 @@\n+        Files.delete(jmod);\n+    }\n+\n+    \/\/ JDK-8267583 - jmod fails on symlink to class file\n+    @Test\n+    public void testFileSymlinks() throws IOException {\n+        Path apaDir = EXPLODED_DIR.resolve(\"apa\");\n+        Path classesDir = EXPLODED_DIR.resolve(\"apa\").resolve(\"classes\");\n+        assertTrue(compileModule(\"apa\", classesDir));\n+\n+        Files.move(classesDir.resolve(\"module-info.class\"),\n+            classesDir.resolve(\"module-info.class1\"));\n+        Files.move(classesDir.resolve(Paths.get(\"jdk\", \"test\", \"apa\", \"Apa.class\")),\n+            classesDir.resolve(\"Apa.class1\"));\n+        try {\n+            Path link = Files.createSymbolicLink(\n+                classesDir.resolve(\"module-info.class\"),\n+                classesDir.resolve(\"module-info.class1\").toAbsolutePath());\n+            assertTrue(Files.exists(link));\n+            link = Files.createSymbolicLink(\n+                classesDir.resolve(Paths.get(\"jdk\", \"test\", \"apa\", \"Apa.class\")),\n+                classesDir.resolve(\"Apa.class1\").toAbsolutePath());\n+            assertTrue(Files.exists(link));\n+        } catch (IOException|UnsupportedOperationException uoe) {\n+            \/\/ OS does not support symlinks. Nothing to test!\n+            System.out.println(\"Creating symlinks failed. Test passes vacuously.\");\n+            uoe.printStackTrace();\n+            return;\n+        }\n+\n+        Path jmod = MODS_DIR.resolve(\"apa.jmod\");\n+        jmod(\"create\",\n+             \"--class-path\", classesDir.toString(),\n+             jmod.toString())\n+            .assertSuccess();\n+        Files.delete(jmod);\n","filename":"test\/jdk\/tools\/jmod\/JmodTest.java","additions":39,"deletions":1,"binary":false,"changes":40,"status":"modified"}]}