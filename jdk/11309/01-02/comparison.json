{"files":[{"patch":"@@ -102,1 +102,2 @@\n-                            stackSize, Thread.MAX_PRIORITY, true);\n+                            stackSize, Thread.MAX_PRIORITY);\n+                    privilegedThreadSetDaemon(t, true);\n@@ -125,0 +126,8 @@\n+    @SuppressWarnings(\"removal\")\n+    private static void privilegedThreadSetDaemon(Thread thread, boolean on) {\n+        AccessController.doPrivileged((PrivilegedAction<Void>) () -> {\n+            thread.setDaemon(on);\n+            return null;\n+        });\n+    }\n+\n","filename":"src\/java.base\/share\/classes\/java\/lang\/ProcessHandleImpl.java","additions":10,"deletions":1,"binary":false,"changes":11,"status":"modified"},{"patch":"@@ -76,1 +76,1 @@\n-                    ClassLoader.getSystemClassLoader(), priority, false);\n+                    ClassLoader.getSystemClassLoader(), priority);\n@@ -83,1 +83,1 @@\n-                                ClassLoader.getSystemClassLoader(), priority, false);\n+                                ClassLoader.getSystemClassLoader(), priority);\n@@ -109,1 +109,1 @@\n-            return createThread(name, target, 0L, null, priority, false);\n+            return createThread(name, target, 0L, null, priority);\n@@ -116,1 +116,1 @@\n-                                null, priority, false);\n+                                null, priority);\n@@ -127,11 +127,0 @@\n-        return newSystemThread(name, target, stackSize, priority, false);\n-    }\n-\n-    \/**\n-     * Returns a new InnocuousThread with null context class loader.\n-     * Thread priority is set to the given priority.\n-     * If {@code daemon} is {@code true}, the thread is set as a daemon thread.\n-     *\/\n-    public static Thread newSystemThread(String name, Runnable target,\n-                                         long stackSize, int priority,\n-                                         boolean daemon) {\n@@ -139,1 +128,1 @@\n-            return createThread(name, target, stackSize, null, priority, daemon);\n+            return createThread(name, target, stackSize, null, priority);\n@@ -146,1 +135,1 @@\n-                                null, priority, daemon);\n+                                null, priority);\n@@ -152,1 +141,1 @@\n-                                       ClassLoader loader, int priority, boolean daemon) {\n+                                       ClassLoader loader, int priority) {\n@@ -158,1 +147,0 @@\n-        t.setDaemon(daemon);\n","filename":"src\/java.base\/share\/classes\/jdk\/internal\/misc\/InnocuousThread.java","additions":7,"deletions":19,"binary":false,"changes":26,"status":"modified"}]}