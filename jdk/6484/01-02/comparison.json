{"files":[{"patch":"@@ -1256,1 +1256,2 @@\n-void ClassLoader::record_result(JavaThread* current, InstanceKlass* ik, const ClassFileStream* stream) {\n+void ClassLoader::record_result(JavaThread* current, InstanceKlass* ik,\n+                                const ClassFileStream* stream, bool redefined) {\n@@ -1362,1 +1363,1 @@\n-  ClassLoaderExt::record_result(classpath_index, ik, stream);\n+  ClassLoaderExt::record_result(classpath_index, ik, stream, redefined);\n","filename":"src\/hotspot\/share\/classfile\/classLoader.cpp","additions":3,"deletions":2,"binary":false,"changes":5,"status":"modified"},{"patch":"@@ -368,1 +368,2 @@\n-  static void  record_result(JavaThread* current, InstanceKlass* ik, const ClassFileStream* stream);\n+  static void  record_result(JavaThread* current, InstanceKlass* ik,\n+                             const ClassFileStream* stream, bool redefined);\n","filename":"src\/hotspot\/share\/classfile\/classLoader.hpp","additions":2,"deletions":1,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -232,12 +232,2 @@\n-bool ClassLoaderExt::is_module_image_path(const char* path) {\n-  char* runtime_boot_path = Arguments::get_sysclasspath();\n-  char* p = strstr((char*)runtime_boot_path, os::path_separator());\n-  size_t module_path_len = (p == NULL) ? strlen(runtime_boot_path) : p - runtime_boot_path + 1;\n-  if (strlen(path) == module_path_len && strncmp(path, runtime_boot_path, module_path_len) == 0) {\n-    return true;\n-  } else {\n-    return false;\n-  }\n-}\n-\n-void ClassLoaderExt::record_result(const s2 classpath_index, InstanceKlass* result, const ClassFileStream* stream) {\n+void ClassLoaderExt::record_result(const s2 classpath_index, InstanceKlass* result,\n+                                   const ClassFileStream* stream, bool redefined) {\n@@ -263,1 +253,1 @@\n-      classpath_index < 0 && HeapShared::can_write() && is_module_image_path(stream->source())) {\n+      classpath_index < 0 && HeapShared::can_write() && redefined) {\n","filename":"src\/hotspot\/share\/classfile\/classLoaderExt.cpp","additions":3,"deletions":13,"binary":false,"changes":16,"status":"modified"},{"patch":"@@ -63,1 +63,0 @@\n-  static bool is_module_image_path(const char* path);\n@@ -116,1 +115,2 @@\n-  static void record_result(const s2 classpath_index, InstanceKlass* result, const ClassFileStream* stream);\n+  static void record_result(const s2 classpath_index, InstanceKlass* result,\n+                            const ClassFileStream* stream, bool redefined);\n","filename":"src\/hotspot\/share\/classfile\/classLoaderExt.hpp","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -214,1 +214,1 @@\n-    ClassLoader::record_result(THREAD, result, stream);\n+    ClassLoader::record_result(THREAD, result, stream, old_stream != stream);\n","filename":"src\/hotspot\/share\/classfile\/klassFactory.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"}]}