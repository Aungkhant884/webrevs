{"files":[{"patch":"@@ -108,0 +108,4 @@\n+  notproduct(uintx, PrintIdealIndentThreshold, 0,                           \\\n+          \"A depth threshold of ideal graph. Indentation is disabled \"      \\\n+          \"when users attempt to dump an ideal graph deeper than it.\")      \\\n+                                                                            \\\n","filename":"src\/hotspot\/share\/opto\/c2_globals.hpp","additions":4,"deletions":0,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 1997, 2016, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 1997, 2020, Oracle and\/or its affiliates. All rights reserved.\n@@ -332,0 +332,1 @@\n+  , _indent(0)\n@@ -352,0 +353,1 @@\n+  , _indent(0)\n@@ -365,0 +367,1 @@\n+  , _indent(0)\n@@ -380,0 +383,1 @@\n+  , _indent(0)\n@@ -397,0 +401,1 @@\n+  , _indent(0)\n@@ -416,0 +421,1 @@\n+  , _indent(0)\n@@ -438,0 +444,1 @@\n+  , _indent(0)\n@@ -462,0 +469,1 @@\n+  , _indent(0)\n@@ -1721,1 +1729,6 @@\n-  st->print(\"%c%d%s\\t%s\\t=== \", is_new ? ' ' : 'o', _idx, mark ? \" >\" : \"\", Name());\n+\n+  if (_indent > 0) {\n+    st->print(\"%*s\", (_indent << 1), \"  \");\n+  }\n+\n+  st->print(\"%c%d%s%s  === \", is_new ? ' ' : 'o', _idx, mark ? \" >\" : \"  \", Name());\n@@ -1846,1 +1859,1 @@\n-\/\/   nstack:        the nodes are collected into this array.\n+\/\/   queue:         the nodes are collected into this array.\n@@ -1854,1 +1867,2 @@\n-static void collect_nodes_i(GrowableArray<Node*> *nstack, const Node* start, int direction, uint depth, bool include_start, bool only_ctrl, bool only_data) {\n+static void collect_nodes_i(GrowableArray<Node*>* queue, const Node* start, int direction, uint depth, bool include_start, bool only_ctrl, bool only_data) {\n+  bool indent = depth <= PrintIdealIndentThreshold;\n@@ -1856,1 +1870,1 @@\n-  nstack->append(s);\n+  queue->append(s);\n@@ -1859,0 +1873,2 @@\n+\n+  s->set_indent(0);\n@@ -1860,1 +1876,1 @@\n-    end = nstack->length();\n+    end = queue->length();\n@@ -1862,1 +1878,1 @@\n-      Node* tp  = nstack->at(j);\n+      Node* tp  = queue->at(j);\n@@ -1872,4 +1888,4 @@\n-\n-        bool on_stack = nstack->contains(n);\n-        if (!on_stack) {\n-          nstack->append(n);\n+        bool in_queue = queue->contains(n);\n+        if (!in_queue) {\n+          queue->append(n);\n+          n->set_indent(indent ? (i + 1) : 0);\n@@ -1882,1 +1898,1 @@\n-    nstack->remove(s);\n+    queue->remove(s);\n@@ -1890,2 +1906,2 @@\n-  GrowableArray <Node *> nstack(Compile::current()->live_nodes());\n-  collect_nodes_i(&nstack, start, d, (uint) ABS(d), true, only_ctrl, false);\n+  GrowableArray <Node *> queue(Compile::current()->live_nodes());\n+  collect_nodes_i(&queue, start, d, (uint) ABS(d), true, only_ctrl, false);\n@@ -1893,1 +1909,1 @@\n-  int end = nstack.length();\n+  int end = queue.length();\n@@ -1896,1 +1912,1 @@\n-      nstack.at(j)->dump();\n+      queue.at(j)->dump();\n@@ -1900,1 +1916,1 @@\n-      nstack.at(j)->dump();\n+      queue.at(j)->dump();\n","filename":"src\/hotspot\/share\/opto\/node.cpp","additions":33,"deletions":17,"binary":false,"changes":50,"status":"modified"},{"patch":"@@ -1122,0 +1122,6 @@\n+  int _indent;\n+\n+ public:\n+  void set_indent(int indent) { _indent = indent; }\n+\n+ private:\n","filename":"src\/hotspot\/share\/opto\/node.hpp","additions":6,"deletions":0,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2016, 2017, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2016, 2020, Oracle and\/or its affiliates. All rights reserved.\n@@ -59,1 +59,1 @@\n-            String v = \"\\t\" + entry.getKey();\n+            String v = entry.getKey();\n","filename":"test\/hotspot\/jtreg\/compiler\/c2\/cr7200264\/TestDriver.java","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -76,1 +76,1 @@\n-            int separatorIndex = line.indexOf(\"\\t===\");\n+            int separatorIndex = line.indexOf(\"  ===\");\n@@ -79,1 +79,1 @@\n-                if (header.endsWith(\"\\tSafePoint\")) {\n+                if (header.endsWith(\"SafePoint\")) {\n@@ -81,1 +81,1 @@\n-                } else if (header.endsWith(\"\\tCountedLoopEnd\")) {\n+                } else if (header.endsWith(\"CountedLoopEnd\")) {\n@@ -113,1 +113,1 @@\n-            \/\/ example:  318    SafePoint       ===  317  1  304  1  1  10  308  [[ 97  74 ]]  ...\n+            \/\/ example:  318    SafePoint  ===  317  1  304  1  1  10  308  [[ 97  74 ]]  ...\n","filename":"test\/hotspot\/jtreg\/compiler\/loopopts\/UseCountedLoopSafepointsTest.java","additions":4,"deletions":4,"binary":false,"changes":8,"status":"modified"}]}