{"files":[{"patch":"@@ -157,0 +157,1 @@\n+  const address _insn_addr;\n@@ -159,0 +160,7 @@\n+  static uint32_t insn_at(address insn_addr, int n) {\n+    return ((uint32_t*)insn_addr)[n];\n+  }\n+  uint32_t insn_at(int n) const {\n+    return insn_at(_insn_addr, n);\n+  }\n+\n@@ -161,2 +169,3 @@\n-  RelocActions(address insn_addr) : _insn(*(uint32_t*)insn_addr) {}\n-  RelocActions(address insn_addr, uint32_t insn) : _insn(insn) {}\n+  RelocActions(address insn_addr) : _insn_addr(insn_addr), _insn(insn_at(insn_addr, 0)) {}\n+  RelocActions(address insn_addr, uint32_t insn)\n+    :  _insn_addr(insn_addr), _insn(insn) {}\n@@ -219,1 +228,1 @@\n-          uint32_t insn2 = ((uint32_t*)insn_addr)[1];\n+          uint32_t insn2 = insn_at(1);\n@@ -303,9 +312,7 @@\n-    if (inner) {\n-      instructions = 2;\n-      uintptr_t dest = (uintptr_t)target;\n-      uintptr_t pc_page = (uintptr_t)insn_addr >> 12;\n-      uintptr_t adr_page = (uintptr_t)target >> 12;\n-      uint32_t offset_lo = dest & 0xfff;\n-      offset = adr_page - pc_page;\n-      instructions = (*inner)(insn_addr, target);\n-    }\n+    instructions = 2;\n+    precond(inner != nullptr);\n+    uintptr_t dest = (uintptr_t)target;\n+    uintptr_t pc_page = (uintptr_t)insn_addr >> 12;\n+    uintptr_t adr_page = (uintptr_t)target >> 12;\n+    offset = adr_page - pc_page;\n+    instructions = (*inner)(insn_addr, target);\n@@ -313,1 +320,1 @@\n-    \/\/ the ADR or ADRP.\n+    \/\/ the ADRP.\n@@ -324,1 +331,1 @@\n-    uint32_t insn2 = ((uint32_t*)insn_addr)[1];\n+    uint32_t insn2 = insn_at(insn_addr, 1);\n@@ -429,1 +436,1 @@\n-    uint32_t insn2 = ((uint32_t*)insn_addr)[1];\n+    uint32_t insn2 = insn_at(1);\n@@ -431,0 +438,1 @@\n+    precond(inner != nullptr);\n@@ -435,1 +443,1 @@\n-    uint32_t insn2 = ((uint32_t*)insn_addr)[1];\n+    uint32_t insn2 = insn_at(insn_addr, 1);\n@@ -444,1 +452,1 @@\n-    uint32_t insn2 = ((uint32_t*)insn_addr)[1];\n+    uint32_t insn2 = insn_at(insn_addr, 1);\n@@ -451,1 +459,1 @@\n-    uint32_t insn2 = ((uint32_t*)insn_addr)[1];\n+    uint32_t insn2 = insn_at(insn_addr, 1);\n@@ -459,1 +467,1 @@\n-    uint32_t insn = ((uint32_t*)insn_addr)[0];\n+    uint32_t insn = insn_at(insn_addr, 0);\n","filename":"src\/hotspot\/cpu\/aarch64\/macroAssembler_aarch64.cpp","additions":27,"deletions":19,"binary":false,"changes":46,"status":"modified"}]}