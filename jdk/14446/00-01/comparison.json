{"files":[{"patch":"@@ -41,0 +41,32 @@\n+# Note that while the build system supports linking against libffi on Windows (x64),\n+# I couldn't get this script working with a Windows devkit, and instead had to manually create\n+# a libffi bundle for Windows. The steps I took were as follows:\n+#\n+# 1. run 'x64 Native Tools Command Prompt for VS 2022'. After that, cl.exe and link.exe should be on path\n+#\n+# 2. in the same shell, run `ucrt64` (this is one of the shell environments that comes with MSYS2).\n+#    This should carry over the environment set up by the VS dev prompt into the ucrt64 prompt.\n+#\n+# 3. then, in the libffi repo root folder:\n+#   3.a run `autogen.sh`\n+#   3.b run:\n+# ```\n+# bash configure \\\n+#   CC=\"\/path\/to\/libffi\/msvcc.sh -m64\" \\\n+#   CXX=\"\/path\/to\/libffi\/msvcc.sh -m64\" \\\n+#   CPPFLAGS=\"-DFFI_BUILDING_DLL\" \\\n+#   --disable-docs \\\n+#   --prefix=<install dest>\n+# ```\n+# (`<install dest>` can be whatever you like. That's what you point `--with-libffi` to).\n+#\n+# 4. run `make install`. This should create the `<install dest>` directory with the files:\n+#    `include\/ffi.h`, `include\/ffitarget.h`, `lib\/libffi.dll`. It also creates a `lib\/libffi.lib` file,\n+#    but it is of the wrong file type, `DLL` rather than `LIBRARY`.\n+#\n+# 5. Manually create a working `.lib` file (in the <install dest>\/lib dir):\n+#   5.a use `dumpbin \/exports libffi.dll` to get a list of exported symbols\n+#   5.b put them in a `libffi.def` file: `EXPORTS` on the first line, then a symbol on each line following\n+#   5.c run `lib \/def:libffi.def \/machine:x64 \/out:libffi.lib` to create the right `.lib` file (`lib` is a visual studio tool)\n+#\n+\n","filename":"make\/devkit\/createLibffiBundle.sh","additions":32,"deletions":0,"binary":false,"changes":32,"status":"modified"},{"patch":"@@ -231,1 +231,1 @@\n-\t  LIBS_windows := $(LIBFFI_LIBS) ws2_32.lib, \\\n+      LIBS_windows := $(LIBFFI_LIBS) ws2_32.lib, \\\n","filename":"make\/modules\/java.base\/Lib.gmk","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"}]}