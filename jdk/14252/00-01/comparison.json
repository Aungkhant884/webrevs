{"files":[{"patch":"@@ -55,2 +55,0 @@\n-        ValidatePathWithURL pathValidator = new ValidatePathWithURL();\n-\n@@ -58,1 +56,1 @@\n-            pathValidator.enableCRLOnly();\n+            ValidatePathWithURL.enableCRLOnly();\n@@ -61,1 +59,1 @@\n-            pathValidator.enableOCSPOnly();\n+            ValidatePathWithURL.enableOCSPOnly();\n@@ -64,4 +62,4 @@\n-        new AmazonCA_1().runTest(pathValidator);\n-        new AmazonCA_2().runTest(pathValidator);\n-        new AmazonCA_3().runTest(pathValidator);\n-        new AmazonCA_4().runTest(pathValidator);\n+        new AmazonCA_1().runTest();\n+        new AmazonCA_2().runTest();\n+        new AmazonCA_3().runTest();\n+        new AmazonCA_4().runTest();\n@@ -74,2 +72,4 @@\n-    private static final String CA_FINGERPRINT =\n-            \"8E:CD:E6:88:4F:3D:87:B1:12:5B:A3:1A:C3:FC:B1:3D:70:16:DE:7F:57:CC:90:4F:E1:CB:97:C6:AE:98:19:6E\";\n+    private static final String CA_ALIAS = \"amazonrootca1 [jdk]\";\n+\n+    public void runTest() throws Exception {\n+        ValidatePathWithURL validatePathWithURL = new ValidatePathWithURL(CA_ALIAS);\n@@ -77,3 +77,2 @@\n-    public void runTest(ValidatePathWithURL pathValidator) throws CertificateEncodingException {\n-        pathValidator.validateDomain(VALID, false, CA_FINGERPRINT);\n-        pathValidator.validateDomain(REVOKED, true, CA_FINGERPRINT);\n+        validatePathWithURL.validateDomain(VALID, false);\n+        validatePathWithURL.validateDomain(REVOKED, true);\n@@ -86,2 +85,4 @@\n-    private static final String CA_FINGERPRINT =\n-            \"1B:A5:B2:AA:8C:65:40:1A:82:96:01:18:F8:0B:EC:4F:62:30:4D:83:CE:C4:71:3A:19:C3:9C:01:1E:A4:6D:B4\";\n+    private static final String CA_ALIAS = \"amazonrootca2 [jdk]\";\n+\n+    public void runTest() throws Exception {\n+        ValidatePathWithURL validatePathWithURL = new ValidatePathWithURL(CA_ALIAS);\n@@ -89,3 +90,2 @@\n-    public void runTest(ValidatePathWithURL pathValidator) throws CertificateEncodingException {\n-        pathValidator.validateDomain(VALID, false, CA_FINGERPRINT);\n-        pathValidator.validateDomain(REVOKED, true, CA_FINGERPRINT);\n+        validatePathWithURL.validateDomain(VALID, false);\n+        validatePathWithURL.validateDomain(REVOKED, true);\n@@ -98,2 +98,1 @@\n-    private static final String CA_FINGERPRINT =\n-            \"18:CE:6C:FE:7B:F1:4E:60:B2:E3:47:B8:DF:E8:68:CB:31:D0:2E:BB:3A:DA:27:15:69:F5:03:43:B4:6D:B3:A4\";\n+    private static final String CA_ALIAS = \"amazonrootca3 [jdk]\";\n@@ -101,3 +100,5 @@\n-    public void runTest(ValidatePathWithURL pathValidator) throws CertificateEncodingException {\n-        pathValidator.validateDomain(VALID, false, CA_FINGERPRINT);\n-        pathValidator.validateDomain(REVOKED, true, CA_FINGERPRINT);\n+    public void runTest() throws Exception {\n+        ValidatePathWithURL validatePathWithURL = new ValidatePathWithURL(CA_ALIAS);\n+\n+        validatePathWithURL.validateDomain(VALID, false);\n+        validatePathWithURL.validateDomain(REVOKED, true);\n@@ -110,2 +111,4 @@\n-    private static final String CA_FINGERPRINT =\n-            \"E3:5D:28:41:9E:D0:20:25:CF:A6:90:38:CD:62:39:62:45:8D:A5:C6:95:FB:DE:A3:C2:2B:0B:FB:25:89:70:92\";\n+    private static final String CA_ALIAS = \"amazonrootca4 [jdk]\";\n+\n+    public void runTest() throws Exception {\n+        ValidatePathWithURL validatePathWithURL = new ValidatePathWithURL(CA_ALIAS);\n@@ -113,3 +116,2 @@\n-    public void runTest(ValidatePathWithURL pathValidator) throws CertificateEncodingException {\n-        pathValidator.validateDomain(VALID, false, CA_FINGERPRINT);\n-        pathValidator.validateDomain(REVOKED, true, CA_FINGERPRINT);\n+        validatePathWithURL.validateDomain(VALID, false);\n+        validatePathWithURL.validateDomain(REVOKED, true);\n","filename":"test\/jdk\/security\/infra\/java\/security\/cert\/CertPathValidator\/certification\/AmazonCA.java","additions":30,"deletions":28,"binary":false,"changes":58,"status":"modified"},{"patch":"@@ -46,1 +46,0 @@\n-import java.security.cert.CertificateEncodingException;\n@@ -51,2 +50,0 @@\n-        ValidatePathWithURL pathValidator = new ValidatePathWithURL();\n-\n@@ -54,1 +51,1 @@\n-            pathValidator.enableCRLOnly();\n+            ValidatePathWithURL.enableCRLOnly();\n@@ -57,1 +54,1 @@\n-            pathValidator.enableOCSPOnly();\n+            ValidatePathWithURL.enableOCSPOnly();\n@@ -60,4 +57,4 @@\n-        new ComodoRSA().runTest(pathValidator);\n-        new ComodoECC().runTest(pathValidator);\n-        new ComodoUserTrustRSA().runTest(pathValidator);\n-        new ComodoUserTrustECC().runTest(pathValidator);\n+        new ComodoRSA().runTest();\n+        new ComodoECC().runTest();\n+        new ComodoUserTrustRSA().runTest();\n+        new ComodoUserTrustECC().runTest();\n@@ -70,2 +67,4 @@\n-    private static final String CA_FINGERPRINT =\n-            \"52:F0:E1:C4:E5:8E:C6:29:29:1B:60:31:7F:07:46:71:B8:5D:7E:A8:0D:5B:07:27:34:63:53:4B:32:B4:02:34\";\n+    private static final String CA_ALIAS = \"comodorsaca [jdk]\";\n+\n+    public void runTest() throws Exception {\n+        ValidatePathWithURL validatePathWithURL = new ValidatePathWithURL(CA_ALIAS);\n@@ -73,3 +72,2 @@\n-    public void runTest(ValidatePathWithURL pathValidator) throws CertificateEncodingException {\n-        pathValidator.validateDomain(VALID, false, CA_FINGERPRINT);\n-        pathValidator.validateDomain(REVOKED, true, CA_FINGERPRINT);\n+        validatePathWithURL.validateDomain(VALID, false);\n+        validatePathWithURL.validateDomain(REVOKED, true);\n@@ -82,2 +80,4 @@\n-    private static final String CA_FINGERPRINT =\n-            \"17:93:92:7A:06:14:54:97:89:AD:CE:2F:8F:34:F7:F0:B6:6D:0F:3A:E3:A3:B8:4D:21:EC:15:DB:BA:4F:AD:C7\";\n+    private static final String CA_ALIAS = \"comodoeccca [jdk]\";\n+\n+    public void runTest() throws Exception {\n+        ValidatePathWithURL validatePathWithURL = new ValidatePathWithURL(CA_ALIAS);\n@@ -85,3 +85,2 @@\n-    public void runTest(ValidatePathWithURL pathValidator) throws CertificateEncodingException {\n-        pathValidator.validateDomain(VALID, false, CA_FINGERPRINT);\n-        pathValidator.validateDomain(REVOKED, true, CA_FINGERPRINT);\n+        validatePathWithURL.validateDomain(VALID, false);\n+        validatePathWithURL.validateDomain(REVOKED, true);\n@@ -94,2 +93,1 @@\n-    private static final String CA_FINGERPRINT =\n-            \"E7:93:C9:B0:2F:D8:AA:13:E2:1C:31:22:8A:CC:B0:81:19:64:3B:74:9C:89:89:64:B1:74:6D:46:C3:D4:CB:D2\";\n+    private static final String CA_ALIAS = \"usertrustrsaca [jdk]\";\n@@ -97,3 +95,5 @@\n-    public void runTest(ValidatePathWithURL pathValidator) throws CertificateEncodingException {\n-        pathValidator.validateDomain(VALID, false, CA_FINGERPRINT);\n-        pathValidator.validateDomain(REVOKED, true, CA_FINGERPRINT);\n+    public void runTest() throws Exception {\n+        ValidatePathWithURL validatePathWithURL = new ValidatePathWithURL(CA_ALIAS);\n+\n+        validatePathWithURL.validateDomain(VALID, false);\n+        validatePathWithURL.validateDomain(REVOKED, true);\n@@ -106,2 +106,4 @@\n-    private static final String CA_FINGERPRINT =\n-            \"4F:F4:60:D5:4B:9C:86:DA:BF:BC:FC:57:12:E0:40:0D:2B:ED:3F:BC:4D:4F:BD:AA:86:E0:6A:DC:D2:A9:AD:7A\";\n+    private static final String CA_ALIAS = \"usertrusteccca [jdk]\";\n+\n+    public void runTest() throws Exception {\n+        ValidatePathWithURL validatePathWithURL = new ValidatePathWithURL(CA_ALIAS);\n@@ -109,3 +111,2 @@\n-    public void runTest(ValidatePathWithURL pathValidator) throws CertificateEncodingException {\n-        pathValidator.validateDomain(VALID, false, CA_FINGERPRINT);\n-        pathValidator.validateDomain(REVOKED, true, CA_FINGERPRINT);\n+        validatePathWithURL.validateDomain(VALID, false);\n+        validatePathWithURL.validateDomain(REVOKED, true);\n","filename":"test\/jdk\/security\/infra\/java\/security\/cert\/CertPathValidator\/certification\/ComodoCA.java","additions":30,"deletions":29,"binary":false,"changes":59,"status":"modified"},{"patch":"@@ -49,1 +49,6 @@\n-            ValidatePathWithURL pathValidator = new ValidatePathWithURL();\n+        if (args.length >= 1 && \"CRL\".equalsIgnoreCase(args[0])) {\n+            ValidatePathWithURL.enableCRLOnly();\n+        } else {\n+            \/\/ OCSP check by default\n+            ValidatePathWithURL.enableOCSPOnly();\n+        }\n@@ -51,9 +56,2 @@\n-            if (args.length >= 1 && \"CRL\".equalsIgnoreCase(args[0])) {\n-                pathValidator.enableCRLOnly();\n-            } else {\n-                \/\/ OCSP check by default\n-                pathValidator.enableOCSPOnly();\n-            }\n-\n-        new Entrust_ECCA().runTest(pathValidator);\n-        new Entrust_G4().runTest(pathValidator);\n+        new Entrust_ECCA().runTest();\n+        new Entrust_G4().runTest();\n@@ -66,2 +64,4 @@\n-    private static final String CA_FINGERPRINT =\n-            \"E7:93:C9:B0:2F:D8:AA:13:E2:1C:31:22:8A:CC:B0:81:19:64:3B:74:9C:89:89:64:B1:74:6D:46:C3:D4:CB:D2\";\n+    private static final String CA_ALIAS = \"entrustrootcaec1 [jdk]\";\n+\n+    public void runTest() throws Exception {\n+        ValidatePathWithURL validatePathWithURL = new ValidatePathWithURL(CA_ALIAS);\n@@ -69,3 +69,2 @@\n-    public void runTest(ValidatePathWithURL pathValidator) throws CertificateEncodingException {\n-        pathValidator.validateDomain(VALID, false, CA_FINGERPRINT);\n-        pathValidator.validateDomain(REVOKED, true, CA_FINGERPRINT);\n+        validatePathWithURL.validateDomain(VALID, false);\n+        validatePathWithURL.validateDomain(REVOKED, true);\n@@ -78,2 +77,4 @@\n-    private static final String CA_FINGERPRINT =\n-            \"DB:35:17:D1:F6:73:2A:2D:5A:B9:7C:53:3E:C7:07:79:EE:32:70:A6:2F:B4:AC:42:38:37:24:60:E6:F0:1E:88\";\n+    private static final String CA_ALIAS = \"entrustrootcag4 [jdk]\";\n+\n+    public void runTest() throws Exception {\n+        ValidatePathWithURL validatePathWithURL = new ValidatePathWithURL(CA_ALIAS);\n@@ -81,3 +82,2 @@\n-    public void runTest(ValidatePathWithURL pathValidator) throws CertificateEncodingException {\n-        pathValidator.validateDomain(VALID, false, CA_FINGERPRINT);\n-        pathValidator.validateDomain(REVOKED, true, CA_FINGERPRINT);\n+        validatePathWithURL.validateDomain(VALID, false);\n+        validatePathWithURL.validateDomain(REVOKED, true);\n","filename":"test\/jdk\/security\/infra\/java\/security\/cert\/CertPathValidator\/certification\/EntrustCA.java","additions":20,"deletions":20,"binary":false,"changes":40,"status":"modified"},{"patch":"@@ -47,2 +47,1 @@\n-     private static final String CA_FINGERPRINT =\n-             \"2C:AB:EA:FE:37:D0:6C:A2:2A:BA:73:91:C0:03:3D:25:98:29:52:C4:53:64:73:49:76:3A:3A:B5:AD:6C:CF:69\";\n+    private static final String CA_ALIAS = \"globalsignrootcar6 [jdk]\";\n@@ -50,1 +49,1 @@\n-     public static void main(String[] args) throws Exception {\n+    public static void main(String[] args) throws Exception {\n@@ -52,1 +51,6 @@\n-         ValidatePathWithURL validatePathWithURL = new ValidatePathWithURL();\n+        if (args.length >= 1 && \"CRL\".equalsIgnoreCase(args[0])) {\n+            ValidatePathWithURL.enableCRLOnly();\n+        } else {\n+            \/\/ OCSP check by default\n+            ValidatePathWithURL.enableOCSPOnly();\n+        }\n@@ -54,6 +58,1 @@\n-         if (args.length >= 1 && \"CRL\".equalsIgnoreCase(args[0])) {\n-             validatePathWithURL.enableCRLOnly();\n-         } else {\n-             \/\/ OCSP check by default\n-             validatePathWithURL.enableOCSPOnly();\n-         }\n+        ValidatePathWithURL validatePathWithURL = new ValidatePathWithURL(CA_ALIAS);\n@@ -61,3 +60,3 @@\n-         validatePathWithURL.validateDomain(VALID, false, CA_FINGERPRINT);\n-         validatePathWithURL.validateDomain(REVOKED, true, CA_FINGERPRINT);\n-     }\n+        validatePathWithURL.validateDomain(VALID, false);\n+        validatePathWithURL.validateDomain(REVOKED, true);\n+    }\n","filename":"test\/jdk\/security\/infra\/java\/security\/cert\/CertPathValidator\/certification\/GlobalSignR6CA.java","additions":12,"deletions":13,"binary":false,"changes":25,"status":"modified"},{"patch":"@@ -43,16 +43,0 @@\n-\n-import java.security.cert.CertificateEncodingException;\n-\n-\/*\n- * Obtain test artifacts for GoDaddy\/Starfield CAs from:\n- *\n- * Go Daddy Root Certificate Authority - G2:\n- *    valid:\n- *    expired: https:\/\/expired.gdig2.catest.godaddy.com\/\n- *    revoked:\n- *\n- * Starfield Root Certificate Authority - G2:\n- *    valid:\n- *    expired: https:\/\/expired.sfig2.catest.starfieldtech.com\/\n- *    revoked:\n- *\/\n@@ -63,2 +47,0 @@\n-        ValidatePathWithURL pathValidator = new ValidatePathWithURL();\n-\n@@ -66,1 +48,1 @@\n-            pathValidator.enableCRLOnly();\n+            ValidatePathWithURL.enableCRLOnly();\n@@ -69,1 +51,1 @@\n-            pathValidator.enableOCSPOnly();\n+            ValidatePathWithURL.enableOCSPOnly();\n@@ -72,2 +54,2 @@\n-        new GoDaddyGdig2().runTest(pathValidator);\n-        new GoDaddySfig2().runTest(pathValidator);\n+        new GoDaddyGdig2().runTest();\n+        new GoDaddySfig2().runTest();\n@@ -80,2 +62,1 @@\n-    private static final String CA_FINGERPRINT =\n-            \"45:14:0B:32:47:EB:9C:C8:C5:B4:F0:D7:B5:30:91:F7:32:92:08:9E:6E:5A:63:E2:74:9D:D3:AC:A9:19:8E:DA\";\n+    private static final String CA_ALIAS = \"godaddyrootg2ca [jdk]\";\n@@ -83,3 +64,5 @@\n-    public void runTest(ValidatePathWithURL pathValidator) throws CertificateEncodingException {\n-        pathValidator.validateDomain(VALID, false, CA_FINGERPRINT);\n-        pathValidator.validateDomain(REVOKED, true, CA_FINGERPRINT);\n+    public void runTest() throws Exception {\n+        ValidatePathWithURL validatePathWithURL = new ValidatePathWithURL(CA_ALIAS);\n+\n+        validatePathWithURL.validateDomain(VALID, false);\n+        validatePathWithURL.validateDomain(REVOKED, true);\n@@ -92,2 +75,4 @@\n-    private static final String CA_FINGERPRINT =\n-            \"2C:E1:CB:0B:F9:D2:F9:E1:02:99:3F:BE:21:51:52:C3:B2:DD:0C:AB:DE:1C:68:E5:31:9B:83:91:54:DB:B7:F5\";\n+    private static final String CA_ALIAS = \"starfieldrootg2ca [jdk]\";\n+\n+    public void runTest() throws Exception {\n+        ValidatePathWithURL validatePathWithURL = new ValidatePathWithURL(CA_ALIAS);\n@@ -95,3 +80,2 @@\n-    public void runTest(ValidatePathWithURL pathValidator) throws CertificateEncodingException {\n-        pathValidator.validateDomain(VALID, false, CA_FINGERPRINT);\n-        pathValidator.validateDomain(REVOKED, true, CA_FINGERPRINT);\n+        validatePathWithURL.validateDomain(VALID, false);\n+        validatePathWithURL.validateDomain(REVOKED, true);\n","filename":"test\/jdk\/security\/infra\/java\/security\/cert\/CertPathValidator\/certification\/GoDaddyCA.java","additions":16,"deletions":32,"binary":false,"changes":48,"status":"modified"},{"patch":"@@ -44,2 +44,0 @@\n-import java.security.cert.CertificateEncodingException;\n-\n@@ -55,2 +53,0 @@\n-        ValidatePathWithURL pathValidator = new ValidatePathWithURL();\n-\n@@ -58,1 +54,1 @@\n-            pathValidator.enableCRLOnly();\n+            ValidatePathWithURL.enableCRLOnly();\n@@ -61,1 +57,1 @@\n-            pathValidator.enableOCSPOnly();\n+            ValidatePathWithURL.enableOCSPOnly();\n@@ -64,5 +60,5 @@\n-        new GoogleGSR4().runTest(pathValidator);\n-        new GoogleGTSR1().runTest(pathValidator);\n-        new GoogleGTSR2().runTest(pathValidator);\n-        new GoogleGTSR3().runTest(pathValidator);\n-        new GoogleGTSR4().runTest(pathValidator);\n+        new GoogleGSR4().runTest();\n+        new GoogleGTSR1().runTest();\n+        new GoogleGTSR2().runTest();\n+        new GoogleGTSR3().runTest();\n+        new GoogleGTSR4().runTest();\n@@ -75,2 +71,1 @@\n-    private static final String CA_FINGERPRINT =\n-            \"BE:C9:49:11:C2:95:56:76:DB:6C:0A:55:09:86:D7:6E:3B:A0:05:66:7C:44:2C:97:62:B4:FB:B7:73:DE:22:8C\";\n+    private static final String CA_ALIAS = \"globalsigneccrootcar4 [jdk]\";\n@@ -78,3 +73,5 @@\n-    public void runTest(ValidatePathWithURL pathValidator) throws CertificateEncodingException {\n-        pathValidator.validateDomain(VALID, false, CA_FINGERPRINT);\n-        pathValidator.validateDomain(REVOKED, true, CA_FINGERPRINT);\n+    public void runTest() throws Exception {\n+        ValidatePathWithURL validatePathWithURL = new ValidatePathWithURL(CA_ALIAS);\n+\n+        validatePathWithURL.validateDomain(VALID, false);\n+        validatePathWithURL.validateDomain(REVOKED, true);\n@@ -87,2 +84,4 @@\n-    private static final String CA_FINGERPRINT =\n-            \"D9:47:43:2A:BD:E7:B7:FA:90:FC:2E:6B:59:10:1B:12:80:E0:E1:C7:E4:E4:0F:A3:C6:88:7F:FF:57:A7:F4:CF\";\n+    private static final String CA_ALIAS = \"gtsrootcar1 [jdk]\";\n+\n+    public void runTest() throws Exception {\n+        ValidatePathWithURL validatePathWithURL = new ValidatePathWithURL(CA_ALIAS);\n@@ -90,3 +89,2 @@\n-    public void runTest(ValidatePathWithURL pathValidator) throws CertificateEncodingException {\n-        pathValidator.validateDomain(VALID, false, CA_FINGERPRINT);\n-        pathValidator.validateDomain(REVOKED, true, CA_FINGERPRINT);\n+        validatePathWithURL.validateDomain(VALID, false);\n+        validatePathWithURL.validateDomain(REVOKED, true);\n@@ -99,2 +97,1 @@\n-    private static final String CA_FINGERPRINT =\n-            \"8D:25:CD:97:22:9D:BF:70:35:6B:DA:4E:B3:CC:73:40:31:E2:4C:F0:0F:AF:CF:D3:2D:C7:6E:B5:84:1C:7E:A8\";\n+    private static final String CA_ALIAS = \"gtsrootcar2 [jdk]\";\n@@ -102,3 +99,5 @@\n-    public void runTest(ValidatePathWithURL pathValidator) throws CertificateEncodingException {\n-        pathValidator.validateDomain(VALID, false, CA_FINGERPRINT);\n-        pathValidator.validateDomain(REVOKED, true, CA_FINGERPRINT);\n+    public void runTest() throws Exception {\n+        ValidatePathWithURL validatePathWithURL = new ValidatePathWithURL(CA_ALIAS);\n+\n+        validatePathWithURL.validateDomain(VALID, false);\n+        validatePathWithURL.validateDomain(REVOKED, true);\n@@ -111,2 +110,4 @@\n-    private static final String CA_FINGERPRINT =\n-            \"34:D8:A7:3E:E2:08:D9:BC:DB:0D:95:65:20:93:4B:4E:40:E6:94:82:59:6E:8B:6F:73:C8:42:6B:01:0A:6F:48\";\n+    private static final String CA_ALIAS = \"gtsrootecccar3 [jdk]\";\n+\n+    public void runTest() throws Exception {\n+        ValidatePathWithURL validatePathWithURL = new ValidatePathWithURL(CA_ALIAS);\n@@ -114,3 +115,2 @@\n-    public void runTest(ValidatePathWithURL pathValidator) throws CertificateEncodingException {\n-        pathValidator.validateDomain(VALID, false, CA_FINGERPRINT);\n-        pathValidator.validateDomain(REVOKED, true, CA_FINGERPRINT);\n+        validatePathWithURL.validateDomain(VALID, false);\n+        validatePathWithURL.validateDomain(REVOKED, true);\n@@ -123,2 +123,4 @@\n-    private static final String CA_FINGERPRINT =\n-            \"34:9D:FA:40:58:C5:E2:63:12:3B:39:8A:E7:95:57:3C:4E:13:13:C8:3F:E6:8F:93:55:6C:D5:E8:03:1B:3C:7D\";\n+    private static final String CA_ALIAS = \"gtsrootecccar4 [jdk]\";\n+\n+    public void runTest() throws Exception {\n+        ValidatePathWithURL validatePathWithURL = new ValidatePathWithURL(CA_ALIAS);\n@@ -126,3 +128,2 @@\n-    public void runTest(ValidatePathWithURL pathValidator) throws CertificateEncodingException {\n-        pathValidator.validateDomain(VALID, false, CA_FINGERPRINT);\n-        pathValidator.validateDomain(REVOKED, true, CA_FINGERPRINT);\n+        validatePathWithURL.validateDomain(VALID, false);\n+        validatePathWithURL.validateDomain(REVOKED, true);\n","filename":"test\/jdk\/security\/infra\/java\/security\/cert\/CertPathValidator\/certification\/GoogleCA.java","additions":37,"deletions":36,"binary":false,"changes":73,"status":"modified"},{"patch":"@@ -24,2 +24,0 @@\n-import java.security.Security;\n-\n@@ -39,2 +37,1 @@\n-     private static final String CA_FINGERPRINT =\n-             \"96:BC:EC:06:26:49:76:F3:74:60:77:9A:CF:28:C5:A7:CF:E8:A3:C0:AA:E1:1A:8F:FC:EE:05:C0:BD:DF:08:C6\";\n+    private static final String CA_ALIAS = \"letsencryptisrgx1 [jdk]\";\n@@ -44,2 +41,0 @@\n-         ValidatePathWithURL validatePathWithURL = new ValidatePathWithURL();\n-\n@@ -47,1 +42,1 @@\n-             validatePathWithURL.enableCRLOnly();\n+             ValidatePathWithURL.enableCRLOnly();\n@@ -49,1 +44,1 @@\n-             validatePathWithURL.enableOCSPOnly();\n+             ValidatePathWithURL.enableOCSPOnly();\n@@ -52,1 +47,1 @@\n-             validatePathWithURL.enableOCSPAndCRL();\n+             ValidatePathWithURL.enableOCSPAndCRL();\n@@ -55,2 +50,4 @@\n-         validatePathWithURL.validateDomain(VALID, false, CA_FINGERPRINT);\n-         validatePathWithURL.validateDomain(REVOKED, true, CA_FINGERPRINT);\n+         ValidatePathWithURL validatePathWithURL = new ValidatePathWithURL(CA_ALIAS);\n+\n+         validatePathWithURL.validateDomain(VALID, false);\n+         validatePathWithURL.validateDomain(REVOKED, true);\n","filename":"test\/jdk\/security\/infra\/java\/security\/cert\/CertPathValidator\/certification\/LetsEncryptCA.java","additions":8,"deletions":11,"binary":false,"changes":19,"status":"modified"},{"patch":"@@ -44,1 +44,0 @@\n-import java.security.cert.CertificateEncodingException;\n@@ -49,2 +48,0 @@\n-        ValidatePathWithURL pathValidator = new ValidatePathWithURL();\n-\n@@ -52,1 +49,1 @@\n-            pathValidator.enableCRLOnly();\n+            ValidatePathWithURL.enableCRLOnly();\n@@ -55,1 +52,1 @@\n-            pathValidator.enableOCSPOnly();\n+            ValidatePathWithURL.enableOCSPOnly();\n@@ -58,2 +55,2 @@\n-        new MicrosoftECCTLS().runTest(pathValidator);\n-        new MicrosoftRSATLS().runTest(pathValidator);\n+        new MicrosoftECCTLS().runTest();\n+        new MicrosoftRSATLS().runTest();\n@@ -66,2 +63,4 @@\n-    private static final String CA_FINGERPRINT =\n-            \"35:8D:F3:9D:76:4A:F9:E1:B7:66:E9:C9:72:DF:35:2E:E1:5C:FA:C2:27:AF:6A:D1:D7:0E:8E:4A:6E:DC:BA:02\";\n+    private static final String CA_ALIAS = \"microsoftecc2017 [jdk]\";\n+\n+    public void runTest() throws Exception {\n+        ValidatePathWithURL validatePathWithURL = new ValidatePathWithURL(CA_ALIAS);\n@@ -69,3 +68,2 @@\n-    public void runTest(ValidatePathWithURL pathValidator) throws CertificateEncodingException {\n-        pathValidator.validateDomain(VALID, false, CA_FINGERPRINT);\n-        pathValidator.validateDomain(REVOKED, true, CA_FINGERPRINT);\n+        validatePathWithURL.validateDomain(VALID, false);\n+        validatePathWithURL.validateDomain(REVOKED, true);\n@@ -78,2 +76,4 @@\n-    private static final String CA_FINGERPRINT =\n-            \"C7:41:F7:0F:4B:2A:8D:88:BF:2E:71:C1:41:22:EF:53:EF:10:EB:A0:CF:A5:E6:4C:FA:20:F4:18:85:30:73:E0\";\n+    private static final String CA_ALIAS = \"microsoftrsa2017 [jdk]\";\n+\n+    public void runTest() throws Exception {\n+        ValidatePathWithURL validatePathWithURL = new ValidatePathWithURL(CA_ALIAS);\n@@ -81,3 +81,2 @@\n-    public void runTest(ValidatePathWithURL pathValidator) throws CertificateEncodingException {\n-        pathValidator.validateDomain(VALID, false, CA_FINGERPRINT);\n-        pathValidator.validateDomain(REVOKED, true, CA_FINGERPRINT);\n+        validatePathWithURL.validateDomain(VALID, false);\n+        validatePathWithURL.validateDomain(REVOKED, true);\n","filename":"test\/jdk\/security\/infra\/java\/security\/cert\/CertPathValidator\/certification\/MicrosoftTLS.java","additions":16,"deletions":17,"binary":false,"changes":33,"status":"modified"},{"patch":"@@ -44,2 +44,0 @@\n-import java.security.cert.CertificateEncodingException;\n-\n@@ -55,2 +53,0 @@\n-        ValidatePathWithURL pathValidator = new ValidatePathWithURL();\n-\n@@ -58,1 +54,1 @@\n-            pathValidator.enableCRLOnly();\n+            ValidatePathWithURL.enableCRLOnly();\n@@ -61,1 +57,1 @@\n-            pathValidator.enableOCSPOnly();\n+            ValidatePathWithURL.enableOCSPOnly();\n@@ -64,3 +60,3 @@\n-        new RootCA1G3().runTest(pathValidator);\n-        new RootCA2G3().runTest(pathValidator);\n-        new RootCA3G3().runTest(pathValidator);\n+        new RootCA1G3().runTest();\n+        new RootCA2G3().runTest();\n+        new RootCA3G3().runTest();\n@@ -73,2 +69,4 @@\n-    private static final String CA_FINGERPRINT =\n-            \"8A:86:6F:D1:B2:76:B5:7E:57:8E:92:1C:65:82:8A:2B:ED:58:E9:F2:F2:88:05:41:34:B7:F1:F4:BF:C9:CC:74\";\n+    private static final String CA_ALIAS = \"quovadisrootca1g3 [jdk]\";\n+\n+    public void runTest() throws Exception {\n+        ValidatePathWithURL validatePathWithURL = new ValidatePathWithURL(CA_ALIAS);\n@@ -76,3 +74,2 @@\n-    public void runTest(ValidatePathWithURL pathValidator) throws CertificateEncodingException {\n-        pathValidator.validateDomain(VALID, false, CA_FINGERPRINT);\n-        pathValidator.validateDomain(REVOKED, true, CA_FINGERPRINT);\n+        validatePathWithURL.validateDomain(VALID, false);\n+        validatePathWithURL.validateDomain(REVOKED, true);\n@@ -85,2 +82,1 @@\n-    private static final String CA_FINGERPRINT =\n-            \"8F:E4:FB:0A:F9:3A:4D:0D:67:DB:0B:EB:B2:3E:37:C7:1B:F3:25:DC:BC:DD:24:0E:A0:4D:AF:58:B4:7E:18:40\";\n+    private static final String CA_ALIAS = \"quovadisrootca2g3 [jdk]\";\n@@ -88,3 +84,5 @@\n-    public void runTest(ValidatePathWithURL pathValidator) throws CertificateEncodingException {\n-        pathValidator.validateDomain(VALID, false, CA_FINGERPRINT);\n-        pathValidator.validateDomain(REVOKED, true, CA_FINGERPRINT);\n+    public void runTest() throws Exception {\n+        ValidatePathWithURL validatePathWithURL = new ValidatePathWithURL(CA_ALIAS);\n+\n+        validatePathWithURL.validateDomain(VALID, false);\n+        validatePathWithURL.validateDomain(REVOKED, true);\n@@ -97,2 +95,4 @@\n-    private static final String CA_FINGERPRINT =\n-            \"88:EF:81:DE:20:2E:B0:18:45:2E:43:F8:64:72:5C:EA:5F:BD:1F:C2:D9:D2:05:73:07:09:C5:D8:B8:69:0F:46\";\n+    private static final String CA_ALIAS = \"quovadisrootca3g3 [jdk]\";\n+\n+    public void runTest() throws Exception {\n+        ValidatePathWithURL validatePathWithURL = new ValidatePathWithURL(CA_ALIAS);\n@@ -100,3 +100,2 @@\n-    public void runTest(ValidatePathWithURL pathValidator) throws CertificateEncodingException {\n-        pathValidator.validateDomain(VALID, false, CA_FINGERPRINT);\n-        pathValidator.validateDomain(REVOKED, true, CA_FINGERPRINT);\n+        validatePathWithURL.validateDomain(VALID, false);\n+        validatePathWithURL.validateDomain(REVOKED, true);\n","filename":"test\/jdk\/security\/infra\/java\/security\/cert\/CertPathValidator\/certification\/QuoVadisCA.java","additions":23,"deletions":24,"binary":false,"changes":47,"status":"modified"},{"patch":"@@ -44,2 +44,0 @@\n-import java.security.cert.CertificateEncodingException;\n-\n@@ -50,4 +48,0 @@\n-        System.setProperty(\"jdk.security.certpath.ocspNonce\", \"true\");\n-\n-        ValidatePathWithURL pathValidator = new ValidatePathWithURL();\n-\n@@ -55,1 +49,1 @@\n-            pathValidator.enableCRLOnly();\n+            ValidatePathWithURL.enableCRLOnly();\n@@ -58,1 +52,1 @@\n-            pathValidator.enableOCSPOnly();\n+            ValidatePathWithURL.enableOCSPOnly();\n@@ -61,3 +55,3 @@\n-        new SSLCA_RSA().runTest(pathValidator);\n-        new SSLCA_EV_RSA().runTest(pathValidator);\n-        new SSLCA_ECC().runTest(pathValidator);\n+        new SSLCA_RSA().runTest();\n+        new SSLCA_EV_RSA().runTest();\n+        new SSLCA_ECC().runTest();\n@@ -70,2 +64,1 @@\n-    private static final String CA_FINGERPRINT =\n-            \"85:66:6A:56:2E:E0:BE:5C:E9:25:C1:D8:89:0A:6F:76:A8:7E:C1:6D:4D:7D:5F:29:EA:74:19:CF:20:12:3B:69\";\n+    private static final String CA_ALIAS = \"sslrootrsaca [jdk]\";\n@@ -73,3 +66,5 @@\n-    public void runTest(ValidatePathWithURL pathValidator) throws CertificateEncodingException {\n-        pathValidator.validateDomain(VALID, false, CA_FINGERPRINT);\n-        pathValidator.validateDomain(REVOKED, true, CA_FINGERPRINT);\n+    public void runTest() throws Exception {\n+        ValidatePathWithURL validatePathWithURL = new ValidatePathWithURL(CA_ALIAS);\n+\n+        validatePathWithURL.validateDomain(VALID, false);\n+        validatePathWithURL.validateDomain(REVOKED, true);\n@@ -82,2 +77,4 @@\n-    private static final String CA_FINGERPRINT =\n-            \"2E:7B:F1:6C:C2:24:85:A7:BB:E2:AA:86:96:75:07:61:B0:AE:39:BE:3B:2F:E9:D0:CC:6D:4E:F7:34:91:42:5C\";\n+    private static final String CA_ALIAS = \"sslrootevrsaca [jdk]\";\n+\n+    public void runTest() throws Exception {\n+        ValidatePathWithURL validatePathWithURL = new ValidatePathWithURL(CA_ALIAS);\n@@ -85,3 +82,2 @@\n-    public void runTest(ValidatePathWithURL pathValidator) throws CertificateEncodingException {\n-        pathValidator.validateDomain(VALID, false, CA_FINGERPRINT);\n-        pathValidator.validateDomain(REVOKED, true, CA_FINGERPRINT);\n+        validatePathWithURL.validateDomain(VALID, false);\n+        validatePathWithURL.validateDomain(REVOKED, true);\n@@ -94,2 +90,4 @@\n-    private static final String CA_FINGERPRINT =\n-            \"34:17:BB:06:CC:60:07:DA:1B:96:1C:92:0B:8A:B4:CE:3F:AD:82:0E:4A:A3:0B:9A:CB:C4:A7:4E:BD:CE:BC:65\";\n+    private static final String CA_ALIAS = \"sslrooteccca [jdk]\";\n+\n+    public void runTest() throws Exception {\n+        ValidatePathWithURL validatePathWithURL = new ValidatePathWithURL(CA_ALIAS);\n@@ -97,3 +95,2 @@\n-    public void runTest(ValidatePathWithURL pathValidator) throws CertificateEncodingException {\n-        pathValidator.validateDomain(VALID, false, CA_FINGERPRINT);\n-        pathValidator.validateDomain(REVOKED, true, CA_FINGERPRINT);\n+        validatePathWithURL.validateDomain(VALID, false);\n+        validatePathWithURL.validateDomain(REVOKED, true);\n","filename":"test\/jdk\/security\/infra\/java\/security\/cert\/CertPathValidator\/certification\/SSLCA.java","additions":23,"deletions":26,"binary":false,"changes":49,"status":"modified"},{"patch":"@@ -44,9 +44,0 @@\n-\/*\n- * Obtain TLS test artifacts for TWCA Global Root CA from:\n- *\n- * Valid TLS Certificates:\n- * https:\/\/evssldemo6.twca.com.tw\n- *\n- * Revoked TLS Certificates:\n- * https:\/\/evssldemo7.twca.com.tw\n- *\/\n@@ -57,2 +48,1 @@\n-    private static final String CA_FINGERPRINT =\n-            \"59:76:90:07:F7:68:5D:0F:CD:50:87:2F:9F:95:D5:75:5A:5B:2B:45:7D:81:F3:69:2B:61:0A:98:67:2F:0E:1B\";\n+    private static final String CA_ALIAS = \"twcaglobalrootca [jdk]\";\n@@ -62,2 +52,0 @@\n-        ValidatePathWithURL validatePathWithURL = new ValidatePathWithURL();\n-\n@@ -65,1 +53,1 @@\n-            validatePathWithURL.enableCRLOnly();\n+            ValidatePathWithURL.enableCRLOnly();\n@@ -68,1 +56,1 @@\n-            validatePathWithURL.enableOCSPOnly();\n+            ValidatePathWithURL.enableOCSPOnly();\n@@ -71,2 +59,4 @@\n-        validatePathWithURL.validateDomain(VALID, false, CA_FINGERPRINT);\n-        validatePathWithURL.validateDomain(REVOKED, true, CA_FINGERPRINT);\n+        ValidatePathWithURL validatePathWithURL = new ValidatePathWithURL(CA_ALIAS);\n+\n+        validatePathWithURL.validateDomain(VALID, false);\n+        validatePathWithURL.validateDomain(REVOKED, true);\n","filename":"test\/jdk\/security\/infra\/java\/security\/cert\/CertPathValidator\/certification\/TWCAGlobalCA.java","additions":7,"deletions":17,"binary":false,"changes":24,"status":"modified"},{"patch":"@@ -48,2 +48,1 @@\n-    private static final String CA_FINGERPRINT =\n-            \"DD:69:36:FE:21:F8:F0:77:C1:23:A1:A5:21:C1:22:24:F7:22:55:B7:3E:03:A7:26:06:93:E8:A2:4B:0F:A3:89\";\n+    private static final String CA_ALIAS = \"teliasonerarootcav1 [jdk]\";\n@@ -53,2 +52,0 @@\n-        ValidatePathWithURL validatePathWithURL = new ValidatePathWithURL();\n-\n@@ -56,1 +53,1 @@\n-            validatePathWithURL.enableCRLOnly();\n+            ValidatePathWithURL.enableCRLOnly();\n@@ -59,1 +56,1 @@\n-            validatePathWithURL.enableOCSPOnly();\n+            ValidatePathWithURL.enableOCSPOnly();\n@@ -62,2 +59,4 @@\n-        validatePathWithURL.validateDomain(VALID, false, CA_FINGERPRINT);\n-        validatePathWithURL.validateDomain(REVOKED, true, CA_FINGERPRINT);\n+        ValidatePathWithURL validatePathWithURL = new ValidatePathWithURL(CA_ALIAS);\n+\n+        validatePathWithURL.validateDomain(VALID, false);\n+        validatePathWithURL.validateDomain(REVOKED, true);\n","filename":"test\/jdk\/security\/infra\/java\/security\/cert\/CertPathValidator\/certification\/TeliaSoneraCA.java","additions":7,"deletions":8,"binary":false,"changes":15,"status":"modified"},{"patch":"@@ -111,0 +111,1 @@\n+                        System.out.println(\"Issuer: \" + certificate.getIssuerX500Principal());\n@@ -125,0 +126,1 @@\n+            System.out.println(\"intermediate CA Issuer: \" + interCert.getIssuerX500Principal());\n","filename":"test\/jdk\/security\/infra\/java\/security\/cert\/CertPathValidator\/certification\/ValidatePathWithURL.java","additions":2,"deletions":0,"binary":false,"changes":2,"status":"modified"}]}