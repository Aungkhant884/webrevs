{"files":[{"patch":"@@ -25,1 +25,1 @@\n- * @test\n+ * @test id=OCSP\n@@ -28,1 +28,3 @@\n- * @build ValidatePathWithParams\n+ * @library \/test\/lib\n+ * @build jtreg.SkippedException\n+ * @build ValidatePathWithURL\n@@ -30,1 +32,0 @@\n- * @run main\/othervm\/timeout=180 -Djava.security.debug=certpath ActalisCA CRL\n@@ -33,11 +34,8 @@\n- \/*\n- * Obtain test artifacts for Actalis CA from:\n- *\n- * Test website with *active* TLS Server certificate:\n- * https:\/\/ssltest-active.actalis.it\/\n- *\n- * Test website with *revoked* TLS Server certificate:\n- * https:\/\/ssltest-revoked.actalis.it\/\n- *\n- * Test website with *expired* TLS Server certificate:\n- * https:\/\/ssltest-expired.actalis.it\/\n+\/*\n+ * @test id=CRL\n+ * @bug 8189131\n+ * @summary Interoperability tests with Actalis CA\n+ * @library \/test\/lib\n+ * @build jtreg.SkippedException\n+ * @build ValidatePathWithURL\n+ * @run main\/othervm\/timeout=180 -Djava.security.debug=certpath ActalisCA CRL\n@@ -45,50 +43,0 @@\n-public class ActalisCA {\n-\n-    \/\/ Owner: CN=Actalis Organization Validated Server CA G3, O=Actalis S.p.A.,\n-    \/\/        L=Ponte San Pietro, ST=Bergamo, C=IT\n-    \/\/ Issuer: CN=Actalis Authentication Root CA, O=Actalis S.p.A .\/03358520967,\n-    \/\/         L=Milan, C=IT\n-    \/\/ Serial number: 5c3b3f37adfc28fe0fcfd3abf83f8551\n-    \/\/ Valid from: Mon Jul 06 00:20:55 PDT 2020 until: Sun Sep 22 04:22:02 PDT 2030\n-    private static final String INT = \"-----BEGIN CERTIFICATE-----\\n\" +\n-            \"MIIHdTCCBV2gAwIBAgIQXDs\/N638KP4Pz9Or+D+FUTANBgkqhkiG9w0BAQsFADBr\\n\" +\n-            \"MQswCQYDVQQGEwJJVDEOMAwGA1UEBwwFTWlsYW4xIzAhBgNVBAoMGkFjdGFsaXMg\\n\" +\n-            \"Uy5wLkEuLzAzMzU4NTIwOTY3MScwJQYDVQQDDB5BY3RhbGlzIEF1dGhlbnRpY2F0\\n\" +\n-            \"aW9uIFJvb3QgQ0EwHhcNMjAwNzA2MDcyMDU1WhcNMzAwOTIyMTEyMjAyWjCBiTEL\\n\" +\n-            \"MAkGA1UEBhMCSVQxEDAOBgNVBAgMB0JlcmdhbW8xGTAXBgNVBAcMEFBvbnRlIFNh\\n\" +\n-            \"biBQaWV0cm8xFzAVBgNVBAoMDkFjdGFsaXMgUy5wLkEuMTQwMgYDVQQDDCtBY3Rh\\n\" +\n-            \"bGlzIE9yZ2FuaXphdGlvbiBWYWxpZGF0ZWQgU2VydmVyIENBIEczMIICIjANBgkq\\n\" +\n-            \"hkiG9w0BAQEFAAOCAg8AMIICCgKCAgEAs73Ch+t2owm3ayTkyqy0OPuCTiybxTyS\\n\" +\n-            \"4cU4y0t2RGSwCNjLh\/rcutO0yoriZxVtPrNMcIRQ544BQhHFt\/ypW7e+t8wWKrHa\\n\" +\n-            \"r3BkKwSUbqNwpDWP1bXs7IJTVhHXWGAm7Ak1FhrrBmtXk8QtdzTzDDuxfFBK7sCL\\n\" +\n-            \"N0Jdqoqb1V1z3wsWqAvr4KlSCFW05Nh4baWm\/kXOmb8U+XR6kUmuoVvia3iBhotR\\n\" +\n-            \"TzAHTO9SWWkgjTcir\/nhBvyL2RoqkgYyP\/k50bznaVOGFnFWzfl0XnrM\/salfCBh\\n\" +\n-            \"O0\/1vNaoU8elR6AtbdCFAupgQy95GuFIRVS8n\/cF0QupfPjUl+kGSLzvGAc+6oNE\\n\" +\n-            \"alpAhKIS\/+P0uODzRrS9Eq0WX1iSj6KHtQMNN4ZKsS4nsuvYCahnAc0QwQyoduAW\\n\" +\n-            \"iU\/ynhU9WTIEe1VIoEDE79NPOI2\/80RqbZqdpAKUaf0FvuqVXhEcjiJJu+d0w9YN\\n\" +\n-            \"b7gurd6xkaSXemW\/fP4idBiNkd8aCVAdshGQYn6yh+na0Lu5IG88Z2kSIFcXDtwy\\n\" +\n-            \"zjcxkW86pwkO6GekEomVBNKcv0Cey2Smf8uhpZk15TSCeyFDrZBWH9OsDst\/Tnhz\\n\" +\n-            \"pN156Huw3M3RRdEegt33fcyPykgt0HThxrEv9DwOzhs6lCQ5RNQJO7ZvZF1ZiqgT\\n\" +\n-            \"FOJ6vs1xMqECAwEAAaOCAfQwggHwMA8GA1UdEwEB\/wQFMAMBAf8wHwYDVR0jBBgw\\n\" +\n-            \"FoAUUtiIOsifeGbtifN7OHCUyQICNtAwQQYIKwYBBQUHAQEENTAzMDEGCCsGAQUF\\n\" +\n-            \"BzABhiVodHRwOi8vb2NzcDA1LmFjdGFsaXMuaXQvVkEvQVVUSC1ST09UMEUGA1Ud\\n\" +\n-            \"IAQ+MDwwOgYEVR0gADAyMDAGCCsGAQUFBwIBFiRodHRwczovL3d3dy5hY3RhbGlz\\n\" +\n-            \"Lml0L2FyZWEtZG93bmxvYWQwHQYDVR0lBBYwFAYIKwYBBQUHAwIGCCsGAQUFBwMB\\n\" +\n-            \"MIHjBgNVHR8EgdswgdgwgZaggZOggZCGgY1sZGFwOi8vbGRhcDA1LmFjdGFsaXMu\\n\" +\n-            \"aXQvY24lM2RBY3RhbGlzJTIwQXV0aGVudGljYXRpb24lMjBSb290JTIwQ0EsbyUz\\n\" +\n-            \"ZEFjdGFsaXMlMjBTLnAuQS4lMmYwMzM1ODUyMDk2NyxjJTNkSVQ\/Y2VydGlmaWNh\\n\" +\n-            \"dGVSZXZvY2F0aW9uTGlzdDtiaW5hcnkwPaA7oDmGN2h0dHA6Ly9jcmwwNS5hY3Rh\\n\" +\n-            \"bGlzLml0L1JlcG9zaXRvcnkvQVVUSC1ST09UL2dldExhc3RDUkwwHQYDVR0OBBYE\\n\" +\n-            \"FJ+KsbXxsd6C9Cd8vojN3qlDgaNLMA4GA1UdDwEB\/wQEAwIBBjANBgkqhkiG9w0B\\n\" +\n-            \"AQsFAAOCAgEAJbygMnKJ5M6byr5Ectq05ODqwNMtky8TEF3O55g6RHhxblf6OegZ\\n\" +\n-            \"4ui4+ElHNOIXjycbeuUGuFA4LScCC9fnI1Rnn8TI2Q7OP5YWifEfnrdp99t\/tJzQ\\n\" +\n-            \"hfdi7ZTdRRZZGV9x+grfR\/RtjT2C3Lt9X4lcbuSxTea3PHAwwi0A3bYRR1L5ciPm\\n\" +\n-            \"eAnYtG9kpat8\/RuC22oxiZZ5FdjU6wrRWkASRLiIwNcFIYfvpUbMWElaCUhqaB2y\\n\" +\n-            \"YvWF8o02pnaYb4bvTCg4cVabVnojUuuXH81LeQhhsSXLwcdwSdew0NL4zCiNCn2Q\\n\" +\n-            \"iDZpz2biCWDggibmWxsUUF6AbqMHnwsdS8vsKXiFQJHeAdNAhA+kwpqYAdhUiCdj\\n\" +\n-            \"RTUdtRNUucLvZEN1OAvVYyog9xYCfhtkqgXQROMANP+Z\/+yaZahaP\/Vgak\/V00se\\n\" +\n-            \"Hdh7F+B6h5HVdwdh+17E2jl+aMTfyvBFcg2H\/9Qjyl4TY8NW\/6v0DPK52sVt8a35\\n\" +\n-            \"I+7xLGLPohAl4z6pEf2OxgjMNfXXCXS33smRgz1dLQFo8UpAb3rf84zkXaqEI6Qi\\n\" +\n-            \"2P+5pibVFQigRbn4RcE+K2a\/nm2M\/o+WZTSio+E+YXacnNk71VcO82biOof+jBKT\\n\" +\n-            \"iC3Xi7rAlypmme+QFBw9F1J89ig3smV\/HaN8tO0lfTpvm7Zvzd5TkMs=\\n\" +\n-            \"-----END CERTIFICATE-----\";\n@@ -96,102 +44,4 @@\n-    \/\/ Owner: CN=ssltest-active.actalis.it, O=Actalis S.p.A., L=Ponte San Pietro,\n-    \/\/        ST=Bergamo, C=IT\n-    \/\/ Issuer: CN=Actalis Organization Validated Server CA G3, O=Actalis S.p A.,\n-    \/\/         L=Ponte San Pietro, ST=Bergamo, C=IT\n-    \/\/ Serial number: 4a49e2afcd448af3b7f5f14e1cd5954\n-    \/\/ Valid from: Tue Mar 08 08:00:57 PST 2022 until: Wed Mar 08 08:00:57 PST 2023\n-    private static final String VALID = \"-----BEGIN CERTIFICATE-----\\n\" +\n-            \"MIIH0jCCBbqgAwIBAgIQBKSeKvzUSK87f18U4c1ZVDANBgkqhkiG9w0BAQsFADCB\\n\" +\n-            \"iTELMAkGA1UEBhMCSVQxEDAOBgNVBAgMB0JlcmdhbW8xGTAXBgNVBAcMEFBvbnRl\\n\" +\n-            \"IFNhbiBQaWV0cm8xFzAVBgNVBAoMDkFjdGFsaXMgUy5wLkEuMTQwMgYDVQQDDCtB\\n\" +\n-            \"Y3RhbGlzIE9yZ2FuaXphdGlvbiBWYWxpZGF0ZWQgU2VydmVyIENBIEczMB4XDTIy\\n\" +\n-            \"MDMwODE2MDA1N1oXDTIzMDMwODE2MDA1N1owdzELMAkGA1UEBhMCSVQxEDAOBgNV\\n\" +\n-            \"BAgMB0JlcmdhbW8xGTAXBgNVBAcMEFBvbnRlIFNhbiBQaWV0cm8xFzAVBgNVBAoM\\n\" +\n-            \"DkFjdGFsaXMgUy5wLkEuMSIwIAYDVQQDDBlzc2x0ZXN0LWFjdGl2ZS5hY3RhbGlz\\n\" +\n-            \"Lml0MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAsJnlOatNNth7gfqZ\\n\" +\n-            \"WN8HMfp9qlkDf\/YW8ReNXyTtqFEy2xZrVVmAV2XIqL1lJDYJz86mdVsz3AqIMTzo\\n\" +\n-            \"GxPlmn\/oEnF0YeRYQ1coKRdwP7hWSwqyMMhh+C7r5zMA9gQQVXV5wWR5U+bgvt23\\n\" +\n-            \"Y\/55DOqk3Fp5Odt6Lyu6xA45MwHrj2Gr\/nMKe8L7f8UYPWT98MJa1+TXB24yllOw\\n\" +\n-            \"rZE8gZByLBCVzDkVwRwTgu+HgY6zm5sJTvBT4tyJy4QD8u2xLWoZ5sXodrU0Z3Nf\\n\" +\n-            \"xU9keMFp6CIh1t+akqFgpW81b\/HWkfUO0+L6PH4hgaSPtiwp2dVFsF9v5p4on9qA\\n\" +\n-            \"2j1d9QIDAQABo4IDRTCCA0EwDAYDVR0TAQH\/BAIwADAfBgNVHSMEGDAWgBSfirG1\\n\" +\n-            \"8bHegvQnfL6Izd6pQ4GjSzB+BggrBgEFBQcBAQRyMHAwOwYIKwYBBQUHMAKGL2h0\\n\" +\n-            \"dHA6Ly9jYWNlcnQuYWN0YWxpcy5pdC9jZXJ0cy9hY3RhbGlzLWF1dGhvdmczMDEG\\n\" +\n-            \"CCsGAQUFBzABhiVodHRwOi8vb2NzcDA5LmFjdGFsaXMuaXQvVkEvQVVUSE9WLUcz\\n\" +\n-            \"MCQGA1UdEQQdMBuCGXNzbHRlc3QtYWN0aXZlLmFjdGFsaXMuaXQwUQYDVR0gBEow\\n\" +\n-            \"SDA8BgYrgR8BFAEwMjAwBggrBgEFBQcCARYkaHR0cHM6Ly93d3cuYWN0YWxpcy5p\\n\" +\n-            \"dC9hcmVhLWRvd25sb2FkMAgGBmeBDAECAjAdBgNVHSUEFjAUBggrBgEFBQcDAgYI\\n\" +\n-            \"KwYBBQUHAwEwSAYDVR0fBEEwPzA9oDugOYY3aHR0cDovL2NybDA5LmFjdGFsaXMu\\n\" +\n-            \"aXQvUmVwb3NpdG9yeS9BVVRIT1YtRzMvZ2V0TGFzdENSTDAdBgNVHQ4EFgQUIbcm\\n\" +\n-            \"54DVM6gC8DYhvnZg8ILaLrAwDgYDVR0PAQH\/BAQDAgWgMIIBfQYKKwYBBAHWeQIE\\n\" +\n-            \"AgSCAW0EggFpAWcAdQCt9776fP8QyIudPZwePhhqtGcpXc+xDCTKhYY069yCigAA\\n\" +\n-            \"AX9qTFEkAAAEAwBGMEQCIFB4RW+Fca\/jj96sFg9JtZVe\/CAQq74HAezTi2AD07qL\\n\" +\n-            \"AiBej8APns5uKmaHNYbU6lel6kdowIaUY\/+iqX82e2KhrAB2AOg+0No+9QY1MudX\\n\" +\n-            \"KLyJa8kD08vREWvs62nhd31tBr1uAAABf2pMUVMAAAQDAEcwRQIgcopYpSUDiQ2C\\n\" +\n-            \"7j06vgbfsn3ux4REvpbrbWatifLtfVMCIQCi96i+4EhAUOw4dumA7hJwlG+qD\/+5\\n\" +\n-            \"uSL3aKB9KR7apAB2AG9Tdqwx8DEZ2JkApFEV\/3cVHBHZAsEAKQaNsgiaN9kTAAAB\\n\" +\n-            \"f2pMUYEAAAQDAEcwRQIgdCNjaV7nQcCiVefX28u1vtQMy+rqT4F4i9EVJ2xbqbQC\\n\" +\n-            \"IQCrpcYqt53tX\/rSMoGnjFhDGnMhnYyc2AqzpokfhmdcVTANBgkqhkiG9w0BAQsF\\n\" +\n-            \"AAOCAgEAfXISBKP1dZQv1kkWZVDXiVY\/fv+068DKq2e8hgBcsN6b9a2rlVfBU2iq\\n\" +\n-            \"W9KqFNET5GDWf1wjM71Itjau8b1A3+apcNdEGQk3eqIOymK5kVtVvAI2ahp4926x\\n\" +\n-            \"Kkt\/sexmi1pJGA+eLfTixkCoaESh5P8U7HDW\/vUFXm2AtLQih+oT5OVoYt5e9pXr\\n\" +\n-            \"hr8oadm\/ZDJxiyDL1vcTIsl2TM4\/Fpo2IWxYzUC+YshnuLiRwWI840maJmWFx\/lJ\\n\" +\n-            \"Pzdik3P51Uef7VsCSBhTxER09\/B4IrEUMDAhVgG5QNbcFSHvnmpV8JLrNuBKUROU\\n\" +\n-            \"xnDsWieKlb5YO6S6PjGOncOrd+k4RCIYRaekSnx52WBKkpqxMEv\/rjY1Glx4Cota\\n\" +\n-            \"mpNiYDvZHGzrRQtY2eH17XhFatBxEEbJMA+0QPbFksHcKxAxJgMDncqag4TDq5fT\\n\" +\n-            \"I2NUxqiB51F5w0x+++lyLnUZ+z4BJFZ73VdtfoJ2fsuRhemOoZjHPi\/V2exXpAfb\\n\" +\n-            \"pomha3KCrTcuFv1lj8mPx5L4ciNPxuDFgjeXEaTGjS8IvdNoJIrgdHdahMwkwS\/y\\n\" +\n-            \"wei7FJ1Ey0maqRUpUlAY6sIQPQ\/KDltTuKX\/C94C5pYLI0JXCScr5xg6C+r2ckbA\\n\" +\n-            \"rjhpn3C\/NptVyZgT8bL4XT5ITrAjwPciBj0yxYzUkrLZO1wKQSQ=\\n\" +\n-            \"-----END CERTIFICATE-----\";\n-\n-    \/\/ Owner: CN=ssltest-revoked.actalis.it, O=Actalis S.p.A., L=Ponte San Pietro, ST=Bergamo, C=IT\n-    \/\/ Issuer: CN=Actalis Organization Validated Server CA G3, O=Actalis S.p.A.,\n-    \/\/ L=Ponte San Pietro, ST=Bergamo, C=IT\n-    \/\/ Serial number: 320955171b78d49507508910da2c5bc4\n-    \/\/ Valid from: Tue Sep 27 03:40:43 PDT 2022 until: Wed Sep 27 03:40:43 PDT 2023\n-    private static final String REVOKED = \"-----BEGIN CERTIFICATE-----\\n\" +\n-            \"MIIH1TCCBb2gAwIBAgIQMglVFxt41JUHUIkQ2ixbxDANBgkqhkiG9w0BAQsFADCB\\n\" +\n-            \"iTELMAkGA1UEBhMCSVQxEDAOBgNVBAgMB0JlcmdhbW8xGTAXBgNVBAcMEFBvbnRl\\n\" +\n-            \"IFNhbiBQaWV0cm8xFzAVBgNVBAoMDkFjdGFsaXMgUy5wLkEuMTQwMgYDVQQDDCtB\\n\" +\n-            \"Y3RhbGlzIE9yZ2FuaXphdGlvbiBWYWxpZGF0ZWQgU2VydmVyIENBIEczMB4XDTIy\\n\" +\n-            \"MDkyNzEwNDA0M1oXDTIzMDkyNzEwNDA0M1oweDELMAkGA1UEBhMCSVQxEDAOBgNV\\n\" +\n-            \"BAgMB0JlcmdhbW8xGTAXBgNVBAcMEFBvbnRlIFNhbiBQaWV0cm8xFzAVBgNVBAoM\\n\" +\n-            \"DkFjdGFsaXMgUy5wLkEuMSMwIQYDVQQDDBpzc2x0ZXN0LXJldm9rZWQuYWN0YWxp\\n\" +\n-            \"cy5pdDCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBAKdBnbeFtw\/Ejp1U\\n\" +\n-            \"gr86BQ5rqgGXWWXb7fsOhPb5On9RXTojg6oaeIV4GxHsMZhEDKQdcZ6JWAo2dbtp\\n\" +\n-            \"\/7ereFEDWG\/YJahLHFZ\/ihXG4AmfObYEhoGbKitW75fOs\/aWC7Veck\/sXsw7cjLW\\n\" +\n-            \"GY623ybcF9DBExg3S4uLRaSkv5hXUDu\/CzphUgwiEd5YNBZjcryOiS8+Y5EQ+2q+\\n\" +\n-            \"g+tdRG9m5G5YxeHWgQz2HDDwLDsJhWkb8\/RsUurU\/I+avHPhYk13K5Ysf311gww8\\n\" +\n-            \"bAsplfdJ2gdn8Is+EAEH4GJHqMybC95YDh1w5dY7dk\/lIoNX4hYUIQimirIr3OW8\\n\" +\n-            \"Svkj1G8CAwEAAaOCA0cwggNDMAwGA1UdEwEB\/wQCMAAwHwYDVR0jBBgwFoAUn4qx\\n\" +\n-            \"tfGx3oL0J3y+iM3eqUOBo0swfgYIKwYBBQUHAQEEcjBwMDsGCCsGAQUFBzAChi9o\\n\" +\n-            \"dHRwOi8vY2FjZXJ0LmFjdGFsaXMuaXQvY2VydHMvYWN0YWxpcy1hdXRob3ZnMzAx\\n\" +\n-            \"BggrBgEFBQcwAYYlaHR0cDovL29jc3AwOS5hY3RhbGlzLml0L1ZBL0FVVEhPVi1H\\n\" +\n-            \"MzAlBgNVHREEHjAcghpzc2x0ZXN0LXJldm9rZWQuYWN0YWxpcy5pdDBRBgNVHSAE\\n\" +\n-            \"SjBIMDwGBiuBHwEUATAyMDAGCCsGAQUFBwIBFiRodHRwczovL3d3dy5hY3RhbGlz\\n\" +\n-            \"Lml0L2FyZWEtZG93bmxvYWQwCAYGZ4EMAQICMB0GA1UdJQQWMBQGCCsGAQUFBwMC\\n\" +\n-            \"BggrBgEFBQcDATBIBgNVHR8EQTA\/MD2gO6A5hjdodHRwOi8vY3JsMDkuYWN0YWxp\\n\" +\n-            \"cy5pdC9SZXBvc2l0b3J5L0FVVEhPVi1HMy9nZXRMYXN0Q1JMMB0GA1UdDgQWBBS6\\n\" +\n-            \"o8qJpg3ixoyA2QBayptaTfc+5DAOBgNVHQ8BAf8EBAMCBaAwggF+BgorBgEEAdZ5\\n\" +\n-            \"AgQCBIIBbgSCAWoBaAB2AK33vvp8\/xDIi509nB4+GGq0Zyldz7EMJMqFhjTr3IKK\\n\" +\n-            \"AAABg36SGRYAAAQDAEcwRQIgDXxSCQGfcIYroxNiDJg08IX38Y9+r5CC6T4NeW14\\n\" +\n-            \"FzgCIQDdEhEYsGIWpwyrnTLr4RFB5CMEq+84dByNT07UYkiVwwB2AHoyjFTYty22\\n\" +\n-            \"IOo44FIe6YQWcDIThU070ivBOlejUutSAAABg36SGTUAAAQDAEcwRQIgL2ig9RrM\\n\" +\n-            \"FPWESGRYGJJJYRHdcayHev66jawrf98saN8CIQD\/CInlI3Vo7SBzzN\/4uykjYsFZ\\n\" +\n-            \"u9RypT6AYv6AHPlNdQB2AG9Tdqwx8DEZ2JkApFEV\/3cVHBHZAsEAKQaNsgiaN9kT\\n\" +\n-            \"AAABg36SGU0AAAQDAEcwRQIhAOCD\/dOs4HjyC+GQaQRh4U+\/mUwWyu+CnlHdebmD\\n\" +\n-            \"hAvFAiAvBE0rbxgm8TpZLG2TaMk3dqZj7Q6FFdLlqTsvwhKa3jANBgkqhkiG9w0B\\n\" +\n-            \"AQsFAAOCAgEAEnPALMVp1pySJgHhugLWAUgiD6stpDWCKfaBxPr+jf34A5wS+m5r\\n\" +\n-            \"2VhYyNQpOwIQB76K2RSJQrdpg7Dg2L6EiUnbbClSTrOkZ4XX5ggBIjldDEx4ZxhI\\n\" +\n-            \"zwSw4KB6+DDAVMwsCL0q0E7AAPOMaZ0RDLteusqQYIYm08TXfJPWD8LjQPt\/8Uie\\n\" +\n-            \"LOqm1eLUuwJc+eHFWV+Xr8Uea6SFwqNEj7qPHb2MElctET\/MhSIIUKI1ObmrFwyB\\n\" +\n-            \"ElKEPaUh9L0HXpnuD8IWc7tw2mdvnWJhuGG8G6JkasTGvtZ4gKIDBdTrJcuj7MCS\\n\" +\n-            \"amz3ZBCY47tP1ohgImjqwg4ITYjX6UQXgj\/nBVDdu+nXkEhx16uPJkTYWaun9Nio\\n\" +\n-            \"8RjYIOxXmDD39QbGUElP0Epsr2wcVT9tIFYMGzUpIO51mCk3Aq1AmiQZwZZhqOIN\\n\" +\n-            \"RDx7lGESPj3IgdVfJi9Ing\/OUNtS46Ug9DSuDcGqdY7KnTYEUdWGsUJNtnpjd4lS\\n\" +\n-            \"U6oIAeW1aKuOve6iNg1vsFAN57aJNh1ih3BOup58J9ve42bNlAYWN8wiNxM+Aeba\\n\" +\n-            \"ArUSTnH\/QEYCyMRD0XqIREVR9VhNODgSZbL3XedYBAW9wImi1whp+u+8aReXd7lC\\n\" +\n-            \"Q3kD9KRyfZ9Kk05Glf3DsZMWvp1N2ZZWaU2Ms5U3ijUheCiBrqrs8a8=\\n\" +\n-            \"-----END CERTIFICATE-----\";\n-\n-    public static void main(String[] args) throws Exception {\n+public class ActalisCA {\n+     private static final String VALID = \"https:\/\/ssltest-active.actalis.it\/\";\n+     private static final String REVOKED = \"https:\/\/ssltest-revoked.actalis.it\/\";\n+     private static final String CA_ALIAS = \"actalisauthenticationrootca [jdk]\";\n@@ -199,1 +49,1 @@\n-        ValidatePathWithParams pathValidator = new ValidatePathWithParams(null);\n+     public static void main(String[] args) throws Exception {\n@@ -201,6 +51,6 @@\n-        if (args.length >= 1 && \"CRL\".equalsIgnoreCase(args[0])) {\n-            pathValidator.enableCRLCheck();\n-        } else {\n-            \/\/ OCSP check by default\n-            pathValidator.enableOCSPCheck();\n-        }\n+         if (args.length >= 1 && \"CRL\".equalsIgnoreCase(args[0])) {\n+             ValidatePathWithURL.enableCRLOnly();\n+         } else {\n+             \/\/ OCSP check by default\n+             ValidatePathWithURL.enableOCSPOnly();\n+         }\n@@ -208,3 +58,1 @@\n-        \/\/ Validate valid\n-        pathValidator.validate(new String[]{VALID, INT},\n-                ValidatePathWithParams.Status.GOOD, null, System.out);\n+         ValidatePathWithURL validatePathWithURL = new ValidatePathWithURL(CA_ALIAS);\n@@ -212,5 +60,3 @@\n-        \/\/ Validate Revoked\n-        pathValidator.validate(new String[]{REVOKED, INT},\n-                ValidatePathWithParams.Status.REVOKED,\n-                \"Tue Sep 27 03:52:40 PDT 2022\", System.out);\n-    }\n+         validatePathWithURL.validateDomain(VALID, false);\n+         validatePathWithURL.validateDomain(REVOKED, true);\n+     }\n","filename":"test\/jdk\/security\/infra\/java\/security\/cert\/CertPathValidator\/certification\/ActalisCA.java","additions":27,"deletions":181,"binary":false,"changes":208,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2019, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2019, 2023, Oracle and\/or its affiliates. All rights reserved.\n@@ -25,1 +25,1 @@\n- * @test\n+ * @test id=OCSP\n@@ -28,1 +28,3 @@\n- * @build ValidatePathWithParams\n+ * @library \/test\/lib\n+ * @build jtreg.SkippedException\n+ * @build ValidatePathWithURL\n@@ -30,0 +32,9 @@\n+ *\/\n+\n+\/*\n+ * @test id=CRL\n+ * @bug 8233223\n+ * @summary Interoperability tests with Amazon's CA1, CA2, CA3, and CA4\n+ * @library \/test\/lib\n+ * @build jtreg.SkippedException\n+ * @build ValidatePathWithURL\n@@ -33,0 +44,2 @@\n+import java.security.cert.CertificateEncodingException;\n+\n@@ -36,12 +49,1 @@\n- * Amazon Root CA 1\n- *     Valid - https:\/\/good.sca1a.amazontrust.com\/\n- *     Revoked - https:\/\/revoked.sca1a.amazontrust.com\/\n- * Amazon Root CA 2\n- *     Valid - https:\/\/good.sca2a.amazontrust.com\/\n- *     Revoked - https:\/\/revoked.sca2a.amazontrust.com\/\n- * Amazon Root CA 3\n- *     Valid - https:\/\/good.sca3a.amazontrust.com\/\n- *     Revoked - https:\/\/revoked.sca3a.amazontrust.com\/\n- * Amazon Root CA 4\n- *     Valid - https:\/\/good.sca4a.amazontrust.com\/\n- *     Revoked - https:\/\/revoked.sca4a.amazontrust.com\/\n+ * https:\/\/www.amazontrust.com\/repository\/\n@@ -53,3 +55,0 @@\n-        ValidatePathWithParams pathValidator = new ValidatePathWithParams(null);\n-        boolean ocspEnabled = false;\n-\n@@ -57,1 +56,1 @@\n-            pathValidator.enableCRLCheck();\n+            ValidatePathWithURL.enableCRLOnly();\n@@ -60,2 +59,1 @@\n-            pathValidator.enableOCSPCheck();\n-            ocspEnabled = true;\n+            ValidatePathWithURL.enableOCSPOnly();\n@@ -64,4 +62,4 @@\n-        new AmazonCA_1().runTest(pathValidator, ocspEnabled);\n-        new AmazonCA_2().runTest(pathValidator, ocspEnabled);\n-        new AmazonCA_3().runTest(pathValidator, ocspEnabled);\n-        new AmazonCA_4().runTest(pathValidator, ocspEnabled);\n+        new AmazonCA_1().runTest();\n+        new AmazonCA_2().runTest();\n+        new AmazonCA_3().runTest();\n+        new AmazonCA_4().runTest();\n@@ -72,0 +70,3 @@\n+    private static final String VALID = \"https:\/\/valid.rootca1.demo.amazontrust.com\/\";\n+    private static final String REVOKED = \"https:\/\/revoked.rootca1.demo.amazontrust.com\/\";\n+    private static final String CA_ALIAS = \"amazonrootca1 [jdk]\";\n@@ -73,59 +74,2 @@\n-    \/\/ Owner: CN=Amazon, OU=Server CA 1A, O=Amazon, C=US\n-    \/\/ Issuer: CN=Amazon Root CA 1, O=Amazon, C=US\n-    \/\/ Serial number: 67f9457508c648c09ca652e71791830e72592\n-    \/\/ Valid from: Wed Oct 21 17:00:00 PDT 2015 until: Sat Oct 18 17:00:00 PDT 2025\n-    private static final String INT = \"-----BEGIN CERTIFICATE-----\\n\" +\n-            \"MIIERzCCAy+gAwIBAgITBn+UV1CMZIwJymUucXkYMOclkjANBgkqhkiG9w0BAQsF\\n\" +\n-            \"ADA5MQswCQYDVQQGEwJVUzEPMA0GA1UEChMGQW1hem9uMRkwFwYDVQQDExBBbWF6\\n\" +\n-            \"b24gUm9vdCBDQSAxMB4XDTE1MTAyMjAwMDAwMFoXDTI1MTAxOTAwMDAwMFowRjEL\\n\" +\n-            \"MAkGA1UEBhMCVVMxDzANBgNVBAoTBkFtYXpvbjEVMBMGA1UECxMMU2VydmVyIENB\\n\" +\n-            \"IDFBMQ8wDQYDVQQDEwZBbWF6b24wggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEK\\n\" +\n-            \"AoIBAQCeQM3XCsIZunv8bSJxOqkc\/ed87uL76FDB7teBNThDRB+1J7aITuadbNfH\\n\" +\n-            \"5ZfZykrdZ1qQLKxP6DwHOmJr9u2b4IxjUX9qUMuq4B02ghD2g6yU3YivEosZ7fpo\\n\" +\n-            \"srD2TBN29JpgPGrOrpOE+ArZuIpBjdKFinemu6fTDD0NCeQlfyHXd1NOYyfYRLTa\\n\" +\n-            \"xlpDqr\/2M41BgSkWQfSPHHyRWNQgWBiGsIQaS8TK0g8OWi1ov78+2K9DWT+AHgXW\\n\" +\n-            \"AanjZK91GfygPXJYSlAGxSiBAwH\/KhAMifhaoFYAbH0Yuohmd85B45G2xVsop4TM\\n\" +\n-            \"Dsl007U7qnS7sdJ4jYGzEvva\/a95AgMBAAGjggE5MIIBNTASBgNVHRMBAf8ECDAG\\n\" +\n-            \"AQH\/AgEAMA4GA1UdDwEB\/wQEAwIBhjAdBgNVHQ4EFgQUYtRCXoZwdWqQvMa40k1g\\n\" +\n-            \"wjS6UTowHwYDVR0jBBgwFoAUhBjMhTTsvAyUlC4IWZzHshBOCggwewYIKwYBBQUH\\n\" +\n-            \"AQEEbzBtMC8GCCsGAQUFBzABhiNodHRwOi8vb2NzcC5yb290Y2ExLmFtYXpvbnRy\\n\" +\n-            \"dXN0LmNvbTA6BggrBgEFBQcwAoYuaHR0cDovL2NydC5yb290Y2ExLmFtYXpvbnRy\\n\" +\n-            \"dXN0LmNvbS9yb290Y2ExLmNlcjA\/BgNVHR8EODA2MDSgMqAwhi5odHRwOi8vY3Js\\n\" +\n-            \"LnJvb3RjYTEuYW1hem9udHJ1c3QuY29tL3Jvb3RjYTEuY3JsMBEGA1UdIAQKMAgw\\n\" +\n-            \"BgYEVR0gADANBgkqhkiG9w0BAQsFAAOCAQEAMHbSWHRFMzGNIE0qhN6gnRahTrTU\\n\" +\n-            \"CDPwe7l9\/q0IA+QBlrpUHnlAreetYeH1jB8uF3qXXzy22gpBU7NqulTkqSPByT1J\\n\" +\n-            \"xOhpT2FpO5R3VAdMPdWfSEgtrED0jkmyUQrR1T+\/A+nBLdJZeQcl+OqLgeY790JM\\n\" +\n-            \"JJTsJnnI6FBWeTGhcDI4Y+n3KS3QCVePeWI7jx1dhrHcXH+QDX8Ywe31hV7YENdr\\n\" +\n-            \"HDpUXrjK6eHN8gazy8G6pndXHFwHp4auiZbJbYAk\/q1peOTRagD2JojcLkm+i3cD\\n\" +\n-            \"843t4By6YT\/PVlePU2PCWejkrJQnKQAPOov7IA8kuO2RDWuzE\/zF6Hotdg==\\n\" +\n-            \"-----END CERTIFICATE-----\";\n-\n-    \/\/ Owner: CN=good.sca1a.amazontrust.com\n-    \/\/ Issuer: CN=Amazon, OU=Server CA 1A, O=Amazon, C=US\n-    \/\/ Serial number: 75a5dd4b767bedc94a4239da65ed9dfef8218\n-    \/\/ Valid from: Fri Dec 17 12:21:50 PST 2021 until: Tue Jan 17 12:21:50 PST 2023\n-    private static final String VALID = \"-----BEGIN CERTIFICATE-----\\n\" +\n-            \"MIIEIDCCAwigAwIBAgITB1pd1LdnvtyUpCOdpl7Z3++CGDANBgkqhkiG9w0BAQsF\\n\" +\n-            \"ADBGMQswCQYDVQQGEwJVUzEPMA0GA1UEChMGQW1hem9uMRUwEwYDVQQLEwxTZXJ2\\n\" +\n-            \"ZXIgQ0EgMUExDzANBgNVBAMTBkFtYXpvbjAeFw0yMTEyMTcyMDIxNTBaFw0yMzAx\\n\" +\n-            \"MTcyMDIxNTBaMCUxIzAhBgNVBAMTGmdvb2Quc2NhMWEuYW1hem9udHJ1c3QuY29t\\n\" +\n-            \"MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA5SadXE1HIzUp4ob40roo\\n\" +\n-            \"qBiJy57vLcZklkWoxRU2JtIauuZUl8fLT\/KOjzW71fqMMTxnvEbtKtRtZKDFjrg7\\n\" +\n-            \"uPf8Q1J9tqxme6iFlrBlou+moQQ7Spi3H9q7v08vX19XIREGIwHbicbxVujdeA0w\\n\" +\n-            \"G0fGMlw+Gs8GNiBQplr+oXC7i2CoPmwnR\/T8iHjCEznKQIMxiZL4gOHLwh4EKdBA\\n\" +\n-            \"auirpTq0iXUtC2BcM\/w1Zx1UTLu0idmclcxVSYE8hXfV8e7JGpNI1gCqkgrskof3\\n\" +\n-            \"A6CMCIH\/D1VETFtGKn+gGWenWwnELmKuvHObQGXmcwOV3aXBdNFTmfzcshwqm\/mE\\n\" +\n-            \"zQIDAQABo4IBJjCCASIwDgYDVR0PAQH\/BAQDAgWgMB0GA1UdDgQWBBTURzXdgGMB\\n\" +\n-            \"tNyiP16WXB1oM2qqmzAfBgNVHSMEGDAWgBRi1EJehnB1apC8xrjSTWDCNLpROjAd\\n\" +\n-            \"BgNVHSUEFjAUBggrBgEFBQcDAQYIKwYBBQUHAwIwdQYIKwYBBQUHAQEEaTBnMC0G\\n\" +\n-            \"CCsGAQUFBzABhiFodHRwOi8vb2NzcC5zY2ExYS5hbWF6b250cnVzdC5jb20wNgYI\\n\" +\n-            \"KwYBBQUHMAKGKmh0dHA6Ly9jcnQuc2NhMWEuYW1hem9udHJ1c3QuY29tL3NjYTFh\\n\" +\n-            \"LmNlcjAlBgNVHREEHjAcghpnb29kLnNjYTFhLmFtYXpvbnRydXN0LmNvbTATBgNV\\n\" +\n-            \"HSAEDDAKMAgGBmeBDAECATANBgkqhkiG9w0BAQsFAAOCAQEAVNyn7lB3IOstAJj+\\n\" +\n-            \"avkPfojb+QaUpFjnkKyb7c5kUBEWaaEl27W58OLoIHoEJvfOypv2bTq1fuIx9P88\\n\" +\n-            \"1HP7DrI7vBtfnAgyIjF2mzL6Jyt7buR7u\/cXTO0fsl\/uk3wfrJBl860\/Nab+WYoj\\n\" +\n-            \"pvJm0b75WVnU30Khy\/xrhNfN2nvCJ5VMoHqV6KnKrMjA5KpdeTvVaIgyxtV6B8vY\\n\" +\n-            \"VsBbtzJ6n8mN7N8YkEkHV6TG7l+FVPHQdJFtD\/qhTd5C4uu4XUehxOta894hLy6z\\n\" +\n-            \"8Mv9BGtmwyUIEd0KQQdkXrWx\/iAq6zo0imAeN\/s8tjqAzxnw6M5F9cDqjqkYqgXZ\\n\" +\n-            \"eIkPBA==\\n\" +\n-            \"-----END CERTIFICATE-----\";\n+    public void runTest() throws Exception {\n+        ValidatePathWithURL validatePathWithURL = new ValidatePathWithURL(CA_ALIAS);\n@@ -133,47 +77,2 @@\n-    \/\/ Owner: CN=revoked.sca1a.amazontrust.com\n-    \/\/ Issuer: CN=Amazon, OU=Server CA 1A, O=Amazon, C=US\n-    \/\/ Serial number: 75a5de4434092b2cd6ed81eb5e6248e1e5f2a\n-    \/\/ Valid from: Fri Dec 17 12:25:17 PST 2021 until: Tue Jan 17 12:25:17 PST 2023\n-    private static final String REVOKED = \"-----BEGIN CERTIFICATE-----\\n\" +\n-            \"MIIEJjCCAw6gAwIBAgITB1pd5ENAkrLNbtgeteYkjh5fKjANBgkqhkiG9w0BAQsF\\n\" +\n-            \"ADBGMQswCQYDVQQGEwJVUzEPMA0GA1UEChMGQW1hem9uMRUwEwYDVQQLEwxTZXJ2\\n\" +\n-            \"ZXIgQ0EgMUExDzANBgNVBAMTBkFtYXpvbjAeFw0yMTEyMTcyMDI1MTdaFw0yMzAx\\n\" +\n-            \"MTcyMDI1MTdaMCgxJjAkBgNVBAMTHXJldm9rZWQuc2NhMWEuYW1hem9udHJ1c3Qu\\n\" +\n-            \"Y29tMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAqYk4ZkF9yJgRa0fL\\n\" +\n-            \"96gmxwlJlyvsQmqumxUGw0u1L+nDgGMFD1bHILOw2AO+feNy8kuTnJVb+zN+2f6l\\n\" +\n-            \"rMGM1sGKh8W\/ZRIdvmcdeZ2kEDyxLotMRXDQ6hJXDj30DSAYNkdqairJItdcev8+\\n\" +\n-            \"t9LRRNRQwL0sXf5FITQPBnlVCrF9Q42p9hhYUhvsS8jSWPIvUbZajOXKs6AfxyPV\\n\" +\n-            \"2Q7TybgnRlawznXxflPzXRMpCSQZ9WdI\/kYbFOjDNtYA05EI4d8IYm+C5U1eJT30\\n\" +\n-            \"dKFeU0xzFsrPirzifFMPIhXKxS5rUELuFRUq4sFTN28Sj7Ij\/rr+O9Im8jJZq0lo\\n\" +\n-            \"bqLoQwIDAQABo4IBKTCCASUwDgYDVR0PAQH\/BAQDAgWgMB0GA1UdDgQWBBRugPQP\\n\" +\n-            \"CWEwQp0pw2dEMw\/gT7F4gzAfBgNVHSMEGDAWgBRi1EJehnB1apC8xrjSTWDCNLpR\\n\" +\n-            \"OjAdBgNVHSUEFjAUBggrBgEFBQcDAQYIKwYBBQUHAwIwdQYIKwYBBQUHAQEEaTBn\\n\" +\n-            \"MC0GCCsGAQUFBzABhiFodHRwOi8vb2NzcC5zY2ExYS5hbWF6b250cnVzdC5jb20w\\n\" +\n-            \"NgYIKwYBBQUHMAKGKmh0dHA6Ly9jcnQuc2NhMWEuYW1hem9udHJ1c3QuY29tL3Nj\\n\" +\n-            \"YTFhLmNlcjAoBgNVHREEITAfgh1yZXZva2VkLnNjYTFhLmFtYXpvbnRydXN0LmNv\\n\" +\n-            \"bTATBgNVHSAEDDAKMAgGBmeBDAECATANBgkqhkiG9w0BAQsFAAOCAQEAQF9QvedW\\n\" +\n-            \"gqD5LPsZ5cg+DkGFBVqhWgsvp8so4gmKHklSHvisEek\/Yfi7tvHCUAP2P0MuV\/49\\n\" +\n-            \"O2A+1tXQL1+hVM1auSfDOQdUy4xsKSWV+PofQe82iz+6dwRf+HNgOtyNcQ6aGD3t\\n\" +\n-            \"87DXnJPkBTEPHGxDkjnOwurSffaV1m00bxfb6T1Txvyjs9ClnZf68Jv6oj+2rbs1\\n\" +\n-            \"+TqKXP0Ma3AgXB37Cq2ozYzpAxy9GBIKIahGX2d2qsuZ2aj6XwJwUayIuU0WTOHK\\n\" +\n-            \"eeXvKS2uvY9UaIvTeepSWXyAbBMKagQhgAtf3X6ILodQi5Gk7lCuY48oArKziTgN\\n\" +\n-            \"vB7mK7JqaM2P4g==\\n\" +\n-            \"-----END CERTIFICATE-----\";\n-\n-    public void runTest(ValidatePathWithParams pathValidator, boolean ocspEnabled) throws Exception {\n-        \/\/ EE certificates don't have CRLDP extension\n-        if (!ocspEnabled){\n-            pathValidator.validate(new String[]{INT},\n-                    ValidatePathWithParams.Status.GOOD, null, System.out);\n-\n-            return;\n-        }\n-\n-        \/\/ Validate valid\n-        pathValidator.validate(new String[]{VALID, INT},\n-                ValidatePathWithParams.Status.GOOD, null, System.out);\n-\n-        \/\/ Validate Revoked\n-        pathValidator.validate(new String[]{REVOKED, INT},\n-                ValidatePathWithParams.Status.REVOKED,\n-                \"Fri Dec 17 12:28:05 PST 2021\", System.out);\n+        validatePathWithURL.validateDomain(VALID, false);\n+        validatePathWithURL.validateDomain(REVOKED, true);\n@@ -184,0 +83,3 @@\n+    private static final String VALID = \"https:\/\/valid.rootca2.demo.amazontrust.com\/\";\n+    private static final String REVOKED = \"https:\/\/revoked.rootca2.demo.amazontrust.com\/\";\n+    private static final String CA_ALIAS = \"amazonrootca2 [jdk]\";\n@@ -185,126 +87,2 @@\n-    \/\/ Owner: CN=Amazon, OU=Server CA 2A, O=Amazon, C=US\n-    \/\/ Issuer: CN=Amazon Root CA 2, O=Amazon, C=US\n-    \/\/ Serial number: 67f945755f187a91f8163f3e624620177ff38\n-    \/\/ Valid from: Wed Oct 21 17:00:00 PDT 2015 until: Sat Oct 18 17:00:00 PDT 2025\n-    private static final String INT = \"-----BEGIN CERTIFICATE-----\\n\" +\n-            \"MIIGRzCCBC+gAwIBAgITBn+UV1Xxh6kfgWPz5iRiAXf\/ODANBgkqhkiG9w0BAQwF\\n\" +\n-            \"ADA5MQswCQYDVQQGEwJVUzEPMA0GA1UEChMGQW1hem9uMRkwFwYDVQQDExBBbWF6\\n\" +\n-            \"b24gUm9vdCBDQSAyMB4XDTE1MTAyMjAwMDAwMFoXDTI1MTAxOTAwMDAwMFowRjEL\\n\" +\n-            \"MAkGA1UEBhMCVVMxDzANBgNVBAoTBkFtYXpvbjEVMBMGA1UECxMMU2VydmVyIENB\\n\" +\n-            \"IDJBMQ8wDQYDVQQDEwZBbWF6b24wggIiMA0GCSqGSIb3DQEBAQUAA4ICDwAwggIK\\n\" +\n-            \"AoICAQC0P8hSLewmrZ41CCPBQytZs5NBFMq5ztbnMf+kZUp9S25LPfjNW3zgC\/6E\\n\" +\n-            \"qCTWNVMMHhq7ez9IQJk48qbfBTLlZkuKnUWbA9vowrDfcxUN0mRE4B\/TJbveXyTf\\n\" +\n-            \"vE91iDlqDrERecE9D8sdjzURrtHTp27lZdRkXFvfEVCq4hl3sHkzjodisaQthLp1\\n\" +\n-            \"gLsiA7vKt+8zcL4Aeq52UyYb8r4\/jdZ3KaQp8O\/T4VwDCRKm8ey3kttpJWaflci7\\n\" +\n-            \"eRzNjY7gE3NMANVXCeQwOBfH2GjINFCObmPsqiBuoAnsv2k5aQLNoU1OZk08ClXm\\n\" +\n-            \"mEZ2rI5qZUTX1HuefBJnpMkPugFCw8afaHnB13SkLE7wxX8SZRdDIe5WiwyDL1tR\\n\" +\n-            \"2+8lpz4JsMoFopHmD3GaHyjbN+hkOqHgLltwewOsiyM0u3CZphypN2KeD+1FLjnY\\n\" +\n-            \"TgdIAd1FRgK2ZXDDrEdjnsSEfShKf0l4mFPSBs9E3U6sLmubDRXKLLLpa\/dF4eKu\\n\" +\n-            \"LEKS1bXYT28iM6D5gSCnzho5G4d18jQD\/slmc5XmRo5Pig0RyBwDaLuxeIZuiJ0A\\n\" +\n-            \"J6YFhffbrLYF5dEQl0cU+t3VBK5u\/o1WkWXsZawU038lWn\/AXerodT\/pAcrtWA4E\\n\" +\n-            \"NQEN09WEKMhZVPhqdwhF\/Gusr04mQtKt7T2v6UMQvtVglv5E7wIDAQABo4IBOTCC\\n\" +\n-            \"ATUwEgYDVR0TAQH\/BAgwBgEB\/wIBADAOBgNVHQ8BAf8EBAMCAYYwHQYDVR0OBBYE\\n\" +\n-            \"FNpDStD8AcBLv1gnjHbNCoHzlC70MB8GA1UdIwQYMBaAFLAM8Eww9AVYAkj9M+VS\\n\" +\n-            \"r0uE42ZSMHsGCCsGAQUFBwEBBG8wbTAvBggrBgEFBQcwAYYjaHR0cDovL29jc3Au\\n\" +\n-            \"cm9vdGNhMi5hbWF6b250cnVzdC5jb20wOgYIKwYBBQUHMAKGLmh0dHA6Ly9jcnQu\\n\" +\n-            \"cm9vdGNhMi5hbWF6b250cnVzdC5jb20vcm9vdGNhMi5jZXIwPwYDVR0fBDgwNjA0\\n\" +\n-            \"oDKgMIYuaHR0cDovL2NybC5yb290Y2EyLmFtYXpvbnRydXN0LmNvbS9yb290Y2Ey\\n\" +\n-            \"LmNybDARBgNVHSAECjAIMAYGBFUdIAAwDQYJKoZIhvcNAQEMBQADggIBAEO5W+iF\\n\" +\n-            \"yChjDyyrmiwFupVWQ0Xy2ReFNQiZq7XKVHvsLQe01moSLnxcBxioOPBKt1KkZO7w\\n\" +\n-            \"Gcbmke0+7AxLaG\/F5NPnzRtK1\/pRhXQ0XdU8pVh\/1\/h4GoqRlZ\/eN0JDarUhZPkV\\n\" +\n-            \"kSr96LUYDTxcsAidF7zkzWfmtcJg\/Aw8mi14xKVEa6aVyKu54c8kKkdlt0WaigOv\\n\" +\n-            \"Z\/xYhxp24AfoFKaIraDNdsD8q2N7eDYeN4WGLzNSlil+iFjzflI9mq1hTuI\/ZNjV\\n\" +\n-            \"rbvob6FUQ8Cc524gMjbpZCNuZ1gfXzwwhGp0AnQF6CJsWF9uwPpZEVFnnnfiWH3M\\n\" +\n-            \"oup41EvBhqaAqOlny0sm5pI82nRUCAE3DLkJ1+eAtdQaYblZQkQrRyTuPmJEm+5y\\n\" +\n-            \"QwdDVw6uHc5OsSj\/tyhh8zJ2Xq3zgh3dMONGjJEysxGaCoIb+61PWwMy2dIarVwI\\n\" +\n-            \"r+c+AY+3PrhgBspNdWZ87JzNHii7ksdjUSVGTTy1vGXgPYrv0lp0IMnKaZP58xiw\\n\" +\n-            \"rDx7uTlQuPVWNOZvCaT3ZcoxTsNKNscIUe+WJjWx5hdzpv\/oksDPY5ltZ0j3hlDS\\n\" +\n-            \"D+Itk95\/cNJVRM\/0HpxI1SX9MTZtOSJoEDdUtOpVaOuBAvEK4gvTzdt0r5L+fuI6\\n\" +\n-            \"o5LAuRo\/LO1xVRH49KFRoaznzU3Ch9+kbPb3\\n\" +\n-            \"-----END CERTIFICATE-----\";\n-\n-    \/\/ Owner: CN=good.sca2a.amazontrust.com\n-    \/\/ Issuer: CN=Amazon, OU=Server CA 2A, O=Amazon, C=US\n-    \/\/ Serial number: 75a5dd7d82269ed466af69794f34050bdffa2\n-    \/\/ Valid from: Fri Dec 17 12:22:32 PST 2021 until: Tue Jan 17 12:22:32 PST 2023\n-    private static final String VALID = \"-----BEGIN CERTIFICATE-----\\n\" +\n-            \"MIIGIDCCBAigAwIBAgITB1pd19giae1GavaXlPNAUL3\/ojANBgkqhkiG9w0BAQwF\\n\" +\n-            \"ADBGMQswCQYDVQQGEwJVUzEPMA0GA1UEChMGQW1hem9uMRUwEwYDVQQLEwxTZXJ2\\n\" +\n-            \"ZXIgQ0EgMkExDzANBgNVBAMTBkFtYXpvbjAeFw0yMTEyMTcyMDIyMzJaFw0yMzAx\\n\" +\n-            \"MTcyMDIyMzJaMCUxIzAhBgNVBAMTGmdvb2Quc2NhMmEuYW1hem9udHJ1c3QuY29t\\n\" +\n-            \"MIICIjANBgkqhkiG9w0BAQEFAAOCAg8AMIICCgKCAgEAsCQonlc6fSTDJbH2y6wC\\n\" +\n-            \"mLeTD3noluSM4LPO53RgLTUvNqrxh\/iy9jDGgYP2xN8GGngRI8C65jZqGpJb0Hcp\\n\" +\n-            \"ADYssYKWcTR5OH8rUVsJ6DkJLx0AUOG+iJcCaqPudkw7WBReFEok7E058gCTbXps\\n\" +\n-            \"kNRT3w92CzzXa+49yxaAP0I6AQ9BqZP6gbAR1hmd9BDMCdak1JIswGVC3wGAKJFi\\n\" +\n-            \"c3FS3YeY7VyuXofeEwutvMH4Iag9DZU2puqskrGSmtrVju8CY6w1E\/cmBWD9kfpu\\n\" +\n-            \"Qet2LBZuzmws8XhCjU5cHOeA8pg2m7ZnyNBeZajg4hrbPq8ACjjDmEHiDgazoOGN\\n\" +\n-            \"1mV1BXZ2qonK+zJAMqE\/L0czEPjdROaF786pPY5Cpi1Rzk0R3KKjGhSHgzfCa2eX\\n\" +\n-            \"cQjBtA7AxLkK+1cI18hYg+okaV+EBrkxXGzeyTjvWbliotIQ9utabXGqJvJtIDeX\\n\" +\n-            \"OQSdSXlBKgwGTE5\/Ju8\/6NkJgSMEku\/Q9SYvfkzPXrj5VAHgPz4KhholeC4A4hRd\\n\" +\n-            \"Y3Xtr\/U5Xr3fTzLdOcLDKYW4\/OGCl8byjwx8bqO7q8YmgDg572Go3gUbNmlm2QN+\\n\" +\n-            \"NaXhBhPrl4KoHzawApTcod3adhSQziIMGjKYoKhV+ZGNoaLe7IUX0jyX3zygRS6k\\n\" +\n-            \"n6yeyeh1unDfqSvne9+hDEsCAwEAAaOCASYwggEiMA4GA1UdDwEB\/wQEAwIFoDAd\\n\" +\n-            \"BgNVHQ4EFgQU71fB1r7\/l2pFd0ydSNEiGaD+9uIwHwYDVR0jBBgwFoAU2kNK0PwB\\n\" +\n-            \"wEu\/WCeMds0KgfOULvQwHQYDVR0lBBYwFAYIKwYBBQUHAwEGCCsGAQUFBwMCMHUG\\n\" +\n-            \"CCsGAQUFBwEBBGkwZzAtBggrBgEFBQcwAYYhaHR0cDovL29jc3Auc2NhMmEuYW1h\\n\" +\n-            \"em9udHJ1c3QuY29tMDYGCCsGAQUFBzAChipodHRwOi8vY3J0LnNjYTJhLmFtYXpv\\n\" +\n-            \"bnRydXN0LmNvbS9zY2EyYS5jZXIwJQYDVR0RBB4wHIIaZ29vZC5zY2EyYS5hbWF6\\n\" +\n-            \"b250cnVzdC5jb20wEwYDVR0gBAwwCjAIBgZngQwBAgEwDQYJKoZIhvcNAQEMBQAD\\n\" +\n-            \"ggIBAKULtBRmu4CtBTfBG6hXkBdFGneJlomw02h8dj7xkXof+DoLYtkuJ6XRp89f\\n\" +\n-            \"9UgYJMBjwKaAFjZzcVYvTd8YKdXzCXy4phxuHTfaV6ZH0WyvOlcTXsfdhJA4oD1G\\n\" +\n-            \"prB4\/PaymwSbv8ZQAE3eg1hytLLlR9+YUS0HfpwaH\/PIa0TzKG8Vuu5zKGSlJjeh\\n\" +\n-            \"Thp\/uMBC4twM558Jv2sxoUA5HjgPUyZW7r2eLFbOM1H4oR1US5zFYgzrEK1W12DO\\n\" +\n-            \"t65mI2YHbDepm5FoizwWYe4uaDCqWjCgzQw8pMGoiDABMaoNQ83Zi8r2sLGibAlb\\n\" +\n-            \"cVLcjsORsF6TNmYTW1KDT\/9hXlOaAhFwfAwKg6cZw51WEg51sPdi5USk\/oszavc5\\n\" +\n-            \"Ft\/IZaWSfkA1Xm0EyFwOwCOvGJIb9PWv5PfGZz4xnZlWhp6LfN31e3TagTUbzLVX\\n\" +\n-            \"XwbDI1cofCl18z6pidXXCASBCAajQ8N4GxNP6qqX9ou0yOBEXxwVqIJLcu3tueCI\\n\" +\n-            \"3Cb3rWfbybAVhuuP2ERKHJMY8XDCt0O\/g8Kj6O69NABOWvNkU3ARzszGzgBfv4IR\\n\" +\n-            \"jJJEskjxX7Q085iXlaRX\/mu+TpTkqK1ZbpBB1Z2PeVMujP+qsWSWGTZBXuI8eqyU\\n\" +\n-            \"dhq+VlyoVtWeMqKYMtakCJxnhwMZnn0sTzZk\/Yno+k9Jn0Rk\\n\" +\n-            \"-----END CERTIFICATE-----\";\n-\n-    \/\/ Owner: CN=revoked.sca2a.amazontrust.com\n-    \/\/ Issuer: CN=Amazon, OU=Server CA 2A, O=Amazon, C=US\n-    \/\/ Serial number: 75a5df2d3387cfe5fd4cad9ff00f8c882b98d\n-    \/\/ Valid from: Fri Dec 17 12:28:31 PST 2021 until: Tue Jan 17 12:28:31 PST 2023\n-    private static final String REVOKED = \"-----BEGIN CERTIFICATE-----\\n\" +\n-            \"MIIGJjCCBA6gAwIBAgITB1pd8tM4fP5f1MrZ\/wD4yIK5jTANBgkqhkiG9w0BAQwF\\n\" +\n-            \"ADBGMQswCQYDVQQGEwJVUzEPMA0GA1UEChMGQW1hem9uMRUwEwYDVQQLEwxTZXJ2\\n\" +\n-            \"ZXIgQ0EgMkExDzANBgNVBAMTBkFtYXpvbjAeFw0yMTEyMTcyMDI4MzFaFw0yMzAx\\n\" +\n-            \"MTcyMDI4MzFaMCgxJjAkBgNVBAMTHXJldm9rZWQuc2NhMmEuYW1hem9udHJ1c3Qu\\n\" +\n-            \"Y29tMIICIjANBgkqhkiG9w0BAQEFAAOCAg8AMIICCgKCAgEAu\/9+ky4Z5U24pBYd\\n\" +\n-            \"6xyb1BGQHTXS5nW8QjLWx+xaunRitgIBB8ZZ8OzUmH2mp2S\/9Vq1nqii9TvuzA9K\\n\" +\n-            \"JJQZLK8K+OJX\/ZwFdSxTgLcyeJ9cCswj\/C3SBA1NopZ3DmEWeXlh7aZhl8IXB6kp\\n\" +\n-            \"zI87Tg72F2JJokWNPYdx7xXhf\/WVeDeNRkz1iE5UTwL+qaNuzT7S8BdnFWqa3l4a\\n\" +\n-            \"Q1J\/YVww0XRhsYJulNVGhoKNf71q8KWw8hJ\/zgMxrBFywu7d3OBw6NX3bowZ+jMQ\\n\" +\n-            \"apJEWiwUYOjH3XcOO6TiChwQMypBrcbGgrD\/msTlvIBinHwpWaAgX0kT80+wH1Bq\\n\" +\n-            \"mw72fEjeE\/Y6EL6WIUr1HQdLhvBDxtPgxnAaxptmg126cF4jV\/e+D+IGf6qpN1gR\\n\" +\n-            \"JQC\/0+AnASAJ0cGKjSODbl5miqtc0kFSReMsOJeT7gdoPCMg4gWyo62GSvdaAA0I\\n\" +\n-            \"DA8a0HWLAzXU7SwbytTUTYeVI8QeNm2ZGKvMoHDWSDz69V6gGmNl\/YSvyJ2zPOZL\\n\" +\n-            \"8oRKRUCOA2LPdK0s7nebe0EBXF09FzzE4HdegRe7r86t6FE400W4wxwJjvjdHXcF\\n\" +\n-            \"s9fI+mgofMvVuK2u3wTdHOrEbfm1GXmj3BlFBORUI11A7K0lmIA02M2jkAN13foe\\n\" +\n-            \"rFLYg+28UjT4aN62zkynKD1iNwkCAwEAAaOCASkwggElMA4GA1UdDwEB\/wQEAwIF\\n\" +\n-            \"oDAdBgNVHQ4EFgQUOzuuTB9A8p71qwA3qxqOABf69nkwHwYDVR0jBBgwFoAU2kNK\\n\" +\n-            \"0PwBwEu\/WCeMds0KgfOULvQwHQYDVR0lBBYwFAYIKwYBBQUHAwEGCCsGAQUFBwMC\\n\" +\n-            \"MHUGCCsGAQUFBwEBBGkwZzAtBggrBgEFBQcwAYYhaHR0cDovL29jc3Auc2NhMmEu\\n\" +\n-            \"YW1hem9udHJ1c3QuY29tMDYGCCsGAQUFBzAChipodHRwOi8vY3J0LnNjYTJhLmFt\\n\" +\n-            \"YXpvbnRydXN0LmNvbS9zY2EyYS5jZXIwKAYDVR0RBCEwH4IdcmV2b2tlZC5zY2Ey\\n\" +\n-            \"YS5hbWF6b250cnVzdC5jb20wEwYDVR0gBAwwCjAIBgZngQwBAgEwDQYJKoZIhvcN\\n\" +\n-            \"AQEMBQADggIBALAPC6I\/k\/WqJ8dxt7yhhSKA5RyGjd16kh+zq57Cjy0Wmj3BtSFJ\\n\" +\n-            \"l0652ULeHZDjhtEAEMFlWdxuuUJ82UhzPzujeVv5e8CLROYWp52Jb9CFPTwF54ow\\n\" +\n-            \"0a6recetYvOHBTeQ0cmo3nY6Z8eHDRUdk\/aGQku1cesntFOIWm+EDj7SDYnUm3Ub\\n\" +\n-            \"ECdMv8entU5yjo\/herVNMT6GGnKfjRxM0FWJWoHKKC\/EPIka34VN6LOZO4Ftl9wI\\n\" +\n-            \"Ms7w3EgweEqLOyaGSAFwzrcQwKkPBm8fW5CefDtB64CtC8NUuo+XOQ2\/JlRnWGLk\\n\" +\n-            \"CHxesJBUNk5c\/IBDPLmyrKCLbGUqwsehQGQdSrLIH0857pTJi30D+\/KDvgQynaay\\n\" +\n-            \"zPWLrSJvXUOQ9Vir+RQtbiMOqUDXX15Vty2mxLqjos1zCAxgrorZ7H2OSBZIWYzE\\n\" +\n-            \"8UgF1\/vOlAtMjYyLLgb2UyqAY2HybKjtYYAyV\/oIPjVRXygaOGkDZseqqXuslq5I\\n\" +\n-            \"ZSDU5hF6Hy6D6gsCVdshswwuRg39248M79qsMDw0Xa7xGcwqdfwTHv4Rb3G\/kTrA\\n\" +\n-            \"8iR2YP\/RdABKkTkUKRXs0kYPFoJ0wQPDD5slkLjdZNeezoNrw1rWEEUh1iildiRA\\n\" +\n-            \"i1p+pwXSyZ+m5Gv0\/W84DDhLmAdvFov5muga8UccNbHuObtt1vHIhHe1\\n\" +\n-            \"-----END CERTIFICATE-----\";\n-\n-    public void runTest(ValidatePathWithParams pathValidator, boolean ocspEnabled) throws Exception {\n-        \/\/ EE certificates don't have CRLDP extension\n-        if (!ocspEnabled){\n-            pathValidator.validate(new String[]{INT},\n-                    ValidatePathWithParams.Status.GOOD, null, System.out);\n+    public void runTest() throws Exception {\n+        ValidatePathWithURL validatePathWithURL = new ValidatePathWithURL(CA_ALIAS);\n@@ -312,11 +90,2 @@\n-            return;\n-        }\n-\n-        \/\/ Validate valid\n-        pathValidator.validate(new String[]{VALID, INT},\n-                ValidatePathWithParams.Status.GOOD, null, System.out);\n-\n-        \/\/ Validate Revoked\n-        pathValidator.validate(new String[]{REVOKED, INT},\n-                ValidatePathWithParams.Status.REVOKED,\n-                \"Fri Dec 17 12:29:36 PST 2021\", System.out);\n+        validatePathWithURL.validateDomain(VALID, false);\n+        validatePathWithURL.validateDomain(REVOKED, true);\n@@ -327,0 +96,3 @@\n+    private static final String VALID = \"https:\/\/valid.rootca3.demo.amazontrust.com\/\";\n+    private static final String REVOKED = \"https:\/\/revoked.rootca3.demo.amazontrust.com\/\";\n+    private static final String CA_ALIAS = \"amazonrootca3 [jdk]\";\n@@ -328,72 +100,2 @@\n-    \/\/ Owner: CN=Amazon, OU=Server CA 3A, O=Amazon, C=US\n-    \/\/ Issuer: CN=Amazon Root CA 3, O=Amazon, C=US\n-    \/\/ Serial number: 67f945758fe55b9ee3f75831d47f07d226c8a\n-    \/\/ Valid from: Wed Oct 21 17:00:00 PDT 2015 until: Sat Oct 18 17:00:00 PDT 2025\n-    private static final String INT = \"-----BEGIN CERTIFICATE-----\\n\" +\n-            \"MIICuzCCAmGgAwIBAgITBn+UV1j+VbnuP3WDHUfwfSJsijAKBggqhkjOPQQDAjA5\\n\" +\n-            \"MQswCQYDVQQGEwJVUzEPMA0GA1UEChMGQW1hem9uMRkwFwYDVQQDExBBbWF6b24g\\n\" +\n-            \"Um9vdCBDQSAzMB4XDTE1MTAyMjAwMDAwMFoXDTI1MTAxOTAwMDAwMFowRjELMAkG\\n\" +\n-            \"A1UEBhMCVVMxDzANBgNVBAoTBkFtYXpvbjEVMBMGA1UECxMMU2VydmVyIENBIDNB\\n\" +\n-            \"MQ8wDQYDVQQDEwZBbWF6b24wWTATBgcqhkjOPQIBBggqhkjOPQMBBwNCAATYcYsK\\n\" +\n-            \"mYdR0Gj8Xz45E\/lfcTTnXhg2EtAIYBIHyXv\/ZQyyyCas1aptX\/I5T1coT6XK181g\\n\" +\n-            \"nB8hADuKfWlNoIYRo4IBOTCCATUwEgYDVR0TAQH\/BAgwBgEB\/wIBADAOBgNVHQ8B\\n\" +\n-            \"Af8EBAMCAYYwHQYDVR0OBBYEFATc4JXl6LlrlKHvjFsxHhN+VZfaMB8GA1UdIwQY\\n\" +\n-            \"MBaAFKu229cGnjesMIYHkXDHnMQZsXjAMHsGCCsGAQUFBwEBBG8wbTAvBggrBgEF\\n\" +\n-            \"BQcwAYYjaHR0cDovL29jc3Aucm9vdGNhMy5hbWF6b250cnVzdC5jb20wOgYIKwYB\\n\" +\n-            \"BQUHMAKGLmh0dHA6Ly9jcnQucm9vdGNhMy5hbWF6b250cnVzdC5jb20vcm9vdGNh\\n\" +\n-            \"My5jZXIwPwYDVR0fBDgwNjA0oDKgMIYuaHR0cDovL2NybC5yb290Y2EzLmFtYXpv\\n\" +\n-            \"bnRydXN0LmNvbS9yb290Y2EzLmNybDARBgNVHSAECjAIMAYGBFUdIAAwCgYIKoZI\\n\" +\n-            \"zj0EAwIDSAAwRQIgOl\/vux0qfxNm05W3eofa9lKwz6oKvdu6g6Sc0UlwgRcCIQCS\\n\" +\n-            \"WSQ6F6JHLoeOWLyFFF658eNKEKbkEGMHz34gLX\/N3g==\\n\" +\n-            \"-----END CERTIFICATE-----\";\n-\n-    \/\/ Owner: CN=good.sca3a.amazontrust.com\n-    \/\/ Issuer: CN=Amazon, OU=Server CA 3A, O=Amazon, C=US\n-    \/\/ Serial number: 75a5dd9ec12f37f4bbed4bada4b75164a642f\n-    \/\/ Valid from: Fri Dec 17 12:23:00 PST 2021 until: Tue Jan 17 12:23:00 PST 2023\n-    private static final String VALID = \"-----BEGIN CERTIFICATE-----\\n\" +\n-            \"MIIClDCCAjqgAwIBAgITB1pd2ewS839LvtS62kt1FkpkLzAKBggqhkjOPQQDAjBG\\n\" +\n-            \"MQswCQYDVQQGEwJVUzEPMA0GA1UEChMGQW1hem9uMRUwEwYDVQQLEwxTZXJ2ZXIg\\n\" +\n-            \"Q0EgM0ExDzANBgNVBAMTBkFtYXpvbjAeFw0yMTEyMTcyMDIzMDBaFw0yMzAxMTcy\\n\" +\n-            \"MDIzMDBaMCUxIzAhBgNVBAMTGmdvb2Quc2NhM2EuYW1hem9udHJ1c3QuY29tMFkw\\n\" +\n-            \"EwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAE275wkVMovF+U\/fRduMcuthD8AYpYTUgc\\n\" +\n-            \"qoEHEccF6eZYzoGlufHJCwtLHXk9qXeXtjZV8N90ksYahFV+oGFcpaOCASYwggEi\\n\" +\n-            \"MA4GA1UdDwEB\/wQEAwIHgDAdBgNVHQ4EFgQUS8gTB11XA49gH4IGAD6p3UilrIMw\\n\" +\n-            \"HwYDVR0jBBgwFoAUBNzgleXouWuUoe+MWzEeE35Vl9owHQYDVR0lBBYwFAYIKwYB\\n\" +\n-            \"BQUHAwEGCCsGAQUFBwMCMHUGCCsGAQUFBwEBBGkwZzAtBggrBgEFBQcwAYYhaHR0\\n\" +\n-            \"cDovL29jc3Auc2NhM2EuYW1hem9udHJ1c3QuY29tMDYGCCsGAQUFBzAChipodHRw\\n\" +\n-            \"Oi8vY3J0LnNjYTNhLmFtYXpvbnRydXN0LmNvbS9zY2EzYS5jZXIwJQYDVR0RBB4w\\n\" +\n-            \"HIIaZ29vZC5zY2EzYS5hbWF6b250cnVzdC5jb20wEwYDVR0gBAwwCjAIBgZngQwB\\n\" +\n-            \"AgEwCgYIKoZIzj0EAwIDSAAwRQIgRRteTEwQoqw95mKff0ydDMD1+YQbcN6QLw\/a\\n\" +\n-            \"NwDti9ICIQDYMNw6u0d5gaZZo\/zizl1JRVAuSxoO5lNOrleaEOkImA==\\n\" +\n-            \"-----END CERTIFICATE-----\";\n-\n-    \/\/ Owner: CN=revoked.sca3a.amazontrust.com\n-    \/\/ Issuer: CN=Amazon, OU=Server CA 3A, O=Amazon, C=US\n-    \/\/ Serial number: 75a5df9c88c0613777baba663000de147a26b\n-    \/\/ Valid from: Fri Dec 17 12:30:04 PST 2021 until: Tue Jan 17 12:30:04 PST 2023\n-    private static final String REVOKED = \"-----BEGIN CERTIFICATE-----\\n\" +\n-            \"MIICmzCCAkCgAwIBAgITB1pd+ciMBhN3e6umYwAN4UeiazAKBggqhkjOPQQDAjBG\\n\" +\n-            \"MQswCQYDVQQGEwJVUzEPMA0GA1UEChMGQW1hem9uMRUwEwYDVQQLEwxTZXJ2ZXIg\\n\" +\n-            \"Q0EgM0ExDzANBgNVBAMTBkFtYXpvbjAeFw0yMTEyMTcyMDMwMDRaFw0yMzAxMTcy\\n\" +\n-            \"MDMwMDRaMCgxJjAkBgNVBAMTHXJldm9rZWQuc2NhM2EuYW1hem9udHJ1c3QuY29t\\n\" +\n-            \"MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEbppBP3Dj0qoRHMB9VMTXhw2Fg8ef\\n\" +\n-            \"o32r\/Mu3IzT8T6kWCk3UqVDL3UIn3qVZLCW1nJfVc1d1EeSDvyjCL3u3f6OCASkw\\n\" +\n-            \"ggElMA4GA1UdDwEB\/wQEAwIHgDAdBgNVHQ4EFgQUv8lJ3W7O74zVj+0zhD4+rrqZ\\n\" +\n-            \"yvMwHwYDVR0jBBgwFoAUBNzgleXouWuUoe+MWzEeE35Vl9owHQYDVR0lBBYwFAYI\\n\" +\n-            \"KwYBBQUHAwEGCCsGAQUFBwMCMHUGCCsGAQUFBwEBBGkwZzAtBggrBgEFBQcwAYYh\\n\" +\n-            \"aHR0cDovL29jc3Auc2NhM2EuYW1hem9udHJ1c3QuY29tMDYGCCsGAQUFBzAChipo\\n\" +\n-            \"dHRwOi8vY3J0LnNjYTNhLmFtYXpvbnRydXN0LmNvbS9zY2EzYS5jZXIwKAYDVR0R\\n\" +\n-            \"BCEwH4IdcmV2b2tlZC5zY2EzYS5hbWF6b250cnVzdC5jb20wEwYDVR0gBAwwCjAI\\n\" +\n-            \"BgZngQwBAgEwCgYIKoZIzj0EAwIDSQAwRgIhAKrA0fOK4NKDKHTY8ESeVW3D\/7NH\\n\" +\n-            \"tbNdfcIXolAoFfmFAiEAylAsKdND8c4w69jlFTId0X8F\/mrXzKfLFCQ+b\/7jTto=\\n\" +\n-            \"-----END CERTIFICATE-----\";\n-\n-    public void runTest(ValidatePathWithParams pathValidator, boolean ocspEnabled) throws Exception {\n-        \/\/ EE certificates don't have CRLDP extension\n-        if (!ocspEnabled){\n-            pathValidator.validate(new String[]{INT},\n-                    ValidatePathWithParams.Status.GOOD, null, System.out);\n-\n-            return;\n-        }\n+    public void runTest() throws Exception {\n+        ValidatePathWithURL validatePathWithURL = new ValidatePathWithURL(CA_ALIAS);\n@@ -401,8 +103,2 @@\n-        \/\/ Validate valid\n-        pathValidator.validate(new String[]{VALID, INT},\n-                ValidatePathWithParams.Status.GOOD, null, System.out);\n-\n-        \/\/ Validate Revoked\n-        pathValidator.validate(new String[]{REVOKED, INT},\n-                ValidatePathWithParams.Status.REVOKED,\n-                \"Fri Dec 17 12:30:37 PST 2021\", System.out);\n+        validatePathWithURL.validateDomain(VALID, false);\n+        validatePathWithURL.validateDomain(REVOKED, true);\n@@ -413,0 +109,3 @@\n+    private static final String VALID = \"https:\/\/valid.rootca4.demo.amazontrust.com\/\";\n+    private static final String REVOKED = \"https:\/\/revoked.rootca4.demo.amazontrust.com\/\";\n+    private static final String CA_ALIAS = \"amazonrootca4 [jdk]\";\n@@ -414,81 +113,2 @@\n-    \/\/ Owner: CN=Amazon, OU=Server CA 4A, O=Amazon, C=US\n-    \/\/ Issuer: CN=Amazon Root CA 4, O=Amazon, C=US\n-    \/\/ Serial number: 67f94575a8862a9072e3239c37ceba1274e18\n-    \/\/ Valid from: Wed Oct 21 17:00:00 PDT 2015 until: Sat Oct 18 17:00:00 PDT 2025\n-    private static final String INT = \"-----BEGIN CERTIFICATE-----\\n\" +\n-            \"MIIC+TCCAn6gAwIBAgITBn+UV1qIYqkHLjI5w3zroSdOGDAKBggqhkjOPQQDAzA5\\n\" +\n-            \"MQswCQYDVQQGEwJVUzEPMA0GA1UEChMGQW1hem9uMRkwFwYDVQQDExBBbWF6b24g\\n\" +\n-            \"Um9vdCBDQSA0MB4XDTE1MTAyMjAwMDAwMFoXDTI1MTAxOTAwMDAwMFowRjELMAkG\\n\" +\n-            \"A1UEBhMCVVMxDzANBgNVBAoTBkFtYXpvbjEVMBMGA1UECxMMU2VydmVyIENBIDRB\\n\" +\n-            \"MQ8wDQYDVQQDEwZBbWF6b24wdjAQBgcqhkjOPQIBBgUrgQQAIgNiAASRP0kIW0Ha\\n\" +\n-            \"7+ORvEVhIS5gIgkH66X5W9vBRTX14oG\/1elIyI6LbFZ+E5KAufL0XoWJGI1WbPRm\\n\" +\n-            \"HW246FKSzF0wOEZZyxEROz6tuaVsnXRHRE76roS\/Wr064uJpKH+Lv+SjggE5MIIB\\n\" +\n-            \"NTASBgNVHRMBAf8ECDAGAQH\/AgEAMA4GA1UdDwEB\/wQEAwIBhjAdBgNVHQ4EFgQU\\n\" +\n-            \"pSHN2+tTIZmqytlnQpQlsnv0wuMwHwYDVR0jBBgwFoAU0+zHOmVuzOHadppW+5zz\\n\" +\n-            \"hm1X5YEwewYIKwYBBQUHAQEEbzBtMC8GCCsGAQUFBzABhiNodHRwOi8vb2NzcC5y\\n\" +\n-            \"b290Y2E0LmFtYXpvbnRydXN0LmNvbTA6BggrBgEFBQcwAoYuaHR0cDovL2NydC5y\\n\" +\n-            \"b290Y2E0LmFtYXpvbnRydXN0LmNvbS9yb290Y2E0LmNlcjA\/BgNVHR8EODA2MDSg\\n\" +\n-            \"MqAwhi5odHRwOi8vY3JsLnJvb3RjYTQuYW1hem9udHJ1c3QuY29tL3Jvb3RjYTQu\\n\" +\n-            \"Y3JsMBEGA1UdIAQKMAgwBgYEVR0gADAKBggqhkjOPQQDAwNpADBmAjEA59RAOBaj\\n\" +\n-            \"uh0rT\/OOTWPEv6TBnb9XEadburBaXb8SSrR8il+NdkfS9WXRAzbwrG7LAjEA3ukD\\n\" +\n-            \"1HrQq+WXHBM5sIuViJI\/Zh7MOjsc159Q+dn36PBqLRq03AXqE\/lRjnv8C5nj\\n\" +\n-            \"-----END CERTIFICATE-----\";\n-\n-    \/\/ Owner: CN=good.sca4a.amazontrust.com\n-    \/\/ Issuer: CN=Amazon, OU=Server CA 4A, O=Amazon, C=US\n-    \/\/ Serial number: 75a5ddc1a4ea5a18110454883269df9409bf5\n-    \/\/ Valid from: Fri Dec 17 12:23:29 PST 2021 until: Tue Jan 17 12:23:29 PST 2023\n-    private static final String VALID = \"-----BEGIN CERTIFICATE-----\\n\" +\n-            \"MIIC0TCCAlegAwIBAgITB1pd3BpOpaGBEEVIgyad+UCb9TAKBggqhkjOPQQDAzBG\\n\" +\n-            \"MQswCQYDVQQGEwJVUzEPMA0GA1UEChMGQW1hem9uMRUwEwYDVQQLEwxTZXJ2ZXIg\\n\" +\n-            \"Q0EgNEExDzANBgNVBAMTBkFtYXpvbjAeFw0yMTEyMTcyMDIzMjlaFw0yMzAxMTcy\\n\" +\n-            \"MDIzMjlaMCUxIzAhBgNVBAMTGmdvb2Quc2NhNGEuYW1hem9udHJ1c3QuY29tMHYw\\n\" +\n-            \"EAYHKoZIzj0CAQYFK4EEACIDYgAE7VpccYyJsD19xB1owlNs9PGkXkjptJZK6eFY\\n\" +\n-            \"q9Tc+CZLaOAhi47uuWsPwyIYB3vEIUXoWWKTvgycHhsmVQDQ2hLYMS+h9tQgnqVN\\n\" +\n-            \"TDYpEnnBa6AUbTKXtJDLG+z+7Kd7o4IBJjCCASIwDgYDVR0PAQH\/BAQDAgeAMB0G\\n\" +\n-            \"A1UdDgQWBBRHzxN3jV4vU1PEmHmTqB8YXXoMYDAfBgNVHSMEGDAWgBSlIc3b61Mh\\n\" +\n-            \"marK2WdClCWye\/TC4zAdBgNVHSUEFjAUBggrBgEFBQcDAQYIKwYBBQUHAwIwdQYI\\n\" +\n-            \"KwYBBQUHAQEEaTBnMC0GCCsGAQUFBzABhiFodHRwOi8vb2NzcC5zY2E0YS5hbWF6\\n\" +\n-            \"b250cnVzdC5jb20wNgYIKwYBBQUHMAKGKmh0dHA6Ly9jcnQuc2NhNGEuYW1hem9u\\n\" +\n-            \"dHJ1c3QuY29tL3NjYTRhLmNlcjAlBgNVHREEHjAcghpnb29kLnNjYTRhLmFtYXpv\\n\" +\n-            \"bnRydXN0LmNvbTATBgNVHSAEDDAKMAgGBmeBDAECATAKBggqhkjOPQQDAwNoADBl\\n\" +\n-            \"AjEAyHMRGLsUVEufoih22dPfO5LrLpO4\/2VzeNBbUvP\/mOcwvMrrq1yQjot3CTdm\\n\" +\n-            \"ZwnRAjAj2zmAM5asBZwuEN1pbEFgHdojio0O4oYvUsdMooLOKJsBD7hmgAdhpObO\\n\" +\n-            \"Xv0oNIE=\\n\" +\n-            \"-----END CERTIFICATE-----\";\n-\n-    \/\/ Owner: CN=revoked.sca4a.amazontrust.com\n-    \/\/ Issuer: CN=Amazon, OU=Server CA 4A, O=Amazon, C=US\n-    \/\/ Serial number: 75a5e0442d0fed2b11850ed6746a2200bb4af\n-    \/\/ Valid from: Fri Dec 17 12:32:23 PST 2021 until: Tue Jan 17 12:32:23 PST 2023\n-    private static final String REVOKED = \"-----BEGIN CERTIFICATE-----\\n\" +\n-            \"MIIC1zCCAl2gAwIBAgITB1peBELQ\/tKxGFDtZ0aiIAu0rzAKBggqhkjOPQQDAzBG\\n\" +\n-            \"MQswCQYDVQQGEwJVUzEPMA0GA1UEChMGQW1hem9uMRUwEwYDVQQLEwxTZXJ2ZXIg\\n\" +\n-            \"Q0EgNEExDzANBgNVBAMTBkFtYXpvbjAeFw0yMTEyMTcyMDMyMjNaFw0yMzAxMTcy\\n\" +\n-            \"MDMyMjNaMCgxJjAkBgNVBAMTHXJldm9rZWQuc2NhNGEuYW1hem9udHJ1c3QuY29t\\n\" +\n-            \"MHYwEAYHKoZIzj0CAQYFK4EEACIDYgAEqxQKCDKJYXzA0uR3jyfk\/ZRyPAJolRNI\\n\" +\n-            \"xI3+vlQW7SqVs+MziCLFPuU68kf74a5\/YFWK\/bRdXrVue4IMbM8TKO2FwXIHn\/Iw\\n\" +\n-            \"udkJIG+CdqnL4IlH+tFf+l47vRzMS0TQo4IBKTCCASUwDgYDVR0PAQH\/BAQDAgeA\\n\" +\n-            \"MB0GA1UdDgQWBBR04rEvUxTzLh0OGHyMgrYanP7lqzAfBgNVHSMEGDAWgBSlIc3b\\n\" +\n-            \"61MhmarK2WdClCWye\/TC4zAdBgNVHSUEFjAUBggrBgEFBQcDAQYIKwYBBQUHAwIw\\n\" +\n-            \"dQYIKwYBBQUHAQEEaTBnMC0GCCsGAQUFBzABhiFodHRwOi8vb2NzcC5zY2E0YS5h\\n\" +\n-            \"bWF6b250cnVzdC5jb20wNgYIKwYBBQUHMAKGKmh0dHA6Ly9jcnQuc2NhNGEuYW1h\\n\" +\n-            \"em9udHJ1c3QuY29tL3NjYTRhLmNlcjAoBgNVHREEITAfgh1yZXZva2VkLnNjYTRh\\n\" +\n-            \"LmFtYXpvbnRydXN0LmNvbTATBgNVHSAEDDAKMAgGBmeBDAECATAKBggqhkjOPQQD\\n\" +\n-            \"AwNoADBlAjEAgOyeHMBYmO9rfMgCnV4oOQ5PcjSAgotYwEGqFHA5+TuIPBTcdFar\\n\" +\n-            \"J1j1JY+EirQ3AjAuGMJdyiQfAVi1n5wT1\/2nIOIEGtV2\/9CrNmhmjIzKrfu+HUUk\\n\" +\n-            \"bduxD7hNhott7NE=\\n\" +\n-            \"-----END CERTIFICATE-----\";\n-\n-    public void runTest(ValidatePathWithParams pathValidator, boolean ocspEnabled) throws Exception {\n-        \/\/ EE certificates don't have CRLDP extension\n-        if (!ocspEnabled){\n-            pathValidator.validate(new String[]{INT},\n-                    ValidatePathWithParams.Status.GOOD, null, System.out);\n-\n-            return;\n-        }\n-\n-        \/\/ Validate valid\n-        pathValidator.validate(new String[]{VALID, INT},\n-                ValidatePathWithParams.Status.GOOD, null, System.out);\n+    public void runTest() throws Exception {\n+        ValidatePathWithURL validatePathWithURL = new ValidatePathWithURL(CA_ALIAS);\n@@ -496,4 +116,2 @@\n-        \/\/ Validate Revoked\n-        pathValidator.validate(new String[]{REVOKED, INT},\n-                ValidatePathWithParams.Status.REVOKED,\n-                \"Fri Dec 17 12:32:59 PST 2021\", System.out);\n+        validatePathWithURL.validateDomain(VALID, false);\n+        validatePathWithURL.validateDomain(REVOKED, true);\n","filename":"test\/jdk\/security\/infra\/java\/security\/cert\/CertPathValidator\/certification\/AmazonCA.java","additions":51,"deletions":433,"binary":false,"changes":484,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2017, 2021, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2017, 2023, Oracle and\/or its affiliates. All rights reserved.\n@@ -25,1 +25,1 @@\n- * @test\n+ * @test id=OCSP\n@@ -28,1 +28,3 @@\n- * @build ValidatePathWithParams\n+ * @library \/test\/lib\n+ * @build jtreg.SkippedException\n+ * @build ValidatePathWithURL\n@@ -30,1 +32,0 @@\n- * @run main\/othervm\/timeout=180 -Djava.security.debug=certpath BuypassCA CRL\n@@ -33,20 +34,8 @@\n- \/*\n- * Obtain test artifacts for Buypass Class 2 and Class 3 CAs from:\n- *  Buypass Class 3 CA 2\n- *  https:\/\/valid.qcevident.ca23.ssl.buypass.no\/\n- *  https:\/\/revoked.qcevident.ca23.ssl.buypass.no\/\n- *  https:\/\/expired.qcevident.ca23.ssl.buypass.no\/\n- *  https:\/\/valid.evident.ca23.ssl.buypass.no\/\n- *  https:\/\/revoked.evident.ca23.ssl.buypass.no\/\n- *  https:\/\/expired.evident.ca23.ssl.buypass.no\/\n- *  https:\/\/valid.businessplus.ca23.ssl.buypass.no\n- *  https:\/\/revoked.businessplus.ca23.ssl.buypass.no\n- *  https:\/\/expired.businessplus.ca23.ssl.buypass.no\n-\n- *  Buypass Class 2 CA 2\n- *  https:\/\/valid.business.ca22.ssl.buypass.no\n- *  https:\/\/revoked.business.ca22.ssl.buypass.no\n- *  https:\/\/expired.business.ca22.ssl.buypass.no\n- *  https:\/\/valid.domain.ca22.ssl.buypass.no\n- *  https:\/\/revoked.domain.ca22.ssl.buypass.no\n- *  https:\/\/expired.domain.ca22.ssl.buypass.no\/\n+\/*\n+ * @test id=CRL\n+ * @bug 8189131\n+ * @summary Interoperability tests with Buypass Class 2 and Class 3 CA\n+ * @library \/test\/lib\n+ * @build jtreg.SkippedException\n+ * @build ValidatePathWithURL\n+ * @run main\/othervm\/timeout=180 -Djava.security.debug=certpath BuypassCA CRL\n@@ -54,0 +43,1 @@\n+\n@@ -58,2 +48,0 @@\n-        ValidatePathWithParams pathValidator = new ValidatePathWithParams(null);\n-\n@@ -61,1 +49,1 @@\n-            pathValidator.enableCRLCheck();\n+            ValidatePathWithURL.enableCRLOnly();\n@@ -64,1 +52,1 @@\n-            pathValidator.enableOCSPCheck();\n+            ValidatePathWithURL.enableOCSPOnly();\n@@ -67,2 +55,2 @@\n-        new BuypassClass2().runTest(pathValidator);\n-        new BuypassClass3().runTest(pathValidator);\n+        new BuypassClass2().runTest();\n+        new BuypassClass3().runTest();\n@@ -73,0 +61,5 @@\n+    private static final String VALID_BUSINESS = \"https:\/\/valid.business.ca22.ssl.buypass.no\";\n+    private static final String REVOKED_BUSINESS = \"https:\/\/revoked.business.ca22.ssl.buypass.no\";\n+    private static final String VALID_DOMAIN = \"https:\/\/valid.domain.ca22.ssl.buypass.no\";\n+    private static final String REVOKED_DOMAIN = \"https:\/\/revoked.domain.ca22.ssl.buypass.no\";\n+    private static final String CA_ALIAS = \"buypassclass2ca [jdk]\";\n@@ -74,34 +67,2 @@\n-    \/\/ Owner: CN=Buypass Class 2 CA 2, O=Buypass AS-983163327, C=NO\n-    \/\/ Issuer: CN=Buypass Class 2 Root CA, O=Buypass AS-983163327, C=NO\n-    \/\/ Serial number: 1b781c6d5e34ce1f77\n-    \/\/ Valid from: Mon Mar 25 05:17:10 PDT 2019 until: Sat Oct 26 02:16:17 PDT 2030\n-    private static final String INT_CLASS_2 = \"-----BEGIN CERTIFICATE-----\\n\" +\n-            \"MIIFKTCCAxGgAwIBAgIJG3gcbV40zh93MA0GCSqGSIb3DQEBCwUAME4xCzAJBgNV\\n\" +\n-            \"BAYTAk5PMR0wGwYDVQQKDBRCdXlwYXNzIEFTLTk4MzE2MzMyNzEgMB4GA1UEAwwX\\n\" +\n-            \"QnV5cGFzcyBDbGFzcyAyIFJvb3QgQ0EwHhcNMTkwMzI1MTIxNzEwWhcNMzAxMDI2\\n\" +\n-            \"MDkxNjE3WjBLMQswCQYDVQQGEwJOTzEdMBsGA1UECgwUQnV5cGFzcyBBUy05ODMx\\n\" +\n-            \"NjMzMjcxHTAbBgNVBAMMFEJ1eXBhc3MgQ2xhc3MgMiBDQSAyMIIBIjANBgkqhkiG\\n\" +\n-            \"9w0BAQEFAAOCAQ8AMIIBCgKCAQEAnKtnxpZLDQ+R0uzKzDMr83L8Dn+5ToSpD31z\\n\" +\n-            \"qiYMykj7I2geNQ7javKsBOzhgeVr7GP4yJ5bK\/P0dhoKesYvQITihfwztbMP6DyH\\n\" +\n-            \"q1QJLQBqQnF0Lk8GhxSSNAZnlkCgX3aazoL32p9BeEfHuUE\/8BlPywJY\/RyE5\/39\\n\" +\n-            \"w3EKmWylhUkeRCMo3dUZr4khJq8JwGp\/feKFs9n5FouM5PGhpFpZO+WQXEeqxpnc\\n\" +\n-            \"CxbvWpInBoTnmX3+ofjm+fmY+sdAnyHkuOBBw3koGbFQygDaJP9VItOGByCX4iSV\\n\" +\n-            \"ty\/2uzppowIkf7Mpu5v5HJGKObLMP1gGv5lNqjAe8mz0bn25kwIDAQABo4IBCzCC\\n\" +\n-            \"AQcwDwYDVR0TAQH\/BAUwAwEB\/zAfBgNVHSMEGDAWgBTJgHfgYpKC9Uac87r3TMPe\\n\" +\n-            \"uKOtOTAdBgNVHQ4EFgQUkq1libIAD8tRDcEj7JROj8EEP3cwDgYDVR0PAQH\/BAQD\\n\" +\n-            \"AgEGMB0GA1UdJQQWMBQGCCsGAQUFBwMBBggrBgEFBQcDAjARBgNVHSAECjAIMAYG\\n\" +\n-            \"BFUdIAAwPQYDVR0fBDYwNDAyoDCgLoYsaHR0cDovL2NybC5idXlwYXNzLm5vL2Ny\\n\" +\n-            \"bC9CUENsYXNzMlJvb3RDQS5jcmwwMwYIKwYBBQUHAQEEJzAlMCMGCCsGAQUFBzAB\\n\" +\n-            \"hhdodHRwOi8vb2NzcC5idXlwYXNzLmNvbTANBgkqhkiG9w0BAQsFAAOCAgEApNka\\n\" +\n-            \"48a+qhJXXS9R24p34CWnirlyxPMhxFfQyvPFXnwBQGHvrm7H5KY3\/9\/etShFXdY\/\\n\" +\n-            \"N05Aq6UnE8my8jR4iHMm2e9iEf4v+O2E2JGH\/5\/H8wup160GBAsp4zAmJIT8KEgh\\n\" +\n-            \"YAA1j+NaClVryZfEaaDfAdF6LbU3cW0ZgooILPMeeCEXso23KsdCD1Q+SMvD6nQJ\\n\" +\n-            \"86iTvzWPY2GFJyEmvG\/N2f29nBaHxWwZBwCfWB4Hqsw9wdKfY5M9SE\/AGSLZ7LRM\\n\" +\n-            \"BmkkF9nqkWxxISadx12nbxn0LsU2k8Xyt830DqhHGSoYHEC\/iGxbU4Bub8NC0uw\/\\n\" +\n-            \"QNBj5Gd5cXLFhRUWLLBTq4p6P6kLc7JudpM4FNQ+stWK\/eDZylbDLN3iCBRnHH4p\\n\" +\n-            \"qg6HAlWuieiAKVsidBMxPUyDLJ\/8Dt+aW8Z3vCNcYC2n7wqrLZz5e4FG+Wn9teFW\\n\" +\n-            \"Rt5pO6ZUZAkDS59ZVojbbjOdQzNw3QHtZl0IMHeNYXJlPIUlHi4hGL3maGZ9sBF+\\n\" +\n-            \"AMfMLDu56+J2DewIuTXPzCeJeSTam\/ybNt5FxTznxCSCIDqwmZMy3AQEz9nGSbE8\\n\" +\n-            \"zfwB5VT2ijLB0PpPX4YbLf33Vodf0NAkBUv6N5It30XiTUPhdk+caBYPoljz\/J9U\\n\" +\n-            \"15T5+EGHs8ccHQWyYQ6gqYk8o4JgP4rSJqO1sMI=\\n\" +\n-            \"-----END CERTIFICATE-----\";\n+    public void runTest() throws Exception {\n+        ValidatePathWithURL validatePathWithURL = new ValidatePathWithURL(CA_ALIAS);\n@@ -109,38 +70,2 @@\n-    \/\/ Owner: CN=valid.domain.ca22.ssl.buypass.no\n-    \/\/ Issuer: CN=Buypass Class 2 CA 2, O=Buypass AS-983163327, C=NO\n-    \/\/ Serial number: 34e2bff8063debd18d79\n-    \/\/ Valid from: Mon Sep 23 04:12:34 PDT 2019 until: Mon Oct 11 14:59:00 PDT 2021\n-    private static final String VALID_CLASS_2 = \"-----BEGIN CERTIFICATE-----\\n\" +\n-            \"MIIF8jCCBNqgAwIBAgIKNOK\/+AY969GNeTANBgkqhkiG9w0BAQsFADBLMQswCQYD\\n\" +\n-            \"VQQGEwJOTzEdMBsGA1UECgwUQnV5cGFzcyBBUy05ODMxNjMzMjcxHTAbBgNVBAMM\\n\" +\n-            \"FEJ1eXBhc3MgQ2xhc3MgMiBDQSAyMB4XDTE5MDkyMzExMTIzNFoXDTIxMTAxMTIx\\n\" +\n-            \"NTkwMFowKzEpMCcGA1UEAwwgdmFsaWQuZG9tYWluLmNhMjIuc3NsLmJ1eXBhc3Mu\\n\" +\n-            \"bm8wggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQCeu\/8j7y55R3OucDek\\n\" +\n-            \"gtdoVOEJQb2XaCR4OwiRzn74hLYhKGdFmFwSp+bPCT62NzjdK1urVeKrCQdC1Gkm\\n\" +\n-            \"e7iSOsHHO5aC8oxkgdv8mwEwwvH7xHCcpEVLDlE5Oc0d4cS4QIwFAhNIC77slixL\\n\" +\n-            \"fEdupc5e8FfQf3MlnhX+8gpgRzTx3iw8sb3gUwi3+7PRommHOhC7Ll+iI9LiLODJ\\n\" +\n-            \"qrkHnCbM2HJMK+SGTOQ\/whiQwMCnkLaEG0WO1rYc4BGRGfFb8qmQWw\/tDKkEey7X\\n\" +\n-            \"nLIFHSC33OiexQshAwRIAE7r1h9gMY1aAAB2Uxwi9\/3l6fsd\/VPmK7s7lYTBsrpK\\n\" +\n-            \"r4bTAgMBAAGjggL2MIIC8jAJBgNVHRMEAjAAMB8GA1UdIwQYMBaAFJKtZYmyAA\/L\\n\" +\n-            \"UQ3BI+yUTo\/BBD93MB0GA1UdDgQWBBSy+COaEmU2\/BeF4g1OglFvAEYkIDAOBgNV\\n\" +\n-            \"HQ8BAf8EBAMCBaAwHQYDVR0lBBYwFAYIKwYBBQUHAwEGCCsGAQUFBwMCMB8GA1Ud\\n\" +\n-            \"IAQYMBYwCgYIYIRCARoBAgQwCAYGZ4EMAQIBMDoGA1UdHwQzMDEwL6AtoCuGKWh0\\n\" +\n-            \"dHA6Ly9jcmwuYnV5cGFzcy5uby9jcmwvQlBDbGFzczJDQTIuY3JsMCsGA1UdEQQk\\n\" +\n-            \"MCKCIHZhbGlkLmRvbWFpbi5jYTIyLnNzbC5idXlwYXNzLm5vMGoGCCsGAQUFBwEB\\n\" +\n-            \"BF4wXDAjBggrBgEFBQcwAYYXaHR0cDovL29jc3AuYnV5cGFzcy5jb20wNQYIKwYB\\n\" +\n-            \"BQUHMAKGKWh0dHA6Ly9jcnQuYnV5cGFzcy5uby9jcnQvQlBDbGFzczJDQTIuY2Vy\\n\" +\n-            \"MIIBfgYKKwYBBAHWeQIEAgSCAW4EggFqAWgAdwC72d+8H4pxtZOUI5eqkntHOFeV\\n\" +\n-            \"CqtS6BqQlmQ2jh7RhQAAAW1d0tivAAAEAwBIMEYCIQDFRAH98gYpvMMTVa3d5Wcq\\n\" +\n-            \"0tOwpZZyUHiOjUlR3SD14QIhAKZp0cdwFpm+hh0taFVSTmluGsHmXPMCIQq9hLAB\\n\" +\n-            \"VYgyAHYApLkJkLQYWBSHuxOizGdwCjw1mAT5G9+443fNDsgN3BAAAAFtXdLbFwAA\\n\" +\n-            \"BAMARzBFAiBhr7KQc9yO3zb1iLlE0JW9whR0\/bhrPDkk5BYnBKjzFAIhAMMTdHfk\\n\" +\n-            \"1ljso5jKzIUcBpSW0HnTcuKiB3VxGpL7GFVWAHUAb1N2rDHwMRnYmQCkURX\/dxUc\\n\" +\n-            \"EdkCwQApBo2yCJo32RMAAAFtXdLYSAAABAMARjBEAiADoZr6Cp5AGM1eT2aUeRaQ\\n\" +\n-            \"kv0vRaegjRGIhKRCvRGyFAIgWLU\/7zh28LI8vAyWr8mpDqlUXvF13i3zSD3whq4L\\n\" +\n-            \"Lu4wDQYJKoZIhvcNAQELBQADggEBAJH1RhTuMbhEOYlw+Efbx7PP7EEC\/GQ1ijET\\n\" +\n-            \"vZS45jFQyTKhFUcdP2QPAtEVo1nS8PBs0txQJBf0xceWUjer9ruxiAS+JlW21AOi\\n\" +\n-            \"Uq9Kahpj5k63Z7tN8KTeOUE8wZGmHyvVcPP6mkC94RbjYIb4gd13eYxd2Vv1a7YX\\n\" +\n-            \"dNI+J3g7sX5ijssfJxzDd0hORj2584YY2WiKKvIGxwDnLkxk09i3IvjEKsAi4Cgn\\n\" +\n-            \"5798X5sSL1Q9C6gHEWt+cB5UtfILCfbLNRczS9zGku6gjh1c8dB7zc63mn7oCf1C\\n\" +\n-            \"gnQ2xqwbZb3Wau8CPwcMqJWgQZLQFPbZd+4Xo5SDDqYppV4oN2A=\\n\" +\n-            \"-----END CERTIFICATE-----\";\n+        validatePathWithURL.validateDomain(VALID_BUSINESS, false);\n+        validatePathWithURL.validateDomain(REVOKED_BUSINESS, true);\n@@ -148,48 +73,2 @@\n-    \/\/ Owner: CN=revoked.domain.ca22.ssl.buypass.no\n-    \/\/ Issuer: CN=Buypass Class 2 CA 2, O=Buypass AS-983163327, C=NO\n-    \/\/ Serial number: 34e4b97261795f98c495\n-    \/\/ Valid from: Mon Sep 23 04:52:42 PDT 2019 until: Thu Sep 23 14:59:00 PDT 2021\n-    private static final String REVOKED_CLASS_2 = \"-----BEGIN CERTIFICATE-----\\n\" +\n-            \"MIIF9zCCBN+gAwIBAgIKNOS5cmF5X5jElTANBgkqhkiG9w0BAQsFADBLMQswCQYD\\n\" +\n-            \"VQQGEwJOTzEdMBsGA1UECgwUQnV5cGFzcyBBUy05ODMxNjMzMjcxHTAbBgNVBAMM\\n\" +\n-            \"FEJ1eXBhc3MgQ2xhc3MgMiBDQSAyMB4XDTE5MDkyMzExNTI0MloXDTIxMDkyMzIx\\n\" +\n-            \"NTkwMFowLTErMCkGA1UEAwwicmV2b2tlZC5kb21haW4uY2EyMi5zc2wuYnV5cGFz\\n\" +\n-            \"cy5ubzCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBAOiChajGbQktGjbl\\n\" +\n-            \"k\/i5PtqfMN6cMyjJdOirxzXdUG8dT+QErC5zcElCwuyy5MH7DQJRbSYsPxQmr6z5\\n\" +\n-            \"OSheBxX0lPPLjJFfEafBZ+Fw1xmCVy3Xjt3GEl85iqv5y0\/E\/UlQPc0f7s6WxU0L\\n\" +\n-            \"cItkyN0rWAa+uQY018qDFn+gDYIKWPzTCf5nkXIgob\/IgBM1Bj7vSZ\/LI1iB+I+G\\n\" +\n-            \"dgLbSGBlJgK6lhCTc1tunZlSbKdPM2Th8Hbl6Uk7WormR\/8SrGQA9AAd7BWa43V5\\n\" +\n-            \"HHvf\/oArsx0afp3zXNiMw9RgHVHI5uUAzkNnL8NMUpI1sK7\/ndTlm0nXsHpPKrPo\\n\" +\n-            \"e+NpKaMCAwEAAaOCAvkwggL1MAkGA1UdEwQCMAAwHwYDVR0jBBgwFoAUkq1libIA\\n\" +\n-            \"D8tRDcEj7JROj8EEP3cwHQYDVR0OBBYEFDoBaIahoDhRhA3WVyT\/XukqZzmAMA4G\\n\" +\n-            \"A1UdDwEB\/wQEAwIFoDAdBgNVHSUEFjAUBggrBgEFBQcDAQYIKwYBBQUHAwIwHwYD\\n\" +\n-            \"VR0gBBgwFjAKBghghEIBGgECBDAIBgZngQwBAgEwOgYDVR0fBDMwMTAvoC2gK4Yp\\n\" +\n-            \"aHR0cDovL2NybC5idXlwYXNzLm5vL2NybC9CUENsYXNzMkNBMi5jcmwwLQYDVR0R\\n\" +\n-            \"BCYwJIIicmV2b2tlZC5kb21haW4uY2EyMi5zc2wuYnV5cGFzcy5ubzBqBggrBgEF\\n\" +\n-            \"BQcBAQReMFwwIwYIKwYBBQUHMAGGF2h0dHA6Ly9vY3NwLmJ1eXBhc3MuY29tMDUG\\n\" +\n-            \"CCsGAQUFBzAChilodHRwOi8vY3J0LmJ1eXBhc3Mubm8vY3J0L0JQQ2xhc3MyQ0Ey\\n\" +\n-            \"LmNlcjCCAX8GCisGAQQB1nkCBAIEggFvBIIBawFpAHYAu9nfvB+KcbWTlCOXqpJ7\\n\" +\n-            \"RzhXlQqrUugakJZkNo4e0YUAAAFtXfeApgAABAMARzBFAiARoEDgK57YWEW2R21d\\n\" +\n-            \"jFMphF5c9PypIwbZFHiWxdyCyAIhALsjjtPGgcrT\/7KebYFPuKDyQO6rc8YYvm0z\\n\" +\n-            \"Q+Xt7NhxAHYApLkJkLQYWBSHuxOizGdwCjw1mAT5G9+443fNDsgN3BAAAAFtXfeD\\n\" +\n-            \"eQAABAMARzBFAiBCXKlCGkqa85QVqMR5dYDDz3F5aQgLXPubrQLX7cAZ0wIhALRr\\n\" +\n-            \"p8F6OfIdccSUhzEcNdtensQ\/7zxgn81bUzn1ar9EAHcAb1N2rDHwMRnYmQCkURX\/\\n\" +\n-            \"dxUcEdkCwQApBo2yCJo32RMAAAFtXfeBSQAABAMASDBGAiEAyrR31T85HGekHZdD\\n\" +\n-            \"r\/m6flxqQaUIGcAJ5WcrBuIBuYkCIQD0rDdm+vM5\/lNXIfjjrPLhATFEvrxpXJvu\\n\" +\n-            \"+sW4Ntm94jANBgkqhkiG9w0BAQsFAAOCAQEAjbMEFeNXFy3YQSr8O0+fY7qwaAzk\\n\" +\n-            \"vq65Ef\/B2zvqO375+JI21grUikmFUnDiAaM8Y+8PJkOXDiuxR2\/XCLsXpxCcPqQh\\n\" +\n-            \"V0MZlqXtjKZjBACILBX7aqGibojJTIlo0Dkd+LfPwswfXscTbb1CUXpUPn7CiUj5\\n\" +\n-            \"0WwfvjjQXny0NAB6WEkBMEBx6\/Q75dvltoV9N1BZVer9hov6UTDuSad86faX2QF2\\n\" +\n-            \"aIEjrTJY3m2HqnIYf\/lQxuDUDW0h7ddGGsIEBDM8z7M\/rvT068ssRqJ8uecGjMaz\\n\" +\n-            \"JElX8VDgMux2kyjTAiAFD5QO+KTfySri9QXptik3wo66zDOmkVES1snvVQ==\\n\" +\n-            \"-----END CERTIFICATE-----\";\n-\n-    public void runTest(ValidatePathWithParams pathValidator) throws Exception {\n-        \/\/ Validate valid\n-        pathValidator.validate(new String[]{VALID_CLASS_2, INT_CLASS_2},\n-                ValidatePathWithParams.Status.GOOD, null, System.out);\n-\n-        \/\/ Validate Revoked\n-        pathValidator.validate(new String[]{REVOKED_CLASS_2, INT_CLASS_2},\n-                ValidatePathWithParams.Status.REVOKED,\n-                \"Mon Sep 23 04:53:18 PDT 2019\", System.out);\n+        validatePathWithURL.validateDomain(VALID_DOMAIN, false);\n+        validatePathWithURL.validateDomain(REVOKED_DOMAIN, true);\n@@ -200,0 +79,7 @@\n+    private static final String VALID_QC = \"https:\/\/valid.qcevident.ca23.ssl.buypass.no\";\n+    private static final String REVOKED_QC = \"https:\/\/revoked.qcevident.ca23.ssl.buypass.no\";\n+    private static final String VALID_EVIDENT = \"https:\/\/valid.evident.ca23.ssl.buypass.no\";\n+    private static final String REVOKED_EVIDENT = \"https:\/\/revoked.evident.ca23.ssl.buypass.no\";\n+    private static final String VALID_BUSINESSPLUS = \"https:\/\/valid.businessplus.ca23.ssl.buypass.no\";\n+    private static final String REVOKED_BUSINESSPLUS = \"https:\/\/revoked.businessplus.ca23.ssl.buypass.no\";\n+    private static final String CA_ALIAS = \"buypassclass3ca [jdk]\";\n@@ -201,76 +87,2 @@\n-    \/\/ Owner: CN=Buypass Class 3 CA 2, O=Buypass AS-983163327, C=NO\n-    \/\/ Issuer: CN=Buypass Class 3 Root CA, O=Buypass AS-983163327, C=NO\n-    \/\/ Serial number: 1be0dc6a3e7f220475\n-    \/\/ Valid from: Mon Mar 25 05:12:16 PDT 2019 until: Sat Oct 26 01:16:17 PDT 2030\n-    private static final String INT_CLASS_3 = \"-----BEGIN CERTIFICATE-----\\n\" +\n-            \"MIIFKTCCAxGgAwIBAgIJG+Dcaj5\/IgR1MA0GCSqGSIb3DQEBCwUAME4xCzAJBgNV\\n\" +\n-            \"BAYTAk5PMR0wGwYDVQQKDBRCdXlwYXNzIEFTLTk4MzE2MzMyNzEgMB4GA1UEAwwX\\n\" +\n-            \"QnV5cGFzcyBDbGFzcyAzIFJvb3QgQ0EwHhcNMTkwMzI1MTIxMjE2WhcNMzAxMDI2\\n\" +\n-            \"MDgxNjE3WjBLMQswCQYDVQQGEwJOTzEdMBsGA1UECgwUQnV5cGFzcyBBUy05ODMx\\n\" +\n-            \"NjMzMjcxHTAbBgNVBAMMFEJ1eXBhc3MgQ2xhc3MgMyBDQSAyMIIBIjANBgkqhkiG\\n\" +\n-            \"9w0BAQEFAAOCAQ8AMIIBCgKCAQEAvU4V2hRFFe4K7BMEmm4IoMTwS7NyDQB4JEar\\n\" +\n-            \"dV1qBsKHIIQJDm9hbCakcLIWXVv6vYrJZ1AEF0b6awBwhhlqXlyNnOtNa9uR+IAP\\n\" +\n-            \"86d4yOGpgHSlNAhdtOOk9Qw6MUzzBo1lyoYmoL0f5n02SMrlMcArSg458o08eDUx\\n\" +\n-            \"4iZs4dXDR9Hjxac2s+mdAO35Js8VK\/D50AIMDJvHVeCMw+rumZkNZuRqM7PjIK+u\\n\" +\n-            \"BmbqO8A95PeqQEWHvM5nchlV1+ZGNVqHHSJenlMnVKytGv+4KJp7U741H\/9cMbd2\\n\" +\n-            \"X2PXsewWWFhGXoS8R9VXQ5xb3hF6324FQXvcA1mXRv6DAJedXQIDAQABo4IBCzCC\\n\" +\n-            \"AQcwDwYDVR0TAQH\/BAUwAwEB\/zAfBgNVHSMEGDAWgBRHuM3\/5W\/u+LLsL04O+SWw\\n\" +\n-            \"jjxrwzAdBgNVHQ4EFgQUIjAu0vv2S8rAuDvSBMTpcuaXmwwwDgYDVR0PAQH\/BAQD\\n\" +\n-            \"AgEGMB0GA1UdJQQWMBQGCCsGAQUFBwMBBggrBgEFBQcDAjARBgNVHSAECjAIMAYG\\n\" +\n-            \"BFUdIAAwPQYDVR0fBDYwNDAyoDCgLoYsaHR0cDovL2NybC5idXlwYXNzLm5vL2Ny\\n\" +\n-            \"bC9CUENsYXNzM1Jvb3RDQS5jcmwwMwYIKwYBBQUHAQEEJzAlMCMGCCsGAQUFBzAB\\n\" +\n-            \"hhdodHRwOi8vb2NzcC5idXlwYXNzLmNvbTANBgkqhkiG9w0BAQsFAAOCAgEAo42Y\\n\" +\n-            \"fp96nUiZbZsqvYBID3Sqtx3jJfU8gNHFeXgkS0pxYHHYUwsVSVRjw+BGVEGUswpF\\n\" +\n-            \"MaYMCZD37ZL0JpvvXWrCDaMb\/GqDJAQHLLTyVKPGGGIWCZH\/FrhnNvcpt2XXA8lU\\n\" +\n-            \"Ujzp5nZPuqvenzQ\/aXHI4sH5sN\/QjyKVMSa\/6RbWBeQmvIdgyM+0jIR5\/r6UGiKM\\n\" +\n-            \"ar55trZgnlIbvQJ\/w8QTmI\/NwvA5CtRaOslQBxeKoAR0BuA\/lRWnocXa\/BM5uO6P\\n\" +\n-            \"ULL7ct\/uI1bS+YThHXHmFybI6kDf+RhRzWY9165ZP96PBph6smQkxPDAz2b8v+mh\\n\" +\n-            \"LThH+5hkqnoetYfK2MdBYinceGPP3gZ+uBSDDI2o6vdVvdg7G96GP1OEtgTEqZa3\\n\" +\n-            \"glVafckpn\/8F5CisypdQuZ5zyy\/6SXZCKkPcikR87ysSKnjtteXbxMWVtwkeBALT\\n\" +\n-            \"K7DbJA+5aOCYRNj6CJGULQKiGlC01\/ipORKewf5J3yus81lLHzBmgQMA5l9RL8rV\\n\" +\n-            \"6dI246mPpQ+8WDLsDrK3ydSDv5izgdVHzhL0tT2u4vwSq2WUqCgi4xLIA1N\/fA2H\\n\" +\n-            \"xEW7zh0X\/3YVz++g\/6bd7iqRD9nRRZxACekRbza7AqU5xN1UjvVtCJQ9VC74K9KP\\n\" +\n-            \"pBoLWE2Bz5ksL9VUc4kS+WGORvZrSE1EpBq6cHc=\\n\" +\n-            \"-----END CERTIFICATE-----\";\n-\n-    \/\/ Owner: SERIALNUMBER=983163327, CN=valid.businessplus.ca23.ssl.buypass.no, O=BUYPASS AS,\n-    \/\/ L=OSLO, OID.2.5.4.17=0484, C=NO\n-    \/\/ Issuer: CN=Buypass Class 3 CA 2, O=Buypass AS-983163327, C=NO\n-    \/\/ Serial number: 267b7a9f0c3da9b94b39\n-    \/\/ Valid from: Mon Sep 23 04:17:42 PDT 2019 until: Mon Oct 11 14:59:00 PDT 2021\n-    private static final String VALID_CLASS_3 = \"-----BEGIN CERTIFICATE-----\\n\" +\n-            \"MIIGUTCCBTmgAwIBAgIKJnt6nww9qblLOTANBgkqhkiG9w0BAQsFADBLMQswCQYD\\n\" +\n-            \"VQQGEwJOTzEdMBsGA1UECgwUQnV5cGFzcyBBUy05ODMxNjMzMjcxHTAbBgNVBAMM\\n\" +\n-            \"FEJ1eXBhc3MgQ2xhc3MgMyBDQSAyMB4XDTE5MDkyMzExMTc0MloXDTIxMTAxMTIx\\n\" +\n-            \"NTkwMFowgYUxCzAJBgNVBAYTAk5PMQ0wCwYDVQQRDAQwNDg0MQ0wCwYDVQQHDARP\\n\" +\n-            \"U0xPMRMwEQYDVQQKDApCVVlQQVNTIEFTMS8wLQYDVQQDDCZ2YWxpZC5idXNpbmVz\\n\" +\n-            \"c3BsdXMuY2EyMy5zc2wuYnV5cGFzcy5ubzESMBAGA1UEBRMJOTgzMTYzMzI3MIIB\\n\" +\n-            \"IjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEArqj6dPVIQUULBV\/S+u2\/Rfko\\n\" +\n-            \"3BljX\/KMEAclJHPu6AbJ2Dw5oLqCynOfTwLmGl3IRBQuDUAuoLdaptIhaXR2VTsF\\n\" +\n-            \"8SWdHNXkykC2eD0XkAUdTuKgRm\/3U4f0T3XQsjwKOEQGECwGEWJekBL73retSRWe\\n\" +\n-            \"Ccc19NpSKZ5rmRnQSlKLfqUyihmw2xXmIWwEmBq0OOyG8ic3C11Zxh6yUOtlZJqB\\n\" +\n-            \"lWqbAAOK5SXTNV0qozwgkSvtAtJvUo2++rng35Oj8MvjKQjLi92NnSpjbj3rUivW\\n\" +\n-            \"++44X94IgoF9dITkSMnubXhaTLnciM08R8jmCFj877NRrVJRmcJhPfP1yHnR3wID\\n\" +\n-            \"AQABo4IC+jCCAvYwCQYDVR0TBAIwADAfBgNVHSMEGDAWgBQiMC7S+\/ZLysC4O9IE\\n\" +\n-            \"xOly5pebDDAdBgNVHQ4EFgQUKJCKAxRR7K6pedVONDSn58EOzQcwDgYDVR0PAQH\/\\n\" +\n-            \"BAQDAgWgMB0GA1UdJQQWMBQGCCsGAQUFBwMBBggrBgEFBQcDAjAfBgNVHSAEGDAW\\n\" +\n-            \"MAoGCGCEQgEaAQMEMAgGBmeBDAECAjA6BgNVHR8EMzAxMC+gLaArhilodHRwOi8v\\n\" +\n-            \"Y3JsLmJ1eXBhc3Mubm8vY3JsL0JQQ2xhc3MzQ0EyLmNybDAxBgNVHREEKjAogiZ2\\n\" +\n-            \"YWxpZC5idXNpbmVzc3BsdXMuY2EyMy5zc2wuYnV5cGFzcy5ubzBqBggrBgEFBQcB\\n\" +\n-            \"AQReMFwwIwYIKwYBBQUHMAGGF2h0dHA6Ly9vY3NwLmJ1eXBhc3MuY29tMDUGCCsG\\n\" +\n-            \"AQUFBzAChilodHRwOi8vY3J0LmJ1eXBhc3Mubm8vY3J0L0JQQ2xhc3MzQ0EyLmNl\\n\" +\n-            \"cjCCAXwGCisGAQQB1nkCBAIEggFsBIIBaAFmAHYAu9nfvB+KcbWTlCOXqpJ7RzhX\\n\" +\n-            \"lQqrUugakJZkNo4e0YUAAAFtXdd3CgAABAMARzBFAiEA\/pTOtw6i2DJS0R56KwVF\\n\" +\n-            \"Huy+LonG7bICWAe1vnCNud4CIE7\/KRDu9Jys24rtmLz9yCNYJfZDvooK5PT9+rWR\\n\" +\n-            \"OC4+AHUApLkJkLQYWBSHuxOizGdwCjw1mAT5G9+443fNDsgN3BAAAAFtXdd54gAA\\n\" +\n-            \"BAMARjBEAiB09qp4sGA+Kxg823hea3ZyTV7mU1ZQ9j9fqqX8KZ1mpwIgUICM2H0Y\\n\" +\n-            \"8z+V9m+6SutZ5WTD+Arg3K8O6\/dvyKu0QmEAdQBvU3asMfAxGdiZAKRRFf93FRwR\\n\" +\n-            \"2QLBACkGjbIImjfZEwAAAW1d13cSAAAEAwBGMEQCIFLqxvNOKVFlTjHPXwk93VeW\\n\" +\n-            \"zCqFtcxJkunD\/iiv0Kn9AiBoyvUrjYn4MPTht9zb0OyaSMWb00\/HXP\/4AVmUzHrz\\n\" +\n-            \"YzANBgkqhkiG9w0BAQsFAAOCAQEAsmQAOn1f1CbvnOpggS2efmy1pQXvvw+YeCYP\\n\" +\n-            \"bElO578h7scn8al4N7huQZ\/z14BELe0chGWNA\/ReW5nAu3SUOiv+E8\/kv9i9Y8ul\\n\" +\n-            \"MJPL62nXW6Z\/mkyystuBNtON420iWL\/gS\/vduxSZE\/iBB4znctDpXS917\/XWf31Y\\n\" +\n-            \"ZonemF3MSfi\/s9V0Ic82ZY\/+HZ4NLTDyKRd4kFF58OoH9RZNb6g8MbTp+gPadiUG\\n\" +\n-            \"UcfPGV3yGiugQa7WHTl7QJ9ishyafiZ4hpeKem6TMDEztgGyLIZ4MSxQvoeI2jJP\\n\" +\n-            \"KjHd5fW\/HClbEcrN+w0a0MUNMaAOaZfMS7jS6sDpaVL8D0EX5A==\\n\" +\n-            \"-----END CERTIFICATE-----\";\n+    public void runTest() throws Exception {\n+        ValidatePathWithURL validatePathWithURL = new ValidatePathWithURL(CA_ALIAS);\n@@ -278,41 +90,2 @@\n-    \/\/ Owner: SERIALNUMBER=983163327, CN=revoked.businessplus.ca23.ssl.buypass.no, O=BUYPASS AS,\n-    \/\/ L=OSLO, OID.2.5.4.17=0484, C=NO\n-    \/\/ Issuer: CN=Buypass Class 3 CA 2, O=Buypass AS-983163327, C=NO\n-    \/\/ Serial number: 267cee3fab06c615fb27\n-    \/\/ Valid from: Mon Sep 23 04:56:56 PDT 2019 until: Thu Sep 23 14:59:00 PDT 2021\n-    private static final String REVOKED_CLASS_3 = \"-----BEGIN CERTIFICATE-----\\n\" +\n-            \"MIIGWDCCBUCgAwIBAgIKJnzuP6sGxhX7JzANBgkqhkiG9w0BAQsFADBLMQswCQYD\\n\" +\n-            \"VQQGEwJOTzEdMBsGA1UECgwUQnV5cGFzcyBBUy05ODMxNjMzMjcxHTAbBgNVBAMM\\n\" +\n-            \"FEJ1eXBhc3MgQ2xhc3MgMyBDQSAyMB4XDTE5MDkyMzExNTY1NloXDTIxMDkyMzIx\\n\" +\n-            \"NTkwMFowgYcxCzAJBgNVBAYTAk5PMQ0wCwYDVQQRDAQwNDg0MQ0wCwYDVQQHDARP\\n\" +\n-            \"U0xPMRMwEQYDVQQKDApCVVlQQVNTIEFTMTEwLwYDVQQDDChyZXZva2VkLmJ1c2lu\\n\" +\n-            \"ZXNzcGx1cy5jYTIzLnNzbC5idXlwYXNzLm5vMRIwEAYDVQQFEwk5ODMxNjMzMjcw\\n\" +\n-            \"ggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQDtpNExWd+hjl\/ouL\/B\/pdc\\n\" +\n-            \"InUzEywQO3rzXs3psBdQ1lDhG\/9Fcq78uqyri4edtJNDGb1XadktKeRC+NtUqMkE\\n\" +\n-            \"IFOXvaVjLxa61c8K5mh3CVDrAiPyxVcnm8vkuQPMsy1BTOl9TZq9heIukG\/lcfzW\\n\" +\n-            \"6tU6mOD9yx1NzXSVN5cvDCbbDnEZiJSuazXI4O02as66SWI27WKsk21+SKCGAtGC\\n\" +\n-            \"kI0PW4FrXm43\/jxX1CoImIfTLkDInMq7HHsQRsGQ3OjbJLfRz\/2obyjHUU5ki6vd\\n\" +\n-            \"z16mA5ITLFIG36HxbPn337175R9RwOpWkN84xVlL3VQdznCVoiOjzBiOMpdm0Jwp\\n\" +\n-            \"AgMBAAGjggL\/MIIC+zAJBgNVHRMEAjAAMB8GA1UdIwQYMBaAFCIwLtL79kvKwLg7\\n\" +\n-            \"0gTE6XLml5sMMB0GA1UdDgQWBBSGUQTUB4BilG\/EMaHHDAYNPewf8zAOBgNVHQ8B\\n\" +\n-            \"Af8EBAMCBaAwHQYDVR0lBBYwFAYIKwYBBQUHAwEGCCsGAQUFBwMCMB8GA1UdIAQY\\n\" +\n-            \"MBYwCgYIYIRCARoBAwQwCAYGZ4EMAQICMDoGA1UdHwQzMDEwL6AtoCuGKWh0dHA6\\n\" +\n-            \"Ly9jcmwuYnV5cGFzcy5uby9jcmwvQlBDbGFzczNDQTIuY3JsMDMGA1UdEQQsMCqC\\n\" +\n-            \"KHJldm9rZWQuYnVzaW5lc3NwbHVzLmNhMjMuc3NsLmJ1eXBhc3Mubm8wagYIKwYB\\n\" +\n-            \"BQUHAQEEXjBcMCMGCCsGAQUFBzABhhdodHRwOi8vb2NzcC5idXlwYXNzLmNvbTA1\\n\" +\n-            \"BggrBgEFBQcwAoYpaHR0cDovL2NydC5idXlwYXNzLm5vL2NydC9CUENsYXNzM0NB\\n\" +\n-            \"Mi5jZXIwggF\/BgorBgEEAdZ5AgQCBIIBbwSCAWsBaQB2ALvZ37wfinG1k5Qjl6qS\\n\" +\n-            \"e0c4V5UKq1LoGpCWZDaOHtGFAAABbV37Y7oAAAQDAEcwRQIgYbaNSR3R5x9p9sYJ\\n\" +\n-            \"UzRDdd\/lbELb05u9GqlLtl4M61YCIQCTBecXTbMs4zuG\/wu722HZy\/XgD6fiQySp\\n\" +\n-            \"FhHDO3CYagB2AKS5CZC0GFgUh7sTosxncAo8NZgE+RvfuON3zQ7IDdwQAAABbV37\\n\" +\n-            \"Y7wAAAQDAEcwRQIgD8j40M03oLMCg5WmFBN7VL6169F7rKatE12btLQRYtYCIQC0\\n\" +\n-            \"rDhQiZP7j14Y4JqEFQx6UHl3dvxLxZTDW34Z54IUWQB3AG9Tdqwx8DEZ2JkApFEV\\n\" +\n-            \"\/3cVHBHZAsEAKQaNsgiaN9kTAAABbV37YOUAAAQDAEgwRgIhANTGHD1g2pbsTtoN\\n\" +\n-            \"CJ2m6nfxm9jB3huftKGDjeo7EyxHAiEA3EYNUc6hr+4Q9lMAphUgpW6oyaNCsIzl\\n\" +\n-            \"izbNhq8dBRYwDQYJKoZIhvcNAQELBQADggEBADUuO4MmYjPkmkik5tjUPiiDDXEQ\\n\" +\n-            \"A41jr72qmdleYdkhnaKAJa8Enn6j\/ySRV0enA7yqJeNp1qgPQFvlOh3TqFB3Ae5b\\n\" +\n-            \"XAfL2B7vKbegpjKm8dVH5RurqVm9xZcXb1nbwfu2k3lqqsp\/uwqvLBItJDvA8pfi\\n\" +\n-            \"2R46sEtj2gFpAlKFDwepuaklqhrvEoIjIaAL0RrGfKY0oRQw1YMbPNIebsVaWr04\\n\" +\n-            \"rt6tlxrq7PyW1w9Mt3445WA1NzSWc7pAjFLfY6u87QaPHI4ES31H9xxRDsxmr6Y3\\n\" +\n-            \"BJmiWd5uUxev0nVw0saqvlo4yAEBq4rI\/DieKcQI4qEI8myzoS0R0azMfLM=\\n\" +\n-            \"-----END CERTIFICATE-----\";\n+        validatePathWithURL.validateDomain(VALID_QC, false);\n+        validatePathWithURL.validateDomain(REVOKED_QC, true);\n@@ -320,4 +93,2 @@\n-    public void runTest(ValidatePathWithParams pathValidator) throws Exception {\n-        \/\/ Validate valid\n-        pathValidator.validate(new String[]{VALID_CLASS_3, INT_CLASS_3},\n-                ValidatePathWithParams.Status.GOOD, null, System.out);\n+        validatePathWithURL.validateDomain(VALID_EVIDENT, false);\n+        validatePathWithURL.validateDomain(REVOKED_EVIDENT, true);\n@@ -325,4 +96,2 @@\n-        \/\/ Validate Revoked\n-        pathValidator.validate(new String[]{REVOKED_CLASS_3, INT_CLASS_3},\n-                ValidatePathWithParams.Status.REVOKED,\n-                \"Mon Sep 23 04:57:31 PDT 2019\", System.out);\n+        validatePathWithURL.validateDomain(VALID_BUSINESSPLUS, false);\n+        validatePathWithURL.validateDomain(REVOKED_BUSINESSPLUS, true);\n","filename":"test\/jdk\/security\/infra\/java\/security\/cert\/CertPathValidator\/certification\/BuypassCA.java","additions":44,"deletions":275,"binary":false,"changes":319,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2017, 2021, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2017, 2023, Oracle and\/or its affiliates. All rights reserved.\n@@ -25,2 +25,2 @@\n- * @test\n- * @bug 8189131 8231887\n+ * @test id=OCSP\n+ * @bug 8189131\n@@ -29,1 +29,3 @@\n- * @build ValidatePathWithParams\n+ * @library \/test\/lib\n+ * @build jtreg.SkippedException\n+ * @build ValidatePathWithURL\n@@ -31,1 +33,0 @@\n- * @run main\/othervm -Djava.security.debug=certpath ComodoCA CRL\n@@ -34,14 +35,9 @@\n- \/*\n- * Obtain TLS test artifacts for Comodo CAs from:\n- *\n- * Valid TLS Certificates:\n- * https:\/\/comodorsacertificationauthority-ev.comodoca.com\n- * https:\/\/comodoecccertificationauthority-ev.comodoca.com\n- * https:\/\/usertrustrsacertificationauthority-ev.comodoca.com\n- * https:\/\/usertrustecccertificationauthority-ev.comodoca.com\n- *\n- * Revoked TLS Certificates:\n- * https:\/\/comodorsacertificationauthority-ev.comodoca.com:444\n- * https:\/\/comodoecccertificationauthority-ev.comodoca.com:444\n- * https:\/\/usertrustrsacertificationauthority-ev.comodoca.com:444\n- * https:\/\/usertrustecccertificationauthority-ev.comodoca.com:444\n+\/*\n+ * @test id=CRL\n+ * @bug 8189131\n+ * @summary Interoperability tests with Comodo RSA, ECC, userTrust RSA, and\n+ *          userTrust ECC CAs\n+ * @library \/test\/lib\n+ * @build jtreg.SkippedException\n+ * @build ValidatePathWithURL\n+ * @run main\/othervm -Djava.security.debug=certpath ComodoCA CRL\n@@ -49,0 +45,1 @@\n+\n@@ -53,2 +50,0 @@\n-        ValidatePathWithParams pathValidator = new ValidatePathWithParams(null);\n-\n@@ -56,1 +51,1 @@\n-            pathValidator.enableCRLCheck();\n+            ValidatePathWithURL.enableCRLOnly();\n@@ -59,1 +54,1 @@\n-            pathValidator.enableOCSPCheck();\n+            ValidatePathWithURL.enableOCSPOnly();\n@@ -62,4 +57,4 @@\n-        new ComodoRSA().runTest(pathValidator);\n-        new ComodoECC().runTest(pathValidator);\n-        new ComodoUserTrustRSA().runTest(pathValidator);\n-        new ComodoUserTrustECC().runTest(pathValidator);\n+        new ComodoRSA().runTest();\n+        new ComodoECC().runTest();\n+        new ComodoUserTrustRSA().runTest();\n+        new ComodoUserTrustECC().runTest();\n@@ -70,0 +65,3 @@\n+    private static final String VALID = \"https:\/\/comodorsacertificationauthority-ev.comodoca.com\";\n+    private static final String REVOKED = \"https:\/\/comodorsacertificationauthority-ev.comodoca.com:444\";\n+    private static final String CA_ALIAS = \"comodorsaca [jdk]\";\n@@ -71,91 +69,2 @@\n-    \/\/ Owner: CN=COMODO RSA Extended Validation Secure Server CA,\n-    \/\/ O=COMODO CA Limited, L=Salford, ST=Greater Manchester, C=GB\n-    \/\/ Issuer: CN=COMODO RSA Certification Authority, O=COMODO CA Limited,\n-    \/\/ L=Salford, ST=Greater Manchester, C=GB\n-    \/\/ Serial number: 6a74380d4ebfed435b5a3f7e16abdd8\n-    \/\/ Valid from: Sat Feb 11 16:00:00 PST 2012 until: Thu Feb 11 15:59:59 PST 2027\n-    private static final String INT = \"-----BEGIN CERTIFICATE-----\\n\"\n-            + \"MIIGDjCCA\/agAwIBAgIQBqdDgNTr\/tQ1taP34Wq92DANBgkqhkiG9w0BAQwFADCB\\n\"\n-            + \"hTELMAkGA1UEBhMCR0IxGzAZBgNVBAgTEkdyZWF0ZXIgTWFuY2hlc3RlcjEQMA4G\\n\"\n-            + \"A1UEBxMHU2FsZm9yZDEaMBgGA1UEChMRQ09NT0RPIENBIExpbWl0ZWQxKzApBgNV\\n\"\n-            + \"BAMTIkNPTU9ETyBSU0EgQ2VydGlmaWNhdGlvbiBBdXRob3JpdHkwHhcNMTIwMjEy\\n\"\n-            + \"MDAwMDAwWhcNMjcwMjExMjM1OTU5WjCBkjELMAkGA1UEBhMCR0IxGzAZBgNVBAgT\\n\"\n-            + \"EkdyZWF0ZXIgTWFuY2hlc3RlcjEQMA4GA1UEBxMHU2FsZm9yZDEaMBgGA1UEChMR\\n\"\n-            + \"Q09NT0RPIENBIExpbWl0ZWQxODA2BgNVBAMTL0NPTU9ETyBSU0EgRXh0ZW5kZWQg\\n\"\n-            + \"VmFsaWRhdGlvbiBTZWN1cmUgU2VydmVyIENBMIIBIjANBgkqhkiG9w0BAQEFAAOC\\n\"\n-            + \"AQ8AMIIBCgKCAQEAlVbeVLTf1QJJe9FbXKKyHo+cK2JMK40SKPMalaPGEP0p3uGf\\n\"\n-            + \"CzhAk9HvbpUQ\/OGQF3cs7nU+e2PsYZJuTzurgElr3wDqAwB\/L3XVKC\/sVmePgIOj\\n\"\n-            + \"vdwDmZOLlJFWW6G4ajo\/Br0OksxgnP214J9mMF\/b5pTwlWqvyIqvgNnmiDkBfBzA\\n\"\n-            + \"xSr3e5Wg8narbZtyOTDr0VdVAZ1YEZ18bYSPSeidCfw8\/QpKdhQhXBZzQCMZdMO6\\n\"\n-            + \"WAqmli7eNuWf0MLw4eDBYuPCGEUZUaoXHugjddTI0JYT\/8ck0YwLJ66eetw6YWNg\\n\"\n-            + \"iJctXQUL5Tvrrs46R3N2qPos3cCHF+msMJn4HwIDAQABo4IBaTCCAWUwHwYDVR0j\\n\"\n-            + \"BBgwFoAUu69+Aj36pvE8hI6t7jiY7NkyMtQwHQYDVR0OBBYEFDna\/8ooFIqodBMI\\n\"\n-            + \"ueQOqdL6fp1pMA4GA1UdDwEB\/wQEAwIBBjASBgNVHRMBAf8ECDAGAQH\/AgEAMD4G\\n\"\n-            + \"A1UdIAQ3MDUwMwYEVR0gADArMCkGCCsGAQUFBwIBFh1odHRwczovL3NlY3VyZS5j\\n\"\n-            + \"b21vZG8uY29tL0NQUzBMBgNVHR8ERTBDMEGgP6A9hjtodHRwOi8vY3JsLmNvbW9k\\n\"\n-            + \"b2NhLmNvbS9DT01PRE9SU0FDZXJ0aWZpY2F0aW9uQXV0aG9yaXR5LmNybDBxBggr\\n\"\n-            + \"BgEFBQcBAQRlMGMwOwYIKwYBBQUHMAKGL2h0dHA6Ly9jcnQuY29tb2RvY2EuY29t\\n\"\n-            + \"L0NPTU9ET1JTQUFkZFRydXN0Q0EuY3J0MCQGCCsGAQUFBzABhhhodHRwOi8vb2Nz\\n\"\n-            + \"cC5jb21vZG9jYS5jb20wDQYJKoZIhvcNAQEMBQADggIBAERCnUFRK0iIXZebeV4R\\n\"\n-            + \"AUpSGXtBLMeJPNBy3IX6WK\/VJeQT+FhlZ58N\/1eLqYVeyqZLsKeyLeCMIs37\/3mk\\n\"\n-            + \"jCuN\/gI9JN6pXV\/kD0fQ22YlPodHDK4ixVAihNftSlka9pOlk7DgG4HyVsTIEFPk\\n\"\n-            + \"1Hax0VtpS3ey4E\/EhOfUoFDuPPpE\/NBXueEoU\/1Tzdy5H3pAvTA\/2GzS8+cHnx8i\\n\"\n-            + \"teoiccsq8FZ8\/qyo0QYPFBRSTP5kKwxpKrgNUG4+BAe\/eiCL+O5lCeHHSQgyPQ0o\\n\"\n-            + \"fkkdt0rvAucNgBfIXOBhYsvss2B5JdoaZXOcOBCgJjqwyBZ9kzEi7nQLiMBciUEA\\n\"\n-            + \"KKlHMd99SUWa9eanRRrSjhMQ34Ovmw2tfn6dNVA0BM7pINae253UqNpktNEvWS5e\\n\"\n-            + \"ojZh1CSggjMziqHRbO9haKPl0latxf1eYusVqHQSTC8xjOnB3xBLAer2VBvNfzu9\\n\"\n-            + \"XJ\/B288ByvK6YBIhMe2pZLiySVgXbVrXzYxtvp5\/4gJYp9vDLVj2dAZqmvZh+fYA\\n\"\n-            + \"tmnYOosxWd2R5nwnI4fdAw+PKowegwFOAWEMUnNt\/AiiuSpm5HZNMaBWm9lTjaK2\\n\"\n-            + \"jwLI5jqmBNFI+8NKAnb9L9K8E7bobTQk+p0pisehKxTxlgBzuRPpwLk6R1YCcYAn\\n\"\n-            + \"pLwltum95OmYdBbxN4SBB7SC\\n\"\n-            + \"-----END CERTIFICATE-----\";\n-\n-    \/\/ Owner: CN=comodorsacertificationauthority-ev.comodoca.com,\n-    \/\/ O=Sectigo Limited, STREET=\"3rd Floor, 26 Office Village\", STREET=Exchange Quay, STREET=Trafford Road,\n-    \/\/ L=Salford, ST=Manchester, OID.2.5.4.17=M5 3EQ, C=GB, OID.2.5.4.15=Private Organization,\n-    \/\/ OID.1.3.6.1.4.1.311.60.2.1.3=GB, SERIALNUMBER=04058690\n-    \/\/ Issuer: CN=COMODO RSA Extended Validation Secure Server CA, O=COMODO CA Limited, L=Salford,\n-    \/\/ ST=Greater Manchester, C=GB\n-    \/\/ Serial number: 9eb246629030e0b527ca2f93e5ebf25a\n-    \/\/ Valid from: Mon Mar 01 16:00:00 PST 2021 until: Sat Apr 02 16:59:59 PDT 2022\n-    private static final String VALID = \"-----BEGIN CERTIFICATE-----\\n\" +\n-            \"MIIHSzCCBjOgAwIBAgIRAJ6yRmKQMOC1J8ovk+Xr8lowDQYJKoZIhvcNAQELBQAw\\n\" +\n-            \"gZIxCzAJBgNVBAYTAkdCMRswGQYDVQQIExJHcmVhdGVyIE1hbmNoZXN0ZXIxEDAO\\n\" +\n-            \"BgNVBAcTB1NhbGZvcmQxGjAYBgNVBAoTEUNPTU9ETyBDQSBMaW1pdGVkMTgwNgYD\\n\" +\n-            \"VQQDEy9DT01PRE8gUlNBIEV4dGVuZGVkIFZhbGlkYXRpb24gU2VjdXJlIFNlcnZl\\n\" +\n-            \"ciBDQTAeFw0yMTAzMDIwMDAwMDBaFw0yMjA0MDIyMzU5NTlaMIIBNzERMA8GA1UE\\n\" +\n-            \"BRMIMDQwNTg2OTAxEzARBgsrBgEEAYI3PAIBAxMCR0IxHTAbBgNVBA8TFFByaXZh\\n\" +\n-            \"dGUgT3JnYW5pemF0aW9uMQswCQYDVQQGEwJHQjEPMA0GA1UEERMGTTUgM0VRMRMw\\n\" +\n-            \"EQYDVQQIEwpNYW5jaGVzdGVyMRAwDgYDVQQHEwdTYWxmb3JkMRYwFAYDVQQJEw1U\\n\" +\n-            \"cmFmZm9yZCBSb2FkMRYwFAYDVQQJEw1FeGNoYW5nZSBRdWF5MSUwIwYDVQQJExwz\\n\" +\n-            \"cmQgRmxvb3IsIDI2IE9mZmljZSBWaWxsYWdlMRgwFgYDVQQKEw9TZWN0aWdvIExp\\n\" +\n-            \"bWl0ZWQxODA2BgNVBAMTL2NvbW9kb3JzYWNlcnRpZmljYXRpb25hdXRob3JpdHkt\\n\" +\n-            \"ZXYuY29tb2RvY2EuY29tMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA\\n\" +\n-            \"0P95lAFOOkEOy614rCX7OlOK0Xy0nPAcCFxAcLYBosX8YmXWuePHg596UyEqE3U5\\n\" +\n-            \"30pTqiccY53bDiYPgSJgr1OlfC7BPLN+QKaeSrFmNgrcoAk3TXejgv7zLXOwZVS6\\n\" +\n-            \"Wk38Z8xrFNvhd2Z5J6RM\/3U+HDfF7OKMGrexr77Ws7lEFpPUgd4eEe+IL1Y2sbwI\\n\" +\n-            \"iD+PkzIL2LjctkeJFcsRHUvNP8wIhGyIbkARuJhdXkE13lKKIe0EnWrRkkf4DEvY\\n\" +\n-            \"RFpPjVUKmluhnBOGYkYaiTL0VaOnrPxToSfHR8Awkhk0TNbosAkUo8TKcRTTTiMU\\n\" +\n-            \"UIS6Y9SqoILiiDG6WmFjzQIDAQABo4IC8jCCAu4wHwYDVR0jBBgwFoAUOdr\/yigU\\n\" +\n-            \"iqh0Ewi55A6p0vp+nWkwHQYDVR0OBBYEFD5LhmEivA6h4az0EFPi5erz1TH+MA4G\\n\" +\n-            \"A1UdDwEB\/wQEAwIFoDAMBgNVHRMBAf8EAjAAMB0GA1UdJQQWMBQGCCsGAQUFBwMB\\n\" +\n-            \"BggrBgEFBQcDAjBJBgNVHSAEQjBAMDUGDCsGAQQBsjEBAgEFATAlMCMGCCsGAQUF\\n\" +\n-            \"BwIBFhdodHRwczovL3NlY3RpZ28uY29tL0NQUzAHBgVngQwBATBWBgNVHR8ETzBN\\n\" +\n-            \"MEugSaBHhkVodHRwOi8vY3JsLmNvbW9kb2NhLmNvbS9DT01PRE9SU0FFeHRlbmRl\\n\" +\n-            \"ZFZhbGlkYXRpb25TZWN1cmVTZXJ2ZXJDQS5jcmwwgYcGCCsGAQUFBwEBBHsweTBR\\n\" +\n-            \"BggrBgEFBQcwAoZFaHR0cDovL2NydC5jb21vZG9jYS5jb20vQ09NT0RPUlNBRXh0\\n\" +\n-            \"ZW5kZWRWYWxpZGF0aW9uU2VjdXJlU2VydmVyQ0EuY3J0MCQGCCsGAQUFBzABhhho\\n\" +\n-            \"dHRwOi8vb2NzcC5jb21vZG9jYS5jb20wOgYDVR0RBDMwMYIvY29tb2RvcnNhY2Vy\\n\" +\n-            \"dGlmaWNhdGlvbmF1dGhvcml0eS1ldi5jb21vZG9jYS5jb20wggEEBgorBgEEAdZ5\\n\" +\n-            \"AgQCBIH1BIHyAPAAdgBGpVXrdfqRIDC1oolp9PN9ESxBdL79SbiFq\/L8cP5tRwAA\\n\" +\n-            \"AXfyqEfyAAAEAwBHMEUCIQDJbHPgbqK21\/Nugwl5mgMO81YQSHOm4VcQ8UvOJjnN\\n\" +\n-            \"JQIgWw9fortwJBtv2Mts6xJYr5D6itPpEYP8uegURneBwRsAdgBvU3asMfAxGdiZ\\n\" +\n-            \"AKRRFf93FRwR2QLBACkGjbIImjfZEwAAAXfyqEjyAAAEAwBHMEUCIDifAsuw37D4\\n\" +\n-            \"beHZ9Ed5\/Pab0Eg6Cobrh4jv3bjfA6KIAiEAmiA\/XD+AccfI85c+C2zH9wNIs+Zm\\n\" +\n-            \"\/V\/uo\/sv0i9eCAYwDQYJKoZIhvcNAQELBQADggEBADRFnOFgb3mzCUpXxiU5\/mM5\\n\" +\n-            \"ECRj3NzXKXjcYlSMhVcWA7Eqa5rhJuh11vbPoDQzQcGxntS\/zhRwJFRF3hnyFa3m\\n\" +\n-            \"4t+7ZnUaJN+GOMTABh4kYiOSpE9id12URdJzWv2IHg4CU3OLnsBHGh7H9eWfbPvn\\n\" +\n-            \"OW4owV1ChpiEHh40i\/NQkTn9JzjlZepI9+EsSdhn2tpis7tko6PX\/plgw8bRgm7f\\n\" +\n-            \"ong2QaX\/DE6z4VIdomW8TQhB9turhKxwjzPTbtYDQIgZfRP\/H1S5jYutqbE5yL5B\\n\" +\n-            \"r+VOiSuB8234P4xWg1IBL2EFbxPdgOSMTWRJutUcj44kJKmwp5GUQtySSccw4gk=\\n\" +\n-            \"-----END CERTIFICATE-----\";\n+    public void runTest() throws Exception {\n+        ValidatePathWithURL validatePathWithURL = new ValidatePathWithURL(CA_ALIAS);\n@@ -163,62 +72,2 @@\n-    \/\/ Owner: CN=comodorsacertificationauthority-ev.comodoca.com, OU=COMODO EV SGC SSL,\n-    \/\/ O=Sectigo Limited, STREET=\"3rd Floor, 26 Office Village\", STREET=Exchange Quay, STREET=Trafford Road,\n-    \/\/ L=Salford, OID.2.5.4.17=M5 3EQ, C=GB, OID.2.5.4.15=Private Organization,\n-    \/\/ OID.1.3.6.1.4.1.311.60.2.1.3=GB, SERIALNUMBER=04058690\n-    \/\/ Issuer: CN=COMODO RSA Extended Validation Secure Server CA, O=COMODO CA Limited, L=Salford,\n-    \/\/ ST=Greater Manchester, C=GB\n-    \/\/ Serial number: a0c7cabcc25ed9358ded02cc1d485545\n-    \/\/ Valid from: Sun Sep 29 17:00:00 PDT 2019 until: Tue Dec 28 15:59:59 PST 2021\n-    private static final String REVOKED = \"-----BEGIN CERTIFICATE-----\\n\" +\n-            \"MIIH0TCCBrmgAwIBAgIRAKDHyrzCXtk1je0CzB1IVUUwDQYJKoZIhvcNAQELBQAw\\n\" +\n-            \"gZIxCzAJBgNVBAYTAkdCMRswGQYDVQQIExJHcmVhdGVyIE1hbmNoZXN0ZXIxEDAO\\n\" +\n-            \"BgNVBAcTB1NhbGZvcmQxGjAYBgNVBAoTEUNPTU9ETyBDQSBMaW1pdGVkMTgwNgYD\\n\" +\n-            \"VQQDEy9DT01PRE8gUlNBIEV4dGVuZGVkIFZhbGlkYXRpb24gU2VjdXJlIFNlcnZl\\n\" +\n-            \"ciBDQTAeFw0xOTA5MzAwMDAwMDBaFw0yMTEyMjgyMzU5NTlaMIIBPjERMA8GA1UE\\n\" +\n-            \"BRMIMDQwNTg2OTAxEzARBgsrBgEEAYI3PAIBAxMCR0IxHTAbBgNVBA8TFFByaXZh\\n\" +\n-            \"dGUgT3JnYW5pemF0aW9uMQswCQYDVQQGEwJHQjEPMA0GA1UEERMGTTUgM0VRMRAw\\n\" +\n-            \"DgYDVQQHEwdTYWxmb3JkMRYwFAYDVQQJEw1UcmFmZm9yZCBSb2FkMRYwFAYDVQQJ\\n\" +\n-            \"Ew1FeGNoYW5nZSBRdWF5MSUwIwYDVQQJExwzcmQgRmxvb3IsIDI2IE9mZmljZSBW\\n\" +\n-            \"aWxsYWdlMRgwFgYDVQQKEw9TZWN0aWdvIExpbWl0ZWQxGjAYBgNVBAsTEUNPTU9E\\n\" +\n-            \"TyBFViBTR0MgU1NMMTgwNgYDVQQDEy9jb21vZG9yc2FjZXJ0aWZpY2F0aW9uYXV0\\n\" +\n-            \"aG9yaXR5LWV2LmNvbW9kb2NhLmNvbTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCC\\n\" +\n-            \"AQoCggEBAND\/eZQBTjpBDsuteKwl+zpTitF8tJzwHAhcQHC2AaLF\/GJl1rnjx4Of\\n\" +\n-            \"elMhKhN1Od9KU6onHGOd2w4mD4EiYK9TpXwuwTyzfkCmnkqxZjYK3KAJN013o4L+\\n\" +\n-            \"8y1zsGVUulpN\/GfMaxTb4XdmeSekTP91Phw3xezijBq3sa++1rO5RBaT1IHeHhHv\\n\" +\n-            \"iC9WNrG8CIg\/j5MyC9i43LZHiRXLER1LzT\/MCIRsiG5AEbiYXV5BNd5SiiHtBJ1q\\n\" +\n-            \"0ZJH+AxL2ERaT41VCppboZwThmJGGoky9FWjp6z8U6Enx0fAMJIZNEzW6LAJFKPE\\n\" +\n-            \"ynEU004jFFCEumPUqqCC4ogxulphY80CAwEAAaOCA3EwggNtMB8GA1UdIwQYMBaA\\n\" +\n-            \"FDna\/8ooFIqodBMIueQOqdL6fp1pMB0GA1UdDgQWBBQ+S4ZhIrwOoeGs9BBT4uXq\\n\" +\n-            \"89Ux\/jAOBgNVHQ8BAf8EBAMCBaAwDAYDVR0TAQH\/BAIwADAdBgNVHSUEFjAUBggr\\n\" +\n-            \"BgEFBQcDAQYIKwYBBQUHAwIwTwYDVR0gBEgwRjA7BgwrBgEEAbIxAQIBBQEwKzAp\\n\" +\n-            \"BggrBgEFBQcCARYdaHR0cHM6Ly9zZWN1cmUuY29tb2RvLmNvbS9DUFMwBwYFZ4EM\\n\" +\n-            \"AQEwVgYDVR0fBE8wTTBLoEmgR4ZFaHR0cDovL2NybC5jb21vZG9jYS5jb20vQ09N\\n\" +\n-            \"T0RPUlNBRXh0ZW5kZWRWYWxpZGF0aW9uU2VjdXJlU2VydmVyQ0EuY3JsMIGHBggr\\n\" +\n-            \"BgEFBQcBAQR7MHkwUQYIKwYBBQUHMAKGRWh0dHA6Ly9jcnQuY29tb2RvY2EuY29t\\n\" +\n-            \"L0NPTU9ET1JTQUV4dGVuZGVkVmFsaWRhdGlvblNlY3VyZVNlcnZlckNBLmNydDAk\\n\" +\n-            \"BggrBgEFBQcwAYYYaHR0cDovL29jc3AuY29tb2RvY2EuY29tMDoGA1UdEQQzMDGC\\n\" +\n-            \"L2NvbW9kb3JzYWNlcnRpZmljYXRpb25hdXRob3JpdHktZXYuY29tb2RvY2EuY29t\\n\" +\n-            \"MIIBfQYKKwYBBAHWeQIEAgSCAW0EggFpAWcAdQDuS723dc5guuFCaR+r4Z5mow9+\\n\" +\n-            \"X7By2IMAxHuJeqj9ywAAAW2DAXefAAAEAwBGMEQCIDqP1einOiPHnaG1fOZMDrEc\\n\" +\n-            \"RAxjq3vEl94fp4pkmke7AiBsJOvPE6irgcOO1\/lnP7NRuln7iPJjU7T20PEK5\/rm\\n\" +\n-            \"KwB2AFWB1MIWkDYBSuoLm1c8U\/DA5Dh4cCUIFy+jqh0HE9MMAAABbYMBd0kAAAQD\\n\" +\n-            \"AEcwRQIhALgUI5XxM1NHbJDdr19h2pe3LhzK4tpuB\/OQ9BgCyrGXAiBdr6mNCB\/G\\n\" +\n-            \"rbdVx0u7iezwC7mq7iaWugR3rrWlSA8fWQB2ALvZ37wfinG1k5Qjl6qSe0c4V5UK\\n\" +\n-            \"q1LoGpCWZDaOHtGFAAABbYMBd1oAAAQDAEcwRQIgXbG32dagMeLhuZb+LSpJO1vI\\n\" +\n-            \"BmxmRnNdiz5FbG9cCbwCIQCr1X9f+ebT5fhlDUNBURUorTtM8QQciBiueBqvHk7+\\n\" +\n-            \"1DANBgkqhkiG9w0BAQsFAAOCAQEAM\/A\/1dgoc5NP1n+w3SX9qWcN7QT7ExdrnZSl\\n\" +\n-            \"Ygn0PF2fx4gz7cvNKucbpQJNA4C9awGydyYK8\/o5KDUXt3K7eb1OAZ\/NZBjygsJs\\n\" +\n-            \"ikXvxlBh8oEoqBOfOtr24l0NGUWnP8Qeu\/VPcIMER4V8qX+in0pCXkSd67nkp6Bs\\n\" +\n-            \"EcqhDPgmzdSC1gQHsZuBdotG14OfdH1cG1bRK6GadISLG1h8BFukVem42B149v8F\\n\" +\n-            \"MCIUQAYprAVv2WlTZKBx9XzuK6IK3+klHZ07Jfvjvt7PPG5HKSMWBMnMaTHKcyQI\\n\" +\n-            \"G3t91yw7BnNNInZlBSsFtqjbHhDcr7uruZdbi0rerSsi2qDr0w==\\n\" +\n-            \"-----END CERTIFICATE-----\";\n-\n-    public void runTest(ValidatePathWithParams pathValidator) throws Exception {\n-        \/\/ Validate valid\n-        pathValidator.validate(new String[]{VALID, INT},\n-                ValidatePathWithParams.Status.GOOD, null, System.out);\n-\n-        \/\/ Validate Revoked\n-        pathValidator.validate(new String[]{REVOKED, INT},\n-                ValidatePathWithParams.Status.REVOKED,\n-                \"Tue Mar 02 02:51:39 PST 2021\", System.out);\n+        validatePathWithURL.validateDomain(VALID, false);\n+        validatePathWithURL.validateDomain(REVOKED, true);\n@@ -229,0 +78,3 @@\n+    private static final String VALID = \"https:\/\/comodoecccertificationauthority-ev.comodoca.com\";\n+    private static final String REVOKED = \"https:\/\/comodoecccertificationauthority-ev.comodoca.com:444\";\n+    private static final String CA_ALIAS = \"comodoeccca [jdk]\";\n@@ -230,69 +82,2 @@\n-    \/\/ Owner: CN=COMODO ECC Extended Validation Secure Server CA,\n-    \/\/ O=COMODO CA Limited, L=Salford, ST=Greater Manchester, C=GB\n-    \/\/ Issuer: CN=COMODO ECC Certification Authority, O=COMODO CA Limited,\n-    \/\/ L=Salford, ST=Greater Manchester, C=GB\n-    \/\/ Serial number: 61d4643b412b5d8d715499d8553aa03\n-    \/\/ Valid from: Sun Apr 14 17:00:00 PDT 2013 until: Fri Apr 14 16:59:59 PDT 2028\n-    private static final String INT = \"-----BEGIN CERTIFICATE-----\\n\"\n-            + \"MIIDojCCAyigAwIBAgIQBh1GQ7QStdjXFUmdhVOqAzAKBggqhkjOPQQDAzCBhTEL\\n\"\n-            + \"MAkGA1UEBhMCR0IxGzAZBgNVBAgTEkdyZWF0ZXIgTWFuY2hlc3RlcjEQMA4GA1UE\\n\"\n-            + \"BxMHU2FsZm9yZDEaMBgGA1UEChMRQ09NT0RPIENBIExpbWl0ZWQxKzApBgNVBAMT\\n\"\n-            + \"IkNPTU9ETyBFQ0MgQ2VydGlmaWNhdGlvbiBBdXRob3JpdHkwHhcNMTMwNDE1MDAw\\n\"\n-            + \"MDAwWhcNMjgwNDE0MjM1OTU5WjCBkjELMAkGA1UEBhMCR0IxGzAZBgNVBAgTEkdy\\n\"\n-            + \"ZWF0ZXIgTWFuY2hlc3RlcjEQMA4GA1UEBxMHU2FsZm9yZDEaMBgGA1UEChMRQ09N\\n\"\n-            + \"T0RPIENBIExpbWl0ZWQxODA2BgNVBAMTL0NPTU9ETyBFQ0MgRXh0ZW5kZWQgVmFs\\n\"\n-            + \"aWRhdGlvbiBTZWN1cmUgU2VydmVyIENBMFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcD\\n\"\n-            + \"QgAEV3AaPyeTQy0aWXXkBJMR42DsJ5pnbliJe7ndaHzCDslVlY8ofpxeFiqluZrK\\n\"\n-            + \"KNcJeBU\/Jl1YI9jLMyMZKsfSoaOCAWkwggFlMB8GA1UdIwQYMBaAFHVxpxlIGbyd\\n\"\n-            + \"nepBR9+UxEh3mdN5MB0GA1UdDgQWBBTTTsMZulhZ0Rxgt2FTRzund4\/4ijAOBgNV\\n\"\n-            + \"HQ8BAf8EBAMCAYYwEgYDVR0TAQH\/BAgwBgEB\/wIBADA+BgNVHSAENzA1MDMGBFUd\\n\"\n-            + \"IAAwKzApBggrBgEFBQcCARYdaHR0cHM6Ly9zZWN1cmUuY29tb2RvLmNvbS9DUFMw\\n\"\n-            + \"TAYDVR0fBEUwQzBBoD+gPYY7aHR0cDovL2NybC5jb21vZG9jYS5jb20vQ09NT0RP\\n\"\n-            + \"RUNDQ2VydGlmaWNhdGlvbkF1dGhvcml0eS5jcmwwcQYIKwYBBQUHAQEEZTBjMDsG\\n\"\n-            + \"CCsGAQUFBzAChi9odHRwOi8vY3J0LmNvbW9kb2NhLmNvbS9DT01PRE9FQ0NBZGRU\\n\"\n-            + \"cnVzdENBLmNydDAkBggrBgEFBQcwAYYYaHR0cDovL29jc3AuY29tb2RvY2EuY29t\\n\"\n-            + \"MAoGCCqGSM49BAMDA2gAMGUCMQDmPWS98nREWdt4xB83r9MVvgG5INpKHi6V1dUY\\n\"\n-            + \"lCqvSvXXjK0QvZSrOB7cj9RavGgCMG2xJNG+SvlTWEYpmK7eXSgmRUgoBDeQ0yDK\\n\"\n-            + \"lnxmeeOBnnCaDIxAcA3aCj2Gtdt3sA==\\n\"\n-            + \"-----END CERTIFICATE-----\";\n-\n-    \/\/ Owner: CN=comodoecccertificationauthority-ev.comodoca.com, O=Sectigo Limited, STREET=\"3rd Floor,\n-    \/\/ 26 Office Village\", STREET=Exchange Quay, STREET=Trafford Road, L=Salford, ST=Manchester, OID.2.5.4.17=M5 3EQ,\n-    \/\/ C=GB, OID.2.5.4.15=Private Organization, OID.1.3.6.1.4.1.311.60.2.1.3=GB, SERIALNUMBER=04058690\n-    \/\/ Issuer: CN=COMODO ECC Extended Validation Secure Server CA, O=COMODO CA Limited, L=Salford,\n-    \/\/ ST=Greater Manchester, C=GB\n-    \/\/ Serial number: db437a31e5be29a62443e3caa1479001\n-    \/\/ Valid from: Mon Mar 01 16:00:00 PST 2021 until: Sat Apr 02 16:59:59 PDT 2022\n-    private static final String VALID = \"-----BEGIN CERTIFICATE-----\\n\" +\n-            \"MIIFvzCCBWWgAwIBAgIRANtDejHlvimmJEPjyqFHkAEwCgYIKoZIzj0EAwIwgZIx\\n\" +\n-            \"CzAJBgNVBAYTAkdCMRswGQYDVQQIExJHcmVhdGVyIE1hbmNoZXN0ZXIxEDAOBgNV\\n\" +\n-            \"BAcTB1NhbGZvcmQxGjAYBgNVBAoTEUNPTU9ETyBDQSBMaW1pdGVkMTgwNgYDVQQD\\n\" +\n-            \"Ey9DT01PRE8gRUNDIEV4dGVuZGVkIFZhbGlkYXRpb24gU2VjdXJlIFNlcnZlciBD\\n\" +\n-            \"QTAeFw0yMTAzMDIwMDAwMDBaFw0yMjA0MDIyMzU5NTlaMIIBNzERMA8GA1UEBRMI\\n\" +\n-            \"MDQwNTg2OTAxEzARBgsrBgEEAYI3PAIBAxMCR0IxHTAbBgNVBA8TFFByaXZhdGUg\\n\" +\n-            \"T3JnYW5pemF0aW9uMQswCQYDVQQGEwJHQjEPMA0GA1UEERMGTTUgM0VRMRMwEQYD\\n\" +\n-            \"VQQIEwpNYW5jaGVzdGVyMRAwDgYDVQQHEwdTYWxmb3JkMRYwFAYDVQQJEw1UcmFm\\n\" +\n-            \"Zm9yZCBSb2FkMRYwFAYDVQQJEw1FeGNoYW5nZSBRdWF5MSUwIwYDVQQJExwzcmQg\\n\" +\n-            \"Rmxvb3IsIDI2IE9mZmljZSBWaWxsYWdlMRgwFgYDVQQKEw9TZWN0aWdvIExpbWl0\\n\" +\n-            \"ZWQxODA2BgNVBAMTL2NvbW9kb2VjY2NlcnRpZmljYXRpb25hdXRob3JpdHktZXYu\\n\" +\n-            \"Y29tb2RvY2EuY29tMFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEt26qBS7TRu\/y\\n\" +\n-            \"fR+RiqLAzW2C+UspFZlORc4EhLfNYMgFkoZKjEnwJzudH6a+uRPqPOhPgUd6PFfR\\n\" +\n-            \"QFOcLjmhgaOCAvIwggLuMB8GA1UdIwQYMBaAFNNOwxm6WFnRHGC3YVNHO6d3j\/iK\\n\" +\n-            \"MB0GA1UdDgQWBBTpZ0tzKscFw6Z3vCEDFzGR5VSkVzAOBgNVHQ8BAf8EBAMCBYAw\\n\" +\n-            \"DAYDVR0TAQH\/BAIwADAdBgNVHSUEFjAUBggrBgEFBQcDAQYIKwYBBQUHAwIwSQYD\\n\" +\n-            \"VR0gBEIwQDA1BgwrBgEEAbIxAQIBBQEwJTAjBggrBgEFBQcCARYXaHR0cHM6Ly9z\\n\" +\n-            \"ZWN0aWdvLmNvbS9DUFMwBwYFZ4EMAQEwVgYDVR0fBE8wTTBLoEmgR4ZFaHR0cDov\\n\" +\n-            \"L2NybC5jb21vZG9jYS5jb20vQ09NT0RPRUNDRXh0ZW5kZWRWYWxpZGF0aW9uU2Vj\\n\" +\n-            \"dXJlU2VydmVyQ0EuY3JsMIGHBggrBgEFBQcBAQR7MHkwUQYIKwYBBQUHMAKGRWh0\\n\" +\n-            \"dHA6Ly9jcnQuY29tb2RvY2EuY29tL0NPTU9ET0VDQ0V4dGVuZGVkVmFsaWRhdGlv\\n\" +\n-            \"blNlY3VyZVNlcnZlckNBLmNydDAkBggrBgEFBQcwAYYYaHR0cDovL29jc3AuY29t\\n\" +\n-            \"b2RvY2EuY29tMDoGA1UdEQQzMDGCL2NvbW9kb2VjY2NlcnRpZmljYXRpb25hdXRo\\n\" +\n-            \"b3JpdHktZXYuY29tb2RvY2EuY29tMIIBBAYKKwYBBAHWeQIEAgSB9QSB8gDwAHYA\\n\" +\n-            \"RqVV63X6kSAwtaKJafTzfREsQXS+\/Um4havy\/HD+bUcAAAF38qtH4AAABAMARzBF\\n\" +\n-            \"AiBsKoB1TTfoUYUNqF160\/vlOENHyK1zzARcnfGKYURHTwIhANKYWg1CO7jyCPk+\\n\" +\n-            \"IrrLaR+461snNK4LJZXJm4o\/9GeeAHYAb1N2rDHwMRnYmQCkURX\/dxUcEdkCwQAp\\n\" +\n-            \"Bo2yCJo32RMAAAF38qtJIAAABAMARzBFAiEA1hgxkYZb5Tc9+vQsDnsfXVewClN2\\n\" +\n-            \"7gzwd4hZdqAsOSYCID9CWcBvkKrL44mfe9ky1Z6BnAWHUBMCxTjt8MO\/IMZ8MAoG\\n\" +\n-            \"CCqGSM49BAMCA0gAMEUCIBa3sfOiVb0q4LcXU9umKjzVw3Ib8VdiPTtXSnyl0oLb\\n\" +\n-            \"AiEAnpRB53UtLAF7xw98ELmK\/LEk1b5KSlqoO8sFHgwQ8vI=\\n\" +\n-            \"-----END CERTIFICATE-----\";\n+    public void runTest() throws Exception {\n+        ValidatePathWithURL validatePathWithURL = new ValidatePathWithURL(CA_ALIAS);\n@@ -300,53 +85,2 @@\n-    \/\/ Owner: CN=comodoecccertificationauthority-ev.comodoca.com, OU=COMODO EV SSL, O=Sectigo Limited,\n-    \/\/ STREET=\"3rd Floor, 26 Office Village\", STREET=Exchange Quay, STREET=Trafford Road, L=Salford, OID.2.5.4.17=M5 3EQ,\n-    \/\/ C=GB, OID.2.5.4.15=Private Organization, OID.1.3.6.1.4.1.311.60.2.1.3=GB, SERIALNUMBER=04058690\n-    \/\/ Issuer: CN=COMODO ECC Extended Validation Secure Server CA, O=COMODO CA Limited, L=Salford,\n-    \/\/ ST=Greater Manchester, C=GB\n-    \/\/ Serial number: 7972d9d8472a2d52ad1ee6edfb16cbe1\n-    \/\/ Valid from: Sun Sep 29 17:00:00 PDT 2019 until: Tue Dec 28 15:59:59 PST 2021\n-    private static final String REVOKED = \"-----BEGIN CERTIFICATE-----\\n\" +\n-            \"MIIGPzCCBeWgAwIBAgIQeXLZ2EcqLVKtHubt+xbL4TAKBggqhkjOPQQDAjCBkjEL\\n\" +\n-            \"MAkGA1UEBhMCR0IxGzAZBgNVBAgTEkdyZWF0ZXIgTWFuY2hlc3RlcjEQMA4GA1UE\\n\" +\n-            \"BxMHU2FsZm9yZDEaMBgGA1UEChMRQ09NT0RPIENBIExpbWl0ZWQxODA2BgNVBAMT\\n\" +\n-            \"L0NPTU9ETyBFQ0MgRXh0ZW5kZWQgVmFsaWRhdGlvbiBTZWN1cmUgU2VydmVyIENB\\n\" +\n-            \"MB4XDTE5MDkzMDAwMDAwMFoXDTIxMTIyODIzNTk1OVowggE6MREwDwYDVQQFEwgw\\n\" +\n-            \"NDA1ODY5MDETMBEGCysGAQQBgjc8AgEDEwJHQjEdMBsGA1UEDxMUUHJpdmF0ZSBP\\n\" +\n-            \"cmdhbml6YXRpb24xCzAJBgNVBAYTAkdCMQ8wDQYDVQQREwZNNSAzRVExEDAOBgNV\\n\" +\n-            \"BAcTB1NhbGZvcmQxFjAUBgNVBAkTDVRyYWZmb3JkIFJvYWQxFjAUBgNVBAkTDUV4\\n\" +\n-            \"Y2hhbmdlIFF1YXkxJTAjBgNVBAkTHDNyZCBGbG9vciwgMjYgT2ZmaWNlIFZpbGxh\\n\" +\n-            \"Z2UxGDAWBgNVBAoTD1NlY3RpZ28gTGltaXRlZDEWMBQGA1UECxMNQ09NT0RPIEVW\\n\" +\n-            \"IFNTTDE4MDYGA1UEAxMvY29tb2RvZWNjY2VydGlmaWNhdGlvbmF1dGhvcml0eS1l\\n\" +\n-            \"di5jb21vZG9jYS5jb20wWTATBgcqhkjOPQIBBggqhkjOPQMBBwNCAAS3bqoFLtNG\\n\" +\n-            \"7\/J9H5GKosDNbYL5SykVmU5FzgSEt81gyAWShkqMSfAnO50fpr65E+o86E+BR3o8\\n\" +\n-            \"V9FAU5wuOaGBo4IDcDCCA2wwHwYDVR0jBBgwFoAU007DGbpYWdEcYLdhU0c7p3eP\\n\" +\n-            \"+IowHQYDVR0OBBYEFOlnS3MqxwXDpne8IQMXMZHlVKRXMA4GA1UdDwEB\/wQEAwIF\\n\" +\n-            \"gDAMBgNVHRMBAf8EAjAAMB0GA1UdJQQWMBQGCCsGAQUFBwMBBggrBgEFBQcDAjBP\\n\" +\n-            \"BgNVHSAESDBGMDsGDCsGAQQBsjEBAgEFATArMCkGCCsGAQUFBwIBFh1odHRwczov\\n\" +\n-            \"L3NlY3VyZS5jb21vZG8uY29tL0NQUzAHBgVngQwBATBWBgNVHR8ETzBNMEugSaBH\\n\" +\n-            \"hkVodHRwOi8vY3JsLmNvbW9kb2NhLmNvbS9DT01PRE9FQ0NFeHRlbmRlZFZhbGlk\\n\" +\n-            \"YXRpb25TZWN1cmVTZXJ2ZXJDQS5jcmwwgYcGCCsGAQUFBwEBBHsweTBRBggrBgEF\\n\" +\n-            \"BQcwAoZFaHR0cDovL2NydC5jb21vZG9jYS5jb20vQ09NT0RPRUNDRXh0ZW5kZWRW\\n\" +\n-            \"YWxpZGF0aW9uU2VjdXJlU2VydmVyQ0EuY3J0MCQGCCsGAQUFBzABhhhodHRwOi8v\\n\" +\n-            \"b2NzcC5jb21vZG9jYS5jb20wOgYDVR0RBDMwMYIvY29tb2RvZWNjY2VydGlmaWNh\\n\" +\n-            \"dGlvbmF1dGhvcml0eS1ldi5jb21vZG9jYS5jb20wggF8BgorBgEEAdZ5AgQCBIIB\\n\" +\n-            \"bASCAWgBZgB1AO5Lvbd1zmC64UJpH6vhnmajD35fsHLYgwDEe4l6qP3LAAABbYME\\n\" +\n-            \"EzgAAAQDAEYwRAIgbdo71lBleuJiq+D0ZLp51oVUyWD9EyrtgBSCNwIW4cMCIAqg\\n\" +\n-            \"0VFTWHEmAVjaV23fGj3Ybu3mpSiHr6viGlgA2lYaAHUAVYHUwhaQNgFK6gubVzxT\\n\" +\n-            \"8MDkOHhwJQgXL6OqHQcT0wwAAAFtgwQTKAAABAMARjBEAiBb\/gW1RU7kgFBiNpHx\\n\" +\n-            \"LStujKIocyENUTXsMbsac+LktwIgXbEr8vOOCEdBdXQ2F\/FKec8ft6gz57mHNmwl\\n\" +\n-            \"pp7phbQAdgC72d+8H4pxtZOUI5eqkntHOFeVCqtS6BqQlmQ2jh7RhQAAAW2DBBM6\\n\" +\n-            \"AAAEAwBHMEUCIQDjKN3h86ofR94+JxLFoYuoA+DRtxEY8XGg+NQXlZfUrgIgEoO2\\n\" +\n-            \"ZzKbGfohdwj\/WtDwJDRX5pjXF4M0nECiwtYXDIwwCgYIKoZIzj0EAwIDSAAwRQIg\\n\" +\n-            \"AkIRVQBwrElFjrnqk5XPvnlnwkIm1A70ayqOf1FexoQCIQC8tBTn\/\/RCfrhcgTjd\\n\" +\n-            \"ER4wRjFfFoc6lC68OHGVg9CZZg==\\n\" +\n-            \"-----END CERTIFICATE-----\";\n-\n-    public void runTest(ValidatePathWithParams pathValidator) throws Exception {\n-        \/\/ Validate valid\n-        pathValidator.validate(new String[]{VALID, INT},\n-                ValidatePathWithParams.Status.GOOD, null, System.out);\n-\n-        \/\/ Validate Revoked\n-        pathValidator.validate(new String[]{REVOKED, INT},\n-                ValidatePathWithParams.Status.REVOKED,\n-                \"Tue Mar 02 02:53:40 PST 2021\", System.out);\n+        validatePathWithURL.validateDomain(VALID, false);\n+        validatePathWithURL.validateDomain(REVOKED, true);\n@@ -357,0 +91,3 @@\n+    private static final String VALID = \"https:\/\/usertrustrsacertificationauthority-ev.comodoca.com\";\n+    private static final String REVOKED = \"https:\/\/usertrustrsacertificationauthority-ev.comodoca.com:444\";\n+    private static final String CA_ALIAS = \"usertrustrsaca [jdk]\";\n@@ -358,91 +95,2 @@\n-    \/\/ Owner: CN=Sectigo RSA Extended Validation Secure Server CA, O=Sectigo Limited, L=Salford,\n-    \/\/ ST=Greater Manchester, C=GB\n-    \/\/ Issuer: CN=USERTrust RSA Certification Authority, O=The USERTRUST Network, L=Jersey City, ST=New Jersey, C=US\n-    \/\/ Serial number: 284e39c14b386d889c7299e58cd05a57\n-    \/\/ Valid from: Thu Nov 01 17:00:00 PDT 2018 until: Tue Dec 31 15:59:59 PST 2030\n-    private static final String INT = \"-----BEGIN CERTIFICATE-----\\n\" +\n-            \"MIIGNDCCBBygAwIBAgIQKE45wUs4bYiccpnljNBaVzANBgkqhkiG9w0BAQwFADCB\\n\" +\n-            \"iDELMAkGA1UEBhMCVVMxEzARBgNVBAgTCk5ldyBKZXJzZXkxFDASBgNVBAcTC0pl\\n\" +\n-            \"cnNleSBDaXR5MR4wHAYDVQQKExVUaGUgVVNFUlRSVVNUIE5ldHdvcmsxLjAsBgNV\\n\" +\n-            \"BAMTJVVTRVJUcnVzdCBSU0EgQ2VydGlmaWNhdGlvbiBBdXRob3JpdHkwHhcNMTgx\\n\" +\n-            \"MTAyMDAwMDAwWhcNMzAxMjMxMjM1OTU5WjCBkTELMAkGA1UEBhMCR0IxGzAZBgNV\\n\" +\n-            \"BAgTEkdyZWF0ZXIgTWFuY2hlc3RlcjEQMA4GA1UEBxMHU2FsZm9yZDEYMBYGA1UE\\n\" +\n-            \"ChMPU2VjdGlnbyBMaW1pdGVkMTkwNwYDVQQDEzBTZWN0aWdvIFJTQSBFeHRlbmRl\\n\" +\n-            \"ZCBWYWxpZGF0aW9uIFNlY3VyZSBTZXJ2ZXIgQ0EwggEiMA0GCSqGSIb3DQEBAQUA\\n\" +\n-            \"A4IBDwAwggEKAoIBAQCaoslYBiqFev0Yc4TXPa0s9oliMcn9VaENfTUK4GVT7niB\\n\" +\n-            \"QXxC6Mt8kTtvyr5lU92hDQDh2WDPQsZ7oibh75t2kowT3z1S+Sy1GsUDM4NbdOde\\n\" +\n-            \"orcmzFm\/b4bwD4G\/G+pB4EX1HSfjN9eT0Hje+AGvCrd2MmnxJ+Yymv9BH9OB65jK\\n\" +\n-            \"rUO9Na4iHr48XWBDFvzsPCJ11Uioof6dRBVp+Lauj88Z7k2X8d606HeXn43h6acp\\n\" +\n-            \"LLURWyqXM0CrzedVWBzuXKuBEaqD6w\/1VpLJvSU+wl3ScvXSLFp82DSRJVJONXWl\\n\" +\n-            \"dp9gjJioPGRByeZw11k3galbbF5gFK9xSnbDx29LAgMBAAGjggGNMIIBiTAfBgNV\\n\" +\n-            \"HSMEGDAWgBRTeb9aqitKz1SA4dibwJ3ysgNmyzAdBgNVHQ4EFgQULGn\/gMmHkK40\\n\" +\n-            \"4bTnTJOFmUDpp7IwDgYDVR0PAQH\/BAQDAgGGMBIGA1UdEwEB\/wQIMAYBAf8CAQAw\\n\" +\n-            \"HQYDVR0lBBYwFAYIKwYBBQUHAwEGCCsGAQUFBwMCMDoGA1UdIAQzMDEwLwYEVR0g\\n\" +\n-            \"ADAnMCUGCCsGAQUFBwIBFhlodHRwczovL2Nwcy51c2VydHJ1c3QuY29tMFAGA1Ud\\n\" +\n-            \"HwRJMEcwRaBDoEGGP2h0dHA6Ly9jcmwudXNlcnRydXN0LmNvbS9VU0VSVHJ1c3RS\\n\" +\n-            \"U0FDZXJ0aWZpY2F0aW9uQXV0aG9yaXR5LmNybDB2BggrBgEFBQcBAQRqMGgwPwYI\\n\" +\n-            \"KwYBBQUHMAKGM2h0dHA6Ly9jcnQudXNlcnRydXN0LmNvbS9VU0VSVHJ1c3RSU0FB\\n\" +\n-            \"ZGRUcnVzdENBLmNydDAlBggrBgEFBQcwAYYZaHR0cDovL29jc3AudXNlcnRydXN0\\n\" +\n-            \"LmNvbTANBgkqhkiG9w0BAQwFAAOCAgEAQ4AzPxVypLyy3IjUUmVl7FaxrHsXQq2z\\n\" +\n-            \"Zt2gKnHQShuA+5xpRPNndjvhHk4D08PZXUe6Im7E5knqxtyl5aYdldb+HI\/7f+zd\\n\" +\n-            \"W\/1ub2N4Vq4ZYUjcZ1ECOFK7Z2zoNicDmU+Fe\/TreXPuPsDicTG\/tMcWEVM558OQ\\n\" +\n-            \"TJkB2LK3ZhGukWM\/RTMRcRdXaXOX8Lh0ylzRO1O0ObXytvOFpkkkD92HGsfS06i7\\n\" +\n-            \"NLDPJEeZXqzHE5Tqj7VSAj+2luwfaXaPLD8lQEVci8xmsPGOn0mXE1ZzsChEPhVq\\n\" +\n-            \"FYQUsbiRJRhidKauhd+G2CkRTcR5fpsuz+iStB9s5Fks9lKoXnn0hv78VYjvR78C\\n\" +\n-            \"Cvj5FW\/ounHjWTWMb3il9S5ngbFGcelB1l\/MQkR63+1ybdi2OpjNWJCftxOWUpkC\\n\" +\n-            \"xaRdnOnSj7GQY0NLn8Gtq9FcSZydtkVgXpouSFZkXNS\/MYwbcCCcRKBbrk8ss0SI\\n\" +\n-            \"Xg1gTURjh9VP1OHm0OktYcUw9e90wHIDn7h0qA+bWOsZquSRzT4s2crF3ZSA3tuV\\n\" +\n-            \"\/UJ33mjdVO8wBD8aI5y10QreSPJvZHHNDyCmoyjXvNhR+u3arXUoHWxO+MZBeXbi\\n\" +\n-            \"iF7Nwn\/IEmQvWBW8l6D26CXIavcY1kAJcfyzHkrPbLo+fAOa\/KFl3lIU+0biEVNk\\n\" +\n-            \"Q9zXE6hC6X4=\\n\" +\n-            \"-----END CERTIFICATE-----\";\n-\n-    \/\/ Owner: CN=usertrustrsacertificationauthority-ev.comodoca.com, O=Sectigo Limited, STREET=\"3rd Floor,\n-    \/\/ 26 Office Village\", STREET=Exchange Quay, STREET=Trafford Road, L=Salford, ST=Manchester, OID.2.5.4.17=M5 3EQ,\n-    \/\/ C=GB, OID.2.5.4.15=Private Organization, OID.1.3.6.1.4.1.311.60.2.1.3=GB, SERIALNUMBER=04058690\n-    \/\/ Issuer: CN=Sectigo RSA Extended Validation Secure Server CA, O=Sectigo Limited, L=Salford,\n-    \/\/ ST=Greater Manchester, C=GB\n-    \/\/ Serial number: 4e484426dbfed0c222b2ed152465614a\n-    \/\/ Valid from: Mon Mar 01 16:00:00 PST 2021 until: Sat Apr 02 16:59:59 PDT 2022\n-    private static final String VALID = \"-----BEGIN CERTIFICATE-----\\n\" +\n-            \"MIIHTzCCBjegAwIBAgIQTkhEJtv+0MIisu0VJGVhSjANBgkqhkiG9w0BAQsFADCB\\n\" +\n-            \"kTELMAkGA1UEBhMCR0IxGzAZBgNVBAgTEkdyZWF0ZXIgTWFuY2hlc3RlcjEQMA4G\\n\" +\n-            \"A1UEBxMHU2FsZm9yZDEYMBYGA1UEChMPU2VjdGlnbyBMaW1pdGVkMTkwNwYDVQQD\\n\" +\n-            \"EzBTZWN0aWdvIFJTQSBFeHRlbmRlZCBWYWxpZGF0aW9uIFNlY3VyZSBTZXJ2ZXIg\\n\" +\n-            \"Q0EwHhcNMjEwMzAyMDAwMDAwWhcNMjIwNDAyMjM1OTU5WjCCAToxETAPBgNVBAUT\\n\" +\n-            \"CDA0MDU4NjkwMRMwEQYLKwYBBAGCNzwCAQMTAkdCMR0wGwYDVQQPExRQcml2YXRl\\n\" +\n-            \"IE9yZ2FuaXphdGlvbjELMAkGA1UEBhMCR0IxDzANBgNVBBETBk01IDNFUTETMBEG\\n\" +\n-            \"A1UECBMKTWFuY2hlc3RlcjEQMA4GA1UEBxMHU2FsZm9yZDEWMBQGA1UECRMNVHJh\\n\" +\n-            \"ZmZvcmQgUm9hZDEWMBQGA1UECRMNRXhjaGFuZ2UgUXVheTElMCMGA1UECRMcM3Jk\\n\" +\n-            \"IEZsb29yLCAyNiBPZmZpY2UgVmlsbGFnZTEYMBYGA1UEChMPU2VjdGlnbyBMaW1p\\n\" +\n-            \"dGVkMTswOQYDVQQDEzJ1c2VydHJ1c3Ryc2FjZXJ0aWZpY2F0aW9uYXV0aG9yaXR5\\n\" +\n-            \"LWV2LmNvbW9kb2NhLmNvbTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEB\\n\" +\n-            \"AJ4f68XomMKS2uudXi7xp0fkRK4Q1pE2bamXB8PTsuyS9rhC8hD2zPr9Gs+NHAR0\\n\" +\n-            \"tG0GSWW1plzbpDFDEsCG+M+7fDl5cc\/br8RLn75agZeKngv89y6RQUURxHq6N8hi\\n\" +\n-            \"lcJKHtWj9j6u1HYvu4u3lWWXQNbYnMWVqP1AVPZsGyDmKn\/+Mc2ehvPdYSm\/jQLr\\n\" +\n-            \"hH8Rudr12ZfKHTE4Xx7g5ZH0u52TEAWjuNCiXkhAYa\/uUyEu3e7VlsnvxeqBENPn\\n\" +\n-            \"RwYhfT8mdXV6DvGrnv\/NJj\/tBTGE5kRbCh4HumY6I3x\/XC5UeZE6rT+U6oeRgUOM\\n\" +\n-            \"6d7siAQVOspSqfTzR5HsBlECAwEAAaOCAvUwggLxMB8GA1UdIwQYMBaAFCxp\/4DJ\\n\" +\n-            \"h5CuNOG050yThZlA6aeyMB0GA1UdDgQWBBR8+3Lw59S2HtjPs+KZcEJ+67fd\/DAO\\n\" +\n-            \"BgNVHQ8BAf8EBAMCBaAwDAYDVR0TAQH\/BAIwADAdBgNVHSUEFjAUBggrBgEFBQcD\\n\" +\n-            \"AQYIKwYBBQUHAwIwSQYDVR0gBEIwQDA1BgwrBgEEAbIxAQIBBQEwJTAjBggrBgEF\\n\" +\n-            \"BQcCARYXaHR0cHM6Ly9zZWN0aWdvLmNvbS9DUFMwBwYFZ4EMAQEwVgYDVR0fBE8w\\n\" +\n-            \"TTBLoEmgR4ZFaHR0cDovL2NybC5zZWN0aWdvLmNvbS9TZWN0aWdvUlNBRXh0ZW5k\\n\" +\n-            \"ZWRWYWxpZGF0aW9uU2VjdXJlU2VydmVyQ0EuY3JsMIGGBggrBgEFBQcBAQR6MHgw\\n\" +\n-            \"UQYIKwYBBQUHMAKGRWh0dHA6Ly9jcnQuc2VjdGlnby5jb20vU2VjdGlnb1JTQUV4\\n\" +\n-            \"dGVuZGVkVmFsaWRhdGlvblNlY3VyZVNlcnZlckNBLmNydDAjBggrBgEFBQcwAYYX\\n\" +\n-            \"aHR0cDovL29jc3Auc2VjdGlnby5jb20wPQYDVR0RBDYwNIIydXNlcnRydXN0cnNh\\n\" +\n-            \"Y2VydGlmaWNhdGlvbmF1dGhvcml0eS1ldi5jb21vZG9jYS5jb20wggEFBgorBgEE\\n\" +\n-            \"AdZ5AgQCBIH2BIHzAPEAdwBGpVXrdfqRIDC1oolp9PN9ESxBdL79SbiFq\/L8cP5t\\n\" +\n-            \"RwAAAXfyrRCwAAAEAwBIMEYCIQCeOHfnABa6cl0EHTzyMj2t2qBqORBAC16hJIIl\\n\" +\n-            \"Y52W4QIhAKHDk1m9lW0kmcZJWEko3eA9QKJSDLNLpdUoBPzNNc76AHYAb1N2rDHw\\n\" +\n-            \"MRnYmQCkURX\/dxUcEdkCwQApBo2yCJo32RMAAAF38q0R6wAABAMARzBFAiEAywsh\\n\" +\n-            \"8Ki6fFOExwR6de0qzTmf7bJMuQcY0Ry463\/9R44CIDeAcX7Z9S1vlRB9gzVomNIN\\n\" +\n-            \"vkcnUazq7dowPnr5rYMOMA0GCSqGSIb3DQEBCwUAA4IBAQA3a+PBgH1SBVEDpgAN\\n\" +\n-            \"mWaqIQzJzMRfSgvopQ6nC8iD95SfYD\/rvic7aOeBLh\/5aEs\/CknJsg6o0qB3wz1v\\n\" +\n-            \"T5JXd5JldRWw3nP80jkIaYgq97RUIkjcHhuw4hTyQP6wk7XVlPVLvBo9ePWxJjmn\\n\" +\n-            \"whxlSyxQ5A5NdrTqZOJmu9nFr2HXpX75kGwCkUKZI050FAZZydsK3LfMBTqe1Xwi\\n\" +\n-            \"PKyjXDWd40LjOEg31sA43ofO8n2pySP5LG5XAsvoAyPCy3zXhx5cdtmQFLIkntus\\n\" +\n-            \"DCfN+n51HPUo8r4PUhQtOiRUB3K871LTdwyv4\/CRXS2fIhtO1pxYNKFOw0yrUf6j\\n\" +\n-            \"ECgk\\n\" +\n-            \"-----END CERTIFICATE-----\";\n+    public void runTest() throws Exception {\n+        ValidatePathWithURL validatePathWithURL = new ValidatePathWithURL(CA_ALIAS);\n@@ -450,62 +98,2 @@\n-    \/\/ Owner: CN=usertrustrsacertificationauthority-ev.comodoca.com, OU=COMODO EV SGC SSL, O=Sectigo Limited,\n-    \/\/ STREET=\"3rd Floor, 26 Office Village\", STREET=Exchange Quay, STREET=Trafford Road, L=Salford, ST=Manchester,\n-    \/\/ OID.2.5.4.17=M5 3EQ, C=GB, OID.2.5.4.15=Private Organization, OID.1.3.6.1.4.1.311.60.2.1.3=GB, SERIALNUMBER=04058690\n-    \/\/ Issuer: CN=Sectigo RSA Extended Validation Secure Server CA, O=Sectigo Limited, L=Salford,\n-    \/\/ ST=Greater Manchester, C=GB\n-    \/\/ Serial number: b07fd164b5790c9d5d1fddff5819cdb2\n-    \/\/ Valid from: Sun Sep 29 17:00:00 PDT 2019 until: Tue Dec 28 15:59:59 PST 2021\n-    private static final String REVOKED = \"-----BEGIN CERTIFICATE-----\\n\" +\n-            \"MIIH5TCCBs2gAwIBAgIRALB\/0WS1eQydXR\/d\/1gZzbIwDQYJKoZIhvcNAQELBQAw\\n\" +\n-            \"gZExCzAJBgNVBAYTAkdCMRswGQYDVQQIExJHcmVhdGVyIE1hbmNoZXN0ZXIxEDAO\\n\" +\n-            \"BgNVBAcTB1NhbGZvcmQxGDAWBgNVBAoTD1NlY3RpZ28gTGltaXRlZDE5MDcGA1UE\\n\" +\n-            \"AxMwU2VjdGlnbyBSU0EgRXh0ZW5kZWQgVmFsaWRhdGlvbiBTZWN1cmUgU2VydmVy\\n\" +\n-            \"IENBMB4XDTE5MDkzMDAwMDAwMFoXDTIxMTIyODIzNTk1OVowggFWMREwDwYDVQQF\\n\" +\n-            \"EwgwNDA1ODY5MDETMBEGCysGAQQBgjc8AgEDEwJHQjEdMBsGA1UEDxMUUHJpdmF0\\n\" +\n-            \"ZSBPcmdhbml6YXRpb24xCzAJBgNVBAYTAkdCMQ8wDQYDVQQREwZNNSAzRVExEzAR\\n\" +\n-            \"BgNVBAgTCk1hbmNoZXN0ZXIxEDAOBgNVBAcTB1NhbGZvcmQxFjAUBgNVBAkTDVRy\\n\" +\n-            \"YWZmb3JkIFJvYWQxFjAUBgNVBAkTDUV4Y2hhbmdlIFF1YXkxJTAjBgNVBAkTHDNy\\n\" +\n-            \"ZCBGbG9vciwgMjYgT2ZmaWNlIFZpbGxhZ2UxGDAWBgNVBAoTD1NlY3RpZ28gTGlt\\n\" +\n-            \"aXRlZDEaMBgGA1UECxMRQ09NT0RPIEVWIFNHQyBTU0wxOzA5BgNVBAMTMnVzZXJ0\\n\" +\n-            \"cnVzdHJzYWNlcnRpZmljYXRpb25hdXRob3JpdHktZXYuY29tb2RvY2EuY29tMIIB\\n\" +\n-            \"IjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAnh\/rxeiYwpLa651eLvGnR+RE\\n\" +\n-            \"rhDWkTZtqZcHw9Oy7JL2uELyEPbM+v0az40cBHS0bQZJZbWmXNukMUMSwIb4z7t8\\n\" +\n-            \"OXlxz9uvxEufvlqBl4qeC\/z3LpFBRRHEero3yGKVwkoe1aP2Pq7Udi+7i7eVZZdA\\n\" +\n-            \"1ticxZWo\/UBU9mwbIOYqf\/4xzZ6G891hKb+NAuuEfxG52vXZl8odMThfHuDlkfS7\\n\" +\n-            \"nZMQBaO40KJeSEBhr+5TIS7d7tWWye\/F6oEQ0+dHBiF9PyZ1dXoO8aue\/80mP+0F\\n\" +\n-            \"MYTmRFsKHge6ZjojfH9cLlR5kTqtP5Tqh5GBQ4zp3uyIBBU6ylKp9PNHkewGUQID\\n\" +\n-            \"AQABo4IDbjCCA2owHwYDVR0jBBgwFoAULGn\/gMmHkK404bTnTJOFmUDpp7IwHQYD\\n\" +\n-            \"VR0OBBYEFHz7cvDn1LYe2M+z4plwQn7rt938MA4GA1UdDwEB\/wQEAwIFoDAMBgNV\\n\" +\n-            \"HRMBAf8EAjAAMB0GA1UdJQQWMBQGCCsGAQUFBwMBBggrBgEFBQcDAjBJBgNVHSAE\\n\" +\n-            \"QjBAMDUGDCsGAQQBsjEBAgEFATAlMCMGCCsGAQUFBwIBFhdodHRwczovL3NlY3Rp\\n\" +\n-            \"Z28uY29tL0NQUzAHBgVngQwBATBWBgNVHR8ETzBNMEugSaBHhkVodHRwOi8vY3Js\\n\" +\n-            \"LnNlY3RpZ28uY29tL1NlY3RpZ29SU0FFeHRlbmRlZFZhbGlkYXRpb25TZWN1cmVT\\n\" +\n-            \"ZXJ2ZXJDQS5jcmwwgYYGCCsGAQUFBwEBBHoweDBRBggrBgEFBQcwAoZFaHR0cDov\\n\" +\n-            \"L2NydC5zZWN0aWdvLmNvbS9TZWN0aWdvUlNBRXh0ZW5kZWRWYWxpZGF0aW9uU2Vj\\n\" +\n-            \"dXJlU2VydmVyQ0EuY3J0MCMGCCsGAQUFBzABhhdodHRwOi8vb2NzcC5zZWN0aWdv\\n\" +\n-            \"LmNvbTA9BgNVHREENjA0gjJ1c2VydHJ1c3Ryc2FjZXJ0aWZpY2F0aW9uYXV0aG9y\\n\" +\n-            \"aXR5LWV2LmNvbW9kb2NhLmNvbTCCAX4GCisGAQQB1nkCBAIEggFuBIIBagFoAHYA\\n\" +\n-            \"7ku9t3XOYLrhQmkfq+GeZqMPfl+wctiDAMR7iXqo\/csAAAFtgzv54wAABAMARzBF\\n\" +\n-            \"AiB5PmhsK3zU3XdKvyxw\/wWHMmLI7apHLa1yKdjkA8H+ggIhALdUx7Tl8aeWhK6z\\n\" +\n-            \"lh+PHvMAdCcAJK6w9qBJGQtSrYO5AHUAVYHUwhaQNgFK6gubVzxT8MDkOHhwJQgX\\n\" +\n-            \"L6OqHQcT0wwAAAFtgzv5zgAABAMARjBEAiBumSwAUamibqJXTN2cf\/H3mjd0T35\/\\n\" +\n-            \"UK9w2hu9gFobxgIgSXTLndHyqFUmcmquu3It0WC1yl6YMceGixbQL1e8BQcAdwC7\\n\" +\n-            \"2d+8H4pxtZOUI5eqkntHOFeVCqtS6BqQlmQ2jh7RhQAAAW2DO\/nXAAAEAwBIMEYC\\n\" +\n-            \"IQDHRs10oYoXE5yq6WsiksjdQsUWZNpbSsrmz0u+KlxTVQIhAJ4rvHItKSeJLkaN\\n\" +\n-            \"S3YpVZnkN8tOwuxPsYeyVx\/BtaNpMA0GCSqGSIb3DQEBCwUAA4IBAQAPFIsUFymo\\n\" +\n-            \"VTp0vntHrZpBApBQzDeriQv7Bi7tmou\/Ng47RtXW3DjGdrePGSfOdl7h62k8qprU\\n\" +\n-            \"JeLyloDqhvmT\/CG\/hdwrfZ3Sv3N2xpetGcnW5S3oEi3m+\/M1ls9eD+x1vybqV9Kd\\n\" +\n-            \"lcjuV7SYDlbvAS9w7TcygudhdW0cI8XTCvesGKohBkAlqaQ\/MWYpt4WvsxHjbWgn\\n\" +\n-            \"5ZlIYR6A1ZFEjADifViH\/5AA79lgGhAskkIWPjvRFalEVKTKtjhRK76eCfZs4Frr\\n\" +\n-            \"CEOpon+BeNKk+x\/K\/r10dSoWe0SV2uGVxTD83zkP++eREwo1hTgn8bXn7ftlnA3j\\n\" +\n-            \"7ml+Usz6udaD\\n\" +\n-            \"-----END CERTIFICATE-----\";\n-\n-    public void runTest(ValidatePathWithParams pathValidator) throws Exception {\n-        \/\/ Validate valid\n-        pathValidator.validate(new String[]{VALID, INT},\n-                ValidatePathWithParams.Status.GOOD, null, System.out);\n-\n-        \/\/ Validate Revoked\n-        pathValidator.validate(new String[]{REVOKED, INT},\n-                ValidatePathWithParams.Status.REVOKED,\n-                \"Tue Mar 02 02:55:42 PST 2021\", System.out);\n+        validatePathWithURL.validateDomain(VALID, false);\n+        validatePathWithURL.validateDomain(REVOKED, true);\n@@ -516,0 +104,3 @@\n+    private static final String VALID = \"https:\/\/usertrustecccertificationauthority-ev.comodoca.com\";\n+    private static final String REVOKED = \"https:\/\/usertrustecccertificationauthority-ev.comodoca.com:444\";\n+    private static final String CA_ALIAS = \"usertrusteccca [jdk]\";\n@@ -517,120 +108,2 @@\n-    \/\/ Owner: CN=Sectigo ECC Extended Validation Secure Server CA, O=Sectigo Limited, L=Salford,\n-    \/\/ ST=Greater Manchester, C=GB\n-    \/\/ Issuer: CN=USERTrust ECC Certification Authority, O=The USERTRUST Network, L=Jersey City, ST=New Jersey, C=US\n-    \/\/ Serial number: 80f5606d3a162b143adc12fbe8c2066f\n-    \/\/ Valid from: Thu Nov 01 17:00:00 PDT 2018 until: Tue Dec 31 15:59:59 PST 2030\n-    private static final String INT = \"-----BEGIN CERTIFICATE-----\\n\" +\n-            \"MIIDyTCCA0+gAwIBAgIRAID1YG06FisUOtwS++jCBm8wCgYIKoZIzj0EAwMwgYgx\\n\" +\n-            \"CzAJBgNVBAYTAlVTMRMwEQYDVQQIEwpOZXcgSmVyc2V5MRQwEgYDVQQHEwtKZXJz\\n\" +\n-            \"ZXkgQ2l0eTEeMBwGA1UEChMVVGhlIFVTRVJUUlVTVCBOZXR3b3JrMS4wLAYDVQQD\\n\" +\n-            \"EyVVU0VSVHJ1c3QgRUNDIENlcnRpZmljYXRpb24gQXV0aG9yaXR5MB4XDTE4MTEw\\n\" +\n-            \"MjAwMDAwMFoXDTMwMTIzMTIzNTk1OVowgZExCzAJBgNVBAYTAkdCMRswGQYDVQQI\\n\" +\n-            \"ExJHcmVhdGVyIE1hbmNoZXN0ZXIxEDAOBgNVBAcTB1NhbGZvcmQxGDAWBgNVBAoT\\n\" +\n-            \"D1NlY3RpZ28gTGltaXRlZDE5MDcGA1UEAxMwU2VjdGlnbyBFQ0MgRXh0ZW5kZWQg\\n\" +\n-            \"VmFsaWRhdGlvbiBTZWN1cmUgU2VydmVyIENBMFkwEwYHKoZIzj0CAQYIKoZIzj0D\\n\" +\n-            \"AQcDQgAEAyJ5Ca9JyXq8bO+krLVWysbtm7fdMSJ54uFD23t0x6JAC4IjxevfQJzW\\n\" +\n-            \"z4T6yY+FybTBqtOa++ijJFnkB5wKy6OCAY0wggGJMB8GA1UdIwQYMBaAFDrhCYbU\\n\" +\n-            \"zxnClnZ0SXbc4DXGY2OaMB0GA1UdDgQWBBTvwSqVDDLa+3Mw3IoT2BVL9xPo+DAO\\n\" +\n-            \"BgNVHQ8BAf8EBAMCAYYwEgYDVR0TAQH\/BAgwBgEB\/wIBADAdBgNVHSUEFjAUBggr\\n\" +\n-            \"BgEFBQcDAQYIKwYBBQUHAwIwOgYDVR0gBDMwMTAvBgRVHSAAMCcwJQYIKwYBBQUH\\n\" +\n-            \"AgEWGWh0dHBzOi8vY3BzLnVzZXJ0cnVzdC5jb20wUAYDVR0fBEkwRzBFoEOgQYY\/\\n\" +\n-            \"aHR0cDovL2NybC51c2VydHJ1c3QuY29tL1VTRVJUcnVzdEVDQ0NlcnRpZmljYXRp\\n\" +\n-            \"b25BdXRob3JpdHkuY3JsMHYGCCsGAQUFBwEBBGowaDA\/BggrBgEFBQcwAoYzaHR0\\n\" +\n-            \"cDovL2NydC51c2VydHJ1c3QuY29tL1VTRVJUcnVzdEVDQ0FkZFRydXN0Q0EuY3J0\\n\" +\n-            \"MCUGCCsGAQUFBzABhhlodHRwOi8vb2NzcC51c2VydHJ1c3QuY29tMAoGCCqGSM49\\n\" +\n-            \"BAMDA2gAMGUCMQCjHztBDL90GCRXHlGqm0H7kzP04hd0MxwakKjWzOmstXNFLONj\\n\" +\n-            \"RFa0JqI\/iKUJMFcCMCbLgyzcFW7DihtY5XE0XCLCw+git0NjxiFB6FaOFIlyDdqT\\n\" +\n-            \"j+Th+DJ92JLvICVD\/g==\\n\" +\n-            \"-----END CERTIFICATE-----\";\n-\n-    \/\/ Owner: CN=usertrustecccertificationauthority-ev.comodoca.com, O=Sectigo Limited,\n-    \/\/ STREET=\"3rd Floor, 26 Office Village\", STREET=Exchange Quay, STREET=Trafford Road, L=Salford,\n-    \/\/ ST=Manchester, OID.2.5.4.17=M5 3EQ,\n-    \/\/ C=GB, OID.2.5.4.15=Private Organization, OID.1.3.6.1.4.1.311.60.2.1.3=GB, SERIALNUMBER=04058690\n-    \/\/ Issuer: CN=Sectigo ECC Extended Validation Secure Server CA, O=Sectigo Limited, L=Salford,\n-    \/\/ ST=Greater Manchester, C=GB\n-    \/\/ Serial number: 9aa5da67480446fd7bf408fd5fdaa1d8\n-    \/\/ Valid from: Mon Mar 01 16:00:00 PST 2021 until: Sat Apr 02 16:59:59 PDT 2022\n-    private static final String VALID = \"-----BEGIN CERTIFICATE-----\\n\" +\n-            \"MIIFwTCCBWigAwIBAgIRAJql2mdIBEb9e\/QI\/V\/aodgwCgYIKoZIzj0EAwIwgZEx\\n\" +\n-            \"CzAJBgNVBAYTAkdCMRswGQYDVQQIExJHcmVhdGVyIE1hbmNoZXN0ZXIxEDAOBgNV\\n\" +\n-            \"BAcTB1NhbGZvcmQxGDAWBgNVBAoTD1NlY3RpZ28gTGltaXRlZDE5MDcGA1UEAxMw\\n\" +\n-            \"U2VjdGlnbyBFQ0MgRXh0ZW5kZWQgVmFsaWRhdGlvbiBTZWN1cmUgU2VydmVyIENB\\n\" +\n-            \"MB4XDTIxMDMwMjAwMDAwMFoXDTIyMDQwMjIzNTk1OVowggE6MREwDwYDVQQFEwgw\\n\" +\n-            \"NDA1ODY5MDETMBEGCysGAQQBgjc8AgEDEwJHQjEdMBsGA1UEDxMUUHJpdmF0ZSBP\\n\" +\n-            \"cmdhbml6YXRpb24xCzAJBgNVBAYTAkdCMQ8wDQYDVQQREwZNNSAzRVExEzARBgNV\\n\" +\n-            \"BAgTCk1hbmNoZXN0ZXIxEDAOBgNVBAcTB1NhbGZvcmQxFjAUBgNVBAkTDVRyYWZm\\n\" +\n-            \"b3JkIFJvYWQxFjAUBgNVBAkTDUV4Y2hhbmdlIFF1YXkxJTAjBgNVBAkTHDNyZCBG\\n\" +\n-            \"bG9vciwgMjYgT2ZmaWNlIFZpbGxhZ2UxGDAWBgNVBAoTD1NlY3RpZ28gTGltaXRl\\n\" +\n-            \"ZDE7MDkGA1UEAxMydXNlcnRydXN0ZWNjY2VydGlmaWNhdGlvbmF1dGhvcml0eS1l\\n\" +\n-            \"di5jb21vZG9jYS5jb20wWTATBgcqhkjOPQIBBggqhkjOPQMBBwNCAAQtMl8R33Za\\n\" +\n-            \"WD6H8BW0+wybBf0+6+L5YYK\/eyAVGm6vwjLaQZWlcdFBMKfaP1qTLi0VAabs4baS\\n\" +\n-            \"UkD8wR568pVpo4IC8zCCAu8wHwYDVR0jBBgwFoAU78EqlQwy2vtzMNyKE9gVS\/cT\\n\" +\n-            \"6PgwHQYDVR0OBBYEFLOtYfOaIfDHZGubtKNELRR6A2srMA4GA1UdDwEB\/wQEAwIH\\n\" +\n-            \"gDAMBgNVHRMBAf8EAjAAMB0GA1UdJQQWMBQGCCsGAQUFBwMBBggrBgEFBQcDAjBJ\\n\" +\n-            \"BgNVHSAEQjBAMDUGDCsGAQQBsjEBAgEFATAlMCMGCCsGAQUFBwIBFhdodHRwczov\\n\" +\n-            \"L3NlY3RpZ28uY29tL0NQUzAHBgVngQwBATBWBgNVHR8ETzBNMEugSaBHhkVodHRw\\n\" +\n-            \"Oi8vY3JsLnNlY3RpZ28uY29tL1NlY3RpZ29FQ0NFeHRlbmRlZFZhbGlkYXRpb25T\\n\" +\n-            \"ZWN1cmVTZXJ2ZXJDQS5jcmwwgYYGCCsGAQUFBwEBBHoweDBRBggrBgEFBQcwAoZF\\n\" +\n-            \"aHR0cDovL2NydC5zZWN0aWdvLmNvbS9TZWN0aWdvRUNDRXh0ZW5kZWRWYWxpZGF0\\n\" +\n-            \"aW9uU2VjdXJlU2VydmVyQ0EuY3J0MCMGCCsGAQUFBzABhhdodHRwOi8vb2NzcC5z\\n\" +\n-            \"ZWN0aWdvLmNvbTA9BgNVHREENjA0gjJ1c2VydHJ1c3RlY2NjZXJ0aWZpY2F0aW9u\\n\" +\n-            \"YXV0aG9yaXR5LWV2LmNvbW9kb2NhLmNvbTCCAQMGCisGAQQB1nkCBAIEgfQEgfEA\\n\" +\n-            \"7wB2AEalVet1+pEgMLWiiWn0830RLEF0vv1JuIWr8vxw\/m1HAAABd\/Kung0AAAQD\\n\" +\n-            \"AEcwRQIhAI16l52NctGAphhc6eh2kK2vO5QYk5nyouL3P6U\/gG\/dAiBfJRJ+iqE\/\\n\" +\n-            \"noco35RpNtlV4GABrwmw1I\/1R+L79VzwEAB1AG9Tdqwx8DEZ2JkApFEV\/3cVHBHZ\\n\" +\n-            \"AsEAKQaNsgiaN9kTAAABd\/KunvwAAAQDAEYwRAIgS+r3C10ua38DPJKvUJvW5bvL\\n\" +\n-            \"SCQ949n3sBJvhV6aXq4CIH\/oEGgvJmKtMEjVKUQg8TrZO6LwQ+0sYfL79Qvm8wL3\\n\" +\n-            \"MAoGCCqGSM49BAMCA0cAMEQCID4Q9cc8OQ9tmKnnKZyplPsPipI5apVGkBqFRUSt\\n\" +\n-            \"zzM3AiAw5tw3cv\/oabDsYdU+lmp5kZ\/S3Z97ANAAaHE0AfXe\/Q==\\n\" +\n-            \"-----END CERTIFICATE-----\";\n-\n-    \/\/ Owner: CN=usertrustecccertificationauthority-ev.comodoca.com, OU=COMODO EV SGC SSL,\n-    \/\/ O=Sectigo Limited, STREET=\"3rd Floor, 26 Office Village\", STREET=Exchange Quay, STREET=Trafford Road,\n-    \/\/ L=Salford, OID.2.5.4.17=M5 3EQ,\n-    \/\/ C=GB, OID.2.5.4.15=Private Organization, OID.1.3.6.1.4.1.311.60.2.1.3=GB, SERIALNUMBER=04058690\n-    \/\/ Issuer: CN=Sectigo ECC Extended Validation Secure Server CA, O=Sectigo Limited, L=Salford,\n-    \/\/ ST=Greater Manchester, C=GB\n-    \/\/ Serial number: 8b72489b7f505a55e2a22659c90ed2ab\n-    \/\/ Valid from: Sun Sep 29 17:00:00 PDT 2019 until: Tue Dec 28 15:59:59 PST 2021\n-    private static final String REVOKED = \"-----BEGIN CERTIFICATE-----\\n\" +\n-            \"MIIGRTCCBeugAwIBAgIRAItySJt\/UFpV4qImWckO0qswCgYIKoZIzj0EAwIwgZEx\\n\" +\n-            \"CzAJBgNVBAYTAkdCMRswGQYDVQQIExJHcmVhdGVyIE1hbmNoZXN0ZXIxEDAOBgNV\\n\" +\n-            \"BAcTB1NhbGZvcmQxGDAWBgNVBAoTD1NlY3RpZ28gTGltaXRlZDE5MDcGA1UEAxMw\\n\" +\n-            \"U2VjdGlnbyBFQ0MgRXh0ZW5kZWQgVmFsaWRhdGlvbiBTZWN1cmUgU2VydmVyIENB\\n\" +\n-            \"MB4XDTE5MDkzMDAwMDAwMFoXDTIxMTIyODIzNTk1OVowggFBMREwDwYDVQQFEwgw\\n\" +\n-            \"NDA1ODY5MDETMBEGCysGAQQBgjc8AgEDEwJHQjEdMBsGA1UEDxMUUHJpdmF0ZSBP\\n\" +\n-            \"cmdhbml6YXRpb24xCzAJBgNVBAYTAkdCMQ8wDQYDVQQREwZNNSAzRVExEDAOBgNV\\n\" +\n-            \"BAcTB1NhbGZvcmQxFjAUBgNVBAkTDVRyYWZmb3JkIFJvYWQxFjAUBgNVBAkTDUV4\\n\" +\n-            \"Y2hhbmdlIFF1YXkxJTAjBgNVBAkTHDNyZCBGbG9vciwgMjYgT2ZmaWNlIFZpbGxh\\n\" +\n-            \"Z2UxGDAWBgNVBAoTD1NlY3RpZ28gTGltaXRlZDEaMBgGA1UECxMRQ09NT0RPIEVW\\n\" +\n-            \"IFNHQyBTU0wxOzA5BgNVBAMTMnVzZXJ0cnVzdGVjY2NlcnRpZmljYXRpb25hdXRo\\n\" +\n-            \"b3JpdHktZXYuY29tb2RvY2EuY29tMFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAE\\n\" +\n-            \"LTJfEd92Wlg+h\/AVtPsMmwX9Puvi+WGCv3sgFRpur8Iy2kGVpXHRQTCn2j9aky4t\\n\" +\n-            \"FQGm7OG2klJA\/MEeevKVaaOCA28wggNrMB8GA1UdIwQYMBaAFO\/BKpUMMtr7czDc\\n\" +\n-            \"ihPYFUv3E+j4MB0GA1UdDgQWBBSzrWHzmiHwx2Rrm7SjRC0UegNrKzAOBgNVHQ8B\\n\" +\n-            \"Af8EBAMCB4AwDAYDVR0TAQH\/BAIwADAdBgNVHSUEFjAUBggrBgEFBQcDAQYIKwYB\\n\" +\n-            \"BQUHAwIwSQYDVR0gBEIwQDA1BgwrBgEEAbIxAQIBBQEwJTAjBggrBgEFBQcCARYX\\n\" +\n-            \"aHR0cHM6Ly9zZWN0aWdvLmNvbS9DUFMwBwYFZ4EMAQEwVgYDVR0fBE8wTTBLoEmg\\n\" +\n-            \"R4ZFaHR0cDovL2NybC5zZWN0aWdvLmNvbS9TZWN0aWdvRUNDRXh0ZW5kZWRWYWxp\\n\" +\n-            \"ZGF0aW9uU2VjdXJlU2VydmVyQ0EuY3JsMIGGBggrBgEFBQcBAQR6MHgwUQYIKwYB\\n\" +\n-            \"BQUHMAKGRWh0dHA6Ly9jcnQuc2VjdGlnby5jb20vU2VjdGlnb0VDQ0V4dGVuZGVk\\n\" +\n-            \"VmFsaWRhdGlvblNlY3VyZVNlcnZlckNBLmNydDAjBggrBgEFBQcwAYYXaHR0cDov\\n\" +\n-            \"L29jc3Auc2VjdGlnby5jb20wPQYDVR0RBDYwNIIydXNlcnRydXN0ZWNjY2VydGlm\\n\" +\n-            \"aWNhdGlvbmF1dGhvcml0eS1ldi5jb21vZG9jYS5jb20wggF\/BgorBgEEAdZ5AgQC\\n\" +\n-            \"BIIBbwSCAWsBaQB2AO5Lvbd1zmC64UJpH6vhnmajD35fsHLYgwDEe4l6qP3LAAAB\\n\" +\n-            \"bYL\/SJoAAAQDAEcwRQIhAL7EJt\/Rgz6NBnx2v8Hevux3Gpcxy64kaeyLVgFeNqFk\\n\" +\n-            \"AiBRf+OWLOtZzEav\/oERljrk8hgZB4CR1nj\/Tn98cmRrwwB2AFWB1MIWkDYBSuoL\\n\" +\n-            \"m1c8U\/DA5Dh4cCUIFy+jqh0HE9MMAAABbYL\/SIgAAAQDAEcwRQIgVtZZaiBMC2lu\\n\" +\n-            \"atBzUHQmOq4qrUQP7nS83cd3VzPhToECIQDnlpOCdaxJwr8C0MtkvYpKSabwBPFL\\n\" +\n-            \"ASEkwmOpjuQErAB3ALvZ37wfinG1k5Qjl6qSe0c4V5UKq1LoGpCWZDaOHtGFAAAB\\n\" +\n-            \"bYL\/SJoAAAQDAEgwRgIhAI8OgzP\/kzF1bOJRHU2S\/ewij\/6HpGPy7Mbm7Hyuv3IU\\n\" +\n-            \"AiEAxDmX2FmORlgeerQmQ+ar3D9\/TwA9RQckVDu5IrgweREwCgYIKoZIzj0EAwID\\n\" +\n-            \"SAAwRQIhAPwQWGWd3oR7YJ7ngCDQ9TAbdPgND51SiR34WfEgaTQtAiAxD4umKm02\\n\" +\n-            \"59GEMj5NpyF2ZQEq5mEGcjJNojrn+PC4zg==\\n\" +\n-            \"-----END CERTIFICATE-----\";\n-\n-    public void runTest(ValidatePathWithParams pathValidator) throws Exception {\n-        \/\/ Validate valid\n-        pathValidator.validate(new String[]{VALID, INT},\n-                ValidatePathWithParams.Status.GOOD, null, System.out);\n+    public void runTest() throws Exception {\n+        ValidatePathWithURL validatePathWithURL = new ValidatePathWithURL(CA_ALIAS);\n@@ -638,4 +111,2 @@\n-        \/\/ Validate Revoked\n-        pathValidator.validate(new String[]{REVOKED, INT},\n-                ValidatePathWithParams.Status.REVOKED,\n-                \"Tue Mar 02 02:59:25 PST 2021\", System.out);\n+        validatePathWithURL.validateDomain(VALID, false);\n+        validatePathWithURL.validateDomain(REVOKED, true);\n","filename":"test\/jdk\/security\/infra\/java\/security\/cert\/CertPathValidator\/certification\/ComodoCA.java","additions":50,"deletions":579,"binary":false,"changes":629,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2018, 2020, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2018, 2023, Oracle and\/or its affiliates. All rights reserved.\n@@ -25,1 +25,1 @@\n- * @test\n+ * @test id=OCSP\n@@ -28,1 +28,3 @@\n- * @build ValidatePathWithParams\n+ * @library \/test\/lib\n+ * @build jtreg.SkippedException\n+ * @build ValidatePathWithURL\n@@ -30,1 +32,0 @@\n- * @run main\/othervm -Djava.security.debug=certpath EntrustCA CRL\n@@ -34,9 +35,7 @@\n- * Obtain test artifacts for Entrust CA from:\n- *\n- * EC CA:\n- * Valid: https:\/\/validec.entrust.net\n- * Revoked https:\/\/revokedec.entrust.net\n- *\n- * G4 CA:\n- * Valid: https:\/\/validg4.entrust.net\n- * Revoked: https:\/\/revokedg4.entrust.net\n+ * @test id=CRL\n+ * @bug 8195774 8243321\n+ * @summary Interoperability tests with Entrust CAs\n+ * @library \/test\/lib\n+ * @build jtreg.SkippedException\n+ * @build ValidatePathWithURL\n+ * @run main\/othervm -Djava.security.debug=certpath EntrustCA CRL\n@@ -44,0 +43,2 @@\n+\n+import java.security.cert.CertificateEncodingException;\n@@ -48,3 +49,0 @@\n-        ValidatePathWithParams pathValidator = new ValidatePathWithParams(null);\n-        boolean ocspEnabled = false;\n-\n@@ -52,1 +50,1 @@\n-            pathValidator.enableCRLCheck();\n+            ValidatePathWithURL.enableCRLOnly();\n@@ -55,2 +53,1 @@\n-            pathValidator.enableOCSPCheck();\n-            ocspEnabled = true;\n+            ValidatePathWithURL.enableOCSPOnly();\n@@ -59,2 +56,2 @@\n-        new Entrust_ECCA().runTest(pathValidator, ocspEnabled);\n-        new Entrust_G4().runTest(pathValidator, ocspEnabled);\n+        new Entrust_ECCA().runTest();\n+        new Entrust_G4().runTest();\n@@ -65,0 +62,3 @@\n+    private static final String VALID = \"https:\/\/validec.entrust.net\";\n+    private static final String REVOKED = \"https:\/\/revokedec.entrust.net\";\n+    private static final String CA_ALIAS = \"entrustrootcaec1 [jdk]\";\n@@ -66,110 +66,2 @@\n-    \/\/ Owner: CN=Entrust Certification Authority - L1J, OU=\"(c) 2016 Entrust, Inc. - for authorized use only\",\n-    \/\/ OU=See www.entrust.net\/legal-terms, O=\"Entrust, Inc.\", C=US\n-    \/\/ Issuer: CN=Entrust Root Certification Authority - EC1, OU=\"(c) 2012 Entrust, Inc. - for authorized use only\",\n-    \/\/ OU=See www.entrust.net\/legal-terms, O=\"Entrust, Inc.\", C=US\n-    private static final String INT = \"-----BEGIN CERTIFICATE-----\\n\" +\n-            \"MIID5zCCA2ygAwIBAgIQCoPUgD5+n1EAAAAAUdTB9zAKBggqhkjOPQQDAzCBvzEL\\n\" +\n-            \"MAkGA1UEBhMCVVMxFjAUBgNVBAoTDUVudHJ1c3QsIEluYy4xKDAmBgNVBAsTH1Nl\\n\" +\n-            \"ZSB3d3cuZW50cnVzdC5uZXQvbGVnYWwtdGVybXMxOTA3BgNVBAsTMChjKSAyMDEy\\n\" +\n-            \"IEVudHJ1c3QsIEluYy4gLSBmb3IgYXV0aG9yaXplZCB1c2Ugb25seTEzMDEGA1UE\\n\" +\n-            \"AxMqRW50cnVzdCBSb290IENlcnRpZmljYXRpb24gQXV0aG9yaXR5IC0gRUMxMB4X\\n\" +\n-            \"DTE2MDQwNTIwMTk1NFoXDTM3MTAwNTIwNDk1NFowgboxCzAJBgNVBAYTAlVTMRYw\\n\" +\n-            \"FAYDVQQKEw1FbnRydXN0LCBJbmMuMSgwJgYDVQQLEx9TZWUgd3d3LmVudHJ1c3Qu\\n\" +\n-            \"bmV0L2xlZ2FsLXRlcm1zMTkwNwYDVQQLEzAoYykgMjAxNiBFbnRydXN0LCBJbmMu\\n\" +\n-            \"IC0gZm9yIGF1dGhvcml6ZWQgdXNlIG9ubHkxLjAsBgNVBAMTJUVudHJ1c3QgQ2Vy\\n\" +\n-            \"dGlmaWNhdGlvbiBBdXRob3JpdHkgLSBMMUowdjAQBgcqhkjOPQIBBgUrgQQAIgNi\\n\" +\n-            \"AAT14eFXmpQX\/dEf7NAxrMH13n0btz1KKvH2S1rROGPAKex2CY8yxznbffK\/MbCk\\n\" +\n-            \"F7ByYXGs1+8kL5xmTysU\/c+YmjOZx2mMSAk2DPw30fijJ3tRrwChZ+TBpgtB6+A5\\n\" +\n-            \"MsCjggEuMIIBKjAOBgNVHQ8BAf8EBAMCAQYwEgYDVR0TAQH\/BAgwBgEB\/wIBADAz\\n\" +\n-            \"BggrBgEFBQcBAQQnMCUwIwYIKwYBBQUHMAGGF2h0dHA6Ly9vY3NwLmVudHJ1c3Qu\\n\" +\n-            \"bmV0MDMGA1UdHwQsMCowKKAmoCSGImh0dHA6Ly9jcmwuZW50cnVzdC5uZXQvZWMx\\n\" +\n-            \"cm9vdC5jcmwwOwYDVR0gBDQwMjAwBgRVHSAAMCgwJgYIKwYBBQUHAgEWGmh0dHA6\\n\" +\n-            \"Ly93d3cuZW50cnVzdC5uZXQvcnBhMB0GA1UdJQQWMBQGCCsGAQUFBwMBBggrBgEF\\n\" +\n-            \"BQcDAjAdBgNVHQ4EFgQUw\/lFA77I+Qs8RTXz63Ls5+jrlJswHwYDVR0jBBgwFoAU\\n\" +\n-            \"t2PnGt2N6QimVYOk4GpQQWURQkkwCgYIKoZIzj0EAwMDaQAwZgIxAPnVAOqxKDd7\\n\" +\n-            \"v37EBmpPqWCCWBFPKW6HpRx3GUWc9caeQIw8rO2HXYgf92pb\/TsJYAIxAJhI0MpR\\n\" +\n-            \"z5L42xF1R9UIPfQxCMwgsnWBqIqcfMrMO+2DxQy6GIP3cFFj9gRyxguKWw==\\n\" +\n-            \"-----END CERTIFICATE-----\";\n-\n-    \/\/ Owner: CN=validec.entrust.net, SERIALNUMBER=D15576572, OID.2.5.4.15=Private Organization, O=\"Entrust, Inc.\",\n-    \/\/ OID.1.3.6.1.4.1.311.60.2.1.2=Maryland, OID.1.3.6.1.4.1.311.60.2.1.3=US, L=Kanata, ST=Ontario, C=CA\n-    \/\/ Issuer: CN=Entrust Certification Authority - L1J, OU=\"(c) 2016 Entrust, Inc. - for authorized use only\",\n-    \/\/ OU=See www.entrust.net\/legal-terms, O=\"Entrust, Inc.\", C=US\n-    private static final String VALID = \"-----BEGIN CERTIFICATE-----\\n\" +\n-            \"MIIFrTCCBTKgAwIBAgIQYtgW4DLwh74AAAAAVqBXkTAKBggqhkjOPQQDAjCBujEL\\n\" +\n-            \"MAkGA1UEBhMCVVMxFjAUBgNVBAoTDUVudHJ1c3QsIEluYy4xKDAmBgNVBAsTH1Nl\\n\" +\n-            \"ZSB3d3cuZW50cnVzdC5uZXQvbGVnYWwtdGVybXMxOTA3BgNVBAsTMChjKSAyMDE2\\n\" +\n-            \"IEVudHJ1c3QsIEluYy4gLSBmb3IgYXV0aG9yaXplZCB1c2Ugb25seTEuMCwGA1UE\\n\" +\n-            \"AxMlRW50cnVzdCBDZXJ0aWZpY2F0aW9uIEF1dGhvcml0eSAtIEwxSjAeFw0xODA2\\n\" +\n-            \"MjUxMzE1NTdaFw0xOTA2MjUxMzQ1NTBaMIHJMQswCQYDVQQGEwJDQTEQMA4GA1UE\\n\" +\n-            \"CBMHT250YXJpbzEPMA0GA1UEBxMGS2FuYXRhMRMwEQYLKwYBBAGCNzwCAQMTAlVT\\n\" +\n-            \"MRkwFwYLKwYBBAGCNzwCAQITCE1hcnlsYW5kMRYwFAYDVQQKEw1FbnRydXN0LCBJ\\n\" +\n-            \"bmMuMR0wGwYDVQQPExRQcml2YXRlIE9yZ2FuaXphdGlvbjESMBAGA1UEBRMJRDE1\\n\" +\n-            \"NTc2NTcyMRwwGgYDVQQDExN2YWxpZGVjLmVudHJ1c3QubmV0MFkwEwYHKoZIzj0C\\n\" +\n-            \"AQYIKoZIzj0DAQcDQgAEHQe7lUaAUgIwR9EiLJlhkbx+HfSr22M3JvQD6+fnYgqd\\n\" +\n-            \"55e6E1UE45fk92UpqPi1CEbXrdpmWKu1Z470B9cPGaOCAwcwggMDMB4GA1UdEQQX\\n\" +\n-            \"MBWCE3ZhbGlkZWMuZW50cnVzdC5uZXQwggF\/BgorBgEEAdZ5AgQCBIIBbwSCAWsB\\n\" +\n-            \"aQB1AFWB1MIWkDYBSuoLm1c8U\/DA5Dh4cCUIFy+jqh0HE9MMAAABZDcxpMkAAAQD\\n\" +\n-            \"AEYwRAIgIb0PwjCcNOchJg8Zywz\/0Lwm2vEOJUSao6BqNUIsyaYCIElHHexB06LE\\n\" +\n-            \"yXWDXO7UqOtWT6uqkdJN8V4TzwT9B4o4AHcA3esdK3oNT6Ygi4GtgWhwfi6OnQHV\\n\" +\n-            \"XIiNPRHEzbbsvswAAAFkNzGkvgAABAMASDBGAiEAlxy\/kxB9waIifYn+EV550pvA\\n\" +\n-            \"C3jUfS\/bjsKbcsBH9cQCIQDSHTJORz6fZu8uLFhpV525pw7iHVh2dSn3gpcteObh\\n\" +\n-            \"DQB3ALvZ37wfinG1k5Qjl6qSe0c4V5UKq1LoGpCWZDaOHtGFAAABZDcxpTsAAAQD\\n\" +\n-            \"AEgwRgIhAPCBqVqSvAEIXMPloV0tfBEEdjRrAhiG407cPqYwt9AFAiEAuQf4R5os\\n\" +\n-            \"MLkD3XhxvrTDvnD+PUOf8PzPevsWkuxNqcQwDgYDVR0PAQH\/BAQDAgeAMB0GA1Ud\\n\" +\n-            \"JQQWMBQGCCsGAQUFBwMBBggrBgEFBQcDAjBjBggrBgEFBQcBAQRXMFUwIwYIKwYB\\n\" +\n-            \"BQUHMAGGF2h0dHA6Ly9vY3NwLmVudHJ1c3QubmV0MC4GCCsGAQUFBzAChiJodHRw\\n\" +\n-            \"Oi8vYWlhLmVudHJ1c3QubmV0L2wxai1lYzEuY2VyMDMGA1UdHwQsMCowKKAmoCSG\\n\" +\n-            \"Imh0dHA6Ly9jcmwuZW50cnVzdC5uZXQvbGV2ZWwxai5jcmwwSgYDVR0gBEMwQTA2\\n\" +\n-            \"BgpghkgBhvpsCgECMCgwJgYIKwYBBQUHAgEWGmh0dHA6Ly93d3cuZW50cnVzdC5u\\n\" +\n-            \"ZXQvcnBhMAcGBWeBDAEBMB8GA1UdIwQYMBaAFMP5RQO+yPkLPEU18+ty7Ofo65Sb\\n\" +\n-            \"MB0GA1UdDgQWBBT+J7OhS6gskCanmOGnx10DPSF8ATAJBgNVHRMEAjAAMAoGCCqG\\n\" +\n-            \"SM49BAMCA2kAMGYCMQCQLUQABT74TmdHzAtB97uNF5+Zy15wzkmlKeRSOXCIf2C5\\n\" +\n-            \"YKjsgdkR1OdzZXcpjNgCMQDfWcdPhodNXZC4l1lLPOPaTzPPw6uVqqoITQlc6r1t\\n\" +\n-            \"dRkkD6K9ii\/X8EtwoFp7s80=\\n\" +\n-            \"-----END CERTIFICATE-----\";\n-\n-    \/\/ Owner: CN=revokedec.entrust.net, SERIALNUMBER=115868500, OID.2.5.4.15=Private Organization, O=\"Entrust, Inc.\",\n-    \/\/ OID.1.3.6.1.4.1.311.60.2.1.2=Texas, OID.1.3.6.1.4.1.311.60.2.1.3=US, L=Kanata, ST=Ontario, C=CA\n-    \/\/ Issuer: CN=Entrust Certification Authority - L1J, OU=\"(c) 2016 Entrust, Inc. - for authorized use only\",\n-    \/\/ OU=See www.entrust.net\/legal-terms, O=\"Entrust, Inc.\", C=US\n-    private static final String REVOKED = \"-----BEGIN CERTIFICATE-----\\n\" +\n-            \"MIIGJzCCBaygAwIBAgIRAM0WDfag1taIAAAAAFagJ5gwCgYIKoZIzj0EAwIwgbox\\n\" +\n-            \"CzAJBgNVBAYTAlVTMRYwFAYDVQQKEw1FbnRydXN0LCBJbmMuMSgwJgYDVQQLEx9T\\n\" +\n-            \"ZWUgd3d3LmVudHJ1c3QubmV0L2xlZ2FsLXRlcm1zMTkwNwYDVQQLEzAoYykgMjAx\\n\" +\n-            \"NiBFbnRydXN0LCBJbmMuIC0gZm9yIGF1dGhvcml6ZWQgdXNlIG9ubHkxLjAsBgNV\\n\" +\n-            \"BAMTJUVudHJ1c3QgQ2VydGlmaWNhdGlvbiBBdXRob3JpdHkgLSBMMUowHhcNMTcw\\n\" +\n-            \"NTI0MTcwNzA4WhcNMTkwNTI0MTczNjU1WjCByDELMAkGA1UEBhMCQ0ExEDAOBgNV\\n\" +\n-            \"BAgTB09udGFyaW8xDzANBgNVBAcTBkthbmF0YTETMBEGCysGAQQBgjc8AgEDEwJV\\n\" +\n-            \"UzEWMBQGCysGAQQBgjc8AgECEwVUZXhhczEWMBQGA1UEChMNRW50cnVzdCwgSW5j\\n\" +\n-            \"LjEdMBsGA1UEDxMUUHJpdmF0ZSBPcmdhbml6YXRpb24xEjAQBgNVBAUTCTExNTg2\\n\" +\n-            \"ODUwMDEeMBwGA1UEAxMVcmV2b2tlZGVjLmVudHJ1c3QubmV0MFkwEwYHKoZIzj0C\\n\" +\n-            \"AQYIKoZIzj0DAQcDQgAEN5MP\/59yrs9uwVM\/Mrc8IuHonMChAZgN2twwvh8KTnR2\\n\" +\n-            \"3stfem\/R+NtLccq+4ds1+8ktnXgP7u1x0as6IJOH1qOCA4EwggN9MCAGA1UdEQQZ\\n\" +\n-            \"MBeCFXJldm9rZWRlYy5lbnRydXN0Lm5ldDCCAfcGCisGAQQB1nkCBAIEggHnBIIB\\n\" +\n-            \"4wHhAHYA7ku9t3XOYLrhQmkfq+GeZqMPfl+wctiDAMR7iXqo\/csAAAFcO4iiogAA\\n\" +\n-            \"BAMARzBFAiAgHVpryyNVgnsUIihu+5DC2\/vuP8Cy5iXq8NhCBXg8UgIhAKi5jImT\\n\" +\n-            \"f1FJksvHboc0EZh9TWhWljVZ6E5jB2CL+qzeAHcAVhQGmi\/XwuzT9eG9RLI+x0Z2\\n\" +\n-            \"ubyZEVzA75SYVdaJ0N0AAAFcO4ij9QAABAMASDBGAiEA4B2p2726ISSkKC9WVlzj\\n\" +\n-            \"BVwYZ1Hr7mTjPrFqkoGpEHYCIQC5iuInkJXGBANLTH06BHIQkkr4KnFRl9QBOSw4\\n\" +\n-            \"b+kNqgB1AN3rHSt6DU+mIIuBrYFocH4ujp0B1VyIjT0RxM227L7MAAABXDuIpkcA\\n\" +\n-            \"AAQDAEYwRAIgQ9ssw19wIhHWW6IWgwnIyB7e30HacBNX6S1eQ3GUX04CICffGj3A\\n\" +\n-            \"WWmK9lixmk35YklMnSXNqHQezSYRiCYtXxejAHcApLkJkLQYWBSHuxOizGdwCjw1\\n\" +\n-            \"mAT5G9+443fNDsgN3BAAAAFcO4inUwAABAMASDBGAiEA+8T9tpPw\/mU\/STsNv0oz\\n\" +\n-            \"8Nla21fKlpEOyWqDKWPSUeYCIQCwI5tDyyaJtyFY9\/OVqLG+BKPKjscUtTqGJYl4\\n\" +\n-            \"XbOo1jAOBgNVHQ8BAf8EBAMCB4AwHQYDVR0lBBYwFAYIKwYBBQUHAwEGCCsGAQUF\\n\" +\n-            \"BwMCMGMGCCsGAQUFBwEBBFcwVTAjBggrBgEFBQcwAYYXaHR0cDovL29jc3AuZW50\\n\" +\n-            \"cnVzdC5uZXQwLgYIKwYBBQUHMAKGImh0dHA6Ly9haWEuZW50cnVzdC5uZXQvbDFq\\n\" +\n-            \"LWVjMS5jZXIwMwYDVR0fBCwwKjAooCagJIYiaHR0cDovL2NybC5lbnRydXN0Lm5l\\n\" +\n-            \"dC9sZXZlbDFqLmNybDBKBgNVHSAEQzBBMDYGCmCGSAGG+mwKAQIwKDAmBggrBgEF\\n\" +\n-            \"BQcCARYaaHR0cDovL3d3dy5lbnRydXN0Lm5ldC9ycGEwBwYFZ4EMAQEwHwYDVR0j\\n\" +\n-            \"BBgwFoAUw\/lFA77I+Qs8RTXz63Ls5+jrlJswHQYDVR0OBBYEFIj28ytR8ulo1p2t\\n\" +\n-            \"ZnBQOLK0rlLUMAkGA1UdEwQCMAAwCgYIKoZIzj0EAwIDaQAwZgIxANzqGRI0en5P\\n\" +\n-            \"gSUDcdwoQSNKrBPBfGz2AQVLHAXsxvIlGhKZAQtM49zxA8AdFy\/agwIxAMEjJH6A\\n\" +\n-            \"4UbcGZc40eYu6wUbAxiUDD3gwSElNQ8Z6IhNLPCCdMM6KZORyaagAcXn4A==\\n\" +\n-            \"-----END CERTIFICATE-----\";\n-\n-    public void runTest(ValidatePathWithParams pathValidator, boolean ocspEnabled) throws Exception {\n-        \/\/ Validate valid\n-        pathValidator.validate(new String[]{VALID, INT},\n-                ValidatePathWithParams.Status.GOOD, null, System.out);\n+    public void runTest() throws Exception {\n+        ValidatePathWithURL validatePathWithURL = new ValidatePathWithURL(CA_ALIAS);\n@@ -177,4 +69,2 @@\n-        \/\/ Validate Revoked\n-        pathValidator.validate(new String[]{REVOKED, INT},\n-                ValidatePathWithParams.Status.REVOKED,\n-                \"Wed May 24 10:39:28 PDT 2017\", System.out);\n+        validatePathWithURL.validateDomain(VALID, false);\n+        validatePathWithURL.validateDomain(REVOKED, true);\n@@ -185,0 +75,3 @@\n+    private static final String VALID = \"https:\/\/validg4.entrust.net\";\n+    private static final String REVOKED = \"https:\/\/revokedg4.entrust.net\";\n+    private static final String CA_ALIAS = \"entrustrootcag4 [jdk]\";\n@@ -186,127 +79,2 @@\n-    \/\/ Owner: CN=Entrust Certification Authority - L1N, OU=\"(c) 2014 Entrust, Inc. - for authorized use only\",\n-    \/\/ OU=See www.entrust.net\/legal-terms, O=\"Entrust, Inc.\", C=US\n-    \/\/ Issuer: CN=Entrust Root Certification Authority - G4, OU=\"(c) 2015 Entrust, Inc. - for authorized use only\",\n-    \/\/ OU=See www.entrust.net\/legal-terms, O=\"Entrust, Inc.\", C=US\n-    private static final String INT = \"-----BEGIN CERTIFICATE-----\\n\" +\n-            \"MIIGMjCCBBqgAwIBAgIRAKvsd\/8bQQwHAAAAAFVl2AUwDQYJKoZIhvcNAQELBQAw\\n\" +\n-            \"gb4xCzAJBgNVBAYTAlVTMRYwFAYDVQQKEw1FbnRydXN0LCBJbmMuMSgwJgYDVQQL\\n\" +\n-            \"Ex9TZWUgd3d3LmVudHJ1c3QubmV0L2xlZ2FsLXRlcm1zMTkwNwYDVQQLEzAoYykg\\n\" +\n-            \"MjAxNSBFbnRydXN0LCBJbmMuIC0gZm9yIGF1dGhvcml6ZWQgdXNlIG9ubHkxMjAw\\n\" +\n-            \"BgNVBAMTKUVudHJ1c3QgUm9vdCBDZXJ0aWZpY2F0aW9uIEF1dGhvcml0eSAtIEc0\\n\" +\n-            \"MB4XDTE3MTEyMjIwMDQyMFoXDTMwMTIyMjIwMzQyMFowgboxCzAJBgNVBAYTAlVT\\n\" +\n-            \"MRYwFAYDVQQKEw1FbnRydXN0LCBJbmMuMSgwJgYDVQQLEx9TZWUgd3d3LmVudHJ1\\n\" +\n-            \"c3QubmV0L2xlZ2FsLXRlcm1zMTkwNwYDVQQLEzAoYykgMjAxNCBFbnRydXN0LCBJ\\n\" +\n-            \"bmMuIC0gZm9yIGF1dGhvcml6ZWQgdXNlIG9ubHkxLjAsBgNVBAMTJUVudHJ1c3Qg\\n\" +\n-            \"Q2VydGlmaWNhdGlvbiBBdXRob3JpdHkgLSBMMU4wggEiMA0GCSqGSIb3DQEBAQUA\\n\" +\n-            \"A4IBDwAwggEKAoIBAQDcSG+caYQ4xcvf+dt8bgCEHorO0g5j0H1NOtQzRXgUoG8y\\n\" +\n-            \"QuRbJX9swyKqQZbsc18YvTV8OKA\/uSNE46Jvq47TFPojWWTVLbNDqpM07e4EFYKs\\n\" +\n-            \"A9NFzAUngijnf3ivnXA6iNPAMXaEhXmhY\/YFjk8NoM7Y1PFsA0oj5hamKQ06iO\/j\\n\" +\n-            \"gvBScLmnQ1ju9Qj9IGIg18UL5AJNw0frspLUQBYVrLGaqAy5Nl2BUJKaZ4vnSLvP\\n\" +\n-            \"nk6YrB15mo1phHae10Ba4fx7R3z8IZ\/hby4OXTy\/KZpu107VEQPAwTuDK8ZXxB5y\\n\" +\n-            \"0DSzi4vaw27aLrUsq4aFqUo03gEfC31vWW76TNkFAgMBAAGjggErMIIBJzAOBgNV\\n\" +\n-            \"HQ8BAf8EBAMCAQYwEgYDVR0TAQH\/BAgwBgEB\/wIBADAdBgNVHSUEFjAUBggrBgEF\\n\" +\n-            \"BQcDAQYIKwYBBQUHAwIwOwYDVR0gBDQwMjAwBgRVHSAAMCgwJgYIKwYBBQUHAgEW\\n\" +\n-            \"Gmh0dHA6Ly93d3cuZW50cnVzdC5uZXQvcnBhMDMGCCsGAQUFBwEBBCcwJTAjBggr\\n\" +\n-            \"BgEFBQcwAYYXaHR0cDovL29jc3AuZW50cnVzdC5uZXQwMAYDVR0fBCkwJzAloCOg\\n\" +\n-            \"IYYfaHR0cDovL2NybC5lbnRydXN0Lm5ldC9nNGNhLmNybDAdBgNVHQ4EFgQU7kfR\\n\" +\n-            \"hXHx\/S23P7s+Y1h3F0lADpUwHwYDVR0jBBgwFoAUnzjEViPDOeigcWzoVEzk6Dqx\\n\" +\n-            \"v2cwDQYJKoZIhvcNAQELBQADggIBACMeFFgsWmC7h6D1v8DJUkOpm\/m5UhVhO0hb\\n\" +\n-            \"pQMQKMhKkl744Y9SWG4WNmpQy743TTciEJPZFhc7ke2R6VmK8ZJUqro2awOw1RWZ\\n\" +\n-            \"OtHla59Btf1NQd41vOVdU+qFhs8lFfXg9sK7YHTrfxHtMXLoGnkkamK3xJgn7sXa\\n\" +\n-            \"\/zUvUDBTpDCXcpO9SyHoKIQswmkIPpRyIdPF4biRdR3N+9MYmlfqN\/Nk3OEZ73xZ\\n\" +\n-            \"AUZP6Gu+f9cEiHTA8NdYHCPLJWyFnIHWK+QuTFEnKYnOYxCeroLBNOO64e8JWZ39\\n\" +\n-            \"kZ22BBXhHzqOCCczS7JOJTRF+JgvWuxbFwRstj8qf3fE+JndWmq2FC4hTHtpuK5K\\n\" +\n-            \"ENuiRm5gdkXfsXmB+qB6y5gaajiTIMscGIcZIKTe2YdKrLoicvEz8k+loM7favik\\n\" +\n-            \"vzFioTNTDHYGx3mkfElBE7ycY8n+jZE3QBBv33k28MeQi7XNgEaMc4tYwoZIdE9A\\n\" +\n-            \"xVccXTzEQzka82dOkRB1dU0XZId9XAWv+CtNc2TjF6Wgx2seA\/c6H8S0IfgQBIV2\\n\" +\n-            \"8iN2wZns2QFdawkdy3hMUqPnA++kuGhLW3GemsIY5dP\/WxY8rd+OfLb\/Ks9T1pCd\\n\" +\n-            \"28t7PQRcQsgkYmouzrOW9ASBvYqLLdhl4y+fFXff8RkPIKMNoYP06WJvRKmky9R\/\\n\" +\n-            \"41\/nXRas\\n\" +\n-            \"-----END CERTIFICATE-----\";\n-\n-    \/\/ Owner: CN=validg4.entrust.net, SERIALNUMBER=1913605, OID.2.5.4.15=Private Organization,\n-    \/\/ O=Entrust Datacard Limited, OID.1.3.6.1.4.1.311.60.2.1.2=Ontario, OID.1.3.6.1.4.1.311.60.2.1.3=CA,\n-    \/\/ L=Ottawa, ST=Ontario, C=CA\n-    \/\/ Issuer: CN=Entrust Certification Authority - L1N, OU=\"(c) 2014 Entrust, Inc. - for authorized use only\",\n-    \/\/ OU=See www.entrust.net\/legal-terms, O=\"Entrust, Inc.\", C=US\n-    \/\/ Serial number: 83790beb78eeb966007ad3dbf11d570\n-    \/\/ Valid from: Fri May 29 13:29:00 PDT 2020 until: Sun Aug 28 13:34:23 PDT 2022\n-    private static final String VALID = \"-----BEGIN CERTIFICATE-----\\n\" +\n-            \"MIIFpjCCBI6gAwIBAgIQCDeQvreO65ZgB609vxHVcDANBgkqhkiG9w0BAQsFADCB\\n\" +\n-            \"ujELMAkGA1UEBhMCVVMxFjAUBgNVBAoTDUVudHJ1c3QsIEluYy4xKDAmBgNVBAsT\\n\" +\n-            \"H1NlZSB3d3cuZW50cnVzdC5uZXQvbGVnYWwtdGVybXMxOTA3BgNVBAsTMChjKSAy\\n\" +\n-            \"MDE0IEVudHJ1c3QsIEluYy4gLSBmb3IgYXV0aG9yaXplZCB1c2Ugb25seTEuMCwG\\n\" +\n-            \"A1UEAxMlRW50cnVzdCBDZXJ0aWZpY2F0aW9uIEF1dGhvcml0eSAtIEwxTjAeFw0y\\n\" +\n-            \"MDA1MjkyMDI5MDBaFw0yMjA4MjgyMDM0MjNaMIHRMQswCQYDVQQGEwJDQTEQMA4G\\n\" +\n-            \"A1UECBMHT250YXJpbzEPMA0GA1UEBxMGT3R0YXdhMRMwEQYLKwYBBAGCNzwCAQMT\\n\" +\n-            \"AkNBMRgwFgYLKwYBBAGCNzwCAQITB09udGFyaW8xITAfBgNVBAoTGEVudHJ1c3Qg\\n\" +\n-            \"RGF0YWNhcmQgTGltaXRlZDEdMBsGA1UEDxMUUHJpdmF0ZSBPcmdhbml6YXRpb24x\\n\" +\n-            \"EDAOBgNVBAUTBzE5MTM2MDUxHDAaBgNVBAMTE3ZhbGlkZzQuZW50cnVzdC5uZXQw\\n\" +\n-            \"ggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQC508f77Kp\/kfbqs9DHfa+V\\n\" +\n-            \"977gsVzI78TzfN4tF3ujwnPgd9mzLArM71VJvceOJUto7ywRasxmFxOLHf7WN2Kg\\n\" +\n-            \"U1yk\/Kp9WUNfjmjIkI+JfCTkaz1RztpW85GNN9SL\/W2yFIxv0ijAiGoQeC7J80Ni\\n\" +\n-            \"+y31Q5+M0oPMzngBOtD8LpyVt+\/lSwUvxwhlChu7LWpIFmBUriILkvh11vxaItZV\\n\" +\n-            \"Jm4g8amE33\/eXPFjZxB4ABQpBMC4QVg10UP+DpimZuJa6oQZfoNUjDF2yKlyrA+z\\n\" +\n-            \"s3kK8SXzJhE5LQxBp158jAoCVZuER08cumw3wvXI5NGzkzDxpTGacDO0bDo2ULpN\\n\" +\n-            \"AgMBAAGjggGNMIIBiTAOBgNVHQ8BAf8EBAMCBaAwHQYDVR0lBBYwFAYIKwYBBQUH\\n\" +\n-            \"AwIGCCsGAQUFBwMBMAwGA1UdEwEB\/wQCMAAwHQYDVR0OBBYEFOA38RC6Sv6hMUgY\\n\" +\n-            \"eLACjvqO13vsMB8GA1UdIwQYMBaAFO5H0YVx8f0ttz+7PmNYdxdJQA6VMGgGCCsG\\n\" +\n-            \"AQUFBwEBBFwwWjAjBggrBgEFBQcwAYYXaHR0cDovL29jc3AuZW50cnVzdC5uZXQw\\n\" +\n-            \"MwYIKwYBBQUHMAKGJ2h0dHA6Ly9haWEuZW50cnVzdC5uZXQvbDFuLWNoYWluMjU2\\n\" +\n-            \"LmNlcjAzBgNVHR8ELDAqMCigJqAkhiJodHRwOi8vY3JsLmVudHJ1c3QubmV0L2xl\\n\" +\n-            \"dmVsMW4uY3JsMB4GA1UdEQQXMBWCE3ZhbGlkZzQuZW50cnVzdC5uZXQwSwYDVR0g\\n\" +\n-            \"BEQwQjA3BgpghkgBhvpsCgECMCkwJwYIKwYBBQUHAgEWG2h0dHBzOi8vd3d3LmVu\\n\" +\n-            \"dHJ1c3QubmV0L3JwYTAHBgVngQwBATANBgkqhkiG9w0BAQsFAAOCAQEAOExxxxEk\\n\" +\n-            \"iAZZ4RJSWwI\/CBQYAlUmd2wb\/SBk9eYNAu\/UL0XiAbwbOjH2dV6JHwAdwn0eoPR1\\n\" +\n-            \"KK\/E1\/OVoVibVBdxLMISPqdodRgHps6kGCOJxS8Zz8d3AEvx27EQ\/Hg\/EwIJZsUK\\n\" +\n-            \"dyb48V6a3XzExqLiwGu9oI9Ozm3\/mo11ixmhvSFXH+FZf93qvvCSO+XTGGrLv5ja\\n\" +\n-            \"Tkazn\/HgnwUBHd1TiO0jLhAdc+rZyd\/SDjXMAXsa99zVfc2MY0Mb8+MohNHOwqYg\\n\" +\n-            \"tuYuirvtt9P0oteauL+iEBCRcqsmJaHGeaEyJH2QMxC5W22KpW245eHisW7rMoGQ\\n\" +\n-            \"9nbGmfe97p7bHQ==\\n\" +\n-            \"-----END CERTIFICATE-----\";\n-\n-    \/\/ Owner: CN=revokedg4.entrust.net, SERIALNUMBER=1913605, OID.2.5.4.15=Private Organization,\n-    \/\/ O=Entrust Datacard Limited, OID.1.3.6.1.4.1.311.60.2.1.2=Ontario, OID.1.3.6.1.4.1.311.60.2.1.3=CA,\n-    \/\/ L=Ottawa, ST=Ontario, C=CA\n-    \/\/ Issuer: CN=Entrust Certification Authority - L1N, OU=\"(c) 2014 Entrust, Inc. - for authorized use only\",\n-    \/\/ OU=See www.entrust.net\/legal-terms, O=\"Entrust, Inc.\", C=US\n-    \/\/ Serial number: 24c5f46412b9dcc242a93017176979d6\n-    \/\/ Valid from: Fri May 29 13:36:00 PDT 2020 until: Sun Aug 28 13:40:43 PDT 2022\n-    private static final String REVOKED = \"-----BEGIN CERTIFICATE-----\\n\" +\n-            \"MIIFqjCCBJKgAwIBAgIQJMX0ZBK53MJCqTAXF2l51jANBgkqhkiG9w0BAQsFADCB\\n\" +\n-            \"ujELMAkGA1UEBhMCVVMxFjAUBgNVBAoTDUVudHJ1c3QsIEluYy4xKDAmBgNVBAsT\\n\" +\n-            \"H1NlZSB3d3cuZW50cnVzdC5uZXQvbGVnYWwtdGVybXMxOTA3BgNVBAsTMChjKSAy\\n\" +\n-            \"MDE0IEVudHJ1c3QsIEluYy4gLSBmb3IgYXV0aG9yaXplZCB1c2Ugb25seTEuMCwG\\n\" +\n-            \"A1UEAxMlRW50cnVzdCBDZXJ0aWZpY2F0aW9uIEF1dGhvcml0eSAtIEwxTjAeFw0y\\n\" +\n-            \"MDA1MjkyMDM2MDBaFw0yMjA4MjgyMDQwNDNaMIHTMQswCQYDVQQGEwJDQTEQMA4G\\n\" +\n-            \"A1UECBMHT250YXJpbzEPMA0GA1UEBxMGT3R0YXdhMRMwEQYLKwYBBAGCNzwCAQMT\\n\" +\n-            \"AkNBMRgwFgYLKwYBBAGCNzwCAQITB09udGFyaW8xITAfBgNVBAoTGEVudHJ1c3Qg\\n\" +\n-            \"RGF0YWNhcmQgTGltaXRlZDEdMBsGA1UEDxMUUHJpdmF0ZSBPcmdhbml6YXRpb24x\\n\" +\n-            \"EDAOBgNVBAUTBzE5MTM2MDUxHjAcBgNVBAMTFXJldm9rZWRnNC5lbnRydXN0Lm5l\\n\" +\n-            \"dDCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBAN6Bvaj7EG752e15UQH9\\n\" +\n-            \"4o8+660Gi3caUAAu45vZebO7EfRgrz0zyalpiexmQzocGn6Zog2yVqmMZjrMY11a\\n\" +\n-            \"q96s0pzVKImnA\/787G7J5lRncP+PM6\/WGtUUGS2hHiifoW5Ya\/kcI1uk6EDT0leb\\n\" +\n-            \"HIedOiwcfDkq38g5ckuWNae24DAD8AM9XBJXMuNbuiqo03wMlDL3Jif8wNQfpmPD\\n\" +\n-            \"b+KR6IwGJdYwLBMoMcPmZF0rykW3YTO2NTDGCwvT8zzvjIKp8caRkI6pfkKmc89U\\n\" +\n-            \"Nvgbk\/d9JEsgQLbYmRKVnhtnt756U7v3+0kZITxzfsBvQZ6zC7X4FAcTN1302RGn\\n\" +\n-            \"NGsCAwEAAaOCAY8wggGLMA4GA1UdDwEB\/wQEAwIFoDAdBgNVHSUEFjAUBggrBgEF\\n\" +\n-            \"BQcDAgYIKwYBBQUHAwEwDAYDVR0TAQH\/BAIwADAdBgNVHQ4EFgQULjRc9DEsa0kD\\n\" +\n-            \"uhKNo6cCqQ+mPjgwHwYDVR0jBBgwFoAU7kfRhXHx\/S23P7s+Y1h3F0lADpUwaAYI\\n\" +\n-            \"KwYBBQUHAQEEXDBaMCMGCCsGAQUFBzABhhdodHRwOi8vb2NzcC5lbnRydXN0Lm5l\\n\" +\n-            \"dDAzBggrBgEFBQcwAoYnaHR0cDovL2FpYS5lbnRydXN0Lm5ldC9sMW4tY2hhaW4y\\n\" +\n-            \"NTYuY2VyMDMGA1UdHwQsMCowKKAmoCSGImh0dHA6Ly9jcmwuZW50cnVzdC5uZXQv\\n\" +\n-            \"bGV2ZWwxbi5jcmwwIAYDVR0RBBkwF4IVcmV2b2tlZGc0LmVudHJ1c3QubmV0MEsG\\n\" +\n-            \"A1UdIAREMEIwNwYKYIZIAYb6bAoBAjApMCcGCCsGAQUFBwIBFhtodHRwczovL3d3\\n\" +\n-            \"dy5lbnRydXN0Lm5ldC9ycGEwBwYFZ4EMAQEwDQYJKoZIhvcNAQELBQADggEBAGab\\n\" +\n-            \"wtgpooQW3YL2Cqk9RDJFbNct5BSbzgY9qN1TOe4L7gbjV0BJBCcsHOCjvbgEuzME\\n\" +\n-            \"FC\/kAmBu7eMnKVAqCCsWaI8XV7xB7P\/BqHpvf9LI\/GyHg4wCYdxgFGBXHOjlSy+8\\n\" +\n-            \"YWRM5UnFUknqbj1B4u2\/U+U3X66QXi+MWrmBdjpcMahpY5zP1Bh90OmIc8DY4arf\\n\" +\n-            \"widObgJe2H\/VFScudLf5JMpBso2v772GYTRr5Tqqq3ouS9WvDf0NBvoStt1oiUMP\\n\" +\n-            \"oowesfNiaYa\/rZzWRlhYNs089KUeLhjOZswtIY5LCyy+Wt3CHgXljGEQFgi7p59s\\n\" +\n-            \"gk0aMRYM9Gri26VbD5A=\\n\" +\n-            \"-----END CERTIFICATE-----\";\n-\n-    public void runTest(ValidatePathWithParams pathValidator, boolean ocspEnabled) throws Exception {\n-        \/\/ Validate valid\n-        pathValidator.validate(new String[]{VALID, INT},\n-                ValidatePathWithParams.Status.GOOD, null, System.out);\n+    public void runTest() throws Exception {\n+        ValidatePathWithURL validatePathWithURL = new ValidatePathWithURL(CA_ALIAS);\n@@ -314,4 +82,2 @@\n-        \/\/ Validate Revoked\n-        pathValidator.validate(new String[]{REVOKED, INT},\n-                ValidatePathWithParams.Status.REVOKED,\n-                \"Fri May 29 13:42:13 PDT 2020\", System.out);\n+        validatePathWithURL.validateDomain(VALID, false);\n+        validatePathWithURL.validateDomain(REVOKED, true);\n","filename":"test\/jdk\/security\/infra\/java\/security\/cert\/CertPathValidator\/certification\/EntrustCA.java","additions":32,"deletions":266,"binary":false,"changes":298,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2019, 2020, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2019, 2023, Oracle and\/or its affiliates. All rights reserved.\n@@ -25,1 +25,1 @@\n- * @test\n+ * @test id=OCSP\n@@ -28,1 +28,3 @@\n- * @build ValidatePathWithParams\n+ * @library \/test\/lib\n+ * @build jtreg.SkippedException\n+ * @build ValidatePathWithURL\n@@ -30,1 +32,0 @@\n- * @run main\/othervm -Djava.security.debug=certpath GlobalSignR6CA CRL\n@@ -33,9 +34,8 @@\n- \/*\n- *\n- * Obtain TLS test artifacts for GlobalSign R6 CA from:\n- *\n- * Valid TLS Certificates:\n- * https:\/\/valid.r6.roots.globalsign.com\/\n- *\n- * Revoked TLS Certificates:\n- * https:\/\/revoked.r6.roots.globalsign.com\/\n+\/*\n+ * @test id=CRL\n+ * @bug 8216577 8249176\n+ * @summary Interoperability tests with GlobalSign R6 CA\n+ * @library \/test\/lib\n+ * @build jtreg.SkippedException\n+ * @build ValidatePathWithURL\n+ * @run main\/othervm -Djava.security.debug=certpath GlobalSignR6CA CRL\n@@ -45,145 +45,3 @@\n-    \/\/ Owner: CN=GlobalSign Atlas R6 EV TLS CA 2020, O=GlobalSign nv-sa, C=BE\n-    \/\/ Issuer: CN=GlobalSign, O=GlobalSign, OU=GlobalSign Root CA - R6\n-    \/\/ Serial number: 7803182afbecd89eb19309bb4a25bdaa\n-    \/\/ Valid from: Mon Jul 27 17:00:00 PDT 2020 until: Sat Jul 27 17:00:00 PDT 2030\n-    private static final String INT = \"-----BEGIN CERTIFICATE-----\\n\" +\n-            \"MIIGwDCCBKigAwIBAgIQeAMYKvvs2J6xkwm7SiW9qjANBgkqhkiG9w0BAQwFADBM\\n\" +\n-            \"MSAwHgYDVQQLExdHbG9iYWxTaWduIFJvb3QgQ0EgLSBSNjETMBEGA1UEChMKR2xv\\n\" +\n-            \"YmFsU2lnbjETMBEGA1UEAxMKR2xvYmFsU2lnbjAeFw0yMDA3MjgwMDAwMDBaFw0z\\n\" +\n-            \"MDA3MjgwMDAwMDBaMFUxCzAJBgNVBAYTAkJFMRkwFwYDVQQKExBHbG9iYWxTaWdu\\n\" +\n-            \"IG52LXNhMSswKQYDVQQDEyJHbG9iYWxTaWduIEF0bGFzIFI2IEVWIFRMUyBDQSAy\\n\" +\n-            \"MDIwMIICIjANBgkqhkiG9w0BAQEFAAOCAg8AMIICCgKCAgEAtQ8IiN2Ukq\/Clynv\\n\" +\n-            \"HhqugFQg5SXIyVO4ZRnxo0hNnaek78LRn4Bkaqcwv6Ls0Ftn4bK2zvBaS1zsfUTA\\n\" +\n-            \"vfup\/s86zHCRvOqAL8zO\/WiMV1G5ikHSlD6RtpIOHRX4y0oIGW59ADY0ANwDeDWL\\n\" +\n-            \"x\/RgSltuQIqeGXwZnyZFwWtxVkSE4p5tn2Lb6USzwcD22taiXmeYsPMWfJfmWPRj\\n\" +\n-            \"ZuYBgxn6tvUVRO+ZzAUKEEaJK\/LVLieAVEmfR6anEJ\/gWczxz12Lwu6qF5ov0OQt\\n\" +\n-            \"AP0rfruyje\/EJt6xHjpJ2OgDzCWYstXOpRPDHYS3klpaRbowAlpJdYMRAqY5CNiP\\n\" +\n-            \"RAx3wvsWCVI5UkzKVD6RuHHVpfzfdKAfsjHa\/aSunHtTpE+NUf3Q\/3qHXW5cyDnP\\n\" +\n-            \"Jt6VTVVVevjTquwH1xrUigukDbeopV1owsqIA5aw2io7RbBorwPBA0veinHN4vP9\\n\" +\n-            \"X8jbTiIiLjlfJOnHZe7pIhb3T9WCqhwwsBNPQpKizGHCj5kL2UJe7N5u4RywFOZE\\n\" +\n-            \"l5mbTX4zO6Vj3WM9ZVbZgXVNwEjS5mYq\/rvC1yr9obNUJ8br6JAd2ZBnzhA5Zn4s\\n\" +\n-            \"bIP99TlUBZWczw+vPM7g1S4e4cyd+8CULVhVs87QlyvwWnRbH7fXZo8xLzhzMCjB\\n\" +\n-            \"8Y0cNdL1S6QKrrhC6Pf6tV\/JU20CAwEAAaOCAZMwggGPMA4GA1UdDwEB\/wQEAwIB\\n\" +\n-            \"hjAdBgNVHSUEFjAUBggrBgEFBQcDAQYIKwYBBQUHAwIwEgYDVR0TAQH\/BAgwBgEB\\n\" +\n-            \"\/wIBADAdBgNVHQ4EFgQUhNwhC8eoXXKXhId+8tW2+nFWTvswHwYDVR0jBBgwFoAU\\n\" +\n-            \"rmwFo5MT4qLn4tcc1sfwf8hnU6AwewYIKwYBBQUHAQEEbzBtMC4GCCsGAQUFBzAB\\n\" +\n-            \"hiJodHRwOi8vb2NzcDIuZ2xvYmFsc2lnbi5jb20vcm9vdHI2MDsGCCsGAQUFBzAC\\n\" +\n-            \"hi9odHRwOi8vc2VjdXJlLmdsb2JhbHNpZ24uY29tL2NhY2VydC9yb290LXI2LmNy\\n\" +\n-            \"dDA2BgNVHR8ELzAtMCugKaAnhiVodHRwOi8vY3JsLmdsb2JhbHNpZ24uY29tL3Jv\\n\" +\n-            \"b3QtcjYuY3JsMFUGA1UdIAROMEwwQQYJKwYBBAGgMgEBMDQwMgYIKwYBBQUHAgEW\\n\" +\n-            \"Jmh0dHBzOi8vd3d3Lmdsb2JhbHNpZ24uY29tL3JlcG9zaXRvcnkvMAcGBWeBDAEB\\n\" +\n-            \"MA0GCSqGSIb3DQEBDAUAA4ICAQBD+97H2N1BgiliKQFrb+jcWjkmPP8cdF\/eiBW1\\n\" +\n-            \"cEzOOhsuVqxbyIk8qdw3UueHSDjqWUjHYoo8TV3DLqUXmIy1Ks3MkESsFKeLpEbk\\n\" +\n-            \"VMZga0lbDnqqRc5a2yzrXmwVYDeWVeD20s5vPoKCnFzmcR+2v9TKD4bI6XWVl84q\\n\" +\n-            \"GzfFRVdY9f8KN+7891+47ZhptvxtNqJKVI2O+EAP\/PvTpwes983LkFzsev4\/+Qxs\\n\" +\n-            \"EszD7\/pE+Byj3t9CMat2XoX0jfJjbEXgewFb\/gCwHvqNKLNWrYfE9qN8b6qm4xQk\\n\" +\n-            \"qGQKTrFKsBJx4TU+h10qXDhpmOBswiJqoG16XCV32oSn0JUYvXVAvP6YjueOv\/jr\\n\" +\n-            \"0ZMTWGh8wCz6v3XBaXR0rxDAz9GImpU+xPx2XjuHac7OnYbN+i8p7cJPUxABjHiA\\n\" +\n-            \"LWXIZtCn5ziCfvYC6+SCp8x9TPJzAIfJ4NKv\/8SpvvzuchVkAQqlQaGFBEdkX84R\\n\" +\n-            \"I\/WYYG+2BliFIpbQnfljYWCURbfsYz7+Zxb94+4yzva49p8T6lALoK3s2kqIVLKN\\n\" +\n-            \"s6qAnk\/qX6JihkaR3W+iViHMC5tqQX\/pd8QIXccF3PA2OdeNGU4iUNZqUbYB4VZd\\n\" +\n-            \"AaOaeaUl0LwAta6DB5w344eUIqDgaitSwQZBnxppmwL3tGzP1ero2e2RvBmphbxI\\n\" +\n-            \"atIdxA==\\n\" +\n-            \"-----END CERTIFICATE-----\";\n-\n-    \/\/ Owner: CN=valid.r6.roots.globalsign.com,\n-    \/\/ O=GMO GlobalSign LTD, STREET=\"Springfield House, Sandling Road\", OID.2.5.4.17=ME14 2LP, L=Maidstone, ST=Kent,\n-    \/\/ C=GB, SERIALNUMBER=04705639, OID.2.5.4.15=Private Organization, OID.1.3.6.1.4.1.311.60.2.1.3=GB\n-    \/\/ Issuer: CN=GlobalSign Atlas R6 EV TLS CA 2020, O=GlobalSign nv-sa, C=BE\n-    \/\/ Serial number: 1aff2829dd8bf07aa65a7b3c920ca4b\n-    \/\/ Valid from: Thu Aug 27 00:20:06 PDT 2020 until: Tue Sep 28 00:20:06 PDT 2021\n-    private static final String VALID = \"-----BEGIN CERTIFICATE-----\\n\" +\n-            \"MIIHyjCCBbKgAwIBAgIQAa\/ygp3YvweqZaezySDKSzANBgkqhkiG9w0BAQsFADBV\\n\" +\n-            \"MQswCQYDVQQGEwJCRTEZMBcGA1UEChMQR2xvYmFsU2lnbiBudi1zYTErMCkGA1UE\\n\" +\n-            \"AxMiR2xvYmFsU2lnbiBBdGxhcyBSNiBFViBUTFMgQ0EgMjAyMDAeFw0yMDA4Mjcw\\n\" +\n-            \"NzIwMDZaFw0yMTA5MjgwNzIwMDZaMIH6MRMwEQYLKwYBBAGCNzwCAQMTAkdCMR0w\\n\" +\n-            \"GwYDVQQPDBRQcml2YXRlIE9yZ2FuaXphdGlvbjERMA8GA1UEBRMIMDQ3MDU2Mzkx\\n\" +\n-            \"CzAJBgNVBAYTAkdCMQ0wCwYDVQQIDARLZW50MRIwEAYDVQQHDAlNYWlkc3RvbmUx\\n\" +\n-            \"ETAPBgNVBBEMCE1FMTQgMkxQMSkwJwYDVQQJDCBTcHJpbmdmaWVsZCBIb3VzZSwg\\n\" +\n-            \"U2FuZGxpbmcgUm9hZDEbMBkGA1UECgwSR01PIEdsb2JhbFNpZ24gTFREMSYwJAYD\\n\" +\n-            \"VQQDDB12YWxpZC5yNi5yb290cy5nbG9iYWxzaWduLmNvbTCCASIwDQYJKoZIhvcN\\n\" +\n-            \"AQEBBQADggEPADCCAQoCggEBAMOxbh7fZVLUB06xxNBePa9vpOuAS5km1w8ngsTu\\n\" +\n-            \"SvH1LZnPFd4nu40fi8bPbHd4J2oRWZ28f7LKVQgBupn9knrTQxfTV361WpmwqCcH\\n\" +\n-            \"MxornKyHx4t5uGrtTtX2fYoNQQk330dIKAfKpUrOiaDybB7irG2JEHdGD3Iv7ud8\\n\" +\n-            \"FXfXgXte26mUDX3XeCvE0pbuNKpTKApqOeojlVR6TCNB1n6KGYLMIz\/1ow6XBZ64\\n\" +\n-            \"1zKG\/9o0gSHelkUHGmGLzOAE5YpkhwzhpND9opycnfieHuy5BcoBIpeMqGNwOsGu\\n\" +\n-            \"p+nhFz+N8mPjSjZEf0qx+FLF2cBmNFknJJCdnV7OYfKZHE0CAwEAAaOCAu4wggLq\\n\" +\n-            \"MCgGA1UdEQQhMB+CHXZhbGlkLnI2LnJvb3RzLmdsb2JhbHNpZ24uY29tMA4GA1Ud\\n\" +\n-            \"DwEB\/wQEAwIFoDAdBgNVHSUEFjAUBggrBgEFBQcDAQYIKwYBBQUHAwIwHQYDVR0O\\n\" +\n-            \"BBYEFLZolpEC8\/bF44e\/gnh4StQ9+URwMFUGA1UdIAROMEwwBwYFZ4EMAQEwQQYJ\\n\" +\n-            \"KwYBBAGgMgEBMDQwMgYIKwYBBQUHAgEWJmh0dHBzOi8vd3d3Lmdsb2JhbHNpZ24u\\n\" +\n-            \"Y29tL3JlcG9zaXRvcnkvMAwGA1UdEwEB\/wQCMAAwgZoGCCsGAQUFBwEBBIGNMIGK\\n\" +\n-            \"MD4GCCsGAQUFBzABhjJodHRwOi8vb2NzcC5nbG9iYWxzaWduLmNvbS9jYS9nc2F0\\n\" +\n-            \"bGFzcjZldnRsc2NhMjAyMDBIBggrBgEFBQcwAoY8aHR0cDovL3NlY3VyZS5nbG9i\\n\" +\n-            \"YWxzaWduLmNvbS9jYWNlcnQvZ3NhdGxhc3I2ZXZ0bHNjYTIwMjAuY3J0MB8GA1Ud\\n\" +\n-            \"IwQYMBaAFITcIQvHqF1yl4SHfvLVtvpxVk77MEYGA1UdHwQ\/MD0wO6A5oDeGNWh0\\n\" +\n-            \"dHA6Ly9jcmwuZ2xvYmFsc2lnbi5jb20vY2EvZ3NhdGxhc3I2ZXZ0bHNjYTIwMjAu\\n\" +\n-            \"Y3JsMIIBAwYKKwYBBAHWeQIEAgSB9ASB8QDvAHYAfT7y+I\/\/iFVoJMLAyp5SiXkr\\n\" +\n-            \"xQ54CX8uapdomX4i8NcAAAF0Lsm7CwAABAMARzBFAiB0fLxAlPzkPxZOVj7c8OFc\\n\" +\n-            \"YwycekW0Mo+sRm\/BQYoeOgIhAK2lNW7ebraH\/\/ZlLQD7dyzWCO+kgmkQo+mqdm1x\\n\" +\n-            \"4P15AHUAb1N2rDHwMRnYmQCkURX\/dxUcEdkCwQApBo2yCJo32RMAAAF0Lsm7JAAA\\n\" +\n-            \"BAMARjBEAiALOZvdNiA9q1Ysr7ejTGdivUqNJNm9KftmGXwHFGwf2QIgDodNLmbZ\\n\" +\n-            \"JFGt8l5ul0fHw2Gn8KqhRUW6CMRT58svhcswDQYJKoZIhvcNAQELBQADggIBAByb\\n\" +\n-            \"hoL\/sArmkNjTFiEEBocMfb+brgRQdb08NKC1BDxGnfIFjUmOFzI2SVgtBmcoF8FI\\n\" +\n-            \"0WyXQv6ZxVE01DFZpeZpsJJYfBAjg9NR4\/B7UjajvOJwQNpaciAGQ0ZzTu+SmHja\\n\" +\n-            \"jIiC2KqiA7Me2MoUne6hhxZ3dXEneIml8hnbTf2mjSBCVpQqyf2goslhGduPitI6\\n\" +\n-            \"guTtVD2PVaNCVkjlRn4Euspl2JjQWzGcEruqGyQN+Bu4yt1hsD4Jj6V9Hmzo8Vrd\\n\" +\n-            \"5LUxFPRGIgCUDiiwnENVsQB\/D24y3IapPkojujrvsVsmQN42GIgOY5tLK\/8cCziD\\n\" +\n-            \"vf0GzZnmL1D2ezi3TaBj+XBWFcAyF2Y9AnVRmC9CrVcp6EX0KhD4g9ZgbpJZpVlk\\n\" +\n-            \"G3xfOiZWTeqLnQhCMXcdcutWIwXAX5gueyF1t545vECCE4PeGZNAeWqdbrj7xaS8\\n\" +\n-            \"3rKQdgwF9r6p7F5HHwEVCckhovEYU4DNFzYb9n\/YmC3hmskFB1keTYqydKUYEGZ5\\n\" +\n-            \"fvLvsjRj9xwOCqIs5j1vuKw2CaqmHxrfYaDMMSZPq\/iYrOWrf72wZIvtnAHePt3X\\n\" +\n-            \"atQMqNbDMQrjul31ljDP9CIbbtuZSkSACyMxiC10l4uTTLQiTxtZPkwIazOjnbBe\\n\" +\n-            \"A4fruOEQ2k1gu5oFgqmo+xuclOKNjwd\/RkK4FXnD\\n\" +\n-            \"-----END CERTIFICATE-----\";\n-\n-    \/\/ Owner: CN=revoked.r6.roots.globalsign.com,\n-    \/\/ O=GMO GlobalSign LTD, STREET=\"Springfield House, Sandling Road\", OID.2.5.4.17=ME14 2LP, L=Maidstone, ST=Kent,\n-    \/\/ C=GB, SERIALNUMBER=04705639, OID.2.5.4.15=Private Organization, OID.1.3.6.1.4.1.311.60.2.1.3=GB\n-    \/\/ Issuer: CN=GlobalSign Atlas R6 EV TLS CA 2020, O=GlobalSign nv-sa, C=BE\n-    \/\/ Serial number: 1df30d84796ac20c47da63b8e681e8f\n-    \/\/ Valid from: Thu Aug 27 00:37:53 PDT 2020 until: Tue Sep 28 00:37:53 PDT 2021\n-    private static final String REVOKED = \"-----BEGIN CERTIFICATE-----\\n\" +\n-            \"MIIHzzCCBbegAwIBAgIQAd8w2EeWrCDEfaY7jmgejzANBgkqhkiG9w0BAQsFADBV\\n\" +\n-            \"MQswCQYDVQQGEwJCRTEZMBcGA1UEChMQR2xvYmFsU2lnbiBudi1zYTErMCkGA1UE\\n\" +\n-            \"AxMiR2xvYmFsU2lnbiBBdGxhcyBSNiBFViBUTFMgQ0EgMjAyMDAeFw0yMDA4Mjcw\\n\" +\n-            \"NzM3NTNaFw0yMTA5MjgwNzM3NTNaMIH8MRMwEQYLKwYBBAGCNzwCAQMTAkdCMR0w\\n\" +\n-            \"GwYDVQQPDBRQcml2YXRlIE9yZ2FuaXphdGlvbjERMA8GA1UEBRMIMDQ3MDU2Mzkx\\n\" +\n-            \"CzAJBgNVBAYTAkdCMQ0wCwYDVQQIDARLZW50MRIwEAYDVQQHDAlNYWlkc3RvbmUx\\n\" +\n-            \"ETAPBgNVBBEMCE1FMTQgMkxQMSkwJwYDVQQJDCBTcHJpbmdmaWVsZCBIb3VzZSwg\\n\" +\n-            \"U2FuZGxpbmcgUm9hZDEbMBkGA1UECgwSR01PIEdsb2JhbFNpZ24gTFREMSgwJgYD\\n\" +\n-            \"VQQDDB9yZXZva2VkLnI2LnJvb3RzLmdsb2JhbHNpZ24uY29tMIIBIjANBgkqhkiG\\n\" +\n-            \"9w0BAQEFAAOCAQ8AMIIBCgKCAQEAvaNcp7bzmm02Z0S92ZzJ\/ul3uQWz3EnBORcI\\n\" +\n-            \"RuEzm0HY4t0n9DGnxpxOi\/aWGX\/Vj7qZC4m3G7uCE7dMy6CfXTwh4UZ+nPVijImo\\n\" +\n-            \"q\/msJzmju\/pk8HVeOEhk88yvwfzmzYLjoQagmHnDUSQULEmNWihejIh4B61qx4SI\\n\" +\n-            \"UoBPoBgqDfZW27HkJeqNAO6rljZTZwLenJesm2QMjebYaKxQBi3fLy0Lua2sxTik\\n\" +\n-            \"fbT3swEPN9xxvMomtNNM2tJwdExL2RpO8dObUe37ep6roG7gWh8NYDKMo6j9Rn9e\\n\" +\n-            \"f0S9jwkcRM2kZSHR09HSu8ULBgP+KYa8DDpOyt+HO+2G57MhbQIDAQABo4IC8TCC\\n\" +\n-            \"Au0wKgYDVR0RBCMwIYIfcmV2b2tlZC5yNi5yb290cy5nbG9iYWxzaWduLmNvbTAO\\n\" +\n-            \"BgNVHQ8BAf8EBAMCBaAwHQYDVR0lBBYwFAYIKwYBBQUHAwEGCCsGAQUFBwMCMB0G\\n\" +\n-            \"A1UdDgQWBBTa1\/37G4T022LEW3WwIVV99qtjsjBVBgNVHSAETjBMMAcGBWeBDAEB\\n\" +\n-            \"MEEGCSsGAQQBoDIBATA0MDIGCCsGAQUFBwIBFiZodHRwczovL3d3dy5nbG9iYWxz\\n\" +\n-            \"aWduLmNvbS9yZXBvc2l0b3J5LzAMBgNVHRMBAf8EAjAAMIGaBggrBgEFBQcBAQSB\\n\" +\n-            \"jTCBijA+BggrBgEFBQcwAYYyaHR0cDovL29jc3AuZ2xvYmFsc2lnbi5jb20vY2Ev\\n\" +\n-            \"Z3NhdGxhc3I2ZXZ0bHNjYTIwMjAwSAYIKwYBBQUHMAKGPGh0dHA6Ly9zZWN1cmUu\\n\" +\n-            \"Z2xvYmFsc2lnbi5jb20vY2FjZXJ0L2dzYXRsYXNyNmV2dGxzY2EyMDIwLmNydDAf\\n\" +\n-            \"BgNVHSMEGDAWgBSE3CELx6hdcpeEh37y1bb6cVZO+zBGBgNVHR8EPzA9MDugOaA3\\n\" +\n-            \"hjVodHRwOi8vY3JsLmdsb2JhbHNpZ24uY29tL2NhL2dzYXRsYXNyNmV2dGxzY2Ey\\n\" +\n-            \"MDIwLmNybDCCAQQGCisGAQQB1nkCBAIEgfUEgfIA8AB2AG9Tdqwx8DEZ2JkApFEV\\n\" +\n-            \"\/3cVHBHZAsEAKQaNsgiaN9kTAAABdC7aAfUAAAQDAEcwRQIgHIAHHw\/Y\/VKaaHhy\\n\" +\n-            \"rZ\/cMinivfZ4lUq2ejV7FRPbT8ECIQD3RoE13\/MBVMVBLCQ2ErKsB5+7F31dX\/tv\\n\" +\n-            \"Z\/muQi5UrQB2AH0+8viP\/4hVaCTCwMqeUol5K8UOeAl\/LmqXaJl+IvDXAAABdC7a\\n\" +\n-            \"AegAAAQDAEcwRQIhALl0LXt6pFqS0cHF\/XkxSfDJJdhppR2eSlcMFpZY0q1PAiBJ\\n\" +\n-            \"YkKHqq\/YD0gwtZAUEPSk54G1cLxFoUiounjya1XTRzANBgkqhkiG9w0BAQsFAAOC\\n\" +\n-            \"AgEAdeQotBhB7bn+CztQmF13rdBphHrGkkyHC3hL1bxkmHJcrLQ5ochqPvgdgAVq\\n\" +\n-            \"DXcV8zSyNwVxW6REi+uYzcsOPKo\/llmgF7Psqn1t\/EDcutWlykh8UwE5UaLJ2EWD\\n\" +\n-            \"HnIu06n47lWtAwlNMXJ\/ce0oVjqsgY52Y1u54e8wFXt6lsSw02tzIC6eo1BFKxQ3\\n\" +\n-            \"lDKYVXgg0OvMG\/C2rvH\/EIq5r+st49rNGWfcWRoHsDUruChZOHwJ9PrXKBLB\/QVd\\n\" +\n-            \"4uw2V\/0ipOETDudly7yLodXP8quhet4bCEO9gweXppL\/MikLrE5xt46HW1\/6w+jF\\n\" +\n-            \"wKCHWlq4ViswlaQ8q0oY\/97o2udnuDQaNdrLgW3VofMeBIMNPBgkLDicOH6bLwNf\\n\" +\n-            \"lV68qi1ZBxBuOdoOqQyZ9RU9d3EL50XEJ4MtUvjJRAT5EWdFaB8SGGZbD5fyza8c\\n\" +\n-            \"KmeO5tkZWYecLd8CKqwKcW7umPflEwOzw60Cxg6eyBYA8Jfagpbdb\/kXsF6Ov8IW\\n\" +\n-            \"vxNdHCnXnR3oBWm2uHddESO2zGF1ZfOb0O3cHHG5nCgVkWW68VpgX\/LaN90u6Dzw\\n\" +\n-            \"diJX7esZV5ZaniqD+flWldgAdcfeXlJ5b7I7GnFr61ycmZT\/qupagUS1WDq\/zfct\\n\" +\n-            \"QcB4QmnAzGe6kcqiDOSyIYWpiw09jha63KpJtJDWRemrlQI=\\n\" +\n-            \"-----END CERTIFICATE-----\";\n+     private static final String VALID = \"https:\/\/valid.r6.roots.globalsign.com\/\";\n+     private static final String REVOKED = \"https:\/\/revoked.r6.roots.globalsign.com\/\";\n+    private static final String CA_ALIAS = \"globalsignrootcar6 [jdk]\";\n@@ -193,2 +51,0 @@\n-        ValidatePathWithParams pathValidator = new ValidatePathWithParams(null);\n-\n@@ -196,1 +52,1 @@\n-            pathValidator.enableCRLCheck();\n+            ValidatePathWithURL.enableCRLOnly();\n@@ -199,1 +55,1 @@\n-            pathValidator.enableOCSPCheck();\n+            ValidatePathWithURL.enableOCSPOnly();\n@@ -202,3 +58,1 @@\n-        \/\/ Validate valid\n-        pathValidator.validate(new String[]{VALID, INT},\n-                ValidatePathWithParams.Status.GOOD, null, System.out);\n+        ValidatePathWithURL validatePathWithURL = new ValidatePathWithURL(CA_ALIAS);\n@@ -206,4 +60,2 @@\n-        \/\/ Validate Revoked\n-        pathValidator.validate(new String[]{REVOKED, INT},\n-                ValidatePathWithParams.Status.REVOKED,\n-                \"Thu Aug 27 00:38:11 PDT 2020\", System.out);\n+        validatePathWithURL.validateDomain(VALID, false);\n+        validatePathWithURL.validateDomain(REVOKED, true);\n","filename":"test\/jdk\/security\/infra\/java\/security\/cert\/CertPathValidator\/certification\/GlobalSignR6CA.java","additions":21,"deletions":169,"binary":false,"changes":190,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2018, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2018, 2023, Oracle and\/or its affiliates. All rights reserved.\n@@ -24,1 +24,0 @@\n-\n@@ -26,1 +25,1 @@\n- * @test\n+ * @test id=OCSP\n@@ -29,1 +28,3 @@\n- * @build ValidatePathWithParams\n+ * @library \/test\/lib\n+ * @build jtreg.SkippedException\n+ * @build ValidatePathWithURL\n@@ -31,1 +32,0 @@\n- * @run main\/othervm -Djava.security.debug=certpath GoDaddyCA CRL\n@@ -35,11 +35,7 @@\n- * Obtain test artifacts for GoDaddy\/Starfield CAs from:\n- *\n- * Go Daddy Root Certificate Authority - G2:\n- *    valid: https:\/\/valid.gdig2.catest.godaddy.com\/\n- *    expired: https:\/\/expired.gdig2.catest.godaddy.com\/\n- *    revoked: https:\/\/revoked.gdig2.catest.godaddy.com\/\n- *\n- * Starfield Root Certificate Authority - G2:\n- *    valid: https:\/\/valid.sfig2.catest.starfieldtech.com\/\n- *    expired: https:\/\/expired.sfig2.catest.starfieldtech.com\/\n- *    revoked: https:\/\/revoked.sfig2.catest.starfieldtech.com\/\n+ * @test id=CRL\n+ * @bug 8196141\n+ * @summary Interoperability tests with GoDaddy\/Starfield CA\n+ * @library \/test\/lib\n+ * @build jtreg.SkippedException\n+ * @build ValidatePathWithURL\n+ * @run main\/othervm -Djava.security.debug=certpath GoDaddyCA CRL\n@@ -51,2 +47,0 @@\n-        ValidatePathWithParams pathValidator = new ValidatePathWithParams(null);\n-\n@@ -54,2 +48,1 @@\n-            \/\/ CRL check\n-            pathValidator.enableCRLCheck();\n+            ValidatePathWithURL.enableCRLOnly();\n@@ -58,1 +51,1 @@\n-            pathValidator.enableOCSPCheck();\n+            ValidatePathWithURL.enableOCSPOnly();\n@@ -61,2 +54,2 @@\n-        new GoDaddyGdig2().runTest(pathValidator);\n-        new GoDaddySfig2().runTest(pathValidator);\n+        new GoDaddyGdig2().runTest();\n+        new GoDaddySfig2().runTest();\n@@ -67,0 +60,3 @@\n+    private static final String VALID = \"https:\/\/valid.gdig2.catest.godaddy.com\/\";\n+    private static final String REVOKED = \"https:\/\/revoked.gdig2.catest.godaddy.com\/\";\n+    private static final String CA_ALIAS = \"godaddyrootg2ca [jdk]\";\n@@ -68,128 +64,2 @@\n-    \/\/ Owner: CN=Go Daddy Secure Certificate Authority - G2,\n-    \/\/ OU=http:\/\/certs.godaddy.com\/repository\/, O=\"GoDaddy.com, Inc.\",\n-    \/\/ L=Scottsdale, ST=Arizona, C=US\n-    \/\/ Issuer: CN=Go Daddy Root Certificate Authority - G2, O=\"GoDaddy.com, Inc.\",\n-    \/\/ L=Scottsdale, ST=Arizona, C=US\n-    private static final String INT = \"-----BEGIN CERTIFICATE-----\\n\"\n-            + \"MIIE0DCCA7igAwIBAgIBBzANBgkqhkiG9w0BAQsFADCBgzELMAkGA1UEBhMCVVMx\\n\"\n-            + \"EDAOBgNVBAgTB0FyaXpvbmExEzARBgNVBAcTClNjb3R0c2RhbGUxGjAYBgNVBAoT\\n\"\n-            + \"EUdvRGFkZHkuY29tLCBJbmMuMTEwLwYDVQQDEyhHbyBEYWRkeSBSb290IENlcnRp\\n\"\n-            + \"ZmljYXRlIEF1dGhvcml0eSAtIEcyMB4XDTExMDUwMzA3MDAwMFoXDTMxMDUwMzA3\\n\"\n-            + \"MDAwMFowgbQxCzAJBgNVBAYTAlVTMRAwDgYDVQQIEwdBcml6b25hMRMwEQYDVQQH\\n\"\n-            + \"EwpTY290dHNkYWxlMRowGAYDVQQKExFHb0RhZGR5LmNvbSwgSW5jLjEtMCsGA1UE\\n\"\n-            + \"CxMkaHR0cDovL2NlcnRzLmdvZGFkZHkuY29tL3JlcG9zaXRvcnkvMTMwMQYDVQQD\\n\"\n-            + \"EypHbyBEYWRkeSBTZWN1cmUgQ2VydGlmaWNhdGUgQXV0aG9yaXR5IC0gRzIwggEi\\n\"\n-            + \"MA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQC54MsQ1K92vdSTYuswZLiBCGzD\\n\"\n-            + \"BNliF44v\/z5lz4\/OYuY8UhzaFkVLVat4a2ODYpDOD2lsmcgaFItMzEUz6ojcnqOv\\n\"\n-            + \"K\/6AYZ15V8TPLvQ\/MDxdR\/yaFrzDN5ZBUY4RS1T4KL7QjL7wMDge87Am+GZHY23e\\n\"\n-            + \"cSZHjzhHU9FGHbTj3ADqRay9vHHZqm8A29vNMDp5T19MR\/gd71vCxJ1gO7GyQ5HY\\n\"\n-            + \"pDNO6rPWJ0+tJYqlxvTV0KaudAVkV4i1RFXULSo6Pvi4vekyCgKUZMQWOlDxSq7n\\n\"\n-            + \"eTOvDCAHf+jfBDnCaQJsY1L6d8EbyHSHyLmTGFBUNUtpTrw700kuH9zB0lL7AgMB\\n\"\n-            + \"AAGjggEaMIIBFjAPBgNVHRMBAf8EBTADAQH\/MA4GA1UdDwEB\/wQEAwIBBjAdBgNV\\n\"\n-            + \"HQ4EFgQUQMK9J47MNIMwojPX+2yz8LQsgM4wHwYDVR0jBBgwFoAUOpqFBxBnKLbv\\n\"\n-            + \"9r0FQW4gwZTaD94wNAYIKwYBBQUHAQEEKDAmMCQGCCsGAQUFBzABhhhodHRwOi8v\\n\"\n-            + \"b2NzcC5nb2RhZGR5LmNvbS8wNQYDVR0fBC4wLDAqoCigJoYkaHR0cDovL2NybC5n\\n\"\n-            + \"b2RhZGR5LmNvbS9nZHJvb3QtZzIuY3JsMEYGA1UdIAQ\/MD0wOwYEVR0gADAzMDEG\\n\"\n-            + \"CCsGAQUFBwIBFiVodHRwczovL2NlcnRzLmdvZGFkZHkuY29tL3JlcG9zaXRvcnkv\\n\"\n-            + \"MA0GCSqGSIb3DQEBCwUAA4IBAQAIfmyTEMg4uJapkEv\/oV9PBO9sPpyIBslQj6Zz\\n\"\n-            + \"91cxG7685C\/b+LrTW+C05+Z5Yg4MotdqY3MxtfWoSKQ7CC2iXZDXtHwlTxFWMMS2\\n\"\n-            + \"RJ17LJ3lXubvDGGqv+QqG+6EnriDfcFDzkSnE3ANkR\/0yBOtg2DZ2HKocyQetawi\\n\"\n-            + \"DsoXiWJYRBuriSUBAA\/NxBti21G00w9RKpv0vHP8ds42pM3Z2Czqrpv1KrKQ0U11\\n\"\n-            + \"GIo\/ikGQI31bS\/6kA1ibRrLDYGCD+H1QQc7CoZDDu+8CL9IVVO5EFdkKrqeKM+2x\\n\"\n-            + \"LXY2JtwE65\/3YR8V3Idv7kaWKK2hJn0KCacuBKONvPi8BDAB\\n\"\n-            + \"-----END CERTIFICATE-----\";\n-\n-    \/\/ 1.3.6.1.4.1.311.60.2.1.3=US\/1.3.6.1.4.1.311.60.2.1.2=Delaware\/businessCategory=Private\n-    \/\/ Organization\/serialNumber=5510922, C=US, ST=Arizona, L=Scottsdale, O=GoDaddy INC., CN=valid.gdig2.catest.godaddy.com\n-    private static final String VALID = \"-----BEGIN CERTIFICATE-----\\n\" +\n-            \"MIIHbzCCBlegAwIBAgIIC3Go9uPeseowDQYJKoZIhvcNAQELBQAwgbQxCzAJBgNV\\n\" +\n-            \"BAYTAlVTMRAwDgYDVQQIEwdBcml6b25hMRMwEQYDVQQHEwpTY290dHNkYWxlMRow\\n\" +\n-            \"GAYDVQQKExFHb0RhZGR5LmNvbSwgSW5jLjEtMCsGA1UECxMkaHR0cDovL2NlcnRz\\n\" +\n-            \"LmdvZGFkZHkuY29tL3JlcG9zaXRvcnkvMTMwMQYDVQQDEypHbyBEYWRkeSBTZWN1\\n\" +\n-            \"cmUgQ2VydGlmaWNhdGUgQXV0aG9yaXR5IC0gRzIwHhcNMTcwOTE1MjMyMzAyWhcN\\n\" +\n-            \"MTkwOTE1MjMyMzAyWjCB1TETMBEGCysGAQQBgjc8AgEDEwJVUzEZMBcGCysGAQQB\\n\" +\n-            \"gjc8AgECEwhEZWxhd2FyZTEdMBsGA1UEDxMUUHJpdmF0ZSBPcmdhbml6YXRpb24x\\n\" +\n-            \"EDAOBgNVBAUTBzU1MTA5MjIxCzAJBgNVBAYTAlVTMRAwDgYDVQQIEwdBcml6b25h\\n\" +\n-            \"MRMwEQYDVQQHEwpTY290dHNkYWxlMRUwEwYDVQQKEwxHb0RhZGR5IElOQy4xJzAl\\n\" +\n-            \"BgNVBAMTHnZhbGlkLmdkaWcyLmNhdGVzdC5nb2RhZGR5LmNvbTCCASIwDQYJKoZI\\n\" +\n-            \"hvcNAQEBBQADggEPADCCAQoCggEBAO3xTbLfdIHiG1MIsBCz0oIg5vBxlzZyK5Rw\\n\" +\n-            \"DM6A\/TWUDelFWyYj6fZDXYyHby4nAK9ibfhiT2f+q+5lEslye5Mt9gC39pZbpHE2\\n\" +\n-            \"eyJgmtNgmPGq15pf\/87JE697BRwp9CWJP3yNYeamFl\/F2THZOqlXCiSRbIGZ5TsZ\\n\" +\n-            \"sVb1vjFPmh249Ujw1zSThY9hA669Cyp3xb4iTowjCqdNYqbn22Jbk0SEXPYzLMf0\\n\" +\n-            \"mlY8xZ\/e\/8NxzJgev3N1LR3bPEijLYDZeZJ6WKc75pqNvgo8A+dEeX9bxFkCnstY\\n\" +\n-            \"6Iq0HTJua0TTD6V585YXNm4Z5OxjBE5kPkkFfwW0bb5dRZp86HUCAwEAAaOCA2Aw\\n\" +\n-            \"ggNcMAwGA1UdEwEB\/wQCMAAwHQYDVR0lBBYwFAYIKwYBBQUHAwEGCCsGAQUFBwMC\\n\" +\n-            \"MA4GA1UdDwEB\/wQEAwIFoDA1BgNVHR8ELjAsMCqgKKAmhiRodHRwOi8vY3JsLmdv\\n\" +\n-            \"ZGFkZHkuY29tL2dkaWcyczMtOS5jcmwwXAYDVR0gBFUwUzBIBgtghkgBhv1tAQcX\\n\" +\n-            \"AzA5MDcGCCsGAQUFBwIBFitodHRwOi8vY2VydGlmaWNhdGVzLmdvZGFkZHkuY29t\\n\" +\n-            \"L3JlcG9zaXRvcnkvMAcGBWeBDAEBMHYGCCsGAQUFBwEBBGowaDAkBggrBgEFBQcw\\n\" +\n-            \"AYYYaHR0cDovL29jc3AuZ29kYWRkeS5jb20vMEAGCCsGAQUFBzAChjRodHRwOi8v\\n\" +\n-            \"Y2VydGlmaWNhdGVzLmdvZGFkZHkuY29tL3JlcG9zaXRvcnkvZ2RpZzIuY3J0MB8G\\n\" +\n-            \"A1UdIwQYMBaAFEDCvSeOzDSDMKIz1\/tss\/C0LIDOME0GA1UdEQRGMESCHnZhbGlk\\n\" +\n-            \"LmdkaWcyLmNhdGVzdC5nb2RhZGR5LmNvbYIid3d3LnZhbGlkLmdkaWcyLmNhdGVz\\n\" +\n-            \"dC5nb2RhZGR5LmNvbTAdBgNVHQ4EFgQUKSs41O+5SnkjAEaNyHk6sxq5sn8wggF\/\\n\" +\n-            \"BgorBgEEAdZ5AgQCBIIBbwSCAWsBaQB3AFYUBpov18Ls0\/XhvUSyPsdGdrm8mRFc\\n\" +\n-            \"wO+UmFXWidDdAAABXofbjGMAAAQDAEgwRgIhAPZEqPZAlYpSTx+R\/+7mOUa+BcBz\\n\" +\n-            \"U1JHZDpcy98am0glAiEA1u2FxjgAa4L5HVGYV2LSQZIltGRJ8mBT8V0JVsdm3dsA\\n\" +\n-            \"dgDuS723dc5guuFCaR+r4Z5mow9+X7By2IMAxHuJeqj9ywAAAV6H25ASAAAEAwBH\\n\" +\n-            \"MEUCIQCFowkRXyR8gkX8cL7RbPSwiKCHy\/1I1WVzpinmrHlZFQIgE5nShGeK7cqT\\n\" +\n-            \"j2C9FfrPc\/Axe3\/pzAFxD\/BNQD1RO5sAdgCkuQmQtBhYFIe7E6LMZ3AKPDWYBPkb\\n\" +\n-            \"37jjd80OyA3cEAAAAV6H25GdAAAEAwBHMEUCIBQrE+FqILUhI0wdp2X+lf\/e3UG1\\n\" +\n-            \"gyxHmSVeN2+CkrXPAiEA1mIIVmLNURGyI8wnZ5KRnBPOKYM2MC54RJ8CFrEHIz4w\\n\" +\n-            \"DQYJKoZIhvcNAQELBQADggEBADInvf3eS6SgQ1qxPx4RT2hPeU5frlWJWcOWUdZB\\n\" +\n-            \"6mVNcmUQMkYnjkg8+PQ782HGP0DvAfcIRDhSfXdIqzEk8MPUq1XHEOfwRzLpTiCN\\n\" +\n-            \"FQDQIt1LXnzESCUurJS8r4mxgaVLAwHFytOTDrQn0Xfs93dm0tnRGAg7iBg+N33V\\n\" +\n-            \"zOR4aqojdDUWa1Rr4WFqZMkZIxzREQCYC8HXSYqLA1oPuoMMog8dId7XSalBmGJ4\\n\" +\n-            \"KQVsZ0\/Hpi0y9k\/Zw5obGcEYJWMbuU1iaEkvdtXOiXEQfJ1WS+Yy55J4GSjpIiop\\n\" +\n-            \"qDZD88xA9r7ttzM\/khao7jfIpVWG2HuX0JlHWdh3y9aegiw=\\n\" +\n-            \"-----END CERTIFICATE-----\";\n-\n-    \/\/ 1.3.6.1.4.1.311.60.2.1.3=US\/1.3.6.1.4.1.311.60.2.1.2=Delaware\/businessCategory=Private\n-    \/\/ Organization\/serialNumber=5510922, C=US, ST=Arizona, L=Scottsdale, O=GoDaddy INC., CN=revoked.gdig2.catest.godaddy.com\n-    private static final String REVOKED = \"-----BEGIN CERTIFICATE-----\\n\" +\n-            \"MIIHdDCCBlygAwIBAgIIEBJV3vmogM8wDQYJKoZIhvcNAQELBQAwgbQxCzAJBgNV\\n\" +\n-            \"BAYTAlVTMRAwDgYDVQQIEwdBcml6b25hMRMwEQYDVQQHEwpTY290dHNkYWxlMRow\\n\" +\n-            \"GAYDVQQKExFHb0RhZGR5LmNvbSwgSW5jLjEtMCsGA1UECxMkaHR0cDovL2NlcnRz\\n\" +\n-            \"LmdvZGFkZHkuY29tL3JlcG9zaXRvcnkvMTMwMQYDVQQDEypHbyBEYWRkeSBTZWN1\\n\" +\n-            \"cmUgQ2VydGlmaWNhdGUgQXV0aG9yaXR5IC0gRzIwHhcNMTcwOTE1MjMyMzAzWhcN\\n\" +\n-            \"MTkwOTE1MjMyMzAzWjCB1zETMBEGCysGAQQBgjc8AgEDEwJVUzEZMBcGCysGAQQB\\n\" +\n-            \"gjc8AgECEwhEZWxhd2FyZTEdMBsGA1UEDxMUUHJpdmF0ZSBPcmdhbml6YXRpb24x\\n\" +\n-            \"EDAOBgNVBAUTBzU1MTA5MjIxCzAJBgNVBAYTAlVTMRAwDgYDVQQIEwdBcml6b25h\\n\" +\n-            \"MRMwEQYDVQQHEwpTY290dHNkYWxlMRUwEwYDVQQKEwxHb0RhZGR5IElOQy4xKTAn\\n\" +\n-            \"BgNVBAMTIHJldm9rZWQuZ2RpZzIuY2F0ZXN0LmdvZGFkZHkuY29tMIIBIjANBgkq\\n\" +\n-            \"hkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAxCuBsAR2XGf05mYOuag+0aS4lBuLO5\/f\\n\" +\n-            \"kEO7KNo7BcdY7J78yXYRYW0jGnV29bjrQZJfu5yv5bU+OjTIDVbCWZAwtBXEKrJj\\n\" +\n-            \"riIOUXi3hXphtlyMMAaiXQoA84jwS634DsD0w6XUUP2Lem8jC3RudjvmkDQHoY3M\\n\" +\n-            \"uhhS7jLxKnYKnXbLwlqxpdwmEgbqIb5DN5snLAyinTkALLVWZ6RneIuSjhKWbuef\\n\" +\n-            \"cEKFScHm6SFsKraltV\/T17SWi6zQd\/AypKA8JeWXD9WZcsSR9z\/41VMJbvTeuP+d\\n\" +\n-            \"ZBA4dqPsBTl4N4i54rNEyzMyxDwdvIGrJJ+FVRMKoYjuUi5wY9zO4QIDAQABo4ID\\n\" +\n-            \"YzCCA18wDAYDVR0TAQH\/BAIwADAdBgNVHSUEFjAUBggrBgEFBQcDAQYIKwYBBQUH\\n\" +\n-            \"AwIwDgYDVR0PAQH\/BAQDAgWgMDUGA1UdHwQuMCwwKqAooCaGJGh0dHA6Ly9jcmwu\\n\" +\n-            \"Z29kYWRkeS5jb20vZ2RpZzJzMy05LmNybDBcBgNVHSAEVTBTMEgGC2CGSAGG\/W0B\\n\" +\n-            \"BxcDMDkwNwYIKwYBBQUHAgEWK2h0dHA6Ly9jZXJ0aWZpY2F0ZXMuZ29kYWRkeS5j\\n\" +\n-            \"b20vcmVwb3NpdG9yeS8wBwYFZ4EMAQEwdgYIKwYBBQUHAQEEajBoMCQGCCsGAQUF\\n\" +\n-            \"BzABhhhodHRwOi8vb2NzcC5nb2RhZGR5LmNvbS8wQAYIKwYBBQUHMAKGNGh0dHA6\\n\" +\n-            \"Ly9jZXJ0aWZpY2F0ZXMuZ29kYWRkeS5jb20vcmVwb3NpdG9yeS9nZGlnMi5jcnQw\\n\" +\n-            \"HwYDVR0jBBgwFoAUQMK9J47MNIMwojPX+2yz8LQsgM4wUQYDVR0RBEowSIIgcmV2\\n\" +\n-            \"b2tlZC5nZGlnMi5jYXRlc3QuZ29kYWRkeS5jb22CJHd3dy5yZXZva2VkLmdkaWcy\\n\" +\n-            \"LmNhdGVzdC5nb2RhZGR5LmNvbTAdBgNVHQ4EFgQUCJELlWq8+ntmR5JTjmZMG+HI\\n\" +\n-            \"e5EwggF+BgorBgEEAdZ5AgQCBIIBbgSCAWoBaAB1AFYUBpov18Ls0\/XhvUSyPsdG\\n\" +\n-            \"drm8mRFcwO+UmFXWidDdAAABXofbk3cAAAQDAEYwRAIgHo8UllsN8FcaF16xx7kT\\n\" +\n-            \"vQU1wM7qUKnhN38\/z8dU4QUCIFrzGJyajoVPQ2fzOTb9ygzA7T3wqsnT3ML5\/KJ6\\n\" +\n-            \"+6+CAHYA7ku9t3XOYLrhQmkfq+GeZqMPfl+wctiDAMR7iXqo\/csAAAFeh9uXHQAA\\n\" +\n-            \"BAMARzBFAiEA5DENZZT7SBxNRvo9yFHNNeWqH2d4uqGUwc1rKILrMGsCIHZ3N4dZ\\n\" +\n-            \"zv\/J+7fbLP1nrAmdUT92ow1bhtMPuq2PfXsAAHcApLkJkLQYWBSHuxOizGdwCjw1\\n\" +\n-            \"mAT5G9+443fNDsgN3BAAAAFeh9uYjAAABAMASDBGAiEAyY8ylnGHiH5L3yXE7BsH\\n\" +\n-            \"v75ja2RtuuYbMADAlDK\/ZDoCIQDwuCq3x+egpB\/GISxTnwkrDwhNhhIJNyk5F4j1\\n\" +\n-            \"\/J8A0DANBgkqhkiG9w0BAQsFAAOCAQEAMGot6gBZ77HIDMb1n\/HPrKdSHN0ngq7Z\\n\" +\n-            \"rhrkgbp+mH1Cs1lZA3qldMDxKXgNiodFqU\/e4VewasQ9tJMmDXrTZIHualJGmIvq\\n\" +\n-            \"ISvV0ZUfSW\/sJmo0ZDw8iBM993LDkA4wSc6SunhjOwu3LBfl9aKkeq6IhUEAG8X7\\n\" +\n-            \"54oO4iApt+APLMyeV9lZ\/T7MGVbAjwdm+T1RMa\/Ca99BahaRWN7hiM+zS3Ly+l6G\\n\" +\n-            \"7kqAkBFuJWbbZImADZ2RPldY6hBzTk6MT2hLCV40UD8JqwJo+qq7nGfJdTaFyZI6\\n\" +\n-            \"nJvrVATO7jL64YFP3xlVi8EQaCeKdZdn+BCCNA\/ja0mWMj8EU9Islg==\\n\" +\n-            \"-----END CERTIFICATE-----\";\n-\n-    public void runTest(ValidatePathWithParams pathValidator) throws Exception {\n-        \/\/ Validate valid\n-        pathValidator.validate(new String[]{VALID, INT},\n-                ValidatePathWithParams.Status.GOOD, null, System.out);\n+    public void runTest() throws Exception {\n+        ValidatePathWithURL validatePathWithURL = new ValidatePathWithURL(CA_ALIAS);\n@@ -197,3 +67,2 @@\n-        \/\/ Validate Revoked\n-        pathValidator.validate(new String[]{REVOKED, INT},\n-                ValidatePathWithParams.Status.REVOKED, null, System.out);\n+        validatePathWithURL.validateDomain(VALID, false);\n+        validatePathWithURL.validateDomain(REVOKED, true);\n@@ -204,0 +73,3 @@\n+    private static final String VALID = \"https:\/\/valid.sfig2.catest.starfieldtech.com\/\";\n+    private static final String REVOKED = \"https:\/\/revoked.sfig2.catest.starfieldtech.com\/\";\n+    private static final String CA_ALIAS = \"starfieldrootg2ca [jdk]\";\n@@ -205,135 +77,2 @@\n-    \/\/ Owner: CN=Starfield Secure Certificate Authority - G2,\n-    \/\/ OU=http:\/\/certs.starfieldtech.com\/repository\/, O=\"Starfield Technologies, Inc.\",\n-    \/\/ L=Scottsdale, ST=Arizona, C=US\n-    \/\/ Issuer: CN=Starfield Root Certificate Authority - G2,\n-    \/\/ O=\"Starfield Technologies, Inc.\", L=Scottsdale, ST=Arizona, C=US\n-    private static final String INT = \"-----BEGIN CERTIFICATE-----\\n\"\n-            + \"MIIFADCCA+igAwIBAgIBBzANBgkqhkiG9w0BAQsFADCBjzELMAkGA1UEBhMCVVMx\\n\"\n-            + \"EDAOBgNVBAgTB0FyaXpvbmExEzARBgNVBAcTClNjb3R0c2RhbGUxJTAjBgNVBAoT\\n\"\n-            + \"HFN0YXJmaWVsZCBUZWNobm9sb2dpZXMsIEluYy4xMjAwBgNVBAMTKVN0YXJmaWVs\\n\"\n-            + \"ZCBSb290IENlcnRpZmljYXRlIEF1dGhvcml0eSAtIEcyMB4XDTExMDUwMzA3MDAw\\n\"\n-            + \"MFoXDTMxMDUwMzA3MDAwMFowgcYxCzAJBgNVBAYTAlVTMRAwDgYDVQQIEwdBcml6\\n\"\n-            + \"b25hMRMwEQYDVQQHEwpTY290dHNkYWxlMSUwIwYDVQQKExxTdGFyZmllbGQgVGVj\\n\"\n-            + \"aG5vbG9naWVzLCBJbmMuMTMwMQYDVQQLEypodHRwOi8vY2VydHMuc3RhcmZpZWxk\\n\"\n-            + \"dGVjaC5jb20vcmVwb3NpdG9yeS8xNDAyBgNVBAMTK1N0YXJmaWVsZCBTZWN1cmUg\\n\"\n-            + \"Q2VydGlmaWNhdGUgQXV0aG9yaXR5IC0gRzIwggEiMA0GCSqGSIb3DQEBAQUAA4IB\\n\"\n-            + \"DwAwggEKAoIBAQDlkGZL7PlGcakgg77pbL9KyUhpgXVObST2yxcT+LBxWYR6ayuF\\n\"\n-            + \"pDS1FuXLzOlBcCykLtb6Mn3hqN6UEKwxwcDYav9ZJ6t21vwLdGu4p64\/xFT0tDFE\\n\"\n-            + \"3ZNWjKRMXpuJyySDm+JXfbfYEh\/JhW300YDxUJuHrtQLEAX7J7oobRfpDtZNuTlV\\n\"\n-            + \"Bv8KJAV+L8YdcmzUiymMV33a2etmGtNPp99\/UsQwxaXJDgLFU793OGgGJMNmyDd+\\n\"\n-            + \"MB5FcSM1\/5DYKp2N57CSTTx\/KgqT3M0WRmX3YISLdkuRJ3MUkuDq7o8W6o0OPnYX\\n\"\n-            + \"v32JgIBEQ+ct4EMJddo26K3biTr1XRKOIwSDAgMBAAGjggEsMIIBKDAPBgNVHRMB\\n\"\n-            + \"Af8EBTADAQH\/MA4GA1UdDwEB\/wQEAwIBBjAdBgNVHQ4EFgQUJUWBaFAmOD07LSy+\\n\"\n-            + \"zWrZtj2zZmMwHwYDVR0jBBgwFoAUfAwyH6fZMH\/EfWijYqihzqsHWycwOgYIKwYB\\n\"\n-            + \"BQUHAQEELjAsMCoGCCsGAQUFBzABhh5odHRwOi8vb2NzcC5zdGFyZmllbGR0ZWNo\\n\"\n-            + \"LmNvbS8wOwYDVR0fBDQwMjAwoC6gLIYqaHR0cDovL2NybC5zdGFyZmllbGR0ZWNo\\n\"\n-            + \"LmNvbS9zZnJvb3QtZzIuY3JsMEwGA1UdIARFMEMwQQYEVR0gADA5MDcGCCsGAQUF\\n\"\n-            + \"BwIBFitodHRwczovL2NlcnRzLnN0YXJmaWVsZHRlY2guY29tL3JlcG9zaXRvcnkv\\n\"\n-            + \"MA0GCSqGSIb3DQEBCwUAA4IBAQBWZcr+8z8KqJOLGMfeQ2kTNCC+Tl94qGuc22pN\\n\"\n-            + \"QdvBE+zcMQAiXvcAngzgNGU0+bE6TkjIEoGIXFs+CFN69xpk37hQYcxTUUApS8L0\\n\"\n-            + \"rjpf5MqtJsxOYUPl\/VemN3DOQyuwlMOS6eFfqhBJt2nk4NAfZKQrzR9voPiEJBjO\\n\"\n-            + \"eT2pkb9UGBOJmVQRDVXFJgt5T1ocbvlj2xSApAer+rKluYjdkf5lO6Sjeb6JTeHQ\\n\"\n-            + \"sPTIFwwKlhR8Cbds4cLYVdQYoKpBaXAko7nv6VrcPuuUSvC33l8Odvr7+2kDRUBQ\\n\"\n-            + \"7nIMpBKGgc0T0U7EPMpODdIm8QC3tKai4W56gf0wrHofx1l7\\n\"\n-            + \"-----END CERTIFICATE-----\";\n-\n-    \/\/ 1.3.6.1.4.1.311.60.2.1.3=US\/1.3.6.1.4.1.311.60.2.1.2=Arizona\/businessCategory=Private\n-    \/\/ Organization\/serialNumber=R17247416, C=US, ST=Arizona, L=Scottsdale, O=Starfield Technologies, LLC,\n-    \/\/ CN=valid.sfig2.catest.starfieldtech.com\n-    private static final String VALID = \"-----BEGIN CERTIFICATE-----\\n\" +\n-            \"MIIHuzCCBqOgAwIBAgIIaZoUcUIjkGwwDQYJKoZIhvcNAQELBQAwgcYxCzAJBgNV\\n\" +\n-            \"BAYTAlVTMRAwDgYDVQQIEwdBcml6b25hMRMwEQYDVQQHEwpTY290dHNkYWxlMSUw\\n\" +\n-            \"IwYDVQQKExxTdGFyZmllbGQgVGVjaG5vbG9naWVzLCBJbmMuMTMwMQYDVQQLEypo\\n\" +\n-            \"dHRwOi8vY2VydHMuc3RhcmZpZWxkdGVjaC5jb20vcmVwb3NpdG9yeS8xNDAyBgNV\\n\" +\n-            \"BAMTK1N0YXJmaWVsZCBTZWN1cmUgQ2VydGlmaWNhdGUgQXV0aG9yaXR5IC0gRzIw\\n\" +\n-            \"HhcNMTcwOTE3MDM0ODAxWhcNMTkwOTE3MDM0ODAxWjCB6zETMBEGCysGAQQBgjc8\\n\" +\n-            \"AgEDEwJVUzEYMBYGCysGAQQBgjc8AgECEwdBcml6b25hMR0wGwYDVQQPExRQcml2\\n\" +\n-            \"YXRlIE9yZ2FuaXphdGlvbjESMBAGA1UEBRMJUjE3MjQ3NDE2MQswCQYDVQQGEwJV\\n\" +\n-            \"UzEQMA4GA1UECBMHQXJpem9uYTETMBEGA1UEBxMKU2NvdHRzZGFsZTEkMCIGA1UE\\n\" +\n-            \"ChMbU3RhcmZpZWxkIFRlY2hub2xvZ2llcywgTExDMS0wKwYDVQQDEyR2YWxpZC5z\\n\" +\n-            \"ZmlnMi5jYXRlc3Quc3RhcmZpZWxkdGVjaC5jb20wggEiMA0GCSqGSIb3DQEBAQUA\\n\" +\n-            \"A4IBDwAwggEKAoIBAQDVxhI45IQtNrJuun7HU8v2CKg\/h\/euysft2VrRsaGSMAln\\n\" +\n-            \"V6TtpWj2UGm7OmzE2NNzOhD9JJQSc1W6aHEsCTVJ148sgldFFmP39cboBFoLCFlJ\\n\" +\n-            \"DxsVGeyKu+KlDKq7Vp2+ty3TeFNOBXEVtEc8SsC8mVjsk2VWW7X\/fCVFYEzzyPUI\\n\" +\n-            \"sJPWahNOW2wVxNWKeW5jwzeNMOFVQiT9+YpZVQnV06uK3rPd9tVYU5SfdfPVpScY\\n\" +\n-            \"\/O\/tyZyflTGuXZ+YXn1CYRsOq3VypVFfhXunV5prQ\/vTnyjddVWce1wwoUT5DvFO\\n\" +\n-            \"\/0vcWolHktiOAJkmAiGRfHvjhxW8mkjKqaMnstKRAgMBAAGjggOEMIIDgDAMBgNV\\n\" +\n-            \"HRMBAf8EAjAAMB0GA1UdJQQWMBQGCCsGAQUFBwMBBggrBgEFBQcDAjAOBgNVHQ8B\\n\" +\n-            \"Af8EBAMCBaAwOwYDVR0fBDQwMjAwoC6gLIYqaHR0cDovL2NybC5zdGFyZmllbGR0\\n\" +\n-            \"ZWNoLmNvbS9zZmlnMnMzLTEuY3JsMGIGA1UdIARbMFkwTgYLYIZIAYb9bgEHFwMw\\n\" +\n-            \"PzA9BggrBgEFBQcCARYxaHR0cDovL2NlcnRpZmljYXRlcy5zdGFyZmllbGR0ZWNo\\n\" +\n-            \"LmNvbS9yZXBvc2l0b3J5LzAHBgVngQwBATCBggYIKwYBBQUHAQEEdjB0MCoGCCsG\\n\" +\n-            \"AQUFBzABhh5odHRwOi8vb2NzcC5zdGFyZmllbGR0ZWNoLmNvbS8wRgYIKwYBBQUH\\n\" +\n-            \"MAKGOmh0dHA6Ly9jZXJ0aWZpY2F0ZXMuc3RhcmZpZWxkdGVjaC5jb20vcmVwb3Np\\n\" +\n-            \"dG9yeS9zZmlnMi5jcnQwHwYDVR0jBBgwFoAUJUWBaFAmOD07LSy+zWrZtj2zZmMw\\n\" +\n-            \"WQYDVR0RBFIwUIIkdmFsaWQuc2ZpZzIuY2F0ZXN0LnN0YXJmaWVsZHRlY2guY29t\\n\" +\n-            \"gih3d3cudmFsaWQuc2ZpZzIuY2F0ZXN0LnN0YXJmaWVsZHRlY2guY29tMB0GA1Ud\\n\" +\n-            \"DgQWBBTxiYdHMn55sMWTFgp7xif7ludWTjCCAX4GCisGAQQB1nkCBAIEggFuBIIB\\n\" +\n-            \"agFoAHcAVhQGmi\/XwuzT9eG9RLI+x0Z2ubyZEVzA75SYVdaJ0N0AAAFejfR7OAAA\\n\" +\n-            \"BAMASDBGAiEA\/s7a5OGhtaCutT1l4KNE7dUbM3WGUExG\/ZJ+Y6IH3nUCIQCvpVJf\\n\" +\n-            \"Y0XBInIUv391hNzSEhv6nvIBEjZtKdvGcP8\/5QB2AO5Lvbd1zmC64UJpH6vhnmaj\\n\" +\n-            \"D35fsHLYgwDEe4l6qP3LAAABXo30fxEAAAQDAEcwRQIhANqG9yfi3ax0pTnwr4Ti\\n\" +\n-            \"wVfUrZclJDS06ePkTHppLkLTAiBTRKkVf1df4Irvmd7neT1wdS2fhDxmnVIYAN5J\\n\" +\n-            \"6tOGDQB1AKS5CZC0GFgUh7sTosxncAo8NZgE+RvfuON3zQ7IDdwQAAABXo30gFsA\\n\" +\n-            \"AAQDAEYwRAIgb8Xc54M+QD4wfSWLj5Ae\/wrSEgRp7Kbf4Lf4vT4W0usCIGAShkJI\\n\" +\n-            \"CRxoudQDRxooNJhfXgsTB8QhwFC9PUPo3ZV+MA0GCSqGSIb3DQEBCwUAA4IBAQBt\\n\" +\n-            \"TqvwxqrkPYm\/ssbN9cpVWlrQPw3DblsAEV6gnrrTJMd7HB042H3HLUiitddRjO40\\n\" +\n-            \"0EJM\/tUOSGcWfqnJHWFDKoWzdrF5lHAzSRkMjdXgY9TTN5K5tUMEpfRjtink\/zoY\\n\" +\n-            \"pNyc5ua4SXn94KfMZcOYGRvUM+0q6vLRBBMH541E3M6q6JbEBqZJFY8gBWwYqHH0\\n\" +\n-            \"xNGahm5++v4trFFCJzSfvfV1v+rnqy8tRivi7ZFLXWCcSyAqMH+T9Q36lKeFtaw4\\n\" +\n-            \"Sapf+dh2yrd2IBLW5eaAD13nCAjO\/W0GuC7zw4+4mhW5+DTVJXrCkK5XddkVLhML\\n\" +\n-            \"k5pMoIv5EsFIm0Cs+DfF\\n\" +\n-            \"-----END CERTIFICATE-----\";\n-\n-    \/\/ 1.3.6.1.4.1.311.60.2.1.3=US\/1.3.6.1.4.1.311.60.2.1.2=Arizona\/businessCategory=Private\n-    \/\/ Organization\/serialNumber=R17247416, C=US, ST=Arizona, L=Scottsdale, O=Starfield Technologies, LLC,\n-    \/\/ CN=revoked.sfig2.catest.starfieldtech.com\n-    private static final String REVOKED = \"-----BEGIN CERTIFICATE-----\\n\" +\n-            \"MIIHwTCCBqmgAwIBAgIJAPc1qVz+WDxpMA0GCSqGSIb3DQEBCwUAMIHGMQswCQYD\\n\" +\n-            \"VQQGEwJVUzEQMA4GA1UECBMHQXJpem9uYTETMBEGA1UEBxMKU2NvdHRzZGFsZTEl\\n\" +\n-            \"MCMGA1UEChMcU3RhcmZpZWxkIFRlY2hub2xvZ2llcywgSW5jLjEzMDEGA1UECxMq\\n\" +\n-            \"aHR0cDovL2NlcnRzLnN0YXJmaWVsZHRlY2guY29tL3JlcG9zaXRvcnkvMTQwMgYD\\n\" +\n-            \"VQQDEytTdGFyZmllbGQgU2VjdXJlIENlcnRpZmljYXRlIEF1dGhvcml0eSAtIEcy\\n\" +\n-            \"MB4XDTE3MDkxOTEzMDkwMVoXDTE5MDkxOTEzMDkwMVowge0xEzARBgsrBgEEAYI3\\n\" +\n-            \"PAIBAxMCVVMxGDAWBgsrBgEEAYI3PAIBAhMHQXJpem9uYTEdMBsGA1UEDxMUUHJp\\n\" +\n-            \"dmF0ZSBPcmdhbml6YXRpb24xEjAQBgNVBAUTCVIxNzI0NzQxNjELMAkGA1UEBhMC\\n\" +\n-            \"VVMxEDAOBgNVBAgTB0FyaXpvbmExEzARBgNVBAcTClNjb3R0c2RhbGUxJDAiBgNV\\n\" +\n-            \"BAoTG1N0YXJmaWVsZCBUZWNobm9sb2dpZXMsIExMQzEvMC0GA1UEAxMmcmV2b2tl\\n\" +\n-            \"ZC5zZmlnMi5jYXRlc3Quc3RhcmZpZWxkdGVjaC5jb20wggEiMA0GCSqGSIb3DQEB\\n\" +\n-            \"AQUAA4IBDwAwggEKAoIBAQCWsAZC9goWW6yzg9HiLjCG4Gv2PCHlUIQGqyhc1y9a\\n\" +\n-            \"YZVXUI27\/NhHjNNMTwP9TKmncrxnGaTZ9+ZCS1JlSgsNYQcLKKZW+SiEOzwpOfwV\\n\" +\n-            \"dOCSWrt\/EDyJHktx3VIbfi+mD7dvzH3B\/iGxMrmdCGIy3xiVAc7MkfsWzcLlPUP3\\n\" +\n-            \"oUpPBYyzWqZ2tVsBDigoirERFqZNfHZ7ZNMnn8FcmAt7udKjAAewNRlwzR7ZVp5s\\n\" +\n-            \"f5pbnRlRikF30msSHVJoPBICEYmzCxUI+zFlDBjf4vlJojwV0\/Rfq85it2yhN\/MV\\n\" +\n-            \"we2IBC+z9FAAogYo+JFw7Uxq8nsLCKX1tTPsqxGXWNonAgMBAAGjggOHMIIDgzAM\\n\" +\n-            \"BgNVHRMBAf8EAjAAMB0GA1UdJQQWMBQGCCsGAQUFBwMBBggrBgEFBQcDAjAOBgNV\\n\" +\n-            \"HQ8BAf8EBAMCBaAwOwYDVR0fBDQwMjAwoC6gLIYqaHR0cDovL2NybC5zdGFyZmll\\n\" +\n-            \"bGR0ZWNoLmNvbS9zZmlnMnMzLTEuY3JsMGIGA1UdIARbMFkwTgYLYIZIAYb9bgEH\\n\" +\n-            \"FwMwPzA9BggrBgEFBQcCARYxaHR0cDovL2NlcnRpZmljYXRlcy5zdGFyZmllbGR0\\n\" +\n-            \"ZWNoLmNvbS9yZXBvc2l0b3J5LzAHBgVngQwBATCBggYIKwYBBQUHAQEEdjB0MCoG\\n\" +\n-            \"CCsGAQUFBzABhh5odHRwOi8vb2NzcC5zdGFyZmllbGR0ZWNoLmNvbS8wRgYIKwYB\\n\" +\n-            \"BQUHMAKGOmh0dHA6Ly9jZXJ0aWZpY2F0ZXMuc3RhcmZpZWxkdGVjaC5jb20vcmVw\\n\" +\n-            \"b3NpdG9yeS9zZmlnMi5jcnQwHwYDVR0jBBgwFoAUJUWBaFAmOD07LSy+zWrZtj2z\\n\" +\n-            \"ZmMwXQYDVR0RBFYwVIImcmV2b2tlZC5zZmlnMi5jYXRlc3Quc3RhcmZpZWxkdGVj\\n\" +\n-            \"aC5jb22CKnd3dy5yZXZva2VkLnNmaWcyLmNhdGVzdC5zdGFyZmllbGR0ZWNoLmNv\\n\" +\n-            \"bTAdBgNVHQ4EFgQU9hCSl7QoQ8KdsGgwMDwlvSurKNcwggF9BgorBgEEAdZ5AgQC\\n\" +\n-            \"BIIBbQSCAWkBZwB1AFYUBpov18Ls0\/XhvUSyPsdGdrm8mRFcwO+UmFXWidDdAAAB\\n\" +\n-            \"XppC0cEAAAQDAEYwRAIgIO8sIG88JlA73P2myZ7EshemxaR8qBgf3wlYZpg5aZEC\\n\" +\n-            \"IGtlcUL7Il1uOLN0LTAzNTQ7pfb7oFYbr0R4LWe2ZvBIAHYA7ku9t3XOYLrhQmkf\\n\" +\n-            \"q+GeZqMPfl+wctiDAMR7iXqo\/csAAAFemkLVbwAABAMARzBFAiEAmWkzcotxZSwb\\n\" +\n-            \"xPS3MG13TVXGu2+MiXXjOIf42DR8zJQCIBL4cSOJh+LX5kpPub6KOiEOn7TVE1Zv\\n\" +\n-            \"IQUxuf+vyAD4AHYApLkJkLQYWBSHuxOizGdwCjw1mAT5G9+443fNDsgN3BAAAAFe\\n\" +\n-            \"mkLXRQAABAMARzBFAiBX8foh\/KrYr34O2c9cH6uyWW2XjBHNLsYX1mr+8VuNaAIh\\n\" +\n-            \"AObDQwpDYh\/bNp6k547gDxnR73LeU3kvl1Y76GjgxLAhMA0GCSqGSIb3DQEBCwUA\\n\" +\n-            \"A4IBAQDJ5vlagzOH8\/ORUMgT33muSDFXCe5el\/sQzVg8dridw9qjnxOpkGibdCiT\\n\" +\n-            \"b9Il1bdi7UnG8MlA3XpDjGgp6J\/mUTijD9WcFx4lp5JnPaIbShHWCyIlRVZJzrZc\\n\" +\n-            \"UYhR56xXOKDYKYOIvM6qTqegXyEynJrIVTArMk7jQf0oNQLLHzXE1fVS1zut0H5l\\n\" +\n-            \"GE+TBgjasMEa1o1e\/H\/heSytb2zFNsZr8oxojzGBmlKyfCoIIcCv3PxX2ur57zJE\\n\" +\n-            \"9ADWoYK\/7gYVba0JmLV4nQltDPp06nOYT9imxBWTrFahgPx1jOQDLgIpitkjyCy4\\n\" +\n-            \"xpmxUk8L6yc3O3aSD9OU\/fzk\/t\/d\\n\" +\n-            \"-----END CERTIFICATE-----\";\n-\n-    public void runTest(ValidatePathWithParams pathValidator) throws Exception {\n-        \/\/ Validate valid\n-        pathValidator.validate(new String[]{VALID, INT},\n-                ValidatePathWithParams.Status.GOOD, null, System.out);\n+    public void runTest() throws Exception {\n+        ValidatePathWithURL validatePathWithURL = new ValidatePathWithURL(CA_ALIAS);\n@@ -341,3 +80,2 @@\n-        \/\/ Validate Revoked\n-        pathValidator.validate(new String[]{REVOKED, INT},\n-                ValidatePathWithParams.Status.REVOKED, null, System.out);\n+        validatePathWithURL.validateDomain(VALID, false);\n+        validatePathWithURL.validateDomain(REVOKED, true);\n","filename":"test\/jdk\/security\/infra\/java\/security\/cert\/CertPathValidator\/certification\/GoDaddyCA.java","additions":30,"deletions":292,"binary":false,"changes":322,"status":"modified"},{"patch":"@@ -25,1 +25,1 @@\n- * @test\n+ * @test id=OCSP\n@@ -28,1 +28,3 @@\n- * @build ValidatePathWithParams\n+ * @library \/test\/lib\n+ * @build jtreg.SkippedException\n+ * @build ValidatePathWithURL\n@@ -30,0 +32,9 @@\n+ *\/\n+\n+\/*\n+ * @test id=CRL\n+ * @bug 8307134\n+ * @summary Interoperability tests with Google's GlobalSign R4 and GTS Root certificates\n+ * @library \/test\/lib\n+ * @build jtreg.SkippedException\n+ * @build ValidatePathWithURL\n@@ -42,3 +53,0 @@\n-        ValidatePathWithParams pathValidator = new ValidatePathWithParams(null);\n-        boolean ocspEnabled = false;\n-\n@@ -46,1 +54,1 @@\n-            pathValidator.enableCRLCheck();\n+            ValidatePathWithURL.enableCRLOnly();\n@@ -49,2 +57,1 @@\n-            pathValidator.enableOCSPCheck();\n-            ocspEnabled = true;\n+            ValidatePathWithURL.enableOCSPOnly();\n@@ -53,5 +60,5 @@\n-        new GoogleGSR4().runTest(pathValidator);\n-        new GoogleGTSR1().runTest(pathValidator);\n-        new GoogleGTSR2().runTest(pathValidator);\n-        new GoogleGTSR3().runTest(pathValidator);\n-        new GoogleGTSR4().runTest(pathValidator);\n+        new GoogleGSR4().runTest();\n+        new GoogleGTSR1().runTest();\n+        new GoogleGTSR2().runTest();\n+        new GoogleGTSR3().runTest();\n+        new GoogleGTSR4().runTest();\n@@ -62,0 +69,3 @@\n+    private static final String VALID = \"https:\/\/good.gsr4.demo.pki.goog\/\";\n+    private static final String REVOKED = \"https:\/\/revoked.gsr4.demo.pki.goog\/\";\n+    private static final String CA_ALIAS = \"globalsigneccrootcar4 [jdk]\";\n@@ -63,23 +73,2 @@\n-    \/\/ Owner: CN=GTS CA 2D4, O=Google Trust Services LLC, C=US\n-    \/\/ Issuer: CN=GlobalSign, O=GlobalSign, OU=GlobalSign ECC Root CA - R4\n-    \/\/ Serial number: 21668f1cd0a2a8f847d8aad34\n-    \/\/ Valid from: Tue Oct 04 17:00:42 PDT 2022 until: Wed Sep 29 17:00:42 PDT 2027\n-    private static final String INT = \"-----BEGIN CERTIFICATE-----\\n\" +\n-            \"MIIDBDCCAqugAwIBAgINAhZo8c0KKo+EfYqtNDAKBggqhkjOPQQDAjBQMSQwIgYD\\n\" +\n-            \"VQQLExtHbG9iYWxTaWduIEVDQyBSb290IENBIC0gUjQxEzARBgNVBAoTCkdsb2Jh\\n\" +\n-            \"bFNpZ24xEzARBgNVBAMTCkdsb2JhbFNpZ24wHhcNMjIxMDA1MDAwMDQyWhcNMjcw\\n\" +\n-            \"OTMwMDAwMDQyWjBGMQswCQYDVQQGEwJVUzEiMCAGA1UEChMZR29vZ2xlIFRydXN0\\n\" +\n-            \"IFNlcnZpY2VzIExMQzETMBEGA1UEAxMKR1RTIENBIDJENDBZMBMGByqGSM49AgEG\\n\" +\n-            \"CCqGSM49AwEHA0IABPQdCdV61990MPueGTVpXAjRmp2JIxt0Yuy59RZYT\/XKg1lN\\n\" +\n-            \"gpRc0eh\/bHtpehigtqe+llKTiVEkMhSMURoQQsOjggFyMIIBbjAOBgNVHQ8BAf8E\\n\" +\n-            \"BAMCAYYwHQYDVR0lBBYwFAYIKwYBBQUHAwEGCCsGAQUFBwMCMBIGA1UdEwEB\/wQI\\n\" +\n-            \"MAYBAf8CAQAwHQYDVR0OBBYEFKiI2Yo5rGXVgks3qJVsZUPNRAHgMB8GA1UdIwQY\\n\" +\n-            \"MBaAFFSwe61FuOJAf\/sKbvu+M8k8o4TVMGYGCCsGAQUFBwEBBFowWDAlBggrBgEF\\n\" +\n-            \"BQcwAYYZaHR0cDovL29jc3AucGtpLmdvb2cvZ3NyNDAvBggrBgEFBQcwAoYjaHR0\\n\" +\n-            \"cDovL3BraS5nb29nL3JlcG8vY2VydHMvZ3NyNC5kZXIwMgYDVR0fBCswKTAnoCWg\\n\" +\n-            \"I4YhaHR0cDovL2NybC5wa2kuZ29vZy9nc3I0L2dzcjQuY3JsME0GA1UdIARGMEQw\\n\" +\n-            \"CAYGZ4EMAQIBMDgGCisGAQQB1nkCBQMwKjAoBggrBgEFBQcCARYcaHR0cHM6Ly9w\\n\" +\n-            \"a2kuZ29vZy9yZXBvc2l0b3J5LzAKBggqhkjOPQQDAgNHADBEAiBi+ikli1YBHQGs\\n\" +\n-            \"b5mnyBo5mydw04o386BPgaPpiBzgagIgbcpwQJCalLIekv8XRMoWFr3nV5XJfWRU\\n\" +\n-            \"5QPpOX0rXbg=\\n\" +\n-            \"-----END CERTIFICATE-----\";\n+    public void runTest() throws Exception {\n+        ValidatePathWithURL validatePathWithURL = new ValidatePathWithURL(CA_ALIAS);\n@@ -87,75 +76,2 @@\n-    \/\/ Owner: CN=good.gsr4.demo.pki.goog\n-    \/\/ Issuer: CN=GTS CA 2D4, O=Google Trust Services LLC, C=US\n-    \/\/ Serial number: 4c435754ee6e013c10efaff908a58cbb\n-    \/\/ Valid from: Mon Mar 27 12:41:45 PDT 2023 until: Sun Jun 25 12:41:44 PDT 2023\n-    private static final String VALID = \"-----BEGIN CERTIFICATE-----\\n\" +\n-            \"MIIEsTCCBFegAwIBAgIQTENXVO5uATwQ76\/5CKWMuzAKBggqhkjOPQQDAjBGMQsw\\n\" +\n-            \"CQYDVQQGEwJVUzEiMCAGA1UEChMZR29vZ2xlIFRydXN0IFNlcnZpY2VzIExMQzET\\n\" +\n-            \"MBEGA1UEAxMKR1RTIENBIDJENDAeFw0yMzAzMjcxOTQxNDVaFw0yMzA2MjUxOTQx\\n\" +\n-            \"NDRaMCIxIDAeBgNVBAMTF2dvb2QuZ3NyNC5kZW1vLnBraS5nb29nMIIBIjANBgkq\\n\" +\n-            \"hkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAymtcnnxJ8pSF4YJUKTWKcHbRw28ShLzo\\n\" +\n-            \"KVTRPUsRrZZDqyDx296k3e0D04kBhcvEduxtEabCe89m06SH7L+bGVi25j35AXwn\\n\" +\n-            \"6aziLs\/EV4BRy9ACfYipeT5PnQbaMmVe65q\/RYKmWqD\/z0SEh2uMFxRVl1CBmS\/J\\n\" +\n-            \"owbNUlrEEDiYkE\/nGfCmacpW0QZ7kxGjSR34mCSDugIYE\/HME3ZVcZOVf2LT0lBA\\n\" +\n-            \"DhQtZI6cXy2lO8Ro\/dUtcZKjo8iu0xW1pQeiJq9+CGp62MJFmpl+EfzP\/B8aXQiF\\n\" +\n-            \"+m44LJJgAjiShAwVo9HbJUYv0dqCS9G22FL43xXqAdDlWZeuZyg7bQIDAQABo4IC\\n\" +\n-            \"fjCCAnowDgYDVR0PAQH\/BAQDAgWgMBMGA1UdJQQMMAoGCCsGAQUFBwMBMAwGA1Ud\\n\" +\n-            \"EwEB\/wQCMAAwHQYDVR0OBBYEFKMuYkTnbWyrTBfBqbNNe91z3GPjMB8GA1UdIwQY\\n\" +\n-            \"MBaAFKiI2Yo5rGXVgks3qJVsZUPNRAHgMHgGCCsGAQUFBwEBBGwwajA1BggrBgEF\\n\" +\n-            \"BQcwAYYpaHR0cDovL29jc3AucGtpLmdvb2cvcy9ndHMyZDQvS2tnczU5VFFIelkw\\n\" +\n-            \"MQYIKwYBBQUHMAKGJWh0dHA6Ly9wa2kuZ29vZy9yZXBvL2NlcnRzL2d0czJkNC5k\\n\" +\n-            \"ZXIwIgYDVR0RBBswGYIXZ29vZC5nc3I0LmRlbW8ucGtpLmdvb2cwIQYDVR0gBBow\\n\" +\n-            \"GDAIBgZngQwBAgEwDAYKKwYBBAHWeQIFAzA8BgNVHR8ENTAzMDGgL6AthitodHRw\\n\" +\n-            \"Oi8vY3Jscy5wa2kuZ29vZy9ndHMyZDQvSUlXMzNMVUVwV3cuY3JsMIIBBAYKKwYB\\n\" +\n-            \"BAHWeQIEAgSB9QSB8gDwAHcA6D7Q2j71BjUy51covIlryQPTy9ERa+zraeF3fW0G\\n\" +\n-            \"vW4AAAGHJM62ygAABAMASDBGAiEAkeiqmfYYCVEmGA12\/RJUZPdmxRP2ZXF0Xm30\\n\" +\n-            \"Oz+q2tgCIQCgSYqT\/6RH+PCOauOVW4uaoshT+HfqurghVCzwGgBFvwB1ALc++yTf\\n\" +\n-            \"nE26dfI5xbpY9Gxd\/ELPep81xJ4dCYEl7bSZAAABhyTOttoAAAQDAEYwRAIgBXao\\n\" +\n-            \"3Pry1nCHu3bngW3q3CHSLzmNHmO4cXMSdN2sAOkCIDE5DUyok3TRsOIHu1QTB0R2\\n\" +\n-            \"UxPeFm9KS73TBT8JEZykMAoGCCqGSM49BAMCA0gAMEUCIG1m91VOq3tghyLPA6YR\\n\" +\n-            \"\/Pkq+gQylyM8wGJgnRMRE0lhAiEAxBgYXImtVqbfymq2MYwhV9KmG9gPIfqN6qWi\\n\" +\n-            \"lzblUM0=\\n\" +\n-            \"-----END CERTIFICATE-----\";\n-\n-    \/\/ Owner: CN=revoked.gsr4.demo.pki.goog\n-    \/\/ Issuer: CN=GTS CA 2D4, O=Google Trust Services LLC, C=US\n-    \/\/ Serial number: 1f9bd55e26716b3710b2614cec6fff02\n-    \/\/ Valid from: Mon Mar 27 12:48:37 PDT 2023 until: Sun Jun 25 12:48:36 PDT 2023\n-    private static final String REVOKED = \"-----BEGIN CERTIFICATE-----\\n\" +\n-            \"MIIEtzCCBFygAwIBAgIQH5vVXiZxazcQsmFM7G\/\/AjAKBggqhkjOPQQDAjBGMQsw\\n\" +\n-            \"CQYDVQQGEwJVUzEiMCAGA1UEChMZR29vZ2xlIFRydXN0IFNlcnZpY2VzIExMQzET\\n\" +\n-            \"MBEGA1UEAxMKR1RTIENBIDJENDAeFw0yMzAzMjcxOTQ4MzdaFw0yMzA2MjUxOTQ4\\n\" +\n-            \"MzZaMCUxIzAhBgNVBAMTGnJldm9rZWQuZ3NyNC5kZW1vLnBraS5nb29nMIIBIjAN\\n\" +\n-            \"BgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEApVuoZ\/bS9c2WSQ8W1FjPEsdGoANj\\n\" +\n-            \"PqKaPwdyUhnko9ayyGGi5hHLYqir2tiNjfO8i5e3ybe6CIaybY37SQebquV+rioH\\n\" +\n-            \"O9BS75GgtYXCaMK\/8prya9RiaUjy7kecvpKtJNiaXrLJy8Vzq9g39n9hiXJYMGkc\\n\" +\n-            \"fCWYjWd5jU4pAsYTslmuIYoIZuwRRX34iET6Brs3ijykcmYtG5F90wqFlvRxRh0x\\n\" +\n-            \"vD0EeTOLGZSDQMYxlhfrqG449I10iTHusSxI2AXB6k7N2UXMJ44D7Z3RWkv1ItsY\\n\" +\n-            \"eKVXQyLAYd8YYTFNdGa75SoRr+ChFbLCgSUMg188T\/SS013bH\/XSHpCbQQIDAQAB\\n\" +\n-            \"o4ICgDCCAnwwDgYDVR0PAQH\/BAQDAgWgMBMGA1UdJQQMMAoGCCsGAQUFBwMBMAwG\\n\" +\n-            \"A1UdEwEB\/wQCMAAwHQYDVR0OBBYEFLXeKzKKPx+Vs7YEKdmz9Vur9BZiMB8GA1Ud\\n\" +\n-            \"IwQYMBaAFKiI2Yo5rGXVgks3qJVsZUPNRAHgMHgGCCsGAQUFBwEBBGwwajA1Bggr\\n\" +\n-            \"BgEFBQcwAYYpaHR0cDovL29jc3AucGtpLmdvb2cvcy9ndHMyZDQvaG5fZHY1dHlS\\n\" +\n-            \"SVkwMQYIKwYBBQUHMAKGJWh0dHA6Ly9wa2kuZ29vZy9yZXBvL2NlcnRzL2d0czJk\\n\" +\n-            \"NC5kZXIwJQYDVR0RBB4wHIIacmV2b2tlZC5nc3I0LmRlbW8ucGtpLmdvb2cwIQYD\\n\" +\n-            \"VR0gBBowGDAIBgZngQwBAgEwDAYKKwYBBAHWeQIFAzA8BgNVHR8ENTAzMDGgL6At\\n\" +\n-            \"hitodHRwOi8vY3Jscy5wa2kuZ29vZy9ndHMyZDQvSUlXMzNMVUVwV3cuY3JsMIIB\\n\" +\n-            \"AwYKKwYBBAHWeQIEAgSB9ASB8QDvAHYAejKMVNi3LbYg6jjgUh7phBZwMhOFTTvS\\n\" +\n-            \"K8E6V6NS61IAAAGHJNUx1gAABAMARzBFAiEAj\/RgXx1ScnsOf9R9N3eyPMJtH33C\\n\" +\n-            \"mOrRCOodG8QXmE0CIHwNJC5E53BVmfMzZwJH9f2BiUx31SGHWFvG283zVtX\/AHUA\\n\" +\n-            \"6D7Q2j71BjUy51covIlryQPTy9ERa+zraeF3fW0GvW4AAAGHJNUxnAAABAMARjBE\\n\" +\n-            \"AiAI7pcrKatsz0G4QYPKmS74VQVEgnHqgKSoqv0ghTJXTgIgPyoYubz4MEHYirBu\\n\" +\n-            \"69BLC2jioXr8+wS7MK1IPqjdH44wCgYIKoZIzj0EAwIDSQAwRgIhAI4NdZ5JwTuW\\n\" +\n-            \"P+RH2bsAc5xrb804G9mOc3WMRVxTUKesAiEA\/jHMJ2YdPv0WXKjKY7nUyFjUPdin\\n\" +\n-            \"BHRHfBeltynaFzU=\\n\" +\n-            \"-----END CERTIFICATE-----\";\n-\n-    public void runTest(ValidatePathWithParams pathValidator) throws Exception {\n-        \/\/ Validate valid\n-        pathValidator.validate(new String[]{VALID, INT},\n-                ValidatePathWithParams.Status.GOOD, null, System.out);\n-\n-        \/\/ Validate Revoked\n-        pathValidator.validate(new String[]{REVOKED, INT},\n-                ValidatePathWithParams.Status.REVOKED,\n-                \"Mon Mar 27 13:49:33 PDT 2023\", System.out);\n+        validatePathWithURL.validateDomain(VALID, false);\n+        validatePathWithURL.validateDomain(REVOKED, true);\n@@ -166,0 +82,3 @@\n+    private static final String VALID = \"https:\/\/good.gtsr1.demo.pki.goog\/\";\n+    private static final String REVOKED = \"https:\/\/revoked.gtsr1.demo.pki.goog\/\";\n+    private static final String CA_ALIAS = \"gtsrootcar1 [jdk]\";\n@@ -167,110 +86,2 @@\n-    \/\/ Owner: CN=GTS CA 1D4, O=Google Trust Services LLC, C=US\n-    \/\/ Issuer: CN=GTS Root R1, O=Google Trust Services LLC, C=US\n-    \/\/ Serial number: 2008eb2023336658b64cddb9b\n-    \/\/ Valid from: Wed Aug 12 17:00:42 PDT 2020 until: Wed Sep 29 17:00:42 PDT 2027\n-    private static final String INT = \"-----BEGIN CERTIFICATE-----\\n\" +\n-            \"MIIFjDCCA3SgAwIBAgINAgCOsgIzNmWLZM3bmzANBgkqhkiG9w0BAQsFADBHMQsw\\n\" +\n-            \"CQYDVQQGEwJVUzEiMCAGA1UEChMZR29vZ2xlIFRydXN0IFNlcnZpY2VzIExMQzEU\\n\" +\n-            \"MBIGA1UEAxMLR1RTIFJvb3QgUjEwHhcNMjAwODEzMDAwMDQyWhcNMjcwOTMwMDAw\\n\" +\n-            \"MDQyWjBGMQswCQYDVQQGEwJVUzEiMCAGA1UEChMZR29vZ2xlIFRydXN0IFNlcnZp\\n\" +\n-            \"Y2VzIExMQzETMBEGA1UEAxMKR1RTIENBIDFENDCCASIwDQYJKoZIhvcNAQEBBQAD\\n\" +\n-            \"ggEPADCCAQoCggEBAKvAqqPCE27l0w9zC8dTPIE89bA+xTmDaG7y7VfQ4c+mOWhl\\n\" +\n-            \"UebUQpK0yv2r678RJExK0HWDjeq+nLIHN1Em5j6rARZixmyRSjhIR0KOQPGBMUld\\n\" +\n-            \"saztIIJ7O0g\/82qj\/vGDl\/\/3t4tTqxiRhLQnTLXJdeB+2DhkdU6IIgx6wN7E5NcU\\n\" +\n-            \"H3Rcsejcqj8p5Sj19vBm6i1FhqLGymhMFroWVUGO3xtIH91dsgy4eFKcfKVLWK3o\\n\" +\n-            \"2190Q0Lm\/SiKmLbRJ5Au4y1euFJm2JM9eB84Fkqa3ivrXWUeVtye0CQdKvsY2Fka\\n\" +\n-            \"zvxtxvusLJzLWYHk55zcRAacDA2SeEtBbQfD1qsCAwEAAaOCAXYwggFyMA4GA1Ud\\n\" +\n-            \"DwEB\/wQEAwIBhjAdBgNVHSUEFjAUBggrBgEFBQcDAQYIKwYBBQUHAwIwEgYDVR0T\\n\" +\n-            \"AQH\/BAgwBgEB\/wIBADAdBgNVHQ4EFgQUJeIYDrJXkZQq5dRdhpCD3lOzuJIwHwYD\\n\" +\n-            \"VR0jBBgwFoAU5K8rJnEaK0gnhS9SZizv8IkTcT4waAYIKwYBBQUHAQEEXDBaMCYG\\n\" +\n-            \"CCsGAQUFBzABhhpodHRwOi8vb2NzcC5wa2kuZ29vZy9ndHNyMTAwBggrBgEFBQcw\\n\" +\n-            \"AoYkaHR0cDovL3BraS5nb29nL3JlcG8vY2VydHMvZ3RzcjEuZGVyMDQGA1UdHwQt\\n\" +\n-            \"MCswKaAnoCWGI2h0dHA6Ly9jcmwucGtpLmdvb2cvZ3RzcjEvZ3RzcjEuY3JsME0G\\n\" +\n-            \"A1UdIARGMEQwCAYGZ4EMAQIBMDgGCisGAQQB1nkCBQMwKjAoBggrBgEFBQcCARYc\\n\" +\n-            \"aHR0cHM6Ly9wa2kuZ29vZy9yZXBvc2l0b3J5LzANBgkqhkiG9w0BAQsFAAOCAgEA\\n\" +\n-            \"IVToy24jwXUr0rAPc924vuSVbKQuYw3nLflLfLh5AYWEeVl\/Du18QAWUMdcJ6o\/q\\n\" +\n-            \"FZbhXkBH0PNcw97thaf2BeoDYY9Ck\/b+UGluhx06zd4EBf7H9P84nnrwpR+4GBDZ\\n\" +\n-            \"K+Xh3I0tqJy2rgOqNDflr5IMQ8ZTWA3yltakzSBKZ6XpF0PpqyCRvp\/NCGv2KX2T\\n\" +\n-            \"uPCJvscp1\/m2pVTtyBjYPRQ+QuCQGAJKjtN7R5DFrfTqMWvYgVlpCJBkwlu7+7KY\\n\" +\n-            \"3cTIfzE7cmALskMKNLuDz+RzCcsYTsVaU7Vp3xL60OYhqFkuAOOxDZ6pHOj9+OJm\\n\" +\n-            \"YgPmOT4X3+7L51fXJyRH9KfLRP6nT31D5nmsGAOgZ26\/8T9hsBW1uo9ju5fZLZXV\\n\" +\n-            \"VS5H0HyIBMEKyGMIPhFWrlt\/hFS28N1zaKI0ZBGD3gYgDLbiDT9fGXstpk+Fmc4o\\n\" +\n-            \"lVlWPzXe81vdoEnFbr5M272HdgJWo+WhT9BYM0Ji+wdVmnRffXgloEoluTNcWzc4\\n\" +\n-            \"1dFpgJu8fF3LG0gl2ibSYiCi9a6hvU0TppjJyIWXhkJTcMJlPrWx1VytEUGrX2l0\\n\" +\n-            \"JDwRjW\/656r0KVB02xHRKvm2ZKI03TglLIpmVCK3kBKkKNpBNkFt8rhafcCKOb9J\\n\" +\n-            \"x\/9tpNFlQTl7B39rJlJWkR17QnZqVptFePFORoZmFzM=\\n\" +\n-            \"-----END CERTIFICATE-----\";\n-\n-    \/\/ Owner: CN=good.gtsr1.demo.pki.goog\n-    \/\/ Issuer: CN=GTS CA 1D4, O=Google Trust Services LLC, C=US\n-    \/\/ Serial number: 19c08d5cde41fc84108f54c8d2a1aeca\n-    \/\/ Valid from: Mon Mar 27 12:33:43 PDT 2023 until: Sun Jun 25 12:33:42 PDT 2023\n-    private static final String VALID = \"-----BEGIN CERTIFICATE-----\\n\" +\n-            \"MIIFcjCCBFqgAwIBAgIQGcCNXN5B\/IQQj1TI0qGuyjANBgkqhkiG9w0BAQsFADBG\\n\" +\n-            \"MQswCQYDVQQGEwJVUzEiMCAGA1UEChMZR29vZ2xlIFRydXN0IFNlcnZpY2VzIExM\\n\" +\n-            \"QzETMBEGA1UEAxMKR1RTIENBIDFENDAeFw0yMzAzMjcxOTMzNDNaFw0yMzA2MjUx\\n\" +\n-            \"OTMzNDJaMCMxITAfBgNVBAMTGGdvb2QuZ3RzcjEuZGVtby5wa2kuZ29vZzCCASIw\\n\" +\n-            \"DQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBAMkOYhMM6kQMlep+l2\/l5KTC1ow8\\n\" +\n-            \"nXHwXQzugR2Js302pM3p2UCfnfhlK0a9UUSVtAZa8ydVUyVRF9LzW1rOIK8UdlEj\\n\" +\n-            \"O6qAvPnPw8laY7rCPWRPibxu0OqL\/5sYD+a4hQ7GhVsYDXXxnWQvLV5mppRlYF\/8\\n\" +\n-            \"80ugGggRb+U3y6V84f1JnwSMvZFULe19BOeV5qWAHHFfgy0zePzcDMy8AqxaVBOb\\n\" +\n-            \"FVSsbdql2gnRyC4WZ9D5lc8vwS84KrJbce2+VtrpcKVALtyVA0Zzor2lr2wOVc4i\\n\" +\n-            \"OOwMNk9948eStAjOV8N4B1h9D\/pd+cFSWfgXufr5ZClwijLr3zLvZxDGI6ECAwEA\\n\" +\n-            \"AaOCAn0wggJ5MA4GA1UdDwEB\/wQEAwIFoDATBgNVHSUEDDAKBggrBgEFBQcDATAM\\n\" +\n-            \"BgNVHRMBAf8EAjAAMB0GA1UdDgQWBBSTKR+0ebWnH3uGz5qju5\/LpkCjYzAfBgNV\\n\" +\n-            \"HSMEGDAWgBQl4hgOsleRlCrl1F2GkIPeU7O4kjB4BggrBgEFBQcBAQRsMGowNQYI\\n\" +\n-            \"KwYBBQUHMAGGKWh0dHA6Ly9vY3NwLnBraS5nb29nL3MvZ3RzMWQ0L3B6OThKdFZT\\n\" +\n-            \"RnRjMDEGCCsGAQUFBzAChiVodHRwOi8vcGtpLmdvb2cvcmVwby9jZXJ0cy9ndHMx\\n\" +\n-            \"ZDQuZGVyMCMGA1UdEQQcMBqCGGdvb2QuZ3RzcjEuZGVtby5wa2kuZ29vZzAhBgNV\\n\" +\n-            \"HSAEGjAYMAgGBmeBDAECATAMBgorBgEEAdZ5AgUDMDwGA1UdHwQ1MDMwMaAvoC2G\\n\" +\n-            \"K2h0dHA6Ly9jcmxzLnBraS5nb29nL2d0czFkNC92My1EUW1sYi1ZWS5jcmwwggEC\\n\" +\n-            \"BgorBgEEAdZ5AgQCBIHzBIHwAO4AdQC3Pvsk35xNunXyOcW6WPRsXfxCz3qfNcSe\\n\" +\n-            \"HQmBJe20mQAAAYckx1OMAAAEAwBGMEQCICQ4Do1cKFsqmm\/swKZkdM\/qGluDbctL\\n\" +\n-            \"tIgp0YnoZTlEAiByAeAEaVQiU27AnpUerimnjPnThQq26vqvnWdstb0mwgB1AK33\\n\" +\n-            \"vvp8\/xDIi509nB4+GGq0Zyldz7EMJMqFhjTr3IKKAAABhyTHU7UAAAQDAEYwRAIg\\n\" +\n-            \"WAIAOov42kcgOj0rYO3qb4\/HTsW3o69x4IKd8ycsaVkCICIQUaeKwNp4aW\/civO9\\n\" +\n-            \"No\/v5Ner5bmlwheqFAJcR\/HCMA0GCSqGSIb3DQEBCwUAA4IBAQBEKKdwuzuAhdir\\n\" +\n-            \"3hbPQIosD6H9vatr8tExWCDmw+PHOoiWIUTBu5fVZPQ27EgehTIA6kNhQj2g7fkF\\n\" +\n-            \"Bd5zAl4k7WdsDZCeOHml6XXQZHvc+p4DYBKTTt3h81lsMLw8aWCOaiSmrQ0hZS\/E\\n\" +\n-            \"iuaqvlOFpOTd0x+MN2qcU14hi8SKxBgpraqR\/s7OCwUFltxcPq0GAybzDGc9lgB+\\n\" +\n-            \"Jt56QviN641s7hxThyGhFIHSePgWuwbT1grJKQiSW35yI4PJO90HoCpd2MLrC5Ic\\n\" +\n-            \"B89ykY8mQcx+naGPZQdwdpx9GvKwSZdn+cq3kZwD66iXnwhqmiEdq4eBZr8ygSya\\n\" +\n-            \"lnGV2OW+\\n\" +\n-            \"-----END CERTIFICATE-----\";\n-\n-    \/\/ Owner: CN=revoked.gtsr1.demo.pki.goog\n-    \/\/ Issuer: CN=GTS CA 1D4, O=Google Trust Services LLC, C=US\n-    \/\/ Serial number: c414c34e6c2cc66c102b8d3502be3bb4\n-    \/\/ Valid from: Mon Mar 27 12:42:39 PDT 2023 until: Sun Jun 25 12:42:38 PDT 2023\n-    private static final String REVOKED = \"-----BEGIN CERTIFICATE-----\\n\" +\n-            \"MIIFfDCCBGSgAwIBAgIRAMQUw05sLMZsECuNNQK+O7QwDQYJKoZIhvcNAQELBQAw\\n\" +\n-            \"RjELMAkGA1UEBhMCVVMxIjAgBgNVBAoTGUdvb2dsZSBUcnVzdCBTZXJ2aWNlcyBM\\n\" +\n-            \"TEMxEzARBgNVBAMTCkdUUyBDQSAxRDQwHhcNMjMwMzI3MTk0MjM5WhcNMjMwNjI1\\n\" +\n-            \"MTk0MjM4WjAmMSQwIgYDVQQDExtyZXZva2VkLmd0c3IxLmRlbW8ucGtpLmdvb2cw\\n\" +\n-            \"ggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQCOeL80aphh8K8Cz41Sl2Cv\\n\" +\n-            \"cI3Elrrm\/2sQH5Q0nxNuoZcxTGk3hD75Ntf6eqgclUQXJDEGbfoo3q7kYIQPXEIy\\n\" +\n-            \"+AuiMTd80ZRHuPBp8ci\/wkh6N7B9mE\/rjzJz77QgJluykoXRx9SiDyE4Yn9sRbBH\\n\" +\n-            \"jNm\/KBv8wMV6hzJZYaALyDpGVNuAx9cHE91LaSvamPiccJn4wb9zDtyFduS3yYbz\\n\" +\n-            \"FREt960j420TeHjeWFkuXXVQMnPeRAWugclhJKzLz1U1gm5PWGxThMgVIy0v8v63\\n\" +\n-            \"3qFT09I4avi0AzBaRtINCaS39Mo2AoX1jZNjFDNLzRO1fSSJpzJmWyXJ2jRI7MwF\\n\" +\n-            \"AgMBAAGjggKDMIICfzAOBgNVHQ8BAf8EBAMCBaAwEwYDVR0lBAwwCgYIKwYBBQUH\\n\" +\n-            \"AwEwDAYDVR0TAQH\/BAIwADAdBgNVHQ4EFgQUCuJDEKGIdbWqxyVFZmIZoyQZ4T4w\\n\" +\n-            \"HwYDVR0jBBgwFoAUJeIYDrJXkZQq5dRdhpCD3lOzuJIweAYIKwYBBQUHAQEEbDBq\\n\" +\n-            \"MDUGCCsGAQUFBzABhilodHRwOi8vb2NzcC5wa2kuZ29vZy9zL2d0czFkNC9rb2Zm\\n\" +\n-            \"cmFBODZBdzAxBggrBgEFBQcwAoYlaHR0cDovL3BraS5nb29nL3JlcG8vY2VydHMv\\n\" +\n-            \"Z3RzMWQ0LmRlcjAmBgNVHREEHzAdghtyZXZva2VkLmd0c3IxLmRlbW8ucGtpLmdv\\n\" +\n-            \"b2cwIQYDVR0gBBowGDAIBgZngQwBAgEwDAYKKwYBBAHWeQIFAzA8BgNVHR8ENTAz\\n\" +\n-            \"MDGgL6AthitodHRwOi8vY3Jscy5wa2kuZ29vZy9ndHMxZDQvODJFckFFQVVsR1ku\\n\" +\n-            \"Y3JsMIIBBQYKKwYBBAHWeQIEAgSB9gSB8wDxAHYArfe++nz\/EMiLnT2cHj4YarRn\\n\" +\n-            \"KV3PsQwkyoWGNOvcgooAAAGHJM+cawAABAMARzBFAiB568monxGD3NiHsqNmsy+t\\n\" +\n-            \"IL4kCc71UNCCJthgnlL7HgIhAKSYf7P7CFO2wWdAt8LBMrsLoip9lytrinj0JR8R\\n\" +\n-            \"CYK9AHcAtz77JN+cTbp18jnFulj0bF38Qs96nzXEnh0JgSXttJkAAAGHJM+cZAAA\\n\" +\n-            \"BAMASDBGAiEAj8nBf1ihput8Gb8qCqVgvqAxPv9t4xLVhWg3tqv8gGMCIQDPiNbu\\n\" +\n-            \"vsyOi9nE6pDm86nggExXRa13wwCtr2wjAn5IpDANBgkqhkiG9w0BAQsFAAOCAQEA\\n\" +\n-            \"ezldM\/NCUH58eXPZnbPaMMKrT5oNBxv+hypDy96+PyAqKtbC2bK+7sobGMZkfpG5\\n\" +\n-            \"8dW0mFmfazzjgbZUj54ZVHG4KaHeit8Nq1s07wh2Jo1c2JQdKxEXAOItax\/IOfEd\\n\" +\n-            \"tqSg8AwSmhogQeiA7EXRspw4dYXL5uP\/8jPPqByMI3PRmm3y7wyQLKNlNAfSgn7m\\n\" +\n-            \"wkrZxMRAENML4JND5UKxg7zo9e\/Wvf4UPtEVVZaEj6ZxOe4JljvErCtayaw03t5p\\n\" +\n-            \"I18IAhXRpqm8JG1UGWjn49O8vkjB0bf\/7iVXXI4rg6gGVia+HFuxKVGk5OQzo4Qd\\n\" +\n-            \"wBl6yOc8tpUH3phFPYbiMg==\\n\" +\n-            \"-----END CERTIFICATE-----\";\n+    public void runTest() throws Exception {\n+        ValidatePathWithURL validatePathWithURL = new ValidatePathWithURL(CA_ALIAS);\n@@ -278,9 +89,2 @@\n-    public void runTest(ValidatePathWithParams pathValidator) throws Exception {\n-        \/\/ Validate valid\n-        pathValidator.validate(new String[]{VALID, INT},\n-                ValidatePathWithParams.Status.GOOD, null, System.out);\n-\n-        \/\/ Validate Revoked\n-        pathValidator.validate(new String[]{REVOKED, INT},\n-                ValidatePathWithParams.Status.REVOKED,\n-                \"Mon Mar 27 13:43:25 PDT 2023\", System.out);\n+        validatePathWithURL.validateDomain(VALID, false);\n+        validatePathWithURL.validateDomain(REVOKED, true);\n@@ -291,0 +95,3 @@\n+    private static final String VALID = \"https:\/\/good.gtsr2.demo.pki.goog\/\";\n+    private static final String REVOKED = \"https:\/\/revoked.gtsr2.demo.pki.goog\/\";\n+    private static final String CA_ALIAS = \"gtsrootcar2 [jdk]\";\n@@ -292,110 +99,2 @@\n-    \/\/ Owner: CN=GTS CA 1D8, O=Google Trust Services LLC, C=US\n-    \/\/ Issuer: CN=GTS Root R2, O=Google Trust Services LLC, C=US\n-    \/\/ Serial number: 219c15ac025a1b0a5c1d9d501\n-    \/\/ Valid from: Tue Oct 04 17:00:42 PDT 2022 until: Wed Sep 29 17:00:42 PDT 2027\n-    private static final String INT = \"-----BEGIN CERTIFICATE-----\\n\" +\n-            \"MIIFjDCCA3SgAwIBAgINAhnBWsAlobClwdnVATANBgkqhkiG9w0BAQsFADBHMQsw\\n\" +\n-            \"CQYDVQQGEwJVUzEiMCAGA1UEChMZR29vZ2xlIFRydXN0IFNlcnZpY2VzIExMQzEU\\n\" +\n-            \"MBIGA1UEAxMLR1RTIFJvb3QgUjIwHhcNMjIxMDA1MDAwMDQyWhcNMjcwOTMwMDAw\\n\" +\n-            \"MDQyWjBGMQswCQYDVQQGEwJVUzEiMCAGA1UEChMZR29vZ2xlIFRydXN0IFNlcnZp\\n\" +\n-            \"Y2VzIExMQzETMBEGA1UEAxMKR1RTIENBIDFEODCCASIwDQYJKoZIhvcNAQEBBQAD\\n\" +\n-            \"ggEPADCCAQoCggEBAKgpBAgi9bhOp5nCIELI\/W+1rMoxNH3isu2LuDI3pPEPYJ0o\\n\" +\n-            \"YDxXB1zKHvUqn1VWDlF+K4vLPzjTRv2MUw8fHH9IAd\/Rx+mrUHUxffTPU5O41tPj\\n\" +\n-            \"OdzFRO+FOr5RqZfbtXWbEUNyv7wyyCYr9gaDvDeQgDnHTfHAafdoDracNLm2LS3r\\n\" +\n-            \"8iznvJltsboRm+fBwTH99nHciN\/h\/hHEWlRriUGZ+Cz+5YVB9Tm4gAOByyYYbAa4\\n\" +\n-            \"ES0PhzkIUHaq+56cTDVhK0DM5ZtnZJqV8amhBFssswPttAXT9pNCzoDLCtxeZ2Lw\\n\" +\n-            \"r7bcaGaDcuDmv4j8zAw3BOR73O0Xk1VcBYPBBUcCAwEAAaOCAXYwggFyMA4GA1Ud\\n\" +\n-            \"DwEB\/wQEAwIBhjAdBgNVHSUEFjAUBggrBgEFBQcDAQYIKwYBBQUHAwIwEgYDVR0T\\n\" +\n-            \"AQH\/BAgwBgEB\/wIBADAdBgNVHQ4EFgQUkPhQ+ueQJcnkJ30S3UdY53QPtmowHwYD\\n\" +\n-            \"VR0jBBgwFoAUu\/\/KjiOfT5nK2+JopqUVJxce2Q4waAYIKwYBBQUHAQEEXDBaMCYG\\n\" +\n-            \"CCsGAQUFBzABhhpodHRwOi8vb2NzcC5wa2kuZ29vZy9ndHNyMjAwBggrBgEFBQcw\\n\" +\n-            \"AoYkaHR0cDovL3BraS5nb29nL3JlcG8vY2VydHMvZ3RzcjIuZGVyMDQGA1UdHwQt\\n\" +\n-            \"MCswKaAnoCWGI2h0dHA6Ly9jcmwucGtpLmdvb2cvZ3RzcjIvZ3RzcjIuY3JsME0G\\n\" +\n-            \"A1UdIARGMEQwCAYGZ4EMAQIBMDgGCisGAQQB1nkCBQMwKjAoBggrBgEFBQcCARYc\\n\" +\n-            \"aHR0cHM6Ly9wa2kuZ29vZy9yZXBvc2l0b3J5LzANBgkqhkiG9w0BAQsFAAOCAgEA\\n\" +\n-            \"q3rJUW9syti3qkV5WNXCpJj2WoCptfxOdIrojT4Q1CIGzruFu4GXB8pfkJu7iU8k\\n\" +\n-            \"Aklel6RCn7MG\/aI12ndmvUsW86e6UJDWEMz1CsQPA92AOsktAVXiGVDx3RAiPfP2\\n\" +\n-            \"9W9yNwlImSVZhGNQISC0SueK7QOv+mHHWE\/7G0G0\/YqAxMbVZzyrPYHfPUh0SD1g\\n\" +\n-            \"k7qYjq9hGJB7w7cfepZ2iPdKzlj\/4aFOe04gho1zHMLJYIs03nb6uWg0AwX55SSu\\n\" +\n-            \"KvehoYs1ItHdEV1J2XfATZpCn6jMTEB\/JYERbXW0VWLUhdaZORtaayQoU5YXbgvg\\n\" +\n-            \"bsPgqdIsPaxs\/Chrp6zIKvs503YYcvs0GQSUQ1MFAWc+Loc39669T7WnL8Uu2yCO\\n\" +\n-            \"RxjFp3+fhTVA5UYwL1vy4wPnNUoa4+CA6JypT6ODUWcXZa8pWOdyHpbg0IeL389D\\n\" +\n-            \"s67kirG8\/eKQxFzckbhL5AD8BJS3wkF7O7A8Gd+2VvSWhmEQzzOBHcvT\/lqrCSe0\\n\" +\n-            \"7R7CV\/Pw4E9C2GBLGfw8opxGXrdfJRjU6nHf5c+tC4xIjH\/i3PQjaIFLG3D60mav\\n\" +\n-            \"0nkS92iorZl2dCiHTKxaD\/J4B6VV03lpEcUdVg4WeGAmTClsXUnMOjCnlVYMLg9v\\n\" +\n-            \"URq0LbylxbGBelBrCNyqBS5UO6+9F4\/Yi4vzoIvvbJ0=\\n\" +\n-            \"-----END CERTIFICATE-----\";\n-\n-    \/\/ Owner: CN=good.gtsr2.demo.pki.goog\n-    \/\/ Issuer: CN=GTS CA 1D8, O=Google Trust Services LLC, C=US\n-    \/\/ Serial number: 428fe99edb0df46e1008e4452f6cbfd2\n-    \/\/ Valid from: Mon Mar 27 12:52:12 PDT 2023 until: Sun Jun 25 12:52:11 PDT 2023\n-    private static final String VALID = \"-----BEGIN CERTIFICATE-----\\n\" +\n-            \"MIIFdDCCBFygAwIBAgIQQo\/pntsN9G4QCORFL2y\/0jANBgkqhkiG9w0BAQsFADBG\\n\" +\n-            \"MQswCQYDVQQGEwJVUzEiMCAGA1UEChMZR29vZ2xlIFRydXN0IFNlcnZpY2VzIExM\\n\" +\n-            \"QzETMBEGA1UEAxMKR1RTIENBIDFEODAeFw0yMzAzMjcxOTUyMTJaFw0yMzA2MjUx\\n\" +\n-            \"OTUyMTFaMCMxITAfBgNVBAMTGGdvb2QuZ3RzcjIuZGVtby5wa2kuZ29vZzCCASIw\\n\" +\n-            \"DQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBAMaC0h20vohsggOQ0XGL5ca3Gqyf\\n\" +\n-            \"2n44PhYBrhzPpbq9\/Mk9BKYYFy9osH0HwTFkYRYnI5fDeK6s\/7svufiEwH8LtXK7\\n\" +\n-            \"A3juxf3k65cJ8M5bbBwDDW7Prgp86ueUd6pzqv23rLPc9Kv6vvtNYzgaTd4COU38\\n\" +\n-            \"3zFnuudAh8gvEbIQD+Nqis+kc4kEO3JfZBlAF883YRQZRpm6c4bWxKm1Atco53\/6\\n\" +\n-            \"fYOota\/XUgdJ8zQWOH1f9iaKX3kiDn76djxT9v\/8MrcK2gRkHJJDo72HtCPuhdt8\\n\" +\n-            \"UkVLX4C3KF6eSUrgZ1gxA92ikAWxI4tn5D70yEffH0A7by0\/b\/C6uPMvXCECAwEA\\n\" +\n-            \"AaOCAn8wggJ7MA4GA1UdDwEB\/wQEAwIFoDATBgNVHSUEDDAKBggrBgEFBQcDATAM\\n\" +\n-            \"BgNVHRMBAf8EAjAAMB0GA1UdDgQWBBTegr5Cc+1LmL\/c1H3sXVKufKZE8DAfBgNV\\n\" +\n-            \"HSMEGDAWgBSQ+FD655AlyeQnfRLdR1jndA+2ajB4BggrBgEFBQcBAQRsMGowNQYI\\n\" +\n-            \"KwYBBQUHMAGGKWh0dHA6Ly9vY3NwLnBraS5nb29nL3MvZ3RzMWQ4L0FoZFdDWF9D\\n\" +\n-            \"QUJFMDEGCCsGAQUFBzAChiVodHRwOi8vcGtpLmdvb2cvcmVwby9jZXJ0cy9ndHMx\\n\" +\n-            \"ZDguZGVyMCMGA1UdEQQcMBqCGGdvb2QuZ3RzcjIuZGVtby5wa2kuZ29vZzAhBgNV\\n\" +\n-            \"HSAEGjAYMAgGBmeBDAECATAMBgorBgEEAdZ5AgUDMDwGA1UdHwQ1MDMwMaAvoC2G\\n\" +\n-            \"K2h0dHA6Ly9jcmxzLnBraS5nb29nL2d0czFkOC8tME5ITHA5Y0w5US5jcmwwggEE\\n\" +\n-            \"BgorBgEEAdZ5AgQCBIH1BIHyAPAAdgB6MoxU2LcttiDqOOBSHumEFnAyE4VNO9Ir\\n\" +\n-            \"wTpXo1LrUgAAAYck2PpFAAAEAwBHMEUCIAznUI2WdAkwXBvnx0a8Io6hnZReoXsd\\n\" +\n-            \"Y+o+xpXqZsbbAiEAw\/i7jWA43QWEMZz265nflCNxAS1W+s7nsZaKL512\/S8AdgDo\\n\" +\n-            \"PtDaPvUGNTLnVyi8iWvJA9PL0RFr7Otp4Xd9bQa9bgAAAYck2PoBAAAEAwBHMEUC\\n\" +\n-            \"IHWqRE57W1pJJJAXrxFNMrjEO3f0YejAfi47mdyS1zJYAiEA4ye+achvGTYIMRnl\\n\" +\n-            \"jwBlTsYQQYt7KAVt2VAGMRB4H8kwDQYJKoZIhvcNAQELBQADggEBAGf9hz7NJRow\\n\" +\n-            \"veCSrfeVav2tDkx8s9VU7VD+lApip1mdqOGsqkCkeaA5hsGfhqleQFwsOAjduBFA\\n\" +\n-            \"nSV6KgiqFsgHSuS9zuSp2aVe8xhxq6mpr4LngkeUDc32mB9tW9AMaiYp8UeYyFGq\\n\" +\n-            \"hvjUb7\/H2wFlT6qO+Qp\/+hmfulKqNnrSzpZLIl+x2EBn3L6CFe5xaKzNaANgbShI\\n\" +\n-            \"cQsyKdaUrSAzNJZWnHwaAyQ1msqqXXoVzKmjAGMgZrXZNxv8Lh9V1v+F9WHDIjeQ\\n\" +\n-            \"TtahntIgq38eGtZAnyjdrUtfQwBlQI3zaE0n7n6Fq8ocglJE5woRlL\/eTmSKiZr9\\n\" +\n-            \"rrEY0sJ0fCw=\\n\" +\n-            \"-----END CERTIFICATE-----\";\n-\n-    \/\/ Owner: CN=revoked.gtsr2.demo.pki.goog\n-    \/\/ Issuer: CN=GTS CA 1D8, O=Google Trust Services LLC, C=US\n-    \/\/ Serial number: df9af5c19e9dbdf6107cb03548ffbd06\n-    \/\/ Valid from: Mon Mar 27 12:45:09 PDT 2023 until: Sun Jun 25 12:45:08 PDT 2023\n-    private static final String REVOKED = \"-----BEGIN CERTIFICATE-----\\n\" +\n-            \"MIIFejCCBGKgAwIBAgIRAN+a9cGenb32EHywNUj\/vQYwDQYJKoZIhvcNAQELBQAw\\n\" +\n-            \"RjELMAkGA1UEBhMCVVMxIjAgBgNVBAoTGUdvb2dsZSBUcnVzdCBTZXJ2aWNlcyBM\\n\" +\n-            \"TEMxEzARBgNVBAMTCkdUUyBDQSAxRDgwHhcNMjMwMzI3MTk0NTA5WhcNMjMwNjI1\\n\" +\n-            \"MTk0NTA4WjAmMSQwIgYDVQQDExtyZXZva2VkLmd0c3IyLmRlbW8ucGtpLmdvb2cw\\n\" +\n-            \"ggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQDFJUSh0aOOjj6BXJqBFDOD\\n\" +\n-            \"GFjnr1VKDfWYdGWfB3QNhcbjz7qJRLeZDSYQZ3H2D5pkOQhl6xYLOZ1L0v+0TWW9\\n\" +\n-            \"5lCXQ476jdZXzPlOC29gYFX4VzS9w92ochg0dUhHdzKcWsqBjqChZdudGydYfwNS\\n\" +\n-            \"edZIhd4AcamVsXbCqAhS01Evo2hiBRlmMgryR9Ok2xRqbJiyvd8awhBIB4L0vMN+\\n\" +\n-            \"CgMpWMgaV1nn+LjEa3bHisyNVsRLdDZXY6Bgq3hUQ9jQWJdK\/vGxHqunqC5ByrqG\\n\" +\n-            \"iN+4\/+kK\/PS8okkpAEAOXFoohogb6BQASMRgO\/l50Mz8B24NGgWVLlWdaNysgU8f\\n\" +\n-            \"AgMBAAGjggKBMIICfTAOBgNVHQ8BAf8EBAMCBaAwEwYDVR0lBAwwCgYIKwYBBQUH\\n\" +\n-            \"AwEwDAYDVR0TAQH\/BAIwADAdBgNVHQ4EFgQUh\/wMqf9pabUzGDoQvsyHVaT1rjAw\\n\" +\n-            \"HwYDVR0jBBgwFoAUkPhQ+ueQJcnkJ30S3UdY53QPtmoweAYIKwYBBQUHAQEEbDBq\\n\" +\n-            \"MDUGCCsGAQUFBzABhilodHRwOi8vb2NzcC5wa2kuZ29vZy9zL2d0czFkOC9CdWF6\\n\" +\n-            \"OFdQMnoybzAxBggrBgEFBQcwAoYlaHR0cDovL3BraS5nb29nL3JlcG8vY2VydHMv\\n\" +\n-            \"Z3RzMWQ4LmRlcjAmBgNVHREEHzAdghtyZXZva2VkLmd0c3IyLmRlbW8ucGtpLmdv\\n\" +\n-            \"b2cwIQYDVR0gBBowGDAIBgZngQwBAgEwDAYKKwYBBAHWeQIFAzA8BgNVHR8ENTAz\\n\" +\n-            \"MDGgL6AthitodHRwOi8vY3Jscy5wa2kuZ29vZy9ndHMxZDgvLTBOSExwOWNMOVEu\\n\" +\n-            \"Y3JsMIIBAwYKKwYBBAHWeQIEAgSB9ASB8QDvAHYAejKMVNi3LbYg6jjgUh7phBZw\\n\" +\n-            \"MhOFTTvSK8E6V6NS61IAAAGHJNGpywAABAMARzBFAiEApXndD34BJ3oOCLvGoa5f\\n\" +\n-            \"Xu0P6t4yf1pdCQONuLTSrX4CIDMp1N5\/VKjClXqE\/t2xux3mvJH2ceVECID4B69v\\n\" +\n-            \"WfOhAHUA6D7Q2j71BjUy51covIlryQPTy9ERa+zraeF3fW0GvW4AAAGHJNGphwAA\\n\" +\n-            \"BAMARjBEAiBa5aSnTCc2ceQj\/asKFYRRGbwzXTnaDbvNMMeB4ogEXAIgZykyJVPh\\n\" +\n-            \"4Sfkroi8tvV6dwxexp0dT2EXHAmr+\/GzZU0wDQYJKoZIhvcNAQELBQADggEBAHVn\\n\" +\n-            \"uWbk\/OaljXKeyhlDCgdvnzJGCFQXwGyIJzNDkCs8k3iA1iwJKArvpkczxnCBxCPE\\n\" +\n-            \"imW2MHWCayT9JXKuO4ppU0oTh6GYvRV6DV1OkuWXsna7+dGf3+tkm9k0wauI6J8X\\n\" +\n-            \"H1T8Dq3W0+S+8UNSftduYSR1wTcN15OxIzlZ\/FrV3LLRDxH2RKSsXfXBLgP1befh\\n\" +\n-            \"m+8SPQTpZ5NdMl7my0gmVgNF5ZIbFiHYzJkF2vS4iXJCI6fTWyoA1u\/7jQyHdLOy\\n\" +\n-            \"pY0s6gKWEwwtpYC1lWI6ek\/wLfuNrJbiRRiRs8e3HHQymn8K3T1PM+7n8huDy95b\\n\" +\n-            \"f1EgLMjvEtx6xpIqrqg=\\n\" +\n-            \"-----END CERTIFICATE-----\";\n+    public void runTest() throws Exception {\n+        ValidatePathWithURL validatePathWithURL = new ValidatePathWithURL(CA_ALIAS);\n@@ -403,9 +102,2 @@\n-    public void runTest(ValidatePathWithParams pathValidator) throws Exception {\n-        \/\/ Validate valid\n-        pathValidator.validate(new String[]{VALID, INT},\n-                ValidatePathWithParams.Status.GOOD, null, System.out);\n-\n-        \/\/ Validate Revoked\n-        pathValidator.validate(new String[]{REVOKED, INT},\n-                ValidatePathWithParams.Status.REVOKED,\n-                \"Mon Mar 27 13:45:40 PDT 2023\", System.out);\n+        validatePathWithURL.validateDomain(VALID, false);\n+        validatePathWithURL.validateDomain(REVOKED, true);\n@@ -416,0 +108,3 @@\n+    private static final String VALID = \"https:\/\/good.gtsr3.demo.pki.goog\/\";\n+    private static final String REVOKED = \"https:\/\/revoked.gtsr3.demo.pki.goog\/\";\n+    private static final String CA_ALIAS = \"gtsrootecccar3 [jdk]\";\n@@ -417,56 +112,2 @@\n-    \/\/ Owner: CN=GTS CA 2D3, O=Google Trust Services LLC, C=US\n-    \/\/ Issuer: CN=GTS Root R3, O=Google Trust Services LLC, C=US\n-    \/\/ Serial number: 21668d8d65bc4320e5b8e5e76\n-    \/\/ Valid from: Tue Oct 04 17:00:42 PDT 2022 until: Wed Sep 29 17:00:42 PDT 2027\n-    private static final String INT = \"-----BEGIN CERTIFICATE-----\\n\" +\n-            \"MIIDIDCCAqagAwIBAgINAhZo2NZbxDIOW45edjAKBggqhkjOPQQDAzBHMQswCQYD\\n\" +\n-            \"VQQGEwJVUzEiMCAGA1UEChMZR29vZ2xlIFRydXN0IFNlcnZpY2VzIExMQzEUMBIG\\n\" +\n-            \"A1UEAxMLR1RTIFJvb3QgUjMwHhcNMjIxMDA1MDAwMDQyWhcNMjcwOTMwMDAwMDQy\\n\" +\n-            \"WjBGMQswCQYDVQQGEwJVUzEiMCAGA1UEChMZR29vZ2xlIFRydXN0IFNlcnZpY2Vz\\n\" +\n-            \"IExMQzETMBEGA1UEAxMKR1RTIENBIDJEMzBZMBMGByqGSM49AgEGCCqGSM49AwEH\\n\" +\n-            \"A0IABGQQXn8LoR0OtyBn+KkEav3utA7WFBgWEb\/8bXVlW6xJLTZJIC04lsNmNKWJ\\n\" +\n-            \"P\/fwHYfrZcx1o4vvOUTO9OD\/7pijggF2MIIBcjAOBgNVHQ8BAf8EBAMCAYYwHQYD\\n\" +\n-            \"VR0lBBYwFAYIKwYBBQUHAwEGCCsGAQUFBwMCMBIGA1UdEwEB\/wQIMAYBAf8CAQAw\\n\" +\n-            \"HQYDVR0OBBYEFL+pU78badiFKTSaaUPL1nrUmf9tMB8GA1UdIwQYMBaAFMHxJrqg\\n\" +\n-            \"La6Fgc\/T8SoSvbgKZ\/28MGgGCCsGAQUFBwEBBFwwWjAmBggrBgEFBQcwAYYaaHR0\\n\" +\n-            \"cDovL29jc3AucGtpLmdvb2cvZ3RzcjMwMAYIKwYBBQUHMAKGJGh0dHA6Ly9wa2ku\\n\" +\n-            \"Z29vZy9yZXBvL2NlcnRzL2d0c3IzLmRlcjA0BgNVHR8ELTArMCmgJ6AlhiNodHRw\\n\" +\n-            \"Oi8vY3JsLnBraS5nb29nL2d0c3IzL2d0c3IzLmNybDBNBgNVHSAERjBEMAgGBmeB\\n\" +\n-            \"DAECATA4BgorBgEEAdZ5AgUDMCowKAYIKwYBBQUHAgEWHGh0dHBzOi8vcGtpLmdv\\n\" +\n-            \"b2cvcmVwb3NpdG9yeS8wCgYIKoZIzj0EAwMDaAAwZQIxAO3wG4U11INX3hl2UyCn\\n\" +\n-            \"0A\/upBaO+BBzX1OiQx7UfmMXc65kqkdIcNzZc6G6EWnNVAIwBG0LuIKWXfYc+Wbk\\n\" +\n-            \"STfMvwatUvd6QjdIKsYF0e8Hiaav+hLI0DzOuJcDPFtfYIyY\\n\" +\n-            \"-----END CERTIFICATE-----\";\n-\n-    \/\/ Owner: CN=good.gtsr3.demo.pki.goog\n-    \/\/ Issuer: CN=GTS CA 2D3, O=Google Trust Services LLC, C=US\n-    \/\/ Serial number: 7d08ad6716e51d1210bfc149e3d0af19\n-    \/\/ Valid from: Mon Mar 27 12:37:41 PDT 2023 until: Sun Jun 25 12:37:40 PDT 2023\n-    private static final String VALID = \"-----BEGIN CERTIFICATE-----\\n\" +\n-            \"MIIEszCCBFmgAwIBAgIQfQitZxblHRIQv8FJ49CvGTAKBggqhkjOPQQDAjBGMQsw\\n\" +\n-            \"CQYDVQQGEwJVUzEiMCAGA1UEChMZR29vZ2xlIFRydXN0IFNlcnZpY2VzIExMQzET\\n\" +\n-            \"MBEGA1UEAxMKR1RTIENBIDJEMzAeFw0yMzAzMjcxOTM3NDFaFw0yMzA2MjUxOTM3\\n\" +\n-            \"NDBaMCMxITAfBgNVBAMTGGdvb2QuZ3RzcjMuZGVtby5wa2kuZ29vZzCCASIwDQYJ\\n\" +\n-            \"KoZIhvcNAQEBBQADggEPADCCAQoCggEBAL7R40feuILVPC65FhoVh3kZ8mJuEKpJ\\n\" +\n-            \"SiSB9gbKRkaKBr4kHOm7+sa0RkAm3Zgbomd2JGiJbYYcQ4lY8MMlXruFLLY+0AMf\\n\" +\n-            \"Pf5mQbn6i+oSyfaNwV0Hk1q1MhZL5WSKLywXS0NVw50JGQw\/SiIRhmR22DdOtxuh\\n\" +\n-            \"VC7ZOebYTbHzTBSYTxvoyJZ0bGUQMWQ0rI2lzOp+2kqSTDMmRejXUNm14ZrsdXUb\\n\" +\n-            \"F8nOunZpT5ppESFvsK7TFrWJlAFHNVxJjPkNaRyfIaR7G+hORoV5tHGaNeTzmFkO\\n\" +\n-            \"3ySGcRlvL41IWqBN4LwLiS6QN+Je7nIBDojEPTBVhPCzP++1uLKEKusCAwEAAaOC\\n\" +\n-            \"An8wggJ7MA4GA1UdDwEB\/wQEAwIFoDATBgNVHSUEDDAKBggrBgEFBQcDATAMBgNV\\n\" +\n-            \"HRMBAf8EAjAAMB0GA1UdDgQWBBRRhq17jer1cVfi0eFV+LIwk+Lk8jAfBgNVHSME\\n\" +\n-            \"GDAWgBS\/qVO\/G2nYhSk0mmlDy9Z61Jn\/bTB4BggrBgEFBQcBAQRsMGowNQYIKwYB\\n\" +\n-            \"BQUHMAGGKWh0dHA6Ly9vY3NwLnBraS5nb29nL3MvZ3RzMmQzL09KOENlY2cwdWNV\\n\" +\n-            \"MDEGCCsGAQUFBzAChiVodHRwOi8vcGtpLmdvb2cvcmVwby9jZXJ0cy9ndHMyZDMu\\n\" +\n-            \"ZGVyMCMGA1UdEQQcMBqCGGdvb2QuZ3RzcjMuZGVtby5wa2kuZ29vZzAhBgNVHSAE\\n\" +\n-            \"GjAYMAgGBmeBDAECATAMBgorBgEEAdZ5AgUDMDwGA1UdHwQ1MDMwMaAvoC2GK2h0\\n\" +\n-            \"dHA6Ly9jcmxzLnBraS5nb29nL2d0czJkMy9WREItNVdJSTVRSS5jcmwwggEEBgor\\n\" +\n-            \"BgEEAdZ5AgQCBIH1BIHyAPAAdgDoPtDaPvUGNTLnVyi8iWvJA9PL0RFr7Otp4Xd9\\n\" +\n-            \"bQa9bgAAAYckzOfmAAAEAwBHMEUCIF0wxIlFnHLMan20Gtbnia+mzuA1Re0dhoIS\\n\" +\n-            \"wOAO7aC4AiEA7cYfSflOAA0DLxHsHAXpVs2LuLYlq34bSxbyUa85UyYAdgCzc3cH\\n\" +\n-            \"4YRQ+GOG1gWp3BEJSnktsWcMC4fc8AMOeTalmgAAAYckzOf5AAAEAwBHMEUCICza\\n\" +\n-            \"2nef9GWr9tF\/ZXxhMYP15JQsdWPWmpQkdS\/xUBWyAiEAs9AaeMarT7EaBVoSatAT\\n\" +\n-            \"Poj6cOhdvF\/uDOHigyQdVd8wCgYIKoZIzj0EAwIDSAAwRQIhALv6jaEFgAIe3NbX\\n\" +\n-            \"87YEjhMMymK7wl435DQD9syoOEx2AiBbcYXr6nLNWA1pPoRiA1WvHgTVJFWftpYt\\n\" +\n-            \"e8CkUXnIxA==\\n\" +\n-            \"-----END CERTIFICATE-----\";\n+    public void runTest() throws Exception {\n+        ValidatePathWithURL validatePathWithURL = new ValidatePathWithURL(CA_ALIAS);\n@@ -474,42 +115,2 @@\n-    \/\/ Owner: CN=revoked.gtsr3.demo.pki.goog\n-    \/\/ Issuer: CN=GTS CA 2D3, O=Google Trust Services LLC, C=US\n-    \/\/ Serial number: 7ffa6a827df64c6010ebc47b5ca3eda7\n-    \/\/ Valid from: Mon Mar 27 12:45:58 PDT 2023 until: Sun Jun 25 12:45:57 PDT 2023\n-    private static final String REVOKED = \"-----BEGIN CERTIFICATE-----\\n\" +\n-            \"MIIEuTCCBF+gAwIBAgIQf\/pqgn32TGAQ68R7XKPtpzAKBggqhkjOPQQDAjBGMQsw\\n\" +\n-            \"CQYDVQQGEwJVUzEiMCAGA1UEChMZR29vZ2xlIFRydXN0IFNlcnZpY2VzIExMQzET\\n\" +\n-            \"MBEGA1UEAxMKR1RTIENBIDJEMzAeFw0yMzAzMjcxOTQ1NThaFw0yMzA2MjUxOTQ1\\n\" +\n-            \"NTdaMCYxJDAiBgNVBAMTG3Jldm9rZWQuZ3RzcjMuZGVtby5wa2kuZ29vZzCCASIw\\n\" +\n-            \"DQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBAKpn78KglifqiS3f5hPLH64og4aH\\n\" +\n-            \"7a1tDBza2ebTLYB74i1u65EIENCyzvz6OYvh8kKzhqZMPFbORd8OCESzebjv\/Dc2\\n\" +\n-            \"BJJV498N3BfSZYWN+baVxKuOZ4HWXV5NyP85rEvbcaAWcmqvh++G88FOCTQvYd4D\\n\" +\n-            \"\/RKgAMptDjM+4X6V2NIRXcmOZJWZ2iItao76FARvbKH0D2UJLG4ENdOznRonnItP\\n\" +\n-            \"74UEVfNCb\/i7I+NMJYTuDA4\/rr+AS6pttvsVM9pqWkIJqOloEVNcCyyr1buflfJO\\n\" +\n-            \"j4A8Nz9fTUffpfApQnPi394iUcdCVyCrcjB2ta2eMR\/3AyhiSXOmxcGjUcECAwEA\\n\" +\n-            \"AaOCAoIwggJ+MA4GA1UdDwEB\/wQEAwIFoDATBgNVHSUEDDAKBggrBgEFBQcDATAM\\n\" +\n-            \"BgNVHRMBAf8EAjAAMB0GA1UdDgQWBBSg57WFIkW4b1eTcWX+qZsN+JEewTAfBgNV\\n\" +\n-            \"HSMEGDAWgBS\/qVO\/G2nYhSk0mmlDy9Z61Jn\/bTB4BggrBgEFBQcBAQRsMGowNQYI\\n\" +\n-            \"KwYBBQUHMAGGKWh0dHA6Ly9vY3NwLnBraS5nb29nL3MvZ3RzMmQzL1pEZWExWTdT\\n\" +\n-            \"SlBZMDEGCCsGAQUFBzAChiVodHRwOi8vcGtpLmdvb2cvcmVwby9jZXJ0cy9ndHMy\\n\" +\n-            \"ZDMuZGVyMCYGA1UdEQQfMB2CG3Jldm9rZWQuZ3RzcjMuZGVtby5wa2kuZ29vZzAh\\n\" +\n-            \"BgNVHSAEGjAYMAgGBmeBDAECATAMBgorBgEEAdZ5AgUDMDwGA1UdHwQ1MDMwMaAv\\n\" +\n-            \"oC2GK2h0dHA6Ly9jcmxzLnBraS5nb29nL2d0czJkMy9WREItNVdJSTVRSS5jcmww\\n\" +\n-            \"ggEEBgorBgEEAdZ5AgQCBIH1BIHyAPAAdQDoPtDaPvUGNTLnVyi8iWvJA9PL0RFr\\n\" +\n-            \"7Otp4Xd9bQa9bgAAAYck00MJAAAEAwBGMEQCIALwbMReWy\/zrvUwV1G5XOxN8koN\\n\" +\n-            \"VJ1pp7s1d7ClE9ebAiBYWwJeccnfHLIh9AJTdeuN+R\/pDzEudVBSC2rIdo3HhgB3\\n\" +\n-            \"ALc++yTfnE26dfI5xbpY9Gxd\/ELPep81xJ4dCYEl7bSZAAABhyTTQzMAAAQDAEgw\\n\" +\n-            \"RgIhAOEO0oyiRgMNDdWvRTobr7sex2SUFsjpKmwenYAULrRiAiEA6uKFK1sbnJ1J\\n\" +\n-            \"lW8Tw2G4jGpEFIc4C9duRbU6DIbGnckwCgYIKoZIzj0EAwIDSAAwRQIgN3byD4lu\\n\" +\n-            \"a8A0hzUR1OnPoXSyfus6HOhmBozH6coY9MICIQDsT5jj5GKVtxtlcki5iE08K70Z\\n\" +\n-            \"gt\/tkcE1Fkk4RsZORA==\\n\" +\n-            \"-----END CERTIFICATE-----\";\n-\n-    public void runTest(ValidatePathWithParams pathValidator) throws Exception {\n-        \/\/ Validate valid\n-        pathValidator.validate(new String[]{VALID, INT},\n-                ValidatePathWithParams.Status.GOOD, null, System.out);\n-\n-        \/\/ Validate Revoked\n-        pathValidator.validate(new String[]{REVOKED, INT},\n-                ValidatePathWithParams.Status.REVOKED,\n-                \"Mon Mar 27 13:47:24 PDT 2023\", System.out);\n+        validatePathWithURL.validateDomain(VALID, false);\n+        validatePathWithURL.validateDomain(REVOKED, true);\n@@ -520,0 +121,3 @@\n+    private static final String VALID = \"https:\/\/good.gtsr4.demo.pki.goog\/\";\n+    private static final String REVOKED = \"https:\/\/revoked.gtsr4.demo.pki.goog\/\";\n+    private static final String CA_ALIAS = \"gtsrootecccar4 [jdk]\";\n@@ -521,94 +125,2 @@\n-    \/\/ Owner: CN=GTS CA 2P2, O=Google Trust Services LLC, C=US\n-    \/\/ Issuer: CN=GTS Root R4, O=Google Trust Services LLC, C=US\n-    \/\/ Serial number: 2166825e1700440612491f540\n-    \/\/ Valid from: Tue Oct 04 17:00:42 PDT 2022 until: Wed Sep 29 17:00:42 PDT 2027\n-    private static final String INT = \"-----BEGIN CERTIFICATE-----\\n\" +\n-            \"MIIDITCCAqagAwIBAgINAhZoJeFwBEBhJJH1QDAKBggqhkjOPQQDAzBHMQswCQYD\\n\" +\n-            \"VQQGEwJVUzEiMCAGA1UEChMZR29vZ2xlIFRydXN0IFNlcnZpY2VzIExMQzEUMBIG\\n\" +\n-            \"A1UEAxMLR1RTIFJvb3QgUjQwHhcNMjIxMDA1MDAwMDQyWhcNMjcwOTMwMDAwMDQy\\n\" +\n-            \"WjBGMQswCQYDVQQGEwJVUzEiMCAGA1UEChMZR29vZ2xlIFRydXN0IFNlcnZpY2Vz\\n\" +\n-            \"IExMQzETMBEGA1UEAxMKR1RTIENBIDJQMjBZMBMGByqGSM49AgEGCCqGSM49AwEH\\n\" +\n-            \"A0IABKdQkzjAHqOUsb\/TkH7cz5lRtD374tNZ8rYrCUb1mxypE+VmCb1Jgzq+93tR\\n\" +\n-            \"dE78GRzPI4+q6raha1TEyWgoniOjggF2MIIBcjAOBgNVHQ8BAf8EBAMCAYYwHQYD\\n\" +\n-            \"VR0lBBYwFAYIKwYBBQUHAwEGCCsGAQUFBwMCMBIGA1UdEwEB\/wQIMAYBAf8CAQAw\\n\" +\n-            \"HQYDVR0OBBYEFIcjqVBIDgeJVApxMPYz0gpH9p2sMB8GA1UdIwQYMBaAFIBM1ut0\\n\" +\n-            \"\/0k2o9XY\/LU+xWrwlB2MMGgGCCsGAQUFBwEBBFwwWjAmBggrBgEFBQcwAYYaaHR0\\n\" +\n-            \"cDovL29jc3AucGtpLmdvb2cvZ3RzcjQwMAYIKwYBBQUHMAKGJGh0dHA6Ly9wa2ku\\n\" +\n-            \"Z29vZy9yZXBvL2NlcnRzL2d0c3I0LmRlcjA0BgNVHR8ELTArMCmgJ6AlhiNodHRw\\n\" +\n-            \"Oi8vY3JsLnBraS5nb29nL2d0c3I0L2d0c3I0LmNybDBNBgNVHSAERjBEMAgGBmeB\\n\" +\n-            \"DAECATA4BgorBgEEAdZ5AgUDMCowKAYIKwYBBQUHAgEWHGh0dHBzOi8vcGtpLmdv\\n\" +\n-            \"b2cvcmVwb3NpdG9yeS8wCgYIKoZIzj0EAwMDaQAwZgIxAMnbIiQb5fsdexUuVGoB\\n\" +\n-            \"MVwsDPGd7VC13Y0OBezt7FqFHDwqm8nnVdV\/FkNyXNv9\/AIxAN51NGqMcbexMOYK\\n\" +\n-            \"pLC0zXfjNwvqBsZhmzCCQIM6MVyBID0rjjxPu7laIaHqAu6T5Q==\\n\" +\n-            \"-----END CERTIFICATE-----\";\n-\n-    \/\/ Owner: CN=good.gtsr4.demo.pki.goog\n-    \/\/ Issuer: CN=GTS CA 2P2, O=Google Trust Services LLC, C=US\n-    \/\/ Serial number: 743c4f78750e30f0d407a19254ba96a\n-    \/\/ Valid from: Mon Mar 27 12:40:42 PDT 2023 until: Sun Jun 25 12:40:41 PDT 2023\n-    private static final String VALID = \"-----BEGIN CERTIFICATE-----\\n\" +\n-            \"MIIEsTCCBFegAwIBAgIQB0PE94dQ4w8NQHoZJUupajAKBggqhkjOPQQDAjBGMQsw\\n\" +\n-            \"CQYDVQQGEwJVUzEiMCAGA1UEChMZR29vZ2xlIFRydXN0IFNlcnZpY2VzIExMQzET\\n\" +\n-            \"MBEGA1UEAxMKR1RTIENBIDJQMjAeFw0yMzAzMjcxOTQwNDJaFw0yMzA2MjUxOTQw\\n\" +\n-            \"NDFaMCMxITAfBgNVBAMTGGdvb2QuZ3RzcjQuZGVtby5wa2kuZ29vZzCCASIwDQYJ\\n\" +\n-            \"KoZIhvcNAQEBBQADggEPADCCAQoCggEBAOdkWBg3i5CxzH1dvlBoWHtIUyk78OAA\\n\" +\n-            \"bZdq7pKWB8i8C9Rf089uQ+7jQWOmqCNxU+OXdjumPfk\/4MQvvtkmaqKi7HCN1bvQ\\n\" +\n-            \"0CrW7Zhi5jx11QuzEEZVdvXcchzmodp9GSl9t6zK\/ItNiIYVisH9dqRWrZ\/KZnO+\\n\" +\n-            \"y13dlr5UXAXVvNKx1L4TjhGlam7IEJdrAjkLJk4wXAFhv9HaPNJnjj0306xNm2h+\\n\" +\n-            \"VzldpMPlaXGN9JcGQdMVFpa9f0AI\/r7SF7I2EDXaIKFToJ4jQurEGc3oxayiv9wB\\n\" +\n-            \"QapXqSTbPztb5SPGdX1yawDeigNHf10tDqFzCpfI\/AwLxagpA2YyyXMCAwEAAaOC\\n\" +\n-            \"An0wggJ5MA4GA1UdDwEB\/wQEAwIFoDATBgNVHSUEDDAKBggrBgEFBQcDATAMBgNV\\n\" +\n-            \"HRMBAf8EAjAAMB0GA1UdDgQWBBTZs4UFHCFLlXnJswubCMxEhtgPmjAfBgNVHSME\\n\" +\n-            \"GDAWgBSHI6lQSA4HiVQKcTD2M9IKR\/adrDB4BggrBgEFBQcBAQRsMGowNQYIKwYB\\n\" +\n-            \"BQUHMAGGKWh0dHA6Ly9vY3NwLnBraS5nb29nL3MvZ3RzMnAyL3dKWTY1eFNLQUNB\\n\" +\n-            \"MDEGCCsGAQUFBzAChiVodHRwOi8vcGtpLmdvb2cvcmVwby9jZXJ0cy9ndHMycDIu\\n\" +\n-            \"ZGVyMCMGA1UdEQQcMBqCGGdvb2QuZ3RzcjQuZGVtby5wa2kuZ29vZzAhBgNVHSAE\\n\" +\n-            \"GjAYMAgGBmeBDAECATAMBgorBgEEAdZ5AgUDMDwGA1UdHwQ1MDMwMaAvoC2GK2h0\\n\" +\n-            \"dHA6Ly9jcmxzLnBraS5nb29nL2d0czJwMi94NWswT2ZlZ0o4OC5jcmwwggECBgor\\n\" +\n-            \"BgEEAdZ5AgQCBIHzBIHwAO4AdQDoPtDaPvUGNTLnVyi8iWvJA9PL0RFr7Otp4Xd9\\n\" +\n-            \"bQa9bgAAAYckzdBSAAAEAwBGMEQCICpm7XEQds5Pzk59Qhhlx3PjipAEVzxVJB3H\\n\" +\n-            \"UmmGlHYKAiBG39UauHNNQDMYK2PEnILbFI0AvVWpCBUck4CHbs+9xAB1AHoyjFTY\\n\" +\n-            \"ty22IOo44FIe6YQWcDIThU070ivBOlejUutSAAABhyTN0JoAAAQDAEYwRAIgekoP\\n\" +\n-            \"yJFspEfqvzW\/pzVtRn8oz1L\/PBzw2NYRPFdDkRUCIG1uIaGUA7uqiILD6vvp\/1VD\\n\" +\n-            \"XriEIH8\/qz\/3qWqxsZanMAoGCCqGSM49BAMCA0gAMEUCIQCnpyh5H9Hn+f8nOFZp\\n\" +\n-            \"wz7p+x5pmMVvPzah1g+EmoFO\/wIgStidgVhudT\/vpM2OH\/oN30Na+EJJDqWxousN\\n\" +\n-            \"6t9L8FQ=\\n\" +\n-            \"-----END CERTIFICATE-----\";\n-\n-    \/\/ Owner: CN=revoked.gtsr4.demo.pki.goog\n-    \/\/ Issuer: CN=GTS CA 2P2, O=Google Trust Services LLC, C=US\n-    \/\/ Serial number: 6b2d650d4bc3bd3f11a595bf05187915\n-    \/\/ Valid from: Mon Mar 27 12:47:43 PDT 2023 until: Sun Jun 25 12:47:42 PDT 2023\n-    private static final String REVOKED = \"-----BEGIN CERTIFICATE-----\\n\" +\n-            \"MIIEuDCCBF6gAwIBAgIQay1lDUvDvT8RpZW\/BRh5FTAKBggqhkjOPQQDAjBGMQsw\\n\" +\n-            \"CQYDVQQGEwJVUzEiMCAGA1UEChMZR29vZ2xlIFRydXN0IFNlcnZpY2VzIExMQzET\\n\" +\n-            \"MBEGA1UEAxMKR1RTIENBIDJQMjAeFw0yMzAzMjcxOTQ3NDNaFw0yMzA2MjUxOTQ3\\n\" +\n-            \"NDJaMCYxJDAiBgNVBAMTG3Jldm9rZWQuZ3RzcjQuZGVtby5wa2kuZ29vZzCCASIw\\n\" +\n-            \"DQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBAOEKoC1Zv\/m2G8DrGkOgLq5TPSeC\\n\" +\n-            \"X3cClcI6s4JS5Cld2DKX7m4P8rXAxJyVHvlmkxZQoD6Y7JxsavlJ\/Yw0qdqkNLTv\\n\" +\n-            \"kviEiLNYEn8Qu0SoRLNanzoFUINZkAZ4\/0Lfvsrl9tTigLsCJ4jQauemGmGcmKUy\\n\" +\n-            \"qsKisfrMC0ZG9EP9WRjc9WF13Jqe55+gZ7LqaAAoPVR\/7J6T1VAKteaYaXrORtVF\\n\" +\n-            \"uMeinE4c9YuxRCLa+3X1qqc3HAsvZEBOdb35fC0cN\/ILktCQpq1Fj+QD4jfR6bVQ\\n\" +\n-            \"E8eA6Jy+5qHSg2VjAm6wNLd5QkfE7D8uC9sYs638r48ahcXhy3zwpzGhuH0CAwEA\\n\" +\n-            \"AaOCAoEwggJ9MA4GA1UdDwEB\/wQEAwIFoDATBgNVHSUEDDAKBggrBgEFBQcDATAM\\n\" +\n-            \"BgNVHRMBAf8EAjAAMB0GA1UdDgQWBBQl5Uh4jTR3l8PkcLdBwtwQXkUzBjAfBgNV\\n\" +\n-            \"HSMEGDAWgBSHI6lQSA4HiVQKcTD2M9IKR\/adrDB4BggrBgEFBQcBAQRsMGowNQYI\\n\" +\n-            \"KwYBBQUHMAGGKWh0dHA6Ly9vY3NwLnBraS5nb29nL3MvZ3RzMnAyL3h5WmtBTEE3\\n\" +\n-            \"aGY0MDEGCCsGAQUFBzAChiVodHRwOi8vcGtpLmdvb2cvcmVwby9jZXJ0cy9ndHMy\\n\" +\n-            \"cDIuZGVyMCYGA1UdEQQfMB2CG3Jldm9rZWQuZ3RzcjQuZGVtby5wa2kuZ29vZzAh\\n\" +\n-            \"BgNVHSAEGjAYMAgGBmeBDAECATAMBgorBgEEAdZ5AgUDMDwGA1UdHwQ1MDMwMaAv\\n\" +\n-            \"oC2GK2h0dHA6Ly9jcmxzLnBraS5nb29nL2d0czJwMi9sU1htaTNxZWRoYy5jcmww\\n\" +\n-            \"ggEDBgorBgEEAdZ5AgQCBIH0BIHxAO8AdgCt9776fP8QyIudPZwePhhqtGcpXc+x\\n\" +\n-            \"DCTKhYY069yCigAAAYck1BYGAAAEAwBHMEUCIGM5ykDTU3mqgLIk+fPmVn6JGUXB\\n\" +\n-            \"W4xouGUA1iiNs7G0AiEAtuWnV\/J5llcxB7ZTwkCb6cviyv4Z6O396ZGW8GsrqAQA\\n\" +\n-            \"dQC3Pvsk35xNunXyOcW6WPRsXfxCz3qfNcSeHQmBJe20mQAAAYck1BYIAAAEAwBG\\n\" +\n-            \"MEQCIHcK1H025GIv8klzQGSZAL9NnuH5EzeGra0jRRg5RM4UAiAQaJyJDBkJRL\/C\\n\" +\n-            \"F9WCg9Lmp8bdsXkG5WPreI24ansAPTAKBggqhkjOPQQDAgNIADBFAiBehPLU7raP\\n\" +\n-            \"509khaP9yiKiL3mbygtfQo4MDpBnd2RI6wIhAOdlQythGgU+nOENodsB+wUOQXOb\\n\" +\n-            \"akcBOxrDWfyhxmpk\\n\" +\n-            \"-----END CERTIFICATE-----\";\n-\n-    public void runTest(ValidatePathWithParams pathValidator) throws Exception {\n-        \/\/ Validate valid\n-        pathValidator.validate(new String[]{VALID, INT},\n-                ValidatePathWithParams.Status.GOOD, null, System.out);\n+    public void runTest() throws Exception {\n+        ValidatePathWithURL validatePathWithURL = new ValidatePathWithURL(CA_ALIAS);\n@@ -616,4 +128,2 @@\n-        \/\/ Validate Revoked\n-        pathValidator.validate(new String[]{REVOKED, INT},\n-                ValidatePathWithParams.Status.REVOKED,\n-                \"Mon Mar 27 13:48:18 PDT 2023\", System.out);\n+        validatePathWithURL.validateDomain(VALID, false);\n+        validatePathWithURL.validateDomain(REVOKED, true);\n","filename":"test\/jdk\/security\/infra\/java\/security\/cert\/CertPathValidator\/certification\/GoogleCA.java","additions":55,"deletions":545,"binary":false,"changes":600,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2017, 2021, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2017, 2023, Oracle and\/or its affiliates. All rights reserved.\n@@ -24,1 +24,1 @@\n- \/*\n+\/*\n@@ -27,16 +27,5 @@\n- * @summary Interoperability tests with Let's Encrypt CA\n- * @build ValidatePathWithParams\n- * @run main\/othervm -Djava.security.debug=certpath LetsEncryptCA OCSP\n- * @run main\/othervm -Djava.security.debug=certpath LetsEncryptCA CRL\n- *\/\n-\n- \/*\n- * Obtain TLS test artifacts for Let's Encrypt CA from:\n- *\n- * Valid TLS Certificates:\n- * https:\/\/valid-isrgrootx1.letsencrypt.org\/\n- *\n- * Revoked TLS Certificates:\n- * https:\/\/revoked-isrgrootx1.letsencrypt.org\/\n- *\n- * Test artifacts don't have CRLs listed and intermediate cert doesn't have OCSP.\n+ * @summary Interoperability tests with Let's Encrypt CA using OCSP and CRL\n+ * @library \/test\/lib\n+ * @build jtreg.SkippedException\n+ * @build ValidatePathWithURL\n+ * @run main\/othervm -Djava.security.debug=certpath LetsEncryptCA DEFAULT\n@@ -46,116 +35,3 @@\n-     \/\/ Owner: CN=R3, O=Let's Encrypt, C=US\n-     \/\/ Issuer: CN=ISRG Root X1, O=Internet Security Research Group, C=US\n-     \/\/ Serial number: 912b084acf0c18a753f6d62e25a75f5a\n-     \/\/ Valid from: Thu Sep 03 17:00:00 PDT 2020 until: Mon Sep 15 09:00:00 PDT 2025\n-    private static final String INT = \"-----BEGIN CERTIFICATE-----\\n\" +\n-            \"MIIFFjCCAv6gAwIBAgIRAJErCErPDBinU\/bWLiWnX1owDQYJKoZIhvcNAQELBQAw\\n\" +\n-            \"TzELMAkGA1UEBhMCVVMxKTAnBgNVBAoTIEludGVybmV0IFNlY3VyaXR5IFJlc2Vh\\n\" +\n-            \"cmNoIEdyb3VwMRUwEwYDVQQDEwxJU1JHIFJvb3QgWDEwHhcNMjAwOTA0MDAwMDAw\\n\" +\n-            \"WhcNMjUwOTE1MTYwMDAwWjAyMQswCQYDVQQGEwJVUzEWMBQGA1UEChMNTGV0J3Mg\\n\" +\n-            \"RW5jcnlwdDELMAkGA1UEAxMCUjMwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEK\\n\" +\n-            \"AoIBAQC7AhUozPaglNMPEuyNVZLD+ILxmaZ6QoinXSaqtSu5xUyxr45r+XXIo9cP\\n\" +\n-            \"R5QUVTVXjJ6oojkZ9YI8QqlObvU7wy7bjcCwXPNZOOftz2nwWgsbvsCUJCWH+jdx\\n\" +\n-            \"sxPnHKzhm+\/b5DtFUkWWqcFTzjTIUu61ru2P3mBw4qVUq7ZtDpelQDRrK9O8Zutm\\n\" +\n-            \"NHz6a4uPVymZ+DAXXbpyb\/uBxa3Shlg9F8fnCbvxK\/eG3MHacV3URuPMrSXBiLxg\\n\" +\n-            \"Z3Vms\/EY96Jc5lP\/Ooi2R6X\/ExjqmAl3P51T+c8B5fWmcBcUr2Ok\/5mzk53cU6cG\\n\" +\n-            \"\/kiFHaFpriV1uxPMUgP17VGhi9sVAgMBAAGjggEIMIIBBDAOBgNVHQ8BAf8EBAMC\\n\" +\n-            \"AYYwHQYDVR0lBBYwFAYIKwYBBQUHAwIGCCsGAQUFBwMBMBIGA1UdEwEB\/wQIMAYB\\n\" +\n-            \"Af8CAQAwHQYDVR0OBBYEFBQusxe3WFbLrlAJQOYfr52LFMLGMB8GA1UdIwQYMBaA\\n\" +\n-            \"FHm0WeZ7tuXkAXOACIjIGlj26ZtuMDIGCCsGAQUFBwEBBCYwJDAiBggrBgEFBQcw\\n\" +\n-            \"AoYWaHR0cDovL3gxLmkubGVuY3Iub3JnLzAnBgNVHR8EIDAeMBygGqAYhhZodHRw\\n\" +\n-            \"Oi8veDEuYy5sZW5jci5vcmcvMCIGA1UdIAQbMBkwCAYGZ4EMAQIBMA0GCysGAQQB\\n\" +\n-            \"gt8TAQEBMA0GCSqGSIb3DQEBCwUAA4ICAQCFyk5HPqP3hUSFvNVneLKYY611TR6W\\n\" +\n-            \"PTNlclQtgaDqw+34IL9fzLdwALduO\/ZelN7kIJ+m74uyA+eitRY8kc607TkC53wl\\n\" +\n-            \"ikfmZW4\/RvTZ8M6UK+5UzhK8jCdLuMGYL6KvzXGRSgi3yLgjewQtCPkIVz6D2QQz\\n\" +\n-            \"CkcheAmCJ8MqyJu5zlzyZMjAvnnAT45tRAxekrsu94sQ4egdRCnbWSDtY7kh+BIm\\n\" +\n-            \"lJNXoB1lBMEKIq4QDUOXoRgffuDghje1WrG9ML+Hbisq\/yFOGwXD9RiX8F6sw6W4\\n\" +\n-            \"avAuvDszue5L3sz85K+EC4Y\/wFVDNvZo4TYXao6Z0f+lQKc0t8DQYzk1OXVu8rp2\\n\" +\n-            \"yJMC6alLbBfODALZvYH7n7do1AZls4I9d1P4jnkDrQoxB3UqQ9hVl3LEKQ73xF1O\\n\" +\n-            \"yK5GhDDX8oVfGKF5u+decIsH4YaTw7mP3GFxJSqv3+0lUFJoi5Lc5da149p90Ids\\n\" +\n-            \"hCExroL1+7mryIkXPeFM5TgO9r0rvZaBFOvV2z0gp35Z0+L4WPlbuEjN\/lxPFin+\\n\" +\n-            \"HlUjr8gRsI3qfJOQFy\/9rKIJR0Y\/8Omwt\/8oTWgy1mdeHmmjk7j1nYsvC9JSQ6Zv\\n\" +\n-            \"MldlTTKB3zhThV1+XWYp6rjd5JW1zbVWEkLNxE7GJThEUG3szgBVGP7pSWTUTsqX\\n\" +\n-            \"nLRbwHOoq7hHwg==\\n\" +\n-            \"-----END CERTIFICATE-----\";\n-\n-    \/\/ Owner: CN=valid-isrgrootx1.letsencrypt.org\n-    \/\/ Issuer: CN=R3, O=Let's Encrypt, C=US\n-    \/\/ Serial number: 46326744d1c2f3feeca7148ed59353144a6\n-    \/\/ Valid from: Wed Jun 02 08:00:18 PDT 2021 until: Tue Aug 31 08:00:18 PDT 2021\n-    private static final String VALID = \"-----BEGIN CERTIFICATE-----\\n\" +\n-            \"MIIFSDCCBDCgAwIBAgISBGMmdE0cLz\/uynFI7Vk1MUSmMA0GCSqGSIb3DQEBCwUA\\n\" +\n-            \"MDIxCzAJBgNVBAYTAlVTMRYwFAYDVQQKEw1MZXQncyBFbmNyeXB0MQswCQYDVQQD\\n\" +\n-            \"EwJSMzAeFw0yMTA2MDIxNTAwMThaFw0yMTA4MzExNTAwMThaMCsxKTAnBgNVBAMT\\n\" +\n-            \"IHZhbGlkLWlzcmdyb290eDEubGV0c2VuY3J5cHQub3JnMIIBIjANBgkqhkiG9w0B\\n\" +\n-            \"AQEFAAOCAQ8AMIIBCgKCAQEAmdx7jlaUZ0MgEvqzYWXItAFxVAOmR3KF+79vU195\\n\" +\n-            \"O5X54Go1+GU+eyFAeTqr6W1gC\/MIrSA9LO4neJUx5AWCYaLq7IE7\/YnmXTT6BB0x\\n\" +\n-            \"WFN3V1OJg9bAqpcEclQp6fbQS6DjdQvUUaEvVIwPzaen6Hmtw6LuHOYOdLk4fUSm\\n\" +\n-            \"zadWiyNlMm0\/ts+MLHY5iQd9ypGhJED7KBDQ4d4wvyMYo\/MYKOUQ+dTXcIegh7p4\\n\" +\n-            \"0OVtbrkdCuGJL+cEw1IUtSNQD+MnvUIu1je7Yb6iZ6Qd3iopNLykHYZb8YemakGX\\n\" +\n-            \"SDdC54yi35NU+Y+l23vycbVmRd8vK1sizhjRSE+ufmEqXQIDAQABo4ICXTCCAlkw\\n\" +\n-            \"DgYDVR0PAQH\/BAQDAgWgMB0GA1UdJQQWMBQGCCsGAQUFBwMBBggrBgEFBQcDAjAM\\n\" +\n-            \"BgNVHRMBAf8EAjAAMB0GA1UdDgQWBBR300bKVFG2auzS0mO4+E57SN6QLzAfBgNV\\n\" +\n-            \"HSMEGDAWgBQULrMXt1hWy65QCUDmH6+dixTCxjBVBggrBgEFBQcBAQRJMEcwIQYI\\n\" +\n-            \"KwYBBQUHMAGGFWh0dHA6Ly9yMy5vLmxlbmNyLm9yZzAiBggrBgEFBQcwAoYWaHR0\\n\" +\n-            \"cDovL3IzLmkubGVuY3Iub3JnLzArBgNVHREEJDAigiB2YWxpZC1pc3Jncm9vdHgx\\n\" +\n-            \"LmxldHNlbmNyeXB0Lm9yZzBMBgNVHSAERTBDMAgGBmeBDAECATA3BgsrBgEEAYLf\\n\" +\n-            \"EwEBATAoMCYGCCsGAQUFBwIBFhpodHRwOi8vY3BzLmxldHNlbmNyeXB0Lm9yZzCC\\n\" +\n-            \"AQYGCisGAQQB1nkCBAIEgfcEgfQA8gB3APZclC\/RdzAiFFQYCDCUVo7jTRMZM7\/f\\n\" +\n-            \"DC8gC8xO8WTjAAABec10PpUAAAQDAEgwRgIhAPDWvnP5mA0RhPa9oiTlE21Ppcez\\n\" +\n-            \"eF1+wU0MeoQcjq\/7AiEAsox8kMGpWXq0ZVPweTpw1So\/sNOZTsSPyBUdbLwjf+MA\\n\" +\n-            \"dwBvU3asMfAxGdiZAKRRFf93FRwR2QLBACkGjbIImjfZEwAAAXnNdD7rAAAEAwBI\\n\" +\n-            \"MEYCIQCYBSmmb5P+DZGANyYTPHlEbmqOBkEOblkEHq5Lf+wtkQIhAO2HhwOm3wns\\n\" +\n-            \"ZTsXjUCcfQA0lKBI2TKkg9tJKFs3uuKDMA0GCSqGSIb3DQEBCwUAA4IBAQBJJ47x\\n\" +\n-            \"ZhKN3QRBYVROpoYDSh0a\/JW7zPGRCxK5fnDY9UT8m4gEh3yhDTkycX+vo8TReK6W\\n\" +\n-            \"fEYareTSTq71MYgtKDYEARm10DuL7Vdig9Tf5DpjXLHaba+wqPz24lwhiJgoKRRr\\n\" +\n-            \"8by3wXPFCGSuQyDo1ZUNrAJVYKO4hPMob1ZE8z9IYW63GvzBjEla\/HxoVa9iTkv+\\n\" +\n-            \"31rsKzpSbMJpnQ7WcgkUPdpoDo4JElGCyf7VZHNicumipAiCmKu0Q6TRCPOXxlKE\\n\" +\n-            \"\/BIyDey3rXVw3wzOlxmVF6t\/V3vGtbgVvN\/feUe\/ytyv4vLfRR4udi2XxWt3x1la\\n\" +\n-            \"7R3zuWdRQhh21p1H\\n\" +\n-            \"-----END CERTIFICATE-----\";\n-\n-    \/\/ Owner: CN=revoked-isrgrootx1.letsencrypt.org\n-    \/\/ Issuer: CN=R3, O=Let's Encrypt, C=US\n-    \/\/ Serial number: 4f1333011635d76d6356c5f1fb8a7273617\n-    \/\/ Valid from: Fri Jun 25 08:18:10 PDT 2021 until: Thu Sep 23 08:18:09 PDT 2021\n-    private static final String REVOKED = \"-----BEGIN CERTIFICATE-----\\n\" +\n-            \"MIIFSTCCBDGgAwIBAgISBPEzMBFjXXbWNWxfH7inJzYXMA0GCSqGSIb3DQEBCwUA\\n\" +\n-            \"MDIxCzAJBgNVBAYTAlVTMRYwFAYDVQQKEw1MZXQncyBFbmNyeXB0MQswCQYDVQQD\\n\" +\n-            \"EwJSMzAeFw0yMTA2MjUxNTE4MTBaFw0yMTA5MjMxNTE4MDlaMC0xKzApBgNVBAMT\\n\" +\n-            \"InJldm9rZWQtaXNyZ3Jvb3R4MS5sZXRzZW5jcnlwdC5vcmcwggEiMA0GCSqGSIb3\\n\" +\n-            \"DQEBAQUAA4IBDwAwggEKAoIBAQCkCp4fq7FnN5lfAWX0vhCcyC5WO9TuU6ckuYYj\\n\" +\n-            \"8\/wQ8GQ\/FIl+vXCAmHIfIX14irQN8TISeVdMOP0C7sa73d3GSawX7qMaRhddXn7V\\n\" +\n-            \"EL+4CbHQ6qit5YkakwhHz9tKbYX16wPj+inn22kJVwi8iLbhYB9WWSvv7OyiNSHv\\n\" +\n-            \"nmlYUkMv8+9UhgPT4yCKF1OEI5ajUOuecjOKc+EzsT\/JqPRErvBOIKn3PRn4h8UM\\n\" +\n-            \"0BJDrDtZMpkvD4\/lyRs3g\/BLsf3DQjlEgKit0hvc72yyhiDbKd41EmBoQC5rNF7o\\n\" +\n-            \"B0CnBXhDLHbC\/YRunVrYGsF0h2J9hw4055BdaXbS2BJnPEFnAgMBAAGjggJcMIIC\\n\" +\n-            \"WDAOBgNVHQ8BAf8EBAMCBaAwHQYDVR0lBBYwFAYIKwYBBQUHAwEGCCsGAQUFBwMC\\n\" +\n-            \"MAwGA1UdEwEB\/wQCMAAwHQYDVR0OBBYEFJBkf3Z\/ICoCTUx3JCgrBeoMyedQMB8G\\n\" +\n-            \"A1UdIwQYMBaAFBQusxe3WFbLrlAJQOYfr52LFMLGMFUGCCsGAQUFBwEBBEkwRzAh\\n\" +\n-            \"BggrBgEFBQcwAYYVaHR0cDovL3IzLm8ubGVuY3Iub3JnMCIGCCsGAQUFBzAChhZo\\n\" +\n-            \"dHRwOi8vcjMuaS5sZW5jci5vcmcvMC0GA1UdEQQmMCSCInJldm9rZWQtaXNyZ3Jv\\n\" +\n-            \"b3R4MS5sZXRzZW5jcnlwdC5vcmcwTAYDVR0gBEUwQzAIBgZngQwBAgEwNwYLKwYB\\n\" +\n-            \"BAGC3xMBAQEwKDAmBggrBgEFBQcCARYaaHR0cDovL2Nwcy5sZXRzZW5jcnlwdC5v\\n\" +\n-            \"cmcwggEDBgorBgEEAdZ5AgQCBIH0BIHxAO8AdQCUILwejtWNbIhzH4KLIiwN0dpN\\n\" +\n-            \"XmxPlD1h204vWE2iwgAAAXpD9t6nAAAEAwBGMEQCIHwF9NcPqsovYp56lhqFkWYj\\n\" +\n-            \"QCATATrLzzxgUoLDYRwgAiBBecqe5Ub32I+q9oqH1nbK\/s8QadcafIL3bkrRVbFB\\n\" +\n-            \"TAB2AH0+8viP\/4hVaCTCwMqeUol5K8UOeAl\/LmqXaJl+IvDXAAABekP23sYAAAQD\\n\" +\n-            \"AEcwRQIgGli\/1mmKKnZ0uxDIX7ySqAyD2C7FTf+y3py2S0Xcv4YCIQCZve3cqKZ2\\n\" +\n-            \"lrEyyaMeLZA+PIxUMniHx3gDkro0sKLzOzANBgkqhkiG9w0BAQsFAAOCAQEAle42\\n\" +\n-            \"p58OTusm7DAOcdK4ld+pJu2bz9F940Wrnql08rciRjGIVpp5PhMNFm9AOaptKPNY\\n\" +\n-            \"h62V2GEOVaLxmvr9\/8EDFcCCPAGV1DNYrG9aTKaiXk7IzO4UxKbzox4iUcuop\/zB\\n\" +\n-            \"uofxT8uBLmT4XYZrQXXKj1KdfJGzgeoXqBv5PPCiP3hmBQixoJnSKImnUIXWh4O8\\n\" +\n-            \"kBtmgII5ug0q+jI3LvpJuv7xQsaNYFBcmFiQQ7YRt4W99GMdbYGjhzT8iBDEH7nG\\n\" +\n-            \"MsqWuwB5TN5vIuw2aWxcfaqKayq7UPA4rJePWdD\/5RzKlQKLQx0BA3AL+3Nnj1fT\\n\" +\n-            \"NEKwCWWylIND6z\/9Xw==\\n\" +\n-            \"-----END CERTIFICATE-----\";\n-\n-    public static void main(String[] args) throws Exception {\n-\n-        if (args.length >= 1 && \"CRL\".equalsIgnoreCase(args[0])) {\n-            ValidatePathWithParams pathValidator = new ValidatePathWithParams(null);\n-            pathValidator.enableCRLCheck();\n-\n-            \/\/ Validate int, EE certs don't have CRLs\n-            pathValidator.validate(new String[]{INT},\n-                    ValidatePathWithParams.Status.GOOD, null, System.out);\n+     private static final String VALID = \"https:\/\/valid-isrgrootx1.letsencrypt.org\/\";\n+     private static final String REVOKED = \"https:\/\/revoked-isrgrootx1.letsencrypt.org\/\";\n+    private static final String CA_ALIAS = \"letsencryptisrgx1 [jdk]\";\n@@ -163,2 +39,1 @@\n-            return;\n-        }\n+     public static void main(String[] args) throws Exception {\n@@ -166,4 +41,8 @@\n-        \/\/ OCSP check by default\n-        \/\/ intermediate cert R3 doesn't specify OCSP responder\n-        ValidatePathWithParams pathValidator = new ValidatePathWithParams(new String[]{INT});\n-        pathValidator.enableOCSPCheck();\n+         if (args.length >= 1 && \"CRL\".equalsIgnoreCase(args[0])) {\n+             ValidatePathWithURL.enableCRLOnly();\n+         } if (args.length >= 1 && \"OCSP\".equalsIgnoreCase(args[0])){\n+             ValidatePathWithURL.enableOCSPOnly();\n+         } else {\n+             \/\/ EE certs don't have CRLs, intermediate cert doesn't specify OCSP responder\n+             ValidatePathWithURL.enableOCSPAndCRL();\n+         }\n@@ -171,3 +50,1 @@\n-        \/\/ Validate valid\n-        pathValidator.validate(new String[]{VALID},\n-                ValidatePathWithParams.Status.GOOD, null, System.out);\n+         ValidatePathWithURL validatePathWithURL = new ValidatePathWithURL(CA_ALIAS);\n@@ -175,5 +52,3 @@\n-        \/\/ Validate Revoked\n-        pathValidator.validate(new String[]{REVOKED},\n-                ValidatePathWithParams.Status.REVOKED,\n-                \"Fri Jun 25 09:18:12 PDT 2021\", System.out);\n-    }\n+         validatePathWithURL.validateDomain(VALID, false);\n+         validatePathWithURL.validateDomain(REVOKED, true);\n+     }\n","filename":"test\/jdk\/security\/infra\/java\/security\/cert\/CertPathValidator\/certification\/LetsEncryptCA.java","additions":23,"deletions":148,"binary":false,"changes":171,"status":"modified"},{"patch":"@@ -25,1 +25,1 @@\n- * @test\n+ * @test id=OCSP\n@@ -28,1 +28,3 @@\n- * @build ValidatePathWithParams\n+ * @library \/test\/lib\n+ * @build jtreg.SkippedException\n+ * @build ValidatePathWithURL\n@@ -30,1 +32,0 @@\n- * @run main\/othervm -Djava.security.debug=certpath MicrosoftTLS CRL\n@@ -34,9 +35,7 @@\n- * Microsoft ECC Root Certificate Authority 2017:\n- * Valid: http:\/\/acteccroot2017.pki.microsoft.com\/\n- * Revoked: http:\/\/rvkeccroot2017.pki.microsoft.com\/\n- * Expired: http:\/\/expeccroot2017.pki.microsoft.com\/\n- *\n- * Microsoft RSA Root Certificate Authority 2017:\n- * Valid: http:\/\/actrsaroot2017.pki.microsoft.com\/\n- * Revoked: http:\/\/rvkrsaroot2017.pki.microsoft.com\/\n- * Expired: http:\/\/exprsaroot2017.pki.microsoft.com\/\n+ * @test id=CRL\n+ * @bug 8304760\n+ * @summary Interoperability tests with Microsoft TLS root CAs\n+ * @library \/test\/lib\n+ * @build jtreg.SkippedException\n+ * @build ValidatePathWithURL\n+ * @run main\/othervm -Djava.security.debug=certpath MicrosoftTLS CRL\n@@ -44,0 +43,1 @@\n+\n@@ -48,2 +48,0 @@\n-        ValidatePathWithParams pathValidator = new ValidatePathWithParams(null);\n-\n@@ -51,1 +49,1 @@\n-            pathValidator.enableCRLCheck();\n+            ValidatePathWithURL.enableCRLOnly();\n@@ -54,1 +52,1 @@\n-            pathValidator.enableOCSPCheck();\n+            ValidatePathWithURL.enableOCSPOnly();\n@@ -57,2 +55,2 @@\n-        new MicrosoftECCTLS().runTest(pathValidator);\n-        new MicrosoftRSATLS().runTest(pathValidator);\n+        new MicrosoftECCTLS().runTest();\n+        new MicrosoftRSATLS().runTest();\n@@ -63,0 +61,3 @@\n+    private static final String VALID = \"https:\/\/acteccroot2017.pki.microsoft.com\/\";\n+    private static final String REVOKED = \"https:\/\/rvkeccroot2017.pki.microsoft.com\/\";\n+    private static final String CA_ALIAS = \"microsoftecc2017 [jdk]\";\n@@ -64,30 +65,2 @@\n-    \/\/ Owner: CN=Microsoft ECC TLS Issuing AOC CA 01, O=Microsoft Corporation, C=US\n-    \/\/ Issuer: CN=Microsoft ECC Root Certificate Authority 2017, O=Microsoft\n-    \/\/ Corporation, C=US\n-    \/\/ Serial number: 33000000282bfd23e7d1add707000000000028\n-    \/\/ Valid from: Thu Jun 24 12:58:36 PDT 2021 until: Wed Jun 24 12:58:36 PDT 2026\n-    private static final String INT = \"-----BEGIN CERTIFICATE-----\\n\" +\n-            \"MIIESTCCA8+gAwIBAgITMwAAACgr\/SPn0a3XBwAAAAAAKDAKBggqhkjOPQQDAzBl\\n\" +\n-            \"MQswCQYDVQQGEwJVUzEeMBwGA1UEChMVTWljcm9zb2Z0IENvcnBvcmF0aW9uMTYw\\n\" +\n-            \"NAYDVQQDEy1NaWNyb3NvZnQgRUNDIFJvb3QgQ2VydGlmaWNhdGUgQXV0aG9yaXR5\\n\" +\n-            \"IDIwMTcwHhcNMjEwNjI0MTk1ODM2WhcNMjYwNjI0MTk1ODM2WjBbMQswCQYDVQQG\\n\" +\n-            \"EwJVUzEeMBwGA1UEChMVTWljcm9zb2Z0IENvcnBvcmF0aW9uMSwwKgYDVQQDEyNN\\n\" +\n-            \"aWNyb3NvZnQgRUNDIFRMUyBJc3N1aW5nIEFPQyBDQSAwMTB2MBAGByqGSM49AgEG\\n\" +\n-            \"BSuBBAAiA2IABMBXcHExvrYrhw7v30oPR4aBaMne5o0FtTtbMV7iqVhTJDQSWDEJ\\n\" +\n-            \"hr528nyS6jcLLu9pLXQMJYxVd7bz4wWXgVtZnnbQ7trAAIPWVh5B6f5eJf5OQ7w7\\n\" +\n-            \"AwJgz3snP5Hx16OCAkkwggJFMA4GA1UdDwEB\/wQEAwIBhjAQBgkrBgEEAYI3FQEE\\n\" +\n-            \"AwIBADAdBgNVHQ4EFgQUMVu5zlEbfNGqA8Dr7TZdwp3TieEwHQYDVR0lBBYwFAYI\\n\" +\n-            \"KwYBBQUHAwEGCCsGAQUFBwMCMBkGCSsGAQQBgjcUAgQMHgoAUwB1AGIAQwBBMBIG\\n\" +\n-            \"A1UdEwEB\/wQIMAYBAf8CAQAwHwYDVR0jBBgwFoAUyMuZcnBSDPjmvrIEVykqz0IQ\\n\" +\n-            \"7TUwcAYDVR0fBGkwZzBloGOgYYZfaHR0cDovL3d3dy5taWNyb3NvZnQuY29tL3Br\\n\" +\n-            \"aW9wcy9jcmwvTWljcm9zb2Z0JTIwRUNDJTIwUm9vdCUyMENlcnRpZmljYXRlJTIw\\n\" +\n-            \"QXV0aG9yaXR5JTIwMjAxNy5jcmwwga4GCCsGAQUFBwEBBIGhMIGeMG0GCCsGAQUF\\n\" +\n-            \"BzAChmFodHRwOi8vd3d3Lm1pY3Jvc29mdC5jb20vcGtpb3BzL2NlcnRzL01pY3Jv\\n\" +\n-            \"c29mdCUyMEVDQyUyMFJvb3QlMjBDZXJ0aWZpY2F0ZSUyMEF1dGhvcml0eSUyMDIw\\n\" +\n-            \"MTcuY3J0MC0GCCsGAQUFBzABhiFodHRwOi8vb25lb2NzcC5taWNyb3NvZnQuY29t\\n\" +\n-            \"L29jc3AwcAYDVR0gBGkwZzAIBgZngQwBAgEwCAYGZ4EMAQICMFEGDCsGAQQBgjdM\\n\" +\n-            \"g30BATBBMD8GCCsGAQUFBwIBFjNodHRwOi8vd3d3Lm1pY3Jvc29mdC5jb20vcGtp\\n\" +\n-            \"b3BzL0RvY3MvUmVwb3NpdG9yeS5odG0wCgYIKoZIzj0EAwMDaAAwZQIxANmPydUj\\n\" +\n-            \"lgj\/2K77UnMeMkSGIgXzOhcTsixzZL+NmTR1Bq2hSPeA6Y3mn3lMlwxZmAIwIio6\\n\" +\n-            \"KrgItH4YmLWKd8QClIrE9QjbDlR7oFqaU3J34bWbMlAEjRARdZhhQlNwdORe\\n\" +\n-            \"-----END CERTIFICATE-----\";\n+    public void runTest() throws Exception {\n+        ValidatePathWithURL validatePathWithURL = new ValidatePathWithURL(CA_ALIAS);\n@@ -95,87 +68,2 @@\n-    \/\/ Owner: O=Microsoft Corporation, L=Redmond, ST=Washington, C=US\n-    \/\/ Issuer: CN=Microsoft ECC TLS Issuing AOC CA 01, O=Microsoft Corporation, C=US\n-    \/\/ Serial number: 3300000154e1c6007ee3d5c903000000000154\n-    \/\/ Valid from: Fri Oct 14 13:44:52 PDT 2022 until: Mon Oct 09 13:44:52 PDT 2023\n-    private static final String VALID = \"-----BEGIN CERTIFICATE-----\\n\" +\n-            \"MIIF3zCCBWSgAwIBAgITMwAAAVThxgB+49XJAwAAAAABVDAKBggqhkjOPQQDAzBb\\n\" +\n-            \"MQswCQYDVQQGEwJVUzEeMBwGA1UEChMVTWljcm9zb2Z0IENvcnBvcmF0aW9uMSww\\n\" +\n-            \"KgYDVQQDEyNNaWNyb3NvZnQgRUNDIFRMUyBJc3N1aW5nIEFPQyBDQSAwMTAeFw0y\\n\" +\n-            \"MjEwMTQyMDQ0NTJaFw0yMzEwMDkyMDQ0NTJaMFQxCzAJBgNVBAYTAlVTMRMwEQYD\\n\" +\n-            \"VQQIEwpXYXNoaW5ndG9uMRAwDgYDVQQHEwdSZWRtb25kMR4wHAYDVQQKExVNaWNy\\n\" +\n-            \"b3NvZnQgQ29ycG9yYXRpb24wdjAQBgcqhkjOPQIBBgUrgQQAIgNiAARk86yqvyiv\\n\" +\n-            \"jH2Frg2l6bmh1f0CqiKAEHdA2S2vTQhR4CtvFArkrPdqcKrhAAfQSgnC8KJQ08gl\\n\" +\n-            \"QvjK55202ib55YX3h+96IW6fQOkE18cvPwqkD3DVQuROouLaL1r70NWjggPvMIID\\n\" +\n-            \"6zCCAX8GCisGAQQB1nkCBAIEggFvBIIBawFpAHYA6D7Q2j71BjUy51covIlryQPT\\n\" +\n-            \"y9ERa+zraeF3fW0GvW4AAAGD2EdUigAABAMARzBFAiEA6rbt+9QhpuqX36PnuckO\\n\" +\n-            \"fR0Wu\/8z3Yry9fdFKvJDCEUCIGBz901b4ZGEjCaSJdlZVr29v2td4crPa9I6S97i\\n\" +\n-            \"nShAAHYAs3N3B+GEUPhjhtYFqdwRCUp5LbFnDAuH3PADDnk2pZoAAAGD2EdU\/wAA\\n\" +\n-            \"BAMARzBFAiBIvnSKGeCIWOlZowi7s7ZdwmyGhv2waJWSdewUSS6UOAIhALJhPQ19\\n\" +\n-            \"nmjjTwWB9sgCIF7RZbd2xwBd1hno06MQMSqTAHcAejKMVNi3LbYg6jjgUh7phBZw\\n\" +\n-            \"MhOFTTvSK8E6V6NS61IAAAGD2EdUxwAABAMASDBGAiEArrc6Fu74KTj\/z4lGCK9A\\n\" +\n-            \"O6UkhLpKnXdxEHilY7ghcZICIQCUjkvK4wehX1qEonjQoBkBJxLCus6y8WbkoxCe\\n\" +\n-            \"jHu2HTAbBgkrBgEEAYI3FQoEDjAMMAoGCCsGAQUFBwMBMDwGCSsGAQQBgjcVBwQv\\n\" +\n-            \"MC0GJSsGAQQBgjcVCIe91xuB5+tGgoGdLo7QDIfw2h1dgbXdUIWf\/XUCAWQCAR0w\\n\" +\n-            \"gaYGCCsGAQUFBwEBBIGZMIGWMGUGCCsGAQUFBzAChllodHRwOi8vd3d3Lm1pY3Jv\\n\" +\n-            \"c29mdC5jb20vcGtpb3BzL2NlcnRzL01pY3Jvc29mdCUyMEVDQyUyMFRMUyUyMElz\\n\" +\n-            \"c3VpbmclMjBBT0MlMjBDQSUyMDAxLmNydDAtBggrBgEFBQcwAYYhaHR0cDovL29u\\n\" +\n-            \"ZW9jc3AubWljcm9zb2Z0LmNvbS9vY3NwMB0GA1UdDgQWBBTVpTA+3jWCa1okX5Ri\\n\" +\n-            \"HnuY2\/b+IzAOBgNVHQ8BAf8EBAMCB4AwKwYDVR0RBCQwIoIgYWN0ZWNjcm9vdDIw\\n\" +\n-            \"MTcucGtpLm1pY3Jvc29mdC5jb20waAYDVR0fBGEwXzBdoFugWYZXaHR0cDovL3d3\\n\" +\n-            \"dy5taWNyb3NvZnQuY29tL3BraW9wcy9jcmwvTWljcm9zb2Z0JTIwRUNDJTIwVExT\\n\" +\n-            \"JTIwSXNzdWluZyUyMEFPQyUyMENBJTIwMDEuY3JsMGYGA1UdIARfMF0wUQYMKwYB\\n\" +\n-            \"BAGCN0yDfQEBMEEwPwYIKwYBBQUHAgEWM2h0dHA6Ly93d3cubWljcm9zb2Z0LmNv\\n\" +\n-            \"bS9wa2lvcHMvRG9jcy9SZXBvc2l0b3J5Lmh0bTAIBgZngQwBAgIwHwYDVR0jBBgw\\n\" +\n-            \"FoAUMVu5zlEbfNGqA8Dr7TZdwp3TieEwEwYDVR0lBAwwCgYIKwYBBQUHAwEwCgYI\\n\" +\n-            \"KoZIzj0EAwMDaQAwZgIxAOKV8s3SpXVd6zho8zQa4uGXkxPVocYo410FdTwu0lw7\\n\" +\n-            \"G\/MQPhLmj4DNsQJ\/nYzDcwIxAMw7iZExsY9Is66\/EaAty4rA+yuliwCag88VnDRH\\n\" +\n-            \"9cjiongZgpddIYS8xf76B2pi\/Q==\\n\" +\n-            \"-----END CERTIFICATE-----\";\n-\n-    \/\/ Owner: O=Microsoft Corporation, L=Redmond, ST=Washington, C=US\n-    \/\/ Issuer: CN=Microsoft ECC TLS Issuing AOC CA 01, O=Microsoft Corporation, C=US\n-    \/\/ Serial number: 3300000155ea28117be8708034000000000155\n-    \/\/ Valid from: Fri Oct 14 13:50:39 PDT 2022 until: Mon Oct 09 13:50:39 PDT 2023\n-    private static final String REVOKED = \"-----BEGIN CERTIFICATE-----\\n\" +\n-            \"MIIF3TCCBWOgAwIBAgITMwAAAVXqKBF76HCANAAAAAABVTAKBggqhkjOPQQDAzBb\\n\" +\n-            \"MQswCQYDVQQGEwJVUzEeMBwGA1UEChMVTWljcm9zb2Z0IENvcnBvcmF0aW9uMSww\\n\" +\n-            \"KgYDVQQDEyNNaWNyb3NvZnQgRUNDIFRMUyBJc3N1aW5nIEFPQyBDQSAwMTAeFw0y\\n\" +\n-            \"MjEwMTQyMDUwMzlaFw0yMzEwMDkyMDUwMzlaMFQxCzAJBgNVBAYTAlVTMRMwEQYD\\n\" +\n-            \"VQQIEwpXYXNoaW5ndG9uMRAwDgYDVQQHEwdSZWRtb25kMR4wHAYDVQQKExVNaWNy\\n\" +\n-            \"b3NvZnQgQ29ycG9yYXRpb24wdjAQBgcqhkjOPQIBBgUrgQQAIgNiAARbimHzMojc\\n\" +\n-            \"ilBoJCu+adc99oS855DwGTmkKofXfEf6Ej6G9v6Zg1Y2a1wqs5Wd3IcqQONeqKK8\\n\" +\n-            \"EGxUL7DBpf1dBDsRpWSfenYIRtAzs\/JznW0dfGPgnY0kGi4g52JegCOjggPuMIID\\n\" +\n-            \"6jCCAX4GCisGAQQB1nkCBAIEggFuBIIBagFoAHUArfe++nz\/EMiLnT2cHj4YarRn\\n\" +\n-            \"KV3PsQwkyoWGNOvcgooAAAGD2EyY+gAABAMARjBEAiBnysZazdmXKeL4CnYkJxI2\\n\" +\n-            \"g5juWT5jQfBi5Nxfc3zc9gIgGSGTTGw+E0864BRuAJjhFRF+j5keQ7Rik+PhGnd1\\n\" +\n-            \"P1gAdgB6MoxU2LcttiDqOOBSHumEFnAyE4VNO9IrwTpXo1LrUgAAAYPYTJjXAAAE\\n\" +\n-            \"AwBHMEUCIQDmYqZ1fw\/8X2lBl51TknJ8t8sRz4fEFkayqFrmNug1WQIgELQm99K3\\n\" +\n-            \"QH+Rr8rk9x6835NjXBBAyrrI2B8XLiELITUAdwCzc3cH4YRQ+GOG1gWp3BEJSnkt\\n\" +\n-            \"sWcMC4fc8AMOeTalmgAAAYPYTJkaAAAEAwBIMEYCIQD+jnAFon\/1Bobh3R4wzym7\\n\" +\n-            \"yiDQ35ZUeRcfFes1IvgyvgIhAPILSf2w3HW7YmbthAVT4P13G+8xFIVlYihgVegU\\n\" +\n-            \"cJy8MBsGCSsGAQQBgjcVCgQOMAwwCgYIKwYBBQUHAwEwPAYJKwYBBAGCNxUHBC8w\\n\" +\n-            \"LQYlKwYBBAGCNxUIh73XG4Hn60aCgZ0ujtAMh\/DaHV2Btd1QhZ\/9dQIBZAIBHTCB\\n\" +\n-            \"pgYIKwYBBQUHAQEEgZkwgZYwZQYIKwYBBQUHMAKGWWh0dHA6Ly93d3cubWljcm9z\\n\" +\n-            \"b2Z0LmNvbS9wa2lvcHMvY2VydHMvTWljcm9zb2Z0JTIwRUNDJTIwVExTJTIwSXNz\\n\" +\n-            \"dWluZyUyMEFPQyUyMENBJTIwMDEuY3J0MC0GCCsGAQUFBzABhiFodHRwOi8vb25l\\n\" +\n-            \"b2NzcC5taWNyb3NvZnQuY29tL29jc3AwHQYDVR0OBBYEFN3cgtHESQ8o7thvaL42\\n\" +\n-            \"bD7mpfktMA4GA1UdDwEB\/wQEAwIHgDArBgNVHREEJDAigiBydmtlY2Nyb290MjAx\\n\" +\n-            \"Ny5wa2kubWljcm9zb2Z0LmNvbTBoBgNVHR8EYTBfMF2gW6BZhldodHRwOi8vd3d3\\n\" +\n-            \"Lm1pY3Jvc29mdC5jb20vcGtpb3BzL2NybC9NaWNyb3NvZnQlMjBFQ0MlMjBUTFMl\\n\" +\n-            \"MjBJc3N1aW5nJTIwQU9DJTIwQ0ElMjAwMS5jcmwwZgYDVR0gBF8wXTBRBgwrBgEE\\n\" +\n-            \"AYI3TIN9AQEwQTA\/BggrBgEFBQcCARYzaHR0cDovL3d3dy5taWNyb3NvZnQuY29t\\n\" +\n-            \"L3BraW9wcy9Eb2NzL1JlcG9zaXRvcnkuaHRtMAgGBmeBDAECAjAfBgNVHSMEGDAW\\n\" +\n-            \"gBQxW7nOURt80aoDwOvtNl3CndOJ4TATBgNVHSUEDDAKBggrBgEFBQcDATAKBggq\\n\" +\n-            \"hkjOPQQDAwNoADBlAjBBhbuh\/iukcibeEh\/Op3RfNf6jUSyza4lZvsJsRiEVwySa\\n\" +\n-            \"ofmg8OvBO2l2+9MjoCUCMQCoiyS1tDgtjW9gguKDgPXypURpL27KfnCzwx6ar2LN\\n\" +\n-            \"gCZ\/soGnLsgPIscuNH\/BK20=\\n\" +\n-            \"-----END CERTIFICATE-----\";\n-\n-    public void runTest(ValidatePathWithParams pathValidator) throws Exception {\n-        \/\/ Validate valid\n-        pathValidator.validate(new String[]{VALID, INT},\n-                ValidatePathWithParams.Status.GOOD, null, System.out);\n-\n-        \/\/ Validate Revoked\n-        pathValidator.validate(new String[]{REVOKED, INT},\n-                ValidatePathWithParams.Status.REVOKED,\n-                \"Fri Oct 14 15:46:18 PDT 2022\", System.out);\n+        validatePathWithURL.validateDomain(VALID, false);\n+        validatePathWithURL.validateDomain(REVOKED, true);\n@@ -186,0 +74,3 @@\n+    private static final String VALID = \"https:\/\/actrsaroot2017.pki.microsoft.com\/\";\n+    private static final String REVOKED = \"https:\/\/rvkrsaroot2017.pki.microsoft.com\/\";\n+    private static final String CA_ALIAS = \"microsoftrsa2017 [jdk]\";\n@@ -187,155 +78,2 @@\n-    \/\/ Owner: CN=Microsoft RSA TLS Issuing AOC CA 01, O=Microsoft Corporation, C=US\n-    \/\/ Issuer: CN=Microsoft RSA Root Certificate Authority 2017, O=Microsoft\n-    \/\/ Corporation, C=US\n-    \/\/ Serial number: 330000002ffaf06f6697e2469c00000000002f\n-    \/\/ Valid from: Thu Jun 24 13:57:35 PDT 2021 until: Wed Jun 24 13:57:35 PDT 2026\n-    private static final String INT = \"-----BEGIN CERTIFICATE-----\\n\" +\n-            \"MIIHmDCCBYCgAwIBAgITMwAAAC\/68G9ml+JGnAAAAAAALzANBgkqhkiG9w0BAQwF\\n\" +\n-            \"ADBlMQswCQYDVQQGEwJVUzEeMBwGA1UEChMVTWljcm9zb2Z0IENvcnBvcmF0aW9u\\n\" +\n-            \"MTYwNAYDVQQDEy1NaWNyb3NvZnQgUlNBIFJvb3QgQ2VydGlmaWNhdGUgQXV0aG9y\\n\" +\n-            \"aXR5IDIwMTcwHhcNMjEwNjI0MjA1NzM1WhcNMjYwNjI0MjA1NzM1WjBbMQswCQYD\\n\" +\n-            \"VQQGEwJVUzEeMBwGA1UEChMVTWljcm9zb2Z0IENvcnBvcmF0aW9uMSwwKgYDVQQD\\n\" +\n-            \"EyNNaWNyb3NvZnQgUlNBIFRMUyBJc3N1aW5nIEFPQyBDQSAwMTCCAiIwDQYJKoZI\\n\" +\n-            \"hvcNAQEBBQADggIPADCCAgoCggIBAKAYz8zB6I+LeiWYURf1QUaISydvRgxWfcc6\\n\" +\n-            \"UvEiwvryj2UsRfFuREo2ErLTvP9qQ9E0YBTyWEqI2TXn4jo2uZ2cpGODiQQWlixe\\n\" +\n-            \"aAFcYgSqLzidFXj401vzQsz4E0zylD\/ZeY+xkQ6xrdg5312x2u2Ap7AWLzqolZHZ\\n\" +\n-            \"gR0aicn9gcO6M4qn6Uuge8mOve1N7U6j8ebhSiw0KlkzY9ha1Kvrez+NXQdeLC+V\\n\" +\n-            \"PDWPPPlBWeysTnIM6dusbV1v2\/C7Ooz9TuGb8wiXRriPpI7+igSIPqBebF00rHGJ\\n\" +\n-            \"Dmx9eN3g78VF9JpTrrRkV8alpMYVZKAh9IzMp9NWVZsw5wgZaX2W05SaXkSHP3zR\\n\" +\n-            \"OBANhKzwkBkCcDMbmF1LFOk+wgkcEtFlKEnfgvOQVHTp02gTzyhSxstw0buon4Cy\\n\" +\n-            \"ZAm1L+6bJJ+puNL8HuLTJxq1mqiaY0T50olJeySSX5uJBo\/l29Pz+0WjANnhRLVq\\n\" +\n-            \"e5xdxPV11QGHDxnvsXaMgC4y\/5sLo5v4UEZT+4VDcKiRHReusJD+kUt92FSYqWTK\\n\" +\n-            \"xs6zwuxf25as\/rJbZT99o9QVFLfHEs6DgHKNIqQuVxZxH0T3M6XqfmnRTo1FrD8i\\n\" +\n-            \"p\/93Q4zQta5S9whe\/sAxpizwyMw\/9fhBDHGVHfgFV1C0EP9zxkyHEya0CGAMhbzp\\n\" +\n-            \"+0Y\/ZYxrAgMBAAGjggJJMIICRTAOBgNVHQ8BAf8EBAMCAYYwEAYJKwYBBAGCNxUB\\n\" +\n-            \"BAMCAQAwHQYDVR0OBBYEFOtMMXw9PzK4g9fF23va5HjanBRXMB0GA1UdJQQWMBQG\\n\" +\n-            \"CCsGAQUFBwMBBggrBgEFBQcDAjAZBgkrBgEEAYI3FAIEDB4KAFMAdQBiAEMAQTAS\\n\" +\n-            \"BgNVHRMBAf8ECDAGAQH\/AgEAMB8GA1UdIwQYMBaAFAnLWX+GsnCPGsM548DZ6b+7\\n\" +\n-            \"TbIjMHAGA1UdHwRpMGcwZaBjoGGGX2h0dHA6Ly93d3cubWljcm9zb2Z0LmNvbS9w\\n\" +\n-            \"a2lvcHMvY3JsL01pY3Jvc29mdCUyMFJTQSUyMFJvb3QlMjBDZXJ0aWZpY2F0ZSUy\\n\" +\n-            \"MEF1dGhvcml0eSUyMDIwMTcuY3JsMIGuBggrBgEFBQcBAQSBoTCBnjBtBggrBgEF\\n\" +\n-            \"BQcwAoZhaHR0cDovL3d3dy5taWNyb3NvZnQuY29tL3BraW9wcy9jZXJ0cy9NaWNy\\n\" +\n-            \"b3NvZnQlMjBSU0ElMjBSb290JTIwQ2VydGlmaWNhdGUlMjBBdXRob3JpdHklMjAy\\n\" +\n-            \"MDE3LmNydDAtBggrBgEFBQcwAYYhaHR0cDovL29uZW9jc3AubWljcm9zb2Z0LmNv\\n\" +\n-            \"bS9vY3NwMHAGA1UdIARpMGcwCAYGZ4EMAQIBMAgGBmeBDAECAjBRBgwrBgEEAYI3\\n\" +\n-            \"TIN9AQEwQTA\/BggrBgEFBQcCARYzaHR0cDovL3d3dy5taWNyb3NvZnQuY29tL3Br\\n\" +\n-            \"aW9wcy9Eb2NzL1JlcG9zaXRvcnkuaHRtMA0GCSqGSIb3DQEBDAUAA4ICAQAkucWk\\n\" +\n-            \"Mrgs2ahYrG7y4sY2yZno4f9TGyk7p+Srg4Yz\/g7LmVeyOob9o579Omw9AiyeDK8Y\\n\" +\n-            \"\/dXnTTof+sKJrlNTpIzyEBkzCiGGkWtp7x2yxLCm12L65wtmD\/6OAV9Bm1kOhf3p\\n\" +\n-            \"7v+d3gtFt7cw46W35lr+fguy62s7uuytTV9hfhQ0pp2E2E9F6B7U71jR4bC+6zGq\\n\" +\n-            \"+34AmqTirjKHwXOhWDRDpEJIkaFAh+qdz\/nqJktZj3n5GdC94jfWrMUJjClGjlc4\\n\" +\n-            \"+Ws3AxN46oFpx8oIXDG9wIPfFhUf0SdnCYJL8TD5+qBNp0H5q\/V2R31Wi8rijHGQ\\n\" +\n-            \"4CxHqzP5VJbjgvRQgxAp39BrmLQ+JSvf9e5VqQqaH4NYgpB1WObq12B73BJHjBOv\\n\" +\n-            \"pRrULFjPqDW8sPRBzBTRXkXOPEdZbzQj6O\/CWEFsg6ilO4thk3n3drb9FEJjVh9u\\n\" +\n-            \"GtRXV6Ea5bNaPvJppZNXb7M9mORk3mddx\/K1FgOETQE3quh+mU4ojbSRUWMVmjcb\\n\" +\n-            \"6bKF5oQd+Q0do4yaEIfH1oVnIas\/FIE\/xu3Z4fvBs0qdiNLCeNT6uS26vqD2PEvV\\n\" +\n-            \"lFWb683Do3Ls59MMCxhy6Erb7kFQgu1oUWXGFhbMQkeLN4TXGi6X3loXYfING9om\\n\" +\n-            \"nWa\/udxvPRwAZmcHU2l2W8cwVXiy6uucsh3kPQ==\\n\" +\n-            \"-----END CERTIFICATE-----\";\n-\n-    \/\/ Owner: O=Microsoft Corporation, L=Redmond, ST=Washington, C=US\n-    \/\/ Issuer: CN=Microsoft RSA TLS Issuing AOC CA 01, O=Microsoft Corporation, C=US\n-    \/\/ Serial number: 330000014a3b44c12636e54b9f00000000014a\n-    \/\/ Valid from: Fri Oct 14 13:55:34 PDT 2022 until: Mon Oct 09 13:55:34 PDT 2023\n-    private static final String VALID = \"-----BEGIN CERTIFICATE-----\\n\" +\n-            \"MIIILDCCBhSgAwIBAgITMwAAAUo7RMEmNuVLnwAAAAABSjANBgkqhkiG9w0BAQwF\\n\" +\n-            \"ADBbMQswCQYDVQQGEwJVUzEeMBwGA1UEChMVTWljcm9zb2Z0IENvcnBvcmF0aW9u\\n\" +\n-            \"MSwwKgYDVQQDEyNNaWNyb3NvZnQgUlNBIFRMUyBJc3N1aW5nIEFPQyBDQSAwMTAe\\n\" +\n-            \"Fw0yMjEwMTQyMDU1MzRaFw0yMzEwMDkyMDU1MzRaMFQxCzAJBgNVBAYTAlVTMRMw\\n\" +\n-            \"EQYDVQQIEwpXYXNoaW5ndG9uMRAwDgYDVQQHEwdSZWRtb25kMR4wHAYDVQQKExVN\\n\" +\n-            \"aWNyb3NvZnQgQ29ycG9yYXRpb24wggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEK\\n\" +\n-            \"AoIBAQDTo\/3ysrrKP2eOLQ8JUFhQT09HJM1lUr0nH7RiP4VAKFrGFMIQSCsq17y7\\n\" +\n-            \"PuTHxW53Fvxb5s\/EKZobzhlgv4rHQxvoMuGWRBgJN6KfspQAuFnUVG+3y70fHy\/O\\n\" +\n-            \"PiVUJdfTupsys\/fjzERqzx6FZoU1RzQ08na36SicSOQmj5svtHHxL8ZibDD48Xzp\\n\" +\n-            \"oIEBh2uUDhevkZedBmqlIdAhNgKXqf2lieLjWXZQLzUyXHikQJxNFOHFVjBqH3pu\\n\" +\n-            \"pYt2XD78bS\/xeKRbGLw52+o3\/u4eaPyiJoG0GaVSG2HRGcplu7Auk6ycD3htispr\\n\" +\n-            \"dviXfHa3tW1hO52PrQBOWvpsP3jdAgMBAAGjggPuMIID6jCCAX4GCisGAQQB1nkC\\n\" +\n-            \"BAIEggFuBIIBagFoAHUA6D7Q2j71BjUy51covIlryQPTy9ERa+zraeF3fW0GvW4A\\n\" +\n-            \"AAGD2FEl4wAABAMARjBEAiBStVFeTYxl3DxgsM2z7VsvWZ5n7V0SXjnNdgFfmjfL\\n\" +\n-            \"twIgQ6Xfm7oJQDMyBIuPVF0qxLr+EqZ71HDHz5n6g60orlcAdgB6MoxU2LcttiDq\\n\" +\n-            \"OOBSHumEFnAyE4VNO9IrwTpXo1LrUgAAAYPYUSX8AAAEAwBHMEUCIFbeyJxWClLT\\n\" +\n-            \"C1YjUizDHmL5TeKFluRsL0of3NXn7LXuAiEAoZLtiZOie9QLWA66IN3NO8F4VE72\\n\" +\n-            \"m4hZyo0tcJ2FrDkAdwCzc3cH4YRQ+GOG1gWp3BEJSnktsWcMC4fc8AMOeTalmgAA\\n\" +\n-            \"AYPYUSZUAAAEAwBIMEYCIQD7nnuRlDX0iUH+vfbl3aKgn6siy8fL5Dl6HczdPXgD\\n\" +\n-            \"2AIhAJE6xuIKnLOC\/BqVG8DydYmhM17TTSK3T98pBtvU9SDcMBsGCSsGAQQBgjcV\\n\" +\n-            \"CgQOMAwwCgYIKwYBBQUHAwEwPAYJKwYBBAGCNxUHBC8wLQYlKwYBBAGCNxUIh73X\\n\" +\n-            \"G4Hn60aCgZ0ujtAMh\/DaHV2Btd1QhZ\/9dQIBZAIBHTCBpgYIKwYBBQUHAQEEgZkw\\n\" +\n-            \"gZYwZQYIKwYBBQUHMAKGWWh0dHA6Ly93d3cubWljcm9zb2Z0LmNvbS9wa2lvcHMv\\n\" +\n-            \"Y2VydHMvTWljcm9zb2Z0JTIwUlNBJTIwVExTJTIwSXNzdWluZyUyMEFPQyUyMENB\\n\" +\n-            \"JTIwMDEuY3J0MC0GCCsGAQUFBzABhiFodHRwOi8vb25lb2NzcC5taWNyb3NvZnQu\\n\" +\n-            \"Y29tL29jc3AwHQYDVR0OBBYEFJ+DafMSR5RMWJrM6iGS024FVuBYMA4GA1UdDwEB\\n\" +\n-            \"\/wQEAwIEsDArBgNVHREEJDAigiBhY3Ryc2Fyb290MjAxNy5wa2kubWljcm9zb2Z0\\n\" +\n-            \"LmNvbTBoBgNVHR8EYTBfMF2gW6BZhldodHRwOi8vd3d3Lm1pY3Jvc29mdC5jb20v\\n\" +\n-            \"cGtpb3BzL2NybC9NaWNyb3NvZnQlMjBSU0ElMjBUTFMlMjBJc3N1aW5nJTIwQU9D\\n\" +\n-            \"JTIwQ0ElMjAwMS5jcmwwZgYDVR0gBF8wXTBRBgwrBgEEAYI3TIN9AQEwQTA\/Bggr\\n\" +\n-            \"BgEFBQcCARYzaHR0cDovL3d3dy5taWNyb3NvZnQuY29tL3BraW9wcy9Eb2NzL1Jl\\n\" +\n-            \"cG9zaXRvcnkuaHRtMAgGBmeBDAECAjAfBgNVHSMEGDAWgBTrTDF8PT8yuIPXxdt7\\n\" +\n-            \"2uR42pwUVzATBgNVHSUEDDAKBggrBgEFBQcDATANBgkqhkiG9w0BAQwFAAOCAgEA\\n\" +\n-            \"j80IEKdsV\/mWM5LwiS12qjOFzukGhpaFgM4XVQV9QJ\/oEwworf7KEFfp4YlrSbtw\\n\" +\n-            \"Wwrh06LESleEfCqY+pbYHUx6ox4LvI5EYu23+YINSdhkTaITFZ1DDrYEHX08r26I\\n\" +\n-            \"rdaTkUOLzP9CRuSw1tbcf0gsj\/Dqr8ec3usktccOE6QFbCA9yCsKOr6WdPc4h3PV\\n\" +\n-            \"WKHnpf4n46fZ+N+d7+eAOUZSjqsw\/5i6\/yiQ0Vx6rBMSKmEzkZx72Xkh9IowCeZJ\\n\" +\n-            \"w\/gstrzKepSljWUuNi2iXJB2OuIqydFodLXFc9eeH8MXShDqwFF77nf3R3jMAhvI\\n\" +\n-            \"6fHnEz7+UqhMuyiAU5TfSjC1WyeqHhDZawWPumFyXEh0XX1eUphfoN3bApbZJhEE\\n\" +\n-            \"tyhcz44mGawrjSpxlJGgE5TmKJ+CC73TcBC5Ehelo+Is1gzbbVQCu6gMZQyYS8qf\\n\" +\n-            \"kg+JqJAOfx+YFn4bPAio8uF6XpcvMkcd9dyEYi2Q9zMhnQoOjLWj0pPSQaCBmmbI\\n\" +\n-            \"ougVo16GCOdcOG9+c6dBjbHseaQY0a95ZirtNLbutIvmvMIysvAHMC3NkunnD0cQ\\n\" +\n-            \"BxF47+meDc80QJGCaNlJ8E1SlUbEtRfVNsbcw1skO3hAsYAIA8M\/\/BW7XcKRDvLn\\n\" +\n-            \"nPrC+5fWtDzmXgUE\/Sve3rCr\/AfBiBrLERcJHxYy41U=\\n\" +\n-            \"-----END CERTIFICATE-----\";\n-\n-    \/\/ Owner: O=Microsoft Corporation, L=Redmond, ST=Washington, C=US\n-    \/\/ Issuer: CN=Microsoft RSA TLS Issuing AOC CA 01, O=Microsoft Corporation, C=US\n-    \/\/ Serial number: 330000014b4c2b0b9955688feb00000000014b\n-    \/\/ Valid from: Fri Oct 14 13:56:58 PDT 2022 until: Mon Oct 09 13:56:58 PDT 2023\n-    private static final String REVOKED = \"-----BEGIN CERTIFICATE-----\\n\" +\n-            \"MIIIKjCCBhKgAwIBAgITMwAAAUtMKwuZVWiP6wAAAAABSzANBgkqhkiG9w0BAQwF\\n\" +\n-            \"ADBbMQswCQYDVQQGEwJVUzEeMBwGA1UEChMVTWljcm9zb2Z0IENvcnBvcmF0aW9u\\n\" +\n-            \"MSwwKgYDVQQDEyNNaWNyb3NvZnQgUlNBIFRMUyBJc3N1aW5nIEFPQyBDQSAwMTAe\\n\" +\n-            \"Fw0yMjEwMTQyMDU2NThaFw0yMzEwMDkyMDU2NThaMFQxCzAJBgNVBAYTAlVTMRMw\\n\" +\n-            \"EQYDVQQIEwpXYXNoaW5ndG9uMRAwDgYDVQQHEwdSZWRtb25kMR4wHAYDVQQKExVN\\n\" +\n-            \"aWNyb3NvZnQgQ29ycG9yYXRpb24wggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEK\\n\" +\n-            \"AoIBAQD2UxPzrv61IqG8jCFPWM3KeQpBeBlxh3mzvWVFmo340r0J1C3uLaUTPYLo\\n\" +\n-            \"P+Xndq2GqYLlm\/5FEY7ynU1as57SH0tHbKCIYYJezn\/ZJHUYcOY80uGKpP3bdbRq\\n\" +\n-            \"W51Xo7\/gzTrXFJ2Nrn05d9mKBq+Oxs71+Nj7QuzjHYAF0n8OWNwZCBOBdAX3EDVQ\\n\" +\n-            \"4HBMSkIzriodM0FD2zkT8RIvZ7WbpLxvZXqWbynAeLirTRYE2lY9UalxrP+wCef9\\n\" +\n-            \"DARxcpEgF30nwRnALfOhnuOhdrtdLYhArfQMyDcvJnDyzCWEZCaPNtBhdsziJjf9\\n\" +\n-            \"A8R4\/qdnlQE4\/24O9MXQja5dwyyRAgMBAAGjggPsMIID6DCCAXwGCisGAQQB1nkC\\n\" +\n-            \"BAIEggFsBIIBaAFmAHYA6D7Q2j71BjUy51covIlryQPTy9ERa+zraeF3fW0GvW4A\\n\" +\n-            \"AAGD2FJirgAABAMARzBFAiBct8qI4aiBtisWWMKAtwCueQWAnFtxcrGBiZjwctiB\\n\" +\n-            \"pwIhAPasvYgCS4Rbhb6p2\/\/TCeq0P2H3jUftmi0afwhJYXLaAHUAs3N3B+GEUPhj\\n\" +\n-            \"htYFqdwRCUp5LbFnDAuH3PADDnk2pZoAAAGD2FJjIwAABAMARjBEAiBjbry24wGs\\n\" +\n-            \"tpzJFzxWAk7h3IHMKiY1KxIieJMBe7k1dQIgPvDrVgOiUeWlYJmDSdRafTVZHfQg\\n\" +\n-            \"bODj86WqyB5ndt4AdQB6MoxU2LcttiDqOOBSHumEFnAyE4VNO9IrwTpXo1LrUgAA\\n\" +\n-            \"AYPYUmLUAAAEAwBGMEQCIHlmAPOJT2CSJPnupJqbiUOE8nukIuNxaayaEROQQC16\\n\" +\n-            \"AiBufiWDUp9FNjGdZVhjX3t\/Bh3iSNrMJD22k5BcNzUbIjAbBgkrBgEEAYI3FQoE\\n\" +\n-            \"DjAMMAoGCCsGAQUFBwMBMDwGCSsGAQQBgjcVBwQvMC0GJSsGAQQBgjcVCIe91xuB\\n\" +\n-            \"5+tGgoGdLo7QDIfw2h1dgbXdUIWf\/XUCAWQCAR0wgaYGCCsGAQUFBwEBBIGZMIGW\\n\" +\n-            \"MGUGCCsGAQUFBzAChllodHRwOi8vd3d3Lm1pY3Jvc29mdC5jb20vcGtpb3BzL2Nl\\n\" +\n-            \"cnRzL01pY3Jvc29mdCUyMFJTQSUyMFRMUyUyMElzc3VpbmclMjBBT0MlMjBDQSUy\\n\" +\n-            \"MDAxLmNydDAtBggrBgEFBQcwAYYhaHR0cDovL29uZW9jc3AubWljcm9zb2Z0LmNv\\n\" +\n-            \"bS9vY3NwMB0GA1UdDgQWBBQVaBKJl3UpdKhMrW9owCC3eUdMWzAOBgNVHQ8BAf8E\\n\" +\n-            \"BAMCBLAwKwYDVR0RBCQwIoIgcnZrcnNhcm9vdDIwMTcucGtpLm1pY3Jvc29mdC5j\\n\" +\n-            \"b20waAYDVR0fBGEwXzBdoFugWYZXaHR0cDovL3d3dy5taWNyb3NvZnQuY29tL3Br\\n\" +\n-            \"aW9wcy9jcmwvTWljcm9zb2Z0JTIwUlNBJTIwVExTJTIwSXNzdWluZyUyMEFPQyUy\\n\" +\n-            \"MENBJTIwMDEuY3JsMGYGA1UdIARfMF0wUQYMKwYBBAGCN0yDfQEBMEEwPwYIKwYB\\n\" +\n-            \"BQUHAgEWM2h0dHA6Ly93d3cubWljcm9zb2Z0LmNvbS9wa2lvcHMvRG9jcy9SZXBv\\n\" +\n-            \"c2l0b3J5Lmh0bTAIBgZngQwBAgIwHwYDVR0jBBgwFoAU60wxfD0\/MriD18Xbe9rk\\n\" +\n-            \"eNqcFFcwEwYDVR0lBAwwCgYIKwYBBQUHAwEwDQYJKoZIhvcNAQEMBQADggIBAFHb\\n\" +\n-            \"lQDG\/Jk+kOLRWlZiya00OkZiXrueh4NgfwybZAx3O344+FzP4TsneUys16GO7Pti\\n\" +\n-            \"UTKkxF42INw\/3TAC4iOMg4RS4dm+Fn1G7xM59lwqnZLn48a6jORKwZIG0H\/2Fevr\\n\" +\n-            \"bGn3ZcTw+NP02OA7X1\/ewRfljDZfHNmzdVTSVlqzhliv2cRuZyk7lf1LoIXBTz3Y\\n\" +\n-            \"6ofOjgsP05XEZmMxMwM40FVeslTfuu301plj5KuHpQfbSny0VES3DQnZi+gHX+Zn\\n\" +\n-            \"XuIYQL9stePqQr1GJBqAHM4sRgUCnW5t8efIYDMpYhQynXbniowLGbXOa0OP1IFG\\n\" +\n-            \"oGmhPRonR1aJ2eFBfe0pnc4WO5qdiXQp\/XWWYmUJaD7SdGDQF7wH9BUJdldIk6uI\\n\" +\n-            \"SGTh4YD2VAXAGH4e9wHI5t9Lyah\/VeBoLU1j3SsJfL6XfcWCwFG2sdqFFQHcONBl\\n\" +\n-            \"ApIjebH4RlOGiRRRJ5\/Wz9Wk850mEvF16UlB1MUpLiKU63\/nJvuR1TvOisAUl+5L\\n\" +\n-            \"oAfBFVkX4IGJU+9tc4VXYvTpd24xLHk\/o6Fnl23D6zWlsZKldNxYPhiriXN9Duvb\\n\" +\n-            \"6xmaQX4gua6jmTFUhKDyyVJpW1A4GjuenPYsCmabzydiAeMIQirCCLSTqXrSw1YL\\n\" +\n-            \"2+608l1nqYy1JOrSq\/zFp3c5buSFbjj7jVJB5LEh\\n\" +\n-            \"-----END CERTIFICATE-----\";\n-\n-    public void runTest(ValidatePathWithParams pathValidator) throws Exception {\n-        \/\/ Validate valid\n-        pathValidator.validate(new String[]{VALID, INT},\n-                ValidatePathWithParams.Status.GOOD, null, System.out);\n+    public void runTest() throws Exception {\n+        ValidatePathWithURL validatePathWithURL = new ValidatePathWithURL(CA_ALIAS);\n@@ -343,4 +81,2 @@\n-        \/\/ Validate Revoked\n-        pathValidator.validate(new String[]{REVOKED, INT},\n-                ValidatePathWithParams.Status.REVOKED,\n-                \"Fri Oct 14 15:46:18 PDT 2022\", System.out);\n+        validatePathWithURL.validateDomain(VALID, false);\n+        validatePathWithURL.validateDomain(REVOKED, true);\n","filename":"test\/jdk\/security\/infra\/java\/security\/cert\/CertPathValidator\/certification\/MicrosoftTLS.java","additions":30,"deletions":294,"binary":false,"changes":324,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2017, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2017, 2023, Oracle and\/or its affiliates. All rights reserved.\n@@ -25,5 +25,6 @@\n- * @test\n- * @bug 8189131 8207059\n- * @key intermittent\n- * @summary Interoperability tests with QuoVadis Root CA1, CA2, and CA3 G3 CAs\n- * @build ValidatePathWithParams\n+ * @test id=OCSP\n+ * @bug 8189131\n+ * @summary Interoperability tests with QuoVadis Root CA1, CA2, and CA3 G3 CAs using OCSP\n+ * @library \/test\/lib\n+ * @build jtreg.SkippedException\n+ * @build ValidatePathWithURL\n@@ -31,0 +32,9 @@\n+ *\/\n+\n+\/*\n+ * @test id=CRL\n+ * @bug 8189131\n+ * @summary Interoperability tests with QuoVadis Root CA1, CA2, and CA3 G3 CAs using CRL\n+ * @library \/test\/lib\n+ * @build jtreg.SkippedException\n+ * @build ValidatePathWithURL\n@@ -41,1 +51,0 @@\n-\n@@ -44,2 +53,0 @@\n-        ValidatePathWithParams pathValidator = new ValidatePathWithParams(null);\n-\n@@ -47,1 +54,1 @@\n-            pathValidator.enableCRLCheck();\n+            ValidatePathWithURL.enableCRLOnly();\n@@ -50,1 +57,1 @@\n-            pathValidator.enableOCSPCheck();\n+            ValidatePathWithURL.enableOCSPOnly();\n@@ -53,3 +60,3 @@\n-        new RootCA1G3().runTest(pathValidator);\n-        new RootCA2G3().runTest(pathValidator);\n-        new RootCA3G3().runTest(pathValidator);\n+        new RootCA1G3().runTest();\n+        new RootCA2G3().runTest();\n+        new RootCA3G3().runTest();\n@@ -60,0 +67,3 @@\n+    private static final String VALID = \"https:\/\/quovadis-root-ca-1-g3.chain-demos.digicert.com\/\";\n+    private static final String REVOKED = \"https:\/\/quovadis-root-ca-1-g3-revoked.chain-demos.digicert.com\/\";\n+    private static final String CA_ALIAS = \"quovadisrootca1g3 [jdk]\";\n@@ -61,128 +71,2 @@\n-    \/\/ Owner: CN=DigiCert QuoVadis TLS ICA QV Root CA 1 G3, O=\"DigiCert, Inc\", C=US\n-    \/\/ Issuer: CN=QuoVadis Root CA 1 G3, O=QuoVadis Limited, C=BM\n-    \/\/ Serial number: 2837d5c3c2b57294becf99afe8bbdcd1bb0b20f1\n-    \/\/ Valid from: Wed Jan 06 12:50:51 PST 2021 until: Sat Jan 04 12:50:51 PST 2031\n-    private static final String INT = \"-----BEGIN CERTIFICATE-----\\n\" +\n-            \"MIIFgDCCA2igAwIBAgIUKDfVw8K1cpS+z5mv6Lvc0bsLIPEwDQYJKoZIhvcNAQEL\\n\" +\n-            \"BQAwSDELMAkGA1UEBhMCQk0xGTAXBgNVBAoTEFF1b1ZhZGlzIExpbWl0ZWQxHjAc\\n\" +\n-            \"BgNVBAMTFVF1b1ZhZGlzIFJvb3QgQ0EgMSBHMzAeFw0yMTAxMDYyMDUwNTFaFw0z\\n\" +\n-            \"MTAxMDQyMDUwNTFaMFkxCzAJBgNVBAYTAlVTMRYwFAYDVQQKDA1EaWdpQ2VydCwg\\n\" +\n-            \"SW5jMTIwMAYDVQQDDClEaWdpQ2VydCBRdW9WYWRpcyBUTFMgSUNBIFFWIFJvb3Qg\\n\" +\n-            \"Q0EgMSBHMzCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBALMrbkb9kz\/4\\n\" +\n-            \"y00r7tfK+uDRomMNd5iCDVMWOvSx1VygKoBn3aavw7gq9Vfb2fIMIWkWG0GMxWbG\\n\" +\n-            \"cx3wDHLWemd7yl9MxRUTGXkvH6\/dNEavAQhUTL9TSf\/N2e8f7q2dRDNYT7lXi\/vR\\n\" +\n-            \"fTBiYlY7BLNha8C3sPHsKduaJN32cjdjVFH51rFDRdhUXlo2hhOjgB6bqoqs75A3\\n\" +\n-            \"Y3w88AdbMkapT63oGsCDO6N\/uX2Mo9GSWREvlxHiXSMFf5qFw41vn5QIa5ADL1MP\\n\" +\n-            \"CzlLmJSHXE138H1+cG5IutD7tIieKjo\/t+66PGMo8xicj3yUd8rHEmBqClG4Ty3d\\n\" +\n-            \"fF+bETFjLIUCAwEAAaOCAU8wggFLMBIGA1UdEwEB\/wQIMAYBAf8CAQAwHwYDVR0j\\n\" +\n-            \"BBgwFoAUo5fW816iEOGrRZ88F2Q87gFwnMwwdAYIKwYBBQUHAQEEaDBmMDgGCCsG\\n\" +\n-            \"AQUFBzAChixodHRwOi8vdHJ1c3QucXVvdmFkaXNnbG9iYWwuY29tL3F2cmNhMWcz\\n\" +\n-            \"LmNydDAqBggrBgEFBQcwAYYeaHR0cDovL29jc3AucXVvdmFkaXNnbG9iYWwuY29t\\n\" +\n-            \"MBMGA1UdIAQMMAowCAYGZ4EMAQICMB0GA1UdJQQWMBQGCCsGAQUFBwMCBggrBgEF\\n\" +\n-            \"BQcDATA7BgNVHR8ENDAyMDCgLqAshipodHRwOi8vY3JsLnF1b3ZhZGlzZ2xvYmFs\\n\" +\n-            \"LmNvbS9xdnJjYTFnMy5jcmwwHQYDVR0OBBYEFJkRfemwrS1iWnDTPI2HIK3a2i5B\\n\" +\n-            \"MA4GA1UdDwEB\/wQEAwIBhjANBgkqhkiG9w0BAQsFAAOCAgEAb6tTptzzi4ssb+jA\\n\" +\n-            \"n2O2vAjAo7ydlfN9v+QH0ZuGHlUc9bm8dpNpBo9yt6fWHIprGLJjVOF7HwVDQcJD\\n\" +\n-            \"DhX4638Q7ETDrbTVQ4\/edX6Yesq6C1G8Pza1LwStXD\/jCQHFvWbPud86V0ikS4rS\\n\" +\n-            \"qlmu3fzUrGZ2\/Q+n5jrnRqM5IS8TXYcnzLD3azH1+aZjkwQt9HP4IuvAe\/Bg9aWE\\n\" +\n-            \"XeDmksbg0SqQInrWn+BVYtD+hCZNz8K0GnKKpx3Q9VxzRv+BMbO5e9iqK1Hcj5Wv\\n\" +\n-            \"ZXvU45j2r5y9WML4fc8CvphzbF6ezr1e51i+yabNmfld33gRX48V5oNk16wX32ed\\n\" +\n-            \"kQ83sKNomQm1dXURWK8aSDcZFAvJQ8vKTLIE9wiQmtjfSGoJzQhKLaN+egrp4L9y\\n\" +\n-            \"fjpFIeK4zgAH39P4s4kaPWTdfXe2n6P5o7Xolp4R22SVkI76d8d+5Iv7Rtqd+mqI\\n\" +\n-            \"y1hkwyTBbOBLtyF7yMtJQewkkZ0MWxkPvWg193RbYVRx8w1EycnxMgNwy2sJw7MR\\n\" +\n-            \"XM6Mihkw910BkvlbsFUXw4uSvRkkRWSBWVrkM5hvZGtbIJkqrdnj55RSk4DLOOT\/\\n\" +\n-            \"LUyji\/KpgD7YCi7emFA4tH6OpkNrjUJ3gdRnD4GwQj\/87tYeoQWZ6uCl0MHDUCmw\\n\" +\n-            \"73bpxSkjPrYbmKo9mGEAMhW1ZxY=\\n\" +\n-            \"-----END CERTIFICATE-----\";\n-\n-    \/\/ Owner: CN=quovadis-root-ca-1-g3.chain-demos.digicert.com, O=\"DigiCert, Inc.\",\n-    \/\/        L=Lehi, ST=Utah, C=US\n-    \/\/ Issuer: CN=DigiCert QuoVadis TLS ICA QV Root CA 1 G3, O=\"DigiCert, Inc\", C=US\n-    \/\/ Serial number: a94cc08600f5fe5d3f0659bfcfec6f0\n-    \/\/ Valid from: Fri Mar 04 16:00:00 PST 2022 until: Wed Apr 05 16:59:59 PDT 2023\n-    private static final String VALID = \"-----BEGIN CERTIFICATE-----\\n\" +\n-            \"MIIG\/DCCBeSgAwIBAgIQCpTMCGAPX+XT8GWb\/P7G8DANBgkqhkiG9w0BAQsFADBZ\\n\" +\n-            \"MQswCQYDVQQGEwJVUzEWMBQGA1UECgwNRGlnaUNlcnQsIEluYzEyMDAGA1UEAwwp\\n\" +\n-            \"RGlnaUNlcnQgUXVvVmFkaXMgVExTIElDQSBRViBSb290IENBIDEgRzMwHhcNMjIw\\n\" +\n-            \"MzA1MDAwMDAwWhcNMjMwNDA1MjM1OTU5WjB9MQswCQYDVQQGEwJVUzENMAsGA1UE\\n\" +\n-            \"CBMEVXRhaDENMAsGA1UEBxMETGVoaTEXMBUGA1UEChMORGlnaUNlcnQsIEluYy4x\\n\" +\n-            \"NzA1BgNVBAMTLnF1b3ZhZGlzLXJvb3QtY2EtMS1nMy5jaGFpbi1kZW1vcy5kaWdp\\n\" +\n-            \"Y2VydC5jb20wggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQC3HrwaCagg\\n\" +\n-            \"6bxmgEC+neLN\/ShfNYuOMQ2Slk5q\/zDUhQRpNQnh3nUwoRSWRvwGxDFsRj++LECF\\n\" +\n-            \"TMdfzIu+0rlFzGqd3B5mlRsJrcycy\/+ILwGNtIooUSU7pvJAVgLZ5N1SSVZoY+i3\\n\" +\n-            \"bqLiMmv2\/JfouT1SQB3U0tGmS+QKyBtVyKPVeuAhnLdyw90UiB7Gu9qXQpCawac8\\n\" +\n-            \"pXPQLFzyEP7VJO0wDXanXvi6YPuIhh4m+j2YVCd9d2zI3y3kOrkuaUY5UCBvMG\/b\\n\" +\n-            \"Pc7\/5pBsqf+E+7RHF24JAR2aqXzARWt2MzRiwpE\/DJDfu097IUtR5aEdCRIKw\/b4\\n\" +\n-            \"GcHEbVaE3c8RAgMBAAGjggOaMIIDljAfBgNVHSMEGDAWgBSZEX3psK0tYlpw0zyN\\n\" +\n-            \"hyCt2touQTAdBgNVHQ4EFgQUsG1\/1d7ATEocqm82IRByZD\/1qQIwOQYDVR0RBDIw\\n\" +\n-            \"MIIucXVvdmFkaXMtcm9vdC1jYS0xLWczLmNoYWluLWRlbW9zLmRpZ2ljZXJ0LmNv\\n\" +\n-            \"bTAOBgNVHQ8BAf8EBAMCBaAwHQYDVR0lBBYwFAYIKwYBBQUHAwEGCCsGAQUFBwMC\\n\" +\n-            \"MIGXBgNVHR8EgY8wgYwwRKBCoECGPmh0dHA6Ly9jcmwzLmRpZ2ljZXJ0LmNvbS9E\\n\" +\n-            \"aWdpQ2VydFF1b1ZhZGlzVExTSUNBUVZSb290Q0ExRzMuY3JsMESgQqBAhj5odHRw\\n\" +\n-            \"Oi8vY3JsNC5kaWdpY2VydC5jb20vRGlnaUNlcnRRdW9WYWRpc1RMU0lDQVFWUm9v\\n\" +\n-            \"dENBMUczLmNybDA+BgNVHSAENzA1MDMGBmeBDAECAjApMCcGCCsGAQUFBwIBFhto\\n\" +\n-            \"dHRwOi8vd3d3LmRpZ2ljZXJ0LmNvbS9DUFMwgYMGCCsGAQUFBwEBBHcwdTAkBggr\\n\" +\n-            \"BgEFBQcwAYYYaHR0cDovL29jc3AuZGlnaWNlcnQuY29tME0GCCsGAQUFBzAChkFo\\n\" +\n-            \"dHRwOi8vY2FjZXJ0cy5kaWdpY2VydC5jb20vRGlnaUNlcnRRdW9WYWRpc1RMU0lD\\n\" +\n-            \"QVFWUm9vdENBMUczLmNydDAJBgNVHRMEAjAAMIIBfQYKKwYBBAHWeQIEAgSCAW0E\\n\" +\n-            \"ggFpAWcAdgCt9776fP8QyIudPZwePhhqtGcpXc+xDCTKhYY069yCigAAAX9cPNEg\\n\" +\n-            \"AAAEAwBHMEUCIEcb3zz7lhKT26HkZpFPF9e7AsHY4HR3pO5LJ5+b2iDGAiEAjEHh\\n\" +\n-            \"4H3Vl+j95X65uBdkODnqjlxRc6OrqCRor71nKTYAdQA1zxkbv7FsV78PrUxtQsu7\\n\" +\n-            \"ticgJlHqP+Eq76gDwzvWTAAAAX9cPNEMAAAEAwBGMEQCIBbRZ9t9oUODHhZfa7n3\\n\" +\n-            \"0lGGmEpnZP9dZw375SuVX6OjAiBbfpZesx7GgSNygEF+zkBAXx+AFJF5GoGiOjFX\\n\" +\n-            \"0ykjDAB2ALNzdwfhhFD4Y4bWBancEQlKeS2xZwwLh9zwAw55NqWaAAABf1w80SoA\\n\" +\n-            \"AAQDAEcwRQIgfSXjtjuKjFiVYwdlitFNgTTSc7uP9hyazlrCKO9GsaYCIQCKimXl\\n\" +\n-            \"j4LjJ4BlG9H1J+V747tuf7ONnAzkCPsa2ymOuzANBgkqhkiG9w0BAQsFAAOCAQEA\\n\" +\n-            \"b9havJS9egan+4dgMhI6gDt6rjdWRniyi7kXv7\/vWJXOxR1xl2d\/WYDLsfp3BbqW\\n\" +\n-            \"YuKQwB5tTH1hEoNhQIyGnuE1Y1ZgtX24rSVfTCkU\/3dnTZaIhaZgFHyftAum7xSI\\n\" +\n-            \"Qzu7pwih+PXrGNXupsnZ+VUE7a7zHyRDajixhSp7dZS4zLoDTxeyKX0MDmo4e8Mi\\n\" +\n-            \"HNYVASYcrdld90jVJaeI\/V3EkJAX7\/Eyo9JqzivEwGM0e0JhCLekcVSzhjGoAlbQ\\n\" +\n-            \"tIzCIaeVUlWKKiNXSKr1WD4oCD3ky4Y5VekTGzyUf\/0LYzV+Y7p8epc5vTWKwYx\/\\n\" +\n-            \"vQwJ4RsgFit+c84mSg4qug==\\n\" +\n-            \"-----END CERTIFICATE-----\";\n-\n-    \/\/ Owner: CN=quovadis-root-ca-1-g3-revoked.chain-demos.digicert.com,\n-    \/\/        O=\"DigiCert, Inc.\", L=Lehi, ST=Utah, C=US\n-    \/\/ Issuer: CN=DigiCert QuoVadis TLS ICA QV Root CA 1 G3, O=\"DigiCert, Inc\", C=US\n-    \/\/ Serial number: e7eff4cdd14ebed1daa7bb7e07300ed\n-    \/\/ Valid from: Fri Mar 04 16:00:00 PST 2022 until: Wed Apr 05 16:59:59 PDT 2023\n-    private static final String REVOKED = \"-----BEGIN CERTIFICATE-----\\n\" +\n-            \"MIIHDjCCBfagAwIBAgIQDn7\/TN0U6+0dqnu34HMA7TANBgkqhkiG9w0BAQsFADBZ\\n\" +\n-            \"MQswCQYDVQQGEwJVUzEWMBQGA1UECgwNRGlnaUNlcnQsIEluYzEyMDAGA1UEAwwp\\n\" +\n-            \"RGlnaUNlcnQgUXVvVmFkaXMgVExTIElDQSBRViBSb290IENBIDEgRzMwHhcNMjIw\\n\" +\n-            \"MzA1MDAwMDAwWhcNMjMwNDA1MjM1OTU5WjCBhTELMAkGA1UEBhMCVVMxDTALBgNV\\n\" +\n-            \"BAgTBFV0YWgxDTALBgNVBAcTBExlaGkxFzAVBgNVBAoTDkRpZ2lDZXJ0LCBJbmMu\\n\" +\n-            \"MT8wPQYDVQQDEzZxdW92YWRpcy1yb290LWNhLTEtZzMtcmV2b2tlZC5jaGFpbi1k\\n\" +\n-            \"ZW1vcy5kaWdpY2VydC5jb20wggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIB\\n\" +\n-            \"AQDCQQ2S25TEDDGHa\/zvFUex4mD7pUAS7g80g8mQVII2v9Cg6F2tIEbay\/IDhV3D\\n\" +\n-            \"NtxJcaqiMpT9oMA5jhMSOqcoq8QFzdqugtIvxQ3obrIZysxjjluB2b1T5UhlnND1\\n\" +\n-            \"ShXlSWRhwkCN8qfO+VJ8wrpVH45mj+DsiSLWrY8Vw4q+gcJgoUV0Vj87m1H93JTf\\n\" +\n-            \"pF68NjljUOOTTXZSzsvTRpDsnOizbVeyZoRawRP8D4UbxA8P28Q5W7a\/uZSnUkfo\\n\" +\n-            \"1U1QFDd\/ii\/PCt6TVGYCNUehb8eSrEyjAtIZ\/ricIVkKxcqzQ3Tuq7HefH\/KiAqD\\n\" +\n-            \"GWr0NfO1JhX5ILmDZcosdsW1AgMBAAGjggOjMIIDnzAfBgNVHSMEGDAWgBSZEX3p\\n\" +\n-            \"sK0tYlpw0zyNhyCt2touQTAdBgNVHQ4EFgQUK6amWfyhRxRpr+fT1tpYV14n2wgw\\n\" +\n-            \"QQYDVR0RBDowOII2cXVvdmFkaXMtcm9vdC1jYS0xLWczLXJldm9rZWQuY2hhaW4t\\n\" +\n-            \"ZGVtb3MuZGlnaWNlcnQuY29tMA4GA1UdDwEB\/wQEAwIFoDAdBgNVHSUEFjAUBggr\\n\" +\n-            \"BgEFBQcDAQYIKwYBBQUHAwIwgZcGA1UdHwSBjzCBjDBEoEKgQIY+aHR0cDovL2Ny\\n\" +\n-            \"bDMuZGlnaWNlcnQuY29tL0RpZ2lDZXJ0UXVvVmFkaXNUTFNJQ0FRVlJvb3RDQTFH\\n\" +\n-            \"My5jcmwwRKBCoECGPmh0dHA6Ly9jcmw0LmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydFF1\\n\" +\n-            \"b1ZhZGlzVExTSUNBUVZSb290Q0ExRzMuY3JsMD4GA1UdIAQ3MDUwMwYGZ4EMAQIC\\n\" +\n-            \"MCkwJwYIKwYBBQUHAgEWG2h0dHA6Ly93d3cuZGlnaWNlcnQuY29tL0NQUzCBgwYI\\n\" +\n-            \"KwYBBQUHAQEEdzB1MCQGCCsGAQUFBzABhhhodHRwOi8vb2NzcC5kaWdpY2VydC5j\\n\" +\n-            \"b20wTQYIKwYBBQUHMAKGQWh0dHA6Ly9jYWNlcnRzLmRpZ2ljZXJ0LmNvbS9EaWdp\\n\" +\n-            \"Q2VydFF1b1ZhZGlzVExTSUNBUVZSb290Q0ExRzMuY3J0MAkGA1UdEwQCMAAwggF+\\n\" +\n-            \"BgorBgEEAdZ5AgQCBIIBbgSCAWoBaAB3AOg+0No+9QY1MudXKLyJa8kD08vREWvs\\n\" +\n-            \"62nhd31tBr1uAAABf1xeMeAAAAQDAEgwRgIhALuEk3mDbnEEkboc95mrKMgibE0K\\n\" +\n-            \"0QAWMu1gI\/teH06xAiEA7dbuLv66ScQkOq0zbfnUM8ih1Bw+Wb29jQRyTEXCaxEA\\n\" +\n-            \"dgA1zxkbv7FsV78PrUxtQsu7ticgJlHqP+Eq76gDwzvWTAAAAX9cXjIwAAAEAwBH\\n\" +\n-            \"MEUCIBvEfG23Yewp6oXQJExXQ+Am7z4i0X5NqSz8ohAXT3NiAiEAhDjy2H2Z5CV5\\n\" +\n-            \"gZ8TACTVgNyvEIH0cS4DjH6\/ILknLDEAdQCzc3cH4YRQ+GOG1gWp3BEJSnktsWcM\\n\" +\n-            \"C4fc8AMOeTalmgAAAX9cXjJBAAAEAwBGMEQCIGuxWoTPcFYQlVF9q\/F1JbaZj\/VT\\n\" +\n-            \"O6Oa8ionxCC\/8aqrAiAUCUoDcwphZ25ZFC+xGiP0kUiWgUwuQH7lBpTgoZp\/BjAN\\n\" +\n-            \"BgkqhkiG9w0BAQsFAAOCAQEAFrVjcQxq81PXEgHCf48+FOle8kUpJGxpH1n1Sp0p\\n\" +\n-            \"V95wrXj47oT1Vt9WqXPrNDfDkxwAvvXrCMXjHEg2YN0FCEanVec8GciuRRRtXrOE\\n\" +\n-            \"QOXAqGv5j+KG7bEvMNUFS90fesxfxVAQkr1zIT70nMAOKV1NOyQ\/q8bZ+jehcRZB\\n\" +\n-            \"wUKrCWAzvOw4DPytrDcQmflvQN+Bw92T3uDuoYT\/oBcobpVfKpfuW\/+ZxxXTIp4L\\n\" +\n-            \"sixlx82SZNTo6e3LOqsgZnR6TFyRJ63sK65M+W0d55bHvleUAHRCOiGhhgqE\/cby\\n\" +\n-            \"z50hDzJMLnjskMSpkxMoeSeutAS2e7oIvA\/\/7C37LrQccQ==\\n\" +\n-            \"-----END CERTIFICATE-----\";\n+    public void runTest() throws Exception {\n+        ValidatePathWithURL validatePathWithURL = new ValidatePathWithURL(CA_ALIAS);\n@@ -190,10 +74,2 @@\n-    public void runTest(ValidatePathWithParams pathValidator)\n-            throws Exception {\n-        \/\/ Validate valid\n-        pathValidator.validate(new String[]{VALID, INT},\n-                ValidatePathWithParams.Status.GOOD, null, System.out);\n-\n-        \/\/ Validate Revoked\n-        pathValidator.validate(new String[]{REVOKED, INT},\n-                ValidatePathWithParams.Status.REVOKED,\n-                \"Tue Mar 08 11:22:28 PST 2022\", System.out);\n+        validatePathWithURL.validateDomain(VALID, false);\n+        validatePathWithURL.validateDomain(REVOKED, true);\n@@ -204,0 +80,3 @@\n+    private static final String VALID = \"https:\/\/quovadis-root-ca-2-g3.chain-demos.digicert.com\";\n+    private static final String REVOKED = \"https:\/\/quovadis-root-ca-2-g3-revoked.chain-demos.digicert.com\";\n+    private static final String CA_ALIAS = \"quovadisrootca2g3 [jdk]\";\n@@ -205,140 +84,2 @@\n-    \/\/ Owner: CN=DigiCert QV EV TLS ICA G1, O=\"DigiCert, Inc.\", C=US\n-    \/\/ Issuer: CN=QuoVadis Root CA 2 G3, O=QuoVadis Limited, C=BM\n-    \/\/ Serial number: 65e9bcd53e791df22dffeb5ecc2bc7a5588d0883\n-    \/\/ Valid from: Mon Mar 16 12:39:42 PDT 2020 until: Thu Mar 14 12:39:42 PDT 2030\n-    private static final String INT = \"-----BEGIN CERTIFICATE-----\\n\" +\n-            \"MIIFbzCCA1egAwIBAgIUZem81T55HfIt\/+tezCvHpViNCIMwDQYJKoZIhvcNAQEL\\n\" +\n-            \"BQAwSDELMAkGA1UEBhMCQk0xGTAXBgNVBAoTEFF1b1ZhZGlzIExpbWl0ZWQxHjAc\\n\" +\n-            \"BgNVBAMTFVF1b1ZhZGlzIFJvb3QgQ0EgMiBHMzAeFw0yMDAzMTYxOTM5NDJaFw0z\\n\" +\n-            \"MDAzMTQxOTM5NDJaMEoxCzAJBgNVBAYTAlVTMRcwFQYDVQQKDA5EaWdpQ2VydCwg\\n\" +\n-            \"SW5jLjEiMCAGA1UEAwwZRGlnaUNlcnQgUVYgRVYgVExTIElDQSBHMTCCASIwDQYJ\\n\" +\n-            \"KoZIhvcNAQEBBQADggEPADCCAQoCggEBAMhwn6I+pGrJsnisnzP7EU5cFN9UT5XF\\n\" +\n-            \"auA13F3jHeUUZmBOcMSOJEhx\/e7oeVScTnmKpe7t7uey7lIIC9DWFmP8klbtLBgL\\n\" +\n-            \"0jY4MPlCkVyxUIhZ73EHCPqDCX9bo+rMB6C758\/tKZOPcoWRixQypPwoC4cXNOOk\\n\" +\n-            \"ntqFPRxFSZoBdTDNlAmkAQJCRsXGCEC5pZ0JqzGcAA0\/Pw1fB8lSPAti3trubYmd\\n\" +\n-            \"aaPFAKzGK7vsexxpuSUKO0opNkFWbLdHZ8jkr86R80oo1vhURJXWNeMS74ws5nbt\\n\" +\n-            \"Ll9sJTDW33MQPS0\/JO3xYI7bQcW3K1sPSERa4BahqgOJvEXMk1eWRcUCAwEAAaOC\\n\" +\n-            \"AU0wggFJMBIGA1UdEwEB\/wQIMAYBAf8CAQAwHwYDVR0jBBgwFoAU7edvdlq\/YOxJ\\n\" +\n-            \"W8ald7tyFnGbxD0wOgYIKwYBBQUHAQEELjAsMCoGCCsGAQUFBzABhh5odHRwOi8v\\n\" +\n-            \"b2NzcC5xdW92YWRpc2dsb2JhbC5jb20wSwYDVR0gBEQwQjAHBgVngQwBATA3Bglg\\n\" +\n-            \"hkgBhv1sAgEwKjAoBggrBgEFBQcCARYcaHR0cHM6Ly93d3cuZGlnaWNlcnQuY29t\\n\" +\n-            \"L0NQUzAdBgNVHSUEFjAUBggrBgEFBQcDAgYIKwYBBQUHAwEwOwYDVR0fBDQwMjAw\\n\" +\n-            \"oC6gLIYqaHR0cDovL2NybC5xdW92YWRpc2dsb2JhbC5jb20vcXZyY2EyZzMuY3Js\\n\" +\n-            \"MB0GA1UdDgQWBBQTL6fobnFR9uIMmEeDnn+deHk08zAOBgNVHQ8BAf8EBAMCAYYw\\n\" +\n-            \"DQYJKoZIhvcNAQELBQADggIBAEoOxze3kgnR39LX8M63EjiNxx0LThZHROqYqev6\\n\" +\n-            \"5ox\/c5NNitk8\/ODA8osdPpvnUBAlmE0+gqBvnTBRPVrJFd9bOr5BK8z6Os9\/U0ed\\n\" +\n-            \"c3UINkWLS05B7ChC9s6Zw1Vd\/WlW08TQJ80GpvAIbEKcg8EO\/DXPniHxC4cMtv1T\\n\" +\n-            \"jtNeh98XiVgQXHL1FY+u\/l413J8C4utKi4ZOQeCJDqvlSDzRsOi+tHsXrCJxnMWN\\n\" +\n-            \"2QBgMGgdPW37zwf0EffoH0Gee3pTgg7I5SzmvBq0t5xRDfv4N0OdM\/sN1mc5f3o7\\n\" +\n-            \"0YCd9WXhyDCV5W2O8QIbrd42CK5k1rlM6gXwOyDmYY5CVAl1QeXEeRfDk\/zNjU\/1\\n\" +\n-            \"+LnH\/Dv88VcZhODYq+VGbyM8bpNr0v95PY3yaH4kzpWGqWAN5i9LosfcaqRPmyL4\\n\" +\n-            \"PcKTQwcA9AVTjITExFua\/QtGrXLPvMVxR248G9IQpJMxP3JEGkjlKCenmc29r2u1\\n\" +\n-            \"KE4TeCs2xxjR1PusTfX91bBW3YAoAPDTRQKZjolegLUY44j3uKSzAdhMEbZQhovH\\n\" +\n-            \"Lraqx1WjTayTuq1Vuakcia5shmgFVSNcE+NVgLEIe32oTOm\/G6Kd1lcm9C4Ph1Cg\\n\" +\n-            \"nfDuqohZrk76kJTk8poAY5aFCQHhVzbpSw3zooMGjjvWnkG+\/DC6SZM8rKoOdKiB\\n\" +\n-            \"cy+N\\n\" +\n-            \"-----END CERTIFICATE-----\";\n-\n-    \/\/ Owner: CN=quovadis-root-ca-2-g3.chain-demos.digicert.com, O=\"DigiCert,\n-    \/\/        Inc.\", L=Lehi, ST=Utah, C=US, SERIALNUMBER=5299537-0142, OID.1.3.6.1.4\n-    \/\/        1.311.60.2.1.2=Utah, OID.1.3.6.1.4.1.311.60.2.1.3=US,\n-    \/\/        OID.2.5.4 .15=Private Organization\n-    \/\/ Issuer: CN=DigiCert QV EV TLS ICA G1, O=\"DigiCert, Inc.\", C=US\n-    \/\/ Serial number: 9c5e9d5f169d3a59e64db208d3e849d\n-    \/\/ Valid from: Wed Feb 02 16:00:00 PST 2022 until: Mon Mar 06 15:59:59 PST 2023\n-    private static final String VALID = \"-----BEGIN CERTIFICATE-----\\n\" +\n-            \"MIIHNDCCBhygAwIBAgIQCcXp1fFp06WeZNsgjT6EnTANBgkqhkiG9w0BAQsFADBK\\n\" +\n-            \"MQswCQYDVQQGEwJVUzEXMBUGA1UECgwORGlnaUNlcnQsIEluYy4xIjAgBgNVBAMM\\n\" +\n-            \"GURpZ2lDZXJ0IFFWIEVWIFRMUyBJQ0EgRzEwHhcNMjIwMjAzMDAwMDAwWhcNMjMw\\n\" +\n-            \"MzA2MjM1OTU5WjCB3zEdMBsGA1UEDwwUUHJpdmF0ZSBPcmdhbml6YXRpb24xEzAR\\n\" +\n-            \"BgsrBgEEAYI3PAIBAxMCVVMxFTATBgsrBgEEAYI3PAIBAhMEVXRhaDEVMBMGA1UE\\n\" +\n-            \"BRMMNTI5OTUzNy0wMTQyMQswCQYDVQQGEwJVUzENMAsGA1UECBMEVXRhaDENMAsG\\n\" +\n-            \"A1UEBxMETGVoaTEXMBUGA1UEChMORGlnaUNlcnQsIEluYy4xNzA1BgNVBAMTLnF1\\n\" +\n-            \"b3ZhZGlzLXJvb3QtY2EtMi1nMy5jaGFpbi1kZW1vcy5kaWdpY2VydC5jb20wggEi\\n\" +\n-            \"MA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQDfknHK7boXh9ysZ0FLDQKEyT2x\\n\" +\n-            \"Swtyecb5kkVgJU75XpXccV724mntCu5hpZ7Yt4tOmDZvbpYcqWbhIJgxGFNLyPdB\\n\" +\n-            \"Fn8jgZ4N0WoD7u295HI9izEmbM0XrO2rvHUc6ZhFFyx0jhvJPf\/k9QbQB4TwKZri\\n\" +\n-            \"Iuf1E1Ek70DkTWAg6OrPHMe2ER3aSz2S2rNkMSopURvZuabzPovsGaz+XEZNfE4N\\n\" +\n-            \"UfkBLa0DUjFCamOMZKIfkzxpH\/NhQcigGnZgxiyUb6KRhu9ydpWeOvOHwPWwR\/fV\\n\" +\n-            \"7WT+X1DUHojoXeCk2RtIRMihDWPd+lqiUppM8IlEW\/gxWbK1wP41qioiK9j5AgMB\\n\" +\n-            \"AAGjggN+MIIDejAfBgNVHSMEGDAWgBQTL6fobnFR9uIMmEeDnn+deHk08zAdBgNV\\n\" +\n-            \"HQ4EFgQUtAEN4g3bzwES6MoOINihiZQrt+owOQYDVR0RBDIwMIIucXVvdmFkaXMt\\n\" +\n-            \"cm9vdC1jYS0yLWczLmNoYWluLWRlbW9zLmRpZ2ljZXJ0LmNvbTAOBgNVHQ8BAf8E\\n\" +\n-            \"BAMCBaAwHQYDVR0lBBYwFAYIKwYBBQUHAwEGCCsGAQUFBwMCMHsGA1UdHwR0MHIw\\n\" +\n-            \"N6A1oDOGMWh0dHA6Ly9jcmwzLmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydFFWRVZUTFNJ\\n\" +\n-            \"Q0FHMS5jcmwwN6A1oDOGMWh0dHA6Ly9jcmw0LmRpZ2ljZXJ0LmNvbS9EaWdpQ2Vy\\n\" +\n-            \"dFFWRVZUTFNJQ0FHMS5jcmwwSgYDVR0gBEMwQTALBglghkgBhv1sAgEwMgYFZ4EM\\n\" +\n-            \"AQEwKTAnBggrBgEFBQcCARYbaHR0cDovL3d3dy5kaWdpY2VydC5jb20vQ1BTMHYG\\n\" +\n-            \"CCsGAQUFBwEBBGowaDAkBggrBgEFBQcwAYYYaHR0cDovL29jc3AuZGlnaWNlcnQu\\n\" +\n-            \"Y29tMEAGCCsGAQUFBzAChjRodHRwOi8vY2FjZXJ0cy5kaWdpY2VydC5jb20vRGln\\n\" +\n-            \"aUNlcnRRVkVWVExTSUNBRzEuY3J0MAwGA1UdEwEB\/wQCMAAwggF9BgorBgEEAdZ5\\n\" +\n-            \"AgQCBIIBbQSCAWkBZwB2AOg+0No+9QY1MudXKLyJa8kD08vREWvs62nhd31tBr1u\\n\" +\n-            \"AAABfsHcGW0AAAQDAEcwRQIgSMSWvB5\/8sf6CAZYojDI+t3bmcVHtIJT3T+Z3TcZ\\n\" +\n-            \"MFMCIQD5Qyb6jwHOAscsPeID156bUZIw+PeB652u+Q8gTU8C5gB1ADXPGRu\/sWxX\\n\" +\n-            \"vw+tTG1Cy7u2JyAmUeo\/4SrvqAPDO9ZMAAABfsHcGUcAAAQDAEYwRAIgL68Riq9a\\n\" +\n-            \"l17hobjQopbfzvcQi4KT1+DlqO2dAeCuF80CIAy19t3bAxcJRmbXWo9J2dGc7WuE\\n\" +\n-            \"r+bLfnQoerq9KB1bAHYAs3N3B+GEUPhjhtYFqdwRCUp5LbFnDAuH3PADDnk2pZoA\\n\" +\n-            \"AAF+wdwZZAAABAMARzBFAiEA4vYazXAaD1BfJ8MqEmrfxeTIDQ6LZkmqfh8xEnVz\\n\" +\n-            \"8VYCIF\/RgfyBhOeH40wfgwpFTa+Y+t7EWg0PtjC4IaIFTKYKMA0GCSqGSIb3DQEB\\n\" +\n-            \"CwUAA4IBAQC5KLlms\/+5XcCIEFBpQSwT7VoRcqnrVWlhya+9ClA98LYuDUeHcHt6\\n\" +\n-            \"lHvfjEEmy2s2GoKHK\/JxXzftBau5LbDWlvQ6EF+22fnaVDsKIwNgYwbhJb+6zr8t\\n\" +\n-            \"LOFS6Y51YSlRrDUvy94S3PE7N8D3wyKq18IhXOI1WUeR0bKHLlXtl+ZjKMIMkd\/l\\n\" +\n-            \"YtLnnskRCQa0P\/HLwQYLUpgiNGVZJQbjrWsVzcw12mR\/gza1KjR02STJRGZad7L0\\n\" +\n-            \"Oz48CRhm94iaEjFcVKT3vcDUrtCKpkmhBACcdA3NNqDq10i\/SLspOeDLSESkkJKF\\n\" +\n-            \"w8w3YCqXjZn5JyV3sVHYNezNKtLdCxn4\\n\" +\n-            \"-----END CERTIFICATE-----\";\n-\n-    \/\/ Owner: CN=quovadis-root-ca-2-g3-revoked.chain-demos.digicert.com,\n-    \/\/           O=\"DigiCert, Inc.\", L=Lehi, ST=Utah, C=US, SERIALNUMBER=5299537-0142,\n-    \/\/           OID.2.5.4.15=Private Organization, OID.1.3.6.1.4.1.311.60.2.1.2=Utah,\n-    \/\/           OID.1.3.6.1.4.1.311.60.2.1.3=US\n-    \/\/ Issuer: CN=DigiCert QV EV TLS ICA G1, O=\"DigiCert, Inc.\", C=US\n-    \/\/ Serial number: 3f84605850df3ac98fcc15adec269f8\n-    \/\/ Valid from: Sun Apr 17 17:00:00 PDT 2022 until: Fri May 19 16:59:59 PDT 2023\n-    private static final String REVOKED = \"-----BEGIN CERTIFICATE-----\\n\" +\n-            \"MIIHQDCCBiigAwIBAgIQA\/hGBYUN86yY\/MFa3sJp+DANBgkqhkiG9w0BAQsFADBK\\n\" +\n-            \"MQswCQYDVQQGEwJVUzEXMBUGA1UECgwORGlnaUNlcnQsIEluYy4xIjAgBgNVBAMM\\n\" +\n-            \"GURpZ2lDZXJ0IFFWIEVWIFRMUyBJQ0EgRzEwHhcNMjIwNDE4MDAwMDAwWhcNMjMw\\n\" +\n-            \"NTE5MjM1OTU5WjCB5zETMBEGCysGAQQBgjc8AgEDEwJVUzEVMBMGCysGAQQBgjc8\\n\" +\n-            \"AgECEwRVdGFoMR0wGwYDVQQPDBRQcml2YXRlIE9yZ2FuaXphdGlvbjEVMBMGA1UE\\n\" +\n-            \"BRMMNTI5OTUzNy0wMTQyMQswCQYDVQQGEwJVUzENMAsGA1UECBMEVXRhaDENMAsG\\n\" +\n-            \"A1UEBxMETGVoaTEXMBUGA1UEChMORGlnaUNlcnQsIEluYy4xPzA9BgNVBAMTNnF1\\n\" +\n-            \"b3ZhZGlzLXJvb3QtY2EtMi1nMy1yZXZva2VkLmNoYWluLWRlbW9zLmRpZ2ljZXJ0\\n\" +\n-            \"LmNvbTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBANfUkoe8l\/AFhMH5\\n\" +\n-            \"NtRR2Ztx4xVINz1celdjQE7xgjyHoQY6EMhuI+tvTpwJr9wJEFl7YBiIUFUgJZo6\\n\" +\n-            \"lCLZtXI5t6rN0PhI+F03vGj5ukOkBBcsNVuKPJjud78sHL7u4w7RL3agrQIG7sff\\n\" +\n-            \"bQK4qieUDPxiE8TO8mIzUKnIvYeNA8aJe4zxWf6Mn64WvnudsxYFgMDL4L0ryYKy\\n\" +\n-            \"Ls53Co0OweOl4qnNSne8eIGfb6UaUBQvWbnVfRSHzf+skrF1qstWlFhUsqR07HtF\\n\" +\n-            \"6BqVrAsRA8tmXisyXrMp9jTcIsG7LXVLOqxN07mAvpateExZs3WWRhfQl4Z+HpHD\\n\" +\n-            \"80WbTI0CAwEAAaOCA4IwggN+MB8GA1UdIwQYMBaAFBMvp+hucVH24gyYR4Oef514\\n\" +\n-            \"eTTzMB0GA1UdDgQWBBSTXYbD9dwCDxIH\/aN5vIr02uLz5DBBBgNVHREEOjA4gjZx\\n\" +\n-            \"dW92YWRpcy1yb290LWNhLTItZzMtcmV2b2tlZC5jaGFpbi1kZW1vcy5kaWdpY2Vy\\n\" +\n-            \"dC5jb20wDgYDVR0PAQH\/BAQDAgWgMB0GA1UdJQQWMBQGCCsGAQUFBwMBBggrBgEF\\n\" +\n-            \"BQcDAjB7BgNVHR8EdDByMDegNaAzhjFodHRwOi8vY3JsMy5kaWdpY2VydC5jb20v\\n\" +\n-            \"RGlnaUNlcnRRVkVWVExTSUNBRzEuY3JsMDegNaAzhjFodHRwOi8vY3JsNC5kaWdp\\n\" +\n-            \"Y2VydC5jb20vRGlnaUNlcnRRVkVWVExTSUNBRzEuY3JsMEoGA1UdIARDMEEwCwYJ\\n\" +\n-            \"YIZIAYb9bAIBMDIGBWeBDAEBMCkwJwYIKwYBBQUHAgEWG2h0dHA6Ly93d3cuZGln\\n\" +\n-            \"aWNlcnQuY29tL0NQUzB2BggrBgEFBQcBAQRqMGgwJAYIKwYBBQUHMAGGGGh0dHA6\\n\" +\n-            \"Ly9vY3NwLmRpZ2ljZXJ0LmNvbTBABggrBgEFBQcwAoY0aHR0cDovL2NhY2VydHMu\\n\" +\n-            \"ZGlnaWNlcnQuY29tL0RpZ2lDZXJ0UVZFVlRMU0lDQUcxLmNydDAJBgNVHRMEAjAA\\n\" +\n-            \"MIIBfAYKKwYBBAHWeQIEAgSCAWwEggFoAWYAdQDoPtDaPvUGNTLnVyi8iWvJA9PL\\n\" +\n-            \"0RFr7Otp4Xd9bQa9bgAAAYA+bejFAAAEAwBGMEQCIFDhmaB4BXmOw2SKONPFBU8t\\n\" +\n-            \"qXb7DXeG6JHGcONDqITjAiAqozEj7\/1ULu6t\/uzfwOSgC7xEmUsLGzQVnaOF9m3s\\n\" +\n-            \"swB1ADXPGRu\/sWxXvw+tTG1Cy7u2JyAmUeo\/4SrvqAPDO9ZMAAABgD5t6QkAAAQD\\n\" +\n-            \"AEYwRAIgfVEs7Ph+wOpoCGl4woa3aUWH1COGx1SwvHZ8lH21xfsCIBI1IpR6goya\\n\" +\n-            \"iz47tT\/Uz+26RnkHiAApYsdMOPyevkzhAHYAs3N3B+GEUPhjhtYFqdwRCUp5LbFn\\n\" +\n-            \"DAuH3PADDnk2pZoAAAGAPm3pPgAABAMARzBFAiAKBon1PVoqJAF49jMQd2c222TK\\n\" +\n-            \"sWkL5sLFqLVZj2vOugIhAODd\/OUy236+9alC2U5nxl1oej9fOF4por2OZMFQfpFF\\n\" +\n-            \"MA0GCSqGSIb3DQEBCwUAA4IBAQAyrJzyOiRAETfoYddTmRmbnFNuHx4YAkkdxn2d\\n\" +\n-            \"BXdy4jPn0kTtDo4592KnbTdieSCWghmEmcEY1sQXdX6iqKwzmp408jfUDohl5evV\\n\" +\n-            \"oZrum3P3zgLRz1qswFM5a2HteWzCWWi\/n6d6nKXj6PGGVAMQfk1s6PaWhYBuiaag\\n\" +\n-            \"myYss\/LTPzaLGUfFzlt\/HfomiD+BNuBOVa+pPrmTWhex+e02z95n6RPYCiazuZNZ\\n\" +\n-            \"xiarN83pRNu\/fIjVXw2jENg7+kaC1wwLqET0x6\/EJa6YI3Xa7Aumb8Pp2r2UZ5Tr\\n\" +\n-            \"7BUhmiRLkvw\/9SI8ceXNSwuTTGK2fKHm2\/CWqI0cS3zWk3dC\\n\" +\n-            \"-----END CERTIFICATE-----\";\n-\n-    public void runTest(ValidatePathWithParams pathValidator)\n-            throws Exception {\n-        \/\/ Validate valid\n-        pathValidator.validate(new String[]{VALID, INT},\n-                ValidatePathWithParams.Status.GOOD, null, System.out);\n+    public void runTest() throws Exception {\n+        ValidatePathWithURL validatePathWithURL = new ValidatePathWithURL(CA_ALIAS);\n@@ -346,4 +87,2 @@\n-        \/\/ Validate Revoked\n-        pathValidator.validate(new String[]{REVOKED, INT},\n-                ValidatePathWithParams.Status.REVOKED,\n-                \"Mon Apr 18 14:07:46 PDT 2022\", System.out);\n+        validatePathWithURL.validateDomain(VALID, false);\n+        validatePathWithURL.validateDomain(REVOKED, true);\n@@ -354,0 +93,3 @@\n+    private static final String VALID = \"https:\/\/quovadis-root-ca-3-g3.chain-demos.digicert.com\";\n+    private static final String REVOKED = \"https:\/\/quovadis-root-ca-3-g3-revoked.chain-demos.digicert.com\";\n+    private static final String CA_ALIAS = \"quovadisrootca3g3 [jdk]\";\n@@ -355,134 +97,2 @@\n-    \/\/ Owner: CN=DigiCert QuoVadis TLS ICA QV Root CA 3 G3, O=\"DigiCert, Inc\", C=US\n-    \/\/ Issuer: CN=QuoVadis Root CA 3 G3, O=QuoVadis Limited, C=BM\n-    \/\/ Serial number: 427dd33a8ff51d8152e813c7dec93ba76312a7d8\n-    \/\/ Valid from: Wed Jan 06 12:55:40 PST 2021 until: Sat Jan 04 12:55:40 PST 2031\n-    private static final String INT = \"-----BEGIN CERTIFICATE-----\\n\" +\n-            \"MIIFgDCCA2igAwIBAgIUQn3TOo\/1HYFS6BPH3sk7p2MSp9gwDQYJKoZIhvcNAQEL\\n\" +\n-            \"BQAwSDELMAkGA1UEBhMCQk0xGTAXBgNVBAoTEFF1b1ZhZGlzIExpbWl0ZWQxHjAc\\n\" +\n-            \"BgNVBAMTFVF1b1ZhZGlzIFJvb3QgQ0EgMyBHMzAeFw0yMTAxMDYyMDU1NDBaFw0z\\n\" +\n-            \"MTAxMDQyMDU1NDBaMFkxCzAJBgNVBAYTAlVTMRYwFAYDVQQKDA1EaWdpQ2VydCwg\\n\" +\n-            \"SW5jMTIwMAYDVQQDDClEaWdpQ2VydCBRdW9WYWRpcyBUTFMgSUNBIFFWIFJvb3Qg\\n\" +\n-            \"Q0EgMyBHMzCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBALxNTdqnFD+A\\n\" +\n-            \"MhketYfVfVUWQKPkVEuyYj7Y2uwXBMRP4RStO4CoQih+hX\/h94vRlObOIsqcNnyC\\n\" +\n-            \"ElwBnLbmusaWYLYnDEWoROL8uN0pkWk0asfhhEsXTkAJ6FLHUD85WBkED4gIVWPi\\n\" +\n-            \"Sp4AOwiA+\/zpbwgVAgdjJTO3jjMsp4F1lBrdViYSwoPRACH1ZMjJG572oXTpZkQX\\n\" +\n-            \"uWmEKLUOnik1i5cbqGLnwXiDvTAhxit7aBlj\/C5IDvONWVQL34ZTYppvo8S3Hhy9\\n\" +\n-            \"xX0S4HCpTpeBe3mas7VOrjsXNlEoFvejrxcQ+fB\/gUf6fLUPxUhcPtm8keBPQuxc\\n\" +\n-            \"qP12\/+KG0WECAwEAAaOCAU8wggFLMBIGA1UdEwEB\/wQIMAYBAf8CAQAwHwYDVR0j\\n\" +\n-            \"BBgwFoAUxhfQvKjqAkPyGwaZXSuQILnXnOQwdAYIKwYBBQUHAQEEaDBmMDgGCCsG\\n\" +\n-            \"AQUFBzAChixodHRwOi8vdHJ1c3QucXVvdmFkaXNnbG9iYWwuY29tL3F2cmNhM2cz\\n\" +\n-            \"LmNydDAqBggrBgEFBQcwAYYeaHR0cDovL29jc3AucXVvdmFkaXNnbG9iYWwuY29t\\n\" +\n-            \"MBMGA1UdIAQMMAowCAYGZ4EMAQICMB0GA1UdJQQWMBQGCCsGAQUFBwMCBggrBgEF\\n\" +\n-            \"BQcDATA7BgNVHR8ENDAyMDCgLqAshipodHRwOi8vY3JsLnF1b3ZhZGlzZ2xvYmFs\\n\" +\n-            \"LmNvbS9xdnJjYTNnMy5jcmwwHQYDVR0OBBYEFDNm+y+RBcyzYlLvzTz1fhzOpxeW\\n\" +\n-            \"MA4GA1UdDwEB\/wQEAwIBhjANBgkqhkiG9w0BAQsFAAOCAgEAY0ZuDgyM4I4MO9ll\\n\" +\n-            \"D8qFUPQ8xtcGOuJgSRhDS2onIJ0M8yOGOYJCobIEGIgqyx94kI\/n\/1Xw+Wvsnhwb\\n\" +\n-            \"OYOtVedx6VGDu6IuSKTVgPPhzwKP5ZA7wtmgKR8+W4E3DM1VerA9Po9ycDK9qCdl\\n\" +\n-            \"K4tuF37grKEzlQKovG+kn0z+Zi0D\/E1kN1Q8YmX35HHRenJWKEnAL9QROh0X9jFi\\n\" +\n-            \"SlsHPrxWC3adOdAW+B+kVG0cM2nurd0Ic2YkiLKOOaSd5hbCQY\/fCZwohtest+ZU\\n\" +\n-            \"Ajyd+FVzSNvEFrwPzZwKfcdemvD4kew8lx5sG6BUL4GkFWnotxSr+F9Huwgj4pC+\\n\" +\n-            \"cxE2841a\/9r\/gliuwDM\/8jkt16epFAdw0fXemyM8FdHJDnB++3d8SyjOOQ8j+VHW\\n\" +\n-            \"31NWx27sORa5CgRchlldXWDzIIEwbc82a1OAfGUmNAsdEHjMl1HMcZHbjCmdSdsw\\n\" +\n-            \"fmyldZrj2YmvOI5ZlE9z4vzi35KyqlxWCtu9O\/SJq\/rBvYS0TPmm8HbhJQbeMe6p\\n\" +\n-            \"vJGrxcb1muSBANn9T9wvukjiNNw32ciSDCjZ0h4N+CGxbzoZtgIAQ29IunYdnJix\\n\" +\n-            \"ZiP+ED6xvwgVRBkDSgWD2W\/hex\/+z4fNmGQJDcri51\/tZCqHHv2Y7XReuf4Fk+nP\\n\" +\n-            \"l8Sd\/Kpqwde\/sJkoqwDcBSJygh0=\\n\" +\n-            \"-----END CERTIFICATE-----\";\n-\n-    \/\/ Owner: CN=quovadis-root-ca-3-g3.chain-demos.digicert.com, O=\"DigiCert, Inc.\",\n-    \/\/        L=Lehi, ST=Utah, C=US\n-    \/\/ Issuer: CN=DigiCert QuoVadis TLS ICA QV Root CA 3 G3, O=\"DigiCert, Inc\", C=US\n-    \/\/ Serial number: f27ee3fad1d754ae78d7866da0a4f6f\n-    \/\/ Valid from: Fri Mar 04 16:00:00 PST 2022 until: Wed Apr 05 16:59:59 PDT 2023\n-    private static final String VALID = \"-----BEGIN CERTIFICATE-----\\n\" +\n-            \"MIIG\/jCCBeagAwIBAgIQDyfuP60ddUrnjXhm2gpPbzANBgkqhkiG9w0BAQsFADBZ\\n\" +\n-            \"MQswCQYDVQQGEwJVUzEWMBQGA1UECgwNRGlnaUNlcnQsIEluYzEyMDAGA1UEAwwp\\n\" +\n-            \"RGlnaUNlcnQgUXVvVmFkaXMgVExTIElDQSBRViBSb290IENBIDMgRzMwHhcNMjIw\\n\" +\n-            \"MzA1MDAwMDAwWhcNMjMwNDA1MjM1OTU5WjB9MQswCQYDVQQGEwJVUzENMAsGA1UE\\n\" +\n-            \"CBMEVXRhaDENMAsGA1UEBxMETGVoaTEXMBUGA1UEChMORGlnaUNlcnQsIEluYy4x\\n\" +\n-            \"NzA1BgNVBAMTLnF1b3ZhZGlzLXJvb3QtY2EtMy1nMy5jaGFpbi1kZW1vcy5kaWdp\\n\" +\n-            \"Y2VydC5jb20wggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQDOZpBBS8yo\\n\" +\n-            \"ioVgFUQDCVcnkHTL4\/PfaPKGK1owE0+mKz1AXmYX1rzFfp6gFqjbZeclhWCKoINE\\n\" +\n-            \"OrZ2+1mGp75+nCP89NgoGzPgjYLVsM97gN2Y36\/jXu8TwsZdYfBw9gxL+YApvq2r\\n\" +\n-            \"NbPfxXaYfWdq8bz0RzqXRgS8BqKi1q8tKyahx5EJ3fCpozY9NPvCnipwbWXL9evF\\n\" +\n-            \"Oak3c5Ip2YME4mHh8PujrznCVBte7KGLDn2KwbOUbh5SKKBL32vzTPOERWEDMbAu\\n\" +\n-            \"3XqQh\/cc4LTp32Lf\/XkfnUOSbzNh+Te8ZjeDzI+SYNg9bleKpPxLSkBZyurs4mCD\\n\" +\n-            \"92L8BXPlMaGjAgMBAAGjggOcMIIDmDAfBgNVHSMEGDAWgBQzZvsvkQXMs2JS7808\\n\" +\n-            \"9X4czqcXljAdBgNVHQ4EFgQUnf71SuL2Z73DAgGKgO7UVFDBIkgwOQYDVR0RBDIw\\n\" +\n-            \"MIIucXVvdmFkaXMtcm9vdC1jYS0zLWczLmNoYWluLWRlbW9zLmRpZ2ljZXJ0LmNv\\n\" +\n-            \"bTAOBgNVHQ8BAf8EBAMCBaAwHQYDVR0lBBYwFAYIKwYBBQUHAwEGCCsGAQUFBwMC\\n\" +\n-            \"MIGXBgNVHR8EgY8wgYwwRKBCoECGPmh0dHA6Ly9jcmwzLmRpZ2ljZXJ0LmNvbS9E\\n\" +\n-            \"aWdpQ2VydFF1b1ZhZGlzVExTSUNBUVZSb290Q0EzRzMuY3JsMESgQqBAhj5odHRw\\n\" +\n-            \"Oi8vY3JsNC5kaWdpY2VydC5jb20vRGlnaUNlcnRRdW9WYWRpc1RMU0lDQVFWUm9v\\n\" +\n-            \"dENBM0czLmNybDA+BgNVHSAENzA1MDMGBmeBDAECAjApMCcGCCsGAQUFBwIBFhto\\n\" +\n-            \"dHRwOi8vd3d3LmRpZ2ljZXJ0LmNvbS9DUFMwgYMGCCsGAQUFBwEBBHcwdTAkBggr\\n\" +\n-            \"BgEFBQcwAYYYaHR0cDovL29jc3AuZGlnaWNlcnQuY29tME0GCCsGAQUFBzAChkFo\\n\" +\n-            \"dHRwOi8vY2FjZXJ0cy5kaWdpY2VydC5jb20vRGlnaUNlcnRRdW9WYWRpc1RMU0lD\\n\" +\n-            \"QVFWUm9vdENBM0czLmNydDAJBgNVHRMEAjAAMIIBfwYKKwYBBAHWeQIEAgSCAW8E\\n\" +\n-            \"ggFrAWkAdwDoPtDaPvUGNTLnVyi8iWvJA9PL0RFr7Otp4Xd9bQa9bgAAAX9cGyUR\\n\" +\n-            \"AAAEAwBIMEYCIQDjpwE\/uiXodkY8Cx3ecooM7gxZp+Qi3aQSIi3SWam6YwIhAPqz\\n\" +\n-            \"8AdaOw+FTZApiEiO2PXww8Y98YtivwXay8v\/ZFxrAHYANc8ZG7+xbFe\/D61MbULL\\n\" +\n-            \"u7YnICZR6j\/hKu+oA8M71kwAAAF\/XBsk5gAABAMARzBFAiEA4v9FfzFKPr8hPM1O\\n\" +\n-            \"jPSlboD96ufdyFBy9KmD8pFcI6ECIBY6pcURmWtsE\/G2jQgC+qvueJqSycNP2qTM\\n\" +\n-            \"iJ3pO\/U1AHYAs3N3B+GEUPhjhtYFqdwRCUp5LbFnDAuH3PADDnk2pZoAAAF\/XBsl\\n\" +\n-            \"BwAABAMARzBFAiEAsHzOaXv9OIo4RvaKUEscoLpnM98C+4hc6v4Z26d41aICIC2o\\n\" +\n-            \"aTrc5JsqgDhJXp7UArQPziUqDso967W2mrLa0nLdMA0GCSqGSIb3DQEBCwUAA4IB\\n\" +\n-            \"AQC2CaUwlIb+uKsELGw5U2KV0q8uMp\/nBIyFaW\/HNOJUf8j1keaf31WWBAFfUQVY\\n\" +\n-            \"pzFRUnRmNTtGxCvzyY1YhoQSwswGghz8ZCSQPWCST\/Tl8kKuVFas8wSUXaEV23t4\\n\" +\n-            \"G0pfIlXL2oIuJwREjzv54SK7xsQ4whco0nw8DvLt+\/5us4t96u8r1EuBKkF45ngz\\n\" +\n-            \"t77MTqpa0nvWUT7q9POT7xwQNui7P0j5t7prVX\/fBKm5EfK1Jdi1Toj9+VxTIWYk\\n\" +\n-            \"splUCXw7zxaA3nlrncAmnHxZEY8sQjpGY1OGY0udd+m5bldJNbRTA1Q+VoPVMiU6\\n\" +\n-            \"osdBQGUbbWrqm1fnoFW1VvUt\\n\" +\n-            \"-----END CERTIFICATE-----\";\n-\n-    \/\/ Owner: CN=quovadis-root-ca-3-g3-revoked.chain-demos.digicert.com,\n-    \/\/        O=\"DigiCert, Inc.\", L=Lehi, ST=Utah, C=US\n-    \/\/ Issuer: CN=DigiCert QuoVadis TLS ICA QV Root CA 3 G3, O=\"DigiCert, Inc\", C=US\n-    \/\/ Serial number: aafa7cafda91796626f5fc8bcb38702\n-    \/\/ Valid from: Fri Mar 04 16:00:00 PST 2022 until: Wed Apr 05 16:59:59 PDT 2023\n-    private static final String REVOKED = \"-----BEGIN CERTIFICATE-----\\n\" +\n-            \"MIIHDTCCBfWgAwIBAgIQCq+nyv2pF5Zib1\/IvLOHAjANBgkqhkiG9w0BAQsFADBZ\\n\" +\n-            \"MQswCQYDVQQGEwJVUzEWMBQGA1UECgwNRGlnaUNlcnQsIEluYzEyMDAGA1UEAwwp\\n\" +\n-            \"RGlnaUNlcnQgUXVvVmFkaXMgVExTIElDQSBRViBSb290IENBIDMgRzMwHhcNMjIw\\n\" +\n-            \"MzA1MDAwMDAwWhcNMjMwNDA1MjM1OTU5WjCBhTELMAkGA1UEBhMCVVMxDTALBgNV\\n\" +\n-            \"BAgTBFV0YWgxDTALBgNVBAcTBExlaGkxFzAVBgNVBAoTDkRpZ2lDZXJ0LCBJbmMu\\n\" +\n-            \"MT8wPQYDVQQDEzZxdW92YWRpcy1yb290LWNhLTMtZzMtcmV2b2tlZC5jaGFpbi1k\\n\" +\n-            \"ZW1vcy5kaWdpY2VydC5jb20wggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIB\\n\" +\n-            \"AQDofDJ1xHHWMhbWwU7e4cY3u2NjvE4ur\/A0Y13UK53zoH8qDunV6ORAXQ+zSpev\\n\" +\n-            \"kPlnIbdjYOK1v5RJn2ZRgCafj8Bc\/9GnfQ1uE7P9dRkC9ZQwvb6Eh6f4RT7gaOPX\\n\" +\n-            \"UXSXwtr96xdXDvtlJqWx13YQPnSGXUNNT1NH8bs2Myr9j+I5bUcUGsKsGheZoib3\\n\" +\n-            \"6IFINss+ouOhZ+HP6ganS5cQVsUGk5u6BT6oH9VgwfVMjpDqmRkwc6UJmiij\/Nz4\\n\" +\n-            \"NOLOx2tivUjhk0eTPUaErUqYipGBSuwww6Linc\/0IAIxGJ2k0J3Qz9PthJzG0P47\\n\" +\n-            \"J5U5ej6FimnRS6Rrk5Ywk2HNAgMBAAGjggOiMIIDnjAfBgNVHSMEGDAWgBQzZvsv\\n\" +\n-            \"kQXMs2JS78089X4czqcXljAdBgNVHQ4EFgQU9qXify+xtHlQIniZABL1pv7gcb4w\\n\" +\n-            \"QQYDVR0RBDowOII2cXVvdmFkaXMtcm9vdC1jYS0zLWczLXJldm9rZWQuY2hhaW4t\\n\" +\n-            \"ZGVtb3MuZGlnaWNlcnQuY29tMA4GA1UdDwEB\/wQEAwIFoDAdBgNVHSUEFjAUBggr\\n\" +\n-            \"BgEFBQcDAQYIKwYBBQUHAwIwgZcGA1UdHwSBjzCBjDBEoEKgQIY+aHR0cDovL2Ny\\n\" +\n-            \"bDMuZGlnaWNlcnQuY29tL0RpZ2lDZXJ0UXVvVmFkaXNUTFNJQ0FRVlJvb3RDQTNH\\n\" +\n-            \"My5jcmwwRKBCoECGPmh0dHA6Ly9jcmw0LmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydFF1\\n\" +\n-            \"b1ZhZGlzVExTSUNBUVZSb290Q0EzRzMuY3JsMD4GA1UdIAQ3MDUwMwYGZ4EMAQIC\\n\" +\n-            \"MCkwJwYIKwYBBQUHAgEWG2h0dHA6Ly93d3cuZGlnaWNlcnQuY29tL0NQUzCBgwYI\\n\" +\n-            \"KwYBBQUHAQEEdzB1MCQGCCsGAQUFBzABhhhodHRwOi8vb2NzcC5kaWdpY2VydC5j\\n\" +\n-            \"b20wTQYIKwYBBQUHMAKGQWh0dHA6Ly9jYWNlcnRzLmRpZ2ljZXJ0LmNvbS9EaWdp\\n\" +\n-            \"Q2VydFF1b1ZhZGlzVExTSUNBUVZSb290Q0EzRzMuY3J0MAkGA1UdEwQCMAAwggF9\\n\" +\n-            \"BgorBgEEAdZ5AgQCBIIBbQSCAWkBZwB1AOg+0No+9QY1MudXKLyJa8kD08vREWvs\\n\" +\n-            \"62nhd31tBr1uAAABf1wc0LIAAAQDAEYwRAIgdmF6UFe2jgbM3FjYRMmcNaXfpleT\\n\" +\n-            \"E8hmYfmAVy5lSoUCIDPCV27IP9wpdGoxnnCMBwuekg6E4SB0lj49+o9OHHjDAHUA\\n\" +\n-            \"Nc8ZG7+xbFe\/D61MbULLu7YnICZR6j\/hKu+oA8M71kwAAAF\/XBzQ0QAABAMARjBE\\n\" +\n-            \"AiBO6vYHFci7OWvqDHRlgTn+Q6zNG\/LysZEOlrO4W8ZZ2gIgDY5+qjlar3esPN0b\\n\" +\n-            \"JUR5vfITl7UiZoqINJSm1gZ4Nm4AdwCzc3cH4YRQ+GOG1gWp3BEJSnktsWcMC4fc\\n\" +\n-            \"8AMOeTalmgAAAX9cHNDdAAAEAwBIMEYCIQCB52OPhdnYybsWzmkdSGSbgQVmS0V7\\n\" +\n-            \"ZumbThJSJwpuiwIhAP+JRx+Eu3MYRp5iyLb+xlWqghMnDnF9aCfm1VuW4aDuMA0G\\n\" +\n-            \"CSqGSIb3DQEBCwUAA4IBAQBO\/4LljBpMGYYxBang12UIQ+FIjxAfKqqIklSa+du2\\n\" +\n-            \"ea0VHqaRrdfh\/aTxzb0WaU++bgQN+MeHmQdvwYSgAyU\/lY7mIvDTNxFOO6IG2vfR\\n\" +\n-            \"+JAUnS9iVUQ1rXHU72cxUsne5aRyLQ0W\/2Zayx85O6\/C9gIUJgJVRuk0dTPZ6tnq\\n\" +\n-            \"FoW1S4GwqEpzTuJU8rP5IvMYoYo8jItpjzS0W90gtDvev\/XBRs1ig28Ky7ZS5AtQ\\n\" +\n-            \"S2Q6Ikg9YzegE9YNj2wqdZnEneoce0G1InysM\/geY1BZ57G9RAUZkzWVTJRLJgbg\\n\" +\n-            \"2nWSqpQJ765gg9JdsRo+zqj1kUBbUYoTSlaAJG6ucrlB\\n\" +\n-            \"-----END CERTIFICATE-----\";\n-\n-    public void runTest(ValidatePathWithParams pathValidator)\n-            throws Exception {\n-        \/\/ Validate valid\n-        pathValidator.validate(new String[]{VALID, INT},\n-                ValidatePathWithParams.Status.GOOD, null, System.out);\n+    public void runTest() throws Exception {\n+        ValidatePathWithURL validatePathWithURL = new ValidatePathWithURL(CA_ALIAS);\n@@ -490,4 +100,2 @@\n-        \/\/ Validate Revoked\n-        pathValidator.validate(new String[]{REVOKED, INT},\n-                ValidatePathWithParams.Status.REVOKED,\n-                \"Tue Mar 08 11:23:06 PST 2022\", System.out);\n+        validatePathWithURL.validateDomain(VALID, false);\n+        validatePathWithURL.validateDomain(REVOKED, true);\n","filename":"test\/jdk\/security\/infra\/java\/security\/cert\/CertPathValidator\/certification\/QuoVadisCA.java","additions":42,"deletions":434,"binary":false,"changes":476,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2020, 2021, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2020, 2023, Oracle and\/or its affiliates. All rights reserved.\n@@ -25,1 +25,1 @@\n- * @test\n+ * @test id=OCSP\n@@ -28,1 +28,3 @@\n- * @build ValidatePathWithParams\n+ * @library \/test\/lib\n+ * @build jtreg.SkippedException\n+ * @build ValidatePathWithURL\n@@ -30,1 +32,0 @@\n- * @run main\/othervm -Djava.security.debug=certpath SSLCA CRL\n@@ -34,11 +35,7 @@\n- * Obtain TLS test artifacts for SSL.com CAs from:\n- *\n- * SSL.com RSA CA\n- *     Valid - https:\/\/test-dv-rsa.ssl.com\n- *     Revoked - https:\/\/revoked-rsa-dv.ssl.com\/\n- * SSL.com EV RSA CA\n- *     Valid - https:\/\/test-ev-rsa.ssl.com\n- *     Revoked - https:\/\/revoked-rsa-ev.ssl.com\/\n- * SSL.com ECC CA\n- *     Valid - https:\/\/test-dv-ecc.ssl.com\n- *     Revoked - https:\/\/revoked-ecc-dv.ssl.com\/\n+ * @test id=CRL\n+ * @bug 8243320 8256895\n+ * @summary Interoperability tests with SSL.com's RSA, EV RSA, and ECC CA\n+ * @library \/test\/lib\n+ * @build jtreg.SkippedException\n+ * @build ValidatePathWithURL\n+ * @run main\/othervm -Djava.security.debug=certpath SSLCA CRL\n@@ -46,0 +43,1 @@\n+\n@@ -50,4 +48,0 @@\n-        System.setProperty(\"jdk.security.certpath.ocspNonce\", \"true\");\n-        ValidatePathWithParams pathValidator = new ValidatePathWithParams(null);\n-        boolean ocspEnabled = false;\n-\n@@ -55,1 +49,1 @@\n-            pathValidator.enableCRLCheck();\n+            ValidatePathWithURL.enableCRLOnly();\n@@ -58,2 +52,1 @@\n-            pathValidator.enableOCSPCheck();\n-            ocspEnabled = true;\n+            ValidatePathWithURL.enableOCSPOnly();\n@@ -62,3 +55,3 @@\n-        new SSLCA_RSA().runTest(pathValidator, ocspEnabled);\n-        new SSLCA_EV_RSA().runTest(pathValidator, ocspEnabled);\n-        new SSLCA_ECC().runTest(pathValidator, ocspEnabled);\n+        new SSLCA_RSA().runTest();\n+        new SSLCA_EV_RSA().runTest();\n+        new SSLCA_ECC().runTest();\n@@ -69,0 +62,3 @@\n+    private static final String VALID = \"https:\/\/test-dv-rsa.ssl.com\";\n+    private static final String REVOKED = \"https:\/\/revoked-rsa-dv.ssl.com\";\n+    private static final String CA_ALIAS = \"sslrootrsaca [jdk]\";\n@@ -70,88 +66,2 @@\n-    \/\/ Owner: CN=SSL.com RSA SSL subCA, O=SSL Corporation, L=Houston, ST=Texas, C=US\n-    \/\/ Issuer: CN=SSL.com Root Certification Authority RSA, O=SSL Corporation, L=Houston, ST=Texas, C=US\n-    \/\/ Serial number: 997ed109d1f07fc\n-    \/\/ Valid from: Fri Feb 12 10:48:52 PST 2016 until: Wed Feb 12 10:48:52 PST 2031\n-    private static final String INT = \"-----BEGIN CERTIFICATE-----\\n\" +\n-            \"MIIGbzCCBFegAwIBAgIICZftEJ0fB\/wwDQYJKoZIhvcNAQELBQAwfDELMAkGA1UE\\n\" +\n-            \"BhMCVVMxDjAMBgNVBAgMBVRleGFzMRAwDgYDVQQHDAdIb3VzdG9uMRgwFgYDVQQK\\n\" +\n-            \"DA9TU0wgQ29ycG9yYXRpb24xMTAvBgNVBAMMKFNTTC5jb20gUm9vdCBDZXJ0aWZp\\n\" +\n-            \"Y2F0aW9uIEF1dGhvcml0eSBSU0EwHhcNMTYwMjEyMTg0ODUyWhcNMzEwMjEyMTg0\\n\" +\n-            \"ODUyWjBpMQswCQYDVQQGEwJVUzEOMAwGA1UECAwFVGV4YXMxEDAOBgNVBAcMB0hv\\n\" +\n-            \"dXN0b24xGDAWBgNVBAoMD1NTTCBDb3Jwb3JhdGlvbjEeMBwGA1UEAwwVU1NMLmNv\\n\" +\n-            \"bSBSU0EgU1NMIHN1YkNBMIICIjANBgkqhkiG9w0BAQEFAAOCAg8AMIICCgKCAgEA\\n\" +\n-            \"hPYpOunhcxiF6xNzl6Tsm\/Q89rnu2jVTXTBOZPaBkSD1Ic4lm7qkYwlZ\/UgV5nn1\\n\" +\n-            \"5ohhceYDC2AlR9RvGbP+26qrNcuE0XOdHJOB4SoY4d6OqLAQ6ZB0LdERK1Saa5lp\\n\" +\n-            \"QlqHE8936dpr3hGWyqMb2LsdUuhQIzwNkLU\/n9HO35irKCbKgS3FeejqkdqK5l6B\\n\" +\n-            \"b11693o4bz9UZCUdBcQ\/Xz06tA5cfnHvYkmmjxhj1lLTKwkQhWuIDrpbwWLO0QVO\\n\" +\n-            \"c29s9ieomRKm8sYMyiBG4QqRQ\/+bXwp48cF0qAByGWD6b8\/gG4Xq1IBgO5p+aWFS\\n\" +\n-            \"0mszkk5rsh4b3XbTHohP3oWQIOV20WWdtVWXiQuBB8RocAl0Ga\/\/b+epiGgME5JX\\n\" +\n-            \"LWXD1aDg\/xHy8MUsaMlh6jDfVIFepkPnkwXDpR\/n36hpgKa9dErMkgbYeEaPanLH\\n\" +\n-            \"Yd0kv4xQ36PlMMs9WhoDErGcEG9KxAXN4Axr5wl6PTDn\/lXcUFvQoIq\/5CSP+Kt5\\n\" +\n-            \"jq9tK\/gRrAc4AWqRugDvQPYUm00Rqzj5Oxm5NVQYDzbyoA66CD68LETuVrfa9GuW\\n\" +\n-            \"9MAZRO6CDzonAezIdNHsslDb1H8VN\/k0zMxjI+0ub4IAmc3I5GfZtvYcpjtMj8L4\\n\" +\n-            \"2TDS34\/COov\/Pf2HZ\/XXGlzjZ7WPmLl4fdB6hhjs2BsCAwEAAaOCAQYwggECMDAG\\n\" +\n-            \"CCsGAQUFBwEBBCQwIjAgBggrBgEFBQcwAYYUaHR0cDovL29jc3BzLnNzbC5jb20w\\n\" +\n-            \"HQYDVR0OBBYEFCYUfuDc16b34tQEJ99h8cLs5zLKMA8GA1UdEwEB\/wQFMAMBAf8w\\n\" +\n-            \"HwYDVR0jBBgwFoAU3QQJB6L1en1SUxKSle44gCUNplkwEQYDVR0gBAowCDAGBgRV\\n\" +\n-            \"HSAAMDsGA1UdHwQ0MDIwMKAuoCyGKmh0dHA6Ly9jcmxzLnNzbC5jb20vc3NsLmNv\\n\" +\n-            \"bS1yc2EtUm9vdENBLmNybDAOBgNVHQ8BAf8EBAMCAYYwHQYDVR0lBBYwFAYIKwYB\\n\" +\n-            \"BQUHAwEGCCsGAQUFBwMCMA0GCSqGSIb3DQEBCwUAA4ICAQAi6e\/iSV5DEqDO6XjQ\\n\" +\n-            \"SIIzXgc255yv6Oc2sqZnvRyVBHtHvo62jMoHY3Xunc\/EofbeS4aHdYBvgkn6CNTj\\n\" +\n-            \"VkCU+psWwcT3Pg83uP4k4Thu7bXvrClfS+XBlbJiCF\/PSJxLrKnxRn+XIGiYl62H\\n\" +\n-            \"glBhq9K8\/fZrI2Qh1mZJmWE0FlxEDCb4i8SBNi8lmDogaFi8\/yl32Z9ahmhxcLit\\n\" +\n-            \"DU\/XyKA0yOqvIrOGKH95v+\/l8fQkzE1VEFvj+iyv4TXd7mRZDOsfqfIDZhrpou02\\n\" +\n-            \"kXH\/hcXlrR++t8kjj9wt8HHQ+FkryWI6bU3KPRJR6N8EH2EHi23Rp8\/kyMs+gwaz\\n\" +\n-            \"zMqnkNPbMME723rXk6\/85sjOUaZCmhmRIx9rgqIWQesU962J0FruGOOasLT7WbZi\\n\" +\n-            \"FsmSblmpjUAo49sIRi7X493qegyCEAa412ynybhQ7LVsTLEPxVbdmGVih3jVTif\/\\n\" +\n-            \"Nztr2Isaaz4LpMEo4mGCiGxec5mKr1w8AE9n6D91CvxR5\/zL1VU1JCVC7sAtkdki\\n\" +\n-            \"vnN1\/6jEKFJvlUr5\/FX04JXeomIjXTI8ciruZ6HIkbtJup1n9Zxvmr9JQcFTsP2c\\n\" +\n-            \"bRbjaT7JD6MBidAWRCJWClR\/5etTZwWwWrRCrzvIHC7WO6rCzwu69a+l7ofCKlWs\\n\" +\n-            \"y702dmPTKEdEfwhgLx0LxJr\/Aw==\\n\" +\n-            \"-----END CERTIFICATE-----\";\n-\n-    \/\/ Owner: CN=test-dv-rsa.ssl.com\n-    \/\/ Issuer: CN=SSL.com RSA SSL subCA, O=SSL Corporation, L=Houston, ST=Texas, C=US\n-    \/\/ Serial number: 4ceada4ade82a6ccd0b2ae32c0dbfd62\n-    \/\/ Valid from: Fri Jun 28 07:06:50 PDT 2019 until: Sun Jun 27 07:06:50 PDT 2021\n-    private static final String VALID = \"-----BEGIN CERTIFICATE-----\\n\" +\n-            \"MIIHTjCCBTagAwIBAgIQTOraSt6CpszQsq4ywNv9YjANBgkqhkiG9w0BAQsFADBp\\n\" +\n-            \"MQswCQYDVQQGEwJVUzEOMAwGA1UECAwFVGV4YXMxEDAOBgNVBAcMB0hvdXN0b24x\\n\" +\n-            \"GDAWBgNVBAoMD1NTTCBDb3Jwb3JhdGlvbjEeMBwGA1UEAwwVU1NMLmNvbSBSU0Eg\\n\" +\n-            \"U1NMIHN1YkNBMB4XDTE5MDYyODE0MDY1MFoXDTIxMDYyNzE0MDY1MFowHjEcMBoG\\n\" +\n-            \"A1UEAwwTdGVzdC1kdi1yc2Euc3NsLmNvbTCCASIwDQYJKoZIhvcNAQEBBQADggEP\\n\" +\n-            \"ADCCAQoCggEBAKlOrYr8fnHN8REfJDwgsBhJvnsU4beQIYYaOAzR8pmo8eq1U\/K0\\n\" +\n-            \"uwRrgJ5K61V78zBO5qmZNiivBobViftObWrq2H6QhQsYdMYXld3SEnEotIIriRHY\\n\" +\n-            \"2PcqlgnFYXkqI0ZKs4kNs+j3GS0IwncJJwKtypmtLTCLK5J\/kG7qB2MNfXZTIzKI\\n\" +\n-            \"iZza4RUM1j67Hv3fPJzNEJ9urfjaI4xcRh5airlzBWOBU9pW87P7BgQN7cNzJQji\\n\" +\n-            \"4DSvb1pSXv8sBbZk5fmG+81PyUxcfqj7Dbih0J1Aoq0YysHugsrK\/kLz+CvqL9B2\\n\" +\n-            \"a1JMZfob9jzcA7XPjpggLc3az2Wvv3XKqokCAwEAAaOCAzswggM3MB8GA1UdIwQY\\n\" +\n-            \"MBaAFCYUfuDc16b34tQEJ99h8cLs5zLKMHwGCCsGAQUFBwEBBHAwbjBKBggrBgEF\\n\" +\n-            \"BQcwAoY+aHR0cDovL3d3dy5zc2wuY29tL3JlcG9zaXRvcnkvU1NMY29tLVN1YkNB\\n\" +\n-            \"LVNTTC1SU0EtNDA5Ni1SMS5jcnQwIAYIKwYBBQUHMAGGFGh0dHA6Ly9vY3Nwcy5z\\n\" +\n-            \"c2wuY29tMDcGA1UdEQQwMC6CE3Rlc3QtZHYtcnNhLnNzbC5jb22CF3d3dy50ZXN0\\n\" +\n-            \"LWR2LXJzYS5zc2wuY29tMFEGA1UdIARKMEgwCAYGZ4EMAQIBMDwGDCsGAQQBgqkw\\n\" +\n-            \"AQMBATAsMCoGCCsGAQUFBwIBFh5odHRwczovL3d3dy5zc2wuY29tL3JlcG9zaXRv\\n\" +\n-            \"cnkwHQYDVR0lBBYwFAYIKwYBBQUHAwIGCCsGAQUFBwMBMDoGA1UdHwQzMDEwL6At\\n\" +\n-            \"oCuGKWh0dHA6Ly9jcmxzLnNzbC5jb20vU1NMY29tUlNBU1NMc3ViQ0EuY3JsMB0G\\n\" +\n-            \"A1UdDgQWBBQD\/cmwQI853u0mOlmCjNRsAZOlEDAOBgNVHQ8BAf8EBAMCBaAwggF+\\n\" +\n-            \"BgorBgEEAdZ5AgQCBIIBbgSCAWoBaAB2AO5Lvbd1zmC64UJpH6vhnmajD35fsHLY\\n\" +\n-            \"gwDEe4l6qP3LAAABa55yL0QAAAQDAEcwRQIgWo8UQY3EYwyzkGLBLS0Zxu7oMmB7\\n\" +\n-            \"dnpzsEcoexWzZrQCIQCR6FkAe5ns84x2phRkn6nV7a0anjnxjpJUNeCfc3\/pxAB2\\n\" +\n-            \"AG9Tdqwx8DEZ2JkApFEV\/3cVHBHZAsEAKQaNsgiaN9kTAAABa55yLzsAAAQDAEcw\\n\" +\n-            \"RQIhAKhGKQIpSd59tJm\/Yac7Xo05u93CWbnDwoDgSMS+HBs5AiAfOSOc3BzY\/2MF\\n\" +\n-            \"AM4GWrkK5Ehs9JMafo\/+VBM0OrwVKQB2AId1v+dZfPiMQ5lfvfNu\/1aNR1Y2\/0q1\\n\" +\n-            \"YMG06v9eoIMPAAABa55yL4IAAAQDAEcwRQIhANcF26iGoUuzZL6rGKduPtyyYusf\\n\" +\n-            \"03lBKSyvxabB9WuvAiBNbxR210L+JP89s\/ONw53lYVr+1m\/c3u9\/9Wpu7c3n5jAN\\n\" +\n-            \"BgkqhkiG9w0BAQsFAAOCAgEACX2CbVM8MCIJ+2Wsap1v6VU2kpCS\/FBIsLSTWNEf\\n\" +\n-            \"dREv1nh93qQ2CPIxj5kP\/0EOUfq7tmQCJHMODVgz3iHrdxRB1E58nXHlZ6vUdrCo\\n\" +\n-            \"pD9d6Cp+AwvrOdv6MndVJgel9tVOAqAUblwdLzPNQHEcXoKnFEVv2SVQCmAYLlkP\\n\" +\n-            \"xX2RS73gseiit4QnVZOWi\/wDhqMm7\/iq8n7rL\/f7+ly2+7e3LVjxd24HZkgxNgbn\\n\" +\n-            \"JDjYvIla+EvyrY8514Ru3Pf1UICY03VpYjE8R7SxrqcvOLtwvOVew6TuCUl6RNpl\\n\" +\n-            \"xeC9Oa1dgf+QRXN7LvmBXUP2nOCnwJE1ENvThPLw9BXLatVJgkA\/v\/mYWE5VjzIL\\n\" +\n-            \"hboPH2fNWemUv5QMzxUkqhgHgrhr8wnhI6xYIYciGDbmmfnItHex7bxktT7axoCD\\n\" +\n-            \"3dTQQe01YfK\/LlkHtnBmJf\/t0F33m8KXcQ51fic\/TR2U5Tampxp2kdFdTyvRRqMl\\n\" +\n-            \"igqo3EhiPmB9bKsnXDA2AnvdjZT9uFwbUu5lNxjiMQcSZikjQAjJPgjCZ9BQOGbL\\n\" +\n-            \"eqgZcw2CxWMxFSTLL3TIBlNL\/0GpRlTvr3IGyvHEr7EESXKD+Ar8XW+4VlMc1s8F\\n\" +\n-            \"cdtnus71s7wm+JUSXcM0WJUkRUvWqHlPi3Ucfe7k6x6BG9Mb42ECjorefPXvFu7v\\n\" +\n-            \"OT4=\\n\" +\n-            \"-----END CERTIFICATE-----\";\n+    public void runTest() throws Exception {\n+        ValidatePathWithURL validatePathWithURL = new ValidatePathWithURL(CA_ALIAS);\n@@ -159,56 +69,2 @@\n-    \/\/ Owner: CN=revoked-rsa-dv.ssl.com\n-    \/\/ Issuer: CN=SSL.com RSA SSL subCA, O=SSL Corporation, L=Houston, ST=Texas, C=US\n-    \/\/ Serial number: 3f527e677d00558272ac90d1620b67f4\n-    \/\/ Valid from: Fri Jun 28 07:13:48 PDT 2019 until: Sun Jun 27 07:13:48 PDT 2021\n-    private static final String REVOKED = \"-----BEGIN CERTIFICATE-----\\n\" +\n-            \"MIIHVzCCBT+gAwIBAgIQP1J+Z30AVYJyrJDRYgtn9DANBgkqhkiG9w0BAQsFADBp\\n\" +\n-            \"MQswCQYDVQQGEwJVUzEOMAwGA1UECAwFVGV4YXMxEDAOBgNVBAcMB0hvdXN0b24x\\n\" +\n-            \"GDAWBgNVBAoMD1NTTCBDb3Jwb3JhdGlvbjEeMBwGA1UEAwwVU1NMLmNvbSBSU0Eg\\n\" +\n-            \"U1NMIHN1YkNBMB4XDTE5MDYyODE0MTM0OFoXDTIxMDYyNzE0MTM0OFowITEfMB0G\\n\" +\n-            \"A1UEAwwWcmV2b2tlZC1yc2EtZHYuc3NsLmNvbTCCASIwDQYJKoZIhvcNAQEBBQAD\\n\" +\n-            \"ggEPADCCAQoCggEBAMKtMVeo+fMoeu1nLrcwxNAdfUysNKEhNZbMUOu9pzCChEvJ\\n\" +\n-            \"QHUicdrIZYl9m59uKUMh3Dj2nJLZ3a0pP4iWKcOEfCVMtA83\/GDJl\/BVj3XFbsMl\\n\" +\n-            \"+HSIu7R0vQM4enOztLabnOzvE4pQOFUp8u5SKO+hmB0zQ1iWkevYjJOf5DBZ7Zsa\\n\" +\n-            \"uF4qy9JqSF07gj\/7FNqmqnfy6Z8yc8WAMjoUJrVrvmHQZeX\/bCWxczFhYmAtYlwO\\n\" +\n-            \"7a914VP79b3Jq60HbLbYBdILnuU1Uu5L\/JbG+hm\/fH2meY30aWUaKcGY04ej6xuM\\n\" +\n-            \"hWsLhOrmcl3P7\/E5UUojaR1Zvdtsn7jkQ8Y3iOsCAwEAAaOCA0EwggM9MB8GA1Ud\\n\" +\n-            \"IwQYMBaAFCYUfuDc16b34tQEJ99h8cLs5zLKMHwGCCsGAQUFBwEBBHAwbjBKBggr\\n\" +\n-            \"BgEFBQcwAoY+aHR0cDovL3d3dy5zc2wuY29tL3JlcG9zaXRvcnkvU1NMY29tLVN1\\n\" +\n-            \"YkNBLVNTTC1SU0EtNDA5Ni1SMS5jcnQwIAYIKwYBBQUHMAGGFGh0dHA6Ly9vY3Nw\\n\" +\n-            \"cy5zc2wuY29tMD0GA1UdEQQ2MDSCFnJldm9rZWQtcnNhLWR2LnNzbC5jb22CGnd3\\n\" +\n-            \"dy5yZXZva2VkLXJzYS1kdi5zc2wuY29tMFEGA1UdIARKMEgwCAYGZ4EMAQIBMDwG\\n\" +\n-            \"DCsGAQQBgqkwAQMBATAsMCoGCCsGAQUFBwIBFh5odHRwczovL3d3dy5zc2wuY29t\\n\" +\n-            \"L3JlcG9zaXRvcnkwHQYDVR0lBBYwFAYIKwYBBQUHAwIGCCsGAQUFBwMBMDoGA1Ud\\n\" +\n-            \"HwQzMDEwL6AtoCuGKWh0dHA6Ly9jcmxzLnNzbC5jb20vU1NMY29tUlNBU1NMc3Vi\\n\" +\n-            \"Q0EuY3JsMB0GA1UdDgQWBBSTrHG0Sh+8BEp+oP+avIGAtSdyajAOBgNVHQ8BAf8E\\n\" +\n-            \"BAMCBaAwggF+BgorBgEEAdZ5AgQCBIIBbgSCAWoBaAB2AESUZS6w7s6vxEAH2Kj+\\n\" +\n-            \"KMDa5oK+2MsxtT\/TM5a1toGoAAABa554kQsAAAQDAEcwRQIhAIfU+5HWDnqZdlMN\\n\" +\n-            \"Z+CEkBE8wBFUWzG0ixSQ5S1Tryt4AiAQevLU7OF3N90zIt2QpwVAIGve5lBElhMH\\n\" +\n-            \"fRqXTkeZZwB2AG9Tdqwx8DEZ2JkApFEV\/3cVHBHZAsEAKQaNsgiaN9kTAAABa554\\n\" +\n-            \"jJQAAAQDAEcwRQIhAPd8mNiDFHA74Bl16nwOPehQZmiFltzCYDsd0uHv5qCfAiB+\\n\" +\n-            \"S43G7Yhq62Ofma6wXsag+UEl\/tttzfbfASGz1WPBOQB2AKS5CZC0GFgUh7sTosxn\\n\" +\n-            \"cAo8NZgE+RvfuON3zQ7IDdwQAAABa554kDoAAAQDAEcwRQIgUs8O4gQ34Sp0K4Dn\\n\" +\n-            \"Wh7FRFJWwZ6cGYvqmKT+UyCeVisCIQDl0AYXsn4ILMafvmJwnXlcduZ3z6P0jwGK\\n\" +\n-            \"Cjh26ETDFzANBgkqhkiG9w0BAQsFAAOCAgEAAtTlh2YMwe6E0+EWKU3H79NmgLjK\\n\" +\n-            \"xoR3VtT56ILRt0qJuJ+z1iqq\/IxZBe7wnUUWU46SWmBfDEQcGI7Hdomr67QBZNZz\\n\" +\n-            \"+wvnatMzrCPM7jPsb05Motz99NSk6yzQzR2c030sy1d78mRKJ\/4wpidNDHpjuYL9\\n\" +\n-            \"cBp2gKf2\/RxU74+BhugCjLqB1gojGO0CT1\/g5a1QMtqRMM0EPrJrrtcEM0zG48yI\\n\" +\n-            \"P3b57Nl2ZbshRvY9bVi3of2SaPFQgu99\/zAlerPUThz4O2CskOgKt77y6KOgCbBp\\n\" +\n-            \"7fQF6vh\/aOm0Xba2Z0CtB+uVN2g4+LwyuovOy+JyjGKv7GxRKEQmGZsRLDVpxOs5\\n\" +\n-            \"W47K+iuOEhTRWRkStfuk2LcCLwTrgxHv2\/Wo+80ME\/7wxGKs1IzlkcFtFLhaeN4p\\n\" +\n-            \"QsmADpcyBfeWmvTdKgaVBOE2F\/nenIiKpo+0jcoMAW6JgMD+otn8gofBq+Za1N4X\\n\" +\n-            \"xckvLWbMDAj4lELBHXu7gLHHLJCL9GGPD5HKjH\/RyLtKKaRgT\/AV6jl\/woKTAzGF\\n\" +\n-            \"SPqgNQsu+sCdUbO0nDONkXDxhfan8XNrd32KMPGucJySiyjpHkurobMuGbs\/LQzd\\n\" +\n-            \"JLTSTIIIPpEHBk7PHRGPSFewIhi0aDhupgZLU9UGrLRw\/xV\/KlGqTcGFWBvvOC+I\\n\" +\n-            \"CSZFRr0hWBv\/dfw=\\n\" +\n-            \"-----END CERTIFICATE-----\";\n-\n-    public void runTest(ValidatePathWithParams pathValidator, boolean ocspEnabled) throws Exception {\n-        \/\/ Validate valid\n-        pathValidator.validate(new String[]{VALID, INT},\n-                ValidatePathWithParams.Status.GOOD, null, System.out);\n-\n-        \/\/ Validate Revoked\n-        pathValidator.validate(new String[]{REVOKED, INT},\n-                ValidatePathWithParams.Status.REVOKED,\n-                \"Fri Jun 28 07:25:02 PDT 2019\", System.out);\n+        validatePathWithURL.validateDomain(VALID, false);\n+        validatePathWithURL.validateDomain(REVOKED, true);\n@@ -219,0 +75,3 @@\n+    private static final String VALID = \"https:\/\/test-ev-rsa.ssl.com\";\n+    private static final String REVOKED = \"https:\/\/revoked-rsa-ev.ssl.com\";\n+    private static final String CA_ALIAS = \"sslrootevrsaca [jdk]\";\n@@ -220,151 +79,2 @@\n-    \/\/ Owner: CN=SSL.com EV SSL Intermediate CA RSA R3, O=SSL Corp, L=Houston, ST=Texas, C=US\n-    \/\/ Issuer: CN=SSL.com EV Root Certification Authority RSA R2, O=SSL Corporation, L=Houston, ST=Texas, C=US\n-    \/\/ Serial number: 56b629cd34bc78f6\n-    \/\/ Valid from: Wed May 31 11:14:37 PDT 2017 until: Fri May 30 11:14:37 PDT 2042\n-    private static final String INT = \"-----BEGIN CERTIFICATE-----\\n\" +\n-            \"MIIG4DCCBMigAwIBAgIQA6P00GAwUqM3zjgKiDAxjDANBgkqhkiG9w0BAQsFADCB\\n\" +\n-            \"gjELMAkGA1UEBhMCVVMxDjAMBgNVBAgMBVRleGFzMRAwDgYDVQQHDAdIb3VzdG9u\\n\" +\n-            \"MRgwFgYDVQQKDA9TU0wgQ29ycG9yYXRpb24xNzA1BgNVBAMMLlNTTC5jb20gRVYg\\n\" +\n-            \"Um9vdCBDZXJ0aWZpY2F0aW9uIEF1dGhvcml0eSBSU0EgUjIwHhcNMTkwMzI2MTc0\\n\" +\n-            \"NjUzWhcNMzQwMzIyMTc0NjUzWjByMQswCQYDVQQGEwJVUzEOMAwGA1UECAwFVGV4\\n\" +\n-            \"YXMxEDAOBgNVBAcMB0hvdXN0b24xETAPBgNVBAoMCFNTTCBDb3JwMS4wLAYDVQQD\\n\" +\n-            \"DCVTU0wuY29tIEVWIFNTTCBJbnRlcm1lZGlhdGUgQ0EgUlNBIFIzMIICIjANBgkq\\n\" +\n-            \"hkiG9w0BAQEFAAOCAg8AMIICCgKCAgEAkby+CNUTyO0wakMc6VeJxQLGcTtfwJG6\\n\" +\n-            \"W9MYhMBWW22YUMtfCL7at\/ey89eCc0cNy9uekJqitJe78Ion5qHBLfSpahYWttzr\\n\" +\n-            \"LflXkdlPz6xsZuw7F\/tp6oYrcUpRIX92ci0EhORtb5xoX7rwzrBnG2Jv7fPn8JGj\\n\" +\n-            \"wmvYPS0meVkuKGtdR\/s3dkl0tDraq2xti8cN7W9VawzLDL9yNyEw2GWAp3M5Uqex\\n\" +\n-            \"Yjh9HY5w\/4bgk7K0KSw+2njaXCEa2MugM6txHDKjocVFBe7G8JPMKkCcbbrgZo\/q\\n\" +\n-            \"ygTnIY8q7B1XQG2wrdsu4LTo9ijIYmoZHBAKN\/XCdPecQYF9cHrv6NjVUcMrNmHT\\n\" +\n-            \"B43NrIvrXmm3lZJU4PZNUhb7YrDtpN+rV6zSaKAu\/EArGDzYv8iHKT2E+wjhwqOC\\n\" +\n-            \"WnXv1qSa\/\/xvN6RSoDMpj7q7iTxfdrQqRFsr70hyPrUmnoJLrBBg1+IqFTkaNtuk\\n\" +\n-            \"misP4Bd0zeqkEuxYCmhKcCTM2iS9RMCIot5HI5qeAcVs63WzM+ax0zbHK1F9AIOG\\n\" +\n-            \"gwrVRrdwXRSXO4TlvamsL6klJMnjSCs7E1l8xeE403nZPp4RGr5ZQFrhfdG9nL7w\\n\" +\n-            \"66osGX+dGHGZkFjASS3Bw0RCiz4oCJxFGE+FAD7pJaV8GP6XTkaZp9n1ooYzCC48\\n\" +\n-            \"vq0OtfRS62MCAwEAAaOCAV8wggFbMBIGA1UdEwEB\/wQIMAYBAf8CAQAwHwYDVR0j\\n\" +\n-            \"BBgwFoAU+WC71OPVNPa49QaAJadz20ZpqJ4wfAYIKwYBBQUHAQEEcDBuMEoGCCsG\\n\" +\n-            \"AQUFBzAChj5odHRwOi8vd3d3LnNzbC5jb20vcmVwb3NpdG9yeS9TU0xjb20tUm9v\\n\" +\n-            \"dENBLUVWLVJTQS00MDk2LVIyLmNydDAgBggrBgEFBQcwAYYUaHR0cDovL29jc3Bz\\n\" +\n-            \"LnNzbC5jb20wEQYDVR0gBAowCDAGBgRVHSAAMB0GA1UdJQQWMBQGCCsGAQUFBwMC\\n\" +\n-            \"BggrBgEFBQcDATBFBgNVHR8EPjA8MDqgOKA2hjRodHRwOi8vY3Jscy5zc2wuY29t\\n\" +\n-            \"L1NTTGNvbS1Sb290Q0EtRVYtUlNBLTQwOTYtUjIuY3JsMB0GA1UdDgQWBBS\/wVqH\\n\" +\n-            \"\/yj6QT39t0\/kHa+gYVgpvTAOBgNVHQ8BAf8EBAMCAYYwDQYJKoZIhvcNAQELBQAD\\n\" +\n-            \"ggIBAAoTAGRea1Lg+Rlvnhj6lHbvhn9mjUlXZuI1b4d4jDDk5X29gNKhW7Rg97Qt\\n\" +\n-            \"oBoJaLb9gZkJ2MkUbCE1x2jIghjLmmFvaIq+nAZEMtWWEi0ycqQm8rVUHioZ2Mfn\\n\" +\n-            \"2SoFtQeY+5MFLO9l8IeDaNZ+LV3su8YTsh\/453vExhiNhPVEqLyGlkkW0B2gNW8z\\n\" +\n-            \"bsRy6L5QW0cZ4gZrY86MvHB0Gl299mTJ4jcgic+Oalbz9SZJ+EiW\/aUDSpZ2zawi\\n\" +\n-            \"ackPWmAbk0y0gouOymrwOJZTuq+AJEJ6M+WSVdknwE7YwDpVMszHXS38BS1A5N1i\\n\" +\n-            \"rzW3BcARHbtCb00vEy2mzW5JPM2LjkzfgJ0lBiyDCE3ZeBeUtKmcdFUFrHwHl3gV\\n\" +\n-            \"aRipD+xMa1hGOTh33eMzwWoRxvk6o7y73Sy6XBfycN+8LhXUZT0X8STmWtBtLSMp\\n\" +\n-            \"blWMjuuFyUVQvIj05N7hORY\/LhdQhEx8kVwS5RkLVSpRnohdk+nI69yIA7EwZKlw\\n\" +\n-            \"kKEsDqlVOeDYWVWQANDC55kJ7nOyJbqtGJqImwWXdQcf37fi80cf+mKOYs5vNmkx\\n\" +\n-            \"D9bwFWsKnP71x0liSlv8z79vRAo8FJwTgXRNO1c0ACf0rXEJy3GRAXRWiTvuGahR\\n\" +\n-            \"JVM3Jnn0G6o3+vTfwa7CKR\/9Jc4t25iRU3xmSgiusg4u8i5x\\n\" +\n-            \"-----END CERTIFICATE-----\";\n-\n-    \/\/ Owner: OID.1.3.6.1.4.1.311.60.2.1.3=US, OID.1.3.6.1.4.1.311.60.2.1.2=Nevada, STREET=3100 Richmond Ave,\n-    \/\/ OID.2.5.4.15=Private Organization, OID.2.5.4.17=77098, CN=test-ev-rsa.ssl.com, SERIALNUMBER=NV20081614243,\n-    \/\/ O=SSL Corp, L=Houston, ST=Texas, C=US\n-    \/\/ Issuer: CN=SSL.com EV SSL Intermediate CA RSA R3, O=SSL Corp, L=Houston, ST=Texas, C=US\n-    \/\/ Serial number: 558089b221d7cd9c7a4bc4a7fd7e2969\n-    \/\/ Valid from: Mon Jul 01 13:28:01 PDT 2019 until: Wed Jun 30 13:28:01 PDT 2021\n-    private static final String VALID = \"-----BEGIN CERTIFICATE-----\\n\" +\n-            \"MIIISTCCBjGgAwIBAgIQVYCJsiHXzZx6S8Sn\/X4paTANBgkqhkiG9w0BAQsFADBy\\n\" +\n-            \"MQswCQYDVQQGEwJVUzEOMAwGA1UECAwFVGV4YXMxEDAOBgNVBAcMB0hvdXN0b24x\\n\" +\n-            \"ETAPBgNVBAoMCFNTTCBDb3JwMS4wLAYDVQQDDCVTU0wuY29tIEVWIFNTTCBJbnRl\\n\" +\n-            \"cm1lZGlhdGUgQ0EgUlNBIFIzMB4XDTE5MDcwMTIwMjgwMVoXDTIxMDYzMDIwMjgw\\n\" +\n-            \"MVowgfExCzAJBgNVBAYTAlVTMQ4wDAYDVQQIDAVUZXhhczEQMA4GA1UEBwwHSG91\\n\" +\n-            \"c3RvbjERMA8GA1UECgwIU1NMIENvcnAxFjAUBgNVBAUTDU5WMjAwODE2MTQyNDMx\\n\" +\n-            \"HDAaBgNVBAMME3Rlc3QtZXYtcnNhLnNzbC5jb20xDjAMBgNVBBEMBTc3MDk4MR0w\\n\" +\n-            \"GwYDVQQPDBRQcml2YXRlIE9yZ2FuaXphdGlvbjEaMBgGA1UECQwRMzEwMCBSaWNo\\n\" +\n-            \"bW9uZCBBdmUxFzAVBgsrBgEEAYI3PAIBAgwGTmV2YWRhMRMwEQYLKwYBBAGCNzwC\\n\" +\n-            \"AQMTAlVTMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAsmMOHfREGN48\\n\" +\n-            \"nlgxYiF0EJsytoM98UAslRRlGHJyZw3SLcPx9u\/I82h0KKjLtnY3\/o62mCoEZYlc\\n\" +\n-            \"1UKKEIi3NgByU8yJ0yynm3I0LJHEZqOKoahtzwP787\/OtqsSsWeblrTnfxVO7G1J\\n\" +\n-            \"bPYrPtNuQ9ZnmByyhA+hlTIY48kJh5WtmBeftBSynuKCgpVnkv2y2LKZJc4t6JQX\\n\" +\n-            \"XO6Geev8LPUd2uPVjatZv0se2YKdixFQQKwWcLJV5LZqjZDhZtPomCN0sp+wle4p\\n\" +\n-            \"rRTZPSWRB98mI1X+UBTFGFKS9cxzO2NwmVcbgN2WYR+FpWbatoS\/RThGC7mKQB7i\\n\" +\n-            \"5BEQHNZMawIDAQABo4IDWTCCA1UwHwYDVR0jBBgwFoAUv8Fah\/8o+kE9\/bdP5B2v\\n\" +\n-            \"oGFYKb0wfwYIKwYBBQUHAQEEczBxME0GCCsGAQUFBzAChkFodHRwOi8vd3d3LnNz\\n\" +\n-            \"bC5jb20vcmVwb3NpdG9yeS9TU0xjb20tU3ViQ0EtRVYtU1NMLVJTQS00MDk2LVIz\\n\" +\n-            \"LmNydDAgBggrBgEFBQcwAYYUaHR0cDovL29jc3BzLnNzbC5jb20wNwYDVR0RBDAw\\n\" +\n-            \"LoITdGVzdC1ldi1yc2Euc3NsLmNvbYIXd3d3LnRlc3QtZXYtcnNhLnNzbC5jb20w\\n\" +\n-            \"XwYDVR0gBFgwVjAHBgVngQwBATANBgsqhGgBhvZ3AgUBATA8BgwrBgEEAYKpMAED\\n\" +\n-            \"AQQwLDAqBggrBgEFBQcCARYeaHR0cHM6Ly93d3cuc3NsLmNvbS9yZXBvc2l0b3J5\\n\" +\n-            \"MB0GA1UdJQQWMBQGCCsGAQUFBwMCBggrBgEFBQcDATBIBgNVHR8EQTA\/MD2gO6A5\\n\" +\n-            \"hjdodHRwOi8vY3Jscy5zc2wuY29tL1NTTGNvbS1TdWJDQS1FVi1TU0wtUlNBLTQw\\n\" +\n-            \"OTYtUjMuY3JsMB0GA1UdDgQWBBTIDVTF3DDhdwudatuodPyHe1jcOzAOBgNVHQ8B\\n\" +\n-            \"Af8EBAMCBaAwggF9BgorBgEEAdZ5AgQCBIIBbQSCAWkBZwB1AG9Tdqwx8DEZ2JkA\\n\" +\n-            \"pFEV\/3cVHBHZAsEAKQaNsgiaN9kTAAABa69CQcUAAAQDAEYwRAIgEYzpfp8v+gG3\\n\" +\n-            \"S9cgZIuFCKPeoSM85gag8\/iBJhNIb9oCIDcq+2Pi8+E3LAVmZfgcMhg30t821LNn\\n\" +\n-            \"PWATU5+gAmmzAHUAh3W\/51l8+IxDmV+9827\/Vo1HVjb\/SrVgwbTq\/16ggw8AAAFr\\n\" +\n-            \"r0JCCQAABAMARjBEAiAzeyNw\/2osk+xktY8VpFTsROj7jRODS2G3G2MDV6ZmMwIg\\n\" +\n-            \"bwuFbNxSEqUfKhveZJVVLYzZtzXcjkhflaazupumZrkAdwC72d+8H4pxtZOUI5eq\\n\" +\n-            \"kntHOFeVCqtS6BqQlmQ2jh7RhQAAAWuvQkGUAAAEAwBIMEYCIQCEfoPIKoy0Rv\/d\\n\" +\n-            \"DXOVm0FzKDH2zWHN\/oQZ\/7gwd21hvAIhAL2gDESf+tcjCkbjdj9NpDa\/fVWO9VZD\\n\" +\n-            \"uPPnAZ6jf2G3MA0GCSqGSIb3DQEBCwUAA4ICAQAcYH\/+o9N0E3H9h0GfohGElfRw\\n\" +\n-            \"XPUnQI3\/CZwuG0ShCbpVspvUkuR\/P0Hjr9XgDVy39R9SOaEDK3\/coG8\/Ry56Lrm0\\n\" +\n-            \"17v+yeEzAVK51eQeinHoCYc9TIwmyrwt36JE\/zIwnDB623Y4ccxYN5LZxjVx668\/\\n\" +\n-            \"xj3JffaY5185qPjAqkjLUzj9TeeAJk\/ws1YXbQJvO4CZV2QXrishC+dEoqvfOe\/u\\n\" +\n-            \"sMHcMJy+cFrPhe4cC7s9fHeYTpF36yvfWrgjGwDki\/9zgRhOvDuM72dIMkrcHkZi\\n\" +\n-            \"OvZMgyoXz\/Nw3D514K9BSt6xRB2qGzI8fx0EOGzEEjX1Zdie2uVDy9aC8k8TjQAM\\n\" +\n-            \"v\/YT7Bggpv300hWvBGw0QT8l7Nk1PZFBagAhqRCKRsR1pUZ8CyZzwNkNyUSYV4Or\\n\" +\n-            \"n0vYwVEgpMeSMu\/ObWwWPM7QKSNcSSIV5lxmsZX+wS76OpDMHm27P94RTEePF4sG\\n\" +\n-            \"QmvY6hgHSlREJUL0vyGGY2Rbm3cL3zaM4qTquN18v61uUVKakELYIcRZwVTyBj5M\\n\" +\n-            \"KxOkjGXnLYpDOLFHD4WB1q7J+SorG43V+nbmTEN5fshGUjjWoz5ykfErnyJa1+Py\\n\" +\n-            \"FXWoPFb425DelhuDe94btROuJELRfzhqDXoKrhDgSQGV2qM3sk6uIPOaoH4N31ko\\n\" +\n-            \"C41bezSdJ5r4mif8iA==\\n\" +\n-            \"-----END CERTIFICATE-----\";\n-\n-    \/\/ Owner: OID.1.3.6.1.4.1.311.60.2.1.3=US, OID.1.3.6.1.4.1.311.60.2.1.2=Nevada, STREET=3100 Richmond Ave,\n-    \/\/ OID.2.5.4.15=Private Organization, OID.2.5.4.17=77098, CN=revoked-rsa-ev.ssl.com, SERIALNUMBER=NV20081614243,\n-    \/\/ O=SSL Corp, L=Houston, ST=Texas, C=US\n-    \/\/ Issuer: CN=SSL.com EV SSL Intermediate CA RSA R3, O=SSL Corp, L=Houston, ST=Texas, C=US\n-    \/\/ Serial number: 1ea7f53492bded2d425135bdf525889f\n-    \/\/ Valid from: Mon Jul 01 13:29:02 PDT 2019 until: Wed Jun 30 13:29:02 PDT 2021\n-    private static final String REVOKED = \"-----BEGIN CERTIFICATE-----\\n\" +\n-            \"MIIIUzCCBjugAwIBAgIQHqf1NJK97S1CUTW99SWInzANBgkqhkiG9w0BAQsFADBy\\n\" +\n-            \"MQswCQYDVQQGEwJVUzEOMAwGA1UECAwFVGV4YXMxEDAOBgNVBAcMB0hvdXN0b24x\\n\" +\n-            \"ETAPBgNVBAoMCFNTTCBDb3JwMS4wLAYDVQQDDCVTU0wuY29tIEVWIFNTTCBJbnRl\\n\" +\n-            \"cm1lZGlhdGUgQ0EgUlNBIFIzMB4XDTE5MDcwMTIwMjkwMloXDTIxMDYzMDIwMjkw\\n\" +\n-            \"MlowgfQxCzAJBgNVBAYTAlVTMQ4wDAYDVQQIDAVUZXhhczEQMA4GA1UEBwwHSG91\\n\" +\n-            \"c3RvbjERMA8GA1UECgwIU1NMIENvcnAxFjAUBgNVBAUTDU5WMjAwODE2MTQyNDMx\\n\" +\n-            \"HzAdBgNVBAMMFnJldm9rZWQtcnNhLWV2LnNzbC5jb20xDjAMBgNVBBEMBTc3MDk4\\n\" +\n-            \"MR0wGwYDVQQPDBRQcml2YXRlIE9yZ2FuaXphdGlvbjEaMBgGA1UECQwRMzEwMCBS\\n\" +\n-            \"aWNobW9uZCBBdmUxFzAVBgsrBgEEAYI3PAIBAgwGTmV2YWRhMRMwEQYLKwYBBAGC\\n\" +\n-            \"NzwCAQMTAlVTMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAlqZwW2n7\\n\" +\n-            \"Ot8ujRGyCkzf\/FqkiIi6+mq7QXlBMsZVNmLcWzatoS9K8WOviU+lmYpdV3rkrX1v\\n\" +\n-            \"e\/FZBwtBR\/x1FRN3CPoGcO0Yu6CZjknHtyyNQ36mwUy7UW+rQKYjDfU4aXme4bP8\\n\" +\n-            \"Dk2rUYQtM\/xpYHKDk9x7Vg4zAmk+L0LQmSU0103DRuANnxOszEK196UbLE4W+2+i\\n\" +\n-            \"Xat40jHW3KU2PxVfCajgB1mdrDt2b5j\/qDAL+Wo2DzCtE62UPJvI6UyEqJ24jinS\\n\" +\n-            \"A4l4NgkMPDMWNU5QIkV\/EhQvZMUKCvNUv+Gsq8pcOeDXxKpBIe\/KoQSMH18mym1U\\n\" +\n-            \"vIaTjAzDDsWjqwIDAQABo4IDYDCCA1wwHwYDVR0jBBgwFoAUv8Fah\/8o+kE9\/bdP\\n\" +\n-            \"5B2voGFYKb0wfwYIKwYBBQUHAQEEczBxME0GCCsGAQUFBzAChkFodHRwOi8vd3d3\\n\" +\n-            \"LnNzbC5jb20vcmVwb3NpdG9yeS9TU0xjb20tU3ViQ0EtRVYtU1NMLVJTQS00MDk2\\n\" +\n-            \"LVIzLmNydDAgBggrBgEFBQcwAYYUaHR0cDovL29jc3BzLnNzbC5jb20wPQYDVR0R\\n\" +\n-            \"BDYwNIIWcmV2b2tlZC1yc2EtZXYuc3NsLmNvbYIad3d3LnJldm9rZWQtcnNhLWV2\\n\" +\n-            \"LnNzbC5jb20wXwYDVR0gBFgwVjAHBgVngQwBATANBgsqhGgBhvZ3AgUBATA8Bgwr\\n\" +\n-            \"BgEEAYKpMAEDAQQwLDAqBggrBgEFBQcCARYeaHR0cHM6Ly93d3cuc3NsLmNvbS9y\\n\" +\n-            \"ZXBvc2l0b3J5MB0GA1UdJQQWMBQGCCsGAQUFBwMCBggrBgEFBQcDATBIBgNVHR8E\\n\" +\n-            \"QTA\/MD2gO6A5hjdodHRwOi8vY3Jscy5zc2wuY29tL1NTTGNvbS1TdWJDQS1FVi1T\\n\" +\n-            \"U0wtUlNBLTQwOTYtUjMuY3JsMB0GA1UdDgQWBBQnclOL04VraXmRZEkhwgMbajmy\\n\" +\n-            \"YTAOBgNVHQ8BAf8EBAMCBaAwggF+BgorBgEEAdZ5AgQCBIIBbgSCAWoBaAB3AG9T\\n\" +\n-            \"dqwx8DEZ2JkApFEV\/3cVHBHZAsEAKQaNsgiaN9kTAAABa69DLjEAAAQDAEgwRgIh\\n\" +\n-            \"AMd3B9Gt\/hpTCZ+2xsOTTKBaDjh+EsMcKuwZkEpO6UN0AiEA8yiZ9ZIrCOUxsdQp\\n\" +\n-            \"FJi+MtsNQxvgu8igdv+l34jHZA0AdgCHdb\/nWXz4jEOZX73zbv9WjUdWNv9KtWDB\\n\" +\n-            \"tOr\/XqCDDwAAAWuvQy52AAAEAwBHMEUCIQCFPALMZd6xk4NgYuTXoJGo\/FRX0Wub\\n\" +\n-            \"VWSgTZQwld5fTQIgDDp8vajs+7R7XyKOv41xP26NQ3zR4EegwOGeb0paiIIAdQC7\\n\" +\n-            \"2d+8H4pxtZOUI5eqkntHOFeVCqtS6BqQlmQ2jh7RhQAAAWuvQy4MAAAEAwBGMEQC\\n\" +\n-            \"IGFiEQ8fMrjm1bV\/mbT35bvJWf4mUbb92\/NkHkQvHcaQAiBcS4CclZmzQLj4w6CV\\n\" +\n-            \"JsLf1P6+OhCDtvxWZdndGwJRczANBgkqhkiG9w0BAQsFAAOCAgEAFwE\/RMAk871D\\n\" +\n-            \"acLlB0Jb29+WBmCgIu1pA+bh5\/lMxn5KoPxkbHPFVHlfenDgZHUNU6DKH4HdCUG7\\n\" +\n-            \"GSAyajLiYRkcrDtBfp5MtNUAqnOJbh2NWiJ3FgSdAjfeSXPhhGfQ3U+0YCWarBfO\\n\" +\n-            \"xZ49eyhTzhHMoW+caJV3jC442Ebzh2X243MwcxqIkjgzWs6duiHnpHfT9gZBl3ou\\n\" +\n-            \"eu85LVFwzxNdrrAx1yG9PA05wCsYYlzwx7fC8ycfbvs+2ORIztiEScyr9VCg5sho\\n\" +\n-            \"YGuBFuP38sWRwiV5K7+EqpGjY+4R3BLWol7lzWsqWJC1J4zkd6Df5reSGBt0wlbx\\n\" +\n-            \"7MdUTXzHMtP8NDIYpdMBrPbkzOKIDzO6bDMsBWWFz7rWCmxUI6sSf0yknPtmBgCd\\n\" +\n-            \"rJAq25V\/DqSRGrkaY4Dx1CPGtwYN34fCDLxKeN69rG5mkR2w7HRR5eMXek6oi3Pr\\n\" +\n-            \"hQrKt5NgrYjO6HJ6ABI5xoDM9doXy9BYbz5RX43RTU399aIqyXZh0d3W0rr7wggt\\n\" +\n-            \"+PFRU1OJqhpPQgKsB5zFT3G2HgVBD0hawHS+0Hu+CHpngiDziH+eyvTk3tdhIq2x\\n\" +\n-            \"oDZXs7SSZK6hf\/im+7OFSkROy6CwhAn3nxRI9lpag1tTgF4kVSctBv+301ev0twX\\n\" +\n-            \"0w6RymKcvEbcuSDHkzOYWxc1cqwOxjA=\\n\" +\n-            \"-----END CERTIFICATE-----\";\n+    public void runTest() throws Exception {\n+        ValidatePathWithURL validatePathWithURL = new ValidatePathWithURL(CA_ALIAS);\n@@ -372,9 +82,2 @@\n-    public void runTest(ValidatePathWithParams pathValidator, boolean ocspEnabled) throws Exception {\n-        \/\/ Validate valid\n-        pathValidator.validate(new String[]{VALID, INT},\n-                ValidatePathWithParams.Status.GOOD, null, System.out);\n-\n-        \/\/ Validate Revoked\n-        pathValidator.validate(new String[]{REVOKED, INT},\n-                ValidatePathWithParams.Status.REVOKED,\n-                \"Mon Jul 01 20:53:13 PDT 2019\", System.out);\n+        validatePathWithURL.validateDomain(VALID, false);\n+        validatePathWithURL.validateDomain(REVOKED, true);\n@@ -385,0 +88,3 @@\n+    private static final String VALID = \"https:\/\/test-dv-ecc.ssl.com\";\n+    private static final String REVOKED = \"https:\/\/revoked-ecc-dv.ssl.com\";\n+    private static final String CA_ALIAS = \"sslrooteccca [jdk]\";\n@@ -386,98 +92,2 @@\n-    \/\/ Owner: CN=SSL.com SSL Intermediate CA ECC R2, O=SSL Corp, L=Houston, ST=Texas, C=US\n-    \/\/ Issuer: CN=SSL.com Root Certification Authority ECC, O=SSL Corporation, L=Houston, ST=Texas, C=US\n-    \/\/ Serial number: 75e6dfcbc1685ba8\n-    \/\/ Valid from: Fri Feb 12 10:14:03 PST 2016 until: Tue Feb 12 10:14:03 PST 2041\n-    private static final String INT = \"-----BEGIN CERTIFICATE-----\\n\" +\n-            \"MIIDejCCAv+gAwIBAgIQHNcSEt4VENkSgtozEEoQLzAKBggqhkjOPQQDAzB8MQsw\\n\" +\n-            \"CQYDVQQGEwJVUzEOMAwGA1UECAwFVGV4YXMxEDAOBgNVBAcMB0hvdXN0b24xGDAW\\n\" +\n-            \"BgNVBAoMD1NTTCBDb3Jwb3JhdGlvbjExMC8GA1UEAwwoU1NMLmNvbSBSb290IENl\\n\" +\n-            \"cnRpZmljYXRpb24gQXV0aG9yaXR5IEVDQzAeFw0xOTAzMDcxOTQyNDJaFw0zNDAz\\n\" +\n-            \"MDMxOTQyNDJaMG8xCzAJBgNVBAYTAlVTMQ4wDAYDVQQIDAVUZXhhczEQMA4GA1UE\\n\" +\n-            \"BwwHSG91c3RvbjERMA8GA1UECgwIU1NMIENvcnAxKzApBgNVBAMMIlNTTC5jb20g\\n\" +\n-            \"U1NMIEludGVybWVkaWF0ZSBDQSBFQ0MgUjIwdjAQBgcqhkjOPQIBBgUrgQQAIgNi\\n\" +\n-            \"AASEOWn30uEYKDLFu4sCjFQ1VupFaeMtQjqVWyWSA7+KFljnsVaFQ2hgs4cQk1f\/\\n\" +\n-            \"RQ2INSwdVCYU0i5qsbom20rigUhDh9dM\/r6bEZ75eFE899kSCI14xqThYVLPdLEl\\n\" +\n-            \"+dyjggFRMIIBTTASBgNVHRMBAf8ECDAGAQH\/AgEAMB8GA1UdIwQYMBaAFILRhXMw\\n\" +\n-            \"5zUE044CkvvlpNHEIejNMHgGCCsGAQUFBwEBBGwwajBGBggrBgEFBQcwAoY6aHR0\\n\" +\n-            \"cDovL3d3dy5zc2wuY29tL3JlcG9zaXRvcnkvU1NMY29tLVJvb3RDQS1FQ0MtMzg0\\n\" +\n-            \"LVIxLmNydDAgBggrBgEFBQcwAYYUaHR0cDovL29jc3BzLnNzbC5jb20wEQYDVR0g\\n\" +\n-            \"BAowCDAGBgRVHSAAMB0GA1UdJQQWMBQGCCsGAQUFBwMCBggrBgEFBQcDATA7BgNV\\n\" +\n-            \"HR8ENDAyMDCgLqAshipodHRwOi8vY3Jscy5zc2wuY29tL3NzbC5jb20tZWNjLVJv\\n\" +\n-            \"b3RDQS5jcmwwHQYDVR0OBBYEFA10Zgpen+Is7NXCXSUEf3Uyuv99MA4GA1UdDwEB\\n\" +\n-            \"\/wQEAwIBhjAKBggqhkjOPQQDAwNpADBmAjEAxYt6Ylk\/N8Fch\/3fgKYKwI5A011Q\\n\" +\n-            \"MKW0h3F9JW\/NX\/F7oYtWrxljheH8n2BrkDybAjEAlCxkLE0vQTYcFzrR24oogyw6\\n\" +\n-            \"VkgTm92+jiqJTO5SSA9QUa092S5cTKiHkH2cOM6m\\n\" +\n-            \"-----END CERTIFICATE-----\";\n-\n-    \/\/ Owner: CN=test-dv-ecc.ssl.com\n-    \/\/ Issuer: CN=SSL.com SSL Intermediate CA ECC R2, O=SSL Corp, L=Houston, ST=Texas, C=US\n-    \/\/ Serial number: 1bfbd8e4bea894f3d1887c50e7d366d7\n-    \/\/ Valid from: Fri Jun 28 06:58:27 PDT 2019 until: Sun Jun 27 06:58:27 PDT 2021\n-    private static final String VALID = \"-----BEGIN CERTIFICATE-----\\n\" +\n-            \"MIIE9TCCBHqgAwIBAgIQG\/vY5L6olPPRiHxQ59Nm1zAKBggqhkjOPQQDAzBvMQsw\\n\" +\n-            \"CQYDVQQGEwJVUzEOMAwGA1UECAwFVGV4YXMxEDAOBgNVBAcMB0hvdXN0b24xETAP\\n\" +\n-            \"BgNVBAoMCFNTTCBDb3JwMSswKQYDVQQDDCJTU0wuY29tIFNTTCBJbnRlcm1lZGlh\\n\" +\n-            \"dGUgQ0EgRUNDIFIyMB4XDTE5MDYyODEzNTgyN1oXDTIxMDYyNzEzNTgyN1owHjEc\\n\" +\n-            \"MBoGA1UEAwwTdGVzdC1kdi1lY2Muc3NsLmNvbTBZMBMGByqGSM49AgEGCCqGSM49\\n\" +\n-            \"AwEHA0IABJ5u0b8BID+8+TKxn+os0rdwvWB7mUJ4lcCthTADMhnr1VUWBbmBEelB\\n\" +\n-            \"666WbvbVXooPMUbhE5JvhXCTDyI7RRmjggNHMIIDQzAfBgNVHSMEGDAWgBQNdGYK\\n\" +\n-            \"Xp\/iLOzVwl0lBH91Mrr\/fTB7BggrBgEFBQcBAQRvMG0wSQYIKwYBBQUHMAKGPWh0\\n\" +\n-            \"dHA6Ly93d3cuc3NsLmNvbS9yZXBvc2l0b3J5L1NTTGNvbS1TdWJDQS1TU0wtRUND\\n\" +\n-            \"LTM4NC1SMi5jcnQwIAYIKwYBBQUHMAGGFGh0dHA6Ly9vY3Nwcy5zc2wuY29tMDcG\\n\" +\n-            \"A1UdEQQwMC6CE3Rlc3QtZHYtZWNjLnNzbC5jb22CF3d3dy50ZXN0LWR2LWVjYy5z\\n\" +\n-            \"c2wuY29tMFEGA1UdIARKMEgwCAYGZ4EMAQIBMDwGDCsGAQQBgqkwAQMBATAsMCoG\\n\" +\n-            \"CCsGAQUFBwIBFh5odHRwczovL3d3dy5zc2wuY29tL3JlcG9zaXRvcnkwHQYDVR0l\\n\" +\n-            \"BBYwFAYIKwYBBQUHAwIGCCsGAQUFBwMBMEQGA1UdHwQ9MDswOaA3oDWGM2h0dHA6\\n\" +\n-            \"Ly9jcmxzLnNzbC5jb20vU1NMY29tLVN1YkNBLVNTTC1FQ0MtMzg0LVIyLmNybDAd\\n\" +\n-            \"BgNVHQ4EFgQUGCTbprTbVmmNOgJjUgiHonbu8b8wDgYDVR0PAQH\/BAQDAgeAMIIB\\n\" +\n-            \"gQYKKwYBBAHWeQIEAgSCAXEEggFtAWsAdwCHdb\/nWXz4jEOZX73zbv9WjUdWNv9K\\n\" +\n-            \"tWDBtOr\/XqCDDwAAAWueaoEnAAAEAwBIMEYCIQCdy3N9w0pem1XShE\/rkVSpHxQb\\n\" +\n-            \"8QdUu3E6R+oncxOGXgIhAJoWg2gJYc9DWDl5ImnrqsmVS6OPgSQRvDsjRIN9gH7a\\n\" +\n-            \"AHcAu9nfvB+KcbWTlCOXqpJ7RzhXlQqrUugakJZkNo4e0YUAAAFrnmqArQAABAMA\\n\" +\n-            \"SDBGAiEAs2yfi9e1h6dTQbe4WPd7+5qf7kvP7Vr2k0nAtBS1IgECIQCQYL9he9J4\\n\" +\n-            \"Bh5cpQezTVPgLAOGcf5xIcCrBs1QJe66\/AB3AFWB1MIWkDYBSuoLm1c8U\/DA5Dh4\\n\" +\n-            \"cCUIFy+jqh0HE9MMAAABa55qgaEAAAQDAEgwRgIhAI\/27txsvzpbBXkMICi\/UOzE\\n\" +\n-            \"t8uZidbF9KSwmGRPT\/6gAiEAhm\/VeWHDeWK8gFMU+f0\/x4jK7UbzySGBvPzbPpNd\\n\" +\n-            \"EDwwCgYIKoZIzj0EAwMDaQAwZgIxAJKn8Hr68Z\/2rA+VHfZo8eeIFaZ3nvSvQO92\\n\" +\n-            \"1Byl6cPAm8DsdCnYT16uNSL8Zb5IQAIxAOFLsqPDCSAYkpgutAnVgwI+c549SIRU\\n\" +\n-            \"k8ol+wUx6zgMmt8VHYagyj6IO0GRDjm\/eA==\\n\" +\n-            \"-----END CERTIFICATE-----\";\n-\n-    \/\/ Owner: CN=revoked-ecc-dv.ssl.com\n-    \/\/ Issuer: CN=SSL.com SSL Intermediate CA ECC R2, O=SSL Corp, L=Houston, ST=Texas, C=US\n-    \/\/ Serial number: 423c2b57dfa379d0c45ffceb6284ed99\n-    \/\/ Valid from: Fri Jun 28 07:09:30 PDT 2019 until: Sun Jun 27 07:09:30 PDT 2021\n-    private static final String REVOKED = \"-----BEGIN CERTIFICATE-----\\n\" +\n-            \"MIIE+TCCBH+gAwIBAgIQQjwrV9+jedDEX\/zrYoTtmTAKBggqhkjOPQQDAzBvMQsw\\n\" +\n-            \"CQYDVQQGEwJVUzEOMAwGA1UECAwFVGV4YXMxEDAOBgNVBAcMB0hvdXN0b24xETAP\\n\" +\n-            \"BgNVBAoMCFNTTCBDb3JwMSswKQYDVQQDDCJTU0wuY29tIFNTTCBJbnRlcm1lZGlh\\n\" +\n-            \"dGUgQ0EgRUNDIFIyMB4XDTE5MDYyODE0MDkzMFoXDTIxMDYyNzE0MDkzMFowITEf\\n\" +\n-            \"MB0GA1UEAwwWcmV2b2tlZC1lY2MtZHYuc3NsLmNvbTBZMBMGByqGSM49AgEGCCqG\\n\" +\n-            \"SM49AwEHA0IABH4nWtnAwPIdcQOSNI72IJJ\/I1ZL2XQUAfa3ox5taFQQAalng6N9\\n\" +\n-            \"Od9t9de1vIMDzUvs5sMWw4YrqAlywFKMraajggNJMIIDRTAfBgNVHSMEGDAWgBQN\\n\" +\n-            \"dGYKXp\/iLOzVwl0lBH91Mrr\/fTB7BggrBgEFBQcBAQRvMG0wSQYIKwYBBQUHMAKG\\n\" +\n-            \"PWh0dHA6Ly93d3cuc3NsLmNvbS9yZXBvc2l0b3J5L1NTTGNvbS1TdWJDQS1TU0wt\\n\" +\n-            \"RUNDLTM4NC1SMi5jcnQwIAYIKwYBBQUHMAGGFGh0dHA6Ly9vY3Nwcy5zc2wuY29t\\n\" +\n-            \"MD0GA1UdEQQ2MDSCFnJldm9rZWQtZWNjLWR2LnNzbC5jb22CGnd3dy5yZXZva2Vk\\n\" +\n-            \"LWVjYy1kdi5zc2wuY29tMFEGA1UdIARKMEgwCAYGZ4EMAQIBMDwGDCsGAQQBgqkw\\n\" +\n-            \"AQMBATAsMCoGCCsGAQUFBwIBFh5odHRwczovL3d3dy5zc2wuY29tL3JlcG9zaXRv\\n\" +\n-            \"cnkwHQYDVR0lBBYwFAYIKwYBBQUHAwIGCCsGAQUFBwMBMEQGA1UdHwQ9MDswOaA3\\n\" +\n-            \"oDWGM2h0dHA6Ly9jcmxzLnNzbC5jb20vU1NMY29tLVN1YkNBLVNTTC1FQ0MtMzg0\\n\" +\n-            \"LVIyLmNybDAdBgNVHQ4EFgQUY7q+xN9nV1nPQ\/dJ5rUC8OKgaoMwDgYDVR0PAQH\/\\n\" +\n-            \"BAQDAgeAMIIBfQYKKwYBBAHWeQIEAgSCAW0EggFpAWcAdQBElGUusO7Or8RAB9io\\n\" +\n-            \"\/ijA2uaCvtjLMbU\/0zOWtbaBqAAAAWuedJ\/tAAAEAwBGMEQCIGPBF546Tn\/lzB22\\n\" +\n-            \"ICpFLOWOIyIOPwL9S4ikS8Vt1aFTAiBe8mp\/WCJnV7WxMIVWEUSLVOYn7erwyu6D\\n\" +\n-            \"hWNIST4W8wB2AG9Tdqwx8DEZ2JkApFEV\/3cVHBHZAsEAKQaNsgiaN9kTAAABa550\\n\" +\n-            \"oQEAAAQDAEcwRQIhAJ3nwLI7kLP2SKicFKuJoqRYKE\/FR2Ff65WL+iWxm\/6nAiAJ\\n\" +\n-            \"cd9EKnBETwM9qQfKoSSs2oTQL4QjSKJZi\/sPfKQaagB2ALvZ37wfinG1k5Qjl6qS\\n\" +\n-            \"e0c4V5UKq1LoGpCWZDaOHtGFAAABa550oH4AAAQDAEcwRQIhAIo6k5BMSFN3FnD4\\n\" +\n-            \"UFbyJJG\/Bujh+OFTYzVM8vuIBoU0AiAhBe+air4wHvd68ykK6xOPv9Qshje9F6LC\\n\" +\n-            \"gxTqbMOEkDAKBggqhkjOPQQDAwNoADBlAjEAyayBtbcCQB0fE+cCc7OHLuNvb9tl\\n\" +\n-            \"uiHWy\/Ika6IA72WJLLmED971ik08OMa2mGt4AjAklxdElQ5Z\/nSeJ2CNEwD7pcYz\\n\" +\n-            \"468kkrMoGU2lk3QmwcXZscPIoh4Pwew6QteY4J0=\\n\" +\n-            \"-----END CERTIFICATE-----\";\n-\n-    public void runTest(ValidatePathWithParams pathValidator, boolean ocspEnabled) throws Exception {\n-        \/\/ Validate valid\n-        pathValidator.validate(new String[]{VALID, INT},\n-                ValidatePathWithParams.Status.GOOD, null, System.out);\n+    public void runTest() throws Exception {\n+        ValidatePathWithURL validatePathWithURL = new ValidatePathWithURL(CA_ALIAS);\n@@ -485,4 +95,2 @@\n-        \/\/ Validate Revoked\n-        pathValidator.validate(new String[]{REVOKED, INT},\n-                ValidatePathWithParams.Status.REVOKED,\n-                \"Fri Jun 28 07:59:20 PDT 2019\", System.out);\n+        validatePathWithURL.validateDomain(VALID, false);\n+        validatePathWithURL.validateDomain(REVOKED, true);\n","filename":"test\/jdk\/security\/infra\/java\/security\/cert\/CertPathValidator\/certification\/SSLCA.java","additions":39,"deletions":431,"binary":false,"changes":470,"status":"modified"},{"patch":"@@ -25,1 +25,1 @@\n- * @test\n+ * @test id=OCSP\n@@ -28,1 +28,3 @@\n- * @build ValidatePathWithParams\n+ * @library \/test\/lib\n+ * @build jtreg.SkippedException\n+ * @build ValidatePathWithURL\n@@ -30,1 +32,0 @@\n- * @run main\/othervm -Djava.security.debug=certpath TWCAGlobalCA CRL\n@@ -34,7 +35,7 @@\n- * Obtain TLS test artifacts for TWCA Global Root CA from:\n- *\n- * Valid TLS Certificates:\n- * https:\/\/evssldemo6.twca.com.tw\n- *\n- * Revoked TLS Certificates:\n- * https:\/\/evssldemo7.twca.com.tw\n+ * @test id=CRL\n+ * @bug 8305975\n+ * @summary Interoperability tests with TWCA Global Root CA from TAIWAN-CA\n+ * @library \/test\/lib\n+ * @build jtreg.SkippedException\n+ * @build ValidatePathWithURL\n+ * @run main\/othervm -Djava.security.debug=certpath TWCAGlobalCA CRL\n@@ -42,38 +43,0 @@\n-public class TWCAGlobalCA {\n-\n-    \/\/ Owner: CN=TWCA Global EVSSL Certification Authority, OU=Global EVSSL Sub-CA, O=TAIWAN-CA, C=TW\n-    \/\/ Issuer: CN=TWCA Global Root CA, OU=Root CA, O=TAIWAN-CA, C=TW\n-    \/\/ Serial number: 40013304f70000000000000cc042cd6d\n-    \/\/ Valid from: Thu Aug 23 02:53:30 PDT 2012 until: Fri Aug 23 08:59:59 PDT 2030\n-    private static final String INT = \"-----BEGIN CERTIFICATE-----\\n\" +\n-            \"MIIFdzCCA1+gAwIBAgIQQAEzBPcAAAAAAAAMwELNbTANBgkqhkiG9w0BAQsFADBR\\n\" +\n-            \"MQswCQYDVQQGEwJUVzESMBAGA1UEChMJVEFJV0FOLUNBMRAwDgYDVQQLEwdSb290\\n\" +\n-            \"IENBMRwwGgYDVQQDExNUV0NBIEdsb2JhbCBSb290IENBMB4XDTEyMDgyMzA5NTMz\\n\" +\n-            \"MFoXDTMwMDgyMzE1NTk1OVowczELMAkGA1UEBhMCVFcxEjAQBgNVBAoTCVRBSVdB\\n\" +\n-            \"Ti1DQTEcMBoGA1UECxMTR2xvYmFsIEVWU1NMIFN1Yi1DQTEyMDAGA1UEAxMpVFdD\\n\" +\n-            \"QSBHbG9iYWwgRVZTU0wgQ2VydGlmaWNhdGlvbiBBdXRob3JpdHkwggEiMA0GCSqG\\n\" +\n-            \"SIb3DQEBAQUAA4IBDwAwggEKAoIBAQC7MIaeq4wMnTjA5C2LsR6HJUj6rZbs8Nmq\\n\" +\n-            \"sSqFoqu6LwjrMbzkAg274EL6913MQ6eOy6VUDRzqAfgBEYcwFofe\/w8nC7Q6Nrzz\\n\" +\n-            \"xTkl9lovXLJIm0CI44Qk2IhiCkoYaPlIoqexqnm3Fc2QRdRNeLk2pU\/s86DpGrwT\\n\" +\n-            \"BqRRRkziBlhcgo7K5Z9ihf+c82DT31iIUIi2nr0ES1eaRR7zpKrzJPZ8foNxRPwT\\n\" +\n-            \"2D0tJWQJ4hNzbFGSKsSzshdwQ\/p4JP9AEjK2eeXXbEePt0\/JarwBjO2Lwign38\/g\\n\" +\n-            \"0ZiP3uE47bItxZhgXlnR5L\/0bhJitE6U1xgVFbbrQnG2B2kZxVKxAgMBAAGjggEn\\n\" +\n-            \"MIIBIzAfBgNVHSMEGDAWgBRI283ejulJclqI6LHYPQezuWtmUDAdBgNVHQ4EFgQU\\n\" +\n-            \"br2hK87kwtUodFy92YxvBHIqBt4wDgYDVR0PAQH\/BAQDAgEGMDgGA1UdIAQxMC8w\\n\" +\n-            \"LQYEVR0gADAlMCMGCCsGAQUFBwIBFhdodHRwOi8vd3d3LnR3Y2EuY29tLnR3LzBJ\\n\" +\n-            \"BgNVHR8EQjBAMD6gPKA6hjhodHRwOi8vUm9vdENBLnR3Y2EuY29tLnR3L1RXQ0FS\\n\" +\n-            \"Q0EvZ2xvYmFsX3Jldm9rZV80MDk2LmNybDASBgNVHRMBAf8ECDAGAQH\/AgEAMDgG\\n\" +\n-            \"CCsGAQUFBwEBBCwwKjAoBggrBgEFBQcwAYYcaHR0cDovL1Jvb3RPY3NwLnR3Y2Eu\\n\" +\n-            \"Y29tLnR3LzANBgkqhkiG9w0BAQsFAAOCAgEAaOmLaZ2+WN2EtB6feuSV5KnL88ck\\n\" +\n-            \"I9jsUTB4YtKsv0ViORkeBMCQur5OoAgRE9VYdRVlWHN0zJAX232fdoZmnajl8gtj\\n\" +\n-            \"u0AOOyDDJ7Vlh38rDMRlX\/u+MS2DFcsq5Vd3EMwJsWWFR9D3Dcey+Tu9uEmEdqeB\\n\" +\n-            \"+Erd4YjCeV9PyOW3SzPQ47RdW6XYmHArPh65\/LcmSxTn\/lxQy\/NEBGGWqhm6s6n1\\n\" +\n-            \"49mPq4MtQcMLo\/NBI+8jv7BVjnThbbEh2edHHxMNiAd5kLZFDCyJuFkoezjWL4AH\\n\" +\n-            \"ratXdoHtqvqtPoy97LyGrLrJeh+0hkO9u8QOt2gF7BEhNfid7o5dnsPRk+8l77Hn\\n\" +\n-            \"T1dvBs++M0r0QG4AWMSMj9uUn6rhl4FGTvAsyB1fA8p\/xCLoIEetIpKRP3BD+ve2\\n\" +\n-            \"eYjWPorR\/0W77iMTeoQEeuxDIxi2J\/U9QLKKvzzqBy1TYrqqPe5YxqHLNAcfHZvo\\n\" +\n-            \"BTPPbtP0WAiXrJiELTYcqFXETvQcGw0XjoUZNvJE8RD7vssSNT17RKU8iBRX7CbL\\n\" +\n-            \"AB3T8gYykPMJTUqQSmdgEdVRBcqRMMdU+XRAEoU\/Mz5oHAkm3ZNTDNwsEp2Dg1\/b\\n\" +\n-            \"qzfPMhg4\/3\/YyWzGrzNeCSWZkjYImAzLCvN0D5rbdVHEmFIrEJt+igocGozroq5x\\n\" +\n-            \"DT5KhixlrqexzWE=\\n\" +\n-            \"-----END CERTIFICATE-----\";\n@@ -81,53 +44,1 @@\n-    \/\/ Owner: OID.2.5.4.17=100, STREET=\"10F.,NO.85,Yanping S. Rd.,Taipei City 100,Taiwan (R.O.C)\",\n-    \/\/ SERIALNUMBER=70759028, OID.1.3.6.1.4.1.311.60.2.1.3=TW, OID.1.3.6.1.4.1.311.60.2.1.2=Taiwan,\n-    \/\/ OID.1.3.6.1.4.1.311.60.2.1.1=Taipei, OID.2.5.4.15=Private Organization,\n-    \/\/ CN=evssldemo6.twca.com.tw, O=TAIWAN-CA INC., L=Taipei, ST=Taiwan, C=TW\n-    \/\/ Issuer: CN=TWCA Global EVSSL Certification Authority, OU=Global EVSSL Sub-CA,\n-    \/\/ O=TAIWAN-CA, C=TW\n-    \/\/ Serial number: 47e70000001258ff71d89af7f0353fef\n-    \/\/ Valid from: Thu Mar 02 00:49:56 PST 2023 until: Sun Mar 31 08:59:59 PDT 2024\n-    private static final String VALID = \"-----BEGIN CERTIFICATE-----\\n\" +\n-            \"MIIH7zCCBtegAwIBAgIQR+cAAAASWP9x2Jr38DU\/7zANBgkqhkiG9w0BAQsFADBz\\n\" +\n-            \"MQswCQYDVQQGEwJUVzESMBAGA1UEChMJVEFJV0FOLUNBMRwwGgYDVQQLExNHbG9i\\n\" +\n-            \"YWwgRVZTU0wgU3ViLUNBMTIwMAYDVQQDEylUV0NBIEdsb2JhbCBFVlNTTCBDZXJ0\\n\" +\n-            \"aWZpY2F0aW9uIEF1dGhvcml0eTAeFw0yMzAzMDIwODQ5NTZaFw0yNDAzMzExNTU5\\n\" +\n-            \"NTlaMIIBMzELMAkGA1UEBhMCVFcxDzANBgNVBAgTBlRhaXdhbjEPMA0GA1UEBxMG\\n\" +\n-            \"VGFpcGVpMRcwFQYDVQQKEw5UQUlXQU4tQ0EgSU5DLjEfMB0GA1UEAxMWZXZzc2xk\\n\" +\n-            \"ZW1vNi50d2NhLmNvbS50dzEdMBsGA1UEDxMUUHJpdmF0ZSBPcmdhbml6YXRpb24x\\n\" +\n-            \"FzAVBgsrBgEEAYI3PAIBARMGVGFpcGVpMRcwFQYLKwYBBAGCNzwCAQITBlRhaXdh\\n\" +\n-            \"bjETMBEGCysGAQQBgjc8AgEDEwJUVzERMA8GA1UEBRMINzA3NTkwMjgxQTA\/BgNV\\n\" +\n-            \"BAkTODEwRi4sTk8uODUsWWFucGluZyBTLiBSZC4sVGFpcGVpIENpdHkgMTAwLFRh\\n\" +\n-            \"aXdhbiAoUi5PLkMpMQwwCgYDVQQREwMxMDAwggEiMA0GCSqGSIb3DQEBAQUAA4IB\\n\" +\n-            \"DwAwggEKAoIBAQDEgj\/jtcAtGPkiBilLajzHIqfiAxpwwnKhdHwyOnqfcqur1p2R\\n\" +\n-            \"Cxl0Q8jYGmY8ZUq7716XnIGN3bn3Wu10BvmHi07h8f54\/G\/K7xBKjkasAh44zW1P\\n\" +\n-            \"hgdaxH0huRvoQOoSRCitew8YpMN4B++uOQ8yu2pWDGDdQHW4VaWt\/e+QtZbQtp\/b\\n\" +\n-            \"7vUWgcuhxDStj97B8Dcb5PY+sbLy6dfDiXnTaSpuWhjKmEcpknagGyn4uCFBSppZ\\n\" +\n-            \"\/PYcTsg+Nk8Ae\/SDMpc7XWBCjmxMG2GI0IVW4un9UOuElYgWVjMWnBAiGMDkVMEQ\\n\" +\n-            \"jLRxEYOh+NJ3izMyD\/ufLrA\/YwJMI1LgFcOJAgMBAAGjggO7MIIDtzAfBgNVHSME\\n\" +\n-            \"GDAWgBRuvaErzuTC1Sh0XL3ZjG8EcioG3jAdBgNVHQ4EFgQUg4msPcTFvDjwluRf\\n\" +\n-            \"inEn9qMC7OYwUwYDVR0fBEwwSjBIoEagRIZCaHR0cDovL3NzbHNlcnZlci50d2Nh\\n\" +\n-            \"LmNvbS50dy9zc2xzZXJ2ZXIvR2xvYmFsRVZTU0xfUmV2b2tlXzIwMTIuY3JsMCEG\\n\" +\n-            \"A1UdEQQaMBiCFmV2c3NsZGVtbzYudHdjYS5jb20udHcwfwYIKwYBBQUHAQEEczBx\\n\" +\n-            \"MEQGCCsGAQUFBzAChjhodHRwOi8vc3Nsc2VydmVyLnR3Y2EuY29tLnR3L2NhY2Vy\\n\" +\n-            \"dC9HbG9iYWxFdnNzbF8yMDEyLnA3YjApBggrBgEFBQcwAYYdaHR0cDovL2V2c3Ns\\n\" +\n-            \"b2NzcC50d2NhLmNvbS50dy8wSAYDVR0gBEEwPzA0BgwrBgEEAYK\/JQEBFgMwJDAi\\n\" +\n-            \"BggrBgEFBQcCARYWaHR0cDovL3d3dy50d2NhLmNvbS50dzAHBgVngQwBATAJBgNV\\n\" +\n-            \"HRMEAjAAMA4GA1UdDwEB\/wQEAwIFoDAdBgNVHSUEFjAUBggrBgEFBQcDAQYIKwYB\\n\" +\n-            \"BQUHAwIwggH2BgorBgEEAdZ5AgQCBIIB5gSCAeIB4AB2AEiw42vapkc0D+VqAvqd\\n\" +\n-            \"MOscUgHLVt0sgdm7v6s52IRzAAABhqGDiCYAAAQDAEcwRQIgd7uqvHdSTSXqNPWs\\n\" +\n-            \"OQeCeT2vuKY3vj8jRcoJ9IIohqgCIQCtQfZ0lfZ1Y1GmwCTDc5NM++5mgp+ZpNWu\\n\" +\n-            \"F9OKsWoCPQB2AFWB1MIWkDYBSuoLm1c8U\/DA5Dh4cCUIFy+jqh0HE9MMAAABhqGD\\n\" +\n-            \"iJYAAAQDAEcwRQIgIHKa+XeYyDURUq9AVYEntGS5oJitKyWZjSOlpD+udZgCIQC\/\\n\" +\n-            \"oVPtjJpcXP4OScYFsNWMPKUtZOO5mY5y7V65S84DrQB2ADtTd3U+LbmAToswWwb+\\n\" +\n-            \"QDtn2E\/D9Me9AA0tcm\/h+tQXAAABhqGDh8YAAAQDAEcwRQIgYT7aPr9YCtF5TCTp\\n\" +\n-            \"NICK9c5eiL6Ku\/y9wM6ARgG2k1UCIQDomqlwGur+AMI4YIc1SNqyNVCyxgP1DxXP\\n\" +\n-            \"FYkX6BX17gB2AO7N0GTV2xrOxVy3nbTNE6Iyh0Z8vOzew1FIWUZxH7WbAAABhqGD\\n\" +\n-            \"iKkAAAQDAEcwRQIhAKTMliyTn48vvP9hN8jucD6rGZwRCqQI6suE6ADpN7bNAiB3\\n\" +\n-            \"zFZFdH8eJRn3RXjD\/mzbmF201sNLitp9SOYAazubljANBgkqhkiG9w0BAQsFAAOC\\n\" +\n-            \"AQEAOOtzqtRFvxlJro61O0dEkDottToFh88vib3N3AofS5uW0nDpoS0L27XR8IDd\\n\" +\n-            \"2NfN+2XKAQXdz2BqHnjW1nAMXUx4TAMi4jG8XpOkvpSDXbjghD5EB10FyAzCuGmv\\n\" +\n-            \"mKxkVOU1DzL0kSLLQjLaJ57WUYsoE97f5O6rY9jlJpid32o1WgM1oZsBjPhO8Kiy\\n\" +\n-            \"KJ5zZHppolGPtuFYMUcatiqv\/\/pH\/5piwtlYSkbwMj5nYidSrSBciBzO53HFk1pE\\n\" +\n-            \"TABXFcoK3gmhWM04lysmJMwAzRUbNQVizpGDICbRjCOVnwCbutnSnka8pDHkq4Zy\\n\" +\n-            \"BrUeZe2xJe8jWvukwqvNzIIvwg==\\n\" +\n-            \"-----END CERTIFICATE-----\";\n+public class TWCAGlobalCA {\n@@ -135,50 +46,3 @@\n-    \/\/ Owner: OID.2.5.4.17=100, STREET=\"10F.,NO.85,Yanping S. Rd.,Taipei City 100,Taiwan (R.O.C)\",\n-    \/\/ SERIALNUMBER=70759028, OID.1.3.6.1.4.1.311.60.2.1.3=TW, OID.1.3.6.1.4.1.311.60.2.1.2=Taiwan,\n-    \/\/ OID.1.3.6.1.4.1.311.60.2.1.1=Taipei, OID.2.5.4.15=Private Organization,\n-    \/\/ CN=evssldemo7.twca.com.tw, O=TAIWAN-CA INC., L=Taipei, ST=Taiwan, C=TW\n-    \/\/ Issuer: CN=TWCA Global EVSSL Certification Authority, OU=Global EVSSL Sub-CA,\n-    \/\/ O=TAIWAN-CA, C=TW\n-    \/\/ Serial number: 47e70000001258f036a5b513091ccb2e\n-    \/\/ Valid from: Tue Feb 07 02:03:08 PST 2023 until: Thu Mar 07 07:59:59 PST 2024\n-    private static final String REVOKED = \"-----BEGIN CERTIFICATE-----\\n\" +\n-            \"MIIHdjCCBl6gAwIBAgIQR+cAAAASWPA2pbUTCRzLLjANBgkqhkiG9w0BAQsFADBz\\n\" +\n-            \"MQswCQYDVQQGEwJUVzESMBAGA1UEChMJVEFJV0FOLUNBMRwwGgYDVQQLExNHbG9i\\n\" +\n-            \"YWwgRVZTU0wgU3ViLUNBMTIwMAYDVQQDEylUV0NBIEdsb2JhbCBFVlNTTCBDZXJ0\\n\" +\n-            \"aWZpY2F0aW9uIEF1dGhvcml0eTAeFw0yMzAyMDcxMDAzMDhaFw0yNDAzMDcxNTU5\\n\" +\n-            \"NTlaMIIBMzELMAkGA1UEBhMCVFcxDzANBgNVBAgTBlRhaXdhbjEPMA0GA1UEBxMG\\n\" +\n-            \"VGFpcGVpMRcwFQYDVQQKEw5UQUlXQU4tQ0EgSU5DLjEfMB0GA1UEAxMWZXZzc2xk\\n\" +\n-            \"ZW1vNy50d2NhLmNvbS50dzEdMBsGA1UEDxMUUHJpdmF0ZSBPcmdhbml6YXRpb24x\\n\" +\n-            \"FzAVBgsrBgEEAYI3PAIBARMGVGFpcGVpMRcwFQYLKwYBBAGCNzwCAQITBlRhaXdh\\n\" +\n-            \"bjETMBEGCysGAQQBgjc8AgEDEwJUVzERMA8GA1UEBRMINzA3NTkwMjgxQTA\/BgNV\\n\" +\n-            \"BAkTODEwRi4sTk8uODUsWWFucGluZyBTLiBSZC4sVGFpcGVpIENpdHkgMTAwLFRh\\n\" +\n-            \"aXdhbiAoUi5PLkMpMQwwCgYDVQQREwMxMDAwggEiMA0GCSqGSIb3DQEBAQUAA4IB\\n\" +\n-            \"DwAwggEKAoIBAQDSX3co7XUdwxv8OEj7Mipq0Ot+1w+VYTFlPvdnryrv9st7ERLb\\n\" +\n-            \"+xJPJo7swgqbHeHKWlwYu4lkzJq6s3nAOkuYIP\/O3uVmGDiilLSAVkukz9MooyjB\\n\" +\n-            \"466eArXY1VT9vpXVNmSLunAp5RU8H+2WWOUMmtJx\/oYojqEbtWqnltlErvEjb2TM\\n\" +\n-            \"vR16d\/vXI6QtMc+IV3nZ0SVdetH2E7ZvpP5mZqVSHNnOnVjqdd69hAJ4SJgG9lCM\\n\" +\n-            \"87ysm6UaJxQbEGxc6YkwrUNVet1tx2hBWltTyRw3oOBCBUwrPUTx7\/pFh7yhci6p\\n\" +\n-            \"AhHp1j0OzAmZHOFTM+qO1L1vlmguO8zW0zWtAgMBAAGjggNCMIIDPjAfBgNVHSME\\n\" +\n-            \"GDAWgBRuvaErzuTC1Sh0XL3ZjG8EcioG3jAdBgNVHQ4EFgQUvvbgZHRNPdmGlxQS\\n\" +\n-            \"fcTzM2A14EkwUwYDVR0fBEwwSjBIoEagRIZCaHR0cDovL3NzbHNlcnZlci50d2Nh\\n\" +\n-            \"LmNvbS50dy9zc2xzZXJ2ZXIvR2xvYmFsRVZTU0xfUmV2b2tlXzIwMTIuY3JsMCEG\\n\" +\n-            \"A1UdEQQaMBiCFmV2c3NsZGVtbzcudHdjYS5jb20udHcwfwYIKwYBBQUHAQEEczBx\\n\" +\n-            \"MEQGCCsGAQUFBzAChjhodHRwOi8vc3Nsc2VydmVyLnR3Y2EuY29tLnR3L2NhY2Vy\\n\" +\n-            \"dC9HbG9iYWxFdnNzbF8yMDEyLnA3YjApBggrBgEFBQcwAYYdaHR0cDovL2V2c3Ns\\n\" +\n-            \"b2NzcC50d2NhLmNvbS50dy8wSAYDVR0gBEEwPzA0BgwrBgEEAYK\/JQEBFgMwJDAi\\n\" +\n-            \"BggrBgEFBQcCARYWaHR0cDovL3d3dy50d2NhLmNvbS50dzAHBgVngQwBATAJBgNV\\n\" +\n-            \"HRMEAjAAMA4GA1UdDwEB\/wQEAwIFoDAdBgNVHSUEFjAUBggrBgEFBQcDAQYIKwYB\\n\" +\n-            \"BQUHAwIwggF9BgorBgEEAdZ5AgQCBIIBbQSCAWkBZwB2AFWB1MIWkDYBSuoLm1c8\\n\" +\n-            \"U\/DA5Dh4cCUIFy+jqh0HE9MMAAABhitUR1YAAAQDAEcwRQIhANv7DhQm67R1Ilmg\\n\" +\n-            \"k5StrFQ1dqyELzZTAT3on84g0G\/vAiAttP+EWWmztK2luQ7SxvQsmExDh\/qGiZHq\\n\" +\n-            \"NAd2a8dUIgB1AO7N0GTV2xrOxVy3nbTNE6Iyh0Z8vOzew1FIWUZxH7WbAAABhitU\\n\" +\n-            \"RycAAAQDAEYwRAIgcU5n4DJaGWvTr3wZug59ItynMgCZ5z0ZVrZr2KwV70wCIHEv\\n\" +\n-            \"DAwNBLGsdj5IX\/4E5hnzJvS7WroSLnRB6OW931JbAHYAdv+IPwq2+5VRwmHM9Ye6\\n\" +\n-            \"NLSkzbsp3GhCCp\/mZ0xaOnQAAAGGK1RKDwAABAMARzBFAiBvlIvOnE8PhYJQueMh\\n\" +\n-            \"AOCwgREvnAsk3Edt59lcuqPrrQIhAOSRb3UmBYkHQ6k5pUJva0Mgk0GmnLR0de0s\\n\" +\n-            \"VxW3TTASMA0GCSqGSIb3DQEBCwUAA4IBAQAQB7oaouXBI6VpLzL+kzOZXSTbSClv\\n\" +\n-            \"LS33DTEBI3A8LTXHbFq6c4\/ZdqieUzy42Kd0i9e3hI1hwQYPgEwxpROOcldX72r0\\n\" +\n-            \"EUTh0L+XrxN3YEgod6aCsjIiJlWYy6J2ZXVURnk\/iWYAwYLa0JmmBGuWFjEnq4lO\\n\" +\n-            \"xL1C3M2mYAEC+Beb7Xyq1rcu97p4P8igJYM+VfwXNwYYRCXUr9f4ESD7t5vXlYoE\\n\" +\n-            \"c4m5KiBQD9XtZS77QRon9JCQklxTvMkxuLwWvSdzicEUzWeFp+kN\/fcXL2SVsb17\\n\" +\n-            \"xDPMMsMMh7L\/f+uMWDYZ+wH17LYQxOLi7VXT3fv8nl2X2iD3d4CCh0Tu\\n\" +\n-            \"-----END CERTIFICATE-----\";\n+    private static final String VALID = \"https:\/\/evssldemo6.twca.com.tw\";\n+    private static final String REVOKED = \"https:\/\/evssldemo7.twca.com.tw\";\n+    private static final String CA_ALIAS = \"twcaglobalrootca [jdk]\";\n@@ -188,2 +52,0 @@\n-        ValidatePathWithParams pathValidator = new ValidatePathWithParams(null);\n-\n@@ -191,1 +53,1 @@\n-            pathValidator.enableCRLCheck();\n+            ValidatePathWithURL.enableCRLOnly();\n@@ -194,1 +56,1 @@\n-            pathValidator.enableOCSPCheck();\n+            ValidatePathWithURL.enableOCSPOnly();\n@@ -197,3 +59,1 @@\n-        \/\/ Validate valid\n-        pathValidator.validate(new String[]{VALID, INT},\n-                ValidatePathWithParams.Status.GOOD, null, System.out);\n+        ValidatePathWithURL validatePathWithURL = new ValidatePathWithURL(CA_ALIAS);\n@@ -201,4 +61,2 @@\n-        \/\/ Validate Revoked\n-        pathValidator.validate(new String[]{REVOKED, INT},\n-                ValidatePathWithParams.Status.REVOKED,\n-                \"Thu Mar 23 17:30:19 PDT 2023\", System.out);\n+        validatePathWithURL.validateDomain(VALID, false);\n+        validatePathWithURL.validateDomain(REVOKED, true);\n","filename":"test\/jdk\/security\/infra\/java\/security\/cert\/CertPathValidator\/certification\/TWCAGlobalCA.java","additions":20,"deletions":162,"binary":false,"changes":182,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2018, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2018, 2023, Oracle and\/or its affiliates. All rights reserved.\n@@ -25,1 +25,1 @@\n- * @test\n+ * @test id=OCSP\n@@ -27,4 +27,5 @@\n- * @summary Interoperability tests with TeliaSonera Root CA v1\n- * @build ValidatePathWithParams\n- * @run main\/othervm -Djava.security.debug=certpath TeliaSoneraCA OCSP\n- * @run main\/othervm -Djava.security.debug=certpath TeliaSoneraCA CRL\n+ * @summary Interoperability tests with TeliaSonera Root CA v1 using OCSP\n+ * @library \/test\/lib\n+ * @build jtreg.SkippedException\n+ * @build ValidatePathWithURL\n+ * @run main\/othervm TeliaSoneraCA OCSP\n@@ -34,7 +35,7 @@\n- * Obtain TLS test artifacts for TeliaSonera Root CA v1 from:\n- *\n- * Valid TLS Certificates:\n- * https:\/\/juolukka.cover.sonera.net:10443\/\n- *\n- * Revoked TLS Certificates:\n- * https:\/\/juolukka.cover.sonera.net:10444\/\n+ * @test id=CRL\n+ * @bug 8210432\n+ * @summary Interoperability tests with TeliaSonera Root CA v1 using CRL\n+ * @library \/test\/lib\n+ * @build jtreg.SkippedException\n+ * @build ValidatePathWithURL\n+ * @run main\/othervm TeliaSoneraCA CRL\n@@ -42,1 +43,0 @@\n-public class TeliaSoneraCA {\n@@ -44,89 +44,1 @@\n-    \/\/ Owner: CN=TeliaSonera Server CA v2, O=TeliaSonera, C=FI\n-    \/\/ Issuer: CN=TeliaSonera Root CA v1, O=TeliaSonera\n-    private static final String INT = \"-----BEGIN CERTIFICATE-----\\n\"\n-            + \"MIIHHjCCBQagAwIBAgIQTEYq9tv794BPhMF8\/qlytjANBgkqhkiG9w0BAQsFADA3\\n\"\n-            + \"MRQwEgYDVQQKDAtUZWxpYVNvbmVyYTEfMB0GA1UEAwwWVGVsaWFTb25lcmEgUm9v\\n\"\n-            + \"dCBDQSB2MTAeFw0xNDEwMTYwODA5NTdaFw0zMjEwMTYwNTA0MDBaMEYxCzAJBgNV\\n\"\n-            + \"BAYTAkZJMRQwEgYDVQQKDAtUZWxpYVNvbmVyYTEhMB8GA1UEAwwYVGVsaWFTb25l\\n\"\n-            + \"cmEgU2VydmVyIENBIHYyMIICIjANBgkqhkiG9w0BAQEFAAOCAg8AMIICCgKCAgEA\\n\"\n-            + \"rwQN5rfRLbVAiYWLJF9SI4YLm8oqrtf8OjGybgoLyiMIo8nhY\/atuGRFWCQNOnUK\\n\"\n-            + \"caZn29C360PlC5yYrsrSHuouROisqHSJcgA7HvV+37Rcry7daeDj6rfyx4yI5dmj\\n\"\n-            + \"LwHkK0j1NzhX1JxFDgPeLNuebgzv\/j8OfRhYK\/BttpystC4Zgm3gZheKDjYsDS5D\\n\"\n-            + \"gjffuOysP3vewrcuw0EIZFx+HawuwNBLq4tMf4VSitYDHJSLIM2TeXZGGY5slTbT\\n\"\n-            + \"yLnrU5mIzG9WKqxyy7qHuFw1JtlAXkCLmUEVaF9M+dRPiGIjlDrpBgbDD9mT2CSk\\n\"\n-            + \"V\/XG1696\/voY5xB8KNIC1cOSmSO7kdJyR5tWiDIJiwMXrTwG+kZiqlbcKDsZeJ9p\\n\"\n-            + \"5bZxXO0pEpde3wgEYRvFr5Cx4vcz4h5pom9coJOCW9tqXU43KcueTrt4Ks9f92q1\\n\"\n-            + \"ehjyEnCh0BCdrjUOXsUtFosm9qxJnDwVlThYhS9EHuCTNBgj1Yxj6A+8fwwJP9DN\\n\"\n-            + \"CbWQx5afT+h+9FNDNRC\/nEcesP1Yh9s15Se270pQW0CejUNziYG7Dft7T+PVH\/fU\\n\"\n-            + \"zaWU8g0tJjtuQgiCWVqw4WkUmYY2S0R89zAotcpz2mvNO8ma2iJbubHi3c0ULfHH\\n\"\n-            + \"nkWKsdpzZmK4N0Wi6\/V5yWdmL5RFkFecL8r7+9OtCB0CAwEAAaOCAhUwggIRMIGK\\n\"\n-            + \"BggrBgEFBQcBAQR+MHwwLQYIKwYBBQUHMAGGIWh0dHA6Ly9vY3NwLnRydXN0LnRl\\n\"\n-            + \"bGlhc29uZXJhLmNvbTBLBggrBgEFBQcwAoY\/aHR0cDovL3JlcG9zaXRvcnkudHJ1\\n\"\n-            + \"c3QudGVsaWFzb25lcmEuY29tL3RlbGlhc29uZXJhcm9vdGNhdjEuY2VyMBIGA1Ud\\n\"\n-            + \"EwEB\/wQIMAYBAf8CAQAwVQYDVR0gBE4wTDBKBgwrBgEEAYIPAgMBAQIwOjA4Bggr\\n\"\n-            + \"BgEFBQcCARYsaHR0cHM6Ly9yZXBvc2l0b3J5LnRydXN0LnRlbGlhc29uZXJhLmNv\\n\"\n-            + \"bS9DUFMwDgYDVR0PAQH\/BAQDAgEGMIHGBgNVHR8Egb4wgbswQKA+oDyGOmh0dHA6\\n\"\n-            + \"Ly9jcmwtMy50cnVzdC50ZWxpYXNvbmVyYS5jb20vdGVsaWFzb25lcmFyb290Y2F2\\n\"\n-            + \"MS5jcmwwd6B1oHOGcWxkYXA6Ly9jcmwtMS50cnVzdC50ZWxpYXNvbmVyYS5jb20v\\n\"\n-            + \"Y249VGVsaWFTb25lcmElMjBSb290JTIwQ0ElMjB2MSxvPVRlbGlhU29uZXJhP2Nl\\n\"\n-            + \"cnRpZmljYXRlcmV2b2NhdGlvbmxpc3Q7YmluYXJ5MB0GA1UdDgQWBBQvSTwpT9cH\\n\"\n-            + \"JfnGjNVk9WY9EoMilTAfBgNVHSMEGDAWgBTwj1k4ALP1j5qWDNXr+nuqF+gTEjAN\\n\"\n-            + \"BgkqhkiG9w0BAQsFAAOCAgEAg9EVFW6ioZ2ctrX8KqvW9XPYZR01yNgqlO7pwBWf\\n\"\n-            + \"HzuBCbUdyVzumfQnU24Sce92oMtEfyuxIOmhvoXU7LpnYlH3Q29UGP5dL0D3edGz\\n\"\n-            + \"HeU6Tf8bkcOEHtnTrkd+y+rfFSDWYl9r1y993NAcrBHhroQCE53mlrO7TjXa3zDq\\n\"\n-            + \"6LGR8T8VgvGw0IBz6mzAks0wMYB0b4uREPmWXi+m+RqG3lnpl+eBzz6YVLkxIYMq\\n\"\n-            + \"QIXJIBsu4\/ybmadsfdql6E8Lo3dKVD4UG10mtd+iPbJiBiW\/a9VbEe3NVKIv4H2y\\n\"\n-            + \"HqYcxDXAeUI66E3K2cjCmKoQaa0Ywt02ikZFd0v1OWNPS7YWbEJWkVR1PcPMESK9\\n\"\n-            + \"6HKI4xhG2tJesmXjQ8q8aSx2u79Zts3ewjKqTmurf6FXW3u9TpSCUe6Drr\/3X7Ve\\n\"\n-            + \"nBy4M0sLwCecD\/L9gjTa+EItQTYzCkpxiMO49tQdX\/BpwgWju4Kg3qkaBNTzvSlk\\n\"\n-            + \"gdnRJqCUkVuzwK4yBqUoyRz3prlhvvRGdZJKf6IXRDhncpey5pm0PQYQ4cArx7Go\\n\"\n-            + \"AaAKz0ZTHOKjnM2KIdUhBJQybL7oPklSfkeMWoUoYED6R4YMTt\/JXX4ixEb5DgDJ\\n\"\n-            + \"0F+bNcF7qGrJTkTx0Ccy4BuuY05hJckd72E7WdmjN7DDeosghgWZNV\/6D7N5tfxo\\n\"\n-            + \"nlU=\\n\"\n-            + \"-----END CERTIFICATE-----\";\n-\n-    \/\/ Owner: CN=juolukka.cover.sonera.net, OU=security, O=Telia Finland Oyj, L=helsinki, C=FI\n-    \/\/ Issuer: CN=TeliaSonera Server CA v2, O=TeliaSonera, C=FI\n-    private static final String VALID = \"-----BEGIN CERTIFICATE-----\\n\" +\n-            \"MIIHiDCCBXCgAwIBAgIPAWOq14hk136UDQY3WSjLMA0GCSqGSIb3DQEBCwUAMEYx\\n\" +\n-            \"CzAJBgNVBAYTAkZJMRQwEgYDVQQKDAtUZWxpYVNvbmVyYTEhMB8GA1UEAwwYVGVs\\n\" +\n-            \"aWFTb25lcmEgU2VydmVyIENBIHYyMB4XDTE4MDUyOTA3NDA0MVoXDTE5MDUyOTA3\\n\" +\n-            \"NDA0MVowczELMAkGA1UEBhMCRkkxETAPBgNVBAcMCGhlbHNpbmtpMRowGAYDVQQK\\n\" +\n-            \"DBFUZWxpYSBGaW5sYW5kIE95ajERMA8GA1UECwwIc2VjdXJpdHkxIjAgBgNVBAMM\\n\" +\n-            \"GWp1b2x1a2thLmNvdmVyLnNvbmVyYS5uZXQwggEiMA0GCSqGSIb3DQEBAQUAA4IB\\n\" +\n-            \"DwAwggEKAoIBAQDLks9F8ZUqV9G4jn3fY234OX09Dmqqtuk0qAmjWpF0JAn2o64t\\n\" +\n-            \"whVxFLx9e2IwUPTQgyo6FwRsiT19m99BhgxYnJOxVRwURxSL3mqlV9gX4oFMmT4O\\n\" +\n-            \"EOYEjaJXi8ne1pJX80y2hVQ48XqgODnKdKZVwa5YoeWZQJiaq+C5JkMDN8qzpiyQ\\n\" +\n-            \"X3EfJspLkKy2E+UVxWmfnyf0v70ES9TQ8qgxwvsf7LRZ8Jixq7TTO5VbqWsdBvJC\\n\" +\n-            \"9Zm2aBOYJ7ptSZQ5YDfeUJG2c9S\/zFmngoPnTrvAZwUeU3YTrbdZQy899ZOatWac\\n\" +\n-            \"6lHUYU2EagEmbj\/jtIvJ6wMbzhleIXRQFWibAgMBAAGjggNEMIIDQDAfBgNVHSME\\n\" +\n-            \"GDAWgBQvSTwpT9cHJfnGjNVk9WY9EoMilTAdBgNVHQ4EFgQUbMozh4osL4gFJvb5\\n\" +\n-            \"baELpQSKEhIwDgYDVR0PAQH\/BAQDAgSwME4GA1UdIARHMEUwQwYGZ4EMAQICMDkw\\n\" +\n-            \"NwYIKwYBBQUHAgEWK2h0dHA6Ly9yZXBvc2l0b3J5LnRydXN0LnRlbGlhc29uZXJh\\n\" +\n-            \"LmNvbS9DUFMwJAYDVR0RBB0wG4IZanVvbHVra2EuY292ZXIuc29uZXJhLm5ldDBN\\n\" +\n-            \"BgNVHR8ERjBEMEKgQKA+hjxodHRwOi8vY3JsLTMudHJ1c3QudGVsaWFzb25lcmEu\\n\" +\n-            \"Y29tL3RlbGlhc29uZXJhc2VydmVyY2F2Mi5jcmwwHQYDVR0lBBYwFAYIKwYBBQUH\\n\" +\n-            \"AwIGCCsGAQUFBwMBMIGGBggrBgEFBQcBAQR6MHgwJwYIKwYBBQUHMAGGG2h0dHA6\\n\" +\n-            \"Ly9vY3NwLnRydXN0LnRlbGlhLmNvbTBNBggrBgEFBQcwAoZBaHR0cDovL3JlcG9z\\n\" +\n-            \"aXRvcnkudHJ1c3QudGVsaWFzb25lcmEuY29tL3RlbGlhc29uZXJhc2VydmVyY2F2\\n\" +\n-            \"Mi5jZXIwggF\/BgorBgEEAdZ5AgQCBIIBbwSCAWsBaQB2AG9Tdqwx8DEZ2JkApFEV\\n\" +\n-            \"\/3cVHBHZAsEAKQaNsgiaN9kTAAABY6rXpS0AAAQDAEcwRQIgfMLEFYxQcncL3am\/\\n\" +\n-            \"W2x7DMZ1+Vh1tDLw\/0qIQB40VBQCIQC1eyF8Q6CcQs+gIgzpy7OiZSosSlykyOgW\\n\" +\n-            \"qHkj\/0UPygB3AO5Lvbd1zmC64UJpH6vhnmajD35fsHLYgwDEe4l6qP3LAAABY6rX\\n\" +\n-            \"pLEAAAQDAEgwRgIhAJxveFVsFrfttSJIxHsMPAvvevptaV2CxsGwubAi8wDDAiEA\\n\" +\n-            \"jNbbYfUiYtmQ5v4yc6T+GcixztNIlMzQ7OTK+u9zqSoAdgBVgdTCFpA2AUrqC5tX\\n\" +\n-            \"PFPwwOQ4eHAlCBcvo6odBxPTDAAAAWOq16YXAAAEAwBHMEUCIQCCkCL2zn\/AoMVI\\n\" +\n-            \"BdsoJelUBLsAnQ+GlIafiyZYcCwhBAIgdsFM05eNmL5hfn3+WtfgmipwcK1qp7kO\\n\" +\n-            \"ONzO69aqrnEwDQYJKoZIhvcNAQELBQADggIBAIl5UWSwCXF85+2lU6t89K7I4TvZ\\n\" +\n-            \"Ggof0NLngea9qxBq00opfnl9i2LPRnsjh9s3iA29i2daTEuJn3qt3Ygcm27Jd7WM\\n\" +\n-            \"5StcxQ483GAaL5s5m2QqkZB8eLfez3tIyCMGCAyixBDNRNPVI4xZr6sSOenWtipo\\n\" +\n-            \"gMt+\/gvRIMdMT79IXPFz4W9RWCwnfJNOlfH2OkS3KZYaPSaEvs6sfMW1DDZosrBy\\n\" +\n-            \"6F+DITPLllOVSE4+PTxvXLKVy+srFwF1VocQXKkWMHQ7AfWNnOGzb7B1qg7gsw0n\\n\" +\n-            \"axqinyCjkhMpHpcVtmD9Pi15HLFDIy9yI2S+FHJQfhUSmM\/LdCWzQpnee6\/Wo+uw\\n\" +\n-            \"p0Jg2v6v9GGaqfpuiVJPFN9dOv3OjMU7DL5lgMRWFRo2T8+wBHXDyBhT0W0y5kRJ\\n\" +\n-            \"eWA7t6CnkziHuaOihZAHUH3nn5exjqUFVS0ThbF6hxN7HAlq\/xIbTKlZjkLlc14W\\n\" +\n-            \"fB8vkxJyy\/tgBZ4dCj9Y1Y32d4eFT5JZJgqgkN59SmX56BswNXncGrk\/vWZFFx+g\\n\" +\n-            \"9dgb8QSe8KseD1iSLc7SsqVDv8NPYdaI3eZ90W8Wv0\/CDls321O6UbAmURzQwFGB\\n\" +\n-            \"w8WnteoVBi6Wf6M1TxIfJsXBYeIN0BB6AYc8cmZIOtx2C8aH4JJT45MyFnBv3ac5\\n\" +\n-            \"Ahs9pGn\/+K+5yb2e\\n\" +\n-            \"-----END CERTIFICATE-----\";\n+public class TeliaSoneraCA {\n@@ -134,37 +46,3 @@\n-    \/\/ Owner: CN=juolukka.cover.sonera.net, OU=Security, O=TeliaSonera Finland, L=Helsinki, C=FI\n-    \/\/ Issuer: CN=TeliaSonera Server CA v2, O=TeliaSonera, C=FI\n-    private static final String REVOKED = \"-----BEGIN CERTIFICATE-----\\n\" +\n-            \"MIIGEDCCA\/igAwIBAgIRAKWJTjs6v04ZTyb2wJxfnJswDQYJKoZIhvcNAQELBQAw\\n\" +\n-            \"RjELMAkGA1UEBhMCRkkxFDASBgNVBAoMC1RlbGlhU29uZXJhMSEwHwYDVQQDDBhU\\n\" +\n-            \"ZWxpYVNvbmVyYSBTZXJ2ZXIgQ0EgdjIwHhcNMTYxMjIzMDcwMTQ2WhcNMTkxMjIz\\n\" +\n-            \"MDcwMTQ2WjB1MQswCQYDVQQGEwJGSTERMA8GA1UEBwwISGVsc2lua2kxHDAaBgNV\\n\" +\n-            \"BAoME1RlbGlhU29uZXJhIEZpbmxhbmQxETAPBgNVBAsMCFNlY3VyaXR5MSIwIAYD\\n\" +\n-            \"VQQDDBlqdW9sdWtrYS5jb3Zlci5zb25lcmEubmV0MIIBIjANBgkqhkiG9w0BAQEF\\n\" +\n-            \"AAOCAQ8AMIIBCgKCAQEAt2u92TgTFdm1OEfmWFPe+ESBi+2ox4y1EDoin8RydMyO\\n\" +\n-            \"DI6+0HHnKfDZa1YViI5b6MLJKWIAyUszAg5hc0S3upElfSsBvUW6zuQTxMi2vTYE\\n\" +\n-            \"4tcqwIEyCUaiv4wC+DuO5CyGR32yR6HB\/W5Ny200dPs2SO03ESEJ+LH4Tw5AI8JJ\\n\" +\n-            \"UZHW+lA+yUHnlc3q47svpbspjt0C\/THyukd1hbXTBB0mPXqPux+ClvtZBWUJb7ti\\n\" +\n-            \"1cPfcCNd79KRObzcgxqcOIaUFz4LjjKezhzVSL7tJOANOHZ09qDeOAkk\/X9POx4h\\n\" +\n-            \"a5XyWfH1zaQ0QlZ2mKBeHebCIJkgTZZVipagRVOgcwIDAQABo4IByDCCAcQwgY0G\\n\" +\n-            \"CCsGAQUFBwEBBIGAMH4wLQYIKwYBBQUHMAGGIWh0dHA6Ly9vY3NwLnRydXN0LnRl\\n\" +\n-            \"bGlhc29uZXJhLmNvbTBNBggrBgEFBQcwAoZBaHR0cDovL3JlcG9zaXRvcnkudHJ1\\n\" +\n-            \"c3QudGVsaWFzb25lcmEuY29tL3RlbGlhc29uZXJhc2VydmVyY2F2Mi5jZXIwHwYD\\n\" +\n-            \"VR0jBBgwFoAUL0k8KU\/XByX5xozVZPVmPRKDIpUwTgYDVR0gBEcwRTBDBgZngQwB\\n\" +\n-            \"AgIwOTA3BggrBgEFBQcCARYraHR0cDovL3JlcG9zaXRvcnkudHJ1c3QudGVsaWFz\\n\" +\n-            \"b25lcmEuY29tL0NQUzBNBgNVHR8ERjBEMEKgQKA+hjxodHRwOi8vY3JsLTMudHJ1\\n\" +\n-            \"c3QudGVsaWFzb25lcmEuY29tL3RlbGlhc29uZXJhc2VydmVyY2F2Mi5jcmwwHQYD\\n\" +\n-            \"VR0lBBYwFAYIKwYBBQUHAwEGCCsGAQUFBwMCMA4GA1UdDwEB\/wQEAwIEsDAkBgNV\\n\" +\n-            \"HREEHTAbghlqdW9sdWtrYS5jb3Zlci5zb25lcmEubmV0MB0GA1UdDgQWBBSa+vJH\\n\" +\n-            \"I6Lt9Aqw5ondhoZu4\/IJezANBgkqhkiG9w0BAQsFAAOCAgEASRK1l1MZb\/IRlyi+\\n\" +\n-            \"XjfZcxJdFuNzW2kpZstW6Ni2XiD3p7aROBfDFtu7GajzZHb6p76auDb4NwJgeE\/3\\n\" +\n-            \"6gnXoIK00HwpF2RAhxDpkF8r3q0jSqGhSv\/xz9Nx7JBzgqfSw3Ha4ohioIed3uc+\\n\" +\n-            \"nMDyvVenio4GYgtxIIubSybCxMv\/lBA\/S4daIVCYK3VOoBbM2F36ecAKvRU5vIWM\\n\" +\n-            \"urXsfANL3u4qgJpaM0DclzFsOkVsRPffzToko\/Nr6pGXYjt47IzTRlwLMnLehoZW\\n\" +\n-            \"ZZMGMVVOlR7XGf81UjWB6OsKeoQ4FWgcb\/rIJcZusm+LqvnsCHuC3gtuC2nGA7lr\\n\" +\n-            \"fseUlG7QZN9\/QfUIyvL69wAzeVj1cUcd7GHcAH9DyZJfI8orv4PyUvitDdgISkFu\\n\" +\n-            \"GZ562O7cGmCv00\/6I4t0z9wZal8a5lRDoKXAYy+u\/adrO1JjLwi11y\/DTw9LQ7sJ\\n\" +\n-            \"gVP\/v2GsI0ajF9A6z33UHN9uxXZVmQNvOiMkcJiGLovFgu5zxoAg2W3pHjbBbeL8\\n\" +\n-            \"v5MPqgsKafgzaSRtXBBvaISHi9hhRR8v\/qSwO3NyLm8uAhQD4x+OPHrmQ\/s16j45\\n\" +\n-            \"Ib53UHj1k6byXGUqDgzFBsmEPV6Shf2C4\/HcRHpAX8wQx3xVwDtRzDpNUR6vnNfi\\n\" +\n-            \"PwzRU1xsQKd8llmgl4l+fYV0tBA=\\n\" +\n-            \"-----END CERTIFICATE-----\";\n+    private static final String VALID = \"https:\/\/juolukka.cover.sonera.net:10443\/\";\n+    private static final String REVOKED = \"https:\/\/juolukka.cover.sonera.net:10444\/\";\n+    private static final String CA_ALIAS = \"teliasonerarootcav1 [jdk]\";\n@@ -174,2 +52,0 @@\n-        ValidatePathWithParams pathValidator = new ValidatePathWithParams(null);\n-\n@@ -177,1 +53,1 @@\n-            pathValidator.enableCRLCheck();\n+            ValidatePathWithURL.enableCRLOnly();\n@@ -180,1 +56,1 @@\n-            pathValidator.enableOCSPCheck();\n+            ValidatePathWithURL.enableOCSPOnly();\n@@ -183,8 +59,1 @@\n-        \/\/ Validate valid\n-        pathValidator.validate(new String[]{VALID, INT},\n-                ValidatePathWithParams.Status.GOOD, null, System.out);\n-\n-        \/\/ Validate Revoked\n-        pathValidator.validate(new String[]{REVOKED, INT},\n-                ValidatePathWithParams.Status.REVOKED,\n-                \"Thu Dec 22 23:14:55 PST 2016\", System.out);\n+        ValidatePathWithURL validatePathWithURL = new ValidatePathWithURL(CA_ALIAS);\n@@ -192,2 +61,2 @@\n-        \/\/ reset validation date back to current date\n-        pathValidator.resetValidationDate();\n+        validatePathWithURL.validateDomain(VALID, false);\n+        validatePathWithURL.validateDomain(REVOKED, true);\n","filename":"test\/jdk\/security\/infra\/java\/security\/cert\/CertPathValidator\/certification\/TeliaSoneraCA.java","additions":23,"deletions":154,"binary":false,"changes":177,"status":"modified"},{"patch":"@@ -0,0 +1,173 @@\n+\/*\n+ * Copyright (c) 2023, Oracle and\/or its affiliates. All rights reserved.\n+ * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+ *\n+ * This code is free software; you can redistribute it and\/or modify it\n+ * under the terms of the GNU General Public License version 2 only, as\n+ * published by the Free Software Foundation.\n+ *\n+ * This code is distributed in the hope that it will be useful, but WITHOUT\n+ * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+ * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+ * version 2 for more details (a copy is included in the LICENSE file that\n+ * accompanied this code).\n+ *\n+ * You should have received a copy of the GNU General Public License version\n+ * 2 along with this work; if not, write to the Free Software Foundation,\n+ * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n+ *\n+ * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n+ * or visit www.oracle.com if you need additional information or have any\n+ * questions.\n+ *\/\n+\n+import jtreg.SkippedException;\n+\n+import javax.net.ssl.*;\n+import javax.security.auth.x500.X500Principal;\n+import java.io.FileInputStream;\n+import java.io.IOException;\n+import java.net.URL;\n+import java.security.*;\n+import java.security.cert.*;\n+import java.security.cert.Certificate;\n+\n+public class ValidatePathWithURL {\n+\n+    private final X509Certificate rootCertificate;\n+    private final X500Principal rootPrincipal;\n+\n+    public ValidatePathWithURL(String caAlias) throws Exception {\n+        System.setProperty(\"com.sun.net.ssl.checkRevocation\", \"true\");\n+        Security.setProperty(\"ssl.TrustManagerFactory.algorithm\", \"SunPKIX\");\n+\n+        \/\/ some test sites don't have correct hostname specified in test certificate\n+        HttpsURLConnection.setDefaultHostnameVerifier(new CustomHostnameVerifier());\n+\n+        String FS = System.getProperty(\"file.separator\");\n+        String CACERTS_STORE =\n+                System.getProperty(\"test.jdk\") + FS + \"lib\" + FS + \"security\" + FS + \"cacerts\";\n+\n+        KeyStore cacerts = KeyStore.getInstance(\"PKCS12\");\n+        try (FileInputStream fis = new FileInputStream(CACERTS_STORE)) {\n+            cacerts.load(fis, null);\n+        }\n+\n+        rootCertificate = (X509Certificate) cacerts.getCertificate(caAlias);\n+        rootPrincipal = rootCertificate.getSubjectX500Principal();\n+    }\n+\n+    public static void enableOCSPOnly() {\n+        System.setProperty(\"com.sun.security.enableCRLDP\", \"false\");\n+        Security.setProperty(\"ocsp.enable\", \"true\");\n+    }\n+\n+    public static void enableCRLOnly() {\n+        System.setProperty(\"com.sun.security.enableCRLDP\", \"true\");\n+    }\n+\n+    public static void enableOCSPAndCRL() {\n+        System.setProperty(\"com.sun.security.enableCRLDP\", \"true\");\n+        Security.setProperty(\"ocsp.enable\", \"true\");\n+    }\n+\n+    public void validateDomain(final String testURL,\n+                               final boolean revokedCert)\n+            throws CertificateException, NoSuchAlgorithmException, SignatureException,\n+                    InvalidKeyException, NoSuchProviderException {\n+        System.out.println();\n+        System.out.println(\"===== Validate \" + testURL + \"=====\");\n+        if (!validateDomainCertChain(testURL, revokedCert)) {\n+            throw new RuntimeException(\"Failed to validate \" + testURL);\n+        }\n+        System.out.println(\"======> SUCCESS\");\n+    }\n+\n+    private boolean validateDomainCertChain(final String testURL,\n+                                            final boolean revokedCert)\n+            throws CertificateException, NoSuchAlgorithmException, SignatureException,\n+                    InvalidKeyException, NoSuchProviderException {\n+        HttpsURLConnection httpsURLConnection = null;\n+        try {\n+            URL url = new URL(testURL);\n+            httpsURLConnection = (HttpsURLConnection) url.openConnection();\n+            httpsURLConnection.setInstanceFollowRedirects(false);\n+            httpsURLConnection.connect();\n+\n+            \/\/ certain that test certificate anchors to trusted CA for VALID certificate\n+            \/\/ if the connection is successful\n+            Certificate[] chain = httpsURLConnection.getServerCertificates();\n+            httpsURLConnection.disconnect();\n+            X509Certificate interCert = null;\n+\n+            \/\/ fail if there is no intermediate CA or self-signed\n+            if (chain.length < 2) {\n+                throw new RuntimeException(\"Cert chain too short \" + chain.length);\n+            } else {\n+                System.out.println(\"Finding intermediate certificate issued by CA\");\n+                for (Certificate cert: chain){\n+                    if(cert instanceof X509Certificate certificate) {\n+                        System.out.println(\"Checking: \" + certificate.getSubjectX500Principal());\n+                        System.out.println(\"Issuer: \" + certificate.getIssuerX500Principal());\n+                        if (certificate.getIssuerX500Principal().equals(rootPrincipal)){\n+                            interCert = certificate;\n+                            break;\n+                        }\n+                    }\n+                }\n+            }\n+\n+            if (interCert == null){\n+                throw new RuntimeException(\"Intermediate Root CA not found in the chain\");\n+            }\n+\n+            \/\/ validate intermediate CA signed by root CA under test\n+            System.out.println(\"Found intermediate root CA: \" + interCert.getSubjectX500Principal());\n+            System.out.println(\"intermediate CA Issuer: \" + interCert.getIssuerX500Principal());\n+            interCert.verify(rootCertificate.getPublicKey());\n+            System.out.println(\"Verified: Intermediate CA signed by test root CA\");\n+        } catch (SSLHandshakeException e) {\n+            System.out.println(\"SSLHandshakeException: \" + e.getMessage());\n+            Throwable cause = e.getCause();\n+\n+            while (cause != null) {\n+                if (cause instanceof CertPathValidatorException cpve) {\n+                    if (cpve.getReason() == CertPathValidatorException.BasicReason.REVOKED\n+                            || cpve.getCause() instanceof CertificateRevokedException) {\n+                        System.out.println(\"Certificate is revoked\");\n+                        if (revokedCert) {\n+                            return true;\n+                        }\n+                    } else if (cpve.getReason() == CertPathValidatorException.BasicReason.EXPIRED\n+                            || cpve.getCause() instanceof CertificateExpiredException) {\n+                        System.out.println(\"Certificate is expired\");\n+                        throw new SkippedException(\"Certificate is expired, skip the test\");\n+                    }\n+                    break;\n+                }\n+                cause = cause.getCause();\n+            }\n+\n+            throw new RuntimeException(\"Unhandled exception\", e);\n+        } catch (SSLException e) {\n+            \/\/ thrown if root CA is not included in cacerts\n+            throw new RuntimeException(e);\n+        } catch (IOException e) {\n+            throw new SkippedException(\"Network setup issue, skip this test\", e);\n+        } finally {\n+            if(httpsURLConnection != null) {\n+                httpsURLConnection.disconnect();\n+            }\n+        }\n+\n+        return !revokedCert;\n+    }\n+\n+    private static class CustomHostnameVerifier implements HostnameVerifier {\n+        @Override\n+        public boolean verify(String hostname, SSLSession session) {\n+            \/\/ Allow any hostname\n+            return true;\n+        }\n+    }\n+}\n","filename":"test\/jdk\/security\/infra\/java\/security\/cert\/CertPathValidator\/certification\/ValidatePathWithURL.java","additions":173,"deletions":0,"binary":false,"changes":173,"status":"added"}]}