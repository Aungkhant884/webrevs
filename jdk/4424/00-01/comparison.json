{"files":[{"patch":"@@ -35,0 +35,1 @@\n+import java.util.HashSet;\n@@ -36,0 +37,1 @@\n+import java.util.Locale;\n@@ -51,1 +53,1 @@\n-    static List<String> getAlgorithms(String propertyName) {\n+    static Set<String> getAlgorithms(String propertyName) {\n@@ -70,1 +72,1 @@\n-                algorithmsInProperty[i] = algorithmsInProperty[i].trim();\n+                algorithmsInProperty[i] = algorithmsInProperty[i].trim().toLowerCase(Locale.ENGLISH);\n@@ -76,1 +78,1 @@\n-            return Collections.emptyList();\n+            return Collections.emptySet();\n@@ -78,1 +80,1 @@\n-        return new ArrayList<>(Arrays.asList(algorithmsInProperty));\n+        return new HashSet<>(Arrays.asList(algorithmsInProperty));\n","filename":"src\/java.base\/share\/classes\/sun\/security\/util\/AbstractAlgorithmConstraints.java","additions":6,"deletions":4,"binary":false,"changes":10,"status":"modified"},{"patch":"@@ -130,1 +130,1 @@\n-        List<String> disabledAlgorithmsList = getAlgorithms(propertyName);\n+        disabledAlgorithms = getAlgorithms(propertyName);\n@@ -133,22 +133,7 @@\n-        int ecindex = -1, i = 0;\n-        for (String s : disabledAlgorithmsList) {\n-            if (s.regionMatches(true, 0,\"include \", 0, 8)) {\n-                if (s.regionMatches(true, 8, PROPERTY_DISABLED_EC_CURVES, 0,\n-                        PROPERTY_DISABLED_EC_CURVES.length())) {\n-                    ecindex = i;\n-                    break;\n-                }\n-            }\n-            i++;\n-        }\n-        if (ecindex > -1) {\n-            disabledAlgorithmsList.remove(ecindex);\n-            disabledAlgorithmsList.addAll(ecindex,\n-                    getAlgorithms(PROPERTY_DISABLED_EC_CURVES));\n-        }\n-        algorithmConstraints = new Constraints(propertyName, disabledAlgorithmsList);\n-\n-        disabledAlgorithms = new HashSet<String>();\n-        for (String algorithm : disabledAlgorithmsList) {\n-            if (algorithm == null || algorithm.isEmpty()) {\n-                continue;\n+        Pattern INCLUDE_PATTERN = Pattern.compile(\"include \" + PROPERTY_DISABLED_EC_CURVES, Pattern.CASE_INSENSITIVE);\n+        Matcher matcher;\n+        for (String s : disabledAlgorithms) {\n+            if ((matcher = INCLUDE_PATTERN.matcher(s)).matches()) {\n+                disabledAlgorithms.remove(matcher.group());\n+                disabledAlgorithms.addAll(getAlgorithms(PROPERTY_DISABLED_EC_CURVES));\n+                break;\n@@ -156,1 +141,0 @@\n-            disabledAlgorithms.add(algorithm.toLowerCase());\n@@ -158,0 +142,1 @@\n+        algorithmConstraints = new Constraints(propertyName, disabledAlgorithms);\n@@ -340,1 +325,1 @@\n-                    \"denyAfter\\\\s+(\\\\d{4})-(\\\\d{2})-(\\\\d{2})\");\n+                    \"denyAfter\\\\s+(\\\\d{4})-(\\\\d{2})-(\\\\d{2})\", Pattern.CASE_INSENSITIVE);\n@@ -343,1 +328,1 @@\n-        public Constraints(String propertyName, List<String> constraintArray) {\n+        public Constraints(String propertyName, Set<String> constraintArray) {\n@@ -391,1 +376,1 @@\n-                    if (entry.startsWith(\"keySize\")) {\n+                    if (entry.regionMatches(true, 0, \"keySize\", 0, 7)) {\n@@ -397,1 +382,1 @@\n-                        if (!\"keySize\".equals(tokens.nextToken())) {\n+                        if (!\"keySize\".equalsIgnoreCase(tokens.nextToken())) {\n@@ -418,1 +403,1 @@\n-                    } else if (entry.startsWith(\"denyAfter\") &&\n+                    } else if (entry.regionMatches(true, 0, \"denyAfter\", 0, 8) &&\n@@ -435,1 +420,1 @@\n-                    } else if (entry.startsWith(\"usage\")) {\n+                    } else if (entry.regionMatches(true, 0, \"usage\", 0, 5)) {\n","filename":"src\/java.base\/share\/classes\/sun\/security\/util\/DisabledAlgorithmConstraints.java","additions":15,"deletions":30,"binary":false,"changes":45,"status":"modified"},{"patch":"@@ -49,8 +49,1 @@\n-        List<String> legacyAlgorithmsList = getAlgorithms(propertyName);\n-        legacyAlgorithms = new HashSet<String>();\n-        for (String algorithm : legacyAlgorithmsList) {\n-            if (algorithm == null || algorithm.isEmpty()) {\n-                continue;\n-            }\n-            legacyAlgorithms.add(algorithm.toLowerCase());\n-        }\n+        legacyAlgorithms = getAlgorithms(propertyName);\n","filename":"src\/java.base\/share\/classes\/sun\/security\/util\/LegacyAlgorithmConstraints.java","additions":1,"deletions":8,"binary":false,"changes":9,"status":"modified"}]}