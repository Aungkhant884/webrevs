{"files":[{"patch":"@@ -309,1 +309,1 @@\n-    elif test \"x$OPENJDK_TARGET_OS-$OPENJDK_TARGET_CPU\" = \"xlinux-aarch64\"; then\n+    elif test \"x$OPENJDK_TARGET_CPU\" = \"xaarch64\"; then\n@@ -343,1 +343,1 @@\n-    elif test \"x$OPENJDK_TARGET_OS-$OPENJDK_TARGET_CPU\" = \"xlinux-aarch64\"; then\n+    elif test \"x$OPENJDK_TARGET_CPU\" = \"xaarch64\"; then\n","filename":"make\/autoconf\/jvm-features.m4","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -125,1 +125,1 @@\n-        return new AArch64HotSpotRegisterConfig(target, config.useCompressedOops);\n+        return new AArch64HotSpotRegisterConfig(target, config.useCompressedOops, config.linuxOs);\n","filename":"src\/jdk.internal.vm.ci\/share\/classes\/jdk.vm.ci.hotspot.aarch64\/src\/jdk\/vm\/ci\/hotspot\/aarch64\/AArch64HotSpotJVMCIBackendFactory.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -37,0 +37,1 @@\n+import static jdk.vm.ci.aarch64.AArch64.r18;\n@@ -125,0 +126,1 @@\n+    public static final Register platformRegister = r18;\n@@ -131,1 +133,1 @@\n-    private static RegisterArray initAllocatable(Architecture arch, boolean reserveForHeapBase) {\n+    private static RegisterArray initAllocatable(Architecture arch, boolean reserveForHeapBase, boolean linuxOs) {\n@@ -133,1 +135,1 @@\n-        Register[] registers = new Register[allRegisters.size() - reservedRegisters.size() - (reserveForHeapBase ? 1 : 0)];\n+        Register[] registers = new Register[allRegisters.size() - reservedRegisters.size() - (reserveForHeapBase ? 1 : 0) - (!linuxOs ? 1 : 0)];\n@@ -142,0 +144,6 @@\n+            if (!linuxOs && reg.equals(platformRegister)) {\n+                \/\/ ARMv8 defines r18 as being available to the platform ABI.\n+                \/\/ Windows and Darwin use it for such. Linux doesn't assign it\n+                \/\/ and thus r18 can be used as an additional register.\n+                continue;\n+            }\n@@ -155,2 +163,2 @@\n-    public AArch64HotSpotRegisterConfig(TargetDescription target, boolean useCompressedOops) {\n-        this(target, initAllocatable(target.arch, useCompressedOops));\n+    public AArch64HotSpotRegisterConfig(TargetDescription target, boolean useCompressedOops, boolean linuxOs) {\n+        this(target, initAllocatable(target.arch, useCompressedOops, linuxOs));\n","filename":"src\/jdk.internal.vm.ci\/share\/classes\/jdk.vm.ci.hotspot.aarch64\/src\/jdk\/vm\/ci\/hotspot\/aarch64\/AArch64HotSpotRegisterConfig.java","additions":12,"deletions":4,"binary":false,"changes":16,"status":"modified"}]}