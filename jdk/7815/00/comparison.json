{"files":[{"patch":"@@ -1780,0 +1780,3 @@\n+    if (class_id() == Class_MachCallLeaf) {\n+      return 4 * NativeInstruction::instruction_size;\n+    }\n@@ -1790,1 +1793,1 @@\n-    return 6 * NativeInstruction::instruction_size;\n+    return 4 * NativeInstruction::instruction_size;\n@@ -3869,8 +3872,14 @@\n-      Label retaddr;\n-      __ adr(rscratch2, retaddr);\n-      __ lea(rscratch1, RuntimeAddress(entry));\n-      \/\/ Leave a breadcrumb for JavaFrameAnchor::capture_last_Java_pc()\n-      __ stp(zr, rscratch2, Address(__ pre(sp, -2 * wordSize)));\n-      __ blr(rscratch1);\n-      __ bind(retaddr);\n-      __ add(sp, sp, 2 * wordSize);\n+      int op = ideal_Opcode();\n+      if (op == Op_CallLeaf || op == Op_CallLeafNoFP || op == Op_CallNative) {\n+        __ lea(rscratch1, RuntimeAddress(entry));\n+        __ blr(rscratch1);\n+      } else {\n+        Label retaddr;\n+        __ adr(rscratch2, retaddr);\n+        __ lea(rscratch1, RuntimeAddress(entry));\n+        \/\/ Leave a breadcrumb for JavaFrameAnchor::capture_last_Java_pc()\n+        __ stp(zr, rscratch2, Address(__ pre(sp, -2 * wordSize)));\n+        __ blr(rscratch1);\n+        __ bind(retaddr);\n+        __ add(sp, sp, 2 * wordSize);\n+      }\n","filename":"src\/hotspot\/cpu\/aarch64\/aarch64.ad","additions":18,"deletions":9,"binary":false,"changes":27,"status":"modified"}]}