{"files":[{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2012, 2020, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2012, 2021, Oracle and\/or its affiliates. All rights reserved.\n@@ -401,2 +401,17 @@\n-        LogRecord[] lra = new LogRecord[1];\n-        StreamHandler handler = new StreamHandler() {\n+        \/\/ this will ensure LocaleProviderAdapter initialization\n+        DateFormat.getDateInstance();\n+        LogConfig.handler.flush();\n+\n+        var r = LogConfig.lra[0];\n+        if (r == null ||\n+            r.getLevel() != Level.INFO ||\n+            !r.getMessage().equals(expected)) {\n+            throw new RuntimeException(\"Expected log was not emitted. LogRecord: \" +\n+                    (r == null ? null : r.getMessage()));\n+        }\n+    }\n+\n+    \/\/ Set the root logger on loading the logging class\n+    public static class LogConfig {\n+        final static LogRecord[] lra = new LogRecord[1];\n+        final static StreamHandler handler = new StreamHandler() {\n@@ -406,0 +421,1 @@\n+                System.out.println(\"LogRecord: \" + record.getMessage());\n@@ -408,9 +424,2 @@\n-        getLogManager().getLogger(\"\").addHandler(handler);\n-\n-        DateFormat.getDateInstance(); \/\/ this will init LocaleProviderAdapter\n-        handler.flush();\n-\n-        if (lra[0] == null ||\n-            lra[0].getLevel() != Level.INFO ||\n-            !lra[0].getMessage().equals(expected)) {\n-            throw new RuntimeException(\"Expected log was not emitted. LogRecord: \" + lra[0]);\n+        static {\n+            getLogManager().getLogger(\"\").addHandler(handler);\n","filename":"test\/jdk\/java\/util\/Locale\/LocaleProviders.java","additions":21,"deletions":12,"binary":false,"changes":33,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2012, 2020, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2012, 2021, Oracle and\/or its affiliates. All rights reserved.\n@@ -29,1 +29,1 @@\n- *      8246721 8248695 8257964\n+ *      8246721 8248695 8257964 8261919\n@@ -187,0 +187,1 @@\n+                .addToolArg(\"-Djava.util.logging.config.class=LocaleProviders$LogConfig\")\n","filename":"test\/jdk\/java\/util\/Locale\/LocaleProvidersRun.java","additions":3,"deletions":2,"binary":false,"changes":5,"status":"modified"}]}