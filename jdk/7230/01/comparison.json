{"files":[{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2002, 2021, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2002, 2022, Oracle and\/or its affiliates. All rights reserved.\n@@ -815,4 +815,7 @@\n-            \/\/ create temporary output buffer if the estimated size is larger\n-            \/\/ than the user-provided buffer.\n-            internalOutput = new byte[estOutSize];\n-            offset = 0;\n+            if (outputCapacity < estOutSize || padding != null) {\n+                \/\/ create temporary output buffer if the estimated size is larger\n+                \/\/ than the user-provided buffer or a padding needs to be removed\n+                \/\/ before copying the unpadded result to the output buffer\n+                internalOutput = new byte[estOutSize];\n+                offset = 0;\n+            }\n","filename":"src\/java.base\/share\/classes\/com\/sun\/crypto\/provider\/CipherCore.java","additions":8,"deletions":5,"binary":false,"changes":13,"status":"modified"}]}