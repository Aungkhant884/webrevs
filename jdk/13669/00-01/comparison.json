{"files":[{"patch":"@@ -44,6 +44,2 @@\n- * @run main\/othervm -Djavax.net.ssl.keyStore=${test.src}\/..\/etc\/keystore\n- *                   -Djavax.net.ssl.keyStorePassword=passphrase\n- *                   -Djavax.net.ssl.trustStore=${test.src}\/..\/etc\/truststore\n- *                   -Djavax.net.ssl.trustStorePassword=passphrase\n- *                   -Djavax.net.debug=all\n- *                   ServerNameRejectedTLSSessionResumption\n+ * @library \/javax\/net\/ssl\/templates\n+ * @run main\/othervm -Djavax.net.debug=all ServerNameRejectedTLSSessionResumption\n@@ -51,1 +47,1 @@\n-public class ServerNameRejectedTLSSessionResumption {\n+public class ServerNameRejectedTLSSessionResumption extends SSLContextTemplate {\n@@ -60,3 +56,8 @@\n-        final SSLContext sslContext = SSLContext.getDefault();\n-        \/\/ create client and server SSLEngine(s) using the same SSLContext\n-        final SSLEngine clientEngine = createClientSSLEngine(sslContext);\n+        new ServerNameRejectedTLSSessionResumption().runTest();\n+    }\n+\n+    private void runTest() throws Exception {\n+        final SSLContext clientSSLContext = createClientSSLContext();\n+        final SSLContext serverSSLContext = createServerSSLContext();\n+        \/\/ create client and server SSLEngine(s)\n+        final SSLEngine clientEngine = createClientSSLEngine(clientSSLContext);\n@@ -65,1 +66,1 @@\n-        final SSLEngine serverEngine = createServerSSLEngine(sslContext,\n+        final SSLEngine serverEngine = createServerSSLEngine(serverSSLContext,\n@@ -70,2 +71,2 @@\n-        \/\/ now that the communication has been successful, we expect the SSLContext's (internal)\n-        \/\/ cache to have created and cached a SSLSession against the peer host:port\n+        \/\/ now that the communication has been successful, we expect the client SSLContext's\n+        \/\/ (internal) cache to have created and cached a SSLSession against the peer host:port\n@@ -73,1 +74,1 @@\n-        \/\/ now create the SSLEngine(s) again with the same SSLContext instance as before,\n+        \/\/ now create the SSLEngine(s) again with the same SSLContext instances as before,\n@@ -76,1 +77,1 @@\n-        final SSLEngine secondClientEngine = createClientSSLEngine(sslContext);\n+        final SSLEngine secondClientEngine = createClientSSLEngine(clientSSLContext);\n@@ -79,1 +80,1 @@\n-        final SSLEngine secondServerEngine = createServerSSLEngine(sslContext, null);\n+        final SSLEngine secondServerEngine = createServerSSLEngine(serverSSLContext, null);\n","filename":"test\/jdk\/javax\/net\/ssl\/SSLSession\/ServerNameRejectedTLSSessionResumption.java","additions":17,"deletions":16,"binary":false,"changes":33,"status":"modified"}]}