{"files":[{"patch":"@@ -488,2 +488,12 @@\n-      set_c1_count(MAX2(count \/ 3, 1));\n-      set_c2_count(MAX2(count - c1_count(), 1));\n+#if INCLUDE_JVMCI\n+      if (UseJVMCICompiler && UseJVMCINativeLibrary) {\n+        int libjvmci_count = MAX2((int) (count * JVMCINativeLibraryThreadFraction), 1);\n+        int c1_count = MAX2(count - libjvmci_count, 1);\n+        set_c2_count(libjvmci_count);\n+        set_c1_count(c1_count);\n+      } else\n+#endif\n+      {\n+        set_c1_count(MAX2(count \/ 3, 1));\n+        set_c2_count(MAX2(count - c1_count(), 1));\n+      }\n","filename":"src\/hotspot\/share\/compiler\/compilationPolicy.cpp","additions":12,"deletions":2,"binary":false,"changes":14,"status":"modified"},{"patch":"@@ -125,0 +125,1 @@\n+  CHECK_NOT_SET(JVMCINativeLibraryThreadFraction,    EnableJVMCI)\n@@ -184,0 +185,1 @@\n+    \"JVMCINativeLibraryThreadFraction\",\n","filename":"src\/hotspot\/share\/jvmci\/jvmci_globals.cpp","additions":2,"deletions":0,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -61,1 +61,1 @@\n-  product(uint, JVMCIThreadsPerNativeLibraryRuntime, 0, EXPERIMENTAL,       \\\n+  product(uint, JVMCIThreadsPerNativeLibraryRuntime, 1, EXPERIMENTAL,       \\\n@@ -63,1 +63,2 @@\n-          \"Specify 0 to force use of a single JVMCI native runtime. \")      \\\n+          \"Specify 0 to force use of a single JVMCI native runtime. \"       \\\n+          \"Specify 1 to force a single JVMCI native runtime per thread. \")  \\\n@@ -139,1 +140,1 @@\n-          \"Execute JVMCI Java code from a shared library \"                  \\\n+          \"Execute JVMCI Java code from a shared library (\\\"libjvmci\\\") \"   \\\n@@ -144,0 +145,5 @@\n+  product(double, JVMCINativeLibraryThreadFraction, 0.33, EXPERIMENTAL,     \\\n+          \"The fraction of compiler threads used by libjvmci. \"             \\\n+          \"The remaining compiler threads are used by C1.\")                 \\\n+          range(0.0, 1.0)                                                   \\\n+                                                                            \\\n","filename":"src\/hotspot\/share\/jvmci\/jvmci_globals.hpp","additions":9,"deletions":3,"binary":false,"changes":12,"status":"modified"}]}