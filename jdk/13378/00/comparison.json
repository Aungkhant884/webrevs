{"files":[{"patch":"@@ -99,1 +99,1 @@\n-        private final StringBuilder sb;\n+        private StringBuilder sb;\n@@ -169,0 +169,2 @@\n+                sb = null;\n+                offsetMap.trim();\n@@ -313,0 +315,7 @@\n+        \/**\n+         * Reduce map to minimum size.\n+         *\/\n+        void trim() {\n+            map = Arrays.copyOf(map, size);\n+        }\n+\n","filename":"src\/jdk.compiler\/share\/classes\/com\/sun\/tools\/javac\/parser\/JavadocTokenizer.java","additions":10,"deletions":1,"binary":false,"changes":11,"status":"modified"},{"patch":"@@ -57,0 +57,5 @@\n+    \/**\n+     * Virtual position offset in the original buffer.\n+     *\/\n+    private final int offset;\n+\n@@ -118,1 +123,1 @@\n-        this(log, array, 0, length);\n+        this(log, array, 0, 0, length);\n@@ -130,1 +135,1 @@\n-    protected UnicodeReader(Log log, char[] array, int pos, int endPos) {\n+    protected UnicodeReader(Log log, char[] array, int offset, int pos, int endPos) {\n@@ -133,0 +138,1 @@\n+        this.offset = offset;\n@@ -318,1 +324,1 @@\n-     * Return the current position in the character buffer.\n+     * Return the virtual position in the character buffer.\n@@ -320,1 +326,1 @@\n-     * @return  current position in the character buffer.\n+     * @return  virtual position in the character buffer.\n@@ -323,1 +329,1 @@\n-        return position;\n+        return offset + position;\n@@ -328,1 +334,1 @@\n-     * Reset the reader to the specified position.\n+     * Reset the reader to the specified virtual position.\n@@ -333,1 +339,1 @@\n-        position = pos;\n+        position = pos - offset;\n@@ -477,1 +483,1 @@\n-        return lineReader(pos, endPos);\n+        return new UnicodeReader(log, buffer, offset, pos, endPos);\n@@ -490,1 +496,1 @@\n-        return new UnicodeReader(log, buffer, pos, endPos);\n+        return new UnicodeReader(log, buffer, offset, pos - offset, endPos - offset);\n@@ -564,1 +570,1 @@\n-        int savedPosition = position;\n+        int savedPosition = position();\n@@ -698,1 +704,1 @@\n-            super(reader.log, reader.buffer, pos, endPos);\n+            super(reader.log, reader.getRawCharacters(pos, endPos), reader.offset + pos, 0, endPos - pos);\n","filename":"src\/jdk.compiler\/share\/classes\/com\/sun\/tools\/javac\/parser\/UnicodeReader.java","additions":17,"deletions":11,"binary":false,"changes":28,"status":"modified"}]}