{"files":[{"patch":"@@ -44,0 +44,1 @@\n+#include \"logging\/logStream.hpp\"\n@@ -49,0 +50,1 @@\n+#include \"oops\/fieldStreams.inline.hpp\"\n@@ -53,1 +55,0 @@\n-#include \"oops\/fieldStreams.inline.hpp\"\n@@ -59,1 +60,0 @@\n-#include \"prims\/vectorSupport.hpp\"\n@@ -61,0 +61,1 @@\n+#include \"prims\/vectorSupport.hpp\"\n@@ -1840,7 +1841,19 @@\n-void Deoptimization::print_ul(CompiledMethod* nm, intptr_t pc, frame& fr, const char* name_sig,\n-                              int trap_bci, int osr_bci, const char* reason_name,\n-                              const char* reason_action) {\n-  log_debug(deoptimization)(\n-      \"cid=%d %s pc=\" INTPTR_FORMAT \" relative_pc=\" INTPTR_FORMAT \" level=%d %s @ %d %d %s -> %s\",\n-      nm->compile_id(), (nm->is_osr_method() ? \"%\" : \"\"), pc, fr.pc() - nm->code_begin(),\n-      nm->comp_level(), name_sig, trap_bci, osr_bci, reason_name, reason_action);\n+void Deoptimization::print_ul(CompiledMethod* nm, intptr_t pc, frame& fr, int trap_bci,\n+                              const char* reason_name, const char* reason_action) {\n+  LogTarget(Debug, deoptimization) lt;\n+  bool is_osr = nm->is_osr_method();\n+  if (lt.is_enabled()) {\n+    LogStream ls(lt);\n+    ls.print(\"cid=%d %s pc=\" INTPTR_FORMAT \" relative_pc=\" INTPTR_FORMAT \" level=%d\",\n+             nm->compile_id(), (is_osr ? \"%\" : \"\"), pc, fr.pc() - nm->code_begin(),\n+             nm->comp_level());\n+    nm->method()->print_short_name(&ls);\n+    ls.print(\" @ \");\n+    ls.print(\"%d \", trap_bci);\n+    if (is_osr) {\n+      ls.print(\"%d \", nm->osr_entry_bci());\n+    }\n+    ls.print(\"%s \", reason_name);\n+    ls.print(\"%s\", reason_action);\n+    ls.cr();\n+  }\n@@ -1943,2 +1956,0 @@\n-      bool is_osr = nm->is_osr_method();\n-      int osr_bci = is_osr ? nm->osr_entry_bci() : -1;\n@@ -1946,1 +1957,0 @@\n-      char* name_sig = tm->name_and_sig_as_C_string();\n@@ -1952,1 +1962,1 @@\n-      print_ul(nm, pc, fr, name_sig, trap_bci, osr_bci, reason_name, reason_action);\n+      print_ul(nm, pc, fr, trap_bci, reason_name, reason_action);\n@@ -1955,1 +1965,1 @@\n-                                name_sig, trap_bci, nm->compiler_name());\n+                                tm->name_and_sig_as_C_string(), trap_bci, nm->compiler_name());\n","filename":"src\/hotspot\/share\/runtime\/deoptimization.cpp","additions":24,"deletions":14,"binary":false,"changes":38,"status":"modified"},{"patch":"@@ -168,0 +168,2 @@\n+    static void print_ul(CompiledMethod* nm, intptr_t pc, frame& fr, int trap_bci,\n+                         const char* reason_name, const char* reason_action);\n@@ -169,6 +171,2 @@\n-  static void print_ul(CompiledMethod* nm, intptr_t pc, frame& fr, const char* name_sig,\n-                       int trap_bci, int osr_bci, const char* reason_name,\n-                       const char* reason_action);\n-\n-  \/\/ Does the actual work for deoptimizing a single frame\n-  static void deoptimize_single_frame(JavaThread* thread, frame fr, DeoptReason reason);\n+    \/\/ Does the actual work for deoptimizing a single frame\n+    static void deoptimize_single_frame(JavaThread* thread, frame fr, DeoptReason reason);\n","filename":"src\/hotspot\/share\/runtime\/deoptimization.hpp","additions":4,"deletions":6,"binary":false,"changes":10,"status":"modified"}]}