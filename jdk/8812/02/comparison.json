{"files":[{"patch":"@@ -70,0 +70,1 @@\n+  LOG_TAG(deoptimization) \\\n","filename":"src\/hotspot\/share\/logging\/logTag.hpp","additions":1,"deletions":0,"binary":false,"changes":1,"status":"modified"},{"patch":"@@ -41,0 +41,3 @@\n+#include \"logging\/log.hpp\"\n+#include \"logging\/logLevel.hpp\"\n+#include \"logging\/logMessage.hpp\"\n@@ -1930,6 +1933,20 @@\n-    JFR_ONLY(post_deoptimization_event(nm, trap_method(), trap_bci, trap_bc, reason, action);)\n-\n-    \/\/ Log a message\n-    Events::log_deopt_message(current, \"Uncommon trap: reason=%s action=%s pc=\" INTPTR_FORMAT \" method=%s @ %d %s\",\n-                              trap_reason_name(reason), trap_action_name(action), p2i(fr.pc()),\n-                              trap_method->name_and_sig_as_C_string(), trap_bci, nm->compiler_name());\n+    { \/\/ Log Deoptimization event for JFR, UL and event system\n+      Method* tm = trap_method();\n+      char* name_sig = tm->name_and_sig_as_C_string();\n+      const char* reason_name = Deoptimization::trap_reason_name(reason);\n+      const char* reason_action = Deoptimization::trap_action_name(action);\n+      JFR_ONLY(post_deoptimization_event(nm, tm, trap_bci, trap_bc, reason, action);)\n+      log_debug(deoptimization)(\"cid: %d osr: %s level: %d %s @ %d %s -> %s\",\n+                                nm->compile_id(),\n+                                (nm->is_osr_method() ? \"true\" : \"false\"),\n+                                nm->comp_level(),\n+                                name_sig,\n+                                trap_bci,\n+                                reason_name,\n+                                reason_action);\n+\n+      \/\/ Log a message\n+      Events::log_deopt_message(current, \"Uncommon trap: reason=%s action=%s pc=\" INTPTR_FORMAT \" method=%s @ %d %s\",\n+                                reason_name, reason_action, p2i(fr.pc()),\n+                                name_sig, trap_bci, nm->compiler_name());\n+    }\n","filename":"src\/hotspot\/share\/runtime\/deoptimization.cpp","additions":23,"deletions":6,"binary":false,"changes":29,"status":"modified"}]}