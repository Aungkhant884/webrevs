{"files":[{"patch":"@@ -817,4 +817,2 @@\n-                        \/\/ padding is added to data in padBuffer\n-                        \/\/ unless padBuffer is already full in which case\n-                        \/\/ EncryptUpdate is performed and whole new padding\n-                        \/\/ block is created\n+                        \/\/ call C_EncryptUpdate first if the padBuffer is full\n+                        \/\/ to make room for padding bytes\n@@ -822,1 +820,1 @@\n-                            k += token.p11.C_EncryptUpdate(session.id(),\n+                            k = token.p11.C_EncryptUpdate(session.id(),\n@@ -915,4 +913,2 @@\n-                        \/\/ padding is added to data in padBuffer\n-                        \/\/ unless padBuffer is already full in which case\n-                        \/\/ EncryptUpdate is performed and whole new padding\n-                        \/\/ block is created\n+                        \/\/ call C_EncryptUpdate first if the padBuffer is full\n+                        \/\/ to make room for padding bytes\n@@ -920,1 +916,1 @@\n-                            k += token.p11.C_EncryptUpdate(session.id(),\n+                            k = token.p11.C_EncryptUpdate(session.id(),\n","filename":"src\/jdk.crypto.cryptoki\/share\/classes\/sun\/security\/pkcs11\/P11Cipher.java","additions":6,"deletions":10,"binary":false,"changes":16,"status":"modified"},{"patch":"@@ -27,1 +27,1 @@\n- * @summary P11Cipher should not throw OOB exception during padding\n+ * @summary P11Cipher should not throw OOB exception during padding when \"reqBlockUpdates\" == true\n@@ -61,1 +61,1 @@\n-            throw new Exception(\"Unexpected encrypted size (array)\");\n+            throw new Exception(\"Unexpected encrypted size (array): \" + off);\n@@ -67,1 +67,1 @@\n-            throw new Exception(\"Unexpected decrypted size (array)\");\n+            throw new Exception(\"Unexpected decrypted size (array): \" + off);\n@@ -85,1 +85,1 @@\n-            throw new Exception(\"Unexpected encrypted size (buffer)\");\n+            throw new Exception(\"Unexpected encrypted size (buffer): \" + off);\n@@ -92,1 +92,1 @@\n-            throw new Exception(\"Unexpected decrypted size (buffer)\");\n+            throw new Exception(\"Unexpected decrypted size (buffer): \" + off);\n","filename":"test\/jdk\/sun\/security\/pkcs11\/Cipher\/TestPaddingOOB.java","additions":5,"deletions":5,"binary":false,"changes":10,"status":"modified"}]}