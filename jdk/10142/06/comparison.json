{"files":[{"patch":"@@ -380,1 +380,1 @@\n-  const char* name = _masm->code_string(ss.as_string());\n+  const char* name = _masm->code_string(ss.freeze());\n","filename":"src\/hotspot\/cpu\/x86\/upcallLinker_x86_64.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -143,1 +143,1 @@\n-    CFGPrinter::print_cfg(_bci2block, title.as_string(), false, false);\n+    CFGPrinter::print_cfg(_bci2block, title.freeze(), false, false);\n","filename":"src\/hotspot\/share\/c1\/c1_GraphBuilder.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -978,1 +978,1 @@\n-  ss.print(\"Assertion %s %s %s in method %s\", strStream1.as_string(), ip2.cond_name(cond), strStream2.as_string(), strStream.as_string());\n+  ss.print(\"Assertion %s %s %s in method %s\", strStream1.freeze(), ip2.cond_name(cond), strStream2.freeze(), strStream.freeze());\n","filename":"src\/hotspot\/share\/c1\/c1_Instruction.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -150,1 +150,1 @@\n-      _masm->block_comment(st.as_string());\n+      _masm->block_comment(st.freeze());\n@@ -265,1 +265,1 @@\n-    _masm->block_comment(st.as_string());\n+    _masm->block_comment(st.freeze());\n@@ -295,1 +295,1 @@\n-        _masm->block_comment(st.as_string());\n+        _masm->block_comment(st.freeze());\n","filename":"src\/hotspot\/share\/c1\/c1_LIRAssembler.cpp","additions":3,"deletions":3,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -556,1 +556,1 @@\n-    ResourceMark rm;\n+    ResourceMark rm; \/\/ print_value_string\n@@ -562,1 +562,1 @@\n-    Exceptions::log_exception(exception, tempst.as_string());\n+    Exceptions::log_exception(exception, tempst.freeze());\n@@ -1466,1 +1466,1 @@\n-    tty->print_cr(\"Predicate failed trap in method %s at bci %d inlined in %s at pc \" INTPTR_FORMAT, ss1.as_string(), vfst.bci(), ss2.as_string(), p2i(caller_frame.pc()));\n+    tty->print_cr(\"Predicate failed trap in method %s at bci %d inlined in %s at pc \" INTPTR_FORMAT, ss1.freeze(), vfst.bci(), ss2.freeze(), p2i(caller_frame.pc()));\n","filename":"src\/hotspot\/share\/c1\/c1_Runtime1.cpp","additions":3,"deletions":3,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -442,1 +442,1 @@\n-    ResourceMark rm;\n+    ResourceMark rm; \/\/ loader_name_and_id\n@@ -445,1 +445,1 @@\n-    cld->dictionary()->print_table_statistics(st, tempst.as_string());\n+    cld->dictionary()->print_table_statistics(st, tempst.freeze());\n","filename":"src\/hotspot\/share\/classfile\/classLoaderDataGraph.cpp","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -1501,1 +1501,0 @@\n-    ResourceMark rm;\n@@ -1510,1 +1509,1 @@\n-      tty->print(\"%s\", s.as_string());\n+      tty->print(\"%s\", s.freeze());\n","filename":"src\/hotspot\/share\/code\/codeCache.cpp","additions":1,"deletions":2,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -550,1 +550,0 @@\n-  ResourceMark rm;\n@@ -556,1 +555,1 @@\n-    tty->print(\"%s\", ss.as_string());\n+    tty->print(\"%s\", ss.freeze());\n@@ -2026,1 +2025,0 @@\n-  ResourceMark rm;\n@@ -2034,1 +2032,1 @@\n-  tty->print(\"%s\", s.as_string());\n+  tty->print(\"%s\", s.freeze());\n@@ -2039,1 +2037,0 @@\n-  ResourceMark rm;\n@@ -2354,1 +2351,0 @@\n-      ResourceMark rm;\n@@ -2362,1 +2358,1 @@\n-      xtty->print(\"%s\", s.as_string());\n+      xtty->print(\"%s\", s.freeze());\n","filename":"src\/hotspot\/share\/compiler\/compileBroker.cpp","additions":3,"deletions":7,"binary":false,"changes":10,"status":"modified"},{"patch":"@@ -51,1 +51,1 @@\n-    msg.append(\"Raw heap memory:\\n%s\", ss.as_string());\n+    msg.append(\"Raw heap memory:\\n%s\", ss.freeze());\n@@ -74,2 +74,2 @@\n-  msg.append(\"  mark:%s\\n\", mw_ss.as_string());\n-  msg.append(\"  region: %s\", ss.as_string());\n+  msg.append(\"  mark:%s\\n\", mw_ss.freeze());\n+  msg.append(\"  region: %s\", ss.freeze());\n@@ -87,1 +87,1 @@\n-    msg.append(\"  region: %s\", ss.as_string());\n+    msg.append(\"  region: %s\", ss.freeze());\n@@ -92,1 +92,1 @@\n-    msg.append(\"  %s\", ss.as_string());\n+    msg.append(\"  %s\", ss.freeze());\n@@ -104,1 +104,1 @@\n-      msg.append(\"  region: %s\", ss.as_string());\n+      msg.append(\"  region: %s\", ss.freeze());\n","filename":"src\/hotspot\/share\/gc\/shenandoah\/shenandoahAsserts.cpp","additions":6,"deletions":6,"binary":false,"changes":12,"status":"modified"},{"patch":"@@ -80,1 +80,0 @@\n-  ResourceMark rm;\n@@ -84,1 +83,1 @@\n-  fatal(\"%s\", ss.as_string());\n+  fatal(\"%s\", ss.freeze());\n","filename":"src\/hotspot\/share\/gc\/shenandoah\/shenandoahHeapRegion.cpp","additions":1,"deletions":2,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -253,1 +253,1 @@\n-          oops->length(), _oops_count, count, p2i(nm()->oops_begin()), p2i(nm()->oops_end()), debug_stream.as_string());\n+          oops->length(), _oops_count, count, p2i(nm()->oops_begin()), p2i(nm()->oops_end()), debug_stream.freeze());\n","filename":"src\/hotspot\/share\/gc\/shenandoah\/shenandoahNMethod.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -768,1 +768,0 @@\n-        ResourceMark rm;\n@@ -772,1 +771,1 @@\n-              label, reg_live, verf_live, ss.as_string());\n+              label, reg_live, verf_live, ss.freeze());\n","filename":"src\/hotspot\/share\/gc\/shenandoah\/shenandoahVerifier.cpp","additions":1,"deletions":2,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -966,1 +966,1 @@\n-    tty->print_raw_cr(s.as_string());\n+    tty->print_raw_cr(s.freeze());\n","filename":"src\/hotspot\/share\/jvmci\/jvmciCompilerToVM.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -251,1 +251,1 @@\n-              fatal(\"unexpected comparison %s\", ss.as_string());\n+              fatal(\"unexpected comparison %s\", ss.freeze());\n","filename":"src\/hotspot\/share\/opto\/castnode.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -4502,1 +4502,1 @@\n-      ss.print(\"%s\", pib->ss()->as_string());\n+      ss.print(\"%s\", pib->ss()->freeze());\n@@ -4513,1 +4513,1 @@\n-    strncpy(_print_inlining_output, ss.base(), end+1);\n+    strncpy(_print_inlining_output, ss.freeze(), end+1);\n","filename":"src\/hotspot\/share\/opto\/compile.cpp","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -494,1 +494,1 @@\n-    print_inlining_stream()->print(\"%s\", ss.as_string());\n+    print_inlining_stream()->print(\"%s\", ss.freeze());\n","filename":"src\/hotspot\/share\/opto\/compile.hpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -65,1 +65,1 @@\n-    out->print(\"%s\", ss.as_string());\n+    out->print(\"%s\", ss.freeze());\n","filename":"src\/hotspot\/share\/opto\/doCall.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -204,1 +204,1 @@\n-  print_attr(name, stream.as_string());\n+  print_attr(name, stream.freeze());\n@@ -228,1 +228,1 @@\n-  print_prop(name, stream.as_string());\n+  print_prop(name, stream.freeze());\n@@ -248,2 +248,2 @@\n-  print_attr(METHOD_NAME_PROPERTY, str.as_string());\n-  print_attr(METHOD_SHORT_NAME_PROPERTY, shortStr.as_string());\n+  print_attr(METHOD_NAME_PROPERTY, str.freeze());\n+  print_attr(METHOD_SHORT_NAME_PROPERTY, shortStr.freeze());\n@@ -308,1 +308,1 @@\n-  print_prop(METHOD_NAME_PROPERTY, strStream.as_string());\n+  print_prop(METHOD_NAME_PROPERTY, strStream.freeze());\n@@ -321,1 +321,1 @@\n-      print_prop(COMPILATION_OSR_PROPERTY, ss.as_string());\n+      print_prop(COMPILATION_OSR_PROPERTY, ss.freeze());\n@@ -604,1 +604,1 @@\n-      print_prop(\"bci\", bciStream.as_string());\n+      print_prop(\"bci\", bciStream.freeze());\n@@ -614,1 +614,1 @@\n-      print_prop(\"debug_orig\", dorigStream.as_string());\n+      print_prop(\"debug_orig\", dorigStream.freeze());\n","filename":"src\/hotspot\/share\/opto\/idealGraphPrinter.cpp","additions":8,"deletions":8,"binary":false,"changes":16,"status":"modified"},{"patch":"@@ -157,1 +157,1 @@\n-    const char *msg = msg_stream.as_string();\n+    const char *msg = msg_stream.freeze();\n@@ -218,1 +218,1 @@\n-    const char *msg = msg_stream.as_string();\n+    const char *msg = msg_stream.freeze();\n","filename":"src\/hotspot\/share\/opto\/library_call.cpp","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -1475,1 +1475,1 @@\n-      MacroAssembler(cb).block_comment(st.as_string());\n+      MacroAssembler(cb).block_comment(st.freeze());\n@@ -1928,1 +1928,1 @@\n-        tty->print_raw(method_metadata_str.as_string());\n+        tty->print_raw(method_metadata_str.freeze());\n@@ -1934,1 +1934,1 @@\n-      tty->print_raw(dump_asm_str.as_string());\n+      tty->print_raw(dump_asm_str.freeze());\n","filename":"src\/hotspot\/share\/opto\/output.cpp","additions":3,"deletions":3,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -1723,1 +1723,1 @@\n-    c = new RTMLockingNamedCounter(st.as_string());\n+    c = new RTMLockingNamedCounter(st.freeze());\n@@ -1725,1 +1725,1 @@\n-    c = new NamedCounter(st.as_string(), tag);\n+    c = new NamedCounter(st.freeze(), tag);\n@@ -1759,1 +1759,1 @@\n-  st->print_raw_cr(tempst.as_string());\n+  st->print_raw_cr(tempst.freeze());\n","filename":"src\/hotspot\/share\/opto\/runtime.cpp","additions":3,"deletions":3,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -185,1 +185,1 @@\n-    assert(false, \"expected 'object' value for scalar-replaced boxed vector but got: %s\", ss.as_string());\n+    assert(false, \"expected 'object' value for scalar-replaced boxed vector but got: %s\", ss.freeze());\n","filename":"src\/hotspot\/share\/prims\/vectorSupport.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -2465,1 +2465,1 @@\n-    tty->print_raw(st.as_string());\n+    tty->print_raw(st.freeze());\n","filename":"src\/hotspot\/share\/prims\/whitebox.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -164,1 +164,1 @@\n-  tty->print_raw(st.as_string());\n+  tty->print_raw(st.freeze());\n@@ -217,1 +217,1 @@\n-  tty->print_raw(st.as_string());\n+  tty->print_raw(st.freeze());\n@@ -324,1 +324,1 @@\n-        tty->print_raw(st.as_string());\n+        tty->print_raw(st.freeze());\n@@ -1585,1 +1585,1 @@\n-    tty->print_raw(st.as_string());\n+    tty->print_raw(st.freeze());\n@@ -2066,1 +2066,1 @@\n-        tty->print_raw(st.as_string());\n+        tty->print_raw(st.freeze());\n","filename":"src\/hotspot\/share\/runtime\/deoptimization.cpp","additions":5,"deletions":5,"binary":false,"changes":10,"status":"modified"},{"patch":"@@ -595,1 +595,1 @@\n-    tty->print_raw(st.as_string());\n+    tty->print_raw(st.freeze());\n@@ -633,1 +633,1 @@\n-      tty->print_raw(st.as_string());\n+      tty->print_raw(st.freeze());\n","filename":"src\/hotspot\/share\/runtime\/vframeArray.cpp","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -361,0 +361,1 @@\n+  assert(_is_frozen == false, \"Modification forbidden\");\n@@ -400,0 +401,1 @@\n+  assert(_is_frozen == false, \"Modification forbidden\");\n","filename":"src\/hotspot\/share\/utilities\/ostream.cpp","additions":2,"deletions":0,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -31,0 +31,1 @@\n+#include \"utilities\/macros.hpp\"\n@@ -194,0 +195,1 @@\n+  DEBUG_ONLY(bool _is_frozen = false);\n@@ -218,0 +220,2 @@\n+  \/\/ Returns internal buffer containing the accumulated string.\n+  \/\/ Returned buffer is only guaranteed to be valid as long as stream is not modified\n@@ -219,0 +223,7 @@\n+  \/\/ Freezes stringStream (no further modifications possible) and returns pointer to it.\n+  \/\/ No-op if stream is frozen already.\n+  \/\/ Returns the internal buffer containing the accumulated string.\n+  const char* freeze() NOT_DEBUG(const) {\n+    DEBUG_ONLY(_is_frozen = true);\n+    return _buffer;\n+  };\n@@ -220,1 +231,1 @@\n-  \/\/ copy to a resource, or C-heap, array as requested\n+  \/\/ Copy to a resource, or C-heap, array as requested\n","filename":"src\/hotspot\/share\/utilities\/ostream.hpp","additions":12,"deletions":1,"binary":false,"changes":13,"status":"modified"}]}