{"files":[{"patch":"@@ -198,0 +198,3 @@\n+        salt = null;\n+        iCount = 0;\n+\n@@ -226,1 +229,2 @@\n-                \/\/ Try extracting from the key, if present\n+                \/\/ Try extracting from the key if present. If unspecified,\n+                \/\/ PBEKey returns null and 0 respectively.\n@@ -228,2 +232,2 @@\n-                    salt = check(pbeKey.getSalt()); \/\/ may be null\n-                    iCount = check(pbeKey.getIterationCount()); \/\/ may be 0\n+                    salt = check(pbeKey.getSalt());\n+                    iCount = check(pbeKey.getIterationCount());\n","filename":"src\/java.base\/share\/classes\/com\/sun\/crypto\/provider\/PBES2Core.java","additions":7,"deletions":3,"binary":false,"changes":10,"status":"modified"},{"patch":"@@ -169,1 +169,1 @@\n-        throws NoSuchAlgorithmException {\n+            throws NoSuchAlgorithmException {\n@@ -172,12 +172,7 @@\n-        if (algo.equals(\"RC4\")) {\n-            pbeAlgo = \"PBEWithSHA1AndRC4_\" + keySizeInBits;\n-        } else {\n-            if (algo.equals(\"DESede\")) {\n-                pbeAlgo = \"PBEWithSHA1AndDESede\";\n-            } else if (algo.equals(\"RC2\")) {\n-                pbeAlgo = \"PBEWithSHA1AndRC2_\" + keySizeInBits;\n-            } else {\n-                throw new NoSuchAlgorithmException(\"No Cipher implementation \" +\n-                       \"for PBEWithSHA1And\" + algo);\n-            }\n-        }\n+        pbeAlgo = switch (algo) {\n+            case \"RC4\" -> \"PBEWithSHA1AndRC4_\" + keySizeInBits;\n+            case \"DESede\" -> \"PBEWithSHA1AndDESede\";\n+            case \"RC2\" -> \"PBEWithSHA1AndRC2_\" + keySizeInBits;\n+            default -> throw new NoSuchAlgorithmException(\n+                   \"No Cipher implementation for PBEWithSHA1And\" + algo);\n+        };\n@@ -214,2 +209,2 @@\n-                  SecureRandom random, CipherSpi cipher)\n-        throws InvalidKeyException, InvalidAlgorithmParameterException {\n+                  SecureRandom random, CipherSpi cipherImpl)\n+            throws InvalidKeyException, InvalidAlgorithmParameterException {\n@@ -301,1 +296,1 @@\n-                if (cipher instanceof ARCFOURCipher rc4) {\n+                if (cipherImpl instanceof ARCFOURCipher rc4) {\n@@ -310,1 +305,1 @@\n-                    if (cipher instanceof RC2Cipher rc2) {\n+                    if (cipherImpl instanceof RC2Cipher rc2) {\n@@ -312,1 +307,1 @@\n-                    } else if (cipher instanceof DESedeCipher tripleDes) {\n+                    } else if (cipherImpl instanceof DESedeCipher tripleDes) {\n@@ -316,1 +311,1 @@\n-                                + cipher);\n+                                + cipherImpl);\n@@ -332,2 +327,2 @@\n-                  SecureRandom random, CipherSpi cipher)\n-        throws InvalidKeyException, InvalidAlgorithmParameterException {\n+                  SecureRandom random, CipherSpi cipherImpl)\n+            throws InvalidKeyException, InvalidAlgorithmParameterException {\n@@ -343,1 +338,1 @@\n-        implInit(opmode, key, paramSpec, random, cipher);\n+        implInit(opmode, key, paramSpec, random, cipherImpl);\n@@ -346,2 +341,3 @@\n-    void implInit(int opmode, Key key, SecureRandom random, CipherSpi cipher)\n-        throws InvalidKeyException {\n+    void implInit(int opmode, Key key, SecureRandom random,\n+                  CipherSpi cipherImpl)\n+            throws InvalidKeyException {\n@@ -350,1 +346,1 @@\n-                    cipher);\n+                    cipherImpl);\n@@ -375,1 +371,1 @@\n-            throws IllegalBlockSizeException, BadPaddingException {\n+                throws IllegalBlockSizeException, BadPaddingException {\n@@ -380,1 +376,1 @@\n-            throws ShortBufferException, IllegalBlockSizeException,\n+                throws ShortBufferException, IllegalBlockSizeException,\n@@ -402,1 +398,1 @@\n-            throws InvalidKeyException, InvalidAlgorithmParameterException {\n+                throws InvalidKeyException, InvalidAlgorithmParameterException {\n@@ -408,1 +404,1 @@\n-            throws InvalidKeyException, InvalidAlgorithmParameterException {\n+                throws InvalidKeyException, InvalidAlgorithmParameterException {\n@@ -412,1 +408,1 @@\n-            throws InvalidKeyException {\n+                throws InvalidKeyException {\n@@ -416,1 +412,1 @@\n-            throws NoSuchAlgorithmException {\n+                throws NoSuchAlgorithmException {\n@@ -422,1 +418,1 @@\n-            throws NoSuchPaddingException {\n+                throws NoSuchPaddingException {\n@@ -431,1 +427,1 @@\n-            throws InvalidKeyException, NoSuchAlgorithmException {\n+                throws InvalidKeyException, NoSuchAlgorithmException {\n@@ -440,1 +436,1 @@\n-            throws ShortBufferException {\n+                throws ShortBufferException {\n@@ -444,1 +440,1 @@\n-            throws IllegalBlockSizeException, InvalidKeyException {\n+                throws IllegalBlockSizeException, InvalidKeyException {\n@@ -464,1 +460,1 @@\n-            throws IllegalBlockSizeException, BadPaddingException {\n+                throws IllegalBlockSizeException, BadPaddingException {\n@@ -469,1 +465,1 @@\n-            throws ShortBufferException, IllegalBlockSizeException,\n+                throws ShortBufferException, IllegalBlockSizeException,\n@@ -491,1 +487,1 @@\n-            throws InvalidKeyException, InvalidAlgorithmParameterException {\n+                throws InvalidKeyException, InvalidAlgorithmParameterException {\n@@ -498,1 +494,1 @@\n-            throws InvalidKeyException, InvalidAlgorithmParameterException {\n+                throws InvalidKeyException, InvalidAlgorithmParameterException {\n@@ -502,1 +498,1 @@\n-            throws InvalidKeyException {\n+                throws InvalidKeyException {\n@@ -506,1 +502,1 @@\n-            throws NoSuchAlgorithmException {\n+                throws NoSuchAlgorithmException {\n@@ -512,1 +508,1 @@\n-            throws NoSuchPaddingException {\n+                throws NoSuchPaddingException {\n@@ -521,1 +517,1 @@\n-            throws InvalidKeyException, NoSuchAlgorithmException {\n+                throws InvalidKeyException, NoSuchAlgorithmException {\n@@ -530,1 +526,1 @@\n-            throws ShortBufferException {\n+                throws ShortBufferException {\n@@ -534,1 +530,1 @@\n-            throws IllegalBlockSizeException, InvalidKeyException {\n+                throws IllegalBlockSizeException, InvalidKeyException {\n@@ -560,1 +556,1 @@\n-            throws IllegalBlockSizeException, BadPaddingException {\n+                throws IllegalBlockSizeException, BadPaddingException {\n@@ -565,1 +561,1 @@\n-            throws ShortBufferException, IllegalBlockSizeException,\n+                throws ShortBufferException, IllegalBlockSizeException,\n@@ -587,1 +583,1 @@\n-            throws InvalidKeyException, InvalidAlgorithmParameterException {\n+                throws InvalidKeyException, InvalidAlgorithmParameterException {\n@@ -593,1 +589,1 @@\n-            throws InvalidKeyException, InvalidAlgorithmParameterException {\n+                throws InvalidKeyException, InvalidAlgorithmParameterException {\n@@ -597,1 +593,1 @@\n-            throws InvalidKeyException {\n+                throws InvalidKeyException {\n@@ -601,1 +597,1 @@\n-            throws NoSuchAlgorithmException {\n+                throws NoSuchAlgorithmException {\n@@ -607,1 +603,1 @@\n-            throws NoSuchPaddingException {\n+                throws NoSuchPaddingException {\n@@ -616,1 +612,1 @@\n-            throws InvalidKeyException, NoSuchAlgorithmException {\n+                throws InvalidKeyException, NoSuchAlgorithmException {\n@@ -625,1 +621,1 @@\n-            throws ShortBufferException {\n+                throws ShortBufferException {\n@@ -629,1 +625,1 @@\n-            throws IllegalBlockSizeException, InvalidKeyException {\n+                throws IllegalBlockSizeException, InvalidKeyException {\n","filename":"src\/java.base\/share\/classes\/com\/sun\/crypto\/provider\/PKCS12PBECipherCore.java","additions":51,"deletions":55,"binary":false,"changes":106,"status":"modified"}]}