{"files":[{"patch":"@@ -171,7 +171,2 @@\n-    private static class KeyAndIv implements Closeable {\n-        final SecretKey key;\n-        final IvParameterSpec iv;\n-        KeyAndIv(SecretKey key, IvParameterSpec iv) {\n-            this.key = key;\n-            this.iv = iv;\n-        }\n+    private record KeyAndIv(SecretKey key, IvParameterSpec iv)\n+            implements Closeable {\n@@ -317,13 +312,6 @@\n-            KeyAndIv result;\n-            switch (algo) {\n-                case \"RC4\":\n-                    result = new KeyAndIv(cipherKey, null);\n-                    break;\n-                case \"RC2\":\n-                case \"DESede\":\n-                    byte[] derivedIv = derive(passwdChars, salt, iCount, 8,\n-                            CIPHER_IV);\n-                    IvParameterSpec ivSpec = new IvParameterSpec(derivedIv);\n-                    result = new KeyAndIv(cipherKey, ivSpec);\n-                    break;\n-                default:\n+            return switch (algo) {\n+                case \"RC4\"-> new KeyAndIv(cipherKey, null);\n+                case \"RC2\", \"DESede\"-> new KeyAndIv(cipherKey,\n+                    new IvParameterSpec(derive(passwdChars, salt, iCount, 8,\n+                            CIPHER_IV)));\n+                default->\n@@ -332,2 +320,1 @@\n-            }\n-            return result;\n+            };\n@@ -382,1 +369,1 @@\n-                super.engineInit(opmode, derived.key, derived.iv, random);\n+                super.engineInit(opmode, derived.key(), derived.iv(), random);\n@@ -441,1 +428,1 @@\n-                super.engineInit(opmode, derived.key, derived.iv, random);\n+                super.engineInit(opmode, derived.key(), derived.iv(), random);\n@@ -509,1 +496,1 @@\n-                super.engineInit(opmode, derived.key, derived.iv, random);\n+                super.engineInit(opmode, derived.key(), derived.iv(), random);\n","filename":"src\/java.base\/share\/classes\/com\/sun\/crypto\/provider\/PKCS12PBECipherCore.java","additions":12,"deletions":25,"binary":false,"changes":37,"status":"modified"}]}