{"files":[{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2018, 2020, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2018, 2022, Oracle and\/or its affiliates. All rights reserved.\n@@ -617,1 +617,1 @@\n-        result.appendLine(\"public class \" + params.getClassName()\n+        result.appendLine(\"public final class \" + params.getClassName()\n","filename":"make\/jdk\/src\/classes\/build\/tools\/intpoly\/FieldGen.java","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 1997, 2021, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 1997, 2022, Oracle and\/or its affiliates. All rights reserved.\n@@ -57,1 +57,1 @@\n-public abstract class JavaKeyStore extends KeyStoreSpi {\n+public abstract sealed class JavaKeyStore extends KeyStoreSpi {\n","filename":"src\/java.base\/share\/classes\/sun\/security\/provider\/JavaKeyStore.java","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2000, 2021, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2000, 2022, Oracle and\/or its affiliates. All rights reserved.\n@@ -53,1 +53,1 @@\n-public abstract class Builder {\n+abstract class Builder {\n","filename":"src\/java.base\/share\/classes\/sun\/security\/provider\/certpath\/Builder.java","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2000, 2021, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2000, 2022, Oracle and\/or its affiliates. All rights reserved.\n@@ -62,1 +62,1 @@\n-class ForwardBuilder extends Builder {\n+final class ForwardBuilder extends Builder {\n","filename":"src\/java.base\/share\/classes\/sun\/security\/provider\/certpath\/ForwardBuilder.java","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2000, 2001, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2000, 2022, Oracle and\/or its affiliates. All rights reserved.\n@@ -50,1 +50,1 @@\n-public class SunCertPathBuilderResult extends PKIXCertPathBuilderResult {\n+public final class SunCertPathBuilderResult extends PKIXCertPathBuilderResult {\n","filename":"src\/java.base\/share\/classes\/sun\/security\/provider\/certpath\/SunCertPathBuilderResult.java","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2000, 2012, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2000, 2022, Oracle and\/or its affiliates. All rights reserved.\n@@ -49,1 +49,1 @@\n-public class Vertex {\n+final class Vertex {\n","filename":"src\/java.base\/share\/classes\/sun\/security\/provider\/certpath\/Vertex.java","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2003, 2020, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2003, 2022, Oracle and\/or its affiliates. All rights reserved.\n@@ -50,1 +50,1 @@\n-public abstract class RSAKeyPairGenerator extends KeyPairGeneratorSpi {\n+abstract class RSAKeyPairGenerator extends KeyPairGeneratorSpi {\n","filename":"src\/java.base\/share\/classes\/sun\/security\/rsa\/RSAKeyPairGenerator.java","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2003, 2020, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2003, 2022, Oracle and\/or its affiliates. All rights reserved.\n@@ -50,1 +50,1 @@\n-public abstract class RSASignature extends SignatureSpi {\n+abstract class RSASignature extends SignatureSpi {\n@@ -191,1 +191,1 @@\n-            byte[] encoded = encodeSignature(digestOID, digest);\n+            byte[] encoded = RSAUtil.encodeSignature(digestOID, digest);\n@@ -218,1 +218,1 @@\n-            byte[] decodedDigest = decodeSignature(digestOID, unpadded);\n+            byte[] decodedDigest = RSAUtil.decodeSignature(digestOID, unpadded);\n@@ -233,38 +233,0 @@\n-    \/**\n-     * Encode the digest, return the to-be-signed data.\n-     * Also used by the PKCS#11 provider.\n-     *\/\n-    public static byte[] encodeSignature(ObjectIdentifier oid, byte[] digest)\n-            throws IOException {\n-        DerOutputStream out = new DerOutputStream();\n-        new AlgorithmId(oid).encode(out);\n-        out.putOctetString(digest);\n-        DerValue result =\n-            new DerValue(DerValue.tag_Sequence, out.toByteArray());\n-        return result.toByteArray();\n-    }\n-\n-    \/**\n-     * Decode the signature data. Verify that the object identifier matches\n-     * and return the message digest.\n-     *\/\n-    public static byte[] decodeSignature(ObjectIdentifier oid, byte[] sig)\n-            throws IOException {\n-        \/\/ Enforce strict DER checking for signatures\n-        DerInputStream in = new DerInputStream(sig, 0, sig.length, false);\n-        DerValue[] values = in.getSequence(2);\n-        if ((values.length != 2) || (in.available() != 0)) {\n-            throw new IOException(\"SEQUENCE length error\");\n-        }\n-        AlgorithmId algId = AlgorithmId.parse(values[0]);\n-        if (algId.getOID().equals(oid) == false) {\n-            throw new IOException(\"ObjectIdentifier mismatch: \"\n-                + algId.getOID());\n-        }\n-        if (algId.getEncodedParams() != null) {\n-            throw new IOException(\"Unexpected AlgorithmId parameters\");\n-        }\n-        byte[] digest = values[1].getOctetString();\n-        return digest;\n-    }\n-\n","filename":"src\/java.base\/share\/classes\/sun\/security\/rsa\/RSASignature.java","additions":4,"deletions":42,"binary":false,"changes":46,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2018, 2021, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2018, 2022, Oracle and\/or its affiliates. All rights reserved.\n@@ -28,0 +28,1 @@\n+import java.io.IOException;\n@@ -30,0 +31,3 @@\n+import sun.security.util.DerInputStream;\n+import sun.security.util.DerOutputStream;\n+import sun.security.util.DerValue;\n@@ -164,0 +168,38 @@\n+\n+    \/**\n+     * Encode the digest, return the to-be-signed data.\n+     * Also used by the PKCS#11 provider.\n+     *\/\n+    public static byte[] encodeSignature(ObjectIdentifier oid, byte[] digest)\n+            throws IOException {\n+        DerOutputStream out = new DerOutputStream();\n+        new AlgorithmId(oid).encode(out);\n+        out.putOctetString(digest);\n+        DerValue result =\n+            new DerValue(DerValue.tag_Sequence, out.toByteArray());\n+        return result.toByteArray();\n+    }\n+\n+    \/**\n+     * Decode the signature data. Verify that the object identifier matches\n+     * and return the message digest.\n+     *\/\n+    public static byte[] decodeSignature(ObjectIdentifier oid, byte[] sig)\n+            throws IOException {\n+        \/\/ Enforce strict DER checking for signatures\n+        DerInputStream in = new DerInputStream(sig, 0, sig.length, false);\n+        DerValue[] values = in.getSequence(2);\n+        if ((values.length != 2) || (in.available() != 0)) {\n+            throw new IOException(\"SEQUENCE length error\");\n+        }\n+        AlgorithmId algId = AlgorithmId.parse(values[0]);\n+        if (algId.getOID().equals(oid) == false) {\n+            throw new IOException(\"ObjectIdentifier mismatch: \"\n+                + algId.getOID());\n+        }\n+        if (algId.getEncodedParams() != null) {\n+            throw new IOException(\"Unexpected AlgorithmId parameters\");\n+        }\n+        byte[] digest = values[1].getOctetString();\n+        return digest;\n+    }\n","filename":"src\/java.base\/share\/classes\/sun\/security\/rsa\/RSAUtil.java","additions":43,"deletions":1,"binary":false,"changes":44,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2003, 2020, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2003, 2022, Oracle and\/or its affiliates. All rights reserved.\n@@ -102,1 +102,1 @@\n-public class TSResponse {\n+public final class TSResponse {\n","filename":"src\/java.base\/share\/classes\/sun\/security\/timestamp\/TSResponse.java","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2018, 2020, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2018, 2022, Oracle and\/or its affiliates. All rights reserved.\n@@ -64,1 +64,8 @@\n-public abstract class IntegerPolynomial implements IntegerFieldModuloP {\n+public abstract sealed class IntegerPolynomial implements IntegerFieldModuloP\n+    permits IntegerPolynomial1305, IntegerPolynomial25519,\n+            IntegerPolynomial448, IntegerPolynomialP256,\n+            IntegerPolynomialP384, IntegerPolynomialP521,\n+            IntegerPolynomialModBinP, P256OrderField,\n+            P384OrderField, P521OrderField,\n+            sun.security.util.math.intpoly.Curve25519OrderField,\n+            sun.security.util.math.intpoly.Curve448OrderField {\n","filename":"src\/java.base\/share\/classes\/sun\/security\/util\/math\/intpoly\/IntegerPolynomial.java","additions":9,"deletions":2,"binary":false,"changes":11,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2018, 2020, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2018, 2022, Oracle and\/or its affiliates. All rights reserved.\n@@ -38,1 +38,1 @@\n-public class IntegerPolynomial1305 extends IntegerPolynomial {\n+public final class IntegerPolynomial1305 extends IntegerPolynomial {\n","filename":"src\/java.base\/share\/classes\/sun\/security\/util\/math\/intpoly\/IntegerPolynomial1305.java","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2018, 2020, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2018, 2022, Oracle and\/or its affiliates. All rights reserved.\n@@ -35,1 +35,1 @@\n-public class IntegerPolynomial25519 extends IntegerPolynomial {\n+public final class IntegerPolynomial25519 extends IntegerPolynomial {\n","filename":"src\/java.base\/share\/classes\/sun\/security\/util\/math\/intpoly\/IntegerPolynomial25519.java","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2018, 2020, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2018, 2022, Oracle and\/or its affiliates. All rights reserved.\n@@ -35,1 +35,1 @@\n-public class IntegerPolynomial448 extends IntegerPolynomial {\n+public final class IntegerPolynomial448 extends IntegerPolynomial {\n","filename":"src\/java.base\/share\/classes\/sun\/security\/util\/math\/intpoly\/IntegerPolynomial448.java","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2020, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2020, 2022, Oracle and\/or its affiliates. All rights reserved.\n@@ -41,1 +41,1 @@\n-public class IntegerPolynomialModBinP extends IntegerPolynomial {\n+public sealed class IntegerPolynomialModBinP extends IntegerPolynomial {\n@@ -209,1 +209,1 @@\n-    public static class Curve25519OrderField extends IntegerPolynomialModBinP {\n+    public final static class Curve25519OrderField extends IntegerPolynomialModBinP {\n@@ -220,1 +220,1 @@\n-    public static class Curve448OrderField extends IntegerPolynomialModBinP {\n+    public final static class Curve448OrderField extends IntegerPolynomialModBinP {\n","filename":"src\/java.base\/share\/classes\/sun\/security\/util\/math\/intpoly\/IntegerPolynomialModBinP.java","additions":4,"deletions":4,"binary":false,"changes":8,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2002, 2021, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2002, 2022, Oracle and\/or its affiliates. All rights reserved.\n@@ -86,1 +86,1 @@\n-public abstract class Validator {\n+public abstract sealed class Validator permits PKIXValidator, SimpleValidator {\n","filename":"src\/java.base\/share\/classes\/sun\/security\/validator\/Validator.java","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2009, 2018, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2009, 2022, Oracle and\/or its affiliates. All rights reserved.\n@@ -33,1 +33,2 @@\n-public class GSSCaller {\n+public sealed class GSSCaller permits HttpCaller {\n+\n","filename":"src\/java.security.jgss\/share\/classes\/sun\/security\/jgss\/GSSCaller.java","additions":3,"deletions":2,"binary":false,"changes":5,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2000, 2020, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2000, 2022, Oracle and\/or its affiliates. All rights reserved.\n@@ -83,1 +83,1 @@\n-public class GSSNameImpl implements GSSName {\n+public final class GSSNameImpl implements GSSName {\n","filename":"src\/java.security.jgss\/share\/classes\/sun\/security\/jgss\/GSSNameImpl.java","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2009, 2012, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2009, 2022, Oracle and\/or its affiliates. All rights reserved.\n@@ -34,1 +34,1 @@\n-public class HttpCaller extends GSSCaller {\n+public final class HttpCaller extends GSSCaller {\n","filename":"src\/java.security.jgss\/share\/classes\/sun\/security\/jgss\/HttpCaller.java","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2012, 2021, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2012, 2022, Oracle and\/or its affiliates. All rights reserved.\n@@ -48,1 +48,1 @@\n-public class Krb5ProxyCredential\n+final class Krb5ProxyCredential\n","filename":"src\/java.security.jgss\/share\/classes\/sun\/security\/jgss\/krb5\/Krb5ProxyCredential.java","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2000, 2021, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2000, 2022, Oracle and\/or its affiliates. All rights reserved.\n@@ -43,1 +43,1 @@\n-public class KrbTgsRep extends KrbKdcRep {\n+final class KrbTgsRep extends KrbKdcRep {\n@@ -124,1 +124,1 @@\n-    public Credentials getCreds() {\n+    Credentials getCreds() {\n","filename":"src\/java.security.jgss\/share\/classes\/sun\/security\/krb5\/KrbTgsRep.java","additions":3,"deletions":3,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2003, 2021, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2003, 2022, Oracle and\/or its affiliates. All rights reserved.\n@@ -40,1 +40,1 @@\n-import sun.security.rsa.RSASignature;\n+import sun.security.rsa.RSAUtil;\n@@ -769,1 +769,1 @@\n-            return RSASignature.encodeSignature(digestOID, digest);\n+            return RSAUtil.encodeSignature(digestOID, digest);\n","filename":"src\/jdk.crypto.cryptoki\/share\/classes\/sun\/security\/pkcs11\/P11Signature.java","additions":3,"deletions":3,"binary":false,"changes":6,"status":"modified"}]}