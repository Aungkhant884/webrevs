{"files":[{"patch":"@@ -820,2 +820,13 @@\n-    AC_MSG_CHECKING([for binutils to use with hsdis])\n-    if test \"x$BINUTILS_DIR\" != x; then\n+    if test \"x$BINUTILS_DIR\" = xsystem; then\n+      if test \"x$OPENJDK_TARGET_OS\" != xlinux; then\n+        AC_MSG_CHECKING([for binutils to use with hsdis])\n+        AC_MSG_RESULT([invalid])\n+        AC_MSG_ERROR([binutils on system is supported for Linux only])\n+      fi\n+      AC_CHECK_LIB(bfd, bfd_openr, [ HSDIS_LIBS=\"$HSDIS_LIBS -lbfd\" ], [ AC_MSG_ERROR([libbfd not found]) ])\n+      AC_CHECK_LIB(opcodes, disassembler, [ HSDIS_LIBS=\"$HSDIS_LIBS -lopcodes\" ], [ AC_MSG_ERROR([libopcodes not found]) ])\n+      AC_CHECK_LIB(iberty, xmalloc, [ HSDIS_LIBS=\"$HSDIS_LIBS -liberty\" ], [ AC_MSG_ERROR([libiberty not found]) ])\n+      AC_CHECK_LIB(z, deflate, [ HSDIS_LIBS=\"$HSDIS_LIBS -lz\" ], [ AC_MSG_ERROR([libz not found]) ])\n+      HSDIS_CFLAGS=\"-DSYSTEM_BINUTILS\"\n+    elif test \"x$BINUTILS_DIR\" != x; then\n+      AC_MSG_CHECKING([for binutils to use with hsdis])\n@@ -833,0 +844,1 @@\n+      AC_MSG_CHECKING([for binutils to use with hsdis])\n","filename":"make\/autoconf\/jdk-options.m4","additions":14,"deletions":2,"binary":false,"changes":16,"status":"modified"},{"patch":"@@ -70,0 +70,4 @@\n+If you want to build hsdis with binutils provided by system\n+(e.g. binutils-devel from Fedora, binutils-dev from Ubuntu), you can pass\n+\"--with-binutils=system\". \"system\" is available on Linux only.\n+\n","filename":"src\/utils\/hsdis\/README","additions":4,"deletions":0,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2008, 2020, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2008, 2021, Oracle and\/or its affiliates. All rights reserved.\n@@ -52,0 +52,1 @@\n+#ifndef SYSTEM_BINUTILS\n@@ -53,0 +54,2 @@\n+#endif\n+\n@@ -59,1 +62,0 @@\n-#include <bfdver.h>\n@@ -568,1 +570,1 @@\n-#if BFD_VERSION >= 234000000\n+#ifdef SEC_ELF_OCTETS\n","filename":"src\/utils\/hsdis\/hsdis.c","additions":5,"deletions":3,"binary":false,"changes":8,"status":"modified"}]}