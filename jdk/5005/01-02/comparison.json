{"files":[{"patch":"@@ -1563,0 +1563,9 @@\n+    case Op_CopySignD:\n+    case Op_CopySignF:\n+      if (UseAVX < 3)  {\n+        return false;\n+      }\n+      if (!VM_Version::supports_avx512vl()) {\n+        return false;\n+      }\n+      break;\n@@ -1684,9 +1693,0 @@\n-    case Op_CopySignD:\n-    case Op_CopySignF:\n-      if (UseAVX < 3)  {\n-        return false;\n-      }\n-      if (!VM_Version::supports_avx512vl()) {\n-        return false;\n-      }\n-      break;\n@@ -5785,1 +5785,1 @@\n-\/\/ --------------------------------- Signum ---------------------------\n+\/\/ --------------------------------- Signum\/CopySign ---------------------------\n@@ -5809,0 +5809,19 @@\n+\/\/ ---------------------------------------\n+\/\/ For copySign use 0xE4 as writemask for vpternlog\n+\/\/ Desired Truth Table: A -> xmm0 bit, B -> xmm1 bit, C -> xmm2 bit\n+\/\/ Wherever xmm2 is 0, we want to pick from B (sign)\n+\/\/ Wherever xmm2 is 1, we want to pick from A (src)\n+\/\/\n+\/\/ A B C Result\n+\/\/ 0 0 0 0\n+\/\/ 0 0 1 0\n+\/\/ 0 1 0 1\n+\/\/ 0 1 1 0\n+\/\/ 1 0 0 0\n+\/\/ 1 0 1 1\n+\/\/ 1 1 0 1\n+\/\/ 1 1 1 1\n+\/\/\n+\/\/ Result going from high bit to low bit is 0x11100100 = 0xe4\n+\/\/ ---------------------------------------\n+\n@@ -5810,1 +5829,1 @@\n-instruct copySignF_reg(regF dst, regF src, regF tmp1, rRegL tmp2) %{\n+instruct copySignF_reg(regF dst, regF src, regF tmp1, rRegI tmp2) %{\n@@ -5814,1 +5833,1 @@\n-  format %{ \"CopySignF $dst, $src\" %}\n+  format %{ \"CopySignF $dst, $src\\t! using $tmp1 and $tmp2 as TEMP\" %}\n@@ -5828,1 +5847,1 @@\n-  format %{ \"CopySignD $dst, $src\" %}\n+  format %{ \"CopySignD  $dst, $src\\t! using $tmp1 and $tmp2 as TEMP\" %}\n@@ -5842,1 +5861,1 @@\n-  format %{ \"CopySignD $dst, $src\" %}\n+  format %{ \"CopySignD  $dst, $src\\t! using $tmp1 and $tmp2 as TEMP\" %}\n","filename":"src\/hotspot\/cpu\/x86\/x86.ad","additions":33,"deletions":14,"binary":false,"changes":47,"status":"modified"}]}