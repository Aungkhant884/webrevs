{"files":[{"patch":"@@ -38,1 +38,0 @@\n-com\/sun\/jdi\/StepTest.java 8285422 generic-all\n","filename":"test\/jdk\/ProblemList-Virtual.txt","additions":0,"deletions":1,"binary":false,"changes":1,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 1999, 2015, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 1999, 2023, Oracle and\/or its affiliates. All rights reserved.\n@@ -102,0 +102,1 @@\n+    String debuggeeClassName;\n@@ -113,0 +114,1 @@\n+        debuggeeClassName = args[3];\n@@ -126,1 +128,1 @@\n-        StepEvent stepEvent = stepIntoLine(thread);\n+        System.out.println(\"\\n\\n-------Running test for class: \" + debuggeeClassName);\n@@ -128,4 +130,1 @@\n-        String className = thread.frame(0).location().declaringType().name();\n-        System.out.println(\"\\n\\n-------Running test for class: \" + className);\n-\n-        BreakpointEvent bpEvent = resumeTo(className, \"go\", \"()V\");\n+        BreakpointEvent bpEvent = resumeTo(debuggeeClassName, \"go\", \"()V\");\n@@ -134,0 +133,7 @@\n+        int numFrames = thread.frameCount();\n+\n+        \/\/ maxDepth is based on the assumption that there are just two frames when we\n+        \/\/ enter the go() method. When using the virtual thread wrapper, there are many\n+        \/\/ more than that. So we need to adjust maxDepth. If we aren't using the virtual\n+        \/\/ thread wrapper, then this adjustment becomes a no-op because numFrames == 2.\n+        maxDepth = maxDepth - 2 + numFrames;\n@@ -135,0 +141,1 @@\n+            StepEvent stepEvent;\n@@ -148,1 +155,1 @@\n-            System.out.println(\"Step #\" + (i+1) + \"complete at \" +\n+            System.out.println(\"Step #\" + (i+1) + \" complete at \" +\n@@ -153,1 +160,1 @@\n-            if (thread.frameCount() < 2) {\n+            if (thread.frameCount() < numFrames) {\n@@ -166,1 +173,1 @@\n-        if (thread.frameCount() > 2) {\n+        if (thread.frameCount() > numFrames) {\n@@ -175,1 +182,1 @@\n-        if (thread.frameCount() != 1) {\n+        if (thread.frameCount() != numFrames - 1) {\n","filename":"test\/jdk\/com\/sun\/jdi\/StepTest.java","additions":17,"deletions":10,"binary":false,"changes":27,"status":"modified"}]}