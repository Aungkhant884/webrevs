{"files":[{"patch":"@@ -66,1 +66,0 @@\n-import java.util.concurrent.locks.ReentrantLock;\n@@ -99,1 +98,0 @@\n-    private final ReentrantLock idleConnectionLock = new ReentrantLock();\n@@ -968,2 +966,1 @@\n-        idleConnectionLock.lock();\n-        try {\n+        synchronized(idleConnections) {\n@@ -972,1 +969,1 @@\n-                \/\/ instead set boolean and close outside of lock\n+                \/\/ instead set boolean and close outside the synchronized block\n@@ -979,2 +976,0 @@\n-        } finally {\n-            idleConnectionLock.unlock();\n","filename":"src\/jdk.httpserver\/share\/classes\/sun\/net\/httpserver\/ServerImpl.java","additions":2,"deletions":7,"binary":false,"changes":9,"status":"modified"},{"patch":"@@ -36,0 +36,1 @@\n+import jdk.test.lib.net.URIBuilder;\n@@ -79,1 +80,0 @@\n-        final String host = server.getAddress().getHostString();\n@@ -85,1 +85,6 @@\n-                final URL requestURL = new URL(\"http:\/\/\" + host + \":\" + port + \"\/MaxIdleConnectionTest\/\" + i);\n+                URL requestURL = URIBuilder.newBuilder()\n+                        .scheme(\"http\")\n+                        .loopback()\n+                        .port(port)\n+                        .path(\"\/MaxIdleConnectionTest\/\" + i)\n+                        .toURL();\n@@ -129,2 +134,1 @@\n-            System.out.println(\"Request \" + exchange.getRequestURI()\n-                    + \" received; handler will wait on latch\");\n+            System.out.println(\"Request \" + exchange.getRequestURI() + \" received\");\n","filename":"test\/jdk\/com\/sun\/net\/httpserver\/bugs\/8300268\/MaxIdleConnectionsTest.java","additions":8,"deletions":4,"binary":false,"changes":12,"status":"modified"}]}