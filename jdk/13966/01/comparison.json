{"files":[{"patch":"@@ -144,2 +144,0 @@\n-vmTestbase\/nsk\/jdi\/ThreadReference\/stop\/stop001\/TestDescription.java 7034630 generic-all\n-\n","filename":"test\/hotspot\/jtreg\/ProblemList.txt","additions":0,"deletions":2,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2001, 2019, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2001, 2023, Oracle and\/or its affiliates. All rights reserved.\n@@ -72,0 +72,1 @@\n+    static final boolean vthreadMode = \"Virtual\".equals(System.getProperty(\"main.wrapper\"));\n@@ -183,1 +184,1 @@\n-                log3(\"ERROR: returned string is not 'checkready'\");\n+                log3(\"ERROR: returned string is not 'checkready': \" + line);\n@@ -236,1 +237,1 @@\n-\n+                boolean caughtExpected = false;\n@@ -248,2 +249,13 @@\n-                } catch ( Exception e2 ) {\n-                    log3(\"ERROR: unexpected exception: \" + e2);\n+                } catch ( IllegalThreadStateException e2 ) {\n+                    if (vthreadMode) {\n+                        caughtExpected = true;\n+                    } else {\n+                        log3(\"ERROR: unexpected exception: \" + e2);\n+                        expresult = returnCode1;\n+                    }\n+                } catch ( Exception e3 ) {\n+                    log3(\"ERROR: unexpected exception: \" + e3);\n+                    expresult = returnCode1;\n+                }\n+                if (vthreadMode && !caughtExpected) {\n+                    log3(\"ERROR: didn't catch expected IllegalThreadStateException\");\n@@ -259,7 +271,6 @@\n-                if (line.equals(\"null\")) {\n-                    log3(\"ERROR: 'stop001a.tObj = e1;' was not assigned\");\n-                    expresult = returnCode1;\n-                } else if (line.equals(\"equal\")) {\n-                } else if (line.equals(\"NOT_equal\")) {\n-                    log3(\"ERROR: in the debugee, e1 is not 'LineUnavailableException'\");\n-                    expresult = returnCode1;\n+                if (vthreadMode) {\n+                    \/\/ Because the stop() call failed, stop001a.tObj should be \"null\".\n+                    if (!line.equals(\"null\")) {\n+                        log3(\"ERROR: 'stop001a.tObj' is not 'null'\");\n+                        expresult = returnCode1;\n+                    }\n@@ -267,2 +278,11 @@\n-                    log3(\"ERROR: returned string is unexpected\");\n-                    expresult = returnCode4;\n+                    if (line.equals(\"null\")) {\n+                        log3(\"ERROR: 'stop001a.tObj = e1;' was not assigned\");\n+                        expresult = returnCode1;\n+                    } else if (line.equals(\"equal\")) {\n+                    } else if (line.equals(\"NOT_equal\")) {\n+                        log3(\"ERROR: in the debugee, e1 is not 'LineUnavailableException'\");\n+                        expresult = returnCode1;\n+                    } else {\n+                        log3(\"ERROR: returned string is unexpected\");\n+                        expresult = returnCode4;\n+                    }\n","filename":"test\/hotspot\/jtreg\/vmTestbase\/nsk\/jdi\/ThreadReference\/stop\/stop001.java","additions":34,"deletions":14,"binary":false,"changes":48,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2001, 2021, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2001, 2023, Oracle and\/or its affiliates. All rights reserved.\n@@ -192,0 +192,2 @@\n+    static final boolean vthreadMode = \"Virtual\".equals(System.getProperty(\"main.wrapper\"));\n+\n@@ -207,2 +209,4 @@\n-                logerr(\"ERROR:  normal exit from block:  synchronized (lockingObject)\");\n-                stop001a.exitCode = stop001a.FAILED;\n+                if (!vthreadMode) {\n+                    logerr(\"ERROR:  normal exit from block:  synchronized (lockingObject)\");\n+                    stop001a.exitCode = stop001a.FAILED;\n+                }\n@@ -210,2 +214,8 @@\n-                log(\"Exception: \" + e1.getMessage());\n-                stop001a.tObj = e1;\n+                if (vthreadMode) {\n+                    logerr(\"ERROR:  Unexpected exception: \" + e1);\n+                    stop001a.exitCode = stop001a.FAILED;\n+\n+                } else {\n+                    log(\"Exception: \" + e1.getMessage());\n+                    stop001a.tObj = e1;\n+                }\n","filename":"test\/hotspot\/jtreg\/vmTestbase\/nsk\/jdi\/ThreadReference\/stop\/stop001a.java","additions":15,"deletions":5,"binary":false,"changes":20,"status":"modified"}]}