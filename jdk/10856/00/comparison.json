{"files":[{"patch":"@@ -2009,4 +2009,4 @@\n-                    if (!uninits.isMember(sym.adr)) {\n-                        \/\/assignment targeting an effectively final variable\n-                        \/\/makes the variable lose its status of effectively final\n-                        \/\/if the variable is _not_ definitively unassigned\n+                    if (inits.isMember(sym.adr) || !uninits.isMember(sym.adr)) {\n+                        \/\/assignment targeting an effectively final variable makes the\n+                        \/\/variable lose its status of effectively final if the variable\n+                        \/\/is definitely assigned or _not_ definitively unassigned\n@@ -2014,2 +2014,0 @@\n-                    } else {\n-                        uninit(sym);\n@@ -2017,0 +2015,1 @@\n+                    uninit(sym);\n","filename":"src\/jdk.compiler\/share\/classes\/com\/sun\/tools\/javac\/comp\/Flow.java","additions":5,"deletions":6,"binary":false,"changes":11,"status":"modified"},{"patch":"@@ -0,0 +1,14 @@\n+\/*\n+ * @test \/nodynamiccopyright\/\n+ * @summary Verify for() loop variable not effectively final even if loop never increments\n+ * @bug 8294461\n+ * @compile\/fail\/ref=EffectivelyFinalLoopIncrement.out -XDrawDiagnostics EffectivelyFinalLoopIncrement.java\n+ *\/\n+class EffectivelyFinalLoopIncrement {\n+    EffectivelyFinalLoopIncrement() {\n+        for (int i = 0; i < 10; i++) {\n+            Runnable r = () -> System.out.println(i);   \/\/ variable i is NOT effectively final\n+            break;                                      \/\/ even though \"i++\" is never reached\n+        }\n+    }\n+}\n","filename":"test\/langtools\/tools\/javac\/lambda\/8294461\/EffectivelyFinalLoopIncrement.java","additions":14,"deletions":0,"binary":false,"changes":14,"status":"added"},{"patch":"@@ -0,0 +1,2 @@\n+EffectivelyFinalLoopIncrement.java:10:51: compiler.err.cant.ref.non.effectively.final.var: i, (compiler.misc.lambda)\n+1 error\n","filename":"test\/langtools\/tools\/javac\/lambda\/8294461\/EffectivelyFinalLoopIncrement.out","additions":2,"deletions":0,"binary":false,"changes":2,"status":"added"}]}