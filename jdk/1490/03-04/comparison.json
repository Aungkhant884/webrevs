{"files":[{"patch":"@@ -4462,4 +4462,9 @@\n-            chk.checkDeprecated(tree.pos(), env.info.scope.owner, sym);\n-            chk.checkSunAPI(tree.pos(), sym);\n-            chk.checkProfile(tree.pos(), sym);\n-            chk.checkPreview(tree.pos(), sym);\n+            \/\/ (for constructors (but not for constructor references), the error\n+            \/\/ was given when the constructor was resolved)\n+\n+            if (sym.name != names.init || tree.hasTag(REFERENCE)) {\n+                chk.checkDeprecated(tree.pos(), env.info.scope.owner, sym);\n+                chk.checkSunAPI(tree.pos(), sym);\n+                chk.checkProfile(tree.pos(), sym);\n+                chk.checkPreview(tree.pos(), sym);\n+            }\n","filename":"src\/jdk.compiler\/share\/classes\/com\/sun\/tools\/javac\/comp\/Attr.java","additions":9,"deletions":4,"binary":false,"changes":13,"status":"modified"},{"patch":"@@ -2858,2 +2858,7 @@\n-        return findMethod(env, site, names.init, argtypes,\n-                            typeargtypes, allowBoxing, useVarargs);\n+        Symbol sym = findMethod(env, site,\n+                                    names.init, argtypes,\n+                                    typeargtypes, allowBoxing,\n+                                    useVarargs);\n+        chk.checkDeprecated(pos, env.info.scope.owner, sym);\n+        chk.checkPreview(pos, sym);\n+        return sym;\n@@ -2881,1 +2886,1 @@\n-                        return findDiamond(env, site, argtypes, typeargtypes,\n+                        return findDiamond(pos, env, site, argtypes, typeargtypes,\n@@ -2904,0 +2909,23 @@\n+    \/** Find the constructor using diamond inference and do some checks(deprecated and preview).\n+     *  @param pos          The position to use for error reporting.\n+     *  @param env          The environment current at the constructor invocation.\n+     *  @param site         The type of class for which a constructor is searched.\n+     *                      The scope of this class has been touched in attribution.\n+     *  @param argtypes     The types of the constructor invocation's value arguments.\n+     *  @param typeargtypes The types of the constructor invocation's type arguments.\n+     *  @param allowBoxing  Allow boxing conversions of arguments.\n+     *  @param useVarargs   Box trailing arguments into an array for varargs.\n+     *\/\n+    private Symbol findDiamond(DiagnosticPosition pos,\n+                               Env<AttrContext> env,\n+                               Type site,\n+                               List<Type> argtypes,\n+                               List<Type> typeargtypes,\n+                               boolean allowBoxing,\n+                               boolean useVarargs) {\n+        Symbol sym = findDiamond(env, site, argtypes, typeargtypes, allowBoxing, useVarargs);\n+        chk.checkDeprecated(pos, env.info.scope.owner, sym);\n+        chk.checkPreview(pos, sym);\n+        return sym;\n+    }\n+\n","filename":"src\/jdk.compiler\/share\/classes\/com\/sun\/tools\/javac\/comp\/Resolve.java","additions":31,"deletions":3,"binary":false,"changes":34,"status":"modified"}]}