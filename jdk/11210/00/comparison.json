{"files":[{"patch":"@@ -191,2 +191,0 @@\n-                            ClassUnloading, \/\/ only strong roots if ClassUnloading\n-                                            \/\/ is enabled\n@@ -267,9 +265,4 @@\n-  {\n-    StrongRootsScope srs(0);\n-\n-    gch->full_process_roots(true,  \/\/ this is the adjust phase\n-                            GenCollectedHeap::SO_AllCodeCache,\n-                            false, \/\/ all roots\n-                            &adjust_pointer_closure,\n-                            &adjust_cld_closure);\n-  }\n+  gch->full_process_roots(true,  \/\/ this is the adjust phase\n+                          GenCollectedHeap::SO_AllCodeCache,\n+                          &adjust_pointer_closure,\n+                          &adjust_cld_closure);\n","filename":"src\/hotspot\/share\/gc\/serial\/genMarkSweep.cpp","additions":4,"deletions":11,"binary":false,"changes":15,"status":"modified"},{"patch":"@@ -794,1 +794,0 @@\n-                                          bool only_strong_roots,\n@@ -800,4 +799,8 @@\n-  MarkingCodeBlobClosure mark_code_closure(root_closure, is_adjust_phase, is_marking_phase);\n-  CLDClosure* weak_cld_closure = only_strong_roots ? NULL : cld_closure;\n-\n-  process_roots(so, root_closure, cld_closure, weak_cld_closure, &mark_code_closure);\n+  if (is_marking_phase) {\n+    CLDClosure* weak_cld_closure = ClassUnloading ? NULL : cld_closure;\n+    MarkingCodeBlobClosure mark_code_closure(root_closure, !CodeBlobToOopClosure::FixRelocations, true);\n+    process_roots(so, root_closure, cld_closure, weak_cld_closure, &mark_code_closure);\n+  } else {\n+    CodeBlobToOopClosure code_closure(root_closure, CodeBlobToOopClosure::FixRelocations);\n+    process_roots(so, root_closure, cld_closure, cld_closure, &code_closure);\n+  }\n","filename":"src\/hotspot\/share\/gc\/shared\/genCollectedHeap.cpp","additions":8,"deletions":5,"binary":false,"changes":13,"status":"modified"},{"patch":"@@ -341,1 +341,0 @@\n-                          bool only_strong_roots,\n","filename":"src\/hotspot\/share\/gc\/shared\/genCollectedHeap.hpp","additions":0,"deletions":1,"binary":false,"changes":1,"status":"modified"}]}