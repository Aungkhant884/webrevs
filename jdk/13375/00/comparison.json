{"files":[{"patch":"@@ -48,0 +48,6 @@\n+- (void) createDisplayLink {\n+    CVDisplayLinkCreateWithActiveCGDisplays(&displayLink);\n+    CVDisplayLinkSetOutputCallback(displayLink, &displayLinkCallback, (__bridge void*)self);\n+    self.displayLinkCount = 0;\n+}\n+\n@@ -77,3 +83,12 @@\n-    CVDisplayLinkCreateWithActiveCGDisplays(&displayLink);\n-    CVDisplayLinkSetOutputCallback(displayLink, &displayLinkCallback, (__bridge void*)self);\n-    self.displayLinkCount = 0;\n+    [self createDisplayLink];\n+\n+    [[[NSWorkspace sharedWorkspace] notificationCenter]\n+        addObserver : self\n+           selector : @selector(onScreenSleep)\n+               name : NSWorkspaceScreensDidSleepNotification object: NULL];\n+\n+    [[[NSWorkspace sharedWorkspace] notificationCenter]\n+        addObserver : self\n+           selector : @selector(onScreenWakeup)\n+               name : NSWorkspaceScreensDidWakeNotification object: NULL];\n+\n@@ -83,0 +98,17 @@\n+- (void) onScreenSleep {\n+    J2dTraceLn(J2D_TRACE_VERBOSE, \"MTLLayer.onScreenSleep ---  received screen sleep notification.\");\n+\n+    [self stopDisplayLink];\n+}\n+\n+- (void) onScreenWakeup {\n+    J2dTraceLn(J2D_TRACE_VERBOSE, \"MTLLayer.onScreenWakeup ---  received screen wakeup notification.\");\n+    [self stopDisplayLink];\n+    CVDisplayLinkRelease(self.displayLink);\n+    self.displayLink = nil;\n+\n+    [self createDisplayLink];\n+\n+    [self startDisplayLink];\n+}\n+\n@@ -151,0 +183,3 @@\n+\n+    [[[NSWorkspace sharedWorkspace] notificationCenter] removeObserver:self];\n+\n","filename":"src\/java.desktop\/macosx\/native\/libawt_lwawt\/java2d\/metal\/MTLLayer.m","additions":38,"deletions":3,"binary":false,"changes":41,"status":"modified"}]}