{"files":[{"patch":"@@ -38,0 +38,1 @@\n+import java.io.InputStream;\n@@ -86,1 +87,2 @@\n-            exchange.sendResponseHeaders(200, 0);\n+            try (InputStream is = exchange.getRequestBody();\n+                 OutputStream os = exchange.getResponseBody()) {\n@@ -88,11 +90,11 @@\n-            OutputStream os = exchange.getResponseBody();\n-            try {\n-                IOException io = expectThrows(IOException.class,\n-                        () -> exchange.sendResponseHeaders(200, \"failMsg\".getBytes().length));\n-                System.out.println(\"Got expected exception: \" + io);\n-            } catch (Throwable t) {\n-                \/\/ unexpected exception thrown, return error to client\n-                t.printStackTrace();\n-                os.write((\"Unexpected error: \" + t).getBytes());\n-            } finally {\n-                os.close();\n+                is.readAllBytes();\n+                exchange.sendResponseHeaders(200, 0);\n+                try {\n+                    IOException io = expectThrows(IOException.class,\n+                            () -> exchange.sendResponseHeaders(200, \"failMsg\".getBytes().length));\n+                    System.out.println(\"Got expected exception: \" + io);\n+                } catch (Throwable t) {\n+                    \/\/ unexpected exception thrown, return error to client\n+                    t.printStackTrace();\n+                    os.write((\"Unexpected error: \" + t).getBytes());\n+                }\n","filename":"test\/jdk\/java\/net\/httpclient\/SendResponseHeadersTest.java","additions":14,"deletions":12,"binary":false,"changes":26,"status":"modified"}]}