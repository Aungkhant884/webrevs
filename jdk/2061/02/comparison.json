{"files":[{"patch":"@@ -3,1 +3,1 @@\n-# Copyright (c) 2009, 2020, Oracle and\/or its affiliates. All rights reserved.\n+# Copyright (c) 2009, 2021, Oracle and\/or its affiliates. All rights reserved.\n@@ -757,1 +757,0 @@\n-javax\/swing\/JPopupMenu\/8075063\/ContextMenuScrollTest.java 202880 linux-all\n","filename":"test\/jdk\/ProblemList.txt","additions":1,"deletions":2,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2017, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2017, 2021, Oracle and\/or its affiliates. All rights reserved.\n@@ -49,13 +49,6 @@\n-    private JMenuItem undo;\n-    private JMenuItem redo;\n-    private JMenuItem cut;\n-    private JMenuItem copy;\n-    private JMenuItem paste;\n-    private JMenuItem delete;\n-    private JMenuItem selectAll;\n-    private final Robot robot;\n-    private JFrame frame;\n-    private JMenuBar menuBar;\n-    private JMenu menu;\n-    private volatile Point p = null;\n-    private volatile Dimension d = null;\n+    private static Robot robot;\n+    private static JFrame frame;\n+    private static JMenu menu;\n+    private static volatile Point p = null;\n+    private static volatile Dimension d = null;\n+    private static volatile boolean popupVisible = false;\n@@ -64,20 +57,0 @@\n-        new ContextMenuScrollTest();\n-    }\n-    void blockTillDisplayed(JComponent comp) throws Exception {\n-        while (p == null) {\n-            try {\n-                SwingUtilities.invokeAndWait(() -> {\n-                    p = comp.getLocationOnScreen();\n-                    d = menu.getSize();\n-                });\n-            } catch (IllegalStateException e) {\n-                try {\n-                    Thread.sleep(1000);\n-                } catch (InterruptedException ie) {\n-                }\n-            }\n-        }\n-    }\n-\n-    public ContextMenuScrollTest() throws Exception\n-    {\n@@ -85,1 +58,1 @@\n-        robot.setAutoDelay(200);\n+        robot.setAutoDelay(100);\n@@ -88,1 +61,0 @@\n-            blockTillDisplayed(menu);\n@@ -90,0 +62,1 @@\n+            robot.delay(1000);\n@@ -91,0 +64,5 @@\n+            SwingUtilities.invokeAndWait(() -> {\n+                p = menu.getLocationOnScreen();\n+                d = menu.getSize();\n+            });\n+            System.out.println(\"p \" + p + \" d \" + d);\n@@ -92,2 +70,2 @@\n-            robot.mousePress(InputEvent.BUTTON1_MASK);\n-            robot.mouseRelease(InputEvent.BUTTON1_MASK);\n+            robot.mousePress(InputEvent.BUTTON1_DOWN_MASK);\n+            robot.mouseRelease(InputEvent.BUTTON1_DOWN_MASK);\n@@ -95,0 +73,1 @@\n+            robot.delay(1000);\n@@ -96,1 +75,0 @@\n-            System.out.println(\"popmenu visible \" + menu.isPopupMenuVisible());\n@@ -99,2 +77,5 @@\n-            System.out.println(\"popmenu visible \" + menu.isPopupMenuVisible());\n-            if (!menu.isPopupMenuVisible()) {\n+\n+            SwingUtilities.invokeAndWait(() -> {\n+                popupVisible = menu.isPopupMenuVisible();\n+            });\n+            if (!popupVisible) {\n@@ -108,1 +89,2 @@\n-    public void createGUI() {\n+\n+    public static void createGUI() {\n@@ -110,1 +92,1 @@\n-        menuBar = new JMenuBar();\n+        JMenuBar menuBar = new JMenuBar();\n@@ -114,1 +96,1 @@\n-        undo = new JMenuItem(\"Undo\");\n+        JMenuItem undo = new JMenuItem(\"Undo\");\n@@ -125,1 +107,1 @@\n-        redo = new JMenuItem(\"Redo\");\n+        JMenuItem redo = new JMenuItem(\"Redo\");\n@@ -137,1 +119,1 @@\n-        cut = new JMenuItem(\"Cut\");\n+        JMenuItem cut = new JMenuItem(\"Cut\");\n@@ -148,1 +130,1 @@\n-        copy = new JMenuItem(\"Copy\");\n+        JMenuItem copy = new JMenuItem(\"Copy\");\n@@ -159,1 +141,1 @@\n-        paste = new JMenuItem(\"Paste\");\n+        JMenuItem paste = new JMenuItem(\"Paste\");\n@@ -170,1 +152,1 @@\n-        delete = new JMenuItem(\"Delete\");\n+        JMenuItem delete = new JMenuItem(\"Delete\");\n@@ -183,1 +165,1 @@\n-        selectAll = new JMenuItem(\"Select All\");\n+        JMenuItem selectAll = new JMenuItem(\"Select All\");\n@@ -195,0 +177,1 @@\n+        frame.setLocationRelativeTo(null);\n","filename":"test\/jdk\/javax\/swing\/JPopupMenu\/8075063\/ContextMenuScrollTest.java","additions":33,"deletions":50,"binary":false,"changes":83,"status":"modified"}]}