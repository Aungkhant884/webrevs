{"files":[{"patch":"@@ -856,3 +856,4 @@\n-    private static final Map<Integer, CipherSuite> maps_id;\n-    private static final Map<String, CipherSuite> maps_name;\n-    private static final CipherSuite[] ciphers = CipherSuite.values();\n+    private static final Map<Integer, CipherSuite> cipherSuiteIds;\n+    private static final Map<String, CipherSuite> cipherSuiteNames;\n+    private static final List<CipherSuite> allowedCipherSuites;\n+    private static final List<CipherSuite> defaultCipherSuites;\n@@ -863,2 +864,3 @@\n-\n-        for(CipherSuite cs : ciphers) {\n+        List<CipherSuite> allowedCS = new ArrayList<>();\n+        List<CipherSuite> defaultCS = new ArrayList<>();\n+        for(CipherSuite cs : CipherSuite.values()) {\n@@ -870,0 +872,8 @@\n+\n+            if (!cs.supportedProtocols.isEmpty()) {\n+                allowedCS.add(cs);\n+            }\n+\n+            if (cs.isDefaultEnabled) {\n+                defaultCS.add(cs);\n+            }\n@@ -871,2 +881,4 @@\n-        maps_id = Map.copyOf(ids);\n-        maps_name = Map.copyOf(names);\n+        cipherSuiteIds = Map.copyOf(ids);\n+        cipherSuiteNames = Map.copyOf(names);\n+        allowedCipherSuites = List.copyOf(allowedCS);\n+        defaultCipherSuites = List.copyOf(defaultCS);\n@@ -912,1 +924,1 @@\n-        return maps_name.get(ciperSuiteName);\n+        return cipherSuiteNames.get(ciperSuiteName);\n@@ -916,1 +928,1 @@\n-        return maps_id.get(id);\n+        return cipherSuiteIds.get(id);\n@@ -920,1 +932,1 @@\n-        String name = maps_id.get(id).name;\n+        CipherSuite cs = cipherSuiteIds.get(id);\n@@ -922,2 +934,2 @@\n-        if (name != null) {\n-            return name;\n+        if (cs != null) {\n+            return cs.name;\n@@ -930,11 +942,1 @@\n-        Collection<CipherSuite> cipherSuites = new LinkedList<>();\n-        for (CipherSuite cs : ciphers) {\n-            if (!cs.supportedProtocols.isEmpty()) {\n-                cipherSuites.add(cs);\n-            } else {\n-                \/\/ values() is ordered, remaining cipher suites are\n-                \/\/ not supported.\n-                break;\n-            }\n-        }\n-        return cipherSuites;\n+        return allowedCipherSuites;\n@@ -944,11 +946,1 @@\n-        Collection<CipherSuite> cipherSuites = new LinkedList<>();\n-        for (CipherSuite cs : ciphers) {\n-            if (cs.isDefaultEnabled) {\n-                cipherSuites.add(cs);\n-            } else {\n-                \/\/ values() is ordered, remaining cipher suites are\n-                \/\/ not enabled.\n-                break;\n-            }\n-        }\n-        return cipherSuites;\n+        return defaultCipherSuites;\n@@ -977,11 +969,5 @@\n-            for (CipherSuite cs : ciphers) {\n-                if (!cs.supportedProtocols.isEmpty()) {\n-                    if (cs.name.equals(name) ||\n-                            cs.aliases.contains(name)) {\n-                        cipherSuites.add(cs);\n-                        found = true;\n-                        break;\n-                    }\n-                } else {\n-                    \/\/ values() is ordered, remaining cipher suites are\n-                    \/\/ not supported.\n+            for (CipherSuite cs : allowedCipherSuites) {\n+                if (cs.name.equals(name) ||\n+                        cs.aliases.contains(name)) {\n+                    cipherSuites.add(cs);\n+                    found = true;\n","filename":"src\/java.base\/share\/classes\/sun\/security\/ssl\/CipherSuite.java","additions":31,"deletions":45,"binary":false,"changes":76,"status":"modified"}]}