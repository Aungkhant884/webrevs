{"files":[{"patch":"@@ -30,1 +30,0 @@\n-import javax.lang.model.element.AnnotationMirror;\n@@ -155,1 +154,3 @@\n-     * Add the receiver annotations information.\n+     * Add the receiver information.\n+     *\n+     * <p>Note: receivers can only have type-use annotations.<\/p>\n@@ -159,1 +160,0 @@\n-     * @param annotationMirrors list of annotation descriptions.\n@@ -162,7 +162,4 @@\n-    protected void addReceiverAnnotations(ExecutableElement member, TypeMirror rcvrType,\n-            List<? extends AnnotationMirror> annotationMirrors, Content tree) {\n-        tree.add(writer.getAnnotationInfo(member.getReceiverType().getAnnotationMirrors(), false));\n-        tree.add(Entity.NO_BREAK_SPACE);\n-        tree.add(utils.getTypeName(rcvrType, false));\n-        LinkInfoImpl linkInfo = new LinkInfoImpl(configuration, RECEIVER_TYPE, rcvrType);\n-        tree.add(writer.getTypeParameterLinks(linkInfo));\n+    protected void addReceiver(ExecutableElement member, TypeMirror rcvrType, Content tree) {\n+        var info = new LinkInfoImpl(configuration, RECEIVER_TYPE, rcvrType);\n+        info.linkToSelf = false;\n+        tree.add(writer.getLink(info));\n@@ -170,0 +167,4 @@\n+        if (member.getKind() == ElementKind.CONSTRUCTOR) {\n+            tree.add(utils.getTypeName(rcvrType, false));\n+            tree.add(\".\");\n+        }\n@@ -202,3 +203,2 @@\n-        if (includeAnnotations && rcvrType != null && utils.isAnnotated(rcvrType)) {\n-            List<? extends AnnotationMirror> annotationMirrors = rcvrType.getAnnotationMirrors();\n-            addReceiverAnnotations(member, rcvrType, annotationMirrors, paramTree);\n+        if (includeAnnotations && rcvrType != null && utils.isRecursivelyAnnotated(rcvrType)) {\n+            addReceiver(member, rcvrType, paramTree);\n","filename":"src\/jdk.javadoc\/share\/classes\/jdk\/javadoc\/internal\/doclets\/formats\/html\/AbstractExecutableMemberWriter.java","additions":13,"deletions":13,"binary":false,"changes":26,"status":"modified"},{"patch":"@@ -88,1 +88,1 @@\n-import javax.lang.model.util.SimpleTypeVisitor9;\n+import javax.lang.model.util.SimpleTypeVisitor14;\n@@ -331,0 +331,47 @@\n+    public boolean isRecursivelyAnnotated(TypeMirror e) {\n+        return new SimpleTypeVisitor14<Boolean, Void>() {\n+            @Override\n+            protected Boolean defaultAction(TypeMirror e, Void unused) {\n+                return isAnnotated(e);\n+            }\n+\n+            @Override\n+            public Boolean visitArray(ArrayType t, Void unused) {\n+                \/\/ kind 0\n+                return super.visitArray(t, unused) || visit(t.getComponentType());\n+            }\n+\n+            @Override\n+            public Boolean visitDeclared(DeclaredType t, Void unused) {\n+                \/\/ kind 1\n+                if (super.visitDeclared(t, unused) || visit(t.getEnclosingType()))\n+                    return true;\n+\n+                \/\/ kind 3\n+                for (var e : t.getTypeArguments()) {\n+                    if (visit(e))\n+                        return true;\n+                }\n+\n+                return false;\n+            }\n+\n+            @Override\n+            public Boolean visitWildcard(WildcardType t, Void unused) {\n+                if (super.visitWildcard(t, unused))\n+                    return true;\n+\n+                \/\/ kind 2\n+                var superBound = t.getSuperBound();\n+                if (superBound != null && visit(superBound))\n+                    return true;\n+\n+                var extendsBound = t.getExtendsBound();\n+                if (extendsBound != null && visit(extendsBound))\n+                    return true;\n+\n+                return false;\n+            }\n+        }.visit(e);\n+    }\n+\n@@ -631,1 +678,1 @@\n-        return new SimpleTypeVisitor9<Boolean, Void>() {\n+        return new SimpleTypeVisitor14<Boolean, Void>() {\n@@ -736,1 +783,1 @@\n-        return new SimpleTypeVisitor9<StringBuilder, Void>() {\n+        return new SimpleTypeVisitor14<StringBuilder, Void>() {\n@@ -1214,1 +1261,1 @@\n-        return new SimpleTypeVisitor9<TypeElement, Void>() {\n+        return new SimpleTypeVisitor14<TypeElement, Void>() {\n@@ -1270,1 +1317,1 @@\n-        return new SimpleTypeVisitor9<String, Void>() {\n+        return new SimpleTypeVisitor14<String, Void>() {\n@@ -1382,1 +1429,1 @@\n-        return new SimpleTypeVisitor9<String, Void>() {\n+        return new SimpleTypeVisitor14<String, Void>() {\n@@ -1767,1 +1814,1 @@\n-        return new SimpleTypeVisitor9<String, Void>() {\n+        return new SimpleTypeVisitor14<String, Void>() {\n","filename":"src\/jdk.javadoc\/share\/classes\/jdk\/javadoc\/internal\/doclets\/toolkit\/util\/Utils.java","additions":54,"deletions":7,"binary":false,"changes":61,"status":"modified"},{"patch":"@@ -27,1 +27,1 @@\n- *           8187288 8241969\n+ *           8187288 8241969 8259216\n@@ -374,1 +374,1 @@\n-                    =\"RcvrA.html\" title=\"annotation in typeannos\">@RcvrA<\/a>&nbsp;DefaultUnmodified&\\\n+                    =\"RcvrA.html\" title=\"annotation in typeannos\">@RcvrA<\/a> DefaultUnmodified&\\\n@@ -382,1 +382,1 @@\n-                    e=\"annotation in typeannos\">@RcvrB<\/a>(\"m\")&nbsp;DefaultUnmodified&nbsp;this)<\/s\\\n+                    e=\"annotation in typeannos\">@RcvrB<\/a>(\"m\") DefaultUnmodified&nbsp;this)<\/s\\\n@@ -389,1 +389,1 @@\n-                    html\" title=\"annotation in typeannos\">@RcvrA<\/a>&nbsp;DefaultUnmodified&nbsp;thi\\\n+                    html\" title=\"annotation in typeannos\">@RcvrA<\/a> DefaultUnmodified&nbsp;thi\\\n@@ -399,1 +399,1 @@\n-                    n typeannos\">@RcvrA<\/a>&nbsp;PublicModified&nbsp;this)<\/span><\/div>\"\"\",\n+                    n typeannos\">@RcvrA<\/a> PublicModified&nbsp;this)<\/span><\/div>\"\"\",\n@@ -406,1 +406,1 @@\n-                    nnos\">@RcvrA<\/a>&nbsp;PublicModified&nbsp;this,\n+                    nnos\">@RcvrA<\/a> PublicModified&nbsp;this,\n@@ -415,1 +415,1 @@\n-                    html\" title=\"annotation in typeannos\">@RcvrB<\/a>(\"m\")&nbsp;WithValue&nbsp;this,\n+                    html\" title=\"annotation in typeannos\">@RcvrB<\/a>(\"m\") WithValue&nbsp;this,\n@@ -430,1 +430,1 @@\n-                    html\" title=\"annotation in typeannos\">@RcvrA<\/a>&nbsp;WithBody&nbsp;this)<\/span>\\\n+                    html\" title=\"annotation in typeannos\">@RcvrA<\/a> WithBody&nbsp;this)<\/span>\\\n@@ -437,1 +437,1 @@\n-                    html\" title=\"annotation in typeannos\">@RcvrA<\/a>&nbsp;Generic2&lt;X&gt;&nbsp;thi\\\n+                    html\" title=\"annotation in typeannos\">@RcvrA<\/a> Generic2&lt;X&gt;&nbsp;thi\\\n@@ -538,1 +538,2 @@\n-                     typeannos\">@RepTypeUseB<\/a>&nbsp;RepeatingOnConstructor&nbsp;this,\n+                     typeannos\">@RepTypeUseB<\/a> <a href=\"RepeatingOnConstructor.html\" title=\"class \\\n+                    in typeannos\">RepeatingOnConstructor<\/a>&nbsp;RepeatingOnConstructor.this,\n@@ -746,1 +747,1 @@\n-                    \/a>&nbsp;RepeatingOnMethod&nbsp;this,\n+                    \/a> RepeatingOnMethod&nbsp;this,\n@@ -784,1 +785,1 @@\n-                    nos\">@RepTypeUseB<\/a>&nbsp;RepeatingOnTypeParametersBoundsTypeArgumentsOnMethod&\\\n+                    nos\">@RepTypeUseB<\/a> RepeatingOnTypeParametersBoundsTypeArgumentsOnMethod&\\\n@@ -798,0 +799,15 @@\n+\n+        checkOutput(\"typeannos\/Generic2.html\", true,\n+                \"\"\"\n+                    <div class=\"member-signature\"><span class=\"return-type\">void<\/span>&nbsp;<span c\\\n+                    lass=\"element-name\">test1<\/span>()<\/div>\"\"\",\n+                \"\"\"\n+                    <div class=\"member-signature\"><span class=\"return-type\">void<\/span>&nbsp;<span c\\\n+                    lass=\"element-name\">test3<\/span>&#8203;<span class=\"parameters\">(Generic2&lt;<a \\\n+                    href=\"RcvrA.html\" title=\"annotation in typeannos\">@RcvrA<\/a> X&gt;&nbsp;this)<\/s\\\n+                    pan><\/div>\"\"\",\n+                \"\"\"\n+                   <div class=\"member-signature\"><span class=\"return-type\">void<\/span>&nbsp;<span cl\\\n+                   ass=\"element-name\">test4<\/span>&#8203;<span class=\"parameters\">(<a href=\"RcvrA.ht\\\n+                   ml\" title=\"annotation in typeannos\">@RcvrA<\/a> Generic2&lt;<a href=\"RcvrA.html\" t\\\n+                   itle=\"annotation in typeannos\">@RcvrA<\/a> X&gt;&nbsp;this)<\/span><\/div>\"\"\");\n","filename":"test\/langtools\/jdk\/javadoc\/doclet\/testTypeAnnotations\/TestTypeAnnotations.java","additions":28,"deletions":12,"binary":false,"changes":40,"status":"modified"}]}