{"files":[{"patch":"@@ -265,1 +265,1 @@\n-    __ push_vp(_vp_regs, sp);\n+    __ push_v(_vp_regs, sp);\n@@ -270,1 +270,1 @@\n-    __ pop_vp(_vp_regs, sp);\n+    __ pop_v(_vp_regs, sp);\n","filename":"src\/hotspot\/cpu\/riscv\/gc\/z\/zBarrierSetAssembler_riscv.cpp","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -949,2 +949,3 @@\n-\/\/ Push lots of registers in the regset supplied.  Don't push sp.\n-void MacroAssembler::push_reg(RegSet regset, Register stack) {\n+\/\/ Push lots of registers in the bitset supplied.  Don't push sp.\n+\/\/ Return the number of words pushed\n+int MacroAssembler::push_reg(unsigned int bitset, Register stack) {\n@@ -955,1 +956,1 @@\n-  int count = bitset_to_regs(regset.bits(), regs);\n+  int count = bitset_to_regs(bitset, regs);\n@@ -968,0 +969,2 @@\n+\n+  return count;\n@@ -970,1 +973,1 @@\n-void MacroAssembler::pop_reg(RegSet regset, Register stack) {\n+int MacroAssembler::pop_reg(unsigned int bitset, Register stack) {\n@@ -975,1 +978,1 @@\n-  int count = bitset_to_regs(regset.bits(), regs);\n+  int count = bitset_to_regs(bitset, regs);\n@@ -988,0 +991,2 @@\n+\n+  return count;\n@@ -990,2 +995,3 @@\n-\/\/ Push float registers in the regset\n-void MacroAssembler::push_fp(FloatRegSet regset, Register stack) {\n+\/\/ Push float registers in the bitset\n+\/\/ Return the number of words pushed\n+int MacroAssembler::push_fp(unsigned int bitset, Register stack) {\n@@ -995,1 +1001,1 @@\n-  int count = bitset_to_regs(regset.bits(), regs);\n+  int count = bitset_to_regs(bitset, regs);\n@@ -1008,0 +1014,2 @@\n+\n+  return count;\n@@ -1010,1 +1018,1 @@\n-void MacroAssembler::pop_fp(FloatRegSet regset, Register stack) {\n+int MacroAssembler::pop_fp(unsigned int bitset, Register stack) {\n@@ -1014,1 +1022,1 @@\n-  int count = bitset_to_regs(regset.bits(), regs);\n+  int count = bitset_to_regs(bitset, regs);\n@@ -1027,0 +1035,2 @@\n+\n+  return count;\n@@ -1030,1 +1040,1 @@\n-void MacroAssembler::push_vp(VectorRegSet regset, Register stack) {\n+int MacroAssembler::push_v(unsigned int bitset, Register stack) {\n@@ -1036,1 +1046,1 @@\n-  int count = bitset_to_regs(regset.bits(), regs);\n+  int count = bitset_to_regs(bitset, regs);\n@@ -1042,0 +1052,2 @@\n+\n+  return count;\n@@ -1044,1 +1056,1 @@\n-void MacroAssembler::pop_vp(VectorRegSet regset, Register stack) {\n+int MacroAssembler::pop_v(unsigned int bitset, Register stack) {\n@@ -1050,1 +1062,1 @@\n-  int count = bitset_to_regs(regset.bits(), regs);\n+  int count = bitset_to_regs(bitset, regs);\n@@ -1056,0 +1068,2 @@\n+\n+  return count;\n","filename":"src\/hotspot\/cpu\/riscv\/macroAssembler_riscv.cpp","additions":28,"deletions":14,"binary":false,"changes":42,"status":"modified"},{"patch":"@@ -476,0 +476,11 @@\n+private:\n+  int push_reg(unsigned int bitset, Register stack);\n+  int pop_reg(unsigned int bitset, Register stack);\n+  int push_fp(unsigned int bitset, Register stack);\n+  int pop_fp(unsigned int bitset, Register stack);\n+#ifdef COMPILER2\n+  int push_v(unsigned int bitset, Register stack);\n+  int pop_v(unsigned int bitset, Register stack);\n+#endif \/\/ COMPILER2\n+\n+public:\n@@ -478,4 +489,4 @@\n-  void push_reg(RegSet regset, Register stack);\n-  void pop_reg(RegSet regset, Register stack);\n-  void push_fp(FloatRegSet regset, Register stack);\n-  void pop_fp(FloatRegSet regset, Register stack);\n+  void push_reg(RegSet regs, Register stack) { if (regs.bits()) push_reg(regs.bits(), stack); }\n+  void pop_reg(RegSet regs, Register stack)  { if (regs.bits()) pop_reg(regs.bits(), stack); }\n+  void push_fp(FloatRegSet regs, Register stack) { if (regs.bits()) push_fp(regs.bits(), stack); }\n+  void pop_fp(FloatRegSet regs, Register stack)  { if (regs.bits()) pop_fp(regs.bits(), stack); }\n@@ -483,2 +494,2 @@\n-  void push_vp(VectorRegSet regset, Register stack);\n-  void pop_vp(VectorRegSet regset, Register stack);\n+  void push_v(VectorRegSet regs, Register stack) { if (regs.bits()) push_v(regs.bits(), stack); }\n+  void pop_v(VectorRegSet regs, Register stack)  { if (regs.bits()) pop_v(regs.bits(), stack); }\n","filename":"src\/hotspot\/cpu\/riscv\/macroAssembler_riscv.hpp","additions":17,"deletions":6,"binary":false,"changes":23,"status":"modified"}]}