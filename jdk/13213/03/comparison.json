{"files":[{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2008, 2021, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2008, 2023, Oracle and\/or its affiliates. All rights reserved.\n@@ -28,0 +28,2 @@\n+import sun.awt.OSInfo;\n+\n@@ -682,2 +684,1 @@\n-                    if (System.getProperties().getProperty(\"os.name\")\n-                            .startsWith(\"Linux\")) {\n+                    if (OSInfo.getOSType() == OSInfo.OSType.LINUX) {\n@@ -717,2 +718,1 @@\n-                    if (System.getProperties().getProperty(\"os.name\")\n-                            .startsWith(\"Windows\")) {\n+                    if (OSInfo.getOSType() == OSInfo.OSType.WINDOWS) {\n","filename":"src\/java.desktop\/share\/classes\/com\/sun\/media\/sound\/SoftSynthesizer.java","additions":5,"deletions":5,"binary":false,"changes":10,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 1999, 2021, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 1999, 2023, Oracle and\/or its affiliates. All rights reserved.\n@@ -292,2 +292,1 @@\n-            if ((AccessController.doPrivileged(OSInfo.getOSTypeAction()) ==\n-                OSInfo.OSType.MACOSX) && (owner != null) &&\n+            if ((OSInfo.getOSType() == OSInfo.OSType.MACOSX) && (owner != null) &&\n@@ -1033,1 +1032,0 @@\n-\n","filename":"src\/java.desktop\/share\/classes\/javax\/swing\/PopupFactory.java","additions":2,"deletions":4,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 1997, 2021, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 1997, 2023, Oracle and\/or its affiliates. All rights reserved.\n@@ -383,2 +383,1 @@\n-        @SuppressWarnings(\"removal\")\n-        OSInfo.OSType osType = AccessController.doPrivileged(OSInfo.getOSTypeAction());\n+        OSInfo.OSType osType = OSInfo.getOSType();\n@@ -662,2 +661,1 @@\n-        @SuppressWarnings(\"removal\")\n-        OSInfo.OSType osType = AccessController.doPrivileged(OSInfo.getOSTypeAction());\n+        OSInfo.OSType osType = OSInfo.getOSType();\n@@ -1292,2 +1290,1 @@\n-                    OSInfo.OSType osType = AccessController.doPrivileged(OSInfo.getOSTypeAction());\n-                    if (osType == OSInfo.OSType.MACOSX) {\n+                    if (OSInfo.getOSType() == OSInfo.OSType.MACOSX) {\n","filename":"src\/java.desktop\/share\/classes\/javax\/swing\/UIManager.java","additions":4,"deletions":7,"binary":false,"changes":11,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 1998, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 1998, 2023, Oracle and\/or its affiliates. All rights reserved.\n@@ -121,3 +121,1 @@\n-            @SuppressWarnings(\"removal\")\n-            OSInfo.OSType osType = AccessController.doPrivileged(OSInfo.getOSTypeAction());\n-            if (osType == OSInfo.OSType.WINDOWS) {\n+            if (OSInfo.getOSType() == OSInfo.OSType.WINDOWS) {\n","filename":"src\/java.desktop\/share\/classes\/javax\/swing\/plaf\/metal\/MetalLookAndFeel.java","additions":2,"deletions":4,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2005, 2021, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2005, 2023, Oracle and\/or its affiliates. All rights reserved.\n@@ -52,0 +52,2 @@\n+\n+import sun.awt.OSInfo;\n@@ -133,2 +135,1 @@\n-            String osName = getSystemProperty(\"os.name\");\n-            boolean isWindows = osName != null && osName.contains(\"Windows\");\n+            boolean isWindows = OSInfo.getOSType() == OSInfo.OSType.WINDOWS;\n","filename":"src\/java.desktop\/share\/classes\/javax\/swing\/plaf\/nimbus\/NimbusLookAndFeel.java","additions":4,"deletions":3,"binary":false,"changes":7,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 1996, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 1996, 2023, Oracle and\/or its affiliates. All rights reserved.\n@@ -1370,10 +1370,0 @@\n-        \/\/This method will only be called during build time, do we\n-        \/\/need do PrivilegedAction?\n-        @SuppressWarnings(\"removal\")\n-        String osName = java.security.AccessController.doPrivileged(\n-                            new java.security.PrivilegedAction<String>() {\n-            public String run() {\n-                return System.getProperty(\"os.name\");\n-            }\n-        });\n-\n@@ -1386,1 +1376,1 @@\n-                if (osName.contains(\"Windows\")) {\n+                if (OSInfo.getOSType() == OSInfo.OSType.WINDOWS) {\n","filename":"src\/java.desktop\/share\/classes\/sun\/awt\/FontConfiguration.java","additions":2,"deletions":12,"binary":false,"changes":14,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 1997, 2020, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 1997, 2023, Oracle and\/or its affiliates. All rights reserved.\n@@ -28,0 +28,3 @@\n+import jdk.internal.util.OperatingSystem;\n+\n+import java.security.AccessController;\n@@ -66,0 +69,4 @@\n+    \/\/ Cache the OSType for getOSType()\n+    private static final OSType CURRENT_OSTYPE = getOSTypeImpl();  \/\/ No DoPriv needed\n+\n+\n@@ -79,1 +86,1 @@\n-            return getOSType();\n+            return getOSTypeImpl();\n@@ -90,22 +97,3 @@\n-    public static OSType getOSType() throws SecurityException {\n-        String osName = System.getProperty(OS_NAME);\n-\n-        if (osName != null) {\n-            if (osName.contains(\"Windows\")) {\n-                return WINDOWS;\n-            }\n-\n-            if (osName.contains(\"Linux\")) {\n-                return LINUX;\n-            }\n-\n-            if (osName.contains(\"OS X\")) {\n-                return MACOSX;\n-            }\n-\n-            if (osName.contains(\"AIX\")) {\n-                return AIX;\n-            }\n-\n-            \/\/ determine another OS here\n-        }\n+    public static OSType getOSType() {\n+        return CURRENT_OSTYPE;\n+    }\n@@ -113,1 +101,10 @@\n-        return UNKNOWN;\n+    private static OSType getOSTypeImpl() {\n+        OperatingSystem os = OperatingSystem.current();\n+        return switch (os) {\n+            \/\/ Map OperatingSystem enum values to OSType enum values.\n+            case WINDOWS -> WINDOWS;\n+            case LINUX -> LINUX;\n+            case MACOS -> MACOSX;\n+            case AIX -> AIX;\n+            default -> UNKNOWN;\n+        };\n","filename":"src\/java.desktop\/share\/classes\/sun\/awt\/OSInfo.java","additions":22,"deletions":25,"binary":false,"changes":47,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 1997, 2021, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 1997, 2023, Oracle and\/or its affiliates. All rights reserved.\n@@ -96,2 +96,0 @@\n-                    String arch = System.getProperty(\"os.arch\");\n-\n","filename":"src\/java.desktop\/share\/classes\/sun\/awt\/image\/ImagingLib.java","additions":1,"deletions":3,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2000, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2000, 2023, Oracle and\/or its affiliates. All rights reserved.\n","filename":"src\/java.desktop\/share\/classes\/sun\/awt\/shell\/ShellFolder.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2007, 2021, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2007, 2023, Oracle and\/or its affiliates. All rights reserved.\n@@ -28,1 +28,1 @@\n-import sun.java2d.SunGraphicsEnvironment;\n+import sun.awt.OSInfo;\n@@ -38,1 +38,1 @@\n-               if (System.getProperty(\"os.name\").startsWith(\"Windows\")) {\n+               if (OSInfo.getOSType() == OSInfo.OSType.WINDOWS) {\n","filename":"src\/java.desktop\/share\/classes\/sun\/font\/FontManagerNativeLibrary.java","additions":3,"deletions":3,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2008, 2021, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2008, 2023, Oracle and\/or its affiliates. All rights reserved.\n@@ -36,0 +36,1 @@\n+import sun.awt.OSInfo;\n@@ -67,1 +68,0 @@\n-                String osName = System.getProperty(\"os.name\", \"unknownOS\");\n@@ -69,1 +69,1 @@\n-                isLinux = osName.startsWith(\"Linux\");\n+                isLinux = OSInfo.getOSType() == OSInfo.OSType.LINUX;\n@@ -71,1 +71,1 @@\n-                isMacOSX = osName.contains(\"OS X\"); \/\/ TODO: MacOSX\n+                isMacOSX = OSInfo.getOSType() == OSInfo.OSType.MACOSX;\n@@ -103,1 +103,1 @@\n-                isWindows = osName.startsWith(\"Windows\");\n+                isWindows = OSInfo.getOSType() == OSInfo.OSType.WINDOWS;\n","filename":"src\/java.desktop\/share\/classes\/sun\/font\/FontUtilities.java","additions":5,"deletions":5,"binary":false,"changes":10,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 1998, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 1998, 2023, Oracle and\/or its affiliates. All rights reserved.\n@@ -85,0 +85,1 @@\n+import sun.awt.OSInfo;\n@@ -347,2 +348,1 @@\n-                String osName = System.getProperty(\"os.name\");\n-                isMac = osName.startsWith(\"Mac\");\n+                isMac = OSInfo.getOSType() == OSInfo.OSType.MACOSX;\n@@ -1626,2 +1626,2 @@\n-        String osname = System.getProperty(\"os.name\");\n-        if (osname.equals(\"Linux\") || osname.contains(\"OS X\")) {\n+        if (OSInfo.getOSType() == OSInfo.OSType.LINUX ||\n+                OSInfo.getOSType() == OSInfo.OSType.MACOSX) {\n","filename":"src\/java.desktop\/share\/classes\/sun\/print\/PSPrinterJob.java","additions":5,"deletions":5,"binary":false,"changes":10,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2003, 2018, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2003, 2023, Oracle and\/or its affiliates. All rights reserved.\n","filename":"src\/java.desktop\/share\/classes\/sun\/swing\/WindowsPlacesBar.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2003, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2003, 2023, Oracle and\/or its affiliates. All rights reserved.\n@@ -30,2 +30,0 @@\n-import sun.security.action.GetPropertyAction;\n-import java.security.AccessController;\n@@ -639,1 +637,0 @@\n-    @SuppressWarnings(\"removal\")\n@@ -641,1 +638,1 @@\n-        if (\"Linux\".equals(AccessController.doPrivileged(new GetPropertyAction(\"os.name\")))) { \/\/ Load motif default colors on Linux.\n+        if (OSInfo.getOSType() == OSInfo.OSType.LINUX) { \/\/ Load motif default colors on Linux.\n","filename":"src\/java.desktop\/unix\/classes\/sun\/awt\/X11\/MotifColorUtilities.java","additions":2,"deletions":5,"binary":false,"changes":7,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2002, 2014, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2002, 2023, Oracle and\/or its affiliates. All rights reserved.\n@@ -31,0 +31,2 @@\n+\n+import sun.awt.OSInfo;\n@@ -78,1 +80,1 @@\n-        if (System.getProperty(\"os.name\").equals(\"Linux\")) {\n+        if (OSInfo.getOSType() == OSInfo.OSType.LINUX) {\n","filename":"src\/java.desktop\/unix\/classes\/sun\/awt\/X11\/XScrollbarPeer.java","additions":4,"deletions":2,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2008, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2008, 2023, Oracle and\/or its affiliates. All rights reserved.\n","filename":"src\/java.desktop\/unix\/classes\/sun\/font\/FcFontConfiguration.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2000, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2000, 2023, Oracle and\/or its affiliates. All rights reserved.\n@@ -56,0 +56,1 @@\n+import sun.awt.OSInfo;\n@@ -79,4 +80,0 @@\n-    @SuppressWarnings(\"removal\")\n-    static String osname = java.security.AccessController.doPrivileged(\n-            new sun.security.action.GetPropertyAction(\"os.name\"));\n-\n@@ -153,1 +150,1 @@\n-        return osname.startsWith(\"Mac\");\n+        return OSInfo.getOSType() == OSInfo.OSType.MACOSX;\n@@ -157,1 +154,1 @@\n-        return (osname.equals(\"Linux\"));\n+        return OSInfo.getOSType() == OSInfo.OSType.LINUX;\n@@ -161,2 +158,2 @@\n-        return (osname.equals(\"Linux\") ||\n-                osname.contains(\"OS X\"));\n+        return (OSInfo.getOSType() == OSInfo.OSType.LINUX ||\n+                OSInfo.getOSType() == OSInfo.OSType.MACOSX);\n@@ -166,1 +163,1 @@\n-        return osname.equals(\"AIX\");\n+        return OSInfo.getOSType() == OSInfo.OSType.AIX;\n","filename":"src\/java.desktop\/unix\/classes\/sun\/print\/PrintServiceLookupProvider.java","additions":7,"deletions":10,"binary":false,"changes":17,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 1997, 2021, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 1997, 2023, Oracle and\/or its affiliates. All rights reserved.\n","filename":"src\/java.desktop\/windows\/classes\/com\/sun\/java\/swing\/plaf\/windows\/WindowsLookAndFeel.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"}]}