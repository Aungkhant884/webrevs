{"files":[{"patch":"@@ -825,7 +825,0 @@\n-    if (DumpSharedSpaces) {\n-      \/\/ CDS dumping keeps loading classes, so if we hit an OOM we probably will keep hitting OOM.\n-      \/\/ We should abort to avoid generating a potentially bad archive.\n-      vm_exit_during_cds_dumping(err_msg(\"Failed allocating metaspace object type %s of size \" SIZE_FORMAT \". CDS dump aborted.\",\n-          MetaspaceObj::type_name(type), word_size * BytesPerWord),\n-        err_msg(\"Please increase MaxMetaspaceSize (currently \" SIZE_FORMAT \" bytes).\", MaxMetaspaceSize));\n-    }\n","filename":"src\/hotspot\/share\/memory\/metaspace.cpp","additions":0,"deletions":7,"binary":false,"changes":7,"status":"modified"},{"patch":"@@ -615,1 +615,2 @@\n-void MetaspaceShared::preload_and_dump(TRAPS) {\n+void MetaspaceShared::preload_and_dump() {\n+  EXCEPTION_MARK;\n","filename":"src\/hotspot\/share\/memory\/metaspaceShared.cpp","additions":2,"deletions":1,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -80,1 +80,1 @@\n-  static void preload_and_dump(TRAPS) NOT_CDS_RETURN;\n+  static void preload_and_dump() NOT_CDS_RETURN;\n","filename":"src\/hotspot\/share\/memory\/metaspaceShared.hpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -3404,1 +3404,1 @@\n-    MetaspaceShared::preload_and_dump(CHECK_JNI_ERR);\n+    MetaspaceShared::preload_and_dump();\n","filename":"src\/hotspot\/share\/runtime\/thread.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2015, 2020, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2015, 2021, Oracle and\/or its affiliates. All rights reserved.\n@@ -53,1 +53,1 @@\n-    String msg = \"Failed allocating metaspace object\";\n+    String msg = \"OutOfMemoryError: Metaspace\";\n","filename":"test\/hotspot\/jtreg\/runtime\/cds\/MaxMetaspaceSize.java","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"}]}