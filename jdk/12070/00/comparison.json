{"files":[{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2020, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2020, 2023, Oracle and\/or its affiliates. All rights reserved.\n@@ -24,1 +24,3 @@\n-\/* @test\n+\/*\n+ * @test id=default\n+ * @bug 8284161\n@@ -27,2 +29,10 @@\n- * @compile --enable-preview -source ${jdk.version} IsVirtualThread.java\n- * @run main\/native\/othervm --enable-preview IsVirtualThread\n+ * @enablePreview\n+ * @run main\/native\/othervm IsVirtualThread\n+ *\/\n+\n+\/*\n+ * @test id=no-vmcontinuations\n+ * @requires vm.continuations\n+ * @library \/test\/lib\n+ * @enablePreview\n+ * @run main\/native\/othervm -XX:+UnlockExperimentalVMOptions -XX:-VMContinuations IsVirtualThread\n@@ -43,3 +53,6 @@\n-        test(thread);   \/\/ started, probably parked\n-        LockSupport.unpark(thread);\n-        thread.join();\n+        try {\n+            test(thread);   \/\/ started, probably parked\n+        } finally {\n+            LockSupport.unpark(thread);\n+            thread.join();\n+        }\n@@ -52,3 +65,6 @@\n-        test(vthread);   \/\/ started, probably parked\n-        LockSupport.unpark(vthread);\n-        vthread.join();\n+        try {\n+            test(vthread);   \/\/ started, probably parked\n+        } finally {\n+            LockSupport.unpark(vthread);\n+            vthread.join();\n+        }\n","filename":"test\/hotspot\/jtreg\/runtime\/jni\/IsVirtualThread\/IsVirtualThread.java","additions":26,"deletions":10,"binary":false,"changes":36,"status":"modified"}]}