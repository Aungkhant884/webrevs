{"files":[{"patch":"@@ -97,0 +97,8 @@\n+    public static final BigInteger MIN_EXPONENT_RANGE_VAL = new BigInteger(\"65537\");\n+    public static final BigInteger MAX_EXPONENT_RANGE_VAL = new BigInteger(\"2\").pow(256);\n+\n+    \/\/ see NIST SP 800-56B section 6.2.1\n+    private static final boolean requireExpRangeCheck =\n+        \"true\".equalsIgnoreCase(GetPropertyAction.privilegedGetProperty(\n+                \"sun.security.rsa.requireRSAExponentRangeCheck\", \"false\"));\n+\n@@ -195,0 +203,10 @@\n+\n+         \/\/ If a RSAPublicKey and proper flag is set, require a valid range of values for the public exponent, per NIST 800-56B\n+        if (requireExpRangeCheck && (exponent != null) &&\n+                 (exponent.compareTo(MIN_EXPONENT_RANGE_VAL) == -1 ||\n+                         exponent.compareTo(MAX_EXPONENT_RANGE_VAL) != -1)) {\n+            throw new InvalidKeyException(\"RSA exponents must be between \" +\n+                MIN_EXPONENT_RANGE_VAL + \" and \" + MAX_EXPONENT_RANGE_VAL +\n+                \" when the corresponding property is set\");\n+\n+        }\n","filename":"src\/java.base\/share\/classes\/sun\/security\/rsa\/RSAKeyFactory.java","additions":18,"deletions":0,"binary":false,"changes":18,"status":"modified"}]}