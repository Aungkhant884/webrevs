{"files":[{"patch":"@@ -809,1 +809,1 @@\n-    os::print_function_and_library_name(tty, jvmHandler, buf, O_BUFLEN);\n+    os::print_function_and_library_name(tty, jvmHandler, buf, O_BUFLEN, true, true, true);\n@@ -811,1 +811,1 @@\n-    os::print_function_and_library_name(tty, thisHandler, buf, O_BUFLEN);\n+    os::print_function_and_library_name(tty, thisHandler, buf, O_BUFLEN, true, true, true);\n@@ -1361,3 +1361,5 @@\n-    st->put('[');\n-    os::print_function_and_library_name(st, handler, buf, buflen);\n-    st->put(']');\n+    os::print_function_and_library_name(st, handler, buf, buflen,\n+                                        true, \/\/ shorten_path\n+                                        true, \/\/ demangle\n+                                        true  \/\/ omit arguments\n+                                        );\n","filename":"src\/hotspot\/os\/posix\/signals_posix.cpp","additions":7,"deletions":5,"binary":false,"changes":12,"status":"modified"},{"patch":"@@ -885,7 +885,0 @@\n-\/\/ Given an address, attempt to locate both the symbol and the library it\n-\/\/ resides in. If at least one of these steps was successful, prints information\n-\/\/ and returns true.\n-\/\/ On success prints either one of:\n-\/\/ \"<function name>+<offset> in <library>\"\n-\/\/ \"<function name>+<offset>\"\n-\/\/ \"<address> in <library>+<offset>\"\n@@ -896,1 +889,2 @@\n-                                         bool demangle) {\n+                                         bool demangle,\n+                                         bool strip_arguments) {\n@@ -909,0 +903,6 @@\n+    if (demangle && strip_arguments) {\n+      char* args_start = strchr(p, '(');\n+      if (args_start != NULL) {\n+        *args_start = '\\0';\n+      }\n+    }\n","filename":"src\/hotspot\/share\/runtime\/os.cpp","additions":8,"deletions":8,"binary":false,"changes":16,"status":"modified"},{"patch":"@@ -605,0 +605,4 @@\n+  \/\/ - if no scratch buffer is given, stack is used\n+  \/\/ - shorten_paths: path is omitted from library name\n+  \/\/ - demangle: function name is demangled\n+  \/\/ - strip_arguments: arguments are stripped (requires demangle=true)\n@@ -613,1 +617,2 @@\n-                                              bool demangle = true);\n+                                              bool demangle = true,\n+                                              bool strip_arguments = false);\n","filename":"src\/hotspot\/share\/runtime\/os.hpp","additions":6,"deletions":1,"binary":false,"changes":7,"status":"modified"},{"patch":"@@ -708,0 +708,3 @@\n+#define EXPECT_DOES_NOT_CONTAIN(haystack, needle) \\\n+  EXPECT_EQ(::strstr(haystack, needle), (char*)NULL)\n+#define LOG(...) tty->print_cr(__VA_ARGS__);\n@@ -717,1 +720,1 @@\n-  for (int i = 0; i < 8; i++) {\n+  for (int i = 0; i < 16; i++) {\n@@ -720,3 +723,4 @@\n-    const bool provide_scratch_buffer = (i & 4) != 0;\n-    tty->print_cr(\"shorten_paths=%d, demangle=%d, provide_scratch_buffer=%d\",\n-        shorten_paths, demangle, provide_scratch_buffer);\n+    const bool strip_arguments = (i & 4) != 0;\n+    const bool provide_scratch_buffer = (i & 8) != 0;\n+    LOG(\"shorten_paths=%d, demangle=%d, strip_arguments=%d, provide_scratch_buffer=%d\",\n+        shorten_paths, demangle, strip_arguments, provide_scratch_buffer);\n@@ -730,1 +734,2 @@\n-                                                    shorten_paths, demangle));\n+                                                    shorten_paths, demangle,\n+                                                    strip_arguments));\n@@ -734,1 +739,8 @@\n-    tty->print_cr(\"%s\", output);\n+    if (demangle) {\n+      if (strip_arguments) {\n+        EXPECT_DOES_NOT_CONTAIN(output, \"(\");\n+      } else {\n+        EXPECT_CONTAINS(output, \"(\");\n+      }\n+    }\n+    LOG(\"%s\", output);\n@@ -743,1 +755,1 @@\n-      tty->print_cr(\"%s\", output);\n+      LOG(\"%s\", output);\n@@ -754,1 +766,1 @@\n-    tty->print_cr(\"%s\", output);\n+    LOG(\"%s\", output);\n@@ -767,1 +779,1 @@\n-    tty->print_cr(\"%s\", output);\n+    LOG(\"%s\", output);\n@@ -779,1 +791,1 @@\n-    tty->print_cr(\"%s\", output);\n+    LOG(\"%s\", output);\n","filename":"test\/hotspot\/gtest\/runtime\/test_os.cpp","additions":22,"deletions":10,"binary":false,"changes":32,"status":"modified"}]}