{"files":[{"patch":"@@ -109,2 +109,5 @@\n-            this.key = new DerValue(DerValue.tag_Integer,\n-                                    this.x.toByteArray()).toByteArray();\n+            byte[] xbytes = x.toByteArray();\n+            DerValue val = new DerValue(DerValue.tag_Integer, xbytes);\n+            this.key = val.toByteArray();\n+            val.clear();\n+            Arrays.fill(xbytes, (byte)0);\n@@ -255,3 +258,3 @@\n-                DerOutputStream derKey = new DerOutputStream();\n-                derKey.write(DerValue.tag_Sequence, tmp);\n-                this.encodedKey = derKey.toByteArray();\n+                DerValue val = DerValue.wrap(DerValue.tag_Sequence, tmp);\n+                this.encodedKey = val.toByteArray();\n+                val.clear();\n","filename":"src\/java.base\/share\/classes\/com\/sun\/crypto\/provider\/DHPrivateKey.java","additions":8,"deletions":5,"binary":false,"changes":13,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 1996, 2020, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 1996, 2021, Oracle and\/or its affiliates. All rights reserved.\n@@ -35,0 +35,1 @@\n+import java.util.Arrays;\n@@ -71,2 +72,5 @@\n-            key = new DerValue(DerValue.tag_Integer,\n-                               x.toByteArray()).toByteArray();\n+            byte[] xbytes = x.toByteArray();\n+            DerValue val = new DerValue(DerValue.tag_Integer, xbytes);\n+            key = val.toByteArray();\n+            val.clear();\n+            Arrays.fill(xbytes, (byte)0);\n","filename":"src\/java.base\/share\/classes\/sun\/security\/provider\/DSAPrivateKey.java","additions":7,"deletions":3,"binary":false,"changes":10,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2006, 2020, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2006, 2021, Oracle and\/or its affiliates. All rights reserved.\n@@ -34,0 +34,1 @@\n+import java.util.Arrays;\n@@ -127,0 +128,1 @@\n+            Arrays.fill(sArr, (byte)0);\n@@ -131,2 +133,2 @@\n-            DerValue val =\n-                new DerValue(DerValue.tag_Sequence, out.toByteArray());\n+            Arrays.fill(sOctets, (byte)0);\n+            DerValue val = DerValue.wrap(DerValue.tag_Sequence, out);\n@@ -134,0 +136,1 @@\n+            val.clear();\n@@ -150,0 +153,1 @@\n+            Arrays.fill(arrCopy, (byte)0);\n","filename":"src\/jdk.crypto.ec\/share\/classes\/sun\/security\/ec\/ECPrivateKeyImpl.java","additions":7,"deletions":3,"binary":false,"changes":10,"status":"modified"},{"patch":"@@ -188,1 +188,6 @@\n-            return new XDHPrivateKeyImpl(params, privateKeySpec.getScalar());\n+            byte[] scalar = privateKeySpec.getScalar();\n+            try {\n+                return new XDHPrivateKeyImpl(params, scalar);\n+            } finally {\n+                Arrays.fill(scalar, (byte)0);\n+            }\n@@ -234,2 +239,6 @@\n-                return keySpec.cast(\n-                    new XECPrivateKeySpec(xecKey.getParams(), scalar));\n+                try {\n+                    return keySpec.cast(\n+                            new XECPrivateKeySpec(xecKey.getParams(), scalar));\n+                } finally {\n+                    Arrays.fill(scalar, (byte)0);\n+                }\n","filename":"src\/jdk.crypto.ec\/share\/classes\/sun\/security\/ec\/XDHKeyFactory.java","additions":12,"deletions":3,"binary":false,"changes":15,"status":"modified"},{"patch":"@@ -52,1 +52,2 @@\n-        DerOutputStream derKey = new DerOutputStream();\n+\n+        DerValue val = new DerValue(DerValue.tag_OctetString, k);\n@@ -54,2 +55,1 @@\n-            derKey.putOctetString(k);\n-            this.key = derKey.toByteArray();\n+            this.key = val.toByteArray();\n@@ -58,0 +58,2 @@\n+        } finally {\n+            val.clear();\n","filename":"src\/jdk.crypto.ec\/share\/classes\/sun\/security\/ec\/XDHPrivateKeyImpl.java","additions":5,"deletions":3,"binary":false,"changes":8,"status":"modified"},{"patch":"@@ -182,1 +182,6 @@\n-            return new EdDSAPrivateKeyImpl(params, privateKeySpec.getBytes());\n+            byte[] bytes = privateKeySpec.getBytes();\n+            try {\n+                return new EdDSAPrivateKeyImpl(params, bytes);\n+            } finally {\n+                Arrays.fill(bytes, (byte)0);\n+            }\n@@ -228,2 +233,6 @@\n-                return keySpec.cast(\n-                    new EdECPrivateKeySpec(edKey.getParams(), scalar));\n+                try {\n+                    return keySpec.cast(\n+                            new EdECPrivateKeySpec(edKey.getParams(), scalar));\n+                } finally {\n+                    Arrays.fill(scalar, (byte)0);\n+                }\n","filename":"src\/jdk.crypto.ec\/share\/classes\/sun\/security\/ec\/ed\/EdDSAKeyFactory.java","additions":12,"deletions":3,"binary":false,"changes":15,"status":"modified"},{"patch":"@@ -54,1 +54,1 @@\n-        DerOutputStream derKey = new DerOutputStream();\n+        DerValue val = new DerValue(DerValue.tag_OctetString, h);\n@@ -56,2 +56,1 @@\n-            derKey.putOctetString(h);\n-            this.key = derKey.toByteArray();\n+            this.key = val.toByteArray();\n@@ -60,0 +59,2 @@\n+        } finally {\n+            val.clear();\n","filename":"src\/jdk.crypto.ec\/share\/classes\/sun\/security\/ec\/ed\/EdDSAPrivateKeyImpl.java","additions":4,"deletions":3,"binary":false,"changes":7,"status":"modified"}]}