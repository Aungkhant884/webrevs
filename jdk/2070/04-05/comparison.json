{"files":[{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2016, 2020, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2016, 2021, Oracle and\/or its affiliates. All rights reserved.\n@@ -498,1 +498,0 @@\n-                \/\/ Step 4.2. Encrypt\n@@ -500,2 +499,1 @@\n-                byte[] out = cipher.doFinal(v);\n-\n+                \/\/ Step 4.2. Encrypt\n@@ -503,2 +501,7 @@\n-                System.arraycopy(out, 0, result, pos,\n-                        (len > blockLen) ? blockLen : len);\n+                if (len > blockLen) {\n+                    cipher.doFinal(v, 0, blockLen, result, pos);\n+                } else {\n+                    byte[] out = cipher.doFinal(v);\n+                    System.arraycopy(out, 0, result, pos, len);\n+                    Arrays.fill(out, (byte)0);\n+                }\n","filename":"src\/java.base\/share\/classes\/sun\/security\/provider\/CtrDrbg.java","additions":9,"deletions":6,"binary":false,"changes":15,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2016, 2020, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2016, 2021, Oracle and\/or its affiliates. All rights reserved.\n@@ -257,0 +257,2 @@\n+            \/\/ Step 4.1 w = Hash (data).\n+            digest.update(data);\n@@ -258,1 +260,0 @@\n-                \/\/ Step 4.1 w = Hash (data).\n@@ -260,2 +261,3 @@\n-                System.arraycopy(digest.digest(data), 0, output, pos,\n-                        len);\n+                byte[] out = digest.digest();\n+                System.arraycopy(out, 0, output, pos, len);\n+                Arrays.fill(out, (byte)0);\n@@ -264,2 +266,0 @@\n-                    \/\/ Step 4.1 w = Hash (data).\n-                    digest.update(data);\n","filename":"src\/java.base\/share\/classes\/sun\/security\/provider\/HashDrbg.java","additions":6,"deletions":6,"binary":false,"changes":12,"status":"modified"}]}