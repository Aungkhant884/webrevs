{"files":[{"patch":"@@ -0,0 +1,38 @@\n+import static jdk.test.lib.Asserts.*;\n+\n+import jdk.test.lib.process.OutputAnalyzer;\n+\n+\/*\n+ * @test\n+ * @bug 8315149\n+ * @summary Unit test to ensure CPU GC hsperf counters are published.\n+ *\n+ * @library \/test\/lib\n+ *\n+ * @run main\/othervm -XX:+UsePerfData TestGcCounters\n+ *\/\n+public class TestGcCounters {\n+\n+    private static final String[] VM_ARGS = new String[] { \"-XX:+UsePerfData\" };\n+\n+    public static void main(String[] args) throws Exception {\n+        testGcCpuCountersExist();\n+    }\n+\n+\n+    \/**\n+     * jcmd -J-XX:+UsePerfData pid PerfCounter.print\n+     *\/\n+     private static void testGcCpuCountersExist() throws Exception {\n+        OutputAnalyzer output = JcmdBase.jcmd(VM_ARGS,\n+                new String[] {\"PerfCounter.print\"});\n+\n+        output.shouldHaveExitValue(0);\n+        output.shouldContain(\"sun.threads.gc_cpu_time\");\n+        output.shouldContain(\"sun.threads.gc_cpu_time.g1_conc_mark\");\n+        output.shouldContain(\"sun.threads.gc_cpu_time.g1_conc_refine\");\n+        output.shouldContain(\"sun.threads.gc_cpu_time.parallel_gc_workers\");\n+        output.shouldContain(\"sun.threads.gc_cpu_time.vm\");\n+    }\n+}\n+\n","filename":"test\/jdk\/sun\/tools\/jcmd\/TestGcCounters.java","additions":38,"deletions":0,"binary":false,"changes":38,"status":"added"}]}