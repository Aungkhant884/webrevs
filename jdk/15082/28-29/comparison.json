{"files":[{"patch":"@@ -470,1 +470,1 @@\n-        PerfDataManager::create_counter(SUN_THREADS_GCCPU, \"g1_conc_mark\",\n+        PerfDataManager::create_counter(SUN_THREADS_CPUTIME, \"gc_conc_mark\",\n","filename":"src\/hotspot\/share\/gc\/g1\/g1ConcurrentMark.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -119,1 +119,1 @@\n-        PerfDataManager::create_counter(SUN_THREADS_GCCPU, \"g1_conc_refine\",\n+        PerfDataManager::create_counter(SUN_THREADS_CPUTIME, \"gc_conc_refine\",\n","filename":"src\/hotspot\/share\/gc\/g1\/g1ConcurrentRefine.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -900,0 +900,2 @@\n+\n+  CollectedHeap::publish_total_cpu_time();\n","filename":"src\/hotspot\/share\/gc\/parallel\/parallelScavengeHeap.cpp","additions":2,"deletions":0,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -298,1 +298,1 @@\n-  if (UsePerfData && os::is_thread_cpu_time_supported()) {\n+  if (UsePerfData) {\n@@ -309,4 +309,5 @@\n-    _total_cpu_time =\n-                PerfDataManager::create_counter(SUN_THREADS, \"total_gc_cpu_time\",\n-                                                PerfData::U_Ticks, CHECK);\n-    _total_cpu_time_diff = 0;\n+    if (os::is_thread_cpu_time_supported()) {\n+      _total_cpu_time =\n+                  PerfDataManager::create_counter(SUN_THREADS, \"total_gc_cpu_time\",\n+                                                  PerfData::U_Ticks, CHECK);\n+      _total_cpu_time_diff = 0;\n@@ -314,3 +315,4 @@\n-    _perf_parallel_worker_threads_cpu_time =\n-                PerfDataManager::create_counter(SUN_THREADS_GCCPU, \"parallel_gc_workers\",\n-                                                PerfData::U_Ticks, CHECK);\n+      _perf_parallel_worker_threads_cpu_time =\n+                  PerfDataManager::create_counter(SUN_THREADS_CPUTIME, \"gc_parallel_workers\",\n+                                                  PerfData::U_Ticks, CHECK);\n+    }\n","filename":"src\/hotspot\/share\/gc\/shared\/collectedHeap.cpp","additions":10,"deletions":8,"binary":false,"changes":18,"status":"modified"},{"patch":"@@ -73,2 +73,2 @@\n-        PerfDataManager::create_counter(SUN_THREADS_GCCPU, \"conc_dedup\",\n-                                         PerfData::U_Ticks, CHECK);\n+        PerfDataManager::create_counter(SUN_THREADS_CPUTIME, \"conc_dedup\",\n+                                        PerfData::U_Ticks, CHECK);\n","filename":"src\/hotspot\/share\/gc\/shared\/stringdedup\/stringDedupProcessor.cpp","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -76,1 +76,1 @@\n-  \"sun.threads.gc_cpu_time\",  \/\/ Subsystem for Sun Threads GC CPU\n+  \"sun.threads.cpu_time\",  \/\/ Subsystem for Sun Threads CPU times\n","filename":"src\/hotspot\/share\/runtime\/perfData.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -65,1 +65,1 @@\n-  SUN_THREADS_GCCPU,    \/\/ Subsystem for Sun Threads GC CPU\n+  SUN_THREADS_CPUTIME,  \/\/ Subsystem for Sun Threads CPU times\n","filename":"src\/hotspot\/share\/runtime\/perfData.hpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -134,1 +134,1 @@\n-  if (UsePerfData && os::is_thread_cpu_time_supported()) {\n+  if (UsePerfData) {\n@@ -140,3 +140,5 @@\n-    _perf_vm_thread_cpu_time =\n-                 PerfDataManager::create_counter(SUN_THREADS_GCCPU, \"vm\",\n-                                                 PerfData::U_Ticks, CHECK);\n+    if (os::is_thread_cpu_time_supported()) {\n+      _perf_vm_thread_cpu_time =\n+                   PerfDataManager::create_counter(SUN_THREADS_CPUTIME, \"vm\",\n+                                                   PerfData::U_Ticks, CHECK);\n+    }\n","filename":"src\/hotspot\/share\/runtime\/vmThread.cpp","additions":6,"deletions":4,"binary":false,"changes":10,"status":"modified"},{"patch":"@@ -27,1 +27,1 @@\n- * @summary Unit test to ensure CPU GC hsperf counters are published.\n+ * @summary Unit test to ensure CPU hsperf counters are published.\n@@ -42,1 +42,1 @@\n-    private static final String SUN_THREADS_GCCPU = \"sun.threads.gc_cpu_time\";\n+    private static final String SUN_THREADS_CPUTIME = \"sun.threads.cpu_time\";\n@@ -57,5 +57,5 @@\n-        output.shouldContain(SUN_THREADS_GCCPU + \".g1_conc_mark\");\n-        output.shouldContain(SUN_THREADS_GCCPU + \".g1_conc_refine\");\n-        output.shouldContain(SUN_THREADS_GCCPU + \".parallel_gc_workers\");\n-        output.shouldContain(SUN_THREADS_GCCPU + \".vm\");\n-        output.shouldContain(SUN_THREADS_GCCPU + \".conc_dedup\");\n+        output.shouldContain(SUN_THREADS_CPUTIME + \".gc_conc_mark\");\n+        output.shouldContain(SUN_THREADS_CPUTIME + \".gc_conc_refine\");\n+        output.shouldContain(SUN_THREADS_CPUTIME + \".gc_parallel_workers\");\n+        output.shouldContain(SUN_THREADS_CPUTIME + \".vm\");\n+        output.shouldContain(SUN_THREADS_CPUTIME + \".conc_dedup\");\n","filename":"test\/jdk\/sun\/tools\/jcmd\/TestGcCounters.java","additions":7,"deletions":7,"binary":false,"changes":14,"status":"modified"}]}