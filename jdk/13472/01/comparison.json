{"files":[{"patch":"@@ -125,0 +125,45 @@\n+static jint handleSocketErrorWithMessage(JNIEnv *env, jint errorValue,\n+                                         const char* message)\n+{\n+    char *xn;\n+    switch (errorValue) {\n+        case EINPROGRESS:       \/* Non-blocking connect *\/\n+            return 0;\n+#ifdef EPROTO\n+        case EPROTO:\n+            xn = JNU_JAVANETPKG \"ProtocolException\";\n+            break;\n+#endif\n+        case ECONNREFUSED:\n+        case ETIMEDOUT:\n+        case ENOTCONN:\n+            xn = JNU_JAVANETPKG \"ConnectException\";\n+            break;\n+\n+        case EHOSTUNREACH:\n+            xn = JNU_JAVANETPKG \"NoRouteToHostException\";\n+            break;\n+        case EADDRINUSE:  \/* Fall through *\/\n+        case EADDRNOTAVAIL:\n+        case EACCES:\n+            xn = JNU_JAVANETPKG \"BindException\";\n+            break;\n+        default:\n+            xn = JNU_JAVANETPKG \"SocketException\";\n+            break;\n+    }\n+    errno = errorValue;\n+    if (message == NULL) {\n+        JNU_ThrowByNameWithLastError(env, xn, \"NioSocketError\");\n+    } else {\n+        JNU_ThrowByNameWithMessageAndLastError(env, xn, message);\n+    }\n+    return IOS_THROWN;\n+}\n+\n+\/* Declared in nio_util.h *\/\n+jint handleSocketError(JNIEnv *env, jint errorValue)\n+{\n+    return handleSocketErrorWithMessage(env, errorValue, NULL);\n+}\n+\n@@ -617,1 +662,1 @@\n-        handleSocketError(env, errno);\n+        handleSocketErrorWithMessage(env, errno, \"setsockopt failed\");\n@@ -694,1 +739,1 @@\n-        handleSocketError(env, errno);\n+        handleSocketErrorWithMessage(env, errno, \"setsockopt failed\");\n@@ -915,35 +960,0 @@\n-\/* Declared in nio_util.h *\/\n-\n-jint handleSocketError(JNIEnv *env, jint errorValue)\n-{\n-    char *xn;\n-    switch (errorValue) {\n-        case EINPROGRESS:       \/* Non-blocking connect *\/\n-            return 0;\n-#ifdef EPROTO\n-        case EPROTO:\n-            xn = JNU_JAVANETPKG \"ProtocolException\";\n-            break;\n-#endif\n-        case ECONNREFUSED:\n-        case ETIMEDOUT:\n-        case ENOTCONN:\n-            xn = JNU_JAVANETPKG \"ConnectException\";\n-            break;\n-\n-        case EHOSTUNREACH:\n-            xn = JNU_JAVANETPKG \"NoRouteToHostException\";\n-            break;\n-        case EADDRINUSE:  \/* Fall through *\/\n-        case EADDRNOTAVAIL:\n-        case EACCES:\n-            xn = JNU_JAVANETPKG \"BindException\";\n-            break;\n-        default:\n-            xn = JNU_JAVANETPKG \"SocketException\";\n-            break;\n-    }\n-    errno = errorValue;\n-    JNU_ThrowByNameWithLastError(env, xn, \"NioSocketError\");\n-    return IOS_THROWN;\n-}\n","filename":"src\/java.base\/unix\/native\/libnio\/ch\/Net.c","additions":47,"deletions":37,"binary":false,"changes":84,"status":"modified"}]}