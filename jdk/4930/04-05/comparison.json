{"files":[{"patch":"@@ -25,1 +25,1 @@\n- * @bug 8058704\n+ * @bug 8058704 6789980\n@@ -27,1 +27,1 @@\n- * @summary  Verifies if Nimbus honor JTextPane background color\n+ * @summary  Verifies if Nimbus honor JTextPane and JEditorPane background color\n@@ -40,0 +40,1 @@\n+import javax.swing.text.JTextComponent;\n@@ -49,7 +50,0 @@\n-        SwingUtilities.invokeAndWait(() -> {\n-            try {\n-                UIManager.setLookAndFeel(\"javax.swing.plaf.nimbus.NimbusLookAndFeel\");\n-            } catch (Exception checkedExceptionsPleaseDie) {\n-                throw new RuntimeException(checkedExceptionsPleaseDie);\n-            }\n-        });\n@@ -61,7 +55,3 @@\n-    private static void testTextPane() throws Exception {\n-        try {\n-            SwingUtilities.invokeAndWait(() -> {\n-                JTextPane tp = new JTextPane();\n-                tp.setForeground(Color.WHITE);\n-                tp.setBackground(Color.BLACK);\n-                tp.setText(\"This text should be white on black\");\n+    private interface ComponentCreator<T extends JTextComponent> {\n+        T createComponent();\n+    }\n@@ -69,25 +59,2 @@\n-                frame = new JFrame();\n-                frame.setDefaultCloseOperation(frame.DISPOSE_ON_CLOSE);\n-                frame.add(tp);\n-                frame.setSize(new Dimension(480, 360));\n-                frame.setLocationRelativeTo(null);\n-                frame.setVisible(true);\n-            });\n-            robot.waitForIdle();\n-            robot.delay(1000);\n-            SwingUtilities.invokeAndWait(() -> {\n-                pt = frame.getLocationOnScreen();\n-                bounds = frame.getBounds();\n-            });\n-            if (!(robot.getPixelColor(pt.x + bounds.width\/2,\n-                                      pt.y + bounds.height\/2)\n-                                .equals(Color.BLACK))) {\n-                throw new RuntimeException(\"JTextPane Color not same as the color being set\");\n-            }\n-        } finally {\n-            SwingUtilities.invokeAndWait(() -> {\n-                if (frame != null) {\n-                    frame.dispose();\n-                }\n-            });\n-        }\n+    private static void testTextPane() throws Exception {\n+        testComponent(JTextPane::new);\n@@ -97,0 +64,9 @@\n+        testComponent(() -> {\n+            JEditorPane ep = new JEditorPane();\n+            ep.setContentType(\"text\/plain\");\n+            return ep;\n+        });\n+    }\n+\n+    private static void testComponent(ComponentCreator<? extends JTextComponent> creator)\n+            throws Exception {\n@@ -99,6 +75,10 @@\n-                JEditorPane editorPane = new JEditorPane();\n-                editorPane.setContentType(\"text\/plain\");\n-                editorPane.setEditable(false);\n-                editorPane.setForeground(Color.GREEN);\n-                editorPane.setBackground(Color.RED);\n-                editorPane.setText(\"This text should be green on red\");\n+                try {\n+                    UIManager.setLookAndFeel(\"javax.swing.plaf.nimbus.NimbusLookAndFeel\");\n+                } catch (Exception checkedExceptionsPleaseDie) {\n+                    throw new RuntimeException(checkedExceptionsPleaseDie);\n+                }\n+                JTextComponent tc = creator.createComponent();\n+                tc.setEditable(false);\n+                tc.setForeground(Color.GREEN);\n+                tc.setBackground(Color.RED);\n+                tc.setText(\"This text should be green on red\");\n@@ -106,1 +86,1 @@\n-                frame = new JFrame();\n+                frame = new JFrame(tc.getClass().getName());\n@@ -108,1 +88,1 @@\n-                frame.add(editorPane);\n+                frame.add(tc);\n@@ -122,1 +102,1 @@\n-                throw new RuntimeException(\"JEditorPane bg Color not same as the color being set\");\n+                throw new RuntimeException(\"bg Color not same as the color being set\");\n","filename":"test\/jdk\/javax\/swing\/plaf\/nimbus\/TestNimbusBGColor.java","additions":30,"deletions":50,"binary":false,"changes":80,"status":"modified"}]}