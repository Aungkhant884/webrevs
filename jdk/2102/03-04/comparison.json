{"files":[{"patch":"@@ -486,15 +486,1 @@\n-        this(bytes, offset, length, lookupCharset(charsetName));\n-    }\n-\n-    private static Charset lookupCharset(String charsetName)\n-            throws UnsupportedEncodingException {\n-        Objects.requireNonNull(charsetName);\n-        try {\n-            Charset cs = StringCoding.lookupCharset(charsetName);\n-            if (cs == null) {\n-                throw new UnsupportedEncodingException(charsetName);\n-            }\n-            return cs;\n-        } catch (IllegalCharsetNameException ics) {\n-            throw new UnsupportedEncodingException(charsetName);\n-        }\n+        this(bytes, offset, length, StringCoding.lookupCharset(charsetName));\n","filename":"src\/java.base\/share\/classes\/java\/lang\/String.java","additions":1,"deletions":15,"binary":false,"changes":16,"status":"modified"},{"patch":"@@ -43,0 +43,2 @@\n+import java.util.Objects;\n+\n@@ -94,7 +96,6 @@\n-    static Charset lookupCharset(String csn) {\n-        if (Charset.isSupported(csn)) {\n-            try {\n-                return Charset.forName(csn);\n-            } catch (UnsupportedCharsetException x) {\n-                throw new Error(x);\n-            }\n+    static Charset lookupCharset(String csn) throws UnsupportedEncodingException {\n+        Objects.requireNonNull(csn);\n+        try {\n+            return Charset.forName(csn);\n+        } catch (UnsupportedCharsetException | IllegalCharsetNameException x) {\n+            throw new UnsupportedEncodingException(csn);\n@@ -102,1 +103,0 @@\n-        return null;\n@@ -184,1 +184,1 @@\n-    static byte[] encode(String charsetName, byte coder, byte[] val)\n+    static byte[] encode(String csn, byte coder, byte[] val)\n@@ -188,1 +188,0 @@\n-        String csn = (charsetName == null) ? \"ISO-8859-1\" : charsetName;\n@@ -191,18 +190,9 @@\n-            se = null;\n-            try {\n-                Charset cs = lookupCharset(csn);\n-                if (cs != null) {\n-                    if (cs == UTF_8) {\n-                        return encodeUTF8(coder, val, true);\n-                    }\n-                    if (cs == ISO_8859_1) {\n-                        return encode8859_1(coder, val);\n-                    }\n-                    if (cs == US_ASCII) {\n-                        return encodeASCII(coder, val);\n-                    }\n-                    se = new StringEncoder(cs, csn);\n-                }\n-            } catch (IllegalCharsetNameException x) {}\n-            if (se == null) {\n-                throw new UnsupportedEncodingException (csn);\n+            Charset cs = lookupCharset(csn);\n+            if (cs == UTF_8) {\n+                return encodeUTF8(coder, val, true);\n+            }\n+            if (cs == ISO_8859_1) {\n+                return encode8859_1(coder, val);\n+            }\n+            if (cs == US_ASCII) {\n+                return encodeASCII(coder, val);\n@@ -210,0 +200,1 @@\n+            se = new StringEncoder(cs, csn);\n","filename":"src\/java.base\/share\/classes\/java\/lang\/StringCoding.java","additions":19,"deletions":28,"binary":false,"changes":47,"status":"modified"}]}