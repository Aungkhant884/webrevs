{"files":[{"patch":"@@ -352,6 +352,1 @@\n-                        lock.lock();\n-                        try {\n-                            state = State.HEADERS;\n-                        } finally {\n-                            lock.unlock();\n-                        }\n+                        switchState(State.HEADERS);\n","filename":"src\/java.net.http\/share\/classes\/jdk\/internal\/net\/http\/Http1Exchange.java","additions":1,"deletions":6,"binary":false,"changes":7,"status":"modified"},{"patch":"@@ -132,1 +132,1 @@\n-            if (STATE.compareAndSet(this, (byte)0, (byte)0x01)) {\n+            if (STATE.compareAndSet(this, (byte) 0, (byte) 0x01)) {\n@@ -150,1 +150,1 @@\n-            if (STATE.compareAndSet(this, (byte)0x01, (byte)0x03)) {\n+            if (STATE.compareAndSet(this, (byte) 0x01, (byte) 0x03)) {\n","filename":"src\/java.net.http\/share\/classes\/jdk\/internal\/net\/http\/Http1Response.java","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -105,1 +105,1 @@\n-        lock();\n+        lock.lock();\n@@ -133,1 +133,1 @@\n-            unlock();\n+            lock.unlock();\n@@ -138,1 +138,1 @@\n-                    lock();\n+                    lock.lock();\n@@ -153,1 +153,1 @@\n-                        unlock();\n+                        lock.unlock();\n@@ -174,1 +174,1 @@\n-        lock();\n+        lock.lock();\n@@ -197,1 +197,1 @@\n-            unlock();\n+            lock.unlock();\n@@ -204,1 +204,1 @@\n-        lock();\n+        lock.lock();\n@@ -211,1 +211,1 @@\n-            unlock();\n+            lock.unlock();\n@@ -220,1 +220,1 @@\n-        lock();\n+        lock.lock();\n@@ -224,1 +224,1 @@\n-            unlock();\n+            lock.unlock();\n@@ -317,8 +317,0 @@\n-    private void lock() {\n-        lock.lock();\n-    }\n-\n-    private void unlock() {\n-        lock.unlock();\n-    }\n-\n","filename":"src\/java.net.http\/share\/classes\/jdk\/internal\/net\/http\/Http2ClientImpl.java","additions":10,"deletions":18,"binary":false,"changes":28,"status":"modified"},{"patch":"@@ -146,1 +146,1 @@\n-    private boolean finalStream;\n+    private volatile boolean finalStream;\n@@ -490,1 +490,1 @@\n-        if (finalStream) {\n+        if (finalStream()) {\n@@ -577,6 +577,1 @@\n-        stateLock.lock();\n-        try {\n-            return finalStream;\n-        } finally {\n-            stateLock.unlock();\n-        }\n+        return finalStream;\n@@ -590,6 +585,1 @@\n-        stateLock.lock();\n-        try {\n-            finalStream = true;\n-        } finally {\n-            stateLock.unlock();\n-        }\n+        finalStream = true;\n","filename":"src\/java.net.http\/share\/classes\/jdk\/internal\/net\/http\/Http2Connection.java","additions":4,"deletions":14,"binary":false,"changes":18,"status":"modified"}]}