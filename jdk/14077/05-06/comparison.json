{"files":[{"patch":"@@ -919,1 +919,2 @@\n-                                                            uint node_index) {\n+                                                            uint node_index,\n+                                                            bool expand_heap) {\n@@ -921,3 +922,2 @@\n-  HeapWord* result =\n-    attempt_allocation_at_safepoint(word_size, node_index);\n-  if (result != nullptr) {\n+  HeapWord* result = attempt_allocation_at_safepoint(word_size, node_index);\n+  if (result != nullptr || !expand_heap) {\n@@ -933,1 +933,0 @@\n-\n@@ -954,1 +953,1 @@\n-  bool alloc_succeeded = handle_allocation_requests(false \/* expect_null_mutator_alloc_region*\/);\n+  bool alloc_succeeded = handle_allocation_requests(true \/* expand_heap *\/ );\n@@ -970,1 +969,1 @@\n-  alloc_succeeded = handle_allocation_requests(true \/* expect_null_mutator_alloc_region*\/);\n+  alloc_succeeded = handle_allocation_requests(true \/* expand_heap *\/);\n@@ -986,1 +985,1 @@\n-  alloc_succeeded = handle_allocation_requests(true \/* expect_null_mutator_alloc_region*\/);\n+  alloc_succeeded = handle_allocation_requests(true \/* expand_heap *\/);\n@@ -1015,1 +1014,1 @@\n-bool G1CollectedHeap::handle_allocation_requests(bool expect_null_mutator_alloc_region) {\n+bool G1CollectedHeap::handle_allocation_requests(bool expand_heap) {\n@@ -1026,2 +1025,3 @@\n-    HeapWord* result =\n-      satisfy_failed_allocation_helper(alloc_req->size(), alloc_req->node_index());\n+    HeapWord* result = satisfy_failed_allocation_helper(alloc_req->size(),\n+                                                        alloc_req->node_index(),\n+                                                        expand_heap);\n","filename":"src\/hotspot\/share\/gc\/g1\/g1CollectedHeap.cpp","additions":11,"deletions":11,"binary":false,"changes":22,"status":"modified"},{"patch":"@@ -188,0 +188,1 @@\n+      Pending,\n@@ -190,1 +191,0 @@\n-      Pending,\n@@ -566,1 +566,1 @@\n-  bool handle_allocation_requests(bool expect_null_mutator_alloc_region);\n+  bool handle_allocation_requests(bool expand_heap);\n@@ -582,1 +582,3 @@\n-  HeapWord* satisfy_failed_allocation_helper(size_t word_size, uint node_index);\n+  HeapWord* satisfy_failed_allocation_helper(size_t word_size,\n+                                             uint node_index,\n+                                             bool expand_heap);\n","filename":"src\/hotspot\/share\/gc\/g1\/g1CollectedHeap.hpp","additions":5,"deletions":3,"binary":false,"changes":8,"status":"modified"},{"patch":"@@ -138,1 +138,1 @@\n-    bool alloc_succeeded = g1h->handle_allocation_requests(false \/* expect_null_mutator_alloc_region*\/);\n+    bool alloc_succeeded = g1h->handle_allocation_requests(false \/* expand_heap *\/);\n","filename":"src\/hotspot\/share\/gc\/g1\/g1VMOperations.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"}]}