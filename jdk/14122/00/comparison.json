{"files":[{"patch":"@@ -388,4 +388,0 @@\n-    \/\/ Set up soft reference policy\n-    const bool clear = should_clear_soft_references(request.cause());\n-    ZGeneration::old()->set_soft_reference_policy(clear);\n-\n@@ -444,2 +440,2 @@\n-static void handle_alloc_stalling_for_old() {\n-  ZHeap::heap()->handle_alloc_stalling_for_old();\n+static void handle_alloc_stalling_for_old(bool cleared_soft_refs) {\n+  ZHeap::heap()->handle_alloc_stalling_for_old(cleared_soft_refs);\n@@ -448,2 +444,2 @@\n-void ZDriverMajor::handle_alloc_stalls() const {\n-  handle_alloc_stalling_for_old();\n+void ZDriverMajor::handle_alloc_stalls(bool cleared_soft_refs) const {\n+  handle_alloc_stalling_for_old(cleared_soft_refs);\n@@ -464,0 +460,4 @@\n+    \/\/ Set up soft reference policy\n+    const bool clear_soft_refs = should_clear_soft_references(request.cause());\n+    ZGeneration::old()->set_soft_reference_policy(clear_soft_refs);\n+\n@@ -473,1 +473,1 @@\n-    handle_alloc_stalls();\n+    handle_alloc_stalls(clear_soft_refs);\n","filename":"src\/hotspot\/share\/gc\/z\/zDriver.cpp","additions":9,"deletions":9,"binary":false,"changes":18,"status":"modified"},{"patch":"@@ -115,1 +115,1 @@\n-  void handle_alloc_stalls() const;\n+  void handle_alloc_stalls(bool cleared_soft_refs) const;\n","filename":"src\/hotspot\/share\/gc\/z\/zDriver.hpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -114,1 +114,1 @@\n-  void handle_alloc_stalling_for_old();\n+  void handle_alloc_stalling_for_old(bool cleared_soft_refs);\n","filename":"src\/hotspot\/share\/gc\/z\/zHeap.hpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -89,2 +89,2 @@\n-inline void ZHeap::handle_alloc_stalling_for_old() {\n-  _page_allocator.handle_alloc_stalling_for_old();\n+inline void ZHeap::handle_alloc_stalling_for_old(bool cleared_soft_refs) {\n+  _page_allocator.handle_alloc_stalling_for_old(cleared_soft_refs);\n","filename":"src\/hotspot\/share\/gc\/z\/zHeap.inline.hpp","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -988,1 +988,1 @@\n-void ZPageAllocator::handle_alloc_stalling_for_old() {\n+void ZPageAllocator::handle_alloc_stalling_for_old(bool cleared_soft_refs) {\n@@ -990,1 +990,3 @@\n-  notify_out_of_memory();\n+  if (cleared_soft_refs) {\n+    notify_out_of_memory();\n+  }\n","filename":"src\/hotspot\/share\/gc\/z\/zPageAllocator.cpp","additions":4,"deletions":2,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -166,1 +166,1 @@\n-  void handle_alloc_stalling_for_old();\n+  void handle_alloc_stalling_for_old(bool cleared_soft_refs);\n","filename":"src\/hotspot\/share\/gc\/z\/zPageAllocator.hpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"}]}