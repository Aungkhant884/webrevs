{"files":[{"patch":"@@ -2,1 +2,1 @@\n-* Copyright (c) 2016, 2021, Oracle and\/or its affiliates. All rights reserved.\n+* Copyright (c) 2016, 2022, Oracle and\/or its affiliates. All rights reserved.\n@@ -27,0 +27,2 @@\n+import java.util.concurrent.CountDownLatch;\n+\n@@ -31,0 +33,2 @@\n+import static java.util.concurrent.TimeUnit.MILLISECONDS;\n+\n@@ -34,1 +38,0 @@\n-   @author Mikhail Cherkasov\n@@ -38,2 +41,4 @@\n-    static volatile boolean parsingDone = false;\n-    static volatile Exception exception;\n+    private static final long TIMEOUT = 10_000;\n+\n+    private static final CountDownLatch latch = new CountDownLatch(1);\n+    private static volatile Exception exception;\n@@ -42,2 +47,0 @@\n-        long timeout = 10_000;\n-        long s = System.currentTimeMillis();\n@@ -51,1 +54,0 @@\n-                    parsingDone = true;\n@@ -55,0 +57,1 @@\n+                latch.countDown();\n@@ -57,2 +60,3 @@\n-        while (!parsingDone && exception == null && System.currentTimeMillis() - s < timeout) {\n-            Thread.sleep(200);\n+\n+        if (!latch.await(TIMEOUT, MILLISECONDS)) {\n+            throw new RuntimeException(\"Parsing takes too long.\");\n@@ -60,1 +64,0 @@\n-        final long took = System.currentTimeMillis() - s;\n@@ -64,3 +67,0 @@\n-        if (took > timeout) {\n-            throw new RuntimeException(\"Parsing takes too long.\");\n-        }\n","filename":"test\/jdk\/javax\/swing\/text\/html\/parser\/Parser\/8078268\/bug8078268.java","additions":13,"deletions":13,"binary":false,"changes":26,"status":"modified"}]}