{"files":[{"patch":"@@ -29,0 +29,1 @@\n+import java.nio.charset.Charset;\n@@ -264,0 +265,15 @@\n+    private final static Charset nativeCharset;\n+    static {\n+        Charset cs = Charset.defaultCharset();\n+        Console cons;\n+        if ((cons = System.console()) != null) {\n+            cs = cons.charset();\n+        } else {\n+            try {\n+                cs = Charset.forName(System.getProperty(\"native.encoding\"));\n+            } catch (Exception e) {\n+            }\n+        }\n+        nativeCharset = cs;\n+    }\n+\n@@ -268,2 +284,2 @@\n-            out = new PrintWriter(System.out, true);\n-            err = new PrintWriter(System.err, true);\n+            out = new PrintWriter(System.out, true, nativeCharset);\n+            err = new PrintWriter(System.err, true, nativeCharset);\n","filename":"src\/jdk.compiler\/share\/classes\/com\/sun\/tools\/javac\/util\/Log.java","additions":18,"deletions":2,"binary":false,"changes":20,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 1996, 2018, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 1996, 2021, Oracle and\/or its affiliates. All rights reserved.\n@@ -43,0 +43,1 @@\n+import java.nio.charset.Charset;\n@@ -215,0 +216,15 @@\n+    private final static Charset nativeCharset;\n+    static {\n+        Charset cs = Charset.defaultCharset();\n+        Console cons;\n+        if ((cons = System.console()) != null) {\n+            cs = cons.charset();\n+        } else {\n+            try {\n+                cs = Charset.forName(System.getProperty(\"native.encoding\"));\n+            } catch (Exception e) {\n+            }\n+        }\n+        nativeCharset = cs;\n+    }\n+\n@@ -216,2 +232,2 @@\n-        this.out = new PrintWriter(out, true);\n-        this.err = new PrintWriter(err, true);\n+        this.out = new PrintWriter(out, true, nativeCharset);\n+        this.err = new PrintWriter(err, true, nativeCharset);\n","filename":"src\/jdk.jartool\/share\/classes\/sun\/tools\/jar\/Main.java","additions":19,"deletions":3,"binary":false,"changes":22,"status":"modified"},{"patch":"@@ -28,0 +28,1 @@\n+import java.io.Console;\n@@ -32,0 +33,1 @@\n+import java.nio.charset.Charset;\n@@ -171,0 +173,15 @@\n+    private final static Charset nativeCharset;\n+    static {\n+        Charset cs = Charset.defaultCharset();\n+        Console cons;\n+        if ((cons = System.console()) != null) {\n+            cs = cons.charset();\n+        } else {\n+            try {\n+                cs = Charset.forName(System.getProperty(\"native.encoding\"));\n+            } catch (Exception e) {\n+            }\n+        }\n+        nativeCharset = cs;\n+    }\n+\n@@ -172,1 +189,1 @@\n-        return new PrintWriter(ps, autoflush) {\n+        return new PrintWriter(ps, autoflush, nativeCharset) {\n","filename":"src\/jdk.javadoc\/share\/classes\/jdk\/javadoc\/internal\/tool\/JavadocLog.java","additions":18,"deletions":1,"binary":false,"changes":19,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2007, 2020, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2007, 2021, Oracle and\/or its affiliates. All rights reserved.\n@@ -28,0 +28,1 @@\n+import java.io.Console;\n@@ -42,0 +43,1 @@\n+import java.nio.charset.Charset;\n@@ -398,0 +400,15 @@\n+    private final static Charset nativeCharset;\n+    static {\n+        Charset cs = Charset.defaultCharset();\n+        Console cons;\n+        if ((cons = System.console()) != null) {\n+            cs = cons.charset();\n+        } else {\n+            try {\n+                cs = Charset.forName(System.getProperty(\"native.encoding\"));\n+            } catch (Exception e) {\n+            }\n+        }\n+        nativeCharset = cs;\n+    }\n+\n@@ -399,1 +416,9 @@\n-        return new PrintWriter(s == null ? System.err : s, true);\n+        if (s == null) {\n+            return new PrintWriter(System.err, true, nativeCharset);\n+        } else {\n+            if (s.equals((OutputStream)System.err) || s.equals((OutputStream)System.out)) {\n+                return new PrintWriter(s, true, nativeCharset);\n+            } else {\n+                return new PrintWriter(s, true);\n+            }\n+        }\n","filename":"src\/jdk.jdeps\/share\/classes\/com\/sun\/tools\/javap\/JavapTask.java","additions":27,"deletions":2,"binary":false,"changes":29,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2012, 2020, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2012, 2021, Oracle and\/or its affiliates. All rights reserved.\n@@ -33,0 +33,1 @@\n+import java.io.Console;\n@@ -36,0 +37,1 @@\n+import java.nio.charset.Charset;\n@@ -505,0 +507,15 @@\n+    private final static Charset nativeCharset;\n+    static {\n+        Charset cs = Charset.defaultCharset();\n+        Console cons;\n+        if ((cons = System.console()) != null) {\n+            cs = cons.charset();\n+        } else {\n+            try {\n+                cs = Charset.forName(System.getProperty(\"native.encoding\"));\n+            } catch (Exception e) {\n+            }\n+        }\n+        nativeCharset = cs;\n+    }\n+\n@@ -507,1 +524,1 @@\n-            log = new PrintWriter(System.out);\n+            log = new PrintWriter(System.out, true, nativeCharset);\n","filename":"src\/jdk.jdeps\/share\/classes\/com\/sun\/tools\/jdeps\/JdepsTask.java","additions":19,"deletions":2,"binary":false,"changes":21,"status":"modified"},{"patch":"@@ -29,0 +29,1 @@\n+import java.nio.charset.Charset;\n@@ -32,0 +33,15 @@\n+    private final static Charset nativeCharset;\n+    static {\n+        Charset cs = Charset.defaultCharset();\n+        Console cons;\n+        if ((cons = System.console()) != null) {\n+            cs = cons.charset();\n+        } else {\n+            try {\n+                cs = Charset.forName(System.getProperty(\"native.encoding\"));\n+            } catch (Exception e) {\n+            }\n+        }\n+        nativeCharset = cs;\n+    }\n+\n@@ -33,2 +49,2 @@\n-        System.exit(run(new PrintWriter(System.out, true),\n-                        new PrintWriter(System.err, true),\n+        System.exit(run(new PrintWriter(System.out, true, nativeCharset),\n+                        new PrintWriter(System.err, true, nativeCharset),\n","filename":"src\/jdk.jlink\/share\/classes\/jdk\/tools\/jlink\/internal\/Main.java","additions":18,"deletions":2,"binary":false,"changes":20,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2015, 2020, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2015, 2021, Oracle and\/or its affiliates. All rights reserved.\n@@ -30,0 +30,1 @@\n+import java.io.Console;\n@@ -49,0 +50,1 @@\n+import java.nio.charset.Charset;\n@@ -121,1 +123,15 @@\n-    private PrintWriter out = new PrintWriter(System.out, true);\n+    private final static Charset nativeCharset;\n+    static {\n+        Charset cs = Charset.defaultCharset();\n+        Console cons;\n+        if ((cons = System.console()) != null) {\n+            cs = cons.charset();\n+        } else {\n+            try {\n+                cs = Charset.forName(System.getProperty(\"native.encoding\"));\n+            } catch (Exception e) {\n+            }\n+        }\n+        nativeCharset = cs;\n+    }\n+    private PrintWriter out = new PrintWriter(System.out, true, nativeCharset);\n","filename":"src\/jdk.jlink\/share\/classes\/jdk\/tools\/jmod\/JmodTask.java","additions":18,"deletions":2,"binary":false,"changes":20,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2011, 2020, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2011, 2021, Oracle and\/or its affiliates. All rights reserved.\n@@ -31,0 +31,1 @@\n+import java.io.Console;\n@@ -32,0 +33,1 @@\n+import java.nio.charset.Charset;\n@@ -48,0 +50,15 @@\n+    private final static Charset nativeCharset;\n+    static {\n+        Charset cs = Charset.defaultCharset();\n+        Console cons;\n+        if ((cons = System.console()) != null) {\n+            cs = cons.charset();\n+        } else {\n+            try {\n+                cs = Charset.forName(System.getProperty(\"native.encoding\"));\n+            } catch (Exception e) {\n+            }\n+        }\n+        nativeCharset = cs;\n+    }\n+\n@@ -50,2 +67,2 @@\n-        PrintWriter out = new PrintWriter(System.out);\n-        PrintWriter err = new PrintWriter(System.err);\n+        PrintWriter out = new PrintWriter(System.out, true, nativeCharset);\n+        PrintWriter err = new PrintWriter(System.err, true, nativeCharset);\n","filename":"src\/jdk.jpackage\/share\/classes\/jdk\/jpackage\/main\/Main.java","additions":20,"deletions":3,"binary":false,"changes":23,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2010, 2018, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2010, 2021, Oracle and\/or its affiliates. All rights reserved.\n@@ -291,0 +291,1 @@\n+            \"native.encoding\",\n","filename":"test\/langtools\/tools\/javac\/diags\/CheckResourceKeys.java","additions":2,"deletions":1,"binary":false,"changes":3,"status":"modified"}]}