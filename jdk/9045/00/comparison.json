{"files":[{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2008, 2021, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2008, 2022, Oracle and\/or its affiliates. All rights reserved.\n@@ -377,2 +377,0 @@\n-        \/\/ special-case read access to avoid needing to determine effective\n-        \/\/ access to file; default if modes not specified\n@@ -380,2 +378,18 @@\n-            checkReadAccess(file);\n-            return;\n+            try {\n+                \/\/ special-case read access to avoid needing to determine\n+                \/\/ effective access to file\n+                checkReadAccess(file);\n+                return;\n+            } catch (IOException ioe) {\n+                if (!r) {\n+                    \/\/ Modes not specified: existence check only.\n+                    \/\/ Assume file exists if attributes can be read.\n+                    try {\n+                        WindowsFileAttributes.get(file, true);\n+                        return;\n+                    } catch (WindowsException e) {\n+                        ioe.addSuppressed(e);\n+                    }\n+                }\n+                throw ioe;\n+            }\n","filename":"src\/java.base\/windows\/classes\/sun\/nio\/fs\/WindowsFileSystemProvider.java","additions":19,"deletions":5,"binary":false,"changes":24,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2008, 2019, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2008, 2022, Oracle and\/or its affiliates. All rights reserved.\n@@ -25,1 +25,1 @@\n- * @bug 4313887 6838333 8005566 8032220 8215467 8255576\n+ * @bug 4313887 6838333 8005566 8032220 8215467 8255576 8286160\n@@ -27,1 +27,3 @@\n- * @library ..\n+ * @library .. \/test\/lib\n+ * @build jdk.test.lib.Platform\n+ * @run main Misc\n@@ -30,1 +32,14 @@\n-import java.nio.file.*;\n+import java.io.IOException;\n+import java.io.File;\n+import java.nio.file.FileAlreadyExistsException;\n+import java.nio.file.Files;\n+import java.nio.file.Path;\n+import java.nio.file.attribute.AclEntry;\n+import java.nio.file.attribute.AclEntryPermission;\n+import java.nio.file.attribute.AclEntryType;\n+import java.nio.file.attribute.AclFileAttributeView;\n+import java.nio.file.attribute.DosFileAttributeView;\n+import java.nio.file.attribute.UserPrincipal;\n+import java.util.List;\n+import jdk.test.lib.Platform;\n+\n@@ -33,3 +48,0 @@\n-import java.nio.file.attribute.*;\n-import java.io.IOException;\n-import java.util.*;\n@@ -81,1 +93,1 @@\n-        Path root = Paths.get(\"\/\");\n+        Path root = Path.of(\"\/\");\n@@ -96,1 +108,1 @@\n-        if (System.getProperty(\"os.name\").startsWith(\"Windows\")) {\n+        if (Platform.isWindows()) {\n@@ -289,0 +301,7 @@\n+            if (Platform.isWindows()) {\n+                Path pageFile = Path.of(\"C:\\\\pagefile.sys\");\n+                if (pageFile.toFile().exists()) {\n+                    System.out.printf(\"Check page file %s%n\", pageFile);\n+                    assertTrue(exists(pageFile));\n+                }\n+            }\n@@ -354,1 +373,1 @@\n-            if (System.getProperty(\"os.name\").startsWith(\"Windows\")) {\n+            if (Platform.isWindows()) {\n@@ -384,1 +403,1 @@\n-        if (System.getProperty(\"os.name\").startsWith(\"Windows\"))\n+        if (Platform.isWindows())\n@@ -387,1 +406,1 @@\n-        Path passwd = Paths.get(\"\/etc\/passwd\");\n+        Path passwd = Path.of(\"\/etc\/passwd\");\n","filename":"test\/jdk\/java\/nio\/file\/Files\/Misc.java","additions":31,"deletions":12,"binary":false,"changes":43,"status":"modified"}]}