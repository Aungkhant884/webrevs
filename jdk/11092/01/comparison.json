{"files":[{"patch":"@@ -55,1 +55,1 @@\n-class PCIterateMarkAndPushClosure: public MetadataVisitingOopIterateClosure {\n+class PCIterateMarkAndPushClosure: public ClaimMetadataVisitingOopIterateClosure {\n@@ -59,1 +59,3 @@\n-  PCIterateMarkAndPushClosure(ParCompactionManager* cm, ReferenceProcessor* rp) : MetadataVisitingOopIterateClosure(rp), _compaction_manager(cm) { }\n+  PCIterateMarkAndPushClosure(ParCompactionManager* cm, ReferenceProcessor* rp) :\n+    ClaimMetadataVisitingOopIterateClosure(ClassLoaderData::_claim_stw_fullgc_mark, rp),\n+    _compaction_manager(cm) { }\n","filename":"src\/hotspot\/share\/gc\/parallel\/psCompactionManager.inline.hpp","additions":4,"deletions":2,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -1036,0 +1036,3 @@\n+  \/\/ Need to clear claim bits for the next mark.\n+  ClassLoaderDataGraph::clear_claimed_marks();\n+\n@@ -1968,1 +1971,1 @@\n-      CLDToOopClosure cld_closure(&mark_and_push_closure, ClassLoaderData::_claim_strong);\n+      CLDToOopClosure cld_closure(&mark_and_push_closure, ClassLoaderData::_claim_stw_fullgc_mark);\n@@ -2019,3 +2022,1 @@\n-  \/\/ Need new claim bits before marking starts.\n-  ClassLoaderDataGraph::clear_claimed_marks();\n-\n+  ClassLoaderDataGraph::verify_claimed_marks_cleared(ClassLoaderData::_claim_stw_fullgc_mark);\n@@ -2097,2 +2098,2 @@\n-    \/\/ Need new claim bits when tracing through and adjusting pointers.\n-    ClassLoaderDataGraph::clear_claimed_marks();\n+\n+    ClassLoaderDataGraph::verify_claimed_marks_cleared(ClassLoaderData::_claim_stw_fullgc_adjust);\n@@ -2117,1 +2118,1 @@\n-      CLDToOopClosure cld_closure(&adjust, ClassLoaderData::_claim_strong);\n+      CLDToOopClosure cld_closure(&adjust, ClassLoaderData::_claim_stw_fullgc_adjust);\n","filename":"src\/hotspot\/share\/gc\/parallel\/psParallelCompact.cpp","additions":8,"deletions":7,"binary":false,"changes":15,"status":"modified"},{"patch":"@@ -183,2 +183,1 @@\n-  \/\/ Need new claim bits before marking starts.\n-  ClassLoaderDataGraph::clear_claimed_marks();\n+  ClassLoaderDataGraph::verify_claimed_marks_cleared(ClassLoaderData::_claim_stw_fullgc_mark);\n@@ -264,2 +263,1 @@\n-  \/\/ Need new claim bits for the pointer adjustment tracing.\n-  ClassLoaderDataGraph::clear_claimed_marks();\n+  ClassLoaderDataGraph::verify_claimed_marks_cleared(ClassLoaderData::_claim_stw_fullgc_adjust);\n","filename":"src\/hotspot\/share\/gc\/serial\/genMarkSweep.cpp","additions":2,"deletions":4,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -65,2 +65,2 @@\n-CLDToOopClosure    MarkSweep::follow_cld_closure(&mark_and_push_closure, ClassLoaderData::_claim_strong);\n-CLDToOopClosure    MarkSweep::adjust_cld_closure(&adjust_pointer_closure, ClassLoaderData::_claim_strong);\n+CLDToOopClosure    MarkSweep::follow_cld_closure(&mark_and_push_closure, ClassLoaderData::_claim_stw_fullgc_mark);\n+CLDToOopClosure    MarkSweep::adjust_cld_closure(&adjust_pointer_closure, ClassLoaderData::_claim_stw_fullgc_adjust);\n","filename":"src\/hotspot\/share\/gc\/serial\/markSweep.cpp","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -631,0 +631,4 @@\n+\n+    \/\/ Need to clear claim bits for the next mark.\n+    ClassLoaderDataGraph::clear_claimed_marks();\n+\n","filename":"src\/hotspot\/share\/gc\/shared\/genCollectedHeap.cpp","additions":4,"deletions":0,"binary":false,"changes":4,"status":"modified"}]}