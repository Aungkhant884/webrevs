{"files":[{"patch":"@@ -87,1 +87,0 @@\n-            info = maybeReBox(info);\n@@ -90,1 +89,5 @@\n-                result = invoke(bootstrapMethod, caller, name, type);\n+                if (type instanceof Class<?> c) {\n+                    result = bootstrapMethod.invoke(caller, name, c);\n+                } else {\n+                    result = bootstrapMethod.invoke(caller, name, (MethodType)type);\n+                }\n@@ -102,1 +105,6 @@\n-                    result = invoke(bootstrapMethod, caller, name, type, info);\n+                    info = maybeReBox(info);\n+                    if (type instanceof Class<?> c) {\n+                        result = bootstrapMethod.invoke(caller, name, c, info);\n+                    } else {\n+                        result = bootstrapMethod.invoke(caller, name, (MethodType)type, info);\n+                    }\n@@ -122,1 +130,0 @@\n-                maybeReBoxElements(argv);\n@@ -136,0 +143,1 @@\n+                    maybeReBoxElements(shiftedArgs);\n@@ -138,0 +146,1 @@\n+                    maybeReBoxElements(argv);\n@@ -140,30 +149,28 @@\n-                    switch (argv.length) {\n-                        case 0:\n-                            result = invoke(bootstrapMethod, caller, name, type);\n-                            break;\n-                        case 1:\n-                            result = invoke(bootstrapMethod, caller, name, type,\n-                                            argv[0]);\n-                            break;\n-                        case 2:\n-                            result = invoke(bootstrapMethod, caller, name, type,\n-                                            argv[0], argv[1]);\n-                            break;\n-                        case 3:\n-                            result = invoke(bootstrapMethod, caller, name, type,\n-                                            argv[0], argv[1], argv[2]);\n-                            break;\n-                        case 4:\n-                            result = invoke(bootstrapMethod, caller, name, type,\n-                                            argv[0], argv[1], argv[2], argv[3]);\n-                            break;\n-                        case 5:\n-                            result = invoke(bootstrapMethod, caller, name, type,\n-                                            argv[0], argv[1], argv[2], argv[3], argv[4]);\n-                            break;\n-                        case 6:\n-                            result = invoke(bootstrapMethod, caller, name, type,\n-                                            argv[0], argv[1], argv[2], argv[3], argv[4], argv[5]);\n-                            break;\n-                        default:\n-                            result = invokeWithManyArguments(bootstrapMethod, caller, name, type, argv);\n+                    maybeReBoxElements(argv);\n+                    if (argv.length > 6) {\n+                        result = invokeWithManyArguments(bootstrapMethod, caller, name, type, argv);\n+                    } else {\n+                        if (type instanceof Class<?> c) {\n+                            result = switch (argv.length) {\n+                                case 0 -> bootstrapMethod.invoke(caller, name, c);\n+                                case 1 -> bootstrapMethod.invoke(caller, name, c, argv[0]);\n+                                case 2 -> bootstrapMethod.invoke(caller, name, c, argv[0], argv[1]);\n+                                case 3 -> bootstrapMethod.invoke(caller, name, c, argv[0], argv[1], argv[2]);\n+                                case 4 -> bootstrapMethod.invoke(caller, name, c, argv[0], argv[1], argv[2], argv[3]);\n+                                case 5 -> bootstrapMethod.invoke(caller, name, c, argv[0], argv[1], argv[2], argv[3], argv[4]);\n+                                case 6 -> bootstrapMethod.invoke(caller, name, c, argv[0], argv[1], argv[2], argv[3], argv[4], argv[5]);\n+                                default -> throw new IllegalStateException(\"Unexpected value: \" + argv.length);\n+                            };\n+                        } else {\n+                            MethodType mt = (MethodType) type;\n+                            result = switch (argv.length) {\n+                                case 0 -> bootstrapMethod.invoke(caller, name, mt);\n+                                case 1 -> bootstrapMethod.invoke(caller, name, mt, argv[0]);\n+                                case 2 -> bootstrapMethod.invoke(caller, name, mt, argv[0], argv[1]);\n+                                case 3 -> bootstrapMethod.invoke(caller, name, mt, argv[0], argv[1], argv[2]);\n+                                case 4 -> bootstrapMethod.invoke(caller, name, mt, argv[0], argv[1], argv[2], argv[3]);\n+                                case 5 -> bootstrapMethod.invoke(caller, name, mt, argv[0], argv[1], argv[2], argv[3], argv[4]);\n+                                case 6 -> bootstrapMethod.invoke(caller, name, mt, argv[0], argv[1], argv[2], argv[3], argv[4], argv[5]);\n+                                default -> throw new IllegalStateException(\"Unexpected value: \" + argv.length);\n+                            };\n+                        }\n@@ -221,70 +228,0 @@\n-    \/\/ If we don't provide static type information for type, we'll generate runtime\n-    \/\/ checks. Let's try not to...\n-\n-    private static Object invoke(MethodHandle bootstrapMethod, Lookup caller,\n-                                 String name, Object type) throws Throwable {\n-        if (type instanceof Class) {\n-            return bootstrapMethod.invoke(caller, name, (Class<?>)type);\n-        } else {\n-            return bootstrapMethod.invoke(caller, name, (MethodType)type);\n-        }\n-    }\n-\n-    private static Object invoke(MethodHandle bootstrapMethod, Lookup caller,\n-                                 String name, Object type, Object arg0) throws Throwable {\n-        if (type instanceof Class) {\n-            return bootstrapMethod.invoke(caller, name, (Class<?>)type, arg0);\n-        } else {\n-            return bootstrapMethod.invoke(caller, name, (MethodType)type, arg0);\n-        }\n-    }\n-\n-    private static Object invoke(MethodHandle bootstrapMethod, Lookup caller, String name,\n-                                 Object type, Object arg0, Object arg1) throws Throwable {\n-        if (type instanceof Class) {\n-            return bootstrapMethod.invoke(caller, name, (Class<?>)type, arg0, arg1);\n-        } else {\n-            return bootstrapMethod.invoke(caller, name, (MethodType)type, arg0, arg1);\n-        }\n-    }\n-\n-    private static Object invoke(MethodHandle bootstrapMethod, Lookup caller, String name,\n-                                 Object type, Object arg0, Object arg1,\n-                                 Object arg2) throws Throwable {\n-        if (type instanceof Class) {\n-            return bootstrapMethod.invoke(caller, name, (Class<?>)type, arg0, arg1, arg2);\n-        } else {\n-            return bootstrapMethod.invoke(caller, name, (MethodType)type, arg0, arg1, arg2);\n-        }\n-    }\n-\n-    private static Object invoke(MethodHandle bootstrapMethod, Lookup caller, String name,\n-                                 Object type, Object arg0, Object arg1,\n-                                 Object arg2, Object arg3) throws Throwable {\n-        if (type instanceof Class) {\n-            return bootstrapMethod.invoke(caller, name, (Class<?>)type, arg0, arg1, arg2, arg3);\n-        } else {\n-            return bootstrapMethod.invoke(caller, name, (MethodType)type, arg0, arg1, arg2, arg3);\n-        }\n-    }\n-\n-    private static Object invoke(MethodHandle bootstrapMethod, Lookup caller,\n-                                 String name, Object type, Object arg0, Object arg1,\n-                                 Object arg2, Object arg3, Object arg4) throws Throwable {\n-        if (type instanceof Class) {\n-            return bootstrapMethod.invoke(caller, name, (Class<?>)type, arg0, arg1, arg2, arg3, arg4);\n-        } else {\n-            return bootstrapMethod.invoke(caller, name, (MethodType)type, arg0, arg1, arg2, arg3, arg4);\n-        }\n-    }\n-\n-    private static Object invoke(MethodHandle bootstrapMethod, Lookup caller,\n-                                 String name, Object type, Object arg0, Object arg1,\n-                                 Object arg2, Object arg3, Object arg4, Object arg5) throws Throwable {\n-        if (type instanceof Class) {\n-            return bootstrapMethod.invoke(caller, name, (Class<?>)type, arg0, arg1, arg2, arg3, arg4, arg5);\n-        } else {\n-            return bootstrapMethod.invoke(caller, name, (MethodType)type, arg0, arg1, arg2, arg3, arg4, arg5);\n-        }\n-    }\n-\n","filename":"src\/java.base\/share\/classes\/java\/lang\/invoke\/BootstrapMethodInvoker.java","additions":41,"deletions":104,"binary":false,"changes":145,"status":"modified"},{"patch":"@@ -152,2 +152,2 @@\n-        if (c instanceof SpeciesData) {\n-            return (SpeciesData) c;\n+        if (c instanceof SpeciesData s) {\n+            return s;\n","filename":"src\/java.base\/share\/classes\/java\/lang\/invoke\/BoundMethodHandle.java","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -317,2 +317,2 @@\n-            if (binding instanceof CallSite) {\n-                site = (CallSite) binding;\n+            if (binding instanceof CallSite cs) {\n+                site = cs;\n","filename":"src\/java.base\/share\/classes\/java\/lang\/invoke\/CallSite.java","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -134,1 +134,1 @@\n-        if (mem instanceof Method) {\n+        if (mem instanceof Method m) {\n@@ -136,4 +136,4 @@\n-            return new MemberName((Method) mem, wantSpecial);\n-        } else if (mem instanceof Constructor) {\n-            return new MemberName((Constructor) mem);\n-        } else if (mem instanceof Field) {\n+            return new MemberName(m, wantSpecial);\n+        } else if (mem instanceof Constructor c) {\n+            return new MemberName(c);\n+        } else if (mem instanceof Field f) {\n@@ -141,1 +141,1 @@\n-            return new MemberName((Field) mem, isSetter);\n+            return new MemberName(f, isSetter);\n","filename":"src\/java.base\/share\/classes\/java\/lang\/invoke\/InfoFromMemberName.java","additions":6,"deletions":6,"binary":false,"changes":12,"status":"modified"},{"patch":"@@ -235,1 +235,1 @@\n-            sfx = \"0\"+sfx;\n+            sfx = \"0\" + sfx;\n@@ -269,4 +269,0 @@\n-        Class<?> c = arg.getClass();\n-        while (c.isArray()) {\n-            c = c.getComponentType();\n-        }\n@@ -274,1 +270,10 @@\n-        String name = \"_DATA_\" + c.getSimpleName() + \"_\" + classData.size();\n+        String name;\n+        if (DUMP_CLASS_FILES) {\n+            Class<?> c = arg.getClass();\n+            while (c.isArray()) {\n+                c = c.getComponentType();\n+            }\n+            name = \"_DATA_\" + c.getSimpleName() + \"_\" + classData.size();\n+        } else {\n+            name = \"_D_\" + classData.size();\n+        }\n@@ -277,1 +282,1 @@\n-        return cd.name();\n+        return name;\n@@ -281,5 +286,15 @@\n-        Object[] data = new Object[classData.size()];\n-        for (int i = 0; i < classData.size(); i++) {\n-            data[i] = classData.get(i).value;\n-        }\n-        return List.of(data);\n+        final List<ClassData> cd = classData;\n+        return switch(cd.size()) {\n+            case 0 -> List.of();\n+            case 1 -> List.of(cd.get(0).value);\n+            case 2 -> List.of(cd.get(0).value, cd.get(1).value);\n+            case 3 -> List.of(cd.get(0).value, cd.get(1).value, cd.get(2).value);\n+            case 4 -> List.of(cd.get(0).value, cd.get(1).value, cd.get(2).value, cd.get(3).value);\n+            default -> {\n+                Object[] data = new Object[classData.size()];\n+                for (int i = 0; i < classData.size(); i++) {\n+                    data[i] = classData.get(i).value;\n+                }\n+                yield List.of(data);\n+            }\n+        };\n@@ -299,15 +314,0 @@\n-    \/**\n-     * Extract the number of constant pool entries from a given class file.\n-     *\n-     * @param classFile the bytes of the class file in question.\n-     * @return the number of entries in the constant pool.\n-     *\/\n-    private static int getConstantPoolSize(byte[] classFile) {\n-        \/\/ The first few bytes:\n-        \/\/ u4 magic;\n-        \/\/ u2 minor_version;\n-        \/\/ u2 major_version;\n-        \/\/ u2 constant_pool_count;\n-        return ((classFile[8] & 0xFF) << 8) | (classFile[9] & 0xFF);\n-    }\n-\n@@ -343,2 +343,2 @@\n-                CLASS_PREFIX + className, null, INVOKER_SUPER_NAME, null);\n-        cw.visitSource(SOURCE_PREFIX + className, null);\n+                CLASS_PREFIX.concat(className), null, INVOKER_SUPER_NAME, null);\n+        cw.visitSource(SOURCE_PREFIX.concat(className), null);\n@@ -362,1 +362,1 @@\n-        return CLASS_PREFIX + className;\n+        return CLASS_PREFIX.concat(className);\n@@ -669,11 +669,9 @@\n-        int opcode;\n-        switch (type) {\n-        case I_TYPE:  opcode = Opcodes.IRETURN;  break;\n-        case J_TYPE:  opcode = Opcodes.LRETURN;  break;\n-        case F_TYPE:  opcode = Opcodes.FRETURN;  break;\n-        case D_TYPE:  opcode = Opcodes.DRETURN;  break;\n-        case L_TYPE:  opcode = Opcodes.ARETURN;  break;\n-        case V_TYPE:  opcode = Opcodes.RETURN;   break;\n-        default:\n-            throw new InternalError(\"unknown return type: \" + type);\n-        }\n+        int opcode = switch (type) {\n+            case I_TYPE -> Opcodes.IRETURN;\n+            case J_TYPE -> Opcodes.LRETURN;\n+            case F_TYPE -> Opcodes.FRETURN;\n+            case D_TYPE -> Opcodes.DRETURN;\n+            case L_TYPE -> Opcodes.ARETURN;\n+            case V_TYPE -> Opcodes.RETURN;\n+            default -> throw new InternalError(\"unknown return type: \" + type);\n+        };\n@@ -726,1 +724,1 @@\n-            case GENERIC_LINKER:            return resolveFrom(name, invokerType.basicType(), Invokers.Holder.class);\n+            case GENERIC_LINKER:            return resolveFrom(name, invokerType, Invokers.Holder.class);\n@@ -861,2 +859,2 @@\n-                        assert(name.arguments[0] instanceof Name &&\n-                                ((Name)name.arguments[0]).refersTo(MethodHandleImpl.class, \"profileBoolean\"));\n+                        assert(name.arguments[0] instanceof Name n &&\n+                                n.refersTo(MethodHandleImpl.class, \"profileBoolean\"));\n@@ -1691,2 +1689,1 @@\n-        if (arg instanceof Name) {\n-            Name n = (Name) arg;\n+        if (arg instanceof Name n) {\n@@ -1695,2 +1692,4 @@\n-        } else if ((arg == null || arg instanceof String) && bptype == L_TYPE) {\n-            emitConst(arg);\n+        } else if (arg == null && bptype == L_TYPE) {\n+            mv.visitInsn(Opcodes.ACONST_NULL);\n+        } else if (arg instanceof String && bptype == L_TYPE) {\n+            mv.visitLdcInsn(arg);\n","filename":"src\/java.base\/share\/classes\/java\/lang\/invoke\/InvokerBytecodeGenerator.java","additions":47,"deletions":48,"binary":false,"changes":95,"status":"modified"},{"patch":"@@ -215,20 +215,0 @@\n-        static BasicType[] basicTypes(String types) {\n-            BasicType[] btypes = new BasicType[types.length()];\n-            for (int i = 0; i < btypes.length; i++) {\n-                btypes[i] = basicType(types.charAt(i));\n-            }\n-            return btypes;\n-        }\n-        static String basicTypeDesc(BasicType[] types) {\n-            if (types == null) {\n-                return null;\n-            }\n-            if (types.length == 0) {\n-                return \"\";\n-            }\n-            StringBuilder sb = new StringBuilder();\n-            for (BasicType bt : types) {\n-                sb.append(bt.basicTypeChar());\n-            }\n-            return sb.toString();\n-        }\n@@ -391,3 +371,0 @@\n-    LambdaForm(int arity, Name[] names, boolean forceInline) {\n-        this(arity, names, LAST_RESULT, forceInline, \/*customized=*\/null, Kind.GENERIC);\n-    }\n@@ -397,6 +374,0 @@\n-    LambdaForm(Name[] formals, Name[] temps, Name result) {\n-        this(formals.length, buildNames(formals, temps, result), LAST_RESULT, \/*forceInline=*\/true, \/*customized=*\/null);\n-    }\n-    LambdaForm(Name[] formals, Name[] temps, Name result, boolean forceInline) {\n-        this(formals.length, buildNames(formals, temps, result), LAST_RESULT, forceInline, \/*customized=*\/null);\n-    }\n@@ -600,2 +571,1 @@\n-                if (arg instanceof Name) {\n-                    Name n2 = (Name) arg;\n+                if (arg instanceof Name n2) {\n@@ -632,1 +602,0 @@\n-        assert(n < arity);\n@@ -634,1 +603,1 @@\n-        assert(param.isParam());\n+        assert(n < arity && param.isParam());\n@@ -673,3 +642,0 @@\n-    static BasicType signatureReturn(String sig) {\n-        return basicType(sig.charAt(signatureArity(sig) + 1));\n-    }\n@@ -690,10 +656,0 @@\n-    static MethodType signatureType(String sig) {\n-        Class<?>[] ptypes = new Class<?>[signatureArity(sig)];\n-        for (int i = 0; i < ptypes.length; i++)\n-            ptypes[i] = basicType(sig.charAt(i)).btClass;\n-        Class<?> rtype = signatureReturn(sig).btClass;\n-        return MethodType.makeImpl(rtype, ptypes, true);\n-    }\n-    static MethodType basicMethodType(MethodType mt) {\n-        return signatureType(basicTypeSignature(mt));\n-    }\n@@ -978,2 +934,2 @@\n-            if (a instanceof Name) {\n-                int i2 = ((Name)a).index();\n+            if (a instanceof Name n) {\n+                int i2 = n.index();\n@@ -1084,1 +1040,1 @@\n-        return obj instanceof LambdaForm && equals((LambdaForm)obj);\n+        return obj instanceof LambdaForm lf && equals(lf);\n@@ -1179,2 +1135,1 @@\n-            if (!(other instanceof NamedFunction)) return false;\n-            NamedFunction that = (NamedFunction) other;\n+            if (!(other instanceof NamedFunction that)) return false;\n@@ -1330,1 +1285,1 @@\n-                    buf.append(signature.substring(i - c1reps, len));\n+                    buf.append(signature, i - c1reps, len);\n@@ -1384,1 +1339,1 @@\n-            assert(arguments[0] instanceof Name && ((Name)arguments[0]).type == L_TYPE);\n+            assert(arguments[0] instanceof Name n && n.type == L_TYPE);\n@@ -1413,5 +1368,0 @@\n-        void resolve() {\n-            if (function != null)\n-                function.resolve();\n-        }\n-\n@@ -1458,2 +1408,1 @@\n-                if (arguments[j] instanceof Name) {\n-                    Name n = (Name) arguments[j];\n+                if (arguments[j] instanceof Name n) {\n@@ -1486,2 +1435,1 @@\n-                if (arguments[j] instanceof Name) {\n-                    Name n = (Name) arguments[j];\n+                if (arguments[j] instanceof Name n) {\n@@ -1545,1 +1493,3 @@\n-            if (c instanceof Class)  c = ((Class<?>)c).getSimpleName();\n+            if (c instanceof Class clazz) {\n+                c = clazz.getSimpleName();\n+            }\n@@ -1573,2 +1523,2 @@\n-            if (object instanceof Name) {\n-                return ((Name)object).type == parameterType;\n+            if (object instanceof Name n) {\n+                return n.type == parameterType;\n@@ -1609,4 +1559,0 @@\n-        boolean contains(Name n) {\n-            return this == n || lastUseIndex(n) >= 0;\n-        }\n-\n@@ -1626,1 +1572,1 @@\n-            return x instanceof Name && equals((Name)x);\n+            return x instanceof Name n && equals(n);\n","filename":"src\/java.base\/share\/classes\/java\/lang\/invoke\/LambdaForm.java","additions":16,"deletions":70,"binary":false,"changes":86,"status":"modified"},{"patch":"@@ -107,2 +107,2 @@\n-            if (obj instanceof TransformKey) {\n-                return equals((TransformKey) obj);\n+            if (obj instanceof TransformKey key) {\n+                return equals(key);\n@@ -110,1 +110,1 @@\n-            return obj instanceof Transform && equals((Transform)obj);\n+            return obj instanceof Transform t && equals(t);\n@@ -305,2 +305,2 @@\n-            if (obj instanceof TransformKey) {\n-                return equals((TransformKey) obj);\n+            if (obj instanceof TransformKey key) {\n+                return equals(key);\n@@ -308,1 +308,1 @@\n-            return obj instanceof Transform && equals((Transform)obj);\n+            return obj instanceof Transform t && equals(t);\n@@ -340,1 +340,1 @@\n-        } else if (c instanceof Transform) {\n+        } else if (c instanceof Transform t) {\n@@ -342,1 +342,0 @@\n-            Transform t = (Transform)c;\n@@ -346,4 +345,6 @@\n-            for (int i = 0; i < ta.length; i++) {\n-                Transform t = ta[i];\n-                if (t == null)  break;\n-                if (t.equals(key)) { k = t; break; }\n+            for (Transform t : ta) {\n+                if (t == null) break;\n+                if (t.equals(key)) {\n+                    k = t;\n+                    break;\n+                }\n@@ -392,2 +393,1 @@\n-                if (c instanceof Transform) {\n-                    Transform k = (Transform)c;\n+                if (c instanceof Transform k) {\n","filename":"src\/java.base\/share\/classes\/java\/lang\/invoke\/LambdaFormEditor.java","additions":14,"deletions":14,"binary":false,"changes":28,"status":"modified"},{"patch":"@@ -143,2 +143,2 @@\n-            if (type instanceof MethodType) {\n-                return (MethodType) type;\n+            if (type instanceof MethodType mt) {\n+                return mt;\n@@ -150,2 +150,1 @@\n-            if (type instanceof String) {\n-                String sig = (String) type;\n+            if (type instanceof String sig) {\n@@ -154,2 +153,1 @@\n-            } else if (type instanceof Object[]) {\n-                Object[] typeInfo = (Object[]) type;\n+            } else if (type instanceof Object[] typeInfo) {\n","filename":"src\/java.base\/share\/classes\/java\/lang\/invoke\/MemberName.java","additions":4,"deletions":6,"binary":false,"changes":10,"status":"modified"},{"patch":"@@ -500,2 +500,2 @@\n-        if (type instanceof MethodType)\n-            return (MethodType) type;\n+        if (type instanceof MethodType mt)\n+            return mt;\n","filename":"src\/java.base\/share\/classes\/java\/lang\/invoke\/MethodHandleNatives.java","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -147,2 +147,2 @@\n-        if (ex instanceof Error)  throw (Error) ex;\n-        if (ex instanceof RuntimeException)  throw (RuntimeException) ex;\n+        if (ex instanceof Error err)  throw err;\n+        if (ex instanceof RuntimeException re)  throw re;\n","filename":"src\/java.base\/share\/classes\/java\/lang\/invoke\/MethodHandleStatics.java","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -2265,1 +2265,1 @@\n-                    if (!(constant instanceof Type)) {\n+                    if (!(constant instanceof Type type)) {\n@@ -2268,1 +2268,0 @@\n-                    Type type = ((Type) constant);\n@@ -4137,1 +4136,1 @@\n-            if (mh instanceof DirectMethodHandle\n+            if (mh instanceof DirectMethodHandle dmh\n@@ -4139,1 +4138,1 @@\n-                MemberName key = mh.internalMemberName();\n+                MemberName key = dmh.internalMemberName();\n@@ -4144,1 +4143,1 @@\n-                    LOOKASIDE_TABLE.put(key, (DirectMethodHandle) mh);\n+                    LOOKASIDE_TABLE.put(key, dmh);\n","filename":"src\/java.base\/share\/classes\/java\/lang\/invoke\/MethodHandles.java","additions":4,"deletions":5,"binary":false,"changes":9,"status":"modified"},{"patch":"@@ -202,8 +202,0 @@\n-    private static void checkRtype(Class<?> rtype) {\n-        Objects.requireNonNull(rtype);\n-    }\n-    private static void checkPtype(Class<?> ptype) {\n-        Objects.requireNonNull(ptype);\n-        if (ptype == void.class)\n-            throw newIllegalArgumentException(\"parameter type cannot be void\");\n-    }\n@@ -214,1 +206,3 @@\n-            checkPtype(ptype);\n+            Objects.requireNonNull(ptype);\n+            if (ptype == void.class)\n+                throw newIllegalArgumentException(\"parameter type cannot be void\");\n@@ -348,1 +342,1 @@\n-        MethodType.checkRtype(rtype);\n+        Objects.requireNonNull(rtype);\n@@ -418,1 +412,0 @@\n-        checkPtype(nptype);\n@@ -847,2 +840,2 @@\n-        if (x instanceof MethodType) {\n-            return equals((MethodType)x);\n+        if (x instanceof MethodType mt) {\n+            return equals(mt);\n@@ -850,4 +843,4 @@\n-        if (x instanceof ConcurrentWeakInternSet.WeakEntry) {\n-            Object o = ((ConcurrentWeakInternSet.WeakEntry)x).get();\n-            if (o instanceof MethodType) {\n-                return equals((MethodType)o);\n+        if (x instanceof ConcurrentWeakInternSet.WeakEntry e) {\n+            Object o = e.get();\n+            if (o instanceof MethodType mt) {\n+                return equals(mt);\n","filename":"src\/java.base\/share\/classes\/java\/lang\/invoke\/MethodType.java","additions":10,"deletions":17,"binary":false,"changes":27,"status":"modified"},{"patch":"@@ -284,2 +284,2 @@\n-            if (cause instanceof RuntimeException)\n-                throw (RuntimeException) cause;\n+            if (cause instanceof RuntimeException re)\n+                throw re;\n","filename":"src\/java.base\/share\/classes\/java\/lang\/invoke\/SerializedLambda.java","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -608,2 +608,1 @@\n-        if (handle instanceof DirectMethodHandle) {\n-            DirectMethodHandle directHandle = (DirectMethodHandle)handle;\n+        if (handle instanceof DirectMethodHandle directHandle) {\n@@ -632,2 +631,2 @@\n-        } else if (handle instanceof DelegatingMethodHandle) {\n-            noCheckedExceptions(((DelegatingMethodHandle)handle).getTarget());\n+        } else if (handle instanceof DelegatingMethodHandle delegatingHandle) {\n+            noCheckedExceptions(delegatingHandle.getTarget());\n@@ -639,2 +638,2 @@\n-                if (arg instanceof MethodHandle){\n-                    noCheckedExceptions((MethodHandle) arg);\n+                if (arg instanceof MethodHandle mh) {\n+                    noCheckedExceptions(mh);\n","filename":"src\/java.base\/share\/classes\/java\/lang\/invoke\/VarHandles.java","additions":5,"deletions":6,"binary":false,"changes":11,"status":"modified"}]}