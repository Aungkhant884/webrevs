{"files":[{"patch":"@@ -50,1 +50,1 @@\n-volatile outputStream* JVMCI::_fatal_log_stream = NULL;\n+volatile int JVMCI::_fatal_log_fd = -1;\n@@ -221,0 +221,1 @@\n+  int log_fd;\n@@ -223,1 +224,0 @@\n-    static fdStream log(-1);\n@@ -225,1 +225,1 @@\n-      log.set_fd(1);\n+      log_fd = 1;\n@@ -227,1 +227,1 @@\n-      log.set_fd(2);\n+      log_fd = 2;\n@@ -229,2 +229,2 @@\n-      int fd = VMError::prepare_log_file(JVMCINativeLibraryErrorFile, LIBJVMCI_ERR_FILE, true, name_buffer, sizeof(name_buffer));\n-      if (fd != -1) {\n+      log_fd = VMError::prepare_log_file(JVMCINativeLibraryErrorFile, LIBJVMCI_ERR_FILE, true, name_buffer, sizeof(name_buffer));\n+      if (log_fd != -1) {\n@@ -232,1 +232,0 @@\n-        log.set_fd(fd);\n@@ -240,1 +239,1 @@\n-        log.set_fd(1);\n+        log_fd = 1;\n@@ -242,1 +241,0 @@\n-      _fatal_log_stream = &log;\n@@ -244,0 +242,1 @@\n+    _fatal_log_fd = log_fd;\n@@ -249,1 +248,1 @@\n-    while (_fatal_log_stream == NULL) {\n+    while (_fatal_log_fd == -1) {\n@@ -253,3 +252,3 @@\n-  outputStream* out = (outputStream*) _fatal_log_stream;\n-  out->write(buf, count);\n-  out->flush();\n+  fdStream log(_fatal_log_fd);\n+  log.write(buf, count);\n+  log.flush();\n","filename":"src\/hotspot\/share\/jvmci\/jvmci.cpp","additions":12,"deletions":13,"binary":false,"changes":25,"status":"modified"},{"patch":"@@ -77,1 +77,1 @@\n-  \/\/ The stream to which fatal_log() writes. The stream is configured on\n+  \/\/ The file descriptor to which fatal_log() writes. Initialized on\n@@ -79,1 +79,1 @@\n-  static volatile outputStream* _fatal_log_stream;\n+  static volatile int _fatal_log_fd;\n@@ -81,1 +81,1 @@\n-  \/\/ The path of the file underlying _fatal_log_stream if it is a fileStream.\n+  \/\/ The path of the file underlying _fatal_log_fd if it is a normal file.\n@@ -84,1 +84,1 @@\n-  \/\/ Native thread id of thread that will initialize _fatal_log_stream.\n+  \/\/ Native thread id of thread that will initialize _fatal_log_fd.\n","filename":"src\/hotspot\/share\/jvmci\/jvmci.hpp","additions":4,"deletions":4,"binary":false,"changes":8,"status":"modified"}]}