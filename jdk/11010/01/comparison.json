{"files":[{"patch":"@@ -1205,1 +1205,1 @@\n-    __ load_klass(t0, obj);\n+    __ load_klass(t0, obj, t1);\n","filename":"src\/hotspot\/cpu\/riscv\/c1_LIRAssembler_riscv.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -152,1 +152,1 @@\n-  assert_different_registers(obj, klass, len);\n+  assert_different_registers(obj, klass, len, tmp1, tmp2);\n@@ -158,1 +158,1 @@\n-    encode_klass_not_null(tmp1, klass);\n+    encode_klass_not_null(tmp1, klass, tmp2);\n@@ -304,1 +304,2 @@\n-  cmp_klass(receiver, iCache, t0, L);\n+  assert_different_registers(receiver, iCache, t0, t2);\n+  cmp_klass(receiver, iCache, t0, t2 \/* call-clobbered t2 as a tmp *\/, L);\n","filename":"src\/hotspot\/cpu\/riscv\/c1_MacroAssembler_riscv.cpp","additions":4,"deletions":3,"binary":false,"changes":7,"status":"modified"},{"patch":"@@ -1974,1 +1974,2 @@\n-void MacroAssembler::cmp_klass(Register oop, Register trial_klass, Register tmp, Label &L) {\n+void MacroAssembler::cmp_klass(Register oop, Register trial_klass, Register tmp1, Register tmp2, Label &L) {\n+  assert_different_registers(oop, trial_klass, tmp1, tmp2);\n@@ -1976,1 +1977,1 @@\n-      lwu(tmp, Address(oop, oopDesc::klass_offset_in_bytes()));\n+    lwu(tmp1, Address(oop, oopDesc::klass_offset_in_bytes()));\n@@ -1978,2 +1979,2 @@\n-      slli(tmp, tmp, CompressedKlassPointers::shift());\n-      beq(trial_klass, tmp, L);\n+      slli(tmp1, tmp1, CompressedKlassPointers::shift());\n+      beq(trial_klass, tmp1, L);\n@@ -1982,1 +1983,1 @@\n-    decode_klass_not_null(tmp);\n+    decode_klass_not_null(tmp1, tmp2);\n@@ -1984,1 +1985,1 @@\n-    ld(tmp, Address(oop, oopDesc::klass_offset_in_bytes()));\n+    ld(tmp1, Address(oop, oopDesc::klass_offset_in_bytes()));\n@@ -1986,1 +1987,1 @@\n-  beq(trial_klass, tmp, L);\n+  beq(trial_klass, tmp1, L);\n@@ -2163,1 +2164,3 @@\n-void MacroAssembler::load_klass(Register dst, Register src) {\n+void MacroAssembler::load_klass(Register dst, Register src, Register tmp) {\n+  assert_different_registers(dst, tmp);\n+  assert_different_registers(src, tmp);\n@@ -2166,1 +2169,1 @@\n-    decode_klass_not_null(dst);\n+    decode_klass_not_null(dst, tmp);\n@@ -2172,1 +2175,1 @@\n-void MacroAssembler::store_klass(Register dst, Register src) {\n+void MacroAssembler::store_klass(Register dst, Register src, Register tmp) {\n@@ -2176,1 +2179,1 @@\n-    encode_klass_not_null(src);\n+    encode_klass_not_null(src, tmp);\n@@ -2190,2 +2193,3 @@\n-void  MacroAssembler::decode_klass_not_null(Register r) {\n-  decode_klass_not_null(r, r);\n+void MacroAssembler::decode_klass_not_null(Register r, Register tmp) {\n+  assert_different_registers(r, tmp);\n+  decode_klass_not_null(r, r, tmp);\n@@ -2222,2 +2226,0 @@\n-\n-  if (xbase == xheapbase) { reinit_heapbase(); }\n@@ -2226,2 +2228,3 @@\n-void MacroAssembler::encode_klass_not_null(Register r) {\n-  encode_klass_not_null(r, r);\n+void MacroAssembler::encode_klass_not_null(Register r, Register tmp) {\n+  assert_different_registers(r, tmp);\n+  encode_klass_not_null(r, r, tmp);\n@@ -2261,3 +2264,0 @@\n-  if (xbase == xheapbase) {\n-    reinit_heapbase();\n-  }\n","filename":"src\/hotspot\/cpu\/riscv\/macroAssembler_riscv.cpp","additions":20,"deletions":20,"binary":false,"changes":40,"status":"modified"},{"patch":"@@ -198,8 +198,8 @@\n-  void load_klass(Register dst, Register src);\n-  void store_klass(Register dst, Register src);\n-  void cmp_klass(Register oop, Register trial_klass, Register tmp, Label &L);\n-\n-  void encode_klass_not_null(Register r);\n-  void decode_klass_not_null(Register r);\n-  void encode_klass_not_null(Register dst, Register src, Register tmp = xheapbase);\n-  void decode_klass_not_null(Register dst, Register src, Register tmp = xheapbase);\n+  void load_klass(Register dst, Register src, Register tmp = t0);\n+  void store_klass(Register dst, Register src, Register tmp = t0);\n+  void cmp_klass(Register oop, Register trial_klass, Register tmp1, Register tmp2, Label &L);\n+\n+  void encode_klass_not_null(Register r, Register tmp = t0);\n+  void decode_klass_not_null(Register r, Register tmp = t0);\n+  void encode_klass_not_null(Register dst, Register src, Register tmp);\n+  void decode_klass_not_null(Register dst, Register src, Register tmp);\n","filename":"src\/hotspot\/cpu\/riscv\/macroAssembler_riscv.hpp","additions":8,"deletions":8,"binary":false,"changes":16,"status":"modified"},{"patch":"@@ -74,1 +74,1 @@\n-  Register temp = t1;\n+  Register temp1 = t1;\n@@ -80,3 +80,3 @@\n-  __ push_reg(RegSet::of(temp, temp2), sp);\n-  __ load_klass(temp, obj);\n-  __ cmpptr(temp, ExternalAddress((address) klass_addr), L_ok);\n+  __ push_reg(RegSet::of(temp1, temp2), sp);\n+  __ load_klass(temp1, obj, temp2);\n+  __ cmpptr(temp1, ExternalAddress((address) klass_addr), L_ok);\n@@ -84,3 +84,3 @@\n-  __ ld(temp, Address(temp, super_check_offset));\n-  __ cmpptr(temp, ExternalAddress((address) klass_addr), L_ok);\n-  __ pop_reg(RegSet::of(temp, temp2), sp);\n+  __ ld(temp1, Address(temp1, super_check_offset));\n+  __ cmpptr(temp1, ExternalAddress((address) klass_addr), L_ok);\n+  __ pop_reg(RegSet::of(temp1, temp2), sp);\n@@ -90,1 +90,1 @@\n-  __ pop_reg(RegSet::of(temp, temp2), sp);\n+  __ pop_reg(RegSet::of(temp1, temp2), sp);\n","filename":"src\/hotspot\/cpu\/riscv\/methodHandles_riscv.cpp","additions":8,"deletions":8,"binary":false,"changes":16,"status":"modified"},{"patch":"@@ -1741,1 +1741,1 @@\n-  __ cmp_klass(j_rarg0, t1, t0, skip);\n+  __ cmp_klass(j_rarg0, t1, t0, t2 \/* call-clobbered t2 as a tmp *\/, skip);\n","filename":"src\/hotspot\/cpu\/riscv\/riscv.ad","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -642,1 +642,1 @@\n-    __ load_klass(t0, receiver);\n+    __ load_klass(t0, receiver, tmp);\n@@ -1413,1 +1413,0 @@\n-  assert_different_registers(ic_reg, receiver, t0);\n@@ -1415,1 +1414,2 @@\n-  __ cmp_klass(receiver, ic_reg, t0, hit);\n+  assert_different_registers(ic_reg, receiver, t0, t2);\n+  __ cmp_klass(receiver, ic_reg, t0, t2 \/* call-clobbered t2 as a tmp *\/, hit);\n","filename":"src\/hotspot\/cpu\/riscv\/sharedRuntime_riscv.cpp","additions":3,"deletions":3,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -1793,1 +1793,1 @@\n-      __ load_klass(t0, dst);\n+      __ load_klass(t0, dst, t1);\n","filename":"src\/hotspot\/cpu\/riscv\/stubGenerator_riscv.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"}]}