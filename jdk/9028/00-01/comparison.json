{"files":[{"patch":"@@ -2,1 +2,1 @@\n-# Copyright (c) 2016, 2021, Oracle and\/or its affiliates. All rights reserved.\n+# Copyright (c) 2016, 2022, Oracle and\/or its affiliates. All rights reserved.\n@@ -39,18 +39,0 @@\n-HASH:=\\#\n-\n-define IfAppend\n-$(if $(strip $1),$(strip $1)$(strip $2),)\n-endef\n-\n-define IfPrepend\n-$(if $(strip $1),$(strip $2)$(strip $1),)\n-endef\n-\n-define TestID\n-$(subst .java,,$(subst .java$(HASH),,$(suffix $(notdir $1))))\n-endef\n-\n-define HashTestID\n-$(call IfPrepend,$(call TestID,$1),$(HASH))\n-endef\n-\n@@ -370,0 +352,5 @@\n+# with selection: dir\/Test.java#selection -> Test.java#selection -> .java#selection -> #selection\n+# or without:     dir\/Test.java           -> Test.java           -> .java           -> <<empty string>>\n+TestID = \\\n+    $(subst .java,,$(subst .java,,$(suffix $(notdir $1))))\n+\n@@ -377,14 +364,4 @@\n-$(call IfAppend, \\\n-  $(eval TEST_NAME := $(strip $(patsubst jtreg:%, %, $1))) \\\n-  $(if $(or $(findstring :, $(TEST_NAME)), $(findstring \/, $(TEST_NAME))), , \\\n-    $(eval TEST_NAME := :$(TEST_NAME)) \\\n-  ) \\\n-  $(if $(findstring :, $(TEST_NAME)), \\\n-    $(if $(filter :%, $(TEST_NAME)), \\\n-      $(eval TEST_GROUP := $(patsubst :%, %, $(TEST_NAME))) \\\n-      $(eval TEST_ROOTS := $(foreach test_root, $(JTREG_TESTROOTS), \\\n-          $(call CleanupJtregPath, $(test_root)))) \\\n-    , \\\n-      $(eval TEST_PATH := $(word 1, $(subst :, $(SPACE), $(TEST_NAME)))) \\\n-      $(eval TEST_GROUP := $(word 2, $(subst :, $(SPACE), $(TEST_NAME)))) \\\n-      $(eval TEST_ROOTS := $(call ExpandJtregRoot, $(TEST_PATH))) \\\n+  $(call IfAppend, \\\n+    $(eval TEST_NAME := $(strip $(patsubst jtreg:%, %, $1))) \\\n+    $(if $(or $(findstring :, $(TEST_NAME)), $(findstring \/, $(TEST_NAME))), , \\\n+      $(eval TEST_NAME := :$(TEST_NAME)) \\\n@@ -392,3 +369,5 @@\n-    $(foreach test_root, $(TEST_ROOTS), \\\n-      $(if $(filter \/%, $(test_root)), \\\n-        jtreg:$(test_root):$(TEST_GROUP) \\\n+    $(if $(findstring :, $(TEST_NAME)), \\\n+      $(if $(filter :%, $(TEST_NAME)), \\\n+        $(eval TEST_GROUP := $(patsubst :%, %, $(TEST_NAME))) \\\n+        $(eval TEST_ROOTS := $(foreach test_root, $(JTREG_TESTROOTS), \\\n+            $(call CleanupJtregPath, $(test_root)))) \\\n@@ -396,1 +375,6 @@\n-        $(if $(filter $(TEST_GROUP), $($(JTREG_TOPDIR)\/$(test_root)_JTREG_TEST_GROUPS)), \\\n+        $(eval TEST_PATH := $(word 1, $(subst :, $(SPACE), $(TEST_NAME)))) \\\n+        $(eval TEST_GROUP := $(word 2, $(subst :, $(SPACE), $(TEST_NAME)))) \\\n+        $(eval TEST_ROOTS := $(call ExpandJtregRoot, $(TEST_PATH))) \\\n+      ) \\\n+      $(foreach test_root, $(TEST_ROOTS), \\\n+        $(if $(filter \/%, $(test_root)), \\\n@@ -398,0 +382,4 @@\n+        , \\\n+          $(if $(filter $(TEST_GROUP), $($(JTREG_TOPDIR)\/$(test_root)_JTREG_TEST_GROUPS)), \\\n+            jtreg:$(test_root):$(TEST_GROUP) \\\n+          ) \\\n@@ -400,0 +388,5 @@\n+    , \\\n+      $(eval TEST_PATHS := $(call ExpandJtregPath, $(TEST_NAME))) \\\n+      $(foreach test_path, $(TEST_PATHS), \\\n+        jtreg:$(test_path) \\\n+      ) \\\n@@ -402,5 +395,2 @@\n-    $(eval TEST_PATHS := $(call ExpandJtregPath, $(TEST_NAME))) \\\n-    $(foreach test_path, $(TEST_PATHS), \\\n-      jtreg:$(test_path) \\\n-    ) \\\n-  ),$(call HashTestID,$1))\n+    $(call TestID, $1) \\\n+  )\n@@ -442,2 +432,7 @@\n-$(strip $(foreach parser,ParseCustomTestSelection ParseGtestTestSelection ParseMicroTestSelection ParseJtregTestSelection ParseSpecialTestSelection \\\n- ,$(call $(parser),$1)))\n+  $(strip $(or \\\n+    $(call ParseCustomTestSelection, $1) \\\n+    $(call ParseGtestTestSelection, $1) \\\n+    $(call ParseMicroTestSelection, $1) \\\n+    $(call ParseJtregTestSelection, $1) \\\n+    $(call ParseSpecialTestSelection, $1) \\\n+  ))\n@@ -448,2 +443,2 @@\n-TESTS_TO_RUN:=$(strip $(foreach test,$(TEST),$(call ParseTestSelection,$(test))))\n-UNKNOWN_TEST:=$(strip $(foreach test,$(TEST),$(if $(call ParseTestSelection,$(test)),,$(test))))\n+TESTS_TO_RUN := $(strip $(foreach test, $(TEST), $(call ParseTestSelection, $(test))))\n+UNKNOWN_TEST := $(strip $(foreach test, $(TEST), $(if $(call ParseTestSelection, $(test)), , $(test))))\n","filename":"make\/RunTests.gmk","additions":41,"deletions":46,"binary":false,"changes":87,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n-# Copyright (c) 2011, 2020, Oracle and\/or its affiliates. All rights reserved.\n+# Copyright (c) 2011, 2022, Oracle and\/or its affiliates. All rights reserved.\n@@ -71,0 +71,9 @@\n+################################################################################\n+# Strip both arguments. Concat (append or prepend) the first argument to the\n+# second argument. If the first argument is empty, return the empty string.\n+IfAppend = \\\n+    $(if $(strip $1),$(strip $1)$(strip $2),)\n+\n+IfPrepend = \\\n+    $(if $(strip $1),$(strip $2)$(strip $1),)\n+\n","filename":"make\/common\/Utils.gmk","additions":10,"deletions":1,"binary":false,"changes":11,"status":"modified"}]}