{"files":[{"patch":"@@ -693,2 +693,1 @@\n-    \/\/ We can only use that safepoint if there's not side effect\n-    \/\/ between the backedge and the safepoint.\n+    \/\/ We can only use that safepoint if there's no side effect between the backedge and the safepoint.\n@@ -1852,1 +1851,1 @@\n-  Node *sfpt2 = NULL;\n+  Node* sfpt = NULL;\n@@ -1854,1 +1853,1 @@\n-    sfpt2 = find_safepoint(back_control, x, loop);\n+    sfpt = find_safepoint(back_control, x, loop);\n@@ -1856,3 +1855,3 @@\n-    sfpt2 = iff->in(0);\n-    if (sfpt2->Opcode() != Op_SafePoint) {\n-      sfpt2 = NULL;\n+    sfpt = iff->in(0);\n+    if (sfpt->Opcode() != Op_SafePoint) {\n+      sfpt = NULL;\n@@ -1863,2 +1862,1 @@\n-    Node *sfpt = x->in(LoopNode::LoopBackControl);\n-    bool deleteable = is_deleteable_safept(sfpt);\n+    Node* backedge_sfpt = x->in(LoopNode::LoopBackControl);\n@@ -1867,1 +1865,1 @@\n-        sfpt2 == NULL) {\n+        sfpt == NULL) {\n@@ -1874,2 +1872,2 @@\n-    if (deleteable) {\n-      lazy_replace(sfpt, iftrue);\n+    if (is_deleteable_safept(backedge_sfpt)) {\n+      lazy_replace(backedge_sfpt, iftrue);\n@@ -1877,1 +1875,1 @@\n-        loop->_safepts->yank(sfpt);\n+        loop->_safepts->yank(backedge_sfpt);\n@@ -1997,1 +1995,1 @@\n-                         sfpt2 != NULL &&\n+                         sfpt != NULL &&\n@@ -2023,1 +2021,1 @@\n-    if (sfpt2 != NULL && (LoopStripMiningIter != 0 || is_deleteable_safept(sfpt2))) {\n+    if (sfpt != NULL && (LoopStripMiningIter != 0 || is_deleteable_safept(sfpt))) {\n@@ -2026,3 +2024,3 @@\n-        Node* sfpt = sfpt2->clone();\n-        sfpt->set_req(0, iffalse);\n-        outer_le->set_req(0, sfpt);\n+        Node* sfpt_clone = sfpt->clone();\n+        sfpt_clone->set_req(0, iffalse);\n+        outer_le->set_req(0, sfpt_clone);\n@@ -2030,1 +2028,1 @@\n-        Node* polladdr = sfpt->in(TypeFunc::Parms);\n+        Node* polladdr = sfpt_clone->in(TypeFunc::Parms);\n@@ -2037,1 +2035,1 @@\n-          sfpt->set_req(TypeFunc::Parms, new_polladdr);\n+          sfpt_clone->set_req(TypeFunc::Parms, new_polladdr);\n@@ -2041,2 +2039,2 @@\n-        register_control(sfpt, outer_ilt, iffalse, body_populated);\n-        set_idom(outer_le, sfpt, dom_depth(sfpt));\n+        register_control(sfpt_clone, outer_ilt, iffalse, body_populated);\n+        set_idom(outer_le, sfpt_clone, dom_depth(sfpt_clone));\n@@ -2044,1 +2042,1 @@\n-      lazy_replace( sfpt2, sfpt2->in(TypeFunc::Control));\n+      lazy_replace(sfpt, sfpt->in(TypeFunc::Control));\n@@ -2046,1 +2044,1 @@\n-        loop->_safepts->yank(sfpt2);\n+        loop->_safepts->yank(sfpt);\n","filename":"src\/hotspot\/share\/opto\/loopnode.cpp","additions":22,"deletions":24,"binary":false,"changes":46,"status":"modified"}]}