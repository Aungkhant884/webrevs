{"files":[{"patch":"@@ -24,1 +24,1 @@\n- * Copyright (c) 2005, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2005, 2022, Oracle and\/or its affiliates. All rights reserved.\n@@ -303,29 +303,16 @@\n-            Element curElem = DOMUtils.getFirstChildElement(kvtElem);\n-            if (curElem == null) {\n-                throw new MarshalException(\"KeyValue must contain at least one type\");\n-            }\n-            \/\/ check for P and Q\n-            BigInteger p = null;\n-            BigInteger q = null;\n-            if (\"P\".equals(curElem.getLocalName()) && XMLSignature.XMLNS.equals(curElem.getNamespaceURI())) {\n-                p = decode(curElem);\n-                curElem = DOMUtils.getNextSiblingElement(curElem, \"Q\", XMLSignature.XMLNS);\n-                q = decode(curElem);\n-                curElem = DOMUtils.getNextSiblingElement(curElem);\n-            }\n-            BigInteger g = null;\n-            if (curElem != null\n-                && \"G\".equals(curElem.getLocalName()) && XMLSignature.XMLNS.equals(curElem.getNamespaceURI())) {\n-                g = decode(curElem);\n-                curElem = DOMUtils.getNextSiblingElement(curElem, \"Y\", XMLSignature.XMLNS);\n-            }\n-            BigInteger y = null;\n-            if (curElem != null) {\n-                y = decode(curElem);\n-                curElem = DOMUtils.getNextSiblingElement(curElem);\n-            }\n-            \/\/if (curElem != null && \"J\".equals(curElem.getLocalName())) {\n-                \/\/j = new DOMCryptoBinary(curElem.getFirstChild());\n-                \/\/ curElem = DOMUtils.getNextSiblingElement(curElem);\n-            \/\/}\n-            \/\/@@@ do we care about j, pgenCounter or seed?\n+            \/\/ P, Q, and G are optional according to the XML Signature\n+            \/\/ Recommendation as they might be known from application context,\n+            \/\/ but this implementation does not support that, so they are\n+            \/\/ required.\n+            Element curElem =\n+                DOMUtils.getFirstChildElement(kvtElem, \"P\", XMLSignature.XMLNS);\n+            BigInteger p = decode(curElem);\n+            curElem =\n+                DOMUtils.getNextSiblingElement(curElem, \"Q\", XMLSignature.XMLNS);\n+            BigInteger q = decode(curElem);\n+            curElem =\n+                DOMUtils.getNextSiblingElement(curElem, \"G\", XMLSignature.XMLNS);\n+            BigInteger g = decode(curElem);\n+            curElem =\n+                DOMUtils.getNextSiblingElement(curElem, \"Y\", XMLSignature.XMLNS);\n+            BigInteger y = decode(curElem);\n","filename":"src\/java.xml.crypto\/share\/classes\/org\/jcp\/xml\/dsig\/internal\/dom\/DOMKeyValue.java","additions":17,"deletions":30,"binary":false,"changes":47,"status":"modified"}]}