{"files":[{"patch":"@@ -65,0 +65,1 @@\n+    static final boolean VAR_HANDLE_SEGMENT_FORCE_EXACT;\n@@ -94,0 +95,2 @@\n+        VAR_HANDLE_SEGMENT_FORCE_EXACT = Boolean.parseBoolean(\n+                props.getProperty(\"java.lang.invoke.VarHandle.VAR_HANDLE_SEGMENT_FORCE_EXACT\", \"false\"));\n","filename":"src\/java.base\/share\/classes\/java\/lang\/invoke\/MethodHandleStatics.java","additions":3,"deletions":0,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -44,0 +44,1 @@\n+import static java.lang.invoke.MethodHandleStatics.VAR_HANDLE_SEGMENT_FORCE_EXACT;\n@@ -320,1 +321,1 @@\n-        boolean exact = false;\n+        boolean exact = VAR_HANDLE_SEGMENT_FORCE_EXACT;\n","filename":"src\/java.base\/share\/classes\/java\/lang\/invoke\/VarHandles.java","additions":2,"deletions":1,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -739,1 +739,1 @@\n-        return (byte) layout.varHandle().get(this, offset);\n+        return (byte) layout.varHandle().get((MemorySegment)this, offset);\n@@ -745,1 +745,1 @@\n-        layout.varHandle().set(this, offset, value);\n+        layout.varHandle().set((MemorySegment)this, offset, value);\n@@ -751,1 +751,1 @@\n-        return (boolean) layout.varHandle().get(this, offset);\n+        return (boolean) layout.varHandle().get((MemorySegment)this, offset);\n@@ -757,1 +757,1 @@\n-        layout.varHandle().set(this, offset, value);\n+        layout.varHandle().set((MemorySegment)this, offset, value);\n@@ -763,1 +763,1 @@\n-        return (char) layout.varHandle().get(this, offset);\n+        return (char) layout.varHandle().get((MemorySegment)this, offset);\n@@ -769,1 +769,1 @@\n-        layout.varHandle().set(this, offset, value);\n+        layout.varHandle().set((MemorySegment)this, offset, value);\n@@ -775,1 +775,1 @@\n-        return (short) layout.varHandle().get(this, offset);\n+        return (short) layout.varHandle().get((MemorySegment)this, offset);\n@@ -781,1 +781,1 @@\n-        layout.varHandle().set(this, offset, value);\n+        layout.varHandle().set((MemorySegment)this, offset, value);\n@@ -787,1 +787,1 @@\n-        return (int) layout.varHandle().get(this, offset);\n+        return (int) layout.varHandle().get((MemorySegment)this, offset);\n@@ -793,1 +793,1 @@\n-        layout.varHandle().set(this, offset, value);\n+        layout.varHandle().set((MemorySegment)this, offset, value);\n@@ -799,1 +799,1 @@\n-        return (float) layout.varHandle().get(this, offset);\n+        return (float) layout.varHandle().get((MemorySegment)this, offset);\n@@ -805,1 +805,1 @@\n-        layout.varHandle().set(this, offset, value);\n+        layout.varHandle().set((MemorySegment)this, offset, value);\n@@ -811,1 +811,1 @@\n-        return (long) layout.varHandle().get(this, offset);\n+        return (long) layout.varHandle().get((MemorySegment)this, offset);\n@@ -817,1 +817,1 @@\n-        layout.varHandle().set(this, offset, value);\n+        layout.varHandle().set((MemorySegment)this, offset, value);\n@@ -823,1 +823,1 @@\n-        return (double) layout.varHandle().get(this, offset);\n+        return (double) layout.varHandle().get((MemorySegment)this, offset);\n@@ -829,1 +829,1 @@\n-        layout.varHandle().set(this, offset, value);\n+        layout.varHandle().set((MemorySegment)this, offset, value);\n@@ -835,1 +835,1 @@\n-        return (MemorySegment) layout.varHandle().get(this, offset);\n+        return (MemorySegment) layout.varHandle().get((MemorySegment)this, offset);\n@@ -841,1 +841,1 @@\n-        layout.varHandle().set(this, offset, value);\n+        layout.varHandle().set((MemorySegment)this, offset, value);\n@@ -848,1 +848,1 @@\n-        return (byte) layout.varHandle().get(this, index * layout.byteSize());\n+        return (byte) layout.varHandle().get((MemorySegment)this, index * layout.byteSize());\n@@ -855,1 +855,1 @@\n-        return (boolean) layout.varHandle().get(this, index * layout.byteSize());\n+        return (boolean) layout.varHandle().get((MemorySegment)this, index * layout.byteSize());\n@@ -862,1 +862,1 @@\n-        return (char) layout.varHandle().get(this, index * layout.byteSize());\n+        return (char) layout.varHandle().get((MemorySegment)this, index * layout.byteSize());\n@@ -869,1 +869,1 @@\n-        layout.varHandle().set(this, index * layout.byteSize(), value);\n+        layout.varHandle().set((MemorySegment)this, index * layout.byteSize(), value);\n@@ -876,1 +876,1 @@\n-        return (short) layout.varHandle().get(this, index * layout.byteSize());\n+        return (short) layout.varHandle().get((MemorySegment)this, index * layout.byteSize());\n@@ -883,1 +883,1 @@\n-        layout.varHandle().set(this, index * layout.byteSize(), value);\n+        layout.varHandle().set((MemorySegment)this, index * layout.byteSize(), value);\n@@ -890,1 +890,1 @@\n-        layout.varHandle().set(this, index * layout.byteSize(), value);\n+        layout.varHandle().set((MemorySegment)this, index * layout.byteSize(), value);\n@@ -897,1 +897,1 @@\n-        layout.varHandle().set(this, index * layout.byteSize(), value);\n+        layout.varHandle().set((MemorySegment)this, index * layout.byteSize(), value);\n@@ -904,1 +904,1 @@\n-        return (int) layout.varHandle().get(this, index * layout.byteSize());\n+        return (int) layout.varHandle().get((MemorySegment)this, index * layout.byteSize());\n@@ -911,1 +911,1 @@\n-        layout.varHandle().set(this, index * layout.byteSize(), value);\n+        layout.varHandle().set((MemorySegment)this, index * layout.byteSize(), value);\n@@ -918,1 +918,1 @@\n-        return (float) layout.varHandle().get(this, index * layout.byteSize());\n+        return (float) layout.varHandle().get((MemorySegment)this, index * layout.byteSize());\n@@ -925,1 +925,1 @@\n-        layout.varHandle().set(this, index * layout.byteSize(), value);\n+        layout.varHandle().set((MemorySegment)this, index * layout.byteSize(), value);\n@@ -932,1 +932,1 @@\n-        return (long) layout.varHandle().get(this, index * layout.byteSize());\n+        return (long) layout.varHandle().get((MemorySegment)this, index * layout.byteSize());\n@@ -939,1 +939,1 @@\n-        layout.varHandle().set(this, index * layout.byteSize(), value);\n+        layout.varHandle().set((MemorySegment)this, index * layout.byteSize(), value);\n@@ -946,1 +946,1 @@\n-        return (double) layout.varHandle().get(this, index * layout.byteSize());\n+        return (double) layout.varHandle().get((MemorySegment)this, index * layout.byteSize());\n@@ -953,1 +953,1 @@\n-        layout.varHandle().set(this, index * layout.byteSize(), value);\n+        layout.varHandle().set((MemorySegment)this, index * layout.byteSize(), value);\n@@ -960,1 +960,1 @@\n-        return (MemorySegment) layout.varHandle().get(this, index * layout.byteSize());\n+        return (MemorySegment) layout.varHandle().get((MemorySegment)this, index * layout.byteSize());\n@@ -967,1 +967,1 @@\n-        layout.varHandle().set(this, index * layout.byteSize(), value);\n+        layout.varHandle().set((MemorySegment)this, index * layout.byteSize(), value);\n","filename":"src\/java.base\/share\/classes\/jdk\/internal\/foreign\/AbstractMemorySegmentImpl.java","additions":36,"deletions":36,"binary":false,"changes":72,"status":"modified"},{"patch":"@@ -27,0 +27,1 @@\n+ * @run testng\/othervm -Djava.lang.invoke.VarHandle.VAR_HANDLE_SEGMENT_FORCE_EXACT=true --enable-native-access=ALL-UNNAMED TestMemoryAccessInstance\n","filename":"test\/jdk\/java\/foreign\/TestMemoryAccessInstance.java","additions":1,"deletions":0,"binary":false,"changes":1,"status":"modified"}]}