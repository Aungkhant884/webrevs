{"files":[{"patch":"@@ -301,0 +301,1 @@\n+  DECL_EVENT_CALLBACK(app_data);\n@@ -302,1 +303,23 @@\n-  (*printf_callback)(printf_stream, \".4byte\\t0x%08x\\n\", *(uint32_t*)addr);\n+\n+  uintptr_t p = (uintptr_t)addr;\n+  uintptr_t end = app_data->end_va;\n+\n+  for (int i = 0; p < end; i++) {\n+    if (i > 0) {\n+      \/\/ Skip the first \"insn\": it has been emitted in decode() when a memory error is happening\n+      (*event_callback)(event_stream, \"insn\", (void*) p);\n+    }\n+\n+    if (end - p >= 4) {\n+      (*printf_callback)(printf_stream, \".4byte\\t0x%08x\\n\", *(uint32_t*)p);\n+      p += 4;\n+    } else if (end - p >= 2) {\n+      (*printf_callback)(printf_stream, \".2byte\\t0x%04x\\n\", *(uint16_t*)p);\n+      p += 2;\n+    } else {\n+      (*printf_callback)(printf_stream, \".1byte\\t0x%02x\\n\", *(uint8_t*)p);\n+      p += 1;\n+    }\n+\n+    (*event_callback)(event_stream, \"\/insn\", (void*) p);\n+  }\n@@ -366,1 +389,0 @@\n-#ifdef LIBARCH_riscv64\n@@ -368,1 +390,0 @@\n-#endif\n","filename":"src\/utils\/hsdis\/binutils\/hsdis-binutils.c","additions":24,"deletions":3,"binary":false,"changes":27,"status":"modified"}]}