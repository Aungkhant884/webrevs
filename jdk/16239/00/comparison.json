{"files":[{"patch":"@@ -137,6 +137,0 @@\n-    \/**\n-     * True if there are any stateful ops in the pipeline; only valid for the\n-     * source stage.\n-     *\/\n-    private boolean sourceAnyStateful;\n-\n@@ -211,2 +205,0 @@\n-        if (opIsStateful())\n-            sourceStage.sourceAnyStateful = true;\n@@ -389,0 +381,15 @@\n+    \/**\n+     * Returns whether any of the stages of the current segment is stateful\n+     * or not.\n+     * @return {@code true} if any stage in this segment is stateful,\n+     *         {@code false} if not.\n+     *\/\n+    protected final boolean hasAnyStateful() {\n+         var result = false;\n+         for (var u = sourceStage.nextStage;\n+              u != null && !(result = u.opIsStateful()) && u != this;\n+              u = u.nextStage) {\n+         }\n+         return result;\n+     }\n+\n@@ -412,1 +419,1 @@\n-        if (isParallel() && sourceStage.sourceAnyStateful) {\n+        if (isParallel() && hasAnyStateful()) {\n","filename":"src\/java.base\/share\/classes\/java\/util\/stream\/AbstractPipeline.java","additions":16,"deletions":9,"binary":false,"changes":25,"status":"modified"}]}