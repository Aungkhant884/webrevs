{"files":[{"patch":"@@ -971,2 +971,13 @@\n-        \/\/ ignore interim informational responses and continue to wait for final response\n-        if ((code == HTTP_CONTINUE && ignoreContinue) || (code >= 102 && code <= 199)) {\n+        if (code == 101) {\n+            \/\/ We don't support protocol upgrade through the \"Upgrade:\" request header, so if a\n+            \/\/ server still unexpectedly sends a 101 response, we consider that a protocol violation\n+            \/\/ and close the connection.\n+            closeServer();\n+            \/\/ clear off the response headers so that they don't get propagated\n+            \/\/ to the application\n+            responses.reset();\n+            throw new ProtocolException(\"Unexpected 101 response from server\");\n+        }\n+        \/\/ ignore interim informational responses and continue to wait for final response.\n+        if ((code == HTTP_CONTINUE && ignoreContinue)\n+                || (code >= 102 && code <= 199)) {\n","filename":"src\/java.base\/share\/classes\/sun\/net\/www\/http\/HttpClient.java","additions":13,"deletions":2,"binary":false,"changes":15,"status":"modified"},{"patch":"@@ -86,0 +86,1 @@\n+        private static final String REQ_LINE_BYE = \"GET \/test\/bye HTTP\/1.1\\r\\n\";\n@@ -128,0 +129,3 @@\n+                    } else if (requestLine.startsWith(REQ_LINE_BYE)) {\n+                        \/\/ we will send intermediate\/informational 101 response\n+                        informationalResponseCode = 101;\n@@ -206,0 +210,13 @@\n+\n+    \/**\n+     * Tests that when a HTTP\/1.1 server sends 101 response code, when the client\n+     * didn't ask for a connection upgrade, then the request fails with an exception.\n+     *\/\n+    @Test\n+    public void test101CausesRequestFailure() throws Exception {\n+        final URI requestURI = new URI(requestURIBase + \"\/test\/bye\");\n+        System.out.println(\"Issuing request to \" + requestURI);\n+        final HttpURLConnection urlConnection = (HttpURLConnection) requestURI.toURL().openConnection();\n+        \/\/ we expect the request to fail because the server unexpectedly sends a 101 response\n+        Assert.assertThrows(IOException.class, () -> urlConnection.getResponseCode());\n+    }\n","filename":"test\/jdk\/java\/net\/HttpURLConnection\/Response1xxTest.java","additions":17,"deletions":0,"binary":false,"changes":17,"status":"modified"}]}