{"files":[{"patch":"@@ -43,1 +43,1 @@\n-echo %~2=$($BASH $TOPDIR\/make\/scripts\/fixpath.sh import '%~1 ') >> %output%\n+echo %~2=$($BASH $TOPDIR\/make\/scripts\/fixpath.sh -i import '%~1 ') >> %output%\n","filename":"make\/scripts\/extract-vs-env.cmd","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -31,1 +31,1 @@\n-  while getopts \"e:p:r:t:c:qm\" opt; do\n+  while getopts \"e:p:r:t:c:qmi\" opt; do\n@@ -40,0 +40,1 @@\n+    i) IGNOREFAILURES=true ;;\n@@ -127,10 +128,16 @@\n-      exit 1\n-    fi\n-    basepart=\"$(basename \"$path\")\"\n-    if [[ $dirpart == \/ ]]; then\n-      # Avoid double leading \/\n-      dirpart=\"\"\n-    fi\n-    if [[ $basepart == \/ ]]; then\n-      # Avoid trailing \/\n-      basepart=\"\"\n+      if [[ $IGNOREFAILURES != true ]]; then\n+        exit 1\n+      else\n+        path=\"\"\n+      fi\n+    else\n+      basepart=\"$(basename \"$path\")\"\n+      if [[ $dirpart == \/ ]]; then\n+        # Avoid double leading \/\n+        dirpart=\"\"\n+      fi\n+      if [[ $basepart == \/ ]]; then\n+        # Avoid trailing \/\n+        basepart=\"\"\n+      fi\n+      path=\"$dirpart\/$basepart\"\n@@ -138,1 +145,0 @@\n-    path=\"$dirpart\/$basepart\"\n@@ -141,13 +147,17 @@\n-  # Now turn it into a windows path\n-  winpath=\"$($PATHTOOL -w \"$path\" 2>\/dev\/null)\"\n-\n-  if [[ $? -eq 0 ]]; then\n-    if [[ ! \"$winpath\" =~ ^\"$ENVROOT\"\\\\.*$ ]] ; then\n-      # If it is not in envroot, it's a generic windows path\n-      if [[ ! $winpath =~ ^[-_.:\\\\a-zA-Z0-9]*$ ]] ; then\n-        # Path has forbidden characters, rewrite as short name\n-        # This monster of a command uses the %~s support from cmd.exe to\n-        # reliably convert to short paths on all winenvs.\n-        shortpath=\"$($CMD \/q \/c for %I in \\( \"$winpath\" \\) do echo %~sI 2>\/dev\/null | tr -d \\\\n\\\\r)\"\n-        path=\"$($PATHTOOL -u \"$shortpath\")\"\n-        # Path is now unix style, based on short name\n+  if [[ \"$path\" != \"\" ]]; then\n+    # Now turn it into a windows path\n+    winpath=\"$($PATHTOOL -w \"$path\" 2>\/dev\/null)\"\n+\n+    if [[ $? -eq 0 ]]; then\n+      if [[ ! \"$winpath\" =~ ^\"$ENVROOT\"\\\\.*$ ]] ; then\n+        # If it is not in envroot, it's a generic windows path\n+        if [[ ! $winpath =~ ^[-_.:\\\\a-zA-Z0-9]*$ ]] ; then\n+          # Path has forbidden characters, rewrite as short name\n+          # This monster of a command uses the %~s support from cmd.exe to\n+          # reliably convert to short paths on all winenvs.\n+          shortpath=\"$($CMD \/q \/c for %I in \\( \"$winpath\" \\) do echo %~sI 2>\/dev\/null | tr -d \\\\n\\\\r)\"\n+          path=\"$($PATHTOOL -u \"$shortpath\")\"\n+          # Path is now unix style, based on short name\n+        fi\n+        # Make it lower case\n+        path=\"$(echo \"$path\" | tr [:upper:] [:lower:])\"\n@@ -155,13 +165,12 @@\n-      # Make it lower case\n-      path=\"$(echo \"$path\" | tr [:upper:] [:lower:])\"\n-    fi\n-  else\n-    # On WSL1, PATHTOOL will fail for files in envroot. If the unix path\n-    # exists, we assume that $path is a valid unix path.\n-\n-    if [[ ! -e $path ]]; then\n-      if [[ -e $path.exe ]]; then\n-        path=\"$path.exe\"\n-      else\n-        if [[ $QUIET != true ]]; then\n-          echo fixpath: warning: Path \"'\"$path\"'\" does not exist >&2\n+    else\n+      # On WSL1, PATHTOOL will fail for files in envroot. If the unix path\n+      # exists, we assume that $path is a valid unix path.\n+\n+      if [[ ! -e $path ]]; then\n+        if [[ -e $path.exe ]]; then\n+          path=\"$path.exe\"\n+        else\n+          if [[ $QUIET != true ]]; then\n+            echo fixpath: warning: Path \"'\"$path\"'\" does not exist >&2\n+          fi\n+          # This is not a fatal error, maybe the path will be created later on\n@@ -169,1 +178,0 @@\n-        # This is not a fatal error, maybe the path will be created later on\n@@ -180,1 +188,5 @@\n-    exit 1\n+    if [[ $IGNOREFAILURES != true ]]; then\n+      exit 1\n+    else\n+      path=\"\"\n+    fi\n@@ -198,1 +210,1 @@\n-      if [[ \"$imported\" = \"\" ]]; then\n+      if [[ \"$result\" != \"\" -a \"$imported\" = \"\" ]]; then\n","filename":"make\/scripts\/fixpath.sh","additions":53,"deletions":41,"binary":false,"changes":94,"status":"modified"}]}