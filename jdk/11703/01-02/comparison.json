{"files":[{"patch":"@@ -877,1 +877,1 @@\n-  BUILD_HOTSPOT_JTREG_EXCLUDE += exesigtest.c libterminatedThread.c libTestJNI.c libCompleteExit.c libTestPsig.c\n+  BUILD_HOTSPOT_JTREG_EXCLUDE += exesigtest.c libterminatedThread.c libTestJNI.c libCompleteExit.c libTestPsig.c libnativeStack.c\n@@ -1518,0 +1518,1 @@\n+  BUILD_HOTSPOT_JTREG_LIBRARIES_LIBS_libnativeStack += -lpthread\n","filename":"make\/test\/JtregNativeHotspot.gmk","additions":2,"deletions":1,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -32,1 +32,1 @@\n- * @driver TestNativeStack\n+ * @run driver TestNativeStack\n@@ -58,0 +58,3 @@\n+        oa.shouldHaveExitValue(0);\n+        oa.shouldContain(\"WARNING in native method\");\n+        oa.shouldContain(\"thread_start\");\n@@ -61,1 +64,1 @@\n-        oa = ProcessTools.executeTestJvm(\"-Xcheck:jni\",\n+        oa = ProcessTools.executeTestJvm(\"-XX:-CreateCoredumpOnCrash\",\n@@ -65,0 +68,3 @@\n+        oa.shouldNotHaveExitValue(0);\n+        oa.shouldContain(\"FATAL ERROR in native method\");\n+        oa.shouldContain(\"thread_start\");\n@@ -70,1 +76,4 @@\n-            triggerJNIStackTrace(args.length == 0 \/* warning if no args *\/);\n+            boolean doWarning = args.length == 0;\n+            System.out.println(\"Triggering a JNI \" +\n+                               (doWarning ? \"warning\" : \"fatal error\"));\n+            triggerJNIStackTrace(doWarning);\n","filename":"test\/hotspot\/jtreg\/runtime\/jni\/nativeStack\/TestNativeStack.java","additions":12,"deletions":3,"binary":false,"changes":15,"status":"modified"},{"patch":"@@ -39,1 +39,1 @@\n-  printf(\"About to trigger JNI Warning\");\n+  printf(\"About to trigger JNI Warning\\n\");\n@@ -62,2 +62,2 @@\n-  printf(\"About to trigger JNI FatalError\");\n-  (*env)->FatalError(\"Fatal error generated in test code\");\n+  printf(\"About to trigger JNI FatalError\\n\");\n+  (*env)->FatalError(env, \"Fatal error generated in test code\");\n@@ -95,1 +95,1 @@\n-(JNIEnv *env, jclass cls, jboolean warning) {\n+(JNIEnv *env, jclass cls, jboolean warn) {\n@@ -103,0 +103,2 @@\n+  warning = warn;\n+\n","filename":"test\/hotspot\/jtreg\/runtime\/jni\/nativeStack\/libnativeStack.c","additions":6,"deletions":4,"binary":false,"changes":10,"status":"modified"}]}