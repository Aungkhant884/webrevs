{"files":[{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2004, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2004, 2023, Oracle and\/or its affiliates. All rights reserved.\n@@ -299,0 +299,6 @@\n+\n+        if (fixedKeySize != -1 && fixedKeySize != keyBytes.length) {\n+            throw new InvalidKeyException(\"Invalid key length: \" +\n+                    keyBytes.length + \" bytes, should be \" + fixedKeySize);\n+        }\n+\n","filename":"src\/java.base\/share\/classes\/com\/sun\/crypto\/provider\/KeyWrapCipher.java","additions":7,"deletions":1,"binary":false,"changes":8,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2021, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2021, 2023, Oracle and\/or its affiliates. All rights reserved.\n@@ -26,1 +26,1 @@\n- * @bug 8248268\n+ * @bug 8248268 8302225\n@@ -46,0 +46,2 @@\n+    private static final int[] AES_KEYSIZES = { 128, 192, 256 };\n+\n@@ -67,1 +69,1 @@\n-            SecretKey key = getKey(ks);\n+            SecretKey key = getKey(ks >> 3);\n@@ -75,2 +77,1 @@\n-                    System.out.println(\" => expected IKE thrown for \"\n-                            + getModeStr(m));\n+                    System.out.println(getModeStr(m) + \" => got expected IKE\");\n@@ -80,0 +81,15 @@\n+\n+        \/\/ now test against the valid key size(s) and make sure they work\n+        int underscoreIdx = algo.indexOf(\"_\");\n+        int[] validKeySizes = (algo.indexOf(\"_\") == -1 ?\n+            AES_KEYSIZES : new int[] { Integer.parseInt(algo.substring\n+                    (underscoreIdx + 1, underscoreIdx + 4)) });\n+        for (int ks : validKeySizes) {\n+            System.out.println(\"keysize: \" + ks);\n+            SecretKey key = getKey(ks >> 3);\n+\n+            for (int m : modes) {\n+                c.init(m, key);\n+                System.out.println(getModeStr(m) + \" => ok\");\n+            }\n+        }\n","filename":"test\/jdk\/com\/sun\/crypto\/provider\/Cipher\/KeyWrap\/TestKeySizeCheck.java","additions":21,"deletions":5,"binary":false,"changes":26,"status":"modified"}]}