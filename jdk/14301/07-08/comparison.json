{"files":[{"patch":"@@ -450,1 +450,5 @@\n-     * alternatives.\n+     * alternatives. Other loops over the queues array vary in origin\n+     * and stride depending on whether they cover only submission\n+     * (even) or worker (odd) queues or both, and whether they require\n+     * randomness (in which case cyclically exhaustive strides may be\n+     * used).\n@@ -1986,2 +1990,2 @@\n-        long phaseSum = 0L;\n-        boolean swept = false, possibleSubmission = false;\n+        long phaseSum = -1L;\n+        boolean swept = false;\n@@ -1995,13 +1999,0 @@\n-            else if (possibleSubmission) {            \/\/ cover signal race\n-                WorkQueue[] qs; int sp, j; WorkQueue v; Thread t;\n-                possibleSubmission = swept = false;\n-                if ((sp = (int)c) == 0 || (qs = queues) == null ||\n-                    qs.length <= (j = sp & SMASK) || (v = qs[j]) == null)\n-                    break;                            \/\/ no inactive workers\n-                if (compareAndSetCtl(c, (v.stackPred & LMASK) |\n-                                     (UMASK & (c + RC_UNIT)) | (c & TC_MASK))) {\n-                    v.phase = sp;\n-                    if ((t = v.parker) != null)\n-                        U.unpark(t);                  \/\/ reactivate\n-                }\n-            }\n@@ -2009,2 +2000,2 @@\n-                ;\n-            else if (e == prevRunState && (e & RS_LOCK) == 0 && swept &&\n+                swept = false;\n+            else if (swept && e == prevRunState && (e & RS_LOCK) == 0 &&\n@@ -2024,2 +2015,2 @@\n-                            possibleSubmission = true;\n-                            continue outer;          \/\/ recheck counts\n+                            signalWork();            \/\/ ensure live\n+                            break outer;\n@@ -2559,1 +2550,1 @@\n-                else if (isQuiescent(true))\n+                else if (isQuiescent(false))\n","filename":"src\/java.base\/share\/classes\/java\/util\/concurrent\/ForkJoinPool.java","additions":12,"deletions":21,"binary":false,"changes":33,"status":"modified"}]}