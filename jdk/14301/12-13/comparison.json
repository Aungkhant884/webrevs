{"files":[{"patch":"@@ -1833,1 +1833,3 @@\n-                if ((qs = queues) != null && (n = qs.length) > 0) {\n+                if (stop != 0 || (qs = queues) == null || (n = qs.length) <= 0)\n+                    w.owner = null;             \/\/ terminating\n+                else {\n@@ -1842,1 +1844,1 @@\n-                    w.phase =  id;                \/\/ now publishable\n+                    w.phase = id;               \/\/ now publishable\n@@ -1845,1 +1847,1 @@\n-                    else if (stop == 0)  {        \/\/ expand unless stopping\n+                    else {                      \/\/ expand\n@@ -1852,1 +1854,1 @@\n-                            WorkQueue q;           \/\/ shared queues may move\n+                            WorkQueue q;        \/\/ shared queues may move\n@@ -1856,1 +1858,1 @@\n-                        U.storeFence();            \/\/ fill before publish\n+                        U.storeFence();         \/\/ fill before publish\n@@ -2789,0 +2791,1 @@\n+            boolean active = false;\n@@ -2790,2 +2793,2 @@\n-                int j; WorkQueue q; Thread o; \/\/ cancel tasks; interrupt workers\n-                if ((q = qs[j = r & SMASK & (n - 1)]) != null) {\n+                WorkQueue q; Thread o; \/\/ cancel tasks; interrupt workers\n+                if ((q = qs[r & SMASK & (n - 1)]) != null) {\n@@ -2793,0 +2796,1 @@\n+                        active = true;\n@@ -2806,1 +2810,1 @@\n-            if (((e = runState) & TERMINATED) == 0 && ctl == 0L) {\n+            if (((e = runState) & TERMINATED) == 0 && !active && ctl == 0L) {\n","filename":"src\/java.base\/share\/classes\/java\/util\/concurrent\/ForkJoinPool.java","additions":12,"deletions":8,"binary":false,"changes":20,"status":"modified"}]}