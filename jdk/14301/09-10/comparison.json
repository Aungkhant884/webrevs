{"files":[{"patch":"@@ -511,9 +511,12 @@\n-        Thread.interrupted();\n-        ForkJoinTask f = new FibAction(8);\n-        ForkJoinPool pool = null;\n-        try (ForkJoinPool p = new ForkJoinPool()) {\n-            pool = p;\n-            p.execute(f);\n-        }\n-        checkCompletedNormally(f);\n-        assertTrue(pool != null && pool.isTerminated());\n+        Thread t = newStartedThread(new CheckedRunnable() {\n+                public void realRun() throws InterruptedException {\n+                    ForkJoinTask f = new FibAction(8);\n+                    ForkJoinPool pool = null;\n+                    try (ForkJoinPool p = new ForkJoinPool()) {\n+                        pool = p;\n+                        p.execute(f);\n+                    }\n+                    checkCompletedNormally(f);\n+                    assertTrue(pool != null && pool.isTerminated());\n+                }});\n+        awaitTermination(t);\n@@ -526,10 +529,0 @@\n-        ForkJoinTask f = new FibAction(8);\n-        ForkJoinPool pool;\n-        try (ForkJoinPool p = pool = ForkJoinPool.commonPool()) {\n-            p.execute(f);\n-        }\n-\n-        assertFalse(pool.isShutdown());\n-        assertFalse(pool.isTerminating());\n-        assertFalse(pool.isTerminated());\n-\n@@ -538,4 +531,17 @@\n-        if (! \"0\".equals(prop)) {\n-            f.join();\n-            checkCompletedNormally(f);\n-        }\n+        boolean nothreads = \"0\".equals(prop);\n+        Thread t = newStartedThread(new CheckedRunnable() {\n+                public void realRun() throws InterruptedException {\n+                    ForkJoinTask f = new FibAction(8);\n+                    ForkJoinPool pool;\n+                    try (ForkJoinPool p = pool = ForkJoinPool.commonPool()) {\n+                        p.execute(f);\n+                    }\n+                    assertFalse(pool.isShutdown());\n+                    assertFalse(pool.isTerminating());\n+                    assertFalse(pool.isTerminated());\n+                    if (!nothreads) {\n+                        f.join();\n+                        checkCompletedNormally(f);\n+                    }\n+                }});\n+       awaitTermination(t);\n@@ -543,1 +549,0 @@\n-\n","filename":"test\/jdk\/java\/util\/concurrent\/tck\/ForkJoinPool19Test.java","additions":29,"deletions":24,"binary":false,"changes":53,"status":"modified"}]}