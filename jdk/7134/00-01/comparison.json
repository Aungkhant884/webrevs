{"files":[{"patch":"@@ -85,0 +85,8 @@\n+\/* Returns true if this is a strong reference, meaning that either or both of\n+   isPinAll and isCommonPin are true. *\/\n+static jboolean\n+isStrong(RefNode* node)\n+{\n+    return node->isPinAll || node->isCommonPin;\n+}\n+\n@@ -131,1 +139,0 @@\n-    node->isStrong    = pinAll;\n@@ -151,1 +158,1 @@\n-        if (node->isStrong) {\n+        if (isStrong(node)) {\n@@ -165,1 +172,1 @@\n-    if (!node->isStrong) {\n+  if (!isStrong(node)) {\n@@ -181,1 +188,0 @@\n-            node->isStrong = JNI_TRUE;\n@@ -196,0 +202,1 @@\n+    jboolean wasStrong = isStrong(node); \/\/ Need to cache this before updating flags below\n@@ -204,1 +211,1 @@\n-    if (node->isStrong && !node->isPinAll && !node->isCommonPin) {\n+    if (wasStrong && !node->isPinAll && !node->isCommonPin) {\n@@ -216,1 +223,0 @@\n-            node->isStrong = JNI_FALSE;\n@@ -480,1 +486,1 @@\n-            if (node->isStrong) {\n+          if (isStrong(node)) {\n@@ -532,1 +538,1 @@\n-            strongRef = strengthenNode(env, node, JNI_FALSE);\n+            strongRef = strengthenNode(env, node, JNI_FALSE \/* isPinAll *\/);\n@@ -561,1 +567,1 @@\n-            weakRef = weakenNode(env, node, JNI_FALSE);\n+            weakRef = weakenNode(env, node, JNI_FALSE \/* isPinAll *\/);\n@@ -595,1 +601,1 @@\n-                    strongRef = strengthenNode(env, node, JNI_TRUE);\n+                    strongRef = strengthenNode(env, node, JNI_TRUE \/* isPinAll *\/);\n@@ -638,1 +644,1 @@\n-                    weakRef = weakenNode(env, node, JNI_TRUE);\n+                    weakRef = weakenNode(env, node, JNI_TRUE \/* isPinAll *\/);\n@@ -686,1 +692,1 @@\n-                    if (!node->isStrong && isSameObject(env, node->ref, NULL)) {\n+                  if (!isStrong(node) && isSameObject(env, node->ref, NULL)) {\n","filename":"src\/jdk.jdwp.agent\/share\/native\/libjdwp\/commonRef.c","additions":18,"deletions":12,"binary":false,"changes":30,"status":"modified"},{"patch":"@@ -68,3 +68,1 @@\n-    jboolean     isStrong;      \/* true if this is a strong reference. Either or both of isPinAll\n-                                   and isCommonPin will also be true *\/\n-    jboolean     isPinAll;      \/* true this is a strong reference due to a commonRef_pinAll() *\/\n+    jboolean     isPinAll;      \/* true if this is a strong reference due to a commonRef_pinAll() *\/\n","filename":"src\/jdk.jdwp.agent\/share\/native\/libjdwp\/util.h","additions":1,"deletions":3,"binary":false,"changes":4,"status":"modified"}]}