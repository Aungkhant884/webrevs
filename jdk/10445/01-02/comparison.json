{"files":[{"patch":"@@ -36,1 +36,0 @@\n-import java.util.Arrays;\n@@ -98,0 +97,3 @@\n+        if (!in.moduleView().findModule(\"jdk.jlink\").isPresent()) {\n+            throw new PluginException(\"--save-jlink-argfiles requires jdk.jlink to be in the output image\");\n+        }\n","filename":"src\/jdk.jlink\/share\/classes\/jdk\/tools\/jlink\/internal\/plugins\/SaveJlinkArgfilesPlugin.java","additions":3,"deletions":1,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -74,2 +74,2 @@\n-        Path launcher = image.resolve(\"bin\/java\" + exe);\n-        var oa = ProcessTools.executeProcess(launcher.toString(), \"-XshowSettings:properties\", \"--version\");\n+        String launcher = image.resolve(\"bin\/java\" + exe).toString();\n+        var oa = ProcessTools.executeProcess(launcher, \"-XshowSettings:properties\", \"--version\");\n@@ -83,0 +83,6 @@\n+        \/\/ Check that --save-jlink-argfiles fails if jdk.jlink not in the output image\n+        launcher = image.resolve(\"bin\/jlink\" + exe).toString();\n+        oa = ProcessTools.executeProcess(launcher, \"--output=ignore\", \"--save-jlink-argfiles=\" + argfile1);\n+        oa.shouldHaveExitValue(1);\n+        oa.stdoutShouldMatch(\"--save-jlink-argfiles requires jdk.jlink to be in the output image\");\n+\n@@ -85,2 +91,2 @@\n-        launcher = image.resolve(\"bin\/jlink\" + exe);\n-        oa = ProcessTools.executeProcess(launcher.toString(), \"--output\", image2.toString(), \"--add-modules=java.base\");\n+        launcher = image.resolve(\"bin\/jlink\" + exe).toString();\n+        oa = ProcessTools.executeProcess(launcher, \"--output\", image2.toString(), \"--add-modules=java.base\");\n@@ -91,2 +97,2 @@\n-        launcher = image2.resolve(Path.of(\"bin\", \"java\" + exe));\n-        oa = ProcessTools.executeProcess(launcher.toString(), \"-XshowSettings:properties\", \"--version\");\n+        launcher = image2.resolve(Path.of(\"bin\", \"java\" + exe)).toString();\n+        oa = ProcessTools.executeProcess(launcher, \"-XshowSettings:properties\", \"--version\");\n","filename":"test\/jdk\/tools\/jlink\/plugins\/SaveJlinkArgfilesPluginTest.java","additions":12,"deletions":6,"binary":false,"changes":18,"status":"modified"}]}