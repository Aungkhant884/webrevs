{"files":[{"patch":"@@ -170,3 +170,2 @@\n-        String idealIndependentRegex = START + \"Allocate\" + MID + END;\n-        String optoRegex = \"(.*precise .*\\\\R((.*(?i:mov|xorl|nop|spill).*|\\\\s*|.*LGHI.*)\\\\R)*.*(?i:call,static).*wrapper for: _new_instance_Java\" + END;\n-        allocNodes(ALLOC, idealIndependentRegex, optoRegex);\n+        String optoRegex = \"(.*precise .*\\\\R((.*(?i:mov|xorl|nop|spill).*|\\\\s*)\\\\R)*.*(?i:call,static).*wrapper for: _new_instance_Java\" + END;\n+        allocNodes(ALLOC, \"Allocate\", optoRegex);\n@@ -177,1 +176,1 @@\n-        String regex = \"(.*precise .*\" + IS_REPLACED + \":.*\\\\R((.*(?i:mov|xorl|nop|spill).*|\\\\s*|.*LGHI.*)\\\\R)*.*(?i:call,static).*wrapper for: _new_instance_Java\" + END;\n+        String regex = \"(.*precise .*\" + IS_REPLACED + \":.*\\\\R((.*(?i:mov|xorl|nop|spill).*|\\\\s*)\\\\R)*.*(?i:call,static).*wrapper for: _new_instance_Java\" + END;\n@@ -183,3 +182,2 @@\n-        String idealIndependentRegex = START + \"AllocateArray\" + MID + END;\n-        String optoRegex = \"(.*precise \\\\[.*\\\\R((.*(?i:mov|xor|nop|spill).*|\\\\s*|.*LGHI.*)\\\\R)*.*(?i:call,static).*wrapper for: _new_array_Java\" + END;\n-        allocNodes(ALLOC_ARRAY, idealIndependentRegex, optoRegex);\n+        String optoRegex = \"(.*precise \\\\[.*\\\\R((.*(?i:mov|xor|nop|spill).*|\\\\s*|.*(LGHI|LI).*)\\\\R)*.*(?i:call,static).*wrapper for: _new_array_Java\" + END;\n+        allocNodes(ALLOC_ARRAY, \"AllocateArray\", optoRegex);\n@@ -190,1 +188,1 @@\n-        String regex = \"(.*precise \\\\[.*\" + IS_REPLACED + \":.*\\\\R((.*(?i:mov|xorl|nop|spill).*|\\\\s*|.*LGHI.*)\\\\R)*.*(?i:call,static).*wrapper for: _new_array_Java\" + END;\n+        String regex = \"(.*precise \\\\[.*\" + IS_REPLACED + \":.*\\\\R((.*(?i:mov|xorl|nop|spill).*|\\\\s*|.*(LGHI|LI).*)\\\\R)*.*(?i:call,static).*wrapper for: _new_array_Java\" + END;\n@@ -1185,1 +1183,2 @@\n-    private static void allocNodes(String irNode, String idealRegex, String optoRegex) {\n+    private static void allocNodes(String irNode, String irNodeName, String optoRegex) {\n+        String idealIndependentRegex = START + irNodeName + \"\\\\b\" + MID + END;\n@@ -1188,1 +1187,1 @@\n-                               idealRegex);\n+                               idealIndependentRegex);\n","filename":"test\/hotspot\/jtreg\/compiler\/lib\/ir_framework\/IRNode.java","additions":9,"deletions":10,"binary":false,"changes":19,"status":"modified"},{"patch":"@@ -107,0 +107,2 @@\n+    Object obj3;\n+    Object obj4;\n@@ -246,0 +248,10 @@\n+\n+    @Test\n+    @IR(counts = {IRNode.ALLOC, \"2\", IRNode.ALLOC_ARRAY, \"2\"}, \/\/ works for all phases\n+        phase = {CompilePhase.BEFORE_REMOVEUSELESS, CompilePhase.CCP1, CompilePhase.PRINT_OPTO_ASSEMBLY, CompilePhase.DEFAULT})\n+    public void alloc2() {\n+        obj = new Object();\n+        obj2 = new Object[1];\n+        obj3 = new Object();\n+        obj4 = new Object[2];\n+    }\n","filename":"test\/hotspot\/jtreg\/testlibrary_tests\/ir_framework\/tests\/TestPhaseIRMatching.java","additions":12,"deletions":0,"binary":false,"changes":12,"status":"modified"}]}