{"files":[{"patch":"@@ -522,1 +522,0 @@\n-  uint _num_workers;\n@@ -541,7 +540,0 @@\n-  class SafepointCleanupThreadClosure : public ThreadClosure {\n-  public:\n-    void do_thread(Thread* thread) {\n-      StackWatermarkSet::start_processing(JavaThread::cast(thread), StackWatermarkKind::gc);\n-    }\n-  };\n-\n@@ -549,1 +541,1 @@\n-  ParallelCleanupTask(uint num_workers) :\n+  ParallelCleanupTask() :\n@@ -552,1 +544,0 @@\n-    _num_workers(num_workers),\n@@ -582,1 +573,7 @@\n-        SafepointCleanupThreadClosure cl;\n+        class LazyRootClosure : public ThreadClosure {\n+        public:\n+          void do_thread(Thread* thread) {\n+            StackWatermarkSet::start_processing(JavaThread::cast(thread), StackWatermarkKind::gc);\n+          }\n+        };\n+        LazyRootClosure cl;\n@@ -609,0 +606,1 @@\n+  ParallelCleanupTask cleanup;\n@@ -612,2 +610,0 @@\n-    uint num_cleanup_workers = cleanup_workers->active_workers();\n-    ParallelCleanupTask cleanup(num_cleanup_workers);\n@@ -617,1 +613,0 @@\n-    ParallelCleanupTask cleanup(1);\n","filename":"src\/hotspot\/share\/runtime\/safepoint.cpp","additions":9,"deletions":14,"binary":false,"changes":23,"status":"modified"}]}