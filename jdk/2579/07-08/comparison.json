{"files":[{"patch":"@@ -40,0 +40,20 @@\n+    public static void testPeriodicUsage(boolean assertLiveSize) throws Exception {\n+        Recording recording = new Recording();\n+        recording.enable(EventNames.HeapUsageSummary);\n+\n+        recording.start();\n+        GCHelper.callSystemGc(1, true);\n+        recording.stop();\n+        List<RecordedEvent> events = Events.fromRecording(recording);\n+        Asserts.assertFalse(events.isEmpty(), \"Expected at least one event\");\n+        for (RecordedEvent event : events) {\n+            long minUsedSize = 1L;\n+            if (assertLiveSize) {\n+                \/\/ make sure that the estimated live set size is present\n+                minUsedSize = Events.assertField(event, \"live\").atLeast(1L).getValue();\n+            }\n+            \/\/ make sure the used value is valid - it must be at least as big as the reported live set size\n+            Events.assertField(event, \"used\").atLeast(minUsedSize);\n+        }\n+    }\n+\n","filename":"test\/jdk\/jdk\/jfr\/event\/gc\/heapsummary\/HeapSummaryEventAllGcs.java","additions":20,"deletions":0,"binary":false,"changes":20,"status":"modified"},{"patch":"@@ -40,0 +40,1 @@\n+        HeapSummaryEventAllGcs.testPeriodicUsage(true);\n","filename":"test\/jdk\/jdk\/jfr\/event\/gc\/heapsummary\/TestHeapSummaryEventDefNewSerial.java","additions":1,"deletions":0,"binary":false,"changes":1,"status":"modified"},{"patch":"@@ -41,0 +41,1 @@\n+        HeapSummaryEventAllGcs.testPeriodicUsage(false); \/\/ do not validate the live set size as provoking G1 to compute it is not easy\n","filename":"test\/jdk\/jdk\/jfr\/event\/gc\/heapsummary\/TestHeapSummaryEventG1.java","additions":1,"deletions":0,"binary":false,"changes":1,"status":"modified"},{"patch":"@@ -40,0 +40,1 @@\n+        HeapSummaryEventAllGcs.testPeriodicUsage(true);\n","filename":"test\/jdk\/jdk\/jfr\/event\/gc\/heapsummary\/TestHeapSummaryEventPSParOld.java","additions":1,"deletions":0,"binary":false,"changes":1,"status":"modified"},{"patch":"@@ -100,0 +100,1 @@\n+    public final static String HeapUsageSummary = PREFIX + \"HeapUsageSummary\";\n","filename":"test\/lib\/jdk\/test\/lib\/jfr\/EventNames.java","additions":1,"deletions":0,"binary":false,"changes":1,"status":"modified"}]}