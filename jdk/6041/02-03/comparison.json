{"files":[{"patch":"@@ -28,2 +28,0 @@\n-import java.util.concurrent.atomic.AtomicLong;\n-\n@@ -41,1 +39,1 @@\n-    long numAllocationFailures = 0;\n+    volatile long numAllocationFailures = 0;\n","filename":"test\/hotspot\/jtreg\/runtime\/Metaspace\/elastic\/MetaspaceTestArena.java","additions":1,"deletions":3,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -50,0 +50,2 @@\n+    \/\/ Allocate (breathe in) until arena is full, then - to test the arena deallocator - deallocate some allocations\n+    \/\/ and breathe in again until full.\n@@ -51,1 +53,1 @@\n-    int breatheTicks = 0;\n+    int breatheOutTicks = 0;\n@@ -62,1 +64,0 @@\n-        breatheTicks++;\n@@ -72,1 +73,1 @@\n-            breatheTicks = 0;\n+            breatheOutTicks = 0;\n@@ -78,1 +79,0 @@\n-        breatheTicks++;\n@@ -88,1 +88,0 @@\n-\n@@ -90,0 +89,1 @@\n+            \/\/ allocate until we hit the ceiling\n@@ -95,4 +95,3 @@\n-            deallocateRandomly();\n-            if (breatheTicks > 100) {\n-                \/\/ After allocation error, breathe out a bit. Stop after 100 deallocations\n-                \/\/ to breathe in again (should cause us to float just below the ceiling).\n+            if (++breatheOutTicks < 100) {\n+                deallocateRandomly();\n+            } else {\n@@ -100,1 +99,0 @@\n-                breatheTicks = 0;\n@@ -103,1 +101,0 @@\n-\n@@ -105,1 +102,0 @@\n-\n","filename":"test\/hotspot\/jtreg\/runtime\/Metaspace\/elastic\/RandomAllocator.java","additions":8,"deletions":12,"binary":false,"changes":20,"status":"modified"},{"patch":"@@ -44,1 +44,1 @@\n- * @test id=debug-default\n+ * @test id=debugdefault\n@@ -61,1 +61,1 @@\n- * @test id=debug-none\n+ * @test id=debugnone\n@@ -79,1 +79,1 @@\n- * @test id=debug-aggressive\n+ * @test id=debugaggressive\n@@ -97,1 +97,1 @@\n- * @test id=debug-guard\n+ * @test id=debugguard\n@@ -115,1 +115,1 @@\n- * @test id=ndebug-default\n+ * @test id=ndebugdefault\n@@ -131,1 +131,1 @@\n- * @test id=ndebug-none\n+ * @test id=ndebugnone\n@@ -148,1 +148,1 @@\n- * @test id=ndebug-aggressive\n+ * @test id=ndebugaggressive\n","filename":"test\/hotspot\/jtreg\/runtime\/Metaspace\/elastic\/TestMetaspaceAllocationMT2.java","additions":7,"deletions":7,"binary":false,"changes":14,"status":"modified"}]}