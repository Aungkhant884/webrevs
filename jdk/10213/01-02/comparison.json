{"files":[{"patch":"@@ -1187,1 +1187,5 @@\n-\n+            int idx = value.indexOf(\"-\");\n+            int lastIdx = value.lastIndexOf(\"-\");\n+            if (idx != lastIdx) {\n+                throw new CommandException(\"err.compress.incorrect\", value);\n+            }\n@@ -1189,1 +1193,1 @@\n-                int level = Integer.parseInt(value);\n+                int level = Integer.parseInt(value.substring(idx + 1));\n@@ -1191,1 +1195,1 @@\n-                    throw new CommandException(\"err.compression.level.out.of.range\", value);\n+                    throw new CommandException(\"err.compress.incorrect\", value);\n@@ -1195,1 +1199,1 @@\n-                throw new CommandException(\"err.compression.level.out.of.range\", value);\n+                throw new CommandException(\"err.compress.incorrect\", value);\n@@ -1201,1 +1205,1 @@\n-        @Override public String valuePattern() { return \"compression level (0-9)\"; }\n+        @Override public String valuePattern() { return \"compress\"; }\n@@ -1444,2 +1448,2 @@\n-        OptionSpec<Integer> compLevel\n-                = parser.accepts(\"compression-level\", getMessage(\"main.opt.compression-level\"))\n+        OptionSpec<Integer> compress\n+                = parser.accepts(\"compress\", getMessage(\"main.opt.compress\"))\n@@ -1518,1 +1522,1 @@\n-            if (opts.has(compLevel)) {\n+            if (opts.has(compress)) {\n@@ -1520,1 +1524,1 @@\n-                    throw new CommandException(\"err.compression.level.wrong.mode\")\n+                    throw new CommandException(\"err.compress.wrong.mode\")\n@@ -1523,1 +1527,1 @@\n-                options.compLevel = getLastElement(opts.valuesOf(compLevel));\n+                options.compLevel = getLastElement(opts.valuesOf(compress));\n","filename":"src\/jdk.jlink\/share\/classes\/jdk\/tools\/jmod\/JmodTask.java","additions":14,"deletions":10,"binary":false,"changes":24,"status":"modified"},{"patch":"@@ -85,2 +85,3 @@\n-main.opt.compression-level=Compression level to use when creating the JMOD archive.\\\n-Accepted levels are: 0 (no compression) .. 9 (best compression).\n+main.opt.compress=Compression to use when creating the JMOD archive.\\\n+\\ Accepted values are: zip-[0-9], where zip-0 provides no compression, and zip-9\\\n+\\ provides the best compression.\n@@ -119,2 +120,2 @@\n-err.compression.level.out.of.range=--compression-level {0} is out of the valid range: 0-9\n-err.compression.level.wrong.mode=--compression-level {0} is only accepted with create mode\n+err.compress.incorrect=--compress value is invalid: {0}\n+err.compress.wrong.mode=--compress is only accepted with create mode\n","filename":"src\/jdk.jlink\/share\/classes\/jdk\/tools\/jmod\/resources\/jmod.properties","additions":5,"deletions":4,"binary":false,"changes":9,"status":"modified"},{"patch":"@@ -750,1 +750,1 @@\n-             \"--compression-level=0\",\n+             \"--compress\", \"zip-0\",\n@@ -755,1 +755,1 @@\n-             \"--compression-level=0\",\n+             \"--compress\", \"zip-0\",\n@@ -759,1 +759,1 @@\n-                assertTrue(r.output.contains(\"is only accepted with create mode\"), \"Error message printed\");\n+                assertTrue(r.output.contains(\"--compress is only accepted with create mode\"), \"Error message printed\");\n@@ -766,1 +766,1 @@\n-             \"--compression-level=9\",\n+             \"--compress\", \"zip-9\",\n@@ -774,1 +774,1 @@\n-             \"--compression-level=-1\",\n+             \"--compress\", \"zip--1\",\n@@ -778,1 +778,1 @@\n-                assertTrue(r.output.contains(\"is out of the valid range: 0-9\"), \"Error message printed\");\n+                assertTrue(r.output.contains(\"--compress value is invalid\"), \"Error message printed\");\n@@ -785,1 +785,1 @@\n-             \"--compression-level=10\",\n+             \"--compress\", \"zip-1-something\",\n@@ -789,1 +789,1 @@\n-                assertTrue(r.output.contains(\"is out of the valid range: 0-9\"), \"Error message printed\");\n+                assertTrue(r.output.contains(\"--compress value is invalid\"), \"Error message printed\");\n@@ -796,1 +796,1 @@\n-             \"--compression-level=test\",\n+             \"--compress\", \"zip-10\",\n@@ -800,1 +800,12 @@\n-                assertTrue(r.output.contains(\"is out of the valid range: 0-9\"), \"Error message printed\");\n+                assertTrue(r.output.contains(\"--compress value is invalid\"), \"Error message printed\");\n+            });\n+\n+        FileUtils.deleteFileIfExistsWithRetry(jmod);\n+\n+        jmod(\"create\",\n+             \"--class-path\", cp,\n+             \"--compress\", \"test\",\n+             jmod.toString())\n+            .assertFailure()\n+            .resultChecker(r -> {\n+                assertTrue(r.output.contains(\"--compress value is invalid\"), \"Error message printed\");\n","filename":"test\/jdk\/tools\/jmod\/JmodTest.java","additions":21,"deletions":10,"binary":false,"changes":31,"status":"modified"}]}