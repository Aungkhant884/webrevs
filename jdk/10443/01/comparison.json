{"files":[{"patch":"@@ -980,1 +980,1 @@\n-\/\/ Clobbers: rscratch1 if hardware doesn't support FEAT_BITPERM.\n+\/\/ Clobbers: rscratch1, if UseSVE=1 or the hardware doesn't support FEAT_BITPERM.\n@@ -998,15 +998,2 @@\n-  if (UseSVE > 0 && !VM_Version::supports_svebitperm()) {\n-    \/\/ Compress the lowest 8 bytes.\n-    fmovd(dst, vtmp1);\n-    bytemask_compress(dst);\n-    if (lane_cnt <= 8) return;\n-\n-    \/\/ Repeat on higher bytes and join the results.\n-    \/\/ Compress 8 bytes in each iteration.\n-    for (int idx = 1; idx < (lane_cnt \/ 8); idx++) {\n-      sve_extract_integral(rscratch1, T_LONG, vtmp1, idx, vtmp2);\n-      bytemask_compress(rscratch1);\n-      orr(dst, dst, rscratch1, Assembler::LSL, idx << 3);\n-    }\n-  } else if (UseSVE == 2 && VM_Version::supports_svebitperm()) {\n-    \/\/ Given by the vector with value 0x00 or 0x01 in each byte, the basic idea\n+  if (UseSVE > 1 && VM_Version::supports_svebitperm()) {\n+    \/\/ Given a vector with the value 0x00 or 0x01 in each byte, the basic idea\n@@ -1014,3 +1001,3 @@\n-    \/\/ to the lack of cross-lane bit-compress instruction, here we use BEXT\n-    \/\/ (bit-compress in each lane) with the biggest lane size (T = D) and\n-    \/\/ concatenates the results then.\n+    \/\/ to the lack of a cross-lane bit-compress instruction, we use BEXT\n+    \/\/ (bit-compress in each lane) with the biggest lane size (T = D) then\n+    \/\/ concatenate the results.\n@@ -1045,0 +1032,13 @@\n+  } else if (UseSVE > 0) {\n+    \/\/ Compress the lowest 8 bytes.\n+    fmovd(dst, vtmp1);\n+    bytemask_compress(dst);\n+    if (lane_cnt <= 8) return;\n+\n+    \/\/ Repeat on higher bytes and join the results.\n+    \/\/ Compress 8 bytes in each iteration.\n+    for (int idx = 1; idx < (lane_cnt \/ 8); idx++) {\n+      sve_extract_integral(rscratch1, T_LONG, vtmp1, idx, vtmp2);\n+      bytemask_compress(rscratch1);\n+      orr(dst, dst, rscratch1, Assembler::LSL, idx << 3);\n+    }\n","filename":"src\/hotspot\/cpu\/aarch64\/c2_MacroAssembler_aarch64.cpp","additions":19,"deletions":19,"binary":false,"changes":38,"status":"modified"}]}