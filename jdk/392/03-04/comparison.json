{"files":[{"patch":"@@ -198,3 +198,14 @@\n-LIBRARIES\/i386 = $(patsubst -l%,%,$(shell $(LLVMDIR)\/bin\/llvm-config --libs x86 x86disassembler))\n-LIBRARIES\/amd64 = $(patsubst -l%,%,$(shell $(LLVMDIR)\/bin\/llvm-config --libs x86 x86disassembler))\n-LIBRARIES\/aarch64 = $(patsubst -l%,%,$(shell $(LLVMDIR)\/bin\/llvm-config --libs aarch64 aarch64disassembler))\n+\n+# llvm-config may not be available when you've cross-compiled LLVM (build != host). That is the\n+# case when you want to cross-compile hsdis as well. To work around that limitation, you can\n+# simply specify the LLVM libraries and system libraries by hand. To do so, set the following\n+# variables to the values outputed when running llvm-config on the target platform:\n+#  - LIBRARIES\/$(ARCH) to the output of `llvm-config --libs {ARCH} {ARCH}disassembler`\n+#  - SYSTEM_LIBRARIES to the output of `llvm-config --system-libs`\n+LLVM_CONFIG := $(if $(shell $(LLVMDIR)\/bin\/llvm-config --version),$(LLVMDIR)\/bin\/llvm-config)\n+\n+ifneq ($(LLVM_CONFIG),)\n+LIBRARIES\/i386 = $(patsubst -l%,%,$(shell $(LLVM_CONFIG) --libs x86 x86disassembler))\n+LIBRARIES\/amd64 = $(patsubst -l%,%,$(shell $(LLVM_CONFIG) --libs x86 x86disassembler))\n+LIBRARIES\/aarch64 = $(patsubst -l%,%,$(shell $(LLVM_CONFIG) --libs aarch64 aarch64disassembler))\n+endif\n@@ -203,1 +214,1 @@\n-$(error \"unknown LLVM libraries for ARCH=$(ARCH))\n+$(error \"Unknown LLVM libraries for ARCH=$(ARCH))\n@@ -207,0 +218,4 @@\n+\n+ifneq ($(LLVM_CONFIG),)\n+SYSTEM_LIBRARIES=$(shell $(LLVM_CONFIG) --system-libs)\n+endif\n@@ -213,4 +228,0 @@\n-ifneq ($(LLVM),)\n-DLDFLAGS+=$(shell $(LLVMDIR)\/bin\/llvm-config --system-libs)\n-endif\n-\n@@ -240,1 +251,1 @@\n-\t$(CXX) $(OUTFLAGS) $(CPPFLAGS) $(CFLAGS) $(SOURCE) $(DLDFLAGS) $(LIBRARIES)\n+\t$(CXX) $(OUTFLAGS) $(CPPFLAGS) $(CFLAGS) $(SOURCE) $(DLDFLAGS) $(LIBRARIES) $(SYSTEM_LIBRARIES)\n","filename":"src\/utils\/hsdis\/Makefile","additions":20,"deletions":9,"binary":false,"changes":29,"status":"modified"},{"patch":"@@ -605,2 +605,0 @@\n-    static bool complained = false;\n-\n@@ -608,0 +606,1 @@\n+      static bool complained = false;\n@@ -616,0 +615,1 @@\n+      static bool complained = false;\n@@ -624,0 +624,1 @@\n+      static bool complained = false;\n@@ -632,0 +633,1 @@\n+      static bool complained = false;\n@@ -660,0 +662,1 @@\n+    (*_printf_callback)(_printf_stream, \"  target_triple=<triple> select disassembly target\\n\");\n@@ -672,1 +675,1 @@\n-      _printf_callback(_printf_stream, \"%s\", buf);\n+      (*_printf_callback)(_printf_stream, \"%s\", buf);\n","filename":"src\/utils\/hsdis\/hsdis.cpp","additions":6,"deletions":3,"binary":false,"changes":9,"status":"modified"}]}