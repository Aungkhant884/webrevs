{"files":[{"patch":"@@ -1480,2 +1480,7 @@\n-        byte[] signerSubjectKeyIdExt = ((X509Certificate)signerCert).getExtensionValue(\n-                KnownOIDs.SubjectKeyID.value());\n+        X509CertImpl certImpl;\n+        if (signerCert instanceof X509CertImpl) {\n+            certImpl = (X509CertImpl) signerCert;\n+        } else {\n+            certImpl = new X509CertImpl(signerCert.getEncoded());\n+        }\n+        KeyIdentifier signerSubjectKeyId = certImpl.getSubjectKeyId();\n@@ -1489,1 +1494,1 @@\n-                signerSubjectKeyIdExt);\n+                signerSubjectKeyId);\n@@ -4234,1 +4239,1 @@\n-     * @param aSubjectKeyIdExt the subject key identifier extension for the authority (issuer)\n+     * @param aSubjectKeyId the subject key identifier for the authority (issuer)\n@@ -4243,1 +4248,1 @@\n-            byte[] aSubjectKeyIdExt) throws Exception {\n+            KeyIdentifier aSubjectKeyId) throws Exception {\n@@ -4272,1 +4277,1 @@\n-                if (aSubjectKeyIdExt == null) {\n+                if (aSubjectKeyId == null) {\n@@ -4279,4 +4284,0 @@\n-                    \/\/ SubjectKeyIdentifierExtension in X509Certificate encapsulates its\n-                    \/\/ value with two levels of OCTET_STRING wrapper.\n-                    byte[] subjectKeyId1 = new DerValue(aSubjectKeyIdExt).getOctetString();\n-                    byte[] subjectKeyId2 = new DerValue(subjectKeyId1).getOctetString();\n@@ -4284,1 +4285,1 @@\n-                            new KeyIdentifier(subjectKeyId2), null, null));\n+                            aSubjectKeyId, null, null));\n","filename":"src\/java.base\/share\/classes\/sun\/security\/tools\/keytool\/Main.java","additions":12,"deletions":11,"binary":false,"changes":23,"status":"modified"},{"patch":"@@ -41,0 +41,1 @@\n+import sun.security.x509.KeyIdentifier;\n@@ -158,1 +159,1 @@\n-                byte[].class);\n+                KeyIdentifier.class);\n","filename":"test\/jdk\/sun\/security\/tools\/keytool\/ExtOptionCamelCase.java","additions":2,"deletions":1,"binary":false,"changes":3,"status":"modified"}]}