{"files":[{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2012, 2020, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2012, 2021, Oracle and\/or its affiliates. All rights reserved.\n@@ -26,0 +26,1 @@\n+#include \"cgroupSubsystem_linux.hpp\"\n@@ -29,0 +30,1 @@\n+#include \"osContainer_linux.hpp\"\n@@ -386,0 +388,19 @@\n+  user_load = (udiff \/ (double)tdiff);\n+\n+  if (OSContainer::is_containerized()) {\n+    double scale = 1.0f;\n+    int quota  = OSContainer::cpu_quota();\n+    int period = OSContainer::cpu_period();\n+    int share  = OSContainer::cpu_shares();\n+    int processor_count = os::processor_count();\n+    if (quota > -1 && period > 0) {\n+      scale = (double)processor_count \/ ((double)quota \/ (double)period);\n+    } else if (share > -1) {\n+      scale = (double)processor_count \/ ((double)share \/ (double)PER_CPU_SHARES);\n+    } else {\n+      scale = (double)processor_count \/ (double)os::active_processor_count();\n+    }\n+    *pkernelLoad *= scale;\n+    user_load *= scale;\n+  }\n+\n@@ -389,2 +410,0 @@\n-\n-  user_load = (udiff \/ (double)tdiff);\n","filename":"src\/hotspot\/os\/linux\/os_perf_linux.cpp","additions":22,"deletions":3,"binary":false,"changes":25,"status":"modified"}]}