{"files":[{"patch":"@@ -129,3 +129,3 @@\n- * {@code doInBackground} method is finished, {@code SwingWorker} notifies\n- * any {@code PropertyChangeListeners} about the {@code state} property\n- * change to {@code StateValue.DONE}. Finally, {@code done} method is executed.\n+ * {@code doInBackground} method is finished the {@code done} method is\n+ * executed.  Then {@code SwingWorker} notifies any {@code PropertyChangeListeners}\n+ * about the {@code state} property change to {@code StateValue.DONE}.\n@@ -307,1 +307,0 @@\n-                            setState(StateValue.DONE);\n@@ -309,0 +308,1 @@\n+                            setState(StateValue.DONE);\n@@ -313,1 +313,2 @@\n-       future = new FutureTask<T>(callable);\n+        future = new FutureTask<T>(callable);\n+\n","filename":"src\/java.desktop\/share\/classes\/javax\/swing\/SwingWorker.java","additions":6,"deletions":5,"binary":false,"changes":11,"status":"modified"},{"patch":"@@ -35,0 +35,1 @@\n+import java.util.concurrent.atomic.AtomicBoolean;\n@@ -38,1 +39,2 @@\n-    private static volatile boolean doInBackground = false;\n+    private static AtomicBoolean doInBackgroundStarted = new AtomicBoolean(false);\n+    private static AtomicBoolean doInBackgroundFinished = new AtomicBoolean(false);\n@@ -56,0 +58,1 @@\n+                    doInBackgroundStarted.set(true);\n@@ -59,1 +62,1 @@\n-                    doInBackground = true;\n+                    doInBackgroundFinished.set(true);\n@@ -68,1 +71,1 @@\n-                if (!doInBackground) {\n+                if (!doInBackgroundFinished.get()) {\n@@ -80,2 +83,0 @@\n-                    System.out.println(\"doInBackground \" + doInBackground +\n-                                       \" state \" + worker.getState());\n@@ -85,1 +86,1 @@\n-                    if (doInBackground &&\n+                    if (doInBackgroundFinished.get() &&\n@@ -93,1 +94,1 @@\n-                    if (!doInBackground &&\n+                    if (doInBackgroundStarted.get() &&\n@@ -102,1 +103,1 @@\n-                    if (doInBackground &&\n+                    if (doInBackgroundFinished.get() &&\n@@ -106,1 +107,1 @@\n-                            \" doInBackground is finised but before State changed to DONE\");\n+                            \" doInBackground is finished but before State changed to DONE\");\n@@ -124,1 +125,1 @@\n-        System.out.println(\"doInBackground \" + doInBackground +\n+        System.out.println(\"doInBackground \" + doInBackgroundFinished.get() +\n@@ -126,1 +127,2 @@\n-        if (doInBackground && worker.getState() != SwingWorker.StateValue.DONE) {\n+        if (doInBackgroundFinished.get() &&\n+              worker.getState() != SwingWorker.StateValue.DONE) {\n","filename":"test\/jdk\/javax\/swing\/SwingWorker\/TestDoneBeforeDoInBackground.java","additions":13,"deletions":11,"binary":false,"changes":24,"status":"modified"}]}