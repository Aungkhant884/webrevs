{"files":[{"patch":"@@ -702,2 +702,2 @@\n-  Node* tlab_top_adr = AddPNode::make(macro->igvn(), macro->top()\/*not oop*\/, thread, in_bytes(JavaThread::tlab_top_offset()));\n-  Node* tlab_end_adr = AddPNode::make(macro->igvn(), macro->top()\/*not oop*\/, thread, in_bytes(JavaThread::tlab_end_offset()));\n+  Node* tlab_top_adr = in_bytes(JavaThread::tlab_top_offset()) ? macro->transform_later(new AddPNode(macro->top()\/*not oop*\/, thread, macro->igvn().makecon(in_bytes(JavaThread::tlab_top_offset())))) : thread;\n+  Node* tlab_end_adr = in_bytes(JavaThread::tlab_end_offset()) ? macro->transform_later(new AddPNode(macro->top()\/*not oop*\/, thread, macro->igvn().makecon(in_bytes(JavaThread::tlab_end_offset())))) : thread;\n@@ -770,2 +770,2 @@\n-  Node* payload_src = AddPNode::make(phase->igvn(), src, src_offset);\n-  Node* payload_dst = AddPNode::make(phase->igvn(), dest, dest_offset);\n+  Node* payload_src = phase->transform_later(new AddPNode(src, src, src_offset));\n+  Node* payload_dst = phase->transform_later(new AddPNode(dest, dest, dest_offset));\n","filename":"src\/hotspot\/share\/gc\/shared\/c2\/barrierSetC2.cpp","additions":4,"deletions":4,"binary":false,"changes":8,"status":"modified"},{"patch":"@@ -819,2 +819,2 @@\n-  Node* src = AddPNode::make(phase->igvn(), src_base, src_offset);\n-  Node* dest = AddPNode::make(phase->igvn(), dest_base, dest_offset);\n+  Node* src = phase->transform_later(new AddPNode(src_base, src_base, src_offset));\n+  Node* dest = phase->transform_later(new AddPNode(dest_base, dest_base, dest_offset));\n","filename":"src\/hotspot\/share\/gc\/shenandoah\/c2\/shenandoahBarrierSetC2.cpp","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -308,2 +308,2 @@\n-    Node* payload_src = AddPNode::make(phase->igvn(), src, src_offset);\n-    Node* payload_dst = AddPNode::make(phase->igvn(), dest, dest_offset);\n+    Node* payload_src = phase->transform_later(new AddPNode(src, src, src_offset));\n+    Node* payload_dst = phase->transform_later(new AddPNode(dest, dest, dest_offset));\n","filename":"src\/hotspot\/share\/gc\/x\/c2\/xBarrierSetC2.cpp","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -490,2 +490,2 @@\n-    Node* const payload_src = AddPNode::make(phase->igvn(), src, src_offset);\n-    Node* const payload_dst = AddPNode::make(phase->igvn(), dest, dest_offset);\n+    Node* const payload_src = phase->transform_later(new AddPNode(src, src, src_offset));\n+    Node* const payload_dst = phase->transform_later(new AddPNode(dest, dest, dest_offset));\n","filename":"src\/hotspot\/share\/gc\/z\/c2\/zBarrierSetC2.cpp","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -34,0 +34,1 @@\n+#include \"opto\/phaseX.hpp\"\n","filename":"src\/hotspot\/share\/opto\/addnode.cpp","additions":1,"deletions":0,"binary":false,"changes":1,"status":"modified"},{"patch":"@@ -31,1 +31,0 @@\n-#include \"opto\/phaseX.hpp\"\n@@ -176,17 +175,0 @@\n-  \/\/ Helper methods roughly modeled after GraphKit:\n-  static Node* make(PhaseIterGVN& igvn, Node* base, Node* ptr, Node* offset) {\n-    return igvn.register_new_node_with_optimizer(new AddPNode(base, ptr, offset));\n-  }\n-\n-  static Node* make(PhaseIterGVN& igvn, Node* base, int offset) {\n-    return (offset == 0) ? base : make(igvn, base, base, (Node*) igvn.makecon(offset));\n-  }\n-\n-  static Node* make(PhaseIterGVN& igvn, Node* base, Node* ptr, int offset) {\n-    return (offset == 0) ? ptr : make(igvn, base, ptr, (Node*) igvn.makecon(offset));\n-  }\n-\n-  static Node* make(PhaseIterGVN& igvn, Node* base, Node* offset) {\n-    return make(igvn, base, base, offset);\n-  }\n-\n","filename":"src\/hotspot\/share\/opto\/addnode.hpp","additions":0,"deletions":18,"binary":false,"changes":18,"status":"modified"},{"patch":"@@ -1682,1 +1682,1 @@\n-  Node* memadr = AddPNode::make(_igvn, object, oopDesc::mark_offset_in_bytes());\n+  Node* memadr = transform_later(new AddPNode(object, object, _igvn.makecon(oopDesc::mark_offset_in_bytes())));\n@@ -1685,1 +1685,1 @@\n-  memadr = AddPNode::make(_igvn, object, oopDesc::klass_offset_in_bytes());\n+  memadr = transform_later(new AddPNode(object, object, _igvn.makecon(oopDesc::klass_offset_in_bytes())));\n@@ -1691,1 +1691,1 @@\n-    memadr = AddPNode::make(_igvn, object, arrayOopDesc::length_offset_in_bytes());\n+    memadr = transform_later(new AddPNode(object, object, _igvn.makecon(arrayOopDesc::length_offset_in_bytes())));\n@@ -2306,1 +2306,1 @@\n-      Node* k_adr = AddPNode::make(_igvn, obj_or_subklass, oopDesc::klass_offset_in_bytes());\n+      Node* k_adr = _igvn.transform(new AddPNode(obj_or_subklass, obj_or_subklass, _igvn.makecon(oopDesc::klass_offset_in_bytes())));\n","filename":"src\/hotspot\/share\/opto\/macro.cpp","additions":4,"deletions":4,"binary":false,"changes":8,"status":"modified"},{"patch":"@@ -55,1 +55,1 @@\n-  Node* base =  AddPNode::make(igvn(), ary, header);\n+  Node* base =  transform_later(new AddPNode(ary, ary, igvn().makecon(header)));\n@@ -64,1 +64,1 @@\n-  return AddPNode::make(igvn(), ary, base, scale);\n+  return transform_later(new AddPNode(ary, base, scale));\n@@ -645,1 +645,1 @@\n-        Node* p1 = AddPNode::make(igvn(), dest_klass, ek_offset);\n+        Node* p1 = transform_later(new AddPNode(dest_klass, dest_klass, igvn().makecon(ek_offset)));\n@@ -961,1 +961,1 @@\n-        Node* p1 = AddPNode::make(_igvn, dest, dest, x1);\n+        Node* p1 = transform_later(new AddPNode(dest, dest, x1));\n@@ -1010,2 +1010,2 @@\n-      Node* sptr = AddPNode::make(igvn(), src,  src_off);\n-      Node* dptr = AddPNode::make(igvn(), dest, dest_off);\n+      Node* sptr = transform_later(new AddPNode(src, src,  igvn().makecon(src_off)));\n+      Node* dptr = transform_later(new AddPNode(dest, dest, igvn().makecon(dest_off)));\n@@ -1038,2 +1038,2 @@\n-  Node* sptr  = AddPNode::make(igvn(), src,  src_off);\n-  Node* dptr  = AddPNode::make(igvn(), dest, dest_off);\n+  Node* sptr  = transform_later(new AddPNode(src, src,  igvn().makecon(src_off)));\n+  Node* dptr  = transform_later(new AddPNode(dest, dest, igvn().makecon(dest_off)));\n@@ -1131,1 +1131,1 @@\n-  Node* p3 = AddPNode::make(igvn(), dest_elem_klass, sco_offset);\n+  Node* p3 = transform_later(new AddPNode(dest_elem_klass, dest_elem_klass, igvn().makecon(sco_offset)));\n","filename":"src\/hotspot\/share\/opto\/macroArrayCopy.cpp","additions":9,"deletions":9,"binary":false,"changes":18,"status":"modified"}]}