{"files":[{"patch":"@@ -330,0 +330,1 @@\n+      assert(card_set == G1CardSet::FullCardSet, \"Must be\");\n@@ -331,1 +332,0 @@\n-        assert(card_set == G1CardSet::FullCardSet, \"Must be\");\n@@ -333,3 +333,1 @@\n-        for (uint i = 0; i < config->max_cards_in_region(); i++) {\n-          found((offset | (uint)i));\n-        }\n+        found(offset, config->num_cards_in_howl_bitmap());\n","filename":"src\/hotspot\/share\/gc\/g1\/g1CardSetContainers.inline.hpp","additions":2,"deletions":4,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -126,1 +126,1 @@\n-  uint scan_chunk_size() const { return (uint)1 << _scan_chunks_shift; }\n+  uint scan_chunk_size_in_cards() const { return (uint)1 << _scan_chunks_shift; }\n@@ -371,1 +371,1 @@\n-  void set_chunk_region_dirty(size_t const region_card_idx) {\n+  void set_chunk_range_dirty(size_t const region_card_idx, size_t const card_length) {\n@@ -373,1 +373,2 @@\n-    for (uint i = 0; i < _scan_chunks_per_region; i++) {\n+    size_t const num_chunks = (card_length + scan_chunk_size_in_cards() - 1) >> _scan_chunks_shift;\n+    for (uint i = 0; i < num_chunks; i++) {\n@@ -754,1 +755,1 @@\n-  uint size() const { return _scan_state->scan_chunk_size(); }\n+  uint size() const { return _scan_state->scan_chunk_size_in_cards(); }\n@@ -1211,3 +1212,1 @@\n-      assert(start_card_idx == 0, \"must be\");\n-      assert(length == HeapRegion::CardsPerRegion, \"must be\");\n-      size_t num_dirtied = _ct->mark_range_dirty(_region_base_idx, HeapRegion::CardsPerRegion);\n+      size_t num_dirtied = _ct->mark_range_dirty(_region_base_idx + start_card_idx, length);\n@@ -1215,1 +1214,1 @@\n-      _scan_state->set_chunk_region_dirty(_region_base_idx);\n+      _scan_state->set_chunk_range_dirty(_region_base_idx + start_card_idx, length);\n","filename":"src\/hotspot\/share\/gc\/g1\/g1RemSet.cpp","additions":7,"deletions":8,"binary":false,"changes":15,"status":"modified"}]}