{"files":[{"patch":"@@ -30,0 +30,1 @@\n+\n@@ -50,3 +51,7 @@\n-        Path copy_jdk1_dir = Path.of(\".\/copy-jdk1-tmpdir\");\n-        Path copy_jdk2_dir = Path.of(\".\/copy-jdk2-tmpdir\");\n-        Path jdk_test_dir = Path.of(\n+        Path copyJdk1Dir = Path.of(\".\/copy-jdk1-tmpdir\");\n+        Files.createDirectory(copyJdk1Dir);\n+\n+        Path copyJdk2Dir = Path.of(\".\/copy-jdk2-tmpdir\");\n+        Files.createDirectory(copyJdk2Dir);\n+\n+        Path jdkTestDir = Path.of(\n@@ -58,1 +63,2 @@\n-        copyJDKs(jdk_test_dir, copy_jdk1_dir, copy_jdk2_dir);\n+        copyJDK(jdkTestDir, copyJdk1Dir);\n+        copyJDK(jdkTestDir, copyJdk2Dir);\n@@ -60,2 +66,2 @@\n-        Path copied_jlink1 = Optional.of(\n-                Paths.get(copy_jdk1_dir.toString(), \"bin\", \"jlink\"))\n+        Path copiedJlink1 = Optional.of(\n+                Paths.get(copyJdk1Dir.toString(), \"bin\", \"jlink\"))\n@@ -65,2 +71,2 @@\n-        Path copied_jlink2 = Optional.of(\n-                Paths.get(copy_jdk2_dir.toString(), \"bin\", \"jlink\"))\n+        Path copiedJlink2 = Optional.of(\n+                Paths.get(copyJdk2Dir.toString(), \"bin\", \"jlink\"))\n@@ -70,2 +76,2 @@\n-        runCopiedJlink(copied_jlink1.toString(), \"--add-modules\", \"java.base,jdk.management,jdk.unsupported,jdk.charsets\", \"--output\", image1.toString());\n-        runCopiedJlink(copied_jlink2.toString(), \"--add-modules\", \"java.base,jdk.management,jdk.unsupported,jdk.charsets\", \"--output\", image2.toString());\n+        runCopiedJlink(copiedJlink1.toString(), \"--add-modules\", \"java.base,jdk.management,jdk.unsupported,jdk.charsets\", \"--output\", image1.toString());\n+        runCopiedJlink(copiedJlink2.toString(), \"--add-modules\", \"java.base,jdk.management,jdk.unsupported,jdk.charsets\", \"--output\", image2.toString());\n@@ -80,9 +86,2 @@\n-        var pb = new ProcessBuilder(args);\n-        var res = ProcessTools.executeProcess(pb);\n-        res.shouldHaveExitValue(0);\n-    }\n-\n-    private static String runJavaVersion(Path jdk_test_base_dir) throws Exception {\n-        var java_exec = Paths.get(jdk_test_base_dir.toString(), \"bin\", \"java\");\n-        var pb = new ProcessBuilder(java_exec.toString(), \"--version\");\n-        var res = ProcessTools.executeProcess(pb);\n+        var process = new ProcessBuilder(args);\n+        var res = ProcessTools.executeProcess(process);\n@@ -90,3 +89,0 @@\n-        return res.getStdout();\n-\n-\n@@ -95,1 +91,1 @@\n-    private static void copyJDKs(Path src, Path dst1, Path dst2) throws Exception {\n+    private static void copyJDK(Path src, Path dst) throws Exception {\n@@ -98,8 +94,1 @@\n-                System.out.println(file);\n-                if(Files.isDirectory(file)) {\n-                    Files.createDirectories(dst1.resolve(src.relativize(file)));\n-                    Files.createDirectories(dst2.resolve(src.relativize(file)));\n-                } else {\n-                    Files.copy(file, dst1.resolve(src.relativize(file)));\n-                    Files.copy(file, dst2.resolve(src.relativize(file)));\n-                }\n+                Files.copy(file, dst.resolve(src.relativize(file)), StandardCopyOption.COPY_ATTRIBUTES);\n","filename":"test\/jdk\/tools\/jlink\/JLinkReproducible3Test.java","additions":20,"deletions":31,"binary":false,"changes":51,"status":"modified"}]}