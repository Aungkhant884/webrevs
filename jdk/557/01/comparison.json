{"files":[{"patch":"@@ -909,2 +909,2 @@\n-void G1RemSet::prepare_region_for_scan(HeapRegion* region) {\n-  uint hrm_index = region->hrm_index();\n+void G1RemSet::prepare_region_for_scan(HeapRegion* r) {\n+  uint hrm_index = r->hrm_index();\n@@ -912,2 +912,4 @@\n-  if (region->is_old_or_humongous_or_archive()) {\n-    _scan_state->set_scan_top(hrm_index, region->top());\n+  \/\/ Only update non-collection set old regions, others must have already been set\n+  \/\/ to NULL (don't scan) in the initialization.\n+  if (!r->in_collection_set() && r->is_old_or_humongous_or_archive()) {\n+    _scan_state->set_scan_top(hrm_index, r->top());\n@@ -915,2 +917,6 @@\n-    assert(region->in_collection_set() || region->is_free(),\n-           \"Should only be free or in the collection set at this point %s\", region->get_type_str());\n+    assert(r->in_collection_set() || r->is_free(),\n+           \"Region %u should be free or in the collection set but is %s\",\n+           hrm_index, r->get_type_str());\n+    assert(_scan_state->scan_top(hrm_index) == NULL,\n+           \"scan_top of region %u is unexpectedly \" PTR_FORMAT,\n+           hrm_index, p2i(_scan_state->scan_top(hrm_index)));\n","filename":"src\/hotspot\/share\/gc\/g1\/g1RemSet.cpp","additions":12,"deletions":6,"binary":false,"changes":18,"status":"modified"}]}