{"files":[{"patch":"@@ -774,4 +774,0 @@\n-  \/\/ Mask to clear normal event bits.\n-  const jlong CLEARING_MASK = (1L >> (TOTAL_MIN_EVENT_TYPE_VAL - TOTAL_MIN_EVENT_TYPE_VAL)) - 1L;\n-  \/\/ Avoid cleaning extension event bits.\n-  jlong enabled_bits = CLEARING_MASK & env->env_event_enable()->_event_callback_enabled.get_bits();\n@@ -779,0 +775,1 @@\n+  jlong enabled_bits = env->env_event_enable()->_event_callback_enabled.get_bits();\n@@ -781,0 +778,1 @@\n+    jlong bit_for = JvmtiEventEnabled::bit_for(evt_t);\n@@ -782,1 +780,3 @@\n-      enabled_bits |= JvmtiEventEnabled::bit_for(evt_t);\n+      enabled_bits |= bit_for;\n+    } else {\n+      enabled_bits &= ~bit_for;\n","filename":"src\/hotspot\/share\/prims\/jvmtiEventController.cpp","additions":5,"deletions":5,"binary":false,"changes":10,"status":"modified"},{"patch":"@@ -39,0 +39,2 @@\n+    static native boolean check();\n+\n@@ -69,0 +71,3 @@\n+        if (!check()) {\n+            throw new RuntimeException(\"VThreadTest failed!\");\n+        }\n","filename":"test\/hotspot\/jtreg\/serviceability\/jvmti\/vthread\/VThreadTest\/VThreadTest.java","additions":5,"deletions":0,"binary":false,"changes":5,"status":"modified"},{"patch":"@@ -43,0 +43,3 @@\n+static int vthread_mount_count = 0;\n+static int vthread_unmount_count = 0;\n+static jboolean passed = JNI_TRUE;\n@@ -538,0 +541,1 @@\n+  vthread_mount_count++;\n@@ -554,0 +558,1 @@\n+  vthread_unmount_count++;\n@@ -631,0 +636,21 @@\n+JNIEXPORT jboolean JNICALL\n+Java_VThreadTest_check(JNIEnv *jni, jclass cls) {\n+  LOG(\"\\n\");\n+  LOG(\"check: started\\n\");\n+\n+  LOG(\"check: vthread_mount_count:   %d\\n\", vthread_mount_count);\n+  LOG(\"check: vthread_unmount_count: %d\\n\", vthread_unmount_count);\n+\n+  if (vthread_mount_count == 0) {\n+    passed = JNI_FALSE;\n+    LOG(\"FAILED: vthread_mount_count == 0\\n\");\n+  }\n+  if (vthread_unmount_count == 0) {\n+    passed = JNI_FALSE;\n+    LOG(\"FAILED: vthread_unmount_count == 0\\n\");\n+  }\n+  LOG(\"check: finished\\n\");\n+  LOG(\"\\n\");\n+  return passed;\n+}\n+\n","filename":"test\/hotspot\/jtreg\/serviceability\/jvmti\/vthread\/VThreadTest\/libVThreadTest.cpp","additions":26,"deletions":0,"binary":false,"changes":26,"status":"modified"}]}