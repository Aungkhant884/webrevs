{"files":[{"patch":"@@ -775,1 +775,1 @@\n-  const jlong CLEARING_MASK = (1L >> (TOTAL_MIN_EVENT_TYPE_VAL - TOTAL_MIN_EVENT_TYPE_VAL)) - 1L;\n+  const jlong CLEARING_MASK = (1L >> (JVMTI_MIN_EVENT_TYPE_VAL - TOTAL_MIN_EVENT_TYPE_VAL)) - 1L;\n","filename":"src\/hotspot\/share\/prims\/jvmtiEventController.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -39,0 +39,2 @@\n+    static native boolean check();\n+\n@@ -69,0 +71,3 @@\n+        if (!check()) {\n+            throw new RuntimeException(\"VThreadTest failed!\");\n+        }\n","filename":"test\/hotspot\/jtreg\/serviceability\/jvmti\/vthread\/VThreadTest\/VThreadTest.java","additions":5,"deletions":0,"binary":false,"changes":5,"status":"modified"},{"patch":"@@ -43,0 +43,3 @@\n+static int vthread_mount_count = 0;\n+static int vthread_unmount_count = 0;\n+static jboolean passed = JNI_TRUE;\n@@ -538,0 +541,1 @@\n+  vthread_mount_count++;\n@@ -554,0 +558,1 @@\n+  vthread_unmount_count++;\n@@ -602,1 +607,1 @@\n-  err = jvmti->SetEventNotificationMode(JVMTI_ENABLE, JVMTI_EVENT_VIRTUAL_THREAD_START, NULL);\n+  err = jvmti->SetEventNotificationMode(JVMTI_ENABLE, EXT_EVENT_VIRTUAL_THREAD_MOUNT, NULL);\n@@ -608,1 +613,1 @@\n-  err = jvmti->SetEventNotificationMode(JVMTI_ENABLE, JVMTI_EVENT_VIRTUAL_THREAD_END, NULL);\n+  err = jvmti->SetEventNotificationMode(JVMTI_ENABLE, EXT_EVENT_VIRTUAL_THREAD_UNMOUNT, NULL);\n@@ -614,1 +619,1 @@\n-  err = jvmti->SetEventNotificationMode(JVMTI_ENABLE, EXT_EVENT_VIRTUAL_THREAD_MOUNT, NULL);\n+  err = jvmti->SetEventNotificationMode(JVMTI_ENABLE, JVMTI_EVENT_VIRTUAL_THREAD_START, NULL);\n@@ -620,1 +625,1 @@\n-  err = jvmti->SetEventNotificationMode(JVMTI_ENABLE, EXT_EVENT_VIRTUAL_THREAD_UNMOUNT, NULL);\n+  err = jvmti->SetEventNotificationMode(JVMTI_ENABLE, JVMTI_EVENT_VIRTUAL_THREAD_END, NULL);\n@@ -631,0 +636,21 @@\n+JNIEXPORT jboolean JNICALL\n+Java_VThreadTest_check(JNIEnv *jni, jclass cls) {\n+  LOG(\"\\n\");\n+  LOG(\"check: started\\n\");\n+\n+  LOG(\"check: vthread_mount_count:   %d\\n\", vthread_mount_count);\n+  LOG(\"check: vthread_unmount_count: %d\\n\", vthread_unmount_count);\n+\n+  if (vthread_mount_count == 0) {\n+    passed = JNI_FALSE;\n+    LOG(\"FAILED: vthread_mount_count == 0\\n\");\n+  }\n+  if (vthread_unmount_count == 0) {\n+    passed = JNI_FALSE;\n+    LOG(\"FAILED: vthread_unmount_count == 0\\n\");\n+  }\n+  LOG(\"check: finished\\n\");\n+  LOG(\"\\n\");\n+  return passed;\n+}\n+\n","filename":"test\/hotspot\/jtreg\/serviceability\/jvmti\/vthread\/VThreadTest\/libVThreadTest.cpp","additions":30,"deletions":4,"binary":false,"changes":34,"status":"modified"}]}