{"files":[{"patch":"@@ -273,1 +273,2 @@\n-    sun\/tools\/jrunscript\n+    sun\/tools\/jrunscript \\\n+    sun\/tools\/jmod\n","filename":"test\/jdk\/TEST.groups","additions":2,"deletions":1,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -3,0 +3,1 @@\n+# Copyright (c) 2022, Huawei Technologies Co., Ltd. All rights reserved.\n@@ -63,1 +64,0 @@\n-    JRUNSCRIPT=\"${TESTJAVA}\/bin\/jrunscript\"\n@@ -65,1 +65,1 @@\n-    JAVA=\"${TESTJAVA}\/bin\/java\"\n+    JMOD=\"${TESTJAVA}\/bin\/jmod\"\n","filename":"test\/jdk\/sun\/tools\/jmod\/common.sh","additions":2,"deletions":2,"binary":false,"changes":4,"previous_filename":"test\/jdk\/sun\/tools\/jrunscript\/common.sh","status":"copied"},{"patch":"@@ -0,0 +1,74 @@\n+#!\/bin\/sh\n+\n+#\n+# Copyright (c) 2022, Huawei Technologies Co., Ltd. All rights reserved.\n+# DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+#\n+# This code is free software; you can redistribute it and\/or modify it\n+# under the terms of the GNU General Public License version 2 only, as\n+# published by the Free Software Foundation.\n+#\n+# This code is distributed in the hope that it will be useful, but WITHOUT\n+# ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+# FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+# version 2 for more details (a copy is included in the LICENSE file that\n+# accompanied this code).\n+#\n+# You should have received a copy of the GNU General Public License version\n+# 2 along with this work; if not, write to the Free Software Foundation,\n+# Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n+#\n+# Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n+# or visit www.oracle.com if you need additional information or have any\n+# questions.\n+#\n+\n+\n+# @test\n+# @bug 8240903\n+# @run shell jmod-moduleHashesTest.sh\n+# @summary Test consistency of moduleHashes attribute between builds\n+\n+. ${TESTSRC-.}\/common.sh\n+\n+setup\n+\n+NUM_MODULES=64\n+\n+mkdir -p src\/ma\n+echo \"module ma {}\" > src\/ma\/module-info.java\n+\n+for i in $(seq $NUM_MODULES); do\n+    mb_name=m${i}b\n+    mkdir -p src\/$mb_name\n+    echo \"module $mb_name {requires ma;}\" > src\/$mb_name\/module-info.java\n+    ${JAVAC} --module-source-path src --module $mb_name -d ${TESTCLASSES}\/classes\n+done\n+\n+mkdir jmods-first\n+mkdir jmods-second\n+\n+for i in $(seq $NUM_MODULES); do\n+    mb_name=m${i}b\n+\n+    ${JMOD} create -class-path ${TESTCLASSES}\/classes\/$mb_name --date=\"2021-01-06T14:36:00+02:00\" \\\n+        jmods-first\/$mb_name.jmod\n+\n+    ${JMOD} create -class-path ${TESTCLASSES}\/classes\/$mb_name --date=\"2021-01-06T14:36:00+02:00\" \\\n+        jmods-second\/$mb_name.jmod\n+done\n+\n+${JMOD} create -class-path ${TESTCLASSES}\/classes\/ma --date=\"2021-01-06T14:36:00+02:00\" \\\n+    --module-path jmods-first --hash-modules \".*\" jmods-first\/ma.jmod\n+\n+${JMOD} create -class-path ${TESTCLASSES}\/classes\/ma --date=\"2021-01-06T14:36:00+02:00\" \\\n+    --module-path jmods-second --hash-modules \".*\" jmods-second\/ma.jmod\n+\n+$golden_diff jmods-first\/ma.jmod jmods-second\/ma.jmod\n+if [ $? != 0 ]\n+then\n+    echo \"ModuleHashes attribute not reproducible between builds. Failed.\"\n+    exit 1\n+fi\n+echo \"Passed\"\n+exit 0\n","filename":"test\/jdk\/sun\/tools\/jmod\/jmod-moduleHashesTest.sh","additions":74,"deletions":0,"binary":false,"changes":74,"status":"added"}]}