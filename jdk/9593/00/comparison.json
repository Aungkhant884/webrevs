{"files":[{"patch":"@@ -987,8 +987,0 @@\n-  \/\/ If we start the compaction before the CM threads finish\n-  \/\/ scanning the root regions we might trip them over as we'll\n-  \/\/ be moving objects \/ updating references. So let's wait until\n-  \/\/ they are done. By telling them to abort, they should complete\n-  \/\/ early.\n-  _cm->root_regions()->abort();\n-  _cm->root_regions()->wait_until_scan_finished();\n-\n@@ -3281,1 +3273,1 @@\n-    _cm->root_regions()->add(alloc_region->top_at_mark_start(), alloc_region->top());\n+    _cm->add_root_region(alloc_region);\n","filename":"src\/hotspot\/share\/gc\/g1\/g1CollectedHeap.cpp","additions":1,"deletions":9,"binary":false,"changes":10,"status":"modified"},{"patch":"@@ -1009,0 +1009,8 @@\n+bool G1ConcurrentMark::wait_until_root_region_scan_finished() {\n+  return root_regions()->wait_until_scan_finished();\n+}\n+\n+void G1ConcurrentMark::add_root_region(HeapRegion* r) {\n+  root_regions()->add(r->top_at_mark_start(), r->top());\n+}\n+\n@@ -2021,0 +2029,8 @@\n+  \/\/ If we start the compaction before the CM threads finish\n+  \/\/ scanning the root regions we might trip them over as we'll\n+  \/\/ be moving objects \/ updating references. So let's wait until\n+  \/\/ they are done. By telling them to abort, they should complete\n+  \/\/ early.\n+  root_regions()->abort();\n+  root_regions()->wait_until_scan_finished();\n+\n","filename":"src\/hotspot\/share\/gc\/g1\/g1ConcurrentMark.cpp","additions":16,"deletions":0,"binary":false,"changes":16,"status":"modified"},{"patch":"@@ -288,0 +288,1 @@\n+  friend class G1CMRootRegionScanTask;\n@@ -500,2 +501,0 @@\n-  G1CMRootMemRegions* root_regions() { return &_root_regions; }\n-\n@@ -560,0 +559,5 @@\n+  bool wait_until_root_region_scan_finished();\n+  void add_root_region(HeapRegion* r);\n+\n+private:\n+  G1CMRootMemRegions* root_regions() { return &_root_regions; }\n@@ -564,0 +568,2 @@\n+public:\n+\n@@ -611,1 +617,0 @@\n-\n","filename":"src\/hotspot\/share\/gc\/g1\/g1ConcurrentMark.hpp","additions":8,"deletions":3,"binary":false,"changes":11,"status":"modified"},{"patch":"@@ -248,1 +248,1 @@\n-  bool waited = concurrent_mark()->root_regions()->wait_until_scan_finished();\n+  bool waited = concurrent_mark()->wait_until_root_region_scan_finished();\n","filename":"src\/hotspot\/share\/gc\/g1\/g1YoungCollector.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"}]}