[{"commit":{"message":"8270067: AArch64: several clhsdb tests fail with -Xcomp\n\nRunning the jtreg test serviceability\/sa\/ClhsdbWhere.java with -Xcomp\n-XX:-TieredCompilation fails with the following exception:\n\n  Error: java.lang.NullPointerException: Cannot invoke \"sun.jvm.hotspot.debugger.Address.getJLongAt(long)\" because \"valueAddr\" is null\n  java.lang.NullPointerException: Cannot invoke \"sun.jvm.hotspot.debugger.Address.getJLongAt(long)\" because \"valueAddr\" is null\n          at jdk.hotspot.agent\/sun.jvm.hotspot.runtime.CompiledVFrame.createStackValue(CompiledVFrame.java:270)\n          at jdk.hotspot.agent\/sun.jvm.hotspot.runtime.CompiledVFrame.getLocals(CompiledVFrame.java:107)\n          at jdk.hotspot.agent\/sun.jvm.hotspot.ui.classbrowser.HTMLGenerator.genHTMLForJavaStackTrace(HTMLGenerator.java:1937)\n          at jdk.hotspot.agent\/sun.jvm.hotspot.CommandProcessor$43.doit(CommandProcessor.java:1573)\n          at jdk.hotspot.agent\/sun.jvm.hotspot.CommandProcessor.executeCommand(CommandProcessor.java:2090)\n          at jdk.hotspot.agent\/sun.jvm.hotspot.CommandProcessor.executeCommand(CommandProcessor.java:2060)\n\nThe oop map for the frame being inspected is:\n\n   ScopeDesc(pc=0x0000ffff8957e000 offset=140):\n   jdk.test.lib.apps.LingeredApp::steadyState@7 (line 536)\n   Locals\n    - l0: empty\n    - l1: reg rfp [58],oop\n    - l2: empty\n   Monitor stack\n    - @0: monitor{reg rfp [58],oop,stack[16]}\n\nBut RegisterMap::getLocation() returns a null Address for register\n58 (=RFP).\n\nThis patch fixes two problems: the fp VMReg value used in\nAARCH64Frame::updateMapWithSavedLink should be 29<<1 not 29 because a\nVMReg has two slots in a 64-bit VM.  The other bug is that\nRegisterMap::setLocation and getLocation calculate the long\nlocationValid mask using (1 << (i % locationValidTypeSize)) where i and\nlocationValidTypeSize are both int.  We need to do this calculation as a\nlong if i % locationValidTypeSize can be > 32.  There's no failure on\nx86_64 because that only has 16 integer registers."},"files":[{"filename":"src\/jdk.hotspot.agent\/share\/classes\/sun\/jvm\/hotspot\/runtime\/RegisterMap.java"},{"filename":"src\/jdk.hotspot.agent\/share\/classes\/sun\/jvm\/hotspot\/runtime\/aarch64\/AARCH64Frame.java"}],"sha":"1f3d5d38c4cf4b7576eb260a8311bfaf719af62e"}]