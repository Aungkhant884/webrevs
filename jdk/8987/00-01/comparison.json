{"files":[{"patch":"@@ -74,1 +74,0 @@\n-        noCleanupBeforeExec = cmd.noCleanupBeforeExec;\n@@ -667,6 +666,0 @@\n-    public JPackageCommand noCleanupBeforeExec(boolean v) {\n-        verifyMutable();\n-        noCleanupBeforeExec = v;\n-        return this;\n-    }\n-\n@@ -712,1 +705,1 @@\n-        if (!noCleanupBeforeExec) {\n+        if (hasArgument(\"--dest\")) {\n@@ -1001,1 +994,0 @@\n-    private boolean noCleanupBeforeExec;\n","filename":"test\/jdk\/tools\/jpackage\/helpers\/jdk\/jpackage\/test\/JPackageCommand.java","additions":1,"deletions":9,"binary":false,"changes":10,"status":"modified"},{"patch":"@@ -28,0 +28,1 @@\n+import jdk.jpackage.test.PackageType;\n@@ -69,1 +70,1 @@\n-        Path appimageOutput = TKit.workDir().resolve(\"appimage\");\n+        Path appimageOutput = TKit.createTempDirectory(\"appimage\");\n@@ -93,11 +94,6 @@\n-        JPackageCommand cmd = JPackageCommand.helloAppImage()\n-                .addArguments(\"--app-image\", appImageCmd.outputBundle().toAbsolutePath())\n-                .addArguments(\"--mac-sign\")\n-                .addArguments(\"--mac-signing-key-user-name\", SigningBase.DEV_NAME)\n-                .addArguments(\"--mac-signing-keychain\", SigningBase.KEYCHAIN)\n-                .removeArgumentWithValue(\"--input\")\n-                .removeArgumentWithValue(\"--dest\")\n-                .removeArgumentWithValue(\"--name\")\n-                .removeArgumentWithValue(\"--main-jar\")\n-                .removeArgumentWithValue(\"--main-class\")\n-                .noCleanupBeforeExec(true);\n+        JPackageCommand cmd = new JPackageCommand();\n+        cmd.setPackageType(PackageType.IMAGE)\n+            .addArguments(\"--app-image\", appImageCmd.outputBundle().toAbsolutePath())\n+            .addArguments(\"--mac-sign\")\n+            .addArguments(\"--mac-signing-key-user-name\", SigningBase.DEV_NAME)\n+            .addArguments(\"--mac-signing-keychain\", SigningBase.KEYCHAIN);\n","filename":"test\/jdk\/tools\/jpackage\/macosx\/SigningAppImageTwoStepsTest.java","additions":8,"deletions":12,"binary":false,"changes":20,"status":"modified"},{"patch":"@@ -44,0 +44,1 @@\n+ * \n@@ -47,9 +48,1 @@\n- *\/\n-\n-\/*\n- * @test\n- * @summary Test jpackage output for erroneous input with --type \"app-image\" and --app-image\n- * @library ..\/..\/..\/..\/helpers\n- * @build jdk.jpackage.test.*\n- * @modules jdk.jpackage\/jdk.jpackage.internal\n- * @compile PredefinedAppImageErrorTest.java\n+ * \n@@ -94,1 +87,1 @@\n-                .saveConsoleOutput(true).dumpOutput(true).noCleanupBeforeExec(true);\n+                .saveConsoleOutput(true).dumpOutput(true);\n@@ -97,1 +90,2 @@\n-        } if (removeArgs != null) {\n+        }\n+        if (removeArgs != null) {\n@@ -115,2 +109,1 @@\n-            = TKit.workDir().resolve(\"DummyAppImage\").toAbsolutePath();\n-        Files.createDirectory(dummyAppFolder);\n+            = TKit.createTempDirectory(\"DummyAppImage\").toAbsolutePath();\n","filename":"test\/jdk\/tools\/jpackage\/share\/jdk\/jpackage\/tests\/PredefinedAppImageErrorTest.java","additions":6,"deletions":13,"binary":false,"changes":19,"status":"modified"}]}