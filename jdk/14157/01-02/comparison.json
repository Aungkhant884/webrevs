{"files":[{"patch":"@@ -28,2 +28,1 @@\n- * @run main\/othervm MacToRealPathWithSM\n- * @run main\/othervm -Djava.security.manager=allow MacToRealPathWithSM MacToRealPath.policy\n+ * @run junit\/othervm -Djava.security.manager=allow MacToRealPathWithSM\n@@ -31,0 +30,1 @@\n+import java.io.IOException;\n@@ -35,0 +35,6 @@\n+import org.junit.jupiter.api.BeforeAll;\n+import org.junit.jupiter.params.ParameterizedTest;\n+import org.junit.jupiter.params.provider.ValueSource;\n+\n+import static org.junit.jupiter.api.Assertions.assertDoesNotThrow;\n+\n@@ -36,3 +42,7 @@\n-    @SuppressWarnings(\"removal\")\n-    public static void main(String[] args) throws Exception {\n-        String policyFile = args.length > 0 ? args[0] : null;\n+    private static final String POLICY_FILE = \"MacToRealPath.policy\";\n+\n+    private static Path src;\n+    private static Path path;\n+\n+    @BeforeAll\n+    public static void setup() throws IOException {\n@@ -45,1 +55,1 @@\n-        Path src = Path.of(testSrc);\n+        src = Path.of(testSrc);\n@@ -48,1 +58,1 @@\n-        Path path = Files.createTempFile(tmp, \"bonjour\", \".txt\");\n+        path = Files.createTempFile(tmp, \"bonjour\", \".txt\");\n@@ -54,0 +64,1 @@\n+    }\n@@ -55,0 +66,4 @@\n+    @ParameterizedTest\n+    @ValueSource(strings = {\"\", POLICY_FILE})\n+    @SuppressWarnings(\"removal\")\n+    public void testToRealPath(String policyFile) throws IOException {\n@@ -56,1 +71,1 @@\n-        if (policyFile != null) {\n+        if (!policyFile.isEmpty()) {\n@@ -66,3 +81,7 @@\n-        System.out.printf(\"real path: %s%n\", path.toRealPath());\n-        System.out.printf(\"real path no follow: %s%n\",\n-                          path.toRealPath(LinkOption.NOFOLLOW_LINKS));\n+        assertDoesNotThrow(() ->\n+            System.out.printf(\"real path: %s%n\", path.toRealPath()),\n+            \"UnixPath::toRealPath() failed\");\n+        assertDoesNotThrow(() ->\n+            System.out.printf(\"real path no follow: %s%n\",\n+                              path.toRealPath(LinkOption.NOFOLLOW_LINKS)),\n+            \"UnixPath::toRealPath(LinkOption.NOFOLLOW_LINKS) failed\");\n","filename":"test\/jdk\/java\/nio\/file\/Path\/MacToRealPathWithSM.java","additions":30,"deletions":11,"binary":false,"changes":41,"status":"modified"}]}