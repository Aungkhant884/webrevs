{"files":[{"patch":"@@ -59,0 +59,1 @@\n+import static jdk.jpackage.internal.StandardBundlerParam.SHORTCUT_HINT;;\n@@ -85,1 +86,1 @@\n-        boolean withDesktopFile = !associations.isEmpty() || SHORTCUT_HINT.fetchFrom(params);\n+        boolean withDesktopFile = !associations.isEmpty() || LINUX_SHORTCUT_HINT.fetchFrom(params);\n@@ -141,1 +142,2 @@\n-            List<AppImageFile.LauncherInfo> launchers = AppImageFile.getLaunchers(\n+            List<AppImageFile.LauncherInfo> launcherInfos =\n+                    AppImageFile.getLaunchers(\n@@ -143,2 +145,2 @@\n-            if (!launchers.isEmpty()) {\n-                launchers.remove(0); \/\/ Remove main launcher\n+            if (!launcherInfos.isEmpty()) {\n+                launcherInfos.remove(0); \/\/ Remove main launcher\n@@ -146,1 +148,1 @@\n-            for (var launcher : launchers) {\n+            for (var launcherInfo : launcherInfos) {\n@@ -149,5 +151,6 @@\n-                        launcher.getName());\n-                launcherParams = AddLauncherArguments.merge(params, launcherParams,\n-                    ICON.getID(), ICON_PNG.getID(), ADD_LAUNCHERS.getID(),\n-                    FILE_ASSOCIATIONS.getID(), PREDEFINED_APP_IMAGE.getID());\n-                if (launcher.isShortcut()) {\n+                        launcherInfo.getName());\n+                launcherParams = AddLauncherArguments.merge(params,\n+                        launcherParams, ICON.getID(), ICON_PNG.getID(),\n+                        ADD_LAUNCHERS.getID(), FILE_ASSOCIATIONS.getID(),\n+                        PREDEFINED_APP_IMAGE.getID());\n+                if (launcherInfo.isShortcut()) {\n@@ -160,5 +163,7 @@\n-                launcherParams = AddLauncherArguments.merge(params, launcherParams,\n-                        ICON.getID(), ICON_PNG.getID(), ADD_LAUNCHERS.getID(),\n-                        FILE_ASSOCIATIONS.getID());\n-                nestedIntegrations.add(new DesktopIntegration(thePackage,\n-                        launcherParams, params));\n+                launcherParams = AddLauncherArguments.merge(params,\n+                        launcherParams, ICON.getID(), ICON_PNG.getID(),\n+                        ADD_LAUNCHERS.getID(), FILE_ASSOCIATIONS.getID());\n+                if (SHORTCUT_HINT.fetchFrom(launcherParams)) {\n+                    nestedIntegrations.add(new DesktopIntegration(thePackage,\n+                            launcherParams, params));\n+                }\n@@ -572,1 +577,1 @@\n-    private static final StandardBundlerParam<Boolean> SHORTCUT_HINT =\n+    private static final StandardBundlerParam<Boolean> LINUX_SHORTCUT_HINT =\n","filename":"src\/jdk.jpackage\/linux\/classes\/jdk\/jpackage\/internal\/DesktopIntegration.java","additions":21,"deletions":16,"binary":false,"changes":37,"status":"modified"},{"patch":"@@ -84,1 +84,3 @@\n-    public AdditionalLauncher setShortcuts(boolean menu, boolean desktop) {\n+    public AdditionalLauncher setShortcuts(boolean menu, boolean shortcut) {\n+        withMenuShortcut = menu;\n+        withShortcut = shortcut;\n@@ -86,1 +88,1 @@\n-            addRawProperties(Map.entry(\"linux-shortcut\", \"\" + menu));\n+            addRawProperties(Map.entry(\"linux-shortcut\", \"\" + shortcut));\n@@ -89,1 +91,1 @@\n-            addRawProperties(Map.entry(\"win-shortcut\", \"\" + desktop));\n+            addRawProperties(Map.entry(\"win-shortcut\", \"\" + shortcut));\n@@ -191,1 +193,1 @@\n-                withLinuxDesktopFile = true;\n+                withLinuxDesktopFile = Boolean.FALSE != withShortcut;\n@@ -199,1 +201,1 @@\n-                withLinuxDesktopFile = true;\n+                withLinuxDesktopFile = Boolean.FALSE != withShortcut;\n@@ -210,2 +212,2 @@\n-                withLinuxDesktopFile = Stream.of(\"--linux-shortcut\").anyMatch(\n-                        cmd::hasArgument);\n+                withLinuxDesktopFile = (Boolean.FALSE != withShortcut) &&\n+                        Stream.of(\"--linux-shortcut\").anyMatch(cmd::hasArgument);\n@@ -225,0 +227,12 @@\n+    private void verifyShortcuts(JPackageCommand cmd) throws IOException {\n+        if (TKit.isLinux() && !cmd.isImagePackageType()\n+                && withShortcut != null) {\n+            Path desktopFile = LinuxHelper.getDesktopFile(cmd, name);\n+            if (withShortcut) {\n+                TKit.assertFileExists(desktopFile);\n+            } else {\n+                TKit.assertPathExists(desktopFile, false);\n+            }\n+        }\n+    }\n+\n@@ -227,0 +241,1 @@\n+        verifyShortcuts(cmd);\n@@ -253,0 +268,2 @@\n+    private Boolean withMenuShortcut;\n+    private Boolean withShortcut;\n","filename":"test\/jdk\/tools\/jpackage\/helpers\/jdk\/jpackage\/test\/AdditionalLauncher.java","additions":24,"deletions":7,"binary":false,"changes":31,"status":"modified"}]}