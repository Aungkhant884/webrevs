{"files":[{"patch":"@@ -4043,1 +4043,1 @@\n-        int primaryPos = defs.first().pos;\n+        int primaryPos = getStartPos(defs.first());\n@@ -4054,1 +4054,1 @@\n-        JCModifiers unnamedMods = F.at(primaryPos)\n+        JCModifiers unnamedMods = F.at(Position.NOPOS)\n","filename":"src\/jdk.compiler\/share\/classes\/com\/sun\/tools\/javac\/parser\/JavacParser.java","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -26,1 +26,1 @@\n- * @bug 7073631 7159445 7156633 8028235 8065753 8205418 8205913 8228451 8237041 8253584 8246774 8256411 8256149 8259050 8266436 8267221 8271928 8275097 8293897 8295401 8304671\n+ * @bug 7073631 7159445 7156633 8028235 8065753 8205418 8205913 8228451 8237041 8253584 8246774 8256411 8256149 8259050 8266436 8267221 8271928 8275097 8293897 8295401 8304671 8310326\n@@ -2398,0 +2398,25 @@\n+    @Test \/\/JDK-8310326\n+    void testUnnamedClassPositions() throws IOException {\n+        String code = \"\"\"\n+                      void main() {\n+                      }\n+                      \"\"\";\n+        DiagnosticCollector<JavaFileObject> coll =\n+                new DiagnosticCollector<>();\n+        JavacTaskImpl ct = (JavacTaskImpl) tool.getTask(null, fm, coll, List.of(\"--enable-preview\", \"--source\", System.getProperty(\"java.specification.version\")),\n+                null, Arrays.asList(new MyFileObject(code)));\n+        Trees trees = Trees.instance(ct);\n+        SourcePositions sp = trees.getSourcePositions();\n+        CompilationUnitTree cut = ct.parse().iterator().next();\n+        new TreeScanner<Void, Void>() {\n+            @Override\n+            public Void visitClass(ClassTree node, Void p) {\n+                assertEquals(\"Wrong start position\", 0, sp.getStartPosition(cut, node));\n+                assertEquals(\"Wrong end position\", -1, sp.getEndPosition(cut, node));\n+                assertEquals(\"Wrong modifiers start position\", -1, sp.getStartPosition(cut, node.getModifiers()));\n+                assertEquals(\"Wrong modifiers end position\", -1, sp.getEndPosition(cut, node.getModifiers()));\n+                return super.visitClass(node, p);\n+            }\n+        }.scan(cut, null);\n+    }\n+\n","filename":"test\/langtools\/tools\/javac\/parser\/JavacParserTest.java","additions":26,"deletions":1,"binary":false,"changes":27,"status":"modified"}]}