{"files":[{"patch":"@@ -66,0 +66,9 @@\n++ (void)setPipelineState:(id <MTLRenderCommandEncoder>)encoder\n+                 context:(MTLContext *)mtlc\n+           renderOptions:(const RenderOptions *)renderOptions\n+    pipelineStateStorage:(MTLPipelineStatesStorage *)pipelineStateStorage\n+                  rpDesc:(MTLRenderPipelineDescriptor *)rpDesc\n+              vertShader:(NSString *)vertShader\n+              fragShader:(NSString *)fragShader\n+                   color:(jint)color;\n+\n@@ -67,0 +76,1 @@\n+\n","filename":"src\/java.desktop\/macosx\/native\/libawt_lwawt\/java2d\/metal\/MTLPaints.h","additions":10,"deletions":0,"binary":false,"changes":10,"status":"modified"},{"patch":"@@ -144,0 +144,21 @@\n++ (void)setPipelineState:(id <MTLRenderCommandEncoder>)encoder\n+                 context:(MTLContext *)mtlc\n+           renderOptions:(const RenderOptions *)renderOptions\n+    pipelineStateStorage:(MTLPipelineStatesStorage *)pipelineStateStorage\n+                  rpDesc:(MTLRenderPipelineDescriptor *)rpDesc\n+              vertShader:(NSString *)vertShader\n+              fragShader:(NSString *)fragShader\n+                   color:(jint)color {\n+\n+    struct FrameUniforms uf = {RGBA_TO_V4(color)};\n+    [encoder setVertexBytes:&uf length:sizeof(uf) atIndex:FrameUniformBuffer];\n+\n+    id <MTLRenderPipelineState> pipelineState = [pipelineStateStorage getPipelineState:rpDesc\n+                                                                        vertexShaderId:vertShader\n+                                                                      fragmentShaderId:fragShader\n+                                                                             composite:mtlc.composite\n+                                                                         renderOptions:renderOptions\n+                                                                         stencilNeeded:[mtlc.clip isShape]];\n+    [encoder setRenderPipelineState:pipelineState];\n+}\n+\n@@ -220,10 +241,8 @@\n-    struct FrameUniforms uf = {RGBA_TO_V4(_color)};\n-    [encoder setVertexBytes:&uf length:sizeof(uf) atIndex:FrameUniformBuffer];\n-\n-    id <MTLRenderPipelineState> pipelineState = [pipelineStateStorage getPipelineState:rpDesc\n-                                                                        vertexShaderId:vertShader\n-                                                                      fragmentShaderId:fragShader\n-                                                                             composite:mtlc.composite\n-                                                                         renderOptions:renderOptions\n-                                                                         stencilNeeded:[mtlc.clip isShape]];\n-    [encoder setRenderPipelineState:pipelineState];\n+    [MTLColorPaint setPipelineState:encoder\n+                            context:mtlc\n+                      renderOptions:renderOptions\n+               pipelineStateStorage:pipelineStateStorage\n+                             rpDesc:rpDesc\n+                         vertShader:vertShader\n+                         fragShader:fragShader\n+                              color:_color];\n@@ -951,0 +970,10 @@\n+    } else {\n+      \/\/ Fallback to valid pipeline state\n+      [MTLColorPaint setPipelineState:encoder\n+                            context:mtlc\n+                      renderOptions:renderOptions\n+               pipelineStateStorage:pipelineStateStorage\n+                             rpDesc:[[templateRenderPipelineDesc copy] autorelease]\n+                         vertShader:@\"vert_col\"\n+                         fragShader:@\"frag_col\"\n+                              color:0];\n@@ -990,0 +1019,10 @@\n+    } else {\n+      \/\/ Fallback to valid pipeline state\n+      [MTLColorPaint setPipelineState:encoder\n+                            context:mtlc\n+                      renderOptions:renderOptions\n+               pipelineStateStorage:pipelineStateStorage\n+                             rpDesc:[[templateRenderPipelineDesc copy] autorelease]\n+                         vertShader:@\"vert_col\"\n+                         fragShader:@\"frag_col\"\n+                              color:0];\n","filename":"src\/java.desktop\/macosx\/native\/libawt_lwawt\/java2d\/metal\/MTLPaints.m","additions":49,"deletions":10,"binary":false,"changes":59,"status":"modified"}]}