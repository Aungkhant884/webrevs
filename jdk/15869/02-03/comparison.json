{"files":[{"patch":"@@ -1559,1 +1559,0 @@\n-  \/\/ Returns the number of Java frames in this thread stack\n@@ -1579,1 +1578,1 @@\n-  bool stopAtVthreadEntry = _thread_type == ThreadType::MountedVirtual;\n+  bool stop_at_vthread_entry = _thread_type == ThreadType::MountedVirtual;\n@@ -1587,1 +1586,1 @@\n-    if (stopAtVthreadEntry && vf->is_vthread_entry()) {\n+    if (stop_at_vthread_entry && vf->is_vthread_entry()) {\n@@ -2034,1 +2033,1 @@\n-  void dump_platform_threads();\n+  void dump_threads();\n@@ -2045,1 +2044,1 @@\n-  void dump_platform_stack_traces();\n+  void dump_stack_traces();\n@@ -2157,1 +2156,1 @@\n-void VM_HeapDumper::dump_platform_threads() {\n+void VM_HeapDumper::dump_threads() {\n@@ -2304,1 +2303,1 @@\n-    dump_platform_stack_traces();\n+    dump_stack_traces();\n@@ -2315,1 +2314,1 @@\n-    dump_platform_threads();\n+    dump_threads();\n@@ -2369,1 +2368,1 @@\n-void VM_HeapDumper::dump_platform_stack_traces() {\n+void VM_HeapDumper::dump_stack_traces() {\n","filename":"src\/hotspot\/share\/services\/heapDumper.cpp","additions":8,"deletions":9,"binary":false,"changes":17,"status":"modified"},{"patch":"@@ -27,0 +27,1 @@\n+import java.util.Arrays;\n@@ -47,1 +48,3 @@\n- * @test\n+ * @test id=default\n+ * @requires vm.jvmti\n+ * @requires vm.continuations\n@@ -49,3 +52,10 @@\n- * @run main\/othervm\n- *      -Djdk.virtualThreadScheduler.parallelism=1\n- *      VThreadInHeapDump\n+ * @run main VThreadInHeapDump\n+ *\/\n+\n+\/**\n+ * @test id=no-vmcontinuations\n+ * @requires vm.jvmti\n+ * @library \/test\/lib\n+ * @comment pass extra VM arguments as the test arguments\n+ * @run main VThreadInHeapDump\n+ *           -XX:+UnlockExperimentalVMOptions -XX:-VMContinuations\n@@ -162,0 +172,1 @@\n+    \/\/ test arguments are extra VM options for target process\n@@ -164,1 +175,1 @@\n-        createDump(dumpFile);\n+        createDump(dumpFile, args);\n@@ -168,1 +179,1 @@\n-    private static void createDump(File dumpFile) throws Exception {\n+    private static void createDump(File dumpFile, String[] extraOptions) throws Exception {\n@@ -173,1 +184,4 @@\n-            LingeredApp.startApp(theApp, \"-Djdk.virtualThreadScheduler.parallelism=1\");\n+            List<String> extraVMArgs = new ArrayList<>();\n+            extraVMArgs.add(\"-Djdk.virtualThreadScheduler.parallelism=1\");\n+            extraVMArgs.addAll(Arrays.asList(extraOptions));\n+            LingeredApp.startApp(theApp, extraVMArgs.toArray(new String[0]));\n","filename":"test\/hotspot\/jtreg\/serviceability\/jvmti\/vthread\/HeapDump\/VThreadInHeapDump.java","additions":21,"deletions":7,"binary":false,"changes":28,"status":"modified"}]}