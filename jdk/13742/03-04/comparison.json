{"files":[{"patch":"@@ -375,1 +375,1 @@\n-            } else if (conContext.isHandshakeFinished()) {\n+            } else if (conContext.handshakeContext.handshakeFinished) {\n@@ -763,1 +763,0 @@\n-        HandshakeContext context = conContext.handshakeContext;\n@@ -765,4 +764,4 @@\n-            if (context != null && \/\/ PRE or POST handshake\n-                    !context.taskDelegated &&\n-                    !context.delegatedActions.isEmpty()) {\n-                context.taskDelegated = true;\n+            if (conContext.handshakeContext != null && \/\/ PRE or POST handshake\n+                    !conContext.handshakeContext.taskDelegated &&\n+                    !conContext.handshakeContext.delegatedActions.isEmpty()) {\n+                conContext.handshakeContext.taskDelegated = true;\n@@ -915,1 +914,7 @@\n-        return conContext.getHandshakeSession();\n+        engineLock.lock();\n+        try {\n+            return conContext.handshakeContext == null ?\n+                    null : conContext.handshakeContext.handshakeSession;\n+        } finally {\n+            engineLock.unlock();\n+        }\n@@ -1051,1 +1056,7 @@\n-        return conContext.getHandshakeApplicationProtocol();\n+        engineLock.lock();\n+        try {\n+            return conContext.handshakeContext == null ?\n+                    null : conContext.handshakeContext.applicationProtocol;\n+        } finally {\n+            engineLock.unlock();\n+        }\n","filename":"src\/java.base\/share\/classes\/sun\/security\/ssl\/SSLEngineImpl.java","additions":19,"deletions":8,"binary":false,"changes":27,"status":"modified"}]}