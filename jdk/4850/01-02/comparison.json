{"files":[{"patch":"@@ -24,1 +24,1 @@\n-\/**\n+\/*\n@@ -33,1 +33,0 @@\n-import java.awt.Panel;\n@@ -36,2 +35,0 @@\n-import java.util.concurrent.CountDownLatch;\n-import java.util.concurrent.TimeUnit;\n@@ -41,6 +38,1 @@\n-    private static final Frame instructionFrame = new Frame();\n-    private static volatile boolean testResult;\n-    private static volatile CountDownLatch countDownLatch;\n-\n-    private static void createInstructionUI() {\n-\n+    private static Frame createInstructionUI() {\n@@ -48,4 +40,7 @@\n-                This test assumes and requires that you have a printer installed\n-                When the dialog appears, increment the number of copies then\n-                press OK\/Print.The test will throw an exception if you fail\n-                to do this, since,it cannot distinguish that from a failure.\"\"\";\n+                This test requires that you have a printer. In case if the test\n+                system has a virtual printers such as Microsoft Print to PDF or\n+                Microsoft XPS Document Writer is installed. Press Cancel\n+                button since neither Microsoft Print to PDF or Microsoft XPS\n+                Document Writer does not allow setting copies to anything but 1.\n+                If printer is installed then PrintDialog is visible increase the\n+                number of copies and press OK\/Cancel button.\"\"\";\n@@ -53,3 +48,1 @@\n-        Panel mainControlPanel = new Panel(new BorderLayout());\n-        TextArea instructionTextArea = new TextArea();\n-        instructionTextArea.setText(instruction);\n+        TextArea instructionTextArea = new TextArea(instruction);\n@@ -57,2 +50,3 @@\n-        mainControlPanel.add(instructionTextArea, BorderLayout.CENTER);\n-        instructionFrame.add(mainControlPanel);\n+\n+        Frame instructionFrame = new Frame();\n+        instructionFrame.add(instructionTextArea, BorderLayout.CENTER);\n@@ -60,0 +54,1 @@\n+        instructionFrame.setLocationRelativeTo(null);\n@@ -61,0 +56,1 @@\n+        return instructionFrame;\n@@ -66,4 +62,2 @@\n-            System.out.println(\"Looks like printer is not configured. Please install printer and \" +\n-                    \"re-run the test case.\");\n-            testResult = false;\n-            countDownLatch.countDown();\n+            System.out.println(\"Looks like printer is not configured. Please install printer \" +\n+                    \" and re-run the test case.\");\n@@ -78,0 +72,6 @@\n+            int copies = job.getCopies();\n+            if (copies <= 1) {\n+                throw new RuntimeException(\"Expected the number of copies to be more than 1 but got \" + copies);\n+            } else {\n+                System.out.println(\"Total number of copies : \" + copies);\n+            }\n@@ -79,1 +79,1 @@\n-            System.out.println(\"User has selected Cancel button on the PrintDialog\");\n+            System.out.println(\"User has selected Cancel button on the PrintDialog.\");\n@@ -81,10 +81,0 @@\n-        int copies = job.getCopies();\n-        if (copies <= 1) {\n-            testResult = false;\n-            System.out.println(\"Expected the number of copies to be more than 1 but got \" + copies);\n-        } else {\n-            testResult = true;\n-            System.out.println(\"Total number of copies : \" + copies);\n-        }\n-        countDownLatch.countDown();\n-        instructionFrame.dispose();\n@@ -94,8 +84,5 @@\n-        countDownLatch = new CountDownLatch(1);\n-        createInstructionUI();\n-        showPrintDialog();\n-        if (!countDownLatch.await(5, TimeUnit.MINUTES)) {\n-            throw new RuntimeException(\"Timeout : No action was performed on the test UI.\");\n-        }\n-        if (!testResult) {\n-            throw new RuntimeException(\"Test failed!\");\n+        Frame frame = createInstructionUI();\n+        try {\n+            showPrintDialog();\n+        } finally {\n+            frame.dispose();\n@@ -105,1 +92,0 @@\n-\n","filename":"test\/jdk\/java\/awt\/print\/Dialog\/DialogCopies.java","additions":29,"deletions":43,"binary":false,"changes":72,"status":"modified"}]}