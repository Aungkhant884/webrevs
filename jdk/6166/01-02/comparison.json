{"files":[{"patch":"@@ -192,0 +192,4 @@\n+  \/\/ Returns if BOT updates are needed for the given destinaion. Currently we only have\n+  \/\/ two destinations and BOT updates are only needed for the old generation.\n+  inline bool needs_bot_update(G1HeapRegionAttr dest) const;\n+\n@@ -221,1 +225,1 @@\n-  inline void update_bot_for_allocation(G1HeapRegionAttr dest, size_t word_sz, uint node_index);\n+  inline void update_bot_for_plab_allocation(G1HeapRegionAttr dest, size_t word_sz, uint node_index);\n","filename":"src\/hotspot\/share\/gc\/g1\/g1Allocator.hpp","additions":5,"deletions":1,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -136,0 +136,4 @@\n+inline bool G1PLABAllocator::needs_bot_update(G1HeapRegionAttr dest) const {\n+  return dest.is_old();\n+}\n+\n@@ -137,2 +141,1 @@\n-  if (!attr.needs_bot_update()) {\n-    \/\/ BOT updates are only done for old generation.\n+  if (!needs_bot_update(attr)) {\n@@ -147,2 +150,2 @@\n-inline void G1PLABAllocator::update_bot_for_allocation(G1HeapRegionAttr dest, size_t word_sz, uint node_index) {\n-  assert(dest.needs_bot_update(), \"Wrong destination: %s\", dest.get_type_str());\n+inline void G1PLABAllocator::update_bot_for_plab_allocation(G1HeapRegionAttr dest, size_t word_sz, uint node_index) {\n+  assert(needs_bot_update(dest), \"Wrong destination: %s\", dest.get_type_str());\n","filename":"src\/hotspot\/share\/gc\/g1\/g1Allocator.inline.hpp","additions":7,"deletions":4,"binary":false,"changes":11,"status":"modified"},{"patch":"@@ -106,1 +106,0 @@\n-  bool needs_bot_update() const        { return is_old(); }\n","filename":"src\/hotspot\/share\/gc\/g1\/g1HeapRegionAttr.hpp","additions":0,"deletions":1,"binary":false,"changes":1,"status":"modified"},{"patch":"@@ -502,2 +502,4 @@\n-      \/\/ Currently we only have two destinations we only skip BOT updates for young.\n-      _plab_allocator->update_bot_for_allocation(dest_attr, word_sz, node_index);\n+      \/\/ Currently we only have two destinations and we only need BOT updates for\n+      \/\/ old. If the current allocation was done outside the PLAB this call will\n+      \/\/ have no effect since the _top of the PLAB has not changed.\n+      _plab_allocator->update_bot_for_plab_allocation(dest_attr, word_sz, node_index);\n","filename":"src\/hotspot\/share\/gc\/g1\/g1ParScanThreadState.cpp","additions":4,"deletions":2,"binary":false,"changes":6,"status":"modified"}]}