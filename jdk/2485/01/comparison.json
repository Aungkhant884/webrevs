{"files":[{"patch":"@@ -3290,2 +3290,2 @@\n-    vfst.skip_reflection_related_frames(); \/\/ Only needed for 1.4 reflection\n-    oop loader = vfst.method()->method_holder()->class_loader();\n+    InstanceKlass* ik = vfst.method()->method_holder();\n+    oop loader = ik->class_loader();\n@@ -3293,1 +3293,5 @@\n-      return JNIHandles::make_local(THREAD, loader);\n+      \/\/ Skip reflection related frames\n+      if (!ik->is_subclass_of(vmClasses::reflect_MethodAccessorImpl_klass()) &&\n+          !ik->is_subclass_of(vmClasses::reflect_ConstructorAccessorImpl_klass())) {\n+        return JNIHandles::make_local(THREAD, loader);\n+      }\n","filename":"src\/hotspot\/share\/prims\/jvm.cpp","additions":7,"deletions":3,"binary":false,"changes":10,"status":"modified"},{"patch":"@@ -565,9 +565,0 @@\n-\n-void vframeStreamCommon::skip_reflection_related_frames() {\n-  while (!at_end() &&\n-          (method()->method_holder()->is_subclass_of(vmClasses::reflect_MethodAccessorImpl_klass()) ||\n-           method()->method_holder()->is_subclass_of(vmClasses::reflect_ConstructorAccessorImpl_klass()))) {\n-    next();\n-  }\n-}\n-\n","filename":"src\/hotspot\/share\/runtime\/vframe.cpp","additions":0,"deletions":9,"binary":false,"changes":9,"status":"modified"},{"patch":"@@ -331,4 +331,0 @@\n-\n-  \/\/ Helper routine for JVM_LatestUserDefinedLoader -- needed for 1.4\n-  \/\/ reflection implementation\n-  void skip_reflection_related_frames();\n","filename":"src\/hotspot\/share\/runtime\/vframe.hpp","additions":0,"deletions":4,"binary":false,"changes":4,"status":"modified"}]}