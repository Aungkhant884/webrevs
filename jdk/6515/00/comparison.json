{"files":[{"patch":"@@ -166,1 +166,0 @@\n-vmTestbase\/nsk\/jvmti\/SuspendThread\/suspendthrd003\/TestDescription.java 8264605 generic-all\n","filename":"test\/hotspot\/jtreg\/ProblemList.txt","additions":0,"deletions":1,"binary":false,"changes":1,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2003, 2018, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2003, 2021, Oracle and\/or its affiliates. All rights reserved.\n@@ -141,8 +141,0 @@\n-\/* ============================================================================= *\/\n-static void set_agent_thread_state(thread_state_t value) {\n-    rawMonitorEnter(jvmti_env, agent_data.monitor);\n-    agent_data.thread_state = value;\n-    rawMonitorNotify(jvmti_env, agent_data.monitor);\n-    rawMonitorExit(jvmti_env, agent_data.monitor);\n-}\n-\n@@ -154,3 +146,4 @@\n-    \/* run user agent proc *\/\n-    {\n-        set_agent_thread_state(RUNNABLE);\n+    rawMonitorEnter(jvmti_env, agent_data.monitor);\n+    agent_data.thread_state = RUNNABLE;\n+    rawMonitorNotify(jvmti_env, agent_data.monitor);\n+    rawMonitorExit(jvmti_env, agent_data.monitor);\n@@ -158,1 +151,1 @@\n-        NSK_TRACE((*agentThreadProc)(jvmti_env, agentJNI, agentThreadArg));\n+    NSK_TRACE((*agentThreadProc)(jvmti_env, agentJNI, agentThreadArg));\n@@ -160,2 +153,6 @@\n-        set_agent_thread_state(TERMINATED);\n-    }\n+    rawMonitorEnter(jvmti_env, agent_data.monitor);\n+    agent_data.thread_state = TERMINATED;\n+    agentJNI->DeleteGlobalRef(agentThread);\n+    agentThread = NULL;\n+    rawMonitorNotify(jvmti_env, agent_data.monitor);\n+    rawMonitorExit(jvmti_env, agent_data.monitor);\n@@ -163,6 +160,0 @@\n-    \/* finalize agent thread *\/\n-    {\n-        \/* gelete global ref for agent thread *\/\n-        agentJNI->DeleteGlobalRef(agentThread);\n-        agentThread = NULL;\n-    }\n","filename":"test\/hotspot\/jtreg\/vmTestbase\/nsk\/share\/jvmti\/agent_tools.cpp","additions":12,"deletions":21,"binary":false,"changes":33,"status":"modified"}]}