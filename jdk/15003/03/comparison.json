{"files":[{"patch":"@@ -456,1 +456,1 @@\n-#ifdef COMPILER2\n+#if COMPILER2_OR_JVMCI\n@@ -476,1 +476,1 @@\n-#endif \/\/ COMPILER2\n+#endif \/\/ COMPILER2_OR_JVMCI\n","filename":"src\/hotspot\/share\/classfile\/modules.cpp","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -399,1 +399,2 @@\n-    case REGISTER_OOP: {\n+    case REGISTER_OOP:\n+    case REGISTER_VECTOR: {\n@@ -425,0 +426,2 @@\n+        } else if (type == T_OBJECT && tag == REGISTER_VECTOR) {\n+          locationType = Location::vector;\n@@ -437,1 +440,2 @@\n-    case STACK_SLOT_OOP: {\n+    case STACK_SLOT_OOP:\n+    case STACK_SLOT_VECTOR: {\n@@ -444,1 +448,1 @@\n-        locationType = tag == STACK_SLOT_NARROW_OOP ? Location::narrowoop : Location::oop;\n+        locationType = tag == STACK_SLOT_VECTOR ? Location::vector : tag == STACK_SLOT_NARROW_OOP ? Location::narrowoop : Location::oop;\n","filename":"src\/hotspot\/share\/jvmci\/jvmciCodeInstaller.cpp","additions":7,"deletions":3,"binary":false,"changes":10,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2011, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2011, 2023, Oracle and\/or its affiliates. All rights reserved.\n@@ -188,0 +188,1 @@\n+    REGISTER_VECTOR,\n@@ -191,0 +192,1 @@\n+    STACK_SLOT_VECTOR,\n","filename":"src\/hotspot\/share\/jvmci\/jvmciCodeInstaller.hpp","additions":3,"deletions":1,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -533,0 +533,1 @@\n+  declare_constant(CodeInstaller::REGISTER_VECTOR)                        \\\n@@ -536,0 +537,1 @@\n+  declare_constant(CodeInstaller::STACK_SLOT_VECTOR)                      \\\n","filename":"src\/hotspot\/share\/jvmci\/vmStructs_jvmci.cpp","additions":2,"deletions":0,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -4044,1 +4044,1 @@\n-#ifdef COMPILER2\n+#if COMPILER2_OR_JVMCI\n@@ -4065,1 +4065,1 @@\n-#endif \/\/ COMPILER2\n+#endif \/\/ COMPILER2_OR_JVMCI\n","filename":"src\/hotspot\/share\/runtime\/arguments.cpp","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -1238,1 +1238,1 @@\n-#ifdef COMPILER2\n+#if COMPILER2_OR_JVMCI\n@@ -1246,1 +1246,1 @@\n-#endif \/\/ COMPILER2\n+#endif \/\/ COMPILER2_OR_JVMCI\n@@ -1588,1 +1588,1 @@\n-#ifdef COMPILER2\n+#if COMPILER2_OR_JVMCI\n@@ -1608,1 +1608,1 @@\n-#endif \/* !COMPILER2 *\/\n+#endif \/* !COMPILER2_OR_JVMCI *\/\n","filename":"src\/hotspot\/share\/runtime\/deoptimization.cpp","additions":4,"deletions":4,"binary":false,"changes":8,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2022, 2023, Oracle and\/or its affiliates. All rights reserved.\n@@ -51,0 +51,1 @@\n+import static jdk.vm.ci.hotspot.HotSpotCompiledCodeStream.Tag.REGISTER_VECTOR;\n@@ -64,0 +65,1 @@\n+import static jdk.vm.ci.hotspot.HotSpotCompiledCodeStream.Tag.STACK_SLOT_VECTOR;\n@@ -174,0 +176,1 @@\n+        REGISTER_VECTOR,\n@@ -177,0 +180,1 @@\n+        STACK_SLOT_VECTOR,\n@@ -1032,0 +1036,4 @@\n+    private boolean isVector(Value value) {\n+        return value.getPlatformKind().getVectorLength() > 1;\n+    }\n+\n@@ -1042,1 +1050,10 @@\n-            Tag tag = kind == JavaKind.Object ? (isNarrowOop(reg) ? REGISTER_NARROW_OOP : REGISTER_OOP) : REGISTER_PRIMITIVE;\n+            Tag tag;\n+            if (kind == JavaKind.Object) {\n+                if (isVector(reg)) {\n+                    tag = REGISTER_VECTOR;\n+                } else {\n+                    tag = isNarrowOop(reg) ? REGISTER_NARROW_OOP : REGISTER_OOP;\n+                }\n+            } else {\n+                tag = REGISTER_PRIMITIVE;\n+            }\n@@ -1047,1 +1064,10 @@\n-            Tag tag = kind == JavaKind.Object ? (isNarrowOop(slot) ? STACK_SLOT_NARROW_OOP : STACK_SLOT_OOP) : STACK_SLOT_PRIMITIVE;\n+            Tag tag;\n+            if (kind == JavaKind.Object) {\n+                if (isVector(slot)) {\n+                    tag = STACK_SLOT_VECTOR;\n+                } else {\n+                    tag = isNarrowOop(slot) ? STACK_SLOT_NARROW_OOP : STACK_SLOT_OOP;\n+                }\n+            } else {\n+                tag = STACK_SLOT_PRIMITIVE;\n+            }\n","filename":"src\/jdk.internal.vm.ci\/share\/classes\/jdk\/vm\/ci\/hotspot\/HotSpotCompiledCodeStream.java","additions":29,"deletions":3,"binary":false,"changes":32,"status":"modified"}]}