{"files":[{"patch":"@@ -231,4 +231,10 @@\n-    if (!FLAG_IS_DEFAULT(SharedArchiveFile)) {\n-      base_archive_name_size = strlen(Arguments::GetSharedArchivePath()) + 1;\n-      header_size += base_archive_name_size;\n-      base_archive_path_offset = c_header_size;\n+    if (SharedArchiveFile != nullptr) {\n+      \/\/ -XX:SharedArchiveFile=<file> or <base>:<top>\n+      char* def_base_archive = Arguments::get_default_shared_archive_path();\n+      if (strcmp(def_base_archive, Arguments::GetSharedArchivePath()) != 0) {\n+        base_archive_name_size = strlen(Arguments::GetSharedArchivePath()) + 1;\n+        header_size += base_archive_name_size;\n+        base_archive_path_offset = c_header_size;\n+      }\n+      \/\/ Arguments::get_default_shared_archive_path creates buffer, needs release\n+      FREE_C_HEAP_ARRAY(char, def_base_archive);\n","filename":"src\/hotspot\/share\/cds\/filemap.cpp","additions":10,"deletions":4,"binary":false,"changes":14,"status":"modified"}]}