{"files":[{"patch":"@@ -39,1 +39,0 @@\n-import java.nio.file.FileSystems;\n@@ -44,1 +43,0 @@\n-import java.util.Collections;\n@@ -50,1 +48,0 @@\n-import java.util.stream.StreamSupport;\n@@ -79,0 +76,10 @@\n+    public void assertCompletion(boolean after, String code, int minElements) {\n+        if (!after) {\n+            setCommandInput(\"\\n\");\n+        } else {\n+            List<String> completions = computeCompletions(code, false);\n+            assertTrue(completions.size() >= minElements, \"Command: \" + code + \", output: \" +\n+                    completions.toString() + \", expected output with at least \" + minElements + \" elements\");\n+        }\n+    }\n+\n@@ -276,3 +283,0 @@\n-        List<String> p1 = listFiles(Paths.get(\"\"));\n-        getRootDirectories().forEach(s -> p1.add(s.toString()));\n-        Collections.sort(p1);\n@@ -280,1 +284,1 @@\n-                a -> assertCompletion(a, \"\/open |\", false, p1.toArray(new String[p1.size()]))\n+                a -> assertCompletion(a, \"\/open |\", 1)\n@@ -283,1 +287,0 @@\n-        List<String> p2 = listFiles(classDir);\n@@ -285,1 +288,1 @@\n-                a -> assertCompletion(a, \"\/open \" + classDir + \"\/|\", false, p2.toArray(new String[p2.size()]))\n+                a -> assertCompletion(a, \"\/open \" + classDir + \"\/|\", 1)\n@@ -295,4 +298,0 @@\n-        List<String> p1 = listFiles(Paths.get(\"\"));\n-        Collections.addAll(p1, \"-all \", \"-history \", \"-start \");\n-        getRootDirectories().forEach(s -> p1.add(s.toString()));\n-        Collections.sort(p1);\n@@ -300,1 +299,1 @@\n-                a -> assertCompletion(a, \"\/save |\", false, p1.toArray(new String[p1.size()]))\n+                a -> assertCompletion(a, \"\/save |\", 4)\n@@ -303,1 +302,0 @@\n-        List<String> p2 = listFiles(classDir);\n@@ -305,4 +303,2 @@\n-                a -> assertCompletion(a, \"\/save \" + classDir + \"\/|\",\n-                false, p2.toArray(new String[p2.size()])),\n-                a -> assertCompletion(a, \"\/save -all \" + classDir + \"\/|\",\n-                false, p2.toArray(new String[p2.size()]))\n+                a -> assertCompletion(a, \"\/save \" + classDir + \"\/|\", 1),\n+                a -> assertCompletion(a, \"\/save -all \" + classDir + \"\/|\", 1)\n@@ -380,3 +376,0 @@\n-        List<String> p1 = listFiles(Paths.get(\"\"));\n-        getRootDirectories().forEach(s -> p1.add(s.toString()));\n-        Collections.sort(p1);\n@@ -393,1 +386,1 @@\n-                a -> assertCompletion(a, \"\/set editor |\", false, p1.toArray(new String[p1.size()])),\n+                a -> assertCompletion(a, \"\/set editor |\", 1),\n@@ -417,1 +410,1 @@\n-                a -> assertCompletion(a, \"\/set st |\", false, p1.toArray(new String[p1.size()])),\n+                a -> assertCompletion(a, \"\/set st |\", 1),\n@@ -451,9 +444,0 @@\n-    private static Iterable<? extends Path> getRootDirectories() {\n-        return StreamSupport.stream(FileSystems.getDefault()\n-                                               .getRootDirectories()\n-                                               .spliterator(),\n-                                    false)\n-                            .filter(p -> Files.exists(p))\n-                            .distinct()\n-                            .collect(Collectors.toList());\n-    }\n","filename":"test\/langtools\/jdk\/jshell\/CommandCompletionTest.java","additions":17,"deletions":33,"binary":false,"changes":50,"status":"modified"}]}