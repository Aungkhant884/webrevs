{"files":[{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2018, 2020, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2018, 2021, Oracle and\/or its affiliates. All rights reserved.\n@@ -429,15 +429,0 @@\n-\/\/ Walk classes in the loaded class dictionaries in various forms.\n-\/\/ Only walks the classes defined in this class loader.\n-void ClassLoaderDataGraph::dictionary_classes_do(void f(InstanceKlass*)) {\n-  FOR_ALL_DICTIONARY(cld) {\n-    cld->dictionary()->classes_do(f);\n-  }\n-}\n-\n-\/\/ Only walks the classes defined in this class loader.\n-void ClassLoaderDataGraph::dictionary_classes_do(void f(InstanceKlass*, TRAPS), TRAPS) {\n-  FOR_ALL_DICTIONARY(cld) {\n-    cld->dictionary()->classes_do(f, CHECK);\n-  }\n-}\n-\n","filename":"src\/hotspot\/share\/classfile\/classLoaderDataGraph.cpp","additions":1,"deletions":16,"binary":false,"changes":17,"status":"modified"},{"patch":"@@ -99,7 +99,0 @@\n-  \/\/ dictionary do\n-  \/\/ Iterate over all klasses in dictionary, but\n-  \/\/ just the classes from defining class loaders.\n-  static void dictionary_classes_do(void f(InstanceKlass*));\n-  \/\/ Added for initialize_itable_for_klass to handle exceptions.\n-  static void dictionary_classes_do(void f(InstanceKlass*, TRAPS), TRAPS);\n-\n","filename":"src\/hotspot\/share\/classfile\/classLoaderDataGraph.hpp","additions":0,"deletions":7,"binary":false,"changes":7,"status":"modified"},{"patch":"@@ -526,0 +526,1 @@\n+static void reinitialize_itables() {\n@@ -527,4 +528,8 @@\n-static void initialize_itable_for_klass(InstanceKlass* k) {\n-  k->itable().initialize_itable();\n-}\n-\n+  class ReinitTableClosure : public KlassClosure {\n+   public:\n+    void do_klass(Klass* k) {\n+      if (k->is_instance_klass()) {\n+         InstanceKlass::cast(k)->itable().initialize_itable();\n+      }\n+    }\n+  };\n@@ -532,1 +537,0 @@\n-static void reinitialize_itables() {\n@@ -534,1 +538,2 @@\n-  ClassLoaderDataGraph::dictionary_classes_do(initialize_itable_for_klass);\n+  ReinitTableClosure cl;\n+  ClassLoaderDataGraph::classes_do(&cl);\n","filename":"src\/hotspot\/share\/memory\/universe.cpp","additions":11,"deletions":6,"binary":false,"changes":17,"status":"modified"}]}