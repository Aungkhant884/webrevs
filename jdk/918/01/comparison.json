{"files":[{"patch":"@@ -28,0 +28,1 @@\n+import org.openjdk.jmh.annotations.Param;\n@@ -30,0 +31,1 @@\n+import org.openjdk.jmh.annotations.Setup;\n@@ -32,0 +34,1 @@\n+import org.openjdk.jmh.infra.Blackhole;\n@@ -44,12 +47,31 @@\n-    private static final int loops = 100000;\n-    private static final Random rng = new Random(1999);\n-    private static final int pathCnt = 1000;\n-    private static final String [] latn1_short        = new String[pathCnt];\n-    private static final String [] latn1_sse4         = new String[pathCnt];\n-    private static final String [] latn1_avx2         = new String[pathCnt];\n-    private static final String [] latn1_mixedLength  = new String[pathCnt];\n-    private static final String [] utf16_short        = new String[pathCnt];\n-    private static final String [] utf16_sse4         = new String[pathCnt];\n-    private static final String [] utf16_avx2         = new String[pathCnt];\n-    private static final String [] utf16_mixedLength  = new String[pathCnt];\n-    static {\n+    @Param(\"100000\")\n+    private int loops;\n+\n+    @Param(\"1000\")\n+    private int pathCnt;\n+\n+    @Param(\"1999\")\n+    private int rngSeed;\n+\n+    private Random rng;\n+    private String[] latn1_short;\n+    private String[] latn1_sse4;\n+    private String[] latn1_avx2;\n+    private String[] latn1_mixedLength;\n+    private String[] utf16_short;\n+    private String[] utf16_sse4;\n+    private String[] utf16_avx2;\n+    private String[] utf16_mixedLength;\n+\n+    @Setup\n+    public void setup() {\n+        rng = new Random(rngSeed);\n+        latn1_short        = new String[pathCnt];\n+        latn1_sse4         = new String[pathCnt];\n+        latn1_avx2         = new String[pathCnt];\n+        latn1_mixedLength  = new String[pathCnt];\n+        utf16_short        = new String[pathCnt];\n+        utf16_sse4         = new String[pathCnt];\n+        utf16_avx2         = new String[pathCnt];\n+        utf16_mixedLength  = new String[pathCnt];\n+\n@@ -68,1 +90,1 @@\n-    private static String makeRndString(boolean isUtf16, int length) {\n+    private String makeRndString(boolean isUtf16, int length) {\n@@ -84,2 +106,1 @@\n-    public void latin1_mixed_char() {\n-        int ret = 0;\n+    public void latin1_mixed_char(Blackhole bh) {\n@@ -87,1 +108,1 @@\n-            ret += what.indexOf('a');\n+            bh.consume(what.indexOf('a'));\n@@ -92,2 +113,1 @@\n-    public void utf16_mixed_char() {\n-        int ret = 0;\n+    public void utf16_mixed_char(Blackhole bh) {\n@@ -95,1 +115,1 @@\n-            ret += what.indexOf('a');\n+            bh.consume(what.indexOf('a'));\n@@ -100,2 +120,1 @@\n-    public void latin1_mixed_String() {\n-        int ret = 0;\n+    public void latin1_mixed_String(Blackhole bh) {\n@@ -103,1 +122,1 @@\n-            ret += what.indexOf(\"a\");\n+            bh.consume(what.indexOf(\"a\"));\n@@ -108,2 +127,1 @@\n-    public void utf16_mixed_String() {\n-        int ret = 0;\n+    public void utf16_mixed_String(Blackhole bh) {\n@@ -111,1 +129,1 @@\n-            ret += what.indexOf(\"a\");\n+            bh.consume(what.indexOf(\"a\"));\n@@ -118,2 +136,1 @@\n-    public void latin1_Short_char() {\n-        int ret = 0;\n+    public void latin1_Short_char(Blackhole bh) {\n@@ -121,1 +138,1 @@\n-            ret += what.indexOf('a');\n+            bh.consume(what.indexOf('a'));\n@@ -126,2 +143,1 @@\n-    public void latin1_SSE4_char() {\n-        int ret = 0;\n+    public void latin1_SSE4_char(Blackhole bh) {\n@@ -129,1 +145,1 @@\n-            ret += what.indexOf('a');\n+            bh.consume(what.indexOf('a'));\n@@ -134,2 +150,1 @@\n-    public void latin1_AVX2_char() {\n-        int ret = 0;\n+    public void latin1_AVX2_char(Blackhole bh) {\n@@ -137,1 +152,1 @@\n-            ret += what.indexOf('a');\n+            bh.consume(what.indexOf('a'));\n@@ -142,2 +157,1 @@\n-    public int utf16_Short_char() {\n-        int ret = 0;\n+    public void utf16_Short_char(Blackhole bh) {\n@@ -145,1 +159,1 @@\n-            ret += what.indexOf('a');\n+            bh.consume(what.indexOf('a'));\n@@ -147,1 +161,0 @@\n-        return ret;\n@@ -151,2 +164,1 @@\n-    public int utf16_SSE4_char() {\n-        int ret = 0;\n+    public void utf16_SSE4_char(Blackhole bh) {\n@@ -154,1 +166,1 @@\n-            ret += what.indexOf('a');\n+            bh.consume(what.indexOf('a'));\n@@ -156,1 +168,0 @@\n-        return ret;\n@@ -160,2 +171,1 @@\n-    public int utf16_AVX2_char() {\n-        int ret = 0;\n+    public void utf16_AVX2_char(Blackhole bh) {\n@@ -163,1 +173,1 @@\n-            ret += what.indexOf('a');\n+            bh.consume(what.indexOf('a'));\n@@ -165,1 +175,0 @@\n-        return ret;\n@@ -169,2 +178,1 @@\n-    public int latin1_Short_String() {\n-        int ret = 0;\n+    public void latin1_Short_String(Blackhole bh) {\n@@ -172,1 +180,1 @@\n-            ret += what.indexOf(\"a\");\n+            bh.consume(what.indexOf(\"a\"));\n@@ -174,1 +182,0 @@\n-        return ret;\n@@ -178,2 +185,1 @@\n-    public int latin1_SSE4_String() {\n-        int ret = 0;\n+    public void latin1_SSE4_String(Blackhole bh) {\n@@ -181,1 +187,1 @@\n-            ret += what.indexOf(\"a\");\n+            bh.consume(what.indexOf(\"a\"));\n@@ -183,1 +189,0 @@\n-        return ret;\n@@ -187,2 +192,1 @@\n-    public int latin1_AVX2_String() {\n-        int ret = 0;\n+    public void latin1_AVX2_String(Blackhole bh) {\n@@ -190,1 +194,1 @@\n-            ret += what.indexOf(\"a\");\n+            bh.consume(what.indexOf(\"a\"));\n@@ -192,1 +196,0 @@\n-        return ret;\n@@ -196,2 +199,1 @@\n-    public int utf16_Short_String() {\n-        int ret = 0;\n+    public void utf16_Short_String(Blackhole bh) {\n@@ -199,1 +201,1 @@\n-            ret += what.indexOf(\"a\");\n+            bh.consume(what.indexOf(\"a\"));\n@@ -201,1 +203,0 @@\n-        return ret;\n@@ -205,2 +206,1 @@\n-    public int utf16_SSE4_String() {\n-        int ret = 0;\n+    public void utf16_SSE4_String(Blackhole bh) {\n@@ -208,1 +208,1 @@\n-            ret += what.indexOf(\"a\");\n+            bh.consume(what.indexOf(\"a\"));\n@@ -210,1 +210,0 @@\n-        return ret;\n@@ -214,2 +213,1 @@\n-    public int utf16_AVX2_String() {\n-        int ret = 0;\n+    public void utf16_AVX2_String(Blackhole bh) {\n@@ -217,1 +215,1 @@\n-            ret += what.indexOf(\"a\");\n+            bh.consume(what.indexOf(\"a\"));\n@@ -219,1 +217,0 @@\n-        return ret;\n","filename":"test\/micro\/org\/openjdk\/bench\/java\/lang\/StringIndexOfChar.java","additions":67,"deletions":70,"binary":false,"changes":137,"status":"modified"}]}