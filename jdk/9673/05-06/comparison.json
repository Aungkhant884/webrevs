{"files":[{"patch":"@@ -30,0 +30,2 @@\n+import java.security.AccessController;\n+import java.security.PrivilegedAction;\n@@ -80,0 +82,1 @@\n+    @SuppressWarnings(\"removal\")\n@@ -87,2 +90,12 @@\n-            BufferedImage bi = new BufferedImage(1, 1, BufferedImage.TYPE_INT_RGB);\n-            graphics = bi.createGraphics();\n+            StackWalker walker = AccessController.doPrivileged(new PrivilegedAction<StackWalker>() {\n+                @Override\n+                public StackWalker run() {\n+                    StackWalker stackwalker = StackWalker.getInstance(StackWalker.Option.RETAIN_CLASS_REFERENCE);\n+                    return stackwalker;\n+                }\n+            });\n+\n+            if(walker.getCallerClass() != this.getClass()) {\n+                BufferedImage bi = new BufferedImage(1, 1, BufferedImage.TYPE_INT_RGB);\n+                graphics = bi.createGraphics();\n+            }\n","filename":"src\/java.desktop\/share\/classes\/javax\/swing\/DebugGraphics.java","additions":15,"deletions":2,"binary":false,"changes":17,"status":"modified"}]}