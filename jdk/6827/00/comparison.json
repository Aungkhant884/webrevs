{"files":[{"patch":"@@ -178,1 +178,1 @@\n-    \/\/ search nearby memory for the vtbl value of the given type.\n+    \/\/ search the first word for the vtbl value of the given type.\n@@ -234,6 +234,3 @@\n-    \/\/ Assuming that the base type is truly the first polymorphic type\n-    \/\/ then the vtbl for all subclasss should be at several defined\n-    \/\/ locations so only those locations will be checked.  It's also\n-    \/\/ required that the caller knows that the static type is at least\n-    \/\/ baseType.  See the notes in guessTypeForAddress for the logic of\n-    \/\/ the locations searched.\n+    \/\/ Assuming that the base type is truly the first polymorphic type,\n+    \/\/ then the vtbl for all subclassses should be in the first word of\n+    \/\/ the object.\n@@ -251,17 +248,0 @@\n-    Address loc2 = null;\n-    Address loc3 = null;\n-    long offset2 = baseType.getSize();\n-    \/\/ I don't think this should be misaligned under any\n-    \/\/ circumstances, but I'm not sure (FIXME: also not sure which\n-    \/\/ way to go here, up or down -- assuming down)\n-    offset2 = offset2 - (offset2 % getAddressSize()) - getAddressSize();\n-    if (offset2 > 0) {\n-      loc2 = addr.getAddressAt(offset2);\n-    }\n-    long offset3 = offset2 - getAddressSize();\n-    if (offset3 > 0) {\n-      loc3 = addr.getAddressAt(offset3);\n-    }\n-\n-    Type loc2Match = null;\n-    Type loc3Match = null;\n@@ -274,1 +254,1 @@\n-      if (superClass == null) continue;\n+      if (superClass == null) continue;  \/\/ type is not a subclass of baseType\n@@ -277,2 +257,1 @@\n-        \/\/ This occurs sometimes for intermediate types that are never\n-        \/\/ instantiated.\n+        \/\/ This occurs sometimes for intermediate types that are never instantiated.\n@@ -284,7 +263,2 @@\n-      \/\/ Prefer loc1 match\n-      if (vtblAddr.equals(loc1)) return type;\n-      if (loc2 != null && loc2Match == null && vtblAddr.equals(loc2)) {\n-          loc2Match = type;\n-      }\n-      if (loc3 != null && loc3Match == null && vtblAddr.equals(loc3)) {\n-          loc3Match = type;\n+      if (vtblAddr.equals(loc1)) {\n+        return type;\n@@ -293,2 +267,0 @@\n-    if (loc2Match != null) return loc2Match;\n-    if (loc3Match != null) return loc3Match;\n","filename":"src\/jdk.hotspot.agent\/share\/classes\/sun\/jvm\/hotspot\/types\/basic\/BasicTypeDataBase.java","additions":8,"deletions":36,"binary":false,"changes":44,"status":"modified"}]}