{"files":[{"patch":"@@ -25,0 +25,2 @@\n+import java.util.Arrays;\n+import java.util.Optional;\n@@ -50,0 +52,7 @@\n+\n+        checkInner(N0.class, false);\n+        checkInner(N0.N1.class, true);\n+        checkInner(N0.N1.N2.class, true);\n+        checkInner(N0.N1.N2.N3.class, true);\n+        checkInner(N0.N1.N2.N3.N4.class, false);\n+        checkInner(N0.N1.N2.N3.N4.N5.class, false);\n@@ -115,6 +124,15 @@\n-    private static void checkInner(Class<?> clazz, boolean expectOuterThis) {\n-        Field outerThis;\n-        try {\n-            outerThis = clazz.getDeclaredField(\"this$0\");\n-        } catch (NoSuchFieldException e) {\n-            outerThis = null;\n+    static class N0 {\n+        int x;\n+\n+        class N1 {\n+            class N2 {\n+                class N3 {\n+                    void f() {\n+                        System.err.println(x);\n+                    }\n+\n+                    class N4 {\n+                        class N5 {}\n+                    }\n+                }\n+            }\n@@ -122,0 +140,5 @@\n+    }\n+\n+    private static void checkInner(Class<?> clazz, boolean expectOuterThis) {\n+        Optional<Field> outerThis = Arrays.stream(clazz.getDeclaredFields())\n+                .filter(f -> f.getName().startsWith(\"this$\")).findFirst();\n@@ -123,1 +146,1 @@\n-            if (outerThis == null) {\n+            if (outerThis.isEmpty()) {\n@@ -129,1 +152,1 @@\n-            if (outerThis != null) {\n+            if (outerThis.isPresent()) {\n","filename":"test\/langtools\/tools\/javac\/optimizeOuterThis\/OptimizeOuterThis.java","additions":31,"deletions":8,"binary":false,"changes":39,"status":"modified"}]}