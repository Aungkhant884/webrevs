{"files":[{"patch":"@@ -49,4 +49,4 @@\n-#define CHECK_EXCEPTION(env)            \\\n-    if ((*(env))->ExceptionCheck(env)) { \\\n-        (*(env))->ExceptionDescribe(env);\\\n-        (*(env))->ExceptionClear(env);   \\\n+#define CHECK_EXCEPTION(env, describe)                 \\\n+    if ((*(env))->ExceptionCheck(env)) {               \\\n+        if (describe) (*(env))->ExceptionDescribe(env);\\\n+        else          (*(env))->ExceptionClear(env);   \\\n@@ -106,0 +106,1 @@\n+static jboolean  debugFonts; \/\/ Stores the value of FontUtilities.debugFonts()\n@@ -112,0 +113,5 @@\n+\n+    jboolean ignoreException;\n+    debugFonts = JNU_CallStaticMethodByName(env, &ignoreException,\n+                                            \"sun\/font\/FontUtilities\",\n+                                            \"debugFonts\", \"()Z\").z;\n@@ -146,2 +152,3 @@\n-    \/\/ NB: Exceptions must not be cleared (and therefore no JNI calls performed) after calling this method\n-    \/\/     because it intentionally leaves an exception pending.\n+    \/\/ NB: Exceptions must not be cleared (and therefore no JNI calls\n+    \/\/ performed) after calling this method because it intentionally\n+    \/\/ leaves an exception pending.\n@@ -198,2 +205,1 @@\n-            \/\/ This is a callback, we are not returning immediately to Java and better report exceptions now\n-            CHECK_EXCEPTION(env);\n+            CHECK_EXCEPTION(env, debugFonts);\n@@ -219,2 +225,1 @@\n-            \/\/ This is a callback, we are not returning immediately to Java and better report exceptions now\n-            CHECK_EXCEPTION(env);\n+            CHECK_EXCEPTION(env, debugFonts);\n@@ -254,2 +259,1 @@\n-        \/\/ This is a callback, we are not returning immediately to Java and better report exceptions now\n-        CHECK_EXCEPTION(env);\n+        CHECK_EXCEPTION(env, debugFonts);\n","filename":"src\/java.desktop\/share\/native\/libfontmanager\/freetypeScaler.c","additions":16,"deletions":12,"binary":false,"changes":28,"status":"modified"},{"patch":"@@ -28,1 +28,0 @@\n- * @requires os.family == \"linux\"\n","filename":"test\/jdk\/java\/awt\/font\/JNICheck\/FreeTypeScalerJNICheck.java","additions":0,"deletions":1,"binary":false,"changes":1,"status":"modified"}]}