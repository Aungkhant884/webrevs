{"files":[{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 1997, 2020, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 1997, 2021, Oracle and\/or its affiliates. All rights reserved.\n@@ -43,0 +43,1 @@\n+#include \"utilities\/stringUtils.hpp\"\n@@ -4039,1 +4040,1 @@\n-void TypeInstPtr::dump2( Dict &d, uint depth, outputStream *st ) const {\n+void TypeInstPtr::dump2(Dict &d, uint depth, outputStream* st) const {\n@@ -4045,1 +4046,0 @@\n-    \/\/ TO DO: Make CI print the hex address of the underlying oop.\n@@ -4047,1 +4047,10 @@\n-      const_oop()->print_oop(st);\n+      ResourceMark rm;\n+      stringStream ss;\n+\n+      st->print(\" \");\n+      const_oop()->print_oop(&ss);\n+      \/\/ suppress new-lines('\\n') in ss emitted by const_oop->print_oop()\n+      \/\/ so each node is one-liner for -XX:+Verbose && -XX:+PrintIdeal\n+      char* buf = ss.as_string(false);\n+      StringUtils::replace_no_expand(buf, \"\\n\", \"\");\n+      st->print_raw(buf);\n","filename":"src\/hotspot\/share\/opto\/type.cpp","additions":13,"deletions":4,"binary":false,"changes":17,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2019, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2019, 2021, Oracle and\/or its affiliates. All rights reserved.\n@@ -31,0 +31,1 @@\n+#include \"utilities\/stringUtils.hpp\"\n@@ -53,0 +54,26 @@\n+static size_t count_char(const char* s, size_t len, char ch) {\n+  size_t cnt = 0;\n+\n+  for (size_t i = 0; i < len; ++i) {\n+    if (s[i] == ch) {\n+      cnt++;\n+    }\n+  }\n+  return cnt;\n+}\n+\n+static size_t count_char(const stringStream* ss, char ch) {\n+  return count_char(ss->as_string(), ss->size(), ch);\n+}\n+\n+static void test_stringStream_tr_delete(stringStream* ss) {\n+  ResourceMark rm;\n+  size_t whitespaces = count_char(ss, ' ');\n+  char* s2 = ss->as_string(false);\n+  int deleted = StringUtils::replace_no_expand(s2, \" \", \"\");\n+  ASSERT_EQ(whitespaces, (size_t)deleted);\n+\n+  whitespaces = count_char(s2, strlen(s2), ' ');\n+  ASSERT_EQ(whitespaces, (size_t)0);\n+}\n+\n@@ -66,0 +93,3 @@\n+\n+  test_stringStream_tr_delete(ss);\n+\n","filename":"test\/hotspot\/gtest\/utilities\/test_ostream.cpp","additions":31,"deletions":1,"binary":false,"changes":32,"status":"modified"}]}