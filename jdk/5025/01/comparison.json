{"files":[{"patch":"@@ -86,2 +86,2 @@\n-                long n;\n-                if ((n = srcCh.transferTo(0, LENGTH, dstCh)) < LENGTH) {\n+                long total = 0L;\n+                if ((total = srcCh.transferTo(0, LENGTH, dstCh)) < LENGTH) {\n@@ -89,1 +89,1 @@\n-                        throw new RuntimeException(\"Transfer too small: \" + n);\n+                        throw new RuntimeException(\"Transfer too small: \" + total);\n@@ -91,4 +91,12 @@\n-                    if (n != 0x7ffff000)\n-                        throw new RuntimeException(\"Unexpected transfer size: \" + n);\n-                    if ((n += srcCh.transferTo(n, LENGTH, dstCh)) != LENGTH)\n-                        throw new RuntimeException(\"Unexpected total size: \" + n);\n+                    \/\/ if this point is reached we're on Linux\n+                    if (total > LINUX_MAX_TRANSFER_SIZE)\n+                        throw new RuntimeException(\"Unexpected transfer size: \" + total);\n+\n+                    do {\n+                        long n = srcCh.transferTo(total, LENGTH, dstCh);\n+                        if (n == 0)\n+                            break;\n+                        if (n > LINUX_MAX_TRANSFER_SIZE)\n+                            throw new RuntimeException(\"Unexpected transfer size: \" + n);\n+                        total += n;\n+                    } while (total < LENGTH);\n@@ -101,1 +109,1 @@\n-                System.out.println(\"Transferred \" + n + \" bytes\");\n+                System.out.println(\"Transferred \" + total + \" bytes\");\n","filename":"test\/jdk\/java\/nio\/channels\/FileChannel\/Transfer2GPlus.java","additions":16,"deletions":8,"binary":false,"changes":24,"status":"modified"}]}