{"files":[{"patch":"@@ -24,3 +24,0 @@\n-import java.io.BufferedReader;\n-import java.io.File;\n-import java.io.InputStreamReader;\n@@ -36,2 +33,1 @@\n- * @run main\/othervm FileHandlerAccessTest process 20\n- * @run main\/othervm FileHandlerAccessTest thread 20\n+ * @run main\/othervm FileHandlerAccessTest 20\n@@ -43,17 +39,4 @@\n-        if (!(args.length == 2 || args.length == 1)) {\n-            throw new IllegalArgumentException(\"Usage error: expects java FileHandlerAccessTest [process\/thread] <count>\");\n-        } else if (args.length == 2) {\n-            var type = args[0];\n-            var count = Integer.parseInt(args[1]);\n-\n-            for (var i = 0; i < count; i++) {\n-                System.out.println(\"Testing with arguments: type=\" + type + \", count=\"+count);\n-                if (type.equals(\"process\")) {\n-                    new Thread(FileHandlerAccessTest::accessProcess).start();\n-                }\n-                else if (type.equals(\"thread\")) {\n-                    new Thread(FileHandlerAccessTest::access).start();\n-                }\n-            }\n-        } else {\n-            access();\n+        var count = Integer.parseInt(args[0]);\n+        System.out.println(\"Testing with \" + count + \" threads\");\n+        for (var i = 0; i < count; i++) {\n+            new Thread(FileHandlerAccessTest::access).start();\n@@ -72,36 +55,0 @@\n-\n-    private static void accessProcess() {\n-        final var javaHome = System.getProperty(\"java.home\");\n-        var name = Thread.currentThread().getName();\n-        BufferedReader bufferedReader = null;\n-        Process childProcess = null;\n-        final String className = new Object(){}.getClass().getEnclosingClass().getName();\n-\n-        try {\n-            ProcessBuilder processBuilder = new ProcessBuilder(javaHome + File.separator + \"bin\" + File.separator + \"java\", \"-cp\", \".\", className, \"doProcess\");\n-            processBuilder.redirectErrorStream(true);\n-            childProcess = processBuilder.start();\n-\n-            bufferedReader = new BufferedReader(new InputStreamReader(childProcess.getInputStream()));\n-            String line;\n-            while ((line = bufferedReader.readLine()) != null) {\n-                System.out.println(name + \"\\t|\" + line);\n-            }\n-\n-            int exitCode = childProcess.waitFor();\n-            if (exitCode != 0) {\n-                throw new RuntimeException(\"An error occured in the child process.\");\n-            }\n-        } catch (Exception e) {\n-            throw new RuntimeException(e);\n-        } finally {\n-            if (childProcess != null) {\n-                childProcess.destroy();\n-            }\n-            if (bufferedReader != null) {\n-                try {\n-                    bufferedReader.close();\n-                } catch (Exception ignored) {}\n-            }\n-        }\n-    }\n","filename":"test\/jdk\/java\/util\/logging\/FileHandlerAccessTest.java","additions":5,"deletions":58,"binary":false,"changes":63,"status":"modified"}]}