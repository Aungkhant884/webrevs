{"files":[{"patch":"@@ -613,1 +613,1 @@\n-        \/\/ Enable write-through mode to avoid internal buffer copies.\n+        \/\/ Enable unbuffered mode to avoid memory consumption and internal buffer copies.\n@@ -615,3 +615,2 @@\n-            long longBytes = length * typeSize + headerSize;\n-            int bytesToWrite = (int) (longBytes);\n-            hprofBufferedOut.fillSegmentSizeAndEnableWriteThrough(bytesToWrite);\n+            int size = (int) (length * typeSize + headerSize);\n+            hprofBufferedOut.fillSegmentSizeAndEnableUnbufferedMode(size);\n@@ -1345,1 +1344,1 @@\n-            writeThrough = false;\n+            unbufferedMode = false;\n@@ -1368,1 +1367,1 @@\n-           if (segmentMode && !writeThrough) {\n+           if (segmentMode && !unbufferedMode) {\n@@ -1396,1 +1395,1 @@\n-            if (segmentMode && !writeThrough) {\n+            if (segmentMode && !unbufferedMode) {\n@@ -1423,1 +1422,1 @@\n-            if (segmentMode && !writeThrough) {\n+            if (segmentMode && !unbufferedMode) {\n@@ -1464,1 +1463,1 @@\n-                writeThrough = false;\n+                unbufferedMode = false;\n@@ -1473,1 +1472,1 @@\n-            if (writeThrough) {\n+            if (unbufferedMode) {\n@@ -1476,1 +1475,1 @@\n-                writeThrough = false;\n+                unbufferedMode = false;\n@@ -1486,1 +1485,1 @@\n-         * Fill segment size and enable write through mode\n+         * Fill segment size and enable unbuffered mode\n@@ -1489,1 +1488,1 @@\n-        public void fillSegmentSizeAndEnableWriteThrough(int size) throws IOException {\n+        public void fillSegmentSizeAndEnableUnbufferedMode(int size) throws IOException {\n@@ -1491,1 +1490,1 @@\n-            assert writeThrough == false;\n+            assert unbufferedMode == false;\n@@ -1497,3 +1496,3 @@\n-            assert (segmentMode && (segmentWritten == 0) && (writeThrough == false)) : \"Wrong Status\";\n-            \/\/ enable write through so the internal buffer is clean to reuse.\n-            writeThrough = true;\n+            assert (segmentMode && (segmentWritten == 0) && (unbufferedMode == false)) : \"Wrong Status\";\n+            \/\/ enable unbuffered mode.\n+            unbufferedMode = true;\n@@ -1511,2 +1510,2 @@\n-            \/\/ write through mode always flush data.\n-            if (writeThrough) return true;\n+            \/\/ unbuffered mode always flush data.\n+            if (unbufferedMode) return true;\n@@ -1523,1 +1522,1 @@\n-            if (writeThrough) {\n+            if (unbufferedMode) {\n@@ -1543,2 +1542,2 @@\n-            \/\/ write through mode has assumption that data size is already filled in header.\n-            assert !writeThrough;\n+            \/\/ unbuffered mode has assumption that data size is already filled in header.\n+            assert !unbufferedMode;\n@@ -1555,1 +1554,1 @@\n-            if (!writeThrough) {\n+            if (!unbufferedMode) {\n@@ -1579,1 +1578,1 @@\n-        private boolean writeThrough;\n+        private boolean unbufferedMode;\n","filename":"src\/jdk.hotspot.agent\/share\/classes\/sun\/jvm\/hotspot\/utilities\/HeapHprofBinWriter.java","additions":23,"deletions":24,"binary":false,"changes":47,"status":"modified"}]}