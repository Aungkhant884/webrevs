{"files":[{"patch":"@@ -328,1 +328,1 @@\n-            switch (ifcFfcStrength(KeyUtil.getKeySize(k), false)) {\n+            switch (ifcFfcStrength(KeyUtil.getKeySize(k))) {\n@@ -494,4 +494,3 @@\n-            case \"DSA\", \"RSA\" -> ifcFfcStrength(KeyUtil.getKeySize(k),\n-                    kAlg.equals(\"DSA\")) + \"with\" + kAlg;\n-            case \"EC\" -> ecStrength(KeyUtil.getKeySize(k))\n-                    + \"withECDSA\";\n+            case \"DSA\" -> \"SHA256withDSA\";\n+            case \"RSA\" -> ifcFfcStrength(KeyUtil.getKeySize(k)) + \"withRSA\";\n+            case \"EC\" -> ecStrength(KeyUtil.getKeySize(k)) + \"withECDSA\";\n@@ -547,2 +546,3 @@\n-     * security strength of the specified IFC\/FFC key size and the\n-     * recommendation from NIST CNSA, e.g. use SHA-384 and min 3072-bit.\n+     * security strength of the specified IFC\/FFC key size, i.e. RSA,\n+     * RSASSA-PSS, and the recommendation from NIST CNSA, e.g. use SHA-384\n+     * and min 3072-bit.\n@@ -553,12 +553,6 @@\n-    private static String ifcFfcStrength (int bitLength, boolean isDSA) {\n-        if (isDSA) {\n-            \/\/ for backward interoperability\n-            \/\/ SHA384withDSA is added under JDK-8172366 (jdk16)\n-            return \"SHA256\";\n-        } else { \/\/ RSA, RSASSA-PSS\n-            if (bitLength > 7680) { \/\/ 256 bits security strength\n-                return \"SHA512\";\n-            } else {\n-                \/\/ per CNSA, use SHA-384 unless keysize is too small\n-                return (bitLength >= 624 ? \"SHA384\" : \"SHA256\");\n-            }\n+    private static String ifcFfcStrength(int bitLength) {\n+        if (bitLength > 7680) { \/\/ 256 bits security strength\n+            return \"SHA512\";\n+        } else {\n+            \/\/ per CNSA, use SHA-384 unless keysize is too small\n+            return (bitLength >= 624 ? \"SHA384\" : \"SHA256\");\n","filename":"src\/java.base\/share\/classes\/sun\/security\/util\/SignatureUtil.java","additions":13,"deletions":19,"binary":false,"changes":32,"status":"modified"}]}