{"files":[{"patch":"@@ -45,1 +45,1 @@\n-         \/\/ Serialize to bytes\n+        \/\/ Serialize to bytes\n@@ -71,5 +71,5 @@\n-       ByteArrayOutputStream baos = new ByteArrayOutputStream();\n-       ObjectOutputStream oos = new ObjectOutputStream(baos);\n-       oos.writeObject(new PriorityQueue<>());\n-       oos.close();\n-       byte[] serializedData = baos.toByteArray();\n+        ByteArrayOutputStream baos = new ByteArrayOutputStream();\n+        ObjectOutputStream oos = new ObjectOutputStream(baos);\n+        oos.writeObject(new PriorityQueue<>());\n+        oos.close();\n+        byte[] serializedData = baos.toByteArray();\n@@ -77,10 +77,10 @@\n-       \/\/ Find the right location to modify, looking for the first instance of TC_BLOCKDATA\n-       int firstPos = 0;\n-       for (int i = 0; i < serializedData.length - 1; i++) {\n-           \/\/ 0x77 = TC_BLOCKDATA\n-           if (serializedData[i] == 0x77) {\n-               \/\/ Replace array length with -3\n-               serializedData[i - 5] = (byte) 0xff;\n-               serializedData[i - 4] = (byte) 0xff;\n-               serializedData[i - 3] = (byte) 0xff;\n-               serializedData[i - 2] = (byte) 0xfd;\n+        \/\/ Find the right location to modify, looking for the first instance of TC_BLOCKDATA\n+        int firstPos = 0;\n+        for (int i = 0; i < serializedData.length - 1; i++) {\n+            \/\/ 0x77 = TC_BLOCKDATA\n+            if (serializedData[i] == 0x77) {\n+                \/\/ Replace array length with -3\n+                serializedData[i - 5] = (byte) 0xff;\n+                serializedData[i - 4] = (byte) 0xff;\n+                serializedData[i - 3] = (byte) 0xff;\n+                serializedData[i - 2] = (byte) 0xfd;\n@@ -88,4 +88,4 @@\n-               return serializedData;\n-           }\n-       }\n-       throw new RuntimeException(\"Can't find TC_BLOCKDATA in object output stream\");\n+                return serializedData;\n+            }\n+        }\n+        throw new RuntimeException(\"Can't find TC_BLOCKDATA in object output stream\");\n@@ -106,3 +106,3 @@\n-        try {\n-            \/\/ Test object input stream with negative sized array\n-            ObjectInputStream ois = new ObjectInputStream(new ByteArrayInputStream(buildArrayPayload()));\n+        \/\/ Test object input stream with negative sized array\n+        try (ByteArrayInputStream bais = new ByteArrayInputStream(buildArrayPayload());\n+             ObjectInputStream ois = new ObjectInputStream(bais)) {\n@@ -113,1 +113,1 @@\n-            \/\/ OK, because a NegativeArraySizeException should be converted into a ObjectStreamException\n+            \/\/ OK, because a NegativeArraySizeException should be converted into an ObjectStreamException\n@@ -118,3 +118,3 @@\n-        try {\n-            \/\/ Test object input stream with negative sized array and custom object input filter\n-            ObjectInputStream ois = new ObjectInputStream(new ByteArrayInputStream(buildArrayPayload()));\n+        \/\/ Test object input stream with negative sized array and custom object input filter\n+        try (ByteArrayInputStream bais = new ByteArrayInputStream(buildArrayPayload());\n+             ObjectInputStream ois = new ObjectInputStream(bais)) {\n@@ -129,1 +129,1 @@\n-            \/\/ OK, because a NegativeArraySizeException should be converted into a ObjectStreamException *before* filtering\n+            \/\/ OK, because a NegativeArraySizeException should be converted into an ObjectStreamException *before* filtering\n@@ -134,3 +134,3 @@\n-        try {\n-            \/\/ Test object input stream with negative sized PriorityQueue\n-            ObjectInputStream ois = new ObjectInputStream(new ByteArrayInputStream(buildPriorityQueuePayload()));\n+        \/\/ Test object input stream with negative sized PriorityQueue\n+        try (ByteArrayInputStream bais = new ByteArrayInputStream(buildPriorityQueuePayload());\n+             ObjectInputStream ois = new ObjectInputStream(bais)) {\n@@ -141,1 +141,1 @@\n-            \/\/ OK, because a NegativeArraySizeException should be converted into a ObjectStreamException\n+            \/\/ OK, because a NegativeArraySizeException should be converted into an ObjectStreamException\n","filename":"test\/jdk\/java\/io\/ObjectInputStream\/NegativeArraySizeTest.java","additions":32,"deletions":32,"binary":false,"changes":64,"status":"modified"}]}