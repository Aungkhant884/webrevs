{"files":[{"patch":"@@ -63,1 +63,1 @@\n-static void z_cmpxchg_common(MacroAssembler& _masm, const MachNode* node, Address mem, Register newval, Register tmp1, Register tmp2) {\n+static void z_cmpxchg_common(MacroAssembler& _masm, const MachNode* node, Register mem_reg, Register newval, Register tmp) {\n@@ -65,0 +65,1 @@\n+   const Address mem = Address(mem_reg, 0);\n@@ -67,7 +68,1 @@\n-    if (mem.base() == rax || mem.index() == rax) {\n-      __ movptr(tmp2, rax);\n-      mem = Address(mem.base() == rax ? tmp2 : mem.base(),\n-                    mem.index() == rax ? tmp2 : mem.index(),\n-                    mem.scale(), mem.disp());\n-    }\n-    __ movptr(tmp1, rax);\n+    __ movptr(tmp, rax);\n@@ -81,2 +76,2 @@\n-    z_load_barrier_cmpxchg(_masm, node, mem, rax, tmp1, good);\n-    __ movptr(rax, tmp1);\n+    z_load_barrier_cmpxchg(_masm, node, mem, rax, tmp, good);\n+    __ movptr(rax, tmp);\n@@ -110,1 +105,1 @@\n-instruct zCompareAndExchangeP(memory mem, rax_RegP oldval, rRegP newval, rRegP tmp1, rRegP tmp2, rFlagsReg cr) %{\n+instruct zCompareAndExchangeP(indirect mem, rax_RegP oldval, rRegP newval, rRegP tmp, rFlagsReg cr) %{\n@@ -113,1 +108,1 @@\n-  effect(KILL cr, TEMP tmp1, TEMP tmp2);\n+  effect(KILL cr, TEMP tmp);\n@@ -120,1 +115,1 @@\n-    z_cmpxchg_common(_masm, this, $mem$$Address, $newval$$Register, $tmp1$$Register, $tmp2$$Register);\n+    z_cmpxchg_common(_masm, this, $mem$$Register, $newval$$Register, $tmp$$Register);\n@@ -126,1 +121,1 @@\n-instruct zCompareAndSwapP(rRegI res, memory mem, rRegP newval, rRegP tmp1, rRegP tmp2, rFlagsReg cr, rax_RegP oldval) %{\n+instruct zCompareAndSwapP(rRegI res, indirect mem, rRegP newval, rRegP tmp, rFlagsReg cr, rax_RegP oldval) %{\n@@ -130,1 +125,1 @@\n-  effect(KILL cr, KILL oldval, TEMP tmp1, TEMP tmp2);\n+  effect(KILL cr, KILL oldval, TEMP tmp);\n@@ -139,1 +134,1 @@\n-    z_cmpxchg_common(_masm, this, $mem$$Address, $newval$$Register, $tmp1$$Register, $tmp2$$Register);\n+    z_cmpxchg_common(_masm, this, $mem$$Register, $newval$$Register, $tmp$$Register);\n@@ -141,1 +136,1 @@\n-      __ cmpptr($tmp1$$Register, rax);\n+      __ cmpptr($tmp$$Register, rax);\n@@ -150,1 +145,1 @@\n-instruct zXChgP(memory mem, rRegP newval, rFlagsReg cr) %{\n+instruct zXChgP(indirect mem, rRegP newval, rFlagsReg cr) %{\n@@ -158,1 +153,1 @@\n-    __ xchgptr($newval$$Register, $mem$$Address);\n+    __ xchgptr($newval$$Register, Address($mem$$Register, 0));\n","filename":"src\/hotspot\/cpu\/x86\/gc\/z\/z_x86_64.ad","additions":14,"deletions":19,"binary":false,"changes":33,"status":"modified"}]}