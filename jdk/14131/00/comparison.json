{"files":[{"patch":"@@ -1666,1 +1666,1 @@\n-  out->print_cr(\"version %d\", REPLAY_VERSION);\n+  dump_replay_data_version(out);\n@@ -1734,0 +1734,1 @@\n+          dump_replay_data_version(&replay_data_stream);\n@@ -1745,0 +1746,4 @@\n+\n+void ciEnv::dump_replay_data_version(outputStream* out) {\n+  out->print_cr(\"version %d\", REPLAY_VERSION);\n+}\n","filename":"src\/hotspot\/share\/ci\/ciEnv.cpp","additions":6,"deletions":1,"binary":false,"changes":7,"status":"modified"},{"patch":"@@ -499,0 +499,1 @@\n+  void dump_replay_data_version(outputStream* out);\n","filename":"src\/hotspot\/share\/ci\/ciEnv.hpp","additions":1,"deletions":0,"binary":false,"changes":1,"status":"modified"},{"patch":"@@ -639,1 +639,1 @@\n-      process_command(THREAD);\n+      process_command(false, THREAD);\n@@ -655,1 +655,1 @@\n-  void process_command(TRAPS) {\n+  void process_command(bool is_replay_inline, TRAPS) {\n@@ -673,10 +673,11 @@\n-    } else if (strcmp(\"ciMethod\", cmd) == 0) {\n-      process_ciMethod(CHECK);\n-    } else if (strcmp(\"ciMethodData\", cmd) == 0) {\n-      process_ciMethodData(CHECK);\n-    } else if (strcmp(\"staticfield\", cmd) == 0) {\n-      process_staticfield(CHECK);\n-    } else if (strcmp(\"ciInstanceKlass\", cmd) == 0) {\n-      process_ciInstanceKlass(CHECK);\n-    } else if (strcmp(\"instanceKlass\", cmd) == 0) {\n-      process_instanceKlass(CHECK);\n+    } else if (!is_replay_inline) {\n+      if (strcmp(\"ciMethod\", cmd) == 0) {\n+        process_ciMethod(CHECK);\n+      } else if (strcmp(\"ciMethodData\", cmd) == 0) {\n+        process_ciMethodData(CHECK);\n+      } else if (strcmp(\"staticfield\", cmd) == 0) {\n+        process_staticfield(CHECK);\n+      } else if (strcmp(\"ciInstanceKlass\", cmd) == 0) {\n+        process_ciInstanceKlass(CHECK);\n+      } else if (strcmp(\"instanceKlass\", cmd) == 0) {\n+        process_instanceKlass(CHECK);\n@@ -684,2 +685,2 @@\n-    } else if (strcmp(\"JvmtiExport\", cmd) == 0) {\n-      process_JvmtiExport(CHECK);\n+      } else if (strcmp(\"JvmtiExport\", cmd) == 0) {\n+        process_JvmtiExport(CHECK);\n@@ -687,0 +688,3 @@\n+      } else {\n+        report_error(\"unknown command\");\n+      }\n@@ -726,6 +730,1 @@\n-      \/\/ Expecting only lines with \"compile\" command in inline replay file.\n-      char* cmd = parse_string();\n-      if (cmd == nullptr || strcmp(\"compile\", cmd) != 0) {\n-        return nullptr;\n-      }\n-      process_compile(CHECK_NULL);\n+      process_command(true, CHECK_NULL);\n","filename":"src\/hotspot\/share\/ci\/ciReplay.cpp","additions":19,"deletions":20,"binary":false,"changes":39,"status":"modified"}]}