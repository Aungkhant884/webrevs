{"files":[{"patch":"@@ -329,1 +329,2 @@\n-        int sha512Idx = transformation.indexOf(SHA512TRUNCATED);\n+        int sha512Idx = transformation.toUpperCase(Locale.ENGLISH).indexOf\n+                (SHA512TRUNCATED);\n","filename":"src\/java.base\/share\/classes\/javax\/crypto\/Cipher.java","additions":2,"deletions":1,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -31,0 +31,1 @@\n+import java.util.Locale;\n@@ -44,0 +45,7 @@\n+        \"PBEWithHmacSha1AndAES_128\/CBC\/PKCS5PAdding\",\n+        \"PBEWithHmacSHA224andAES_128\/CBC\/PkCS5Padding\",\n+        \"PBEWithHmacSHA256AndAes_128\/CBC\/PKCS5PaddIng\",\n+        \"PBEWithHmacSHa384AndAES_128\/CbC\/PKCS5Padding\",\n+        \"PBEWithHmacSHA512andAES_128\/CBc\/PKCS5Padding\",\n+        \"PBEWithHmacSha512\/224andAES_128\/cBC\/PKCS5Padding\",\n+        \"PBEWithHmacShA512\/256AndAES_128\/CBC\/pkCS5Padding\",\n@@ -69,1 +77,3 @@\n-        SecretKeyFactory keyFactory = SecretKeyFactory.getInstance(algo);\n+        int modeIdx = algo.toUpperCase(Locale.ENGLISH).indexOf(\"\/CBC\");\n+        String keyAlgo = (modeIdx == -1 ? algo : algo.substring(0, modeIdx));\n+        SecretKeyFactory keyFactory = SecretKeyFactory.getInstance(keyAlgo);\n","filename":"test\/jdk\/com\/sun\/crypto\/provider\/Cipher\/PBE\/PBES2Test.java","additions":11,"deletions":1,"binary":false,"changes":12,"status":"modified"}]}