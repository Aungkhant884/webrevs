{"files":[{"patch":"@@ -2602,3 +2602,3 @@\n-                                                          Klass* accessing_klass,\n-                                                          Handle *appendix_result,\n-                                                          TRAPS) {\n+                                                     Klass* accessing_klass,\n+                                                     Handle* appendix_result,\n+                                                     TRAPS) {\n","filename":"src\/hotspot\/share\/classfile\/systemDictionary.cpp","additions":3,"deletions":3,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -68,1 +68,1 @@\n-    result.set_handle(method, appendix, THREAD);\n+    result.set_handle(SystemDictionary::MethodHandle_klass(), method, appendix, THREAD);\n@@ -222,1 +222,1 @@\n-  result.set_handle(resolved_method(), resolved_appendix(), CHECK);\n+  result.set_handle(SystemDictionary::MethodHandle_klass(), resolved_method(), resolved_appendix(), CHECK);\n","filename":"src\/hotspot\/share\/interpreter\/bootstrapInfo.cpp","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -96,5 +96,0 @@\n-void CallInfo::set_handle(const methodHandle& resolved_method,\n-                          Handle resolved_appendix, TRAPS) {\n-  set_handle(SystemDictionary::MethodHandle_klass(), resolved_method, resolved_appendix, CHECK);\n-}\n-\n@@ -501,8 +496,6 @@\n-      Handle method_type;\n-      Method* result = SystemDictionary::find_method_handle_invoker(\n-                                                            klass,\n-                                                            name,\n-                                                            full_signature,\n-                                                            link_info.current_klass(),\n-                                                            &appendix,\n-                                                            CHECK_NULL);\n+      Method* result = SystemDictionary::find_method_handle_invoker(klass,\n+                                                                    name,\n+                                                                    full_signature,\n+                                                                    link_info.current_klass(),\n+                                                                    &appendix,\n+                                                                    CHECK_NULL);\n@@ -646,1 +639,1 @@\n-      || (resolved_klass == SystemDictionary::MethodHandle_klass() &&\n+      || ((resolved_klass == SystemDictionary::MethodHandle_klass() || resolved_klass == SystemDictionary::VarHandle_klass()) &&\n@@ -1709,0 +1702,17 @@\n+bool LinkResolver::resolve_previously_linked_invokehandle(CallInfo& result, const LinkInfo& link_info, const constantPoolHandle& pool, int index, TRAPS) {\n+  int cache_index = ConstantPool::decode_cpcache_index(index, true);\n+  ConstantPoolCacheEntry* cpce = pool->cache()->entry_at(cache_index);\n+  if (!cpce->is_f1_null()) {\n+    Klass* resolved_klass = link_info.resolved_klass();\n+    methodHandle method(THREAD, cpce->f1_as_method());\n+    Handle     appendix(THREAD, cpce->appendix_if_resolved(pool));\n+    result.set_handle(resolved_klass, method, appendix, THREAD);\n+    return true;\n+  } else if (cpce->indy_resolution_failed()) {\n+    int encoded_index = ResolutionErrorTable::encode_cpcache_index(cache_index);\n+    ConstantPool::throw_resolution_error(pool, encoded_index, CHECK_false);\n+    return true;\n+  } else {\n+    return false;\n+  }\n+}\n@@ -1711,1 +1721,0 @@\n-  \/\/ This guy is reached from InterpreterRuntime::resolve_invokehandle.\n@@ -1718,0 +1727,4 @@\n+  { \/\/ Check if MethodType has been bound already or failed already, and short circuit:\n+    bool is_done = resolve_previously_linked_invokehandle(result, link_info, pool, index, CHECK);\n+    if (is_done) return;\n+  }\n@@ -1729,1 +1742,1 @@\n-  Handle       resolved_appendix;\n+  Handle resolved_appendix;\n","filename":"src\/hotspot\/share\/interpreter\/linkResolver.cpp","additions":29,"deletions":16,"binary":false,"changes":45,"status":"modified"},{"patch":"@@ -69,2 +69,0 @@\n-  void set_handle(const methodHandle& resolved_method,\n-                  Handle resolved_appendix, TRAPS);\n@@ -252,0 +250,5 @@\n+  static bool resolve_previously_linked_invokehandle(CallInfo& result,\n+                                                     const LinkInfo& link_info,\n+                                                     const constantPoolHandle& pool,\n+                                                     int index, TRAPS);\n+\n@@ -340,1 +343,0 @@\n- public:\n","filename":"src\/hotspot\/share\/interpreter\/linkResolver.hpp","additions":5,"deletions":3,"binary":false,"changes":8,"status":"modified"},{"patch":"@@ -31,1 +31,0 @@\n-java\/util\/stream\/test\/org\/openjdk\/tests\/java\/util\/stream\/SpliteratorTest.java 8256368 generic-all\n","filename":"test\/jdk\/ProblemList-Xcomp.txt","additions":0,"deletions":1,"binary":false,"changes":1,"status":"modified"}]}