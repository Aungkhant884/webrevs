{"files":[{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 1997, 2017, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 1997, 2021, Oracle and\/or its affiliates. All rights reserved.\n@@ -316,0 +316,9 @@\n+        \/\/ No further process if z <= 1 or z == (p - 1) (See section 5.7.1,\n+        \/\/ NIST SP 800-56A Rev 3).\n+        BigInteger z = this.y.modPow(this.x, modulus);\n+        if ((z.compareTo(BigInteger.ONE) <= 0) ||\n+                z.equals(modulus.subtract(BigInteger.ONE))) {\n+            throw new ProviderException(\n+                    \"Generated secret is out-of-range of (1, p -1)\");\n+        }\n+\n@@ -330,1 +339,1 @@\n-        byte[] secret = this.y.modPow(this.x, modulus).toByteArray();\n+        byte[] secret = z.toByteArray();\n","filename":"src\/java.base\/share\/classes\/com\/sun\/crypto\/provider\/DHKeyAgreement.java","additions":11,"deletions":2,"binary":false,"changes":13,"status":"modified"}]}