{"files":[{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2018, 2021, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2018, 2022, Oracle and\/or its affiliates. All rights reserved.\n@@ -44,0 +44,25 @@\n+    private long tmpInode;\n+    private long tmpDev;\n+\n+    public PlatformSupportImpl() {\n+        super();\n+        try {\n+            var tmpPath = Path.of(getTemporaryDirectory());\n+            tmpInode = (Long)Files.getAttribute(tmpPath, \"unix:ino\");\n+            tmpDev = (Long)Files.getAttribute(tmpPath, \"unix:dev\");\n+        } catch (IOException e) {\n+            tmpInode = -1L;\n+            tmpDev = -1L;\n+        }\n+    }\n+\n+    private boolean tempDirectoryEquals(Path p) {\n+        try {\n+            long ino = (Long)Files.getAttribute(p, \"unix:ino\");\n+            long dev = (Long)Files.getAttribute(p, \"unix:dev\");\n+            return (ino == tmpInode) && (dev == tmpDev);\n+        } catch (IOException e) {\n+            return false;\n+        }\n+    }\n+\n@@ -91,0 +116,2 @@\n+     * Host and container devices could have the same inode value,\n+     * so we also need to check the device id.\n@@ -104,1 +131,0 @@\n-        long tmpInode = 0;\n@@ -120,6 +146,0 @@\n-        try {\n-            File f = new File(getTemporaryDirectory());\n-            tmpInode = (Long)Files.getAttribute(f.toPath(), \"unix:ino\");\n-        }\n-        catch (IOException e) {}\n-\n@@ -142,6 +162,4 @@\n-            try {\n-                long procInode = (Long)Files.getAttribute(containerFile.toPath(), \"unix:ino\");\n-                if (containerFile.exists() && containerFile.isDirectory() &&\n-                    containerFile.canRead() && procInode != tmpInode) {\n-                    v.add(containerTmpDir);\n-                }\n+            if (containerFile.exists() && containerFile.isDirectory() &&\n+                containerFile.canRead() &&\n+                !tempDirectoryEquals(containerFile.toPath())) {\n+                v.add(containerTmpDir);\n@@ -149,1 +167,0 @@\n-            catch (IOException e) {}\n","filename":"src\/jdk.internal.jvmstat\/linux\/classes\/sun\/jvmstat\/PlatformSupportImpl.java","additions":32,"deletions":15,"binary":false,"changes":47,"status":"modified"}]}