{"files":[{"patch":"@@ -65,2 +65,2 @@\n-    int metaCount = 0;\n-    boolean finished = false;\n+    volatile int metaCount = 0;\n+    volatile boolean finished = false;\n@@ -69,0 +69,1 @@\n+    long startTimeMs;\n@@ -72,0 +73,1 @@\n+        startTimeMs = System.currentTimeMillis();\n@@ -118,2 +120,13 @@\n-        } else if (msg.getData().length > 0 && msg.getType() == 1 && !received.contains(msg)) {\n-            received.add(msg);\n+        } else if (msg.getData().length > 0 && msg.getType() == 1) {\n+            if (!received.contains(msg)) {\n+                received.add(msg);\n+            } else {\n+                \/\/ Add some additional debug output for the case of duplicate meta message\n+                \/\/ The test will fail anyway at the end\n+                System.out.println(\"Duplicate message received after getting \"\n+                        + received.size() + \" messages.\");\n+                System.out.println(\"Sequencer in use: \" + sequencer);\n+                System.out.println(\"Time from test start: \" +\n+                        (System.currentTimeMillis() - startTimeMs) + \"ms\");\n+                Thread.dumpStack();\n+            }\n","filename":"test\/jdk\/javax\/sound\/midi\/Sequencer\/MetaCallback.java","additions":17,"deletions":4,"binary":false,"changes":21,"status":"modified"}]}