{"files":[{"patch":"@@ -41,0 +41,3 @@\n+import java.nio.file.attribute.FileTime;\n+import java.nio.file.Files;\n+import java.nio.file.Paths;\n@@ -79,0 +82,4 @@\n+        File fileLocal = new File(localFileName);\n+        if (fileLocal.exists()) {\n+            fileLocal.delete();\n+        }\n@@ -85,0 +92,2 @@\n+        checkFileExistence(localFileName, true\/*exist*\/);\n+        FileTime ft1 = Files.getLastModifiedTime(Paths.get(localFileName));\n@@ -87,2 +96,4 @@\n-        outputDirFile.setWritable(true);\n-        checkFileExistence(localFileName, true\/*exist*\/);\n+        FileTime ft2 = Files.getLastModifiedTime(Paths.get(localFileName));\n+        if (!ft2.equals(ft1)) {\n+            throw new RuntimeException(\"Archive file \" + localFileName + \" should not be updated\");\n+        }\n@@ -90,0 +101,4 @@\n+        if (fileLocal.exists()) {\n+            fileLocal.delete();\n+        }\n+        outputDirFile.setWritable(true);\n@@ -106,4 +121,2 @@\n-        app.stopApp();\n-        \/\/ cannot dynamically dump twice, restart\n-        app = createLingeredApp(\"-cp\", allJars, \"-XX:+RecordDynamicDumpInfo\");\n-        pid = app.getPid();\n+        checkFileExistence(localFileName, true\/*exist*\/);\n+        ft1 = Files.getLastModifiedTime(Paths.get(localFileName));\n@@ -112,1 +125,4 @@\n-        outputDirFile.setWritable(true);\n+        ft2 = Files.getLastModifiedTime(Paths.get(localFileName));\n+        if (!ft2.equals(ft1)) {\n+            throw new RuntimeException(\"Archive file \" + localFileName + \" should not be updated\");\n+        }\n@@ -114,4 +130,4 @@\n-        \/\/ MyDynamicDump.jsa should exist\n-        checkFileExistence(localFileName, true);\n-        File rmFile = new File(localFileName);\n-        rmFile.delete();\n+        if (fileLocal.exists()) {\n+            fileLocal.delete();\n+        }\n+        outputDirFile.setWritable(true);\n","filename":"test\/hotspot\/jtreg\/runtime\/cds\/appcds\/jcmd\/JCmdTestFileSafety.java","additions":27,"deletions":11,"binary":false,"changes":38,"status":"modified"}]}