{"files":[{"patch":"@@ -612,1 +612,1 @@\n-    G1AddCardResult add_result = _card_set->add_card(_region_idx, card_idx, false);\n+    _card_set->add_card(_region_idx, card_idx, false);\n@@ -812,2 +812,2 @@\n-template <class FOUND>\n-void G1CardSet::iterate_cards_during_transfer(CardSetPtr const card_set, FOUND& found) {\n+template <class CardVisitor>\n+void G1CardSet::iterate_cards_during_transfer(CardSetPtr const card_set, CardVisitor& found) {\n","filename":"src\/hotspot\/share\/gc\/g1\/g1CardSet.cpp","additions":3,"deletions":3,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -254,2 +254,8 @@\n-  template <class FOUND>\n-  void iterate_cards_during_transfer(CardSetPtr const card_set, FOUND& found);\n+  \/\/ Iterate over cards of a card set container during transfer of the cards from\n+  \/\/ one container to another. Executes\n+  \/\/\n+  \/\/     void operator ()(uint card_idx)\n+  \/\/\n+  \/\/ on the given class.\n+  template <class CardVisitor>\n+  void iterate_cards_during_transfer(CardSetPtr const card_set, CardVisitor& found);\n@@ -257,2 +263,16 @@\n-  template <class FOUND>\n-  void iterate_cards_or_ranges_in_container(CardSetPtr const card_set, FOUND& found);\n+  \/\/ Iterate over the container, calling a method on every card or card range contained\n+  \/\/ in the card container.\n+  \/\/ For every container, first calls\n+  \/\/\n+  \/\/   void start_iterate(uint tag, uint region_idx);\n+  \/\/\n+  \/\/ Then for every card or card range it calls\n+  \/\/\n+  \/\/   void do_card(uint card_idx);\n+  \/\/   void do_card_range(uint card_idx, uint length);\n+  \/\/\n+  \/\/ where card_idx is the card index within that region_idx passed before in\n+  \/\/ start_iterate().\n+  \/\/\n+  template <class CardOrRangeVisitor>\n+  void iterate_cards_or_ranges_in_container(CardSetPtr const card_set, CardOrRangeVisitor& found);\n@@ -320,1 +340,2 @@\n-  \/\/ Iterate all cards for card set merging.\n+  \/\/ Iterate all cards for card set merging. Must be a CardOrRangeVisitor as\n+  \/\/ explained above.\n","filename":"src\/hotspot\/share\/gc\/g1\/g1CardSet.hpp","additions":26,"deletions":5,"binary":false,"changes":31,"status":"modified"},{"patch":"@@ -44,2 +44,2 @@\n-template <class FOUND>\n-inline void G1CardSet::iterate_cards_or_ranges_in_container(CardSetPtr const card_set, FOUND& found) {\n+template <class CardOrRangeVisitor>\n+inline void G1CardSet::iterate_cards_or_ranges_in_container(CardSetPtr const card_set, CardOrRangeVisitor& found) {\n@@ -103,0 +103,1 @@\n+\n","filename":"src\/hotspot\/share\/gc\/g1\/g1CardSet.inline.hpp","additions":3,"deletions":2,"binary":false,"changes":5,"status":"modified"},{"patch":"@@ -81,2 +81,2 @@\n-  template <class FOUND>\n-  void iterate(FOUND& found, uint const bits_per_card);\n+  template <class CardVisitor>\n+  void iterate(CardVisitor& found, uint const bits_per_card);\n@@ -164,2 +164,2 @@\n-  template <class FOUND>\n-  void iterate(FOUND& found);\n+  template <class CardVisitor>\n+  void iterate(CardVisitor& found);\n@@ -200,2 +200,2 @@\n-  template <class FOUND>\n-  void iterate(FOUND& found, size_t const size_in_bits, uint offset);\n+  template <class CardVisitor>\n+  void iterate(CardVisitor& found, size_t const size_in_bits, uint offset);\n@@ -227,0 +227,5 @@\n+  \/\/ Iterates over the given CardSetPtr with at index in this Howl card set,\n+  \/\/ applying a CardOrRangeVisitor on it.\n+  template <class CardOrRangeVisitor>\n+  void iterate_cardset(CardSetPtr const card_set, uint index, CardOrRangeVisitor& found, G1CardSetConfiguration* config);\n+\n@@ -236,8 +241,12 @@\n-  template <class FOUND>\n-  void iterate(FOUND& found, G1CardSetConfiguration* config);\n-\n-  template <class FOUND>\n-  void iterate(FOUND& found, uint num_card_sets);\n-\n-  template <class FOUND>\n-  void iterate_cardset(CardSetPtr const card_set, uint index, FOUND& found, G1CardSetConfiguration* config);\n+  \/\/ Iterates over all CardSetPtrs in this Howl card set, applying a CardOrRangeVisitor\n+  \/\/ on it.\n+  template <class CardOrRangeVisitor>\n+  void iterate(CardOrRangeVisitor& found, G1CardSetConfiguration* config);\n+\n+  \/\/ Iterates over all CardSetPtrs in this Howl card set. Calls\n+  \/\/\n+  \/\/   void operator ()(CardSetPtr* card_set_addr);\n+  \/\/\n+  \/\/ on all of them.\n+  template <class CardSetPtrVisitor>\n+  void iterate(CardSetPtrVisitor& found, uint num_card_sets);\n","filename":"src\/hotspot\/share\/gc\/g1\/g1CardSetContainers.hpp","additions":23,"deletions":14,"binary":false,"changes":37,"status":"modified"},{"patch":"@@ -90,2 +90,2 @@\n-template <class FOUND>\n-inline void G1CardSetInlinePtr::iterate(FOUND& found, uint bits_per_card) {\n+template <class CardVisitor>\n+inline void G1CardSetInlinePtr::iterate(CardVisitor& found, uint bits_per_card) {\n@@ -210,2 +210,2 @@\n-template <class FOUND>\n-void G1CardSetArray::iterate(FOUND& found) {\n+template <class CardVisitor>\n+void G1CardSetArray::iterate(CardVisitor& found) {\n@@ -239,2 +239,2 @@\n-template <class FOUND>\n-inline void G1CardSetBitMap::iterate(FOUND& found, size_t size_in_bits, uint offset) {\n+template <class CardVisitor>\n+inline void G1CardSetBitMap::iterate(CardVisitor& found, size_t size_in_bits, uint offset) {\n@@ -288,2 +288,2 @@\n-template <class FOUND>\n-inline void G1CardSetHowl::iterate(FOUND& found, G1CardSetConfiguration* config) {\n+template <class CardOrRangeVisitor>\n+inline void G1CardSetHowl::iterate(CardOrRangeVisitor& found, G1CardSetConfiguration* config) {\n@@ -295,2 +295,2 @@\n-template <class FOUND>\n-inline void G1CardSetHowl::iterate(FOUND& found, uint num_card_sets) {\n+template <class CardSetPtrVisitor>\n+inline void G1CardSetHowl::iterate(CardSetPtrVisitor& found, uint num_card_sets) {\n@@ -302,2 +302,2 @@\n-template <class FOUND>\n-inline void G1CardSetHowl::iterate_cardset(CardSetPtr const card_set, uint index, FOUND& found, G1CardSetConfiguration* config) {\n+template <class CardOrRangeVisitor>\n+inline void G1CardSetHowl::iterate_cardset(CardSetPtr const card_set, uint index, CardOrRangeVisitor& found, G1CardSetConfiguration* config) {\n","filename":"src\/hotspot\/share\/gc\/g1\/g1CardSetContainers.inline.hpp","additions":12,"deletions":12,"binary":false,"changes":24,"status":"modified"}]}