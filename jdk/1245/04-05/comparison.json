{"files":[{"patch":"@@ -4150,55 +4150,70 @@\n-    static const unsigned char VEC_ALIGN constant_block[160] = {\n-      \/\/ expand_permute_val, offset = 0\n-      ARRAY_TO_LXV_ORDER(\n-      0,  4,  5,  6,\n-      0,  7,  8,  9,\n-      0, 10, 11, 12,\n-      0, 13, 14, 15 ),\n-\n-      \/\/ expand_rshift_val, offset = 16\n-      ARRAY_TO_LXV_ORDER(\n-      0, 6, 4, 2,\n-      0, 6, 4, 2,\n-      0, 6, 4, 2,\n-      0, 6, 4, 2 ),\n-\n-      \/\/ expand_rshift_mask_val, offset = 32\n-      ARRAY_TO_LXV_ORDER(\n-      0b00000000, 0b00000011, 0b00001111, 0b00111111,\n-      0b00000000, 0b00000011, 0b00001111, 0b00111111,\n-      0b00000000, 0b00000011, 0b00001111, 0b00111111,\n-      0b00000000, 0b00000011, 0b00001111, 0b00111111 ),\n-\n-      \/\/ expand_lshift_val, offset = 48\n-      ARRAY_TO_LXV_ORDER(\n-      0, 2, 4, 0,\n-      0, 2, 4, 0,\n-      0, 2, 4, 0,\n-      0, 2, 4, 0 ),\n-\n-      \/\/ expand_lshift_mask_val, offset = 64\n-      ARRAY_TO_LXV_ORDER(\n-      0b00111111, 0b00111100, 0b00110000, 0b00000000,\n-      0b00111111, 0b00111100, 0b00110000, 0b00000000,\n-      0b00111111, 0b00111100, 0b00110000, 0b00000000,\n-      0b00111111, 0b00111100, 0b00110000, 0b00000000 ),\n-\n-      \/\/ base64_00_15, offset = 80\n-      ARRAY_TO_LXV_ORDER(\n-      'A','B','C','D','E','F','G','H','I','J','K','L','M','N','O','P' ),\n-\n-      \/\/ base64_16_31, offset = 96\n-      ARRAY_TO_LXV_ORDER(\n-      'Q','R','S','T','U','V','W','X','Y','Z','a','b','c','d','e','f' ),\n-\n-      \/\/ base64_32_47, offset = 112\n-      ARRAY_TO_LXV_ORDER(\n-      'g','h','i','j','k','l','m','n','o','p','q','r','s','t','u','v' ),\n-\n-      \/\/ base64_48_63, offset = 128\n-      ARRAY_TO_LXV_ORDER(\n-      'w','x','y','z','0','1','2','3','4','5','6','7','8','9','+','\/' ),\n-\n-      \/\/ base64_48_63_URL, offset = 144\n-      ARRAY_TO_LXV_ORDER(\n-      'w','x','y','z','0','1','2','3','4','5','6','7','8','9','-','_' ) };\n+    typedef struct {\n+      unsigned char expand_permute_val[16];\n+      unsigned char expand_rshift_val[16];\n+      unsigned char expand_rshift_mask_val[16];\n+      unsigned char expand_lshift_val[16];\n+      unsigned char expand_lshift_mask_val[16];\n+      unsigned char base64_00_15_val[16];\n+      unsigned char base64_16_31_val[16];\n+      unsigned char base64_32_47_val[16];\n+      unsigned char base64_48_63_val[16];\n+      unsigned char base64_48_63_URL_val[16];\n+    } constant_block;\n+\n+    static const constant_block VEC_ALIGN const_block = {\n+      .expand_permute_val = {\n+        ARRAY_TO_LXV_ORDER(\n+        0,  4,  5,  6,\n+        0,  7,  8,  9,\n+        0, 10, 11, 12,\n+        0, 13, 14, 15 ) },\n+\n+      .expand_rshift_val = {\n+        ARRAY_TO_LXV_ORDER(\n+        0, 6, 4, 2,\n+        0, 6, 4, 2,\n+        0, 6, 4, 2,\n+        0, 6, 4, 2 ) },\n+\n+      .expand_rshift_mask_val = {\n+        ARRAY_TO_LXV_ORDER(\n+        0b00000000, 0b00000011, 0b00001111, 0b00111111,\n+        0b00000000, 0b00000011, 0b00001111, 0b00111111,\n+        0b00000000, 0b00000011, 0b00001111, 0b00111111,\n+        0b00000000, 0b00000011, 0b00001111, 0b00111111 ) },\n+\n+      .expand_lshift_val = {\n+        ARRAY_TO_LXV_ORDER(\n+        0, 2, 4, 0,\n+        0, 2, 4, 0,\n+        0, 2, 4, 0,\n+        0, 2, 4, 0 ) },\n+\n+      .expand_lshift_mask_val = {\n+        ARRAY_TO_LXV_ORDER(\n+        0b00111111, 0b00111100, 0b00110000, 0b00000000,\n+        0b00111111, 0b00111100, 0b00110000, 0b00000000,\n+        0b00111111, 0b00111100, 0b00110000, 0b00000000,\n+        0b00111111, 0b00111100, 0b00110000, 0b00000000 ) },\n+\n+      .base64_00_15_val = {\n+        ARRAY_TO_LXV_ORDER(\n+        'A','B','C','D','E','F','G','H','I','J','K','L','M','N','O','P' ) },\n+\n+      .base64_16_31_val = {\n+        ARRAY_TO_LXV_ORDER(\n+        'Q','R','S','T','U','V','W','X','Y','Z','a','b','c','d','e','f' ) },\n+\n+      .base64_32_47_val = {\n+        ARRAY_TO_LXV_ORDER(\n+        'g','h','i','j','k','l','m','n','o','p','q','r','s','t','u','v' ) },\n+\n+      .base64_48_63_val = {\n+        ARRAY_TO_LXV_ORDER(\n+        'w','x','y','z','0','1','2','3','4','5','6','7','8','9','+','\/' ) },\n+\n+      .base64_48_63_URL_val = {\n+        ARRAY_TO_LXV_ORDER(\n+        'w','x','y','z','0','1','2','3','4','5','6','7','8','9','-','_' ) }\n+    };\n+    #define BLK_OFFSETOF(x) (offsetof(constant_block, x))\n@@ -4273,9 +4288,9 @@\n-    __ load_const_optimized(const_ptr, (address)&constant_block, tmp_reg);\n-    __ lxv(expand_permute, 0, const_ptr);\n-    __ lxv(expand_rshift->to_vsr(), 16, const_ptr);\n-    __ lxv(expand_rshift_mask->to_vsr(), 32, const_ptr);\n-    __ lxv(expand_lshift->to_vsr(), 48, const_ptr);\n-    __ lxv(expand_lshift_mask->to_vsr(), 64, const_ptr);\n-    __ lxv(vec_base64_00_15->to_vsr(), 80, const_ptr);\n-    __ lxv(vec_base64_16_31->to_vsr(), 96, const_ptr);\n-    __ lxv(vec_base64_32_47->to_vsr(), 112, const_ptr);\n+    __ load_const_optimized(const_ptr, (address)&const_block, tmp_reg);\n+    __ lxv(expand_permute,               BLK_OFFSETOF(expand_permute_val),     const_ptr);\n+    __ lxv(expand_rshift->to_vsr(),      BLK_OFFSETOF(expand_rshift_val),      const_ptr);\n+    __ lxv(expand_rshift_mask->to_vsr(), BLK_OFFSETOF(expand_rshift_mask_val), const_ptr);\n+    __ lxv(expand_lshift->to_vsr(),      BLK_OFFSETOF(expand_lshift_val),      const_ptr);\n+    __ lxv(expand_lshift_mask->to_vsr(), BLK_OFFSETOF(expand_lshift_mask_val), const_ptr);\n+    __ lxv(vec_base64_00_15->to_vsr(),   BLK_OFFSETOF(base64_00_15_val),       const_ptr);\n+    __ lxv(vec_base64_16_31->to_vsr(),   BLK_OFFSETOF(base64_16_31_val),       const_ptr);\n+    __ lxv(vec_base64_32_47->to_vsr(),   BLK_OFFSETOF(base64_32_47_val),       const_ptr);\n@@ -4292,1 +4307,1 @@\n-    __ lxv(vec_base64_48_63->to_vsr(), 144, const_ptr);\n+    __ lxv(vec_base64_48_63->to_vsr(), BLK_OFFSETOF(base64_48_63_URL_val), const_ptr);\n@@ -4296,1 +4311,1 @@\n-    __ lxv(vec_base64_48_63->to_vsr(), 128, const_ptr);\n+    __ lxv(vec_base64_48_63->to_vsr(), BLK_OFFSETOF(base64_48_63_val), const_ptr);\n","filename":"src\/hotspot\/cpu\/ppc\/stubGenerator_ppc.cpp","additions":81,"deletions":66,"binary":false,"changes":147,"status":"modified"}]}