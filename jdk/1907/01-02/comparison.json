{"files":[{"patch":"@@ -40,0 +40,2 @@\n+import java.awt.Rectangle;\n+\n@@ -44,1 +46,1 @@\n-import sun.awt.X11GraphicsDevice;\n+import sun.awt.X11GraphicsConfig;\n@@ -610,27 +612,12 @@\n-            long display = xclient.get_display();\n-            GraphicsEnvironment ge = GraphicsEnvironment.\n-                    getLocalGraphicsEnvironment();\n-            GraphicsDevice[] gds = ge.getScreenDevices();\n-            int gdslen = gds.length;\n-            XToolkit.awtLock();\n-            try {\n-                for (int i = 0; i < gdslen; i++) {\n-                    long screenRoot = XlibWrapper.RootWindow(display, i);\n-                    boolean pointerFound = XlibWrapper.XQueryPointer(\n-                            display, screenRoot,\n-                            XlibWrapper.larg1,  \/\/ root_return\n-                            XlibWrapper.larg2,  \/\/ child_return\n-                            XlibWrapper.larg3,  \/\/ xr_return\n-                            XlibWrapper.larg4,  \/\/ yr_return\n-                            XlibWrapper.larg5,  \/\/ xw_return\n-                            XlibWrapper.larg6,  \/\/ yw_return\n-                            XlibWrapper.larg7); \/\/ mask_return\n-                    if (pointerFound) {\n-                        GraphicsDevice device = gds[i];\n-                        if (device instanceof X11GraphicsDevice) {\n-                            int scale = ((X11GraphicsDevice) device).getScaleFactor();\n-                            x = XlibUtil.scaleDown(x, scale);\n-                            y = XlibUtil.scaleDown(y, scale);\n-                        }\n-                        break;\n-                    }\n+            GraphicsEnvironment ge = GraphicsEnvironment.getLocalGraphicsEnvironment();\n+            for (GraphicsDevice gd : ge.getScreenDevices()) {\n+                X11GraphicsConfig gc = (X11GraphicsConfig)gd.getDefaultConfiguration();\n+                Rectangle rt = gc.getBounds();\n+                rt.x      = gc.scaleUp(rt.x);\n+                rt.y      = gc.scaleUp(rt.y);\n+                rt.width  = gc.scaleUp(rt.width);\n+                rt.height = gc.scaleUp(rt.height);\n+                if (rt.contains(x, y)) {\n+                    x = gc.scaleDown(x);\n+                    y = gc.scaleDown(y);\n+                    break;\n@@ -638,2 +625,0 @@\n-            } finally {\n-                XToolkit.awtUnlock();\n","filename":"src\/java.desktop\/unix\/classes\/sun\/awt\/X11\/XDnDDropTargetProtocol.java","additions":15,"deletions":30,"binary":false,"changes":45,"status":"modified"}]}