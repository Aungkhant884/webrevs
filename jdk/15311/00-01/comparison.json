{"files":[{"patch":"@@ -28,0 +28,5 @@\n+ * @library \/tools\/lib\n+ * @modules\n+ *      jdk.compiler\/com.sun.tools.javac.api\n+ *      jdk.compiler\/com.sun.tools.javac.main\n+ * @build toolbox.ToolBox toolbox.JavacTask LocalExecutionTestSupport\n","filename":"test\/langtools\/jdk\/jshell\/LocalExecutionClassPathTest.java","additions":5,"deletions":0,"binary":false,"changes":5,"status":"modified"},{"patch":"@@ -28,0 +28,5 @@\n+ * @library \/tools\/lib\n+ * @modules\n+ *      jdk.compiler\/com.sun.tools.javac.api\n+ *      jdk.compiler\/com.sun.tools.javac.main\n+ * @build toolbox.ToolBox toolbox.JavacTask LocalExecutionTestSupport\n","filename":"test\/langtools\/jdk\/jshell\/LocalExecutionContextLoaderParentTest.java","additions":5,"deletions":0,"binary":false,"changes":5,"status":"modified"},{"patch":"@@ -27,2 +27,0 @@\n-import java.net.URL;\n-import org.testng.Assert;\n@@ -31,0 +29,4 @@\n+import toolbox.JavacTask;\n+import toolbox.TestRunner;\n+import toolbox.ToolBox;\n+\n@@ -37,26 +39,7 @@\n-    \/*\n-     * This is a classfile corresponding to this source:\n-     *\n-     *      package test;\n-     *      public class MyClass {\n-     *          public static final String FOO = \"bar\";\n-     *      }\n-     *\/\n-    private static final String MYCLASS =\n-          \"cafebabe0000003400120a0003000e07\"\n-        + \"000f070010010003464f4f0100124c6a\"\n-        + \"6176612f6c616e672f537472696e673b\"\n-        + \"01000d436f6e7374616e7456616c7565\"\n-        + \"0800110100063c696e69743e01000328\"\n-        + \"2956010004436f646501000f4c696e65\"\n-        + \"4e756d6265725461626c6501000a536f\"\n-        + \"7572636546696c6501000c4d79436c61\"\n-        + \"73732e6a6176610c0008000901000c74\"\n-        + \"6573742f4d79436c6173730100106a61\"\n-        + \"76612f6c616e672f4f626a6563740100\"\n-        + \"03626172002100020003000000010019\"\n-        + \"00040005000100060000000200070001\"\n-        + \"0001000800090001000a0000001d0001\"\n-        + \"0001000000052ab70001b10000000100\"\n-        + \"0b000000060001000000020001000c00\"\n-        + \"000002000d\";\n+    public static final String MY_CLASS_SOURCE = \"\"\"\n+        package test;\n+        public class MyClass {\n+            public static final String FOO = \"bar\";\n+        }\"\"\";\n+\n+    protected final ToolBox tb = new ToolBox();\n@@ -64,2 +47,3 @@\n-    \/\/ The classes directory containing \"test\/MyClass.class\"\n-    protected Path classesDir;\n+    protected Path baseDir;                 \/\/ base working directory\n+    protected Path sourcesDir;              \/\/ sources directory\n+    protected Path classesDir;              \/\/ classes directory\n@@ -70,5 +54,20 @@\n-        classesDir = Files.createTempDirectory(getClass().getSimpleName()).toAbsolutePath();\n-        Path testPkgDir = classesDir.resolve(\"test\");\n-        Path myclassFile = testPkgDir.resolve(\"MyClass.class\");\n-        Files.createDirectory(testPkgDir);\n-        Files.write(myclassFile, string2bytes(MYCLASS));\n+\n+        \/\/ Create directories\n+        baseDir = Files.createTempDirectory(getClass().getSimpleName()).toAbsolutePath();\n+        sourcesDir = createWorkSubdir(\"sources\");\n+        classesDir = createWorkSubdir(\"classes\");\n+\n+        \/\/ Create source file\n+        tb.writeJavaFiles(sourcesDir, MY_CLASS_SOURCE);\n+\n+        \/\/ Compile source file\n+        new JavacTask(tb)\n+            .outdir(classesDir)\n+            .files(sourcesDir.resolve(\"test\/MyClass.java\"))\n+            .run();\n+    }\n+\n+    protected Path createWorkSubdir(String name) throws IOException {\n+        Path dir = baseDir.resolve(name);\n+        Files.createDirectories(dir);\n+        return dir;\n@@ -83,9 +82,0 @@\n-\n-    protected byte[] string2bytes(String string) {\n-        byte[] buf = new byte[string.length() \/ 2];\n-        for (int i = 0; i < string.length(); i += 2) {\n-            int value = Integer.parseInt(string.substring(i, i + 2), 16);\n-            buf[i \/ 2] = (byte)value;\n-        }\n-        return buf;\n-    }\n","filename":"test\/langtools\/jdk\/jshell\/LocalExecutionTestSupport.java","additions":34,"deletions":44,"binary":false,"changes":78,"status":"modified"}]}