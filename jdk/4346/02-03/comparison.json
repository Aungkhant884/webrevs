{"files":[{"patch":"@@ -173,5 +173,5 @@\n-                                         jstring invokedName,\n-                                         jobject invokedType,\n-                                         jobject methodType,\n-                                         jobject implMethodMember,\n-                                         jobject instantiatedMethodType,\n+                                         jstring interfaceMethodName,\n+                                         jobject factoryType,\n+                                         jobject interfaceMethodType,\n+                                         jobject implementationMember,\n+                                         jobject dynamicMethodType,\n@@ -182,5 +182,5 @@\n-                                      jstring invokedName,\n-                                      jobject invokedType,\n-                                      jobject methodType,\n-                                      jobject implMethodMember,\n-                                      jobject instantiatedMethodType);\n+                                      jstring interfaceMethodName,\n+                                      jobject factoryType,\n+                                      jobject interfaceMethodType,\n+                                      jobject implementationMember,\n+                                      jobject dynamicMethodType);\n","filename":"src\/hotspot\/share\/include\/jvm.h","additions":10,"deletions":10,"binary":false,"changes":20,"status":"modified"},{"patch":"@@ -3523,5 +3523,5 @@\n-                                              jstring invokedName,\n-                                              jobject invokedType,\n-                                              jobject methodType,\n-                                              jobject implMethodMember,\n-                                              jobject instantiatedMethodType,\n+                                              jstring interfaceMethodName,\n+                                              jobject factoryType,\n+                                              jobject interfaceMethodType,\n+                                              jobject implementationMember,\n+                                              jobject dynamicMethodType,\n@@ -3547,3 +3547,3 @@\n-  Symbol* invoked_name = NULL;\n-  if (invokedName != NULL) {\n-    invoked_name = java_lang_String::as_symbol(JNIHandles::resolve_non_null(invokedName));\n+  Symbol* interface_method_name = NULL;\n+  if (interfaceMethodName != NULL) {\n+    interface_method_name = java_lang_String::as_symbol(JNIHandles::resolve_non_null(interfaceMethodName));\n@@ -3551,2 +3551,2 @@\n-  Handle invoked_type_oop(THREAD, JNIHandles::resolve_non_null(invokedType));\n-  Symbol* invoked_type = java_lang_invoke_MethodType::as_signature(invoked_type_oop(), true);\n+  Handle factory_type_oop(THREAD, JNIHandles::resolve_non_null(factoryType));\n+  Symbol* factory_type = java_lang_invoke_MethodType::as_signature(factory_type_oop(), true);\n@@ -3554,2 +3554,2 @@\n-  Handle method_type_oop(THREAD, JNIHandles::resolve_non_null(methodType));\n-  Symbol* method_type = java_lang_invoke_MethodType::as_signature(method_type_oop(), true);\n+  Handle interface_method_type_oop(THREAD, JNIHandles::resolve_non_null(interfaceMethodType));\n+  Symbol* interface_method_type = java_lang_invoke_MethodType::as_signature(interface_method_type_oop(), true);\n@@ -3557,3 +3557,3 @@\n-  Handle impl_method_member_oop(THREAD, JNIHandles::resolve_non_null(implMethodMember));\n-  assert(java_lang_invoke_MemberName::is_method(impl_method_member_oop()), \"must be\");\n-  Method* m = java_lang_invoke_MemberName::vmtarget(impl_method_member_oop());\n+  Handle implementation_member_oop(THREAD, JNIHandles::resolve_non_null(implementationMember));\n+  assert(java_lang_invoke_MemberName::is_method(implementation_member_oop()), \"must be\");\n+  Method* m = java_lang_invoke_MemberName::vmtarget(implementation_member_oop());\n@@ -3561,2 +3561,2 @@\n-  Handle instantiated_method_type_oop(THREAD, JNIHandles::resolve_non_null(instantiatedMethodType));\n-  Symbol* instantiated_method_type = java_lang_invoke_MethodType::as_signature(instantiated_method_type_oop(), true);\n+  Handle dynamic_method_type_oop(THREAD, JNIHandles::resolve_non_null(dynamicMethodType));\n+  Symbol* dynamic_method_type = java_lang_invoke_MethodType::as_signature(dynamic_method_type_oop(), true);\n@@ -3564,2 +3564,2 @@\n-  SystemDictionaryShared::add_lambda_proxy_class(caller_ik, lambda_ik, invoked_name, invoked_type,\n-                                                 method_type, m, instantiated_method_type, THREAD);\n+  SystemDictionaryShared::add_lambda_proxy_class(caller_ik, lambda_ik, interface_method_name, factory_type,\n+                                                 interface_method_type, m, dynamic_method_type, THREAD);\n@@ -3571,5 +3571,5 @@\n-                                                        jstring invokedName,\n-                                                        jobject invokedType,\n-                                                        jobject methodType,\n-                                                        jobject implMethodMember,\n-                                                        jobject instantiatedMethodType))\n+                                                        jstring interfaceMethodName,\n+                                                        jobject factoryType,\n+                                                        jobject interfaceMethodType,\n+                                                        jobject implementationMember,\n+                                                        jobject dynamicMethodType))\n@@ -3578,2 +3578,2 @@\n-  if (invokedName == NULL || invokedType == NULL || methodType == NULL ||\n-      implMethodMember == NULL || instantiatedMethodType == NULL) {\n+  if (interfaceMethodName == NULL || factoryType == NULL || interfaceMethodType == NULL ||\n+      implementationMember == NULL || dynamicMethodType == NULL) {\n@@ -3590,3 +3590,3 @@\n-  Symbol* invoked_name = java_lang_String::as_symbol(JNIHandles::resolve_non_null(invokedName));\n-  Handle invoked_type_oop(THREAD, JNIHandles::resolve_non_null(invokedType));\n-  Symbol* invoked_type = java_lang_invoke_MethodType::as_signature(invoked_type_oop(), true);\n+  Symbol* interface_method_name = java_lang_String::as_symbol(JNIHandles::resolve_non_null(interfaceMethodName));\n+  Handle factory_type_oop(THREAD, JNIHandles::resolve_non_null(factoryType));\n+  Symbol* factory_type = java_lang_invoke_MethodType::as_signature(factory_type_oop(), true);\n@@ -3594,2 +3594,2 @@\n-  Handle method_type_oop(THREAD, JNIHandles::resolve_non_null(methodType));\n-  Symbol* method_type = java_lang_invoke_MethodType::as_signature(method_type_oop(), true);\n+  Handle interface_method_type_oop(THREAD, JNIHandles::resolve_non_null(interfaceMethodType));\n+  Symbol* interface_method_type = java_lang_invoke_MethodType::as_signature(interface_method_type_oop(), true);\n@@ -3597,3 +3597,3 @@\n-  Handle impl_method_member_oop(THREAD, JNIHandles::resolve_non_null(implMethodMember));\n-  assert(java_lang_invoke_MemberName::is_method(impl_method_member_oop()), \"must be\");\n-  Method* m = java_lang_invoke_MemberName::vmtarget(impl_method_member_oop());\n+  Handle implementation_member_oop(THREAD, JNIHandles::resolve_non_null(implementationMember));\n+  assert(java_lang_invoke_MemberName::is_method(implementation_member_oop()), \"must be\");\n+  Method* m = java_lang_invoke_MemberName::vmtarget(implementation_member_oop());\n@@ -3601,2 +3601,2 @@\n-  Handle instantiated_method_type_oop(THREAD, JNIHandles::resolve_non_null(instantiatedMethodType));\n-  Symbol* instantiated_method_type = java_lang_invoke_MethodType::as_signature(instantiated_method_type_oop(), true);\n+  Handle dynamic_method_type_oop(THREAD, JNIHandles::resolve_non_null(dynamicMethodType));\n+  Symbol* dynamic_method_type = java_lang_invoke_MethodType::as_signature(dynamic_method_type_oop(), true);\n@@ -3604,2 +3604,2 @@\n-  InstanceKlass* lambda_ik = SystemDictionaryShared::get_shared_lambda_proxy_class(caller_ik, invoked_name, invoked_type,\n-                                                                                   method_type, m, instantiated_method_type);\n+  InstanceKlass* lambda_ik = SystemDictionaryShared::get_shared_lambda_proxy_class(caller_ik, interface_method_name, factory_type,\n+                                                                                   interface_method_type, m, dynamic_method_type);\n","filename":"src\/hotspot\/share\/prims\/jvm.cpp","additions":38,"deletions":38,"binary":false,"changes":76,"status":"modified"},{"patch":"@@ -41,5 +41,5 @@\n-                                            String invokedName,\n-                                            MethodType invokedType,\n-                                            MethodType samMethodType,\n-                                            MemberName implMethod,\n-                                            MethodType instantiatedMethodType,\n+                                            String interfaceMethodName,\n+                                            MethodType factoryType,\n+                                            MethodType interfaceMethodType,\n+                                            MemberName implementationMember,\n+                                            MethodType dynamicMethodType,\n@@ -49,5 +49,5 @@\n-                                                   String invokedName,\n-                                                   MethodType invokedType,\n-                                                   MethodType samMethodType,\n-                                                   MemberName implMethod,\n-                                                   MethodType instantiatedMethodType);\n+                                                   String interfaceMethodName,\n+                                                   MethodType factoryType,\n+                                                   MethodType interfaceMethodType,\n+                                                   MemberName implementationMember,\n+                                                   MethodType dynamicMethodType);\n@@ -65,5 +65,5 @@\n-                            String invokedName,\n-                            MethodType invokedType,\n-                            MethodType samMethodType,\n-                            MethodHandle implMethod,\n-                            MethodType instantiatedMethodType,\n+                            String interfaceMethodName,\n+                            MethodType factoryType,\n+                            MethodType interfaceMethodType,\n+                            MethodHandle implementation,\n+                            MethodType dynamicMethodType,\n@@ -71,2 +71,2 @@\n-                            Class<?>[] markerInterfaces,\n-                            MethodType[] additionalBridges,\n+                            Class<?>[] altInterfaces,\n+                            MethodType[] altMethods,\n@@ -78,3 +78,3 @@\n-            !isSerializable && markerInterfaces.length == 0 && additionalBridges.length == 0) {\n-            addToArchive(caller, invokedName, invokedType, samMethodType,\n-                         implMethod.internalMemberName(), instantiatedMethodType,\n+            !isSerializable && altInterfaces.length == 0 && altMethods.length == 0) {\n+            addToArchive(caller, interfaceMethodName, factoryType, interfaceMethodType,\n+                         implementation.internalMemberName(), dynamicMethodType,\n@@ -96,5 +96,5 @@\n-                         String invokedName,\n-                         MethodType invokedType,\n-                         MethodType samMethodType,\n-                         MethodHandle implMethod,\n-                         MethodType instantiatedMethodType,\n+                         String interfaceMethodName,\n+                         MethodType factoryType,\n+                         MethodType interfaceMethodType,\n+                         MethodHandle implementation,\n+                         MethodType dynamicMethodType,\n@@ -102,2 +102,2 @@\n-                         Class<?>[] markerInterfaces,\n-                         MethodType[] additionalBridges) {\n+                         Class<?>[] altInterfaces,\n+                         MethodType[] altMethods) {\n@@ -108,1 +108,1 @@\n-            !CDS.isSharingEnabled() || isSerializable || markerInterfaces.length > 0 || additionalBridges.length > 0)\n+            !CDS.isSharingEnabled() || isSerializable || altInterfaces.length > 0 || altMethods.length > 0)\n@@ -111,2 +111,2 @@\n-        return findFromArchive(caller, invokedName, invokedType, samMethodType,\n-                               implMethod.internalMemberName(), instantiatedMethodType);\n+        return findFromArchive(caller, interfaceMethodName, factoryType, interfaceMethodType,\n+                               implementation.internalMemberName(), dynamicMethodType);\n","filename":"src\/java.base\/share\/classes\/java\/lang\/invoke\/LambdaProxyClassArchive.java","additions":30,"deletions":30,"binary":false,"changes":60,"status":"modified"},{"patch":"@@ -36,5 +36,5 @@\n-                                                               jstring invokedName,\n-                                                               jobject invokedType,\n-                                                               jobject methodType,\n-                                                               jobject implMethodMember,\n-                                                               jobject instantiatedMethodType,\n+                                                               jstring interfaceMethodName,\n+                                                               jobject factoryType,\n+                                                               jobject interfaceMethodType,\n+                                                               jobject implementationMember,\n+                                                               jobject dynamicMethodType,\n@@ -42,3 +42,3 @@\n-    JVM_RegisterLambdaProxyClassForArchiving(env, caller, invokedName, invokedType,\n-                                             methodType, implMethodMember,\n-                                             instantiatedMethodType, lambdaProxyClass);\n+    JVM_RegisterLambdaProxyClassForArchiving(env, caller, interfaceMethodName, factoryType,\n+                                             interfaceMethodType, implementationMember,\n+                                             dynamicMethodType, lambdaProxyClass);\n@@ -50,8 +50,8 @@\n-                                                            jstring invokedName,\n-                                                            jobject invokedType,\n-                                                            jobject methodType,\n-                                                            jobject implMethodMember,\n-                                                            jobject instantiatedMethodType) {\n-    return JVM_LookupLambdaProxyClassFromArchive(env, caller, invokedName, invokedType,\n-                                                 methodType, implMethodMember,\n-                                                 instantiatedMethodType);\n+                                                            jstring interfaceMethodName,\n+                                                            jobject factoryType,\n+                                                            jobject interfaceMethodType,\n+                                                            jobject implementationMember,\n+                                                            jobject dynamicMethodType) {\n+    return JVM_LookupLambdaProxyClassFromArchive(env, caller, interfaceMethodName, factoryType,\n+                                                 interfaceMethodType, implementationMember,\n+                                                 dynamicMethodType);\n","filename":"src\/java.base\/share\/native\/libjava\/LambdaProxyClassArchive.c","additions":16,"deletions":16,"binary":false,"changes":32,"status":"modified"}]}