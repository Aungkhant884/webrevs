{"files":[{"patch":"@@ -4451,1 +4451,20 @@\n-  predicate(vector_element_basic_type(n->in(2)) == T_LONG); \/\/ src2\n+  predicate(vector_element_basic_type(n->in(2)) == T_LONG && !VM_Version::supports_avx512dq());\n+  match(Set dst (AddReductionVL src1 src2));\n+  match(Set dst (MulReductionVL src1 src2));\n+  match(Set dst (AndReductionV  src1 src2));\n+  match(Set dst ( OrReductionV  src1 src2));\n+  match(Set dst (XorReductionV  src1 src2));\n+  match(Set dst (MinReductionV  src1 src2));\n+  match(Set dst (MaxReductionV  src1 src2));\n+  effect(TEMP vtmp1, TEMP vtmp2);\n+  format %{ \"vector_reduction_long $dst,$src1,$src2 ; using $vtmp1, $vtmp2 as TEMP\" %}\n+  ins_encode %{\n+    int opcode = this->ideal_Opcode();\n+    int vlen = vector_length(this, $src2);\n+    __ reduceL(opcode, vlen, $dst$$Register, $src1$$Register, $src2$$XMMRegister, $vtmp1$$XMMRegister, $vtmp2$$XMMRegister);\n+  %}\n+  ins_pipe( pipe_slow );\n+%}\n+\n+instruct reductionL_avx512dq(rRegL dst, rRegL src1, vec src2, vec vtmp1, vec vtmp2) %{\n+  predicate(vector_element_basic_type(n->in(2)) == T_LONG && VM_Version::supports_avx512dq());\n@@ -4562,1 +4581,19 @@\n-  predicate(vector_element_basic_type(n->in(2)) == T_BYTE); \/\/ src2\n+  predicate(vector_element_basic_type(n->in(2)) == T_BYTE && !VM_Version::supports_avx512bw());\n+  match(Set dst (AddReductionVI src1 src2));\n+  match(Set dst (AndReductionV  src1 src2));\n+  match(Set dst ( OrReductionV  src1 src2));\n+  match(Set dst (XorReductionV  src1 src2));\n+  match(Set dst (MinReductionV  src1 src2));\n+  match(Set dst (MaxReductionV  src1 src2));\n+  effect(TEMP vtmp1, TEMP vtmp2);\n+  format %{ \"vector_reduction_byte $dst,$src1,$src2 ; using $vtmp1, $vtmp2 as TEMP\" %}\n+  ins_encode %{\n+    int opcode = this->ideal_Opcode();\n+    int vlen = vector_length(this, $src2);\n+    __ reduceB(opcode, vlen, $dst$$Register, $src1$$Register, $src2$$XMMRegister, $vtmp1$$XMMRegister, $vtmp2$$XMMRegister);\n+  %}\n+  ins_pipe( pipe_slow );\n+%}\n+\n+instruct reductionB_avx512bw(rRegI dst, rRegI src1, vec src2, vec vtmp1, vec vtmp2) %{\n+  predicate(vector_element_basic_type(n->in(2)) == T_BYTE && VM_Version::supports_avx512bw());\n","filename":"src\/hotspot\/cpu\/x86\/x86.ad","additions":39,"deletions":2,"binary":false,"changes":41,"status":"modified"}]}