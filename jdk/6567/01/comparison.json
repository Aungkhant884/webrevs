{"files":[{"patch":"@@ -138,2 +138,2 @@\n-    uint num_cards_in_inline_ptr = G1CardSetConfiguration::num_cards_in_inline_ptr(HeapRegion::LogOfHRGrainBytes - CardTable::card_shift);\n-    FLAG_SET_ERGO(G1RemSetArrayOfCardsEntries, MAX2(num_cards_in_inline_ptr * 2,\n+    uint max_cards_in_inline_ptr = G1CardSetConfiguration::max_cards_in_inline_ptr(HeapRegion::LogOfHRGrainBytes - CardTable::card_shift);\n+    FLAG_SET_ERGO(G1RemSetArrayOfCardsEntries, MAX2(max_cards_in_inline_ptr * 2,\n","filename":"src\/hotspot\/share\/gc\/g1\/g1Arguments.cpp","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -60,1 +60,1 @@\n-                         G1RemSetArrayOfCardsEntries,                               \/* num_cards_in_array *\/\n+                         G1RemSetArrayOfCardsEntries,                               \/* max_cards_in_array *\/\n@@ -71,1 +71,1 @@\n-G1CardSetConfiguration::G1CardSetConfiguration(uint num_cards_in_array,\n+G1CardSetConfiguration::G1CardSetConfiguration(uint max_cards_in_array,\n@@ -78,1 +78,1 @@\n-                         num_cards_in_array,                                   \/* num_cards_in_array *\/\n+                         max_cards_in_array,                                   \/* max_cards_in_array *\/\n@@ -81,1 +81,1 @@\n-                                                    num_cards_in_array,\n+                                                    max_cards_in_array,\n@@ -89,1 +89,1 @@\n-                                               uint num_cards_in_array,\n+                                               uint max_cards_in_array,\n@@ -96,1 +96,1 @@\n-  _num_cards_in_array(num_cards_in_array),\n+  _max_cards_in_array(max_cards_in_array),\n@@ -100,4 +100,4 @@\n-  _num_cards_in_howl_bitmap(G1CardSetHowl::bitmap_size(_max_cards_in_card_set, _num_buckets_in_howl)),\n-  _cards_in_howl_bitmap_threshold(_num_cards_in_howl_bitmap * cards_in_bitmap_threshold_percent),\n-  _log2_num_cards_in_howl_bitmap(log2i_exact(_num_cards_in_howl_bitmap)),\n-  _bitmap_hash_mask(~(~(0) << _log2_num_cards_in_howl_bitmap)),\n+  _max_cards_in_howl_bitmap(G1CardSetHowl::bitmap_size(_max_cards_in_card_set, _num_buckets_in_howl)),\n+  _cards_in_howl_bitmap_threshold(_max_cards_in_howl_bitmap * cards_in_bitmap_threshold_percent),\n+  _log2_max_cards_in_howl_bitmap(log2i_exact(_max_cards_in_howl_bitmap)),\n+  _bitmap_hash_mask(~(~(0) << _log2_max_cards_in_howl_bitmap)),\n@@ -121,2 +121,2 @@\n-  new (&_card_set_alloc_options[1]) G1CardSetAllocOptions((uint)G1CardSetArray::size_in_bytes(_num_cards_in_array), 2, 256);\n-  new (&_card_set_alloc_options[2]) G1CardSetAllocOptions((uint)G1CardSetBitMap::size_in_bytes(_num_cards_in_howl_bitmap), 2, 256);\n+  new (&_card_set_alloc_options[1]) G1CardSetAllocOptions((uint)G1CardSetArray::size_in_bytes(_max_cards_in_array), 2, 256);\n+  new (&_card_set_alloc_options[2]) G1CardSetAllocOptions((uint)G1CardSetBitMap::size_in_bytes(_max_cards_in_howl_bitmap), 2, 256);\n@@ -133,2 +133,2 @@\n-                          num_cards_in_inline_ptr(), sizeof(void*),\n-                          num_cards_in_array(), G1CardSetArray::size_in_bytes(num_cards_in_array()),\n+                          max_cards_in_inline_ptr(), sizeof(void*),\n+                          max_cards_in_array(), G1CardSetArray::size_in_bytes(max_cards_in_array()),\n@@ -136,1 +136,1 @@\n-                          num_cards_in_howl_bitmap(), G1CardSetBitMap::size_in_bytes(num_cards_in_howl_bitmap()), cards_in_howl_bitmap_threshold(),\n+                          max_cards_in_howl_bitmap(), G1CardSetBitMap::size_in_bytes(max_cards_in_howl_bitmap()), cards_in_howl_bitmap_threshold(),\n@@ -141,2 +141,2 @@\n-uint G1CardSetConfiguration::num_cards_in_inline_ptr() const {\n-  return num_cards_in_inline_ptr(_inline_ptr_bits_per_card);\n+uint G1CardSetConfiguration::max_cards_in_inline_ptr() const {\n+  return max_cards_in_inline_ptr(_inline_ptr_bits_per_card);\n@@ -145,1 +145,1 @@\n-uint G1CardSetConfiguration::num_cards_in_inline_ptr(uint bits_per_card) {\n+uint G1CardSetConfiguration::max_cards_in_inline_ptr(uint bits_per_card) {\n@@ -511,1 +511,1 @@\n-  return bitmap->add(card_offset, _config->cards_in_howl_bitmap_threshold(), _config->num_cards_in_howl_bitmap());\n+  return bitmap->add(card_offset, _config->cards_in_howl_bitmap_threshold(), _config->max_cards_in_howl_bitmap());\n@@ -516,1 +516,1 @@\n-  return value.add(card_in_region, _config->inline_ptr_bits_per_card(), _config->num_cards_in_inline_ptr());\n+  return value.add(card_in_region, _config->inline_ptr_bits_per_card(), _config->max_cards_in_inline_ptr());\n@@ -523,1 +523,1 @@\n-    uint const size_in_bits = _config->num_cards_in_howl_bitmap();\n+    uint const size_in_bits = _config->max_cards_in_howl_bitmap();\n@@ -552,1 +552,1 @@\n-      uint const size = _config->num_cards_in_array();\n+      uint const size = _config->max_cards_in_array();\n@@ -629,1 +629,1 @@\n-    uint diff = _config->num_cards_in_howl_bitmap() - card_set_ptr<G1CardSetBitMap>(source_card_set)->num_bits_set();\n+    uint diff = _config->max_cards_in_howl_bitmap() - card_set_ptr<G1CardSetBitMap>(source_card_set)->num_bits_set();\n@@ -758,1 +758,1 @@\n-    case CardSetBitMap: return card_set_ptr<G1CardSetBitMap>(card_set)->contains(card_in_region, _config->num_cards_in_howl_bitmap());\n+    case CardSetBitMap: return card_set_ptr<G1CardSetBitMap>(card_set)->contains(card_in_region, _config->max_cards_in_howl_bitmap());\n","filename":"src\/hotspot\/share\/gc\/g1\/g1CardSet.cpp","additions":24,"deletions":24,"binary":false,"changes":48,"status":"modified"},{"patch":"@@ -53,1 +53,1 @@\n-  uint _num_cards_in_array;\n+  uint _max_cards_in_array;\n@@ -57,1 +57,1 @@\n-  uint _num_cards_in_howl_bitmap;\n+  uint _max_cards_in_howl_bitmap;\n@@ -59,1 +59,1 @@\n-  uint _log2_num_cards_in_howl_bitmap;\n+  uint _log2_max_cards_in_howl_bitmap;\n@@ -67,1 +67,1 @@\n-                         uint num_cards_in_array,\n+                         uint max_cards_in_array,\n@@ -82,1 +82,1 @@\n-  G1CardSetConfiguration(uint num_cards_in_array,\n+  G1CardSetConfiguration(uint max_cards_in_array,\n@@ -93,2 +93,2 @@\n-  uint num_cards_in_inline_ptr() const;\n-  static uint num_cards_in_inline_ptr(uint bits_per_card);\n+  uint max_cards_in_inline_ptr() const;\n+  static uint max_cards_in_inline_ptr(uint bits_per_card);\n@@ -97,2 +97,1 @@\n-  bool use_cards_in_array() const { return _num_cards_in_array != 0; } \/\/ Unused for now\n-  \/\/ Number of cards in \"Array of Cards\" set; 0 to disable.\n+  \/\/ Maximum number of cards in \"Array of Cards\" set; 0 to disable.\n@@ -100,1 +99,1 @@\n-  uint num_cards_in_array() const { return _num_cards_in_array; }\n+  uint max_cards_in_array() const { return _max_cards_in_array; }\n@@ -103,2 +102,1 @@\n-  bool use_cards_in_howl_bitmap() const { return _num_cards_in_howl_bitmap != 0; } \/\/ Unused for now\n-  uint num_cards_in_howl_bitmap() const { return _num_cards_in_howl_bitmap; }\n+  uint max_cards_in_howl_bitmap() const { return _max_cards_in_howl_bitmap; }\n@@ -107,1 +105,1 @@\n-  uint log2_num_cards_in_howl_bitmap() const {return _log2_num_cards_in_howl_bitmap;}\n+  uint log2_max_cards_in_howl_bitmap() const {return _log2_max_cards_in_howl_bitmap;}\n@@ -115,1 +113,1 @@\n-  uint howl_bucket_index(uint card_idx) { return card_idx >> _log2_num_cards_in_howl_bitmap; }\n+  uint howl_bucket_index(uint card_idx) { return card_idx >> _log2_max_cards_in_howl_bitmap; }\n","filename":"src\/hotspot\/share\/gc\/g1\/g1CardSet.hpp","additions":12,"deletions":14,"binary":false,"changes":26,"status":"modified"},{"patch":"@@ -255,1 +255,1 @@\n-  _num_entries((config->num_cards_in_array() + 1)) \/* Card Transfer will not increment _num_entries *\/ {\n+  _num_entries((config->max_cards_in_array() + 1)) \/* Card Transfer will not increment _num_entries *\/ {\n@@ -262,1 +262,1 @@\n-      value.add(card_in_region, config->inline_ptr_bits_per_card(), config->num_cards_in_inline_ptr());\n+      value.add(card_in_region, config->inline_ptr_bits_per_card(), config->max_cards_in_inline_ptr());\n@@ -278,1 +278,1 @@\n-      return G1CardSet::card_set_ptr<G1CardSetBitMap>(card_set)->contains(card_offset, config->num_cards_in_howl_bitmap());\n+      return G1CardSet::card_set_ptr<G1CardSetBitMap>(card_set)->contains(card_offset, config->max_cards_in_howl_bitmap());\n@@ -324,2 +324,2 @@\n-        uint offset = index << config->log2_num_cards_in_howl_bitmap();\n-        G1CardSet::card_set_ptr<G1CardSetBitMap>(card_set)->iterate(found, config->num_cards_in_howl_bitmap(), offset);\n+        uint offset = index << config->log2_max_cards_in_howl_bitmap();\n+        G1CardSet::card_set_ptr<G1CardSetBitMap>(card_set)->iterate(found, config->max_cards_in_howl_bitmap(), offset);\n@@ -332,2 +332,2 @@\n-        uint offset = index << config->log2_num_cards_in_howl_bitmap();\n-        found(offset, config->num_cards_in_howl_bitmap());\n+        uint offset = index << config->log2_max_cards_in_howl_bitmap();\n+        found(offset, config->max_cards_in_howl_bitmap());\n@@ -340,1 +340,1 @@\n-inline G1CardSetHowl::EntryCountType G1CardSetHowl::num_buckets(size_t size_in_bits, size_t num_cards_in_array, size_t max_num_buckets) {\n+inline G1CardSetHowl::EntryCountType G1CardSetHowl::num_buckets(size_t size_in_bits, size_t max_cards_in_array, size_t max_num_buckets) {\n@@ -345,1 +345,1 @@\n-  size_t size_array_bytes = num_cards_in_array * sizeof(G1CardSetArray::EntryDataType);\n+  size_t size_array_bytes = max_cards_in_array * sizeof(G1CardSetArray::EntryDataType);\n","filename":"src\/hotspot\/share\/gc\/g1\/g1CardSetContainers.inline.hpp","additions":9,"deletions":9,"binary":false,"changes":18,"status":"modified"},{"patch":"@@ -346,1 +346,1 @@\n-    G1AddCardResult res = card_set.add_card(99, config.num_cards_in_howl_bitmap() - 1);\n+    G1AddCardResult res = card_set.add_card(99, config.max_cards_in_howl_bitmap() - 1);\n@@ -349,1 +349,1 @@\n-    ASSERT_TRUE(config.num_cards_in_howl_bitmap() == card_set.occupied());\n+    ASSERT_TRUE(config.max_cards_in_howl_bitmap() == card_set.occupied());\n@@ -351,1 +351,1 @@\n-    res = card_set.add_card(99, config.num_cards_in_howl_bitmap() - 2);\n+    res = card_set.add_card(99, config.max_cards_in_howl_bitmap() - 2);\n@@ -356,1 +356,1 @@\n-    i = config.num_cards_in_howl_bitmap();\n+    i = config.max_cards_in_howl_bitmap();\n","filename":"test\/hotspot\/gtest\/gc\/g1\/test_g1CardSet.cpp","additions":4,"deletions":4,"binary":false,"changes":8,"status":"modified"}]}