{"files":[{"patch":"@@ -231,4 +231,1 @@\n-            for (var entry : connections.entrySet()) {\n-                connections.values().forEach(this::close);\n-                connections.remove(entry.getKey(), entry.getValue());\n-            }\n+            connections.values().forEach(this::close);\n","filename":"src\/java.net.http\/share\/classes\/jdk\/internal\/net\/http\/Http2ClientImpl.java","additions":1,"deletions":4,"binary":false,"changes":5,"status":"modified"},{"patch":"@@ -181,1 +181,0 @@\n-                subscriber = responseSubscriber = pendingResponseSubscriber;\n@@ -184,0 +183,1 @@\n+                subscriber = responseSubscriber = pendingResponseSubscriber;\n@@ -195,3 +195,3 @@\n-                    if (endStreamReceived()) {\n-                        \/\/ If END_STREAM is already received, we should not receive any new RST_STREAM frames and\n-                        \/\/ close the connection gracefully by processing all remaining frames in the inputQ.\n+                    if (endStreamReceived() && rf.getErrorCode() ==  ResetFrame.NO_ERROR) {\n+                        \/\/ If END_STREAM is already received, complete the requestBodyCF successfully\n+                        \/\/ and stop sending any request data.\n@@ -586,1 +586,2 @@\n-        Flow.Subscriber<?> subscriber = responseSubscriber == null ? pendingResponseSubscriber : responseSubscriber;\n+        Flow.Subscriber<?> subscriber = responseSubscriber;\n+        if (subscriber == null) subscriber = pendingResponseSubscriber;\n","filename":"src\/java.net.http\/share\/classes\/jdk\/internal\/net\/http\/Stream.java","additions":6,"deletions":5,"binary":false,"changes":11,"status":"modified"}]}