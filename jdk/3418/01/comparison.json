{"files":[{"patch":"@@ -191,2 +191,2 @@\n-void DictionaryEntry::add_protection_domain(Dictionary* dict, Handle protection_domain) {\n-  assert_locked_or_safepoint(SystemDictionary_lock);\n+void DictionaryEntry::add_protection_domain(ClassLoaderData* loader_data, Handle protection_domain) {\n+  assert_lock_strong(SystemDictionary_lock);\n@@ -194,1 +194,1 @@\n-    ProtectionDomainCacheEntry* entry = SystemDictionary::cache_get(protection_domain);\n+    ProtectionDomainCacheEntry* entry = SystemDictionary::pd_cache_table()->get(protection_domain);\n@@ -201,0 +201,1 @@\n+    ResourceMark rm;\n@@ -202,0 +203,6 @@\n+    ls.print(\"adding protection domain for class %s\", instance_klass()->name()->as_C_string());\n+    ls.print(\" class loader: \");\n+    loader_data->class_loader()->print_value_on(&ls);\n+    ls.print(\" protection domain: \");\n+    protection_domain->print_value_on(&ls);\n+    ls.print(\" \");\n@@ -338,1 +345,1 @@\n-  entry->add_protection_domain(this, protection_domain);\n+  entry->add_protection_domain(loader_data(), protection_domain);\n","filename":"src\/hotspot\/share\/classfile\/dictionary.cpp","additions":11,"deletions":4,"binary":false,"changes":15,"status":"modified"},{"patch":"@@ -131,1 +131,1 @@\n-  void add_protection_domain(Dictionary* dict, Handle protection_domain);\n+  void add_protection_domain(ClassLoaderData* loader_data, Handle protection_domain);\n","filename":"src\/hotspot\/share\/classfile\/dictionary.hpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -2431,5 +2431,0 @@\n-\/\/ Protection domain cache table handling\n-\n-ProtectionDomainCacheEntry* SystemDictionary::cache_get(Handle protection_domain) {\n-  return _pd_cache_table->get(protection_domain);\n-}\n","filename":"src\/hotspot\/share\/classfile\/systemDictionary.cpp","additions":0,"deletions":5,"binary":false,"changes":5,"status":"modified"},{"patch":"@@ -296,2 +296,0 @@\n-  static ProtectionDomainCacheEntry* cache_get(Handle protection_domain);\n-\n","filename":"src\/hotspot\/share\/classfile\/systemDictionary.hpp","additions":0,"deletions":2,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -47,1 +47,1 @@\n-        .shouldContain(\"[protectiondomain] pd set count = #\");\n+        .shouldContain(\"[protectiondomain] adding protection domain for class\");\n@@ -56,1 +56,1 @@\n-        .shouldNotContain(\"pd set count = #\");\n+        .shouldNotContain(\"[protectiondomain] adding protection domain for class\");\n","filename":"test\/hotspot\/jtreg\/runtime\/logging\/ProtectionDomainVerificationTest.java","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"}]}