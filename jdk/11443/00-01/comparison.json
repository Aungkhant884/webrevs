{"files":[{"patch":"@@ -131,9 +131,0 @@\n-    # Want to check the filetype using file, to see if we got served a HTML error page.\n-    # This is sensitive to the filename containing a specific string, but good enough.\n-    file ${installed_jib_script}.gz | grep \"gzip compressed data\" > \/dev\/null\n-    if [ $? -ne 0 ]; then \n-        echo \"Warning: ${installed_jib_script}.gz is not a gzip file.\"\n-        echo \"If you are behind a proxy you may need to configure exceptions using no_proxy.\"\n-        echo \"The download URL was: ${jib_url}\"\n-        exit 1\n-    fi\n","filename":"bin\/jib.sh","additions":0,"deletions":9,"binary":false,"changes":9,"status":"modified"},{"patch":"@@ -8,13 +8,5 @@\n-  <style>\n-    code{white-space: pre-wrap;}\n-    span.smallcaps{font-variant: small-caps;}\n-    div.columns{display: flex; gap: min(4vw, 1.5em);}\n-    div.column{flex: auto; overflow-x: auto;}\n-    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}\n-    ul.task-list{list-style: none;}\n-    ul.task-list li input[type=\"checkbox\"] {\n-      width: 0.8em;\n-      margin: 0 0.8em 0.2em -1.6em;\n-      vertical-align: middle;\n-    }\n-    .display.math{display: block; text-align: center; margin: 0.5rem auto;}\n+  <style type=\"text\/css\">\n+      code{white-space: pre-wrap;}\n+      span.smallcaps{font-variant: small-caps;}\n+      span.underline{text-decoration: underline;}\n+      div.column{display: inline-block; vertical-align: top; width: 50%;}\n@@ -23,1 +15,0 @@\n-  <style type=\"text\/css\">pre, code, tt { color: #1d6ae5; }<\/style>\n@@ -27,0 +18,1 @@\n+  <style type=\"text\/css\">pre, code, tt { color: #1d6ae5; }<\/style>\n@@ -32,1 +24,1 @@\n-<nav id=\"TOC\" role=\"doc-toc\">\n+<nav id=\"TOC\">\n@@ -34,9 +26,4 @@\n-<li><a href=\"#tldr-instructions-for-the-impatient\"\n-id=\"toc-tldr-instructions-for-the-impatient\">TL;DR (Instructions for the\n-Impatient)<\/a><\/li>\n-<li><a href=\"#introduction\" id=\"toc-introduction\">Introduction<\/a><\/li>\n-<li><a href=\"#getting-the-source-code\"\n-id=\"toc-getting-the-source-code\">Getting the Source Code<\/a>\n-<ul>\n-<li><a href=\"#special-considerations\"\n-id=\"toc-special-considerations\">Special Considerations<\/a><\/li>\n+<li><a href=\"#tldr-instructions-for-the-impatient\">TL;DR (Instructions for the Impatient)<\/a><\/li>\n+<li><a href=\"#introduction\">Introduction<\/a><\/li>\n+<li><a href=\"#getting-the-source-code\">Getting the Source Code<\/a><ul>\n+<li><a href=\"#special-considerations\">Special Considerations<\/a><\/li>\n@@ -44,9 +31,4 @@\n-<li><a href=\"#build-hardware-requirements\"\n-id=\"toc-build-hardware-requirements\">Build Hardware Requirements<\/a>\n-<ul>\n-<li><a href=\"#building-on-x86\" id=\"toc-building-on-x86\">Building on\n-x86<\/a><\/li>\n-<li><a href=\"#building-on-aarch64\" id=\"toc-building-on-aarch64\">Building\n-on aarch64<\/a><\/li>\n-<li><a href=\"#building-on-32-bit-arm\"\n-id=\"toc-building-on-32-bit-arm\">Building on 32-bit arm<\/a><\/li>\n+<li><a href=\"#build-hardware-requirements\">Build Hardware Requirements<\/a><ul>\n+<li><a href=\"#building-on-x86\">Building on x86<\/a><\/li>\n+<li><a href=\"#building-on-aarch64\">Building on aarch64<\/a><\/li>\n+<li><a href=\"#building-on-32-bit-arm\">Building on 32-bit arm<\/a><\/li>\n@@ -54,7 +36,5 @@\n-<li><a href=\"#operating-system-requirements\"\n-id=\"toc-operating-system-requirements\">Operating System Requirements<\/a>\n-<ul>\n-<li><a href=\"#windows\" id=\"toc-windows\">Windows<\/a><\/li>\n-<li><a href=\"#macos\" id=\"toc-macos\">macOS<\/a><\/li>\n-<li><a href=\"#linux\" id=\"toc-linux\">Linux<\/a><\/li>\n-<li><a href=\"#aix\" id=\"toc-aix\">AIX<\/a><\/li>\n+<li><a href=\"#operating-system-requirements\">Operating System Requirements<\/a><ul>\n+<li><a href=\"#windows\">Windows<\/a><\/li>\n+<li><a href=\"#macos\">macOS<\/a><\/li>\n+<li><a href=\"#linux\">Linux<\/a><\/li>\n+<li><a href=\"#aix\">AIX<\/a><\/li>\n@@ -62,10 +42,7 @@\n-<li><a href=\"#native-compiler-toolchain-requirements\"\n-id=\"toc-native-compiler-toolchain-requirements\">Native Compiler\n-(Toolchain) Requirements<\/a>\n-<ul>\n-<li><a href=\"#gcc\" id=\"toc-gcc\">gcc<\/a><\/li>\n-<li><a href=\"#clang\" id=\"toc-clang\">clang<\/a><\/li>\n-<li><a href=\"#apple-xcode\" id=\"toc-apple-xcode\">Apple Xcode<\/a><\/li>\n-<li><a href=\"#microsoft-visual-studio\"\n-id=\"toc-microsoft-visual-studio\">Microsoft Visual Studio<\/a><\/li>\n-<li><a href=\"#ibm-xl-cc\" id=\"toc-ibm-xl-cc\">IBM XL C\/C++<\/a><\/li>\n+<li><a href=\"#native-compiler-toolchain-requirements\">Native Compiler (Toolchain) Requirements<\/a><ul>\n+<li><a href=\"#gcc\">gcc<\/a><\/li>\n+<li><a href=\"#clang\">clang<\/a><\/li>\n+<li><a href=\"#apple-xcode\">Apple Xcode<\/a><\/li>\n+<li><a href=\"#microsoft-visual-studio\">Microsoft Visual Studio<\/a><\/li>\n+<li><a href=\"#ibm-xl-cc\">IBM XL C\/C++<\/a><\/li>\n+<li><a href=\"#support-for-checking-standards-conforming-code\">Support for checking standards conforming code<\/a><\/li>\n@@ -73,5 +50,2 @@\n-<li><a href=\"#boot-jdk-requirements\" id=\"toc-boot-jdk-requirements\">Boot\n-JDK Requirements<\/a>\n-<ul>\n-<li><a href=\"#getting-jdk-binaries\"\n-id=\"toc-getting-jdk-binaries\">Getting JDK binaries<\/a><\/li>\n+<li><a href=\"#boot-jdk-requirements\">Boot JDK Requirements<\/a><ul>\n+<li><a href=\"#getting-jdk-binaries\">Getting JDK binaries<\/a><\/li>\n@@ -79,8 +53,6 @@\n-<li><a href=\"#external-library-requirements\"\n-id=\"toc-external-library-requirements\">External Library Requirements<\/a>\n-<ul>\n-<li><a href=\"#freetype\" id=\"toc-freetype\">FreeType<\/a><\/li>\n-<li><a href=\"#cups\" id=\"toc-cups\">CUPS<\/a><\/li>\n-<li><a href=\"#x11\" id=\"toc-x11\">X11<\/a><\/li>\n-<li><a href=\"#alsa\" id=\"toc-alsa\">ALSA<\/a><\/li>\n-<li><a href=\"#libffi\" id=\"toc-libffi\">libffi<\/a><\/li>\n+<li><a href=\"#external-library-requirements\">External Library Requirements<\/a><ul>\n+<li><a href=\"#freetype\">FreeType<\/a><\/li>\n+<li><a href=\"#cups\">CUPS<\/a><\/li>\n+<li><a href=\"#x11\">X11<\/a><\/li>\n+<li><a href=\"#alsa\">ALSA<\/a><\/li>\n+<li><a href=\"#libffi\">libffi<\/a><\/li>\n@@ -88,6 +60,4 @@\n-<li><a href=\"#build-tools-requirements\"\n-id=\"toc-build-tools-requirements\">Build Tools Requirements<\/a>\n-<ul>\n-<li><a href=\"#autoconf\" id=\"toc-autoconf\">Autoconf<\/a><\/li>\n-<li><a href=\"#gnu-make\" id=\"toc-gnu-make\">GNU Make<\/a><\/li>\n-<li><a href=\"#gnu-bash\" id=\"toc-gnu-bash\">GNU Bash<\/a><\/li>\n+<li><a href=\"#build-tools-requirements\">Build Tools Requirements<\/a><ul>\n+<li><a href=\"#autoconf\">Autoconf<\/a><\/li>\n+<li><a href=\"#gnu-make\">GNU Make<\/a><\/li>\n+<li><a href=\"#gnu-bash\">GNU Bash<\/a><\/li>\n@@ -95,8 +65,3 @@\n-<li><a href=\"#running-configure\" id=\"toc-running-configure\">Running\n-Configure<\/a>\n-<ul>\n-<li><a href=\"#common-configure-arguments\"\n-id=\"toc-common-configure-arguments\">Common Configure Arguments<\/a><\/li>\n-<li><a href=\"#configure-control-variables\"\n-id=\"toc-configure-control-variables\">Configure Control\n-Variables<\/a><\/li>\n+<li><a href=\"#running-configure\">Running Configure<\/a><ul>\n+<li><a href=\"#common-configure-arguments\">Common Configure Arguments<\/a><\/li>\n+<li><a href=\"#configure-control-variables\">Configure Control Variables<\/a><\/li>\n@@ -104,6 +69,3 @@\n-<li><a href=\"#running-make\" id=\"toc-running-make\">Running Make<\/a>\n-<ul>\n-<li><a href=\"#common-make-targets\" id=\"toc-common-make-targets\">Common\n-Make Targets<\/a><\/li>\n-<li><a href=\"#make-control-variables\"\n-id=\"toc-make-control-variables\">Make Control Variables<\/a><\/li>\n+<li><a href=\"#running-make\">Running Make<\/a><ul>\n+<li><a href=\"#common-make-targets\">Common Make Targets<\/a><\/li>\n+<li><a href=\"#make-control-variables\">Make Control Variables<\/a><\/li>\n@@ -111,5 +73,3 @@\n-<li><a href=\"#running-tests\" id=\"toc-running-tests\">Running\n-Tests<\/a><\/li>\n-<li><a href=\"#signing\" id=\"toc-signing\">Signing<\/a>\n-<ul>\n-<li><a href=\"#macos-1\" id=\"toc-macos-1\">macOS<\/a><\/li>\n+<li><a href=\"#running-tests\">Running Tests<\/a><\/li>\n+<li><a href=\"#signing\">Signing<\/a><ul>\n+<li><a href=\"#macos-1\">macOS<\/a><\/li>\n@@ -117,24 +77,10 @@\n-<li><a href=\"#cross-compiling\"\n-id=\"toc-cross-compiling\">Cross-compiling<\/a>\n-<ul>\n-<li><a href=\"#cross-compiling-the-easy-way-with-openjdk-devkits\"\n-id=\"toc-cross-compiling-the-easy-way-with-openjdk-devkits\">Cross\n-compiling the easy way with OpenJDK devkits<\/a><\/li>\n-<li><a href=\"#boot-jdk-and-build-jdk\"\n-id=\"toc-boot-jdk-and-build-jdk\">Boot JDK and Build JDK<\/a><\/li>\n-<li><a href=\"#specifying-the-target-platform\"\n-id=\"toc-specifying-the-target-platform\">Specifying the Target\n-Platform<\/a><\/li>\n-<li><a href=\"#toolchain-considerations\"\n-id=\"toc-toolchain-considerations\">Toolchain Considerations<\/a><\/li>\n-<li><a href=\"#native-libraries\" id=\"toc-native-libraries\">Native\n-Libraries<\/a><\/li>\n-<li><a href=\"#cross-compiling-with-debian-sysroots\"\n-id=\"toc-cross-compiling-with-debian-sysroots\">Cross compiling with\n-Debian sysroots<\/a><\/li>\n-<li><a href=\"#building-for-armaarch64\"\n-id=\"toc-building-for-armaarch64\">Building for ARM\/aarch64<\/a><\/li>\n-<li><a href=\"#building-for-musl\" id=\"toc-building-for-musl\">Building for\n-musl<\/a><\/li>\n-<li><a href=\"#verifying-the-build\"\n-id=\"toc-verifying-the-build\">Verifying the Build<\/a><\/li>\n+<li><a href=\"#cross-compiling\">Cross-compiling<\/a><ul>\n+<li><a href=\"#cross-compiling-the-easy-way-with-openjdk-devkits\">Cross compiling the easy way with OpenJDK devkits<\/a><\/li>\n+<li><a href=\"#boot-jdk-and-build-jdk\">Boot JDK and Build JDK<\/a><\/li>\n+<li><a href=\"#specifying-the-target-platform\">Specifying the Target Platform<\/a><\/li>\n+<li><a href=\"#toolchain-considerations\">Toolchain Considerations<\/a><\/li>\n+<li><a href=\"#native-libraries\">Native Libraries<\/a><\/li>\n+<li><a href=\"#cross-compiling-with-debian-sysroots\">Cross compiling with Debian sysroots<\/a><\/li>\n+<li><a href=\"#building-for-armaarch64\">Building for ARM\/aarch64<\/a><\/li>\n+<li><a href=\"#building-for-musl\">Building for musl<\/a><\/li>\n+<li><a href=\"#verifying-the-build\">Verifying the Build<\/a><\/li>\n@@ -142,15 +88,8 @@\n-<li><a href=\"#build-performance\" id=\"toc-build-performance\">Build\n-Performance<\/a>\n-<ul>\n-<li><a href=\"#disk-speed\" id=\"toc-disk-speed\">Disk Speed<\/a><\/li>\n-<li><a href=\"#virus-checking\" id=\"toc-virus-checking\">Virus\n-Checking<\/a><\/li>\n-<li><a href=\"#ccache\" id=\"toc-ccache\">Ccache<\/a><\/li>\n-<li><a href=\"#precompiled-headers\"\n-id=\"toc-precompiled-headers\">Precompiled Headers<\/a><\/li>\n-<li><a href=\"#icecc-icecream\" id=\"toc-icecc-icecream\">Icecc \/\n-icecream<\/a><\/li>\n-<li><a href=\"#using-the-javac-server\"\n-id=\"toc-using-the-javac-server\">Using the javac server<\/a><\/li>\n-<li><a href=\"#building-the-right-target\"\n-id=\"toc-building-the-right-target\">Building the Right Target<\/a><\/li>\n+<li><a href=\"#build-performance\">Build Performance<\/a><ul>\n+<li><a href=\"#disk-speed\">Disk Speed<\/a><\/li>\n+<li><a href=\"#virus-checking\">Virus Checking<\/a><\/li>\n+<li><a href=\"#ccache\">Ccache<\/a><\/li>\n+<li><a href=\"#precompiled-headers\">Precompiled Headers<\/a><\/li>\n+<li><a href=\"#icecc-icecream\">Icecc \/ icecream<\/a><\/li>\n+<li><a href=\"#using-sjavac\">Using sjavac<\/a><\/li>\n+<li><a href=\"#building-the-right-target\">Building the Right Target<\/a><\/li>\n@@ -158,12 +97,5 @@\n-<li><a href=\"#troubleshooting\"\n-id=\"toc-troubleshooting\">Troubleshooting<\/a>\n-<ul>\n-<li><a href=\"#locating-the-source-of-the-error\"\n-id=\"toc-locating-the-source-of-the-error\">Locating the Source of the\n-Error<\/a><\/li>\n-<li><a href=\"#fixing-unexpected-build-failures\"\n-id=\"toc-fixing-unexpected-build-failures\">Fixing Unexpected Build\n-Failures<\/a><\/li>\n-<li><a href=\"#specific-build-issues\"\n-id=\"toc-specific-build-issues\">Specific Build Issues<\/a><\/li>\n-<li><a href=\"#getting-help\" id=\"toc-getting-help\">Getting Help<\/a><\/li>\n+<li><a href=\"#troubleshooting\">Troubleshooting<\/a><ul>\n+<li><a href=\"#locating-the-source-of-the-error\">Locating the Source of the Error<\/a><\/li>\n+<li><a href=\"#fixing-unexpected-build-failures\">Fixing Unexpected Build Failures<\/a><\/li>\n+<li><a href=\"#specific-build-issues\">Specific Build Issues<\/a><\/li>\n+<li><a href=\"#getting-help\">Getting Help<\/a><\/li>\n@@ -171,16 +103,6 @@\n-<li><a href=\"#reproducible-builds\"\n-id=\"toc-reproducible-builds\">Reproducible Builds<\/a><\/li>\n-<li><a href=\"#hints-and-suggestions-for-advanced-users\"\n-id=\"toc-hints-and-suggestions-for-advanced-users\">Hints and Suggestions\n-for Advanced Users<\/a>\n-<ul>\n-<li><a href=\"#bash-completion\" id=\"toc-bash-completion\">Bash\n-Completion<\/a><\/li>\n-<li><a href=\"#using-multiple-configurations\"\n-id=\"toc-using-multiple-configurations\">Using Multiple\n-Configurations<\/a><\/li>\n-<li><a href=\"#handling-reconfigurations\"\n-id=\"toc-handling-reconfigurations\">Handling Reconfigurations<\/a><\/li>\n-<li><a href=\"#using-fine-grained-make-targets\"\n-id=\"toc-using-fine-grained-make-targets\">Using Fine-Grained Make\n-Targets<\/a><\/li>\n+<li><a href=\"#reproducible-builds\">Reproducible Builds<\/a><\/li>\n+<li><a href=\"#hints-and-suggestions-for-advanced-users\">Hints and Suggestions for Advanced Users<\/a><ul>\n+<li><a href=\"#bash-completion\">Bash Completion<\/a><\/li>\n+<li><a href=\"#using-multiple-configurations\">Using Multiple Configurations<\/a><\/li>\n+<li><a href=\"#handling-reconfigurations\">Handling Reconfigurations<\/a><\/li>\n+<li><a href=\"#using-fine-grained-make-targets\">Using Fine-Grained Make Targets<\/a><\/li>\n@@ -188,16 +110,7 @@\n-<li><a href=\"#understanding-the-build-system\"\n-id=\"toc-understanding-the-build-system\">Understanding the Build\n-System<\/a>\n-<ul>\n-<li><a href=\"#configurations\"\n-id=\"toc-configurations\">Configurations<\/a><\/li>\n-<li><a href=\"#build-output-structure\"\n-id=\"toc-build-output-structure\">Build Output Structure<\/a><\/li>\n-<li><a href=\"#fixpath\" id=\"toc-fixpath\">Fixpath<\/a><\/li>\n-<li><a href=\"#native-debug-symbols\" id=\"toc-native-debug-symbols\">Native\n-Debug Symbols<\/a><\/li>\n-<li><a href=\"#autoconf-details\" id=\"toc-autoconf-details\">Autoconf\n-Details<\/a><\/li>\n-<li><a href=\"#developing-the-build-system-itself\"\n-id=\"toc-developing-the-build-system-itself\">Developing the Build System\n-Itself<\/a><\/li>\n+<li><a href=\"#understanding-the-build-system\">Understanding the Build System<\/a><ul>\n+<li><a href=\"#configurations\">Configurations<\/a><\/li>\n+<li><a href=\"#build-output-structure\">Build Output Structure<\/a><\/li>\n+<li><a href=\"#fixpath\">Fixpath<\/a><\/li>\n+<li><a href=\"#native-debug-symbols\">Native Debug Symbols<\/a><\/li>\n+<li><a href=\"#autoconf-details\">Autoconf Details<\/a><\/li>\n+<li><a href=\"#developing-the-build-system-itself\">Developing the Build System Itself<\/a><\/li>\n@@ -205,4 +118,2 @@\n-<li><a href=\"#contributing-to-the-jdk\"\n-id=\"toc-contributing-to-the-jdk\">Contributing to the JDK<\/a><\/li>\n-<li><a href=\"#editing-this-document\"\n-id=\"toc-editing-this-document\">Editing this document<\/a><\/li>\n+<li><a href=\"#contributing-to-the-jdk\">Contributing to the JDK<\/a><\/li>\n+<li><a href=\"#editing-this-document\">Editing this document<\/a><\/li>\n@@ -211,6 +122,2 @@\n-<h2 id=\"tldr-instructions-for-the-impatient\">TL;DR (Instructions for the\n-Impatient)<\/h2>\n-<p>If you are eager to try out building the JDK, these simple steps\n-works most of the time. They assume that you have installed Git (and\n-Cygwin if running on Windows) and cloned the top-level JDK repository\n-that you want to build.<\/p>\n+<h2 id=\"tldr-instructions-for-the-impatient\">TL;DR (Instructions for the Impatient)<\/h2>\n+<p>If you are eager to try out building the JDK, these simple steps works most of the time. They assume that you have installed Git (and Cygwin if running on Windows) and cloned the top-level JDK repository that you want to build.<\/p>\n@@ -218,2 +125,1 @@\n-<li><p><a href=\"#getting-the-source-code\">Get the complete source\n-code<\/a>:<br \/>\n+<li><p><a href=\"#getting-the-source-code\">Get the complete source code<\/a>:<br \/>\n@@ -223,9 +129,1 @@\n-<p>If <code>configure<\/code> fails due to missing dependencies (to\n-either the <a\n-href=\"#native-compiler-toolchain-requirements\">toolchain<\/a>, <a\n-href=\"#build-tools-requirements\">build tools<\/a>, <a\n-href=\"#external-library-requirements\">external libraries<\/a> or the <a\n-href=\"#boot-jdk-requirements\">boot JDK<\/a>), most of the time it prints\n-a suggestion on how to resolve the situation on your platform. Follow\n-the instructions, and try running <code>bash configure<\/code>\n-again.<\/p><\/li>\n+<p>If <code>configure<\/code> fails due to missing dependencies (to either the <a href=\"#native-compiler-toolchain-requirements\">toolchain<\/a>, <a href=\"#build-tools-requirements\">build tools<\/a>, <a href=\"#external-library-requirements\">external libraries<\/a> or the <a href=\"#boot-jdk-requirements\">boot JDK<\/a>), most of the time it prints a suggestion on how to resolve the situation on your platform. Follow the instructions, and try running <code>bash configure<\/code> again.<\/p><\/li>\n@@ -239,3 +137,1 @@\n-<p>If any of these steps failed, or if you want to know more about build\n-requirements or build functionality, please continue reading this\n-document.<\/p>\n+<p>If any of these steps failed, or if you want to know more about build requirements or build functionality, please continue reading this document.<\/p>\n@@ -243,7 +139,2 @@\n-<p>The JDK is a complex software project. Building it requires a certain\n-amount of technical expertise, a fair number of dependencies on external\n-software, and reasonably powerful hardware.<\/p>\n-<p>If you just want to use the JDK and not build it yourself, this\n-document is not for you. See for instance <a\n-href=\"http:\/\/openjdk.org\/install\">OpenJDK installation<\/a> for some\n-methods of installing a prebuilt JDK.<\/p>\n+<p>The JDK is a complex software project. Building it requires a certain amount of technical expertise, a fair number of dependencies on external software, and reasonably powerful hardware.<\/p>\n+<p>If you just want to use the JDK and not build it yourself, this document is not for you. See for instance <a href=\"http:\/\/openjdk.org\/install\">OpenJDK installation<\/a> for some methods of installing a prebuilt JDK.<\/p>\n@@ -251,11 +142,2 @@\n-<p>Make sure you are getting the correct version. As of JDK 10, the\n-source is no longer split into separate repositories so you only need to\n-clone one single repository. At the <a\n-href=\"https:\/\/git.openjdk.org\/\">OpenJDK Git site<\/a> you can see a list\n-of all available repositories. If you want to build an older version,\n-e.g. JDK 11, it is recommended that you get the <code>jdk11u<\/code>\n-repo, which contains incremental updates, instead of the\n-<code>jdk11<\/code> repo, which was frozen at JDK 11 GA.<\/p>\n-<p>If you are new to Git, a good place to start is the book <a\n-href=\"https:\/\/git-scm.com\/book\/en\/v2\">Pro Git<\/a>. The rest of this\n-document assumes a working knowledge of Git.<\/p>\n+<p>Make sure you are getting the correct version. As of JDK 10, the source is no longer split into separate repositories so you only need to clone one single repository. At the <a href=\"https:\/\/git.openjdk.org\/\">OpenJDK Git site<\/a> you can see a list of all available repositories. If you want to build an older version, e.g. JDK 11, it is recommended that you get the <code>jdk11u<\/code> repo, which contains incremental updates, instead of the <code>jdk11<\/code> repo, which was frozen at JDK 11 GA.<\/p>\n+<p>If you are new to Git, a good place to start is the book <a href=\"https:\/\/git-scm.com\/book\/en\/v2\">Pro Git<\/a>. The rest of this document assumes a working knowledge of Git.<\/p>\n@@ -263,2 +145,1 @@\n-<p>For a smooth building experience, it is recommended that you follow\n-these rules on where and how to check out the source code.<\/p>\n+<p>For a smooth building experience, it is recommended that you follow these rules on where and how to check out the source code.<\/p>\n@@ -266,14 +147,4 @@\n-<li><p>Do not check out the source code in a path which contains spaces.\n-Chances are the build will not work. This is most likely to be an issue\n-on Windows systems.<\/p><\/li>\n-<li><p>Do not check out the source code in a path which has a very long\n-name or is nested many levels deep. Chances are you will hit an OS\n-limitation during the build.<\/p><\/li>\n-<li><p>Put the source code on a local disk, not a network share. If\n-possible, use an SSD. The build process is very disk intensive, and\n-having slow disk access will significantly increase build times. If you\n-need to use a network share for the source code, see below for\n-suggestions on how to keep the build artifacts on a local disk.<\/p><\/li>\n-<li><p>On Windows, if using <a href=\"#cygwin\">Cygwin<\/a>, extra care\n-must be taken to make sure the environment is consistent. It is\n-recommended that you follow this procedure:<\/p>\n+<li><p>Do not check out the source code in a path which contains spaces. Chances are the build will not work. This is most likely to be an issue on Windows systems.<\/p><\/li>\n+<li><p>Do not check out the source code in a path which has a very long name or is nested many levels deep. Chances are you will hit an OS limitation during the build.<\/p><\/li>\n+<li><p>Put the source code on a local disk, not a network share. If possible, use an SSD. The build process is very disk intensive, and having slow disk access will significantly increase build times. If you need to use a network share for the source code, see below for suggestions on how to keep the build artifacts on a local disk.<\/p><\/li>\n+<li><p>On Windows, if using <a href=\"#cygwin\">Cygwin<\/a>, extra care must be taken to make sure the environment is consistent. It is recommended that you follow this procedure:<\/p>\n@@ -281,11 +152,3 @@\n-<li><p>Create the directory that is going to contain the top directory\n-of the JDK clone by using the <code>mkdir<\/code> command in the Cygwin\n-bash shell. That is, do <em>not<\/em> create it using Windows Explorer.\n-This will ensure that it will have proper Cygwin attributes, and that\n-it's children will inherit those attributes.<\/p><\/li>\n-<li><p>Do not put the JDK clone in a path under your Cygwin home\n-directory. This is especially important if your user name contains\n-spaces and\/or mixed upper and lower case letters.<\/p><\/li>\n-<li><p>You need to install a git client. You have two choices, Cygwin\n-git or Git for Windows. Unfortunately there are pros and cons with each\n-choice.<\/p>\n+<li><p>Create the directory that is going to contain the top directory of the JDK clone by using the <code>mkdir<\/code> command in the Cygwin bash shell. That is, do <em>not<\/em> create it using Windows Explorer. This will ensure that it will have proper Cygwin attributes, and that it's children will inherit those attributes.<\/p><\/li>\n+<li><p>Do not put the JDK clone in a path under your Cygwin home directory. This is especially important if your user name contains spaces and\/or mixed upper and lower case letters.<\/p><\/li>\n+<li><p>You need to install a git client. You have two choices, Cygwin git or Git for Windows. Unfortunately there are pros and cons with each choice.<\/p>\n@@ -293,12 +156,2 @@\n-<li><p>The Cygwin <code>git<\/code> client has no line ending issues and\n-understands Cygwin paths (which are used throughout the JDK build\n-system). However, it does not currently work well with the Skara CLI\n-tooling. Please see the <a\n-href=\"https:\/\/wiki.openjdk.org\/display\/SKARA\/Skara#Skara-Git\">Skara wiki\n-on Git clients<\/a> for up-to-date information about the Skara git client\n-support.<\/p><\/li>\n-<li><p>The <a href=\"https:\/\/gitforwindows.org\">Git for Windows<\/a>\n-client has issues with line endings, and do not understand Cygwin paths.\n-It does work well with the Skara CLI tooling, however. To alleviate the\n-line ending problems, make sure you set <code>core.autocrlf<\/code> to\n-<code>false<\/code> (this is asked during installation).<\/p><\/li>\n+<li><p>The Cygwin <code>git<\/code> client has no line ending issues and understands Cygwin paths (which are used throughout the JDK build system). However, it does not currently work well with the Skara CLI tooling. Please see the <a href=\"https:\/\/wiki.openjdk.org\/display\/SKARA\/Skara#Skara-Git\">Skara wiki on Git clients<\/a> for up-to-date information about the Skara git client support.<\/p><\/li>\n+<li><p>The <a href=\"https:\/\/gitforwindows.org\">Git for Windows<\/a> client has issues with line endings, and do not understand Cygwin paths. It does work well with the Skara CLI tooling, however. To alleviate the line ending problems, make sure you set <code>core.autocrlf<\/code> to <code>false<\/code> (this is asked during installation).<\/p><\/li>\n@@ -307,2 +160,1 @@\n-<p>Failure to follow this procedure might result in hard-to-debug build\n-problems.<\/p><\/li>\n+<p>Failure to follow this procedure might result in hard-to-debug build problems.<\/p><\/li>\n@@ -311,6 +163,2 @@\n-<p>The JDK is a massive project, and require machines ranging from\n-decent to powerful to be able to build in a reasonable amount of time,\n-or to be able to complete a build at all.<\/p>\n-<p>We <em>strongly<\/em> recommend usage of an SSD disk for the build,\n-since disk speed is one of the limiting factors for build\n-performance.<\/p>\n+<p>The JDK is a massive project, and require machines ranging from decent to powerful to be able to build in a reasonable amount of time, or to be able to complete a build at all.<\/p>\n+<p>We <em>strongly<\/em> recommend usage of an SSD disk for the build, since disk speed is one of the limiting factors for build performance.<\/p>\n@@ -318,6 +166,2 @@\n-<p>At a minimum, a machine with 2-4 cores is advisable, as well as 2-4\n-GB of RAM. (The more cores to use, the more memory you need.) At least 6\n-GB of free disk space is required.<\/p>\n-<p>Even for 32-bit builds, it is recommended to use a 64-bit build\n-machine, and instead create a 32-bit target using\n-<code>--with-target-bits=32<\/code>.<\/p>\n+<p>At a minimum, a machine with 2-4 cores is advisable, as well as 2-4 GB of RAM. (The more cores to use, the more memory you need.) At least 6 GB of free disk space is required.<\/p>\n+<p>Even for 32-bit builds, it is recommended to use a 64-bit build machine, and instead create a 32-bit target using <code>--with-target-bits=32<\/code>.<\/p>\n@@ -325,5 +169,2 @@\n-<p>At a minimum, a machine with 8 cores is advisable, as well as 8 GB of\n-RAM. (The more cores to use, the more memory you need.) At least 6 GB of\n-free disk space is required.<\/p>\n-<p>If you do not have access to sufficiently powerful hardware, it is\n-also possible to use <a href=\"#cross-compiling\">cross-compiling<\/a>.<\/p>\n+<p>At a minimum, a machine with 8 cores is advisable, as well as 8 GB of RAM. (The more cores to use, the more memory you need.) At least 6 GB of free disk space is required.<\/p>\n+<p>If you do not have access to sufficiently powerful hardware, it is also possible to use <a href=\"#cross-compiling\">cross-compiling<\/a>.<\/p>\n@@ -331,6 +172,1 @@\n-<p>In order to use Branch Protection features in the VM,\n-<code>--enable-branch-protection<\/code> must be used. This option\n-requires C++ compiler support (GCC 9.1.0+ or Clang 10+). The resulting\n-build can be run on both machines with and without support for branch\n-protection in hardware. Branch Protection is only supported for Linux\n-targets.<\/p>\n+<p>In order to use Branch Protection features in the VM, <code>--enable-branch-protection<\/code> must be used. This option requires C++ compiler support (GCC 9.1.0+ or Clang 10+). The resulting build can be run on both machines with and without support for branch protection in hardware. Branch Protection is only supported for Linux targets.<\/p>\n@@ -338,13 +174,5 @@\n-<p>This is not recommended. Instead, see the section on <a\n-href=\"#cross-compiling\">Cross-compiling<\/a>.<\/p>\n-<h2 id=\"operating-system-requirements\">Operating System\n-Requirements<\/h2>\n-<p>The mainline JDK project supports Linux, macOS, AIX and Windows.\n-Support for other operating system, e.g. BSD, exists in separate \"port\"\n-projects.<\/p>\n-<p>In general, the JDK can be built on a wide range of versions of these\n-operating systems, but the further you deviate from what is tested on a\n-daily basis, the more likely you are to run into problems.<\/p>\n-<p>This table lists the OS versions used by Oracle when building the\n-JDK. Such information is always subject to change, but this table is up\n-to date at the time of writing.<\/p>\n+<p>This is not recommended. Instead, see the section on <a href=\"#cross-compiling\">Cross-compiling<\/a>.<\/p>\n+<h2 id=\"operating-system-requirements\">Operating System Requirements<\/h2>\n+<p>The mainline JDK project supports Linux, macOS, AIX and Windows. Support for other operating system, e.g. BSD, exists in separate &quot;port&quot; projects.<\/p>\n+<p>In general, the JDK can be built on a wide range of versions of these operating systems, but the further you deviate from what is tested on a daily basis, the more likely you are to run into problems.<\/p>\n+<p>This table lists the OS versions used by Oracle when building the JDK. Such information is always subject to change, but this table is up to date at the time of writing.<\/p>\n@@ -373,7 +201,2 @@\n-<p>The double version numbers for Linux are due to the hybrid model used\n-at Oracle, where header files and external libraries from an older\n-version are used when building on a more modern version of the OS.<\/p>\n-<p>The Build Group has a wiki page with <a\n-href=\"https:\/\/wiki.openjdk.org\/display\/Build\/Supported+Build+Platforms\">Supported\n-Build Platforms<\/a>. From time to time, this is updated by contributors\n-to list successes or failures of building on different platforms.<\/p>\n+<p>The double version numbers for Linux are due to the hybrid model used at Oracle, where header files and external libraries from an older version are used when building on a more modern version of the OS.<\/p>\n+<p>The Build Group has a wiki page with <a href=\"https:\/\/wiki.openjdk.org\/display\/Build\/Supported+Build+Platforms\">Supported Build Platforms<\/a>. From time to time, this is updated by contributors to list successes or failures of building on different platforms.<\/p>\n@@ -381,19 +204,4 @@\n-<p>Windows XP is not a supported platform, but all newer Windows should\n-be able to build the JDK.<\/p>\n-<p>On Windows, it is important that you pay attention to the\n-instructions in the <a href=\"#special-considerations\">Special\n-Considerations<\/a>.<\/p>\n-<p>Windows is the only non-POSIX OS supported by the JDK, and as such,\n-requires some extra care. A POSIX support layer is required to build on\n-Windows. Currently, the only supported such layers are Cygwin, Windows\n-Subsystem for Linux (WSL), and MSYS2. (MSYS is no longer supported due\n-to an outdated bash; While OpenJDK can be built with MSYS2, support for\n-it is still experimental, so build failures and unusual errors are not\n-uncommon.)<\/p>\n-<p>Internally in the build system, all paths are represented as\n-Unix-style paths, e.g. <code>\/cygdrive\/c\/git\/jdk\/Makefile<\/code> rather\n-than <code>C:\\git\\jdk\\Makefile<\/code>. This rule also applies to input\n-to the build system, e.g. in arguments to <code>configure<\/code>. So,\n-use <code>--with-msvcr-dll=\/cygdrive\/c\/msvcr100.dll<\/code> rather than\n-<code>--with-msvcr-dll=c:\\msvcr100.dll<\/code>. For details on this\n-conversion, see the section on <a href=\"#fixpath\">Fixpath<\/a>.<\/p>\n+<p>Windows XP is not a supported platform, but all newer Windows should be able to build the JDK.<\/p>\n+<p>On Windows, it is important that you pay attention to the instructions in the <a href=\"#special-considerations\">Special Considerations<\/a>.<\/p>\n+<p>Windows is the only non-POSIX OS supported by the JDK, and as such, requires some extra care. A POSIX support layer is required to build on Windows. Currently, the only supported such layers are Cygwin, Windows Subsystem for Linux (WSL), and MSYS2. (MSYS is no longer supported due to an outdated bash; While OpenJDK can be built with MSYS2, support for it is still experimental, so build failures and unusual errors are not uncommon.)<\/p>\n+<p>Internally in the build system, all paths are represented as Unix-style paths, e.g. <code>\/cygdrive\/c\/git\/jdk\/Makefile<\/code> rather than <code>C:\\git\\jdk\\Makefile<\/code>. This rule also applies to input to the build system, e.g. in arguments to <code>configure<\/code>. So, use <code>--with-msvcr-dll=\/cygdrive\/c\/msvcr100.dll<\/code> rather than <code>--with-msvcr-dll=c:\\msvcr100.dll<\/code>. For details on this conversion, see the section on <a href=\"#fixpath\">Fixpath<\/a>.<\/p>\n@@ -401,14 +209,4 @@\n-<p>A functioning <a href=\"http:\/\/www.cygwin.com\/\">Cygwin<\/a> environment\n-is required for building the JDK on Windows. If you have a 64-bit OS, we\n-strongly recommend using the 64-bit version of Cygwin.<\/p>\n-<p><strong>Note:<\/strong> Cygwin has a model of continuously updating\n-all packages without any easy way to install or revert to a specific\n-version of a package. This means that whenever you add or update a\n-package in Cygwin, you might (inadvertently) update tools that are used\n-by the JDK build process, and that can cause unexpected build\n-problems.<\/p>\n-<p>The JDK requires GNU Make 4.0 or greater in Cygwin. This is usually\n-not a problem, since Cygwin currently only distributes GNU Make at a\n-version above 4.0.<\/p>\n-<p>Apart from the basic Cygwin installation, the following packages must\n-also be installed:<\/p>\n+<p>A functioning <a href=\"http:\/\/www.cygwin.com\/\">Cygwin<\/a> environment is required for building the JDK on Windows. If you have a 64-bit OS, we strongly recommend using the 64-bit version of Cygwin.<\/p>\n+<p><strong>Note:<\/strong> Cygwin has a model of continuously updating all packages without any easy way to install or revert to a specific version of a package. This means that whenever you add or update a package in Cygwin, you might (inadvertently) update tools that are used by the JDK build process, and that can cause unexpected build problems.<\/p>\n+<p>The JDK requires GNU Make 4.0 or greater in Cygwin. This is usually not a problem, since Cygwin currently only distributes GNU Make at a version above 4.0.<\/p>\n+<p>Apart from the basic Cygwin installation, the following packages must also be installed:<\/p>\n@@ -421,2 +219,1 @@\n-<p>Often, you can install these packages using the following command\n-line:<\/p>\n+<p>Often, you can install these packages using the following command line:<\/p>\n@@ -424,29 +221,6 @@\n-<p>Unfortunately, Cygwin can be unreliable in certain circumstances. If\n-you experience build tool crashes or strange issues when building on\n-Windows, please check the Cygwin FAQ on the <a\n-href=\"https:\/\/cygwin.com\/faq\/faq.html#faq.using.bloda\">\"BLODA\" list<\/a>\n-and the section on <a\n-href=\"https:\/\/cygwin.com\/faq\/faq.html#faq.using.fixing-fork-failures\">fork()\n-failures<\/a>.<\/p>\n-<h4 id=\"windows-subsystem-for-linux-wsl\">Windows Subsystem for Linux\n-(WSL)<\/h4>\n-<p>Windows 10 1809 or newer is supported due to a dependency on the\n-wslpath utility and support for environment variable sharing through\n-WSLENV. Version 1803 can work but intermittent build failures have been\n-observed.<\/p>\n-<p>It's possible to build both Windows and Linux binaries from WSL. To\n-build Windows binaries, you must use a Windows boot JDK (located in a\n-Windows-accessible directory). To build Linux binaries, you must use a\n-Linux boot JDK. The default behavior is to build for Windows. To build\n-for Linux, pass\n-<code>--build=x86_64-unknown-linux-gnu --openjdk-target=x86_64-unknown-linux-gnu<\/code>\n-to <code>configure<\/code>.<\/p>\n-<p>If building Windows binaries, the source code must be located in a\n-Windows- accessible directory. This is because Windows executables (such\n-as Visual Studio and the boot JDK) must be able to access the source\n-code. Also, the drive where the source is stored must be mounted as\n-case-insensitive by changing either \/etc\/fstab or \/etc\/wsl.conf in WSL.\n-Individual directories may be corrected using the fsutil tool in case\n-the source was cloned before changing the mount options.<\/p>\n-<p>Note that while it's possible to build on WSL, testing is still not\n-fully supported.<\/p>\n+<p>Unfortunately, Cygwin can be unreliable in certain circumstances. If you experience build tool crashes or strange issues when building on Windows, please check the Cygwin FAQ on the <a href=\"https:\/\/cygwin.com\/faq\/faq.html#faq.using.bloda\">&quot;BLODA&quot; list<\/a> and the section on <a href=\"https:\/\/cygwin.com\/faq\/faq.html#faq.using.fixing-fork-failures\">fork() failures<\/a>.<\/p>\n+<h4 id=\"windows-subsystem-for-linux-wsl\">Windows Subsystem for Linux (WSL)<\/h4>\n+<p>Windows 10 1809 or newer is supported due to a dependency on the wslpath utility and support for environment variable sharing through WSLENV. Version 1803 can work but intermittent build failures have been observed.<\/p>\n+<p>It's possible to build both Windows and Linux binaries from WSL. To build Windows binaries, you must use a Windows boot JDK (located in a Windows-accessible directory). To build Linux binaries, you must use a Linux boot JDK. The default behavior is to build for Windows. To build for Linux, pass <code>--build=x86_64-unknown-linux-gnu --openjdk-target=x86_64-unknown-linux-gnu<\/code> to <code>configure<\/code>.<\/p>\n+<p>If building Windows binaries, the source code must be located in a Windows- accessible directory. This is because Windows executables (such as Visual Studio and the boot JDK) must be able to access the source code. Also, the drive where the source is stored must be mounted as case-insensitive by changing either \/etc\/fstab or \/etc\/wsl.conf in WSL. Individual directories may be corrected using the fsutil tool in case the source was cloned before changing the mount options.<\/p>\n+<p>Note that while it's possible to build on WSL, testing is still not fully supported.<\/p>\n@@ -454,13 +228,3 @@\n-<p>Apple is using a quite aggressive scheme of pushing OS updates, and\n-coupling these updates with required updates of Xcode. Unfortunately,\n-this makes it difficult for a project such as the JDK to keep pace with\n-a continuously updated machine running macOS. See the section on <a\n-href=\"#apple-xcode\">Apple Xcode<\/a> on some strategies to deal with\n-this.<\/p>\n-<p>It is recommended that you use at least Mac OS X 10.13 (High Sierra).\n-At the time of writing, the JDK has been successfully compiled on macOS\n-10.12 (Sierra).<\/p>\n-<p>The standard macOS environment contains the basic tooling needed to\n-build, but for external libraries a package manager is recommended. The\n-JDK uses <a href=\"https:\/\/brew.sh\/\">homebrew<\/a> in the examples, but\n-feel free to use whatever manager you want (or none).<\/p>\n+<p>Apple is using a quite aggressive scheme of pushing OS updates, and coupling these updates with required updates of Xcode. Unfortunately, this makes it difficult for a project such as the JDK to keep pace with a continuously updated machine running macOS. See the section on <a href=\"#apple-xcode\">Apple Xcode<\/a> on some strategies to deal with this.<\/p>\n+<p>It is recommended that you use at least Mac OS X 10.13 (High Sierra). At the time of writing, the JDK has been successfully compiled on macOS 10.12 (Sierra).<\/p>\n+<p>The standard macOS environment contains the basic tooling needed to build, but for external libraries a package manager is recommended. The JDK uses <a href=\"https:\/\/brew.sh\/\">homebrew<\/a> in the examples, but feel free to use whatever manager you want (or none).<\/p>\n@@ -468,5 +232,2 @@\n-<p>It is often not much problem to build the JDK on Linux. The only\n-general advice is to try to use the compilers, external libraries and\n-header files as provided by your distribution.<\/p>\n-<p>The basic tooling is provided as part of the core operating system,\n-but you will most likely need to install developer packages.<\/p>\n+<p>It is often not much problem to build the JDK on Linux. The only general advice is to try to use the compilers, external libraries and header files as provided by your distribution.<\/p>\n+<p>The basic tooling is provided as part of the core operating system, but you will most likely need to install developer packages.<\/p>\n@@ -477,2 +238,1 @@\n-<p>For Alpine Linux, aside from basic tooling, install the GNU versions\n-of some programs:<\/p>\n+<p>For Alpine Linux, aside from basic tooling, install the GNU versions of some programs:<\/p>\n@@ -481,14 +241,3 @@\n-<p>Please consult the AIX section of the <a\n-href=\"https:\/\/wiki.openjdk.org\/display\/Build\/Supported+Build+Platforms\">Supported\n-Build Platforms<\/a> OpenJDK Build Wiki page for details about which\n-versions of AIX are supported.<\/p>\n-<h2 id=\"native-compiler-toolchain-requirements\">Native Compiler\n-(Toolchain) Requirements<\/h2>\n-<p>Large portions of the JDK consists of native code, that needs to be\n-compiled to be able to run on the target platform. In theory, toolchain\n-and operating system should be independent factors, but in practice\n-there's more or less a one-to-one correlation between target operating\n-system and toolchain. There are ongoing efforts to loosen this strict\n-coupling between compiler and operating system (see <a\n-href=\"https:\/\/bugs.openjdk.org\/browse\/JDK-8288293\">JDK-8288293<\/a>) but\n-it will likely be a very long time before this goal can be realized.<\/p>\n+<p>Please consult the AIX section of the <a href=\"https:\/\/wiki.openjdk.org\/display\/Build\/Supported+Build+Platforms\">Supported Build Platforms<\/a> OpenJDK Build Wiki page for details about which versions of AIX are supported.<\/p>\n+<h2 id=\"native-compiler-toolchain-requirements\">Native Compiler (Toolchain) Requirements<\/h2>\n+<p>Large portions of the JDK consists of native code, that needs to be compiled to be able to run on the target platform. In theory, toolchain and operating system should be independent factors, but in practice there's more or less a one-to-one correlation between target operating system and toolchain. There are ongoing efforts to loosen this strict coupling between compiler and operating system (see <a href=\"https:\/\/bugs.openjdk.org\/browse\/JDK-8288293\">JDK-8288293<\/a>) but it will likely be a very long time before this goal can be realized.<\/p>\n@@ -498,2 +247,2 @@\n-<th>Operating system<\/th>\n-<th>Supported toolchain<\/th>\n+<th style=\"text-align: left;\">Operating system<\/th>\n+<th style=\"text-align: left;\">Supported toolchain<\/th>\n@@ -504,2 +253,2 @@\n-<td>Linux<\/td>\n-<td>gcc, clang<\/td>\n+<td style=\"text-align: left;\">Linux<\/td>\n+<td style=\"text-align: left;\">gcc, clang<\/td>\n@@ -508,2 +257,2 @@\n-<td>macOS<\/td>\n-<td>Apple Xcode (using clang)<\/td>\n+<td style=\"text-align: left;\">macOS<\/td>\n+<td style=\"text-align: left;\">Apple Xcode (using clang)<\/td>\n@@ -512,2 +261,2 @@\n-<td>AIX<\/td>\n-<td>IBM XL C\/C++<\/td>\n+<td style=\"text-align: left;\">AIX<\/td>\n+<td style=\"text-align: left;\">IBM XL C\/C++<\/td>\n@@ -516,2 +265,2 @@\n-<td>Windows<\/td>\n-<td>Microsoft Visual Studio<\/td>\n+<td style=\"text-align: left;\">Windows<\/td>\n+<td style=\"text-align: left;\">Microsoft Visual Studio<\/td>\n@@ -521,6 +270,1 @@\n-<p>Please see the individual sections on the toolchains for version\n-recommendations. As a reference, these versions of the toolchains are\n-used, at the time of writing, by Oracle for the daily builds of the JDK.\n-It should be possible to compile the JDK with both older and newer\n-versions, but the closer you stay to this list, the more likely you are\n-to compile successfully without issues.<\/p>\n+<p>Please see the individual sections on the toolchains for version recommendations. As a reference, these versions of the toolchains are used, at the time of writing, by Oracle for the daily builds of the JDK. It should be possible to compile the JDK with both older and newer versions, but the closer you stay to this list, the more likely you are to compile successfully without issues.<\/p>\n@@ -530,2 +274,2 @@\n-<th>Operating system<\/th>\n-<th>Toolchain version<\/th>\n+<th style=\"text-align: left;\">Operating system<\/th>\n+<th style=\"text-align: left;\">Toolchain version<\/th>\n@@ -536,2 +280,2 @@\n-<td>Linux<\/td>\n-<td>gcc 11.2.0<\/td>\n+<td style=\"text-align: left;\">Linux<\/td>\n+<td style=\"text-align: left;\">gcc 11.2.0<\/td>\n@@ -540,2 +284,2 @@\n-<td>macOS<\/td>\n-<td>Apple Xcode 10.1 (using clang 10.0.0)<\/td>\n+<td style=\"text-align: left;\">macOS<\/td>\n+<td style=\"text-align: left;\">Apple Xcode 10.1 (using clang 10.0.0)<\/td>\n@@ -544,2 +288,2 @@\n-<td>Windows<\/td>\n-<td>Microsoft Visual Studio 2022 update 17.1.0<\/td>\n+<td style=\"text-align: left;\">Windows<\/td>\n+<td style=\"text-align: left;\">Microsoft Visual Studio 2022 update 17.1.0<\/td>\n@@ -549,4 +293,1 @@\n-<p>All compilers are expected to be able to compile to the C99 language\n-standard, as some C99 features are used in the source code. Microsoft\n-Visual Studio doesn't fully support C99 so in practice shared code is\n-limited to using C99 features that it does support.<\/p>\n+<p>All compilers are expected to be able to compile to the C99 language standard, as some C99 features are used in the source code. Microsoft Visual Studio doesn't fully support C99 so in practice shared code is limited to using C99 features that it does support.<\/p>\n@@ -554,5 +295,2 @@\n-<p>The minimum accepted version of gcc is 5.0. Older versions will\n-generate a warning by <code>configure<\/code> and are unlikely to\n-work.<\/p>\n-<p>The JDK is currently known to be able to compile with at least\n-version 11.2 of gcc.<\/p>\n+<p>The minimum accepted version of gcc is 5.0. Older versions will generate a warning by <code>configure<\/code> and are unlikely to work.<\/p>\n+<p>The JDK is currently known to be able to compile with at least version 11.2 of gcc.<\/p>\n@@ -561,4 +299,2 @@\n-<p>The minimum accepted version of clang is 3.5. Older versions will not\n-be accepted by <code>configure<\/code>.<\/p>\n-<p>To use clang instead of gcc on Linux, use\n-<code>--with-toolchain-type=clang<\/code>.<\/p>\n+<p>The minimum accepted version of clang is 3.5. Older versions will not be accepted by <code>configure<\/code>.<\/p>\n+<p>To use clang instead of gcc on Linux, use <code>--with-toolchain-type=clang<\/code>.<\/p>\n@@ -567,3 +303,1 @@\n-<p>You will need the Xcode command line developer tools to be able to\n-build the JDK. (Actually, <em>only<\/em> the command line tools are\n-needed, not the IDE.) The simplest way to install these is to run:<\/p>\n+<p>You will need the Xcode command lines developers tools to be able to build the JDK. (Actually, <em>only<\/em> the command lines tools are needed, not the IDE.) The simplest way to install these is to run:<\/p>\n@@ -571,21 +305,2 @@\n-<p>When updating Xcode, it is advisable to keep an older version for\n-building the JDK. To use a specific version of Xcode you have multiple\n-options:<\/p>\n-<ul>\n-<li>Use <code>xcode-select -s<\/code> before running\n-<code>configure<\/code>, e.g.\n-<code>xcode-select -s \/Applications\/Xcode13.1.app<\/code>. The drawback\n-is that the setting is system wide and you may have to revert it after\n-an OpenJDK build.<\/li>\n-<li>Use configure option <code>--with-xcode-path<\/code>, e.g.\n-<code>configure --with-xcode-path=\/Applications\/Xcode13.1.app<\/code>\n-This allows using a specific Xcode version for an OpenJDK build,\n-independently of the active Xcode version by\n-<code>xcode-select<\/code>.<\/li>\n-<\/ul>\n-<p>If you have recently (inadvertently) updated your OS and\/or Xcode\n-version, and the JDK can no longer be built, please see the section on\n-<a href=\"#problems-with-the-build-environment\">Problems with the Build\n-Environment<\/a>, and <a href=\"#getting-help\">Getting Help<\/a> to find\n-out if there are any recent, non-merged patches available for this\n-update.<\/p>\n+<p>It is advisable to keep an older version of Xcode for building the JDK when updating Xcode. This <a href=\"http:\/\/iosdevelopertips.com\/xcode\/install-multiple-versions-of-xcode.html\">blog page<\/a> has good suggestions on managing multiple Xcode versions. To use a specific version of Xcode, use <code>xcode-select -s<\/code> before running <code>configure<\/code>, or use <code>--with-toolchain-path<\/code> to point to the version of Xcode to use, e.g. <code>configure --with-toolchain-path=\/Applications\/Xcode8.app\/Contents\/Developer\/usr\/bin<\/code><\/p>\n+<p>If you have recently (inadvertently) updated your OS and\/or Xcode version, and the JDK can no longer be built, please see the section on <a href=\"#problems-with-the-build-environment\">Problems with the Build Environment<\/a>, and <a href=\"#getting-help\">Getting Help<\/a> to find out if there are any recent, non-merged patches available for this update.<\/p>\n@@ -593,13 +308,3 @@\n-<p>The minimum accepted version is Visual Studio 2019 version 16.8.\n-(Note that this version is often presented as \"MSVC 14.28\", and reported\n-by cl.exe as 19.28.) Older versions will not be accepted by\n-<code>configure<\/code> and will not work. The maximum accepted version\n-of Visual Studio is 2022.<\/p>\n-<p>If you have multiple versions of Visual Studio installed,\n-<code>configure<\/code> will by default pick the latest. You can request\n-a specific version to be used by setting\n-<code>--with-toolchain-version<\/code>, e.g.\n-<code>--with-toolchain-version=2022<\/code>.<\/p>\n-<p>If you have Visual Studio installed but <code>configure<\/code> fails\n-to detect it, it may be because of <a href=\"#spaces-in-path\">spaces in\n-path<\/a>.<\/p>\n+<p>The minimum accepted version is Visual Studio 2019 version 16.8. (Note that this version is often presented as &quot;MSVC 14.28&quot;, and reported by cl.exe as 19.28.) Older versions will not be accepted by <code>configure<\/code> and will not work. The maximum accepted version of Visual Studio is 2022.<\/p>\n+<p>If you have multiple versions of Visual Studio installed, <code>configure<\/code> will by default pick the latest. You can request a specific version to be used by setting <code>--with-toolchain-version<\/code>, e.g. <code>--with-toolchain-version=2022<\/code>.<\/p>\n+<p>If you have Visual Studio installed but <code>configure<\/code> fails to detect it, it may be because of <a href=\"#spaces-in-path\">spaces in path<\/a>.<\/p>\n@@ -607,4 +312,3 @@\n-<p>Please consult the AIX section of the <a\n-href=\"https:\/\/wiki.openjdk.org\/display\/Build\/Supported+Build+Platforms\">Supported\n-Build Platforms<\/a> OpenJDK Build Wiki page for details about which\n-versions of XLC are supported.<\/p>\n+<p>Please consult the AIX section of the <a href=\"https:\/\/wiki.openjdk.org\/display\/Build\/Supported+Build+Platforms\">Supported Build Platforms<\/a> OpenJDK Build Wiki page for details about which versions of XLC are supported.<\/p>\n+<h3 id=\"support-for-checking-standards-conforming-code\">Support for checking standards conforming code<\/h3>\n+<p>The make system has a strict mode that enforces conforming code based on the standard that is used by the build, which can be useful to ensure that native code behaves strictly according to said standard. This option can by enabled by passing <code>--enable-conforming-compilation<\/code> during configure, but is off by default. If you just want to compile a working JDK it is not recommended that you set this flag, as it is mainly meant to aid developers that are working with native code.<\/p>\n@@ -612,18 +316,4 @@\n-<p>Paradoxically, building the JDK requires a pre-existing JDK. This is\n-called the \"boot JDK\". The boot JDK does not, however, have to be a JDK\n-built directly from the source code available in the OpenJDK Community.\n-If you are porting the JDK to a new platform, chances are that there\n-already exists another JDK for that platform that is usable as boot\n-JDK.<\/p>\n-<p>The rule of thumb is that the boot JDK for building JDK major version\n-<em>N<\/em> should be a JDK of major version <em>N-1<\/em>, so for\n-building JDK 9 a JDK 8 would be suitable as boot JDK. However, the JDK\n-should be able to \"build itself\", so an up-to-date build of the current\n-JDK source is an acceptable alternative. If you are following the\n-<em>N-1<\/em> rule, make sure you've got the latest update version, since\n-JDK 8 GA might not be able to build JDK 9 on all platforms.<\/p>\n-<p>Early in the release cycle, version <em>N-1<\/em> may not yet have\n-been released. In that case, the preferred boot JDK will be version\n-<em>N-2<\/em> until version <em>N-1<\/em> is available.<\/p>\n-<p>If the boot JDK is not automatically detected, or the wrong JDK is\n-picked, use <code>--with-boot-jdk<\/code> to point to the JDK to use.<\/p>\n+<p>Paradoxically, building the JDK requires a pre-existing JDK. This is called the &quot;boot JDK&quot;. The boot JDK does not, however, have to be a JDK built directly from the source code available in the OpenJDK Community. If you are porting the JDK to a new platform, chances are that there already exists another JDK for that platform that is usable as boot JDK.<\/p>\n+<p>The rule of thumb is that the boot JDK for building JDK major version <em>N<\/em> should be a JDK of major version <em>N-1<\/em>, so for building JDK 9 a JDK 8 would be suitable as boot JDK. However, the JDK should be able to &quot;build itself&quot;, so an up-to-date build of the current JDK source is an acceptable alternative. If you are following the <em>N-1<\/em> rule, make sure you've got the latest update version, since JDK 8 GA might not be able to build JDK 9 on all platforms.<\/p>\n+<p>Early in the release cycle, version <em>N-1<\/em> may not yet have been released. In that case, the preferred boot JDK will be version <em>N-2<\/em> until version <em>N-1<\/em> is available.<\/p>\n+<p>If the boot JDK is not automatically detected, or the wrong JDK is picked, use <code>--with-boot-jdk<\/code> to point to the JDK to use.<\/p>\n@@ -631,28 +321,6 @@\n-<p>JDK binaries for Linux, Windows and macOS can be downloaded from <a\n-href=\"http:\/\/jdk.java.net\">jdk.java.net<\/a>. An alternative is to\n-download the <a\n-href=\"http:\/\/www.oracle.com\/technetwork\/java\/javase\/downloads\">Oracle\n-JDK<\/a>. Another is the <a href=\"https:\/\/adoptopenjdk.net\/\">Adopt\n-OpenJDK Project<\/a>, which publishes experimental prebuilt binaries for\n-various platforms.<\/p>\n-<p>On Linux you can also get a JDK from the Linux distribution. On\n-apt-based distros (like Debian and Ubuntu),\n-<code>sudo apt-get install openjdk-&lt;VERSION&gt;-jdk<\/code> is\n-typically enough to install a JDK &lt;VERSION&gt;. On rpm-based distros\n-(like Fedora and Red Hat), try\n-<code>sudo yum install java-&lt;VERSION&gt;-openjdk-devel<\/code>.<\/p>\n-<h2 id=\"external-library-requirements\">External Library\n-Requirements<\/h2>\n-<p>Different platforms require different external libraries. In general,\n-libraries are not optional - that is, they are either required or not\n-used.<\/p>\n-<p>If a required library is not detected by <code>configure<\/code>, you\n-need to provide the path to it. There are two forms of the\n-<code>configure<\/code> arguments to point to an external library:\n-<code>--with-&lt;LIB&gt;=&lt;path&gt;<\/code> or\n-<code>--with-&lt;LIB&gt;-include=&lt;path to include&gt; --with-&lt;LIB&gt;-lib=&lt;path to lib&gt;<\/code>.\n-The first variant is more concise, but require the include files and\n-library files to reside in a default hierarchy under this directory. In\n-most cases, it works fine.<\/p>\n-<p>As a fallback, the second version allows you to point to the include\n-directory and the lib directory separately.<\/p>\n+<p>JDK binaries for Linux, Windows and macOS can be downloaded from <a href=\"http:\/\/jdk.java.net\">jdk.java.net<\/a>. An alternative is to download the <a href=\"http:\/\/www.oracle.com\/technetwork\/java\/javase\/downloads\">Oracle JDK<\/a>. Another is the <a href=\"https:\/\/adoptopenjdk.net\/\">Adopt OpenJDK Project<\/a>, which publishes experimental prebuilt binaries for various platforms.<\/p>\n+<p>On Linux you can also get a JDK from the Linux distribution. On apt-based distros (like Debian and Ubuntu), <code>sudo apt-get install openjdk-&lt;VERSION&gt;-jdk<\/code> is typically enough to install a JDK &lt;VERSION&gt;. On rpm-based distros (like Fedora and Red Hat), try <code>sudo yum install java-&lt;VERSION&gt;-openjdk-devel<\/code>.<\/p>\n+<h2 id=\"external-library-requirements\">External Library Requirements<\/h2>\n+<p>Different platforms require different external libraries. In general, libraries are not optional - that is, they are either required or not used.<\/p>\n+<p>If a required library is not detected by <code>configure<\/code>, you need to provide the path to it. There are two forms of the <code>configure<\/code> arguments to point to an external library: <code>--with-&lt;LIB&gt;=&lt;path&gt;<\/code> or <code>--with-&lt;LIB&gt;-include=&lt;path to include&gt; --with-&lt;LIB&gt;-lib=&lt;path to lib&gt;<\/code>. The first variant is more concise, but require the include files and library files to reside in a default hierarchy under this directory. In most cases, it works fine.<\/p>\n+<p>As a fallback, the second version allows you to point to the include directory and the lib directory separately.<\/p>\n@@ -660,5 +328,1 @@\n-<p>FreeType2 from <a href=\"http:\/\/www.freetype.org\/\">The FreeType\n-Project<\/a> is not required on any platform. The exception is on\n-Unix-based platforms when configuring such that the build artifacts will\n-reference a system installed library, rather than bundling the JDK's own\n-copy.<\/p>\n+<p>FreeType2 from <a href=\"http:\/\/www.freetype.org\/\">The FreeType Project<\/a> is not required on any platform. The exception is on Unix-based platforms when configuring such that the build artifacts will reference a system installed library, rather than bundling the JDK's own copy.<\/p>\n@@ -666,8 +330,4 @@\n-<li>To install on an apt-based Linux, try running\n-<code>sudo apt-get install     libfreetype6-dev<\/code>.<\/li>\n-<li>To install on an rpm-based Linux, try running\n-<code>sudo yum install     freetype-devel<\/code>.<\/li>\n-<li>To install on Alpine Linux, try running\n-<code>sudo apk add freetype-dev<\/code>.<\/li>\n-<li>To install on macOS, try running\n-<code>brew install freetype<\/code>.<\/li>\n+<li>To install on an apt-based Linux, try running <code>sudo apt-get install libfreetype6-dev<\/code>.<\/li>\n+<li>To install on an rpm-based Linux, try running <code>sudo yum install freetype-devel<\/code>.<\/li>\n+<li>To install on Alpine Linux, try running <code>sudo apk add freetype-dev<\/code>.<\/li>\n+<li>To install on macOS, try running <code>brew install freetype<\/code>.<\/li>\n@@ -675,3 +335,1 @@\n-<p>Use <code>--with-freetype-include=&lt;path&gt;<\/code> and\n-<code>--with-freetype-lib=&lt;path&gt;<\/code> if <code>configure<\/code>\n-does not automatically locate the platform FreeType files.<\/p>\n+<p>Use <code>--with-freetype-include=&lt;path&gt;<\/code> and <code>--with-freetype-lib=&lt;path&gt;<\/code> if <code>configure<\/code> does not automatically locate the platform FreeType files.<\/p>\n@@ -679,3 +337,1 @@\n-<p>CUPS, <a href=\"http:\/\/www.cups.org\">Common UNIX Printing System<\/a>\n-header files are required on all platforms, except Windows. Often these\n-files are provided by your operating system.<\/p>\n+<p>CUPS, <a href=\"http:\/\/www.cups.org\">Common UNIX Printing System<\/a> header files are required on all platforms, except Windows. Often these files are provided by your operating system.<\/p>\n@@ -683,6 +339,3 @@\n-<li>To install on an apt-based Linux, try running\n-<code>sudo apt-get install     libcups2-dev<\/code>.<\/li>\n-<li>To install on an rpm-based Linux, try running\n-<code>sudo yum install     cups-devel<\/code>.<\/li>\n-<li>To install on Alpine Linux, try running\n-<code>sudo apk add cups-dev<\/code>.<\/li>\n+<li>To install on an apt-based Linux, try running <code>sudo apt-get install libcups2-dev<\/code>.<\/li>\n+<li>To install on an rpm-based Linux, try running <code>sudo yum install cups-devel<\/code>.<\/li>\n+<li>To install on Alpine Linux, try running <code>sudo apk add cups-dev<\/code>.<\/li>\n@@ -690,2 +343,1 @@\n-<p>Use <code>--with-cups=&lt;path&gt;<\/code> if <code>configure<\/code>\n-does not properly locate your CUPS files.<\/p>\n+<p>Use <code>--with-cups=&lt;path&gt;<\/code> if <code>configure<\/code> does not properly locate your CUPS files.<\/p>\n@@ -693,2 +345,1 @@\n-<p>Certain <a href=\"http:\/\/www.x.org\/\">X11<\/a> libraries and include\n-files are required on Linux.<\/p>\n+<p>Certain <a href=\"http:\/\/www.x.org\/\">X11<\/a> libraries and include files are required on Linux.<\/p>\n@@ -696,6 +347,3 @@\n-<li>To install on an apt-based Linux, try running\n-<code>sudo apt-get install     libx11-dev libxext-dev libxrender-dev libxrandr-dev libxtst-dev libxt-dev<\/code>.<\/li>\n-<li>To install on an rpm-based Linux, try running\n-<code>sudo yum install     libXtst-devel libXt-devel libXrender-devel libXrandr-devel libXi-devel<\/code>.<\/li>\n-<li>To install on Alpine Linux, try running\n-<code>sudo apk add libx11-dev     libxext-dev libxrender-dev libxrandr-dev libxtst-dev libxt-dev<\/code>.<\/li>\n+<li>To install on an apt-based Linux, try running <code>sudo apt-get install libx11-dev libxext-dev libxrender-dev libxrandr-dev libxtst-dev libxt-dev<\/code>.<\/li>\n+<li>To install on an rpm-based Linux, try running <code>sudo yum install libXtst-devel libXt-devel libXrender-devel libXrandr-devel libXi-devel<\/code>.<\/li>\n+<li>To install on Alpine Linux, try running <code>sudo apk add libx11-dev libxext-dev libxrender-dev libxrandr-dev libxtst-dev libxt-dev<\/code>.<\/li>\n@@ -703,2 +351,1 @@\n-<p>Use <code>--with-x=&lt;path&gt;<\/code> if <code>configure<\/code> does\n-not properly locate your X11 files.<\/p>\n+<p>Use <code>--with-x=&lt;path&gt;<\/code> if <code>configure<\/code> does not properly locate your X11 files.<\/p>\n@@ -706,3 +353,1 @@\n-<p>ALSA, <a href=\"https:\/\/www.alsa-project.org\/\">Advanced Linux Sound\n-Architecture<\/a> is required on Linux. At least version 0.9.1 of ALSA is\n-required.<\/p>\n+<p>ALSA, <a href=\"https:\/\/www.alsa-project.org\/\">Advanced Linux Sound Architecture<\/a> is required on Linux. At least version 0.9.1 of ALSA is required.<\/p>\n@@ -710,6 +355,3 @@\n-<li>To install on an apt-based Linux, try running\n-<code>sudo apt-get install     libasound2-dev<\/code>.<\/li>\n-<li>To install on an rpm-based Linux, try running\n-<code>sudo yum install     alsa-lib-devel<\/code>.<\/li>\n-<li>To install on Alpine Linux, try running\n-<code>sudo apk add alsa-lib-dev<\/code>.<\/li>\n+<li>To install on an apt-based Linux, try running <code>sudo apt-get install libasound2-dev<\/code>.<\/li>\n+<li>To install on an rpm-based Linux, try running <code>sudo yum install alsa-lib-devel<\/code>.<\/li>\n+<li>To install on Alpine Linux, try running <code>sudo apk add alsa-lib-dev<\/code>.<\/li>\n@@ -717,2 +359,1 @@\n-<p>Use <code>--with-alsa=&lt;path&gt;<\/code> if <code>configure<\/code>\n-does not properly locate your ALSA files.<\/p>\n+<p>Use <code>--with-alsa=&lt;path&gt;<\/code> if <code>configure<\/code> does not properly locate your ALSA files.<\/p>\n@@ -720,3 +361,1 @@\n-<p>libffi, the <a href=\"http:\/\/sourceware.org\/libffi\">Portable Foreign\n-Function Interface Library<\/a> is required when building the Zero\n-version of Hotspot.<\/p>\n+<p>libffi, the <a href=\"http:\/\/sourceware.org\/libffi\">Portable Foreign Function Interface Library<\/a> is required when building the Zero version of Hotspot.<\/p>\n@@ -724,6 +363,3 @@\n-<li>To install on an apt-based Linux, try running\n-<code>sudo apt-get install     libffi-dev<\/code>.<\/li>\n-<li>To install on an rpm-based Linux, try running\n-<code>sudo yum install     libffi-devel<\/code>.<\/li>\n-<li>To install on Alpine Linux, try running\n-<code>sudo apk add libffi-dev<\/code>.<\/li>\n+<li>To install on an apt-based Linux, try running <code>sudo apt-get install libffi-dev<\/code>.<\/li>\n+<li>To install on an rpm-based Linux, try running <code>sudo yum install libffi-devel<\/code>.<\/li>\n+<li>To install on Alpine Linux, try running <code>sudo apk add libffi-dev<\/code>.<\/li>\n@@ -731,2 +367,1 @@\n-<p>Use <code>--with-libffi=&lt;path&gt;<\/code> if <code>configure<\/code>\n-does not properly locate your libffi files.<\/p>\n+<p>Use <code>--with-libffi=&lt;path&gt;<\/code> if <code>configure<\/code> does not properly locate your libffi files.<\/p>\n@@ -735,3 +370,1 @@\n-<p>The JDK requires <a\n-href=\"http:\/\/www.gnu.org\/software\/autoconf\">Autoconf<\/a> on all\n-platforms. At least version 2.69 is required.<\/p>\n+<p>The JDK requires <a href=\"http:\/\/www.gnu.org\/software\/autoconf\">Autoconf<\/a> on all platforms. At least version 2.69 is required.<\/p>\n@@ -739,10 +372,5 @@\n-<li>To install on an apt-based Linux, try running\n-<code>sudo apt-get install     autoconf<\/code>.<\/li>\n-<li>To install on an rpm-based Linux, try running\n-<code>sudo yum install     autoconf<\/code>.<\/li>\n-<li>To install on Alpine Linux, try running\n-<code>sudo apk add autoconf<\/code>.<\/li>\n-<li>To install on macOS, try running\n-<code>brew install autoconf<\/code>.<\/li>\n-<li>To install on Windows, try running\n-<code>&lt;path to Cygwin setup&gt;\/setup-x86_64 -q     -P autoconf<\/code>.<\/li>\n+<li>To install on an apt-based Linux, try running <code>sudo apt-get install autoconf<\/code>.<\/li>\n+<li>To install on an rpm-based Linux, try running <code>sudo yum install autoconf<\/code>.<\/li>\n+<li>To install on Alpine Linux, try running <code>sudo apk add autoconf<\/code>.<\/li>\n+<li>To install on macOS, try running <code>brew install autoconf<\/code>.<\/li>\n+<li>To install on Windows, try running <code>&lt;path to Cygwin setup&gt;\/setup-x86_64 -q -P autoconf<\/code>.<\/li>\n@@ -750,3 +378,1 @@\n-<p>If <code>configure<\/code> has problems locating your installation of\n-autoconf, you can specify it using the <code>AUTOCONF<\/code> environment\n-variable, like this:<\/p>\n+<p>If <code>configure<\/code> has problems locating your installation of autoconf, you can specify it using the <code>AUTOCONF<\/code> environment variable, like this:<\/p>\n@@ -755,20 +381,4 @@\n-<p>The JDK requires <a href=\"http:\/\/www.gnu.org\/software\/make\">GNU\n-Make<\/a>. No other flavors of make are supported.<\/p>\n-<p>At least version 3.81 of GNU Make must be used. For distributions\n-supporting GNU Make 4.0 or above, we strongly recommend it. GNU Make 4.0\n-contains useful functionality to handle parallel building (supported by\n-<code>--with-output-sync<\/code>) and speed and stability\n-improvements.<\/p>\n-<p>Note that <code>configure<\/code> locates and verifies a properly\n-functioning version of <code>make<\/code> and stores the path to this\n-<code>make<\/code> binary in the configuration. If you start a build\n-using <code>make<\/code> on the command line, you will be using the\n-version of make found first in your <code>PATH<\/code>, and not\n-necessarily the one stored in the configuration. This initial make will\n-be used as \"bootstrap make\", and in a second stage, the make located by\n-<code>configure<\/code> will be called. Normally, this will present no\n-issues, but if you have a very old <code>make<\/code>, or a non-GNU Make\n-<code>make<\/code> in your path, this might cause issues.<\/p>\n-<p>If you want to override the default make found by\n-<code>configure<\/code>, use the <code>MAKE<\/code> configure variable,\n-e.g. <code>configure MAKE=\/opt\/gnu\/make<\/code>.<\/p>\n+<p>The JDK requires <a href=\"http:\/\/www.gnu.org\/software\/make\">GNU Make<\/a>. No other flavors of make are supported.<\/p>\n+<p>At least version 3.81 of GNU Make must be used. For distributions supporting GNU Make 4.0 or above, we strongly recommend it. GNU Make 4.0 contains useful functionality to handle parallel building (supported by <code>--with-output-sync<\/code>) and speed and stability improvements.<\/p>\n+<p>Note that <code>configure<\/code> locates and verifies a properly functioning version of <code>make<\/code> and stores the path to this <code>make<\/code> binary in the configuration. If you start a build using <code>make<\/code> on the command line, you will be using the version of make found first in your <code>PATH<\/code>, and not necessarily the one stored in the configuration. This initial make will be used as &quot;bootstrap make&quot;, and in a second stage, the make located by <code>configure<\/code> will be called. Normally, this will present no issues, but if you have a very old <code>make<\/code>, or a non-GNU Make <code>make<\/code> in your path, this might cause issues.<\/p>\n+<p>If you want to override the default make found by <code>configure<\/code>, use the <code>MAKE<\/code> configure variable, e.g. <code>configure MAKE=\/opt\/gnu\/make<\/code>.<\/p>\n@@ -776,2 +386,1 @@\n-<p>The JDK requires <a href=\"http:\/\/www.gnu.org\/software\/bash\">GNU\n-Bash<\/a>. No other shells are supported.<\/p>\n+<p>The JDK requires <a href=\"http:\/\/www.gnu.org\/software\/bash\">GNU Bash<\/a>. No other shells are supported.<\/p>\n@@ -780,7 +389,2 @@\n-<p>To build the JDK, you need a \"configuration\", which consists of a\n-directory where to store the build output, coupled with information\n-about the platform, the specific build machine, and choices that affect\n-how the JDK is built.<\/p>\n-<p>The configuration is created by the <code>configure<\/code> script.\n-The basic invocation of the <code>configure<\/code> script looks like\n-this:<\/p>\n+<p>To build the JDK, you need a &quot;configuration&quot;, which consists of a directory where to store the build output, coupled with information about the platform, the specific build machine, and choices that affect how the JDK is built.<\/p>\n+<p>The configuration is created by the <code>configure<\/code> script. The basic invocation of the <code>configure<\/code> script looks like this:<\/p>\n@@ -788,12 +392,2 @@\n-<p>This will create an output directory containing the configuration and\n-setup an area for the build result. This directory typically looks like\n-<code>build\/linux-x64-server-release<\/code>, but the actual name depends\n-on your specific configuration. (It can also be set directly, see <a\n-href=\"#using-multiple-configurations\">Using Multiple\n-Configurations<\/a>). This directory is referred to as\n-<code>$BUILD<\/code> in this documentation.<\/p>\n-<p><code>configure<\/code> will try to figure out what system you are\n-running on and where all necessary build components are. If you have all\n-prerequisites for building installed, it should find everything. If it\n-fails to detect any component automatically, it will exit and inform you\n-about the problem.<\/p>\n+<p>This will create an output directory containing the configuration and setup an area for the build result. This directory typically looks like <code>build\/linux-x64-server-release<\/code>, but the actual name depends on your specific configuration. (It can also be set directly, see <a href=\"#using-multiple-configurations\">Using Multiple Configurations<\/a>). This directory is referred to as <code>$BUILD<\/code> in this documentation.<\/p>\n+<p><code>configure<\/code> will try to figure out what system you are running on and where all necessary build components are. If you have all prerequisites for building installed, it should find everything. If it fails to detect any component automatically, it will exit and inform you about the problem.<\/p>\n@@ -802,6 +396,4 @@\n-<li><p>Create a 32-bit build for Windows with FreeType2 in\n-<code>C:\\freetype-i586<\/code>:\n-<code>bash configure --with-freetype=\/cygdrive\/c\/freetype-i586 --with-target-bits=32<\/code><\/p><\/li>\n-<li><p>Create a debug build with the <code>server<\/code> JVM and DTrace\n-enabled:\n-<code>bash configure --enable-debug --with-jvm-variants=server --enable-dtrace<\/code><\/p><\/li>\n+<li><p>Create a 32-bit build for Windows with FreeType2 in <code>C:\\freetype-i586<\/code>:<\/p>\n+<pre><code>bash configure --with-freetype=\/cygdrive\/c\/freetype-i586 --with-target-bits=32<\/code><\/pre><\/li>\n+<li><p>Create a debug build with the <code>server<\/code> JVM and DTrace enabled:<\/p>\n+<pre><code>bash configure --enable-debug --with-jvm-variants=server --enable-dtrace<\/code><\/pre><\/li>\n@@ -810,4 +402,2 @@\n-<p>Here follows some of the most common and important\n-<code>configure<\/code> argument.<\/p>\n-<p>To get up-to-date information on <em>all<\/em> available\n-<code>configure<\/code> argument, please run:<\/p>\n+<p>Here follows some of the most common and important <code>configure<\/code> argument.<\/p>\n+<p>To get up-to-date information on <em>all<\/em> available <code>configure<\/code> argument, please run:<\/p>\n@@ -815,6 +405,2 @@\n-<p>(Note that this help text also include general autoconf options, like\n-<code>--dvidir<\/code>, that is not relevant to the JDK. To list only\n-JDK-specific features, use <code>bash configure --help=short<\/code>\n-instead.)<\/p>\n-<h4 id=\"configure-arguments-for-tailoring-the-build\">Configure Arguments\n-for Tailoring the Build<\/h4>\n+<p>(Note that this help text also include general autoconf options, like <code>--dvidir<\/code>, that is not relevant to the JDK. To list only JDK-specific features, use <code>bash configure --help=short<\/code> instead.)<\/p>\n+<h4 id=\"configure-arguments-for-tailoring-the-build\">Configure Arguments for Tailoring the Build<\/h4>\n@@ -822,44 +408,8 @@\n-<li><code>--enable-debug<\/code> - Set the debug level to\n-<code>fastdebug<\/code> (this is a shorthand for\n-<code>--with-debug-level=fastdebug<\/code>)<\/li>\n-<li><code>--with-debug-level=&lt;level&gt;<\/code> - Set the debug level,\n-which can be <code>release<\/code>, <code>fastdebug<\/code>,\n-<code>slowdebug<\/code> or <code>optimized<\/code>. Default is\n-<code>release<\/code>. <code>optimized<\/code> is variant of\n-<code>release<\/code> with additional Hotspot debug code.<\/li>\n-<li><code>--with-native-debug-symbols=&lt;method&gt;<\/code> - Specify if\n-and how native debug symbols should be built. Available methods are\n-<code>none<\/code>, <code>internal<\/code>, <code>external<\/code>,\n-<code>zipped<\/code>. Default behavior depends on platform. See <a\n-href=\"#native-debug-symbols\">Native Debug Symbols<\/a> for more\n-details.<\/li>\n-<li><code>--with-version-string=&lt;string&gt;<\/code> - Specify the\n-version string this build will be identified with.<\/li>\n-<li><code>--with-version-&lt;part&gt;=&lt;value&gt;<\/code> - A group of\n-options, where <code>&lt;part&gt;<\/code> can be any of <code>pre<\/code>,\n-<code>opt<\/code>, <code>build<\/code>, <code>major<\/code>,\n-<code>minor<\/code>, <code>security<\/code> or <code>patch<\/code>. Use\n-these options to modify just the corresponding part of the version\n-string from the default, or the value provided by\n-<code>--with-version-string<\/code>.<\/li>\n-<li><code>--with-jvm-variants=&lt;variant&gt;[,&lt;variant&gt;...]<\/code>\n-- Build the specified variant (or variants) of Hotspot. Valid variants\n-are: <code>server<\/code>, <code>client<\/code>, <code>minimal<\/code>,\n-<code>core<\/code>, <code>zero<\/code>, <code>custom<\/code>. Note that not\n-all variants are possible to combine in a single build.<\/li>\n-<li><code>--enable-jvm-feature-&lt;feature&gt;<\/code> or\n-<code>--disable-jvm-feature-&lt;feature&gt;<\/code> - Include (or\n-exclude) <code>&lt;feature&gt;<\/code> as a JVM feature in Hotspot. You\n-can also specify a list of features to be enabled, separated by space or\n-comma, as\n-<code>--with-jvm-features=&lt;feature&gt;[,&lt;feature&gt;...]<\/code>.\n-If you prefix <code>&lt;feature&gt;<\/code> with a <code>-<\/code>, it\n-will be disabled. These options will modify the default list of features\n-for the JVM variant(s) you are building. For the <code>custom<\/code> JVM\n-variant, the default list is empty. A complete list of valid JVM\n-features can be found using <code>bash configure --help<\/code>.<\/li>\n-<li><code>--with-target-bits=&lt;bits&gt;<\/code> - Create a target\n-binary suitable for running on a <code>&lt;bits&gt;<\/code> platform. Use\n-this to create 32-bit output on a 64-bit build platform, instead of\n-doing a full cross-compile. (This is known as a <em>reduced<\/em>\n-build.)<\/li>\n+<li><code>--enable-debug<\/code> - Set the debug level to <code>fastdebug<\/code> (this is a shorthand for <code>--with-debug-level=fastdebug<\/code>)<\/li>\n+<li><code>--with-debug-level=&lt;level&gt;<\/code> - Set the debug level, which can be <code>release<\/code>, <code>fastdebug<\/code>, <code>slowdebug<\/code> or <code>optimized<\/code>. Default is <code>release<\/code>. <code>optimized<\/code> is variant of <code>release<\/code> with additional Hotspot debug code.<\/li>\n+<li><code>--with-native-debug-symbols=&lt;method&gt;<\/code> - Specify if and how native debug symbols should be built. Available methods are <code>none<\/code>, <code>internal<\/code>, <code>external<\/code>, <code>zipped<\/code>. Default behavior depends on platform. See <a href=\"#native-debug-symbols\">Native Debug Symbols<\/a> for more details.<\/li>\n+<li><code>--with-version-string=&lt;string&gt;<\/code> - Specify the version string this build will be identified with.<\/li>\n+<li><code>--with-version-&lt;part&gt;=&lt;value&gt;<\/code> - A group of options, where <code>&lt;part&gt;<\/code> can be any of <code>pre<\/code>, <code>opt<\/code>, <code>build<\/code>, <code>major<\/code>, <code>minor<\/code>, <code>security<\/code> or <code>patch<\/code>. Use these options to modify just the corresponding part of the version string from the default, or the value provided by <code>--with-version-string<\/code>.<\/li>\n+<li><code>--with-jvm-variants=&lt;variant&gt;[,&lt;variant&gt;...]<\/code> - Build the specified variant (or variants) of Hotspot. Valid variants are: <code>server<\/code>, <code>client<\/code>, <code>minimal<\/code>, <code>core<\/code>, <code>zero<\/code>, <code>custom<\/code>. Note that not all variants are possible to combine in a single build.<\/li>\n+<li><code>--enable-jvm-feature-&lt;feature&gt;<\/code> or <code>--disable-jvm-feature-&lt;feature&gt;<\/code> - Include (or exclude) <code>&lt;feature&gt;<\/code> as a JVM feature in Hotspot. You can also specify a list of features to be enabled, separated by space or comma, as <code>--with-jvm-features=&lt;feature&gt;[,&lt;feature&gt;...]<\/code>. If you prefix <code>&lt;feature&gt;<\/code> with a <code>-<\/code>, it will be disabled. These options will modify the default list of features for the JVM variant(s) you are building. For the <code>custom<\/code> JVM variant, the default list is empty. A complete list of valid JVM features can be found using <code>bash configure --help<\/code>.<\/li>\n+<li><code>--with-target-bits=&lt;bits&gt;<\/code> - Create a target binary suitable for running on a <code>&lt;bits&gt;<\/code> platform. Use this to create 32-bit output on a 64-bit build platform, instead of doing a full cross-compile. (This is known as a <em>reduced<\/em> build.)<\/li>\n@@ -867,5 +417,1 @@\n-<p>On Linux, BSD and AIX, it is possible to override where Java by\n-default searches for runtime\/JNI libraries. This can be useful in\n-situations where there is a special shared directory for system JNI\n-libraries. This setting can in turn be overridden at runtime by setting\n-the <code>java.library.path<\/code> property.<\/p>\n+<p>On Linux, BSD and AIX, it is possible to override where Java by default searches for runtime\/JNI libraries. This can be useful in situations where there is a special shared directory for system JNI libraries. This setting can in turn be overridden at runtime by setting the <code>java.library.path<\/code> property.<\/p>\n@@ -873,2 +419,1 @@\n-<li><code>--with-jni-libpath=&lt;path&gt;<\/code> - Use the specified\n-path as a default when searching for runtime libraries.<\/li>\n+<li><code>--with-jni-libpath=&lt;path&gt;<\/code> - Use the specified path as a default when searching for runtime libraries.<\/li>\n@@ -876,2 +421,1 @@\n-<h4 id=\"configure-arguments-for-native-compilation\">Configure Arguments\n-for Native Compilation<\/h4>\n+<h4 id=\"configure-arguments-for-native-compilation\">Configure Arguments for Native Compilation<\/h4>\n@@ -879,16 +423,7 @@\n-<li><code>--with-devkit=&lt;path&gt;<\/code> - Use this devkit for\n-compilers, tools and resources<\/li>\n-<li><code>--with-sysroot=&lt;path&gt;<\/code> - Use this directory as\n-sysroot<\/li>\n-<li><code>--with-extra-path=&lt;path&gt;[;&lt;path&gt;]<\/code> - Prepend\n-these directories to the default path when searching for all kinds of\n-binaries<\/li>\n-<li><code>--with-toolchain-path=&lt;path&gt;[;&lt;path&gt;]<\/code> -\n-Prepend these directories when searching for toolchain binaries\n-(compilers etc)<\/li>\n-<li><code>--with-extra-cflags=&lt;flags&gt;<\/code> - Append these flags\n-when compiling JDK C files<\/li>\n-<li><code>--with-extra-cxxflags=&lt;flags&gt;<\/code> - Append these\n-flags when compiling JDK C++ files<\/li>\n-<li><code>--with-extra-ldflags=&lt;flags&gt;<\/code> - Append these flags\n-when linking JDK libraries<\/li>\n+<li><code>--with-devkit=&lt;path&gt;<\/code> - Use this devkit for compilers, tools and resources<\/li>\n+<li><code>--with-sysroot=&lt;path&gt;<\/code> - Use this directory as sysroot<\/li>\n+<li><code>--with-extra-path=&lt;path&gt;[;&lt;path&gt;]<\/code> - Prepend these directories to the default path when searching for all kinds of binaries<\/li>\n+<li><code>--with-toolchain-path=&lt;path&gt;[;&lt;path&gt;]<\/code> - Prepend these directories when searching for toolchain binaries (compilers etc)<\/li>\n+<li><code>--with-extra-cflags=&lt;flags&gt;<\/code> - Append these flags when compiling JDK C files<\/li>\n+<li><code>--with-extra-cxxflags=&lt;flags&gt;<\/code> - Append these flags when compiling JDK C++ files<\/li>\n+<li><code>--with-extra-ldflags=&lt;flags&gt;<\/code> - Append these flags when linking JDK libraries<\/li>\n@@ -896,2 +431,1 @@\n-<h4 id=\"configure-arguments-for-external-dependencies\">Configure\n-Arguments for External Dependencies<\/h4>\n+<h4 id=\"configure-arguments-for-external-dependencies\">Configure Arguments for External Dependencies<\/h4>\n@@ -899,14 +433,7 @@\n-<li><code>--with-boot-jdk=&lt;path&gt;<\/code> - Set the path to the <a\n-href=\"#boot-jdk-requirements\">Boot JDK<\/a><\/li>\n-<li><code>--with-freetype=&lt;path&gt;<\/code> - Set the path to <a\n-href=\"#freetype\">FreeType<\/a><\/li>\n-<li><code>--with-cups=&lt;path&gt;<\/code> - Set the path to <a\n-href=\"#cups\">CUPS<\/a><\/li>\n-<li><code>--with-x=&lt;path&gt;<\/code> - Set the path to <a\n-href=\"#x11\">X11<\/a><\/li>\n-<li><code>--with-alsa=&lt;path&gt;<\/code> - Set the path to <a\n-href=\"#alsa\">ALSA<\/a><\/li>\n-<li><code>--with-libffi=&lt;path&gt;<\/code> - Set the path to <a\n-href=\"#libffi\">libffi<\/a><\/li>\n-<li><code>--with-jtreg=&lt;path&gt;<\/code> - Set the path to JTReg. See\n-<a href=\"#running-tests\">Running Tests<\/a><\/li>\n+<li><code>--with-boot-jdk=&lt;path&gt;<\/code> - Set the path to the <a href=\"#boot-jdk-requirements\">Boot JDK<\/a><\/li>\n+<li><code>--with-freetype=&lt;path&gt;<\/code> - Set the path to <a href=\"#freetype\">FreeType<\/a><\/li>\n+<li><code>--with-cups=&lt;path&gt;<\/code> - Set the path to <a href=\"#cups\">CUPS<\/a><\/li>\n+<li><code>--with-x=&lt;path&gt;<\/code> - Set the path to <a href=\"#x11\">X11<\/a><\/li>\n+<li><code>--with-alsa=&lt;path&gt;<\/code> - Set the path to <a href=\"#alsa\">ALSA<\/a><\/li>\n+<li><code>--with-libffi=&lt;path&gt;<\/code> - Set the path to <a href=\"#libffi\">libffi<\/a><\/li>\n+<li><code>--with-jtreg=&lt;path&gt;<\/code> - Set the path to JTReg. See <a href=\"#running-tests\">Running Tests<\/a><\/li>\n@@ -914,8 +441,1 @@\n-<p>Certain third-party libraries used by the JDK (libjpeg, giflib,\n-libpng, lcms and zlib) are included in the JDK repository. The default\n-behavior of the JDK build is to use the included (\"bundled\") versions of\n-libjpeg, giflib, libpng and lcms. For zlib, the system lib (if present)\n-is used except on Windows and AIX. However the bundled libraries may be\n-replaced by an external version. To do so, specify <code>system<\/code>\n-as the <code>&lt;source&gt;<\/code> option in these arguments. (The\n-default is <code>bundled<\/code>).<\/p>\n+<p>Certain third-party libraries used by the JDK (libjpeg, giflib, libpng, lcms and zlib) are included in the JDK repository. The default behavior of the JDK build is to use the included (&quot;bundled&quot;) versions of libjpeg, giflib, libpng and lcms. For zlib, the system lib (if present) is used except on Windows and AIX. However the bundled libraries may be replaced by an external version. To do so, specify <code>system<\/code> as the <code>&lt;source&gt;<\/code> option in these arguments. (The default is <code>bundled<\/code>).<\/p>\n@@ -923,10 +443,5 @@\n-<li><code>--with-libjpeg=&lt;source&gt;<\/code> - Use the specified\n-source for libjpeg<\/li>\n-<li><code>--with-giflib=&lt;source&gt;<\/code> - Use the specified source\n-for giflib<\/li>\n-<li><code>--with-libpng=&lt;source&gt;<\/code> - Use the specified source\n-for libpng<\/li>\n-<li><code>--with-lcms=&lt;source&gt;<\/code> - Use the specified source\n-for lcms<\/li>\n-<li><code>--with-zlib=&lt;source&gt;<\/code> - Use the specified source\n-for zlib<\/li>\n+<li><code>--with-libjpeg=&lt;source&gt;<\/code> - Use the specified source for libjpeg<\/li>\n+<li><code>--with-giflib=&lt;source&gt;<\/code> - Use the specified source for giflib<\/li>\n+<li><code>--with-libpng=&lt;source&gt;<\/code> - Use the specified source for libpng<\/li>\n+<li><code>--with-lcms=&lt;source&gt;<\/code> - Use the specified source for lcms<\/li>\n+<li><code>--with-zlib=&lt;source&gt;<\/code> - Use the specified source for zlib<\/li>\n@@ -934,3 +449,1 @@\n-<p>On Linux, it is possible to select either static or dynamic linking\n-of the C++ runtime. The default is static linking, with dynamic linking\n-as fallback if the static library is not found.<\/p>\n+<p>On Linux, it is possible to select either static or dynamic linking of the C++ runtime. The default is static linking, with dynamic linking as fallback if the static library is not found.<\/p>\n@@ -938,3 +451,1 @@\n-<li><code>--with-stdc++lib=&lt;method&gt;<\/code> - Use the specified\n-method (<code>static<\/code>, <code>dynamic<\/code> or\n-<code>default<\/code>) for linking the C++ runtime.<\/li>\n+<li><code>--with-stdc++lib=&lt;method&gt;<\/code> - Use the specified method (<code>static<\/code>, <code>dynamic<\/code> or <code>default<\/code>) for linking the C++ runtime.<\/li>\n@@ -943,20 +454,5 @@\n-<p>It is possible to control certain aspects of <code>configure<\/code>\n-by overriding the value of <code>configure<\/code> variables, either on\n-the command line or in the environment.<\/p>\n-<p>Normally, this is <strong>not recommended<\/strong>. If used\n-improperly, it can lead to a broken configuration. Unless you're well\n-versed in the build system, this is hard to use properly. Therefore,\n-<code>configure<\/code> will print a warning if this is detected.<\/p>\n-<p>However, there are a few <code>configure<\/code> variables, known as\n-<em>control variables<\/em> that are supposed to be overridden on the\n-command line. These are variables that describe the location of tools\n-needed by the build, like <code>MAKE<\/code> or <code>GREP<\/code>. If any\n-such variable is specified, <code>configure<\/code> will use that value\n-instead of trying to autodetect the tool. For instance,\n-<code>bash configure MAKE=\/opt\/gnumake4.0\/bin\/make<\/code>.<\/p>\n-<p>If a configure argument exists, use that instead, e.g. use\n-<code>--with-jtreg<\/code> instead of setting <code>JTREGEXE<\/code>.<\/p>\n-<p>Also note that, despite what autoconf claims, setting\n-<code>CFLAGS<\/code> will not accomplish anything. Instead use\n-<code>--with-extra-cflags<\/code> (and similar for <code>cxxflags<\/code>\n-and <code>ldflags<\/code>).<\/p>\n+<p>It is possible to control certain aspects of <code>configure<\/code> by overriding the value of <code>configure<\/code> variables, either on the command line or in the environment.<\/p>\n+<p>Normally, this is <strong>not recommended<\/strong>. If used improperly, it can lead to a broken configuration. Unless you're well versed in the build system, this is hard to use properly. Therefore, <code>configure<\/code> will print a warning if this is detected.<\/p>\n+<p>However, there are a few <code>configure<\/code> variables, known as <em>control variables<\/em> that are supposed to be overridden on the command line. These are variables that describe the location of tools needed by the build, like <code>MAKE<\/code> or <code>GREP<\/code>. If any such variable is specified, <code>configure<\/code> will use that value instead of trying to autodetect the tool. For instance, <code>bash configure MAKE=\/opt\/gnumake4.0\/bin\/make<\/code>.<\/p>\n+<p>If a configure argument exists, use that instead, e.g. use <code>--with-jtreg<\/code> instead of setting <code>JTREGEXE<\/code>.<\/p>\n+<p>Also note that, despite what autoconf claims, setting <code>CFLAGS<\/code> will not accomplish anything. Instead use <code>--with-extra-cflags<\/code> (and similar for <code>cxxflags<\/code> and <code>ldflags<\/code>).<\/p>\n@@ -964,16 +460,3 @@\n-<p>When you have a proper configuration, all you need to do to build the\n-JDK is to run <code>make<\/code>. (But see the warning at <a\n-href=\"#gnu-make\">GNU Make<\/a> about running the correct version of\n-make.)<\/p>\n-<p>When running <code>make<\/code> without any arguments, the default\n-target is used, which is the same as running <code>make default<\/code>\n-or <code>make jdk<\/code>. This will build a minimal (or roughly minimal)\n-set of compiled output (known as an \"exploded image\") needed for a\n-developer to actually execute the newly built JDK. The idea is that in\n-an incremental development fashion, when doing a normal make, you should\n-only spend time recompiling what's changed (making it purely\n-incremental) and only do the work that's needed to actually run and test\n-your code.<\/p>\n-<p>The output of the exploded image resides in <code>$BUILD\/jdk<\/code>.\n-You can test the newly built JDK like this:\n-<code>$BUILD\/jdk\/bin\/java -version<\/code>.<\/p>\n+<p>When you have a proper configuration, all you need to do to build the JDK is to run <code>make<\/code>. (But see the warning at <a href=\"#gnu-make\">GNU Make<\/a> about running the correct version of make.)<\/p>\n+<p>When running <code>make<\/code> without any arguments, the default target is used, which is the same as running <code>make default<\/code> or <code>make jdk<\/code>. This will build a minimal (or roughly minimal) set of compiled output (known as an &quot;exploded image&quot;) needed for a developer to actually execute the newly built JDK. The idea is that in an incremental development fashion, when doing a normal make, you should only spend time recompiling what's changed (making it purely incremental) and only do the work that's needed to actually run and test your code.<\/p>\n+<p>The output of the exploded image resides in <code>$BUILD\/jdk<\/code>. You can test the newly built JDK like this: <code>$BUILD\/jdk\/bin\/java -version<\/code>.<\/p>\n@@ -984,6 +467,3 @@\n-<li><code>hotspot-&lt;variant&gt;<\/code> - Build just the specified jvm\n-variant<\/li>\n-<li><code>images<\/code> or <code>product-images<\/code> - Build the JDK\n-image<\/li>\n-<li><code>docs<\/code> or <code>docs-image<\/code> - Build the\n-documentation image<\/li>\n+<li><code>hotspot-&lt;variant&gt;<\/code> - Build just the specified jvm variant<\/li>\n+<li><code>images<\/code> or <code>product-images<\/code> - Build the JDK image<\/li>\n+<li><code>docs<\/code> or <code>docs-image<\/code> - Build the documentation image<\/li>\n@@ -991,8 +471,4 @@\n-<li><code>all<\/code> or <code>all-images<\/code> - Build all images\n-(product, docs and test)<\/li>\n-<li><code>bootcycle-images<\/code> - Build images twice, second time with\n-newly built JDK (good for testing)<\/li>\n-<li><code>clean<\/code> - Remove all files generated by make, but not\n-those generated by configure<\/li>\n-<li><code>dist-clean<\/code> - Remove all files, including\n-configuration<\/li>\n+<li><code>all<\/code> or <code>all-images<\/code> - Build all images (product, docs and test)<\/li>\n+<li><code>bootcycle-images<\/code> - Build images twice, second time with newly built JDK (good for testing)<\/li>\n+<li><code>clean<\/code> - Remove all files generated by make, but not those generated by configure<\/li>\n+<li><code>dist-clean<\/code> - Remove all files, including configuration<\/li>\n@@ -1000,9 +476,2 @@\n-<p>Run <code>make help<\/code> to get an up-to-date list of important\n-make targets and make control variables.<\/p>\n-<p>It is possible to build just a single module, a single phase, or a\n-single phase of a single module, by creating make targets according to\n-these followin patterns. A phase can be either of <code>gensrc<\/code>,\n-<code>gendata<\/code>, <code>copy<\/code>, <code>java<\/code>,\n-<code>launchers<\/code>, or <code>libs<\/code>. See <a\n-href=\"#using-fine-grained-make-targets\">Using Fine-Grained Make\n-Targets<\/a> for more details about this functionality.<\/p>\n+<p>Run <code>make help<\/code> to get an up-to-date list of important make targets and make control variables.<\/p>\n+<p>It is possible to build just a single module, a single phase, or a single phase of a single module, by creating make targets according to these followin patterns. A phase can be either of <code>gensrc<\/code>, <code>gendata<\/code>, <code>copy<\/code>, <code>java<\/code>, <code>launchers<\/code>, or <code>libs<\/code>. See <a href=\"#using-fine-grained-make-targets\">Using Fine-Grained Make Targets<\/a> for more details about this functionality.<\/p>\n@@ -1010,6 +479,3 @@\n-<li><code>&lt;phase&gt;<\/code> - Build the specified phase and\n-everything it depends on<\/li>\n-<li><code>&lt;module&gt;<\/code> - Build the specified module and\n-everything it depends on<\/li>\n-<li><code>&lt;module&gt;-&lt;phase&gt;<\/code> - Compile the specified\n-phase for the specified module and everything it depends on<\/li>\n+<li><code>&lt;phase&gt;<\/code> - Build the specified phase and everything it depends on<\/li>\n+<li><code>&lt;module&gt;<\/code> - Build the specified module and everything it depends on<\/li>\n+<li><code>&lt;module&gt;-&lt;phase&gt;<\/code> - Compile the specified phase for the specified module and everything it depends on<\/li>\n@@ -1017,2 +483,1 @@\n-<p>Similarly, it is possible to clean just a part of the build by\n-creating make targets according to these patterns:<\/p>\n+<p>Similarly, it is possible to clean just a part of the build by creating make targets according to these patterns:<\/p>\n@@ -1020,8 +485,4 @@\n-<li><code>clean-&lt;outputdir&gt;<\/code> - Remove the subdir in the\n-output dir with the name<\/li>\n-<li><code>clean-&lt;phase&gt;<\/code> - Remove all build results related\n-to a certain build phase<\/li>\n-<li><code>clean-&lt;module&gt;<\/code> - Remove all build results related\n-to a certain module<\/li>\n-<li><code>clean-&lt;module&gt;-&lt;phase&gt;<\/code> - Remove all build\n-results related to a certain module and phase<\/li>\n+<li><code>clean-&lt;outputdir&gt;<\/code> - Remove the subdir in the output dir with the name<\/li>\n+<li><code>clean-&lt;phase&gt;<\/code> - Remove all build results related to a certain build phase<\/li>\n+<li><code>clean-&lt;module&gt;<\/code> - Remove all build results related to a certain module<\/li>\n+<li><code>clean-&lt;module&gt;-&lt;phase&gt;<\/code> - Remove all build results related to a certain module and phase<\/li>\n@@ -1030,13 +491,4 @@\n-<p>It is possible to control <code>make<\/code> behavior by overriding\n-the value of <code>make<\/code> variables, either on the command line or\n-in the environment.<\/p>\n-<p>Normally, this is <strong>not recommended<\/strong>. If used\n-improperly, it can lead to a broken build. Unless you're well versed in\n-the build system, this is hard to use properly. Therefore,\n-<code>make<\/code> will print a warning if this is detected.<\/p>\n-<p>However, there are a few <code>make<\/code> variables, known as\n-<em>control variables<\/em> that are supposed to be overridden on the\n-command line. These make up the \"make time\" configuration, as opposed to\n-the \"configure time\" configuration.<\/p>\n-<h4 id=\"general-make-control-variables\">General Make Control\n-Variables<\/h4>\n+<p>It is possible to control <code>make<\/code> behavior by overriding the value of <code>make<\/code> variables, either on the command line or in the environment.<\/p>\n+<p>Normally, this is <strong>not recommended<\/strong>. If used improperly, it can lead to a broken build. Unless you're well versed in the build system, this is hard to use properly. Therefore, <code>make<\/code> will print a warning if this is detected.<\/p>\n+<p>However, there are a few <code>make<\/code> variables, known as <em>control variables<\/em> that are supposed to be overridden on the command line. These make up the &quot;make time&quot; configuration, as opposed to the &quot;configure time&quot; configuration.<\/p>\n+<h4 id=\"general-make-control-variables\">General Make Control Variables<\/h4>\n@@ -1044,9 +496,3 @@\n-<li><code>JOBS<\/code> - Specify the number of jobs to build with. See <a\n-href=\"#build-performance\">Build Performance<\/a>.<\/li>\n-<li><code>LOG<\/code> - Specify the logging level and functionality. See\n-<a href=\"#checking-the-build-log-file\">Checking the Build Log\n-File<\/a><\/li>\n-<li><code>CONF<\/code> and <code>CONF_NAME<\/code> - Selecting the\n-configuration(s) to use. See <a\n-href=\"#using-multiple-configurations\">Using Multiple\n-Configurations<\/a><\/li>\n+<li><code>JOBS<\/code> - Specify the number of jobs to build with. See <a href=\"#build-performance\">Build Performance<\/a>.<\/li>\n+<li><code>LOG<\/code> - Specify the logging level and functionality. See <a href=\"#checking-the-build-log-file\">Checking the Build Log File<\/a><\/li>\n+<li><code>CONF<\/code> and <code>CONF_NAME<\/code> - Selecting the configuration(s) to use. See <a href=\"#using-multiple-configurations\">Using Multiple Configurations<\/a><\/li>\n@@ -1055,4 +501,1 @@\n-<p>These make control variables only make sense when running tests.\n-Please see <strong>Testing the JDK<\/strong> (<a\n-href=\"testing.html\">html<\/a>, <a href=\"testing.md\">markdown<\/a>) for\n-details.<\/p>\n+<p>These make control variables only make sense when running tests. Please see <strong>Testing the JDK<\/strong> (<a href=\"testing.html\">html<\/a>, <a href=\"testing.md\">markdown<\/a>) for details.<\/p>\n@@ -1065,7 +508,2 @@\n-<h4 id=\"advanced-make-control-variables\">Advanced Make Control\n-Variables<\/h4>\n-<p>These advanced make control variables can be potentially unsafe. See\n-<a href=\"#hints-and-suggestions-for-advanced-users\">Hints and\n-Suggestions for Advanced Users<\/a> and <a\n-href=\"#understanding-the-build-system\">Understanding the Build\n-System<\/a> for details.<\/p>\n+<h4 id=\"advanced-make-control-variables\">Advanced Make Control Variables<\/h4>\n+<p>These advanced make control variables can be potentially unsafe. See <a href=\"#hints-and-suggestions-for-advanced-users\">Hints and Suggestions for Advanced Users<\/a> and <a href=\"#understanding-the-build-system\">Understanding the Build System<\/a> for details.<\/p>\n@@ -1080,19 +518,3 @@\n-<p>Most of the JDK tests are using the <a\n-href=\"http:\/\/openjdk.org\/jtreg\">JTReg<\/a> test framework. Make sure that\n-your configuration knows where to find your installation of JTReg. If\n-this is not picked up automatically, use the\n-<code>--with-jtreg=&lt;path to jtreg home&gt;<\/code> option to point to\n-the JTReg framework. Note that this option should point to the JTReg\n-home, i.e. the top directory, containing <code>lib\/jtreg.jar<\/code>\n-etc.<\/p>\n-<p>The <a href=\"https:\/\/wiki.openjdk.org\/display\/Adoption\">Adoption\n-Group<\/a> provides recent builds of jtreg <a\n-href=\"https:\/\/ci.adoptopenjdk.net\/view\/Dependencies\/job\/dependency_pipeline\/lastSuccessfulBuild\/artifact\/jtreg\/\">here<\/a>.\n-Download the latest <code>.tar.gz<\/code> file, unpack it, and point\n-<code>--with-jtreg<\/code> to the <code>jtreg<\/code> directory that you\n-just unpacked.<\/p>\n-<p>Building of Hotspot Gtest suite requires the source code of Google\n-Test framework. The top directory, which contains both\n-<code>googletest<\/code> and <code>googlemock<\/code> directories, should\n-be specified via <code>--with-gtest<\/code>. The supported version of\n-Google Test is 1.8.1, whose source code can be obtained:<\/p>\n+<p>Most of the JDK tests are using the <a href=\"http:\/\/openjdk.org\/jtreg\">JTReg<\/a> test framework. Make sure that your configuration knows where to find your installation of JTReg. If this is not picked up automatically, use the <code>--with-jtreg=&lt;path to jtreg home&gt;<\/code> option to point to the JTReg framework. Note that this option should point to the JTReg home, i.e. the top directory, containing <code>lib\/jtreg.jar<\/code> etc.<\/p>\n+<p>The <a href=\"https:\/\/wiki.openjdk.org\/display\/Adoption\">Adoption Group<\/a> provides recent builds of jtreg <a href=\"https:\/\/ci.adoptopenjdk.net\/view\/Dependencies\/job\/dependency_pipeline\/lastSuccessfulBuild\/artifact\/jtreg\/\">here<\/a>. Download the latest <code>.tar.gz<\/code> file, unpack it, and point <code>--with-jtreg<\/code> to the <code>jtreg<\/code> directory that you just unpacked.<\/p>\n+<p>Building of Hotspot Gtest suite requires the source code of Google Test framework. The top directory, which contains both <code>googletest<\/code> and <code>googlemock<\/code> directories, should be specified via <code>--with-gtest<\/code>. The supported version of Google Test is 1.8.1, whose source code can be obtained:<\/p>\n@@ -1100,5 +522,2 @@\n-<li>by downloading and unpacking the source bundle from <a\n-href=\"https:\/\/github.com\/google\/googletest\/releases\/tag\/release-1.8.1\">here<\/a><\/li>\n-<li>or by checking out <code>release-1.8.1<\/code> tag of\n-<code>googletest<\/code> project:\n-<code>git clone -b release-1.8.1 https:\/\/github.com\/google\/googletest<\/code><\/li>\n+<li>by downloading and unpacking the source bundle from <a href=\"https:\/\/github.com\/google\/googletest\/releases\/tag\/release-1.8.1\">here<\/a><\/li>\n+<li>or by checking out <code>release-1.8.1<\/code> tag of <code>googletest<\/code> project: <code>git clone -b release-1.8.1 https:\/\/github.com\/google\/googletest<\/code><\/li>\n@@ -1108,3 +527,1 @@\n-<p>For more details on how to run tests, please see <strong>Testing the\n-JDK<\/strong> (<a href=\"testing.html\">html<\/a>, <a\n-href=\"testing.md\">markdown<\/a>).<\/p>\n+<p>For more details on how to run tests, please see <strong>Testing the JDK<\/strong> (<a href=\"testing.html\">html<\/a>, <a href=\"testing.md\">markdown<\/a>).<\/p>\n@@ -1113,35 +530,4 @@\n-<p>Modern versions of macOS require applications to be signed and\n-notarizied before distribution. See Apple's documentation for more\n-background on what this means and how it works. To help support this,\n-the JDK build can be configured to automatically sign all native\n-binaries, and the JDK bundle, with all the options needed for successful\n-notarization, as well as all the entitlements required by the JDK. To\n-enable <code>hardened<\/code> signing, use configure parameter\n-<code>--with-macosx-codesign=hardened<\/code> and configure the signing\n-identity you wish to use with\n-<code>--with-macosx-codesign-identity=&lt;identity&gt;<\/code>. The\n-identity refers to a signing identity from Apple that needs to be\n-preinstalled on the build host.<\/p>\n-<p>When not signing for distribution with the hardened option, the JDK\n-build will still attempt to perform <code>adhoc<\/code> signing to add\n-the special entitlement <code>com.apple.security.get-task-allow<\/code>\n-to each binary. This entitlement is required to be able to dump core\n-files from a process. Note that adding this entitlement makes the build\n-invalid for notarization, so it is only added when signing in\n-<code>debug<\/code> mode. To explicitly enable this kind of adhoc\n-signing, use configure parameter\n-<code>--with-macosx-codesign=debug<\/code>. It will be enabled by default\n-in most cases.<\/p>\n-<p>It's also possible to completely disable any explicit codesign\n-operations done by the JDK build using the configure parameter\n-<code>--without-macosx-codesign<\/code>. The exact behavior then depends\n-on the architecture. For macOS on x64, it (at least at the time of this\n-writing) results in completely unsigned binaries that should still work\n-fine for development and debugging purposes. On aarch64, the Xcode\n-linker will apply a default \"adhoc\" signing, without any entitlements.\n-Such a build does not allow dumping core files.<\/p>\n-<p>The default mode \"auto\" will try for <code>hardened<\/code> signing if\n-the debug level is <code>release<\/code> and either the default identity\n-or the specified identity is valid. If hardened isn't possible, then\n-<code>debug<\/code> signing is chosen if it works. If nothing works, the\n-codesign build step is disabled.<\/p>\n+<p>Modern versions of macOS require applications to be signed and notarizied before distribution. See Apple's documentation for more background on what this means and how it works. To help support this, the JDK build can be configured to automatically sign all native binaries, and the JDK bundle, with all the options needed for successful notarization, as well as all the entitlements required by the JDK. To enable <code>hardened<\/code> signing, use configure parameter <code>--with-macosx-codesign=hardened<\/code> and configure the signing identity you wish to use with <code>--with-macosx-codesign-identity=&lt;identity&gt;<\/code>. The identity refers to a signing identity from Apple that needs to be preinstalled on the build host.<\/p>\n+<p>When not signing for distribution with the hardened option, the JDK build will still attempt to perform <code>adhoc<\/code> signing to add the special entitlement <code>com.apple.security.get-task-allow<\/code> to each binary. This entitlement is required to be able to dump core files from a process. Note that adding this entitlement makes the build invalid for notarization, so it is only added when signing in <code>debug<\/code> mode. To explicitly enable this kind of adhoc signing, use configure parameter <code>--with-macosx-codesign=debug<\/code>. It will be enabled by default in most cases.<\/p>\n+<p>It's also possible to completely disable any explicit codesign operations done by the JDK build using the configure parameter <code>--without-macosx-codesign<\/code>. The exact behavior then depends on the architecture. For macOS on x64, it (at least at the time of this writing) results in completely unsigned binaries that should still work fine for development and debugging purposes. On aarch64, the Xcode linker will apply a default &quot;adhoc&quot; signing, without any entitlements. Such a build does not allow dumping core files.<\/p>\n+<p>The default mode &quot;auto&quot; will try for <code>hardened<\/code> signing if the debug level is <code>release<\/code> and either the default identity or the specified identity is valid. If hardened isn't possible, then <code>debug<\/code> signing is chosen if it works. If nothing works, the codesign build step is disabled.<\/p>\n@@ -1149,31 +535,7 @@\n-<p>Cross-compiling means using one platform (the <em>build<\/em>\n-platform) to generate output that can ran on another platform (the\n-<em>target<\/em> platform).<\/p>\n-<p>The typical reason for cross-compiling is that the build is performed\n-on a more powerful desktop computer, but the resulting binaries will be\n-able to run on a different, typically low-performing system. Most of the\n-complications that arise when building for embedded is due to this\n-separation of <em>build<\/em> and <em>target<\/em> systems.<\/p>\n-<p>This requires a more complex setup and build procedure. This section\n-assumes you are familiar with cross-compiling in general, and will only\n-deal with the particularities of cross-compiling the JDK. If you are new\n-to cross-compiling, please see the <a\n-href=\"https:\/\/en.wikipedia.org\/wiki\/Cross_compiler#External_links\">external\n-links at Wikipedia<\/a> for a good start on reading materials.<\/p>\n-<p>Cross-compiling the JDK requires you to be able to build both for the\n-build platform and for the target platform. The reason for the former is\n-that we need to build and execute tools during the build process, both\n-native tools and Java tools.<\/p>\n-<p>If all you want to do is to compile a 32-bit version, for the same\n-OS, on a 64-bit machine, consider using\n-<code>--with-target-bits=32<\/code> instead of doing a full-blown\n-cross-compilation. (While this surely is possible, it's a lot more work\n-and will take much longer to build.)<\/p>\n-<h3 id=\"cross-compiling-the-easy-way-with-openjdk-devkits\">Cross\n-compiling the easy way with OpenJDK devkits<\/h3>\n-<p>The OpenJDK build system provides out-of-the box support for creating\n-and using so called devkits. A <code>devkit<\/code> is basically a\n-collection of a cross-compiling toolchain and a sysroot environment\n-which can easily be used together with the <code>--with-devkit<\/code>\n-configure option to cross compile the OpenJDK. On Linux\/x86_64, the\n-following command:<\/p>\n+<p>Cross-compiling means using one platform (the <em>build<\/em> platform) to generate output that can ran on another platform (the <em>target<\/em> platform).<\/p>\n+<p>The typical reason for cross-compiling is that the build is performed on a more powerful desktop computer, but the resulting binaries will be able to run on a different, typically low-performing system. Most of the complications that arise when building for embedded is due to this separation of <em>build<\/em> and <em>target<\/em> systems.<\/p>\n+<p>This requires a more complex setup and build procedure. This section assumes you are familiar with cross-compiling in general, and will only deal with the particularities of cross-compiling the JDK. If you are new to cross-compiling, please see the <a href=\"https:\/\/en.wikipedia.org\/wiki\/Cross_compiler#External_links\">external links at Wikipedia<\/a> for a good start on reading materials.<\/p>\n+<p>Cross-compiling the JDK requires you to be able to build both for the build platform and for the target platform. The reason for the former is that we need to build and execute tools during the build process, both native tools and Java tools.<\/p>\n+<p>If all you want to do is to compile a 32-bit version, for the same OS, on a 64-bit machine, consider using <code>--with-target-bits=32<\/code> instead of doing a full-blown cross-compilation. (While this surely is possible, it's a lot more work and will take much longer to build.)<\/p>\n+<h3 id=\"cross-compiling-the-easy-way-with-openjdk-devkits\">Cross compiling the easy way with OpenJDK devkits<\/h3>\n+<p>The OpenJDK build system provides out-of-the box support for creating and using so called devkits. A <code>devkit<\/code> is basically a collection of a cross-compiling toolchain and a sysroot environment which can easily be used together with the <code>--with-devkit<\/code> configure option to cross compile the OpenJDK. On Linux\/x86_64, the following command:<\/p>\n@@ -1181,5 +543,2 @@\n-<p>will configure and build OpenJDK for Linux\/ppc64 assuming that\n-<code>&lt;devkit-path&gt;<\/code> points to a Linux\/x86_64 to Linux\/ppc64\n-devkit.<\/p>\n-<p>Devkits can be created from the <code>make\/devkit<\/code> directory by\n-executing:<\/p>\n+<p>will configure and build OpenJDK for Linux\/ppc64 assuming that <code>&lt;devkit-path&gt;<\/code> points to a Linux\/x86_64 to Linux\/ppc64 devkit.<\/p>\n+<p>Devkits can be created from the <code>make\/devkit<\/code> directory by executing:<\/p>\n@@ -1187,6 +546,1 @@\n-<p>where <code>TARGETS<\/code> contains one or more\n-<code>TARGET_TRIPLET<\/code>s of the form described in <a\n-href=\"https:\/\/sourceware.org\/autobook\/autobook\/autobook_17.html\">section\n-3.4 of the GNU Autobook<\/a>. If no targets are given, a native toolchain\n-for the current platform will be created. Currently, at least the\n-following targets are known to work:<\/p>\n+<p>where <code>TARGETS<\/code> contains one or more <code>TARGET_TRIPLET<\/code>s of the form described in <a href=\"https:\/\/sourceware.org\/autobook\/autobook\/autobook_17.html\">section 3.4 of the GNU Autobook<\/a>. If no targets are given, a native toolchain for the current platform will be created. Currently, at least the following targets are known to work:<\/p>\n@@ -1220,6 +574,1 @@\n-<p><code>BASE_OS<\/code> must be one of \"OEL6\" for Oracle Enterprise\n-Linux 6 or \"Fedora\" (if not specified \"OEL6\" will be the default). If\n-the base OS is \"Fedora\" the corresponding Fedora release can be\n-specified with the help of the <code>BASE_OS_VERSION<\/code> option (with\n-\"27\" as default version). If the build is successful, the new devkits\n-can be found in the <code>build\/devkit\/result<\/code> subdirectory:<\/p>\n+<p><code>BASE_OS<\/code> must be one of &quot;OEL6&quot; for Oracle Enterprise Linux 6 or &quot;Fedora&quot; (if not specified &quot;OEL6&quot; will be the default). If the base OS is &quot;Fedora&quot; the corresponding Fedora release can be specified with the help of the <code>BASE_OS_VERSION<\/code> option (with &quot;27&quot; as default version). If the build is successful, the new devkits can be found in the <code>build\/devkit\/result<\/code> subdirectory:<\/p>\n@@ -1231,9 +580,1 @@\n-<p>Notice that devkits are not only useful for targeting different build\n-platforms. Because they contain the full build dependencies for a system\n-(i.e. compiler and root file system), they can easily be used to build\n-well-known, reliable and reproducible build environments. You can for\n-example create and use a devkit with GCC 7.3 and a Fedora 12 sysroot\n-environment (with glibc 2.11) on Ubuntu 14.04 (which doesn't have GCC\n-7.3 by default) to produce OpenJDK binaries which will run on all Linux\n-systems with runtime libraries newer than the ones from Fedora 12 (e.g.\n-Ubuntu 16.04, SLES 11 or RHEL 6).<\/p>\n+<p>Notice that devkits are not only useful for targeting different build platforms. Because they contain the full build dependencies for a system (i.e. compiler and root file system), they can easily be used to build well-known, reliable and reproducible build environments. You can for example create and use a devkit with GCC 7.3 and a Fedora 12 sysroot environment (with glibc 2.11) on Ubuntu 14.04 (which doesn't have GCC 7.3 by default) to produce OpenJDK binaries which will run on all Linux systems with runtime libraries newer than the ones from Fedora 12 (e.g. Ubuntu 16.04, SLES 11 or RHEL 6).<\/p>\n@@ -1241,29 +582,6 @@\n-<p>When cross-compiling, make sure you use a boot JDK that runs on the\n-<em>build<\/em> system, and not on the <em>target<\/em> system.<\/p>\n-<p>To be able to build, we need a \"Build JDK\", which is a JDK built from\n-the current sources (that is, the same as the end result of the entire\n-build process), but able to run on the <em>build<\/em> system, and not\n-the <em>target<\/em> system. (In contrast, the Boot JDK should be from an\n-older release, e.g. JDK 8 when building JDK 9.)<\/p>\n-<p>The build process will create a minimal Build JDK for you, as part of\n-building. To speed up the build, you can use\n-<code>--with-build-jdk<\/code> to <code>configure<\/code> to point to a\n-pre-built Build JDK. Please note that the build result is unpredictable,\n-and can possibly break in subtle ways, if the Build JDK does not\n-<strong>exactly<\/strong> match the current sources.<\/p>\n-<h3 id=\"specifying-the-target-platform\">Specifying the Target\n-Platform<\/h3>\n-<p>You <em>must<\/em> specify the target platform when cross-compiling.\n-Doing so will also automatically turn the build into a cross-compiling\n-mode. The simplest way to do this is to use the\n-<code>--openjdk-target<\/code> argument, e.g.\n-<code>--openjdk-target=arm-linux-gnueabihf<\/code>. or\n-<code>--openjdk-target=aarch64-oe-linux<\/code>. This will automatically\n-set the <code>--host<\/code> and <code>--target<\/code> options for\n-autoconf, which can otherwise be confusing. (In autoconf terminology,\n-the \"target\" is known as \"host\", and \"target\" is used for building a\n-Canadian cross-compiler.)<\/p>\n-<p>If <code>--build<\/code> has not been explicitly passed to configure,\n-<code>--openjdk-target<\/code> will autodetect the build platform and\n-internally set the flag automatically, otherwise the platform that was\n-explicitly passed to <code>--build<\/code> will be used instead.<\/p>\n+<p>When cross-compiling, make sure you use a boot JDK that runs on the <em>build<\/em> system, and not on the <em>target<\/em> system.<\/p>\n+<p>To be able to build, we need a &quot;Build JDK&quot;, which is a JDK built from the current sources (that is, the same as the end result of the entire build process), but able to run on the <em>build<\/em> system, and not the <em>target<\/em> system. (In contrast, the Boot JDK should be from an older release, e.g. JDK 8 when building JDK 9.)<\/p>\n+<p>The build process will create a minimal Build JDK for you, as part of building. To speed up the build, you can use <code>--with-build-jdk<\/code> to <code>configure<\/code> to point to a pre-built Build JDK. Please note that the build result is unpredictable, and can possibly break in subtle ways, if the Build JDK does not <strong>exactly<\/strong> match the current sources.<\/p>\n+<h3 id=\"specifying-the-target-platform\">Specifying the Target Platform<\/h3>\n+<p>You <em>must<\/em> specify the target platform when cross-compiling. Doing so will also automatically turn the build into a cross-compiling mode. The simplest way to do this is to use the <code>--openjdk-target<\/code> argument, e.g. <code>--openjdk-target=arm-linux-gnueabihf<\/code>. or <code>--openjdk-target=aarch64-oe-linux<\/code>. This will automatically set the <code>--host<\/code> and <code>--target<\/code> options for autoconf, which can otherwise be confusing. (In autoconf terminology, the &quot;target&quot; is known as &quot;host&quot;, and &quot;target&quot; is used for building a Canadian cross-compiler.)<\/p>\n+<p>If <code>--build<\/code> has not been explicitly passed to configure, <code>--openjdk-target<\/code> will autodetect the build platform and internally set the flag automatically, otherwise the platform that was explicitly passed to <code>--build<\/code> will be used instead.<\/p>\n@@ -1271,23 +589,3 @@\n-<p>You will need two copies of your toolchain, one which generates\n-output that can run on the target system (the normal, or\n-<em>target<\/em>, toolchain), and one that generates output that can run\n-on the build system (the <em>build<\/em> toolchain). Note that\n-cross-compiling is only supported for gcc at the time being. The gcc\n-standard is to prefix cross-compiling toolchains with the target\n-denominator. If you follow this standard, <code>configure<\/code> is\n-likely to pick up the toolchain correctly.<\/p>\n-<p>The <em>build<\/em> toolchain will be autodetected just the same way\n-the normal <em>build<\/em>\/<em>target<\/em> toolchain will be autodetected\n-when not cross-compiling. If this is not what you want, or if the\n-autodetection fails, you can specify a devkit containing the\n-<em>build<\/em> toolchain using <code>--with-build-devkit<\/code> to\n-<code>configure<\/code>, or by giving <code>BUILD_CC<\/code> and\n-<code>BUILD_CXX<\/code> arguments.<\/p>\n-<p>It is often helpful to locate the cross-compilation tools, headers\n-and libraries in a separate directory, outside the normal path, and\n-point out that directory to <code>configure<\/code>. Do this by setting\n-the sysroot (<code>--with-sysroot<\/code>) and appending the directory\n-when searching for cross-compilations tools\n-(<code>--with-toolchain-path<\/code>). As a compact form, you can also\n-use <code>--with-devkit<\/code> to point to a single directory, if it is\n-correctly setup. (See <code>basics.m4<\/code> for details.)<\/p>\n+<p>You will need two copies of your toolchain, one which generates output that can run on the target system (the normal, or <em>target<\/em>, toolchain), and one that generates output that can run on the build system (the <em>build<\/em> toolchain). Note that cross-compiling is only supported for gcc at the time being. The gcc standard is to prefix cross-compiling toolchains with the target denominator. If you follow this standard, <code>configure<\/code> is likely to pick up the toolchain correctly.<\/p>\n+<p>The <em>build<\/em> toolchain will be autodetected just the same way the normal <em>build<\/em>\/<em>target<\/em> toolchain will be autodetected when not cross-compiling. If this is not what you want, or if the autodetection fails, you can specify a devkit containing the <em>build<\/em> toolchain using <code>--with-build-devkit<\/code> to <code>configure<\/code>, or by giving <code>BUILD_CC<\/code> and <code>BUILD_CXX<\/code> arguments.<\/p>\n+<p>It is often helpful to locate the cross-compilation tools, headers and libraries in a separate directory, outside the normal path, and point out that directory to <code>configure<\/code>. Do this by setting the sysroot (<code>--with-sysroot<\/code>) and appending the directory when searching for cross-compilations tools (<code>--with-toolchain-path<\/code>). As a compact form, you can also use <code>--with-devkit<\/code> to point to a single directory, if it is correctly setup. (See <code>basics.m4<\/code> for details.)<\/p>\n@@ -1295,8 +593,3 @@\n-<p>You will need copies of external native libraries for the\n-<em>target<\/em> system, present on the <em>build<\/em> machine while\n-building.<\/p>\n-<p>Take care not to replace the <em>build<\/em> system's version of these\n-libraries by mistake, since that can render the <em>build<\/em> machine\n-unusable.<\/p>\n-<p>Make sure that the libraries you point to (ALSA, X11, etc) are for\n-the <em>target<\/em>, not the <em>build<\/em>, platform.<\/p>\n+<p>You will need copies of external native libraries for the <em>target<\/em> system, present on the <em>build<\/em> machine while building.<\/p>\n+<p>Take care not to replace the <em>build<\/em> system's version of these libraries by mistake, since that can render the <em>build<\/em> machine unusable.<\/p>\n+<p>Make sure that the libraries you point to (ALSA, X11, etc) are for the <em>target<\/em>, not the <em>build<\/em>, platform.<\/p>\n@@ -1304,5 +597,2 @@\n-<p>You will need alsa libraries suitable for your <em>target<\/em>\n-system. For most cases, using Debian's pre-built libraries work\n-fine.<\/p>\n-<p>Note that alsa is needed even if you only want to build a headless\n-JDK.<\/p>\n+<p>You will need alsa libraries suitable for your <em>target<\/em> system. For most cases, using Debian's pre-built libraries work fine.<\/p>\n+<p>Note that alsa is needed even if you only want to build a headless JDK.<\/p>\n@@ -1310,6 +600,2 @@\n-<li><p>Go to <a href=\"https:\/\/www.debian.org\/distrib\/packages\">Debian\n-Package Search<\/a> and search for the <code>libasound2<\/code> and\n-<code>libasound2-dev<\/code> packages for your <em>target<\/em> system.\n-Download them to \/tmp.<\/p><\/li>\n-<li><p>Install the libraries into the cross-compilation toolchain. For\n-instance:<\/p><\/li>\n+<li><p>Go to <a href=\"https:\/\/www.debian.org\/distrib\/packages\">Debian Package Search<\/a> and search for the <code>libasound2<\/code> and <code>libasound2-dev<\/code> packages for your <em>target<\/em> system. Download them to \/tmp.<\/p><\/li>\n+<li>Install the libraries into the cross-compilation toolchain. For instance:<\/li>\n@@ -1321,2 +607,1 @@\n-<li>If alsa is not properly detected by <code>configure<\/code>, you can\n-point it out by <code>--with-alsa<\/code>.<\/li>\n+<li>If alsa is not properly detected by <code>configure<\/code>, you can point it out by <code>--with-alsa<\/code>.<\/li>\n@@ -1325,4 +610,2 @@\n-<p>You will need X11 libraries suitable for your <em>target<\/em> system.\n-For most cases, using Debian's pre-built libraries work fine.<\/p>\n-<p>Note that X11 is needed even if you only want to build a headless\n-JDK.<\/p>\n+<p>You will need X11 libraries suitable for your <em>target<\/em> system. For most cases, using Debian's pre-built libraries work fine.<\/p>\n+<p>Note that X11 is needed even if you only want to build a headless JDK.<\/p>\n@@ -1330,3 +613,1 @@\n-<li><p>Go to <a href=\"https:\/\/www.debian.org\/distrib\/packages\">Debian\n-Package Search<\/a>, search for the following packages for your\n-<em>target<\/em> system, and download them to \/tmp\/target-x11:<\/p>\n+<li>Go to <a href=\"https:\/\/www.debian.org\/distrib\/packages\">Debian Package Search<\/a>, search for the following packages for your <em>target<\/em> system, and download them to \/tmp\/target-x11:\n@@ -1354,20 +635,13 @@\n-<li><p>Install the libraries into the cross-compilation toolchain. For\n-instance:<\/p>\n-<pre><code>    cd \/tools\/gcc-linaro-arm-linux-gnueabihf-raspbian-2012.09-20120921_linux\/arm-linux-gnueabihf\/libc\/usr\n-    mkdir X11R6\n-    cd X11R6\n-    for deb in \/tmp\/target-x11\/*.deb ; do dpkg-deb -x $deb . ; done\n-    mv usr\/* .\n-    cd lib\n-    cp arm-linux-gnueabihf\/* .\n-    ```\n-\n-You can ignore the following messages. These libraries are not needed to\n-successfully complete a full JDK build.<\/code><\/pre>\n-<p>cp: cannot stat\n-<code>arm-linux-gnueabihf\/libICE.so': No such file or directory cp: cannot stat<\/code>arm-linux-gnueabihf\/libSM.so':\n-No such file or directory cp: cannot stat\n-`arm-linux-gnueabihf\/libXt.so': No such file or directory ```<\/p><\/li>\n-<li><p>If the X11 libraries are not properly detected by\n-<code>configure<\/code>, you can point them out by\n-<code>--with-x<\/code>.<\/p><\/li>\n+<li><p>Install the libraries into the cross-compilation toolchain. For instance:<\/p>\n+<pre><code>cd \/tools\/gcc-linaro-arm-linux-gnueabihf-raspbian-2012.09-20120921_linux\/arm-linux-gnueabihf\/libc\/usr\n+mkdir X11R6\n+cd X11R6\n+for deb in \/tmp\/target-x11\/*.deb ; do dpkg-deb -x $deb . ; done\n+mv usr\/* .\n+cd lib\n+cp arm-linux-gnueabihf\/* .<\/code><\/pre>\n+<p>You can ignore the following messages. These libraries are not needed to successfully complete a full JDK build.<\/p>\n+<pre><code>cp: cannot stat `arm-linux-gnueabihf\/libICE.so&#39;: No such file or directory\n+cp: cannot stat `arm-linux-gnueabihf\/libSM.so&#39;: No such file or directory\n+cp: cannot stat `arm-linux-gnueabihf\/libXt.so&#39;: No such file or directory<\/code><\/pre><\/li>\n+<li><p>If the X11 libraries are not properly detected by <code>configure<\/code>, you can point them out by <code>--with-x<\/code>.<\/p><\/li>\n@@ -1375,12 +649,3 @@\n-<h3 id=\"cross-compiling-with-debian-sysroots\">Cross compiling with\n-Debian sysroots<\/h3>\n-<p>Fortunately, you can create sysroots for foreign architectures with\n-tools provided by your OS. On Debian\/Ubuntu systems, one could use\n-<code>qemu-deboostrap<\/code> to create the <em>target<\/em> system\n-chroot, which would have the native libraries and headers specific to\n-that <em>target<\/em> system. After that, we can use the cross-compiler\n-on the <em>build<\/em> system, pointing into chroot to get the build\n-dependencies right. This allows building for foreign architectures with\n-native compilation speed.<\/p>\n-<p>For example, cross-compiling to AArch64 from x86_64 could be done\n-like this:<\/p>\n+<h3 id=\"cross-compiling-with-debian-sysroots\">Cross compiling with Debian sysroots<\/h3>\n+<p>Fortunately, you can create sysroots for foreign architectures with tools provided by your OS. On Debian\/Ubuntu systems, one could use <code>qemu-deboostrap<\/code> to create the <em>target<\/em> system chroot, which would have the native libraries and headers specific to that <em>target<\/em> system. After that, we can use the cross-compiler on the <em>build<\/em> system, pointing into chroot to get the build dependencies right. This allows building for foreign architectures with native compilation speed.<\/p>\n+<p>For example, cross-compiling to AArch64 from x86_64 could be done like this:<\/p>\n@@ -1388,11 +653,19 @@\n-<li><p>Install cross-compiler on the <em>build<\/em> system:\n-<code>apt install g++-aarch64-linux-gnu gcc-aarch64-linux-gnu<\/code><\/p><\/li>\n-<li><p>Create chroot on the <em>build<\/em> system, configuring it for\n-<em>target<\/em> system:\n-<code>sudo qemu-debootstrap \\       --arch=arm64 \\       --verbose \\       --include=fakeroot,symlinks,build-essential,libx11-dev,libxext-dev,libxrender-dev,libxrandr-dev,libxtst-dev,libxt-dev,libcups2-dev,libfontconfig1-dev,libasound2-dev,libfreetype6-dev,libpng-dev,libffi-dev \\       --resolve-deps \\       buster \\       ~\/sysroot-arm64 \\       http:\/\/httpredir.debian.org\/debian\/<\/code><\/p><\/li>\n-<li><p>Make sure the symlinks inside the newly created chroot point to\n-proper locations:\n-<code>sudo chroot ~\/sysroot-arm64 symlinks -cr .<\/code><\/p><\/li>\n-<li><p>Configure and build with newly created chroot as\n-sysroot\/toolchain-path:\n-<code>sh .\/configure \\       --openjdk-target=aarch64-linux-gnu \\       --with-sysroot=~\/sysroot-arm64     make images     ls build\/linux-aarch64-server-release\/<\/code><\/p><\/li>\n+<li><p>Install cross-compiler on the <em>build<\/em> system:<\/p>\n+<pre><code>apt install g++-aarch64-linux-gnu gcc-aarch64-linux-gnu<\/code><\/pre><\/li>\n+<li><p>Create chroot on the <em>build<\/em> system, configuring it for <em>target<\/em> system:<\/p>\n+<pre><code>sudo qemu-debootstrap \\\n+  --arch=arm64 \\\n+  --verbose \\\n+  --include=fakeroot,symlinks,build-essential,libx11-dev,libxext-dev,libxrender-dev,libxrandr-dev,libxtst-dev,libxt-dev,libcups2-dev,libfontconfig1-dev,libasound2-dev,libfreetype6-dev,libpng-dev,libffi-dev \\\n+  --resolve-deps \\\n+  buster \\\n+  ~\/sysroot-arm64 \\\n+  http:\/\/httpredir.debian.org\/debian\/<\/code><\/pre><\/li>\n+<li><p>Make sure the symlinks inside the newly created chroot point to proper locations:<\/p>\n+<pre><code>sudo chroot ~\/sysroot-arm64 symlinks -cr .<\/code><\/pre><\/li>\n+<li><p>Configure and build with newly created chroot as sysroot\/toolchain-path:<\/p>\n+<pre><code>sh .\/configure \\\n+  --openjdk-target=aarch64-linux-gnu \\\n+  --with-sysroot=~\/sysroot-arm64\n+make images\n+ls build\/linux-aarch64-server-release\/<\/code><\/pre><\/li>\n@@ -1400,4 +673,2 @@\n-<p>The build does not create new files in that chroot, so it can be\n-reused for multiple builds without additional cleanup.<\/p>\n-<p>The build system should automatically detect the toolchain paths and\n-dependencies, but sometimes it might require a little nudge with:<\/p>\n+<p>The build does not create new files in that chroot, so it can be reused for multiple builds without additional cleanup.<\/p>\n+<p>The build system should automatically detect the toolchain paths and dependencies, but sometimes it might require a little nudge with:<\/p>\n@@ -1405,9 +676,4 @@\n-<li><p>Native compilers: override <code>CC<\/code> or <code>CXX<\/code>\n-for <code>.\/configure<\/code><\/p><\/li>\n-<li><p>Freetype lib location: override <code>--with-freetype-lib<\/code>,\n-for example <code>${sysroot}\/usr\/lib\/${target}\/<\/code><\/p><\/li>\n-<li><p>Freetype includes location: override\n-<code>--with-freetype-include<\/code> for example\n-<code>${sysroot}\/usr\/include\/freetype2\/<\/code><\/p><\/li>\n-<li><p>X11 libraries location: override <code>--x-libraries<\/code>, for\n-example <code>${sysroot}\/usr\/lib\/${target}\/<\/code><\/p><\/li>\n+<li><p>Native compilers: override <code>CC<\/code> or <code>CXX<\/code> for <code>.\/configure<\/code><\/p><\/li>\n+<li><p>Freetype lib location: override <code>--with-freetype-lib<\/code>, for example <code>${sysroot}\/usr\/lib\/${target}\/<\/code><\/p><\/li>\n+<li><p>Freetype includes location: override <code>--with-freetype-include<\/code> for example <code>${sysroot}\/usr\/include\/freetype2\/<\/code><\/p><\/li>\n+<li><p>X11 libraries location: override <code>--x-libraries<\/code>, for example <code>${sysroot}\/usr\/lib\/${target}\/<\/code><\/p><\/li>\n@@ -1415,2 +681,1 @@\n-<p>Architectures that are known to successfully cross-compile like this\n-are:<\/p>\n+<p>Architectures that are known to successfully cross-compile like this are:<\/p>\n@@ -1522,6 +787,1 @@\n-<p>A common cross-compilation target is the ARM CPU. When building for\n-ARM, it is useful to set the ABI profile. A number of pre-defined ABI\n-profiles are available using <code>--with-abi-profile<\/code>:\n-arm-vfp-sflt, arm-vfp-hflt, arm-sflt, armv5-vfp-sflt, armv6-vfp-hflt.\n-Note that soft-float ABIs are no longer properly supported by the\n-JDK.<\/p>\n+<p>A common cross-compilation target is the ARM CPU. When building for ARM, it is useful to set the ABI profile. A number of pre-defined ABI profiles are available using <code>--with-abi-profile<\/code>: arm-vfp-sflt, arm-vfp-hflt, arm-sflt, armv5-vfp-sflt, armv6-vfp-hflt. Note that soft-float ABIs are no longer properly supported by the JDK.<\/p>\n@@ -1529,6 +789,1 @@\n-<p>Just like it's possible to cross-compile for a different CPU, it's\n-possible to cross-compile for musl libc on a glibc-based <em>build<\/em>\n-system. A devkit suitable for most target CPU architectures can be\n-obtained from <a href=\"https:\/\/musl.cc\">musl.cc<\/a>. After installing\n-the required packages in the sysroot, configure the build with\n-<code>--openjdk-target<\/code>:<\/p>\n+<p>Just like it's possible to cross-compile for a different CPU, it's possible to cross-compile for musl libc on a glibc-based <em>build<\/em> system. A devkit suitable for most target CPU architectures can be obtained from <a href=\"https:\/\/musl.cc\">musl.cc<\/a>. After installing the required packages in the sysroot, configure the build with <code>--openjdk-target<\/code>:<\/p>\n@@ -1543,6 +798,3 @@\n-<p>The build will end up in a directory named like\n-<code>build\/linux-arm-normal-server-release<\/code>.<\/p>\n-<p>Inside this build output directory, the <code>images\/jdk<\/code> will\n-contain the newly built JDK, for your <em>target<\/em> system.<\/p>\n-<p>Copy these folders to your <em>target<\/em> system. Then you can run\n-e.g. <code>images\/jdk\/bin\/java -version<\/code>.<\/p>\n+<p>The build will end up in a directory named like <code>build\/linux-arm-normal-server-release<\/code>.<\/p>\n+<p>Inside this build output directory, the <code>images\/jdk<\/code> will contain the newly built JDK, for your <em>target<\/em> system.<\/p>\n+<p>Copy these folders to your <em>target<\/em> system. Then you can run e.g. <code>images\/jdk\/bin\/java -version<\/code>.<\/p>\n@@ -1550,6 +802,1 @@\n-<p>Building the JDK requires a lot of horsepower. Some of the build\n-tools can be adjusted to utilize more or less of resources such as\n-parallel threads and memory. The <code>configure<\/code> script analyzes\n-your system and selects reasonable values for such options based on your\n-hardware. If you encounter resource problems, such as out of memory\n-conditions, you can modify the detected values with:<\/p>\n+<p>Building the JDK requires a lot of horsepower. Some of the build tools can be adjusted to utilize more or less of resources such as parallel threads and memory. The <code>configure<\/code> script analyzes your system and selects reasonable values for such options based on your hardware. If you encounter resource problems, such as out of memory conditions, you can modify the detected values with:<\/p>\n@@ -1557,4 +804,2 @@\n-<li><p><code>--with-num-cores<\/code> -- number of cores in the build\n-system, e.g. <code>--with-num-cores=8<\/code>.<\/p><\/li>\n-<li><p><code>--with-memory-size<\/code> -- memory (in MB) available in\n-the build system, e.g. <code>--with-memory-size=1024<\/code><\/p><\/li>\n+<li><p><code>--with-num-cores<\/code> -- number of cores in the build system, e.g. <code>--with-num-cores=8<\/code>.<\/p><\/li>\n+<li><p><code>--with-memory-size<\/code> -- memory (in MB) available in the build system, e.g. <code>--with-memory-size=1024<\/code><\/p><\/li>\n@@ -1562,16 +807,4 @@\n-<p>You can also specify directly the number of build jobs to use with\n-<code>--with-jobs=N<\/code> to <code>configure<\/code>, or\n-<code>JOBS=N<\/code> to <code>make<\/code>. Do not use the <code>-j<\/code>\n-flag to <code>make<\/code>. In most cases it will be ignored by the\n-makefiles, but it can cause problems for some make targets.<\/p>\n-<p>It might also be necessary to specify the JVM arguments passed to the\n-Boot JDK, using e.g. <code>--with-boot-jdk-jvmargs=\"-Xmx8G\"<\/code>.\n-Doing so will override the default JVM arguments passed to the Boot\n-JDK.<\/p>\n-<p>At the end of a successful execution of <code>configure<\/code>, you\n-will get a performance summary, indicating how well the build will\n-perform. Here you will also get performance hints. If you want to build\n-fast, pay attention to those!<\/p>\n-<p>If you want to tweak build performance, run with\n-<code>make LOG=info<\/code> to get a build time summary at the end of the\n-build process.<\/p>\n+<p>You can also specify directly the number of build jobs to use with <code>--with-jobs=N<\/code> to <code>configure<\/code>, or <code>JOBS=N<\/code> to <code>make<\/code>. Do not use the <code>-j<\/code> flag to <code>make<\/code>. In most cases it will be ignored by the makefiles, but it can cause problems for some make targets.<\/p>\n+<p>It might also be necessary to specify the JVM arguments passed to the Boot JDK, using e.g. <code>--with-boot-jdk-jvmargs=&quot;-Xmx8G&quot;<\/code>. Doing so will override the default JVM arguments passed to the Boot JDK.<\/p>\n+<p>At the end of a successful execution of <code>configure<\/code>, you will get a performance summary, indicating how well the build will perform. Here you will also get performance hints. If you want to build fast, pay attention to those!<\/p>\n+<p>If you want to tweak build performance, run with <code>make LOG=info<\/code> to get a build time summary at the end of the build process.<\/p>\n@@ -1579,9 +812,3 @@\n-<p>If you are using network shares, e.g. via NFS, for your source code,\n-make sure the build directory is situated on local disk (e.g. by\n-<code>ln -s \/localdisk\/jdk-build $JDK-SHARE\/build<\/code>). The\n-performance penalty is extremely high for building on a network share;\n-close to unusable.<\/p>\n-<p>Also, make sure that your build tools (including Boot JDK and\n-toolchain) is located on a local disk and not a network share.<\/p>\n-<p>As has been stressed elsewhere, do use SSD for source code and build\n-directory, as well as (if possible) the build tools.<\/p>\n+<p>If you are using network shares, e.g. via NFS, for your source code, make sure the build directory is situated on local disk (e.g. by <code>ln -s \/localdisk\/jdk-build $JDK-SHARE\/build<\/code>). The performance penalty is extremely high for building on a network share; close to unusable.<\/p>\n+<p>Also, make sure that your build tools (including Boot JDK and toolchain) is located on a local disk and not a network share.<\/p>\n+<p>As has been stressed elsewhere, do use SSD for source code and build directory, as well as (if possible) the build tools.<\/p>\n@@ -1589,4 +816,1 @@\n-<p>The use of virus checking software, especially on Windows, can\n-<em>significantly<\/em> slow down building of the JDK. If possible, turn\n-off such software, or exclude the directory containing the JDK source\n-code from on-the-fly checking.<\/p>\n+<p>The use of virus checking software, especially on Windows, can <em>significantly<\/em> slow down building of the JDK. If possible, turn off such software, or exclude the directory containing the JDK source code from on-the-fly checking.<\/p>\n@@ -1594,5 +818,1 @@\n-<p>The JDK build supports building with ccache when using gcc or clang.\n-Using ccache can radically speed up compilation of native code if you\n-often rebuild the same sources. Your milage may vary however, so we\n-recommend evaluating it for yourself. To enable it, make sure it's on\n-the path and configure with <code>--enable-ccache<\/code>.<\/p>\n+<p>The JDK build supports building with ccache when using gcc or clang. Using ccache can radically speed up compilation of native code if you often rebuild the same sources. Your milage may vary however, so we recommend evaluating it for yourself. To enable it, make sure it's on the path and configure with <code>--enable-ccache<\/code>.<\/p>\n@@ -1600,6 +820,2 @@\n-<p>By default, the Hotspot build uses preccompiled headers (PCH) on the\n-toolchains were it is properly supported (clang, gcc, and Visual\n-Studio). Normally, this speeds up the build process, but in some\n-circumstances, it can actually slow things down.<\/p>\n-<p>You can experiment by disabling precompiled headers using\n-<code>--disable-precompiled-headers<\/code>.<\/p>\n+<p>By default, the Hotspot build uses preccompiled headers (PCH) on the toolchains were it is properly supported (clang, gcc, and Visual Studio). Normally, this speeds up the build process, but in some circumstances, it can actually slow things down.<\/p>\n+<p>You can experiment by disabling precompiled headers using <code>--disable-precompiled-headers<\/code>.<\/p>\n@@ -1607,13 +823,4 @@\n-<p><a href=\"http:\/\/github.com\/icecc\/icecream\">icecc\/icecream<\/a> is a\n-simple way to setup a distributed compiler network. If you have multiple\n-machines available for building the JDK, you can drastically cut\n-individual build times by utilizing it.<\/p>\n-<p>To use, setup an icecc network, and install icecc on the build\n-machine. Then run <code>configure<\/code> using\n-<code>--enable-icecc<\/code>.<\/p>\n-<h3 id=\"using-the-javac-server\">Using the javac server<\/h3>\n-<p>To speed up compilation of Java code, especially during incremental\n-compilations, the javac server is automatically enabled in the\n-configuration step by default. To explicitly enable or disable the javac\n-server, use either <code>--enable-javac-server<\/code> or\n-<code>--disable-javac-server<\/code>.<\/p>\n+<p><a href=\"http:\/\/github.com\/icecc\/icecream\">icecc\/icecream<\/a> is a simple way to setup a distributed compiler network. If you have multiple machines available for building the JDK, you can drastically cut individual build times by utilizing it.<\/p>\n+<p>To use, setup an icecc network, and install icecc on the build machine. Then run <code>configure<\/code> using <code>--enable-icecc<\/code>.<\/p>\n+<h3 id=\"using-sjavac\">Using sjavac<\/h3>\n+<p>To speed up compilation of Java code, especially during incremental compilations, the sjavac server is automatically enabled in the configuration step by default. To explicitly enable or disable sjavac, use either <code>--enable-javac-server<\/code> or <code>--disable-javac-server<\/code>.<\/p>\n@@ -1621,7 +828,2 @@\n-<p>Selecting the proper target to build can have dramatic impact on\n-build time. For normal usage, <code>jdk<\/code> or the default target is\n-just fine. You only need to build <code>images<\/code> for shipping, or\n-if your tests require it.<\/p>\n-<p>See also <a href=\"#using-fine-grained-make-targets\">Using\n-Fine-Grained Make Targets<\/a> on how to build an even smaller subset of\n-the product.<\/p>\n+<p>Selecting the proper target to build can have dramatic impact on build time. For normal usage, <code>jdk<\/code> or the default target is just fine. You only need to build <code>images<\/code> for shipping, or if your tests require it.<\/p>\n+<p>See also <a href=\"#using-fine-grained-make-targets\">Using Fine-Grained Make Targets<\/a> on how to build an even smaller subset of the product.<\/p>\n@@ -1629,7 +831,3 @@\n-<p>If your build fails, it can sometimes be difficult to pinpoint the\n-problem or find a proper solution.<\/p>\n-<h3 id=\"locating-the-source-of-the-error\">Locating the Source of the\n-Error<\/h3>\n-<p>When a build fails, it can be hard to pinpoint the actual cause of\n-the error. In a typical build process, different parts of the product\n-build in parallel, with the output interlaced.<\/p>\n+<p>If your build fails, it can sometimes be difficult to pinpoint the problem or find a proper solution.<\/p>\n+<h3 id=\"locating-the-source-of-the-error\">Locating the Source of the Error<\/h3>\n+<p>When a build fails, it can be hard to pinpoint the actual cause of the error. In a typical build process, different parts of the product build in parallel, with the output interlaced.<\/p>\n@@ -1637,2 +835,1 @@\n-<p>To help you, the build system will print a failure summary at the\n-end. It looks like this:<\/p>\n+<p>To help you, the build system will print a failure summary at the end. It looks like this:<\/p>\n@@ -1656,35 +853,6 @@\n-<p>Let's break it down! First, the selected configuration, and the\n-top-level target you entered on the command line that caused the failure\n-is printed.<\/p>\n-<p>Then, between the\n-<code>Output from failing command(s) repeated here<\/code> and\n-<code>End of repeated output<\/code> the first lines of output (stdout\n-and stderr) from the actual failing command is repeated. In most cases,\n-this is the error message that caused the build to fail. If multiple\n-commands were failing (this can happen in a parallel build), output from\n-all failed commands will be printed here.<\/p>\n-<p>The path to the <code>failure-logs<\/code> directory is printed. In\n-this file you will find a <code>&lt;target&gt;.log<\/code> file that\n-contains the output from this command in its entirety, and also a\n-<code>&lt;target&gt;.cmd<\/code>, which contain the complete command line\n-used for running this command. You can re-run the failing command by\n-executing <code>. &lt;path to failure-logs&gt;\/&lt;target&gt;.cmd<\/code>\n-in your shell.<\/p>\n-<p>Another way to trace the failure is to follow the chain of make\n-targets, from top-level targets to individual file targets. Between\n-<code>Make failed targets repeated here<\/code> and\n-<code>End of repeated output<\/code> the output from make showing this\n-chain is repeated. The first failed recipe will typically contain the\n-full path to the file in question that failed to compile. Following\n-lines will show a trace of make targets why we ended up trying to\n-compile that file.<\/p>\n-<p>Finally, some hints are given on how to locate the error in the\n-complete log. In this example, we would try searching the log file for\n-\"<code>psMemoryPool.o<\/code>\". Another way to quickly locate make errors\n-in the log is to search for \"<code>] Error<\/code>\" or\n-\"<code>***<\/code>\".<\/p>\n-<p>Note that the build failure summary will only help you if the issue\n-was a compilation failure or similar. If the problem is more esoteric,\n-or is due to errors in the build machinery, you will likely get empty\n-output logs, and <code>No indication of failed target found<\/code>\n-instead of the make target chain.<\/p>\n+<p>Let's break it down! First, the selected configuration, and the top-level target you entered on the command line that caused the failure is printed.<\/p>\n+<p>Then, between the <code>Output from failing command(s) repeated here<\/code> and <code>End of repeated output<\/code> the first lines of output (stdout and stderr) from the actual failing command is repeated. In most cases, this is the error message that caused the build to fail. If multiple commands were failing (this can happen in a parallel build), output from all failed commands will be printed here.<\/p>\n+<p>The path to the <code>failure-logs<\/code> directory is printed. In this file you will find a <code>&lt;target&gt;.log<\/code> file that contains the output from this command in its entirety, and also a <code>&lt;target&gt;.cmd<\/code>, which contain the complete command line used for running this command. You can re-run the failing command by executing <code>. &lt;path to failure-logs&gt;\/&lt;target&gt;.cmd<\/code> in your shell.<\/p>\n+<p>Another way to trace the failure is to follow the chain of make targets, from top-level targets to individual file targets. Between <code>Make failed targets repeated here<\/code> and <code>End of repeated output<\/code> the output from make showing this chain is repeated. The first failed recipe will typically contain the full path to the file in question that failed to compile. Following lines will show a trace of make targets why we ended up trying to compile that file.<\/p>\n+<p>Finally, some hints are given on how to locate the error in the complete log. In this example, we would try searching the log file for &quot;<code>psMemoryPool.o<\/code>&quot;. Another way to quickly locate make errors in the log is to search for &quot;<code>] Error<\/code>&quot; or &quot;<code>***<\/code>&quot;.<\/p>\n+<p>Note that the build failure summary will only help you if the issue was a compilation failure or similar. If the problem is more esoteric, or is due to errors in the build machinery, you will likely get empty output logs, and <code>No indication of failed target found<\/code> instead of the make target chain.<\/p>\n@@ -1692,51 +860,12 @@\n-<p>The output (stdout and stderr) from the latest build is always stored\n-in <code>$BUILD\/build.log<\/code>. The previous build log is stored as\n-<code>build.log.old<\/code>. This means that it is not necessary to\n-redirect the build output yourself if you want to process it.<\/p>\n-<p>You can increase the verbosity of the log file, by the\n-<code>LOG<\/code> control variable to <code>make<\/code>. If you want to\n-see the command lines used in compilations, use\n-<code>LOG=cmdlines<\/code>. To increase the general verbosity, use\n-<code>LOG=info<\/code>, <code>LOG=debug<\/code> or <code>LOG=trace<\/code>.\n-Both of these can be combined with <code>cmdlines<\/code>, e.g.\n-<code>LOG=info,cmdlines<\/code>. The <code>debug<\/code> log level will\n-show most shell commands executed by make, and <code>trace<\/code> will\n-show all. Beware that both these log levels will produce a massive build\n-log!<\/p>\n-<h3 id=\"fixing-unexpected-build-failures\">Fixing Unexpected Build\n-Failures<\/h3>\n-<p>Most of the time, the build will fail due to incorrect changes in the\n-source code.<\/p>\n-<p>Sometimes the build can fail with no apparent changes that have\n-caused the failure. If this is the first time you are building the JDK\n-on this particular computer, and the build fails, the problem is likely\n-with your build environment. But even if you have previously built the\n-JDK with success, and it now fails, your build environment might have\n-changed (perhaps due to OS upgrades or similar). But most likely, such\n-failures are due to problems with the incremental rebuild.<\/p>\n-<h4 id=\"problems-with-the-build-environment\">Problems with the Build\n-Environment<\/h4>\n-<p>Make sure your configuration is correct. Re-run\n-<code>configure<\/code>, and look for any warnings. Warnings that appear\n-in the middle of the <code>configure<\/code> output is also repeated at\n-the end, after the summary. The entire log is stored in\n-<code>$BUILD\/configure.log<\/code>.<\/p>\n-<p>Verify that the summary at the end looks correct. Are you indeed\n-using the Boot JDK and native toolchain that you expect?<\/p>\n-<p>By default, the JDK has a strict approach where warnings from the\n-compiler is considered errors which fail the build. For very new or very\n-old compiler versions, this can trigger new classes of warnings, which\n-thus fails the build. Run <code>configure<\/code> with\n-<code>--disable-warnings-as-errors<\/code> to turn of this behavior. (The\n-warnings will still show, but not make the build fail.)<\/p>\n-<h4 id=\"problems-with-incremental-rebuilds\">Problems with Incremental\n-Rebuilds<\/h4>\n-<p>Incremental rebuilds mean that when you modify part of the product,\n-only the affected parts get rebuilt. While this works great in most\n-cases, and significantly speed up the development process, from time to\n-time complex interdependencies will result in an incorrect build result.\n-This is the most common cause for unexpected build problems.<\/p>\n-<p>Here are a suggested list of things to try if you are having\n-unexpected build problems. Each step requires more time than the one\n-before, so try them in order. Most issues will be solved at step 1 or\n-2.<\/p>\n+<p>The output (stdout and stderr) from the latest build is always stored in <code>$BUILD\/build.log<\/code>. The previous build log is stored as <code>build.log.old<\/code>. This means that it is not necessary to redirect the build output yourself if you want to process it.<\/p>\n+<p>You can increase the verbosity of the log file, by the <code>LOG<\/code> control variable to <code>make<\/code>. If you want to see the command lines used in compilations, use <code>LOG=cmdlines<\/code>. To increase the general verbosity, use <code>LOG=info<\/code>, <code>LOG=debug<\/code> or <code>LOG=trace<\/code>. Both of these can be combined with <code>cmdlines<\/code>, e.g. <code>LOG=info,cmdlines<\/code>. The <code>debug<\/code> log level will show most shell commands executed by make, and <code>trace<\/code> will show all. Beware that both these log levels will produce a massive build log!<\/p>\n+<h3 id=\"fixing-unexpected-build-failures\">Fixing Unexpected Build Failures<\/h3>\n+<p>Most of the time, the build will fail due to incorrect changes in the source code.<\/p>\n+<p>Sometimes the build can fail with no apparent changes that have caused the failure. If this is the first time you are building the JDK on this particular computer, and the build fails, the problem is likely with your build environment. But even if you have previously built the JDK with success, and it now fails, your build environment might have changed (perhaps due to OS upgrades or similar). But most likely, such failures are due to problems with the incremental rebuild.<\/p>\n+<h4 id=\"problems-with-the-build-environment\">Problems with the Build Environment<\/h4>\n+<p>Make sure your configuration is correct. Re-run <code>configure<\/code>, and look for any warnings. Warnings that appear in the middle of the <code>configure<\/code> output is also repeated at the end, after the summary. The entire log is stored in <code>$BUILD\/configure.log<\/code>.<\/p>\n+<p>Verify that the summary at the end looks correct. Are you indeed using the Boot JDK and native toolchain that you expect?<\/p>\n+<p>By default, the JDK has a strict approach where warnings from the compiler is considered errors which fail the build. For very new or very old compiler versions, this can trigger new classes of warnings, which thus fails the build. Run <code>configure<\/code> with <code>--disable-warnings-as-errors<\/code> to turn of this behavior. (The warnings will still show, but not make the build fail.)<\/p>\n+<h4 id=\"problems-with-incremental-rebuilds\">Problems with Incremental Rebuilds<\/h4>\n+<p>Incremental rebuilds mean that when you modify part of the product, only the affected parts get rebuilt. While this works great in most cases, and significantly speed up the development process, from time to time complex interdependencies will result in an incorrect build result. This is the most common cause for unexpected build problems.<\/p>\n+<p>Here are a suggested list of things to try if you are having unexpected build problems. Each step requires more time than the one before, so try them in order. Most issues will be solved at step 1 or 2.<\/p>\n@@ -1745,2 +874,1 @@\n-<p>Run <code>git pull origin master<\/code> to make sure you have the\n-latest changes.<\/p><\/li>\n+<p>Run <code>git pull origin master<\/code> to make sure you have the latest changes.<\/p><\/li>\n@@ -1748,5 +876,1 @@\n-<p>The simplest way to fix incremental rebuild issues is to run\n-<code>make clean<\/code>. This will remove all build results, but not the\n-configuration or any build system support artifacts. In most cases, this\n-will solve build errors resulting from incremental build\n-mismatches.<\/p><\/li>\n+<p>The simplest way to fix incremental rebuild issues is to run <code>make clean<\/code>. This will remove all build results, but not the configuration or any build system support artifacts. In most cases, this will solve build errors resulting from incremental build mismatches.<\/p><\/li>\n@@ -1754,8 +878,1 @@\n-<p>If this does not work, the next step is to run\n-<code>make dist-clean<\/code>, or removing the build output directory\n-(<code>$BUILD<\/code>). This will clean all generated output, including\n-your configuration. You will need to re-run <code>configure<\/code> after\n-this step. A good idea is to run <code>make print-configuration<\/code>\n-before running <code>make dist-clean<\/code>, as this will print your\n-current <code>configure<\/code> command line. Here's a way to do\n-this:<\/p>\n+<p>If this does not work, the next step is to run <code>make dist-clean<\/code>, or removing the build output directory (<code>$BUILD<\/code>). This will clean all generated output, including your configuration. You will need to re-run <code>configure<\/code> after this step. A good idea is to run <code>make print-configuration<\/code> before running <code>make dist-clean<\/code>, as this will print your current <code>configure<\/code> command line. Here's a way to do this:<\/p>\n@@ -1767,5 +884,1 @@\n-<p>Sometimes the Git repository gets in a state that causes the product\n-to be un-buildable. In such a case, the simplest solution is often the\n-\"sledgehammer approach\": delete the entire repository, and re-clone it.\n-If you have local changes, save them first to a different location using\n-<code>git format-patch<\/code>.<\/p><\/li>\n+<p>Sometimes the Git repository gets in a state that causes the product to be un-buildable. In such a case, the simplest solution is often the &quot;sledgehammer approach&quot;: delete the entire repository, and re-clone it. If you have local changes, save them first to a different location using <code>git format-patch<\/code>.<\/p><\/li>\n@@ -1778,7 +891,2 @@\n-<p>then the clock on your build machine is out of sync with the\n-timestamps on the source files. Other errors, apparently unrelated but\n-in fact caused by the clock skew, can occur along with the clock skew\n-warnings. These secondary errors may tend to obscure the fact that the\n-true root cause of the problem is an out-of-sync clock.<\/p>\n-<p>If you see these warnings, reset the clock on the build machine, run\n-<code>make clean<\/code> and restart the build.<\/p>\n+<p>then the clock on your build machine is out of sync with the timestamps on the source files. Other errors, apparently unrelated but in fact caused by the clock skew, can occur along with the clock skew warnings. These secondary errors may tend to obscure the fact that the true root cause of the problem is an out-of-sync clock.<\/p>\n+<p>If you see these warnings, reset the clock on the build machine, run <code>make clean<\/code> and restart the build.<\/p>\n@@ -1790,3 +898,1 @@\n-<p>This can be a sign of a Cygwin problem. See the information about\n-solving problems in the <a href=\"#cygwin\">Cygwin<\/a> section. Rebooting\n-the computer might help temporarily.<\/p>\n+<p>This can be a sign of a Cygwin problem. See the information about solving problems in the <a href=\"#cygwin\">Cygwin<\/a> section. Rebooting the computer might help temporarily.<\/p>\n@@ -1794,9 +900,1 @@\n-<p>On Windows, when configuring, <code>fixpath.sh<\/code> may report that\n-some directory names have spaces. Usually, it assumes those directories\n-have <a\n-href=\"https:\/\/docs.microsoft.com\/en-us\/windows-server\/administration\/windows-commands\/fsutil-8dot3name\">short\n-paths<\/a>. You can run <code>fsutil file setshortname<\/code> in\n-<code>cmd<\/code> on certain directories, such as\n-<code>Microsoft Visual Studio<\/code> or <code>Windows Kits<\/code>, to\n-assign arbitrary short paths so <code>configure<\/code> can access\n-them.<\/p>\n+<p>On Windows, when configuring, <code>fixpath.sh<\/code> may report that some directory names have spaces. Usually, it assumes those directories have <a href=\"https:\/\/docs.microsoft.com\/en-us\/windows-server\/administration\/windows-commands\/fsutil-8dot3name\">short paths<\/a>. You can run <code>fsutil file setshortname<\/code> in <code>cmd<\/code> on certain directories, such as <code>Microsoft Visual Studio<\/code> or <code>Windows Kits<\/code>, to assign arbitrary short paths so <code>configure<\/code> can access them.<\/p>\n@@ -1804,9 +902,2 @@\n-<p>If none of the suggestions in this document helps you, or if you find\n-what you believe is a bug in the build system, please contact the Build\n-Group by sending a mail to <a\n-href=\"mailto:build-dev@openjdk.org\">build-dev@openjdk.org<\/a>. Please\n-include the relevant parts of the configure and\/or build log.<\/p>\n-<p>If you need general help or advice about developing for the JDK, you\n-can also contact the Adoption Group. See the section on <a\n-href=\"#contributing-to-openjdk\">Contributing to OpenJDK<\/a> for more\n-information.<\/p>\n+<p>If none of the suggestions in this document helps you, or if you find what you believe is a bug in the build system, please contact the Build Group by sending a mail to <a href=\"mailto:build-dev@openjdk.org\">build-dev@openjdk.org<\/a>. Please include the relevant parts of the configure and\/or build log.<\/p>\n+<p>If you need general help or advice about developing for the JDK, you can also contact the Adoption Group. See the section on <a href=\"#contributing-to-openjdk\">Contributing to OpenJDK<\/a> for more information.<\/p>\n@@ -1814,32 +905,6 @@\n-<p>Build reproducibility is the property of getting exactly the same\n-bits out when building, every time, independent on who builds the\n-product, or where. This is for many reasons a harder goal than it\n-initially appears, but it is an important goal, for security reasons and\n-others. Please see <a\n-href=\"https:\/\/reproducible-builds.org\">Reproducible Builds<\/a> for more\n-information about the background and reasons for reproducible\n-builds.<\/p>\n-<p>Currently, it is not possible to build OpenJDK fully reproducibly,\n-but getting there is an ongoing effort.<\/p>\n-<p>An absolute prerequisite for building reproducible is to speficy a\n-fixed build time, since time stamps are embedded in many file formats.\n-This is done by setting the <code>SOURCE_DATE_EPOCH<\/code> environment\n-variable, which is an <a\n-href=\"https:\/\/reproducible-builds.org\/docs\/source-date-epoch\/\">industry\n-standard<\/a>, that many tools, such as gcc, recognize, and use in place\n-of the current time when generating output.<\/p>\n-<p>To generate reproducible builds, you must set\n-<code>SOURCE_DATE_EPOCH<\/code> before running <code>configure<\/code>.\n-The value in <code>SOURCE_DATE_EPOCH<\/code> will be stored in the\n-configuration, and used by <code>make<\/code>. Setting\n-<code>SOURCE_DATE_EPOCH<\/code> before running <code>make<\/code> will\n-have no effect on the build.<\/p>\n-<p>You must also make sure your build does not rely on\n-<code>configure<\/code>'s default adhoc version strings. Default adhoc\n-version strings <code>OPT<\/code> segment include user name and source\n-directory. You can either override just the <code>OPT<\/code> segment\n-using <code>--with-version-opt=&lt;any fixed string&gt;<\/code>, or you\n-can specify the entire version string using\n-<code>--with-version-string=&lt;your version&gt;<\/code>.<\/p>\n-<p>This is a typical example of how to build the JDK in a reproducible\n-way:<\/p>\n+<p>Build reproducibility is the property of getting exactly the same bits out when building, every time, independent on who builds the product, or where. This is for many reasons a harder goal than it initially appears, but it is an important goal, for security reasons and others. Please see <a href=\"https:\/\/reproducible-builds.org\">Reproducible Builds<\/a> for more information about the background and reasons for reproducible builds.<\/p>\n+<p>Currently, it is not possible to build OpenJDK fully reproducibly, but getting there is an ongoing effort.<\/p>\n+<p>An absolute prerequisite for building reproducible is to speficy a fixed build time, since time stamps are embedded in many file formats. This is done by setting the <code>SOURCE_DATE_EPOCH<\/code> environment variable, which is an <a href=\"https:\/\/reproducible-builds.org\/docs\/source-date-epoch\/\">industry standard<\/a>, that many tools, such as gcc, recognize, and use in place of the current time when generating output.<\/p>\n+<p>To generate reproducible builds, you must set <code>SOURCE_DATE_EPOCH<\/code> before running <code>configure<\/code>. The value in <code>SOURCE_DATE_EPOCH<\/code> will be stored in the configuration, and used by <code>make<\/code>. Setting <code>SOURCE_DATE_EPOCH<\/code> before running <code>make<\/code> will have no effect on the build.<\/p>\n+<p>You must also make sure your build does not rely on <code>configure<\/code>'s default adhoc version strings. Default adhoc version strings <code>OPT<\/code> segment include user name and source directory. You can either override just the <code>OPT<\/code> segment using <code>--with-version-opt=&lt;any fixed string&gt;<\/code>, or you can specify the entire version string using <code>--with-version-string=&lt;your version&gt;<\/code>.<\/p>\n+<p>This is a typical example of how to build the JDK in a reproducible way:<\/p>\n@@ -1849,11 +914,2 @@\n-<p>Note that regardless if you specify a source date for\n-<code>configure<\/code> or not, the JDK build system will set\n-<code>SOURCE_DATE_EPOCH<\/code> for all build tools when building. If\n-<code>--with-source-date<\/code> has the value <code>current<\/code>\n-(which is the default unless <code>SOURCE_DATE_EPOCH<\/code> is found by\n-in the environment by <code>configure<\/code>), the source date value\n-will be determined at configure time.<\/p>\n-<p>There are several aspects of reproducible builds that can be\n-individually adjusted by <code>configure<\/code> arguments. If any of\n-these are given, they will override the value derived from\n-<code>SOURCE_DATE_EPOCH<\/code>. These arguments are:<\/p>\n+<p>Note that regardless if you specify a source date for <code>configure<\/code> or not, the JDK build system will set <code>SOURCE_DATE_EPOCH<\/code> for all build tools when building. If <code>--with-source-date<\/code> has the value <code>current<\/code> (which is the default unless <code>SOURCE_DATE_EPOCH<\/code> is found by in the environment by <code>configure<\/code>), the source date value will be determined at configure time.<\/p>\n+<p>There are several aspects of reproducible builds that can be individually adjusted by <code>configure<\/code> arguments. If any of these are given, they will override the value derived from <code>SOURCE_DATE_EPOCH<\/code>. These arguments are:<\/p>\n@@ -1862,17 +918,3 @@\n-<p>This option controls how the JDK build sets\n-<code>SOURCE_DATE_EPOCH<\/code> when building. It can be set to a value\n-describing a date, either an epoch based timestamp as an integer, or a\n-valid ISO-8601 date.<\/p>\n-<p>It can also be set to one of the special values <code>current<\/code>,\n-<code>updated<\/code> or <code>version<\/code>. <code>current<\/code> means\n-that the time of running <code>configure<\/code> will be used.\n-<code>version<\/code> will use the nominal release date for the current\n-JDK version. <code>updated<\/code>, which means that\n-<code>SOURCE_DATE_EPOCH<\/code> will be set to the current time each time\n-you are running <code>make<\/code>. All choices, except for\n-<code>updated<\/code>, will set a fixed value for the source date\n-timestamp.<\/p>\n-<p>When <code>SOURCE_DATE_EPOCH<\/code> is set, the default value for\n-<code>--with-source-date<\/code> will be the value given by\n-<code>SOURCE_DATE_EPOCH<\/code>. Otherwise, the default value is\n-<code>current<\/code>.<\/p><\/li>\n+<p>This option controls how the JDK build sets <code>SOURCE_DATE_EPOCH<\/code> when building. It can be set to a value describing a date, either an epoch based timestamp as an integer, or a valid ISO-8601 date.<\/p>\n+<p>It can also be set to one of the special values <code>current<\/code>, <code>updated<\/code> or <code>version<\/code>. <code>current<\/code> means that the time of running <code>configure<\/code> will be used. <code>version<\/code> will use the nominal release date for the current JDK version. <code>updated<\/code>, which means that <code>SOURCE_DATE_EPOCH<\/code> will be set to the current time each time you are running <code>make<\/code>. All choices, except for <code>updated<\/code>, will set a fixed value for the source date timestamp.<\/p>\n+<p>When <code>SOURCE_DATE_EPOCH<\/code> is set, the default value for <code>--with-source-date<\/code> will be the value given by <code>SOURCE_DATE_EPOCH<\/code>. Otherwise, the default value is <code>current<\/code>.<\/p><\/li>\n@@ -1880,7 +922,1 @@\n-<p>This option controls the build time string that will be included in\n-the hotspot library (<code>libjvm.so<\/code> or <code>jvm.dll<\/code>).\n-When the source date is fixed (e.g. by setting\n-<code>SOURCE_DATE_EPOCH<\/code>), the default value for\n-<code>--with-hotspot-build-time<\/code> will be an ISO 8601\n-representation of that time stamp. Otherwise the default value will be\n-the current time when building hotspot.<\/p><\/li>\n+<p>This option controls the build time string that will be included in the hotspot library (<code>libjvm.so<\/code> or <code>jvm.dll<\/code>). When the source date is fixed (e.g. by setting <code>SOURCE_DATE_EPOCH<\/code>), the default value for <code>--with-hotspot-build-time<\/code> will be an ISO 8601 representation of that time stamp. Otherwise the default value will be the current time when building hotspot.<\/p><\/li>\n@@ -1888,7 +924,1 @@\n-<p>This option controls the copyright year in some generated text files.\n-When the source date is fixed (e.g. by setting\n-<code>SOURCE_DATE_EPOCH<\/code>), the default value for\n-<code>--with-copyright-year<\/code> will be the year of that time stamp.\n-Otherwise the default is the current year at the time of running\n-configure. This can be overridden by\n-<code>--with-copyright-year=&lt;year&gt;<\/code>.<\/p><\/li>\n+<p>This option controls the copyright year in some generated text files. When the source date is fixed (e.g. by setting <code>SOURCE_DATE_EPOCH<\/code>), the default value for <code>--with-copyright-year<\/code> will be the year of that time stamp. Otherwise the default is the current year at the time of running configure. This can be overridden by <code>--with-copyright-year=&lt;year&gt;<\/code>.<\/p><\/li>\n@@ -1896,5 +926,1 @@\n-<p>This option controls some additional behavior needed to make the\n-build reproducible. When the source date is fixed (e.g. by setting\n-<code>SOURCE_DATE_EPOCH<\/code>), this flag will be turned on by default.\n-Otherwise, the value is determined by heuristics. If it is explicitly\n-turned off, the build might not be reproducible.<\/p><\/li>\n+<p>This option controls some additional behavior needed to make the build reproducible. When the source date is fixed (e.g. by setting <code>SOURCE_DATE_EPOCH<\/code>), this flag will be turned on by default. Otherwise, the value is determined by heuristics. If it is explicitly turned off, the build might not be reproducible.<\/p><\/li>\n@@ -1902,2 +928,1 @@\n-<h2 id=\"hints-and-suggestions-for-advanced-users\">Hints and Suggestions\n-for Advanced Users<\/h2>\n+<h2 id=\"hints-and-suggestions-for-advanced-users\">Hints and Suggestions for Advanced Users<\/h2>\n@@ -1905,15 +930,3 @@\n-<p>The <code>configure<\/code> and <code>make<\/code> commands tries to\n-play nice with bash command-line completion (using\n-<code>&lt;tab&gt;<\/code> or <code>&lt;tab&gt;&lt;tab&gt;<\/code>). To use\n-this functionality, make sure you enable completion in your\n-<code>~\/.bashrc<\/code> (see instructions for bash in your operating\n-system).<\/p>\n-<p>Make completion will work out of the box, and will complete valid\n-make targets. For instance, typing <code>make jdk-i&lt;tab&gt;<\/code>\n-will complete to <code>make jdk-image<\/code>.<\/p>\n-<p>The <code>configure<\/code> script can get completion for options, but\n-for this to work you need to help <code>bash<\/code> on the way. The\n-standard way of running the script, <code>bash configure<\/code>, will\n-not be understood by bash completion. You need <code>configure<\/code> to\n-be the command to run. One way to achieve this is to add a simple helper\n-script to your path:<\/p>\n+<p>The <code>configure<\/code> and <code>make<\/code> commands tries to play nice with bash command-line completion (using <code>&lt;tab&gt;<\/code> or <code>&lt;tab&gt;&lt;tab&gt;<\/code>). To use this functionality, make sure you enable completion in your <code>~\/.bashrc<\/code> (see instructions for bash in your operating system).<\/p>\n+<p>Make completion will work out of the box, and will complete valid make targets. For instance, typing <code>make jdk-i&lt;tab&gt;<\/code> will complete to <code>make jdk-image<\/code>.<\/p>\n+<p>The <code>configure<\/code> script can get completion for options, but for this to work you need to help <code>bash<\/code> on the way. The standard way of running the script, <code>bash configure<\/code>, will not be understood by bash completion. You need <code>configure<\/code> to be the command to run. One way to achieve this is to add a simple helper script to your path:<\/p>\n@@ -1931,21 +944,4 @@\n-<p>Now <code>configure --en&lt;tab&gt;-dt&lt;tab&gt;<\/code> will result\n-in <code>configure --enable-dtrace<\/code>.<\/p>\n-<h3 id=\"using-multiple-configurations\">Using Multiple\n-Configurations<\/h3>\n-<p>You can have multiple configurations for a single source repository.\n-When you create a new configuration, run\n-<code>configure --with-conf-name=&lt;name&gt;<\/code> to create a\n-configuration with the name <code>&lt;name&gt;<\/code>. Alternatively,\n-you can create a directory under <code>build<\/code> and run\n-<code>configure<\/code> from there, e.g.\n-<code>mkdir build\/&lt;name&gt; &amp;&amp; cd build\/&lt;name&gt; &amp;&amp; bash ..\/..\/configure<\/code>.<\/p>\n-<p>Then you can build that configuration using\n-<code>make CONF_NAME=&lt;name&gt;<\/code> or\n-<code>make CONF=&lt;pattern&gt;<\/code>, where\n-<code>&lt;pattern&gt;<\/code> is a substring matching one or several\n-configurations, e.g. <code>CONF=debug<\/code>. The special empty pattern\n-(<code>CONF=<\/code>) will match <em>all<\/em> available configuration, so\n-<code>make CONF= hotspot<\/code> will build the <code>hotspot<\/code>\n-target for all configurations. Alternatively, you can execute\n-<code>make<\/code> in the configuration directory, e.g.\n-<code>cd build\/&lt;name&gt; &amp;&amp; make<\/code>.<\/p>\n+<p>Now <code>configure --en&lt;tab&gt;-dt&lt;tab&gt;<\/code> will result in <code>configure --enable-dtrace<\/code>.<\/p>\n+<h3 id=\"using-multiple-configurations\">Using Multiple Configurations<\/h3>\n+<p>You can have multiple configurations for a single source repository. When you create a new configuration, run <code>configure --with-conf-name=&lt;name&gt;<\/code> to create a configuration with the name <code>&lt;name&gt;<\/code>. Alternatively, you can create a directory under <code>build<\/code> and run <code>configure<\/code> from there, e.g. <code>mkdir build\/&lt;name&gt; &amp;&amp; cd build\/&lt;name&gt; &amp;&amp; bash ..\/..\/configure<\/code>.<\/p>\n+<p>Then you can build that configuration using <code>make CONF_NAME=&lt;name&gt;<\/code> or <code>make CONF=&lt;pattern&gt;<\/code>, where <code>&lt;pattern&gt;<\/code> is a substring matching one or several configurations, e.g. <code>CONF=debug<\/code>. The special empty pattern (<code>CONF=<\/code>) will match <em>all<\/em> available configuration, so <code>make CONF= hotspot<\/code> will build the <code>hotspot<\/code> target for all configurations. Alternatively, you can execute <code>make<\/code> in the configuration directory, e.g. <code>cd build\/&lt;name&gt; &amp;&amp; make<\/code>.<\/p>\n@@ -1953,28 +949,7 @@\n-<p>If you update the repository and part of the configure script has\n-changed, the build system will force you to re-run\n-<code>configure<\/code>.<\/p>\n-<p>Most of the time, you will be fine by running <code>configure<\/code>\n-again with the same arguments as the last time, which can easily be\n-performed by <code>make reconfigure<\/code>. To simplify this, you can\n-use the <code>CONF_CHECK<\/code> make control variable, either as\n-<code>make CONF_CHECK=auto<\/code>, or by setting an environment\n-variable. For instance, if you add <code>export CONF_CHECK=auto<\/code>\n-to your <code>.bashrc<\/code> file, <code>make<\/code> will always run\n-<code>reconfigure<\/code> automatically whenever the configure script has\n-changed.<\/p>\n-<p>You can also use <code>CONF_CHECK=ignore<\/code> to skip the check for\n-a needed configure update. This might speed up the build, but comes at\n-the risk of an incorrect build result. This is only recommended if you\n-know what you're doing.<\/p>\n-<p>From time to time, you will also need to modify the command line to\n-<code>configure<\/code> due to changes. Use\n-<code>make print-configuration<\/code> to show the command line used for\n-your current configuration.<\/p>\n-<h3 id=\"using-fine-grained-make-targets\">Using Fine-Grained Make\n-Targets<\/h3>\n-<p>The default behavior for make is to create consistent and correct\n-output, at the expense of build speed, if necessary.<\/p>\n-<p>If you are prepared to take some risk of an incorrect build, and know\n-enough of the system to understand how things build and interact, you\n-can speed up the build process considerably by instructing make to only\n-build a portion of the product.<\/p>\n+<p>If you update the repository and part of the configure script has changed, the build system will force you to re-run <code>configure<\/code>.<\/p>\n+<p>Most of the time, you will be fine by running <code>configure<\/code> again with the same arguments as the last time, which can easily be performed by <code>make reconfigure<\/code>. To simplify this, you can use the <code>CONF_CHECK<\/code> make control variable, either as <code>make CONF_CHECK=auto<\/code>, or by setting an environment variable. For instance, if you add <code>export CONF_CHECK=auto<\/code> to your <code>.bashrc<\/code> file, <code>make<\/code> will always run <code>reconfigure<\/code> automatically whenever the configure script has changed.<\/p>\n+<p>You can also use <code>CONF_CHECK=ignore<\/code> to skip the check for a needed configure update. This might speed up the build, but comes at the risk of an incorrect build result. This is only recommended if you know what you're doing.<\/p>\n+<p>From time to time, you will also need to modify the command line to <code>configure<\/code> due to changes. Use <code>make print-configuration<\/code> to show the command line used for your current configuration.<\/p>\n+<h3 id=\"using-fine-grained-make-targets\">Using Fine-Grained Make Targets<\/h3>\n+<p>The default behavior for make is to create consistent and correct output, at the expense of build speed, if necessary.<\/p>\n+<p>If you are prepared to take some risk of an incorrect build, and know enough of the system to understand how things build and interact, you can speed up the build process considerably by instructing make to only build a portion of the product.<\/p>\n@@ -1982,16 +957,4 @@\n-<p>The safe way to use fine-grained make targets is to use the module\n-specific make targets. All source code in the JDK is organized so it\n-belongs to a module, e.g. <code>java.base<\/code> or\n-<code>jdk.jdwp.agent<\/code>. You can build only a specific module, by\n-giving it as make target: <code>make jdk.jdwp.agent<\/code>. If the\n-specified module depends on other modules (e.g. <code>java.base<\/code>),\n-those modules will be built first.<\/p>\n-<p>You can also specify a set of modules, just as you can always specify\n-a set of make targets:\n-<code>make jdk.crypto.cryptoki jdk.crypto.ec jdk.crypto.mscapi<\/code><\/p>\n-<h4 id=\"building-individual-module-phases\">Building Individual Module\n-Phases<\/h4>\n-<p>The build process for each module is divided into separate phases.\n-Not all modules need all phases. Which are needed depends on what kind\n-of source code and other artifact the module consists of. The phases\n-are:<\/p>\n+<p>The safe way to use fine-grained make targets is to use the module specific make targets. All source code in the JDK is organized so it belongs to a module, e.g. <code>java.base<\/code> or <code>jdk.jdwp.agent<\/code>. You can build only a specific module, by giving it as make target: <code>make jdk.jdwp.agent<\/code>. If the specified module depends on other modules (e.g. <code>java.base<\/code>), those modules will be built first.<\/p>\n+<p>You can also specify a set of modules, just as you can always specify a set of make targets: <code>make jdk.crypto.cryptoki jdk.crypto.ec jdk.crypto.mscapi<\/code><\/p>\n+<h4 id=\"building-individual-module-phases\">Building Individual Module Phases<\/h4>\n+<p>The build process for each module is divided into separate phases. Not all modules need all phases. Which are needed depends on what kind of source code and other artifact the module consists of. The phases are:<\/p>\n@@ -2006,13 +969,4 @@\n-<p>You can build only a single phase for a module by using the notation\n-<code>$MODULE-$PHASE<\/code>. For instance, to build the\n-<code>gensrc<\/code> phase for <code>java.base<\/code>, use\n-<code>make java.base-gensrc<\/code>.<\/p>\n-<p>Note that some phases may depend on others, e.g. <code>java<\/code>\n-depends on <code>gensrc<\/code> (if present). Make will build all needed\n-prerequisites before building the requested phase.<\/p>\n-<h4 id=\"skipping-the-dependency-check\">Skipping the Dependency\n-Check<\/h4>\n-<p>When using an iterative development style with frequent quick\n-rebuilds, the dependency check made by make can take up a significant\n-portion of the time spent on the rebuild. In such cases, it can be\n-useful to bypass the dependency check in make.<\/p>\n+<p>You can build only a single phase for a module by using the notation <code>$MODULE-$PHASE<\/code>. For instance, to build the <code>gensrc<\/code> phase for <code>java.base<\/code>, use <code>make java.base-gensrc<\/code>.<\/p>\n+<p>Note that some phases may depend on others, e.g. <code>java<\/code> depends on <code>gensrc<\/code> (if present). Make will build all needed prerequisites before building the requested phase.<\/p>\n+<h4 id=\"skipping-the-dependency-check\">Skipping the Dependency Check<\/h4>\n+<p>When using an iterative development style with frequent quick rebuilds, the dependency check made by make can take up a significant portion of the time spent on the rebuild. In such cases, it can be useful to bypass the dependency check in make.<\/p>\n@@ -2020,2 +974,1 @@\n-<p><strong>Note that if used incorrectly, this can lead to a broken\n-build!<\/strong><\/p>\n+<p><strong>Note that if used incorrectly, this can lead to a broken build!<\/strong><\/p>\n@@ -2023,26 +976,7 @@\n-<p>To achieve this, append <code>-only<\/code> to the build target. For\n-instance, <code>make jdk.jdwp.agent-java-only<\/code> will <em>only<\/em>\n-build the <code>java<\/code> phase of the <code>jdk.jdwp.agent<\/code>\n-module. If the required dependencies are not present, the build can\n-fail. On the other hand, the execution time measures in\n-milliseconds.<\/p>\n-<p>A useful pattern is to build the first time normally (e.g.\n-<code>make jdk.jdwp.agent<\/code>) and then on subsequent builds, use the\n-<code>-only<\/code> make target.<\/p>\n-<h4 id=\"rebuilding-part-of-java.base-jdk_filter\">Rebuilding Part of\n-java.base (JDK_FILTER)<\/h4>\n-<p>If you are modifying files in <code>java.base<\/code>, which is the by\n-far largest module in the JDK, then you need to rebuild all those files\n-whenever a single file has changed. (This inefficiency will hopefully be\n-addressed in JDK 10.)<\/p>\n-<p>As a hack, you can use the make control variable\n-<code>JDK_FILTER<\/code> to specify a pattern that will be used to limit\n-the set of files being recompiled. For instance,\n-<code>make java.base JDK_FILTER=javax\/crypto<\/code> (or, to combine\n-methods, <code>make java.base-java-only JDK_FILTER=javax\/crypto<\/code>)\n-will limit the compilation to files in the <code>javax.crypto<\/code>\n-package.<\/p>\n-<h2 id=\"understanding-the-build-system\">Understanding the Build\n-System<\/h2>\n-<p>This section will give you a more technical description on the\n-details of the build system.<\/p>\n+<p>To achieve this, append <code>-only<\/code> to the build target. For instance, <code>make jdk.jdwp.agent-java-only<\/code> will <em>only<\/em> build the <code>java<\/code> phase of the <code>jdk.jdwp.agent<\/code> module. If the required dependencies are not present, the build can fail. On the other hand, the execution time measures in milliseconds.<\/p>\n+<p>A useful pattern is to build the first time normally (e.g. <code>make jdk.jdwp.agent<\/code>) and then on subsequent builds, use the <code>-only<\/code> make target.<\/p>\n+<h4 id=\"rebuilding-part-of-java.base-jdk_filter\">Rebuilding Part of java.base (JDK_FILTER)<\/h4>\n+<p>If you are modifying files in <code>java.base<\/code>, which is the by far largest module in the JDK, then you need to rebuild all those files whenever a single file has changed. (This inefficiency will hopefully be addressed in JDK 10.)<\/p>\n+<p>As a hack, you can use the make control variable <code>JDK_FILTER<\/code> to specify a pattern that will be used to limit the set of files being recompiled. For instance, <code>make java.base JDK_FILTER=javax\/crypto<\/code> (or, to combine methods, <code>make java.base-java-only JDK_FILTER=javax\/crypto<\/code>) will limit the compilation to files in the <code>javax.crypto<\/code> package.<\/p>\n+<h2 id=\"understanding-the-build-system\">Understanding the Build System<\/h2>\n+<p>This section will give you a more technical description on the details of the build system.<\/p>\n@@ -2050,11 +984,2 @@\n-<p>The build system expects to find one or more configuration. These are\n-technically defined by the <code>spec.gmk<\/code> in a subdirectory to\n-the <code>build<\/code> subdirectory. The <code>spec.gmk<\/code> file is\n-generated by <code>configure<\/code>, and contains in principle the\n-configuration (directly or by files included by\n-<code>spec.gmk<\/code>).<\/p>\n-<p>You can, in fact, select a configuration to build by pointing to the\n-<code>spec.gmk<\/code> file with the <code>SPEC<\/code> make control\n-variable, e.g. <code>make SPEC=$BUILD\/spec.gmk<\/code>. While this is not\n-the recommended way to call <code>make<\/code> as a user, it is what is\n-used under the hood by the build system.<\/p>\n+<p>The build system expects to find one or more configuration. These are technically defined by the <code>spec.gmk<\/code> in a subdirectory to the <code>build<\/code> subdirectory. The <code>spec.gmk<\/code> file is generated by <code>configure<\/code>, and contains in principle the configuration (directly or by files included by <code>spec.gmk<\/code>).<\/p>\n+<p>You can, in fact, select a configuration to build by pointing to the <code>spec.gmk<\/code> file with the <code>SPEC<\/code> make control variable, e.g. <code>make SPEC=$BUILD\/spec.gmk<\/code>. While this is not the recommended way to call <code>make<\/code> as a user, it is what is used under the hood by the build system.<\/p>\n@@ -2062,4 +987,1 @@\n-<p>The build output for a configuration will end up in\n-<code>build\/&lt;configuration name&gt;<\/code>, which we refer to as\n-<code>$BUILD<\/code> in this document. The <code>$BUILD<\/code> directory\n-contains the following important directories:<\/p>\n+<p>The build output for a configuration will end up in <code>build\/&lt;configuration name&gt;<\/code>, which we refer to as <code>$BUILD<\/code> in this document. The <code>$BUILD<\/code> directory contains the following important directories:<\/p>\n@@ -2077,23 +999,7 @@\n-<li><p><code>images<\/code>: This is the directory were the output of the\n-<code>*-image<\/code> make targets end up. For instance,\n-<code>make jdk-image<\/code> ends up in <code>images\/jdk<\/code>.<\/p><\/li>\n-<li><p><code>jdk<\/code>: This is the \"exploded image\". After\n-<code>make jdk<\/code>, you will be able to launch the newly built JDK by\n-running <code>$BUILD\/jdk\/bin\/java<\/code>.<\/p><\/li>\n-<li><p><code>test-results<\/code>: This directory contains the results\n-from running tests.<\/p><\/li>\n-<li><p><code>support<\/code>: This is an area for intermediate files\n-needed during the build, e.g. generated source code, object files and\n-class files. Some noteworthy directories in <code>support<\/code> is\n-<code>gensrc<\/code>, which contains the generated source code, and the\n-<code>modules_*<\/code> directories, which contains the files in a\n-per-module hierarchy that will later be collapsed into the\n-<code>jdk<\/code> directory of the exploded image.<\/p><\/li>\n-<li><p><code>buildtools<\/code>: This is an area for tools compiled for\n-the build platform that are used during the rest of the build.<\/p><\/li>\n-<li><p><code>hotspot<\/code>: This is an area for intermediate files\n-needed when building hotspot.<\/p><\/li>\n-<li><p><code>configure-support<\/code>, <code>make-support<\/code> and\n-<code>test-support<\/code>: These directories contain files that are\n-needed by the build system for <code>configure<\/code>, <code>make<\/code>\n-and for running tests.<\/p><\/li>\n+<li><p><code>images<\/code>: This is the directory were the output of the <code>*-image<\/code> make targets end up. For instance, <code>make jdk-image<\/code> ends up in <code>images\/jdk<\/code>.<\/p><\/li>\n+<li><p><code>jdk<\/code>: This is the &quot;exploded image&quot;. After <code>make jdk<\/code>, you will be able to launch the newly built JDK by running <code>$BUILD\/jdk\/bin\/java<\/code>.<\/p><\/li>\n+<li><p><code>test-results<\/code>: This directory contains the results from running tests.<\/p><\/li>\n+<li><p><code>support<\/code>: This is an area for intermediate files needed during the build, e.g. generated source code, object files and class files. Some noteworthy directories in <code>support<\/code> is <code>gensrc<\/code>, which contains the generated source code, and the <code>modules_*<\/code> directories, which contains the files in a per-module hierarchy that will later be collapsed into the <code>jdk<\/code> directory of the exploded image.<\/p><\/li>\n+<li><p><code>buildtools<\/code>: This is an area for tools compiled for the build platform that are used during the rest of the build.<\/p><\/li>\n+<li><p><code>hotspot<\/code>: This is an area for intermediate files needed when building hotspot.<\/p><\/li>\n+<li><p><code>configure-support<\/code>, <code>make-support<\/code> and <code>test-support<\/code>: These directories contain files that are needed by the build system for <code>configure<\/code>, <code>make<\/code> and for running tests.<\/p><\/li>\n@@ -2102,10 +1008,3 @@\n-<p>Windows path typically look like <code>C:\\User\\foo<\/code>, while Unix\n-paths look like <code>\/home\/foo<\/code>. Tools with roots from Unix often\n-experience issues related to this mismatch when running on Windows.<\/p>\n-<p>In the JDK build, we always use Unix paths internally, and only just\n-before calling a tool that does not understand Unix paths do we convert\n-them to Windows paths.<\/p>\n-<p>This conversion is done by the <code>fixpath<\/code> tool, which is a\n-small wrapper that modifies unix-style paths to Windows-style paths in\n-command lines. Fixpath is compiled automatically by\n-<code>configure<\/code>.<\/p>\n+<p>Windows path typically look like <code>C:\\User\\foo<\/code>, while Unix paths look like <code>\/home\/foo<\/code>. Tools with roots from Unix often experience issues related to this mismatch when running on Windows.<\/p>\n+<p>In the JDK build, we always use Unix paths internally, and only just before calling a tool that does not understand Unix paths do we convert them to Windows paths.<\/p>\n+<p>This conversion is done by the <code>fixpath<\/code> tool, which is a small wrapper that modifies unix-style paths to Windows-style paths in command lines. Fixpath is compiled automatically by <code>configure<\/code>.<\/p>\n@@ -2113,9 +1012,2 @@\n-<p>Native libraries and executables can have debug symbol (and other\n-debug information) associated with them. How this works is very much\n-platform dependent, but a common problem is that debug symbol\n-information takes a lot of disk space, but is rarely needed by the end\n-user.<\/p>\n-<p>The JDK supports different methods on how to handle debug symbols.\n-The method used is selected by <code>--with-native-debug-symbols<\/code>,\n-and available methods are <code>none<\/code>, <code>internal<\/code>,\n-<code>external<\/code>, <code>zipped<\/code>.<\/p>\n+<p>Native libraries and executables can have debug symbol (and other debug information) associated with them. How this works is very much platform dependent, but a common problem is that debug symbol information takes a lot of disk space, but is rarely needed by the end user.<\/p>\n+<p>The JDK supports different methods on how to handle debug symbols. The method used is selected by <code>--with-native-debug-symbols<\/code>, and available methods are <code>none<\/code>, <code>internal<\/code>, <code>external<\/code>, <code>zipped<\/code>.<\/p>\n@@ -2123,12 +1015,4 @@\n-<li><p><code>none<\/code> means that no debug symbols will be generated\n-during the build.<\/p><\/li>\n-<li><p><code>internal<\/code> means that debug symbols will be generated\n-during the build, and they will be stored in the generated\n-binary.<\/p><\/li>\n-<li><p><code>external<\/code> means that debug symbols will be generated\n-during the build, and after the compilation, they will be moved into a\n-separate <code>.debuginfo<\/code> file. (This was previously known as\n-FDS, Full Debug Symbols).<\/p><\/li>\n-<li><p><code>zipped<\/code> is like <code>external<\/code>, but the\n-.debuginfo file will also be zipped into a <code>.diz<\/code>\n-file.<\/p><\/li>\n+<li><p><code>none<\/code> means that no debug symbols will be generated during the build.<\/p><\/li>\n+<li><p><code>internal<\/code> means that debug symbols will be generated during the build, and they will be stored in the generated binary.<\/p><\/li>\n+<li><p><code>external<\/code> means that debug symbols will be generated during the build, and after the compilation, they will be moved into a separate <code>.debuginfo<\/code> file. (This was previously known as FDS, Full Debug Symbols).<\/p><\/li>\n+<li><p><code>zipped<\/code> is like <code>external<\/code>, but the .debuginfo file will also be zipped into a <code>.diz<\/code> file.<\/p><\/li>\n@@ -2136,4 +1020,1 @@\n-<p>When building for distribution, <code>zipped<\/code> is a good\n-solution. Binaries built with <code>internal<\/code> is suitable for use\n-by developers, since they facilitate debugging, but should be stripped\n-before distributed to end users.<\/p>\n+<p>When building for distribution, <code>zipped<\/code> is a good solution. Binaries built with <code>internal<\/code> is suitable for use by developers, since they facilitate debugging, but should be stripped before distributed to end users.<\/p>\n@@ -2141,31 +1022,7 @@\n-<p>The <code>configure<\/code> script is based on the autoconf framework,\n-but in some details deviate from a normal autoconf\n-<code>configure<\/code> script.<\/p>\n-<p>The <code>configure<\/code> script in the top level directory of the\n-JDK is just a thin wrapper that calls\n-<code>make\/autoconf\/configure<\/code>. This in turn will run\n-<code>autoconf<\/code> to create the runnable (generated) configure\n-script, as <code>.build\/generated-configure.sh<\/code>. Apart from being\n-responsible for the generation of the runnable script, the\n-<code>configure<\/code> script also provides functionality that is not\n-easily expressed in the normal Autoconf framework. As part of this\n-functionality, the generated script is called.<\/p>\n-<p>The build system will detect if the Autoconf source files have\n-changed, and will trigger a regeneration of the generated script if\n-needed. You can also manually request such an update by\n-<code>bash configure autogen<\/code>.<\/p>\n-<p>In previous versions of the JDK, the generated script was checked in\n-at <code>make\/autoconf\/generated-configure.sh<\/code>. This is no longer\n-the case.<\/p>\n-<h3 id=\"developing-the-build-system-itself\">Developing the Build System\n-Itself<\/h3>\n-<p>This section contains a few remarks about how to develop for the\n-build system itself. It is not relevant if you are only making changes\n-in the product source code.<\/p>\n-<p>While technically using <code>make<\/code>, the make source files of\n-the JDK does not resemble most other Makefiles. Instead of listing\n-specific targets and actions (perhaps using patterns), the basic modus\n-operandi is to call a high-level function (or properly, macro) from the\n-API in <code>make\/common<\/code>. For instance, to compile all classes in\n-the <code>jdk.internal.foo<\/code> package in the <code>jdk.foo<\/code>\n-module, a call like this would be made:<\/p>\n+<p>The <code>configure<\/code> script is based on the autoconf framework, but in some details deviate from a normal autoconf <code>configure<\/code> script.<\/p>\n+<p>The <code>configure<\/code> script in the top level directory of the JDK is just a thin wrapper that calls <code>make\/autoconf\/configure<\/code>. This in turn will run <code>autoconf<\/code> to create the runnable (generated) configure script, as <code>.build\/generated-configure.sh<\/code>. Apart from being responsible for the generation of the runnable script, the <code>configure<\/code> script also provides functionality that is not easily expressed in the normal Autoconf framework. As part of this functionality, the generated script is called.<\/p>\n+<p>The build system will detect if the Autoconf source files have changed, and will trigger a regeneration of the generated script if needed. You can also manually request such an update by <code>bash configure autogen<\/code>.<\/p>\n+<p>In previous versions of the JDK, the generated script was checked in at <code>make\/autoconf\/generated-configure.sh<\/code>. This is no longer the case.<\/p>\n+<h3 id=\"developing-the-build-system-itself\">Developing the Build System Itself<\/h3>\n+<p>This section contains a few remarks about how to develop for the build system itself. It is not relevant if you are only making changes in the product source code.<\/p>\n+<p>While technically using <code>make<\/code>, the make source files of the JDK does not resemble most other Makefiles. Instead of listing specific targets and actions (perhaps using patterns), the basic modus operandi is to call a high-level function (or properly, macro) from the API in <code>make\/common<\/code>. For instance, to compile all classes in the <code>jdk.internal.foo<\/code> package in the <code>jdk.foo<\/code> module, a call like this would be made:<\/p>\n@@ -2178,16 +1035,5 @@\n-<p>By encapsulating and expressing the high-level knowledge of\n-<em>what<\/em> should be done, rather than <em>how<\/em> it should be done\n-(as is normal in Makefiles), we can build a much more powerful and\n-flexible build system.<\/p>\n-<p>Correct dependency tracking is paramount. Sloppy dependency tracking\n-will lead to improper parallelization, or worse, race conditions.<\/p>\n-<p>To test for\/debug race conditions, try running\n-<code>make JOBS=1<\/code> and <code>make JOBS=100<\/code> and see if it\n-makes any difference. (It shouldn't).<\/p>\n-<p>To compare the output of two different builds and see if, and how,\n-they differ, run <code>$BUILD1\/compare.sh -o $BUILD2<\/code>, where\n-<code>$BUILD1<\/code> and <code>$BUILD2<\/code> are the two builds you\n-want to compare.<\/p>\n-<p>To automatically build two consecutive versions and compare them, use\n-<code>COMPARE_BUILD<\/code>. The value of <code>COMPARE_BUILD<\/code> is a\n-set of variable=value assignments, like this:<\/p>\n+<p>By encapsulating and expressing the high-level knowledge of <em>what<\/em> should be done, rather than <em>how<\/em> it should be done (as is normal in Makefiles), we can build a much more powerful and flexible build system.<\/p>\n+<p>Correct dependency tracking is paramount. Sloppy dependency tracking will lead to improper parallelization, or worse, race conditions.<\/p>\n+<p>To test for\/debug race conditions, try running <code>make JOBS=1<\/code> and <code>make JOBS=100<\/code> and see if it makes any difference. (It shouldn't).<\/p>\n+<p>To compare the output of two different builds and see if, and how, they differ, run <code>$BUILD1\/compare.sh -o $BUILD2<\/code>, where <code>$BUILD1<\/code> and <code>$BUILD2<\/code> are the two builds you want to compare.<\/p>\n+<p>To automatically build two consecutive versions and compare them, use <code>COMPARE_BUILD<\/code>. The value of <code>COMPARE_BUILD<\/code> is a set of variable=value assignments, like this:<\/p>\n@@ -2195,8 +1041,3 @@\n-<p>See <code>make\/InitSupport.gmk<\/code> for details on how to use\n-<code>COMPARE_BUILD<\/code>.<\/p>\n-<p>To analyze build performance, run with <code>LOG=trace<\/code> and\n-check <code>$BUILD\/build-trace-time.log<\/code>. Use <code>JOBS=1<\/code>\n-to avoid parallelism.<\/p>\n-<p>Please check that you adhere to the <a\n-href=\"http:\/\/openjdk.org\/groups\/build\/doc\/code-conventions.html\">Code\n-Conventions for the Build System<\/a> before submitting patches.<\/p>\n+<p>See <code>make\/InitSupport.gmk<\/code> for details on how to use <code>COMPARE_BUILD<\/code>.<\/p>\n+<p>To analyze build performance, run with <code>LOG=trace<\/code> and check <code>$BUILD\/build-trace-time.log<\/code>. Use <code>JOBS=1<\/code> to avoid parallelism.<\/p>\n+<p>Please check that you adhere to the <a href=\"http:\/\/openjdk.org\/groups\/build\/doc\/code-conventions.html\">Code Conventions for the Build System<\/a> before submitting patches.<\/p>\n@@ -2204,19 +1045,4 @@\n-<p>So, now you've built your JDK, and made your first patch, and want to\n-contribute it back to the OpenJDK Community.<\/p>\n-<p>First of all: Thank you! We gladly welcome your contribution.\n-However, please bear in mind that the JDK is a massive project, and we\n-must ask you to follow our rules and guidelines to be able to accept\n-your contribution.<\/p>\n-<p>The official place to start is the <a\n-href=\"http:\/\/openjdk.org\/contribute\/\">'How to contribute' page<\/a>.\n-There is also an official (but somewhat outdated and skimpy on details)\n-<a href=\"http:\/\/openjdk.org\/guide\/\">Developer's Guide<\/a>.<\/p>\n-<p>If this seems overwhelming to you, the Adoption Group is there to\n-help you! A good place to start is their <a\n-href=\"https:\/\/wiki.openjdk.org\/display\/Adoption\/New+Contributor\">'New\n-Contributor' page<\/a>, or start reading the comprehensive <a\n-href=\"https:\/\/adoptopenjdk.gitbooks.io\/adoptopenjdk-getting-started-kit\/en\/\">Getting\n-Started Kit<\/a>. The Adoption Group will also happily answer any\n-questions you have about contributing. Contact them by <a\n-href=\"http:\/\/mail.openjdk.org\/mailman\/listinfo\/adoption-discuss\">mail<\/a>\n-or <a href=\"http:\/\/openjdk.org\/irc\/\">IRC<\/a>.<\/p>\n+<p>So, now you've built your JDK, and made your first patch, and want to contribute it back to the OpenJDK Community.<\/p>\n+<p>First of all: Thank you! We gladly welcome your contribution. However, please bear in mind that the JDK is a massive project, and we must ask you to follow our rules and guidelines to be able to accept your contribution.<\/p>\n+<p>The official place to start is the <a href=\"http:\/\/openjdk.org\/contribute\/\">'How to contribute' page<\/a>. There is also an official (but somewhat outdated and skimpy on details) <a href=\"http:\/\/openjdk.org\/guide\/\">Developer's Guide<\/a>.<\/p>\n+<p>If this seems overwhelming to you, the Adoption Group is there to help you! A good place to start is their <a href=\"https:\/\/wiki.openjdk.org\/display\/Adoption\/New+Contributor\">'New Contributor' page<\/a>, or start reading the comprehensive <a href=\"https:\/\/adoptopenjdk.gitbooks.io\/adoptopenjdk-getting-started-kit\/en\/\">Getting Started Kit<\/a>. The Adoption Group will also happily answer any questions you have about contributing. Contact them by <a href=\"http:\/\/mail.openjdk.org\/mailman\/listinfo\/adoption-discuss\">mail<\/a> or <a href=\"http:\/\/openjdk.org\/irc\/\">IRC<\/a>.<\/p>\n@@ -2224,4 +1050,1 @@\n-<p>If you want to contribute changes to this document, edit\n-<code>doc\/building.md<\/code> and then run\n-<code>make update-build-docs<\/code> to generate the same changes in\n-<code>doc\/building.html<\/code>.<\/p>\n+<p>If you want to contribute changes to this document, edit <code>doc\/building.md<\/code> and then run <code>make update-build-docs<\/code> to generate the same changes in <code>doc\/building.html<\/code>.<\/p>\n","filename":"doc\/building.html","additions":532,"deletions":1709,"binary":false,"changes":2241,"status":"modified"},{"patch":"@@ -319,6 +319,6 @@\n-| Operating system   | Supported toolchain       |\n-| ------------------ | ------------------------- |\n-| Linux              | gcc, clang                |\n-| macOS              | Apple Xcode (using clang) |\n-| AIX                | IBM XL C\/C++              |\n-| Windows            | Microsoft Visual Studio   |\n+ Operating system   Supported toolchain\n+ ------------------ -------------------------\n+ Linux              gcc, clang\n+ macOS              Apple Xcode (using clang)\n+ AIX                IBM XL C\/C++\n+ Windows            Microsoft Visual Studio\n@@ -333,5 +333,5 @@\n-| Operating system   | Toolchain version                          |\n-| ------------------ | ------------------------------------------ |\n-| Linux              | gcc 11.2.0                                 |\n-| macOS              | Apple Xcode 10.1 (using clang 10.0.0)      |\n-| Windows            | Microsoft Visual Studio 2022 update 17.1.0 |\n+ Operating system   Toolchain version\n+ ------------------ -------------------------------------------------------\n+ Linux              gcc 11.2.0\n+ macOS              Apple Xcode 10.1 (using clang 10.0.0)\n+ Windows            Microsoft Visual Studio 2022 update 17.1.0\n@@ -365,2 +365,2 @@\n-You will need the Xcode command line developer tools to be able to build\n-the JDK. (Actually, *only* the command line tools are needed, not the IDE.)\n+You will need the Xcode command lines developers tools to be able to build\n+the JDK. (Actually, *only* the command lines tools are needed, not the IDE.)\n@@ -372,7 +372,7 @@\n-When updating Xcode, it is advisable to keep an older version for building the JDK.\n-To use a specific version of Xcode you have multiple options:\n-\n-  * Use `xcode-select -s` before running `configure`, e.g. `xcode-select -s \/Applications\/Xcode13.1.app`. The drawback is that the setting\n-    is system wide and you may have to revert it after an OpenJDK build.\n-  * Use configure option `--with-xcode-path`, e.g. `configure --with-xcode-path=\/Applications\/Xcode13.1.app`\n-    This allows using a specific Xcode version for an OpenJDK build, independently of the active Xcode version by `xcode-select`.\n+It is advisable to keep an older version of Xcode for building the JDK when\n+updating Xcode. This [blog page](\n+http:\/\/iosdevelopertips.com\/xcode\/install-multiple-versions-of-xcode.html) has\n+good suggestions on managing multiple Xcode versions. To use a specific version\n+of Xcode, use `xcode-select -s` before running `configure`, or use\n+`--with-toolchain-path` to point to the version of Xcode to use, e.g.\n+`configure --with-toolchain-path=\/Applications\/Xcode8.app\/Contents\/Developer\/usr\/bin`\n@@ -406,0 +406,9 @@\n+### Support for checking standards conforming code\n+\n+The make system has a strict mode that enforces conforming code based on the\n+standard that is used by the build, which can be useful to ensure that native code\n+behaves strictly according to said standard. This option can by enabled by passing\n+`--enable-conforming-compilation` during configure, but is off by default.\n+If you just want to compile a working JDK it is not recommended that you set this\n+flag, as it is mainly meant to aid developers that are working with native code.\n+\n@@ -1336,1 +1345,1 @@\n-### Using the javac server\n+### Using sjavac\n@@ -1338,4 +1347,4 @@\n-To speed up compilation of Java code, especially during incremental\n-compilations, the javac server is automatically enabled in the configuration\n-step by default. To explicitly enable or disable the javac server, use either\n-`--enable-javac-server` or `--disable-javac-server`.\n+To speed up compilation of Java code, especially during incremental compilations,\n+the sjavac server is automatically enabled in the configuration step by default.\n+To explicitly enable or disable sjavac, use either `--enable-javac-server`\n+or `--disable-javac-server`.\n","filename":"doc\/building.md","additions":34,"deletions":25,"binary":false,"changes":59,"status":"modified"},{"patch":"@@ -8,13 +8,5 @@\n-  <style>\n-    code{white-space: pre-wrap;}\n-    span.smallcaps{font-variant: small-caps;}\n-    div.columns{display: flex; gap: min(4vw, 1.5em);}\n-    div.column{flex: auto; overflow-x: auto;}\n-    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}\n-    ul.task-list{list-style: none;}\n-    ul.task-list li input[type=\"checkbox\"] {\n-      width: 0.8em;\n-      margin: 0 0.8em 0.2em -1.6em;\n-      vertical-align: middle;\n-    }\n-    .display.math{display: block; text-align: center; margin: 0.5rem auto;}\n+  <style type=\"text\/css\">\n+      code{white-space: pre-wrap;}\n+      span.smallcaps{font-variant: small-caps;}\n+      span.underline{text-decoration: underline;}\n+      div.column{display: inline-block; vertical-align: top; width: 50%;}\n@@ -31,3 +23,1 @@\n-<nav id=\"TOC\" role=\"doc-toc\">\n-<ul>\n-<li><a href=\"#introduction\" id=\"toc-introduction\">Introduction<\/a>\n+<nav id=\"TOC\">\n@@ -35,5 +25,3 @@\n-<li><a href=\"#why-care-about-style\" id=\"toc-why-care-about-style\">Why\n-Care About Style?<\/a><\/li>\n-<li><a href=\"#counterexamples-and-updates\"\n-id=\"toc-counterexamples-and-updates\">Counterexamples and\n-Updates<\/a><\/li>\n+<li><a href=\"#introduction\">Introduction<\/a><ul>\n+<li><a href=\"#why-care-about-style\">Why Care About Style?<\/a><\/li>\n+<li><a href=\"#counterexamples-and-updates\">Counterexamples and Updates<\/a><\/li>\n@@ -41,13 +29,9 @@\n-<li><a href=\"#structure-and-formatting\"\n-id=\"toc-structure-and-formatting\">Structure and Formatting<\/a>\n-<ul>\n-<li><a href=\"#factoring-and-class-design\"\n-id=\"toc-factoring-and-class-design\">Factoring and Class Design<\/a><\/li>\n-<li><a href=\"#source-files\" id=\"toc-source-files\">Source Files<\/a><\/li>\n-<li><a href=\"#jtreg-tests\" id=\"toc-jtreg-tests\">JTReg Tests<\/a><\/li>\n-<li><a href=\"#naming\" id=\"toc-naming\">Naming<\/a><\/li>\n-<li><a href=\"#commenting\" id=\"toc-commenting\">Commenting<\/a><\/li>\n-<li><a href=\"#macros\" id=\"toc-macros\">Macros<\/a><\/li>\n-<li><a href=\"#whitespace\" id=\"toc-whitespace\">Whitespace<\/a><\/li>\n-<li><a href=\"#miscellaneous\"\n-id=\"toc-miscellaneous\">Miscellaneous<\/a><\/li>\n+<li><a href=\"#structure-and-formatting\">Structure and Formatting<\/a><ul>\n+<li><a href=\"#factoring-and-class-design\">Factoring and Class Design<\/a><\/li>\n+<li><a href=\"#source-files\">Source Files<\/a><\/li>\n+<li><a href=\"#jtreg-tests\">JTReg Tests<\/a><\/li>\n+<li><a href=\"#naming\">Naming<\/a><\/li>\n+<li><a href=\"#commenting\">Commenting<\/a><\/li>\n+<li><a href=\"#macros\">Macros<\/a><\/li>\n+<li><a href=\"#whitespace\">Whitespace<\/a><\/li>\n+<li><a href=\"#miscellaneous\">Miscellaneous<\/a><\/li>\n@@ -55,36 +39,19 @@\n-<li><a href=\"#use-of-c-features\" id=\"toc-use-of-c-features\">Use of C++\n-Features<\/a>\n-<ul>\n-<li><a href=\"#error-handling\" id=\"toc-error-handling\">Error\n-Handling<\/a><\/li>\n-<li><a href=\"#rtti-runtime-type-information\"\n-id=\"toc-rtti-runtime-type-information\">RTTI (Runtime Type\n-Information)<\/a><\/li>\n-<li><a href=\"#memory-allocation\" id=\"toc-memory-allocation\">Memory\n-Allocation<\/a><\/li>\n-<li><a href=\"#class-inheritance\" id=\"toc-class-inheritance\">Class\n-Inheritance<\/a><\/li>\n-<li><a href=\"#namespaces\" id=\"toc-namespaces\">Namespaces<\/a><\/li>\n-<li><a href=\"#c-standard-library\" id=\"toc-c-standard-library\">C++\n-Standard Library<\/a><\/li>\n-<li><a href=\"#type-deduction\" id=\"toc-type-deduction\">Type\n-Deduction<\/a><\/li>\n-<li><a href=\"#expression-sfinae\" id=\"toc-expression-sfinae\">Expression\n-SFINAE<\/a><\/li>\n-<li><a href=\"#enum\" id=\"toc-enum\">enum<\/a><\/li>\n-<li><a href=\"#thread_local\" id=\"toc-thread_local\">thread_local<\/a><\/li>\n-<li><a href=\"#nullptr\" id=\"toc-nullptr\">nullptr<\/a><\/li>\n-<li><a href=\"#atomic\" id=\"toc-atomic\">&lt;atomic&gt;<\/a><\/li>\n-<li><a href=\"#uniform-initialization\"\n-id=\"toc-uniform-initialization\">Uniform Initialization<\/a><\/li>\n-<li><a href=\"#local-function-objects\"\n-id=\"toc-local-function-objects\">Local Function Objects<\/a><\/li>\n-<li><a href=\"#inheriting-constructors\"\n-id=\"toc-inheriting-constructors\">Inheriting constructors<\/a><\/li>\n-<li><a href=\"#additional-permitted-features\"\n-id=\"toc-additional-permitted-features\">Additional Permitted\n-Features<\/a><\/li>\n-<li><a href=\"#excluded-features\" id=\"toc-excluded-features\">Excluded\n-Features<\/a><\/li>\n-<li><a href=\"#undecided-features\" id=\"toc-undecided-features\">Undecided\n-Features<\/a><\/li>\n+<li><a href=\"#use-of-c-features\">Use of C++ Features<\/a><ul>\n+<li><a href=\"#error-handling\">Error Handling<\/a><\/li>\n+<li><a href=\"#rtti-runtime-type-information\">RTTI (Runtime Type Information)<\/a><\/li>\n+<li><a href=\"#memory-allocation\">Memory Allocation<\/a><\/li>\n+<li><a href=\"#class-inheritance\">Class Inheritance<\/a><\/li>\n+<li><a href=\"#namespaces\">Namespaces<\/a><\/li>\n+<li><a href=\"#c-standard-library\">C++ Standard Library<\/a><\/li>\n+<li><a href=\"#type-deduction\">Type Deduction<\/a><\/li>\n+<li><a href=\"#expression-sfinae\">Expression SFINAE<\/a><\/li>\n+<li><a href=\"#enum\">enum<\/a><\/li>\n+<li><a href=\"#thread_local\">thread_local<\/a><\/li>\n+<li><a href=\"#nullptr\">nullptr<\/a><\/li>\n+<li><a href=\"#atomic\">&lt;atomic&gt;<\/a><\/li>\n+<li><a href=\"#uniform-initialization\">Uniform Initialization<\/a><\/li>\n+<li><a href=\"#local-function-objects\">Local Function Objects<\/a><\/li>\n+<li><a href=\"#inheriting-constructors\">Inheriting constructors<\/a><\/li>\n+<li><a href=\"#additional-permitted-features\">Additional Permitted Features<\/a><\/li>\n+<li><a href=\"#excluded-features\">Excluded Features<\/a><\/li>\n+<li><a href=\"#undecided-features\">Undecided Features<\/a><\/li>\n@@ -95,5 +62,1 @@\n-<p>This is a collection of rules, guidelines, and suggestions for\n-writing HotSpot code. Following these will help new code fit in with\n-existing HotSpot code, making it easier to read and maintain. Failure to\n-follow these guidelines may lead to discussion during code reviews, if\n-not outright rejection of a change.<\/p>\n+<p>This is a collection of rules, guidelines, and suggestions for writing HotSpot code. Following these will help new code fit in with existing HotSpot code, making it easier to read and maintain. Failure to follow these guidelines may lead to discussion during code reviews, if not outright rejection of a change.<\/p>\n@@ -101,24 +64,4 @@\n-<p>Some programmers seem to have lexers and even C preprocessors\n-installed directly behind their eyeballs. The rest of us require code\n-that is not only functionally correct but also easy to read. More than\n-that, since there is no one style for easy-to-read code, and since a\n-mashup of many styles is just as confusing as no style at all, it is\n-important for coders to be conscious of the many implicit stylistic\n-choices that historically have gone into the HotSpot code base.<\/p>\n-<p>Some of these guidelines are driven by the cross-platform\n-requirements for HotSpot. Shared code must work on a variety of\n-platforms, and may encounter deficiencies in some. Using platform\n-conditionalization in shared code is usually avoided, while shared code\n-is strongly preferred to multiple platform-dependent implementations, so\n-some language features may be recommended against.<\/p>\n-<p>Some of the guidelines here are relatively arbitrary choices among\n-equally plausible alternatives. The purpose of stating and enforcing\n-these rules is largely to provide a consistent look to the code. That\n-consistency makes the code more readable by avoiding non-functional\n-distractions from the interesting functionality.<\/p>\n-<p>When changing pre-existing code, it is reasonable to adjust it to\n-match these conventions. Exception: If the pre-existing code clearly\n-conforms locally to its own peculiar conventions, it is not worth\n-reformatting the whole thing. Also consider separating changes that make\n-extensive stylistic updates from those which make functional\n-changes.<\/p>\n+<p>Some programmers seem to have lexers and even C preprocessors installed directly behind their eyeballs. The rest of us require code that is not only functionally correct but also easy to read. More than that, since there is no one style for easy-to-read code, and since a mashup of many styles is just as confusing as no style at all, it is important for coders to be conscious of the many implicit stylistic choices that historically have gone into the HotSpot code base.<\/p>\n+<p>Some of these guidelines are driven by the cross-platform requirements for HotSpot. Shared code must work on a variety of platforms, and may encounter deficiencies in some. Using platform conditionalization in shared code is usually avoided, while shared code is strongly preferred to multiple platform-dependent implementations, so some language features may be recommended against.<\/p>\n+<p>Some of the guidelines here are relatively arbitrary choices among equally plausible alternatives. The purpose of stating and enforcing these rules is largely to provide a consistent look to the code. That consistency makes the code more readable by avoiding non-functional distractions from the interesting functionality.<\/p>\n+<p>When changing pre-existing code, it is reasonable to adjust it to match these conventions. Exception: If the pre-existing code clearly conforms locally to its own peculiar conventions, it is not worth reformatting the whole thing. Also consider separating changes that make extensive stylistic updates from those which make functional changes.<\/p>\n@@ -126,26 +69,5 @@\n-<p>Many of the guidelines mentioned here have (sometimes widespread)\n-counterexamples in the HotSpot code base. Finding a counterexample is\n-not sufficient justification for new code to follow the counterexample\n-as a precedent, since readers of your code will rightfully expect your\n-code to follow the greater bulk of precedents documented here.<\/p>\n-<p>Occasionally a guideline mentioned here may be just out of synch with\n-the actual HotSpot code base. If you find that a guideline is\n-consistently contradicted by a large number of counterexamples, please\n-bring it up for discussion and possible change. The architectural rule,\n-of course, is \"When in Rome do as the Romans\". Sometimes in the suburbs\n-of Rome the rules are a little different; these differences can be\n-pointed out here.<\/p>\n-<p>Proposed changes should be discussed on the <a\n-href=\"mailto:hotspot-dev@openjdk.org\">HotSpot Developers<\/a> mailing\n-list. Changes are likely to be cautious and incremental, since HotSpot\n-coders have been using these guidelines for years.<\/p>\n-<p>Substantive changes are approved by <a\n-href=\"https:\/\/www.rfc-editor.org\/rfc\/rfc7282.html\">rough consensus<\/a>\n-of the <a href=\"https:\/\/openjdk.org\/census#hotspot\">HotSpot Group<\/a>\n-Members. The Group Lead determines whether consensus has been\n-reached.<\/p>\n-<p>Editorial changes (changes that only affect the description of\n-HotSpot style, not its substance) do not require the full consensus\n-gathering process. The normal HotSpot pull request process may be used\n-for editorial changes, with the additional requirement that the\n-requisite reviewers are also HotSpot Group Members.<\/p>\n+<p>Many of the guidelines mentioned here have (sometimes widespread) counterexamples in the HotSpot code base. Finding a counterexample is not sufficient justification for new code to follow the counterexample as a precedent, since readers of your code will rightfully expect your code to follow the greater bulk of precedents documented here.<\/p>\n+<p>Occasionally a guideline mentioned here may be just out of synch with the actual HotSpot code base. If you find that a guideline is consistently contradicted by a large number of counterexamples, please bring it up for discussion and possible change. The architectural rule, of course, is &quot;When in Rome do as the Romans&quot;. Sometimes in the suburbs of Rome the rules are a little different; these differences can be pointed out here.<\/p>\n+<p>Proposed changes should be discussed on the <a href=\"mailto:hotspot-dev@openjdk.org\">HotSpot Developers<\/a> mailing list. Changes are likely to be cautious and incremental, since HotSpot coders have been using these guidelines for years.<\/p>\n+<p>Substantive changes are approved by <a href=\"https:\/\/www.rfc-editor.org\/rfc\/rfc7282.html\">rough consensus<\/a> of the <a href=\"https:\/\/openjdk.org\/census#hotspot\">HotSpot Group<\/a> Members. The Group Lead determines whether consensus has been reached.<\/p>\n+<p>Editorial changes (changes that only affect the description of HotSpot style, not its substance) do not require the full consensus gathering process. The normal HotSpot pull request process may be used for editorial changes, with the additional requirement that the requisite reviewers are also HotSpot Group Members.<\/p>\n@@ -155,48 +77,18 @@\n-<li><p>Group related code together, so readers can concentrate on one\n-section of one file.<\/p><\/li>\n-<li><p>Classes are the primary code structuring mechanism. Place related\n-functionality in a class, or a set of related classes. Use of either\n-namespaces or public non-member functions is rare in HotSpot code.\n-Static non-member functions are not uncommon.<\/p><\/li>\n-<li><p>If a class <code>FooBar<\/code> is going to be used in more than\n-one place, put it a file named fooBar.hpp and fooBar.cpp. If the class\n-is a sidekick to a more important class <code>BazBat<\/code>, it can go\n-in bazBat.hpp.<\/p><\/li>\n-<li><p>Put a member function <code>FooBar::bang<\/code> into the same\n-file that defined <code>FooBar<\/code>, or its associated <em>.inline.hpp\n-or <\/em>.cpp file.<\/p><\/li>\n-<li><p>Use public accessor functions for member variables accessed\n-outside the class.<\/p><\/li>\n-<li><p>Assign names to constant literals and use the names\n-instead.<\/p><\/li>\n-<li><p>Keep functions small, a screenful at most. Split out chunks of\n-logic into file-local classes or static functions if needed.<\/p><\/li>\n-<li><p>Factor away nonessential complexity into local inline helper\n-functions and helper classes.<\/p><\/li>\n-<li><p>Think clearly about internal invariants that apply to each class,\n-and document them in the form of asserts within member\n-functions.<\/p><\/li>\n-<li><p>Make simple, self-evident contracts for member functions. If you\n-cannot communicate a simple contract, redesign the class.<\/p><\/li>\n-<li><p>Implement classes as if expecting rough usage by clients. Check\n-for incorrect usage of a class using <code>assert(...)<\/code>,\n-<code>guarantee(...)<\/code>, <code>ShouldNotReachHere()<\/code> and\n-comments wherever needed. Performance is almost never a reason to omit\n-asserts.<\/p><\/li>\n-<li><p>When possible, design as if for reusability. This forces a clear\n-design of the class's externals, and clean hiding of its\n-internals.<\/p><\/li>\n-<li><p>Initialize all variables and data structures to a known state. If\n-a class has a constructor, initialize it there.<\/p><\/li>\n-<li><p>Do no optimization before its time. Prove the need to\n-optimize.<\/p><\/li>\n-<li><p>When you must defactor to optimize, preserve as much structure as\n-possible. If you must hand-inline some name, label the local copy with\n-the original name.<\/p><\/li>\n-<li><p>If you need to use a hidden detail (e.g., a structure offset),\n-name it (as a constant or function) in the class that owns it.<\/p><\/li>\n-<li><p>Don't use the Copy and Paste keys to replicate more than a couple\n-lines of code. Name what you must repeat.<\/p><\/li>\n-<li><p>If a class needs a member function to change a user-visible\n-attribute, the change should be done with a \"setter\" accessor matched to\n-the simple \"getter\".<\/p><\/li>\n+<li><p>Group related code together, so readers can concentrate on one section of one file.<\/p><\/li>\n+<li><p>Classes are the primary code structuring mechanism. Place related functionality in a class, or a set of related classes. Use of either namespaces or public non-member functions is rare in HotSpot code. Static non-member functions are not uncommon.<\/p><\/li>\n+<li><p>If a class <code>FooBar<\/code> is going to be used in more than one place, put it a file named fooBar.hpp and fooBar.cpp. If the class is a sidekick to a more important class <code>BazBat<\/code>, it can go in bazBat.hpp.<\/p><\/li>\n+<li><p>Put a member function <code>FooBar::bang<\/code> into the same file that defined <code>FooBar<\/code>, or its associated <em>.inline.hpp or <\/em>.cpp file.<\/p><\/li>\n+<li><p>Use public accessor functions for member variables accessed outside the class.<\/p><\/li>\n+<li><p>Assign names to constant literals and use the names instead.<\/p><\/li>\n+<li><p>Keep functions small, a screenful at most. Split out chunks of logic into file-local classes or static functions if needed.<\/p><\/li>\n+<li><p>Factor away nonessential complexity into local inline helper functions and helper classes.<\/p><\/li>\n+<li><p>Think clearly about internal invariants that apply to each class, and document them in the form of asserts within member functions.<\/p><\/li>\n+<li><p>Make simple, self-evident contracts for member functions. If you cannot communicate a simple contract, redesign the class.<\/p><\/li>\n+<li><p>Implement classes as if expecting rough usage by clients. Check for incorrect usage of a class using <code>assert(...)<\/code>, <code>guarantee(...)<\/code>, <code>ShouldNotReachHere()<\/code> and comments wherever needed. Performance is almost never a reason to omit asserts.<\/p><\/li>\n+<li><p>When possible, design as if for reusability. This forces a clear design of the class's externals, and clean hiding of its internals.<\/p><\/li>\n+<li><p>Initialize all variables and data structures to a known state. If a class has a constructor, initialize it there.<\/p><\/li>\n+<li><p>Do no optimization before its time. Prove the need to optimize.<\/p><\/li>\n+<li><p>When you must defactor to optimize, preserve as much structure as possible. If you must hand-inline some name, label the local copy with the original name.<\/p><\/li>\n+<li><p>If you need to use a hidden detail (e.g., a structure offset), name it (as a constant or function) in the class that owns it.<\/p><\/li>\n+<li><p>Don't use the Copy and Paste keys to replicate more than a couple lines of code. Name what you must repeat.<\/p><\/li>\n+<li><p>If a class needs a member function to change a user-visible attribute, the change should be done with a &quot;setter&quot; accessor matched to the simple &quot;getter&quot;.<\/p><\/li>\n@@ -206,16 +98,6 @@\n-<li><p>All source files must have a globally unique basename. The build\n-system depends on this uniqueness.<\/p><\/li>\n-<li><p>Do not put non-trivial function implementations in .hpp files. If\n-the implementation depends on other .hpp files, put it in a .cpp or a\n-.inline.hpp file.<\/p><\/li>\n-<li><p>.inline.hpp files should only be included in .cpp or .inline.hpp\n-files.<\/p><\/li>\n-<li><p>All .inline.hpp files should include their corresponding .hpp\n-file as the first include line. Declarations needed by other files\n-should be put in the .hpp file, and not in the .inline.hpp file. This\n-rule exists to resolve problems with circular dependencies between\n-.inline.hpp files.<\/p><\/li>\n-<li><p>All .cpp files include precompiled.hpp as the first include\n-line.<\/p><\/li>\n-<li><p>precompiled.hpp is just a build time optimization, so don't rely\n-on it to resolve include problems.<\/p><\/li>\n+<li><p>All source files must have a globally unique basename. The build system depends on this uniqueness.<\/p><\/li>\n+<li><p>Do not put non-trivial function implementations in .hpp files. If the implementation depends on other .hpp files, put it in a .cpp or a .inline.hpp file.<\/p><\/li>\n+<li><p>.inline.hpp files should only be included in .cpp or .inline.hpp files.<\/p><\/li>\n+<li><p>All .inline.hpp files should include their corresponding .hpp file as the first include line. Declarations needed by other files should be put in the .hpp file, and not in the .inline.hpp file. This rule exists to resolve problems with circular dependencies between .inline.hpp files.<\/p><\/li>\n+<li><p>All .cpp files include precompiled.hpp as the first include line.<\/p><\/li>\n+<li><p>precompiled.hpp is just a build time optimization, so don't rely on it to resolve include problems.<\/p><\/li>\n@@ -223,2 +105,1 @@\n-<li><p>Put conditional inclusions (<code>#if ...<\/code>) at the end of\n-the include list.<\/p><\/li>\n+<li><p>Put conditional inclusions (<code>#if ...<\/code>) at the end of the include list.<\/p><\/li>\n@@ -229,9 +110,2 @@\n-<li><p>JTReg tests associated with specific bugs should be tagged with\n-the <code>@bug<\/code> keyword in the test description.<\/p><\/li>\n-<li><p>JTReg tests should be organized by component or feature under\n-<code>test\/<\/code>, in a directory hierarchy that generally follows that\n-of the <code>src\/<\/code> directory. There may be additional\n-subdirectories to further categorize tests by feature. This structure\n-makes it easy to run a collection of tests associated with a specific\n-feature by specifying the associated directory as the source of the\n-tests to run.<\/p>\n+<li><p>JTReg tests associated with specific bugs should be tagged with the <code>@bug<\/code> keyword in the test description.<\/p><\/li>\n+<li><p>JTReg tests should be organized by component or feature under <code>test\/<\/code>, in a directory hierarchy that generally follows that of the <code>src\/<\/code> directory. There may be additional subdirectories to further categorize tests by feature. This structure makes it easy to run a collection of tests associated with a specific feature by specifying the associated directory as the source of the tests to run.<\/p>\n@@ -239,4 +113,1 @@\n-<li>Some (older) tests use the associated bug number in the directory\n-name, the test name, or both. That naming style should no longer be\n-used, with existing tests using that style being candidates for\n-migration.<\/li>\n+<li>Some (older) tests use the associated bug number in the directory name, the test name, or both. That naming style should no longer be used, with existing tests using that style being candidates for migration.<\/li>\n@@ -247,54 +118,18 @@\n-<li><p>The length of a name may be correlated to the size of its scope.\n-In particular, short names (even single letter names) may be fine in a\n-small scope, but are usually inappropriate for larger scopes.<\/p><\/li>\n-<li><p>Prefer whole words rather than abbreviations, unless the\n-abbreviation is more widely used than the long form in the code's\n-domain.<\/p><\/li>\n-<li><p>Choose names consistently. Do not introduce spurious variations.\n-Abbreviate corresponding terms to a consistent length.<\/p><\/li>\n-<li><p>Global names must be unique, to avoid <a\n-href=\"https:\/\/en.cppreference.com\/w\/cpp\/language\/definition\"\n-title=\"One Definition Rule\">One Definition Rule<\/a> (ODR) violations. A\n-common prefixing scheme for related global names is often used. (This is\n-instead of using namespaces, which are mostly avoided in\n-HotSpot.)<\/p><\/li>\n-<li><p>Don't give two names to the semantically same thing. But use\n-different names for semantically different things, even if they are\n-representationally the same. (So use meaningful <code>typedef<\/code> or\n-template alias names where appropriate.)<\/p><\/li>\n-<li><p>When choosing names, avoid categorical nouns like \"variable\",\n-\"field\", \"parameter\", \"value\", and verbs like \"compute\", \"get\".\n-(<code>storeValue(int param)<\/code> is bad.)<\/p><\/li>\n-<li><p>Type names and global names should use mixed-case with the first\n-letter of each word capitalized (<code>FooBar<\/code>).<\/p><\/li>\n-<li><p>Embedded abbreviations in otherwise mixed-case names are usually\n-capitalized entirely rather than being treated as a single word with\n-only the initial letter capitalized, e.g. \"HTML\" rather than\n-\"Html\".<\/p><\/li>\n-<li><p>Function and local variable names use lowercase with words\n-separated by a single underscore (<code>foo_bar<\/code>).<\/p><\/li>\n-<li><p>Class data member names have a leading underscore, and use\n-lowercase with words separated by a single underscore\n-(<code>_foo_bar<\/code>).<\/p><\/li>\n-<li><p>Constant names may be upper-case or mixed-case, according to\n-historical necessity. (Note: There are many examples of constants with\n-lowercase names.)<\/p><\/li>\n-<li><p>Constant names should follow an existing pattern, and must have a\n-distinct appearance from other names in related APIs.<\/p><\/li>\n-<li><p>Class and type names should be noun phrases. Consider an \"er\"\n-suffix for a class that represents an action.<\/p><\/li>\n-<li><p>Function names should be verb phrases that reflect changes of\n-state known to a class's user, or else noun phrases if they cause no\n-change of state visible to the class's user.<\/p><\/li>\n-<li><p>Getter accessor names are noun phrases, with no\n-\"<code>get_<\/code>\" noise word. Boolean getters can also begin with\n-\"<code>is_<\/code>\" or \"<code>has_<\/code>\". Member function for reading\n-data members usually have the same name as the data member, exclusive of\n-the leading underscore.<\/p><\/li>\n-<li><p>Setter accessor names prepend \"<code>set_<\/code>\" to the getter\n-name.<\/p><\/li>\n-<li><p>Other member function names are verb phrases, as if commands to\n-the receiver.<\/p><\/li>\n-<li><p>Avoid leading underscores (as \"<code>_oop<\/code>\") except in\n-cases required above. (Names with leading underscores can cause\n-portability problems.)<\/p><\/li>\n+<li><p>The length of a name may be correlated to the size of its scope. In particular, short names (even single letter names) may be fine in a small scope, but are usually inappropriate for larger scopes.<\/p><\/li>\n+<li><p>Prefer whole words rather than abbreviations, unless the abbreviation is more widely used than the long form in the code's domain.<\/p><\/li>\n+<li><p>Choose names consistently. Do not introduce spurious variations. Abbreviate corresponding terms to a consistent length.<\/p><\/li>\n+<li><p>Global names must be unique, to avoid <a href=\"https:\/\/en.cppreference.com\/w\/cpp\/language\/definition\" title=\"One Definition Rule\">One Definition Rule<\/a> (ODR) violations. A common prefixing scheme for related global names is often used. (This is instead of using namespaces, which are mostly avoided in HotSpot.)<\/p><\/li>\n+<li><p>Don't give two names to the semantically same thing. But use different names for semantically different things, even if they are representationally the same. (So use meaningful <code>typedef<\/code> or template alias names where appropriate.)<\/p><\/li>\n+<li><p>When choosing names, avoid categorical nouns like &quot;variable&quot;, &quot;field&quot;, &quot;parameter&quot;, &quot;value&quot;, and verbs like &quot;compute&quot;, &quot;get&quot;. (<code>storeValue(int param)<\/code> is bad.)<\/p><\/li>\n+<li><p>Type names and global names should use mixed-case with the first letter of each word capitalized (<code>FooBar<\/code>).<\/p><\/li>\n+<li><p>Embedded abbreviations in otherwise mixed-case names are usually capitalized entirely rather than being treated as a single word with only the initial letter capitalized, e.g. &quot;HTML&quot; rather than &quot;Html&quot;.<\/p><\/li>\n+<li><p>Function and local variable names use lowercase with words separated by a single underscore (<code>foo_bar<\/code>).<\/p><\/li>\n+<li><p>Class data member names have a leading underscore, and use lowercase with words separated by a single underscore (<code>_foo_bar<\/code>).<\/p><\/li>\n+<li><p>Constant names may be upper-case or mixed-case, according to historical necessity. (Note: There are many examples of constants with lowercase names.)<\/p><\/li>\n+<li><p>Constant names should follow an existing pattern, and must have a distinct appearance from other names in related APIs.<\/p><\/li>\n+<li><p>Class and type names should be noun phrases. Consider an &quot;er&quot; suffix for a class that represents an action.<\/p><\/li>\n+<li><p>Function names should be verb phrases that reflect changes of state known to a class's user, or else noun phrases if they cause no change of state visible to the class's user.<\/p><\/li>\n+<li><p>Getter accessor names are noun phrases, with no &quot;<code>get_<\/code>&quot; noise word. Boolean getters can also begin with &quot;<code>is_<\/code>&quot; or &quot;<code>has_<\/code>&quot;. Member function for reading data members usually have the same name as the data member, exclusive of the leading underscore.<\/p><\/li>\n+<li><p>Setter accessor names prepend &quot;<code>set_<\/code>&quot; to the getter name.<\/p><\/li>\n+<li><p>Other member function names are verb phrases, as if commands to the receiver.<\/p><\/li>\n+<li><p>Avoid leading underscores (as &quot;<code>_oop<\/code>&quot;) except in cases required above. (Names with leading underscores can cause portability problems.)<\/p><\/li>\n@@ -306,9 +141,3 @@\n-<li><p>If you have to choose between commenting code and writing wiki\n-content, comment the code. Link from the wiki to the source file if it\n-makes sense.<\/p><\/li>\n-<li><p>As a general rule don't add bug numbers to comments (they would\n-soon overwhelm the code). But if the bug report contains significant\n-information that can't reasonably be added as a comment, then refer to\n-the bug report.<\/p><\/li>\n-<li><p>Personal names are discouraged in the source code, which is a\n-team product.<\/p><\/li>\n+<li><p>If you have to choose between commenting code and writing wiki content, comment the code. Link from the wiki to the source file if it makes sense.<\/p><\/li>\n+<li><p>As a general rule don't add bug numbers to comments (they would soon overwhelm the code). But if the bug report contains significant information that can't reasonably be added as a comment, then refer to the bug report.<\/p><\/li>\n+<li><p>Personal names are discouraged in the source code, which is a team product.<\/p><\/li>\n@@ -318,21 +147,6 @@\n-<li><p>You can almost always use an inline function or class instead of\n-a macro. Use a macro only when you really need it.<\/p><\/li>\n-<li><p>Templates may be preferable to multi-line macros. (There may be\n-subtle performance effects with templates on some platforms; revert to\n-macros if absolutely necessary.)<\/p><\/li>\n-<li><p><code>#ifdef<\/code>s should not be used to introduce\n-platform-specific code into shared code (except for <code>_LP64<\/code>).\n-They must be used to manage header files, in the pattern found at the\n-top of every source file. They should be used mainly for major build\n-features, including <code>PRODUCT<\/code>, <code>ASSERT<\/code>,\n-<code>_LP64<\/code>, <code>INCLUDE_SERIALGC<\/code>,\n-<code>COMPILER1<\/code>, etc.<\/p><\/li>\n-<li><p>For build features such as <code>PRODUCT<\/code>, use\n-<code>#ifdef PRODUCT<\/code> for multiple-line inclusions or\n-exclusions.<\/p><\/li>\n-<li><p>For short inclusions or exclusions based on build features, use\n-macros like <code>PRODUCT_ONLY<\/code> and <code>NOT_PRODUCT<\/code>. But\n-avoid using them with multiple-line arguments, since debuggers do not\n-handle that well.<\/p><\/li>\n-<li><p>Use <code>CATCH<\/code>, <code>THROW<\/code>, etc. for\n-HotSpot-specific exception processing.<\/p><\/li>\n+<li><p>You can almost always use an inline function or class instead of a macro. Use a macro only when you really need it.<\/p><\/li>\n+<li><p>Templates may be preferable to multi-line macros. (There may be subtle performance effects with templates on some platforms; revert to macros if absolutely necessary.)<\/p><\/li>\n+<li><p><code>#ifdef<\/code>s should not be used to introduce platform-specific code into shared code (except for <code>_LP64<\/code>). They must be used to manage header files, in the pattern found at the top of every source file. They should be used mainly for major build features, including <code>PRODUCT<\/code>, <code>ASSERT<\/code>, <code>_LP64<\/code>, <code>INCLUDE_SERIALGC<\/code>, <code>COMPILER1<\/code>, etc.<\/p><\/li>\n+<li><p>For build features such as <code>PRODUCT<\/code>, use <code>#ifdef PRODUCT<\/code> for multiple-line inclusions or exclusions.<\/p><\/li>\n+<li><p>For short inclusions or exclusions based on build features, use macros like <code>PRODUCT_ONLY<\/code> and <code>NOT_PRODUCT<\/code>. But avoid using them with multiple-line arguments, since debuggers do not handle that well.<\/p><\/li>\n+<li><p>Use <code>CATCH<\/code>, <code>THROW<\/code>, etc. for HotSpot-specific exception processing.<\/p><\/li>\n@@ -342,10 +156,2 @@\n-<li><p>In general, don't change whitespace unless it improves\n-readability or consistency. Gratuitous whitespace changes will make\n-integrations and backports more difficult.<\/p><\/li>\n-<li><p>Use <a\n-href=\"https:\/\/en.wikipedia.org\/wiki\/Indentation_style#Variant:_1TBS_(OTBS)\">One-True-Brace-Style<\/a>.\n-The opening brace for a function or class is normally at the end of the\n-line; it is sometimes moved to the beginning of the next line for\n-emphasis. Substatements are enclosed in braces, even if there is only a\n-single statement. Extremely simple one-line statements may drop braces\n-around a substatement.<\/p><\/li>\n+<li><p>In general, don't change whitespace unless it improves readability or consistency. Gratuitous whitespace changes will make integrations and backports more difficult.<\/p><\/li>\n+<li><p>Use <a href=\"https:\/\/en.wikipedia.org\/wiki\/Indentation_style#Variant:_1TBS_(OTBS)\">One-True-Brace-Style<\/a>. The opening brace for a function or class is normally at the end of the line; it is sometimes moved to the beginning of the next line for emphasis. Substatements are enclosed in braces, even if there is only a single statement. Extremely simple one-line statements may drop braces around a substatement.<\/p><\/li>\n@@ -353,21 +159,5 @@\n-<li><p>There is no hard line length limit. That said, bear in mind that\n-excessively long lines can cause difficulties. Some people like to have\n-multiple side-by-side windows in their editors, and long lines may force\n-them to choose among unpleasant options. They can use wide windows,\n-reducing the number that can fit across the screen, and wasting a lot of\n-screen real estate because most lines are not that long. Alternatively,\n-they can have more windows across the screen, with long lines wrapping\n-(or worse, requiring scrolling to see in their entirety), which is\n-harder to read. Similar issues exist for side-by-side code\n-reviews.<\/p><\/li>\n-<li><p>Tabs are not allowed in code. Set your editor accordingly.<br>\n-(Emacs: <code>(setq-default indent-tabs-mode nil)<\/code>.)<\/p><\/li>\n-<li><p>Use good taste to break lines and align corresponding tokens on\n-adjacent lines.<\/p><\/li>\n-<li><p>Use spaces around operators, especially comparisons and\n-assignments. (Relaxable for boolean expressions and high-precedence\n-operators in classic math-style formulas.)<\/p><\/li>\n-<li><p>Put spaces on both sides of control flow keywords\n-<code>if<\/code>, <code>else<\/code>, <code>for<\/code>,\n-<code>switch<\/code>, etc. Don't add spaces around the associated\n-<em>control<\/em> expressions. Examples:<\/p>\n+<li><p>There is no hard line length limit. That said, bear in mind that excessively long lines can cause difficulties. Some people like to have multiple side-by-side windows in their editors, and long lines may force them to choose among unpleasant options. They can use wide windows, reducing the number that can fit across the screen, and wasting a lot of screen real estate because most lines are not that long. Alternatively, they can have more windows across the screen, with long lines wrapping (or worse, requiring scrolling to see in their entirety), which is harder to read. Similar issues exist for side-by-side code reviews.<\/p><\/li>\n+<li><p>Tabs are not allowed in code. Set your editor accordingly.<br> (Emacs: <code>(setq-default indent-tabs-mode nil)<\/code>.)<\/p><\/li>\n+<li><p>Use good taste to break lines and align corresponding tokens on adjacent lines.<\/p><\/li>\n+<li><p>Use spaces around operators, especially comparisons and assignments. (Relaxable for boolean expressions and high-precedence operators in classic math-style formulas.)<\/p><\/li>\n+<li><p>Put spaces on both sides of control flow keywords <code>if<\/code>, <code>else<\/code>, <code>for<\/code>, <code>switch<\/code>, etc. Don't add spaces around the associated <em>control<\/em> expressions. Examples:<\/p>\n@@ -377,10 +167,3 @@\n-<li><p>Use extra parentheses in expressions whenever operator precedence\n-seems doubtful. Always use parentheses in shift\/mask expressions\n-(<code>&lt;&lt;<\/code>, <code>&amp;<\/code>, <code>|<\/code>). Don't add\n-whitespace immediately inside parentheses.<\/p><\/li>\n-<li><p>Use more spaces and blank lines between larger constructs, such\n-as classes or function definitions.<\/p><\/li>\n-<li><p>If the surrounding code has any sort of vertical organization,\n-adjust new lines horizontally to be consistent with that organization.\n-(E.g., trailing backslashes on long macro definitions often\n-align.)<\/p><\/li>\n+<li><p>Use extra parentheses in expressions whenever operator precedence seems doubtful. Always use parentheses in shift\/mask expressions (<code>&lt;&lt;<\/code>, <code>&amp;<\/code>, <code>|<\/code>). Don't add whitespace immediately inside parentheses.<\/p><\/li>\n+<li><p>Use more spaces and blank lines between larger constructs, such as classes or function definitions.<\/p><\/li>\n+<li><p>If the surrounding code has any sort of vertical organization, adjust new lines horizontally to be consistent with that organization. (E.g., trailing backslashes on long macro definitions often align.)<\/p><\/li>\n@@ -390,5 +173,2 @@\n-<li><p>Use the <a href=\"https:\/\/en.cppreference.com\/w\/cpp\/language\/raii\"\n-title=\"Resource Acquisition Is Initialization\">Resource Acquisition Is\n-Initialization<\/a> (RAII) design pattern to manage bracketed critical\n-sections. See class <code>ResourceMark<\/code> for an example.<\/p><\/li>\n-<li><p>Avoid implicit conversions to <code>bool<\/code>.<\/p>\n+<li><p>Use the <a href=\"https:\/\/en.cppreference.com\/w\/cpp\/language\/raii\" title=\"Resource Acquisition Is Initialization\">Resource Acquisition Is Initialization<\/a> (RAII) design pattern to manage bracketed critical sections. See class <code>ResourceMark<\/code> for an example.<\/p><\/li>\n+<li>Avoid implicit conversions to <code>bool<\/code>.\n@@ -397,6 +177,2 @@\n-<li>Do not use ints or pointers as (implicit) booleans with\n-<code>&amp;&amp;<\/code>, <code>||<\/code>, <code>if<\/code>,\n-<code>while<\/code>. Instead, compare explicitly, i.e.\n-<code>if (x != 0)<\/code> or <code>if (ptr != nullptr)<\/code>, etc.<\/li>\n-<li>Do not use declarations in <em>condition<\/em> forms, i.e. don't use\n-<code>if (T v = value) { ... }<\/code>.<\/li>\n+<li>Do not use ints or pointers as (implicit) booleans with <code>&amp;&amp;<\/code>, <code>||<\/code>, <code>if<\/code>, <code>while<\/code>. Instead, compare explicitly, i.e. <code>if (x != 0)<\/code> or <code>if (ptr != nullptr)<\/code>, etc.<\/li>\n+<li>Do not use declarations in <em>condition<\/em> forms, i.e. don't use <code>if (T v = value) { ... }<\/code>.<\/li>\n@@ -404,5 +180,1 @@\n-<li><p>Use functions from globalDefinitions.hpp and related files when\n-performing bitwise operations on integers. Do not code directly as C\n-operators, unless they are extremely simple. (Examples:\n-<code>align_up<\/code>, <code>is_power_of_2<\/code>,\n-<code>exact_log2<\/code>.)<\/p><\/li>\n+<li><p>Use functions from globalDefinitions.hpp and related files when performing bitwise operations on integers. Do not code directly as C operators, unless they are extremely simple. (Examples: <code>align_up<\/code>, <code>is_power_of_2<\/code>, <code>exact_log2<\/code>.)<\/p><\/li>\n@@ -410,2 +182,1 @@\n-<li><p>Always enumerate all cases in a switch statement or provide a\n-default case. It is ok to have an empty default with comment.<\/p><\/li>\n+<li><p>Always enumerate all cases in a switch statement or provide a default case. It is ok to have an empty default with comment.<\/p><\/li>\n@@ -414,36 +185,11 @@\n-<p>HotSpot was originally written in a subset of the C++98\/03 language.\n-More recently, support for C++14 is provided, though again, HotSpot only\n-uses a subset. (Backports to JDK versions lacking support for more\n-recent Standards must of course stick with the original C++98\/03\n-subset.)<\/p>\n-<p>This section describes that subset. Features from the C++98\/03\n-language may be used unless explicitly excluded here. Features from\n-C++11 and C++14 may be explicitly permitted or explicitly excluded, and\n-discussed accordingly here. There is a third category, undecided\n-features, about which HotSpot developers have not yet reached a\n-consensus, or perhaps have not discussed at all. Use of these features\n-is also excluded.<\/p>\n-<p>(The use of some features may not be immediately obvious and may slip\n-in anyway, since the compiler will accept them. The code review process\n-is the main defense against this.)<\/p>\n-<p>Some features are discussed in their own subsection, typically to\n-provide more extensive discussion or rationale for limitations. Features\n-that don't have their own subsection are listed in omnibus feature\n-sections for permitted, excluded, and undecided features.<\/p>\n-<p>Lists of new features for C++11 and C++14, along with links to their\n-descriptions, can be found in the online documentation for some of the\n-compilers and libraries. The C++14 Standard is the definitive\n-description.<\/p>\n-<ul>\n-<li><a href=\"https:\/\/gcc.gnu.org\/projects\/cxx-status.html\">C++ Standards\n-Support in GCC<\/a><\/li>\n-<li><a href=\"https:\/\/clang.llvm.org\/cxx_status.html\">C++ Support in\n-Clang<\/a><\/li>\n-<li><a\n-href=\"https:\/\/docs.microsoft.com\/en-us\/cpp\/visual-cpp-language-conformance\">Visual\n-C++ Language Conformance<\/a><\/li>\n-<li><a\n-href=\"https:\/\/gcc.gnu.org\/onlinedocs\/libstdc++\/manual\/status.html\">libstdc++\n-Status<\/a><\/li>\n-<li><a href=\"https:\/\/libcxx.llvm.org\/cxx1y_status.html\">libc++\n-Status<\/a><\/li>\n+<p>HotSpot was originally written in a subset of the C++98\/03 language. More recently, support for C++14 is provided, though again, HotSpot only uses a subset. (Backports to JDK versions lacking support for more recent Standards must of course stick with the original C++98\/03 subset.)<\/p>\n+<p>This section describes that subset. Features from the C++98\/03 language may be used unless explicitly excluded here. Features from C++11 and C++14 may be explicitly permitted or explicitly excluded, and discussed accordingly here. There is a third category, undecided features, about which HotSpot developers have not yet reached a consensus, or perhaps have not discussed at all. Use of these features is also excluded.<\/p>\n+<p>(The use of some features may not be immediately obvious and may slip in anyway, since the compiler will accept them. The code review process is the main defense against this.)<\/p>\n+<p>Some features are discussed in their own subsection, typically to provide more extensive discussion or rationale for limitations. Features that don't have their own subsection are listed in omnibus feature sections for permitted, excluded, and undecided features.<\/p>\n+<p>Lists of new features for C++11 and C++14, along with links to their descriptions, can be found in the online documentation for some of the compilers and libraries. The C++14 Standard is the definitive description.<\/p>\n+<ul>\n+<li><a href=\"https:\/\/gcc.gnu.org\/projects\/cxx-status.html\">C++ Standards Support in GCC<\/a><\/li>\n+<li><a href=\"https:\/\/clang.llvm.org\/cxx_status.html\">C++ Support in Clang<\/a><\/li>\n+<li><a href=\"https:\/\/docs.microsoft.com\/en-us\/cpp\/visual-cpp-language-conformance\">Visual C++ Language Conformance<\/a><\/li>\n+<li><a href=\"https:\/\/gcc.gnu.org\/onlinedocs\/libstdc++\/manual\/status.html\">libstdc++ Status<\/a><\/li>\n+<li><a href=\"https:\/\/libcxx.llvm.org\/cxx1y_status.html\">libc++ Status<\/a><\/li>\n@@ -451,2 +197,1 @@\n-<p>As a rule of thumb, permitting features which simplify writing code\n-and, especially, reading code, is encouraged.<\/p>\n+<p>As a rule of thumb, permitting features which simplify writing code and, especially, reading code, is encouraged.<\/p>\n@@ -455,13 +200,4 @@\n-<li><p><a\n-href=\"https:\/\/google.github.io\/styleguide\/cppguide.html\">Google C++\n-Style Guide<\/a> — Currently (2020) targeting C++17.<\/p><\/li>\n-<li><p><a\n-href=\"https:\/\/chromium.googlesource.com\/chromium\/src\/+\/main\/styleguide\/c++\/c++-features.md\">C++11\n-and C++14 use in Chromium<\/a> — Categorizes features as allowed, banned,\n-or to be discussed.<\/p><\/li>\n-<li><p><a href=\"https:\/\/llvm.org\/docs\/CodingStandards.html\">llvm Coding\n-Standards<\/a> — Currently (2020) targeting C++14.<\/p><\/li>\n-<li><p><a\n-href=\"https:\/\/firefox-source-docs.mozilla.org\/code-quality\/coding-style\/using_cxx_in_firefox_code.html\">Using\n-C++ in Mozilla code<\/a> — C++17 support is required for recent versions\n-(2020).<\/p><\/li>\n+<li><p><a href=\"https:\/\/google.github.io\/styleguide\/cppguide.html\">Google C++ Style Guide<\/a> — Currently (2020) targeting C++17.<\/p><\/li>\n+<li><p><a href=\"https:\/\/chromium.googlesource.com\/chromium\/src\/+\/main\/styleguide\/c++\/c++-features.md\">C++11 and C++14 use in Chromium<\/a> — Categorizes features as allowed, banned, or to be discussed.<\/p><\/li>\n+<li><p><a href=\"https:\/\/llvm.org\/docs\/CodingStandards.html\">llvm Coding Standards<\/a> — Currently (2020) targeting C++14.<\/p><\/li>\n+<li><p><a href=\"https:\/\/firefox-source-docs.mozilla.org\/code-quality\/coding-style\/using_cxx_in_firefox_code.html\">Using C++ in Mozilla code<\/a> — C++17 support is required for recent versions (2020).<\/p><\/li>\n@@ -470,36 +206,6 @@\n-<p>Do not use exceptions. Exceptions are disabled by the build\n-configuration for some platforms.<\/p>\n-<p>Rationale: There is significant concern over the performance cost of\n-exceptions and their usage model and implications for maintainable code.\n-That's not just a matter of history that has been fixed; there remain\n-questions and problems even today (2019). See, for example, <a\n-href=\"http:\/\/www.open-std.org\/jtc1\/sc22\/wg21\/docs\/papers\/2018\/p0709r0.pdf\">Zero\n-cost deterministic exceptions<\/a>. Because of this, HotSpot has always\n-used a build configuration that disables exceptions where that is\n-available. As a result, HotSpot code uses error handling mechanisms such\n-as two-phase construction, factory functions, returning error codes, and\n-immediate termination. Even if the cost of exceptions were not a\n-concern, the existing body of code was not written with exception safety\n-in mind. Making HotSpot exception safe would be a very large\n-undertaking.<\/p>\n-<p>In addition to the usual alternatives to exceptions, HotSpot provides\n-its own exception mechanism. This is based on a set of macros defined in\n-utilities\/exceptions.hpp.<\/p>\n-<h3 id=\"rtti-runtime-type-information\">RTTI (Runtime Type\n-Information)<\/h3>\n-<p>Do not use <a\n-href=\"https:\/\/en.wikipedia.org\/wiki\/Run-time_type_information\"\n-title=\"Runtime Type Information\">Runtime Type Information<\/a> (RTTI). <a\n-href=\"https:\/\/en.wikipedia.org\/wiki\/Run-time_type_information\"\n-title=\"Runtime Type Information\">RTTI<\/a> is disabled by the build\n-configuration for some platforms. Among other things, this means\n-<code>dynamic_cast<\/code> cannot be used.<\/p>\n-<p>Rationale: Other than to implement exceptions (which HotSpot doesn't\n-use), most potential uses of <a\n-href=\"https:\/\/en.wikipedia.org\/wiki\/Run-time_type_information\"\n-title=\"Runtime Type Information\">RTTI<\/a> are better done via virtual\n-functions. Some of the remainder can be replaced by bespoke mechanisms.\n-The cost of the additional runtime data structures needed to support <a\n-href=\"https:\/\/en.wikipedia.org\/wiki\/Run-time_type_information\"\n-title=\"Runtime Type Information\">RTTI<\/a> are deemed not worthwhile,\n-given the alternatives.<\/p>\n+<p>Do not use exceptions. Exceptions are disabled by the build configuration for some platforms.<\/p>\n+<p>Rationale: There is significant concern over the performance cost of exceptions and their usage model and implications for maintainable code. That's not just a matter of history that has been fixed; there remain questions and problems even today (2019). See, for example, <a href=\"http:\/\/www.open-std.org\/jtc1\/sc22\/wg21\/docs\/papers\/2018\/p0709r0.pdf\">Zero cost deterministic exceptions<\/a>. Because of this, HotSpot has always used a build configuration that disables exceptions where that is available. As a result, HotSpot code uses error handling mechanisms such as two-phase construction, factory functions, returning error codes, and immediate termination. Even if the cost of exceptions were not a concern, the existing body of code was not written with exception safety in mind. Making HotSpot exception safe would be a very large undertaking.<\/p>\n+<p>In addition to the usual alternatives to exceptions, HotSpot provides its own exception mechanism. This is based on a set of macros defined in utilities\/exceptions.hpp.<\/p>\n+<h3 id=\"rtti-runtime-type-information\">RTTI (Runtime Type Information)<\/h3>\n+<p>Do not use <a href=\"https:\/\/en.wikipedia.org\/wiki\/Run-time_type_information\" title=\"Runtime Type Information\">Runtime Type Information<\/a> (RTTI). <a href=\"https:\/\/en.wikipedia.org\/wiki\/Run-time_type_information\" title=\"Runtime Type Information\">RTTI<\/a> is disabled by the build configuration for some platforms. Among other things, this means <code>dynamic_cast<\/code> cannot be used.<\/p>\n+<p>Rationale: Other than to implement exceptions (which HotSpot doesn't use), most potential uses of <a href=\"https:\/\/en.wikipedia.org\/wiki\/Run-time_type_information\" title=\"Runtime Type Information\">RTTI<\/a> are better done via virtual functions. Some of the remainder can be replaced by bespoke mechanisms. The cost of the additional runtime data structures needed to support <a href=\"https:\/\/en.wikipedia.org\/wiki\/Run-time_type_information\" title=\"Runtime Type Information\">RTTI<\/a> are deemed not worthwhile, given the alternatives.<\/p>\n@@ -507,12 +213,3 @@\n-<p>Do not use the standard global allocation and deallocation functions\n-(operator new and related functions). Use of these functions by HotSpot\n-code is disabled for some platforms.<\/p>\n-<p>Rationale: HotSpot often uses \"resource\" or \"arena\" allocation. Even\n-where heap allocation is used, the standard global functions are avoided\n-in favor of wrappers around malloc and free that support the VM's Native\n-Memory Tracking (NMT) feature. Typically, uses of the global operator\n-new are inadvertent and therefore often associated with memory\n-leaks.<\/p>\n-<p>Native memory allocation failures are often treated as\n-non-recoverable. The place where \"out of memory\" is (first) detected may\n-be an innocent bystander, unrelated to the actual culprit.<\/p>\n+<p>Do not use the standard global allocation and deallocation functions (operator new and related functions). Use of these functions by HotSpot code is disabled for some platforms.<\/p>\n+<p>Rationale: HotSpot often uses &quot;resource&quot; or &quot;arena&quot; allocation. Even where heap allocation is used, the standard global functions are avoided in favor of wrappers around malloc and free that support the VM's Native Memory Tracking (NMT) feature. Typically, uses of the global operator new are inadvertent and therefore often associated with memory leaks.<\/p>\n+<p>Native memory allocation failures are often treated as non-recoverable. The place where &quot;out of memory&quot; is (first) detected may be an innocent bystander, unrelated to the actual culprit.<\/p>\n@@ -522,2 +219,1 @@\n-<p>Restrict inheritance to the \"is-a\" case; use composition rather than\n-non-is-a related inheritance.<\/p>\n+<p>Restrict inheritance to the &quot;is-a&quot; case; use composition rather than non-is-a related inheritance.<\/p>\n@@ -526,4 +222,1 @@\n-<p>Avoid using namespaces. HotSpot code normally uses \"all static\"\n-classes rather than namespaces for grouping. An \"all static\" class is\n-not instantiable, has only static members, and is normally derived\n-(possibly indirectly) from the helper class <code>AllStatic<\/code>.<\/p>\n+<p>Avoid using namespaces. HotSpot code normally uses &quot;all static&quot; classes rather than namespaces for grouping. An &quot;all static&quot; class is not instantiable, has only static members, and is normally derived (possibly indirectly) from the helper class <code>AllStatic<\/code>.<\/p>\n@@ -532,7 +225,3 @@\n-<li><p>Provides access control for members, which is unavailable with\n-namespaces.<\/p><\/li>\n-<li><p>Avoids <a href=\"https:\/\/en.cppreference.com\/w\/cpp\/language\/adl\"\n-title=\"Argument Dependent Lookup\">Argument Dependent Lookup<\/a>\n-(ADL).<\/p><\/li>\n-<li><p>Closed for additional members. Namespaces allow names to be added\n-in multiple contexts, making it harder to see the complete API.<\/p><\/li>\n+<li><p>Provides access control for members, which is unavailable with namespaces.<\/p><\/li>\n+<li><p>Avoids <a href=\"https:\/\/en.cppreference.com\/w\/cpp\/language\/adl\" title=\"Argument Dependent Lookup\">Argument Dependent Lookup<\/a> (ADL).<\/p><\/li>\n+<li><p>Closed for additional members. Namespaces allow names to be added in multiple contexts, making it harder to see the complete API.<\/p><\/li>\n@@ -540,21 +229,5 @@\n-<p>Namespaces should be used only in cases where one of those \"benefits\"\n-is actually a hindrance.<\/p>\n-<p>In particular, don't use anonymous namespaces. They seem like they\n-should be useful, and indeed have some real benefits for naming and\n-generated code size on some platforms. Unfortunately, debuggers don't\n-seem to like them at all.<\/p>\n-<p><a\n-href=\"https:\/\/groups.google.com\/forum\/#!topic\/mozilla.dev.platform\/KsaG3lEEaRM\"\n-class=\"uri\">https:\/\/groups.google.com\/forum\/#!topic\/mozilla.dev.platform\/KsaG3lEEaRM<\/a><br>\n-Suggests Visual Studio debugger might not be able to refer to anonymous\n-namespace symbols, so can't set breakpoints in them. Though the\n-discussion seems to go back and forth on that.<\/p>\n-<p><a\n-href=\"https:\/\/firefox-source-docs.mozilla.org\/code-quality\/coding-style\/coding_style_cpp.html\"\n-class=\"uri\">https:\/\/firefox-source-docs.mozilla.org\/code-quality\/coding-style\/coding_style_cpp.html<\/a><br>\n-Search for \"Anonymous namespaces\" Suggests preferring \"static\" to\n-anonymous namespaces where applicable, because of poor debugger support\n-for anonymous namespaces.<\/p>\n-<p><a href=\"https:\/\/sourceware.org\/bugzilla\/show_bug.cgi?id=16874\"\n-class=\"uri\">https:\/\/sourceware.org\/bugzilla\/show_bug.cgi?id=16874<\/a><br>\n-Bug for similar gdb problems.<\/p>\n+<p>Namespaces should be used only in cases where one of those &quot;benefits&quot; is actually a hindrance.<\/p>\n+<p>In particular, don't use anonymous namespaces. They seem like they should be useful, and indeed have some real benefits for naming and generated code size on some platforms. Unfortunately, debuggers don't seem to like them at all.<\/p>\n+<p><a href=\"https:\/\/groups.google.com\/forum\/#!topic\/mozilla.dev.platform\/KsaG3lEEaRM\" class=\"uri\">https:\/\/groups.google.com\/forum\/#!topic\/mozilla.dev.platform\/KsaG3lEEaRM<\/a><br> Suggests Visual Studio debugger might not be able to refer to anonymous namespace symbols, so can't set breakpoints in them. Though the discussion seems to go back and forth on that.<\/p>\n+<p><a href=\"https:\/\/firefox-source-docs.mozilla.org\/code-quality\/coding-style\/coding_style_cpp.html\" class=\"uri\">https:\/\/firefox-source-docs.mozilla.org\/code-quality\/coding-style\/coding_style_cpp.html<\/a><br> Search for &quot;Anonymous namespaces&quot; Suggests preferring &quot;static&quot; to anonymous namespaces where applicable, because of poor debugger support for anonymous namespaces.<\/p>\n+<p><a href=\"https:\/\/sourceware.org\/bugzilla\/show_bug.cgi?id=16874\" class=\"uri\">https:\/\/sourceware.org\/bugzilla\/show_bug.cgi?id=16874<\/a><br> Bug for similar gdb problems.<\/p>\n@@ -563,6 +236,2 @@\n-<p>Historically, HotSpot has mostly avoided use of the Standard\n-Library.<\/p>\n-<p>(It used to be impossible to use most of it in shared code, because\n-the build configuration for Solaris with Solaris Studio made all but a\n-couple of pieces inaccessible. Support for header-only parts was added\n-in mid-2017. Support for Solaris was removed in 2020.)<\/p>\n+<p>Historically, HotSpot has mostly avoided use of the Standard Library.<\/p>\n+<p>(It used to be impossible to use most of it in shared code, because the build configuration for Solaris with Solaris Studio made all but a couple of pieces inaccessible. Support for header-only parts was added in mid-2017. Support for Solaris was removed in 2020.)<\/p>\n@@ -571,21 +240,5 @@\n-<li><p>Exceptions. Perhaps the largest core issue with adopting the use\n-of Standard Library facilities is exceptions. HotSpot does not use\n-exceptions and, for platforms which allow doing so, builds with them\n-turned off. Many Standard Library facilities implicitly or explicitly\n-use exceptions.<\/p><\/li>\n-<li><p><code>assert<\/code>. An issue that is quickly encountered is the\n-<code>assert<\/code> macro name collision (<a\n-href=\"https:\/\/bugs.openjdk.org\/browse\/JDK-8007770\">JDK-8007770<\/a>).\n-Some mechanism for addressing this would be needed before much of the\n-Standard Library could be used. (Not all Standard Library\n-implementations use assert in header files, but some do.)<\/p><\/li>\n-<li><p>Memory allocation. HotSpot requires explicit control over where\n-allocations occur. The C++98\/03 <code>std::allocator<\/code> class is too\n-limited to support our usage. (Changes in more recent Standards may\n-remove this limitation.)<\/p><\/li>\n-<li><p>Implementation vagaries. Bugs, or simply different implementation\n-choices, can lead to different behaviors among the various Standard\n-Libraries we need to deal with.<\/p><\/li>\n-<li><p>Inconsistent naming conventions. HotSpot and the C++ Standard use\n-different naming conventions. The coexistence of those different\n-conventions might appear jarring and reduce readability.<\/p><\/li>\n+<li><p>Exceptions. Perhaps the largest core issue with adopting the use of Standard Library facilities is exceptions. HotSpot does not use exceptions and, for platforms which allow doing so, builds with them turned off. Many Standard Library facilities implicitly or explicitly use exceptions.<\/p><\/li>\n+<li><p><code>assert<\/code>. An issue that is quickly encountered is the <code>assert<\/code> macro name collision (<a href=\"https:\/\/bugs.openjdk.org\/browse\/JDK-8007770\">JDK-8007770<\/a>). Some mechanism for addressing this would be needed before much of the Standard Library could be used. (Not all Standard Library implementations use assert in header files, but some do.)<\/p><\/li>\n+<li><p>Memory allocation. HotSpot requires explicit control over where allocations occur. The C++98\/03 <code>std::allocator<\/code> class is too limited to support our usage. (Changes in more recent Standards may remove this limitation.)<\/p><\/li>\n+<li><p>Implementation vagaries. Bugs, or simply different implementation choices, can lead to different behaviors among the various Standard Libraries we need to deal with.<\/p><\/li>\n+<li><p>Inconsistent naming conventions. HotSpot and the C++ Standard use different naming conventions. The coexistence of those different conventions might appear jarring and reduce readability.<\/p><\/li>\n@@ -595,4 +248,2 @@\n-<li><code>#include &lt;new&gt;<\/code> to use placement <code>new<\/code>,\n-<code>std::nothrow<\/code>, and <code>std::nothrow_t<\/code>.<\/li>\n-<li><code>#include &lt;limits&gt;<\/code> to use\n-<code>std::numeric_limits<\/code>.<\/li>\n+<li><code>#include &lt;new&gt;<\/code> to use placement <code>new<\/code>, <code>std::nothrow<\/code>, and <code>std::nothrow_t<\/code>.<\/li>\n+<li><code>#include &lt;limits&gt;<\/code> to use <code>std::numeric_limits<\/code>.<\/li>\n@@ -600,2 +251,1 @@\n-<li><code>#include &lt;cstddef&gt;<\/code> to use\n-<code>std::nullptr_t<\/code>.<\/li>\n+<li><code>#include &lt;cstddef&gt;<\/code> to use <code>std::nullptr_t<\/code>.<\/li>\n@@ -603,5 +253,1 @@\n-<p>TODO: Rather than directly #including (permitted) Standard Library\n-headers, use a convention of #including wrapper headers (in some\n-location like hotspot\/shared\/stdcpp). This provides a single place for\n-dealing with issues we might have for any given header, esp.\n-platform-specific issues.<\/p>\n+<p>TODO: Rather than directly #including (permitted) Standard Library headers, use a convention of #including wrapper headers (in some location like hotspot\/shared\/stdcpp). This provides a single place for dealing with issues we might have for any given header, esp. platform-specific issues.<\/p>\n@@ -609,5 +255,1 @@\n-<p>Use type deduction only if it makes the code clearer or safer. Do not\n-use it merely to avoid the inconvenience of writing an explicit type,\n-unless that type is itself difficult to write. An example of the latter\n-is a function template return type that depends on template parameters\n-in a non-trivial way.<\/p>\n+<p>Use type deduction only if it makes the code clearer or safer. Do not use it merely to avoid the inconvenience of writing an explicit type, unless that type is itself difficult to write. An example of the latter is a function template return type that depends on template parameters in a non-trivial way.<\/p>\n@@ -616,15 +258,4 @@\n-<li><p>Function argument deduction. This is always permitted, and indeed\n-encouraged. It is nearly always better to allow the type of a function\n-template argument to be deduced rather than explicitly\n-specified.<\/p><\/li>\n-<li><p><code>auto<\/code> variable declarations (<a\n-href=\"http:\/\/www.open-std.org\/jtc1\/sc22\/wg21\/docs\/papers\/2006\/n1984.pdf\">n1984<\/a>)<br>\n-For local variables, this can be used to make the code clearer by\n-eliminating type information that is obvious or irrelevant. Excessive\n-use can make code much harder to understand.<\/p><\/li>\n-<li><p>Function return type deduction (<a\n-href=\"https:\/\/isocpp.org\/files\/papers\/N3638.html\">n3638<\/a>)<br> Only\n-use if the function body has a very small number of <code>return<\/code>\n-statements, and generally relatively little other code.<\/p><\/li>\n-<li><p>Also see <a href=\"#lambdaexpressions\">lambda\n-expressions<\/a>.<\/p><\/li>\n+<li><p>Function argument deduction. This is always permitted, and indeed encouraged. It is nearly always better to allow the type of a function template argument to be deduced rather than explicitly specified.<\/p><\/li>\n+<li><p><code>auto<\/code> variable declarations (<a href=\"http:\/\/www.open-std.org\/jtc1\/sc22\/wg21\/docs\/papers\/2006\/n1984.pdf\">n1984<\/a>)<br> For local variables, this can be used to make the code clearer by eliminating type information that is obvious or irrelevant. Excessive use can make code much harder to understand.<\/p><\/li>\n+<li><p>Function return type deduction (<a href=\"https:\/\/isocpp.org\/files\/papers\/N3638.html\">n3638<\/a>)<br> Only use if the function body has a very small number of <code>return<\/code> statements, and generally relatively little other code.<\/p><\/li>\n+<li><p>Also see <a href=\"#lambdaexpressions\">lambda expressions<\/a>.<\/p><\/li>\n@@ -633,22 +264,3 @@\n-<p><a href=\"https:\/\/en.cppreference.com\/w\/cpp\/language\/sfinae\"\n-title=\"Substitution Failure Is Not An Error\">Substitution Failure Is Not\n-An Error<\/a> (SFINAE) is a template metaprogramming technique that makes\n-use of template parameter substitution failures to make compile-time\n-decisions.<\/p>\n-<p>C++11 relaxed the rules for what constitutes a hard-error when\n-attempting to substitute template parameters with template arguments,\n-making most deduction errors be substitution errors; see (<a\n-href=\"http:\/\/www.open-std.org\/jtc1\/sc22\/wg21\/docs\/papers\/2008\/n2634.html\">n2634<\/a>).\n-This makes <a href=\"https:\/\/en.cppreference.com\/w\/cpp\/language\/sfinae\"\n-title=\"Substitution Failure Is Not An Error\">SFINAE<\/a> more powerful\n-and easier to use. However, the implementation complexity for this\n-change is significant, and this seems to be a place where obscure\n-corner-case bugs in various compilers can be found. So while this\n-feature can (and indeed should) be used (and would be difficult to\n-avoid), caution should be used when pushing to extremes.<\/p>\n-<p>Here are a few closely related example bugs:<br> <a\n-href=\"https:\/\/gcc.gnu.org\/bugzilla\/show_bug.cgi?id=95468\"\n-class=\"uri\">https:\/\/gcc.gnu.org\/bugzilla\/show_bug.cgi?id=95468<\/a><br>\n-<a\n-href=\"https:\/\/developercommunity.visualstudio.com\/content\/problem\/396562\/sizeof-deduced-type-is-sometimes-not-a-constant-ex.html\"\n-class=\"uri\">https:\/\/developercommunity.visualstudio.com\/content\/problem\/396562\/sizeof-deduced-type-is-sometimes-not-a-constant-ex.html<\/a><\/p>\n+<p><a href=\"https:\/\/en.cppreference.com\/w\/cpp\/language\/sfinae\" title=\"Substitution Failure Is Not An Error\">Substitution Failure Is Not An Error<\/a> (SFINAE) is a template metaprogramming technique that makes use of template parameter substitution failures to make compile-time decisions.<\/p>\n+<p>C++11 relaxed the rules for what constitutes a hard-error when attempting to substitute template parameters with template arguments, making most deduction errors be substitution errors; see (<a href=\"http:\/\/www.open-std.org\/jtc1\/sc22\/wg21\/docs\/papers\/2008\/n2634.html\">n2634<\/a>). This makes <a href=\"https:\/\/en.cppreference.com\/w\/cpp\/language\/sfinae\" title=\"Substitution Failure Is Not An Error\">SFINAE<\/a> more powerful and easier to use. However, the implementation complexity for this change is significant, and this seems to be a place where obscure corner-case bugs in various compilers can be found. So while this feature can (and indeed should) be used (and would be difficult to avoid), caution should be used when pushing to extremes.<\/p>\n+<p>Here are a few closely related example bugs:<br> <a href=\"https:\/\/gcc.gnu.org\/bugzilla\/show_bug.cgi?id=95468\" class=\"uri\">https:\/\/gcc.gnu.org\/bugzilla\/show_bug.cgi?id=95468<\/a><br> <a href=\"https:\/\/developercommunity.visualstudio.com\/content\/problem\/396562\/sizeof-deduced-type-is-sometimes-not-a-constant-ex.html\" class=\"uri\">https:\/\/developercommunity.visualstudio.com\/content\/problem\/396562\/sizeof-deduced-type-is-sometimes-not-a-constant-ex.html<\/a><\/p>\n@@ -656,17 +268,5 @@\n-<p>Where appropriate, <em>scoped-enums<\/em> should be used. (<a\n-href=\"http:\/\/www.open-std.org\/jtc1\/sc22\/wg21\/docs\/papers\/2007\/n2347.pdf\">n2347<\/a>)<\/p>\n-<p>Use of <em>unscoped-enums<\/em> is permitted, though ordinary\n-constants may be preferable when the automatic initializer feature isn't\n-used.<\/p>\n-<p>The underlying type (the <em>enum-base<\/em>) of an unscoped enum type\n-should always be specified explicitly. When unspecified, the underlying\n-type is dependent on the range of the enumerator values and the\n-platform.<\/p>\n-<p>The underlying type of a <em>scoped-enum<\/em> should also be\n-specified explicitly if conversions may be applied to values of that\n-type.<\/p>\n-<p>Due to bugs in certain (very old) compilers, there is widespread use\n-of enums and avoidance of in-class initialization of static integral\n-constant members. Compilers having such bugs are no longer supported.\n-Except where an enum is semantically appropriate, new code should use\n-integral constants.<\/p>\n+<p>Where appropriate, <em>scoped-enums<\/em> should be used. (<a href=\"http:\/\/www.open-std.org\/jtc1\/sc22\/wg21\/docs\/papers\/2007\/n2347.pdf\">n2347<\/a>)<\/p>\n+<p>Use of <em>unscoped-enums<\/em> is permitted, though ordinary constants may be preferable when the automatic initializer feature isn't used.<\/p>\n+<p>The underlying type (the <em>enum-base<\/em>) of an unscoped enum type should always be specified explicitly. When unspecified, the underlying type is dependent on the range of the enumerator values and the platform.<\/p>\n+<p>The underlying type of a <em>scoped-enum<\/em> should also be specified explicitly if conversions may be applied to values of that type.<\/p>\n+<p>Due to bugs in certain (very old) compilers, there is widespread use of enums and avoidance of in-class initialization of static integral constant members. Compilers having such bugs are no longer supported. Except where an enum is semantically appropriate, new code should use integral constants.<\/p>\n@@ -674,20 +274,2 @@\n-<p>Avoid use of <code>thread_local<\/code> (<a\n-href=\"http:\/\/www.open-std.org\/jtc1\/sc22\/wg21\/docs\/papers\/2008\/n2659.htm\">n2659<\/a>);\n-and instead, use the HotSpot macro <code>THREAD_LOCAL<\/code>, for which\n-the initializer must be a constant expression. When\n-<code>thread_local<\/code> must be used, use the Hotspot macro\n-<code>APPROVED_CPP_THREAD_LOCAL<\/code> to indicate that the use has been\n-given appropriate consideration.<\/p>\n-<p>As was discussed in the review for <a\n-href=\"https:\/\/mail.openjdk.org\/pipermail\/hotspot-dev\/2019-September\/039487.html\">JDK-8230877<\/a>,\n-<code>thread_local<\/code> allows dynamic initialization and destruction\n-semantics. However, that support requires a run-time penalty for\n-references to non-function-local <code>thread_local<\/code> variables\n-defined in a different translation unit, even if they don't need dynamic\n-initialization. Dynamic initialization and destruction of non-local\n-<code>thread_local<\/code> variables also has the same ordering problems\n-as for ordinary non-local variables. So we avoid use of\n-<code>thread_local<\/code> in general, limiting its use to only those\n-cases where dynamic initialization or destruction are essential. See <a\n-href=\"https:\/\/bugs.openjdk.org\/browse\/JDK-8282469\">JDK-8282469<\/a> for\n-further discussion.<\/p>\n+<p>Avoid use of <code>thread_local<\/code> (<a href=\"http:\/\/www.open-std.org\/jtc1\/sc22\/wg21\/docs\/papers\/2008\/n2659.htm\">n2659<\/a>); and instead, use the HotSpot macro <code>THREAD_LOCAL<\/code>, for which the initializer must be a constant expression. When <code>thread_local<\/code> must be used, use the Hotspot macro <code>APPROVED_CPP_THREAD_LOCAL<\/code> to indicate that the use has been given appropriate consideration.<\/p>\n+<p>As was discussed in the review for <a href=\"https:\/\/mail.openjdk.org\/pipermail\/hotspot-dev\/2019-September\/039487.html\">JDK-8230877<\/a>, <code>thread_local<\/code> allows dynamic initialization and destruction semantics. However, that support requires a run-time penalty for references to non-function-local <code>thread_local<\/code> variables defined in a different translation unit, even if they don't need dynamic initialization. Dynamic initialization and destruction of non-local <code>thread_local<\/code> variables also has the same ordering problems as for ordinary non-local variables. So we avoid use of <code>thread_local<\/code> in general, limiting its use to only those cases where dynamic initialization or destruction are essential. See <a href=\"https:\/\/bugs.openjdk.org\/browse\/JDK-8282469\">JDK-8282469<\/a> for further discussion.<\/p>\n@@ -695,6 +277,2 @@\n-<p>Prefer <code>nullptr<\/code> (<a\n-href=\"http:\/\/www.open-std.org\/jtc1\/sc22\/wg21\/docs\/papers\/2007\/n2431.pdf\">n2431<\/a>)\n-to <code>NULL<\/code>. Don't use (constexpr or literal) 0 for\n-pointers.<\/p>\n-<p>For historical reasons there are widespread uses of both\n-<code>NULL<\/code> and of integer 0 as a pointer value.<\/p>\n+<p>Prefer <code>nullptr<\/code> (<a href=\"http:\/\/www.open-std.org\/jtc1\/sc22\/wg21\/docs\/papers\/2007\/n2431.pdf\">n2431<\/a>) to <code>NULL<\/code>. Don't use (constexpr or literal) 0 for pointers.<\/p>\n+<p>For historical reasons there are widespread uses of both <code>NULL<\/code> and of integer 0 as a pointer value.<\/p>\n@@ -702,16 +280,3 @@\n-<p>Do not use facilities provided by the <code>&lt;atomic&gt;<\/code>\n-header (<a\n-href=\"http:\/\/www.open-std.org\/jtc1\/sc22\/wg21\/docs\/papers\/2007\/n2427.html\">n2427<\/a>),\n-(<a\n-href=\"http:\/\/www.open-std.org\/jtc1\/sc22\/wg21\/docs\/papers\/2008\/n2752.htm\">n2752<\/a>);\n-instead, use the HotSpot <code>Atomic<\/code> class and related\n-facilities.<\/p>\n-<p>Atomic operations in HotSpot code must have semantics which are\n-consistent with those provided by the JDK's compilers for Java. There\n-are platform-specific implementation choices that a C++ compiler might\n-make or change that are outside the scope of the C++ Standard, and might\n-differ from what the Java compilers implement.<\/p>\n-<p>In addition, HotSpot <code>Atomic<\/code> has a concept of\n-\"conservative\" memory ordering, which may differ from (may be stronger\n-than) sequentially consistent. There are algorithms in HotSpot that are\n-believed to rely on that ordering.<\/p>\n+<p>Do not use facilities provided by the <code>&lt;atomic&gt;<\/code> header (<a href=\"http:\/\/www.open-std.org\/jtc1\/sc22\/wg21\/docs\/papers\/2007\/n2427.html\">n2427<\/a>), (<a href=\"http:\/\/www.open-std.org\/jtc1\/sc22\/wg21\/docs\/papers\/2008\/n2752.htm\">n2752<\/a>); instead, use the HotSpot <code>Atomic<\/code> class and related facilities.<\/p>\n+<p>Atomic operations in HotSpot code must have semantics which are consistent with those provided by the JDK's compilers for Java. There are platform-specific implementation choices that a C++ compiler might make or change that are outside the scope of the C++ Standard, and might differ from what the Java compilers implement.<\/p>\n+<p>In addition, HotSpot <code>Atomic<\/code> has a concept of &quot;conservative&quot; memory ordering, which may differ from (may be stronger than) sequentially consistent. There are algorithms in HotSpot that are believed to rely on that ordering.<\/p>\n@@ -719,3 +284,1 @@\n-<p>The use of <em>uniform initialization<\/em> (<a\n-href=\"http:\/\/www.open-std.org\/jtc1\/sc22\/wg21\/docs\/papers\/2008\/n2672.htm\">n2672<\/a>),\n-also known as <em>brace initialization<\/em>, is permitted.<\/p>\n+<p>The use of <em>uniform initialization<\/em> (<a href=\"http:\/\/www.open-std.org\/jtc1\/sc22\/wg21\/docs\/papers\/2008\/n2672.htm\">n2672<\/a>), also known as <em>brace initialization<\/em>, is permitted.<\/p>\n@@ -724,14 +287,5 @@\n-<li><a\n-href=\"https:\/\/en.cppreference.com\/w\/cpp\/language\/initialization\">initialization<\/a><\/li>\n-<li><a\n-href=\"https:\/\/en.cppreference.com\/w\/cpp\/language\/value_initialization\">value\n-initialization<\/a><\/li>\n-<li><a\n-href=\"https:\/\/en.cppreference.com\/w\/cpp\/language\/direct_initialization\">direct\n-initialization<\/a><\/li>\n-<li><a\n-href=\"https:\/\/en.cppreference.com\/w\/cpp\/language\/list_initialization\">list\n-initialization<\/a><\/li>\n-<li><a\n-href=\"https:\/\/en.cppreference.com\/w\/cpp\/language\/aggregate_initialization\">aggregate\n-initialization<\/a><\/li>\n+<li><a href=\"https:\/\/en.cppreference.com\/w\/cpp\/language\/initialization\">initialization<\/a><\/li>\n+<li><a href=\"https:\/\/en.cppreference.com\/w\/cpp\/language\/value_initialization\">value initialization<\/a><\/li>\n+<li><a href=\"https:\/\/en.cppreference.com\/w\/cpp\/language\/direct_initialization\">direct initialization<\/a><\/li>\n+<li><a href=\"https:\/\/en.cppreference.com\/w\/cpp\/language\/list_initialization\">list initialization<\/a><\/li>\n+<li><a href=\"https:\/\/en.cppreference.com\/w\/cpp\/language\/aggregate_initialization\">aggregate initialization<\/a><\/li>\n@@ -739,3 +293,1 @@\n-<p>Although related, the use of <code>std::initializer_list<\/code>\n-remains forbidden, as part of the avoidance of the C++ Standard Library\n-in HotSpot code.<\/p>\n+<p>Although related, the use of <code>std::initializer_list<\/code> remains forbidden, as part of the avoidance of the C++ Standard Library in HotSpot code.<\/p>\n@@ -744,2 +296,1 @@\n-<li>Local function objects, including lambda expressions, may be\n-used.<\/li>\n+<li>Local function objects, including lambda expressions, may be used.<\/li>\n@@ -747,4 +298,2 @@\n-<li>Prefer <code>[&amp;]<\/code> as the capture list of a lambda\n-expression.<\/li>\n-<li>Return type deduction for lambda expressions is permitted, and\n-indeed encouraged.<\/li>\n+<li>Prefer <code>[&amp;]<\/code> as the capture list of a lambda expression.<\/li>\n+<li>Return type deduction for lambda expressions is permitted, and indeed encouraged.<\/li>\n@@ -755,2 +304,1 @@\n-<li>Anonymous lambda expressions should not overly clutter the enclosing\n-expression.<\/li>\n+<li>Anonymous lambda expressions should not overly clutter the enclosing expression.<\/li>\n@@ -760,13 +308,3 @@\n-<p>Single-use function objects can be defined locally within a function,\n-directly at the point of use. This is an alternative to having a\n-function or function object class defined at class or namespace\n-scope.<\/p>\n-<p>This usage was somewhat limited by C++03, which does not permit such\n-a class to be used as a template parameter. That restriction was removed\n-by C++11 (<a\n-href=\"http:\/\/www.open-std.org\/jtc1\/sc22\/wg21\/docs\/papers\/2008\/n2657.htm\">n2657<\/a>).\n-Use of this feature is permitted.<\/p>\n-<p>Many HotSpot protocols involve \"function-like\" objects that involve\n-some named member function rather than a call operator. For example, a\n-function that performs some action on all threads might be written\n-as<\/p>\n+<p>Single-use function objects can be defined locally within a function, directly at the point of use. This is an alternative to having a function or function object class defined at class or namespace scope.<\/p>\n+<p>This usage was somewhat limited by C++03, which does not permit such a class to be used as a template parameter. That restriction was removed by C++11 (<a href=\"http:\/\/www.open-std.org\/jtc1\/sc22\/wg21\/docs\/papers\/2008\/n2657.htm\">n2657<\/a>). Use of this feature is permitted.<\/p>\n+<p>Many HotSpot protocols involve &quot;function-like&quot; objects that involve some named member function rather than a call operator. For example, a function that performs some action on all threads might be written as<\/p>\n@@ -781,79 +319,17 @@\n-<p>HotSpot code has historically usually placed the DoSomething class at\n-namespace (or sometimes class) scope. This separates the function's code\n-from its use, often to the detriment of readability. It requires giving\n-the class a globally unique name (if at namespace scope). It also loses\n-the information that the class is intended for use in exactly one place,\n-and does not have any subclasses. (However, the latter can now be\n-indicated by declaring it <code>final<\/code>.) Often, for simplicity, a\n-local class will skip things like access control and accessor functions,\n-giving the enclosing function direct access to the implementation and\n-eliminating some boilerplate that might be provided if the class is in\n-some outer (more accessible) scope. On the other hand, if there is a lot\n-of surrounding code in the function body or the local class is of\n-significant size, defining it locally can increase clutter and reduce\n-readability.<\/p>\n-<p><a name=\"lambdaexpressions\"><\/a> C++11 added <em>lambda\n-expressions<\/em> as a new way to write a function object. Simple lambda\n-expressions can be significantly more concise than a function object,\n-eliminating a lot of boiler-plate. On the other hand, a complex lambda\n-expression may not provide much, if any, readability benefit compared to\n-an ordinary function object. Also, while a lambda can encapsulate a call\n-to a \"function-like\" object, it cannot be used in place of such.<\/p>\n-<p>A common use for local functions is as one-use <a\n-href=\"https:\/\/en.cppreference.com\/w\/cpp\/language\/raii\"\n-title=\"Resource Acquisition Is Initialization\">RAII<\/a> objects. The\n-amount of boilerplate for a function object class (local or not) makes\n-such usage somewhat clumsy and verbose. But with the help of a small\n-amount of supporting utility code, lambdas work particularly well for\n-this use case.<\/p>\n-<p>Another use for local functions is <a\n-href=\"https:\/\/en.wikipedia.org\/wiki\/Partial_application\"\n-title=\"Partial Application\">partial application<\/a>. Again here, lambdas\n-are typically much simpler and less verbose than function object\n-classes.<\/p>\n-<p>Because of these benefits, lambda expressions are permitted in\n-HotSpot code, with some restrictions and usage guidance. An anonymous\n-lambda is one which is passed directly as an argument. A named lambda is\n-the value of a variable, which is its name.<\/p>\n-<p>Lambda expressions should only be passed downward. In particular, a\n-lambda should not be returned from a function or stored in a global\n-variable, whether directly or as the value of a member of some other\n-object. Lambda capture is syntactically subtle (by design), and\n-propagating a lambda in such ways can easily pass references to captured\n-values to places where they are no longer valid. In particular, members\n-of the enclosing <code>this<\/code> object are effectively captured by\n-reference, even if the default capture is by-value. For such uses-cases\n-a function object class should be used to make the desired value\n-capturing and propagation explicit.<\/p>\n-<p>Limiting the capture list to <code>[&amp;]<\/code> (implicitly capture\n-by reference) is a simplifying restriction that still provides good\n-support for HotSpot usage, while reducing the cases a reader must\n-recognize and understand.<\/p>\n-<ul>\n-<li><p>Many common lambda uses require reference capture. Not permitting\n-it would substantially reduce the utility of lambdas.<\/p><\/li>\n-<li><p>Referential transparency. Implicit reference capture makes\n-variable references in the lambda body have the same meaning they would\n-have in the enclosing code. There isn't a semantic barrier across which\n-the meaning of a variable changes.<\/p><\/li>\n-<li><p>Explicit reference capture introduces significant clutter,\n-especially when lambda expressions are relatively small and simple, as\n-they should be in HotSpot code.<\/p><\/li>\n-<li><p>There are a number of reasons why by-value capture might be used,\n-but for the most part they don't apply to HotSpot code, given other\n-usage restrictions.<\/p>\n-<ul>\n-<li><p>A primary use-case for by-value capture is to support escaping\n-uses, where values captured by-reference might become invalid. That\n-use-case doesn't apply if only downward lambdas are used.<\/p><\/li>\n-<li><p>By-value capture can also make a lambda-local copy for mutation,\n-which requires making the lambda <code>mutable<\/code>; see\n-below.<\/p><\/li>\n-<li><p>By-value capture might be viewed as an optimization, avoiding any\n-overhead for reference capture of cheap to copy values. But the compiler\n-can often eliminate any such overhead.<\/p><\/li>\n-<li><p>By-value capture by a non-<code>mutable<\/code> lambda makes the\n-captured values const, preventing any modification by the lambda and\n-making the captured value unaffected by modifications to the outer\n-variable. But this only applies to captured auto variables, not member\n-variables, and is inconsistent with referential transparency.<\/p><\/li>\n+<p>HotSpot code has historically usually placed the DoSomething class at namespace (or sometimes class) scope. This separates the function's code from its use, often to the detriment of readability. It requires giving the class a globally unique name (if at namespace scope). It also loses the information that the class is intended for use in exactly one place, and does not have any subclasses. (However, the latter can now be indicated by declaring it <code>final<\/code>.) Often, for simplicity, a local class will skip things like access control and accessor functions, giving the enclosing function direct access to the implementation and eliminating some boilerplate that might be provided if the class is in some outer (more accessible) scope. On the other hand, if there is a lot of surrounding code in the function body or the local class is of significant size, defining it locally can increase clutter and reduce readability.<\/p>\n+<p><a name=\"lambdaexpressions\"><\/a> C++11 added <em>lambda expressions<\/em> as a new way to write a function object. Simple lambda expressions can be significantly more concise than a function object, eliminating a lot of boiler-plate. On the other hand, a complex lambda expression may not provide much, if any, readability benefit compared to an ordinary function object. Also, while a lambda can encapsulate a call to a &quot;function-like&quot; object, it cannot be used in place of such.<\/p>\n+<p>A common use for local functions is as one-use <a href=\"https:\/\/en.cppreference.com\/w\/cpp\/language\/raii\" title=\"Resource Acquisition Is Initialization\">RAII<\/a> objects. The amount of boilerplate for a function object class (local or not) makes such usage somewhat clumsy and verbose. But with the help of a small amount of supporting utility code, lambdas work particularly well for this use case.<\/p>\n+<p>Another use for local functions is <a href=\"https:\/\/en.wikipedia.org\/wiki\/Partial_application\" title=\"Partial Application\">partial application<\/a>. Again here, lambdas are typically much simpler and less verbose than function object classes.<\/p>\n+<p>Because of these benefits, lambda expressions are permitted in HotSpot code, with some restrictions and usage guidance. An anonymous lambda is one which is passed directly as an argument. A named lambda is the value of a variable, which is its name.<\/p>\n+<p>Lambda expressions should only be passed downward. In particular, a lambda should not be returned from a function or stored in a global variable, whether directly or as the value of a member of some other object. Lambda capture is syntactically subtle (by design), and propagating a lambda in such ways can easily pass references to captured values to places where they are no longer valid. In particular, members of the enclosing <code>this<\/code> object are effectively captured by reference, even if the default capture is by-value. For such uses-cases a function object class should be used to make the desired value capturing and propagation explicit.<\/p>\n+<p>Limiting the capture list to <code>[&amp;]<\/code> (implicitly capture by reference) is a simplifying restriction that still provides good support for HotSpot usage, while reducing the cases a reader must recognize and understand.<\/p>\n+<ul>\n+<li><p>Many common lambda uses require reference capture. Not permitting it would substantially reduce the utility of lambdas.<\/p><\/li>\n+<li><p>Referential transparency. Implicit reference capture makes variable references in the lambda body have the same meaning they would have in the enclosing code. There isn't a semantic barrier across which the meaning of a variable changes.<\/p><\/li>\n+<li><p>Explicit reference capture introduces significant clutter, especially when lambda expressions are relatively small and simple, as they should be in HotSpot code.<\/p><\/li>\n+<li><p>There are a number of reasons why by-value capture might be used, but for the most part they don't apply to HotSpot code, given other usage restrictions.<\/p>\n+<ul>\n+<li><p>A primary use-case for by-value capture is to support escaping uses, where values captured by-reference might become invalid. That use-case doesn't apply if only downward lambdas are used.<\/p><\/li>\n+<li><p>By-value capture can also make a lambda-local copy for mutation, which requires making the lambda <code>mutable<\/code>; see below.<\/p><\/li>\n+<li><p>By-value capture might be viewed as an optimization, avoiding any overhead for reference capture of cheap to copy values. But the compiler can often eliminate any such overhead.<\/p><\/li>\n+<li><p>By-value capture by a non-<code>mutable<\/code> lambda makes the captured values const, preventing any modification by the lambda and making the captured value unaffected by modifications to the outer variable. But this only applies to captured auto variables, not member variables, and is inconsistent with referential transparency.<\/p><\/li>\n@@ -861,9 +337,2 @@\n-<li><p>Non-capturing lambdas (with an empty capture list -\n-<code>[]<\/code>) have limited utility. There are cases where no captures\n-are required (pure functions, for example), but if the function is small\n-and simple then that's obvious anyway.<\/p><\/li>\n-<li><p>Capture initializers (a C++14 feature - <a\n-href=\"https:\/\/isocpp.org\/files\/papers\/N3649.html\">N3649<\/a>) are not\n-permitted. Capture initializers inherently increase the complexity of\n-the capture list, and provide little benefit over an additional in-scope\n-local variable.<\/p><\/li>\n+<li><p>Non-capturing lambdas (with an empty capture list - <code>[]<\/code>) have limited utility. There are cases where no captures are required (pure functions, for example), but if the function is small and simple then that's obvious anyway.<\/p><\/li>\n+<li><p>Capture initializers (a C++14 feature - <a href=\"https:\/\/isocpp.org\/files\/papers\/N3649.html\">N3649<\/a>) are not permitted. Capture initializers inherently increase the complexity of the capture list, and provide little benefit over an additional in-scope local variable.<\/p><\/li>\n@@ -871,12 +340,3 @@\n-<p>The use of <code>mutable<\/code> lambda expressions is forbidden\n-because there don't seem to be many, if any, good use-cases for them in\n-HotSpot. A lambda expression needs to be mutable in order to modify a\n-by-value captured value. But with only downward lambdas, such usage\n-seems likely to be rare and complicated. It is better to use a function\n-object class in any such cases that arise, rather than requiring all\n-HotSpot developers to understand this relatively obscure feature.<\/p>\n-<p>While it is possible to directly invoke an anonymous lambda\n-expression, that feature should not be used, as such a form can be\n-confusing to readers. Instead, name the lambda and call it by name.<\/p>\n-<p>Some reasons to prefer a named lambda instead of an anonymous lambda\n-are<\/p>\n+<p>The use of <code>mutable<\/code> lambda expressions is forbidden because there don't seem to be many, if any, good use-cases for them in HotSpot. A lambda expression needs to be mutable in order to modify a by-value captured value. But with only downward lambdas, such usage seems likely to be rare and complicated. It is better to use a function object class in any such cases that arise, rather than requiring all HotSpot developers to understand this relatively obscure feature.<\/p>\n+<p>While it is possible to directly invoke an anonymous lambda expression, that feature should not be used, as such a form can be confusing to readers. Instead, name the lambda and call it by name.<\/p>\n+<p>Some reasons to prefer a named lambda instead of an anonymous lambda are<\/p>\n@@ -884,5 +344,2 @@\n-<li><p>The body contains non-trivial control flow or declarations or\n-other nested constructs.<\/p><\/li>\n-<li><p>Its role in an argument list is hard to guess without examining\n-the function declaration. Give it a name that indicates its\n-purpose.<\/p><\/li>\n+<li><p>The body contains non-trivial control flow or declarations or other nested constructs.<\/p><\/li>\n+<li><p>Its role in an argument list is hard to guess without examining the function declaration. Give it a name that indicates its purpose.<\/p><\/li>\n@@ -890,2 +347,1 @@\n-<li><p>It has a complex explicit return type or parameter\n-types.<\/p><\/li>\n+<li><p>It has a complex explicit return type or parameter types.<\/p><\/li>\n@@ -893,13 +349,2 @@\n-<p>Lambda expressions, and particularly anonymous lambda expressions,\n-should be simple and compact. One-liners are good. Anonymous lambdas\n-should usually be limited to a couple lines of body code. More complex\n-lambdas should be named. A named lambda should not clutter the enclosing\n-function and make it long and complex; do continue to break up large\n-functions via the use of separate helper functions.<\/p>\n-<p>An anonymous lambda expression should either be a one-liner in a\n-one-line expression, or isolated in its own set of lines. Don't place\n-part of a lambda expression on the same line as other arguments to a\n-function. The body of a multi-line lambda argument should be indented\n-from the start of the capture list, as if that were the start of an\n-ordinary function definition. The body of a multi-line named lambda\n-should be indented one step from the variable's indentation.<\/p>\n+<p>Lambda expressions, and particularly anonymous lambda expressions, should be simple and compact. One-liners are good. Anonymous lambdas should usually be limited to a couple lines of body code. More complex lambdas should be named. A named lambda should not clutter the enclosing function and make it long and complex; do continue to break up large functions via the use of separate helper functions.<\/p>\n+<p>An anonymous lambda expression should either be a one-liner in a one-line expression, or isolated in its own set of lines. Don't place part of a lambda expression on the same line as other arguments to a function. The body of a multi-line lambda argument should be indented from the start of the capture list, as if that were the start of an ordinary function definition. The body of a multi-line named lambda should be indented one step from the variable's indentation.<\/p>\n@@ -908,4 +353,4 @@\n-<li><p><code>foo([&amp;] { ++counter; });<\/code><\/p><\/li>\n-<li><p><code>foo(x, [&amp;] { ++counter; });<\/code><\/p><\/li>\n-<li><p><code>foo([&amp;] { if (predicate) ++counter; });<\/code><\/p><\/li>\n-<li><p><code>foo([&amp;] { auto tmp = process(x); tmp.f(); return tmp.g(); })<\/code><\/p><\/li>\n+<li><code>foo([&amp;] { ++counter; });<\/code><\/li>\n+<li><code>foo(x, [&amp;] { ++counter; });<\/code><\/li>\n+<li><code>foo([&amp;] { if (predicate) ++counter; });<\/code><\/li>\n+<li><code>foo([&amp;] { auto tmp = process(x); tmp.f(); return tmp.g(); })<\/code><\/li>\n@@ -935,3 +380,1 @@\n-<p>Item 4, and especially items 6 and 7, are pushing the simplicity\n-limits for anonymous lambdas. Item 6 might be better written using a\n-named lambda:<\/p>\n+<p>Item 4, and especially items 6 and 7, are pushing the simplicity limits for anonymous lambdas. Item 6 might be better written using a named lambda:<\/p>\n@@ -939,8 +382,1 @@\n-<p>Note that C++11 also added <em>bind expressions<\/em> as a way to\n-write a function object for partial application, using\n-<code>std::bind<\/code> and related facilities from the Standard Library.\n-<code>std::bind<\/code> generalizes and replaces some of the binders from\n-C++03. Bind expressions are not permitted in HotSpot code. They don't\n-provide enough benefit over lambdas or local function classes in the\n-cases where bind expressions are applicable to warrant the introduction\n-of yet another mechanism in this space into HotSpot code.<\/p>\n+<p>Note that C++11 also added <em>bind expressions<\/em> as a way to write a function object for partial application, using <code>std::bind<\/code> and related facilities from the Standard Library. <code>std::bind<\/code> generalizes and replaces some of the binders from C++03. Bind expressions are not permitted in HotSpot code. They don't provide enough benefit over lambdas or local function classes in the cases where bind expressions are applicable to warrant the introduction of yet another mechanism in this space into HotSpot code.<\/p>\n@@ -949,8 +385,4 @@\n-<li>Local and unnamed types as template parameters (<a\n-href=\"http:\/\/www.open-std.org\/jtc1\/sc22\/wg21\/docs\/papers\/2008\/n2657.htm\">n2657<\/a>)<\/li>\n-<li>New wording for C++0x lambdas (<a\n-href=\"http:\/\/www.open-std.org\/jtc1\/sc22\/wg21\/docs\/papers\/2009\/n2927.pdf\">n2927<\/a>)<\/li>\n-<li>Generalized lambda capture (init-capture) (<a\n-href=\"https:\/\/isocpp.org\/files\/papers\/N3648.html\">N3648<\/a>)<\/li>\n-<li>Generic (polymorphic) lambda expressions (<a\n-href=\"https:\/\/isocpp.org\/files\/papers\/N3649.html\">N3649<\/a>)<\/li>\n+<li>Local and unnamed types as template parameters (<a href=\"http:\/\/www.open-std.org\/jtc1\/sc22\/wg21\/docs\/papers\/2008\/n2657.htm\">n2657<\/a>)<\/li>\n+<li>New wording for C++0x lambdas (<a href=\"http:\/\/www.open-std.org\/jtc1\/sc22\/wg21\/docs\/papers\/2009\/n2927.pdf\">n2927<\/a>)<\/li>\n+<li>Generalized lambda capture (init-capture) (<a href=\"https:\/\/isocpp.org\/files\/papers\/N3648.html\">N3648<\/a>)<\/li>\n+<li>Generic (polymorphic) lambda expressions (<a href=\"https:\/\/isocpp.org\/files\/papers\/N3649.html\">N3649<\/a>)<\/li>\n@@ -960,4 +392,2 @@\n-<li>Wording for constexpr lambda (<a\n-href=\"http:\/\/www.open-std.org\/jtc1\/sc22\/wg21\/docs\/papers\/2016\/p0170r1.pdf\">p0170r1<\/a>)<\/li>\n-<li>Lambda capture of *this by Value (<a\n-href=\"http:\/\/www.open-std.org\/jtc1\/sc22\/wg21\/docs\/papers\/2016\/p0018r3.html\">p0018r3<\/a>)<\/li>\n+<li>Wording for constexpr lambda (<a href=\"http:\/\/www.open-std.org\/jtc1\/sc22\/wg21\/docs\/papers\/2016\/p0170r1.pdf\">p0170r1<\/a>)<\/li>\n+<li>Lambda capture of *this by Value (<a href=\"http:\/\/www.open-std.org\/jtc1\/sc22\/wg21\/docs\/papers\/2016\/p0018r3.html\">p0018r3<\/a>)<\/li>\n@@ -967,16 +397,7 @@\n-<li>Allow lambda capture [=, this] (<a\n-href=\"http:\/\/www.open-std.org\/jtc1\/sc22\/wg21\/docs\/papers\/2017\/p0409r2.html\">p0409r2<\/a>)<\/li>\n-<li>Familiar template syntax for generic lambdas (<a\n-href=\"http:\/\/www.open-std.org\/jtc1\/sc22\/wg21\/docs\/papers\/2017\/p0428r2.pdf\">p0428r2<\/a>)<\/li>\n-<li>Simplifying implicit lambda capture (<a\n-href=\"http:\/\/www.open-std.org\/jtc1\/sc22\/wg21\/docs\/papers\/2017\/p0588r1.html\">p0588r1<\/a>)<\/li>\n-<li>Default constructible and assignable stateless lambdas (<a\n-href=\"http:\/\/www.open-std.org\/jtc1\/sc22\/wg21\/docs\/papers\/2017\/p0624r2.pdf\">p0624r2<\/a>)<\/li>\n-<li>Lambdas in unevaluated contexts (<a\n-href=\"http:\/\/www.open-std.org\/jtc1\/sc22\/wg21\/docs\/papers\/2017\/p0315r4.pdf\">p0315r4<\/a>)<\/li>\n-<li>Allow pack expansion in lambda init-capture (<a\n-href=\"http:\/\/www.open-std.org\/jtc1\/sc22\/wg21\/docs\/papers\/2018\/p0780r2.html\">p0780r2<\/a>)\n-(<a\n-href=\"http:\/\/www.open-std.org\/jtc1\/sc22\/wg21\/docs\/papers\/2020\/p2095r0.html\">p2095r0<\/a>)<\/li>\n-<li>Deprecate implicit capture of this via [=] (<a\n-href=\"http:\/\/www.open-std.org\/jtc1\/sc22\/wg21\/docs\/papers\/2018\/p0806r2.html\">p0806r2<\/a>)<\/li>\n+<li>Allow lambda capture [=, this] (<a href=\"http:\/\/www.open-std.org\/jtc1\/sc22\/wg21\/docs\/papers\/2017\/p0409r2.html\">p0409r2<\/a>)<\/li>\n+<li>Familiar template syntax for generic lambdas (<a href=\"http:\/\/www.open-std.org\/jtc1\/sc22\/wg21\/docs\/papers\/2017\/p0428r2.pdf\">p0428r2<\/a>)<\/li>\n+<li>Simplifying implicit lambda capture (<a href=\"http:\/\/www.open-std.org\/jtc1\/sc22\/wg21\/docs\/papers\/2017\/p0588r1.html\">p0588r1<\/a>)<\/li>\n+<li>Default constructible and assignable stateless lambdas (<a href=\"http:\/\/www.open-std.org\/jtc1\/sc22\/wg21\/docs\/papers\/2017\/p0624r2.pdf\">p0624r2<\/a>)<\/li>\n+<li>Lambdas in unevaluated contexts (<a href=\"http:\/\/www.open-std.org\/jtc1\/sc22\/wg21\/docs\/papers\/2017\/p0315r4.pdf\">p0315r4<\/a>)<\/li>\n+<li>Allow pack expansion in lambda init-capture (<a href=\"http:\/\/www.open-std.org\/jtc1\/sc22\/wg21\/docs\/papers\/2018\/p0780r2.html\">p0780r2<\/a>) (<a href=\"http:\/\/www.open-std.org\/jtc1\/sc22\/wg21\/docs\/papers\/2020\/p2095r0.html\">p2095r0<\/a>)<\/li>\n+<li>Deprecate implicit capture of this via [=] (<a href=\"http:\/\/www.open-std.org\/jtc1\/sc22\/wg21\/docs\/papers\/2018\/p0806r2.html\">p0806r2<\/a>)<\/li>\n@@ -986,2 +407,1 @@\n-<li>Make () more optional for lambdas (<a\n-href=\"http:\/\/www.open-std.org\/jtc1\/sc22\/wg21\/docs\/papers\/2020\/p1102r2.html\">p1102r2<\/a>)<\/li>\n+<li>Make () more optional for lambdas (<a href=\"http:\/\/www.open-std.org\/jtc1\/sc22\/wg21\/docs\/papers\/2020\/p1102r2.html\">p1102r2<\/a>)<\/li>\n@@ -990,78 +410,22 @@\n-<p>Do not use <em>inheriting constructors<\/em> (<a\n-href=\"http:\/\/www.open-std.org\/jtc1\/sc22\/wg21\/docs\/papers\/2008\/n2540.htm\">n2540<\/a>).<\/p>\n-<p>C++11 provides simple syntax allowing a class to inherit the\n-constructors of a base class. Unfortunately there are a number of\n-problems with the original specification, and C++17 contains significant\n-revisions (<a\n-href=\"http:\/\/www.open-std.org\/jtc1\/sc22\/wg21\/docs\/papers\/2015\/p0136r1.html\"\n-title=\"p0136r1\">p0136r1<\/a> opens with a list of 8 Core Issues). Since\n-HotSpot doesn't support use of C++17, use of inherited constructors\n-could run into those problems. Such uses might also change behavior in a\n-future HotSpot update to use C++17 or later, potentially in subtle ways\n-that could lead to hard to diagnose problems. Because of this, HotSpot\n-code must not use inherited constructors.<\/p>\n-<p>Note that gcc7 provides the <code>-fnew-inheriting-ctors<\/code>\n-option to use the <a\n-href=\"http:\/\/www.open-std.org\/jtc1\/sc22\/wg21\/docs\/papers\/2015\/p0136r1.html\"\n-title=\"p0136r1\">p0136r1<\/a> semantics. This is enabled by default when\n-using C++17 or later. It is also enabled by default for\n-<code>fabi-version=11<\/code> (introduced by gcc7) or higher when using\n-C++11\/14, as the change is considered a Defect Report that applies to\n-those versions. Earlier versions of gcc don't have that option, and\n-other supported compilers may not have anything similar.<\/p>\n-<h3 id=\"additional-permitted-features\">Additional Permitted\n-Features<\/h3>\n-<ul>\n-<li><p><code>constexpr<\/code> (<a\n-href=\"http:\/\/www.open-std.org\/jtc1\/sc22\/wg21\/docs\/papers\/2007\/n2235.pdf\">n2235<\/a>)\n-(<a\n-href=\"https:\/\/isocpp.org\/files\/papers\/N3652.html\">n3652<\/a>)<\/p><\/li>\n-<li><p>Sized deallocation (<a\n-href=\"https:\/\/isocpp.org\/files\/papers\/n3778.html\">n3778<\/a>)<\/p><\/li>\n-<li><p>Variadic templates (<a\n-href=\"http:\/\/www.open-std.org\/jtc1\/sc22\/wg21\/docs\/papers\/2007\/n2242.pdf\">n2242<\/a>)\n-(<a\n-href=\"http:\/\/www.open-std.org\/jtc1\/sc22\/wg21\/docs\/papers\/2008\/n2555.pdf\">n2555<\/a>)<\/p><\/li>\n-<li><p>Static assertions (<a\n-href=\"http:\/\/www.open-std.org\/jtc1\/sc22\/wg21\/docs\/papers\/2004\/n1720.html\">n1720<\/a>)<\/p><\/li>\n-<li><p><code>decltype<\/code> (<a\n-href=\"http:\/\/www.open-std.org\/jtc1\/sc22\/wg21\/docs\/papers\/2007\/n2343.pdf\">n2343<\/a>)\n-(<a\n-href=\"http:\/\/www.open-std.org\/jtc1\/sc22\/wg21\/docs\/papers\/2011\/n3276.pdf\">n3276<\/a>)<\/p><\/li>\n-<li><p>Right angle brackets (<a\n-href=\"http:\/\/www.open-std.org\/jtc1\/sc22\/wg21\/docs\/papers\/2005\/n1757.html\">n1757<\/a>)<\/p><\/li>\n-<li><p>Default template arguments for function templates (<a\n-href=\"http:\/\/www.open-std.org\/jtc1\/sc22\/wg21\/docs\/cwg_defects.html#226\">CWG\n-D226<\/a>)<\/p><\/li>\n-<li><p>Template aliases (<a\n-href=\"http:\/\/www.open-std.org\/jtc1\/sc22\/wg21\/docs\/papers\/2007\/n2258.pdf\">n2258<\/a>)<\/p><\/li>\n-<li><p>Delegating constructors (<a\n-href=\"http:\/\/www.open-std.org\/jtc1\/sc22\/wg21\/docs\/papers\/2006\/n1986.pdf\">n1986<\/a>)<\/p><\/li>\n-<li><p>Explicit conversion operators (<a\n-href=\"http:\/\/www.open-std.org\/jtc1\/sc22\/wg21\/docs\/papers\/2007\/n2437.pdf\">n2437<\/a>)<\/p><\/li>\n-<li><p>Standard Layout Types (<a\n-href=\"http:\/\/www.open-std.org\/jtc1\/sc22\/wg21\/docs\/papers\/2007\/n2342.htm\">n2342<\/a>)<\/p><\/li>\n-<li><p>Defaulted and deleted functions (<a\n-href=\"http:\/\/www.open-std.org\/jtc1\/sc22\/wg21\/docs\/papers\/2007\/n2346.htm\">n2346<\/a>)<\/p><\/li>\n-<li><p>Dynamic initialization and destruction with concurrency (<a\n-href=\"http:\/\/www.open-std.org\/jtc1\/sc22\/wg21\/docs\/papers\/2008\/n2660.htm\">n2660<\/a>)<\/p><\/li>\n-<li><p><code>final<\/code> virtual specifiers for classes and virtual\n-functions (<a\n-href=\"http:\/\/www.open-std.org\/JTC1\/SC22\/WG21\/docs\/papers\/2009\/n2928.htm\">n2928<\/a>),\n-(<a\n-href=\"http:\/\/www.open-std.org\/jtc1\/sc22\/wg21\/docs\/papers\/2010\/n3206.htm\">n3206<\/a>),\n-(<a\n-href=\"http:\/\/www.open-std.org\/jtc1\/sc22\/wg21\/docs\/papers\/2011\/n3272.htm\">n3272<\/a>)<\/p><\/li>\n-<li><p><code>override<\/code> virtual specifiers for virtual functions\n-(<a\n-href=\"http:\/\/www.open-std.org\/JTC1\/SC22\/WG21\/docs\/papers\/2009\/n2928.htm\">n2928<\/a>),\n-(<a\n-href=\"http:\/\/www.open-std.org\/jtc1\/sc22\/wg21\/docs\/papers\/2010\/n3206.htm\">n3206<\/a>),\n-(<a\n-href=\"http:\/\/www.open-std.org\/jtc1\/sc22\/wg21\/docs\/papers\/2011\/n3272.htm\">n3272<\/a>)<\/p><\/li>\n-<li><p>Range-based <code>for<\/code> loops (<a\n-href=\"http:\/\/www.open-std.org\/JTC1\/SC22\/WG21\/docs\/papers\/2009\/n2930.html\">n2930<\/a>)\n-(<a\n-href=\"https:\/\/en.cppreference.com\/w\/cpp\/language\/range-for\">range-for<\/a>)<\/p><\/li>\n-<li><p>Unrestricted Unions (<a\n-href=\"http:\/\/www.open-std.org\/jtc1\/sc22\/wg21\/docs\/papers\/2008\/n2544.pdf\">n2544<\/a>)<\/p><\/li>\n+<p>Do not use <em>inheriting constructors<\/em> (<a href=\"http:\/\/www.open-std.org\/jtc1\/sc22\/wg21\/docs\/papers\/2008\/n2540.htm\">n2540<\/a>).<\/p>\n+<p>C++11 provides simple syntax allowing a class to inherit the constructors of a base class. Unfortunately there are a number of problems with the original specification, and C++17 contains significant revisions (<a href=\"http:\/\/www.open-std.org\/jtc1\/sc22\/wg21\/docs\/papers\/2015\/p0136r1.html\" title=\"p0136r1\">p0136r1<\/a> opens with a list of 8 Core Issues). Since HotSpot doesn't support use of C++17, use of inherited constructors could run into those problems. Such uses might also change behavior in a future HotSpot update to use C++17 or later, potentially in subtle ways that could lead to hard to diagnose problems. Because of this, HotSpot code must not use inherited constructors.<\/p>\n+<p>Note that gcc7 provides the <code>-fnew-inheriting-ctors<\/code> option to use the <a href=\"http:\/\/www.open-std.org\/jtc1\/sc22\/wg21\/docs\/papers\/2015\/p0136r1.html\" title=\"p0136r1\">p0136r1<\/a> semantics. This is enabled by default when using C++17 or later. It is also enabled by default for <code>fabi-version=11<\/code> (introduced by gcc7) or higher when using C++11\/14, as the change is considered a Defect Report that applies to those versions. Earlier versions of gcc don't have that option, and other supported compilers may not have anything similar.<\/p>\n+<h3 id=\"additional-permitted-features\">Additional Permitted Features<\/h3>\n+<ul>\n+<li><p><code>constexpr<\/code> (<a href=\"http:\/\/www.open-std.org\/jtc1\/sc22\/wg21\/docs\/papers\/2007\/n2235.pdf\">n2235<\/a>) (<a href=\"https:\/\/isocpp.org\/files\/papers\/N3652.html\">n3652<\/a>)<\/p><\/li>\n+<li><p>Sized deallocation (<a href=\"https:\/\/isocpp.org\/files\/papers\/n3778.html\">n3778<\/a>)<\/p><\/li>\n+<li><p>Variadic templates (<a href=\"http:\/\/www.open-std.org\/jtc1\/sc22\/wg21\/docs\/papers\/2007\/n2242.pdf\">n2242<\/a>) (<a href=\"http:\/\/www.open-std.org\/jtc1\/sc22\/wg21\/docs\/papers\/2008\/n2555.pdf\">n2555<\/a>)<\/p><\/li>\n+<li><p>Static assertions (<a href=\"http:\/\/www.open-std.org\/jtc1\/sc22\/wg21\/docs\/papers\/2004\/n1720.html\">n1720<\/a>)<\/p><\/li>\n+<li><p><code>decltype<\/code> (<a href=\"http:\/\/www.open-std.org\/jtc1\/sc22\/wg21\/docs\/papers\/2007\/n2343.pdf\">n2343<\/a>) (<a href=\"http:\/\/www.open-std.org\/jtc1\/sc22\/wg21\/docs\/papers\/2011\/n3276.pdf\">n3276<\/a>)<\/p><\/li>\n+<li><p>Right angle brackets (<a href=\"http:\/\/www.open-std.org\/jtc1\/sc22\/wg21\/docs\/papers\/2005\/n1757.html\">n1757<\/a>)<\/p><\/li>\n+<li><p>Default template arguments for function templates (<a href=\"http:\/\/www.open-std.org\/jtc1\/sc22\/wg21\/docs\/cwg_defects.html#226\">CWG D226<\/a>)<\/p><\/li>\n+<li><p>Template aliases (<a href=\"http:\/\/www.open-std.org\/jtc1\/sc22\/wg21\/docs\/papers\/2007\/n2258.pdf\">n2258<\/a>)<\/p><\/li>\n+<li><p>Delegating constructors (<a href=\"http:\/\/www.open-std.org\/jtc1\/sc22\/wg21\/docs\/papers\/2006\/n1986.pdf\">n1986<\/a>)<\/p><\/li>\n+<li><p>Explicit conversion operators (<a href=\"http:\/\/www.open-std.org\/jtc1\/sc22\/wg21\/docs\/papers\/2007\/n2437.pdf\">n2437<\/a>)<\/p><\/li>\n+<li><p>Standard Layout Types (<a href=\"http:\/\/www.open-std.org\/jtc1\/sc22\/wg21\/docs\/papers\/2007\/n2342.htm\">n2342<\/a>)<\/p><\/li>\n+<li><p>Defaulted and deleted functions (<a href=\"http:\/\/www.open-std.org\/jtc1\/sc22\/wg21\/docs\/papers\/2007\/n2346.htm\">n2346<\/a>)<\/p><\/li>\n+<li><p>Dynamic initialization and destruction with concurrency (<a href=\"http:\/\/www.open-std.org\/jtc1\/sc22\/wg21\/docs\/papers\/2008\/n2660.htm\">n2660<\/a>)<\/p><\/li>\n+<li><p><code>final<\/code> virtual specifiers for classes and virtual functions (<a href=\"http:\/\/www.open-std.org\/JTC1\/SC22\/WG21\/docs\/papers\/2009\/n2928.htm\">n2928<\/a>), (<a href=\"http:\/\/www.open-std.org\/jtc1\/sc22\/wg21\/docs\/papers\/2010\/n3206.htm\">n3206<\/a>), (<a href=\"http:\/\/www.open-std.org\/jtc1\/sc22\/wg21\/docs\/papers\/2011\/n3272.htm\">n3272<\/a>)<\/p><\/li>\n+<li><p><code>override<\/code> virtual specifiers for virtual functions (<a href=\"http:\/\/www.open-std.org\/JTC1\/SC22\/WG21\/docs\/papers\/2009\/n2928.htm\">n2928<\/a>), (<a href=\"http:\/\/www.open-std.org\/jtc1\/sc22\/wg21\/docs\/papers\/2010\/n3206.htm\">n3206<\/a>), (<a href=\"http:\/\/www.open-std.org\/jtc1\/sc22\/wg21\/docs\/papers\/2011\/n3272.htm\">n3272<\/a>)<\/p><\/li>\n+<li><p>Range-based <code>for<\/code> loops (<a href=\"http:\/\/www.open-std.org\/JTC1\/SC22\/WG21\/docs\/papers\/2009\/n2930.html\">n2930<\/a>) (<a href=\"https:\/\/en.cppreference.com\/w\/cpp\/language\/range-for\">range-for<\/a>)<\/p><\/li>\n+<li><p>Unrestricted Unions (<a href=\"http:\/\/www.open-std.org\/jtc1\/sc22\/wg21\/docs\/papers\/2008\/n2544.pdf\">n2544<\/a>)<\/p><\/li>\n@@ -1071,1 +435,1 @@\n-<li><p>New string and character literals<\/p>\n+<li>New string and character literals\n@@ -1073,8 +437,4 @@\n-<li>New character types (<a\n-href=\"http:\/\/www.open-std.org\/jtc1\/sc22\/wg21\/docs\/papers\/2007\/n2249.html\">n2249<\/a>)<\/li>\n-<li>Unicode string literals (<a\n-href=\"http:\/\/www.open-std.org\/jtc1\/sc22\/wg21\/docs\/papers\/2007\/n2442.htm\">n2442<\/a>)<\/li>\n-<li>Raw string literals (<a\n-href=\"http:\/\/www.open-std.org\/jtc1\/sc22\/wg21\/docs\/papers\/2007\/n2442.htm\">n2442<\/a>)<\/li>\n-<li>Universal character name literals (<a\n-href=\"http:\/\/www.open-std.org\/jtc1\/sc22\/wg21\/docs\/papers\/2007\/n2170.html\">n2170<\/a>)<\/li>\n+<li>New character types (<a href=\"http:\/\/www.open-std.org\/jtc1\/sc22\/wg21\/docs\/papers\/2007\/n2249.html\">n2249<\/a>)<\/li>\n+<li>Unicode string literals (<a href=\"http:\/\/www.open-std.org\/jtc1\/sc22\/wg21\/docs\/papers\/2007\/n2442.htm\">n2442<\/a>)<\/li>\n+<li>Raw string literals (<a href=\"http:\/\/www.open-std.org\/jtc1\/sc22\/wg21\/docs\/papers\/2007\/n2442.htm\">n2442<\/a>)<\/li>\n+<li>Universal character name literals (<a href=\"http:\/\/www.open-std.org\/jtc1\/sc22\/wg21\/docs\/papers\/2007\/n2170.html\">n2170<\/a>)<\/li>\n@@ -1082,32 +442,9 @@\n-<p>HotSpot doesn't need any of the new character and string literal\n-types.<\/p><\/li>\n-<li><p>User-defined literals (<a\n-href=\"http:\/\/www.open-std.org\/jtc1\/sc22\/wg21\/docs\/papers\/2008\/n2765.pdf\">n2765<\/a>)\n-— User-defined literals should not be added casually, but only through a\n-proposal to add a specific UDL.<\/p><\/li>\n-<li><p>Inline namespaces (<a\n-href=\"http:\/\/www.open-std.org\/jtc1\/sc22\/wg21\/docs\/papers\/2008\/n2535.htm\">n2535<\/a>)\n-— HotSpot makes very limited use of namespaces.<\/p><\/li>\n-<li><p><code>using namespace<\/code> directives. In particular, don't use\n-<code>using namespace std;<\/code> to avoid needing to qualify Standard\n-Library names.<\/p><\/li>\n-<li><p>Propagating exceptions (<a\n-href=\"http:\/\/www.open-std.org\/jtc1\/sc22\/wg21\/docs\/papers\/2007\/n2179.html\">n2179<\/a>)\n-— HotSpot does not permit the use of exceptions, so this feature isn't\n-useful.<\/p><\/li>\n-<li><p>Avoid non-local variables with non-constexpr initialization. In\n-particular, avoid variables with types requiring non-trivial\n-initialization or destruction. Initialization order problems can be\n-difficult to deal with and lead to surprises, as can destruction\n-ordering. HotSpot doesn't generally try to cleanup on exit, and running\n-destructors at exit can also lead to problems.<\/p><\/li>\n-<li><p><code>[[deprecated]]<\/code> attribute (<a\n-href=\"http:\/\/www.open-std.org\/jtc1\/sc22\/wg21\/docs\/papers\/2013\/n3760.html\">n3760<\/a>)\n-— Not relevant in HotSpot code.<\/p><\/li>\n-<li><p>Avoid most operator overloading, preferring named functions. When\n-operator overloading is used, ensure the semantics conform to the normal\n-expected behavior of the operation.<\/p><\/li>\n-<li><p>Avoid most implicit conversion constructors and (implicit or\n-explicit) conversion operators. (Note that conversion to\n-<code>bool<\/code> isn't needed in HotSpot code because of the \"no\n-implicit boolean\" guideline.)<\/p><\/li>\n+<p>HotSpot doesn't need any of the new character and string literal types.<\/p><\/li>\n+<li><p>User-defined literals (<a href=\"http:\/\/www.open-std.org\/jtc1\/sc22\/wg21\/docs\/papers\/2008\/n2765.pdf\">n2765<\/a>) — User-defined literals should not be added casually, but only through a proposal to add a specific UDL.<\/p><\/li>\n+<li><p>Inline namespaces (<a href=\"http:\/\/www.open-std.org\/jtc1\/sc22\/wg21\/docs\/papers\/2008\/n2535.htm\">n2535<\/a>) — HotSpot makes very limited use of namespaces.<\/p><\/li>\n+<li><p><code>using namespace<\/code> directives. In particular, don't use <code>using namespace std;<\/code> to avoid needing to qualify Standard Library names.<\/p><\/li>\n+<li><p>Propagating exceptions (<a href=\"http:\/\/www.open-std.org\/jtc1\/sc22\/wg21\/docs\/papers\/2007\/n2179.html\">n2179<\/a>) — HotSpot does not permit the use of exceptions, so this feature isn't useful.<\/p><\/li>\n+<li><p>Avoid non-local variables with non-constexpr initialization. In particular, avoid variables with types requiring non-trivial initialization or destruction. Initialization order problems can be difficult to deal with and lead to surprises, as can destruction ordering. HotSpot doesn't generally try to cleanup on exit, and running destructors at exit can also lead to problems.<\/p><\/li>\n+<li><p><code>[[deprecated]]<\/code> attribute (<a href=\"http:\/\/www.open-std.org\/jtc1\/sc22\/wg21\/docs\/papers\/2013\/n3760.html\">n3760<\/a>) — Not relevant in HotSpot code.<\/p><\/li>\n+<li><p>Avoid most operator overloading, preferring named functions. When operator overloading is used, ensure the semantics conform to the normal expected behavior of the operation.<\/p><\/li>\n+<li><p>Avoid most implicit conversion constructors and (implicit or explicit) conversion operators. (Note that conversion to <code>bool<\/code> isn't needed in HotSpot code because of the &quot;no implicit boolean&quot; guideline.)<\/p><\/li>\n@@ -1117,2 +454,1 @@\n-<p>This list is incomplete; it serves to explicitly call out some\n-features that have not yet been discussed.<\/p>\n+<p>This list is incomplete; it serves to explicitly call out some features that have not yet been discussed.<\/p>\n@@ -1120,8 +456,4 @@\n-<li><p>Trailing return type syntax for functions (<a\n-href=\"http:\/\/www.open-std.org\/jtc1\/sc22\/wg21\/docs\/papers\/2008\/n2541.htm\">n2541<\/a>)<\/p><\/li>\n-<li><p>Variable templates (<a\n-href=\"https:\/\/isocpp.org\/files\/papers\/N3651.pdf\">n3651<\/a>)<\/p><\/li>\n-<li><p>Member initializers and aggregates (<a\n-href=\"http:\/\/www.open-std.org\/jtc1\/sc22\/wg21\/docs\/papers\/2013\/n3653.html\">n3653<\/a>)<\/p><\/li>\n-<li><p><code>[[noreturn]]<\/code> attribute (<a\n-href=\"http:\/\/www.open-std.org\/jtc1\/sc22\/wg21\/docs\/papers\/2008\/n2761.pdf\">n2761<\/a>)<\/p><\/li>\n+<li><p>Trailing return type syntax for functions (<a href=\"http:\/\/www.open-std.org\/jtc1\/sc22\/wg21\/docs\/papers\/2008\/n2541.htm\">n2541<\/a>)<\/p><\/li>\n+<li><p>Variable templates (<a href=\"https:\/\/isocpp.org\/files\/papers\/N3651.pdf\">n3651<\/a>)<\/p><\/li>\n+<li><p>Member initializers and aggregates (<a href=\"http:\/\/www.open-std.org\/jtc1\/sc22\/wg21\/docs\/papers\/2013\/n3653.html\">n3653<\/a>)<\/p><\/li>\n+<li><p><code>[[noreturn]]<\/code> attribute (<a href=\"http:\/\/www.open-std.org\/jtc1\/sc22\/wg21\/docs\/papers\/2008\/n2761.pdf\">n2761<\/a>)<\/p><\/li>\n","filename":"doc\/hotspot-style.html","additions":286,"deletions":954,"binary":false,"changes":1240,"status":"modified"},{"patch":"@@ -8,13 +8,5 @@\n-  <style>\n-    code{white-space: pre-wrap;}\n-    span.smallcaps{font-variant: small-caps;}\n-    div.columns{display: flex; gap: min(4vw, 1.5em);}\n-    div.column{flex: auto; overflow-x: auto;}\n-    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}\n-    ul.task-list{list-style: none;}\n-    ul.task-list li input[type=\"checkbox\"] {\n-      width: 0.8em;\n-      margin: 0 0.8em 0.2em -1.6em;\n-      vertical-align: middle;\n-    }\n-    .display.math{display: block; text-align: center; margin: 0.5rem auto;}\n+  <style type=\"text\/css\">\n+      code{white-space: pre-wrap;}\n+      span.smallcaps{font-variant: small-caps;}\n+      span.underline{text-decoration: underline;}\n+      div.column{display: inline-block; vertical-align: top; width: 50%;}\n@@ -31,1 +23,1 @@\n-<nav id=\"TOC\" role=\"doc-toc\">\n+<nav id=\"TOC\">\n@@ -33,16 +25,8 @@\n-<li><a href=\"#good-test-properties\" id=\"toc-good-test-properties\">Good\n-test properties<\/a>\n-<ul>\n-<li><a href=\"#lightness\" id=\"toc-lightness\">Lightness<\/a><\/li>\n-<li><a href=\"#isolation\" id=\"toc-isolation\">Isolation<\/a><\/li>\n-<li><a href=\"#atomicity-and-self-containment\"\n-id=\"toc-atomicity-and-self-containment\">Atomicity and\n-self-containment<\/a><\/li>\n-<li><a href=\"#repeatability\"\n-id=\"toc-repeatability\">Repeatability<\/a><\/li>\n-<li><a href=\"#informativeness\"\n-id=\"toc-informativeness\">Informativeness<\/a><\/li>\n-<li><a href=\"#testing-instead-of-visiting\"\n-id=\"toc-testing-instead-of-visiting\">Testing instead of\n-visiting<\/a><\/li>\n-<li><a href=\"#nearness\" id=\"toc-nearness\">Nearness<\/a><\/li>\n+<li><a href=\"#good-test-properties\">Good test properties<\/a><ul>\n+<li><a href=\"#lightness\">Lightness<\/a><\/li>\n+<li><a href=\"#isolation\">Isolation<\/a><\/li>\n+<li><a href=\"#atomicity-and-self-containment\">Atomicity and self-containment<\/a><\/li>\n+<li><a href=\"#repeatability\">Repeatability<\/a><\/li>\n+<li><a href=\"#informativeness\">Informativeness<\/a><\/li>\n+<li><a href=\"#testing-instead-of-visiting\">Testing instead of visiting<\/a><\/li>\n+<li><a href=\"#nearness\">Nearness<\/a><\/li>\n@@ -50,17 +34,8 @@\n-<li><a href=\"#asserts\" id=\"toc-asserts\">Asserts<\/a>\n-<ul>\n-<li><a href=\"#several-checks\" id=\"toc-several-checks\">Several\n-checks<\/a><\/li>\n-<li><a href=\"#first-parameter-is-expected-value\"\n-id=\"toc-first-parameter-is-expected-value\">First parameter is expected\n-value<\/a><\/li>\n-<li><a href=\"#floating-point-comparison\"\n-id=\"toc-floating-point-comparison\">Floating-point comparison<\/a><\/li>\n-<li><a href=\"#c-string-comparison\" id=\"toc-c-string-comparison\">C string\n-comparison<\/a><\/li>\n-<li><a href=\"#error-messages\" id=\"toc-error-messages\">Error\n-messages<\/a><\/li>\n-<li><a href=\"#uncluttered-output\"\n-id=\"toc-uncluttered-output\">Uncluttered output<\/a><\/li>\n-<li><a href=\"#failures-propagation\"\n-id=\"toc-failures-propagation\">Failures propagation<\/a><\/li>\n+<li><a href=\"#asserts\">Asserts<\/a><ul>\n+<li><a href=\"#several-checks\">Several checks<\/a><\/li>\n+<li><a href=\"#first-parameter-is-expected-value\">First parameter is expected value<\/a><\/li>\n+<li><a href=\"#floating-point-comparison\">Floating-point comparison<\/a><\/li>\n+<li><a href=\"#c-string-comparison\">C string comparison<\/a><\/li>\n+<li><a href=\"#error-messages\">Error messages<\/a><\/li>\n+<li><a href=\"#uncluttered-output\">Uncluttered output<\/a><\/li>\n+<li><a href=\"#failures-propagation\">Failures propagation<\/a><\/li>\n@@ -68,15 +43,8 @@\n-<li><a href=\"#naming-and-grouping\" id=\"toc-naming-and-grouping\">Naming\n-and Grouping<\/a>\n-<ul>\n-<li><a href=\"#test-group-names\" id=\"toc-test-group-names\">Test group\n-names<\/a><\/li>\n-<li><a href=\"#filename\" id=\"toc-filename\">Filename<\/a><\/li>\n-<li><a href=\"#file-location\" id=\"toc-file-location\">File\n-location<\/a><\/li>\n-<li><a href=\"#test-names\" id=\"toc-test-names\">Test names<\/a><\/li>\n-<li><a href=\"#fixture-classes\" id=\"toc-fixture-classes\">Fixture\n-classes<\/a><\/li>\n-<li><a href=\"#friend-classes\" id=\"toc-friend-classes\">Friend\n-classes<\/a><\/li>\n-<li><a href=\"#oscpu-specific-tests\" id=\"toc-oscpu-specific-tests\">OS\/CPU\n-specific tests<\/a><\/li>\n+<li><a href=\"#naming-and-grouping\">Naming and Grouping<\/a><ul>\n+<li><a href=\"#test-group-names\">Test group names<\/a><\/li>\n+<li><a href=\"#filename\">Filename<\/a><\/li>\n+<li><a href=\"#file-location\">File location<\/a><\/li>\n+<li><a href=\"#test-names\">Test names<\/a><\/li>\n+<li><a href=\"#fixture-classes\">Fixture classes<\/a><\/li>\n+<li><a href=\"#friend-classes\">Friend classes<\/a><\/li>\n+<li><a href=\"#oscpu-specific-tests\">OS\/CPU specific tests<\/a><\/li>\n@@ -84,18 +52,9 @@\n-<li><a href=\"#miscellaneous\" id=\"toc-miscellaneous\">Miscellaneous<\/a>\n-<ul>\n-<li><a href=\"#hotspot-style\" id=\"toc-hotspot-style\">Hotspot\n-style<\/a><\/li>\n-<li><a href=\"#codetest-metrics\" id=\"toc-codetest-metrics\">Code\/test\n-metrics<\/a><\/li>\n-<li><a href=\"#access-to-non-public-members\"\n-id=\"toc-access-to-non-public-members\">Access to non-public\n-members<\/a><\/li>\n-<li><a href=\"#death-tests\" id=\"toc-death-tests\">Death tests<\/a><\/li>\n-<li><a href=\"#external-flags\" id=\"toc-external-flags\">External\n-flags<\/a><\/li>\n-<li><a href=\"#test-specific-flags\"\n-id=\"toc-test-specific-flags\">Test-specific flags<\/a><\/li>\n-<li><a href=\"#flag-restoring\" id=\"toc-flag-restoring\">Flag\n-restoring<\/a><\/li>\n-<li><a href=\"#googletest-documentation\"\n-id=\"toc-googletest-documentation\">GoogleTest documentation<\/a><\/li>\n+<li><a href=\"#miscellaneous\">Miscellaneous<\/a><ul>\n+<li><a href=\"#hotspot-style\">Hotspot style<\/a><\/li>\n+<li><a href=\"#codetest-metrics\">Code\/test metrics<\/a><\/li>\n+<li><a href=\"#access-to-non-public-members\">Access to non-public members<\/a><\/li>\n+<li><a href=\"#death-tests\">Death tests<\/a><\/li>\n+<li><a href=\"#external-flags\">External flags<\/a><\/li>\n+<li><a href=\"#test-specific-flags\">Test-specific flags<\/a><\/li>\n+<li><a href=\"#flag-restoring\">Flag restoring<\/a><\/li>\n+<li><a href=\"#googletest-documentation\">GoogleTest documentation<\/a><\/li>\n@@ -103,1 +62,1 @@\n-<li><a href=\"#todo\" id=\"toc-todo\">TODO<\/a><\/li>\n+<li><a href=\"#todo\">TODO<\/a><\/li>\n@@ -106,9 +65,2 @@\n-<p>The purpose of these guidelines is to establish a shared vision on\n-what kind of native tests and how we want to develop them for Hotspot\n-using GoogleTest. Hence these guidelines include style items as well as\n-test approach items.<\/p>\n-<p>First section of this document describes properties of good tests\n-which are common for almost all types of test regardless of language,\n-framework, etc. Further sections provide recommendations to achieve\n-those properties and other HotSpot and\/or GoogleTest specific\n-guidelines.<\/p>\n+<p>The purpose of these guidelines is to establish a shared vision on what kind of native tests and how we want to develop them for Hotspot using GoogleTest. Hence these guidelines include style items as well as test approach items.<\/p>\n+<p>First section of this document describes properties of good tests which are common for almost all types of test regardless of language, framework, etc. Further sections provide recommendations to achieve those properties and other HotSpot and\/or GoogleTest specific guidelines.<\/p>\n@@ -118,2 +70,1 @@\n-<p>In Hotspot, there are 3 different types of tests regarding their\n-dependency on a JVM, each next level is slower than previous<\/p>\n+<p>In Hotspot, there are 3 different types of tests regarding their dependency on a JVM, each next level is slower than previous<\/p>\n@@ -122,5 +73,2 @@\n-<li><p><code>TEST_VM<\/code> : a test does depend on an initialized JVM,\n-but are supposed not to break a JVM, i.e. leave it in a workable\n-state.<\/p><\/li>\n-<li><p><code>TEST_OTHER_VM<\/code> : a test depends on a JVM and requires\n-a freshly initialized JVM or leaves a JVM in non-workable state<\/p><\/li>\n+<li><p><code>TEST_VM<\/code> : a test does depend on an initialized JVM, but are supposed not to break a JVM, i.e. leave it in a workable state.<\/p><\/li>\n+<li><p><code>TEST_OTHER_VM<\/code> : a test depends on a JVM and requires a freshly initialized JVM or leaves a JVM in non-workable state<\/p><\/li>\n@@ -129,28 +77,6 @@\n-<p>Tests have to be isolated: not to have visible side-effects,\n-influences on other tests results.<\/p>\n-<p>Results of one test should not depend on test execution order, other\n-tests, otherwise it is becoming almost impossible to find out why a test\n-failed. Due to hotspot-specific, it is not so easy to get a full\n-isolation, e.g. we share an initialized JVM between all\n-<code>TEST_VM<\/code> tests, so if your test changes JVM's state too\n-drastically and does not change it back, you had better consider\n-<code>TEST_OTHER_VM<\/code>.<\/p>\n-<h3 id=\"atomicity-and-self-containment\">Atomicity and\n-self-containment<\/h3>\n-<p>Tests should be <em>atomic<\/em> and <em>self-contained<\/em> at the\n-same time.<\/p>\n-<p>One test should check a particular part of a class, subsystem,\n-functionality, etc. Then it is quite easy to determine what parts of a\n-product are broken basing on test failures. On the other hand, a test\n-should test that part more-or-less entirely, because when one sees a\n-test <code>FooTest::bar<\/code>, they assume all aspects of bar from\n-<code>Foo<\/code> are tested.<\/p>\n-<p>However, it is impossible to cover all aspects even of a method, not\n-to mention a subsystem. In such cases, it is recommended to have several\n-tests, one for each aspect of a thing under test. For example one test\n-to tests how <code>Foo::bar<\/code> works if an argument is\n-<code>null<\/code>, another test to test how it works if an argument is\n-acceptable but <code>Foo<\/code> is not in the right state to accept it\n-and so on. This helps not only to make tests atomic, self-contained but\n-also makes test name self-descriptive (discussed in more details in <a\n-href=\"#test-names\">Test names<\/a>).<\/p>\n+<p>Tests have to be isolated: not to have visible side-effects, influences on other tests results.<\/p>\n+<p>Results of one test should not depend on test execution order, other tests, otherwise it is becoming almost impossible to find out why a test failed. Due to hotspot-specific, it is not so easy to get a full isolation, e.g. we share an initialized JVM between all <code>TEST_VM<\/code> tests, so if your test changes JVM's state too drastically and does not change it back, you had better consider <code>TEST_OTHER_VM<\/code>.<\/p>\n+<h3 id=\"atomicity-and-self-containment\">Atomicity and self-containment<\/h3>\n+<p>Tests should be <em>atomic<\/em> and <em>self-contained<\/em> at the same time.<\/p>\n+<p>One test should check a particular part of a class, subsystem, functionality, etc. Then it is quite easy to determine what parts of a product are broken basing on test failures. On the other hand, a test should test that part more-or-less entirely, because when one sees a test <code>FooTest::bar<\/code>, they assume all aspects of bar from <code>Foo<\/code> are tested.<\/p>\n+<p>However, it is impossible to cover all aspects even of a method, not to mention a subsystem. In such cases, it is recommended to have several tests, one for each aspect of a thing under test. For example one test to tests how <code>Foo::bar<\/code> works if an argument is <code>null<\/code>, another test to test how it works if an argument is acceptable but <code>Foo<\/code> is not in the right state to accept it and so on. This helps not only to make tests atomic, self-contained but also makes test name self-descriptive (discussed in more details in <a href=\"#test-names\">Test names<\/a>).<\/p>\n@@ -159,7 +85,2 @@\n-<p>Reproducibility is very crucial for a test. No one likes sporadic\n-test failures, they are hard to investigate, fix and verify a fix.<\/p>\n-<p>In some cases, it is quite hard to write a 100% repeatable test,\n-since besides a test there can be other moving parts, e.g. in case of\n-<code>TEST_VM<\/code> there are several concurrently running threads.\n-Despite this, we should try to make a test as reproducible as\n-possible.<\/p>\n+<p>Reproducibility is very crucial for a test. No one likes sporadic test failures, they are hard to investigate, fix and verify a fix.<\/p>\n+<p>In some cases, it is quite hard to write a 100% repeatable test, since besides a test there can be other moving parts, e.g. in case of <code>TEST_VM<\/code> there are several concurrently running threads. Despite this, we should try to make a test as reproducible as possible.<\/p>\n@@ -167,11 +88,3 @@\n-<p>In case of a failure, a test should be as <em>informative<\/em> as\n-possible.<\/p>\n-<p>Having more information about a test failure than just compared\n-values can be very useful for failure troubleshooting, it can reduce or\n-even completely eliminate debugging hours. This is even more important\n-in case of not 100% reproducible failures.<\/p>\n-<p>Achieving this property, one can easily make a test too verbose, so\n-it will be really hard to find useful information in the ocean of\n-useless information. Hence they should not only think about how to\n-provide <a href=\"#error-messages\">good information<\/a>, but also <a\n-href=\"#uncluttered-output\">when to do it<\/a>.<\/p>\n+<p>In case of a failure, a test should be as <em>informative<\/em> as possible.<\/p>\n+<p>Having more information about a test failure than just compared values can be very useful for failure troubleshooting, it can reduce or even completely eliminate debugging hours. This is even more important in case of not 100% reproducible failures.<\/p>\n+<p>Achieving this property, one can easily make a test too verbose, so it will be really hard to find useful information in the ocean of useless information. Hence they should not only think about how to provide <a href=\"#error-messages\">good information<\/a>, but also <a href=\"#uncluttered-output\">when to do it<\/a>.<\/p>\n@@ -180,8 +93,2 @@\n-<p>It is not enough just to \"visit\" some code, a test should check that\n-code does that it has to do, compare return values with expected values,\n-check that desired side effects are done, and undesired are not, and so\n-on. In other words, a test should contain at least one GoogleTest\n-assertion and do not rely on JVM asserts.<\/p>\n-<p>Generally speaking to write a good test, one should create a model of\n-the system under tests, a model of possible bugs (or bugs which one\n-wants to find) and design tests using those models.<\/p>\n+<p>It is not enough just to &quot;visit&quot; some code, a test should check that code does that it has to do, compare return values with expected values, check that desired side effects are done, and undesired are not, and so on. In other words, a test should contain at least one GoogleTest assertion and do not rely on JVM asserts.<\/p>\n+<p>Generally speaking to write a good test, one should create a model of the system under tests, a model of possible bugs (or bugs which one wants to find) and design tests using those models.<\/p>\n@@ -190,6 +97,1 @@\n-<p>Not only does having test logic outside, e.g. verification method,\n-depending on asserts in product code contradict with several items above\n-but also decreases test’s readability and stability. It is much easier\n-to understand that a test is testing when all testing logic is located\n-inside a test or nearby in shared test libraries. As a rule of thumb,\n-the closer a check to a test, the better.<\/p>\n+<p>Not only does having test logic outside, e.g. verification method, depending on asserts in product code contradict with several items above but also decreases test’s readability and stability. It is much easier to understand that a test is testing when all testing logic is located inside a test or nearby in shared test libraries. As a rule of thumb, the closer a check to a test, the better.<\/p>\n@@ -199,26 +101,5 @@\n-<p>This is related to the <a href=\"#informativeness\">informativeness<\/a>\n-property of tests, information for other checks can help to better\n-localize a defect’s root-cause. One should use <code>ASSERT<\/code> if it\n-is impossible to continue test execution or if it does not make much\n-sense. Later in the text, <code>EXPECT<\/code> forms will be used to\n-refer to both <code>ASSERT\/EXPECT<\/code>.<\/p>\n-<p>When it is possible to make several different checks, but impossible\n-to continue test execution if at least one check fails, you can use\n-<code>::testing::Test::HasNonfatalFailure()<\/code> function. The\n-recommended way to express that is\n-<code>ASSERT_FALSE(::testing::Test::HasNonfatalFailure())<\/code>.\n-Besides making it clear why a test is aborted, it also allows you to\n-provide more information about a failure.<\/p>\n-<h3 id=\"first-parameter-is-expected-value\">First parameter is expected\n-value<\/h3>\n-<p>In all equality assertions, expected values should be passed as the\n-first parameter.<\/p>\n-<p>This convention is adopted by GoogleTest, and there is a slight\n-difference in how GoogleTest treats parameters, the most important one\n-is <code>null<\/code> detection. Due to different reasons,\n-<code>null<\/code> detection is enabled only for the first parameter,\n-that is to said <code>EXPECT_EQ(NULL, object)<\/code> checks that object\n-is <code>null<\/code>, while <code>EXPECT_EQ(object, NULL)<\/code> checks\n-that object equals to <code>NULL<\/code>, GoogleTest is very strict\n-regarding types of compared values so the latter will generates a\n-compile-time error.<\/p>\n+<p>This is related to the <a href=\"#informativeness\">informativeness<\/a> property of tests, information for other checks can help to better localize a defect’s root-cause. One should use <code>ASSERT<\/code> if it is impossible to continue test execution or if it does not make much sense. Later in the text, <code>EXPECT<\/code> forms will be used to refer to both <code>ASSERT\/EXPECT<\/code>.<\/p>\n+<p>When it is possible to make several different checks, but impossible to continue test execution if at least one check fails, you can use <code>::testing::Test::HasNonfatalFailure()<\/code> function. The recommended way to express that is <code>ASSERT_FALSE(::testing::Test::HasNonfatalFailure())<\/code>. Besides making it clear why a test is aborted, it also allows you to provide more information about a failure.<\/p>\n+<h3 id=\"first-parameter-is-expected-value\">First parameter is expected value<\/h3>\n+<p>In all equality assertions, expected values should be passed as the first parameter.<\/p>\n+<p>This convention is adopted by GoogleTest, and there is a slight difference in how GoogleTest treats parameters, the most important one is <code>null<\/code> detection. Due to different reasons, <code>null<\/code> detection is enabled only for the first parameter, that is to said <code>EXPECT_EQ(NULL, object)<\/code> checks that object is <code>null<\/code>, while <code>EXPECT_EQ(object, NULL)<\/code> checks that object equals to <code>NULL<\/code>, GoogleTest is very strict regarding types of compared values so the latter will generates a compile-time error.<\/p>\n@@ -226,10 +107,2 @@\n-<p>Use floating-point special macros to compare\n-<code>float\/double<\/code> values.<\/p>\n-<p>Because of floating-point number representations and round-off\n-errors, regular equality comparison will not return true in most cases.\n-There are special <code>EXPECT_FLOAT_EQ\/EXPECT_DOUBLE_EQ<\/code>\n-assertions which check that the distance between compared values is not\n-more than 4 ULPs, there is also <code>EXPECT_NEAR(v1, v2, eps)<\/code>\n-which checks that the absolute value of the difference between\n-<code>v1<\/code> and <code>v2<\/code> is not greater than\n-<code>eps<\/code>.<\/p>\n+<p>Use floating-point special macros to compare <code>float\/double<\/code> values.<\/p>\n+<p>Because of floating-point number representations and round-off errors, regular equality comparison will not return true in most cases. There are special <code>EXPECT_FLOAT_EQ\/EXPECT_DOUBLE_EQ<\/code> assertions which check that the distance between compared values is not more than 4 ULPs, there is also <code>EXPECT_NEAR(v1, v2, eps)<\/code> which checks that the absolute value of the difference between <code>v1<\/code> and <code>v2<\/code> is not greater than <code>eps<\/code>.<\/p>\n@@ -238,5 +111,1 @@\n-<p><code>EXPECT_EQ<\/code> just compares pointers’ values, which is\n-hardly what one wants comparing C strings. GoogleTest provides\n-<code>EXPECT_STREQ<\/code> and <code>EXPECT_STRNE<\/code> macros to\n-compare C string contents. There are also case-insensitive versions\n-<code>EXPECT_STRCASEEQ<\/code>, <code>EXPECT_STRCASENE<\/code>.<\/p>\n+<p><code>EXPECT_EQ<\/code> just compares pointers’ values, which is hardly what one wants comparing C strings. GoogleTest provides <code>EXPECT_STREQ<\/code> and <code>EXPECT_STRNE<\/code> macros to compare C string contents. There are also case-insensitive versions <code>EXPECT_STRCASEEQ<\/code>, <code>EXPECT_STRCASENE<\/code>.<\/p>\n@@ -245,15 +114,2 @@\n-<p>All GoogleTest asserts print compared expressions and their values,\n-so there is no need to have them in error messages. Asserts print only\n-compared values, they do not print any of interim variables, e.g.\n-<code>ASSERT_TRUE((val1 == val2 &amp;&amp; isFail(foo(8)) || i == 18)<\/code>\n-prints only one value. If you use some complex predicates, please\n-consider <code>EXPECT_PRED*<\/code> or <code>EXPECT_FORMAT_PRED<\/code>\n-assertions family, they check that a predicate returns true\/success and\n-print out all parameters values.<\/p>\n-<p>However in some cases, default information is not enough, a commonly\n-used example is an assert inside a loop, GoogleTest will not print\n-iteration values (unless it is an assert's parameter). Other\n-demonstrative examples are printing error code and a corresponding error\n-message; printing internal states which might have an impact on results.\n-One should add this information to assert message using\n-<code>&lt;&lt;<\/code> operator.<\/p>\n+<p>All GoogleTest asserts print compared expressions and their values, so there is no need to have them in error messages. Asserts print only compared values, they do not print any of interim variables, e.g. <code>ASSERT_TRUE((val1 == val2 &amp;&amp; isFail(foo(8)) || i == 18)<\/code> prints only one value. If you use some complex predicates, please consider <code>EXPECT_PRED*<\/code> or <code>EXPECT_FORMAT_PRED<\/code> assertions family, they check that a predicate returns true\/success and print out all parameters values.<\/p>\n+<p>However in some cases, default information is not enough, a commonly used example is an assert inside a loop, GoogleTest will not print iteration values (unless it is an assert's parameter). Other demonstrative examples are printing error code and a corresponding error message; printing internal states which might have an impact on results. One should add this information to assert message using <code>&lt;&lt;<\/code> operator.<\/p>\n@@ -262,8 +118,1 @@\n-<p>Too verbose tests which print all information even if they pass are\n-very bad practice. They just pollute output, so it becomes harder to\n-find useful information. In order not print information till it is\n-really needed, one should consider saving it to a temporary buffer and\n-pass to an assert. <a\n-href=\"https:\/\/git.openjdk.org\/jdk\/blob\/master\/test\/hotspot\/gtest\/gc\/shared\/test_memset_with_concurrent_readers.cpp\"\n-class=\"uri\">https:\/\/git.openjdk.org\/jdk\/blob\/master\/test\/hotspot\/gtest\/gc\/shared\/test_memset_with_concurrent_readers.cpp<\/a>\n-has a good example how to do that.<\/p>\n+<p>Too verbose tests which print all information even if they pass are very bad practice. They just pollute output, so it becomes harder to find useful information. In order not print information till it is really needed, one should consider saving it to a temporary buffer and pass to an assert. <a href=\"https:\/\/git.openjdk.org\/jdk\/blob\/master\/test\/hotspot\/gtest\/gc\/shared\/test_memset_with_concurrent_readers.cpp\" class=\"uri\">https:\/\/git.openjdk.org\/jdk\/blob\/master\/test\/hotspot\/gtest\/gc\/shared\/test_memset_with_concurrent_readers.cpp<\/a> has a good example how to do that.<\/p>\n@@ -271,17 +120,3 @@\n-<p>Wrap a subroutine call into <code>EXPECT_NO_FATAL_FAILURE<\/code>\n-macro to propagate failures.<\/p>\n-<p><code>ASSERT<\/code> and <code>FAIL<\/code> abort only the current\n-function, so if you have them in a subroutine, a test will not be\n-aborted after the subroutine even if <code>ASSERT<\/code> or\n-<code>FAIL<\/code> fails. You should call such subroutines in\n-<code>ASSERT_NO_FATAL_FAILURE<\/code> macro to propagate fatal failures\n-and abort a test. <code>(EXPECT|ASSERT)_NO_FATAL_FAILURE<\/code> can also\n-be used to provide more information.<\/p>\n-<p>Due to obvious reasons, there are no\n-<code>(EXPECT|ASSERT)_NO_NONFATAL_FAILURE<\/code> macros. However, if you\n-need to check if a subroutine generated a nonfatal failure (failed an\n-<code>EXPECT<\/code>), you can use\n-<code>::testing::Test::HasNonfatalFailure<\/code> function, or\n-<code>::testing::Test::HasFailure<\/code> function to check if a\n-subroutine generated any failures, see <a href=\"#several-checks\">Several\n-checks<\/a>.<\/p>\n+<p>Wrap a subroutine call into <code>EXPECT_NO_FATAL_FAILURE<\/code> macro to propagate failures.<\/p>\n+<p><code>ASSERT<\/code> and <code>FAIL<\/code> abort only the current function, so if you have them in a subroutine, a test will not be aborted after the subroutine even if <code>ASSERT<\/code> or <code>FAIL<\/code> fails. You should call such subroutines in <code>ASSERT_NO_FATAL_FAILURE<\/code> macro to propagate fatal failures and abort a test. <code>(EXPECT|ASSERT)_NO_FATAL_FAILURE<\/code> can also be used to provide more information.<\/p>\n+<p>Due to obvious reasons, there are no <code>(EXPECT|ASSERT)_NO_NONFATAL_FAILURE<\/code> macros. However, if you need to check if a subroutine generated a nonfatal failure (failed an <code>EXPECT<\/code>), you can use <code>::testing::Test::HasNonfatalFailure<\/code> function, or <code>::testing::Test::HasFailure<\/code> function to check if a subroutine generated any failures, see <a href=\"#several-checks\">Several checks<\/a>.<\/p>\n@@ -290,8 +125,2 @@\n-<p>Test group names should be in CamelCase, start and end with a letter.\n-A test group should be named after tested class, functionality,\n-subsystem, etc.<\/p>\n-<p>This naming scheme helps to find tests, filter them and simplifies\n-test failure analysis. For example, class <code>Foo<\/code> - test group\n-<code>Foo<\/code>, compiler logging subsystem - test group\n-<code>CompilerLogging<\/code>, G1 GC — test group <code>G1GC<\/code>, and\n-so forth.<\/p>\n+<p>Test group names should be in CamelCase, start and end with a letter. A test group should be named after tested class, functionality, subsystem, etc.<\/p>\n+<p>This naming scheme helps to find tests, filter them and simplifies test failure analysis. For example, class <code>Foo<\/code> - test group <code>Foo<\/code>, compiler logging subsystem - test group <code>CompilerLogging<\/code>, G1 GC — test group <code>G1GC<\/code>, and so forth.<\/p>\n@@ -299,4 +128,2 @@\n-<p>A test file must have <code>test_<\/code> prefix and <code>.cpp<\/code>\n-suffix.<\/p>\n-<p>Both are actually requirements from the current build system to\n-recognize your tests.<\/p>\n+<p>A test file must have <code>test_<\/code> prefix and <code>.cpp<\/code> suffix.<\/p>\n+<p>Both are actually requirements from the current build system to recognize your tests.<\/p>\n@@ -304,2 +131,1 @@\n-<p>Test file location should reflect a location of the tested part of\n-the product.<\/p>\n+<p>Test file location should reflect a location of the tested part of the product.<\/p>\n@@ -307,11 +133,2 @@\n-<li><p>All unit tests for a class from <code>foo\/bar\/baz.cpp<\/code>\n-should be placed <code>foo\/bar\/test_baz.cpp<\/code> in\n-<code>hotspot\/test\/native\/<\/code> directory. Having all tests for a\n-class in one file is a common practice for unit tests, it helps to see\n-all existing tests at once, share functions and\/or resources without\n-losing encapsulation.<\/p><\/li>\n-<li><p>For tests which test more than one class, directory hierarchy\n-should be the same as product hierarchy, and file name should reflect\n-the name of the tested subsystem\/functionality. For example, if a\n-sub-system under tests belongs to <code>gc\/g1<\/code>, tests should be\n-placed in <code>gc\/g1<\/code> directory.<\/p><\/li>\n+<li><p>All unit tests for a class from <code>foo\/bar\/baz.cpp<\/code> should be placed <code>foo\/bar\/test_baz.cpp<\/code> in <code>hotspot\/test\/native\/<\/code> directory. Having all tests for a class in one file is a common practice for unit tests, it helps to see all existing tests at once, share functions and\/or resources without losing encapsulation.<\/p><\/li>\n+<li><p>For tests which test more than one class, directory hierarchy should be the same as product hierarchy, and file name should reflect the name of the tested subsystem\/functionality. For example, if a sub-system under tests belongs to <code>gc\/g1<\/code>, tests should be placed in <code>gc\/g1<\/code> directory.<\/p><\/li>\n@@ -319,6 +136,1 @@\n-<p>Please note that framework prepends directory name to a test group\n-name. For example, if <code>TEST(foo, check_this)<\/code> and\n-<code>TEST(bar, check_that)<\/code> are defined in\n-<code>hotspot\/test\/native\/gc\/shared\/test_foo.cpp<\/code> file, they will\n-be reported as <code>gc\/shared\/foo::check_this<\/code> and\n-<code>gc\/shared\/bar::check_that<\/code>.<\/p>\n+<p>Please note that framework prepends directory name to a test group name. For example, if <code>TEST(foo, check_this)<\/code> and <code>TEST(bar, check_that)<\/code> are defined in <code>hotspot\/test\/native\/gc\/shared\/test_foo.cpp<\/code> file, they will be reported as <code>gc\/shared\/foo::check_this<\/code> and <code>gc\/shared\/bar::check_that<\/code>.<\/p>\n@@ -326,15 +138,3 @@\n-<p>Test names should be in small_snake_case, start and end with a\n-letter. A test name should reflect that a test checks.<\/p>\n-<p>Such naming makes tests self-descriptive and helps a lot during the\n-whole test life cycle. It is easy to do test planning, test inventory,\n-to see what things are not tested, to review tests, to analyze test\n-failures, to evolve a test, etc. For example\n-<code>foo_return_0_if_name_is_null<\/code> is better than\n-<code>foo_sanity<\/code> or <code>foo_basic<\/code> or just\n-<code>foo<\/code>,\n-<code>humongous_objects_can_not_be_moved_by_young_gc<\/code> is better\n-than <code>ho_young_gc<\/code>.<\/p>\n-<p>Actually using underscore is against GoogleTest project convention,\n-because it can lead to illegal identifiers, however, this is too strict.\n-Restricting usage of underscore for test names only and prohibiting test\n-name starts or ends with an underscore are enough to be safe.<\/p>\n+<p>Test names should be in small_snake_case, start and end with a letter. A test name should reflect that a test checks.<\/p>\n+<p>Such naming makes tests self-descriptive and helps a lot during the whole test life cycle. It is easy to do test planning, test inventory, to see what things are not tested, to review tests, to analyze test failures, to evolve a test, etc. For example <code>foo_return_0_if_name_is_null<\/code> is better than <code>foo_sanity<\/code> or <code>foo_basic<\/code> or just <code>foo<\/code>, <code>humongous_objects_can_not_be_moved_by_young_gc<\/code> is better than <code>ho_young_gc<\/code>.<\/p>\n+<p>Actually using underscore is against GoogleTest project convention, because it can lead to illegal identifiers, however, this is too strict. Restricting usage of underscore for test names only and prohibiting test name starts or ends with an underscore are enough to be safe.<\/p>\n@@ -342,3 +142,1 @@\n-<p>Fixture classes should be named after tested classes, subsystems, etc\n-(follow <a href=\"#test-group-names\">Test group names rule<\/a>) and have\n-<code>Test<\/code> suffix to prevent class name conflicts.<\/p>\n+<p>Fixture classes should be named after tested classes, subsystems, etc (follow <a href=\"#test-group-names\">Test group names rule<\/a>) and have <code>Test<\/code> suffix to prevent class name conflicts.<\/p>\n@@ -346,7 +144,2 @@\n-<p>All test purpose friends should have either <code>Test<\/code> or\n-<code>Testable<\/code> suffix.<\/p>\n-<p>It greatly simplifies understanding of friendship’s purpose and\n-allows statically check that private members are not exposed\n-unexpectedly. Having <code>FooTest<\/code> as a friend of\n-<code>Foo<\/code> without any comments will be understood as a necessary\n-evil to get testability.<\/p>\n+<p>All test purpose friends should have either <code>Test<\/code> or <code>Testable<\/code> suffix.<\/p>\n+<p>It greatly simplifies understanding of friendship’s purpose and allows statically check that private members are not exposed unexpectedly. Having <code>FooTest<\/code> as a friend of <code>Foo<\/code> without any comments will be understood as a necessary evil to get testability.<\/p>\n@@ -354,6 +147,2 @@\n-<p>Guard OS\/CPU specific tests by <code>#ifdef<\/code> and have OS\/CPU\n-name in filename.<\/p>\n-<p>For the time being, we do not support separate directories for OS,\n-CPU, OS-CPU specific tests, in case we will have lots of such tests, we\n-will change directory layout and build system to support that in the\n-same way it is done in hotspot.<\/p>\n+<p>Guard OS\/CPU specific tests by <code>#ifdef<\/code> and have OS\/CPU name in filename.<\/p>\n+<p>For the time being, we do not support separate directories for OS, CPU, OS-CPU specific tests, in case we will have lots of such tests, we will change directory layout and build system to support that in the same way it is done in hotspot.<\/p>\n@@ -363,3 +152,1 @@\n-<p>Tests are a part of Hotspot, so everything (if applicable) we use for\n-Hotspot, should be used for tests as well. Those guidelines cover\n-test-specific things.<\/p>\n+<p>Tests are a part of Hotspot, so everything (if applicable) we use for Hotspot, should be used for tests as well. Those guidelines cover test-specific things.<\/p>\n@@ -367,8 +154,2 @@\n-<p>Coverage information and other code\/test metrics are quite useful to\n-decide what tests should be written, what tests should be improved and\n-what can be removed.<\/p>\n-<p>For unit tests, widely used and well-known coverage metric is branch\n-coverage, which provides good quality of tests with relatively easy test\n-development process. For other levels of testing, branch coverage is not\n-as good, and one should consider others metrics, e.g. transaction flow\n-coverage, data flow coverage.<\/p>\n+<p>Coverage information and other code\/test metrics are quite useful to decide what tests should be written, what tests should be improved and what can be removed.<\/p>\n+<p>For unit tests, widely used and well-known coverage metric is branch coverage, which provides good quality of tests with relatively easy test development process. For other levels of testing, branch coverage is not as good, and one should consider others metrics, e.g. transaction flow coverage, data flow coverage.<\/p>\n@@ -377,6 +158,2 @@\n-<p>We do not use GoogleTest macro to declare friendship relation,\n-because, from our point of view, it is less clear than an explicit\n-declaration.<\/p>\n-<p>Declaring a test fixture class as a friend class of a tested test is\n-the easiest and the clearest way to get access. However, it has some\n-disadvantages, here is some of them:<\/p>\n+<p>We do not use GoogleTest macro to declare friendship relation, because, from our point of view, it is less clear than an explicit declaration.<\/p>\n+<p>Declaring a test fixture class as a friend class of a tested test is the easiest and the clearest way to get access. However, it has some disadvantages, here is some of them:<\/p>\n@@ -387,7 +164,1 @@\n-<p>In other words, it is harder to share code between tests. Hence if\n-you want to share code or expect it to be useful in other tests, you\n-should consider making members in a tested class protected and introduce\n-a shared test-only class which expose those members via public\n-functions, or even making members publicly accessible right away in a\n-product class. If it is not an option to change members visibility, one\n-can create a friend class which exposes members.<\/p>\n+<p>In other words, it is harder to share code between tests. Hence if you want to share code or expect it to be useful in other tests, you should consider making members in a tested class protected and introduce a shared test-only class which expose those members via public functions, or even making members publicly accessible right away in a product class. If it is not an option to change members visibility, one can create a friend class which exposes members.<\/p>\n@@ -395,8 +166,2 @@\n-<p>You can not use death tests inside <code>TEST_OTHER_VM<\/code> and\n-<code>TEST_VM_ASSERT*<\/code>.<\/p>\n-<p>We tried to make Hotspot-GoogleTest integration as transparent as\n-possible, however, due to the current implementation of\n-<code>TEST_OTHER_VM<\/code> and <code>TEST_VM_ASSERT*<\/code> tests, you\n-cannot use death test functionality in them. These tests are implemented\n-as GoogleTest death tests, and GoogleTest does not allow to have a death\n-test inside another death test.<\/p>\n+<p>You can not use death tests inside <code>TEST_OTHER_VM<\/code> and <code>TEST_VM_ASSERT*<\/code>.<\/p>\n+<p>We tried to make Hotspot-GoogleTest integration as transparent as possible, however, due to the current implementation of <code>TEST_OTHER_VM<\/code> and <code>TEST_VM_ASSERT*<\/code> tests, you cannot use death test functionality in them. These tests are implemented as GoogleTest death tests, and GoogleTest does not allow to have a death test inside another death test.<\/p>\n@@ -405,8 +170,1 @@\n-<p>The rationality of such design decision is to simplify both tests and\n-a test framework and to avoid failures related to incompatible flags\n-combination till there is a good solution for that. However there are\n-cases when one wants to test a JVM with specific flags combination,\n-<code>_JAVA_OPTIONS<\/code> environment variable can be used to do that.\n-Flags from <code>_JAVA_OPTIONS<\/code> will be used in\n-<code>TEST_VM<\/code>, <code>TEST_OTHER_VM<\/code> and\n-<code>TEST_VM_ASSERT*<\/code> tests.<\/p>\n+<p>The rationality of such design decision is to simplify both tests and a test framework and to avoid failures related to incompatible flags combination till there is a good solution for that. However there are cases when one wants to test a JVM with specific flags combination, <code>_JAVA_OPTIONS<\/code> environment variable can be used to do that. Flags from <code>_JAVA_OPTIONS<\/code> will be used in <code>TEST_VM<\/code>, <code>TEST_OTHER_VM<\/code> and <code>TEST_VM_ASSERT*<\/code> tests.<\/p>\n@@ -414,21 +172,4 @@\n-<p>Passing flags to a tested JVM in <code>TEST_OTHER_VM<\/code> and\n-<code>TEST_VM_ASSERT*<\/code> should be possible, but is not implemented\n-yet.<\/p>\n-<p>Facility to pass test-specific flags is needed for system, regression\n-or other types of tests which require a fully initialized JVM in some\n-particular configuration, e.g. with Serial GC selected. There is no\n-support for such tests now, however, there is a plan to add that in\n-upcoming releases.<\/p>\n-<p>For now, if a test depends on flags values, it should have\n-<code>if (!&lt;flag&gt;) { return }<\/code> guards in the very beginning\n-and <code>@requires<\/code> comment similar to jtreg\n-<code>@requires<\/code> directive right before test macros. <a\n-href=\"https:\/\/git.openjdk.org\/jdk\/blob\/master\/test\/hotspot\/gtest\/gc\/g1\/test_g1IHOPControl.cpp\"\n-class=\"uri\">https:\/\/git.openjdk.org\/jdk\/blob\/master\/test\/hotspot\/gtest\/gc\/g1\/test_g1IHOPControl.cpp<\/a>\n-ha an example of this temporary workaround. It is important to follow\n-that pattern as it allows us to easily find all such tests and update\n-them as soon as there is an implementation of flag passing facility.<\/p>\n-<p>In long-term, we expect jtreg to support GoogleTest tests as first\n-class citizens, that is to say, jtreg will parse <span class=\"citation\"\n-data-cites=\"requires\">@requires<\/span> comments and filter out\n-inapplicable tests.<\/p>\n+<p>Passing flags to a tested JVM in <code>TEST_OTHER_VM<\/code> and <code>TEST_VM_ASSERT*<\/code> should be possible, but is not implemented yet.<\/p>\n+<p>Facility to pass test-specific flags is needed for system, regression or other types of tests which require a fully initialized JVM in some particular configuration, e.g. with Serial GC selected. There is no support for such tests now, however, there is a plan to add that in upcoming releases.<\/p>\n+<p>For now, if a test depends on flags values, it should have <code>if (!&lt;flag&gt;) { return }<\/code> guards in the very beginning and <code>@requires<\/code> comment similar to jtreg <code>@requires<\/code> directive right before test macros. <a href=\"https:\/\/git.openjdk.org\/jdk\/blob\/master\/test\/hotspot\/gtest\/gc\/g1\/test_g1IHOPControl.cpp\" class=\"uri\">https:\/\/git.openjdk.org\/jdk\/blob\/master\/test\/hotspot\/gtest\/gc\/g1\/test_g1IHOPControl.cpp<\/a> ha an example of this temporary workaround. It is important to follow that pattern as it allows us to easily find all such tests and update them as soon as there is an implementation of flag passing facility.<\/p>\n+<p>In long-term, we expect jtreg to support GoogleTest tests as first class citizens, that is to say, jtreg will parse <span class=\"citation\" data-cites=\"requires\">@requires<\/span> comments and filter out inapplicable tests.<\/p>\n@@ -437,8 +178,1 @@\n-<p>It is quite common for tests to configure JVM in a certain way\n-changing flags’ values. GoogleTest provides two ways to set up\n-environment before a test and restore it afterward: using either\n-constructor and destructor or <code>SetUp<\/code> and\n-<code>TearDown<\/code> functions. Both ways require to use a test fixture\n-class, which sometimes is too wordy. The simpler facilities like\n-<code>FLAG_GUARD<\/code> macro or <code>*FlagSetting<\/code> classes could\n-be used in such cases to restore\/set values.<\/p>\n+<p>It is quite common for tests to configure JVM in a certain way changing flags’ values. GoogleTest provides two ways to set up environment before a test and restore it afterward: using either constructor and destructor or <code>SetUp<\/code> and <code>TearDown<\/code> functions. Both ways require to use a test fixture class, which sometimes is too wordy. The simpler facilities like <code>FLAG_GUARD<\/code> macro or <code>*FlagSetting<\/code> classes could be used in such cases to restore\/set values.<\/p>\n@@ -447,8 +181,2 @@\n-<li><p>Changing a flag’s value could break the invariants between flags'\n-values and hence could lead to unexpected\/unsupported JVM\n-state.<\/p><\/li>\n-<li><p><code>FLAG_SET_*<\/code> macros can change more than one flag (in\n-order to maintain invariants) so it is hard to predict what flags will\n-be changed and it makes restoring all changed flags a nontrivial task.\n-Thus in case one uses <code>FLAG_SET_*<\/code> macros, they should use\n-<code>TEST_OTHER_VM<\/code> test type.<\/p><\/li>\n+<li><p>Changing a flag’s value could break the invariants between flags' values and hence could lead to unexpected\/unsupported JVM state.<\/p><\/li>\n+<li><p><code>FLAG_SET_*<\/code> macros can change more than one flag (in order to maintain invariants) so it is hard to predict what flags will be changed and it makes restoring all changed flags a nontrivial task. Thus in case one uses <code>FLAG_SET_*<\/code> macros, they should use <code>TEST_OTHER_VM<\/code> test type.<\/p><\/li>\n@@ -457,3 +185,1 @@\n-<p>In case you have any questions regarding GoogleTest itself, its\n-asserts, test declaration macros, other macros, etc, please consult its\n-documentation.<\/p>\n+<p>In case you have any questions regarding GoogleTest itself, its asserts, test declaration macros, other macros, etc, please consult its documentation.<\/p>\n@@ -461,2 +187,1 @@\n-<p>Although this document provides guidelines on the most important\n-parts of test development using GTest, it still misses a few items:<\/p>\n+<p>Although this document provides guidelines on the most important parts of test development using GTest, it still misses a few items:<\/p>\n@@ -464,3 +189,2 @@\n-<li><p>Examples, esp for <a href=\"#access-to-non-public-members\">access\n-to non-public members<\/a><\/p><\/li>\n-<li><p>test types: purpose, drawbacks, limitation<\/p>\n+<li><p>Examples, esp for <a href=\"#access-to-non-public-members\">access to non-public members<\/a><\/p><\/li>\n+<li>test types: purpose, drawbacks, limitation\n@@ -474,1 +198,1 @@\n-<li><p>Miscellaneous<\/p>\n+<li>Miscellaneous\n@@ -487,2 +211,1 @@\n-<li>check that a test can find bugs it is supposed to by introducing\n-them<\/li>\n+<li>check that a test can find bugs it is supposed to by introducing them<\/li>\n","filename":"doc\/hotspot-unit-tests.html","additions":111,"deletions":388,"binary":false,"changes":499,"status":"modified"},{"patch":"@@ -8,13 +8,5 @@\n-  <style>\n-    code{white-space: pre-wrap;}\n-    span.smallcaps{font-variant: small-caps;}\n-    div.columns{display: flex; gap: min(4vw, 1.5em);}\n-    div.column{flex: auto; overflow-x: auto;}\n-    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}\n-    ul.task-list{list-style: none;}\n-    ul.task-list li input[type=\"checkbox\"] {\n-      width: 0.8em;\n-      margin: 0 0.8em 0.2em -1.6em;\n-      vertical-align: middle;\n-    }\n-    .display.math{display: block; text-align: center; margin: 0.5rem auto;}\n+  <style type=\"text\/css\">\n+      code{white-space: pre-wrap;}\n+      span.smallcaps{font-variant: small-caps;}\n+      span.underline{text-decoration: underline;}\n+      div.column{display: inline-block; vertical-align: top; width: 50%;}\n@@ -31,1 +23,1 @@\n-<nav id=\"TOC\" role=\"doc-toc\">\n+<nav id=\"TOC\">\n@@ -33,7 +25,3 @@\n-<li><a href=\"#introduction\" id=\"toc-introduction\">Introduction<\/a>\n-<ul>\n-<li><a href=\"#ide-support-for-native-code\"\n-id=\"toc-ide-support-for-native-code\">IDE support for native\n-code<\/a><\/li>\n-<li><a href=\"#ide-support-for-java-code\"\n-id=\"toc-ide-support-for-java-code\">IDE support for Java code<\/a><\/li>\n+<li><a href=\"#introduction\">Introduction<\/a><ul>\n+<li><a href=\"#ide-support-for-native-code\">IDE support for native code<\/a><\/li>\n+<li><a href=\"#ide-support-for-java-code\">IDE support for Java code<\/a><\/li>\n@@ -44,4 +32,1 @@\n-<p>When you are familiar with building and testing the JDK, you may want\n-to configure an IDE to work with the source code. The instructions\n-differ a bit depending on whether you are interested in working with the\n-native (C\/C++) or the Java code.<\/p>\n+<p>When you are familiar with building and testing the JDK, you may want to configure an IDE to work with the source code. The instructions differ a bit depending on whether you are interested in working with the native (C\/C++) or the Java code.<\/p>\n@@ -49,2 +34,1 @@\n-<p>There are a few ways to generate IDE configuration for the native\n-sources, depending on which IDE to use.<\/p>\n+<p>There are a few ways to generate IDE configuration for the native sources, depending on which IDE to use.<\/p>\n@@ -52,5 +36,1 @@\n-<p>The make system can generate a <a\n-href=\"https:\/\/code.visualstudio.com\">Visual Studio Code<\/a> workspace\n-that has C\/C++ source indexing configured correctly, as well as launcher\n-targets for tests and the Java launcher. After configuring, a workspace\n-for the configuration can be generated using:<\/p>\n+<p>The make system can generate a <a href=\"https:\/\/code.visualstudio.com\">Visual Studio Code<\/a> workspace that has C\/C++ source indexing configured correctly, as well as launcher targets for tests and the Java launcher. After configuring, a workspace for the configuration can be generated using:<\/p>\n@@ -58,4 +38,1 @@\n-<p>This creates a file called <code>jdk.code-workspace<\/code> in the\n-build output folder. The full location will be printed after the\n-workspace has been generated. To use it, choose\n-<code>File -&gt; Open Workspace...<\/code> in Visual Studio Code.<\/p>\n+<p>This creates a file called <code>jdk.code-workspace<\/code> in the build output folder. The full location will be printed after the workspace has been generated. To use it, choose <code>File -&gt; Open Workspace...<\/code> in Visual Studio Code.<\/p>\n@@ -63,8 +40,1 @@\n-<p>The main <code>vscode-project<\/code> target configures the default\n-C++ support in Visual Studio Code. There are also other source indexers\n-that can be installed, that may provide additional features. It's\n-currently possible to generate configuration for two such indexers, <a\n-href=\"https:\/\/clang.llvm.org\/extra\/clangd\/\">clangd<\/a> and <a\n-href=\"https:\/\/github.com\/Andersbakken\/rtags\">rtags<\/a>. These can be\n-configured by appending the name of the indexer to the make target, such\n-as:<\/p>\n+<p>The main <code>vscode-project<\/code> target configures the default C++ support in Visual Studio Code. There are also other source indexers that can be installed, that may provide additional features. It's currently possible to generate configuration for two such indexers, <a href=\"https:\/\/clang.llvm.org\/extra\/clangd\/\">clangd<\/a> and <a href=\"https:\/\/github.com\/Andersbakken\/rtags\">rtags<\/a>. These can be configured by appending the name of the indexer to the make target, such as:<\/p>\n@@ -72,2 +42,1 @@\n-<p>Additional instructions for configuring the given indexer will be\n-displayed after the workspace has been generated.<\/p>\n+<p>Additional instructions for configuring the given indexer will be displayed after the workspace has been generated.<\/p>\n@@ -75,2 +44,1 @@\n-<p>The make system can generate a Visual Studio project for the Hotspot\n-native source. After configuring, the project is generated using:<\/p>\n+<p>The make system can generate a Visual Studio project for the Hotspot native source. After configuring, the project is generated using:<\/p>\n@@ -78,4 +46,1 @@\n-<p>This creates a file named <code>jvm.vcxproj<\/code> in\n-<code>ide\\hotspot-visualstudio<\/code> subfolder of the build output\n-folder. The file can be opened in Visual Studio via\n-<code>File -&gt; Open -&gt; Project\/Solution<\/code>.<\/p>\n+<p>This creates a file named <code>jvm.vcxproj<\/code> in <code>ide\\hotspot-visualstudio<\/code> subfolder of the build output folder. The file can be opened in Visual Studio via <code>File -&gt; Open -&gt; Project\/Solution<\/code>.<\/p>\n@@ -83,5 +48,1 @@\n-<p>The make system can generate generic native code indexing support in\n-the form of a <a\n-href=\"https:\/\/clang.llvm.org\/docs\/JSONCompilationDatabase.html\">Compilation\n-Database<\/a> that can be used by many different IDEs and source code\n-indexers.<\/p>\n+<p>The make system can generate generic native code indexing support in the form of a <a href=\"https:\/\/clang.llvm.org\/docs\/JSONCompilationDatabase.html\">Compilation Database<\/a> that can be used by many different IDEs and source code indexers.<\/p>\n@@ -89,3 +50,1 @@\n-<p>It's also possible to generate the Compilation Database for the\n-HotSpot source code only, which is a bit faster as it includes less\n-information.<\/p>\n+<p>It's also possible to generate the Compilation Database for the HotSpot source code only, which is a bit faster as it includes less information.<\/p>\n@@ -95,4 +54,1 @@\n-<p>The JDK project has a script that can be used for indexing the\n-project with IntelliJ. After configuring and building the JDK, an\n-IntelliJ workspace can be generated by running the following command in\n-the top-level folder of the cloned repository:<\/p>\n+<p>The JDK project has a script that can be used for indexing the project with IntelliJ. After configuring and building the JDK, an IntelliJ workspace can be generated by running the following command in the top-level folder of the cloned repository:<\/p>\n@@ -100,8 +56,3 @@\n-<p>To use it, choose <code>File -&gt; Open...<\/code> in IntelliJ and\n-select the folder where you ran the above script.<\/p>\n-<p>Next, configure the project SDK in IntelliJ. Open\n-<code>File -&gt; Project Structure -&gt; Project<\/code> and select\n-<code>build\/&lt;config&gt;\/images\/jdk<\/code> as the SDK to use.<\/p>\n-<p>In order to run the tests from the IDE, you can use the JTReg plugin.\n-Instructions for building and using the plugin can be found <a\n-href=\"https:\/\/github.com\/openjdk\/jtreg\/tree\/master\/plugins\/idea\">here<\/a>.<\/p>\n+<p>To use it, choose <code>File -&gt; Open...<\/code> in IntelliJ and select the folder where you ran the above script.<\/p>\n+<p>Next, configure the project SDK in IntelliJ. Open <code>File -&gt; Project Structure -&gt; Project<\/code> and select <code>build\/&lt;config&gt;\/images\/jdk<\/code> as the SDK to use.<\/p>\n+<p>In order to run the tests from the IDE, you can use the JTReg plugin. Instructions for building and using the plugin can be found <a href=\"https:\/\/github.com\/openjdk\/jtreg\/tree\/master\/plugins\/idea\">here<\/a>.<\/p>\n","filename":"doc\/ide.html","additions":23,"deletions":72,"binary":false,"changes":95,"status":"modified"},{"patch":"@@ -8,13 +8,5 @@\n-  <style>\n-    code{white-space: pre-wrap;}\n-    span.smallcaps{font-variant: small-caps;}\n-    div.columns{display: flex; gap: min(4vw, 1.5em);}\n-    div.column{flex: auto; overflow-x: auto;}\n-    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}\n-    ul.task-list{list-style: none;}\n-    ul.task-list li input[type=\"checkbox\"] {\n-      width: 0.8em;\n-      margin: 0 0.8em 0.2em -1.6em;\n-      vertical-align: middle;\n-    }\n-    .display.math{display: block; text-align: center; margin: 0.5rem auto;}\n+  <style type=\"text\/css\">\n+      code{white-space: pre-wrap;}\n+      span.smallcaps{font-variant: small-caps;}\n+      span.underline{text-decoration: underline;}\n+      div.column{display: inline-block; vertical-align: top; width: 50%;}\n@@ -23,1 +15,0 @@\n-  <style type=\"text\/css\">pre, code, tt { color: #1d6ae5; }<\/style>\n@@ -27,0 +18,1 @@\n+  <style type=\"text\/css\">pre, code, tt { color: #1d6ae5; }<\/style>\n@@ -32,6 +24,1 @@\n-<nav id=\"TOC\" role=\"doc-toc\">\n-<ul>\n-<li><a href=\"#overview\" id=\"toc-overview\">Overview<\/a><\/li>\n-<li><a href=\"#running-tests-locally-with-make-test\"\n-id=\"toc-running-tests-locally-with-make-test\">Running tests locally with\n-<code>make test<\/code><\/a>\n+<nav id=\"TOC\">\n@@ -39,2 +26,3 @@\n-<li><a href=\"#configuration\"\n-id=\"toc-configuration\">Configuration<\/a><\/li>\n+<li><a href=\"#overview\">Overview<\/a><\/li>\n+<li><a href=\"#running-tests-locally-with-make-test\">Running tests locally with <code>make test<\/code><\/a><ul>\n+<li><a href=\"#configuration\">Configuration<\/a><\/li>\n@@ -42,10 +30,6 @@\n-<li><a href=\"#test-selection\" id=\"toc-test-selection\">Test selection<\/a>\n-<ul>\n-<li><a href=\"#common-test-groups\" id=\"toc-common-test-groups\">Common\n-Test Groups<\/a><\/li>\n-<li><a href=\"#jtreg\" id=\"toc-jtreg\">JTReg<\/a><\/li>\n-<li><a href=\"#gtest\" id=\"toc-gtest\">Gtest<\/a><\/li>\n-<li><a href=\"#microbenchmarks\"\n-id=\"toc-microbenchmarks\">Microbenchmarks<\/a><\/li>\n-<li><a href=\"#special-tests\" id=\"toc-special-tests\">Special\n-tests<\/a><\/li>\n+<li><a href=\"#test-selection\">Test selection<\/a><ul>\n+<li><a href=\"#common-test-groups\">Common Test Groups<\/a><\/li>\n+<li><a href=\"#jtreg\">JTReg<\/a><\/li>\n+<li><a href=\"#gtest\">Gtest<\/a><\/li>\n+<li><a href=\"#microbenchmarks\">Microbenchmarks<\/a><\/li>\n+<li><a href=\"#special-tests\">Special tests<\/a><\/li>\n@@ -53,14 +37,6 @@\n-<li><a href=\"#test-results-and-summary\"\n-id=\"toc-test-results-and-summary\">Test results and summary<\/a><\/li>\n-<li><a href=\"#test-suite-control\" id=\"toc-test-suite-control\">Test suite\n-control<\/a>\n-<ul>\n-<li><a href=\"#general-keywords-test_opts\"\n-id=\"toc-general-keywords-test_opts\">General keywords\n-(TEST_OPTS)<\/a><\/li>\n-<li><a href=\"#jtreg-keywords\" id=\"toc-jtreg-keywords\">JTReg\n-keywords<\/a><\/li>\n-<li><a href=\"#gtest-keywords\" id=\"toc-gtest-keywords\">Gtest\n-keywords<\/a><\/li>\n-<li><a href=\"#microbenchmark-keywords\"\n-id=\"toc-microbenchmark-keywords\">Microbenchmark keywords<\/a><\/li>\n+<li><a href=\"#test-results-and-summary\">Test results and summary<\/a><\/li>\n+<li><a href=\"#test-suite-control\">Test suite control<\/a><ul>\n+<li><a href=\"#general-keywords-test_opts\">General keywords (TEST_OPTS)<\/a><\/li>\n+<li><a href=\"#jtreg-keywords\">JTReg keywords<\/a><\/li>\n+<li><a href=\"#gtest-keywords\">Gtest keywords<\/a><\/li>\n+<li><a href=\"#microbenchmark-keywords\">Microbenchmark keywords<\/a><\/li>\n@@ -68,9 +44,5 @@\n-<li><a href=\"#notes-for-specific-tests\"\n-id=\"toc-notes-for-specific-tests\">Notes for Specific Tests<\/a>\n-<ul>\n-<li><a href=\"#docker-tests\" id=\"toc-docker-tests\">Docker Tests<\/a><\/li>\n-<li><a href=\"#non-us-locale\" id=\"toc-non-us-locale\">Non-US\n-locale<\/a><\/li>\n-<li><a href=\"#pkcs11-tests\" id=\"toc-pkcs11-tests\">PKCS11 Tests<\/a><\/li>\n-<li><a href=\"#client-ui-tests\" id=\"toc-client-ui-tests\">Client UI\n-Tests<\/a><\/li>\n+<li><a href=\"#notes-for-specific-tests\">Notes for Specific Tests<\/a><ul>\n+<li><a href=\"#docker-tests\">Docker Tests<\/a><\/li>\n+<li><a href=\"#non-us-locale\">Non-US locale<\/a><\/li>\n+<li><a href=\"#pkcs11-tests\">PKCS11 Tests<\/a><\/li>\n+<li><a href=\"#client-ui-tests\">Client UI Tests<\/a><\/li>\n@@ -78,2 +50,1 @@\n-<li><a href=\"#editing-this-document\"\n-id=\"toc-editing-this-document\">Editing this document<\/a><\/li>\n+<li><a href=\"#editing-this-document\">Editing this document<\/a><\/li>\n@@ -83,10 +54,3 @@\n-<p>The bulk of JDK tests use <a\n-href=\"https:\/\/openjdk.org\/jtreg\/\">jtreg<\/a>, a regression test framework\n-and test runner built for the JDK's specific needs. Other test\n-frameworks are also used. The different test frameworks can be executed\n-directly, but there is also a set of make targets intended to simplify\n-the interface, and figure out how to run your tests for you.<\/p>\n-<h2 id=\"running-tests-locally-with-make-test\">Running tests locally with\n-<code>make test<\/code><\/h2>\n-<p>This is the easiest way to get started. Assuming you've built the JDK\n-locally, execute:<\/p>\n+<p>The bulk of JDK tests use <a href=\"https:\/\/openjdk.org\/jtreg\/\">jtreg<\/a>, a regression test framework and test runner built for the JDK's specific needs. Other test frameworks are also used. The different test frameworks can be executed directly, but there is also a set of make targets intended to simplify the interface, and figure out how to run your tests for you.<\/p>\n+<h2 id=\"running-tests-locally-with-make-test\">Running tests locally with <code>make test<\/code><\/h2>\n+<p>This is the easiest way to get started. Assuming you've built the JDK locally, execute:<\/p>\n@@ -94,7 +58,1 @@\n-<p>This will run a default set of tests against the JDK, and present you\n-with the results. <code>make test<\/code> is part of a family of\n-test-related make targets which simplify running tests, because they\n-invoke the various test frameworks for you. The \"make test framework\" is\n-simple to start with, but more complex ad-hoc combination of tests is\n-also possible. You can always invoke the test frameworks directly if you\n-want even more control.<\/p>\n+<p>This will run a default set of tests against the JDK, and present you with the results. <code>make test<\/code> is part of a family of test-related make targets which simplify running tests, because they invoke the various test frameworks for you. The &quot;make test framework&quot; is simple to start with, but more complex ad-hoc combination of tests is also possible. You can always invoke the test frameworks directly if you want even more control.<\/p>\n@@ -110,15 +68,2 @@\n-<p>\"tier1\" and \"tier2\" refer to tiered testing, see further down. \"TEST\"\n-is a test selection argument which the make test framework will use to\n-try to find the tests you want. It iterates over the available test\n-frameworks, and if the test isn't present in one, it tries the next one.\n-The main target <code>test<\/code> uses the jdk-image as the tested\n-product. There is also an alternate target <code>exploded-test<\/code>\n-that uses the exploded image instead. Not all tests will run\n-successfully on the exploded image, but using this target can greatly\n-improve rebuild times for certain workflows.<\/p>\n-<p>Previously, <code>make test<\/code> was used to invoke an old system\n-for running tests, and <code>make run-test<\/code> was used for the new\n-test framework. For backward compatibility with scripts and muscle\n-memory, <code>run-test<\/code> and variants like\n-<code>exploded-run-test<\/code> or <code>run-test-tier1<\/code> are kept\n-as aliases.<\/p>\n+<p>&quot;tier1&quot; and &quot;tier2&quot; refer to tiered testing, see further down. &quot;TEST&quot; is a test selection argument which the make test framework will use to try to find the tests you want. It iterates over the available test frameworks, and if the test isn't present in one, it tries the next one. The main target <code>test<\/code> uses the jdk-image as the tested product. There is also an alternate target <code>exploded-test<\/code> that uses the exploded image instead. Not all tests will run successfully on the exploded image, but using this target can greatly improve rebuild times for certain workflows.<\/p>\n+<p>Previously, <code>make test<\/code> was used to invoke an old system for running tests, and <code>make run-test<\/code> was used for the new test framework. For backward compatibility with scripts and muscle memory, <code>run-test<\/code> and variants like <code>exploded-run-test<\/code> or <code>run-test-tier1<\/code> are kept as aliases.<\/p>\n@@ -126,33 +71,3 @@\n-<p>To be able to run JTReg tests, <code>configure<\/code> needs to know\n-where to find the JTReg test framework. If it is not picked up\n-automatically by configure, use the\n-<code>--with-jtreg=&lt;path to jtreg home&gt;<\/code> option to point to\n-the JTReg framework. Note that this option should point to the JTReg\n-home, i.e. the top directory, containing <code>lib\/jtreg.jar<\/code> etc.\n-(An alternative is to set the <code>JT_HOME<\/code> environment variable\n-to point to the JTReg home before running <code>configure<\/code>.)<\/p>\n-<p>To be able to run microbenchmarks, <code>configure<\/code> needs to\n-know where to find the JMH dependency. Use\n-<code>--with-jmh=&lt;path to JMH jars&gt;<\/code> to point to a directory\n-containing the core JMH and transitive dependencies. The recommended\n-dependencies can be retrieved by running\n-<code>sh make\/devkit\/createJMHBundle.sh<\/code>, after which\n-<code>--with-jmh=build\/jmh\/jars<\/code> should work.<\/p>\n-<p>When tests fail or timeout, jtreg runs its failure handler to capture\n-necessary data from the system where the test was run. This data can\n-then be used to analyze the test failures. Collecting this data involves\n-running various commands (which are listed in files residing in\n-<code>test\/failure_handler\/src\/share\/conf<\/code>) and some of these\n-commands use <code>sudo<\/code>. If the system's <code>sudoers<\/code>\n-file isn't configured to allow running these commands, then it can\n-result in password being prompted during the failure handler execution.\n-Typically, when running locally, collecting this additional data isn't\n-always necessary. To disable running the failure handler, use\n-<code>--enable-jtreg-failure-handler=no<\/code> when running\n-<code>configure<\/code>. If, however, you want to let the failure handler\n-to run and don't want to be prompted for sudo password, then you can\n-configure your <code>sudoers<\/code> file appropriately. Please read the\n-necessary documentation of your operating system to see how to do that;\n-here we only show one possible way of doing that - edit the\n-<code>\/etc\/sudoers.d\/sudoers<\/code> file to include the following\n-line:<\/p>\n+<p>To be able to run JTReg tests, <code>configure<\/code> needs to know where to find the JTReg test framework. If it is not picked up automatically by configure, use the <code>--with-jtreg=&lt;path to jtreg home&gt;<\/code> option to point to the JTReg framework. Note that this option should point to the JTReg home, i.e. the top directory, containing <code>lib\/jtreg.jar<\/code> etc. (An alternative is to set the <code>JT_HOME<\/code> environment variable to point to the JTReg home before running <code>configure<\/code>.)<\/p>\n+<p>To be able to run microbenchmarks, <code>configure<\/code> needs to know where to find the JMH dependency. Use <code>--with-jmh=&lt;path to JMH jars&gt;<\/code> to point to a directory containing the core JMH and transitive dependencies. The recommended dependencies can be retrieved by running <code>sh make\/devkit\/createJMHBundle.sh<\/code>, after which <code>--with-jmh=build\/jmh\/jars<\/code> should work.<\/p>\n+<p>When tests fail or timeout, jtreg runs its failure handler to capture necessary data from the system where the test was run. This data can then be used to analyze the test failures. Collecting this data involves running various commands (which are listed in files residing in <code>test\/failure_handler\/src\/share\/conf<\/code>) and some of these commands use <code>sudo<\/code>. If the system's <code>sudoers<\/code> file isn't configured to allow running these commands, then it can result in password being prompted during the failure handler execution. Typically, when running locally, collecting this additional data isn't always necessary. To disable running the failure handler, use <code>--enable-jtreg-failure-handler=no<\/code> when running <code>configure<\/code>. If, however, you want to let the failure handler to run and don't want to be prompted for sudo password, then you can configure your <code>sudoers<\/code> file appropriately. Please read the necessary documentation of your operating system to see how to do that; here we only show one possible way of doing that - edit the <code>\/etc\/sudoers.d\/sudoers<\/code> file to include the following line:<\/p>\n@@ -160,7 +75,1 @@\n-<p>This line configures <code>sudo<\/code> to <em>not<\/em> prompt for\n-password for the <code>\/sbin\/dmesg<\/code> command (this is one of the\n-commands that is listed in the files at\n-<code>test\/failure_handler\/src\/share\/conf<\/code>), for the user\n-<code>johndoe<\/code>. Here <code>johndoe<\/code> is the user account\n-under which the jtreg tests are run. Replace the username with a\n-relevant user account of your system.<\/p>\n+<p>This line configures <code>sudo<\/code> to <em>not<\/em> prompt for password for the <code>\/sbin\/dmesg<\/code> command (this is one of the commands that is listed in the files at <code>test\/failure_handler\/src\/share\/conf<\/code>), for the user <code>johndoe<\/code>. Here <code>johndoe<\/code> is the user account under which the jtreg tests are run. Replace the username with a relevant user account of your system.<\/p>\n@@ -168,18 +77,3 @@\n-<p>All functionality is available using the <code>test<\/code> make\n-target. In this use case, the test or tests to be executed is controlled\n-using the <code>TEST<\/code> variable. To speed up subsequent test runs\n-with no source code changes, <code>test-only<\/code> can be used instead,\n-which do not depend on the source and test image build.<\/p>\n-<p>For some common top-level tests, direct make targets have been\n-generated. This includes all JTReg test groups, the hotspot gtest, and\n-custom tests (if present). This means that <code>make test-tier1<\/code>\n-is equivalent to <code>make test TEST=\"tier1\"<\/code>, but the latter is\n-more tab-completion friendly. For more complex test runs, the\n-<code>test TEST=\"x\"<\/code> solution needs to be used.<\/p>\n-<p>The test specifications given in <code>TEST<\/code> is parsed into\n-fully qualified test descriptors, which clearly and unambigously show\n-which tests will be run. As an example, <code>:tier1<\/code> will expand\n-to\n-<code>jtreg:$(TOPDIR)\/test\/hotspot\/jtreg:tier1 jtreg:$(TOPDIR)\/test\/jdk:tier1 jtreg:$(TOPDIR)\/test\/langtools:tier1 jtreg:$(TOPDIR)\/test\/nashorn:tier1 jtreg:$(TOPDIR)\/test\/jaxp:tier1<\/code>.\n-You can always submit a list of fully qualified test descriptors in the\n-<code>TEST<\/code> variable if you want to shortcut the parser.<\/p>\n+<p>All functionality is available using the <code>test<\/code> make target. In this use case, the test or tests to be executed is controlled using the <code>TEST<\/code> variable. To speed up subsequent test runs with no source code changes, <code>test-only<\/code> can be used instead, which do not depend on the source and test image build.<\/p>\n+<p>For some common top-level tests, direct make targets have been generated. This includes all JTReg test groups, the hotspot gtest, and custom tests (if present). This means that <code>make test-tier1<\/code> is equivalent to <code>make test TEST=&quot;tier1&quot;<\/code>, but the latter is more tab-completion friendly. For more complex test runs, the <code>test TEST=&quot;x&quot;<\/code> solution needs to be used.<\/p>\n+<p>The test specifications given in <code>TEST<\/code> is parsed into fully qualified test descriptors, which clearly and unambigously show which tests will be run. As an example, <code>:tier1<\/code> will expand to <code>jtreg:$(TOPDIR)\/test\/hotspot\/jtreg:tier1 jtreg:$(TOPDIR)\/test\/jdk:tier1 jtreg:$(TOPDIR)\/test\/langtools:tier1 jtreg:$(TOPDIR)\/test\/nashorn:tier1 jtreg:$(TOPDIR)\/test\/jaxp:tier1<\/code>. You can always submit a list of fully qualified test descriptors in the <code>TEST<\/code> variable if you want to shortcut the parser.<\/p>\n@@ -187,21 +81,5 @@\n-<p>Ideally, all tests are run for every change but this may not be\n-practical due to the limited testing resources, the scope of the change,\n-etc.<\/p>\n-<p>The source tree currently defines a few common test groups in the\n-relevant <code>TEST.groups<\/code> files. There are test groups that\n-cover a specific component, for example <code>hotspot_gc<\/code>. It is a\n-good idea to look into <code>TEST.groups<\/code> files to get a sense\n-what tests are relevant to a particular JDK component.<\/p>\n-<p>Component-specific tests may miss some unintended consequences of a\n-change, so other tests should also be run. Again, it might be\n-impractical to run all tests, and therefore <em>tiered<\/em> test groups\n-exist. Tiered test groups are not component-specific, but rather cover\n-the significant parts of the entire JDK.<\/p>\n-<p>Multiple tiers allow balancing test coverage and testing costs. Lower\n-test tiers are supposed to contain the simpler, quicker and more stable\n-tests. Higher tiers are supposed to contain progressively more thorough,\n-slower, and sometimes less stable tests, or the tests that require\n-special configuration.<\/p>\n-<p>Contributors are expected to run the tests for the areas that are\n-changed, and the first N tiers they can afford to run, but at least\n-tier1.<\/p>\n+<p>Ideally, all tests are run for every change but this may not be practical due to the limited testing resources, the scope of the change, etc.<\/p>\n+<p>The source tree currently defines a few common test groups in the relevant <code>TEST.groups<\/code> files. There are test groups that cover a specific component, for example <code>hotspot_gc<\/code>. It is a good idea to look into <code>TEST.groups<\/code> files to get a sense what tests are relevant to a particular JDK component.<\/p>\n+<p>Component-specific tests may miss some unintended consequences of a change, so other tests should also be run. Again, it might be impractical to run all tests, and therefore <em>tiered<\/em> test groups exist. Tiered test groups are not component-specific, but rather cover the significant parts of the entire JDK.<\/p>\n+<p>Multiple tiers allow balancing test coverage and testing costs. Lower test tiers are supposed to contain the simpler, quicker and more stable tests. Higher tiers are supposed to contain progressively more thorough, slower, and sometimes less stable tests, or the tests that require special configuration.<\/p>\n+<p>Contributors are expected to run the tests for the areas that are changed, and the first N tiers they can afford to run, but at least tier1.<\/p>\n@@ -210,23 +88,4 @@\n-<li><p><code>tier1<\/code>: This is the lowest test tier. Multiple\n-developers run these tests every day. Because of the widespread use, the\n-tests in <code>tier1<\/code> are carefully selected and optimized to run\n-fast, and to run in the most stable manner. The test failures in\n-<code>tier1<\/code> are usually followed up on quickly, either with\n-fixes, or adding relevant tests to problem list. GitHub Actions\n-workflows, if enabled, run <code>tier1<\/code> tests.<\/p><\/li>\n-<li><p><code>tier2<\/code>: This test group covers even more ground.\n-These contain, among other things, tests that either run for too long to\n-be at <code>tier1<\/code>, or may require special configuration, or tests\n-that are less stable, or cover the broader range of non-core JVM and JDK\n-features\/components(for example, XML).<\/p><\/li>\n-<li><p><code>tier3<\/code>: This test group includes more stressful\n-tests, the tests for corner cases not covered by previous tiers, plus\n-the tests that require GUIs. As such, this suite should either be run\n-with low concurrency (<code>TEST_JOBS=1<\/code>), or without headful\n-tests(<code>JTREG_KEYWORDS=\\!headful<\/code>), or both.<\/p><\/li>\n-<li><p><code>tier4<\/code>: This test group includes every other test not\n-covered by previous tiers. It includes, for example,\n-<code>vmTestbase<\/code> suites for Hotspot, which run for many hours\n-even on large machines. It also runs GUI tests, so the same\n-<code>TEST_JOBS<\/code> and <code>JTREG_KEYWORDS<\/code> caveats\n-apply.<\/p><\/li>\n+<li><p><code>tier1<\/code>: This is the lowest test tier. Multiple developers run these tests every day. Because of the widespread use, the tests in <code>tier1<\/code> are carefully selected and optimized to run fast, and to run in the most stable manner. The test failures in <code>tier1<\/code> are usually followed up on quickly, either with fixes, or adding relevant tests to problem list. GitHub Actions workflows, if enabled, run <code>tier1<\/code> tests.<\/p><\/li>\n+<li><p><code>tier2<\/code>: This test group covers even more ground. These contain, among other things, tests that either run for too long to be at <code>tier1<\/code>, or may require special configuration, or tests that are less stable, or cover the broader range of non-core JVM and JDK features\/components(for example, XML).<\/p><\/li>\n+<li><p><code>tier3<\/code>: This test group includes more stressful tests, the tests for corner cases not covered by previous tiers, plus the tests that require GUIs. As such, this suite should either be run with low concurrency (<code>TEST_JOBS=1<\/code>), or without headful tests(<code>JTREG_KEYWORDS=\\!headful<\/code>), or both.<\/p><\/li>\n+<li><p><code>tier4<\/code>: This test group includes every other test not covered by previous tiers. It includes, for example, <code>vmTestbase<\/code> suites for Hotspot, which run for many hours even on large machines. It also runs GUI tests, so the same <code>TEST_JOBS<\/code> and <code>JTREG_KEYWORDS<\/code> caveats apply.<\/p><\/li>\n@@ -235,32 +94,5 @@\n-<p>JTReg tests can be selected either by picking a JTReg test group, or\n-a selection of files or directories containing JTReg tests.\n-Documentation can be found at <a\n-href=\"https:\/\/openjdk.org\/jtreg\/\">https:\/\/openjdk.org\/jtreg\/<\/a>, note\n-especially the extensive <a\n-href=\"https:\/\/openjdk.org\/jtreg\/faq.html\">FAQ<\/a>.<\/p>\n-<p>JTReg test groups can be specified either without a test root, e.g.\n-<code>:tier1<\/code> (or <code>tier1<\/code>, the initial colon is\n-optional), or with, e.g. <code>hotspot:tier1<\/code>,\n-<code>test\/jdk:jdk_util<\/code> or\n-<code>$(TOPDIR)\/test\/hotspot\/jtreg:hotspot_all<\/code>. The test root can\n-be specified either as an absolute path, or a path relative to the JDK\n-top directory, or the <code>test<\/code> directory. For simplicity, the\n-hotspot JTReg test root, which really is <code>hotspot\/jtreg<\/code> can\n-be abbreviated as just <code>hotspot<\/code>.<\/p>\n-<p>When specified without a test root, all matching groups from all test\n-roots will be added. Otherwise, only the group from the specified test\n-root will be added.<\/p>\n-<p>Individual JTReg tests or directories containing JTReg tests can also\n-be specified, like\n-<code>test\/hotspot\/jtreg\/native_sanity\/JniVersion.java<\/code> or\n-<code>hotspot\/jtreg\/native_sanity<\/code>. Just like for test root\n-selection, you can either specify an absolute path (which can even point\n-to JTReg tests outside the source tree), or a path relative to either\n-the JDK top directory or the <code>test<\/code> directory.\n-<code>hotspot<\/code> can be used as an alias for\n-<code>hotspot\/jtreg<\/code> here as well.<\/p>\n-<p>As long as the test groups or test paths can be uniquely resolved,\n-you do not need to enter the <code>jtreg:<\/code> prefix. If this is not\n-possible, or if you want to use a fully qualified test descriptor, add\n-<code>jtreg:<\/code>, e.g.\n-<code>jtreg:test\/hotspot\/jtreg\/native_sanity<\/code>.<\/p>\n+<p>JTReg tests can be selected either by picking a JTReg test group, or a selection of files or directories containing JTReg tests. Documentation can be found at <a href=\"https:\/\/openjdk.org\/jtreg\/\">https:\/\/openjdk.org\/jtreg\/<\/a>, note especially the extensive <a href=\"https:\/\/openjdk.org\/jtreg\/faq.html\">FAQ<\/a>.<\/p>\n+<p>JTReg test groups can be specified either without a test root, e.g. <code>:tier1<\/code> (or <code>tier1<\/code>, the initial colon is optional), or with, e.g. <code>hotspot:tier1<\/code>, <code>test\/jdk:jdk_util<\/code> or <code>$(TOPDIR)\/test\/hotspot\/jtreg:hotspot_all<\/code>. The test root can be specified either as an absolute path, or a path relative to the JDK top directory, or the <code>test<\/code> directory. For simplicity, the hotspot JTReg test root, which really is <code>hotspot\/jtreg<\/code> can be abbreviated as just <code>hotspot<\/code>.<\/p>\n+<p>When specified without a test root, all matching groups from all test roots will be added. Otherwise, only the group from the specified test root will be added.<\/p>\n+<p>Individual JTReg tests or directories containing JTReg tests can also be specified, like <code>test\/hotspot\/jtreg\/native_sanity\/JniVersion.java<\/code> or <code>hotspot\/jtreg\/native_sanity<\/code>. Just like for test root selection, you can either specify an absolute path (which can even point to JTReg tests outside the source tree), or a path relative to either the JDK top directory or the <code>test<\/code> directory. <code>hotspot<\/code> can be used as an alias for <code>hotspot\/jtreg<\/code> here as well.<\/p>\n+<p>As long as the test groups or test paths can be uniquely resolved, you do not need to enter the <code>jtreg:<\/code> prefix. If this is not possible, or if you want to use a fully qualified test descriptor, add <code>jtreg:<\/code>, e.g. <code>jtreg:test\/hotspot\/jtreg\/native_sanity<\/code>.<\/p>\n@@ -268,19 +100,4 @@\n-<p><strong>Note:<\/strong> To be able to run the Gtest suite, you need to\n-configure your build to be able to find a proper version of the gtest\n-source. For details, see the section <a\n-href=\"building.html#running-tests\">\"Running Tests\" in the build\n-documentation<\/a>.<\/p>\n-<p>Since the Hotspot Gtest suite is so quick, the default is to run all\n-tests. This is specified by just <code>gtest<\/code>, or as a fully\n-qualified test descriptor <code>gtest:all<\/code>.<\/p>\n-<p>If you want, you can single out an individual test or a group of\n-tests, for instance <code>gtest:LogDecorations<\/code> or\n-<code>gtest:LogDecorations.level_test_vm<\/code>. This can be\n-particularly useful if you want to run a shaky test repeatedly.<\/p>\n-<p>For Gtest, there is a separate test suite for each JVM variant. The\n-JVM variant is defined by adding <code>\/&lt;variant&gt;<\/code> to the\n-test descriptor, e.g. <code>gtest:Log\/client<\/code>. If you specify no\n-variant, gtest will run once for each JVM variant present (e.g. server,\n-client). So if you only have the server JVM present, then\n-<code>gtest:all<\/code> will be equivalent to\n-<code>gtest:all\/server<\/code>.<\/p>\n+<p><strong>Note:<\/strong> To be able to run the Gtest suite, you need to configure your build to be able to find a proper version of the gtest source. For details, see the section <a href=\"building.html#running-tests\">&quot;Running Tests&quot; in the build documentation<\/a>.<\/p>\n+<p>Since the Hotspot Gtest suite is so quick, the default is to run all tests. This is specified by just <code>gtest<\/code>, or as a fully qualified test descriptor <code>gtest:all<\/code>.<\/p>\n+<p>If you want, you can single out an individual test or a group of tests, for instance <code>gtest:LogDecorations<\/code> or <code>gtest:LogDecorations.level_test_vm<\/code>. This can be particularly useful if you want to run a shaky test repeatedly.<\/p>\n+<p>For Gtest, there is a separate test suite for each JVM variant. The JVM variant is defined by adding <code>\/&lt;variant&gt;<\/code> to the test descriptor, e.g. <code>gtest:Log\/client<\/code>. If you specify no variant, gtest will run once for each JVM variant present (e.g. server, client). So if you only have the server JVM present, then <code>gtest:all<\/code> will be equivalent to <code>gtest:all\/server<\/code>.<\/p>\n@@ -288,8 +105,2 @@\n-<p>Which microbenchmarks to run is selected using a regular expression\n-following the <code>micro:<\/code> test descriptor, e.g.,\n-<code>micro:java.lang.reflect<\/code>. This delegates the test selection\n-to JMH, meaning package name, class name and even benchmark method names\n-can be used to select tests.<\/p>\n-<p>Using special characters like <code>|<\/code> in the regular\n-expression is possible, but needs to be escaped multiple times:\n-<code>micro:ArrayCopy\\\\\\\\\\|reflect<\/code>.<\/p>\n+<p>Which microbenchmarks to run is selected using a regular expression following the <code>micro:<\/code> test descriptor, e.g., <code>micro:java.lang.reflect<\/code>. This delegates the test selection to JMH, meaning package name, class name and even benchmark method names can be used to select tests.<\/p>\n+<p>Using special characters like <code>|<\/code> in the regular expression is possible, but needs to be escaped multiple times: <code>micro:ArrayCopy\\\\\\\\\\|reflect<\/code>.<\/p>\n@@ -297,4 +108,1 @@\n-<p>A handful of odd tests that are not covered by any other testing\n-framework are accessible using the <code>special:<\/code> test\n-descriptor. Currently, this includes <code>failure-handler<\/code> and\n-<code>make<\/code>.<\/p>\n+<p>A handful of odd tests that are not covered by any other testing framework are accessible using the <code>special:<\/code> test descriptor. Currently, this includes <code>failure-handler<\/code> and <code>make<\/code>.<\/p>\n@@ -302,11 +110,3 @@\n-<li><p>Failure handler testing is run using\n-<code>special:failure-handler<\/code> or just\n-<code>failure-handler<\/code> as test descriptor.<\/p><\/li>\n-<li><p>Tests for the build system, including both makefiles and related\n-functionality, is run using <code>special:make<\/code> or just\n-<code>make<\/code> as test descriptor. This is equivalent to\n-<code>special:make:all<\/code>.<\/p>\n-<p>A specific make test can be run by supplying it as argument, e.g.\n-<code>special:make:idea<\/code>. As a special syntax, this can also be\n-expressed as <code>make-idea<\/code>, which allows for command lines as\n-<code>make test-make-idea<\/code>.<\/p><\/li>\n+<li><p>Failure handler testing is run using <code>special:failure-handler<\/code> or just <code>failure-handler<\/code> as test descriptor.<\/p><\/li>\n+<li><p>Tests for the build system, including both makefiles and related functionality, is run using <code>special:make<\/code> or just <code>make<\/code> as test descriptor. This is equivalent to <code>special:make:all<\/code>.<\/p>\n+<p>A specific make test can be run by supplying it as argument, e.g. <code>special:make:idea<\/code>. As a special syntax, this can also be expressed as <code>make-idea<\/code>, which allows for command lines as <code>make test-make-idea<\/code>.<\/p><\/li>\n@@ -315,3 +115,1 @@\n-<p>At the end of the test run, a summary of all tests run will be\n-presented. This will have a consistent look, regardless of what test\n-suites were used. This is a sample summary:<\/p>\n+<p>At the end of the test run, a summary of all tests run will be presented. This will have a consistent look, regardless of what test suites were used. This is a sample summary:<\/p>\n@@ -327,20 +125,5 @@\n-<p>Tests where the number of TOTAL tests does not equal the number of\n-PASSed tests will be considered a test failure. These are marked with\n-the <code>&gt;&gt; ... &lt;&lt;<\/code> marker for easy\n-identification.<\/p>\n-<p>The classification of non-passed tests differs a bit between test\n-suites. In the summary, ERROR is used as a catch-all for tests that\n-neither passed nor are classified as failed by the framework. This might\n-indicate test framework error, timeout or other problems.<\/p>\n-<p>In case of test failures, <code>make test<\/code> will exit with a\n-non-zero exit value.<\/p>\n-<p>All tests have their result stored in\n-<code>build\/$BUILD\/test-results\/$TEST_ID<\/code>, where TEST_ID is a\n-path-safe conversion from the fully qualified test descriptor, e.g. for\n-<code>jtreg:jdk\/test:tier1<\/code> the TEST_ID is\n-<code>jtreg_jdk_test_tier1<\/code>. This path is also printed in the log\n-at the end of the test run.<\/p>\n-<p>Additional work data is stored in\n-<code>build\/$BUILD\/test-support\/$TEST_ID<\/code>. For some frameworks,\n-this directory might contain information that is useful in determining\n-the cause of a failed test.<\/p>\n+<p>Tests where the number of TOTAL tests does not equal the number of PASSed tests will be considered a test failure. These are marked with the <code>&gt;&gt; ... &lt;&lt;<\/code> marker for easy identification.<\/p>\n+<p>The classification of non-passed tests differs a bit between test suites. In the summary, ERROR is used as a catch-all for tests that neither passed nor are classified as failed by the framework. This might indicate test framework error, timeout or other problems.<\/p>\n+<p>In case of test failures, <code>make test<\/code> will exit with a non-zero exit value.<\/p>\n+<p>All tests have their result stored in <code>build\/$BUILD\/test-results\/$TEST_ID<\/code>, where TEST_ID is a path-safe conversion from the fully qualified test descriptor, e.g. for <code>jtreg:jdk\/test:tier1<\/code> the TEST_ID is <code>jtreg_jdk_test_tier1<\/code>. This path is also printed in the log at the end of the test run.<\/p>\n+<p>Additional work data is stored in <code>build\/$BUILD\/test-support\/$TEST_ID<\/code>. For some frameworks, this directory might contain information that is useful in determining the cause of a failed test.<\/p>\n@@ -348,26 +131,5 @@\n-<p>It is possible to control various aspects of the test suites using\n-make control variables.<\/p>\n-<p>These variables use a keyword=value approach to allow multiple values\n-to be set. So, for instance,\n-<code>JTREG=\"JOBS=1;TIMEOUT_FACTOR=8\"<\/code> will set the JTReg\n-concurrency level to 1 and the timeout factor to 8. This is equivalent\n-to setting <code>JTREG_JOBS=1 JTREG_TIMEOUT_FACTOR=8<\/code>, but using\n-the keyword format means that the <code>JTREG<\/code> variable is parsed\n-and verified for correctness, so <code>JTREG=\"TMIEOUT_FACTOR=8\"<\/code>\n-would give an error, while <code>JTREG_TMIEOUT_FACTOR=8<\/code> would\n-just pass unnoticed.<\/p>\n-<p>To separate multiple keyword=value pairs, use <code>;<\/code>\n-(semicolon). Since the shell normally eats <code>;<\/code>, the\n-recommended usage is to write the assignment inside qoutes, e.g.\n-<code>JTREG=\"...;...\"<\/code>. This will also make sure spaces are\n-preserved, as in\n-<code>JTREG=\"JAVA_OPTIONS=-XshowSettings -Xlog:gc+ref=debug\"<\/code>.<\/p>\n-<p>(Other ways are possible, e.g. using backslash:\n-<code>JTREG=JOBS=1\\;TIMEOUT_FACTOR=8<\/code>. Also, as a special\n-technique, the string <code>%20<\/code> will be replaced with space for\n-certain options, e.g.\n-<code>JTREG=JAVA_OPTIONS=-XshowSettings%20-Xlog:gc+ref=debug<\/code>.\n-This can be useful if you have layers of scripts and have trouble\n-getting proper quoting of command line arguments through.)<\/p>\n-<p>As far as possible, the names of the keywords have been standardized\n-between test suites.<\/p>\n+<p>It is possible to control various aspects of the test suites using make control variables.<\/p>\n+<p>These variables use a keyword=value approach to allow multiple values to be set. So, for instance, <code>JTREG=&quot;JOBS=1;TIMEOUT_FACTOR=8&quot;<\/code> will set the JTReg concurrency level to 1 and the timeout factor to 8. This is equivalent to setting <code>JTREG_JOBS=1 JTREG_TIMEOUT_FACTOR=8<\/code>, but using the keyword format means that the <code>JTREG<\/code> variable is parsed and verified for correctness, so <code>JTREG=&quot;TMIEOUT_FACTOR=8&quot;<\/code> would give an error, while <code>JTREG_TMIEOUT_FACTOR=8<\/code> would just pass unnoticed.<\/p>\n+<p>To separate multiple keyword=value pairs, use <code>;<\/code> (semicolon). Since the shell normally eats <code>;<\/code>, the recommended usage is to write the assignment inside qoutes, e.g. <code>JTREG=&quot;...;...&quot;<\/code>. This will also make sure spaces are preserved, as in <code>JTREG=&quot;JAVA_OPTIONS=-XshowSettings -Xlog:gc+ref=debug&quot;<\/code>.<\/p>\n+<p>(Other ways are possible, e.g. using backslash: <code>JTREG=JOBS=1\\;TIMEOUT_FACTOR=8<\/code>. Also, as a special technique, the string <code>%20<\/code> will be replaced with space for certain options, e.g. <code>JTREG=JAVA_OPTIONS=-XshowSettings%20-Xlog:gc+ref=debug<\/code>. This can be useful if you have layers of scripts and have trouble getting proper quoting of command line arguments through.)<\/p>\n+<p>As far as possible, the names of the keywords have been standardized between test suites.<\/p>\n@@ -375,7 +137,2 @@\n-<p>Some keywords are valid across different test suites. If you want to\n-run tests from multiple test suites, or just don't want to care which\n-test suite specific control variable to use, then you can use the\n-general TEST_OPTS control variable.<\/p>\n-<p>There are also some keywords that applies globally to the test runner\n-system, not to any specific test suites. These are also available as\n-TEST_OPTS keywords.<\/p>\n+<p>Some keywords are valid across different test suites. If you want to run tests from multiple test suites, or just don't want to care which test suite specific control variable to use, then you can use the general TEST_OPTS control variable.<\/p>\n+<p>There are also some keywords that applies globally to the test runner system, not to any specific test suites. These are also available as TEST_OPTS keywords.<\/p>\n@@ -393,14 +150,4 @@\n-<p>This keywords applies globally to the test runner system. If set to\n-<code>true<\/code>, it enables JCov coverage reporting for all tests run.\n-To be useful, the JDK under test must be run with a JDK built with JCov\n-instrumentation\n-(<code>configure --with-jcov=&lt;path to directory containing lib\/jcov.jar&gt;<\/code>,\n-<code>make jcov-image<\/code>).<\/p>\n-<p>The simplest way to run tests with JCov coverage report is to use the\n-special target <code>jcov-test<\/code> instead of <code>test<\/code>, e.g.\n-<code>make jcov-test TEST=jdk_lang<\/code>. This will make sure the JCov\n-image is built, and that JCov reporting is enabled.<\/p>\n-<p>The JCov report is stored in\n-<code>build\/$BUILD\/test-results\/jcov-output\/report<\/code>.<\/p>\n-<p>Please note that running with JCov reporting can be very memory\n-intensive.<\/p>\n+<p>This keywords applies globally to the test runner system. If set to <code>true<\/code>, it enables JCov coverage reporting for all tests run. To be useful, the JDK under test must be run with a JDK built with JCov instrumentation (<code>configure --with-jcov=&lt;path to directory containing lib\/jcov.jar&gt;<\/code>, <code>make jcov-image<\/code>).<\/p>\n+<p>The simplest way to run tests with JCov coverage report is to use the special target <code>jcov-test<\/code> instead of <code>test<\/code>, e.g. <code>make jcov-test TEST=jdk_lang<\/code>. This will make sure the JCov image is built, and that JCov reporting is enabled.<\/p>\n+<p>The JCov report is stored in <code>build\/$BUILD\/test-results\/jcov-output\/report<\/code>.<\/p>\n+<p>Please note that running with JCov reporting can be very memory intensive.<\/p>\n@@ -408,7 +155,2 @@\n-<p>While collecting code coverage with JCov, it is also possible to find\n-coverage for only recently changed code. JCOV_DIFF_CHANGESET specifies a\n-source revision. A textual report will be generated showing coverage of\n-the diff between the specified revision and the repository tip.<\/p>\n-<p>The report is stored in\n-<code>build\/$BUILD\/test-results\/jcov-output\/diff_coverage_report<\/code>\n-file.<\/p>\n+<p>While collecting code coverage with JCov, it is also possible to find coverage for only recently changed code. JCOV_DIFF_CHANGESET specifies a source revision. A textual report will be generated showing coverage of the diff between the specified revision and the repository tip.<\/p>\n+<p>The report is stored in <code>build\/$BUILD\/test-results\/jcov-output\/diff_coverage_report<\/code> file.<\/p>\n@@ -418,4 +160,1 @@\n-<p>Defaults to TEST_JOBS (if set by <code>--with-test-jobs=<\/code>),\n-otherwise it defaults to JOBS, except for Hotspot, where the default is\n-<em>number of CPU cores\/2<\/em>, but never more than <em>memory size in\n-GB\/2<\/em>.<\/p>\n+<p>Defaults to TEST_JOBS (if set by <code>--with-test-jobs=<\/code>), otherwise it defaults to JOBS, except for Hotspot, where the default is <em>number of CPU cores\/2<\/em>, but never more than <em>memory size in GB\/2<\/em>.<\/p>\n@@ -426,3 +165,1 @@\n-<p>Sets the argument <code>-timeoutHandlerTimeout<\/code> for JTReg. The\n-default value is 0. This is only valid if the failure handler is\n-built.<\/p>\n+<p>Sets the argument <code>-timeoutHandlerTimeout<\/code> for JTReg. The default value is 0. This is only valid if the failure handler is built.<\/p>\n@@ -434,2 +171,1 @@\n-<p>Set to <code>true<\/code> or <code>false<\/code>. If true, adds\n-<code>-ea -esa<\/code>. Defaults to true, except for hotspot.<\/p>\n+<p>Set to <code>true<\/code> or <code>false<\/code>. If true, adds <code>-ea -esa<\/code>. Defaults to true, except for hotspot.<\/p>\n@@ -443,6 +179,3 @@\n-<p>Limit memory consumption (<code>-Xmx<\/code> and\n-<code>-vmoption:-Xmx<\/code>, or none).<\/p>\n-<p>Limit memory consumption for JTReg test framework and VM under test.\n-Set to 0 to disable the limits.<\/p>\n-<p>Defaults to 512m, except for hotspot, where it defaults to 0 (no\n-limit).<\/p>\n+<p>Limit memory consumption (<code>-Xmx<\/code> and <code>-vmoption:-Xmx<\/code>, or none).<\/p>\n+<p>Limit memory consumption for JTReg test framework and VM under test. Set to 0 to disable the limits.<\/p>\n+<p>Defaults to 512m, except for hotspot, where it defaults to 0 (no limit).<\/p>\n@@ -450,2 +183,1 @@\n-<p>Set the property <code>javatest.maxOutputSize<\/code> for the\n-launcher, to change the default JTReg log limit.<\/p>\n+<p>Set the property <code>javatest.maxOutputSize<\/code> for the launcher, to change the default JTReg log limit.<\/p>\n@@ -453,4 +185,1 @@\n-<p>JTReg keywords sent to JTReg using <code>-k<\/code>. Please be careful\n-in making sure that spaces and special characters (like <code>!<\/code>)\n-are properly quoted. To avoid some issues, the special value\n-<code>%20<\/code> can be used instead of space.<\/p>\n+<p>JTReg keywords sent to JTReg using <code>-k<\/code>. Please be careful in making sure that spaces and special characters (like <code>!<\/code>) are properly quoted. To avoid some issues, the special value <code>%20<\/code> can be used instead of space.<\/p>\n@@ -458,7 +187,3 @@\n-<p>Use additional problem lists file or files, in addition to the\n-default ProblemList.txt located at the JTReg test roots.<\/p>\n-<p>If multiple file names are specified, they should be separated by\n-space (or, to help avoid quoting issues, the special value\n-<code>%20<\/code>).<\/p>\n-<p>The file names should be either absolute, or relative to the JTReg\n-test root of the tests to be run.<\/p>\n+<p>Use additional problem lists file or files, in addition to the default ProblemList.txt located at the JTReg test roots.<\/p>\n+<p>If multiple file names are specified, they should be separated by space (or, to help avoid quoting issues, the special value <code>%20<\/code>).<\/p>\n+<p>The file names should be either absolute, or relative to the JTReg test root of the tests to be run.<\/p>\n@@ -467,3 +192,1 @@\n-<p>Set to <code>true<\/code> or <code>false<\/code>. If <code>true<\/code>,\n-JTReg will use <code>-match:<\/code> option, otherwise\n-<code>-exclude:<\/code> will be used. Default is <code>false<\/code>.<\/p>\n+<p>Set to <code>true<\/code> or <code>false<\/code>. If <code>true<\/code>, JTReg will use <code>-match:<\/code> option, otherwise <code>-exclude:<\/code> will be used. Default is <code>false<\/code>.<\/p>\n@@ -472,2 +195,1 @@\n-<p>Use <code>JTREG=\"OPTIONS=--help all\"<\/code> to see all available\n-JTReg options.<\/p>\n+<p>Use <code>JTREG=&quot;OPTIONS=--help all&quot;<\/code> to see all available JTReg options.<\/p>\n@@ -475,2 +197,1 @@\n-<p>Additional Java options for running test classes (sent to JTReg as\n-<code>-javaoption<\/code>).<\/p>\n+<p>Additional Java options for running test classes (sent to JTReg as <code>-javaoption<\/code>).<\/p>\n@@ -478,4 +199,2 @@\n-<p>Additional Java options to be used when compiling and running classes\n-(sent to JTReg as <code>-vmoption<\/code>).<\/p>\n-<p>This option is only needed in special circumstances. To pass Java\n-options to your test classes, use <code>JAVA_OPTIONS<\/code>.<\/p>\n+<p>Additional Java options to be used when compiling and running classes (sent to JTReg as <code>-vmoption<\/code>).<\/p>\n+<p>This option is only needed in special circumstances. To pass Java options to your test classes, use <code>JAVA_OPTIONS<\/code>.<\/p>\n@@ -483,2 +202,1 @@\n-<p>Additional Java options that are sent to the java launcher that\n-starts the JTReg harness.<\/p>\n+<p>Additional Java options that are sent to the java launcher that starts the JTReg harness.<\/p>\n@@ -486,4 +204,1 @@\n-<p>Generate AOT modules before testing for the specified module, or set\n-of modules. If multiple modules are specified, they should be separated\n-by space (or, to help avoid quoting issues, the special value\n-<code>%20<\/code>).<\/p>\n+<p>Generate AOT modules before testing for the specified module, or set of modules. If multiple modules are specified, they should be separated by space (or, to help avoid quoting issues, the special value <code>%20<\/code>).<\/p>\n@@ -491,2 +206,1 @@\n-<p>Retry failed tests up to a set number of times, until they pass. This\n-allows to pass the tests with intermittent failures. Defaults to 0.<\/p>\n+<p>Retry failed tests up to a set number of times, until they pass. This allows to pass the tests with intermittent failures. Defaults to 0.<\/p>\n@@ -494,3 +208,1 @@\n-<p>Repeat the tests up to a set number of times, stopping at first\n-failure. This helps to reproduce intermittent test failures. Defaults to\n-0.<\/p>\n+<p>Repeat the tests up to a set number of times, stopping at first failure. This helps to reproduce intermittent test failures. Defaults to 0.<\/p>\n@@ -499,6 +211,2 @@\n-<p>The number of times to repeat the tests\n-(<code>--gtest_repeat<\/code>).<\/p>\n-<p>Default is 1. Set to -1 to repeat indefinitely. This can be\n-especially useful combined with\n-<code>OPTIONS=--gtest_break_on_failure<\/code> to reproduce an\n-intermittent problem.<\/p>\n+<p>The number of times to repeat the tests (<code>--gtest_repeat<\/code>).<\/p>\n+<p>Default is 1. Set to -1 to repeat indefinitely. This can be especially useful combined with <code>OPTIONS=--gtest_break_on_failure<\/code> to reproduce an intermittent problem.<\/p>\n@@ -507,2 +215,1 @@\n-<p>Use <code>GTEST=\"OPTIONS=--help\"<\/code> to see all available Gtest\n-options.<\/p>\n+<p>Use <code>GTEST=&quot;OPTIONS=--help&quot;<\/code> to see all available Gtest options.<\/p>\n@@ -510,4 +217,1 @@\n-<p>Generate AOT modules before testing for the specified module, or set\n-of modules. If multiple modules are specified, they should be separated\n-by space (or, to help avoid quoting issues, the special value\n-<code>%20<\/code>).<\/p>\n+<p>Generate AOT modules before testing for the specified module, or set of modules. If multiple modules are specified, they should be separated by space (or, to help avoid quoting issues, the special value <code>%20<\/code>).<\/p>\n@@ -516,2 +220,1 @@\n-<p>Override the number of benchmark forks to spawn. Same as specifying\n-<code>-f &lt;num&gt;<\/code>.<\/p>\n+<p>Override the number of benchmark forks to spawn. Same as specifying <code>-f &lt;num&gt;<\/code>.<\/p>\n@@ -519,2 +222,1 @@\n-<p>Number of measurement iterations per fork. Same as specifying\n-<code>-i &lt;num&gt;<\/code>.<\/p>\n+<p>Number of measurement iterations per fork. Same as specifying <code>-i &lt;num&gt;<\/code>.<\/p>\n@@ -522,2 +224,1 @@\n-<p>Amount of time to spend in each measurement iteration, in seconds.\n-Same as specifying <code>-r &lt;num&gt;<\/code><\/p>\n+<p>Amount of time to spend in each measurement iteration, in seconds. Same as specifying <code>-r &lt;num&gt;<\/code><\/p>\n@@ -525,2 +226,1 @@\n-<p>Number of warmup iterations to run before the measurement phase in\n-each fork. Same as specifying <code>-wi &lt;num&gt;<\/code>.<\/p>\n+<p>Number of warmup iterations to run before the measurement phase in each fork. Same as specifying <code>-wi &lt;num&gt;<\/code>.<\/p>\n@@ -528,2 +228,1 @@\n-<p>Amount of time to spend in each warmup iteration. Same as specifying\n-<code>-w &lt;num&gt;<\/code>.<\/p>\n+<p>Amount of time to spend in each warmup iteration. Same as specifying <code>-w &lt;num&gt;<\/code>.<\/p>\n@@ -531,4 +230,1 @@\n-<p>Specify to have the test run save a log of the values. Accepts the\n-same values as <code>-rff<\/code>, i.e., <code>text<\/code>,\n-<code>csv<\/code>, <code>scsv<\/code>, <code>json<\/code>, or\n-<code>latex<\/code>.<\/p>\n+<p>Specify to have the test run save a log of the values. Accepts the same values as <code>-rff<\/code>, i.e., <code>text<\/code>, <code>csv<\/code>, <code>scsv<\/code>, <code>json<\/code>, or <code>latex<\/code>.<\/p>\n@@ -536,2 +232,1 @@\n-<p>Additional VM arguments to provide to forked off VMs. Same as\n-<code>-jvmArgs &lt;args&gt;<\/code><\/p>\n+<p>Additional VM arguments to provide to forked off VMs. Same as <code>-jvmArgs &lt;args&gt;<\/code><\/p>\n@@ -542,4 +237,1 @@\n-<p>Docker tests with default parameters may fail on systems with glibc\n-versions not compatible with the one used in the default docker image\n-(e.g., Oracle Linux 7.6 for x86). For example, they pass on Ubuntu 16.04\n-but fail on Ubuntu 18.04 if run like this on x86:<\/p>\n+<p>Docker tests with default parameters may fail on systems with glibc versions not compatible with the one used in the default docker image (e.g., Oracle Linux 7.6 for x86). For example, they pass on Ubuntu 16.04 but fail on Ubuntu 18.04 if run like this on x86:<\/p>\n@@ -547,3 +239,1 @@\n-<p>To run these tests correctly, additional parameters for the correct\n-docker image are required on Ubuntu 18.04 by using\n-<code>JAVA_OPTIONS<\/code>.<\/p>\n+<p>To run these tests correctly, additional parameters for the correct docker image are required on Ubuntu 18.04 by using <code>JAVA_OPTIONS<\/code>.<\/p>\n@@ -554,6 +244,1 @@\n-<p>If your locale is non-US, some tests are likely to fail. To work\n-around this you can set the locale to US. On Unix platforms simply\n-setting <code>LANG=\"en_US\"<\/code> in the environment before running\n-tests should work. On Windows or MacOS, setting\n-<code>JTREG=\"VM_OPTIONS=-Duser.language=en -Duser.country=US\"<\/code>\n-helps for most, but not all test cases.<\/p>\n+<p>If your locale is non-US, some tests are likely to fail. To work around this you can set the locale to US. On Unix platforms simply setting <code>LANG=&quot;en_US&quot;<\/code> in the environment before running tests should work. On Windows or MacOS, setting <code>JTREG=&quot;VM_OPTIONS=-Duser.language=en -Duser.country=US&quot;<\/code> helps for most, but not all test cases.<\/p>\n@@ -564,8 +249,1 @@\n-<p>It is highly recommended to use the latest NSS version when running\n-PKCS11 tests. Improper NSS version may lead to unexpected failures which\n-are hard to diagnose. For example,\n-sun\/security\/pkcs11\/Secmod\/AddTrustedCert.java may fail on Ubuntu 18.04\n-with the default NSS version in the system. To run these tests\n-correctly, the system property <code>test.nss.lib.paths<\/code> is\n-required on Ubuntu 18.04 to specify the alternative NSS lib\n-directories.<\/p>\n+<p>It is highly recommended to use the latest NSS version when running PKCS11 tests. Improper NSS version may lead to unexpected failures which are hard to diagnose. For example, sun\/security\/pkcs11\/Secmod\/AddTrustedCert.java may fail on Ubuntu 18.04 with the default NSS version in the system. To run these tests correctly, the system property <code>test.nss.lib.paths<\/code> is required on Ubuntu 18.04 to specify the alternative NSS lib directories.<\/p>\n@@ -575,2 +253,1 @@\n-<p>For more notes about the PKCS11 tests, please refer to\n-test\/jdk\/sun\/security\/pkcs11\/README.<\/p>\n+<p>For more notes about the PKCS11 tests, please refer to test\/jdk\/sun\/security\/pkcs11\/README.<\/p>\n@@ -578,5 +255,1 @@\n-<p>Some Client UI tests use key sequences which may be reserved by the\n-operating system. Usually that causes the test failure. So it is highly\n-recommended to disable system key shortcuts prior testing. The steps to\n-access and disable system key shortcuts for various platforms are\n-provided below.<\/p>\n+<p>Some Client UI tests use key sequences which may be reserved by the operating system. Usually that causes the test failure. So it is highly recommended to disable system key shortcuts prior testing. The steps to access and disable system key shortcuts for various platforms are provided below.<\/p>\n@@ -584,10 +257,2 @@\n-<p>Choose Apple menu; System Preferences, click Keyboard, then click\n-Shortcuts; select or deselect desired shortcut.<\/p>\n-<p>For example,\n-test\/jdk\/javax\/swing\/TooltipManager\/JMenuItemToolTipKeyBindingsTest\/JMenuItemToolTipKeyBindingsTest.java\n-fails on MacOS because it uses <code>CTRL + F1<\/code> key sequence to\n-show or hide tooltip message but the key combination is reserved by the\n-operating system. To run the test correctly the default global key\n-shortcut should be disabled using the steps described above, and then\n-deselect \"Turn keyboard access on or off\" option which is responsible\n-for <code>CTRL + F1<\/code> combination.<\/p>\n+<p>Choose Apple menu; System Preferences, click Keyboard, then click Shortcuts; select or deselect desired shortcut.<\/p>\n+<p>For example, test\/jdk\/javax\/swing\/TooltipManager\/JMenuItemToolTipKeyBindingsTest\/JMenuItemToolTipKeyBindingsTest.java fails on MacOS because it uses <code>CTRL + F1<\/code> key sequence to show or hide tooltip message but the key combination is reserved by the operating system. To run the test correctly the default global key shortcut should be disabled using the steps described above, and then deselect &quot;Turn keyboard access on or off&quot; option which is responsible for <code>CTRL + F1<\/code> combination.<\/p>\n@@ -595,3 +260,1 @@\n-<p>Open the Activities overview and start typing Settings; Choose\n-Settings, click Devices, then click Keyboard; set or override desired\n-shortcut.<\/p>\n+<p>Open the Activities overview and start typing Settings; Choose Settings, click Devices, then click Keyboard; set or override desired shortcut.<\/p>\n@@ -599,5 +262,1 @@\n-<p>Type <code>gpedit<\/code> in the Search and then click Edit group\n-policy; navigate to User Configuration -&gt; Administrative Templates\n--&gt; Windows Components -&gt; File Explorer; in the right-side pane\n-look for \"Turn off Windows key hotkeys\" and double click on it; enable\n-or disable hotkeys.<\/p>\n+<p>Type <code>gpedit<\/code> in the Search and then click Edit group policy; navigate to User Configuration -&gt; Administrative Templates -&gt; Windows Components -&gt; File Explorer; in the right-side pane look for &quot;Turn off Windows key hotkeys&quot; and double click on it; enable or disable hotkeys.<\/p>\n@@ -606,4 +265,1 @@\n-<p>If you want to contribute changes to this document, edit\n-<code>doc\/testing.md<\/code> and then run\n-<code>make update-build-docs<\/code> to generate the same changes in\n-<code>doc\/testing.html<\/code>.<\/p>\n+<p>If you want to contribute changes to this document, edit <code>doc\/testing.md<\/code> and then run <code>make update-build-docs<\/code> to generate the same changes in <code>doc\/testing.html<\/code>.<\/p>\n","filename":"doc\/testing.html","additions":126,"deletions":470,"binary":false,"changes":596,"status":"modified"},{"patch":"@@ -128,15 +128,0 @@\n-# Setup the compilation of the javac server build tool. Technically, this is not\n-# really \"interim\" langtools, but just like it, it is needed henceforth for all\n-# java compilation using the interim compiler.\n-$(eval $(call SetupJavaCompilation, BUILD_JAVAC_SERVER, \\\n-    COMPILER := bootjdk, \\\n-    TARGET_RELEASE := $(TARGET_RELEASE_BOOTJDK), \\\n-    SRC := $(TOPDIR)\/make\/langtools\/tools, \\\n-    INCLUDES := javacserver, \\\n-    BIN := $(BUILDTOOLS_OUTPUTDIR)\/langtools_javacserver_classes, \\\n-))\n-\n-TARGETS += $(BUILD_JAVAC_SERVER)\n-\n-################################################################################\n-\n","filename":"make\/CompileInterimLangtools.gmk","additions":0,"deletions":15,"binary":false,"changes":15,"status":"modified"},{"patch":"@@ -327,1 +327,1 @@\n-\t    $(call PrepareJavacServer)\n+\t    $(call PrepareSmartJavac)\n@@ -342,1 +342,1 @@\n-\t    $(call CleanupJavacServer)\n+\t    $(call CleanupSmartJavac)\n@@ -354,1 +354,1 @@\n-\t$(call CleanupJavacServer)\n+\t$(call CleanupSmartJavac)\n@@ -367,1 +367,1 @@\n-\t$(call WaitForJavacServerFinish)\n+\t$(call WaitForSmartJavacFinish)\n@@ -371,1 +371,1 @@\n-\t$(call WaitForJavacServerFinish)\n+\t$(call WaitForSmartJavacFinish)\n","filename":"make\/Init.gmk","additions":5,"deletions":5,"binary":false,"changes":10,"status":"modified"},{"patch":"@@ -207,9 +207,0 @@\n-          ifneq ($$(filter $$(CONF), $$(matching_confs)), )\n-            # If we found an exact match, use that\n-            matching_confs := $$(CONF)\n-            # Don't repeat this output on make restarts caused by including\n-            # generated files.\n-            ifeq ($$(MAKE_RESTARTS),)\n-              $$(info Using exact match for CONF=$$(CONF) (other matches are possible))\n-            endif\n-          endif\n@@ -438,1 +429,1 @@\n-\t  +(cd $(COMPARE_BUILD_OUTPUTDIR) && .\/compare.sh -vv $(COMPARE_BUILD_COMP_OPTS) \\\n+\t  +(cd $(COMPARE_BUILD_OUTPUTDIR) && .\/compare.sh $(COMPARE_BUILD_COMP_OPTS) \\\n@@ -441,1 +432,1 @@\n-\t  +(cd $(COMPARE_BUILD_OUTPUTDIR) && .\/compare.sh -vv $(COMPARE_BUILD_COMP_OPTS) \\\n+\t  +(cd $(COMPARE_BUILD_OUTPUTDIR) && .\/compare.sh $(COMPARE_BUILD_COMP_OPTS) \\\n@@ -505,1 +496,1 @@\n-  define PrepareJavacServer\n+  define PrepareSmartJavac\n@@ -512,2 +503,2 @@\n-  define CleanupJavacServer\n-\t[ -f $(JAVAC_SERVER_DIR)\/server.port ] && $(ECHO) Stopping javac server && \\\n+  define CleanupSmartJavac\n+\t[ -f $(JAVAC_SERVER_DIR)\/server.port ] && $(ECHO) Stopping sjavac server && \\\n@@ -522,1 +513,1 @@\n-    define WaitForJavacServerFinish\n+    define WaitForSmartJavacFinish\n@@ -528,1 +519,1 @@\n-    define WaitForJavacServerFinish\n+    define WaitForSmartJavacFinish\n","filename":"make\/InitSupport.gmk","additions":7,"deletions":16,"binary":false,"changes":23,"status":"modified"},{"patch":"@@ -147,9 +147,0 @@\n-  elif test \"x$TOOLCHAIN_PATH\" != x; then\n-    UTIL_LOOKUP_PROGS(XCODEBUILD, xcodebuild, $TOOLCHAIN_PATH)\n-    if test \"x$XCODEBUILD\" != x; then\n-      XCODEBUILD_OUTPUT=`\"$XCODEBUILD\" -version 2>&1`\n-      if test $? -ne 0; then\n-        AC_MSG_WARN([Ignoring the located xcodebuild tool $XCODEBUILD due to an error: $XCODEBUILD_OUTPUT])\n-        XCODEBUILD=\n-      fi\n-    fi\n@@ -305,16 +296,0 @@\n-  AC_ARG_WITH([xcode-path], [AS_HELP_STRING([--with-xcode-path],\n-      [set up toolchain on Mac OS using a path to an Xcode installation])])\n-\n-  if test \"x$with_xcode_path\" != x; then\n-    if test \"x$OPENJDK_BUILD_OS\" = \"xmacosx\"; then\n-      UTIL_PREPEND_TO_PATH([TOOLCHAIN_PATH],\n-          $with_xcode_path\/Contents\/Developer\/Toolchains\/XcodeDefault.xctoolchain\/usr\/bin:$with_xcode_path\/Contents\/Developer\/usr\/bin)\n-    else\n-      AC_MSG_WARN([Option --with-xcode-path is only valid on Mac OS, ignoring.])\n-    fi\n-  fi\n-\n-  AC_MSG_CHECKING([for toolchain path])\n-  AC_MSG_RESULT([$TOOLCHAIN_PATH])\n-  AC_SUBST(TOOLCHAIN_PATH)\n-\n@@ -339,0 +314,4 @@\n+  AC_MSG_CHECKING([for toolchain path])\n+  AC_MSG_RESULT([$TOOLCHAIN_PATH])\n+  AC_SUBST(TOOLCHAIN_PATH)\n+\n","filename":"make\/autoconf\/basic.m4","additions":4,"deletions":25,"binary":false,"changes":29,"status":"modified"},{"patch":"@@ -26,5 +26,0 @@\n-###############################################################################\n-# It is recommended to use exactly this version of pandoc, especially for\n-# re-generating checked in html files\n-RECOMMENDED_PANDOC_VERSION=2.19.2\n-\n@@ -434,11 +429,3 @@\n-  if test \"x$PANDOC\" != x; then\n-    AC_MSG_CHECKING([for pandoc version])\n-    PANDOC_VERSION=`$PANDOC --version 2>&1 | $HEAD -1 | $CUT -d \" \" -f 2`\n-    AC_MSG_RESULT([$PANDOC_VERSION])\n-\n-    if test \"x$PANDOC_VERSION\" != x$RECOMMENDED_PANDOC_VERSION; then\n-      AC_MSG_WARN([pandoc is version $PANDOC_VERSION, not the recommended version $RECOMMENDED_PANDOC_VERSION])\n-    fi\n-\n-    PANDOC_MARKDOWN_FLAG=\"markdown\"\n-    AC_MSG_CHECKING([if the pandoc smart extension needs to be disabled for markdown])\n+  PANDOC_MARKDOWN_FLAG=\"markdown\"\n+  if test -n \"$PANDOC\"; then\n+    AC_MSG_CHECKING(if the pandoc smart extension needs to be disabled for markdown)\n@@ -451,0 +438,1 @@\n+  fi\n@@ -452,0 +440,1 @@\n+  if test -n \"$PANDOC\"; then\n@@ -456,1 +445,0 @@\n-\n","filename":"make\/autoconf\/basic_tools.m4","additions":5,"deletions":17,"binary":false,"changes":22,"status":"modified"},{"patch":"@@ -131,6 +131,1 @@\n-    # -gdwarf-4 and -gdwarf-aranges were introduced in clang 5.0\n-    GDWARF_FLAGS=\"-gdwarf-4 -gdwarf-aranges\"\n-    FLAGS_COMPILER_CHECK_ARGUMENTS(ARGUMENT: [${GDWARF_FLAGS}],\n-        IF_FALSE: [GDWARF_FLAGS=\"\"])\n-\n-    CFLAGS_DEBUG_SYMBOLS=\"-g ${GDWARF_FLAGS}\"\n+    CFLAGS_DEBUG_SYMBOLS=\"-g\"\n@@ -508,0 +503,7 @@\n+    if test \"x$ENABLE_CONFORMING_COMPILATION\" = xtrue; then\n+      # -Werror=pedantic is not equivalent to -pedantic-errors on gcc, if code that\n+      # conforms is desired both have to be set\n+      TOOLCHAIN_CFLAGS_JVM=\"$TOOLCHAIN_CFLAGS_JVM -pedantic-errors -Werror=pedantic\"\n+      TOOLCHAIN_CFLAGS_JDK=\"$TOOLCHAIN_CFLAGS_JDK -pedantic-errors -Werror=pedantic\"\n+    fi\n+\n@@ -531,0 +533,5 @@\n+    if test \"x$ENABLE_CONFORMING_COMPILATION\" = xtrue; then\n+      TOOLCHAIN_CFLAGS_JVM=\"$TOOLCHAIN_CFLAGS_JVM -pedantic-errors\"\n+      TOOLCHAIN_CFLAGS_JDK=\"$TOOLCHAIN_CFLAGS_JDK -pedantic-errors\"\n+    fi\n+\n@@ -540,0 +547,4 @@\n+    if test \"x$ENABLE_CONFORMING_COMPILATION\" = xtrue; then\n+      TOOLCHAIN_CFLAGS_JVM=\"$TOOLCHAIN_CFLAGS_JVM -permissive-\"\n+      TOOLCHAIN_CFLAGS_JDK=\"$TOOLCHAIN_CFLAGS_JDK -permissive-\"\n+    fi\n","filename":"make\/autoconf\/flags-cflags.m4","additions":17,"deletions":6,"binary":false,"changes":23,"status":"modified"},{"patch":"@@ -105,0 +105,8 @@\n+  # Should the compiler only accept code that strictly conforms to the standard used by\n+  # the build?\n+  UTIL_ARG_ENABLE(NAME: conforming-compilation, DEFAULT: false,\n+      RESULT: ENABLE_CONFORMING_COMPILATION,\n+      DESC: [enforce conforming code during compilation],\n+      CHECKING_MSG: [if compiler should enforce conforming code (conforming-compilation)])\n+  AC_SUBST(ENABLE_CONFORMING_COMPILATION)\n+\n","filename":"make\/autoconf\/jdk-options.m4","additions":8,"deletions":0,"binary":false,"changes":8,"status":"modified"},{"patch":"@@ -222,1 +222,1 @@\n-      $1_JAVAC := $$(INTERIM_LANGTOOLS_ARGS) -cp $(BUILDTOOLS_OUTPUTDIR)\/langtools_javacserver_classes javacserver.Main\n+      $1_JAVAC := $$(INTERIM_LANGTOOLS_ARGS) -m jdk.compiler.interim\/com.sun.tools.sjavac.Main\n","filename":"make\/common\/JavaCompilation.gmk","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -222,1 +222,1 @@\n-  $(if $(findstring $(LOG_LEVEL), trace), \\\n+  $(if $(findstring $(LOG_LEVEL),debug trace), \\\n","filename":"make\/common\/MakeBase.gmk","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -348,2 +348,1 @@\n-        $$($$($1_BASE)_DISABLED_WARNINGS_$(TOOLCHAIN_TYPE)_$$($1_FILENAME)) \\\n-        $$($$($1_BASE)_DISABLED_WARNINGS_$(TOOLCHAIN_TYPE)_$(OPENJDK_TARGET_OS)_$$($1_FILENAME)))\n+        $$($$($1_BASE)_DISABLED_WARNINGS_$(TOOLCHAIN_TYPE)_$$($1_FILENAME)))\n@@ -492,6 +491,0 @@\n-#   LDFLAGS_<toolchain> the linker flags to be used for the specified toolchain,\n-#       used both for C and C++.\n-#   LDFLAGS_<OS> the linker flags to be used for the specified target OS,\n-#       used both for C and C++.\n-#   LDFLAGS_<toolchain>_<OS> the linker flags to be used for the specified\n-#       toolchain and target OS, used both for C and C++.\n@@ -499,6 +492,0 @@\n-#   LIBS_<OS> the libraries to link to for the specified target OS,\n-#       used both for C and C++.\n-#   LIBS_<toolchain> the libraries to link to for the specified toolchain,\n-#       used both for C and C++.\n-#   LIBS_<OS>_<toolchain> the libraries to link to for the specified target\n-#       OS and toolchain, used both for C and C++.\n@@ -527,2 +514,0 @@\n-#   DISABLED_WARNINGS_<toolchain>_<OS> Disable the given warnings for the specified\n-#       toolchain and target OS\n@@ -531,2 +516,0 @@\n-#   DISABLED_WARNINGS_C_<toolchain>_<OS> Disable the given warnings for the specified\n-#       toolchain and target OS when compiling C code\n@@ -535,6 +518,0 @@\n-#   DISABLED_WARNINGS_CXX_<toolchain>_<OS> Disable the given warnings for the specified\n-#       toolchain and target OS when compiling C++ code\n-#   DISABLED_WARNINGS_<toolchain>_<filename> Disable the given warnings for the specified\n-#       toolchain when compiling the file specified by filename\n-#   DISABLED_WARNINGS_<toolchain>_<OS>_<filename> Disable the given warnings for the specified\n-#       toolchain and target OS when compiling the file specified by filename\n@@ -716,2 +693,2 @@\n-  # Pickup extra OPENJDK_TARGET_OS_TYPE, OPENJDK_TARGET_OS, TOOLCHAIN_TYPE and\n-  # OPENJDK_TARGET_OS plus OPENJDK_TARGET_CPU pair dependent variables for CFLAGS.\n+  # Pickup extra OPENJDK_TARGET_OS_TYPE, OPENJDK_TARGET_OS, and\/or OPENJDK_TARGET_OS plus\n+  # OPENJDK_TARGET_CPU pair dependent variables for CFLAGS.\n@@ -719,1 +696,0 @@\n-      $$($1_CFLAGS_$(TOOLCHAIN_TYPE)) \\\n@@ -721,1 +697,0 @@\n-\n@@ -738,5 +713,2 @@\n-  # Pickup extra OPENJDK_TARGET_OS_TYPE, OPENJDK_TARGET_OS and\/or TOOLCHAIN_TYPE\n-  # dependent variables for CXXFLAGS.\n-  $1_EXTRA_CXXFLAGS := $$($1_CXXFLAGS_$(OPENJDK_TARGET_OS_TYPE)) $$($1_CXXFLAGS_$(OPENJDK_TARGET_OS)) \\\n-      $$($1_CXXFLAGS_$(TOOLCHAIN_TYPE))\n-\n+  # Pickup extra OPENJDK_TARGET_OS_TYPE and\/or OPENJDK_TARGET_OS dependent variables for CXXFLAGS.\n+  $1_EXTRA_CXXFLAGS := $$($1_CXXFLAGS_$(OPENJDK_TARGET_OS_TYPE)) $$($1_CXXFLAGS_$(OPENJDK_TARGET_OS))\n@@ -785,3 +757,1 @@\n-        $$($1_DISABLED_WARNINGS_C_$(TOOLCHAIN_TYPE)) \\\n-        $$($1_DISABLED_WARNINGS_$(TOOLCHAIN_TYPE)_$(OPENJDK_TARGET_OS)) \\\n-        $$($1_DISABLED_WARNINGS_C_$(TOOLCHAIN_TYPE)_$(OPENJDK_TARGET_OS)))\n+        $$($1_DISABLED_WARNINGS_C_$(TOOLCHAIN_TYPE)))\n@@ -792,3 +762,1 @@\n-        $$($1_DISABLED_WARNINGS_CXX_$(TOOLCHAIN_TYPE)) \\\n-        $$($1_DISABLED_WARNINGS_$(TOOLCHAIN_TYPE)_$(OPENJDK_TARGET_OS)) \\\n-        $$($1_DISABLED_WARNINGS_CXX_$(TOOLCHAIN_TYPE)_$(OPENJDK_TARGET_OS)))\n+        $$($1_DISABLED_WARNINGS_CXX_$(TOOLCHAIN_TYPE)))\n@@ -1005,9 +973,4 @@\n-  # Pickup extra OPENJDK_TARGET_OS_TYPE, OPENJDK_TARGET_OS and TOOLCHAIN_TYPE\n-  # dependent variables for LDFLAGS and LIBS, and additionally the pair dependent\n-  # TOOLCHAIN_TYPE plus OPENJDK_TARGET_OS for LDFLAGS, or OPENJDK_TARGET_OS plus\n-  # TOOLCHAIN_TYPE for LIBS\n-  $1_EXTRA_LDFLAGS += $$($1_LDFLAGS_$(OPENJDK_TARGET_OS_TYPE)) $$($1_LDFLAGS_$(OPENJDK_TARGET_OS)) \\\n-      $$($1_LDFLAGS_$(TOOLCHAIN_TYPE)) $$($1_LDFLAGS_$(TOOLCHAIN_TYPE)_$(OPENJDK_TARGET_OS))\n-  $1_EXTRA_LIBS += $$($1_LIBS_$(OPENJDK_TARGET_OS_TYPE)) $$($1_LIBS_$(OPENJDK_TARGET_OS)) \\\n-      $$($1_LIBS_$(OPENJDK_TARGET_OS)_$(TOOLCHAIN_TYPE)) $$($1_LIBS_$(TOOLCHAIN_TYPE))\n-\n+  # Pickup extra OPENJDK_TARGET_OS_TYPE and\/or OPENJDK_TARGET_OS dependent variables\n+  # for LDFLAGS and LIBS\n+  $1_EXTRA_LDFLAGS += $$($1_LDFLAGS_$(OPENJDK_TARGET_OS_TYPE)) $$($1_LDFLAGS_$(OPENJDK_TARGET_OS))\n+  $1_EXTRA_LIBS += $$($1_LIBS_$(OPENJDK_TARGET_OS_TYPE)) $$($1_LIBS_$(OPENJDK_TARGET_OS))\n","filename":"make\/common\/NativeCompilation.gmk","additions":11,"deletions":48,"binary":false,"changes":59,"status":"modified"},{"patch":"@@ -1081,0 +1081,11 @@\n+    var pandoc_version;\n+    if (input.build_cpu == \"aarch64\") {\n+        if (input.build_os == \"macosx\") {\n+            pandoc_version = \"2.14.0.2+1.0\";\n+        } else {\n+            pandoc_version = \"2.5+1.0\";\n+        }\n+    } else {\n+        pandoc_version = \"2.3.1+1.0\";\n+    }\n+\n@@ -1194,1 +1205,1 @@\n-            revision: \"2.19.2+1.0\",\n+            revision: pandoc_version,\n","filename":"make\/conf\/jib-profiles.js","additions":12,"deletions":1,"binary":false,"changes":13,"status":"modified"},{"patch":"@@ -18,1 +18,1 @@\n-<!ATTLIST version unicodeVersion CDATA #FIXED \"15.0.0\" >\n+<!ATTLIST version unicodeVersion CDATA #FIXED \"14.0.0\" >\n","filename":"make\/data\/cldr\/common\/dtd\/ldmlSupplemental.dtd","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -1028,0 +1028,1 @@\n+\t\t\t\t\t<pattern type=\"1000000000000\" count=\"one\">0 billón<\/pattern>\n@@ -1029,0 +1030,1 @@\n+\t\t\t\t\t<pattern type=\"10000000000000\" count=\"one\">00 billones<\/pattern>\n@@ -1030,0 +1032,1 @@\n+\t\t\t\t\t<pattern type=\"100000000000000\" count=\"one\">000 billones<\/pattern>\n","filename":"make\/data\/cldr\/common\/main\/es_419.xml","additions":3,"deletions":0,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -646,0 +646,1 @@\n+\t\t\t\t\t<pattern type=\"1000000000000\" count=\"one\">0 billón<\/pattern>\n@@ -647,0 +648,1 @@\n+\t\t\t\t\t<pattern type=\"10000000000000\" count=\"one\">00 billones<\/pattern>\n@@ -648,0 +650,1 @@\n+\t\t\t\t\t<pattern type=\"100000000000000\" count=\"one\">000 billones<\/pattern>\n","filename":"make\/data\/cldr\/common\/main\/es_MX.xml","additions":3,"deletions":0,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -333,2 +333,1 @@\n-\t\t\t\t<usesMetazone to=\"2022-10-30 08:00\" from=\"1998-04-05 09:00\" mzone=\"Mexico_Pacific\"\/>\n-\t\t\t\t<usesMetazone from=\"2022-10-30 08:00\" mzone=\"America_Central\"\/>\n+\t\t\t\t<usesMetazone from=\"1998-04-05 09:00\" mzone=\"Mexico_Pacific\"\/>\n@@ -617,2 +616,1 @@\n-\t\t\t\t<usesMetazone to=\"2022-10-30 08:00\" from=\"1998-04-05 09:00\" mzone=\"America_Mountain\"\/>\n-\t\t\t\t<usesMetazone from=\"2022-10-30 08:00\" mzone=\"America_Central\"\/>\n+\t\t\t\t<usesMetazone from=\"1998-04-05 09:00\" mzone=\"America_Mountain\"\/>\n","filename":"make\/data\/cldr\/common\/supplemental\/metaZones.xml","additions":2,"deletions":4,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n-# Copyright (c) 2016, 2022, Oracle and\/or its affiliates. All rights reserved.\n+# Copyright (c) 2016, Oracle and\/or its affiliates. All rights reserved.\n@@ -27,0 +27,1 @@\n+sysThreadAvailableStackWithSlack\n","filename":"make\/data\/hotspot-symbols\/symbols-aix","additions":2,"deletions":1,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n-# Copyright (c) 2016, 2022, Oracle and\/or its affiliates. All rights reserved.\n+# Copyright (c) 2016, Oracle and\/or its affiliates. All rights reserved.\n@@ -28,0 +28,1 @@\n+sysThreadAvailableStackWithSlack\n","filename":"make\/data\/hotspot-symbols\/symbols-linux","additions":2,"deletions":1,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -29,1 +29,1 @@\n-JMH_VERSION=1.36\n+JMH_VERSION=1.35\n","filename":"make\/devkit\/createJMHBundle.sh","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -3,1 +3,1 @@\n-# Copyright (c) 2017, 2022, Oracle and\/or its affiliates. All rights reserved.\n+# Copyright (c) 2017, 2018, Oracle and\/or its affiliates. All rights reserved.\n@@ -34,1 +34,1 @@\n-PANDOC_VERSION=2.19.2\n+PANDOC_VERSION=2.3.1\n@@ -37,3 +37,0 @@\n-if [ $# = 1 ]; then\n-  TARGET_PLATFORM=\"$1\"\n-fi\n@@ -41,2 +38,0 @@\n-PANDOC_EXE=\"pandoc\"\n-PANDOC_PATH=\"bin\/$PANDOC_EXE\"\n@@ -44,4 +39,1 @@\n-  PANDOC_PLATFORM=linux-amd64\n-  PANDOC_SUFFIX=tar.gz\n-elif [[ $TARGET_PLATFORM == linux_aarch64 ]] ; then\n-  PANDOC_PLATFORM=linux-arm64\n+  PANDOC_PLATFORM=linux\n@@ -55,2 +47,0 @@\n-  PANDOC_EXE=\"pandoc.exe\"\n-  PANDOC_PATH=\"$PANDOC_EXE\"\n@@ -75,2 +65,6 @@\n-cp tmp\/pandoc-$PANDOC_VERSION\/$PANDOC_PATH pandoc\n-chmod +x pandoc\/$PANDOC_EXE\n+if [[ $TARGET_PLATFORM == windows_x64 ]] ; then\n+  cp tmp\/pandoc-$PANDOC_VERSION-$PANDOC_PLATFORM\/pandoc.exe pandoc\n+  chmod +x pandoc\/pandoc.exe\n+else\n+  cp tmp\/pandoc-$PANDOC_VERSION\/bin\/pandoc pandoc\n+fi\n","filename":"make\/devkit\/createPandocBundle.sh","additions":9,"deletions":15,"binary":false,"changes":24,"status":"modified"},{"patch":"@@ -162,0 +162,1 @@\n+    DISABLED_WARNINGS_gcc_templateTable.cpp := cast-function-type, \\\n","filename":"make\/hotspot\/lib\/CompileJvm.gmk","additions":1,"deletions":0,"binary":false,"changes":1,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n-# Copyright (c) 2013, 2022, Oracle and\/or its affiliates. All rights reserved.\n+# Copyright (c) 2013, 2020, Oracle and\/or its affiliates. All rights reserved.\n@@ -37,3 +37,1 @@\n-  ifneq ($(CREATING_BUILDJDK), true)\n-    include lib\/CompileGtest.gmk\n-  endif\n+  include lib\/CompileGtest.gmk\n","filename":"make\/hotspot\/lib\/CompileLibraries.gmk","additions":2,"deletions":4,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -0,0 +1,22 @@\n+<component name=\"ProjectRunConfigurationManager\">\n+  <configuration default=\"false\" name=\"sjavac\" type=\"Application\" factoryName=\"Application\">\n+    <extension name=\"coverage\" enabled=\"false\" merge=\"false\" sample_coverage=\"true\" runner=\"idea\" \/>\n+    <option name=\"MAIN_CLASS_NAME\" value=\"com.sun.tools.sjavac.Main\" \/>\n+    <option name=\"VM_PARAMETERS\" value='@XPATCH@ --add-exports=jdk.compiler\/com.sun.tools.sjavac=ALL-UNNAMED' \/>\n+    <option name=\"PROGRAM_PARAMETERS\" value=\"\" \/>\n+    <option name=\"WORKING_DIRECTORY\" value=\"file:\/\/$PROJECT_DIR$\" \/>\n+    <option name=\"ALTERNATIVE_JRE_PATH_ENABLED\" value=\"true\" \/>\n+    <option name=\"ALTERNATIVE_JRE_PATH\" value=\"@IDEA_TARGET_JDK@\" \/>\n+    <option name=\"ENABLE_SWING_INSPECTOR\" value=\"false\" \/>\n+    <option name=\"ENV_VARIABLES\" \/>\n+    <option name=\"PASS_PARENT_ENVS\" value=\"true\" \/>\n+    <module name=\"langtools\" \/>\n+    <envs \/>\n+    <RunnerSettings RunnerId=\"Run\" \/>\n+    <ConfigurationWrapper RunnerId=\"Run\" \/>\n+    <method>\n+      <option name=\"Make\" enabled=\"false\" \/>\n+      <option name=\"AntTarget\" enabled=\"true\" antfile=\"file:\/\/$PROJECT_DIR$\/make\/ide\/idea\/langtools\/build.xml\" target=\"build-all-classes\" \/>\n+    <\/method>\n+  <\/configuration>\n+<\/component>\n","filename":"make\/ide\/idea\/langtools\/template\/runConfigurations\/sjavac.xml","additions":22,"deletions":0,"binary":false,"changes":22,"status":"added"},{"patch":"@@ -62,0 +62,1 @@\n+tool.sjavac.main.class=com.sun.tools.sjavac.Main\n","filename":"make\/langtools\/build.properties","additions":1,"deletions":0,"binary":false,"changes":1,"status":"modified"},{"patch":"@@ -241,0 +241,1 @@\n+        <build-tool name=\"sjavac\"\/>\n","filename":"make\/langtools\/build.xml","additions":1,"deletions":0,"binary":false,"changes":1,"status":"modified"},{"patch":"@@ -1,58 +0,0 @@\n-\/*\n- * Copyright (c) 2012, 2022, Oracle and\/or its affiliates. All rights reserved.\n- * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n- *\n- * This code is free software; you can redistribute it and\/or modify it\n- * under the terms of the GNU General Public License version 2 only, as\n- * published by the Free Software Foundation.  Oracle designates this\n- * particular file as subject to the \"Classpath\" exception as provided\n- * by Oracle in the LICENSE file that accompanied this code.\n- *\n- * This code is distributed in the hope that it will be useful, but WITHOUT\n- * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n- * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n- * version 2 for more details (a copy is included in the LICENSE file that\n- * accompanied this code).\n- *\n- * You should have received a copy of the GNU General Public License version\n- * 2 along with this work; if not, write to the Free Software Foundation,\n- * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n- *\n- * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n- * or visit www.oracle.com if you need additional information or have any\n- * questions.\n- *\/\n-\n-package javacserver;\n-\n-import java.util.Arrays;\n-\n-import javacserver.client.ClientMain;\n-import javacserver.server.ServerMain;\n-\n-import static javacserver.options.Option.STARTSERVER;\n-\n-\/**\n- * The application entry point of the smart javac wrapper tool.\n- *\n- *  <p><b>This is NOT part of any supported API.\n- *  If you write code that depends on this, you do so at your own risk.\n- *  This code and its internal interfaces are subject to change or\n- *  deletion without notice.<\/b>\n- *\/\n-public class Main {\n-\n-    public static void main(String... args)  {\n-        System.exit(go(args));\n-    }\n-\n-    public static int go(String[] args) {\n-\n-        \/\/ Server or client mode?\n-        boolean serverMode = Arrays.asList(args)\n-                                   .stream()\n-                                   .anyMatch(arg -> arg.startsWith(STARTSERVER.arg));\n-\n-        return serverMode ? ServerMain.run(args) : ClientMain.run(args);\n-    }\n-}\n","filename":"make\/langtools\/tools\/javacserver\/Main.java","additions":0,"deletions":58,"binary":false,"changes":58,"status":"deleted"},{"patch":"@@ -1,56 +0,0 @@\n-\/*\n- * Copyright (c) 1999, 2021, Oracle and\/or its affiliates. All rights reserved.\n- * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n- *\n- * This code is free software; you can redistribute it and\/or modify it\n- * under the terms of the GNU General Public License version 2 only, as\n- * published by the Free Software Foundation.  Oracle designates this\n- * particular file as subject to the \"Classpath\" exception as provided\n- * by Oracle in the LICENSE file that accompanied this code.\n- *\n- * This code is distributed in the hope that it will be useful, but WITHOUT\n- * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n- * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n- * version 2 for more details (a copy is included in the LICENSE file that\n- * accompanied this code).\n- *\n- * You should have received a copy of the GNU General Public License version\n- * 2 along with this work; if not, write to the Free Software Foundation,\n- * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n- *\n- * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n- * or visit www.oracle.com if you need additional information or have any\n- * questions.\n- *\/\n-\n-package javacserver;\n-\n-\/** Result codes.\n- *\/\n-public enum Result {\n-    OK(0),        \/\/ Compilation completed with no errors.\n-    ERROR(1),     \/\/ Completed but reported errors.\n-    CMDERR(2),    \/\/ Bad command-line arguments\n-    SYSERR(3),    \/\/ System error or resource exhaustion.\n-    ABNORMAL(4);  \/\/ Compiler terminated abnormally\n-\n-    Result(int exitCode) {\n-        this.exitCode = exitCode;\n-    }\n-\n-    public static Result of(int exitcode) {\n-        for (Result result : values()) {\n-            if (result.exitCode == exitcode) {\n-                return result;\n-            }\n-        }\n-\n-        return ABNORMAL;\n-    }\n-\n-    public boolean isOK() {\n-        return (exitCode == 0);\n-    }\n-\n-    public final int exitCode;\n-}\n","filename":"make\/langtools\/tools\/javacserver\/Result.java","additions":0,"deletions":56,"binary":false,"changes":56,"status":"deleted"},{"patch":"@@ -1,148 +0,0 @@\n-\/*\n- * Copyright (c) 2012, 2022, Oracle and\/or its affiliates. All rights reserved.\n- * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n- *\n- * This code is free software; you can redistribute it and\/or modify it\n- * under the terms of the GNU General Public License version 2 only, as\n- * published by the Free Software Foundation.  Oracle designates this\n- * particular file as subject to the \"Classpath\" exception as provided\n- * by Oracle in the LICENSE file that accompanied this code.\n- *\n- * This code is distributed in the hope that it will be useful, but WITHOUT\n- * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n- * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n- * version 2 for more details (a copy is included in the LICENSE file that\n- * accompanied this code).\n- *\n- * You should have received a copy of the GNU General Public License version\n- * 2 along with this work; if not, write to the Free Software Foundation,\n- * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n- *\n- * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n- * or visit www.oracle.com if you need additional information or have any\n- * questions.\n- *\/\n-\n-package javacserver;\n-\n-import java.io.PrintWriter;\n-import java.io.StringWriter;\n-import java.util.Arrays;\n-import java.util.Collection;\n-import java.util.HashSet;\n-import java.util.Set;\n-import java.util.regex.Pattern;\n-import java.util.stream.Stream;\n-\n-\/**\n- * Utilities.\n- *\n- *  <p><b>This is NOT part of any supported API.\n- *  If you write code that depends on this, you do so at your own risk.\n- *  This code and its internal interfaces are subject to change or\n- *  deletion without notice.<\/b>\n- *\/\n-public class Util {\n-\n-\n-\n-    public static String extractStringOption(String opName, String s) {\n-        return extractStringOption(opName, s, null);\n-    }\n-\n-    private static String extractStringOptionWithDelimiter(String opName, String s, String deflt, char delimiter) {\n-        int p = s.indexOf(opName+\"=\");\n-        if (p == -1) return deflt;\n-        p+=opName.length()+1;\n-        int pe = s.indexOf(delimiter, p);\n-        if (pe == -1) pe = s.length();\n-        return s.substring(p, pe);\n-    }\n-\n-    public static String extractStringOption(String opName, String s, String deflt) {\n-        return extractStringOptionWithDelimiter(opName, s, deflt, ',');\n-    }\n-\n-    public static String extractStringOptionLine(String opName, String s, String deflt) {\n-        return extractStringOptionWithDelimiter(opName, s, deflt, '\\n').strip();\n-    }\n-\n-    public static int extractIntOption(String opName, String s, int deflt) {\n-        int p = s.indexOf(opName+\"=\");\n-        if (p == -1) return deflt;\n-        p+=opName.length()+1;\n-        int pe = s.indexOf(',', p);\n-        if (pe == -1) pe = s.length();\n-        int v = 0;\n-        try {\n-            v = Integer.parseInt(s.substring(p, pe));\n-        } catch (Exception e) {}\n-        return v;\n-    }\n-\n-\n-    \/**\n-     * Convenience method to create a set with strings.\n-     *\/\n-    public static Set<String> set(String... ss) {\n-        Set<String> set = new HashSet<>();\n-        set.addAll(Arrays.asList(ss));\n-        return set;\n-    }\n-\n-    \/**\n-     * Normalize windows drive letter paths to upper case to enable string\n-     * comparison.\n-     *\n-     * @param file File name to normalize\n-     * @return The normalized string if file has a drive letter at the beginning,\n-     *         otherwise the original string.\n-     *\/\n-    public static String normalizeDriveLetter(String file) {\n-        if (file.length() > 2 && file.charAt(1) == ':') {\n-            return Character.toUpperCase(file.charAt(0)) + file.substring(1);\n-        } else if (file.length() > 3 && file.charAt(0) == '*'\n-                   && file.charAt(2) == ':') {\n-            \/\/ Handle a wildcard * at the beginning of the string.\n-            return file.substring(0, 1) + Character.toUpperCase(file.charAt(1))\n-                   + file.substring(2);\n-        }\n-        return file;\n-    }\n-\n-\n-    public static <E> Set<E> union(Set<? extends E> s1,\n-                                   Set<? extends E> s2) {\n-        Set<E> union = new HashSet<>();\n-        union.addAll(s1);\n-        union.addAll(s2);\n-        return union;\n-    }\n-\n-    public static <E> Set<E> subtract(Set<? extends E> orig,\n-                                      Set<? extends E> toSubtract) {\n-        Set<E> difference = new HashSet<>(orig);\n-        difference.removeAll(toSubtract);\n-        return difference;\n-    }\n-\n-    public static String getStackTrace(Throwable t) {\n-        StringWriter sw = new StringWriter();\n-        t.printStackTrace(new PrintWriter(sw));\n-        return sw.toString();\n-    }\n-\n-    public static <E> Set<E> intersection(Collection<? extends E> c1,\n-                                          Collection<? extends E> c2) {\n-        Set<E> intersection = new HashSet<E>(c1);\n-        intersection.retainAll(c2);\n-        return intersection;\n-    }\n-\n-\n-    public static Stream<String> getLines(String str) {\n-        return str.isEmpty()\n-                ? Stream.empty()\n-                : Stream.of(str.split(Pattern.quote(System.lineSeparator())));\n-    }\n-}\n","filename":"make\/langtools\/tools\/javacserver\/Util.java","additions":0,"deletions":148,"binary":false,"changes":148,"status":"deleted"},{"patch":"@@ -1,80 +0,0 @@\n-\/*\n- * Copyright (c) 2014, 2022, Oracle and\/or its affiliates. All rights reserved.\n- * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n- *\n- * This code is free software; you can redistribute it and\/or modify it\n- * under the terms of the GNU General Public License version 2 only, as\n- * published by the Free Software Foundation.  Oracle designates this\n- * particular file as subject to the \"Classpath\" exception as provided\n- * by Oracle in the LICENSE file that accompanied this code.\n- *\n- * This code is distributed in the hope that it will be useful, but WITHOUT\n- * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n- * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n- * version 2 for more details (a copy is included in the LICENSE file that\n- * accompanied this code).\n- *\n- * You should have received a copy of the GNU General Public License version\n- * 2 along with this work; if not, write to the Free Software Foundation,\n- * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n- *\n- * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n- * or visit www.oracle.com if you need additional information or have any\n- * questions.\n- *\/\n-\n-package javacserver.client;\n-\n-import java.io.OutputStreamWriter;\n-import java.io.Writer;\n-\n-import javacserver.AutoFlushWriter;\n-import javacserver.Log;\n-import javacserver.Result;\n-import javacserver.comp.SjavacImpl;\n-import javacserver.options.Options;\n-import javacserver.server.Sjavac;\n-\n-\/**\n- *  <p><b>This is NOT part of any supported API.\n- *  If you write code that depends on this, you do so at your own risk.\n- *  This code and its internal interfaces are subject to change or\n- *  deletion without notice.<\/b>\n- *\/\n-public class ClientMain {\n-\n-    public static int run(String[] args) {\n-        return run(args,\n-                   new AutoFlushWriter(new OutputStreamWriter(System.out)),\n-                   new AutoFlushWriter(new OutputStreamWriter(System.err)));\n-    }\n-\n-    public static int run(String[] args, Writer out, Writer err) {\n-\n-        Log.setLogForCurrentThread(new Log(out, err));\n-\n-        Options options;\n-        try {\n-            options = Options.parseArgs(args);\n-        } catch (IllegalArgumentException e) {\n-            Log.error(e.getMessage());\n-            return Result.CMDERR.exitCode;\n-        }\n-\n-        Log.setLogLevel(options.getLogLevel());\n-\n-        \/\/ Prepare sjavac object\n-        boolean useServer = options.getServerConf() != null;\n-        Sjavac sjavac = useServer ? new SjavacClient(options) : new SjavacImpl();\n-\n-        \/\/ Perform compilation\n-        Result result = sjavac.compile(args);\n-\n-        \/\/ If sjavac is running in the foreground we should shut it down at this point\n-        if (!useServer) {\n-            sjavac.shutdown();\n-        }\n-\n-        return result.exitCode;\n-    }\n-}\n","filename":"make\/langtools\/tools\/javacserver\/client\/ClientMain.java","additions":0,"deletions":80,"binary":false,"changes":80,"status":"deleted"},{"patch":"@@ -1,78 +0,0 @@\n-\/*\n- * Copyright (c) 2014, 2022, Oracle and\/or its affiliates. All rights reserved.\n- * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n- *\n- * This code is free software; you can redistribute it and\/or modify it\n- * under the terms of the GNU General Public License version 2 only, as\n- * published by the Free Software Foundation.  Oracle designates this\n- * particular file as subject to the \"Classpath\" exception as provided\n- * by Oracle in the LICENSE file that accompanied this code.\n- *\n- * This code is distributed in the hope that it will be useful, but WITHOUT\n- * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n- * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n- * version 2 for more details (a copy is included in the LICENSE file that\n- * accompanied this code).\n- *\n- * You should have received a copy of the GNU General Public License version\n- * 2 along with this work; if not, write to the Free Software Foundation,\n- * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n- *\n- * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n- * or visit www.oracle.com if you need additional information or have any\n- * questions.\n- *\/\n-\n-package javacserver.comp;\n-\n-import java.io.PrintWriter;\n-import java.io.StringWriter;\n-import java.util.stream.Stream;\n-\n-import com.sun.tools.javac.Main;\n-\n-import javacserver.Log;\n-import javacserver.Result;\n-import javacserver.Util;\n-import javacserver.options.Option;\n-import javacserver.server.Sjavac;\n-\n-\/**\n- * The sjavac implementation that interacts with javac and performs the actual\n- * compilation.\n- *\n- *  <p><b>This is NOT part of any supported API.\n- *  If you write code that depends on this, you do so at your own risk.\n- *  This code and its internal interfaces are subject to change or\n- *  deletion without notice.<\/b>\n- *\/\n-public class SjavacImpl implements Sjavac {\n-\n-    @Override\n-    @SuppressWarnings(\"deprecated\")\n-    public Result compile(String[] args) {\n-        \/\/ Direct logging to our byte array stream.\n-        StringWriter strWriter = new StringWriter();\n-        PrintWriter printWriter = new PrintWriter(strWriter);\n-\n-        \/\/ Prepare arguments\n-        String[] passThroughArgs = Stream.of(args)\n-                                         .filter(arg -> !arg.startsWith(Option.SERVER.arg))\n-                                         .toArray(String[]::new);\n-        \/\/ Compile\n-        int exitcode = Main.compile(passThroughArgs, printWriter);\n-        Result result = Result.of(exitcode);\n-\n-        \/\/ Process compiler output (which is always errors)\n-        printWriter.flush();\n-        Util.getLines(strWriter.toString()).forEach(Log::error);\n-\n-        return result;\n-\n-    }\n-\n-    @Override\n-    public void shutdown() {\n-        \/\/ Nothing to clean up\n-    }\n-}\n","filename":"make\/langtools\/tools\/javacserver\/comp\/SjavacImpl.java","additions":0,"deletions":78,"binary":false,"changes":78,"status":"deleted"},{"patch":"@@ -1,294 +0,0 @@\n-\/*\n- * Copyright (c) 1999, 2022, Oracle and\/or its affiliates. All rights reserved.\n- * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n- *\n- * This code is free software; you can redistribute it and\/or modify it\n- * under the terms of the GNU General Public License version 2 only, as\n- * published by the Free Software Foundation.  Oracle designates this\n- * particular file as subject to the \"Classpath\" exception as provided\n- * by Oracle in the LICENSE file that accompanied this code.\n- *\n- * This code is distributed in the hope that it will be useful, but WITHOUT\n- * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n- * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n- * version 2 for more details (a copy is included in the LICENSE file that\n- * accompanied this code).\n- *\n- * You should have received a copy of the GNU General Public License version\n- * 2 along with this work; if not, write to the Free Software Foundation,\n- * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n- *\n- * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n- * or visit www.oracle.com if you need additional information or have any\n- * questions.\n- *\/\n-\n-package javacserver.options;\n-\n-import java.io.IOException;\n-import java.io.Reader;\n-import java.nio.charset.Charset;\n-import java.nio.file.Files;\n-import java.nio.file.Paths;\n-import java.util.ArrayList;\n-import java.util.List;\n-\n-\/**\n- * Various utility methods for processing Java tool command line arguments.\n- *\n- *  <p><b>This is NOT part of any supported API.\n- *  If you write code that depends on this, you do so at your own risk.\n- *  This code and its internal interfaces are subject to change or\n- *  deletion without notice.<\/b>\n- *\/\n-public class CommandLine {\n-    \/**\n-     * Process Win32-style command files for the specified command line\n-     * arguments and return the resulting arguments. A command file argument\n-     * is of the form '@file' where 'file' is the name of the file whose\n-     * contents are to be parsed for additional arguments. The contents of\n-     * the command file are parsed using StreamTokenizer and the original\n-     * '@file' argument replaced with the resulting tokens. Recursive command\n-     * files are not supported. The '@' character itself can be quoted with\n-     * the sequence '@@'.\n-     * @param args the arguments that may contain @files\n-     * @return the arguments, with @files expanded\n-     * @throws IOException if there is a problem reading any of the @files\n-     *\/\n-    public static List<String> parse(List<String> args) throws IOException {\n-        List<String> newArgs = new ArrayList<>();\n-        appendParsedCommandArgs(newArgs, args);\n-        return newArgs;\n-    }\n-\n-    private static void appendParsedCommandArgs(List<String> newArgs, List<String> args) throws IOException {\n-        for (String arg : args) {\n-            if (arg.length() > 1 && arg.charAt(0) == '@') {\n-                arg = arg.substring(1);\n-                if (arg.charAt(0) == '@') {\n-                    newArgs.add(arg);\n-                } else {\n-                    loadCmdFile(arg, newArgs);\n-                }\n-            } else {\n-                newArgs.add(arg);\n-            }\n-        }\n-    }\n-\n-    \/**\n-     * Process the given environment variable and appends any Win32-style\n-     * command files for the specified command line arguments and return\n-     * the resulting arguments. A command file argument\n-     * is of the form '@file' where 'file' is the name of the file whose\n-     * contents are to be parsed for additional arguments. The contents of\n-     * the command file are parsed using StreamTokenizer and the original\n-     * '@file' argument replaced with the resulting tokens. Recursive command\n-     * files are not supported. The '@' character itself can be quoted with\n-     * the sequence '@@'.\n-     * @param envVariable the env variable to process\n-     * @param args the arguments that may contain @files\n-     * @return the arguments, with environment variable's content and expansion of @files\n-     * @throws IOException if there is a problem reading any of the @files\n-     * @throws UnmatchedQuote\n-     *\/\n-    public static List<String> parse(String envVariable, List<String> args)\n-            throws IOException, UnmatchedQuote {\n-\n-        List<String> inArgs = new ArrayList<>();\n-        appendParsedEnvVariables(inArgs, envVariable);\n-        inArgs.addAll(args);\n-        List<String> newArgs = new ArrayList<>();\n-        appendParsedCommandArgs(newArgs, inArgs);\n-        return newArgs;\n-    }\n-\n-    private static void loadCmdFile(String name, List<String> args) throws IOException {\n-        try (Reader r = Files.newBufferedReader(Paths.get(name), Charset.defaultCharset())) {\n-            Tokenizer t = new Tokenizer(r);\n-            String s;\n-            while ((s = t.nextToken()) != null) {\n-                args.add(s);\n-            }\n-        }\n-    }\n-\n-    public static class Tokenizer {\n-        private final Reader in;\n-        private int ch;\n-\n-        public Tokenizer(Reader in) throws IOException {\n-            this.in = in;\n-            ch = in.read();\n-        }\n-\n-        public String nextToken() throws IOException {\n-            skipWhite();\n-            if (ch == -1) {\n-                return null;\n-            }\n-\n-            StringBuilder sb = new StringBuilder();\n-            char quoteChar = 0;\n-\n-            while (ch != -1) {\n-                switch (ch) {\n-                    case ' ':\n-                    case '\\t':\n-                    case '\\f':\n-                        if (quoteChar == 0) {\n-                            return sb.toString();\n-                        }\n-                        sb.append((char) ch);\n-                        break;\n-\n-                    case '\\n':\n-                    case '\\r':\n-                        return sb.toString();\n-\n-                    case '\\'':\n-                    case '\"':\n-                        if (quoteChar == 0) {\n-                            quoteChar = (char) ch;\n-                        } else if (quoteChar == ch) {\n-                            quoteChar = 0;\n-                        } else {\n-                            sb.append((char) ch);\n-                        }\n-                        break;\n-\n-                    case '\\\\':\n-                        if (quoteChar != 0) {\n-                            ch = in.read();\n-                            switch (ch) {\n-                                case '\\n':\n-                                case '\\r':\n-                                    while (ch == ' ' || ch == '\\n' || ch == '\\r' || ch == '\\t' || ch == '\\f') {\n-                                        ch = in.read();\n-                                    }\n-                                    continue;\n-\n-                                case 'n':\n-                                    ch = '\\n';\n-                                    break;\n-                                case 'r':\n-                                    ch = '\\r';\n-                                    break;\n-                                case 't':\n-                                    ch = '\\t';\n-                                    break;\n-                                case 'f':\n-                                    ch = '\\f';\n-                                    break;\n-                            }\n-                        }\n-                        sb.append((char) ch);\n-                        break;\n-\n-                    default:\n-                        sb.append((char) ch);\n-                }\n-\n-                ch = in.read();\n-            }\n-\n-            return sb.toString();\n-        }\n-\n-        void skipWhite() throws IOException {\n-            while (ch != -1) {\n-                switch (ch) {\n-                    case ' ':\n-                    case '\\t':\n-                    case '\\n':\n-                    case '\\r':\n-                    case '\\f':\n-                        break;\n-\n-                    case '#':\n-                        ch = in.read();\n-                        while (ch != '\\n' && ch != '\\r' && ch != -1) {\n-                            ch = in.read();\n-                        }\n-                        break;\n-\n-                    default:\n-                        return;\n-                }\n-\n-                ch = in.read();\n-            }\n-        }\n-    }\n-\n-    @SuppressWarnings(\"fallthrough\")\n-    private static void appendParsedEnvVariables(List<String> newArgs, String envVariable)\n-            throws UnmatchedQuote {\n-\n-        if (envVariable == null) {\n-            return;\n-        }\n-        String in = System.getenv(envVariable);\n-        if (in == null || in.trim().isEmpty()) {\n-            return;\n-        }\n-\n-        final char NUL = (char)0;\n-        final int len = in.length();\n-\n-        int pos = 0;\n-        StringBuilder sb = new StringBuilder();\n-        char quote = NUL;\n-        char ch;\n-\n-        loop:\n-        while (pos < len) {\n-            ch = in.charAt(pos);\n-            switch (ch) {\n-                case '\\\"': case '\\'':\n-                    if (quote == NUL) {\n-                        quote = ch;\n-                    } else if (quote == ch) {\n-                        quote = NUL;\n-                    } else {\n-                        sb.append(ch);\n-                    }\n-                    pos++;\n-                    break;\n-                case '\\f': case '\\n': case '\\r': case '\\t': case ' ':\n-                    if (quote == NUL) {\n-                        newArgs.add(sb.toString());\n-                        sb.setLength(0);\n-                        while (ch == '\\f' || ch == '\\n' || ch == '\\r' || ch == '\\t' || ch == ' ') {\n-                            pos++;\n-                            if (pos >= len) {\n-                                break loop;\n-                            }\n-                            ch = in.charAt(pos);\n-                        }\n-                        break;\n-                    }\n-                    \/\/ fall through\n-                default:\n-                    sb.append(ch);\n-                    pos++;\n-            }\n-        }\n-        if (sb.length() != 0) {\n-            newArgs.add(sb.toString());\n-        }\n-        if (quote != NUL) {\n-            throw new UnmatchedQuote(envVariable);\n-        }\n-    }\n-\n-    public static class UnmatchedQuote extends Exception {\n-        private static final long serialVersionUID = 0;\n-\n-        public final String variableName;\n-\n-        UnmatchedQuote(String variable) {\n-            this.variableName = variable;\n-        }\n-    }\n-}\n","filename":"make\/langtools\/tools\/javacserver\/options\/CommandLine.java","additions":0,"deletions":294,"binary":false,"changes":294,"status":"deleted"},{"patch":"@@ -1,100 +0,0 @@\n-\/*\n- * Copyright (c) 2014, 2022, Oracle and\/or its affiliates. All rights reserved.\n- * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n- *\n- * This code is free software; you can redistribute it and\/or modify it\n- * under the terms of the GNU General Public License version 2 only, as\n- * published by the Free Software Foundation.  Oracle designates this\n- * particular file as subject to the \"Classpath\" exception as provided\n- * by Oracle in the LICENSE file that accompanied this code.\n- *\n- * This code is distributed in the hope that it will be useful, but WITHOUT\n- * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n- * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n- * version 2 for more details (a copy is included in the LICENSE file that\n- * accompanied this code).\n- *\n- * You should have received a copy of the GNU General Public License version\n- * 2 along with this work; if not, write to the Free Software Foundation,\n- * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n- *\n- * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n- * or visit www.oracle.com if you need additional information or have any\n- * questions.\n- *\/\n-\n-package javacserver.options;\n-\n-\/**\n- * Sjavac options can be classified as:\n- *\n- *  (1) relevant only for sjavac, such as --server\n- *  (2) relevant for sjavac and javac, such as -d, or\n- *  (3) relevant only for javac, such as -g.\n- *\n- * This enum represents all options from (1) and (2). Note that instances of\n- * this enum only entail static information about the option. For storage of\n- * option values, refer to Options.\n- *\n- *  <p><b>This is NOT part of any supported API.\n- *  If you write code that depends on this, you do so at your own risk.\n- *  This code and its internal interfaces are subject to change or\n- *  deletion without notice.<\/b>\n- *\/\n-public enum Option {\n-    SERVER(\"--server:\", \"Specify server configuration file of running server\") {\n-        @Override\n-        protected void processMatching(ArgumentIterator iter, Options.ArgDecoderOptionHelper helper) {\n-            helper.serverConf(iter.current().substring(arg.length()));\n-        }\n-    },\n-    STARTSERVER(\"--startserver:\", \"Start server and use the given configuration file\") {\n-        @Override\n-        protected void processMatching(ArgumentIterator iter, Options.ArgDecoderOptionHelper helper) {\n-            helper.startServerConf(iter.current().substring(arg.length()));\n-        }\n-    };\n-\n-\n-    public final String arg;\n-\n-    final String description;\n-\n-    private Option(String arg, String description) {\n-        this.arg = arg;\n-        this.description = description;\n-    }\n-\n-    \/\/ Future cleanup: Change the \"=\" syntax to \":\" syntax to be consistent and\n-    \/\/ to follow the javac-option style.\n-\n-    public boolean hasOption() {\n-        return arg.endsWith(\":\") || arg.endsWith(\"=\");\n-    }\n-\n-\n-    \/**\n-     * Process current argument of argIter.\n-     *\n-     * It's final, since the option customization is typically done in\n-     * processMatching.\n-     *\n-     * @param argIter Iterator to read current and succeeding arguments from.\n-     * @param helper The helper to report back to.\n-     * @return true iff the argument was processed by this option.\n-     *\/\n-    public final boolean processCurrent(ArgumentIterator argIter,\n-                                        Options.ArgDecoderOptionHelper helper) {\n-        String fullArg = argIter.current(); \/\/ \"-tr\" or \"-log=level\"\n-        if (hasOption() ? fullArg.startsWith(arg) : fullArg.equals(arg)) {\n-            processMatching(argIter, helper);\n-            return true;\n-        }\n-        \/\/ Did not match\n-        return false;\n-    }\n-\n-    \/** Called by process if the current argument matches this option. *\/\n-    protected abstract void processMatching(ArgumentIterator argIter,\n-                                            Options.ArgDecoderOptionHelper helper);\n-}\n","filename":"make\/langtools\/tools\/javacserver\/options\/Option.java","additions":0,"deletions":100,"binary":false,"changes":100,"status":"deleted"},{"patch":"@@ -1,121 +0,0 @@\n-\/*\n- * Copyright (c) 2014, 2022, Oracle and\/or its affiliates. All rights reserved.\n- * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n- *\n- * This code is free software; you can redistribute it and\/or modify it\n- * under the terms of the GNU General Public License version 2 only, as\n- * published by the Free Software Foundation.  Oracle designates this\n- * particular file as subject to the \"Classpath\" exception as provided\n- * by Oracle in the LICENSE file that accompanied this code.\n- *\n- * This code is distributed in the hope that it will be useful, but WITHOUT\n- * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n- * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n- * version 2 for more details (a copy is included in the LICENSE file that\n- * accompanied this code).\n- *\n- * You should have received a copy of the GNU General Public License version\n- * 2 along with this work; if not, write to the Free Software Foundation,\n- * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n- *\n- * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n- * or visit www.oracle.com if you need additional information or have any\n- * questions.\n- *\/\n-\n-package javacserver.options;\n-\n-import java.util.List;\n-\n-\/**\n- * Instances of this class represent values for sjavac command line options.\n- *\n- *  <p><b>This is NOT part of any supported API.\n- *  If you write code that depends on this, you do so at your own risk.\n- *  This code and its internal interfaces are subject to change or\n- *  deletion without notice.<\/b>\n- *\/\n-public class Options {\n-    private String logLevel = \"info\";\n-\n-    private boolean startServer = false;\n-\n-    \/\/ Server configuration string\n-    private String serverConf;\n-\n-    \/** Get the log level. *\/\n-    public String getLogLevel() {\n-        return logLevel;\n-    }\n-\n-    \/** Return true iff a new server should be started *\/\n-    public boolean startServerFlag() {\n-        return startServer;\n-    }\n-\n-    \/** Return the server configuration string. *\/\n-    public String getServerConf() {\n-        return serverConf;\n-    }\n-\n-    \/**\n-     * Parses the given argument array and returns a corresponding Options\n-     * instance.\n-     *\/\n-    public static Options parseArgs(String... args) {\n-        Options options = new Options();\n-        options.new ArgDecoderOptionHelper().traverse(args);\n-        return options;\n-    }\n-\n-    \/\/ OptionHelper that records the traversed options in this Options instance.\n-    public class ArgDecoderOptionHelper {\n-        public void reportError(String msg) {\n-            throw new IllegalArgumentException(msg);\n-        }\n-\n-        public void serverConf(String conf) {\n-            if (serverConf != null)\n-                reportError(\"Can not specify more than one server configuration.\");\n-            else\n-                serverConf = conf;\n-        }\n-\n-        public void startServerConf(String conf) {\n-            if (serverConf != null)\n-                reportError(\"Can not specify more than one server configuration.\");\n-            else {\n-                startServer = true;\n-                serverConf = conf;\n-            }\n-        }\n-\n-        \/**\n-         * Traverses an array of arguments and performs the appropriate callbacks.\n-         *\n-         * @param args the arguments to traverse.\n-         *\/\n-        void traverse(String[] args) {\n-            Iterable<String> allArgs;\n-            try {\n-                allArgs = CommandLine.parse(List.of(args)); \/\/ Detect @file and load it as a command line.\n-            } catch (java.io.IOException e) {\n-                throw new IllegalArgumentException(\"Problem reading @\"+e.getMessage());\n-            }\n-            ArgumentIterator argIter = new ArgumentIterator(allArgs);\n-\n-            nextArg:\n-            while (argIter.hasNext()) {\n-\n-                String arg = argIter.next();\n-\n-                if (arg.startsWith(\"-\")) {\n-                    for (Option opt : Option.values()) {\n-                        if (opt.processCurrent(argIter, this))\n-                            continue nextArg;\n-                    }\n-                }\n-            }\n-        }\n-    }\n-}\n","filename":"make\/langtools\/tools\/javacserver\/options\/Options.java","additions":0,"deletions":121,"binary":false,"changes":121,"status":"deleted"},{"patch":"@@ -1,92 +0,0 @@\n-\/*\n- * Copyright (c) 2014, 2022, Oracle and\/or its affiliates. All rights reserved.\n- * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n- *\n- * This code is free software; you can redistribute it and\/or modify it\n- * under the terms of the GNU General Public License version 2 only, as\n- * published by the Free Software Foundation.  Oracle designates this\n- * particular file as subject to the \"Classpath\" exception as provided\n- * by Oracle in the LICENSE file that accompanied this code.\n- *\n- * This code is distributed in the hope that it will be useful, but WITHOUT\n- * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n- * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n- * version 2 for more details (a copy is included in the LICENSE file that\n- * accompanied this code).\n- *\n- * You should have received a copy of the GNU General Public License version\n- * 2 along with this work; if not, write to the Free Software Foundation,\n- * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n- *\n- * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n- * or visit www.oracle.com if you need additional information or have any\n- * questions.\n- *\/\n-\n-package javacserver.server;\n-\n-import java.io.IOException;\n-import java.io.PrintStream;\n-\n-import javacserver.Log;\n-import javacserver.Result;\n-import javacserver.server.log.LazyInitFileLog;\n-import javacserver.server.log.LoggingOutputStream;\n-\n-import static javacserver.Log.Level.ERROR;\n-import static javacserver.Log.Level.INFO;\n-\n-\/**\n- *  <p><b>This is NOT part of any supported API.\n- *  If you write code that depends on this, you do so at your own risk.\n- *  This code and its internal interfaces are subject to change or\n- *  deletion without notice.<\/b>\n- *\/\n-public class ServerMain {\n-\n-    \/\/ For logging server internal (non request specific) errors.\n-    private static LazyInitFileLog errorLog;\n-\n-    public static int run(String[] args) {\n-\n-        \/\/ Under normal operation, all logging messages generated server-side\n-        \/\/ are due to compilation requests. These logging messages should\n-        \/\/ be relayed back to the requesting client rather than written to the\n-        \/\/ server log. The only messages that should be written to the server\n-        \/\/ log (in production mode) should be errors,\n-        Log.setLogForCurrentThread(errorLog = new LazyInitFileLog(\"server.log\"));\n-        Log.setLogLevel(ERROR); \/\/ should be set to ERROR.\n-\n-        \/\/ Make sure no exceptions go under the radar\n-        Thread.setDefaultUncaughtExceptionHandler((t, e) -> {\n-            Log.setLogForCurrentThread(errorLog);\n-            Log.error(e);\n-        });\n-\n-        \/\/ Inevitably someone will try to print messages using System.{out,err}.\n-        \/\/ Make sure this output also ends up in the log.\n-        System.setOut(new PrintStream(new LoggingOutputStream(System.out, INFO, \"[stdout] \")));\n-        System.setErr(new PrintStream(new LoggingOutputStream(System.err, ERROR, \"[stderr] \")));\n-\n-        \/\/ Any options other than --startserver?\n-        if (args.length > 1) {\n-            Log.error(\"When spawning a background server, only a single --startserver argument is allowed.\");\n-            return Result.CMDERR.exitCode;\n-        }\n-\n-        int exitCode;\n-        try {\n-            SjavacServer server = new SjavacServer(args[0]);\n-            exitCode = server.startServer();\n-        } catch (IOException | InterruptedException ex) {\n-            ex.printStackTrace();\n-            exitCode = Result.ERROR.exitCode;\n-        }\n-\n-        return exitCode;\n-    }\n-\n-    public static LazyInitFileLog getErrorLog() {\n-        return errorLog;\n-    }\n-}\n","filename":"make\/langtools\/tools\/javacserver\/server\/ServerMain.java","additions":0,"deletions":92,"binary":false,"changes":92,"status":"deleted"},{"patch":"@@ -308,1 +308,1 @@\n-    DISABLED_WARNINGS_gcc := format-nonliteral type-limits stringop-truncation, \\\n+    DISABLED_WARNINGS_gcc := format-nonliteral stringop-truncation, \\\n","filename":"make\/modules\/java.desktop\/lib\/Awt2dLibraries.gmk","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -3673,0 +3673,1 @@\n+    _masm.clear_inst_mark();\n@@ -14580,26 +14581,0 @@\n-instruct convF2HF_reg_reg(iRegINoSp dst, vRegF src, vRegF tmp) %{\n-  match(Set dst (ConvF2HF src));\n-  format %{ \"fcvt $tmp, $src\\t# convert single to half precision\\n\\t\"\n-            \"smov $dst, $tmp\\t# move result from $tmp to $dst\"\n-  %}\n-  effect(TEMP tmp);\n-  ins_encode %{\n-      __ fcvtsh($tmp$$FloatRegister, $src$$FloatRegister);\n-      __ smov($dst$$Register, $tmp$$FloatRegister, __ H, 0);\n-  %}\n-  ins_pipe(pipe_slow);\n-%}\n-\n-instruct convHF2F_reg_reg(vRegF dst, iRegINoSp src, vRegF tmp) %{\n-  match(Set dst (ConvHF2F src));\n-  format %{ \"mov $tmp, $src\\t# move source from $src to $tmp\\n\\t\"\n-            \"fcvt $dst, $tmp\\t# convert half to single precision\"\n-  %}\n-  effect(TEMP tmp);\n-  ins_encode %{\n-      __ mov($tmp$$FloatRegister, __ H, 0, $src$$Register);\n-      __ fcvths($dst$$FloatRegister, $tmp$$FloatRegister);\n-  %}\n-  ins_pipe(pipe_slow);\n-%}\n-\n","filename":"src\/hotspot\/cpu\/aarch64\/aarch64.ad","additions":1,"deletions":26,"binary":false,"changes":27,"status":"modified"},{"patch":"@@ -354,5 +354,16 @@\n-\n-  static extend uxtw(int shift = -1) { return extend(shift, 0b010, ext::uxtw); }\n-  static extend lsl(int shift = -1)  { return extend(shift, 0b011, ext::uxtx); }\n-  static extend sxtw(int shift = -1) { return extend(shift, 0b110, ext::sxtw); }\n-  static extend sxtx(int shift = -1) { return extend(shift, 0b111, ext::sxtx); }\n+  class uxtw : public extend {\n+  public:\n+    uxtw(int shift = -1): extend(shift, 0b010, ext::uxtw) { }\n+  };\n+  class lsl : public extend {\n+  public:\n+    lsl(int shift = -1): extend(shift, 0b011, ext::uxtx) { }\n+  };\n+  class sxtw : public extend {\n+  public:\n+    sxtw(int shift = -1): extend(shift, 0b110, ext::sxtw) { }\n+  };\n+  class sxtx : public extend {\n+  public:\n+    sxtx(int shift = -1): extend(shift, 0b111, ext::sxtx) { }\n+  };\n@@ -1898,1 +1909,1 @@\n-  void data_processing(unsigned type, unsigned opcode,\n+  void data_processing(unsigned op31, unsigned type, unsigned opcode,\n@@ -1901,1 +1912,1 @@\n-    f(0b000, 31, 29);\n+    f(op31, 31, 29);\n@@ -1907,1 +1918,1 @@\n-#define INSN(NAME, type, opcode)                        \\\n+#define INSN(NAME, op31, type, opcode)                  \\\n@@ -1909,16 +1920,14 @@\n-    data_processing(type, opcode, Vd, Vn);              \\\n-  }\n-\n-  INSN(fmovs,  0b00, 0b000000);\n-  INSN(fabss,  0b00, 0b000001);\n-  INSN(fnegs,  0b00, 0b000010);\n-  INSN(fsqrts, 0b00, 0b000011);\n-  INSN(fcvts,  0b00, 0b000101);   \/\/ Single-precision to double-precision\n-  INSN(fcvths, 0b11, 0b000100);   \/\/ Half-precision to single-precision\n-  INSN(fcvtsh, 0b00, 0b000111);   \/\/ Single-precision to half-precision\n-\n-  INSN(fmovd,  0b01, 0b000000);\n-  INSN(fabsd,  0b01, 0b000001);\n-  INSN(fnegd,  0b01, 0b000010);\n-  INSN(fsqrtd, 0b01, 0b000011);\n-  INSN(fcvtd,  0b01, 0b000100);   \/\/ Double-precision to single-precision\n+    data_processing(op31, type, opcode, Vd, Vn);        \\\n+  }\n+\n+  INSN(fmovs,  0b000, 0b00, 0b000000);\n+  INSN(fabss,  0b000, 0b00, 0b000001);\n+  INSN(fnegs,  0b000, 0b00, 0b000010);\n+  INSN(fsqrts, 0b000, 0b00, 0b000011);\n+  INSN(fcvts,  0b000, 0b00, 0b000101);   \/\/ Single-precision to double-precision\n+\n+  INSN(fmovd,  0b000, 0b01, 0b000000);\n+  INSN(fabsd,  0b000, 0b01, 0b000001);\n+  INSN(fnegd,  0b000, 0b01, 0b000010);\n+  INSN(fsqrtd, 0b000, 0b01, 0b000011);\n+  INSN(fcvtd,  0b000, 0b01, 0b000100);   \/\/ Double-precision to single-precision\n","filename":"src\/hotspot\/cpu\/aarch64\/assembler_aarch64.hpp","additions":33,"deletions":24,"binary":false,"changes":57,"status":"modified"},{"patch":"@@ -60,1 +60,1 @@\n-                                   Register tmp2) {\n+                                   Register tmp_thread) {\n@@ -63,1 +63,1 @@\n-    BarrierSetAssembler::load_at(masm, decorators, type, dst, src, tmp1, tmp2);\n+    BarrierSetAssembler::load_at(masm, decorators, type, dst, src, tmp1, tmp_thread);\n","filename":"src\/hotspot\/cpu\/aarch64\/gc\/z\/zBarrierSetAssembler_aarch64.cpp","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -53,1 +53,1 @@\n-                       Register tmp2);\n+                       Register tmp_thread);\n","filename":"src\/hotspot\/cpu\/aarch64\/gc\/z\/zBarrierSetAssembler_aarch64.hpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -29,0 +29,1 @@\n+#include \"jvm.h\"\n@@ -32,2 +33,0 @@\n-#include \"compiler\/compileTask.hpp\"\n-#include \"compiler\/disassembler.hpp\"\n@@ -43,1 +42,2 @@\n-#include \"jvm.h\"\n+#include \"compiler\/compileTask.hpp\"\n+#include \"compiler\/disassembler.hpp\"\n@@ -3979,5 +3979,1 @@\n-  if (value) {\n-    _masm->cbnzw(rscratch1, _label);\n-  } else {\n-    _masm->cbzw(rscratch1, _label);\n-  }\n+  _masm->cbzw(rscratch1, _label);\n","filename":"src\/hotspot\/cpu\/aarch64\/macroAssembler_aarch64.cpp","additions":4,"deletions":8,"binary":false,"changes":12,"status":"modified"},{"patch":"@@ -69,0 +69,1 @@\n+#define TIMES_OOP Address::sxtw(exact_log2(UseCompressedOops ? 4 : 8))\n@@ -621,0 +622,2 @@\n+  void array_overlap_test(Label& L_no_overlap, Address::sxtw sf) { __ b(L_no_overlap); }\n+\n@@ -1808,1 +1811,1 @@\n-      __ b(L);                  \/\/ conjoint check not yet implemented\n+      array_overlap_test(L, TIMES_OOP);\n@@ -3824,2 +3827,2 @@\n-  \/\/   c_rarg1   - byte[]  SHA.state\n-  \/\/   c_rarg2   - int     block_size\n+  \/\/   c_rarg1   - byte[]   SHA.state\n+  \/\/   c_rarg2   - int     digest_length\n@@ -3847,1 +3850,1 @@\n-    Register block_size    = c_rarg2;\n+    Register digest_length = c_rarg2;\n@@ -3852,1 +3855,1 @@\n-    Label sha3_512_or_sha3_384, shake128;\n+    Label sha3_512, sha3_384_or_224, sha3_256;\n@@ -3888,2 +3891,2 @@\n-    \/\/ block_size == 72, SHA3-512; block_size == 104, SHA3-384\n-    __ tbz(block_size, 7, sha3_512_or_sha3_384);\n+    \/\/ digest_length == 64, SHA3-512\n+    __ tbnz(digest_length, 6, sha3_512);\n@@ -3892,1 +3895,1 @@\n-    __ ld1(v29, v30, v31, __ T8B, __ post(buf, 24));\n+    __ ld1(v29, v30, __ T8B, __ post(buf, 16));\n@@ -3899,6 +3902,0 @@\n-    __ eor(v13, __ T8B, v13, v31);\n-\n-    __ ld1(v25, v26, v27,  __ T8B, __ post(buf, 24));\n-    __ eor(v14, __ T8B, v14, v25);\n-    __ eor(v15, __ T8B, v15, v26);\n-    __ eor(v16, __ T8B, v16, v27);\n@@ -3906,3 +3903,2 @@\n-    \/\/ block_size == 136, bit4 == 0 and bit5 == 0, SHA3-256 or SHAKE256\n-    __ andw(c_rarg5, block_size, 48);\n-    __ cbzw(c_rarg5, rounds24_loop);\n+    \/\/ digest_length == 28, SHA3-224;  digest_length == 48, SHA3-384\n+    __ tbnz(digest_length, 4, sha3_384_or_224);\n@@ -3910,4 +3906,6 @@\n-    __ tbnz(block_size, 5, shake128);\n-    \/\/ block_size == 144, bit5 == 0, SHA3-244\n-    __ ldrd(v28, __ post(buf, 8));\n-    __ eor(v17, __ T8B, v17, v28);\n+    \/\/ SHA3-256\n+    __ ld1(v25, v26, v27, v28, __ T8B, __ post(buf, 32));\n+    __ eor(v13, __ T8B, v13, v25);\n+    __ eor(v14, __ T8B, v14, v26);\n+    __ eor(v15, __ T8B, v15, v27);\n+    __ eor(v16, __ T8B, v16, v28);\n@@ -3916,7 +3914,12 @@\n-    __ BIND(shake128);\n-    __ ld1(v28, v29, v30, v31, __ T8B, __ post(buf, 32));\n-    __ eor(v17, __ T8B, v17, v28);\n-    __ eor(v18, __ T8B, v18, v29);\n-    __ eor(v19, __ T8B, v19, v30);\n-    __ eor(v20, __ T8B, v20, v31);\n-    __ b(rounds24_loop); \/\/ block_size == 168, SHAKE128\n+    __ BIND(sha3_384_or_224);\n+    __ tbz(digest_length, 2, rounds24_loop); \/\/ bit 2 cleared? SHA-384\n+\n+    \/\/ SHA3-224\n+    __ ld1(v25, v26, v27, v28, __ T8B, __ post(buf, 32));\n+    __ ld1(v29, __ T8B, __ post(buf, 8));\n+    __ eor(v13, __ T8B, v13, v25);\n+    __ eor(v14, __ T8B, v14, v26);\n+    __ eor(v15, __ T8B, v15, v27);\n+    __ eor(v16, __ T8B, v16, v28);\n+    __ eor(v17, __ T8B, v17, v29);\n+    __ b(rounds24_loop);\n@@ -3924,1 +3927,1 @@\n-    __ BIND(sha3_512_or_sha3_384);\n+    __ BIND(sha3_512);\n@@ -3928,8 +3931,0 @@\n-    __ tbz(block_size, 5, rounds24_loop); \/\/ SHA3-512\n-\n-    \/\/ SHA3-384\n-    __ ld1(v27, v28, v29, v30, __ T8B, __ post(buf, 32));\n-    __ eor(v9,  __ T8B, v9,  v27);\n-    __ eor(v10, __ T8B, v10, v28);\n-    __ eor(v11, __ T8B, v11, v29);\n-    __ eor(v12, __ T8B, v12, v30);\n@@ -4020,1 +4015,4 @@\n-      __ add(ofs, ofs, block_size);\n+      \/\/ block_size =  200 - 2 * digest_length, ofs += block_size\n+      __ add(ofs, ofs, 200);\n+      __ sub(ofs, ofs, digest_length, Assembler::LSL, 1);\n+\n","filename":"src\/hotspot\/cpu\/aarch64\/stubGenerator_aarch64.cpp","additions":36,"deletions":38,"binary":false,"changes":74,"status":"modified"},{"patch":"@@ -312,1 +312,1 @@\n-void TemplateTable::ldc(LdcType type)\n+void TemplateTable::ldc(bool wide)\n@@ -317,1 +317,1 @@\n-  if (is_ldc_wide(type)) {\n+  if (wide) {\n@@ -346,1 +346,1 @@\n-  __ mov(c_rarg1, is_ldc_wide(type) ? 1 : 0);\n+  __ mov(c_rarg1, wide);\n@@ -379,1 +379,1 @@\n-void TemplateTable::fast_aldc(LdcType type)\n+void TemplateTable::fast_aldc(bool wide)\n@@ -387,1 +387,1 @@\n-  int index_size = is_ldc_wide(type) ? sizeof(u2) : sizeof(u1);\n+  int index_size = wide ? sizeof(u2) : sizeof(u1);\n","filename":"src\/hotspot\/cpu\/aarch64\/templateTable_aarch64.cpp","additions":5,"deletions":5,"binary":false,"changes":10,"status":"modified"},{"patch":"@@ -348,3 +348,4 @@\n-    if (FLAG_IS_DEFAULT(UseSHA512Intrinsics)) {\n-      FLAG_SET_DEFAULT(UseSHA512Intrinsics, true);\n-    }\n+    \/\/ Do not auto-enable UseSHA512Intrinsics until it has been fully tested on hardware\n+    \/\/ if (FLAG_IS_DEFAULT(UseSHA512Intrinsics)) {\n+      \/\/ FLAG_SET_DEFAULT(UseSHA512Intrinsics, true);\n+    \/\/ }\n","filename":"src\/hotspot\/cpu\/aarch64\/vm_version_aarch64.cpp","additions":4,"deletions":3,"binary":false,"changes":7,"status":"modified"},{"patch":"@@ -33,1 +33,0 @@\n-#include \"prims\/methodHandles.hpp\"\n@@ -47,0 +46,1 @@\n+#include \"prims\/methodHandles.hpp\"\n","filename":"src\/hotspot\/cpu\/arm\/frame_arm.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -26,0 +26,1 @@\n+#include \"jvm.h\"\n@@ -34,1 +35,0 @@\n-#include \"jvm.h\"\n","filename":"src\/hotspot\/cpu\/arm\/interp_masm_arm.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -30,0 +30,1 @@\n+#include \"jvm.h\"\n@@ -34,1 +35,0 @@\n-#include \"jvm.h\"\n","filename":"src\/hotspot\/cpu\/arm\/methodHandles_arm.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -28,1 +28,0 @@\n-#include \"code\/icBuffer.hpp\"\n@@ -39,0 +38,1 @@\n+#include \"code\/icBuffer.hpp\"\n","filename":"src\/hotspot\/cpu\/arm\/nativeInst_arm_32.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -367,1 +367,1 @@\n-void TemplateTable::ldc(LdcType type) {\n+void TemplateTable::ldc(bool wide) {\n@@ -376,1 +376,1 @@\n-  if (is_ldc_wide(type)) {\n+  if (wide) {\n@@ -404,1 +404,1 @@\n-  __ mov(R1, is_ldc_wide(type) ? 1 : 0);\n+  __ mov(R1, wide);\n@@ -432,1 +432,1 @@\n-void TemplateTable::fast_aldc(LdcType type) {\n+void TemplateTable::fast_aldc(bool wide) {\n@@ -434,1 +434,1 @@\n-  int index_size = is_ldc_wide(type) ? sizeof(u2) : sizeof(u1);\n+  int index_size = wide ? sizeof(u2) : sizeof(u1);\n","filename":"src\/hotspot\/cpu\/arm\/templateTable_arm.cpp","additions":5,"deletions":5,"binary":false,"changes":10,"status":"modified"},{"patch":"@@ -26,1 +26,0 @@\n-#include \"asm\/macroAssembler.inline.hpp\"\n@@ -28,0 +27,1 @@\n+#include \"asm\/macroAssembler.inline.hpp\"\n","filename":"src\/hotspot\/cpu\/arm\/vm_version_arm_32.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -3,1 +3,1 @@\n- * Copyright (c) 2012, 2022 SAP SE. All rights reserved.\n+ * Copyright (c) 2012, 2021 SAP SE. All rights reserved.\n@@ -1935,1 +1935,1 @@\n-    return 4 * cr.encoding() + c;\n+    return 4 * (int)(intptr_t)cr + c;\n","filename":"src\/hotspot\/cpu\/ppc\/assembler_ppc.hpp","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -3,1 +3,1 @@\n- * Copyright (c) 2012, 2022 SAP SE. All rights reserved.\n+ * Copyright (c) 2012, 2021 SAP SE. All rights reserved.\n@@ -580,1 +580,1 @@\n-      Address       addr = dst_in_memory ? frame_map()->address_for_slot(dst->double_stack_ix()) : Address();\n+      Address       addr = dst_in_memory ? frame_map()->address_for_slot(dst->double_stack_ix()) : NULL;\n@@ -604,1 +604,1 @@\n-      Address       addr = dst_in_memory ? frame_map()->address_for_slot(dst->double_stack_ix()) : Address();\n+      Address       addr = dst_in_memory ? frame_map()->address_for_slot(dst->double_stack_ix()) : NULL;\n","filename":"src\/hotspot\/cpu\/ppc\/c1_LIRAssembler_ppc.cpp","additions":3,"deletions":3,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -45,0 +45,1 @@\n+\n@@ -46,0 +47,1 @@\n+\n@@ -49,0 +51,1 @@\n+\n","filename":"src\/hotspot\/cpu\/ppc\/gc\/shenandoah\/shenandoahBarrierSetAssembler_ppc.cpp","additions":3,"deletions":0,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -543,1 +543,1 @@\n-        __ addi(R4_ARG2, _ref_addr.base(), _ref_addr.disp());\n+        __ add(R4_ARG2, (intptr_t) _ref_addr.disp(), _ref_addr.base());\n@@ -547,1 +547,1 @@\n-        __ addi(R4_ARG2, _ref_addr.base(), _ref_addr.disp()); \/\/ Clobbering _ref\n+        __ add(R4_ARG2, (intptr_t) _ref_addr.disp(), _ref_addr.base()); \/\/ Clobbering _ref\n@@ -551,1 +551,1 @@\n-        __ addi(R4_ARG2, _ref_addr.base(), _ref_addr.disp());\n+        __ add(R4_ARG2, (intptr_t) _ref_addr.disp(), _ref_addr.base());\n","filename":"src\/hotspot\/cpu\/ppc\/gc\/z\/zBarrierSetAssembler_ppc.cpp","additions":3,"deletions":3,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -3,1 +3,1 @@\n- * Copyright (c) 2012, 2022 SAP SE. All rights reserved.\n+ * Copyright (c) 2012, 2021 SAP SE. All rights reserved.\n@@ -1772,1 +1772,1 @@\n-      addi(R28_mdx, R28_mdx, off_to_args);\n+      add(R28_mdx, off_to_args, R28_mdx);\n","filename":"src\/hotspot\/cpu\/ppc\/interp_masm_ppc_64.cpp","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -26,1 +26,1 @@\n-#include \"runtime\/os.hpp\"\n+#include \"runtime\/os.hpp\" \/\/ malloc\n","filename":"src\/hotspot\/cpu\/ppc\/macroAssembler_ppc_sha.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -3,1 +3,1 @@\n- * Copyright (c) 2012, 2022 SAP SE. All rights reserved.\n+ * Copyright (c) 2012, 2021 SAP SE. All rights reserved.\n@@ -27,0 +27,1 @@\n+#include \"jvm.h\"\n@@ -31,1 +32,0 @@\n-#include \"jvm.h\"\n@@ -304,1 +304,1 @@\n-    __ addi(R15_argbase, R15_argbase, Interpreter::stackElementSize);\n+    __ add(R15_argbase, Interpreter::stackElementSize, R15_argbase);\n","filename":"src\/hotspot\/cpu\/ppc\/methodHandles_ppc.cpp","additions":3,"deletions":3,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -2,2 +2,2 @@\n- * Copyright (c) 2000, 2022, Oracle and\/or its affiliates. All rights reserved.\n- * Copyright (c) 2012, 2022 SAP SE. All rights reserved.\n+ * Copyright (c) 2000, 2018, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2012, 2018 SAP SE. All rights reserved.\n@@ -29,1 +29,2 @@\n-const char* Register::name() const {\n+\n+const char* RegisterImpl::name() const {\n@@ -39,1 +40,1 @@\n-const char* ConditionRegister::name() const {\n+const char* ConditionRegisterImpl::name() const {\n@@ -46,1 +47,1 @@\n-const char* FloatRegister::name() const {\n+const char* FloatRegisterImpl::name() const {\n@@ -56,1 +57,1 @@\n-const char* SpecialRegister::name() const {\n+const char* SpecialRegisterImpl::name() const {\n@@ -63,1 +64,1 @@\n-const char* VectorRegister::name() const {\n+const char* VectorRegisterImpl::name() const {\n@@ -73,1 +74,1 @@\n-const char* VectorSRegister::name() const {\n+const char* VectorSRegisterImpl::name() const {\n@@ -88,2 +89,2 @@\n-VectorSRegister FloatRegister::to_vsr() const {\n-  if (*this == fnoreg) { return vsnoreg; }\n+VectorSRegister FloatRegisterImpl::to_vsr() const {\n+  if (this == fnoreg) { return vsnoreg; }\n@@ -94,2 +95,2 @@\n-VectorSRegister VectorRegister::to_vsr() const {\n-  if (*this == vnoreg) { return vsnoreg; }\n+VectorSRegister VectorRegisterImpl::to_vsr() const {\n+  if (this == vnoreg) { return vsnoreg; }\n@@ -100,2 +101,2 @@\n-VectorRegister VectorSRegister::to_vr() const {\n-  if (*this == vsnoreg) { return vnoreg; }\n+VectorRegister VectorSRegisterImpl::to_vr() const {\n+  if (this == vsnoreg) { return vnoreg; }\n","filename":"src\/hotspot\/cpu\/ppc\/register_ppc.cpp","additions":15,"deletions":14,"binary":false,"changes":29,"status":"modified"},{"patch":"@@ -32,0 +32,1 @@\n+class Address;\n@@ -77,0 +78,8 @@\n+\/\/ Use Register as shortcut\n+class RegisterImpl;\n+typedef RegisterImpl* Register;\n+\n+inline Register as_Register(int encoding) {\n+  assert(encoding >= -1 && encoding < 32, \"bad register encoding\");\n+  return (Register)(intptr_t)encoding;\n+}\n@@ -79,2 +88,1 @@\n-class Register {\n-  int _encoding;\n+class RegisterImpl: public AbstractRegisterImpl {\n@@ -86,5 +94,0 @@\n-  constexpr Register(int encoding = -1) : _encoding(encoding) {}\n-  bool operator==(const Register rhs) const { return _encoding == rhs._encoding; }\n-  bool operator!=(const Register rhs) const { return _encoding != rhs._encoding; }\n-  const Register* operator->() const { return this; }\n-\n@@ -92,1 +95,1 @@\n-  inline constexpr friend Register as_Register(int encoding);\n+  inline friend Register as_Register(int encoding);\n@@ -95,3 +98,3 @@\n-  int encoding() const { assert(is_valid(), \"invalid register\"); return _encoding; }\n-  inline VMReg as_VMReg() const;\n-  Register successor() const { return Register(encoding() + 1); }\n+  int encoding() const { assert(is_valid(), \"invalid register\"); return value(); }\n+  inline VMReg as_VMReg();\n+  Register successor() const { return as_Register(encoding() + 1); }\n@@ -100,3 +103,3 @@\n-  bool is_valid()       const { return ( 0 <= _encoding && _encoding <  number_of_registers); }\n-  bool is_volatile()    const { return ( 0 <= _encoding && _encoding <= 13 ); }\n-  bool is_nonvolatile() const { return (14 <= _encoding && _encoding <= 31 ); }\n+  bool is_valid()       const { return ( 0 <= (value()&0x7F) && (value()&0x7F) <  number_of_registers); }\n+  bool is_volatile()    const { return ( 0 <= (value()&0x7F) && (value()&0x7F) <= 13 ); }\n+  bool is_nonvolatile() const { return (14 <= (value()&0x7F) && (value()&0x7F) <= 31 ); }\n@@ -107,5 +110,0 @@\n-inline constexpr Register as_Register(int encoding) {\n-  assert(encoding >= -1 && encoding < 32, \"bad register encoding\");\n-  return Register(encoding);\n-}\n-\n@@ -113,34 +111,35 @@\n-constexpr Register noreg = as_Register(-1);\n-\n-constexpr Register  R0 = as_Register( 0);\n-constexpr Register  R1 = as_Register( 1);\n-constexpr Register  R2 = as_Register( 2);\n-constexpr Register  R3 = as_Register( 3);\n-constexpr Register  R4 = as_Register( 4);\n-constexpr Register  R5 = as_Register( 5);\n-constexpr Register  R6 = as_Register( 6);\n-constexpr Register  R7 = as_Register( 7);\n-constexpr Register  R8 = as_Register( 8);\n-constexpr Register  R9 = as_Register( 9);\n-constexpr Register R10 = as_Register(10);\n-constexpr Register R11 = as_Register(11);\n-constexpr Register R12 = as_Register(12);\n-constexpr Register R13 = as_Register(13);\n-constexpr Register R14 = as_Register(14);\n-constexpr Register R15 = as_Register(15);\n-constexpr Register R16 = as_Register(16);\n-constexpr Register R17 = as_Register(17);\n-constexpr Register R18 = as_Register(18);\n-constexpr Register R19 = as_Register(19);\n-constexpr Register R20 = as_Register(20);\n-constexpr Register R21 = as_Register(21);\n-constexpr Register R22 = as_Register(22);\n-constexpr Register R23 = as_Register(23);\n-constexpr Register R24 = as_Register(24);\n-constexpr Register R25 = as_Register(25);\n-constexpr Register R26 = as_Register(26);\n-constexpr Register R27 = as_Register(27);\n-constexpr Register R28 = as_Register(28);\n-constexpr Register R29 = as_Register(29);\n-constexpr Register R30 = as_Register(30);\n-constexpr Register R31 = as_Register(31);\n+CONSTANT_REGISTER_DECLARATION(Register, noreg, (-1));\n+\n+CONSTANT_REGISTER_DECLARATION(Register, R0,   (0));\n+CONSTANT_REGISTER_DECLARATION(Register, R1,   (1));\n+CONSTANT_REGISTER_DECLARATION(Register, R2,   (2));\n+CONSTANT_REGISTER_DECLARATION(Register, R3,   (3));\n+CONSTANT_REGISTER_DECLARATION(Register, R4,   (4));\n+CONSTANT_REGISTER_DECLARATION(Register, R5,   (5));\n+CONSTANT_REGISTER_DECLARATION(Register, R6,   (6));\n+CONSTANT_REGISTER_DECLARATION(Register, R7,   (7));\n+CONSTANT_REGISTER_DECLARATION(Register, R8,   (8));\n+CONSTANT_REGISTER_DECLARATION(Register, R9,   (9));\n+CONSTANT_REGISTER_DECLARATION(Register, R10, (10));\n+CONSTANT_REGISTER_DECLARATION(Register, R11, (11));\n+CONSTANT_REGISTER_DECLARATION(Register, R12, (12));\n+CONSTANT_REGISTER_DECLARATION(Register, R13, (13));\n+CONSTANT_REGISTER_DECLARATION(Register, R14, (14));\n+CONSTANT_REGISTER_DECLARATION(Register, R15, (15));\n+CONSTANT_REGISTER_DECLARATION(Register, R16, (16));\n+CONSTANT_REGISTER_DECLARATION(Register, R17, (17));\n+CONSTANT_REGISTER_DECLARATION(Register, R18, (18));\n+CONSTANT_REGISTER_DECLARATION(Register, R19, (19));\n+CONSTANT_REGISTER_DECLARATION(Register, R20, (20));\n+CONSTANT_REGISTER_DECLARATION(Register, R21, (21));\n+CONSTANT_REGISTER_DECLARATION(Register, R22, (22));\n+CONSTANT_REGISTER_DECLARATION(Register, R23, (23));\n+CONSTANT_REGISTER_DECLARATION(Register, R24, (24));\n+CONSTANT_REGISTER_DECLARATION(Register, R25, (25));\n+CONSTANT_REGISTER_DECLARATION(Register, R26, (26));\n+CONSTANT_REGISTER_DECLARATION(Register, R27, (27));\n+CONSTANT_REGISTER_DECLARATION(Register, R28, (28));\n+CONSTANT_REGISTER_DECLARATION(Register, R29, (29));\n+CONSTANT_REGISTER_DECLARATION(Register, R30, (30));\n+CONSTANT_REGISTER_DECLARATION(Register, R31, (31));\n+\n@@ -148,0 +147,55 @@\n+\/\/\n+\/\/ Because Power has many registers, #define'ing values for them is\n+\/\/ beneficial in code size and is worth the cost of some of the\n+\/\/ dangers of defines. If a particular file has a problem with these\n+\/\/ defines then it's possible to turn them off in that file by\n+\/\/ defining DONT_USE_REGISTER_DEFINES. Register_definition_ppc.cpp\n+\/\/ does that so that it's able to provide real definitions of these\n+\/\/ registers for use in debuggers and such.\n+\/\/\n+\n+#ifndef DONT_USE_REGISTER_DEFINES\n+#define noreg ((Register)(noreg_RegisterEnumValue))\n+\n+#define R0 ((Register)(R0_RegisterEnumValue))\n+#define R1 ((Register)(R1_RegisterEnumValue))\n+#define R2 ((Register)(R2_RegisterEnumValue))\n+#define R3 ((Register)(R3_RegisterEnumValue))\n+#define R4 ((Register)(R4_RegisterEnumValue))\n+#define R5 ((Register)(R5_RegisterEnumValue))\n+#define R6 ((Register)(R6_RegisterEnumValue))\n+#define R7 ((Register)(R7_RegisterEnumValue))\n+#define R8 ((Register)(R8_RegisterEnumValue))\n+#define R9 ((Register)(R9_RegisterEnumValue))\n+#define R10 ((Register)(R10_RegisterEnumValue))\n+#define R11 ((Register)(R11_RegisterEnumValue))\n+#define R12 ((Register)(R12_RegisterEnumValue))\n+#define R13 ((Register)(R13_RegisterEnumValue))\n+#define R14 ((Register)(R14_RegisterEnumValue))\n+#define R15 ((Register)(R15_RegisterEnumValue))\n+#define R16 ((Register)(R16_RegisterEnumValue))\n+#define R17 ((Register)(R17_RegisterEnumValue))\n+#define R18 ((Register)(R18_RegisterEnumValue))\n+#define R19 ((Register)(R19_RegisterEnumValue))\n+#define R20 ((Register)(R20_RegisterEnumValue))\n+#define R21 ((Register)(R21_RegisterEnumValue))\n+#define R22 ((Register)(R22_RegisterEnumValue))\n+#define R23 ((Register)(R23_RegisterEnumValue))\n+#define R24 ((Register)(R24_RegisterEnumValue))\n+#define R25 ((Register)(R25_RegisterEnumValue))\n+#define R26 ((Register)(R26_RegisterEnumValue))\n+#define R27 ((Register)(R27_RegisterEnumValue))\n+#define R28 ((Register)(R28_RegisterEnumValue))\n+#define R29 ((Register)(R29_RegisterEnumValue))\n+#define R30 ((Register)(R30_RegisterEnumValue))\n+#define R31 ((Register)(R31_RegisterEnumValue))\n+#endif\n+\n+\/\/ Use ConditionRegister as shortcut\n+class ConditionRegisterImpl;\n+typedef ConditionRegisterImpl* ConditionRegister;\n+\n+inline ConditionRegister as_ConditionRegister(int encoding) {\n+  assert(encoding >= 0 && encoding < 8, \"bad condition register encoding\");\n+  return (ConditionRegister)(intptr_t)encoding;\n+}\n@@ -150,2 +204,1 @@\n-class ConditionRegister {\n-  int _encoding;\n+class ConditionRegisterImpl: public AbstractRegisterImpl {\n@@ -157,5 +210,0 @@\n-  constexpr ConditionRegister(int encoding = -1) : _encoding(encoding) {}\n-  bool operator==(const ConditionRegister rhs) const { return _encoding == rhs._encoding; }\n-  bool operator!=(const ConditionRegister rhs) const { return _encoding != rhs._encoding; }\n-  const ConditionRegister* operator->() const { return this; }\n-\n@@ -163,1 +211,1 @@\n-  inline constexpr friend ConditionRegister as_ConditionRegister(int encoding);\n+  inline friend ConditionRegister as_ConditionRegister(int encoding);\n@@ -166,2 +214,2 @@\n-  int encoding() const { assert(is_valid(), \"invalid register\"); return _encoding; }\n-  inline VMReg as_VMReg() const;\n+  int encoding() const { assert(is_valid(), \"invalid register\"); return value(); }\n+  inline VMReg as_VMReg();\n@@ -170,2 +218,2 @@\n-  bool is_valid()       const { return (0 <= _encoding && _encoding <  number_of_registers); }\n-  bool is_nonvolatile() const { return (2 <= _encoding && _encoding <= 4 );  }\n+  bool is_valid()       const { return  (0 <= value()        &&  value() < number_of_registers); }\n+  bool is_nonvolatile() const { return  (2 <= (value()&0x7F) && (value()&0x7F) <= 4 );  }\n@@ -176,3 +224,36 @@\n-inline constexpr ConditionRegister as_ConditionRegister(int encoding) {\n-  assert(encoding >= 0 && encoding < 8, \"bad condition register encoding\");\n-  return ConditionRegister(encoding);\n+\/\/ The (parts of the) condition register(s) of the PPC architecture\n+\/\/ sys\/ioctl.h on AIX defines CR0-CR3, so I name these CCR.\n+CONSTANT_REGISTER_DECLARATION(ConditionRegister, CCR0,   (0));\n+CONSTANT_REGISTER_DECLARATION(ConditionRegister, CCR1,   (1));\n+CONSTANT_REGISTER_DECLARATION(ConditionRegister, CCR2,   (2));\n+CONSTANT_REGISTER_DECLARATION(ConditionRegister, CCR3,   (3));\n+CONSTANT_REGISTER_DECLARATION(ConditionRegister, CCR4,   (4));\n+CONSTANT_REGISTER_DECLARATION(ConditionRegister, CCR5,   (5));\n+CONSTANT_REGISTER_DECLARATION(ConditionRegister, CCR6,   (6));\n+CONSTANT_REGISTER_DECLARATION(ConditionRegister, CCR7,   (7));\n+\n+#ifndef DONT_USE_REGISTER_DEFINES\n+\n+#define CCR0 ((ConditionRegister)(CCR0_ConditionRegisterEnumValue))\n+#define CCR1 ((ConditionRegister)(CCR1_ConditionRegisterEnumValue))\n+#define CCR2 ((ConditionRegister)(CCR2_ConditionRegisterEnumValue))\n+#define CCR3 ((ConditionRegister)(CCR3_ConditionRegisterEnumValue))\n+#define CCR4 ((ConditionRegister)(CCR4_ConditionRegisterEnumValue))\n+#define CCR5 ((ConditionRegister)(CCR5_ConditionRegisterEnumValue))\n+#define CCR6 ((ConditionRegister)(CCR6_ConditionRegisterEnumValue))\n+#define CCR7 ((ConditionRegister)(CCR7_ConditionRegisterEnumValue))\n+\n+#endif \/\/ DONT_USE_REGISTER_DEFINES\n+\n+\/\/ Forward declaration\n+\/\/ Use VectorSRegister as a shortcut.\n+class VectorSRegisterImpl;\n+typedef VectorSRegisterImpl* VectorSRegister;\n+\n+\/\/ Use FloatRegister as shortcut\n+class FloatRegisterImpl;\n+typedef FloatRegisterImpl* FloatRegister;\n+\n+inline FloatRegister as_FloatRegister(int encoding) {\n+  assert(encoding >= -1 && encoding < 32, \"bad float register encoding\");\n+  return (FloatRegister)(intptr_t)encoding;\n@@ -181,12 +262,0 @@\n-constexpr ConditionRegister CCR0 = as_ConditionRegister(0);\n-constexpr ConditionRegister CCR1 = as_ConditionRegister(1);\n-constexpr ConditionRegister CCR2 = as_ConditionRegister(2);\n-constexpr ConditionRegister CCR3 = as_ConditionRegister(3);\n-constexpr ConditionRegister CCR4 = as_ConditionRegister(4);\n-constexpr ConditionRegister CCR5 = as_ConditionRegister(5);\n-constexpr ConditionRegister CCR6 = as_ConditionRegister(6);\n-constexpr ConditionRegister CCR7 = as_ConditionRegister(7);\n-\n-\n-class VectorSRegister;\n-\n@@ -194,2 +263,1 @@\n-class FloatRegister {\n-  int _encoding;\n+class FloatRegisterImpl: public AbstractRegisterImpl {\n@@ -201,5 +269,0 @@\n-  constexpr FloatRegister(int encoding = -1) : _encoding(encoding) {}\n-  bool operator==(const FloatRegister rhs) const { return _encoding == rhs._encoding; }\n-  bool operator!=(const FloatRegister rhs) const { return _encoding != rhs._encoding; }\n-  const FloatRegister* operator->() const { return this; }\n-\n@@ -207,1 +270,1 @@\n-  inline constexpr friend FloatRegister as_FloatRegister(int encoding);\n+  inline friend FloatRegister as_FloatRegister(int encoding);\n@@ -210,3 +273,3 @@\n-  int encoding() const { assert(is_valid(), \"invalid register\"); return _encoding; }\n-  inline VMReg as_VMReg() const;\n-  FloatRegister successor() const { return FloatRegister(encoding() + 1); }\n+  int           encoding() const { assert(is_valid(), \"invalid register\"); return value(); }\n+  inline VMReg  as_VMReg();\n+  FloatRegister successor() const { return as_FloatRegister(encoding() + 1); }\n@@ -215,1 +278,1 @@\n-  bool is_valid() const { return (0 <= _encoding && _encoding < number_of_registers); }\n+  bool is_valid() const { return (0 <= value() && value() < number_of_registers); }\n@@ -223,5 +286,0 @@\n-inline constexpr FloatRegister as_FloatRegister(int encoding) {\n-  assert(encoding >= -1 && encoding < 32, \"bad float register encoding\");\n-  return FloatRegister(encoding);\n-}\n-\n@@ -229,35 +287,78 @@\n-constexpr FloatRegister fnoreg = as_FloatRegister(-1);\n-\n-constexpr FloatRegister  F0 = as_FloatRegister( 0);\n-constexpr FloatRegister  F1 = as_FloatRegister( 1);\n-constexpr FloatRegister  F2 = as_FloatRegister( 2);\n-constexpr FloatRegister  F3 = as_FloatRegister( 3);\n-constexpr FloatRegister  F4 = as_FloatRegister( 4);\n-constexpr FloatRegister  F5 = as_FloatRegister( 5);\n-constexpr FloatRegister  F6 = as_FloatRegister( 6);\n-constexpr FloatRegister  F7 = as_FloatRegister( 7);\n-constexpr FloatRegister  F8 = as_FloatRegister( 8);\n-constexpr FloatRegister  F9 = as_FloatRegister( 9);\n-constexpr FloatRegister F10 = as_FloatRegister(10);\n-constexpr FloatRegister F11 = as_FloatRegister(11);\n-constexpr FloatRegister F12 = as_FloatRegister(12);\n-constexpr FloatRegister F13 = as_FloatRegister(13);\n-constexpr FloatRegister F14 = as_FloatRegister(14);\n-constexpr FloatRegister F15 = as_FloatRegister(15);\n-constexpr FloatRegister F16 = as_FloatRegister(16);\n-constexpr FloatRegister F17 = as_FloatRegister(17);\n-constexpr FloatRegister F18 = as_FloatRegister(18);\n-constexpr FloatRegister F19 = as_FloatRegister(19);\n-constexpr FloatRegister F20 = as_FloatRegister(20);\n-constexpr FloatRegister F21 = as_FloatRegister(21);\n-constexpr FloatRegister F22 = as_FloatRegister(22);\n-constexpr FloatRegister F23 = as_FloatRegister(23);\n-constexpr FloatRegister F24 = as_FloatRegister(24);\n-constexpr FloatRegister F25 = as_FloatRegister(25);\n-constexpr FloatRegister F26 = as_FloatRegister(26);\n-constexpr FloatRegister F27 = as_FloatRegister(27);\n-constexpr FloatRegister F28 = as_FloatRegister(28);\n-constexpr FloatRegister F29 = as_FloatRegister(29);\n-constexpr FloatRegister F30 = as_FloatRegister(30);\n-constexpr FloatRegister F31 = as_FloatRegister(31);\n-\n+CONSTANT_REGISTER_DECLARATION(FloatRegister, fnoreg, (-1));\n+\n+CONSTANT_REGISTER_DECLARATION(FloatRegister, F0,  ( 0));\n+CONSTANT_REGISTER_DECLARATION(FloatRegister, F1,  ( 1));\n+CONSTANT_REGISTER_DECLARATION(FloatRegister, F2,  ( 2));\n+CONSTANT_REGISTER_DECLARATION(FloatRegister, F3,  ( 3));\n+CONSTANT_REGISTER_DECLARATION(FloatRegister, F4,  ( 4));\n+CONSTANT_REGISTER_DECLARATION(FloatRegister, F5,  ( 5));\n+CONSTANT_REGISTER_DECLARATION(FloatRegister, F6,  ( 6));\n+CONSTANT_REGISTER_DECLARATION(FloatRegister, F7,  ( 7));\n+CONSTANT_REGISTER_DECLARATION(FloatRegister, F8,  ( 8));\n+CONSTANT_REGISTER_DECLARATION(FloatRegister, F9,  ( 9));\n+CONSTANT_REGISTER_DECLARATION(FloatRegister, F10, (10));\n+CONSTANT_REGISTER_DECLARATION(FloatRegister, F11, (11));\n+CONSTANT_REGISTER_DECLARATION(FloatRegister, F12, (12));\n+CONSTANT_REGISTER_DECLARATION(FloatRegister, F13, (13));\n+CONSTANT_REGISTER_DECLARATION(FloatRegister, F14, (14));\n+CONSTANT_REGISTER_DECLARATION(FloatRegister, F15, (15));\n+CONSTANT_REGISTER_DECLARATION(FloatRegister, F16, (16));\n+CONSTANT_REGISTER_DECLARATION(FloatRegister, F17, (17));\n+CONSTANT_REGISTER_DECLARATION(FloatRegister, F18, (18));\n+CONSTANT_REGISTER_DECLARATION(FloatRegister, F19, (19));\n+CONSTANT_REGISTER_DECLARATION(FloatRegister, F20, (20));\n+CONSTANT_REGISTER_DECLARATION(FloatRegister, F21, (21));\n+CONSTANT_REGISTER_DECLARATION(FloatRegister, F22, (22));\n+CONSTANT_REGISTER_DECLARATION(FloatRegister, F23, (23));\n+CONSTANT_REGISTER_DECLARATION(FloatRegister, F24, (24));\n+CONSTANT_REGISTER_DECLARATION(FloatRegister, F25, (25));\n+CONSTANT_REGISTER_DECLARATION(FloatRegister, F26, (26));\n+CONSTANT_REGISTER_DECLARATION(FloatRegister, F27, (27));\n+CONSTANT_REGISTER_DECLARATION(FloatRegister, F28, (28));\n+CONSTANT_REGISTER_DECLARATION(FloatRegister, F29, (29));\n+CONSTANT_REGISTER_DECLARATION(FloatRegister, F30, (30));\n+CONSTANT_REGISTER_DECLARATION(FloatRegister, F31, (31));\n+\n+#ifndef DONT_USE_REGISTER_DEFINES\n+#define fnoreg ((FloatRegister)(fnoreg_FloatRegisterEnumValue))\n+#define F0     ((FloatRegister)(    F0_FloatRegisterEnumValue))\n+#define F1     ((FloatRegister)(    F1_FloatRegisterEnumValue))\n+#define F2     ((FloatRegister)(    F2_FloatRegisterEnumValue))\n+#define F3     ((FloatRegister)(    F3_FloatRegisterEnumValue))\n+#define F4     ((FloatRegister)(    F4_FloatRegisterEnumValue))\n+#define F5     ((FloatRegister)(    F5_FloatRegisterEnumValue))\n+#define F6     ((FloatRegister)(    F6_FloatRegisterEnumValue))\n+#define F7     ((FloatRegister)(    F7_FloatRegisterEnumValue))\n+#define F8     ((FloatRegister)(    F8_FloatRegisterEnumValue))\n+#define F9     ((FloatRegister)(    F9_FloatRegisterEnumValue))\n+#define F10    ((FloatRegister)(   F10_FloatRegisterEnumValue))\n+#define F11    ((FloatRegister)(   F11_FloatRegisterEnumValue))\n+#define F12    ((FloatRegister)(   F12_FloatRegisterEnumValue))\n+#define F13    ((FloatRegister)(   F13_FloatRegisterEnumValue))\n+#define F14    ((FloatRegister)(   F14_FloatRegisterEnumValue))\n+#define F15    ((FloatRegister)(   F15_FloatRegisterEnumValue))\n+#define F16    ((FloatRegister)(   F16_FloatRegisterEnumValue))\n+#define F17    ((FloatRegister)(   F17_FloatRegisterEnumValue))\n+#define F18    ((FloatRegister)(   F18_FloatRegisterEnumValue))\n+#define F19    ((FloatRegister)(   F19_FloatRegisterEnumValue))\n+#define F20    ((FloatRegister)(   F20_FloatRegisterEnumValue))\n+#define F21    ((FloatRegister)(   F21_FloatRegisterEnumValue))\n+#define F22    ((FloatRegister)(   F22_FloatRegisterEnumValue))\n+#define F23    ((FloatRegister)(   F23_FloatRegisterEnumValue))\n+#define F24    ((FloatRegister)(   F24_FloatRegisterEnumValue))\n+#define F25    ((FloatRegister)(   F25_FloatRegisterEnumValue))\n+#define F26    ((FloatRegister)(   F26_FloatRegisterEnumValue))\n+#define F27    ((FloatRegister)(   F27_FloatRegisterEnumValue))\n+#define F28    ((FloatRegister)(   F28_FloatRegisterEnumValue))\n+#define F29    ((FloatRegister)(   F29_FloatRegisterEnumValue))\n+#define F30    ((FloatRegister)(   F30_FloatRegisterEnumValue))\n+#define F31    ((FloatRegister)(   F31_FloatRegisterEnumValue))\n+#endif \/\/ DONT_USE_REGISTER_DEFINES\n+\n+\/\/ Use SpecialRegister as shortcut\n+class SpecialRegisterImpl;\n+typedef SpecialRegisterImpl* SpecialRegister;\n+\n+inline SpecialRegister as_SpecialRegister(int encoding) {\n+  return (SpecialRegister)(intptr_t)encoding;\n+}\n@@ -266,2 +367,1 @@\n-class SpecialRegister {\n-  int _encoding;\n+class SpecialRegisterImpl: public AbstractRegisterImpl {\n@@ -273,5 +373,0 @@\n-  constexpr SpecialRegister(int encoding = -1) : _encoding(encoding) {}\n-  bool operator==(const SpecialRegister rhs) const { return _encoding == rhs._encoding; }\n-  bool operator!=(const SpecialRegister rhs) const { return _encoding != rhs._encoding; }\n-  const SpecialRegister* operator->() const { return this; }\n-\n@@ -279,1 +374,1 @@\n-  inline constexpr friend SpecialRegister as_SpecialRegister(int encoding);\n+  inline friend SpecialRegister as_SpecialRegister(int encoding);\n@@ -282,2 +377,2 @@\n-  int encoding() const { assert(is_valid(), \"invalid register\"); return _encoding; }\n-  inline VMReg as_VMReg() const;\n+  int             encoding()  const { assert(is_valid(), \"invalid register\"); return value(); }\n+  inline VMReg    as_VMReg();\n@@ -286,1 +381,1 @@\n-  bool is_valid() const { return (0 <= _encoding && _encoding < number_of_registers); }\n+  bool is_valid()       const { return 0 <= value() && value() < number_of_registers; }\n@@ -291,4 +386,0 @@\n-inline constexpr SpecialRegister as_SpecialRegister(int encoding) {\n-  return SpecialRegister(encoding);\n-}\n-\n@@ -296,7 +387,24 @@\n-constexpr SpecialRegister SR_XER     = as_SpecialRegister(0);\n-constexpr SpecialRegister SR_LR      = as_SpecialRegister(1);\n-constexpr SpecialRegister SR_CTR     = as_SpecialRegister(2);\n-constexpr SpecialRegister SR_VRSAVE  = as_SpecialRegister(3);\n-constexpr SpecialRegister SR_SPEFSCR = as_SpecialRegister(4);\n-constexpr SpecialRegister SR_PPR     = as_SpecialRegister(5);\n-\n+CONSTANT_REGISTER_DECLARATION(SpecialRegister, SR_XER,     (0));\n+CONSTANT_REGISTER_DECLARATION(SpecialRegister, SR_LR,      (1));\n+CONSTANT_REGISTER_DECLARATION(SpecialRegister, SR_CTR,     (2));\n+CONSTANT_REGISTER_DECLARATION(SpecialRegister, SR_VRSAVE,  (3));\n+CONSTANT_REGISTER_DECLARATION(SpecialRegister, SR_SPEFSCR, (4));\n+CONSTANT_REGISTER_DECLARATION(SpecialRegister, SR_PPR,     (5));\n+\n+#ifndef DONT_USE_REGISTER_DEFINES\n+#define SR_XER     ((SpecialRegister)(SR_XER_SpecialRegisterEnumValue))\n+#define SR_LR      ((SpecialRegister)(SR_LR_SpecialRegisterEnumValue))\n+#define SR_CTR     ((SpecialRegister)(SR_CTR_SpecialRegisterEnumValue))\n+#define SR_VRSAVE  ((SpecialRegister)(SR_VRSAVE_SpecialRegisterEnumValue))\n+#define SR_SPEFSCR ((SpecialRegister)(SR_SPEFSCR_SpecialRegisterEnumValue))\n+#define SR_PPR     ((SpecialRegister)(SR_PPR_SpecialRegisterEnumValue))\n+#endif \/\/ DONT_USE_REGISTER_DEFINES\n+\n+\n+\/\/ Use VectorRegister as shortcut\n+class VectorRegisterImpl;\n+typedef VectorRegisterImpl* VectorRegister;\n+\n+inline VectorRegister as_VectorRegister(int encoding) {\n+  return (VectorRegister)(intptr_t)encoding;\n+}\n@@ -305,2 +413,1 @@\n-class VectorRegister {\n-  int _encoding;\n+class VectorRegisterImpl: public AbstractRegisterImpl {\n@@ -312,5 +419,0 @@\n-  constexpr VectorRegister(int encoding = -1) : _encoding(encoding) {}\n-  bool operator==(const VectorRegister rhs) const { return _encoding == rhs._encoding; }\n-  bool operator!=(const VectorRegister rhs) const { return _encoding != rhs._encoding; }\n-  const VectorRegister* operator->() const { return this; }\n-\n@@ -318,1 +420,1 @@\n-  inline constexpr friend VectorRegister as_VectorRegister(int encoding);\n+  inline friend VectorRegister as_VectorRegister(int encoding);\n@@ -321,1 +423,1 @@\n-  int encoding()  const { assert(is_valid(), \"invalid register\"); return _encoding; }\n+  int            encoding()  const { assert(is_valid(), \"invalid register\"); return value(); }\n@@ -324,1 +426,1 @@\n-  bool is_valid() const { return (0 <= _encoding && _encoding < number_of_registers); }\n+  bool is_valid()       const { return   0 <=  value()       &&  value() < number_of_registers; }\n@@ -332,4 +434,0 @@\n-inline constexpr VectorRegister as_VectorRegister(int encoding) {\n-  return VectorRegister(encoding);\n-}\n-\n@@ -337,34 +435,0 @@\n-constexpr VectorRegister vnoreg = as_VectorRegister(-1);\n-\n-constexpr VectorRegister  VR0 = as_VectorRegister( 0);\n-constexpr VectorRegister  VR1 = as_VectorRegister( 1);\n-constexpr VectorRegister  VR2 = as_VectorRegister( 2);\n-constexpr VectorRegister  VR3 = as_VectorRegister( 3);\n-constexpr VectorRegister  VR4 = as_VectorRegister( 4);\n-constexpr VectorRegister  VR5 = as_VectorRegister( 5);\n-constexpr VectorRegister  VR6 = as_VectorRegister( 6);\n-constexpr VectorRegister  VR7 = as_VectorRegister( 7);\n-constexpr VectorRegister  VR8 = as_VectorRegister( 8);\n-constexpr VectorRegister  VR9 = as_VectorRegister( 9);\n-constexpr VectorRegister VR10 = as_VectorRegister(10);\n-constexpr VectorRegister VR11 = as_VectorRegister(11);\n-constexpr VectorRegister VR12 = as_VectorRegister(12);\n-constexpr VectorRegister VR13 = as_VectorRegister(13);\n-constexpr VectorRegister VR14 = as_VectorRegister(14);\n-constexpr VectorRegister VR15 = as_VectorRegister(15);\n-constexpr VectorRegister VR16 = as_VectorRegister(16);\n-constexpr VectorRegister VR17 = as_VectorRegister(17);\n-constexpr VectorRegister VR18 = as_VectorRegister(18);\n-constexpr VectorRegister VR19 = as_VectorRegister(19);\n-constexpr VectorRegister VR20 = as_VectorRegister(20);\n-constexpr VectorRegister VR21 = as_VectorRegister(21);\n-constexpr VectorRegister VR22 = as_VectorRegister(22);\n-constexpr VectorRegister VR23 = as_VectorRegister(23);\n-constexpr VectorRegister VR24 = as_VectorRegister(24);\n-constexpr VectorRegister VR25 = as_VectorRegister(25);\n-constexpr VectorRegister VR26 = as_VectorRegister(26);\n-constexpr VectorRegister VR27 = as_VectorRegister(27);\n-constexpr VectorRegister VR28 = as_VectorRegister(28);\n-constexpr VectorRegister VR29 = as_VectorRegister(29);\n-constexpr VectorRegister VR30 = as_VectorRegister(30);\n-constexpr VectorRegister VR31 = as_VectorRegister(31);\n@@ -372,0 +436,75 @@\n+CONSTANT_REGISTER_DECLARATION(VectorRegister, vnoreg, (-1));\n+\n+CONSTANT_REGISTER_DECLARATION(VectorRegister, VR0,  ( 0));\n+CONSTANT_REGISTER_DECLARATION(VectorRegister, VR1,  ( 1));\n+CONSTANT_REGISTER_DECLARATION(VectorRegister, VR2,  ( 2));\n+CONSTANT_REGISTER_DECLARATION(VectorRegister, VR3,  ( 3));\n+CONSTANT_REGISTER_DECLARATION(VectorRegister, VR4,  ( 4));\n+CONSTANT_REGISTER_DECLARATION(VectorRegister, VR5,  ( 5));\n+CONSTANT_REGISTER_DECLARATION(VectorRegister, VR6,  ( 6));\n+CONSTANT_REGISTER_DECLARATION(VectorRegister, VR7,  ( 7));\n+CONSTANT_REGISTER_DECLARATION(VectorRegister, VR8,  ( 8));\n+CONSTANT_REGISTER_DECLARATION(VectorRegister, VR9,  ( 9));\n+CONSTANT_REGISTER_DECLARATION(VectorRegister, VR10, (10));\n+CONSTANT_REGISTER_DECLARATION(VectorRegister, VR11, (11));\n+CONSTANT_REGISTER_DECLARATION(VectorRegister, VR12, (12));\n+CONSTANT_REGISTER_DECLARATION(VectorRegister, VR13, (13));\n+CONSTANT_REGISTER_DECLARATION(VectorRegister, VR14, (14));\n+CONSTANT_REGISTER_DECLARATION(VectorRegister, VR15, (15));\n+CONSTANT_REGISTER_DECLARATION(VectorRegister, VR16, (16));\n+CONSTANT_REGISTER_DECLARATION(VectorRegister, VR17, (17));\n+CONSTANT_REGISTER_DECLARATION(VectorRegister, VR18, (18));\n+CONSTANT_REGISTER_DECLARATION(VectorRegister, VR19, (19));\n+CONSTANT_REGISTER_DECLARATION(VectorRegister, VR20, (20));\n+CONSTANT_REGISTER_DECLARATION(VectorRegister, VR21, (21));\n+CONSTANT_REGISTER_DECLARATION(VectorRegister, VR22, (22));\n+CONSTANT_REGISTER_DECLARATION(VectorRegister, VR23, (23));\n+CONSTANT_REGISTER_DECLARATION(VectorRegister, VR24, (24));\n+CONSTANT_REGISTER_DECLARATION(VectorRegister, VR25, (25));\n+CONSTANT_REGISTER_DECLARATION(VectorRegister, VR26, (26));\n+CONSTANT_REGISTER_DECLARATION(VectorRegister, VR27, (27));\n+CONSTANT_REGISTER_DECLARATION(VectorRegister, VR28, (28));\n+CONSTANT_REGISTER_DECLARATION(VectorRegister, VR29, (29));\n+CONSTANT_REGISTER_DECLARATION(VectorRegister, VR30, (30));\n+CONSTANT_REGISTER_DECLARATION(VectorRegister, VR31, (31));\n+\n+#ifndef DONT_USE_REGISTER_DEFINES\n+#define vnoreg ((VectorRegister)(vnoreg_VectorRegisterEnumValue))\n+#define VR0    ((VectorRegister)(   VR0_VectorRegisterEnumValue))\n+#define VR1    ((VectorRegister)(   VR1_VectorRegisterEnumValue))\n+#define VR2    ((VectorRegister)(   VR2_VectorRegisterEnumValue))\n+#define VR3    ((VectorRegister)(   VR3_VectorRegisterEnumValue))\n+#define VR4    ((VectorRegister)(   VR4_VectorRegisterEnumValue))\n+#define VR5    ((VectorRegister)(   VR5_VectorRegisterEnumValue))\n+#define VR6    ((VectorRegister)(   VR6_VectorRegisterEnumValue))\n+#define VR7    ((VectorRegister)(   VR7_VectorRegisterEnumValue))\n+#define VR8    ((VectorRegister)(   VR8_VectorRegisterEnumValue))\n+#define VR9    ((VectorRegister)(   VR9_VectorRegisterEnumValue))\n+#define VR10   ((VectorRegister)(  VR10_VectorRegisterEnumValue))\n+#define VR11   ((VectorRegister)(  VR11_VectorRegisterEnumValue))\n+#define VR12   ((VectorRegister)(  VR12_VectorRegisterEnumValue))\n+#define VR13   ((VectorRegister)(  VR13_VectorRegisterEnumValue))\n+#define VR14   ((VectorRegister)(  VR14_VectorRegisterEnumValue))\n+#define VR15   ((VectorRegister)(  VR15_VectorRegisterEnumValue))\n+#define VR16   ((VectorRegister)(  VR16_VectorRegisterEnumValue))\n+#define VR17   ((VectorRegister)(  VR17_VectorRegisterEnumValue))\n+#define VR18   ((VectorRegister)(  VR18_VectorRegisterEnumValue))\n+#define VR19   ((VectorRegister)(  VR19_VectorRegisterEnumValue))\n+#define VR20   ((VectorRegister)(  VR20_VectorRegisterEnumValue))\n+#define VR21   ((VectorRegister)(  VR21_VectorRegisterEnumValue))\n+#define VR22   ((VectorRegister)(  VR22_VectorRegisterEnumValue))\n+#define VR23   ((VectorRegister)(  VR23_VectorRegisterEnumValue))\n+#define VR24   ((VectorRegister)(  VR24_VectorRegisterEnumValue))\n+#define VR25   ((VectorRegister)(  VR25_VectorRegisterEnumValue))\n+#define VR26   ((VectorRegister)(  VR26_VectorRegisterEnumValue))\n+#define VR27   ((VectorRegister)(  VR27_VectorRegisterEnumValue))\n+#define VR28   ((VectorRegister)(  VR28_VectorRegisterEnumValue))\n+#define VR29   ((VectorRegister)(  VR29_VectorRegisterEnumValue))\n+#define VR30   ((VectorRegister)(  VR30_VectorRegisterEnumValue))\n+#define VR31   ((VectorRegister)(  VR31_VectorRegisterEnumValue))\n+#endif \/\/ DONT_USE_REGISTER_DEFINES\n+\n+\n+inline VectorSRegister as_VectorSRegister(int encoding) {\n+  return (VectorSRegister)(intptr_t)encoding;\n+}\n@@ -374,2 +513,1 @@\n-class VectorSRegister {\n-  int _encoding;\n+class VectorSRegisterImpl: public AbstractRegisterImpl {\n@@ -381,5 +519,0 @@\n-  constexpr VectorSRegister(int encoding = -1) : _encoding(encoding) {}\n-  bool operator==(const VectorSRegister rhs) const { return _encoding == rhs._encoding; }\n-  bool operator!=(const VectorSRegister rhs) const { return _encoding != rhs._encoding; }\n-  const VectorSRegister* operator->() const { return this; }\n-\n@@ -387,1 +520,1 @@\n-  inline constexpr friend VectorSRegister as_VectorSRegister(int encoding);\n+  inline friend VectorSRegister as_VectorSRegister(int encoding);\n@@ -390,2 +523,2 @@\n-  int encoding() const { assert(is_valid(), \"invalid register\"); return _encoding; }\n-  inline VMReg as_VMReg() const;\n+  int encoding() const { assert(is_valid(), \"invalid register\"); return value(); }\n+  inline VMReg as_VMReg();\n@@ -394,1 +527,1 @@\n-  bool is_valid() const { return (0 <= _encoding && _encoding < number_of_registers); }\n+  bool is_valid() const { return 0 <=  value() &&  value() < number_of_registers; }\n@@ -402,4 +535,0 @@\n-inline constexpr VectorSRegister as_VectorSRegister(int encoding) {\n-  return VectorSRegister(encoding);\n-}\n-\n@@ -407,66 +536,138 @@\n-constexpr VectorSRegister vsnoreg = as_VectorSRegister(-1);\n-\n-constexpr VectorSRegister  VSR0 = as_VectorSRegister( 0);\n-constexpr VectorSRegister  VSR1 = as_VectorSRegister( 1);\n-constexpr VectorSRegister  VSR2 = as_VectorSRegister( 2);\n-constexpr VectorSRegister  VSR3 = as_VectorSRegister( 3);\n-constexpr VectorSRegister  VSR4 = as_VectorSRegister( 4);\n-constexpr VectorSRegister  VSR5 = as_VectorSRegister( 5);\n-constexpr VectorSRegister  VSR6 = as_VectorSRegister( 6);\n-constexpr VectorSRegister  VSR7 = as_VectorSRegister( 7);\n-constexpr VectorSRegister  VSR8 = as_VectorSRegister( 8);\n-constexpr VectorSRegister  VSR9 = as_VectorSRegister( 9);\n-constexpr VectorSRegister VSR10 = as_VectorSRegister(10);\n-constexpr VectorSRegister VSR11 = as_VectorSRegister(11);\n-constexpr VectorSRegister VSR12 = as_VectorSRegister(12);\n-constexpr VectorSRegister VSR13 = as_VectorSRegister(13);\n-constexpr VectorSRegister VSR14 = as_VectorSRegister(14);\n-constexpr VectorSRegister VSR15 = as_VectorSRegister(15);\n-constexpr VectorSRegister VSR16 = as_VectorSRegister(16);\n-constexpr VectorSRegister VSR17 = as_VectorSRegister(17);\n-constexpr VectorSRegister VSR18 = as_VectorSRegister(18);\n-constexpr VectorSRegister VSR19 = as_VectorSRegister(19);\n-constexpr VectorSRegister VSR20 = as_VectorSRegister(20);\n-constexpr VectorSRegister VSR21 = as_VectorSRegister(21);\n-constexpr VectorSRegister VSR22 = as_VectorSRegister(22);\n-constexpr VectorSRegister VSR23 = as_VectorSRegister(23);\n-constexpr VectorSRegister VSR24 = as_VectorSRegister(24);\n-constexpr VectorSRegister VSR25 = as_VectorSRegister(25);\n-constexpr VectorSRegister VSR26 = as_VectorSRegister(26);\n-constexpr VectorSRegister VSR27 = as_VectorSRegister(27);\n-constexpr VectorSRegister VSR28 = as_VectorSRegister(28);\n-constexpr VectorSRegister VSR29 = as_VectorSRegister(29);\n-constexpr VectorSRegister VSR30 = as_VectorSRegister(30);\n-constexpr VectorSRegister VSR31 = as_VectorSRegister(31);\n-constexpr VectorSRegister VSR32 = as_VectorSRegister(32);\n-constexpr VectorSRegister VSR33 = as_VectorSRegister(33);\n-constexpr VectorSRegister VSR34 = as_VectorSRegister(34);\n-constexpr VectorSRegister VSR35 = as_VectorSRegister(35);\n-constexpr VectorSRegister VSR36 = as_VectorSRegister(36);\n-constexpr VectorSRegister VSR37 = as_VectorSRegister(37);\n-constexpr VectorSRegister VSR38 = as_VectorSRegister(38);\n-constexpr VectorSRegister VSR39 = as_VectorSRegister(39);\n-constexpr VectorSRegister VSR40 = as_VectorSRegister(40);\n-constexpr VectorSRegister VSR41 = as_VectorSRegister(41);\n-constexpr VectorSRegister VSR42 = as_VectorSRegister(42);\n-constexpr VectorSRegister VSR43 = as_VectorSRegister(43);\n-constexpr VectorSRegister VSR44 = as_VectorSRegister(44);\n-constexpr VectorSRegister VSR45 = as_VectorSRegister(45);\n-constexpr VectorSRegister VSR46 = as_VectorSRegister(46);\n-constexpr VectorSRegister VSR47 = as_VectorSRegister(47);\n-constexpr VectorSRegister VSR48 = as_VectorSRegister(48);\n-constexpr VectorSRegister VSR49 = as_VectorSRegister(49);\n-constexpr VectorSRegister VSR50 = as_VectorSRegister(50);\n-constexpr VectorSRegister VSR51 = as_VectorSRegister(51);\n-constexpr VectorSRegister VSR52 = as_VectorSRegister(52);\n-constexpr VectorSRegister VSR53 = as_VectorSRegister(53);\n-constexpr VectorSRegister VSR54 = as_VectorSRegister(54);\n-constexpr VectorSRegister VSR55 = as_VectorSRegister(55);\n-constexpr VectorSRegister VSR56 = as_VectorSRegister(56);\n-constexpr VectorSRegister VSR57 = as_VectorSRegister(57);\n-constexpr VectorSRegister VSR58 = as_VectorSRegister(58);\n-constexpr VectorSRegister VSR59 = as_VectorSRegister(59);\n-constexpr VectorSRegister VSR60 = as_VectorSRegister(60);\n-constexpr VectorSRegister VSR61 = as_VectorSRegister(61);\n-constexpr VectorSRegister VSR62 = as_VectorSRegister(62);\n-constexpr VectorSRegister VSR63 = as_VectorSRegister(63);\n+\n+CONSTANT_REGISTER_DECLARATION(VectorSRegister, vsnoreg, (-1));\n+\n+CONSTANT_REGISTER_DECLARATION(VectorSRegister, VSR0,  ( 0));\n+CONSTANT_REGISTER_DECLARATION(VectorSRegister, VSR1,  ( 1));\n+CONSTANT_REGISTER_DECLARATION(VectorSRegister, VSR2,  ( 2));\n+CONSTANT_REGISTER_DECLARATION(VectorSRegister, VSR3,  ( 3));\n+CONSTANT_REGISTER_DECLARATION(VectorSRegister, VSR4,  ( 4));\n+CONSTANT_REGISTER_DECLARATION(VectorSRegister, VSR5,  ( 5));\n+CONSTANT_REGISTER_DECLARATION(VectorSRegister, VSR6,  ( 6));\n+CONSTANT_REGISTER_DECLARATION(VectorSRegister, VSR7,  ( 7));\n+CONSTANT_REGISTER_DECLARATION(VectorSRegister, VSR8,  ( 8));\n+CONSTANT_REGISTER_DECLARATION(VectorSRegister, VSR9,  ( 9));\n+CONSTANT_REGISTER_DECLARATION(VectorSRegister, VSR10, (10));\n+CONSTANT_REGISTER_DECLARATION(VectorSRegister, VSR11, (11));\n+CONSTANT_REGISTER_DECLARATION(VectorSRegister, VSR12, (12));\n+CONSTANT_REGISTER_DECLARATION(VectorSRegister, VSR13, (13));\n+CONSTANT_REGISTER_DECLARATION(VectorSRegister, VSR14, (14));\n+CONSTANT_REGISTER_DECLARATION(VectorSRegister, VSR15, (15));\n+CONSTANT_REGISTER_DECLARATION(VectorSRegister, VSR16, (16));\n+CONSTANT_REGISTER_DECLARATION(VectorSRegister, VSR17, (17));\n+CONSTANT_REGISTER_DECLARATION(VectorSRegister, VSR18, (18));\n+CONSTANT_REGISTER_DECLARATION(VectorSRegister, VSR19, (19));\n+CONSTANT_REGISTER_DECLARATION(VectorSRegister, VSR20, (20));\n+CONSTANT_REGISTER_DECLARATION(VectorSRegister, VSR21, (21));\n+CONSTANT_REGISTER_DECLARATION(VectorSRegister, VSR22, (22));\n+CONSTANT_REGISTER_DECLARATION(VectorSRegister, VSR23, (23));\n+CONSTANT_REGISTER_DECLARATION(VectorSRegister, VSR24, (24));\n+CONSTANT_REGISTER_DECLARATION(VectorSRegister, VSR25, (25));\n+CONSTANT_REGISTER_DECLARATION(VectorSRegister, VSR26, (26));\n+CONSTANT_REGISTER_DECLARATION(VectorSRegister, VSR27, (27));\n+CONSTANT_REGISTER_DECLARATION(VectorSRegister, VSR28, (28));\n+CONSTANT_REGISTER_DECLARATION(VectorSRegister, VSR29, (29));\n+CONSTANT_REGISTER_DECLARATION(VectorSRegister, VSR30, (30));\n+CONSTANT_REGISTER_DECLARATION(VectorSRegister, VSR31, (31));\n+CONSTANT_REGISTER_DECLARATION(VectorSRegister, VSR32, (32));\n+CONSTANT_REGISTER_DECLARATION(VectorSRegister, VSR33, (33));\n+CONSTANT_REGISTER_DECLARATION(VectorSRegister, VSR34, (34));\n+CONSTANT_REGISTER_DECLARATION(VectorSRegister, VSR35, (35));\n+CONSTANT_REGISTER_DECLARATION(VectorSRegister, VSR36, (36));\n+CONSTANT_REGISTER_DECLARATION(VectorSRegister, VSR37, (37));\n+CONSTANT_REGISTER_DECLARATION(VectorSRegister, VSR38, (38));\n+CONSTANT_REGISTER_DECLARATION(VectorSRegister, VSR39, (39));\n+CONSTANT_REGISTER_DECLARATION(VectorSRegister, VSR40, (40));\n+CONSTANT_REGISTER_DECLARATION(VectorSRegister, VSR41, (41));\n+CONSTANT_REGISTER_DECLARATION(VectorSRegister, VSR42, (42));\n+CONSTANT_REGISTER_DECLARATION(VectorSRegister, VSR43, (43));\n+CONSTANT_REGISTER_DECLARATION(VectorSRegister, VSR44, (44));\n+CONSTANT_REGISTER_DECLARATION(VectorSRegister, VSR45, (45));\n+CONSTANT_REGISTER_DECLARATION(VectorSRegister, VSR46, (46));\n+CONSTANT_REGISTER_DECLARATION(VectorSRegister, VSR47, (47));\n+CONSTANT_REGISTER_DECLARATION(VectorSRegister, VSR48, (48));\n+CONSTANT_REGISTER_DECLARATION(VectorSRegister, VSR49, (49));\n+CONSTANT_REGISTER_DECLARATION(VectorSRegister, VSR50, (50));\n+CONSTANT_REGISTER_DECLARATION(VectorSRegister, VSR51, (51));\n+CONSTANT_REGISTER_DECLARATION(VectorSRegister, VSR52, (52));\n+CONSTANT_REGISTER_DECLARATION(VectorSRegister, VSR53, (53));\n+CONSTANT_REGISTER_DECLARATION(VectorSRegister, VSR54, (54));\n+CONSTANT_REGISTER_DECLARATION(VectorSRegister, VSR55, (55));\n+CONSTANT_REGISTER_DECLARATION(VectorSRegister, VSR56, (56));\n+CONSTANT_REGISTER_DECLARATION(VectorSRegister, VSR57, (57));\n+CONSTANT_REGISTER_DECLARATION(VectorSRegister, VSR58, (58));\n+CONSTANT_REGISTER_DECLARATION(VectorSRegister, VSR59, (59));\n+CONSTANT_REGISTER_DECLARATION(VectorSRegister, VSR60, (60));\n+CONSTANT_REGISTER_DECLARATION(VectorSRegister, VSR61, (61));\n+CONSTANT_REGISTER_DECLARATION(VectorSRegister, VSR62, (62));\n+CONSTANT_REGISTER_DECLARATION(VectorSRegister, VSR63, (63));\n+\n+#ifndef DONT_USE_REGISTER_DEFINES\n+#define vsnoreg ((VectorSRegister)(vsnoreg_VectorSRegisterEnumValue))\n+#define VSR0    ((VectorSRegister)(   VSR0_VectorSRegisterEnumValue))\n+#define VSR1    ((VectorSRegister)(   VSR1_VectorSRegisterEnumValue))\n+#define VSR2    ((VectorSRegister)(   VSR2_VectorSRegisterEnumValue))\n+#define VSR3    ((VectorSRegister)(   VSR3_VectorSRegisterEnumValue))\n+#define VSR4    ((VectorSRegister)(   VSR4_VectorSRegisterEnumValue))\n+#define VSR5    ((VectorSRegister)(   VSR5_VectorSRegisterEnumValue))\n+#define VSR6    ((VectorSRegister)(   VSR6_VectorSRegisterEnumValue))\n+#define VSR7    ((VectorSRegister)(   VSR7_VectorSRegisterEnumValue))\n+#define VSR8    ((VectorSRegister)(   VSR8_VectorSRegisterEnumValue))\n+#define VSR9    ((VectorSRegister)(   VSR9_VectorSRegisterEnumValue))\n+#define VSR10   ((VectorSRegister)(  VSR10_VectorSRegisterEnumValue))\n+#define VSR11   ((VectorSRegister)(  VSR11_VectorSRegisterEnumValue))\n+#define VSR12   ((VectorSRegister)(  VSR12_VectorSRegisterEnumValue))\n+#define VSR13   ((VectorSRegister)(  VSR13_VectorSRegisterEnumValue))\n+#define VSR14   ((VectorSRegister)(  VSR14_VectorSRegisterEnumValue))\n+#define VSR15   ((VectorSRegister)(  VSR15_VectorSRegisterEnumValue))\n+#define VSR16   ((VectorSRegister)(  VSR16_VectorSRegisterEnumValue))\n+#define VSR17   ((VectorSRegister)(  VSR17_VectorSRegisterEnumValue))\n+#define VSR18   ((VectorSRegister)(  VSR18_VectorSRegisterEnumValue))\n+#define VSR19   ((VectorSRegister)(  VSR19_VectorSRegisterEnumValue))\n+#define VSR20   ((VectorSRegister)(  VSR20_VectorSRegisterEnumValue))\n+#define VSR21   ((VectorSRegister)(  VSR21_VectorSRegisterEnumValue))\n+#define VSR22   ((VectorSRegister)(  VSR22_VectorSRegisterEnumValue))\n+#define VSR23   ((VectorSRegister)(  VSR23_VectorSRegisterEnumValue))\n+#define VSR24   ((VectorSRegister)(  VSR24_VectorSRegisterEnumValue))\n+#define VSR25   ((VectorSRegister)(  VSR25_VectorSRegisterEnumValue))\n+#define VSR26   ((VectorSRegister)(  VSR26_VectorSRegisterEnumValue))\n+#define VSR27   ((VectorSRegister)(  VSR27_VectorSRegisterEnumValue))\n+#define VSR28   ((VectorSRegister)(  VSR28_VectorSRegisterEnumValue))\n+#define VSR29   ((VectorSRegister)(  VSR29_VectorSRegisterEnumValue))\n+#define VSR30   ((VectorSRegister)(  VSR30_VectorSRegisterEnumValue))\n+#define VSR31   ((VectorSRegister)(  VSR31_VectorSRegisterEnumValue))\n+#define VSR32   ((VectorSRegister)(  VSR32_VectorSRegisterEnumValue))\n+#define VSR33   ((VectorSRegister)(  VSR33_VectorSRegisterEnumValue))\n+#define VSR34   ((VectorSRegister)(  VSR34_VectorSRegisterEnumValue))\n+#define VSR35   ((VectorSRegister)(  VSR35_VectorSRegisterEnumValue))\n+#define VSR36   ((VectorSRegister)(  VSR36_VectorSRegisterEnumValue))\n+#define VSR37   ((VectorSRegister)(  VSR37_VectorSRegisterEnumValue))\n+#define VSR38   ((VectorSRegister)(  VSR38_VectorSRegisterEnumValue))\n+#define VSR39   ((VectorSRegister)(  VSR39_VectorSRegisterEnumValue))\n+#define VSR40   ((VectorSRegister)(  VSR40_VectorSRegisterEnumValue))\n+#define VSR41   ((VectorSRegister)(  VSR41_VectorSRegisterEnumValue))\n+#define VSR42   ((VectorSRegister)(  VSR42_VectorSRegisterEnumValue))\n+#define VSR43   ((VectorSRegister)(  VSR43_VectorSRegisterEnumValue))\n+#define VSR44   ((VectorSRegister)(  VSR44_VectorSRegisterEnumValue))\n+#define VSR45   ((VectorSRegister)(  VSR45_VectorSRegisterEnumValue))\n+#define VSR46   ((VectorSRegister)(  VSR46_VectorSRegisterEnumValue))\n+#define VSR47   ((VectorSRegister)(  VSR47_VectorSRegisterEnumValue))\n+#define VSR48   ((VectorSRegister)(  VSR48_VectorSRegisterEnumValue))\n+#define VSR49   ((VectorSRegister)(  VSR49_VectorSRegisterEnumValue))\n+#define VSR50   ((VectorSRegister)(  VSR50_VectorSRegisterEnumValue))\n+#define VSR51   ((VectorSRegister)(  VSR51_VectorSRegisterEnumValue))\n+#define VSR52   ((VectorSRegister)(  VSR52_VectorSRegisterEnumValue))\n+#define VSR53   ((VectorSRegister)(  VSR53_VectorSRegisterEnumValue))\n+#define VSR54   ((VectorSRegister)(  VSR54_VectorSRegisterEnumValue))\n+#define VSR55   ((VectorSRegister)(  VSR55_VectorSRegisterEnumValue))\n+#define VSR56   ((VectorSRegister)(  VSR56_VectorSRegisterEnumValue))\n+#define VSR57   ((VectorSRegister)(  VSR57_VectorSRegisterEnumValue))\n+#define VSR58   ((VectorSRegister)(  VSR58_VectorSRegisterEnumValue))\n+#define VSR59   ((VectorSRegister)(  VSR59_VectorSRegisterEnumValue))\n+#define VSR60   ((VectorSRegister)(  VSR60_VectorSRegisterEnumValue))\n+#define VSR61   ((VectorSRegister)(  VSR61_VectorSRegisterEnumValue))\n+#define VSR62   ((VectorSRegister)(  VSR62_VectorSRegisterEnumValue))\n+#define VSR63   ((VectorSRegister)(  VSR63_VectorSRegisterEnumValue))\n+#endif \/\/ DONT_USE_REGISTER_DEFINES\n+\n+\/\/ Maximum number of incoming arguments that can be passed in i registers.\n+const int PPC_ARGS_IN_REGS_NUM = 8;\n@@ -480,5 +681,5 @@\n-    max_gpr = Register::number_of_registers * 2,\n-    max_fpr = max_gpr + FloatRegister::number_of_registers * 2,\n-    max_vsr = max_fpr + VectorSRegister::number_of_registers,\n-    max_cnd = max_vsr + ConditionRegister::number_of_registers,\n-    max_spr = max_cnd + SpecialRegister::number_of_registers,\n+    max_gpr = RegisterImpl::number_of_registers * 2,\n+    max_fpr = max_gpr + FloatRegisterImpl::number_of_registers * 2,\n+    max_vsr = max_fpr + VectorSRegisterImpl::number_of_registers,\n+    max_cnd = max_vsr + ConditionRegisterImpl::number_of_registers,\n+    max_spr = max_cnd + SpecialRegisterImpl::number_of_registers,\n@@ -493,27 +694,57 @@\n-constexpr Register R0_SCRATCH = R0;  \/\/ volatile\n-constexpr Register R1_SP      = R1;  \/\/ non-volatile\n-constexpr Register R2_TOC     = R2;  \/\/ volatile\n-constexpr Register R3_RET     = R3;  \/\/ volatile\n-constexpr Register R3_ARG1    = R3;  \/\/ volatile\n-constexpr Register R4_ARG2    = R4;  \/\/ volatile\n-constexpr Register R5_ARG3    = R5;  \/\/ volatile\n-constexpr Register R6_ARG4    = R6;  \/\/ volatile\n-constexpr Register R7_ARG5    = R7;  \/\/ volatile\n-constexpr Register R8_ARG6    = R8;  \/\/ volatile\n-constexpr Register R9_ARG7    = R9;  \/\/ volatile\n-constexpr Register R10_ARG8   = R10; \/\/ volatile\n-constexpr FloatRegister F0_SCRATCH = F0;  \/\/ volatile\n-constexpr FloatRegister F1_RET     = F1;  \/\/ volatile\n-constexpr FloatRegister F1_ARG1    = F1;  \/\/ volatile\n-constexpr FloatRegister F2_ARG2    = F2;  \/\/ volatile\n-constexpr FloatRegister F3_ARG3    = F3;  \/\/ volatile\n-constexpr FloatRegister F4_ARG4    = F4;  \/\/ volatile\n-constexpr FloatRegister F5_ARG5    = F5;  \/\/ volatile\n-constexpr FloatRegister F6_ARG6    = F6;  \/\/ volatile\n-constexpr FloatRegister F7_ARG7    = F7;  \/\/ volatile\n-constexpr FloatRegister F8_ARG8    = F8;  \/\/ volatile\n-constexpr FloatRegister F9_ARG9    = F9;  \/\/ volatile\n-constexpr FloatRegister F10_ARG10  = F10; \/\/ volatile\n-constexpr FloatRegister F11_ARG11  = F11; \/\/ volatile\n-constexpr FloatRegister F12_ARG12  = F12; \/\/ volatile\n-constexpr FloatRegister F13_ARG13  = F13; \/\/ volatile\n+REGISTER_DECLARATION(Register,      R0_SCRATCH, R0);  \/\/ volatile\n+REGISTER_DECLARATION(Register,      R1_SP,      R1);  \/\/ non-volatile\n+REGISTER_DECLARATION(Register,      R2_TOC,     R2);  \/\/ volatile\n+REGISTER_DECLARATION(Register,      R3_RET,     R3);  \/\/ volatile\n+REGISTER_DECLARATION(Register,      R3_ARG1,    R3);  \/\/ volatile\n+REGISTER_DECLARATION(Register,      R4_ARG2,    R4);  \/\/ volatile\n+REGISTER_DECLARATION(Register,      R5_ARG3,    R5);  \/\/ volatile\n+REGISTER_DECLARATION(Register,      R6_ARG4,    R6);  \/\/ volatile\n+REGISTER_DECLARATION(Register,      R7_ARG5,    R7);  \/\/ volatile\n+REGISTER_DECLARATION(Register,      R8_ARG6,    R8);  \/\/ volatile\n+REGISTER_DECLARATION(Register,      R9_ARG7,    R9);  \/\/ volatile\n+REGISTER_DECLARATION(Register,      R10_ARG8,   R10); \/\/ volatile\n+REGISTER_DECLARATION(FloatRegister, F0_SCRATCH, F0);  \/\/ volatile\n+REGISTER_DECLARATION(FloatRegister, F1_RET,     F1);  \/\/ volatile\n+REGISTER_DECLARATION(FloatRegister, F1_ARG1,    F1);  \/\/ volatile\n+REGISTER_DECLARATION(FloatRegister, F2_ARG2,    F2);  \/\/ volatile\n+REGISTER_DECLARATION(FloatRegister, F3_ARG3,    F3);  \/\/ volatile\n+REGISTER_DECLARATION(FloatRegister, F4_ARG4,    F4);  \/\/ volatile\n+REGISTER_DECLARATION(FloatRegister, F5_ARG5,    F5);  \/\/ volatile\n+REGISTER_DECLARATION(FloatRegister, F6_ARG6,    F6);  \/\/ volatile\n+REGISTER_DECLARATION(FloatRegister, F7_ARG7,    F7);  \/\/ volatile\n+REGISTER_DECLARATION(FloatRegister, F8_ARG8,    F8);  \/\/ volatile\n+REGISTER_DECLARATION(FloatRegister, F9_ARG9,    F9);  \/\/ volatile\n+REGISTER_DECLARATION(FloatRegister, F10_ARG10,  F10); \/\/ volatile\n+REGISTER_DECLARATION(FloatRegister, F11_ARG11,  F11); \/\/ volatile\n+REGISTER_DECLARATION(FloatRegister, F12_ARG12,  F12); \/\/ volatile\n+REGISTER_DECLARATION(FloatRegister, F13_ARG13,  F13); \/\/ volatile\n+\n+#ifndef DONT_USE_REGISTER_DEFINES\n+#define R0_SCRATCH         AS_REGISTER(Register, R0)\n+#define R1_SP              AS_REGISTER(Register, R1)\n+#define R2_TOC             AS_REGISTER(Register, R2)\n+#define R3_RET             AS_REGISTER(Register, R3)\n+#define R3_ARG1            AS_REGISTER(Register, R3)\n+#define R4_ARG2            AS_REGISTER(Register, R4)\n+#define R5_ARG3            AS_REGISTER(Register, R5)\n+#define R6_ARG4            AS_REGISTER(Register, R6)\n+#define R7_ARG5            AS_REGISTER(Register, R7)\n+#define R8_ARG6            AS_REGISTER(Register, R8)\n+#define R9_ARG7            AS_REGISTER(Register, R9)\n+#define R10_ARG8           AS_REGISTER(Register, R10)\n+#define F0_SCRATCH         AS_REGISTER(FloatRegister, F0)\n+#define F1_RET             AS_REGISTER(FloatRegister, F1)\n+#define F1_ARG1            AS_REGISTER(FloatRegister, F1)\n+#define F2_ARG2            AS_REGISTER(FloatRegister, F2)\n+#define F3_ARG3            AS_REGISTER(FloatRegister, F3)\n+#define F4_ARG4            AS_REGISTER(FloatRegister, F4)\n+#define F5_ARG5            AS_REGISTER(FloatRegister, F5)\n+#define F6_ARG6            AS_REGISTER(FloatRegister, F6)\n+#define F7_ARG7            AS_REGISTER(FloatRegister, F7)\n+#define F8_ARG8            AS_REGISTER(FloatRegister, F8)\n+#define F9_ARG9            AS_REGISTER(FloatRegister, F9)\n+#define F10_ARG10          AS_REGISTER(FloatRegister, F10)\n+#define F11_ARG11          AS_REGISTER(FloatRegister, F11)\n+#define F12_ARG12          AS_REGISTER(FloatRegister, F12)\n+#define F13_ARG13          AS_REGISTER(FloatRegister, F13)\n+#endif\n@@ -523,7 +754,18 @@\n-constexpr Register R14_bcp       = R14;\n-constexpr Register R15_esp       = R15;\n-constexpr FloatRegister F15_ftos = F15;\n-constexpr Register R16_thread    = R16;      \/\/ address of current thread\n-constexpr Register R17_tos       = R17;      \/\/ address of Java tos (prepushed).\n-constexpr Register R18_locals    = R18;      \/\/ address of first param slot (receiver).\n-constexpr Register R19_method    = R19;      \/\/ address of current method\n+REGISTER_DECLARATION(Register, R14_bcp,        R14);\n+REGISTER_DECLARATION(Register, R15_esp,        R15);\n+REGISTER_DECLARATION(FloatRegister, F15_ftos,  F15);\n+REGISTER_DECLARATION(Register, R16_thread,     R16);      \/\/ address of current thread\n+REGISTER_DECLARATION(Register, R17_tos,        R17);      \/\/ address of Java tos (prepushed).\n+REGISTER_DECLARATION(Register, R18_locals,     R18);      \/\/ address of first param slot (receiver).\n+REGISTER_DECLARATION(Register, R19_method,     R19);      \/\/ address of current method\n+#ifndef DONT_USE_REGISTER_DEFINES\n+#define R14_bcp           AS_REGISTER(Register, R14)\n+#define R15_esp           AS_REGISTER(Register, R15)\n+#define F15_ftos          AS_REGISTER(FloatRegister, F15)\n+#define R16_thread        AS_REGISTER(Register, R16)\n+#define R17_tos           AS_REGISTER(Register, R17)\n+#define R18_locals        AS_REGISTER(Register, R18)\n+#define R19_method        AS_REGISTER(Register, R19)\n+#define R21_sender_SP     AS_REGISTER(Register, R21)\n+#define R23_method_handle AS_REGISTER(Register, R23)\n+#endif\n@@ -534,19 +776,40 @@\n-constexpr Register R21_tmp1 = R21;\n-constexpr Register R22_tmp2 = R22;\n-constexpr Register R23_tmp3 = R23;\n-constexpr Register R24_tmp4 = R24;\n-constexpr Register R25_tmp5 = R25;\n-constexpr Register R26_tmp6 = R26;\n-constexpr Register R27_tmp7 = R27;\n-constexpr Register R28_tmp8 = R28;\n-constexpr Register R29_tmp9 = R29;\n-constexpr Register R24_dispatch_addr     = R24;\n-constexpr Register R25_templateTableBase = R25;\n-constexpr Register R26_monitor           = R26;\n-constexpr Register R27_constPoolCache    = R27;\n-constexpr Register R28_mdx               = R28;\n-\n-constexpr Register R19_inline_cache_reg = R19;\n-constexpr Register R21_sender_SP = R21;\n-constexpr Register R23_method_handle = R23;\n-constexpr Register R29_TOC = R29;\n+REGISTER_DECLARATION(Register, R21_tmp1, R21);\n+REGISTER_DECLARATION(Register, R22_tmp2, R22);\n+REGISTER_DECLARATION(Register, R23_tmp3, R23);\n+REGISTER_DECLARATION(Register, R24_tmp4, R24);\n+REGISTER_DECLARATION(Register, R25_tmp5, R25);\n+REGISTER_DECLARATION(Register, R26_tmp6, R26);\n+REGISTER_DECLARATION(Register, R27_tmp7, R27);\n+REGISTER_DECLARATION(Register, R28_tmp8, R28);\n+REGISTER_DECLARATION(Register, R29_tmp9, R29);\n+REGISTER_DECLARATION(Register, R24_dispatch_addr,     R24);\n+REGISTER_DECLARATION(Register, R25_templateTableBase, R25);\n+REGISTER_DECLARATION(Register, R26_monitor,           R26);\n+REGISTER_DECLARATION(Register, R27_constPoolCache,    R27);\n+REGISTER_DECLARATION(Register, R28_mdx,               R28);\n+\n+REGISTER_DECLARATION(Register, R19_inline_cache_reg, R19);\n+REGISTER_DECLARATION(Register, R29_TOC, R29);\n+\n+#ifndef DONT_USE_REGISTER_DEFINES\n+#define R21_tmp1         AS_REGISTER(Register, R21)\n+#define R22_tmp2         AS_REGISTER(Register, R22)\n+#define R23_tmp3         AS_REGISTER(Register, R23)\n+#define R24_tmp4         AS_REGISTER(Register, R24)\n+#define R25_tmp5         AS_REGISTER(Register, R25)\n+#define R26_tmp6         AS_REGISTER(Register, R26)\n+#define R27_tmp7         AS_REGISTER(Register, R27)\n+#define R28_tmp8         AS_REGISTER(Register, R28)\n+#define R29_tmp9         AS_REGISTER(Register, R29)\n+\/\/    Lmonitors  : monitor pointer\n+\/\/    LcpoolCache: constant pool cache\n+\/\/    mdx: method data index\n+#define R24_dispatch_addr     AS_REGISTER(Register, R24)\n+#define R25_templateTableBase AS_REGISTER(Register, R25)\n+#define R26_monitor           AS_REGISTER(Register, R26)\n+#define R27_constPoolCache    AS_REGISTER(Register, R27)\n+#define R28_mdx               AS_REGISTER(Register, R28)\n+\n+#define R19_inline_cache_reg AS_REGISTER(Register, R19)\n+#define R29_TOC AS_REGISTER(Register, R29)\n+#endif\n@@ -555,2 +818,6 @@\n-constexpr Register R11_scratch1 = R11;\n-constexpr Register R12_scratch2 = R12;\n+REGISTER_DECLARATION(Register, R11_scratch1, R11);\n+REGISTER_DECLARATION(Register, R12_scratch2, R12);\n+#ifndef DONT_USE_REGISTER_DEFINES\n+#define R11_scratch1   AS_REGISTER(Register, R11)\n+#define R12_scratch2   AS_REGISTER(Register, R12)\n+#endif\n","filename":"src\/hotspot\/cpu\/ppc\/register_ppc.hpp","additions":610,"deletions":343,"binary":false,"changes":953,"status":"modified"},{"patch":"@@ -3,1 +3,1 @@\n- * Copyright (c) 2012, 2022 SAP SE. All rights reserved.\n+ * Copyright (c) 2012, 2021 SAP SE. All rights reserved.\n@@ -327,1 +327,1 @@\n-        if (reg_num == SR_CTR.encoding()) {\n+        if (reg_num == SR_CTR_SpecialRegisterEnumValue) {\n@@ -406,1 +406,1 @@\n-        if (reg_num == SR_CTR.encoding()) {\n+        if (reg_num == SR_CTR_SpecialRegisterEnumValue) {\n@@ -586,1 +586,1 @@\n-\/\/ up to Register::number_of_registers) are the 64-bit\n+\/\/ up to RegisterImpl::number_of_registers) are the 64-bit\n@@ -1892,3 +1892,3 @@\n-  bool reg_destroyed[Register::number_of_registers];\n-  bool freg_destroyed[FloatRegister::number_of_registers];\n-  for (int r = 0 ; r < Register::number_of_registers ; r++) {\n+  bool reg_destroyed[RegisterImpl::number_of_registers];\n+  bool freg_destroyed[FloatRegisterImpl::number_of_registers];\n+  for (int r = 0 ; r < RegisterImpl::number_of_registers ; r++) {\n@@ -1897,1 +1897,1 @@\n-  for (int f = 0 ; f < FloatRegister::number_of_registers ; f++) {\n+  for (int f = 0 ; f < FloatRegisterImpl::number_of_registers ; f++) {\n","filename":"src\/hotspot\/cpu\/ppc\/sharedRuntime_ppc.cpp","additions":8,"deletions":8,"binary":false,"changes":16,"status":"modified"},{"patch":"@@ -2136,1 +2136,1 @@\n-    __ check_klass_subtype_slow_path(sub_klass, super_klass, temp, R0, &L_success);\n+    __ check_klass_subtype_slow_path(sub_klass, super_klass, temp, R0, &L_success, NULL);\n@@ -3540,1 +3540,1 @@\n-    __ addi(R3_ARG1, R1_SP, _abi0(lr));\n+    __ add(R3_ARG1, _abi0(lr), R1_SP);\n","filename":"src\/hotspot\/cpu\/ppc\/stubGenerator_ppc.cpp","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -28,1 +28,1 @@\n-#include \"runtime\/os.hpp\"\n+#include \"runtime\/os.hpp\" \/\/ malloc\n","filename":"src\/hotspot\/cpu\/ppc\/stubRoutines_ppc_64.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -3,1 +3,1 @@\n- * Copyright (c) 2015, 2022 SAP SE. All rights reserved.\n+ * Copyright (c) 2015, 2021 SAP SE. All rights reserved.\n@@ -1013,1 +1013,1 @@\n-    __ addi(R14_bcp, Rconst_method, in_bytes(ConstMethod::codes_offset()));\n+    __ add(R14_bcp, in_bytes(ConstMethod::codes_offset()), Rconst_method);\n","filename":"src\/hotspot\/cpu\/ppc\/templateInterpreterGenerator_ppc.cpp","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -3,1 +3,1 @@\n- * Copyright (c) 2013, 2022 SAP SE. All rights reserved.\n+ * Copyright (c) 2013, 2021 SAP SE. All rights reserved.\n@@ -240,1 +240,1 @@\n-void TemplateTable::ldc(LdcType type) {\n+void TemplateTable::ldc(bool wide) {\n@@ -249,1 +249,1 @@\n-  if (is_ldc_wide(type)) { \/\/ Read index.\n+  if (wide) { \/\/ Read index.\n@@ -271,1 +271,1 @@\n-  __ li(R4, is_ldc_wide(type) ? 1 : 0);\n+  __ li(R4, wide ? 1 : 0);\n@@ -304,1 +304,1 @@\n-void TemplateTable::fast_aldc(LdcType type) {\n+void TemplateTable::fast_aldc(bool wide) {\n@@ -307,1 +307,1 @@\n-  int index_size = is_ldc_wide(type) ? sizeof(u2) : sizeof(u1);\n+  int index_size = wide ? sizeof(u2) : sizeof(u1);\n@@ -4073,1 +4073,1 @@\n-    __ addi(Rcurrent_obj_addr, R26_monitor, BasicObjectLock::obj_offset_in_bytes());\n+    __ add(Rcurrent_obj_addr, BasicObjectLock::obj_offset_in_bytes(), R26_monitor);\n","filename":"src\/hotspot\/cpu\/ppc\/templateTable_ppc_64.cpp","additions":7,"deletions":7,"binary":false,"changes":14,"status":"modified"},{"patch":"@@ -27,0 +27,1 @@\n+#include \"jvm.h\"\n@@ -30,1 +31,0 @@\n-#include \"jvm.h\"\n","filename":"src\/hotspot\/cpu\/ppc\/vm_version_ppc.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -36,1 +36,1 @@\n-    if (reg->encoding() < Register::number_of_registers-1)\n+    if (reg->encoding() < RegisterImpl::number_of_registers-1)\n@@ -44,1 +44,1 @@\n-    if (reg->encoding() < FloatRegister::number_of_registers-1)\n+    if (reg->encoding() < FloatRegisterImpl::number_of_registers-1)\n","filename":"src\/hotspot\/cpu\/ppc\/vmreg_ppc.cpp","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -3,1 +3,1 @@\n- * Copyright (c) 2012, 2022 SAP SE. All rights reserved.\n+ * Copyright (c) 2012, 2018 SAP SE. All rights reserved.\n@@ -29,5 +29,2 @@\n-#include \"code\/vmreg.hpp\"\n-#include \"register_ppc.hpp\"\n-\n-inline VMReg Register::as_VMReg() const {\n-  if (*this == noreg) return VMRegImpl::Bad();\n+inline VMReg RegisterImpl::as_VMReg() {\n+  if (this == noreg) return VMRegImpl::Bad();\n@@ -38,1 +35,1 @@\n-inline VMReg FloatRegister::as_VMReg() const {\n+inline VMReg FloatRegisterImpl::as_VMReg() {\n@@ -43,1 +40,1 @@\n-inline VMReg VectorSRegister::as_VMReg() const {\n+inline VMReg VectorSRegisterImpl::as_VMReg() {\n@@ -47,1 +44,1 @@\n-inline VMReg ConditionRegister::as_VMReg() const {\n+inline VMReg ConditionRegisterImpl::as_VMReg() {\n@@ -51,1 +48,1 @@\n-inline VMReg SpecialRegister::as_VMReg() const {\n+inline VMReg SpecialRegisterImpl::as_VMReg() {\n@@ -55,0 +52,1 @@\n+\n","filename":"src\/hotspot\/cpu\/ppc\/vmreg_ppc.inline.hpp","additions":8,"deletions":10,"binary":false,"changes":18,"status":"modified"},{"patch":"@@ -1673,1 +1673,1 @@\n-\/\/ Currently only support Zba and Zbb bitmanip extensions.\n+\/\/ Currently only support Zba and Zbb.\n@@ -2755,0 +2755,6 @@\n+  \/\/ RVB pseudo instructions\n+  \/\/ zero extend word\n+  void zext_w(Register Rd, Register Rs) {\n+    add_uw(Rd, Rs, zr);\n+  }\n+\n","filename":"src\/hotspot\/cpu\/riscv\/assembler_riscv.hpp","additions":7,"deletions":1,"binary":false,"changes":8,"status":"modified"},{"patch":"@@ -32,1 +32,0 @@\n-\n","filename":"src\/hotspot\/cpu\/riscv\/gc\/shenandoah\/shenandoahBarrierSetAssembler_riscv.hpp","additions":0,"deletions":1,"binary":false,"changes":1,"status":"modified"},{"patch":"@@ -62,1 +62,1 @@\n-                                   Register tmp2) {\n+                                   Register tmp_thread) {\n@@ -65,1 +65,1 @@\n-    BarrierSetAssembler::load_at(masm, decorators, type, dst, src, tmp1, tmp2);\n+    BarrierSetAssembler::load_at(masm, decorators, type, dst, src, tmp1, tmp_thread);\n","filename":"src\/hotspot\/cpu\/riscv\/gc\/z\/zBarrierSetAssembler_riscv.cpp","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -55,1 +55,1 @@\n-                       Register tmp2);\n+                       Register tmp_thread);\n","filename":"src\/hotspot\/cpu\/riscv\/gc\/z\/zBarrierSetAssembler_riscv.hpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -99,2 +99,1 @@\n-  product(bool, UseRVA20U64, true, \"Use RVA20U64 profile\")                       \\\n-  product(bool, UseRVC, false, \"Use RVC instructions\")                           \\\n+  product(bool, UseRVA20U64, false, EXPERIMENTAL, \"Use RVA20U64 profile\")        \\\n@@ -103,0 +102,1 @@\n+  product(bool, UseRVC, false, EXPERIMENTAL, \"Use RVC instructions\")             \\\n","filename":"src\/hotspot\/cpu\/riscv\/globals_riscv.hpp","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -673,0 +673,90 @@\n+void MacroAssembler::nop() {\n+  addi(x0, x0, 0);\n+}\n+\n+void MacroAssembler::mv(Register Rd, Register Rs) {\n+  if (Rd != Rs) {\n+    addi(Rd, Rs, 0);\n+  }\n+}\n+\n+void MacroAssembler::notr(Register Rd, Register Rs) {\n+  xori(Rd, Rs, -1);\n+}\n+\n+void MacroAssembler::neg(Register Rd, Register Rs) {\n+  sub(Rd, x0, Rs);\n+}\n+\n+void MacroAssembler::negw(Register Rd, Register Rs) {\n+  subw(Rd, x0, Rs);\n+}\n+\n+void MacroAssembler::sext_w(Register Rd, Register Rs) {\n+  addiw(Rd, Rs, 0);\n+}\n+\n+void MacroAssembler::zext_b(Register Rd, Register Rs) {\n+  andi(Rd, Rs, 0xFF);\n+}\n+\n+void MacroAssembler::seqz(Register Rd, Register Rs) {\n+  sltiu(Rd, Rs, 1);\n+}\n+\n+void MacroAssembler::snez(Register Rd, Register Rs) {\n+  sltu(Rd, x0, Rs);\n+}\n+\n+void MacroAssembler::sltz(Register Rd, Register Rs) {\n+  slt(Rd, Rs, x0);\n+}\n+\n+void MacroAssembler::sgtz(Register Rd, Register Rs) {\n+  slt(Rd, x0, Rs);\n+}\n+\n+void MacroAssembler::fmv_s(FloatRegister Rd, FloatRegister Rs) {\n+  if (Rd != Rs) {\n+    fsgnj_s(Rd, Rs, Rs);\n+  }\n+}\n+\n+void MacroAssembler::fabs_s(FloatRegister Rd, FloatRegister Rs) {\n+  fsgnjx_s(Rd, Rs, Rs);\n+}\n+\n+void MacroAssembler::fneg_s(FloatRegister Rd, FloatRegister Rs) {\n+  fsgnjn_s(Rd, Rs, Rs);\n+}\n+\n+void MacroAssembler::fmv_d(FloatRegister Rd, FloatRegister Rs) {\n+  if (Rd != Rs) {\n+    fsgnj_d(Rd, Rs, Rs);\n+  }\n+}\n+\n+void MacroAssembler::fabs_d(FloatRegister Rd, FloatRegister Rs) {\n+  fsgnjx_d(Rd, Rs, Rs);\n+}\n+\n+void MacroAssembler::fneg_d(FloatRegister Rd, FloatRegister Rs) {\n+  fsgnjn_d(Rd, Rs, Rs);\n+}\n+\n+void MacroAssembler::vmnot_m(VectorRegister vd, VectorRegister vs) {\n+  vmnand_mm(vd, vs, vs);\n+}\n+\n+void MacroAssembler::vncvt_x_x_w(VectorRegister vd, VectorRegister vs, VectorMask vm) {\n+  vnsrl_wx(vd, vs, x0, vm);\n+}\n+\n+void MacroAssembler::vneg_v(VectorRegister vd, VectorRegister vs) {\n+  vrsub_vx(vd, vs, x0);\n+}\n+\n+void MacroAssembler::vfneg_v(VectorRegister vd, VectorRegister vs) {\n+  vfsgnjn_vv(vd, vs, vs);\n+}\n+\n@@ -1538,0 +1628,15 @@\n+void MacroAssembler::mv(Register Rd, Address dest) {\n+  assert(dest.getMode() == Address::literal, \"Address mode should be Address::literal\");\n+  relocate(dest.rspec(), [&] {\n+    movptr(Rd, dest.target());\n+  });\n+}\n+\n+void MacroAssembler::mv(Register Rd, RegisterOrConstant src) {\n+  if (src.is_register()) {\n+    mv(Rd, src.as_register());\n+  } else {\n+    mv(Rd, src.as_constant());\n+  }\n+}\n+\n@@ -1567,0 +1672,10 @@\n+void MacroAssembler::movptr(Register Rd, uintptr_t imm64) {\n+  movptr(Rd, (address)imm64);\n+}\n+\n+void MacroAssembler::movptr(Register Rd, address addr) {\n+  int offset = 0;\n+  movptr(Rd, addr, offset);\n+  addi(Rd, Rd, offset);\n+}\n+\n@@ -1949,5 +2064,1 @@\n-  if (value) {\n-    _masm->bnez(t0, _label);\n-  } else {\n-    _masm->beqz(t0, _label);\n-  }\n+  _masm->beqz(t0, _label);\n@@ -3245,1 +3356,2 @@\n-                                   bool haystack_isL) {\n+                                   bool haystack_isL)\n+{\n@@ -3266,1 +3378,2 @@\n-                                        Register mask1, Register mask2) {\n+                                        Register mask1, Register mask2)\n+{\n@@ -3350,1 +3463,2 @@\n-void MacroAssembler::adc(Register dst, Register src1, Register src2, Register carry) {\n+void MacroAssembler::adc(Register dst, Register src1, Register src2, Register carry)\n+{\n@@ -3357,1 +3471,2 @@\n-void MacroAssembler::cadc(Register dst, Register src1, Register src2, Register carry) {\n+void MacroAssembler::cadc(Register dst, Register src1, Register src2, Register carry)\n+{\n@@ -3364,1 +3479,2 @@\n-                                     Register src1, Register src2, Register carry) {\n+                                     Register src1, Register src2, Register carry)\n+{\n@@ -3377,1 +3493,2 @@\n-                                           Register idx, Register kdx) {\n+                                           Register idx, Register kdx)\n+{\n@@ -3413,1 +3530,2 @@\n-                                           Register idx, Register kdx) {\n+                                           Register idx, Register kdx)\n+{\n@@ -3477,1 +3595,2 @@\n-                                             Register tmp6, Register product_hi) {\n+                                             Register tmp6, Register product_hi)\n+{\n@@ -3612,1 +3731,2 @@\n-                                     Register tmp5, Register tmp6, Register product_hi) {\n+                                     Register tmp5, Register tmp6, Register product_hi)\n+{\n@@ -3776,1 +3896,2 @@\n-void MacroAssembler::ctzc_bit(Register Rd, Register Rs, bool isLL, Register tmp1, Register tmp2) {\n+void MacroAssembler::ctzc_bit(Register Rd, Register Rs, bool isLL, Register tmp1, Register tmp2)\n+{\n@@ -3785,1 +3906,0 @@\n-\n@@ -3803,1 +3923,2 @@\n-void MacroAssembler::inflate_lo32(Register Rd, Register Rs, Register tmp1, Register tmp2) {\n+void MacroAssembler::inflate_lo32(Register Rd, Register Rs, Register tmp1, Register tmp2)\n+{\n@@ -3805,1 +3926,0 @@\n-\n@@ -3808,1 +3928,2 @@\n-  for (int i = 0; i <= 3; i++) {\n+  for (int i = 0; i <= 3; i++)\n+  {\n@@ -3824,1 +3945,2 @@\n-void MacroAssembler::inflate_hi32(Register Rd, Register Rs, Register tmp1, Register tmp2) {\n+void MacroAssembler::inflate_hi32(Register Rd, Register Rs, Register tmp1, Register tmp2)\n+{\n@@ -3826,1 +3948,0 @@\n-\n@@ -3829,1 +3950,2 @@\n-  for (int i = 0; i <= 3; i++) {\n+  for (int i = 0; i <= 3; i++)\n+  {\n@@ -3852,1 +3974,2 @@\n-address MacroAssembler::zero_words(Register ptr, Register cnt) {\n+address MacroAssembler::zero_words(Register ptr, Register cnt)\n+{\n@@ -3858,1 +3981,0 @@\n-\n@@ -3894,1 +4016,0 @@\n-\n@@ -3904,1 +4025,2 @@\n-void MacroAssembler::zero_words(Register base, uint64_t cnt) {\n+void MacroAssembler::zero_words(Register base, uint64_t cnt)\n+{\n@@ -3942,1 +4064,2 @@\n-void MacroAssembler::fill_words(Register base, Register cnt, Register value) {\n+void MacroAssembler::fill_words(Register base, Register cnt, Register value)\n+{\n@@ -4289,1 +4412,0 @@\n-\n","filename":"src\/hotspot\/cpu\/riscv\/macroAssembler_riscv.cpp","additions":150,"deletions":28,"binary":false,"changes":178,"status":"modified"},{"patch":"@@ -348,2 +348,1 @@\n-  static void membar_mask_to_pred_succ(uint32_t order_constraint,\n-                                       uint32_t& predecessor, uint32_t& successor) {\n+  static void membar_mask_to_pred_succ(uint32_t order_constraint, uint32_t& predecessor, uint32_t& successor) {\n@@ -414,51 +413,11 @@\n-  inline void nop() {\n-    addi(x0, x0, 0);\n-  }\n-\n-  inline void mv(Register Rd, Register Rs) {\n-    if (Rd != Rs) {\n-      addi(Rd, Rs, 0);\n-    }\n-  }\n-\n-  inline void notr(Register Rd, Register Rs) {\n-    xori(Rd, Rs, -1);\n-  }\n-\n-  inline void neg(Register Rd, Register Rs) {\n-    sub(Rd, x0, Rs);\n-  }\n-\n-  inline void negw(Register Rd, Register Rs) {\n-    subw(Rd, x0, Rs);\n-  }\n-\n-  inline void sext_w(Register Rd, Register Rs) {\n-    addiw(Rd, Rs, 0);\n-  }\n-\n-  inline void zext_b(Register Rd, Register Rs) {\n-    andi(Rd, Rs, 0xFF);\n-  }\n-\n-  inline void seqz(Register Rd, Register Rs) {\n-    sltiu(Rd, Rs, 1);\n-  }\n-\n-  inline void snez(Register Rd, Register Rs) {\n-    sltu(Rd, x0, Rs);\n-  }\n-\n-  inline void sltz(Register Rd, Register Rs) {\n-    slt(Rd, Rs, x0);\n-  }\n-\n-  inline void sgtz(Register Rd, Register Rs) {\n-    slt(Rd, x0, Rs);\n-  }\n-\n-  \/\/ Bit-manipulation extension pseudo instructions\n-  \/\/ zero extend word\n-  inline void zext_w(Register Rd, Register Rs) {\n-    add_uw(Rd, Rs, zr);\n-  }\n+  void nop();\n+  void mv(Register Rd, Register Rs);\n+  void notr(Register Rd, Register Rs);\n+  void neg(Register Rd, Register Rs);\n+  void negw(Register Rd, Register Rs);\n+  void sext_w(Register Rd, Register Rs);\n+  void zext_b(Register Rd, Register Rs);\n+  void seqz(Register Rd, Register Rs);          \/\/ set if = zero\n+  void snez(Register Rd, Register Rs);          \/\/ set if != zero\n+  void sltz(Register Rd, Register Rs);          \/\/ set if < zero\n+  void sgtz(Register Rd, Register Rs);          \/\/ set if > zero\n@@ -467,27 +426,6 @@\n-  inline void fmv_s(FloatRegister Rd, FloatRegister Rs) {\n-    if (Rd != Rs) {\n-      fsgnj_s(Rd, Rs, Rs);\n-    }\n-  }\n-\n-  inline void fabs_s(FloatRegister Rd, FloatRegister Rs) {\n-    fsgnjx_s(Rd, Rs, Rs);\n-  }\n-\n-  inline void fneg_s(FloatRegister Rd, FloatRegister Rs) {\n-    fsgnjn_s(Rd, Rs, Rs);\n-  }\n-\n-  inline void fmv_d(FloatRegister Rd, FloatRegister Rs) {\n-    if (Rd != Rs) {\n-      fsgnj_d(Rd, Rs, Rs);\n-    }\n-  }\n-\n-  inline void fabs_d(FloatRegister Rd, FloatRegister Rs) {\n-    fsgnjx_d(Rd, Rs, Rs);\n-  }\n-\n-  inline void fneg_d(FloatRegister Rd, FloatRegister Rs) {\n-    fsgnjn_d(Rd, Rs, Rs);\n-  }\n+  void fmv_s(FloatRegister Rd, FloatRegister Rs);\n+  void fabs_s(FloatRegister Rd, FloatRegister Rs);\n+  void fneg_s(FloatRegister Rd, FloatRegister Rs);\n+  void fmv_d(FloatRegister Rd, FloatRegister Rs);\n+  void fabs_d(FloatRegister Rd, FloatRegister Rs);\n+  void fneg_d(FloatRegister Rd, FloatRegister Rs);\n@@ -692,14 +630,2 @@\n-  void mv(Register Rd, Address dest) {\n-    assert(dest.getMode() == Address::literal, \"Address mode should be Address::literal\");\n-    relocate(dest.rspec(), [&] {\n-      movptr(Rd, dest.target());\n-    });\n-  }\n-\n-  void mv(Register Rd, RegisterOrConstant src) {\n-    if (src.is_register()) {\n-      mv(Rd, src.as_register());\n-    } else {\n-      mv(Rd, src.as_constant());\n-    }\n-  }\n+  void mv(Register Rd, Address dest);\n+  void mv(Register Rd, RegisterOrConstant src);\n@@ -707,0 +633,1 @@\n+  void movptr(Register Rd, address addr);\n@@ -708,10 +635,1 @@\n-\n-  void movptr(Register Rd, address addr) {\n-    int offset = 0;\n-    movptr(Rd, addr, offset);\n-    addi(Rd, Rd, offset);\n-  }\n-\n-  inline void movptr(Register Rd, uintptr_t imm64) {\n-    movptr(Rd, (address)imm64);\n-  }\n+  void movptr(Register Rd, uintptr_t imm64);\n@@ -1243,17 +1161,0 @@\n-  \/\/ vector pseudo instructions\n-  inline void vmnot_m(VectorRegister vd, VectorRegister vs) {\n-    vmnand_mm(vd, vs, vs);\n-  }\n-\n-  inline void vncvt_x_x_w(VectorRegister vd, VectorRegister vs, VectorMask vm) {\n-    vnsrl_wx(vd, vs, x0, vm);\n-  }\n-\n-  inline void vneg_v(VectorRegister vd, VectorRegister vs) {\n-    vrsub_vx(vd, vs, x0);\n-  }\n-\n-  inline void vfneg_v(VectorRegister vd, VectorRegister vs) {\n-    vfsgnjn_vv(vd, vs, vs);\n-  }\n-\n@@ -1301,0 +1202,7 @@\n+  \/\/ vext\n+  void vmnot_m(VectorRegister vd, VectorRegister vs);\n+  void vncvt_x_x_w(VectorRegister vd, VectorRegister vs, VectorMask vm = unmasked);\n+  void vneg_v(VectorRegister vd, VectorRegister vs);\n+  void vfneg_v(VectorRegister vd, VectorRegister vs);\n+\n+\n@@ -1324,1 +1232,1 @@\n-  inline void ret() {\n+  void ret() {\n","filename":"src\/hotspot\/cpu\/riscv\/macroAssembler_riscv.hpp","additions":30,"deletions":122,"binary":false,"changes":152,"status":"modified"},{"patch":"@@ -3268,1 +3268,0 @@\n-  match(iRegP_R15);\n@@ -4293,10 +4292,0 @@\n-\/\/ Load - prefetch\n-\/\/ Eg.  PREFETCH_W  mem\n-pipe_class iload_prefetch(memory mem)\n-%{\n-  single_instruction;\n-  mem    : ID(read);\n-  DECODE : ID;\n-  LDST   : MEM;\n-%}\n-\n@@ -5204,29 +5193,0 @@\n-\/\/ ============================================================================\n-\/\/ Prefetch instructions\n-\/\/ Must be safe to execute with invalid address (cannot fault).\n-\n-instruct prefetchalloc( memory mem ) %{\n-  predicate(UseZicbop);\n-  match(PrefetchAllocation mem);\n-\n-  ins_cost(ALU_COST * 1);\n-  format %{ \"prefetch_w $mem\\t# Prefetch for write\" %}\n-\n-  ins_encode %{\n-    if (is_imm_in_range($mem$$disp, 12, 0)) {\n-      if (($mem$$disp & 0x1f) == 0) {\n-        __ prefetch_w(as_Register($mem$$base), $mem$$disp);\n-      } else {\n-        __ addi(t0, as_Register($mem$$base), $mem$$disp);\n-        __ prefetch_w(t0, 0);\n-      }\n-    } else {\n-      __ mv(t0, $mem$$disp);\n-      __ add(t0, as_Register($mem$$base), t0);\n-      __ prefetch_w(t0, 0);\n-    }\n-  %}\n-\n-  ins_pipe(iload_prefetch);\n-%}\n-\n","filename":"src\/hotspot\/cpu\/riscv\/riscv.ad","additions":0,"deletions":40,"binary":false,"changes":40,"status":"modified"},{"patch":"@@ -362,2 +362,2 @@\n-  predicate(Matcher::vector_element_basic_type(n) != T_FLOAT &&\n-            Matcher::vector_element_basic_type(n) != T_DOUBLE);\n+  predicate(n->bottom_type()->is_vect()->element_basic_type() != T_FLOAT &&\n+            n->bottom_type()->is_vect()->element_basic_type() != T_DOUBLE);\n@@ -378,2 +378,2 @@\n-  predicate(Matcher::vector_element_basic_type(n) != T_FLOAT &&\n-            Matcher::vector_element_basic_type(n) != T_DOUBLE);\n+  predicate(n->bottom_type()->is_vect()->element_basic_type() != T_FLOAT &&\n+            n->bottom_type()->is_vect()->element_basic_type() != T_DOUBLE);\n@@ -396,1 +396,1 @@\n-  predicate(Matcher::vector_element_basic_type(n) == T_FLOAT);\n+  predicate(n->bottom_type()->is_vect()->element_basic_type() == T_FLOAT);\n@@ -410,1 +410,1 @@\n-  predicate(Matcher::vector_element_basic_type(n) == T_DOUBLE);\n+  predicate(n->bottom_type()->is_vect()->element_basic_type() == T_DOUBLE);\n@@ -424,1 +424,1 @@\n-  predicate(Matcher::vector_element_basic_type(n) == T_FLOAT);\n+  predicate(n->bottom_type()->is_vect()->element_basic_type() == T_FLOAT);\n@@ -438,1 +438,1 @@\n-  predicate(Matcher::vector_element_basic_type(n) == T_DOUBLE);\n+  predicate(n->bottom_type()->is_vect()->element_basic_type() == T_DOUBLE);\n@@ -768,3 +768,1 @@\n-    BasicType bt = Matcher::vector_element_basic_type(this);\n-    Assembler::SEW sew = Assembler::elemtype_to_sew(bt);\n-    __ vsetvli(t0, x0, sew);\n+    __ vsetvli(t0, x0, Assembler::e32);\n@@ -814,1 +812,1 @@\n-  predicate(Matcher::vector_element_basic_type(n->in(2)) == T_BYTE ||\n+  predicate(Matcher::vector_element_basic_type(n->in(2)) == T_BYTE || \n@@ -850,1 +848,1 @@\n-  predicate(Matcher::vector_element_basic_type(n->in(2)) == T_BYTE ||\n+  predicate(Matcher::vector_element_basic_type(n->in(2)) == T_BYTE || \n@@ -886,1 +884,1 @@\n-  predicate(Matcher::vector_element_basic_type(n->in(2)) == T_BYTE ||\n+  predicate(Matcher::vector_element_basic_type(n->in(2)) == T_BYTE || \n@@ -922,1 +920,1 @@\n-  predicate(Matcher::vector_element_basic_type(n->in(2)) == T_BYTE ||\n+  predicate(Matcher::vector_element_basic_type(n->in(2)) == T_BYTE || \n@@ -992,1 +990,1 @@\n-  predicate(Matcher::vector_element_basic_type(n->in(2)) == T_BYTE ||\n+  predicate(Matcher::vector_element_basic_type(n->in(2)) == T_BYTE || \n@@ -1024,1 +1022,1 @@\n-  predicate(Matcher::vector_element_basic_type(n->in(2)) == T_BYTE ||\n+  predicate(Matcher::vector_element_basic_type(n->in(2)) == T_BYTE || \n@@ -1056,1 +1054,1 @@\n-  predicate(Matcher::vector_element_basic_type(n->in(2)) == T_FLOAT);\n+  predicate(n->in(2)->bottom_type()->is_vect()->element_basic_type() == T_FLOAT);\n@@ -1071,1 +1069,1 @@\n-  predicate(Matcher::vector_element_basic_type(n->in(2)) == T_DOUBLE);\n+  predicate(n->in(2)->bottom_type()->is_vect()->element_basic_type() == T_DOUBLE);\n@@ -1088,1 +1086,1 @@\n-  predicate(Matcher::vector_element_basic_type(n->in(2)) == T_FLOAT);\n+  predicate(n->in(2)->bottom_type()->is_vect()->element_basic_type() == T_FLOAT);\n@@ -1103,1 +1101,1 @@\n-  predicate(Matcher::vector_element_basic_type(n->in(2)) == T_DOUBLE);\n+  predicate(n->in(2)->bottom_type()->is_vect()->element_basic_type() == T_DOUBLE);\n@@ -1120,1 +1118,1 @@\n-  predicate(Matcher::vector_element_basic_type(n) == T_DOUBLE);\n+  predicate(n->bottom_type()->is_vect()->element_basic_type() == T_DOUBLE);\n@@ -1675,1 +1673,1 @@\n-  predicate(Matcher::vector_element_basic_type(n) == T_BYTE);\n+  predicate(n->bottom_type()->is_vect()->element_basic_type() == T_BYTE);\n@@ -1687,2 +1685,2 @@\n-  predicate(Matcher::vector_element_basic_type(n) == T_SHORT ||\n-            Matcher::vector_element_basic_type(n) == T_CHAR);\n+  predicate(n->bottom_type()->is_vect()->element_basic_type() == T_SHORT ||\n+            n->bottom_type()->is_vect()->element_basic_type() == T_CHAR);\n@@ -1700,1 +1698,1 @@\n-  predicate(Matcher::vector_element_basic_type(n) == T_INT);\n+  predicate(n->bottom_type()->is_vect()->element_basic_type() == T_INT);\n@@ -1712,1 +1710,1 @@\n-  predicate(Matcher::vector_element_basic_type(n) == T_LONG);\n+  predicate(n->bottom_type()->is_vect()->element_basic_type() == T_LONG);\n","filename":"src\/hotspot\/cpu\/riscv\/riscv_v.ad","additions":25,"deletions":27,"binary":false,"changes":52,"status":"modified"},{"patch":"@@ -884,5 +884,1 @@\n-   *   if (count >= 32)\n-   *     goto copy32_loop;\n-   *   if (count >= 8)\n-   *     goto copy8_loop;\n-   *   goto copy_small;\n+   *   goto copy_8_bytes;\n@@ -906,1 +902,1 @@\n-   *   goto copy_big;\n+   *   goto copy8;\n@@ -909,3 +905,0 @@\n-   * copy_big:\n-   * if the amount to copy is more than (or equal to) 32 bytes goto copy32_loop\n-   *  else goto copy8_loop\n@@ -972,1 +965,1 @@\n-    const Register src = x30, dst = x31, cnt = x15, tmp3 = x16, tmp4 = x17, tmp5 = x14, tmp6 = x13;\n+    const Register src = x30, dst = x31, cnt = x15, tmp3 = x16, tmp4 = x17;\n@@ -975,1 +968,1 @@\n-    Label copy_big, copy32_loop, copy8_loop, copy_small, done;\n+    Label copy8, copy_small, done;\n@@ -1010,2 +1003,0 @@\n-      __ addi(tmp, cnt, -32);\n-      __ bgez(tmp, copy32_loop);\n@@ -1013,1 +1004,1 @@\n-      __ bgez(tmp, copy8_loop);\n+      __ bgez(tmp, copy8);\n@@ -1015,28 +1006,0 @@\n-    } else {\n-      __ mv(tmp, 16);\n-      __ blt(cnt, tmp, copy_small);\n-\n-      __ xorr(tmp, src, dst);\n-      __ andi(tmp, tmp, 0b111);\n-      __ bnez(tmp, copy_small);\n-\n-      __ bind(same_aligned);\n-      __ andi(tmp, src, 0b111);\n-      __ beqz(tmp, copy_big);\n-      if (is_backwards) {\n-        __ addi(src, src, step);\n-        __ addi(dst, dst, step);\n-      }\n-      (_masm->*ld_arr)(tmp3, Address(src), t0);\n-      (_masm->*st_arr)(tmp3, Address(dst), t0);\n-      if (!is_backwards) {\n-        __ addi(src, src, step);\n-        __ addi(dst, dst, step);\n-      }\n-      __ addi(cnt, cnt, -granularity);\n-      __ beqz(cnt, done);\n-      __ j(same_aligned);\n-\n-      __ bind(copy_big);\n-      __ mv(tmp, 32);\n-      __ blt(cnt, tmp, copy8_loop);\n@@ -1044,1 +1007,11 @@\n-    __ bind(copy32_loop);\n+\n+    __ mv(tmp, 16);\n+    __ blt(cnt, tmp, copy_small);\n+\n+    __ xorr(tmp, src, dst);\n+    __ andi(tmp, tmp, 0b111);\n+    __ bnez(tmp, copy_small);\n+\n+    __ bind(same_aligned);\n+    __ andi(tmp, src, 0b111);\n+    __ beqz(tmp, copy8);\n@@ -1046,2 +1019,2 @@\n-      __ addi(src, src, -wordSize * 4);\n-      __ addi(dst, dst, -wordSize * 4);\n+      __ addi(src, src, step);\n+      __ addi(dst, dst, step);\n@@ -1049,10 +1022,2 @@\n-    \/\/ we first load 32 bytes, then write it, so the direction here doesn't matter\n-    __ ld(tmp3, Address(src));\n-    __ ld(tmp4, Address(src, 8));\n-    __ ld(tmp5, Address(src, 16));\n-    __ ld(tmp6, Address(src, 24));\n-    __ sd(tmp3, Address(dst));\n-    __ sd(tmp4, Address(dst, 8));\n-    __ sd(tmp5, Address(dst, 16));\n-    __ sd(tmp6, Address(dst, 24));\n-\n+    (_masm->*ld_arr)(tmp3, Address(src), t0);\n+    (_masm->*st_arr)(tmp3, Address(dst), t0);\n@@ -1060,2 +1025,2 @@\n-      __ addi(src, src, wordSize * 4);\n-      __ addi(dst, dst, wordSize * 4);\n+      __ addi(src, src, step);\n+      __ addi(dst, dst, step);\n@@ -1063,8 +1028,3 @@\n-    __ addi(tmp, cnt, -(32 + wordSize * 4));\n-    __ addi(cnt, cnt, -wordSize * 4);\n-    __ bgez(tmp, copy32_loop); \/\/ cnt >= 32, do next loop\n-\n-    __ beqz(cnt, done); \/\/ if that's all - done\n-\n-    __ addi(tmp, cnt, -8); \/\/ if not - copy the reminder\n-    __ bltz(tmp, copy_small); \/\/ cnt < 8, go to copy_small, else fall throught to copy8_loop\n+    __ addi(cnt, cnt, -granularity);\n+    __ beqz(cnt, done);\n+    __ j(same_aligned);\n@@ -1072,1 +1032,1 @@\n-    __ bind(copy8_loop);\n+    __ bind(copy8);\n@@ -1083,1 +1043,0 @@\n-    __ addi(tmp, cnt, -(8 + wordSize));\n@@ -1085,1 +1044,2 @@\n-    __ bgez(tmp, copy8_loop); \/\/ cnt >= 8, do next loop\n+    __ addi(tmp4, cnt, -8);\n+    __ bgez(tmp4, copy8); \/\/ cnt >= 8, do next loop\n@@ -1087,1 +1047,1 @@\n-    __ beqz(cnt, done); \/\/ if that's all - done\n+    __ beqz(cnt, done);\n","filename":"src\/hotspot\/cpu\/riscv\/stubGenerator_riscv.cpp","additions":29,"deletions":69,"binary":false,"changes":98,"status":"modified"},{"patch":"@@ -1740,2 +1740,7 @@\n-  __ mv(x7, (address) &BytecodeCounter::_counter_value);\n-  __ atomic_addw(noreg, 1, x7);\n+  __ push_reg(t0);\n+  __ push_reg(x10);\n+  __ mv(x10, (address) &BytecodeCounter::_counter_value);\n+  __ mv(t0, 1);\n+  __ amoadd_d(zr, x10, t0, Assembler::aqrl);\n+  __ pop_reg(x10);\n+  __ pop_reg(t0);\n@@ -1744,4 +1749,1 @@\n-void TemplateInterpreterGenerator::histogram_bytecode(Template* t) {\n-  __ mv(x7, (address) &BytecodeHistogram::_counters[t->bytecode()]);\n-  __ atomic_addw(noreg, 1, x7);\n-}\n+void TemplateInterpreterGenerator::histogram_bytecode(Template* t) { ; }\n@@ -1749,20 +1751,1 @@\n-void TemplateInterpreterGenerator::histogram_bytecode_pair(Template* t) {\n-  \/\/ Calculate new index for counter:\n-  \/\/   _index = (_index >> log2_number_of_codes) |\n-  \/\/            (bytecode << log2_number_of_codes);\n-  Register index_addr = t1;\n-  Register index = t0;\n-  __ mv(index_addr, (address) &BytecodePairHistogram::_index);\n-  __ lw(index, index_addr);\n-  __ mv(x7, ((int)t->bytecode()) << BytecodePairHistogram::log2_number_of_codes);\n-  __ srli(index, index, BytecodePairHistogram::log2_number_of_codes);\n-  __ orrw(index, x7, index);\n-  __ sw(index, index_addr);\n-  \/\/ Bump bucket contents:\n-  \/\/   _counters[_index] ++;\n-  Register counter_addr = t1;\n-  __ mv(x7, (address) &BytecodePairHistogram::_counters);\n-  __ slli(index, index, LogBytesPerInt);\n-  __ add(counter_addr, x7, index);\n-  __ atomic_addw(noreg, 1, counter_addr);\n- }\n+void TemplateInterpreterGenerator::histogram_bytecode_pair(Template* t) { ; }\n","filename":"src\/hotspot\/cpu\/riscv\/templateInterpreterGenerator_riscv.cpp","additions":9,"deletions":26,"binary":false,"changes":35,"status":"modified"},{"patch":"@@ -288,1 +288,1 @@\n-void TemplateTable::ldc(LdcType type) {\n+void TemplateTable::ldc(bool wide) {\n@@ -292,1 +292,1 @@\n-  if (is_ldc_wide(type)) {\n+  if (wide) {\n@@ -323,1 +323,1 @@\n-  __ mv(c_rarg1, is_ldc_wide(type) ? 1 : 0);\n+  __ mv(c_rarg1, wide);\n@@ -357,1 +357,1 @@\n-void TemplateTable::fast_aldc(LdcType type) {\n+void TemplateTable::fast_aldc(bool wide) {\n@@ -364,1 +364,1 @@\n-  const int index_size = is_ldc_wide(type) ? sizeof(u2) : sizeof(u1);\n+  const int index_size = wide ? sizeof(u2) : sizeof(u1);\n","filename":"src\/hotspot\/cpu\/riscv\/templateTable_riscv.cpp","additions":5,"deletions":5,"binary":false,"changes":10,"status":"modified"},{"patch":"@@ -160,5 +160,0 @@\n-\n-    if (UseRVA20U64) {\n-      warning(\"UseRVA20U64 is not supported on this CPU\");\n-      FLAG_SET_DEFAULT(UseRVA20U64, false);\n-    }\n@@ -245,4 +240,2 @@\n-  if (!UseZicbop) {\n-    if (!FLAG_IS_DEFAULT(AllocatePrefetchStyle)) {\n-      warning(\"Zicbop is not available on this CPU\");\n-    }\n+  \/\/ disable prefetch\n+  if (FLAG_IS_DEFAULT(AllocatePrefetchStyle)) {\n@@ -250,32 +243,0 @@\n-  } else {\n-    \/\/ Limit AllocatePrefetchDistance so that it does not exceed the\n-    \/\/ constraint in AllocatePrefetchDistanceConstraintFunc.\n-    if (FLAG_IS_DEFAULT(AllocatePrefetchDistance)) {\n-      FLAG_SET_DEFAULT(AllocatePrefetchDistance, MIN2(512, 3 * (int)CacheLineSize));\n-    }\n-    if (FLAG_IS_DEFAULT(AllocatePrefetchStepSize)) {\n-      FLAG_SET_DEFAULT(AllocatePrefetchStepSize, (int)CacheLineSize);\n-    }\n-    if (FLAG_IS_DEFAULT(PrefetchScanIntervalInBytes)) {\n-      FLAG_SET_DEFAULT(PrefetchScanIntervalInBytes, 3 * (int)CacheLineSize);\n-    }\n-    if (FLAG_IS_DEFAULT(PrefetchCopyIntervalInBytes)) {\n-      FLAG_SET_DEFAULT(PrefetchCopyIntervalInBytes, 3 * (int)CacheLineSize);\n-    }\n-\n-    if (PrefetchCopyIntervalInBytes != -1 &&\n-        ((PrefetchCopyIntervalInBytes & 7) || (PrefetchCopyIntervalInBytes >= 32768))) {\n-      warning(\"PrefetchCopyIntervalInBytes must be -1, or a multiple of 8 and < 32768\");\n-      PrefetchCopyIntervalInBytes &= ~7;\n-      if (PrefetchCopyIntervalInBytes >= 32768) {\n-        PrefetchCopyIntervalInBytes = 32760;\n-      }\n-    }\n-    if (AllocatePrefetchDistance !=-1 && (AllocatePrefetchDistance & 7)) {\n-      warning(\"AllocatePrefetchDistance must be multiple of 8\");\n-      AllocatePrefetchDistance &= ~7;\n-    }\n-    if (AllocatePrefetchStepSize & 7) {\n-      warning(\"AllocatePrefetchStepSize must be multiple of 8\");\n-      AllocatePrefetchStepSize &= ~7;\n-    }\n","filename":"src\/hotspot\/cpu\/riscv\/vm_version_riscv.cpp","additions":2,"deletions":41,"binary":false,"changes":43,"status":"modified"},{"patch":"@@ -27,0 +27,1 @@\n+#include \"jvm.h\"\n@@ -31,1 +32,0 @@\n-#include \"jvm.h\"\n","filename":"src\/hotspot\/cpu\/s390\/methodHandles_s390.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -381,1 +381,1 @@\n-void TemplateTable::ldc(LdcType type) {\n+void TemplateTable::ldc(bool wide) {\n@@ -387,1 +387,1 @@\n-  if (is_ldc_wide(type)) {\n+  if (wide) {\n@@ -415,1 +415,1 @@\n-  __ load_const_optimized(Z_ARG2, is_ldc_wide(type) ? 1 : 0);\n+  __ load_const_optimized(Z_ARG2, wide);\n@@ -451,1 +451,1 @@\n-void TemplateTable::fast_aldc(LdcType type) {\n+void TemplateTable::fast_aldc(bool wide) {\n@@ -455,1 +455,1 @@\n-  int            index_size = is_ldc_wide(type) ? sizeof(u2) : sizeof(u1);\n+  int            index_size = wide ? sizeof(u2) : sizeof(u1);\n","filename":"src\/hotspot\/cpu\/s390\/templateTable_s390.cpp","additions":5,"deletions":5,"binary":false,"changes":10,"status":"modified"},{"patch":"@@ -27,0 +27,1 @@\n+#include \"jvm.h\"\n@@ -30,1 +31,0 @@\n-#include \"jvm.h\"\n","filename":"src\/hotspot\/cpu\/s390\/vm_version_s390.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -5011,34 +5011,0 @@\n-void Assembler::evpmadd52luq(XMMRegister dst, XMMRegister src1, XMMRegister src2, int vector_len) {\n-  evpmadd52luq(dst, k0, src1, src2, false, vector_len);\n-}\n-\n-void Assembler::evpmadd52luq(XMMRegister dst, KRegister mask, XMMRegister src1, XMMRegister src2, bool merge, int vector_len) {\n-  assert(VM_Version::supports_avx512ifma(), \"\");\n-  InstructionAttr attributes(vector_len, \/* rex_w *\/ true, \/* legacy_mode *\/ false, \/* no_mask_reg *\/ false, \/* uses_vl *\/ true);\n-  attributes.set_is_evex_instruction();\n-  attributes.set_embedded_opmask_register_specifier(mask);\n-  if (merge) {\n-    attributes.reset_is_clear_context();\n-  }\n-\n-  int encode = vex_prefix_and_encode(dst->encoding(), src1->encoding(), src2->encoding(), VEX_SIMD_66, VEX_OPCODE_0F_38, &attributes);\n-  emit_int16((unsigned char)0xB4, (0xC0 | encode));\n-}\n-\n-void Assembler::evpmadd52huq(XMMRegister dst, XMMRegister src1, XMMRegister src2, int vector_len) {\n-  evpmadd52huq(dst, k0, src1, src2, false, vector_len);\n-}\n-\n-void Assembler::evpmadd52huq(XMMRegister dst, KRegister mask, XMMRegister src1, XMMRegister src2, bool merge, int vector_len) {\n-  assert(VM_Version::supports_avx512ifma(), \"\");\n-  InstructionAttr attributes(vector_len, \/* rex_w *\/ true, \/* legacy_mode *\/ false, \/* no_mask_reg *\/ false, \/* uses_vl *\/ true);\n-  attributes.set_is_evex_instruction();\n-  attributes.set_embedded_opmask_register_specifier(mask);\n-  if (merge) {\n-    attributes.reset_is_clear_context();\n-  }\n-\n-  int encode = vex_prefix_and_encode(dst->encoding(), src1->encoding(), src2->encoding(), VEX_SIMD_66, VEX_OPCODE_0F_38, &attributes);\n-  emit_int16((unsigned char)0xB5, (0xC0 | encode));\n-}\n-\n@@ -5462,36 +5428,0 @@\n-void Assembler::evpunpcklqdq(XMMRegister dst, XMMRegister src1, XMMRegister src2, int vector_len) {\n-  evpunpcklqdq(dst, k0, src1, src2, false, vector_len);\n-}\n-\n-void Assembler::evpunpcklqdq(XMMRegister dst, KRegister mask, XMMRegister src1, XMMRegister src2, bool merge, int vector_len) {\n-  assert(VM_Version::supports_evex(), \"requires AVX512F\");\n-  assert(vector_len == Assembler::AVX_512bit || VM_Version::supports_avx512vl(), \"requires AVX512VL\");\n-  InstructionAttr attributes(vector_len, \/* rex_w *\/ true, \/* legacy_mode *\/ false, \/* no_mask_reg *\/ false, \/* uses_vl *\/ true);\n-  attributes.set_is_evex_instruction();\n-  attributes.set_embedded_opmask_register_specifier(mask);\n-  if (merge) {\n-    attributes.reset_is_clear_context();\n-  }\n-\n-  int encode = vex_prefix_and_encode(dst->encoding(), src1->encoding(), src2->encoding(), VEX_SIMD_66, VEX_OPCODE_0F, &attributes);\n-  emit_int16(0x6C, (0xC0 | encode));\n-}\n-\n-void Assembler::evpunpckhqdq(XMMRegister dst, XMMRegister src1, XMMRegister src2, int vector_len) {\n-  evpunpckhqdq(dst, k0, src1, src2, false, vector_len);\n-}\n-\n-void Assembler::evpunpckhqdq(XMMRegister dst, KRegister mask, XMMRegister src1, XMMRegister src2, bool merge, int vector_len) {\n-  assert(VM_Version::supports_evex(), \"requires AVX512F\");\n-  assert(vector_len == Assembler::AVX_512bit || VM_Version::supports_avx512vl(), \"requires AVX512VL\");\n-  InstructionAttr attributes(vector_len, \/* rex_w *\/ true, \/* legacy_mode *\/ false, \/* no_mask_reg *\/ false, \/* uses_vl *\/ true);\n-  attributes.set_is_evex_instruction();\n-  attributes.set_embedded_opmask_register_specifier(mask);\n-  if (merge) {\n-    attributes.reset_is_clear_context();\n-  }\n-\n-  int encode = vex_prefix_and_encode(dst->encoding(), src1->encoding(), src2->encoding(), VEX_SIMD_66, VEX_OPCODE_0F, &attributes);\n-  emit_int16(0x6D, (0xC0 | encode));\n-}\n-\n@@ -5942,12 +5872,0 @@\n-#ifdef _LP64\n-void Assembler::shldq(Register dst, Register src, int8_t imm8) {\n-  int encode = prefixq_and_encode(src->encoding(), dst->encoding());\n-  emit_int32(0x0F, (unsigned char)0xA4, (0xC0 | encode), imm8);\n-}\n-\n-void Assembler::shrdq(Register dst, Register src, int8_t imm8) {\n-  int encode = prefixq_and_encode(src->encoding(), dst->encoding());\n-  emit_int32(0x0F, (unsigned char)0xAC, (0xC0 | encode), imm8);\n-}\n-#endif\n-\n@@ -7825,6 +7743,5 @@\n-void Assembler::evpandq(XMMRegister dst, XMMRegister nds, XMMRegister src, int vector_len) {\n-  evpandq(dst, k0, nds, src, false, vector_len);\n-}\n-\n-void Assembler::evpandq(XMMRegister dst, XMMRegister nds, Address src, int vector_len) {\n-  evpandq(dst, k0, nds, src, false, vector_len);\n+void Assembler::vpandq(XMMRegister dst, XMMRegister nds, XMMRegister src, int vector_len) {\n+  assert(VM_Version::supports_evex(), \"\");\n+  InstructionAttr attributes(vector_len, \/* vex_w *\/ true, \/* legacy_mode *\/ false, \/* no_mask_reg *\/ true, \/* uses_vl *\/ true);\n+  int encode = vex_prefix_and_encode(dst->encoding(), nds->encoding(), src->encoding(), VEX_SIMD_66, VEX_OPCODE_0F, &attributes);\n+  emit_int16((unsigned char)0xDB, (0xC0 | encode));\n@@ -7943,2 +7860,5 @@\n-void Assembler::evporq(XMMRegister dst, XMMRegister nds, XMMRegister src, int vector_len) {\n-  evporq(dst, k0, nds, src, false, vector_len);\n+void Assembler::vporq(XMMRegister dst, XMMRegister nds, XMMRegister src, int vector_len) {\n+  assert(VM_Version::supports_evex(), \"\");\n+  InstructionAttr attributes(vector_len, \/* vex_w *\/ true, \/* legacy_mode *\/ false, \/* no_mask_reg *\/ true, \/* uses_vl *\/ true);\n+  int encode = vex_prefix_and_encode(dst->encoding(), nds->encoding(), src->encoding(), VEX_SIMD_66, VEX_OPCODE_0F, &attributes);\n+  emit_int16((unsigned char)0xEB, (0xC0 | encode));\n@@ -7947,3 +7867,0 @@\n-void Assembler::evporq(XMMRegister dst, XMMRegister nds, Address src, int vector_len) {\n-  evporq(dst, k0, nds, src, false, vector_len);\n-}\n@@ -8090,2 +8007,1 @@\n-  assert(VM_Version::supports_evex(), \"requires AVX512F\");\n-  assert(vector_len == Assembler::AVX_512bit || VM_Version::supports_avx512vl(), \"requires AVX512VL\");\n+  assert(VM_Version::supports_evex(), \"\");\n@@ -8103,2 +8019,1 @@\n-  assert(VM_Version::supports_evex(), \"requires AVX512F\");\n-  assert(vector_len == Assembler::AVX_512bit || VM_Version::supports_avx512vl(), \"requires AVX512VL\");\n+  assert(vector_len == AVX_512bit || VM_Version::supports_avx512vl(), \"\");\n@@ -8119,2 +8034,1 @@\n-  assert(VM_Version::supports_evex(), \"requires AVX512F\");\n-  assert(vector_len == Assembler::AVX_512bit || VM_Version::supports_avx512vl(), \"requires AVX512VL\");\n+  assert(VM_Version::supports_evex(), \"\");\n@@ -8132,2 +8046,1 @@\n-  assert(VM_Version::supports_evex(), \"requires AVX512F\");\n-  assert(vector_len == Assembler::AVX_512bit || VM_Version::supports_avx512vl(), \"requires AVX512VL\");\n+  assert(vector_len == AVX_512bit || VM_Version::supports_avx512vl(), \"\");\n@@ -8291,11 +8204,0 @@\n-  assert(VM_Version::supports_evex(), \"requires AVX512F\");\n-  assert(vector_len == Assembler::AVX_512bit || VM_Version::supports_avx512vl(), \"requires AVX512VL\");\n-  InstructionAttr attributes(vector_len, \/* vex_w *\/ true, \/* legacy_mode *\/ false, \/* no_mask_reg *\/ true, \/* uses_vl *\/ true);\n-  attributes.set_is_evex_instruction();\n-  int encode = vex_prefix_and_encode(dst->encoding(), src2->encoding(), src3->encoding(), VEX_SIMD_66, VEX_OPCODE_0F_3A, &attributes);\n-  emit_int8(0x25);\n-  emit_int8((unsigned char)(0xC0 | encode));\n-  emit_int8(imm8);\n-}\n-\n-void Assembler::vpternlogq(XMMRegister dst, int imm8, XMMRegister src2, Address src3, int vector_len) {\n@@ -8304,2 +8206,0 @@\n-  assert(dst != xnoreg, \"sanity\");\n-  InstructionMark im(this);\n@@ -8308,2 +8208,1 @@\n-  attributes.set_address_attributes(\/* tuple_type *\/ EVEX_FV, \/* input_size_in_bits *\/ EVEX_64bit);\n-  vex_prefix(src3, src2->encoding(), dst->encoding(), VEX_SIMD_66, VEX_OPCODE_0F_3A, &attributes);\n+  int encode = vex_prefix_and_encode(dst->encoding(), src2->encoding(), src3->encoding(), VEX_SIMD_66, VEX_OPCODE_0F_3A, &attributes);\n@@ -8311,1 +8210,1 @@\n-  emit_operand(dst, src3, 1);\n+  emit_int8((unsigned char)(0xC0 | encode));\n@@ -13556,7 +13455,0 @@\n-void Assembler::vzeroall() {\n-  assert(VM_Version::supports_avx(), \"requires AVX\");\n-  InstructionAttr attributes(AVX_256bit, \/* vex_w *\/ false, \/* legacy_mode *\/ true, \/* no_mask_reg *\/ true, \/* uses_vl *\/ false);\n-  (void)vex_prefix_and_encode(0, 0, 0, VEX_SIMD_NONE, VEX_OPCODE_0F, &attributes);\n-  emit_int8(0x77);\n-}\n-\n","filename":"src\/hotspot\/cpu\/x86\/assembler_x86.cpp","additions":16,"deletions":124,"binary":false,"changes":140,"status":"modified"},{"patch":"@@ -1894,4 +1894,0 @@\n-  void evpmadd52luq(XMMRegister dst, XMMRegister src1, XMMRegister src2, int vector_len);\n-  void evpmadd52luq(XMMRegister dst, KRegister mask, XMMRegister src1, XMMRegister src2, bool merge, int vector_len);\n-  void evpmadd52huq(XMMRegister dst, XMMRegister src1, XMMRegister src2, int vector_len);\n-  void evpmadd52huq(XMMRegister dst, KRegister mask, XMMRegister src1, XMMRegister src2, bool merge, int vector_len);\n@@ -1997,5 +1993,0 @@\n-  void evpunpcklqdq(XMMRegister dst, XMMRegister src1, XMMRegister src2, int vector_len);\n-  void evpunpcklqdq(XMMRegister dst, KRegister mask, XMMRegister src1, XMMRegister src2, bool merge, int vector_len);\n-  void evpunpckhqdq(XMMRegister dst, XMMRegister src1, XMMRegister src2, int vector_len);\n-  void evpunpckhqdq(XMMRegister dst, KRegister mask, XMMRegister src1, XMMRegister src2, bool merge, int vector_len);\n-\n@@ -2104,4 +2095,0 @@\n-#ifdef _LP64\n-  void shldq(Register dst, Register src, int8_t imm8);\n-  void shrdq(Register dst, Register src, int8_t imm8);\n-#endif\n@@ -2632,2 +2619,1 @@\n-  void evpandq(XMMRegister dst, XMMRegister nds, XMMRegister src, int vector_len);\n-  void evpandq(XMMRegister dst, XMMRegister nds, Address src, int vector_len);\n+  void vpandq(XMMRegister dst, XMMRegister nds, XMMRegister src, int vector_len);\n@@ -2643,2 +2629,1 @@\n-  void evporq(XMMRegister dst, XMMRegister nds, XMMRegister src, int vector_len);\n-  void evporq(XMMRegister dst, XMMRegister nds, Address     src, int vector_len);\n+  void vporq(XMMRegister dst, XMMRegister nds, XMMRegister src, int vector_len);\n@@ -2658,1 +2643,0 @@\n-  void vpternlogq(XMMRegister dst, int imm8, XMMRegister src2, Address     src3, int vector_len);\n@@ -2772,2 +2756,0 @@\n-  void vzeroall();\n-\n","filename":"src\/hotspot\/cpu\/x86\/assembler_x86.hpp","additions":2,"deletions":20,"binary":false,"changes":22,"status":"modified"},{"patch":"@@ -3450,1 +3450,1 @@\n-    __ incrementl(ExternalAddress(Runtime1::arraycopy_count_address(basic_type)), rscratch1);\n+    __ incrementl(ExternalAddress(Runtime1::arraycopy_count_address(basic_type)));\n","filename":"src\/hotspot\/cpu\/x86\/c1_LIRAssembler_x86.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -707,0 +707,5 @@\n+  \/\/ DONE_LABEL is a hot target - we'd really like to place it at the\n+  \/\/ start of cache line by padding with NOPs.\n+  \/\/ See the AMD and Intel software optimization manuals for the\n+  \/\/ most efficient \"long\" NOP encodings.\n+  \/\/ Unfortunately none of our alignment mechanisms suffice.\n@@ -768,1 +773,1 @@\n-  Label DONE_LABEL, Stacked, COUNT, NO_COUNT;\n+  Label DONE_LABEL, Stacked, CheckSucc, COUNT, NO_COUNT;\n@@ -827,0 +832,2 @@\n+  get_thread (boxReg);\n+\n@@ -836,1 +843,1 @@\n-  jccb  (Assembler::notZero, DONE_LABEL);\n+  jccb  (Assembler::notZero, CheckSucc);\n@@ -839,0 +846,18 @@\n+\n+  bind (Stacked);\n+  \/\/ It's not inflated and it's not recursively stack-locked.\n+  \/\/ It must be stack-locked.\n+  \/\/ Try to reset the header to displaced header.\n+  \/\/ The \"box\" value on the stack is stable, so we can reload\n+  \/\/ and be assured we observe the same value as above.\n+  movptr(tmpReg, Address(boxReg, 0));\n+  lock();\n+  cmpxchgptr(tmpReg, Address(objReg, oopDesc::mark_offset_in_bytes())); \/\/ Uses RAX which is box\n+  \/\/ Intention fall-thru into DONE_LABEL\n+\n+  \/\/ DONE_LABEL is a hot target - we'd really like to place it at the\n+  \/\/ start of cache line by padding with NOPs.\n+  \/\/ See the AMD and Intel software optimization manuals for the\n+  \/\/ most efficient \"long\" NOP encodings.\n+  \/\/ Unfortunately none of our alignment mechanisms suffice.\n+  bind (CheckSucc);\n@@ -841,1 +866,1 @@\n-  Label CheckSucc, LNotRecursive, LSuccess, LGoSlowPath;\n+  Label LNotRecursive, LSuccess, LGoSlowPath;\n@@ -914,1 +939,0 @@\n-#endif\n@@ -920,1 +944,0 @@\n-    \/\/ Intentional fall-thru into DONE_LABEL\n@@ -922,0 +945,1 @@\n+#endif\n@@ -5258,1 +5282,1 @@\n-    evpandq(dst, xtmp2, src, vec_enc);\n+    vpandq(dst, xtmp2, src, vec_enc);\n@@ -5269,1 +5293,1 @@\n-    evporq(xtmp2, dst, xtmp2, vec_enc);\n+    vporq(xtmp2, dst, xtmp2, vec_enc);\n@@ -5324,1 +5348,1 @@\n-  evpandq(dst, xtmp1, src, vec_enc);\n+  vpandq(dst, xtmp1, src, vec_enc);\n@@ -5328,1 +5352,1 @@\n-  evporq(dst, dst, xtmp1, vec_enc);\n+  vporq(dst, dst, xtmp1, vec_enc);\n","filename":"src\/hotspot\/cpu\/x86\/c2_MacroAssembler_x86.cpp","additions":33,"deletions":9,"binary":false,"changes":42,"status":"modified"},{"patch":"@@ -26,0 +26,1 @@\n+#include \"jvm.h\"\n@@ -30,1 +31,0 @@\n-#include \"crc32c.h\"\n@@ -37,1 +37,0 @@\n-#include \"jvm.h\"\n@@ -56,0 +55,1 @@\n+#include \"crc32c.h\"\n@@ -1220,13 +1220,0 @@\n-#ifdef _LP64\n-void MacroAssembler::andq(Register dst, AddressLiteral src, Register rscratch) {\n-  assert(rscratch != noreg || always_reachable(src), \"missing\");\n-\n-  if (reachable(src)) {\n-    andq(dst, as_Address(src));\n-  } else {\n-    lea(rscratch, src);\n-    andq(dst, Address(rscratch, 0));\n-  }\n-}\n-#endif\n-\n@@ -9121,34 +9108,0 @@\n-\n-void MacroAssembler::evpandq(XMMRegister dst, XMMRegister nds, AddressLiteral src, int vector_len, Register rscratch) {\n-  assert(rscratch != noreg || always_reachable(src), \"missing\");\n-\n-  if (reachable(src)) {\n-    evpandq(dst, nds, as_Address(src), vector_len);\n-  } else {\n-    lea(rscratch, src);\n-    evpandq(dst, nds, Address(rscratch, 0), vector_len);\n-  }\n-}\n-\n-void MacroAssembler::evporq(XMMRegister dst, XMMRegister nds, AddressLiteral src, int vector_len, Register rscratch) {\n-  assert(rscratch != noreg || always_reachable(src), \"missing\");\n-\n-  if (reachable(src)) {\n-    evporq(dst, nds, as_Address(src), vector_len);\n-  } else {\n-    lea(rscratch, src);\n-    evporq(dst, nds, Address(rscratch, 0), vector_len);\n-  }\n-}\n-\n-void MacroAssembler::vpternlogq(XMMRegister dst, int imm8, XMMRegister src2, AddressLiteral src3, int vector_len, Register rscratch) {\n-  assert(rscratch != noreg || always_reachable(src3), \"missing\");\n-\n-  if (reachable(src3)) {\n-    vpternlogq(dst, imm8, src2, as_Address(src3), vector_len);\n-  } else {\n-    lea(rscratch, src3);\n-    vpternlogq(dst, imm8, src2, Address(rscratch, 0), vector_len);\n-  }\n-}\n-\n","filename":"src\/hotspot\/cpu\/x86\/macroAssembler_x86.cpp","additions":2,"deletions":49,"binary":false,"changes":51,"status":"modified"},{"patch":"@@ -733,5 +733,0 @@\n-#ifdef _LP64\n-  using Assembler::andq;\n-  void andq(Register dst, AddressLiteral src, Register rscratch = noreg);\n-#endif\n-\n@@ -1762,9 +1757,0 @@\n-  using Assembler::evpandq;\n-  void evpandq(XMMRegister dst, XMMRegister nds, AddressLiteral src, int vector_len, Register rscratch = noreg);\n-\n-  using Assembler::evporq;\n-  void evporq(XMMRegister dst, XMMRegister nds, AddressLiteral src, int vector_len, Register rscratch = noreg);\n-\n-  using Assembler::vpternlogq;\n-  void vpternlogq(XMMRegister dst, int imm8, XMMRegister src2, AddressLiteral src3, int vector_len, Register rscratch = noreg);\n-\n","filename":"src\/hotspot\/cpu\/x86\/macroAssembler_x86.hpp","additions":0,"deletions":14,"binary":false,"changes":14,"status":"modified"},{"patch":"@@ -69,1 +69,0 @@\n-  addl(r1, t);                                   \\\n@@ -75,1 +74,1 @@\n-  addl(r1, rsi);                                 \\\n+  leal(r1, Address(r1, rsi, Address::times_1, t)); \\\n@@ -80,1 +79,0 @@\n-  addl(r1, t);                                   \\\n@@ -88,1 +86,1 @@\n-  addl(r1, rsi);                                 \\\n+  leal(r1, Address(r1, rsi, Address::times_1, t)); \\\n@@ -93,1 +91,0 @@\n-  addl(r1, t);                                   \\\n@@ -98,1 +95,1 @@\n-  addl(r1, rsi);                                 \\\n+  leal(r1, Address(r1, rsi, Address::times_1, t)); \\\n@@ -103,1 +100,0 @@\n-  addl(r1, t);                                   \\\n@@ -109,1 +105,1 @@\n-  addl(r1, rsi);                                 \\\n+  leal(r1, Address(r1, rsi, Address::times_1, t)); \\\n","filename":"src\/hotspot\/cpu\/x86\/macroAssembler_x86_md5.cpp","additions":4,"deletions":8,"binary":false,"changes":12,"status":"modified"},{"patch":"@@ -26,0 +26,1 @@\n+#include \"jvm.h\"\n@@ -32,1 +33,0 @@\n-#include \"jvm.h\"\n","filename":"src\/hotspot\/cpu\/x86\/methodHandles_x86.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -513,18 +513,0 @@\n-#ifdef _LP64\n-  union {\n-    jlong cb_long;\n-    unsigned char code_buffer[8];\n-  } u;\n-\n-  u.cb_long = *(jlong *)verified_entry;\n-\n-  intptr_t disp = (intptr_t)dest - ((intptr_t)verified_entry + 1 + 4);\n-  guarantee(disp == (intptr_t)(int32_t)disp, \"must be 32-bit offset\");\n-\n-  u.code_buffer[0] = instruction_code;\n-  *(int32_t*)(u.code_buffer + 1) = (int32_t)disp;\n-\n-  Atomic::store((jlong *) verified_entry, u.cb_long);\n-  ICache::invalidate_range(verified_entry, 8);\n-\n-#else\n@@ -534,0 +516,3 @@\n+#ifdef AMD64\n+  guarantee(disp == (intptr_t)(int32_t)disp, \"must be 32-bit offset\");\n+#endif \/\/ AMD64\n@@ -564,1 +549,0 @@\n-#endif \/\/ _LP64\n","filename":"src\/hotspot\/cpu\/x86\/nativeInst_x86.cpp","additions":3,"deletions":19,"binary":false,"changes":22,"status":"modified"},{"patch":"@@ -2522,1 +2522,1 @@\n-    __ evporq(mask, tmp, input_initial_valid_b64, Assembler::AVX_512bit);\n+    __ vporq(mask, tmp, input_initial_valid_b64, Assembler::AVX_512bit);\n@@ -3338,1 +3338,1 @@\n-      StubRoutines::_dtan = generate_libmTan(); \/\/ from stubGenerator_x86_64_tan.cpp\n+      StubRoutines::_dtan = generate_libmTan();\n@@ -3341,1 +3341,1 @@\n-      StubRoutines::_dexp = generate_libmExp(); \/\/ from stubGenerator_x86_64_exp.cpp\n+      StubRoutines::_dexp = generate_libmExp();\n@@ -3344,1 +3344,1 @@\n-      StubRoutines::_dpow = generate_libmPow(); \/\/ from stubGenerator_x86_64_pow.cpp\n+      StubRoutines::_dpow = generate_libmPow();\n@@ -3347,1 +3347,1 @@\n-      StubRoutines::_dlog = generate_libmLog(); \/\/ from stubGenerator_x86_64_log.cpp\n+      StubRoutines::_dlog = generate_libmLog();\n@@ -3350,1 +3350,1 @@\n-      StubRoutines::_dlog10 = generate_libmLog10(); \/\/ from stubGenerator_x86_64_log.cpp\n+      StubRoutines::_dlog10 = generate_libmLog10();\n@@ -3712,4 +3712,0 @@\n-  if (UsePolyIntrinsics) {\n-    StubRoutines::_poly1305_processBlocks = generate_poly1305_processBlocks();\n-  }\n-\n@@ -3726,2 +3722,0 @@\n-\n-  generate_libm_stubs();\n","filename":"src\/hotspot\/cpu\/x86\/stubGenerator_x86_64.cpp","additions":6,"deletions":12,"binary":false,"changes":18,"status":"modified"},{"patch":"@@ -390,18 +390,0 @@\n-  \/\/ Poly1305 multiblock using IFMA instructions\n-  address generate_poly1305_processBlocks();\n-  void poly1305_process_blocks_avx512(const Register input, const Register length,\n-                                      const Register A0, const Register A1, const Register A2,\n-                                      const Register R0, const Register R1, const Register C1);\n-  void poly1305_multiply_scalar(const Register a0, const Register a1, const Register a2,\n-                                const Register r0, const Register r1, const Register c1, bool only128,\n-                                const Register t0, const Register t1, const Register t2,\n-                                const Register mulql, const Register mulqh);\n-  void poly1305_multiply8_avx512(const XMMRegister A0, const XMMRegister A1, const XMMRegister A2,\n-                                 const XMMRegister R0, const XMMRegister R1, const XMMRegister R2, const XMMRegister R1P, const XMMRegister R2P,\n-                                 const XMMRegister P0L, const XMMRegister P0H, const XMMRegister P1L, const XMMRegister P1H, const XMMRegister P2L, const XMMRegister P2H,\n-                                 const XMMRegister TMP, const Register rscratch);\n-  void poly1305_limbs(const Register limbs, const Register a0, const Register a1, const Register a2, const Register t0, const Register t1);\n-  void poly1305_limbs_out(const Register a0, const Register a1, const Register a2, const Register limbs, const Register t0, const Register t1);\n-  void poly1305_limbs_avx512(const XMMRegister D0, const XMMRegister D1,\n-                             const XMMRegister L0, const XMMRegister L1, const XMMRegister L2, bool padMSG,\n-                             const XMMRegister TMP, const Register rscratch);\n","filename":"src\/hotspot\/cpu\/x86\/stubGenerator_x86_64.hpp","additions":0,"deletions":18,"binary":false,"changes":18,"status":"modified"},{"patch":"@@ -1,1027 +0,0 @@\n-\/*\n- * Copyright (c) 2022, Intel Corporation. All rights reserved.\n- *\n- * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n- *\n- * This code is free software; you can redistribute it and\/or modify it\n- * under the terms of the GNU General Public License version 2 only, as\n- * published by the Free Software Foundation.\n- *\n- * This code is distributed in the hope that it will be useful, but WITHOUT\n- * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n- * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n- * version 2 for more details (a copy is included in the LICENSE file that\n- * accompanied this code).\n- *\n- * You should have received a copy of the GNU General Public License version\n- * 2 along with this work; if not, write to the Free Software Foundation,\n- * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n- *\n- * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n- * or visit www.oracle.com if you need additional information or have any\n- * questions.\n- *\n- *\/\n-\n-#include \"precompiled.hpp\"\n-#include \"macroAssembler_x86.hpp\"\n-#include \"stubGenerator_x86_64.hpp\"\n-\n-#define __ _masm->\n-\n-\/\/ References:\n-\/\/  - (Normative) RFC7539 - ChaCha20 and Poly1305 for IETF Protocols\n-\/\/  - M. Goll and S. Gueron, \"Vectorization of Poly1305 Message Authentication Code\"\n-\/\/  - \"The design of Poly1305\" https:\/\/loup-vaillant.fr\/tutorials\/poly1305-design\n-\n-\/\/ Explanation for the 'well known' modular arithmetic optimization, reduction by pseudo-Mersene prime 2^130-5:\n-\/\/\n-\/\/ Reduction by 2^130-5 can be expressed as follows:\n-\/\/    ( a×2^130 + b ) mod 2^130-5     \/\/i.e. number split along the 130-bit boundary\n-\/\/                                 = ( a×2^130 - 5×a + 5×a + b ) mod 2^130-5\n-\/\/                                 = ( a×(2^130 - 5) + 5×a + b ) mod 2^130-5 \/\/ i.e. adding multiples of modulus is a noop\n-\/\/                                 = ( 5×a + b ) mod 2^130-5\n-\/\/ QED: shows mathematically the well known algorithm of 'split the number down the middle, multiply upper and add'\n-\/\/ This is particularly useful to understand when combining with 'odd-sized' limbs that might cause misallignment\n-\/\/\n-\n-\/\/ Pseudocode for this file (in general):\n-\/\/    * used for poly1305_multiply_scalar\n-\/\/    × used for poly1305_multiply8_avx512\n-\/\/    lower-case variables are scalar numbers in 3×44-bit limbs (in gprs)\n-\/\/    upper-case variables are 8-element vector numbers in 3×44-bit limbs (in zmm registers)\n-\/\/    [ ] used to denote vector numbers (with their elements)\n-\n-\/\/ Constant Pool:\n-ATTRIBUTE_ALIGNED(64) uint64_t POLY1305_PAD_MSG[] = {\n-  0x0000010000000000, 0x0000010000000000,\n-  0x0000010000000000, 0x0000010000000000,\n-  0x0000010000000000, 0x0000010000000000,\n-  0x0000010000000000, 0x0000010000000000,\n-};\n-static address poly1305_pad_msg() {\n-  return (address)POLY1305_PAD_MSG;\n-}\n-\n-ATTRIBUTE_ALIGNED(64) uint64_t POLY1305_MASK42[] = {\n-  0x000003ffffffffff, 0x000003ffffffffff,\n-  0x000003ffffffffff, 0x000003ffffffffff,\n-  0x000003ffffffffff, 0x000003ffffffffff,\n-  0x000003ffffffffff, 0x000003ffffffffff\n-};\n-static address poly1305_mask42() {\n-  return (address)POLY1305_MASK42;\n-}\n-\n-ATTRIBUTE_ALIGNED(64) uint64_t POLY1305_MASK44[] = {\n-  0x00000fffffffffff, 0x00000fffffffffff,\n-  0x00000fffffffffff, 0x00000fffffffffff,\n-  0x00000fffffffffff, 0x00000fffffffffff,\n-  0x00000fffffffffff, 0x00000fffffffffff,\n-};\n-static address poly1305_mask44() {\n-  return (address)POLY1305_MASK44;\n-}\n-\n-\/\/ Compute product for 8 16-byte message blocks,\n-\/\/ i.e. For each block, compute [a2 a1 a0] = [a2 a1 a0] × [r2 r1 r0]\n-\/\/\n-\/\/ Each block\/number is represented by 3 44-bit limb digits, start with multiplication\n-\/\/\n-\/\/      a2       a1       a0\n-\/\/ ×    r2       r1       r0\n-\/\/ ----------------------------------\n-\/\/     a2×r0    a1×r0    a0×r0\n-\/\/ +   a1×r1    a0×r1  5×a2×r1'     (r1' = r1<<2)\n-\/\/ +   a0×r2  5×a2×r2' 5×a1×r2'     (r2' = r2<<2)\n-\/\/ ----------------------------------\n-\/\/        p2       p1       p0\n-\/\/\n-\/\/ Then, propagate the carry (bits after bit 44) from lower limbs into higher limbs.\n-\/\/ Then, modular reduction from upper limb wrapped to lower limbs\n-\/\/\n-\/\/ Math Note 1: 'carry propagation' from p2 to p0 involves multiplication by 5 (i.e. slightly modified modular reduction from above):\n-\/\/    ( p2×2^88 ) mod 2^130-5\n-\/\/                             = ( p2'×2^88 + p2''×2^130) mod 2^130-5 \/\/ Split on 130-bit boudary\n-\/\/                             = ( p2'×2^88 + p2''×2^130 - 5×p2'' + 5×p2'') mod 2^130-5\n-\/\/                             = ( p2'×2^88 + p2''×(2^130 - 5) + 5×p2'') mod 2^130-5 \/\/ i.e. adding multiples of modulus is a noop\n-\/\/                             = ( p2'×2^88 + 5×p2'') mod 2^130-5\n-\/\/\n-\/\/ Math Note 2: R1P = 4*5*R1 and R2P = 4*5*R2; This precomputation allows simultaneous reduction and multiplication.\n-\/\/ This is not the standard 'multiply-upper-by-5', here is why the factor is 4*5 instead of 5.\n-\/\/ For example, partial product (a2×r2):\n-\/\/    (a2×2^88)×(r2×2^88) mod 2^130-5\n-\/\/                                    = (a2×r2 × 2^176) mod 2^130-5\n-\/\/                                    = (a2×r2 × 2^46×2^130) mod 2^130-5\n-\/\/                                    = (a2×r2×2^46 × 2^130- 5×a2×r2×2^46 + 5×a2×r2×2^46) mod 2^130-5\n-\/\/                                    = (a2×r2×2^46 × (2^130- 5) + 5×a2×r2×2^46) mod 2^130-5 \/\/ i.e. adding multiples of modulus is a noop\n-\/\/                                    = (5×a2×r2×2^46) mod 2^130-5\n-\/\/                                    = (a2×5×r2×2^2 × 2^44) mod 2^130-5 \/\/ Align to limb boudary\n-\/\/                                    = (a2×[5×r2×4] × 2^44) mod 2^130-5\n-\/\/                                    = (a2×R2P × 2^44) mod 2^130-5 \/\/ i.e. R2P = 4*5*R2\n-\/\/\n-void StubGenerator::poly1305_multiply8_avx512(\n-  const XMMRegister A0, const XMMRegister A1, const XMMRegister A2,\n-  const XMMRegister R0, const XMMRegister R1, const XMMRegister R2, const XMMRegister R1P, const XMMRegister R2P,\n-  const XMMRegister P0L, const XMMRegister P0H, const XMMRegister P1L, const XMMRegister P1H, const XMMRegister P2L, const XMMRegister P2H,\n-  const XMMRegister TMP, const Register rscratch)\n-{\n-\n-  \/\/ Reset partial sums\n-  __ evpxorq(P0L, P0L, P0L, Assembler::AVX_512bit);\n-  __ evpxorq(P0H, P0H, P0H, Assembler::AVX_512bit);\n-  __ evpxorq(P1L, P1L, P1L, Assembler::AVX_512bit);\n-  __ evpxorq(P1H, P1H, P1H, Assembler::AVX_512bit);\n-  __ evpxorq(P2L, P2L, P2L, Assembler::AVX_512bit);\n-  __ evpxorq(P2H, P2H, P2H, Assembler::AVX_512bit);\n-\n-  \/\/ Calculate partial products\n-  \/\/ p0 = a2×r1'\n-  \/\/ p1 = a2×r2'\n-  \/\/ p2 = a2×r0\n-  __ evpmadd52luq(P0L, A2, R1P, Assembler::AVX_512bit);\n-  __ evpmadd52huq(P0H, A2, R1P, Assembler::AVX_512bit);\n-  __ evpmadd52luq(P1L, A2, R2P, Assembler::AVX_512bit);\n-  __ evpmadd52huq(P1H, A2, R2P, Assembler::AVX_512bit);\n-  __ evpmadd52luq(P2L, A2, R0, Assembler::AVX_512bit);\n-  __ evpmadd52huq(P2H, A2, R0, Assembler::AVX_512bit);\n-\n-  \/\/ p0 += a0×r0\n-  \/\/ p1 += a0×r1\n-  \/\/ p2 += a0×r2\n-  __ evpmadd52luq(P1L, A0, R1, Assembler::AVX_512bit);\n-  __ evpmadd52huq(P1H, A0, R1, Assembler::AVX_512bit);\n-  __ evpmadd52luq(P2L, A0, R2, Assembler::AVX_512bit);\n-  __ evpmadd52huq(P2H, A0, R2, Assembler::AVX_512bit);\n-  __ evpmadd52luq(P0L, A0, R0, Assembler::AVX_512bit);\n-  __ evpmadd52huq(P0H, A0, R0, Assembler::AVX_512bit);\n-\n-  \/\/ p0 += a1×r2'\n-  \/\/ p1 += a1×r0\n-  \/\/ p2 += a1×r1\n-  __ evpmadd52luq(P0L, A1, R2P, Assembler::AVX_512bit);\n-  __ evpmadd52huq(P0H, A1, R2P, Assembler::AVX_512bit);\n-  __ evpmadd52luq(P1L, A1, R0, Assembler::AVX_512bit);\n-  __ evpmadd52huq(P1H, A1, R0, Assembler::AVX_512bit);\n-  __ evpmadd52luq(P2L, A1, R1, Assembler::AVX_512bit);\n-  __ evpmadd52huq(P2H, A1, R1, Assembler::AVX_512bit);\n-\n-  \/\/ Carry propagation:\n-  \/\/ (Not quite aligned)                         | More mathematically correct:\n-  \/\/         P2L   P1L   P0L                     |                 P2L×2^88 + P1L×2^44 + P0L×2^0\n-  \/\/ + P2H   P1H   P0H                           |   + P2H×2^140 + P1H×2^96 + P0H×2^52\n-  \/\/ ---------------------------                 |   -----------------------------------------------\n-  \/\/ = P2H    A2    A1    A0                     |   = P2H×2^130 + A2×2^88 +   A1×2^44 +  A0×2^0\n-  \/\/\n-  __ vpsrlq(TMP, P0L, 44, Assembler::AVX_512bit);\n-  __ evpandq(A0, P0L, ExternalAddress(poly1305_mask44()), Assembler::AVX_512bit, rscratch); \/\/ Clear top 20 bits\n-\n-  __ vpsllq(P0H, P0H, 8, Assembler::AVX_512bit);\n-  __ vpaddq(P0H, P0H, TMP, Assembler::AVX_512bit);\n-  __ vpaddq(P1L, P1L, P0H, Assembler::AVX_512bit);\n-  __ evpandq(A1, P1L, ExternalAddress(poly1305_mask44()), Assembler::AVX_512bit, rscratch); \/\/ Clear top 20 bits\n-\n-  __ vpsrlq(TMP, P1L, 44, Assembler::AVX_512bit);\n-  __ vpsllq(P1H, P1H, 8, Assembler::AVX_512bit);\n-  __ vpaddq(P1H, P1H, TMP, Assembler::AVX_512bit);\n-  __ vpaddq(P2L, P2L, P1H, Assembler::AVX_512bit);\n-  __ evpandq(A2, P2L, ExternalAddress(poly1305_mask42()), Assembler::AVX_512bit, rscratch); \/\/ Clear top 22 bits\n-\n-  __ vpsrlq(TMP, P2L, 42, Assembler::AVX_512bit);\n-  __ vpsllq(P2H, P2H, 10, Assembler::AVX_512bit);\n-  __ vpaddq(P2H, P2H, TMP, Assembler::AVX_512bit);\n-\n-  \/\/ Reduction: p2->a0->a1\n-  \/\/ Multiply by 5 the highest bits (p2 is above 130 bits)\n-  __ vpaddq(A0, A0, P2H, Assembler::AVX_512bit);\n-  __ vpsllq(P2H, P2H, 2, Assembler::AVX_512bit);\n-  __ vpaddq(A0, A0, P2H, Assembler::AVX_512bit);\n-  __ vpsrlq(TMP, A0, 44, Assembler::AVX_512bit);\n-  __ evpandq(A0, A0, ExternalAddress(poly1305_mask44()), Assembler::AVX_512bit, rscratch);\n-  __ vpaddq(A1, A1, TMP, Assembler::AVX_512bit);\n-}\n-\n-\/\/ Compute product for a single 16-byte message blocks\n-\/\/ - Assumes that r = [r1 r0] is only 128 bits (not 130)\n-\/\/ - Input [a2 a1 a0]; when only128 is set, input is 128 bits (i.e. a2==0)\n-\/\/ - Output [a2 a1 a0] is at least 130 bits (i.e. a2 is used regardless of only128)\n-\/\/\n-\/\/ Note 1: a2 here is only two bits so anything above is subject of reduction.\n-\/\/ Note 2: Constant c1 = 5xr1 = r1 + (r1 << 2) simplifies multiply with less operations\n-\/\/\n-\/\/ Flow of the code below is as follows:\n-\/\/\n-\/\/          a2        a1        a0\n-\/\/        x           r1        r0\n-\/\/   -----------------------------\n-\/\/       a2×r0     a1×r0     a0×r0\n-\/\/   +             a0×r1\n-\/\/   +           5xa2xr1   5xa1xr1\n-\/\/   -----------------------------\n-\/\/     [0|L2L] [L1H|L1L] [L0H|L0L]\n-\/\/\n-\/\/   Registers:  t2:t1     t0:a0\n-\/\/\n-\/\/ Completing the multiply and adding (with carry) 3x128-bit limbs into\n-\/\/ 192-bits again (3x64-bits):\n-\/\/ a0 = L0L\n-\/\/ a1 = L0H + L1L\n-\/\/ t2 = L1H + L2L\n-void StubGenerator::poly1305_multiply_scalar(\n-  const Register a0, const Register a1, const Register a2,\n-  const Register r0, const Register r1, const Register c1, bool only128,\n-  const Register t0, const Register t1, const Register t2,\n-  const Register mulql, const Register mulqh)\n-{\n-  \/\/ mulq instruction requires\/clobers rax, rdx (mulql, mulqh)\n-\n-  \/\/ t2:t1 = (a0 * r1)\n-  __ movq(rax, r1);\n-  __ mulq(a0);\n-  __ movq(t1, rax);\n-  __ movq(t2, rdx);\n-\n-  \/\/ t0:a0 = (a0 * r0)\n-  __ movq(rax, r0);\n-  __ mulq(a0);\n-  __ movq(a0, rax); \/\/ a0 not used in other operations\n-  __ movq(t0, rdx);\n-\n-  \/\/ t2:t1 += (a1 * r0)\n-  __ movq(rax, r0);\n-  __ mulq(a1);\n-  __ addq(t1, rax);\n-  __ adcq(t2, rdx);\n-\n-  \/\/ t0:a0 += (a1 * r1x5)\n-  __ movq(rax, c1);\n-  __ mulq(a1);\n-  __ addq(a0, rax);\n-  __ adcq(t0, rdx);\n-\n-  \/\/ Note: a2 is clamped to 2-bits,\n-  \/\/       r1\/r0 is clamped to 60-bits,\n-  \/\/       their product is less than 2^64.\n-\n-  if (only128) { \/\/ Accumulator only 128 bits, i.e. a2 == 0\n-    \/\/ just move and add t0-t1 to a1\n-    __ movq(a1, t0);\n-    __ addq(a1, t1);\n-    __ adcq(t2, 0);\n-  } else {\n-    \/\/ t2:t1 += (a2 * r1x5)\n-    __ movq(a1, a2); \/\/ use a1 for a2\n-    __ imulq(a1, c1);\n-    __ addq(t1, a1);\n-    __ adcq(t2, 0);\n-\n-    __ movq(a1, t0); \/\/ t0:a0 => a1:a0\n-\n-    \/\/ t2:a1 += (a2 * r0):t1\n-    __ imulq(a2, r0);\n-    __ addq(a1, t1);\n-    __ adcq(t2, a2);\n-  }\n-\n-  \/\/ At this point, 3 64-bit limbs are in t2:a1:a0\n-  \/\/ t2 can span over more than 2 bits so final partial reduction step is needed.\n-  \/\/\n-  \/\/ Partial reduction (just to fit into 130 bits)\n-  \/\/    a2 = t2 & 3\n-  \/\/    k = (t2 & ~3) + (t2 >> 2)\n-  \/\/         Y    x4  +  Y    x1\n-  \/\/    a2:a1:a0 += k\n-  \/\/\n-  \/\/ Result will be in a2:a1:a0\n-  __ movq(t0, t2);\n-  __ movl(a2, t2); \/\/ DWORD\n-  __ andq(t0, ~3);\n-  __ shrq(t2, 2);\n-  __ addq(t0, t2);\n-  __ andl(a2, 3); \/\/ DWORD\n-\n-  \/\/ a2:a1:a0 += k (kept in t0)\n-  __ addq(a0, t0);\n-  __ adcq(a1, 0);\n-  __ adcl(a2, 0); \/\/ DWORD\n-}\n-\n-\/\/ Convert array of 128-bit numbers in quadwords (in D0:D1) into 128-bit numbers across 44-bit limbs (in L0:L1:L2)\n-\/\/ Optionally pad all the numbers (i.e. add 2^128)\n-\/\/\n-\/\/         +-------------------------+-------------------------+\n-\/\/  D0:D1  | h0 h1 g0 g1 f0 f1 e0 e1 | d0 d1 c0 c1 b0 b1 a0 a1 |\n-\/\/         +-------------------------+-------------------------+\n-\/\/         +-------------------------+\n-\/\/  L2     | h2 d2 g2 c2 f2 b2 e2 a2 |\n-\/\/         +-------------------------+\n-\/\/         +-------------------------+\n-\/\/  L1     | h1 d1 g1 c1 f1 b1 e1 a1 |\n-\/\/         +-------------------------+\n-\/\/         +-------------------------+\n-\/\/  L0     | h0 d0 g0 c0 f0 b0 e0 a0 |\n-\/\/         +-------------------------+\n-\/\/\n-void StubGenerator::poly1305_limbs_avx512(\n-    const XMMRegister D0, const XMMRegister D1,\n-    const XMMRegister L0, const XMMRegister L1, const XMMRegister L2, bool padMSG,\n-    const XMMRegister TMP, const Register rscratch)\n-{\n-  \/\/ Interleave blocks of data\n-  __ evpunpckhqdq(TMP, D0, D1, Assembler::AVX_512bit);\n-  __ evpunpcklqdq(L0, D0, D1, Assembler::AVX_512bit);\n-\n-  \/\/ Highest 42-bit limbs of new blocks\n-  __ vpsrlq(L2, TMP, 24, Assembler::AVX_512bit);\n-  if (padMSG) {\n-    __ evporq(L2, L2, ExternalAddress(poly1305_pad_msg()), Assembler::AVX_512bit, rscratch); \/\/ Add 2^128 to all 8 final qwords of the message\n-  }\n-\n-  \/\/ Middle 44-bit limbs of new blocks\n-  __ vpsrlq(L1, L0, 44, Assembler::AVX_512bit);\n-  __ vpsllq(TMP, TMP, 20, Assembler::AVX_512bit);\n-  __ vpternlogq(L1, 0xA8, TMP, ExternalAddress(poly1305_mask44()), Assembler::AVX_512bit, rscratch); \/\/ (A OR B AND C)\n-\n-  \/\/ Lowest 44-bit limbs of new blocks\n-  __ evpandq(L0, L0, ExternalAddress(poly1305_mask44()), Assembler::AVX_512bit, rscratch);\n-}\n-\n-\/**\n- * Copy 5×26-bit (unreduced) limbs stored at Register limbs into  a2:a1:a0 (3×64-bit limbs)\n- *\n- * a2 is optional. When only128 is set, limbs are expected to fit into 128-bits (i.e. a1:a0 such as clamped R)\n- *\/\n-void StubGenerator::poly1305_limbs(\n-    const Register limbs, const Register a0, const Register a1, const Register a2,\n-    const Register t0, const Register t1)\n-{\n-  __ movq(a0, Address(limbs, 0));\n-  __ movq(t0, Address(limbs, 8));\n-  __ shlq(t0, 26);\n-  __ addq(a0, t0);\n-  __ movq(t0, Address(limbs, 16));\n-  __ movq(t1, Address(limbs, 24));\n-  __ movq(a1, t0);\n-  __ shlq(t0, 52);\n-  __ shrq(a1, 12);\n-  __ shlq(t1, 14);\n-  __ addq(a0, t0);\n-  __ adcq(a1, t1);\n-  __ movq(t0, Address(limbs, 32));\n-  if (a2 != noreg) {\n-    __ movq(a2, t0);\n-    __ shrq(a2, 24);\n-  }\n-  __ shlq(t0, 40);\n-  __ addq(a1, t0);\n-  if (a2 != noreg) {\n-    __ adcq(a2, 0);\n-\n-    \/\/ One round of reduction\n-    \/\/ Take bits above 130 in a2, multiply by 5 and add to a2:a1:a0\n-    __ movq(t0, a2);\n-    __ andq(t0, ~3);\n-    __ andq(a2, 3);\n-    __ movq(t1, t0);\n-    __ shrq(t1, 2);\n-    __ addq(t0, t1);\n-\n-    __ addq(a0, t0);\n-    __ adcq(a1, 0);\n-    __ adcq(a2, 0);\n-  }\n-}\n-\n-\/**\n- * Break 3×64-bit a2:a1:a0 limbs into 5×26-bit limbs and store out into 5 quadwords at address `limbs`\n- *\/\n-void StubGenerator::poly1305_limbs_out(\n-    const Register a0, const Register a1, const Register a2,\n-    const Register limbs,\n-    const Register t0, const Register t1)\n-{\n-  \/\/ Extra round of reduction\n-  \/\/ Take bits above 130 in a2, multiply by 5 and add to a2:a1:a0\n-  __ movq(t0, a2);\n-  __ andq(t0, ~3);\n-  __ andq(a2, 3);\n-  __ movq(t1, t0);\n-  __ shrq(t1, 2);\n-  __ addq(t0, t1);\n-\n-  __ addq(a0, t0);\n-  __ adcq(a1, 0);\n-  __ adcq(a2, 0);\n-\n-  \/\/ Chop a2:a1:a0 into 26-bit limbs\n-  __ movl(t0, a0);\n-  __ andl(t0, 0x3ffffff);\n-  __ movq(Address(limbs, 0), t0);\n-\n-  __ shrq(a0, 26);\n-  __ movl(t0, a0);\n-  __ andl(t0, 0x3ffffff);\n-  __ movq(Address(limbs, 8), t0);\n-\n-  __ shrq(a0, 26); \/\/ 12 bits left in a0, concatenate 14 from a1\n-  __ movl(t0, a1);\n-  __ shll(t0, 12);\n-  __ addl(t0, a0);\n-  __ andl(t0, 0x3ffffff);\n-  __ movq(Address(limbs, 16), t0);\n-\n-  __ shrq(a1, 14); \/\/ already used up 14 bits\n-  __ shlq(a2, 50); \/\/ a2 contains 2 bits when reduced, but $Element.limbs dont have to be fully reduced\n-  __ addq(a1, a2); \/\/ put remaining bits into a1\n-\n-  __ movl(t0, a1);\n-  __ andl(t0, 0x3ffffff);\n-  __ movq(Address(limbs, 24), t0);\n-\n-  __ shrq(a1, 26);\n-  __ movl(t0, a1);\n-  \/\/andl(t0, 0x3ffffff); doesnt have to be fully reduced, leave remaining bit(s)\n-  __ movq(Address(limbs, 32), t0);\n-}\n-\n-\/\/ This function consumes as many whole 16*16-byte blocks as available in input\n-\/\/ After execution, input and length will point at remaining (unprocessed) data\n-\/\/ and [a2 a1 a0] will contain the current accumulator value\n-\/\/\n-\/\/ Math Note:\n-\/\/    Main loop in this function multiplies each message block by r^16; And some glue before and after..\n-\/\/    Proof (for brevity, split into 4 'rows' instead of 16):\n-\/\/\n-\/\/     hash = ((((m1*r + m2)*r + m3)*r ...  mn)*r\n-\/\/          = m1*r^n + m2*r^(n-1) + ... +mn_1*r^2 + mn*r  \/\/ Horner's rule\n-\/\/\n-\/\/          = m1*r^n     + m4*r^(n-4) + m8*r^(n-8) ...    \/\/ split into 4 groups for brevity, same applies to 16 blocks\n-\/\/          + m2*r^(n-1) + m5*r^(n-5) + m9*r^(n-9) ...\n-\/\/          + m3*r^(n-2) + m6*r^(n-6) + m10*r^(n-10) ...\n-\/\/          + m4*r^(n-3) + m7*r^(n-7) + m11*r^(n-11) ...\n-\/\/\n-\/\/          = r^4 * (m1*r^(n-4) + m4*r^(n-8) + m8 *r^(n-16) ... + mn_3)   \/\/ factor out r^4..r; same applies to 16 but r^16..r factors\n-\/\/          + r^3 * (m2*r^(n-4) + m5*r^(n-8) + m9 *r^(n-16) ... + mn_2)\n-\/\/          + r^2 * (m3*r^(n-4) + m6*r^(n-8) + m10*r^(n-16) ... + mn_1)\n-\/\/          + r^1 * (m4*r^(n-4) + m7*r^(n-8) + m11*r^(n-16) ... + mn_0)   \/\/ Note last column: message group has no multiplier\n-\/\/\n-\/\/          = (((m1*r^4 + m4)*r^4 + m8 )*r^4 ... + mn_3) * r^4   \/\/ reverse Horner's rule, for each group\n-\/\/          + (((m2*r^4 + m5)*r^4 + m9 )*r^4 ... + mn_2) * r^3   \/\/ each column is multiplied by r^4, except last\n-\/\/          + (((m3*r^4 + m6)*r^4 + m10)*r^4 ... + mn_1) * r^2\n-\/\/          + (((m4*r^4 + m7)*r^4 + m11)*r^4 ... + mn_0) * r^1\n-\/\/\n-\/\/ Also see M. Goll and S. Gueron, \"Vectorization of Poly1305 Message Authentication Code\"\n-\/\/\n-\/\/ Pseudocode:\n-\/\/  * used for poly1305_multiply_scalar\n-\/\/  × used for poly1305_multiply8_avx512\n-\/\/  lower-case variables are scalar numbers in 3×44-bit limbs (in gprs)\n-\/\/  upper-case variables are 8&16-element vector numbers in 3×44-bit limbs (in zmm registers)\n-\/\/\n-\/\/    CL = a       \/\/ [0 0 0 0 0 0 0 a]\n-\/\/    AL = poly1305_limbs_avx512(input)\n-\/\/    AH = poly1305_limbs_avx512(input+8)\n-\/\/    AL = AL + C\n-\/\/    input+=16, length-=16\n-\/\/\n-\/\/    a = r\n-\/\/    a = a*r\n-\/\/  r^2 = a\n-\/\/    a = a*r\n-\/\/  r^3 = a\n-\/\/    r = a*r\n-\/\/  r^4 = a\n-\/\/\n-\/\/    T  = r^4 || r^3 || r^2 || r\n-\/\/    B  = limbs(T)           \/\/ [r^4  0  r^3  0  r^2  0  r^1  0 ]\n-\/\/    CL = B >> 1             \/\/ [ 0  r^4  0  r^3  0  r^2  0  r^1]\n-\/\/    R  = r^4 || r^4 || ..   \/\/ [r^4 r^4 r^4 r^4 r^4 r^4 r^4 r^4]\n-\/\/    B  = B×R                \/\/ [r^8  0  r^7  0  r^6  0  r^5  0 ]\n-\/\/    B  = B | CL             \/\/ [r^8 r^4 r^7 r^3 r^6 r^2 r^5 r^1]\n-\/\/    CL = B\n-\/\/    R  = r^8 || r^8 || ..   \/\/ [r^8 r^8 r^8 r^8 r^8 r^8 r^8 r^8]\n-\/\/    B  = B × R              \/\/ [r^16 r^12 r^15 r^11 r^14 r^10 r^13 r^9]\n-\/\/    CH = B\n-\/\/    R = r^16 || r^16 || ..  \/\/ [r^16 r^16 r^16 r^16 r^16 r^16 r^16 r^16]\n-\/\/\n-\/\/ for (;length>=16; input+=16, length-=16)\n-\/\/     BL = poly1305_limbs_avx512(input)\n-\/\/     BH = poly1305_limbs_avx512(input+8)\n-\/\/     AL = AL × R\n-\/\/     AH = AH × R\n-\/\/     AL = AL + BL\n-\/\/     AH = AH + BH\n-\/\/\n-\/\/  AL = AL × CL\n-\/\/  AH = AH × CH\n-\/\/  A = AL + AH \/\/ 16->8 blocks\n-\/\/  T = A >> 4  \/\/ 8 ->4 blocks\n-\/\/  A = A + T\n-\/\/  T = A >> 2  \/\/ 4 ->2 blocks\n-\/\/  A = A + T\n-\/\/  T = A >> 1  \/\/ 2 ->1 blocks\n-\/\/  A = A + T\n-\/\/  a = A\n-\/\/\n-\/\/ Register Map:\n-\/\/ GPRs:\n-\/\/   input        = rdi\n-\/\/   length       = rbx\n-\/\/   accumulator  = rcx\n-\/\/   R   = r8\n-\/\/   a0  = rsi\n-\/\/   a1  = r9\n-\/\/   a2  = r10\n-\/\/   r0  = r11\n-\/\/   r1  = r12\n-\/\/   c1  = r8;\n-\/\/   t0  = r13\n-\/\/   t1  = r14\n-\/\/   t2  = r15\n-\/\/   rscratch = r13\n-\/\/   stack(rsp, rbp)\n-\/\/   mulq(rax, rdx) in poly1305_multiply_scalar\n-\/\/\n-\/\/ ZMMs:\n-\/\/   D: xmm0-1\n-\/\/   TMP: xmm2\n-\/\/   T: xmm3-8\n-\/\/   A: xmm9-14\n-\/\/   B: xmm15-20\n-\/\/   C: xmm21-26\n-\/\/   R: xmm27-31\n-void StubGenerator::poly1305_process_blocks_avx512(\n-    const Register input, const Register length,\n-    const Register a0, const Register a1, const Register a2,\n-    const Register r0, const Register r1, const Register c1)\n-{\n-  Label L_process256Loop, L_process256LoopDone;\n-  const Register t0 = r13;\n-  const Register t1 = r14;\n-  const Register t2 = r15;\n-  const Register rscratch = r13;\n-  const Register mulql = rax;\n-  const Register mulqh = rdx;\n-\n-  const XMMRegister D0 = xmm0;\n-  const XMMRegister D1 = xmm1;\n-  const XMMRegister TMP = xmm2;\n-\n-  const XMMRegister T0 = xmm3;\n-  const XMMRegister T1 = xmm4;\n-  const XMMRegister T2 = xmm5;\n-  const XMMRegister T3 = xmm6;\n-  const XMMRegister T4 = xmm7;\n-  const XMMRegister T5 = xmm8;\n-\n-  const XMMRegister A0 = xmm9;\n-  const XMMRegister A1 = xmm10;\n-  const XMMRegister A2 = xmm11;\n-  const XMMRegister A3 = xmm12;\n-  const XMMRegister A4 = xmm13;\n-  const XMMRegister A5 = xmm14;\n-\n-  const XMMRegister B0 = xmm15;\n-  const XMMRegister B1 = xmm16;\n-  const XMMRegister B2 = xmm17;\n-  const XMMRegister B3 = xmm18;\n-  const XMMRegister B4 = xmm19;\n-  const XMMRegister B5 = xmm20;\n-\n-  const XMMRegister C0 = xmm21;\n-  const XMMRegister C1 = xmm22;\n-  const XMMRegister C2 = xmm23;\n-  const XMMRegister C3 = xmm24;\n-  const XMMRegister C4 = xmm25;\n-  const XMMRegister C5 = xmm26;\n-\n-  const XMMRegister R0 = xmm27;\n-  const XMMRegister R1 = xmm28;\n-  const XMMRegister R2 = xmm29;\n-  const XMMRegister R1P = xmm30;\n-  const XMMRegister R2P = xmm31;\n-\n-  \/\/ Spread accumulator into 44-bit limbs in quadwords C0,C1,C2\n-  __ movq(t0, a0);\n-  __ andq(t0, ExternalAddress(poly1305_mask44()), rscratch); \/\/ First limb (Acc[43:0])\n-  __ movq(C0, t0);\n-\n-  __ movq(t0, a1);\n-  __ shrdq(a0, t0, 44);\n-  __ andq(a0, ExternalAddress(poly1305_mask44()), rscratch); \/\/ Second limb (Acc[77:52])\n-  __ movq(C1, a0);\n-\n-  __ shrdq(a1, a2, 24);\n-  __ andq(a1, ExternalAddress(poly1305_mask42()), rscratch); \/\/ Third limb (Acc[129:88])\n-  __ movq(C2, a1);\n-\n-  \/\/ To add accumulator, we must unroll first loop iteration\n-\n-  \/\/ Load first block of data (128 bytes) and pad\n-  \/\/ A0 to have bits 0-43 of all 8 blocks in 8 qwords\n-  \/\/ A1 to have bits 87-44 of all 8 blocks in 8 qwords\n-  \/\/ A2 to have bits 127-88 of all 8 blocks in 8 qwords\n-  __ evmovdquq(D0, Address(input, 0), Assembler::AVX_512bit);\n-  __ evmovdquq(D1, Address(input, 64), Assembler::AVX_512bit);\n-  poly1305_limbs_avx512(D0, D1, A0, A1, A2, true, TMP, rscratch);\n-\n-  \/\/ Add accumulator to the fist message block\n-  __ vpaddq(A0, A0, C0, Assembler::AVX_512bit);\n-  __ vpaddq(A1, A1, C1, Assembler::AVX_512bit);\n-  __ vpaddq(A2, A2, C2, Assembler::AVX_512bit);\n-\n-  \/\/ Load next blocks of data (128 bytes)  and pad\n-  \/\/ A3 to have bits 0-43 of all 8 blocks in 8 qwords\n-  \/\/ A4 to have bits 87-44 of all 8 blocks in 8 qwords\n-  \/\/ A5 to have bits 127-88 of all 8 blocks in 8 qwords\n-  __ evmovdquq(D0, Address(input, 64*2), Assembler::AVX_512bit);\n-  __ evmovdquq(D1, Address(input, 64*3), Assembler::AVX_512bit);\n-  poly1305_limbs_avx512(D0, D1, A3, A4, A5, true, TMP, rscratch);\n-\n-  __ subl(length, 16*16);\n-  __ lea(input, Address(input,16*16));\n-\n-  \/\/ Compute the powers of R^1..R^4 and form 44-bit limbs of each\n-  \/\/ T0 to have bits 0-127 in 4 quadword pairs\n-  \/\/ T1 to have bits 128-129 in alternating 8 qwords\n-  __ vpxorq(T1, T1, T1, Assembler::AVX_512bit);\n-  __ movq(T2, r0);\n-  __ vpinsrq(T2, T2, r1, 1);\n-  __ vinserti32x4(T0, T0, T2, 3);\n-\n-  \/\/ Calculate R^2\n-  __ movq(a0, r0);\n-  __ movq(a1, r1);\n-  \/\/ \"Clever\": a2 not set because poly1305_multiply_scalar has a flag to indicate 128-bit accumulator\n-  poly1305_multiply_scalar(a0, a1, a2,\n-                           r0, r1, c1, true,\n-                           t0, t1, t2, mulql, mulqh);\n-\n-  __ movq(T2, a0);\n-  __ vpinsrq(T2, T2, a1, 1);\n-  __ vinserti32x4(T0, T0, T2, 2);\n-  __ movq(T2, a2);\n-  __ vinserti32x4(T1, T1, T2, 2);\n-\n-  \/\/ Calculate R^3\n-  poly1305_multiply_scalar(a0, a1, a2,\n-                           r0, r1, c1, false,\n-                           t0, t1, t2, mulql, mulqh);\n-\n-  __ movq(T2, a0);\n-  __ vpinsrq(T2, T2, a1, 1);\n-  __ vinserti32x4(T0, T0, T2, 1);\n-  __ movq(T2, a2);\n-  __ vinserti32x4(T1, T1, T2, 1);\n-\n-  \/\/ Calculate R^4\n-  poly1305_multiply_scalar(a0, a1, a2,\n-                           r0, r1, c1, false,\n-                           t0, t1, t2, mulql, mulqh);\n-\n-  __ movq(T2, a0);\n-  __ vpinsrq(T2, T2, a1, 1);\n-  __ vinserti32x4(T0, T0, T2, 0);\n-  __ movq(T2, a2);\n-  __ vinserti32x4(T1, T1, T2, 0);\n-\n-  \/\/ Interleave the powers of R^1..R^4 to form 44-bit limbs (half-empty)\n-  \/\/ B0 to have bits 0-43 of all 4 blocks in alternating 8 qwords\n-  \/\/ B1 to have bits 87-44 of all 4 blocks in alternating 8 qwords\n-  \/\/ B2 to have bits 127-88 of all 4 blocks in alternating 8 qwords\n-  __ vpxorq(T2, T2, T2, Assembler::AVX_512bit);\n-  poly1305_limbs_avx512(T0, T2, B0, B1, B2, false, TMP, rscratch);\n-\n-  \/\/ T1 contains the 2 highest bits of the powers of R\n-  __ vpsllq(T1, T1, 40, Assembler::AVX_512bit);\n-  __ evporq(B2, B2, T1, Assembler::AVX_512bit);\n-\n-  \/\/ Broadcast 44-bit limbs of R^4 into R0,R1,R2\n-  __ mov(t0, a0);\n-  __ andq(t0, ExternalAddress(poly1305_mask44()), rscratch); \/\/ First limb (R^4[43:0])\n-  __ evpbroadcastq(R0, t0, Assembler::AVX_512bit);\n-\n-  __ movq(t0, a1);\n-  __ shrdq(a0, t0, 44);\n-  __ andq(a0, ExternalAddress(poly1305_mask44()), rscratch); \/\/ Second limb (R^4[87:44])\n-  __ evpbroadcastq(R1, a0, Assembler::AVX_512bit);\n-\n-  __ shrdq(a1, a2, 24);\n-  __ andq(a1, ExternalAddress(poly1305_mask42()), rscratch); \/\/ Third limb (R^4[129:88])\n-  __ evpbroadcastq(R2, a1, Assembler::AVX_512bit);\n-\n-  \/\/ Generate 4*5*R^4 into {R2P,R1P}\n-  \/\/ Used as multiplier in poly1305_multiply8_avx512 so can\n-  \/\/ ignore bottom limb and carry propagation\n-  __ vpsllq(R1P, R1, 2, Assembler::AVX_512bit);    \/\/ 4*R^4\n-  __ vpsllq(R2P, R2, 2, Assembler::AVX_512bit);\n-  __ vpaddq(R1P, R1P, R1, Assembler::AVX_512bit);  \/\/ 5*R^4\n-  __ vpaddq(R2P, R2P, R2, Assembler::AVX_512bit);\n-  __ vpsllq(R1P, R1P, 2, Assembler::AVX_512bit);   \/\/ 4*5*R^4\n-  __ vpsllq(R2P, R2P, 2, Assembler::AVX_512bit);\n-\n-  \/\/ Move R^4..R^1 one element over\n-  __ vpslldq(C0, B0, 8, Assembler::AVX_512bit);\n-  __ vpslldq(C1, B1, 8, Assembler::AVX_512bit);\n-  __ vpslldq(C2, B2, 8, Assembler::AVX_512bit);\n-\n-  \/\/ Calculate R^8-R^5\n-  poly1305_multiply8_avx512(B0, B1, B2,             \/\/ ACC=R^4..R^1\n-                            R0, R1, R2, R1P, R2P,   \/\/ R^4..R^4, 4*5*R^4\n-                            T0, T1, T2, T3, T4, T5, TMP, rscratch);\n-\n-  \/\/ Interleave powers of R: R^8 R^4 R^7 R^3 R^6 R^2 R^5 R\n-  __ evporq(B0, B0, C0, Assembler::AVX_512bit);\n-  __ evporq(B1, B1, C1, Assembler::AVX_512bit);\n-  __ evporq(B2, B2, C2, Assembler::AVX_512bit);\n-\n-  \/\/ Store R^8-R for later use\n-  __ evmovdquq(C0, B0, Assembler::AVX_512bit);\n-  __ evmovdquq(C1, B1, Assembler::AVX_512bit);\n-  __ evmovdquq(C2, B2, Assembler::AVX_512bit);\n-\n-  \/\/ Broadcast R^8\n-  __ vpbroadcastq(R0, B0, Assembler::AVX_512bit);\n-  __ vpbroadcastq(R1, B1, Assembler::AVX_512bit);\n-  __ vpbroadcastq(R2, B2, Assembler::AVX_512bit);\n-\n-  \/\/ Generate 4*5*R^8\n-  __ vpsllq(R1P, R1, 2, Assembler::AVX_512bit);\n-  __ vpsllq(R2P, R2, 2, Assembler::AVX_512bit);\n-  __ vpaddq(R1P, R1P, R1, Assembler::AVX_512bit);    \/\/ 5*R^8\n-  __ vpaddq(R2P, R2P, R2, Assembler::AVX_512bit);\n-  __ vpsllq(R1P, R1P, 2, Assembler::AVX_512bit);     \/\/ 4*5*R^8\n-  __ vpsllq(R2P, R2P, 2, Assembler::AVX_512bit);\n-\n-  \/\/ Calculate R^16-R^9\n-  poly1305_multiply8_avx512(B0, B1, B2,            \/\/ ACC=R^8..R^1\n-                            R0, R1, R2, R1P, R2P,  \/\/ R^8..R^8, 4*5*R^8\n-                            T0, T1, T2, T3, T4, T5, TMP, rscratch);\n-\n-  \/\/ Store R^16-R^9 for later use\n-  __ evmovdquq(C3, B0, Assembler::AVX_512bit);\n-  __ evmovdquq(C4, B1, Assembler::AVX_512bit);\n-  __ evmovdquq(C5, B2, Assembler::AVX_512bit);\n-\n-  \/\/ Broadcast R^16\n-  __ vpbroadcastq(R0, B0, Assembler::AVX_512bit);\n-  __ vpbroadcastq(R1, B1, Assembler::AVX_512bit);\n-  __ vpbroadcastq(R2, B2, Assembler::AVX_512bit);\n-\n-  \/\/ Generate 4*5*R^16\n-  __ vpsllq(R1P, R1, 2, Assembler::AVX_512bit);\n-  __ vpsllq(R2P, R2, 2, Assembler::AVX_512bit);\n-  __ vpaddq(R1P, R1P, R1, Assembler::AVX_512bit);  \/\/ 5*R^16\n-  __ vpaddq(R2P, R2P, R2, Assembler::AVX_512bit);\n-  __ vpsllq(R1P, R1P, 2, Assembler::AVX_512bit);   \/\/ 4*5*R^16\n-  __ vpsllq(R2P, R2P, 2, Assembler::AVX_512bit);\n-\n-  \/\/ VECTOR LOOP: process 16 * 16-byte message block at a time\n-  __ bind(L_process256Loop);\n-  __ cmpl(length, 16*16);\n-  __ jcc(Assembler::less, L_process256LoopDone);\n-\n-  \/\/ Load and interleave next block of data (128 bytes)\n-  __ evmovdquq(D0, Address(input, 0), Assembler::AVX_512bit);\n-  __ evmovdquq(D1, Address(input, 64), Assembler::AVX_512bit);\n-  poly1305_limbs_avx512(D0, D1, B0, B1, B2, true, TMP, rscratch);\n-\n-  \/\/ Load and interleave next block of data (128 bytes)\n-  __ evmovdquq(D0, Address(input, 64*2), Assembler::AVX_512bit);\n-  __ evmovdquq(D1, Address(input, 64*3), Assembler::AVX_512bit);\n-  poly1305_limbs_avx512(D0, D1, B3, B4, B5, true, TMP, rscratch);\n-\n-  poly1305_multiply8_avx512(A0, A1, A2,            \/\/ MSG\/ACC 16 blocks\n-                            R0, R1, R2, R1P, R2P,  \/\/ R^16..R^16, 4*5*R^16\n-                            T0, T1, T2, T3, T4, T5, TMP, rscratch);\n-  poly1305_multiply8_avx512(A3, A4, A5,            \/\/ MSG\/ACC 16 blocks\n-                            R0, R1, R2, R1P, R2P,  \/\/ R^16..R^16, 4*5*R^16\n-                            T0, T1, T2, T3, T4, T5, TMP, rscratch);\n-\n-  __ vpaddq(A0, A0, B0, Assembler::AVX_512bit); \/\/ Add low 42-bit bits from new blocks to accumulator\n-  __ vpaddq(A1, A1, B1, Assembler::AVX_512bit); \/\/ Add medium 42-bit bits from new blocks to accumulator\n-  __ vpaddq(A2, A2, B2, Assembler::AVX_512bit); \/\/ Add highest bits from new blocks to accumulator\n-  __ vpaddq(A3, A3, B3, Assembler::AVX_512bit); \/\/ Add low 42-bit bits from new blocks to accumulator\n-  __ vpaddq(A4, A4, B4, Assembler::AVX_512bit); \/\/ Add medium 42-bit bits from new blocks to accumulator\n-  __ vpaddq(A5, A5, B5, Assembler::AVX_512bit); \/\/ Add highest bits from new blocks to accumulator\n-\n-  __ subl(length, 16*16);\n-  __ lea(input, Address(input,16*16));\n-  __ jmp(L_process256Loop);\n-\n-  __ bind(L_process256LoopDone);\n-\n-  \/\/ Tail processing: Need to multiply ACC by R^16..R^1 and add it all up into a single scalar value\n-  \/\/ Generate 4*5*[R^16..R^9] (ignore lowest limb)\n-  \/\/ Use D0 ~ R1P, D1 ~ R2P for higher powers\n-  __ vpsllq(R1P, C4, 2, Assembler::AVX_512bit);\n-  __ vpsllq(R2P, C5, 2, Assembler::AVX_512bit);\n-  __ vpaddq(R1P, R1P, C4, Assembler::AVX_512bit);    \/\/ 5*R^8\n-  __ vpaddq(R2P, R2P, C5, Assembler::AVX_512bit);\n-  __ vpsllq(D0, R1P, 2, Assembler::AVX_512bit);      \/\/ 4*5*R^8\n-  __ vpsllq(D1, R2P, 2, Assembler::AVX_512bit);\n-\n-  \/\/ Generate 4*5*[R^8..R^1] (ignore lowest limb)\n-  __ vpsllq(R1P, C1, 2, Assembler::AVX_512bit);\n-  __ vpsllq(R2P, C2, 2, Assembler::AVX_512bit);\n-  __ vpaddq(R1P, R1P, C1, Assembler::AVX_512bit);    \/\/ 5*R^8\n-  __ vpaddq(R2P, R2P, C2, Assembler::AVX_512bit);\n-  __ vpsllq(R1P, R1P, 2, Assembler::AVX_512bit);     \/\/ 4*5*R^8\n-  __ vpsllq(R2P, R2P, 2, Assembler::AVX_512bit);\n-\n-  poly1305_multiply8_avx512(A0, A1, A2,            \/\/ MSG\/ACC 16 blocks\n-                            C3, C4, C5, D0, D1,    \/\/ R^16-R^9, R1P, R2P\n-                            T0, T1, T2, T3, T4, T5, TMP, rscratch);\n-  poly1305_multiply8_avx512(A3, A4, A5,            \/\/ MSG\/ACC 16 blocks\n-                            C0, C1, C2, R1P, R2P,  \/\/ R^8-R, R1P, R2P\n-                            T0, T1, T2, T3, T4, T5, TMP, rscratch);\n-\n-  \/\/ Add all blocks (horizontally)\n-  \/\/ 16->8 blocks\n-  __ vpaddq(A0, A0, A3, Assembler::AVX_512bit);\n-  __ vpaddq(A1, A1, A4, Assembler::AVX_512bit);\n-  __ vpaddq(A2, A2, A5, Assembler::AVX_512bit);\n-\n-  \/\/ 8 -> 4 blocks\n-  __ vextracti64x4(T0, A0, 1);\n-  __ vextracti64x4(T1, A1, 1);\n-  __ vextracti64x4(T2, A2, 1);\n-  __ vpaddq(A0, A0, T0, Assembler::AVX_256bit);\n-  __ vpaddq(A1, A1, T1, Assembler::AVX_256bit);\n-  __ vpaddq(A2, A2, T2, Assembler::AVX_256bit);\n-\n-  \/\/ 4 -> 2 blocks\n-  __ vextracti32x4(T0, A0, 1);\n-  __ vextracti32x4(T1, A1, 1);\n-  __ vextracti32x4(T2, A2, 1);\n-  __ vpaddq(A0, A0, T0, Assembler::AVX_128bit);\n-  __ vpaddq(A1, A1, T1, Assembler::AVX_128bit);\n-  __ vpaddq(A2, A2, T2, Assembler::AVX_128bit);\n-\n-  \/\/ 2 -> 1 blocks\n-  __ vpsrldq(T0, A0, 8, Assembler::AVX_128bit);\n-  __ vpsrldq(T1, A1, 8, Assembler::AVX_128bit);\n-  __ vpsrldq(T2, A2, 8, Assembler::AVX_128bit);\n-\n-  \/\/ Finish folding and clear second qword\n-  __ mov64(t0, 0xfd);\n-  __ kmovql(k1, t0);\n-  __ evpaddq(A0, k1, A0, T0, false, Assembler::AVX_512bit);\n-  __ evpaddq(A1, k1, A1, T1, false, Assembler::AVX_512bit);\n-  __ evpaddq(A2, k1, A2, T2, false, Assembler::AVX_512bit);\n-\n-  \/\/ Carry propagation\n-  __ vpsrlq(D0, A0, 44, Assembler::AVX_512bit);\n-  __ evpandq(A0, A0, ExternalAddress(poly1305_mask44()), Assembler::AVX_512bit, rscratch); \/\/ Clear top 20 bits\n-  __ vpaddq(A1, A1, D0, Assembler::AVX_512bit);\n-  __ vpsrlq(D0, A1, 44, Assembler::AVX_512bit);\n-  __ evpandq(A1, A1, ExternalAddress(poly1305_mask44()), Assembler::AVX_512bit, rscratch); \/\/ Clear top 20 bits\n-  __ vpaddq(A2, A2, D0, Assembler::AVX_512bit);\n-  __ vpsrlq(D0, A2, 42, Assembler::AVX_512bit);\n-  __ evpandq(A2, A2, ExternalAddress(poly1305_mask42()), Assembler::AVX_512bit, rscratch); \/\/ Clear top 22 bits\n-  __ vpsllq(D1, D0, 2, Assembler::AVX_512bit);\n-  __ vpaddq(D0, D0, D1, Assembler::AVX_512bit);\n-  __ vpaddq(A0, A0, D0, Assembler::AVX_512bit);\n-\n-  \/\/ Put together A (accumulator)\n-  __ movq(a0, A0);\n-\n-  __ movq(t0, A1);\n-  __ movq(t1, t0);\n-  __ shlq(t1, 44);\n-  __ shrq(t0, 20);\n-\n-  __ movq(a2, A2);\n-  __ movq(a1, a2);\n-  __ shlq(a1, 24);\n-  __ shrq(a2, 40);\n-\n-  __ addq(a0, t1);\n-  __ adcq(a1, t0);\n-  __ adcq(a2, 0);\n-\n-  \/\/ Cleanup\n-  \/\/ Zero out zmm0-zmm31.\n-  __ vzeroall();\n-  for (XMMRegister rxmm = xmm16; rxmm->is_valid(); rxmm = rxmm->successor()) {\n-    __ vpxorq(rxmm, rxmm, rxmm, Assembler::AVX_512bit);\n-  }\n-}\n-\n-\/\/ This function consumes as many whole 16-byte blocks as available in input\n-\/\/ After execution, input and length will point at remaining (unprocessed) data\n-\/\/ and accumulator will point to the current accumulator value\n-address StubGenerator::generate_poly1305_processBlocks() {\n-  __ align(CodeEntryAlignment);\n-  StubCodeMark mark(this, \"StubRoutines\", \"poly1305_processBlocks\");\n-  address start = __ pc();\n-  __ enter();\n-\n-  \/\/ Save all 'SOE' registers\n-  __ push(rbx);\n-  #ifdef _WIN64\n-  __ push(rsi);\n-  __ push(rdi);\n-  #endif\n-  __ push(r12);\n-  __ push(r13);\n-  __ push(r14);\n-  __ push(r15);\n-\n-  \/\/ Register Map\n-  const Register input        = rdi;\n-  const Register length       = rbx;\n-  const Register accumulator  = rcx;\n-  const Register R            = r8;\n-\n-  const Register a0 = rsi;  \/\/ [in\/out] accumulator bits 63..0\n-  const Register a1 = r9;   \/\/ [in\/out] accumulator bits 127..64\n-  const Register a2 = r10;  \/\/ [in\/out] accumulator bits 195..128\n-  const Register r0 = r11;  \/\/ R constant bits 63..0\n-  const Register r1 = r12;  \/\/ R constant bits 127..64\n-  const Register c1 = r8;   \/\/ 5*R (upper limb only)\n-  const Register t0 = r13;\n-  const Register t1 = r14;\n-  const Register t2 = r15;\n-  const Register mulql = rax;\n-  const Register mulqh = rdx;\n-\n-  \/\/ Normalize input\n-  \/\/ pseudo-signature: void poly1305_processBlocks(byte[] input, int length, int[5] accumulator, int[5] R)\n-  \/\/ input, a, r pointers point at first array element\n-  \/\/ java headers bypassed in LibraryCallKit::inline_poly1305_processBlocks\n-  #ifdef _WIN64\n-  \/\/ c_rarg0 - rcx\n-  \/\/ c_rarg1 - rdx\n-  \/\/ c_rarg2 - r8\n-  \/\/ c_rarg3 - r9\n-  __ mov(input, c_rarg0);\n-  __ mov(length, c_rarg1);\n-  __ mov(accumulator, c_rarg2);\n-  __ mov(R, c_rarg3);\n-  #else\n-  \/\/ c_rarg0 - rdi\n-  \/\/ c_rarg1 - rsi\n-  \/\/ c_rarg2 - rdx\n-  \/\/ c_rarg3 - rcx\n-  \/\/ dont clobber R, args copied out-of-order\n-  __ mov(length, c_rarg1);\n-  __ mov(R, c_rarg3);\n-  __ mov(accumulator, c_rarg2);\n-  #endif\n-\n-  Label L_process16Loop, L_process16LoopDone;\n-\n-  \/\/ Load R into r1:r0\n-  poly1305_limbs(R, r0, r1, noreg, t0, t1);\n-\n-  \/\/ Compute 5*R (Upper limb only)\n-  __ movq(c1, r1);\n-  __ shrq(c1, 2);\n-  __ addq(c1, r1); \/\/ c1 = r1 + (r1 >> 2)\n-\n-  \/\/ Load accumulator into a2:a1:a0\n-  poly1305_limbs(accumulator, a0, a1, a2, t0, t1);\n-\n-  \/\/ VECTOR LOOP: Minimum of 256 bytes to run vectorized code\n-  __ cmpl(length, 16*16);\n-  __ jcc(Assembler::less, L_process16Loop);\n-\n-  poly1305_process_blocks_avx512(input, length,\n-                                  a0, a1, a2,\n-                                  r0, r1, c1);\n-\n-  \/\/ SCALAR LOOP: process one 16-byte message block at a time\n-  __ bind(L_process16Loop);\n-  __ cmpl(length, 16);\n-  __ jcc(Assembler::less, L_process16LoopDone);\n-\n-  __ addq(a0, Address(input,0));\n-  __ adcq(a1, Address(input,8));\n-  __ adcq(a2,1);\n-  poly1305_multiply_scalar(a0, a1, a2,\n-                           r0, r1, c1, false,\n-                           t0, t1, t2, mulql, mulqh);\n-\n-  __ subl(length, 16);\n-  __ lea(input, Address(input,16));\n-  __ jmp(L_process16Loop);\n-  __ bind(L_process16LoopDone);\n-\n-  \/\/ Write output\n-  poly1305_limbs_out(a0, a1, a2, accumulator, t0, t1);\n-\n-  __ pop(r15);\n-  __ pop(r14);\n-  __ pop(r13);\n-  __ pop(r12);\n-  #ifdef _WIN64\n-  __ pop(rdi);\n-  __ pop(rsi);\n-  #endif\n-  __ pop(rbx);\n-\n-  __ leave();\n-  __ ret(0);\n-  return start;\n-}\n","filename":"src\/hotspot\/cpu\/x86\/stubGenerator_x86_64_poly.cpp","additions":0,"deletions":1027,"binary":false,"changes":1027,"status":"deleted"},{"patch":"@@ -36,1 +36,1 @@\n-  code_size2 = 35300 LP64_ONLY(+45000) WINDOWS_ONLY(+2048) \/\/ simply increase if too small (assembler will crash if too small)\n+  code_size2 = 35300 LP64_ONLY(+35000) WINDOWS_ONLY(+2048) \/\/ simply increase if too small (assembler will crash if too small)\n","filename":"src\/hotspot\/cpu\/x86\/stubRoutines_x86.hpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -353,1 +353,1 @@\n-void TemplateTable::ldc(LdcType type) {\n+void TemplateTable::ldc(bool wide) {\n@@ -358,1 +358,1 @@\n-  if (is_ldc_wide(type)) {\n+  if (wide) {\n@@ -386,1 +386,1 @@\n-  __ movl(rarg, is_ldc_wide(type) ? 1 : 0);\n+  __ movl(rarg, wide);\n@@ -418,1 +418,1 @@\n-void TemplateTable::fast_aldc(LdcType type) {\n+void TemplateTable::fast_aldc(bool wide) {\n@@ -424,1 +424,1 @@\n-  int index_size = is_ldc_wide(type) ? sizeof(u2) : sizeof(u1);\n+  int index_size = wide ? sizeof(u2) : sizeof(u1);\n","filename":"src\/hotspot\/cpu\/x86\/templateTable_x86.cpp","additions":5,"deletions":5,"binary":false,"changes":10,"status":"modified"},{"patch":"@@ -26,0 +26,1 @@\n+#include \"jvm.h\"\n@@ -30,1 +31,0 @@\n-#include \"jvm.h\"\n@@ -857,0 +857,3 @@\n+  \/\/ If the OS doesn't support SSE, we can't use this feature even if the HW does\n+  if (!os::supports_sse())\n+    _features &= ~(CPU_SSE|CPU_SSE2|CPU_SSE3|CPU_SSSE3|CPU_SSE4A|CPU_SSE4_1|CPU_SSE4_2);\n@@ -950,1 +953,0 @@\n-    _features &= ~CPU_AVX512_IFMA;\n@@ -982,1 +984,0 @@\n-      _features &= ~CPU_AVX512_IFMA;\n@@ -1335,12 +1336,0 @@\n-#ifdef _LP64\n-  if (supports_avx512ifma() && supports_avx512vlbw() && MaxVectorSize >= 64) {\n-    if (FLAG_IS_DEFAULT(UsePolyIntrinsics)) {\n-      FLAG_SET_DEFAULT(UsePolyIntrinsics, true);\n-    }\n-  } else\n-#endif\n-  if (UsePolyIntrinsics) {\n-    warning(\"Intrinsics for Poly1305 crypto hash functions not available on this CPU.\");\n-    FLAG_SET_DEFAULT(UsePolyIntrinsics, false);\n-  }\n-\n@@ -2911,2 +2900,0 @@\n-      if (_cpuid_info.sef_cpuid7_ebx.bits.avx512ifma != 0)\n-        result |= CPU_AVX512_IFMA;\n","filename":"src\/hotspot\/cpu\/x86\/vm_version_x86.cpp","additions":4,"deletions":17,"binary":false,"changes":21,"status":"modified"},{"patch":"@@ -226,3 +226,1 @@\n-                        : 1,\n-             avx512ifma : 1,\n-                        : 1,\n+                        : 3,\n@@ -392,2 +390,1 @@\n-    decl(CET_SS,            \"cet_ss\",            57) \/* Control Flow Enforcement - Shadow Stack *\/ \\\n-    decl(AVX512_IFMA,       \"avx512_ifma\",       58) \/* Integer Vector FMA instructions*\/\n+    decl(CET_SS,            \"cet_ss\",            57) \/* Control Flow Enforcement - Shadow Stack *\/\n@@ -673,1 +670,0 @@\n-  static bool supports_avx512ifma()   { return (_features & CPU_AVX512_IFMA) != 0; }\n","filename":"src\/hotspot\/cpu\/x86\/vm_version_x86.hpp","additions":2,"deletions":6,"binary":false,"changes":8,"status":"modified"},{"patch":"@@ -37,0 +37,1 @@\n+\n","filename":"src\/hotspot\/cpu\/zero\/sharedRuntime_zero.cpp","additions":1,"deletions":0,"binary":false,"changes":1,"status":"modified"},{"patch":"@@ -31,0 +31,1 @@\n+#include \"jvm.h\"\n@@ -36,1 +37,0 @@\n-#include \"jvm.h\"\n@@ -38,0 +38,2 @@\n+#include \"logging\/log.hpp\"\n+#include \"logging\/logStream.hpp\"\n@@ -42,2 +44,0 @@\n-#include \"logging\/log.hpp\"\n-#include \"logging\/logStream.hpp\"\n","filename":"src\/hotspot\/os\/aix\/os_aix.cpp","additions":3,"deletions":3,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -55,4 +55,0 @@\n-\/\/ stubbed-out trim-native support\n-inline bool os::can_trim_native_heap() { return false; }\n-inline bool os::trim_native_heap(os::size_change_t* rss_change) { return false; }\n-\n","filename":"src\/hotspot\/os\/aix\/os_aix.inline.hpp","additions":0,"deletions":4,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -28,1 +28,0 @@\n-#include \"decoder_machO.hpp\"\n@@ -30,0 +29,1 @@\n+#include \"decoder_machO.hpp\"\n","filename":"src\/hotspot\/os\/bsd\/decoder_machO.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -26,0 +26,1 @@\n+#include \"jvm.h\"\n@@ -32,1 +33,0 @@\n-#include \"jvm.h\"\n@@ -2171,0 +2171,22 @@\n+  int fd;\n+\n+  fd = ::open(path, oflag, mode);\n+  if (fd == -1) return -1;\n+\n+  \/\/ If the open succeeded, the file might still be a directory\n+  {\n+    struct stat buf;\n+    int ret = ::fstat(fd, &buf);\n+    int st_mode = buf.st_mode;\n+\n+    if (ret != -1) {\n+      if ((st_mode & S_IFMT) == S_IFDIR) {\n+        errno = EISDIR;\n+        ::close(fd);\n+        return -1;\n+      }\n+    } else {\n+      ::close(fd);\n+      return -1;\n+    }\n+  }\n@@ -2193,5 +2215,1 @@\n-\n-  int fd = ::open(path, oflag | O_CLOEXEC, mode);\n-  if (fd == -1) return -1;\n-\n-  \/\/ If the open succeeded, the file might still be a directory\n+#ifdef FD_CLOEXEC\n@@ -2199,13 +2217,3 @@\n-    struct stat buf;\n-    int ret = ::fstat(fd, &buf);\n-    int st_mode = buf.st_mode;\n-\n-    if (ret != -1) {\n-      if ((st_mode & S_IFMT) == S_IFDIR) {\n-        errno = EISDIR;\n-        ::close(fd);\n-        return -1;\n-      }\n-    } else {\n-      ::close(fd);\n-      return -1;\n+    int flags = ::fcntl(fd, F_GETFD);\n+    if (flags != -1) {\n+      ::fcntl(fd, F_SETFD, flags | FD_CLOEXEC);\n@@ -2214,0 +2222,1 @@\n+#endif\n","filename":"src\/hotspot\/os\/bsd\/os_bsd.cpp","additions":28,"deletions":19,"binary":false,"changes":47,"status":"modified"},{"patch":"@@ -58,4 +58,0 @@\n-\/\/ stubbed-out trim-native support\n-inline bool os::can_trim_native_heap() { return false; }\n-inline bool os::trim_native_heap(os::size_change_t* rss_change) { return false; }\n-\n","filename":"src\/hotspot\/os\/bsd\/os_bsd.inline.hpp","additions":0,"deletions":4,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -27,0 +27,1 @@\n+#include \"jvm.h\"\n@@ -33,1 +34,0 @@\n-#include \"jvm.h\"\n@@ -48,1 +48,0 @@\n-#include \"runtime\/init.hpp\"\n@@ -50,0 +49,1 @@\n+#include \"runtime\/init.hpp\"\n@@ -172,31 +172,2 @@\n-\/\/ We want to be buildable and runnable on older and newer glibcs, so resolve both\n-\/\/ mallinfo and mallinfo2 dynamically.\n-struct old_mallinfo {\n-  int arena;\n-  int ordblks;\n-  int smblks;\n-  int hblks;\n-  int hblkhd;\n-  int usmblks;\n-  int fsmblks;\n-  int uordblks;\n-  int fordblks;\n-  int keepcost;\n-};\n-typedef struct old_mallinfo (*mallinfo_func_t)(void);\n-static mallinfo_func_t g_mallinfo = NULL;\n-\n-struct new_mallinfo {\n-  size_t arena;\n-  size_t ordblks;\n-  size_t smblks;\n-  size_t hblks;\n-  size_t hblkhd;\n-  size_t usmblks;\n-  size_t fsmblks;\n-  size_t uordblks;\n-  size_t fordblks;\n-  size_t keepcost;\n-};\n-typedef struct new_mallinfo (*mallinfo2_func_t)(void);\n-static mallinfo2_func_t g_mallinfo2 = NULL;\n+os::Linux::mallinfo_func_t os::Linux::_mallinfo = NULL;\n+os::Linux::mallinfo2_func_t os::Linux::_mallinfo2 = NULL;\n@@ -2134,11 +2105,20 @@\n-  glibc_mallinfo mi;\n-  os::Linux::get_mallinfo(&mi, &might_have_wrapped);\n-  total_allocated = mi.uordblks + mi.hblkhd;\n-  free_retained = mi.fordblks;\n-#ifdef _LP64\n-  \/\/ If legacy mallinfo(), we can still print the values if we are sure they cannot have wrapped.\n-  might_have_wrapped = might_have_wrapped && (info.vmsize * K) > UINT_MAX;\n-#endif\n-  st->print_cr(\"C-Heap outstanding allocations: \" SIZE_FORMAT \"K, retained: \" SIZE_FORMAT \"K%s\",\n-               total_allocated \/ K, free_retained \/ K,\n-               might_have_wrapped ? \" (may have wrapped)\" : \"\");\n+  if (_mallinfo2 != NULL) {\n+    struct glibc_mallinfo2 mi = _mallinfo2();\n+    total_allocated = mi.uordblks + mi.hblkhd;\n+    free_retained = mi.fordblks;\n+  } else if (_mallinfo != NULL) {\n+    \/\/ mallinfo is an old API. Member names mean next to nothing and, beyond that, are 32-bit signed.\n+    \/\/ So for larger footprints the values may have wrapped around. We try to detect this here: if the\n+    \/\/ process whole resident set size is smaller than 4G, malloc footprint has to be less than that\n+    \/\/ and the numbers are reliable.\n+    struct glibc_mallinfo mi = _mallinfo();\n+    total_allocated = (size_t)(unsigned)mi.uordblks + (size_t)(unsigned)mi.hblkhd;\n+    free_retained = (size_t)(unsigned)mi.fordblks;\n+    \/\/ Since mallinfo members are int, glibc values may have wrapped. Warn about this.\n+    might_have_wrapped = (info.vmrss * K) > UINT_MAX && (info.vmrss * K) > (total_allocated + UINT_MAX);\n+  }\n+  if (_mallinfo2 != NULL || _mallinfo != NULL) {\n+    st->print_cr(\"C-Heap outstanding allocations: \" SIZE_FORMAT \"K, retained: \" SIZE_FORMAT \"K%s\",\n+                 total_allocated \/ K, free_retained \/ K,\n+                 might_have_wrapped ? \" (may have wrapped)\" : \"\");\n+  }\n@@ -4296,2 +4276,2 @@\n-  g_mallinfo = CAST_TO_FN_PTR(mallinfo_func_t, dlsym(RTLD_DEFAULT, \"mallinfo\"));\n-  g_mallinfo2 = CAST_TO_FN_PTR(mallinfo2_func_t, dlsym(RTLD_DEFAULT, \"mallinfo2\"));\n+  Linux::_mallinfo = CAST_TO_FN_PTR(Linux::mallinfo_func_t, dlsym(RTLD_DEFAULT, \"mallinfo\"));\n+  Linux::_mallinfo2 = CAST_TO_FN_PTR(Linux::mallinfo2_func_t, dlsym(RTLD_DEFAULT, \"mallinfo2\"));\n@@ -5354,65 +5334,0 @@\n-\n-#ifdef __GLIBC__\n-void os::Linux::get_mallinfo(glibc_mallinfo* out, bool* might_have_wrapped) {\n-  if (g_mallinfo2) {\n-    new_mallinfo mi = g_mallinfo2();\n-    out->arena = mi.arena;\n-    out->ordblks = mi.ordblks;\n-    out->smblks = mi.smblks;\n-    out->hblks = mi.hblks;\n-    out->hblkhd = mi.hblkhd;\n-    out->usmblks = mi.usmblks;\n-    out->fsmblks = mi.fsmblks;\n-    out->uordblks = mi.uordblks;\n-    out->fordblks = mi.fordblks;\n-    out->keepcost =  mi.keepcost;\n-    *might_have_wrapped = false;\n-  } else if (g_mallinfo) {\n-    old_mallinfo mi = g_mallinfo();\n-    \/\/ glibc reports unsigned 32-bit sizes in int form. First make unsigned, then extend.\n-    out->arena = (size_t)(unsigned)mi.arena;\n-    out->ordblks = (size_t)(unsigned)mi.ordblks;\n-    out->smblks = (size_t)(unsigned)mi.smblks;\n-    out->hblks = (size_t)(unsigned)mi.hblks;\n-    out->hblkhd = (size_t)(unsigned)mi.hblkhd;\n-    out->usmblks = (size_t)(unsigned)mi.usmblks;\n-    out->fsmblks = (size_t)(unsigned)mi.fsmblks;\n-    out->uordblks = (size_t)(unsigned)mi.uordblks;\n-    out->fordblks = (size_t)(unsigned)mi.fordblks;\n-    out->keepcost = (size_t)(unsigned)mi.keepcost;\n-    *might_have_wrapped = NOT_LP64(false) LP64_ONLY(true);\n-  } else {\n-    \/\/ We should have either mallinfo or mallinfo2\n-    ShouldNotReachHere();\n-  }\n-}\n-#endif \/\/ __GLIBC__\n-\n-bool os::trim_native_heap(os::size_change_t* rss_change) {\n-#ifdef __GLIBC__\n-  os::Linux::meminfo_t info1;\n-  os::Linux::meminfo_t info2;\n-\n-  bool have_info1 = rss_change != nullptr &&\n-                    os::Linux::query_process_memory_info(&info1);\n-  ::malloc_trim(0);\n-  bool have_info2 = rss_change != nullptr && have_info1 &&\n-                    os::Linux::query_process_memory_info(&info2);\n-  ssize_t delta = (ssize_t) -1;\n-  if (rss_change != nullptr) {\n-    if (have_info1 && have_info2 &&\n-        info1.vmrss != -1 && info2.vmrss != -1 &&\n-        info1.vmswap != -1 && info2.vmswap != -1) {\n-      \/\/ Note: query_process_memory_info returns values in K\n-      rss_change->before = (info1.vmrss + info1.vmswap) * K;\n-      rss_change->after = (info2.vmrss + info2.vmswap) * K;\n-    } else {\n-      rss_change->after = rss_change->before = SIZE_MAX;\n-    }\n-  }\n-\n-  return true;\n-#else\n-  return false; \/\/ musl\n-#endif\n-}\n","filename":"src\/hotspot\/os\/linux\/os_linux.cpp","additions":26,"deletions":111,"binary":false,"changes":137,"status":"modified"},{"patch":"@@ -175,1 +175,1 @@\n-  \/\/ Output structure for query_process_memory_info() (all values in KB)\n+  \/\/ Output structure for query_process_memory_info()\n@@ -268,0 +268,34 @@\n+#ifdef __GLIBC__\n+  struct glibc_mallinfo {\n+    int arena;\n+    int ordblks;\n+    int smblks;\n+    int hblks;\n+    int hblkhd;\n+    int usmblks;\n+    int fsmblks;\n+    int uordblks;\n+    int fordblks;\n+    int keepcost;\n+  };\n+\n+  struct glibc_mallinfo2 {\n+    size_t arena;\n+    size_t ordblks;\n+    size_t smblks;\n+    size_t hblks;\n+    size_t hblkhd;\n+    size_t usmblks;\n+    size_t fsmblks;\n+    size_t uordblks;\n+    size_t fordblks;\n+    size_t keepcost;\n+  };\n+\n+  typedef struct glibc_mallinfo (*mallinfo_func_t)(void);\n+  typedef struct glibc_mallinfo2 (*mallinfo2_func_t)(void);\n+\n+  static mallinfo_func_t _mallinfo;\n+  static mallinfo2_func_t _mallinfo2;\n+#endif\n+\n@@ -395,33 +429,0 @@\n-\n-#ifdef __GLIBC__\n-  \/\/ os::Linux::get_mallinfo() hides the complexity of dealing with mallinfo() or\n-  \/\/ mallinfo2() from the user. Use this function instead of raw mallinfo\/mallinfo2()\n-  \/\/ to keep the JVM runtime-compatible with different glibc versions.\n-  \/\/\n-  \/\/ mallinfo2() was added with glibc (>2.32). Legacy mallinfo() was deprecated with\n-  \/\/ 2.33 and may vanish in future glibcs. So we may have both or either one of\n-  \/\/ them.\n-  \/\/\n-  \/\/ mallinfo2() is functionally equivalent to legacy mallinfo but returns sizes as\n-  \/\/ 64-bit on 64-bit platforms. Legacy mallinfo uses 32-bit fields. However, legacy\n-  \/\/ mallinfo is still perfectly fine to use if we know the sizes cannot have wrapped.\n-  \/\/ For example, if the process virtual size does not exceed 4G, we cannot have\n-  \/\/ malloc'ed more than 4G, so the results from legacy mallinfo() can still be used.\n-  \/\/\n-  \/\/ os::Linux::get_mallinfo() will always prefer mallinfo2() if found, but will fall back\n-  \/\/ to legacy mallinfo() if only that is available. In that case, it will return true\n-  \/\/ in *might_have_wrapped.\n-  struct glibc_mallinfo {\n-    size_t arena;\n-    size_t ordblks;\n-    size_t smblks;\n-    size_t hblks;\n-    size_t hblkhd;\n-    size_t usmblks;\n-    size_t fsmblks;\n-    size_t uordblks;\n-    size_t fordblks;\n-    size_t keepcost;\n-  };\n-  static void get_mallinfo(glibc_mallinfo* out, bool* might_have_wrapped);\n-#endif \/\/ GLIBC\n","filename":"src\/hotspot\/os\/linux\/os_linux.hpp","additions":35,"deletions":34,"binary":false,"changes":69,"status":"modified"},{"patch":"@@ -50,9 +50,0 @@\n-\/\/ Trim-native support\n-inline bool os::can_trim_native_heap() {\n-#ifdef __GLIBC__\n-  return true;\n-#else\n-  return false; \/\/ musl\n-#endif\n-}\n-\n","filename":"src\/hotspot\/os\/linux\/os_linux.inline.hpp","additions":0,"deletions":9,"binary":false,"changes":9,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2022 SAP SE. All rights reserved.\n+ * Copyright (c) 2021 SAP SE. All rights reserved.\n@@ -27,2 +27,3 @@\n-#include \"runtime\/os.inline.hpp\"\n-#include \"trimCHeapDCmd.hpp\"\n+#include \"logging\/log.hpp\"\n+#include \"os_linux.hpp\"\n+#include \"runtime\/os.hpp\"\n@@ -30,1 +31,0 @@\n-#include \"utilities\/globalDefinitions.hpp\"\n@@ -32,0 +32,1 @@\n+#include \"trimCHeapDCmd.hpp\"\n@@ -36,12 +37,32 @@\n-  if (os::can_trim_native_heap()) {\n-    os::size_change_t sc;\n-    if (os::trim_native_heap(&sc)) {\n-      _output->print(\"Trim native heap: \");\n-      if (sc.after != SIZE_MAX) {\n-        const size_t delta = sc.after < sc.before ? (sc.before - sc.after) : (sc.after - sc.before);\n-        const char sign = sc.after < sc.before ? '-' : '+';\n-        _output->print_cr(\"RSS+Swap: \" PROPERFMT \"->\" PROPERFMT \" (%c\" PROPERFMT \")\",\n-                          PROPERFMTARGS(sc.before), PROPERFMTARGS(sc.after), sign, PROPERFMTARGS(delta));\n-      } else {\n-        _output->print_cr(\"(no details available).\");\n-      }\n+#ifdef __GLIBC__\n+  stringStream ss_report(1024); \/\/ Note: before calling trim\n+\n+  os::Linux::meminfo_t info1;\n+  os::Linux::meminfo_t info2;\n+  \/\/ Query memory before...\n+  bool have_info1 = os::Linux::query_process_memory_info(&info1);\n+\n+  _output->print_cr(\"Attempting trim...\");\n+  ::malloc_trim(0);\n+  _output->print_cr(\"Done.\");\n+\n+  \/\/ ...and after trim.\n+  bool have_info2 = os::Linux::query_process_memory_info(&info2);\n+\n+  \/\/ Print report both to output stream as well to UL\n+  bool wrote_something = false;\n+  if (have_info1 && have_info2) {\n+    if (info1.vmsize != -1 && info2.vmsize != -1) {\n+      ss_report.print_cr(\"Virtual size before: \" SSIZE_FORMAT \"k, after: \" SSIZE_FORMAT \"k, (\" SSIZE_FORMAT \"k)\",\n+                         info1.vmsize, info2.vmsize, (info2.vmsize - info1.vmsize));\n+      wrote_something = true;\n+    }\n+    if (info1.vmrss != -1 && info2.vmrss != -1) {\n+      ss_report.print_cr(\"RSS before: \" SSIZE_FORMAT \"k, after: \" SSIZE_FORMAT \"k, (\" SSIZE_FORMAT \"k)\",\n+                         info1.vmrss, info2.vmrss, (info2.vmrss - info1.vmrss));\n+      wrote_something = true;\n+    }\n+    if (info1.vmswap != -1 && info2.vmswap != -1) {\n+      ss_report.print_cr(\"Swap before: \" SSIZE_FORMAT \"k, after: \" SSIZE_FORMAT \"k, (\" SSIZE_FORMAT \"k)\",\n+                         info1.vmswap, info2.vmswap, (info2.vmswap - info1.vmswap));\n+      wrote_something = true;\n@@ -49,2 +70,0 @@\n-  } else {\n-    _output->print_cr(\"Not available.\");\n@@ -52,0 +71,9 @@\n+  if (!wrote_something) {\n+    ss_report.print_raw(\"No details available.\");\n+  }\n+\n+  _output->print_raw(ss_report.base());\n+  log_info(os)(\"malloc_trim:\\n%s\", ss_report.base());\n+#else\n+  _output->print_cr(\"Not available.\");\n+#endif\n","filename":"src\/hotspot\/os\/linux\/trimCHeapDCmd.cpp","additions":46,"deletions":18,"binary":false,"changes":64,"status":"modified"},{"patch":"@@ -25,1 +25,1 @@\n-#include \"classfile\/classLoader.hpp\"\n+\n@@ -27,0 +27,1 @@\n+#include \"classfile\/classLoader.hpp\"\n","filename":"src\/hotspot\/os\/posix\/os_posix.cpp","additions":2,"deletions":1,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -27,1 +27,0 @@\n-#include \"classfile\/vmSymbols.hpp\"\n@@ -29,0 +28,1 @@\n+#include \"classfile\/vmSymbols.hpp\"\n","filename":"src\/hotspot\/os\/posix\/perfMemory_posix.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -26,0 +26,2 @@\n+\n+#include \"jvm.h\"\n@@ -29,1 +31,0 @@\n-#include \"jvm.h\"\n","filename":"src\/hotspot\/os\/posix\/signals_posix.cpp","additions":2,"deletions":1,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -27,1 +27,0 @@\n-#include \"os_windows.hpp\"\n@@ -29,0 +28,1 @@\n+#include \"os_windows.hpp\"\n","filename":"src\/hotspot\/os\/windows\/jvm_windows.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -38,1 +38,0 @@\n-\n","filename":"src\/hotspot\/os\/windows\/os_perf_windows.cpp","additions":0,"deletions":1,"binary":false,"changes":1,"status":"modified"},{"patch":"@@ -28,0 +28,1 @@\n+#include \"jvm.h\"\n@@ -36,1 +37,0 @@\n-#include \"jvm.h\"\n@@ -73,1 +73,0 @@\n-#include \"symbolengine.hpp\"\n@@ -80,0 +79,1 @@\n+#include \"symbolengine.hpp\"\n","filename":"src\/hotspot\/os\/windows\/os_windows.cpp","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -101,4 +101,0 @@\n-\/\/ stubbed-out trim-native support\n-inline bool os::can_trim_native_heap() { return false; }\n-inline bool os::trim_native_heap(os::size_change_t* rss_change) { return false; }\n-\n","filename":"src\/hotspot\/os\/windows\/os_windows.inline.hpp","additions":0,"deletions":4,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -27,0 +27,1 @@\n+#include \"jvm.h\"\n@@ -34,1 +35,0 @@\n-#include \"jvm.h\"\n","filename":"src\/hotspot\/os_cpu\/aix_ppc\/os_aix_ppc.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -28,0 +28,1 @@\n+#include \"jvm.h\"\n@@ -35,1 +36,0 @@\n-#include \"jvm.h\"\n","filename":"src\/hotspot\/os_cpu\/bsd_aarch64\/os_bsd_aarch64.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -26,0 +26,1 @@\n+#include \"jvm.h\"\n@@ -32,1 +33,0 @@\n-#include \"jvm.h\"\n@@ -639,0 +639,7 @@\n+\n+\/\/ Check that the bsd kernel version is 2.4 or higher since earlier\n+\/\/ versions do not support SSE without patches.\n+bool os::supports_sse() {\n+  return true;\n+}\n+\n","filename":"src\/hotspot\/os_cpu\/bsd_x86\/os_bsd_x86.cpp","additions":8,"deletions":1,"binary":false,"changes":9,"status":"modified"},{"patch":"@@ -26,0 +26,5 @@\n+#if !defined(__APPLE__) && !defined(__NetBSD__)\n+#include <pthread.h>\n+# include <pthread_np.h> \/* For pthread_attr_get_np *\/\n+#endif\n+\n@@ -27,0 +32,1 @@\n+#include \"jvm.h\"\n@@ -33,1 +39,0 @@\n-#include \"jvm.h\"\n@@ -55,5 +60,0 @@\n-#if !defined(__APPLE__) && !defined(__NetBSD__)\n-#include <pthread.h>\n-# include <pthread_np.h> \/* For pthread_attr_get_np *\/\n-#endif\n-\n","filename":"src\/hotspot\/os_cpu\/bsd_zero\/os_bsd_zero.cpp","additions":6,"deletions":6,"binary":false,"changes":12,"status":"modified"},{"patch":"@@ -27,0 +27,1 @@\n+#include \"jvm.h\"\n@@ -34,1 +35,0 @@\n-#include \"jvm.h\"\n","filename":"src\/hotspot\/os_cpu\/linux_aarch64\/os_linux_aarch64.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -26,0 +26,1 @@\n+#include \"jvm.h\"\n@@ -31,1 +32,0 @@\n-#include \"jvm.h\"\n","filename":"src\/hotspot\/os_cpu\/linux_arm\/os_linux_arm.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -27,0 +27,1 @@\n+#include \"jvm.h\"\n@@ -34,1 +35,0 @@\n-#include \"jvm.h\"\n","filename":"src\/hotspot\/os_cpu\/linux_ppc\/os_linux_ppc.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -31,0 +31,1 @@\n+\n@@ -32,4 +33,0 @@\n-  if (interval >= 0 && UseZicbop) {\n-    \/\/ encoding for prefetch.r\n-    asm(\"ori zero, %0, 1\" : : \"r\"(intptr_t(loc)+interval));\n-  }\n@@ -39,4 +36,0 @@\n-  if (interval >= 0 && UseZicbop) {\n-    \/\/ encoding for prefetch.w\n-    asm(\"ori zero, %0, 3\" : : \"r\"(intptr_t(loc)+interval));\n-  }\n","filename":"src\/hotspot\/os_cpu\/linux_riscv\/prefetch_linux_riscv.inline.hpp","additions":1,"deletions":8,"binary":false,"changes":9,"status":"modified"},{"patch":"@@ -29,0 +29,1 @@\n+#include \"jvm.h\"\n@@ -36,1 +37,0 @@\n-#include \"jvm.h\"\n","filename":"src\/hotspot\/os_cpu\/linux_s390\/os_linux_s390.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -26,0 +26,1 @@\n+#include \"jvm.h\"\n@@ -32,1 +33,0 @@\n-#include \"jvm.h\"\n@@ -446,0 +446,18 @@\n+\/\/ Check that the linux kernel version is 2.4 or higher since earlier\n+\/\/ versions do not support SSE without patches.\n+bool os::supports_sse() {\n+#ifdef AMD64\n+  return true;\n+#else\n+  struct utsname uts;\n+  if( uname(&uts) != 0 ) return false; \/\/ uname fails?\n+  char *minor_string;\n+  int major = strtol(uts.release,&minor_string,10);\n+  int minor = strtol(minor_string+1,NULL,10);\n+  bool result = (major > 2 || (major==2 && minor >= 4));\n+  log_info(os)(\"OS version is %d.%d, which %s support SSE\/SSE2\",\n+               major,minor, result ? \"DOES\" : \"does NOT\");\n+  return result;\n+#endif \/\/ AMD64\n+}\n+\n","filename":"src\/hotspot\/os_cpu\/linux_x86\/os_linux_x86.cpp","additions":19,"deletions":1,"binary":false,"changes":20,"status":"modified"},{"patch":"@@ -27,0 +27,1 @@\n+#include \"jvm.h\"\n@@ -33,1 +34,0 @@\n-#include \"jvm.h\"\n","filename":"src\/hotspot\/os_cpu\/linux_zero\/os_linux_zero.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -27,0 +27,1 @@\n+#include \"jvm.h\"\n@@ -34,1 +35,0 @@\n-#include \"jvm.h\"\n@@ -55,0 +55,1 @@\n+\n@@ -277,0 +278,4 @@\n+bool os::supports_sse() {\n+  return true;\n+}\n+\n","filename":"src\/hotspot\/os_cpu\/windows_aarch64\/os_windows_aarch64.cpp","additions":6,"deletions":1,"binary":false,"changes":7,"status":"modified"},{"patch":"@@ -26,0 +26,1 @@\n+#include \"jvm.h\"\n@@ -31,1 +32,0 @@\n-#include \"jvm.h\"\n@@ -568,0 +568,4 @@\n+\n+bool os::supports_sse() {\n+  return true;\n+}\n","filename":"src\/hotspot\/os_cpu\/windows_x86\/os_windows_x86.cpp","additions":5,"deletions":1,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -26,0 +26,1 @@\n+#include \"jvm.h\"\n@@ -32,1 +33,0 @@\n-#include \"jvm.h\"\n","filename":"src\/hotspot\/share\/c1\/c1_CFGPrinter.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -31,2 +31,0 @@\n-#include \"memory\/memRegion.hpp\"\n-#include \"oops\/oopsHierarchy.hpp\"\n@@ -34,0 +32,2 @@\n+#include \"oops\/oopsHierarchy.hpp\"\n+#include \"memory\/memRegion.hpp\"\n","filename":"src\/hotspot\/share\/cds\/archiveHeapLoader.hpp","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -26,0 +26,2 @@\n+\n+#include \"cds.h\"\n@@ -29,1 +31,0 @@\n-#include \"include\/cds.h\"\n","filename":"src\/hotspot\/share\/cds\/cdsConstants.cpp","additions":2,"deletions":1,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -27,2 +27,0 @@\n-\n-#include \"classfile\/moduleEntry.hpp\"\n@@ -32,0 +30,1 @@\n+#include \"classfile\/moduleEntry.hpp\"\n","filename":"src\/hotspot\/share\/cds\/cdsProtectionDomain.hpp","additions":1,"deletions":2,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -26,0 +26,2 @@\n+#include \"jvm.h\"\n+#include \"jimage.hpp\"\n@@ -41,2 +43,0 @@\n-#include \"jimage.hpp\"\n-#include \"jvm.h\"\n","filename":"src\/hotspot\/share\/cds\/classListParser.cpp","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -30,1 +30,0 @@\n-\n","filename":"src\/hotspot\/share\/cds\/dumpTimeClassInfo.inline.hpp","additions":0,"deletions":1,"binary":false,"changes":1,"status":"modified"},{"patch":"@@ -26,0 +26,1 @@\n+#include \"jvm.h\"\n@@ -40,1 +41,0 @@\n-#include \"jvm.h\"\n","filename":"src\/hotspot\/share\/cds\/dynamicArchive.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -26,0 +26,1 @@\n+#include \"jvm.h\"\n@@ -44,1 +45,0 @@\n-#include \"jvm.h\"\n@@ -114,12 +114,0 @@\n-  fail_continue_impl(LogLevel::Info, msg, ap);\n-  va_end(ap);\n-}\n-\n-void FileMapInfo::fail_continue(LogLevelType level, const char *msg, ...) {\n-  va_list ap;\n-  va_start(ap, msg);\n-  fail_continue_impl(level, msg, ap);\n-  va_end(ap);\n-}\n-\n-void FileMapInfo::fail_continue_impl(LogLevelType level, const char *msg, va_list ap) {\n@@ -137,2 +125,5 @@\n-      LogMessage(cds) lm;\n-      lm.vwrite(level, msg, ap);\n+      if (log_is_enabled(Info, cds)) {\n+        LogStream ls(Log(cds)::info());\n+        ls.print(\"UseSharedSpaces: \");\n+        ls.vprint_cr(msg, ap);\n+      }\n@@ -141,0 +132,1 @@\n+  va_end(ap);\n@@ -1128,4 +1120,5 @@\n-      const char* mismatch_msg = \"shared class paths mismatch\";\n-      const char* hint_msg = log_is_enabled(Info, class, path) ?\n-          \"\" : \" (hint: enable -Xlog:class+path=info to diagnose the failure)\";\n-      fail_continue(LogLevel::Warning, \"%s%s\", mismatch_msg, hint_msg);\n+      const char* mismatch_msg = \"shared class paths mismatch (hint: enable -Xlog:class+path=info to diagnose the failure)\";\n+      fail_continue(\"%s\", mismatch_msg);\n+      if (!log_is_enabled(Info, cds) && !log_is_enabled(Info, class, path)) {\n+        log_warning(cds)(\"%s\", mismatch_msg);\n+      }\n","filename":"src\/hotspot\/share\/cds\/filemap.cpp","additions":12,"deletions":19,"binary":false,"changes":31,"status":"modified"},{"patch":"@@ -30,1 +30,0 @@\n-#include \"logging\/logLevel.hpp\"\n@@ -485,2 +484,0 @@\n-  static void fail_continue(LogLevelType level, const char *msg, ...) ATTRIBUTE_PRINTF(2, 3);\n-  static void fail_continue_impl(LogLevelType level, const char *msg, va_list ap) ATTRIBUTE_PRINTF(2, 0);\n","filename":"src\/hotspot\/share\/cds\/filemap.hpp","additions":0,"deletions":3,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -26,0 +26,1 @@\n+#include \"jvm_io.h\"\n@@ -55,1 +56,0 @@\n-#include \"jvm_io.h\"\n","filename":"src\/hotspot\/share\/cds\/metaspaceShared.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -29,2 +29,1 @@\n-#include \"ci\/ciUtilities.inline.hpp\"\n-#include \"memory\/universe.hpp\"\n+#include \"ci\/ciUtilities.hpp\"\n@@ -107,1 +106,0 @@\n-\n","filename":"src\/hotspot\/share\/ci\/ciArrayKlass.cpp","additions":1,"deletions":3,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -59,1 +59,0 @@\n-\n","filename":"src\/hotspot\/share\/ci\/ciArrayKlass.hpp","additions":0,"deletions":1,"binary":false,"changes":1,"status":"modified"},{"patch":"@@ -26,0 +26,1 @@\n+#include \"jvm.h\"\n@@ -54,1 +55,0 @@\n-#include \"jvm.h\"\n","filename":"src\/hotspot\/share\/ci\/ciEnv.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -28,1 +28,0 @@\n-#include \"ci\/ciClassList.hpp\"\n@@ -30,0 +29,1 @@\n+#include \"ci\/ciClassList.hpp\"\n","filename":"src\/hotspot\/share\/ci\/ciFlags.hpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -72,1 +72,0 @@\n-  _transitive_interfaces = NULL;\n@@ -733,25 +732,0 @@\n-GrowableArray<ciInstanceKlass*>* ciInstanceKlass::transitive_interfaces() const{\n-  if (_transitive_interfaces == NULL) {\n-    const_cast<ciInstanceKlass*>(this)->compute_transitive_interfaces();\n-  }\n-  return _transitive_interfaces;\n-}\n-\n-void ciInstanceKlass::compute_transitive_interfaces() {\n-  GUARDED_VM_ENTRY(\n-          InstanceKlass* ik = get_instanceKlass();\n-          Array<InstanceKlass*>* interfaces = ik->transitive_interfaces();\n-          Arena* arena = CURRENT_ENV->arena();\n-          int len = interfaces->length() + (is_interface() ? 1 : 0);\n-          GrowableArray<ciInstanceKlass*>* transitive_interfaces = new(arena)GrowableArray<ciInstanceKlass*>(arena, len,\n-                                                                                                             0, NULL);\n-          for (int i = 0; i < interfaces->length(); i++) {\n-            transitive_interfaces->append(CURRENT_ENV->get_instance_klass(interfaces->at(i)));\n-          }\n-          if (is_interface()) {\n-            transitive_interfaces->append(this);\n-          }\n-          _transitive_interfaces = transitive_interfaces;\n-  );\n-}\n-\n","filename":"src\/hotspot\/share\/ci\/ciInstanceKlass.cpp","additions":0,"deletions":26,"binary":false,"changes":26,"status":"modified"},{"patch":"@@ -79,1 +79,0 @@\n-  GrowableArray<ciInstanceKlass*>* _transitive_interfaces;\n@@ -83,1 +82,0 @@\n-  void compute_transitive_interfaces();\n@@ -297,1 +295,0 @@\n-  GrowableArray<ciInstanceKlass*>* transitive_interfaces() const;\n","filename":"src\/hotspot\/share\/ci\/ciInstanceKlass.hpp","additions":0,"deletions":3,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -170,1 +170,0 @@\n-        obj->as_instance_klass()->transitive_interfaces();\n","filename":"src\/hotspot\/share\/ci\/ciObjectFactory.cpp","additions":0,"deletions":1,"binary":false,"changes":1,"status":"modified"},{"patch":"@@ -26,0 +26,1 @@\n+#include \"jvm.h\"\n@@ -38,1 +39,0 @@\n-#include \"jvm.h\"\n","filename":"src\/hotspot\/share\/ci\/ciReplay.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -25,0 +25,1 @@\n+#include \"jvm.h\"\n@@ -41,1 +42,0 @@\n-#include \"jvm.h\"\n@@ -86,0 +86,1 @@\n+\n","filename":"src\/hotspot\/share\/classfile\/classFileParser.cpp","additions":2,"deletions":1,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -26,0 +26,2 @@\n+#include \"jvm.h\"\n+#include \"jimage.hpp\"\n@@ -46,2 +48,0 @@\n-#include \"jimage.hpp\"\n-#include \"jvm.h\"\n@@ -258,1 +258,1 @@\n-      u1* buffer = NEW_RESOURCE_ARRAY_IN_THREAD(current, u1, st.st_size);\n+      u1* buffer = NEW_RESOURCE_ARRAY(u1, st.st_size);\n@@ -267,5 +267,1 @@\n-#ifdef ASSERT\n-        \/\/ Freeing path is a no-op here as buffer prevents it from being reclaimed. But we keep it for\n-        \/\/ debug builds so that we guard against use-after-free bugs.\n-        FREE_RESOURCE_ARRAY_IN_THREAD(current, char, path, path_len);\n-#endif\n+        FREE_RESOURCE_ARRAY(char, path, path_len);\n@@ -280,1 +276,1 @@\n-  FREE_RESOURCE_ARRAY_IN_THREAD(current, char, path, path_len);\n+  FREE_RESOURCE_ARRAY(char, path, path_len);\n","filename":"src\/hotspot\/share\/classfile\/classLoader.cpp","additions":5,"deletions":9,"binary":false,"changes":14,"status":"modified"},{"patch":"@@ -975,2 +975,0 @@\n-    case _claim_stw_fullgc_mark:            out->print_cr(\"stw full gc mark\"); break;\n-    case _claim_stw_fullgc_adjust:          out->print_cr(\"stw full gc adjust\"); break;\n","filename":"src\/hotspot\/share\/classfile\/classLoaderData.cpp","additions":0,"deletions":2,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -205,6 +205,4 @@\n-    _claim_none              = 0,\n-    _claim_finalizable       = 2,\n-    _claim_strong            = 3,\n-    _claim_stw_fullgc_mark   = 4,\n-    _claim_stw_fullgc_adjust = 8,\n-    _claim_other             = 16\n+    _claim_none         = 0,\n+    _claim_finalizable  = 2,\n+    _claim_strong       = 3,\n+    _claim_other        = 4\n","filename":"src\/hotspot\/share\/classfile\/classLoaderData.hpp","additions":4,"deletions":6,"binary":false,"changes":10,"status":"modified"},{"patch":"@@ -26,0 +26,1 @@\n+#include \"jvm.h\"\n@@ -30,1 +31,0 @@\n-#include \"jvm.h\"\n@@ -37,1 +37,0 @@\n-\n","filename":"src\/hotspot\/share\/classfile\/compactHashtable.cpp","additions":1,"deletions":2,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -26,0 +26,1 @@\n+#include \"jvm.h\"\n@@ -28,1 +29,0 @@\n-#include \"jvm.h\"\n","filename":"src\/hotspot\/share\/classfile\/fieldLayoutBuilder.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -26,0 +26,1 @@\n+#include \"jvm.h\"\n@@ -47,1 +48,0 @@\n-#include \"jvm.h\"\n@@ -1998,0 +1998,4 @@\n+int java_lang_ThreadGroup::_ngroups_offset;\n+int java_lang_ThreadGroup::_groups_offset;\n+int java_lang_ThreadGroup::_nweaks_offset;\n+int java_lang_ThreadGroup::_weaks_offset;\n@@ -2025,0 +2029,22 @@\n+int java_lang_ThreadGroup::ngroups(oop java_thread_group) {\n+  assert(oopDesc::is_oop(java_thread_group), \"thread group must be oop\");\n+  return java_thread_group->int_field(_ngroups_offset);\n+}\n+\n+objArrayOop java_lang_ThreadGroup::groups(oop java_thread_group) {\n+  oop groups = java_thread_group->obj_field(_groups_offset);\n+  assert(groups == NULL || groups->is_objArray(), \"just checking\"); \/\/ Todo: Add better type checking code\n+  return objArrayOop(groups);\n+}\n+\n+int java_lang_ThreadGroup::nweaks(oop java_thread_group) {\n+  assert(oopDesc::is_oop(java_thread_group), \"thread group must be oop\");\n+  return java_thread_group->int_field(_nweaks_offset);\n+}\n+\n+objArrayOop java_lang_ThreadGroup::weaks(oop java_thread_group) {\n+  oop weaks = java_thread_group->obj_field(_weaks_offset);\n+  assert(weaks == NULL || weaks->is_objArray(), \"just checking\");\n+  return objArrayOop(weaks);\n+}\n+\n@@ -2029,1 +2055,5 @@\n-  macro(_daemon_offset,      k, vmSymbols::daemon_name(),      bool_signature,                false);\n+  macro(_daemon_offset,      k, vmSymbols::daemon_name(),      bool_signature,                false); \\\n+  macro(_ngroups_offset,     k, vmSymbols::ngroups_name(),     int_signature,                 false); \\\n+  macro(_groups_offset,      k, vmSymbols::groups_name(),      threadgroup_array_signature,   false); \\\n+  macro(_nweaks_offset,      k, vmSymbols::nweaks_name(),      int_signature,                 false); \\\n+  macro(_weaks_offset,       k, vmSymbols::weaks_name(),       weakreference_array_signature, false);\n","filename":"src\/hotspot\/share\/classfile\/javaClasses.cpp","additions":32,"deletions":2,"binary":false,"changes":34,"status":"modified"},{"patch":"@@ -482,0 +482,5 @@\n+  static int _ngroups_offset;\n+  static int _groups_offset;\n+  static int _nweaks_offset;\n+  static int _weaks_offset;\n+\n@@ -483,0 +488,1 @@\n+\n@@ -495,0 +501,9 @@\n+  \/\/ Number of strongly reachable thread groups\n+  static int ngroups(oop java_thread_group);\n+  \/\/ Strongly reachable thread groups\n+  static objArrayOop groups(oop java_thread_group);\n+  \/\/ Number of weakly reachable thread groups\n+  static int nweaks(oop java_thread_group);\n+  \/\/ Weakly reachable thread groups\n+  static objArrayOop weaks(oop java_thread_group);\n+\n","filename":"src\/hotspot\/share\/classfile\/javaClasses.hpp","additions":15,"deletions":0,"binary":false,"changes":15,"status":"modified"},{"patch":"@@ -26,0 +26,1 @@\n+#include \"jni.h\"\n@@ -34,1 +35,0 @@\n-#include \"jni.h\"\n","filename":"src\/hotspot\/share\/classfile\/moduleEntry.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -26,0 +26,1 @@\n+#include \"jvm.h\"\n@@ -42,1 +43,0 @@\n-#include \"jvm.h\"\n","filename":"src\/hotspot\/share\/classfile\/modules.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -26,0 +26,1 @@\n+#include \"jvm.h\"\n@@ -51,1 +52,0 @@\n-#include \"jvm.h\"\n","filename":"src\/hotspot\/share\/classfile\/systemDictionary.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -26,0 +26,1 @@\n+#include \"jvm.h\"\n@@ -39,1 +40,0 @@\n-#include \"jvm.h\"\n","filename":"src\/hotspot\/share\/classfile\/verifier.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -26,0 +26,2 @@\n+#include \"jvm_constants.h\"\n+#include \"jvm_io.h\"\n@@ -29,2 +31,0 @@\n-#include \"jvm_constants.h\"\n-#include \"jvm_io.h\"\n@@ -482,3 +482,0 @@\n-  case vmIntrinsics::_poly1305_processBlocks:\n-    if (!UsePolyIntrinsics) return true;\n-    break;\n","filename":"src\/hotspot\/share\/classfile\/vmIntrinsics.cpp","additions":2,"deletions":5,"binary":false,"changes":7,"status":"modified"},{"patch":"@@ -522,1 +522,1 @@\n-   do_signature(decodeBlock_signature, \"([BII[BIZZ)I\")                                                                  \\\n+   do_signature(decodeBlock_signature, \"([BII[BIZZ)I\")                                                                   \\\n@@ -529,5 +529,0 @@\n-                                                                                                                        \\\n-  \/* support for com.sun.crypto.provider.Poly1305 *\/                                                                    \\\n-  do_class(com_sun_crypto_provider_Poly1305, \"com\/sun\/crypto\/provider\/Poly1305\")                                        \\\n-  do_intrinsic(_poly1305_processBlocks, com_sun_crypto_provider_Poly1305, processMultipleBlocks_name, ghash_processBlocks_signature, F_R) \\\n-   do_name(processMultipleBlocks_name, \"processMultipleBlocks\")                                                         \\\n","filename":"src\/hotspot\/share\/classfile\/vmIntrinsics.hpp","additions":1,"deletions":6,"binary":false,"changes":7,"status":"modified"},{"patch":"@@ -26,0 +26,1 @@\n+#include \"jvm.h\"\n@@ -29,1 +30,0 @@\n-#include \"jvm.h\"\n","filename":"src\/hotspot\/share\/classfile\/vmSymbols.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -403,0 +403,4 @@\n+  template(ngroups_name,                              \"ngroups\")                                  \\\n+  template(groups_name,                               \"groups\")                                   \\\n+  template(nweaks_name,                               \"nweaks\")                                   \\\n+  template(weaks_name,                                \"weaks\")                                    \\\n@@ -606,1 +610,0 @@\n-  template(void_threadgroup_array_signature,          \"()[Ljava\/lang\/ThreadGroup;\")                               \\\n","filename":"src\/hotspot\/share\/classfile\/vmSymbols.hpp","additions":4,"deletions":1,"binary":false,"changes":5,"status":"modified"},{"patch":"@@ -26,0 +26,1 @@\n+#include \"jvm.h\"\n@@ -35,1 +36,0 @@\n-#include \"jvm.h\"\n","filename":"src\/hotspot\/share\/code\/codeBlob.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -26,0 +26,1 @@\n+#include \"jvm_io.h\"\n@@ -42,1 +43,0 @@\n-#include \"jvm_io.h\"\n@@ -1309,4 +1309,5 @@\n-      \/\/ Walk all methods saved on the last pass.  Concurrent class unloading may\n-      \/\/ also be looking at this method's metadata, so don't delete it yet if\n-      \/\/ it is marked as unloaded.\n-      old_compiled_method_table->at(i)->metadata_do(f);\n+      CompiledMethod* cm = old_compiled_method_table->at(i);\n+      \/\/ Only walk !is_unloading nmethods, the other ones will get removed by the GC.\n+      if (!cm->is_unloading()) {\n+        old_compiled_method_table->at(i)->metadata_do(f);\n+      }\n","filename":"src\/hotspot\/share\/code\/codeCache.cpp","additions":6,"deletions":5,"binary":false,"changes":11,"status":"modified"},{"patch":"@@ -26,0 +26,1 @@\n+#include \"jvm.h\"\n@@ -47,1 +48,0 @@\n-#include \"jvm.h\"\n","filename":"src\/hotspot\/share\/code\/nmethod.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -44,0 +44,5 @@\n+\n+#if INCLUDE_JVMCI\n+#include \"jvmci\/jvmci.hpp\"\n+#endif\n+\n@@ -47,0 +52,1 @@\n+\n@@ -50,3 +56,0 @@\n-#if INCLUDE_JVMCI\n-#include \"jvmci\/jvmci.hpp\"\n-#endif\n","filename":"src\/hotspot\/share\/compiler\/compilationPolicy.cpp","additions":6,"deletions":3,"binary":false,"changes":9,"status":"modified"},{"patch":"@@ -26,0 +26,1 @@\n+#include \"jvm.h\"\n@@ -41,1 +42,0 @@\n-#include \"jvm.h\"\n@@ -79,3 +79,0 @@\n-#ifdef COMPILER2\n-#include \"opto\/c2compiler.hpp\"\n-#endif\n@@ -86,0 +83,3 @@\n+#ifdef COMPILER2\n+#include \"opto\/c2compiler.hpp\"\n+#endif\n","filename":"src\/hotspot\/share\/compiler\/compileBroker.cpp","additions":4,"deletions":4,"binary":false,"changes":8,"status":"modified"},{"patch":"@@ -26,0 +26,1 @@\n+#include \"jvm.h\"\n@@ -29,1 +30,0 @@\n-#include \"jvm.h\"\n","filename":"src\/hotspot\/share\/compiler\/compileLog.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -28,1 +28,1 @@\n-#include \"jvm_io.h\"\n+#include \"include\/jvm_io.h\"\n@@ -404,1 +404,7 @@\n-#if defined(X86) || defined(AARCH64) || defined(RISCV64)\n+#ifdef X86\n+    if (FLAG_IS_DEFAULT(InlineSmallCode)) {\n+      FLAG_SET_DEFAULT(InlineSmallCode, 2500);\n+    }\n+#endif\n+\n+#if defined AARCH64\n","filename":"src\/hotspot\/share\/compiler\/compilerDefinitions.cpp","additions":8,"deletions":2,"binary":false,"changes":10,"status":"modified"},{"patch":"@@ -32,1 +32,1 @@\n-#include \"runtime\/os.hpp\"\n+#include \"runtime\/os.hpp\" \/\/ malloc\n","filename":"src\/hotspot\/share\/compiler\/compilerEvent.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -27,1 +27,0 @@\n-#include \"compiler\/compilerDefinitions.hpp\"\n@@ -29,0 +28,1 @@\n+#include \"compiler\/compilerDefinitions.hpp\"\n@@ -32,0 +32,1 @@\n+\n","filename":"src\/hotspot\/share\/compiler\/compilerEvent.hpp","additions":2,"deletions":1,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -26,0 +26,1 @@\n+#include \"jvm.h\"\n@@ -30,1 +31,0 @@\n-#include \"jvm.h\"\n","filename":"src\/hotspot\/share\/compiler\/compilerOracle.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -30,1 +30,0 @@\n-#include \"runtime\/javaThread.hpp\"\n@@ -37,0 +36,1 @@\n+#include \"runtime\/javaThread.hpp\"\n","filename":"src\/hotspot\/share\/gc\/epsilon\/epsilonBarrierSet.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -44,11 +44,0 @@\n-class G1CardSetHashTableConfig : public StackObj {\n-public:\n-  using Value = G1CardSetHashTableValue;\n-\n-  static uintx get_hash(Value const& value, bool* is_dead);\n-  static void* allocate_node(void* context, size_t size, Value const& value);\n-  static void free_node(void* context, void* memory, Value const& value);\n-};\n-\n-using CardSetHash = ConcurrentHashTable<G1CardSetHashTableConfig, mtGCCardSet>;\n-\n@@ -255,1 +244,1 @@\n-    uintx get_hash() const { return G1CardSetHashTable::get_hash(_region_idx); }\n+    uintx get_hash() const { return _region_idx; }\n@@ -321,4 +310,0 @@\n-  static uint get_hash(uint region_idx) {\n-    return region_idx;\n-  }\n-\n@@ -363,5 +348,0 @@\n-uintx G1CardSetHashTableConfig::get_hash(Value const& value, bool* is_dead) {\n-  *is_dead = false;\n-  return G1CardSetHashTable::get_hash(value._region_idx);\n-}\n-\n","filename":"src\/hotspot\/share\/gc\/g1\/g1CardSet.cpp","additions":1,"deletions":21,"binary":false,"changes":22,"status":"modified"},{"patch":"@@ -417,0 +417,14 @@\n+class G1CardSetHashTableConfig : public StackObj {\n+public:\n+  using Value = G1CardSetHashTableValue;\n+\n+  static uintx get_hash(Value const& value, bool* is_dead) {\n+    *is_dead = false;\n+    return value._region_idx;\n+  }\n+  static void* allocate_node(void* context, size_t size, Value const& value);\n+  static void free_node(void* context, void* memory, Value const& value);\n+};\n+\n+using CardSetHash = ConcurrentHashTable<G1CardSetHashTableConfig, mtGCCardSet>;\n+\n","filename":"src\/hotspot\/share\/gc\/g1\/g1CardSet.hpp","additions":14,"deletions":0,"binary":false,"changes":14,"status":"modified"},{"patch":"@@ -28,2 +28,0 @@\n-#include \"utilities\/globalDefinitions.hpp\"\n-\n","filename":"src\/hotspot\/share\/gc\/g1\/g1CodeCacheRemSet.hpp","additions":0,"deletions":2,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -3401,3 +3401,3 @@\n-    nmethod* nm = cb->as_nmethod_or_null();\n-    if (nm != NULL) {\n-      _g1h->register_nmethod(nm);\n+    nmethod* nm = (cb != NULL) ? cb->as_nmethod_or_null() : NULL;\n+    if (nm == NULL) {\n+      return;\n@@ -3405,0 +3405,2 @@\n+\n+    _g1h->register_nmethod(nm);\n","filename":"src\/hotspot\/share\/gc\/g1\/g1CollectedHeap.cpp","additions":5,"deletions":3,"binary":false,"changes":8,"status":"modified"},{"patch":"@@ -26,1 +26,0 @@\n-#include \"classfile\/classLoaderData.hpp\"\n@@ -61,1 +60,1 @@\n-#include \"jvm.h\"\n+#include \"include\/jvm.h\"\n@@ -2112,1 +2111,1 @@\n-  : ClaimMetadataVisitingOopIterateClosure(ClassLoaderData::_claim_strong, get_cm_oop_closure_ref_processor(g1h)),\n+  : MetadataVisitingOopIterateClosure(get_cm_oop_closure_ref_processor(g1h)),\n","filename":"src\/hotspot\/share\/gc\/g1\/g1ConcurrentMark.cpp","additions":2,"deletions":3,"binary":false,"changes":5,"status":"modified"},{"patch":"@@ -184,0 +184,4 @@\n+    \/\/ Need cleared claim bits for the mark phase.\n+    ClassLoaderDataGraph::clear_claimed_marks();\n+  } else {\n+    ClassLoaderDataGraph::verify_claimed_marks_cleared(ClassLoaderData::_claim_strong);\n@@ -226,1 +230,1 @@\n-  \/\/ Need completely cleared claim bits for the next concurrent marking or full gc.\n+  \/\/ Need cleared claim bits for the next concurrent marking.\n","filename":"src\/hotspot\/share\/gc\/g1\/g1FullCollector.cpp","additions":5,"deletions":1,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -26,1 +26,0 @@\n-#include \"classfile\/classLoaderData.hpp\"\n@@ -88,1 +87,2 @@\n-  ClassLoaderDataGraph::verify_claimed_marks_cleared(ClassLoaderData::_claim_stw_fullgc_adjust);\n+  \/\/ Need cleared claim bits for the roots processing\n+  ClassLoaderDataGraph::clear_claimed_marks();\n@@ -105,1 +105,1 @@\n-  CLDToOopClosure adjust_cld(&_adjust, ClassLoaderData::_claim_stw_fullgc_adjust);\n+  CLDToOopClosure adjust_cld(&_adjust, ClassLoaderData::_claim_strong);\n","filename":"src\/hotspot\/share\/gc\/g1\/g1FullGCAdjustTask.cpp","additions":3,"deletions":3,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -27,1 +27,0 @@\n-#include \"classfile\/classLoaderDataGraph.hpp\"\n@@ -47,1 +46,1 @@\n-    _cld_closure(mark_closure(), ClassLoaderData::_claim_stw_fullgc_mark),\n+    _cld_closure(mark_closure(), ClassLoaderData::_claim_strong),\n@@ -49,1 +48,0 @@\n-  ClassLoaderDataGraph::verify_claimed_marks_cleared(ClassLoaderData::_claim_stw_fullgc_mark);\n","filename":"src\/hotspot\/share\/gc\/g1\/g1FullGCMarker.cpp","additions":1,"deletions":3,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -188,0 +188,1 @@\n+  _recorded_preserve_cm_referents_time_ms = 0.0;\n@@ -465,0 +466,1 @@\n+                        _recorded_preserve_cm_referents_time_ms +\n","filename":"src\/hotspot\/share\/gc\/g1\/g1GCPhaseTimes.cpp","additions":2,"deletions":0,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -203,0 +203,2 @@\n+  double _recorded_preserve_cm_referents_time_ms;\n+\n@@ -357,0 +359,4 @@\n+  void record_preserve_cm_referents_time_ms(double time_ms) {\n+    _recorded_preserve_cm_referents_time_ms = time_ms;\n+  }\n+\n","filename":"src\/hotspot\/share\/gc\/g1\/g1GCPhaseTimes.hpp","additions":6,"deletions":0,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -26,0 +26,1 @@\n+\n","filename":"src\/hotspot\/share\/gc\/g1\/g1MonotonicArena.cpp","additions":1,"deletions":0,"binary":false,"changes":1,"status":"modified"},{"patch":"@@ -28,1 +28,0 @@\n-#include \"classfile\/classLoaderData.hpp\"\n@@ -183,1 +182,1 @@\n-class G1CMOopClosure : public ClaimMetadataVisitingOopIterateClosure {\n+class G1CMOopClosure : public MetadataVisitingOopIterateClosure {\n@@ -194,1 +193,2 @@\n-class G1RootRegionScanClosure : public ClaimMetadataVisitingOopIterateClosure {\n+class G1RootRegionScanClosure : public MetadataVisitingOopIterateClosure {\n+private:\n@@ -200,1 +200,0 @@\n-    ClaimMetadataVisitingOopIterateClosure(ClassLoaderData::_claim_strong, nullptr),\n","filename":"src\/hotspot\/share\/gc\/g1\/g1OopClosures.hpp","additions":3,"deletions":4,"binary":false,"changes":7,"status":"modified"},{"patch":"@@ -40,0 +40,1 @@\n+  OopClosure* weak_oops()   { return &_closures._oops; }\n@@ -63,0 +64,1 @@\n+  OopClosure* weak_oops()   { return &_weak._oops; }\n","filename":"src\/hotspot\/share\/gc\/g1\/g1RootClosures.cpp","additions":2,"deletions":0,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -37,0 +37,1 @@\n+  virtual OopClosure* weak_oops() = 0;\n","filename":"src\/hotspot\/share\/gc\/g1\/g1RootClosures.hpp","additions":1,"deletions":0,"binary":false,"changes":1,"status":"modified"},{"patch":"@@ -88,0 +88,1 @@\n+  OopClosure* weak_oops()   { return NULL; }\n@@ -118,0 +119,1 @@\n+  OopClosure* weak_oops() { return _roots; }\n","filename":"src\/hotspot\/share\/gc\/g1\/g1RootProcessor.cpp","additions":2,"deletions":0,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -134,1 +134,1 @@\n-      cld->oops_do(&_oop_closure, ClassLoaderData::_claim_none, \/*clear_modified_oops*\/true);\n+      cld->oops_do(&_oop_closure, false, \/*clear_modified_oops*\/true);\n","filename":"src\/hotspot\/share\/gc\/parallel\/psClosure.inline.hpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -185,0 +185,4 @@\n+  inline void follow_klass(Klass* klass);\n+\n+  void follow_class_loader(ClassLoaderData* klass);\n+\n","filename":"src\/hotspot\/share\/gc\/parallel\/psCompactionManager.hpp","additions":4,"deletions":0,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -55,1 +55,1 @@\n-class PCIterateMarkAndPushClosure: public ClaimMetadataVisitingOopIterateClosure {\n+class PCIterateMarkAndPushClosure: public MetadataVisitingOopIterateClosure {\n@@ -59,3 +59,1 @@\n-  PCIterateMarkAndPushClosure(ParCompactionManager* cm, ReferenceProcessor* rp) :\n-    ClaimMetadataVisitingOopIterateClosure(ClassLoaderData::_claim_stw_fullgc_mark, rp),\n-    _compaction_manager(cm) { }\n+  PCIterateMarkAndPushClosure(ParCompactionManager* cm, ReferenceProcessor* rp) : MetadataVisitingOopIterateClosure(rp), _compaction_manager(cm) { }\n@@ -66,0 +64,3 @@\n+\n+  void do_klass_nv(Klass* k)                      { _compaction_manager->follow_klass(k); }\n+  void do_cld_nv(ClassLoaderData* cld)            { _compaction_manager->follow_class_loader(cld); }\n@@ -121,0 +122,5 @@\n+inline void ParCompactionManager::follow_klass(Klass* klass) {\n+  oop holder = klass->class_loader_data()->holder_no_keepalive();\n+  mark_and_push(&holder);\n+}\n+\n@@ -165,0 +171,5 @@\n+inline void ParCompactionManager::follow_class_loader(ClassLoaderData* cld) {\n+  PCMarkAndPushClosure mark_and_push_closure(this);\n+  cld->oops_do(&mark_and_push_closure, true);\n+}\n+\n","filename":"src\/hotspot\/share\/gc\/parallel\/psCompactionManager.inline.hpp","additions":15,"deletions":4,"binary":false,"changes":19,"status":"modified"},{"patch":"@@ -1036,3 +1036,0 @@\n-  \/\/ Need to clear claim bits for the next mark.\n-  ClassLoaderDataGraph::clear_claimed_marks();\n-\n@@ -1971,1 +1968,1 @@\n-      CLDToOopClosure cld_closure(&mark_and_push_closure, ClassLoaderData::_claim_stw_fullgc_mark);\n+      CLDToOopClosure cld_closure(&mark_and_push_closure, ClassLoaderData::_claim_strong);\n@@ -2022,1 +2019,3 @@\n-  ClassLoaderDataGraph::verify_claimed_marks_cleared(ClassLoaderData::_claim_stw_fullgc_mark);\n+  \/\/ Need new claim bits before marking starts.\n+  ClassLoaderDataGraph::clear_claimed_marks();\n+\n@@ -2098,2 +2097,2 @@\n-\n-    ClassLoaderDataGraph::verify_claimed_marks_cleared(ClassLoaderData::_claim_stw_fullgc_adjust);\n+    \/\/ Need new claim bits when tracing through and adjusting pointers.\n+    ClassLoaderDataGraph::clear_claimed_marks();\n@@ -2118,1 +2117,1 @@\n-      CLDToOopClosure cld_closure(&adjust, ClassLoaderData::_claim_stw_fullgc_adjust);\n+      CLDToOopClosure cld_closure(&adjust, ClassLoaderData::_claim_strong);\n","filename":"src\/hotspot\/share\/gc\/parallel\/psParallelCompact.cpp","additions":7,"deletions":8,"binary":false,"changes":15,"status":"modified"},{"patch":"@@ -183,1 +183,2 @@\n-  ClassLoaderDataGraph::verify_claimed_marks_cleared(ClassLoaderData::_claim_stw_fullgc_mark);\n+  \/\/ Need new claim bits before marking starts.\n+  ClassLoaderDataGraph::clear_claimed_marks();\n@@ -263,1 +264,2 @@\n-  ClassLoaderDataGraph::verify_claimed_marks_cleared(ClassLoaderData::_claim_stw_fullgc_adjust);\n+  \/\/ Need new claim bits for the pointer adjustment tracing.\n+  ClassLoaderDataGraph::clear_claimed_marks();\n","filename":"src\/hotspot\/share\/gc\/serial\/genMarkSweep.cpp","additions":4,"deletions":2,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -65,2 +65,2 @@\n-CLDToOopClosure    MarkSweep::follow_cld_closure(&mark_and_push_closure, ClassLoaderData::_claim_stw_fullgc_mark);\n-CLDToOopClosure    MarkSweep::adjust_cld_closure(&adjust_pointer_closure, ClassLoaderData::_claim_stw_fullgc_adjust);\n+CLDToOopClosure    MarkSweep::follow_cld_closure(&mark_and_push_closure, ClassLoaderData::_claim_strong);\n+CLDToOopClosure    MarkSweep::adjust_cld_closure(&adjust_pointer_closure, ClassLoaderData::_claim_strong);\n","filename":"src\/hotspot\/share\/gc\/serial\/markSweep.cpp","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -26,0 +26,1 @@\n+#include \"jvm.h\"\n@@ -30,2 +31,0 @@\n-#include \"jvm.h\"\n-#include \"logging\/log.hpp\"\n@@ -33,1 +32,0 @@\n-#include \"oops\/oop.inline.hpp\"\n@@ -35,0 +33,2 @@\n+#include \"logging\/log.hpp\"\n+#include \"oops\/oop.inline.hpp\"\n","filename":"src\/hotspot\/share\/gc\/shared\/ageTable.cpp","additions":3,"deletions":3,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -198,1 +198,0 @@\n-  OrderAccess::cross_modify_fence();\n","filename":"src\/hotspot\/share\/gc\/shared\/barrierSetNMethod.cpp","additions":0,"deletions":1,"binary":false,"changes":1,"status":"modified"},{"patch":"@@ -26,1 +26,0 @@\n-#include \"gc\/shared\/gcId.hpp\"\n@@ -28,0 +27,1 @@\n+#include \"gc\/shared\/gcId.hpp\"\n","filename":"src\/hotspot\/share\/gc\/shared\/gcId.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -28,1 +28,1 @@\n-#include \"runtime\/os.hpp\"\n+#include \"runtime\/os.hpp\" \/\/ malloc\n","filename":"src\/hotspot\/share\/gc\/shared\/gcLogPrecious.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -631,4 +631,0 @@\n-\n-    \/\/ Need to clear claim bits for the next mark.\n-    ClassLoaderDataGraph::clear_claimed_marks();\n-\n@@ -1069,1 +1065,1 @@\n-  log_debug(gc, verify)(\"%s\", _young_gen->name());\n+  log_debug(gc, verify)(\"%s\", _old_gen->name());\n","filename":"src\/hotspot\/share\/gc\/shared\/genCollectedHeap.cpp","additions":1,"deletions":5,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -383,1 +383,1 @@\n-  if (UseTLAB) {\n+  {\n","filename":"src\/hotspot\/share\/gc\/shared\/memAllocator.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -32,1 +32,1 @@\n-const jint ShenandoahEvacOOMCounter::OOM_MARKER_MASK = 0x80000000;\n+const jint ShenandoahEvacOOMHandler::OOM_MARKER_MASK = 0x80000000;\n@@ -34,13 +34,2 @@\n-ShenandoahEvacOOMCounter::ShenandoahEvacOOMCounter() :\n-  _bits(0) {\n-}\n-\n-void ShenandoahEvacOOMCounter::decrement() {\n-  assert(unmasked_count() > 0, \"sanity\");\n-  \/\/ NOTE: It's ok to simply decrement, even with mask set, because unmasked value is positive.\n-  Atomic::dec(&_bits);\n-}\n-\n-void ShenandoahEvacOOMCounter::clear() {\n-  assert(unmasked_count() == 0, \"sanity\");\n-  Atomic::release_store_fence(&_bits, (jint)0);\n+ShenandoahEvacOOMHandler::ShenandoahEvacOOMHandler() :\n+  _threads_in_evac(0) {\n@@ -49,15 +38,3 @@\n-void ShenandoahEvacOOMCounter::set_oom_bit(bool decrement) {\n-  jint threads_in_evac = Atomic::load_acquire(&_bits);\n-  while (true) {\n-    jint newval = decrement\n-      ? (threads_in_evac - 1) | OOM_MARKER_MASK\n-      : threads_in_evac | OOM_MARKER_MASK;\n-\n-    jint other = Atomic::cmpxchg(&_bits, threads_in_evac, newval);\n-    if (other == threads_in_evac) {\n-      \/\/ Success: wait for other threads to get out of the protocol and return.\n-      break;\n-    } else {\n-      \/\/ Failure: try again with updated new value.\n-      threads_in_evac = other;\n-    }\n+void ShenandoahEvacOOMHandler::wait_for_no_evac_threads() {\n+  while ((Atomic::load_acquire(&_threads_in_evac) & ~OOM_MARKER_MASK) != 0) {\n+    os::naked_short_sleep(1);\n@@ -65,0 +42,4 @@\n+  \/\/ At this point we are sure that no threads can evacuate anything. Raise\n+  \/\/ the thread-local oom_during_evac flag to indicate that any attempt\n+  \/\/ to evacuate should simply return the forwarding pointer instead (which is safe now).\n+  ShenandoahThreadLocalData::set_oom_during_evac(Thread::current(), true);\n@@ -67,3 +48,2 @@\n-bool ShenandoahEvacOOMCounter::try_increment()\n-{\n-  jint threads_in_evac = Atomic::load_acquire(&_bits);\n+void ShenandoahEvacOOMHandler::register_thread(Thread* thr) {\n+  jint threads_in_evac = Atomic::load_acquire(&_threads_in_evac);\n@@ -71,0 +51,1 @@\n+  assert(!ShenandoahThreadLocalData::is_oom_during_evac(Thread::current()), \"TL oom-during-evac must not be set\");\n@@ -72,1 +53,2 @@\n-    \/\/ Cannot enter evacuation if OOM_MARKER_MASK is set.\n+    \/\/ Check for OOM.\n+    \/\/ If offender has OOM_MARKER_MASK, then loop until no more threads in evac\n@@ -74,1 +56,2 @@\n-      return false;\n+      wait_for_no_evac_threads();\n+      return;\n@@ -77,1 +60,1 @@\n-    jint other = Atomic::cmpxchg(&_bits, threads_in_evac, threads_in_evac + 1);\n+    jint other = Atomic::cmpxchg(&_threads_in_evac, threads_in_evac, threads_in_evac + 1);\n@@ -80,1 +63,1 @@\n-      return true;\n+      return;\n@@ -87,68 +70,0 @@\n-ShenandoahEvacOOMHandler::ShenandoahEvacOOMHandler() :\n-  _num_counters(calc_num_counters()) {\n-\n-  assert(_num_counters > 0, \"sanity\");\n-  assert(is_power_of_2(_num_counters), \"must be\");\n-\n-  _threads_in_evac = NEW_C_HEAP_ARRAY(ShenandoahEvacOOMCounter, _num_counters, mtGC);\n-  for (int i = 0; i < _num_counters; i++) {\n-    new (&_threads_in_evac[i]) ShenandoahEvacOOMCounter();\n-  }\n-}\n-\n-int ShenandoahEvacOOMHandler::calc_num_counters() {\n-  \/\/ Scale the number of counter buckets with the number of CPUs to\n-  \/\/ minimise contention.  Also make sure the number is a power of two\n-  \/\/ so we can map hash values to buckets with a simple mask.\n-  const int nproc = os::active_processor_count();\n-  const int clamped = MAX2(1, MIN2(nproc, 128));\n-  return round_up_power_of_2(clamped);\n-}\n-\n-uint64_t ShenandoahEvacOOMHandler::hash_pointer(const void* p) {\n-  \/\/ Bit mixing function from MurmurHash3\n-  uint64_t key = (uintptr_t)p;\n-  key ^= (key >> 33);\n-  key *= UINT64_C(0xff51afd7ed558ccd);\n-  key ^= (key >> 33);\n-  key *= UINT64_C(0xc4ceb9fe1a85ec53);\n-  key ^= (key >> 33);\n-  return key;\n-}\n-\n-ShenandoahEvacOOMCounter* ShenandoahEvacOOMHandler::counter_for_thread(Thread* t) {\n-  const uint64_t key = hash_pointer(t);\n-  return &_threads_in_evac[key & (_num_counters - 1)];\n-}\n-\n-void ShenandoahEvacOOMHandler::wait_for_one_counter(ShenandoahEvacOOMCounter* ptr) {\n-  \/\/ We might be racing against handle_out_of_memory_during_evacuation()\n-  \/\/ setting the OOM_MARKER_MASK bit so we must make sure it is set here\n-  \/\/ *and* the counter is zero.\n-  while (ptr->load_acquire() != ShenandoahEvacOOMCounter::OOM_MARKER_MASK) {\n-    os::naked_short_sleep(1);\n-  }\n-}\n-\n-void ShenandoahEvacOOMHandler::wait_for_no_evac_threads() {\n-  \/\/ Once the OOM_MARKER_MASK bit is set the counter can only decrease\n-  \/\/ so it's safe to check each bucket in turn.\n-  for (int i = 0; i < _num_counters; i++) {\n-    wait_for_one_counter(&_threads_in_evac[i]);\n-  }\n-  \/\/ At this point we are sure that no threads can evacuate anything. Raise\n-  \/\/ the thread-local oom_during_evac flag to indicate that any attempt\n-  \/\/ to evacuate should simply return the forwarding pointer instead (which is safe now).\n-  ShenandoahThreadLocalData::set_oom_during_evac(Thread::current(), true);\n-}\n-\n-void ShenandoahEvacOOMHandler::register_thread(Thread* thr) {\n-  assert(!ShenandoahThreadLocalData::is_oom_during_evac(Thread::current()), \"TL oom-during-evac must not be set\");\n-\n-  ShenandoahEvacOOMCounter* counter = counter_for_thread(thr);\n-  if (!counter->try_increment()) {\n-    \/\/ Counter has OOM_MARKER_MASK set, loop until no more threads in evac\n-    wait_for_no_evac_threads();\n-  }\n-}\n-\n@@ -157,1 +72,3 @@\n-    counter_for_thread(thr)->decrement();\n+    assert((Atomic::load_acquire(&_threads_in_evac) & ~OOM_MARKER_MASK) > 0, \"sanity\");\n+    \/\/ NOTE: It's ok to simply decrement, even with mask set, because unmasked value is positive.\n+    Atomic::dec(&_threads_in_evac);\n@@ -171,6 +88,11 @@\n-  ShenandoahEvacOOMCounter* self = counter_for_thread(Thread::current());\n-  assert(self->unmasked_count() > 0, \"sanity\");\n-\n-  for (int i = 0; i < _num_counters; i++) {\n-    ShenandoahEvacOOMCounter* counter = &_threads_in_evac[i];\n-    counter->set_oom_bit(counter == self);\n+  jint threads_in_evac = Atomic::load_acquire(&_threads_in_evac);\n+  while (true) {\n+    jint other = Atomic::cmpxchg(&_threads_in_evac, threads_in_evac, (threads_in_evac - 1) | OOM_MARKER_MASK);\n+    if (other == threads_in_evac) {\n+      \/\/ Success: wait for other threads to get out of the protocol and return.\n+      wait_for_no_evac_threads();\n+      return;\n+    } else {\n+      \/\/ Failure: try again with updated new value.\n+      threads_in_evac = other;\n+    }\n@@ -178,2 +100,0 @@\n-\n-  wait_for_no_evac_threads();\n@@ -184,3 +104,2 @@\n-  for (int i = 0; i < _num_counters; i++) {\n-    _threads_in_evac[i].clear();\n-  }\n+  assert((Atomic::load_acquire(&_threads_in_evac) & ~OOM_MARKER_MASK) == 0, \"sanity\");\n+  Atomic::release_store_fence(&_threads_in_evac, (jint)0);\n","filename":"src\/hotspot\/share\/gc\/shenandoah\/shenandoahEvacOOMHandler.cpp","additions":35,"deletions":116,"binary":false,"changes":151,"status":"modified"},{"patch":"@@ -33,25 +33,0 @@\n-\/**\n- * Striped counter used to implement the OOM protocol described below.\n- *\/\n-class ShenandoahEvacOOMCounter {\n-private:\n-  \/\/ Combination of a 31-bit counter and 1-bit OOM marker.\n-  volatile jint _bits;\n-\n-  \/\/ This class must be at least a cache line in size to prevent false sharing.\n-  shenandoah_padding_minus_size(0, sizeof(jint));\n-\n-public:\n-  static const jint OOM_MARKER_MASK;\n-\n-  ShenandoahEvacOOMCounter();\n-\n-  void decrement();\n-  bool try_increment();\n-  void clear();\n-  void set_oom_bit(bool decrement);\n-\n-  inline jint unmasked_count();\n-  inline jint load_acquire();\n-};\n-\n@@ -85,3 +60,1 @@\n- * for current threads to leave, and blocks other threads from entering. The counter state\n- * is striped across multiple cache lines to reduce contention when many threads attempt\n- * to enter or leave the protocol at the same time.\n+ * for current threads to leave, and blocks other threads from entering.\n@@ -111,1 +84,1 @@\n-  const int _num_counters;\n+  static const jint OOM_MARKER_MASK;\n@@ -114,3 +87,2 @@\n-  ShenandoahEvacOOMCounter* _threads_in_evac;\n-\n-  ShenandoahEvacOOMCounter* counter_for_thread(Thread* t);\n+  volatile jint _threads_in_evac;\n+  shenandoah_padding(1);\n@@ -119,1 +91,0 @@\n-  void wait_for_one_counter(ShenandoahEvacOOMCounter* ptr);\n@@ -121,2 +92,0 @@\n-  static uint64_t hash_pointer(const void* p);\n-  static int calc_num_counters();\n","filename":"src\/hotspot\/share\/gc\/shenandoah\/shenandoahEvacOOMHandler.hpp","additions":4,"deletions":35,"binary":false,"changes":39,"status":"modified"},{"patch":"@@ -34,8 +34,0 @@\n-jint ShenandoahEvacOOMCounter::load_acquire() {\n-  return Atomic::load_acquire(&_bits);\n-}\n-\n-jint ShenandoahEvacOOMCounter::unmasked_count() {\n-  return Atomic::load_acquire(&_bits) & ~OOM_MARKER_MASK;\n-}\n-\n@@ -43,0 +35,2 @@\n+  jint threads_in_evac = Atomic::load_acquire(&_threads_in_evac);\n+\n@@ -48,2 +42,1 @@\n-   ShenandoahEvacOOMCounter* counter = counter_for_thread(thr);\n-   jint threads_in_evac = counter->load_acquire();\n+   jint threads_in_evac = Atomic::load_acquire(&_threads_in_evac);\n@@ -51,2 +44,3 @@\n-   if ((threads_in_evac & ShenandoahEvacOOMCounter::OOM_MARKER_MASK) != 0) {\n-     counter->decrement();\n+   if ((threads_in_evac & OOM_MARKER_MASK) != 0) {\n+     assert((threads_in_evac & ~OOM_MARKER_MASK) > 0, \"sanity\");\n+     Atomic::dec(&_threads_in_evac);\n","filename":"src\/hotspot\/share\/gc\/shenandoah\/shenandoahEvacOOMHandler.inline.hpp","additions":6,"deletions":12,"binary":false,"changes":18,"status":"modified"},{"patch":"@@ -40,3 +40,0 @@\n-#define shenandoah_padding_minus_size(id, size) \\\n-  DEFINE_PAD_MINUS_SIZE(id, SHENANDOAH_CACHE_LINE_SIZE, size)\n-\n","filename":"src\/hotspot\/share\/gc\/shenandoah\/shenandoahPadding.hpp","additions":0,"deletions":3,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -36,1 +36,0 @@\n-\/\/ Needs to be included after definition of ZBarrierSetAssemblerBase\n","filename":"src\/hotspot\/share\/gc\/z\/zBarrierSetAssembler.hpp","additions":0,"deletions":1,"binary":false,"changes":1,"status":"modified"},{"patch":"@@ -26,0 +26,1 @@\n+#include \"jvm.h\"\n@@ -32,1 +33,0 @@\n-#include \"jvm.h\"\n","filename":"src\/hotspot\/share\/interpreter\/bootstrapInfo.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -26,0 +26,1 @@\n+#include \"jvm_io.h\"\n@@ -41,1 +42,0 @@\n-#include \"jvm_io.h\"\n","filename":"src\/hotspot\/share\/interpreter\/interpreterRuntime.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -26,0 +26,1 @@\n+#include \"jvm.h\"\n@@ -39,1 +40,0 @@\n-#include \"jvm.h\"\n","filename":"src\/hotspot\/share\/interpreter\/linkResolver.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -205,2 +205,2 @@\n-void TemplateTable::def(Bytecodes::Code code, int flags, TosState in, TosState out, void (*gen)(LdcType ldct), LdcType ldct) {\n-  def(code, flags, in, out, (Template::generator)gen, (int)ldct);\n+void TemplateTable::def(Bytecodes::Code code, int flags, TosState in, TosState out, void (*gen)(bool arg    ), bool arg) {\n+  def(code, flags, in, out, (Template::generator)gen, (int)arg);\n@@ -253,2 +253,2 @@\n-  def(Bytecodes::_ldc                 , ubcp|____|clvm|____, vtos, vtos, ldc                 ,  ldc_normal  );\n-  def(Bytecodes::_ldc_w               , ubcp|____|clvm|____, vtos, vtos, ldc                 ,  ldc_wide    );\n+  def(Bytecodes::_ldc                 , ubcp|____|clvm|____, vtos, vtos, ldc                 ,  false       );\n+  def(Bytecodes::_ldc_w               , ubcp|____|clvm|____, vtos, vtos, ldc                 ,  true        );\n@@ -487,2 +487,2 @@\n-  def(Bytecodes::_fast_aldc           , ubcp|____|clvm|____, vtos, atos, fast_aldc           ,  ldc_normal  );\n-  def(Bytecodes::_fast_aldc_w         , ubcp|____|clvm|____, vtos, atos, fast_aldc           ,  ldc_wide    );\n+  def(Bytecodes::_fast_aldc           , ubcp|____|clvm|____, vtos, atos, fast_aldc           ,  false       );\n+  def(Bytecodes::_fast_aldc_w         , ubcp|____|clvm|____, vtos, atos, fast_aldc           ,  true        );\n","filename":"src\/hotspot\/share\/interpreter\/templateTable.cpp","additions":6,"deletions":6,"binary":false,"changes":12,"status":"modified"},{"patch":"@@ -86,1 +86,0 @@\n-  enum LdcType   { ldc_normal = 0, ldc_wide = 1 }; \/\/ LDC type\n@@ -109,5 +108,0 @@\n-  static bool is_ldc_wide(LdcType type) {\n-    assert(type == ldc_wide || type == ldc_normal, \"sanity\");\n-    return (type == ldc_wide);\n-  }\n-\n@@ -137,1 +131,1 @@\n-  static void ldc(LdcType type);\n+  static void ldc(bool wide);\n@@ -139,1 +133,1 @@\n-  static void fast_aldc(LdcType type);\n+  static void fast_aldc(bool wide);\n@@ -336,1 +330,1 @@\n-  static void def(Bytecodes::Code code, int flags, TosState in, TosState out, void (*gen)(LdcType ldct), LdcType ldct);\n+  static void def(Bytecodes::Code code, int flags, TosState in, TosState out, void (*gen)(bool arg    ), bool arg    );\n","filename":"src\/hotspot\/share\/interpreter\/templateTable.hpp","additions":3,"deletions":9,"binary":false,"changes":12,"status":"modified"},{"patch":"@@ -26,0 +26,1 @@\n+#include \"jvm_io.h\"\n@@ -35,1 +36,0 @@\n-#include \"jvm_io.h\"\n@@ -63,0 +63,2 @@\n+\/\/ no precompiled headers\n+\n","filename":"src\/hotspot\/share\/interpreter\/zero\/bytecodeInterpreter.cpp","additions":3,"deletions":1,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -26,0 +26,1 @@\n+#include \"jvm.h\"\n@@ -36,1 +37,0 @@\n-#include \"jvm.h\"\n","filename":"src\/hotspot\/share\/jfr\/instrumentation\/jfrEventClassTransformer.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -26,0 +26,1 @@\n+#include \"jvm.h\"\n@@ -32,1 +33,0 @@\n-#include \"jvm.h\"\n","filename":"src\/hotspot\/share\/jfr\/instrumentation\/jfrJvmtiAgent.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -35,0 +35,1 @@\n+\n@@ -38,0 +39,1 @@\n+\n","filename":"src\/hotspot\/share\/jfr\/instrumentation\/jfrResolution.cpp","additions":2,"deletions":0,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -28,1 +28,0 @@\n-#include \"jfr\/utilities\/jfrAllocation.hpp\"\n@@ -30,0 +29,1 @@\n+#include \"jfr\/utilities\/jfrAllocation.hpp\"\n","filename":"src\/hotspot\/share\/jfr\/jni\/jfrJavaCall.hpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -26,0 +26,2 @@\n+#include \"jni.h\"\n+#include \"jvm.h\"\n@@ -54,2 +56,0 @@\n-#include \"jni.h\"\n-#include \"jvm.h\"\n@@ -63,0 +63,1 @@\n+\n@@ -65,1 +66,0 @@\n-#include \"os_linux.hpp\"\n@@ -394,10 +394,0 @@\n-\n-JVM_ENTRY_NO_ENV(jlong, jfr_host_total_memory(JNIEnv* env, jobject jvm))\n-#ifdef LINUX\n-  \/\/ We want the host memory, not the container limit.\n-  \/\/ os::physical_memory() would return the container limit.\n-  return os::Linux::physical_memory();\n-#else\n-  return os::physical_memory();\n-#endif\n-JVM_END\n","filename":"src\/hotspot\/share\/jfr\/jni\/jfrJniMethod.cpp","additions":3,"deletions":13,"binary":false,"changes":16,"status":"modified"},{"patch":"@@ -163,2 +163,0 @@\n-jlong JNICALL jfr_host_total_memory(JNIEnv* env, jobject jvm);\n-\n","filename":"src\/hotspot\/share\/jfr\/jni\/jfrJniMethod.hpp","additions":0,"deletions":2,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -97,2 +97,1 @@\n-      (char*)\"isContainerized\", (char*)\"()Z\", (void*) jfr_is_containerized,\n-      (char*)\"hostTotalMemory\", (char*)\"()J\", (void*) jfr_host_total_memory\n+      (char*)\"isContainerized\", (char*)\"()Z\", (void*) jfr_is_containerized\n","filename":"src\/hotspot\/share\/jfr\/jni\/jfrJniMethodRegistration.cpp","additions":1,"deletions":2,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -26,0 +26,1 @@\n+#include \"jvm_io.h\"\n@@ -32,1 +33,0 @@\n-#include \"jvm_io.h\"\n","filename":"src\/hotspot\/share\/jfr\/jni\/jfrUpcalls.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -28,1 +28,0 @@\n-#include \"jfr\/utilities\/jfrAllocation.hpp\"\n@@ -30,0 +29,1 @@\n+#include \"jfr\/utilities\/jfrAllocation.hpp\"\n","filename":"src\/hotspot\/share\/jfr\/jni\/jfrUpcalls.hpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -26,0 +26,1 @@\n+#include \"jvm_io.h\"\n@@ -32,1 +33,0 @@\n-#include \"jvm_io.h\"\n","filename":"src\/hotspot\/share\/jfr\/leakprofiler\/checkpoint\/objectSampleDescription.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -26,0 +26,1 @@\n+#include \"jvm.h\"\n@@ -49,1 +50,0 @@\n-#include \"jvm.h\"\n@@ -75,1 +75,0 @@\n-\n","filename":"src\/hotspot\/share\/jfr\/periodic\/jfrPeriodic.cpp","additions":1,"deletions":2,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -28,0 +28,1 @@\n+#include \"jni.h\"\n@@ -30,1 +31,0 @@\n-#include \"jni.h\"\n","filename":"src\/hotspot\/share\/jfr\/recorder\/checkpoint\/types\/jfrThreadGroup.hpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -56,0 +56,1 @@\n+\n","filename":"src\/hotspot\/share\/jfr\/recorder\/checkpoint\/types\/jfrType.cpp","additions":1,"deletions":0,"binary":false,"changes":1,"status":"modified"},{"patch":"@@ -28,1 +28,0 @@\n-#include \"jfr\/utilities\/jfrTypes.hpp\"\n@@ -30,0 +29,1 @@\n+#include \"jfr\/utilities\/jfrTypes.hpp\"\n","filename":"src\/hotspot\/share\/jfr\/recorder\/checkpoint\/types\/traceid\/jfrTraceId.hpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -28,1 +28,0 @@\n-#include \"jfr\/utilities\/jfrTypes.hpp\"\n@@ -30,0 +29,1 @@\n+#include \"jfr\/utilities\/jfrTypes.hpp\"\n","filename":"src\/hotspot\/share\/jfr\/recorder\/checkpoint\/types\/traceid\/jfrTraceIdBits.hpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -26,0 +26,1 @@\n+#include \"jvm_io.h\"\n@@ -33,1 +34,0 @@\n-#include \"jvm_io.h\"\n","filename":"src\/hotspot\/share\/jfr\/recorder\/repository\/jfrEmergencyDump.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -27,1 +27,0 @@\n-#include \"jfr\/utilities\/jfrAllocation.hpp\"\n@@ -29,0 +28,1 @@\n+#include \"jfr\/utilities\/jfrAllocation.hpp\"\n","filename":"src\/hotspot\/share\/jfr\/recorder\/repository\/jfrRepository.hpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -28,0 +28,1 @@\n+#include \"jni.h\"\n@@ -32,1 +33,0 @@\n-#include \"jni.h\"\n","filename":"src\/hotspot\/share\/jfr\/recorder\/stringpool\/jfrStringPool.hpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -38,1 +38,1 @@\n-#include \"runtime\/os.hpp\"\n+#include \"runtime\/os.hpp\" \/\/ malloc\n","filename":"src\/hotspot\/share\/jvmci\/jvmci.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -40,1 +40,1 @@\n-#include \"runtime\/os.hpp\"\n+#include \"runtime\/os.hpp\" \/\/ malloc\n","filename":"src\/hotspot\/share\/jvmci\/jvmciCodeInstaller.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -579,10 +579,0 @@\n-C2V_VMENTRY_NULL(jobject, getUncachedStringInPool, (JNIEnv* env, jobject, ARGUMENT_PAIR(cp), jint index))\n-  constantPoolHandle cp(THREAD, UNPACK_PAIR(ConstantPool, cp));\n-  constantTag tag = cp->tag_at(index);\n-  if (!tag.is_string()) {\n-    JVMCI_THROW_MSG_NULL(IllegalArgumentException, err_msg(\"Unexpected constant pool tag at index %d: %d\", index, tag.value()));\n-  }\n-  oop obj = cp->uncached_string_at(index, CHECK_NULL);\n-  return JVMCIENV->get_jobject(JVMCIENV->get_object_constant(obj));\n-C2V_END\n-\n@@ -1904,0 +1894,3 @@\n+  \/\/ Ensure class is linked\n+  iklass->link_class(CHECK_NULL);\n+\n@@ -1931,0 +1924,3 @@\n+  \/\/ Ensure class is linked\n+  iklass->link_class(CHECK_NULL);\n+\n@@ -2841,1 +2837,0 @@\n-  {CC \"getUncachedStringInPool\",                      CC \"(\" HS_CONSTANT_POOL2 \"I)\" JAVACONSTANT,                                           FN_PTR(getUncachedStringInPool)},\n","filename":"src\/hotspot\/share\/jvmci\/jvmciCompilerToVM.cpp","additions":6,"deletions":11,"binary":false,"changes":17,"status":"modified"},{"patch":"@@ -26,0 +26,1 @@\n+#include \"jvm_io.h\"\n@@ -32,1 +33,0 @@\n-#include \"jvm_io.h\"\n","filename":"src\/hotspot\/share\/jvmci\/jvmciEnv.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -27,0 +27,1 @@\n+#include \"jvm_io.h\"\n@@ -29,1 +30,0 @@\n-#include \"jvm_io.h\"\n","filename":"src\/hotspot\/share\/jvmci\/jvmciRuntime.hpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -177,1 +177,0 @@\n-  nonstatic_field(JavaThread,                  _extentLocalCache,                             OopHandle)                             \\\n","filename":"src\/hotspot\/share\/jvmci\/vmStructs_jvmci.cpp","additions":0,"deletions":1,"binary":false,"changes":1,"status":"modified"},{"patch":"@@ -33,1 +33,0 @@\n-#include \"utilities\/defaultStream.hpp\"\n@@ -35,0 +34,1 @@\n+#include \"utilities\/defaultStream.hpp\"\n","filename":"src\/hotspot\/share\/logging\/logFileOutput.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -27,1 +27,0 @@\n-#include \"logging\/logDecorations.hpp\"\n@@ -29,0 +28,1 @@\n+#include \"logging\/logDecorations.hpp\"\n","filename":"src\/hotspot\/share\/logging\/logFileStreamOutput.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -26,0 +26,1 @@\n+#include \"utilities\/ostream.hpp\"\n","filename":"src\/hotspot\/share\/logging\/logSelection.cpp","additions":1,"deletions":0,"binary":false,"changes":1,"status":"modified"},{"patch":"@@ -426,1 +426,1 @@\n-extern void resource_free_bytes( Thread* thread, char *old, size_t size );\n+extern void resource_free_bytes( char *old, size_t size );\n@@ -563,4 +563,1 @@\n-  resource_free_bytes(Thread::current(), (char*)(old), (size) * sizeof(type))\n-\n-#define FREE_RESOURCE_ARRAY_IN_THREAD(thread, type, old, size)\\\n-  resource_free_bytes(thread, (char*)(old), (size) * sizeof(type))\n+  resource_free_bytes((char*)(old), (size) * sizeof(type))\n@@ -642,2 +639,0 @@\n-  static E* reallocate_malloc(E* addr, size_t new_length, MEMFLAGS flags);\n-\n@@ -673,1 +668,0 @@\n-  static E* reallocate(E* addr, size_t new_length, MEMFLAGS flags);\n","filename":"src\/hotspot\/share\/memory\/allocation.hpp","additions":2,"deletions":8,"binary":false,"changes":10,"status":"modified"},{"patch":"@@ -104,6 +104,1 @@\n-template <class E>\n-E* MallocArrayAllocator<E>::reallocate(E* addr, size_t new_length, MEMFLAGS flags) {\n-  return (E*)ReallocateHeap((char*)addr, size_for(new_length), flags);\n-}\n-\n-template <class E>\n+template<class E>\n@@ -138,5 +133,0 @@\n-template <class E>\n-E* ArrayAllocator<E>::reallocate_malloc(E* addr, size_t new_length, MEMFLAGS flags) {\n-  return MallocArrayAllocator<E>::reallocate(addr, new_length, flags);\n-}\n-\n@@ -145,4 +135,0 @@\n-  if (should_use_malloc(old_length) && should_use_malloc(new_length)) {\n-    return reallocate_malloc(old_addr, new_length, flags);\n-  }\n-\n@@ -164,1 +150,1 @@\n-template <class E>\n+template<class E>\n@@ -169,1 +155,1 @@\n-template <class E>\n+template<class E>\n@@ -174,1 +160,1 @@\n-template <class E>\n+template<class E>\n","filename":"src\/hotspot\/share\/memory\/allocation.inline.hpp","additions":4,"deletions":18,"binary":false,"changes":22,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2002, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2002, 2021, Oracle and\/or its affiliates. All rights reserved.\n@@ -206,0 +206,2 @@\n+ private:\n+  void iterate_over_heap(KlassInfoTable* cit, BoolObjectClosure* filter = NULL);\n","filename":"src\/hotspot\/share\/memory\/heapInspection.hpp","additions":3,"deletions":1,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -236,0 +236,7 @@\n+class CompactibleSpaceClosure : public StackObj {\n+ public:\n+  \/\/ Called for each compactible space\n+  virtual void do_space(CompactibleSpace* s) = 0;\n+};\n+\n+\n","filename":"src\/hotspot\/share\/memory\/iterator.hpp","additions":7,"deletions":0,"binary":false,"changes":7,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 1997, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 1997, 2020, Oracle and\/or its affiliates. All rights reserved.\n@@ -77,2 +77,2 @@\n-extern void resource_free_bytes( Thread* thread, char *old, size_t size ) {\n-  thread->resource_area()->Afree(old, size);\n+extern void resource_free_bytes( char *old, size_t size ) {\n+  Thread::current()->resource_area()->Afree(old, size);\n","filename":"src\/hotspot\/share\/memory\/resourceArea.cpp","additions":3,"deletions":3,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -26,0 +26,1 @@\n+#include \"jvm.h\"\n@@ -40,1 +41,0 @@\n-#include \"jvm.h\"\n","filename":"src\/hotspot\/share\/oops\/constantPool.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -26,0 +26,1 @@\n+#include \"jvm.h\"\n@@ -48,1 +49,0 @@\n-#include \"jvm.h\"\n","filename":"src\/hotspot\/share\/oops\/instanceKlass.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -26,0 +26,1 @@\n+#include \"jvm_io.h\"\n@@ -37,1 +38,0 @@\n-#include \"jvm_io.h\"\n","filename":"src\/hotspot\/share\/oops\/klass.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -26,0 +26,1 @@\n+#include \"jvm.h\"\n@@ -32,1 +33,0 @@\n-#include \"jvm.h\"\n","filename":"src\/hotspot\/share\/oops\/klassVtable.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -347,20 +347,4 @@\n-      if (t->isa_rawptr()) {\n-        ResourceMark rm;\n-        Unique_Node_List worklist;\n-        worklist.push(def);\n-        for (uint i = 0; i < worklist.size(); i++) {\n-          Node* m = worklist.at(i);\n-          if (C->cfg()->_raw_oops.member(m)) {\n-            def->dump();\n-            m->dump();\n-            n->dump();\n-            assert(false, \"there should be an oop in OopMap instead of a live raw oop at safepoint\");\n-          }\n-          \/\/ Check users as well because def might be spilled\n-          for (DUIterator_Fast jmax, j = m->fast_outs(jmax); j < jmax; j++) {\n-            Node* u = m->fast_out(j);\n-            if ((u->is_SpillCopy() && u->in(1) == m) || u->is_Phi()) {\n-              worklist.push(u);\n-            }\n-          }\n-        }\n+      if( t->isa_rawptr() && C->cfg()->_raw_oops.member(def) ) {\n+        def->dump();\n+        n->dump();\n+        assert(false, \"there should be a oop in OopMap instead of a live raw oop at safepoint\");\n","filename":"src\/hotspot\/share\/opto\/buildOopMap.cpp","additions":4,"deletions":20,"binary":false,"changes":24,"status":"modified"},{"patch":"@@ -636,0 +636,7 @@\n+  product(intx, AliasLevel,     3,                                          \\\n+          \"(Deprecated) 0 for no aliasing, \"                                \\\n+          \"1 for oop\/field\/static\/array split, \"                            \\\n+          \"2 for class split, 3 for unique instances\")                      \\\n+          range(0, 3)                                                       \\\n+          constraint(AliasLevelConstraintFunc,AfterErgo)                    \\\n+                                                                            \\\n","filename":"src\/hotspot\/share\/opto\/c2_globals.hpp","additions":7,"deletions":0,"binary":false,"changes":7,"status":"modified"},{"patch":"@@ -742,1 +742,0 @@\n-  case vmIntrinsics::_poly1305_processBlocks:\n","filename":"src\/hotspot\/share\/opto\/c2compiler.cpp","additions":0,"deletions":1,"binary":false,"changes":1,"status":"modified"},{"patch":"@@ -406,6 +406,2 @@\n-  if (inn->isa_oopptr() && _type->isa_oopptr()) {\n-    return ConstraintCastNode::Value(phase);\n-  }\n-\n-  const TypePtr *in_type = inn->isa_ptr();\n-  const TypePtr *my_type = _type->isa_ptr();\n+  const TypePtr *in_type   = inn->isa_ptr();\n+  const TypePtr *my_type   = _type->isa_ptr();\n@@ -413,2 +409,2 @@\n-  if (in_type != NULL && my_type != NULL) {\n-    TypePtr::PTR in_ptr = in_type->ptr();\n+  if( in_type != NULL && my_type != NULL ) {\n+    TypePtr::PTR   in_ptr    = in_type->ptr();\n@@ -417,0 +413,10 @@\n+    } else if (in_ptr == TypePtr::Constant) {\n+      if (my_type->isa_rawptr()) {\n+        result = my_type;\n+      } else {\n+        const TypeOopPtr *jptr = my_type->isa_oopptr();\n+        assert(jptr, \"\");\n+        result = !in_type->higher_equal(_type)\n+          ? my_type->cast_to_ptr_type(TypePtr::NotNull)\n+          : in_type;\n+      }\n@@ -418,1 +424,1 @@\n-      result =  my_type->cast_to_ptr_type(my_type->join_ptr(in_ptr));\n+      result =  my_type->cast_to_ptr_type( my_type->join_ptr(in_ptr) );\n@@ -422,1 +428,55 @@\n-  return result;\n+  \/\/ This is the code from TypePtr::xmeet() that prevents us from\n+  \/\/ having 2 ways to represent the same type. We have to replicate it\n+  \/\/ here because we don't go through meet\/join.\n+  if (result->remove_speculative() == result->speculative()) {\n+    result = result->remove_speculative();\n+  }\n+\n+  \/\/ Same as above: because we don't go through meet\/join, remove the\n+  \/\/ speculative type if we know we won't use it.\n+  return result->cleanup_speculative();\n+\n+  \/\/ JOIN NOT DONE HERE BECAUSE OF INTERFACE ISSUES.\n+  \/\/ FIX THIS (DO THE JOIN) WHEN UNION TYPES APPEAR!\n+\n+  \/\/\n+  \/\/ Remove this code after overnight run indicates no performance\n+  \/\/ loss from not performing JOIN at CheckCastPPNode\n+  \/\/\n+  \/\/ const TypeInstPtr *in_oop = in->isa_instptr();\n+  \/\/ const TypeInstPtr *my_oop = _type->isa_instptr();\n+  \/\/ \/\/ If either input is an 'interface', return destination type\n+  \/\/ assert (in_oop == NULL || in_oop->klass() != NULL, \"\");\n+  \/\/ assert (my_oop == NULL || my_oop->klass() != NULL, \"\");\n+  \/\/ if( (in_oop && in_oop->klass()->is_interface())\n+  \/\/   ||(my_oop && my_oop->klass()->is_interface()) ) {\n+  \/\/   TypePtr::PTR  in_ptr = in->isa_ptr() ? in->is_ptr()->_ptr : TypePtr::BotPTR;\n+  \/\/   \/\/ Preserve cast away nullness for interfaces\n+  \/\/   if( in_ptr == TypePtr::NotNull && my_oop && my_oop->_ptr == TypePtr::BotPTR ) {\n+  \/\/     return my_oop->cast_to_ptr_type(TypePtr::NotNull);\n+  \/\/   }\n+  \/\/   return _type;\n+  \/\/ }\n+  \/\/\n+  \/\/ \/\/ Neither the input nor the destination type is an interface,\n+  \/\/\n+  \/\/ \/\/ history: JOIN used to cause weird corner case bugs\n+  \/\/ \/\/          return (in == TypeOopPtr::NULL_PTR) ? in : _type;\n+  \/\/ \/\/ JOIN picks up NotNull in common instance-of\/check-cast idioms, both oops.\n+  \/\/ \/\/ JOIN does not preserve NotNull in other cases, e.g. RawPtr vs InstPtr\n+  \/\/ const Type *join = in->join(_type);\n+  \/\/ \/\/ Check if join preserved NotNull'ness for pointers\n+  \/\/ if( join->isa_ptr() && _type->isa_ptr() ) {\n+  \/\/   TypePtr::PTR join_ptr = join->is_ptr()->_ptr;\n+  \/\/   TypePtr::PTR type_ptr = _type->is_ptr()->_ptr;\n+  \/\/   \/\/ If there isn't any NotNull'ness to preserve\n+  \/\/   \/\/ OR if join preserved NotNull'ness then return it\n+  \/\/   if( type_ptr == TypePtr::BotPTR  || type_ptr == TypePtr::Null ||\n+  \/\/       join_ptr == TypePtr::NotNull || join_ptr == TypePtr::Constant ) {\n+  \/\/     return join;\n+  \/\/   }\n+  \/\/   \/\/ ELSE return same old type as before\n+  \/\/   return _type;\n+  \/\/ }\n+  \/\/ \/\/ Not joining two pointers\n+  \/\/ return join;\n","filename":"src\/hotspot\/share\/opto\/castnode.cpp","additions":70,"deletions":10,"binary":false,"changes":80,"status":"modified"},{"patch":"@@ -1183,0 +1183,16 @@\n+  \/\/ Until we have harmony between classes and interfaces in the type\n+  \/\/ lattice, we must tread carefully around phis which implicitly\n+  \/\/ convert the one to the other.\n+  const TypePtr* ttp = _type->make_ptr();\n+  const TypeInstPtr* ttip = (ttp != NULL) ? ttp->isa_instptr() : NULL;\n+  const TypeInstKlassPtr* ttkp = (ttp != NULL) ? ttp->isa_instklassptr() : NULL;\n+  bool is_intf = false;\n+  if (ttip != NULL) {\n+    if (ttip->is_interface())\n+      is_intf = true;\n+  }\n+  if (ttkp != NULL) {\n+    if (ttkp->is_interface())\n+      is_intf = true;\n+  }\n+\n@@ -1189,0 +1205,14 @@\n+      \/\/ We assume that each input of an interface-valued Phi is a true\n+      \/\/ subtype of that interface.  This might not be true of the meet\n+      \/\/ of all the input types.  The lattice is not distributive in\n+      \/\/ such cases.  Ward off asserts in type.cpp by refusing to do\n+      \/\/ meets between interfaces and proper classes.\n+      const TypePtr* tip = ti->make_ptr();\n+      const TypeInstPtr* tiip = (tip != NULL) ? tip->isa_instptr() : NULL;\n+      if (tiip) {\n+        bool ti_is_intf = false;\n+        if (tiip->is_interface())\n+          ti_is_intf = true;\n+        if (is_intf != ti_is_intf)\n+          { t = _type; break; }\n+      }\n@@ -1212,3 +1242,25 @@\n-    \/\/ Otherwise it's something stupid like non-overlapping int ranges\n-    \/\/ found on dying counted loops.\n-    assert(ft == Type::TOP, \"\"); \/\/ Canonical empty value\n+\n+    \/\/ Check for evil case of 't' being a class and '_type' expecting an\n+    \/\/ interface.  This can happen because the bytecodes do not contain\n+    \/\/ enough type info to distinguish a Java-level interface variable\n+    \/\/ from a Java-level object variable.  If we meet 2 classes which\n+    \/\/ both implement interface I, but their meet is at 'j\/l\/O' which\n+    \/\/ doesn't implement I, we have no way to tell if the result should\n+    \/\/ be 'I' or 'j\/l\/O'.  Thus we'll pick 'j\/l\/O'.  If this then flows\n+    \/\/ into a Phi which \"knows\" it's an Interface type we'll have to\n+    \/\/ uplift the type.\n+    if (!t->empty() && ttip && ttip->is_interface()) {\n+      assert(ft == _type, \"\"); \/\/ Uplift to interface\n+    } else if (!t->empty() && ttkp && ttkp->is_interface()) {\n+      assert(ft == _type, \"\"); \/\/ Uplift to interface\n+    } else {\n+      \/\/ We also have to handle 'evil cases' of interface- vs. class-arrays\n+      Type::get_arrays_base_elements(jt, _type, NULL, &ttip);\n+      if (!t->empty() && ttip != NULL && ttip->is_interface()) {\n+          assert(ft == _type, \"\");   \/\/ Uplift to array of interface\n+      } else {\n+        \/\/ Otherwise it's something stupid like non-overlapping int ranges\n+        \/\/ found on dying counted loops.\n+        assert(ft == Type::TOP, \"\"); \/\/ Canonical empty value\n+      }\n+    }\n@@ -1219,0 +1271,25 @@\n+    \/\/ If we have an interface-typed Phi and we narrow to a class type, the join\n+    \/\/ should report back the class.  However, if we have a J\/L\/Object\n+    \/\/ class-typed Phi and an interface flows in, it's possible that the meet &\n+    \/\/ join report an interface back out.  This isn't possible but happens\n+    \/\/ because the type system doesn't interact well with interfaces.\n+    const TypePtr *jtp = jt->make_ptr();\n+    const TypeInstPtr *jtip = (jtp != NULL) ? jtp->isa_instptr() : NULL;\n+    const TypeInstKlassPtr *jtkp = (jtp != NULL) ? jtp->isa_instklassptr() : NULL;\n+    if (jtip && ttip) {\n+      if (jtip->is_interface() &&\n+          !ttip->is_interface()) {\n+        assert(ft == ttip->cast_to_ptr_type(jtip->ptr()) ||\n+               ft->isa_narrowoop() && ft->make_ptr() == ttip->cast_to_ptr_type(jtip->ptr()), \"\");\n+        jt = ft;\n+      }\n+    }\n+    if (jtkp && ttkp) {\n+      if (jtkp->is_interface() &&\n+          !jtkp->klass_is_exact() && \/\/ Keep exact interface klass (6894807)\n+          ttkp->is_loaded() && !ttkp->is_interface()) {\n+        assert(ft == ttkp->cast_to_ptr_type(jtkp->ptr()) ||\n+               ft->isa_narrowklass() && ft->make_ptr() == ttkp->cast_to_ptr_type(jtkp->ptr()), \"\");\n+        jt = ft;\n+      }\n+    }\n@@ -2708,2 +2785,3 @@\n-  return (in(0)->is_CatchProj() && in(0)->in(0)->is_Catch() &&\n-          in(0)->in(0)->in(1) == in(1)) ? this : call->in(TypeFunc::Parms);\n+  return ( in(0)->is_CatchProj() && in(0)->in(0)->in(1) == in(1) )\n+    ? this\n+    : call->in(TypeFunc::Parms);\n","filename":"src\/hotspot\/share\/opto\/cfgnode.cpp","additions":83,"deletions":5,"binary":false,"changes":88,"status":"modified"},{"patch":"@@ -24,1 +24,0 @@\n-\n@@ -26,0 +25,1 @@\n+#include \"jvm_io.h\"\n@@ -39,1 +39,0 @@\n-#include \"jvm_io.h\"\n@@ -85,0 +84,1 @@\n+\n@@ -697,1 +697,2 @@\n-  Init(\/*do_aliasing=*\/ true);\n+  Init(::AliasLevel);\n+\n@@ -940,1 +941,1 @@\n-  Init(\/*do_aliasing=*\/ false);\n+  Init(\/*AliasLevel=*\/ 0);\n@@ -962,2 +963,1 @@\n-void Compile::Init(bool aliasing) {\n-  _do_aliasing = aliasing;\n+void Compile::Init(int aliaslevel) {\n@@ -1056,0 +1056,10 @@\n+  \/\/ \/\/ -- Initialize types before each compile --\n+  \/\/ \/\/ Update cached type information\n+  \/\/ if( _method && _method->constants() )\n+  \/\/   Type::update_loaded_types(_method, _method->constants());\n+\n+  \/\/ Init alias_type map.\n+  if (!do_escape_analysis() && aliaslevel == 3) {\n+    aliaslevel = 2;  \/\/ No unique types without escape analysis\n+  }\n+  _AliasLevel = aliaslevel;\n@@ -1292,1 +1302,0 @@\n-  assert(do_aliasing(), \"Aliasing should be enabled\");\n@@ -1324,1 +1333,1 @@\n-  } else if (ta) {\n+  } else if( ta && _AliasLevel >= 2 ) {\n@@ -1395,1 +1404,1 @@\n-  if (to && to != TypeOopPtr::BOTTOM) {\n+  if( to && _AliasLevel >= 2 && to != TypeOopPtr::BOTTOM ) {\n@@ -1498,0 +1507,25 @@\n+  \/\/ Flatten all to bottom for now\n+  switch( _AliasLevel ) {\n+  case 0:\n+    tj = TypePtr::BOTTOM;\n+    break;\n+  case 1:                       \/\/ Flatten to: oop, static, field or array\n+    switch (tj->base()) {\n+    \/\/case Type::AryPtr: tj = TypeAryPtr::RANGE;    break;\n+    case Type::RawPtr:   tj = TypeRawPtr::BOTTOM;   break;\n+    case Type::AryPtr:   \/\/ do not distinguish arrays at all\n+    case Type::InstPtr:  tj = TypeInstPtr::BOTTOM;  break;\n+    case Type::KlassPtr:\n+    case Type::AryKlassPtr:\n+    case Type::InstKlassPtr: tj = TypeInstKlassPtr::OBJECT; break;\n+    case Type::AnyPtr:   tj = TypePtr::BOTTOM;      break;  \/\/ caller checks it\n+    default: ShouldNotReachHere();\n+    }\n+    break;\n+  case 2:                       \/\/ No collapsing at level 2; keep all splits\n+  case 3:                       \/\/ No collapsing at level 3; keep all splits\n+    break;\n+  default:\n+    Unimplemented();\n+  }\n+\n@@ -1604,1 +1638,1 @@\n-  if (!do_aliasing()) {\n+  if (_AliasLevel == 0)\n@@ -1606,1 +1640,0 @@\n-  }\n@@ -4202,54 +4235,0 @@\n-\/\/------------------------------verify_bidirectional_edges---------------------\n-\/\/ For each input edge to a node (ie - for each Use-Def edge), verify that\n-\/\/ there is a corresponding Def-Use edge.\n-void Compile::verify_bidirectional_edges(Unique_Node_List &visited) {\n-  \/\/ Allocate stack of size C->live_nodes()\/16 to avoid frequent realloc\n-  uint stack_size = live_nodes() >> 4;\n-  Node_List nstack(MAX2(stack_size, (uint)OptoNodeListSize));\n-  nstack.push(_root);\n-\n-  while (nstack.size() > 0) {\n-    Node* n = nstack.pop();\n-    if (visited.member(n)) {\n-      continue;\n-    }\n-    visited.push(n);\n-\n-    \/\/ Walk over all input edges, checking for correspondence\n-    uint length = n->len();\n-    for (uint i = 0; i < length; i++) {\n-      Node* in = n->in(i);\n-      if (in != NULL && !visited.member(in)) {\n-        nstack.push(in); \/\/ Put it on stack\n-      }\n-      if (in != NULL && !in->is_top()) {\n-        \/\/ Count instances of `next`\n-        int cnt = 0;\n-        for (uint idx = 0; idx < in->_outcnt; idx++) {\n-          if (in->_out[idx] == n) {\n-            cnt++;\n-          }\n-        }\n-        assert(cnt > 0, \"Failed to find Def-Use edge.\");\n-        \/\/ Check for duplicate edges\n-        \/\/ walk the input array downcounting the input edges to n\n-        for (uint j = 0; j < length; j++) {\n-          if (n->in(j) == in) {\n-            cnt--;\n-          }\n-        }\n-        assert(cnt == 0, \"Mismatched edge count.\");\n-      } else if (in == NULL) {\n-        assert(i == 0 || i >= n->req() ||\n-               n->is_Region() || n->is_Phi() || n->is_ArrayCopy() ||\n-               (n->is_Unlock() && i == (n->req() - 1)) ||\n-               (n->is_MemBar() && i == 5), \/\/ the precedence edge to a membar can be removed during macro node expansion\n-              \"only region, phi, arraycopy, unlock or membar nodes have null data edges\");\n-      } else {\n-        assert(in->is_top(), \"sanity\");\n-        \/\/ Nothing to check.\n-      }\n-    }\n-  }\n-}\n-\n@@ -4262,3 +4241,2 @@\n-\n-    \/\/ Call graph walk to check edges\n-    verify_bidirectional_edges(visited);\n+    \/\/ Call recursive graph walk to check edges\n+    _root->verify_edges(visited);\n","filename":"src\/hotspot\/share\/opto\/compile.cpp","additions":46,"deletions":68,"binary":false,"changes":114,"status":"modified"},{"patch":"@@ -330,1 +330,1 @@\n-  bool                  _do_aliasing;           \/\/ True if we intend to do aliasing\n+  int                   _AliasLevel;            \/\/ Locally-adjusted version of AliasLevel flag.\n@@ -619,1 +619,1 @@\n-  bool              do_aliasing() const          { return _do_aliasing; }\n+  int               AliasLevel() const           { return _AliasLevel; }\n@@ -1106,1 +1106,3 @@\n-  void Init(bool aliasing);                      \/\/ Prepare for a single compilation\n+  void Init(int aliaslevel);                     \/\/ Prepare for a single compilation\n+  int  Inline_Warm();                            \/\/ Find more inlining work.\n+  void Finish_Warm();                            \/\/ Give up on further inlines.\n@@ -1167,3 +1169,0 @@\n-  \/\/ Verify bi-directional correspondence of edges\n-  void verify_bidirectional_edges(Unique_Node_List &visited);\n-\n","filename":"src\/hotspot\/share\/opto\/compile.hpp","additions":5,"deletions":6,"binary":false,"changes":11,"status":"modified"},{"patch":"@@ -600,1 +600,1 @@\n-    Node* cls_node = makecon(TypeKlassPtr::make(receiver_constraint, Type::trust_interfaces));\n+    Node* cls_node = makecon(TypeKlassPtr::make(receiver_constraint));\n","filename":"src\/hotspot\/share\/opto\/doCall.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -358,2 +358,2 @@\n-  if (has_scalar_replaceable_candidates && EliminateAllocations) {\n-    assert(C->do_aliasing(), \"Aliasing should be enabled\");\n+  if (has_scalar_replaceable_candidates &&\n+      C->AliasLevel() >= 3 && EliminateAllocations) {\n@@ -377,0 +377,2 @@\n+    } else if(C->AliasLevel() < 3) {\n+      tty->print(\" since AliasLevel < 3 ===\");\n@@ -1169,1 +1171,0 @@\n-                  strcmp(call->as_CallLeaf()->_name, \"poly1305_processBlocks\") == 0 ||\n","filename":"src\/hotspot\/share\/opto\/escape.cpp","additions":4,"deletions":3,"binary":false,"changes":7,"status":"modified"},{"patch":"@@ -591,1 +591,1 @@\n-  if (load_alias_idx == Compile::AliasIdxBot && C->do_aliasing() &&\n+  if (load_alias_idx == Compile::AliasIdxBot && C->AliasLevel() > 0 &&\n","filename":"src\/hotspot\/share\/opto\/gcm.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -2185,1 +2185,1 @@\n-    const TypeKlassPtr* tklass = TypeKlassPtr::make(exact_kls, Type::trust_interfaces);\n+    const TypeKlassPtr* tklass = TypeKlassPtr::make(exact_kls);\n@@ -2639,1 +2639,1 @@\n-  cmp = gvn.transform(cmp);\n+  gvn.transform(cmp);\n@@ -2847,1 +2847,1 @@\n-  const TypeKlassPtr* tklass = TypeKlassPtr::make(klass, Type::trust_interfaces);\n+  const TypeKlassPtr* tklass = TypeKlassPtr::make(klass);\n@@ -2876,1 +2876,1 @@\n-  const TypeKlassPtr* tklass = TypeKlassPtr::make(klass, Type::trust_interfaces)->try_improve();\n+  const TypeKlassPtr* tklass = TypeKlassPtr::make(klass);\n@@ -2999,1 +2999,1 @@\n-        C->static_subtype_check(require_klass, TypeKlassPtr::make(exact_kls, Type::trust_interfaces)) == Compile::SSC_always_true) {\n+        C->static_subtype_check(require_klass, TypeKlassPtr::make(exact_kls)) == Compile::SSC_always_true) {\n@@ -3185,2 +3185,2 @@\n-  const TypeKlassPtr *tk = _gvn.type(superklass)->is_klassptr()->try_improve();\n-  const TypeOopPtr *toop = tk->cast_to_exactness(false)->as_instance_type();\n+  const TypeKlassPtr *tk = _gvn.type(superklass)->is_klassptr();\n+  const Type *toop = tk->cast_to_exactness(false)->as_instance_type();\n","filename":"src\/hotspot\/share\/opto\/graphKit.cpp","additions":7,"deletions":7,"binary":false,"changes":14,"status":"modified"},{"patch":"@@ -503,1 +503,3 @@\n-      if (toop) {\n+      if ((toop != NULL && toop->is_interface()) || (tkls != NULL && tkls->is_interface())) {\n+        s2.print(\"  Interface:\");\n+      } else if (toop) {\n","filename":"src\/hotspot\/share\/opto\/idealGraphPrinter.cpp","additions":3,"deletions":1,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -615,2 +615,0 @@\n-  case vmIntrinsics::_poly1305_processBlocks:\n-    return inline_poly1305_processBlocks();\n@@ -1793,0 +1791,1 @@\n+#define FN_PTR(f) CAST_FROM_FN_PTR(address, f)\n@@ -1794,0 +1793,1 @@\n+    \/\/ These intrinsics are not properly supported on all hardware\n@@ -1797,1 +1797,1 @@\n-      runtime_math(OptoRuntime::Math_D_D_Type(), CAST_FROM_FN_PTR(address, SharedRuntime::dsin),   \"SIN\");\n+      runtime_math(OptoRuntime::Math_D_D_Type(), FN_PTR(SharedRuntime::dsin),   \"SIN\");\n@@ -1801,1 +1801,1 @@\n-      runtime_math(OptoRuntime::Math_D_D_Type(), CAST_FROM_FN_PTR(address, SharedRuntime::dcos),   \"COS\");\n+      runtime_math(OptoRuntime::Math_D_D_Type(), FN_PTR(SharedRuntime::dcos),   \"COS\");\n@@ -1805,5 +1805,1 @@\n-      runtime_math(OptoRuntime::Math_D_D_Type(), CAST_FROM_FN_PTR(address, SharedRuntime::dtan), \"TAN\");\n-  case vmIntrinsics::_dexp:\n-    return StubRoutines::dexp() != NULL ?\n-      runtime_math(OptoRuntime::Math_D_D_Type(), StubRoutines::dexp(),  \"dexp\") :\n-      runtime_math(OptoRuntime::Math_D_D_Type(), CAST_FROM_FN_PTR(address, SharedRuntime::dexp),  \"EXP\");\n+      runtime_math(OptoRuntime::Math_D_D_Type(), FN_PTR(SharedRuntime::dtan), \"TAN\");\n@@ -1813,1 +1809,1 @@\n-      runtime_math(OptoRuntime::Math_D_D_Type(), CAST_FROM_FN_PTR(address, SharedRuntime::dlog),   \"LOG\");\n+      runtime_math(OptoRuntime::Math_D_D_Type(), FN_PTR(SharedRuntime::dlog),   \"LOG\");\n@@ -1817,1 +1813,1 @@\n-      runtime_math(OptoRuntime::Math_D_D_Type(), CAST_FROM_FN_PTR(address, SharedRuntime::dlog10), \"LOG10\");\n+      runtime_math(OptoRuntime::Math_D_D_Type(), FN_PTR(SharedRuntime::dlog10), \"LOG10\");\n@@ -1819,0 +1815,1 @@\n+    \/\/ These intrinsics are supported on all hardware\n@@ -1832,0 +1829,6 @@\n+  case vmIntrinsics::_dexp:\n+    return StubRoutines::dexp() != NULL ?\n+      runtime_math(OptoRuntime::Math_D_D_Type(), StubRoutines::dexp(),  \"dexp\") :\n+      runtime_math(OptoRuntime::Math_D_D_Type(), FN_PTR(SharedRuntime::dexp),  \"EXP\");\n+#undef FN_PTR\n+\n@@ -3664,1 +3667,1 @@\n-      int static_res = C->static_subtype_check(TypeKlassPtr::make(tm->as_klass(), Type::trust_interfaces), tp->as_klass_type());\n+      int static_res = C->static_subtype_check(TypeKlassPtr::make(tm->as_klass()), tp->as_klass_type());\n@@ -5302,1 +5305,1 @@\n-  if (!C->do_aliasing())     return NULL;  \/\/ no MergeMems around\n+  if (C->AliasLevel() == 0)  return NULL;  \/\/ no MergeMems around\n@@ -6967,36 +6970,0 @@\n-bool LibraryCallKit::inline_poly1305_processBlocks() {\n-  address stubAddr;\n-  const char *stubName;\n-  assert(UsePolyIntrinsics, \"need Poly intrinsics support\");\n-  assert(callee()->signature()->size() == 5, \"poly1305_processBlocks has %d parameters\", callee()->signature()->size());\n-  stubAddr = StubRoutines::poly1305_processBlocks();\n-  stubName = \"poly1305_processBlocks\";\n-\n-  if (!stubAddr) return false;\n-  null_check_receiver();  \/\/ null-check receiver\n-  if (stopped())  return true;\n-\n-  Node* input = argument(1);\n-  Node* input_offset = argument(2);\n-  Node* len = argument(3);\n-  Node* alimbs = argument(4);\n-  Node* rlimbs = argument(5);\n-\n-  input = must_be_not_null(input, true);\n-  alimbs = must_be_not_null(alimbs, true);\n-  rlimbs = must_be_not_null(rlimbs, true);\n-\n-  Node* input_start = array_element_address(input, input_offset, T_BYTE);\n-  assert(input_start, \"input array is NULL\");\n-  Node* acc_start = array_element_address(alimbs, intcon(0), T_LONG);\n-  assert(acc_start, \"acc array is NULL\");\n-  Node* r_start = array_element_address(rlimbs, intcon(0), T_LONG);\n-  assert(r_start, \"r array is NULL\");\n-\n-  Node* call = make_runtime_call(RC_LEAF | RC_NO_FP,\n-                                 OptoRuntime::poly1305_processBlocks_Type(),\n-                                 stubAddr, stubName, TypePtr::BOTTOM,\n-                                 input_start, len, acc_start, r_start);\n-  return true;\n-}\n-\n@@ -7042,1 +7009,1 @@\n-  Node* block_size = NULL;\n+  Node* digest_length = NULL;\n@@ -7076,2 +7043,2 @@\n-    block_size = get_block_size_from_digest_object(digestBase_obj);\n-    if (block_size == NULL) return false;\n+    digest_length = get_digest_length_from_digest_object(digestBase_obj);\n+    if (digest_length == NULL) return false;\n@@ -7090,1 +7057,1 @@\n-  if (block_size == NULL) {\n+  if (digest_length == NULL) {\n@@ -7097,1 +7064,1 @@\n-                             src_start, state, block_size);\n+                             src_start, state, digest_length);\n@@ -7202,1 +7169,1 @@\n-  const TypeOopPtr* xtype = aklass->cast_to_exactness(false)->as_instance_type()->cast_to_ptr_type(TypePtr::NotNull);\n+  const TypeOopPtr* xtype = aklass->as_instance_type()->cast_to_ptr_type(TypePtr::NotNull);\n@@ -7209,1 +7176,1 @@\n-  Node* block_size = NULL;\n+  Node* digest_length = NULL;\n@@ -7211,2 +7178,2 @@\n-    block_size = get_block_size_from_digest_object(digest_obj);\n-    if (block_size == NULL) return false;\n+    digest_length = get_digest_length_from_digest_object(digest_obj);\n+    if (digest_length == NULL) return false;\n@@ -7217,1 +7184,1 @@\n-  if (block_size == NULL) {\n+  if (digest_length == NULL) {\n@@ -7226,1 +7193,1 @@\n-                             src_start, state, block_size, ofs, limit);\n+                             src_start, state, digest_length, ofs, limit);\n@@ -7383,5 +7350,5 @@\n-\/\/------------------------------get_block_size_from_sha3_object----------------------------------\n-Node * LibraryCallKit::get_block_size_from_digest_object(Node *digest_object) {\n-  Node* block_size = load_field_from_object(digest_object, \"blockSize\", \"I\");\n-  assert (block_size != NULL, \"sanity\");\n-  return block_size;\n+\/\/------------------------------get_digest_length_from_sha3_object----------------------------------\n+Node * LibraryCallKit::get_digest_length_from_digest_object(Node *digest_object) {\n+  Node* digest_length = load_field_from_object(digest_object, \"digestLength\", \"I\");\n+  assert (digest_length != NULL, \"sanity\");\n+  return digest_length;\n","filename":"src\/hotspot\/share\/opto\/library_call.cpp","additions":32,"deletions":65,"binary":false,"changes":97,"status":"modified"},{"patch":"@@ -296,1 +296,0 @@\n-  bool inline_poly1305_processBlocks();\n@@ -303,1 +302,1 @@\n-  Node* get_block_size_from_digest_object(Node *digestBase_object);\n+  Node* get_digest_length_from_digest_object(Node *digestBase_object);\n","filename":"src\/hotspot\/share\/opto\/library_call.hpp","additions":1,"deletions":2,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -4183,2 +4183,0 @@\n-\/\/ Goes over all children of the root of the loop tree, collects all controls for the loop and its inner loops then\n-\/\/ checks whether any control is a branch out of the loop and if it is, whether it's not a NeverBranch.\n@@ -4187,19 +4185,9 @@\n-    Unique_Node_List wq;\n-    Node* head = l->_head;\n-    assert(head->is_Region(), \"\");\n-    for (uint i = 1; i < head->req(); ++i) {\n-      Node* in = head->in(i);\n-      if (get_loop(in) != _ltree_root) {\n-        wq.push(in);\n-      }\n-    }\n-    for (uint i = 0; i < wq.size(); ++i) {\n-      Node* c = wq.at(i);\n-      if (c == head) {\n-        continue;\n-      } else if (c->is_Region()) {\n-        for (uint j = 1; j < c->req(); ++j) {\n-          wq.push(c->in(j));\n-        }\n-      } else {\n-        wq.push(c->in(0));\n+    uint i = 1;\n+    for (; i < C->root()->req(); i++) {\n+      Node* in = C->root()->in(i);\n+      if (in != NULL &&\n+          in->Opcode() == Op_Halt &&\n+          in->in(0)->is_Proj() &&\n+          in->in(0)->in(0)->Opcode() == Op_NeverBranch &&\n+          in->in(0)->in(0)->in(0) == l->_head) {\n+        break;\n@@ -4208,12 +4196,2 @@\n-    assert(wq.member(head), \"\");\n-    for (uint i = 0; i < wq.size(); ++i) {\n-      Node* c = wq.at(i);\n-      if (c->is_MultiBranch()) {\n-        for (DUIterator_Fast jmax, j = c->fast_outs(jmax); j < jmax; j++) {\n-          Node* u = c->fast_out(j);\n-          assert(u->is_CFG(), \"\");\n-          if (!wq.member(u) && c->Opcode() != Op_NeverBranch) {\n-            return false;\n-          }\n-        }\n-      }\n+    if (i == C->root()->req()) {\n+      return false;\n@@ -4222,0 +4200,1 @@\n+\n@@ -4236,2 +4215,0 @@\n-  bool do_max_unroll = (_mode == LoopOptsMaxUnroll);\n-\n@@ -4307,2 +4284,2 @@\n-  bool stop_early = !C->has_loops() && !skip_loop_opts && !do_split_ifs && !do_max_unroll && !_verify_me &&\n-          !_verify_only && !bs->is_gc_specific_loop_opts_pass(_mode);\n+  bool stop_early = !C->has_loops() && !skip_loop_opts && !do_split_ifs && !_verify_me && !_verify_only &&\n+    !bs->is_gc_specific_loop_opts_pass(_mode);\n@@ -4447,1 +4424,1 @@\n-  if (do_max_unroll) {\n+  if (_mode == LoopOptsMaxUnroll) {\n@@ -5918,5 +5895,0 @@\n-  \/\/ Don't extend live ranges of raw oops\n-  if (least != early && n->is_ConstraintCast() && n->in(1)->bottom_type()->isa_rawptr() &&\n-      !n->bottom_type()->isa_rawptr()) {\n-    least = early;\n-  }\n@@ -6020,1 +5992,8 @@\n-  dump_idoms(early, LCA);\n+  tty->cr();\n+  tty->print_cr(\"idoms of early %d:\", early->_idx);\n+  dump_idom(early);\n+  tty->cr();\n+  tty->print_cr(\"idoms of (wrong) LCA %d:\", LCA->_idx);\n+  dump_idom(LCA);\n+  tty->cr();\n+  dump_real_LCA(early, LCA);\n@@ -6024,24 +6003,5 @@\n-\/\/ Class to compute the real LCA given an early node and a wrong LCA in a bad graph.\n-class RealLCA {\n-  const PhaseIdealLoop* _phase;\n-  Node* _early;\n-  Node* _wrong_lca;\n-  uint _early_index;\n-  int _wrong_lca_index;\n-\n-  \/\/ Given idom chains of early and wrong LCA: Walk through idoms starting at StartNode and find the first node which\n-  \/\/ is different: Return the previously visited node which must be the real LCA.\n-  \/\/ The node lists also contain _early and _wrong_lca, respectively.\n-  Node* find_real_lca(Unique_Node_List& early_with_idoms, Unique_Node_List& wrong_lca_with_idoms) {\n-    int early_index = early_with_idoms.size() - 1;\n-    int wrong_lca_index = wrong_lca_with_idoms.size() - 1;\n-    bool found_difference = false;\n-    do {\n-      if (early_with_idoms[early_index] != wrong_lca_with_idoms[wrong_lca_index]) {\n-        \/\/ First time early and wrong LCA idoms differ. Real LCA must be at the previous index.\n-        found_difference = true;\n-        break;\n-      }\n-      early_index--;\n-      wrong_lca_index--;\n-    } while (wrong_lca_index >= 0);\n+\/\/ Find the real LCA of early and the wrongly assumed LCA.\n+void PhaseIdealLoop::dump_real_LCA(Node* early, Node* wrong_lca) {\n+  assert(!is_dominator(early, wrong_lca) && !is_dominator(early, wrong_lca),\n+         \"sanity check that one node does not dominate the other\");\n+  assert(!has_ctrl(early) && !has_ctrl(wrong_lca), \"sanity check, no data nodes\");\n@@ -6049,6 +6009,32 @@\n-    assert(early_index >= 0, \"must always find an LCA - cannot be early\");\n-    _early_index = early_index;\n-    _wrong_lca_index = wrong_lca_index;\n-    Node* real_lca = early_with_idoms[_early_index + 1]; \/\/ Plus one to skip _early.\n-    assert(found_difference || real_lca == _wrong_lca, \"wrong LCA dominates early and is therefore the real LCA\");\n-    return real_lca;\n+  ResourceMark rm;\n+  Node_List nodes_seen;\n+  Node* real_LCA = NULL;\n+  Node* n1 = wrong_lca;\n+  Node* n2 = early;\n+  uint count_1 = 0;\n+  uint count_2 = 0;\n+  \/\/ Add early and wrong_lca to simplify calculation of idom indices\n+  nodes_seen.push(n1);\n+  nodes_seen.push(n2);\n+\n+  \/\/ Walk the idom chain up from early and wrong_lca and stop when they intersect.\n+  while (!n1->is_Start() && !n2->is_Start()) {\n+    n1 = idom(n1);\n+    n2 = idom(n2);\n+    if (n1 == n2) {\n+      \/\/ Both idom chains intersect at the same index\n+      real_LCA = n1;\n+      count_1 = nodes_seen.size() \/ 2;\n+      count_2 = count_1;\n+      break;\n+    }\n+    if (check_idom_chains_intersection(n1, count_1, count_2, &nodes_seen)) {\n+      real_LCA = n1;\n+      break;\n+    }\n+    if (check_idom_chains_intersection(n2, count_2, count_1, &nodes_seen)) {\n+      real_LCA = n2;\n+      break;\n+    }\n+    nodes_seen.push(n1);\n+    nodes_seen.push(n2);\n@@ -6057,8 +6043,4 @@\n-  void dump(Node* real_lca) {\n-    tty->cr();\n-    tty->print_cr(\"idoms of early \\\"%d %s\\\":\", _early->_idx, _early->Name());\n-    _phase->dump_idom(_early, _early_index + 1);\n-\n-    tty->cr();\n-    tty->print_cr(\"idoms of (wrong) LCA \\\"%d %s\\\":\", _wrong_lca->_idx, _wrong_lca->Name());\n-    _phase->dump_idom(_wrong_lca, _wrong_lca_index + 1);\n+  assert(real_LCA != NULL, \"must always find an LCA\");\n+  tty->print_cr(\"Real LCA of early %d (idom[%d]) and (wrong) LCA %d (idom[%d]):\", early->_idx, count_2, wrong_lca->_idx, count_1);\n+  real_LCA->dump();\n+}\n@@ -6066,5 +6048,14 @@\n-    tty->cr();\n-    tty->print(\"Real LCA of early \\\"%d %s\\\" (idom[%d]) and wrong LCA \\\"%d %s\\\"\",\n-               _early->_idx, _early->Name(), _early_index, _wrong_lca->_idx, _wrong_lca->Name());\n-    if (_wrong_lca_index >= 0) {\n-      tty->print(\" (idom[%d])\", _wrong_lca_index);\n+\/\/ Check if n is already on nodes_seen (i.e. idom chains of early and wrong_lca intersect at n). Determine the idom index of n\n+\/\/ on both idom chains and return them in idom_idx_new and idom_idx_other, respectively.\n+bool PhaseIdealLoop::check_idom_chains_intersection(const Node* n, uint& idom_idx_new, uint& idom_idx_other, const Node_List* nodes_seen) const {\n+  if (nodes_seen->contains(n)) {\n+    \/\/ The idom chain has just discovered n.\n+    \/\/ Divide by 2 because nodes_seen contains the same amount of nodes from both chains.\n+    idom_idx_new = nodes_seen->size() \/ 2;\n+\n+    \/\/ The other chain already contained n. Search the index.\n+    for (uint i = 0; i < nodes_seen->size(); i++) {\n+      if (nodes_seen->at(i) == n) {\n+        \/\/ Divide by 2 because nodes_seen contains the same amount of nodes from both chains.\n+        idom_idx_other = i \/ 2;\n+      }\n@@ -6072,8 +6063,1 @@\n-    tty->print_cr(\":\");\n-    real_lca->dump();\n-  }\n-\n- public:\n-  RealLCA(const PhaseIdealLoop* phase, Node* early, Node* wrong_lca)\n-      : _phase(phase), _early(early), _wrong_lca(wrong_lca), _early_index(0), _wrong_lca_index(0) {\n-    assert(!wrong_lca->is_Start(), \"StartNode is always a common dominator\");\n+    return true;\n@@ -6081,21 +6065,1 @@\n-\n-  void compute_and_dump() {\n-    ResourceMark rm;\n-    Unique_Node_List early_with_idoms;\n-    Unique_Node_List wrong_lca_with_idoms;\n-    early_with_idoms.push(_early);\n-    wrong_lca_with_idoms.push(_wrong_lca);\n-    _phase->get_idoms(_early, 10000, early_with_idoms);\n-    _phase->get_idoms(_wrong_lca, 10000, wrong_lca_with_idoms);\n-    Node* real_lca = find_real_lca(early_with_idoms, wrong_lca_with_idoms);\n-    dump(real_lca);\n-  }\n-};\n-\n-\/\/ Dump the idom chain of early, of the wrong LCA and dump the real LCA of early and wrong LCA.\n-void PhaseIdealLoop::dump_idoms(Node* early, Node* wrong_lca) {\n-  assert(!is_dominator(early, wrong_lca), \"sanity check that early does not dominate wrong lca\");\n-  assert(!has_ctrl(early) && !has_ctrl(wrong_lca), \"sanity check, no data nodes\");\n-\n-  RealLCA real_lca(this, early, wrong_lca);\n-  real_lca.compute_and_dump();\n+  return false;\n@@ -6174,1 +6138,1 @@\n-void PhaseIdealLoop::dump_idom(Node* n, const uint count) const {\n+void PhaseIdealLoop::dump_idom(Node* n) const {\n@@ -6178,23 +6142,4 @@\n-    ResourceMark rm;\n-    Unique_Node_List idoms;\n-    get_idoms(n, count, idoms);\n-    dump_idoms_in_reverse(n, idoms);\n-  }\n-}\n-\n-void PhaseIdealLoop::get_idoms(Node* n, const uint count, Unique_Node_List& idoms) const {\n-  Node* next = n;\n-  for (uint i = 0; !next->is_Start() && i < count; i++) {\n-    next = idom(next);\n-    assert(!idoms.member(next), \"duplicated idom is not possible\");\n-    idoms.push(next);\n-  }\n-}\n-\n-void PhaseIdealLoop::dump_idoms_in_reverse(const Node* n, const Node_List& idom_list) const {\n-  Node* next;\n-  uint padding = 3;\n-  uint node_index_padding_width = static_cast<int>(log10(C->unique())) + 1;\n-  for (int i = idom_list.size() - 1; i >= 0; i--) {\n-    if (i == 9 || i == 99) {\n-      padding++;\n+    for (int i = 0; i < 100 && !n->is_Start(); i++) {\n+      tty->print(\"idom[%d] \", i);\n+      n->dump();\n+      n = idom(n);\n@@ -6202,2 +6147,0 @@\n-    next = idom_list[i];\n-    tty->print_cr(\"idom[%d]:%*c%*d  %s\", i, padding, ' ', node_index_padding_width, next->_idx, next->Name());\n@@ -6205,1 +6148,0 @@\n-  tty->print_cr(\"n:      %*c%*d  %s\", padding, ' ', node_index_padding_width, n->_idx, n->Name());\n","filename":"src\/hotspot\/share\/opto\/loopnode.cpp","additions":85,"deletions":143,"binary":false,"changes":228,"status":"modified"},{"patch":"@@ -1659,2 +1659,4 @@\n-  DEBUG_ONLY(void dump_idoms(Node* early, Node* wrong_lca);)\n-  NOT_PRODUCT(void dump_idoms_in_reverse(const Node* n, const Node_List& idom_list) const;)\n+#ifdef ASSERT\n+  void dump_real_LCA(Node* early, Node* wrong_lca);\n+  bool check_idom_chains_intersection(const Node* n, uint& idom_idx_new, uint& idom_idx_other, const Node_List* nodes_seen) const;\n+#endif\n@@ -1673,3 +1675,1 @@\n-  void dump_idom(Node* n) const { dump_idom(n, 1000); } \/\/ For debugging\n-  void dump_idom(Node* n, uint count) const;\n-  void get_idoms(Node* n, uint count, Unique_Node_List& idoms) const;\n+  void dump_idom(Node* n) const;\n","filename":"src\/hotspot\/share\/opto\/loopnode.hpp","additions":5,"deletions":5,"binary":false,"changes":10,"status":"modified"},{"patch":"@@ -1575,0 +1575,3 @@\n+  bool is_raw_to_oop_cast = n->is_ConstraintCast() &&\n+                            n->in(1)->bottom_type()->isa_rawptr() &&\n+                            !n->bottom_type()->isa_rawptr();\n@@ -1581,0 +1584,1 @@\n+      !is_raw_to_oop_cast && \/\/ don't extend live ranges of raw oops\n@@ -2155,3 +2159,3 @@\n-static void collect_nodes_in_outer_loop_not_reachable_from_sfpt(Node* n, const IdealLoopTree *loop, const IdealLoopTree* outer_loop,\n-                                                                const Node_List &old_new, Unique_Node_List& wq, PhaseIdealLoop* phase,\n-                                                                bool check_old_new) {\n+static void clone_outer_loop_helper(Node* n, const IdealLoopTree *loop, const IdealLoopTree* outer_loop,\n+                                    const Node_List &old_new, Unique_Node_List& wq, PhaseIdealLoop* phase,\n+                                    bool check_old_new) {\n@@ -2164,13 +2168,11 @@\n-      assert(!loop->is_member(u_loop) || !loop->_body.contains(u), \"can be in outer loop or out of both loops only\");\n-      if (!loop->is_member(u_loop)) {\n-        if (outer_loop->is_member(u_loop)) {\n-          wq.push(u);\n-        } else {\n-          \/\/ nodes pinned with control in the outer loop but not referenced from the safepoint must be moved out of\n-          \/\/ the outer loop too\n-          Node* u_c = u->in(0);\n-          if (u_c != NULL) {\n-            IdealLoopTree* u_c_loop = phase->get_loop(u_c);\n-            if (outer_loop->is_member(u_c_loop) && !loop->is_member(u_c_loop)) {\n-              wq.push(u);\n-            }\n+      assert(!loop->is_member(u_loop), \"can be in outer loop or out of both loops only\");\n+      if (outer_loop->is_member(u_loop)) {\n+        wq.push(u);\n+      } else {\n+        \/\/ nodes pinned with control in the outer loop but not referenced from the safepoint must be moved out of\n+        \/\/ the outer loop too\n+        Node* u_c = u->in(0);\n+        if (u_c != NULL) {\n+          IdealLoopTree* u_c_loop = phase->get_loop(u_c);\n+          if (outer_loop->is_member(u_c_loop) && !loop->is_member(u_c_loop)) {\n+            wq.push(u);\n@@ -2295,6 +2297,1 @@\n-      collect_nodes_in_outer_loop_not_reachable_from_sfpt(old, loop, outer_loop, old_new, wq, this, true);\n-    }\n-\n-    for (uint i = 0; i < loop->_body.size(); i++) {\n-      Node* old = loop->_body.at(i);\n-      collect_nodes_in_outer_loop_not_reachable_from_sfpt(old, loop, outer_loop, old_new, wq, this, true);\n+      clone_outer_loop_helper(old, loop, outer_loop, old_new, wq, this, true);\n@@ -2305,1 +2302,1 @@\n-      collect_nodes_in_outer_loop_not_reachable_from_sfpt(inner_out, loop, outer_loop, old_new, wq, this, true);\n+      clone_outer_loop_helper(inner_out, loop, outer_loop, old_new, wq, this, true);\n@@ -2316,1 +2313,1 @@\n-      collect_nodes_in_outer_loop_not_reachable_from_sfpt(n, loop, outer_loop, old_new, wq, this, false);\n+      clone_outer_loop_helper(n, loop, outer_loop, old_new, wq, this, false);\n","filename":"src\/hotspot\/share\/opto\/loopopts.cpp","additions":21,"deletions":24,"binary":false,"changes":45,"status":"modified"},{"patch":"@@ -2035,1 +2035,1 @@\n-        return ss ? TypeKlassPtr::make(ss, Type::trust_interfaces) : TypePtr::NULL_PTR;\n+        return ss ? TypeKlassPtr::make(ss) : TypePtr::NULL_PTR;\n@@ -2066,1 +2066,1 @@\n-          return ss ? TypeKlassPtr::make(ss, Type::trust_interfaces) : TypePtr::NULL_PTR;\n+          return ss ? TypeKlassPtr::make(ss) : TypePtr::NULL_PTR;\n@@ -2326,1 +2326,1 @@\n-          return TypeKlassPtr::make(ciArrayKlass::make(t), Type::trust_interfaces);\n+          return TypeKlassPtr::make(ciArrayKlass::make(t));\n@@ -2333,1 +2333,1 @@\n-        return TypeKlassPtr::make(t->as_klass(), Type::trust_interfaces);\n+        return TypeKlassPtr::make(t->as_klass());\n@@ -2371,1 +2371,1 @@\n-      return sup ? TypeKlassPtr::make(sup, Type::trust_interfaces) : TypePtr::NULL_PTR;\n+      return sup ? TypeKlassPtr::make(sup) : TypePtr::NULL_PTR;\n@@ -4909,1 +4909,1 @@\n-         alias_idx == Compile::AliasIdxBot && !Compile::current()->do_aliasing(),\n+         alias_idx == Compile::AliasIdxBot && Compile::current()->AliasLevel() == 0,\n@@ -4922,1 +4922,1 @@\n-           || !Compile::current()->do_aliasing(),\n+           || Compile::current()->AliasLevel() == 0,\n@@ -4924,1 +4924,1 @@\n-    \/\/ do_aliasing == false if we are organizing the memory states manually.\n+    \/\/ AliasLevel == 0 if we are organizing the memory states manually.\n","filename":"src\/hotspot\/share\/opto\/memnode.cpp","additions":8,"deletions":8,"binary":false,"changes":16,"status":"modified"},{"patch":"@@ -788,1 +788,1 @@\n-           _oop_alias_idx == Compile::AliasIdxBot && !Compile::current()->do_aliasing(),\n+           _oop_alias_idx == Compile::AliasIdxBot && Compile::current()->AliasLevel() == 0,\n","filename":"src\/hotspot\/share\/opto\/memnode.hpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -2557,1 +2557,4 @@\n-    if (toop) {\n+    ciKlass*           klass = toop ? toop->instance_klass() : (tkls ? tkls->instance_klass() : NULL );\n+    if (klass && klass->is_loaded() && ((toop && toop->is_interface()) || (tkls && tkls->is_interface()))) {\n+      st->print(\"  Interface:\");\n+    } else if (toop) {\n@@ -2680,0 +2683,45 @@\n+\/\/ For each input edge to a node (ie - for each Use-Def edge), verify that\n+\/\/ there is a corresponding Def-Use edge.\n+\/\/------------------------------verify_edges-----------------------------------\n+void Node::verify_edges(Unique_Node_List &visited) {\n+  uint i, j, idx;\n+  int  cnt;\n+  Node *n;\n+\n+  \/\/ Recursive termination test\n+  if (visited.member(this))  return;\n+  visited.push(this);\n+\n+  \/\/ Walk over all input edges, checking for correspondence\n+  for( i = 0; i < len(); i++ ) {\n+    n = in(i);\n+    if (n != NULL && !n->is_top()) {\n+      \/\/ Count instances of (Node *)this\n+      cnt = 0;\n+      for (idx = 0; idx < n->_outcnt; idx++ ) {\n+        if (n->_out[idx] == (Node *)this)  cnt++;\n+      }\n+      assert( cnt > 0,\"Failed to find Def-Use edge.\" );\n+      \/\/ Check for duplicate edges\n+      \/\/ walk the input array downcounting the input edges to n\n+      for( j = 0; j < len(); j++ ) {\n+        if( in(j) == n ) cnt--;\n+      }\n+      assert( cnt == 0,\"Mismatched edge count.\");\n+    } else if (n == NULL) {\n+      assert(i >= req() || i == 0 || is_Region() || is_Phi() || is_ArrayCopy() || (is_Unlock() && i == req()-1)\n+              || (is_MemBar() && i == 5), \/\/ the precedence edge to a membar can be removed during macro node expansion\n+              \"only region, phi, arraycopy, unlock or membar nodes have null data edges\");\n+    } else {\n+      assert(n->is_top(), \"sanity\");\n+      \/\/ Nothing to check.\n+    }\n+  }\n+  \/\/ Recursive walk over all input edges\n+  for( i = 0; i < len(); i++ ) {\n+    n = in(i);\n+    if( n != NULL )\n+      in(i)->verify_edges(visited);\n+  }\n+}\n+\n","filename":"src\/hotspot\/share\/opto\/node.cpp","additions":49,"deletions":1,"binary":false,"changes":50,"status":"modified"},{"patch":"@@ -1220,0 +1220,1 @@\n+  void verify_edges(Unique_Node_List &visited); \/\/ Verify bi-directional edges\n","filename":"src\/hotspot\/share\/opto\/node.hpp","additions":1,"deletions":0,"binary":false,"changes":1,"status":"modified"},{"patch":"@@ -1202,1 +1202,1 @@\n-    const Type* holder_type = TypeInstPtr::make(TypePtr::BotPTR, callee_holder, Type::trust_interfaces);\n+    const Type* holder_type = TypeInstPtr::make(TypePtr::BotPTR, callee_holder);\n@@ -1215,1 +1215,1 @@\n-      Node* holder_klass = _gvn.makecon(TypeKlassPtr::make(callee_holder, Type::trust_interfaces));\n+      Node* holder_klass = _gvn.makecon(TypeKlassPtr::make(callee_holder));\n@@ -2135,1 +2135,1 @@\n-  Node* holder = makecon(TypeKlassPtr::make(method()->holder(), Type::trust_interfaces));\n+  Node* holder = makecon(TypeKlassPtr::make(method()->holder()));\n@@ -2214,0 +2214,21 @@\n+    const TypeInstPtr *tr = phi->bottom_type()->isa_instptr();\n+    if (tr && tr->is_loaded() &&\n+        tr->is_interface()) {\n+      const TypeInstPtr *tp = value->bottom_type()->isa_instptr();\n+      if (tp && tp->is_loaded() &&\n+          !tp->is_interface()) {\n+        \/\/ sharpen the type eagerly; this eases certain assert checking\n+        if (tp->higher_equal(TypeInstPtr::NOTNULL))\n+          tr = tr->join_speculative(TypeInstPtr::NOTNULL)->is_instptr();\n+        value = _gvn.transform(new CheckCastPPNode(0, value, tr));\n+      }\n+    } else {\n+      \/\/ Also handle returns of oop-arrays to an arrays-of-interface return\n+      const TypeInstPtr* phi_tip;\n+      const TypeInstPtr* val_tip;\n+      Type::get_arrays_base_elements(phi->bottom_type(), value->bottom_type(), &phi_tip, &val_tip);\n+      if (phi_tip != NULL && phi_tip->is_loaded() && phi_tip->is_interface() &&\n+          val_tip != NULL && val_tip->is_loaded() && !val_tip->is_interface()) {\n+        value = _gvn.transform(new CheckCastPPNode(0, value, phi->bottom_type()));\n+      }\n+    }\n","filename":"src\/hotspot\/share\/opto\/parse1.cpp","additions":24,"deletions":3,"binary":false,"changes":27,"status":"modified"},{"patch":"@@ -26,0 +26,1 @@\n+#include \"jvm_io.h\"\n@@ -30,1 +31,0 @@\n-#include \"jvm_io.h\"\n","filename":"src\/hotspot\/share\/opto\/parse2.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -280,1 +280,1 @@\n-  const TypeKlassPtr* array_klass_type = TypeKlassPtr::make(array_klass, Type::trust_interfaces);\n+  const TypeKlassPtr* array_klass_type = TypeKlassPtr::make(array_klass);\n@@ -302,1 +302,1 @@\n-  Node* array = new_array(makecon(TypeKlassPtr::make(array_klass, Type::trust_interfaces)), length, nargs);\n+  Node* array = new_array(makecon(TypeKlassPtr::make(array_klass)), length, nargs);\n@@ -388,1 +388,1 @@\n-                          makecon(TypeKlassPtr::make(array_klass, Type::trust_interfaces)),\n+                          makecon(TypeKlassPtr::make(array_klass)),\n@@ -410,1 +410,1 @@\n-                          makecon(TypeKlassPtr::make(array_klass, Type::trust_interfaces)),\n+                          makecon(TypeKlassPtr::make(array_klass)),\n@@ -417,1 +417,1 @@\n-  const Type* type = TypeOopPtr::make_from_klass_raw(array_klass, Type::trust_interfaces);\n+  const Type* type = TypeOopPtr::make_from_klass_raw(array_klass);\n","filename":"src\/hotspot\/share\/opto\/parse3.cpp","additions":5,"deletions":5,"binary":false,"changes":10,"status":"modified"},{"patch":"@@ -93,1 +93,1 @@\n-  Node* res = gen_checkcast(obj, makecon(TypeKlassPtr::make(klass, Type::trust_interfaces)));\n+  Node* res = gen_checkcast(obj, makecon(TypeKlassPtr::make(klass)));\n@@ -132,1 +132,1 @@\n-  Node* res = gen_instanceof(peek(), makecon(TypeKlassPtr::make(klass, Type::trust_interfaces)), true);\n+  Node* res = gen_instanceof(peek(), makecon(TypeKlassPtr::make(klass)), true);\n","filename":"src\/hotspot\/share\/opto\/parseHelper.cpp","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -1021,1 +1021,1 @@\n-  if (is_sha3) fields[argp++] = TypeInt::INT; \/\/ block_size\n+  if (is_sha3) fields[argp++] = TypeInt::INT; \/\/ digest_length\n@@ -1043,1 +1043,1 @@\n-  if (is_sha3) fields[argp++] = TypeInt::INT; \/\/ block_size\n+  if (is_sha3) fields[argp++] = TypeInt::INT; \/\/ digest_length\n@@ -1269,20 +1269,0 @@\n-\/\/ Poly1305 processMultipleBlocks function\n-const TypeFunc* OptoRuntime::poly1305_processBlocks_Type() {\n-  int argcnt = 4;\n-\n-  const Type** fields = TypeTuple::fields(argcnt);\n-  int argp = TypeFunc::Parms;\n-  fields[argp++] = TypePtr::NOTNULL;    \/\/ input array\n-  fields[argp++] = TypeInt::INT;        \/\/ input length\n-  fields[argp++] = TypePtr::NOTNULL;    \/\/ accumulator array\n-  fields[argp++] = TypePtr::NOTNULL;    \/\/ r array\n-  assert(argp == TypeFunc::Parms + argcnt, \"correct decoding\");\n-  const TypeTuple* domain = TypeTuple::make(TypeFunc::Parms+argcnt, fields);\n-\n-  \/\/ result type needed\n-  fields = TypeTuple::fields(1);\n-  fields[TypeFunc::Parms + 0] = NULL; \/\/ void\n-  const TypeTuple* range = TypeTuple::make(TypeFunc::Parms, fields);\n-  return TypeFunc::make(domain, range);\n-}\n-\n","filename":"src\/hotspot\/share\/opto\/runtime.cpp","additions":2,"deletions":22,"binary":false,"changes":24,"status":"modified"},{"patch":"@@ -283,1 +283,0 @@\n-  static const TypeFunc* poly1305_processBlocks_Type();\n","filename":"src\/hotspot\/share\/opto\/runtime.hpp","additions":0,"deletions":1,"binary":false,"changes":1,"status":"modified"},{"patch":"@@ -1050,1 +1050,1 @@\n-  return phase->makecon(TypeKlassPtr::make(mirror_type->as_klass(), Type::trust_interfaces));\n+  return phase->makecon(TypeKlassPtr::make(mirror_type->as_klass()));\n","filename":"src\/hotspot\/share\/opto\/subnode.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -538,1 +538,1 @@\n-      merge_packs_to_cmove();\n+      merge_packs_to_cmovd();\n@@ -1414,1 +1414,1 @@\n-    use = _cmovev_kit.is_Cmp_candidate(s);\n+    use = _cmovev_kit.is_CmpD_candidate(s);\n@@ -1848,3 +1848,17 @@\n-\/\/------------------------------merge_packs_to_cmove---------------------------\n-\/\/ Merge qualified CMove into new vector-nodes\n-\/\/ We want to catch this pattern and subsume Cmp and Bool into CMove\n+\/\/ Clear the unused cmove pack and its related packs from superword candidate packset.\n+void SuperWord::remove_cmove_and_related_packs(Node_List* cmove_pk) {\n+  Node* cmove = cmove_pk->at(0);\n+  Node* bol = cmove->as_CMove()->in(CMoveNode::Condition);\n+  if (my_pack(bol)) {\n+    remove_pack(my_pack(bol));\n+  }\n+  Node* cmp = bol->in(1);\n+  if (my_pack(cmp)) {\n+    remove_pack(my_pack(cmp));\n+  }\n+  remove_pack(cmove_pk);\n+}\n+\n+\/\/------------------------------merge_packs_to_cmovd---------------------------\n+\/\/ Merge qualified CMoveD into new vector-nodes\n+\/\/ We want to catch this pattern and subsume CmpD and Bool into CMoveD\n@@ -1852,1 +1866,1 @@\n-\/\/                   Sub              Con\n+\/\/                   SubD             ConD\n@@ -1860,1 +1874,1 @@\n-\/\/         Cmp         |         \/\n+\/\/         CmpD        |         \/\n@@ -1869,1 +1883,1 @@\n-\/\/                   CMove\n+\/\/                   CMoveD\n@@ -1871,0 +1885,1 @@\n+\/\/ Also delete unqualified CMove pack from the packset and clear all info.\n@@ -1872,1 +1887,1 @@\n-void SuperWord::merge_packs_to_cmove() {\n+void SuperWord::merge_packs_to_cmovd() {\n@@ -1875,2 +1890,6 @@\n-    if (_cmovev_kit.can_merge_cmove_pack(pk)) {\n-      _cmovev_kit.make_cmove_pack(pk);\n+    if (_cmovev_kit.is_cmove_pack_candidate(pk)) {\n+      if (_cmovev_kit.can_merge_cmove_pack(pk)) {\n+        _cmovev_kit.make_cmove_pack(pk);\n+      } else {\n+        remove_cmove_and_related_packs(pk);\n+      }\n@@ -1882,1 +1901,1 @@\n-      tty->print_cr(\"\\nSuperWord::merge_packs_to_cmove(): After merge\");\n+      tty->print_cr(\"\\nSuperWord::merge_packs_to_cmovd(): After merge\");\n@@ -1903,1 +1922,1 @@\n-Node* CMoveKit::is_Cmp_candidate(Node* def) const {\n+Node* CMoveKit::is_CmpD_candidate(Node* def) const {\n@@ -1917,3 +1936,1 @@\n-\/\/ Determine if the current pack is an ideal cmove pack, and if its related packs,\n-\/\/ i.e. bool node pack and cmp node pack, can be successfully merged for vectorization.\n-bool CMoveKit::can_merge_cmove_pack(Node_List* cmove_pk) {\n+bool CMoveKit::is_cmove_pack_candidate(Node_List* cmove_pk) {\n@@ -1921,2 +1938,1 @@\n-\n-  if (!SuperWord::is_cmove_fp_opcode(cmove->Opcode()) ||\n+  if ((cmove->Opcode() != Op_CMoveF && cmove->Opcode() != Op_CMoveD) ||\n@@ -1926,0 +1942,7 @@\n+  return true;\n+}\n+\n+\/\/ Determine if the current pack is an ideal cmove pack, and if its related packs,\n+\/\/ i.e. bool node pack and cmp node pack, can be successfully merged for vectorization.\n+bool CMoveKit::can_merge_cmove_pack(Node_List* cmove_pk) {\n+  Node* cmove = cmove_pk->at(0);\n@@ -1928,1 +1951,1 @@\n-    NOT_PRODUCT(if(_sw->is_trace_cmov()) {tty->print(\"CMoveKit::can_merge_cmove_pack: CMove %d has control flow, escaping...\", cmove->_idx); cmove->dump();})\n+    NOT_PRODUCT(if(_sw->is_trace_cmov()) {tty->print(\"CMoveKit::make_cmove_pack: CMove %d has control flow, escaping...\", cmove->_idx); cmove->dump();})\n@@ -1936,1 +1959,1 @@\n-      bol->in(0) != NULL || \/\/ Bool node has control flow!!\n+      bol->in(0) != NULL || \/\/ BoolNode has control flow!!\n@@ -1938,1 +1961,1 @@\n-      NOT_PRODUCT(if(_sw->is_trace_cmov()) {tty->print(\"CMoveKit::can_merge_cmove_pack: Bool %d does not fit CMove %d for building vector, escaping...\", bol->_idx, cmove->_idx); bol->dump();})\n+      NOT_PRODUCT(if(_sw->is_trace_cmov()) {tty->print(\"CMoveKit::make_cmove_pack: Bool %d does not fit CMove %d for building vector, escaping...\", bol->_idx, cmove->_idx); bol->dump();})\n@@ -1950,1 +1973,1 @@\n-      cmp->in(0) != NULL || \/\/ Cmp node has control flow!!\n+      cmp->in(0) != NULL || \/\/ CmpNode has control flow!!\n@@ -1952,1 +1975,1 @@\n-      NOT_PRODUCT(if(_sw->is_trace_cmov()) {tty->print(\"CMoveKit::can_merge_cmove_pack: Cmp %d does not fit CMove %d for building vector, escaping...\", cmp->_idx, cmove->_idx); cmp->dump();})\n+      NOT_PRODUCT(if(_sw->is_trace_cmov()) {tty->print(\"CMoveKit::make_cmove_pack: Cmp %d does not fit CMove %d for building vector, escaping...\", cmp->_idx, cmove->_idx); cmp->dump();})\n@@ -1960,2 +1983,2 @@\n-  if (!test_cmp_pack(cmp_pk, cmove_pk)) {\n-    NOT_PRODUCT(if(_sw->is_trace_cmov()) {tty->print(\"CMoveKit::can_merge_cmove_pack: cmp pack for Cmp %d failed vectorization test\", cmp->_idx); cmp->dump();})\n+  if (!test_cmpd_pack(cmp_pk, cmove_pk)) {\n+    NOT_PRODUCT(if(_sw->is_trace_cmov()) {tty->print(\"CMoveKit::make_cmove_pack: cmp pack for Cmp %d failed vectorization test\", cmp->_idx); cmp->dump();})\n@@ -1999,7 +2022,7 @@\n-bool CMoveKit::test_cmp_pack(Node_List* cmp_pk, Node_List* cmove_pk) {\n-  Node* cmp0 = cmp_pk->at(0);\n-  assert(cmp0->is_Cmp(), \"CMoveKit::test_cmp_pack: should be Cmp Node\");\n-  assert(cmove_pk->at(0)->is_CMove(), \"CMoveKit::test_cmp_pack: should be CMove\");\n-  assert(cmp_pk->size() == cmove_pk->size(), \"CMoveKit::test_cmp_pack: should be same size\");\n-  Node* in1 = cmp0->in(1);\n-  Node* in2 = cmp0->in(2);\n+bool CMoveKit::test_cmpd_pack(Node_List* cmpd_pk, Node_List* cmovd_pk) {\n+  Node* cmpd0 = cmpd_pk->at(0);\n+  assert(cmpd0->is_Cmp(), \"CMoveKit::test_cmpd_pack: should be CmpDNode\");\n+  assert(cmovd_pk->at(0)->is_CMove(), \"CMoveKit::test_cmpd_pack: should be CMoveD\");\n+  assert(cmpd_pk->size() == cmovd_pk->size(), \"CMoveKit::test_cmpd_pack: should be same size\");\n+  Node* in1 = cmpd0->in(1);\n+  Node* in2 = cmpd0->in(2);\n@@ -2009,2 +2032,2 @@\n-  if (  (in1_pk != NULL && in1_pk->size() != cmp_pk->size())\n-     || (in2_pk != NULL && in2_pk->size() != cmp_pk->size()) ) {\n+  if (  (in1_pk != NULL && in1_pk->size() != cmpd_pk->size())\n+     || (in2_pk != NULL && in2_pk->size() != cmpd_pk->size()) ) {\n@@ -2016,2 +2039,2 @@\n-    for (uint j = 1; j < cmp_pk->size(); j++) {\n-      if (cmp_pk->at(j)->in(1) != in1) {\n+    for (uint j = 1; j < cmpd_pk->size(); j++) {\n+      if (cmpd_pk->at(j)->in(1) != in1) {\n@@ -2020,1 +2043,1 @@\n-    }\/\/for: in1_pk is not pack but all Cmp nodes in the pack have the same in(1)\n+    }\/\/for: in1_pk is not pack but all CmpD nodes in the pack have the same in(1)\n@@ -2024,2 +2047,2 @@\n-    for (uint j = 1; j < cmp_pk->size(); j++) {\n-      if (cmp_pk->at(j)->in(2) != in2) {\n+    for (uint j = 1; j < cmpd_pk->size(); j++) {\n+      if (cmpd_pk->at(j)->in(2) != in2) {\n@@ -2028,1 +2051,1 @@\n-    }\/\/for: in2_pk is not pack but all Cmp nodes in the pack have the same in(2)\n+    }\/\/for: in2_pk is not pack but all CmpD nodes in the pack have the same in(2)\n@@ -2030,10 +2053,10 @@\n-  \/\/now check if cmp_pk may be subsumed in vector built for cmove_pk\n-  int cmove_ind1, cmove_ind2;\n-  if (cmp_pk->at(0)->in(1) == cmove_pk->at(0)->as_CMove()->in(CMoveNode::IfFalse)\n-   && cmp_pk->at(0)->in(2) == cmove_pk->at(0)->as_CMove()->in(CMoveNode::IfTrue)) {\n-      cmove_ind1 = CMoveNode::IfFalse;\n-      cmove_ind2 = CMoveNode::IfTrue;\n-  } else if (cmp_pk->at(0)->in(2) == cmove_pk->at(0)->as_CMove()->in(CMoveNode::IfFalse)\n-          && cmp_pk->at(0)->in(1) == cmove_pk->at(0)->as_CMove()->in(CMoveNode::IfTrue)) {\n-      cmove_ind2 = CMoveNode::IfFalse;\n-      cmove_ind1 = CMoveNode::IfTrue;\n+  \/\/now check if cmpd_pk may be subsumed in vector built for cmovd_pk\n+  int cmovd_ind1, cmovd_ind2;\n+  if (cmpd_pk->at(0)->in(1) == cmovd_pk->at(0)->as_CMove()->in(CMoveNode::IfFalse)\n+   && cmpd_pk->at(0)->in(2) == cmovd_pk->at(0)->as_CMove()->in(CMoveNode::IfTrue)) {\n+      cmovd_ind1 = CMoveNode::IfFalse;\n+      cmovd_ind2 = CMoveNode::IfTrue;\n+  } else if (cmpd_pk->at(0)->in(2) == cmovd_pk->at(0)->as_CMove()->in(CMoveNode::IfFalse)\n+          && cmpd_pk->at(0)->in(1) == cmovd_pk->at(0)->as_CMove()->in(CMoveNode::IfTrue)) {\n+      cmovd_ind2 = CMoveNode::IfFalse;\n+      cmovd_ind1 = CMoveNode::IfTrue;\n@@ -2045,3 +2068,3 @@\n-  for (uint j = 1; j < cmp_pk->size(); j++) {\n-    if (cmp_pk->at(j)->in(1) != cmove_pk->at(j)->as_CMove()->in(cmove_ind1)\n-        || cmp_pk->at(j)->in(2) != cmove_pk->at(j)->as_CMove()->in(cmove_ind2)) {\n+  for (uint j = 1; j < cmpd_pk->size(); j++) {\n+    if (cmpd_pk->at(j)->in(1) != cmovd_pk->at(j)->as_CMove()->in(cmovd_ind1)\n+        || cmpd_pk->at(j)->in(2) != cmovd_pk->at(j)->as_CMove()->in(cmovd_ind2)) {\n@@ -2051,1 +2074,1 @@\n-  NOT_PRODUCT(if(_sw->is_trace_cmov()) { tty->print(\"CMoveKit::test_cmp_pack: cmp pack for 1st Cmp %d is OK for vectorization: \", cmp0->_idx); cmp0->dump(); })\n+  NOT_PRODUCT(if(_sw->is_trace_cmov()) { tty->print(\"CMoveKit::test_cmpd_pack: cmpd pack for 1st CmpD %d is OK for vectorization: \", cmpd0->_idx); cmpd0->dump(); })\n@@ -2079,3 +2102,0 @@\n-    } else if (is_cmove_fp_opcode(opc)) {\n-      retValue = is_cmov_pack(p) && VectorNode::implemented(opc, size, velt_basic_type(p0));\n-      NOT_PRODUCT(if(retValue && is_trace_cmov()) {tty->print_cr(\"SWPointer::implemented: found cmove pack\"); print_pack(p);})\n@@ -2091,0 +2111,1 @@\n+      NOT_PRODUCT(if(retValue && is_trace_cmov() && is_cmov_pack(p)) {tty->print_cr(\"SWPointer::implemented: found cmpd pack\"); print_pack(p);})\n@@ -3701,0 +3722,10 @@\n+\/\/------------------------------remove_pack------------------------------\n+\/\/ Remove the pack in the packset\n+void SuperWord::remove_pack(Node_List* p) {\n+  for (uint i = 0; i < p->size(); i++) {\n+    Node* s = p->at(i);\n+    set_my_pack(s, NULL);\n+  }\n+  _packset.remove(p);\n+}\n+\n","filename":"src\/hotspot\/share\/opto\/superword.cpp","additions":88,"deletions":57,"binary":false,"changes":145,"status":"modified"},{"patch":"@@ -217,2 +217,4 @@\n-  Node* is_Cmp_candidate(Node* nd) const; \/\/ otherwise return NULL\n-  \/\/ Determine if the current pack is a cmove candidate that can be vectorized.\n+  Node* is_CmpD_candidate(Node* nd) const; \/\/ otherwise return NULL\n+  \/\/ If the input pack is a cmove candidate, return true, otherwise return false.\n+  bool is_cmove_pack_candidate(Node_List* cmove_pk);\n+  \/\/ Determine if the current cmove pack can be vectorized.\n@@ -220,2 +222,2 @@\n-  void make_cmove_pack(Node_List* cmove_pk);\n-  bool test_cmp_pack(Node_List* cmp_pk, Node_List* cmove_pk);\n+  void make_cmove_pack(Node_List* cmovd_pk);\n+  bool test_cmpd_pack(Node_List* cmpd_pk, Node_List* cmovd_pk);\n@@ -456,1 +458,1 @@\n-  \/\/ is pack good for converting into one vector node replacing bunches of Cmp, Bool, CMov nodes.\n+  \/\/ is pack good for converting into one vector node replacing 12 nodes of Cmp, Bool, CMov\n@@ -459,1 +461,0 @@\n-  static bool is_cmove_fp_opcode(int opc) { return (opc == Op_CMoveF || opc == Op_CMoveD); }\n@@ -542,2 +543,4 @@\n-  \/\/ Merge CMove into new vector-nodes\n-  void merge_packs_to_cmove();\n+  \/\/ Clear the unused cmove pack and its related packs from superword candidate packset.\n+  void remove_cmove_and_related_packs(Node_List* cmove_pk);\n+  \/\/ Merge CMoveD into new vector-nodes\n+  void merge_packs_to_cmovd();\n@@ -590,0 +593,2 @@\n+  \/\/ Remove the pack in the packset\n+  void remove_pack(Node_List* p);\n","filename":"src\/hotspot\/share\/opto\/superword.hpp","additions":13,"deletions":8,"binary":false,"changes":21,"status":"modified"},{"patch":"@@ -123,2 +123,0 @@\n-const TypePtr::InterfaceSet* TypeAryPtr::_array_interfaces = NULL;\n-const TypePtr::InterfaceSet* TypeAryKlassPtr::_array_interfaces = NULL;\n@@ -139,1 +137,1 @@\n-const Type* Type::get_const_type(ciType* type, InterfaceHandling interface_handling) {\n+const Type* Type::get_const_type(ciType* type) {\n@@ -145,1 +143,1 @@\n-    return TypeOopPtr::make_from_klass(type->as_klass(), interface_handling);\n+    return TypeOopPtr::make_from_klass(type->as_klass());\n@@ -571,6 +569,0 @@\n-  GrowableArray<ciInstanceKlass*> array_interfaces;\n-  array_interfaces.push(current->env()->Cloneable_klass());\n-  array_interfaces.push(current->env()->Serializable_klass());\n-  TypeAryPtr::_array_interfaces = new TypePtr::InterfaceSet(&array_interfaces);\n-  TypeAryKlassPtr::_array_interfaces = TypeAryPtr::_array_interfaces;\n-\n@@ -789,0 +781,45 @@\n+\/\/----------------------interface_vs_oop---------------------------------------\n+#ifdef ASSERT\n+bool Type::interface_vs_oop_helper(const Type *t) const {\n+  bool result = false;\n+\n+  const TypePtr* this_ptr = this->make_ptr(); \/\/ In case it is narrow_oop\n+  const TypePtr*    t_ptr =    t->make_ptr();\n+  if( this_ptr == NULL || t_ptr == NULL )\n+    return result;\n+\n+  const TypeInstPtr* this_inst = this_ptr->isa_instptr();\n+  const TypeInstPtr*    t_inst =    t_ptr->isa_instptr();\n+  if( this_inst && this_inst->is_loaded() && t_inst && t_inst->is_loaded() ) {\n+    bool this_interface = this_inst->is_interface();\n+    bool    t_interface =    t_inst->is_interface();\n+    result = this_interface ^ t_interface;\n+  }\n+\n+  return result;\n+}\n+\n+bool Type::interface_vs_oop(const Type *t) const {\n+  if (interface_vs_oop_helper(t)) {\n+    return true;\n+  }\n+  \/\/ Now check the speculative parts as well\n+  const TypePtr* this_spec = isa_ptr() != NULL ? is_ptr()->speculative() : NULL;\n+  const TypePtr* t_spec = t->isa_ptr() != NULL ? t->is_ptr()->speculative() : NULL;\n+  if (this_spec != NULL && t_spec != NULL) {\n+    if (this_spec->interface_vs_oop_helper(t_spec)) {\n+      return true;\n+    }\n+    return false;\n+  }\n+  if (this_spec != NULL && this_spec->interface_vs_oop_helper(t)) {\n+    return true;\n+  }\n+  if (t_spec != NULL && interface_vs_oop_helper(t_spec)) {\n+    return true;\n+  }\n+  return false;\n+}\n+\n+#endif\n+\n@@ -808,1 +845,1 @@\n-  if (t2t != t->_dual || t2this != this->_dual) {\n+  if (!interface_vs_oop(t) && (t2t != t->_dual || t2this != this->_dual)) {\n@@ -1986,1 +2023,1 @@\n-const TypeTuple *TypeTuple::make_range(ciSignature* sig, InterfaceHandling interface_handling) {\n+const TypeTuple *TypeTuple::make_range(ciSignature* sig) {\n@@ -2007,1 +2044,1 @@\n-    field_array[TypeFunc::Parms] = get_const_type(return_type, interface_handling);\n+    field_array[TypeFunc::Parms] = get_const_type(return_type);\n@@ -2018,1 +2055,1 @@\n-const TypeTuple *TypeTuple::make_domain(ciInstanceKlass* recv, ciSignature* sig, InterfaceHandling interface_handling) {\n+const TypeTuple *TypeTuple::make_domain(ciInstanceKlass* recv, ciSignature* sig) {\n@@ -2027,1 +2064,1 @@\n-    field_array[pos++] = get_const_type(recv, interface_handling)->join_speculative(TypePtr::NOTNULL);\n+    field_array[pos++] = get_const_type(recv)->join_speculative(TypePtr::NOTNULL);\n@@ -2049,1 +2086,1 @@\n-      field_array[pos++] = get_const_type(type, interface_handling);\n+      field_array[pos++] = get_const_type(type);\n@@ -2280,0 +2317,15 @@\n+\/\/----------------------interface_vs_oop---------------------------------------\n+#ifdef ASSERT\n+bool TypeAry::interface_vs_oop(const Type *t) const {\n+  const TypeAry* t_ary = t->is_ary();\n+  if (t_ary) {\n+    const TypePtr* this_ptr = _elem->make_ptr(); \/\/ In case we have narrow_oops\n+    const TypePtr*    t_ptr = t_ary->_elem->make_ptr();\n+    if(this_ptr != NULL && t_ptr != NULL) {\n+      return this_ptr->interface_vs_oop(t_ptr);\n+    }\n+  }\n+  return false;\n+}\n+#endif\n+\n@@ -3118,220 +3170,0 @@\n-TypePtr::InterfaceSet::InterfaceSet()\n-        : _list(Compile::current()->type_arena(), 0, 0, NULL),\n-          _hash_computed(0), _exact_klass_computed(0), _is_loaded_computed(0) {\n-}\n-\n-TypePtr::InterfaceSet::InterfaceSet(GrowableArray<ciInstanceKlass*>* interfaces)\n-        : _list(Compile::current()->type_arena(), interfaces->length(), 0, NULL),\n-          _hash_computed(0), _exact_klass_computed(0), _is_loaded_computed(0) {\n-  for (int i = 0; i < interfaces->length(); i++) {\n-    add(interfaces->at(i));\n-  }\n-}\n-\n-\n-int TypePtr::InterfaceSet::compare(ciKlass* const& k1, ciKlass* const& k2) {\n-  if ((intptr_t)k1 < (intptr_t)k2) {\n-    return -1;\n-  } else if ((intptr_t)k1 > (intptr_t)k2) {\n-    return 1;\n-  }\n-  return 0;\n-}\n-\n-void TypePtr::InterfaceSet::add(ciKlass* interface) {\n-  assert(interface->is_interface(), \"for interfaces only\");\n-  _list.insert_sorted<compare>(interface);\n-  verify();\n-}\n-\n-void TypePtr::InterfaceSet::raw_add(ciKlass* interface) {\n-  assert(interface->is_interface(), \"for interfaces only\");\n-  _list.push(interface);\n-}\n-\n-bool TypePtr::InterfaceSet::eq(const InterfaceSet& other) const {\n-  if (_list.length() != other._list.length()) {\n-    return false;\n-  }\n-  for (int i = 0; i < _list.length(); i++) {\n-    ciKlass* k1 = _list.at(i);\n-    ciKlass* k2 = other._list.at(i);\n-    if (!k1->equals(k2)) {\n-      return false;\n-    }\n-  }\n-  return true;\n-}\n-\n-int TypePtr::InterfaceSet::hash() const {\n-  if (_hash_computed) {\n-    return _hash;\n-  }\n-  const_cast<InterfaceSet*>(this)->compute_hash();\n-  assert(_hash_computed, \"should be computed now\");\n-  return _hash;\n-}\n-\n-void TypePtr::InterfaceSet::compute_hash() {\n-  int hash = 0;\n-  for (int i = 0; i < _list.length(); i++) {\n-    ciKlass* k = _list.at(i);\n-    hash += (jint)k->hash();\n-  }\n-  _hash_computed = 1;\n-  _hash = hash;\n-}\n-\n-void TypePtr::InterfaceSet::dump(outputStream *st) const {\n-  if (_list.length() == 0) {\n-    return;\n-  }\n-  st->print(\" (\");\n-  for (int i = 0; i < _list.length(); i++) {\n-    if (i > 0) {\n-      st->print(\",\");\n-    }\n-    ciKlass* k = _list.at(i);\n-    k->print_name_on(st);\n-  }\n-  st->print(\")\");\n-}\n-\n-void TypePtr::InterfaceSet::verify() const {\n-#ifdef DEBUG\n-  for (int i = 1; i < _list.length(); i++) {\n-    ciKlass* k1 = _list.at(i-1);\n-    ciKlass* k2 = _list.at(i);\n-    assert(compare(k2, k1) > 0, \"should be ordered\");\n-    assert(k1 != k2, \"no duplicate\");\n-  }\n-#endif\n-}\n-\n-TypePtr::InterfaceSet TypeOopPtr::InterfaceSet::union_with(const InterfaceSet& other) const {\n-  InterfaceSet result;\n-  int i = 0;\n-  int j = 0;\n-  while (i < _list.length() || j < other._list.length()) {\n-    while (i < _list.length() &&\n-           (j >= other._list.length() ||\n-            compare(_list.at(i), other._list.at(j)) < 0)) {\n-      result.raw_add(_list.at(i));\n-      i++;\n-    }\n-    while (j < other._list.length() &&\n-           (i >= _list.length() ||\n-            compare(other._list.at(j), _list.at(i)) < 0)) {\n-      result.raw_add(other._list.at(j));\n-      j++;\n-    }\n-    if (i < _list.length() &&\n-        j < other._list.length() &&\n-        _list.at(i) == other._list.at(j)) {\n-      result.raw_add(_list.at(i));\n-      i++;\n-      j++;\n-    }\n-  }\n-  result.verify();\n-#ifdef DEBUG\n-  for (int i = 0; i < _list.length(); i++) {\n-    assert(result.contains(_list.at(i)), \"missing\");\n-  }\n-  for (int i = 0; i < other._list.length(); i++) {\n-    assert(result.contains(other._list.at(i)), \"missing\");\n-  }\n-  for (int i = 0; i < result._list.length(); i++) {\n-    assert(_list.contains(result._list.at(i)) || other._list.contains(result._list.at(i)), \"missing\");\n-  }\n-#endif\n-  return result;\n-}\n-\n-TypePtr::InterfaceSet TypeOopPtr::InterfaceSet::intersection_with(const InterfaceSet& other) const {\n-  InterfaceSet result;\n-  int i = 0;\n-  int j = 0;\n-  while (i < _list.length() || j < other._list.length()) {\n-    while (i < _list.length() &&\n-           (j >= other._list.length() ||\n-            compare(_list.at(i), other._list.at(j)) < 0)) {\n-      i++;\n-    }\n-    while (j < other._list.length() &&\n-           (i >= _list.length() ||\n-            compare(other._list.at(j), _list.at(i)) < 0)) {\n-      j++;\n-    }\n-    if (i < _list.length() &&\n-        j < other._list.length() &&\n-        _list.at(i) == other._list.at(j)) {\n-      result.raw_add(_list.at(i));\n-      i++;\n-      j++;\n-    }\n-  }\n-  result.verify();\n-#ifdef DEBUG\n-  for (int i = 0; i < _list.length(); i++) {\n-    assert(!other._list.contains(_list.at(i)) || result.contains(_list.at(i)), \"missing\");\n-  }\n-  for (int i = 0; i < other._list.length(); i++) {\n-    assert(!_list.contains(other._list.at(i)) || result.contains(other._list.at(i)), \"missing\");\n-  }\n-  for (int i = 0; i < result._list.length(); i++) {\n-    assert(_list.contains(result._list.at(i)) && other._list.contains(result._list.at(i)), \"missing\");\n-  }\n-#endif\n-  return result;\n-}\n-\n-\/\/ Is there a single ciKlass* that can represent the interface set?\n-ciKlass* TypePtr::InterfaceSet::exact_klass() const {\n-  if (_exact_klass_computed) {\n-    return _exact_klass;\n-  }\n-  const_cast<InterfaceSet*>(this)->compute_exact_klass();\n-  assert(_exact_klass_computed, \"should be computed now\");\n-  return _exact_klass;\n-}\n-\n-void TypePtr::InterfaceSet::compute_exact_klass() {\n-  if (_list.length() == 0) {\n-    _exact_klass_computed = 1;\n-    _exact_klass = NULL;\n-    return;\n-  }\n-  ciKlass* res = NULL;\n-  for (int i = 0; i < _list.length(); i++) {\n-    ciKlass* interface = _list.at(i);\n-    if (eq(interfaces(interface, false, true, false, trust_interfaces))) {\n-      assert(res == NULL, \"\");\n-      res = _list.at(i);\n-    }\n-  }\n-  _exact_klass_computed = 1;\n-  _exact_klass = res;\n-}\n-\n-bool TypePtr::InterfaceSet::is_loaded() const {\n-  if (_is_loaded_computed) {\n-    return _is_loaded;\n-  }\n-  const_cast<InterfaceSet*>(this)->compute_is_loaded();\n-  assert(_is_loaded_computed, \"should be computed now\");\n-  return _is_loaded;\n-}\n-\n-void TypePtr::InterfaceSet::compute_is_loaded() {\n-  _is_loaded_computed = 1;\n-  for (int i = 0; i < _list.length(); i++) {\n-    ciKlass* interface = _list.at(i);\n-    if (!interface->is_loaded()) {\n-      _is_loaded = false;\n-      return;\n-    }\n-  }\n-  _is_loaded = true;\n-}\n-\n@@ -3339,1 +3171,1 @@\n-TypeOopPtr::TypeOopPtr(TYPES t, PTR ptr, ciKlass* k, const InterfaceSet& interfaces, bool xk, ciObject* o, int offset,\n+TypeOopPtr::TypeOopPtr(TYPES t, PTR ptr, ciKlass* k, bool xk, ciObject* o, int offset,\n@@ -3343,1 +3175,0 @@\n-    _interfaces(interfaces),\n@@ -3391,1 +3222,1 @@\n-            _is_ptr_to_narrowoop = UseCompressedOops && ::is_reference_type(basic_elem_type);\n+            _is_ptr_to_narrowoop = UseCompressedOops && is_reference_type(basic_elem_type);\n@@ -3401,1 +3232,1 @@\n-            _is_ptr_to_narrowoop = UseCompressedOops && ::is_reference_type(basic_elem_type);\n+            _is_ptr_to_narrowoop = UseCompressedOops && is_reference_type(basic_elem_type);\n@@ -3424,1 +3255,1 @@\n-  return (TypeOopPtr*)(new TypeOopPtr(OopPtr, ptr, k, InterfaceSet(), xk, o, offset, instance_id, speculative, inline_depth))->hashcons();\n+  return (TypeOopPtr*)(new TypeOopPtr(OopPtr, ptr, k, xk, o, offset, instance_id, speculative, inline_depth))->hashcons();\n@@ -3537,1 +3368,1 @@\n-  return new TypeOopPtr(_base, dual_ptr(), klass(), _interfaces, klass_is_exact(), const_oop(), dual_offset(), dual_instance_id(), dual_speculative(), dual_inline_depth());\n+  return new TypeOopPtr(_base, dual_ptr(), klass(), klass_is_exact(), const_oop(), dual_offset(), dual_instance_id(), dual_speculative(), dual_inline_depth());\n@@ -3542,1 +3373,1 @@\n-const TypeOopPtr* TypeOopPtr::make_from_klass_common(ciKlass* klass, bool klass_change, bool try_for_exact, InterfaceHandling interface_handling) {\n+const TypeOopPtr* TypeOopPtr::make_from_klass_common(ciKlass *klass, bool klass_change, bool try_for_exact) {\n@@ -3569,2 +3400,1 @@\n-    const TypePtr::InterfaceSet interfaces = TypePtr::interfaces(klass, true, true, false, interface_handling);\n-    return TypeInstPtr::make(TypePtr::BotPTR, klass, interfaces, klass_is_exact, NULL, 0);\n+    return TypeInstPtr::make(TypePtr::BotPTR, klass, klass_is_exact, NULL, 0);\n@@ -3573,2 +3403,1 @@\n-    ciKlass* eklass = klass->as_obj_array_klass()->element_klass();\n-    const TypeOopPtr *etype = TypeOopPtr::make_from_klass_common(eklass, try_for_exact, false, interface_handling);\n+    const TypeOopPtr *etype = TypeOopPtr::make_from_klass_common(klass->as_obj_array_klass()->element_klass(), false, try_for_exact);\n@@ -3580,1 +3409,1 @@\n-    const TypeAryPtr* arr = TypeAryPtr::make(TypePtr::BotPTR, arr0, NULL, xk, 0);\n+    const TypeAryPtr* arr = TypeAryPtr::make(TypePtr::BotPTR, arr0, klass, xk, 0);\n@@ -3614,1 +3443,1 @@\n-      TypeOopPtr::make_from_klass_raw(klass->as_obj_array_klass()->element_klass(), trust_interfaces);\n+      TypeOopPtr::make_from_klass_raw(klass->as_obj_array_klass()->element_klass());\n@@ -3672,0 +3501,21 @@\n+    \/\/ Check for evil case of 'this' being a class and 'kills' expecting an\n+    \/\/ interface.  This can happen because the bytecodes do not contain\n+    \/\/ enough type info to distinguish a Java-level interface variable\n+    \/\/ from a Java-level object variable.  If we meet 2 classes which\n+    \/\/ both implement interface I, but their meet is at 'j\/l\/O' which\n+    \/\/ doesn't implement I, we have no way to tell if the result should\n+    \/\/ be 'I' or 'j\/l\/O'.  Thus we'll pick 'j\/l\/O'.  If this then flows\n+    \/\/ into a Phi which \"knows\" it's an Interface type we'll have to\n+    \/\/ uplift the type.\n+    if (!empty()) {\n+      if (ktip != NULL && ktip->is_loaded() && ktip->klass()->is_interface()) {\n+        return kills;           \/\/ Uplift to interface\n+      }\n+      \/\/ Also check for evil cases of 'this' being a class array\n+      \/\/ and 'kills' expecting an array of interfaces.\n+      Type::get_arrays_base_elements(ft, kills, NULL, &ktip);\n+      if (ktip != NULL && ktip->is_loaded() && ktip->klass()->is_interface()) {\n+        return kills;           \/\/ Uplift to array of interface\n+      }\n+    }\n+\n@@ -3675,0 +3525,12 @@\n+  \/\/ If we have an interface-typed Phi or cast and we narrow to a class type,\n+  \/\/ the join should report back the class.  However, if we have a J\/L\/Object\n+  \/\/ class-typed Phi and an interface flows in, it's possible that the meet &\n+  \/\/ join report an interface back out.  This isn't possible but happens\n+  \/\/ because the type system doesn't interact well with interfaces.\n+  if (ftip != NULL && ktip != NULL &&\n+      ftip->is_loaded() &&  ftip->klass()->is_interface() &&\n+      ktip->is_loaded() && !ktip->klass()->is_interface()) {\n+    assert(!ftip->klass_is_exact(), \"interface could not be exact\");\n+    return ktip->cast_to_ptr_type(ftip->ptr());\n+  }\n+\n@@ -3733,1 +3595,1 @@\n-const TypePtr* TypeOopPtr::add_offset(intptr_t offset) const {\n+const TypePtr *TypeOopPtr::add_offset(intptr_t offset) const {\n@@ -3800,12 +3662,0 @@\n-\n-TypePtr::InterfaceSet TypeOopPtr::meet_interfaces(const TypeOopPtr* other) const {\n-  if (above_centerline(_ptr) && above_centerline(other->_ptr)) {\n-    return _interfaces.union_with(other->_interfaces);\n-  } else if (above_centerline(_ptr) && !above_centerline(other->_ptr)) {\n-    return other->_interfaces;\n-  } else if (above_centerline(other->_ptr) && !above_centerline(_ptr)) {\n-    return _interfaces;\n-  }\n-  return _interfaces.intersection_with(other->_interfaces);\n-}\n-\n@@ -3836,1 +3686,0 @@\n-\/\/ Is there a single ciKlass* that can represent that type?\n@@ -3838,12 +3687,1 @@\n-  if (_interfaces.empty()) {\n-    return _klass;\n-  }\n-  if (_klass != ciEnv::current()->Object_klass()) {\n-    ciKlass* k = _klass;\n-    const TypePtr::InterfaceSet interfaces = TypePtr::interfaces(k, true, false, false, ignore_interfaces);\n-    if (_interfaces.eq(interfaces)) {\n-      return _klass;\n-    }\n-    return NULL;\n-  }\n-  return _interfaces.exact_klass();\n+  return _klass;\n@@ -3853,1 +3691,1 @@\n-TypeInstPtr::TypeInstPtr(PTR ptr, ciKlass* k, const InterfaceSet& interfaces, bool xk, ciObject* o, int off,\n+TypeInstPtr::TypeInstPtr(PTR ptr, ciKlass* k, bool xk, ciObject* o, int off,\n@@ -3855,5 +3693,4 @@\n-  : TypeOopPtr(InstPtr, ptr, k, interfaces, xk, o, off, instance_id, speculative, inline_depth) {\n-  assert(k == NULL || !k->is_loaded() || !k->is_interface(), \"no interface here\");\n-  assert(k != NULL &&\n-         (k->is_loaded() || o == NULL),\n-         \"cannot have constants with non-loaded klass\");\n+  : TypeOopPtr(InstPtr, ptr, k, xk, o, off, instance_id, speculative, inline_depth) {\n+   assert(k != NULL &&\n+          (k->is_loaded() || o == NULL),\n+          \"cannot have constants with non-loaded klass\");\n@@ -3865,1 +3702,0 @@\n-                                     const InterfaceSet& interfaces,\n@@ -3886,1 +3722,0 @@\n-    assert(!ik->is_interface(), \"no interface here\");\n@@ -3892,1 +3727,1 @@\n-    (TypeInstPtr*)(new TypeInstPtr(ptr, k, interfaces, xk, o ,offset, instance_id, speculative, inline_depth))->hashcons();\n+    (TypeInstPtr*)(new TypeInstPtr(ptr, k, xk, o ,offset, instance_id, speculative, inline_depth))->hashcons();\n@@ -3897,33 +3732,0 @@\n-TypePtr::InterfaceSet TypePtr::interfaces(ciKlass*& k, bool klass, bool interface, bool array, InterfaceHandling interface_handling) {\n-  if (k->is_instance_klass()) {\n-    if (k->is_loaded()) {\n-      if (k->is_interface() && interface_handling == ignore_interfaces) {\n-        assert(interface, \"no interface expected\");\n-        k = ciEnv::current()->Object_klass();\n-        InterfaceSet interfaces;\n-        return interfaces;\n-      }\n-      GrowableArray<ciInstanceKlass *> *k_interfaces = k->as_instance_klass()->transitive_interfaces();\n-      InterfaceSet interfaces(k_interfaces);\n-      if (k->is_interface()) {\n-        assert(interface, \"no interface expected\");\n-        k = ciEnv::current()->Object_klass();\n-      } else {\n-        assert(klass, \"no instance klass expected\");\n-      }\n-      return interfaces;\n-    }\n-    InterfaceSet interfaces;\n-    return interfaces;\n-  }\n-  assert(array, \"no array expected\");\n-  assert(k->is_array_klass(), \"Not an array?\");\n-  ciType* e = k->as_array_klass()->base_element_type();\n-  if (e->is_loaded() && e->is_instance_klass() && e->as_instance_klass()->is_interface()) {\n-    if (interface_handling == ignore_interfaces) {\n-      k = ciObjArrayKlass::make(ciEnv::current()->Object_klass(), k->as_array_klass()->dimension());\n-    }\n-  }\n-  return *TypeAryPtr::_array_interfaces;\n-}\n-\n@@ -3958,1 +3760,1 @@\n-  return make(ptr, klass(), _interfaces, klass_is_exact(), ptr == Constant ? const_oop() : NULL, _offset, _instance_id, _speculative, _inline_depth);\n+  return make(ptr, klass(), klass_is_exact(), ptr == Constant ? const_oop() : NULL, _offset, _instance_id, _speculative, _inline_depth);\n@@ -3968,2 +3770,2 @@\n-  assert(!ik->is_interface(), \"no interface here\");\n-  return make(ptr(), klass(), _interfaces, klass_is_exact, const_oop(), _offset, _instance_id, _speculative, _inline_depth);\n+  if( ik->is_interface() )              return this;  \/\/ cannot set xk\n+  return make(ptr(), klass(), klass_is_exact, const_oop(), _offset, _instance_id, _speculative, _inline_depth);\n@@ -3975,1 +3777,1 @@\n-  return make(_ptr, klass(),  _interfaces, _klass_is_exact, const_oop(), _offset, instance_id, _speculative, _inline_depth);\n+  return make(_ptr, klass(), _klass_is_exact, const_oop(), _offset, instance_id, _speculative, _inline_depth);\n@@ -3981,33 +3783,6 @@\n-const TypeInstPtr *TypeInstPtr::xmeet_unloaded(const TypeInstPtr *tinst, const InterfaceSet& interfaces) const {\n-  int off = meet_offset(tinst->offset());\n-  PTR ptr = meet_ptr(tinst->ptr());\n-  int instance_id = meet_instance_id(tinst->instance_id());\n-  const TypePtr* speculative = xmeet_speculative(tinst);\n-  int depth = meet_inline_depth(tinst->inline_depth());\n-\n-  const TypeInstPtr *loaded    = is_loaded() ? this  : tinst;\n-  const TypeInstPtr *unloaded  = is_loaded() ? tinst : this;\n-  if( loaded->klass()->equals(ciEnv::current()->Object_klass()) ) {\n-    \/\/\n-    \/\/ Meet unloaded class with java\/lang\/Object\n-    \/\/\n-    \/\/ Meet\n-    \/\/          |                     Unloaded Class\n-    \/\/  Object  |   TOP    |   AnyNull | Constant |   NotNull |  BOTTOM   |\n-    \/\/  ===================================================================\n-    \/\/   TOP    | ..........................Unloaded......................|\n-    \/\/  AnyNull |  U-AN    |................Unloaded......................|\n-    \/\/ Constant | ... O-NN .................................. |   O-BOT   |\n-    \/\/  NotNull | ... O-NN .................................. |   O-BOT   |\n-    \/\/  BOTTOM  | ........................Object-BOTTOM ..................|\n-    \/\/\n-    assert(loaded->ptr() != TypePtr::Null, \"insanity check\");\n-    \/\/\n-    if (loaded->ptr() == TypePtr::TopPTR)        { return unloaded; }\n-    else if (loaded->ptr() == TypePtr::AnyNull)  { return make(ptr, unloaded->klass(), interfaces, false, NULL, off, instance_id, speculative, depth); }\n-    else if (loaded->ptr() == TypePtr::BotPTR)   { return TypeInstPtr::BOTTOM; }\n-    else if (loaded->ptr() == TypePtr::Constant || loaded->ptr() == TypePtr::NotNull) {\n-      if (unloaded->ptr() == TypePtr::BotPTR)    { return TypeInstPtr::BOTTOM;  }\n-      else                                       { return TypeInstPtr::NOTNULL; }\n-    }\n-    else if (unloaded->ptr() == TypePtr::TopPTR) { return unloaded; }\n+const TypeInstPtr *TypeInstPtr::xmeet_unloaded(const TypeInstPtr *tinst) const {\n+    int off = meet_offset(tinst->offset());\n+    PTR ptr = meet_ptr(tinst->ptr());\n+    int instance_id = meet_instance_id(tinst->instance_id());\n+    const TypePtr* speculative = xmeet_speculative(tinst);\n+    int depth = meet_inline_depth(tinst->inline_depth());\n@@ -4015,2 +3790,26 @@\n-    return unloaded->cast_to_ptr_type(TypePtr::AnyNull)->is_instptr();\n-  }\n+    const TypeInstPtr *loaded    = is_loaded() ? this  : tinst;\n+    const TypeInstPtr *unloaded  = is_loaded() ? tinst : this;\n+    if( loaded->klass()->equals(ciEnv::current()->Object_klass()) ) {\n+      \/\/\n+      \/\/ Meet unloaded class with java\/lang\/Object\n+      \/\/\n+      \/\/ Meet\n+      \/\/          |                     Unloaded Class\n+      \/\/  Object  |   TOP    |   AnyNull | Constant |   NotNull |  BOTTOM   |\n+      \/\/  ===================================================================\n+      \/\/   TOP    | ..........................Unloaded......................|\n+      \/\/  AnyNull |  U-AN    |................Unloaded......................|\n+      \/\/ Constant | ... O-NN .................................. |   O-BOT   |\n+      \/\/  NotNull | ... O-NN .................................. |   O-BOT   |\n+      \/\/  BOTTOM  | ........................Object-BOTTOM ..................|\n+      \/\/\n+      assert(loaded->ptr() != TypePtr::Null, \"insanity check\");\n+      \/\/\n+      if(      loaded->ptr() == TypePtr::TopPTR ) { return unloaded; }\n+      else if (loaded->ptr() == TypePtr::AnyNull) { return TypeInstPtr::make(ptr, unloaded->klass(), false, NULL, off, instance_id, speculative, depth); }\n+      else if (loaded->ptr() == TypePtr::BotPTR ) { return TypeInstPtr::BOTTOM; }\n+      else if (loaded->ptr() == TypePtr::Constant || loaded->ptr() == TypePtr::NotNull) {\n+        if (unloaded->ptr() == TypePtr::BotPTR  ) { return TypeInstPtr::BOTTOM;  }\n+        else                                      { return TypeInstPtr::NOTNULL; }\n+      }\n+      else if( unloaded->ptr() == TypePtr::TopPTR )  { return unloaded; }\n@@ -4018,6 +3817,9 @@\n-  \/\/ Both are unloaded, not the same class, not Object\n-  \/\/ Or meet unloaded with a different loaded class, not java\/lang\/Object\n-  if (ptr != TypePtr::BotPTR) {\n-    return TypeInstPtr::NOTNULL;\n-  }\n-  return TypeInstPtr::BOTTOM;\n+      return unloaded->cast_to_ptr_type(TypePtr::AnyNull)->is_instptr();\n+    }\n+\n+    \/\/ Both are unloaded, not the same class, not Object\n+    \/\/ Or meet unloaded with a different loaded class, not java\/lang\/Object\n+    if( ptr != TypePtr::BotPTR ) {\n+      return TypeInstPtr::NOTNULL;\n+    }\n+    return TypeInstPtr::BOTTOM;\n@@ -4076,1 +3878,1 @@\n-      return make(ptr, klass(), _interfaces, klass_is_exact(),\n+      return make(ptr, klass(), klass_is_exact(),\n@@ -4104,1 +3906,1 @@\n-      return make(ptr, klass(), _interfaces, klass_is_exact(),\n+      return make(ptr, klass(), klass_is_exact(),\n@@ -4138,2 +3940,0 @@\n-    InterfaceSet interfaces = meet_interfaces(tinst);\n-\n@@ -4142,0 +3942,2 @@\n+    bool tinst_xk = tinst->klass_is_exact();\n+    bool this_xk  = klass_is_exact();\n@@ -4146,2 +3948,1 @@\n-    MeetResult kind = meet_instptr(ptr, interfaces, this, tinst, res_klass, res_xk);\n-\n+    MeetResult kind = meet_instptr(ptr, this_klass, tinst_klass, this_xk, tinst_xk, this->_ptr, tinst->_ptr, res_klass, res_xk);\n@@ -4150,1 +3951,1 @@\n-      const TypeInstPtr* unloaded_meet = xmeet_unloaded(tinst, interfaces);\n+      const TypeInstPtr* unloaded_meet = xmeet_unloaded(tinst);\n@@ -4187,1 +3988,1 @@\n-      res = make(ptr, res_klass, interfaces, res_xk, o, off, instance_id, speculative, depth);\n+      res = make(ptr, res_klass, res_xk, o, off, instance_id, speculative, depth);\n@@ -4198,10 +3999,4 @@\n-template<class T> TypePtr::MeetResult TypePtr::meet_instptr(PTR& ptr, InterfaceSet& interfaces, const T* this_type, const T* other_type,\n-                      ciKlass*& res_klass, bool& res_xk) {\n-  ciKlass* this_klass = this_type->klass();\n-  ciKlass* other_klass = other_type->klass();\n-  bool this_xk = this_type->klass_is_exact();\n-  bool other_xk = other_type->klass_is_exact();\n-  PTR this_ptr = this_type->ptr();\n-  PTR other_ptr = other_type->ptr();\n-  InterfaceSet this_interfaces = this_type->interfaces();\n-  InterfaceSet other_interfaces = other_type->interfaces();\n+TypePtr::MeetResult TypePtr::meet_instptr(PTR &ptr, ciKlass* this_klass, ciKlass* tinst_klass, bool this_xk, bool tinst_xk,\n+                                          PTR this_ptr,\n+                                          PTR tinst_ptr, ciKlass*&res_klass, bool &res_xk) {\n+\n@@ -4212,1 +4007,1 @@\n-  if (ptr != Constant && this_klass->equals(other_klass) && this_xk == other_xk) {\n+  if (ptr != Constant && this_klass->equals(tinst_klass) && this_xk == tinst_xk) {\n@@ -4219,1 +4014,1 @@\n-  if (!other_klass->is_loaded() || !this_klass->is_loaded()) {\n+  if (!tinst_klass->is_loaded() || !this_klass->is_loaded()) {\n@@ -4223,0 +4018,41 @@\n+  \/\/ Handle mixing oops and interfaces first.\n+  if (this_klass->is_interface() && !(tinst_klass->is_interface() ||\n+                                      tinst_klass == ciEnv::current()->Object_klass())) {\n+    ciKlass *tmp = tinst_klass; \/\/ Swap interface around\n+    tinst_klass = this_klass;\n+    this_klass = tmp;\n+    bool tmp2 = tinst_xk;\n+    tinst_xk = this_xk;\n+    this_xk = tmp2;\n+  }\n+  if (tinst_klass->is_interface() &&\n+      !(this_klass->is_interface() ||\n+        \/\/ Treat java\/lang\/Object as an honorary interface,\n+        \/\/ because we need a bottom for the interface hierarchy.\n+        this_klass == ciEnv::current()->Object_klass())) {\n+    \/\/ Oop meets interface!\n+\n+    \/\/ See if the oop subtypes (implements) interface.\n+    if (this_klass->is_subtype_of(tinst_klass)) {\n+      \/\/ Oop indeed subtypes.  Now keep oop or interface depending\n+      \/\/ on whether we are both above the centerline or either is\n+      \/\/ below the centerline.  If we are on the centerline\n+      \/\/ (e.g., Constant vs. AnyNull interface), use the constant.\n+      res_klass  = below_centerline(ptr) ? tinst_klass : this_klass;\n+      \/\/ If we are keeping this_klass, keep its exactness too.\n+      res_xk = below_centerline(ptr) ? tinst_xk    : this_xk;\n+      return SUBTYPE;\n+    } else {                  \/\/ Does not implement, fall to Object\n+      \/\/ Oop does not implement interface, so mixing falls to Object\n+      \/\/ just like the verifier does (if both are above the\n+      \/\/ centerline fall to interface)\n+      res_klass = above_centerline(ptr) ? tinst_klass : ciEnv::current()->Object_klass();\n+      res_xk = above_centerline(ptr) ? tinst_xk : false;\n+      \/\/ Watch out for Constant vs. AnyNull interface.\n+      if (ptr == Constant)  ptr = NotNull;   \/\/ forget it was a constant\n+      return NOT_SUBTYPE;\n+    }\n+  }\n+\n+  \/\/ Either oop vs oop or interface vs interface or interface vs Object\n+\n@@ -4248,1 +4084,1 @@\n-  const T* subtype = NULL;\n+  ciKlass *subtype = NULL;\n@@ -4250,7 +4086,5 @@\n-  InterfaceSet subtype_interfaces;\n-\n-  if (this_type->is_same_java_type_as(other_type)) {\n-    subtype = this_type;\n-    subtype_exact = below_centerline(ptr) ? (this_xk && other_xk) : (this_xk || other_xk);\n-  } else if (!other_xk && this_type->is_meet_subtype_of(other_type)) {\n-    subtype = this_type;     \/\/ Pick subtyping class\n+  if (tinst_klass->equals(this_klass)) {\n+    subtype = this_klass;\n+    subtype_exact = below_centerline(ptr) ? (this_xk && tinst_xk) : (this_xk || tinst_xk);\n+  } else if (!tinst_xk && this_klass->is_subtype_of(tinst_klass)) {\n+    subtype = this_klass;     \/\/ Pick subtyping class\n@@ -4258,3 +4092,3 @@\n-  } else if(!this_xk && other_type->is_meet_subtype_of(this_type)) {\n-    subtype = other_type;    \/\/ Pick subtyping class\n-    subtype_exact = other_xk;\n+  } else if (!this_xk && tinst_klass->is_subtype_of(this_klass)) {\n+    subtype = tinst_klass;    \/\/ Pick subtyping class\n+    subtype_exact = tinst_xk;\n@@ -4265,8 +4099,8 @@\n-      this_type = other_type = subtype;\n-      this_xk = other_xk = subtype_exact;\n-    } else if (above_centerline(this_ptr) && !above_centerline(other_ptr)) {\n-      this_type = other_type; \/\/ tinst is down; keep down man\n-      this_xk = other_xk;\n-    } else if (above_centerline(other_ptr) && !above_centerline(this_ptr)) {\n-      other_type = this_type; \/\/ this is down; keep down man\n-      other_xk = this_xk;\n+      this_klass = tinst_klass = subtype;\n+      this_xk = tinst_xk = subtype_exact;\n+    } else if (above_centerline(this_ptr) && !above_centerline(tinst_ptr)) {\n+      this_klass = tinst_klass; \/\/ tinst is down; keep down man\n+      this_xk = tinst_xk;\n+    } else if (above_centerline(tinst_ptr) && !above_centerline(this_ptr)) {\n+      tinst_klass = this_klass; \/\/ this is down; keep down man\n+      tinst_xk = this_xk;\n@@ -4279,1 +4113,1 @@\n-  if (this_type->is_same_java_type_as(other_type)) {\n+  if (tinst_klass->equals(this_klass)) {\n@@ -4283,1 +4117,1 @@\n-    res_klass = this_type->klass();\n+    res_klass = this_klass;\n@@ -4294,2 +4128,0 @@\n-  interfaces = this_interfaces.intersection_with(other_interfaces);\n-\n@@ -4297,1 +4129,1 @@\n-  ciKlass* k = this_klass->least_common_ancestor(other_klass);\n+  ciKlass* k = this_klass->least_common_ancestor(tinst_klass);\n@@ -4305,0 +4137,1 @@\n+\n@@ -4321,1 +4154,1 @@\n-  return new TypeInstPtr(dual_ptr(), klass(), _interfaces, klass_is_exact(), const_oop(), dual_offset(), dual_instance_id(), dual_speculative(), dual_inline_depth());\n+  return new TypeInstPtr(dual_ptr(), klass(), klass_is_exact(), const_oop(), dual_offset(), dual_instance_id(), dual_speculative(), dual_inline_depth());\n@@ -4330,1 +4163,0 @@\n-    _interfaces.eq(p->_interfaces) &&\n@@ -4337,1 +4169,1 @@\n-  int hash = java_add(java_add((jint)klass()->hash(), (jint)TypeOopPtr::hash()), _interfaces.hash());\n+  int hash = java_add((jint)klass()->hash(), (jint)TypeOopPtr::hash());\n@@ -4342,2 +4174,14 @@\n-  return TypePtr::is_java_subtype_of_helper_for_instance(this, other, this_exact, other_exact);\n-}\n+  if (!is_loaded() || !other->is_loaded()) {\n+    return false;\n+  }\n+  if (!other->isa_instptr()) {\n+    return false;\n+  }\n+\n+  if (!other_exact) {\n+    return false;\n+  }\n+\n+  if (other->klass()->equals(ciEnv::current()->Object_klass())) {\n+    return true;\n+  }\n@@ -4345,0 +4189,3 @@\n+  if (!this_exact && klass()->is_interface()) {\n+    return false;\n+  }\n@@ -4346,2 +4193,11 @@\n-bool TypeInstPtr::is_same_java_type_as_helper(const TypeOopPtr* other) const {\n-  return TypePtr::is_same_java_type_as_helper_for_instance(this, other);\n+  return _klass->is_subtype_of(other->klass());\n+}\n+\n+bool TypeInstPtr::is_same_java_type_as(const TypeOopPtr* other) const {\n+  if (!is_loaded() || !other->is_loaded()) {\n+    return false;\n+  }\n+  if (!other->isa_instptr()) {\n+    return false;\n+  }\n+  return _klass->equals(other->_klass);\n@@ -4351,1 +4207,27 @@\n-  return TypePtr::maybe_java_subtype_of_helper_for_instance(this, other, this_exact, other_exact);\n+  if (!is_loaded() || !other->is_loaded()) {\n+    return true;\n+  }\n+\n+  if (other->isa_aryptr()) {\n+    return !this_exact && (_klass->equals(ciEnv::current()->Object_klass()) || _klass->is_interface());\n+  }\n+\n+  if ((_klass->is_interface() && !this_exact) || (other->klass()->is_interface() \/*&& !other_exact*\/)) {\n+    return true;\n+  }\n+\n+  assert(other->isa_instptr(), \"unsupported\");\n+\n+  if (this_exact && other_exact) {\n+    return is_java_subtype_of(other);\n+  }\n+\n+  if (!_klass->is_subtype_of(other->_klass) && !other->_klass->is_subtype_of(_klass)) {\n+    return false;\n+  }\n+\n+  if (this_exact) {\n+    return _klass->is_subtype_of(other->_klass);\n+  }\n+\n+  return true;\n@@ -4361,1 +4243,0 @@\n-  _interfaces.dump(st);\n@@ -4411,1 +4292,1 @@\n-  return make(_ptr, klass(), _interfaces, klass_is_exact(), const_oop(), xadd_offset(offset),\n+  return make(_ptr, klass(), klass_is_exact(), const_oop(), xadd_offset(offset),\n@@ -4416,1 +4297,1 @@\n-  return make(_ptr, klass(), _interfaces, klass_is_exact(), const_oop(), offset,\n+  return make(_ptr, klass(), klass_is_exact(), const_oop(), offset,\n@@ -4425,1 +4306,1 @@\n-  return make(_ptr, klass(), _interfaces, klass_is_exact(), const_oop(), _offset,\n+  return make(_ptr, klass(), klass_is_exact(), const_oop(), _offset,\n@@ -4429,1 +4310,1 @@\n-const TypePtr* TypeInstPtr::with_inline_depth(int depth) const {\n+const TypePtr *TypeInstPtr::with_inline_depth(int depth) const {\n@@ -4433,1 +4314,1 @@\n-  return make(_ptr, klass(), _interfaces, klass_is_exact(), const_oop(), _offset, _instance_id, _speculative, depth);\n+  return make(_ptr, klass(), klass_is_exact(), const_oop(), _offset, _instance_id, _speculative, depth);\n@@ -4436,1 +4317,1 @@\n-const TypePtr* TypeInstPtr::with_instance_id(int instance_id) const {\n+const TypePtr *TypeInstPtr::with_instance_id(int instance_id) const {\n@@ -4438,1 +4319,1 @@\n-  return make(_ptr, klass(), _interfaces, klass_is_exact(), const_oop(), _offset, instance_id, _speculative, _inline_depth);\n+  return make(_ptr, klass(), klass_is_exact(), const_oop(), _offset, instance_id, _speculative, _inline_depth);\n@@ -4444,59 +4325,5 @@\n-  if (try_for_exact && !xk && !ik->has_subklass() && !ik->is_final()) {\n-    ciKlass* k = ik;\n-    TypePtr::InterfaceSet interfaces = TypePtr::interfaces(k, true, false, false, ignore_interfaces);\n-    assert(k == ik, \"\");\n-    if (interfaces.eq(_interfaces)) {\n-      Compile *C = Compile::current();\n-      Dependencies* deps = C->dependencies();\n-      deps->assert_leaf_type(ik);\n-      xk = true;\n-    }\n-  }\n-  return TypeInstKlassPtr::make(xk ? TypePtr::Constant : TypePtr::NotNull, klass(), _interfaces, 0);\n-}\n-\n-template <class T1, class T2> bool TypePtr::is_meet_subtype_of_helper_for_instance(const T1* this_one, const T2* other, bool this_xk, bool other_xk) {\n-  static_assert(std::is_base_of<T2, T1>::value, \"\");\n-\n-  if (!this_one->is_instance_type(other)) {\n-    return false;\n-  }\n-\n-  if (other->klass() == ciEnv::current()->Object_klass() && other->_interfaces.empty()) {\n-    return true;\n-  }\n-\n-  return this_one->klass()->is_subtype_of(other->klass()) &&\n-         (!this_xk || this_one->_interfaces.contains(other->_interfaces));\n-}\n-\n-\n-bool TypeInstPtr::is_meet_subtype_of_helper(const TypeOopPtr *other, bool this_xk, bool other_xk) const {\n-  return TypePtr::is_meet_subtype_of_helper_for_instance(this, other, this_xk, other_xk);\n-}\n-\n-template <class T1, class T2>  bool TypePtr::is_meet_subtype_of_helper_for_array(const T1* this_one, const T2* other, bool this_xk, bool other_xk) {\n-  static_assert(std::is_base_of<T2, T1>::value, \"\");\n-  if (other->klass() == ciEnv::current()->Object_klass() && other->_interfaces.empty()) {\n-    return true;\n-  }\n-\n-  if (this_one->is_instance_type(other)) {\n-    return other->klass() == ciEnv::current()->Object_klass() && this_one->_interfaces.contains(other->_interfaces);\n-  }\n-\n-  int dummy;\n-  bool this_top_or_bottom = (this_one->base_element_type(dummy) == Type::TOP || this_one->base_element_type(dummy) == Type::BOTTOM);\n-  if (this_top_or_bottom) {\n-    return false;\n-  }\n-\n-  const T1* other_ary = this_one->is_array_type(other);\n-  const TypePtr* other_elem = other_ary->elem()->make_ptr();\n-  const TypePtr* this_elem = this_one->elem()->make_ptr();\n-  if (other_elem != NULL && this_elem != NULL) {\n-    return this_one->is_reference_type(this_elem)->is_meet_subtype_of_helper(this_one->is_reference_type(other_elem), this_xk, other_xk);\n-  }\n-\n-  if (other_elem == NULL && this_elem == NULL) {\n-    return this_one->_klass->is_subtype_of(other->_klass);\n+  if (try_for_exact && !xk && !ik->has_subklass() && !ik->is_final() && !ik->is_interface()) {\n+    Compile* C = Compile::current();\n+    Dependencies* deps = C->dependencies();\n+    deps->assert_leaf_type(ik);\n+    xk = true;\n@@ -4504,14 +4331,1 @@\n-\n-  return false;\n-}\n-\n-bool TypeAryPtr::is_meet_subtype_of_helper(const TypeOopPtr *other, bool this_xk, bool other_xk) const {\n-  return TypePtr::is_meet_subtype_of_helper_for_array(this, other, this_xk, other_xk);\n-}\n-\n-bool TypeInstKlassPtr::is_meet_subtype_of_helper(const TypeKlassPtr *other, bool this_xk, bool other_xk) const {\n-  return TypePtr::is_meet_subtype_of_helper_for_instance(this, other, this_xk, other_xk);\n-}\n-\n-bool TypeAryKlassPtr::is_meet_subtype_of_helper(const TypeKlassPtr *other, bool this_xk, bool other_xk) const {\n-  return TypePtr::is_meet_subtype_of_helper_for_array(this, other, this_xk, other_xk);\n+  return TypeInstKlassPtr::make(xk ? TypePtr::Constant : TypePtr::NotNull, klass(), 0);\n@@ -4540,4 +4354,0 @@\n-  if (k != NULL && k->is_loaded() && k->is_obj_array_klass() &&\n-      k->as_obj_array_klass()->base_element_klass()->is_interface()) {\n-    k = NULL;\n-  }\n@@ -4556,4 +4366,0 @@\n-  if (k != NULL && k->is_loaded() && k->is_obj_array_klass() &&\n-      k->as_obj_array_klass()->base_element_klass()->is_interface()) {\n-    k = NULL;\n-  }\n@@ -4587,1 +4393,1 @@\n-  if (!is_java_primitive(etype) && !::is_reference_type(etype)) {\n+  if (!is_java_primitive(etype) && !is_reference_type(etype)) {\n@@ -4695,1 +4501,22 @@\n-  return TypePtr::is_java_subtype_of_helper_for_array(this, other, this_exact, other_exact);\n+  if (other->klass() == ciEnv::current()->Object_klass() && other_exact) {\n+    return true;\n+  }\n+\n+  if (!is_loaded() || !other->is_loaded() || other->klass() == NULL || klass() == NULL) {\n+    return false;\n+  }\n+  if (other->isa_instptr()) {\n+    return _klass->is_subtype_of(other->_klass) && other_exact;\n+  }\n+  if (klass() == NULL) {\n+    return false;\n+  }\n+  assert(other->isa_aryptr(), \"\");\n+  const TypeAryPtr* other_ary = other->isa_aryptr();\n+  if (other_ary->elem()->make_oopptr() && elem()->make_oopptr()) {\n+    return elem()->make_oopptr()->is_java_subtype_of_helper(other_ary->elem()->make_oopptr(), this_exact, other_exact);\n+  }\n+  if (!other_ary->elem()->make_oopptr() && !elem()->make_oopptr()) {\n+    return _klass->is_subtype_of(other->_klass);\n+  }\n+  return false;\n@@ -4698,2 +4525,13 @@\n-bool TypeAryPtr::is_same_java_type_as_helper(const TypeOopPtr* other) const {\n-  return TypePtr::is_same_java_type_as_helper_for_array(this, other);\n+bool TypeAryPtr::is_same_java_type_as(const TypeOopPtr* other) const {\n+  if (!other->isa_aryptr() ||\n+      !is_loaded() || !other->is_loaded() || klass() == NULL || other->klass() == NULL) {\n+    return false;\n+  }\n+  const TypeAryPtr* other_ary = other->isa_aryptr();\n+  if (other_ary->elem()->make_oopptr() && elem()->make_oopptr()) {\n+    return elem()->make_oopptr()->is_same_java_type_as(other_ary->elem()->make_oopptr());\n+  }\n+  if (!other_ary->elem()->make_oopptr() && !elem()->make_oopptr()) {\n+    return _klass->equals(other->_klass);\n+  }\n+  return false;\n@@ -4703,1 +4541,25 @@\n-  return TypePtr::maybe_java_subtype_of_helper_for_array(this, other, this_exact, other_exact);\n+  if (other->klass() == ciEnv::current()->Object_klass()) {\n+    return true;\n+  }\n+\n+  if (!is_loaded() || !other->is_loaded() || klass() == NULL || other->klass() == NULL) {\n+    return true;\n+  }\n+  if (other->isa_instptr()) {\n+    return (!other_exact && other->_klass->is_interface()) || _klass->is_subtype_of(other->_klass);\n+  }\n+  assert(other->isa_aryptr(), \"\");\n+\n+  if (this_exact && other_exact) {\n+    return is_java_subtype_of(other);\n+  }\n+\n+  const TypeAryPtr* other_ary = other->isa_aryptr();\n+  if (other_ary->elem()->make_oopptr() && elem()->make_oopptr()) {\n+    return elem()->make_oopptr()->maybe_java_subtype_of_helper(other_ary->elem()->make_oopptr(), this_exact,\n+                                                               other_exact);\n+  }\n+  if (!other_ary->elem()->make_oopptr() && !elem()->make_oopptr()) {\n+    return _klass->is_subtype_of(other->_klass);\n+  }\n+  return false;\n@@ -4798,1 +4660,1 @@\n-    if (meet_aryptr(ptr, elem, this, tap, res_klass, res_xk) == NOT_SUBTYPE) {\n+    if (meet_aryptr(ptr, elem, this->klass(), tap->klass(), this->klass_is_exact(), tap->klass_is_exact(), this->ptr(), tap->ptr(), res_klass, res_xk) == NOT_SUBTYPE) {\n@@ -4828,4 +4690,0 @@\n-    InterfaceSet interfaces = meet_interfaces(tp);\n-    InterfaceSet tp_interfaces = tp->_interfaces;\n-    InterfaceSet this_interfaces = _interfaces;\n-\n@@ -4838,2 +4696,2 @@\n-      if (tp->klass()->equals(ciEnv::current()->Object_klass()) && this_interfaces.contains(tp_interfaces) && !tp->klass_is_exact()) {\n-        return TypeAryPtr::make(ptr, _ary, _klass, _klass_is_exact, offset, instance_id, speculative, depth);\n+      if (tp->klass()->equals(ciEnv::current()->Object_klass()) && !tp->klass_is_exact()) {\n+        return make(ptr, _ary, _klass, _klass_is_exact, offset, instance_id, speculative, depth);\n@@ -4844,2 +4702,1 @@\n-        interfaces = this_interfaces.intersection_with(tp_interfaces);\n-        return TypeInstPtr::make(ptr, ciEnv::current()->Object_klass(), interfaces, false, NULL,offset, instance_id, speculative, depth);\n+        return TypeInstPtr::make(ptr, ciEnv::current()->Object_klass(), false, NULL,offset, instance_id, speculative, depth);\n@@ -4857,1 +4714,1 @@\n-        if (tp->klass()->equals(ciEnv::current()->Object_klass()) && this_interfaces.contains(tp_interfaces) && !tp->klass_is_exact()) {\n+        if (tp->klass()->equals(ciEnv::current()->Object_klass()) && !tp->klass_is_exact()) {\n@@ -4871,2 +4728,1 @@\n-      interfaces = this_interfaces.intersection_with(tp_interfaces);\n-      return TypeInstPtr::make(ptr, ciEnv::current()->Object_klass(), interfaces, false, NULL, offset, instance_id, speculative, depth);\n+      return TypeInstPtr::make(ptr, ciEnv::current()->Object_klass(), false, NULL, offset, instance_id, speculative, depth);\n@@ -4881,8 +4737,1 @@\n-template<class T> TypePtr::MeetResult TypePtr::meet_aryptr(PTR& ptr, const Type*& elem, const T* this_ary,\n-                                                           const T* other_ary, ciKlass*& res_klass, bool& res_xk) {\n-  ciKlass* this_klass = this_ary->klass();\n-  ciKlass* other_klass = other_ary->klass();\n-  bool this_xk = this_ary->klass_is_exact();\n-  bool other_xk = other_ary->klass_is_exact();\n-  PTR this_ptr = this_ary->ptr();\n-  PTR other_ptr = other_ary->ptr();\n+TypePtr::MeetResult TypePtr::meet_aryptr(PTR& ptr, const Type*& elem, ciKlass* this_klass, ciKlass* tap_klass, bool this_xk, bool tap_xk, PTR this_ptr, PTR tap_ptr, ciKlass*& res_klass, bool& res_xk) {\n@@ -4895,2 +4744,2 @@\n-      res_klass = other_klass;\n-    else if (other_klass == NULL || other_klass == this_klass) {\n+      res_klass = tap_klass;\n+    else if (tap_klass == NULL || tap_klass == this_klass) {\n@@ -4905,1 +4754,1 @@\n-  } else {\/\/ Non integral arrays.\n+  } else \/\/ Non integral arrays.\n@@ -4908,4 +4757,1 @@\n-    int dummy;\n-    bool this_top_or_bottom = (this_ary->base_element_type(dummy) == Type::TOP || this_ary->base_element_type(dummy) == Type::BOTTOM);\n-    bool other_top_or_bottom = (other_ary->base_element_type(dummy) == Type::TOP || other_ary->base_element_type(dummy) == Type::BOTTOM);\n-    if ((above_centerline(ptr) || ptr == Constant) && !this_ary->is_same_java_type_as(other_ary) &&\n+    if ((above_centerline(ptr) || ptr == Constant) && this_klass != tap_klass &&\n@@ -4913,1 +4759,1 @@\n-        !this_top_or_bottom && !other_top_or_bottom &&\n+        tap_klass != NULL  && this_klass != NULL   &&\n@@ -4915,1 +4761,1 @@\n-        ((other_xk && this_xk) ||\n+        ((tap_xk && this_xk) ||\n@@ -4917,1 +4763,1 @@\n-         (other_xk && !other_ary->is_meet_subtype_of(this_ary)) ||\n+         (tap_xk && !tap_klass->is_subtype_of(this_klass)) ||\n@@ -4919,1 +4765,1 @@\n-         (this_xk && !this_ary->is_meet_subtype_of(other_ary)))) {\n+         (this_xk && !this_klass->is_subtype_of(tap_klass)))) {\n@@ -4927,1 +4773,0 @@\n-  }\n@@ -4930,1 +4775,1 @@\n-  switch (other_ptr) {\n+  switch (tap_ptr) {\n@@ -4937,1 +4782,1 @@\n-        res_xk = (other_xk || this_xk);\n+        res_xk = (tap_xk || this_xk);\n@@ -4947,1 +4792,1 @@\n-        res_xk = this_xk && this_ary->is_same_java_type_as(other_ary);\n+        res_xk = this_xk && (this_klass == tap_klass);\n@@ -4955,1 +4800,1 @@\n-        res_xk = other_xk;\n+        res_xk = tap_xk;\n@@ -4957,2 +4802,2 @@\n-        res_xk = (other_xk && this_xk) &&\n-                 (this_ary->is_same_java_type_as(other_ary)); \/\/ Only precise for identical arrays\n+        res_xk = (tap_xk && this_xk) &&\n+          (this_klass == tap_klass); \/\/ Only precise for identical arrays\n@@ -4976,0 +4821,11 @@\n+\/\/----------------------interface_vs_oop---------------------------------------\n+#ifdef ASSERT\n+bool TypeAryPtr::interface_vs_oop(const Type *t) const {\n+  const TypeAryPtr* t_aryptr = t->isa_aryptr();\n+  if (t_aryptr) {\n+    return _ary->interface_vs_oop(t_aryptr->_ary);\n+  }\n+  return false;\n+}\n+#endif\n+\n@@ -4980,2 +4836,0 @@\n-  _interfaces.dump(st);\n-\n@@ -5034,1 +4888,1 @@\n-const TypePtr* TypeAryPtr::add_offset(intptr_t offset) const {\n+const TypePtr *TypeAryPtr::add_offset(intptr_t offset) const {\n@@ -5054,1 +4908,1 @@\n-const TypePtr* TypeAryPtr::with_inline_depth(int depth) const {\n+const TypePtr *TypeAryPtr::with_inline_depth(int depth) const {\n@@ -5061,1 +4915,1 @@\n-const TypePtr* TypeAryPtr::with_instance_id(int instance_id) const {\n+const TypePtr *TypeAryPtr::with_instance_id(int instance_id) const {\n@@ -5246,1 +5100,1 @@\n-const TypePtr* TypeMetadataPtr::add_offset( intptr_t offset ) const {\n+const TypePtr *TypeMetadataPtr::add_offset( intptr_t offset ) const {\n@@ -5421,1 +5275,1 @@\n-const TypeKlassPtr* TypeKlassPtr::make(ciKlass *klass, InterfaceHandling interface_handling) {\n+const TypeKlassPtr* TypeKlassPtr::make(ciKlass *klass) {\n@@ -5423,1 +5277,1 @@\n-    return TypeInstKlassPtr::make(klass, interface_handling);\n+    return TypeInstKlassPtr::make(klass);\n@@ -5425,1 +5279,1 @@\n-  return TypeAryKlassPtr::make(klass, interface_handling);\n+  return TypeAryKlassPtr::make(klass);\n@@ -5428,1 +5282,1 @@\n-const TypeKlassPtr* TypeKlassPtr::make(PTR ptr, ciKlass* klass, int offset, InterfaceHandling interface_handling) {\n+const TypeKlassPtr* TypeKlassPtr::make(PTR ptr, ciKlass* klass, int offset) {\n@@ -5430,2 +5284,1 @@\n-    const InterfaceSet interfaces = TypePtr::interfaces(klass, true, true, false, interface_handling);\n-    return TypeInstKlassPtr::make(ptr, klass, interfaces, offset);\n+    return TypeInstKlassPtr::make(ptr, klass, offset);\n@@ -5433,1 +5286,1 @@\n-  return TypeAryKlassPtr::make(ptr, klass, offset, interface_handling);\n+  return TypeAryKlassPtr::make(ptr, klass, offset);\n@@ -5438,4 +5291,2 @@\n-TypeKlassPtr::TypeKlassPtr(TYPES t, PTR ptr, ciKlass* klass, const InterfaceSet& interfaces, int offset)\n-  : TypePtr(t, ptr, offset), _klass(klass), _interfaces(interfaces) {\n-  assert(klass == NULL || !klass->is_loaded() || (klass->is_instance_klass() && !klass->is_interface()) ||\n-         klass->is_type_array_klass() || !klass->as_obj_array_klass()->base_element_klass()->is_interface(), \"no interface here\");\n+TypeKlassPtr::TypeKlassPtr(TYPES t, PTR ptr, ciKlass* klass, int offset)\n+  : TypePtr(t, ptr, offset), _klass(klass) {\n@@ -5444,1 +5295,0 @@\n-\/\/ Is there a single ciKlass* that can represent that type?\n@@ -5446,12 +5296,1 @@\n-  assert(_klass->is_instance_klass() && !_klass->is_interface(), \"No interface\");\n-  if (_interfaces.empty()) {\n-    return _klass;\n-  }\n-  if (_klass != ciEnv::current()->Object_klass()) {\n-    ciKlass* k = _klass;\n-    if (_interfaces.eq(TypePtr::interfaces(k, true, false, true, ignore_interfaces))) {\n-      return _klass;\n-    }\n-    return NULL;\n-  }\n-  return _interfaces.exact_klass();\n+  return _klass;\n@@ -5465,1 +5304,0 @@\n-    _interfaces.eq(p->_interfaces) &&\n@@ -5472,1 +5310,1 @@\n-  return java_add((jint)TypePtr::hash(), _interfaces.hash());\n+  return TypePtr::hash();\n@@ -5493,0 +5331,3 @@\n+    if (!empty() && ktkp != NULL && ktkp->klass()->is_loaded() && ktkp->klass()->is_interface())\n+      return kills;             \/\/ Uplift to interface\n+\n@@ -5496,10 +5337,7 @@\n-  return ft;\n-}\n-\n-TypePtr::InterfaceSet TypeKlassPtr::meet_interfaces(const TypeKlassPtr* other) const {\n-  if (above_centerline(_ptr) && above_centerline(other->_ptr)) {\n-    return _interfaces.union_with(other->_interfaces);\n-  } else if (above_centerline(_ptr) && !above_centerline(other->_ptr)) {\n-    return other->_interfaces;\n-  } else if (above_centerline(other->_ptr) && !above_centerline(_ptr)) {\n-    return _interfaces;\n+  \/\/ Interface klass type could be exact in opposite to interface type,\n+  \/\/ return it here instead of incorrect Constant ptr J\/L\/Object (6894807).\n+  if (ftkp != NULL && ktkp != NULL &&\n+      ftkp->is_loaded() &&  ftkp->klass()->is_interface() &&\n+      !ftkp->klass_is_exact() && \/\/ Keep exact interface klass\n+      ktkp->is_loaded() && !ktkp->klass()->is_interface()) {\n+    return ktkp->cast_to_ptr_type(ftkp->ptr());\n@@ -5507,1 +5345,2 @@\n-  return _interfaces.intersection_with(other->_interfaces);\n+\n+  return ft;\n@@ -5547,1 +5386,0 @@\n-      _interfaces.dump(st);\n@@ -5588,1 +5426,1 @@\n-const TypeInstKlassPtr *TypeInstKlassPtr::make(PTR ptr, ciKlass* k, const InterfaceSet& interfaces, int offset) {\n+const TypeInstKlassPtr *TypeInstKlassPtr::make(PTR ptr, ciKlass* k, int offset) {\n@@ -5590,1 +5428,1 @@\n-    (TypeInstKlassPtr*)(new TypeInstKlassPtr(ptr, k, interfaces, offset))->hashcons();\n+    (TypeInstKlassPtr*)(new TypeInstKlassPtr(ptr, k, offset))->hashcons();\n@@ -5597,2 +5435,2 @@\n-const TypePtr* TypeInstKlassPtr::add_offset( intptr_t offset ) const {\n-  return make( _ptr, klass(), _interfaces, xadd_offset(offset) );\n+const TypePtr *TypeInstKlassPtr::add_offset( intptr_t offset ) const {\n+  return make( _ptr, klass(), xadd_offset(offset) );\n@@ -5602,1 +5440,1 @@\n-  return make(_ptr, klass(), _interfaces, offset);\n+  return make(_ptr, klass(), offset);\n@@ -5609,1 +5447,1 @@\n-  return make(ptr, _klass, _interfaces, _offset);\n+  return make(ptr, _klass, _offset);\n@@ -5625,1 +5463,1 @@\n-  return make(klass_is_exact ? Constant : NotNull, k, _interfaces, _offset);\n+  return make(klass_is_exact ? Constant : NotNull, k, _offset);\n@@ -5640,1 +5478,0 @@\n-  TypePtr::InterfaceSet interfaces = _interfaces;\n@@ -5649,8 +5486,3 @@\n-        ciKlass* sub_k = sub;\n-        TypePtr::InterfaceSet sub_interfaces = TypePtr::interfaces(sub_k, true, false, false, ignore_interfaces);\n-        assert(sub_k == sub, \"\");\n-        if (sub_interfaces.eq(_interfaces)) {\n-          deps->assert_abstract_with_unique_concrete_subtype(ik, sub);\n-          k = ik = sub;\n-          xk = sub->is_final();\n-        }\n+        deps->assert_abstract_with_unique_concrete_subtype(ik, sub);\n+        k = ik = sub;\n+        xk = sub->is_final();\n@@ -5660,1 +5492,1 @@\n-  return TypeInstPtr::make(TypePtr::BotPTR, k, interfaces, xk, NULL, 0);\n+  return TypeInstPtr::make(TypePtr::BotPTR, k, xk, NULL, 0);\n@@ -5701,1 +5533,1 @@\n-      return make( ptr, klass(), _interfaces, offset );\n+      return make( ptr, klass(), offset );\n@@ -5736,1 +5568,4 @@\n-    InterfaceSet interfaces = meet_interfaces(tkls);\n+    ciKlass* tkls_klass = tkls->klass();\n+    ciKlass* this_klass  = klass();\n+    bool tkls_xk = tkls->klass_is_exact();\n+    bool this_xk  = klass_is_exact();\n@@ -5740,1 +5575,1 @@\n-    switch(meet_instptr(ptr, interfaces, this, tkls, res_klass, res_xk)) {\n+    switch(meet_instptr(ptr, this_klass, tkls_klass, this_xk, tkls_xk, this->_ptr, tkls->_ptr, res_klass, res_xk)) {\n@@ -5748,2 +5583,2 @@\n-        const Type* res = make(ptr, res_klass, interfaces, off);\n-        return res;\n+        const Type* res1 = make(ptr, res_klass, off);\n+        return res1;\n@@ -5759,3 +5594,0 @@\n-    InterfaceSet interfaces = meet_interfaces(tp);\n-    InterfaceSet tp_interfaces = tp->_interfaces;\n-    InterfaceSet this_interfaces = _interfaces;\n@@ -5769,1 +5601,1 @@\n-      if (klass()->equals(ciEnv::current()->Object_klass()) && tp_interfaces.contains(this_interfaces) && !klass_is_exact()) {\n+      if (klass()->equals(ciEnv::current()->Object_klass()) && !klass_is_exact()) {\n@@ -5774,2 +5606,1 @@\n-        interfaces = _interfaces.intersection_with(tp->_interfaces);\n-        return make(ptr, ciEnv::current()->Object_klass(), interfaces, offset);\n+        return make(ptr, ciEnv::current()->Object_klass(), offset);\n@@ -5787,1 +5618,1 @@\n-        if (klass()->equals(ciEnv::current()->Object_klass()) && tp_interfaces.contains(this_interfaces) && !klass_is_exact()) {\n+        if (klass()->equals(ciEnv::current()->Object_klass())) {\n@@ -5797,2 +5628,1 @@\n-      interfaces = this_interfaces.intersection_with(tp_interfaces);\n-      return make(ptr, ciEnv::current()->Object_klass(), interfaces, offset);\n+      return make(ptr, ciEnv::current()->Object_klass(), offset);\n@@ -5810,1 +5640,1 @@\n-  return new TypeInstKlassPtr(dual_ptr(), klass(), _interfaces, dual_offset());\n+  return new TypeInstKlassPtr(dual_ptr(), klass(), dual_offset());\n@@ -5813,3 +5643,2 @@\n-template <class T1, class T2> bool TypePtr::is_java_subtype_of_helper_for_instance(const T1* this_one, const T2* other, bool this_exact, bool other_exact) {\n-  static_assert(std::is_base_of<T2, T1>::value, \"\");\n-  if (!this_one->is_loaded() || !other->is_loaded()) {\n+bool TypeInstKlassPtr::is_java_subtype_of_helper(const TypeKlassPtr* other, bool this_exact, bool other_exact) const {\n+  if (!is_loaded() || !other->is_loaded()) {\n@@ -5818,1 +5647,1 @@\n-  if (!this_one->is_instance_type(other)) {\n+  if (!other->isa_instklassptr()) {\n@@ -5826,1 +5655,1 @@\n-  if (other->klass()->equals(ciEnv::current()->Object_klass()) && other->_interfaces.empty()) {\n+  if (other->_klass->equals(ciEnv::current()->Object_klass())) {\n@@ -5830,2 +5659,3 @@\n-  return this_one->_klass->is_subtype_of(other->_klass) && this_one->_interfaces.contains(other->_interfaces);\n-}\n+  if (!this_exact && klass()->is_interface()) {\n+    return false;\n+  }\n@@ -5833,2 +5663,1 @@\n-bool TypeInstKlassPtr::is_java_subtype_of_helper(const TypeKlassPtr* other, bool this_exact, bool other_exact) const {\n-  return TypePtr::is_java_subtype_of_helper_for_instance(this, other, this_exact, other_exact);\n+  return _klass->is_subtype_of(other->_klass);\n@@ -5837,3 +5666,2 @@\n-template <class T1, class T2> bool TypePtr::is_same_java_type_as_helper_for_instance(const T1* this_one, const T2* other) {\n-  static_assert(std::is_base_of<T2, T1>::value, \"\");\n-  if (!this_one->is_loaded() || !other->is_loaded()) {\n+bool TypeInstKlassPtr::is_same_java_type_as(const TypeKlassPtr* other) const {\n+  if (!is_loaded() || !other->is_loaded()) {\n@@ -5842,1 +5670,1 @@\n-  if (!this_one->is_instance_type(other)) {\n+  if (!other->isa_instklassptr()) {\n@@ -5845,1 +5673,1 @@\n-  return this_one->_klass->equals(other->_klass) && this_one->_interfaces.eq(other->_interfaces);\n+  return _klass->equals(other->_klass);\n@@ -5848,7 +5676,2 @@\n-bool TypeInstKlassPtr::is_same_java_type_as_helper(const TypeKlassPtr* other) const {\n-  return TypePtr::is_same_java_type_as_helper_for_instance(this, other);\n-}\n-\n-template <class T1, class T2> bool TypePtr::maybe_java_subtype_of_helper_for_instance(const T1* this_one, const T2* other, bool this_exact, bool other_exact) {\n-  static_assert(std::is_base_of<T2, T1>::value, \"\");\n-  if (!this_one->is_loaded() || !other->is_loaded()) {\n+bool TypeInstKlassPtr::maybe_java_subtype_of_helper(const TypeKlassPtr* other, bool this_exact, bool other_exact) const {\n+  if (!is_loaded() || !other->is_loaded()) {\n@@ -5858,2 +5681,6 @@\n-  if (this_one->is_array_type(other)) {\n-    return !this_exact && this_one->_klass->equals(ciEnv::current()->Object_klass())  && other->_interfaces.contains(this_one->_interfaces);\n+  if (other->isa_aryklassptr()) {\n+    return !this_exact && (_klass->equals(ciEnv::current()->Object_klass()) || _klass->is_interface());\n+  }\n+\n+  if ((_klass->is_interface() && !this_exact) || (other->klass()->is_interface() \/*&& !other_exact*\/)) {\n+    return true;\n@@ -5862,1 +5689,1 @@\n-  assert(this_one->is_instance_type(other), \"unsupported\");\n+  assert(other->isa_instklassptr(), \"unsupported\");\n@@ -5865,1 +5692,1 @@\n-    return this_one->is_java_subtype_of(other);\n+    return is_java_subtype_of(other);\n@@ -5868,1 +5695,1 @@\n-  if (!this_one->_klass->is_subtype_of(other->_klass) && !other->_klass->is_subtype_of(this_one->_klass)) {\n+  if (!_klass->is_subtype_of(other->_klass) && !other->_klass->is_subtype_of(_klass)) {\n@@ -5873,1 +5700,1 @@\n-    return this_one->_klass->is_subtype_of(other->_klass) && this_one->_interfaces.contains(other->_interfaces);\n+    return _klass->is_subtype_of(other->_klass);\n@@ -5879,36 +5706,0 @@\n-bool TypeInstKlassPtr::maybe_java_subtype_of_helper(const TypeKlassPtr* other, bool this_exact, bool other_exact) const {\n-  return TypePtr::maybe_java_subtype_of_helper_for_instance(this, other, this_exact, other_exact);\n-}\n-\n-const TypeKlassPtr* TypeInstKlassPtr::try_improve() const {\n-  if (!UseUniqueSubclasses) {\n-    return this;\n-  }\n-  ciKlass* k = klass();\n-  Compile* C = Compile::current();\n-  Dependencies* deps = C->dependencies();\n-  assert((deps != NULL) == (C->method() != NULL && C->method()->code_size() > 0), \"sanity\");\n-  TypePtr::InterfaceSet interfaces = _interfaces;\n-  if (k->is_loaded()) {\n-    ciInstanceKlass* ik = k->as_instance_klass();\n-    bool klass_is_exact = ik->is_final();\n-    if (!klass_is_exact &&\n-        deps != NULL) {\n-      ciInstanceKlass* sub = ik->unique_concrete_subklass();\n-      if (sub != NULL) {\n-        ciKlass *sub_k = sub;\n-        TypePtr::InterfaceSet sub_interfaces = TypePtr::interfaces(sub_k, true, false, false, ignore_interfaces);\n-        assert(sub_k == sub, \"\");\n-        if (sub_interfaces.eq(_interfaces)) {\n-          deps->assert_abstract_with_unique_concrete_subtype(ik, sub);\n-          k = ik = sub;\n-          klass_is_exact = sub->is_final();\n-          return TypeKlassPtr::make(klass_is_exact ? Constant : _ptr, k, _offset);\n-        }\n-      }\n-    }\n-  }\n-  return this;\n-}\n-\n-\n@@ -5919,2 +5710,2 @@\n-const TypeAryKlassPtr *TypeAryKlassPtr::make(PTR ptr, ciKlass* k, int offset, InterfaceHandling interface_handling) {\n-  if (k->is_obj_array_klass()) {\n+const TypeAryKlassPtr *TypeAryKlassPtr::make(PTR ptr, ciKlass* klass, int offset) {\n+  if (klass->is_obj_array_klass()) {\n@@ -5922,2 +5713,2 @@\n-    ciKlass* eklass = k->as_obj_array_klass()->element_klass();\n-    const TypeKlassPtr *etype = TypeKlassPtr::make(eklass, interface_handling)->cast_to_exactness(false);\n+    ciKlass* eklass = klass->as_obj_array_klass()->element_klass();\n+    const TypeKlassPtr *etype = TypeKlassPtr::make(eklass)->cast_to_exactness(false);\n@@ -5925,1 +5716,1 @@\n-  } else if (k->is_type_array_klass()) {\n+  } else if (klass->is_type_array_klass()) {\n@@ -5927,2 +5718,2 @@\n-    const Type* etype = get_const_basic_type(k->as_type_array_klass()->element_type());\n-    return TypeAryKlassPtr::make(ptr, etype, k, offset);\n+    const Type* etype = get_const_basic_type(klass->as_type_array_klass()->element_type());\n+    return TypeAryKlassPtr::make(ptr, etype, klass, offset);\n@@ -5935,2 +5726,2 @@\n-const TypeAryKlassPtr* TypeAryKlassPtr::make(ciKlass* klass, InterfaceHandling interface_handling) {\n-  return TypeAryKlassPtr::make(Constant, klass, 0, interface_handling);\n+const TypeAryKlassPtr* TypeAryKlassPtr::make(ciKlass* klass) {\n+  return TypeAryKlassPtr::make(Constant, klass, 0);\n@@ -5968,1 +5759,2 @@\n-    \/\/ Leave k_ary at NULL.\n+    \/\/ Compute array klass from element klass\n+    k_ary = ciObjArrayKlass::make(tinst->klass());\n@@ -5970,1 +5762,5 @@\n-    \/\/ Leave k_ary at NULL.\n+    \/\/ Compute array klass from element klass\n+    ciKlass* k_elem = tary->klass();\n+    \/\/ If element type is something like bottom[], k_elem will be null.\n+    if (k_elem != NULL)\n+      k_ary = ciObjArrayKlass::make(k_elem);\n@@ -6028,0 +5824,5 @@\n+    if (UseCompressedOops && k_ary != NULL && k_ary->is_obj_array_klass() &&\n+        _offset != 0 && _offset != arrayOopDesc::length_offset_in_bytes() &&\n+        _offset != arrayOopDesc::klass_offset_in_bytes()) {\n+      ((TypeAryPtr*)this)->_is_ptr_to_narrowoop = true;\n+    }\n@@ -6032,1 +5833,0 @@\n-\/\/ Is there a single ciKlass* that can represent that type?\n@@ -6058,1 +5858,1 @@\n-const TypePtr* TypeAryKlassPtr::add_offset(intptr_t offset) const {\n+const TypePtr *TypeAryKlassPtr::add_offset(intptr_t offset) const {\n@@ -6188,1 +5988,1 @@\n-    meet_aryptr(ptr, elem, this, tap, res_klass, res_xk);\n+    meet_aryptr(ptr, elem, this->klass(), tap->klass(), this->klass_is_exact(), tap->klass_is_exact(), this->ptr(), tap->ptr(), res_klass, res_xk);\n@@ -6196,3 +5996,0 @@\n-    InterfaceSet interfaces = meet_interfaces(tp);\n-    InterfaceSet tp_interfaces = tp->_interfaces;\n-    InterfaceSet this_interfaces = _interfaces;\n@@ -6206,1 +6003,1 @@\n-      if (tp->klass()->equals(ciEnv::current()->Object_klass()) && this_interfaces.intersection_with(tp_interfaces).eq(tp_interfaces) && !tp->klass_is_exact()) {\n+      if (tp->klass()->equals(ciEnv::current()->Object_klass()) && !tp->klass_is_exact()) {\n@@ -6211,2 +6008,1 @@\n-        interfaces = this_interfaces.intersection_with(tp->_interfaces);\n-        return TypeInstKlassPtr::make(ptr, ciEnv::current()->Object_klass(), interfaces, offset);\n+        return TypeInstKlassPtr::make(ptr, ciEnv::current()->Object_klass(), offset);\n@@ -6224,1 +6020,1 @@\n-        if (tp->klass()->equals(ciEnv::current()->Object_klass()) && this_interfaces.intersection_with(tp_interfaces).eq(tp_interfaces) && !tp->klass_is_exact()) {\n+        if (tp->klass()->equals(ciEnv::current()->Object_klass()) && !tp->klass_is_exact()) {\n@@ -6233,2 +6029,1 @@\n-      interfaces = this_interfaces.intersection_with(tp_interfaces);\n-      return TypeInstKlassPtr::make(ptr, ciEnv::current()->Object_klass(), interfaces, offset);\n+      return TypeInstKlassPtr::make(ptr, ciEnv::current()->Object_klass(), offset);\n@@ -6243,4 +6038,2 @@\n-template <class T1, class T2> bool TypePtr::is_java_subtype_of_helper_for_array(const T1* this_one, const T2* other, bool this_exact, bool other_exact) {\n-  static_assert(std::is_base_of<T2, T1>::value, \"\");\n-\n-  if (other->klass() == ciEnv::current()->Object_klass() && other->_interfaces.empty() && other_exact) {\n+bool TypeAryKlassPtr::is_java_subtype_of_helper(const TypeKlassPtr* other, bool this_exact, bool other_exact) const {\n+  if (other->klass() == ciEnv::current()->Object_klass() && other_exact) {\n@@ -6250,4 +6043,1 @@\n-  int dummy;\n-  bool this_top_or_bottom = (this_one->base_element_type(dummy) == Type::TOP || this_one->base_element_type(dummy) == Type::BOTTOM);\n-\n-  if (!this_one->is_loaded() || !other->is_loaded() || this_top_or_bottom) {\n+  if (!is_loaded() || !other->is_loaded() || other->klass() == NULL || klass() == NULL) {\n@@ -6256,3 +6046,2 @@\n-\n-  if (this_one->is_instance_type(other)) {\n-    return other->klass() == ciEnv::current()->Object_klass() && other->_interfaces.intersection_with(this_one->_interfaces).eq(other->_interfaces) && other_exact;\n+  if (other->isa_instklassptr()) {\n+    return _klass->is_subtype_of(other->_klass) && other_exact;\n@@ -6260,5 +6049,1 @@\n-\n-  assert(this_one->is_array_type(other), \"\");\n-  const T1* other_ary = this_one->is_array_type(other);\n-  bool other_top_or_bottom = (other_ary->base_element_type(dummy) == Type::TOP || other_ary->base_element_type(dummy) == Type::BOTTOM);\n-  if (other_top_or_bottom) {\n+  if (klass() == NULL) {\n@@ -6267,5 +6052,4 @@\n-\n-  const TypePtr* other_elem = other_ary->elem()->make_ptr();\n-  const TypePtr* this_elem = this_one->elem()->make_ptr();\n-  if (this_elem != NULL && other_elem != NULL) {\n-    return this_one->is_reference_type(this_elem)->is_java_subtype_of_helper(this_one->is_reference_type(other_elem), this_exact, other_exact);\n+  assert(other->isa_aryklassptr(), \"\");\n+  const TypeAryKlassPtr* other_ary = other->isa_aryklassptr();\n+  if (other_ary->_elem->isa_klassptr() && _elem->isa_klassptr()) {\n+    return _elem->is_klassptr()->is_java_subtype_of_helper(other_ary->_elem->is_klassptr(), this_exact, other_exact);\n@@ -6273,2 +6057,2 @@\n-  if (this_elem == NULL && other_elem == NULL) {\n-    return this_one->_klass->is_subtype_of(other->_klass);\n+  if (!other_ary->_elem->isa_klassptr() && !_elem->isa_klassptr()) {\n+    return _klass->is_subtype_of(other->_klass);\n@@ -6279,18 +6063,3 @@\n-bool TypeAryKlassPtr::is_java_subtype_of_helper(const TypeKlassPtr* other, bool this_exact, bool other_exact) const {\n-  return TypePtr::is_java_subtype_of_helper_for_array(this, other, this_exact, other_exact);\n-}\n-\n-template <class T1, class T2> bool TypePtr::is_same_java_type_as_helper_for_array(const T1* this_one, const T2* other) {\n-  static_assert(std::is_base_of<T2, T1>::value, \"\");\n-\n-  int dummy;\n-  bool this_top_or_bottom = (this_one->base_element_type(dummy) == Type::TOP || this_one->base_element_type(dummy) == Type::BOTTOM);\n-\n-  if (!this_one->is_array_type(other) ||\n-      !this_one->is_loaded() || !other->is_loaded() || this_top_or_bottom) {\n-    return false;\n-  }\n-  const T1* other_ary = this_one->is_array_type(other);\n-  bool other_top_or_bottom = (other_ary->base_element_type(dummy) == Type::TOP || other_ary->base_element_type(dummy) == Type::BOTTOM);\n-\n-  if (other_top_or_bottom) {\n+bool TypeAryKlassPtr::is_same_java_type_as(const TypeKlassPtr* other) const {\n+  if (!other->isa_aryklassptr() ||\n+      !is_loaded() || !other->is_loaded() || klass() == NULL || other->klass() == NULL) {\n@@ -6299,5 +6068,3 @@\n-\n-  const TypePtr* other_elem = other_ary->elem()->make_ptr();\n-  const TypePtr* this_elem = this_one->elem()->make_ptr();\n-  if (other_elem != NULL && this_elem != NULL) {\n-    return this_one->is_reference_type(this_elem)->is_same_java_type_as(this_one->is_reference_type(other_elem));\n+  const TypeAryKlassPtr* other_ary = other->isa_aryklassptr();\n+  if (other_ary->_elem->isa_klassptr() && _elem->isa_klassptr()) {\n+    return _elem->is_klassptr()->is_same_java_type_as(other_ary->_elem->is_klassptr());\n@@ -6305,3 +6072,2 @@\n-  if (other_elem == NULL && this_elem == NULL) {\n-    assert(this_one->_klass != NULL && other->_klass != NULL, \"\");\n-    return this_one->_klass->equals(other->_klass);\n+  if (!other_ary->_elem->isa_klassptr() && !_elem->isa_klassptr()) {\n+    return _klass->equals(other->_klass);\n@@ -6312,7 +6078,2 @@\n-bool TypeAryKlassPtr::is_same_java_type_as_helper(const TypeKlassPtr* other) const {\n-  return TypePtr::is_same_java_type_as_helper_for_array(this, other);\n-}\n-\n-template <class T1, class T2> bool TypePtr::maybe_java_subtype_of_helper_for_array(const T1* this_one, const T2* other, bool this_exact, bool other_exact) {\n-  static_assert(std::is_base_of<T2, T1>::value, \"\");\n-  if (other->klass() == ciEnv::current()->Object_klass() && other->_interfaces.empty() && other_exact) {\n+bool TypeAryKlassPtr::maybe_java_subtype_of_helper(const TypeKlassPtr* other, bool this_exact, bool other_exact) const {\n+  if (other->klass() == ciEnv::current()->Object_klass()) {\n@@ -6321,3 +6082,1 @@\n-  int dummy;\n-  bool this_top_or_bottom = (this_one->base_element_type(dummy) == Type::TOP || this_one->base_element_type(dummy) == Type::BOTTOM);\n-  if (!this_one->is_loaded() || !other->is_loaded() || this_top_or_bottom) {\n+  if (!is_loaded() || !other->is_loaded() || klass() == NULL || other->klass() == NULL) {\n@@ -6326,2 +6085,2 @@\n-  if (this_one->is_instance_type(other)) {\n-    return other->_klass->equals(ciEnv::current()->Object_klass()) && other->_interfaces.intersection_with(this_one->_interfaces).eq(other->_interfaces);\n+  if (other->isa_instklassptr()) {\n+    return (!other_exact && other->_klass->is_interface()) || _klass->is_subtype_of(other->_klass);\n@@ -6329,1 +6088,1 @@\n-  assert(this_one->is_array_type(other), \"\");\n+  assert(other->isa_aryklassptr(), \"\");\n@@ -6331,5 +6090,0 @@\n-  const T1* other_ary = this_one->is_array_type(other);\n-  bool other_top_or_bottom = (other_ary->base_element_type(dummy) == Type::TOP || other_ary->base_element_type(dummy) == Type::BOTTOM);\n-  if (other_top_or_bottom) {\n-    return true;\n-  }\n@@ -6337,1 +6091,1 @@\n-    return this_one->is_java_subtype_of(other);\n+    return is_java_subtype_of(other);\n@@ -6340,4 +6094,3 @@\n-  const TypePtr* this_elem = this_one->elem()->make_ptr();\n-  const TypePtr* other_elem = other_ary->elem()->make_ptr();\n-  if (other_elem != NULL && this_elem != NULL) {\n-    return this_one->is_reference_type(this_elem)->maybe_java_subtype_of_helper(this_one->is_reference_type(other_elem), this_exact, other_exact);\n+  const TypeAryKlassPtr* other_ary = other->isa_aryklassptr();\n+  if (other_ary->_elem->isa_klassptr() && _elem->isa_klassptr()) {\n+    return _elem->is_klassptr()->maybe_java_subtype_of_helper(other_ary->_elem->is_klassptr(), this_exact, other_exact);\n@@ -6345,2 +6098,2 @@\n-  if (other_elem == NULL && this_elem == NULL) {\n-    return this_one->_klass->is_subtype_of(other->_klass);\n+  if (!other_ary->_elem->isa_klassptr() && !_elem->isa_klassptr()) {\n+    return _klass->is_subtype_of(other->_klass);\n@@ -6351,4 +6104,0 @@\n-bool TypeAryKlassPtr::maybe_java_subtype_of_helper(const TypeKlassPtr* other, bool this_exact, bool other_exact) const {\n-  return TypePtr::maybe_java_subtype_of_helper_for_array(this, other, this_exact, other_exact);\n-}\n-\n@@ -6361,1 +6110,1 @@\n-\/\/ Is there a single ciKlass* that can represent that type?\n+\/\/------------------------------get_con----------------------------------------\n@@ -6381,1 +6130,5 @@\n-    \/\/ leave NULL\n+    k = elem()->is_klassptr()->klass();\n+    if (k != NULL) {\n+      k = ciObjArrayKlass::make(k);\n+      ((TypeAryKlassPtr*)this)->_klass = k;\n+    }\n@@ -6386,1 +6139,0 @@\n-    ((TypeAryKlassPtr*)this)->_klass = k;\n@@ -6402,1 +6154,0 @@\n-      _interfaces.dump(st);\n@@ -6451,1 +6202,1 @@\n-    domain = TypeTuple::make_domain(NULL, method->signature(), ignore_interfaces);\n+    domain = TypeTuple::make_domain(NULL, method->signature());\n@@ -6453,1 +6204,1 @@\n-    domain = TypeTuple::make_domain(method->holder(), method->signature(), ignore_interfaces);\n+    domain = TypeTuple::make_domain(method->holder(), method->signature());\n@@ -6455,1 +6206,1 @@\n-  const TypeTuple *range  = TypeTuple::make_range(method->signature(), ignore_interfaces);\n+  const TypeTuple *range  = TypeTuple::make_range(method->signature());\n","filename":"src\/hotspot\/share\/opto\/type.cpp","additions":544,"deletions":793,"binary":false,"changes":1337,"status":"modified"},{"patch":"@@ -171,0 +171,4 @@\n+#ifdef ASSERT\n+  \/\/ One type is interface, the other is oop\n+  virtual bool interface_vs_oop_helper(const Type *t) const;\n+#endif\n@@ -259,0 +263,1 @@\n+  \/\/ Currently, it also works around limitations involving interface types.\n@@ -268,0 +273,5 @@\n+#ifdef ASSERT\n+  \/\/ One type is interface, the other is oop\n+  virtual bool interface_vs_oop(const Type *t) const;\n+#endif\n+\n@@ -397,4 +407,0 @@\n-  enum InterfaceHandling {\n-      trust_interfaces,\n-      ignore_interfaces\n-  };\n@@ -402,1 +408,1 @@\n-  static const Type* get_const_type(ciType* type, InterfaceHandling interface_handling = ignore_interfaces);\n+  static const Type* get_const_type(ciType* type);\n@@ -721,2 +727,2 @@\n-  static const TypeTuple *make_range(ciSignature *sig, InterfaceHandling interface_handling = ignore_interfaces);\n-  static const TypeTuple *make_domain(ciInstanceKlass* recv, ciSignature *sig, InterfaceHandling interface_handling);\n+  static const TypeTuple *make_range(ciSignature *sig);\n+  static const TypeTuple *make_domain(ciInstanceKlass* recv, ciSignature *sig);\n@@ -773,0 +779,4 @@\n+#ifdef ASSERT\n+  \/\/ One type is interface, the other is oop\n+  virtual bool interface_vs_oop(const Type *t) const;\n+#endif\n@@ -878,46 +888,0 @@\n-  friend class Type;\n-protected:\n-  class InterfaceSet {\n-  private:\n-    GrowableArray<ciKlass*> _list;\n-    void raw_add(ciKlass* interface);\n-    void add(ciKlass* interface);\n-    void verify() const;\n-    int _hash_computed:1;\n-    int _exact_klass_computed:1;\n-    int _is_loaded_computed:1;\n-    int _hash;\n-    ciKlass* _exact_klass;\n-    bool _is_loaded;\n-    void compute_hash();\n-    void compute_exact_klass();\n-  public:\n-    InterfaceSet();\n-    InterfaceSet(GrowableArray<ciInstanceKlass*>* interfaces);\n-    bool eq(const InterfaceSet& other) const;\n-    int hash() const;\n-    void dump(outputStream *st) const;\n-    InterfaceSet union_with(const InterfaceSet& other) const;\n-    InterfaceSet intersection_with(const InterfaceSet& other) const;\n-    bool contains(const InterfaceSet& other) const {\n-      return intersection_with(other).eq(other);\n-    }\n-    bool empty() const { return _list.length() == 0; }\n-\n-    inline void* operator new(size_t x) throw() {\n-      Compile* compile = Compile::current();\n-      return compile->type_arena()->AmallocWords(x);\n-    }\n-    inline void operator delete( void* ptr ) {\n-      ShouldNotReachHere();\n-    }\n-    ciKlass* exact_klass() const;\n-    bool is_loaded() const;\n-\n-    static int compare(ciKlass* const &, ciKlass* const & k2);\n-\n-    void compute_is_loaded();\n-  };\n-\n-  static InterfaceSet interfaces(ciKlass*& k, bool klass, bool interface, bool array, InterfaceHandling interface_handling);\n-\n@@ -982,14 +946,6 @@\n-  template<class T> static TypePtr::MeetResult meet_instptr(PTR& ptr, InterfaceSet& interfaces, const T* this_type,\n-                                                            const T* other_type, ciKlass*& res_klass, bool& res_xk);\n-\n-  template<class T> static MeetResult meet_aryptr(PTR& ptr, const Type*& elem, const T* this_ary, const T* other_ary,\n-                                                  ciKlass*& res_klass, bool& res_xk);\n-\n-  template <class T1, class T2> static bool is_java_subtype_of_helper_for_instance(const T1* this_one, const T2* other, bool this_exact, bool other_exact);\n-  template <class T1, class T2> static bool is_same_java_type_as_helper_for_instance(const T1* this_one, const T2* other);\n-  template <class T1, class T2> static bool maybe_java_subtype_of_helper_for_instance(const T1* this_one, const T2* other, bool this_exact, bool other_exact);\n-  template <class T1, class T2> static bool is_java_subtype_of_helper_for_array(const T1* this_one, const T2* other, bool this_exact, bool other_exact);\n-  template <class T1, class T2> static bool is_same_java_type_as_helper_for_array(const T1* this_one, const T2* other);\n-  template <class T1, class T2> static bool maybe_java_subtype_of_helper_for_array(const T1* this_one, const T2* other, bool this_exact, bool other_exact);\n-  template <class T1, class T2> static bool is_meet_subtype_of_helper_for_instance(const T1* this_one, const T2* other, bool this_xk, bool other_xk);\n-  template <class T1, class T2> static bool is_meet_subtype_of_helper_for_array(const T1* this_one, const T2* other, bool this_xk, bool other_xk);\n+  static MeetResult\n+  meet_instptr(PTR &ptr, ciKlass* this_klass, ciKlass* tinst_klass, bool this_xk, bool tinst_xk, PTR this_ptr,\n+               PTR tinst_ptr, ciKlass*&res_klass, bool &res_xk);\n+  static MeetResult\n+  meet_aryptr(PTR& ptr, const Type*& elem, ciKlass* this_klass, ciKlass* tap_klass, bool this_xk, bool tap_xk, PTR this_ptr, PTR tap_ptr, ciKlass*& res_klass, bool& res_xk);\n+\n@@ -1104,1 +1060,1 @@\n- TypeOopPtr(TYPES t, PTR ptr, ciKlass* k, const InterfaceSet& interfaces, bool xk, ciObject* o, int offset, int instance_id,\n+  TypeOopPtr(TYPES t, PTR ptr, ciKlass* k, bool xk, ciObject* o, int offset, int instance_id,\n@@ -1120,3 +1076,0 @@\n-\n-  const InterfaceSet _interfaces;\n-\n@@ -1134,1 +1087,1 @@\n-  static const TypeOopPtr* make_from_klass_common(ciKlass* klass, bool klass_change, bool try_for_exact, InterfaceHandling interface_handling);\n+  static const TypeOopPtr* make_from_klass_common(ciKlass* klass, bool klass_change, bool try_for_exact);\n@@ -1139,2 +1092,0 @@\n-  InterfaceSet meet_interfaces(const TypeOopPtr* other) const;\n-\n@@ -1152,9 +1103,1 @@\n-\n-  bool is_same_java_type_as(const TypePtr* other) const {\n-    return is_same_java_type_as_helper(other->is_oopptr());\n-  }\n-\n-  virtual bool is_same_java_type_as_helper(const TypeOopPtr* other) const {\n-    ShouldNotReachHere(); return false;\n-  }\n-\n+  virtual bool is_same_java_type_as(const TypeOopPtr* other) const { ShouldNotReachHere(); return false; }\n@@ -1171,2 +1114,2 @@\n-  static const TypeOopPtr* make_from_klass(ciKlass* klass, InterfaceHandling interface_handling = ignore_interfaces) {\n-    return make_from_klass_common(klass, true, false, interface_handling);\n+  static const TypeOopPtr* make_from_klass(ciKlass* klass) {\n+    return make_from_klass_common(klass, true, false);\n@@ -1176,2 +1119,2 @@\n-  static const TypeOopPtr* make_from_klass_unique(ciKlass* klass, InterfaceHandling interface_handling= ignore_interfaces) {\n-    return make_from_klass_common(klass, true, true, interface_handling);\n+  static const TypeOopPtr* make_from_klass_unique(ciKlass* klass) {\n+    return make_from_klass_common(klass, true, true);\n@@ -1181,2 +1124,2 @@\n-  static const TypeOopPtr* make_from_klass_raw(ciKlass* klass, InterfaceHandling interface_handling = ignore_interfaces) {\n-    return make_from_klass_common(klass, false, false, interface_handling);\n+  static const TypeOopPtr* make_from_klass_raw(ciKlass* klass) {\n+    return make_from_klass_common(klass, false, false);\n@@ -1201,2 +1144,2 @@\n-  virtual bool  is_loaded() const { return klass()->is_loaded() && _interfaces.is_loaded(); }\n-  virtual bool klass_is_exact()    const { return _klass_is_exact; }\n+  virtual bool  is_loaded() const { return klass()->is_loaded(); }\n+  bool klass_is_exact()    const { return _klass_is_exact; }\n@@ -1244,24 +1187,0 @@\n-private:\n-  virtual bool is_meet_subtype_of(const TypePtr* other) const {\n-    return is_meet_subtype_of_helper(other->is_oopptr(), klass_is_exact(), other->is_oopptr()->klass_is_exact());\n-  }\n-\n-  virtual bool is_meet_subtype_of_helper(const TypeOopPtr* other, bool this_xk, bool other_xk) const {\n-    ShouldNotReachHere(); return false;\n-  }\n-\n-  virtual const InterfaceSet interfaces() const {\n-    return _interfaces;\n-  };\n-\n-  const TypeOopPtr* is_reference_type(const Type* other) const {\n-    return other->isa_oopptr();\n-  }\n-\n-  const TypeAryPtr* is_array_type(const TypeOopPtr* other) const {\n-    return other->isa_aryptr();\n-  }\n-\n-  const TypeInstPtr* is_instance_type(const TypeOopPtr* other) const {\n-    return other->isa_instptr();\n-  }\n@@ -1274,1 +1193,1 @@\n-  TypeInstPtr(PTR ptr, ciKlass* k, const InterfaceSet& interfaces, bool xk, ciObject* o, int offset, int instance_id,\n+  TypeInstPtr(PTR ptr, ciKlass* k, bool xk, ciObject* o, int offset, int instance_id,\n@@ -1285,1 +1204,3 @@\n-    assert(!(klass()->is_loaded() && klass()->is_interface()), \"\");\n+    if (klass()->is_loaded() && klass()->is_interface()) {\n+      return Compile::current()->env()->Object_klass();\n+    }\n@@ -1289,1 +1210,1 @@\n-  bool is_same_java_type_as_helper(const TypeOopPtr* other) const;\n+  bool is_same_java_type_as(const TypeOopPtr* other) const;\n@@ -1295,3 +1216,1 @@\n-    ciKlass* k = o->klass();\n-    const TypePtr::InterfaceSet interfaces = TypePtr::interfaces(k, true, false, false, ignore_interfaces);\n-    return make(TypePtr::Constant, k, interfaces, true, o, 0, InstanceBot);\n+    return make(TypePtr::Constant, o->klass(), true, o, 0, InstanceBot);\n@@ -1301,3 +1220,1 @@\n-    ciKlass* k = o->klass();\n-    const TypePtr::InterfaceSet interfaces = TypePtr::interfaces(k, true, false, false, ignore_interfaces);\n-    return make(TypePtr::Constant, k, interfaces, true, o, offset, InstanceBot);\n+    return make(TypePtr::Constant, o->klass(), true, o, offset, InstanceBot);\n@@ -1307,3 +1224,2 @@\n-  static const TypeInstPtr *make(PTR ptr, ciKlass* klass, InterfaceHandling interface_handling = ignore_interfaces) {\n-    const TypePtr::InterfaceSet interfaces = TypePtr::interfaces(klass, true, true, false, interface_handling);\n-    return make(ptr, klass, interfaces, false, NULL, 0, InstanceBot);\n+  static const TypeInstPtr *make(PTR ptr, ciKlass* klass) {\n+    return make(ptr, klass, false, NULL, 0, InstanceBot);\n@@ -1314,2 +1230,1 @@\n-    const TypePtr::InterfaceSet interfaces = TypePtr::interfaces(klass, true, false, false, ignore_interfaces);\n-    return make(ptr, klass, interfaces, true, NULL, 0, InstanceBot);\n+    return make(ptr, klass, true, NULL, 0, InstanceBot);\n@@ -1320,2 +1235,1 @@\n-    const TypePtr::InterfaceSet interfaces = TypePtr::interfaces(klass, true, false, false, ignore_interfaces);\n-    return make(ptr, klass, interfaces, false, NULL, offset, InstanceBot);\n+    return make(ptr, klass, false, NULL, offset, InstanceBot);\n@@ -1324,1 +1238,2 @@\n-  static const TypeInstPtr *make(PTR ptr, ciKlass* k, const InterfaceSet& interfaces, bool xk, ciObject* o, int offset,\n+  \/\/ Make a pointer to an oop.\n+  static const TypeInstPtr *make(PTR ptr, ciKlass* k, bool xk, ciObject* o, int offset,\n@@ -1329,5 +1244,0 @@\n-  static const TypeInstPtr *make(PTR ptr, ciKlass* k, bool xk, ciObject* o, int offset, int instance_id = InstanceBot) {\n-    const TypePtr::InterfaceSet interfaces = TypePtr::interfaces(k, true, false, false, ignore_interfaces);\n-    return make(ptr, k, interfaces, xk, o, offset, instance_id);\n-  }\n-\n@@ -1358,1 +1268,1 @@\n-  virtual const TypeInstPtr *xmeet_unloaded(const TypeInstPtr *t, const InterfaceSet& interfaces) const;\n+  virtual const TypeInstPtr *xmeet_unloaded( const TypeInstPtr *t ) const;\n@@ -1363,0 +1273,2 @@\n+  bool is_interface() const { return is_loaded() && klass()->is_interface(); }\n+\n@@ -1372,8 +1284,0 @@\n-\n-private:\n-  virtual bool is_meet_subtype_of_helper(const TypeOopPtr* other, bool this_xk, bool other_xk) const;\n-\n-  virtual bool is_meet_same_type_as(const TypePtr* other) const {\n-    return _klass->equals(other->is_instptr()->_klass) && _interfaces.eq(other->is_instptr()->_interfaces);\n-  }\n-\n@@ -1385,3 +1289,0 @@\n-  friend class Type;\n-  friend class TypePtr;\n-\n@@ -1391,1 +1292,1 @@\n-    : TypeOopPtr(AryPtr,ptr,k,*_array_interfaces,xk,o,offset, instance_id, speculative, inline_depth),\n+    : TypeOopPtr(AryPtr,ptr,k,xk,o,offset, instance_id, speculative, inline_depth),\n@@ -1395,7 +1296,14 @@\n-    int dummy;\n-    bool top_or_bottom = (base_element_type(dummy) == Type::TOP || base_element_type(dummy) == Type::BOTTOM);\n-\n-    if (UseCompressedOops && (elem()->make_oopptr() != NULL && !top_or_bottom) &&\n-        _offset != 0 && _offset != arrayOopDesc::length_offset_in_bytes() &&\n-        _offset != arrayOopDesc::klass_offset_in_bytes()) {\n-      _is_ptr_to_narrowoop = true;\n+#ifdef ASSERT\n+    if (k != NULL) {\n+      \/\/ Verify that specified klass and TypeAryPtr::klass() follow the same rules.\n+      ciKlass* ck = compute_klass(true);\n+      if (k != ck) {\n+        this->dump(); tty->cr();\n+        tty->print(\" k: \");\n+        k->print(); tty->cr();\n+        tty->print(\"ck: \");\n+        if (ck != NULL) ck->print();\n+        else tty->print(\"<NULL>\");\n+        tty->cr();\n+        assert(false, \"unexpected TypeAryPtr::_klass\");\n+      }\n@@ -1403,1 +1311,1 @@\n-\n+#endif\n@@ -1412,3 +1320,0 @@\n-  \/\/ A pointer to delay allocation to Type::Initialize_shared()\n-\n-  static const InterfaceSet* _array_interfaces;\n@@ -1416,1 +1321,0 @@\n-  \/\/ Only guaranteed non null for array of basic types\n@@ -1421,1 +1325,1 @@\n-  bool is_same_java_type_as_helper(const TypeOopPtr* other) const;\n+  bool is_same_java_type_as(const TypeOopPtr* other) const;\n@@ -1498,0 +1402,4 @@\n+#ifdef ASSERT\n+  \/\/ One type is interface, the other is oop\n+  virtual bool interface_vs_oop(const Type *t) const;\n+#endif\n@@ -1501,2 +1409,0 @@\n-private:\n-  virtual bool is_meet_subtype_of_helper(const TypeOopPtr* other, bool this_xk, bool other_xk) const;\n@@ -1550,1 +1456,0 @@\n-  friend class TypePtr;\n@@ -1552,1 +1457,1 @@\n-  TypeKlassPtr(TYPES t, PTR ptr, ciKlass* klass, const InterfaceSet& interfaces, int offset);\n+  TypeKlassPtr(TYPES t, PTR ptr, ciKlass* klass, int offset);\n@@ -1564,2 +1469,1 @@\n-  const InterfaceSet _interfaces;\n-  InterfaceSet meet_interfaces(const TypeKlassPtr* other) const;\n+\n@@ -1575,4 +1479,0 @@\n-  bool is_same_java_type_as(const TypePtr* other) const {\n-    return is_same_java_type_as_helper(other->is_klassptr());\n-  }\n-\n@@ -1582,1 +1482,1 @@\n-  virtual bool is_same_java_type_as_helper(const TypeKlassPtr* other) const { ShouldNotReachHere(); return false; }\n+  virtual bool is_same_java_type_as(const TypeKlassPtr* other) const { ShouldNotReachHere(); return false; }\n@@ -1588,1 +1488,0 @@\n-  virtual bool klass_is_exact()    const { return _ptr == Constant; }\n@@ -1590,2 +1489,4 @@\n-  static const TypeKlassPtr* make(ciKlass* klass, InterfaceHandling interface_handling = ignore_interfaces);\n-  static const TypeKlassPtr *make(PTR ptr, ciKlass* klass, int offset, InterfaceHandling interface_handling = ignore_interfaces);\n+  bool klass_is_exact()    const { return _ptr == Constant; }\n+\n+  static const TypeKlassPtr* make(ciKlass* klass);\n+  static const TypeKlassPtr *make(PTR ptr, ciKlass* klass, int offset);\n@@ -1610,2 +1511,0 @@\n-  virtual const TypeKlassPtr* try_improve() const { return this; }\n-\n@@ -1615,24 +1514,0 @@\n-private:\n-  virtual bool is_meet_subtype_of(const TypePtr* other) const {\n-    return is_meet_subtype_of_helper(other->is_klassptr(), klass_is_exact(), other->is_klassptr()->klass_is_exact());\n-  }\n-\n-  virtual bool is_meet_subtype_of_helper(const TypeKlassPtr* other, bool this_xk, bool other_xk) const {\n-    ShouldNotReachHere(); return false;\n-  }\n-\n-  virtual const InterfaceSet interfaces() const {\n-    return _interfaces;\n-  };\n-\n-  const TypeKlassPtr* is_reference_type(const Type* other) const {\n-    return other->isa_klassptr();\n-  }\n-\n-  const TypeAryKlassPtr* is_array_type(const TypeKlassPtr* other) const {\n-    return other->isa_aryklassptr();\n-  }\n-\n-  const TypeInstKlassPtr* is_instance_type(const TypeKlassPtr* other) const {\n-    return other->isa_instklassptr();\n-  }\n@@ -1644,3 +1519,2 @@\n-  TypeInstKlassPtr(PTR ptr, ciKlass* klass, const InterfaceSet& interfaces, int offset)\n-    : TypeKlassPtr(InstKlassPtr, ptr, klass, interfaces, offset) {\n-    assert(klass->is_instance_klass() && (!klass->is_loaded() || !klass->is_interface()), \"\");\n+  TypeInstKlassPtr(PTR ptr, ciKlass* klass, int offset)\n+    : TypeKlassPtr(InstKlassPtr, ptr, klass, offset) {\n@@ -1654,1 +1528,3 @@\n-    assert(!klass()->is_interface(), \"\");\n+    if (klass()->is_interface()) {\n+      return Compile::current()->env()->Object_klass();\n+    }\n@@ -1658,1 +1534,1 @@\n-  bool is_same_java_type_as_helper(const TypeKlassPtr* other) const;\n+  bool is_same_java_type_as(const TypeKlassPtr* other) const;\n@@ -1662,9 +1538,2 @@\n-  static const TypeInstKlassPtr *make(ciKlass* k, InterfaceHandling interface_handling) {\n-    InterfaceSet interfaces = TypePtr::interfaces(k, true, true, false, interface_handling);\n-    return make(TypePtr::Constant, k, interfaces, 0);\n-  }\n-  static const TypeInstKlassPtr* make(PTR ptr, ciKlass* k, const InterfaceSet& interfaces, int offset);\n-\n-  static const TypeInstKlassPtr* make(PTR ptr, ciKlass* k, int offset) {\n-    const TypePtr::InterfaceSet interfaces = TypePtr::interfaces(k, true, false, false, ignore_interfaces);\n-    return make(ptr, k, interfaces, offset);\n+  static const TypeInstKlassPtr *make(ciKlass* k) {\n+    return make(TypePtr::Constant, k, 0);\n@@ -1672,0 +1541,1 @@\n+  static const TypeInstKlassPtr *make(PTR ptr, ciKlass* k, int offset);\n@@ -1687,1 +1557,1 @@\n-  virtual const TypeKlassPtr* try_improve() const;\n+  bool is_interface() const { return klass()->is_interface(); }\n@@ -1692,2 +1562,0 @@\n-private:\n-  virtual bool is_meet_subtype_of_helper(const TypeKlassPtr* other, bool this_xk, bool other_xk) const;\n@@ -1699,3 +1567,0 @@\n-  friend class Type;\n-  friend class TypePtr;\n-\n@@ -1704,1 +1569,0 @@\n-  static const InterfaceSet* _array_interfaces;\n@@ -1706,2 +1570,1 @@\n-    : TypeKlassPtr(AryKlassPtr, ptr, klass, *_array_interfaces, offset), _elem(elem) {\n-    assert(klass == NULL || klass->is_type_array_klass() || !klass->as_obj_array_klass()->base_element_klass()->is_interface(), \"\");\n+    : TypeKlassPtr(AryKlassPtr, ptr, klass, offset), _elem(elem) {\n@@ -1711,1 +1574,0 @@\n-  \/\/ Only guaranteed non null for array of basic types\n@@ -1721,1 +1583,1 @@\n-  static const TypeAryKlassPtr *make(PTR ptr, ciKlass* k, int offset, InterfaceHandling interface_handling);\n+  static const TypeAryKlassPtr *make(PTR ptr, ciKlass* k, int offset);\n@@ -1723,1 +1585,1 @@\n-  bool is_same_java_type_as_helper(const TypeKlassPtr* other) const;\n+  bool is_same_java_type_as(const TypeKlassPtr* other) const;\n@@ -1730,1 +1592,1 @@\n-  static const TypeAryKlassPtr* make(ciKlass* klass, InterfaceHandling interface_handling);\n+  static const TypeAryKlassPtr* make(ciKlass* klass);\n@@ -1757,2 +1619,0 @@\n-private:\n-  virtual bool is_meet_subtype_of_helper(const TypeKlassPtr* other, bool this_xk, bool other_xk) const;\n","filename":"src\/hotspot\/share\/opto\/type.hpp","additions":92,"deletions":232,"binary":false,"changes":324,"status":"modified"},{"patch":"@@ -28,0 +28,2 @@\n+#include \"jni.h\"\n+#include \"jvm.h\"\n@@ -49,2 +51,0 @@\n-#include \"jni.h\"\n-#include \"jvm.h\"\n","filename":"src\/hotspot\/share\/prims\/jni.cpp","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -26,0 +26,2 @@\n+#include \"jni.h\"\n+#include \"jvm.h\"\n@@ -29,2 +31,0 @@\n-#include \"jni.h\"\n-#include \"jvm.h\"\n","filename":"src\/hotspot\/share\/prims\/jniCheck.cpp","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -26,0 +26,1 @@\n+#include \"jvm.h\"\n@@ -50,1 +51,0 @@\n-#include \"jvm.h\"\n","filename":"src\/hotspot\/share\/prims\/jvm.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -76,2 +76,0 @@\n-          .toc { }\n-          span.bold { font-weight: bold; }\n@@ -94,1 +92,1 @@\n-      <ul class=\"toc\">\n+      <ul>\n@@ -96,1 +94,1 @@\n-          <a href=\"#SpecificationIntro\">Introduction<\/a>\n+          <a href=\"#SpecificationIntro\"><b>Introduction<\/b><\/a>\n@@ -103,1 +101,1 @@\n-                  <xsl:value-of select=\"@label\"\/>\n+                  <b><xsl:value-of select=\"@label\"\/><\/b>\n@@ -110,1 +108,1 @@\n-          <a href=\"#FunctionSection\">Functions<\/a>\n+          <a href=\"#FunctionSection\"><b>Functions<\/b><\/a>\n@@ -117,1 +115,1 @@\n-                  <xsl:value-of select=\"@label\"\/>\n+                  <b><xsl:value-of select=\"@label\"\/><\/b>\n@@ -122,1 +120,1 @@\n-              <a href=\"#FunctionIndex\">Function Index<\/a>\n+              <a href=\"#FunctionIndex\"><b>Function Index<\/b><\/a>\n@@ -129,1 +127,1 @@\n-                      <xsl:value-of select=\"@label\"\/>\n+                      <b><xsl:value-of select=\"@label\"\/><\/b>\n@@ -136,1 +134,1 @@\n-              <a href=\"#ErrorSection\">Error Codes<\/a>\n+              <a href=\"#ErrorSection\"><b>Error Codes<\/b><\/a>\n@@ -141,1 +139,1 @@\n-          <a href=\"#EventSection\">Events<\/a>\n+          <a href=\"#EventSection\"><b>Events<\/b><\/a>\n@@ -144,1 +142,1 @@\n-              <a href=\"#EventIndex\">Event Index<\/a>\n+              <a href=\"#EventIndex\"><b>Event Index<\/b><\/a>\n@@ -149,1 +147,1 @@\n-          <a href=\"#DataSection\">Data Types<\/a>\n+          <a href=\"#DataSection\"><b>Data Types<\/b><\/a>\n@@ -155,1 +153,3 @@\n-                <xsl:value-of select=\"@label\"\/>\n+                <b>\n+                  <xsl:value-of select=\"@label\"\/>\n+                <\/b>\n@@ -160,1 +160,1 @@\n-              <a href=\"#StructureTypeDefinitions\">Structure Type Definitions<\/a>\n+              <a href=\"#StructureTypeDefinitions\"><b>Structure Type Definitions<\/b><\/a>\n@@ -163,1 +163,1 @@\n-              <a href=\"#FunctionTypeDefinitions\">Function Type Definitions<\/a>\n+              <a href=\"#FunctionTypeDefinitions\"><b>Function Type Definitions<\/b><\/a>\n@@ -166,1 +166,1 @@\n-              <a href=\"#EnumerationDefinitions\">Enumeration Definitions<\/a>\n+              <a href=\"#EnumerationDefinitions\"><b>Enumeration Definitions<\/b><\/a>\n@@ -169,1 +169,1 @@\n-              <a href=\"#FunctionTable\">Function Table<\/a>\n+              <a href=\"#FunctionTable\"><b>Function Table<\/b><\/a>\n@@ -174,1 +174,1 @@\n-          <a href=\"#ConstantIndex\">Constant Index<\/a>\n+          <a href=\"#ConstantIndex\"><b>Constant Index<\/b><\/a>\n@@ -178,1 +178,1 @@\n-            <a href=\"#SpecificationIssues\">Issues<\/a>\n+            <a href=\"#SpecificationIssues\"><b>Issues<\/b><\/a>\n@@ -185,1 +185,1 @@\n-                    <xsl:value-of select=\"@label\"\/>\n+                    <b><xsl:value-of select=\"@label\"\/><\/b>\n@@ -193,1 +193,1 @@\n-          <a href=\"#ChangeHistory\">Change History<\/a>\n+          <a href=\"#ChangeHistory\"><b>Change History<\/b><\/a>\n@@ -268,1 +268,3 @@\n-      <xsl:value-of select=\"@label\"\/>\n+      <b>\n+        <xsl:value-of select=\"@label\"\/>\n+      <\/b>\n@@ -598,1 +600,3 @@\n-      <xsl:value-of select=\"@label\"\/>\n+      <b>\n+        <xsl:value-of select=\"@label\"\/>\n+      <\/b>\n@@ -980,1 +984,3 @@\n-          <xsl:value-of select=\"@id\"\/>\n+          <b>\n+            <xsl:value-of select=\"@id\"\/>\n+          <\/b>\n@@ -994,1 +1000,3 @@\n-          <xsl:value-of select=\"@id\"\/>\n+          <b>\n+            <xsl:value-of select=\"@id\"\/>\n+          <\/b>\n@@ -1089,1 +1097,1 @@\n-              <div class=\"captionDescr\"><span class=\"bold\">Required Functionality<\/span><\/div>\n+              <div class=\"captionDescr\"><b>Required Functionality<\/b><\/div>\n@@ -1093,1 +1101,1 @@\n-                <span class=\"bold\">Optional Functionality:<\/span> might not be implemented for all virtual machines.\n+                <b>Optional Functionality:<\/b> might not be implemented for all virtual machines.\n@@ -1143,1 +1151,1 @@\n-        <div class=\"captionDescr\"><span class=\"bold\">Required Functionality<\/span><\/div>\n+        <div class=\"captionDescr\"><b>Required Functionality<\/b><\/div>\n@@ -1154,1 +1162,1 @@\n-      <div class=\"captionDescr\"><span class=\"bold\">Required Functionality<\/span><\/div>\n+      <div class=\"captionDescr\"><b>Required Functionality<\/b><\/div>\n@@ -1807,2 +1815,2 @@\n-          <span class=\"bold\">Version<\/span><br\/>\n-          <span class=\"bold\">Date<\/span>\n+          <b>Version<\/b><br\/>\n+          <b>Date<\/b>\n@@ -1811,1 +1819,1 @@\n-          <span class=\"bold\">Changes<\/span>\n+          <b>Changes<\/b>\n@@ -1822,1 +1830,1 @@\n-        <span class=\"bold\">\n+        <b>\n@@ -1824,1 +1832,1 @@\n-        <\/span>\n+        <\/b>\n@@ -1886,0 +1894,6 @@\n+<xsl:template match=\"b\">\n+  <b>\n+  <xsl:apply-templates\/>\n+  <\/b>\n+<\/xsl:template>\n+\n@@ -2001,1 +2015,1 @@\n-  <span class=\"bold\">\n+  <b>\n@@ -2003,1 +2017,1 @@\n-  <\/span>\n+  <\/b>\n","filename":"src\/hotspot\/share\/prims\/jvmti.xsl","additions":51,"deletions":37,"binary":false,"changes":88,"status":"modified"},{"patch":"@@ -718,1 +718,3 @@\n-    Handle loader(THREAD, SystemDictionary::java_system_loader());\n+    \/\/ lock the loader\n+    Handle loader = Handle(THREAD, SystemDictionary::java_system_loader());\n+    ObjectLocker ol(loader, THREAD);\n@@ -1671,1 +1673,1 @@\n-  objArrayHandle group_objs;\n+  Handle *group_objs  = NULL;\n","filename":"src\/hotspot\/share\/prims\/jvmtiEnv.cpp","additions":4,"deletions":2,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -29,1 +29,0 @@\n-#include \"classfile\/symbolTable.hpp\"\n@@ -50,1 +49,0 @@\n-#include \"runtime\/javaCalls.hpp\"\n@@ -539,2 +537,2 @@\n-jthread *\n-JvmtiEnvBase::new_jthreadArray(int length, Handle *handles) {\n+jobject *\n+JvmtiEnvBase::new_jobjectArray(int length, Handle *handles) {\n@@ -545,1 +543,1 @@\n-  jthread* objArray = (jthread *) jvmtiMalloc(sizeof(jthread) * length);\n+  jobject *objArray = (jobject *) jvmtiMalloc(sizeof(jobject) * length);\n@@ -548,2 +546,2 @@\n-  for (int i = 0; i < length; i++) {\n-    objArray[i] = (jthread)jni_reference(handles[i]);\n+  for (int i=0; i<length; i++) {\n+    objArray[i] = jni_reference(handles[i]);\n@@ -554,8 +552,4 @@\n-jthreadGroup *\n-JvmtiEnvBase::new_jthreadGroupArray(int length, objArrayHandle groups) {\n-  if (length == 0) {\n-    return NULL;\n-  }\n-\n-  jthreadGroup* objArray = (jthreadGroup *) jvmtiMalloc(sizeof(jthreadGroup) * length);\n-  NULL_CHECK(objArray, NULL);\n+jthread *\n+JvmtiEnvBase::new_jthreadArray(int length, Handle *handles) {\n+  return (jthread *) new_jobjectArray(length,handles);\n+}\n@@ -563,4 +557,3 @@\n-  for (int i = 0; i < length; i++) {\n-    objArray[i] = (jthreadGroup)JNIHandles::make_local(groups->obj_at(i));\n-  }\n-  return objArray;\n+jthreadGroup *\n+JvmtiEnvBase::new_jthreadGroupArray(int length, Handle *handles) {\n+  return (jthreadGroup *) new_jobjectArray(length,handles);\n@@ -802,20 +795,2 @@\n-JvmtiEnvBase::get_subgroups(JavaThread* current_thread, Handle group_hdl, jint *count_ptr, objArrayHandle *group_objs_p) {\n-\n-  \/\/ This call collects the strong and weak groups\n-  JavaThread* THREAD = current_thread;\n-  JavaValue result(T_OBJECT);\n-  JavaCalls::call_virtual(&result,\n-                          group_hdl,\n-                          vmClasses::ThreadGroup_klass(),\n-                          SymbolTable::new_permanent_symbol(\"subgroupsAsArray\"),\n-                          vmSymbols::void_threadgroup_array_signature(),\n-                          THREAD);\n-  if (HAS_PENDING_EXCEPTION) {\n-    Symbol* ex_name = PENDING_EXCEPTION->klass()->name();\n-    CLEAR_PENDING_EXCEPTION;\n-    if (ex_name == vmSymbols::java_lang_OutOfMemoryError()) {\n-      return JVMTI_ERROR_OUT_OF_MEMORY;\n-    } else {\n-      return JVMTI_ERROR_INTERNAL;\n-    }\n-  }\n+JvmtiEnvBase::get_subgroups(JavaThread* current_thread, Handle group_hdl, jint *count_ptr, Handle **group_objs_p) {\n+  ObjectLocker ol(group_hdl, current_thread);\n@@ -823,2 +798,2 @@\n-  assert(result.get_type() == T_OBJECT, \"just checking\");\n-  objArrayOop groups = (objArrayOop)result.get_oop();\n+  int ngroups = java_lang_ThreadGroup::ngroups(group_hdl());\n+  int nweaks = java_lang_ThreadGroup::nweaks(group_hdl());\n@@ -826,2 +801,15 @@\n-  *count_ptr = groups == nullptr ? 0 : groups->length();\n-  *group_objs_p = objArrayHandle(current_thread, groups);\n+  jint count = 0;\n+  Handle *group_objs = NULL;\n+  if (ngroups > 0 || nweaks > 0) {\n+    group_objs = NEW_RESOURCE_ARRAY_RETURN_NULL(Handle, ngroups + nweaks);\n+    NULL_CHECK(group_objs, JVMTI_ERROR_OUT_OF_MEMORY);\n+\n+    if (ngroups > 0) {\n+      \/\/ Strongly reachable subgroups:\n+      objArrayOop groups = java_lang_ThreadGroup::groups(group_hdl());\n+      for (int j = 0; j < ngroups; j++) {\n+        oop group_obj = groups->obj_at(j);\n+        assert(group_obj != NULL, \"group_obj != NULL\");\n+        group_objs[count++] = Handle(current_thread, group_obj);\n+      }\n+    }\n@@ -829,0 +817,15 @@\n+    if (nweaks > 0) {\n+      \/\/ Weakly reachable subgroups:\n+      objArrayOop weaks = java_lang_ThreadGroup::weaks(group_hdl());\n+      for (int j = 0; j < nweaks; j++) {\n+        oop weak_obj = weaks->obj_at(j);\n+        assert(weak_obj != NULL, \"weak_obj != NULL\");\n+        oop group_obj = java_lang_ref_Reference::weak_referent(weak_obj);\n+        if (group_obj != NULL) {\n+          group_objs[count++] = Handle(current_thread, group_obj);\n+        }\n+      }\n+    }\n+  }\n+  *group_objs_p = group_objs;\n+  *count_ptr = count;\n","filename":"src\/hotspot\/share\/prims\/jvmtiEnvBase.cpp","additions":46,"deletions":43,"binary":false,"changes":89,"status":"modified"},{"patch":"@@ -335,0 +335,1 @@\n+  jobject * new_jobjectArray(int length, Handle *handles);\n@@ -336,1 +337,1 @@\n-  jthreadGroup * new_jthreadGroupArray(int length, objArrayHandle groups);\n+  jthreadGroup * new_jthreadGroupArray(int length, Handle *handles);\n@@ -380,1 +381,1 @@\n-  static jvmtiError get_subgroups(JavaThread* current_thread, Handle group_hdl, jint *count_ptr, objArrayHandle *group_objs_p);\n+  static jvmtiError get_subgroups(JavaThread* current_thread, Handle group_hdl, jint *count_ptr, Handle **group_objs_p);\n","filename":"src\/hotspot\/share\/prims\/jvmtiEnvBase.hpp","additions":3,"deletions":2,"binary":false,"changes":5,"status":"modified"},{"patch":"@@ -201,2 +201,6 @@\n-    assert(thread->vthread() != NULL || thread->threadObj() == NULL, \"sanity check\");\n-    _jthread = to_jobject(thread->vthread());\n+    JvmtiThreadState* state = thread->jvmti_thread_state();\n+    if (state != NULL && state->is_virtual()) {\n+      _jthread = to_jobject(thread->vthread());\n+    } else {\n+      _jthread = to_jobject(thread->threadObj());\n+    }\n@@ -382,4 +386,0 @@\n-    if (JvmtiEnv::get_phase() == JVMTI_PHASE_LIVE) {\n-      ThreadInVMfromNative __tiv(JavaThread::current());\n-      java_lang_VirtualThread::init_static_notify_jvmti_events();\n-    }\n","filename":"src\/hotspot\/share\/prims\/jvmtiExport.cpp","additions":6,"deletions":6,"binary":false,"changes":12,"status":"modified"},{"patch":"@@ -100,1 +100,0 @@\n-  jc.can_support_virtual_threads = 1;\n@@ -111,0 +110,8 @@\n+  \/\/ Workaround for 8195635:\n+  \/\/ disable pop_frame and force_early_return capabilities with Graal\n+#if INCLUDE_JVMCI\n+  if (UseJVMCICompiler) {\n+    jc.can_pop_frame = 0;\n+    jc.can_force_early_return = 0;\n+  }\n+#endif \/\/ INCLUDE_JVMCI\n@@ -125,0 +132,1 @@\n+  jc.can_support_virtual_threads = 1;\n","filename":"src\/hotspot\/share\/prims\/jvmtiManageCapabilities.cpp","additions":9,"deletions":1,"binary":false,"changes":10,"status":"modified"},{"patch":"@@ -26,0 +26,1 @@\n+#include \"jvm_io.h\"\n@@ -37,1 +38,0 @@\n-#include \"jvm_io.h\"\n","filename":"src\/hotspot\/share\/prims\/methodHandles.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -26,1 +26,0 @@\n-#include \"classfile\/vmSymbols.hpp\"\n@@ -29,0 +28,1 @@\n+#include \"classfile\/vmSymbols.hpp\"\n","filename":"src\/hotspot\/share\/prims\/perf.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -26,1 +26,0 @@\n-#include \"classfile\/vmSymbols.hpp\"\n@@ -29,0 +28,1 @@\n+#include \"classfile\/vmSymbols.hpp\"\n@@ -31,3 +31,0 @@\n-#include \"prims\/stackwalk.hpp\"\n-#include \"runtime\/deoptimization.hpp\"\n-#include \"runtime\/interfaceSupport.inline.hpp\"\n@@ -35,0 +32,1 @@\n+#include \"runtime\/interfaceSupport.inline.hpp\"\n@@ -37,0 +35,3 @@\n+#include \"runtime\/deoptimization.hpp\"\n+#include \"prims\/stackwalk.hpp\"\n+\n","filename":"src\/hotspot\/share\/prims\/scopedMemoryAccess.cpp","additions":5,"deletions":4,"binary":false,"changes":9,"status":"modified"},{"patch":"@@ -26,0 +26,2 @@\n+#include \"jni.h\"\n+#include \"jvm.h\"\n@@ -33,2 +35,0 @@\n-#include \"jni.h\"\n-#include \"jvm.h\"\n","filename":"src\/hotspot\/share\/prims\/unsafe.cpp","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -26,0 +26,2 @@\n+#include \"jni.h\"\n+#include \"jvm.h\"\n@@ -30,2 +32,0 @@\n-#include \"jni.h\"\n-#include \"jvm.h\"\n@@ -41,0 +41,1 @@\n+\n@@ -42,1 +43,1 @@\n-#include \"opto\/matcher.hpp\"\n+#include \"opto\/matcher.hpp\" \/\/ Matcher::max_vector_size(BasicType)\n","filename":"src\/hotspot\/share\/prims\/vectorSupport.cpp","additions":4,"deletions":3,"binary":false,"changes":7,"status":"modified"},{"patch":"@@ -28,1 +28,0 @@\n-#include \"code\/debugInfo.hpp\"\n@@ -30,0 +29,1 @@\n+#include \"code\/debugInfo.hpp\"\n","filename":"src\/hotspot\/share\/prims\/vectorSupport.hpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -26,0 +26,1 @@\n+#include \"jni.h\"\n@@ -29,1 +30,0 @@\n-#include \"jni.h\"\n","filename":"src\/hotspot\/share\/prims\/wbtestmethods\/parserTests.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -26,0 +26,1 @@\n+#include <new>\n@@ -114,0 +115,1 @@\n+\n","filename":"src\/hotspot\/share\/prims\/whitebox.cpp","additions":2,"deletions":0,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -29,0 +29,2 @@\n+\n+#include \"utilities\/exceptions.hpp\"\n@@ -32,1 +34,0 @@\n-#include \"utilities\/exceptions.hpp\"\n","filename":"src\/hotspot\/share\/prims\/whitebox.hpp","additions":2,"deletions":1,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -26,1 +26,0 @@\n-#include \"compiler\/compilerDefinitions.hpp\"\n@@ -28,0 +27,1 @@\n+#include \"compiler\/compilerDefinitions.hpp\"\n","filename":"src\/hotspot\/share\/runtime\/abstract_vm_version.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -26,0 +26,1 @@\n+#include \"jvm.h\"\n@@ -38,1 +39,0 @@\n-#include \"jvm.h\"\n@@ -70,1 +70,0 @@\n-\n","filename":"src\/hotspot\/share\/runtime\/arguments.cpp","additions":1,"deletions":2,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -28,1 +28,0 @@\n-#include \"jni.h\"\n@@ -31,0 +30,1 @@\n+#include \"jni.h\"\n","filename":"src\/hotspot\/share\/runtime\/continuation.hpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -26,0 +26,1 @@\n+#include \"jvm.h\"\n@@ -41,1 +42,0 @@\n-#include \"jvm.h\"\n","filename":"src\/hotspot\/share\/runtime\/deoptimization.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -65,1 +65,1 @@\n-  \/\/ Offset (in bytes) of field from start of instanceOop \/ Klass*\n+  \/\/ Offset (in words) of field from start of instanceOop \/ Klass*\n","filename":"src\/hotspot\/share\/runtime\/fieldDescriptor.hpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -26,1 +26,0 @@\n-#include \"jfr\/jfrEvents.hpp\"\n@@ -28,0 +27,1 @@\n+#include \"jfr\/jfrEvents.hpp\"\n","filename":"src\/hotspot\/share\/runtime\/flags\/jvmFlag.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -39,0 +39,12 @@\n+JVMFlag::Error AliasLevelConstraintFunc(intx value, bool verbose) {\n+  if ((value <= 1) && (Arguments::mode() == Arguments::_comp || Arguments::mode() == Arguments::_mixed)) {\n+    JVMFlag::printError(verbose,\n+                        \"AliasLevel (\" INTX_FORMAT \") is not \"\n+                        \"compatible with -Xcomp or -Xmixed\\n\",\n+                        value);\n+    return JVMFlag::VIOLATES_CONSTRAINT;\n+  } else {\n+    return JVMFlag::SUCCESS;\n+  }\n+}\n+\n","filename":"src\/hotspot\/share\/runtime\/flags\/jvmFlagConstraintsCompiler.cpp","additions":12,"deletions":0,"binary":false,"changes":12,"status":"modified"},{"patch":"@@ -38,0 +38,1 @@\n+  f(intx,  AliasLevelConstraintFunc)                    \\\n","filename":"src\/hotspot\/share\/runtime\/flags\/jvmFlagConstraintsCompiler.hpp","additions":1,"deletions":0,"binary":false,"changes":1,"status":"modified"},{"patch":"@@ -241,3 +241,0 @@\n-  product(bool, UsePolyIntrinsics, false, DIAGNOSTIC,                       \\\n-          \"Use intrinsics for sun.security.util.math.intpoly\")              \\\n-                                                                            \\\n","filename":"src\/hotspot\/share\/runtime\/globals.hpp","additions":0,"deletions":3,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -26,0 +26,1 @@\n+#include \"jvm_io.h\"\n@@ -28,1 +29,0 @@\n-#include \"jvm_io.h\"\n","filename":"src\/hotspot\/share\/runtime\/handshake.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -31,0 +31,3 @@\n+#if INCLUDE_JVMCI\n+#include \"jvmci\/jvmci.hpp\"\n+#endif\n@@ -48,3 +51,1 @@\n-#if INCLUDE_JVMCI\n-#include \"jvmci\/jvmci.hpp\"\n-#endif\n+\n","filename":"src\/hotspot\/share\/runtime\/init.cpp","additions":4,"deletions":3,"binary":false,"changes":7,"status":"modified"},{"patch":"@@ -26,0 +26,1 @@\n+#include \"jvm.h\"\n@@ -41,1 +42,3 @@\n-#include \"jvm.h\"\n+#if INCLUDE_JVMCI\n+#include \"jvmci\/jvmci.hpp\"\n+#endif\n@@ -93,3 +96,0 @@\n-#if INCLUDE_JVMCI\n-#include \"jvmci\/jvmci.hpp\"\n-#endif\n","filename":"src\/hotspot\/share\/runtime\/java.cpp","additions":4,"deletions":4,"binary":false,"changes":8,"status":"modified"},{"patch":"@@ -33,0 +33,3 @@\n+#if INCLUDE_JVMCI\n+#include \"jvmci\/jvmciJavaClasses.hpp\"\n+#endif\n@@ -49,3 +52,0 @@\n-#if INCLUDE_JVMCI\n-#include \"jvmci\/jvmciJavaClasses.hpp\"\n-#endif\n","filename":"src\/hotspot\/share\/runtime\/javaCalls.cpp","additions":3,"deletions":3,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -27,0 +27,1 @@\n+#include \"jvm.h\"\n@@ -42,1 +43,0 @@\n-#include \"jvm.h\"\n@@ -602,2 +602,4 @@\n-  \/\/ Enqueue OopHandles for release by the service thread.\n-  add_oop_handles_for_release();\n+  \/\/ Ask ServiceThread to release the threadObj OopHandle\n+  ServiceThread::add_oop_handle_release(_threadObj);\n+  ServiceThread::add_oop_handle_release(_vthread);\n+  ServiceThread::add_oop_handle_release(_jvmti_vthread);\n@@ -2073,54 +2075,0 @@\n-\n-\/\/ Deferred OopHandle release support.\n-\n-class OopHandleList : public CHeapObj<mtInternal> {\n-  static const int _count = 4;\n-  OopHandle _handles[_count];\n-  OopHandleList* _next;\n-  int _index;\n- public:\n-  OopHandleList(OopHandleList* next) : _next(next), _index(0) {}\n-  void add(OopHandle h) {\n-    assert(_index < _count, \"too many additions\");\n-    _handles[_index++] = h;\n-  }\n-  ~OopHandleList() {\n-    assert(_index == _count, \"usage error\");\n-    for (int i = 0; i < _index; i++) {\n-      _handles[i].release(JavaThread::thread_oop_storage());\n-    }\n-  }\n-  OopHandleList* next() const { return _next; }\n-};\n-\n-OopHandleList* JavaThread::_oop_handle_list = nullptr;\n-\n-\/\/ Called by the ServiceThread to do the work of releasing\n-\/\/ the OopHandles.\n-void JavaThread::release_oop_handles() {\n-  OopHandleList* list;\n-  {\n-    MutexLocker ml(Service_lock, Mutex::_no_safepoint_check_flag);\n-    list = _oop_handle_list;\n-    _oop_handle_list = nullptr;\n-  }\n-  assert(!SafepointSynchronize::is_at_safepoint(), \"cannot be called at a safepoint\");\n-\n-  while (list != nullptr) {\n-    OopHandleList* l = list;\n-    list = l->next();\n-    delete l;\n-  }\n-}\n-\n-\/\/ Add our OopHandles for later release.\n-void JavaThread::add_oop_handles_for_release() {\n-  MutexLocker ml(Service_lock, Mutex::_no_safepoint_check_flag);\n-  OopHandleList* new_head = new OopHandleList(_oop_handle_list);\n-  new_head->add(_threadObj);\n-  new_head->add(_vthread);\n-  new_head->add(_jvmti_vthread);\n-  new_head->add(_extentLocalCache);\n-  _oop_handle_list = new_head;\n-  Service_lock->notify_all();\n-}\n","filename":"src\/hotspot\/share\/runtime\/javaThread.cpp","additions":5,"deletions":57,"binary":false,"changes":62,"status":"modified"},{"patch":"@@ -62,1 +62,0 @@\n-class OopHandleList;\n@@ -85,1 +84,0 @@\n-  friend class ServiceThread; \/\/ for deferred OopHandle release access\n@@ -89,4 +87,0 @@\n-\n-  \/\/ All references to Java objects managed via OopHandles. These\n-  \/\/ have to be released by the ServiceThread after the JavaThread has\n-  \/\/ terminated - see add_oop_handles_for_release().\n@@ -1177,14 +1171,0 @@\n-\n-  \/\/ Deferred OopHandle release support\n- private:\n-  \/\/ List of OopHandles to be released - guarded by the Service_lock.\n-  static OopHandleList* _oop_handle_list;\n-  \/\/ Add our OopHandles to the list for the service thread to release.\n-  void add_oop_handles_for_release();\n-  \/\/ Called by the ServiceThread to release the OopHandles.\n-  static void release_oop_handles();\n-  \/\/ Called by the ServiceThread to poll if there are any OopHandles to release.\n-  \/\/ Called when holding the Service_lock.\n-  static bool has_oop_handles_to_release() {\n-    return _oop_handle_list != nullptr;\n-  }\n","filename":"src\/hotspot\/share\/runtime\/javaThread.hpp","additions":0,"deletions":20,"binary":false,"changes":20,"status":"modified"},{"patch":"@@ -26,0 +26,1 @@\n+#include \"jvm_io.h\"\n@@ -28,1 +29,0 @@\n-#include \"jvm_io.h\"\n@@ -39,0 +39,1 @@\n+\n","filename":"src\/hotspot\/share\/runtime\/nonJavaThread.cpp","additions":2,"deletions":1,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -26,0 +26,1 @@\n+#include \"jvm.h\"\n@@ -35,0 +36,1 @@\n+#include \"logging\/log.hpp\"\n@@ -36,1 +38,0 @@\n-#include \"jvm.h\"\n@@ -707,32 +708,1 @@\n-  if (MemTracker::enabled()) {\n-    \/\/ NMT realloc handling\n-\n-    const size_t new_outer_size = size + MemTracker::overhead_per_malloc();\n-\n-    \/\/ Handle size overflow.\n-    if (new_outer_size < size) {\n-      return NULL;\n-    }\n-\n-    const size_t old_size = MallocTracker::malloc_header(memblock)->size();\n-\n-    \/\/ De-account the old block from NMT *before* calling the real realloc(3) since it\n-    \/\/ may invalidate old block including its header. This will also perform integrity checks\n-    \/\/ on the old block (e.g. overwriters) and mark the old header as dead.\n-    void* const old_outer_ptr = MemTracker::record_free(memblock);\n-\n-    \/\/ the real realloc\n-    ALLOW_C_FUNCTION(::realloc, void* const new_outer_ptr = ::realloc(old_outer_ptr, new_outer_size);)\n-\n-    if (new_outer_ptr == NULL) {\n-      \/\/ If realloc(3) failed, the old block still exists. We must re-instantiate the old\n-      \/\/ NMT header then, since we marked it dead already. Otherwise subsequent os::realloc()\n-      \/\/ or os::free() calls would trigger block integrity asserts.\n-      void* p = MemTracker::record_malloc(old_outer_ptr, old_size, memflags, stack);\n-      assert(p == memblock, \"sanity\");\n-      return NULL;\n-    }\n-\n-    \/\/ After a successful realloc(3), we re-account the resized block with its new size\n-    \/\/ to NMT. This re-instantiates the NMT header.\n-    void* const new_inner_ptr = MemTracker::record_malloc(new_outer_ptr, size, memflags, stack);\n+  const size_t new_outer_size = size + MemTracker::overhead_per_malloc();\n@@ -740,16 +710,2 @@\n-#ifdef ASSERT\n-    if (old_size < size) {\n-      \/\/ We also zap the newly extended region.\n-      ::memset((char*)new_inner_ptr + old_size, uninitBlockPad, size - old_size);\n-    }\n-#endif\n-\n-    rc = new_inner_ptr;\n-\n-  } else {\n-\n-    \/\/ NMT disabled.\n-    ALLOW_C_FUNCTION(::realloc, rc = ::realloc(memblock, size);)\n-    if (rc == NULL) {\n-      return NULL;\n-    }\n+  \/\/ If NMT is enabled, this checks for heap overwrites, then de-accounts the old block.\n+  void* const old_outer_ptr = MemTracker::record_free(memblock);\n@@ -757,0 +713,3 @@\n+  ALLOW_C_FUNCTION(::realloc, void* const new_outer_ptr = ::realloc(old_outer_ptr, new_outer_size);)\n+  if (new_outer_ptr == NULL) {\n+    return NULL;\n@@ -759,1 +718,3 @@\n-  DEBUG_ONLY(break_if_ptr_caught(rc);)\n+  void* const new_inner_ptr = MemTracker::record_malloc(new_outer_ptr, size, memflags, stack);\n+\n+  DEBUG_ONLY(break_if_ptr_caught(new_inner_ptr);)\n@@ -761,1 +722,1 @@\n-  return rc;\n+  return new_inner_ptr;\n","filename":"src\/hotspot\/share\/runtime\/os.cpp","additions":12,"deletions":51,"binary":false,"changes":63,"status":"modified"},{"patch":"@@ -443,9 +443,0 @@\n-  \/\/ Does the platform support trimming the native heap?\n-  static bool can_trim_native_heap();\n-\n-  \/\/ Trim the C-heap. Optionally returns working set size change (RSS+Swap) in *rss_change.\n-  \/\/ Note: If trimming succeeded but no size change information could be obtained,\n-  \/\/ rss_change.after will contain SIZE_MAX upon return.\n-  struct size_change_t { size_t before; size_t after; };\n-  static bool trim_native_heap(size_change_t* rss_change = nullptr);\n-\n@@ -959,0 +950,1 @@\n+  static bool supports_sse();\n","filename":"src\/hotspot\/share\/runtime\/os.hpp","additions":1,"deletions":9,"binary":false,"changes":10,"status":"modified"},{"patch":"@@ -26,1 +26,0 @@\n-#include \"classfile\/vmSymbols.hpp\"\n@@ -28,0 +27,1 @@\n+#include \"classfile\/vmSymbols.hpp\"\n","filename":"src\/hotspot\/share\/runtime\/perfData.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -26,0 +26,1 @@\n+#include \"jvm.h\"\n@@ -34,1 +35,0 @@\n-#include \"jvm.h\"\n","filename":"src\/hotspot\/share\/runtime\/reflection.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -1006,1 +1006,0 @@\n-jlong     SafepointTracing::_max_cleanup_time = 0;\n@@ -1076,2 +1075,0 @@\n-  log_info(safepoint, stats)(\"Maximum cleanup time  \" INT64_FORMAT\" ns\",\n-                              (int64_t)(_max_cleanup_time));\n@@ -1116,3 +1113,0 @@\n-  if (_max_cleanup_time < (_last_safepoint_cleanup_time_ns - _last_safepoint_sync_time_ns)) {\n-    _max_cleanup_time = _last_safepoint_cleanup_time_ns - _last_safepoint_sync_time_ns;\n-  }\n@@ -1130,1 +1124,0 @@\n-     \"Cleanup: \" JLONG_FORMAT \" ns, \"\n@@ -1135,2 +1128,1 @@\n-      _last_safepoint_sync_time_ns    - _last_safepoint_begin_time_ns,\n-      _last_safepoint_cleanup_time_ns - _last_safepoint_sync_time_ns,\n+      _last_safepoint_cleanup_time_ns - _last_safepoint_begin_time_ns,\n@@ -1141,1 +1133,1 @@\n-  RuntimeService::record_safepoint_end(_last_safepoint_end_time_ns - _last_safepoint_sync_time_ns);\n+  RuntimeService::record_safepoint_end(_last_safepoint_end_time_ns - _last_safepoint_cleanup_time_ns);\n","filename":"src\/hotspot\/share\/runtime\/safepoint.cpp","additions":2,"deletions":10,"binary":false,"changes":12,"status":"modified"},{"patch":"@@ -262,1 +262,0 @@\n-  static jlong     _max_cleanup_time;\n","filename":"src\/hotspot\/share\/runtime\/safepoint.hpp","additions":0,"deletions":1,"binary":false,"changes":1,"status":"modified"},{"patch":"@@ -97,1 +97,0 @@\n-\n@@ -104,18 +103,0 @@\n-    uintptr_t prev_poll_word = thread->poll_data()->get_polling_word();\n-\n-    if (prev_poll_word != poll_word ||\n-        prev_poll_word == _poll_word_armed_value) {\n-      \/\/ While updating the poll value, we allow entering new nmethods\n-      \/\/ through stack unwinding. The nmethods might have been processed in\n-      \/\/ a concurrent thread by the GC. So we need to run a cross modify\n-      \/\/ fence to ensure patching becomes visible. We may also wake up from\n-      \/\/ a safepoint that has patched code. This cross modify fence will\n-      \/\/ ensure such paths can observe patched code.\n-      \/\/ Note that while other threads may arm the thread-local poll of\n-      \/\/ a thread, only the thread itself has permission to disarm its own\n-      \/\/ poll value, in any way making it less restrictive. Therefore, whenever\n-      \/\/ the frontier of what the mutator allows itself to do is increased,\n-      \/\/ we will catch that here, and ensure a cross modifying fence is used.\n-      OrderAccess::cross_modify_fence();\n-    }\n-\n@@ -163,0 +144,1 @@\n+  OrderAccess::cross_modify_fence();\n","filename":"src\/hotspot\/share\/runtime\/safepointMechanism.cpp","additions":1,"deletions":19,"binary":false,"changes":20,"status":"modified"},{"patch":"@@ -81,0 +81,4 @@\n+\n+  \/\/ We are now about to avoid processing and thus no cross modify fence will be executed.\n+  \/\/ In case a safepoint happened, while being blocked, we execute it here.\n+  OrderAccess::cross_modify_fence();\n","filename":"src\/hotspot\/share\/runtime\/safepointMechanism.inline.hpp","additions":4,"deletions":0,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -62,0 +62,30 @@\n+\/\/ Defer releasing JavaThread OopHandle to the ServiceThread\n+class OopHandleList : public CHeapObj<mtInternal> {\n+  OopHandle      _handle;\n+  OopHandleList* _next;\n+ public:\n+   OopHandleList(OopHandle h, OopHandleList* next) : _handle(h), _next(next) {}\n+   ~OopHandleList() {\n+     _handle.release(JavaThread::thread_oop_storage());\n+   }\n+   OopHandleList* next() const { return _next; }\n+};\n+\n+static OopHandleList* _oop_handle_list = NULL;\n+\n+static void release_oop_handles() {\n+  OopHandleList* list;\n+  {\n+    MutexLocker ml(Service_lock, Mutex::_no_safepoint_check_flag);\n+    list = _oop_handle_list;\n+    _oop_handle_list = NULL;\n+  }\n+  assert(!SafepointSynchronize::is_at_safepoint(), \"cannot be called at a safepoint\");\n+\n+  while (list != NULL) {\n+    OopHandleList* l = list;\n+    list = l->next();\n+    delete l;\n+  }\n+}\n+\n@@ -125,1 +155,1 @@\n-              (oop_handles_to_release = JavaThread::has_oop_handles_to_release()) |\n+              (oop_handles_to_release = (_oop_handle_list != NULL)) |\n@@ -188,1 +218,1 @@\n-      JavaThread::release_oop_handles();\n+      release_oop_handles();\n@@ -234,0 +264,7 @@\n+\n+void ServiceThread::add_oop_handle_release(OopHandle handle) {\n+  MutexLocker ml(Service_lock, Mutex::_no_safepoint_check_flag);\n+  OopHandleList* new_head = new OopHandleList(handle, _oop_handle_list);\n+  _oop_handle_list = new_head;\n+  Service_lock->notify_all();\n+}\n","filename":"src\/hotspot\/share\/runtime\/serviceThread.cpp","additions":39,"deletions":2,"binary":false,"changes":41,"status":"modified"},{"patch":"@@ -55,0 +55,1 @@\n+  static void add_oop_handle_release(OopHandle handle);\n","filename":"src\/hotspot\/share\/runtime\/serviceThread.hpp","additions":1,"deletions":0,"binary":false,"changes":1,"status":"modified"},{"patch":"@@ -26,0 +26,1 @@\n+#include \"jvm.h\"\n@@ -44,1 +45,0 @@\n-#include \"jvm.h\"\n","filename":"src\/hotspot\/share\/runtime\/sharedRuntime.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -133,1 +133,0 @@\n-address StubRoutines::_poly1305_processBlocks              = NULL;\n","filename":"src\/hotspot\/share\/runtime\/stubRoutines.cpp","additions":0,"deletions":1,"binary":false,"changes":1,"status":"modified"},{"patch":"@@ -214,1 +214,0 @@\n-  static address _poly1305_processBlocks;\n@@ -388,1 +387,0 @@\n-  static address poly1305_processBlocks()               { return _poly1305_processBlocks; }\n","filename":"src\/hotspot\/share\/runtime\/stubRoutines.hpp","additions":0,"deletions":2,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -27,0 +27,1 @@\n+#include \"jvm.h\"\n@@ -31,1 +32,0 @@\n-#include \"jvm.h\"\n","filename":"src\/hotspot\/share\/runtime\/thread.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -30,5 +30,0 @@\n-#if defined(LINUX) || defined(AIX) || defined(BSD)\n-# include \"threadCrashProtection_posix.hpp\"\n-#else\n-# include OS_HEADER(threadCrashProtection)\n-#endif\n@@ -41,0 +36,6 @@\n+#if defined(LINUX) || defined(AIX) || defined(BSD)\n+# include \"threadCrashProtection_posix.hpp\"\n+#else\n+# include OS_HEADER(threadCrashProtection)\n+#endif\n+\n","filename":"src\/hotspot\/share\/runtime\/threadCrashProtection.hpp","additions":6,"deletions":5,"binary":false,"changes":11,"status":"modified"},{"patch":"@@ -27,0 +27,1 @@\n+#include \"jvm.h\"\n@@ -45,1 +46,0 @@\n-#include \"jvm.h\"\n","filename":"src\/hotspot\/share\/runtime\/threads.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -112,0 +112,5 @@\n+\n+#include CPU_HEADER(vmStructs)\n+#include OS_HEADER(vmStructs)\n+#include OS_CPU_HEADER(vmStructs)\n+\n@@ -140,4 +145,0 @@\n-#include CPU_HEADER(vmStructs)\n-#include OS_HEADER(vmStructs)\n-#include OS_CPU_HEADER(vmStructs)\n-\n@@ -546,1 +547,0 @@\n-     static_field(StubRoutines,                _poly1305_processBlocks,                       address)                               \\\n","filename":"src\/hotspot\/share\/runtime\/vmStructs.cpp","additions":5,"deletions":5,"binary":false,"changes":10,"status":"modified"},{"patch":"@@ -29,1 +29,1 @@\n-#include \"utilities\/macros.hpp\"\n+#include \"utilities\/macros.hpp\"  \/\/ for CPU_HEADER() macro.\n","filename":"src\/hotspot\/share\/runtime\/vm_version.hpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -26,0 +26,1 @@\n+#include \"jvm.h\"\n@@ -37,1 +38,0 @@\n-#include \"jvm.h\"\n","filename":"src\/hotspot\/share\/services\/diagnosticCommand.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -26,0 +26,1 @@\n+#include \"jvm.h\"\n@@ -36,1 +37,0 @@\n-#include \"jvm.h\"\n","filename":"src\/hotspot\/share\/services\/heapDumper.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -25,1 +25,0 @@\n-\n@@ -27,1 +26,1 @@\n-#include \"jvm_io.h\"\n+\n@@ -40,0 +39,2 @@\n+#include \"jvm_io.h\"\n+\n","filename":"src\/hotspot\/share\/services\/mallocTracker.cpp","additions":3,"deletions":2,"binary":false,"changes":5,"status":"modified"},{"patch":"@@ -316,0 +316,1 @@\n+ private:\n","filename":"src\/hotspot\/share\/services\/mallocTracker.hpp","additions":1,"deletions":0,"binary":false,"changes":1,"status":"modified"},{"patch":"@@ -26,0 +26,1 @@\n+#include \"jmm.h\"\n@@ -31,1 +32,0 @@\n-#include \"jmm.h\"\n","filename":"src\/hotspot\/share\/services\/management.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -50,1 +50,1 @@\n-NMT_TrackingLevel MemTracker::_tracking_level = NMT_unknown;\n+volatile NMT_TrackingLevel MemTracker::_tracking_level = NMT_unknown;\n","filename":"src\/hotspot\/share\/services\/memTracker.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -38,1 +38,1 @@\n-                    NativeCallStack(0) : FAKE_CALLSTACK)\n+                    NativeCallStack(0) : NativeCallStack::empty_stack())\n@@ -40,1 +40,1 @@\n-                    NativeCallStack(1) : FAKE_CALLSTACK)\n+                    NativeCallStack(1) : NativeCallStack::empty_stack())\n@@ -234,1 +234,4 @@\n-  static NMT_TrackingLevel   _tracking_level;\n+  static volatile NMT_TrackingLevel   _tracking_level;\n+  \/\/ If NMT option value passed by launcher through environment\n+  \/\/ variable is valid\n+  static bool                         _is_nmt_env_valid;\n","filename":"src\/hotspot\/share\/services\/memTracker.hpp","additions":6,"deletions":3,"binary":false,"changes":9,"status":"modified"},{"patch":"@@ -162,0 +162,1 @@\n+bool NMTPreInit::_nmt_was_initialized = false;\n@@ -182,1 +183,2 @@\n-  assert(!MemTracker::is_initialized(), \"just once\");\n+  assert(_nmt_was_initialized == false, \"just once\");\n+  _nmt_was_initialized = true;\n","filename":"src\/hotspot\/share\/services\/nmtPreInit.cpp","additions":3,"deletions":1,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -33,1 +33,0 @@\n-#include \"services\/memTracker.hpp\"\n@@ -221,0 +220,1 @@\n+  static bool _nmt_was_initialized;\n@@ -230,1 +230,1 @@\n-    assert(!MemTracker::is_initialized(), \"lookup map cannot be modified after NMT initialization\");\n+    assert(!_nmt_was_initialized, \"lookup map cannot be modified after NMT initialization\");\n@@ -245,1 +245,1 @@\n-    assert(!MemTracker::is_initialized(), \"lookup map cannot be modified after NMT initialization\");\n+    assert(!_nmt_was_initialized, \"lookup map cannot be modified after NMT initialization\");\n@@ -259,0 +259,3 @@\n+  \/\/ Returns true if we are still in pre-init phase, false if post-init\n+  static bool in_preinit_phase()  { return _nmt_was_initialized == false; }\n+\n@@ -264,1 +267,1 @@\n-    if (!MemTracker::is_initialized()) {\n+    if (!_nmt_was_initialized) {\n@@ -284,1 +287,1 @@\n-    if (!MemTracker::is_initialized()) {\n+    if (!_nmt_was_initialized) {\n@@ -323,1 +326,1 @@\n-    if (!MemTracker::is_initialized()) {\n+    if (!_nmt_was_initialized) {\n","filename":"src\/hotspot\/share\/services\/nmtPreInit.hpp","additions":9,"deletions":6,"binary":false,"changes":15,"status":"modified"},{"patch":"@@ -39,1 +39,0 @@\n-\/\/ For the BitMaps with allocators that don't support reallocate\n@@ -41,37 +40,3 @@\n-static bm_word_t* pseudo_reallocate(const BitMapWithAllocator& derived, bm_word_t* old_map, size_t old_size_in_words, size_t new_size_in_words) {\n-  assert(new_size_in_words > 0, \"precondition\");\n-\n-  bm_word_t* map = derived.allocate(new_size_in_words);\n-  if (old_map != NULL) {\n-    Copy::disjoint_words((HeapWord*)old_map, (HeapWord*) map,\n-        MIN2(old_size_in_words, new_size_in_words));\n-  }\n-\n-  derived.free(old_map, old_size_in_words);\n-\n-  return map;\n-}\n-\n-template <class BitMapWithAllocator>\n-void GrowableBitMap<BitMapWithAllocator>::initialize(idx_t size_in_bits, bool clear) {\n-  assert(map() == NULL, \"precondition\");\n-  assert(size() == 0,   \"precondition\");\n-\n-  resize(size_in_bits, clear);\n-}\n-\n-template <class BitMapWithAllocator>\n-void GrowableBitMap<BitMapWithAllocator>::reinitialize(idx_t new_size_in_bits, bool clear) {\n-  \/\/ Remove previous bits - no need to clear\n-  resize(0, false \/* clear *\/);\n-\n-  initialize(new_size_in_bits, clear);\n-}\n-\n-template <class BitMapWithAllocator>\n-void GrowableBitMap<BitMapWithAllocator>::resize(idx_t new_size_in_bits, bool clear) {\n-  const size_t old_size_in_bits = size();\n-  bm_word_t* const old_map = map();\n-\n-  const size_t old_size_in_words = calc_size_in_words(size());\n-  const size_t new_size_in_words = calc_size_in_words(new_size_in_bits);\n+bm_word_t* GrowableBitMap<BitMapWithAllocator>::reallocate(bm_word_t* old_map, idx_t old_size_in_bits, idx_t new_size_in_bits, bool clear) {\n+  size_t old_size_in_words = calc_size_in_words(old_size_in_bits);\n+  size_t new_size_in_words = calc_size_in_words(new_size_in_bits);\n@@ -79,0 +44,1 @@\n+  bm_word_t* map = NULL;\n@@ -81,4 +47,17 @@\n-  if (new_size_in_words == 0) {\n-    derived->free(old_map, old_size_in_words);\n-    update(NULL, 0);\n-    return;\n+  if (new_size_in_words > 0) {\n+    map = derived->allocate(new_size_in_words);\n+\n+    if (old_map != NULL) {\n+      Copy::disjoint_words((HeapWord*)old_map, (HeapWord*) map,\n+                           MIN2(old_size_in_words, new_size_in_words));\n+    }\n+\n+    if (clear && (new_size_in_bits > old_size_in_bits)) {\n+      \/\/ If old_size_in_bits is not word-aligned, then the preceding\n+      \/\/ copy can include some trailing bits in the final copied word\n+      \/\/ that also need to be cleared.  See clear_range_within_word.\n+      bm_word_t mask = bit_mask(old_size_in_bits) - 1;\n+      map[raw_to_words_align_down(old_size_in_bits)] &= mask;\n+      \/\/ Clear the remaining full words.\n+      clear_range_of_words(map, old_size_in_words, new_size_in_words);\n+    }\n@@ -87,10 +66,2 @@\n-\n-  bm_word_t* map = derived->reallocate(old_map, old_size_in_words, new_size_in_words);\n-  if (clear && (new_size_in_bits > old_size_in_bits)) {\n-    \/\/ If old_size_in_bits is not word-aligned, then the preceding\n-    \/\/ copy can include some trailing bits in the final copied word\n-    \/\/ that also need to be cleared.  See clear_range_within_word.\n-    bm_word_t mask = bit_mask(old_size_in_bits) - 1;\n-    map[raw_to_words_align_down(old_size_in_bits)] &= mask;\n-    \/\/ Clear the remaining full words.\n-    clear_range_of_words(map, old_size_in_words, new_size_in_words);\n+  if (old_map != NULL) {\n+    derived->free(old_map, old_size_in_words);\n@@ -99,1 +70,1 @@\n-  update(map, new_size_in_bits);\n+  return map;\n@@ -111,4 +82,0 @@\n-bm_word_t* ArenaBitMap::reallocate(bm_word_t* old_map, size_t old_size_in_words, size_t new_size_in_words) const {\n-  return pseudo_reallocate(*this, old_map, old_size_in_words, new_size_in_words);\n-}\n-\n@@ -124,4 +91,0 @@\n-bm_word_t* ResourceBitMap::reallocate(bm_word_t* old_map, size_t old_size_in_words, size_t new_size_in_words) const {\n-  return pseudo_reallocate(*this, old_map, old_size_in_words, new_size_in_words);\n-}\n-\n@@ -145,4 +108,0 @@\n-bm_word_t* CHeapBitMap::reallocate(bm_word_t* map, size_t old_size_in_words, size_t new_size_in_words) const {\n-  return ArrayAllocator<bm_word_t>::reallocate(map, old_size_in_words, new_size_in_words, _flags);\n-}\n-\n","filename":"src\/hotspot\/share\/utilities\/bitMap.cpp","additions":24,"deletions":65,"binary":false,"changes":89,"status":"modified"},{"patch":"@@ -329,0 +329,2 @@\n+  bm_word_t* reallocate(bm_word_t* map, idx_t old_size_in_bits, idx_t new_size_in_bits, bool clear);\n+\n@@ -333,1 +335,1 @@\n-  \/\/ Set up and optionally clear the bitmap memory.\n+  \/\/ Set up and clear the bitmap memory.\n@@ -337,1 +339,6 @@\n-  void initialize(idx_t size_in_bits, bool clear = true);\n+  void initialize(idx_t size_in_bits, bool clear = true) {\n+    assert(map() == NULL, \"precondition\");\n+    assert(size() == 0,   \"precondition\");\n+\n+    resize(size_in_bits, clear);\n+  }\n@@ -339,1 +346,1 @@\n-  \/\/ Set up and optionally clear the bitmap memory.\n+  \/\/ Set up and clear the bitmap memory.\n@@ -342,1 +349,6 @@\n-  void reinitialize(idx_t new_size_in_bits, bool clear = true);\n+  void reinitialize(idx_t new_size_in_bits, bool clear = true) {\n+    \/\/ Remove previous bits - no need to clear\n+    resize(0, false \/* clear *\/);\n+\n+    initialize(new_size_in_bits, clear);\n+  }\n@@ -349,2 +361,5 @@\n-  \/\/ and the extended memory is optionally cleared.\n-  void resize(idx_t new_size_in_bits, bool clear = true);\n+  \/\/ and the extended memory is cleared.\n+  void resize(idx_t new_size_in_bits, bool clear = true) {\n+    bm_word_t* new_map = reallocate(map(), size(), new_size_in_bits, clear);\n+    update(new_map, new_size_in_bits);\n+  }\n@@ -369,0 +384,1 @@\n+  \/\/ Clears the bitmap memory.\n@@ -372,1 +388,0 @@\n-  bm_word_t* reallocate(bm_word_t* old_map, size_t old_size_in_words, size_t new_size_in_words) const;\n@@ -374,1 +389,1 @@\n-    \/\/ ArenaBitMaps don't free memory.\n+    \/\/ ArenaBitMaps currently don't free memory.\n@@ -382,1 +397,1 @@\n-  explicit ResourceBitMap(idx_t size_in_bits, bool clear = true);\n+  ResourceBitMap(idx_t size_in_bits, bool clear = true);\n@@ -385,1 +400,0 @@\n-  bm_word_t* reallocate(bm_word_t* old_map, size_t old_size_in_words, size_t new_size_in_words) const;\n@@ -387,1 +401,1 @@\n-    \/\/ ResourceBitMaps don't free memory.\n+    \/\/ ArenaBitMaps currently don't free memory.\n@@ -401,0 +415,1 @@\n+  CHeapBitMap() : CHeapBitMap(mtInternal) {}\n@@ -402,1 +417,2 @@\n-  CHeapBitMap(idx_t size_in_bits, MEMFLAGS flags, bool clear = true);\n+  \/\/ Clears the bitmap memory.\n+  CHeapBitMap(idx_t size_in_bits, MEMFLAGS flags = mtInternal, bool clear = true);\n@@ -406,1 +422,0 @@\n-  bm_word_t* reallocate(bm_word_t* old_map, size_t old_size_in_words, size_t new_size_in_words) const;\n","filename":"src\/hotspot\/share\/utilities\/bitMap.hpp","additions":28,"deletions":13,"binary":false,"changes":41,"status":"modified"},{"patch":"@@ -26,0 +26,1 @@\n+#include \"jvm.h\"\n@@ -36,1 +37,0 @@\n-#include \"jvm.h\"\n","filename":"src\/hotspot\/share\/utilities\/debug.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -58,6 +58,1 @@\n-#if defined(__clang_major__) && (__clang_major__ < 5)\n-  DWARF_LOG_ERROR(\"The DWARF parser only supports Clang 5.0+.\");\n-  return false;\n-#else\n-  assert(filename != nullptr && line != nullptr, \"arguments should not be null\");\n-  assert(filename_len > 1, \"buffer must be able to at least hold 1 character with a null terminator\");\n+  assert(filename != nullptr && filename_len > 0 && line != nullptr, \"Argument error\");\n@@ -91,3 +86,0 @@\n-    \/\/ Return sane values.\n-    filename[0] = '\\0';\n-    *line = -1;\n@@ -101,1 +93,0 @@\n-#endif \/\/ clang\n","filename":"src\/hotspot\/share\/utilities\/decoder_elf.cpp","additions":1,"deletions":10,"binary":false,"changes":11,"status":"modified"},{"patch":"@@ -29,0 +29,5 @@\n+#include <string.h>\n+#include <stdio.h>\n+#include <limits.h>\n+#include <new>\n+\n@@ -39,5 +44,0 @@\n-#include <string.h>\n-#include <stdio.h>\n-#include <limits.h>\n-#include <new>\n-\n@@ -448,1 +448,1 @@\n-  char* last_slash = strrchr(_path, *os::file_separator());\n+  char* last_slash = strrchr(_path, '\/');\n@@ -1204,1 +1204,1 @@\n-  if (!_reader.read_byte(&_header._line_base)) {\n+  if (!_reader.read_sbyte(&_header._line_base)) {\n@@ -1611,0 +1611,5 @@\n+    if (!_reader.read_string(filename, filename_len)) {\n+      \/\/ Either an error while reading or we have reached the end of the file_names. Both should not happen.\n+      return false;\n+    }\n+\n@@ -1613,5 +1618,1 @@\n-      return read_filename(filename, filename_len);\n-    } else if (!_reader.read_string()) { \/\/ We don't care about this filename string. Read and ignore it.\n-      \/\/ Either an error while reading or we have reached the end of the file_names section before reaching the file_index.\n-      \/\/ Both should not happen.\n-      return false;\n+      return true;\n@@ -1632,58 +1633,0 @@\n-\/\/ Read the filename into the provided 'filename' buffer. If it does not fit, an alternative smaller tag will be emitted\n-\/\/ in order to let the DWARF parser succeed. The line number with a function name will almost always be sufficient to get\n-\/\/ to the actual source code location.\n-bool DwarfFile::LineNumberProgram::read_filename(char* filename, const size_t filename_len) {\n-  char next_char;\n-  if (!_reader.read_non_null_char(&next_char)) {\n-    \/\/ Either error while reading or read an empty string which indicates the end of the file_names section.\n-    \/\/ Both should not happen.\n-    return false;\n-  }\n-\n-  filename[0] = next_char;\n-  size_t index = 1;\n-  bool overflow_filename = false; \/\/ Is the currently read filename overflowing the provided 'filename' buffer?\n-  while (next_char != '\\0' && _reader.has_bytes_left()) {\n-    if (!_reader.read_byte(&next_char)) {\n-      return false;\n-    }\n-    if (next_char == *os::file_separator()) {\n-      \/\/ Skip file separator to get to the actual filename and reset the buffer and overflow flag. GCC does not emit\n-      \/\/ file separators while Clang does.\n-      index = 0;\n-      overflow_filename = false;\n-    } else if (index == filename_len) {\n-      \/\/ Just keep reading as we could read another file separator and reset the buffer again. But don't bother to store\n-      \/\/ the additionally read characters as it would not fit into the buffer anyway.\n-      overflow_filename = true;\n-    } else {\n-      assert(!overflow_filename, \"sanity check\");\n-      filename[index] = next_char;\n-      index++;\n-    }\n-  }\n-\n-  if (overflow_filename) {\n-    \/\/ 'filename' buffer overflow. Store either a generic overflow message or a minimal filename.\n-    write_filename_for_overflow(filename, filename_len);\n-  }\n-  return true;\n-}\n-\n-\/\/ Try to write a generic overflow message to the provided buffer. If it does not fit, store the minimal filename \"L\"\n-\/\/ which always fits to get the source information in the form \"L:line_number\".\n-void DwarfFile::LineNumberProgram::write_filename_for_overflow(char* filename, const size_t filename_len) {\n-  DWARF_LOG_ERROR(\"DWARF filename string is too large to fit into the provided buffer of size %zu.\", filename_len);\n-  const size_t filename_overflow_message_length = strlen(overflow_filename) + 1;\n-  if (filename_overflow_message_length <= filename_len) {\n-    jio_snprintf(filename, filename_overflow_message_length, \"%s\", overflow_filename);\n-    DWARF_LOG_ERROR(\"Use overflow filename: %s\", overflow_filename);\n-  } else {\n-    \/\/ Buffer too small of generic overflow message.\n-    DWARF_LOG_ERROR(\"Too small for overflow filename, use minimal filename: %c\", minimal_overflow_filename);\n-    assert(filename_len > 1, \"sanity check\");\n-    filename[0] = minimal_overflow_filename;\n-    filename[1] = '\\0';\n-  }\n-}\n-\n@@ -1760,1 +1703,6 @@\n-bool DwarfFile::MarkedDwarfFileReader::read_byte(void* result) {\n+bool DwarfFile::MarkedDwarfFileReader::read_sbyte(int8_t* result) {\n+  _current_pos++;\n+  return read(result, 1);\n+}\n+\n+bool DwarfFile::MarkedDwarfFileReader::read_byte(uint8_t* result) {\n@@ -1829,2 +1777,7 @@\n-  char first_char;\n-  if (!read_non_null_char(&first_char)) {\n+  uint8_t next_byte;\n+  if (!read_byte(&next_byte)) {\n+    return false;\n+  }\n+\n+  if (next_byte == 0) {\n+    \/\/ Strings must contain at least one non-null byte.\n@@ -1839,1 +1792,1 @@\n-    result[0] = first_char;\n+    result[0] = (char)next_byte;\n@@ -1842,1 +1795,0 @@\n-  uint8_t next_byte;\n@@ -1872,7 +1824,0 @@\n-bool DwarfFile::MarkedDwarfFileReader::read_non_null_char(char* result) {\n-  if (!read_byte(result)) {\n-    return false;\n-  }\n-  return *result != '\\0';\n-}\n-\n","filename":"src\/hotspot\/share\/utilities\/elfFile.cpp","additions":27,"deletions":82,"binary":false,"changes":109,"status":"modified"},{"patch":"@@ -424,1 +424,2 @@\n-    bool read_byte(void* result);\n+    bool read_sbyte(int8_t* result);\n+    bool read_byte(uint8_t* result);\n@@ -434,1 +435,0 @@\n-    bool read_non_null_char(char* result);\n@@ -721,3 +721,0 @@\n-    static constexpr const char* overflow_filename = \"<OVERFLOW>\";\n-    static constexpr const char minimal_overflow_filename = 'L';\n-\n@@ -868,1 +865,1 @@\n-    void apply_special_opcode(uint8_t opcode);\n+    void apply_special_opcode(const uint8_t opcode);\n@@ -872,2 +869,0 @@\n-    bool read_filename(char* filename, size_t filename_len);\n-    static void write_filename_for_overflow(char* filename, size_t filename_len) ;\n","filename":"src\/hotspot\/share\/utilities\/elfFile.hpp","additions":3,"deletions":8,"binary":false,"changes":11,"status":"modified"},{"patch":"@@ -30,1 +30,0 @@\n-\n","filename":"src\/hotspot\/share\/utilities\/formatBuffer.hpp","additions":0,"deletions":1,"binary":false,"changes":1,"status":"modified"},{"patch":"@@ -375,3 +375,0 @@\n-#define PROPERFMT             SIZE_FORMAT \"%s\"\n-#define PROPERFMTARGS(s)      byte_size_in_proper_unit(s), proper_unit_for_byte_size(s)\n-\n","filename":"src\/hotspot\/share\/utilities\/globalDefinitions.hpp","additions":0,"deletions":3,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -60,2 +60,2 @@\n-GrowableArrayNestingCheck::GrowableArrayNestingCheck(bool on_resource_area) :\n-    _nesting(on_resource_area ? Thread::current()->resource_area()->nesting() : 0) {\n+GrowableArrayNestingCheck::GrowableArrayNestingCheck(bool on_stack) :\n+    _nesting(on_stack ? Thread::current()->resource_area()->nesting() : 0) {\n@@ -64,1 +64,1 @@\n-void GrowableArrayNestingCheck::on_resource_area_alloc() const {\n+void GrowableArrayNestingCheck::on_stack_alloc() const {\n@@ -82,1 +82,1 @@\n-  assert(on_resource_area() == array->allocated_on_res_area(),\n+  assert(on_stack() == array->allocated_on_res_area(),\n@@ -88,2 +88,2 @@\n-void GrowableArrayMetadata::on_resource_area_alloc_check() const {\n-  _nesting_check.on_resource_area_alloc();\n+void GrowableArrayMetadata::on_stack_alloc_check() const {\n+  _nesting_check.on_stack_alloc();\n","filename":"src\/hotspot\/share\/utilities\/growableArray.cpp","additions":6,"deletions":6,"binary":false,"changes":12,"status":"modified"},{"patch":"@@ -587,1 +587,1 @@\n-  GrowableArrayNestingCheck(bool on_resource_area);\n+  GrowableArrayNestingCheck(bool on_stack);\n@@ -589,1 +589,1 @@\n-  void on_resource_area_alloc() const;\n+  void on_stack_alloc() const;\n@@ -602,4 +602,5 @@\n-  \/\/ Resource allocation\n-  static uintptr_t bits() {\n-    return 0;\n-  }\n+  uintptr_t bits(MEMFLAGS memflags) const {\n+    if (memflags == mtNone) {\n+      \/\/ Stack allocation\n+      return 0;\n+    }\n@@ -607,3 +608,1 @@\n-  \/\/ CHeap allocation\n-  static uintptr_t bits(MEMFLAGS memflags) {\n-    assert(memflags != mtNone, \"Must provide a proper MEMFLAGS\");\n+    \/\/ CHeap allocation\n@@ -613,3 +612,1 @@\n-  \/\/ Arena allocation\n-  static uintptr_t bits(Arena* arena) {\n-    assert((uintptr_t(arena) & 1) == 0, \"Required for on_C_heap() to work\");\n+  uintptr_t bits(Arena* arena) const {\n@@ -620,7 +617,0 @@\n-  \/\/ Resource allocation\n-  GrowableArrayMetadata() :\n-      _bits(bits())\n-      debug_only(COMMA _nesting_check(true)) {\n-  }\n-\n-  \/\/ Arena allocation\n@@ -629,1 +619,1 @@\n-      debug_only(COMMA _nesting_check(false)) {\n+      debug_only(COMMA _nesting_check(on_stack())) {\n@@ -632,1 +622,0 @@\n-  \/\/ CHeap allocation\n@@ -635,1 +624,1 @@\n-      debug_only(COMMA _nesting_check(false)) {\n+      debug_only(COMMA _nesting_check(on_stack())) {\n@@ -655,1 +644,1 @@\n-  void on_resource_area_alloc_check() const;\n+  void on_stack_alloc_check() const;\n@@ -658,3 +647,3 @@\n-  bool on_C_heap() const        { return (_bits & 1) == 1; }\n-  bool on_resource_area() const { return _bits == 0; }\n-  bool on_arena() const         { return (_bits & 1) == 0 && _bits != 0; }\n+  bool on_C_heap() const { return (_bits & 1) == 1; }\n+  bool on_stack () const { return _bits == 0;      }\n+  bool on_arena () const { return (_bits & 1) == 0 && _bits != 0; }\n@@ -669,2 +658,2 @@\n-\/\/  - Resource stack allocation: if no extra argument is provided\n-\/\/  - CHeap allocation: if memflags is provided\n+\/\/  - Resource stack allocation: if memflags == mtNone\n+\/\/  - CHeap allocation: if memflags != mtNone\n@@ -693,1 +682,5 @@\n-    return (E*)GrowableArrayCHeapAllocator::allocate(max, sizeof(E), memflags);\n+    if (memflags != mtNone) {\n+      return (E*)GrowableArrayCHeapAllocator::allocate(max, sizeof(E), memflags);\n+    }\n+\n+    return (E*)GrowableArrayResourceAllocator::allocate(max, sizeof(E));\n@@ -705,3 +698,3 @@\n-  bool on_C_heap() const        { return _metadata.on_C_heap(); }\n-  bool on_resource_area() const { return _metadata.on_resource_area(); }\n-  bool on_arena() const         { return _metadata.on_arena(); }\n+  bool on_C_heap() const { return _metadata.on_C_heap(); }\n+  bool on_stack () const { return _metadata.on_stack(); }\n+  bool on_arena () const { return _metadata.on_arena(); }\n@@ -710,2 +703,2 @@\n-    if (on_resource_area()) {\n-      debug_only(_metadata.on_resource_area_alloc_check());\n+    if (on_stack()) {\n+      debug_only(_metadata.on_stack_alloc_check());\n@@ -730,11 +723,1 @@\n-  GrowableArray() : GrowableArray(2 \/* initial_capacity *\/) {}\n-\n-  explicit GrowableArray(int initial_capacity) :\n-      GrowableArrayWithAllocator<E, GrowableArray<E> >(\n-          allocate(initial_capacity),\n-          initial_capacity),\n-      _metadata() {\n-    init_checks();\n-  }\n-\n-  GrowableArray(int initial_capacity, MEMFLAGS memflags) :\n+  GrowableArray(int initial_capacity = 2, MEMFLAGS memflags = mtNone) :\n@@ -748,9 +731,1 @@\n-  GrowableArray(int initial_capacity, int initial_len, const E& filler) :\n-      GrowableArrayWithAllocator<E, GrowableArray<E> >(\n-          allocate(initial_capacity),\n-          initial_capacity, initial_len, filler),\n-      _metadata() {\n-    init_checks();\n-  }\n-\n-  GrowableArray(int initial_capacity, int initial_len, const E& filler, MEMFLAGS memflags) :\n+  GrowableArray(int initial_capacity, int initial_len, const E& filler, MEMFLAGS memflags = mtNone) :\n","filename":"src\/hotspot\/share\/utilities\/growableArray.hpp","additions":29,"deletions":54,"binary":false,"changes":83,"status":"modified"},{"patch":"@@ -80,1 +80,0 @@\n-  DEBUG_ONLY(assert_not_fake();)\n@@ -84,0 +83,1 @@\n+  int     line_no;\n@@ -99,4 +99,3 @@\n-      \/\/ Note: we deliberately omit printing source information here. NativeCallStack::print_on()\n-      \/\/ can be called thousands of times as part of NMT detail reporting, and source printing\n-      \/\/ can slow down reporting by a factor of 5 or more depending on platform (see JDK-8296931).\n-\n+      if (Decoder::get_source_info(pc, buf, sizeof(buf), &line_no, frame != 0)) {\n+        out->print(\"  (%s:%d)\", buf, line_no);\n+      }\n","filename":"src\/hotspot\/share\/utilities\/nativeCallStack.cpp","additions":4,"deletions":5,"binary":false,"changes":9,"status":"modified"},{"patch":"@@ -60,1 +60,0 @@\n-\n@@ -62,21 +61,0 @@\n-\n-  enum class FakeMarker { its_fake };\n-#ifdef ASSERT\n-  static constexpr uintptr_t _fake_address = -2; \/\/ 0xFF...FE\n-  inline void assert_not_fake() const {\n-    assert(_stack[0] != (address)_fake_address, \"Must not be a fake stack\");\n-  }\n-#endif\n-\n-  \/\/ This \"fake\" constructor is only used in the CALLER_PC and CURRENT_PC macros\n-  \/\/ when NMT is off or in summary mode. In these cases, it does not need a\n-  \/\/ callstack, and we can leave the constructed object uninitialized. That will\n-  \/\/ cause the constructor call to be optimized away (see JDK-8296437).\n-  explicit NativeCallStack(FakeMarker dummy) {\n-#ifdef ASSERT\n-    for (int i = 0; i < NMT_TrackingStackDepth; i++) {\n-      _stack[i] = (address)_fake_address;\n-    }\n-#endif\n-  }\n-\n@@ -90,1 +68,1 @@\n-  explicit NativeCallStack(address* pc, int frameCount);\n+  NativeCallStack(address* pc, int frameCount);\n@@ -96,1 +74,0 @@\n-    DEBUG_ONLY(assert_not_fake();)\n@@ -118,1 +95,0 @@\n-    DEBUG_ONLY(assert_not_fake();)\n@@ -130,2 +106,0 @@\n-#define FAKE_CALLSTACK NativeCallStack(NativeCallStack::FakeMarker::its_fake)\n-\n","filename":"src\/hotspot\/share\/utilities\/nativeCallStack.hpp","additions":1,"deletions":27,"binary":false,"changes":28,"status":"modified"},{"patch":"@@ -26,0 +26,1 @@\n+#include \"jvm.h\"\n@@ -28,1 +29,0 @@\n-#include \"jvm.h\"\n@@ -32,1 +32,0 @@\n-#include \"runtime\/orderAccess.hpp\"\n@@ -34,0 +33,1 @@\n+#include \"runtime\/orderAccess.hpp\"\n","filename":"src\/hotspot\/share\/utilities\/ostream.cpp","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2009, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2009, 2020, Oracle and\/or its affiliates. All rights reserved.\n@@ -255,1 +255,1 @@\n-  resource_free_bytes(Thread::current(), (char*) addr, bytes);\n+  resource_free_bytes((char*) addr, bytes);\n","filename":"src\/hotspot\/share\/utilities\/stack.inline.hpp","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -25,1 +25,0 @@\n-#include \"precompiled.hpp\"\n@@ -27,0 +26,1 @@\n+#include \"precompiled.hpp\"\n","filename":"src\/hotspot\/share\/utilities\/stringUtils.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -27,0 +27,1 @@\n+#include \"jvm.h\"\n@@ -33,1 +34,0 @@\n-#include \"jvm.h\"\n@@ -43,1 +43,0 @@\n-#include \"runtime\/flags\/jvmFlag.hpp\"\n@@ -57,0 +56,1 @@\n+#include \"runtime\/flags\/jvmFlag.hpp\"\n","filename":"src\/hotspot\/share\/utilities\/vmError.cpp","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -3,1 +3,1 @@\n- * Copyright (c) 2017, 2022 SAP SE. All rights reserved.\n+ * Copyright (c) 2017, 2020 SAP SE. All rights reserved.\n@@ -190,2 +190,3 @@\n-  \/\/ Non-NULL address guaranteed to generate a SEGV mapping error on read, for test purposes.\n-  static constexpr intptr_t segfault_address = (1 * K) AIX_ONLY(+ (4 * K));\n+  \/\/ Address which is guaranteed to generate a fault on read, for test purposes,\n+  \/\/ which is not NULL and contains bits in every word.\n+  static const intptr_t segfault_address = LP64_ONLY(0xABC0000000000ABCULL) NOT_LP64(0x00000ABC);\n","filename":"src\/hotspot\/share\/utilities\/vmError.hpp","additions":4,"deletions":3,"binary":false,"changes":7,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2002, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2002, 2021, Oracle and\/or its affiliates. All rights reserved.\n@@ -33,0 +33,1 @@\n+import java.nio.ByteBuffer;\n@@ -52,0 +53,1 @@\n+ *\n@@ -59,1 +61,1 @@\n-class AESCipher extends CipherSpi {\n+abstract class AESCipher extends CipherSpi {\n@@ -65,2 +67,1 @@\n-\n-    static class OidImpl extends AESCipher {\n+    abstract static class OidImpl extends AESCipher {\n@@ -78,1 +79,0 @@\n-\n@@ -141,1 +141,1 @@\n-    static void checkKeySize(Key key, int fixedKeySize)\n+    static final void checkKeySize(Key key, int fixedKeySize)\n@@ -163,1 +163,1 @@\n-    private final CipherCore core;\n+    private CipherCore core = null;\n@@ -189,1 +189,0 @@\n-    @Override\n@@ -203,1 +202,0 @@\n-    @Override\n@@ -215,1 +213,0 @@\n-    @Override\n@@ -237,1 +234,0 @@\n-    @Override\n@@ -254,1 +250,0 @@\n-    @Override\n@@ -272,1 +267,0 @@\n-    @Override\n@@ -307,1 +301,0 @@\n-    @Override\n@@ -338,1 +331,0 @@\n-    @Override\n@@ -347,1 +339,0 @@\n-    @Override\n@@ -375,1 +366,0 @@\n-    @Override\n@@ -404,1 +394,0 @@\n-    @Override\n@@ -443,1 +432,0 @@\n-    @Override\n@@ -446,1 +434,2 @@\n-        return core.doFinal(input, inputOffset, inputLen);\n+        byte[] out = core.doFinal(input, inputOffset, inputLen);\n+        return out;\n@@ -485,1 +474,0 @@\n-    @Override\n@@ -490,1 +478,1 @@\n-        return core.doFinal(input, inputOffset, inputLen, output,\n+        int outLen = core.doFinal(input, inputOffset, inputLen, output,\n@@ -492,0 +480,1 @@\n+        return outLen;\n@@ -503,1 +492,0 @@\n-    @Override\n@@ -530,1 +518,0 @@\n-    @Override\n@@ -557,1 +544,0 @@\n-    @Override\n","filename":"src\/java.base\/share\/classes\/com\/sun\/crypto\/provider\/AESCipher.java","additions":11,"deletions":25,"binary":false,"changes":36,"status":"modified"},{"patch":"@@ -183,1 +183,1 @@\n-        mdAlgId.encode(tmp2);\n+        mdAlgId.derEncode(tmp2);\n","filename":"src\/java.base\/share\/classes\/com\/sun\/crypto\/provider\/OAEPParameters.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2005, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2005, 2021, Oracle and\/or its affiliates. All rights reserved.\n@@ -66,4 +66,2 @@\n-        if (keySpec instanceof PBEKeySpec ks) {\n-            return new PBKDF2KeyImpl(ks, prfAlgo);\n-        } else {\n-            throw new InvalidKeySpecException(\"Only PBEKeySpec is accepted\");\n+        if (!(keySpec instanceof PBEKeySpec)) {\n+            throw new InvalidKeySpecException(\"Invalid key spec\");\n@@ -71,0 +69,2 @@\n+        PBEKeySpec ks = (PBEKeySpec) keySpec;\n+        return new PBKDF2KeyImpl(ks, prfAlgo);\n@@ -92,1 +92,1 @@\n-        if (key instanceof javax.crypto.interfaces.PBEKey pKey) {\n+        if (key instanceof javax.crypto.interfaces.PBEKey) {\n@@ -96,0 +96,2 @@\n+                javax.crypto.interfaces.PBEKey pKey =\n+                    (javax.crypto.interfaces.PBEKey) key;\n@@ -108,2 +110,1 @@\n-                throw new InvalidKeySpecException\n-                        (\"Only PBEKeySpec is accepted\");\n+                throw new InvalidKeySpecException(\"Invalid key spec\");\n@@ -112,1 +113,2 @@\n-            throw new InvalidKeySpecException(\"Only PBEKey is accepted\");\n+            throw new InvalidKeySpecException(\"Invalid key \" +\n+                                               \"format\/algorithm\");\n@@ -139,1 +141,3 @@\n-            if (key instanceof javax.crypto.interfaces.PBEKey pKey) {\n+            if (key instanceof javax.crypto.interfaces.PBEKey) {\n+                javax.crypto.interfaces.PBEKey pKey =\n+                    (javax.crypto.interfaces.PBEKey) key;\n@@ -159,2 +163,0 @@\n-            } else {\n-                throw new InvalidKeyException(\"Only PBEKey is accepted\");\n@@ -163,2 +165,1 @@\n-        throw new InvalidKeyException(\"Only PBKDF2With\" + prfAlgo +\n-                \" key with RAW format is accepted\");\n+        throw new InvalidKeyException(\"Invalid key format\/algorithm\");\n","filename":"src\/java.base\/share\/classes\/com\/sun\/crypto\/provider\/PBKDF2Core.java","additions":15,"deletions":14,"binary":false,"changes":29,"status":"modified"},{"patch":"@@ -37,2 +37,0 @@\n-import jdk.internal.vm.annotation.IntrinsicCandidate;\n-import jdk.internal.vm.annotation.ForceInline;\n@@ -64,1 +62,0 @@\n-    private final boolean checkWeakKey;\n@@ -66,2 +63,1 @@\n-    Poly1305() { this(true); }\n-    Poly1305(boolean checkKey) { checkWeakKey = checkKey; }\n+    Poly1305() { }\n@@ -172,9 +168,5 @@\n-\n-        int blockMultipleLength = len & (~(BLOCK_LENGTH-1));\n-        long[] aLimbs = a.getLimbs();\n-        long[] rLimbs = r.getLimbs();\n-        processMultipleBlocksCheck(input, offset, blockMultipleLength, aLimbs, rLimbs);\n-        processMultipleBlocks(input, offset, blockMultipleLength, aLimbs, rLimbs);\n-        offset += blockMultipleLength;\n-        len -= blockMultipleLength;\n-\n+        while (len >= BLOCK_LENGTH) {\n+            processBlock(input, offset, BLOCK_LENGTH);\n+            offset += BLOCK_LENGTH;\n+            len -= BLOCK_LENGTH;\n+        }\n@@ -246,23 +238,0 @@\n-    \/\/ This is an intrinsified method. The unused parameters aLimbs and rLimbs are used by the intrinsic.\n-    \/\/ They correspond to this.a and this.r respectively\n-    @ForceInline\n-    @IntrinsicCandidate\n-    private void processMultipleBlocks(byte[] input, int offset, int length, long[] aLimbs, long[] rLimbs) {\n-        while (length >= BLOCK_LENGTH) {\n-            processBlock(input, offset, BLOCK_LENGTH);\n-            offset += BLOCK_LENGTH;\n-            length -= BLOCK_LENGTH;\n-        }\n-    }\n-\n-    private static void processMultipleBlocksCheck(byte[] input, int offset, int length, long[] aLimbs, long[] rLimbs) {\n-        Objects.checkFromIndexSize(offset, length, input.length);\n-        final int numLimbs = 5; \/\/ Intrinsic expects exactly 5 limbs\n-        if (aLimbs.length != numLimbs) {\n-            throw new RuntimeException(\"invalid accumulator length: \" + aLimbs.length);\n-        }\n-        if (rLimbs.length != numLimbs) {\n-            throw new RuntimeException(\"invalid R length: \" + rLimbs.length);\n-        }\n-    }\n-\n@@ -274,1 +243,1 @@\n-    private void setRSVals() throws InvalidKeyException {\n+    private void setRSVals() {\n@@ -284,18 +253,0 @@\n-        if (checkWeakKey) {\n-            byte keyIsZero = 0;\n-            for (int i = 0; i < RS_LENGTH; i++) {\n-                keyIsZero |= keyBytes[i];\n-            }\n-            if (keyIsZero == 0) {\n-                throw new InvalidKeyException(\"R is set to zero\");\n-            }\n-\n-            keyIsZero = 0;\n-            for (int i = RS_LENGTH; i < 2*RS_LENGTH; i++) {\n-                keyIsZero |= keyBytes[i];\n-            }\n-            if (keyIsZero == 0) {\n-                throw new InvalidKeyException(\"S is set to zero\");\n-            }\n-        }\n-\n","filename":"src\/java.base\/share\/classes\/com\/sun\/crypto\/provider\/Poly1305.java","additions":7,"deletions":56,"binary":false,"changes":63,"status":"modified"},{"patch":"@@ -38,1 +38,1 @@\n-import jdk.internal.util.StaticProperty;\n+import sun.security.action.GetPropertyAction;\n@@ -1989,2 +1989,2 @@\n-        private static final File tmpdir = new File(StaticProperty.javaIoTmpDir());\n-\n+        private static final File tmpdir = new File(\n+                GetPropertyAction.privilegedGetProperty(\"java.io.tmpdir\"));\n","filename":"src\/java.base\/share\/classes\/java\/io\/File.java","additions":3,"deletions":3,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -28,1 +28,0 @@\n-import java.util.Arrays;\n@@ -57,2 +56,0 @@\n-\n-    \/\/ initialized to null when PushbackInputStream is sub-classed\n@@ -411,19 +408,0 @@\n-\n-    @Override\n-    public long transferTo(OutputStream out) throws IOException {\n-        Objects.requireNonNull(out, \"out\");\n-        ensureOpen();\n-        if (getClass() == PushbackInputStream.class) {\n-            int avail = buf.length - pos;\n-            if (avail > 0) {\n-                \/\/ Prevent poisoning and leaking of buf\n-                byte[] buffer = Arrays.copyOfRange(buf, pos, buf.length);\n-                out.write(buffer);\n-                pos = buffer.length;\n-            }\n-            return avail + in.transferTo(out);\n-        } else {\n-            return super.transferTo(out);\n-        }\n-    }\n-\n","filename":"src\/java.base\/share\/classes\/java\/io\/PushbackInputStream.java","additions":0,"deletions":22,"binary":false,"changes":22,"status":"modified"},{"patch":"@@ -28,2 +28,0 @@\n-import java.util.Arrays;\n-import java.util.Collections;\n@@ -32,0 +30,1 @@\n+import java.util.Vector;\n@@ -43,1 +42,1 @@\n- * @author  Arthur van Hoff\n+ * @author  Author van Hoff\n@@ -47,2 +46,2 @@\n-    private final Enumeration<? extends InputStream> e;\n-    private InputStream in;\n+    Enumeration<? extends InputStream> e;\n+    InputStream in;\n@@ -83,1 +82,5 @@\n-        this(Collections.enumeration(Arrays.asList(s1, s2)));\n+        Vector<InputStream> v = new Vector<>(2);\n+        v.addElement(s1);\n+        v.addElement(s2);\n+        e = v.elements();\n+        peekNextStream();\n","filename":"src\/java.base\/share\/classes\/java\/io\/SequenceInputStream.java","additions":9,"deletions":6,"binary":false,"changes":15,"status":"modified"},{"patch":"@@ -1299,15 +1299,11 @@\n-     * <p> If the underlying class is an array class:\n-     * <ul>\n-     * <li> its {@code public}, {@code private} and {@code protected}\n-     *      modifiers are the same as those of its component type\n-     * <li> its {@code abstract} and {@code final} modifiers are always\n-     *      {@code true}\n-     * <li> its interface modifier is always {@code false}, even when\n-     *      the component type is an interface\n-     * <\/ul>\n-     * If this {@code Class} object represents a primitive type or\n-     * void, its {@code public}, {@code abstract}, and {@code final}\n-     * modifiers are always {@code true}.\n-     * For {@code Class} objects representing void, primitive types, and\n-     * arrays, the values of other modifiers are {@code false} other\n-     * than as specified above.\n+     * <p> If the underlying class is an array class, then its\n+     * {@code public}, {@code private} and {@code protected}\n+     * modifiers are the same as those of its component type.  If this\n+     * {@code Class} object represents a primitive type or void, its\n+     * {@code public} modifier is always {@code true}, and its\n+     * {@code protected} and {@code private} modifiers are always\n+     * {@code false}. If this {@code Class} object represents an array class, a\n+     * primitive type or void, then its {@code final} modifier is always\n+     * {@code true} and its interface modifier is always\n+     * {@code false}. The values of its other modifiers are not determined\n+     * by this specification.\n@@ -1327,1 +1323,0 @@\n-     * @jvms 4.1 The {@code ClassFile} Structure\n@@ -1336,13 +1331,11 @@\n-     * <p> If the underlying class is an array class:\n-     * <ul>\n-     * <li> its {@code PUBLIC}, {@code PRIVATE} and {@code PROTECTED}\n-     *      access flags are the same as those of its component type\n-     * <li> its {@code ABSTRACT} and {@code FINAL} flags are present\n-     * <li> its {@code INTERFACE} flag is absent, even when the\n-     *      component type is an interface\n-     * <\/ul>\n-     * If this {@code Class} object represents a primitive type or\n-     * void, the flags are {@code PUBLIC}, {@code ABSTRACT}, and\n-     * {@code FINAL}.\n-     * For {@code Class} objects representing void, primitive types, and\n-     * arrays, access flags are absent other than as specified above.\n+     * <p> If the underlying class is an array class, then its\n+     * {@code PUBLIC}, {@code PRIVATE} and {@code PROTECTED}\n+     * access flags are the same as those of its component type.  If this\n+     * {@code Class} object represents a primitive type or void, the\n+     * {@code PUBLIC} access flag is present, and the\n+     * {@code PROTECTED} and {@code PRIVATE} access flags are always\n+     * absent. If this {@code Class} object represents an array class, a\n+     * primitive type or void, then the {@code FINAL} access flag is always\n+     * present and the interface access flag is always\n+     * absent. The values of its other access flags are not determined\n+     * by this specification.\n","filename":"src\/java.base\/share\/classes\/java\/lang\/Class.java","additions":22,"deletions":29,"binary":false,"changes":51,"status":"modified"},{"patch":"@@ -2247,6 +2247,0 @@\n-        \/\/ Emit a warning if java.io.tmpdir is set via the command line\n-        \/\/ to a directory that doesn't exist\n-        if (SystemProps.isBadIoTmpdir()) {\n-            System.err.println(\"WARNING: java.io.tmpdir directory does not exist\");\n-        }\n-\n","filename":"src\/java.base\/share\/classes\/java\/lang\/System.java","additions":0,"deletions":6,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -795,8 +795,0 @@\n-    \/**\n-     * Returns a snapshot of the subgroups as an array, used by JVMTI.\n-     *\/\n-    private ThreadGroup[] subgroupsAsArray() {\n-        List<ThreadGroup> groups = synchronizedSubgroups();\n-        return groups.toArray(new ThreadGroup[0]);\n-    }\n-\n","filename":"src\/java.base\/share\/classes\/java\/lang\/ThreadGroup.java","additions":0,"deletions":8,"binary":false,"changes":8,"status":"modified"},{"patch":"@@ -152,3 +152,0 @@\n-                } else {\n-                    \/\/ regular domain name\n-                    hoststr = toLowerCase(hoststr);\n","filename":"src\/java.base\/share\/classes\/java\/net\/HostPortrange.java","additions":0,"deletions":3,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -226,1 +226,0 @@\n- * @sealedGraph\n","filename":"src\/java.base\/share\/classes\/java\/net\/InetAddress.java","additions":0,"deletions":1,"binary":false,"changes":1,"status":"modified"},{"patch":"@@ -222,4 +222,2 @@\n- * <p> <i>Relativization<\/i>, finally, can be regarded as the inverse of resolution.\n- * Let <i>u<\/i> be any normalized absolute URI ending with a slash character ({@code '\/'})\n- * and <i>v<\/i> be any normalized relative URI not beginning with a period character ({@code '.'})\n- * or slash character ({@code '\/'}). Then, the following statement is true:\n+ * <p> <i>Relativization<\/i>, finally, is the inverse of resolution: For any\n+ * two normalized URIs <i>u<\/i> and&nbsp;<i>v<\/i>,\n@@ -228,8 +226,2 @@\n- *   <i>u<\/i>{@code .relativize(}<i>u<\/i>{@code .resolve(}<i>v<\/i>{@code )).equals(}<i>v<\/i>{@code )}\n- * <\/blockquote>\n- *\n- * Let <i>u<\/i> be any normalized absolute URI ending with a slash character ({@code '\/'})\n- * and <i>v<\/i> be any normalized absolute URI. Then, the following statement is true:\n- *\n- * <blockquote>\n- *   <i>u<\/i>{@code .resolve(}<i>u<\/i>{@code .relativize(}<i>v<\/i>{@code )).equals(}<i>v<\/i>{@code )}\n+ *   <i>u<\/i>{@code .relativize(}<i>u<\/i>{@code .resolve(}<i>v<\/i>{@code )).equals(}<i>v<\/i>{@code )}&nbsp;&nbsp;and<br>\n+ *   <i>u<\/i>{@code .resolve(}<i>u<\/i>{@code .relativize(}<i>v<\/i>{@code )).equals(}<i>v<\/i>{@code )}&nbsp;&nbsp;.<br>\n","filename":"src\/java.base\/share\/classes\/java\/net\/URI.java","additions":4,"deletions":12,"binary":false,"changes":16,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 1995, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 1995, 2021, Oracle and\/or its affiliates. All rights reserved.\n@@ -622,6 +622,4 @@\n-        final String value = getHeaderField(name);\n-        if (value != null) {\n-            try {\n-                return Integer.parseInt(value);\n-            } catch (NumberFormatException e) { }\n-        }\n+        String value = getHeaderField(name);\n+        try {\n+            return Integer.parseInt(value);\n+        } catch (Exception e) { }\n@@ -647,6 +645,4 @@\n-        final String value = getHeaderField(name);\n-        if (value != null) {\n-            try {\n-                return Long.parseLong(value);\n-            } catch (NumberFormatException e) { }\n-        }\n+        String value = getHeaderField(name);\n+        try {\n+            return Long.parseLong(value);\n+        } catch (Exception e) { }\n@@ -674,6 +670,4 @@\n-        final String value = getHeaderField(name);\n-        if (value != null) {\n-            try {\n-                return Date.parse(value);\n-            } catch (Exception e) { }\n-        }\n+        String value = getHeaderField(name);\n+        try {\n+            return Date.parse(value);\n+        } catch (Exception e) { }\n","filename":"src\/java.base\/share\/classes\/java\/net\/URLConnection.java","additions":13,"deletions":19,"binary":false,"changes":32,"status":"modified"},{"patch":"@@ -34,1 +34,0 @@\n-import java.util.Locale;\n@@ -475,1 +474,1 @@\n-        scheme = url.substring(0, delim).toLowerCase(Locale.ROOT);\n+        scheme = url.substring(0, delim).toLowerCase();\n@@ -497,1 +496,1 @@\n-        this.authority = new Authority(scheme, auth);\n+        this.authority = new Authority(scheme, auth.toLowerCase());\n","filename":"src\/java.base\/share\/classes\/java\/net\/URLPermission.java","additions":2,"deletions":3,"binary":false,"changes":5,"status":"modified"},{"patch":"@@ -193,1 +193,0 @@\n- * @sealedGraph\n","filename":"src\/java.base\/share\/classes\/java\/nio\/Buffer.java","additions":0,"deletions":1,"binary":false,"changes":1,"status":"modified"},{"patch":"@@ -383,1 +383,0 @@\n-     * @throws  NonReadableChannelException {@inheritDoc}\n@@ -399,1 +398,0 @@\n-     * @throws  NonReadableChannelException {@inheritDoc}\n@@ -415,1 +413,0 @@\n-     * @throws  NonReadableChannelException {@inheritDoc}\n@@ -432,0 +429,3 @@\n+     * @throws  NonWritableChannelException\n+     *          If this channel was not opened for writing\n+     *\n@@ -435,1 +435,0 @@\n-     * @throws  NonWritableChannelException {@inheritDoc}\n@@ -451,0 +450,3 @@\n+     * @throws  NonWritableChannelException\n+     *          If this channel was not opened for writing\n+     *\n@@ -454,1 +456,0 @@\n-     * @throws  NonWritableChannelException {@inheritDoc}\n@@ -470,0 +471,3 @@\n+     * @throws  NonWritableChannelException\n+     *          If this channel was not opened for writing\n+     *\n@@ -473,1 +477,0 @@\n-     * @throws  NonWritableChannelException {@inheritDoc}\n","filename":"src\/java.base\/share\/classes\/java\/nio\/channels\/FileChannel.java","additions":9,"deletions":6,"binary":false,"changes":15,"status":"modified"},{"patch":"@@ -67,1 +67,0 @@\n-     * @throws  NonReadableChannelException {@inheritDoc}\n@@ -87,1 +86,0 @@\n-     * @throws  NonWritableChannelException {@inheritDoc}\n","filename":"src\/java.base\/share\/classes\/java\/nio\/channels\/SeekableByteChannel.java","additions":0,"deletions":2,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -626,1 +626,0 @@\n-                return false;\n","filename":"src\/java.base\/share\/classes\/java\/security\/cert\/X509CRLSelector.java","additions":0,"deletions":1,"binary":false,"changes":1,"status":"modified"},{"patch":"@@ -177,1 +177,0 @@\n- * @sealedGraph\n","filename":"src\/java.base\/share\/classes\/java\/time\/ZoneId.java","additions":0,"deletions":1,"binary":false,"changes":1,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 1997, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 1997, 2021, Oracle and\/or its affiliates. All rights reserved.\n@@ -1717,1 +1717,0 @@\n-                        Objects.requireNonNull(action);\n@@ -3882,1 +3881,0 @@\n-                        Objects.requireNonNull(action);\n","filename":"src\/java.base\/share\/classes\/java\/util\/Collections.java","additions":1,"deletions":3,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -40,0 +40,1 @@\n+import java.net.URL;\n@@ -41,0 +42,1 @@\n+import java.security.CodeSource;\n@@ -42,0 +44,2 @@\n+import java.util.ArrayList;\n+import java.util.Collections;\n@@ -44,0 +48,1 @@\n+import java.util.NoSuchElementException;\n@@ -656,1 +661,1 @@\n-                certs = jv.getCerts(realEntry());\n+                certs = jv.getCerts(JarFile.this, realEntry());\n@@ -669,1 +674,1 @@\n-                signers = jv.getCodeSigners(realEntry());\n+                signers = jv.getCodeSigners(JarFile.this, realEntry());\n@@ -1071,0 +1076,191 @@\n+\n+    \/*\n+     * Returns a versioned {@code JarFileEntry} for the given entry,\n+     * if there is one. Otherwise returns the original entry. This\n+     * is invoked by the {@code entries2} for verifier.\n+     *\/\n+    JarEntry newEntry(JarEntry je) {\n+        if (isMultiRelease()) {\n+            return getVersionedEntry(je.getName(), je);\n+        }\n+        return je;\n+    }\n+\n+    \/*\n+     * Returns a versioned {@code JarFileEntry} for the given entry\n+     * name, if there is one. Otherwise returns a {@code JarFileEntry}\n+     * with the given name. It is invoked from JarVerifier's entries2\n+     * for {@code singers}.\n+     *\/\n+    JarEntry newEntry(String name) {\n+        if (isMultiRelease()) {\n+            JarEntry vje = getVersionedEntry(name, null);\n+            if (vje != null) {\n+                return vje;\n+            }\n+        }\n+        return new JarFileEntry(name);\n+    }\n+\n+    Enumeration<String> entryNames(CodeSource[] cs) {\n+        ensureInitialization();\n+        if (jv != null) {\n+            return jv.entryNames(this, cs);\n+        }\n+\n+        \/*\n+         * JAR file has no signed content. Is there a non-signing\n+         * code source?\n+         *\/\n+        boolean includeUnsigned = false;\n+        for (CodeSource c : cs) {\n+            if (c.getCodeSigners() == null) {\n+                includeUnsigned = true;\n+                break;\n+            }\n+        }\n+        if (includeUnsigned) {\n+            return unsignedEntryNames();\n+        } else {\n+            return Collections.emptyEnumeration();\n+        }\n+    }\n+\n+    \/**\n+     * Returns an enumeration of the zip file entries\n+     * excluding internal JAR mechanism entries and including\n+     * signed entries missing from the ZIP directory.\n+     *\/\n+    Enumeration<JarEntry> entries2() {\n+        ensureInitialization();\n+        if (jv != null) {\n+            return jv.entries2(this, JUZFA.entries(JarFile.this));\n+        }\n+\n+        \/\/ screen out entries which are never signed\n+        final var unfilteredEntries = JUZFA.entries(JarFile.this);\n+\n+        return new Enumeration<>() {\n+\n+            JarEntry entry;\n+\n+            public boolean hasMoreElements() {\n+                if (entry != null) {\n+                    return true;\n+                }\n+                while (unfilteredEntries.hasMoreElements()) {\n+                    JarEntry je = unfilteredEntries.nextElement();\n+                    if (JarVerifier.isSigningRelated(je.getName())) {\n+                        continue;\n+                    }\n+                    entry = je;\n+                    return true;\n+                }\n+                return false;\n+            }\n+\n+            public JarEntry nextElement() {\n+                if (hasMoreElements()) {\n+                    JarEntry je = entry;\n+                    entry = null;\n+                    return newEntry(je);\n+                }\n+                throw new NoSuchElementException();\n+            }\n+        };\n+    }\n+\n+    CodeSource[] getCodeSources(URL url) {\n+        ensureInitialization();\n+        if (jv != null) {\n+            return jv.getCodeSources(this, url);\n+        }\n+\n+        \/*\n+         * JAR file has no signed content. Is there a non-signing\n+         * code source?\n+         *\/\n+        Enumeration<String> unsigned = unsignedEntryNames();\n+        if (unsigned.hasMoreElements()) {\n+            return new CodeSource[]{JarVerifier.getUnsignedCS(url)};\n+        } else {\n+            return null;\n+        }\n+    }\n+\n+    private Enumeration<String> unsignedEntryNames() {\n+        final Enumeration<JarEntry> entries = entries();\n+        return new Enumeration<>() {\n+\n+            String name;\n+\n+            \/*\n+             * Grab entries from ZIP directory but screen out\n+             * metadata.\n+             *\/\n+            public boolean hasMoreElements() {\n+                if (name != null) {\n+                    return true;\n+                }\n+                while (entries.hasMoreElements()) {\n+                    String value;\n+                    ZipEntry e = entries.nextElement();\n+                    value = e.getName();\n+                    if (e.isDirectory() || JarVerifier.isSigningRelated(value)) {\n+                        continue;\n+                    }\n+                    name = value;\n+                    return true;\n+                }\n+                return false;\n+            }\n+\n+            public String nextElement() {\n+                if (hasMoreElements()) {\n+                    String value = name;\n+                    name = null;\n+                    return value;\n+                }\n+                throw new NoSuchElementException();\n+            }\n+        };\n+    }\n+\n+    CodeSource getCodeSource(URL url, String name) {\n+        ensureInitialization();\n+        if (jv != null) {\n+            if (jv.eagerValidation) {\n+                CodeSource cs;\n+                JarEntry je = getJarEntry(name);\n+                if (je != null) {\n+                    cs = jv.getCodeSource(url, this, je);\n+                } else {\n+                    cs = jv.getCodeSource(url, name);\n+                }\n+                return cs;\n+            } else {\n+                return jv.getCodeSource(url, name);\n+            }\n+        }\n+\n+        return JarVerifier.getUnsignedCS(url);\n+    }\n+\n+    void setEagerValidation(boolean eager) {\n+        try {\n+            maybeInstantiateVerifier();\n+        } catch (IOException e) {\n+            throw new RuntimeException(e);\n+        }\n+        if (jv != null) {\n+            jv.setEagerValidation(eager);\n+        }\n+    }\n+\n+    List<Object> getManifestDigests() {\n+        ensureInitialization();\n+        if (jv != null) {\n+            return jv.getManifestDigests();\n+        }\n+        return new ArrayList<>();\n+    }\n","filename":"src\/java.base\/share\/classes\/java\/util\/jar\/JarFile.java","additions":198,"deletions":2,"binary":false,"changes":200,"status":"modified"},{"patch":"@@ -29,0 +29,1 @@\n+import java.net.URL;\n@@ -30,4 +31,1 @@\n-import java.security.CodeSigner;\n-import java.security.NoSuchAlgorithmException;\n-import java.security.SignatureException;\n-import java.security.cert.Certificate;\n+import java.security.*;\n@@ -35,0 +33,1 @@\n+import java.util.zip.ZipEntry;\n@@ -91,0 +90,6 @@\n+    \/** controls eager signature validation *\/\n+    boolean eagerValidation;\n+\n+    \/** makes code source singleton instances unique to us *\/\n+    private Object csdomain = new Object();\n+\n@@ -331,1 +336,1 @@\n-     * Return an array of Certificate objects for\n+     * Return an array of java.security.cert.Certificate objects for\n@@ -333,0 +338,1 @@\n+     * @deprecated\n@@ -334,1 +340,7 @@\n-    public Certificate[] getCerts(JarEntry entry)\n+    @Deprecated\n+    public java.security.cert.Certificate[] getCerts(String name)\n+    {\n+        return mapSignersToCertArray(getCodeSigners(name));\n+    }\n+\n+    public java.security.cert.Certificate[] getCerts(JarFile jar, JarEntry entry)\n@@ -336,1 +348,1 @@\n-        return mapSignersToCertArray(getCodeSigners(entry));\n+        return mapSignersToCertArray(getCodeSigners(jar, entry));\n@@ -344,1 +356,1 @@\n-    public CodeSigner[] getCodeSigners(JarEntry entry)\n+    public CodeSigner[] getCodeSigners(String name)\n@@ -346,1 +358,23 @@\n-        return verifiedSigners.get(entry.getName());\n+        return verifiedSigners.get(name);\n+    }\n+\n+    public CodeSigner[] getCodeSigners(JarFile jar, JarEntry entry)\n+    {\n+        String name = entry.getName();\n+        if (eagerValidation && sigFileSigners.get(name) != null) {\n+            \/*\n+             * Force a read of the entry data to generate the\n+             * verification hash.\n+             *\/\n+            try {\n+                InputStream s = jar.getInputStream(entry);\n+                byte[] buffer = new byte[1024];\n+                int n = buffer.length;\n+                while (n != -1) {\n+                    n = s.read(buffer, 0, buffer.length);\n+                }\n+                s.close();\n+            } catch (IOException e) {\n+            }\n+        }\n+        return getCodeSigners(name);\n@@ -353,1 +387,1 @@\n-    private static Certificate[] mapSignersToCertArray(\n+    private static java.security.cert.Certificate[] mapSignersToCertArray(\n@@ -357,1 +391,1 @@\n-            ArrayList<Certificate> certChains = new ArrayList<>();\n+            ArrayList<java.security.cert.Certificate> certChains = new ArrayList<>();\n@@ -365,1 +399,1 @@\n-                    new Certificate[certChains.size()]);\n+                    new java.security.cert.Certificate[certChains.size()]);\n@@ -479,0 +513,363 @@\n+    \/\/ Extended JavaUtilJarAccess CodeSource API Support\n+\n+    private Map<URL, Map<CodeSigner[], CodeSource>> urlToCodeSourceMap = new HashMap<>();\n+    private Map<CodeSigner[], CodeSource> signerToCodeSource = new HashMap<>();\n+    private URL lastURL;\n+    private Map<CodeSigner[], CodeSource> lastURLMap;\n+\n+    \/*\n+     * Create a unique mapping from codeSigner cache entries to CodeSource.\n+     * In theory, multiple URLs origins could map to a single locally cached\n+     * and shared JAR file although in practice there will be a single URL in use.\n+     *\/\n+    private synchronized CodeSource mapSignersToCodeSource(URL url, CodeSigner[] signers) {\n+        Map<CodeSigner[], CodeSource> map;\n+        if (url == lastURL) {\n+            map = lastURLMap;\n+        } else {\n+            map = urlToCodeSourceMap.get(url);\n+            if (map == null) {\n+                map = new HashMap<>();\n+                urlToCodeSourceMap.put(url, map);\n+            }\n+            lastURLMap = map;\n+            lastURL = url;\n+        }\n+        CodeSource cs = map.get(signers);\n+        if (cs == null) {\n+            cs = new VerifierCodeSource(csdomain, url, signers);\n+            signerToCodeSource.put(signers, cs);\n+        }\n+        return cs;\n+    }\n+\n+    private CodeSource[] mapSignersToCodeSources(URL url, List<CodeSigner[]> signers, boolean unsigned) {\n+        List<CodeSource> sources = new ArrayList<>();\n+\n+        for (CodeSigner[] signer : signers) {\n+            sources.add(mapSignersToCodeSource(url, signer));\n+        }\n+        if (unsigned) {\n+            sources.add(mapSignersToCodeSource(url, null));\n+        }\n+        return sources.toArray(new CodeSource[sources.size()]);\n+    }\n+    private CodeSigner[] emptySigner = new CodeSigner[0];\n+\n+    \/*\n+     * Match CodeSource to a CodeSigner[] in the signer cache.\n+     *\/\n+    private CodeSigner[] findMatchingSigners(CodeSource cs) {\n+        if (cs instanceof VerifierCodeSource vcs) {\n+            if (vcs.isSameDomain(csdomain)) {\n+                return vcs.getPrivateSigners();\n+            }\n+        }\n+\n+        \/*\n+         * In practice signers should always be optimized above\n+         * but this handles a CodeSource of any type, just in case.\n+         *\/\n+        CodeSource[] sources = mapSignersToCodeSources(cs.getLocation(), getJarCodeSigners(), true);\n+        List<CodeSource> sourceList = new ArrayList<>();\n+        for (CodeSource source : sources) {\n+            sourceList.add(source);\n+        }\n+        int j = sourceList.indexOf(cs);\n+        if (j != -1) {\n+            CodeSigner[] match;\n+            match = ((VerifierCodeSource) sourceList.get(j)).getPrivateSigners();\n+            if (match == null) {\n+                match = emptySigner;\n+            }\n+            return match;\n+        }\n+        return null;\n+    }\n+\n+    \/*\n+     * Instances of this class hold uncopied references to internal\n+     * signing data that can be compared by object reference identity.\n+     *\/\n+    private static class VerifierCodeSource extends CodeSource {\n+        @java.io.Serial\n+        private static final long serialVersionUID = -9047366145967768825L;\n+\n+        URL vlocation;\n+        CodeSigner[] vsigners;\n+        java.security.cert.Certificate[] vcerts;\n+        @SuppressWarnings(\"serial\") \/\/ Not statically typed as Serializable\n+        Object csdomain;\n+\n+        VerifierCodeSource(Object csdomain, URL location, CodeSigner[] signers) {\n+            super(location, signers);\n+            this.csdomain = csdomain;\n+            vlocation = location;\n+            vsigners = signers; \/\/ from signerCache\n+        }\n+\n+        VerifierCodeSource(Object csdomain, URL location, java.security.cert.Certificate[] certs) {\n+            super(location, certs);\n+            this.csdomain = csdomain;\n+            vlocation = location;\n+            vcerts = certs; \/\/ from signerCache\n+        }\n+\n+        \/*\n+         * All VerifierCodeSource instances are constructed based on\n+         * singleton signerCache or signerCacheCert entries for each unique signer.\n+         * No CodeSigner<->Certificate[] conversion is required.\n+         * We use these assumptions to optimize equality comparisons.\n+         *\/\n+        public boolean equals(Object obj) {\n+            if (obj == this) {\n+                return true;\n+            }\n+            if (obj instanceof VerifierCodeSource that) {\n+\n+                \/*\n+                 * Only compare against other per-signer singletons constructed\n+                 * on behalf of the same JarFile instance. Otherwise, compare\n+                 * things the slower way.\n+                 *\/\n+                if (isSameDomain(that.csdomain)) {\n+                    if (that.vsigners != this.vsigners\n+                            || that.vcerts != this.vcerts) {\n+                        return false;\n+                    }\n+                    if (that.vlocation != null) {\n+                        return that.vlocation.equals(this.vlocation);\n+                    } else if (this.vlocation != null) {\n+                        return this.vlocation.equals(that.vlocation);\n+                    } else { \/\/ both null\n+                        return true;\n+                    }\n+                }\n+            }\n+            return super.equals(obj);\n+        }\n+\n+        boolean isSameDomain(Object csdomain) {\n+            return this.csdomain == csdomain;\n+        }\n+\n+        private CodeSigner[] getPrivateSigners() {\n+            return vsigners;\n+        }\n+\n+        private java.security.cert.Certificate[] getPrivateCertificates() {\n+            return vcerts;\n+        }\n+    }\n+    private Map<String, CodeSigner[]> signerMap;\n+\n+    private synchronized Map<String, CodeSigner[]> signerMap() {\n+        if (signerMap == null) {\n+            \/*\n+             * Snapshot signer state so it doesn't change on us. We care\n+             * only about the asserted signatures. Verification of\n+             * signature validity happens via the JarEntry apis.\n+             *\/\n+            signerMap = HashMap.newHashMap(verifiedSigners.size() + sigFileSigners.size());\n+            signerMap.putAll(verifiedSigners);\n+            signerMap.putAll(sigFileSigners);\n+        }\n+        return signerMap;\n+    }\n+\n+    public synchronized Enumeration<String> entryNames(JarFile jar, final CodeSource[] cs) {\n+        final Map<String, CodeSigner[]> map = signerMap();\n+        final Iterator<Map.Entry<String, CodeSigner[]>> itor = map.entrySet().iterator();\n+        boolean matchUnsigned = false;\n+\n+        \/*\n+         * Grab a single copy of the CodeSigner arrays. Check\n+         * to see if we can optimize CodeSigner equality test.\n+         *\/\n+        List<CodeSigner[]> req = new ArrayList<>(cs.length);\n+        for (CodeSource c : cs) {\n+            CodeSigner[] match = findMatchingSigners(c);\n+            if (match != null) {\n+                if (match.length > 0) {\n+                    req.add(match);\n+                } else {\n+                    matchUnsigned = true;\n+                }\n+            } else {\n+                matchUnsigned = true;\n+            }\n+        }\n+\n+        final List<CodeSigner[]> signersReq = req;\n+        final Enumeration<String> enum2 = matchUnsigned ? unsignedEntryNames(jar) : Collections.emptyEnumeration();\n+\n+        return new Enumeration<>() {\n+\n+            String name;\n+\n+            public boolean hasMoreElements() {\n+                if (name != null) {\n+                    return true;\n+                }\n+\n+                while (itor.hasNext()) {\n+                    Map.Entry<String, CodeSigner[]> e = itor.next();\n+                    if (signersReq.contains(e.getValue())) {\n+                        name = e.getKey();\n+                        return true;\n+                    }\n+                }\n+                while (enum2.hasMoreElements()) {\n+                    name = enum2.nextElement();\n+                    return true;\n+                }\n+                return false;\n+            }\n+\n+            public String nextElement() {\n+                if (hasMoreElements()) {\n+                    String value = name;\n+                    name = null;\n+                    return value;\n+                }\n+                throw new NoSuchElementException();\n+            }\n+        };\n+    }\n+\n+    \/*\n+     * Like entries() but screens out internal JAR mechanism entries\n+     * and includes signed entries with no ZIP data.\n+     *\/\n+    public Enumeration<JarEntry> entries2(final JarFile jar, Enumeration<JarEntry> e) {\n+        final Map<String, CodeSigner[]> map = new HashMap<>();\n+        map.putAll(signerMap());\n+        final Enumeration<JarEntry> enum_ = e;\n+        return new Enumeration<>() {\n+\n+            Enumeration<String> signers = null;\n+            JarEntry entry;\n+\n+            public boolean hasMoreElements() {\n+                if (entry != null) {\n+                    return true;\n+                }\n+                while (enum_.hasMoreElements()) {\n+                    JarEntry je = enum_.nextElement();\n+                    if (JarVerifier.isSigningRelated(je.getName())) {\n+                        continue;\n+                    }\n+                    entry = jar.newEntry(je);\n+                    return true;\n+                }\n+                if (signers == null) {\n+                    signers = Collections.enumeration(map.keySet());\n+                }\n+                while (signers.hasMoreElements()) {\n+                    String name = signers.nextElement();\n+                    entry = jar.newEntry(name);\n+                    return true;\n+                }\n+\n+                \/\/ Any map entries left?\n+                return false;\n+            }\n+\n+            public JarEntry nextElement() {\n+                if (hasMoreElements()) {\n+                    JarEntry je = entry;\n+                    map.remove(je.getName());\n+                    entry = null;\n+                    return je;\n+                }\n+                throw new NoSuchElementException();\n+            }\n+        };\n+    }\n+\n+    \/\/ true if file is part of the signature mechanism itself\n+    static boolean isSigningRelated(String name) {\n+        return SignatureFileVerifier.isSigningRelated(name);\n+    }\n+\n+    private Enumeration<String> unsignedEntryNames(JarFile jar) {\n+        final Map<String, CodeSigner[]> map = signerMap();\n+        final Enumeration<JarEntry> entries = jar.entries();\n+        return new Enumeration<>() {\n+\n+            String name;\n+\n+            \/*\n+             * Grab entries from ZIP directory but screen out\n+             * metadata.\n+             *\/\n+            public boolean hasMoreElements() {\n+                if (name != null) {\n+                    return true;\n+                }\n+                while (entries.hasMoreElements()) {\n+                    String value;\n+                    ZipEntry e = entries.nextElement();\n+                    value = e.getName();\n+                    if (e.isDirectory() || isSigningRelated(value)) {\n+                        continue;\n+                    }\n+                    if (map.get(value) == null) {\n+                        name = value;\n+                        return true;\n+                    }\n+                }\n+                return false;\n+            }\n+\n+            public String nextElement() {\n+                if (hasMoreElements()) {\n+                    String value = name;\n+                    name = null;\n+                    return value;\n+                }\n+                throw new NoSuchElementException();\n+            }\n+        };\n+    }\n+    private List<CodeSigner[]> jarCodeSigners;\n+\n+    private synchronized List<CodeSigner[]> getJarCodeSigners() {\n+        if (jarCodeSigners == null) {\n+            HashSet<CodeSigner[]> set = new HashSet<>();\n+            set.addAll(signerMap().values());\n+            jarCodeSigners = new ArrayList<>();\n+            jarCodeSigners.addAll(set);\n+        }\n+        return jarCodeSigners;\n+    }\n+\n+    public synchronized CodeSource[] getCodeSources(JarFile jar, URL url) {\n+        boolean hasUnsigned = unsignedEntryNames(jar).hasMoreElements();\n+\n+        return mapSignersToCodeSources(url, getJarCodeSigners(), hasUnsigned);\n+    }\n+\n+    public CodeSource getCodeSource(URL url, String name) {\n+        CodeSigner[] signers;\n+\n+        signers = signerMap().get(name);\n+        return mapSignersToCodeSource(url, signers);\n+    }\n+\n+    public CodeSource getCodeSource(URL url, JarFile jar, JarEntry je) {\n+        return mapSignersToCodeSource(url, getCodeSigners(jar, je));\n+    }\n+\n+    public void setEagerValidation(boolean eager) {\n+        eagerValidation = eager;\n+    }\n+\n+    public synchronized List<Object> getManifestDigests() {\n+        return Collections.unmodifiableList(manifestDigests);\n+    }\n+\n+    static CodeSource getUnsignedCS(URL url) {\n+        return new VerifierCodeSource(null, url, (java.security.cert.Certificate[]) null);\n+    }\n+\n","filename":"src\/java.base\/share\/classes\/java\/util\/jar\/JarVerifier.java","additions":409,"deletions":12,"binary":false,"changes":421,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2002, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2002, 2020, Oracle and\/or its affiliates. All rights reserved.\n@@ -29,0 +29,6 @@\n+import java.net.URL;\n+import java.security.CodeSource;\n+import java.util.Enumeration;\n+import java.util.List;\n+import java.util.zip.ZipEntry;\n+import java.util.zip.ZipFile;\n@@ -37,0 +43,24 @@\n+    public CodeSource[] getCodeSources(JarFile jar, URL url) {\n+        return jar.getCodeSources(url);\n+    }\n+\n+    public CodeSource getCodeSource(JarFile jar, URL url, String name) {\n+        return jar.getCodeSource(url, name);\n+    }\n+\n+    public Enumeration<String> entryNames(JarFile jar, CodeSource[] cs) {\n+        return jar.entryNames(cs);\n+    }\n+\n+    public Enumeration<JarEntry> entries2(JarFile jar) {\n+        return jar.entries2();\n+    }\n+\n+    public void setEagerValidation(JarFile jar, boolean eager) {\n+        jar.setEagerValidation(eager);\n+    }\n+\n+    public List<Object> getManifestDigests(JarFile jar) {\n+        return jar.getManifestDigests();\n+    }\n+\n","filename":"src\/java.base\/share\/classes\/java\/util\/jar\/JavaUtilJarAccessImpl.java","additions":31,"deletions":1,"binary":false,"changes":32,"status":"modified"},{"patch":"@@ -487,9 +487,3 @@\n- * <p> If {@link #MULTILINE} mode is not activated, the regular expression\n- * {@code ^} ignores line terminators and only matches at the beginning of\n- * the entire input sequence. The regular expression {@code $} matches at the\n- * end of the entire input sequence, but also matches just before the last line\n- * terminator if this is not followed by any other input character. Other line\n- * terminators are ignored, including the last one if it is followed by other\n- * input characters.\n- *\n- * <p> If {@link #MULTILINE} mode is activated then\n+ * <p> By default, the regular expressions {@code ^} and {@code $} ignore\n+ * line terminators and only match at the beginning and the end, respectively,\n+ * of the entire input sequence. If {@link #MULTILINE} mode is activated then\n","filename":"src\/java.base\/share\/classes\/java\/util\/regex\/Pattern.java","additions":3,"deletions":9,"binary":false,"changes":12,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 1996, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 1996, 2018, Oracle and\/or its affiliates. All rights reserved.\n@@ -49,1 +49,1 @@\n- * output byte array or byte buffer passed to the {@code inflate()} methods.\n+ * output byte array or byte buffer passed to the {@code deflate()} methods.\n","filename":"src\/java.base\/share\/classes\/java\/util\/zip\/Inflater.java","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -28,2 +28,0 @@\n-import java.io.EOFException;\n-import java.io.IOException;\n@@ -31,1 +29,2 @@\n-import java.io.OutputStream;\n+import java.io.IOException;\n+import java.io.EOFException;\n@@ -176,3 +175,2 @@\n-     * Returns 0 when end of stream is detected for the current ZIP entry or\n-     * {@link #closeEntry()} has been called on the current ZIP entry, otherwise\n-     * returns 1.\n+     * Returns 0 after EOF has reached for the current entry data,\n+     * otherwise always return 1.\n@@ -183,2 +181,1 @@\n-     * @return 0 when end of stream is detected for the current ZIP entry or\n-     * {@link #closeEntry()} has been called on the current ZIP entry, otherwise 1.\n+     * @return     1 before EOF and 0 after EOF has reached for current entry.\n@@ -198,173 +195,1 @@\n-     * Reads the next byte of data from the input stream for the current\n-     * ZIP entry. This method will block until enough input is available for\n-     * decompression.\n-     * @return the byte read, or -1 if the end of the stream is reached\n-     * @throws    IOException if an I\/O error has occurred\n-     *\/\n-    @Override\n-    public int read() throws IOException {\n-        return super.read();\n-    }\n-\n-    \/**\n-     * Reads all remaining bytes from the input stream for the current ZIP entry.\n-     * This method blocks until all remaining bytes have been read and end of\n-     * stream is detected, or an exception is thrown. This method does not close\n-     * the input stream.\n-     *\n-     * <p> When this stream reaches end of stream, further invocations of this\n-     * method will return an empty byte array.\n-     *\n-     * <p> Note that this method is intended for simple cases where it is\n-     * convenient to read all bytes into a byte array. It is not intended for\n-     * reading input streams with large amounts of data.\n-     *\n-     * <p> If an I\/O error occurs reading from the input stream, then it may do\n-     * so after some, but not all, bytes have been read. Consequently, the input\n-     * stream may not be at end of stream and may be in an inconsistent state.\n-     * It is strongly recommended that the stream be promptly closed if an I\/O\n-     * error occurs.\n-     *\n-     * @throws OutOfMemoryError {@inheritDoc}\n-     *\n-     * @since 9\n-     *\/\n-    @Override\n-    public byte[] readAllBytes() throws IOException {\n-        return super.readAllBytes();\n-    }\n-\n-    \/**\n-     * Reads up to a specified number of bytes from the input stream\n-     * for the current ZIP entry. This method blocks until the requested number\n-     * of bytes has been read, end of stream is detected, or an exception\n-     * is thrown. This method does not close the input stream.\n-     *\n-     * <p> The length of the returned array equals the number of bytes read\n-     * from the stream. If {@code len} is zero, then no bytes are read and\n-     * an empty byte array is returned. Otherwise, up to {@code len} bytes\n-     * are read from the stream. Fewer than {@code len} bytes may be read if\n-     * end of stream is encountered.\n-     *\n-     * <p> When this stream reaches end of stream, further invocations of this\n-     * method will return an empty byte array.\n-     *\n-     * <p> Note that this method is intended for simple cases where it is\n-     * convenient to read the specified number of bytes into a byte array. The\n-     * total amount of memory allocated by this method is proportional to the\n-     * number of bytes read from the stream which is bounded by {@code len}.\n-     * Therefore, the method may be safely called with very large values of\n-     * {@code len} provided sufficient memory is available.\n-     *\n-     * <p> If an I\/O error occurs reading from the input stream, then it may do\n-     * so after some, but not all, bytes have been read. Consequently, the input\n-     * stream may not be at end of stream and may be in an inconsistent state.\n-     * It is strongly recommended that the stream be promptly closed if an I\/O\n-     * error occurs.\n-     *\n-     * @implNote\n-     * This method calls {@code super.readNBytes(int len)}.\n-     *\n-     *  @throws OutOfMemoryError {@inheritDoc}\n-     *\n-     * @since 11\n-     *\/\n-    @Override\n-    public byte[] readNBytes(int len) throws IOException {\n-        return super.readNBytes(len);\n-    }\n-\n-    \/**\n-     * Reads the requested number of bytes from the input stream into the given\n-     * byte array for the current ZIP entry returning the number of\n-     * inflated bytes.\n-     * This method blocks until {@code len} bytes of input data have\n-     * been read, end of stream is detected, or an exception is thrown. The\n-     * number of bytes actually read, possibly zero, is returned. This method\n-     * does not close the input stream.\n-     *\n-     * <p> In the case where end of stream is reached before {@code len} bytes\n-     * have been read, then the actual number of bytes read will be returned.\n-     * When this stream reaches end of stream, further invocations of this\n-     * method will return zero.\n-     *\n-     * <p> If {@code len} is zero, then no bytes are read and {@code 0} is\n-     * returned; otherwise, there is an attempt to read up to {@code len} bytes.\n-     *\n-     * <p> The first byte read is stored into element {@code b[off]}, the next\n-     * one in to {@code b[off+1]}, and so on. The number of bytes read is, at\n-     * most, equal to {@code len}. Let <i>k<\/i> be the number of bytes actually\n-     * read; these bytes will be stored in elements {@code b[off]} through\n-     * {@code b[off+}<i>k<\/i>{@code -1]}, leaving elements {@code b[off+}<i>k<\/i>\n-     * {@code ]} through {@code b[off+len-1]} unaffected.\n-     *\n-     * <p> If an I\/O error occurs reading from the input stream, then it may do\n-     * so after some, but not all, bytes of {@code b} have been updated with\n-     * data from the input stream. Consequently, the input stream and {@code b}\n-     * may be in an inconsistent state. It is strongly recommended that the\n-     * stream be promptly closed if an I\/O error occurs.\n-     *\n-     * @throws NullPointerException {@inheritDoc}\n-     * @throws IndexOutOfBoundsException {@inheritDoc}\n-     *\n-     * @since 9\n-     *\/\n-    @Override\n-    public int readNBytes(byte[] b, int off, int len) throws IOException {\n-        return super.readNBytes(b, off, len);\n-    }\n-\n-    \/**\n-     * Skips over and discards exactly {@code n} bytes of data from this input\n-     * stream for the current ZIP entry.\n-     * If {@code n} is zero, then no bytes are skipped.\n-     * If {@code n} is negative, then no bytes are skipped.\n-     * Subclasses may handle the negative value differently.\n-     *\n-     * <p> This method blocks until the requested number of bytes has been\n-     * skipped, end of file is reached, or an exception is thrown.\n-     *\n-     * <p> If end of stream is reached before the stream is at the desired\n-     * position, then an {@code EOFException} is thrown.\n-     *\n-     * <p> If an I\/O error occurs, then the input stream may be\n-     * in an inconsistent state. It is strongly recommended that the\n-     * stream be promptly closed if an I\/O error occurs.\n-     *\n-     * @since 12\n-     *\/\n-    @Override\n-    public void skipNBytes(long n) throws IOException {\n-        super.skipNBytes(n);\n-    }\n-\n-    \/**\n-     * Reads all bytes from this input stream for the current ZIP entry\n-     * and writes the bytes to the given output stream in the order that they\n-     * are read. On return, this input stream will be at end of stream.\n-     * This method does not close either stream.\n-     * <p>\n-     * This method may block indefinitely reading from the input stream, or\n-     * writing to the output stream. The behavior for the case where the input\n-     * and\/or output stream is <i>asynchronously closed<\/i>, or the thread\n-     * interrupted during the transfer, is highly input and output stream\n-     * specific, and therefore not specified.\n-     * <p>\n-     * If an I\/O error occurs reading from the input stream or writing to the\n-     * output stream, then it may do so after some bytes have been read or\n-     * written. Consequently, the input stream may not be at end of stream and\n-     * one, or both, streams may be in an inconsistent state. It is strongly\n-     * recommended that both streams be promptly closed if an I\/O error occurs.\n-     *\n-     * @throws NullPointerException {@inheritDoc}\n-     *\n-     * @since 9\n-     *\/\n-    @Override\n-    public long transferTo(OutputStream out) throws IOException {\n-        return super.transferTo(out);\n-    }\n-\n-    \/**\n-     * Reads the requested number of bytes from the input stream into the given\n-     * byte array for the current ZIP entry returning the number of\n+     * Reads from the current ZIP entry into an array of bytes, returning the number of\n@@ -445,2 +270,1 @@\n-     * Skips over and discards {@code n} bytes of data from this input stream\n-     * for the current ZIP entry.\n+     * Skips specified number of bytes in the current ZIP entry.\n","filename":"src\/java.base\/share\/classes\/java\/util\/zip\/ZipInputStream.java","additions":7,"deletions":183,"binary":false,"changes":190,"status":"modified"},{"patch":"@@ -509,2 +509,4 @@\n-        for (Permission p : permissions) {\n-            CryptoPermission x = (CryptoPermission) p;\n+        Enumeration<Permission> e = permissions.elements();\n+\n+        while (e.hasMoreElements()) {\n+            CryptoPermission x = (CryptoPermission) e.nextElement();\n","filename":"src\/java.base\/share\/classes\/javax\/crypto\/CryptoPermission.java","additions":4,"deletions":2,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -232,1 +232,4 @@\n-        for (String alg : this.perms.keySet()) {\n+        Enumeration<String> thisKeys = this.perms.keys();\n+        while (thisKeys.hasMoreElements()) {\n+            String alg = thisKeys.nextElement();\n+\n@@ -270,1 +273,3 @@\n-        for (String alg : other.perms.keySet()) {\n+        Enumeration<String> thatKeys = other.perms.keys();\n+        while (thatKeys.hasMoreElements()) {\n+            String alg = thatKeys.nextElement();\n","filename":"src\/java.base\/share\/classes\/javax\/crypto\/CryptoPermissions.java","additions":7,"deletions":2,"binary":false,"changes":9,"status":"modified"},{"patch":"@@ -474,2 +474,7 @@\n-        for (GrantEntry ge : grantEntries) {\n-            for (CryptoPermissionEntry pe : ge.permissionEntries) {\n+        Enumeration<GrantEntry> grantEnum = grantEntries.elements();\n+        while (grantEnum.hasMoreElements()) {\n+            GrantEntry ge = grantEnum.nextElement();\n+            Enumeration<CryptoPermissionEntry> permEnum =\n+                    ge.permissionElements();\n+            while (permEnum.hasMoreElements()) {\n+                CryptoPermissionEntry pe = permEnum.nextElement();\n@@ -575,0 +580,18 @@\n+\n+        boolean remove(CryptoPermissionEntry pe)\n+        {\n+            return permissionEntries.removeElement(pe);\n+        }\n+\n+        boolean contains(CryptoPermissionEntry pe)\n+        {\n+            return permissionEntries.contains(pe);\n+        }\n+\n+        \/**\n+         * Enumerate all the permission entries in this {@code GrantEntry}.\n+         *\/\n+        Enumeration<CryptoPermissionEntry> permissionElements(){\n+            return permissionEntries.elements();\n+        }\n+\n","filename":"src\/java.base\/share\/classes\/javax\/crypto\/CryptoPolicyParser.java","additions":25,"deletions":2,"binary":false,"changes":27,"status":"modified"},{"patch":"@@ -60,6 +60,1 @@\n-    \/\/ The \"encryptionAlgorithm\" is stored in either the algid or\n-    \/\/ the params field. Precisely, if this object is created by\n-    \/\/ {@link #EncryptedPrivateKeyInfo(AlgorithmParameters, byte[])}\n-    \/\/ with an uninitialized AlgorithmParameters, the AlgorithmParameters\n-    \/\/ object is stored in the params field and algid is set to null.\n-    \/\/ In all other cases, algid is non null and params is null.\n+    \/\/ the \"encryptionAlgorithm\" field\n@@ -67,1 +62,3 @@\n-    private final AlgorithmParameters params;\n+\n+    \/\/ the algorithm name of the encrypted private key\n+    private String keyAlg;\n@@ -73,1 +70,1 @@\n-    private final byte[] encoded;\n+    private byte[] encoded;\n@@ -106,1 +103,0 @@\n-        this.params = null;\n@@ -148,1 +144,0 @@\n-        this.params = null;\n@@ -189,16 +184,1 @@\n-        AlgorithmId tmp;\n-        try {\n-            tmp = AlgorithmId.get(algParams);\n-        } catch (IllegalStateException e) {\n-            \/\/ This exception is thrown when algParams.getEncoded() fails.\n-            \/\/ While the spec of this constructor requires that\n-            \/\/ \"getEncoded should return...\", in reality people might\n-            \/\/ create with an uninitialized algParams first and only\n-            \/\/ initialize it before calling getEncoded(). Thus we support\n-            \/\/ this case as well.\n-            tmp = null;\n-        }\n-\n-        \/\/ one and only one is non null\n-        this.algid = tmp;\n-        this.params = this.algid != null ? null : algParams;\n+        this.algid = AlgorithmId.get(algParams);\n@@ -220,0 +200,1 @@\n+\n@@ -231,1 +212,1 @@\n-        return algid == null ? params.getAlgorithm() : algid.getName();\n+        return this.algid.getName();\n@@ -239,1 +220,1 @@\n-        return algid == null ? params : algid.getParameters();\n+        return this.algid.getParameters();\n@@ -274,1 +255,1 @@\n-            return pkcs8EncodingToSpec(encoded);\n+            checkPKCS8Encoding(encoded);\n@@ -281,0 +262,1 @@\n+        return new PKCS8EncodedKeySpec(encoded, keyAlg);\n@@ -291,1 +273,1 @@\n-                c = Cipher.getInstance(getAlgName());\n+                c = Cipher.getInstance(algid.getName());\n@@ -293,1 +275,1 @@\n-                c = Cipher.getInstance(getAlgName(), provider);\n+                c = Cipher.getInstance(algid.getName(), provider);\n@@ -295,1 +277,1 @@\n-            c.init(Cipher.DECRYPT_MODE, decryptKey, getAlgParameters());\n+            c.init(Cipher.DECRYPT_MODE, decryptKey, algid.getParameters());\n@@ -297,1 +279,1 @@\n-            return pkcs8EncodingToSpec(encoded);\n+            checkPKCS8Encoding(encoded);\n@@ -305,0 +287,1 @@\n+        return new PKCS8EncodedKeySpec(encoded, keyAlg);\n@@ -408,10 +391,1 @@\n-            if (algid != null) {\n-                algid.encode(tmp);\n-            } else {\n-                try {\n-                    \/\/ Let's hope params has been initialized by now.\n-                    AlgorithmId.get(params).encode(tmp);\n-                } catch (Exception e) {\n-                    throw new IOException(\"not initialized\", e);\n-                }\n-            }\n+            algid.encode(tmp);\n@@ -424,1 +398,1 @@\n-            return out.toByteArray();\n+            this.encoded = out.toByteArray();\n@@ -438,1 +412,1 @@\n-    private static PKCS8EncodedKeySpec pkcs8EncodingToSpec(byte[] encodedKey)\n+    private void checkPKCS8Encoding(byte[] encodedKey)\n@@ -449,1 +423,1 @@\n-            String keyAlg = AlgorithmId.parse(values[1]).getName();\n+            keyAlg = AlgorithmId.parse(values[1]).getName();\n@@ -451,1 +425,1 @@\n-            return new PKCS8EncodedKeySpec(encodedKey, keyAlg);\n+            break;\n","filename":"src\/java.base\/share\/classes\/javax\/crypto\/EncryptedPrivateKeyInfo.java","additions":21,"deletions":47,"binary":false,"changes":68,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2002, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2002, 2020, Oracle and\/or its affiliates. All rights reserved.\n@@ -29,0 +29,4 @@\n+import java.net.URL;\n+import java.security.CodeSource;\n+import java.util.Enumeration;\n+import java.util.List;\n@@ -36,0 +40,6 @@\n+    public CodeSource[] getCodeSources(JarFile jar, URL url);\n+    public CodeSource getCodeSource(JarFile jar, URL url, String name);\n+    public Enumeration<String> entryNames(JarFile jar, CodeSource[] cs);\n+    public Enumeration<JarEntry> entries2(JarFile jar);\n+    public void setEagerValidation(JarFile jar, boolean eager);\n+    public List<Object> getManifestDigests(JarFile jar);\n","filename":"src\/java.base\/share\/classes\/jdk\/internal\/access\/JavaUtilJarAccess.java","additions":11,"deletions":1,"binary":false,"changes":12,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2018, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2018, Oracle and\/or its affiliates. All rights reserved.\n@@ -37,1 +37,1 @@\n-import java.util.stream.LongStream;\n+import java.util.stream.IntStream;\n@@ -85,2 +85,2 @@\n-    public static void logX509ValidationEvent(long anchorCertId,\n-                                         long[] certIds) {\n+    public static void logX509ValidationEvent(int anchorCertId,\n+                                         int[] certIds) {\n@@ -88,2 +88,2 @@\n-        String codes = LongStream.of(certIds)\n-                .mapToObj(Long::toString)\n+        String codes = IntStream.of(certIds)\n+                .mapToObj(Integer::toString)\n","filename":"src\/java.base\/share\/classes\/jdk\/internal\/event\/EventHelper.java","additions":6,"deletions":6,"binary":false,"changes":12,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2018, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2018, 2021, Oracle and\/or its affiliates. All rights reserved.\n@@ -31,1 +31,0 @@\n-import java.io.File;\n@@ -44,12 +43,0 @@\n-    \/\/ Custom java.io.tmpdir via command line.\n-    private static String customTmpdir;\n-\n-    \/**\n-     * Check if warning for custom java.io.tmpdir is required.\n-     *\n-     * @return a boolean value\n-     *\/\n-    public static boolean isBadIoTmpdir() {\n-        return customTmpdir != null && !(new File(customTmpdir).isDirectory());\n-    }\n-\n@@ -111,2 +98,0 @@\n-\n-        customTmpdir = props.get(\"java.io.tmpdir\");\n","filename":"src\/java.base\/share\/classes\/jdk\/internal\/util\/SystemProps.java","additions":1,"deletions":16,"binary":false,"changes":17,"status":"modified"},{"patch":"@@ -121,1 +121,1 @@\n-\\    --disable-@files\\n\\\n+\\    -disable-@files\\n\\\n","filename":"src\/java.base\/share\/classes\/sun\/launcher\/resources\/launcher.properties","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -34,1 +34,1 @@\n-L\\u00E4dt den Java-Programmiersprachen-Agent, siehe java.lang.instrument\\n    -splash:<imagepath>\\n                  Zeigt den Startbildschirm mit einem angegebenen Bild an\\n                  Skalierte HiDPI-Bilder werden automatisch unterst\\u00FCtzt und verwendet,\\n                  falls verf\\u00FCgbar. Der nicht skalierte Bilddateiname (Beispiel: image.ext)\\n                  muss immer als Argument an die Option \"-splash\" \\u00FCbergeben werden.\\n                  Das am besten geeignete angegebene skalierte Bild wird\\n                  automatisch ausgew\\u00E4hlt.\\n                  Weitere Informationen finden Sie in der Dokumentation zur SplashScreen-API\\n    @argument files\\n                  Eine oder mehrere Argumentdateien mit Optionen\\n    --disable-@files\\n                  Verhindert die weitere Erweiterung von Argumentdateien\\n    --enable-preview\\n                  L\\u00E4sst zu, das Klassen von Vorschaufeatures dieses Release abh\\u00E4ngig sind\\nUm ein Argument f\\u00FCr eine lange Option anzugeben, k\\u00F6nnen Sie --<Name>=<Wert> oder\\n--<Name> <Wert> verwenden.\\n\n+L\\u00E4dt den Java-Programmiersprachen-Agent, siehe java.lang.instrument\\n    -splash:<imagepath>\\n                  Zeigt den Startbildschirm mit einem angegebenen Bild an\\n                  Skalierte HiDPI-Bilder werden automatisch unterst\\u00FCtzt und verwendet,\\n                  falls verf\\u00FCgbar. Der nicht skalierte Bilddateiname (Beispiel: image.ext)\\n                  muss immer als Argument an die Option \"-splash\" \\u00FCbergeben werden.\\n                  Das am besten geeignete angegebene skalierte Bild wird\\n                  automatisch ausgew\\u00E4hlt.\\n                  Weitere Informationen finden Sie in der Dokumentation zur SplashScreen-API\\n    @argument files\\n                  Eine oder mehrere Argumentdateien mit Optionen\\n    -disable-@files\\n                  Verhindert die weitere Erweiterung von Argumentdateien\\n    --enable-preview\\n                  L\\u00E4sst zu, das Klassen von Vorschaufeatures dieses Release abh\\u00E4ngig sind\\nUm ein Argument f\\u00FCr eine lange Option anzugeben, k\\u00F6nnen Sie --<Name>=<Wert> oder\\n--<Name> <Wert> verwenden.\\n\n","filename":"src\/java.base\/share\/classes\/sun\/launcher\/resources\/launcher_de.properties","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -34,1 +34,1 @@\n-           mostrar pantalla de presentaci\\u00F3n con imagen especificada\\n                  Las im\\u00E1genes a escala HiDPI est\\u00E1n soportadas y se usan autom\\u00E1ticamente\\n                  si est\\u00E1n disponibles. El nombre de archivo de la imagen sin escala, por ejemplo, image.ext,\\n                  siempre debe transmitirse como el argumento para la opci\\u00F3n -splash.\\n                  La imagen a escala m\\u00E1s adecuada que se haya proporcionado se escoger\\u00E1\\n                  autom\\u00E1ticamente.\\n                  Consulte la documentaci\\u00F3n de la API de la pantalla de presentaci\\u00F3n para obtener m\\u00E1s informaci\\u00F3n.\\n    @argument files\\n                  uno o m\\u00E1s archivos de argumentos que contienen opciones\\n    --disable-@files\\n                  evitar una mayor expansi\\u00F3n del archivo de argumentos\\nPara especificar un argumento para una opci\\u00F3n larga, puede usar --<nombre>=<valor> o\\n--<nombre> <valor>.\\n\n+           mostrar pantalla de presentaci\\u00F3n con imagen especificada\\n                  Las im\\u00E1genes a escala HiDPI est\\u00E1n soportadas y se usan autom\\u00E1ticamente\\n                  si est\\u00E1n disponibles. El nombre de archivo de la imagen sin escala, por ejemplo, image.ext,\\n                  siempre debe transmitirse como el argumento para la opci\\u00F3n -splash.\\n                  La imagen a escala m\\u00E1s adecuada que se haya proporcionado se escoger\\u00E1\\n                  autom\\u00E1ticamente.\\n                  Consulte la documentaci\\u00F3n de la API de la pantalla de presentaci\\u00F3n para obtener m\\u00E1s informaci\\u00F3n.\\n    @argument files\\n                  uno o m\\u00E1s archivos de argumentos que contienen opciones\\n    -disable-@files\\n                  evitar una mayor expansi\\u00F3n del archivo de argumentos\\nPara especificar un argumento para una opci\\u00F3n larga, puede usar --<nombre>=<valor> o\\n--<nombre> <valor>.\\n\n","filename":"src\/java.base\/share\/classes\/sun\/launcher\/resources\/launcher_es.properties","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -34,1 +34,1 @@\n-l'agent de langage de programmation, voir java.lang.instrument\\n    -splash:<imagepath>\\n                  afficher l'\\u00E9cran d'accueil avec l'image indiqu\\u00E9e\\n                  Les images redimensionn\\u00E9es HiDPI sont automatiquement prises en charge et utilis\\u00E9es\\n                  si elles sont disponibles. Le nom de fichier d'une image non redimensionn\\u00E9e, par ex. image.ext,\\n                  doit toujours \\u00EAtre transmis comme argument \\u00E0 l'option -splash.\\n                  L'image redimensionn\\u00E9e fournie la plus appropri\\u00E9e sera automatiquement\\n                  s\\u00E9lectionn\\u00E9e.\\n                  Pour plus d'informations, reportez-vous \\u00E0 la documentation relative \\u00E0 l'API SplashScreen\\n    fichiers @argument\\n                  fichiers d'arguments contenant des options\\n    --disable-@files\\n                  emp\\u00EAcher le d\\u00E9veloppement suppl\\u00E9mentaire de fichiers d'arguments\\nAfin d'indiquer un argument pour une option longue, vous pouvez utiliser --<name>=<value> ou\\n--<name> <value>.\\n\n+l'agent de langage de programmation, voir java.lang.instrument\\n    -splash:<imagepath>\\n                  afficher l'\\u00E9cran d'accueil avec l'image indiqu\\u00E9e\\n                  Les images redimensionn\\u00E9es HiDPI sont automatiquement prises en charge et utilis\\u00E9es\\n                  si elles sont disponibles. Le nom de fichier d'une image non redimensionn\\u00E9e, par ex. image.ext,\\n                  doit toujours \\u00EAtre transmis comme argument \\u00E0 l'option -splash.\\n                  L'image redimensionn\\u00E9e fournie la plus appropri\\u00E9e sera automatiquement\\n                  s\\u00E9lectionn\\u00E9e.\\n                  Pour plus d'informations, reportez-vous \\u00E0 la documentation relative \\u00E0 l'API SplashScreen\\n    fichiers @argument\\n                  fichiers d'arguments contenant des options\\n    -disable-@files\\n                  emp\\u00EAcher le d\\u00E9veloppement suppl\\u00E9mentaire de fichiers d'arguments\\nAfin d'indiquer un argument pour une option longue, vous pouvez utiliser --<name>=<value> ou\\n--<name> <value>.\\n\n","filename":"src\/java.base\/share\/classes\/sun\/launcher\/resources\/launcher_fr.properties","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -34,1 +34,1 @@\n-automaticamente\\n                  se disponibili. I nomi file delle immagini non ridimensionate, ad esempio image.ext,\\n                  devono essere sempre passati come argomenti all'opzione -splash.\\n                  Verr\\u00E0 scelta automaticamente l'immagine ridimensionata pi\\u00F9 appropriata\\n                  fornita.\\n                  Per ulteriori informazioni, vedere la documentazione relativa all'API SplashScreen\\n    @file argomenti\\n                  Uno o pi\\u00F9 file argomenti contenenti opzioni\\n    --disable-@files\\n                  Impedisce l'ulteriore espansione di file argomenti\\nPer specificare un argomento per un'opzione lunga, \\u00E8 possibile usare --<nome>=<valore> oppure\\n--<nome> <valore>.\\n\n+automaticamente\\n                  se disponibili. I nomi file delle immagini non ridimensionate, ad esempio image.ext,\\n                  devono essere sempre passati come argomenti all'opzione -splash.\\n                  Verr\\u00E0 scelta automaticamente l'immagine ridimensionata pi\\u00F9 appropriata\\n                  fornita.\\n                  Per ulteriori informazioni, vedere la documentazione relativa all'API SplashScreen\\n    @file argomenti\\n                  Uno o pi\\u00F9 file argomenti contenenti opzioni\\n    -disable-@files\\n                  Impedisce l'ulteriore espansione di file argomenti\\nPer specificare un argomento per un'opzione lunga, \\u00E8 possibile usare --<nome>=<valore> oppure\\n--<nome> <valore>.\\n\n","filename":"src\/java.base\/share\/classes\/sun\/launcher\/resources\/launcher_it.properties","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -35,1 +35,1 @@\n-(\\u53EF\\u80FD\\u306A\\u5834\\u5408)\\u3002\\u30B9\\u30B1\\u30FC\\u30EA\\u30F3\\u30B0\\u3055\\u308C\\u306A\\u3044\\u30A4\\u30E1\\u30FC\\u30B8\\u306E\\u30D5\\u30A1\\u30A4\\u30EB\\u540D(image.ext\\u306A\\u3069)\\u3092\\n                  \\u5F15\\u6570\\u3068\\u3057\\u3066-splash\\u30AA\\u30D7\\u30B7\\u30E7\\u30F3\\u306B\\u5FC5\\u305A\\u6E21\\u3059\\u5FC5\\u8981\\u304C\\u3042\\u308A\\u307E\\u3059\\u3002\\n                  \\u6307\\u5B9A\\u3055\\u308C\\u305F\\u6700\\u3082\\u9069\\u5207\\u306A\\u30B9\\u30B1\\u30FC\\u30EA\\u30F3\\u30B0\\u6E08\\u30A4\\u30E1\\u30FC\\u30B8\\u304C\\u9078\\u629E\\u3055\\u308C\\u307E\\u3059\\n                  (\\u81EA\\u52D5\\u7684)\\u3002\\n                  \\u8A73\\u7D30\\u306F\\u3001SplashScreen API\\u306E\\u30C9\\u30AD\\u30E5\\u30E1\\u30F3\\u30C8\\u3092\\u53C2\\u7167\\u3057\\u3066\\u304F\\u3060\\u3055\\u3044\\n    @argument\\u30D5\\u30A1\\u30A4\\u30EB\\n                  \\u30AA\\u30D7\\u30B7\\u30E7\\u30F3\\u3092\\u542B\\u30801\\u3064\\u4EE5\\u4E0A\\u306E\\u5F15\\u6570\\u30D5\\u30A1\\u30A4\\u30EB\\n    --disable-@files\\n                  \\u3055\\u3089\\u306A\\u308B\\u5F15\\u6570\\u30D5\\u30A1\\u30A4\\u30EB\\u62E1\\u5F35\\u3092\\u7121\\u52B9\\u306B\\u3057\\u307E\\u3059\\n    --enable-preview\\n                  \\u30AF\\u30E9\\u30B9\\u3092\\u3053\\u306E\\u30EA\\u30EA\\u30FC\\u30B9\\u306E\\u30D7\\u30EC\\u30D3\\u30E5\\u30FC\\u6A5F\\u80FD\\u306B\\u4F9D\\u5B58\\u3055\\u305B\\u308B\\u3053\\u3068\\u304C\\u3067\\u304D\\u307E\\u3059\\n\\u9577\\u3044\\u30AA\\u30D7\\u30B7\\u30E7\\u30F3\\u306E\\u5F15\\u6570\\u3092\\u6307\\u5B9A\\u3059\\u308B\\u5834\\u5408\\u3001--<name>=<value>\\u307E\\u305F\\u306F\\n--<name> <value>\\u3092\\u4F7F\\u7528\\u3067\\u304D\\u307E\\u3059\\u3002\\n\n+(\\u53EF\\u80FD\\u306A\\u5834\\u5408)\\u3002\\u30B9\\u30B1\\u30FC\\u30EA\\u30F3\\u30B0\\u3055\\u308C\\u306A\\u3044\\u30A4\\u30E1\\u30FC\\u30B8\\u306E\\u30D5\\u30A1\\u30A4\\u30EB\\u540D(image.ext\\u306A\\u3069)\\u3092\\n                  \\u5F15\\u6570\\u3068\\u3057\\u3066-splash\\u30AA\\u30D7\\u30B7\\u30E7\\u30F3\\u306B\\u5FC5\\u305A\\u6E21\\u3059\\u5FC5\\u8981\\u304C\\u3042\\u308A\\u307E\\u3059\\u3002\\n                  \\u6307\\u5B9A\\u3055\\u308C\\u305F\\u6700\\u3082\\u9069\\u5207\\u306A\\u30B9\\u30B1\\u30FC\\u30EA\\u30F3\\u30B0\\u6E08\\u30A4\\u30E1\\u30FC\\u30B8\\u304C\\u9078\\u629E\\u3055\\u308C\\u307E\\u3059\\n                  (\\u81EA\\u52D5\\u7684)\\u3002\\n                  \\u8A73\\u7D30\\u306F\\u3001SplashScreen API\\u306E\\u30C9\\u30AD\\u30E5\\u30E1\\u30F3\\u30C8\\u3092\\u53C2\\u7167\\u3057\\u3066\\u304F\\u3060\\u3055\\u3044\\n    @argument\\u30D5\\u30A1\\u30A4\\u30EB\\n                  \\u30AA\\u30D7\\u30B7\\u30E7\\u30F3\\u3092\\u542B\\u30801\\u3064\\u4EE5\\u4E0A\\u306E\\u5F15\\u6570\\u30D5\\u30A1\\u30A4\\u30EB\\n    -disable-@files\\n                  \\u3055\\u3089\\u306A\\u308B\\u5F15\\u6570\\u30D5\\u30A1\\u30A4\\u30EB\\u62E1\\u5F35\\u3092\\u7121\\u52B9\\u306B\\u3057\\u307E\\u3059\\n    --enable-preview\\n                  \\u30AF\\u30E9\\u30B9\\u3092\\u3053\\u306E\\u30EA\\u30EA\\u30FC\\u30B9\\u306E\\u30D7\\u30EC\\u30D3\\u30E5\\u30FC\\u6A5F\\u80FD\\u306B\\u4F9D\\u5B58\\u3055\\u305B\\u308B\\u3053\\u3068\\u304C\\u3067\\u304D\\u307E\\u3059\\n\\u9577\\u3044\\u30AA\\u30D7\\u30B7\\u30E7\\u30F3\\u306E\\u5F15\\u6570\\u3092\\u6307\\u5B9A\\u3059\\u308B\\u5834\\u5408\\u3001--<name>=<value>\\u307E\\u305F\\u306F\\n--<name> <value>\\u3092\\u4F7F\\u7528\\u3067\\u304D\\u307E\\u3059\\u3002\\n\n","filename":"src\/java.base\/share\/classes\/sun\/launcher\/resources\/launcher_ja.properties","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -34,1 +34,1 @@\n-\\uD45C\\uC2DC\\uD569\\uB2C8\\uB2E4.\\n    -? -h -help\\n                  \\uC624\\uB958 \\uC2A4\\uD2B8\\uB9BC\\uC5D0 \\uC774 \\uB3C4\\uC6C0\\uB9D0 \\uBA54\\uC2DC\\uC9C0\\uB97C \\uC778\\uC1C4\\uD569\\uB2C8\\uB2E4.\\n    --help        \\uCD9C\\uB825 \\uC2A4\\uD2B8\\uB9BC\\uC5D0 \\uC774 \\uB3C4\\uC6C0\\uB9D0 \\uBA54\\uC2DC\\uC9C0\\uB97C \\uC778\\uC1C4\\uD569\\uB2C8\\uB2E4.\\n    -X            \\uC624\\uB958 \\uC2A4\\uD2B8\\uB9BC\\uC5D0 \\uCD94\\uAC00 \\uC635\\uC158\\uC5D0 \\uB300\\uD55C \\uB3C4\\uC6C0\\uB9D0\\uC744 \\uC778\\uC1C4\\uD569\\uB2C8\\uB2E4.\\n    --help-extra  \\uCD9C\\uB825 \\uC2A4\\uD2B8\\uB9BC\\uC5D0 \\uCD94\\uAC00 \\uC635\\uC158\\uC5D0 \\uB300\\uD55C \\uB3C4\\uC6C0\\uB9D0\\uC744 \\uC778\\uC1C4\\uD569\\uB2C8\\uB2E4.\\n    -ea[:<\\uD328\\uD0A4\\uC9C0 \\uC774\\uB984>...|:<\\uD074\\uB798\\uC2A4 \\uC774\\uB984>]\\n    -enableassertions[:<\\uD328\\uD0A4\\uC9C0 \\uC774\\uB984>...|:<\\uD074\\uB798\\uC2A4 \\uC774\\uB984>]\\n                  \\uC138\\uBD84\\uC131\\uC774 \\uC9C0\\uC815\\uB41C \\uAC80\\uC99D\\uC744 \\uC0AC\\uC6A9\\uC73C\\uB85C \\uC124\\uC815\\uD569\\uB2C8\\uB2E4.\\n    -da[:<\\uD328\\uD0A4\\uC9C0 \\uC774\\uB984>...|:<\\uD074\\uB798\\uC2A4 \\uC774\\uB984>]\\n    -disableassertions[:<\\uD328\\uD0A4\\uC9C0 \\uC774\\uB984>...|:<\\uD074\\uB798\\uC2A4 \\uC774\\uB984>]\\n                  \\uC138\\uBD84\\uC131\\uC774 \\uC9C0\\uC815\\uB41C \\uAC80\\uC99D\\uC744 \\uC0AC\\uC6A9 \\uC548\\uD568\\uC73C\\uB85C \\uC124\\uC815\\uD569\\uB2C8\\uB2E4.\\n    -esa | -enablesystemassertions\\n                  \\uC2DC\\uC2A4\\uD15C \\uAC80\\uC99D\\uC744 \\uC0AC\\uC6A9\\uC73C\\uB85C \\uC124\\uC815\\uD569\\uB2C8\\uB2E4.\\n    -dsa | -disablesystemassertions\\n                  \\uC2DC\\uC2A4\\uD15C \\uAC80\\uC99D\\uC744 \\uC0AC\\uC6A9 \\uC548\\uD568\\uC73C\\uB85C \\uC124\\uC815\\uD569\\uB2C8\\uB2E4.\\n    -agentlib:<\\uB77C\\uC774\\uBE0C\\uB7EC\\uB9AC \\uC774\\uB984>[=<\\uC635\\uC158>]\\n                  \\uACE0\\uC720 \\uC5D0\\uC774\\uC804\\uD2B8 \\uB77C\\uC774\\uBE0C\\uB7EC\\uB9AC <\\uB77C\\uC774\\uBE0C\\uB7EC\\uB9AC \\uC774\\uB984>\\uC744 \\uB85C\\uB4DC\\uD569\\uB2C8\\uB2E4(\\uC608: -agentlib:jdwp).\\n                  -agentlib:jdwp=help\\uB3C4 \\uCC38\\uC870\\uD558\\uC2ED\\uC2DC\\uC624.\\n    -agentpath:<\\uACBD\\uB85C \\uC774\\uB984>[=<\\uC635\\uC158>]\\n                  \\uC804\\uCCB4 \\uACBD\\uB85C \\uC774\\uB984\\uC744 \\uC0AC\\uC6A9\\uD558\\uC5EC \\uACE0\\uC720 \\uC5D0\\uC774\\uC804\\uD2B8 \\uB77C\\uC774\\uBE0C\\uB7EC\\uB9AC\\uB97C \\uB85C\\uB4DC\\uD569\\uB2C8\\uB2E4.\\n    -javaagent:<jar \\uACBD\\uB85C>[=<\\uC635\\uC158>]\\n                  Java \\uD504\\uB85C\\uADF8\\uB798\\uBC0D \\uC5B8\\uC5B4 \\uC5D0\\uC774\\uC804\\uD2B8\\uB97C \\uB85C\\uB4DC\\uD569\\uB2C8\\uB2E4. java.lang.instrument\\uB97C \\uCC38\\uC870\\uD558\\uC2ED\\uC2DC\\uC624.\\n    -splash:<\\uC774\\uBBF8\\uC9C0 \\uACBD\\uB85C>\\n                  \\uC774\\uBBF8\\uC9C0\\uAC00 \\uC9C0\\uC815\\uB41C \\uC2A4\\uD50C\\uB798\\uC2DC \\uD654\\uBA74\\uC744 \\uD45C\\uC2DC\\uD569\\uB2C8\\uB2E4.\\n                  HiDPI\\uB85C \\uC870\\uC815\\uB41C \\uC774\\uBBF8\\uC9C0\\uAC00 \\uC790\\uB3D9\\uC73C\\uB85C \\uC9C0\\uC6D0\\uB418\\uACE0 \\uC0AC\\uC6A9 \\uAC00\\uB2A5\\uD55C \\uACBD\\uC6B0\\n                  \\uC0AC\\uC6A9\\uB429\\uB2C8\\uB2E4. \\uBBF8\\uC870\\uC815 \\uC774\\uBBF8\\uC9C0 \\uD30C\\uC77C \\uC774\\uB984(\\uC608: image.ext)\\uC740\\n                  \\uD56D\\uC0C1 -splash \\uC635\\uC158\\uC5D0 \\uC778\\uC218\\uB85C \\uC804\\uB2EC\\uB418\\uC5B4\\uC57C \\uD569\\uB2C8\\uB2E4.\\n                  \\uAC00\\uC7A5 \\uC801\\uC808\\uD788 \\uC870\\uC815\\uB41C \\uC774\\uBBF8\\uC9C0\\uAC00 \\uC790\\uB3D9\\uC73C\\uB85C\\n                  \\uCC44\\uD0DD\\uB429\\uB2C8\\uB2E4.\\n                  \\uC790\\uC138\\uD55C \\uB0B4\\uC6A9\\uC740 SplashScreen API \\uC124\\uBA85\\uC11C\\uB97C \\uCC38\\uC870\\uD558\\uC2ED\\uC2DC\\uC624.\\n    @\\uC778\\uC218 \\uD30C\\uC77C\\n                  --disable-@files \\uC635\\uC158\\uC774 \\uD3EC\\uD568\\uB418\\uC5B4 \\uC788\\uB294 \\uD558\\uB098 \\uC774\\uC0C1\\uC758\\n    \\uC778\\uC218 \\uD30C\\uC77C\\n                  \\uCD94\\uAC00 \\uC778\\uC218 \\uD30C\\uC77C \\uD655\\uC7A5\\uC744 \\uBC29\\uC9C0\\uD569\\uB2C8\\uB2E4.\\nlong \\uC635\\uC158\\uC5D0 \\uB300\\uD55C \\uC778\\uC218\\uB97C \\uC9C0\\uC815\\uD558\\uB824\\uBA74 --<\\uC774\\uB984>=<\\uAC12> \\uB610\\uB294\\n--<\\uC774\\uB984> <\\uAC12>\\uC744 \\uC0AC\\uC6A9\\uD560 \\uC218 \\uC788\\uC2B5\\uB2C8\\uB2E4.\\n\n+\\uD45C\\uC2DC\\uD569\\uB2C8\\uB2E4.\\n    -? -h -help\\n                  \\uC624\\uB958 \\uC2A4\\uD2B8\\uB9BC\\uC5D0 \\uC774 \\uB3C4\\uC6C0\\uB9D0 \\uBA54\\uC2DC\\uC9C0\\uB97C \\uC778\\uC1C4\\uD569\\uB2C8\\uB2E4.\\n    --help        \\uCD9C\\uB825 \\uC2A4\\uD2B8\\uB9BC\\uC5D0 \\uC774 \\uB3C4\\uC6C0\\uB9D0 \\uBA54\\uC2DC\\uC9C0\\uB97C \\uC778\\uC1C4\\uD569\\uB2C8\\uB2E4.\\n    -X            \\uC624\\uB958 \\uC2A4\\uD2B8\\uB9BC\\uC5D0 \\uCD94\\uAC00 \\uC635\\uC158\\uC5D0 \\uB300\\uD55C \\uB3C4\\uC6C0\\uB9D0\\uC744 \\uC778\\uC1C4\\uD569\\uB2C8\\uB2E4.\\n    --help-extra  \\uCD9C\\uB825 \\uC2A4\\uD2B8\\uB9BC\\uC5D0 \\uCD94\\uAC00 \\uC635\\uC158\\uC5D0 \\uB300\\uD55C \\uB3C4\\uC6C0\\uB9D0\\uC744 \\uC778\\uC1C4\\uD569\\uB2C8\\uB2E4.\\n    -ea[:<\\uD328\\uD0A4\\uC9C0 \\uC774\\uB984>...|:<\\uD074\\uB798\\uC2A4 \\uC774\\uB984>]\\n    -enableassertions[:<\\uD328\\uD0A4\\uC9C0 \\uC774\\uB984>...|:<\\uD074\\uB798\\uC2A4 \\uC774\\uB984>]\\n                  \\uC138\\uBD84\\uC131\\uC774 \\uC9C0\\uC815\\uB41C \\uAC80\\uC99D\\uC744 \\uC0AC\\uC6A9\\uC73C\\uB85C \\uC124\\uC815\\uD569\\uB2C8\\uB2E4.\\n    -da[:<\\uD328\\uD0A4\\uC9C0 \\uC774\\uB984>...|:<\\uD074\\uB798\\uC2A4 \\uC774\\uB984>]\\n    -disableassertions[:<\\uD328\\uD0A4\\uC9C0 \\uC774\\uB984>...|:<\\uD074\\uB798\\uC2A4 \\uC774\\uB984>]\\n                  \\uC138\\uBD84\\uC131\\uC774 \\uC9C0\\uC815\\uB41C \\uAC80\\uC99D\\uC744 \\uC0AC\\uC6A9 \\uC548\\uD568\\uC73C\\uB85C \\uC124\\uC815\\uD569\\uB2C8\\uB2E4.\\n    -esa | -enablesystemassertions\\n                  \\uC2DC\\uC2A4\\uD15C \\uAC80\\uC99D\\uC744 \\uC0AC\\uC6A9\\uC73C\\uB85C \\uC124\\uC815\\uD569\\uB2C8\\uB2E4.\\n    -dsa | -disablesystemassertions\\n                  \\uC2DC\\uC2A4\\uD15C \\uAC80\\uC99D\\uC744 \\uC0AC\\uC6A9 \\uC548\\uD568\\uC73C\\uB85C \\uC124\\uC815\\uD569\\uB2C8\\uB2E4.\\n    -agentlib:<\\uB77C\\uC774\\uBE0C\\uB7EC\\uB9AC \\uC774\\uB984>[=<\\uC635\\uC158>]\\n                  \\uACE0\\uC720 \\uC5D0\\uC774\\uC804\\uD2B8 \\uB77C\\uC774\\uBE0C\\uB7EC\\uB9AC <\\uB77C\\uC774\\uBE0C\\uB7EC\\uB9AC \\uC774\\uB984>\\uC744 \\uB85C\\uB4DC\\uD569\\uB2C8\\uB2E4(\\uC608: -agentlib:jdwp).\\n                  -agentlib:jdwp=help\\uB3C4 \\uCC38\\uC870\\uD558\\uC2ED\\uC2DC\\uC624.\\n    -agentpath:<\\uACBD\\uB85C \\uC774\\uB984>[=<\\uC635\\uC158>]\\n                  \\uC804\\uCCB4 \\uACBD\\uB85C \\uC774\\uB984\\uC744 \\uC0AC\\uC6A9\\uD558\\uC5EC \\uACE0\\uC720 \\uC5D0\\uC774\\uC804\\uD2B8 \\uB77C\\uC774\\uBE0C\\uB7EC\\uB9AC\\uB97C \\uB85C\\uB4DC\\uD569\\uB2C8\\uB2E4.\\n    -javaagent:<jar \\uACBD\\uB85C>[=<\\uC635\\uC158>]\\n                  Java \\uD504\\uB85C\\uADF8\\uB798\\uBC0D \\uC5B8\\uC5B4 \\uC5D0\\uC774\\uC804\\uD2B8\\uB97C \\uB85C\\uB4DC\\uD569\\uB2C8\\uB2E4. java.lang.instrument\\uB97C \\uCC38\\uC870\\uD558\\uC2ED\\uC2DC\\uC624.\\n    -splash:<\\uC774\\uBBF8\\uC9C0 \\uACBD\\uB85C>\\n                  \\uC774\\uBBF8\\uC9C0\\uAC00 \\uC9C0\\uC815\\uB41C \\uC2A4\\uD50C\\uB798\\uC2DC \\uD654\\uBA74\\uC744 \\uD45C\\uC2DC\\uD569\\uB2C8\\uB2E4.\\n                  HiDPI\\uB85C \\uC870\\uC815\\uB41C \\uC774\\uBBF8\\uC9C0\\uAC00 \\uC790\\uB3D9\\uC73C\\uB85C \\uC9C0\\uC6D0\\uB418\\uACE0 \\uC0AC\\uC6A9 \\uAC00\\uB2A5\\uD55C \\uACBD\\uC6B0\\n                  \\uC0AC\\uC6A9\\uB429\\uB2C8\\uB2E4. \\uBBF8\\uC870\\uC815 \\uC774\\uBBF8\\uC9C0 \\uD30C\\uC77C \\uC774\\uB984(\\uC608: image.ext)\\uC740\\n                  \\uD56D\\uC0C1 -splash \\uC635\\uC158\\uC5D0 \\uC778\\uC218\\uB85C \\uC804\\uB2EC\\uB418\\uC5B4\\uC57C \\uD569\\uB2C8\\uB2E4.\\n                  \\uAC00\\uC7A5 \\uC801\\uC808\\uD788 \\uC870\\uC815\\uB41C \\uC774\\uBBF8\\uC9C0\\uAC00 \\uC790\\uB3D9\\uC73C\\uB85C\\n                  \\uCC44\\uD0DD\\uB429\\uB2C8\\uB2E4.\\n                  \\uC790\\uC138\\uD55C \\uB0B4\\uC6A9\\uC740 SplashScreen API \\uC124\\uBA85\\uC11C\\uB97C \\uCC38\\uC870\\uD558\\uC2ED\\uC2DC\\uC624.\\n    @\\uC778\\uC218 \\uD30C\\uC77C\\n                  -disable-@files \\uC635\\uC158\\uC774 \\uD3EC\\uD568\\uB418\\uC5B4 \\uC788\\uB294 \\uD558\\uB098 \\uC774\\uC0C1\\uC758\\n    \\uC778\\uC218 \\uD30C\\uC77C\\n                  \\uCD94\\uAC00 \\uC778\\uC218 \\uD30C\\uC77C \\uD655\\uC7A5\\uC744 \\uBC29\\uC9C0\\uD569\\uB2C8\\uB2E4.\\nlong \\uC635\\uC158\\uC5D0 \\uB300\\uD55C \\uC778\\uC218\\uB97C \\uC9C0\\uC815\\uD558\\uB824\\uBA74 --<\\uC774\\uB984>=<\\uAC12> \\uB610\\uB294\\n--<\\uC774\\uB984> <\\uAC12>\\uC744 \\uC0AC\\uC6A9\\uD560 \\uC218 \\uC788\\uC2B5\\uB2C8\\uB2E4.\\n\n","filename":"src\/java.base\/share\/classes\/sun\/launcher\/resources\/launcher_ko.properties","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -34,1 +34,1 @@\n-a tela inicial com a imagem especificada\\n                  Imagens HiDPI dimensionadas s\\u00E3o suportadas automaticamente e utilizadas,\\n                  se dispon\\u00EDveis. O nome do arquivo de imagem n\\u00E3o dimensionada, por exemplo, image.ext,\\n                  deve ser informado sempre como argumento para a op\\u00E7\\u00E3o -splash.\\n                  A imagem dimensionada mais apropriada fornecida ser\\u00E1 selecionada\\n                  automaticamente.\\n                  Consulte a documenta\\u00E7\\u00E3o da API de Tela Inicial para obter mais informa\\u00E7\\u00F5es\\n    @arquivos de argumento\\n                  Um ou mais arquivos de argumentos que cont\\u00EAm op\\u00E7\\u00F5es\\n    --disable-@files\\n                  impede expans\\u00E3o adicional de arquivo de argumentos\\nnPara especificar um argumento para uma op\\u00E7\\u00E3o longa, voc\\u00EA pode usar --<name>=<value> ou\\n--<name> <value>.\\n\n+a tela inicial com a imagem especificada\\n                  Imagens HiDPI dimensionadas s\\u00E3o suportadas automaticamente e utilizadas,\\n                  se dispon\\u00EDveis. O nome do arquivo de imagem n\\u00E3o dimensionada, por exemplo, image.ext,\\n                  deve ser informado sempre como argumento para a op\\u00E7\\u00E3o -splash.\\n                  A imagem dimensionada mais apropriada fornecida ser\\u00E1 selecionada\\n                  automaticamente.\\n                  Consulte a documenta\\u00E7\\u00E3o da API de Tela Inicial para obter mais informa\\u00E7\\u00F5es\\n    @arquivos de argumento\\n                  Um ou mais arquivos de argumentos que cont\\u00EAm op\\u00E7\\u00F5es\\n    -disable-@files\\n                  impede expans\\u00E3o adicional de arquivo de argumentos\\nnPara especificar um argumento para uma op\\u00E7\\u00E3o longa, voc\\u00EA pode usar --<name>=<value> ou\\n--<name> <value>.\\n\n","filename":"src\/java.base\/share\/classes\/sun\/launcher\/resources\/launcher_pt_BR.properties","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -34,1 +34,1 @@\n-          tillg\\u00E4ngliga. Filnamnet p\\u00E5 den oskal\\u00E4ndrade bilden, t.ex. image.ext,\\n                  ska alltid \\u00F6verf\\u00F6ras som argument till alternativet -splash.\\n                  Den l\\u00E4mpligaste skal\\u00E4ndrade bilden v\\u00E4ljs\\n                  automatiskt.\\n                  Mer information finns i dokumentationen f\\u00F6r API:t SplashScreen\\n    @argument filer\\n                  en eller flera argumentfiler som inneh\\u00E5ller alternativ\\n    --disable-@files\\n                  f\\u00F6rhindra ytterligare ut\\u00F6kning av argumentfiler\\nOm du vill ange ett argument f\\u00F6r ett l\\u00E5ngt alternativ kan du anv\\u00E4nda --<namn>=<v\\u00E4rde> eller\\n--<namn> <v\\u00E4rde>.\\n\n+          tillg\\u00E4ngliga. Filnamnet p\\u00E5 den oskal\\u00E4ndrade bilden, t.ex. image.ext,\\n                  ska alltid \\u00F6verf\\u00F6ras som argument till alternativet -splash.\\n                  Den l\\u00E4mpligaste skal\\u00E4ndrade bilden v\\u00E4ljs\\n                  automatiskt.\\n                  Mer information finns i dokumentationen f\\u00F6r API:t SplashScreen\\n    @argument filer\\n                  en eller flera argumentfiler som inneh\\u00E5ller alternativ\\n    -disable-@files\\n                  f\\u00F6rhindra ytterligare ut\\u00F6kning av argumentfiler\\nOm du vill ange ett argument f\\u00F6r ett l\\u00E5ngt alternativ kan du anv\\u00E4nda --<namn>=<v\\u00E4rde> eller\\n--<namn> <v\\u00E4rde>.\\n\n","filename":"src\/java.base\/share\/classes\/sun\/launcher\/resources\/launcher_sv.properties","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -34,1 +34,1 @@\n-\\u6309\\u6307\\u5B9A\\u7684\\u7C92\\u5EA6\\u542F\\u7528\\u65AD\\u8A00\\n    -da[:<\\u7A0B\\u5E8F\\u5305\\u540D\\u79F0>...|:<\\u7C7B\\u540D>]\\n    -disableassertions[:<\\u7A0B\\u5E8F\\u5305\\u540D\\u79F0>...|:<\\u7C7B\\u540D>]\\n                  \\u6309\\u6307\\u5B9A\\u7684\\u7C92\\u5EA6\\u7981\\u7528\\u65AD\\u8A00\\n    -esa | -enablesystemassertions\\n                  \\u542F\\u7528\\u7CFB\\u7EDF\\u65AD\\u8A00\\n    -dsa | -disablesystemassertions\\n                  \\u7981\\u7528\\u7CFB\\u7EDF\\u65AD\\u8A00\\n    -agentlib:<\\u5E93\\u540D>[=<\\u9009\\u9879>]\\n                  \\u52A0\\u8F7D\\u672C\\u673A\\u4EE3\\u7406\\u5E93 <\\u5E93\\u540D>, \\u4F8B\\u5982 -agentlib:jdwp\\n                  \\u53E6\\u8BF7\\u53C2\\u9605 -agentlib:jdwp=help\\n    -agentpath:<\\u8DEF\\u5F84\\u540D>[=<\\u9009\\u9879>]\\n                  \\u6309\\u5B8C\\u6574\\u8DEF\\u5F84\\u540D\\u52A0\\u8F7D\\u672C\\u673A\\u4EE3\\u7406\\u5E93\\n    -javaagent:<jar \\u8DEF\\u5F84>[=<\\u9009\\u9879>]\\n                  \\u52A0\\u8F7D Java \\u7F16\\u7A0B\\u8BED\\u8A00\\u4EE3\\u7406, \\u8BF7\\u53C2\\u9605 java.lang.instrument\\n    -splash:<\\u56FE\\u50CF\\u8DEF\\u5F84>\\n                  \\u4F7F\\u7528\\u6307\\u5B9A\\u7684\\u56FE\\u50CF\\u663E\\u793A\\u542F\\u52A8\\u5C4F\\u5E55\\n                  \\u81EA\\u52A8\\u652F\\u6301\\u548C\\u4F7F\\u7528 HiDPI \\u7F29\\u653E\\u56FE\\u50CF\\n                  (\\u5982\\u679C\\u53EF\\u7528)\\u3002\\u5E94\\u59CB\\u7EC8\\u5C06\\u672A\\u7F29\\u653E\\u7684\\u56FE\\u50CF\\u6587\\u4EF6\\u540D (\\u4F8B\\u5982, image.ext)\\n                  \\u4F5C\\u4E3A\\u53C2\\u6570\\u4F20\\u9012\\u7ED9 -splash \\u9009\\u9879\\u3002\\n                  \\u5C06\\u81EA\\u52A8\\u9009\\u53D6\\u63D0\\u4F9B\\u7684\\u6700\\u5408\\u9002\\u7684\\u7F29\\u653E\\n                  \\u56FE\\u50CF\\u3002\\n                  \\u6709\\u5173\\u8BE6\\u7EC6\\u4FE1\\u606F, \\u8BF7\\u53C2\\u9605 SplashScreen API \\u6587\\u6863\\n    @argument \\u6587\\u4EF6\\n                  \\u4E00\\u4E2A\\u6216\\u591A\\u4E2A\\u5305\\u542B\\u9009\\u9879\\u7684\\u53C2\\u6570\\u6587\\u4EF6\\n    --disable-@files\\n                  \\u963B\\u6B62\\u8FDB\\u4E00\\u6B65\\u6269\\u5C55\\u53C2\\u6570\\u6587\\u4EF6\\n    --enable-preview\\n                  \\u5141\\u8BB8\\u7C7B\\u4F9D\\u8D56\\u4E8E\\u6B64\\u53D1\\u884C\\u7248\\u7684\\u9884\\u89C8\\u529F\\u80FD\\n\\u8981\\u4E3A\\u957F\\u9009\\u9879\\u6307\\u5B9A\\u53C2\\u6570, \\u53EF\\u4EE5\\u4F7F\\u7528 --<\\u540D\\u79F0>=<\\u503C> \\u6216\\n--<\\u540D\\u79F0> <\\u503C>\\u3002\\n\n+\\u6309\\u6307\\u5B9A\\u7684\\u7C92\\u5EA6\\u542F\\u7528\\u65AD\\u8A00\\n    -da[:<\\u7A0B\\u5E8F\\u5305\\u540D\\u79F0>...|:<\\u7C7B\\u540D>]\\n    -disableassertions[:<\\u7A0B\\u5E8F\\u5305\\u540D\\u79F0>...|:<\\u7C7B\\u540D>]\\n                  \\u6309\\u6307\\u5B9A\\u7684\\u7C92\\u5EA6\\u7981\\u7528\\u65AD\\u8A00\\n    -esa | -enablesystemassertions\\n                  \\u542F\\u7528\\u7CFB\\u7EDF\\u65AD\\u8A00\\n    -dsa | -disablesystemassertions\\n                  \\u7981\\u7528\\u7CFB\\u7EDF\\u65AD\\u8A00\\n    -agentlib:<\\u5E93\\u540D>[=<\\u9009\\u9879>]\\n                  \\u52A0\\u8F7D\\u672C\\u673A\\u4EE3\\u7406\\u5E93 <\\u5E93\\u540D>, \\u4F8B\\u5982 -agentlib:jdwp\\n                  \\u53E6\\u8BF7\\u53C2\\u9605 -agentlib:jdwp=help\\n    -agentpath:<\\u8DEF\\u5F84\\u540D>[=<\\u9009\\u9879>]\\n                  \\u6309\\u5B8C\\u6574\\u8DEF\\u5F84\\u540D\\u52A0\\u8F7D\\u672C\\u673A\\u4EE3\\u7406\\u5E93\\n    -javaagent:<jar \\u8DEF\\u5F84>[=<\\u9009\\u9879>]\\n                  \\u52A0\\u8F7D Java \\u7F16\\u7A0B\\u8BED\\u8A00\\u4EE3\\u7406, \\u8BF7\\u53C2\\u9605 java.lang.instrument\\n    -splash:<\\u56FE\\u50CF\\u8DEF\\u5F84>\\n                  \\u4F7F\\u7528\\u6307\\u5B9A\\u7684\\u56FE\\u50CF\\u663E\\u793A\\u542F\\u52A8\\u5C4F\\u5E55\\n                  \\u81EA\\u52A8\\u652F\\u6301\\u548C\\u4F7F\\u7528 HiDPI \\u7F29\\u653E\\u56FE\\u50CF\\n                  (\\u5982\\u679C\\u53EF\\u7528)\\u3002\\u5E94\\u59CB\\u7EC8\\u5C06\\u672A\\u7F29\\u653E\\u7684\\u56FE\\u50CF\\u6587\\u4EF6\\u540D (\\u4F8B\\u5982, image.ext)\\n                  \\u4F5C\\u4E3A\\u53C2\\u6570\\u4F20\\u9012\\u7ED9 -splash \\u9009\\u9879\\u3002\\n                  \\u5C06\\u81EA\\u52A8\\u9009\\u53D6\\u63D0\\u4F9B\\u7684\\u6700\\u5408\\u9002\\u7684\\u7F29\\u653E\\n                  \\u56FE\\u50CF\\u3002\\n                  \\u6709\\u5173\\u8BE6\\u7EC6\\u4FE1\\u606F, \\u8BF7\\u53C2\\u9605 SplashScreen API \\u6587\\u6863\\n    @argument \\u6587\\u4EF6\\n                  \\u4E00\\u4E2A\\u6216\\u591A\\u4E2A\\u5305\\u542B\\u9009\\u9879\\u7684\\u53C2\\u6570\\u6587\\u4EF6\\n    -disable-@files\\n                  \\u963B\\u6B62\\u8FDB\\u4E00\\u6B65\\u6269\\u5C55\\u53C2\\u6570\\u6587\\u4EF6\\n    --enable-preview\\n                  \\u5141\\u8BB8\\u7C7B\\u4F9D\\u8D56\\u4E8E\\u6B64\\u53D1\\u884C\\u7248\\u7684\\u9884\\u89C8\\u529F\\u80FD\\n\\u8981\\u4E3A\\u957F\\u9009\\u9879\\u6307\\u5B9A\\u53C2\\u6570, \\u53EF\\u4EE5\\u4F7F\\u7528 --<\\u540D\\u79F0>=<\\u503C> \\u6216\\n--<\\u540D\\u79F0> <\\u503C>\\u3002\\n\n","filename":"src\/java.base\/share\/classes\/sun\/launcher\/resources\/launcher_zh_CN.properties","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -34,1 +34,1 @@\n-  \\u555F\\u7528\\u7CFB\\u7D71\\u5BA3\\u544A\\n    -dsa | -disablesystemassertions\\n                  \\u505C\\u7528\\u7CFB\\u7D71\\u5BA3\\u544A\\n    -agentlib:<libname>[=<options>]\\n                  \\u8F09\\u5165\\u539F\\u751F\\u4EE3\\u7406\\u7A0B\\u5F0F\\u7A0B\\u5F0F\\u5EAB <libname>\\uFF0C\\u4F8B\\u5982 -agentlib:jdwp\\n                  \\u53E6\\u8ACB\\u53C3\\u95B1 -agentlib:jdwp=help\\n    -agentpath:<pathname>[=<options>]\\n                  \\u4F9D\\u5B8C\\u6574\\u8DEF\\u5F91\\u540D\\u7A31\\u8F09\\u5165\\u539F\\u751F\\u4EE3\\u7406\\u7A0B\\u5F0F\\u7A0B\\u5F0F\\u5EAB\\n    -javaagent:<jarpath>[=<options>]\\n                  \\u8F09\\u5165 Java \\u7A0B\\u5F0F\\u8A9E\\u8A00\\u4EE3\\u7406\\u7A0B\\u5F0F\\uFF0C\\u8ACB\\u53C3\\u95B1 java.lang.instrument\\n    -splash:<imagepath>\\n                  \\u986F\\u793A\\u542B\\u6307\\u5B9A\\u5F71\\u50CF\\u7684\\u8EDF\\u9AD4\\u8CC7\\u8A0A\\u756B\\u9762\\n                  \\u7CFB\\u7D71\\u6703\\u81EA\\u52D5\\u652F\\u63F4\\u4E26\\u4F7F\\u7528 HiDPI \\u7E2E\\u653E\\u7684\\u5F71\\u50CF\\n                  (\\u82E5\\u6709\\u7684\\u8A71)\\u3002\\u672A\\u7E2E\\u653E\\u5F71\\u50CF\\u6A94\\u6848\\u540D\\u7A31 (\\u4F8B\\u5982 image.ext)\\n                  \\u61C9\\u4E00\\u5F8B\\u4EE5\\u5F15\\u6578\\u7684\\u5F62\\u5F0F\\u50B3\\u9001\\u7D66 -splash \\u9078\\u9805\\u3002\\n                  \\u7CFB\\u7D71\\u5C07\\u6703\\u81EA\\u52D5\\u9078\\u64C7\\u4F7F\\u7528\\u6700\\u9069\\u5408\\u7684\\u7E2E\\u653E\\u5F71\\u50CF\\n                  \\u3002\\n                  \\u8ACB\\u53C3\\u95B1 SplashScreen API \\u6587\\u4EF6\\u77AD\\u89E3\\u8A73\\u7D30\\u8CC7\\u8A0A\\u3002\\n    @argument files\\n                  \\u4E00\\u6216\\u591A\\u500B\\u5305\\u542B\\u9078\\u9805\\u7684\\u5F15\\u6578\\u6A94\\u6848\\n    --disable-@files\\n                  \\u505C\\u7528\\u9032\\u4E00\\u6B65\\u7684\\u5F15\\u6578\\u6A94\\u6848\\u64F4\\u5145\\n\\u82E5\\u8981\\u6307\\u5B9A\\u9577\\u9078\\u9805\\u7684\\u5F15\\u6578\\uFF0C\\u53EF\\u4EE5\\u4F7F\\u7528 --<name>=<value> \\u6216\\n--<name> <value>\\u3002\\n\n+  \\u555F\\u7528\\u7CFB\\u7D71\\u5BA3\\u544A\\n    -dsa | -disablesystemassertions\\n                  \\u505C\\u7528\\u7CFB\\u7D71\\u5BA3\\u544A\\n    -agentlib:<libname>[=<options>]\\n                  \\u8F09\\u5165\\u539F\\u751F\\u4EE3\\u7406\\u7A0B\\u5F0F\\u7A0B\\u5F0F\\u5EAB <libname>\\uFF0C\\u4F8B\\u5982 -agentlib:jdwp\\n                  \\u53E6\\u8ACB\\u53C3\\u95B1 -agentlib:jdwp=help\\n    -agentpath:<pathname>[=<options>]\\n                  \\u4F9D\\u5B8C\\u6574\\u8DEF\\u5F91\\u540D\\u7A31\\u8F09\\u5165\\u539F\\u751F\\u4EE3\\u7406\\u7A0B\\u5F0F\\u7A0B\\u5F0F\\u5EAB\\n    -javaagent:<jarpath>[=<options>]\\n                  \\u8F09\\u5165 Java \\u7A0B\\u5F0F\\u8A9E\\u8A00\\u4EE3\\u7406\\u7A0B\\u5F0F\\uFF0C\\u8ACB\\u53C3\\u95B1 java.lang.instrument\\n    -splash:<imagepath>\\n                  \\u986F\\u793A\\u542B\\u6307\\u5B9A\\u5F71\\u50CF\\u7684\\u8EDF\\u9AD4\\u8CC7\\u8A0A\\u756B\\u9762\\n                  \\u7CFB\\u7D71\\u6703\\u81EA\\u52D5\\u652F\\u63F4\\u4E26\\u4F7F\\u7528 HiDPI \\u7E2E\\u653E\\u7684\\u5F71\\u50CF\\n                  (\\u82E5\\u6709\\u7684\\u8A71)\\u3002\\u672A\\u7E2E\\u653E\\u5F71\\u50CF\\u6A94\\u6848\\u540D\\u7A31 (\\u4F8B\\u5982 image.ext)\\n                  \\u61C9\\u4E00\\u5F8B\\u4EE5\\u5F15\\u6578\\u7684\\u5F62\\u5F0F\\u50B3\\u9001\\u7D66 -splash \\u9078\\u9805\\u3002\\n                  \\u7CFB\\u7D71\\u5C07\\u6703\\u81EA\\u52D5\\u9078\\u64C7\\u4F7F\\u7528\\u6700\\u9069\\u5408\\u7684\\u7E2E\\u653E\\u5F71\\u50CF\\n                  \\u3002\\n                  \\u8ACB\\u53C3\\u95B1 SplashScreen API \\u6587\\u4EF6\\u77AD\\u89E3\\u8A73\\u7D30\\u8CC7\\u8A0A\\u3002\\n    @argument files\\n                  \\u4E00\\u6216\\u591A\\u500B\\u5305\\u542B\\u9078\\u9805\\u7684\\u5F15\\u6578\\u6A94\\u6848\\n    -disable-@files\\n                  \\u505C\\u7528\\u9032\\u4E00\\u6B65\\u7684\\u5F15\\u6578\\u6A94\\u6848\\u64F4\\u5145\\n\\u82E5\\u8981\\u6307\\u5B9A\\u9577\\u9078\\u9805\\u7684\\u5F15\\u6578\\uFF0C\\u53EF\\u4EE5\\u4F7F\\u7528 --<name>=<value> \\u6216\\n--<name> <value>\\u3002\\n\n","filename":"src\/java.base\/share\/classes\/sun\/launcher\/resources\/launcher_zh_TW.properties","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -1935,6 +1935,3 @@\n-                final String contentLengthVal = responses.findValue(\"content-length\");\n-                if (contentLengthVal != null) {\n-                    try {\n-                        cl = Long.parseLong(contentLengthVal);\n-                    } catch (NumberFormatException nfe) { }\n-                }\n+                try {\n+                    cl = Long.parseLong(responses.findValue(\"content-length\"));\n+                } catch (Exception exc) { };\n","filename":"src\/java.base\/share\/classes\/sun\/net\/www\/protocol\/http\/HttpURLConnection.java","additions":3,"deletions":6,"binary":false,"changes":9,"status":"modified"},{"patch":"@@ -113,1 +113,0 @@\n-            long certifcateId = Integer.toUnsignedLong(hashCode);\n@@ -124,1 +123,1 @@\n-                xce.certificateId = certifcateId;\n+                xce.certificateId = hashCode;\n@@ -136,1 +135,1 @@\n-                        certifcateId,\n+                        hashCode,\n","filename":"src\/java.base\/share\/classes\/sun\/security\/jca\/JCAUtil.java","additions":2,"deletions":3,"binary":false,"changes":5,"status":"modified"},{"patch":"@@ -785,1 +785,1 @@\n-            digAlgID.encode(derAlgs);\n+            digAlgID.derEncode(derAlgs);\n@@ -787,1 +787,1 @@\n-            sigAlgID.encode(derSigAlg);\n+            sigAlgID.derEncode(derSigAlg);\n","filename":"src\/java.base\/share\/classes\/sun\/security\/pkcs\/PKCS7.java","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -381,6 +381,0 @@\n-        if (clazz == null) {\n-            throw new IllegalArgumentException(\n-                    \"No value class supported \" +\n-                            \" for attribute \" + oid +\n-                            \" constructing PKCS9Attribute\");\n-        }\n@@ -533,1 +527,1 @@\n-    public void encode(DerOutputStream out) throws IOException {\n+    public void derEncode(DerOutputStream out) throws IOException {\n@@ -606,1 +600,1 @@\n-            throw new IllegalArgumentException(\"PKCS9 extended-certificate \" +\n+            throw new IOException(\"PKCS9 extended-certificate \" +\n@@ -610,1 +604,1 @@\n-            throw new IllegalArgumentException(\"PKCS9 IssuerAndSerialNumber \" +\n+            throw new IOException(\"PKCS9 IssuerAndSerialNumber \" +\n@@ -615,1 +609,1 @@\n-            throw new IllegalArgumentException(\"PKCS9 RSA DSI attributes \" +\n+            throw new IOException(\"PKCS9 RSA DSI attributes \" +\n@@ -619,1 +613,1 @@\n-            throw new IllegalArgumentException(\"PKCS9 attribute #13 not supported.\");\n+            throw new IOException(\"PKCS9 attribute #13 not supported.\");\n@@ -631,1 +625,1 @@\n-            throw new IllegalArgumentException(\"PKCS9 attribute #15 not supported.\");\n+            throw new IOException(\"PKCS9 attribute #15 not supported.\");\n@@ -635,7 +629,4 @@\n-            {\n-                DerOutputStream temp2 = new DerOutputStream();\n-                SigningCertificateInfo info = (SigningCertificateInfo)value;\n-                temp2.writeBytes(info.toByteArray());\n-                temp.write(DerValue.tag_Set, temp2.toByteArray());\n-            }\n-            break;\n+            throw new IOException(\n+                \"PKCS9 SigningCertificate attribute not supported.\");\n+            \/\/ break unnecessary\n+\n","filename":"src\/java.base\/share\/classes\/sun\/security\/pkcs\/PKCS9Attribute.java","additions":10,"deletions":19,"binary":false,"changes":29,"status":"modified"},{"patch":"@@ -211,0 +211,5 @@\n+    public void encode(DerOutputStream out) throws IOException {\n+\n+        derEncode(out);\n+    }\n+\n@@ -220,2 +225,1 @@\n-    @Override\n-    public void encode(DerOutputStream out) throws IOException {\n+    public void derEncode(DerOutputStream out) throws IOException {\n","filename":"src\/java.base\/share\/classes\/sun\/security\/pkcs\/SignerInfo.java","additions":6,"deletions":2,"binary":false,"changes":8,"status":"modified"},{"patch":"@@ -82,1 +82,1 @@\n-class SigningCertificateInfo {\n+public class SigningCertificateInfo {\n@@ -84,1 +84,0 @@\n-    private byte[] ber;\n@@ -87,1 +86,1 @@\n-    SigningCertificateInfo(byte[] ber) throws IOException {\n+    public SigningCertificateInfo(byte[] ber) throws IOException {\n@@ -89,1 +88,0 @@\n-        this.ber = ber;\n@@ -92,5 +90,0 @@\n-    byte[] toByteArray() {\n-        return ber;\n-    }\n-\n-    @Override\n@@ -109,1 +102,1 @@\n-    private void parse(byte[] bytes) throws IOException {\n+    public void parse(byte[] bytes) throws IOException {\n@@ -132,0 +125,1 @@\n+}\n@@ -133,1 +127,1 @@\n-    static class ESSCertId {\n+class ESSCertId {\n@@ -135,1 +129,1 @@\n-        private static volatile HexDumpEncoder hexDumper;\n+    private static volatile HexDumpEncoder hexDumper;\n@@ -137,3 +131,3 @@\n-        private final byte[] certHash;\n-        private final GeneralNames issuer;\n-        private final SerialNumber serialNumber;\n+    private final byte[] certHash;\n+    private final GeneralNames issuer;\n+    private final SerialNumber serialNumber;\n@@ -141,3 +135,3 @@\n-        ESSCertId(DerValue certId) throws IOException {\n-            \/\/ Parse certHash\n-            certHash = certId.data.getDerValue().toByteArray();\n+    ESSCertId(DerValue certId) throws IOException {\n+        \/\/ Parse certHash\n+        certHash = certId.data.getDerValue().toByteArray();\n@@ -145,11 +139,10 @@\n-            \/\/ Parse issuerSerial, if present\n-            if (certId.data.available() > 0) {\n-                DerValue issuerSerial = certId.data.getDerValue();\n-                \/\/ Parse issuer\n-                issuer = new GeneralNames(issuerSerial.data.getDerValue());\n-                \/\/ Parse serialNumber\n-                serialNumber = new SerialNumber(issuerSerial.data.getDerValue());\n-            } else {\n-                issuer = null;\n-                serialNumber = null;\n-            }\n+        \/\/ Parse issuerSerial, if present\n+        if (certId.data.available() > 0) {\n+            DerValue issuerSerial = certId.data.getDerValue();\n+            \/\/ Parse issuer\n+            issuer = new GeneralNames(issuerSerial.data.getDerValue());\n+            \/\/ Parse serialNumber\n+            serialNumber = new SerialNumber(issuerSerial.data.getDerValue());\n+        } else {\n+            issuer = null;\n+            serialNumber = null;\n@@ -157,0 +150,1 @@\n+    }\n@@ -158,14 +152,5 @@\n-        @Override\n-        public String toString() {\n-            StringBuilder sb = new StringBuilder();\n-            sb.append(\"[\\n\\tCertificate hash (SHA-1):\\n\");\n-            if (hexDumper == null) {\n-                hexDumper = new HexDumpEncoder();\n-            }\n-            sb.append(hexDumper.encode(certHash));\n-            if (issuer != null && serialNumber != null) {\n-                sb.append(\"\\n\\tIssuer: \" + issuer + \"\\n\");\n-                sb.append(\"\\t\" + serialNumber);\n-            }\n-            sb.append(\"\\n]\");\n-            return sb.toString();\n+    public String toString() {\n+        StringBuilder sb = new StringBuilder();\n+        sb.append(\"[\\n\\tCertificate hash (SHA-1):\\n\");\n+        if (hexDumper == null) {\n+            hexDumper = new HexDumpEncoder();\n@@ -173,0 +158,7 @@\n+        sb.append(hexDumper.encode(certHash));\n+        if (issuer != null && serialNumber != null) {\n+            sb.append(\"\\n\\tIssuer: \" + issuer + \"\\n\");\n+            sb.append(\"\\t\" + serialNumber);\n+        }\n+        sb.append(\"\\n]\");\n+        return sb.toString();\n","filename":"src\/java.base\/share\/classes\/sun\/security\/pkcs\/SigningCertificateInfo.java","additions":35,"deletions":43,"binary":false,"changes":78,"status":"modified"},{"patch":"@@ -110,2 +110,1 @@\n-    @Override\n-    public void encode(DerOutputStream out) throws IOException {\n+    public void derEncode(DerOutputStream out) throws IOException {\n@@ -113,1 +112,1 @@\n-        attr.encode(out);\n+        attr.derEncode(out);\n","filename":"src\/java.base\/share\/classes\/sun\/security\/pkcs10\/PKCS10Attribute.java","additions":2,"deletions":3,"binary":false,"changes":5,"status":"modified"},{"patch":"@@ -92,1 +92,0 @@\n-     * Implements the {@code DerEncoder} interface.\n@@ -97,1 +96,0 @@\n-    @Override\n@@ -99,0 +97,11 @@\n+        derEncode(out);\n+    }\n+\n+    \/**\n+     * Encode the attributes in DER form to the stream.\n+     * Implements the {@code DerEncoder} interface.\n+     *\n+     * @param out the OutputStream to marshal the contents to.\n+     * @exception IOException on encoding errors.\n+     *\/\n+    public void derEncode(DerOutputStream out) throws IOException {\n","filename":"src\/java.base\/share\/classes\/sun\/security\/pkcs10\/PKCS10Attributes.java","additions":11,"deletions":2,"binary":false,"changes":13,"status":"modified"},{"patch":"@@ -119,0 +119,30 @@\n+    MacData(AlgorithmParameters algParams, byte[] digest,\n+        byte[] salt, int iterations) throws NoSuchAlgorithmException\n+    {\n+        if (algParams == null)\n+           throw new NullPointerException(\"the algParams parameter \" +\n+                                               \"must be non-null\");\n+\n+        AlgorithmId algid = AlgorithmId.get(algParams);\n+        this.digestAlgorithmName = algid.getName();\n+        this.digestAlgorithmParams = algid.getParameters();\n+\n+        if (digest == null) {\n+            throw new NullPointerException(\"the digest \" +\n+                                           \"parameter must be non-null\");\n+        } else if (digest.length == 0) {\n+            throw new IllegalArgumentException(\"the digest \" +\n+                                                \"parameter must not be empty\");\n+        } else {\n+            this.digest = digest.clone();\n+        }\n+\n+        this.macSalt = salt;\n+        this.iterations = iterations;\n+\n+        \/\/ delay the generation of ASN.1 encoding until\n+        \/\/ getEncoded() is called\n+        this.encoded = null;\n+\n+    }\n+\n","filename":"src\/java.base\/share\/classes\/sun\/security\/pkcs12\/MacData.java","additions":30,"deletions":0,"binary":false,"changes":30,"status":"modified"},{"patch":"@@ -198,2 +198,1 @@\n-            \/\/           = z xor (x and (y xor z));\n-            int ch_efg = g ^ (e & (f ^ g));\n+            int ch_efg = (e & f) ^ ((~e) & g);\n@@ -202,2 +201,1 @@\n-            \/\/            = (x and y) xor ((x xor y) and z)\n-            int maj_abc = (a & b) ^ ((a ^ b) & c);\n+            int maj_abc = (a & b) ^ (a & c) ^ (b & c);\n","filename":"src\/java.base\/share\/classes\/sun\/security\/provider\/SHA2.java","additions":2,"deletions":4,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2000, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2000, 2021, Oracle and\/or its affiliates. All rights reserved.\n@@ -230,1 +230,1 @@\n-            long[] certIds = params.certificates().stream()\n+            int[] certIds = params.certificates().stream()\n@@ -232,1 +232,0 @@\n-                    .mapToLong(Integer::toUnsignedLong)\n@@ -234,1 +233,1 @@\n-            int hash = (anchorCert != null) ?\n+            int anchorCertId = (anchorCert != null) ?\n@@ -236,1 +235,0 @@\n-            long anchorCertId = Integer.toUnsignedLong(hash);\n@@ -244,1 +242,1 @@\n-                for (long id : certIds) {\n+                for (int id : certIds) {\n@@ -248,0 +246,1 @@\n+\n","filename":"src\/java.base\/share\/classes\/sun\/security\/provider\/certpath\/PKIXCertPathValidator.java","additions":5,"deletions":6,"binary":false,"changes":11,"status":"modified"},{"patch":"@@ -242,1 +242,1 @@\n-            mdAlgId.encode(tmp2);\n+            mdAlgId.derEncode(tmp2);\n","filename":"src\/java.base\/share\/classes\/sun\/security\/rsa\/PSSParameters.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -1149,1 +1149,1 @@\n-            int hash = 0;\n+            int peerCertificateId = 0;\n@@ -1152,1 +1152,1 @@\n-                hash = session\n+                peerCertificateId = session\n@@ -1158,1 +1158,0 @@\n-            long peerCertificateId = Integer.toUnsignedLong(hash);\n","filename":"src\/java.base\/share\/classes\/sun\/security\/ssl\/Finished.java","additions":2,"deletions":3,"binary":false,"changes":5,"status":"modified"},{"patch":"@@ -338,0 +338,1 @@\n+            cert = new X509CertImpl(info);\n@@ -340,1 +341,1 @@\n-                cert = X509CertImpl.newSigned(info, signerPrivateKey, sigAlg);\n+                cert.sign(signerPrivateKey, sigAlg);\n@@ -342,1 +343,1 @@\n-                cert = X509CertImpl.newSigned(info, privateKey, sigAlg);\n+                cert.sign(privateKey, sigAlg);\n","filename":"src\/java.base\/share\/classes\/sun\/security\/tools\/keytool\/CertAndKeyGen.java","additions":3,"deletions":2,"binary":false,"changes":5,"status":"modified"},{"patch":"@@ -1539,2 +1539,2 @@\n-        X509CertImpl cert = X509CertImpl\n-                .newSigned(info, privateKey, sigAlgName);\n+        X509CertImpl cert = new X509CertImpl(info);\n+        cert.sign(privateKey, sigAlgName);\n@@ -1585,5 +1585,1 @@\n-                int code = Integer.parseInt(id.substring(d+1));\n-                if (code <= 0) {\n-                    throw new Exception(\"Reason code must be positive\");\n-                }\n-                ext.setExtension(\"Reason\", new CRLReasonCodeExtension(code));\n+                ext.setExtension(\"Reason\", new CRLReasonCodeExtension(Integer.parseInt(id.substring(d+1))));\n@@ -1596,3 +1592,2 @@\n-        X509CRLImpl crl = X509CRLImpl.newSigned(\n-                new X509CRLImpl.TBSCertList(owner, firstDate, lastDate, badCerts),\n-                privateKey, sigAlgName);\n+        X509CRLImpl crl = new X509CRLImpl(owner, firstDate, lastDate, badCerts);\n+        crl.sign(privateKey, sigAlgName);\n@@ -3236,2 +3231,2 @@\n-        X509CertImpl newCert = X509CertImpl.newSigned(\n-                certInfo, privKey, sigAlgName);\n+        X509CertImpl newCert = new X509CertImpl(certInfo);\n+        newCert.sign(privKey, sigAlgName);\n@@ -4639,3 +4634,0 @@\n-                if (exttype != -1 && value != null && value.isEmpty()) {\n-                    throw new Exception(rb.getString(\"Illegal.value.\") + extstr);\n-                }\n","filename":"src\/java.base\/share\/classes\/sun\/security\/tools\/keytool\/Main.java","additions":7,"deletions":15,"binary":false,"changes":22,"status":"modified"},{"patch":"@@ -43,1 +43,1 @@\n-    void encode(DerOutputStream out)\n+    void derEncode(DerOutputStream out)\n","filename":"src\/java.base\/share\/classes\/sun\/security\/util\/DerEncoder.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -407,1 +407,1 @@\n-            set[i].encode(streams[i]);\n+            set[i].derEncode(streams[i]);\n@@ -585,2 +585,1 @@\n-    @Override\n-    public void encode(DerOutputStream out) throws IOException {\n+    public void derEncode(DerOutputStream out) throws IOException {\n@@ -596,1 +595,1 @@\n-        encoder.encode(this);\n+        encoder.derEncode(this);\n","filename":"src\/java.base\/share\/classes\/sun\/security\/util\/DerOutputStream.java","additions":3,"deletions":4,"binary":false,"changes":7,"status":"modified"},{"patch":"@@ -28,3 +28,0 @@\n-import sun.security.util.math.intpoly.IntegerPolynomialP256;\n-import sun.security.util.math.intpoly.P256OrderField;\n-\n@@ -156,5 +153,0 @@\n-    \/**\n-     * Break encapsulation, used for IntrinsicCandidate functions\n-     *\/\n-    long[] getLimbs();\n-\n@@ -174,1 +166,1 @@\n-        return MultiplicativeInverser.of(getField().getSize()).inverse(this);\n+        return pow(getField().getSize().subtract(BigInteger.valueOf(2)));\n@@ -219,197 +211,0 @@\n-    sealed interface MultiplicativeInverser {\n-        static MultiplicativeInverser of(BigInteger m) {\n-            if (m.equals(IntegerPolynomialP256.MODULUS)) {\n-                return Secp256R1.instance;\n-            } else if (m.equals(P256OrderField.MODULUS)) {\n-                return Secp256R1Field.instance;\n-            } else {\n-                return new Default(m);\n-            }\n-        }\n-\n-        \/**\n-         * Compute the multiplicative inverse of {@code imp}.\n-         *\n-         * @return the multiplicative inverse (1 \/ imp)\n-         *\/\n-        ImmutableIntegerModuloP inverse(IntegerModuloP imp);\n-\n-        final class Default implements MultiplicativeInverser {\n-            private final BigInteger b;\n-\n-            Default(BigInteger b) {\n-                this.b = b.subtract(BigInteger.TWO);\n-            }\n-\n-            @Override\n-            public ImmutableIntegerModuloP inverse(IntegerModuloP imp) {\n-                MutableIntegerModuloP y = imp.getField().get1().mutable();\n-                MutableIntegerModuloP x = imp.mutable();\n-                int bitLength = b.bitLength();\n-                for (int bit = 0; bit < bitLength; bit++) {\n-                    if (b.testBit(bit)) {\n-                        \/\/ odd\n-                        y.setProduct(x);\n-                    }\n-                    x.setSquare();\n-                }\n-\n-                return y.fixed();\n-            }\n-        }\n-\n-        final class Secp256R1 implements MultiplicativeInverser {\n-            private static final Secp256R1 instance = new Secp256R1();\n-\n-            @Override\n-            public ImmutableIntegerModuloP inverse(IntegerModuloP imp) {\n-                \/\/ Invert imp with a modular exponentiation: the modulus is\n-                \/\/     p = FFFFFFFF 00000001 00000000 00000000\n-                \/\/         00000000 FFFFFFFF FFFFFFFF FFFFFFFF\n-                \/\/ and the exponent is (p -2).\n-                \/\/  p -2 = FFFFFFFF 00000001 00000000 00000000\n-                \/\/         00000000 FFFFFFFF FFFFFFFF FFFFFFFD\n-                \/\/\n-                \/\/ There are 3 contiguous 32-bit set, and 1 contiguous 30-bit\n-                \/\/ set. Thus values imp^(2^32 - 1) and imp^(2^30 - 1) are\n-                \/\/ pre-computed to speed up the computation.\n-\n-                \/\/ calculate imp ^ (2^32 - 1)\n-                MutableIntegerModuloP t = imp.mutable();\n-                MutableIntegerModuloP v = null;\n-                MutableIntegerModuloP w = null;\n-                for (int i = 0; i < 31; i++) {\n-                    t.setSquare();\n-                    switch (i) {\n-                        case 0 -> {\n-                            t.setProduct(imp);\n-                            v = t.mutable();    \/\/ 2: imp ^ (2^2 - 1)\n-                        }\n-                        case 4 -> {\n-                            t.setProduct(v);\n-                            w = t.mutable();    \/\/ 4: imp ^ (2^6 - 1)\n-                        }\n-                        case 12, 28 -> {\n-                            t.setProduct(w);\n-                            w = t.mutable();    \/\/ 12: imp ^ (2^14 - 1)\n-                                                \/\/ 28: imp ^ (2^30 - 1)\n-                        }\n-                        case 2, 6, 14, 30 -> {\n-                            t.setProduct(v);\n-                        }\n-                    }\n-                }\n-\n-                \/\/ here we have:\n-                \/\/     v = imp ^ (2^2 - 1)\n-                \/\/     w = imp ^ (2^30 - 1)\n-                \/\/     t = imp ^ (2^32 - 1)\n-\n-                \/\/ calculate (1 \/ imp)\n-                MutableIntegerModuloP d = t.mutable();\n-                for (int i = 32; i < 256; i++) {\n-                    d.setSquare();\n-                    switch (i) {\n-                        \/\/ For contiguous 32-bit set.\n-                        case 191, 223 -> {\n-                            d.setProduct(t);\n-                        }\n-                        \/\/ For contiguous 30-bit set.\n-                        case 253 -> {\n-                            d.setProduct(w);\n-                        }\n-                        \/\/ For individual 1-bit set.\n-                        case 63, 255 -> {\n-                            d.setProduct(imp);\n-                        }\n-                    }\n-                }\n-\n-                return d.fixed();\n-            }\n-        }\n-\n-        final class Secp256R1Field implements MultiplicativeInverser {\n-            private static final Secp256R1Field instance = new Secp256R1Field();\n-            private static final BigInteger b =\n-                    P256OrderField.MODULUS.subtract(BigInteger.TWO);\n-            @Override\n-            public ImmutableIntegerModuloP inverse(IntegerModuloP imp) {\n-                \/\/ Invert imp with a modular exponentiation: the modulus is\n-                \/\/     n = FFFFFFFF 00000000 FFFFFFFF FFFFFFFF\n-                \/\/         BCE6FAAD A7179E84 F3B9CAC2 FC632551\n-                \/\/ and the exponent is (n -2).\n-                \/\/  n - 2 = FFFFFFFF 00000000 FFFFFFFF FFFFFFFF\n-                \/\/          BCE6FAAD A7179E84 F3B9CAC2 FC63254F\n-                \/\/\n-                \/\/ There are 3 contiguous 32-bit set, and imp^(2^32 - 1)\n-                \/\/ is pre-computed to speed up the computation.\n-\n-                \/\/ calculate and cache imp ^ (2^2 - 1) - imp ^ (2^4 - 1)\n-                IntegerModuloP[] w = new IntegerModuloP[4];\n-                w[0] = imp.fixed();\n-                MutableIntegerModuloP t = imp.mutable();\n-                for (int i = 1; i < 4; i++) {\n-                    t.setSquare();\n-                    t.setProduct(imp);\n-                    w[i] = t.fixed();\n-                }\n-\n-                \/\/ calculate imp ^ (2^32 - 1)\n-                MutableIntegerModuloP d = null;\n-                for (int i = 4; i < 32; i++) {\n-                    t.setSquare();\n-                    switch (i) {\n-                        case 7 -> {\n-                            t.setProduct(w[3]);\n-                            d = t.mutable();   \/\/ 7: imp ^ (2^8 - 1)\n-                        }\n-                        case 15 -> {\n-                            t.setProduct(d);\n-                            d = t.mutable();   \/\/ 15: imp ^ (2^16 - 1)\n-                        }\n-                        case 31 -> {\n-                            t.setProduct(d); \/\/ 31: imp ^ (2^32 - 1)\n-                        }\n-                    }\n-                }\n-\n-                \/\/ Here we have:\n-                \/\/    w[i] = imp ^ (2 ^ ( i + 1) - 1), i = {0, 1, 2, 3}\n-                \/\/       t = imp ^ (2^32 - 1)\n-                \/\/\n-                \/\/ calculate for bit 32-128, for contiguous 32-bit set.\n-                d = t.mutable();\n-                for (int i = 32; i < 128; i++) {\n-                    d.setSquare();\n-                    if (i == 95 || i == 127) {\n-                        d.setProduct(t);\n-                    }\n-                }\n-\n-                \/\/ Calculate for bit 128-255, for individual 1-bit set.\n-                for (int k = -1, i = 127; i >= 0; i--) {\n-                    if (b.testBit(i)) {\n-                        if (k == w.length - 2) {\n-                            \/\/ calculate the current & reserved bits\n-                            d.setSquare();\n-                            d.setProduct(w[w.length - 1]);\n-                            k = -1;\n-                        } else {\n-                            k++;\n-                            d.setSquare();\n-                        }\n-                    } else {    \/\/ calculate the reserved bits\n-                        if (k >= 0) {\n-                            \/\/ add back the reserved bits\n-                            d.setProduct(w[k]);\n-                            k = -1;\n-                        }\n-                        d.setSquare();\n-                    }\n-                }\n-\n-                return d.fixed();\n-            }\n-        }\n-    }\n@@ -417,0 +212,1 @@\n+\n","filename":"src\/java.base\/share\/classes\/sun\/security\/util\/math\/IntegerModuloP.java","additions":2,"deletions":206,"binary":false,"changes":208,"status":"modified"},{"patch":"@@ -629,4 +629,0 @@\n-\n-        public long[] getLimbs() {\n-            return limbs;\n-        }\n","filename":"src\/java.base\/share\/classes\/sun\/security\/util\/math\/intpoly\/IntegerPolynomial.java","additions":0,"deletions":4,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -619,0 +619,7 @@\n+    \/*\n+     * AVAs are encoded as a SEQUENCE of two elements.\n+     *\/\n+    public void encode(DerOutputStream out) throws IOException {\n+        derEncode(out);\n+    }\n+\n@@ -628,2 +635,1 @@\n-    @Override\n-    public void encode(DerOutputStream out) throws IOException {\n+    public void derEncode(DerOutputStream out) throws IOException {\n","filename":"src\/java.base\/share\/classes\/sun\/security\/x509\/AVA.java","additions":8,"deletions":2,"binary":false,"changes":10,"status":"modified"},{"patch":"@@ -103,2 +103,0 @@\n-     * @exception IllegalStateException if algparams is not initialized\n-     *                                  or cannot be encoded\n@@ -113,3 +111,3 @@\n-                throw new IllegalStateException(\n-                        \"AlgorithmParameters not initialized or cannot be decoded\",\n-                        ioe);\n+                \/\/ Ignore this at the moment. This exception can occur\n+                \/\/ if AlgorithmParameters was not initialized yet. Will\n+                \/\/ try to re-getEncoded() again later.\n@@ -152,0 +150,7 @@\n+    \/**\n+     * Marshal a DER-encoded \"AlgorithmID\" sequence on the DER stream.\n+     *\/\n+    public final void encode(DerOutputStream out) throws IOException {\n+        derEncode(out);\n+    }\n+\n@@ -162,1 +167,1 @@\n-    public void encode(DerOutputStream out) throws IOException {\n+    public void derEncode (DerOutputStream out) throws IOException {\n@@ -167,0 +172,6 @@\n+        \/\/ Re-getEncoded() from algParams if it was not initialized\n+        if (algParams != null && encodedParams == null) {\n+            encodedParams = algParams.getEncoded();\n+            \/\/ If still not initialized. Let the IOE be thrown.\n+        }\n+\n@@ -234,1 +245,1 @@\n-        encode(out);\n+        derEncode(out);\n@@ -487,2 +498,0 @@\n-     * @exception IllegalStateException if algparams is not initialized\n-     *                                  or cannot be encoded\n","filename":"src\/java.base\/share\/classes\/sun\/security\/x509\/AlgorithmId.java","additions":18,"deletions":9,"binary":false,"changes":27,"status":"modified"},{"patch":"@@ -62,0 +62,1 @@\n+ * @see CertAttrSet\n@@ -64,1 +65,2 @@\n-public class AuthorityInfoAccessExtension extends Extension {\n+public class AuthorityInfoAccessExtension extends Extension\n+        implements CertAttrSet {\n@@ -77,2 +79,1 @@\n-     * @param accessDescriptions the List of AccessDescription,\n-     *                           cannot be null or empty.\n+     * @param accessDescriptions the List of AccessDescription\n@@ -83,3 +84,0 @@\n-        if (accessDescriptions == null || accessDescriptions.isEmpty()) {\n-            throw new IllegalArgumentException(\"accessDescriptions is null or empty\");\n-        }\n","filename":"src\/java.base\/share\/classes\/sun\/security\/x509\/AuthorityInfoAccessExtension.java","additions":4,"deletions":6,"binary":false,"changes":10,"status":"modified"},{"patch":"@@ -53,0 +53,1 @@\n+ * @see CertAttrSet\n@@ -54,1 +55,2 @@\n-public class AuthorityKeyIdentifierExtension extends Extension {\n+public class AuthorityKeyIdentifierExtension extends Extension\n+        implements CertAttrSet {\n@@ -102,2 +104,2 @@\n-     * The default constructor for this extension. At least one parameter\n-     * must be non null. Null parameters make the element optional (not present).\n+     * The default constructor for this extension.  Null parameters make\n+     * the element optional (not present).\n@@ -113,5 +115,1 @@\n-            throws IOException {\n-        if (kid == null && names == null && sn == null) {\n-            throw new IllegalArgumentException(\n-                    \"AuthorityKeyIdentifierExtension cannot be empty\");\n-        }\n+    throws IOException {\n","filename":"src\/java.base\/share\/classes\/sun\/security\/x509\/AuthorityKeyIdentifierExtension.java","additions":6,"deletions":8,"binary":false,"changes":14,"status":"modified"},{"patch":"@@ -48,0 +48,1 @@\n+ * @see CertAttrSet\n@@ -50,1 +51,2 @@\n-public class BasicConstraintsExtension extends Extension {\n+public class BasicConstraintsExtension extends Extension\n+        implements CertAttrSet {\n","filename":"src\/java.base\/share\/classes\/sun\/security\/x509\/BasicConstraintsExtension.java","additions":3,"deletions":1,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -79,0 +79,1 @@\n+ * @see CertAttrSet\n@@ -80,1 +81,2 @@\n-public class CRLDistributionPointsExtension extends Extension {\n+public class CRLDistributionPointsExtension extends Extension\n+        implements CertAttrSet {\n@@ -109,2 +111,1 @@\n-     * @param distributionPoints the list of distribution points,\n-     *                           cannot be null or empty.\n+     * @param distributionPoints the list of distribution points\n@@ -124,1 +125,1 @@\n-            boolean isCritical, List<DistributionPoint> distributionPoints,\n+        boolean isCritical, List<DistributionPoint> distributionPoints,\n@@ -127,5 +128,0 @@\n-        if (distributionPoints == null || distributionPoints.isEmpty()) {\n-            throw new IllegalArgumentException(\n-                    \"distribution points cannot be null or empty\");\n-        }\n-\n","filename":"src\/java.base\/share\/classes\/sun\/security\/x509\/CRLDistributionPointsExtension.java","additions":5,"deletions":9,"binary":false,"changes":14,"status":"modified"},{"patch":"@@ -44,0 +44,1 @@\n+ * @see CertAttrSet\n@@ -45,1 +46,2 @@\n-public class CRLNumberExtension extends Extension {\n+public class CRLNumberExtension extends Extension\n+        implements CertAttrSet {\n@@ -81,1 +83,1 @@\n-     * @param crlNum the value to be set for the extension, cannot be null\n+     * @param crlNum the value to be set for the extension.\n@@ -94,3 +96,0 @@\n-        if (crlNum == null) {\n-            throw new IllegalArgumentException(\"CRL number cannot be null\");\n-        }\n","filename":"src\/java.base\/share\/classes\/sun\/security\/x509\/CRLNumberExtension.java","additions":4,"deletions":5,"binary":false,"changes":9,"status":"modified"},{"patch":"@@ -39,0 +39,1 @@\n+ * @see CertAttrSet\n@@ -40,1 +41,2 @@\n-public class CRLReasonCodeExtension extends Extension {\n+public class CRLReasonCodeExtension extends Extension\n+        implements CertAttrSet {\n@@ -72,1 +74,1 @@\n-     * @param reason the enumerated value for the reason code, must be positive.\n+     * @param reason the enumerated value for the reason code.\n@@ -75,4 +77,1 @@\n-            throws IOException {\n-        if (reason <= 0) {\n-            throw new IllegalArgumentException(\"reason code must be positive\");\n-        }\n+    throws IOException {\n","filename":"src\/java.base\/share\/classes\/sun\/security\/x509\/CRLReasonCodeExtension.java","additions":5,"deletions":6,"binary":false,"changes":11,"status":"modified"},{"patch":"@@ -0,0 +1,44 @@\n+\/*\n+ * Copyright (c) 1997, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+ *\n+ * This code is free software; you can redistribute it and\/or modify it\n+ * under the terms of the GNU General Public License version 2 only, as\n+ * published by the Free Software Foundation.  Oracle designates this\n+ * particular file as subject to the \"Classpath\" exception as provided\n+ * by Oracle in the LICENSE file that accompanied this code.\n+ *\n+ * This code is distributed in the hope that it will be useful, but WITHOUT\n+ * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+ * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+ * version 2 for more details (a copy is included in the LICENSE file that\n+ * accompanied this code).\n+ *\n+ * You should have received a copy of the GNU General Public License version\n+ * 2 along with this work; if not, write to the Free Software Foundation,\n+ * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n+ *\n+ * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n+ * or visit www.oracle.com if you need additional information or have any\n+ * questions.\n+ *\/\n+\n+package sun.security.x509;\n+\n+import sun.security.util.DerOutputStream;\n+\n+import java.io.IOException;\n+\n+\/**\n+ * This interface defines a certificate attribute that can be DER-encoded.\n+ *\/\n+public interface CertAttrSet {\n+\n+    \/**\n+     * Encodes the attribute to the output stream.\n+     *\n+     * @param out the DerOutputStream to encode the attribute to.\n+     * @exception IOException on write errors.\n+     *\/\n+    void encode(DerOutputStream out) throws IOException;\n+}\n","filename":"src\/java.base\/share\/classes\/sun\/security\/x509\/CertAttrSet.java","additions":44,"deletions":0,"binary":false,"changes":44,"status":"added"},{"patch":"@@ -39,1 +39,1 @@\n-public class CertificateAlgorithmId implements DerEncoder {\n+public class CertificateAlgorithmId implements CertAttrSet {\n","filename":"src\/java.base\/share\/classes\/sun\/security\/x509\/CertificateAlgorithmId.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -41,1 +41,1 @@\n- * @see DerEncoder\n+ * @see CertAttrSet\n@@ -43,1 +43,1 @@\n-public class CertificateExtensions implements DerEncoder {\n+public class CertificateExtensions implements CertAttrSet {\n","filename":"src\/java.base\/share\/classes\/sun\/security\/x509\/CertificateExtensions.java","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -59,0 +59,1 @@\n+ * @see CertAttrSet\n@@ -60,1 +61,2 @@\n-public class CertificateIssuerExtension extends Extension {\n+public class CertificateIssuerExtension extends Extension\n+        implements CertAttrSet {\n@@ -83,1 +85,1 @@\n-     * @param issuer the certificate issuer, cannot be null or empty.\n+     * @param issuer the certificate issuer\n@@ -87,3 +89,0 @@\n-        if (issuer == null || issuer.isEmpty()) {\n-            throw new IllegalArgumentException(\"issuer cannot be null or empty\");\n-        }\n","filename":"src\/java.base\/share\/classes\/sun\/security\/x509\/CertificateIssuerExtension.java","additions":4,"deletions":5,"binary":false,"changes":9,"status":"modified"},{"patch":"@@ -66,0 +66,1 @@\n+ * @see CertAttrSet\n@@ -67,1 +68,2 @@\n-public class CertificatePoliciesExtension extends Extension {\n+public class CertificatePoliciesExtension extends Extension\n+        implements CertAttrSet {\n@@ -109,1 +111,1 @@\n-     * @param certPolicies the List of PolicyInformation, cannot be null or empty.\n+     * @param certPolicies the List of PolicyInformation.\n@@ -113,4 +115,0 @@\n-        if (certPolicies == null || certPolicies.isEmpty()) {\n-            throw new IllegalArgumentException(\n-                    \"certificate policies cannot be null or empty\");\n-        }\n","filename":"src\/java.base\/share\/classes\/sun\/security\/x509\/CertificatePoliciesExtension.java","additions":4,"deletions":6,"binary":false,"changes":10,"status":"modified"},{"patch":"@@ -29,2 +29,0 @@\n-import java.util.Objects;\n-\n@@ -49,1 +47,1 @@\n-        this.id = Objects.requireNonNull(id);\n+        this.id = id;\n","filename":"src\/java.base\/share\/classes\/sun\/security\/x509\/CertificatePolicyId.java","additions":1,"deletions":3,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -29,1 +29,0 @@\n-import java.util.Objects;\n@@ -51,2 +50,2 @@\n-        this.issuerDomain = Objects.requireNonNull(issuer);\n-        this.subjectDomain = Objects.requireNonNull(subject);\n+        this.issuerDomain = issuer;\n+        this.subjectDomain = subject;\n","filename":"src\/java.base\/share\/classes\/sun\/security\/x509\/CertificatePolicyMap.java","additions":2,"deletions":3,"binary":false,"changes":5,"status":"modified"},{"patch":"@@ -39,1 +39,1 @@\n- * @see DerEncoder\n+ * @see CertAttrSet\n@@ -41,1 +41,1 @@\n-public class CertificateSerialNumber implements DerEncoder {\n+public class CertificateSerialNumber implements CertAttrSet {\n","filename":"src\/java.base\/share\/classes\/sun\/security\/x509\/CertificateSerialNumber.java","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -40,1 +40,1 @@\n- * @see DerEncoder\n+ * @see CertAttrSet\n@@ -42,1 +42,1 @@\n-public class CertificateSubjectName implements DerEncoder {\n+public class CertificateSubjectName implements CertAttrSet {\n","filename":"src\/java.base\/share\/classes\/sun\/security\/x509\/CertificateSubjectName.java","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -30,1 +30,0 @@\n-import java.util.Objects;\n@@ -39,1 +38,1 @@\n- * @see DerEncoder\n+ * @see CertAttrSet\n@@ -41,1 +40,1 @@\n-public class CertificateValidity implements DerEncoder {\n+public class CertificateValidity implements CertAttrSet {\n@@ -50,2 +49,2 @@\n-    private final Date        notBefore;\n-    private final Date        notAfter;\n+    private Date        notBefore;\n+    private Date        notAfter;\n@@ -63,21 +62,2 @@\n-    \/**\n-     * The constructor for this class for the specified interval.\n-     *\n-     * @param notBefore the date and time before which the certificate\n-     *                   is not valid\n-     * @param notAfter the date and time after which the certificate is\n-     *                  not valid\n-     *\/\n-    public CertificateValidity(Date notBefore, Date notAfter) {\n-        this.notBefore = Objects.requireNonNull(notBefore);\n-        this.notAfter = Objects.requireNonNull(notAfter);\n-    }\n-\n-    \/**\n-     * Create the object, decoding the values from the passed DER stream.\n-     *\n-     * @param in the DerInputStream to read the CertificateValidity from\n-     * @exception IOException on decoding errors.\n-     *\/\n-    public CertificateValidity(DerInputStream in) throws IOException {\n-        DerValue derVal = in.getDerValue();\n+    \/\/ Construct the class from the DerValue\n+    private void construct(DerValue derVal) throws IOException {\n@@ -114,0 +94,29 @@\n+    \/**\n+     * Default constructor for the class.\n+     *\/\n+    public CertificateValidity() { }\n+\n+    \/**\n+     * The default constructor for this class for the specified interval.\n+     *\n+     * @param notBefore the date and time before which the certificate\n+     *                   is not valid.\n+     * @param notAfter the date and time after which the certificate is\n+     *                  not valid.\n+     *\/\n+    public CertificateValidity(Date notBefore, Date notAfter) {\n+        this.notBefore = notBefore;\n+        this.notAfter = notAfter;\n+    }\n+\n+    \/**\n+     * Create the object, decoding the values from the passed DER stream.\n+     *\n+     * @param in the DerInputStream to read the CertificateValidity from.\n+     * @exception IOException on decoding errors.\n+     *\/\n+    public CertificateValidity(DerInputStream in) throws IOException {\n+        DerValue derVal = in.getDerValue();\n+        construct(derVal);\n+    }\n+\n@@ -118,0 +127,2 @@\n+        if (notBefore == null || notAfter == null)\n+            return \"\";\n@@ -131,0 +142,6 @@\n+        \/\/ in cases where default constructor is used check for\n+        \/\/ null values\n+        if (notBefore == null || notAfter == null) {\n+            throw new IOException(\"CertAttrSet:CertificateValidity:\" +\n+                                  \" null values to encode.\\n\");\n+        }\n","filename":"src\/java.base\/share\/classes\/sun\/security\/x509\/CertificateValidity.java","additions":43,"deletions":26,"binary":false,"changes":69,"status":"modified"},{"patch":"@@ -38,1 +38,1 @@\n- * @see DerEncoder\n+ * @see CertAttrSet\n@@ -40,1 +40,1 @@\n-public class CertificateVersion implements DerEncoder {\n+public class CertificateVersion implements CertAttrSet {\n","filename":"src\/java.base\/share\/classes\/sun\/security\/x509\/CertificateVersion.java","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -39,1 +39,1 @@\n- * @see DerEncoder\n+ * @see CertAttrSet\n@@ -41,1 +41,1 @@\n-public class CertificateX509Key implements DerEncoder {\n+public class CertificateX509Key implements CertAttrSet {\n","filename":"src\/java.base\/share\/classes\/sun\/security\/x509\/CertificateX509Key.java","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -29,2 +29,0 @@\n-import java.util.Objects;\n-\n@@ -66,1 +64,1 @@\n-        this.party = Objects.requireNonNull(partyName);\n+        this.party = partyName;\n@@ -75,1 +73,1 @@\n-        this(null, partyName);\n+        this.party = partyName;\n@@ -111,3 +109,0 @@\n-        if (party == null) {\n-            throw new IOException(\"party cannot be missing\");\n-        }\n@@ -140,0 +135,3 @@\n+        if (party == null)\n+            throw  new IOException(\"Cannot have null partyName\");\n+\n","filename":"src\/java.base\/share\/classes\/sun\/security\/x509\/EDIPartyName.java","additions":5,"deletions":7,"binary":false,"changes":12,"status":"modified"},{"patch":"@@ -79,1 +79,2 @@\n-public class ExtendedKeyUsageExtension extends Extension {\n+public class ExtendedKeyUsageExtension extends Extension\n+        implements CertAttrSet {\n@@ -121,2 +122,1 @@\n-     * @param keyUsages the Vector of KeyUsages (ObjectIdentifiers),\n-     *                  cannot be null or empty.\n+     * @param keyUsages the Vector of KeyUsages (ObjectIdentifiers)\n@@ -125,5 +125,1 @@\n-            throws IOException {\n-        if (keyUsages == null || keyUsages.isEmpty()) {\n-            throw new IllegalArgumentException(\n-                    \"key usages cannot be null or empty\");\n-        }\n+    throws IOException {\n","filename":"src\/java.base\/share\/classes\/sun\/security\/x509\/ExtendedKeyUsageExtension.java","additions":4,"deletions":8,"binary":false,"changes":12,"status":"modified"},{"patch":"@@ -31,2 +31,0 @@\n-import java.util.Objects;\n-\n@@ -63,1 +61,1 @@\n-public class Extension implements java.security.cert.Extension, DerEncoder {\n+public class Extension implements java.security.cert.Extension {\n@@ -174,1 +172,0 @@\n-    @Override\n@@ -177,4 +174,4 @@\n-        Objects.requireNonNull(extensionId,\n-                \"No OID to encode for the extension\");\n-        Objects.requireNonNull(extensionValue,\n-                \"No value to encode for the extension\");\n+        if (extensionId == null)\n+            throw new IOException(\"Null OID to encode for the extension!\");\n+        if (extensionValue == null)\n+            throw new IOException(\"No value to encode for the extension!\");\n","filename":"src\/java.base\/share\/classes\/sun\/security\/x509\/Extension.java","additions":5,"deletions":8,"binary":false,"changes":13,"status":"modified"},{"patch":"@@ -29,1 +29,0 @@\n-import java.util.Objects;\n@@ -65,1 +64,1 @@\n-        this.name = Objects.requireNonNull(name);\n+        this.name = name;\n","filename":"src\/java.base\/share\/classes\/sun\/security\/x509\/GeneralSubtree.java","additions":1,"deletions":2,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -256,1 +256,1 @@\n-                newName = new GeneralName(new X400Address(null));\n+                newName = new GeneralName(new X400Address((byte[])null));\n","filename":"src\/java.base\/share\/classes\/sun\/security\/x509\/GeneralSubtrees.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -56,0 +56,1 @@\n+ * @see CertAttrSet\n@@ -58,1 +59,2 @@\n-public class InhibitAnyPolicyExtension extends Extension {\n+public class InhibitAnyPolicyExtension extends Extension\n+        implements CertAttrSet {\n@@ -86,1 +88,1 @@\n-            throw new IllegalArgumentException(\"Invalid value for skipCerts\");\n+            throw new IOException(\"Invalid value for skipCerts\");\n","filename":"src\/java.base\/share\/classes\/sun\/security\/x509\/InhibitAnyPolicyExtension.java","additions":4,"deletions":2,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -58,1 +58,2 @@\n-public class InvalidityDateExtension extends Extension {\n+public class InvalidityDateExtension extends Extension\n+        implements CertAttrSet {\n@@ -91,1 +92,1 @@\n-     * @param date the invalidity date, cannot be null.\n+     * @param date the invalidity date\n@@ -94,4 +95,1 @@\n-            throws IOException {\n-        if (date == null) {\n-            throw new IllegalArgumentException(\"date cannot be null\");\n-        }\n+    throws IOException {\n","filename":"src\/java.base\/share\/classes\/sun\/security\/x509\/InvalidityDateExtension.java","additions":4,"deletions":6,"binary":false,"changes":10,"status":"modified"},{"patch":"@@ -46,0 +46,1 @@\n+ * @see CertAttrSet\n@@ -47,1 +48,2 @@\n-public class IssuerAlternativeNameExtension extends Extension {\n+public class IssuerAlternativeNameExtension\n+        extends Extension implements CertAttrSet {\n@@ -72,2 +74,5 @@\n-            throws IOException {\n-        this(false, names);\n+    throws IOException {\n+        this.names = names;\n+        this.extensionId = PKIXExtensions.IssuerAlternativeName_Id;\n+        this.critical = false;\n+        encodeThis();\n@@ -81,1 +86,1 @@\n-     * @param names the GeneralNames for the issuer, cannot be null or empty.\n+     * @param names the GeneralNames for the issuer.\n@@ -85,4 +90,1 @@\n-            throws IOException {\n-        if (names == null || names.isEmpty()) {\n-            throw new IllegalArgumentException(\"names cannot be null or empty\");\n-        }\n+    throws IOException {\n@@ -96,0 +98,9 @@\n+     * Create a default IssuerAlternativeNameExtension.\n+     *\/\n+    public IssuerAlternativeNameExtension() {\n+        extensionId = PKIXExtensions.IssuerAlternativeName_Id;\n+        critical = false;\n+        names = new GeneralNames();\n+    }\n+\n+    \/**\n","filename":"src\/java.base\/share\/classes\/sun\/security\/x509\/IssuerAlternativeNameExtension.java","additions":19,"deletions":8,"binary":false,"changes":27,"status":"modified"},{"patch":"@@ -66,1 +66,2 @@\n-public class IssuingDistributionPointExtension extends Extension {\n+public class IssuingDistributionPointExtension extends Extension\n+        implements CertAttrSet {\n@@ -113,2 +114,1 @@\n-     *        <code>hasOnlyAttributeCerts<\/code> is set to <code>true<\/code>,\n-     *        or all arguments are either <code>null<\/code> or <code>false<\/code>.\n+     *        <code>hasOnlyAttributeCerts<\/code> is set to <code>true<\/code>.\n@@ -123,8 +123,0 @@\n-        if (distributionPoint == null &&\n-                revocationReasons == null &&\n-                !hasOnlyUserCerts &&\n-                !hasOnlyCACerts &&\n-                !hasOnlyAttributeCerts &&\n-                !isIndirectCRL) {\n-            throw new IllegalArgumentException(\"elements cannot be empty\");\n-        }\n","filename":"src\/java.base\/share\/classes\/sun\/security\/x509\/IssuingDistributionPointExtension.java","additions":3,"deletions":11,"binary":false,"changes":14,"status":"modified"},{"patch":"@@ -44,0 +44,1 @@\n+ * @see CertAttrSet\n@@ -45,1 +46,2 @@\n-public class KeyUsageExtension extends Extension {\n+public class KeyUsageExtension extends Extension\n+        implements CertAttrSet {\n@@ -197,1 +199,1 @@\n-                                + \" KeyUsage.\");\n+                                + \" CertAttrSet:KeyUsage.\");\n@@ -226,1 +228,1 @@\n-                                + \" KeyUsage.\");\n+                                + \" CertAttrSet:KeyUsage.\");\n","filename":"src\/java.base\/share\/classes\/sun\/security\/x509\/KeyUsageExtension.java","additions":5,"deletions":3,"binary":false,"changes":8,"status":"modified"},{"patch":"@@ -60,0 +60,1 @@\n+ * @see CertAttrSet\n@@ -62,1 +63,1 @@\n-        implements Cloneable {\n+        implements CertAttrSet, Cloneable {\n@@ -130,2 +131,2 @@\n-     * The default constructor for this class. Both parameters are optional\n-     * but at least one should be non null.  The extension criticality\n+     * The default constructor for this class. Both parameters\n+     * are optional and can be set to null.  The extension criticality\n@@ -139,5 +140,1 @@\n-            throws IOException {\n-        if (permitted == null && excluded == null) {\n-            throw new IllegalArgumentException(\n-                    \"permitted and excluded cannot both be null\");\n-        }\n+    throws IOException {\n@@ -287,2 +284,0 @@\n-        boolean updated = false;\n-\n@@ -297,4 +292,2 @@\n-            if (newExcluded != null) {\n-                excluded = (GeneralSubtrees) newExcluded.clone();\n-                updated = true;\n-            }\n+            excluded = (newExcluded != null) ?\n+                        (GeneralSubtrees)newExcluded.clone() : null;\n@@ -305,1 +298,0 @@\n-                updated = true;\n@@ -317,4 +309,2 @@\n-            if (newPermitted != null) {\n-                permitted = (GeneralSubtrees) newPermitted.clone();\n-                updated = true;\n-            }\n+            permitted = (newPermitted != null) ?\n+                        (GeneralSubtrees)newPermitted.clone() : null;\n@@ -333,1 +323,0 @@\n-                    updated = true;\n@@ -344,1 +333,0 @@\n-            updated = true;\n@@ -349,3 +337,2 @@\n-        if (updated) {\n-            encodeThis();\n-        }\n+        encodeThis();\n+\n","filename":"src\/java.base\/share\/classes\/sun\/security\/x509\/NameConstraintsExtension.java","additions":11,"deletions":24,"binary":false,"changes":35,"status":"modified"},{"patch":"@@ -47,0 +47,1 @@\n+ * @see CertAttrSet\n@@ -49,1 +50,2 @@\n-public class NetscapeCertTypeExtension extends Extension {\n+public class NetscapeCertTypeExtension extends Extension\n+        implements CertAttrSet {\n@@ -102,1 +104,1 @@\n-                             + \"] not recognized by NetscapeCertType.\");\n+                             + \"] not recognized by CertAttrSet:NetscapeCertType.\");\n","filename":"src\/java.base\/share\/classes\/sun\/security\/x509\/NetscapeCertTypeExtension.java","additions":4,"deletions":2,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -48,0 +48,1 @@\n+ * @see CertAttrSet\n@@ -49,1 +50,2 @@\n-public class OCSPNoCheckExtension extends Extension {\n+public class OCSPNoCheckExtension extends Extension\n+        implements CertAttrSet {\n","filename":"src\/java.base\/share\/classes\/sun\/security\/x509\/OCSPNoCheckExtension.java","additions":3,"deletions":1,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -53,0 +53,1 @@\n+ * @see CertAttrSet\n@@ -54,1 +55,2 @@\n-public class PolicyConstraintsExtension extends Extension {\n+public class PolicyConstraintsExtension extends Extension\n+        implements CertAttrSet {\n@@ -105,1 +107,1 @@\n-     * policy mapping. At least one should be provided (not -1).\n+     * policy mapping.\n@@ -112,5 +114,1 @@\n-            throws IOException {\n-        if (require == -1 && inhibit == -1) {\n-            throw new IllegalArgumentException(\n-                    \"require and inhibit cannot both be -1\");\n-        }\n+    throws IOException {\n","filename":"src\/java.base\/share\/classes\/sun\/security\/x509\/PolicyConstraintsExtension.java","additions":5,"deletions":7,"binary":false,"changes":12,"status":"modified"},{"patch":"@@ -32,1 +32,0 @@\n-import java.util.Objects;\n@@ -91,1 +90,1 @@\n-        this.policyIdentifier = Objects.requireNonNull(policyIdentifier);\n+        this.policyIdentifier = policyIdentifier;\n","filename":"src\/java.base\/share\/classes\/sun\/security\/x509\/PolicyInformation.java","additions":1,"deletions":2,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -50,0 +50,1 @@\n+ * @see CertAttrSet\n@@ -51,1 +52,2 @@\n-public class PolicyMappingsExtension extends Extension {\n+public class PolicyMappingsExtension extends Extension\n+        implements CertAttrSet {\n@@ -78,1 +80,1 @@\n-     * @param maps the List of CertificatePolicyMap, cannot be null or empty.\n+     * @param maps the List of CertificatePolicyMap.\n@@ -82,3 +84,0 @@\n-        if (maps == null || maps.isEmpty()) {\n-            throw new IllegalArgumentException(\"maps cannot be null or empty\");\n-        }\n@@ -91,0 +90,9 @@\n+    \/**\n+     * Create a default PolicyMappingsExtension.\n+     *\/\n+    public PolicyMappingsExtension() {\n+        extensionId = PKIXExtensions.PolicyMappings_Id;\n+        critical = true;\n+        maps = Collections.emptyList();\n+    }\n+\n","filename":"src\/java.base\/share\/classes\/sun\/security\/x509\/PolicyMappingsExtension.java","additions":13,"deletions":5,"binary":false,"changes":18,"status":"modified"},{"patch":"@@ -58,0 +58,1 @@\n+ * @see CertAttrSet\n@@ -59,1 +60,2 @@\n-public class PrivateKeyUsageExtension extends Extension {\n+public class PrivateKeyUsageExtension extends Extension\n+        implements CertAttrSet {\n@@ -96,2 +98,1 @@\n-     * The default constructor for PrivateKeyUsageExtension. At least one\n-     * of the arguments must be non null.\n+     * The default constructor for PrivateKeyUsageExtension.\n@@ -100,1 +101,1 @@\n-     *         should not be used\n+     *         should not be used.\n@@ -105,5 +106,1 @@\n-            throws IOException {\n-        if (notBefore == null && notAfter == null) {\n-            throw new IllegalArgumentException(\n-                    \"notBefore and notAfter cannot both be null\");\n-        }\n+    throws IOException {\n","filename":"src\/java.base\/share\/classes\/sun\/security\/x509\/PrivateKeyUsageExtension.java","additions":6,"deletions":9,"binary":false,"changes":15,"status":"modified"},{"patch":"@@ -51,0 +51,1 @@\n+ * @see CertAttrSet\n@@ -52,1 +53,2 @@\n-public class SubjectAlternativeNameExtension extends Extension {\n+public class SubjectAlternativeNameExtension extends Extension\n+        implements CertAttrSet {\n@@ -87,1 +89,1 @@\n-     * @param names the GeneralNames for the subject, cannot be null or empty.\n+     * @param names the GeneralNames for the subject.\n@@ -91,4 +93,1 @@\n-            throws IOException {\n-        if (names == null || names.isEmpty()) {\n-            throw new IllegalArgumentException(\"names cannot be null or empty\");\n-        }\n+    throws IOException {\n@@ -101,0 +100,10 @@\n+    \/**\n+     * Create a default SubjectAlternativeNameExtension. The extension\n+     * is marked non-critical.\n+     *\/\n+    public SubjectAlternativeNameExtension() {\n+        extensionId = PKIXExtensions.SubjectAlternativeName_Id;\n+        critical = false;\n+        names = new GeneralNames();\n+    }\n+\n","filename":"src\/java.base\/share\/classes\/sun\/security\/x509\/SubjectAlternativeNameExtension.java","additions":15,"deletions":6,"binary":false,"changes":21,"status":"modified"},{"patch":"@@ -66,0 +66,1 @@\n+ * @see CertAttrSet\n@@ -68,1 +69,2 @@\n-public class SubjectInfoAccessExtension extends Extension {\n+public class SubjectInfoAccessExtension extends Extension\n+        implements CertAttrSet {\n@@ -81,2 +83,1 @@\n-     * @param accessDescriptions the List of AccessDescription,\n-     *                           cannot be null or empty.\n+     * @param accessDescriptions the List of AccessDescription\n@@ -87,4 +88,0 @@\n-        if (accessDescriptions == null || accessDescriptions.isEmpty()) {\n-            throw new IllegalArgumentException(\n-                    \"accessDescriptions cannot be null or empty\");\n-        }\n","filename":"src\/java.base\/share\/classes\/sun\/security\/x509\/SubjectInfoAccessExtension.java","additions":4,"deletions":7,"binary":false,"changes":11,"status":"modified"},{"patch":"@@ -51,0 +51,1 @@\n+ * @see CertAttrSet\n@@ -52,1 +53,2 @@\n-public class SubjectKeyIdentifierExtension extends Extension {\n+public class SubjectKeyIdentifierExtension extends Extension\n+        implements CertAttrSet {\n@@ -76,1 +78,1 @@\n-            throws IOException {\n+    throws IOException {\n","filename":"src\/java.base\/share\/classes\/sun\/security\/x509\/SubjectKeyIdentifierExtension.java","additions":4,"deletions":2,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -338,1 +338,1 @@\n-    DerValue derValue;\n+    byte[] nameValue;\n@@ -345,0 +345,3 @@\n+    public X400Address(byte[] value) {\n+        nameValue = value;\n+    }\n@@ -353,1 +356,1 @@\n-        this.derValue = derValue;\n+        nameValue = derValue.toByteArray();\n@@ -369,1 +372,0 @@\n-    @Override\n@@ -371,0 +373,1 @@\n+        DerValue derValue = new DerValue(nameValue);\n","filename":"src\/java.base\/share\/classes\/sun\/security\/x509\/X400Address.java","additions":6,"deletions":3,"binary":false,"changes":9,"status":"modified"},{"patch":"@@ -29,0 +29,1 @@\n+import java.io.OutputStream;\n@@ -90,2 +91,0 @@\n-    private TBSCertList info;\n-\n@@ -93,252 +92,10 @@\n-    public static class TBSCertList {\n-        private int version;\n-        private AlgorithmId infoSigAlgId; \/\/ sig alg in \"to-be-signed\" crl\n-        private X500Name issuer = null;\n-        private X500Principal issuerPrincipal = null;\n-        private Date thisUpdate = null;\n-        private Date nextUpdate = null;\n-        private final Map<X509IssuerSerial, X509CRLEntry> revokedMap =\n-                new TreeMap<>();\n-        private final List<X509CRLEntry> revokedList = new LinkedList<>();\n-        private CRLExtensions extensions = null;\n-\n-        \/**\n-         * Initial TBSCertList constructor, no revoked certs, and no extensions.\n-         *\n-         * @param issuer the name of the CA issuing this CRL.\n-         * @param thisDate the Date of this issue.\n-         * @param nextDate the Date of the next CRL.\n-         *\/\n-        public TBSCertList(X500Name issuer, Date thisDate, Date nextDate) {\n-            this.issuer = issuer;\n-            this.thisUpdate = thisDate;\n-            this.nextUpdate = nextDate;\n-        }\n-\n-        \/**\n-         * TBSCertList constructor, revoked certs, no extensions.\n-         *\n-         * @param issuer the name of the CA issuing this CRL.\n-         * @param thisDate the Date of this issue.\n-         * @param nextDate the Date of the next CRL.\n-         * @param badCerts the array of CRL entries.\n-         *\n-         * @exception CRLException on parsing\/construction errors.\n-         *\/\n-        public TBSCertList(X500Name issuer, Date thisDate, Date nextDate,\n-                           X509CRLEntry[] badCerts)\n-                throws CRLException\n-        {\n-            this.issuer = issuer;\n-            this.thisUpdate = thisDate;\n-            this.nextUpdate = nextDate;\n-            if (badCerts != null) {\n-                X500Principal crlIssuer = getIssuerX500Principal();\n-                X500Principal badCertIssuer = crlIssuer;\n-                for (int i = 0; i < badCerts.length; i++) {\n-                    X509CRLEntryImpl badCert = (X509CRLEntryImpl)badCerts[i];\n-                    badCertIssuer = getCertIssuer(badCert, badCertIssuer);\n-                    badCert.setCertificateIssuer(crlIssuer, badCertIssuer);\n-                    X509IssuerSerial issuerSerial = new X509IssuerSerial\n-                            (badCertIssuer, badCert.getSerialNumber());\n-                    this.revokedMap.put(issuerSerial, badCert);\n-                    this.revokedList.add(badCert);\n-                    if (badCert.hasExtensions()) {\n-                        this.version = 1;\n-                    }\n-                }\n-            }\n-        }\n-\n-        \/**\n-         * TBSCertList constructor, revoked certs and extensions.\n-         *\n-         * @param issuer the name of the CA issuing this CRL.\n-         * @param thisDate the Date of this issue.\n-         * @param nextDate the Date of the next CRL.\n-         * @param badCerts the array of CRL entries.\n-         * @param crlExts the CRL extensions.\n-         *\n-         * @exception CRLException on parsing\/construction errors.\n-         *\/\n-        public TBSCertList(X500Name issuer, Date thisDate, Date nextDate,\n-                           X509CRLEntry[] badCerts, CRLExtensions crlExts)\n-                throws CRLException\n-        {\n-            this(issuer, thisDate, nextDate, badCerts);\n-            if (crlExts != null) {\n-                this.extensions = crlExts;\n-                this.version = 1;\n-            }\n-        }\n-\n-        \/**\n-         * Constructs from the encoding.\n-         *\/\n-        public TBSCertList(DerValue value) throws IOException, CRLException {\n-\n-            if (value.tag != DerValue.tag_Sequence)\n-                throw new CRLException(\"signed CRL fields invalid\");\n-\n-            \/\/ parse the information\n-            DerInputStream derStrm = value.data;\n-            DerValue       tmp;\n-            byte           nextByte;\n-\n-            \/\/ version (optional if v1)\n-            version = 0;   \/\/ by default, version = v1 == 0\n-            nextByte = (byte)derStrm.peekByte();\n-            if (nextByte == DerValue.tag_Integer) {\n-                version = derStrm.getInteger();\n-                if (version != 1)  \/\/ i.e. v2\n-                    throw new CRLException(\"Invalid version\");\n-            }\n-            tmp = derStrm.getDerValue();\n-\n-            \/\/ signature\n-            infoSigAlgId = AlgorithmId.parse(tmp);\n-\n-            \/\/ issuer\n-            issuer = new X500Name(derStrm);\n-            if (issuer.isEmpty()) {\n-                throw new CRLException(\"Empty issuer DN not allowed in X509CRLs\");\n-            }\n-\n-            \/\/ thisUpdate\n-            \/\/ check if UTCTime encoded or GeneralizedTime\n-\n-            nextByte = (byte)derStrm.peekByte();\n-            if (nextByte == DerValue.tag_UtcTime) {\n-                thisUpdate = derStrm.getUTCTime();\n-            } else if (nextByte == DerValue.tag_GeneralizedTime) {\n-                thisUpdate = derStrm.getGeneralizedTime();\n-            } else {\n-                throw new CRLException(\"Invalid encoding for thisUpdate\"\n-                        + \" (tag=\" + nextByte + \")\");\n-            }\n-\n-            if (derStrm.available() == 0)\n-                return;     \/\/ done parsing no more optional fields present\n-\n-            \/\/ nextUpdate (optional)\n-            nextByte = (byte)derStrm.peekByte();\n-            if (nextByte == DerValue.tag_UtcTime) {\n-                nextUpdate = derStrm.getUTCTime();\n-            } else if (nextByte == DerValue.tag_GeneralizedTime) {\n-                nextUpdate = derStrm.getGeneralizedTime();\n-            } \/\/ else it is not present\n-\n-            if (derStrm.available() == 0)\n-                return;     \/\/ done parsing no more optional fields present\n-\n-            \/\/ revokedCertificates (optional)\n-            nextByte = (byte)derStrm.peekByte();\n-            if ((nextByte == DerValue.tag_SequenceOf)\n-                    && (! ((nextByte & 0x0c0) == 0x080))) {\n-                DerValue[] badCerts = derStrm.getSequence(4);\n-\n-                X500Principal crlIssuer = getIssuerX500Principal();\n-                X500Principal badCertIssuer = crlIssuer;\n-                for (int i = 0; i < badCerts.length; i++) {\n-                    X509CRLEntryImpl entry = new X509CRLEntryImpl(badCerts[i]);\n-                    badCertIssuer = getCertIssuer(entry, badCertIssuer);\n-                    entry.setCertificateIssuer(crlIssuer, badCertIssuer);\n-                    X509IssuerSerial issuerSerial = new X509IssuerSerial\n-                            (badCertIssuer, entry.getSerialNumber());\n-                    revokedMap.put(issuerSerial, entry);\n-                    revokedList.add(entry);\n-                }\n-            }\n-\n-            if (derStrm.available() == 0)\n-                return;     \/\/ done parsing no extensions\n-\n-            \/\/ crlExtensions (optional)\n-            tmp = derStrm.getDerValue();\n-            if (tmp.isConstructed() && tmp.isContextSpecific((byte)0)) {\n-                extensions = new CRLExtensions(tmp.data);\n-            }\n-        }\n-\n-        \/**\n-         * Return the issuer as X500Principal.\n-         *\/\n-        public X500Principal getIssuerX500Principal() {\n-            if (issuerPrincipal == null) {\n-                issuerPrincipal = issuer.asX500Principal();\n-            }\n-            return issuerPrincipal;\n-        }\n-\n-        \/**\n-         * Returns the X500 certificate issuer DN of a CRL entry.\n-         *\n-         * @param entry the entry to check\n-         * @param prevCertIssuer the previous entry's certificate issuer\n-         * @return the X500Principal in a CertificateIssuerExtension, or\n-         *   prevCertIssuer if it does not exist\n-         *\/\n-        private X500Principal getCertIssuer(X509CRLEntryImpl entry,\n-                                            X500Principal prevCertIssuer) {\n-\n-            CertificateIssuerExtension ciExt =\n-                    entry.getCertificateIssuerExtension();\n-            if (ciExt != null) {\n-                GeneralNames names = ciExt.getNames();\n-                X500Name issuerDN = (X500Name) names.get(0).getName();\n-                return issuerDN.asX500Principal();\n-            } else {\n-                return prevCertIssuer;\n-            }\n-        }\n-\n-        \/**\n-         * Encodes the \"to-be-signed\" TBSCertList to the OutputStream.\n-         *\n-         * @exception CRLException on encoding errors.\n-         *\/\n-        public byte[] encodeInfo() throws CRLException {\n-            try {\n-                DerOutputStream tmp = new DerOutputStream();\n-                DerOutputStream rCerts = new DerOutputStream();\n-                DerOutputStream seq = new DerOutputStream();\n-\n-                if (version != 0) \/\/ v2 crl encode version\n-                    tmp.putInteger(version);\n-                infoSigAlgId.encode(tmp);\n-                if ((version == 0) && (issuer.toString() == null))\n-                    throw new CRLException(\"Null Issuer DN not allowed in v1 CRL\");\n-                issuer.encode(tmp);\n-\n-                if (thisUpdate.getTime() < CertificateValidity.YR_2050)\n-                    tmp.putUTCTime(thisUpdate);\n-                else\n-                    tmp.putGeneralizedTime(thisUpdate);\n-\n-                if (nextUpdate != null) {\n-                    if (nextUpdate.getTime() < CertificateValidity.YR_2050)\n-                        tmp.putUTCTime(nextUpdate);\n-                    else\n-                        tmp.putGeneralizedTime(nextUpdate);\n-                }\n-\n-                if (!revokedList.isEmpty()) {\n-                    for (X509CRLEntry entry : revokedList) {\n-                        ((X509CRLEntryImpl)entry).encode(rCerts);\n-                    }\n-                    tmp.write(DerValue.tag_Sequence, rCerts);\n-                }\n-\n-                if (extensions != null)\n-                    extensions.encode(tmp, isExplicit);\n-\n-                seq.write(DerValue.tag_Sequence, tmp);\n-\n-                return seq.toByteArray();\n-            } catch (IOException e) {\n-                throw new CRLException(\"Encoding error: \" + e.getMessage());\n-            }\n-        }\n-\n-    }\n-\n+    private int              version;\n+    private AlgorithmId      infoSigAlgId; \/\/ sig alg in \"to-be-signed\" crl\n+    private X500Name         issuer = null;\n+    private X500Principal    issuerPrincipal = null;\n+    private Date             thisUpdate = null;\n+    private Date             nextUpdate = null;\n+    private final Map<X509IssuerSerial,X509CRLEntry> revokedMap =\n+            new TreeMap<>();\n+    private final List<X509CRLEntry> revokedList = new LinkedList<>();\n+    private CRLExtensions    extensions = null;\n@@ -347,0 +104,2 @@\n+    private boolean readOnly = false;\n+\n@@ -361,2 +120,2 @@\n-     * Constructor simply setting all (non-cache) fields. Only used in\n-     * {@link #newSigned}.\n+     * Not to be used. As it would lead to cases of uninitialized\n+     * CRL objects.\n@@ -364,8 +123,1 @@\n-    public X509CRLImpl(TBSCertList info, AlgorithmId sigAlgId, byte[] signature,\n-                       byte[] tbsCertList, byte[] signedCRL) {\n-        this.info = info;\n-        this.sigAlgId = sigAlgId;\n-        this.signature = signature;\n-        this.tbsCertList = tbsCertList;\n-        this.signedCRL = Objects.requireNonNull(signedCRL);\n-    }\n+    private X509CRLImpl() { }\n@@ -387,0 +139,1 @@\n+            signedCRL = null;\n@@ -401,0 +154,1 @@\n+            signedCRL = null;\n@@ -416,0 +170,1 @@\n+            signedCRL = null;\n@@ -420,2 +175,68 @@\n-    public TBSCertList info() {\n-        return info;\n+    \/**\n+     * Initial CRL constructor, no revoked certs, and no extensions.\n+     *\n+     * @param issuer the name of the CA issuing this CRL.\n+     * @param thisDate the Date of this issue.\n+     * @param nextDate the Date of the next CRL.\n+     *\/\n+    public X509CRLImpl(X500Name issuer, Date thisDate, Date nextDate) {\n+        this.issuer = issuer;\n+        this.thisUpdate = thisDate;\n+        this.nextUpdate = nextDate;\n+    }\n+\n+    \/**\n+     * CRL constructor, revoked certs, no extensions.\n+     *\n+     * @param issuer the name of the CA issuing this CRL.\n+     * @param thisDate the Date of this issue.\n+     * @param nextDate the Date of the next CRL.\n+     * @param badCerts the array of CRL entries.\n+     *\n+     * @exception CRLException on parsing\/construction errors.\n+     *\/\n+    public X509CRLImpl(X500Name issuer, Date thisDate, Date nextDate,\n+                       X509CRLEntry[] badCerts)\n+        throws CRLException\n+    {\n+        this.issuer = issuer;\n+        this.thisUpdate = thisDate;\n+        this.nextUpdate = nextDate;\n+        if (badCerts != null) {\n+            X500Principal crlIssuer = getIssuerX500Principal();\n+            X500Principal badCertIssuer = crlIssuer;\n+            for (int i = 0; i < badCerts.length; i++) {\n+                X509CRLEntryImpl badCert = (X509CRLEntryImpl)badCerts[i];\n+                badCertIssuer = getCertIssuer(badCert, badCertIssuer);\n+                badCert.setCertificateIssuer(crlIssuer, badCertIssuer);\n+                X509IssuerSerial issuerSerial = new X509IssuerSerial\n+                    (badCertIssuer, badCert.getSerialNumber());\n+                this.revokedMap.put(issuerSerial, badCert);\n+                this.revokedList.add(badCert);\n+                if (badCert.hasExtensions()) {\n+                    this.version = 1;\n+                }\n+            }\n+        }\n+    }\n+\n+    \/**\n+     * CRL constructor, revoked certs and extensions.\n+     *\n+     * @param issuer the name of the CA issuing this CRL.\n+     * @param thisDate the Date of this issue.\n+     * @param nextDate the Date of the next CRL.\n+     * @param badCerts the array of CRL entries.\n+     * @param crlExts the CRL extensions.\n+     *\n+     * @exception CRLException on parsing\/construction errors.\n+     *\/\n+    public X509CRLImpl(X500Name issuer, Date thisDate, Date nextDate,\n+               X509CRLEntry[] badCerts, CRLExtensions crlExts)\n+        throws CRLException\n+    {\n+        this(issuer, thisDate, nextDate, badCerts);\n+        if (crlExts != null) {\n+            this.extensions = crlExts;\n+            this.version = 1;\n+        }\n@@ -430,0 +251,3 @@\n+        if (signedCRL == null) {\n+            throw new CRLException(\"Null CRL to encode\");\n+        }\n@@ -442,0 +266,50 @@\n+    \/**\n+     * Encodes the \"to-be-signed\" CRL to the OutputStream.\n+     *\n+     * @param out the OutputStream to write to.\n+     * @exception CRLException on encoding errors.\n+     *\/\n+    public void encodeInfo(OutputStream out) throws CRLException {\n+        try {\n+            DerOutputStream tmp = new DerOutputStream();\n+            DerOutputStream rCerts = new DerOutputStream();\n+            DerOutputStream seq = new DerOutputStream();\n+\n+            if (version != 0) \/\/ v2 crl encode version\n+                tmp.putInteger(version);\n+            infoSigAlgId.encode(tmp);\n+            if ((version == 0) && (issuer.toString() == null))\n+                throw new CRLException(\"Null Issuer DN not allowed in v1 CRL\");\n+            issuer.encode(tmp);\n+\n+            if (thisUpdate.getTime() < CertificateValidity.YR_2050)\n+                tmp.putUTCTime(thisUpdate);\n+            else\n+                tmp.putGeneralizedTime(thisUpdate);\n+\n+            if (nextUpdate != null) {\n+                if (nextUpdate.getTime() < CertificateValidity.YR_2050)\n+                    tmp.putUTCTime(nextUpdate);\n+                else\n+                    tmp.putGeneralizedTime(nextUpdate);\n+            }\n+\n+            if (!revokedList.isEmpty()) {\n+                for (X509CRLEntry entry : revokedList) {\n+                    ((X509CRLEntryImpl)entry).encode(rCerts);\n+                }\n+                tmp.write(DerValue.tag_Sequence, rCerts);\n+            }\n+\n+            if (extensions != null)\n+                extensions.encode(tmp, isExplicit);\n+\n+            seq.write(DerValue.tag_Sequence, tmp);\n+\n+            tbsCertList = seq.toByteArray();\n+            out.write(tbsCertList);\n+        } catch (IOException e) {\n+             throw new CRLException(\"Encoding error: \" + e.getMessage());\n+        }\n+    }\n+\n@@ -491,0 +365,3 @@\n+        if (signedCRL == null) {\n+            throw new CRLException(\"Uninitialized CRL\");\n+        }\n@@ -541,0 +418,3 @@\n+        if (signedCRL == null) {\n+            throw new CRLException(\"Uninitialized CRL\");\n+        }\n@@ -571,1 +451,1 @@\n-     * Creates a new X.509 CRL, which is signed using the given key.\n+     * Encodes an X.509 CRL, and signs it using the given key.\n@@ -573,1 +453,0 @@\n-     * @param info the TBSCertList to sign\n@@ -576,1 +455,0 @@\n-     * @return a newly signed CRL\n@@ -584,1 +462,1 @@\n-    public static X509CRLImpl newSigned(TBSCertList info, PrivateKey key, String algorithm)\n+    public void sign(PrivateKey key, String algorithm)\n@@ -587,1 +465,1 @@\n-        return newSigned(info, key, algorithm, null);\n+        sign(key, algorithm, null);\n@@ -591,1 +469,1 @@\n-     * Creates a new X.509 CRL, which is signed using the given key.\n+     * Encodes an X.509 CRL, and signs it using the given key.\n@@ -593,1 +471,0 @@\n-     * @param info the TBSCertList to sign\n@@ -597,1 +474,0 @@\n-     * @return a newly signed CRL\n@@ -605,1 +481,1 @@\n-    public static X509CRLImpl newSigned(TBSCertList info, PrivateKey key, String algorithm, String provider)\n+    public void sign(PrivateKey key, String algorithm, String provider)\n@@ -609,0 +485,3 @@\n+            if (readOnly)\n+                throw new CRLException(\"cannot over-write existing CRL\");\n+\n@@ -610,2 +489,2 @@\n-            AlgorithmId sigAlgId = SignatureUtil.fromSignature(sigEngine, key);\n-            info.infoSigAlgId = sigAlgId;\n+            sigAlgId = SignatureUtil.fromSignature(sigEngine, key);\n+            infoSigAlgId = sigAlgId;\n@@ -617,2 +496,1 @@\n-            byte[] tbsCertList = info.encodeInfo();\n-            tmp.writeBytes(tbsCertList);\n+            encodeInfo(tmp);\n@@ -625,1 +503,1 @@\n-            byte[] signature = sigEngine.sign();\n+            signature = sigEngine.sign();\n@@ -630,1 +508,2 @@\n-            byte[] signedCRL = out.toByteArray();\n+            signedCRL = out.toByteArray();\n+            readOnly = true;\n@@ -632,2 +511,0 @@\n-            return new X509CRLImpl(info, sigAlgId, signature,\n-                    tbsCertList, signedCRL);\n@@ -653,1 +530,1 @@\n-            .append(info.version+1)\n+            .append(version+1)\n@@ -661,1 +538,1 @@\n-        if (info.issuer != null)\n+        if (issuer != null)\n@@ -663,1 +540,1 @@\n-                .append(info.issuer)\n+                .append(issuer)\n@@ -665,1 +542,1 @@\n-        if (info.thisUpdate != null)\n+        if (thisUpdate != null)\n@@ -667,1 +544,1 @@\n-                .append(info.thisUpdate)\n+                .append(thisUpdate)\n@@ -669,1 +546,1 @@\n-        if (info.nextUpdate != null)\n+        if (nextUpdate != null)\n@@ -671,1 +548,1 @@\n-                .append(info.nextUpdate)\n+                .append(nextUpdate)\n@@ -673,1 +550,1 @@\n-        if (info.revokedList.isEmpty())\n+        if (revokedList.isEmpty())\n@@ -677,1 +554,1 @@\n-                .append(info.revokedList.size());\n+                .append(revokedList.size());\n@@ -679,1 +556,1 @@\n-            for (X509CRLEntry entry: info.revokedList) {\n+            for (X509CRLEntry entry: revokedList) {\n@@ -686,2 +563,2 @@\n-        if (info.extensions != null) {\n-            Collection<Extension> allExts = info.extensions.getAllExtensions();\n+        if (extensions != null) {\n+            Collection<Extension> allExts = extensions.getAllExtensions();\n@@ -735,1 +612,1 @@\n-        if (info.revokedMap.isEmpty() ||\n+        if (revokedMap.isEmpty() ||\n@@ -740,1 +617,1 @@\n-        return info.revokedMap.containsKey(issuerSerial);\n+        return revokedMap.containsKey(issuerSerial);\n@@ -754,1 +631,1 @@\n-        return info.version+1;\n+        return version+1;\n@@ -787,1 +664,1 @@\n-        return info.issuer;\n+        return issuer;\n@@ -795,1 +672,4 @@\n-        return info.getIssuerX500Principal();\n+        if (issuerPrincipal == null) {\n+            issuerPrincipal = issuer.asX500Principal();\n+        }\n+        return issuerPrincipal;\n@@ -805,1 +685,1 @@\n-        return new Date(info.thisUpdate.getTime());\n+        return new Date(thisUpdate.getTime());\n@@ -815,1 +695,1 @@\n-        if (info.nextUpdate == null)\n+        if (nextUpdate == null)\n@@ -817,1 +697,1 @@\n-        return new Date(info.nextUpdate.getTime());\n+        return new Date(nextUpdate.getTime());\n@@ -828,1 +708,1 @@\n-        if (info.revokedMap.isEmpty()) {\n+        if (revokedMap.isEmpty()) {\n@@ -834,1 +714,1 @@\n-        return info.revokedMap.get(issuerSerial);\n+        return revokedMap.get(issuerSerial);\n@@ -841,1 +721,1 @@\n-        if (info.revokedMap.isEmpty()) {\n+        if (revokedMap.isEmpty()) {\n@@ -845,1 +725,1 @@\n-        return info.revokedMap.get(issuerSerial);\n+        return revokedMap.get(issuerSerial);\n@@ -857,1 +737,1 @@\n-        if (info.revokedList.isEmpty()) {\n+        if (revokedList.isEmpty()) {\n@@ -860,1 +740,1 @@\n-            return new TreeSet<>(info.revokedList);\n+            return new TreeSet<>(revokedList);\n@@ -1052,1 +932,1 @@\n-        if (info.extensions == null)\n+        if (extensions == null)\n@@ -1054,1 +934,1 @@\n-        return info.extensions.hasUnsupportedCriticalExtension();\n+        return extensions.hasUnsupportedCriticalExtension();\n@@ -1066,1 +946,1 @@\n-        if (info.extensions == null) {\n+        if (extensions == null) {\n@@ -1070,1 +950,1 @@\n-        for (Extension ex : info.extensions.getAllExtensions()) {\n+        for (Extension ex : extensions.getAllExtensions()) {\n@@ -1087,1 +967,1 @@\n-        if (info.extensions == null) {\n+        if (extensions == null) {\n@@ -1091,1 +971,1 @@\n-        for (Extension ex : info.extensions.getAllExtensions()) {\n+        for (Extension ex : extensions.getAllExtensions()) {\n@@ -1111,1 +991,1 @@\n-        if (info.extensions == null)\n+        if (extensions == null)\n@@ -1119,1 +999,1 @@\n-                for (Extension ex : info.extensions.getAllExtensions()) {\n+                for (Extension ex : extensions.getAllExtensions()) {\n@@ -1127,1 +1007,1 @@\n-                crlExt = info.extensions.getExtension(extAlias);\n+                crlExt = extensions.getExtension(extAlias);\n@@ -1148,1 +1028,1 @@\n-        if (info.extensions == null)\n+        if (extensions == null)\n@@ -1152,1 +1032,1 @@\n-        return info.extensions.getExtension(OIDMap.getName(oid));\n+        return extensions.getExtension(OIDMap.getName(oid));\n@@ -1159,0 +1039,3 @@\n+        \/\/ check if we can overwrite the certificate\n+        if (readOnly)\n+            throw new CRLException(\"cannot over-write existing CRL\");\n@@ -1174,1 +1057,2 @@\n-        info = new TBSCertList(seq[0]);\n+        if (seq[0].tag != DerValue.tag_Sequence)\n+            throw new CRLException(\"signed CRL fields invalid\");\n@@ -1177,5 +1061,0 @@\n-        \/\/ the \"inner\" and \"outer\" signature algorithms must match\n-        if (!sigAlgId.equals(info.infoSigAlgId)) {\n-            throw new CRLException(\"Signature algorithm mismatch\");\n-        }\n-\n@@ -1193,0 +1072,77 @@\n+        \/\/ parse the information\n+        DerInputStream derStrm = seq[0].data;\n+        DerValue       tmp;\n+        byte           nextByte;\n+\n+        \/\/ version (optional if v1)\n+        version = 0;   \/\/ by default, version = v1 == 0\n+        nextByte = (byte)derStrm.peekByte();\n+        if (nextByte == DerValue.tag_Integer) {\n+            version = derStrm.getInteger();\n+            if (version != 1)  \/\/ i.e. v2\n+                throw new CRLException(\"Invalid version\");\n+        }\n+        tmp = derStrm.getDerValue();\n+\n+        \/\/ signature\n+        AlgorithmId tmpId = AlgorithmId.parse(tmp);\n+\n+        \/\/ the \"inner\" and \"outer\" signature algorithms must match\n+        if (! tmpId.equals(sigAlgId))\n+            throw new CRLException(\"Signature algorithm mismatch\");\n+        infoSigAlgId = tmpId;\n+\n+        \/\/ issuer\n+        issuer = new X500Name(derStrm);\n+        if (issuer.isEmpty()) {\n+            throw new CRLException(\"Empty issuer DN not allowed in X509CRLs\");\n+        }\n+\n+        \/\/ thisUpdate\n+        \/\/ check if UTCTime encoded or GeneralizedTime\n+\n+        nextByte = (byte)derStrm.peekByte();\n+        if (nextByte == DerValue.tag_UtcTime) {\n+            thisUpdate = derStrm.getUTCTime();\n+        } else if (nextByte == DerValue.tag_GeneralizedTime) {\n+            thisUpdate = derStrm.getGeneralizedTime();\n+        } else {\n+            throw new CRLException(\"Invalid encoding for thisUpdate\"\n+                                   + \" (tag=\" + nextByte + \")\");\n+        }\n+\n+        if (derStrm.available() == 0)\n+           return;     \/\/ done parsing no more optional fields present\n+\n+        \/\/ nextUpdate (optional)\n+        nextByte = (byte)derStrm.peekByte();\n+        if (nextByte == DerValue.tag_UtcTime) {\n+            nextUpdate = derStrm.getUTCTime();\n+        } else if (nextByte == DerValue.tag_GeneralizedTime) {\n+            nextUpdate = derStrm.getGeneralizedTime();\n+        } \/\/ else it is not present\n+\n+        if (derStrm.available() == 0)\n+            return;     \/\/ done parsing no more optional fields present\n+\n+        \/\/ revokedCertificates (optional)\n+        nextByte = (byte)derStrm.peekByte();\n+        if ((nextByte == DerValue.tag_SequenceOf)\n+            && (! ((nextByte & 0x0c0) == 0x080))) {\n+            DerValue[] badCerts = derStrm.getSequence(4);\n+\n+            X500Principal crlIssuer = getIssuerX500Principal();\n+            X500Principal badCertIssuer = crlIssuer;\n+            for (int i = 0; i < badCerts.length; i++) {\n+                X509CRLEntryImpl entry = new X509CRLEntryImpl(badCerts[i]);\n+                badCertIssuer = getCertIssuer(entry, badCertIssuer);\n+                entry.setCertificateIssuer(crlIssuer, badCertIssuer);\n+                X509IssuerSerial issuerSerial = new X509IssuerSerial\n+                    (badCertIssuer, entry.getSerialNumber());\n+                revokedMap.put(issuerSerial, entry);\n+                revokedList.add(entry);\n+            }\n+        }\n+\n+        if (derStrm.available() == 0)\n+            return;     \/\/ done parsing no extensions\n@@ -1194,0 +1150,6 @@\n+        \/\/ crlExtensions (optional)\n+        tmp = derStrm.getDerValue();\n+        if (tmp.isConstructed() && tmp.isContextSpecific((byte)0)) {\n+            extensions = new CRLExtensions(tmp.data);\n+        }\n+        readOnly = true;\n@@ -1253,0 +1215,22 @@\n+    \/**\n+     * Returns the X500 certificate issuer DN of a CRL entry.\n+     *\n+     * @param entry the entry to check\n+     * @param prevCertIssuer the previous entry's certificate issuer\n+     * @return the X500Principal in a CertificateIssuerExtension, or\n+     *   prevCertIssuer if it does not exist\n+     *\/\n+    private X500Principal getCertIssuer(X509CRLEntryImpl entry,\n+        X500Principal prevCertIssuer) {\n+\n+        CertificateIssuerExtension ciExt =\n+            entry.getCertificateIssuerExtension();\n+        if (ciExt != null) {\n+            GeneralNames names = ciExt.getNames();\n+            X500Name issuerDN = (X500Name) names.get(0).getName();\n+            return issuerDN.asX500Principal();\n+        } else {\n+            return prevCertIssuer;\n+        }\n+    }\n+\n@@ -1254,1 +1238,3 @@\n-    public void encode(DerOutputStream out) throws IOException {\n+    public void derEncode(DerOutputStream out) throws IOException {\n+        if (signedCRL == null)\n+            throw new IOException(\"Null CRL to encode\");\n","filename":"src\/java.base\/share\/classes\/sun\/security\/x509\/X509CRLImpl.java","additions":313,"deletions":327,"binary":false,"changes":640,"status":"modified"},{"patch":"@@ -28,1 +28,7 @@\n-import java.io.*;\n+import java.io.BufferedReader;\n+import java.io.BufferedInputStream;\n+import java.io.ByteArrayOutputStream;\n+import java.io.IOException;\n+import java.io.InputStream;\n+import java.io.InputStreamReader;\n+import java.io.OutputStream;\n@@ -77,0 +83,4 @@\n+    \/\/ when we sign and decode we set this to true\n+    \/\/ this is our means to make certificates immutable\n+    private boolean readOnly = false;\n+\n@@ -118,2 +128,1 @@\n-     * Constructor simply setting all (non-cache) fields. Only used in\n-     * {@link #newSigned}.\n+     * Default constructor.\n@@ -121,7 +130,1 @@\n-    public X509CertImpl(X509CertInfo info, AlgorithmId algId, byte[] signature,\n-                        byte[] signedCert) {\n-        this.info = info;\n-        this.algId = algId;\n-        this.signature = signature;\n-        this.signedCert = Objects.requireNonNull(signedCert);\n-    }\n+    public X509CertImpl() { }\n@@ -145,0 +148,1 @@\n+            signedCert = null;\n@@ -150,17 +154,1 @@\n-     * Unmarshals a certificate from its encoded form, parsing a DER value.\n-     * This form of constructor is used by agents which need to examine\n-     * and use certificate contents.\n-     *\n-     * @param derVal the der value containing the encoded cert.\n-     * @exception CertificateException on parsing and initialization errors.\n-     *\/\n-    public X509CertImpl(DerValue derVal) throws CertificateException {\n-        try {\n-            parse(derVal);\n-        } catch (IOException e) {\n-            throw new CertificateException(\"Unable to initialize, \" + e, e);\n-        }\n-    }\n-\n-    \/**\n-     * Unmarshals an X.509 certificate from an input stream.  If the\n+     * unmarshals an X.509 certificate from an input stream.  If the\n@@ -251,0 +239,31 @@\n+    \/**\n+     * Construct an initialized X509 Certificate. The certificate is stored\n+     * in raw form and has to be signed to be useful.\n+     *\n+     * The ALGORITHM_ID attribute will be rewritten when signed. The initial\n+     * value is ignored.\n+     *\n+     * @param certInfo the X509CertificateInfo which the Certificate is to be\n+     *             created from.\n+     *\/\n+    public X509CertImpl(X509CertInfo certInfo) {\n+        this.info = certInfo;\n+    }\n+\n+    \/**\n+     * Unmarshal a certificate from its encoded form, parsing a DER value.\n+     * This form of constructor is used by agents which need to examine\n+     * and use certificate contents.\n+     *\n+     * @param derVal the der value containing the encoded cert.\n+     * @exception CertificateException on parsing and initialization errors.\n+     *\/\n+    public X509CertImpl(DerValue derVal) throws CertificateException {\n+        try {\n+            parse(derVal);\n+        } catch (IOException e) {\n+            signedCert = null;\n+            throw new CertificateException(\"Unable to initialize, \" + e, e);\n+        }\n+    }\n+\n@@ -258,0 +277,18 @@\n+    \/**\n+     * Appends the certificate to an output stream.\n+     *\n+     * @param out an input stream to which the certificate is appended.\n+     * @exception CertificateEncodingException on encoding errors.\n+     *\/\n+    public void encode(OutputStream out)\n+    throws CertificateEncodingException {\n+        if (signedCert == null)\n+            throw new CertificateEncodingException(\n+                          \"Null certificate to encode\");\n+        try {\n+            out.write(signedCert.clone());\n+        } catch (IOException e) {\n+            throw new CertificateEncodingException(e.toString());\n+        }\n+    }\n+\n@@ -266,2 +303,3 @@\n-    @Override\n-    public void encode(DerOutputStream out) throws IOException {\n+    public void derEncode(DerOutputStream out) throws IOException {\n+        if (signedCert == null)\n+            throw new IOException(\"Null certificate to encode\");\n@@ -289,0 +327,4 @@\n+        if (signedCert == null) {\n+            throw new CertificateEncodingException(\n+                          \"Null certificate to encode\");\n+        }\n@@ -346,0 +388,3 @@\n+        if (signedCert == null) {\n+            throw new CertificateEncodingException(\"Uninitialized certificate\");\n+        }\n@@ -397,0 +442,3 @@\n+        if (signedCert == null) {\n+            throw new CertificateEncodingException(\"Uninitialized certificate\");\n+        }\n@@ -428,1 +476,1 @@\n-     * Creates a new X.509 certificate, which is signed using the given key\n+     * Creates an X.509 certificate, and signs it using the given key\n@@ -433,1 +481,0 @@\n-     * @param info the X509CertInfo to sign\n@@ -436,1 +483,0 @@\n-     * @return the newly signed certificate\n@@ -444,1 +490,1 @@\n-    public static X509CertImpl newSigned(X509CertInfo info, PrivateKey key, String algorithm)\n+    public void sign(PrivateKey key, String algorithm)\n@@ -447,1 +493,1 @@\n-        return newSigned(info, key, algorithm, null);\n+        sign(key, algorithm, null);\n@@ -451,1 +497,1 @@\n-     * Creates a new X.509 certificate, which is signed using the given key\n+     * Creates an X.509 certificate, and signs it using the given key\n@@ -456,1 +502,0 @@\n-     * @param info the X509CertInfo to sign\n@@ -460,1 +505,0 @@\n-     * @return the newly signed certificate\n@@ -468,1 +512,1 @@\n-    public static X509CertImpl newSigned(X509CertInfo info, PrivateKey key, String algorithm, String provider)\n+    public void sign(PrivateKey key, String algorithm, String provider)\n@@ -472,0 +516,4 @@\n+            if (readOnly) {\n+                throw new CertificateEncodingException(\n+                        \"cannot over-write existing certificate\");\n+            }\n@@ -474,1 +522,1 @@\n-            AlgorithmId algId = SignatureUtil.fromSignature(sigEngine, key);\n+            algId = SignatureUtil.fromSignature(sigEngine, key);\n@@ -489,1 +537,1 @@\n-            byte[] signature = sigEngine.sign();\n+            signature = sigEngine.sign();\n@@ -494,1 +542,2 @@\n-            byte[] signedCert = out.toByteArray();\n+            signedCert = out.toByteArray();\n+            readOnly = true;\n@@ -496,1 +545,0 @@\n-            return new X509CertImpl(info, algId, signature, signedCert);\n@@ -1133,1 +1181,1 @@\n-        if (extKeyUsage != null) {\n+        if (readOnly && extKeyUsage != null) {\n@@ -1324,1 +1372,1 @@\n-        if (subjectAlternativeNames != null) {\n+        if (readOnly && subjectAlternativeNames != null)  {\n@@ -1376,1 +1424,1 @@\n-        if (issuerAlternativeNames != null) {\n+        if (readOnly && issuerAlternativeNames != null) {\n@@ -1436,1 +1484,1 @@\n-            throws CertificateException, IOException {\n+    throws CertificateException, IOException {\n@@ -1438,0 +1486,3 @@\n+        if (readOnly)\n+            throw new CertificateParsingException(\n+                      \"cannot over-write existing certificate\");\n@@ -1474,0 +1525,1 @@\n+        readOnly = true;\n","filename":"src\/java.base\/share\/classes\/sun\/security\/x509\/X509CertImpl.java","additions":98,"deletions":46,"binary":false,"changes":144,"status":"modified"},{"patch":"@@ -61,1 +61,1 @@\n- * @see DerEncoder\n+ * @see CertAttrSet\n","filename":"src\/java.base\/share\/classes\/sun\/security\/x509\/X509CertInfo.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -28,3 +28,0 @@\n-# Properties in this file are typically parsed only once. If any of the\n-# properties are modified, applications should be restarted to ensure the\n-# changes are properly reflected.\n","filename":"src\/java.base\/share\/conf\/security\/java.security","additions":0,"deletions":3,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -1,1 +1,1 @@\n-File-Date: 2022-08-08\n+File-Date: 2022-03-02\n@@ -46973,1 +46973,0 @@\n-Description: Türkiye\n@@ -47770,13 +47769,0 @@\n-Subtag: ltg1929\n-Description: The Latgalian language orthography codified in 1929\n-Added: 2022-08-05\n-Prefix: ltg\n-%%\n-Type: variant\n-Subtag: ltg2007\n-Description: The Latgalian language orthography codified in the language\n-  law in 2007\n-Added: 2022-06-23\n-Prefix: ltg\n-%%\n-Type: variant\n","filename":"src\/java.base\/share\/data\/lsrdata\/language-subtag-registry.txt","additions":1,"deletions":15,"binary":false,"changes":16,"status":"modified"},{"patch":"@@ -22,2 +22,2 @@\n-'\\\" t\n-.\\\" Automatically generated by Pandoc 2.19.2\n+.\\\"t\n+.\\\" Automatically generated by Pandoc 2.3.1\n@@ -25,15 +25,1 @@\n-.\\\" Define V font for inline verbatim, using C font in formats\n-.\\\" that render this, and otherwise B font.\n-.ie \"\\f[CB]x\\f[R]\"x\" \\{\\\n-. ftr V B\n-. ftr VI BI\n-. ftr VB B\n-. ftr VBI BI\n-.\\}\n-.el \\{\\\n-. ftr V CR\n-. ftr VI CI\n-. ftr VB CB\n-. ftr VBI CBI\n-.\\}\n-.TH \"JAVA\" \"1\" \"2023\" \"JDK 20-ea\" \"JDK Commands\"\n+.TH \"JAVA\" \"1\" \"2023\" \"JDK 20\\-ea\" \"JDK Commands\"\n@@ -43,1 +29,1 @@\n-java - launch a Java application\n+java \\- launch a Java application\n@@ -48,2 +34,1 @@\n-\\f[V]java\\f[R] [\\f[I]options\\f[R]] \\f[I]mainclass\\f[R] [\\f[I]args\\f[R]\n-\\&...]\n+\\f[CB]java\\f[R] [\\f[I]options\\f[R]] \\f[I]mainclass\\f[R] [\\f[I]args\\f[R] ...]\n@@ -53,1 +38,1 @@\n-\\f[V]java\\f[R] [\\f[I]options\\f[R]] \\f[V]-jar\\f[R] \\f[I]jarfile\\f[R]\n+\\f[CB]java\\f[R] [\\f[I]options\\f[R]] \\f[CB]\\-jar\\f[R] \\f[I]jarfile\\f[R]\n@@ -58,2 +43,2 @@\n-\\f[V]java\\f[R] [\\f[I]options\\f[R]] \\f[V]-m\\f[R]\n-\\f[I]module\\f[R][\\f[V]\/\\f[R]\\f[I]mainclass\\f[R]] [\\f[I]args\\f[R] ...]\n+\\f[CB]java\\f[R] [\\f[I]options\\f[R]] \\f[CB]\\-m\\f[R]\n+\\f[I]module\\f[R][\\f[CB]\/\\f[R]\\f[I]mainclass\\f[R]] [\\f[I]args\\f[R] ...]\n@@ -63,2 +48,2 @@\n-\\f[V]java\\f[R] [\\f[I]options\\f[R]] \\f[V]--module\\f[R]\n-\\f[I]module\\f[R][\\f[V]\/\\f[R]\\f[I]mainclass\\f[R]] [\\f[I]args\\f[R] ...]\n+\\f[CB]java\\f[R] [\\f[I]options\\f[R]] \\f[CB]\\-\\-module\\f[R]\n+\\f[I]module\\f[R][\\f[CB]\/\\f[R]\\f[I]mainclass\\f[R]] [\\f[I]args\\f[R] ...]\n@@ -66,1 +51,1 @@\n-To launch a single source-file program:\n+To launch a single source\\-file program:\n@@ -68,1 +53,1 @@\n-\\f[V]java\\f[R] [\\f[I]options\\f[R]] \\f[I]source-file\\f[R] [\\f[I]args\\f[R]\n+\\f[CB]java\\f[R] [\\f[I]options\\f[R]] \\f[I]source\\-file\\f[R] [\\f[I]args\\f[R]\n@@ -71,2 +56,2 @@\n-\\f[I]options\\f[R]\n-Optional: Specifies command-line options separated by spaces.\n+.B \\f[I]options\\f[R]\n+Optional: Specifies command\\-line options separated by spaces.\n@@ -75,0 +60,2 @@\n+.RS\n+.RE\n@@ -76,1 +63,1 @@\n-\\f[I]mainclass\\f[R]\n+.B \\f[I]mainclass\\f[R]\n@@ -78,1 +65,1 @@\n-Command-line entries following \\f[V]classname\\f[R] are the arguments for\n+Command\\-line entries following \\f[CB]classname\\f[R] are the arguments for\n@@ -80,0 +67,2 @@\n+.RS\n+.RE\n@@ -81,1 +70,1 @@\n-\\f[V]-jar\\f[R] \\f[I]jarfile\\f[R]\n+.B \\f[CB]\\-jar\\f[R] \\f[I]jarfile\\f[R]\n@@ -84,5 +73,5 @@\n-that contains a line in the form\n-\\f[V]Main-Class:\\f[R]\\f[I]classname\\f[R] that defines the class with the\n-\\f[V]public static void main(String[] args)\\f[R] method that serves as\n-your application\\[aq]s starting point.\n-When you use \\f[V]-jar\\f[R], the specified JAR file is the source of all\n+that contains a line in the form \\f[CB]Main\\-Class:\\f[R]\\f[I]classname\\f[R]\n+that defines the class with the\n+\\f[CB]public\\ static\\ void\\ main(String[]\\ args)\\f[R] method that serves\n+as your application\\[aq]s starting point.\n+When you use \\f[CB]\\-jar\\f[R], the specified JAR file is the source of all\n@@ -91,0 +80,2 @@\n+.RS\n+.RE\n@@ -92,1 +83,1 @@\n-\\f[V]-m\\f[R] or \\f[V]--module\\f[R] \\f[I]module\\f[R][\\f[V]\/\\f[R]\\f[I]mainclass\\f[R]]\n+.B \\f[CB]\\-m\\f[R] or \\f[CB]\\-\\-module\\f[R] \\f[I]module\\f[R][\\f[CB]\/\\f[R]\\f[I]mainclass\\f[R]]\n@@ -102,2 +93,2 @@\n-\\f[I]source-file\\f[R]\n-Only used to launch a single source-file program.\n+.B \\f[I]source\\-file\\f[R]\n+Only used to launch a single source\\-file program.\n@@ -105,2 +96,2 @@\n-source-file mode.\n-See \\f[B]Using Source-File Mode to Launch Single-File Source-Code\n+source\\-file mode.\n+See \\f[B]Using Source\\-File Mode to Launch Single\\-File Source\\-Code\n@@ -108,0 +99,2 @@\n+.RS\n+.RE\n@@ -109,6 +102,7 @@\n-\\f[I]args\\f[R] ...\n-Optional: Arguments following \\f[I]mainclass\\f[R],\n-\\f[I]source-file\\f[R], \\f[V]-jar\\f[R] \\f[I]jarfile\\f[R], and\n-\\f[V]-m\\f[R] or \\f[V]--module\\f[R]\n-\\f[I]module\\f[R]\\f[V]\/\\f[R]\\f[I]mainclass\\f[R] are passed as arguments\n-to the main class.\n+.B \\f[I]args\\f[R] ...\n+Optional: Arguments following \\f[I]mainclass\\f[R], \\f[I]source\\-file\\f[R],\n+\\f[CB]\\-jar\\f[R] \\f[I]jarfile\\f[R], and \\f[CB]\\-m\\f[R] or \\f[CB]\\-\\-module\\f[R]\n+\\f[I]module\\f[R]\\f[CB]\/\\f[R]\\f[I]mainclass\\f[R] are passed as arguments to\n+the main class.\n+.RS\n+.RE\n@@ -117,1 +111,1 @@\n-The \\f[V]java\\f[R] command starts a Java application.\n+The \\f[CB]java\\f[R] command starts a Java application.\n@@ -119,4 +113,4 @@\n-specified class, and calling that class\\[aq]s \\f[V]main()\\f[R] method.\n-The method must be declared \\f[V]public\\f[R] and \\f[V]static\\f[R], it\n-must not return any value, and it must accept a \\f[V]String\\f[R] array\n-as a parameter.\n+specified class, and calling that class\\[aq]s \\f[CB]main()\\f[R] method.\n+The method must be declared \\f[CB]public\\f[R] and \\f[CB]static\\f[R], it must\n+not return any value, and it must accept a \\f[CB]String\\f[R] array as a\n+parameter.\n@@ -126,1 +120,1 @@\n-\\f[V]public static void main(String[] args)\\f[R]\n+\\f[CB]public\\ static\\ void\\ main(String[]\\ args)\\f[R]\n@@ -129,1 +123,1 @@\n-In source-file mode, the \\f[V]java\\f[R] command can launch a class\n+In source\\-file mode, the \\f[CB]java\\f[R] command can launch a class\n@@ -131,2 +125,2 @@\n-See \\f[B]Using Source-File Mode to Launch Single-File Source-Code\n-Programs\\f[R] for a description of using the source-file mode.\n+See \\f[B]Using Source\\-File Mode to Launch Single\\-File Source\\-Code\n+Programs\\f[R] for a description of using the source\\-file mode.\n@@ -135,1 +129,1 @@\n-\\f[B]Note:\\f[R] You can use the \\f[V]JDK_JAVA_OPTIONS\\f[R] launcher\n+\\f[B]Note:\\f[R] You can use the \\f[CB]JDK_JAVA_OPTIONS\\f[R] launcher\n@@ -137,1 +131,1 @@\n-of the \\f[V]java\\f[R] launcher.\n+of the \\f[CB]java\\f[R] launcher.\n@@ -142,1 +136,1 @@\n-\\f[V]java\\f[R] command is the fully qualified name of the class to be\n+\\f[CB]java\\f[R] command is the fully qualified name of the class to be\n@@ -144,1 +138,1 @@\n-If \\f[V]-jar\\f[R] is specified, then its argument is the name of the JAR\n+If \\f[CB]\\-jar\\f[R] is specified, then its argument is the name of the JAR\n@@ -146,1 +140,1 @@\n-The startup class must be indicated by the \\f[V]Main-Class\\f[R] manifest\n+The startup class must be indicated by the \\f[CB]Main\\-Class\\f[R] manifest\n@@ -150,2 +144,2 @@\n-the \\f[V]main()\\f[R] method.\n-.SS \\f[V]javaw\\f[R]\n+the \\f[CB]main()\\f[R] method.\n+.SS \\f[CB]javaw\\f[R]\n@@ -153,4 +147,4 @@\n-\\f[B]Windows:\\f[R] The \\f[V]javaw\\f[R] command is identical to\n-\\f[V]java\\f[R], except that with \\f[V]javaw\\f[R] there\\[aq]s no\n-associated console window.\n-Use \\f[V]javaw\\f[R] when you don\\[aq]t want a command prompt window to\n+\\f[B]Windows:\\f[R] The \\f[CB]javaw\\f[R] command is identical to\n+\\f[CB]java\\f[R], except that with \\f[CB]javaw\\f[R] there\\[aq]s no associated\n+console window.\n+Use \\f[CB]javaw\\f[R] when you don\\[aq]t want a command prompt window to\n@@ -158,1 +152,1 @@\n-The \\f[V]javaw\\f[R] launcher will, however, display a dialog box with\n+The \\f[CB]javaw\\f[R] launcher will, however, display a dialog box with\n@@ -160,1 +154,1 @@\n-.SH USING SOURCE-FILE MODE TO LAUNCH SINGLE-FILE SOURCE-CODE PROGRAMS\n+.SH USING SOURCE\\-FILE MODE TO LAUNCH SINGLE\\-FILE SOURCE\\-CODE PROGRAMS\n@@ -162,4 +156,4 @@\n-To launch a class declared in a source file, run the \\f[V]java\\f[R]\n-launcher in source-file mode.\n-Entering source-file mode is determined by two items on the\n-\\f[V]java\\f[R] command line:\n+To launch a class declared in a source file, run the \\f[CB]java\\f[R]\n+launcher in source\\-file mode.\n+Entering source\\-file mode is determined by two items on the\n+\\f[CB]java\\f[R] command line:\n@@ -172,1 +166,1 @@\n-The \\f[V]--source\\f[R] \\f[I]version\\f[R] option, if present.\n+The \\f[CB]\\-\\-source\\f[R] \\f[I]version\\f[R] option, if present.\n@@ -174,3 +168,3 @@\n-If the class identifies an existing file that has a \\f[V].java\\f[R]\n-extension, or if the \\f[V]--source\\f[R] option is specified, then\n-source-file mode is selected.\n+If the class identifies an existing file that has a \\f[CB]\\&.java\\f[R]\n+extension, or if the \\f[CB]\\-\\-source\\f[R] option is specified, then\n+source\\-file mode is selected.\n@@ -178,1 +172,1 @@\n-The \\f[V]--source\\f[R] option can be used to specify the source\n+The \\f[CB]\\-\\-source\\f[R] option can be used to specify the source\n@@ -181,1 +175,1 @@\n-When you set \\f[V]--source\\f[R] \\f[I]N\\f[R], you can only use the public\n+When you set \\f[CB]\\-\\-source\\f[R] \\f[I]N\\f[R], you can only use the public\n@@ -187,2 +181,2 @@\n-You\\[aq]ll get an error message if you use a value of \\f[I]N\\f[R] that\n-is no longer supported.\n+You\\[aq]ll get an error message if you use a value of \\f[I]N\\f[R] that is\n+no longer supported.\n@@ -190,3 +184,3 @@\n-(\\f[V]20\\f[R]) and a limited number of previous releases, detailed in\n-the command-line help for \\f[V]javac\\f[R], under the \\f[V]--source\\f[R]\n-and \\f[V]--release\\f[R] options.\n+(\\f[CB]20\\f[R]) and a limited number of previous releases, detailed in the\n+command\\-line help for \\f[CB]javac\\f[R], under the \\f[CB]\\-\\-source\\f[R] and\n+\\f[CB]\\-\\-release\\f[R] options.\n@@ -195,6 +189,6 @@\n-If the file does not have the \\f[V].java\\f[R] extension, the\n-\\f[V]--source\\f[R] option must be used to tell the \\f[V]java\\f[R]\n-command to use the source-file mode.\n-The \\f[V]--source\\f[R] option is used for cases when the source file is\n-a \\[dq]script\\[dq] to be executed and the name of the source file does\n-not follow the normal naming conventions for Java source files.\n+If the file does not have the \\f[CB]\\&.java\\f[R] extension, the\n+\\f[CB]\\-\\-source\\f[R] option must be used to tell the \\f[CB]java\\f[R]\n+command to use the source\\-file mode.\n+The \\f[CB]\\-\\-source\\f[R] option is used for cases when the source file is\n+a \"script\" to be executed and the name of the source file does not\n+follow the normal naming conventions for Java source files.\n@@ -202,2 +196,3 @@\n-In source-file mode, the effect is as though the source file is compiled\n-into memory, and the first class found in the source file is executed.\n+In source\\-file mode, the effect is as though the source file is\n+compiled into memory, and the first class found in the source file is\n+executed.\n@@ -207,3 +202,3 @@\n-For example, if a file were named \\f[V]HelloWorld.java\\f[R] and\n-contained a class named \\f[V]hello.World\\f[R], then the source-file mode\n-command to launch the class would be:\n+For example, if a file were named \\f[CB]HelloWorld.java\\f[R] and contained\n+a class named \\f[CB]hello.World\\f[R], then the source\\-file mode command\n+to launch the class would be:\n@@ -212,1 +207,1 @@\n-\\f[V]java HelloWorld.java\\f[R]\n+\\f[CB]java\\ HelloWorld.java\\f[R]\n@@ -217,2 +212,2 @@\n-This use of source-file mode is informally equivalent to using the\n-following two commands where \\f[V]hello.World\\f[R] is the name of the\n+This use of source\\-file mode is informally equivalent to using the\n+following two commands where \\f[CB]hello.World\\f[R] is the name of the\n@@ -223,2 +218,2 @@\n-javac -d <memory> HelloWorld.java\n-java -cp <memory> hello.World\n+javac\\ \\-d\\ <memory>\\ HelloWorld.java\n+java\\ \\-cp\\ <memory>\\ hello.World\n@@ -228,1 +223,1 @@\n-\\f[B]In source-file mode, any additional command-line options are\n+\\f[B]In source\\-file mode, any additional command\\-line options are\n@@ -235,6 +230,7 @@\n-This includes: \\f[V]--class-path\\f[R], \\f[V]--module-path\\f[R],\n-\\f[V]--add-exports\\f[R], \\f[V]--add-modules\\f[R],\n-\\f[V]--limit-modules\\f[R], \\f[V]--patch-module\\f[R],\n-\\f[V]--upgrade-module-path\\f[R], and any variant forms of those options.\n-It also includes the new \\f[V]--enable-preview\\f[R] option, described in\n-JEP 12.\n+This includes: \\f[CB]\\-\\-class\\-path\\f[R], \\f[CB]\\-\\-module\\-path\\f[R],\n+\\f[CB]\\-\\-add\\-exports\\f[R], \\f[CB]\\-\\-add\\-modules\\f[R],\n+\\f[CB]\\-\\-limit\\-modules\\f[R], \\f[CB]\\-\\-patch\\-module\\f[R],\n+\\f[CB]\\-\\-upgrade\\-module\\-path\\f[R], and any variant forms of those\n+options.\n+It also includes the new \\f[CB]\\-\\-enable\\-preview\\f[R] option, described\n+in JEP 12.\n@@ -244,1 +240,1 @@\n-such as \\f[V]-processor\\f[R] or \\f[V]-Werror\\f[R].\n+such as \\f[CB]\\-processor\\f[R] or \\f[CB]\\-Werror\\f[R].\n@@ -246,1 +242,1 @@\n-Command-line argument files (\\f[V]\\[at]\\f[R]-files) may be used in the\n+Command\\-line argument files (\\f[CB]\\@\\f[R]\\-files) may be used in the\n@@ -249,2 +245,2 @@\n-may be placed in files specified on the command-line by prefixing the\n-filename with an \\f[V]\\[at]\\f[R] character.\n+may be placed in files specified on the command\\-line by prefixing the\n+filename with an \\f[CB]\\@\\f[R] character.\n@@ -252,1 +248,1 @@\n-\\f[B]In source-file mode, compilation proceeds as follows:\\f[R]\n+\\f[B]In source\\-file mode, compilation proceeds as follows:\\f[R]\n@@ -254,1 +250,1 @@\n-Any command-line options that are relevant to the compilation\n+Any command\\-line options that are relevant to the compilation\n@@ -260,1 +256,1 @@\n-Annotation processing is disabled, as if \\f[V]-proc:none\\f[R] is in\n+Annotation processing is disabled, as if \\f[CB]\\-proc:none\\f[R] is in\n@@ -263,2 +259,2 @@\n-If a version is specified, via the \\f[V]--source\\f[R] option, the value\n-is used as the argument for an implicit \\f[V]--release\\f[R] option for\n+If a version is specified, via the \\f[CB]\\-\\-source\\f[R] option, the value\n+is used as the argument for an implicit \\f[CB]\\-\\-release\\f[R] option for\n@@ -271,1 +267,1 @@\n-The source file should contain one or more top-level classes, the first\n+The source file should contain one or more top\\-level classes, the first\n@@ -277,1 +273,1 @@\n-\\f[V].java\\f[R] extension.\n+\\f[CB]\\&.java\\f[R] extension.\n@@ -281,1 +277,1 @@\n-non-zero exit code.\n+non\\-zero exit code.\n@@ -283,1 +279,1 @@\n-\\f[B]In source-file mode, execution proceeds as follows:\\f[R]\n+\\f[B]In source\\-file mode, execution proceeds as follows:\\f[R]\n@@ -285,1 +281,1 @@\n-The class to be executed is the first top-level class found in the\n+The class to be executed is the first top\\-level class found in the\n@@ -288,1 +284,1 @@\n-\\f[V]public static void main(String[])\\f[R] method.\n+\\f[CB]public\\ static\\ void\\ main(String[])\\f[R] method.\n@@ -296,3 +292,3 @@\n-as though \\f[V]--add-modules=ALL-DEFAULT\\f[R] is in effect.\n-This is in addition to any other \\f[V]--add-module\\f[R] options that may\n-be have been specified on the command line.\n+as though \\f[CB]\\-\\-add\\-modules=ALL\\-DEFAULT\\f[R] is in effect.\n+This is in addition to any other \\f[CB]\\-\\-add\\-module\\f[R] options that\n+may be have been specified on the command line.\n@@ -306,1 +302,1 @@\n-See \\f[B]JEP 330: Launch Single-File Source-Code Programs\\f[R]\n+See \\f[B]JEP 330: Launch Single\\-File Source\\-Code Programs\\f[R]\n@@ -310,1 +306,1 @@\n-\\f[V]JDK_JAVA_OPTIONS\\f[R] prepends its content to the options parsed\n+\\f[CB]JDK_JAVA_OPTIONS\\f[R] prepends its content to the options parsed\n@@ -312,3 +308,3 @@\n-The content of the \\f[V]JDK_JAVA_OPTIONS\\f[R] environment variable is a\n-list of arguments separated by white-space characters (as determined by\n-\\f[V]isspace()\\f[R]).\n+The content of the \\f[CB]JDK_JAVA_OPTIONS\\f[R] environment variable is a\n+list of arguments separated by white\\-space characters (as determined by\n+\\f[CB]isspace()\\f[R]).\n@@ -316,1 +312,1 @@\n-\\f[V]java\\f[R] launcher.\n+\\f[CB]java\\f[R] launcher.\n@@ -318,3 +314,3 @@\n-\\f[V]java\\f[R] command line on the system.\n-\\f[V]JDK_JAVA_OPTIONS\\f[R] environment variable content is treated in\n-the same manner as that specified in the command line.\n+\\f[CB]java\\f[R] command line on the system.\n+\\f[CB]JDK_JAVA_OPTIONS\\f[R] environment variable content is treated in the\n+same manner as that specified in the command line.\n@@ -322,2 +318,2 @@\n-Single (\\f[V]\\[aq]\\f[R]) or double (\\f[V]\\[dq]\\f[R]) quotes can be used\n-to enclose arguments that contain whitespace characters.\n+Single (\\f[CB]\\[aq]\\f[R]) or double (\\f[CB]\"\\f[R]) quotes can be used to\n+enclose arguments that contain whitespace characters.\n@@ -328,1 +324,1 @@\n-\\f[V]\\[at]\\f[R]-files are supported as they are specified in the command\n+\\f[CB]\\@\\f[R]\\-files are supported as they are specified in the command\n@@ -330,6 +326,5 @@\n-However, as in \\f[V]\\[at]\\f[R]-files, use of a wildcard is not\n-supported.\n-In order to mitigate potential misuse of \\f[V]JDK_JAVA_OPTIONS\\f[R]\n-behavior, options that specify the main class (such as \\f[V]-jar\\f[R])\n-or cause the \\f[V]java\\f[R] launcher to exit without executing the main\n-class (such as \\f[V]-h\\f[R]) are disallowed in the environment variable.\n+However, as in \\f[CB]\\@\\f[R]\\-files, use of a wildcard is not supported.\n+In order to mitigate potential misuse of \\f[CB]JDK_JAVA_OPTIONS\\f[R]\n+behavior, options that specify the main class (such as \\f[CB]\\-jar\\f[R])\n+or cause the \\f[CB]java\\f[R] launcher to exit without executing the main\n+class (such as \\f[CB]\\-h\\f[R]) are disallowed in the environment variable.\n@@ -338,1 +333,1 @@\n-When \\f[V]JDK_JAVA_OPTIONS\\f[R] is set, the launcher prints a message to\n+When \\f[CB]JDK_JAVA_OPTIONS\\f[R] is set, the launcher prints a message to\n@@ -345,2 +340,2 @@\n-$ export JDK_JAVA_OPTIONS=\\[aq]-g \\[at]file1 -Dprop=value \\[at]file2 -Dws.prop=\\[dq]white spaces\\[dq]\\[aq]\n-$ java -Xint \\[at]file3\n+$\\ export\\ JDK_JAVA_OPTIONS=\\[aq]\\-g\\ \\@file1\\ \\-Dprop=value\\ \\@file2\\ \\-Dws.prop=\"white\\ spaces\"\\[aq]\n+$\\ java\\ \\-Xint\\ \\@file3\n@@ -354,1 +349,1 @@\n-java -g \\[at]file1 -Dprop=value \\[at]file2 -Dws.prop=\\[dq]white spaces\\[dq] -Xint \\[at]file3\n+java\\ \\-g\\ \\@file1\\ \\-Dprop=value\\ \\@file2\\ \\-Dws.prop=\"white\\ spaces\"\\ \\-Xint\\ \\@file3\n@@ -359,1 +354,1 @@\n-The \\f[V]java\\f[R] command supports a wide range of options in the\n+The \\f[CB]java\\f[R] command supports a wide range of options in the\n@@ -371,1 +366,1 @@\n-These options start with \\f[V]-X\\f[R].\n+These options start with \\f[CB]\\-X\\f[R].\n@@ -382,1 +377,1 @@\n-Advanced options start with \\f[V]-XX\\f[R].\n+Advanced options start with \\f[CB]\\-XX\\f[R].\n@@ -384,2 +379,2 @@\n-\\f[B]Advanced Runtime Options for Java\\f[R]: Control the runtime\n-behavior of the Java HotSpot VM.\n+\\f[B]Advanced Runtime Options for Java\\f[R]: Control the runtime behavior\n+of the Java HotSpot VM.\n@@ -388,1 +383,1 @@\n-just-in-time (JIT) compilation performed by the Java HotSpot VM.\n+just\\-in\\-time (JIT) compilation performed by the Java HotSpot VM.\n@@ -399,3 +394,3 @@\n-Boolean \\f[V]-XX\\f[R] options are enabled using the plus sign\n-(\\f[V]-XX:+\\f[R]\\f[I]OptionName\\f[R]) and disabled using the minus sign\n-(\\f[V]-XX:-\\f[R]\\f[I]OptionName\\f[R]).\n+Boolean \\f[CB]\\-XX\\f[R] options are enabled using the plus sign\n+(\\f[CB]\\-XX:+\\f[R]\\f[I]OptionName\\f[R]) and disabled using the minus sign\n+(\\f[CB]\\-XX:\\-\\f[R]\\f[I]OptionName\\f[R]).\n@@ -408,3 +403,3 @@\n-suffix, or use the suffix \\f[V]k\\f[R] or \\f[V]K\\f[R] for kilobytes (KB),\n-\\f[V]m\\f[R] or \\f[V]M\\f[R] for megabytes (MB), or \\f[V]g\\f[R] or\n-\\f[V]G\\f[R] for gigabytes (GB).\n+suffix, or use the suffix \\f[CB]k\\f[R] or \\f[CB]K\\f[R] for kilobytes (KB),\n+\\f[CB]m\\f[R] or \\f[CB]M\\f[R] for megabytes (MB), or \\f[CB]g\\f[R] or \\f[CB]G\\f[R]\n+for gigabytes (GB).\n@@ -412,2 +407,2 @@\n-\\f[V]8g\\f[R], \\f[V]8192m\\f[R], \\f[V]8388608k\\f[R], or\n-\\f[V]8589934592\\f[R] as the argument.\n+\\f[CB]8g\\f[R], \\f[CB]8192m\\f[R], \\f[CB]8388608k\\f[R], or \\f[CB]8589934592\\f[R]\n+as the argument.\n@@ -416,1 +411,1 @@\n-For example, specify \\f[V]0.25\\f[R] for 25%.\n+For example, specify \\f[CB]0.25\\f[R] for 25%.\n@@ -421,2 +416,2 @@\n-\\f[B]Deprecated Java Options\\f[R]: Accepted and acted upon --- a warning\n-is issued when they\\[aq]re used.\n+\\f[B]Deprecated Java Options\\f[R]: Accepted and acted upon \\-\\-\\- a\n+warning is issued when they\\[aq]re used.\n@@ -424,1 +419,1 @@\n-\\f[B]Obsolete Java Options\\f[R]: Accepted but ignored --- a warning is\n+\\f[B]Obsolete Java Options\\f[R]: Accepted but ignored \\-\\-\\- a warning is\n@@ -427,1 +422,1 @@\n-\\f[B]Removed Java Options\\f[R]: Removed --- using them results in an\n+\\f[B]Removed Java Options\\f[R]: Removed \\-\\-\\- using them results in an\n@@ -436,2 +431,2 @@\n-either \\f[V]--\\f[R]\\f[I]name\\f[R]\\f[V]=\\f[R]\\f[I]value\\f[R] or\n-\\f[V]--\\f[R]\\f[I]name\\f[R] \\f[I]value\\f[R].\n+either \\f[CB]\\-\\-\\f[R]\\f[I]name\\f[R]\\f[CB]=\\f[R]\\f[I]value\\f[R] or\n+\\f[CB]\\-\\-\\f[R]\\f[I]name\\f[R] \\f[I]value\\f[R].\n@@ -440,1 +435,1 @@\n-\\f[V]-agentlib:\\f[R]\\f[I]libname\\f[R][\\f[V]=\\f[R]\\f[I]options\\f[R]]\n+.B \\f[CB]\\-agentlib:\\f[R]\\f[I]libname\\f[R][\\f[CB]=\\f[R]\\f[I]options\\f[R]]\n@@ -442,1 +437,1 @@\n-After the library name, a comma-separated list of options specific to\n+After the library name, a comma\\-separated list of options specific to\n@@ -446,1 +441,1 @@\n-\\f[B]Linux and macOS:\\f[R] If the option \\f[V]-agentlib:foo\\f[R] is\n+\\f[B]Linux and macOS:\\f[R] If the option \\f[CB]\\-agentlib:foo\\f[R] is\n@@ -448,3 +443,3 @@\n-\\f[V]libfoo.so\\f[R] in the location specified by the\n-\\f[V]LD_LIBRARY_PATH\\f[R] system variable (on macOS this variable is\n-\\f[V]DYLD_LIBRARY_PATH\\f[R]).\n+\\f[CB]libfoo.so\\f[R] in the location specified by the\n+\\f[CB]LD_LIBRARY_PATH\\f[R] system variable (on macOS this variable is\n+\\f[CB]DYLD_LIBRARY_PATH\\f[R]).\n@@ -452,3 +447,3 @@\n-\\f[B]Windows:\\f[R] If the option \\f[V]-agentlib:foo\\f[R] is specified,\n-then the JVM attempts to load the library named \\f[V]foo.dll\\f[R] in the\n-location specified by the \\f[V]PATH\\f[R] system variable.\n+\\f[B]Windows:\\f[R] If the option \\f[CB]\\-agentlib:foo\\f[R] is specified,\n+then the JVM attempts to load the library named \\f[CB]foo.dll\\f[R] in the\n+location specified by the \\f[CB]PATH\\f[R] system variable.\n@@ -462,1 +457,1 @@\n-\\f[V]-agentlib:jdwp=transport=dt_socket,server=y,address=8000\\f[R]\n+\\f[CB]\\-agentlib:jdwp=transport=dt_socket,server=y,address=8000\\f[R]\n@@ -467,1 +462,1 @@\n-\\f[V]-agentpath:\\f[R]\\f[I]pathname\\f[R][\\f[V]=\\f[R]\\f[I]options\\f[R]]\n+.B \\f[CB]\\-agentpath:\\f[R]\\f[I]pathname\\f[R][\\f[CB]=\\f[R]\\f[I]options\\f[R]]\n@@ -469,1 +464,1 @@\n-This option is equivalent to \\f[V]-agentlib\\f[R] but uses the full path\n+This option is equivalent to \\f[CB]\\-agentlib\\f[R] but uses the full path\n@@ -471,0 +466,2 @@\n+.RS\n+.RE\n@@ -472,1 +469,1 @@\n-\\f[V]--class-path\\f[R] \\f[I]classpath\\f[R], \\f[V]-classpath\\f[R] \\f[I]classpath\\f[R], or \\f[V]-cp\\f[R] \\f[I]classpath\\f[R]\n+.B \\f[CB]\\-\\-class\\-path\\f[R] \\f[I]classpath\\f[R], \\f[CB]\\-classpath\\f[R] \\f[I]classpath\\f[R], or \\f[CB]\\-cp\\f[R] \\f[I]classpath\\f[R]\n@@ -477,2 +474,2 @@\n-On Windows, semicolons (\\f[V];\\f[R]) separate entities in this list; on\n-other platforms it is a colon (\\f[V]:\\f[R]).\n+On Windows, semicolons (\\f[CB];\\f[R]) separate entities in this list; on\n+other platforms it is a colon (\\f[CB]:\\f[R]).\n@@ -481,4 +478,3 @@\n-\\f[V]CLASSPATH\\f[R] environment variable.\n-If the class path option isn\\[aq]t used and \\f[I]classpath\\f[R]\n-isn\\[aq]t set, then the user class path consists of the current\n-directory (.).\n+\\f[CB]CLASSPATH\\f[R] environment variable.\n+If the class path option isn\\[aq]t used and \\f[I]classpath\\f[R] isn\\[aq]t\n+set, then the user class path consists of the current directory (.).\n@@ -488,2 +484,2 @@\n-the files in the directory with the extension \\f[V].jar\\f[R] or\n-\\f[V].JAR\\f[R] .\n+the files in the directory with the extension \\f[CB]\\&.jar\\f[R] or\n+\\f[CB]\\&.JAR\\f[R] .\n@@ -492,5 +488,4 @@\n-For example, if the directory mydir contains \\f[V]a.jar\\f[R] and\n-\\f[V]b.JAR\\f[R], then the class path element mydir\/* is expanded to\n-\\f[V]A.jar:b.JAR\\f[R], except that the order of JAR files is\n-unspecified.\n-All \\f[V].jar\\f[R] files in the specified directory, even hidden ones,\n+For example, if the directory mydir contains \\f[CB]a.jar\\f[R] and\n+\\f[CB]b.JAR\\f[R], then the class path element mydir\/* is expanded to\n+\\f[CB]A.jar:b.JAR\\f[R], except that the order of JAR files is unspecified.\n+All \\f[CB]\\&.jar\\f[R] files in the specified directory, even hidden ones,\n@@ -500,2 +495,2 @@\n-The \\f[V]CLASSPATH\\f[R] environment variable, where defined, is\n-similarly expanded.\n+The \\f[CB]CLASSPATH\\f[R] environment variable, where defined, is similarly\n+expanded.\n@@ -506,1 +501,1 @@\n-\\f[V]System.getenv(\\[dq]CLASSPATH\\[dq])\\f[R].\n+\\f[CB]System.getenv(\"CLASSPATH\")\\f[R].\n@@ -509,1 +504,1 @@\n-\\f[V]--disable-\\[at]files\\f[R]\n+.B \\f[CB]\\-\\-disable\\-\\@files\\f[R]\n@@ -511,2 +506,4 @@\n-to prevent further \\f[V]\\[at]filename\\f[R] expansion.\n-This option stops expanding \\f[V]\\[at]\\f[R]-argfiles after the option.\n+to prevent further \\f[CB]\\@filename\\f[R] expansion.\n+This option stops expanding \\f[CB]\\@\\f[R]\\-argfiles after the option.\n+.RS\n+.RE\n@@ -514,1 +511,1 @@\n-\\f[V]--enable-preview\\f[R]\n+.B \\f[CB]\\-\\-enable\\-preview\\f[R]\n@@ -516,1 +513,1 @@\n-[https:\/\/docs.oracle.com\/en\/java\/javase\/12\/language\/index.html#JSLAN-GUID-5A82FE0E-0CA4-4F1F-B075-564874FE2823]\n+[https:\/\/docs.oracle.com\/en\/java\/javase\/12\/language\/index.html#JSLAN\\-GUID\\-5A82FE0E\\-0CA4\\-4F1F\\-B075\\-564874FE2823]\n@@ -518,0 +515,2 @@\n+.RS\n+.RE\n@@ -519,1 +518,1 @@\n-\\f[V]--finalization=\\f[R]\\f[I]value\\f[R]\n+.B \\f[CB]\\-\\-finalization=\\f[R]\\f[I]value\\f[R]\n@@ -521,5 +520,6 @@\n-Valid values are \\[dq]enabled\\[dq] and \\[dq]disabled\\[dq].\n-Finalization is enabled by default, so the value \\[dq]enabled\\[dq] does\n-nothing.\n-The value \\[dq]disabled\\[dq] disables finalization, so that no\n-finalizers are invoked.\n+Valid values are \"enabled\" and \"disabled\".\n+Finalization is enabled by default, so the value \"enabled\" does nothing.\n+The value \"disabled\" disables finalization, so that no finalizers are\n+invoked.\n+.RS\n+.RE\n@@ -527,1 +527,1 @@\n-\\f[V]--module-path\\f[R] \\f[I]modulepath\\f[R]... or \\f[V]-p\\f[R] \\f[I]modulepath\\f[R]\n+.B \\f[CB]\\-\\-module\\-path\\f[R] \\f[I]modulepath\\f[R]... or \\f[CB]\\-p\\f[R] \\f[I]modulepath\\f[R]\n@@ -532,2 +532,2 @@\n-On Windows, semicolons (\\f[V];\\f[R]) separate directories in this list;\n-on other platforms it is a colon (\\f[V]:\\f[R]).\n+On Windows, semicolons (\\f[CB];\\f[R]) separate directories in this list;\n+on other platforms it is a colon (\\f[CB]:\\f[R]).\n@@ -536,1 +536,1 @@\n-\\f[V]--upgrade-module-path\\f[R] \\f[I]modulepath\\f[R]...\n+.B \\f[CB]\\-\\-upgrade\\-module\\-path\\f[R] \\f[I]modulepath\\f[R]...\n@@ -541,2 +541,2 @@\n-On Windows, semicolons (\\f[V];\\f[R]) separate directories in this list;\n-on other platforms it is a colon (\\f[V]:\\f[R]).\n+On Windows, semicolons (\\f[CB];\\f[R]) separate directories in this list;\n+on other platforms it is a colon (\\f[CB]:\\f[R]).\n@@ -545,1 +545,1 @@\n-\\f[V]--add-modules\\f[R] \\f[I]module\\f[R][\\f[V],\\f[R]\\f[I]module\\f[R]...]\n+.B \\f[CB]\\-\\-add\\-modules\\f[R] \\f[I]module\\f[R][\\f[CB],\\f[R]\\f[I]module\\f[R]...]\n@@ -547,2 +547,4 @@\n-\\f[I]module\\f[R] also can be \\f[V]ALL-DEFAULT\\f[R],\n-\\f[V]ALL-SYSTEM\\f[R], and \\f[V]ALL-MODULE-PATH\\f[R].\n+\\f[I]module\\f[R] also can be \\f[CB]ALL\\-DEFAULT\\f[R], \\f[CB]ALL\\-SYSTEM\\f[R],\n+and \\f[CB]ALL\\-MODULE\\-PATH\\f[R].\n+.RS\n+.RE\n@@ -550,1 +552,1 @@\n-\\f[V]--list-modules\\f[R]\n+.B \\f[CB]\\-\\-list\\-modules\\f[R]\n@@ -552,0 +554,2 @@\n+.RS\n+.RE\n@@ -553,1 +557,1 @@\n-\\f[V]-d\\f[R] \\f[I]module_name\\f[R] or \\f[V]--describe-module\\f[R] \\f[I]module_name\\f[R]\n+.B \\f[CB]\\-d\\f[R] \\f[I]module_name\\f[R] or \\f[CB]\\-\\-describe\\-module\\f[R] \\f[I]module_name\\f[R]\n@@ -555,0 +559,2 @@\n+.RS\n+.RE\n@@ -556,1 +562,1 @@\n-\\f[V]--dry-run\\f[R]\n+.B \\f[CB]\\-\\-dry\\-run\\f[R]\n@@ -558,2 +564,4 @@\n-This \\f[V]--dry-run\\f[R] option might be useful for validating the\n-command-line options such as the module system configuration.\n+This \\f[CB]\\-\\-dry\\-run\\f[R] option might be useful for validating the\n+command\\-line options such as the module system configuration.\n+.RS\n+.RE\n@@ -561,1 +569,1 @@\n-\\f[V]--validate-modules\\f[R]\n+.B \\f[CB]\\-\\-validate\\-modules\\f[R]\n@@ -565,0 +573,2 @@\n+.RS\n+.RE\n@@ -566,1 +576,1 @@\n-\\f[V]-D\\f[R]\\f[I]property\\f[R]\\f[V]=\\f[R]\\f[I]value\\f[R]\n+.B \\f[CB]\\-D\\f[R]\\f[I]property\\f[R]\\f[CB]=\\f[R]\\f[I]value\\f[R]\n@@ -570,2 +580,2 @@\n-The \\f[I]value\\f[R] variable is a string that represents the value of\n-the property.\n+The \\f[I]value\\f[R] variable is a string that represents the value of the\n+property.\n@@ -573,1 +583,3 @@\n-marks (for example \\f[V]-Dfoo=\\[dq]foo bar\\[dq]\\f[R]).\n+marks (for example \\f[CB]\\-Dfoo=\"foo\\ bar\"\\f[R]).\n+.RS\n+.RE\n@@ -575,1 +587,1 @@\n-\\f[V]-disableassertions\\f[R][\\f[V]:\\f[R][\\f[I]packagename\\f[R]]...|\\f[V]:\\f[R]\\f[I]classname\\f[R]] or \\f[V]-da\\f[R][\\f[V]:\\f[R][\\f[I]packagename\\f[R]]...|\\f[V]:\\f[R]\\f[I]classname\\f[R]]\n+.B \\f[CB]\\-disableassertions\\f[R][\\f[CB]:\\f[R][\\f[I]packagename\\f[R]]...|\\f[CB]:\\f[R]\\f[I]classname\\f[R]] or \\f[CB]\\-da\\f[R][\\f[CB]:\\f[R][\\f[I]packagename\\f[R]]...|\\f[CB]:\\f[R]\\f[I]classname\\f[R]]\n@@ -578,1 +590,1 @@\n-With no arguments, \\f[V]-disableassertions\\f[R] (\\f[V]-da\\f[R]) disables\n+With no arguments, \\f[CB]\\-disableassertions\\f[R] (\\f[CB]\\-da\\f[R]) disables\n@@ -580,1 +592,1 @@\n-With the \\f[I]packagename\\f[R] argument ending in \\f[V]...\\f[R], the\n+With the \\f[I]packagename\\f[R] argument ending in \\f[CB]\\&...\\f[R], the\n@@ -582,1 +594,1 @@\n-If the argument is simply \\f[V]...\\f[R], then the switch disables\n+If the argument is simply \\f[CB]\\&...\\f[R], then the switch disables\n@@ -588,1 +600,1 @@\n-The \\f[V]-disableassertions\\f[R] (\\f[V]-da\\f[R]) option applies to all\n+The \\f[CB]\\-disableassertions\\f[R] (\\f[CB]\\-da\\f[R]) option applies to all\n@@ -595,1 +607,1 @@\n-The \\f[V]-disablesystemassertions\\f[R] option enables you to disable\n+The \\f[CB]\\-disablesystemassertions\\f[R] option enables you to disable\n@@ -598,1 +610,1 @@\n-\\f[V]-enableassertions\\f[R] (\\f[V]-ea\\f[R]) option.\n+\\f[CB]\\-enableassertions\\f[R] (\\f[CB]\\-ea\\f[R]) option.\n@@ -600,2 +612,2 @@\n-For example, to run the \\f[V]MyClass\\f[R] application with assertions\n-enabled in the package \\f[V]com.wombat.fruitbat\\f[R] (and any\n+For example, to run the \\f[CB]MyClass\\f[R] application with assertions\n+enabled in the package \\f[CB]com.wombat.fruitbat\\f[R] (and any\n@@ -603,1 +615,1 @@\n-\\f[V]com.wombat.fruitbat.Brickbat\\f[R], use the following command:\n+\\f[CB]com.wombat.fruitbat.Brickbat\\f[R], use the following command:\n@@ -606,1 +618,1 @@\n-\\f[V]java -ea:com.wombat.fruitbat... -da:com.wombat.fruitbat.Brickbat MyClass\\f[R]\n+\\f[CB]java\\ \\-ea:com.wombat.fruitbat...\\ \\-da:com.wombat.fruitbat.Brickbat\\ MyClass\\f[R]\n@@ -610,1 +622,1 @@\n-\\f[V]-disablesystemassertions\\f[R] or \\f[V]-dsa\\f[R]\n+.B \\f[CB]\\-disablesystemassertions\\f[R] or \\f[CB]\\-dsa\\f[R]\n@@ -612,0 +624,2 @@\n+.RS\n+.RE\n@@ -613,1 +627,1 @@\n-\\f[V]-enableassertions\\f[R][\\f[V]:\\f[R][\\f[I]packagename\\f[R]]...|\\f[V]:\\f[R]\\f[I]classname\\f[R]] or \\f[V]-ea\\f[R][\\f[V]:\\f[R][\\f[I]packagename\\f[R]]...|\\f[V]:\\f[R]\\f[I]classname\\f[R]]\n+.B \\f[CB]\\-enableassertions\\f[R][\\f[CB]:\\f[R][\\f[I]packagename\\f[R]]...|\\f[CB]:\\f[R]\\f[I]classname\\f[R]] or \\f[CB]\\-ea\\f[R][\\f[CB]:\\f[R][\\f[I]packagename\\f[R]]...|\\f[CB]:\\f[R]\\f[I]classname\\f[R]]\n@@ -616,1 +630,1 @@\n-With no arguments, \\f[V]-enableassertions\\f[R] (\\f[V]-ea\\f[R]) enables\n+With no arguments, \\f[CB]\\-enableassertions\\f[R] (\\f[CB]\\-ea\\f[R]) enables\n@@ -618,1 +632,1 @@\n-With the \\f[I]packagename\\f[R] argument ending in \\f[V]...\\f[R], the\n+With the \\f[I]packagename\\f[R] argument ending in \\f[CB]\\&...\\f[R], the\n@@ -620,1 +634,1 @@\n-If the argument is simply \\f[V]...\\f[R], then the switch enables\n+If the argument is simply \\f[CB]\\&...\\f[R], then the switch enables\n@@ -626,1 +640,1 @@\n-The \\f[V]-enableassertions\\f[R] (\\f[V]-ea\\f[R]) option applies to all\n+The \\f[CB]\\-enableassertions\\f[R] (\\f[CB]\\-ea\\f[R]) option applies to all\n@@ -633,1 +647,1 @@\n-The \\f[V]-enablesystemassertions\\f[R] option provides a separate switch\n+The \\f[CB]\\-enablesystemassertions\\f[R] option provides a separate switch\n@@ -636,1 +650,1 @@\n-the \\f[V]-disableassertions\\f[R] (\\f[V]-da\\f[R]) option.\n+the \\f[CB]\\-disableassertions\\f[R] (\\f[CB]\\-da\\f[R]) option.\n@@ -639,2 +653,2 @@\n-For example, to run the \\f[V]MyClass\\f[R] application with assertions\n-enabled only in the package \\f[V]com.wombat.fruitbat\\f[R] (and any\n+For example, to run the \\f[CB]MyClass\\f[R] application with assertions\n+enabled only in the package \\f[CB]com.wombat.fruitbat\\f[R] (and any\n@@ -642,1 +656,1 @@\n-\\f[V]com.wombat.fruitbat.Brickbat\\f[R], use the following command:\n+\\f[CB]com.wombat.fruitbat.Brickbat\\f[R], use the following command:\n@@ -645,1 +659,1 @@\n-\\f[V]java -ea:com.wombat.fruitbat... -da:com.wombat.fruitbat.Brickbat MyClass\\f[R]\n+\\f[CB]java\\ \\-ea:com.wombat.fruitbat...\\ \\-da:com.wombat.fruitbat.Brickbat\\ MyClass\\f[R]\n@@ -649,1 +663,1 @@\n-\\f[V]-enablesystemassertions\\f[R] or \\f[V]-esa\\f[R]\n+.B \\f[CB]\\-enablesystemassertions\\f[R] or \\f[CB]\\-esa\\f[R]\n@@ -651,0 +665,2 @@\n+.RS\n+.RE\n@@ -652,1 +668,1 @@\n-\\f[V]-help\\f[R], \\f[V]-h\\f[R], or \\f[V]-?\\f[R]\n+.B \\f[CB]\\-help\\f[R], \\f[CB]\\-h\\f[R], or \\f[CB]\\-?\\f[R]\n@@ -654,0 +670,2 @@\n+.RS\n+.RE\n@@ -655,1 +673,1 @@\n-\\f[V]--help\\f[R]\n+.B \\f[CB]\\-\\-help\\f[R]\n@@ -657,0 +675,2 @@\n+.RS\n+.RE\n@@ -658,1 +678,1 @@\n-\\f[V]-javaagent:\\f[R]\\f[I]jarpath\\f[R][\\f[V]=\\f[R]\\f[I]options\\f[R]]\n+.B \\f[CB]\\-javaagent:\\f[R]\\f[I]jarpath\\f[R][\\f[CB]=\\f[R]\\f[I]options\\f[R]]\n@@ -660,1 +680,3 @@\n-See \\f[V]java.lang.instrument\\f[R].\n+See \\f[CB]java.lang.instrument\\f[R].\n+.RS\n+.RE\n@@ -662,1 +684,1 @@\n-\\f[V]--show-version\\f[R]\n+.B \\f[CB]\\-\\-show\\-version\\f[R]\n@@ -664,0 +686,2 @@\n+.RS\n+.RE\n@@ -665,1 +689,1 @@\n-\\f[V]-showversion\\f[R]\n+.B \\f[CB]\\-showversion\\f[R]\n@@ -667,0 +691,2 @@\n+.RS\n+.RE\n@@ -668,1 +694,1 @@\n-\\f[V]--show-module-resolution\\f[R]\n+.B \\f[CB]\\-\\-show\\-module\\-resolution\\f[R]\n@@ -670,0 +696,2 @@\n+.RS\n+.RE\n@@ -671,1 +699,1 @@\n-\\f[V]-splash:\\f[R]\\f[I]imagepath\\f[R]\n+.B \\f[CB]\\-splash:\\f[R]\\f[I]imagepath\\f[R]\n@@ -674,2 +702,2 @@\n-The unscaled image file name, such as \\f[V]image.ext\\f[R], should always\n-be passed as the argument to the \\f[V]-splash\\f[R] option.\n+The unscaled image file name, such as \\f[CB]image.ext\\f[R], should always\n+be passed as the argument to the \\f[CB]\\-splash\\f[R] option.\n@@ -679,2 +707,2 @@\n-For example, to show the \\f[V]splash.gif\\f[R] file from the\n-\\f[V]images\\f[R] directory when starting your application, use the\n+For example, to show the \\f[CB]splash.gif\\f[R] file from the\n+\\f[CB]images\\f[R] directory when starting your application, use the\n@@ -684,1 +712,1 @@\n-\\f[V]-splash:images\/splash.gif\\f[R]\n+\\f[CB]\\-splash:images\/splash.gif\\f[R]\n@@ -690,1 +718,1 @@\n-\\f[V]-verbose:class\\f[R]\n+.B \\f[CB]\\-verbose:class\\f[R]\n@@ -692,0 +720,2 @@\n+.RS\n+.RE\n@@ -693,1 +723,1 @@\n-\\f[V]-verbose:gc\\f[R]\n+.B \\f[CB]\\-verbose:gc\\f[R]\n@@ -695,0 +725,2 @@\n+.RS\n+.RE\n@@ -696,1 +728,1 @@\n-\\f[V]-verbose:jni\\f[R]\n+.B \\f[CB]\\-verbose:jni\\f[R]\n@@ -699,0 +731,2 @@\n+.RS\n+.RE\n@@ -700,1 +734,1 @@\n-\\f[V]-verbose:module\\f[R]\n+.B \\f[CB]\\-verbose:module\\f[R]\n@@ -702,0 +736,2 @@\n+.RS\n+.RE\n@@ -703,1 +739,1 @@\n-\\f[V]--version\\f[R]\n+.B \\f[CB]\\-\\-version\\f[R]\n@@ -705,0 +741,2 @@\n+.RS\n+.RE\n@@ -706,1 +744,1 @@\n-\\f[V]-version\\f[R]\n+.B \\f[CB]\\-version\\f[R]\n@@ -708,0 +746,2 @@\n+.RS\n+.RE\n@@ -709,1 +749,1 @@\n-\\f[V]-X\\f[R]\n+.B \\f[CB]\\-X\\f[R]\n@@ -711,0 +751,2 @@\n+.RS\n+.RE\n@@ -712,1 +754,1 @@\n-\\f[V]--help-extra\\f[R]\n+.B \\f[CB]\\-\\-help\\-extra\\f[R]\n@@ -714,0 +756,2 @@\n+.RS\n+.RE\n@@ -715,8 +759,8 @@\n-\\f[V]\\[at]\\f[R]\\f[I]argfile\\f[R]\n-Specifies one or more argument files prefixed by \\f[V]\\[at]\\f[R] used by\n-the \\f[V]java\\f[R] command.\n-It isn\\[aq]t uncommon for the \\f[V]java\\f[R] command line to be very\n-long because of the \\f[V].jar\\f[R] files needed in the classpath.\n-The \\f[V]\\[at]\\f[R]\\f[I]argfile\\f[R] option overcomes command-line\n-length limitations by enabling the launcher to expand the contents of\n-argument files after shell expansion, but before argument processing.\n+.B \\f[CB]\\@\\f[R]\\f[I]argfile\\f[R]\n+Specifies one or more argument files prefixed by \\f[CB]\\@\\f[R] used by the\n+\\f[CB]java\\f[R] command.\n+It isn\\[aq]t uncommon for the \\f[CB]java\\f[R] command line to be very long\n+because of the \\f[CB]\\&.jar\\f[R] files needed in the classpath.\n+The \\f[CB]\\@\\f[R]\\f[I]argfile\\f[R] option overcomes command\\-line length\n+limitations by enabling the launcher to expand the contents of argument\n+files after shell expansion, but before argument processing.\n@@ -725,1 +769,1 @@\n-\\f[V]--disable-\\[at]files\\f[R] option was encountered.\n+\\f[CB]\\-\\-disable\\-\\@files\\f[R] option was encountered.\n@@ -730,1 +774,1 @@\n-\\f[V]java\\f[R] command, then the command line could simply be:\n+\\f[CB]java\\f[R] command, then the command line could simply be:\n@@ -733,1 +777,1 @@\n-\\f[V]java \\[at]\\f[R]\\f[I]argfile\\f[R]\n+\\f[CB]java\\ \\@\\f[R]\\f[I]argfile\\f[R]\n@@ -736,2 +780,2 @@\n-See \\f[B]java Command-Line Argument Files\\f[R] for a description and\n-examples of using \\f[V]\\[at]\\f[R]-argfiles.\n+See \\f[B]java Command\\-Line Argument Files\\f[R] for a description and\n+examples of using \\f[CB]\\@\\f[R]\\-argfiles.\n@@ -741,2 +785,2 @@\n-The following \\f[V]java\\f[R] options are general purpose options that\n-are specific to the Java HotSpot Virtual Machine.\n+The following \\f[CB]java\\f[R] options are general purpose options that are\n+specific to the Java HotSpot Virtual Machine.\n@@ -744,1 +788,1 @@\n-\\f[V]-Xbatch\\f[R]\n+.B \\f[CB]\\-Xbatch\\f[R]\n@@ -749,1 +793,1 @@\n-The \\f[V]-Xbatch\\f[R] flag disables background compilation so that\n+The \\f[CB]\\-Xbatch\\f[R] flag disables background compilation so that\n@@ -752,1 +796,3 @@\n-This option is equivalent to \\f[V]-XX:-BackgroundCompilation\\f[R].\n+This option is equivalent to \\f[CB]\\-XX:\\-BackgroundCompilation\\f[R].\n+.RS\n+.RE\n@@ -754,1 +800,1 @@\n-\\f[V]-Xbootclasspath\/a:\\f[R]\\f[I]directories\\f[R]|\\f[I]zip\\f[R]|\\f[I]JAR-files\\f[R]\n+.B \\f[CB]\\-Xbootclasspath\/a:\\f[R]\\f[I]directories\\f[R]|\\f[I]zip\\f[R]|\\f[I]JAR\\-files\\f[R]\n@@ -759,2 +805,2 @@\n-On Windows, semicolons (\\f[V];\\f[R]) separate entities in this list; on\n-other platforms it is a colon (\\f[V]:\\f[R]).\n+On Windows, semicolons (\\f[CB];\\f[R]) separate entities in this list; on\n+other platforms it is a colon (\\f[CB]:\\f[R]).\n@@ -763,1 +809,1 @@\n-\\f[V]-Xcheck:jni\\f[R]\n+.B \\f[CB]\\-Xcheck:jni\\f[R]\n@@ -773,1 +819,1 @@\n-The thread doing the call is using the \\f[V]JNIEnv\\f[R] belonging to\n+The thread doing the call is using the \\f[CB]JNIEnv\\f[R] belonging to\n@@ -779,1 +825,1 @@\n-A \\f[V]jfieldID\\f[R], or \\f[V]jmethodID\\f[R], is detected as being\n+A \\f[CB]jfieldID\\f[R], or \\f[CB]jmethodID\\f[R], is detected as being\n@@ -797,1 +843,1 @@\n-An out-of-bounds array index, or frame capacity\n+An out\\-of\\-bounds array index, or frame capacity\n@@ -799,1 +845,1 @@\n-A non-UTF-8 string\n+A non\\-UTF\\-8 string\n@@ -803,2 +849,2 @@\n-An attempt to use a \\f[V]ReleaseXXX\\f[R] function on a parameter not\n-produced by the corresponding \\f[V]GetXXX\\f[R] function\n+An attempt to use a \\f[CB]ReleaseXXX\\f[R] function on a parameter not\n+produced by the corresponding \\f[CB]GetXXX\\f[R] function\n@@ -816,1 +862,1 @@\n-See the \\f[V]EnsureLocalcapacity\\f[R] function.\n+See the \\f[CB]EnsureLocalcapacity\\f[R] function.\n@@ -818,1 +864,1 @@\n-A class descriptor is in decorated format (\\f[V]Lname;\\f[R]) when it\n+A class descriptor is in decorated format (\\f[CB]Lname;\\f[R]) when it\n@@ -821,1 +867,1 @@\n-A \\f[V]NULL\\f[R] parameter is allowed, but its use is questionable.\n+A \\f[CB]NULL\\f[R] parameter is allowed, but its use is questionable.\n@@ -824,2 +870,2 @@\n-\\f[V]Get\/ReleasePrimitiveArrayCritical\\f[R] or\n-\\f[V]Get\/ReleaseStringCritical\\f[R]\n+\\f[CB]Get\/ReleasePrimitiveArrayCritical\\f[R] or\n+\\f[CB]Get\/ReleaseStringCritical\\f[R]\n@@ -830,1 +876,1 @@\n-\\f[V]-Xcomp\\f[R]\n+.B \\f[CB]\\-Xcomp\\f[R]\n@@ -833,0 +879,2 @@\n+.RS\n+.RE\n@@ -834,1 +882,1 @@\n-\\f[V]-Xdebug\\f[R]\n+.B \\f[CB]\\-Xdebug\\f[R]\n@@ -837,0 +885,2 @@\n+.RS\n+.RE\n@@ -838,1 +888,1 @@\n-\\f[V]-Xdiag\\f[R]\n+.B \\f[CB]\\-Xdiag\\f[R]\n@@ -840,0 +890,2 @@\n+.RS\n+.RE\n@@ -841,2 +893,2 @@\n-\\f[V]-Xint\\f[R]\n-Runs the application in interpreted-only mode.\n+.B \\f[CB]\\-Xint\\f[R]\n+Runs the application in interpreted\\-only mode.\n@@ -845,1 +897,1 @@\n-The performance benefits offered by the just-in-time (JIT) compiler\n+The performance benefits offered by the just\\-in\\-time (JIT) compiler\n@@ -847,0 +899,2 @@\n+.RS\n+.RE\n@@ -848,1 +902,1 @@\n-\\f[V]-Xinternalversion\\f[R]\n+.B \\f[CB]\\-Xinternalversion\\f[R]\n@@ -850,1 +904,3 @@\n-\\f[V]-version\\f[R] option, and then exits.\n+\\f[CB]\\-version\\f[R] option, and then exits.\n+.RS\n+.RE\n@@ -852,1 +908,1 @@\n-\\f[V]-Xlog:\\f[R]\\f[I]option\\f[R]\n+.B \\f[CB]\\-Xlog:\\f[R]\\f[I]option\\f[R]\n@@ -856,0 +912,2 @@\n+.RS\n+.RE\n@@ -857,1 +915,1 @@\n-\\f[V]-Xmixed\\f[R]\n+.B \\f[CB]\\-Xmixed\\f[R]\n@@ -861,1 +919,3 @@\n-Use \\f[V]-Xint\\f[R] to switch off.\n+Use \\f[CB]\\-Xint\\f[R] to switch off.\n+.RS\n+.RE\n@@ -863,1 +923,1 @@\n-\\f[V]-Xmn\\f[R] \\f[I]size\\f[R]\n+.B \\f[CB]\\-Xmn\\f[R] \\f[I]size\\f[R]\n@@ -866,3 +926,3 @@\n-Append the letter \\f[V]k\\f[R] or \\f[V]K\\f[R] to indicate kilobytes,\n-\\f[V]m\\f[R] or \\f[V]M\\f[R] to indicate megabytes, or \\f[V]g\\f[R] or\n-\\f[V]G\\f[R] to indicate gigabytes.\n+Append the letter \\f[CB]k\\f[R] or \\f[CB]K\\f[R] to indicate kilobytes,\n+\\f[CB]m\\f[R] or \\f[CB]M\\f[R] to indicate megabytes, or \\f[CB]g\\f[R] or\n+\\f[CB]G\\f[R] to indicate gigabytes.\n@@ -885,3 +945,3 @@\n--Xmn256m\n--Xmn262144k\n--Xmn268435456\n+\\-Xmn256m\n+\\-Xmn262144k\n+\\-Xmn268435456\n@@ -891,1 +951,1 @@\n-Instead of the \\f[V]-Xmn\\f[R] option to set both the initial and maximum\n+Instead of the \\f[CB]\\-Xmn\\f[R] option to set both the initial and maximum\n@@ -893,2 +953,2 @@\n-\\f[V]-XX:NewSize\\f[R] to set the initial size and\n-\\f[V]-XX:MaxNewSize\\f[R] to set the maximum size.\n+\\f[CB]\\-XX:NewSize\\f[R] to set the initial size and\n+\\f[CB]\\-XX:MaxNewSize\\f[R] to set the maximum size.\n@@ -897,1 +957,1 @@\n-\\f[V]-Xms\\f[R] \\f[I]size\\f[R]\n+.B \\f[CB]\\-Xms\\f[R] \\f[I]size\\f[R]\n@@ -900,3 +960,3 @@\n-Append the letter \\f[V]k\\f[R] or \\f[V]K\\f[R] to indicate kilobytes,\n-\\f[V]m\\f[R] or \\f[V]M\\f[R] to indicate megabytes, or \\f[V]g\\f[R] or\n-\\f[V]G\\f[R] to indicate gigabytes.\n+Append the letter \\f[CB]k\\f[R] or \\f[CB]K\\f[R] to indicate kilobytes,\n+\\f[CB]m\\f[R] or \\f[CB]M\\f[R] to indicate megabytes, or \\f[CB]g\\f[R] or\n+\\f[CB]G\\f[R] to indicate gigabytes.\n@@ -909,3 +969,3 @@\n--Xms6291456\n--Xms6144k\n--Xms6m\n+\\-Xms6291456\n+\\-Xms6144k\n+\\-Xms6m\n@@ -919,1 +979,1 @@\n-the \\f[V]-Xmn\\f[R] option or the \\f[V]-XX:NewSize\\f[R] option.\n+the \\f[CB]\\-Xmn\\f[R] option or the \\f[CB]\\-XX:NewSize\\f[R] option.\n@@ -921,1 +981,1 @@\n-Note that the \\f[V]-XX:InitialHeapSize\\f[R] option can also be used to\n+Note that the \\f[CB]\\-XX:InitialHeapSize\\f[R] option can also be used to\n@@ -923,1 +983,1 @@\n-If it appears after \\f[V]-Xms\\f[R] on the command line, then the initial\n+If it appears after \\f[CB]\\-Xms\\f[R] on the command line, then the initial\n@@ -925,1 +985,1 @@\n-\\f[V]-XX:InitialHeapSize\\f[R].\n+\\f[CB]\\-XX:InitialHeapSize\\f[R].\n@@ -928,1 +988,1 @@\n-\\f[V]-Xmx\\f[R] \\f[I]size\\f[R]\n+.B \\f[CB]\\-Xmx\\f[R] \\f[I]size\\f[R]\n@@ -931,3 +991,3 @@\n-Append the letter \\f[V]k\\f[R] or \\f[V]K\\f[R] to indicate kilobytes,\n-\\f[V]m\\f[R] or \\f[V]M\\f[R] to indicate megabytes, or \\f[V]g\\f[R] or\n-\\f[V]G\\f[R] to indicate gigabytes.\n+Append the letter \\f[CB]k\\f[R] or \\f[CB]K\\f[R] to indicate kilobytes,\n+\\f[CB]m\\f[R] or \\f[CB]M\\f[R] to indicate megabytes, or \\f[CB]g\\f[R] or\n+\\f[CB]G\\f[R] to indicate gigabytes.\n@@ -935,1 +995,1 @@\n-For server deployments, \\f[V]-Xms\\f[R] and \\f[V]-Xmx\\f[R] are often set\n+For server deployments, \\f[CB]\\-Xms\\f[R] and \\f[CB]\\-Xmx\\f[R] are often set\n@@ -943,3 +1003,3 @@\n--Xmx83886080\n--Xmx81920k\n--Xmx80m\n+\\-Xmx83886080\n+\\-Xmx81920k\n+\\-Xmx80m\n@@ -949,1 +1009,1 @@\n-The \\f[V]-Xmx\\f[R] option is equivalent to \\f[V]-XX:MaxHeapSize\\f[R].\n+The \\f[CB]\\-Xmx\\f[R] option is equivalent to \\f[CB]\\-XX:MaxHeapSize\\f[R].\n@@ -952,1 +1012,1 @@\n-\\f[V]-Xnoclassgc\\f[R]\n+.B \\f[CB]\\-Xnoclassgc\\f[R]\n@@ -956,1 +1016,1 @@\n-When you specify \\f[V]-Xnoclassgc\\f[R] at startup, the class objects in\n+When you specify \\f[CB]\\-Xnoclassgc\\f[R] at startup, the class objects in\n@@ -960,1 +1020,3 @@\n-used carefully, throws an out-of-memory exception.\n+used carefully, throws an out\\-of\\-memory exception.\n+.RS\n+.RE\n@@ -962,1 +1024,1 @@\n-\\f[V]-Xrs\\f[R]\n+.B \\f[CB]\\-Xrs\\f[R]\n@@ -974,2 +1036,2 @@\n-The JVM uses \\f[V]SIGHUP\\f[R], \\f[V]SIGINT\\f[R], and \\f[V]SIGTERM\\f[R]\n-to initiate the running of shutdown hooks.\n+The JVM uses \\f[CB]SIGHUP\\f[R], \\f[CB]SIGINT\\f[R], and \\f[CB]SIGTERM\\f[R] to\n+initiate the running of shutdown hooks.\n@@ -978,5 +1040,5 @@\n-\\f[V]SIGINT\\f[R] or \\f[V]SIGTERM\\f[R], which can lead to interference\n-with the JVM signal handlers.\n-The \\f[V]-Xrs\\f[R] option is available to address this issue.\n-When \\f[V]-Xrs\\f[R] is used, the signal masks for \\f[V]SIGINT\\f[R],\n-\\f[V]SIGTERM\\f[R], \\f[V]SIGHUP\\f[R], and \\f[V]SIGQUIT\\f[R] aren\\[aq]t\n+\\f[CB]SIGINT\\f[R] or \\f[CB]SIGTERM\\f[R], which can lead to interference with\n+the JVM signal handlers.\n+The \\f[CB]\\-Xrs\\f[R] option is available to address this issue.\n+When \\f[CB]\\-Xrs\\f[R] is used, the signal masks for \\f[CB]SIGINT\\f[R],\n+\\f[CB]SIGTERM\\f[R], \\f[CB]SIGHUP\\f[R], and \\f[CB]SIGQUIT\\f[R] aren\\[aq]t\n@@ -993,3 +1055,3 @@\n-shutdown-hook processing and returns \\f[V]TRUE\\f[R] for\n-\\f[V]CTRL_C_EVENT\\f[R], \\f[V]CTRL_CLOSE_EVENT\\f[R],\n-\\f[V]CTRL_LOGOFF_EVENT\\f[R], and \\f[V]CTRL_SHUTDOWN_EVENT\\f[R].\n+shutdown\\-hook processing and returns \\f[CB]TRUE\\f[R] for\n+\\f[CB]CTRL_C_EVENT\\f[R], \\f[CB]CTRL_CLOSE_EVENT\\f[R],\n+\\f[CB]CTRL_LOGOFF_EVENT\\f[R], and \\f[CB]CTRL_SHUTDOWN_EVENT\\f[R].\n@@ -999,1 +1061,1 @@\n-The JVM uses \\f[V]CTRL_BREAK_EVENT\\f[R] to perform thread dumps.\n+The JVM uses \\f[CB]CTRL_BREAK_EVENT\\f[R] to perform thread dumps.\n@@ -1002,1 +1064,1 @@\n-web server), then it can receive \\f[V]CTRL_LOGOFF_EVENT\\f[R] but\n+web server), then it can receive \\f[CB]CTRL_LOGOFF_EVENT\\f[R] but\n@@ -1005,1 +1067,1 @@\n-To avoid possible interference such as this, the \\f[V]-Xrs\\f[R] option\n+To avoid possible interference such as this, the \\f[CB]\\-Xrs\\f[R] option\n@@ -1007,1 +1069,1 @@\n-When the \\f[V]-Xrs\\f[R] option is used, the JVM doesn\\[aq]t install a\n+When the \\f[CB]\\-Xrs\\f[R] option is used, the JVM doesn\\[aq]t install a\n@@ -1009,2 +1071,2 @@\n-process \\f[V]CTRL_C_EVENT\\f[R], \\f[V]CTRL_CLOSE_EVENT\\f[R],\n-\\f[V]CTRL_LOGOFF_EVENT\\f[R], or \\f[V]CTRL_SHUTDOWN_EVENT\\f[R].\n+process \\f[CB]CTRL_C_EVENT\\f[R], \\f[CB]CTRL_CLOSE_EVENT\\f[R],\n+\\f[CB]CTRL_LOGOFF_EVENT\\f[R], or \\f[CB]CTRL_SHUTDOWN_EVENT\\f[R].\n@@ -1013,1 +1075,1 @@\n-There are two consequences of specifying \\f[V]-Xrs\\f[R]:\n+There are two consequences of specifying \\f[CB]\\-Xrs\\f[R]:\n@@ -1015,1 +1077,1 @@\n-\\f[B]Linux and macOS:\\f[R] \\f[V]SIGQUIT\\f[R] thread dumps aren\\[aq]t\n+\\f[B]Linux and macOS:\\f[R] \\f[CB]SIGQUIT\\f[R] thread dumps aren\\[aq]t\n@@ -1021,1 +1083,1 @@\n-by calling the \\f[V]System.exit()\\f[R] when the JVM is to be terminated.\n+by calling the \\f[CB]System.exit()\\f[R] when the JVM is to be terminated.\n@@ -1024,1 +1086,1 @@\n-\\f[V]-Xshare:\\f[R]\\f[I]mode\\f[R]\n+.B \\f[CB]\\-Xshare:\\f[R]\\f[I]mode\\f[R]\n@@ -1030,1 +1092,1 @@\n-\\f[V]auto\\f[R]\n+.B \\f[CB]auto\\f[R]\n@@ -1032,0 +1094,2 @@\n+.RS\n+.RE\n@@ -1033,1 +1097,1 @@\n-\\f[V]on\\f[R]\n+.B \\f[CB]on\\f[R]\n@@ -1036,0 +1100,2 @@\n+.RE\n+.RS\n@@ -1037,1 +1103,1 @@\n-\\f[B]Note:\\f[R] The \\f[V]-Xshare:on\\f[R] option is used for testing\n+\\f[B]Note:\\f[R] The \\f[CB]\\-Xshare:on\\f[R] option is used for testing\n@@ -1039,1 +1105,1 @@\n-It may cause the VM to unexpectedly exit during start-up when the CDS\n+It may cause the VM to unexpectedly exit during start\\-up when the CDS\n@@ -1045,1 +1111,1 @@\n-\\f[V]off\\f[R]\n+.B \\f[CB]off\\f[R]\n@@ -1047,0 +1113,2 @@\n+.RS\n+.RE\n@@ -1049,1 +1117,1 @@\n-\\f[V]-XshowSettings\\f[R]\n+.B \\f[CB]\\-XshowSettings\\f[R]\n@@ -1051,0 +1119,2 @@\n+.RS\n+.RE\n@@ -1052,1 +1122,1 @@\n-\\f[V]-XshowSettings:\\f[R]\\f[I]category\\f[R]\n+.B \\f[CB]\\-XshowSettings:\\f[R]\\f[I]category\\f[R]\n@@ -1058,1 +1128,1 @@\n-\\f[V]all\\f[R]\n+.B \\f[CB]all\\f[R]\n@@ -1061,0 +1131,2 @@\n+.RS\n+.RE\n@@ -1062,1 +1134,1 @@\n-\\f[V]locale\\f[R]\n+.B \\f[CB]locale\\f[R]\n@@ -1064,0 +1136,2 @@\n+.RS\n+.RE\n@@ -1065,1 +1139,1 @@\n-\\f[V]properties\\f[R]\n+.B \\f[CB]properties\\f[R]\n@@ -1067,0 +1141,2 @@\n+.RS\n+.RE\n@@ -1068,1 +1144,1 @@\n-\\f[V]vm\\f[R]\n+.B \\f[CB]vm\\f[R]\n@@ -1070,0 +1146,2 @@\n+.RS\n+.RE\n@@ -1071,1 +1149,1 @@\n-\\f[V]system\\f[R]\n+.B \\f[CB]system\\f[R]\n@@ -1074,0 +1152,2 @@\n+.RS\n+.RE\n@@ -1076,1 +1156,1 @@\n-\\f[V]-Xss\\f[R] \\f[I]size\\f[R]\n+.B \\f[CB]\\-Xss\\f[R] \\f[I]size\\f[R]\n@@ -1078,3 +1158,2 @@\n-Append the letter \\f[V]k\\f[R] or \\f[V]K\\f[R] to indicate KB, \\f[V]m\\f[R]\n-or \\f[V]M\\f[R] to indicate MB, or \\f[V]g\\f[R] or \\f[V]G\\f[R] to indicate\n-GB.\n+Append the letter \\f[CB]k\\f[R] or \\f[CB]K\\f[R] to indicate KB, \\f[CB]m\\f[R] or\n+\\f[CB]M\\f[R] to indicate MB, or \\f[CB]g\\f[R] or \\f[CB]G\\f[R] to indicate GB.\n@@ -1086,1 +1165,1 @@\n-Linux\/x64 (64-bit): 1024 KB\n+Linux\/x64 (64\\-bit): 1024 KB\n@@ -1088,1 +1167,1 @@\n-macOS (64-bit): 1024 KB\n+macOS (64\\-bit): 1024 KB\n@@ -1097,3 +1176,3 @@\n--Xss1m\n--Xss1024k\n--Xss1048576\n+\\-Xss1m\n+\\-Xss1024k\n+\\-Xss1048576\n@@ -1103,1 +1182,1 @@\n-This option is similar to \\f[V]-XX:ThreadStackSize\\f[R].\n+This option is similar to \\f[CB]\\-XX:ThreadStackSize\\f[R].\n@@ -1106,2 +1185,2 @@\n-\\f[V]--add-reads\\f[R] \\f[I]module\\f[R]\\f[V]=\\f[R]\\f[I]target-module\\f[R](\\f[V],\\f[R]\\f[I]target-module\\f[R])*\n-Updates \\f[I]module\\f[R] to read the \\f[I]target-module\\f[R], regardless\n+.B \\f[CB]\\-\\-add\\-reads\\f[R] \\f[I]module\\f[R]\\f[CB]=\\f[R]\\f[I]target\\-module\\f[R](\\f[CB],\\f[R]\\f[I]target\\-module\\f[R])*\n+Updates \\f[I]module\\f[R] to read the \\f[I]target\\-module\\f[R], regardless\n@@ -1109,1 +1188,3 @@\n-\\f[I]target-module\\f[R] can be all unnamed to read all unnamed modules.\n+\\f[I]target\\-module\\f[R] can be all unnamed to read all unnamed modules.\n+.RS\n+.RE\n@@ -1111,1 +1192,1 @@\n-\\f[V]--add-exports\\f[R] \\f[I]module\\f[R]\\f[V]\/\\f[R]\\f[I]package\\f[R]\\f[V]=\\f[R]\\f[I]target-module\\f[R](\\f[V],\\f[R]\\f[I]target-module\\f[R])*\n+.B \\f[CB]\\-\\-add\\-exports\\f[R] \\f[I]module\\f[R]\\f[CB]\/\\f[R]\\f[I]package\\f[R]\\f[CB]=\\f[R]\\f[I]target\\-module\\f[R](\\f[CB],\\f[R]\\f[I]target\\-module\\f[R])*\n@@ -1113,2 +1194,2 @@\n-\\f[I]target-module\\f[R], regardless of module declaration.\n-The \\f[I]target-module\\f[R] can be all unnamed to export to all unnamed\n+\\f[I]target\\-module\\f[R], regardless of module declaration.\n+The \\f[I]target\\-module\\f[R] can be all unnamed to export to all unnamed\n@@ -1116,0 +1197,2 @@\n+.RS\n+.RE\n@@ -1117,1 +1200,1 @@\n-\\f[V]--add-opens\\f[R] \\f[I]module\\f[R]\\f[V]\/\\f[R]\\f[I]package\\f[R]\\f[V]=\\f[R]\\f[I]target-module\\f[R](\\f[V],\\f[R]\\f[I]target-module\\f[R])*\n+.B \\f[CB]\\-\\-add\\-opens\\f[R] \\f[I]module\\f[R]\\f[CB]\/\\f[R]\\f[I]package\\f[R]\\f[CB]=\\f[R]\\f[I]target\\-module\\f[R](\\f[CB],\\f[R]\\f[I]target\\-module\\f[R])*\n@@ -1119,1 +1202,3 @@\n-\\f[I]target-module\\f[R], regardless of module declaration.\n+\\f[I]target\\-module\\f[R], regardless of module declaration.\n+.RS\n+.RE\n@@ -1121,1 +1206,1 @@\n-\\f[V]--limit-modules\\f[R] \\f[I]module\\f[R][\\f[V],\\f[R]\\f[I]module\\f[R]...]\n+.B \\f[CB]\\-\\-limit\\-modules\\f[R] \\f[I]module\\f[R][\\f[CB],\\f[R]\\f[I]module\\f[R]...]\n@@ -1123,0 +1208,2 @@\n+.RS\n+.RE\n@@ -1124,1 +1211,1 @@\n-\\f[V]--patch-module\\f[R] \\f[I]module\\f[R]\\f[V]=\\f[R]\\f[I]file\\f[R](\\f[V];\\f[R]\\f[I]file\\f[R])*\n+.B \\f[CB]\\-\\-patch\\-module\\f[R] \\f[I]module\\f[R]\\f[CB]=\\f[R]\\f[I]file\\f[R](\\f[CB];\\f[R]\\f[I]file\\f[R])*\n@@ -1127,0 +1214,2 @@\n+.RS\n+.RE\n@@ -1128,2 +1217,4 @@\n-\\f[V]--source\\f[R] \\f[I]version\\f[R]\n-Sets the version of the source in source-file mode.\n+.B \\f[CB]\\-\\-source\\f[R] \\f[I]version\\f[R]\n+Sets the version of the source in source\\-file mode.\n+.RS\n+.RE\n@@ -1134,2 +1225,4 @@\n-\\f[V]-XstartOnFirstThread\\f[R]\n-Runs the \\f[V]main()\\f[R] method on the first (AppKit) thread.\n+.B \\f[CB]\\-XstartOnFirstThread\\f[R]\n+Runs the \\f[CB]main()\\f[R] method on the first (AppKit) thread.\n+.RS\n+.RE\n@@ -1137,1 +1230,1 @@\n-\\f[V]-Xdock:name=\\f[R]\\f[I]application_name\\f[R]\n+.B \\f[CB]\\-Xdock:name=\\f[R]\\f[I]application_name\\f[R]\n@@ -1139,0 +1232,2 @@\n+.RS\n+.RE\n@@ -1140,1 +1235,1 @@\n-\\f[V]-Xdock:icon=\\f[R]\\f[I]path_to_icon_file\\f[R]\n+.B \\f[CB]\\-Xdock:icon=\\f[R]\\f[I]path_to_icon_file\\f[R]\n@@ -1142,0 +1237,2 @@\n+.RS\n+.RE\n@@ -1144,1 +1241,1 @@\n-These \\f[V]java\\f[R] options can be used to enable other advanced\n+These \\f[CB]java\\f[R] options can be used to enable other advanced\n@@ -1147,1 +1244,1 @@\n-\\f[V]-XX:+UnlockDiagnosticVMOptions\\f[R]\n+.B \\f[CB]\\-XX:+UnlockDiagnosticVMOptions\\f[R]\n@@ -1163,1 +1260,1 @@\n-\\f[V]-XX:+UnlockExperimentalVMOptions\\f[R]\n+.B \\f[CB]\\-XX:+UnlockExperimentalVMOptions\\f[R]\n@@ -1167,0 +1264,2 @@\n+.RS\n+.RE\n@@ -1169,1 +1268,1 @@\n-These \\f[V]java\\f[R] options control the runtime behavior of the Java\n+These \\f[CB]java\\f[R] options control the runtime behavior of the Java\n@@ -1172,1 +1271,1 @@\n-\\f[V]-XX:ActiveProcessorCount=\\f[R]\\f[I]x\\f[R]\n+.B \\f[CB]\\-XX:ActiveProcessorCount=\\f[R]\\f[I]x\\f[R]\n@@ -1182,1 +1281,1 @@\n-This flag is honored even if \\f[V]UseContainerSupport\\f[R] is not\n+This flag is honored even if \\f[CB]UseContainerSupport\\f[R] is not\n@@ -1184,2 +1283,2 @@\n-See \\f[V]-XX:-UseContainerSupport\\f[R] for a description of enabling and\n-disabling container support.\n+See \\f[CB]\\-XX:\\-UseContainerSupport\\f[R] for a description of enabling\n+and disabling container support.\n@@ -1188,1 +1287,1 @@\n-\\f[V]-XX:AllocateHeapAt=\\f[R]\\f[I]path\\f[R]\n+.B \\f[CB]\\-XX:AllocateHeapAt=\\f[R]\\f[I]path\\f[R]\n@@ -1192,1 +1291,1 @@\n-heap on an alternative memory device, such as an NV-DIMM, specified by\n+heap on an alternative memory device, such as an NV\\-DIMM, specified by\n@@ -1202,2 +1301,2 @@\n-Some operating systems expose non-DRAM memory through the file system.\n-Memory-mapped files in these file systems bypass the page cache and\n+Some operating systems expose non\\-DRAM memory through the file system.\n+Memory\\-mapped files in these file systems bypass the page cache and\n@@ -1206,3 +1305,3 @@\n-The existing heap related flags (such as \\f[V]-Xmx\\f[R] and\n-\\f[V]-Xms\\f[R]) and garbage-collection related flags continue to work as\n-before.\n+The existing heap related flags (such as \\f[CB]\\-Xmx\\f[R] and\n+\\f[CB]\\-Xms\\f[R]) and garbage\\-collection related flags continue to work\n+as before.\n@@ -1211,1 +1310,1 @@\n-\\f[V]-XX:-CompactStrings\\f[R]\n+.B \\f[CB]\\-XX:\\-CompactStrings\\f[R]\n@@ -1214,1 +1313,1 @@\n-When this option is enabled, Java Strings containing only single-byte\n+When this option is enabled, Java Strings containing only single\\-byte\n@@ -1216,1 +1315,2 @@\n-single-byte-per-character Strings using ISO-8859-1 \/ Latin-1 encoding.\n+single\\-byte\\-per\\-character Strings using ISO\\-8859\\-1 \/ Latin\\-1\n+encoding.\n@@ -1218,1 +1318,1 @@\n-containing only single-byte characters.\n+containing only single\\-byte characters.\n@@ -1220,2 +1320,2 @@\n-represented and stored as 2 bytes per character using UTF-16 encoding.\n-Disabling the Compact Strings feature forces the use of UTF-16 encoding\n+represented and stored as 2 bytes per character using UTF\\-16 encoding.\n+Disabling the Compact Strings feature forces the use of UTF\\-16 encoding\n@@ -1238,1 +1338,1 @@\n-\\f[V]-XX:ErrorFile=\\f[R]\\f[I]filename\\f[R]\n+.B \\f[CB]\\-XX:ErrorFile=\\f[R]\\f[I]filename\\f[R]\n@@ -1242,3 +1342,2 @@\n-named \\f[V]hs_err_pid\\f[R]\\f[I]pid\\f[R]\\f[V].log\\f[R] where\n-\\f[I]pid\\f[R] is the identifier of the process that encountered the\n-error.\n+named \\f[CB]hs_err_pid\\f[R]\\f[I]pid\\f[R]\\f[CB]\\&.log\\f[R] where \\f[I]pid\\f[R]\n+is the identifier of the process that encountered the error.\n@@ -1248,1 +1347,1 @@\n-the identifier of the process is specified as \\f[V]%p\\f[R]):\n+the identifier of the process is specified as \\f[CB]%p\\f[R]):\n@@ -1251,1 +1350,1 @@\n-\\f[V]-XX:ErrorFile=.\/hs_err_pid%p.log\\f[R]\n+\\f[CB]\\-XX:ErrorFile=.\/hs_err_pid%p.log\\f[R]\n@@ -1255,1 +1354,1 @@\n-error log to \\f[V]\/var\/log\/java\/java_error.log\\f[R]:\n+error log to \\f[CB]\/var\/log\/java\/java_error.log\\f[R]:\n@@ -1259,1 +1358,1 @@\n-\\f[V]-XX:ErrorFile=\/var\/log\/java\/java_error.log\\f[R]\n+\\f[CB]\\-XX:ErrorFile=\/var\/log\/java\/java_error.log\\f[R]\n@@ -1264,1 +1363,1 @@\n-file to \\f[V]C:\/log\/java\/java_error.log\\f[R]:\n+file to \\f[CB]C:\/log\/java\/java_error.log\\f[R]:\n@@ -1268,1 +1367,1 @@\n-\\f[V]-XX:ErrorFile=C:\/log\/java\/java_error.log\\f[R]\n+\\f[CB]\\-XX:ErrorFile=C:\/log\/java\/java_error.log\\f[R]\n@@ -1277,1 +1376,1 @@\n-\\f[B]Linux and macOS:\\f[R] The temporary directory is \\f[V]\/tmp\\f[R].\n+\\f[B]Linux and macOS:\\f[R] The temporary directory is \\f[CB]\/tmp\\f[R].\n@@ -1280,2 +1379,2 @@\n-the \\f[V]TMP\\f[R] environment variable; if that environment variable\n-isn\\[aq]t defined, then the value of the \\f[V]TEMP\\f[R] environment\n+the \\f[CB]TMP\\f[R] environment variable; if that environment variable\n+isn\\[aq]t defined, then the value of the \\f[CB]TEMP\\f[R] environment\n@@ -1285,1 +1384,1 @@\n-\\f[V]-XX:+ExtensiveErrorReports\\f[R]\n+.B \\f[CB]\\-XX:+ExtensiveErrorReports\\f[R]\n@@ -1287,1 +1386,1 @@\n-\\f[V]ErrorFile\\f[R].\n+\\f[CB]ErrorFile\\f[R].\n@@ -1289,1 +1388,1 @@\n-is desired - even if the resulting logs may be quite large and\/or\n+is desired \\- even if the resulting logs may be quite large and\/or\n@@ -1294,0 +1393,2 @@\n+.RS\n+.RE\n@@ -1295,1 +1396,1 @@\n-\\f[V]-XX:FlightRecorderOptions=\\f[R]\\f[I]parameter\\f[R]\\f[V]=\\f[R]\\f[I]value\\f[R] (or) \\f[V]-XX:FlightRecorderOptions:\\f[R]\\f[I]parameter\\f[R]\\f[V]=\\f[R]\\f[I]value\\f[R]\n+.B \\f[CB]\\-XX:FlightRecorderOptions=\\f[R]\\f[I]parameter\\f[R]\\f[CB]=\\f[R]\\f[I]value\\f[R] (or) \\f[CB]\\-XX:FlightRecorderOptions:\\f[R]\\f[I]parameter\\f[R]\\f[CB]=\\f[R]\\f[I]value\\f[R]\n@@ -1300,1 +1401,1 @@\n-\\f[I]parameter\\f[R]\\f[V]=\\f[R]\\f[I]value\\f[R] entries:\n+\\f[I]parameter\\f[R]\\f[CB]=\\f[R]\\f[I]value\\f[R] entries:\n@@ -1302,1 +1403,1 @@\n-\\f[V]globalbuffersize=\\f[R]\\f[I]size\\f[R]\n+.B \\f[CB]globalbuffersize=\\f[R]\\f[I]size\\f[R]\n@@ -1305,2 +1406,2 @@\n-\\f[V]memorysize\\f[R].\n-Change the \\f[V]memorysize\\f[R] parameter to alter the size of global\n+\\f[CB]memorysize\\f[R].\n+Change the \\f[CB]memorysize\\f[R] parameter to alter the size of global\n@@ -1308,0 +1409,2 @@\n+.RS\n+.RE\n@@ -1309,1 +1412,1 @@\n-\\f[V]maxchunksize=\\f[R]\\f[I]size\\f[R]\n+.B \\f[CB]maxchunksize=\\f[R]\\f[I]size\\f[R]\n@@ -1311,2 +1414,2 @@\n-Append \\f[V]m\\f[R] or \\f[V]M\\f[R] to specify the size in megabytes (MB),\n-or \\f[V]g\\f[R] or \\f[V]G\\f[R] to specify the size in gigabytes (GB).\n+Append \\f[CB]m\\f[R] or \\f[CB]M\\f[R] to specify the size in megabytes (MB),\n+or \\f[CB]g\\f[R] or \\f[CB]G\\f[R] to specify the size in gigabytes (GB).\n@@ -1315,0 +1418,2 @@\n+.RS\n+.RE\n@@ -1316,1 +1421,1 @@\n-\\f[V]memorysize=\\f[R]\\f[I]size\\f[R]\n+.B \\f[CB]memorysize=\\f[R]\\f[I]size\\f[R]\n@@ -1318,4 +1423,4 @@\n-\\f[V]globalbuffersize\\f[R] and \\f[V]numglobalbuffers\\f[R] parameters\n-based on the size specified.\n-Append \\f[V]m\\f[R] or \\f[V]M\\f[R] to specify the size in megabytes (MB),\n-or \\f[V]g\\f[R] or \\f[V]G\\f[R] to specify the size in gigabytes (GB).\n+\\f[CB]globalbuffersize\\f[R] and \\f[CB]numglobalbuffers\\f[R] parameters based\n+on the size specified.\n+Append \\f[CB]m\\f[R] or \\f[CB]M\\f[R] to specify the size in megabytes (MB),\n+or \\f[CB]g\\f[R] or \\f[CB]G\\f[R] to specify the size in gigabytes (GB).\n@@ -1323,0 +1428,2 @@\n+.RS\n+.RE\n@@ -1324,1 +1431,1 @@\n-\\f[V]numglobalbuffers\\f[R]\n+.B \\f[CB]numglobalbuffers\\f[R]\n@@ -1327,1 +1434,1 @@\n-Change the \\f[V]memorysize\\f[R] parameter to alter the number of global\n+Change the \\f[CB]memorysize\\f[R] parameter to alter the number of global\n@@ -1329,0 +1436,2 @@\n+.RS\n+.RE\n@@ -1330,1 +1439,1 @@\n-\\f[V]old-object-queue-size=number-of-objects\\f[R]\n+.B \\f[CB]old\\-object\\-queue\\-size=number\\-of\\-objects\\f[R]\n@@ -1333,0 +1442,2 @@\n+.RS\n+.RE\n@@ -1334,1 +1445,1 @@\n-\\f[V]repository=\\f[R]\\f[I]path\\f[R]\n+.B \\f[CB]repository=\\f[R]\\f[I]path\\f[R]\n@@ -1337,0 +1448,2 @@\n+.RS\n+.RE\n@@ -1338,1 +1451,1 @@\n-\\f[V]retransform=\\f[R]{\\f[V]true\\f[R]|\\f[V]false\\f[R]}\n+.B \\f[CB]retransform=\\f[R]{\\f[CB]true\\f[R]|\\f[CB]false\\f[R]}\n@@ -1342,0 +1455,2 @@\n+.RS\n+.RE\n@@ -1343,1 +1458,1 @@\n-\\f[V]stackdepth=\\f[R]\\f[I]depth\\f[R]\n+.B \\f[CB]stackdepth=\\f[R]\\f[I]depth\\f[R]\n@@ -1349,0 +1464,2 @@\n+.RS\n+.RE\n@@ -1350,2 +1467,2 @@\n-\\f[V]threadbuffersize=\\f[R]\\f[I]size\\f[R]\n-Specifies the per-thread local buffer size (in bytes).\n+.B \\f[CB]threadbuffersize=\\f[R]\\f[I]size\\f[R]\n+Specifies the per\\-thread local buffer size (in bytes).\n@@ -1356,0 +1473,2 @@\n+.RS\n+.RE\n@@ -1361,1 +1480,1 @@\n-\\f[V]-XX:LargePageSizeInBytes=\\f[R]\\f[I]size\\f[R]\n+.B \\f[CB]\\-XX:LargePageSizeInBytes=\\f[R]\\f[I]size\\f[R]\n@@ -1365,3 +1484,3 @@\n-Append the letter \\f[V]k\\f[R] or \\f[V]K\\f[R] to indicate kilobytes,\n-\\f[V]m\\f[R] or \\f[V]M\\f[R] to indicate megabytes, or \\f[V]g\\f[R] or\n-\\f[V]G\\f[R] to indicate gigabytes.\n+Append the letter \\f[CB]k\\f[R] or \\f[CB]K\\f[R] to indicate kilobytes,\n+\\f[CB]m\\f[R] or \\f[CB]M\\f[R] to indicate megabytes, or \\f[CB]g\\f[R] or\n+\\f[CB]G\\f[R] to indicate gigabytes.\n@@ -1378,1 +1497,1 @@\n-\\f[V]-XX:LargePageSizeInBytes=1g\\f[R]\n+\\f[CB]\\-XX:LargePageSizeInBytes=1g\\f[R]\n@@ -1382,6 +1501,6 @@\n-\\f[V]-XX:MaxDirectMemorySize=\\f[R]\\f[I]size\\f[R]\n-Sets the maximum total size (in bytes) of the \\f[V]java.nio\\f[R]\n-package, direct-buffer allocations.\n-Append the letter \\f[V]k\\f[R] or \\f[V]K\\f[R] to indicate kilobytes,\n-\\f[V]m\\f[R] or \\f[V]M\\f[R] to indicate megabytes, or \\f[V]g\\f[R] or\n-\\f[V]G\\f[R] to indicate gigabytes.\n+.B \\f[CB]\\-XX:MaxDirectMemorySize=\\f[R]\\f[I]size\\f[R]\n+Sets the maximum total size (in bytes) of the \\f[CB]java.nio\\f[R] package,\n+direct\\-buffer allocations.\n+Append the letter \\f[CB]k\\f[R] or \\f[CB]K\\f[R] to indicate kilobytes,\n+\\f[CB]m\\f[R] or \\f[CB]M\\f[R] to indicate megabytes, or \\f[CB]g\\f[R] or\n+\\f[CB]G\\f[R] to indicate gigabytes.\n@@ -1389,1 +1508,1 @@\n-direct-buffer allocations automatically.\n+direct\\-buffer allocations automatically.\n@@ -1397,3 +1516,3 @@\n--XX:MaxDirectMemorySize=1m\n--XX:MaxDirectMemorySize=1024k\n--XX:MaxDirectMemorySize=1048576\n+\\-XX:MaxDirectMemorySize=1m\n+\\-XX:MaxDirectMemorySize=1024k\n+\\-XX:MaxDirectMemorySize=1048576\n@@ -1404,1 +1523,1 @@\n-\\f[V]-XX:-MaxFDLimit\\f[R]\n+.B \\f[CB]\\-XX:\\-MaxFDLimit\\f[R]\n@@ -1412,0 +1531,2 @@\n+.RS\n+.RE\n@@ -1413,1 +1534,1 @@\n-\\f[V]-XX:NativeMemoryTracking=\\f[R]\\f[I]mode\\f[R]\n+.B \\f[CB]\\-XX:NativeMemoryTracking=\\f[R]\\f[I]mode\\f[R]\n@@ -1418,1 +1539,1 @@\n-\\f[V]off\\f[R]\n+.B \\f[CB]off\\f[R]\n@@ -1421,1 +1542,3 @@\n-\\f[V]-XX:NativeMemoryTracking\\f[R] option.\n+\\f[CB]\\-XX:NativeMemoryTracking\\f[R] option.\n+.RS\n+.RE\n@@ -1423,1 +1546,1 @@\n-\\f[V]summary\\f[R]\n+.B \\f[CB]summary\\f[R]\n@@ -1426,0 +1549,2 @@\n+.RS\n+.RE\n@@ -1427,1 +1552,1 @@\n-\\f[V]detail\\f[R]\n+.B \\f[CB]detail\\f[R]\n@@ -1429,1 +1554,1 @@\n-usage by individual \\f[V]CallSite\\f[R], individual virtual memory region\n+usage by individual \\f[CB]CallSite\\f[R], individual virtual memory region\n@@ -1431,0 +1556,2 @@\n+.RS\n+.RE\n@@ -1433,2 +1560,2 @@\n-\\f[V]-XX:+NeverActAsServerClassMachine\\f[R]\n-Enable the \\[dq]Client VM emulation\\[dq] mode which only uses the C1 JIT\n+.B \\f[CB]\\-XX:+NeverActAsServerClassMachine\\f[R]\n+Enable the \"Client VM emulation\" mode which only uses the C1 JIT\n@@ -1437,2 +1564,2 @@\n-\\f[V]-XX:MaxRAM=n\\f[R] flag) is set to 1GB by default.\n-The string \\[dq]emulated-client\\[dq] is added to the JVM version string.\n+\\f[CB]\\-XX:MaxRAM=n\\f[R] flag) is set to 1GB by default.\n+The string \"emulated\\-client\" is added to the JVM version string.\n@@ -1441,2 +1568,2 @@\n-By default the flag is set to \\f[V]true\\f[R] only on Windows in 32-bit\n-mode and \\f[V]false\\f[R] in all other cases.\n+By default the flag is set to \\f[CB]true\\f[R] only on Windows in 32\\-bit\n+mode and \\f[CB]false\\f[R] in all other cases.\n@@ -1444,1 +1571,1 @@\n-The \\[dq]Client VM emulation\\[dq] mode will not be enabled if any of the\n+The \"Client VM emulation\" mode will not be enabled if any of the\n@@ -1449,5 +1576,5 @@\n--XX:{+|-}TieredCompilation\n--XX:CompilationMode=mode\n--XX:TieredStopAtLevel=n\n--XX:{+|-}EnableJVMCI\n--XX:{+|-}UseJVMCICompiler\n+\\-XX:{+|\\-}TieredCompilation\n+\\-XX:CompilationMode=mode\n+\\-XX:TieredStopAtLevel=n\n+\\-XX:{+|\\-}EnableJVMCI\n+\\-XX:{+|\\-}UseJVMCICompiler\n@@ -1458,1 +1585,1 @@\n-\\f[V]-XX:ObjectAlignmentInBytes=\\f[R]\\f[I]alignment\\f[R]\n+.B \\f[CB]\\-XX:ObjectAlignmentInBytes=\\f[R]\\f[I]alignment\\f[R]\n@@ -1470,1 +1597,1 @@\n-\\f[V]4GB * ObjectAlignmentInBytes\\f[R]\n+\\f[CB]4GB\\ *\\ ObjectAlignmentInBytes\\f[R]\n@@ -1481,3 +1608,3 @@\n-\\f[V]-XX:OnError=\\f[R]\\f[I]string\\f[R]\n-Sets a custom command or a series of semicolon-separated commands to run\n-when an irrecoverable error occurs.\n+.B \\f[CB]\\-XX:OnError=\\f[R]\\f[I]string\\f[R]\n+Sets a custom command or a series of semicolon\\-separated commands to\n+run when an irrecoverable error occurs.\n@@ -1489,4 +1616,4 @@\n-\\f[V]-XX:OnError\\f[R] option can be used to run the \\f[V]gcore\\f[R]\n-command to create a core image, and start the \\f[V]gdb\\f[R] debugger to\n-attach to the process in case of an irrecoverable error (the\n-\\f[V]%p\\f[R] designates the current process identifier):\n+\\f[CB]\\-XX:OnError\\f[R] option can be used to run the \\f[CB]gcore\\f[R]\n+command to create a core image, and start the \\f[CB]gdb\\f[R] debugger to\n+attach to the process in case of an irrecoverable error (the \\f[CB]%p\\f[R]\n+designates the current process identifier):\n@@ -1496,1 +1623,1 @@\n-\\f[V]-XX:OnError=\\[dq]gcore %p;gdb -p %p\\[dq]\\f[R]\n+\\f[CB]\\-XX:OnError=\"gcore\\ %p;gdb\\ \\-p\\ %p\"\\f[R]\n@@ -1501,3 +1628,3 @@\n-\\f[V]-XX:OnError\\f[R] option can be used to run the\n-\\f[V]userdump.exe\\f[R] utility to obtain a crash dump in case of an\n-irrecoverable error (the \\f[V]%p\\f[R] designates the current process\n+\\f[CB]\\-XX:OnError\\f[R] option can be used to run the\n+\\f[CB]userdump.exe\\f[R] utility to obtain a crash dump in case of an\n+irrecoverable error (the \\f[CB]%p\\f[R] designates the current process\n@@ -1505,2 +1632,2 @@\n-This example assumes that the path to the \\f[V]userdump.exe\\f[R] utility\n-is specified in the \\f[V]PATH\\f[R] environment variable:\n+This example assumes that the path to the \\f[CB]userdump.exe\\f[R] utility\n+is specified in the \\f[CB]PATH\\f[R] environment variable:\n@@ -1510,1 +1637,1 @@\n-\\f[V]-XX:OnError=\\[dq]userdump.exe %p\\[dq]\\f[R]\n+\\f[CB]\\-XX:OnError=\"userdump.exe\\ %p\"\\f[R]\n@@ -1515,3 +1642,3 @@\n-\\f[V]-XX:OnOutOfMemoryError=\\f[R]\\f[I]string\\f[R]\n-Sets a custom command or a series of semicolon-separated commands to run\n-when an \\f[V]OutOfMemoryError\\f[R] exception is first thrown.\n+.B \\f[CB]\\-XX:OnOutOfMemoryError=\\f[R]\\f[I]string\\f[R]\n+Sets a custom command or a series of semicolon\\-separated commands to\n+run when an \\f[CB]OutOfMemoryError\\f[R] exception is first thrown.\n@@ -1521,1 +1648,3 @@\n-\\f[V]-XX:OnError\\f[R] option.\n+\\f[CB]\\-XX:OnError\\f[R] option.\n+.RS\n+.RE\n@@ -1523,1 +1652,1 @@\n-\\f[V]-XX:+PrintCommandLineFlags\\f[R]\n+.B \\f[CB]\\-XX:+PrintCommandLineFlags\\f[R]\n@@ -1529,0 +1658,2 @@\n+.RS\n+.RE\n@@ -1530,1 +1661,1 @@\n-\\f[V]-XX:+PreserveFramePointer\\f[R]\n+.B \\f[CB]\\-XX:+PreserveFramePointer\\f[R]\n@@ -1532,3 +1663,3 @@\n-(\\f[V]-XX:-PreserveFramePointer\\f[R]) and using the RBP register to hold\n-the frame pointer of the currently executing method\n-(\\f[V]-XX:+PreserveFramePointer\\f[R] .\n+(\\f[CB]\\-XX:\\-PreserveFramePointer\\f[R]) and using the RBP register to\n+hold the frame pointer of the currently executing method\n+(\\f[CB]\\-XX:+PreserveFramePointer\\f[R] .\n@@ -1537,0 +1668,2 @@\n+.RS\n+.RE\n@@ -1538,1 +1671,1 @@\n-\\f[V]-XX:+PrintNMTStatistics\\f[R]\n+.B \\f[CB]\\-XX:+PrintNMTStatistics\\f[R]\n@@ -1541,1 +1674,1 @@\n-\\f[V]-XX:NativeMemoryTracking\\f[R]).\n+\\f[CB]\\-XX:NativeMemoryTracking\\f[R]).\n@@ -1544,0 +1677,2 @@\n+.RS\n+.RE\n@@ -1545,1 +1680,1 @@\n-\\f[V]-XX:SharedArchiveFile=\\f[R]\\f[I]path\\f[R]\n+.B \\f[CB]\\-XX:SharedArchiveFile=\\f[R]\\f[I]path\\f[R]\n@@ -1552,1 +1687,1 @@\n-\\f[V]-XX:SharedArchiveConfigFile=\\f[R]\\f[I]shared_config_file\\f[R]\n+.B \\f[CB]\\-XX:SharedArchiveConfigFile=\\f[R]\\f[I]shared_config_file\\f[R]\n@@ -1554,0 +1689,2 @@\n+.RS\n+.RE\n@@ -1555,1 +1692,1 @@\n-\\f[V]-XX:SharedClassListFile=\\f[R]\\f[I]file_name\\f[R]\n+.B \\f[CB]\\-XX:SharedClassListFile=\\f[R]\\f[I]file_name\\f[R]\n@@ -1559,3 +1696,3 @@\n-(\\f[V]\/\\f[R]) replace dots (\\f[V].\\f[R]).\n-For example, to specify the classes \\f[V]java.lang.Object\\f[R] and\n-\\f[V]hello.Main\\f[R], create a text file that contains the following two\n+(\\f[CB]\/\\f[R]) replace dots (\\f[CB]\\&.\\f[R]).\n+For example, to specify the classes \\f[CB]java.lang.Object\\f[R] and\n+\\f[CB]hello.Main\\f[R], create a text file that contains the following two\n@@ -1580,3 +1717,3 @@\n-\\f[V]-XX:+ShowCodeDetailsInExceptionMessages\\f[R]\n-Enables printing of improved \\f[V]NullPointerException\\f[R] messages.\n-When an application throws a \\f[V]NullPointerException\\f[R], the option\n+.B \\f[CB]\\-XX:+ShowCodeDetailsInExceptionMessages\\f[R]\n+Enables printing of improved \\f[CB]NullPointerException\\f[R] messages.\n+When an application throws a \\f[CB]NullPointerException\\f[R], the option\n@@ -1584,4 +1721,4 @@\n-determine precisely which reference is \\f[V]null\\f[R], and describes the\n-source with a null-detail message.\n-The null-detail message is calculated and returned by\n-\\f[V]NullPointerException.getMessage()\\f[R], and will be printed as the\n+determine precisely which reference is \\f[CB]null\\f[R], and describes the\n+source with a null\\-detail message.\n+The null\\-detail message is calculated and returned by\n+\\f[CB]NullPointerException.getMessage()\\f[R], and will be printed as the\n@@ -1590,0 +1727,2 @@\n+.RS\n+.RE\n@@ -1591,1 +1730,1 @@\n-\\f[V]-XX:+ShowMessageBoxOnError\\f[R]\n+.B \\f[CB]\\-XX:+ShowMessageBoxOnError\\f[R]\n@@ -1597,0 +1736,2 @@\n+.RS\n+.RE\n@@ -1598,1 +1739,1 @@\n-\\f[V]-XX:StartFlightRecording=\\f[R]\\f[I]parameter\\f[R]\\f[V]=\\f[R]\\f[I]value\\f[R]\n+.B \\f[CB]\\-XX:StartFlightRecording=\\f[R]\\f[I]parameter\\f[R]\\f[CB]=\\f[R]\\f[I]value\\f[R]\n@@ -1600,1 +1741,1 @@\n-This option is equivalent to the \\f[V]JFR.start\\f[R] diagnostic command\n+This option is equivalent to the \\f[CB]JFR.start\\f[R] diagnostic command\n@@ -1602,1 +1743,1 @@\n-You can set the following \\f[I]parameter\\f[R]\\f[V]=\\f[R]\\f[I]value\\f[R]\n+You can set the following \\f[I]parameter\\f[R]\\f[CB]=\\f[R]\\f[I]value\\f[R]\n@@ -1606,1 +1747,1 @@\n-\\f[V]delay=\\f[R]\\f[I]time\\f[R]\n+.B \\f[CB]delay=\\f[R]\\f[I]time\\f[R]\n@@ -1609,3 +1750,3 @@\n-Append \\f[V]s\\f[R] to specify the time in seconds, \\f[V]m\\f[R] for\n-minutes, \\f[V]h\\f[R] for hours, or \\f[V]d\\f[R] for days (for example,\n-specifying \\f[V]10m\\f[R] means 10 minutes).\n+Append \\f[CB]s\\f[R] to specify the time in seconds, \\f[CB]m\\f[R] for\n+minutes, \\f[CB]h\\f[R] for hours, or \\f[CB]d\\f[R] for days (for example,\n+specifying \\f[CB]10m\\f[R] means 10 minutes).\n@@ -1613,0 +1754,2 @@\n+.RS\n+.RE\n@@ -1614,1 +1757,1 @@\n-\\f[V]disk=\\f[R]{\\f[V]true\\f[R]|\\f[V]false\\f[R]}\n+.B \\f[CB]disk=\\f[R]{\\f[CB]true\\f[R]|\\f[CB]false\\f[R]}\n@@ -1617,0 +1760,2 @@\n+.RS\n+.RE\n@@ -1618,1 +1763,1 @@\n-\\f[V]dumponexit=\\f[R]{\\f[V]true\\f[R]|\\f[V]false\\f[R]}\n+.B \\f[CB]dumponexit=\\f[R]{\\f[CB]true\\f[R]|\\f[CB]false\\f[R]}\n@@ -1620,1 +1765,1 @@\n-If enabled and a \\f[V]filename\\f[R] is not entered, the recording is\n+If enabled and a \\f[CB]filename\\f[R] is not entered, the recording is\n@@ -1622,1 +1767,1 @@\n-The file name is a system-generated name that contains the process ID,\n+The file name is a system\\-generated name that contains the process ID,\n@@ -1624,1 +1769,1 @@\n-\\f[V]hotspot-pid-47496-id-1-2018_01_25_19_10_41.jfr\\f[R].\n+\\f[CB]hotspot\\-pid\\-47496\\-id\\-1\\-2018_01_25_19_10_41.jfr\\f[R].\n@@ -1626,0 +1771,2 @@\n+.RS\n+.RE\n@@ -1627,1 +1774,1 @@\n-\\f[V]duration=\\f[R]\\f[I]time\\f[R]\n+.B \\f[CB]duration=\\f[R]\\f[I]time\\f[R]\n@@ -1629,3 +1776,3 @@\n-Append \\f[V]s\\f[R] to specify the time in seconds, \\f[V]m\\f[R] for\n-minutes, \\f[V]h\\f[R] for hours, or \\f[V]d\\f[R] for days (for example,\n-specifying \\f[V]5h\\f[R] means 5 hours).\n+Append \\f[CB]s\\f[R] to specify the time in seconds, \\f[CB]m\\f[R] for\n+minutes, \\f[CB]h\\f[R] for hours, or \\f[CB]d\\f[R] for days (for example,\n+specifying \\f[CB]5h\\f[R] means 5 hours).\n@@ -1634,0 +1781,2 @@\n+.RS\n+.RE\n@@ -1635,1 +1784,1 @@\n-\\f[V]filename=\\f[R]\\f[I]path\\f[R]\n+.B \\f[CB]filename=\\f[R]\\f[I]path\\f[R]\n@@ -1640,1 +1789,1 @@\n-\\f[V]recording.jfr\\f[R]\n+\\f[CB]recording.jfr\\f[R]\n@@ -1642,1 +1791,1 @@\n-\\f[V]\/home\/user\/recordings\/recording.jfr\\f[R]\n+\\f[CB]\/home\/user\/recordings\/recording.jfr\\f[R]\n@@ -1644,1 +1793,1 @@\n-\\f[V]c:\\[rs]recordings\\[rs]recording.jfr\\f[R]\n+\\f[CB]c:\\\\recordings\\\\recording.jfr\\f[R]\n@@ -1647,1 +1796,1 @@\n-\\f[V]name=\\f[R]\\f[I]identifier\\f[R]\n+.B \\f[CB]name=\\f[R]\\f[I]identifier\\f[R]\n@@ -1649,0 +1798,2 @@\n+.RS\n+.RE\n@@ -1650,1 +1801,1 @@\n-\\f[V]maxage=\\f[R]\\f[I]time\\f[R]\n+.B \\f[CB]maxage=\\f[R]\\f[I]time\\f[R]\n@@ -1652,5 +1803,5 @@\n-This parameter is valid only when the \\f[V]disk\\f[R] parameter is set to\n-\\f[V]true\\f[R].\n-Append \\f[V]s\\f[R] to specify the time in seconds, \\f[V]m\\f[R] for\n-minutes, \\f[V]h\\f[R] for hours, or \\f[V]d\\f[R] for days (for example,\n-specifying \\f[V]30s\\f[R] means 30 seconds).\n+This parameter is valid only when the \\f[CB]disk\\f[R] parameter is set to\n+\\f[CB]true\\f[R].\n+Append \\f[CB]s\\f[R] to specify the time in seconds, \\f[CB]m\\f[R] for\n+minutes, \\f[CB]h\\f[R] for hours, or \\f[CB]d\\f[R] for days (for example,\n+specifying \\f[CB]30s\\f[R] means 30 seconds).\n@@ -1658,1 +1809,3 @@\n-to \\f[V]0s\\f[R].\n+to \\f[CB]0s\\f[R].\n+.RS\n+.RE\n@@ -1660,1 +1813,1 @@\n-\\f[V]maxsize=\\f[R]\\f[I]size\\f[R]\n+.B \\f[CB]maxsize=\\f[R]\\f[I]size\\f[R]\n@@ -1663,6 +1816,6 @@\n-This parameter is valid only when the \\f[V]disk\\f[R] parameter is set to\n-\\f[V]true\\f[R].\n-The value must not be less than the value for the \\f[V]maxchunksize\\f[R]\n-parameter set with \\f[V]-XX:FlightRecorderOptions\\f[R].\n-Append \\f[V]m\\f[R] or \\f[V]M\\f[R] to specify the size in megabytes, or\n-\\f[V]g\\f[R] or \\f[V]G\\f[R] to specify the size in gigabytes.\n+This parameter is valid only when the \\f[CB]disk\\f[R] parameter is set to\n+\\f[CB]true\\f[R].\n+The value must not be less than the value for the \\f[CB]maxchunksize\\f[R]\n+parameter set with \\f[CB]\\-XX:FlightRecorderOptions\\f[R].\n+Append \\f[CB]m\\f[R] or \\f[CB]M\\f[R] to specify the size in megabytes, or\n+\\f[CB]g\\f[R] or \\f[CB]G\\f[R] to specify the size in gigabytes.\n@@ -1670,1 +1823,3 @@\n-parameter is set to \\f[V]0\\f[R].\n+parameter is set to \\f[CB]0\\f[R].\n+.RS\n+.RE\n@@ -1672,1 +1827,1 @@\n-\\f[V]path-to-gc-roots=\\f[R]{\\f[V]true\\f[R]|\\f[V]false\\f[R]}\n+.B \\f[CB]path\\-to\\-gc\\-roots=\\f[R]{\\f[CB]true\\f[R]|\\f[CB]false\\f[R]}\n@@ -1679,1 +1834,1 @@\n-it is time-consuming.\n+it is time\\-consuming.\n@@ -1682,3 +1837,3 @@\n-If the \\f[V]settings\\f[R] parameter is set to \\f[V]profile\\f[R], the\n-stack trace from where the potential leaking object was allocated is\n-included in the information collected.\n+If the \\f[CB]settings\\f[R] parameter is set to \\f[CB]profile\\f[R], the stack\n+trace from where the potential leaking object was allocated is included\n+in the information collected.\n@@ -1687,1 +1842,1 @@\n-\\f[V]settings=\\f[R]\\f[I]path\\f[R]\n+.B \\f[CB]settings=\\f[R]\\f[I]path\\f[R]\n@@ -1689,2 +1844,2 @@\n-By default, the \\f[V]default.jfc\\f[R] file is used, which is located in\n-\\f[V]JAVA_HOME\/lib\/jfr\\f[R].\n+By default, the \\f[CB]default.jfc\\f[R] file is used, which is located in\n+\\f[CB]JAVA_HOME\/lib\/jfr\\f[R].\n@@ -1708,1 +1863,1 @@\n-\\f[V]option=\\f[R]\\f[I]value\\f[R]\n+.B \\f[CB]option=\\f[R]\\f[I]value\\f[R]\n@@ -1710,1 +1865,3 @@\n-To list available options, use the \\f[V]JAVA_HOME\\f[R]\/bin\/jfr tool.\n+To list available options, use the \\f[CB]JAVA_HOME\\f[R]\/bin\/jfr tool.\n+.RS\n+.RE\n@@ -1712,1 +1869,1 @@\n-\\f[V]event-setting=\\f[R]\\f[I]value\\f[R]\n+.B \\f[CB]event\\-setting=\\f[R]\\f[I]value\\f[R]\n@@ -1714,1 +1871,1 @@\n-Use the form: \\f[V]<event-name>#<setting-name>=<value>\\f[R].\n+Use the form: \\f[CB]<event\\-name>#<setting\\-name>=<value>\\f[R].\n@@ -1716,0 +1873,2 @@\n+.RS\n+.RE\n@@ -1727,1 +1886,1 @@\n-\\f[V]-XX:ThreadStackSize=\\f[R]\\f[I]size\\f[R]\n+.B \\f[CB]\\-XX:ThreadStackSize=\\f[R]\\f[I]size\\f[R]\n@@ -1729,2 +1888,2 @@\n-Use of a scaling suffix, such as \\f[V]k\\f[R], results in the scaling of\n-the kilobytes value so that \\f[V]-XX:ThreadStackSize=1k\\f[R] sets the\n+Use of a scaling suffix, such as \\f[CB]k\\f[R], results in the scaling of\n+the kilobytes value so that \\f[CB]\\-XX:ThreadStackSize=1k\\f[R] sets the\n@@ -1735,1 +1894,1 @@\n-Linux\/x64 (64-bit): 1024 KB\n+Linux\/x64 (64\\-bit): 1024 KB\n@@ -1737,1 +1896,1 @@\n-macOS (64-bit): 1024 KB\n+macOS (64\\-bit): 1024 KB\n@@ -1746,2 +1905,2 @@\n--XX:ThreadStackSize=1k\n--XX:ThreadStackSize=1024\n+\\-XX:ThreadStackSize=1k\n+\\-XX:ThreadStackSize=1024\n@@ -1751,1 +1910,1 @@\n-This option is similar to \\f[V]-Xss\\f[R].\n+This option is similar to \\f[CB]\\-Xss\\f[R].\n@@ -1754,1 +1913,1 @@\n-\\f[V]-XX:-UseCompressedOops\\f[R]\n+.B \\f[CB]\\-XX:\\-UseCompressedOops\\f[R]\n@@ -1764,1 +1923,1 @@\n-32-bit offsets instead of 64-bit pointers, which typically increases\n+32\\-bit offsets instead of 64\\-bit pointers, which typically increases\n@@ -1767,1 +1926,1 @@\n-This option works only for 64-bit JVMs.\n+This option works only for 64\\-bit JVMs.\n@@ -1771,1 +1930,1 @@\n-See the \\f[V]-XX:ObjectAlignmentInBytes\\f[R] option.\n+See the \\f[CB]\\-XX:ObjectAlignmentInBytes\\f[R] option.\n@@ -1774,1 +1933,1 @@\n-\\f[V]-XX:-UseContainerSupport\\f[R]\n+.B \\f[CB]\\-XX:\\-UseContainerSupport\\f[R]\n@@ -1780,1 +1939,1 @@\n-If supported, the default for this flag is \\f[V]true\\f[R], and container\n+If supported, the default for this flag is \\f[CB]true\\f[R], and container\n@@ -1782,1 +1941,1 @@\n-It can be disabled with \\f[V]-XX:-UseContainerSupport\\f[R].\n+It can be disabled with \\f[CB]\\-XX:\\-UseContainerSupport\\f[R].\n@@ -1788,1 +1947,1 @@\n-Use \\f[V]-Xlog:os+container=trace\\f[R] for maximum logging of container\n+Use \\f[CB]\\-Xlog:os+container=trace\\f[R] for maximum logging of container\n@@ -1790,2 +1949,2 @@\n-See \\f[B]Enable Logging with the JVM Unified Logging Framework\\f[R] for\n-a description of using Unified Logging.\n+See \\f[B]Enable Logging with the JVM Unified Logging Framework\\f[R] for a\n+description of using Unified Logging.\n@@ -1794,1 +1953,1 @@\n-\\f[V]-XX:+UseHugeTLBFS\\f[R]\n+.B \\f[CB]\\-XX:+UseHugeTLBFS\\f[R]\n@@ -1796,1 +1955,1 @@\n-\\f[V]-XX:+UseLargePages\\f[R].\n+\\f[CB]\\-XX:+UseLargePages\\f[R].\n@@ -1798,1 +1957,1 @@\n-This option pre-allocates all large pages up-front, when memory is\n+This option pre\\-allocates all large pages up\\-front, when memory is\n@@ -1800,1 +1959,1 @@\n-large pages memory areas; see \\f[V]-XX:UseTransparentHugePages\\f[R] if\n+large pages memory areas; see \\f[CB]\\-XX:UseTransparentHugePages\\f[R] if\n@@ -1807,1 +1966,1 @@\n-\\f[V]-XX:+UseLargePages\\f[R]\n+.B \\f[CB]\\-XX:+UseLargePages\\f[R]\n@@ -1816,3 +1975,3 @@\n-\\f[V]-XX:+UseTransparentHugePages\\f[R]\n-\\f[B]Linux only:\\f[R] Enables the use of large pages that can\n-dynamically grow or shrink.\n+.B \\f[CB]\\-XX:+UseTransparentHugePages\\f[R]\n+\\f[B]Linux only:\\f[R] Enables the use of large pages that can dynamically\n+grow or shrink.\n@@ -1823,0 +1982,2 @@\n+.RS\n+.RE\n@@ -1824,1 +1985,1 @@\n-\\f[V]-XX:+AllowUserSignalHandlers\\f[R]\n+.B \\f[CB]\\-XX:+AllowUserSignalHandlers\\f[R]\n@@ -1828,0 +1989,2 @@\n+.RS\n+.RE\n@@ -1829,1 +1992,1 @@\n-\\f[V]-XX:VMOptionsFile=\\f[R]\\f[I]filename\\f[R]\n+.B \\f[CB]\\-XX:VMOptionsFile=\\f[R]\\f[I]filename\\f[R]\n@@ -1831,1 +1994,3 @@\n-\\f[V]java -XX:VMOptionsFile=\/var\/my_vm_options HelloWorld\\f[R].\n+\\f[CB]java\\ \\-XX:VMOptionsFile=\/var\/my_vm_options\\ HelloWorld\\f[R].\n+.RS\n+.RE\n@@ -1833,1 +1998,1 @@\n-\\f[V]-XX:UseBranchProtection=\\f[R]\\f[I]mode\\f[R]\n+.B \\f[CB]\\-XX:UseBranchProtection=\\f[R]\\f[I]mode\\f[R]\n@@ -1835,1 +2000,1 @@\n-All options other than \\f[V]none\\f[R] require the VM to have been built\n+All options other than \\f[CB]none\\f[R] require the VM to have been built\n@@ -1843,1 +2008,1 @@\n-\\f[V]none\\f[R]\n+.B \\f[CB]none\\f[R]\n@@ -1846,0 +2011,2 @@\n+.RS\n+.RE\n@@ -1847,1 +2014,1 @@\n-\\f[V]standard\\f[R]\n+.B \\f[CB]standard\\f[R]\n@@ -1849,0 +2016,2 @@\n+.RS\n+.RE\n@@ -1850,1 +2019,1 @@\n-\\f[V]pac-ret\\f[R]\n+.B \\f[CB]pac\\-ret\\f[R]\n@@ -1853,0 +2022,2 @@\n+.RS\n+.RE\n@@ -1856,1 +2027,1 @@\n-These \\f[V]java\\f[R] options control the dynamic just-in-time (JIT)\n+These \\f[CB]java\\f[R] options control the dynamic just\\-in\\-time (JIT)\n@@ -1859,1 +2030,1 @@\n-\\f[V]-XX:AllocateInstancePrefetchLines=\\f[R]\\f[I]lines\\f[R]\n+.B \\f[CB]\\-XX:AllocateInstancePrefetchLines=\\f[R]\\f[I]lines\\f[R]\n@@ -1866,1 +2037,1 @@\n-\\f[V]-XX:AllocateInstancePrefetchLines=1\\f[R]\n+\\f[CB]\\-XX:AllocateInstancePrefetchLines=1\\f[R]\n@@ -1870,1 +2041,1 @@\n-\\f[V]-XX:AllocatePrefetchDistance=\\f[R]\\f[I]size\\f[R]\n+.B \\f[CB]\\-XX:AllocatePrefetchDistance=\\f[R]\\f[I]size\\f[R]\n@@ -1881,4 +2052,4 @@\n-Append the letter \\f[V]k\\f[R] or \\f[V]K\\f[R] to indicate kilobytes,\n-\\f[V]m\\f[R] or \\f[V]M\\f[R] to indicate megabytes, or \\f[V]g\\f[R] or\n-\\f[V]G\\f[R] to indicate gigabytes.\n-The default value is set to -1.\n+Append the letter \\f[CB]k\\f[R] or \\f[CB]K\\f[R] to indicate kilobytes,\n+\\f[CB]m\\f[R] or \\f[CB]M\\f[R] to indicate megabytes, or \\f[CB]g\\f[R] or\n+\\f[CB]G\\f[R] to indicate gigabytes.\n+The default value is set to \\-1.\n@@ -1890,1 +2061,1 @@\n-\\f[V]-XX:AllocatePrefetchDistance=1024\\f[R]\n+\\f[CB]\\-XX:AllocatePrefetchDistance=1024\\f[R]\n@@ -1894,1 +2065,1 @@\n-\\f[V]-XX:AllocatePrefetchInstr=\\f[R]\\f[I]instruction\\f[R]\n+.B \\f[CB]\\-XX:AllocatePrefetchInstr=\\f[R]\\f[I]instruction\\f[R]\n@@ -1903,1 +2074,1 @@\n-\\f[V]-XX:AllocatePrefetchInstr=0\\f[R]\n+\\f[CB]\\-XX:AllocatePrefetchInstr=0\\f[R]\n@@ -1907,1 +2078,1 @@\n-\\f[V]-XX:AllocatePrefetchLines=\\f[R]\\f[I]lines\\f[R]\n+.B \\f[CB]\\-XX:AllocatePrefetchLines=\\f[R]\\f[I]lines\\f[R]\n@@ -1918,1 +2089,1 @@\n-\\f[V]-XX:AllocatePrefetchLines=5\\f[R]\n+\\f[CB]\\-XX:AllocatePrefetchLines=5\\f[R]\n@@ -1922,1 +2093,1 @@\n-\\f[V]-XX:AllocatePrefetchStepSize=\\f[R]\\f[I]size\\f[R]\n+.B \\f[CB]\\-XX:AllocatePrefetchStepSize=\\f[R]\\f[I]size\\f[R]\n@@ -1924,3 +2095,3 @@\n-Append the letter \\f[V]k\\f[R] or \\f[V]K\\f[R] to indicate kilobytes,\n-\\f[V]m\\f[R] or \\f[V]M\\f[R] to indicate megabytes, \\f[V]g\\f[R] or\n-\\f[V]G\\f[R] to indicate gigabytes.\n+Append the letter \\f[CB]k\\f[R] or \\f[CB]K\\f[R] to indicate kilobytes,\n+\\f[CB]m\\f[R] or \\f[CB]M\\f[R] to indicate megabytes, \\f[CB]g\\f[R] or \\f[CB]G\\f[R]\n+to indicate gigabytes.\n@@ -1931,1 +2102,1 @@\n-\\f[V]-XX:AllocatePrefetchStepSize=16\\f[R]\n+\\f[CB]\\-XX:AllocatePrefetchStepSize=16\\f[R]\n@@ -1935,1 +2106,1 @@\n-\\f[V]-XX:AllocatePrefetchStyle=\\f[R]\\f[I]style\\f[R]\n+.B \\f[CB]\\-XX:AllocatePrefetchStyle=\\f[R]\\f[I]style\\f[R]\n@@ -1940,1 +2111,1 @@\n-\\f[V]0\\f[R]\n+.B \\f[CB]0\\f[R]\n@@ -1942,0 +2113,2 @@\n+.RS\n+.RE\n@@ -1943,1 +2116,1 @@\n-\\f[V]1\\f[R]\n+.B \\f[CB]1\\f[R]\n@@ -1946,0 +2119,2 @@\n+.RS\n+.RE\n@@ -1947,2 +2122,2 @@\n-\\f[V]2\\f[R]\n-Use the thread-local allocation block (TLAB) watermark pointer to\n+.B \\f[CB]2\\f[R]\n+Use the thread\\-local allocation block (TLAB) watermark pointer to\n@@ -1950,0 +2125,2 @@\n+.RS\n+.RE\n@@ -1951,1 +2128,1 @@\n-\\f[V]3\\f[R]\n+.B \\f[CB]3\\f[R]\n@@ -1953,0 +2130,2 @@\n+.RS\n+.RE\n@@ -1955,1 +2134,1 @@\n-\\f[V]-XX:+BackgroundCompilation\\f[R]\n+.B \\f[CB]\\-XX:+BackgroundCompilation\\f[R]\n@@ -1959,2 +2138,4 @@\n-\\f[V]-XX:-BackgroundCompilation\\f[R] (this is equivalent to specifying\n-\\f[V]-Xbatch\\f[R]).\n+\\f[CB]\\-XX:\\-BackgroundCompilation\\f[R] (this is equivalent to specifying\n+\\f[CB]\\-Xbatch\\f[R]).\n+.RS\n+.RE\n@@ -1962,1 +2143,1 @@\n-\\f[V]-XX:CICompilerCount=\\f[R]\\f[I]threads\\f[R]\n+.B \\f[CB]\\-XX:CICompilerCount=\\f[R]\\f[I]threads\\f[R]\n@@ -1970,1 +2151,1 @@\n-\\f[V]-XX:CICompilerCount=2\\f[R]\n+\\f[CB]\\-XX:CICompilerCount=2\\f[R]\n@@ -1974,1 +2155,1 @@\n-\\f[V]-XX:+UseDynamicNumberOfCompilerThreads\\f[R]\n+.B \\f[CB]\\-XX:+UseDynamicNumberOfCompilerThreads\\f[R]\n@@ -1976,1 +2157,1 @@\n-\\f[V]-XX:CICompilerCount\\f[R].\n+\\f[CB]\\-XX:CICompilerCount\\f[R].\n@@ -1978,0 +2159,2 @@\n+.RS\n+.RE\n@@ -1979,1 +2162,1 @@\n-\\f[V]-XX:CompileCommand=\\f[R]\\f[I]command\\f[R]\\f[V],\\f[R]\\f[I]method\\f[R][\\f[V],\\f[R]\\f[I]option\\f[R]]\n+.B \\f[CB]\\-XX:CompileCommand=\\f[R]\\f[I]command\\f[R]\\f[CB],\\f[R]\\f[I]method\\f[R][\\f[CB],\\f[R]\\f[I]option\\f[R]]\n@@ -1981,2 +2164,2 @@\n-For example, to exclude the \\f[V]indexOf()\\f[R] method of the\n-\\f[V]String\\f[R] class from being compiled, use the following:\n+For example, to exclude the \\f[CB]indexOf()\\f[R] method of the\n+\\f[CB]String\\f[R] class from being compiled, use the following:\n@@ -1986,1 +2169,1 @@\n-\\f[V]-XX:CompileCommand=exclude,java\/lang\/String.indexOf\\f[R]\n+\\f[CB]\\-XX:CompileCommand=exclude,java\/lang\/String.indexOf\\f[R]\n@@ -1990,4 +2173,4 @@\n-subpackages separated by a slash (\\f[V]\/\\f[R]).\n-For easier cut-and-paste operations, it\\[aq]s also possible to use the\n-method name format produced by the \\f[V]-XX:+PrintCompilation\\f[R] and\n-\\f[V]-XX:+LogCompilation\\f[R] options:\n+subpackages separated by a slash (\\f[CB]\/\\f[R]).\n+For easier cut\\-and\\-paste operations, it\\[aq]s also possible to use the\n+method name format produced by the \\f[CB]\\-XX:+PrintCompilation\\f[R] and\n+\\f[CB]\\-XX:+LogCompilation\\f[R] options:\n@@ -1996,1 +2179,1 @@\n-\\f[V]-XX:CompileCommand=exclude,java.lang.String::indexOf\\f[R]\n+\\f[CB]\\-XX:CompileCommand=exclude,java.lang.String::indexOf\\f[R]\n@@ -2005,2 +2188,2 @@\n-For example, if you want to exclude only the \\f[V]indexOf(String)\\f[R]\n-method of the \\f[V]String\\f[R] class from being compiled, use the\n+For example, if you want to exclude only the \\f[CB]indexOf(String)\\f[R]\n+method of the \\f[CB]String\\f[R] class from being compiled, use the\n@@ -2010,1 +2193,1 @@\n-\\f[V]-XX:CompileCommand=\\[dq]exclude,java\/lang\/String.indexOf,(Ljava\/lang\/String;)I\\[dq]\\f[R]\n+\\f[CB]\\-XX:CompileCommand=\"exclude,java\/lang\/String.indexOf,(Ljava\/lang\/String;)I\"\\f[R]\n@@ -2015,1 +2198,1 @@\n-For example, to exclude all \\f[V]indexOf()\\f[R] methods in all classes\n+For example, to exclude all \\f[CB]indexOf()\\f[R] methods in all classes\n@@ -2019,1 +2202,1 @@\n-\\f[V]-XX:CompileCommand=exclude,*.indexOf\\f[R]\n+\\f[CB]\\-XX:CompileCommand=exclude,*.indexOf\\f[R]\n@@ -2024,1 +2207,1 @@\n-You can pass arguments to \\f[V]-XX:CompileCommand\\f[R] using spaces as\n+You can pass arguments to \\f[CB]\\-XX:CompileCommand\\f[R] using spaces as\n@@ -2028,1 +2211,1 @@\n-\\f[V]-XX:CompileCommand=\\[dq]exclude java\/lang\/String indexOf\\[dq]\\f[R]\n+\\f[CB]\\-XX:CompileCommand=\"exclude\\ java\/lang\/String\\ indexOf\"\\f[R]\n@@ -2032,2 +2215,2 @@\n-the \\f[V]-XX:CompileCommand\\f[R] options, the JIT compiler then reads\n-commands from the \\f[V].hotspot_compiler\\f[R] file.\n+the \\f[CB]\\-XX:CompileCommand\\f[R] options, the JIT compiler then reads\n+commands from the \\f[CB]\\&.hotspot_compiler\\f[R] file.\n@@ -2035,1 +2218,1 @@\n-\\f[V]-XX:CompileCommandFile\\f[R] option.\n+\\f[CB]\\-XX:CompileCommandFile\\f[R] option.\n@@ -2037,1 +2220,1 @@\n-To add several commands, either specify the \\f[V]-XX:CompileCommand\\f[R]\n+To add several commands, either specify the \\f[CB]\\-XX:CompileCommand\\f[R]\n@@ -2039,1 +2222,1 @@\n-separator (\\f[V]\\[rs]n\\f[R]).\n+separator (\\f[CB]\\\\n\\f[R]).\n@@ -2042,1 +2225,1 @@\n-\\f[V]break\\f[R]\n+.B \\f[CB]break\\f[R]\n@@ -2045,0 +2228,2 @@\n+.RS\n+.RE\n@@ -2046,1 +2231,1 @@\n-\\f[V]compileonly\\f[R]\n+.B \\f[CB]compileonly\\f[R]\n@@ -2048,1 +2233,1 @@\n-As an alternative, you can use the \\f[V]-XX:CompileOnly\\f[R] option,\n+As an alternative, you can use the \\f[CB]\\-XX:CompileOnly\\f[R] option,\n@@ -2050,0 +2235,2 @@\n+.RS\n+.RE\n@@ -2051,1 +2238,1 @@\n-\\f[V]dontinline\\f[R]\n+.B \\f[CB]dontinline\\f[R]\n@@ -2053,0 +2240,2 @@\n+.RS\n+.RE\n@@ -2054,1 +2243,1 @@\n-\\f[V]exclude\\f[R]\n+.B \\f[CB]exclude\\f[R]\n@@ -2056,0 +2245,2 @@\n+.RS\n+.RE\n@@ -2057,2 +2248,4 @@\n-\\f[V]help\\f[R]\n-Prints a help message for the \\f[V]-XX:CompileCommand\\f[R] option.\n+.B \\f[CB]help\\f[R]\n+Prints a help message for the \\f[CB]\\-XX:CompileCommand\\f[R] option.\n+.RS\n+.RE\n@@ -2060,1 +2253,1 @@\n-\\f[V]inline\\f[R]\n+.B \\f[CB]inline\\f[R]\n@@ -2062,0 +2255,2 @@\n+.RS\n+.RE\n@@ -2063,2 +2258,2 @@\n-\\f[V]log\\f[R]\n-Excludes compilation logging (with the \\f[V]-XX:+LogCompilation\\f[R]\n+.B \\f[CB]log\\f[R]\n+Excludes compilation logging (with the \\f[CB]\\-XX:+LogCompilation\\f[R]\n@@ -2067,0 +2262,2 @@\n+.RS\n+.RE\n@@ -2068,1 +2265,1 @@\n-\\f[V]option\\f[R]\n+.B \\f[CB]option\\f[R]\n@@ -2070,1 +2267,1 @@\n-last argument (\\f[V]option\\f[R]).\n+last argument (\\f[CB]option\\f[R]).\n@@ -2072,3 +2269,3 @@\n-For example, to enable the \\f[V]BlockLayoutByFrequency\\f[R] option for\n-the \\f[V]append()\\f[R] method of the \\f[V]StringBuffer\\f[R] class, use\n-the following:\n+For example, to enable the \\f[CB]BlockLayoutByFrequency\\f[R] option for\n+the \\f[CB]append()\\f[R] method of the \\f[CB]StringBuffer\\f[R] class, use the\n+following:\n@@ -2078,1 +2275,1 @@\n-\\f[V]-XX:CompileCommand=option,java\/lang\/StringBuffer.append,BlockLayoutByFrequency\\f[R]\n+\\f[CB]\\-XX:CompileCommand=option,java\/lang\/StringBuffer.append,BlockLayoutByFrequency\\f[R]\n@@ -2085,1 +2282,1 @@\n-\\f[V]print\\f[R]\n+.B \\f[CB]print\\f[R]\n@@ -2088,0 +2285,2 @@\n+.RS\n+.RE\n@@ -2089,1 +2288,1 @@\n-\\f[V]quiet\\f[R]\n+.B \\f[CB]quiet\\f[R]\n@@ -2092,4 +2291,3 @@\n-\\f[V]-XX:CompileCommand\\f[R] option are printed; for example, if you\n-exclude from compilation the \\f[V]indexOf()\\f[R] method of the\n-\\f[V]String\\f[R] class, then the following is printed to standard\n-output:\n+\\f[CB]\\-XX:CompileCommand\\f[R] option are printed; for example, if you\n+exclude from compilation the \\f[CB]indexOf()\\f[R] method of the\n+\\f[CB]String\\f[R] class, then the following is printed to standard output:\n@@ -2099,1 +2297,1 @@\n-\\f[V]CompilerOracle: exclude java\/lang\/String.indexOf\\f[R]\n+\\f[CB]CompilerOracle:\\ exclude\\ java\/lang\/String.indexOf\\f[R]\n@@ -2103,2 +2301,2 @@\n-\\f[V]-XX:CompileCommand=quiet\\f[R] option before other\n-\\f[V]-XX:CompileCommand\\f[R] options.\n+\\f[CB]\\-XX:CompileCommand=quiet\\f[R] option before other\n+\\f[CB]\\-XX:CompileCommand\\f[R] options.\n@@ -2108,1 +2306,1 @@\n-\\f[V]-XX:CompileCommandFile=\\f[R]\\f[I]filename\\f[R]\n+.B \\f[CB]\\-XX:CompileCommandFile=\\f[R]\\f[I]filename\\f[R]\n@@ -2110,1 +2308,1 @@\n-By default, the \\f[V].hotspot_compiler\\f[R] file is used to store\n+By default, the \\f[CB]\\&.hotspot_compiler\\f[R] file is used to store\n@@ -2116,2 +2314,2 @@\n-For example, this line prints assembly code for the \\f[V]toString()\\f[R]\n-method of the \\f[V]String\\f[R] class:\n+For example, this line prints assembly code for the \\f[CB]toString()\\f[R]\n+method of the \\f[CB]String\\f[R] class:\n@@ -2120,1 +2318,1 @@\n-\\f[V]print java\/lang\/String toString\\f[R]\n+\\f[CB]print\\ java\/lang\/String\\ toString\\f[R]\n@@ -2124,1 +2322,1 @@\n-then see the \\f[V]-XX:CompileCommand\\f[R] option.\n+then see the \\f[CB]\\-XX:CompileCommand\\f[R] option.\n@@ -2127,1 +2325,1 @@\n-\\f[V]-XX:CompilerDirectivesFile=\\f[R]\\f[I]file\\f[R]\n+.B \\f[CB]\\-XX:CompilerDirectivesFile=\\f[R]\\f[I]file\\f[R]\n@@ -2131,1 +2329,1 @@\n-[https:\/\/docs.oracle.com\/en\/java\/javase\/12\/vm\/compiler-control1.html#GUID-94AD8194-786A-4F19-BFFF-278F8E237F3A].\n+[https:\/\/docs.oracle.com\/en\/java\/javase\/12\/vm\/compiler\\-control1.html#GUID\\-94AD8194\\-786A\\-4F19\\-BFFF\\-278F8E237F3A].\n@@ -2134,2 +2332,2 @@\n-The \\f[V]-XX:CompilerDirectivesFile\\f[R] option has to be used together\n-with the \\f[V]-XX:UnlockDiagnosticVMOptions\\f[R] option that unlocks\n+The \\f[CB]\\-XX:CompilerDirectivesFile\\f[R] option has to be used together\n+with the \\f[CB]\\-XX:UnlockDiagnosticVMOptions\\f[R] option that unlocks\n@@ -2139,1 +2337,1 @@\n-\\f[V]-XX:+CompilerDirectivesPrint\\f[R]\n+.B \\f[CB]\\-XX:+CompilerDirectivesPrint\\f[R]\n@@ -2144,2 +2342,2 @@\n-The \\f[V]-XX:+CompilerDirectivesPrint\\f[R] option has to be used\n-together with the \\f[V]-XX:UnlockDiagnosticVMOptions\\f[R] option that\n+The \\f[CB]\\-XX:+CompilerDirectivesPrint\\f[R] option has to be used\n+together with the \\f[CB]\\-XX:UnlockDiagnosticVMOptions\\f[R] option that\n@@ -2149,1 +2347,1 @@\n-\\f[V]-XX:CompileOnly=\\f[R]\\f[I]methods\\f[R]\n+.B \\f[CB]\\-XX:CompileOnly=\\f[R]\\f[I]methods\\f[R]\n@@ -2155,3 +2353,3 @@\n-For example, to compile only the \\f[V]length()\\f[R] method of the\n-\\f[V]String\\f[R] class and the \\f[V]size()\\f[R] method of the\n-\\f[V]List\\f[R] class, use the following:\n+For example, to compile only the \\f[CB]length()\\f[R] method of the\n+\\f[CB]String\\f[R] class and the \\f[CB]size()\\f[R] method of the\n+\\f[CB]List\\f[R] class, use the following:\n@@ -2161,1 +2359,1 @@\n-\\f[V]-XX:CompileOnly=java\/lang\/String.length,java\/util\/List.size\\f[R]\n+\\f[CB]\\-XX:CompileOnly=java\/lang\/String.length,java\/util\/List.size\\f[R]\n@@ -2165,1 +2363,1 @@\n-subpackages separated by a slash (\\f[V]\/\\f[R]).\n+subpackages separated by a slash (\\f[CB]\/\\f[R]).\n@@ -2167,2 +2365,2 @@\n-method name format produced by the \\f[V]-XX:+PrintCompilation\\f[R] and\n-\\f[V]-XX:+LogCompilation\\f[R] options:\n+method name format produced by the \\f[CB]\\-XX:+PrintCompilation\\f[R] and\n+\\f[CB]\\-XX:+LogCompilation\\f[R] options:\n@@ -2171,1 +2369,1 @@\n-\\f[V]-XX:CompileOnly=java.lang.String::length,java.util.List::size\\f[R]\n+\\f[CB]\\-XX:CompileOnly=java.lang.String::length,java.util.List::size\\f[R]\n@@ -2181,3 +2379,3 @@\n--XX:CompileOnly=java\/lang\/String\n--XX:CompileOnly=java\/lang\n--XX:CompileOnly=.length\n+\\-XX:CompileOnly=java\/lang\/String\n+\\-XX:CompileOnly=java\/lang\n+\\-XX:CompileOnly=.length\n@@ -2188,1 +2386,1 @@\n-\\f[V]-XX:CompileThresholdScaling=\\f[R]\\f[I]scale\\f[R]\n+.B \\f[CB]\\-XX:CompileThresholdScaling=\\f[R]\\f[I]scale\\f[R]\n@@ -2192,1 +2390,1 @@\n-The \\f[V]CompileThresholdScaling\\f[R] option has a floating point value\n+The \\f[CB]CompileThresholdScaling\\f[R] option has a floating point value\n@@ -2195,1 +2393,1 @@\n-Setting \\f[V]CompileThresholdScaling\\f[R] to a value less than 1.0\n+Setting \\f[CB]CompileThresholdScaling\\f[R] to a value less than 1.0\n@@ -2198,2 +2396,4 @@\n-Setting \\f[V]CompileThresholdScaling\\f[R] to 0 is equivalent to\n-disabling compilation.\n+Setting \\f[CB]CompileThresholdScaling\\f[R] to 0 is equivalent to disabling\n+compilation.\n+.RS\n+.RE\n@@ -2201,1 +2401,1 @@\n-\\f[V]-XX:+DoEscapeAnalysis\\f[R]\n+.B \\f[CB]\\-XX:+DoEscapeAnalysis\\f[R]\n@@ -2205,1 +2405,3 @@\n-\\f[V]-XX:-DoEscapeAnalysis\\f[R].\n+\\f[CB]\\-XX:\\-DoEscapeAnalysis\\f[R].\n+.RS\n+.RE\n@@ -2207,1 +2409,1 @@\n-\\f[V]-XX:InitialCodeCacheSize=\\f[R]\\f[I]size\\f[R]\n+.B \\f[CB]\\-XX:InitialCodeCacheSize=\\f[R]\\f[I]size\\f[R]\n@@ -2209,3 +2411,3 @@\n-Append the letter \\f[V]k\\f[R] or \\f[V]K\\f[R] to indicate kilobytes,\n-\\f[V]m\\f[R] or \\f[V]M\\f[R] to indicate megabytes, or \\f[V]g\\f[R] or\n-\\f[V]G\\f[R] to indicate gigabytes.\n+Append the letter \\f[CB]k\\f[R] or \\f[CB]K\\f[R] to indicate kilobytes,\n+\\f[CB]m\\f[R] or \\f[CB]M\\f[R] to indicate megabytes, or \\f[CB]g\\f[R] or\n+\\f[CB]G\\f[R] to indicate gigabytes.\n@@ -2220,1 +2422,1 @@\n-\\f[V]-XX:InitialCodeCacheSize=32k\\f[R]\n+\\f[CB]\\-XX:InitialCodeCacheSize=32k\\f[R]\n@@ -2224,1 +2426,1 @@\n-\\f[V]-XX:+Inline\\f[R]\n+.B \\f[CB]\\-XX:+Inline\\f[R]\n@@ -2227,1 +2429,3 @@\n-To disable method inlining, specify \\f[V]-XX:-Inline\\f[R].\n+To disable method inlining, specify \\f[CB]\\-XX:\\-Inline\\f[R].\n+.RS\n+.RE\n@@ -2229,1 +2433,1 @@\n-\\f[V]-XX:InlineSmallCode=\\f[R]\\f[I]size\\f[R]\n+.B \\f[CB]\\-XX:InlineSmallCode=\\f[R]\\f[I]size\\f[R]\n@@ -2233,3 +2437,3 @@\n-Append the letter \\f[V]k\\f[R] or \\f[V]K\\f[R] to indicate kilobytes,\n-\\f[V]m\\f[R] or \\f[V]M\\f[R] to indicate megabytes, or \\f[V]g\\f[R] or\n-\\f[V]G\\f[R] to indicate gigabytes.\n+Append the letter \\f[CB]k\\f[R] or \\f[CB]K\\f[R] to indicate kilobytes,\n+\\f[CB]m\\f[R] or \\f[CB]M\\f[R] to indicate megabytes, or \\f[CB]g\\f[R] or\n+\\f[CB]G\\f[R] to indicate gigabytes.\n@@ -2242,1 +2446,1 @@\n-\\f[V]-XX:InlineSmallCode=1000\\f[R]\n+\\f[CB]\\-XX:InlineSmallCode=1000\\f[R]\n@@ -2246,1 +2450,1 @@\n-\\f[V]-XX:+LogCompilation\\f[R]\n+.B \\f[CB]\\-XX:+LogCompilation\\f[R]\n@@ -2248,1 +2452,1 @@\n-\\f[V]hotspot.log\\f[R] in the current working directory.\n+\\f[CB]hotspot.log\\f[R] in the current working directory.\n@@ -2250,1 +2454,1 @@\n-\\f[V]-XX:LogFile\\f[R] option.\n+\\f[CB]\\-XX:LogFile\\f[R] option.\n@@ -2255,2 +2459,2 @@\n-The \\f[V]-XX:+LogCompilation\\f[R] option has to be used together with\n-the \\f[V]-XX:UnlockDiagnosticVMOptions\\f[R] option that unlocks\n+The \\f[CB]\\-XX:+LogCompilation\\f[R] option has to be used together with\n+the \\f[CB]\\-XX:UnlockDiagnosticVMOptions\\f[R] option that unlocks\n@@ -2261,1 +2465,1 @@\n-\\f[V]-XX:+PrintCompilation\\f[R] option.\n+\\f[CB]\\-XX:+PrintCompilation\\f[R] option.\n@@ -2264,1 +2468,1 @@\n-\\f[V]-XX:FreqInlineSize=\\f[R]\\f[I]size\\f[R]\n+.B \\f[CB]\\-XX:FreqInlineSize=\\f[R]\\f[I]size\\f[R]\n@@ -2267,3 +2471,3 @@\n-Append the letter \\f[V]k\\f[R] or \\f[V]K\\f[R] to indicate kilobytes,\n-\\f[V]m\\f[R] or \\f[V]M\\f[R] to indicate megabytes, or \\f[V]g\\f[R] or\n-\\f[V]G\\f[R] to indicate gigabytes.\n+Append the letter \\f[CB]k\\f[R] or \\f[CB]K\\f[R] to indicate kilobytes,\n+\\f[CB]m\\f[R] or \\f[CB]M\\f[R] to indicate megabytes, or \\f[CB]g\\f[R] or\n+\\f[CB]G\\f[R] to indicate gigabytes.\n@@ -2275,1 +2479,1 @@\n-\\f[V]-XX:FreqInlineSize=325\\f[R]\n+\\f[CB]\\-XX:FreqInlineSize=325\\f[R]\n@@ -2279,1 +2483,1 @@\n-\\f[V]-XX:MaxInlineSize=\\f[R]\\f[I]size\\f[R]\n+.B \\f[CB]\\-XX:MaxInlineSize=\\f[R]\\f[I]size\\f[R]\n@@ -2283,3 +2487,3 @@\n-Append the letter \\f[V]k\\f[R] or \\f[V]K\\f[R] to indicate kilobytes,\n-\\f[V]m\\f[R] or \\f[V]M\\f[R] to indicate megabytes, or \\f[V]g\\f[R] or\n-\\f[V]G\\f[R] to indicate gigabytes.\n+Append the letter \\f[CB]k\\f[R] or \\f[CB]K\\f[R] to indicate kilobytes,\n+\\f[CB]m\\f[R] or \\f[CB]M\\f[R] to indicate megabytes, or \\f[CB]g\\f[R] or\n+\\f[CB]G\\f[R] to indicate gigabytes.\n@@ -2290,1 +2494,1 @@\n-\\f[V]-XX:MaxInlineSize=35\\f[R]\n+\\f[CB]\\-XX:MaxInlineSize=35\\f[R]\n@@ -2294,1 +2498,1 @@\n-\\f[V]-XX:C1MaxInlineSize=\\f[R]\\f[I]size\\f[R]\n+.B \\f[CB]\\-XX:C1MaxInlineSize=\\f[R]\\f[I]size\\f[R]\n@@ -2298,3 +2502,3 @@\n-Append the letter \\f[V]k\\f[R] or \\f[V]K\\f[R] to indicate kilobytes,\n-\\f[V]m\\f[R] or \\f[V]M\\f[R] to indicate megabytes, or \\f[V]g\\f[R] or\n-\\f[V]G\\f[R] to indicate gigabytes.\n+Append the letter \\f[CB]k\\f[R] or \\f[CB]K\\f[R] to indicate kilobytes,\n+\\f[CB]m\\f[R] or \\f[CB]M\\f[R] to indicate megabytes, or \\f[CB]g\\f[R] or\n+\\f[CB]G\\f[R] to indicate gigabytes.\n@@ -2305,1 +2509,1 @@\n-\\f[V]-XX:MaxInlineSize=35\\f[R]\n+\\f[CB]\\-XX:MaxInlineSize=35\\f[R]\n@@ -2309,1 +2513,1 @@\n-\\f[V]-XX:MaxTrivialSize=\\f[R]\\f[I]size\\f[R]\n+.B \\f[CB]\\-XX:MaxTrivialSize=\\f[R]\\f[I]size\\f[R]\n@@ -2313,3 +2517,3 @@\n-Append the letter \\f[V]k\\f[R] or \\f[V]K\\f[R] to indicate kilobytes,\n-\\f[V]m\\f[R] or \\f[V]M\\f[R] to indicate megabytes, or \\f[V]g\\f[R] or\n-\\f[V]G\\f[R] to indicate gigabytes.\n+Append the letter \\f[CB]k\\f[R] or \\f[CB]K\\f[R] to indicate kilobytes,\n+\\f[CB]m\\f[R] or \\f[CB]M\\f[R] to indicate megabytes, or \\f[CB]g\\f[R] or\n+\\f[CB]G\\f[R] to indicate gigabytes.\n@@ -2321,1 +2525,1 @@\n-\\f[V]-XX:MaxTrivialSize=6\\f[R]\n+\\f[CB]\\-XX:MaxTrivialSize=6\\f[R]\n@@ -2325,1 +2529,1 @@\n-\\f[V]-XX:C1MaxTrivialSize=\\f[R]\\f[I]size\\f[R]\n+.B \\f[CB]\\-XX:C1MaxTrivialSize=\\f[R]\\f[I]size\\f[R]\n@@ -2329,3 +2533,3 @@\n-Append the letter \\f[V]k\\f[R] or \\f[V]K\\f[R] to indicate kilobytes,\n-\\f[V]m\\f[R] or \\f[V]M\\f[R] to indicate megabytes, or \\f[V]g\\f[R] or\n-\\f[V]G\\f[R] to indicate gigabytes.\n+Append the letter \\f[CB]k\\f[R] or \\f[CB]K\\f[R] to indicate kilobytes,\n+\\f[CB]m\\f[R] or \\f[CB]M\\f[R] to indicate megabytes, or \\f[CB]g\\f[R] or\n+\\f[CB]G\\f[R] to indicate gigabytes.\n@@ -2337,1 +2541,1 @@\n-\\f[V]-XX:MaxTrivialSize=6\\f[R]\n+\\f[CB]\\-XX:MaxTrivialSize=6\\f[R]\n@@ -2341,1 +2545,1 @@\n-\\f[V]-XX:MaxNodeLimit=\\f[R]\\f[I]nodes\\f[R]\n+.B \\f[CB]\\-XX:MaxNodeLimit=\\f[R]\\f[I]nodes\\f[R]\n@@ -2349,1 +2553,1 @@\n-\\f[V]-XX:MaxNodeLimit=100000\\f[R]\n+\\f[CB]\\-XX:MaxNodeLimit=100000\\f[R]\n@@ -2353,1 +2557,1 @@\n-\\f[V]-XX:NonNMethodCodeHeapSize=\\f[R]\\f[I]size\\f[R]\n+.B \\f[CB]\\-XX:NonNMethodCodeHeapSize=\\f[R]\\f[I]size\\f[R]\n@@ -2360,1 +2564,1 @@\n-This flag is used only if \\f[V]-XX:SegmentedCodeCache\\f[R] is enabled.\n+This flag is used only if \\f[CB]\\-XX:SegmentedCodeCache\\f[R] is enabled.\n@@ -2363,1 +2567,1 @@\n-\\f[V]-XX:NonProfiledCodeHeapSize=\\f[R]\\f[I]size\\f[R]\n+.B \\f[CB]\\-XX:NonProfiledCodeHeapSize=\\f[R]\\f[I]size\\f[R]\n@@ -2366,1 +2570,3 @@\n-This flag is used only if \\f[V]-XX:SegmentedCodeCache\\f[R] is enabled.\n+This flag is used only if \\f[CB]\\-XX:SegmentedCodeCache\\f[R] is enabled.\n+.RS\n+.RE\n@@ -2368,2 +2574,2 @@\n-\\f[V]-XX:+OptimizeStringConcat\\f[R]\n-Enables the optimization of \\f[V]String\\f[R] concatenation operations.\n+.B \\f[CB]\\-XX:+OptimizeStringConcat\\f[R]\n+Enables the optimization of \\f[CB]String\\f[R] concatenation operations.\n@@ -2371,2 +2577,4 @@\n-To disable the optimization of \\f[V]String\\f[R] concatenation\n-operations, specify \\f[V]-XX:-OptimizeStringConcat\\f[R].\n+To disable the optimization of \\f[CB]String\\f[R] concatenation operations,\n+specify \\f[CB]\\-XX:\\-OptimizeStringConcat\\f[R].\n+.RS\n+.RE\n@@ -2374,1 +2582,1 @@\n-\\f[V]-XX:+PrintAssembly\\f[R]\n+.B \\f[CB]\\-XX:+PrintAssembly\\f[R]\n@@ -2376,2 +2584,2 @@\n-using the external \\f[V]hsdis-<arch>.so\\f[R] or \\f[V].dll\\f[R] library.\n-For 64-bit VM on Windows, it\\[aq]s \\f[V]hsdis-amd64.dll\\f[R].\n+using the external \\f[CB]hsdis\\-<arch>.so\\f[R] or \\f[CB]\\&.dll\\f[R] library.\n+For 64\\-bit VM on Windows, it\\[aq]s \\f[CB]hsdis\\-amd64.dll\\f[R].\n@@ -2383,2 +2591,2 @@\n-The \\f[V]-XX:+PrintAssembly\\f[R] option has to be used together with the\n-\\f[V]-XX:UnlockDiagnosticVMOptions\\f[R] option that unlocks diagnostic\n+The \\f[CB]\\-XX:+PrintAssembly\\f[R] option has to be used together with the\n+\\f[CB]\\-XX:UnlockDiagnosticVMOptions\\f[R] option that unlocks diagnostic\n@@ -2388,1 +2596,1 @@\n-\\f[V]-XX:ProfiledCodeHeapSize=\\f[R]\\f[I]size\\f[R]\n+.B \\f[CB]\\-XX:ProfiledCodeHeapSize=\\f[R]\\f[I]size\\f[R]\n@@ -2390,1 +2598,3 @@\n-This flag is used only if \\f[V]-XX:SegmentedCodeCache\\f[R] is enabled.\n+This flag is used only if \\f[CB]\\-XX:SegmentedCodeCache\\f[R] is enabled.\n+.RS\n+.RE\n@@ -2392,1 +2602,1 @@\n-\\f[V]-XX:+PrintCompilation\\f[R]\n+.B \\f[CB]\\-XX:+PrintCompilation\\f[R]\n@@ -2401,1 +2611,1 @@\n-\\f[V]-XX:+LogCompilation\\f[R] option.\n+\\f[CB]\\-XX:+LogCompilation\\f[R] option.\n@@ -2404,1 +2614,1 @@\n-\\f[V]-XX:+PrintInlining\\f[R]\n+.B \\f[CB]\\-XX:+PrintInlining\\f[R]\n@@ -2411,2 +2621,2 @@\n-The \\f[V]-XX:+PrintInlining\\f[R] option has to be used together with the\n-\\f[V]-XX:+UnlockDiagnosticVMOptions\\f[R] option that unlocks diagnostic\n+The \\f[CB]\\-XX:+PrintInlining\\f[R] option has to be used together with the\n+\\f[CB]\\-XX:+UnlockDiagnosticVMOptions\\f[R] option that unlocks diagnostic\n@@ -2416,5 +2626,5 @@\n-\\f[V]-XX:ReservedCodeCacheSize=\\f[R]\\f[I]size\\f[R]\n-Sets the maximum code cache size (in bytes) for JIT-compiled code.\n-Append the letter \\f[V]k\\f[R] or \\f[V]K\\f[R] to indicate kilobytes,\n-\\f[V]m\\f[R] or \\f[V]M\\f[R] to indicate megabytes, or \\f[V]g\\f[R] or\n-\\f[V]G\\f[R] to indicate gigabytes.\n+.B \\f[CB]\\-XX:ReservedCodeCacheSize=\\f[R]\\f[I]size\\f[R]\n+Sets the maximum code cache size (in bytes) for JIT\\-compiled code.\n+Append the letter \\f[CB]k\\f[R] or \\f[CB]K\\f[R] to indicate kilobytes,\n+\\f[CB]m\\f[R] or \\f[CB]M\\f[R] to indicate megabytes, or \\f[CB]g\\f[R] or\n+\\f[CB]G\\f[R] to indicate gigabytes.\n@@ -2422,1 +2632,1 @@\n-compilation with the option \\f[V]-XX:-TieredCompilation\\f[R], then the\n+compilation with the option \\f[CB]\\-XX:\\-TieredCompilation\\f[R], then the\n@@ -2426,1 +2636,3 @@\n-cache size; see the option \\f[V]-XX:InitialCodeCacheSize\\f[R].\n+cache size; see the option \\f[CB]\\-XX:InitialCodeCacheSize\\f[R].\n+.RS\n+.RE\n@@ -2428,1 +2640,1 @@\n-\\f[V]-XX:RTMAbortRatio=\\f[R]\\f[I]abort_ratio\\f[R]\n+.B \\f[CB]\\-XX:RTMAbortRatio=\\f[R]\\f[I]abort_ratio\\f[R]\n@@ -2433,1 +2645,1 @@\n-This ratio is used when the \\f[V]-XX:+UseRTMDeopt\\f[R] option is\n+This ratio is used when the \\f[CB]\\-XX:+UseRTMDeopt\\f[R] option is\n@@ -2438,0 +2650,2 @@\n+.RS\n+.RE\n@@ -2439,1 +2653,1 @@\n-\\f[V]-XX:RTMRetryCount=\\f[R]\\f[I]number_of_retries\\f[R]\n+.B \\f[CB]\\-XX:RTMRetryCount=\\f[R]\\f[I]number_of_retries\\f[R]\n@@ -2444,1 +2658,3 @@\n-The \\f[V]-XX:UseRTMLocking\\f[R] option must be enabled.\n+The \\f[CB]\\-XX:UseRTMLocking\\f[R] option must be enabled.\n+.RS\n+.RE\n@@ -2446,1 +2662,1 @@\n-\\f[V]-XX:+SegmentedCodeCache\\f[R]\n+.B \\f[CB]\\-XX:+SegmentedCodeCache\\f[R]\n@@ -2449,2 +2665,2 @@\n-With \\f[V]-XX:+SegmentedCodeCache\\f[R], separate segments will be used\n-for non-method, profiled method, and non-profiled method code.\n+With \\f[CB]\\-XX:+SegmentedCodeCache\\f[R], separate segments will be used\n+for non\\-method, profiled method, and non\\-profiled method code.\n@@ -2458,2 +2674,2 @@\n-(\\f[V]-XX:+TieredCompilation\\f[R] ) and the reserved code cache size\n-(\\f[V]-XX:ReservedCodeCacheSize\\f[R]) is at least 240 MB.\n+(\\f[CB]\\-XX:+TieredCompilation\\f[R] ) and the reserved code cache size\n+(\\f[CB]\\-XX:ReservedCodeCacheSize\\f[R]) is at least 240 MB.\n@@ -2462,1 +2678,1 @@\n-\\f[V]-XX:StartAggressiveSweepingAt=\\f[R]\\f[I]percent\\f[R]\n+.B \\f[CB]\\-XX:StartAggressiveSweepingAt=\\f[R]\\f[I]percent\\f[R]\n@@ -2466,0 +2682,2 @@\n+.RS\n+.RE\n@@ -2467,1 +2685,1 @@\n-\\f[V]-XX:-TieredCompilation\\f[R]\n+.B \\f[CB]\\-XX:\\-TieredCompilation\\f[R]\n@@ -2470,0 +2688,2 @@\n+.RS\n+.RE\n@@ -2471,1 +2691,1 @@\n-\\f[V]-XX:UseSSE=\\f[R]\\f[I]version\\f[R]\n+.B \\f[CB]\\-XX:UseSSE=\\f[R]\\f[I]version\\f[R]\n@@ -2474,0 +2694,2 @@\n+.RS\n+.RE\n@@ -2475,1 +2697,1 @@\n-\\f[V]-XX:UseAVX=\\f[R]\\f[I]version\\f[R]\n+.B \\f[CB]\\-XX:UseAVX=\\f[R]\\f[I]version\\f[R]\n@@ -2478,0 +2700,2 @@\n+.RS\n+.RE\n@@ -2479,2 +2703,2 @@\n-\\f[V]-XX:+UseAES\\f[R]\n-Enables hardware-based AES intrinsics for hardware that supports it.\n+.B \\f[CB]\\-XX:+UseAES\\f[R]\n+Enables hardware\\-based AES intrinsics for hardware that supports it.\n@@ -2483,2 +2707,2 @@\n-The \\f[V]-XX:+UseAES\\f[R] is used in conjunction with\n-\\f[V]UseAESIntrinsics\\f[R].\n+The \\f[CB]\\-XX:+UseAES\\f[R] is used in conjunction with\n+\\f[CB]UseAESIntrinsics\\f[R].\n@@ -2486,1 +2710,3 @@\n-\\f[V]-XX:+UnlockDiagnosticVMOptions\\f[R].\n+\\f[CB]\\-XX:+UnlockDiagnosticVMOptions\\f[R].\n+.RS\n+.RE\n@@ -2488,1 +2714,1 @@\n-\\f[V]-XX:+UseAESIntrinsics\\f[R]\n+.B \\f[CB]\\-XX:+UseAESIntrinsics\\f[R]\n@@ -2490,4 +2716,4 @@\n-Specifying \\f[V]-XX:+UseAESIntrinsics\\f[R] is equivalent to also\n-enabling \\f[V]-XX:+UseAES\\f[R].\n-To disable hardware-based AES intrinsics, specify\n-\\f[V]-XX:-UseAES -XX:-UseAESIntrinsics\\f[R].\n+Specifying \\f[CB]\\-XX:+UseAESIntrinsics\\f[R] is equivalent to also\n+enabling \\f[CB]\\-XX:+UseAES\\f[R].\n+To disable hardware\\-based AES intrinsics, specify\n+\\f[CB]\\-XX:\\-UseAES\\ \\-XX:\\-UseAESIntrinsics\\f[R].\n@@ -2498,1 +2724,1 @@\n-\\f[V]-XX:+UseAES -XX:+UseAESIntrinsics\\f[R]\n+\\f[CB]\\-XX:+UseAES\\ \\-XX:+UseAESIntrinsics\\f[R]\n@@ -2502,1 +2728,1 @@\n-\\f[V]-XX:+UnlockDiagnosticVMOptions\\f[R].\n+\\f[CB]\\-XX:+UnlockDiagnosticVMOptions\\f[R].\n@@ -2505,2 +2731,4 @@\n-\\f[V]-XX:+UseAESCTRIntrinsics\\f[R]\n-Analogous to \\f[V]-XX:+UseAESIntrinsics\\f[R] enables AES\/CTR intrinsics.\n+.B \\f[CB]\\-XX:+UseAESCTRIntrinsics\\f[R]\n+Analogous to \\f[CB]\\-XX:+UseAESIntrinsics\\f[R] enables AES\/CTR intrinsics.\n+.RS\n+.RE\n@@ -2508,1 +2736,1 @@\n-\\f[V]-XX:+UseGHASHIntrinsics\\f[R]\n+.B \\f[CB]\\-XX:+UseGHASHIntrinsics\\f[R]\n@@ -2513,1 +2741,3 @@\n-\\f[V]-XX:+UnlockDiagnosticVMOptions\\f[R].\n+\\f[CB]\\-XX:+UnlockDiagnosticVMOptions\\f[R].\n+.RS\n+.RE\n@@ -2515,1 +2745,1 @@\n-\\f[V]-XX:+UseBASE64Intrinsics\\f[R]\n+.B \\f[CB]\\-XX:+UseBASE64Intrinsics\\f[R]\n@@ -2517,1 +2747,1 @@\n-\\f[V]java.util.Base64\\f[R].\n+\\f[CB]java.util.Base64\\f[R].\n@@ -2520,1 +2750,3 @@\n-\\f[V]-XX:+UnlockDiagnosticVMOptions\\f[R].\n+\\f[CB]\\-XX:+UnlockDiagnosticVMOptions\\f[R].\n+.RS\n+.RE\n@@ -2522,1 +2754,1 @@\n-\\f[V]-XX:+UseAdler32Intrinsics\\f[R]\n+.B \\f[CB]\\-XX:+UseAdler32Intrinsics\\f[R]\n@@ -2524,1 +2756,1 @@\n-\\f[V]java.util.zip.Adler32\\f[R].\n+\\f[CB]java.util.zip.Adler32\\f[R].\n@@ -2527,1 +2759,3 @@\n-\\f[V]-XX:+UnlockDiagnosticVMOptions\\f[R].\n+\\f[CB]\\-XX:+UnlockDiagnosticVMOptions\\f[R].\n+.RS\n+.RE\n@@ -2529,2 +2763,2 @@\n-\\f[V]-XX:+UseCRC32Intrinsics\\f[R]\n-Controls the use of CRC32 intrinsics for \\f[V]java.util.zip.CRC32\\f[R].\n+.B \\f[CB]\\-XX:+UseCRC32Intrinsics\\f[R]\n+Controls the use of CRC32 intrinsics for \\f[CB]java.util.zip.CRC32\\f[R].\n@@ -2533,1 +2767,3 @@\n-\\f[V]-XX:+UnlockDiagnosticVMOptions\\f[R].\n+\\f[CB]\\-XX:+UnlockDiagnosticVMOptions\\f[R].\n+.RS\n+.RE\n@@ -2535,3 +2771,2 @@\n-\\f[V]-XX:+UseCRC32CIntrinsics\\f[R]\n-Controls the use of CRC32C intrinsics for\n-\\f[V]java.util.zip.CRC32C\\f[R].\n+.B \\f[CB]\\-XX:+UseCRC32CIntrinsics\\f[R]\n+Controls the use of CRC32C intrinsics for \\f[CB]java.util.zip.CRC32C\\f[R].\n@@ -2540,1 +2775,3 @@\n-\\f[V]-XX:+UnlockDiagnosticVMOptions\\f[R].\n+\\f[CB]\\-XX:+UnlockDiagnosticVMOptions\\f[R].\n+.RS\n+.RE\n@@ -2542,6 +2779,6 @@\n-\\f[V]-XX:+UseSHA\\f[R]\n-Enables hardware-based intrinsics for SHA crypto hash functions for some\n-hardware.\n-The \\f[V]UseSHA\\f[R] option is used in conjunction with the\n-\\f[V]UseSHA1Intrinsics\\f[R], \\f[V]UseSHA256Intrinsics\\f[R], and\n-\\f[V]UseSHA512Intrinsics\\f[R] options.\n+.B \\f[CB]\\-XX:+UseSHA\\f[R]\n+Enables hardware\\-based intrinsics for SHA crypto hash functions for\n+some hardware.\n+The \\f[CB]UseSHA\\f[R] option is used in conjunction with the\n+\\f[CB]UseSHA1Intrinsics\\f[R], \\f[CB]UseSHA256Intrinsics\\f[R], and\n+\\f[CB]UseSHA512Intrinsics\\f[R] options.\n@@ -2550,2 +2787,2 @@\n-The \\f[V]UseSHA\\f[R] and \\f[V]UseSHA*Intrinsics\\f[R] flags are enabled\n-by default on machines that support the corresponding instructions.\n+The \\f[CB]UseSHA\\f[R] and \\f[CB]UseSHA*Intrinsics\\f[R] flags are enabled by\n+default on machines that support the corresponding instructions.\n@@ -2554,1 +2791,1 @@\n-\\f[V]sun.security.provider.Sun\\f[R] provider for SHA operations.\n+\\f[CB]sun.security.provider.Sun\\f[R] provider for SHA operations.\n@@ -2556,1 +2793,1 @@\n-\\f[V]-XX:+UnlockDiagnosticVMOptions\\f[R].\n+\\f[CB]\\-XX:+UnlockDiagnosticVMOptions\\f[R].\n@@ -2558,2 +2795,2 @@\n-To disable all hardware-based SHA intrinsics, specify the\n-\\f[V]-XX:-UseSHA\\f[R].\n+To disable all hardware\\-based SHA intrinsics, specify the\n+\\f[CB]\\-XX:\\-UseSHA\\f[R].\n@@ -2562,1 +2799,1 @@\n-For example: \\f[V]-XX:-UseSHA256Intrinsics\\f[R].\n+For example: \\f[CB]\\-XX:\\-UseSHA256Intrinsics\\f[R].\n@@ -2565,2 +2802,2 @@\n-\\f[V]-XX:+UseSHA1Intrinsics\\f[R]\n-Enables intrinsics for SHA-1 crypto hash function.\n+.B \\f[CB]\\-XX:+UseSHA1Intrinsics\\f[R]\n+Enables intrinsics for SHA\\-1 crypto hash function.\n@@ -2568,1 +2805,3 @@\n-\\f[V]-XX:+UnlockDiagnosticVMOptions\\f[R].\n+\\f[CB]\\-XX:+UnlockDiagnosticVMOptions\\f[R].\n+.RS\n+.RE\n@@ -2570,2 +2809,2 @@\n-\\f[V]-XX:+UseSHA256Intrinsics\\f[R]\n-Enables intrinsics for SHA-224 and SHA-256 crypto hash functions.\n+.B \\f[CB]\\-XX:+UseSHA256Intrinsics\\f[R]\n+Enables intrinsics for SHA\\-224 and SHA\\-256 crypto hash functions.\n@@ -2573,1 +2812,3 @@\n-\\f[V]-XX:+UnlockDiagnosticVMOptions\\f[R].\n+\\f[CB]\\-XX:+UnlockDiagnosticVMOptions\\f[R].\n+.RS\n+.RE\n@@ -2575,2 +2816,2 @@\n-\\f[V]-XX:+UseSHA512Intrinsics\\f[R]\n-Enables intrinsics for SHA-384 and SHA-512 crypto hash functions.\n+.B \\f[CB]\\-XX:+UseSHA512Intrinsics\\f[R]\n+Enables intrinsics for SHA\\-384 and SHA\\-512 crypto hash functions.\n@@ -2578,1 +2819,3 @@\n-\\f[V]-XX:+UnlockDiagnosticVMOptions\\f[R].\n+\\f[CB]\\-XX:+UnlockDiagnosticVMOptions\\f[R].\n+.RS\n+.RE\n@@ -2580,2 +2823,2 @@\n-\\f[V]-XX:+UseMathExactIntrinsics\\f[R]\n-Enables intrinsification of various \\f[V]java.lang.Math.*Exact()\\f[R]\n+.B \\f[CB]\\-XX:+UseMathExactIntrinsics\\f[R]\n+Enables intrinsification of various \\f[CB]java.lang.Math.*Exact()\\f[R]\n@@ -2585,1 +2828,3 @@\n-\\f[V]-XX:+UnlockDiagnosticVMOptions\\f[R].\n+\\f[CB]\\-XX:+UnlockDiagnosticVMOptions\\f[R].\n+.RS\n+.RE\n@@ -2587,2 +2832,2 @@\n-\\f[V]-XX:+UseMultiplyToLenIntrinsic\\f[R]\n-Enables intrinsification of \\f[V]BigInteger.multiplyToLen()\\f[R].\n+.B \\f[CB]\\-XX:+UseMultiplyToLenIntrinsic\\f[R]\n+Enables intrinsification of \\f[CB]BigInteger.multiplyToLen()\\f[R].\n@@ -2591,1 +2836,3 @@\n-\\f[V]-XX:+UnlockDiagnosticVMOptions\\f[R].\n+\\f[CB]\\-XX:+UnlockDiagnosticVMOptions\\f[R].\n+.RS\n+.RE\n@@ -2593,2 +2840,2 @@\n--XX:+UseSquareToLenIntrinsic\n-Enables intrinsification of \\f[V]BigInteger.squareToLen()\\f[R].\n+.B \\-XX:+UseSquareToLenIntrinsic\n+Enables intrinsification of \\f[CB]BigInteger.squareToLen()\\f[R].\n@@ -2597,1 +2844,3 @@\n-\\f[V]-XX:+UnlockDiagnosticVMOptions\\f[R].\n+\\f[CB]\\-XX:+UnlockDiagnosticVMOptions\\f[R].\n+.RS\n+.RE\n@@ -2599,2 +2848,2 @@\n--XX:+UseMulAddIntrinsic\n-Enables intrinsification of \\f[V]BigInteger.mulAdd()\\f[R].\n+.B \\-XX:+UseMulAddIntrinsic\n+Enables intrinsification of \\f[CB]BigInteger.mulAdd()\\f[R].\n@@ -2603,1 +2852,3 @@\n-\\f[V]-XX:+UnlockDiagnosticVMOptions\\f[R].\n+\\f[CB]\\-XX:+UnlockDiagnosticVMOptions\\f[R].\n+.RS\n+.RE\n@@ -2605,2 +2856,2 @@\n--XX:+UseMontgomeryMultiplyIntrinsic\n-Enables intrinsification of \\f[V]BigInteger.montgomeryMultiply()\\f[R].\n+.B \\-XX:+UseMontgomeryMultiplyIntrinsic\n+Enables intrinsification of \\f[CB]BigInteger.montgomeryMultiply()\\f[R].\n@@ -2609,1 +2860,3 @@\n-\\f[V]-XX:+UnlockDiagnosticVMOptions\\f[R].\n+\\f[CB]\\-XX:+UnlockDiagnosticVMOptions\\f[R].\n+.RS\n+.RE\n@@ -2611,2 +2864,2 @@\n--XX:+UseMontgomerySquareIntrinsic\n-Enables intrinsification of \\f[V]BigInteger.montgomerySquare()\\f[R].\n+.B \\-XX:+UseMontgomerySquareIntrinsic\n+Enables intrinsification of \\f[CB]BigInteger.montgomerySquare()\\f[R].\n@@ -2615,1 +2868,3 @@\n-\\f[V]-XX:+UnlockDiagnosticVMOptions\\f[R].\n+\\f[CB]\\-XX:+UnlockDiagnosticVMOptions\\f[R].\n+.RS\n+.RE\n@@ -2617,1 +2872,1 @@\n-\\f[V]-XX:+UseCMoveUnconditionally\\f[R]\n+.B \\f[CB]\\-XX:+UseCMoveUnconditionally\\f[R]\n@@ -2620,0 +2875,2 @@\n+.RS\n+.RE\n@@ -2621,1 +2878,1 @@\n-\\f[V]-XX:+UseCodeCacheFlushing\\f[R]\n+.B \\f[CB]\\-XX:+UseCodeCacheFlushing\\f[R]\n@@ -2625,1 +2882,3 @@\n-specify \\f[V]-XX:-UseCodeCacheFlushing\\f[R].\n+specify \\f[CB]\\-XX:\\-UseCodeCacheFlushing\\f[R].\n+.RS\n+.RE\n@@ -2627,1 +2886,1 @@\n-\\f[V]-XX:+UseCondCardMark\\f[R]\n+.B \\f[CB]\\-XX:+UseCondCardMark\\f[R]\n@@ -2634,0 +2893,2 @@\n+.RS\n+.RE\n@@ -2635,1 +2896,1 @@\n-\\f[V]-XX:+UseCountedLoopSafepoints\\f[R]\n+.B \\f[CB]\\-XX:+UseCountedLoopSafepoints\\f[R]\n@@ -2639,0 +2900,2 @@\n+.RS\n+.RE\n@@ -2640,1 +2903,1 @@\n-\\f[V]-XX:LoopStripMiningIter=\\f[R]\\f[I]number_of_iterations\\f[R]\n+.B \\f[CB]\\-XX:LoopStripMiningIter=\\f[R]\\f[I]number_of_iterations\\f[R]\n@@ -2647,0 +2910,2 @@\n+.RS\n+.RE\n@@ -2648,1 +2913,1 @@\n-\\f[V]-XX:LoopStripMiningIterShortLoop=\\f[R]\\f[I]number_of_iterations\\f[R]\n+.B \\f[CB]\\-XX:LoopStripMiningIterShortLoop=\\f[R]\\f[I]number_of_iterations\\f[R]\n@@ -2652,1 +2917,3 @@\n-Default value is 1\/10th of \\f[V]-XX:LoopStripMiningIter\\f[R].\n+Default value is 1\/10th of \\f[CB]\\-XX:LoopStripMiningIter\\f[R].\n+.RS\n+.RE\n@@ -2654,2 +2921,2 @@\n-\\f[V]-XX:+UseFMA\\f[R]\n-Enables hardware-based FMA intrinsics for hardware where FMA\n+.B \\f[CB]\\-XX:+UseFMA\\f[R]\n+Enables hardware\\-based FMA intrinsics for hardware where FMA\n@@ -2658,4 +2925,6 @@\n-\\f[V]java.lang.Math.fma(\\f[R]\\f[I]a\\f[R]\\f[V],\\f[R]\n-\\f[I]b\\f[R]\\f[V],\\f[R] \\f[I]c\\f[R]\\f[V])\\f[R] methods that calculate the\n-value of \\f[V](\\f[R] \\f[I]a\\f[R] \\f[V]*\\f[R] \\f[I]b\\f[R] \\f[V]+\\f[R]\n-\\f[I]c\\f[R] \\f[V])\\f[R] expressions.\n+\\f[CB]java.lang.Math.fma(\\f[R]\\f[I]a\\f[R]\\f[CB],\\f[R] \\f[I]b\\f[R]\\f[CB],\\f[R]\n+\\f[I]c\\f[R]\\f[CB])\\f[R] methods that calculate the value of \\f[CB](\\f[R]\n+\\f[I]a\\f[R] \\f[CB]*\\f[R] \\f[I]b\\f[R] \\f[CB]+\\f[R] \\f[I]c\\f[R] \\f[CB])\\f[R]\n+expressions.\n+.RS\n+.RE\n@@ -2663,1 +2932,1 @@\n-\\f[V]-XX:+UseRTMDeopt\\f[R]\n+.B \\f[CB]\\-XX:+UseRTMDeopt\\f[R]\n@@ -2665,1 +2934,1 @@\n-This ratio is specified by the \\f[V]-XX:RTMAbortRatio\\f[R] option.\n+This ratio is specified by the \\f[CB]\\-XX:RTMAbortRatio\\f[R] option.\n@@ -2670,1 +2939,3 @@\n-The \\f[V]-XX:+UseRTMLocking\\f[R] option must be enabled.\n+The \\f[CB]\\-XX:+UseRTMLocking\\f[R] option must be enabled.\n+.RS\n+.RE\n@@ -2672,1 +2943,1 @@\n-\\f[V]-XX:+UseRTMLocking\\f[R]\n+.B \\f[CB]\\-XX:+UseRTMLocking\\f[R]\n@@ -2683,3 +2954,3 @@\n-RTM introduces the new instructions \\f[V]XBEGIN\\f[R], \\f[V]XABORT\\f[R],\n-\\f[V]XEND\\f[R], and \\f[V]XTEST\\f[R].\n-The \\f[V]XBEGIN\\f[R] and \\f[V]XEND\\f[R] instructions enclose a set of\n+RTM introduces the new instructions \\f[CB]XBEGIN\\f[R], \\f[CB]XABORT\\f[R],\n+\\f[CB]XEND\\f[R], and \\f[CB]XTEST\\f[R].\n+The \\f[CB]XBEGIN\\f[R] and \\f[CB]XEND\\f[R] instructions enclose a set of\n@@ -2688,1 +2959,1 @@\n-and register modifications are committed together at the \\f[V]XEND\\f[R]\n+and register modifications are committed together at the \\f[CB]XEND\\f[R]\n@@ -2690,2 +2961,2 @@\n-The \\f[V]XABORT\\f[R] instruction can be used to explicitly abort a\n-transaction and the \\f[V]XTEST\\f[R] instruction checks if a set of\n+The \\f[CB]XABORT\\f[R] instruction can be used to explicitly abort a\n+transaction and the \\f[CB]XTEST\\f[R] instruction checks if a set of\n@@ -2704,1 +2975,1 @@\n-RTM also improves the performance of coarse-grain locking, which\n+RTM also improves the performance of coarse\\-grain locking, which\n@@ -2706,1 +2977,1 @@\n-(Coarse-grain locking is the strategy of holding locks for long periods\n+(Coarse\\-grain locking is the strategy of holding locks for long periods\n@@ -2708,1 +2979,1 @@\n-fine-grained locking is the strategy of trying to achieve maximum\n+fine\\-grained locking is the strategy of trying to achieve maximum\n@@ -2710,4 +2981,3 @@\n-possible.)\n-Also, for lightly contended locks that are used by different threads,\n-RTM can reduce false cache line sharing, also known as cache line\n-ping-pong.\n+possible.) Also, for lightly contended locks that are used by different\n+threads, RTM can reduce false cache line sharing, also known as cache\n+line ping\\-pong.\n@@ -2722,1 +2992,1 @@\n-\\f[V]-XX:+UseSuperWord\\f[R]\n+.B \\f[CB]\\-XX:+UseSuperWord\\f[R]\n@@ -2728,1 +2998,3 @@\n-operations, specify \\f[V]-XX:-UseSuperWord\\f[R].\n+operations, specify \\f[CB]\\-XX:\\-UseSuperWord\\f[R].\n+.RS\n+.RE\n@@ -2731,1 +3003,1 @@\n-These \\f[V]java\\f[R] options provide the ability to gather system\n+These \\f[CB]java\\f[R] options provide the ability to gather system\n@@ -2734,1 +3006,1 @@\n-\\f[V]-XX:+DisableAttachMechanism\\f[R]\n+.B \\f[CB]\\-XX:+DisableAttachMechanism\\f[R]\n@@ -2738,1 +3010,1 @@\n-\\f[V]jcmd\\f[R], \\f[V]jstack\\f[R], \\f[V]jmap\\f[R], and \\f[V]jinfo\\f[R].\n+\\f[CB]jcmd\\f[R], \\f[CB]jstack\\f[R], \\f[CB]jmap\\f[R], and \\f[CB]jinfo\\f[R].\n@@ -2749,3 +3021,5 @@\n-\\f[V]-XX:+DTraceAllocProbes\\f[R]\n-\\f[B]Linux and macOS:\\f[R] Enable \\f[V]dtrace\\f[R] tool probes for\n-object allocation.\n+.B \\f[CB]\\-XX:+DTraceAllocProbes\\f[R]\n+\\f[B]Linux and macOS:\\f[R] Enable \\f[CB]dtrace\\f[R] tool probes for object\n+allocation.\n+.RS\n+.RE\n@@ -2753,3 +3027,5 @@\n-\\f[V]-XX:+DTraceMethodProbes\\f[R]\n-\\f[B]Linux and macOS:\\f[R] Enable \\f[V]dtrace\\f[R] tool probes for\n-method-entry and method-exit.\n+.B \\f[CB]\\-XX:+DTraceMethodProbes\\f[R]\n+\\f[B]Linux and macOS:\\f[R] Enable \\f[CB]dtrace\\f[R] tool probes for\n+method\\-entry and method\\-exit.\n+.RS\n+.RE\n@@ -2757,3 +3033,5 @@\n-\\f[V]-XX:+DTraceMonitorProbes\\f[R]\n-\\f[B]Linux and macOS:\\f[R] Enable \\f[V]dtrace\\f[R] tool probes for\n-monitor events.\n+.B \\f[CB]\\-XX:+DTraceMonitorProbes\\f[R]\n+\\f[B]Linux and macOS:\\f[R] Enable \\f[CB]dtrace\\f[R] tool probes for monitor\n+events.\n+.RS\n+.RE\n@@ -2761,1 +3039,1 @@\n-\\f[V]-XX:+HeapDumpOnOutOfMemoryError\\f[R]\n+.B \\f[CB]\\-XX:+HeapDumpOnOutOfMemoryError\\f[R]\n@@ -2764,1 +3042,1 @@\n-\\f[V]java.lang.OutOfMemoryError\\f[R] exception is thrown.\n+\\f[CB]java.lang.OutOfMemoryError\\f[R] exception is thrown.\n@@ -2766,1 +3044,1 @@\n-\\f[V]-XX:HeapDumpPath\\f[R] option.\n+\\f[CB]\\-XX:HeapDumpPath\\f[R] option.\n@@ -2768,1 +3046,3 @@\n-an \\f[V]OutOfMemoryError\\f[R] exception is thrown.\n+an \\f[CB]OutOfMemoryError\\f[R] exception is thrown.\n+.RS\n+.RE\n@@ -2770,1 +3050,1 @@\n-\\f[V]-XX:HeapDumpPath=\\f[R]\\f[I]path\\f[R]\n+.B \\f[CB]\\-XX:HeapDumpPath=\\f[R]\\f[I]path\\f[R]\n@@ -2772,1 +3052,1 @@\n-heap profiler (HPROF) when the \\f[V]-XX:+HeapDumpOnOutOfMemoryError\\f[R]\n+heap profiler (HPROF) when the \\f[CB]\\-XX:+HeapDumpOnOutOfMemoryError\\f[R]\n@@ -2775,2 +3055,2 @@\n-it\\[aq]s named \\f[V]java_pid<pid>.hprof\\f[R] where \\f[V]<pid>\\f[R] is\n-the identifier of the process that caused the error.\n+it\\[aq]s named \\f[CB]java_pid<pid>.hprof\\f[R] where \\f[CB]<pid>\\f[R] is the\n+identifier of the process that caused the error.\n@@ -2778,1 +3058,1 @@\n-(\\f[V]%p\\f[R] represents the current process identifier):\n+(\\f[CB]%p\\f[R] represents the current process identifier):\n@@ -2782,1 +3062,1 @@\n-\\f[V]-XX:HeapDumpPath=.\/java_pid%p.hprof\\f[R]\n+\\f[CB]\\-XX:HeapDumpPath=.\/java_pid%p.hprof\\f[R]\n@@ -2786,1 +3066,1 @@\n-heap dump file to \\f[V]\/var\/log\/java\/java_heapdump.hprof\\f[R]:\n+heap dump file to \\f[CB]\/var\/log\/java\/java_heapdump.hprof\\f[R]:\n@@ -2790,1 +3070,1 @@\n-\\f[V]-XX:HeapDumpPath=\/var\/log\/java\/java_heapdump.hprof\\f[R]\n+\\f[CB]\\-XX:HeapDumpPath=\/var\/log\/java\/java_heapdump.hprof\\f[R]\n@@ -2795,1 +3075,1 @@\n-file to \\f[V]C:\/log\/java\/java_heapdump.log\\f[R]:\n+file to \\f[CB]C:\/log\/java\/java_heapdump.log\\f[R]:\n@@ -2799,1 +3079,1 @@\n-\\f[V]-XX:HeapDumpPath=C:\/log\/java\/java_heapdump.log\\f[R]\n+\\f[CB]\\-XX:HeapDumpPath=C:\/log\/java\/java_heapdump.log\\f[R]\n@@ -2804,1 +3084,1 @@\n-\\f[V]-XX:LogFile=\\f[R]\\f[I]path\\f[R]\n+.B \\f[CB]\\-XX:LogFile=\\f[R]\\f[I]path\\f[R]\n@@ -2807,1 +3087,1 @@\n-it\\[aq]s named \\f[V]hotspot.log\\f[R].\n+it\\[aq]s named \\f[CB]hotspot.log\\f[R].\n@@ -2810,2 +3090,2 @@\n-\\f[B]Linux and macOS:\\f[R] The following example shows how to set the\n-log file to \\f[V]\/var\/log\/java\/hotspot.log\\f[R]:\n+\\f[B]Linux and macOS:\\f[R] The following example shows how to set the log\n+file to \\f[CB]\/var\/log\/java\/hotspot.log\\f[R]:\n@@ -2815,1 +3095,1 @@\n-\\f[V]-XX:LogFile=\/var\/log\/java\/hotspot.log\\f[R]\n+\\f[CB]\\-XX:LogFile=\/var\/log\/java\/hotspot.log\\f[R]\n@@ -2819,2 +3099,2 @@\n-\\f[B]Windows:\\f[R] The following example shows how to set the log file\n-to \\f[V]C:\/log\/java\/hotspot.log\\f[R]:\n+\\f[B]Windows:\\f[R] The following example shows how to set the log file to\n+\\f[CB]C:\/log\/java\/hotspot.log\\f[R]:\n@@ -2824,1 +3104,1 @@\n-\\f[V]-XX:LogFile=C:\/log\/java\/hotspot.log\\f[R]\n+\\f[CB]\\-XX:LogFile=C:\/log\/java\/hotspot.log\\f[R]\n@@ -2829,1 +3109,1 @@\n-\\f[V]-XX:+PrintClassHistogram\\f[R]\n+.B \\f[CB]\\-XX:+PrintClassHistogram\\f[R]\n@@ -2834,1 +3114,1 @@\n-\\f[B]Linux and macOS:\\f[R] \\f[V]Control+Break\\f[R]\n+\\f[B]Linux and macOS:\\f[R] \\f[CB]Control+Break\\f[R]\n@@ -2836,1 +3116,1 @@\n-\\f[B]Windows:\\f[R] \\f[V]Control+C\\f[R] (\\f[V]SIGTERM\\f[R])\n+\\f[B]Windows:\\f[R] \\f[CB]Control+C\\f[R] (\\f[CB]SIGTERM\\f[R])\n@@ -2840,4 +3120,3 @@\n-Setting this option is equivalent to running the \\f[V]jmap -histo\\f[R]\n-command, or the \\f[V]jcmd\\f[R] \\f[I]pid\\f[R]\n-\\f[V]GC.class_histogram\\f[R] command, where \\f[I]pid\\f[R] is the current\n-Java process identifier.\n+Setting this option is equivalent to running the \\f[CB]jmap\\ \\-histo\\f[R]\n+command, or the \\f[CB]jcmd\\f[R] \\f[I]pid\\f[R] \\f[CB]GC.class_histogram\\f[R]\n+command, where \\f[I]pid\\f[R] is the current Java process identifier.\n@@ -2846,3 +3125,3 @@\n-\\f[V]-XX:+PrintConcurrentLocks\\f[R]\n-Enables printing of \\f[V]java.util.concurrent\\f[R] locks after one of\n-the following events:\n+.B \\f[CB]\\-XX:+PrintConcurrentLocks\\f[R]\n+Enables printing of \\f[CB]java.util.concurrent\\f[R] locks after one of the\n+following events:\n@@ -2851,1 +3130,1 @@\n-\\f[B]Linux and macOS:\\f[R] \\f[V]Control+Break\\f[R]\n+\\f[B]Linux and macOS:\\f[R] \\f[CB]Control+Break\\f[R]\n@@ -2853,1 +3132,1 @@\n-\\f[B]Windows:\\f[R] \\f[V]Control+C\\f[R] (\\f[V]SIGTERM\\f[R])\n+\\f[B]Windows:\\f[R] \\f[CB]Control+C\\f[R] (\\f[CB]SIGTERM\\f[R])\n@@ -2857,2 +3136,2 @@\n-Setting this option is equivalent to running the \\f[V]jstack -l\\f[R]\n-command or the \\f[V]jcmd\\f[R] \\f[I]pid\\f[R] \\f[V]Thread.print -l\\f[R]\n+Setting this option is equivalent to running the \\f[CB]jstack\\ \\-l\\f[R]\n+command or the \\f[CB]jcmd\\f[R] \\f[I]pid\\f[R] \\f[CB]Thread.print\\ \\-l\\f[R]\n@@ -2862,1 +3141,1 @@\n-\\f[V]-XX:+PrintFlagsRanges\\f[R]\n+.B \\f[CB]\\-XX:+PrintFlagsRanges\\f[R]\n@@ -2865,0 +3144,2 @@\n+.RS\n+.RE\n@@ -2866,1 +3147,1 @@\n-\\f[V]-XX:+PerfDataSaveToFile\\f[R]\n+.B \\f[CB]\\-XX:+PerfDataSaveToFile\\f[R]\n@@ -2870,1 +3151,1 @@\n-\\f[V]hsperfdata_\\f[R]\\f[I]pid\\f[R], where \\f[I]pid\\f[R] is the process\n+\\f[CB]hsperfdata_\\f[R]\\f[I]pid\\f[R], where \\f[I]pid\\f[R] is the process\n@@ -2872,2 +3153,2 @@\n-Use the \\f[V]jstat\\f[R] command to display the performance data\n-contained in this file as follows:\n+Use the \\f[CB]jstat\\f[R] command to display the performance data contained\n+in this file as follows:\n@@ -2877,1 +3158,1 @@\n-\\f[V]jstat -class file:\/\/\/\\f[R]\\f[I]path\\f[R]\\f[V]\/hsperfdata_\\f[R]\\f[I]pid\\f[R]\n+\\f[CB]jstat\\ \\-class\\ file:\/\/\/\\f[R]\\f[I]path\\f[R]\\f[CB]\/hsperfdata_\\f[R]\\f[I]pid\\f[R]\n@@ -2881,1 +3162,1 @@\n-\\f[V]jstat -gc file:\/\/\/\\f[R]\\f[I]path\\f[R]\\f[V]\/hsperfdata_\\f[R]\\f[I]pid\\f[R]\n+\\f[CB]jstat\\ \\-gc\\ file:\/\/\/\\f[R]\\f[I]path\\f[R]\\f[CB]\/hsperfdata_\\f[R]\\f[I]pid\\f[R]\n@@ -2885,2 +3166,2 @@\n-\\f[V]-XX:+UsePerfData\\f[R]\n-Enables the \\f[V]perfdata\\f[R] feature.\n+.B \\f[CB]\\-XX:+UsePerfData\\f[R]\n+Enables the \\f[CB]perfdata\\f[R] feature.\n@@ -2889,1 +3170,1 @@\n-Disabling it suppresses the creation of the \\f[V]hsperfdata_userid\\f[R]\n+Disabling it suppresses the creation of the \\f[CB]hsperfdata_userid\\f[R]\n@@ -2891,2 +3172,4 @@\n-To disable the \\f[V]perfdata\\f[R] feature, specify\n-\\f[V]-XX:-UsePerfData\\f[R].\n+To disable the \\f[CB]perfdata\\f[R] feature, specify\n+\\f[CB]\\-XX:\\-UsePerfData\\f[R].\n+.RS\n+.RE\n@@ -2895,1 +3178,1 @@\n-These \\f[V]java\\f[R] options control how garbage collection (GC) is\n+These \\f[CB]java\\f[R] options control how garbage collection (GC) is\n@@ -2898,1 +3181,1 @@\n-\\f[V]-XX:+AggressiveHeap\\f[R]\n+.B \\f[CB]\\-XX:+AggressiveHeap\\f[R]\n@@ -2900,1 +3183,1 @@\n-This sets various parameters to be optimal for long-running jobs with\n+This sets various parameters to be optimal for long\\-running jobs with\n@@ -2905,0 +3188,2 @@\n+.RS\n+.RE\n@@ -2906,1 +3191,1 @@\n-\\f[V]-XX:+AlwaysPreTouch\\f[R]\n+.B \\f[CB]\\-XX:+AlwaysPreTouch\\f[R]\n@@ -2912,0 +3197,2 @@\n+.RS\n+.RE\n@@ -2913,1 +3200,1 @@\n-\\f[V]-XX:ConcGCThreads=\\f[R]\\f[I]threads\\f[R]\n+.B \\f[CB]\\-XX:ConcGCThreads=\\f[R]\\f[I]threads\\f[R]\n@@ -2915,1 +3202,1 @@\n-Sets \\f[I]\\f[VI]threads\\f[I]\\f[R] to approximately 1\/4 of the number of\n+Sets \\f[I]\\f[CI]threads\\f[I]\\f[R] to approximately 1\/4 of the number of\n@@ -2924,1 +3211,1 @@\n-\\f[V]-XX:ConcGCThreads=2\\f[R]\n+\\f[CB]\\-XX:ConcGCThreads=2\\f[R]\n@@ -2928,1 +3215,1 @@\n-\\f[V]-XX:+DisableExplicitGC\\f[R]\n+.B \\f[CB]\\-XX:+DisableExplicitGC\\f[R]\n@@ -2930,1 +3217,1 @@\n-\\f[V]System.gc()\\f[R] method.\n+\\f[CB]System.gc()\\f[R] method.\n@@ -2932,3 +3219,5 @@\n-\\f[V]System.gc()\\f[R] are processed.\n-If processing of calls to \\f[V]System.gc()\\f[R] is disabled, then the\n-JVM still performs GC when necessary.\n+\\f[CB]System.gc()\\f[R] are processed.\n+If processing of calls to \\f[CB]System.gc()\\f[R] is disabled, then the JVM\n+still performs GC when necessary.\n+.RS\n+.RE\n@@ -2936,2 +3225,2 @@\n-\\f[V]-XX:+ExplicitGCInvokesConcurrent\\f[R]\n-Enables invoking of concurrent GC by using the \\f[V]System.gc()\\f[R]\n+.B \\f[CB]\\-XX:+ExplicitGCInvokesConcurrent\\f[R]\n+Enables invoking of concurrent GC by using the \\f[CB]System.gc()\\f[R]\n@@ -2940,1 +3229,3 @@\n-\\f[V]-XX:+UseG1GC\\f[R] option.\n+\\f[CB]\\-XX:+UseG1GC\\f[R] option.\n+.RS\n+.RE\n@@ -2942,2 +3233,2 @@\n-\\f[V]-XX:G1AdaptiveIHOPNumInitialSamples=\\f[R]\\f[I]number\\f[R]\n-When \\f[V]-XX:UseAdaptiveIHOP\\f[R] is enabled, this option sets the\n+.B \\f[CB]\\-XX:G1AdaptiveIHOPNumInitialSamples=\\f[R]\\f[I]number\\f[R]\n+When \\f[CB]\\-XX:UseAdaptiveIHOP\\f[R] is enabled, this option sets the\n@@ -2946,1 +3237,1 @@\n-\\f[V]-XX:InitiatingHeapOccupancyPercent\\f[R].\n+\\f[CB]\\-XX:InitiatingHeapOccupancyPercent\\f[R].\n@@ -2948,1 +3239,1 @@\n-\\f[V]-XX:InitiatingHeapOccupancyPercent\\f[R] directly for this purpose.\n+\\f[CB]\\-XX:InitiatingHeapOccupancyPercent\\f[R] directly for this purpose.\n@@ -2950,0 +3241,2 @@\n+.RS\n+.RE\n@@ -2951,1 +3244,1 @@\n-\\f[V]-XX:G1HeapRegionSize=\\f[R]\\f[I]size\\f[R]\n+.B \\f[CB]\\-XX:G1HeapRegionSize=\\f[R]\\f[I]size\\f[R]\n@@ -2953,1 +3246,1 @@\n-using the garbage-first (G1) collector.\n+using the garbage\\-first (G1) collector.\n@@ -2962,1 +3255,1 @@\n-\\f[V]-XX:G1HeapRegionSize=16m\\f[R]\n+\\f[CB]\\-XX:G1HeapRegionSize=16m\\f[R]\n@@ -2966,1 +3259,1 @@\n-\\f[V]-XX:G1HeapWastePercent=\\f[R]\\f[I]percent\\f[R]\n+.B \\f[CB]\\-XX:G1HeapWastePercent=\\f[R]\\f[I]percent\\f[R]\n@@ -2972,0 +3265,2 @@\n+.RS\n+.RE\n@@ -2973,1 +3268,1 @@\n-\\f[V]-XX:G1MaxNewSizePercent=\\f[R]\\f[I]percent\\f[R]\n+.B \\f[CB]\\-XX:G1MaxNewSizePercent=\\f[R]\\f[I]percent\\f[R]\n@@ -2980,1 +3275,1 @@\n-This setting replaces the \\f[V]-XX:DefaultMaxNewGenPercent\\f[R] setting.\n+This setting replaces the \\f[CB]\\-XX:DefaultMaxNewGenPercent\\f[R] setting.\n@@ -2983,1 +3278,1 @@\n-\\f[V]-XX:G1MixedGCCountTarget=\\f[R]\\f[I]number\\f[R]\n+.B \\f[CB]\\-XX:G1MixedGCCountTarget=\\f[R]\\f[I]number\\f[R]\n@@ -2986,1 +3281,1 @@\n-\\f[V]G1MixedGCLIveThresholdPercent\\f[R] live data.\n+\\f[CB]G1MixedGCLIveThresholdPercent\\f[R] live data.\n@@ -2989,0 +3284,2 @@\n+.RS\n+.RE\n@@ -2990,1 +3287,1 @@\n-\\f[V]-XX:G1MixedGCLiveThresholdPercent=\\f[R]\\f[I]percent\\f[R]\n+.B \\f[CB]\\-XX:G1MixedGCLiveThresholdPercent=\\f[R]\\f[I]percent\\f[R]\n@@ -2998,1 +3295,1 @@\n-\\f[V]-XX:G1OldCSetRegionLiveThresholdPercent\\f[R] setting.\n+\\f[CB]\\-XX:G1OldCSetRegionLiveThresholdPercent\\f[R] setting.\n@@ -3001,1 +3298,1 @@\n-\\f[V]-XX:G1NewSizePercent=\\f[R]\\f[I]percent\\f[R]\n+.B \\f[CB]\\-XX:G1NewSizePercent=\\f[R]\\f[I]percent\\f[R]\n@@ -3008,1 +3305,1 @@\n-This setting replaces the \\f[V]-XX:DefaultMinNewGenPercent\\f[R] setting.\n+This setting replaces the \\f[CB]\\-XX:DefaultMinNewGenPercent\\f[R] setting.\n@@ -3011,1 +3308,1 @@\n-\\f[V]-XX:G1OldCSetRegionThresholdPercent=\\f[R]\\f[I]percent\\f[R]\n+.B \\f[CB]\\-XX:G1OldCSetRegionThresholdPercent=\\f[R]\\f[I]percent\\f[R]\n@@ -3015,0 +3312,2 @@\n+.RS\n+.RE\n@@ -3016,1 +3315,1 @@\n-\\f[V]-XX:G1ReservePercent=\\f[R]\\f[I]percent\\f[R]\n+.B \\f[CB]\\-XX:G1ReservePercent=\\f[R]\\f[I]percent\\f[R]\n@@ -3028,1 +3327,1 @@\n-\\f[V]-XX:G1ReservePercent=20\\f[R]\n+\\f[CB]\\-XX:G1ReservePercent=20\\f[R]\n@@ -3032,1 +3331,1 @@\n-\\f[V]-XX:+G1UseAdaptiveIHOP\\f[R]\n+.B \\f[CB]\\-XX:+G1UseAdaptiveIHOP\\f[R]\n@@ -3035,1 +3334,1 @@\n-If enabled, G1 uses \\f[V]-XX:InitiatingHeapOccupancyPercent\\f[R] for the\n+If enabled, G1 uses \\f[CB]\\-XX:InitiatingHeapOccupancyPercent\\f[R] for the\n@@ -3037,1 +3336,1 @@\n-\\f[V]-XX:G1AdaptiveIHOPNumInitialSamples\\f[R], and after that adaptively\n+\\f[CB]\\-XX:G1AdaptiveIHOPNumInitialSamples\\f[R], and after that adaptively\n@@ -3042,1 +3341,1 @@\n-\\f[V]-XX:InitiatingHeapOccupancyPercent\\f[R].\n+\\f[CB]\\-XX:InitiatingHeapOccupancyPercent\\f[R].\n@@ -3048,1 +3347,1 @@\n-\\f[V]-XX:InitialHeapSize=\\f[R]\\f[I]size\\f[R]\n+.B \\f[CB]\\-XX:InitialHeapSize=\\f[R]\\f[I]size\\f[R]\n@@ -3052,3 +3351,3 @@\n-Append the letter \\f[V]k\\f[R] or \\f[V]K\\f[R] to indicate kilobytes,\n-\\f[V]m\\f[R] or \\f[V]M\\f[R] to indicate megabytes, or \\f[V]g\\f[R] or\n-\\f[V]G\\f[R] to indicate gigabytes.\n+Append the letter \\f[CB]k\\f[R] or \\f[CB]K\\f[R] to indicate kilobytes,\n+\\f[CB]m\\f[R] or \\f[CB]M\\f[R] to indicate megabytes, or \\f[CB]g\\f[R] or\n+\\f[CB]G\\f[R] to indicate gigabytes.\n@@ -3064,3 +3363,3 @@\n--XX:InitialHeapSize=6291456\n--XX:InitialHeapSize=6144k\n--XX:InitialHeapSize=6m\n+\\-XX:InitialHeapSize=6291456\n+\\-XX:InitialHeapSize=6144k\n+\\-XX:InitialHeapSize=6m\n@@ -3073,2 +3372,2 @@\n-\\f[V]-XX:NewSize\\f[R] option.\n-Note that the \\f[V]-Xms\\f[R] option sets both the minimum and the\n+\\f[CB]\\-XX:NewSize\\f[R] option.\n+Note that the \\f[CB]\\-Xms\\f[R] option sets both the minimum and the\n@@ -3076,1 +3375,1 @@\n-If \\f[V]-Xms\\f[R] appears after \\f[V]-XX:InitialHeapSize\\f[R] on the\n+If \\f[CB]\\-Xms\\f[R] appears after \\f[CB]\\-XX:InitialHeapSize\\f[R] on the\n@@ -3078,1 +3377,1 @@\n-with \\f[V]-Xms\\f[R].\n+with \\f[CB]\\-Xms\\f[R].\n@@ -3081,1 +3380,1 @@\n-\\f[V]-XX:InitialRAMPercentage=\\f[R]\\f[I]percent\\f[R]\n+.B \\f[CB]\\-XX:InitialRAMPercentage=\\f[R]\\f[I]percent\\f[R]\n@@ -3084,1 +3383,1 @@\n-maximum amount determined as described in the \\f[V]-XX:MaxRAM\\f[R]\n+maximum amount determined as described in the \\f[CB]\\-XX:MaxRAM\\f[R]\n@@ -3093,1 +3392,1 @@\n-\\f[V]-XX:InitialRAMPercentage=5\\f[R]\n+\\f[CB]\\-XX:InitialRAMPercentage=5\\f[R]\n@@ -3097,1 +3396,1 @@\n-\\f[V]-XX:InitialSurvivorRatio=\\f[R]\\f[I]ratio\\f[R]\n+.B \\f[CB]\\-XX:InitialSurvivorRatio=\\f[R]\\f[I]ratio\\f[R]\n@@ -3099,1 +3398,1 @@\n-collector (which is enabled by the \\f[V]-XX:+UseParallelGC\\f[R] option).\n+collector (which is enabled by the \\f[CB]\\-XX:+UseParallelGC\\f[R] option).\n@@ -3101,1 +3400,1 @@\n-collector by using the \\f[V]-XX:+UseParallelGC\\f[R] option, and the\n+collector by using the \\f[CB]\\-XX:+UseParallelGC\\f[R] option, and the\n@@ -3105,2 +3404,2 @@\n-\\f[V]-XX:-UseAdaptiveSizePolicy\\f[R] option), then the\n-\\f[V]-XX:SurvivorRatio\\f[R] option should be used to set the size of the\n+\\f[CB]\\-XX:\\-UseAdaptiveSizePolicy\\f[R] option), then the\n+\\f[CB]\\-XX:SurvivorRatio\\f[R] option should be used to set the size of the\n@@ -3115,1 +3414,1 @@\n-\\f[V]S=Y\/(R+2)\\f[R]\n+\\f[CB]S=Y\/(R+2)\\f[R]\n@@ -3130,1 +3429,1 @@\n-\\f[V]-XX:InitialSurvivorRatio=4\\f[R]\n+\\f[CB]\\-XX:InitialSurvivorRatio=4\\f[R]\n@@ -3134,1 +3433,1 @@\n-\\f[V]-XX:InitiatingHeapOccupancyPercent=\\f[R]\\f[I]percent\\f[R]\n+.B \\f[CB]\\-XX:InitiatingHeapOccupancyPercent=\\f[R]\\f[I]percent\\f[R]\n@@ -3144,2 +3443,2 @@\n-See also the \\f[V]-XX:G1UseAdaptiveIHOP\\f[R] and\n-\\f[V]-XX:G1AdaptiveIHOPNumInitialSamples\\f[R] options.\n+See also the \\f[CB]\\-XX:G1UseAdaptiveIHOP\\f[R] and\n+\\f[CB]\\-XX:G1AdaptiveIHOPNumInitialSamples\\f[R] options.\n@@ -3151,1 +3450,1 @@\n-\\f[V]-XX:InitiatingHeapOccupancyPercent=75\\f[R]\n+\\f[CB]\\-XX:InitiatingHeapOccupancyPercent=75\\f[R]\n@@ -3155,1 +3454,1 @@\n-\\f[V]-XX:MaxGCPauseMillis=\\f[R]\\f[I]time\\f[R]\n+.B \\f[CB]\\-XX:MaxGCPauseMillis=\\f[R]\\f[I]time\\f[R]\n@@ -3169,1 +3468,1 @@\n-\\f[V]-XX:MaxGCPauseMillis=500\\f[R]\n+\\f[CB]\\-XX:MaxGCPauseMillis=500\\f[R]\n@@ -3173,1 +3472,1 @@\n-\\f[V]-XX:MaxHeapSize=\\f[R]\\f[I]size\\f[R]\n+.B \\f[CB]\\-XX:MaxHeapSize=\\f[R]\\f[I]size\\f[R]\n@@ -3176,3 +3475,3 @@\n-Append the letter \\f[V]k\\f[R] or \\f[V]K\\f[R] to indicate kilobytes,\n-\\f[V]m\\f[R] or \\f[V]M\\f[R] to indicate megabytes, or \\f[V]g\\f[R] or\n-\\f[V]G\\f[R] to indicate gigabytes.\n+Append the letter \\f[CB]k\\f[R] or \\f[CB]K\\f[R] to indicate kilobytes,\n+\\f[CB]m\\f[R] or \\f[CB]M\\f[R] to indicate megabytes, or \\f[CB]g\\f[R] or\n+\\f[CB]G\\f[R] to indicate gigabytes.\n@@ -3181,2 +3480,2 @@\n-For server deployments, the options \\f[V]-XX:InitialHeapSize\\f[R] and\n-\\f[V]-XX:MaxHeapSize\\f[R] are often set to the same value.\n+For server deployments, the options \\f[CB]\\-XX:InitialHeapSize\\f[R] and\n+\\f[CB]\\-XX:MaxHeapSize\\f[R] are often set to the same value.\n@@ -3190,3 +3489,3 @@\n--XX:MaxHeapSize=83886080\n--XX:MaxHeapSize=81920k\n--XX:MaxHeapSize=80m\n+\\-XX:MaxHeapSize=83886080\n+\\-XX:MaxHeapSize=81920k\n+\\-XX:MaxHeapSize=80m\n@@ -3196,1 +3495,1 @@\n-The \\f[V]-XX:MaxHeapSize\\f[R] option is equivalent to \\f[V]-Xmx\\f[R].\n+The \\f[CB]\\-XX:MaxHeapSize\\f[R] option is equivalent to \\f[CB]\\-Xmx\\f[R].\n@@ -3199,1 +3498,1 @@\n-\\f[V]-XX:MaxHeapFreeRatio=\\f[R]\\f[I]percent\\f[R]\n+.B \\f[CB]\\-XX:MaxHeapFreeRatio=\\f[R]\\f[I]percent\\f[R]\n@@ -3207,6 +3506,6 @@\n-\\f[V]MaxHeapFreeRatio\\f[R] (default value is 70%) and\n-\\f[V]MinHeapFreeRatio\\f[R] (default value is 40%) with the command-line\n-options \\f[V]-XX:MaxHeapFreeRatio\\f[R] and\n-\\f[V]-XX:MinHeapFreeRatio\\f[R].\n-Lowering \\f[V]MaxHeapFreeRatio\\f[R] to as low as 10% and\n-\\f[V]MinHeapFreeRatio\\f[R] to 5% has successfully reduced the heap size\n+\\f[CB]MaxHeapFreeRatio\\f[R] (default value is 70%) and\n+\\f[CB]MinHeapFreeRatio\\f[R] (default value is 40%) with the command\\-line\n+options \\f[CB]\\-XX:MaxHeapFreeRatio\\f[R] and\n+\\f[CB]\\-XX:MinHeapFreeRatio\\f[R].\n+Lowering \\f[CB]MaxHeapFreeRatio\\f[R] to as low as 10% and\n+\\f[CB]MinHeapFreeRatio\\f[R] to 5% has successfully reduced the heap size\n@@ -3219,1 +3518,1 @@\n-\\f[V]-XX:MaxHeapFreeRatio=10 -XX:MinHeapFreeRatio=5\\f[R]\n+\\f[CB]\\-XX:MaxHeapFreeRatio=10\\ \\-XX:MinHeapFreeRatio=5\\f[R]\n@@ -3223,4 +3522,4 @@\n-\\f[V]-XX:-ShrinkHeapInSteps\\f[R].\n-See \\f[B]Performance Tuning Examples\\f[R] for a description of using\n-this option to keep the Java heap small by reducing the dynamic\n-footprint for embedded applications.\n+\\f[CB]\\-XX:\\-ShrinkHeapInSteps\\f[R].\n+See \\f[B]Performance Tuning Examples\\f[R] for a description of using this\n+option to keep the Java heap small by reducing the dynamic footprint for\n+embedded applications.\n@@ -3229,1 +3528,1 @@\n-\\f[V]-XX:MaxMetaspaceSize=\\f[R]\\f[I]size\\f[R]\n+.B \\f[CB]\\-XX:MaxMetaspaceSize=\\f[R]\\f[I]size\\f[R]\n@@ -3242,1 +3541,1 @@\n-\\f[V]-XX:MaxMetaspaceSize=256m\\f[R]\n+\\f[CB]\\-XX:MaxMetaspaceSize=256m\\f[R]\n@@ -3246,1 +3545,1 @@\n-\\f[V]-XX:MaxNewSize=\\f[R]\\f[I]size\\f[R]\n+.B \\f[CB]\\-XX:MaxNewSize=\\f[R]\\f[I]size\\f[R]\n@@ -3250,0 +3549,2 @@\n+.RS\n+.RE\n@@ -3251,1 +3552,1 @@\n-\\f[V]-XX:MaxRAM=\\f[R]\\f[I]size\\f[R]\n+.B \\f[CB]\\-XX:MaxRAM=\\f[R]\\f[I]size\\f[R]\n@@ -3267,1 +3568,1 @@\n-See \\f[V]-XX:UseCompressedOops\\f[R] for further information about\n+See \\f[CB]\\-XX:UseCompressedOops\\f[R] for further information about\n@@ -3274,1 +3575,1 @@\n-\\f[V]-XX:MaxRAM=2G\\f[R]\n+\\f[CB]\\-XX:MaxRAM=2G\\f[R]\n@@ -3278,1 +3579,1 @@\n-\\f[V]-XX:MaxRAMPercentage=\\f[R]\\f[I]percent\\f[R]\n+.B \\f[CB]\\-XX:MaxRAMPercentage=\\f[R]\\f[I]percent\\f[R]\n@@ -3281,1 +3582,1 @@\n-amount determined as described in the \\f[V]-XX:MaxRAM\\f[R] option.\n+amount determined as described in the \\f[CB]\\-XX:MaxRAM\\f[R] option.\n@@ -3289,1 +3590,1 @@\n-See \\f[V]-XX:UseCompressedOops\\f[R] for further information about\n+See \\f[CB]\\-XX:UseCompressedOops\\f[R] for further information about\n@@ -3296,1 +3597,1 @@\n-\\f[V]-XX:MaxRAMPercentage=75\\f[R]\n+\\f[CB]\\-XX:MaxRAMPercentage=75\\f[R]\n@@ -3300,1 +3601,1 @@\n-\\f[V]-XX:MinRAMPercentage=\\f[R]\\f[I]percent\\f[R]\n+.B \\f[CB]\\-XX:MinRAMPercentage=\\f[R]\\f[I]percent\\f[R]\n@@ -3303,1 +3604,1 @@\n-amount determined as described in the \\f[V]-XX:MaxRAM\\f[R] option for\n+amount determined as described in the \\f[CB]\\-XX:MaxRAM\\f[R] option for\n@@ -3313,1 +3614,1 @@\n-\\f[V]-XX:MinRAMPercentage=75\\f[R]\n+\\f[CB]\\-XX:MinRAMPercentage=75\\f[R]\n@@ -3317,1 +3618,1 @@\n-\\f[V]-XX:MaxTenuringThreshold=\\f[R]\\f[I]threshold\\f[R]\n+.B \\f[CB]\\-XX:MaxTenuringThreshold=\\f[R]\\f[I]threshold\\f[R]\n@@ -3327,1 +3628,1 @@\n-\\f[V]-XX:MaxTenuringThreshold=10\\f[R]\n+\\f[CB]\\-XX:MaxTenuringThreshold=10\\f[R]\n@@ -3331,1 +3632,1 @@\n-\\f[V]-XX:MetaspaceSize=\\f[R]\\f[I]size\\f[R]\n+.B \\f[CB]\\-XX:MetaspaceSize=\\f[R]\\f[I]size\\f[R]\n@@ -3337,0 +3638,2 @@\n+.RS\n+.RE\n@@ -3338,1 +3641,1 @@\n-\\f[V]-XX:MinHeapFreeRatio=\\f[R]\\f[I]percent\\f[R]\n+.B \\f[CB]\\-XX:MinHeapFreeRatio=\\f[R]\\f[I]percent\\f[R]\n@@ -3346,6 +3649,6 @@\n-\\f[V]MaxHeapFreeRatio\\f[R] (default value is 70%) and\n-\\f[V]MinHeapFreeRatio\\f[R] (default value is 40%) with the command-line\n-options \\f[V]-XX:MaxHeapFreeRatio\\f[R] and\n-\\f[V]-XX:MinHeapFreeRatio\\f[R].\n-Lowering \\f[V]MaxHeapFreeRatio\\f[R] to as low as 10% and\n-\\f[V]MinHeapFreeRatio\\f[R] to 5% has successfully reduced the heap size\n+\\f[CB]MaxHeapFreeRatio\\f[R] (default value is 70%) and\n+\\f[CB]MinHeapFreeRatio\\f[R] (default value is 40%) with the command\\-line\n+options \\f[CB]\\-XX:MaxHeapFreeRatio\\f[R] and\n+\\f[CB]\\-XX:MinHeapFreeRatio\\f[R].\n+Lowering \\f[CB]MaxHeapFreeRatio\\f[R] to as low as 10% and\n+\\f[CB]MinHeapFreeRatio\\f[R] to 5% has successfully reduced the heap size\n@@ -3358,1 +3661,1 @@\n-\\f[V]-XX:MaxHeapFreeRatio=10 -XX:MinHeapFreeRatio=5\\f[R]\n+\\f[CB]\\-XX:MaxHeapFreeRatio=10\\ \\-XX:MinHeapFreeRatio=5\\f[R]\n@@ -3362,4 +3665,4 @@\n-\\f[V]-XX:-ShrinkHeapInSteps\\f[R].\n-See \\f[B]Performance Tuning Examples\\f[R] for a description of using\n-this option to keep the Java heap small by reducing the dynamic\n-footprint for embedded applications.\n+\\f[CB]\\-XX:\\-ShrinkHeapInSteps\\f[R].\n+See \\f[B]Performance Tuning Examples\\f[R] for a description of using this\n+option to keep the Java heap small by reducing the dynamic footprint for\n+embedded applications.\n@@ -3368,1 +3671,1 @@\n-\\f[V]-XX:MinHeapSize=\\f[R]\\f[I]size\\f[R]\n+.B \\f[CB]\\-XX:MinHeapSize=\\f[R]\\f[I]size\\f[R]\n@@ -3372,3 +3675,3 @@\n-Append the letter \\f[V]k\\f[R] or \\f[V]K\\f[R] to indicate kilobytes,\n-\\f[V]m\\f[R] or \\f[V]M\\f[R] to indicate megabytes, or \\f[V]g\\f[R] or\n-\\f[V]G\\f[R] to indicate gigabytes.\n+Append the letter \\f[CB]k\\f[R] or \\f[CB]K\\f[R] to indicate kilobytes,\n+\\f[CB]m\\f[R] or \\f[CB]M\\f[R] to indicate megabytes, or \\f[CB]g\\f[R] or\n+\\f[CB]G\\f[R] to indicate gigabytes.\n@@ -3384,3 +3687,3 @@\n--XX:MinHeapSize=6291456\n--XX:MinHeapSize=6144k\n--XX:MinHeapSize=6m\n+\\-XX:MinHeapSize=6291456\n+\\-XX:MinHeapSize=6144k\n+\\-XX:MinHeapSize=6m\n@@ -3394,1 +3697,1 @@\n-\\f[V]-XX:NewRatio=\\f[R]\\f[I]ratio\\f[R]\n+.B \\f[CB]\\-XX:NewRatio=\\f[R]\\f[I]ratio\\f[R]\n@@ -3397,1 +3700,1 @@\n-The following example shows how to set the young-to-old ratio to 1:\n+The following example shows how to set the young\\-to\\-old ratio to 1:\n@@ -3401,1 +3704,1 @@\n-\\f[V]-XX:NewRatio=1\\f[R]\n+\\f[CB]\\-XX:NewRatio=1\\f[R]\n@@ -3405,1 +3708,1 @@\n-\\f[V]-XX:NewSize=\\f[R]\\f[I]size\\f[R]\n+.B \\f[CB]\\-XX:NewSize=\\f[R]\\f[I]size\\f[R]\n@@ -3408,3 +3711,3 @@\n-Append the letter \\f[V]k\\f[R] or \\f[V]K\\f[R] to indicate kilobytes,\n-\\f[V]m\\f[R] or \\f[V]M\\f[R] to indicate megabytes, or \\f[V]g\\f[R] or\n-\\f[V]G\\f[R] to indicate gigabytes.\n+Append the letter \\f[CB]k\\f[R] or \\f[CB]K\\f[R] to indicate kilobytes,\n+\\f[CB]m\\f[R] or \\f[CB]M\\f[R] to indicate megabytes, or \\f[CB]g\\f[R] or\n+\\f[CB]G\\f[R] to indicate gigabytes.\n@@ -3427,3 +3730,3 @@\n--XX:NewSize=256m\n--XX:NewSize=262144k\n--XX:NewSize=268435456\n+\\-XX:NewSize=256m\n+\\-XX:NewSize=262144k\n+\\-XX:NewSize=268435456\n@@ -3433,1 +3736,1 @@\n-The \\f[V]-XX:NewSize\\f[R] option is equivalent to \\f[V]-Xmn\\f[R].\n+The \\f[CB]\\-XX:NewSize\\f[R] option is equivalent to \\f[CB]\\-Xmn\\f[R].\n@@ -3436,2 +3739,2 @@\n-\\f[V]-XX:ParallelGCThreads=\\f[R]\\f[I]threads\\f[R]\n-Sets the number of the stop-the-world (STW) worker threads.\n+.B \\f[CB]\\-XX:ParallelGCThreads=\\f[R]\\f[I]threads\\f[R]\n+Sets the number of the stop\\-the\\-world (STW) worker threads.\n@@ -3446,1 +3749,1 @@\n-\\f[V]-XX:ParallelGCThreads=2\\f[R]\n+\\f[CB]\\-XX:ParallelGCThreads=2\\f[R]\n@@ -3450,1 +3753,1 @@\n-\\f[V]-XX:+ParallelRefProcEnabled\\f[R]\n+.B \\f[CB]\\-XX:+ParallelRefProcEnabled\\f[R]\n@@ -3453,0 +3756,2 @@\n+.RS\n+.RE\n@@ -3454,2 +3759,2 @@\n-\\f[V]-XX:+PrintAdaptiveSizePolicy\\f[R]\n-Enables printing of information about adaptive-generation sizing.\n+.B \\f[CB]\\-XX:+PrintAdaptiveSizePolicy\\f[R]\n+Enables printing of information about adaptive\\-generation sizing.\n@@ -3457,0 +3762,2 @@\n+.RS\n+.RE\n@@ -3458,1 +3765,1 @@\n-\\f[V]-XX:+ScavengeBeforeFullGC\\f[R]\n+.B \\f[CB]\\-XX:+ScavengeBeforeFullGC\\f[R]\n@@ -3466,1 +3773,3 @@\n-option \\f[V]-XX:-ScavengeBeforeFullGC\\f[R].\n+option \\f[CB]\\-XX:\\-ScavengeBeforeFullGC\\f[R].\n+.RS\n+.RE\n@@ -3468,1 +3777,1 @@\n-\\f[V]-XX:SoftRefLRUPolicyMSPerMB=\\f[R]\\f[I]time\\f[R]\n+.B \\f[CB]\\-XX:SoftRefLRUPolicyMSPerMB=\\f[R]\\f[I]time\\f[R]\n@@ -3473,1 +3782,1 @@\n-The \\f[V]-XX:SoftRefLRUPolicyMSPerMB\\f[R] option accepts integer values\n+The \\f[CB]\\-XX:SoftRefLRUPolicyMSPerMB\\f[R] option accepts integer values\n@@ -3480,1 +3789,1 @@\n-In the latter case, the value of the \\f[V]-Xmx\\f[R] option has a\n+In the latter case, the value of the \\f[CB]\\-Xmx\\f[R] option has a\n@@ -3486,1 +3795,1 @@\n-\\f[V]-XX:SoftRefLRUPolicyMSPerMB=2500\\f[R]\n+\\f[CB]\\-XX:SoftRefLRUPolicyMSPerMB=2500\\f[R]\n@@ -3489,1 +3798,1 @@\n-\\f[V]-XX:-ShrinkHeapInSteps\\f[R]\n+.B \\f[CB]\\-XX:\\-ShrinkHeapInSteps\\f[R]\n@@ -3491,1 +3800,1 @@\n-option \\f[V]-XX:MaxHeapFreeRatio\\f[R].\n+option \\f[CB]\\-XX:MaxHeapFreeRatio\\f[R].\n@@ -3501,2 +3810,2 @@\n-\\f[V]MaxHeapFreeRatio\\f[R] option to keep the Java heap small by\n-reducing the dynamic footprint for embedded applications.\n+\\f[CB]MaxHeapFreeRatio\\f[R] option to keep the Java heap small by reducing\n+the dynamic footprint for embedded applications.\n@@ -3505,2 +3814,2 @@\n-\\f[V]-XX:StringDeduplicationAgeThreshold=\\f[R]\\f[I]threshold\\f[R]\n-Identifies \\f[V]String\\f[R] objects reaching the specified age that are\n+.B \\f[CB]\\-XX:StringDeduplicationAgeThreshold=\\f[R]\\f[I]threshold\\f[R]\n+Identifies \\f[CB]String\\f[R] objects reaching the specified age that are\n@@ -3514,5 +3823,5 @@\n-\\f[B]Note:\\f[R] \\f[V]String\\f[R] objects that are promoted to an old\n-heap region before this age has been reached are always considered\n-candidates for deduplication.\n-The default value for this option is \\f[V]3\\f[R].\n-See the \\f[V]-XX:+UseStringDeduplication\\f[R] option.\n+\\f[B]Note:\\f[R] \\f[CB]String\\f[R] objects that are promoted to an old heap\n+region before this age has been reached are always considered candidates\n+for deduplication.\n+The default value for this option is \\f[CB]3\\f[R].\n+See the \\f[CB]\\-XX:+UseStringDeduplication\\f[R] option.\n@@ -3522,1 +3831,1 @@\n-\\f[V]-XX:SurvivorRatio=\\f[R]\\f[I]ratio\\f[R]\n+.B \\f[CB]\\-XX:SurvivorRatio=\\f[R]\\f[I]ratio\\f[R]\n@@ -3530,1 +3839,1 @@\n-\\f[V]-XX:SurvivorRatio=4\\f[R]\n+\\f[CB]\\-XX:SurvivorRatio=4\\f[R]\n@@ -3534,1 +3843,1 @@\n-\\f[V]-XX:TargetSurvivorRatio=\\f[R]\\f[I]percent\\f[R]\n+.B \\f[CB]\\-XX:TargetSurvivorRatio=\\f[R]\\f[I]percent\\f[R]\n@@ -3544,1 +3853,1 @@\n-\\f[V]-XX:TargetSurvivorRatio=30\\f[R]\n+\\f[CB]\\-XX:TargetSurvivorRatio=30\\f[R]\n@@ -3548,2 +3857,2 @@\n-\\f[V]-XX:TLABSize=\\f[R]\\f[I]size\\f[R]\n-Sets the initial size (in bytes) of a thread-local allocation buffer\n+.B \\f[CB]\\-XX:TLABSize=\\f[R]\\f[I]size\\f[R]\n+Sets the initial size (in bytes) of a thread\\-local allocation buffer\n@@ -3551,3 +3860,3 @@\n-Append the letter \\f[V]k\\f[R] or \\f[V]K\\f[R] to indicate kilobytes,\n-\\f[V]m\\f[R] or \\f[V]M\\f[R] to indicate megabytes, or \\f[V]g\\f[R] or\n-\\f[V]G\\f[R] to indicate gigabytes.\n+Append the letter \\f[CB]k\\f[R] or \\f[CB]K\\f[R] to indicate kilobytes,\n+\\f[CB]m\\f[R] or \\f[CB]M\\f[R] to indicate megabytes, or \\f[CB]g\\f[R] or\n+\\f[CB]G\\f[R] to indicate gigabytes.\n@@ -3561,1 +3870,1 @@\n-\\f[V]-XX:TLABSize=512k\\f[R]\n+\\f[CB]\\-XX:TLABSize=512k\\f[R]\n@@ -3565,1 +3874,1 @@\n-\\f[V]-XX:+UseAdaptiveSizePolicy\\f[R]\n+.B \\f[CB]\\-XX:+UseAdaptiveSizePolicy\\f[R]\n@@ -3569,1 +3878,1 @@\n-\\f[V]-XX:-UseAdaptiveSizePolicy\\f[R] and set the size of the memory\n+\\f[CB]\\-XX:\\-UseAdaptiveSizePolicy\\f[R] and set the size of the memory\n@@ -3571,1 +3880,3 @@\n-See the \\f[V]-XX:SurvivorRatio\\f[R] option.\n+See the \\f[CB]\\-XX:SurvivorRatio\\f[R] option.\n+.RS\n+.RE\n@@ -3573,3 +3884,3 @@\n-\\f[V]-XX:+UseG1GC\\f[R]\n-Enables the use of the garbage-first (G1) garbage collector.\n-It\\[aq]s a server-style garbage collector, targeted for multiprocessor\n+.B \\f[CB]\\-XX:+UseG1GC\\f[R]\n+Enables the use of the garbage\\-first (G1) garbage collector.\n+It\\[aq]s a server\\-style garbage collector, targeted for multiprocessor\n@@ -3584,0 +3895,2 @@\n+.RS\n+.RE\n@@ -3585,1 +3898,1 @@\n-\\f[V]-XX:+UseGCOverheadLimit\\f[R]\n+.B \\f[CB]\\-XX:+UseGCOverheadLimit\\f[R]\n@@ -3587,1 +3900,1 @@\n-the JVM on GC before an \\f[V]OutOfMemoryError\\f[R] exception is thrown.\n+the JVM on GC before an \\f[CB]OutOfMemoryError\\f[R] exception is thrown.\n@@ -3589,2 +3902,2 @@\n-\\f[V]OutOfMemoryError\\f[R] if more than 98% of the total time is spent\n-on garbage collection and less than 2% of the heap is recovered.\n+\\f[CB]OutOfMemoryError\\f[R] if more than 98% of the total time is spent on\n+garbage collection and less than 2% of the heap is recovered.\n@@ -3594,1 +3907,3 @@\n-\\f[V]-XX:-UseGCOverheadLimit\\f[R].\n+\\f[CB]\\-XX:\\-UseGCOverheadLimit\\f[R].\n+.RS\n+.RE\n@@ -3596,1 +3911,1 @@\n-\\f[V]-XX:+UseNUMA\\f[R]\n+.B \\f[CB]\\-XX:+UseNUMA\\f[R]\n@@ -3603,1 +3918,3 @@\n-(\\f[V]-XX:+UseParallelGC\\f[R]).\n+(\\f[CB]\\-XX:+UseParallelGC\\f[R]).\n+.RS\n+.RE\n@@ -3605,1 +3922,1 @@\n-\\f[V]-XX:+UseParallelGC\\f[R]\n+.B \\f[CB]\\-XX:+UseParallelGC\\f[R]\n@@ -3614,1 +3931,1 @@\n-\\f[V]-XX:+UseSerialGC\\f[R]\n+.B \\f[CB]\\-XX:+UseSerialGC\\f[R]\n@@ -3619,0 +3936,2 @@\n+.RS\n+.RE\n@@ -3620,1 +3939,1 @@\n-\\f[V]-XX:+UseSHM\\f[R]\n+.B \\f[CB]\\-XX:+UseSHM\\f[R]\n@@ -3628,1 +3947,1 @@\n-\\f[V]-XX:+UseStringDeduplication\\f[R]\n+.B \\f[CB]\\-XX:+UseStringDeduplication\\f[R]\n@@ -3631,1 +3950,1 @@\n-To use this option, you must enable the garbage-first (G1) garbage\n+To use this option, you must enable the garbage\\-first (G1) garbage\n@@ -3635,1 +3954,1 @@\n-String deduplication reduces the memory footprint of \\f[V]String\\f[R]\n+String deduplication reduces the memory footprint of \\f[CB]String\\f[R]\n@@ -3637,4 +3956,4 @@\n-\\f[V]String\\f[R] objects are identical.\n-Instead of each \\f[V]String\\f[R] object pointing to its own character\n-array, identical \\f[V]String\\f[R] objects can point to and share the\n-same character array.\n+\\f[CB]String\\f[R] objects are identical.\n+Instead of each \\f[CB]String\\f[R] object pointing to its own character\n+array, identical \\f[CB]String\\f[R] objects can point to and share the same\n+character array.\n@@ -3643,2 +3962,2 @@\n-\\f[V]-XX:+UseTLAB\\f[R]\n-Enables the use of thread-local allocation blocks (TLABs) in the young\n+.B \\f[CB]\\-XX:+UseTLAB\\f[R]\n+Enables the use of thread\\-local allocation blocks (TLABs) in the young\n@@ -3647,1 +3966,3 @@\n-To disable the use of TLABs, specify the option \\f[V]-XX:-UseTLAB\\f[R].\n+To disable the use of TLABs, specify the option \\f[CB]\\-XX:\\-UseTLAB\\f[R].\n+.RS\n+.RE\n@@ -3649,1 +3970,1 @@\n-\\f[V]-XX:+UseZGC\\f[R]\n+.B \\f[CB]\\-XX:+UseZGC\\f[R]\n@@ -3655,0 +3976,2 @@\n+.RS\n+.RE\n@@ -3656,1 +3979,1 @@\n-\\f[V]-XX:ZAllocationSpikeTolerance=\\f[R]\\f[I]factor\\f[R]\n+.B \\f[CB]\\-XX:ZAllocationSpikeTolerance=\\f[R]\\f[I]factor\\f[R]\n@@ -3662,0 +3985,2 @@\n+.RS\n+.RE\n@@ -3663,1 +3988,1 @@\n-\\f[V]-XX:ZCollectionInterval=\\f[R]\\f[I]seconds\\f[R]\n+.B \\f[CB]\\-XX:ZCollectionInterval=\\f[R]\\f[I]seconds\\f[R]\n@@ -3667,0 +3992,2 @@\n+.RS\n+.RE\n@@ -3668,1 +3995,1 @@\n-\\f[V]-XX:ZFragmentationLimit=\\f[R]\\f[I]percent\\f[R]\n+.B \\f[CB]\\-XX:ZFragmentationLimit=\\f[R]\\f[I]percent\\f[R]\n@@ -3673,0 +4000,2 @@\n+.RS\n+.RE\n@@ -3674,1 +4003,1 @@\n-\\f[V]-XX:+ZProactive\\f[R]\n+.B \\f[CB]\\-XX:+ZProactive\\f[R]\n@@ -3683,0 +4012,2 @@\n+.RS\n+.RE\n@@ -3684,1 +4015,1 @@\n-\\f[V]-XX:+ZUncommit\\f[R]\n+.B \\f[CB]\\-XX:+ZUncommit\\f[R]\n@@ -3689,0 +4020,2 @@\n+.RS\n+.RE\n@@ -3690,1 +4023,1 @@\n-\\f[V]-XX:ZUncommitDelay=\\f[R]\\f[I]seconds\\f[R]\n+.B \\f[CB]\\-XX:ZUncommitDelay=\\f[R]\\f[I]seconds\\f[R]\n@@ -3697,0 +4030,2 @@\n+.RS\n+.RE\n@@ -3699,1 +4034,1 @@\n-These \\f[V]java\\f[R] options are deprecated and might be removed in a\n+These \\f[CB]java\\f[R] options are deprecated and might be removed in a\n@@ -3704,3 +4039,3 @@\n-\\f[V]-Xfuture\\f[R]\n-Enables strict class-file format checks that enforce close conformance\n-to the class-file format specification.\n+.B \\f[CB]\\-Xfuture\\f[R]\n+Enables strict class\\-file format checks that enforce close conformance\n+to the class\\-file format specification.\n@@ -3709,0 +4044,2 @@\n+.RS\n+.RE\n@@ -3710,1 +4047,1 @@\n-\\f[V]-Xloggc:\\f[R]\\f[I]filename\\f[R]\n+.B \\f[CB]\\-Xloggc:\\f[R]\\f[I]filename\\f[R]\n@@ -3713,1 +4050,1 @@\n-The \\f[V]-Xloggc\\f[R] option overrides \\f[V]-verbose:gc\\f[R] if both are\n+The \\f[CB]\\-Xloggc\\f[R] option overrides \\f[CB]\\-verbose:gc\\f[R] if both are\n@@ -3715,2 +4052,2 @@\n-\\f[V]-Xloggc:\\f[R]\\f[I]filename\\f[R] is replaced by\n-\\f[V]-Xlog:gc:\\f[R]\\f[I]filename\\f[R].\n+\\f[CB]\\-Xloggc:\\f[R]\\f[I]filename\\f[R] is replaced by\n+\\f[CB]\\-Xlog:gc:\\f[R]\\f[I]filename\\f[R].\n@@ -3722,1 +4059,1 @@\n-\\f[V]-Xlog:gc:garbage-collection.log\\f[R]\n+\\f[CB]\\-Xlog:gc:garbage\\-collection.log\\f[R]\n@@ -3725,1 +4062,1 @@\n-\\f[V]-XX:+FlightRecorder\\f[R]\n+.B \\f[CB]\\-XX:+FlightRecorder\\f[R]\n@@ -3729,0 +4066,2 @@\n+.RS\n+.RE\n@@ -3730,1 +4069,1 @@\n-\\f[V]-XX:InitialRAMFraction=\\f[R]\\f[I]ratio\\f[R]\n+.B \\f[CB]\\-XX:InitialRAMFraction=\\f[R]\\f[I]ratio\\f[R]\n@@ -3733,1 +4072,1 @@\n-determined as described in the \\f[V]-XX:MaxRAM\\f[R] option.\n+determined as described in the \\f[CB]\\-XX:MaxRAM\\f[R] option.\n@@ -3737,1 +4076,1 @@\n-Use the option \\f[V]-XX:InitialRAMPercentage\\f[R] instead.\n+Use the option \\f[CB]\\-XX:InitialRAMPercentage\\f[R] instead.\n@@ -3740,1 +4079,1 @@\n-\\f[V]-XX:MaxRAMFraction=\\f[R]\\f[I]ratio\\f[R]\n+.B \\f[CB]\\-XX:MaxRAMFraction=\\f[R]\\f[I]ratio\\f[R]\n@@ -3743,1 +4082,1 @@\n-amount determined as described in the \\f[V]-XX:MaxRAM\\f[R] option.\n+amount determined as described in the \\f[CB]\\-XX:MaxRAM\\f[R] option.\n@@ -3751,1 +4090,1 @@\n-See \\f[V]-XX:UseCompressedOops\\f[R] for further information about\n+See \\f[CB]\\-XX:UseCompressedOops\\f[R] for further information about\n@@ -3754,1 +4093,1 @@\n-Use the option \\f[V]-XX:MaxRAMPercentage\\f[R] instead.\n+Use the option \\f[CB]\\-XX:MaxRAMPercentage\\f[R] instead.\n@@ -3757,1 +4096,1 @@\n-\\f[V]-XX:MinRAMFraction=\\f[R]\\f[I]ratio\\f[R]\n+.B \\f[CB]\\-XX:MinRAMFraction=\\f[R]\\f[I]ratio\\f[R]\n@@ -3760,1 +4099,1 @@\n-amount determined as described in the \\f[V]-XX:MaxRAM\\f[R] option for\n+amount determined as described in the \\f[CB]\\-XX:MaxRAM\\f[R] option for\n@@ -3766,1 +4105,1 @@\n-Use the option \\f[V]-XX:MinRAMPercentage\\f[R] instead.\n+Use the option \\f[CB]\\-XX:MinRAMPercentage\\f[R] instead.\n@@ -3770,1 +4109,1 @@\n-These \\f[V]java\\f[R] options are still accepted but ignored, and a\n+These \\f[CB]java\\f[R] options are still accepted but ignored, and a\n@@ -3773,4 +4112,3 @@\n-\\f[V]--illegal-access=\\f[R]\\f[I]parameter\\f[R]\n-Controlled \\f[I]relaxed strong encapsulation\\f[R], as defined in\n-\\f[B]JEP 261\\f[R]\n-[https:\/\/openjdk.org\/jeps\/261#Relaxed-strong-encapsulation].\n+.B \\f[CB]\\-\\-illegal\\-access=\\f[R]\\f[I]parameter\\f[R]\n+Controlled \\f[I]relaxed strong encapsulation\\f[R], as defined in \\f[B]JEP\n+261\\f[R] [https:\/\/openjdk.org\/jeps\/261#Relaxed\\-strong\\-encapsulation].\n@@ -3780,0 +4118,2 @@\n+.RS\n+.RE\n@@ -3781,4 +4121,4 @@\n-\\f[V]-XX:+ExtendedDTraceProbes\\f[R]\n-\\f[B]Linux and macOS:\\f[R] Enables additional \\f[V]dtrace\\f[R] tool\n-probes that affect performance.\n-By default, this option is disabled and \\f[V]dtrace\\f[R] performs only\n+.B \\f[CB]\\-XX:+ExtendedDTraceProbes\\f[R]\n+\\f[B]Linux and macOS:\\f[R] Enables additional \\f[CB]dtrace\\f[R] tool probes\n+that affect performance.\n+By default, this option is disabled and \\f[CB]dtrace\\f[R] performs only\n@@ -3787,2 +4127,4 @@\n-\\f[V]-XX:+DTraceMethodProbes\\f[R], \\f[V]-XX:+DTraceAllocProbes\\f[R],\n-\\f[V]-XX:+DTraceMonitorProbes\\f[R].\n+\\f[CB]\\-XX:+DTraceMethodProbes\\f[R], \\f[CB]\\-XX:+DTraceAllocProbes\\f[R],\n+\\f[CB]\\-XX:+DTraceMonitorProbes\\f[R].\n+.RS\n+.RE\n@@ -3796,1 +4138,1 @@\n-\\f[B]The \\f[VB]java\\f[B] Command, Release 19\\f[R]\n+\\f[B]The \\f[BC]java\\f[B] Command, Release 19\\f[R]\n@@ -3799,1 +4141,1 @@\n-\\f[B]The \\f[VB]java\\f[B] Command, Release 18\\f[R]\n+\\f[B]The \\f[BC]java\\f[B] Command, Release 18\\f[R]\n@@ -3802,1 +4144,1 @@\n-\\f[B]The \\f[VB]java\\f[B] Command, Release 17\\f[R]\n+\\f[B]The \\f[BC]java\\f[B] Command, Release 17\\f[R]\n@@ -3805,1 +4147,1 @@\n-\\f[B]The \\f[VB]java\\f[B] Command, Release 16\\f[R]\n+\\f[B]The \\f[BC]java\\f[B] Command, Release 16\\f[R]\n@@ -3808,1 +4150,1 @@\n-\\f[B]The \\f[VB]java\\f[B] Command, Release 15\\f[R]\n+\\f[B]The \\f[BC]java\\f[B] Command, Release 15\\f[R]\n@@ -3811,1 +4153,1 @@\n-\\f[B]The \\f[VB]java\\f[B] Command, Release 14\\f[R]\n+\\f[B]The \\f[BC]java\\f[B] Command, Release 14\\f[R]\n@@ -3814,1 +4156,1 @@\n-\\f[B]The \\f[VB]java\\f[B] Command, Release 13\\f[R]\n+\\f[B]The \\f[BC]java\\f[B] Command, Release 13\\f[R]\n@@ -3818,1 +4160,1 @@\n-[https:\/\/docs.oracle.com\/en\/java\/javase\/12\/tools\/java.html#GUID-3B1CE181-CD30-4178-9602-230B800D4FAE]\n+[https:\/\/docs.oracle.com\/en\/java\/javase\/12\/tools\/java.html#GUID\\-3B1CE181\\-CD30\\-4178\\-9602\\-230B800D4FAE]\n@@ -3821,1 +4163,1 @@\n-[https:\/\/docs.oracle.com\/en\/java\/javase\/11\/tools\/java.html#GUID-741FC470-AA3E-494A-8D2B-1B1FE4A990D1]\n+[https:\/\/docs.oracle.com\/en\/java\/javase\/11\/tools\/java.html#GUID\\-741FC470\\-AA3E\\-494A\\-8D2B\\-1B1FE4A990D1]\n@@ -3836,1 +4178,1 @@\n-.SH JAVA COMMAND-LINE ARGUMENT FILES\n+.SH JAVA COMMAND\\-LINE ARGUMENT FILES\n@@ -3838,2 +4180,2 @@\n-You can shorten or simplify the \\f[V]java\\f[R] command by using\n-\\f[V]\\[at]\\f[R] argument files to specify one or more text files that\n+You can shorten or simplify the \\f[CB]java\\f[R] command by using\n+\\f[CB]\\@\\f[R] argument files to specify one or more text files that\n@@ -3841,3 +4183,3 @@\n-the \\f[V]java\\f[R] command.\n-This let\\[aq]s you to create \\f[V]java\\f[R] commands of any length on\n-any operating system.\n+the \\f[CB]java\\f[R] command.\n+This let\\[aq]s you to create \\f[CB]java\\f[R] commands of any length on any\n+operating system.\n@@ -3845,5 +4187,4 @@\n-In the command line, use the at sign (\\f[V]\\[at]\\f[R]) prefix to\n-identify an argument file that contains \\f[V]java\\f[R] options and class\n-names.\n-When the \\f[V]java\\f[R] command encounters a file beginning with the at\n-sign (\\f[V]\\[at]\\f[R]), it expands the contents of that file into an\n+In the command line, use the at sign (\\f[CB]\\@\\f[R]) prefix to identify an\n+argument file that contains \\f[CB]java\\f[R] options and class names.\n+When the \\f[CB]java\\f[R] command encounters a file beginning with the at\n+sign (\\f[CB]\\@\\f[R]), it expands the contents of that file into an\n@@ -3852,4 +4193,4 @@\n-The \\f[V]java\\f[R] launcher expands the argument file contents until it\n-encounters the \\f[V]--disable-\\[at]files\\f[R] option.\n-You can use the \\f[V]--disable-\\[at]files\\f[R] option anywhere on the\n-command line, including in an argument file, to stop \\f[V]\\[at]\\f[R]\n+The \\f[CB]java\\f[R] launcher expands the argument file contents until it\n+encounters the \\f[CB]\\-\\-disable\\-\\@files\\f[R] option.\n+You can use the \\f[CB]\\-\\-disable\\-\\@files\\f[R] option anywhere on the\n+command line, including in an argument file, to stop \\f[CB]\\@\\f[R]\n@@ -3858,2 +4199,1 @@\n-The following items describe the syntax of \\f[V]java\\f[R] argument\n-files:\n+The following items describe the syntax of \\f[CB]java\\f[R] argument files:\n@@ -3862,1 +4202,1 @@\n-system default encoding that\\[aq]s ASCII friendly, such as UTF-8.\n+system default encoding that\\[aq]s ASCII friendly, such as UTF\\-8.\n@@ -3872,2 +4212,2 @@\n-White space includes a white space character, \\f[V]\\[rs]t\\f[R],\n-\\f[V]\\[rs]n\\f[R], \\f[V]\\[rs]r\\f[R], and \\f[V]\\[rs]f\\f[R].\n+White space includes a white space character, \\f[CB]\\\\t\\f[R],\n+\\f[CB]\\\\n\\f[R], \\f[CB]\\\\r\\f[R], and \\f[CB]\\\\f\\f[R].\n@@ -3877,3 +4217,3 @@\n-\\f[V]c:\\[rs]Program Files\\f[R] that can be specified as either\n-\\f[V]\\[dq]c:\\[rs]\\[rs]Program Files\\[dq]\\f[R] or, to avoid an escape,\n-\\f[V]c:\\[rs]Program\\[dq] \\[dq]Files\\f[R].\n+\\f[CB]c:\\\\Program\\ Files\\f[R] that can be specified as either\n+\\f[CB]\"c:\\\\\\\\Program\\ Files\"\\f[R] or, to avoid an escape,\n+\\f[CB]c:\\\\Program\"\\ \"Files\\f[R].\n@@ -3883,2 +4223,2 @@\n-within quotation marks using quotation (\\[aq]\\[dq]\\[aq]) characters in\n-its entirety.\n+within quotation marks using quotation (\\[aq]\"\\[aq]) characters in its\n+entirety.\n@@ -3886,3 +4226,2 @@\n-A string within quotation marks may contain the characters\n-\\f[V]\\[rs]n\\f[R], \\f[V]\\[rs]r\\f[R], \\f[V]\\[rs]t\\f[R], and\n-\\f[V]\\[rs]f\\f[R].\n+A string within quotation marks may contain the characters \\f[CB]\\\\n\\f[R],\n+\\f[CB]\\\\r\\f[R], \\f[CB]\\\\t\\f[R], and \\f[CB]\\\\f\\f[R].\n@@ -3897,1 +4236,1 @@\n-Use the number sign \\f[V]#\\f[R] in the argument file to identify\n+Use the number sign \\f[CB]#\\f[R] in the argument file to identify\n@@ -3899,1 +4238,1 @@\n-All characters following the \\f[V]#\\f[R] are ignored until the end of\n+All characters following the \\f[CB]#\\f[R] are ignored until the end of\n@@ -3902,3 +4241,3 @@\n-Additional at sign \\f[V]\\[at]\\f[R] prefixes to \\f[V]\\[at]\\f[R] prefixed\n-options act as an escape, (the first \\f[V]\\[at]\\f[R] is removed and the\n-rest of the arguments are presented to the launcher literally).\n+Additional at sign \\f[CB]\\@\\f[R] prefixes to \\f[CB]\\@\\f[R] prefixed options\n+act as an escape, (the first \\f[CB]\\@\\f[R] is removed and the rest of the\n+arguments are presented to the launcher literally).\n@@ -3906,2 +4245,2 @@\n-Lines may be continued using the continuation character\n-(\\f[V]\\[rs]\\f[R]) at the end-of-line.\n+Lines may be continued using the continuation character (\\f[CB]\\\\\\f[R]) at\n+the end\\-of\\-line.\n@@ -3910,1 +4249,1 @@\n-(\\f[V]\\[rs]\\f[R]) may be placed at the first column.\n+(\\f[CB]\\\\\\f[R]) may be placed at the first column.\n@@ -3912,1 +4251,1 @@\n-Because backslash (\\[rs]) is an escape character, a backslash character\n+Because backslash (\\\\) is an escape character, a backslash character\n@@ -3915,1 +4254,1 @@\n-Partial quote is allowed and is closed by an end-of-file.\n+Partial quote is allowed and is closed by an end\\-of\\-file.\n@@ -3917,1 +4256,1 @@\n-An open quote stops at end-of-line unless \\f[V]\\[rs]\\f[R] is the last\n+An open quote stops at end\\-of\\-line unless \\f[CB]\\\\\\f[R] is the last\n@@ -3922,1 +4261,1 @@\n-\\f[V]*.java\\f[R]).\n+\\f[CB]*.java\\f[R]).\n@@ -3924,1 +4263,1 @@\n-Use of the at sign (\\f[V]\\[at]\\f[R]) to recursively interpret files\n+Use of the at sign (\\f[CB]\\@\\f[R]) to recursively interpret files\n@@ -3932,1 +4271,1 @@\n--cp \\[dq]lib\/\n+\\-cp\\ \"lib\/\n@@ -3942,1 +4281,1 @@\n-\\f[V]-cp lib\/cool\/app\/jars\\f[R]\n+\\f[CB]\\-cp\\ lib\/cool\/app\/jars\\f[R]\n@@ -3944,1 +4283,2 @@\n-.SS Example of a Backslash Character Escaped with Another Backslash Character in an Argument File\n+.SS Example of a Backslash Character Escaped with Another Backslash\n+Character in an Argument File\n@@ -3949,1 +4289,1 @@\n-\\f[V]-cp c:\\[rs]Program Files (x86)\\[rs]Java\\[rs]jre\\[rs]lib\\[rs]ext;c:\\[rs]Program Files\\[rs]Java\\[rs]jre9\\[rs]lib\\[rs]ext\\f[R]\n+\\f[CB]\\-cp\\ c:\\\\Program\\ Files\\ (x86)\\\\Java\\\\jre\\\\lib\\\\ext;c:\\\\Program\\ Files\\\\Java\\\\jre9\\\\lib\\\\ext\\f[R]\n@@ -3955,1 +4295,1 @@\n-\\f[V]-cp \\[dq]c:\\[rs]\\[rs]Program Files (x86)\\[rs]\\[rs]Java\\[rs]\\[rs]jre\\[rs]\\[rs]lib\\[rs]\\[rs]ext;c:\\[rs]\\[rs]Program Files\\[rs]\\[rs]Java\\[rs]\\[rs]jre9\\[rs]\\[rs]lib\\[rs]\\[rs]ext\\[dq]\\f[R]\n+\\f[CB]\\-cp\\ \"c:\\\\\\\\Program\\ Files\\ (x86)\\\\\\\\Java\\\\\\\\jre\\\\\\\\lib\\\\\\\\ext;c:\\\\\\\\Program\\ Files\\\\\\\\Java\\\\\\\\jre9\\\\\\\\lib\\\\\\\\ext\"\\f[R]\n@@ -3957,1 +4297,2 @@\n-.SS Example of an EOL Escape Used to Force Concatenation of Lines in an Argument File\n+.SS Example of an EOL Escape Used to Force Concatenation of Lines in an\n+Argument File\n@@ -3963,2 +4304,2 @@\n--cp \\[dq]\/lib\/cool app\/jars:\\[rs]\n-    \/lib\/another app\/jars\\[dq]\n+\\-cp\\ \"\/lib\/cool\\ app\/jars:\\\\\n+\\ \\ \\ \\ \/lib\/another\\ app\/jars\"\n@@ -3971,1 +4312,1 @@\n-\\f[V]-cp \/lib\/cool app\/jars:\/lib\/another app\/jars\\f[R]\n+\\f[CB]\\-cp\\ \/lib\/cool\\ app\/jars:\/lib\/another\\ app\/jars\\f[R]\n@@ -3979,2 +4320,2 @@\n--cp \\[dq]\/lib\/cool\\[rs]\n-\\[rs]app\/jars\\[dq]\n+\\-cp\\ \"\/lib\/cool\\\\\n+\\\\app\/jars\"\n@@ -3986,1 +4327,1 @@\n-\\f[V]-cp \/lib\/cool app\/jars\\f[R]\n+\\f[CB]\\-cp\\ \/lib\/cool\\ app\/jars\\f[R]\n@@ -3989,2 +4330,2 @@\n-You can use a single argument file, such as \\f[V]myargumentfile\\f[R] in\n-the following example, to hold all required \\f[V]java\\f[R] arguments:\n+You can use a single argument file, such as \\f[CB]myargumentfile\\f[R] in\n+the following example, to hold all required \\f[CB]java\\f[R] arguments:\n@@ -3993,1 +4334,1 @@\n-\\f[V]java \\[at]myargumentfile\\f[R]\n+\\f[CB]java\\ \\@myargumentfile\\f[R]\n@@ -4000,2 +4341,2 @@\n-In the following example, \\f[V]path1\/options\\f[R] and\n-\\f[V]path2\/options\\f[R] represent argument files with different paths.\n+In the following example, \\f[CB]path1\/options\\f[R] and\n+\\f[CB]path2\/options\\f[R] represent argument files with different paths.\n@@ -4006,1 +4347,1 @@\n-\\f[V]java \\[at]path1\/options \\[at]path2\/classes\\f[R]\n+\\f[CB]java\\ \\@path1\/options\\ \\@path2\/classes\\f[R]\n@@ -4021,1 +4362,1 @@\n-implemented that enables on-the-fly analysis of the code heap.\n+implemented that enables on\\-the\\-fly analysis of the code heap.\n@@ -4027,1 +4368,1 @@\n-Data collection and printing are done on an \\[dq]on request\\[dq] basis.\n+Data collection and printing are done on an \"on request\" basis.\n@@ -4030,1 +4371,1 @@\n-Requests for real-time, on-the-fly analysis can be issued with the\n+Requests for real\\-time, on\\-the\\-fly analysis can be issued with the\n@@ -4034,1 +4375,1 @@\n-\\f[V]jcmd\\f[R] \\f[I]pid\\f[R] \\f[V]Compiler.CodeHeap_Analytics\\f[R]\n+\\f[CB]jcmd\\f[R] \\f[I]pid\\f[R] \\f[CB]Compiler.CodeHeap_Analytics\\f[R]\n@@ -4042,1 +4383,1 @@\n-\\f[V]-Xlog:codecache=Trace\\f[R]\n+\\f[CB]\\-Xlog:codecache=Trace\\f[R]\n@@ -4045,2 +4386,2 @@\n-To see the code heap state when a \\[dq]CodeCache full\\[dq] condition\n-exists, start the VM with the command line option:\n+To see the code heap state when a \"CodeCache full\" condition exists,\n+start the VM with the command line option:\n@@ -4049,1 +4390,1 @@\n-\\f[V]-Xlog:codecache=Debug\\f[R]\n+\\f[CB]\\-Xlog:codecache=Debug\\f[R]\n@@ -4058,1 +4399,1 @@\n-You use the \\f[V]-Xlog\\f[R] option to configure or enable logging with\n+You use the \\f[CB]\\-Xlog\\f[R] option to configure or enable logging with\n@@ -4063,1 +4404,1 @@\n-\\f[V]-Xlog\\f[R][\\f[V]:\\f[R][\\f[I]what\\f[R]][\\f[V]:\\f[R][\\f[I]output\\f[R]][\\f[V]:\\f[R][\\f[I]decorators\\f[R]][\\f[V]:\\f[R]\\f[I]output-options\\f[R][\\f[V],\\f[R]...]]]]]\n+\\f[CB]\\-Xlog\\f[R][\\f[CB]:\\f[R][\\f[I]what\\f[R]][\\f[CB]:\\f[R][\\f[I]output\\f[R]][\\f[CB]:\\f[R][\\f[I]decorators\\f[R]][\\f[CB]:\\f[R]\\f[I]output\\-options\\f[R][\\f[CB],\\f[R]...]]]]]\n@@ -4065,1 +4406,1 @@\n-\\f[V]-Xlog:\\f[R]\\f[I]directive\\f[R]\n+\\f[CB]\\-Xlog:\\f[R]\\f[I]directive\\f[R]\n@@ -4068,1 +4409,1 @@\n-\\f[I]what\\f[R]\n+.B \\f[I]what\\f[R]\n@@ -4070,2 +4411,2 @@\n-\\f[I]tag1\\f[R][\\f[V]+\\f[R]\\f[I]tag2\\f[R]...][\\f[V]*\\f[R]][\\f[V]=\\f[R]\\f[I]level\\f[R]][\\f[V],\\f[R]...].\n-Unless the wildcard (\\f[V]*\\f[R]) is specified, only log messages tagged\n+\\f[I]tag1\\f[R][\\f[CB]+\\f[R]\\f[I]tag2\\f[R]...][\\f[CB]*\\f[R]][\\f[CB]=\\f[R]\\f[I]level\\f[R]][\\f[CB],\\f[R]...].\n+Unless the wildcard (\\f[CB]*\\f[R]) is specified, only log messages tagged\n@@ -4073,1 +4414,3 @@\n-See \\f[B]-Xlog Tags and Levels\\f[R].\n+See \\f[B]\\-Xlog Tags and Levels\\f[R].\n+.RS\n+.RE\n@@ -4075,1 +4418,1 @@\n-\\f[I]output\\f[R]\n+.B \\f[I]output\\f[R]\n@@ -4077,2 +4420,4 @@\n-Omitting the \\f[I]output\\f[R] type defaults to \\f[V]stdout\\f[R].\n-See \\f[B]-Xlog Output\\f[R].\n+Omitting the \\f[I]output\\f[R] type defaults to \\f[CB]stdout\\f[R].\n+See \\f[B]\\-Xlog Output\\f[R].\n+.RS\n+.RE\n@@ -4080,1 +4425,1 @@\n-\\f[I]decorators\\f[R]\n+.B \\f[I]decorators\\f[R]\n@@ -4082,2 +4427,2 @@\n-Omitting \\f[I]decorators\\f[R] defaults to \\f[V]uptime\\f[R],\n-\\f[V]level\\f[R], and \\f[V]tags\\f[R].\n+Omitting \\f[I]decorators\\f[R] defaults to \\f[CB]uptime\\f[R],\n+\\f[CB]level\\f[R], and \\f[CB]tags\\f[R].\n@@ -4085,0 +4430,2 @@\n+.RS\n+.RE\n@@ -4086,2 +4433,4 @@\n-\\f[I]output-options\\f[R]\n-Sets the \\f[V]-Xlog\\f[R] logging output options.\n+.B \\f[I]output\\-options\\f[R]\n+Sets the \\f[CB]\\-Xlog\\f[R] logging output options.\n+.RS\n+.RE\n@@ -4089,1 +4438,1 @@\n-\\f[I]directive\\f[R]\n+.B \\f[I]directive\\f[R]\n@@ -4091,0 +4440,2 @@\n+.RS\n+.RE\n@@ -4105,1 +4456,1 @@\n-The following provides quick reference to the \\f[V]-Xlog\\f[R] command\n+The following provides quick reference to the \\f[CB]\\-Xlog\\f[R] command\n@@ -4108,2 +4459,4 @@\n-\\f[V]-Xlog\\f[R]\n-Enables JVM logging on an \\f[V]info\\f[R] level.\n+.B \\f[CB]\\-Xlog\\f[R]\n+Enables JVM logging on an \\f[CB]info\\f[R] level.\n+.RS\n+.RE\n@@ -4111,2 +4464,2 @@\n-\\f[V]-Xlog:help\\f[R]\n-Prints \\f[V]-Xlog\\f[R] usage syntax and available tags, levels, and\n+.B \\f[CB]\\-Xlog:help\\f[R]\n+Prints \\f[CB]\\-Xlog\\f[R] usage syntax and available tags, levels, and\n@@ -4114,0 +4467,2 @@\n+.RS\n+.RE\n@@ -4115,1 +4470,1 @@\n-\\f[V]-Xlog:disable\\f[R]\n+.B \\f[CB]\\-Xlog:disable\\f[R]\n@@ -4118,0 +4473,2 @@\n+.RS\n+.RE\n@@ -4119,1 +4476,1 @@\n-\\f[V]-Xlog\\f[R][\\f[V]:\\f[R]\\f[I]option\\f[R]]\n+.B \\f[CB]\\-Xlog\\f[R][\\f[CB]:\\f[R]\\f[I]option\\f[R]]\n@@ -4122,1 +4479,1 @@\n-Multiple \\f[V]-Xlog\\f[R] arguments for the same output override each\n+Multiple \\f[CB]\\-Xlog\\f[R] arguments for the same output override each\n@@ -4129,1 +4486,1 @@\n-[\\f[I]tag-selection\\f[R]][\\f[V]:\\f[R][\\f[I]output\\f[R]][\\f[V]:\\f[R][\\f[I]decorators\\f[R]][\\f[V]:\\f[R]\\f[I]output-options\\f[R]]]]\n+[\\f[I]tag\\-selection\\f[R]][\\f[CB]:\\f[R][\\f[I]output\\f[R]][\\f[CB]:\\f[R][\\f[I]decorators\\f[R]][\\f[CB]:\\f[R]\\f[I]output\\-options\\f[R]]]]\n@@ -4132,2 +4489,2 @@\n-Omitting the \\f[I]tag-selection\\f[R] defaults to a tag-set of\n-\\f[V]all\\f[R] and a level of \\f[V]info\\f[R].\n+Omitting the \\f[I]tag\\-selection\\f[R] defaults to a tag\\-set of\n+\\f[CB]all\\f[R] and a level of \\f[CB]info\\f[R].\n@@ -4136,2 +4493,1 @@\n-\\f[I]tag\\f[R][\\f[V]+\\f[R]...]\n-\\f[V]all\\f[R]\n+\\f[I]tag\\f[R][\\f[CB]+\\f[R]...] \\f[CB]all\\f[R]\n@@ -4140,1 +4496,1 @@\n-The \\f[V]all\\f[R] tag is a meta tag consisting of all tag-sets\n+The \\f[CB]all\\f[R] tag is a meta tag consisting of all tag\\-sets\n@@ -4142,1 +4498,1 @@\n-The asterisk \\f[V]*\\f[R] in a tag set definition denotes a wildcard tag\n+The asterisk \\f[CB]*\\f[R] in a tag set definition denotes a wildcard tag\n@@ -4149,1 +4505,1 @@\n-\\f[I]output-options\\f[R] is\n+\\f[I]output\\-options\\f[R] is\n@@ -4152,3 +4508,3 @@\n-\\f[V]filecount=\\f[R]\\f[I]file-count\\f[R] \\f[V]filesize=\\f[R]\\f[I]file\n-size with optional K, M or G suffix\\f[R]\n-\\f[V]foldmultilines=\\f[R]\\f[I]<true|false>\\f[R]\n+\\f[CB]filecount=\\f[R]\\f[I]file\\-count\\f[R] \\f[CB]filesize=\\f[R]\\f[I]file size\n+with optional K, M or G suffix\\f[R]\n+\\f[CB]foldmultilines=\\f[R]\\f[I]<true|false>\\f[R]\n@@ -4157,1 +4513,1 @@\n-When \\f[V]foldmultilines\\f[R] is true, a log event that consists of\n+When \\f[CB]foldmultilines\\f[R] is true, a log event that consists of\n@@ -4159,2 +4515,2 @@\n-characters with the sequence \\f[V]\\[aq]\\[rs]\\[aq]\\f[R] and\n-\\f[V]\\[aq]n\\[aq]\\f[R] in the output.\n+characters with the sequence \\f[CB]\\[aq]\\\\\\[aq]\\f[R] and\n+\\f[CB]\\[aq]n\\[aq]\\f[R] in the output.\n@@ -4163,1 +4519,1 @@\n-This option is safe to use with UTF-8 character encodings, but other\n+This option is safe to use with UTF\\-8 character encodings, but other\n@@ -4165,1 +4521,1 @@\n-For example, it may incorrectly convert multi-byte sequences in Shift\n+For example, it may incorrectly convert multi\\-byte sequences in Shift\n@@ -4170,1 +4526,1 @@\n-When the \\f[V]-Xlog\\f[R] option and nothing else is specified on the\n+When the \\f[CB]\\-Xlog\\f[R] option and nothing else is specified on the\n@@ -4179,1 +4535,1 @@\n-\\f[V]-Xlog:all=warning:stdout:uptime,level,tags\\f[R]\n+\\f[CB]\\-Xlog:all=warning:stdout:uptime,level,tags\\f[R]\n@@ -4186,1 +4542,1 @@\n-specified dynamically with the \\f[V]VM.log\\f[R] command.\n+specified dynamically with the \\f[CB]VM.log\\f[R] command.\n@@ -4189,1 +4545,1 @@\n-.SS -Xlog Tags and Levels\n+.SS \\-Xlog Tags and Levels\n@@ -4194,1 +4550,1 @@\n-involves (such as, \\f[V]gc\\f[R], \\f[V]jit\\f[R], or \\f[V]os\\f[R]).\n+involves (such as, \\f[CB]gc\\f[R], \\f[CB]jit\\f[R], or \\f[CB]os\\f[R]).\n@@ -4203,1 +4559,1 @@\n-\\f[V]off\\f[R]\n+\\f[CB]off\\f[R]\n@@ -4205,1 +4561,1 @@\n-\\f[V]trace\\f[R]\n+\\f[CB]trace\\f[R]\n@@ -4207,1 +4563,1 @@\n-\\f[V]debug\\f[R]\n+\\f[CB]debug\\f[R]\n@@ -4209,1 +4565,1 @@\n-\\f[V]info\\f[R]\n+\\f[CB]info\\f[R]\n@@ -4211,1 +4567,1 @@\n-\\f[V]warning\\f[R]\n+\\f[CB]warning\\f[R]\n@@ -4213,1 +4569,1 @@\n-\\f[V]error\\f[R]\n+\\f[CB]error\\f[R]\n@@ -4220,2 +4576,2 @@\n-\\f[V]-Xlog:help\\f[R].\n-Specifying \\f[V]all\\f[R] instead of a tag combination matches all tag\n+\\f[CB]\\-Xlog:help\\f[R].\n+Specifying \\f[CB]all\\f[R] instead of a tag combination matches all tag\n@@ -4223,1 +4579,1 @@\n-.SS -Xlog Output\n+.SS \\-Xlog Output\n@@ -4225,1 +4581,1 @@\n-The \\f[V]-Xlog\\f[R] option supports the following types of outputs:\n+The \\f[CB]\\-Xlog\\f[R] option supports the following types of outputs:\n@@ -4227,1 +4583,1 @@\n-\\f[V]stdout\\f[R] --- Sends output to stdout\n+\\f[CB]stdout\\f[R] \\-\\-\\- Sends output to stdout\n@@ -4229,1 +4585,1 @@\n-\\f[V]stderr\\f[R] --- Sends output to stderr\n+\\f[CB]stderr\\f[R] \\-\\-\\- Sends output to stderr\n@@ -4231,1 +4587,1 @@\n-\\f[V]file=\\f[R]\\f[I]filename\\f[R] --- Sends output to text file(s).\n+\\f[CB]file=\\f[R]\\f[I]filename\\f[R] \\-\\-\\- Sends output to text file(s).\n@@ -4233,2 +4589,2 @@\n-When using \\f[V]file=\\f[R]\\f[I]filename\\f[R], specifying \\f[V]%p\\f[R]\n-and\/or \\f[V]%t\\f[R] in the file name expands to the JVM\\[aq]s PID and\n+When using \\f[CB]file=\\f[R]\\f[I]filename\\f[R], specifying \\f[CB]%p\\f[R]\n+and\/or \\f[CB]%t\\f[R] in the file name expands to the JVM\\[aq]s PID and\n@@ -4239,1 +4595,1 @@\n-rotation, specify the options \\f[V]filesize=10M, filecount=5\\f[R].\n+rotation, specify the options \\f[CB]filesize=10M,\\ filecount=5\\f[R].\n@@ -4244,3 +4600,3 @@\n-Specifying \\f[V]filecount=0\\f[R] means that the log file shouldn\\[aq]t\n-be rotated.\n-There\\[aq]s a possibility of the pre-existing log file getting\n+Specifying \\f[CB]filecount=0\\f[R] means that the log file shouldn\\[aq]t be\n+rotated.\n+There\\[aq]s a possibility of the pre\\-existing log file getting\n@@ -4248,1 +4604,1 @@\n-.SS -Xlog Output Mode\n+.SS \\-Xlog Output Mode\n@@ -4250,1 +4606,1 @@\n-By default logging messages are output synchronously - each log message\n+By default logging messages are output synchronously \\- each log message\n@@ -4254,1 +4610,1 @@\n-\\f[V]-Xlog:async\\f[R]\n+.B \\f[CB]\\-Xlog:async\\f[R]\n@@ -4256,0 +4612,2 @@\n+.RS\n+.RE\n@@ -4262,1 +4620,1 @@\n-Log entry write operations are guaranteed non-blocking.\n+Log entry write operations are guaranteed non\\-blocking.\n@@ -4264,1 +4622,1 @@\n-The option \\f[V]-XX:AsyncLogBufferSize=N\\f[R] specifies the memory\n+The option \\f[CB]\\-XX:AsyncLogBufferSize=N\\f[R] specifies the memory\n@@ -4280,1 +4638,1 @@\n-[6.567s][info][gc,old] Old collection complete\n+[6.567s][info][gc,old]\\ Old\\ collection\\ complete\n@@ -4284,3 +4642,3 @@\n-Omitting \\f[V]decorators\\f[R] defaults to \\f[V]uptime\\f[R],\n-\\f[V]level\\f[R], and \\f[V]tags\\f[R].\n-The \\f[V]none\\f[R] decorator is special and is used to turn off all\n+Omitting \\f[CB]decorators\\f[R] defaults to \\f[CB]uptime\\f[R],\n+\\f[CB]level\\f[R], and \\f[CB]tags\\f[R].\n+The \\f[CB]none\\f[R] decorator is special and is used to turn off all\n@@ -4289,8 +4647,7 @@\n-\\f[V]time\\f[R] (\\f[V]t\\f[R]), \\f[V]utctime\\f[R] (\\f[V]utc\\f[R]),\n-\\f[V]uptime\\f[R] (\\f[V]u\\f[R]), \\f[V]timemillis\\f[R] (\\f[V]tm\\f[R]),\n-\\f[V]uptimemillis\\f[R] (\\f[V]um\\f[R]), \\f[V]timenanos\\f[R]\n-(\\f[V]tn\\f[R]), \\f[V]uptimenanos\\f[R] (\\f[V]un\\f[R]), \\f[V]hostname\\f[R]\n-(\\f[V]hn\\f[R]), \\f[V]pid\\f[R] (\\f[V]p\\f[R]), \\f[V]tid\\f[R]\n-(\\f[V]ti\\f[R]), \\f[V]level\\f[R] (\\f[V]l\\f[R]), \\f[V]tags\\f[R]\n-(\\f[V]tg\\f[R]) decorators can also be specified as \\f[V]none\\f[R] for no\n-decoration.\n+\\f[CB]time\\f[R] (\\f[CB]t\\f[R]), \\f[CB]utctime\\f[R] (\\f[CB]utc\\f[R]),\n+\\f[CB]uptime\\f[R] (\\f[CB]u\\f[R]), \\f[CB]timemillis\\f[R] (\\f[CB]tm\\f[R]),\n+\\f[CB]uptimemillis\\f[R] (\\f[CB]um\\f[R]), \\f[CB]timenanos\\f[R] (\\f[CB]tn\\f[R]),\n+\\f[CB]uptimenanos\\f[R] (\\f[CB]un\\f[R]), \\f[CB]hostname\\f[R] (\\f[CB]hn\\f[R]),\n+\\f[CB]pid\\f[R] (\\f[CB]p\\f[R]), \\f[CB]tid\\f[R] (\\f[CB]ti\\f[R]), \\f[CB]level\\f[R]\n+(\\f[CB]l\\f[R]), \\f[CB]tags\\f[R] (\\f[CB]tg\\f[R]) decorators can also be\n+specified as \\f[CB]none\\f[R] for no decoration.\n@@ -4309,1 +4666,1 @@\n-\\f[V]time\\f[R] or \\f[V]t\\f[R]\n+\\f[CB]time\\f[R] or \\f[CB]t\\f[R]\n@@ -4311,1 +4668,1 @@\n-Current time and date in ISO-8601 format.\n+Current time and date in ISO\\-8601 format.\n@@ -4314,1 +4671,1 @@\n-\\f[V]utctime\\f[R] or \\f[V]utc\\f[R]\n+\\f[CB]utctime\\f[R] or \\f[CB]utc\\f[R]\n@@ -4319,1 +4676,1 @@\n-\\f[V]uptime\\f[R] or \\f[V]u\\f[R]\n+\\f[CB]uptime\\f[R] or \\f[CB]u\\f[R]\n@@ -4325,1 +4682,1 @@\n-\\f[V]timemillis\\f[R] or \\f[V]tm\\f[R]\n+\\f[CB]timemillis\\f[R] or \\f[CB]tm\\f[R]\n@@ -4327,1 +4684,1 @@\n-The same value as generated by \\f[V]System.currentTimeMillis()\\f[R]\n+The same value as generated by \\f[CB]System.currentTimeMillis()\\f[R]\n@@ -4330,1 +4687,1 @@\n-\\f[V]uptimemillis\\f[R] or \\f[V]um\\f[R]\n+\\f[CB]uptimemillis\\f[R] or \\f[CB]um\\f[R]\n@@ -4335,1 +4692,1 @@\n-\\f[V]timenanos\\f[R] or \\f[V]tn\\f[R]\n+\\f[CB]timenanos\\f[R] or \\f[CB]tn\\f[R]\n@@ -4337,1 +4694,1 @@\n-The same value generated by \\f[V]System.nanoTime()\\f[R].\n+The same value generated by \\f[CB]System.nanoTime()\\f[R].\n@@ -4340,1 +4697,1 @@\n-\\f[V]uptimenanos\\f[R] or \\f[V]un\\f[R]\n+\\f[CB]uptimenanos\\f[R] or \\f[CB]un\\f[R]\n@@ -4345,1 +4702,1 @@\n-\\f[V]hostname\\f[R] or \\f[V]hn\\f[R]\n+\\f[CB]hostname\\f[R] or \\f[CB]hn\\f[R]\n@@ -4350,1 +4707,1 @@\n-\\f[V]pid\\f[R] or \\f[V]p\\f[R]\n+\\f[CB]pid\\f[R] or \\f[CB]p\\f[R]\n@@ -4355,1 +4712,1 @@\n-\\f[V]tid\\f[R] or \\f[V]ti\\f[R]\n+\\f[CB]tid\\f[R] or \\f[CB]ti\\f[R]\n@@ -4360,1 +4717,1 @@\n-\\f[V]level\\f[R] or \\f[V]l\\f[R]\n+\\f[CB]level\\f[R] or \\f[CB]l\\f[R]\n@@ -4365,1 +4722,1 @@\n-\\f[V]tags\\f[R] or \\f[V]tg\\f[R]\n+\\f[CB]tags\\f[R] or \\f[CB]tg\\f[R]\n@@ -4367,1 +4724,1 @@\n-The tag-set associated with the log message.\n+The tag\\-set associated with the log message.\n@@ -4385,1 +4742,1 @@\n-\\f[V]G1PrintHeapRegions\\f[R]\n+\\f[CB]G1PrintHeapRegions\\f[R]\n@@ -4387,1 +4744,1 @@\n-\\f[V]-Xlog:gc+region=trace\\f[R]\n+\\f[CB]\\-Xlog:gc+region=trace\\f[R]\n@@ -4392,1 +4749,1 @@\n-\\f[V]GCLogFileSize\\f[R]\n+\\f[CB]GCLogFileSize\\f[R]\n@@ -4399,1 +4756,1 @@\n-\\f[V]NumberOfGCLogFiles\\f[R]\n+\\f[CB]NumberOfGCLogFiles\\f[R]\n@@ -4406,1 +4763,1 @@\n-\\f[V]PrintAdaptiveSizePolicy\\f[R]\n+\\f[CB]PrintAdaptiveSizePolicy\\f[R]\n@@ -4408,1 +4765,1 @@\n-\\f[V]-Xlog:gc+ergo*=\\f[R]\\f[I]level\\f[R]\n+\\f[CB]\\-Xlog:gc+ergo*=\\f[R]\\f[I]level\\f[R]\n@@ -4410,3 +4767,3 @@\n-Use a \\f[I]level\\f[R] of \\f[V]debug\\f[R] for most of the information, or\n-a \\f[I]level\\f[R] of \\f[V]trace\\f[R] for all of what was logged for\n-\\f[V]PrintAdaptiveSizePolicy\\f[R].\n+Use a \\f[I]level\\f[R] of \\f[CB]debug\\f[R] for most of the information, or a\n+\\f[I]level\\f[R] of \\f[CB]trace\\f[R] for all of what was logged for\n+\\f[CB]PrintAdaptiveSizePolicy\\f[R].\n@@ -4415,1 +4772,1 @@\n-\\f[V]PrintGC\\f[R]\n+\\f[CB]PrintGC\\f[R]\n@@ -4417,1 +4774,1 @@\n-\\f[V]-Xlog:gc\\f[R]\n+\\f[CB]\\-Xlog:gc\\f[R]\n@@ -4422,1 +4779,1 @@\n-\\f[V]PrintGCApplicationConcurrentTime\\f[R]\n+\\f[CB]PrintGCApplicationConcurrentTime\\f[R]\n@@ -4424,1 +4781,1 @@\n-\\f[V]-Xlog:safepoint\\f[R]\n+\\f[CB]\\-Xlog:safepoint\\f[R]\n@@ -4426,2 +4783,2 @@\n-Note that \\f[V]PrintGCApplicationConcurrentTime\\f[R] and\n-\\f[V]PrintGCApplicationStoppedTime\\f[R] are logged on the same tag and\n+Note that \\f[CB]PrintGCApplicationConcurrentTime\\f[R] and\n+\\f[CB]PrintGCApplicationStoppedTime\\f[R] are logged on the same tag and\n@@ -4431,1 +4788,1 @@\n-\\f[V]PrintGCApplicationStoppedTime\\f[R]\n+\\f[CB]PrintGCApplicationStoppedTime\\f[R]\n@@ -4433,1 +4790,1 @@\n-\\f[V]-Xlog:safepoint\\f[R]\n+\\f[CB]\\-Xlog:safepoint\\f[R]\n@@ -4435,2 +4792,2 @@\n-Note that \\f[V]PrintGCApplicationConcurrentTime\\f[R] and\n-\\f[V]PrintGCApplicationStoppedTime\\f[R] are logged on the same tag and\n+Note that \\f[CB]PrintGCApplicationConcurrentTime\\f[R] and\n+\\f[CB]PrintGCApplicationStoppedTime\\f[R] are logged on the same tag and\n@@ -4440,1 +4797,1 @@\n-\\f[V]PrintGCCause\\f[R]\n+\\f[CB]PrintGCCause\\f[R]\n@@ -4447,1 +4804,1 @@\n-\\f[V]PrintGCDateStamps\\f[R]\n+\\f[CB]PrintGCDateStamps\\f[R]\n@@ -4454,1 +4811,1 @@\n-\\f[V]PrintGCDetails\\f[R]\n+\\f[CB]PrintGCDetails\\f[R]\n@@ -4456,1 +4813,1 @@\n-\\f[V]-Xlog:gc*\\f[R]\n+\\f[CB]\\-Xlog:gc*\\f[R]\n@@ -4461,1 +4818,1 @@\n-\\f[V]PrintGCID\\f[R]\n+\\f[CB]PrintGCID\\f[R]\n@@ -4468,1 +4825,1 @@\n-\\f[V]PrintGCTaskTimeStamps\\f[R]\n+\\f[CB]PrintGCTaskTimeStamps\\f[R]\n@@ -4470,1 +4827,1 @@\n-\\f[V]-Xlog:gc+task*=debug\\f[R]\n+\\f[CB]\\-Xlog:gc+task*=debug\\f[R]\n@@ -4475,1 +4832,1 @@\n-\\f[V]PrintGCTimeStamps\\f[R]\n+\\f[CB]PrintGCTimeStamps\\f[R]\n@@ -4482,1 +4839,1 @@\n-\\f[V]PrintHeapAtGC\\f[R]\n+\\f[CB]PrintHeapAtGC\\f[R]\n@@ -4484,1 +4841,1 @@\n-\\f[V]-Xlog:gc+heap=trace\\f[R]\n+\\f[CB]\\-Xlog:gc+heap=trace\\f[R]\n@@ -4489,1 +4846,1 @@\n-\\f[V]PrintReferenceGC\\f[R]\n+\\f[CB]PrintReferenceGC\\f[R]\n@@ -4491,1 +4848,1 @@\n-\\f[V]-Xlog:gc+ref*=debug\\f[R]\n+\\f[CB]\\-Xlog:gc+ref*=debug\\f[R]\n@@ -4493,2 +4850,2 @@\n-Note that in the old logging, \\f[V]PrintReferenceGC\\f[R] had an effect\n-only if \\f[V]PrintGCDetails\\f[R] was also enabled.\n+Note that in the old logging, \\f[CB]PrintReferenceGC\\f[R] had an effect\n+only if \\f[CB]PrintGCDetails\\f[R] was also enabled.\n@@ -4497,1 +4854,1 @@\n-\\f[V]PrintStringDeduplicationStatistics\\f[R]\n+\\f[CB]PrintStringDeduplicationStatistics\\f[R]\n@@ -4499,1 +4856,1 @@\n-\\[ga]-Xlog:gc+stringdedup*=debug\n+`\\-Xlog:gc+stringdedup*=debug\n@@ -4501,1 +4858,1 @@\n-\\[ga] Not Applicable\n+` Not Applicable\n@@ -4504,1 +4861,1 @@\n-\\f[V]PrintTenuringDistribution\\f[R]\n+\\f[CB]PrintTenuringDistribution\\f[R]\n@@ -4506,1 +4863,1 @@\n-\\f[V]-Xlog:gc+age*=\\f[R]\\f[I]level\\f[R]\n+\\f[CB]\\-Xlog:gc+age*=\\f[R]\\f[I]level\\f[R]\n@@ -4508,3 +4865,3 @@\n-Use a \\f[I]level\\f[R] of \\f[V]debug\\f[R] for the most relevant\n-information, or a \\f[I]level\\f[R] of \\f[V]trace\\f[R] for all of what was\n-logged for \\f[V]PrintTenuringDistribution\\f[R].\n+Use a \\f[I]level\\f[R] of \\f[CB]debug\\f[R] for the most relevant\n+information, or a \\f[I]level\\f[R] of \\f[CB]trace\\f[R] for all of what was\n+logged for \\f[CB]PrintTenuringDistribution\\f[R].\n@@ -4513,1 +4870,1 @@\n-\\f[V]UseGCLogFileRotation\\f[R]\n+\\f[CB]UseGCLogFileRotation\\f[R]\n@@ -4517,1 +4874,1 @@\n-What was logged for \\f[V]PrintTenuringDistribution\\f[R].\n+What was logged for \\f[CB]PrintTenuringDistribution\\f[R].\n@@ -4539,1 +4896,1 @@\n-\\f[V]TraceExceptions\\f[R]\n+\\f[CB]TraceExceptions\\f[R]\n@@ -4541,1 +4898,1 @@\n-\\f[V]-Xlog:exceptions=info\\f[R]\n+\\f[CB]\\-Xlog:exceptions=info\\f[R]\n@@ -4546,1 +4903,1 @@\n-\\f[V]TraceClassLoading\\f[R]\n+\\f[CB]TraceClassLoading\\f[R]\n@@ -4548,1 +4905,1 @@\n-\\f[V]-Xlog:class+load=\\f[R]\\f[I]level\\f[R]\n+\\f[CB]\\-Xlog:class+load=\\f[R]\\f[I]level\\f[R]\n@@ -4550,4 +4907,4 @@\n-Use \\f[I]level\\f[R]=\\f[V]info\\f[R] for regular information, or\n-\\f[I]level\\f[R]=\\f[V]debug\\f[R] for additional information.\n-In Unified Logging syntax, \\f[V]-verbose:class\\f[R] equals\n-\\f[V]-Xlog:class+load=info,class+unload=info\\f[R].\n+Use \\f[I]level\\f[R]=\\f[CB]info\\f[R] for regular information, or\n+\\f[I]level\\f[R]=\\f[CB]debug\\f[R] for additional information.\n+In Unified Logging syntax, \\f[CB]\\-verbose:class\\f[R] equals\n+\\f[CB]\\-Xlog:class+load=info,class+unload=info\\f[R].\n@@ -4556,1 +4913,1 @@\n-\\f[V]TraceClassLoadingPreorder\\f[R]\n+\\f[CB]TraceClassLoadingPreorder\\f[R]\n@@ -4558,1 +4915,1 @@\n-\\f[V]-Xlog:class+preorder=debug\\f[R]\n+\\f[CB]\\-Xlog:class+preorder=debug\\f[R]\n@@ -4563,1 +4920,1 @@\n-\\f[V]TraceClassUnloading\\f[R]\n+\\f[CB]TraceClassUnloading\\f[R]\n@@ -4565,1 +4922,1 @@\n-\\f[V]-Xlog:class+unload=\\f[R]\\f[I]level\\f[R]\n+\\f[CB]\\-Xlog:class+unload=\\f[R]\\f[I]level\\f[R]\n@@ -4567,4 +4924,4 @@\n-Use \\f[I]level\\f[R]=\\f[V]info\\f[R] for regular information, or\n-\\f[I]level\\f[R]=\\f[V]trace\\f[R] for additional information.\n-In Unified Logging syntax, \\f[V]-verbose:class\\f[R] equals\n-\\f[V]-Xlog:class+load=info,class+unload=info\\f[R].\n+Use \\f[I]level\\f[R]=\\f[CB]info\\f[R] for regular information, or\n+\\f[I]level\\f[R]=\\f[CB]trace\\f[R] for additional information.\n+In Unified Logging syntax, \\f[CB]\\-verbose:class\\f[R] equals\n+\\f[CB]\\-Xlog:class+load=info,class+unload=info\\f[R].\n@@ -4573,1 +4930,1 @@\n-\\f[V]VerboseVerification\\f[R]\n+\\f[CB]VerboseVerification\\f[R]\n@@ -4575,1 +4932,1 @@\n-\\f[V]-Xlog:verification=info\\f[R]\n+\\f[CB]\\-Xlog:verification=info\\f[R]\n@@ -4580,1 +4937,1 @@\n-\\f[V]TraceClassPaths\\f[R]\n+\\f[CB]TraceClassPaths\\f[R]\n@@ -4582,1 +4939,1 @@\n-\\f[V]-Xlog:class+path=info\\f[R]\n+\\f[CB]\\-Xlog:class+path=info\\f[R]\n@@ -4587,1 +4944,1 @@\n-\\f[V]TraceClassResolution\\f[R]\n+\\f[CB]TraceClassResolution\\f[R]\n@@ -4589,1 +4946,1 @@\n-\\f[V]-Xlog:class+resolve=debug\\f[R]\n+\\f[CB]\\-Xlog:class+resolve=debug\\f[R]\n@@ -4594,1 +4951,1 @@\n-\\f[V]TraceClassInitialization\\f[R]\n+\\f[CB]TraceClassInitialization\\f[R]\n@@ -4596,1 +4953,1 @@\n-\\f[V]-Xlog:class+init=info\\f[R]\n+\\f[CB]\\-Xlog:class+init=info\\f[R]\n@@ -4601,1 +4958,1 @@\n-\\f[V]TraceLoaderConstraints\\f[R]\n+\\f[CB]TraceLoaderConstraints\\f[R]\n@@ -4603,1 +4960,1 @@\n-\\f[V]-Xlog:class+loader+constraints=info\\f[R]\n+\\f[CB]\\-Xlog:class+loader+constraints=info\\f[R]\n@@ -4608,1 +4965,1 @@\n-\\f[V]TraceClassLoaderData\\f[R]\n+\\f[CB]TraceClassLoaderData\\f[R]\n@@ -4610,1 +4967,1 @@\n-\\f[V]-Xlog:class+loader+data=\\f[R]\\f[I]level\\f[R]\n+\\f[CB]\\-Xlog:class+loader+data=\\f[R]\\f[I]level\\f[R]\n@@ -4612,2 +4969,2 @@\n-Use \\f[I]level\\f[R]=\\f[V]debug\\f[R] for regular information or\n-\\f[I]level\\f[R]=\\f[V]trace\\f[R] for additional information.\n+Use \\f[I]level\\f[R]=\\f[CB]debug\\f[R] for regular information or\n+\\f[I]level\\f[R]=\\f[CB]trace\\f[R] for additional information.\n@@ -4616,1 +4973,1 @@\n-\\f[V]TraceSafepointCleanupTime\\f[R]\n+\\f[CB]TraceSafepointCleanupTime\\f[R]\n@@ -4618,1 +4975,1 @@\n-\\f[V]-Xlog:safepoint+cleanup=info\\f[R]\n+\\f[CB]\\-Xlog:safepoint+cleanup=info\\f[R]\n@@ -4623,1 +4980,1 @@\n-\\f[V]TraceSafepoint\\f[R]\n+\\f[CB]TraceSafepoint\\f[R]\n@@ -4625,1 +4982,1 @@\n-\\f[V]-Xlog:safepoint=debug\\f[R]\n+\\f[CB]\\-Xlog:safepoint=debug\\f[R]\n@@ -4630,1 +4987,1 @@\n-\\f[V]TraceMonitorInflation\\f[R]\n+\\f[CB]TraceMonitorInflation\\f[R]\n@@ -4632,1 +4989,1 @@\n-\\f[V]-Xlog:monitorinflation=debug\\f[R]\n+\\f[CB]\\-Xlog:monitorinflation=debug\\f[R]\n@@ -4637,1 +4994,1 @@\n-\\f[V]TraceRedefineClasses\\f[R]\n+\\f[CB]TraceRedefineClasses\\f[R]\n@@ -4639,1 +4996,1 @@\n-\\f[V]-Xlog:redefine+class*=\\f[R]\\f[I]level\\f[R]\n+\\f[CB]\\-Xlog:redefine+class*=\\f[R]\\f[I]level\\f[R]\n@@ -4641,2 +4998,2 @@\n-\\f[I]level\\f[R]=\\f[V]info\\f[R], \\f[V]debug\\f[R], and \\f[V]trace\\f[R]\n-provide increasing amounts of information.\n+\\f[I]level\\f[R]=\\f[CB]info\\f[R], \\f[CB]debug\\f[R], and \\f[CB]trace\\f[R] provide\n+increasing amounts of information.\n@@ -4645,1 +5002,1 @@\n-.SS -Xlog Usage Examples\n+.SS \\-Xlog Usage Examples\n@@ -4647,1 +5004,1 @@\n-The following are \\f[V]-Xlog\\f[R] examples.\n+The following are \\f[CB]\\-Xlog\\f[R] examples.\n@@ -4649,3 +5006,3 @@\n-\\f[V]-Xlog\\f[R]\n-Logs all messages by using the \\f[V]info\\f[R] level to \\f[V]stdout\\f[R]\n-with \\f[V]uptime\\f[R], \\f[V]levels\\f[R], and \\f[V]tags\\f[R] decorations.\n+.B \\f[CB]\\-Xlog\\f[R]\n+Logs all messages by using the \\f[CB]info\\f[R] level to \\f[CB]stdout\\f[R]\n+with \\f[CB]uptime\\f[R], \\f[CB]levels\\f[R], and \\f[CB]tags\\f[R] decorations.\n@@ -4656,1 +5013,1 @@\n-\\f[V]-Xlog:all=info:stdout:uptime,levels,tags\\f[R]\n+\\f[CB]\\-Xlog:all=info:stdout:uptime,levels,tags\\f[R]\n@@ -4660,3 +5017,3 @@\n-\\f[V]-Xlog:gc\\f[R]\n-Logs messages tagged with the \\f[V]gc\\f[R] tag using \\f[V]info\\f[R]\n-level to \\f[V]stdout\\f[R].\n+.B \\f[CB]\\-Xlog:gc\\f[R]\n+Logs messages tagged with the \\f[CB]gc\\f[R] tag using \\f[CB]info\\f[R] level\n+to \\f[CB]stdout\\f[R].\n@@ -4664,1 +5021,3 @@\n-\\f[V]warning\\f[R] is in effect.\n+\\f[CB]warning\\f[R] is in effect.\n+.RS\n+.RE\n@@ -4666,3 +5025,3 @@\n-\\f[V]-Xlog:gc,safepoint\\f[R]\n-Logs messages tagged either with the \\f[V]gc\\f[R] or \\f[V]safepoint\\f[R]\n-tags, both using the \\f[V]info\\f[R] level, to \\f[V]stdout\\f[R], with\n+.B \\f[CB]\\-Xlog:gc,safepoint\\f[R]\n+Logs messages tagged either with the \\f[CB]gc\\f[R] or \\f[CB]safepoint\\f[R]\n+tags, both using the \\f[CB]info\\f[R] level, to \\f[CB]stdout\\f[R], with\n@@ -4670,1 +5029,1 @@\n-Messages tagged with both \\f[V]gc\\f[R] and \\f[V]safepoint\\f[R] won\\[aq]t\n+Messages tagged with both \\f[CB]gc\\f[R] and \\f[CB]safepoint\\f[R] won\\[aq]t\n@@ -4672,0 +5031,2 @@\n+.RS\n+.RE\n@@ -4673,4 +5034,3 @@\n-\\f[V]-Xlog:gc+ref=debug\\f[R]\n-Logs messages tagged with both \\f[V]gc\\f[R] and \\f[V]ref\\f[R] tags,\n-using the \\f[V]debug\\f[R] level to \\f[V]stdout\\f[R], with default\n-decorations.\n+.B \\f[CB]\\-Xlog:gc+ref=debug\\f[R]\n+Logs messages tagged with both \\f[CB]gc\\f[R] and \\f[CB]ref\\f[R] tags, using\n+the \\f[CB]debug\\f[R] level to \\f[CB]stdout\\f[R], with default decorations.\n@@ -4678,0 +5038,2 @@\n+.RS\n+.RE\n@@ -4679,3 +5041,3 @@\n-\\f[V]-Xlog:gc=debug:file=gc.txt:none\\f[R]\n-Logs messages tagged with the \\f[V]gc\\f[R] tag using the \\f[V]debug\\f[R]\n-level to a file called \\f[V]gc.txt\\f[R] with no decorations.\n+.B \\f[CB]\\-Xlog:gc=debug:file=gc.txt:none\\f[R]\n+Logs messages tagged with the \\f[CB]gc\\f[R] tag using the \\f[CB]debug\\f[R]\n+level to a file called \\f[CB]gc.txt\\f[R] with no decorations.\n@@ -4683,1 +5045,3 @@\n-\\f[V]warning\\f[R] is still in effect.\n+\\f[CB]warning\\f[R] is still in effect.\n+.RS\n+.RE\n@@ -4685,2 +5049,2 @@\n-\\f[V]-Xlog:gc=trace:file=gctrace.txt:uptimemillis,pids:filecount=5,filesize=1024\\f[R]\n-Logs messages tagged with the \\f[V]gc\\f[R] tag using the \\f[V]trace\\f[R]\n+.B \\f[CB]\\-Xlog:gc=trace:file=gctrace.txt:uptimemillis,pids:filecount=5,filesize=1024\\f[R]\n+Logs messages tagged with the \\f[CB]gc\\f[R] tag using the \\f[CB]trace\\f[R]\n@@ -4688,2 +5052,2 @@\n-name \\f[V]gctrace.txt\\f[R] and uses decorations \\f[V]uptimemillis\\f[R]\n-and \\f[V]pid\\f[R].\n+name \\f[CB]gctrace.txt\\f[R] and uses decorations \\f[CB]uptimemillis\\f[R] and\n+\\f[CB]pid\\f[R].\n@@ -4693,1 +5057,1 @@\n-\\f[V]warning\\f[R] is still in effect.\n+\\f[CB]warning\\f[R] is still in effect.\n@@ -4696,4 +5060,4 @@\n-\\f[V]-Xlog:gc::uptime,tid\\f[R]\n-Logs messages tagged with the \\f[V]gc\\f[R] tag using the default\n-\\[aq]info\\[aq] level to default the output \\f[V]stdout\\f[R] and uses\n-decorations \\f[V]uptime\\f[R] and \\f[V]tid\\f[R].\n+.B \\f[CB]\\-Xlog:gc::uptime,tid\\f[R]\n+Logs messages tagged with the \\f[CB]gc\\f[R] tag using the default\n+\\[aq]info\\[aq] level to default the output \\f[CB]stdout\\f[R] and uses\n+decorations \\f[CB]uptime\\f[R] and \\f[CB]tid\\f[R].\n@@ -4701,1 +5065,3 @@\n-\\f[V]warning\\f[R] is still in effect.\n+\\f[CB]warning\\f[R] is still in effect.\n+.RS\n+.RE\n@@ -4703,5 +5069,4 @@\n-\\f[V]-Xlog:gc*=info,safepoint*=off\\f[R]\n-Logs messages tagged with at least \\f[V]gc\\f[R] using the \\f[V]info\\f[R]\n-level, but turns off logging of messages tagged with\n-\\f[V]safepoint\\f[R].\n-Messages tagged with both \\f[V]gc\\f[R] and \\f[V]safepoint\\f[R] won\\[aq]t\n+.B \\f[CB]\\-Xlog:gc*=info,safepoint*=off\\f[R]\n+Logs messages tagged with at least \\f[CB]gc\\f[R] using the \\f[CB]info\\f[R]\n+level, but turns off logging of messages tagged with \\f[CB]safepoint\\f[R].\n+Messages tagged with both \\f[CB]gc\\f[R] and \\f[CB]safepoint\\f[R] won\\[aq]t\n@@ -4709,0 +5074,2 @@\n+.RS\n+.RE\n@@ -4710,1 +5077,1 @@\n-\\f[V]-Xlog:disable -Xlog:safepoint=trace:safepointtrace.txt\\f[R]\n+.B \\f[CB]\\-Xlog:disable\\ \\-Xlog:safepoint=trace:safepointtrace.txt\\f[R]\n@@ -4712,2 +5079,2 @@\n-messages tagged with \\f[V]safepoint\\f[R]using \\f[V]trace\\f[R]level to\n-the file \\f[V]safepointtrace.txt\\f[R].\n+messages tagged with \\f[CB]safepoint\\f[R]using \\f[CB]trace\\f[R]level to the\n+file \\f[CB]safepointtrace.txt\\f[R].\n@@ -4715,2 +5082,4 @@\n-started with \\f[V]-Xlog:disable\\f[R].\n-.SS Complex -Xlog Usage Examples\n+started with \\f[CB]\\-Xlog:disable\\f[R].\n+.RS\n+.RE\n+.SS Complex \\-Xlog Usage Examples\n@@ -4719,1 +5088,1 @@\n-\\f[V]-Xlog\\f[R] option.\n+\\f[CB]\\-Xlog\\f[R] option.\n@@ -4721,3 +5090,3 @@\n-\\f[V]-Xlog:gc+class*=debug\\f[R]\n-Logs messages tagged with at least \\f[V]gc\\f[R] and \\f[V]class\\f[R] tags\n-using the \\f[V]debug\\f[R] level to \\f[V]stdout\\f[R].\n+.B \\f[CB]\\-Xlog:gc+class*=debug\\f[R]\n+Logs messages tagged with at least \\f[CB]gc\\f[R] and \\f[CB]class\\f[R] tags\n+using the \\f[CB]debug\\f[R] level to \\f[CB]stdout\\f[R].\n@@ -4725,8 +5094,10 @@\n-\\f[V]warning\\f[R] is still in effect\n-.TP\n-\\f[V]-Xlog:gc+meta*=trace,class*=off:file=gcmetatrace.txt\\f[R]\n-Logs messages tagged with at least the \\f[V]gc\\f[R] and \\f[V]meta\\f[R]\n-tags using the \\f[V]trace\\f[R] level to the file \\f[V]metatrace.txt\\f[R]\n-but turns off all messages tagged with \\f[V]class\\f[R].\n-Messages tagged with \\f[V]gc\\f[R], \\f[V]meta\\f[R], and \\f[V]class\\f[R]\n-aren\\[aq]t be logged as \\f[V]class*\\f[R] is set to off.\n+\\f[CB]warning\\f[R] is still in effect\n+.RS\n+.RE\n+.TP\n+.B \\f[CB]\\-Xlog:gc+meta*=trace,class*=off:file=gcmetatrace.txt\\f[R]\n+Logs messages tagged with at least the \\f[CB]gc\\f[R] and \\f[CB]meta\\f[R]\n+tags using the \\f[CB]trace\\f[R] level to the file \\f[CB]metatrace.txt\\f[R]\n+but turns off all messages tagged with \\f[CB]class\\f[R].\n+Messages tagged with \\f[CB]gc\\f[R], \\f[CB]meta\\f[R], and \\f[CB]class\\f[R]\n+aren\\[aq]t be logged as \\f[CB]class*\\f[R] is set to off.\n@@ -4734,2 +5105,4 @@\n-\\f[V]warning\\f[R] is in effect except for those that include\n-\\f[V]class\\f[R].\n+\\f[CB]warning\\f[R] is in effect except for those that include\n+\\f[CB]class\\f[R].\n+.RS\n+.RE\n@@ -4737,3 +5110,3 @@\n-\\f[V]-Xlog:gc+meta=trace\\f[R]\n-Logs messages tagged with exactly the \\f[V]gc\\f[R] and \\f[V]meta\\f[R]\n-tags using the \\f[V]trace\\f[R] level to \\f[V]stdout\\f[R].\n+.B \\f[CB]\\-Xlog:gc+meta=trace\\f[R]\n+Logs messages tagged with exactly the \\f[CB]gc\\f[R] and \\f[CB]meta\\f[R] tags\n+using the \\f[CB]trace\\f[R] level to \\f[CB]stdout\\f[R].\n@@ -4741,1 +5114,3 @@\n-\\f[V]warning\\f[R] is still be in effect.\n+\\f[CB]warning\\f[R] is still be in effect.\n+.RS\n+.RE\n@@ -4743,4 +5118,4 @@\n-\\f[V]-Xlog:gc+class+heap*=debug,meta*=warning,threads*=off\\f[R]\n-Logs messages tagged with at least \\f[V]gc\\f[R], \\f[V]class\\f[R], and\n-\\f[V]heap\\f[R] tags using the \\f[V]trace\\f[R] level to \\f[V]stdout\\f[R]\n-but only log messages tagged with \\f[V]meta\\f[R] with level.\n+.B \\f[CB]\\-Xlog:gc+class+heap*=debug,meta*=warning,threads*=off\\f[R]\n+Logs messages tagged with at least \\f[CB]gc\\f[R], \\f[CB]class\\f[R], and\n+\\f[CB]heap\\f[R] tags using the \\f[CB]trace\\f[R] level to \\f[CB]stdout\\f[R] but\n+only log messages tagged with \\f[CB]meta\\f[R] with level.\n@@ -4748,2 +5123,4 @@\n-\\f[V]warning\\f[R] is in effect except for those that include\n-\\f[V]threads\\f[R].\n+\\f[CB]warning\\f[R] is in effect except for those that include\n+\\f[CB]threads\\f[R].\n+.RS\n+.RE\n@@ -4752,3 +5129,3 @@\n-You use values provided to all Java Virtual Machine (JVM) command-line\n-flags for validation and, if the input value is invalid or out-of-range,\n-then an appropriate error message is displayed.\n+You use values provided to all Java Virtual Machine (JVM) command\\-line\n+flags for validation and, if the input value is invalid or\n+out\\-of\\-range, then an appropriate error message is displayed.\n@@ -4758,2 +5135,2 @@\n-\\f[V]java.lang.management\\f[R]) the values provided to all Java Virtual\n-Machine (JVM) command-line flags are validated.\n+\\f[CB]java.lang.management\\f[R]) the values provided to all Java Virtual\n+Machine (JVM) command\\-line flags are validated.\n@@ -4765,1 +5142,1 @@\n-during runtime (for example using the \\f[V]jcmd\\f[R] tool).\n+during runtime (for example using the \\f[CB]jcmd\\f[R] tool).\n@@ -4774,5 +5151,5 @@\n-java -XX:AllocatePrefetchStyle=5 -version\n-intx AllocatePrefetchStyle=5 is outside the allowed range [ 0 ... 3 ]\n-Improperly specified VM option \\[aq]AllocatePrefetchStyle=5\\[aq]\n-Error: Could not create the Java Virtual Machine.\n-Error: A fatal exception has occurred. Program will exit.\n+java\\ \\-XX:AllocatePrefetchStyle=5\\ \\-version\n+intx\\ AllocatePrefetchStyle=5\\ is\\ outside\\ the\\ allowed\\ range\\ [\\ 0\\ ...\\ 3\\ ]\n+Improperly\\ specified\\ VM\\ option\\ \\[aq]AllocatePrefetchStyle=5\\[aq]\n+Error:\\ Could\\ not\\ create\\ the\\ Java\\ Virtual\\ Machine.\n+Error:\\ A\\ fatal\\ exception\\ has\\ occurred.\\ Program\\ will\\ exit.\n@@ -4782,1 +5159,1 @@\n-The flag \\f[V]-XX:+PrintFlagsRanges\\f[R] prints the range of all the\n+The flag \\f[CB]\\-XX:+PrintFlagsRanges\\f[R] prints the range of all the\n@@ -4793,1 +5170,1 @@\n-intx   ThreadStackSize [ 0 ... 9007199254740987 ] {pd product}\n+intx\\ \\ \\ ThreadStackSize\\ [\\ 0\\ ...\\ 9007199254740987\\ ]\\ {pd\\ product}\n@@ -4803,1 +5180,1 @@\n-size_t NewSize         [   ...                  ] {product}\n+size_t\\ NewSize\\ \\ \\ \\ \\ \\ \\ \\ \\ [\\ \\ \\ ...\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ ]\\ {product}\n@@ -4815,1 +5192,1 @@\n-Large pages optimize processor Translation-Lookaside Buffers.\n+Large pages optimize processor Translation\\-Lookaside Buffers.\n@@ -4817,2 +5194,3 @@\n-A Translation-Lookaside Buffer (TLB) is a page translation cache that\n-holds the most-recently used virtual-to-physical address translations.\n+A Translation\\-Lookaside Buffer (TLB) is a page translation cache that\n+holds the most\\-recently used virtual\\-to\\-physical address\n+translations.\n@@ -4824,1 +5202,1 @@\n-This results in less pressure on a TLB, and memory-intensive\n+This results in less pressure on a TLB, and memory\\-intensive\n@@ -4844,3 +5222,3 @@\n-# cat \/proc\/meminfo | grep Huge\n-HugePages_Total: 0\n-HugePages_Free: 0\n+#\\ cat\\ \/proc\/meminfo\\ |\\ grep\\ Huge\n+HugePages_Total:\\ 0\n+HugePages_Free:\\ 0\n@@ -4848,1 +5226,1 @@\n-Hugepagesize: 2048 kB\n+Hugepagesize:\\ 2048\\ kB\n@@ -4852,2 +5230,2 @@\n-If the output contains items prefixed with \\[dq]Huge\\[dq], then your\n-system supports large pages.\n+If the output contains items prefixed with \"Huge\", then your system\n+supports large pages.\n@@ -4855,1 +5233,1 @@\n-The \\f[V]Hugepagesize\\f[R] field shows the default large page size in\n+The \\f[CB]Hugepagesize\\f[R] field shows the default large page size in\n@@ -4863,2 +5241,2 @@\n-# ls \/sys\/kernel\/mm\/hugepages\/\n-hugepages-1048576kB  hugepages-2048kB\n+#\\ ls\\ \/sys\/kernel\/mm\/hugepages\/\n+hugepages\\-1048576kB\\ \\ hugepages\\-2048kB\n@@ -4871,2 +5249,2 @@\n-\\f[V]-XX:+UseTransparentHugePages\\f[R]), the number of large pages must\n-be pre-allocated.\n+\\f[CB]\\-XX:+UseTransparentHugePages\\f[R]), the number of large pages must\n+be pre\\-allocated.\n@@ -4874,1 +5252,1 @@\n-login as \\f[V]root\\f[R] and run:\n+login as \\f[CB]root\\f[R] and run:\n@@ -4877,1 +5255,1 @@\n-\\f[V]# echo 4096 > \/sys\/kernel\/mm\/hugepages\/hugepages-2048kB\/nr_hugepages\\f[R]\n+\\f[CB]#\\ echo\\ 4096\\ >\\ \/sys\/kernel\/mm\/hugepages\/hugepages\\-2048kB\/nr_hugepages\\f[R]\n@@ -4880,1 +5258,1 @@\n-It is always recommended to check the value of \\f[V]nr_hugepages\\f[R]\n+It is always recommended to check the value of \\f[CB]nr_hugepages\\f[R]\n@@ -4884,2 +5262,2 @@\n-When using the option \\f[V]-XX:+UseSHM\\f[R] to enable large pages you\n-also need to make sure the \\f[V]SHMMAX\\f[R] parameter is configured to\n+When using the option \\f[CB]\\-XX:+UseSHM\\f[R] to enable large pages you\n+also need to make sure the \\f[CB]SHMMAX\\f[R] parameter is configured to\n@@ -4887,1 +5265,1 @@\n-To allow a maximum shared segment of 8 GB, login as \\f[V]root\\f[R] and\n+To allow a maximum shared segment of 8 GB, login as \\f[CB]root\\f[R] and\n@@ -4891,1 +5269,1 @@\n-\\f[V]# echo 8589934592 > \/proc\/sys\/kernel\/shmmax\\f[R]\n+\\f[CB]#\\ echo\\ 8589934592\\ >\\ \/proc\/sys\/kernel\/shmmax\\f[R]\n@@ -4899,4 +5277,4 @@\n-\\f[B]Note:\\f[R] The values contained in \\f[V]\/proc\\f[R] and\n-\\f[V]\/sys\\f[R] reset after you reboot your system, so may want to set\n-them in an initialization script (for example, \\f[V]rc.local\\f[R] or\n-\\f[V]sysctl.conf\\f[R]).\n+\\f[B]Note:\\f[R] The values contained in \\f[CB]\/proc\\f[R] and \\f[CB]\/sys\\f[R]\n+reset after you reboot your system, so may want to set them in an\n+initialization script (for example, \\f[CB]rc.local\\f[R] or\n+\\f[CB]sysctl.conf\\f[R]).\n@@ -4913,1 +5291,1 @@\n-Consequently, if you configure the \\f[V]nr_hugepages\\f[R] parameter to\n+Consequently, if you configure the \\f[CB]nr_hugepages\\f[R] parameter to\n@@ -4925,2 +5303,1 @@\n-Select \\f[B]Local Policies\\f[R] and then \\f[B]User Rights\n-Assignment\\f[R].\n+Select \\f[B]Local Policies\\f[R] and then \\f[B]User Rights Assignment\\f[R].\n@@ -4928,1 +5305,1 @@\n-Double-click \\f[B]Lock pages in memory\\f[R], then add users and\/or\n+Double\\-click \\f[B]Lock pages in memory\\f[R], then add users and\/or\n@@ -4942,1 +5319,1 @@\n-the start-up time of your applications.\n+the start\\-up time of your applications.\n@@ -4956,1 +5333,1 @@\n-By default, in most JDK distributions, unless \\f[V]-Xshare:off\\f[R] is\n+By default, in most JDK distributions, unless \\f[CB]\\-Xshare:off\\f[R] is\n@@ -4958,2 +5335,2 @@\n-usually located in \\f[V]JAVA_HOME\/lib\/server\/classes.jsa\\f[R] (or\n-\\f[V]JAVA_HOME\\[rs]bin\\[rs]server\\[rs]classes.jsa\\f[R] on Windows).\n+usually located in \\f[CB]JAVA_HOME\/lib\/server\/classes.jsa\\f[R] (or\n+\\f[CB]JAVA_HOME\\\\bin\\\\server\\\\classes.jsa\\f[R] on Windows).\n@@ -4964,1 +5341,1 @@\n-can use the \\f[V]-XX:SharedArchiveFile\\f[R] option, which has the\n+can use the \\f[CB]\\-XX:SharedArchiveFile\\f[R] option, which has the\n@@ -4968,1 +5345,1 @@\n-\\f[V]-XX:SharedArchiveFile=<static_archive>:<dynamic_archive>\\f[R]\n+\\f[CB]\\-XX:SharedArchiveFile=<static_archive>:<dynamic_archive>\\f[R]\n@@ -4971,1 +5348,1 @@\n-The \\f[V]<static_archive>\\f[R] overrides the default CDS archive.\n+The \\f[CB]<static_archive>\\f[R] overrides the default CDS archive.\n@@ -4973,2 +5350,2 @@\n-The \\f[V]<dynamic_archive>\\f[R] provides additional classes that can be\n-loaded on top of those in the \\f[V]<static_archive>\\f[R].\n+The \\f[CB]<dynamic_archive>\\f[R] provides additional classes that can be\n+loaded on top of those in the \\f[CB]<static_archive>\\f[R].\n@@ -4976,2 +5353,2 @@\n-On Windows, the above path delimiter \\f[V]:\\f[R] should be replaced with\n-\\f[V];\\f[R]\n+On Windows, the above path delimiter \\f[CB]:\\f[R] should be replaced with\n+\\f[CB];\\f[R]\n@@ -4979,4 +5356,3 @@\n-(The names \\[dq]static\\[dq] and \\[dq]dynamic\\[dq] are used for\n-historical reasons.\n-The only significance is that the \\[dq]static\\[dq] archive is loaded\n-first and the \\[dq]dynamic\\[dq] archive is loaded second).\n+(The names \"static\" and \"dynamic\" are used for historical reasons.\n+The only significance is that the \"static\" archive is loaded first and\n+the \"dynamic\" archive is loaded second).\n@@ -4985,2 +5361,2 @@\n-To use only a single \\f[V]<static_archive>\\f[R], you can omit the\n-\\f[V]<dynamic_archive>\\f[R] portion:\n+To use only a single \\f[CB]<static_archive>\\f[R], you can omit the\n+\\f[CB]<dynamic_archive>\\f[R] portion:\n@@ -4989,1 +5365,1 @@\n-\\f[V]-XX:SharedArchiveFile=<static_archive>\\f[R]\n+\\f[CB]\\-XX:SharedArchiveFile=<static_archive>\\f[R]\n@@ -4992,3 +5368,3 @@\n-For convenience, the \\f[V]<dynamic_archive>\\f[R] records the location of\n-the \\f[V]<static_archive>\\f[R].\n-Therefore, you can omit the \\f[V]<static_archive>\\f[R] by saying only:\n+For convenience, the \\f[CB]<dynamic_archive>\\f[R] records the location of\n+the \\f[CB]<static_archive>\\f[R].\n+Therefore, you can omit the \\f[CB]<static_archive>\\f[R] by saying only:\n@@ -4997,1 +5373,1 @@\n-\\f[V]-XX:SharedArchiveFile=<dynamic_archive>\\f[R]\n+\\f[CB]\\-XX:SharedArchiveFile=<dynamic_archive>\\f[R]\n@@ -5003,1 +5379,1 @@\n-\\f[V]-Xshare:dump\\f[R]\n+\\f[CB]\\-Xshare:dump\\f[R]\n@@ -5005,1 +5381,1 @@\n-\\f[V]-XX:ArchiveClassesAtExit\\f[R]\n+\\f[CB]\\-XX:ArchiveClassesAtExit\\f[R]\n@@ -5007,1 +5383,1 @@\n-\\f[V]jcmd VM.cds\\f[R]\n+\\f[CB]jcmd\\ VM.cds\\f[R]\n@@ -5009,4 +5385,4 @@\n-One common operation in all these methods is a \\[dq]trial run\\[dq],\n-where you run the application once to determine the classes that should\n-be stored in the archive.\n-.SS Creating a Static CDS Archive File with -Xshare:dump\n+One common operation in all these methods is a \"trial run\", where you\n+run the application once to determine the classes that should be stored\n+in the archive.\n+.SS Creating a Static CDS Archive File with \\-Xshare:dump\n@@ -5015,1 +5391,1 @@\n-the classes used by the \\f[V]test.Hello\\f[R] application.\n+the classes used by the \\f[CB]test.Hello\\f[R] application.\n@@ -5017,1 +5393,1 @@\n-Create a list of all classes used by the \\f[V]test.Hello\\f[R]\n+Create a list of all classes used by the \\f[CB]test.Hello\\f[R]\n@@ -5019,2 +5395,2 @@\n-The following command creates a file named \\f[V]hello.classlist\\f[R]\n-that contains a list of all classes used by this application:\n+The following command creates a file named \\f[CB]hello.classlist\\f[R] that\n+contains a list of all classes used by this application:\n@@ -5024,1 +5400,1 @@\n-\\f[V]java -Xshare:off -XX:DumpLoadedClassList=hello.classlist -cp hello.jar test.Hello\\f[R]\n+\\f[CB]java\\ \\-Xshare:off\\ \\-XX:DumpLoadedClassList=hello.classlist\\ \\-cp\\ hello.jar\\ test.Hello\\f[R]\n@@ -5027,1 +5403,1 @@\n-The classpath specified by the \\f[V]-cp\\f[R] parameter must contain only\n+The classpath specified by the \\f[CB]\\-cp\\f[R] parameter must contain only\n@@ -5031,2 +5407,2 @@\n-Create a static archive, named \\f[V]hello.jsa\\f[R], that contains all\n-the classes in \\f[V]hello.classlist\\f[R]:\n+Create a static archive, named \\f[CB]hello.jsa\\f[R], that contains all the\n+classes in \\f[CB]hello.classlist\\f[R]:\n@@ -5036,1 +5412,1 @@\n-\\f[V]java -Xshare:dump -XX:SharedArchiveFile=hello.jsa -XX:SharedClassListFile=hello.classlist -cp hello.jar\\f[R]\n+\\f[CB]java\\ \\-Xshare:dump\\ \\-XX:SharedArchiveFile=hello.jsa\\ \\-XX:SharedClassListFile=hello.classlist\\ \\-cp\\ hello.jar\\f[R]\n@@ -5040,2 +5416,2 @@\n-Run the application \\f[V]test.Hello\\f[R] with the archive\n-\\f[V]hello.jsa\\f[R]:\n+Run the application \\f[CB]test.Hello\\f[R] with the archive\n+\\f[CB]hello.jsa\\f[R]:\n@@ -5045,1 +5421,1 @@\n-\\f[V]java -XX:SharedArchiveFile=hello.jsa -cp hello.jar test.Hello\\f[R]\n+\\f[CB]java\\ \\-XX:SharedArchiveFile=hello.jsa\\ \\-cp\\ hello.jar\\ test.Hello\\f[R]\n@@ -5049,2 +5425,2 @@\n-\\f[B]Optional\\f[R] Verify that the \\f[V]test.Hello\\f[R] application is\n-using the class contained in the \\f[V]hello.jsa\\f[R] shared archive:\n+\\f[B]Optional\\f[R] Verify that the \\f[CB]test.Hello\\f[R] application is\n+using the class contained in the \\f[CB]hello.jsa\\f[R] shared archive:\n@@ -5054,1 +5430,1 @@\n-\\f[V]java -XX:SharedArchiveFile=hello.jsa -cp hello.jar -Xlog:class+load test.Hello\\f[R]\n+\\f[CB]java\\ \\-XX:SharedArchiveFile=hello.jsa\\ \\-cp\\ hello.jar\\ \\-Xlog:class+load\\ test.Hello\\f[R]\n@@ -5060,1 +5436,1 @@\n-\\f[V][info][class,load] test.Hello source: shared objects file\\f[R]\n+\\f[CB][info][class,load]\\ test.Hello\\ source:\\ shared\\ objects\\ file\\f[R]\n@@ -5063,1 +5439,1 @@\n-.SS Creating a Dynamic CDS Archive File with -XX:ArchiveClassesAtExit\n+.SS Creating a Dynamic CDS Archive File with \\-XX:ArchiveClassesAtExit\n@@ -5073,1 +5449,1 @@\n-classes that are used by the \\f[V]test.Hello\\f[R] application, excluding\n+classes that are used by the \\f[CB]test.Hello\\f[R] application, excluding\n@@ -5076,3 +5452,3 @@\n-Create a dynamic CDS archive, named \\f[V]hello.jsa\\f[R], that contains\n-all the classes in \\f[V]hello.jar\\f[R] loaded by the application\n-\\f[V]test.Hello\\f[R]:\n+Create a dynamic CDS archive, named \\f[CB]hello.jsa\\f[R], that contains\n+all the classes in \\f[CB]hello.jar\\f[R] loaded by the application\n+\\f[CB]test.Hello\\f[R]:\n@@ -5082,1 +5458,1 @@\n-\\f[V]java -XX:ArchiveClassesAtExit=hello.jsa -cp hello.jar Hello\\f[R]\n+\\f[CB]java\\ \\-XX:ArchiveClassesAtExit=hello.jsa\\ \\-cp\\ hello.jar\\ Hello\\f[R]\n@@ -5086,2 +5462,2 @@\n-Run the application \\f[V]test.Hello\\f[R] with the shared archive\n-\\f[V]hello.jsa\\f[R]:\n+Run the application \\f[CB]test.Hello\\f[R] with the shared archive\n+\\f[CB]hello.jsa\\f[R]:\n@@ -5091,1 +5467,1 @@\n-\\f[V]java -XX:SharedArchiveFile=hello.jsa -cp hello.jar test.Hello\\f[R]\n+\\f[CB]java\\ \\-XX:SharedArchiveFile=hello.jsa\\ \\-cp\\ hello.jar\\ test.Hello\\f[R]\n@@ -5096,2 +5472,2 @@\n-the \\f[V]test.Hello\\f[R] application is using the class contained in the\n-\\f[V]hello.jsa\\f[R] shared archive.\n+the \\f[CB]test.Hello\\f[R] application is using the class contained in the\n+\\f[CB]hello.jsa\\f[R] shared archive.\n@@ -5100,1 +5476,1 @@\n-non-default static CDS archive.\n+non\\-default static CDS archive.\n@@ -5104,1 +5480,1 @@\n-\\f[V]java -XX:SharedArchiveFile=base.jsa -XX:ArchiveClassesAtExit=hello.jsa -cp hello.jar Hello\\f[R]\n+\\f[CB]java\\ \\-XX:SharedArchiveFile=base.jsa\\ \\-XX:ArchiveClassesAtExit=hello.jsa\\ \\-cp\\ hello.jar\\ Hello\\f[R]\n@@ -5110,1 +5486,1 @@\n-\\f[V]java -XX:SharedArchiveFile=base.jsa:hello.jsa -cp hello.jar Hello\\f[R]\n+\\f[CB]java\\ \\-XX:SharedArchiveFile=base.jsa:hello.jsa\\ \\-cp\\ hello.jar\\ Hello\\f[R]\n@@ -5113,2 +5489,2 @@\n-(On Windows, the above path delimiter \\f[V]:\\f[R] should be replaced\n-with \\f[V];\\f[R])\n+(On Windows, the above path delimiter \\f[CB]:\\f[R] should be replaced with\n+\\f[CB];\\f[R])\n@@ -5119,1 +5495,1 @@\n-\\f[V]java -XX:SharedArchiveFile=hello.jsa -cp hello.jar Hello\\f[R]\n+\\f[CB]java\\ \\-XX:SharedArchiveFile=hello.jsa\\ \\-cp\\ hello.jar\\ Hello\\f[R]\n@@ -5124,1 +5500,1 @@\n-start-up script in order to create a CDS archive.\n+start\\-up script in order to create a CDS archive.\n@@ -5128,1 +5504,1 @@\n-The \\f[V]jcmd VM.cds\\f[R] command provides a less intrusive way for\n+The \\f[CB]jcmd\\ VM.cds\\f[R] command provides a less intrusive way for\n@@ -5133,1 +5509,1 @@\n-\\f[V]jcmd <pid> VM.cds static_dump my_static_archive.jsa\\f[R]\n+\\f[CB]jcmd\\ <pid>\\ VM.cds\\ static_dump\\ my_static_archive.jsa\\f[R]\n@@ -5139,1 +5515,1 @@\n-\\f[V]jcmd <pid> VM.cds dynamic_dump my_dynamic_archive.jsa\\f[R]\n+\\f[CB]jcmd\\ <pid>\\ VM.cds\\ dynamic_dump\\ my_dynamic_archive.jsa\\f[R]\n@@ -5143,2 +5519,2 @@\n-without modifying the application\\[aq]s start-up script, you can use the\n-following technique:\n+without modifying the application\\[aq]s start\\-up script, you can use\n+the following technique:\n@@ -5147,1 +5523,1 @@\n-\\f[V]env JAVA_TOOL_OPTIONS=-XX:SharedArchiveFile=my_static_archive.jsa bash app_start.sh\\f[R]\n+\\f[CB]env\\ JAVA_TOOL_OPTIONS=\\-XX:SharedArchiveFile=my_static_archive.jsa\\ bash\\ app_start.sh\\f[R]\n@@ -5150,4 +5526,4 @@\n-Note: to use \\f[V]jcmd <pid> VM.cds dynamic_dump\\f[R], the JVM process\n-identified by \\f[V]<pid>\\f[R] must be started with\n-\\f[V]-XX:+RecordDynamicDumpInfo\\f[R], which can also be passed to the\n-application start-up script with the same technique:\n+Note: to use \\f[CB]jcmd\\ <pid>\\ VM.cds\\ dynamic_dump\\f[R], the JVM process\n+identified by \\f[CB]<pid>\\f[R] must be started with\n+\\f[CB]\\-XX:+RecordDynamicDumpInfo\\f[R], which can also be passed to the\n+application start\\-up script with the same technique:\n@@ -5156,1 +5532,1 @@\n-\\f[V]env JAVA_TOOL_OPTIONS=-XX:+RecordDynamicDumpInfo bash app_start.sh\\f[R]\n+\\f[CB]env\\ JAVA_TOOL_OPTIONS=\\-XX:+RecordDynamicDumpInfo\\ bash\\ app_start.sh\\f[R]\n@@ -5158,1 +5534,1 @@\n-.SS Creating Dynamic CDS Archive File with -XX:+AutoCreateSharedArchive\n+.SS Creating Dynamic CDS Archive File with \\-XX:+AutoCreateSharedArchive\n@@ -5160,1 +5536,1 @@\n-\\f[V]-XX:+AutoCreateSharedArchive\\f[R] is a more convenient way of\n+\\f[CB]\\-XX:+AutoCreateSharedArchive\\f[R] is a more convenient way of\n@@ -5163,1 +5539,1 @@\n-previous section, with \\f[V]-XX:+AutoCreateSharedArchive\\f[R], it\\[aq]s\n+previous section, with \\f[CB]\\-XX:+AutoCreateSharedArchive\\f[R], it\\[aq]s\n@@ -5165,1 +5541,1 @@\n-Instead, you can always run the application with the same command-line\n+Instead, you can always run the application with the same command\\-line\n@@ -5169,1 +5545,1 @@\n-\\f[V]java -XX:+AutoCreateSharedArchive -XX:SharedArchiveFile=hello.jsa -cp hello.jar Hello\\f[R]\n+\\f[CB]java\\ \\-XX:+AutoCreateSharedArchive\\ \\-XX:SharedArchiveFile=hello.jsa\\ \\-cp\\ hello.jar\\ Hello\\f[R]\n@@ -5190,1 +5566,1 @@\n-\\f[V]-XX:+AutoCreateSharedArchive\\f[R] will automatically recreate the\n+\\f[CB]\\-XX:+AutoCreateSharedArchive\\f[R] will automatically recreate the\n@@ -5196,3 +5572,3 @@\n-Neither the class path (\\f[V]-classpath\\f[R] and\n-\\f[V]-Xbootclasspath\/a\\f[R]) nor the module path\n-(\\f[V]--module-path\\f[R]) can contain non-empty directories.\n+Neither the class path (\\f[CB]\\-classpath\\f[R] and\n+\\f[CB]\\-Xbootclasspath\/a\\f[R]) nor the module path\n+(\\f[CB]\\-\\-module\\-path\\f[R]) can contain non\\-empty directories.\n@@ -5200,1 +5576,1 @@\n-Only modular JAR files are supported in \\f[V]--module-path\\f[R].\n+Only modular JAR files are supported in \\f[CB]\\-\\-module\\-path\\f[R].\n@@ -5210,3 +5586,3 @@\n-If any of the VM options \\f[V]--upgrade-module-path\\f[R],\n-\\f[V]--patch-module\\f[R] or \\f[V]--limit-modules\\f[R] are specified, CDS\n-is disabled.\n+If any of the VM options \\f[CB]\\-\\-upgrade\\-module\\-path\\f[R],\n+\\f[CB]\\-\\-patch\\-module\\f[R] or \\f[CB]\\-\\-limit\\-modules\\f[R] are specified,\n+CDS is disabled.\n@@ -5226,1 +5602,1 @@\n-\\f[V]java -server -XX:+UseParallelGC -XX:+UseLargePages -Xmn10g  -Xms26g -Xmx26g\\f[R]\n+\\f[CB]java\\ \\-server\\ \\-XX:+UseParallelGC\\ \\-XX:+UseLargePages\\ \\-Xmn10g\\ \\ \\-Xms26g\\ \\-Xmx26g\\f[R]\n@@ -5234,1 +5610,1 @@\n-\\f[V]java -XX:+UseG1GC -XX:MaxGCPauseMillis=100\\f[R]\n+\\f[CB]java\\ \\-XX:+UseG1GC\\ \\-XX:MaxGCPauseMillis=100\\f[R]\n@@ -5236,1 +5612,2 @@\n-.SS Keeping the Java Heap Small and Reducing the Dynamic Footprint of Embedded Applications\n+.SS Keeping the Java Heap Small and Reducing the Dynamic Footprint of\n+Embedded Applications\n@@ -5242,1 +5619,1 @@\n-\\f[V]-XX:MaxHeapFreeRatio=10 -XX:MinHeapFreeRatio=5\\f[R]\n+\\f[CB]\\-XX:MaxHeapFreeRatio=10\\ \\-XX:MinHeapFreeRatio=5\\f[R]\n@@ -5259,1 +5636,1 @@\n-API call \\f[V]System.exit(exitValue)\\f[R].\n+API call \\f[CB]System.exit(exitValue)\\f[R].\n@@ -5262,1 +5639,1 @@\n-\\f[V]0\\f[R]: Successful completion\n+\\f[CB]0\\f[R]: Successful completion\n@@ -5264,1 +5641,1 @@\n-\\f[V]>0\\f[R]: An error occurred\n+\\f[CB]>0\\f[R]: An error occurred\n","filename":"src\/java.base\/share\/man\/java.1","additions":2047,"deletions":1670,"binary":false,"changes":3717,"status":"modified"},{"patch":"@@ -22,2 +22,2 @@\n-'\\\" t\n-.\\\" Automatically generated by Pandoc 2.19.2\n+.\\\"t\n+.\\\" Automatically generated by Pandoc 2.3.1\n@@ -25,15 +25,1 @@\n-.\\\" Define V font for inline verbatim, using C font in formats\n-.\\\" that render this, and otherwise B font.\n-.ie \"\\f[CB]x\\f[R]\"x\" \\{\\\n-. ftr V B\n-. ftr VI BI\n-. ftr VB B\n-. ftr VBI BI\n-.\\}\n-.el \\{\\\n-. ftr V CR\n-. ftr VI CI\n-. ftr VB CB\n-. ftr VBI CBI\n-.\\}\n-.TH \"KEYTOOL\" \"1\" \"2023\" \"JDK 20-ea\" \"JDK Commands\"\n+.TH \"KEYTOOL\" \"1\" \"2023\" \"JDK 20\\-ea\" \"JDK Commands\"\n@@ -43,1 +29,1 @@\n-keytool - a key and certificate management utility\n+keytool \\- a key and certificate management utility\n@@ -46,1 +32,1 @@\n-\\f[V]keytool\\f[R] [\\f[I]commands\\f[R]]\n+\\f[CB]keytool\\f[R] [\\f[I]commands\\f[R]]\n@@ -48,2 +34,2 @@\n-\\f[I]commands\\f[R]\n-Commands for \\f[V]keytool\\f[R] include the following:\n+.B \\f[I]commands\\f[R]\n+Commands for \\f[CB]keytool\\f[R] include the following:\n@@ -52,1 +38,1 @@\n-\\f[V]-certreq\\f[R]: Generates a certificate request\n+\\f[CB]\\-certreq\\f[R]: Generates a certificate request\n@@ -54,1 +40,1 @@\n-\\f[V]-changealias\\f[R]: Changes an entry\\[aq]s alias\n+\\f[CB]\\-changealias\\f[R]: Changes an entry\\[aq]s alias\n@@ -56,1 +42,1 @@\n-\\f[V]-delete\\f[R]: Deletes an entry\n+\\f[CB]\\-delete\\f[R]: Deletes an entry\n@@ -58,1 +44,1 @@\n-\\f[V]-exportcert\\f[R]: Exports certificate\n+\\f[CB]\\-exportcert\\f[R]: Exports certificate\n@@ -60,1 +46,1 @@\n-\\f[V]-genkeypair\\f[R]: Generates a key pair\n+\\f[CB]\\-genkeypair\\f[R]: Generates a key pair\n@@ -62,1 +48,1 @@\n-\\f[V]-genseckey\\f[R]: Generates a secret key\n+\\f[CB]\\-genseckey\\f[R]: Generates a secret key\n@@ -64,1 +50,1 @@\n-\\f[V]-gencert\\f[R]: Generates a certificate from a certificate request\n+\\f[CB]\\-gencert\\f[R]: Generates a certificate from a certificate request\n@@ -66,1 +52,1 @@\n-\\f[V]-importcert\\f[R]: Imports a certificate or a certificate chain\n+\\f[CB]\\-importcert\\f[R]: Imports a certificate or a certificate chain\n@@ -68,1 +54,1 @@\n-\\f[V]-importpass\\f[R]: Imports a password\n+\\f[CB]\\-importpass\\f[R]: Imports a password\n@@ -70,1 +56,1 @@\n-\\f[V]-importkeystore\\f[R]: Imports one or all entries from another\n+\\f[CB]\\-importkeystore\\f[R]: Imports one or all entries from another\n@@ -73,1 +59,1 @@\n-\\f[V]-keypasswd\\f[R]: Changes the key password of an entry\n+\\f[CB]\\-keypasswd\\f[R]: Changes the key password of an entry\n@@ -75,1 +61,1 @@\n-\\f[V]-list\\f[R]: Lists entries in a keystore\n+\\f[CB]\\-list\\f[R]: Lists entries in a keystore\n@@ -77,1 +63,1 @@\n-\\f[V]-printcert\\f[R]: Prints the content of a certificate\n+\\f[CB]\\-printcert\\f[R]: Prints the content of a certificate\n@@ -79,1 +65,1 @@\n-\\f[V]-printcertreq\\f[R]: Prints the content of a certificate request\n+\\f[CB]\\-printcertreq\\f[R]: Prints the content of a certificate request\n@@ -81,1 +67,1 @@\n-\\f[V]-printcrl\\f[R]: Prints the content of a Certificate Revocation List\n+\\f[CB]\\-printcrl\\f[R]: Prints the content of a Certificate Revocation List\n@@ -84,1 +70,1 @@\n-\\f[V]-storepasswd\\f[R]: Changes the store password of a keystore\n+\\f[CB]\\-storepasswd\\f[R]: Changes the store password of a keystore\n@@ -86,1 +72,1 @@\n-\\f[V]-showinfo\\f[R]: Displays security-related information\n+\\f[CB]\\-showinfo\\f[R]: Displays security\\-related information\n@@ -88,1 +74,1 @@\n-\\f[V]-version\\f[R]: Prints the program version\n+\\f[CB]\\-version\\f[R]: Prints the program version\n@@ -95,1 +81,1 @@\n-The \\f[V]keytool\\f[R] command is a key and certificate management\n+The \\f[CB]keytool\\f[R] command is a key and certificate management\n@@ -98,1 +84,1 @@\n-associated certificates for use in self-authentication (where a user\n+associated certificates for use in self\\-authentication (where a user\n@@ -101,2 +87,2 @@\n-The \\f[V]keytool\\f[R] command also enables users to cache the public\n-keys (in the form of certificates) of their communicating peers.\n+The \\f[CB]keytool\\f[R] command also enables users to cache the public keys\n+(in the form of certificates) of their communicating peers.\n@@ -113,1 +99,1 @@\n-The \\f[V]keytool\\f[R] command also enables users to administer secret\n+The \\f[CB]keytool\\f[R] command also enables users to administer secret\n@@ -116,1 +102,1 @@\n-It can also display other security-related information.\n+It can also display other security\\-related information.\n@@ -118,1 +104,1 @@\n-The \\f[V]keytool\\f[R] command stores the keys and certificates in a\n+The \\f[CB]keytool\\f[R] command stores the keys and certificates in a\n@@ -121,3 +107,3 @@\n-The \\f[V]keytool\\f[R] command uses the\n-\\f[V]jdk.certpath.disabledAlgorithms\\f[R] and\n-\\f[V]jdk.security.legacyAlgorithms\\f[R] security properties to determine\n+The \\f[CB]keytool\\f[R] command uses the\n+\\f[CB]jdk.certpath.disabledAlgorithms\\f[R] and\n+\\f[CB]jdk.security.legacyAlgorithms\\f[R] security properties to determine\n@@ -126,4 +112,4 @@\n-The \\f[V]jdk.certpath.disabledAlgorithms\\f[R] and\n-\\f[V]jdk.security.legacyAlgorithms\\f[R] security properties are defined\n-in the \\f[V]java.security\\f[R] file (located in the JDK\\[aq]s\n-\\f[V]$JAVA_HOME\/conf\/security\\f[R] directory).\n+The \\f[CB]jdk.certpath.disabledAlgorithms\\f[R] and\n+\\f[CB]jdk.security.legacyAlgorithms\\f[R] security properties are defined\n+in the \\f[CB]java.security\\f[R] file (located in the JDK\\[aq]s\n+\\f[CB]$JAVA_HOME\/conf\/security\\f[R] directory).\n@@ -136,1 +122,1 @@\n-(\\f[V]-\\f[R]).\n+(\\f[CB]\\-\\f[R]).\n@@ -142,1 +128,1 @@\n-There are two kinds of options, one is single-valued which should be\n+There are two kinds of options, one is single\\-valued which should be\n@@ -144,1 +130,1 @@\n-If a single-valued option is provided multiple times, the value of the\n+If a single\\-valued option is provided multiple times, the value of the\n@@ -146,3 +132,3 @@\n-The other type is multi-valued, which can be provided multiple times and\n-all values are used.\n-The only multi-valued option currently supported is the \\f[V]-ext\\f[R]\n+The other type is multi\\-valued, which can be provided multiple times\n+and all values are used.\n+The only multi\\-valued option currently supported is the \\f[CB]\\-ext\\f[R]\n@@ -156,2 +142,2 @@\n-Braces are also used around the \\f[V]-v\\f[R], \\f[V]-rfc\\f[R], and\n-\\f[V]-J\\f[R] options, which have meaning only when they appear on the\n+Braces are also used around the \\f[CB]\\-v\\f[R], \\f[CB]\\-rfc\\f[R], and\n+\\f[CB]\\-J\\f[R] options, which have meaning only when they appear on the\n@@ -163,5 +149,5 @@\n-For the \\f[V]-keypass\\f[R] option, if you don\\[aq]t specify the option\n-on the command line, then the \\f[V]keytool\\f[R] command first attempts\n-to use the keystore password to recover the private\/secret key.\n-If this attempt fails, then the \\f[V]keytool\\f[R] command prompts you\n-for the private\/secret key password.\n+For the \\f[CB]\\-keypass\\f[R] option, if you don\\[aq]t specify the option\n+on the command line, then the \\f[CB]keytool\\f[R] command first attempts to\n+use the keystore password to recover the private\/secret key.\n+If this attempt fails, then the \\f[CB]keytool\\f[R] command prompts you for\n+the private\/secret key password.\n@@ -171,1 +157,1 @@\n-For example, here is the format of the \\f[V]-printcert\\f[R] command:\n+For example, here is the format of the \\f[CB]\\-printcert\\f[R] command:\n@@ -175,2 +161,2 @@\n-\\f[V]keytool -printcert\\f[R] {\\f[V]-file\\f[R] \\f[I]cert_file\\f[R]}\n-{\\f[V]-v\\f[R]}\n+\\f[CB]keytool\\ \\-printcert\\f[R] {\\f[CB]\\-file\\f[R] \\f[I]cert_file\\f[R]}\n+{\\f[CB]\\-v\\f[R]}\n@@ -179,1 +165,1 @@\n-When you specify a \\f[V]-printcert\\f[R] command, replace\n+When you specify a \\f[CB]\\-printcert\\f[R] command, replace\n@@ -181,1 +167,1 @@\n-\\f[V]keytool -printcert -file VScert.cer\\f[R]\n+\\f[CB]keytool\\ \\-printcert\\ \\-file\\ VScert.cer\\f[R]\n@@ -193,1 +179,1 @@\n-\\f[V]-gencert\\f[R]\n+\\f[CB]\\-gencert\\f[R]\n@@ -195,1 +181,1 @@\n-\\f[V]-genkeypair\\f[R]\n+\\f[CB]\\-genkeypair\\f[R]\n@@ -197,1 +183,1 @@\n-\\f[V]-genseckey\\f[R]\n+\\f[CB]\\-genseckey\\f[R]\n@@ -199,1 +185,1 @@\n-\\f[V]-importcert\\f[R]\n+\\f[CB]\\-importcert\\f[R]\n@@ -201,1 +187,1 @@\n-\\f[V]-importpass\\f[R]\n+\\f[CB]\\-importpass\\f[R]\n@@ -205,1 +191,1 @@\n-\\f[V]-importkeystore\\f[R]\n+\\f[CB]\\-importkeystore\\f[R]\n@@ -209,1 +195,1 @@\n-\\f[V]-certreq\\f[R]\n+\\f[CB]\\-certreq\\f[R]\n@@ -213,1 +199,1 @@\n-\\f[V]-exportcert\\f[R]\n+\\f[CB]\\-exportcert\\f[R]\n@@ -217,1 +203,1 @@\n-\\f[V]-list\\f[R]\n+\\f[CB]\\-list\\f[R]\n@@ -219,1 +205,1 @@\n-\\f[V]-printcert\\f[R]\n+\\f[CB]\\-printcert\\f[R]\n@@ -221,1 +207,1 @@\n-\\f[V]-printcertreq\\f[R]\n+\\f[CB]\\-printcertreq\\f[R]\n@@ -223,1 +209,1 @@\n-\\f[V]-printcrl\\f[R]\n+\\f[CB]\\-printcrl\\f[R]\n@@ -227,1 +213,1 @@\n-\\f[V]-storepasswd\\f[R]\n+\\f[CB]\\-storepasswd\\f[R]\n@@ -229,1 +215,1 @@\n-\\f[V]-keypasswd\\f[R]\n+\\f[CB]\\-keypasswd\\f[R]\n@@ -231,1 +217,1 @@\n-\\f[V]-delete\\f[R]\n+\\f[CB]\\-delete\\f[R]\n@@ -233,1 +219,1 @@\n-\\f[V]-changealias\\f[R]\n+\\f[CB]\\-changealias\\f[R]\n@@ -235,1 +221,1 @@\n-\\f[B]Commands for Displaying Security-related Information\\f[R]:\n+\\f[B]Commands for Displaying Security\\-related Information\\f[R]:\n@@ -237,1 +223,1 @@\n-\\f[V]-showinfo\\f[R]\n+\\f[CB]\\-showinfo\\f[R]\n@@ -241,1 +227,1 @@\n-\\f[V]-version\\f[R]\n+\\f[CB]\\-version\\f[R]\n@@ -244,2 +230,2 @@\n-\\f[V]-gencert\\f[R]\n-The following are the available options for the \\f[V]-gencert\\f[R]\n+.B \\f[CB]\\-gencert\\f[R]\n+The following are the available options for the \\f[CB]\\-gencert\\f[R]\n@@ -249,1 +235,1 @@\n-{\\f[V]-rfc\\f[R]}: Output in RFC (Request For Comment) style\n+{\\f[CB]\\-rfc\\f[R]}: Output in RFC (Request For Comment) style\n@@ -251,1 +237,1 @@\n-{\\f[V]-infile\\f[R] \\f[I]infile\\f[R]}: Input file name\n+{\\f[CB]\\-infile\\f[R] \\f[I]infile\\f[R]}: Input file name\n@@ -253,1 +239,1 @@\n-{\\f[V]-outfile\\f[R] \\f[I]outfile\\f[R]}: Output file name\n+{\\f[CB]\\-outfile\\f[R] \\f[I]outfile\\f[R]}: Output file name\n@@ -255,1 +241,1 @@\n-{\\f[V]-alias\\f[R] \\f[I]alias\\f[R]}: Alias name of the entry to process\n+{\\f[CB]\\-alias\\f[R] \\f[I]alias\\f[R]}: Alias name of the entry to process\n@@ -257,1 +243,1 @@\n-{\\f[V]-sigalg\\f[R] \\f[I]sigalg\\f[R]}: Signature algorithm name\n+{\\f[CB]\\-sigalg\\f[R] \\f[I]sigalg\\f[R]}: Signature algorithm name\n@@ -259,1 +245,1 @@\n-{\\f[V]-dname\\f[R] \\f[I]dname\\f[R]}: Distinguished name\n+{\\f[CB]\\-dname\\f[R] \\f[I]dname\\f[R]}: Distinguished name\n@@ -261,1 +247,1 @@\n-{\\f[V]-startdate\\f[R] \\f[I]startdate\\f[R]}: Certificate validity start\n+{\\f[CB]\\-startdate\\f[R] \\f[I]startdate\\f[R]}: Certificate validity start\n@@ -264,1 +250,1 @@\n-{\\f[V]-ext\\f[R] \\f[I]ext\\f[R]}*: X.509 extension\n+{\\f[CB]\\-ext\\f[R] \\f[I]ext\\f[R]}*: X.509 extension\n@@ -266,1 +252,1 @@\n-{\\f[V]-validity\\f[R] \\f[I]days\\f[R]}: Validity number of days\n+{\\f[CB]\\-validity\\f[R] \\f[I]days\\f[R]}: Validity number of days\n@@ -268,1 +254,1 @@\n-[\\f[V]-keypass\\f[R] \\f[I]arg\\f[R]]: Key password\n+[\\f[CB]\\-keypass\\f[R] \\f[I]arg\\f[R]]: Key password\n@@ -270,1 +256,1 @@\n-{\\f[V]-keystore\\f[R] \\f[I]keystore\\f[R]}: Keystore name\n+{\\f[CB]\\-keystore\\f[R] \\f[I]keystore\\f[R]}: Keystore name\n@@ -272,1 +258,1 @@\n-[\\f[V]-storepass\\f[R] \\f[I]arg\\f[R]]: Keystore password\n+[\\f[CB]\\-storepass\\f[R] \\f[I]arg\\f[R]]: Keystore password\n@@ -274,1 +260,1 @@\n-{\\f[V]-storetype\\f[R] \\f[I]type\\f[R]}: Keystore type\n+{\\f[CB]\\-storetype\\f[R] \\f[I]type\\f[R]}: Keystore type\n@@ -276,1 +262,1 @@\n-{\\f[V]-providername\\f[R] \\f[I]name\\f[R]}: Provider name\n+{\\f[CB]\\-providername\\f[R] \\f[I]name\\f[R]}: Provider name\n@@ -278,1 +264,1 @@\n-{\\f[V]-addprovider\\f[R] \\f[I]name\\f[R] [\\f[V]-providerarg\\f[R]\n+{\\f[CB]\\-addprovider\\f[R] \\f[I]name\\f[R] [\\f[CB]\\-providerarg\\f[R]\n@@ -288,1 +274,1 @@\n-\\f[V]keytool -addprovider SunPKCS11 -providerarg some.cfg ...\\f[R]\n+\\f[CB]keytool\\ \\-addprovider\\ SunPKCS11\\ \\-providerarg\\ some.cfg\\ ...\\f[R]\n@@ -294,1 +280,1 @@\n-with \\f[V]-providerclass sun.security.pkcs11.SunPKCS11\\f[R] even if it\n+with \\f[CB]\\-providerclass\\ sun.security.pkcs11.SunPKCS11\\f[R] even if it\n@@ -297,1 +283,1 @@\n-and therefore the most widely used with the \\f[V]-providerclass\\f[R]\n+and therefore the most widely used with the \\f[CB]\\-providerclass\\f[R]\n@@ -300,1 +286,1 @@\n-reflection, \\f[V]-providerclass\\f[R] should still be used.\n+reflection, \\f[CB]\\-providerclass\\f[R] should still be used.\n@@ -303,3 +289,3 @@\n-{\\f[V]-providerclass\\f[R] \\f[I]class\\f[R] [\\f[V]-providerarg\\f[R]\n-\\f[I]arg\\f[R]]}: Add security provider by fully qualified class name\n-with an optional configure argument.\n+{\\f[CB]\\-providerclass\\f[R] \\f[I]class\\f[R] [\\f[CB]\\-providerarg\\f[R]\n+\\f[I]arg\\f[R]]}: Add security provider by fully qualified class name with\n+an optional configure argument.\n@@ -308,1 +294,1 @@\n-For example, if \\f[V]MyProvider\\f[R] is a legacy provider loaded via\n+For example, if \\f[CB]MyProvider\\f[R] is a legacy provider loaded via\n@@ -312,1 +298,1 @@\n-\\f[V]keytool -providerclass com.example.MyProvider ...\\f[R]\n+\\f[CB]keytool\\ \\-providerclass\\ com.example.MyProvider\\ ...\\f[R]\n@@ -316,1 +302,1 @@\n-{\\f[V]-providerpath\\f[R] \\f[I]list\\f[R]}: Provider classpath\n+{\\f[CB]\\-providerpath\\f[R] \\f[I]list\\f[R]}: Provider classpath\n@@ -318,1 +304,1 @@\n-{\\f[V]-v\\f[R]}: Verbose output\n+{\\f[CB]\\-v\\f[R]}: Verbose output\n@@ -320,1 +306,1 @@\n-{\\f[V]-protected\\f[R]}: Password provided through a protected mechanism\n+{\\f[CB]\\-protected\\f[R]}: Password provided through a protected mechanism\n@@ -322,1 +308,1 @@\n-Use the \\f[V]-gencert\\f[R] command to generate a certificate as a\n+Use the \\f[CB]\\-gencert\\f[R] command to generate a certificate as a\n@@ -324,1 +310,1 @@\n-\\f[V]keytool -certreq\\f[R] command).\n+\\f[CB]keytool\\ \\-certreq\\f[R] command).\n@@ -329,1 +315,1 @@\n-When \\f[V]-rfc\\f[R] is specified, the output format is Base64-encoded\n+When \\f[CB]\\-rfc\\f[R] is specified, the output format is Base64\\-encoded\n@@ -332,1 +318,1 @@\n-The \\f[V]-sigalg\\f[R] value specifies the algorithm that should be used\n+The \\f[CB]\\-sigalg\\f[R] value specifies the algorithm that should be used\n@@ -343,1 +329,1 @@\n-The \\f[V]-ext\\f[R] value shows what X.509 extensions will be embedded in\n+The \\f[CB]\\-ext\\f[R] value shows what X.509 extensions will be embedded in\n@@ -345,1 +331,1 @@\n-Read \\f[B]Common Command Options\\f[R] for the grammar of \\f[V]-ext\\f[R].\n+Read \\f[B]Common Command Options\\f[R] for the grammar of \\f[CB]\\-ext\\f[R].\n@@ -347,2 +333,2 @@\n-The \\f[V]-gencert\\f[R] option enables you to create certificate chains.\n-The following example creates a certificate, \\f[V]e1\\f[R], that contains\n+The \\f[CB]\\-gencert\\f[R] option enables you to create certificate chains.\n+The following example creates a certificate, \\f[CB]e1\\f[R], that contains\n@@ -351,2 +337,2 @@\n-The following commands creates four key pairs named \\f[V]ca\\f[R],\n-\\f[V]ca1\\f[R], \\f[V]ca2\\f[R], and \\f[V]e1\\f[R]:\n+The following commands creates four key pairs named \\f[CB]ca\\f[R],\n+\\f[CB]ca1\\f[R], \\f[CB]ca2\\f[R], and \\f[CB]e1\\f[R]:\n@@ -356,4 +342,4 @@\n-keytool -alias ca -dname CN=CA -genkeypair -keyalg rsa\n-keytool -alias ca1 -dname CN=CA -genkeypair -keyalg rsa\n-keytool -alias ca2 -dname CN=CA -genkeypair -keyalg rsa\n-keytool -alias e1 -dname CN=E1 -genkeypair -keyalg rsa\n+keytool\\ \\-alias\\ ca\\ \\-dname\\ CN=CA\\ \\-genkeypair\\ \\-keyalg\\ rsa\n+keytool\\ \\-alias\\ ca1\\ \\-dname\\ CN=CA\\ \\-genkeypair\\ \\-keyalg\\ rsa\n+keytool\\ \\-alias\\ ca2\\ \\-dname\\ CN=CA\\ \\-genkeypair\\ \\-keyalg\\ rsa\n+keytool\\ \\-alias\\ e1\\ \\-dname\\ CN=E1\\ \\-genkeypair\\ \\-keyalg\\ rsa\n@@ -364,2 +350,2 @@\n-\\f[V]ca\\f[R] signs \\f[V]ca1\\f[R] and \\f[V]ca1\\f[R] signs \\f[V]ca2\\f[R],\n-all of which are self-issued:\n+\\f[CB]ca\\f[R] signs \\f[CB]ca1\\f[R] and \\f[CB]ca1\\f[R] signs \\f[CB]ca2\\f[R], all\n+of which are self\\-issued:\n@@ -369,3 +355,3 @@\n-keytool -alias ca1 -certreq |\n-    keytool -alias ca -gencert -ext san=dns:ca1 |\n-    keytool -alias ca1 -importcert\n+keytool\\ \\-alias\\ ca1\\ \\-certreq\\ |\n+\\ \\ \\ \\ keytool\\ \\-alias\\ ca\\ \\-gencert\\ \\-ext\\ san=dns:ca1\\ |\n+\\ \\ \\ \\ keytool\\ \\-alias\\ ca1\\ \\-importcert\n@@ -373,3 +359,3 @@\n-keytool -alias ca2 -certreq |\n-    keytool -alias ca1 -gencert -ext san=dns:ca2 |\n-    keytool -alias ca2 -importcert\n+keytool\\ \\-alias\\ ca2\\ \\-certreq\\ |\n+\\ \\ \\ \\ keytool\\ \\-alias\\ ca1\\ \\-gencert\\ \\-ext\\ san=dns:ca2\\ |\n+\\ \\ \\ \\ keytool\\ \\-alias\\ ca2\\ \\-importcert\n@@ -379,4 +365,4 @@\n-The following command creates the certificate \\f[V]e1\\f[R] and stores it\n-in the \\f[V]e1.cert\\f[R] file, which is signed by \\f[V]ca2\\f[R].\n-As a result, \\f[V]e1\\f[R] should contain \\f[V]ca\\f[R], \\f[V]ca1\\f[R],\n-and \\f[V]ca2\\f[R] in its certificate chain:\n+The following command creates the certificate \\f[CB]e1\\f[R] and stores it\n+in the \\f[CB]e1.cert\\f[R] file, which is signed by \\f[CB]ca2\\f[R].\n+As a result, \\f[CB]e1\\f[R] should contain \\f[CB]ca\\f[R], \\f[CB]ca1\\f[R], and\n+\\f[CB]ca2\\f[R] in its certificate chain:\n@@ -385,1 +371,1 @@\n-\\f[V]keytool -alias e1 -certreq | keytool -alias ca2 -gencert > e1.cert\\f[R]\n+\\f[CB]keytool\\ \\-alias\\ e1\\ \\-certreq\\ |\\ keytool\\ \\-alias\\ ca2\\ \\-gencert\\ >\\ e1.cert\\f[R]\n@@ -389,2 +375,2 @@\n-\\f[V]-genkeypair\\f[R]\n-The following are the available options for the \\f[V]-genkeypair\\f[R]\n+.B \\f[CB]\\-genkeypair\\f[R]\n+The following are the available options for the \\f[CB]\\-genkeypair\\f[R]\n@@ -394,1 +380,1 @@\n-{\\f[V]-alias\\f[R] \\f[I]alias\\f[R]}: Alias name of the entry to process\n+{\\f[CB]\\-alias\\f[R] \\f[I]alias\\f[R]}: Alias name of the entry to process\n@@ -396,1 +382,1 @@\n-\\f[V]-keyalg\\f[R] \\f[I]alg\\f[R]: Key algorithm name\n+\\f[CB]\\-keyalg\\f[R] \\f[I]alg\\f[R]: Key algorithm name\n@@ -398,1 +384,1 @@\n-{\\f[V]-keysize\\f[R] \\f[I]size\\f[R]}: Key bit size\n+{\\f[CB]\\-keysize\\f[R] \\f[I]size\\f[R]}: Key bit size\n@@ -400,1 +386,1 @@\n-{\\f[V]-groupname\\f[R] \\f[I]name\\f[R]}: Group name.\n+{\\f[CB]\\-groupname\\f[R] \\f[I]name\\f[R]}: Group name.\n@@ -403,1 +389,1 @@\n-{\\f[V]-sigalg\\f[R] \\f[I]alg\\f[R]}: Signature algorithm name\n+{\\f[CB]\\-sigalg\\f[R] \\f[I]alg\\f[R]}: Signature algorithm name\n@@ -405,1 +391,1 @@\n-{\\f[V]-signer\\f[R] \\f[I]alias\\f[R]}: Signer alias\n+{\\f[CB]\\-signer\\f[R] \\f[I]alias\\f[R]}: Signer alias\n@@ -407,1 +393,1 @@\n-[\\f[V]-signerkeypass\\f[R] \\f[I]arg\\f[R]]: Signer key password\n+[\\f[CB]\\-signerkeypass\\f[R] \\f[I]arg\\f[R]]: Signer key password\n@@ -409,1 +395,1 @@\n-[\\f[V]-dname\\f[R] \\f[I]name\\f[R]]: Distinguished name\n+[\\f[CB]\\-dname\\f[R] \\f[I]name\\f[R]]: Distinguished name\n@@ -411,1 +397,1 @@\n-{\\f[V]-startdate\\f[R] \\f[I]date\\f[R]}: Certificate validity start date\n+{\\f[CB]\\-startdate\\f[R] \\f[I]date\\f[R]}: Certificate validity start date\n@@ -414,1 +400,1 @@\n-{\\f[V]-ext\\f[R] \\f[I]value\\f[R]}*: X.509 extension\n+{\\f[CB]\\-ext\\f[R] \\f[I]value\\f[R]}*: X.509 extension\n@@ -416,1 +402,1 @@\n-{\\f[V]-validity\\f[R] \\f[I]days\\f[R]}: Validity number of days\n+{\\f[CB]\\-validity\\f[R] \\f[I]days\\f[R]}: Validity number of days\n@@ -418,1 +404,1 @@\n-[\\f[V]-keypass\\f[R] \\f[I]arg\\f[R]]: Key password\n+[\\f[CB]\\-keypass\\f[R] \\f[I]arg\\f[R]]: Key password\n@@ -420,1 +406,1 @@\n-{\\f[V]-keystore\\f[R] \\f[I]keystore\\f[R]}: Keystore name\n+{\\f[CB]\\-keystore\\f[R] \\f[I]keystore\\f[R]}: Keystore name\n@@ -422,1 +408,1 @@\n-[\\f[V]-storepass\\f[R] \\f[I]arg\\f[R]]: Keystore password\n+[\\f[CB]\\-storepass\\f[R] \\f[I]arg\\f[R]]: Keystore password\n@@ -424,1 +410,1 @@\n-{\\f[V]-storetype\\f[R] \\f[I]type\\f[R]}: Keystore type\n+{\\f[CB]\\-storetype\\f[R] \\f[I]type\\f[R]}: Keystore type\n@@ -426,1 +412,1 @@\n-{\\f[V]-providername\\f[R] \\f[I]name\\f[R]}: Provider name\n+{\\f[CB]\\-providername\\f[R] \\f[I]name\\f[R]}: Provider name\n@@ -428,1 +414,1 @@\n-{\\f[V]-addprovider\\f[R] \\f[I]name\\f[R] [\\f[V]-providerarg\\f[R]\n+{\\f[CB]\\-addprovider\\f[R] \\f[I]name\\f[R] [\\f[CB]\\-providerarg\\f[R]\n@@ -432,1 +418,1 @@\n-{\\f[V]-providerclass\\f[R] \\f[I]class\\f[R] [\\f[V]-providerarg\\f[R]\n+{\\f[CB]\\-providerclass\\f[R] \\f[I]class\\f[R] [\\f[CB]\\-providerarg\\f[R]\n@@ -436,1 +422,1 @@\n-{\\f[V]-providerpath\\f[R] \\f[I]list\\f[R]}: Provider classpath\n+{\\f[CB]\\-providerpath\\f[R] \\f[I]list\\f[R]}: Provider classpath\n@@ -438,1 +424,1 @@\n-{\\f[V]-v\\f[R]}: Verbose output\n+{\\f[CB]\\-v\\f[R]}: Verbose output\n@@ -440,1 +426,1 @@\n-{\\f[V]-protected\\f[R]}: Password provided through a protected mechanism\n+{\\f[CB]\\-protected\\f[R]}: Password provided through a protected mechanism\n@@ -442,1 +428,1 @@\n-Use the \\f[V]-genkeypair\\f[R] command to generate a key pair (a public\n+Use the \\f[CB]\\-genkeypair\\f[R] command to generate a key pair (a public\n@@ -444,4 +430,4 @@\n-When the \\f[V]-signer\\f[R] option is not specified, the public key is\n-wrapped in an X.509 v3 self-signed certificate and stored as a\n-single-element certificate chain.\n-When the \\f[V]-signer\\f[R] option is specified, a new certificate is\n+When the \\f[CB]\\-signer\\f[R] option is not specified, the public key is\n+wrapped in an X.509 v3 self\\-signed certificate and stored as a\n+single\\-element certificate chain.\n+When the \\f[CB]\\-signer\\f[R] option is specified, a new certificate is\n@@ -449,2 +435,2 @@\n-multiple-element certificate chain (containing the generated certificate\n-itself, and the signer?s certificate chain).\n+multiple\\-element certificate chain (containing the generated\n+certificate itself, and the signer?s certificate chain).\n@@ -454,2 +440,2 @@\n-The \\f[V]-keyalg\\f[R] value specifies the algorithm to be used to\n-generate the key pair, and the \\f[V]-keysize\\f[R] value specifies the\n+The \\f[CB]\\-keyalg\\f[R] value specifies the algorithm to be used to\n+generate the key pair, and the \\f[CB]\\-keysize\\f[R] value specifies the\n@@ -457,1 +443,1 @@\n-The \\f[V]-sigalg\\f[R] value specifies the algorithm that should be used\n+The \\f[CB]\\-sigalg\\f[R] value specifies the algorithm that should be used\n@@ -459,1 +445,1 @@\n-This algorithm must be compatible with the \\f[V]-keyalg\\f[R] value.\n+This algorithm must be compatible with the \\f[CB]\\-keyalg\\f[R] value.\n@@ -461,1 +447,1 @@\n-The \\f[V]-groupname\\f[R] value specifies the named group (for example,\n+The \\f[CB]\\-groupname\\f[R] value specifies the named group (for example,\n@@ -464,1 +450,1 @@\n-Only one of \\f[V]-groupname\\f[R] and \\f[V]-keysize\\f[R] can be\n+Only one of \\f[CB]\\-groupname\\f[R] and \\f[CB]\\-keysize\\f[R] can be\n@@ -467,2 +453,2 @@\n-The \\f[V]-signer\\f[R] value specifies the alias of a\n-\\f[V]PrivateKeyEntry\\f[R] for the signer that already exists in the\n+The \\f[CB]\\-signer\\f[R] value specifies the alias of a\n+\\f[CB]PrivateKeyEntry\\f[R] for the signer that already exists in the\n@@ -473,4 +459,3 @@\n-the \\f[V]-keyalg\\f[R] value is \\f[V]XDH\\f[R], \\f[V]X25519\\f[R],\n-\\f[V]X448\\f[R], or \\f[V]DH\\f[R]) as these keys cannot be used for\n-digital signatures, and therefore a self-signed certificate cannot be\n-created.\n+the \\f[CB]\\-keyalg\\f[R] value is \\f[CB]XDH\\f[R], \\f[CB]X25519\\f[R],\n+\\f[CB]X448\\f[R], or \\f[CB]DH\\f[R]) as these keys cannot be used for digital\n+signatures, and therefore a self\\-signed certificate cannot be created.\n@@ -478,1 +463,1 @@\n-The \\f[V]-signerkeypass\\f[R] value specifies the password of the\n+The \\f[CB]\\-signerkeypass\\f[R] value specifies the password of the\n@@ -483,4 +468,4 @@\n-The \\f[V]-dname\\f[R] value specifies the X.500 Distinguished Name to be\n-associated with the value of \\f[V]-alias\\f[R].\n-If the \\f[V]-signer\\f[R] option is not specified, the issuer and subject\n-fields of the self-signed certificate are populated with the specified\n+The \\f[CB]\\-dname\\f[R] value specifies the X.500 Distinguished Name to be\n+associated with the value of \\f[CB]\\-alias\\f[R].\n+If the \\f[CB]\\-signer\\f[R] option is not specified, the issuer and subject\n+fields of the self\\-signed certificate are populated with the specified\n@@ -488,1 +473,1 @@\n-If the \\f[V]-signer\\f[R] option is specified, the subject field of the\n+If the \\f[CB]\\-signer\\f[R] option is specified, the subject field of the\n@@ -495,1 +480,1 @@\n-The value of \\f[V]-keypass\\f[R] is a password used to protect the\n+The value of \\f[CB]\\-keypass\\f[R] is a password used to protect the\n@@ -500,1 +485,1 @@\n-The \\f[V]-keypass\\f[R] value must have at least six characters.\n+The \\f[CB]\\-keypass\\f[R] value must have at least six characters.\n@@ -502,2 +487,2 @@\n-The value of \\f[V]-startdate\\f[R] specifies the issue time of the\n-certificate, also known as the \\[dq]Not Before\\[dq] value of the X.509\n+The value of \\f[CB]\\-startdate\\f[R] specifies the issue time of the\n+certificate, also known as the \"Not Before\" value of the X.509\n@@ -508,1 +493,1 @@\n-([\\f[V]+-\\f[R]]\\f[I]nnn\\f[R][\\f[V]ymdHMS\\f[R]])+\n+([\\f[CB]+\\-\\f[R]]\\f[I]nnn\\f[R][\\f[CB]ymdHMS\\f[R]])+\n@@ -510,2 +495,2 @@\n-[\\f[I]yyyy\\f[R]\\f[V]\/\\f[R]\\f[I]mm\\f[R]\\f[V]\/\\f[R]\\f[I]dd\\f[R]]\n-[\\f[I]HH\\f[R]\\f[V]:\\f[R]\\f[I]MM\\f[R]\\f[V]:\\f[R]\\f[I]SS\\f[R]]\n+[\\f[I]yyyy\\f[R]\\f[CB]\/\\f[R]\\f[I]mm\\f[R]\\f[CB]\/\\f[R]\\f[I]dd\\f[R]]\n+[\\f[I]HH\\f[R]\\f[CB]:\\f[R]\\f[I]MM\\f[R]\\f[CB]:\\f[R]\\f[I]SS\\f[R]]\n@@ -517,1 +502,1 @@\n-minus sign (-) means shift backward.\n+minus sign (\\-) means shift backward.\n@@ -519,3 +504,3 @@\n-hours, minutes, or seconds (denoted by a single character of\n-\\f[V]y\\f[R], \\f[V]m\\f[R], \\f[V]d\\f[R], \\f[V]H\\f[R], \\f[V]M\\f[R], or\n-\\f[V]S\\f[R] respectively).\n+hours, minutes, or seconds (denoted by a single character of \\f[CB]y\\f[R],\n+\\f[CB]m\\f[R], \\f[CB]d\\f[R], \\f[CB]H\\f[R], \\f[CB]M\\f[R], or \\f[CB]S\\f[R]\n+respectively).\n@@ -523,2 +508,2 @@\n-\\f[V]java.util.GregorianCalendar.add(int field, int amount)\\f[R] method\n-on each subvalue, from left to right.\n+\\f[CB]java.util.GregorianCalendar.add(int\\ field,\\ int\\ amount)\\f[R]\n+method on each subvalue, from left to right.\n@@ -529,5 +514,5 @@\n-Calendar c = new GregorianCalendar();\n-c.add(Calendar.YEAR, -1);\n-c.add(Calendar.MONTH, 1);\n-c.add(Calendar.DATE, -1);\n-return c.getTime()\n+Calendar\\ c\\ =\\ new\\ GregorianCalendar();\n+c.add(Calendar.YEAR,\\ \\-1);\n+c.add(Calendar.MONTH,\\ 1);\n+c.add(Calendar.DATE,\\ \\-1);\n+return\\ c.getTime()\n@@ -545,1 +530,1 @@\n-The hour should always be provided in 24-hour format.\n+The hour should always be provided in 24\\-hour format.\n@@ -550,3 +535,3 @@\n-The value of \\f[I]date\\f[R] specifies the number of days (starting at\n-the date specified by \\f[V]-startdate\\f[R], or the current date when\n-\\f[V]-startdate\\f[R] isn\\[aq]t specified) for which the certificate\n+The value of \\f[I]date\\f[R] specifies the number of days (starting at the\n+date specified by \\f[CB]\\-startdate\\f[R], or the current date when\n+\\f[CB]\\-startdate\\f[R] isn\\[aq]t specified) for which the certificate\n@@ -556,2 +541,2 @@\n-\\f[V]-genseckey\\f[R]\n-The following are the available options for the \\f[V]-genseckey\\f[R]\n+.B \\f[CB]\\-genseckey\\f[R]\n+The following are the available options for the \\f[CB]\\-genseckey\\f[R]\n@@ -561,1 +546,1 @@\n-{\\f[V]-alias\\f[R] \\f[I]alias\\f[R]}: Alias name of the entry to process\n+{\\f[CB]\\-alias\\f[R] \\f[I]alias\\f[R]}: Alias name of the entry to process\n@@ -563,1 +548,1 @@\n-[\\f[V]-keypass\\f[R] \\f[I]arg\\f[R]]: Key password\n+[\\f[CB]\\-keypass\\f[R] \\f[I]arg\\f[R]]: Key password\n@@ -565,1 +550,1 @@\n-\\f[V]-keyalg\\f[R] \\f[I]alg\\f[R]: Key algorithm name\n+\\f[CB]\\-keyalg\\f[R] \\f[I]alg\\f[R]: Key algorithm name\n@@ -567,1 +552,1 @@\n-{\\f[V]-keysize\\f[R] \\f[I]size\\f[R]}: Key bit size\n+{\\f[CB]\\-keysize\\f[R] \\f[I]size\\f[R]}: Key bit size\n@@ -569,1 +554,1 @@\n-{\\f[V]-keystore\\f[R] \\f[I]keystore\\f[R]}: Keystore name\n+{\\f[CB]\\-keystore\\f[R] \\f[I]keystore\\f[R]}: Keystore name\n@@ -571,1 +556,1 @@\n-[\\f[V]-storepass\\f[R] \\f[I]arg\\f[R]]: Keystore password\n+[\\f[CB]\\-storepass\\f[R] \\f[I]arg\\f[R]]: Keystore password\n@@ -573,1 +558,1 @@\n-{\\f[V]-storetype\\f[R] \\f[I]type\\f[R]}: Keystore type\n+{\\f[CB]\\-storetype\\f[R] \\f[I]type\\f[R]}: Keystore type\n@@ -575,1 +560,1 @@\n-{\\f[V]-providername\\f[R] \\f[I]name\\f[R]}: Provider name\n+{\\f[CB]\\-providername\\f[R] \\f[I]name\\f[R]}: Provider name\n@@ -577,1 +562,1 @@\n-{\\f[V]-addprovider\\f[R] \\f[I]name\\f[R] [\\f[V]-providerarg\\f[R]\n+{\\f[CB]\\-addprovider\\f[R] \\f[I]name\\f[R] [\\f[CB]\\-providerarg\\f[R]\n@@ -581,3 +566,3 @@\n-{\\f[V]-providerclass\\f[R] \\f[I]class\\f[R] [\\f[V]-providerarg\\f[R]\n-\\f[I]arg\\f[R]]}: Add security provider by fully qualified class name\n-with an optional configure argument.\n+{\\f[CB]\\-providerclass\\f[R] \\f[I]class\\f[R] [\\f[CB]\\-providerarg\\f[R]\n+\\f[I]arg\\f[R]]}: Add security provider by fully qualified class name with\n+an optional configure argument.\n@@ -585,1 +570,1 @@\n-{\\f[V]-providerpath\\f[R] \\f[I]list\\f[R]}: Provider classpath\n+{\\f[CB]\\-providerpath\\f[R] \\f[I]list\\f[R]}: Provider classpath\n@@ -587,1 +572,1 @@\n-{\\f[V]-v\\f[R]}: Verbose output\n+{\\f[CB]\\-v\\f[R]}: Verbose output\n@@ -589,1 +574,1 @@\n-{\\f[V]-protected\\f[R]}: Password provided through a protected mechanism\n+{\\f[CB]\\-protected\\f[R]}: Password provided through a protected mechanism\n@@ -591,3 +576,3 @@\n-Use the \\f[V]-genseckey\\f[R] command to generate a secret key and store\n-it in a new \\f[V]KeyStore.SecretKeyEntry\\f[R] identified by\n-\\f[V]alias\\f[R].\n+Use the \\f[CB]\\-genseckey\\f[R] command to generate a secret key and store\n+it in a new \\f[CB]KeyStore.SecretKeyEntry\\f[R] identified by\n+\\f[CB]alias\\f[R].\n@@ -595,2 +580,2 @@\n-The value of \\f[V]-keyalg\\f[R] specifies the algorithm to be used to\n-generate the secret key, and the value of \\f[V]-keysize\\f[R] specifies\n+The value of \\f[CB]\\-keyalg\\f[R] specifies the algorithm to be used to\n+generate the secret key, and the value of \\f[CB]\\-keysize\\f[R] specifies\n@@ -598,1 +583,1 @@\n-The \\f[V]-keypass\\f[R] value is a password that protects the secret key.\n+The \\f[CB]\\-keypass\\f[R] value is a password that protects the secret key.\n@@ -602,2 +587,2 @@\n-\\f[V]-keystore\\f[R].\n-The \\f[V]-keypass\\f[R] value must contain at least six characters.\n+\\f[CB]\\-keystore\\f[R].\n+The \\f[CB]\\-keypass\\f[R] value must contain at least six characters.\n@@ -606,2 +591,2 @@\n-\\f[V]-importcert\\f[R]\n-The following are the available options for the \\f[V]-importcert\\f[R]\n+.B \\f[CB]\\-importcert\\f[R]\n+The following are the available options for the \\f[CB]\\-importcert\\f[R]\n@@ -611,1 +596,1 @@\n-{\\f[V]-noprompt\\f[R]}: Do not prompt\n+{\\f[CB]\\-noprompt\\f[R]}: Do not prompt\n@@ -613,1 +598,1 @@\n-{\\f[V]-trustcacerts\\f[R]}: Trust certificates from cacerts\n+{\\f[CB]\\-trustcacerts\\f[R]}: Trust certificates from cacerts\n@@ -615,1 +600,1 @@\n-{\\f[V]-protected\\f[R]}: Password is provided through protected mechanism\n+{\\f[CB]\\-protected\\f[R]}: Password is provided through protected mechanism\n@@ -617,1 +602,1 @@\n-{\\f[V]-alias\\f[R] \\f[I]alias\\f[R]}: Alias name of the entry to process\n+{\\f[CB]\\-alias\\f[R] \\f[I]alias\\f[R]}: Alias name of the entry to process\n@@ -619,1 +604,1 @@\n-{\\f[V]-file\\f[R] \\f[I]file\\f[R]}: Input file name\n+{\\f[CB]\\-file\\f[R] \\f[I]file\\f[R]}: Input file name\n@@ -621,1 +606,1 @@\n-[\\f[V]-keypass\\f[R] \\f[I]arg\\f[R]]: Key password\n+[\\f[CB]\\-keypass\\f[R] \\f[I]arg\\f[R]]: Key password\n@@ -623,1 +608,1 @@\n-{\\f[V]-keystore\\f[R] \\f[I]keystore\\f[R]}: Keystore name\n+{\\f[CB]\\-keystore\\f[R] \\f[I]keystore\\f[R]}: Keystore name\n@@ -625,1 +610,1 @@\n-{\\f[V]-cacerts\\f[R]}: Access the cacerts keystore\n+{\\f[CB]\\-cacerts\\f[R]}: Access the cacerts keystore\n@@ -627,1 +612,1 @@\n-[\\f[V]-storepass\\f[R] \\f[I]arg\\f[R]]: Keystore password\n+[\\f[CB]\\-storepass\\f[R] \\f[I]arg\\f[R]]: Keystore password\n@@ -629,1 +614,1 @@\n-{\\f[V]-storetype\\f[R] \\f[I]type\\f[R]}: Keystore type\n+{\\f[CB]\\-storetype\\f[R] \\f[I]type\\f[R]}: Keystore type\n@@ -631,1 +616,1 @@\n-{\\f[V]-providername\\f[R] \\f[I]name\\f[R]}: Provider name\n+{\\f[CB]\\-providername\\f[R] \\f[I]name\\f[R]}: Provider name\n@@ -633,1 +618,1 @@\n-{\\f[V]-addprovider\\f[R] \\f[I]name\\f[R] [\\f[V]-providerarg\\f[R]\n+{\\f[CB]\\-addprovider\\f[R] \\f[I]name\\f[R] [\\f[CB]\\-providerarg\\f[R]\n@@ -637,3 +622,3 @@\n-{\\f[V]-providerclass\\f[R] \\f[I]class\\f[R] [\\f[V]-providerarg\\f[R]\n-\\f[I]arg\\f[R]]}: Add security provider by fully qualified class name\n-with an optional configure argument.\n+{\\f[CB]\\-providerclass\\f[R] \\f[I]class\\f[R] [\\f[CB]\\-providerarg\\f[R]\n+\\f[I]arg\\f[R]]}: Add security provider by fully qualified class name with\n+an optional configure argument.\n@@ -641,1 +626,1 @@\n-{\\f[V]-providerpath\\f[R] \\f[I]list\\f[R]}: Provider classpath\n+{\\f[CB]\\-providerpath\\f[R] \\f[I]list\\f[R]}: Provider classpath\n@@ -643,1 +628,1 @@\n-{\\f[V]-v\\f[R]}: Verbose output\n+{\\f[CB]\\-v\\f[R]}: Verbose output\n@@ -645,1 +630,1 @@\n-Use the \\f[V]-importcert\\f[R] command to read the certificate or\n+Use the \\f[CB]\\-importcert\\f[R] command to read the certificate or\n@@ -647,5 +632,5 @@\n-reply or in a sequence of X.509 certificates) from \\f[V]-file\\f[R]\n-\\f[I]file\\f[R], and store it in the \\f[V]keystore\\f[R] entry identified\n-by \\f[V]-alias\\f[R].\n-If \\f[V]-file\\f[R] \\f[I]file\\f[R] is not specified, then the certificate\n-or certificate chain is read from \\f[V]stdin\\f[R].\n+reply or in a sequence of X.509 certificates) from \\f[CB]\\-file\\f[R]\n+\\f[I]file\\f[R], and store it in the \\f[CB]keystore\\f[R] entry identified by\n+\\f[CB]\\-alias\\f[R].\n+If \\f[CB]\\-file\\f[R] \\f[I]file\\f[R] is not specified, then the certificate\n+or certificate chain is read from \\f[CB]stdin\\f[R].\n@@ -653,1 +638,1 @@\n-The \\f[V]keytool\\f[R] command can import X.509 v1, v2, and v3\n+The \\f[CB]keytool\\f[R] command can import X.509 v1, v2, and v3\n@@ -660,2 +645,2 @@\n-string that starts with \\f[V]-----BEGIN\\f[R], and bounded at the end by\n-a string that starts with \\f[V]-----END\\f[R].\n+string that starts with \\f[CB]\\-\\-\\-\\-\\-BEGIN\\f[R], and bounded at the end\n+by a string that starts with \\f[CB]\\-\\-\\-\\-\\-END\\f[R].\n@@ -667,1 +652,1 @@\n-See the \\f[V]-certreq\\f[R] command in \\f[B]Commands for Generating a\n+See the \\f[CB]\\-certreq\\f[R] command in \\f[B]Commands for Generating a\n@@ -670,1 +655,1 @@\n-The type of import is indicated by the value of the \\f[V]-alias\\f[R]\n+The type of import is indicated by the value of the \\f[CB]\\-alias\\f[R]\n@@ -672,3 +657,2 @@\n-If the alias doesn\\[aq]t point to a key entry, then the\n-\\f[V]keytool\\f[R] command assumes you are adding a trusted certificate\n-entry.\n+If the alias doesn\\[aq]t point to a key entry, then the \\f[CB]keytool\\f[R]\n+command assumes you are adding a trusted certificate entry.\n@@ -676,1 +660,1 @@\n-If the alias does exist, then the \\f[V]keytool\\f[R] command outputs an\n+If the alias does exist, then the \\f[CB]keytool\\f[R] command outputs an\n@@ -679,1 +663,1 @@\n-If \\f[V]-alias\\f[R] points to a key entry, then the \\f[V]keytool\\f[R]\n+If \\f[CB]\\-alias\\f[R] points to a key entry, then the \\f[CB]keytool\\f[R]\n@@ -683,2 +667,2 @@\n-\\f[V]-importpass\\f[R]\n-The following are the available options for the \\f[V]-importpass\\f[R]\n+.B \\f[CB]\\-importpass\\f[R]\n+The following are the available options for the \\f[CB]\\-importpass\\f[R]\n@@ -688,1 +672,1 @@\n-{\\f[V]-alias\\f[R] \\f[I]alias\\f[R]}: Alias name of the entry to process\n+{\\f[CB]\\-alias\\f[R] \\f[I]alias\\f[R]}: Alias name of the entry to process\n@@ -690,1 +674,1 @@\n-[\\f[V]-keypass\\f[R] \\f[I]arg\\f[R]]: Key password\n+[\\f[CB]\\-keypass\\f[R] \\f[I]arg\\f[R]]: Key password\n@@ -692,1 +676,1 @@\n-{\\f[V]-keyalg\\f[R] \\f[I]alg\\f[R]}: Key algorithm name\n+{\\f[CB]\\-keyalg\\f[R] \\f[I]alg\\f[R]}: Key algorithm name\n@@ -694,1 +678,1 @@\n-{\\f[V]-keysize\\f[R] \\f[I]size\\f[R]}: Key bit size\n+{\\f[CB]\\-keysize\\f[R] \\f[I]size\\f[R]}: Key bit size\n@@ -696,1 +680,1 @@\n-{\\f[V]-keystore\\f[R] \\f[I]keystore\\f[R]}: Keystore name\n+{\\f[CB]\\-keystore\\f[R] \\f[I]keystore\\f[R]}: Keystore name\n@@ -698,1 +682,1 @@\n-[\\f[V]-storepass\\f[R] \\f[I]arg\\f[R]]: Keystore password\n+[\\f[CB]\\-storepass\\f[R] \\f[I]arg\\f[R]]: Keystore password\n@@ -700,1 +684,1 @@\n-{\\f[V]-storetype\\f[R] \\f[I]type\\f[R]}: Keystore type\n+{\\f[CB]\\-storetype\\f[R] \\f[I]type\\f[R]}: Keystore type\n@@ -702,1 +686,1 @@\n-{\\f[V]-providername\\f[R] \\f[I]name\\f[R]}: Provider name\n+{\\f[CB]\\-providername\\f[R] \\f[I]name\\f[R]}: Provider name\n@@ -704,1 +688,1 @@\n-{\\f[V]-addprovider\\f[R] \\f[I]name\\f[R] [\\f[V]-providerarg\\f[R]\n+{\\f[CB]\\-addprovider\\f[R] \\f[I]name\\f[R] [\\f[CB]\\-providerarg\\f[R]\n@@ -708,3 +692,3 @@\n-{\\f[V]-providerclass\\f[R] \\f[I]class\\f[R] [\\f[V]-providerarg\\f[R]\n-\\f[I]arg\\f[R]]}: Add security provider by fully qualified class name\n-with an optional configure argument.\n+{\\f[CB]\\-providerclass\\f[R] \\f[I]class\\f[R] [\\f[CB]\\-providerarg\\f[R]\n+\\f[I]arg\\f[R]]}: Add security provider by fully qualified class name with\n+an optional configure argument.\n@@ -712,1 +696,1 @@\n-{\\f[V]-providerpath\\f[R] \\f[I]list\\f[R]}: Provider classpath\n+{\\f[CB]\\-providerpath\\f[R] \\f[I]list\\f[R]}: Provider classpath\n@@ -714,1 +698,1 @@\n-{\\f[V]-v\\f[R]}: Verbose output\n+{\\f[CB]\\-v\\f[R]}: Verbose output\n@@ -716,1 +700,1 @@\n-{\\f[V]-protected\\f[R]}: Password provided through a protected mechanism\n+{\\f[CB]\\-protected\\f[R]}: Password provided through a protected mechanism\n@@ -718,3 +702,3 @@\n-Use the \\f[V]-importpass\\f[R] command to imports a passphrase and store\n-it in a new \\f[V]KeyStore.SecretKeyEntry\\f[R] identified by\n-\\f[V]-alias\\f[R].\n+Use the \\f[CB]\\-importpass\\f[R] command to imports a passphrase and store\n+it in a new \\f[CB]KeyStore.SecretKeyEntry\\f[R] identified by\n+\\f[CB]\\-alias\\f[R].\n@@ -723,1 +707,1 @@\n-The \\f[V]-keypass\\f[R] option provides a password to protect the\n+The \\f[CB]\\-keypass\\f[R] option provides a password to protect the\n@@ -728,2 +712,2 @@\n-\\f[V]keystore\\f[R].\n-The \\f[V]-keypass\\f[R] value must contain at least six characters.\n+\\f[CB]keystore\\f[R].\n+The \\f[CB]\\-keypass\\f[R] value must contain at least six characters.\n@@ -733,1 +717,1 @@\n-\\f[V]-importkeystore\\f[R]\n+.B \\f[CB]\\-importkeystore\\f[R]\n@@ -735,1 +719,1 @@\n-\\f[V]-importkeystore\\f[R] command:\n+\\f[CB]\\-importkeystore\\f[R] command:\n@@ -738,1 +722,1 @@\n-\\f[V]-srckeystore\\f[R] \\f[I]keystore\\f[R]: Source keystore name\n+\\f[CB]\\-srckeystore\\f[R] \\f[I]keystore\\f[R]: Source keystore name\n@@ -740,1 +724,1 @@\n-{\\f[V]-destkeystore\\f[R] \\f[I]keystore\\f[R]}: Destination keystore name\n+{\\f[CB]\\-destkeystore\\f[R] \\f[I]keystore\\f[R]}: Destination keystore name\n@@ -742,1 +726,1 @@\n-{\\f[V]-srcstoretype\\f[R] \\f[I]type\\f[R]}: Source keystore type\n+{\\f[CB]\\-srcstoretype\\f[R] \\f[I]type\\f[R]}: Source keystore type\n@@ -744,1 +728,1 @@\n-{\\f[V]-deststoretype\\f[R] \\f[I]type\\f[R]}: Destination keystore type\n+{\\f[CB]\\-deststoretype\\f[R] \\f[I]type\\f[R]}: Destination keystore type\n@@ -746,1 +730,1 @@\n-[\\f[V]-srcstorepass\\f[R] \\f[I]arg\\f[R]]: Source keystore password\n+[\\f[CB]\\-srcstorepass\\f[R] \\f[I]arg\\f[R]]: Source keystore password\n@@ -748,1 +732,1 @@\n-[\\f[V]-deststorepass\\f[R] \\f[I]arg\\f[R]]: Destination keystore password\n+[\\f[CB]\\-deststorepass\\f[R] \\f[I]arg\\f[R]]: Destination keystore password\n@@ -750,1 +734,1 @@\n-{\\f[V]-srcprotected\\f[R]}: Source keystore password protected\n+{\\f[CB]\\-srcprotected\\f[R]}: Source keystore password protected\n@@ -752,1 +736,1 @@\n-{\\f[V]-destprotected\\f[R]}: Destination keystore password protected\n+{\\f[CB]\\-destprotected\\f[R]}: Destination keystore password protected\n@@ -754,1 +738,1 @@\n-{\\f[V]-srcprovidername\\f[R] \\f[I]name\\f[R]}: Source keystore provider\n+{\\f[CB]\\-srcprovidername\\f[R] \\f[I]name\\f[R]}: Source keystore provider\n@@ -757,1 +741,1 @@\n-{\\f[V]-destprovidername\\f[R] \\f[I]name\\f[R]}: Destination keystore\n+{\\f[CB]\\-destprovidername\\f[R] \\f[I]name\\f[R]}: Destination keystore\n@@ -760,1 +744,1 @@\n-{\\f[V]-srcalias\\f[R] \\f[I]alias\\f[R]}: Source alias\n+{\\f[CB]\\-srcalias\\f[R] \\f[I]alias\\f[R]}: Source alias\n@@ -762,1 +746,1 @@\n-{\\f[V]-destalias\\f[R] \\f[I]alias\\f[R]}: Destination alias\n+{\\f[CB]\\-destalias\\f[R] \\f[I]alias\\f[R]}: Destination alias\n@@ -764,1 +748,1 @@\n-[\\f[V]-srckeypass\\f[R] \\f[I]arg\\f[R]]: Source key password\n+[\\f[CB]\\-srckeypass\\f[R] \\f[I]arg\\f[R]]: Source key password\n@@ -766,1 +750,1 @@\n-[\\f[V]-destkeypass\\f[R] \\f[I]arg\\f[R]]: Destination key password\n+[\\f[CB]\\-destkeypass\\f[R] \\f[I]arg\\f[R]]: Destination key password\n@@ -768,1 +752,1 @@\n-{\\f[V]-noprompt\\f[R]}: Do not prompt\n+{\\f[CB]\\-noprompt\\f[R]}: Do not prompt\n@@ -770,3 +754,3 @@\n-{\\f[V]-addprovider\\f[R] \\f[I]name\\f[R] [\\f[V]-providerarg\\f[R]\n-\\f[I]arg\\f[R]]: Add security provider by name (such as SunPKCS11) with\n-an optional configure argument.\n+{\\f[CB]\\-addprovider\\f[R] \\f[I]name\\f[R] [\\f[CB]\\-providerarg\\f[R]\n+\\f[I]arg\\f[R]]: Add security provider by name (such as SunPKCS11) with an\n+optional configure argument.\n@@ -774,3 +758,3 @@\n-{\\f[V]-providerclass\\f[R] \\f[I]class\\f[R] [\\f[V]-providerarg\\f[R]\n-\\f[I]arg\\f[R]]}: Add security provider by fully qualified class name\n-with an optional configure argument\n+{\\f[CB]\\-providerclass\\f[R] \\f[I]class\\f[R] [\\f[CB]\\-providerarg\\f[R]\n+\\f[I]arg\\f[R]]}: Add security provider by fully qualified class name with\n+an optional configure argument\n@@ -778,1 +762,1 @@\n-{\\f[V]-providerpath\\f[R] \\f[I]list\\f[R]}: Provider classpath\n+{\\f[CB]\\-providerpath\\f[R] \\f[I]list\\f[R]}: Provider classpath\n@@ -780,1 +764,1 @@\n-{\\f[V]-v\\f[R]}: Verbose output\n+{\\f[CB]\\-v\\f[R]}: Verbose output\n@@ -787,1 +771,1 @@\n-\\f[V]-srckeystore\\f[R] \\f[I]keystore\\f[R] \\f[V]-destkeystore\\f[R]\n+\\f[CB]\\-srckeystore\\f[R] \\f[I]keystore\\f[R] \\f[CB]\\-destkeystore\\f[R]\n@@ -791,1 +775,1 @@\n-Use the \\f[V]-importkeystore\\f[R] command to import a single entry or\n+Use the \\f[CB]\\-importkeystore\\f[R] command to import a single entry or\n@@ -796,3 +780,3 @@\n-If you do not specify \\f[V]-destkeystore\\f[R] when using the\n-\\f[V]keytool -importkeystore\\f[R] command, then the default keystore\n-used is \\f[V]$HOME\/.keystore\\f[R].\n+If you do not specify \\f[CB]\\-destkeystore\\f[R] when using the\n+\\f[CB]keytool\\ \\-importkeystore\\f[R] command, then the default keystore\n+used is \\f[CB]$HOME\/.keystore\\f[R].\n@@ -800,1 +784,1 @@\n-When the \\f[V]-srcalias\\f[R] option is provided, the command imports the\n+When the \\f[CB]\\-srcalias\\f[R] option is provided, the command imports the\n@@ -802,2 +786,2 @@\n-If a destination alias isn\\[aq]t provided with \\f[V]-destalias\\f[R],\n-then \\f[V]-srcalias\\f[R] is used as the destination alias.\n+If a destination alias isn\\[aq]t provided with \\f[CB]\\-destalias\\f[R],\n+then \\f[CB]\\-srcalias\\f[R] is used as the destination alias.\n@@ -805,4 +789,4 @@\n-\\f[V]-srckeypass\\f[R] is used to recover the entry.\n-If \\f[V]-srckeypass\\f[R] isn\\[aq]t provided, then the \\f[V]keytool\\f[R]\n-command attempts to use \\f[V]-srcstorepass\\f[R] to recover the entry.\n-If \\f[V]-srcstorepass\\f[R] is not provided or is incorrect, then the\n+\\f[CB]\\-srckeypass\\f[R] is used to recover the entry.\n+If \\f[CB]\\-srckeypass\\f[R] isn\\[aq]t provided, then the \\f[CB]keytool\\f[R]\n+command attempts to use \\f[CB]\\-srcstorepass\\f[R] to recover the entry.\n+If \\f[CB]\\-srcstorepass\\f[R] is not provided or is incorrect, then the\n@@ -810,2 +794,2 @@\n-The destination entry is protected with \\f[V]-destkeypass\\f[R].\n-If \\f[V]-destkeypass\\f[R] isn\\[aq]t provided, then the destination entry\n+The destination entry is protected with \\f[CB]\\-destkeypass\\f[R].\n+If \\f[CB]\\-destkeypass\\f[R] isn\\[aq]t provided, then the destination entry\n@@ -813,2 +797,2 @@\n-For example, most third-party tools require \\f[V]storepass\\f[R] and\n-\\f[V]keypass\\f[R] in a PKCS #12 keystore to be the same.\n+For example, most third\\-party tools require \\f[CB]storepass\\f[R] and\n+\\f[CB]keypass\\f[R] in a PKCS #12 keystore to be the same.\n@@ -816,1 +800,1 @@\n-\\f[V]-destkeypass\\f[R] that is the same as \\f[V]-deststorepass\\f[R].\n+\\f[CB]\\-destkeypass\\f[R] that is the same as \\f[CB]\\-deststorepass\\f[R].\n@@ -818,1 +802,1 @@\n-If the \\f[V]-srcalias\\f[R] option isn\\[aq]t provided, then all entries\n+If the \\f[CB]\\-srcalias\\f[R] option isn\\[aq]t provided, then all entries\n@@ -822,2 +806,2 @@\n-\\f[V]-srcstorepass\\f[R] is used to recover the entry.\n-If \\f[V]-srcstorepass\\f[R] is not provided or is incorrect, then the\n+\\f[CB]\\-srcstorepass\\f[R] is used to recover the entry.\n+If \\f[CB]\\-srcstorepass\\f[R] is not provided or is incorrect, then the\n@@ -835,1 +819,1 @@\n-If the \\f[V]-noprompt\\f[R] option is provided, then the user isn\\[aq]t\n+If the \\f[CB]\\-noprompt\\f[R] option is provided, then the user isn\\[aq]t\n@@ -843,2 +827,2 @@\n-\\f[V]-certreq\\f[R]\n-The following are the available options for the \\f[V]-certreq\\f[R]\n+.B \\f[CB]\\-certreq\\f[R]\n+The following are the available options for the \\f[CB]\\-certreq\\f[R]\n@@ -848,1 +832,1 @@\n-{\\f[V]-alias\\f[R] \\f[I]alias\\f[R]}: Alias name of the entry to process\n+{\\f[CB]\\-alias\\f[R] \\f[I]alias\\f[R]}: Alias name of the entry to process\n@@ -850,1 +834,1 @@\n-{\\f[V]-sigalg\\f[R] \\f[I]alg\\f[R]}: Signature algorithm name\n+{\\f[CB]\\-sigalg\\f[R] \\f[I]alg\\f[R]}: Signature algorithm name\n@@ -852,1 +836,1 @@\n-{\\f[V]-file\\f[R] \\f[I]file\\f[R]}: Output file name\n+{\\f[CB]\\-file\\f[R] \\f[I]file\\f[R]}: Output file name\n@@ -854,1 +838,1 @@\n-[ \\f[V]-keypass\\f[R] \\f[I]arg\\f[R]]: Key password\n+[ \\f[CB]\\-keypass\\f[R] \\f[I]arg\\f[R]]: Key password\n@@ -856,1 +840,1 @@\n-{\\f[V]-keystore\\f[R] \\f[I]keystore\\f[R]}: Keystore name\n+{\\f[CB]\\-keystore\\f[R] \\f[I]keystore\\f[R]}: Keystore name\n@@ -858,1 +842,1 @@\n-{\\f[V]-dname\\f[R] \\f[I]name\\f[R]}: Distinguished name\n+{\\f[CB]\\-dname\\f[R] \\f[I]name\\f[R]}: Distinguished name\n@@ -860,1 +844,1 @@\n-{\\f[V]-ext\\f[R] \\f[I]value\\f[R]}: X.509 extension\n+{\\f[CB]\\-ext\\f[R] \\f[I]value\\f[R]}: X.509 extension\n@@ -862,1 +846,1 @@\n-[\\f[V]-storepass\\f[R] \\f[I]arg\\f[R]]: Keystore password\n+[\\f[CB]\\-storepass\\f[R] \\f[I]arg\\f[R]]: Keystore password\n@@ -864,1 +848,1 @@\n-{\\f[V]-storetype\\f[R] \\f[I]type\\f[R]}: Keystore type\n+{\\f[CB]\\-storetype\\f[R] \\f[I]type\\f[R]}: Keystore type\n@@ -866,1 +850,1 @@\n-{\\f[V]-providername\\f[R] \\f[I]name\\f[R]}: Provider name\n+{\\f[CB]\\-providername\\f[R] \\f[I]name\\f[R]}: Provider name\n@@ -868,1 +852,1 @@\n-{\\f[V]-addprovider\\f[R] \\f[I]name\\f[R] [\\f[V]-providerarg\\f[R]\n+{\\f[CB]\\-addprovider\\f[R] \\f[I]name\\f[R] [\\f[CB]\\-providerarg\\f[R]\n@@ -872,3 +856,3 @@\n-{\\f[V]-providerclass\\f[R] \\f[I]class\\f[R] [\\f[V]-providerarg\\f[R]\n-\\f[I]arg\\f[R]]}: Add security provider by fully qualified class name\n-with an optional configure argument.\n+{\\f[CB]\\-providerclass\\f[R] \\f[I]class\\f[R] [\\f[CB]\\-providerarg\\f[R]\n+\\f[I]arg\\f[R]]}: Add security provider by fully qualified class name with\n+an optional configure argument.\n@@ -876,1 +860,1 @@\n-{\\f[V]-providerpath\\f[R] \\f[I]list\\f[R]}: Provider classpath\n+{\\f[CB]\\-providerpath\\f[R] \\f[I]list\\f[R]}: Provider classpath\n@@ -878,1 +862,1 @@\n-{\\f[V]-v\\f[R]}: Verbose output\n+{\\f[CB]\\-v\\f[R]}: Verbose output\n@@ -880,1 +864,1 @@\n-{\\f[V]-protected\\f[R]}: Password provided through a protected mechanism\n+{\\f[CB]\\-protected\\f[R]}: Password provided through a protected mechanism\n@@ -882,1 +866,1 @@\n-Use the \\f[V]-certreq\\f[R] command to generate a Certificate Signing\n+Use the \\f[CB]\\-certreq\\f[R] command to generate a Certificate Signing\n@@ -888,1 +872,2 @@\n-certificate chain (initially a self-signed certificate) in the keystore.\n+certificate chain (initially a self\\-signed certificate) in the\n+keystore.\n@@ -893,1 +878,1 @@\n-If \\f[V]-keypass\\f[R] isn\\[aq]t provided at the command line and is\n+If \\f[CB]\\-keypass\\f[R] isn\\[aq]t provided at the command line and is\n@@ -896,1 +881,1 @@\n-If \\f[V]-dname\\f[R] is provided, then it is used as the subject in the\n+If \\f[CB]\\-dname\\f[R] is provided, then it is used as the subject in the\n@@ -900,1 +885,1 @@\n-The \\f[V]-sigalg\\f[R] value specifies the algorithm that should be used\n+The \\f[CB]\\-sigalg\\f[R] value specifies the algorithm that should be used\n@@ -903,2 +888,2 @@\n-The CSR is stored in the \\f[V]-file\\f[R] \\f[I]file\\f[R].\n-If a file is not specified, then the CSR is output to \\f[V]-stdout\\f[R].\n+The CSR is stored in the \\f[CB]\\-file\\f[R] \\f[I]file\\f[R].\n+If a file is not specified, then the CSR is output to \\f[CB]\\-stdout\\f[R].\n@@ -906,1 +891,1 @@\n-Use the \\f[V]-importcert\\f[R] command to import the response from the\n+Use the \\f[CB]\\-importcert\\f[R] command to import the response from the\n@@ -911,2 +896,2 @@\n-\\f[V]-exportcert\\f[R]\n-The following are the available options for the \\f[V]-exportcert\\f[R]\n+.B \\f[CB]\\-exportcert\\f[R]\n+The following are the available options for the \\f[CB]\\-exportcert\\f[R]\n@@ -916,1 +901,1 @@\n-{\\f[V]-rfc\\f[R]}: Output in RFC style\n+{\\f[CB]\\-rfc\\f[R]}: Output in RFC style\n@@ -918,1 +903,1 @@\n-{\\f[V]-alias\\f[R] \\f[I]alias\\f[R]}: Alias name of the entry to process\n+{\\f[CB]\\-alias\\f[R] \\f[I]alias\\f[R]}: Alias name of the entry to process\n@@ -920,1 +905,1 @@\n-{\\f[V]-file\\f[R] \\f[I]file\\f[R]}: Output file name\n+{\\f[CB]\\-file\\f[R] \\f[I]file\\f[R]}: Output file name\n@@ -922,1 +907,1 @@\n-{\\f[V]-keystore\\f[R] \\f[I]keystore\\f[R]}: Keystore name\n+{\\f[CB]\\-keystore\\f[R] \\f[I]keystore\\f[R]}: Keystore name\n@@ -924,1 +909,1 @@\n-{\\f[V]-cacerts\\f[R]}: Access the cacerts keystore\n+{\\f[CB]\\-cacerts\\f[R]}: Access the cacerts keystore\n@@ -926,1 +911,1 @@\n-[\\f[V]-storepass\\f[R] \\f[I]arg\\f[R]]: Keystore password\n+[\\f[CB]\\-storepass\\f[R] \\f[I]arg\\f[R]]: Keystore password\n@@ -928,1 +913,1 @@\n-{\\f[V]-storetype\\f[R] \\f[I]type\\f[R]}: Keystore type\n+{\\f[CB]\\-storetype\\f[R] \\f[I]type\\f[R]}: Keystore type\n@@ -930,1 +915,1 @@\n-{\\f[V]-providername\\f[R] \\f[I]name\\f[R]}: Provider name\n+{\\f[CB]\\-providername\\f[R] \\f[I]name\\f[R]}: Provider name\n@@ -932,1 +917,1 @@\n-{\\f[V]-addprovider\\f[R] \\f[I]name\\f[R] [\\f[V]-providerarg\\f[R]\n+{\\f[CB]\\-addprovider\\f[R] \\f[I]name\\f[R] [\\f[CB]\\-providerarg\\f[R]\n@@ -936,1 +921,1 @@\n-{\\f[V]-providerclass\\f[R] \\f[I]class\\f[R] [\\f[V]-providerarg\\f[R]\n+{\\f[CB]\\-providerclass\\f[R] \\f[I]class\\f[R] [\\f[CB]\\-providerarg\\f[R]\n@@ -940,1 +925,1 @@\n-{\\f[V]-providerpath\\f[R] \\f[I]list\\f[R]}: Provider classpath\n+{\\f[CB]\\-providerpath\\f[R] \\f[I]list\\f[R]}: Provider classpath\n@@ -942,1 +927,1 @@\n-{\\f[V]-v\\f[R]}: Verbose output\n+{\\f[CB]\\-v\\f[R]}: Verbose output\n@@ -944,1 +929,1 @@\n-{\\f[V]-protected\\f[R]}: Password provided through a protected mechanism\n+{\\f[CB]\\-protected\\f[R]}: Password provided through a protected mechanism\n@@ -946,3 +931,3 @@\n-Use the \\f[V]-exportcert\\f[R] command to read a certificate from the\n-keystore that is associated with \\f[V]-alias\\f[R] \\f[I]alias\\f[R] and\n-store it in the \\f[V]-file\\f[R] \\f[I]file\\f[R].\n+Use the \\f[CB]\\-exportcert\\f[R] command to read a certificate from the\n+keystore that is associated with \\f[CB]\\-alias\\f[R] \\f[I]alias\\f[R] and\n+store it in the \\f[CB]\\-file\\f[R] \\f[I]file\\f[R].\n@@ -950,1 +935,1 @@\n-\\f[V]stdout\\f[R].\n+\\f[CB]stdout\\f[R].\n@@ -953,1 +938,1 @@\n-If the \\f[V]-rfc\\f[R] option is specified, then the output in the\n+If the \\f[CB]\\-rfc\\f[R] option is specified, then the output in the\n@@ -957,1 +942,1 @@\n-If \\f[V]-alias\\f[R] refers to a trusted certificate, then that\n+If \\f[CB]\\-alias\\f[R] refers to a trusted certificate, then that\n@@ -959,1 +944,1 @@\n-Otherwise, \\f[V]-alias\\f[R] refers to a key entry with an associated\n+Otherwise, \\f[CB]\\-alias\\f[R] refers to a key entry with an associated\n@@ -963,1 +948,1 @@\n-\\f[V]-alias\\f[R].\n+\\f[CB]\\-alias\\f[R].\n@@ -967,2 +952,2 @@\n-\\f[V]-list\\f[R]\n-The following are the available options for the \\f[V]-list\\f[R] command:\n+.B \\f[CB]\\-list\\f[R]\n+The following are the available options for the \\f[CB]\\-list\\f[R] command:\n@@ -971,1 +956,1 @@\n-{\\f[V]-rfc\\f[R]}: Output in RFC style\n+{\\f[CB]\\-rfc\\f[R]}: Output in RFC style\n@@ -973,1 +958,1 @@\n-{\\f[V]-alias\\f[R] \\f[I]alias\\f[R]}: Alias name of the entry to process\n+{\\f[CB]\\-alias\\f[R] \\f[I]alias\\f[R]}: Alias name of the entry to process\n@@ -975,1 +960,1 @@\n-{\\f[V]-keystore\\f[R] \\f[I]keystore\\f[R]}: Keystore name\n+{\\f[CB]\\-keystore\\f[R] \\f[I]keystore\\f[R]}: Keystore name\n@@ -977,1 +962,1 @@\n-{\\f[V]-cacerts\\f[R]}: Access the cacerts keystore\n+{\\f[CB]\\-cacerts\\f[R]}: Access the cacerts keystore\n@@ -979,1 +964,1 @@\n-[\\f[V]-storepass\\f[R] \\f[I]arg\\f[R]]: Keystore password\n+[\\f[CB]\\-storepass\\f[R] \\f[I]arg\\f[R]]: Keystore password\n@@ -981,1 +966,1 @@\n-{\\f[V]-storetype\\f[R] \\f[I]type\\f[R]}: Keystore type\n+{\\f[CB]\\-storetype\\f[R] \\f[I]type\\f[R]}: Keystore type\n@@ -983,1 +968,1 @@\n-{\\f[V]-providername\\f[R] \\f[I]name\\f[R]}: Provider name\n+{\\f[CB]\\-providername\\f[R] \\f[I]name\\f[R]}: Provider name\n@@ -985,1 +970,1 @@\n-{\\f[V]-addprovider\\f[R] \\f[I]name\\f[R] [\\f[V]-providerarg\\f[R]\n+{\\f[CB]\\-addprovider\\f[R] \\f[I]name\\f[R] [\\f[CB]\\-providerarg\\f[R]\n@@ -989,1 +974,1 @@\n-{\\f[V]-providerclass\\f[R] \\f[I]class\\f[R] [\\f[V]-providerarg\\f[R]\n+{\\f[CB]\\-providerclass\\f[R] \\f[I]class\\f[R] [\\f[CB]\\-providerarg\\f[R]\n@@ -993,1 +978,1 @@\n-{\\f[V]-providerpath\\f[R] \\f[I]list\\f[R]}: Provider classpath\n+{\\f[CB]\\-providerpath\\f[R] \\f[I]list\\f[R]}: Provider classpath\n@@ -995,1 +980,1 @@\n-{\\f[V]-v\\f[R]}: Verbose output\n+{\\f[CB]\\-v\\f[R]}: Verbose output\n@@ -997,1 +982,1 @@\n-{\\f[V]-protected\\f[R]}: Password provided through a protected mechanism\n+{\\f[CB]\\-protected\\f[R]}: Password provided through a protected mechanism\n@@ -999,3 +984,3 @@\n-Use the \\f[V]-list\\f[R] command to print the contents of the keystore\n-entry identified by \\f[V]-alias\\f[R] to \\f[V]stdout\\f[R].\n-If \\f[V]-alias\\f[R] \\f[I]alias\\f[R] is not specified, then the contents\n+Use the \\f[CB]\\-list\\f[R] command to print the contents of the keystore\n+entry identified by \\f[CB]\\-alias\\f[R] to \\f[CB]stdout\\f[R].\n+If \\f[CB]\\-alias\\f[R] \\f[I]alias\\f[R] is not specified, then the contents\n@@ -1004,1 +989,1 @@\n-By default, this command prints the SHA-256 fingerprint of a\n+By default, this command prints the SHA\\-256 fingerprint of a\n@@ -1006,4 +991,4 @@\n-If the \\f[V]-v\\f[R] option is specified, then the certificate is printed\n-in human-readable format, with additional information such as the owner,\n-issuer, serial number, and any extensions.\n-If the \\f[V]-rfc\\f[R] option is specified, then the certificate contents\n+If the \\f[CB]\\-v\\f[R] option is specified, then the certificate is printed\n+in human\\-readable format, with additional information such as the\n+owner, issuer, serial number, and any extensions.\n+If the \\f[CB]\\-rfc\\f[R] option is specified, then the certificate contents\n@@ -1015,1 +1000,1 @@\n-You can\\[aq]t specify both \\f[V]-v\\f[R] and \\f[V]-rfc\\f[R] in the same\n+You can\\[aq]t specify both \\f[CB]\\-v\\f[R] and \\f[CB]\\-rfc\\f[R] in the same\n@@ -1020,2 +1005,2 @@\n-\\f[V]-printcert\\f[R]\n-The following are the available options for the \\f[V]-printcert\\f[R]\n+.B \\f[CB]\\-printcert\\f[R]\n+The following are the available options for the \\f[CB]\\-printcert\\f[R]\n@@ -1025,1 +1010,1 @@\n-{\\f[V]-rfc\\f[R]}: Output in RFC style\n+{\\f[CB]\\-rfc\\f[R]}: Output in RFC style\n@@ -1027,1 +1012,1 @@\n-{\\f[V]-file\\f[R] \\f[I]cert_file\\f[R]}: Input file name\n+{\\f[CB]\\-file\\f[R] \\f[I]cert_file\\f[R]}: Input file name\n@@ -1029,2 +1014,2 @@\n-{\\f[V]-sslserver\\f[R] \\f[I]server\\f[R][\\f[V]:\\f[R]\\f[I]port\\f[R]]}::\n-Secure Sockets Layer (SSL) server host and port\n+{\\f[CB]\\-sslserver\\f[R] \\f[I]server\\f[R][\\f[CB]:\\f[R]\\f[I]port\\f[R]]}:: Secure\n+Sockets Layer (SSL) server host and port\n@@ -1032,1 +1017,1 @@\n-{\\f[V]-jarfile\\f[R] \\f[I]JAR_file\\f[R]}: Signed \\f[V].jar\\f[R] file\n+{\\f[CB]\\-jarfile\\f[R] \\f[I]JAR_file\\f[R]}: Signed \\f[CB]\\&.jar\\f[R] file\n@@ -1034,1 +1019,1 @@\n-{\\f[V]-keystore\\f[R] \\f[I]keystore\\f[R]}: Keystore name\n+{\\f[CB]\\-keystore\\f[R] \\f[I]keystore\\f[R]}: Keystore name\n@@ -1036,1 +1021,1 @@\n-{\\f[V]-trustcacerts\\f[R]}: Trust certificates from cacerts\n+{\\f[CB]\\-trustcacerts\\f[R]}: Trust certificates from cacerts\n@@ -1038,1 +1023,1 @@\n-[\\f[V]-storepass\\f[R] \\f[I]arg\\f[R]]: Keystore password\n+[\\f[CB]\\-storepass\\f[R] \\f[I]arg\\f[R]]: Keystore password\n@@ -1040,1 +1025,1 @@\n-{\\f[V]-storetype\\f[R] \\f[I]type\\f[R]}: Keystore type\n+{\\f[CB]\\-storetype\\f[R] \\f[I]type\\f[R]}: Keystore type\n@@ -1042,1 +1027,1 @@\n-{\\f[V]-providername\\f[R] \\f[I]name\\f[R]}: Provider name\n+{\\f[CB]\\-providername\\f[R] \\f[I]name\\f[R]}: Provider name\n@@ -1044,1 +1029,1 @@\n-{\\f[V]-addprovider\\f[R] \\f[I]name\\f[R] [\\f[V]-providerarg\\f[R]\n+{\\f[CB]\\-addprovider\\f[R] \\f[I]name\\f[R] [\\f[CB]\\-providerarg\\f[R]\n@@ -1048,3 +1033,3 @@\n-{\\f[V]-providerclass\\f[R] \\f[I]class\\f[R] [\\f[V]-providerarg\\f[R]\n-\\f[I]arg\\f[R]]}: Add security provider by fully qualified class name\n-with an optional configure argument.\n+{\\f[CB]\\-providerclass\\f[R] \\f[I]class\\f[R] [\\f[CB]\\-providerarg\\f[R]\n+\\f[I]arg\\f[R]]}: Add security provider by fully qualified class name with\n+an optional configure argument.\n@@ -1052,1 +1037,1 @@\n-{\\f[V]-providerpath\\f[R] \\f[I]list\\f[R]}: Provider classpath\n+{\\f[CB]\\-providerpath\\f[R] \\f[I]list\\f[R]}: Provider classpath\n@@ -1054,1 +1039,1 @@\n-{\\f[V]-protected\\f[R]}: Password is provided through protected mechanism\n+{\\f[CB]\\-protected\\f[R]}: Password is provided through protected mechanism\n@@ -1056,1 +1041,1 @@\n-{\\f[V]-v\\f[R]}: Verbose output\n+{\\f[CB]\\-v\\f[R]}: Verbose output\n@@ -1058,5 +1043,5 @@\n-Use the \\f[V]-printcert\\f[R] command to read and print the certificate\n-from \\f[V]-file\\f[R] \\f[I]cert_file\\f[R], the SSL server located at\n-\\f[V]-sslserver\\f[R] \\f[I]server\\f[R][\\f[V]:\\f[R]\\f[I]port\\f[R]], or the\n-signed JAR file specified by \\f[V]-jarfile\\f[R] \\f[I]JAR_file\\f[R].\n-It prints its contents in a human-readable format.\n+Use the \\f[CB]\\-printcert\\f[R] command to read and print the certificate\n+from \\f[CB]\\-file\\f[R] \\f[I]cert_file\\f[R], the SSL server located at\n+\\f[CB]\\-sslserver\\f[R] \\f[I]server\\f[R][\\f[CB]:\\f[R]\\f[I]port\\f[R]], or the\n+signed JAR file specified by \\f[CB]\\-jarfile\\f[R] \\f[I]JAR_file\\f[R].\n+It prints its contents in a human\\-readable format.\n@@ -1067,1 +1052,1 @@\n-The \\f[V]-sslserver\\f[R] and \\f[V]-file\\f[R] options can\\[aq]t be\n+The \\f[CB]\\-sslserver\\f[R] and \\f[CB]\\-file\\f[R] options can\\[aq]t be\n@@ -1071,1 +1056,1 @@\n-from \\f[V]stdin\\f[R].\n+from \\f[CB]stdin\\f[R].\n@@ -1073,3 +1058,3 @@\n-When\\f[V]-rfc\\f[R] is specified, the \\f[V]keytool\\f[R] command prints\n-the certificate in PEM mode as defined by the Internet RFC 1421\n-Certificate Encoding standard.\n+When\\f[CB]\\-rfc\\f[R] is specified, the \\f[CB]keytool\\f[R] command prints the\n+certificate in PEM mode as defined by the Internet RFC 1421 Certificate\n+Encoding standard.\n@@ -1077,1 +1062,1 @@\n-If the certificate is read from a file or \\f[V]stdin\\f[R], then it might\n+If the certificate is read from a file or \\f[CB]stdin\\f[R], then it might\n@@ -1082,2 +1067,2 @@\n-\\f[V]-J-Dhttps.proxyHost=proxyhost\\f[R] and\n-\\f[V]-J-Dhttps.proxyPort=proxyport\\f[R] options can be specified on the\n+\\f[CB]\\-J\\-Dhttps.proxyHost=proxyhost\\f[R] and\n+\\f[CB]\\-J\\-Dhttps.proxyPort=proxyport\\f[R] options can be specified on the\n@@ -1091,2 +1076,2 @@\n-(specified by \\f[V]-keystore\\f[R]) or in the \\f[V]cacerts\\f[R] keystore\n-(if \\f[V]-trustcacerts\\f[R] is specified).\n+(specified by \\f[CB]\\-keystore\\f[R]) or in the \\f[CB]cacerts\\f[R] keystore\n+(if \\f[CB]\\-trustcacerts\\f[R] is specified).\n@@ -1095,2 +1080,2 @@\n-\\f[V]-printcertreq\\f[R]\n-The following are the available options for the \\f[V]-printcertreq\\f[R]\n+.B \\f[CB]\\-printcertreq\\f[R]\n+The following are the available options for the \\f[CB]\\-printcertreq\\f[R]\n@@ -1100,1 +1085,1 @@\n-{\\f[V]-file\\f[R] \\f[I]file\\f[R]}: Input file name\n+{\\f[CB]\\-file\\f[R] \\f[I]file\\f[R]}: Input file name\n@@ -1102,1 +1087,1 @@\n-{\\f[V]-v\\f[R]}: Verbose output\n+{\\f[CB]\\-v\\f[R]}: Verbose output\n@@ -1104,1 +1089,1 @@\n-Use the \\f[V]-printcertreq\\f[R] command to print the contents of a PKCS\n+Use the \\f[CB]\\-printcertreq\\f[R] command to print the contents of a PKCS\n@@ -1106,1 +1091,1 @@\n-\\f[V]keytool -certreq\\f[R] command.\n+\\f[CB]keytool\\ \\-certreq\\f[R] command.\n@@ -1111,2 +1096,2 @@\n-\\f[V]-printcrl\\f[R]\n-The following are the available options for the \\f[V]-printcrl\\f[R]\n+.B \\f[CB]\\-printcrl\\f[R]\n+The following are the available options for the \\f[CB]\\-printcrl\\f[R]\n@@ -1116,1 +1101,1 @@\n-{\\f[V]-file crl\\f[R]}: Input file name\n+{\\f[CB]\\-file\\ crl\\f[R]}: Input file name\n@@ -1118,1 +1103,1 @@\n-{\\f[V]-keystore\\f[R] \\f[I]keystore\\f[R]}: Keystore name\n+{\\f[CB]\\-keystore\\f[R] \\f[I]keystore\\f[R]}: Keystore name\n@@ -1120,1 +1105,1 @@\n-{\\f[V]-trustcacerts\\f[R]}: Trust certificates from cacerts\n+{\\f[CB]\\-trustcacerts\\f[R]}: Trust certificates from cacerts\n@@ -1122,1 +1107,1 @@\n-[\\f[V]-storepass\\f[R] \\f[I]arg\\f[R]]: Keystore password\n+[\\f[CB]\\-storepass\\f[R] \\f[I]arg\\f[R]]: Keystore password\n@@ -1124,1 +1109,1 @@\n-{\\f[V]-storetype\\f[R] \\f[I]type\\f[R]}: Keystore type\n+{\\f[CB]\\-storetype\\f[R] \\f[I]type\\f[R]}: Keystore type\n@@ -1126,1 +1111,1 @@\n-{\\f[V]-providername\\f[R] \\f[I]name\\f[R]}: Provider name\n+{\\f[CB]\\-providername\\f[R] \\f[I]name\\f[R]}: Provider name\n@@ -1128,1 +1113,1 @@\n-{\\f[V]-addprovider\\f[R] \\f[I]name\\f[R] [\\f[V]-providerarg\\f[R]\n+{\\f[CB]\\-addprovider\\f[R] \\f[I]name\\f[R] [\\f[CB]\\-providerarg\\f[R]\n@@ -1132,3 +1117,3 @@\n-{\\f[V]-providerclass\\f[R] \\f[I]class\\f[R] [\\f[V]-providerarg\\f[R]\n-\\f[I]arg\\f[R]]}: Add security provider by fully qualified class name\n-with an optional configure argument.\n+{\\f[CB]\\-providerclass\\f[R] \\f[I]class\\f[R] [\\f[CB]\\-providerarg\\f[R]\n+\\f[I]arg\\f[R]]}: Add security provider by fully qualified class name with\n+an optional configure argument.\n@@ -1136,1 +1121,1 @@\n-{\\f[V]-providerpath\\f[R] \\f[I]list\\f[R]}: Provider classpath\n+{\\f[CB]\\-providerpath\\f[R] \\f[I]list\\f[R]}: Provider classpath\n@@ -1138,1 +1123,1 @@\n-{\\f[V]-protected\\f[R]}: Password is provided through protected mechanism\n+{\\f[CB]\\-protected\\f[R]}: Password is provided through protected mechanism\n@@ -1140,1 +1125,1 @@\n-{\\f[V]-v\\f[R]}: Verbose output\n+{\\f[CB]\\-v\\f[R]}: Verbose output\n@@ -1142,2 +1127,2 @@\n-Use the \\f[V]-printcrl\\f[R] command to read the Certificate Revocation\n-List (CRL) from \\f[V]-file crl\\f[R] .\n+Use the \\f[CB]\\-printcrl\\f[R] command to read the Certificate Revocation\n+List (CRL) from \\f[CB]\\-file\\ crl\\f[R] .\n@@ -1146,1 +1131,1 @@\n-The CA generates the \\f[V]crl\\f[R] file.\n+The CA generates the \\f[CB]crl\\f[R] file.\n@@ -1152,3 +1137,3 @@\n-user keystore (specified by \\f[V]-keystore\\f[R]) or the\n-\\f[V]cacerts\\f[R] keystore (if \\f[V]-trustcacerts\\f[R] is specified),\n-and will print out a warning if it cannot be verified.\n+user keystore (specified by \\f[CB]\\-keystore\\f[R]) or the \\f[CB]cacerts\\f[R]\n+keystore (if \\f[CB]\\-trustcacerts\\f[R] is specified), and will print out a\n+warning if it cannot be verified.\n@@ -1158,2 +1143,2 @@\n-\\f[V]-storepasswd\\f[R]\n-The following are the available options for the \\f[V]-storepasswd\\f[R]\n+.B \\f[CB]\\-storepasswd\\f[R]\n+The following are the available options for the \\f[CB]\\-storepasswd\\f[R]\n@@ -1163,1 +1148,1 @@\n-[\\f[V]-new\\f[R] \\f[I]arg\\f[R]]: New password\n+[\\f[CB]\\-new\\f[R] \\f[I]arg\\f[R]]: New password\n@@ -1165,1 +1150,1 @@\n-{\\f[V]-keystore\\f[R] \\f[I]keystore\\f[R]}: Keystore name\n+{\\f[CB]\\-keystore\\f[R] \\f[I]keystore\\f[R]}: Keystore name\n@@ -1167,1 +1152,1 @@\n-{\\f[V]-cacerts\\f[R]}: Access the cacerts keystore\n+{\\f[CB]\\-cacerts\\f[R]}: Access the cacerts keystore\n@@ -1169,1 +1154,1 @@\n-[\\f[V]-storepass\\f[R] \\f[I]arg\\f[R]]: Keystore password\n+[\\f[CB]\\-storepass\\f[R] \\f[I]arg\\f[R]]: Keystore password\n@@ -1171,1 +1156,1 @@\n-{\\f[V]-storetype\\f[R] \\f[I]type\\f[R]}: Keystore type\n+{\\f[CB]\\-storetype\\f[R] \\f[I]type\\f[R]}: Keystore type\n@@ -1173,1 +1158,1 @@\n-{\\f[V]-providername\\f[R] \\f[I]name\\f[R]}: Provider name\n+{\\f[CB]\\-providername\\f[R] \\f[I]name\\f[R]}: Provider name\n@@ -1175,1 +1160,1 @@\n-{\\f[V]-addprovider\\f[R] \\f[I]name\\f[R] [\\f[V]-providerarg\\f[R]\n+{\\f[CB]\\-addprovider\\f[R] \\f[I]name\\f[R] [\\f[CB]\\-providerarg\\f[R]\n@@ -1179,3 +1164,3 @@\n-{\\f[V]-providerclass\\f[R] \\f[I]class\\f[R] [\\f[V]-providerarg\\f[R]\n-\\f[I]arg\\f[R]]}: Add security provider by fully qualified class name\n-with an optional configure argument.\n+{\\f[CB]\\-providerclass\\f[R] \\f[I]class\\f[R] [\\f[CB]\\-providerarg\\f[R]\n+\\f[I]arg\\f[R]]}: Add security provider by fully qualified class name with\n+an optional configure argument.\n@@ -1183,1 +1168,1 @@\n-{\\f[V]-providerpath\\f[R] \\f[I]list\\f[R]}: Provider classpath\n+{\\f[CB]\\-providerpath\\f[R] \\f[I]list\\f[R]}: Provider classpath\n@@ -1185,1 +1170,1 @@\n-{\\f[V]-v\\f[R]}: Verbose output\n+{\\f[CB]\\-v\\f[R]}: Verbose output\n@@ -1187,1 +1172,1 @@\n-Use the \\f[V]-storepasswd\\f[R] command to change the password used to\n+Use the \\f[CB]\\-storepasswd\\f[R] command to change the password used to\n@@ -1189,1 +1174,1 @@\n-The new password is set by \\f[V]-new\\f[R] \\f[I]arg\\f[R] and must contain\n+The new password is set by \\f[CB]\\-new\\f[R] \\f[I]arg\\f[R] and must contain\n@@ -1193,2 +1178,2 @@\n-\\f[V]-keypasswd\\f[R]\n-The following are the available options for the \\f[V]-keypasswd\\f[R]\n+.B \\f[CB]\\-keypasswd\\f[R]\n+The following are the available options for the \\f[CB]\\-keypasswd\\f[R]\n@@ -1198,1 +1183,1 @@\n-{\\f[V]-alias\\f[R] \\f[I]alias\\f[R]}: Alias name of the entry to process\n+{\\f[CB]\\-alias\\f[R] \\f[I]alias\\f[R]}: Alias name of the entry to process\n@@ -1200,1 +1185,1 @@\n-[\\f[V]-keypass\\f[R] \\f[I]old_keypass\\f[R]]: Key password\n+[\\f[CB]\\-keypass\\f[R] \\f[I]old_keypass\\f[R]]: Key password\n@@ -1202,1 +1187,1 @@\n-[\\f[V]-new\\f[R] \\f[I]new_keypass\\f[R]]: New password\n+[\\f[CB]\\-new\\f[R] \\f[I]new_keypass\\f[R]]: New password\n@@ -1204,1 +1189,1 @@\n-{\\f[V]-keystore\\f[R] \\f[I]keystore\\f[R]}: Keystore name\n+{\\f[CB]\\-keystore\\f[R] \\f[I]keystore\\f[R]}: Keystore name\n@@ -1206,1 +1191,1 @@\n-{\\f[V]-storepass\\f[R] \\f[I]arg\\f[R]}: Keystore password\n+{\\f[CB]\\-storepass\\f[R] \\f[I]arg\\f[R]}: Keystore password\n@@ -1208,1 +1193,1 @@\n-{\\f[V]-storetype\\f[R] \\f[I]type\\f[R]}: Keystore type\n+{\\f[CB]\\-storetype\\f[R] \\f[I]type\\f[R]}: Keystore type\n@@ -1210,1 +1195,1 @@\n-{\\f[V]-providername\\f[R] \\f[I]name\\f[R]}: Provider name\n+{\\f[CB]\\-providername\\f[R] \\f[I]name\\f[R]}: Provider name\n@@ -1212,1 +1197,1 @@\n-{\\f[V]-addprovider\\f[R] \\f[I]name\\f[R] [\\f[V]-providerarg\\f[R]\n+{\\f[CB]\\-addprovider\\f[R] \\f[I]name\\f[R] [\\f[CB]\\-providerarg\\f[R]\n@@ -1216,3 +1201,3 @@\n-{\\f[V]-providerclass\\f[R] \\f[I]class\\f[R] [\\f[V]-providerarg\\f[R]\n-\\f[I]arg\\f[R]]}: Add security provider by fully qualified class name\n-with an optional configure argument.\n+{\\f[CB]\\-providerclass\\f[R] \\f[I]class\\f[R] [\\f[CB]\\-providerarg\\f[R]\n+\\f[I]arg\\f[R]]}: Add security provider by fully qualified class name with\n+an optional configure argument.\n@@ -1220,1 +1205,1 @@\n-{\\f[V]-providerpath\\f[R] \\f[I]list\\f[R]}: Provider classpath\n+{\\f[CB]\\-providerpath\\f[R] \\f[I]list\\f[R]}: Provider classpath\n@@ -1222,1 +1207,1 @@\n-{\\f[V]-v\\f[R]}: Verbose output\n+{\\f[CB]\\-v\\f[R]}: Verbose output\n@@ -1224,3 +1209,3 @@\n-Use the \\f[V]-keypasswd\\f[R] command to change the password (under which\n-private\/secret keys identified by \\f[V]-alias\\f[R] are protected) from\n-\\f[V]-keypass\\f[R] \\f[I]old_keypass\\f[R] to \\f[V]-new\\f[R]\n+Use the \\f[CB]\\-keypasswd\\f[R] command to change the password (under which\n+private\/secret keys identified by \\f[CB]\\-alias\\f[R] are protected) from\n+\\f[CB]\\-keypass\\f[R] \\f[I]old_keypass\\f[R] to \\f[CB]\\-new\\f[R]\n@@ -1230,3 +1215,3 @@\n-If the \\f[V]-keypass\\f[R] option isn\\[aq]t provided at the command line\n-and the \\f[V]-keypass\\f[R] password is different from the keystore\n-password (\\f[V]-storepass\\f[R] \\f[I]arg\\f[R]), then the user is prompted\n+If the \\f[CB]\\-keypass\\f[R] option isn\\[aq]t provided at the command line\n+and the \\f[CB]\\-keypass\\f[R] password is different from the keystore\n+password (\\f[CB]\\-storepass\\f[R] \\f[I]arg\\f[R]), then the user is prompted\n@@ -1235,1 +1220,1 @@\n-If the \\f[V]-new\\f[R] option isn\\[aq]t provided at the command line,\n+If the \\f[CB]\\-new\\f[R] option isn\\[aq]t provided at the command line,\n@@ -1239,2 +1224,2 @@\n-\\f[V]-delete\\f[R]\n-The following are the available options for the \\f[V]-delete\\f[R]\n+.B \\f[CB]\\-delete\\f[R]\n+The following are the available options for the \\f[CB]\\-delete\\f[R]\n@@ -1244,1 +1229,1 @@\n-[\\f[V]-alias\\f[R] \\f[I]alias\\f[R]]: Alias name of the entry to process\n+[\\f[CB]\\-alias\\f[R] \\f[I]alias\\f[R]]: Alias name of the entry to process\n@@ -1246,1 +1231,1 @@\n-{\\f[V]-keystore\\f[R] \\f[I]keystore\\f[R]}: Keystore name\n+{\\f[CB]\\-keystore\\f[R] \\f[I]keystore\\f[R]}: Keystore name\n@@ -1248,1 +1233,1 @@\n-{\\f[V]-cacerts\\f[R]}: Access the cacerts keystore\n+{\\f[CB]\\-cacerts\\f[R]}: Access the cacerts keystore\n@@ -1250,1 +1235,1 @@\n-[\\f[V]-storepass\\f[R] \\f[I]arg\\f[R]]: Keystore password\n+[\\f[CB]\\-storepass\\f[R] \\f[I]arg\\f[R]]: Keystore password\n@@ -1252,1 +1237,1 @@\n-{\\f[V]-storetype\\f[R] \\f[I]type\\f[R]}: Keystore type\n+{\\f[CB]\\-storetype\\f[R] \\f[I]type\\f[R]}: Keystore type\n@@ -1254,1 +1239,1 @@\n-{\\f[V]-providername\\f[R] \\f[I]name\\f[R]}: Provider name\n+{\\f[CB]\\-providername\\f[R] \\f[I]name\\f[R]}: Provider name\n@@ -1256,1 +1241,1 @@\n-{\\f[V]-addprovider\\f[R] \\f[I]name\\f[R] [\\f[V]-providerarg\\f[R]\n+{\\f[CB]\\-addprovider\\f[R] \\f[I]name\\f[R] [\\f[CB]\\-providerarg\\f[R]\n@@ -1260,3 +1245,3 @@\n-{\\f[V]-providerclass\\f[R] \\f[I]class\\f[R] [\\f[V]-providerarg\\f[R]\n-\\f[I]arg\\f[R]]}: Add security provider by fully qualified class name\n-with an optional configure argument.\n+{\\f[CB]\\-providerclass\\f[R] \\f[I]class\\f[R] [\\f[CB]\\-providerarg\\f[R]\n+\\f[I]arg\\f[R]]}: Add security provider by fully qualified class name with\n+an optional configure argument.\n@@ -1264,1 +1249,1 @@\n-{\\f[V]-providerpath\\f[R] \\f[I]list\\f[R]}: Provider classpath\n+{\\f[CB]\\-providerpath\\f[R] \\f[I]list\\f[R]}: Provider classpath\n@@ -1266,1 +1251,1 @@\n-{\\f[V]-v\\f[R]}: Verbose output\n+{\\f[CB]\\-v\\f[R]}: Verbose output\n@@ -1268,1 +1253,1 @@\n-{\\f[V]-protected\\f[R]}: Password provided through a protected mechanism\n+{\\f[CB]\\-protected\\f[R]}: Password provided through a protected mechanism\n@@ -1270,1 +1255,1 @@\n-Use the \\f[V]-delete\\f[R] command to delete the \\f[V]-alias\\f[R]\n+Use the \\f[CB]\\-delete\\f[R] command to delete the \\f[CB]\\-alias\\f[R]\n@@ -1273,1 +1258,1 @@\n-\\f[V]alias\\f[R].\n+\\f[CB]alias\\f[R].\n@@ -1276,2 +1261,2 @@\n-\\f[V]-changealias\\f[R]\n-The following are the available options for the \\f[V]-changealias\\f[R]\n+.B \\f[CB]\\-changealias\\f[R]\n+The following are the available options for the \\f[CB]\\-changealias\\f[R]\n@@ -1281,1 +1266,1 @@\n-{\\f[V]-alias\\f[R] \\f[I]alias\\f[R]}: Alias name of the entry to process\n+{\\f[CB]\\-alias\\f[R] \\f[I]alias\\f[R]}: Alias name of the entry to process\n@@ -1283,1 +1268,1 @@\n-[\\f[V]-destalias\\f[R] \\f[I]alias\\f[R]]: Destination alias\n+[\\f[CB]\\-destalias\\f[R] \\f[I]alias\\f[R]]: Destination alias\n@@ -1285,1 +1270,1 @@\n-[\\f[V]-keypass\\f[R] \\f[I]arg\\f[R]]: Key password\n+[\\f[CB]\\-keypass\\f[R] \\f[I]arg\\f[R]]: Key password\n@@ -1287,1 +1272,1 @@\n-{\\f[V]-keystore\\f[R] \\f[I]keystore\\f[R]}: Keystore name\n+{\\f[CB]\\-keystore\\f[R] \\f[I]keystore\\f[R]}: Keystore name\n@@ -1289,1 +1274,1 @@\n-{\\f[V]-cacerts\\f[R]}: Access the cacerts keystore\n+{\\f[CB]\\-cacerts\\f[R]}: Access the cacerts keystore\n@@ -1291,1 +1276,1 @@\n-[\\f[V]-storepass\\f[R] \\f[I]arg\\f[R]]: Keystore password\n+[\\f[CB]\\-storepass\\f[R] \\f[I]arg\\f[R]]: Keystore password\n@@ -1293,1 +1278,1 @@\n-{\\f[V]-storetype\\f[R] \\f[I]type\\f[R]}: Keystore type\n+{\\f[CB]\\-storetype\\f[R] \\f[I]type\\f[R]}: Keystore type\n@@ -1295,1 +1280,1 @@\n-{\\f[V]-providername\\f[R] \\f[I]name\\f[R]}: Provider name\n+{\\f[CB]\\-providername\\f[R] \\f[I]name\\f[R]}: Provider name\n@@ -1297,1 +1282,1 @@\n-{\\f[V]-addprovider\\f[R] \\f[I]name\\f[R] [\\f[V]-providerarg\\f[R]\n+{\\f[CB]\\-addprovider\\f[R] \\f[I]name\\f[R] [\\f[CB]\\-providerarg\\f[R]\n@@ -1301,3 +1286,3 @@\n-{\\f[V]-providerclass\\f[R] \\f[I]class\\f[R] [\\f[V]-providerarg\\f[R]\n-\\f[I]arg\\f[R]]}: Add security provider by fully qualified class name\n-with an optional configure argument.\n+{\\f[CB]\\-providerclass\\f[R] \\f[I]class\\f[R] [\\f[CB]\\-providerarg\\f[R]\n+\\f[I]arg\\f[R]]}: Add security provider by fully qualified class name with\n+an optional configure argument.\n@@ -1305,1 +1290,1 @@\n-{\\f[V]-providerpath\\f[R] \\f[I]list\\f[R]}: Provider classpath\n+{\\f[CB]\\-providerpath\\f[R] \\f[I]list\\f[R]}: Provider classpath\n@@ -1307,1 +1292,1 @@\n-{\\f[V]-v\\f[R]}: Verbose output\n+{\\f[CB]\\-v\\f[R]}: Verbose output\n@@ -1309,1 +1294,1 @@\n-{\\f[V]-protected\\f[R]}: Password provided through a protected mechanism\n+{\\f[CB]\\-protected\\f[R]}: Password provided through a protected mechanism\n@@ -1311,3 +1296,3 @@\n-Use the \\f[V]-changealias\\f[R] command to move an existing keystore\n-entry from \\f[V]-alias\\f[R] \\f[I]alias\\f[R] to a new\n-\\f[V]-destalias\\f[R] \\f[I]alias\\f[R].\n+Use the \\f[CB]\\-changealias\\f[R] command to move an existing keystore\n+entry from \\f[CB]\\-alias\\f[R] \\f[I]alias\\f[R] to a new \\f[CB]\\-destalias\\f[R]\n+\\f[I]alias\\f[R].\n@@ -1317,2 +1302,2 @@\n-password can be supplied with the \\f[V]-keypass\\f[R] option.\n-If a key password is not provided, then the \\f[V]-storepass\\f[R] (if\n+password can be supplied with the \\f[CB]\\-keypass\\f[R] option.\n+If a key password is not provided, then the \\f[CB]\\-storepass\\f[R] (if\n@@ -1322,1 +1307,1 @@\n-.SH COMMANDS FOR DISPLAYING SECURITY-RELATED INFORMATION\n+.SH COMMANDS FOR DISPLAYING SECURITY\\-RELATED INFORMATION\n@@ -1324,2 +1309,2 @@\n-\\f[V]-showinfo\\f[R]\n-The following are the available options for the \\f[V]-showinfo\\f[R]\n+.B \\f[CB]\\-showinfo\\f[R]\n+The following are the available options for the \\f[CB]\\-showinfo\\f[R]\n@@ -1329,1 +1314,1 @@\n-{\\f[V]-tls\\f[R]}: Displays TLS configuration information\n+{\\f[CB]\\-tls\\f[R]}: Displays TLS configuration information\n@@ -1331,1 +1316,1 @@\n-{\\f[V]-v\\f[R]}: Verbose output\n+{\\f[CB]\\-v\\f[R]}: Verbose output\n@@ -1333,1 +1318,1 @@\n-Use the \\f[V]-showinfo\\f[R] command to display various security-related\n+Use the \\f[CB]\\-showinfo\\f[R] command to display various security\\-related\n@@ -1335,1 +1320,1 @@\n-The \\f[V]-tls\\f[R] option displays TLS configurations, such as the list\n+The \\f[CB]\\-tls\\f[R] option displays TLS configurations, such as the list\n@@ -1340,2 +1325,2 @@\n-You can use \\f[V]-version\\f[R] to print the program version of\n-\\f[V]keytool\\f[R].\n+You can use \\f[CB]\\-version\\f[R] to print the program version of\n+\\f[CB]keytool\\f[R].\n@@ -1344,1 +1329,1 @@\n-You can use \\f[V]--help\\f[R] to display a list of \\f[V]keytool\\f[R]\n+You can use \\f[CB]\\-\\-help\\f[R] to display a list of \\f[CB]keytool\\f[R]\n@@ -1346,1 +1331,1 @@\n-\\f[V]keytool\\f[R] command.\n+\\f[CB]keytool\\f[R] command.\n@@ -1348,1 +1333,1 @@\n-To display a list of \\f[V]keytool\\f[R] commands, enter:\n+To display a list of \\f[CB]keytool\\f[R] commands, enter:\n@@ -1352,1 +1337,1 @@\n-\\f[V]keytool --help\\f[R]\n+\\f[CB]keytool\\ \\-\\-help\\f[R]\n@@ -1356,1 +1341,1 @@\n-To display help information about a specific \\f[V]keytool\\f[R] command,\n+To display help information about a specific \\f[CB]keytool\\f[R] command,\n@@ -1361,1 +1346,1 @@\n-\\f[V]keytool -<command> --help\\f[R]\n+\\f[CB]keytool\\ \\-<command>\\ \\-\\-help\\f[R]\n@@ -1366,3 +1351,3 @@\n-The \\f[V]-v\\f[R] option can appear for all commands except\n-\\f[V]--help\\f[R].\n-When the \\f[V]-v\\f[R] option appears, it signifies verbose mode, which\n+The \\f[CB]\\-v\\f[R] option can appear for all commands except\n+\\f[CB]\\-\\-help\\f[R].\n+When the \\f[CB]\\-v\\f[R] option appears, it signifies verbose mode, which\n@@ -1371,2 +1356,2 @@\n-The \\f[V]-J\\f[R]\\f[I]option\\f[R] argument can appear for any command.\n-When the \\f[V]-J\\f[R]\\f[I]option\\f[R] is used, the specified\n+The \\f[CB]\\-J\\f[R]\\f[I]option\\f[R] argument can appear for any command.\n+When the \\f[CB]\\-J\\f[R]\\f[I]option\\f[R] is used, the specified\n@@ -1376,2 +1361,2 @@\n-For a list of possible interpreter options, enter \\f[V]java -h\\f[R] or\n-\\f[V]java -X\\f[R] at the command line.\n+For a list of possible interpreter options, enter \\f[CB]java\\ \\-h\\f[R] or\n+\\f[CB]java\\ \\-X\\f[R] at the command line.\n@@ -1381,1 +1366,1 @@\n-\\f[V]-storetype\\f[R] \\f[I]storetype\\f[R]\n+.B \\f[CB]\\-storetype\\f[R] \\f[I]storetype\\f[R]\n@@ -1383,0 +1368,2 @@\n+.RS\n+.RE\n@@ -1384,1 +1371,1 @@\n-\\f[V]-keystore\\f[R] \\f[I]keystore\\f[R]\n+.B \\f[CB]\\-keystore\\f[R] \\f[I]keystore\\f[R]\n@@ -1388,2 +1375,2 @@\n-If the JKS \\f[V]storetype\\f[R] is used and a keystore file doesn\\[aq]t\n-yet exist, then certain \\f[V]keytool\\f[R] commands can result in a new\n+If the JKS \\f[CB]storetype\\f[R] is used and a keystore file doesn\\[aq]t\n+yet exist, then certain \\f[CB]keytool\\f[R] commands can result in a new\n@@ -1391,3 +1378,3 @@\n-For example, if \\f[V]keytool -genkeypair\\f[R] is called and the\n-\\f[V]-keystore\\f[R] option isn\\[aq]t specified, the default keystore\n-file named \\f[V].keystore\\f[R] is created in the user\\[aq]s home\n+For example, if \\f[CB]keytool\\ \\-genkeypair\\f[R] is called and the\n+\\f[CB]\\-keystore\\f[R] option isn\\[aq]t specified, the default keystore\n+file named \\f[CB]\\&.keystore\\f[R] is created in the user\\[aq]s home\n@@ -1395,3 +1382,3 @@\n-Similarly, if the \\f[V]-keystore ks_file\\f[R] option is specified but\n-\\f[V]ks_file\\f[R] doesn\\[aq]t exist, then it is created.\n-For more information on the JKS \\f[V]storetype\\f[R], see the\n+Similarly, if the \\f[CB]\\-keystore\\ ks_file\\f[R] option is specified but\n+\\f[CB]ks_file\\f[R] doesn\\[aq]t exist, then it is created.\n+For more information on the JKS \\f[CB]storetype\\f[R], see the\n@@ -1400,5 +1387,5 @@\n-Note that the input stream from the \\f[V]-keystore\\f[R] option is passed\n-to the \\f[V]KeyStore.load\\f[R] method.\n-If \\f[V]NONE\\f[R] is specified as the URL, then a null stream is passed\n-to the \\f[V]KeyStore.load\\f[R] method.\n-\\f[V]NONE\\f[R] should be specified if the keystore isn\\[aq]t file-based.\n+Note that the input stream from the \\f[CB]\\-keystore\\f[R] option is passed\n+to the \\f[CB]KeyStore.load\\f[R] method.\n+If \\f[CB]NONE\\f[R] is specified as the URL, then a null stream is passed\n+to the \\f[CB]KeyStore.load\\f[R] method.\n+\\f[CB]NONE\\f[R] should be specified if the keystore isn\\[aq]t file\\-based.\n@@ -1408,1 +1395,1 @@\n-\\f[V]-cacerts\\f[R] \\f[I]cacerts\\f[R]\n+.B \\f[CB]\\-cacerts\\f[R] \\f[I]cacerts\\f[R]\n@@ -1410,5 +1397,6 @@\n-This option is equivalent to \\f[V]-keystore\\f[R]\n-\\f[I]path_to_cacerts\\f[R] \\f[V]-storetype\\f[R]\n-\\f[I]type_of_cacerts\\f[R].\n-An error is reported if the \\f[V]-keystore\\f[R] or \\f[V]-storetype\\f[R]\n-option is used with the \\f[V]-cacerts\\f[R] option.\n+This option is equivalent to \\f[CB]\\-keystore\\f[R]\n+\\f[I]path_to_cacerts\\f[R] \\f[CB]\\-storetype\\f[R] \\f[I]type_of_cacerts\\f[R].\n+An error is reported if the \\f[CB]\\-keystore\\f[R] or \\f[CB]\\-storetype\\f[R]\n+option is used with the \\f[CB]\\-cacerts\\f[R] option.\n+.RS\n+.RE\n@@ -1416,1 +1404,1 @@\n-\\f[V]-storepass\\f[R] [\\f[V]:env\\f[R] | \\f[V]:file\\f[R] ] \\f[I]argument\\f[R]\n+.B \\f[CB]\\-storepass\\f[R] [\\f[CB]:env\\f[R] | \\f[CB]:file\\f[R] ] \\f[I]argument\\f[R]\n@@ -1420,3 +1408,3 @@\n-If the modifier \\f[V]env\\f[R] or \\f[V]file\\f[R] isn\\[aq]t specified,\n-then the password has the value \\f[I]argument\\f[R], which must contain\n-at least six characters.\n+If the modifier \\f[CB]env\\f[R] or \\f[CB]file\\f[R] isn\\[aq]t specified, then\n+the password has the value \\f[I]argument\\f[R], which must contain at\n+least six characters.\n@@ -1425,1 +1413,1 @@\n-\\f[V]env\\f[R]: Retrieve the password from the environment variable named\n+\\f[CB]env\\f[R]: Retrieve the password from the environment variable named\n@@ -1428,1 +1416,1 @@\n-\\f[V]file\\f[R]: Retrieve the password from the file named\n+\\f[CB]file\\f[R]: Retrieve the password from the file named\n@@ -1432,3 +1420,3 @@\n-\\f[V]-keypass\\f[R], \\f[V]-srckeypass\\f[R], \\f[V]-destkeypass\\f[R],\n-\\f[V]-srcstorepass\\f[R], and \\f[V]-deststorepass\\f[R], accept the\n-\\f[V]env\\f[R] and \\f[V]file\\f[R] modifiers.\n+\\f[CB]\\-keypass\\f[R], \\f[CB]\\-srckeypass\\f[R], \\f[CB]\\-destkeypass\\f[R],\n+\\f[CB]\\-srcstorepass\\f[R], and \\f[CB]\\-deststorepass\\f[R], accept the\n+\\f[CB]env\\f[R] and \\f[CB]file\\f[R] modifiers.\n@@ -1440,1 +1428,1 @@\n-For such commands, when the \\f[V]-storepass\\f[R] option isn\\[aq]t\n+For such commands, when the \\f[CB]\\-storepass\\f[R] option isn\\[aq]t\n@@ -1448,1 +1436,1 @@\n-\\f[V]-providername\\f[R] \\f[I]name\\f[R]\n+.B \\f[CB]\\-providername\\f[R] \\f[I]name\\f[R]\n@@ -1451,0 +1439,2 @@\n+.RS\n+.RE\n@@ -1452,1 +1442,1 @@\n-\\f[V]-addprovider\\f[R] \\f[I]name\\f[R]\n+.B \\f[CB]\\-addprovider\\f[R] \\f[I]name\\f[R]\n@@ -1454,0 +1444,2 @@\n+.RS\n+.RE\n@@ -1455,1 +1447,1 @@\n-\\f[V]-providerclass\\f[R] \\f[I]class\\f[R]\n+.B \\f[CB]\\-providerclass\\f[R] \\f[I]class\\f[R]\n@@ -1459,0 +1451,2 @@\n+.RS\n+.RE\n@@ -1460,1 +1454,1 @@\n-\\f[V]-providerpath\\f[R] \\f[I]list\\f[R]\n+.B \\f[CB]\\-providerpath\\f[R] \\f[I]list\\f[R]\n@@ -1462,0 +1456,2 @@\n+.RS\n+.RE\n@@ -1463,2 +1459,2 @@\n-\\f[V]-providerarg\\f[R] \\f[I]arg\\f[R]\n-Used with the \\f[V]-addprovider\\f[R] or \\f[V]-providerclass\\f[R] option\n+.B \\f[CB]\\-providerarg\\f[R] \\f[I]arg\\f[R]\n+Used with the \\f[CB]\\-addprovider\\f[R] or \\f[CB]\\-providerclass\\f[R] option\n@@ -1467,0 +1463,2 @@\n+.RS\n+.RE\n@@ -1468,4 +1466,3 @@\n-\\f[V]-protected=true\\f[R]|\\f[V]false\\f[R]\n-Specify this value as \\f[V]true\\f[R] when a password must be specified\n-by way of a protected authentication path, such as a dedicated PIN\n-reader.\n+.B \\f[CB]\\-protected=true\\f[R]|\\f[CB]false\\f[R]\n+Specify this value as \\f[CB]true\\f[R] when a password must be specified by\n+way of a protected authentication path, such as a dedicated PIN reader.\n@@ -1473,2 +1470,2 @@\n-\\f[V]-importkeystore\\f[R] command, the following two options,\n-\\f[V]-srcprotected\\f[R] and \\f[V]-destprotected\\f[R], are provided for\n+\\f[CB]\\-importkeystore\\f[R] command, the following two options,\n+\\f[CB]\\-srcprotected\\f[R] and \\f[CB]\\-destprotected\\f[R], are provided for\n@@ -1476,0 +1473,2 @@\n+.RS\n+.RE\n@@ -1477,1 +1476,1 @@\n-\\f[V]-ext\\f[R] {\\f[I]name\\f[R]{\\f[V]:critical\\f[R]} {\\f[V]=\\f[R]\\f[I]value\\f[R]}}\n+.B \\f[CB]\\-ext\\f[R] {\\f[I]name\\f[R]{\\f[CB]:critical\\f[R]} {\\f[CB]=\\f[R]\\f[I]value\\f[R]}}\n@@ -1479,1 +1478,1 @@\n-The option can be used in \\f[V]-genkeypair\\f[R] and \\f[V]-gencert\\f[R]\n+The option can be used in \\f[CB]\\-genkeypair\\f[R] and \\f[CB]\\-gencert\\f[R]\n@@ -1481,1 +1480,1 @@\n-\\f[V]-certreq\\f[R] to show what extensions are requested in the\n+\\f[CB]\\-certreq\\f[R] to show what extensions are requested in the\n@@ -1486,2 +1485,2 @@\n-The \\f[I]value\\f[R] argument, when provided, denotes the argument for\n-the extension.\n+The \\f[I]value\\f[R] argument, when provided, denotes the argument for the\n+extension.\n@@ -1490,4 +1489,6 @@\n-The \\f[V]:critical\\f[R] modifier, when provided, means the\n-extension\\[aq]s \\f[V]isCritical\\f[R] attribute is \\f[V]true\\f[R];\n-otherwise, it is \\f[V]false\\f[R].\n-You can use \\f[V]:c\\f[R] in place of \\f[V]:critical\\f[R].\n+The \\f[CB]:critical\\f[R] modifier, when provided, means the\n+extension\\[aq]s \\f[CB]isCritical\\f[R] attribute is \\f[CB]true\\f[R];\n+otherwise, it is \\f[CB]false\\f[R].\n+You can use \\f[CB]:c\\f[R] in place of \\f[CB]:critical\\f[R].\n+.RS\n+.RE\n@@ -1495,3 +1496,5 @@\n-\\f[V]-conf\\f[R] \\f[I]file\\f[R]\n-Specifies a pre-configured options file.\n-.SH PRE-CONFIGURED OPTIONS FILE\n+.B \\f[CB]\\-conf\\f[R] \\f[I]file\\f[R]\n+Specifies a pre\\-configured options file.\n+.RS\n+.RE\n+.SH PRE\\-CONFIGURED OPTIONS FILE\n@@ -1499,2 +1502,2 @@\n-A pre-configured options file is a Java properties file that can be\n-specified with the \\f[V]-conf\\f[R] option.\n+A pre\\-configured options file is a Java properties file that can be\n+specified with the \\f[CB]\\-conf\\f[R] option.\n@@ -1502,4 +1505,4 @@\n-using \\[dq]keytool.\\f[I]command_name\\f[R]\\[dq] as the property name.\n-A special property named \\[dq]keytool.all\\[dq] represents the default\n-option(s) applied to all commands.\n-A property value can include \\f[V]${prop}\\f[R] which will be expanded to\n+using \"keytool.\\f[I]command_name\\f[R]\" as the property name.\n+A special property named \"keytool.all\" represents the default option(s)\n+applied to all commands.\n+A property value can include \\f[CB]${prop}\\f[R] which will be expanded to\n@@ -1508,1 +1511,1 @@\n-by quotation marks (\\[dq] or \\[aq]).\n+by quotation marks (\" or \\[aq]).\n@@ -1511,12 +1514,12 @@\n-When \\f[V]keytool\\f[R] is launched with a pre-configured options file,\n-the value for \\[dq]keytool.all\\[dq] (if it exists) is prepended to the\n-\\f[V]keytool\\f[R] command line first, with the value for the command\n-name (if it exists) comes next, and the existing options on the command\n-line at last.\n-For a single-valued option, this allows the property for a specific\n-command to override the \\[dq]keytool.all\\[dq] value, and the value\n-specified on the command line to override both.\n-For multiple-valued options, all of them will be used by\n-\\f[V]keytool\\f[R].\n-.PP\n-For example, given the following file named \\f[V]preconfig\\f[R]:\n+When \\f[CB]keytool\\f[R] is launched with a pre\\-configured options file,\n+the value for \"keytool.all\" (if it exists) is prepended to the\n+\\f[CB]keytool\\f[R] command line first, with the value for the command name\n+(if it exists) comes next, and the existing options on the command line\n+at last.\n+For a single\\-valued option, this allows the property for a specific\n+command to override the \"keytool.all\" value, and the value specified on\n+the command line to override both.\n+For multiple\\-valued options, all of them will be used by\n+\\f[CB]keytool\\f[R].\n+.PP\n+For example, given the following file named \\f[CB]preconfig\\f[R]:\n@@ -1526,4 +1529,4 @@\n-    # A tiny pre-configured options file\n-    keytool.all = -keystore ${user.home}\/ks\n-    keytool.list = -v\n-    keytool.genkeypair = -keyalg rsa\n+\\ \\ \\ \\ #\\ A\\ tiny\\ pre\\-configured\\ options\\ file\n+\\ \\ \\ \\ keytool.all\\ =\\ \\-keystore\\ ${user.home}\/ks\n+\\ \\ \\ \\ keytool.list\\ =\\ \\-v\n+\\ \\ \\ \\ keytool.genkeypair\\ =\\ \\-keyalg\\ rsa\n@@ -1533,1 +1536,1 @@\n-\\f[V]keytool -conf preconfig -list\\f[R] is identical to\n+\\f[CB]keytool\\ \\-conf\\ preconfig\\ \\-list\\f[R] is identical to\n@@ -1536,1 +1539,1 @@\n-\\f[V]keytool -keystore \\[ti]\/ks -v -list\\f[R]\n+\\f[CB]keytool\\ \\-keystore\\ ~\/ks\\ \\-v\\ \\-list\\f[R]\n@@ -1539,1 +1542,2 @@\n-\\f[V]keytool -conf preconfig -genkeypair -alias me\\f[R] is identical to\n+\\f[CB]keytool\\ \\-conf\\ preconfig\\ \\-genkeypair\\ \\-alias\\ me\\f[R] is\n+identical to\n@@ -1542,1 +1546,1 @@\n-\\f[V]keytool -keystore \\[ti]\/ks -keyalg rsa -genkeypair -alias me\\f[R]\n+\\f[CB]keytool\\ \\-keystore\\ ~\/ks\\ \\-keyalg\\ rsa\\ \\-genkeypair\\ \\-alias\\ me\\f[R]\n@@ -1545,2 +1549,2 @@\n-\\f[V]keytool -conf preconfig -genkeypair -alias you -keyalg ec\\f[R] is\n-identical to\n+\\f[CB]keytool\\ \\-conf\\ preconfig\\ \\-genkeypair\\ \\-alias\\ you\\ \\-keyalg\\ ec\\f[R]\n+is identical to\n@@ -1549,1 +1553,1 @@\n-\\f[V]keytool -keystore \\[ti]\/ks -keyalg rsa -genkeypair -alias you -keyalg ec\\f[R]\n+\\f[CB]keytool\\ \\-keystore\\ ~\/ks\\ \\-keyalg\\ rsa\\ \\-genkeypair\\ \\-alias\\ you\\ \\-keyalg\\ ec\\f[R]\n@@ -1555,1 +1559,1 @@\n-\\f[V]keytool -keystore \\[ti]\/ks -genkeypair -alias you -keyalg ec\\f[R]\n+\\f[CB]keytool\\ \\-keystore\\ ~\/ks\\ \\-genkeypair\\ \\-alias\\ you\\ \\-keyalg\\ ec\\f[R]\n@@ -1558,1 +1562,1 @@\n-because \\f[V]-keyalg\\f[R] is a single-valued option and the \\f[V]ec\\f[R]\n+because \\f[CB]\\-keyalg\\f[R] is a single\\-valued option and the \\f[CB]ec\\f[R]\n@@ -1567,1 +1571,1 @@\n--alias \\[dq]mykey\\[dq]\n+\\-alias\\ \"mykey\"\n@@ -1569,7 +1573,7 @@\n--keysize\n-    2048 (when using -genkeypair and -keyalg is \\[dq]DSA\\[dq])\n-    3072 (when using -genkeypair and -keyalg is \\[dq]RSA\\[dq], \\[dq]RSASSA-PSS\\[dq], or \\[dq]DH\\[dq])\n-    384 (when using -genkeypair and -keyalg is \\[dq]EC\\[dq])\n-    255 (when using -genkeypair and -keyalg is \\[dq]EdDSA\\[dq], or \\[dq]XDH)\n-    56 (when using -genseckey and -keyalg is \\[dq]DES\\[dq])\n-    168 (when using -genseckey and -keyalg is \\[dq]DESede\\[dq])\n+\\-keysize\n+\\ \\ \\ \\ 2048\\ (when\\ using\\ \\-genkeypair\\ and\\ \\-keyalg\\ is\\ \"DSA\")\n+\\ \\ \\ \\ 3072\\ (when\\ using\\ \\-genkeypair\\ and\\ \\-keyalg\\ is\\ \"RSA\",\\ \"RSASSA\\-PSS\",\\ or\\ \"DH\")\n+\\ \\ \\ \\ 384\\ (when\\ using\\ \\-genkeypair\\ and\\ \\-keyalg\\ is\\ \"EC\")\n+\\ \\ \\ \\ 255\\ (when\\ using\\ \\-genkeypair\\ and\\ \\-keyalg\\ is\\ \"EdDSA\",\\ or\\ \"XDH)\n+\\ \\ \\ \\ 56\\ (when\\ using\\ \\-genseckey\\ and\\ \\-keyalg\\ is\\ \"DES\")\n+\\ \\ \\ \\ 168\\ (when\\ using\\ \\-genseckey\\ and\\ \\-keyalg\\ is\\ \"DESede\")\n@@ -1577,1 +1581,1 @@\n--validity 90\n+\\-validity\\ 90\n@@ -1579,1 +1583,1 @@\n--keystore <the file named .keystore in the user\\[aq]s home directory>\n+\\-keystore\\ <the\\ file\\ named\\ .keystore\\ in\\ the\\ user\\[aq]s\\ home\\ directory>\n@@ -1581,1 +1585,1 @@\n--destkeystore <the file named .keystore in the user\\[aq]s home directory>\n+\\-destkeystore\\ <the\\ file\\ named\\ .keystore\\ in\\ the\\ user\\[aq]s\\ home\\ directory>\n@@ -1583,3 +1587,3 @@\n--storetype <the value of the \\[dq]keystore.type\\[dq] property in the\n-    security properties file, which is returned by the static\n-    getDefaultType method in java.security.KeyStore>\n+\\-storetype\\ <the\\ value\\ of\\ the\\ \"keystore.type\"\\ property\\ in\\ the\n+\\ \\ \\ \\ security\\ properties\\ file,\\ which\\ is\\ returned\\ by\\ the\\ static\n+\\ \\ \\ \\ getDefaultType\\ method\\ in\\ java.security.KeyStore>\n@@ -1587,3 +1591,3 @@\n--file\n-    stdin (if reading)\n-    stdout (if writing)\n+\\-file\n+\\ \\ \\ \\ stdin\\ (if\\ reading)\n+\\ \\ \\ \\ stdout\\ (if\\ writing)\n@@ -1591,1 +1595,1 @@\n--protected false\n+\\-protected\\ false\n@@ -1596,1 +1600,1 @@\n-signature algorithm (\\f[V]-sigalg\\f[R] option) is derived from the\n+signature algorithm (\\f[CB]\\-sigalg\\f[R] option) is derived from the\n@@ -1624,1 +1628,1 @@\n-SHA256withRSA (keysize is too small for using SHA-384)\n+SHA256withRSA (keysize is too small for using SHA\\-384)\n@@ -1652,1 +1656,1 @@\n-RSASSA-PSS\n+RSASSA\\-PSS\n@@ -1656,1 +1660,1 @@\n-RSASSA-PSS (with SHA-256, keysize is too small for\n+RSASSA\\-PSS (with SHA\\-256, keysize is too small for\n@@ -1661,1 +1665,1 @@\n-using SHA-384)\n+using SHA\\-384)\n@@ -1667,1 +1671,1 @@\n-RSASSA-PSS (with SHA-384)\n+RSASSA\\-PSS (with SHA\\-384)\n@@ -1673,1 +1677,1 @@\n-RSASSA-PSS (with SHA-512)\n+RSASSA\\-PSS (with SHA\\-512)\n@@ -1704,1 +1708,1 @@\n-An RSASSA-PSS signature algorithm uses a \\f[V]MessageDigest\\f[R]\n+An RSASSA\\-PSS signature algorithm uses a \\f[CB]MessageDigest\\f[R]\n@@ -1708,4 +1712,4 @@\n-When generating an EdDSA key pair using \\f[V]-keyalg EdDSA\\f[R], a user\n-can specify \\f[V]-keysize 255\\f[R] or \\f[V]-keysize 448\\f[R] to generate\n-Ed25519 or Ed448 key pairs.\n-When no \\f[V]-keysize\\f[R] is specified, an Ed25519 key pair is\n+When generating an EdDSA key pair using \\f[CB]\\-keyalg\\ EdDSA\\f[R], a user\n+can specify \\f[CB]\\-keysize\\ 255\\f[R] or \\f[CB]\\-keysize\\ 448\\f[R] to\n+generate Ed25519 or Ed448 key pairs.\n+When no \\f[CB]\\-keysize\\f[R] is specified, an Ed25519 key pair is\n@@ -1713,2 +1717,2 @@\n-A user can also directly specify \\f[V]-keyalg Ed25519\\f[R] or\n-\\f[V]-keyalg Ed448\\f[R] to generate a key pair with the expected key\n+A user can also directly specify \\f[CB]\\-keyalg\\ Ed25519\\f[R] or\n+\\f[CB]\\-keyalg\\ Ed448\\f[R] to generate a key pair with the expected key\n@@ -1724,1 +1728,1 @@\n-Alternatively, you can use the \\f[V]-keysize\\f[R] or \\f[V]-sigalg\\f[R]\n+Alternatively, you can use the \\f[CB]\\-keysize\\f[R] or \\f[CB]\\-sigalg\\f[R]\n@@ -1728,2 +1732,2 @@\n-The \\f[V]keytool\\f[R] command supports these named extensions.\n-The names aren\\[aq]t case-sensitive.\n+The \\f[CB]keytool\\f[R] command supports these named extensions.\n+The names aren\\[aq]t case\\-sensitive.\n@@ -1731,1 +1735,1 @@\n-\\f[V]BC\\f[R] or \\f[V]BasicContraints\\f[R]\n+.B \\f[CB]BC\\f[R] or \\f[CB]BasicContraints\\f[R]\n@@ -1736,1 +1740,1 @@\n-\\f[V]ca:\\f[R]{\\f[V]true\\f[R]|\\f[V]false\\f[R]}[\\f[V],pathlen:\\f[R]\\f[I]len\\f[R]]\n+\\f[CB]ca:\\f[R]{\\f[CB]true\\f[R]|\\f[CB]false\\f[R]}[\\f[CB],pathlen:\\f[R]\\f[I]len\\f[R]]\n@@ -1738,1 +1742,1 @@\n-\\f[V]ca:true,pathlen:\\f[R]\\f[I]len\\f[R].\n+\\f[CB]ca:true,pathlen:\\f[R]\\f[I]len\\f[R].\n@@ -1740,1 +1744,1 @@\n-When \\f[I]len\\f[R] is omitted, the resulting value is \\f[V]ca:true\\f[R].\n+When \\f[I]len\\f[R] is omitted, the resulting value is \\f[CB]ca:true\\f[R].\n@@ -1743,1 +1747,1 @@\n-\\f[V]KU\\f[R] or \\f[V]KeyUsage\\f[R]\n+.B \\f[CB]KU\\f[R] or \\f[CB]KeyUsage\\f[R]\n@@ -1747,1 +1751,1 @@\n-\\f[I]usage\\f[R](\\f[V],\\f[R] \\f[I]usage\\f[R])*\n+\\f[I]usage\\f[R](\\f[CB],\\f[R] \\f[I]usage\\f[R])*\n@@ -1751,1 +1755,1 @@\n-\\f[V]digitalSignature\\f[R]\n+\\f[CB]digitalSignature\\f[R]\n@@ -1753,1 +1757,1 @@\n-\\f[V]nonRepudiation\\f[R] (\\f[V]contentCommitment\\f[R])\n+\\f[CB]nonRepudiation\\f[R] (\\f[CB]contentCommitment\\f[R])\n@@ -1755,1 +1759,1 @@\n-\\f[V]keyEncipherment\\f[R]\n+\\f[CB]keyEncipherment\\f[R]\n@@ -1757,1 +1761,1 @@\n-\\f[V]dataEncipherment\\f[R]\n+\\f[CB]dataEncipherment\\f[R]\n@@ -1759,1 +1763,1 @@\n-\\f[V]keyAgreement\\f[R]\n+\\f[CB]keyAgreement\\f[R]\n@@ -1761,1 +1765,1 @@\n-\\f[V]keyCertSign\\f[R]\n+\\f[CB]keyCertSign\\f[R]\n@@ -1763,1 +1767,1 @@\n-\\f[V]cRLSign\\f[R]\n+\\f[CB]cRLSign\\f[R]\n@@ -1765,1 +1769,1 @@\n-\\f[V]encipherOnly\\f[R]\n+\\f[CB]encipherOnly\\f[R]\n@@ -1767,1 +1771,1 @@\n-\\f[V]decipherOnly\\f[R]\n+\\f[CB]decipherOnly\\f[R]\n@@ -1770,4 +1774,4 @@\n-abbreviated with the first few letters (such as \\f[V]dig\\f[R] for\n-\\f[V]digitalSignature\\f[R]) or in camel-case style (such as \\f[V]dS\\f[R]\n-for \\f[V]digitalSignature\\f[R] or \\f[V]cRLS\\f[R] for \\f[V]cRLSign\\f[R]).\n-The \\f[I]usage\\f[R] values are case-sensitive.\n+abbreviated with the first few letters (such as \\f[CB]dig\\f[R] for\n+\\f[CB]digitalSignature\\f[R]) or in camel\\-case style (such as \\f[CB]dS\\f[R]\n+for \\f[CB]digitalSignature\\f[R] or \\f[CB]cRLS\\f[R] for \\f[CB]cRLSign\\f[R]).\n+The \\f[I]usage\\f[R] values are case\\-sensitive.\n@@ -1776,1 +1780,1 @@\n-\\f[V]EKU\\f[R] or \\f[V]ExtendedKeyUsage\\f[R]\n+.B \\f[CB]EKU\\f[R] or \\f[CB]ExtendedKeyUsage\\f[R]\n@@ -1780,1 +1784,1 @@\n-\\f[I]usage\\f[R](\\f[V],\\f[R] \\f[I]usage\\f[R])*\n+\\f[I]usage\\f[R](\\f[CB],\\f[R] \\f[I]usage\\f[R])*\n@@ -1784,1 +1788,1 @@\n-\\f[V]anyExtendedKeyUsage\\f[R]\n+\\f[CB]anyExtendedKeyUsage\\f[R]\n@@ -1786,1 +1790,1 @@\n-\\f[V]serverAuth\\f[R]\n+\\f[CB]serverAuth\\f[R]\n@@ -1788,1 +1792,1 @@\n-\\f[V]clientAuth\\f[R]\n+\\f[CB]clientAuth\\f[R]\n@@ -1790,1 +1794,1 @@\n-\\f[V]codeSigning\\f[R]\n+\\f[CB]codeSigning\\f[R]\n@@ -1792,1 +1796,1 @@\n-\\f[V]emailProtection\\f[R]\n+\\f[CB]emailProtection\\f[R]\n@@ -1794,1 +1798,1 @@\n-\\f[V]timeStamping\\f[R]\n+\\f[CB]timeStamping\\f[R]\n@@ -1796,1 +1800,1 @@\n-\\f[V]OCSPSigning\\f[R]\n+\\f[CB]OCSPSigning\\f[R]\n@@ -1801,2 +1805,2 @@\n-abbreviated with the first few letters or in camel-case style.\n-The \\f[I]usage\\f[R] values are case-sensitive.\n+abbreviated with the first few letters or in camel\\-case style.\n+The \\f[I]usage\\f[R] values are case\\-sensitive.\n@@ -1805,1 +1809,1 @@\n-\\f[V]SAN\\f[R] or \\f[V]SubjectAlternativeName\\f[R]\n+.B \\f[CB]SAN\\f[R] or \\f[CB]SubjectAlternativeName\\f[R]\n@@ -1809,2 +1813,2 @@\n-\\f[I]type\\f[R]\\f[V]:\\f[R]\\f[I]value\\f[R](\\f[V],\\f[R]\n-\\f[I]type\\f[R]\\f[V]:\\f[R]\\f[I]value\\f[R])*\n+\\f[I]type\\f[R]\\f[CB]:\\f[R]\\f[I]value\\f[R](\\f[CB],\\f[R]\n+\\f[I]type\\f[R]\\f[CB]:\\f[R]\\f[I]value\\f[R])*\n@@ -1814,1 +1818,1 @@\n-\\f[V]EMAIL\\f[R]\n+\\f[CB]EMAIL\\f[R]\n@@ -1816,1 +1820,1 @@\n-\\f[V]URI\\f[R]\n+\\f[CB]URI\\f[R]\n@@ -1818,1 +1822,1 @@\n-\\f[V]DNS\\f[R]\n+\\f[CB]DNS\\f[R]\n@@ -1820,1 +1824,1 @@\n-\\f[V]IP\\f[R]\n+\\f[CB]IP\\f[R]\n@@ -1822,1 +1826,1 @@\n-\\f[V]OID\\f[R]\n+\\f[CB]OID\\f[R]\n@@ -1828,1 +1832,1 @@\n-\\f[V]IAN\\f[R] or \\f[V]IssuerAlternativeName\\f[R]\n+.B \\f[CB]IAN\\f[R] or \\f[CB]IssuerAlternativeName\\f[R]\n@@ -1832,1 +1836,1 @@\n-Same as \\f[V]SAN\\f[R] or \\f[V]SubjectAlternativeName\\f[R].\n+Same as \\f[CB]SAN\\f[R] or \\f[CB]SubjectAlternativeName\\f[R].\n@@ -1835,1 +1839,1 @@\n-\\f[V]SIA\\f[R] or \\f[V]SubjectInfoAccess\\f[R]\n+.B \\f[CB]SIA\\f[R] or \\f[CB]SubjectInfoAccess\\f[R]\n@@ -1839,2 +1843,2 @@\n-\\f[I]method\\f[R]\\f[V]:\\f[R]\\f[I]location-type\\f[R]\\f[V]:\\f[R]\\f[I]location-value\\f[R](\\f[V],\\f[R]\n-\\f[I]method\\f[R]\\f[V]:\\f[R]\\f[I]location-type\\f[R]\\f[V]:\\f[R]\\f[I]location-value\\f[R])*\n+\\f[I]method\\f[R]\\f[CB]:\\f[R]\\f[I]location\\-type\\f[R]\\f[CB]:\\f[R]\\f[I]location\\-value\\f[R](\\f[CB],\\f[R]\n+\\f[I]method\\f[R]\\f[CB]:\\f[R]\\f[I]location\\-type\\f[R]\\f[CB]:\\f[R]\\f[I]location\\-value\\f[R])*\n@@ -1844,1 +1848,1 @@\n-\\f[V]timeStamping\\f[R]\n+\\f[CB]timeStamping\\f[R]\n@@ -1846,1 +1850,1 @@\n-\\f[V]caRepository\\f[R]\n+\\f[CB]caRepository\\f[R]\n@@ -1850,3 +1854,3 @@\n-The \\f[I]location-type\\f[R] and \\f[I]location-value\\f[R] arguments can\n-be any \\f[I]type\\f[R]\\f[V]:\\f[R]\\f[I]value\\f[R] supported by the\n-\\f[V]SubjectAlternativeName\\f[R] extension.\n+The \\f[I]location\\-type\\f[R] and \\f[I]location\\-value\\f[R] arguments can\n+be any \\f[I]type\\f[R]\\f[CB]:\\f[R]\\f[I]value\\f[R] supported by the\n+\\f[CB]SubjectAlternativeName\\f[R] extension.\n@@ -1855,1 +1859,1 @@\n-\\f[V]AIA\\f[R] or \\f[V]AuthorityInfoAccess\\f[R]\n+.B \\f[CB]AIA\\f[R] or \\f[CB]AuthorityInfoAccess\\f[R]\n@@ -1859,1 +1863,1 @@\n-Same as \\f[V]SIA\\f[R] or \\f[V]SubjectInfoAccess\\f[R].\n+Same as \\f[CB]SIA\\f[R] or \\f[CB]SubjectInfoAccess\\f[R].\n@@ -1863,1 +1867,1 @@\n-\\f[V]ocsp\\f[R]\n+\\f[CB]ocsp\\f[R]\n@@ -1865,1 +1869,1 @@\n-\\f[V]caIssuers\\f[R]\n+\\f[CB]caIssuers\\f[R]\n@@ -1871,1 +1875,1 @@\n-Encoding Rules (DER) encoding of the \\f[V]extnValue\\f[R] for the\n+Encoding Rules (DER) encoding of the \\f[CB]extnValue\\f[R] for the\n@@ -1873,1 +1877,1 @@\n-Other than standard hexadecimal numbers (0-9, a-f, A-F), any extra\n+Other than standard hexadecimal numbers (0\\-9, a\\-f, A\\-F), any extra\n@@ -1879,1 +1883,1 @@\n-A special name \\f[V]honored\\f[R], used only in \\f[V]-gencert\\f[R],\n+A special name \\f[CB]honored\\f[R], used only in \\f[CB]\\-gencert\\f[R],\n@@ -1882,1 +1886,1 @@\n-The value for this name is a comma-separated list of \\f[V]all\\f[R] (all\n+The value for this name is a comma\\-separated list of \\f[CB]all\\f[R] (all\n@@ -1884,4 +1888,4 @@\n-\\f[I]name\\f[R]{\\f[V]:\\f[R][\\f[V]critical\\f[R]|\\f[V]non-critical\\f[R]]}\n-(the named extension is honored, but it uses a different\n-\\f[V]isCritical\\f[R] attribute), and \\f[V]-name\\f[R] (used with\n-\\f[V]all\\f[R], denotes an exception).\n+\\f[I]name\\f[R]{\\f[CB]:\\f[R][\\f[CB]critical\\f[R]|\\f[CB]non\\-critical\\f[R]]} (the\n+named extension is honored, but it uses a different \\f[CB]isCritical\\f[R]\n+attribute), and \\f[CB]\\-name\\f[R] (used with \\f[CB]all\\f[R], denotes an\n+exception).\n@@ -1890,2 +1894,2 @@\n-If, besides the\\f[V]-ext honored\\f[R] option, another named or OID\n-\\f[V]-ext\\f[R] option is provided, this extension is added to those\n+If, besides the\\f[CB]\\-ext\\ honored\\f[R] option, another named or OID\n+\\f[CB]\\-ext\\f[R] option is provided, this extension is added to those\n@@ -1898,2 +1902,2 @@\n-The \\f[V]subjectKeyIdentifier\\f[R] extension is always created.\n-For non-self-signed certificates, the \\f[V]authorityKeyIdentifier\\f[R]\n+The \\f[CB]subjectKeyIdentifier\\f[R] extension is always created.\n+For non\\-self\\-signed certificates, the \\f[CB]authorityKeyIdentifier\\f[R]\n@@ -1933,1 +1937,1 @@\n-\\f[V]keytool -genkeypair -dname \\[dq]cn=myname, ou=mygroup, o=mycompany, c=mycountry\\[dq] -alias business -keyalg rsa -keypass\\f[R]\n+\\f[CB]keytool\\ \\-genkeypair\\ \\-dname\\ \"cn=myname,\\ ou=mygroup,\\ o=mycompany,\\ c=mycountry\"\\ \\-alias\\ business\\ \\-keyalg\\ rsa\\ \\-keypass\\f[R]\n@@ -1935,1 +1939,1 @@\n-\\f[V]-keystore \/working\/mykeystore -storepass password -validity 180\\f[R]\n+\\f[CB]\\-keystore\\ \/working\/mykeystore\\ \\-storepass\\ password\\ \\-validity\\ 180\\f[R]\n@@ -1938,1 +1942,1 @@\n-The command creates the keystore named \\f[V]mykeystore\\f[R] in the\n+The command creates the keystore named \\f[CB]mykeystore\\f[R] in the\n@@ -1940,1 +1944,1 @@\n-it the password specified by \\f[V]-keypass\\f[R].\n+it the password specified by \\f[CB]\\-keypass\\f[R].\n@@ -1942,3 +1946,3 @@\n-distinguished name is \\f[V]myname\\f[R], \\f[V]mygroup\\f[R],\n-\\f[V]mycompany\\f[R], and a two-letter country code of\n-\\f[V]mycountry\\f[R].\n+distinguished name is \\f[CB]myname\\f[R], \\f[CB]mygroup\\f[R],\n+\\f[CB]mycompany\\f[R], and a two\\-letter country code of\n+\\f[CB]mycountry\\f[R].\n@@ -1949,1 +1953,1 @@\n-a self-signed certificate that includes the public key and the\n+a self\\-signed certificate that includes the public key and the\n@@ -1953,1 +1957,1 @@\n-\\f[V]-alias business\\f[R].\n+\\f[CB]\\-alias\\ business\\f[R].\n@@ -1955,1 +1959,1 @@\n-\\f[V]-keypass\\f[R].\n+\\f[CB]\\-keypass\\f[R].\n@@ -1959,1 +1963,1 @@\n-In this case, only \\f[V]-keyalg\\f[R] is required, and the defaults are\n+In this case, only \\f[CB]\\-keyalg\\f[R] is required, and the defaults are\n@@ -1965,1 +1969,1 @@\n-\\f[V]keytool -genkeypair -keyalg rsa\\f[R]\n+\\f[CB]keytool\\ \\-genkeypair\\ \\-keyalg\\ rsa\\f[R]\n@@ -1968,3 +1972,3 @@\n-In this case, a keystore entry with the alias \\f[V]mykey\\f[R] is\n-created, with a newly generated key pair and a certificate that is valid\n-for 90 days.\n+In this case, a keystore entry with the alias \\f[CB]mykey\\f[R] is created,\n+with a newly generated key pair and a certificate that is valid for 90\n+days.\n@@ -1972,2 +1976,2 @@\n-\\f[V].keystore\\f[R] .\n-\\f[V].keystore\\f[R] is created if it doesn\\[aq]t already exist.\n+\\f[CB]\\&.keystore\\f[R] .\n+\\f[CB]\\&.keystore\\f[R] is created if it doesn\\[aq]t already exist.\n@@ -1980,1 +1984,1 @@\n-values equal to those specified in the first \\f[V]-genkeypair\\f[R]\n+values equal to those specified in the first \\f[CB]\\-genkeypair\\f[R]\n@@ -1983,1 +1987,1 @@\n-\\f[V]cn=\\f[R]\\f[I]myname\\f[R]\\f[V], ou=\\f[R]\\f[I]mygroup\\f[R]\\f[V], o=\\f[R]\\f[I]mycompany\\f[R]\\f[V], c=\\f[R]\\f[I]mycountry\\f[R]).\n+\\f[CB]cn=\\f[R]\\f[I]myname\\f[R]\\f[CB],\\ ou=\\f[R]\\f[I]mygroup\\f[R]\\f[CB],\\ o=\\f[R]\\f[I]mycompany\\f[R]\\f[CB],\\ c=\\f[R]\\f[I]mycountry\\f[R]).\n@@ -1988,1 +1992,1 @@\n-Generating the key pair created a self-signed certificate; however, a\n+Generating the key pair created a self\\-signed certificate; however, a\n@@ -1998,1 +2002,1 @@\n-\\f[V]keytool -certreq -file myname.csr\\f[R]\n+\\f[CB]keytool\\ \\-certreq\\ \\-file\\ myname.csr\\f[R]\n@@ -2002,2 +2006,2 @@\n-\\f[V]mykey\\f[R] and puts the request in the file named\n-\\f[V]myname.csr\\f[R].\n+\\f[CB]mykey\\f[R] and puts the request in the file named\n+\\f[CB]myname.csr\\f[R].\n@@ -2006,1 +2010,1 @@\n-Submit \\f[V]myname.csr\\f[R] to a CA, such as DigiCert.\n+Submit \\f[CB]myname.csr\\f[R] to a CA, such as DigiCert.\n@@ -2018,1 +2022,1 @@\n-trusted certificates either in your keystore or in the \\f[V]cacerts\\f[R]\n+trusted certificates either in your keystore or in the \\f[CB]cacerts\\f[R]\n@@ -2020,1 +2024,1 @@\n-See \\f[V]-importcert\\f[R] in \\f[B]Commands\\f[R].\n+See \\f[CB]\\-importcert\\f[R] in \\f[B]Commands\\f[R].\n@@ -2029,2 +2033,2 @@\n-If that certificate isn\\[aq]t self-signed, then you need a certificate\n-for its signer, and so on, up to a self-signed root CA certificate.\n+If that certificate isn\\[aq]t self\\-signed, then you need a certificate\n+for its signer, and so on, up to a self\\-signed root CA certificate.\n@@ -2032,1 +2036,1 @@\n-The \\f[V]cacerts\\f[R] keystore ships with a set of root certificates\n+The \\f[CB]cacerts\\f[R] keystore ships with a set of root certificates\n@@ -2034,1 +2038,1 @@\n-[http:\/\/www.oracle.com\/technetwork\/java\/javase\/javasecarootcertsprogram-1876540.html].\n+[http:\/\/www.oracle.com\/technetwork\/java\/javase\/javasecarootcertsprogram\\-1876540.html].\n@@ -2037,1 +2041,1 @@\n-\\f[V]cacerts\\f[R], then you must import a certificate from that CA as a\n+\\f[CB]cacerts\\f[R], then you must import a certificate from that CA as a\n@@ -2040,1 +2044,1 @@\n-A certificate from a CA is usually self-signed or signed by another CA.\n+A certificate from a CA is usually self\\-signed or signed by another CA.\n@@ -2044,2 +2048,2 @@\n-For example, you have obtained a \\f[I]X\\f[R]\\f[V].cer\\f[R] file from a\n-company that is a CA and the file is supposed to be a self-signed\n+For example, you have obtained a \\f[I]X\\f[R]\\f[CB]\\&.cer\\f[R] file from a\n+company that is a CA and the file is supposed to be a self\\-signed\n@@ -2050,3 +2054,3 @@\n-Viewing it with the \\f[V]keytool -printcert\\f[R] command or the\n-\\f[V]keytool -importcert\\f[R] command without using the\n-\\f[V]-noprompt\\f[R] option.\n+Viewing it with the \\f[CB]keytool\\ \\-printcert\\f[R] command or the\n+\\f[CB]keytool\\ \\-importcert\\f[R] command without using the\n+\\f[CB]\\-noprompt\\f[R] option.\n@@ -2068,3 +2072,3 @@\n-Replace the self-signed certificate with a certificate chain, where each\n-certificate in the chain authenticates the public key of the signer of\n-the previous certificate in the chain, up to a root CA.\n+Replace the self\\-signed certificate with a certificate chain, where\n+each certificate in the chain authenticates the public key of the signer\n+of the previous certificate in the chain, up to a root CA.\n@@ -2077,2 +2081,2 @@\n-\\f[V]keytool -importcert -alias\\f[R] \\f[I]alias\\f[R]\n-\\f[V]-file *X*\\f[R].cer\\[ga]\n+\\f[CB]keytool\\ \\-importcert\\ \\-alias\\f[R] \\f[I]alias\\f[R]\n+\\f[CB]\\-file\\ *X*\\f[R].cer`\n@@ -2089,3 +2093,3 @@\n-already such a certificate in the \\f[V]cacerts\\f[R] file), you can\n-import the certificate reply and replace your self-signed certificate\n-with a certificate chain.\n+already such a certificate in the \\f[CB]cacerts\\f[R] file), you can import\n+the certificate reply and replace your self\\-signed certificate with a\n+certificate chain.\n@@ -2100,1 +2104,1 @@\n-the reply or in the \\f[V]cacerts\\f[R] keystore file.\n+the reply or in the \\f[CB]cacerts\\f[R] keystore file.\n@@ -2108,1 +2112,1 @@\n-\\f[V]DCmyname.cer\\f[R].\n+\\f[CB]DCmyname.cer\\f[R].\n@@ -2111,1 +2115,1 @@\n-\\f[V]keytool -importcert -trustcacerts -file DCmyname.cer\\f[R]\n+\\f[CB]keytool\\ \\-importcert\\ \\-trustcacerts\\ \\-file\\ DCmyname.cer\\f[R]\n@@ -2117,1 +2121,1 @@\n-If you used the \\f[V]jarsigner\\f[R] command to sign a Java Archive (JAR)\n+If you used the \\f[CB]jarsigner\\f[R] command to sign a Java Archive (JAR)\n@@ -2127,1 +2131,1 @@\n-Copy your certificate to a file named \\f[V]myname.cer\\f[R] by entering\n+Copy your certificate to a file named \\f[CB]myname.cer\\f[R] by entering\n@@ -2133,1 +2137,1 @@\n-In this example, the entry has an alias of \\f[V]mykey\\f[R].\n+In this example, the entry has an alias of \\f[CB]mykey\\f[R].\n@@ -2136,1 +2140,1 @@\n-\\f[V]keytool -exportcert -alias mykey -file myname.cer\\f[R]\n+\\f[CB]keytool\\ \\-exportcert\\ \\-alias\\ mykey\\ \\-file\\ myname.cer\\f[R]\n@@ -2141,1 +2145,1 @@\n-\\f[V]jarsigner\\f[R] command to authenticate your signature.\n+\\f[CB]jarsigner\\f[R] command to authenticate your signature.\n@@ -2144,1 +2148,1 @@\n-Use the \\f[V]importkeystore\\f[R] command to import an entire keystore\n+Use the \\f[CB]importkeystore\\f[R] command to import an entire keystore\n@@ -2153,1 +2157,1 @@\n-If the \\f[V]keytool\\f[R] command can\\[aq]t recover the private keys or\n+If the \\f[CB]keytool\\f[R] command can\\[aq]t recover the private keys or\n@@ -2157,2 +2161,2 @@\n-you can specify a new alias or simply allow the \\f[V]keytool\\f[R]\n-command to overwrite the existing one.\n+you can specify a new alias or simply allow the \\f[CB]keytool\\f[R] command\n+to overwrite the existing one.\n@@ -2161,1 +2165,1 @@\n-\\f[V]key.jks\\f[R] into a PKCS #11 type hardware-based keystore, by\n+\\f[CB]key.jks\\f[R] into a PKCS #11 type hardware\\-based keystore, by\n@@ -2165,2 +2169,2 @@\n-\\f[V]keytool -importkeystore -srckeystore key.jks -destkeystore NONE -srcstoretype JKS -deststoretype PKCS11 -srcstorepass\\f[R]\n-\\f[I]password\\f[R] \\f[V]-deststorepass\\f[R] \\f[I]password\\f[R]\n+\\f[CB]keytool\\ \\-importkeystore\\ \\-srckeystore\\ key.jks\\ \\-destkeystore\\ NONE\\ \\-srcstoretype\\ JKS\\ \\-deststoretype\\ PKCS11\\ \\-srcstorepass\\f[R]\n+\\f[I]password\\f[R] \\f[CB]\\-deststorepass\\f[R] \\f[I]password\\f[R]\n@@ -2169,1 +2173,1 @@\n-The \\f[V]importkeystore\\f[R] command can also be used to import a single\n+The \\f[CB]importkeystore\\f[R] command can also be used to import a single\n@@ -2173,1 +2177,1 @@\n-With the \\f[V]-srcalias\\f[R] option specified, you can also specify the\n+With the \\f[CB]\\-srcalias\\f[R] option specified, you can also specify the\n@@ -2178,5 +2182,5 @@\n-\\f[V]keytool -importkeystore -srckeystore key.jks -destkeystore NONE -srcstoretype JKS -deststoretype PKCS11 -srcstorepass\\f[R]\n-\\f[I]password\\f[R] \\f[V]-deststorepass\\f[R] \\f[I]password\\f[R]\n-\\f[V]-srcalias myprivatekey -destalias myoldprivatekey -srckeypass\\f[R]\n-\\f[I]password\\f[R] \\f[V]-destkeypass\\f[R] \\f[I]password\\f[R]\n-\\f[V]-noprompt\\f[R]\n+\\f[CB]keytool\\ \\-importkeystore\\ \\-srckeystore\\ key.jks\\ \\-destkeystore\\ NONE\\ \\-srcstoretype\\ JKS\\ \\-deststoretype\\ PKCS11\\ \\-srcstorepass\\f[R]\n+\\f[I]password\\f[R] \\f[CB]\\-deststorepass\\f[R] \\f[I]password\\f[R]\n+\\f[CB]\\-srcalias\\ myprivatekey\\ \\-destalias\\ myoldprivatekey\\ \\-srckeypass\\f[R]\n+\\f[I]password\\f[R] \\f[CB]\\-destkeypass\\f[R] \\f[I]password\\f[R]\n+\\f[CB]\\-noprompt\\f[R]\n@@ -2186,1 +2190,1 @@\n-The following are \\f[V]keytool\\f[R] commands used to generate key pairs\n+The following are \\f[CB]keytool\\f[R] commands used to generate key pairs\n@@ -2189,1 +2193,1 @@\n-Root CA (\\f[V]root\\f[R])\n+Root CA (\\f[CB]root\\f[R])\n@@ -2191,1 +2195,1 @@\n-Intermediate CA (\\f[V]ca\\f[R])\n+Intermediate CA (\\f[CB]ca\\f[R])\n@@ -2193,1 +2197,1 @@\n-SSL server (\\f[V]server\\f[R])\n+SSL server (\\f[CB]server\\f[R])\n@@ -2199,3 +2203,3 @@\n-keytool -genkeypair -keystore root.jks -alias root -ext bc:c -keyalg rsa\n-keytool -genkeypair -keystore ca.jks -alias ca -ext bc:c -keyalg rsa\n-keytool -genkeypair -keystore server.jks -alias server -keyalg rsa\n+keytool\\ \\-genkeypair\\ \\-keystore\\ root.jks\\ \\-alias\\ root\\ \\-ext\\ bc:c\\ \\-keyalg\\ rsa\n+keytool\\ \\-genkeypair\\ \\-keystore\\ ca.jks\\ \\-alias\\ ca\\ \\-ext\\ bc:c\\ \\-keyalg\\ rsa\n+keytool\\ \\-genkeypair\\ \\-keystore\\ server.jks\\ \\-alias\\ server\\ \\-keyalg\\ rsa\n@@ -2203,1 +2207,1 @@\n-keytool -keystore root.jks -alias root -exportcert -rfc > root.pem\n+keytool\\ \\-keystore\\ root.jks\\ \\-alias\\ root\\ \\-exportcert\\ \\-rfc\\ >\\ root.pem\n@@ -2205,4 +2209,4 @@\n-keytool -storepass password -keystore ca.jks -certreq -alias ca |\n-    keytool -storepass password -keystore root.jks\n-    -gencert -alias root -ext BC=0 -rfc > ca.pem\n-keytool -keystore ca.jks -importcert -alias ca -file ca.pem\n+keytool\\ \\-storepass\\ password\\ \\-keystore\\ ca.jks\\ \\-certreq\\ \\-alias\\ ca\\ |\n+\\ \\ \\ \\ keytool\\ \\-storepass\\ password\\ \\-keystore\\ root.jks\n+\\ \\ \\ \\ \\-gencert\\ \\-alias\\ root\\ \\-ext\\ BC=0\\ \\-rfc\\ >\\ ca.pem\n+keytool\\ \\-keystore\\ ca.jks\\ \\-importcert\\ \\-alias\\ ca\\ \\-file\\ ca.pem\n@@ -2210,5 +2214,5 @@\n-keytool -storepass password -keystore server.jks -certreq -alias server |\n-    keytool -storepass password -keystore ca.jks -gencert -alias ca\n-    -ext ku:c=dig,kE -rfc > server.pem\n-cat root.pem ca.pem server.pem |\n-    keytool -keystore server.jks -importcert -alias server\n+keytool\\ \\-storepass\\ password\\ \\-keystore\\ server.jks\\ \\-certreq\\ \\-alias\\ server\\ |\n+\\ \\ \\ \\ keytool\\ \\-storepass\\ password\\ \\-keystore\\ ca.jks\\ \\-gencert\\ \\-alias\\ ca\n+\\ \\ \\ \\ \\-ext\\ ku:c=dig,kE\\ \\-rfc\\ >\\ server.pem\n+cat\\ root.pem\\ ca.pem\\ server.pem\\ |\n+\\ \\ \\ \\ keytool\\ \\-keystore\\ server.jks\\ \\-importcert\\ \\-alias\\ server\n@@ -2219,1 +2223,1 @@\n-Keystore\n+.B Keystore\n@@ -2222,0 +2226,2 @@\n+.RS\n+.RE\n@@ -2223,1 +2229,1 @@\n-Keystore entries\n+.B Keystore entries\n@@ -2225,1 +2231,1 @@\n-The two most applicable entry types for the \\f[V]keytool\\f[R] command\n+The two most applicable entry types for the \\f[CB]keytool\\f[R] command\n@@ -2236,3 +2242,3 @@\n-The \\f[V]keytool\\f[R] command can handle both types of entries, while\n-the \\f[V]jarsigner\\f[R] tool only handles the latter type of entry, that\n-is private keys and their associated certificate chains.\n+The \\f[CB]keytool\\f[R] command can handle both types of entries, while the\n+\\f[CB]jarsigner\\f[R] tool only handles the latter type of entry, that is\n+private keys and their associated certificate chains.\n@@ -2249,1 +2255,1 @@\n-Keystore aliases\n+.B Keystore aliases\n@@ -2255,3 +2261,3 @@\n-\\f[V]-genseckey\\f[R] command to generate a secret key, the\n-\\f[V]-genkeypair\\f[R] command to generate a key pair (public and private\n-key), or the \\f[V]-importcert\\f[R] command to add a certificate or\n+\\f[CB]\\-genseckey\\f[R] command to generate a secret key, the\n+\\f[CB]\\-genkeypair\\f[R] command to generate a key pair (public and private\n+key), or the \\f[CB]\\-importcert\\f[R] command to add a certificate or\n@@ -2259,1 +2265,1 @@\n-Subsequent \\f[V]keytool\\f[R] commands must use this same alias to refer\n+Subsequent \\f[CB]keytool\\f[R] commands must use this same alias to refer\n@@ -2262,2 +2268,2 @@\n-For example, you can use the alias \\f[V]duke\\f[R] to generate a new\n-public\/private key pair and wrap the public key into a self-signed\n+For example, you can use the alias \\f[CB]duke\\f[R] to generate a new\n+public\/private key pair and wrap the public key into a self\\-signed\n@@ -2268,1 +2274,1 @@\n-\\f[V]keytool -genkeypair -alias duke -keyalg rsa -keypass\\f[R]\n+\\f[CB]keytool\\ \\-genkeypair\\ \\-alias\\ duke\\ \\-keyalg\\ rsa\\ \\-keypass\\f[R]\n@@ -2272,3 +2278,3 @@\n-This example specifies an initial \\f[I]passwd\\f[R] required by\n-subsequent commands to access the private key associated with the alias\n-\\f[V]duke\\f[R].\n+This example specifies an initial \\f[I]passwd\\f[R] required by subsequent\n+commands to access the private key associated with the alias\n+\\f[CB]duke\\f[R].\n@@ -2279,2 +2285,2 @@\n-\\f[V]keytool -keypasswd -alias duke -keypass\\f[R] \\f[I]passwd\\f[R]\n-\\f[V]-new\\f[R] \\f[I]newpasswd\\f[R]\n+\\f[CB]keytool\\ \\-keypasswd\\ \\-alias\\ duke\\ \\-keypass\\f[R] \\f[I]passwd\\f[R]\n+\\f[CB]\\-new\\f[R] \\f[I]newpasswd\\f[R]\n@@ -2290,3 +2296,3 @@\n-Keystore implementation\n-The \\f[V]KeyStore\\f[R] class provided in the \\f[V]java.security\\f[R]\n-package supplies well-defined interfaces to access and modify the\n+.B Keystore implementation\n+The \\f[CB]KeyStore\\f[R] class provided in the \\f[CB]java.security\\f[R]\n+package supplies well\\-defined interfaces to access and modify the\n@@ -2299,4 +2305,4 @@\n-Currently, two command-line tools (\\f[V]keytool\\f[R] and\n-\\f[V]jarsigner\\f[R]) make use of keystore implementations.\n-Because the \\f[V]KeyStore\\f[R] class is \\f[V]public\\f[R], users can\n-write additional security applications that use it.\n+Currently, two command\\-line tools (\\f[CB]keytool\\f[R] and\n+\\f[CB]jarsigner\\f[R]) make use of keystore implementations.\n+Because the \\f[CB]KeyStore\\f[R] class is \\f[CB]public\\f[R], users can write\n+additional security applications that use it.\n@@ -2305,1 +2311,1 @@\n-\\f[V]PKCS12\\f[R].\n+\\f[CB]PKCS12\\f[R].\n@@ -2310,1 +2316,1 @@\n-There is another built-in implementation, provided by Oracle.\n+There is another built\\-in implementation, provided by Oracle.\n@@ -2312,1 +2318,1 @@\n-(format) named \\f[V]JKS\\f[R].\n+(format) named \\f[CB]JKS\\f[R].\n@@ -2317,1 +2323,1 @@\n-Keystore implementations are provider-based.\n+Keystore implementations are provider\\-based.\n@@ -2319,1 +2325,1 @@\n-\\f[V]KeyStore\\f[R] are implemented in terms of a Service Provider\n+\\f[CB]KeyStore\\f[R] are implemented in terms of a Service Provider\n@@ -2321,2 +2327,2 @@\n-That is, there is a corresponding abstract \\f[V]KeystoreSpi\\f[R] class,\n-also in the \\f[V]java.security package\\f[R], which defines the Service\n+That is, there is a corresponding abstract \\f[CB]KeystoreSpi\\f[R] class,\n+also in the \\f[CB]java.security\\ package\\f[R], which defines the Service\n@@ -2324,3 +2330,3 @@\n-The term \\f[I]provider\\f[R] refers to a package or a set of packages\n-that supply a concrete implementation of a subset of services that can\n-be accessed by the Java Security API.\n+The term \\f[I]provider\\f[R] refers to a package or a set of packages that\n+supply a concrete implementation of a subset of services that can be\n+accessed by the Java Security API.\n@@ -2328,1 +2334,1 @@\n-and supply a \\f[V]KeystoreSpi\\f[R] subclass implementation, as described\n+and supply a \\f[CB]KeystoreSpi\\f[R] subclass implementation, as described\n@@ -2332,2 +2338,2 @@\n-different providers, using the \\f[V]getInstance\\f[R] factory method\n-supplied in the \\f[V]KeyStore\\f[R] class.\n+different providers, using the \\f[CB]getInstance\\f[R] factory method\n+supplied in the \\f[CB]KeyStore\\f[R] class.\n@@ -2339,1 +2345,1 @@\n-The \\f[V]keytool\\f[R] command works on any file-based keystore\n+The \\f[CB]keytool\\f[R] command works on any file\\-based keystore\n@@ -2342,4 +2348,3 @@\n-as a file name and converts it to a \\f[V]FileInputStream\\f[R], from\n-which it loads the keystore information.)The \\f[V]jarsigner\\f[R]\n-commands can read a keystore from any location that can be specified\n-with a URL.\n+as a file name and converts it to a \\f[CB]FileInputStream\\f[R], from which\n+it loads the keystore information.)The \\f[CB]jarsigner\\f[R] commands can\n+read a keystore from any location that can be specified with a URL.\n@@ -2347,2 +2352,2 @@\n-For \\f[V]keytool\\f[R] and \\f[V]jarsigner\\f[R], you can specify a\n-keystore type at the command line, with the \\f[V]-storetype\\f[R] option.\n+For \\f[CB]keytool\\f[R] and \\f[CB]jarsigner\\f[R], you can specify a keystore\n+type at the command line, with the \\f[CB]\\-storetype\\f[R] option.\n@@ -2352,1 +2357,1 @@\n-\\f[V]keystore.type\\f[R] property specified in the security properties\n+\\f[CB]keystore.type\\f[R] property specified in the security properties\n@@ -2354,1 +2359,1 @@\n-The security properties file is called \\f[V]java.security\\f[R], and\n+The security properties file is called \\f[CB]java.security\\f[R], and\n@@ -2357,1 +2362,1 @@\n-\\f[B]Linux and OS X:\\f[R] \\f[V]java.home\/lib\/security\\f[R]\n+\\f[B]Linux and OS X:\\f[R] \\f[CB]java.home\/lib\/security\\f[R]\n@@ -2359,1 +2364,1 @@\n-\\f[B]Windows:\\f[R] \\f[V]java.home\\[rs]lib\\[rs]security\\f[R]\n+\\f[B]Windows:\\f[R] \\f[CB]java.home\\\\lib\\\\security\\f[R]\n@@ -2361,1 +2366,1 @@\n-Each tool gets the \\f[V]keystore.type\\f[R] value and then examines all\n+Each tool gets the \\f[CB]keystore.type\\f[R] value and then examines all\n@@ -2365,3 +2370,3 @@\n-\\f[V]KeyStore\\f[R] class defines a static method named\n-\\f[V]getDefaultType\\f[R] that lets applications retrieve the value of\n-the \\f[V]keystore.type\\f[R] property.\n+\\f[CB]KeyStore\\f[R] class defines a static method named\n+\\f[CB]getDefaultType\\f[R] that lets applications retrieve the value of the\n+\\f[CB]keystore.type\\f[R] property.\n@@ -2369,1 +2374,1 @@\n-type as specified in the \\f[V]keystore.type\\f[R] property:\n+type as specified in the \\f[CB]keystore.type\\f[R] property:\n@@ -2372,1 +2377,1 @@\n-\\f[V]KeyStore keyStore = KeyStore.getInstance(KeyStore.getDefaultType());\\f[R]\n+\\f[CB]KeyStore\\ keyStore\\ =\\ KeyStore.getInstance(KeyStore.getDefaultType());\\f[R]\n@@ -2375,1 +2380,1 @@\n-The default keystore type is \\f[V]pkcs12\\f[R], which is a cross-platform\n+The default keystore type is \\f[CB]pkcs12\\f[R], which is a cross\\-platform\n@@ -2381,1 +2386,1 @@\n-\\f[V]keystore.type=pkcs12\\f[R]\n+\\f[CB]keystore.type=pkcs12\\f[R]\n@@ -2386,1 +2391,1 @@\n-For example, if you want to use the Oracle\\[aq]s \\f[V]jks\\f[R] keystore\n+For example, if you want to use the Oracle\\[aq]s \\f[CB]jks\\f[R] keystore\n@@ -2390,1 +2395,1 @@\n-\\f[V]keystore.type=jks\\f[R]\n+\\f[CB]keystore.type=jks\\f[R]\n@@ -2396,2 +2401,1 @@\n-For example, \\f[V]JKS\\f[R] would be considered the same as\n-\\f[V]jks\\f[R].\n+For example, \\f[CB]JKS\\f[R] would be considered the same as \\f[CB]jks\\f[R].\n@@ -2400,2 +2404,2 @@\n-Certificate\n-A certificate (or public-key certificate) is a digitally signed\n+.B Certificate\n+A certificate (or public\\-key certificate) is a digitally signed\n@@ -2442,1 +2446,1 @@\n-In a large-scale networked environment, it is impossible to guarantee\n+In a large\\-scale networked environment, it is impossible to guarantee\n@@ -2458,1 +2462,1 @@\n-With the \\f[V]keytool\\f[R] command, it is possible to display, import,\n+With the \\f[CB]keytool\\f[R] command, it is possible to display, import,\n@@ -2460,1 +2464,1 @@\n-It is also possible to generate self-signed certificates.\n+It is also possible to generate self\\-signed certificates.\n@@ -2462,1 +2466,1 @@\n-The \\f[V]keytool\\f[R] command currently handles X.509 certificates.\n+The \\f[CB]keytool\\f[R] command currently handles X.509 certificates.\n@@ -2465,1 +2469,1 @@\n-X.509 Certificates\n+.B X.509 Certificates\n@@ -2481,1 +2485,1 @@\n-The \\f[V]keytool\\f[R] command can import and export v1, v2, and v3\n+The \\f[CB]keytool\\f[R] command can import and export v1, v2, and v3\n@@ -2501,1 +2505,1 @@\n-particular purposes such as \\f[V]signing-only\\f[R]) and AlternativeNames\n+particular purposes such as \\f[CB]signing\\-only\\f[R]) and AlternativeNames\n@@ -2508,4 +2512,4 @@\n-and set to \\f[V]keyCertSign\\f[R], then when this certificate is\n-presented during SSL communication, it should be rejected because the\n-certificate extension indicates that the associated private key should\n-only be used for signing certificates and not for SSL use.\n+and set to \\f[CB]keyCertSign\\f[R], then when this certificate is presented\n+during SSL communication, it should be rejected because the certificate\n+extension indicates that the associated private key should only be used\n+for signing certificates and not for SSL use.\n@@ -2529,1 +2533,1 @@\n-In some cases, such as root or top-level CA certificates, the issuer\n+In some cases, such as root or top\\-level CA certificates, the issuer\n@@ -2552,1 +2556,1 @@\n-\\f[V]CN=Java Duke, OU=Java Software Division, O=Oracle Corporation, C=US\\f[R]\n+\\f[CB]CN=Java\\ Duke,\\ OU=Java\\ Software\\ Division,\\ O=Oracle\\ Corporation,\\ C=US\\f[R]\n@@ -2564,2 +2568,2 @@\n-Certificate Chains\n-The \\f[V]keytool\\f[R] command can create and manage keystore key entries\n+.B Certificate Chains\n+The \\f[CB]keytool\\f[R] command can create and manage keystore key entries\n@@ -2572,3 +2576,3 @@\n-single element, a self-signed certificate.\n-See -genkeypair in \\f[B]Commands\\f[R].\n-A self-signed certificate is one for which the issuer (signer) is the\n+single element, a self\\-signed certificate.\n+See \\-genkeypair in \\f[B]Commands\\f[R].\n+A self\\-signed certificate is one for which the issuer (signer) is the\n@@ -2578,3 +2582,4 @@\n-When the \\f[V]-genkeypair\\f[R] command is called to generate a new\n-public\/private key pair, it also wraps the public key into a self-signed\n-certificate (unless the \\f[V]-signer\\f[R] option is specified).\n+When the \\f[CB]\\-genkeypair\\f[R] command is called to generate a new\n+public\/private key pair, it also wraps the public key into a\n+self\\-signed certificate (unless the \\f[CB]\\-signer\\f[R] option is\n+specified).\n@@ -2583,3 +2588,3 @@\n-\\f[V]-certreq\\f[R] command and sent to a Certification Authority (CA),\n-the response from the CA is imported with \\f[V]-importcert\\f[R], and the\n-self-signed certificate is replaced by a chain of certificates.\n+\\f[CB]\\-certreq\\f[R] command and sent to a Certification Authority (CA),\n+the response from the CA is imported with \\f[CB]\\-importcert\\f[R], and the\n+self\\-signed certificate is replaced by a chain of certificates.\n@@ -2591,3 +2596,3 @@\n-In many cases, this is a self-signed certificate, which is a certificate\n-from the CA authenticating its own public key, and the last certificate\n-in the chain.\n+In many cases, this is a self\\-signed certificate, which is a\n+certificate from the CA authenticating its own public key, and the last\n+certificate in the chain.\n@@ -2601,2 +2606,2 @@\n-the second CA\\[aq]s key, and so on, until a self-signed root certificate\n-is reached.\n+the second CA\\[aq]s key, and so on, until a self\\-signed root\n+certificate is reached.\n@@ -2613,1 +2618,1 @@\n-Both reply formats can be handled by the \\f[V]keytool\\f[R] command.\n+Both reply formats can be handled by the \\f[CB]keytool\\f[R] command.\n@@ -2615,1 +2620,1 @@\n-The top-level (root) CA certificate is self-signed.\n+The top\\-level (root) CA certificate is self\\-signed.\n@@ -2618,1 +2623,1 @@\n-This is because anybody could generate a self-signed certificate with\n+This is because anybody could generate a self\\-signed certificate with\n@@ -2625,2 +2630,2 @@\n-it with the \\f[V]-printcert\\f[R] option and compare the displayed\n-fingerprint with the well-known fingerprint obtained from a newspaper,\n+it with the \\f[CB]\\-printcert\\f[R] option and compare the displayed\n+fingerprint with the well\\-known fingerprint obtained from a newspaper,\n@@ -2630,2 +2635,2 @@\n-cacerts Certificates File\n-A certificates file named \\f[V]cacerts\\f[R] resides in the security\n+.B cacerts Certificates File\n+A certificates file named \\f[CB]cacerts\\f[R] resides in the security\n@@ -2635,1 +2640,1 @@\n-\\f[B]Linux and OS X:\\f[R] \\f[I]JAVA_HOME\\f[R]\\f[V]\/lib\/security\\f[R]\n+\\f[B]Linux and OS X:\\f[R] \\f[I]JAVA_HOME\\f[R]\\f[CB]\/lib\/security\\f[R]\n@@ -2637,1 +2642,1 @@\n-\\f[B]Windows:\\f[R] \\f[I]JAVA_HOME\\f[R]\\f[V]\\[rs]lib\\[rs]security\\f[R]\n+\\f[B]Windows:\\f[R] \\f[I]JAVA_HOME\\f[R]\\f[CB]\\\\lib\\\\security\\f[R]\n@@ -2639,1 +2644,1 @@\n-The \\f[V]cacerts\\f[R] file represents a system-wide keystore with CA\n+The \\f[CB]cacerts\\f[R] file represents a system\\-wide keystore with CA\n@@ -2642,1 +2647,1 @@\n-\\f[V]keytool\\f[R] command by specifying \\f[V]jks\\f[R] as the keystore\n+\\f[CB]keytool\\f[R] command by specifying \\f[CB]jks\\f[R] as the keystore\n@@ -2644,1 +2649,1 @@\n-The \\f[V]cacerts\\f[R] keystore file ships with a default set of root CA\n+The \\f[CB]cacerts\\f[R] keystore file ships with a default set of root CA\n@@ -2650,1 +2655,1 @@\n-\\f[V]keytool -list -cacerts\\f[R]\n+\\f[CB]keytool\\ \\-list\\ \\-cacerts\\f[R]\n@@ -2653,2 +2658,2 @@\n-The initial password of the \\f[V]cacerts\\f[R] keystore file is\n-\\f[V]changeit\\f[R].\n+The initial password of the \\f[CB]cacerts\\f[R] keystore file is\n+\\f[CB]changeit\\f[R].\n@@ -2660,2 +2665,2 @@\n-It is important to verify your \\f[V]cacerts\\f[R] file.\n-Because you trust the CAs in the \\f[V]cacerts\\f[R] file as entities for\n+It is important to verify your \\f[CB]cacerts\\f[R] file.\n+Because you trust the CAs in the \\f[CB]cacerts\\f[R] file as entities for\n@@ -2663,2 +2668,2 @@\n-\\f[V]cacerts\\f[R] file carefully.\n-The \\f[V]cacerts\\f[R] file should contain only certificates of the CAs\n+\\f[CB]cacerts\\f[R] file carefully.\n+The \\f[CB]cacerts\\f[R] file should contain only certificates of the CAs\n@@ -2667,1 +2672,1 @@\n-bundled in the \\f[V]cacerts\\f[R] file and make your own trust decisions.\n+bundled in the \\f[CB]cacerts\\f[R] file and make your own trust decisions.\n@@ -2669,4 +2674,4 @@\n-To remove an untrusted CA certificate from the \\f[V]cacerts\\f[R] file,\n-use the \\f[V]-delete\\f[R] option of the \\f[V]keytool\\f[R] command.\n-You can find the \\f[V]cacerts\\f[R] file in the JDK\\[aq]s\n-\\f[V]$JAVA_HOME\/lib\/security\\f[R] directory.\n+To remove an untrusted CA certificate from the \\f[CB]cacerts\\f[R] file,\n+use the \\f[CB]\\-delete\\f[R] option of the \\f[CB]keytool\\f[R] command.\n+You can find the \\f[CB]cacerts\\f[R] file in the JDK\\[aq]s\n+\\f[CB]$JAVA_HOME\/lib\/security\\f[R] directory.\n@@ -2677,1 +2682,1 @@\n-Internet RFC 1421 Certificate Encoding Standard\n+.B Internet RFC 1421 Certificate Encoding Standard\n@@ -2686,1 +2691,1 @@\n-Certificates read by the \\f[V]-importcert\\f[R] and \\f[V]-printcert\\f[R]\n+Certificates read by the \\f[CB]\\-importcert\\f[R] and \\f[CB]\\-printcert\\f[R]\n@@ -2688,1 +2693,1 @@\n-The \\f[V]-exportcert\\f[R] command by default outputs a certificate in\n+The \\f[CB]\\-exportcert\\f[R] command by default outputs a certificate in\n@@ -2690,1 +2695,1 @@\n-encoding format, when the \\f[V]-rfc\\f[R] option is specified.\n+encoding format, when the \\f[CB]\\-rfc\\f[R] option is specified.\n@@ -2692,5 +2697,5 @@\n-The \\f[V]-list\\f[R] command by default prints the SHA-256 fingerprint of\n-a certificate.\n-If the \\f[V]-v\\f[R] option is specified, then the certificate is printed\n-in human-readable format.\n-If the \\f[V]-rfc\\f[R] option is specified, then the certificate is\n+The \\f[CB]\\-list\\f[R] command by default prints the SHA\\-256 fingerprint\n+of a certificate.\n+If the \\f[CB]\\-v\\f[R] option is specified, then the certificate is printed\n+in human\\-readable format.\n+If the \\f[CB]\\-rfc\\f[R] option is specified, then the certificate is\n@@ -2704,1 +2709,1 @@\n------BEGIN CERTIFICATE-----\n+\\-\\-\\-\\-\\-BEGIN\\ CERTIFICATE\\-\\-\\-\\-\\-\n@@ -2706,1 +2711,1 @@\n-encoded certificate goes here.\n+encoded\\ certificate\\ goes\\ here.\n@@ -2708,1 +2713,1 @@\n------END CERTIFICATE-----\n+\\-\\-\\-\\-\\-END\\ CERTIFICATE\\-\\-\\-\\-\\-\n@@ -2713,1 +2718,1 @@\n-X.500 Distinguished Names\n+.B X.500 Distinguished Names\n@@ -2715,1 +2720,1 @@\n-that are named by the \\f[V]subject\\f[R] and \\f[V]issuer\\f[R] (signer)\n+that are named by the \\f[CB]subject\\f[R] and \\f[CB]issuer\\f[R] (signer)\n@@ -2717,1 +2722,1 @@\n-The \\f[V]keytool\\f[R] command supports the following subparts:\n+The \\f[CB]keytool\\f[R] command supports the following subparts:\n@@ -2730,1 +2735,1 @@\n-country: Two-letter country code, for example, CH.\n+country: Two\\-letter country code, for example, CH.\n@@ -2733,1 +2738,1 @@\n-\\f[V]-dname\\f[R] option, such as for the \\f[V]-genkeypair\\f[R] command,\n+\\f[CB]\\-dname\\f[R] option, such as for the \\f[CB]\\-genkeypair\\f[R] command,\n@@ -2737,1 +2742,1 @@\n-\\f[V]CN=cName, OU=orgUnit, O=org, L=city, S=state, C=countryCode\\f[R]\n+\\f[CB]CN=cName,\\ OU=orgUnit,\\ O=org,\\ L=city,\\ S=state,\\ C=countryCode\\f[R]\n@@ -2757,1 +2762,1 @@\n-\\f[V]CN=Mark Smith, OU=Java, O=Oracle, L=Cupertino, S=California, C=US\\f[R]\n+\\f[CB]CN=Mark\\ Smith,\\ OU=Java,\\ O=Oracle,\\ L=Cupertino,\\ S=California,\\ C=US\\f[R]\n@@ -2763,1 +2768,1 @@\n-\\f[V]keytool -genkeypair -dname \\[dq]CN=Mark Smith, OU=Java, O=Oracle, L=Cupertino, S=California, C=US\\[dq] -alias mark -keyalg rsa\\f[R]\n+\\f[CB]keytool\\ \\-genkeypair\\ \\-dname\\ \"CN=Mark\\ Smith,\\ OU=Java,\\ O=Oracle,\\ L=Cupertino,\\ S=California,\\ C=US\"\\ \\-alias\\ mark\\ \\-keyalg\\ rsa\\f[R]\n@@ -2774,1 +2779,1 @@\n-\\f[V]CN=Smith, OU=Java, O=Oracle, C=US\\f[R]\n+\\f[CB]CN=Smith,\\ OU=Java,\\ O=Oracle,\\ C=US\\f[R]\n@@ -2778,1 +2783,1 @@\n-must be escaped by a backslash (\\[rs]) character when you specify the\n+must be escaped by a backslash (\\\\) character when you specify the\n@@ -2782,1 +2787,1 @@\n-\\f[V]cn=Jack, ou=Java\\[rs], Product Development, o=Oracle, c=US\\f[R]\n+\\f[CB]cn=Jack,\\ ou=Java\\\\,\\ Product\\ Development,\\ o=Oracle,\\ c=US\\f[R]\n@@ -2790,1 +2795,1 @@\n-(\\[rs]).\n+(\\\\).\n@@ -2795,2 +2800,2 @@\n-\\f[B]Important\\f[R]: Be sure to check a certificate very carefully\n-before importing it as a trusted certificate.\n+\\f[B]Important\\f[R]: Be sure to check a certificate very carefully before\n+importing it as a trusted certificate.\n@@ -2800,2 +2805,2 @@\n-View the certificate first with the \\f[V]-printcert\\f[R] command or the\n-\\f[V]-importcert\\f[R] command without the \\f[V]-noprompt\\f[R] option.\n+View the certificate first with the \\f[CB]\\-printcert\\f[R] command or the\n+\\f[CB]\\-importcert\\f[R] command without the \\f[CB]\\-noprompt\\f[R] option.\n@@ -2805,1 +2810,1 @@\n-put it in a file named \\f[V]\\[rs]tmp\\[rs]cert\\f[R].\n+put it in a file named \\f[CB]\\\\tmp\\\\cert\\f[R].\n@@ -2807,1 +2812,1 @@\n-certificates, you can execute a \\f[V]-printcert\\f[R] command to view its\n+certificates, you can execute a \\f[CB]\\-printcert\\f[R] command to view its\n@@ -2812,6 +2817,6 @@\n-  keytool -printcert -file \\[rs]tmp\\[rs]cert\n-    Owner: CN=ll, OU=ll, O=ll, L=ll, S=ll, C=ll\n-    Issuer: CN=ll, OU=ll, O=ll, L=ll, S=ll, C=ll\n-    Serial Number: 59092b34\n-    Valid from: Thu Jun 24 18:01:13 PDT 2016 until: Wed Jun 23 17:01:13 PST 2016\n-    Certificate Fingerprints:\n+\\ \\ keytool\\ \\-printcert\\ \\-file\\ \\\\tmp\\\\cert\n+\\ \\ \\ \\ Owner:\\ CN=ll,\\ OU=ll,\\ O=ll,\\ L=ll,\\ S=ll,\\ C=ll\n+\\ \\ \\ \\ Issuer:\\ CN=ll,\\ OU=ll,\\ O=ll,\\ L=ll,\\ S=ll,\\ C=ll\n+\\ \\ \\ \\ Serial\\ Number:\\ 59092b34\n+\\ \\ \\ \\ Valid\\ from:\\ Thu\\ Jun\\ 24\\ 18:01:13\\ PDT\\ 2016\\ until:\\ Wed\\ Jun\\ 23\\ 17:01:13\\ PST\\ 2016\n+\\ \\ \\ \\ Certificate\\ Fingerprints:\n@@ -2819,3 +2824,3 @@\n-                   SHA-1: 20:B6:17:FA:EF:E5:55:8A:D0:71:1F:E8:D6:9D:C0:37:13:0E:5E:FE\n-                 SHA-256: 90:7B:70:0A:EA:DC:16:79:92:99:41:FF:8A:FE:EB:90:\n-                          17:75:E0:90:B2:24:4D:3A:2A:16:A6:E4:11:0F:67:A4\n+\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ SHA\\-1:\\ 20:B6:17:FA:EF:E5:55:8A:D0:71:1F:E8:D6:9D:C0:37:13:0E:5E:FE\n+\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ SHA\\-256:\\ 90:7B:70:0A:EA:DC:16:79:92:99:41:FF:8A:FE:EB:90:\n+\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ 17:75:E0:90:B2:24:4D:3A:2A:16:A6:E4:11:0F:67:A4\n@@ -2827,2 +2832,2 @@\n-View the certificate first with the \\f[V]-printcert\\f[R] command or the\n-\\f[V]-importcert\\f[R] command without the \\f[V]-noprompt\\f[R] option.\n+View the certificate first with the \\f[CB]\\-printcert\\f[R] command or the\n+\\f[CB]\\-importcert\\f[R] command without the \\f[CB]\\-noprompt\\f[R] option.\n@@ -2832,1 +2837,1 @@\n-put it in a file named \\f[V]\/tmp\/cert\\f[R].\n+put it in a file named \\f[CB]\/tmp\/cert\\f[R].\n@@ -2834,1 +2839,1 @@\n-certificates, you can execute a \\f[V]-printcert\\f[R] command to view its\n+certificates, you can execute a \\f[CB]\\-printcert\\f[R] command to view its\n@@ -2839,6 +2844,6 @@\n-  keytool -printcert -file \/tmp\/cert\n-    Owner: CN=ll, OU=ll, O=ll, L=ll, S=ll, C=ll\n-    Issuer: CN=ll, OU=ll, O=ll, L=ll, S=ll, C=ll\n-    Serial Number: 59092b34\n-    Valid from: Thu Jun 24 18:01:13 PDT 2016 until: Wed Jun 23 17:01:13 PST 2016\n-    Certificate Fingerprints:\n+\\ \\ keytool\\ \\-printcert\\ \\-file\\ \/tmp\/cert\n+\\ \\ \\ \\ Owner:\\ CN=ll,\\ OU=ll,\\ O=ll,\\ L=ll,\\ S=ll,\\ C=ll\n+\\ \\ \\ \\ Issuer:\\ CN=ll,\\ OU=ll,\\ O=ll,\\ L=ll,\\ S=ll,\\ C=ll\n+\\ \\ \\ \\ Serial\\ Number:\\ 59092b34\n+\\ \\ \\ \\ Valid\\ from:\\ Thu\\ Jun\\ 24\\ 18:01:13\\ PDT\\ 2016\\ until:\\ Wed\\ Jun\\ 23\\ 17:01:13\\ PST\\ 2016\n+\\ \\ \\ \\ Certificate\\ Fingerprints:\n@@ -2846,3 +2851,3 @@\n-                   SHA-1: 20:B6:17:FA:EF:E5:55:8A:D0:71:1F:E8:D6:9D:C0:37:13:0E:5E:FE\n-                   SHA-256: 90:7B:70:0A:EA:DC:16:79:92:99:41:FF:8A:FE:EB:90:\n-                           17:75:E0:90:B2:24:4D:3A:2A:16:A6:E4:11:0F:67:A4\n+\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ SHA\\-1:\\ 20:B6:17:FA:EF:E5:55:8A:D0:71:1F:E8:D6:9D:C0:37:13:0E:5E:FE\n+\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ SHA\\-256:\\ 90:7B:70:0A:EA:DC:16:79:92:99:41:FF:8A:FE:EB:90:\n+\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ 17:75:E0:90:B2:24:4D:3A:2A:16:A6:E4:11:0F:67:A4\n@@ -2863,1 +2868,1 @@\n-It isn\\[aq]t required that you execute a \\f[V]-printcert\\f[R] command\n+It isn\\[aq]t required that you execute a \\f[CB]\\-printcert\\f[R] command\n@@ -2866,1 +2871,1 @@\n-certificates in the keystore, the \\f[V]-importcert\\f[R] command prints\n+certificates in the keystore, the \\f[CB]\\-importcert\\f[R] command prints\n@@ -2869,3 +2874,3 @@\n-However, you can do this only when you call the \\f[V]-importcert\\f[R]\n-command without the \\f[V]-noprompt\\f[R] option.\n-If the \\f[V]-noprompt\\f[R] option is specified, then there is no\n+However, you can do this only when you call the \\f[CB]\\-importcert\\f[R]\n+command without the \\f[CB]\\-noprompt\\f[R] option.\n+If the \\f[CB]\\-noprompt\\f[R] option is specified, then there is no\n@@ -2878,1 +2883,1 @@\n-\\f[V]-storepass\\f[R] and \\f[V]-keypass\\f[R] options.\n+\\f[CB]\\-storepass\\f[R] and \\f[CB]\\-keypass\\f[R] options.\n@@ -2891,1 +2896,1 @@\n-The \\f[V]keytool\\f[R] command doesn\\[aq]t enforce all of these rules so\n+The \\f[CB]keytool\\f[R] command doesn\\[aq]t enforce all of these rules so\n@@ -2893,2 +2898,2 @@\n-such as self-signed certificates that would be used for internal testing\n-purposes.\n+such as self\\-signed certificates that would be used for internal\n+testing purposes.\n@@ -2898,1 +2903,1 @@\n-\\f[V]-dname\\f[R], \\f[V]-ext\\f[R], and so on.\n+\\f[CB]\\-dname\\f[R], \\f[CB]\\-ext\\f[R], and so on.\n@@ -2901,1 +2906,1 @@\n-Before you add the certificate to the keystore, the \\f[V]keytool\\f[R]\n+Before you add the certificate to the keystore, the \\f[CB]keytool\\f[R]\n@@ -2903,1 +2908,1 @@\n-that certificate to a self-signed certificate (belonging to a root CA),\n+that certificate to a self\\-signed certificate (belonging to a root CA),\n@@ -2906,1 +2911,1 @@\n-If the \\f[V]-trustcacerts\\f[R] option was specified, then additional\n+If the \\f[CB]\\-trustcacerts\\f[R] option was specified, then additional\n@@ -2908,1 +2913,1 @@\n-certificates in a file named \\f[V]cacerts\\f[R].\n+certificates in a file named \\f[CB]cacerts\\f[R].\n@@ -2910,3 +2915,3 @@\n-If the \\f[V]keytool\\f[R] command fails to establish a trust path from\n-the certificate to be imported up to a self-signed certificate (either\n-from the keystore or the \\f[V]cacerts\\f[R] file), then the certificate\n+If the \\f[CB]keytool\\f[R] command fails to establish a trust path from the\n+certificate to be imported up to a self\\-signed certificate (either from\n+the keystore or the \\f[CB]cacerts\\f[R] file), then the certificate\n@@ -2920,1 +2925,1 @@\n-If the \\f[V]-noprompt\\f[R] option is specified, then there is no\n+If the \\f[CB]\\-noprompt\\f[R] option is specified, then there is no\n@@ -2926,2 +2931,2 @@\n-certificates configured in the \\f[V]cacerts\\f[R] keystore file when the\n-\\f[V]-trustcacerts\\f[R] option is specified.\n+certificates configured in the \\f[CB]cacerts\\f[R] keystore file when the\n+\\f[CB]\\-trustcacerts\\f[R] option is specified.\n@@ -2932,1 +2937,1 @@\n-If the reply is a single X.509 certificate, then the \\f[V]keytool\\f[R]\n+If the reply is a single X.509 certificate, then the \\f[CB]keytool\\f[R]\n@@ -2934,1 +2939,1 @@\n-reply and ending at a self-signed certificate (belonging to a root CA).\n+reply and ending at a self\\-signed certificate (belonging to a root CA).\n@@ -2940,1 +2945,1 @@\n-In this case, the \\f[V]keytool\\f[R] command doesn\\[aq]t print the\n+In this case, the \\f[CB]keytool\\f[R] command doesn\\[aq]t print the\n@@ -2948,2 +2953,2 @@\n-If the chain ends with a self-signed root CA certificate and\n-the\\f[V]-trustcacerts\\f[R] option was specified, the \\f[V]keytool\\f[R]\n+If the chain ends with a self\\-signed root CA certificate and\n+the\\f[CB]\\-trustcacerts\\f[R] option was specified, the \\f[CB]keytool\\f[R]\n@@ -2951,3 +2956,3 @@\n-keystore or the \\f[V]cacerts\\f[R] keystore file.\n-If the chain doesn\\[aq]t end with a self-signed root CA certificate and\n-the \\f[V]-trustcacerts\\f[R] option was specified, the \\f[V]keytool\\f[R]\n+keystore or the \\f[CB]cacerts\\f[R] keystore file.\n+If the chain doesn\\[aq]t end with a self\\-signed root CA certificate and\n+the \\f[CB]\\-trustcacerts\\f[R] option was specified, the \\f[CB]keytool\\f[R]\n@@ -2955,1 +2960,1 @@\n-or the \\f[V]cacerts\\f[R] keystore file and add it to the end of the\n+or the \\f[CB]cacerts\\f[R] keystore file and add it to the end of the\n@@ -2957,1 +2962,1 @@\n-If the certificate isn\\[aq]t found and the \\f[V]-noprompt\\f[R] option\n+If the certificate isn\\[aq]t found and the \\f[CB]\\-noprompt\\f[R] option\n@@ -2962,1 +2967,1 @@\n-key already stored with \\f[V]alias\\f[R], then the old certificate chain\n+key already stored with \\f[CB]alias\\f[R], then the old certificate chain\n@@ -2964,3 +2969,2 @@\n-The old chain can only be replaced with a valid \\f[V]keypass\\f[R], and\n-so the password used to protect the private key of the entry is\n-supplied.\n+The old chain can only be replaced with a valid \\f[CB]keypass\\f[R], and so\n+the password used to protect the private key of the entry is supplied.\n@@ -2970,1 +2974,1 @@\n-This command was named \\f[V]-import\\f[R] in earlier releases.\n+This command was named \\f[CB]\\-import\\f[R] in earlier releases.\n@@ -2972,1 +2976,1 @@\n-The new name, \\f[V]-importcert\\f[R], is preferred.\n+The new name, \\f[CB]\\-importcert\\f[R], is preferred.\n","filename":"src\/java.base\/share\/man\/keytool.1","additions":1057,"deletions":1053,"binary":false,"changes":2110,"status":"modified"},{"patch":"@@ -1377,2 +1377,0 @@\n-        } else if (JLI_StrCmp(arg, \"--disable-@files\") == 0) {\n-            ; \/* Ignore --disable-@files option already handled *\/\n","filename":"src\/java.base\/share\/native\/libjli\/java.c","additions":0,"deletions":2,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -575,1 +575,1 @@\n-        return getExitCodeProcess(handle);\n+        return exitValue();\n","filename":"src\/java.base\/windows\/classes\/java\/lang\/ProcessImpl.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -491,1 +491,1 @@\n-                            && (chooser.getFileSelectionMode() == JFileChooser.FILES_ONLY\n+                            && (chooser.getFileSelectionMode() != JFileChooser.DIRECTORIES_ONLY\n","filename":"src\/java.desktop\/share\/classes\/com\/sun\/java\/swing\/plaf\/gtk\/GTKFileChooserUI.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -87,3 +87,1 @@\n-     * @return the {@code insets} object\n-     * @throws NullPointerException if the specified {@code insets}\n-     *         is {@code null}\n+     * @return the <code>insets<\/code> object\n","filename":"src\/java.desktop\/share\/classes\/javax\/swing\/border\/AbstractBorder.java","additions":1,"deletions":3,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -145,2 +145,0 @@\n-     * @throws NullPointerException if the specified {@code insets}\n-     *         is {@code null}\n","filename":"src\/java.desktop\/share\/classes\/javax\/swing\/border\/BevelBorder.java","additions":0,"deletions":2,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -140,2 +140,0 @@\n-     * @throws NullPointerException if the specified {@code insets}\n-     *         is {@code null}\n","filename":"src\/java.desktop\/share\/classes\/javax\/swing\/border\/CompoundBorder.java","additions":0,"deletions":2,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -86,2 +86,0 @@\n-     * @throws NullPointerException if the specified {@code borderInsets}\n-     *         is {@code null}\n@@ -107,2 +105,0 @@\n-     * @throws NullPointerException if the specified {@code insets}\n-     *         is {@code null}\n","filename":"src\/java.desktop\/share\/classes\/javax\/swing\/border\/EmptyBorder.java","additions":0,"deletions":4,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -213,2 +213,0 @@\n-     * @throws NullPointerException if the specified {@code insets}\n-     *         is {@code null}\n","filename":"src\/java.desktop\/share\/classes\/javax\/swing\/border\/EtchedBorder.java","additions":0,"deletions":2,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -222,2 +222,0 @@\n-     * @throws NullPointerException if the specified {@code insets}\n-     *         is {@code null}\n","filename":"src\/java.desktop\/share\/classes\/javax\/swing\/border\/LineBorder.java","additions":0,"deletions":2,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -78,2 +78,0 @@\n-     * @throws NullPointerException if the specified {@code borderInsets}\n-     *         is {@code null}\n@@ -104,2 +102,0 @@\n-     * @throws NullPointerException if the specified {@code borderInsets}\n-     *         is {@code null}\n@@ -173,2 +169,0 @@\n-     * @throws NullPointerException if the specified {@code insets}\n-     *         is {@code null}\n","filename":"src\/java.desktop\/share\/classes\/javax\/swing\/border\/MatteBorder.java","additions":0,"deletions":6,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -155,2 +155,0 @@\n-     * @throws NullPointerException if the specified {@code insets}\n-     *         is {@code null}\n","filename":"src\/java.desktop\/share\/classes\/javax\/swing\/border\/SoftBevelBorder.java","additions":0,"deletions":2,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -377,2 +377,0 @@\n-     * @throws NullPointerException if the specified {@code insets}\n-     *         is {@code null}\n","filename":"src\/java.desktop\/share\/classes\/javax\/swing\/border\/TitledBorder.java","additions":0,"deletions":2,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -175,2 +175,0 @@\n-         * @throws NullPointerException if the spcecified {@code insets}\n-         *         is {@code null}\n","filename":"src\/java.desktop\/share\/classes\/javax\/swing\/plaf\/BorderUIResource.java","additions":0,"deletions":2,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2008, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2008, 2021, Oracle and\/or its affiliates. All rights reserved.\n@@ -877,2 +877,1 @@\n-        var access = componentAccessor;\n-        if (access == null) {\n+        if (componentAccessor == null) {\n@@ -880,1 +879,0 @@\n-            access = componentAccessor;\n@@ -882,1 +880,2 @@\n-        return access;\n+\n+        return componentAccessor;\n@@ -896,2 +895,1 @@\n-        var access = containerAccessor;\n-        if (access == null) {\n+        if (containerAccessor == null) {\n@@ -899,1 +897,0 @@\n-            access = containerAccessor;\n@@ -901,1 +898,2 @@\n-        return access;\n+\n+        return containerAccessor;\n@@ -915,2 +913,1 @@\n-        var access = windowAccessor;\n-        if (access == null) {\n+        if (windowAccessor == null) {\n@@ -918,1 +915,0 @@\n-            access = windowAccessor;\n@@ -920,1 +916,1 @@\n-        return access;\n+        return windowAccessor;\n@@ -934,2 +930,1 @@\n-        var access = awtEventAccessor;\n-        if (access == null) {\n+        if (awtEventAccessor == null) {\n@@ -937,1 +932,0 @@\n-            access = awtEventAccessor;\n@@ -939,1 +933,1 @@\n-        return access;\n+        return awtEventAccessor;\n@@ -953,2 +947,1 @@\n-        var access = inputEventAccessor;\n-        if (access == null) {\n+        if (inputEventAccessor == null) {\n@@ -956,1 +949,0 @@\n-            access = inputEventAccessor;\n@@ -958,1 +950,1 @@\n-        return access;\n+        return inputEventAccessor;\n@@ -972,2 +964,1 @@\n-        var access = mouseEventAccessor;\n-        if (access == null) {\n+        if (mouseEventAccessor == null) {\n@@ -975,1 +966,0 @@\n-            access = mouseEventAccessor;\n@@ -977,1 +967,1 @@\n-        return access;\n+        return mouseEventAccessor;\n@@ -991,2 +981,1 @@\n-        var access = frameAccessor;\n-        if (access == null) {\n+        if (frameAccessor == null) {\n@@ -994,1 +983,0 @@\n-            access = frameAccessor;\n@@ -996,1 +984,1 @@\n-        return access;\n+        return frameAccessor;\n@@ -1010,2 +998,1 @@\n-        var access = kfmAccessor;\n-        if (access == null) {\n+        if (kfmAccessor == null) {\n@@ -1013,1 +1000,0 @@\n-            access = kfmAccessor;\n@@ -1015,1 +1001,1 @@\n-        return access;\n+        return kfmAccessor;\n@@ -1029,2 +1015,1 @@\n-        var access = menuComponentAccessor;\n-        if (access == null) {\n+        if (menuComponentAccessor == null) {\n@@ -1032,1 +1017,0 @@\n-            access = menuComponentAccessor;\n@@ -1034,1 +1018,1 @@\n-        return access;\n+        return menuComponentAccessor;\n@@ -1048,2 +1032,1 @@\n-        var access = eventQueueAccessor;\n-        if (access == null) {\n+        if (eventQueueAccessor == null) {\n@@ -1051,1 +1034,0 @@\n-            access = eventQueueAccessor;\n@@ -1053,1 +1035,1 @@\n-        return access;\n+        return eventQueueAccessor;\n@@ -1067,2 +1049,1 @@\n-        var access = popupMenuAccessor;\n-        if (access == null) {\n+        if (popupMenuAccessor == null) {\n@@ -1070,1 +1051,0 @@\n-            access = popupMenuAccessor;\n@@ -1072,1 +1052,1 @@\n-        return access;\n+        return popupMenuAccessor;\n@@ -1086,2 +1066,1 @@\n-        var access = fileDialogAccessor;\n-        if (access == null) {\n+        if (fileDialogAccessor == null) {\n@@ -1089,1 +1068,0 @@\n-            access = fileDialogAccessor;\n@@ -1091,1 +1069,1 @@\n-        return access;\n+        return fileDialogAccessor;\n@@ -1106,2 +1084,1 @@\n-        var access = scrollPaneAdjustableAccessor;\n-        if (access == null) {\n+        if (scrollPaneAdjustableAccessor == null) {\n@@ -1109,1 +1086,0 @@\n-            access = scrollPaneAdjustableAccessor;\n@@ -1111,1 +1087,1 @@\n-        return access;\n+        return scrollPaneAdjustableAccessor;\n@@ -1125,2 +1101,1 @@\n-        var access = checkboxMenuItemAccessor;\n-        if (access == null) {\n+        if (checkboxMenuItemAccessor == null) {\n@@ -1128,1 +1103,0 @@\n-            access = checkboxMenuItemAccessor;\n@@ -1130,1 +1104,1 @@\n-        return access;\n+        return checkboxMenuItemAccessor;\n@@ -1144,2 +1118,1 @@\n-        var access = cursorAccessor;\n-        if (access == null) {\n+        if (cursorAccessor == null) {\n@@ -1147,1 +1120,0 @@\n-            access = cursorAccessor;\n@@ -1149,1 +1121,1 @@\n-        return access;\n+        return cursorAccessor;\n@@ -1163,2 +1135,1 @@\n-        var access = menuBarAccessor;\n-        if (access == null) {\n+        if (menuBarAccessor == null) {\n@@ -1166,1 +1137,0 @@\n-            access = menuBarAccessor;\n@@ -1168,1 +1138,1 @@\n-        return access;\n+        return menuBarAccessor;\n@@ -1182,2 +1152,1 @@\n-        var access = menuItemAccessor;\n-        if (access == null) {\n+        if (menuItemAccessor == null) {\n@@ -1185,1 +1154,0 @@\n-            access = menuItemAccessor;\n@@ -1187,1 +1155,1 @@\n-        return access;\n+        return menuItemAccessor;\n@@ -1201,2 +1169,1 @@\n-        var access = menuAccessor;\n-        if (access == null) {\n+        if (menuAccessor == null) {\n@@ -1204,1 +1171,0 @@\n-            access = menuAccessor;\n@@ -1206,1 +1172,1 @@\n-        return access;\n+        return menuAccessor;\n@@ -1220,2 +1186,1 @@\n-        var access = keyEventAccessor;\n-        if (access == null) {\n+        if (keyEventAccessor == null) {\n@@ -1223,1 +1188,0 @@\n-            access = keyEventAccessor;\n@@ -1225,1 +1189,1 @@\n-        return access;\n+        return keyEventAccessor;\n@@ -1239,2 +1203,1 @@\n-        var access = clientPropertyKeyAccessor;\n-        if (access == null) {\n+        if (clientPropertyKeyAccessor == null) {\n@@ -1242,1 +1205,0 @@\n-            access = clientPropertyKeyAccessor;\n@@ -1244,1 +1206,1 @@\n-        return access;\n+        return clientPropertyKeyAccessor;\n@@ -1258,2 +1220,1 @@\n-        var access = systemTrayAccessor;\n-        if (access == null) {\n+        if (systemTrayAccessor == null) {\n@@ -1261,1 +1222,0 @@\n-            access = systemTrayAccessor;\n@@ -1263,1 +1223,1 @@\n-        return access;\n+        return systemTrayAccessor;\n@@ -1277,2 +1237,1 @@\n-        var access = trayIconAccessor;\n-        if (access == null) {\n+        if (trayIconAccessor == null) {\n@@ -1280,1 +1239,0 @@\n-            access = trayIconAccessor;\n@@ -1282,1 +1240,1 @@\n-        return access;\n+        return trayIconAccessor;\n@@ -1296,2 +1254,1 @@\n-        var access = defaultKeyboardFocusManagerAccessor;\n-        if (access == null) {\n+        if (defaultKeyboardFocusManagerAccessor == null) {\n@@ -1299,1 +1256,0 @@\n-            access = defaultKeyboardFocusManagerAccessor;\n@@ -1301,1 +1257,1 @@\n-        return access;\n+        return defaultKeyboardFocusManagerAccessor;\n@@ -1314,2 +1270,1 @@\n-        var access = sequencedEventAccessor;\n-        if (access == null) {\n+        if (sequencedEventAccessor == null) {\n@@ -1321,1 +1276,0 @@\n-            access = sequencedEventAccessor;\n@@ -1323,1 +1277,1 @@\n-        return access;\n+        return sequencedEventAccessor;\n@@ -1337,2 +1291,1 @@\n-        var access = toolkitAccessor;\n-        if (access == null) {\n+        if (toolkitAccessor == null) {\n@@ -1340,1 +1293,0 @@\n-            access = toolkitAccessor;\n@@ -1342,1 +1294,2 @@\n-        return access;\n+\n+        return toolkitAccessor;\n@@ -1363,2 +1316,1 @@\n-        var access = systemColorAccessor;\n-        if (access == null) {\n+        if (systemColorAccessor == null) {\n@@ -1366,1 +1318,0 @@\n-            access = systemColorAccessor;\n@@ -1368,1 +1319,2 @@\n-        return access;\n+\n+        return systemColorAccessor;\n@@ -1382,2 +1334,1 @@\n-        var access = accessibleContextAccessor;\n-        if (access == null) {\n+        if (accessibleContextAccessor == null) {\n@@ -1385,1 +1336,0 @@\n-            access = accessibleContextAccessor;\n@@ -1387,1 +1337,1 @@\n-        return access;\n+        return accessibleContextAccessor;\n@@ -1401,2 +1351,1 @@\n-        var access = accessibleBundleAccessor;\n-        if (access == null) {\n+        if (accessibleBundleAccessor == null) {\n@@ -1404,1 +1353,0 @@\n-            access = accessibleBundleAccessor;\n@@ -1406,1 +1354,1 @@\n-        return access;\n+        return accessibleBundleAccessor;\n@@ -1420,2 +1368,1 @@\n-        var access = dragSourceContextAccessor;\n-        if (access == null) {\n+        if (dragSourceContextAccessor == null) {\n@@ -1423,1 +1370,0 @@\n-            access = dragSourceContextAccessor;\n@@ -1425,1 +1371,1 @@\n-        return access;\n+        return dragSourceContextAccessor;\n@@ -1439,2 +1385,1 @@\n-        var access = dropTargetContextAccessor;\n-        if (access == null) {\n+        if (dropTargetContextAccessor == null) {\n@@ -1442,1 +1387,0 @@\n-            access = dropTargetContextAccessor;\n@@ -1444,1 +1388,1 @@\n-        return access;\n+        return dropTargetContextAccessor;\n","filename":"src\/java.desktop\/share\/classes\/sun\/awt\/AWTAccessor.java","additions":65,"deletions":121,"binary":false,"changes":186,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2016, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2016, Oracle and\/or its affiliates. All rights reserved.\n@@ -139,1 +139,1 @@\n-                    ctx.reference = new HardReference<>(ctx);\n+                    ctx.reference = new HardReference<K>(ctx);\n@@ -142,1 +142,1 @@\n-                    ctx.reference = new SoftReference<>(ctx);\n+                    ctx.reference = new SoftReference<K>(ctx);\n@@ -146,1 +146,1 @@\n-                    ctx.reference = new WeakReference<>(ctx);\n+                    ctx.reference = new WeakReference<K>(ctx);\n","filename":"src\/java.desktop\/share\/classes\/sun\/java2d\/ReentrantContextProvider.java","additions":4,"deletions":4,"binary":false,"changes":8,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2016, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2016, Oracle and\/or its affiliates. All rights reserved.\n@@ -45,1 +45,1 @@\n-        = new ConcurrentLinkedQueue<>();\n+        = new ConcurrentLinkedQueue<Reference<K>>();\n@@ -66,1 +66,1 @@\n-        Reference<K> ref;\n+        Reference<K> ref = null;\n","filename":"src\/java.desktop\/share\/classes\/sun\/java2d\/ReentrantContextProviderCLQ.java","additions":3,"deletions":3,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2016, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2016, Oracle and\/or its affiliates. All rights reserved.\n@@ -45,1 +45,1 @@\n-        = new ThreadLocal<>();\n+        = new ThreadLocal<Reference<K>>();\n@@ -74,1 +74,1 @@\n-        this.ctxProviderCLQ = new ReentrantContextProviderCLQ<>(refTypeCLQ) {\n+        this.ctxProviderCLQ = new ReentrantContextProviderCLQ<K>(refTypeCLQ) {\n","filename":"src\/java.desktop\/share\/classes\/sun\/java2d\/ReentrantContextProviderTL.java","additions":3,"deletions":3,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -1,267 +0,0 @@\n-\/*\n- * Copyright (c) 2015, 2022, Oracle and\/or its affiliates. All rights reserved.\n- * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n- *\n- * This code is free software; you can redistribute it and\/or modify it\n- * under the terms of the GNU General Public License version 2 only, as\n- * published by the Free Software Foundation.  Oracle designates this\n- * particular file as subject to the \"Classpath\" exception as provided\n- * by Oracle in the LICENSE file that accompanied this code.\n- *\n- * This code is distributed in the hope that it will be useful, but WITHOUT\n- * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n- * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n- * version 2 for more details (a copy is included in the LICENSE file that\n- * accompanied this code).\n- *\n- * You should have received a copy of the GNU General Public License version\n- * 2 along with this work; if not, write to the Free Software Foundation,\n- * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n- *\n- * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n- * or visit www.oracle.com if you need additional information or have any\n- * questions.\n- *\/\n-\n-package sun.java2d.marlin;\n-\n-import static sun.java2d.marlin.ArrayCacheConst.ARRAY_SIZES;\n-import static sun.java2d.marlin.ArrayCacheConst.BUCKETS;\n-import static sun.java2d.marlin.ArrayCacheConst.MAX_ARRAY_SIZE;\n-\n-import static sun.java2d.marlin.MarlinConst.DO_STATS;\n-import static sun.java2d.marlin.MarlinConst.DO_CHECKS;\n-import static sun.java2d.marlin.MarlinConst.DO_CLEAN_DIRTY;\n-import static sun.java2d.marlin.MarlinConst.DO_LOG_WIDEN_ARRAY;\n-import static sun.java2d.marlin.MarlinConst.DO_LOG_OVERSIZE;\n-\n-import static sun.java2d.marlin.MarlinUtils.logInfo;\n-import static sun.java2d.marlin.MarlinUtils.logException;\n-\n-import java.lang.ref.WeakReference;\n-import java.util.Arrays;\n-\n-import sun.java2d.marlin.ArrayCacheConst.BucketStats;\n-import sun.java2d.marlin.ArrayCacheConst.CacheStats;\n-\n-\/*\n- * Note that the ArrayCache[Byte\/Double\/Int] files are nearly identical except\n- * for their array type [byte\/double\/int] and class name differences.\n- * ArrayCache[Byte\/Double\/Int] class deals with dirty arrays.\n- *\/\n-\n-final class ArrayCacheByte {\n-\n-    \/* members *\/\n-    private final int bucketCapacity;\n-    private WeakReference<Bucket[]> refBuckets = null;\n-    final CacheStats stats;\n-\n-    ArrayCacheByte(final int bucketCapacity) {\n-        this.bucketCapacity = bucketCapacity;\n-        this.stats = (DO_STATS) ?\n-            new CacheStats(\"ArrayCacheByte(Dirty)\") : null;\n-    }\n-\n-    Bucket getCacheBucket(final int length) {\n-        final int bucket = ArrayCacheConst.getBucket(length);\n-        return getBuckets()[bucket];\n-    }\n-\n-    private Bucket[] getBuckets() {\n-        \/\/ resolve reference:\n-        Bucket[] buckets = (refBuckets != null) ? refBuckets.get() : null;\n-\n-        \/\/ create a new buckets ?\n-        if (buckets == null) {\n-            buckets = new Bucket[BUCKETS];\n-\n-            for (int i = 0; i < BUCKETS; i++) {\n-                buckets[i] = new Bucket(ARRAY_SIZES[i], bucketCapacity,\n-                        (DO_STATS) ? stats.bucketStats[i] : null);\n-            }\n-\n-            \/\/ update weak reference:\n-            refBuckets = new WeakReference<>(buckets);\n-        }\n-        return buckets;\n-    }\n-\n-    Reference createRef(final int initialSize) {\n-        return new Reference(this, initialSize);\n-    }\n-\n-    static final class Reference {\n-\n-        \/\/ initial array reference (direct access)\n-        final byte[] initial;\n-        private final ArrayCacheByte cache;\n-\n-        Reference(final ArrayCacheByte cache, final int initialSize) {\n-            this.cache = cache;\n-            this.initial = createArray(initialSize);\n-            if (DO_STATS) {\n-                cache.stats.totalInitial += initialSize;\n-            }\n-        }\n-\n-        byte[] getArray(final int length) {\n-            if (length <= MAX_ARRAY_SIZE) {\n-                return cache.getCacheBucket(length).getArray();\n-            }\n-            if (DO_STATS) {\n-                cache.stats.oversize++;\n-            }\n-            if (DO_LOG_OVERSIZE) {\n-                logInfo(\"ArrayCacheByte(Dirty): \"\n-                        + \"getArray[oversize]: length=\\t\" + length);\n-            }\n-            return createArray(length);\n-        }\n-\n-        byte[] widenArray(final byte[] array, final int usedSize,\n-                          final int needSize)\n-        {\n-            final int length = array.length;\n-            if (DO_CHECKS && length >= needSize) {\n-                return array;\n-            }\n-            if (DO_STATS) {\n-                cache.stats.resize++;\n-            }\n-\n-            \/\/ maybe change bucket:\n-            \/\/ ensure getNewSize() > newSize:\n-            final byte[] res = getArray(ArrayCacheConst.getNewSize(usedSize, needSize));\n-\n-            \/\/ use wrapper to ensure proper copy:\n-            System.arraycopy(array, 0, res, 0, usedSize); \/\/ copy only used elements\n-\n-            \/\/ maybe return current array:\n-            putArray(array, 0, usedSize); \/\/ ensure array is cleared\n-\n-            if (DO_LOG_WIDEN_ARRAY) {\n-                logInfo(\"ArrayCacheByte(Dirty): \"\n-                        + \"widenArray[\" + res.length\n-                        + \"]: usedSize=\\t\" + usedSize + \"\\tlength=\\t\" + length\n-                        + \"\\tneeded length=\\t\" + needSize);\n-            }\n-            return res;\n-        }\n-\n-        boolean doCleanRef(final byte[] array) {\n-            return DO_CLEAN_DIRTY || (array != initial);\n-        }\n-\n-        byte[] putArray(final byte[] array)\n-        {\n-            \/\/ dirty array helper:\n-            return putArray(array, 0, array.length);\n-        }\n-\n-        byte[] putArray(final byte[] array, final int fromIndex,\n-                        final int toIndex)\n-        {\n-            if (array.length <= MAX_ARRAY_SIZE) {\n-                if (DO_CLEAN_DIRTY && (toIndex != 0)) {\n-                    \/\/ clean-up array of dirty part[fromIndex; toIndex[\n-                    fill(array, fromIndex, toIndex, (byte)0);\n-                }\n-                \/\/ ensure to never store initial arrays in cache:\n-                if (array != initial) {\n-                    cache.getCacheBucket(array.length).putArray(array);\n-                }\n-            }\n-            return initial;\n-        }\n-    }\n-\n-    static final class Bucket {\n-\n-        private int tail = 0;\n-        private final int arraySize;\n-        private final byte[][] arrays;\n-        private final BucketStats stats;\n-\n-        Bucket(final int arraySize,\n-               final int capacity, final BucketStats stats)\n-        {\n-            this.arraySize = arraySize;\n-            this.stats = stats;\n-            this.arrays = new byte[capacity][];\n-        }\n-\n-        byte[] getArray() {\n-            if (DO_STATS) {\n-                stats.getOp++;\n-            }\n-            \/\/ use cache:\n-            if (tail != 0) {\n-                final byte[] array = arrays[--tail];\n-                arrays[tail] = null;\n-                return array;\n-            }\n-            if (DO_STATS) {\n-                stats.createOp++;\n-            }\n-            return createArray(arraySize);\n-        }\n-\n-        void putArray(final byte[] array)\n-        {\n-            if (DO_CHECKS && (array.length != arraySize)) {\n-                logInfo(\"ArrayCacheByte(Dirty): \"\n-                        + \"bad length = \" + array.length);\n-                return;\n-            }\n-            if (DO_STATS) {\n-                stats.returnOp++;\n-            }\n-            \/\/ fill cache:\n-            if (arrays.length > tail) {\n-                arrays[tail++] = array;\n-\n-                if (DO_STATS) {\n-                    stats.updateMaxSize(tail);\n-                }\n-            } else if (DO_CHECKS) {\n-                logInfo(\"ArrayCacheByte(Dirty): \"\n-                        + \"array capacity exceeded !\");\n-            }\n-        }\n-    }\n-\n-    static byte[] createArray(final int length) {\n-        return new byte[length];\n-    }\n-\n-    static void fill(final byte[] array, final int fromIndex,\n-                     final int toIndex, final byte value)\n-    {\n-        \/\/ clear array data:\n-        Arrays.fill(array, fromIndex, toIndex, value);\n-        if (DO_CHECKS) {\n-            check(array, fromIndex, toIndex, value);\n-        }\n-    }\n-\n-    static void check(final byte[] array, final int fromIndex,\n-                      final int toIndex, final byte value)\n-    {\n-        if (DO_CHECKS) {\n-            \/\/ check zero on full array:\n-            for (int i = 0; i < array.length; i++) {\n-                if (array[i] != value) {\n-                    logException(\"Invalid value at: \" + i + \" = \" + array[i]\n-                            + \" from: \" + fromIndex + \" to: \" + toIndex + \"\\n\"\n-                            + Arrays.toString(array), new Throwable());\n-\n-                    \/\/ ensure array is correctly filled:\n-                    Arrays.fill(array, value);\n-\n-                    return;\n-                }\n-            }\n-        }\n-    }\n-}\n","filename":"src\/java.desktop\/share\/classes\/sun\/java2d\/marlin\/ArrayCacheByte.java","additions":0,"deletions":267,"binary":false,"changes":267,"status":"deleted"},{"patch":"@@ -1,267 +0,0 @@\n-\/*\n- * Copyright (c) 2015, 2022, Oracle and\/or its affiliates. All rights reserved.\n- * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n- *\n- * This code is free software; you can redistribute it and\/or modify it\n- * under the terms of the GNU General Public License version 2 only, as\n- * published by the Free Software Foundation.  Oracle designates this\n- * particular file as subject to the \"Classpath\" exception as provided\n- * by Oracle in the LICENSE file that accompanied this code.\n- *\n- * This code is distributed in the hope that it will be useful, but WITHOUT\n- * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n- * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n- * version 2 for more details (a copy is included in the LICENSE file that\n- * accompanied this code).\n- *\n- * You should have received a copy of the GNU General Public License version\n- * 2 along with this work; if not, write to the Free Software Foundation,\n- * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n- *\n- * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n- * or visit www.oracle.com if you need additional information or have any\n- * questions.\n- *\/\n-\n-package sun.java2d.marlin;\n-\n-import static sun.java2d.marlin.ArrayCacheConst.ARRAY_SIZES;\n-import static sun.java2d.marlin.ArrayCacheConst.BUCKETS;\n-import static sun.java2d.marlin.ArrayCacheConst.MAX_ARRAY_SIZE;\n-\n-import static sun.java2d.marlin.MarlinConst.DO_STATS;\n-import static sun.java2d.marlin.MarlinConst.DO_CHECKS;\n-import static sun.java2d.marlin.MarlinConst.DO_CLEAN_DIRTY;\n-import static sun.java2d.marlin.MarlinConst.DO_LOG_WIDEN_ARRAY;\n-import static sun.java2d.marlin.MarlinConst.DO_LOG_OVERSIZE;\n-\n-import static sun.java2d.marlin.MarlinUtils.logInfo;\n-import static sun.java2d.marlin.MarlinUtils.logException;\n-\n-import java.lang.ref.WeakReference;\n-import java.util.Arrays;\n-\n-import sun.java2d.marlin.ArrayCacheConst.BucketStats;\n-import sun.java2d.marlin.ArrayCacheConst.CacheStats;\n-\n-\/*\n- * Note that the ArrayCache[Byte\/Double\/Int] files are nearly identical except\n- * for their array type [byte\/double\/int] and class name differences.\n- * ArrayCache[Byte\/Double\/Int] class deals with dirty arrays.\n- *\/\n-\n-final class ArrayCacheDouble {\n-\n-    \/* members *\/\n-    private final int bucketCapacity;\n-    private WeakReference<Bucket[]> refBuckets = null;\n-    final CacheStats stats;\n-\n-    ArrayCacheDouble(final int bucketCapacity) {\n-        this.bucketCapacity = bucketCapacity;\n-        this.stats = (DO_STATS) ?\n-            new CacheStats(\"ArrayCacheDouble(Dirty)\") : null;\n-    }\n-\n-    Bucket getCacheBucket(final int length) {\n-        final int bucket = ArrayCacheConst.getBucket(length);\n-        return getBuckets()[bucket];\n-    }\n-\n-    private Bucket[] getBuckets() {\n-        \/\/ resolve reference:\n-        Bucket[] buckets = (refBuckets != null) ? refBuckets.get() : null;\n-\n-        \/\/ create a new buckets ?\n-        if (buckets == null) {\n-            buckets = new Bucket[BUCKETS];\n-\n-            for (int i = 0; i < BUCKETS; i++) {\n-                buckets[i] = new Bucket(ARRAY_SIZES[i], bucketCapacity,\n-                        (DO_STATS) ? stats.bucketStats[i] : null);\n-            }\n-\n-            \/\/ update weak reference:\n-            refBuckets = new WeakReference<>(buckets);\n-        }\n-        return buckets;\n-    }\n-\n-    Reference createRef(final int initialSize) {\n-        return new Reference(this, initialSize);\n-    }\n-\n-    static final class Reference {\n-\n-        \/\/ initial array reference (direct access)\n-        final double[] initial;\n-        private final ArrayCacheDouble cache;\n-\n-        Reference(final ArrayCacheDouble cache, final int initialSize) {\n-            this.cache = cache;\n-            this.initial = createArray(initialSize);\n-            if (DO_STATS) {\n-                cache.stats.totalInitial += initialSize;\n-            }\n-        }\n-\n-        double[] getArray(final int length) {\n-            if (length <= MAX_ARRAY_SIZE) {\n-                return cache.getCacheBucket(length).getArray();\n-            }\n-            if (DO_STATS) {\n-                cache.stats.oversize++;\n-            }\n-            if (DO_LOG_OVERSIZE) {\n-                logInfo(\"ArrayCacheDouble(Dirty): \"\n-                        + \"getArray[oversize]: length=\\t\" + length);\n-            }\n-            return createArray(length);\n-        }\n-\n-        double[] widenArray(final double[] array, final int usedSize,\n-                          final int needSize)\n-        {\n-            final int length = array.length;\n-            if (DO_CHECKS && length >= needSize) {\n-                return array;\n-            }\n-            if (DO_STATS) {\n-                cache.stats.resize++;\n-            }\n-\n-            \/\/ maybe change bucket:\n-            \/\/ ensure getNewSize() > newSize:\n-            final double[] res = getArray(ArrayCacheConst.getNewSize(usedSize, needSize));\n-\n-            \/\/ use wrapper to ensure proper copy:\n-            System.arraycopy(array, 0, res, 0, usedSize); \/\/ copy only used elements\n-\n-            \/\/ maybe return current array:\n-            putArray(array, 0, usedSize); \/\/ ensure array is cleared\n-\n-            if (DO_LOG_WIDEN_ARRAY) {\n-                logInfo(\"ArrayCacheDouble(Dirty): \"\n-                        + \"widenArray[\" + res.length\n-                        + \"]: usedSize=\\t\" + usedSize + \"\\tlength=\\t\" + length\n-                        + \"\\tneeded length=\\t\" + needSize);\n-            }\n-            return res;\n-        }\n-\n-        boolean doCleanRef(final double[] array) {\n-            return DO_CLEAN_DIRTY || (array != initial);\n-        }\n-\n-        double[] putArray(final double[] array)\n-        {\n-            \/\/ dirty array helper:\n-            return putArray(array, 0, array.length);\n-        }\n-\n-        double[] putArray(final double[] array, final int fromIndex,\n-                        final int toIndex)\n-        {\n-            if (array.length <= MAX_ARRAY_SIZE) {\n-                if (DO_CLEAN_DIRTY && (toIndex != 0)) {\n-                    \/\/ clean-up array of dirty part[fromIndex; toIndex[\n-                    fill(array, fromIndex, toIndex, \/*(double)*\/ 0.0);\n-                }\n-                \/\/ ensure to never store initial arrays in cache:\n-                if (array != initial) {\n-                    cache.getCacheBucket(array.length).putArray(array);\n-                }\n-            }\n-            return initial;\n-        }\n-    }\n-\n-    static final class Bucket {\n-\n-        private int tail = 0;\n-        private final int arraySize;\n-        private final double[][] arrays;\n-        private final BucketStats stats;\n-\n-        Bucket(final int arraySize,\n-               final int capacity, final BucketStats stats)\n-        {\n-            this.arraySize = arraySize;\n-            this.stats = stats;\n-            this.arrays = new double[capacity][];\n-        }\n-\n-        double[] getArray() {\n-            if (DO_STATS) {\n-                stats.getOp++;\n-            }\n-            \/\/ use cache:\n-            if (tail != 0) {\n-                final double[] array = arrays[--tail];\n-                arrays[tail] = null;\n-                return array;\n-            }\n-            if (DO_STATS) {\n-                stats.createOp++;\n-            }\n-            return createArray(arraySize);\n-        }\n-\n-        void putArray(final double[] array)\n-        {\n-            if (DO_CHECKS && (array.length != arraySize)) {\n-                logInfo(\"ArrayCacheDouble(Dirty): \"\n-                        + \"bad length = \" + array.length);\n-                return;\n-            }\n-            if (DO_STATS) {\n-                stats.returnOp++;\n-            }\n-            \/\/ fill cache:\n-            if (arrays.length > tail) {\n-                arrays[tail++] = array;\n-\n-                if (DO_STATS) {\n-                    stats.updateMaxSize(tail);\n-                }\n-            } else if (DO_CHECKS) {\n-                logInfo(\"ArrayCacheDouble(Dirty): \"\n-                        + \"array capacity exceeded !\");\n-            }\n-        }\n-    }\n-\n-    static double[] createArray(final int length) {\n-        return new double[length];\n-    }\n-\n-    static void fill(final double[] array, final int fromIndex,\n-                     final int toIndex, final double value)\n-    {\n-        \/\/ clear array data:\n-        Arrays.fill(array, fromIndex, toIndex, value);\n-        if (DO_CHECKS) {\n-            check(array, fromIndex, toIndex, value);\n-        }\n-    }\n-\n-    static void check(final double[] array, final int fromIndex,\n-                      final int toIndex, final double value)\n-    {\n-        if (DO_CHECKS) {\n-            \/\/ check zero on full array:\n-            for (int i = 0; i < array.length; i++) {\n-                if (array[i] != value) {\n-                    logException(\"Invalid value at: \" + i + \" = \" + array[i]\n-                            + \" from: \" + fromIndex + \" to: \" + toIndex + \"\\n\"\n-                            + Arrays.toString(array), new Throwable());\n-\n-                    \/\/ ensure array is correctly filled:\n-                    Arrays.fill(array, value);\n-\n-                    return;\n-                }\n-            }\n-        }\n-    }\n-}\n","filename":"src\/java.desktop\/share\/classes\/sun\/java2d\/marlin\/ArrayCacheDouble.java","additions":0,"deletions":267,"binary":false,"changes":267,"status":"deleted"},{"patch":"@@ -1,267 +0,0 @@\n-\/*\n- * Copyright (c) 2015, 2022, Oracle and\/or its affiliates. All rights reserved.\n- * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n- *\n- * This code is free software; you can redistribute it and\/or modify it\n- * under the terms of the GNU General Public License version 2 only, as\n- * published by the Free Software Foundation.  Oracle designates this\n- * particular file as subject to the \"Classpath\" exception as provided\n- * by Oracle in the LICENSE file that accompanied this code.\n- *\n- * This code is distributed in the hope that it will be useful, but WITHOUT\n- * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n- * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n- * version 2 for more details (a copy is included in the LICENSE file that\n- * accompanied this code).\n- *\n- * You should have received a copy of the GNU General Public License version\n- * 2 along with this work; if not, write to the Free Software Foundation,\n- * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n- *\n- * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n- * or visit www.oracle.com if you need additional information or have any\n- * questions.\n- *\/\n-\n-package sun.java2d.marlin;\n-\n-import static sun.java2d.marlin.ArrayCacheConst.ARRAY_SIZES;\n-import static sun.java2d.marlin.ArrayCacheConst.BUCKETS;\n-import static sun.java2d.marlin.ArrayCacheConst.MAX_ARRAY_SIZE;\n-\n-import static sun.java2d.marlin.MarlinConst.DO_STATS;\n-import static sun.java2d.marlin.MarlinConst.DO_CHECKS;\n-import static sun.java2d.marlin.MarlinConst.DO_CLEAN_DIRTY;\n-import static sun.java2d.marlin.MarlinConst.DO_LOG_WIDEN_ARRAY;\n-import static sun.java2d.marlin.MarlinConst.DO_LOG_OVERSIZE;\n-\n-import static sun.java2d.marlin.MarlinUtils.logInfo;\n-import static sun.java2d.marlin.MarlinUtils.logException;\n-\n-import java.lang.ref.WeakReference;\n-import java.util.Arrays;\n-\n-import sun.java2d.marlin.ArrayCacheConst.BucketStats;\n-import sun.java2d.marlin.ArrayCacheConst.CacheStats;\n-\n-\/*\n- * Note that the ArrayCache[Byte\/Double\/Int] files are nearly identical except\n- * for their array type [byte\/double\/int] and class name differences.\n- * ArrayCache[Byte\/Double\/Int] class deals with dirty arrays.\n- *\/\n-\n-final class ArrayCacheInt {\n-\n-    \/* members *\/\n-    private final int bucketCapacity;\n-    private WeakReference<Bucket[]> refBuckets = null;\n-    final CacheStats stats;\n-\n-    ArrayCacheInt(final int bucketCapacity) {\n-        this.bucketCapacity = bucketCapacity;\n-        this.stats = (DO_STATS) ?\n-            new CacheStats(\"ArrayCacheInt(Dirty)\") : null;\n-    }\n-\n-    Bucket getCacheBucket(final int length) {\n-        final int bucket = ArrayCacheConst.getBucket(length);\n-        return getBuckets()[bucket];\n-    }\n-\n-    private Bucket[] getBuckets() {\n-        \/\/ resolve reference:\n-        Bucket[] buckets = (refBuckets != null) ? refBuckets.get() : null;\n-\n-        \/\/ create a new buckets ?\n-        if (buckets == null) {\n-            buckets = new Bucket[BUCKETS];\n-\n-            for (int i = 0; i < BUCKETS; i++) {\n-                buckets[i] = new Bucket(ARRAY_SIZES[i], bucketCapacity,\n-                        (DO_STATS) ? stats.bucketStats[i] : null);\n-            }\n-\n-            \/\/ update weak reference:\n-            refBuckets = new WeakReference<>(buckets);\n-        }\n-        return buckets;\n-    }\n-\n-    Reference createRef(final int initialSize) {\n-        return new Reference(this, initialSize);\n-    }\n-\n-    static final class Reference {\n-\n-        \/\/ initial array reference (direct access)\n-        final int[] initial;\n-        private final ArrayCacheInt cache;\n-\n-        Reference(final ArrayCacheInt cache, final int initialSize) {\n-            this.cache = cache;\n-            this.initial = createArray(initialSize);\n-            if (DO_STATS) {\n-                cache.stats.totalInitial += initialSize;\n-            }\n-        }\n-\n-        int[] getArray(final int length) {\n-            if (length <= MAX_ARRAY_SIZE) {\n-                return cache.getCacheBucket(length).getArray();\n-            }\n-            if (DO_STATS) {\n-                cache.stats.oversize++;\n-            }\n-            if (DO_LOG_OVERSIZE) {\n-                logInfo(\"ArrayCacheInt(Dirty): \"\n-                        + \"getArray[oversize]: length=\\t\" + length);\n-            }\n-            return createArray(length);\n-        }\n-\n-        int[] widenArray(final int[] array, final int usedSize,\n-                          final int needSize)\n-        {\n-            final int length = array.length;\n-            if (DO_CHECKS && length >= needSize) {\n-                return array;\n-            }\n-            if (DO_STATS) {\n-                cache.stats.resize++;\n-            }\n-\n-            \/\/ maybe change bucket:\n-            \/\/ ensure getNewSize() > newSize:\n-            final int[] res = getArray(ArrayCacheConst.getNewSize(usedSize, needSize));\n-\n-            \/\/ use wrapper to ensure proper copy:\n-            System.arraycopy(array, 0, res, 0, usedSize); \/\/ copy only used elements\n-\n-            \/\/ maybe return current array:\n-            putArray(array, 0, usedSize); \/\/ ensure array is cleared\n-\n-            if (DO_LOG_WIDEN_ARRAY) {\n-                logInfo(\"ArrayCacheInt(Dirty): \"\n-                        + \"widenArray[\" + res.length\n-                        + \"]: usedSize=\\t\" + usedSize + \"\\tlength=\\t\" + length\n-                        + \"\\tneeded length=\\t\" + needSize);\n-            }\n-            return res;\n-        }\n-\n-        boolean doCleanRef(final int[] array) {\n-            return DO_CLEAN_DIRTY || (array != initial);\n-        }\n-\n-        int[] putArray(final int[] array)\n-        {\n-            \/\/ dirty array helper:\n-            return putArray(array, 0, array.length);\n-        }\n-\n-        int[] putArray(final int[] array, final int fromIndex,\n-                        final int toIndex)\n-        {\n-            if (array.length <= MAX_ARRAY_SIZE) {\n-                if (DO_CLEAN_DIRTY && (toIndex != 0)) {\n-                    \/\/ clean-up array of dirty part[fromIndex; toIndex[\n-                    fill(array, fromIndex, toIndex, \/*(int)*\/ 0);\n-                }\n-                \/\/ ensure to never store initial arrays in cache:\n-                if (array != initial) {\n-                    cache.getCacheBucket(array.length).putArray(array);\n-                }\n-            }\n-            return initial;\n-        }\n-    }\n-\n-    static final class Bucket {\n-\n-        private int tail = 0;\n-        private final int arraySize;\n-        private final int[][] arrays;\n-        private final BucketStats stats;\n-\n-        Bucket(final int arraySize,\n-               final int capacity, final BucketStats stats)\n-        {\n-            this.arraySize = arraySize;\n-            this.stats = stats;\n-            this.arrays = new int[capacity][];\n-        }\n-\n-        int[] getArray() {\n-            if (DO_STATS) {\n-                stats.getOp++;\n-            }\n-            \/\/ use cache:\n-            if (tail != 0) {\n-                final int[] array = arrays[--tail];\n-                arrays[tail] = null;\n-                return array;\n-            }\n-            if (DO_STATS) {\n-                stats.createOp++;\n-            }\n-            return createArray(arraySize);\n-        }\n-\n-        void putArray(final int[] array)\n-        {\n-            if (DO_CHECKS && (array.length != arraySize)) {\n-                logInfo(\"ArrayCacheInt(Dirty): \"\n-                        + \"bad length = \" + array.length);\n-                return;\n-            }\n-            if (DO_STATS) {\n-                stats.returnOp++;\n-            }\n-            \/\/ fill cache:\n-            if (arrays.length > tail) {\n-                arrays[tail++] = array;\n-\n-                if (DO_STATS) {\n-                    stats.updateMaxSize(tail);\n-                }\n-            } else if (DO_CHECKS) {\n-                logInfo(\"ArrayCacheInt(Dirty): \"\n-                        + \"array capacity exceeded !\");\n-            }\n-        }\n-    }\n-\n-    static int[] createArray(final int length) {\n-        return new int[length];\n-    }\n-\n-    static void fill(final int[] array, final int fromIndex,\n-                     final int toIndex, final int value)\n-    {\n-        \/\/ clear array data:\n-        Arrays.fill(array, fromIndex, toIndex, value);\n-        if (DO_CHECKS) {\n-            check(array, fromIndex, toIndex, value);\n-        }\n-    }\n-\n-    static void check(final int[] array, final int fromIndex,\n-                      final int toIndex, final int value)\n-    {\n-        if (DO_CHECKS) {\n-            \/\/ check zero on full array:\n-            for (int i = 0; i < array.length; i++) {\n-                if (array[i] != value) {\n-                    logException(\"Invalid value at: \" + i + \" = \" + array[i]\n-                            + \" from: \" + fromIndex + \" to: \" + toIndex + \"\\n\"\n-                            + Arrays.toString(array), new Throwable());\n-\n-                    \/\/ ensure array is correctly filled:\n-                    Arrays.fill(array, value);\n-\n-                    return;\n-                }\n-            }\n-        }\n-    }\n-}\n","filename":"src\/java.desktop\/share\/classes\/sun\/java2d\/marlin\/ArrayCacheInt.java","additions":0,"deletions":267,"binary":false,"changes":267,"status":"deleted"},{"patch":"@@ -1,270 +0,0 @@\n-\/*\n- * Copyright (c) 2015, 2022, Oracle and\/or its affiliates. All rights reserved.\n- * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n- *\n- * This code is free software; you can redistribute it and\/or modify it\n- * under the terms of the GNU General Public License version 2 only, as\n- * published by the Free Software Foundation.  Oracle designates this\n- * particular file as subject to the \"Classpath\" exception as provided\n- * by Oracle in the LICENSE file that accompanied this code.\n- *\n- * This code is distributed in the hope that it will be useful, but WITHOUT\n- * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n- * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n- * version 2 for more details (a copy is included in the LICENSE file that\n- * accompanied this code).\n- *\n- * You should have received a copy of the GNU General Public License version\n- * 2 along with this work; if not, write to the Free Software Foundation,\n- * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n- *\n- * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n- * or visit www.oracle.com if you need additional information or have any\n- * questions.\n- *\/\n-\n-package sun.java2d.marlin;\n-\n-import static sun.java2d.marlin.ArrayCacheConst.ARRAY_SIZES;\n-import static sun.java2d.marlin.ArrayCacheConst.BUCKETS;\n-import static sun.java2d.marlin.ArrayCacheConst.MAX_ARRAY_SIZE;\n-\n-import static sun.java2d.marlin.MarlinConst.DO_STATS;\n-import static sun.java2d.marlin.MarlinConst.DO_CHECKS;\n-import static sun.java2d.marlin.MarlinConst.DO_LOG_WIDEN_ARRAY;\n-import static sun.java2d.marlin.MarlinConst.DO_LOG_OVERSIZE;\n-\n-import static sun.java2d.marlin.MarlinUtils.logInfo;\n-import static sun.java2d.marlin.MarlinUtils.logException;\n-\n-import java.lang.ref.WeakReference;\n-import java.util.Arrays;\n-\n-import sun.java2d.marlin.ArrayCacheConst.BucketStats;\n-import sun.java2d.marlin.ArrayCacheConst.CacheStats;\n-\n-\/*\n- * Note that the ArrayCache[Int\/IntClean] files are nearly identical except\n- * for their array type [byte\/double\/int] and class name differences.\n- * ArrayCache[Int]Clean class deals with zero-filled arrays.\n- *\/\n-\n-final class ArrayCacheIntClean {\n-\n-    \/* members *\/\n-    private final int bucketCapacity;\n-    private WeakReference<Bucket[]> refBuckets = null;\n-    final CacheStats stats;\n-\n-    ArrayCacheIntClean(final int bucketCapacity) {\n-        this.bucketCapacity = bucketCapacity;\n-        this.stats = (DO_STATS) ?\n-            new CacheStats(\"ArrayCacheInt(Clean)\") : null;\n-    }\n-\n-    Bucket getCacheBucket(final int length) {\n-        final int bucket = ArrayCacheConst.getBucket(length);\n-        return getBuckets()[bucket];\n-    }\n-\n-    private Bucket[] getBuckets() {\n-        \/\/ resolve reference:\n-        Bucket[] buckets = (refBuckets != null) ? refBuckets.get() : null;\n-\n-        \/\/ create a new buckets ?\n-        if (buckets == null) {\n-            buckets = new Bucket[BUCKETS];\n-\n-            for (int i = 0; i < BUCKETS; i++) {\n-                buckets[i] = new Bucket(ARRAY_SIZES[i], bucketCapacity,\n-                        (DO_STATS) ? stats.bucketStats[i] : null);\n-            }\n-\n-            \/\/ update weak reference:\n-            refBuckets = new WeakReference<>(buckets);\n-        }\n-        return buckets;\n-    }\n-\n-    Reference createRef(final int initialSize) {\n-        return new Reference(this, initialSize);\n-    }\n-\n-    static final class Reference {\n-\n-        \/\/ initial array reference (direct access)\n-        final int[] initial;\n-        private final ArrayCacheIntClean cache;\n-\n-        Reference(final ArrayCacheIntClean cache, final int initialSize) {\n-            this.cache = cache;\n-            this.initial = createArray(initialSize);\n-            if (DO_STATS) {\n-                cache.stats.totalInitial += initialSize;\n-            }\n-        }\n-\n-        int[] getArray(final int length) {\n-            if (length <= MAX_ARRAY_SIZE) {\n-                return cache.getCacheBucket(length).getArray();\n-            }\n-            if (DO_STATS) {\n-                cache.stats.oversize++;\n-            }\n-            if (DO_LOG_OVERSIZE) {\n-                logInfo(\"ArrayCacheInt(Clean): \"\n-                        + \"getArray[oversize]: length=\\t\" + length);\n-            }\n-            return createArray(length);\n-        }\n-\n-        int[] widenArray(final int[] array, final int usedSize,\n-                          final int needSize)\n-        {\n-            final int length = array.length;\n-            if (DO_CHECKS && length >= needSize) {\n-                return array;\n-            }\n-            if (DO_STATS) {\n-                cache.stats.resize++;\n-            }\n-\n-            \/\/ maybe change bucket:\n-            \/\/ ensure getNewSize() > newSize:\n-            final int[] res = getArray(ArrayCacheConst.getNewSize(usedSize, needSize));\n-\n-            \/\/ use wrapper to ensure proper copy:\n-            System.arraycopy(array, 0, res, 0, usedSize); \/\/ copy only used elements\n-\n-            \/\/ maybe return current array:\n-            putArray(array, 0, usedSize); \/\/ ensure array is cleared\n-\n-            if (DO_LOG_WIDEN_ARRAY) {\n-                logInfo(\"ArrayCacheInt(Clean): \"\n-                        + \"widenArray[\" + res.length\n-                        + \"]: usedSize=\\t\" + usedSize + \"\\tlength=\\t\" + length\n-                        + \"\\tneeded length=\\t\" + needSize);\n-            }\n-            return res;\n-        }\n-\n-        boolean doSetRef(final int[] array) {\n-            return (array != initial);\n-        }\n-\n-        int[] putArrayClean(final int[] array)\n-        {\n-            \/\/ must be protected by doSetRef() call !\n-            if (array.length <= MAX_ARRAY_SIZE) {\n-                \/\/ ensure to never store initial arrays in cache:\n-                cache.getCacheBucket(array.length).putArray(array);\n-            }\n-            return initial;\n-        }\n-\n-        int[] putArray(final int[] array, final int fromIndex,\n-                        final int toIndex)\n-        {\n-            if (array.length <= MAX_ARRAY_SIZE) {\n-                if (toIndex != 0) {\n-                    \/\/ clean-up array of dirty part[fromIndex; toIndex[\n-                    fill(array, fromIndex, toIndex, \/*(int)*\/ 0);\n-                }\n-                \/\/ ensure to never store initial arrays in cache:\n-                if (array != initial) {\n-                    cache.getCacheBucket(array.length).putArray(array);\n-                }\n-            }\n-            return initial;\n-        }\n-    }\n-\n-    static final class Bucket {\n-\n-        private int tail = 0;\n-        private final int arraySize;\n-        private final int[][] arrays;\n-        private final BucketStats stats;\n-\n-        Bucket(final int arraySize,\n-               final int capacity, final BucketStats stats)\n-        {\n-            this.arraySize = arraySize;\n-            this.stats = stats;\n-            this.arrays = new int[capacity][];\n-        }\n-\n-        int[] getArray() {\n-            if (DO_STATS) {\n-                stats.getOp++;\n-            }\n-            \/\/ use cache:\n-            if (tail != 0) {\n-                final int[] array = arrays[--tail];\n-                arrays[tail] = null;\n-                return array;\n-            }\n-            if (DO_STATS) {\n-                stats.createOp++;\n-            }\n-            return createArray(arraySize);\n-        }\n-\n-        void putArray(final int[] array)\n-        {\n-            if (DO_CHECKS && (array.length != arraySize)) {\n-                logInfo(\"ArrayCacheInt(Clean): \"\n-                        + \"bad length = \" + array.length);\n-                return;\n-            }\n-            if (DO_STATS) {\n-                stats.returnOp++;\n-            }\n-            \/\/ fill cache:\n-            if (arrays.length > tail) {\n-                arrays[tail++] = array;\n-\n-                if (DO_STATS) {\n-                    stats.updateMaxSize(tail);\n-                }\n-            } else if (DO_CHECKS) {\n-                logInfo(\"ArrayCacheInt(Clean): \"\n-                        + \"array capacity exceeded !\");\n-            }\n-        }\n-    }\n-\n-    static int[] createArray(final int length) {\n-        return new int[length];\n-    }\n-\n-    static void fill(final int[] array, final int fromIndex,\n-                     final int toIndex, final int value)\n-    {\n-        \/\/ clear array data:\n-        Arrays.fill(array, fromIndex, toIndex, value);\n-        if (DO_CHECKS) {\n-            check(array, fromIndex, toIndex, value);\n-        }\n-    }\n-\n-    static void check(final int[] array, final int fromIndex,\n-                      final int toIndex, final int value)\n-    {\n-        if (DO_CHECKS) {\n-            \/\/ check zero on full array:\n-            for (int i = 0; i < array.length; i++) {\n-                if (array[i] != value) {\n-                    logException(\"Invalid value at: \" + i + \" = \" + array[i]\n-                            + \" from: \" + fromIndex + \" to: \" + toIndex + \"\\n\"\n-                            + Arrays.toString(array), new Throwable());\n-\n-                    \/\/ ensure array is correctly filled:\n-                    Arrays.fill(array, value);\n-\n-                    return;\n-                }\n-            }\n-        }\n-    }\n-}\n","filename":"src\/java.desktop\/share\/classes\/sun\/java2d\/marlin\/ArrayCacheIntClean.java","additions":0,"deletions":270,"binary":false,"changes":270,"status":"deleted"},{"patch":"@@ -0,0 +1,269 @@\n+\/*\n+ * Copyright (c) 2015, 2018, Oracle and\/or its affiliates. All rights reserved.\n+ * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+ *\n+ * This code is free software; you can redistribute it and\/or modify it\n+ * under the terms of the GNU General Public License version 2 only, as\n+ * published by the Free Software Foundation.  Oracle designates this\n+ * particular file as subject to the \"Classpath\" exception as provided\n+ * by Oracle in the LICENSE file that accompanied this code.\n+ *\n+ * This code is distributed in the hope that it will be useful, but WITHOUT\n+ * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+ * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+ * version 2 for more details (a copy is included in the LICENSE file that\n+ * accompanied this code).\n+ *\n+ * You should have received a copy of the GNU General Public License version\n+ * 2 along with this work; if not, write to the Free Software Foundation,\n+ * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n+ *\n+ * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n+ * or visit www.oracle.com if you need additional information or have any\n+ * questions.\n+ *\/\n+\n+package sun.java2d.marlin;\n+\n+import static sun.java2d.marlin.ArrayCacheConst.ARRAY_SIZES;\n+import static sun.java2d.marlin.ArrayCacheConst.BUCKETS;\n+import static sun.java2d.marlin.ArrayCacheConst.MAX_ARRAY_SIZE;\n+import static sun.java2d.marlin.MarlinUtils.logInfo;\n+import static sun.java2d.marlin.MarlinUtils.logException;\n+\n+import java.lang.ref.WeakReference;\n+import java.util.Arrays;\n+\n+import sun.java2d.marlin.ArrayCacheConst.BucketStats;\n+import sun.java2d.marlin.ArrayCacheConst.CacheStats;\n+\n+\/*\n+ * Note that the [BYTE\/INT\/FLOAT\/DOUBLE]ArrayCache files are nearly identical except\n+ * for a few type and name differences. Typically, the [BYTE]ArrayCache.java file\n+ * is edited manually and then [INT\/FLOAT\/DOUBLE]ArrayCache.java\n+ * files are generated with the following command lines:\n+ *\/\n+\/\/ % sed -e 's\/(b\\yte)[ ]*\/\/g' -e 's\/b\\yte\/int\/g' -e 's\/B\\yte\/Int\/g' < B\\yteArrayCache.java > IntArrayCache.java\n+\/\/ % sed -e 's\/(b\\yte)[ ]*0\/0.0f\/g' -e 's\/(b\\yte)[ ]*\/(float) \/g' -e 's\/b\\yte\/float\/g' -e 's\/B\\yte\/Float\/g' < B\\yteArrayCache.java > FloatArrayCache.java\n+\/\/ % sed -e 's\/(b\\yte)[ ]*0\/0.0d\/g' -e 's\/(b\\yte)[ ]*\/(double) \/g' -e 's\/b\\yte\/double\/g' -e 's\/B\\yte\/Double\/g' < B\\yteArrayCache.java > DoubleArrayCache.java\n+\n+final class ByteArrayCache implements MarlinConst {\n+\n+    final boolean clean;\n+    private final int bucketCapacity;\n+    private WeakReference<Bucket[]> refBuckets = null;\n+    final CacheStats stats;\n+\n+    ByteArrayCache(final boolean clean, final int bucketCapacity) {\n+        this.clean = clean;\n+        this.bucketCapacity = bucketCapacity;\n+        this.stats = (DO_STATS) ?\n+            new CacheStats(getLogPrefix(clean) + \"ByteArrayCache\") : null;\n+    }\n+\n+    Bucket getCacheBucket(final int length) {\n+        final int bucket = ArrayCacheConst.getBucket(length);\n+        return getBuckets()[bucket];\n+    }\n+\n+    private Bucket[] getBuckets() {\n+        \/\/ resolve reference:\n+        Bucket[] buckets = (refBuckets != null) ? refBuckets.get() : null;\n+\n+        \/\/ create a new buckets ?\n+        if (buckets == null) {\n+            buckets = new Bucket[BUCKETS];\n+\n+            for (int i = 0; i < BUCKETS; i++) {\n+                buckets[i] = new Bucket(clean, ARRAY_SIZES[i], bucketCapacity,\n+                        (DO_STATS) ? stats.bucketStats[i] : null);\n+            }\n+\n+            \/\/ update weak reference:\n+            refBuckets = new WeakReference<Bucket[]>(buckets);\n+        }\n+        return buckets;\n+    }\n+\n+    Reference createRef(final int initialSize) {\n+        return new Reference(this, initialSize);\n+    }\n+\n+    static final class Reference {\n+\n+        \/\/ initial array reference (direct access)\n+        final byte[] initial;\n+        private final boolean clean;\n+        private final ByteArrayCache cache;\n+\n+        Reference(final ByteArrayCache cache, final int initialSize) {\n+            this.cache = cache;\n+            this.clean = cache.clean;\n+            this.initial = createArray(initialSize);\n+            if (DO_STATS) {\n+                cache.stats.totalInitial += initialSize;\n+            }\n+        }\n+\n+        byte[] getArray(final int length) {\n+            if (length <= MAX_ARRAY_SIZE) {\n+                return cache.getCacheBucket(length).getArray();\n+            }\n+            if (DO_STATS) {\n+                cache.stats.oversize++;\n+            }\n+            if (DO_LOG_OVERSIZE) {\n+                logInfo(getLogPrefix(clean) + \"ByteArrayCache: \"\n+                        + \"getArray[oversize]: length=\\t\" + length);\n+            }\n+            return createArray(length);\n+        }\n+\n+        byte[] widenArray(final byte[] array, final int usedSize,\n+                          final int needSize)\n+        {\n+            final int length = array.length;\n+            if (DO_CHECKS && length >= needSize) {\n+                return array;\n+            }\n+            if (DO_STATS) {\n+                cache.stats.resize++;\n+            }\n+\n+            \/\/ maybe change bucket:\n+            \/\/ ensure getNewSize() > newSize:\n+            final byte[] res = getArray(ArrayCacheConst.getNewSize(usedSize, needSize));\n+\n+            \/\/ use wrapper to ensure proper copy:\n+            System.arraycopy(array, 0, res, 0, usedSize); \/\/ copy only used elements\n+\n+            \/\/ maybe return current array:\n+            putArray(array, 0, usedSize); \/\/ ensure array is cleared\n+\n+            if (DO_LOG_WIDEN_ARRAY) {\n+                logInfo(getLogPrefix(clean) + \"ByteArrayCache: \"\n+                        + \"widenArray[\" + res.length\n+                        + \"]: usedSize=\\t\" + usedSize + \"\\tlength=\\t\" + length\n+                        + \"\\tneeded length=\\t\" + needSize);\n+            }\n+            return res;\n+        }\n+\n+        byte[] putArray(final byte[] array)\n+        {\n+            \/\/ dirty array helper:\n+            return putArray(array, 0, array.length);\n+        }\n+\n+        byte[] putArray(final byte[] array, final int fromIndex,\n+                        final int toIndex)\n+        {\n+            if (array.length <= MAX_ARRAY_SIZE) {\n+                if ((clean || DO_CLEAN_DIRTY) && (toIndex != 0)) {\n+                    \/\/ clean-up array of dirty part[fromIndex; toIndex[\n+                    fill(array, fromIndex, toIndex, (byte)0);\n+                }\n+                \/\/ ensure to never store initial arrays in cache:\n+                if (array != initial) {\n+                    cache.getCacheBucket(array.length).putArray(array);\n+                }\n+            }\n+            return initial;\n+        }\n+    }\n+\n+    static final class Bucket {\n+\n+        private int tail = 0;\n+        private final int arraySize;\n+        private final boolean clean;\n+        private final byte[][] arrays;\n+        private final BucketStats stats;\n+\n+        Bucket(final boolean clean, final int arraySize,\n+               final int capacity, final BucketStats stats)\n+        {\n+            this.arraySize = arraySize;\n+            this.clean = clean;\n+            this.stats = stats;\n+            this.arrays = new byte[capacity][];\n+        }\n+\n+        byte[] getArray() {\n+            if (DO_STATS) {\n+                stats.getOp++;\n+            }\n+            \/\/ use cache:\n+            if (tail != 0) {\n+                final byte[] array = arrays[--tail];\n+                arrays[tail] = null;\n+                return array;\n+            }\n+            if (DO_STATS) {\n+                stats.createOp++;\n+            }\n+            return createArray(arraySize);\n+        }\n+\n+        void putArray(final byte[] array)\n+        {\n+            if (DO_CHECKS && (array.length != arraySize)) {\n+                logInfo(getLogPrefix(clean) + \"ByteArrayCache: \"\n+                        + \"bad length = \" + array.length);\n+                return;\n+            }\n+            if (DO_STATS) {\n+                stats.returnOp++;\n+            }\n+            \/\/ fill cache:\n+            if (arrays.length > tail) {\n+                arrays[tail++] = array;\n+\n+                if (DO_STATS) {\n+                    stats.updateMaxSize(tail);\n+                }\n+            } else if (DO_CHECKS) {\n+                logInfo(getLogPrefix(clean) + \"ByteArrayCache: \"\n+                        + \"array capacity exceeded !\");\n+            }\n+        }\n+    }\n+\n+    static byte[] createArray(final int length) {\n+        return new byte[length];\n+    }\n+\n+    static void fill(final byte[] array, final int fromIndex,\n+                     final int toIndex, final byte value)\n+    {\n+        \/\/ clear array data:\n+        Arrays.fill(array, fromIndex, toIndex, value);\n+        if (DO_CHECKS) {\n+            check(array, fromIndex, toIndex, value);\n+        }\n+    }\n+\n+    static void check(final byte[] array, final int fromIndex,\n+                      final int toIndex, final byte value)\n+    {\n+        if (DO_CHECKS) {\n+            \/\/ check zero on full array:\n+            for (int i = 0; i < array.length; i++) {\n+                if (array[i] != value) {\n+                    logException(\"Invalid value at: \" + i + \" = \" + array[i]\n+                            + \" from: \" + fromIndex + \" to: \" + toIndex + \"\\n\"\n+                            + Arrays.toString(array), new Throwable());\n+\n+                    \/\/ ensure array is correctly filled:\n+                    Arrays.fill(array, value);\n+\n+                    return;\n+                }\n+            }\n+        }\n+    }\n+\n+    static String getLogPrefix(final boolean clean) {\n+        return (clean) ? \"Clean\" : \"Dirty\";\n+    }\n+}\n","filename":"src\/java.desktop\/share\/classes\/sun\/java2d\/marlin\/ByteArrayCache.java","additions":269,"deletions":0,"binary":false,"changes":269,"status":"added"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2015, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2015, 2021, Oracle and\/or its affiliates. All rights reserved.\n@@ -34,2 +34,1 @@\n-    }\n-\n+    };\n","filename":"src\/java.desktop\/share\/classes\/sun\/java2d\/marlin\/CollinearSimplifier.java","additions":2,"deletions":3,"binary":false,"changes":5,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2007, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2007, 2021, Oracle and\/or its affiliates. All rights reserved.\n@@ -1201,4 +1201,0 @@\n-        logInfo(\"sun.java2d.renderer.profile          = \"\n-                + (MarlinProperties.isProfileQuality() ?\n-                    \"quality\" : \"speed\"));\n-\n@@ -1238,5 +1234,0 @@\n-        logInfo(\"sun.java2d.renderer.stroker.joinError= \"\n-                + MarlinProperties.getStrokerJoinError());\n-        logInfo(\"sun.java2d.renderer.stroker.joinStyle= \"\n-                + MarlinProperties.getStrokerJoinStyle());\n-\n@@ -1261,5 +1252,0 @@\n-        logInfo(\"sun.java2d.renderer.skip_rdr         = \"\n-                + MarlinProperties.isSkipRenderer());\n-        logInfo(\"sun.java2d.renderer.skip_pipe        = \"\n-                + MarlinProperties.isSkipRenderTiles());\n-\n@@ -1285,1 +1271,0 @@\n-        logInfo(\"SORT         = \" + MergeSort.SORT_TYPE);\n","filename":"src\/java.desktop\/share\/classes\/sun\/java2d\/marlin\/DMarlinRenderingEngine.java","additions":1,"deletions":16,"binary":false,"changes":17,"status":"modified"},{"patch":"@@ -1,72 +0,0 @@\n-\/*\n- * Copyright (c) 2022, Oracle and\/or its affiliates. All rights reserved.\n- * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n- *\n- * This code is free software; you can redistribute it and\/or modify it\n- * under the terms of the GNU General Public License version 2 only, as\n- * published by the Free Software Foundation.  Oracle designates this\n- * particular file as subject to the \"Classpath\" exception as provided\n- * by Oracle in the LICENSE file that accompanied this code.\n- *\n- * This code is distributed in the hope that it will be useful, but WITHOUT\n- * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n- * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n- * version 2 for more details (a copy is included in the LICENSE file that\n- * accompanied this code).\n- *\n- * You should have received a copy of the GNU General Public License version\n- * 2 along with this work; if not, write to the Free Software Foundation,\n- * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n- *\n- * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n- * or visit www.oracle.com if you need additional information or have any\n- * questions.\n- *\/\n-package sun.java2d.marlin;\n-\n-\/**\n- * DPQS Sorter context\n- *\/\n-final class DPQSSorterContext {\n-\n-    static final boolean LOG_ALLOC = false;\n-    static final boolean CHECK_ALLOC = false && LOG_ALLOC;\n-\n-    \/**\n-     * Max capacity of the index array for tracking runs.\n-     *\/\n-    static final int MAX_RUN_CAPACITY = DualPivotQuicksort20191112Ext.MAX_RUN_CAPACITY;\n-\n-    \/* members *\/\n-    final int[] run;\n-    int[] auxA;\n-    int[] auxB;\n-    boolean runInit;\n-\n-    DPQSSorterContext() {\n-        \/\/ preallocate max runs:\n-        if (LOG_ALLOC) {\n-            MarlinUtils.logInfo(\"alloc run: \" + MAX_RUN_CAPACITY);\n-        }\n-        run = new int[MAX_RUN_CAPACITY];\n-    }\n-\n-    void initBuffers(final int length, final int[] a, final int[] b) {\n-        auxA = a;\n-        if (CHECK_ALLOC && (a.length < length)) {\n-            if (LOG_ALLOC) {\n-                MarlinUtils.logInfo(\"alloc auxA: \" + length);\n-            }\n-            auxA = new int[length];\n-        }\n-        auxB = b;\n-        if (CHECK_ALLOC && (b.length < length)) {\n-            if (LOG_ALLOC) {\n-                MarlinUtils.logInfo(\"alloc auxB: \" + length);\n-            }\n-            auxB = new int[length];\n-        }\n-        runInit = true;\n-    }\n-\n-}\n","filename":"src\/java.desktop\/share\/classes\/sun\/java2d\/marlin\/DPQSSorterContext.java","additions":0,"deletions":72,"binary":false,"changes":72,"status":"deleted"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2007, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2007, 2017, Oracle and\/or its affiliates. All rights reserved.\n@@ -30,1 +30,1 @@\n-     * @see java.awt.geom.Path2D.Double#moveTo\n+     * @see java.awt.geom.Path2D.Float#moveTo\n@@ -35,1 +35,1 @@\n-     * @see java.awt.geom.Path2D.Double#lineTo\n+     * @see java.awt.geom.Path2D.Float#lineTo\n@@ -40,1 +40,1 @@\n-     * @see java.awt.geom.Path2D.Double#quadTo\n+     * @see java.awt.geom.Path2D.Float#quadTo\n@@ -46,1 +46,1 @@\n-     * @see java.awt.geom.Path2D.Double#curveTo\n+     * @see java.awt.geom.Path2D.Float#curveTo\n@@ -53,1 +53,1 @@\n-     * @see java.awt.geom.Path2D.Double#closePath\n+     * @see java.awt.geom.Path2D.Float#closePath\n","filename":"src\/java.desktop\/share\/classes\/sun\/java2d\/marlin\/DPathConsumer2D.java","additions":6,"deletions":6,"binary":false,"changes":12,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2007, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2007, 2021, Oracle and\/or its affiliates. All rights reserved.\n@@ -31,1 +31,0 @@\n-import sun.java2d.marlin.TransformingPathConsumer2D.StartFlagPathConsumer2D;\n@@ -44,1 +43,1 @@\n-final class Dasher implements StartFlagPathConsumer2D, MarlinConst {\n+final class Dasher implements DPathConsumer2D, MarlinConst {\n@@ -94,1 +93,1 @@\n-    final ArrayCacheDouble.Reference dashes_ref;\n+    final DoubleArrayCache.Reference dashes_ref;\n@@ -96,1 +95,1 @@\n-    final ArrayCacheDouble.Reference firstSegmentsBuffer_ref;\n+    final DoubleArrayCache.Reference firstSegmentsBuffer_ref;\n@@ -227,6 +226,1 @@\n-            if (dashes_ref.doCleanRef(dash)) {\n-                dash = dashes_ref.putArray(dash);\n-            }\n-        }\n-        if (firstSegmentsBuffer_ref.doCleanRef(firstSegmentsBuffer)) {\n-            firstSegmentsBuffer = firstSegmentsBuffer_ref.putArray(firstSegmentsBuffer);\n+            dash = dashes_ref.putArray(dash);\n@@ -234,0 +228,1 @@\n+        firstSegmentsBuffer = firstSegmentsBuffer_ref.putArray(firstSegmentsBuffer);\n@@ -351,9 +346,2 @@\n-\n-        if (true && (len == 2)) {\n-            \/\/ most probable case:\n-            buf[segIdx    ] = pts[off    ];\n-            buf[segIdx + 1] = pts[off + 1];\n-        } else {\n-            \/\/ small arraycopy (4 or 6) but with offset:\n-            System.arraycopy(pts, off, buf, segIdx, len);\n-        }\n+        \/\/ small arraycopy (2, 4 or 6) but with offset:\n+        System.arraycopy(pts, off, buf, segIdx, len);\n@@ -363,20 +351,0 @@\n-    \/* Callback from CurveClipSplitter *\/\n-    @Override\n-    public void setStartFlag(boolean first) {\n-        if (first) {\n-            \/\/ reset flag:\n-            rdrCtx.firstFlags &= 0b011;\n-        } else {\n-            rdrCtx.firstFlags |= 0b100;\n-        }\n-    }\n-\n-    public void setMonotonizerStartFlag(boolean first) {\n-        if (first) {\n-            \/\/ reset flag:\n-            rdrCtx.firstFlags &= 0b101;\n-        } else {\n-            rdrCtx.firstFlags |= 0b010;\n-        }\n-    }\n-\n@@ -573,1 +541,1 @@\n-        if (Helpers.isPointCurve(_curCurvepts, type)) {\n+        if (pointCurve(_curCurvepts, type)) {\n@@ -629,1 +597,1 @@\n-        if (Helpers.isPointCurve(_curCurvepts, type)) {\n+        if (pointCurve(_curCurvepts, type)) {\n@@ -649,0 +617,9 @@\n+    private static boolean pointCurve(final double[] curve, final int type) {\n+        for (int i = 2; i < type; i++) {\n+            if (curve[i] != curve[i-2]) {\n+                return false;\n+            }\n+        }\n+        return true;\n+    }\n+\n@@ -730,3 +707,1 @@\n-            \/\/ initializes nextT and lenAtNextT properly\n-            goLeft();\n-\n+            goLeft(); \/\/ initializes nextT and lenAtNextT properly\n@@ -838,1 +813,1 @@\n-                if (n == 1) {\n+                if (n == 1 && !Double.isNaN(nextRoots[0])) {\n@@ -985,0 +960,1 @@\n+\n@@ -1014,5 +990,0 @@\n-\n-            if (i == 0) {\n-                \/\/ disable start flag:\n-                setMonotonizerStartFlag(false);\n-            }\n@@ -1020,2 +991,0 @@\n-        \/\/ reset start flag:\n-        setMonotonizerStartFlag(true);\n@@ -1077,0 +1046,1 @@\n+\n@@ -1105,5 +1075,0 @@\n-\n-            if (i == 0) {\n-                \/\/ disable start flag:\n-                setMonotonizerStartFlag(false);\n-            }\n@@ -1111,2 +1076,0 @@\n-        \/\/ reset start flag:\n-        setMonotonizerStartFlag(true);\n","filename":"src\/java.desktop\/share\/classes\/sun\/java2d\/marlin\/Dasher.java","additions":23,"deletions":60,"binary":false,"changes":83,"status":"modified"},{"patch":"@@ -0,0 +1,269 @@\n+\/*\n+ * Copyright (c) 2015, 2018, Oracle and\/or its affiliates. All rights reserved.\n+ * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+ *\n+ * This code is free software; you can redistribute it and\/or modify it\n+ * under the terms of the GNU General Public License version 2 only, as\n+ * published by the Free Software Foundation.  Oracle designates this\n+ * particular file as subject to the \"Classpath\" exception as provided\n+ * by Oracle in the LICENSE file that accompanied this code.\n+ *\n+ * This code is distributed in the hope that it will be useful, but WITHOUT\n+ * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+ * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+ * version 2 for more details (a copy is included in the LICENSE file that\n+ * accompanied this code).\n+ *\n+ * You should have received a copy of the GNU General Public License version\n+ * 2 along with this work; if not, write to the Free Software Foundation,\n+ * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n+ *\n+ * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n+ * or visit www.oracle.com if you need additional information or have any\n+ * questions.\n+ *\/\n+\n+package sun.java2d.marlin;\n+\n+import static sun.java2d.marlin.ArrayCacheConst.ARRAY_SIZES;\n+import static sun.java2d.marlin.ArrayCacheConst.BUCKETS;\n+import static sun.java2d.marlin.ArrayCacheConst.MAX_ARRAY_SIZE;\n+import static sun.java2d.marlin.MarlinUtils.logInfo;\n+import static sun.java2d.marlin.MarlinUtils.logException;\n+\n+import java.lang.ref.WeakReference;\n+import java.util.Arrays;\n+\n+import sun.java2d.marlin.ArrayCacheConst.BucketStats;\n+import sun.java2d.marlin.ArrayCacheConst.CacheStats;\n+\n+\/*\n+ * Note that the [BYTE\/INT\/FLOAT\/DOUBLE]ArrayCache files are nearly identical except\n+ * for a few type and name differences. Typically, the [BYTE]ArrayCache.java file\n+ * is edited manually and then [INT\/FLOAT\/DOUBLE]ArrayCache.java\n+ * files are generated with the following command lines:\n+ *\/\n+\/\/ % sed -e 's\/(b\\yte)[ ]*\/\/g' -e 's\/b\\yte\/int\/g' -e 's\/B\\yte\/Int\/g' < B\\yteArrayCache.java > IntArrayCache.java\n+\/\/ % sed -e 's\/(b\\yte)[ ]*0\/0.0f\/g' -e 's\/(b\\yte)[ ]*\/(float) \/g' -e 's\/b\\yte\/float\/g' -e 's\/B\\yte\/Float\/g' < B\\yteArrayCache.java > FloatArrayCache.java\n+\/\/ % sed -e 's\/(b\\yte)[ ]*0\/0.0d\/g' -e 's\/(b\\yte)[ ]*\/(double) \/g' -e 's\/b\\yte\/double\/g' -e 's\/B\\yte\/Double\/g' < B\\yteArrayCache.java > DoubleArrayCache.java\n+\n+final class DoubleArrayCache implements MarlinConst {\n+\n+    final boolean clean;\n+    private final int bucketCapacity;\n+    private WeakReference<Bucket[]> refBuckets = null;\n+    final CacheStats stats;\n+\n+    DoubleArrayCache(final boolean clean, final int bucketCapacity) {\n+        this.clean = clean;\n+        this.bucketCapacity = bucketCapacity;\n+        this.stats = (DO_STATS) ?\n+            new CacheStats(getLogPrefix(clean) + \"DoubleArrayCache\") : null;\n+    }\n+\n+    Bucket getCacheBucket(final int length) {\n+        final int bucket = ArrayCacheConst.getBucket(length);\n+        return getBuckets()[bucket];\n+    }\n+\n+    private Bucket[] getBuckets() {\n+        \/\/ resolve reference:\n+        Bucket[] buckets = (refBuckets != null) ? refBuckets.get() : null;\n+\n+        \/\/ create a new buckets ?\n+        if (buckets == null) {\n+            buckets = new Bucket[BUCKETS];\n+\n+            for (int i = 0; i < BUCKETS; i++) {\n+                buckets[i] = new Bucket(clean, ARRAY_SIZES[i], bucketCapacity,\n+                        (DO_STATS) ? stats.bucketStats[i] : null);\n+            }\n+\n+            \/\/ update weak reference:\n+            refBuckets = new WeakReference<Bucket[]>(buckets);\n+        }\n+        return buckets;\n+    }\n+\n+    Reference createRef(final int initialSize) {\n+        return new Reference(this, initialSize);\n+    }\n+\n+    static final class Reference {\n+\n+        \/\/ initial array reference (direct access)\n+        final double[] initial;\n+        private final boolean clean;\n+        private final DoubleArrayCache cache;\n+\n+        Reference(final DoubleArrayCache cache, final int initialSize) {\n+            this.cache = cache;\n+            this.clean = cache.clean;\n+            this.initial = createArray(initialSize);\n+            if (DO_STATS) {\n+                cache.stats.totalInitial += initialSize;\n+            }\n+        }\n+\n+        double[] getArray(final int length) {\n+            if (length <= MAX_ARRAY_SIZE) {\n+                return cache.getCacheBucket(length).getArray();\n+            }\n+            if (DO_STATS) {\n+                cache.stats.oversize++;\n+            }\n+            if (DO_LOG_OVERSIZE) {\n+                logInfo(getLogPrefix(clean) + \"DoubleArrayCache: \"\n+                        + \"getArray[oversize]: length=\\t\" + length);\n+            }\n+            return createArray(length);\n+        }\n+\n+        double[] widenArray(final double[] array, final int usedSize,\n+                          final int needSize)\n+        {\n+            final int length = array.length;\n+            if (DO_CHECKS && length >= needSize) {\n+                return array;\n+            }\n+            if (DO_STATS) {\n+                cache.stats.resize++;\n+            }\n+\n+            \/\/ maybe change bucket:\n+            \/\/ ensure getNewSize() > newSize:\n+            final double[] res = getArray(ArrayCacheConst.getNewSize(usedSize, needSize));\n+\n+            \/\/ use wrapper to ensure proper copy:\n+            System.arraycopy(array, 0, res, 0, usedSize); \/\/ copy only used elements\n+\n+            \/\/ maybe return current array:\n+            putArray(array, 0, usedSize); \/\/ ensure array is cleared\n+\n+            if (DO_LOG_WIDEN_ARRAY) {\n+                logInfo(getLogPrefix(clean) + \"DoubleArrayCache: \"\n+                        + \"widenArray[\" + res.length\n+                        + \"]: usedSize=\\t\" + usedSize + \"\\tlength=\\t\" + length\n+                        + \"\\tneeded length=\\t\" + needSize);\n+            }\n+            return res;\n+        }\n+\n+        double[] putArray(final double[] array)\n+        {\n+            \/\/ dirty array helper:\n+            return putArray(array, 0, array.length);\n+        }\n+\n+        double[] putArray(final double[] array, final int fromIndex,\n+                        final int toIndex)\n+        {\n+            if (array.length <= MAX_ARRAY_SIZE) {\n+                if ((clean || DO_CLEAN_DIRTY) && (toIndex != 0)) {\n+                    \/\/ clean-up array of dirty part[fromIndex; toIndex[\n+                    fill(array, fromIndex, toIndex, 0.0d);\n+                }\n+                \/\/ ensure to never store initial arrays in cache:\n+                if (array != initial) {\n+                    cache.getCacheBucket(array.length).putArray(array);\n+                }\n+            }\n+            return initial;\n+        }\n+    }\n+\n+    static final class Bucket {\n+\n+        private int tail = 0;\n+        private final int arraySize;\n+        private final boolean clean;\n+        private final double[][] arrays;\n+        private final BucketStats stats;\n+\n+        Bucket(final boolean clean, final int arraySize,\n+               final int capacity, final BucketStats stats)\n+        {\n+            this.arraySize = arraySize;\n+            this.clean = clean;\n+            this.stats = stats;\n+            this.arrays = new double[capacity][];\n+        }\n+\n+        double[] getArray() {\n+            if (DO_STATS) {\n+                stats.getOp++;\n+            }\n+            \/\/ use cache:\n+            if (tail != 0) {\n+                final double[] array = arrays[--tail];\n+                arrays[tail] = null;\n+                return array;\n+            }\n+            if (DO_STATS) {\n+                stats.createOp++;\n+            }\n+            return createArray(arraySize);\n+        }\n+\n+        void putArray(final double[] array)\n+        {\n+            if (DO_CHECKS && (array.length != arraySize)) {\n+                logInfo(getLogPrefix(clean) + \"DoubleArrayCache: \"\n+                        + \"bad length = \" + array.length);\n+                return;\n+            }\n+            if (DO_STATS) {\n+                stats.returnOp++;\n+            }\n+            \/\/ fill cache:\n+            if (arrays.length > tail) {\n+                arrays[tail++] = array;\n+\n+                if (DO_STATS) {\n+                    stats.updateMaxSize(tail);\n+                }\n+            } else if (DO_CHECKS) {\n+                logInfo(getLogPrefix(clean) + \"DoubleArrayCache: \"\n+                        + \"array capacity exceeded !\");\n+            }\n+        }\n+    }\n+\n+    static double[] createArray(final int length) {\n+        return new double[length];\n+    }\n+\n+    static void fill(final double[] array, final int fromIndex,\n+                     final int toIndex, final double value)\n+    {\n+        \/\/ clear array data:\n+        Arrays.fill(array, fromIndex, toIndex, value);\n+        if (DO_CHECKS) {\n+            check(array, fromIndex, toIndex, value);\n+        }\n+    }\n+\n+    static void check(final double[] array, final int fromIndex,\n+                      final int toIndex, final double value)\n+    {\n+        if (DO_CHECKS) {\n+            \/\/ check zero on full array:\n+            for (int i = 0; i < array.length; i++) {\n+                if (array[i] != value) {\n+                    logException(\"Invalid value at: \" + i + \" = \" + array[i]\n+                            + \" from: \" + fromIndex + \" to: \" + toIndex + \"\\n\"\n+                            + Arrays.toString(array), new Throwable());\n+\n+                    \/\/ ensure array is correctly filled:\n+                    Arrays.fill(array, value);\n+\n+                    return;\n+                }\n+            }\n+        }\n+    }\n+\n+    static String getLogPrefix(final boolean clean) {\n+        return (clean) ? \"Clean\" : \"Dirty\";\n+    }\n+}\n","filename":"src\/java.desktop\/share\/classes\/sun\/java2d\/marlin\/DoubleArrayCache.java","additions":269,"deletions":0,"binary":false,"changes":269,"status":"added"},{"patch":"@@ -1,882 +0,0 @@\n-\/*\n- * Copyright (c) 2009, 2022, Oracle and\/or its affiliates. All rights reserved.\n- * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n- *\n- * This code is free software; you can redistribute it and\/or modify it\n- * under the terms of the GNU General Public License version 2 only, as\n- * published by the Free Software Foundation.  Oracle designates this\n- * particular file as subject to the \"Classpath\" exception as provided\n- * by Oracle in the LICENSE file that accompanied this code.\n- *\n- * This code is distributed in the hope that it will be useful, but WITHOUT\n- * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n- * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n- * version 2 for more details (a copy is included in the LICENSE file that\n- * accompanied this code).\n- *\n- * You should have received a copy of the GNU General Public License version\n- * 2 along with this work; if not, write to the Free Software Foundation,\n- * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n- *\n- * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n- * or visit www.oracle.com if you need additional information or have any\n- * questions.\n- *\/\n-\n-package sun.java2d.marlin;\n-\n-import java.util.Arrays;\n-\n-\/**\n- * This class implements powerful and fully optimized versions, both\n- * sequential and parallel, of the Dual-Pivot Quicksort algorithm by\n- * Vladimir Yaroslavskiy, Jon Bentley and Josh Bloch. This algorithm\n- * offers O(n log(n)) performance on all data sets, and is typically\n- * faster than traditional (one-pivot) Quicksort implementations.\n- *\n- * There are also additional algorithms, invoked from the Dual-Pivot\n- * Quicksort, such as mixed insertion sort, merging of runs and heap\n- * sort, counting sort and parallel merge sort.\n- *\n- * @author Vladimir Yaroslavskiy\n- * @author Jon Bentley\n- * @author Josh Bloch\n- * @author Doug Lea\n- *\n- * @version 2018.08.18\n- *\n- * @since 1.7 * 14\n- *\/\n-public final class DualPivotQuicksort20191112Ext {\n-\n-    private static final boolean FAST_ISORT = true;\n-\n-    \/*\n-    From OpenJDK14 source code:\n-    8226297: Dual-pivot quicksort improvements\n-        Reviewed-by: dl, lbourges\n-        Contributed-by: Vladimir Yaroslavskiy <vlv.spb.ru@mail.ru>\n-        Tue, 12 Nov 2019 13:49:40 -0800\n-     *\/\n-    \/**\n-     * Prevents instantiation.\n-     *\/\n-    private DualPivotQuicksort20191112Ext() {\n-    }\n-\n-    \/**\n-     * Max array size to use mixed insertion sort.\n-     *\/\n-    private static final int MAX_MIXED_INSERTION_SORT_SIZE = 65;\n-\n-    \/**\n-     * Max array size to use insertion sort.\n-     *\/\n-    private static final int MAX_INSERTION_SORT_SIZE = 44;\n-\n-    \/**\n-     * Min array size to try merging of runs.\n-     *\/\n-    private static final int MIN_TRY_MERGE_SIZE = 4 << 10;\n-\n-    \/**\n-     * Min size of the first run to continue with scanning.\n-     *\/\n-    private static final int MIN_FIRST_RUN_SIZE = 16;\n-\n-    \/**\n-     * Min factor for the first runs to continue scanning.\n-     *\/\n-    private static final int MIN_FIRST_RUNS_FACTOR = 7;\n-\n-    \/**\n-     * Max capacity of the index array for tracking runs.\n-     *\/\n-    \/* private *\/ static final int MAX_RUN_CAPACITY = 5 << 10;\n-\n-    \/**\n-     * Threshold of mixed insertion sort is incremented by this value.\n-     *\/\n-    private static final int DELTA = 3 << 1;\n-\n-    \/**\n-     * Max recursive partitioning depth before using heap sort.\n-     *\/\n-    private static final int MAX_RECURSION_DEPTH = 64 * DELTA;\n-\n-\n-    \/**\n-     * Sorts the specified range of the array.\n-     *\n-     * @param sorter sorter context\n-     * @param a the array to be sorted\n-     * @param auxA auxiliary storage for the array to be sorted\n-     * @param b the secondary array to be ordered\n-     * @param auxB auxiliary storage for the permutation array to be handled\n-     * @param low the index of the first element, inclusive, to be sorted\n-     * @param high the index of the last element, exclusive, to be sorted\n-     *\/\n-    static void sort(DPQSSorterContext sorter, int[] a, int[] auxA, int[] b, int[] auxB, int low, int high) {\n-        \/*\n-         * LBO Shortcut: Invoke insertion sort on the leftmost part.\n-         *\/\n-        if (FAST_ISORT && ((high - low) <= MAX_INSERTION_SORT_SIZE)) {\n-            insertionSort(a, b, low, high);\n-            return;\n-        }\n-\n-        sorter.initBuffers(high, auxA, auxB);\n-        sort(sorter, a, b, 0, low, high);\n-    }\n-\n-    \/**\n-     * Sorts the specified array using the Dual-Pivot Quicksort and\/or\n-     * other sorts in special-cases, possibly with parallel partitions.\n-     *\n-     * @param sorter sorter context\n-     * @param a the array to be sorted\n-     * @param b the secondary array to be ordered\n-     * @param bits the combination of recursion depth and bit flag, where\n-     *        the right bit \"0\" indicates that array is the leftmost part\n-     * @param low the index of the first element, inclusive, to be sorted\n-     * @param high the index of the last element, exclusive, to be sorted\n-     *\/\n-    private static void sort(DPQSSorterContext sorter, int[] a, int[] b, int bits, int low, int high) {\n-        while (true) {\n-            int end = high - 1, size = high - low;\n-\n-            \/*\n-             * Run mixed insertion sort on small non-leftmost parts.\n-             *\/\n-            if (size < MAX_MIXED_INSERTION_SORT_SIZE + bits && (bits & 1) > 0) {\n-                mixedInsertionSort(a, b, low, high - 3 * ((size >> 5) << 3), high);\n-                return;\n-            }\n-\n-            \/*\n-             * Invoke insertion sort on small leftmost part.\n-             *\/\n-            if (size < MAX_INSERTION_SORT_SIZE) {\n-                insertionSort(a, b, low, high);\n-                return;\n-            }\n-\n-            \/*\n-             * Check if the whole array or large non-leftmost\n-             * parts are nearly sorted and then merge runs.\n-             *\/\n-            if ((bits == 0 || size > MIN_TRY_MERGE_SIZE && (bits & 1) > 0)\n-                    && tryMergeRuns(sorter, a, b, low, size)) {\n-                return;\n-            }\n-\n-            \/*\n-             * Switch to heap sort if execution\n-             * time is becoming quadratic.\n-             *\/\n-            if ((bits += DELTA) > MAX_RECURSION_DEPTH) {\n-                heapSort(a, b, low, high);\n-                return;\n-            }\n-\n-            \/*\n-             * Use an inexpensive approximation of the golden ratio\n-             * to select five sample elements and determine pivots.\n-             *\/\n-            int step = (size >> 3) * 3 + 3;\n-\n-            \/*\n-             * Five elements around (and including) the central element\n-             * will be used for pivot selection as described below. The\n-             * unequal choice of spacing these elements was empirically\n-             * determined to work well on a wide variety of inputs.\n-             *\/\n-            int e1 = low + step;\n-            int e5 = end - step;\n-            int e3 = (e1 + e5) >>> 1;\n-            int e2 = (e1 + e3) >>> 1;\n-            int e4 = (e3 + e5) >>> 1;\n-            int a3 = a[e3];\n-\n-            \/*\n-             * Sort these elements in place by the combination\n-             * of 4-element sorting network and insertion sort.\n-             *\n-             *    5 ------o-----------o------------\n-             *            |           |\n-             *    4 ------|-----o-----o-----o------\n-             *            |     |           |\n-             *    2 ------o-----|-----o-----o------\n-             *                  |     |\n-             *    1 ------------o-----o------------\n-             *\/\n-            if (a[e5] < a[e2]) { int t = a[e5]; a[e5] = a[e2]; a[e2] = t; }\n-            if (a[e4] < a[e1]) { int t = a[e4]; a[e4] = a[e1]; a[e1] = t; }\n-            if (a[e5] < a[e4]) { int t = a[e5]; a[e5] = a[e4]; a[e4] = t; }\n-            if (a[e2] < a[e1]) { int t = a[e2]; a[e2] = a[e1]; a[e1] = t; }\n-            if (a[e4] < a[e2]) { int t = a[e4]; a[e4] = a[e2]; a[e2] = t; }\n-\n-            if (a3 < a[e2]) {\n-                if (a3 < a[e1]) {\n-                    a[e3] = a[e2]; a[e2] = a[e1]; a[e1] = a3;\n-                } else {\n-                    a[e3] = a[e2]; a[e2] = a3;\n-                }\n-            } else if (a3 > a[e4]) {\n-                if (a3 > a[e5]) {\n-                    a[e3] = a[e4]; a[e4] = a[e5]; a[e5] = a3;\n-                } else {\n-                    a[e3] = a[e4]; a[e4] = a3;\n-                }\n-            }\n-\n-            \/\/ Pointers\n-            int lower = low; \/\/ The index of the last element of the left part\n-            int upper = end; \/\/ The index of the first element of the right part\n-\n-            \/*\n-             * Partitioning with 2 pivots in case of different elements.\n-             *\/\n-            if (a[e1] < a[e2] && a[e2] < a[e3] && a[e3] < a[e4] && a[e4] < a[e5]) {\n-\n-                \/*\n-                 * Use the first and fifth of the five sorted elements as\n-                 * the pivots. These values are inexpensive approximation\n-                 * of tertiles. Note, that pivot1 < pivot2.\n-                 *\/\n-                int pivotA1 = a[e1];\n-                int pivotA2 = a[e5];\n-                int pivotB1 = b[e1];\n-                int pivotB2 = b[e5];\n-\n-                \/*\n-                 * The first and the last elements to be sorted are moved\n-                 * to the locations formerly occupied by the pivots. When\n-                 * partitioning is completed, the pivots are swapped back\n-                 * into their final positions, and excluded from the next\n-                 * subsequent sorting.\n-                 *\/\n-                a[e1] = a[lower];\n-                a[e5] = a[upper];\n-                b[e1] = b[lower];\n-                b[e5] = b[upper];\n-\n-                \/*\n-                 * Skip elements, which are less or greater than the pivots.\n-                 *\/\n-                while (a[++lower] < pivotA1);\n-                while (a[--upper] > pivotA2);\n-\n-                \/*\n-                 * Backward 3-interval partitioning\n-                 *\n-                 *   left part                 central part          right part\n-                 * +------------------------------------------------------------+\n-                 * |  < pivot1  |   ?   |  pivot1 <= && <= pivot2  |  > pivot2  |\n-                 * +------------------------------------------------------------+\n-                 *             ^       ^                            ^\n-                 *             |       |                            |\n-                 *           lower     k                          upper\n-                 *\n-                 * Invariants:\n-                 *\n-                 *              all in (low, lower] < pivot1\n-                 *    pivot1 <= all in (k, upper)  <= pivot2\n-                 *              all in [upper, end) > pivot2\n-                 *\n-                 * Pointer k is the last index of ?-part\n-                 *\/\n-                for (int unused = --lower, k = ++upper; --k > lower; ) {\n-                    int ak = a[k];\n-                    int bk = b[k];\n-\n-                    if (ak < pivotA1) { \/\/ Move a[k] to the left side\n-                        while (lower < k) {\n-                            if (a[++lower] >= pivotA1) {\n-                                if (a[lower] > pivotA2) {\n-                                    a[k] = a[--upper];\n-                                    a[upper] = a[lower];\n-                                    b[k] = b[  upper];\n-                                    b[upper] = b[lower];\n-                                } else {\n-                                    a[k] = a[lower];\n-                                    b[k] = b[lower];\n-                                }\n-                                a[lower] = ak;\n-                                b[lower] = bk;\n-                                break;\n-                            }\n-                        }\n-                    } else if (ak > pivotA2) { \/\/ Move a[k] to the right side\n-                        a[k] = a[--upper];\n-                        a[upper] = ak;\n-                        b[k] = b[  upper];\n-                        b[upper] = bk;\n-                    }\n-                }\n-\n-                \/*\n-                 * Swap the pivots into their final positions.\n-                 *\/\n-                a[low] = a[lower]; a[lower] = pivotA1;\n-                a[end] = a[upper]; a[upper] = pivotA2;\n-\n-                b[low] = b[lower]; b[lower] = pivotB1;\n-                b[end] = b[upper]; b[upper] = pivotB2;\n-\n-                \/*\n-                 * Sort non-left parts recursively (possibly in parallel),\n-                 * excluding known pivots.\n-                 *\/\n-                sort(sorter, a, b, bits | 1, lower + 1, upper);\n-                sort(sorter, a, b, bits | 1, upper + 1, high);\n-\n-            } else { \/\/ Use single pivot in case of many equal elements\n-\n-                \/*\n-                 * Use the third of the five sorted elements as the pivot.\n-                 * This value is inexpensive approximation of the median.\n-                 *\/\n-                int pivotA = a[e3];\n-                int pivotB = b[e3];\n-\n-                \/*\n-                 * The first element to be sorted is moved to the\n-                 * location formerly occupied by the pivot. After\n-                 * completion of partitioning the pivot is swapped\n-                 * back into its final position, and excluded from\n-                 * the next subsequent sorting.\n-                 *\/\n-                a[e3] = a[lower];\n-                b[e3] = b[lower];\n-\n-                \/*\n-                 * Traditional 3-way (Dutch National Flag) partitioning\n-                 *\n-                 *   left part                 central part    right part\n-                 * +------------------------------------------------------+\n-                 * |   < pivot   |     ?     |   == pivot   |   > pivot   |\n-                 * +------------------------------------------------------+\n-                 *              ^           ^                ^\n-                 *              |           |                |\n-                 *            lower         k              upper\n-                 *\n-                 * Invariants:\n-                 *\n-                 *   all in (low, lower] < pivot\n-                 *   all in (k, upper)  == pivot\n-                 *   all in [upper, end] > pivot\n-                 *\n-                 * Pointer k is the last index of ?-part\n-                 *\/\n-                for (int k = ++upper; --k > lower; ) {\n-                    int ak = a[k];\n-\n-                    if (ak != pivotA) {\n-                        a[k] = pivotA;\n-                        int bk = b[k];\n-\n-                        if (ak < pivotA) { \/\/ Move a[k] to the left side\n-                            while (a[++lower] < pivotA);\n-\n-                            if (a[lower] > pivotA) {\n-                                a[k] = a[--upper];\n-                                a[upper] = a[lower];\n-                                b[k] = b[  upper];\n-                                b[upper] = b[lower];\n-                            } else {\n-                                a[k] = a[lower];\n-                                b[k] = b[lower];\n-                            }\n-                            a[lower] = ak;\n-                            b[lower] = bk;\n-                        } else { \/\/ ak > pivot - Move a[k] to the right side\n-                            a[k] = a[--upper];\n-                            a[upper] = ak;\n-                            b[k] = b[  upper];\n-                            b[upper] = bk;\n-                        }\n-                    }\n-                }\n-\n-                \/*\n-                 * Swap the pivot into its final position.\n-                 *\/\n-                a[low] = a[lower]; a[lower] = pivotA;\n-                b[low] = b[lower]; b[lower] = pivotB;\n-\n-                \/*\n-                 * Sort the right part (possibly in parallel), excluding\n-                 * known pivot. All elements from the central part are\n-                 * equal and therefore already sorted.\n-                 *\/\n-                sort(sorter, a, b, bits | 1, upper, high);\n-            }\n-            high = lower; \/\/ Iterate along the left part\n-        }\n-    }\n-\n-    \/**\n-     * Sorts the specified range of the array using mixed insertion sort.\n-     *\n-     * Mixed insertion sort is combination of simple insertion sort,\n-     * pin insertion sort and pair insertion sort.\n-     *\n-     * In the context of Dual-Pivot Quicksort, the pivot element\n-     * from the left part plays the role of sentinel, because it\n-     * is less than any elements from the given part. Therefore,\n-     * expensive check of the left range can be skipped on each\n-     * iteration unless it is the leftmost call.\n-     *\n-     * @param a the array to be sorted\n-     * @param b the secondary array to be ordered\n-     * @param low the index of the first element, inclusive, to be sorted\n-     * @param end the index of the last element for simple insertion sort\n-     * @param high the index of the last element, exclusive, to be sorted\n-     *\/\n-    private static void mixedInsertionSort(int[] a, int[] b, int low, int end, int high) {\n-        if (end == high) {\n-\n-            \/*\n-             * Invoke simple insertion sort on tiny array.\n-             *\/\n-            for (int i; ++low < end; ) {\n-                int ai = a[i = low];\n-\n-                if (ai < a[i - 1]) {\n-                    int bi = b[i];\n-\n-                    while (ai < a[--i]) {\n-                        a[i + 1] = a[i];\n-                        b[i + 1] = b[i];\n-                    }\n-                    a[i + 1] = ai;\n-                    b[i + 1] = bi;\n-                }\n-            }\n-        } else {\n-\n-            \/*\n-             * Start with pin insertion sort on small part.\n-             *\n-             * Pin insertion sort is extended simple insertion sort.\n-             * The main idea of this sort is to put elements larger\n-             * than an element called pin to the end of array (the\n-             * proper area for such elements). It avoids expensive\n-             * movements of these elements through the whole array.\n-             *\/\n-            int pin = a[end];\n-\n-            for (int i, p = high; ++low < end; ) {\n-                int ai = a[i = low];\n-                int bi = b[i];\n-\n-                if (ai < a[i - 1]) { \/\/ Small element\n-\n-                    \/*\n-                     * Insert small element into sorted part.\n-                     *\/\n-                    a[i] = a[i - 1];\n-                    b[i] = b[--i];\n-\n-                    while (ai < a[--i]) {\n-                        a[i + 1] = a[i];\n-                        b[i + 1] = b[i];\n-                    }\n-                    a[i + 1] = ai;\n-                    b[i + 1] = bi;\n-\n-                } else if (p > i && ai > pin) { \/\/ Large element\n-\n-                    \/*\n-                     * Find element smaller than pin.\n-                     *\/\n-                    while (a[--p] > pin);\n-\n-                    \/*\n-                     * Swap it with large element.\n-                     *\/\n-                    if (p > i) {\n-                        ai = a[p];\n-                        a[p] = a[i];\n-                        bi = b[p];\n-                        b[p] = b[i];\n-                    }\n-\n-                    \/*\n-                     * Insert small element into sorted part.\n-                     *\/\n-                    while (ai < a[--i]) {\n-                        a[i + 1] = a[i];\n-                        b[i + 1] = b[i];\n-                    }\n-                    a[i + 1] = ai;\n-                    b[i + 1] = bi;\n-                }\n-            }\n-\n-            \/*\n-             * Continue with pair insertion sort on remain part.\n-             *\/\n-            for (int i; low < high; ++low) {\n-                int a1 = a[i = low], a2 = a[++low];\n-                int b1 = b[i],       b2 = b[  low];\n-\n-                \/*\n-                 * Insert two elements per iteration: at first, insert the\n-                 * larger element and then insert the smaller element, but\n-                 * from the position where the larger element was inserted.\n-                 *\/\n-                if (a1 > a2) {\n-\n-                    while (a1 < a[--i]) {\n-                        a[i + 2] = a[i];\n-                        b[i + 2] = b[i];\n-                    }\n-                    a[++i + 1] = a1;\n-                    b[  i + 1] = b1;\n-\n-                    while (a2 < a[--i]) {\n-                        a[i + 1] = a[i];\n-                        b[i + 1] = b[i];\n-                    }\n-                    a[i + 1] = a2;\n-                    b[i + 1] = b2;\n-\n-                } else if (a1 < a[i - 1]) {\n-\n-                    while (a2 < a[--i]) {\n-                        a[i + 2] = a[i];\n-                        b[i + 2] = b[i];\n-                    }\n-                    a[++i + 1] = a2;\n-                    b[  i + 1] = b2;\n-\n-                    while (a1 < a[--i]) {\n-                        a[i + 1] = a[i];\n-                        b[i + 1] = b[i];\n-                    }\n-                    a[i + 1] = a1;\n-                    b[i + 1] = b1;\n-                }\n-            }\n-        }\n-    }\n-\n-    \/**\n-     * Sorts the specified range of the array using insertion sort.\n-     *\n-     * @param a the array to be sorted\n-     * @param b the secondary array to be ordered\n-     * @param low the index of the first element, inclusive, to be sorted\n-     * @param high the index of the last element, exclusive, to be sorted\n-     *\/\n-    static void insertionSort(int[] a, int[] b, int low, int high) {\n-        for (int i, k = low; ++k < high; ) {\n-            int ai = a[i = k];\n-\n-            if (ai < a[i - 1]) {\n-                int bi = b[i];\n-\n-                while (--i >= low && ai < a[i]) {\n-                    a[i + 1] = a[i];\n-                    b[i + 1] = b[i];\n-                }\n-                a[i + 1] = ai;\n-                b[i + 1] = bi;\n-            }\n-        }\n-    }\n-\n-    \/**\n-     * Sorts the specified range of the array using heap sort.\n-     *\n-     * @param a the array to be sorted\n-     * @param b the secondary array to be ordered\n-     * @param low the index of the first element, inclusive, to be sorted\n-     * @param high the index of the last element, exclusive, to be sorted\n-     *\/\n-    private static void heapSort(int[] a, int[] b, int low, int high) {\n-        for (int k = (low + high) >>> 1; k > low; ) {\n-            pushDown(a, b, --k, a[k], b[k], low, high);\n-        }\n-        while (--high > low) {\n-            int maxA = a[low];\n-            int maxB = b[low];\n-            pushDown(a, b, low, a[high], b[high], low, high);\n-            a[high] = maxA;\n-            b[high] = maxB;\n-        }\n-    }\n-\n-    \/**\n-     * Pushes specified element down during heap sort.\n-     *\n-     * @param a the array to be sorted\n-     * @param b the secondary array to be ordered\n-     * @param p the start index\n-     * @param valueA the given element in a\n-     * @param valueB the given element in b\n-     * @param low the index of the first element, inclusive, to be sorted\n-     * @param high the index of the last element, exclusive, to be sorted\n-     *\/\n-    private static void pushDown(int[] a, int[] b, int p, int valueA, int valueB, int low, int high) {\n-        for (int k;; a[p] = a[k], b[p] = b[p = k]) {\n-            k = (p << 1) - low + 2; \/\/ Index of the right child\n-\n-            if (k > high) {\n-                break;\n-            }\n-            if (k == high || a[k] < a[k - 1]) {\n-                --k;\n-            }\n-            if (a[k] <= valueA) {\n-                break;\n-            }\n-        }\n-        a[p] = valueA;\n-        b[p] = valueB;\n-    }\n-\n-    \/**\n-     * Tries to sort the specified range of the array.\n-     *\n-     * @param sorter sorter context\n-     * @param a the array to be sorted\n-     * @param b the secondary array to be ordered\n-     * @param low the index of the first element to be sorted\n-     * @param size the array size\n-     * @return true if finally sorted, false otherwise\n-     *\/\n-    private static boolean tryMergeRuns(DPQSSorterContext sorter, int[] a, int[] b, int low, int size) {\n-\n-        \/*\n-         * The run array is constructed only if initial runs are\n-         * long enough to continue, run[i] then holds start index\n-         * of the i-th sequence of elements in non-descending order.\n-         *\/\n-        int[] run = null;\n-        int high = low + size;\n-        int count = 1, last = low;\n-\n-        \/*\n-         * Identify all possible runs.\n-         *\/\n-        for (int k = low + 1; k < high; ) {\n-\n-            \/*\n-             * Find the end index of the current run.\n-             *\/\n-            if (a[k - 1] < a[k]) {\n-\n-                \/\/ Identify ascending sequence\n-                while (++k < high && a[k - 1] <= a[k]);\n-\n-            } else if (a[k - 1] > a[k]) {\n-\n-                \/\/ Identify descending sequence\n-                while (++k < high && a[k - 1] >= a[k]);\n-\n-                \/\/ Reverse into ascending order\n-                for (int i = last - 1, j = k, t; ++i < --j && a[i] > a[j]; ) {\n-                    t = a[i]; a[i] = a[j]; a[j] = t;\n-                    t = b[i]; b[i] = b[j]; b[j] = t;\n-                }\n-            } else { \/\/ Identify constant sequence\n-                for (int ak = a[k]; ++k < high && ak == a[k]; );\n-\n-                if (k < high) {\n-                    continue;\n-                }\n-            }\n-\n-            \/*\n-             * Check special cases.\n-             *\/\n-            if (sorter.runInit || run == null) {\n-                sorter.runInit = false; \/\/ LBO\n-\n-                if (k == high) {\n-\n-                    \/*\n-                     * The array is monotonous sequence,\n-                     * and therefore already sorted.\n-                     *\/\n-                    return true;\n-                }\n-\n-                if (k - low < MIN_FIRST_RUN_SIZE) {\n-\n-                    \/*\n-                     * The first run is too small\n-                     * to proceed with scanning.\n-                     *\/\n-                    return false;\n-                }\n-\n-\/\/                System.out.println(\"alloc run\");\n-\/\/                run = new int[((size >> 10) | 0x7F) & 0x3FF];\n-                run = sorter.run; \/\/ LBO: prealloc\n-                run[0] = low;\n-\n-            } else if (a[last - 1] > a[last]) {\n-\n-                if (count > (k - low) >> MIN_FIRST_RUNS_FACTOR) {\n-\n-                    \/*\n-                     * The first runs are not long\n-                     * enough to continue scanning.\n-                     *\/\n-                    return false;\n-                }\n-\n-                if (++count == MAX_RUN_CAPACITY) {\n-\n-                    \/*\n-                     * Array is not highly structured.\n-                     *\/\n-                    return false;\n-                }\n-\n-                if (false && count == run.length) {\n-\n-                    \/*\n-                     * Increase capacity of index array.\n-                     *\/\n-\/\/                  System.out.println(\"alloc run (resize)\");\n-                    run = Arrays.copyOf(run, count << 1);\n-                }\n-            }\n-            run[count] = (last = k);\n-\n-            \/\/ fix ALMOST_CONTIGUOUS ie consecutive (ascending \/ descending runs)\n-            if (k < high - 1) {\n-                k++; \/\/ LBO\n-            }\n-        }\n-\n-        \/*\n-         * Merge runs of highly structured array.\n-         *\/\n-        if (count > 1) {\n-            int[] auxA = sorter.auxA;\n-            int[] auxB = sorter.auxB;\n-            int offset = low;\n-\n-            \/\/ LBO: prealloc\n-            if ((auxA.length < size || auxB.length < size)) {\n-\/\/                System.out.println(\"alloc aux: \"+size);\n-                auxA = new int[size];\n-                auxB = new int[size];\n-            }\n-            mergeRuns(a, auxA, b, auxB, offset, 1, run, 0, count);\n-        }\n-        return true;\n-    }\n-\n-    \/**\n-     * Merges the specified runs.\n-     *\n-     * @param srcA the source array for the array to be sorted (a)\n-     * @param dstA the temporary buffer used in merging (a)\n-     * @param srcB the source array for the secondary array to be ordered (b)\n-     * @param offset the start index in the source, inclusive\n-     * @param dstB the temporary buffer used in merging (b)\n-     * @param aim specifies merging: to source ( > 0), buffer ( < 0) or any ( == 0)\n-     * @param run the start indexes of the runs, inclusive\n-     * @param lo the start index of the first run, inclusive\n-     * @param hi the start index of the last run, inclusive\n-     * @return the destination where runs are merged\n-     *\/\n-    private static int[] mergeRuns(int[] srcA, int[] dstA, int[] srcB, int[] dstB, int offset,\n-                                   int aim, int[] run, int lo, int hi) {\n-\n-        if (hi - lo == 1) {\n-            if (aim >= 0) {\n-                return srcA;\n-            }\n-            for (int i = run[hi], j = i - offset, low = run[lo]; i > low;\n-                --j, --i, dstA[j] = srcA[i], dstB[j] = srcB[i]\n-            );\n-            return dstA;\n-        }\n-\n-        \/*\n-         * Split into approximately equal parts.\n-         *\/\n-        int mi = lo, rmi = (run[lo] + run[hi]) >>> 1;\n-        while (run[++mi + 1] <= rmi);\n-\n-        \/*\n-         * Merge the left and right parts.\n-         *\/\n-        int[] a1, a2;\n-        a1 = mergeRuns(srcA, dstA, srcB, dstB, offset, -aim, run, lo, mi);\n-        a2 = mergeRuns(srcA, dstA, srcB, dstB, offset,    0, run, mi, hi);\n-\n-        int[] b1, b2;\n-        b1 = a1 == srcA ? srcB : dstB;\n-        b2 = a2 == srcA ? srcB : dstB;\n-\n-        int[] resA = a1 == srcA ? dstA : srcA;\n-        int[] resB = a1 == srcA ? dstB : srcB;\n-\n-        int k   = a1 == srcA ? run[lo] - offset : run[lo];\n-        int lo1 = a1 == dstA ? run[lo] - offset : run[lo];\n-        int hi1 = a1 == dstA ? run[mi] - offset : run[mi];\n-        int lo2 = a2 == dstA ? run[mi] - offset : run[mi];\n-        int hi2 = a2 == dstA ? run[hi] - offset : run[hi];\n-\n-        mergeParts(resA, resB, k, a1, b1, lo1, hi1, a2, b2, lo2, hi2);\n-\n-        return resA;\n-    }\n-\n-    \/**\n-     * Merges the sorted parts.\n-     *\n-     * @param dstA the destination where parts are merged (a)\n-     * @param dstB the destination where parts are merged (b)\n-     * @param k the start index of the destination, inclusive\n-     * @param a1 the first part (a)\n-     * @param b1 the first part (b)\n-     * @param lo1 the start index of the first part, inclusive\n-     * @param hi1 the end index of the first part, exclusive\n-     * @param a2 the second part (a)\n-     * @param b2 the second part (b)\n-     * @param lo2 the start index of the second part, inclusive\n-     * @param hi2 the end index of the second part, exclusive\n-     *\/\n-    private static void mergeParts(int[] dstA, int[] dstB, int k,\n-                                   int[] a1, int[] b1, int lo1, int hi1, int[] a2, int[] b2, int lo2, int hi2) {\n-\/\/ ...\n-        \/*\n-         * Merge small parts sequentially.\n-         *\/\n-        while (lo1 < hi1 && lo2 < hi2) {\n-            if (a1[lo1] < a2[lo2]) {\n-                dstA[k] = a1[lo1];\n-                dstB[k] = b1[lo1];\n-                k++; lo1++;\n-            } else {\n-                dstA[k] = a2[lo2];\n-                dstB[k] = b2[lo2];\n-                k++; lo2++;\n-            }\n-        }\n-        if (dstA != a1 || k < lo1) {\n-            while (lo1 < hi1) {\n-                dstA[k] = a1[lo1];\n-                dstB[k] = b1[lo1];\n-                k++; lo1++;\n-            }\n-        }\n-        if (dstA != a2 || k < lo2) {\n-            while (lo2 < hi2) {\n-                dstA[k] = a2[lo2];\n-                dstB[k] = b2[lo2];\n-                k++; lo2++;\n-            }\n-        }\n-    }\n-}\n","filename":"src\/java.desktop\/share\/classes\/sun\/java2d\/marlin\/DualPivotQuicksort20191112Ext.java","additions":0,"deletions":882,"binary":false,"changes":882,"status":"deleted"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2015, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2015, 2017, Oracle and\/or its affiliates. All rights reserved.\n@@ -36,0 +36,5 @@\n+    \/\/ Copied from sun.misc.FloatConsts:\n+    public static final int FLOAT_SIGNIFICAND_WIDTH = 24;   \/\/ sun.misc.FloatConsts.SIGNIFICAND_WIDTH\n+    public static final int FLOAT_EXP_BIAS = 127;           \/\/ sun.misc.FloatConsts.EXP_BIAS\n+    public static final int FLOAT_EXP_BIT_MASK = 2139095040;\/\/ sun.misc.FloatConsts.EXP_BIT_MASK\n+    public static final int FLOAT_SIGNIF_BIT_MASK = 8388607;\/\/ sun.misc.FloatConsts.SIGNIF_BIT_MASK\n@@ -50,0 +55,137 @@\n+    \/**\n+     * Returns the smallest (closest to negative infinity) {@code float} value\n+     * that is greater than or equal to the argument and is equal to a\n+     * mathematical integer. Special cases:\n+     * <ul><li>If the argument value is already equal to a mathematical integer,\n+     * then the result is the same as the argument.  <li>If the argument is NaN\n+     * or an infinity or positive zero or negative zero, then the result is the\n+     * same as the argument.  <li>If the argument value is less than zero but\n+     * greater than -1.0, then the result is negative zero.<\/ul> Note that the\n+     * value of {@code StrictMath.ceil(x)} is exactly the value of\n+     * {@code -StrictMath.floor(-x)}.\n+     *\n+     * @param a a value.\n+     * @return the smallest (closest to negative infinity) floating-point value\n+     * that is greater than or equal to the argument and is equal to a\n+     * mathematical integer.\n+     *\/\n+    public static float ceil_f(final float a) {\n+        \/\/ Derived from StrictMath.ceil(double):\n+\n+        \/\/ Inline call to Math.getExponent(a) to\n+        \/\/ compute only once Float.floatToRawIntBits(a)\n+        final int doppel = Float.floatToRawIntBits(a);\n+\n+        final int exponent = ((doppel & FLOAT_EXP_BIT_MASK)\n+                >> (FLOAT_SIGNIFICAND_WIDTH - 1))\n+                - FLOAT_EXP_BIAS;\n+\n+        if (exponent < 0) {\n+            \/*\n+             * Absolute value of argument is less than 1.\n+             * floorOrceil(-0.0) => -0.0\n+             * floorOrceil(+0.0) => +0.0\n+             *\/\n+            return ((a == 0.0f) ? a :\n+                    ( (a < 0.0f) ? -0.0f : 1.0f) );\n+        }\n+        if (CHECK_OVERFLOW && (exponent >= 23)) { \/\/ 52 for double\n+            \/*\n+             * Infinity, NaN, or a value so large it must be integral.\n+             *\/\n+            return a;\n+        }\n+        \/\/ Else the argument is either an integral value already XOR it\n+        \/\/ has to be rounded to one.\n+        assert exponent >= 0 && exponent <= 22; \/\/ 51 for double\n+\n+        final int intpart = doppel\n+                & (~(FLOAT_SIGNIF_BIT_MASK >> exponent));\n+\n+        if (intpart == doppel) {\n+            return a; \/\/ integral value (including 0)\n+        }\n+\n+        \/\/ 0 handled above as an integer\n+        \/\/ sign: 1 for negative, 0 for positive numbers\n+        \/\/ add : 0 for negative and 1 for positive numbers\n+        return Float.intBitsToFloat(intpart) + ((~intpart) >>> 31);\n+    }\n+\n+    \/**\n+     * Returns the largest (closest to positive infinity) {@code float} value\n+     * that is less than or equal to the argument and is equal to a mathematical\n+     * integer. Special cases:\n+     * <ul><li>If the argument value is already equal to a mathematical integer,\n+     * then the result is the same as the argument.  <li>If the argument is NaN\n+     * or an infinity or positive zero or negative zero, then the result is the\n+     * same as the argument.<\/ul>\n+     *\n+     * @param a a value.\n+     * @return the largest (closest to positive infinity) floating-point value\n+     * that less than or equal to the argument and is equal to a mathematical\n+     * integer.\n+     *\/\n+    public static float floor_f(final float a) {\n+        \/\/ Derived from StrictMath.floor(double):\n+\n+        \/\/ Inline call to Math.getExponent(a) to\n+        \/\/ compute only once Float.floatToRawIntBits(a)\n+        final int doppel = Float.floatToRawIntBits(a);\n+\n+        final int exponent = ((doppel & FLOAT_EXP_BIT_MASK)\n+                >> (FLOAT_SIGNIFICAND_WIDTH - 1))\n+                - FLOAT_EXP_BIAS;\n+\n+        if (exponent < 0) {\n+            \/*\n+             * Absolute value of argument is less than 1.\n+             * floorOrceil(-0.0) => -0.0\n+             * floorOrceil(+0.0) => +0.0\n+             *\/\n+            return ((a == 0.0f) ? a :\n+                    ( (a < 0.0f) ? -1.0f : 0.0f) );\n+        }\n+        if (CHECK_OVERFLOW && (exponent >= 23)) { \/\/ 52 for double\n+            \/*\n+             * Infinity, NaN, or a value so large it must be integral.\n+             *\/\n+            return a;\n+        }\n+        \/\/ Else the argument is either an integral value already XOR it\n+        \/\/ has to be rounded to one.\n+        assert exponent >= 0 && exponent <= 22; \/\/ 51 for double\n+\n+        final int intpart = doppel\n+                & (~(FLOAT_SIGNIF_BIT_MASK >> exponent));\n+\n+        if (intpart == doppel) {\n+            return a; \/\/ integral value (including 0)\n+        }\n+\n+        \/\/ 0 handled above as an integer\n+        \/\/ sign: 1 for negative, 0 for positive numbers\n+        \/\/ add : -1 for negative and 0 for positive numbers\n+        return Float.intBitsToFloat(intpart) + (intpart >> 31);\n+    }\n+\n+    \/**\n+     * Faster alternative to ceil(float) optimized for the integer domain\n+     * and supporting NaN and +\/-Infinity.\n+     *\n+     * @param a a value.\n+     * @return the largest (closest to positive infinity) integer value\n+     * that less than or equal to the argument and is equal to a mathematical\n+     * integer.\n+     *\/\n+    public static int ceil_int(final float a) {\n+        final int intpart = (int) a;\n+\n+        if (a <= intpart\n+                || (CHECK_OVERFLOW && intpart == Integer.MAX_VALUE)\n+                || CHECK_NAN && Float.isNaN(a)) {\n+            return intpart;\n+        }\n+        return intpart + 1;\n+    }\n+\n@@ -70,0 +212,20 @@\n+    \/**\n+     * Faster alternative to floor(float) optimized for the integer domain\n+     * and supporting NaN and +\/-Infinity.\n+     *\n+     * @param a a value.\n+     * @return the largest (closest to positive infinity) floating-point value\n+     * that less than or equal to the argument and is equal to a mathematical\n+     * integer.\n+     *\/\n+    public static int floor_int(final float a) {\n+        final int intpart = (int) a;\n+\n+        if (a >= intpart\n+                || (CHECK_OVERFLOW && intpart == Integer.MIN_VALUE)\n+                || CHECK_NAN && Float.isNaN(a)) {\n+            return intpart;\n+        }\n+        return intpart - 1;\n+    }\n+\n","filename":"src\/java.desktop\/share\/classes\/sun\/java2d\/marlin\/FloatMath.java","additions":163,"deletions":1,"binary":false,"changes":164,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2007, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2007, 2021, Oracle and\/or its affiliates. All rights reserved.\n@@ -34,2 +34,0 @@\n-    private static final double EPS = 1e-9d;\n-\n@@ -40,4 +38,0 @@\n-    static boolean within(final double x, final double y) {\n-        return within(x, y, EPS);\n-    }\n-\n@@ -45,4 +39,1 @@\n-        return withinD(y - x, err);\n-    }\n-\n-    static boolean withinD(final double d, final double err) {\n+        final double d = y - x;\n@@ -52,22 +43,0 @@\n-    static boolean withinD(final double dx, final double dy, final double err)\n-    {\n-        assert err > 0 : \"\";\n-        \/\/ compare taxicab distance. ERR will always be small, so using\n-        \/\/ true distance won't give much benefit\n-        return (withinD(dx, err) && \/\/ we want to avoid calling Math.abs\n-                withinD(dy, err));  \/\/ this is just as good.\n-    }\n-\n-    static boolean isPointCurve(final double[] curve, final int type) {\n-        return isPointCurve(curve, type, EPS);\n-    }\n-\n-    static boolean isPointCurve(final double[] curve, final int type, final double err) {\n-        for (int i = 2; i < type; i++) {\n-            if (!within(curve[i], curve[i - 2], err)) {\n-                return false;\n-            }\n-        }\n-        return true;\n-    }\n-\n@@ -92,10 +61,13 @@\n-            double d = b * b - 4.0d * a * c;\n-            if (d > 0.0d) {\n-                d = Math.sqrt(d);\n-                \/\/ For accuracy, calculate one root using:\n-                \/\/     (-b +\/- d) \/ 2a\n-                \/\/ and the other using:\n-                \/\/     2c \/ (-b +\/- d)\n-                \/\/ Choose the sign of the +\/- so that b+d gets larger in magnitude\n-                if (b < 0.0d) {\n-                    d = -d;\n+            final double dis = b*b - 4.0d * a * c;\n+            if (dis > 0.0d) {\n+                final double sqrtDis = Math.sqrt(dis);\n+                \/\/ depending on the sign of b we use a slightly different\n+                \/\/ algorithm than the traditional one to find one of the roots\n+                \/\/ so we can avoid adding numbers of different signs (which\n+                \/\/ might result in loss of precision).\n+                if (b >= 0.0d) {\n+                    zeroes[ret++] = (2.0d * c) \/ (-b - sqrtDis);\n+                    zeroes[ret++] = (-b - sqrtDis) \/ (2.0d * a);\n+                } else {\n+                    zeroes[ret++] = (-b + sqrtDis) \/ (2.0d * a);\n+                    zeroes[ret++] = (2.0d * c) \/ (-b + sqrtDis);\n@@ -103,7 +75,1 @@\n-                final double q = (b + d) \/ -2.0d;\n-                \/\/ We already tested a for being 0 above\n-                zeroes[ret++] = q \/ a;\n-                if (q != 0.0d) {\n-                    zeroes[ret++] = c \/ q;\n-                }\n-            } else if (d == 0.0d) {\n+            } else if (dis == 0.0d) {\n@@ -134,0 +100,4 @@\n+\n+        \/*\n+         * TODO: cleanup all that code after reading Roots3And4.c\n+         *\/\n@@ -146,0 +116,1 @@\n+        final double sub = (1.0d \/ 3.0d) * a;\n@@ -148,1 +119,0 @@\n-        final double sub = (1.0d \/ 3.0d) * a;\n@@ -152,0 +122,1 @@\n+\n@@ -156,14 +127,1 @@\n-\n-        if (within(D, 0.0d)) {\n-            if (within(q, 0.0d)) {\n-                \/* one triple solution *\/\n-                pts[off    ] = (- sub);\n-                num = 1;\n-            } else {\n-                \/* one single and one double solution *\/\n-                final double u = Math.cbrt(-q);\n-                pts[off    ] = (2.0d * u - sub);\n-                pts[off + 1] = (- u - sub);\n-                num = 2;\n-            }\n-        } else if (D < 0.0d) {\n+        if (D < 0.0d) {\n@@ -185,0 +143,5 @@\n+\n+            if (within(D, 0.0d, 1e-8d)) {\n+                pts[off + 1] = ((-1.0d \/ 2.0d) * (u + v) - sub);\n+                num = 2;\n+            }\n@@ -186,0 +149,1 @@\n+\n@@ -660,1 +624,1 @@\n-        final ArrayCacheDouble.Reference curves_ref;\n+        final DoubleArrayCache.Reference curves_ref;\n@@ -662,1 +626,1 @@\n-        final ArrayCacheByte.Reference curveTypes_ref;\n+        final ByteArrayCache.Reference curveTypes_ref;\n@@ -709,1 +673,1 @@\n-            end       = 0;\n+            end = 0;\n@@ -724,6 +688,2 @@\n-            if (curves_ref.doCleanRef(curves)) {\n-                curves = curves_ref.putArray(curves);\n-            }\n-            if (curveTypes_ref.doCleanRef(curveTypes)) {\n-                curveTypes = curveTypes_ref.putArray(curveTypes);\n-            }\n+            curves     = curves_ref.putArray(curves);\n+            curveTypes = curveTypes_ref.putArray(curveTypes);\n@@ -733,1 +693,1 @@\n-            \/\/ use substraction to avoid integer overflow:\n+            \/\/ use subtraction to avoid integer overflow:\n@@ -869,1 +829,1 @@\n-            StringBuilder ret = new StringBuilder();\n+            String ret = \"\";\n@@ -877,1 +837,1 @@\n-                    ret.append(\"line: \");\n+                    ret += \"line: \";\n@@ -881,1 +841,1 @@\n-                    ret.append(\"quad: \");\n+                    ret += \"quad: \";\n@@ -885,1 +845,1 @@\n-                    ret.append(\"cubic: \");\n+                    ret += \"cubic: \";\n@@ -891,1 +851,2 @@\n-                ret.append(Arrays.toString(Arrays.copyOfRange(curves, last, last + len))).append(\"\\n\");\n+                ret += Arrays.toString(Arrays.copyOfRange(curves, last, last+len))\n+                                       + \"\\n\";\n@@ -893,1 +854,1 @@\n-            return ret.toString();\n+            return ret;\n@@ -907,1 +868,1 @@\n-        private final ArrayCacheInt.Reference indices_ref;\n+        private final IntArrayCache.Reference indices_ref;\n@@ -953,4 +914,2 @@\n-            \/\/ indices is kept dirty\n-            if (indices_ref.doCleanRef(indices)) {\n-                indices = indices_ref.putArray(indices);\n-            }\n+            \/\/ values is kept dirty\n+            indices = indices_ref.putArray(indices);\n@@ -994,3 +953,1 @@\n-        void pullAll(final double[] points, final DPathConsumer2D io,\n-                     final boolean moveFirst)\n-        {\n+        void pullAll(final double[] points, final DPathConsumer2D io) {\n@@ -1003,9 +960,1 @@\n-            int i = 0;\n-\n-            if (moveFirst) {\n-                int j = _values[i] << 1;\n-                io.moveTo(points[j], points[j + 1]);\n-                i++;\n-            }\n-\n-            for (int j; i < nc; i++) {\n+            for (int i = 0, j; i < nc; i++) {\n","filename":"src\/java.desktop\/share\/classes\/sun\/java2d\/marlin\/Helpers.java","additions":47,"deletions":98,"binary":false,"changes":145,"status":"modified"},{"patch":"@@ -0,0 +1,269 @@\n+\/*\n+ * Copyright (c) 2015, 2018, Oracle and\/or its affiliates. All rights reserved.\n+ * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+ *\n+ * This code is free software; you can redistribute it and\/or modify it\n+ * under the terms of the GNU General Public License version 2 only, as\n+ * published by the Free Software Foundation.  Oracle designates this\n+ * particular file as subject to the \"Classpath\" exception as provided\n+ * by Oracle in the LICENSE file that accompanied this code.\n+ *\n+ * This code is distributed in the hope that it will be useful, but WITHOUT\n+ * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+ * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+ * version 2 for more details (a copy is included in the LICENSE file that\n+ * accompanied this code).\n+ *\n+ * You should have received a copy of the GNU General Public License version\n+ * 2 along with this work; if not, write to the Free Software Foundation,\n+ * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n+ *\n+ * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n+ * or visit www.oracle.com if you need additional information or have any\n+ * questions.\n+ *\/\n+\n+package sun.java2d.marlin;\n+\n+import static sun.java2d.marlin.ArrayCacheConst.ARRAY_SIZES;\n+import static sun.java2d.marlin.ArrayCacheConst.BUCKETS;\n+import static sun.java2d.marlin.ArrayCacheConst.MAX_ARRAY_SIZE;\n+import static sun.java2d.marlin.MarlinUtils.logInfo;\n+import static sun.java2d.marlin.MarlinUtils.logException;\n+\n+import java.lang.ref.WeakReference;\n+import java.util.Arrays;\n+\n+import sun.java2d.marlin.ArrayCacheConst.BucketStats;\n+import sun.java2d.marlin.ArrayCacheConst.CacheStats;\n+\n+\/*\n+ * Note that the [BYTE\/INT\/FLOAT\/DOUBLE]ArrayCache files are nearly identical except\n+ * for a few type and name differences. Typically, the [BYTE]ArrayCache.java file\n+ * is edited manually and then [INT\/FLOAT\/DOUBLE]ArrayCache.java\n+ * files are generated with the following command lines:\n+ *\/\n+\/\/ % sed -e 's\/(b\\yte)[ ]*\/\/g' -e 's\/b\\yte\/int\/g' -e 's\/B\\yte\/Int\/g' < B\\yteArrayCache.java > IntArrayCache.java\n+\/\/ % sed -e 's\/(b\\yte)[ ]*0\/0.0f\/g' -e 's\/(b\\yte)[ ]*\/(float) \/g' -e 's\/b\\yte\/float\/g' -e 's\/B\\yte\/Float\/g' < B\\yteArrayCache.java > FloatArrayCache.java\n+\/\/ % sed -e 's\/(b\\yte)[ ]*0\/0.0d\/g' -e 's\/(b\\yte)[ ]*\/(double) \/g' -e 's\/b\\yte\/double\/g' -e 's\/B\\yte\/Double\/g' < B\\yteArrayCache.java > DoubleArrayCache.java\n+\n+final class IntArrayCache implements MarlinConst {\n+\n+    final boolean clean;\n+    private final int bucketCapacity;\n+    private WeakReference<Bucket[]> refBuckets = null;\n+    final CacheStats stats;\n+\n+    IntArrayCache(final boolean clean, final int bucketCapacity) {\n+        this.clean = clean;\n+        this.bucketCapacity = bucketCapacity;\n+        this.stats = (DO_STATS) ?\n+            new CacheStats(getLogPrefix(clean) + \"IntArrayCache\") : null;\n+    }\n+\n+    Bucket getCacheBucket(final int length) {\n+        final int bucket = ArrayCacheConst.getBucket(length);\n+        return getBuckets()[bucket];\n+    }\n+\n+    private Bucket[] getBuckets() {\n+        \/\/ resolve reference:\n+        Bucket[] buckets = (refBuckets != null) ? refBuckets.get() : null;\n+\n+        \/\/ create a new buckets ?\n+        if (buckets == null) {\n+            buckets = new Bucket[BUCKETS];\n+\n+            for (int i = 0; i < BUCKETS; i++) {\n+                buckets[i] = new Bucket(clean, ARRAY_SIZES[i], bucketCapacity,\n+                        (DO_STATS) ? stats.bucketStats[i] : null);\n+            }\n+\n+            \/\/ update weak reference:\n+            refBuckets = new WeakReference<Bucket[]>(buckets);\n+        }\n+        return buckets;\n+    }\n+\n+    Reference createRef(final int initialSize) {\n+        return new Reference(this, initialSize);\n+    }\n+\n+    static final class Reference {\n+\n+        \/\/ initial array reference (direct access)\n+        final int[] initial;\n+        private final boolean clean;\n+        private final IntArrayCache cache;\n+\n+        Reference(final IntArrayCache cache, final int initialSize) {\n+            this.cache = cache;\n+            this.clean = cache.clean;\n+            this.initial = createArray(initialSize);\n+            if (DO_STATS) {\n+                cache.stats.totalInitial += initialSize;\n+            }\n+        }\n+\n+        int[] getArray(final int length) {\n+            if (length <= MAX_ARRAY_SIZE) {\n+                return cache.getCacheBucket(length).getArray();\n+            }\n+            if (DO_STATS) {\n+                cache.stats.oversize++;\n+            }\n+            if (DO_LOG_OVERSIZE) {\n+                logInfo(getLogPrefix(clean) + \"IntArrayCache: \"\n+                        + \"getArray[oversize]: length=\\t\" + length);\n+            }\n+            return createArray(length);\n+        }\n+\n+        int[] widenArray(final int[] array, final int usedSize,\n+                          final int needSize)\n+        {\n+            final int length = array.length;\n+            if (DO_CHECKS && length >= needSize) {\n+                return array;\n+            }\n+            if (DO_STATS) {\n+                cache.stats.resize++;\n+            }\n+\n+            \/\/ maybe change bucket:\n+            \/\/ ensure getNewSize() > newSize:\n+            final int[] res = getArray(ArrayCacheConst.getNewSize(usedSize, needSize));\n+\n+            \/\/ use wrapper to ensure proper copy:\n+            System.arraycopy(array, 0, res, 0, usedSize); \/\/ copy only used elements\n+\n+            \/\/ maybe return current array:\n+            putArray(array, 0, usedSize); \/\/ ensure array is cleared\n+\n+            if (DO_LOG_WIDEN_ARRAY) {\n+                logInfo(getLogPrefix(clean) + \"IntArrayCache: \"\n+                        + \"widenArray[\" + res.length\n+                        + \"]: usedSize=\\t\" + usedSize + \"\\tlength=\\t\" + length\n+                        + \"\\tneeded length=\\t\" + needSize);\n+            }\n+            return res;\n+        }\n+\n+        int[] putArray(final int[] array)\n+        {\n+            \/\/ dirty array helper:\n+            return putArray(array, 0, array.length);\n+        }\n+\n+        int[] putArray(final int[] array, final int fromIndex,\n+                        final int toIndex)\n+        {\n+            if (array.length <= MAX_ARRAY_SIZE) {\n+                if ((clean || DO_CLEAN_DIRTY) && (toIndex != 0)) {\n+                    \/\/ clean-up array of dirty part[fromIndex; toIndex[\n+                    fill(array, fromIndex, toIndex, 0);\n+                }\n+                \/\/ ensure to never store initial arrays in cache:\n+                if (array != initial) {\n+                    cache.getCacheBucket(array.length).putArray(array);\n+                }\n+            }\n+            return initial;\n+        }\n+    }\n+\n+    static final class Bucket {\n+\n+        private int tail = 0;\n+        private final int arraySize;\n+        private final boolean clean;\n+        private final int[][] arrays;\n+        private final BucketStats stats;\n+\n+        Bucket(final boolean clean, final int arraySize,\n+               final int capacity, final BucketStats stats)\n+        {\n+            this.arraySize = arraySize;\n+            this.clean = clean;\n+            this.stats = stats;\n+            this.arrays = new int[capacity][];\n+        }\n+\n+        int[] getArray() {\n+            if (DO_STATS) {\n+                stats.getOp++;\n+            }\n+            \/\/ use cache:\n+            if (tail != 0) {\n+                final int[] array = arrays[--tail];\n+                arrays[tail] = null;\n+                return array;\n+            }\n+            if (DO_STATS) {\n+                stats.createOp++;\n+            }\n+            return createArray(arraySize);\n+        }\n+\n+        void putArray(final int[] array)\n+        {\n+            if (DO_CHECKS && (array.length != arraySize)) {\n+                logInfo(getLogPrefix(clean) + \"IntArrayCache: \"\n+                        + \"bad length = \" + array.length);\n+                return;\n+            }\n+            if (DO_STATS) {\n+                stats.returnOp++;\n+            }\n+            \/\/ fill cache:\n+            if (arrays.length > tail) {\n+                arrays[tail++] = array;\n+\n+                if (DO_STATS) {\n+                    stats.updateMaxSize(tail);\n+                }\n+            } else if (DO_CHECKS) {\n+                logInfo(getLogPrefix(clean) + \"IntArrayCache: \"\n+                        + \"array capacity exceeded !\");\n+            }\n+        }\n+    }\n+\n+    static int[] createArray(final int length) {\n+        return new int[length];\n+    }\n+\n+    static void fill(final int[] array, final int fromIndex,\n+                     final int toIndex, final int value)\n+    {\n+        \/\/ clear array data:\n+        Arrays.fill(array, fromIndex, toIndex, value);\n+        if (DO_CHECKS) {\n+            check(array, fromIndex, toIndex, value);\n+        }\n+    }\n+\n+    static void check(final int[] array, final int fromIndex,\n+                      final int toIndex, final int value)\n+    {\n+        if (DO_CHECKS) {\n+            \/\/ check zero on full array:\n+            for (int i = 0; i < array.length; i++) {\n+                if (array[i] != value) {\n+                    logException(\"Invalid value at: \" + i + \" = \" + array[i]\n+                            + \" from: \" + fromIndex + \" to: \" + toIndex + \"\\n\"\n+                            + Arrays.toString(array), new Throwable());\n+\n+                    \/\/ ensure array is correctly filled:\n+                    Arrays.fill(array, value);\n+\n+                    return;\n+                }\n+            }\n+        }\n+    }\n+\n+    static String getLogPrefix(final boolean clean) {\n+        return (clean) ? \"Clean\" : \"Dirty\";\n+    }\n+}\n","filename":"src\/java.desktop\/share\/classes\/sun\/java2d\/marlin\/IntArrayCache.java","additions":269,"deletions":0,"binary":false,"changes":269,"status":"added"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2007, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2007, 2021, Oracle and\/or its affiliates. All rights reserved.\n@@ -104,1 +104,1 @@\n-    private final ArrayCacheIntClean.Reference touchedTile_ref;\n+    private final IntArrayCache.Reference touchedTile_ref;\n@@ -169,3 +169,1 @@\n-        if (touchedTile_ref.doSetRef(touchedTile)) {\n-            touchedTile = touchedTile_ref.putArrayClean(touchedTile); \/\/ already zero filled\n-        }\n+        touchedTile = touchedTile_ref.putArray(touchedTile, 0, 0); \/\/ already zero filled\n@@ -203,1 +201,1 @@\n-                ArrayCacheInt.fill(touchedTile, tileMin, tileMax, 0);\n+                IntArrayCache.fill(touchedTile, tileMin, tileMax, 0);\n@@ -334,1 +332,1 @@\n-        ArrayCacheInt.fill(alphaRow, from, px1 + 1 - bboxX0, 0);\n+        IntArrayCache.fill(alphaRow, from, px1 + 1 - bboxX0, 0);\n@@ -548,2 +546,2 @@\n-            ArrayCacheInt.check(blkFlags, blkW, blkE, 0);\n-            ArrayCacheInt.check(alphaRow, from, px1 + 1 - bboxX0, 0);\n+            IntArrayCache.check(blkFlags, blkW, blkE, 0);\n+            IntArrayCache.check(alphaRow, from, px1 + 1 - bboxX0, 0);\n","filename":"src\/java.desktop\/share\/classes\/sun\/java2d\/marlin\/MarlinCache.java","additions":7,"deletions":9,"binary":false,"changes":16,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2007, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2007, 2021, Oracle and\/or its affiliates. All rights reserved.\n@@ -80,19 +80,0 @@\n-    \/**\n-     * Return true if the profile is 'quality' (default) over 'speed'\n-     *\n-     * @return true if the profile is 'quality' (default), false otherwise\n-     *\/\n-    public static boolean isProfileQuality() {\n-        final String key = \"sun.java2d.renderer.profile\";\n-        final String profile = getString(key, \"quality\");\n-        if (\"quality\".equals(profile)) {\n-            return true;\n-        }\n-        if (\"speed\".equals(profile)) {\n-            return false;\n-        }\n-        logInfo(\"Invalid value for \" + key + \" = \" + profile\n-                    + \"; expect value in [quality, speed] !\");\n-        return true;\n-    }\n-\n@@ -113,2 +94,1 @@\n-     * (3 by default ie 8 subpixels for the quality profile)\n-     * (2 by default ie 4 subpixels for the speed profile)\n+     * (3 by default ie 8 subpixels)\n@@ -117,2 +97,1 @@\n-        final int def = isProfileQuality() ? 3 : 2;\n-        return getInteger(\"sun.java2d.renderer.subPixel_log2_Y\", def, 0, 8);\n+        return getInteger(\"sun.java2d.renderer.subPixel_log2_Y\", 3, 0, 8);\n@@ -192,13 +171,0 @@\n-    public static float getStrokerJoinError() {\n-        final float def = (1.0f \/ MarlinConst.MIN_SUBPIXELS);\n-        float err = getFloat(\"sun.java2d.renderer.stroker.joinError\",\n-                def,\n-                -1.0f,\n-                10.0f);\n-        return (err < 0.0f) ? def : err;\n-    }\n-\n-    public static int getStrokerJoinStyle() {\n-        return getInteger(\"sun.java2d.renderer.stroker.joinStyle\", -1, -1, 2);\n-    }\n-\n@@ -225,4 +191,0 @@\n-    public static boolean isUseDPQS() {\n-        return getBoolean(\"sun.java2d.renderer.useDPQS\", \"true\");\n-    }\n-\n@@ -243,8 +205,0 @@\n-    public static boolean isSkipRenderer() {\n-        return getBoolean(\"sun.java2d.renderer.skip_rdr\", \"false\");\n-    }\n-\n-    public static boolean isSkipRenderTiles() {\n-        return getBoolean(\"sun.java2d.renderer.skip_pipe\", \"false\");\n-    }\n-\n@@ -276,2 +230,1 @@\n-        final float def = isProfileQuality() ? 1.0f : 2.5f;\n-        return getFloat(\"sun.java2d.renderer.cubic_dec_d2\", def, 1e-5f, 4.0f);\n+        return getFloat(\"sun.java2d.renderer.cubic_dec_d2\", 1.0f, 1e-5f, 4.0f);\n@@ -281,2 +234,1 @@\n-        final float def = isProfileQuality() ? 0.2f : 0.5f;\n-        return getFloat(\"sun.java2d.renderer.cubic_inc_d1\", def, 1e-6f, 1.0f);\n+        return getFloat(\"sun.java2d.renderer.cubic_inc_d1\", 0.2f, 1e-6f, 1.0f);\n@@ -286,2 +238,1 @@\n-        final float def = isProfileQuality() ? 0.5f : 1.0f;\n-        return getFloat(\"sun.java2d.renderer.quad_dec_d2\", def, 1e-5f, 4.0f);\n+        return getFloat(\"sun.java2d.renderer.quad_dec_d2\", 0.5f, 1e-5f, 4.0f);\n@@ -291,6 +242,0 @@\n-    @SuppressWarnings(\"removal\")\n-    static String getString(final String key, final String def) {\n-        return AccessController.doPrivileged(\n-                  new GetPropertyAction(key, def));\n-    }\n-\n@@ -329,1 +274,1 @@\n-        final int ceil = FloatMath.ceil_int( ((double) val) \/ norm);\n+        final int ceil = FloatMath.ceil_int( ((float) val) \/ norm);\n","filename":"src\/java.desktop\/share\/classes\/sun\/java2d\/marlin\/MarlinProperties.java","additions":7,"deletions":62,"binary":false,"changes":69,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2007, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2007, 2021, Oracle and\/or its affiliates. All rights reserved.\n@@ -787,1 +787,1 @@\n-        StringBuilder s = new StringBuilder(Integer.toHexString(v));\n+        String s = Integer.toHexString(v);\n@@ -789,1 +789,1 @@\n-            s.insert(0, \"0\");\n+            s = \"0\" + s;\n","filename":"src\/java.desktop\/share\/classes\/sun\/java2d\/marlin\/MarlinTileGenerator.java","additions":3,"deletions":3,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2009, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2009, 2018, Oracle and\/or its affiliates. All rights reserved.\n@@ -28,3 +28,0 @@\n-import java.util.Arrays;\n-import static sun.java2d.marlin.DualPivotQuicksort20191112Ext.sort;\n-\n@@ -38,16 +35,2 @@\n-    static final boolean USE_DPQS = MarlinProperties.isUseDPQS();\n-\n-    static final String SORT_TYPE = USE_DPQS ? \"DPQS_20191112\" : \"MERGE\";\n-\n-    static final int DPQS_THRESHOLD = 256;\n-    static final int DISABLE_ISORT_THRESHOLD = 1000;\n-\n-    private static final boolean CHECK_SORTED = false;\n-\n-    static {\n-        MarlinUtils.logInfo(\"MergeSort: DPQS_THRESHOLD: \" + DPQS_THRESHOLD);\n-        MarlinUtils.logInfo(\"MergeSort: DISABLE_ISORT_THRESHOLD: \" + DISABLE_ISORT_THRESHOLD);\n-        if (CHECK_SORTED) {\n-            MarlinUtils.logInfo(\"MergeSort: CHECK_SORTED: \" + CHECK_SORTED);\n-        }\n-    }\n+    \/\/ insertion sort threshold\n+    public static final int INSERTION_SORT_THRESHOLD = 14;\n@@ -64,4 +47,1 @@\n-                                final int insertionSortIndex,\n-                                final boolean skipISort,\n-                                final DPQSSorterContext sorter,\n-                                final boolean useDPQS)\n+                                final int insertionSortIndex)\n@@ -73,23 +53,1 @@\n-                    + toIndex);\n-        }\n-        if (skipISort) {\n-            if (useDPQS) {\n-                \/\/ sort full x\/y in-place\n-                sort(sorter, x, auxX, y, auxY, 0, toIndex);\n-            } else {\n-                \/\/ sort full auxX\/auxY into x\/y\n-                mergeSort(auxX, auxY, auxX, x, auxY, y, 0, toIndex);\n-            }\n-            if (CHECK_SORTED) {\n-                checkRange(x, 0, toIndex);\n-            }\n-            return;\n-        } else {\n-            if (useDPQS) {\n-                \/\/ sort auxX\/auxY in-place\n-                sort(sorter, auxX, x, auxY, y, insertionSortIndex, toIndex);\n-            } else {\n-                \/\/ sort second part only using merge sort\n-                \/\/ x\/y into auxiliary storage (auxX\/auxY)\n-                mergeSort(x, y, x, auxX, y, auxY, insertionSortIndex, toIndex);\n-            }\n+                                                     + toIndex);\n@@ -98,0 +56,4 @@\n+        \/\/ sort second part only using merge \/ insertion sort\n+        \/\/ in auxiliary storage (auxX\/auxY)\n+        mergeSort(x, y, x, auxX, y, auxY, insertionSortIndex, toIndex);\n+\n@@ -100,0 +62,9 @@\n+        if ((insertionSortIndex == 0)\n+            || (auxX[insertionSortIndex - 1] <= auxX[insertionSortIndex])) {\n+            \/\/ 34 occurrences\n+            \/\/ no initial left part or both sublists (auxX, auxY) are sorted:\n+            \/\/ copy back data into (x, y):\n+            System.arraycopy(auxX, 0, x, 0, toIndex);\n+            System.arraycopy(auxY, 0, y, 0, toIndex);\n+            return;\n+        }\n@@ -103,1 +74,1 @@\n-                    && (auxX[p] <= auxX[q]))) {\n+                                   && (auxX[p] <= auxX[q]))) {\n@@ -113,4 +84,0 @@\n-\n-        if (CHECK_SORTED) {\n-            checkRange(x, 0, toIndex);\n-        }\n@@ -119,3 +86,0 @@\n-    \/\/ insertion sort threshold for MergeSort()\n-    static final int INSERTION_SORT_THRESHOLD = 14;\n-\n@@ -210,9 +174,0 @@\n-\n-    private static void checkRange(int[] x, int lo, int hi) {\n-        for (int i = lo + 1; i < hi; i++) {\n-            if (x[i - 1] > x[i]) {\n-                MarlinUtils.logInfo(\"Bad sorted x [\" + (i - 1) + \"]\" + Arrays.toString(Arrays.copyOf(x, hi)));\n-                return;\n-            }\n-        }\n-    }\n","filename":"src\/java.desktop\/share\/classes\/sun\/java2d\/marlin\/MergeSort.java","additions":19,"deletions":64,"binary":false,"changes":83,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2007, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2007, 2018, Oracle and\/or its affiliates. All rights reserved.\n@@ -64,1 +64,1 @@\n-        CleanerFactory.cleaner().register(parent, this::free);\n+        CleanerFactory.cleaner().register(parent, () -> this.free());\n","filename":"src\/java.desktop\/share\/classes\/sun\/java2d\/marlin\/OffHeapArray.java","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2017, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2017, 2021, Oracle and\/or its affiliates. All rights reserved.\n@@ -31,1 +31,1 @@\n-    \/\/ squared tolerance in pixels\n+\n@@ -36,1 +36,0 @@\n-    \/\/ current reference point\n@@ -38,4 +37,0 @@\n-    \/\/ flag indicating if the given point was skipped\n-    private boolean skipped;\n-    \/\/ last skipped point\n-    private double sx, sy;\n@@ -48,1 +43,0 @@\n-        skipped = false;\n@@ -52,6 +46,0 @@\n-    private void finishPath() {\n-        if (skipped) {\n-            _lineTo(sx, sy);\n-        }\n-    }\n-\n@@ -60,1 +48,0 @@\n-        finishPath();\n@@ -66,1 +53,0 @@\n-        finishPath();\n@@ -71,27 +57,2 @@\n-    public void moveTo(final double xe, final double ye) {\n-        finishPath();\n-        delegate.moveTo(xe, ye);\n-        cx = xe;\n-        cy = ye;\n-    }\n-\n-    @Override\n-    public void lineTo(final double xe, final double ye) {\n-        \/\/ Test if segment is too small:\n-        double dx = (xe - cx);\n-        double dy = (ye - cy);\n-\n-        if ((dx * dx + dy * dy) <= SQUARE_TOLERANCE) {\n-            skipped = true;\n-            sx = xe;\n-            sy = ye;\n-            return;\n-        }\n-        _lineTo(xe, ye);\n-    }\n-\n-    private void _lineTo(final double xe, final double ye) {\n-        delegate.lineTo(xe, ye);\n-        cx = xe;\n-        cy = ye;\n-        skipped = false;\n+    public long getNativeConsumer() {\n+        return 0;\n@@ -114,3 +75,0 @@\n-                skipped = true;\n-                sx = xe;\n-                sy = ye;\n@@ -121,0 +79,1 @@\n+        \/\/ final end point:\n@@ -123,1 +82,0 @@\n-        skipped = false;\n@@ -146,3 +104,0 @@\n-                    skipped = true;\n-                    sx = xe;\n-                    sy = ye;\n@@ -154,0 +109,1 @@\n+        \/\/ final end point:\n@@ -156,1 +112,0 @@\n-        skipped = false;\n@@ -160,2 +115,20 @@\n-    public long getNativeConsumer() {\n-        return 0;\n+    public void moveTo(final double xe, final double ye) {\n+        delegate.moveTo(xe, ye);\n+        \/\/ starting point:\n+        cx = xe;\n+        cy = ye;\n+    }\n+\n+    @Override\n+    public void lineTo(final double xe, final double ye) {\n+        \/\/ Test if segment is too small:\n+        double dx = (xe - cx);\n+        double dy = (ye - cy);\n+\n+        if ((dx * dx + dy * dy) <= SQUARE_TOLERANCE) {\n+            return;\n+        }\n+        delegate.lineTo(xe, ye);\n+        \/\/ final end point:\n+        cx = xe;\n+        cy = ye;\n","filename":"src\/java.desktop\/share\/classes\/sun\/java2d\/marlin\/PathSimplifier.java","additions":26,"deletions":53,"binary":false,"changes":79,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2007, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2007, 2021, Oracle and\/or its affiliates. All rights reserved.\n@@ -33,1 +33,1 @@\n-    static final boolean DISABLE_RENDER = MarlinProperties.isSkipRenderer();\n+    static final boolean DISABLE_RENDER = false;\n@@ -147,1 +147,1 @@\n-    private final ArrayCacheInt.Reference crossings_ref;\n+    private final IntArrayCache.Reference crossings_ref;\n@@ -149,1 +149,1 @@\n-    private final ArrayCacheInt.Reference edgePtrs_ref;\n+    private final IntArrayCache.Reference edgePtrs_ref;\n@@ -152,1 +152,1 @@\n-    private final ArrayCacheInt.Reference aux_crossings_ref;\n+    private final IntArrayCache.Reference aux_crossings_ref;\n@@ -154,1 +154,1 @@\n-    private final ArrayCacheInt.Reference aux_edgePtrs_ref;\n+    private final IntArrayCache.Reference aux_edgePtrs_ref;\n@@ -174,1 +174,1 @@\n-    private final ArrayCacheIntClean.Reference edgeBuckets_ref;\n+    private final IntArrayCache.Reference edgeBuckets_ref;\n@@ -176,1 +176,1 @@\n-    private final ArrayCacheIntClean.Reference edgeBucketCounts_ref;\n+    private final IntArrayCache.Reference edgeBucketCounts_ref;\n@@ -395,1 +395,1 @@\n-        \/\/ use substraction to avoid integer overflow:\n+        \/\/ use subtraction to avoid integer overflow:\n@@ -514,1 +514,1 @@\n-    private final ArrayCacheIntClean.Reference alphaLine_ref;\n+    private final IntArrayCache.Reference alphaLine_ref;\n@@ -523,1 +523,1 @@\n-    private final ArrayCacheIntClean.Reference blkFlags_ref;\n+    private final IntArrayCache.Reference blkFlags_ref;\n@@ -616,6 +616,2 @@\n-        if (crossings_ref.doCleanRef(crossings)) {\n-            crossings = crossings_ref.putArray(crossings);\n-        }\n-        if (aux_crossings_ref.doCleanRef(aux_crossings)) {\n-            aux_crossings = aux_crossings_ref.putArray(aux_crossings);\n-        }\n+        crossings = crossings_ref.putArray(crossings);\n+        aux_crossings = aux_crossings_ref.putArray(aux_crossings);\n@@ -623,6 +619,2 @@\n-        if (edgePtrs_ref.doCleanRef(edgePtrs)) {\n-            edgePtrs = edgePtrs_ref.putArray(edgePtrs);\n-        }\n-        if (aux_edgePtrs_ref.doCleanRef(aux_edgePtrs)) {\n-            aux_edgePtrs = aux_edgePtrs_ref.putArray(aux_edgePtrs);\n-        }\n+        edgePtrs = edgePtrs_ref.putArray(edgePtrs);\n+        aux_edgePtrs = aux_edgePtrs_ref.putArray(aux_edgePtrs);\n@@ -630,6 +622,2 @@\n-        if (alphaLine_ref.doSetRef(alphaLine)) {\n-            alphaLine = alphaLine_ref.putArrayClean(alphaLine); \/\/ already zero filled\n-        }\n-        if (blkFlags_ref.doSetRef(blkFlags)) {\n-            blkFlags  = blkFlags_ref.putArrayClean(blkFlags); \/\/ already zero filled\n-        }\n+        alphaLine = alphaLine_ref.putArray(alphaLine, 0, 0); \/\/ already zero filled\n+        blkFlags  = blkFlags_ref.putArray(blkFlags, 0, 0); \/\/ already zero filled\n@@ -653,6 +641,2 @@\n-            if (edgeBuckets_ref.doSetRef(edgeBuckets)) {\n-                edgeBuckets = edgeBuckets_ref.putArrayClean(edgeBuckets);\n-            }\n-            if (edgeBucketCounts_ref.doSetRef(edgeBucketCounts)) {\n-                edgeBucketCounts = edgeBucketCounts_ref.putArrayClean(edgeBucketCounts);\n-            }\n+            edgeBuckets = edgeBuckets_ref.putArray(edgeBuckets, 0, 0);\n+            edgeBucketCounts = edgeBucketCounts_ref.putArray(edgeBucketCounts, 0, 0);\n@@ -738,1 +722,1 @@\n-        if ((x0 != sx0) || (y0 != sy0)) {\n+        if (x0 != sx0 || y0 != sy0) {\n@@ -846,2 +830,0 @@\n-        final DPQSSorterContext sorter = rdrCtx.sorterCtx;\n-        boolean skipISort, useDPQS;\n@@ -860,1 +842,1 @@\n-                    rdrCtx.stats.stat_rdr_activeEdges_updates.add(prevNumCrossings);\n+                    rdrCtx.stats.stat_rdr_activeEdges_updates.add(numCrossings);\n@@ -869,1 +851,1 @@\n-                    for (i = 0, newCount = 0; i < prevNumCrossings; i++) {\n+                    for (i = 0, newCount = 0; i < numCrossings; i++) {\n@@ -897,1 +879,1 @@\n-                            = edgePtrs_ref.widenArray(_edgePtrs, edgePtrsLen,\n+                            = edgePtrs_ref.widenArray(_edgePtrs, numCrossings,\n@@ -966,1 +948,1 @@\n-                if (((numCrossings <= 40) || ((ptrLen <= 10) && (numCrossings <= MergeSort.DISABLE_ISORT_THRESHOLD)))) {\n+                if ((ptrLen < 10) || (numCrossings < 40)) {\n@@ -1052,1 +1034,1 @@\n-                                _edgePtrs[i]  = _edgePtrs[j];\n+                                _edgePtrs[i] = _edgePtrs[j];\n@@ -1079,7 +1061,0 @@\n-                    skipISort = (prevNumCrossings >= MergeSort.DISABLE_ISORT_THRESHOLD);\n-                    useDPQS   = MergeSort.USE_DPQS && (skipISort || (ptrLen >= MergeSort.DPQS_THRESHOLD));\n-\n-                    if (DO_STATS && useDPQS) {\n-                        rdrCtx.stats.stat_rdr_crossings_dpqs.add((skipISort) ? numCrossings : ptrLen);\n-                    }\n-\n@@ -1122,21 +1097,8 @@\n-                        if (skipISort) {\n-                            if (useDPQS) {\n-                                \/\/ simply store crossing as edgePtrs is in-place:\n-                                \/\/ will be sorted efficiently by DPQS later:\n-                                _crossings[i]     = cross;\n-                            } else {\n-                                \/\/ store crossing\/edgePtrs in auxiliary arrays:\n-                                \/\/ will be sorted efficiently by MergeSort later:\n-                                _aux_crossings[i] = cross;\n-                                _aux_edgePtrs [i] = ecur;\n-                            }\n-                        } else if (i >= prevNumCrossings) {\n-                            if (useDPQS) {\n-                                \/\/ store crossing\/edgePtrs in auxiliary arrays:\n-                                \/\/ will be sorted efficiently by DPQS later:\n-                                _aux_crossings[i] = cross;\n-                                _aux_edgePtrs [i] = ecur;\n-                            } else {\n-                                \/\/ simply store crossing as edgePtrs is in-place:\n-                                \/\/ will be sorted efficiently by MergeSort later:\n-                                _crossings[i]      = cross;\n+                        if (i >= prevNumCrossings) {\n+                            \/\/ simply store crossing as edgePtrs is in-place:\n+                            \/\/ will be copied and sorted efficiently by mergesort later:\n+                            _crossings[i]     = cross;\n+\n+                        } else if (cross < lastCross) {\n+                            if (DO_STATS) {\n+                                rdrCtx.stats.stat_rdr_crossings_sorts.add(i);\n@@ -1144,9 +1106,0 @@\n-                        } else {\n-                            if (cross < lastCross) {\n-                                if (DO_STATS) {\n-                                    rdrCtx.stats.stat_rdr_crossings_sorts.add(i);\n-                                }\n-                                \/\/ (straight) insertion sort of crossings:\n-                                j = i - 1;\n-                                _aux_crossings[i] = _aux_crossings[j];\n-                                _aux_edgePtrs [i]  = _aux_edgePtrs[j];\n@@ -1154,10 +1107,8 @@\n-                                while ((--j >= 0) && (_aux_crossings[j] > cross)) {\n-                                    _aux_crossings[j + 1] = _aux_crossings[j];\n-                                    _aux_edgePtrs [j + 1] = _aux_edgePtrs[j];\n-                                }\n-                                _aux_crossings[j + 1] = cross;\n-                                _aux_edgePtrs [j + 1] = ecur;\n-                            } else {\n-                                \/\/ auxiliary storage:\n-                                _aux_crossings[i] = lastCross = cross;\n-                                _aux_edgePtrs [i] = ecur;\n+                            \/\/ (straight) insertion sort of crossings:\n+                            j = i - 1;\n+                            _aux_crossings[i] = _aux_crossings[j];\n+                            _aux_edgePtrs[i] = _aux_edgePtrs[j];\n+\n+                            while ((--j >= 0) && (_aux_crossings[j] > cross)) {\n+                                _aux_crossings[j + 1] = _aux_crossings[j];\n+                                _aux_edgePtrs [j + 1] = _aux_edgePtrs[j];\n@@ -1165,0 +1116,7 @@\n+                            _aux_crossings[j + 1] = cross;\n+                            _aux_edgePtrs [j + 1] = ecur;\n+\n+                        } else {\n+                            \/\/ auxiliary storage:\n+                            _aux_crossings[i] = lastCross = cross;\n+                            _aux_edgePtrs [i] = ecur;\n@@ -1171,3 +1129,1 @@\n-                                              numCrossings, prevNumCrossings,\n-                                              skipISort, sorter, useDPQS\n-                                            );\n+                                              numCrossings,   prevNumCrossings);\n","filename":"src\/java.desktop\/share\/classes\/sun\/java2d\/marlin\/Renderer.java","additions":49,"deletions":93,"binary":false,"changes":142,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2015, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2015, 2021, Oracle and\/or its affiliates. All rights reserved.\n@@ -91,5 +91,0 @@\n-    \/\/ bit flags indicating to skip the stroker to process joins\n-    \/\/ bits: 2 : Dasher CurveClipSplitter\n-    \/\/ bits: 1 : Dasher CurveBasicMonotonizer\n-    \/\/ bits: 0 : Stroker CurveClipSplitter\n-    int firstFlags = 0;\n@@ -98,2 +93,0 @@\n-    \/\/ DPQS Sorter context\n-    final DPQSSorterContext sorterCtx;\n@@ -103,1 +96,1 @@\n-    private final ArrayCacheIntClean cleanIntCache = new ArrayCacheIntClean(5);\n+    private final IntArrayCache cleanIntCache = new IntArrayCache(true, 5);\n@@ -105,1 +98,1 @@\n-    private final ArrayCacheInt dirtyIntCache = new ArrayCacheInt(5);\n+    private final IntArrayCache dirtyIntCache = new IntArrayCache(false, 5);\n@@ -107,1 +100,1 @@\n-    private final ArrayCacheDouble dirtyDoubleCache = new ArrayCacheDouble(4);\n+    private final DoubleArrayCache dirtyDoubleCache = new DoubleArrayCache(false, 4);\n@@ -109,1 +102,1 @@\n-    private final ArrayCacheByte dirtyByteCache = new ArrayCacheByte(2);\n+    private final ByteArrayCache dirtyByteCache = new ByteArrayCache(false, 2);\n@@ -156,2 +149,0 @@\n-\n-        sorterCtx = (MergeSort.USE_DPQS) ? new DPQSSorterContext() : null;\n@@ -175,1 +166,0 @@\n-        firstFlags = 0;\n@@ -204,1 +194,1 @@\n-            refPath2D = new WeakReference<>(p2d);\n+            refPath2D = new WeakReference<Path2D.Double>(p2d);\n@@ -222,1 +212,1 @@\n-    ArrayCacheIntClean.Reference newCleanIntArrayRef(final int initialSize) {\n+    IntArrayCache.Reference newCleanIntArrayRef(final int initialSize) {\n@@ -226,1 +216,1 @@\n-    ArrayCacheInt.Reference newDirtyIntArrayRef(final int initialSize) {\n+    IntArrayCache.Reference newDirtyIntArrayRef(final int initialSize) {\n@@ -230,1 +220,1 @@\n-    ArrayCacheDouble.Reference newDirtyDoubleArrayRef(final int initialSize) {\n+    DoubleArrayCache.Reference newDirtyDoubleArrayRef(final int initialSize) {\n@@ -234,1 +224,1 @@\n-    ArrayCacheByte.Reference newDirtyByteArrayRef(final int initialSize) {\n+    ByteArrayCache.Reference newDirtyByteArrayRef(final int initialSize) {\n","filename":"src\/java.desktop\/share\/classes\/sun\/java2d\/marlin\/RendererContext.java","additions":10,"deletions":20,"binary":false,"changes":30,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2015, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2015, 2021, Oracle and\/or its affiliates. All rights reserved.\n@@ -104,2 +104,0 @@\n-    final StatLong stat_rdr_crossings_dpqs\n-        = new StatLong(\"renderer.crossings.dpqs\");\n@@ -201,1 +199,0 @@\n-        stat_rdr_crossings_dpqs,\n@@ -358,1 +355,1 @@\n-            = new ConcurrentLinkedQueue<>();\n+            = new ConcurrentLinkedQueue<RendererStats>();\n","filename":"src\/java.desktop\/share\/classes\/sun\/java2d\/marlin\/RendererStats.java","additions":2,"deletions":5,"binary":false,"changes":7,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2007, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2007, 2021, Oracle and\/or its affiliates. All rights reserved.\n@@ -32,1 +32,0 @@\n-import sun.java2d.marlin.TransformingPathConsumer2D.StartFlagPathConsumer2D;\n@@ -37,1 +36,1 @@\n-final class Stroker implements StartFlagPathConsumer2D, MarlinConst {\n+final class Stroker implements DPathConsumer2D, MarlinConst {\n@@ -43,6 +42,3 @@\n-    \/\/ join threshold = 1 subpixel (1\/8th pixel):\n-    private static final double JOIN_ERROR = MarlinProperties.getStrokerJoinError();\n-\n-    private static final double ROUND_JOIN_ERROR = 8.0 * JOIN_ERROR; \/\/ (8 h)\n-\n-    private static final int JOIN_STYLE = MarlinProperties.getStrokerJoinStyle();\n+    \/\/ round join threshold = 1 subpixel\n+    private static final double ERR_JOIN = (1.0f \/ MIN_SUBPIXELS);\n+    private static final double ROUND_JOIN_THRESHOLD = ERR_JOIN * ERR_JOIN;\n@@ -56,1 +52,0 @@\n-    \/\/ members:\n@@ -70,1 +65,0 @@\n-    private double joinLimitMinSq;\n@@ -165,20 +159,1 @@\n-        this.joinStyle = (JOIN_STYLE != -1) ? JOIN_STYLE : joinStyle;\n-\n-        double miterScaledLimit = 0.0;\n-\n-        if (joinStyle == JOIN_MITER) {\n-            miterScaledLimit = miterLimit * lineWidth2;\n-            this.miterLimitSq = miterScaledLimit * miterScaledLimit;\n-\n-            final double limitMin = ((this.rdrCtx.clipInvScale == 0.0d) ? JOIN_ERROR\n-                    : (JOIN_ERROR * this.rdrCtx.clipInvScale))\n-                    + lineWidth2;\n-\n-            this.joinLimitMinSq = limitMin * limitMin;\n-\n-        } else if (joinStyle == JOIN_ROUND) {\n-            \/\/ chord:  s = 2 r * sin( phi \/ 2)\n-            \/\/ height: h = 2 r * sin( phi \/ 4)^2\n-            \/\/ small angles (phi < 90):\n-            \/\/ h = s^2 \/ (8 r)\n-            \/\/ so s^2 = (8 h * r)\n+        this.joinStyle = joinStyle;\n@@ -186,3 +161,2 @@\n-            \/\/ height max (note ROUND_JOIN_ERROR = 8 * JOIN_ERROR)\n-            final double limitMin = ((this.rdrCtx.clipInvScale == 0.0d) ? ROUND_JOIN_ERROR\n-                    : (ROUND_JOIN_ERROR * this.rdrCtx.clipInvScale));\n+        final double limit = miterLimit * lineWidth2;\n+        this.miterLimitSq = limit * limit;\n@@ -190,3 +164,0 @@\n-            \/\/ chord limit (s^2):\n-            this.joinLimitMinSq = limitMin * this.lineWidth2;\n-        }\n@@ -204,2 +175,2 @@\n-            if ((joinStyle == JOIN_MITER) && (margin < miterScaledLimit)) {\n-                margin = miterScaledLimit;\n+            if ((joinStyle == JOIN_MITER) && (margin < limit)) {\n+                margin = limit;\n@@ -301,0 +272,1 @@\n+\n@@ -303,1 +275,1 @@\n-        final double lenSq = domx * domx + domy * domy;\n+        final double lenSq = domx*domx + domy*domy;\n@@ -305,1 +277,1 @@\n-        if (lenSq < joinLimitMinSq) {\n+        if (lenSq < ROUND_JOIN_THRESHOLD) {\n@@ -308,0 +280,1 @@\n+\n@@ -329,1 +302,1 @@\n-        if (cosext >= 0.0) {\n+        if (cosext >= 0.0d) {\n@@ -346,4 +319,3 @@\n-            final double nx = my - omy;\n-            final double ny = omx - mx;\n-            final double nlen = Math.sqrt(nx * nx + ny * ny);\n-            final double scale = lineWidth2 \/ nlen;\n+            double nx = my - omy, ny = omx - mx;\n+            double nlen = Math.sqrt(nx*nx + ny*ny);\n+            double scale = lineWidth2\/nlen;\n@@ -503,1 +475,1 @@\n-        final double lenSq = (miterX - x0) * (miterX - x0) + (miterY - y0) * (miterY - y0);\n+        double lenSq = (miterX-x0)*(miterX-x0) + (miterY-y0)*(miterY-y0);\n@@ -510,1 +482,1 @@\n-        if ((lenSq < miterLimitSq) && (lenSq >= joinLimitMinSq)) {\n+        if (lenSq < miterLimitSq) {\n@@ -551,1 +523,0 @@\n-    \/* Callback from CurveClipSplitter *\/\n@@ -553,7 +524,2 @@\n-    public void setStartFlag(boolean first) {\n-        if (first) {\n-            \/\/ reset flag:\n-            rdrCtx.firstFlags &= 0b110;\n-        } else {\n-            rdrCtx.firstFlags |= 0b001;\n-        }\n+    public void lineTo(final double x1, final double y1) {\n+        lineTo(x1, y1, false);\n@@ -562,2 +528,3 @@\n-    @Override\n-    public void lineTo(final double x1, final double y1) {\n+    private void lineTo(final double x1, final double y1,\n+                        final boolean force)\n+    {\n@@ -566,1 +533,1 @@\n-        if (clipRect != null) {\n+        if (!force && clipRect != null) {\n@@ -597,0 +564,1 @@\n+\n@@ -655,3 +623,2 @@\n-            if ((cx0 != sx0) || (cy0 != sy0)) {\n-                \/\/ may subdivide line:\n-                lineTo(sx0, sy0);\n+            if (cx0 != sx0 || cy0 != sy0) {\n+                lineTo(sx0, sy0, true);\n@@ -660,3 +627,1 @@\n-            \/\/ ignore starting point outside:\n-            if (sOutCode == 0) {\n-                drawJoin(cdx, cdy, cx0, cy0, sdx, sdy, cmx, cmy, smx, smy, sOutCode);\n+            drawJoin(cdx, cdy, cx0, cy0, sdx, sdy, cmx, cmy, smx, smy, sOutCode);\n@@ -664,1 +629,1 @@\n-                emitLineTo(sx0 + smx, sy0 + smy);\n+            emitLineTo(sx0 + smx, sy0 + smy);\n@@ -666,5 +631,4 @@\n-                if (opened) {\n-                    emitLineTo(sx0 - smx, sy0 - smy);\n-                } else {\n-                    emitMoveTo(sx0 - smx, sy0 - smy);\n-                }\n+            if (opened) {\n+                emitLineTo(sx0 - smx, sy0 - smy);\n+            } else {\n+                emitMoveTo(sx0 - smx, sy0 - smy);\n@@ -817,1 +781,0 @@\n-            prev = DRAWING_OP_TO;\n@@ -825,2 +788,1 @@\n-        } else if (rdrCtx.firstFlags == 0) {\n-            \/\/ Precision on isCW is causing instabilities with Dasher !\n+        } else {\n@@ -837,0 +799,12 @@\n+        prev = DRAWING_OP_TO;\n+    }\n+\n+    private static boolean within(final double x1, final double y1,\n+                                  final double x2, final double y2,\n+                                  final double err)\n+    {\n+        assert err > 0 : \"\";\n+        \/\/ compare taxicab distance. ERR will always be small, so using\n+        \/\/ true distance won't give much benefit\n+        return (Helpers.within(x1, x2, err) && \/\/ we want to avoid calling Math.abs\n+                Helpers.within(y1, y2, err));  \/\/ this is just as good.\n@@ -839,3 +813,3 @@\n-    private int getLineOffsets(final double x1, final double y1,\n-                               final double x2, final double y2,\n-                               final double[] left, final double[] right)\n+    private void getLineOffsets(final double x1, final double y1,\n+                                final double x2, final double y2,\n+                                final double[] left, final double[] right)\n@@ -855,2 +829,0 @@\n-\n-        return 4;\n@@ -870,4 +842,4 @@\n-        final double x1 = pts[off    ]; final double y1 = pts[off + 1];\n-        final double x2 = pts[off + 2]; final double y2 = pts[off + 3];\n-        final double x3 = pts[off + 4]; final double y3 = pts[off + 5];\n-        final double x4 = pts[off + 6]; final double y4 = pts[off + 7];\n+        final double x1 = pts[off    ], y1 = pts[off + 1];\n+        final double x2 = pts[off + 2], y2 = pts[off + 3];\n+        final double x3 = pts[off + 4], y3 = pts[off + 5];\n+        final double x4 = pts[off + 6], y4 = pts[off + 7];\n@@ -875,2 +847,4 @@\n-        double dx1 = x2 - x1; double dy1 = y2 - y1;\n-        double dx4 = x4 - x3; double dy4 = y4 - y3;\n+        double dx4 = x4 - x3;\n+        double dy4 = y4 - y3;\n+        double dx1 = x2 - x1;\n+        double dy1 = y2 - y1;\n@@ -880,2 +854,2 @@\n-        final boolean p1eqp2 = Helpers.withinD(dx1, dy1, 6.0d * Math.ulp(y2));\n-        final boolean p3eqp4 = Helpers.withinD(dx4, dy4, 6.0d * Math.ulp(y4));\n+        final boolean p1eqp2 = within(x1, y1, x2, y2, 6.0d * Math.ulp(y2));\n+        final boolean p3eqp4 = within(x3, y3, x4, y4, 6.0d * Math.ulp(y4));\n@@ -884,1 +858,2 @@\n-            return getLineOffsets(x1, y1, x4, y4, leftOff, rightOff);\n+            getLineOffsets(x1, y1, x4, y4, leftOff, rightOff);\n+            return 4;\n@@ -896,2 +871,1 @@\n-        final double l1sq = dx1 * dx1 + dy1 * dy1;\n-        final double l4sq = dx4 * dx4 + dy4 * dy4;\n+        double l1sq = dx1 * dx1 + dy1 * dy1, l4sq = dx4 * dx4 + dy4 * dy4;\n@@ -900,1 +874,2 @@\n-            return getLineOffsets(x1, y1, x4, y4, leftOff, rightOff);\n+            getLineOffsets(x1, y1, x4, y4, leftOff, rightOff);\n+            return 4;\n@@ -950,2 +925,2 @@\n-        final double xm = (x1 + x4 + 3.0d * (x2 + x3)) \/ 8.0d;\n-        final double ym = (y1 + y4 + 3.0d * (y2 + y3)) \/ 8.0d;\n+        double x = (x1 + 3.0d * (x2 + x3) + x4) \/ 8.0d;\n+        double y = (y1 + 3.0d * (y2 + y3) + y4) \/ 8.0d;\n@@ -954,2 +929,1 @@\n-        final double dxm = x3 + x4 - (x1 + x2);\n-        final double dym = y3 + y4 - (y1 + y2);\n+        double dxm = x3 + x4 - x1 - x2, dym = y3 + y4 - y1 - y2;\n@@ -963,2 +937,0 @@\n-\n-        \/\/ left side:\n@@ -967,2 +939,2 @@\n-        double xi  = xm + offset1[0]; \/\/ interpolation\n-        double yi  = ym + offset1[1]; \/\/ point\n+        double xi  = x  + offset1[0]; \/\/ interpolation\n+        double yi  = y  + offset1[1]; \/\/ point\n@@ -972,4 +944,1 @@\n-        final double invdet43 = 4.0d \/ (3.0d * (dx1 * dy4 - dy1 * dx4));\n-\n-        double two_pi_m_p1_m_p4x = 2.0d * xi - (x1p + x4p);\n-        double two_pi_m_p1_m_p4y = 2.0d * yi - (y1p + y4p);\n+        double invdet43 = 4.0d \/ (3.0d * (dx1 * dy4 - dy1 * dx4));\n@@ -977,0 +946,2 @@\n+        double two_pi_m_p1_m_p4x = 2.0d * xi - x1p - x4p;\n+        double two_pi_m_p1_m_p4y = 2.0d * yi - y1p - y4p;\n@@ -981,20 +952,4 @@\n-\n-        if (c1 * c2 > 0.0) {\n-\/\/            System.out.println(\"Buggy solver (left): c1 = \" + c1 + \" c2 = \" + c2);\n-\n-            \/\/ use lower quality approximation but good enough\n-            \/\/ to ensure cuve being in its convex hull\n-            x2p = x2 + offset1[0]; \/\/ 2nd\n-            y2p = y2 + offset1[1]; \/\/ point\n-            x3p = x3 + offset1[0]; \/\/ 3nd\n-            y3p = y3 + offset1[1]; \/\/ point\n-\n-            safeComputeMiter(x1p, y1p, x1p+dx1, y1p+dy1, x2p, y2p, x2p-dxm, y2p-dym, leftOff);\n-            x2p = leftOff[2]; y2p = leftOff[3];\n-\n-            safeComputeMiter(x4p, y4p, x4p+dx4, y4p+dy4, x3p, y3p, x3p-dxm, y3p-dym, leftOff);\n-            x3p = leftOff[2]; y3p = leftOff[3];\n-        } else {\n-            x2p = x1p + c1 * dx1; y2p = y1p + c1 * dy1;\n-            x3p = x4p + c2 * dx4; y3p = y4p + c2 * dy4;\n-        }\n+        x2p = x1p + c1*dx1;\n+        y2p = y1p + c1*dy1;\n+        x3p = x4p + c2*dx4;\n+        y3p = y4p + c2*dy4;\n@@ -1007,10 +962,3 @@\n-        \/\/ Right side:\n-        x1p = x1 - offset0[0]; \/\/ start\n-        y1p = y1 - offset0[1]; \/\/ point\n-        xi =  xm  - offset1[0]; \/\/ interpolation\n-        yi =  ym  - offset1[1]; \/\/ point\n-        x4p = x4 - offset2[0]; \/\/ end\n-        y4p = y4 - offset2[1]; \/\/ point\n-\n-        two_pi_m_p1_m_p4x = 2.0d * xi - (x1p + x4p);\n-        two_pi_m_p1_m_p4y = 2.0d * yi - (y1p + y4p);\n+        x1p = x1 - offset0[0]; y1p = y1 - offset0[1];\n+        xi = xi - 2.0d * offset1[0]; yi = yi - 2.0d * offset1[1];\n+        x4p = x4 - offset2[0]; y4p = y4 - offset2[1];\n@@ -1018,0 +966,2 @@\n+        two_pi_m_p1_m_p4x = 2.0d * xi - x1p - x4p;\n+        two_pi_m_p1_m_p4y = 2.0d * yi - y1p - y4p;\n@@ -1021,19 +971,4 @@\n-        if (c1 * c2 > 0.0) {\n-\/\/            System.out.println(\"Buggy solver (right): c1 = \" + c1 + \" c2 = \" + c2);\n-\n-            \/\/ use lower quality approximation but good enough\n-            \/\/ to ensure cuve being in its convex hull\n-            x2p = x2 - offset1[0]; \/\/ 2nd\n-            y2p = y2 - offset1[1]; \/\/ point\n-            x3p = x3 - offset1[0]; \/\/ 3nd\n-            y3p = y3 - offset1[1]; \/\/ point\n-\n-            safeComputeMiter(x1p, y1p, x1p+dx1, y1p+dy1, x2p, y2p, x2p-dxm, y2p-dym, rightOff);\n-            x2p = rightOff[2]; y2p = rightOff[3];\n-\n-            safeComputeMiter(x4p, y4p, x4p+dx4, y4p+dy4, x3p, y3p, x3p-dxm, y3p-dym, rightOff);\n-            x3p = rightOff[2]; y3p = rightOff[3];\n-        } else {\n-            x2p = x1p + c1 * dx1; y2p = y1p + c1 * dy1;\n-            x3p = x4p + c2 * dx4; y3p = y4p + c2 * dy4;\n-        }\n+        x2p = x1p + c1*dx1;\n+        y2p = y1p + c1*dy1;\n+        x3p = x4p + c2*dx4;\n+        y3p = y4p + c2*dy4;\n@@ -1045,1 +980,0 @@\n-\n@@ -1056,3 +990,3 @@\n-        final double x1 = pts[off    ]; final double y1 = pts[off + 1];\n-        final double x2 = pts[off + 2]; final double y2 = pts[off + 3];\n-        final double x3 = pts[off + 4]; final double y3 = pts[off + 5];\n+        final double x1 = pts[off    ], y1 = pts[off + 1];\n+        final double x2 = pts[off + 2], y2 = pts[off + 3];\n+        final double x3 = pts[off + 4], y3 = pts[off + 5];\n@@ -1060,2 +994,4 @@\n-        final double dx12 = x2 - x1; final double dy12 = y2 - y1;\n-        final double dx23 = x3 - x2; final double dy23 = y3 - y2;\n+        final double dx3 = x3 - x2;\n+        final double dy3 = y3 - y2;\n+        final double dx1 = x2 - x1;\n+        final double dy1 = y2 - y1;\n@@ -1063,1 +999,1 @@\n-        \/\/ if p1=p2 or p2=p3 it means that the derivative at the endpoint\n+        \/\/ if p1=p2 or p3=p4 it means that the derivative at the endpoint\n@@ -1071,3 +1007,4 @@\n-        \/\/ if p1 == p2 or p2 == p3: draw line from p1->p3\n-        final boolean p1eqp2 = Helpers.withinD(dx12, dy12, 6.0d * Math.ulp(y2));\n-        final boolean p2eqp3 = Helpers.withinD(dx23, dy23, 6.0d * Math.ulp(y3));\n+        \/\/ if p1 == p2 && p3 == p4: draw line from p1->p4, unless p1 == p4,\n+        \/\/ in which case ignore.\n+        final boolean p1eqp2 = within(x1, y1, x2, y2, 6.0d * Math.ulp(y2));\n+        final boolean p2eqp3 = within(x2, y2, x3, y3, 6.0d * Math.ulp(y3));\n@@ -1076,1 +1013,2 @@\n-            return getLineOffsets(x1, y1, x3, y3, leftOff, rightOff);\n+            getLineOffsets(x1, y1, x3, y3, leftOff, rightOff);\n+            return 4;\n@@ -1079,2 +1017,2 @@\n-        \/\/ if p2-p1 and p3-p2 are parallel, that must mean this curve is a line\n-        double dotsq = (dx12 * dx23 + dy12 * dy23);\n+        \/\/ if p2-p1 and p4-p3 are parallel, that must mean this curve is a line\n+        double dotsq = (dx1 * dx3 + dy1 * dy3);\n@@ -1082,2 +1020,1 @@\n-        final double l1sq = dx12 * dx12 + dy12 * dy12;\n-        final double l3sq = dx23 * dx23 + dy23 * dy23;\n+        double l1sq = dx1 * dx1 + dy1 * dy1, l3sq = dx3 * dx3 + dy3 * dy3;\n@@ -1086,1 +1023,2 @@\n-            return getLineOffsets(x1, y1, x3, y3, leftOff, rightOff);\n+            getLineOffsets(x1, y1, x3, y3, leftOff, rightOff);\n+            return 4;\n@@ -1090,1 +1028,1 @@\n-        \/\/ for any bezier curve the vectors p2-p1 and p3-p2 are parallel to\n+        \/\/ for any bezier curve the vectors p2-p1 and p4-p3 are parallel to\n@@ -1092,2 +1030,2 @@\n-        computeOffset(dx12, dy12, lineWidth2, offset0);\n-        computeOffset(dx23, dy23, lineWidth2, offset1);\n+        computeOffset(dx1, dy1, lineWidth2, offset0);\n+        computeOffset(dx3, dy3, lineWidth2, offset1);\n@@ -1099,2 +1037,1 @@\n-\n-        safeComputeMiter(x1p, y1p, x1p+dx12, y1p+dy12, x3p, y3p, x3p-dx23, y3p-dy23, leftOff);\n+        safeComputeMiter(x1p, y1p, x1p+dx1, y1p+dy1, x3p, y3p, x3p-dx3, y3p-dy3, leftOff);\n@@ -1104,6 +1041,3 @@\n-        x1p = x1 - offset0[0]; \/\/ start\n-        y1p = y1 - offset0[1]; \/\/ point\n-        x3p = x3 - offset1[0]; \/\/ end\n-        y3p = y3 - offset1[1]; \/\/ point\n-\n-        safeComputeMiter(x1p, y1p, x1p+dx12, y1p+dy12, x3p, y3p, x3p-dx23, y3p-dy23, rightOff);\n+        x1p = x1 - offset0[0]; y1p = y1 - offset0[1];\n+        x3p = x3 - offset1[0]; y3p = y3 - offset1[1];\n+        safeComputeMiter(x1p, y1p, x1p+dx1, y1p+dy1, x3p, y3p, x3p-dx3, y3p-dy3, rightOff);\n@@ -1112,1 +1046,0 @@\n-\n@@ -1157,0 +1090,1 @@\n+\n@@ -1303,0 +1237,1 @@\n+\n","filename":"src\/java.desktop\/share\/classes\/sun\/java2d\/marlin\/Stroker.java","additions":115,"deletions":180,"binary":false,"changes":295,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2007, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2007, 2021, Oracle and\/or its affiliates. All rights reserved.\n@@ -513,7 +513,1 @@\n-    static final class PathClipFilter implements StartFlagPathConsumer2D {\n-\n-        private static final boolean TRACE = false;\n-\n-        private static final int MOVE_TO = 0;\n-        private static final int DRAWING_OP_TO = 1; \/\/ ie. curve, line, or quad\n-        private static final int CLOSE = 2;\n+    static final class PathClipFilter implements DPathConsumer2D {\n@@ -523,2 +517,0 @@\n-        private int prev;\n-\n@@ -536,3 +528,0 @@\n-        \/\/ the outcode of the starting point\n-        private int sOutCode = 0;\n-\n@@ -547,1 +536,1 @@\n-        \/\/ The current point\n+        \/\/ The current point (TODO stupid repeated info)\n@@ -550,0 +539,3 @@\n+        \/\/ The current point OUTSIDE\n+        private double cox0, coy0;\n+\n@@ -575,1 +567,0 @@\n-            this.prev = CLOSE;\n@@ -589,6 +580,8 @@\n-            \/\/ criteria: inside or totally outside ?\n-            if (gOutCode == 0) {\n-                finish();\n-            } else {\n-                this.outside = false;\n-                stack.reset();\n+            if (outside) {\n+                \/\/ criteria: inside or totally outside ?\n+                if (gOutCode == 0) {\n+                    finish();\n+                } else {\n+                    this.outside = false;\n+                    stack.reset();\n+                }\n@@ -620,2 +613,1 @@\n-                stack.pullAll(corners, out, (prev == MOVE_TO));\n-                prev = DRAWING_OP_TO;\n+                stack.pullAll(corners, out);\n@@ -623,0 +615,3 @@\n+            out.lineTo(cox0, coy0);\n+            this.cx0 = cox0;\n+            this.cy0 = coy0;\n@@ -627,4 +622,1 @@\n-            if (TRACE) {\n-                MarlinUtils.logInfo(\"PathDone(\" + sx0 + \", \" + sy0 + \") prev: \" + prev);\n-            }\n-            _closePath();\n+            finishPath();\n@@ -632,1 +624,0 @@\n-            \/\/ note: renderer's pathDone() must handle missing moveTo() if outside\n@@ -635,4 +626,0 @@\n-            \/\/ this shouldn't matter since this object won't be used\n-            \/\/ after the call to this method.\n-            this.prev = CLOSE;\n-\n@@ -646,8 +633,1 @@\n-            if (TRACE) {\n-                MarlinUtils.logInfo(\"ClosePath(\" + sx0 + \", \" + sy0 + \") prev: \" + prev);\n-            }\n-            _closePath();\n-\n-            if (prev == DRAWING_OP_TO) {\n-                out.closePath();\n-            }\n+            finishPath();\n@@ -655,6 +635,1 @@\n-            \/\/ if outside, moveTo is needed\n-            if (sOutCode != 0) {\n-                this.prev = MOVE_TO;\n-            } else {\n-                this.prev = CLOSE;\n-            }\n+            out.closePath();\n@@ -663,1 +638,1 @@\n-            this.cOutCode = sOutCode;\n+            this.cOutCode = Helpers.outcode(sx0, sy0, clipRect);\n@@ -668,25 +643,0 @@\n-        private void _closePath() {\n-            \/\/ preserve outside flag for the lineTo call below\n-            final boolean prevOutside = outside;\n-            if (prevOutside) {\n-                finishPath();\n-            }\n-\n-            if (prev == DRAWING_OP_TO) {\n-                \/\/ Should clip\n-                final int orCode = (cOutCode | sOutCode);\n-                if (orCode != 0) {\n-                    if ((cx0 != sx0) || (cy0 != sy0)) {\n-                        \/\/ restore outside flag before lineTo:\n-                        this.outside = prevOutside;\n-                        \/\/ may subdivide line:\n-                        lineTo(sx0, sy0);\n-                        \/\/ finish if outside caused by lineTo:\n-                        if (outside) {\n-                            finishPath();\n-                        }\n-                    }\n-                }\n-            }\n-        }\n-\n@@ -695,4 +645,1 @@\n-            if (TRACE) {\n-                MarlinUtils.logInfo(\"MoveTo(\" + x0 + \", \" + y0 + \") prev: \" + prev);\n-            }\n-            _closePath();\n+            finishPath();\n@@ -700,1 +647,1 @@\n-            this.prev = MOVE_TO;\n+            out.moveTo(x0, y0);\n@@ -703,3 +650,1 @@\n-            final int outcode = Helpers.outcode(x0, y0, clipRect);\n-            this.cOutCode = outcode;\n-            this.sOutCode = outcode;\n+            this.cOutCode = Helpers.outcode(x0, y0, clipRect);\n@@ -708,0 +653,1 @@\n+\n@@ -712,6 +658,0 @@\n-        \/* Callback from CurveClipSplitter *\/\n-        @Override\n-        public void setStartFlag(boolean first) {\n-            \/\/ no-op\n-        }\n-\n@@ -723,8 +663,0 @@\n-            if (TRACE) {\n-                if (subdivide) {\n-                    MarlinUtils.logInfo(\"----------------------\");\n-                }\n-                MarlinUtils.logInfo(\"LineTo c  (\" + cx0 + \", \" + cy0 + \") outcode: \" + outcode0);\n-                MarlinUtils.logInfo(\"LineTo (\" + xe + \", \" + ye + \") outcode: \" + outcode1 + \" outside: \" + outside);\n-            }\n-\n@@ -744,2 +676,7 @@\n-                        ret = curveSplitter.splitLine(cx0, cy0, xe, ye,\n-                                                      orCode, this);\n+                        if (outside) {\n+                            ret = curveSplitter.splitLine(cox0, coy0, xe, ye,\n+                                                          orCode, this);\n+                        } else {\n+                            ret = curveSplitter.splitLine(cx0, cy0, xe, ye,\n+                                                          orCode, this);\n+                        }\n@@ -758,6 +695,2 @@\n-                    this.cx0 = xe;\n-                    this.cy0 = ye;\n-\n-                    if (TRACE) {\n-                        MarlinUtils.logInfo(\"skipped: (\" + cx0 + \", \" + cy0 + \")\");\n-                    }\n+                    this.cox0 = xe;\n+                    this.coy0 = ye;\n@@ -775,13 +708,0 @@\n-\n-                \/\/ emit last point outside before entering again...\n-                if (outcode0 != 0) {\n-                    if (TRACE) {\n-                        MarlinUtils.logInfo(\"add last point outside: (\" + cx0 + \", \" + cy0 + \")\");\n-                    }\n-                    if (prev == MOVE_TO) {\n-                        out.moveTo(cx0, cy0);\n-                    } else {\n-                        out.lineTo(cx0, cy0);\n-                    }\n-                    prev = DRAWING_OP_TO;\n-                }\n@@ -790,5 +710,0 @@\n-            if (prev == MOVE_TO) {\n-                out.moveTo(cx0, cy0);\n-            }\n-            prev = DRAWING_OP_TO;\n-\n@@ -798,4 +713,0 @@\n-\n-            if (TRACE && subdivide) {\n-                MarlinUtils.logInfo(\"----------------------\");\n-            }\n@@ -851,8 +762,0 @@\n-            if (TRACE) {\n-                if (subdivide) {\n-                    MarlinUtils.logInfo(\"----------------------\");\n-                }\n-                MarlinUtils.logInfo(\"CurveTo c  (\" + cx0 + \", \" + cy0 + \") outcode: \" + outcode0);\n-                MarlinUtils.logInfo(\"CurveTo (\" + xe + \", \" + ye + \") outcode: \" + outcode3 + \" outside: \" + outside);\n-            }\n-\n@@ -872,3 +775,9 @@\n-                        ret = curveSplitter.splitCurve(cx0, cy0, x1, y1,\n-                                                       x2, y2, xe, ye,\n-                                                       orCode, this);\n+                        if (outside) {\n+                            ret = curveSplitter.splitCurve(cox0, coy0, x1, y1,\n+                                                           x2, y2, xe, ye,\n+                                                           orCode, this);\n+                        } else {\n+                            ret = curveSplitter.splitCurve(cx0, cy0, x1, y1,\n+                                                           x2, y2, xe, ye,\n+                                                           orCode, this);\n+                        }\n@@ -887,6 +796,2 @@\n-                    this.cx0 = xe;\n-                    this.cy0 = ye;\n-\n-                    if (TRACE) {\n-                        MarlinUtils.logInfo(\"skipped: (\" + cx0 + \", \" + cy0 + \")\");\n-                    }\n+                    this.cox0 = xe;\n+                    this.coy0 = ye;\n@@ -904,13 +809,0 @@\n-\n-                \/\/ emit last point outside before entering again...\n-                if (outcode0 != 0) {\n-                    if (TRACE) {\n-                        MarlinUtils.logInfo(\"add last point outside: (\" + cx0 + \", \" + cy0 + \")\");\n-                    }\n-                    if (prev == MOVE_TO) {\n-                        out.moveTo(cx0, cy0);\n-                    } else {\n-                        out.lineTo(cx0, cy0);\n-                    }\n-                    prev = DRAWING_OP_TO;\n-                }\n@@ -919,5 +811,0 @@\n-            if (prev == MOVE_TO) {\n-                out.moveTo(cx0, cy0);\n-            }\n-            prev = DRAWING_OP_TO;\n-\n@@ -927,4 +814,0 @@\n-\n-            if (TRACE && subdivide) {\n-                MarlinUtils.logInfo(\"----------------------\");\n-            }\n@@ -941,8 +824,0 @@\n-            if (TRACE) {\n-                if (subdivide) {\n-                    MarlinUtils.logInfo(\"----------------------\");\n-                }\n-                MarlinUtils.logInfo(\"QuadTo c  (\" + cx0 + \", \" + cy0 + \") outcode: \" + outcode0);\n-                MarlinUtils.logInfo(\"QuadTo (\" + xe + \", \" + ye + \") outcode: \" + outcode1 + \" outside: \" + outside);\n-            }\n-\n@@ -962,2 +837,7 @@\n-                        ret = curveSplitter.splitQuad(cx0, cy0, x1, y1,\n-                                                      xe, ye, orCode, this);\n+                        if (outside) {\n+                            ret = curveSplitter.splitQuad(cox0, coy0, x1, y1,\n+                                                          xe, ye, orCode, this);\n+                        } else {\n+                            ret = curveSplitter.splitQuad(cx0, cy0, x1, y1,\n+                                                          xe, ye, orCode, this);\n+                        }\n@@ -976,2 +856,2 @@\n-                    this.cx0 = xe;\n-                    this.cy0 = ye;\n+                    this.cox0 = xe;\n+                    this.coy0 = ye;\n@@ -989,13 +869,0 @@\n-\n-                \/\/ emit last point outside before entering again...\n-                if (outcode0 != 0) {\n-                    if (TRACE) {\n-                        MarlinUtils.logInfo(\"add last point outside: (\" + cx0 + \", \" + cy0 + \")\");\n-                    }\n-                    if (prev == MOVE_TO) {\n-                        out.moveTo(cx0, cy0);\n-                    } else {\n-                        out.lineTo(cx0, cy0);\n-                    }\n-                    prev = DRAWING_OP_TO;\n-                }\n@@ -1004,5 +871,0 @@\n-            if (prev == MOVE_TO) {\n-                out.moveTo(cx0, cy0);\n-            }\n-            prev = DRAWING_OP_TO;\n-\n@@ -1012,4 +874,0 @@\n-\n-            if (TRACE && subdivide) {\n-                MarlinUtils.logInfo(\"----------------------\");\n-            }\n@@ -1024,5 +882,0 @@\n-    interface StartFlagPathConsumer2D extends DPathConsumer2D {\n-\n-        void setStartFlag(boolean first);\n-    }\n-\n@@ -1097,1 +950,0 @@\n-        \/\/ Use a specific interface to make recursion more obvious\n@@ -1101,1 +953,1 @@\n-                          final StartFlagPathConsumer2D out)\n+                          final DPathConsumer2D out)\n@@ -1122,1 +974,1 @@\n-                          final StartFlagPathConsumer2D out)\n+                          final DPathConsumer2D out)\n@@ -1145,1 +997,1 @@\n-                           final StartFlagPathConsumer2D out)\n+                           final DPathConsumer2D out)\n@@ -1165,1 +1017,1 @@\n-                                                 final StartFlagPathConsumer2D out)\n+                                                 final DPathConsumer2D out)\n@@ -1201,5 +1053,0 @@\n-\n-                if (i == 0) {\n-                    \/\/ disable start flag:\n-                    out.setStartFlag(false);\n-                }\n@@ -1207,2 +1054,0 @@\n-            \/\/ reset start flag:\n-            out.setStartFlag(true);\n@@ -1213,1 +1058,1 @@\n-                                final int off, final StartFlagPathConsumer2D out)\n+                                final int off, final DPathConsumer2D out)\n@@ -1221,1 +1066,1 @@\n-                out.lineTo( pts[off + 2], pts[off + 3]);\n+                out.lineTo(pts[off + 2], pts[off + 3]);\n@@ -1223,2 +1068,2 @@\n-                out.quadTo( pts[off + 2], pts[off + 3],\n-                            pts[off + 4], pts[off + 5]);\n+                out.quadTo(pts[off + 2], pts[off + 3],\n+                           pts[off + 4], pts[off + 5]);\n@@ -1236,1 +1081,1 @@\n-        \/\/ number of splitted curves\n+        \/\/ number of split curves\n","filename":"src\/java.desktop\/share\/classes\/sun\/java2d\/marlin\/TransformingPathConsumer2D.java","additions":64,"deletions":219,"binary":false,"changes":283,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2015, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2015, 2021, Oracle and\/or its affiliates. All rights reserved.\n@@ -30,1 +30,1 @@\n-    private static final String VERSION = \"marlin-0.9.4.6-Unsafe-OpenJDK\";\n+    private static final String VERSION = \"marlin-0.9.1.4-Unsafe-OpenJDK\";\n","filename":"src\/java.desktop\/share\/classes\/sun\/java2d\/marlin\/Version.java","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2015, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2015, 2018, Oracle and\/or its affiliates. All rights reserved.\n@@ -91,1 +91,1 @@\n-            if (stats[i].count != 0L) {\n+            if (stats[i].count != 0l) {\n","filename":"src\/java.desktop\/share\/classes\/sun\/java2d\/marlin\/stats\/Histogram.java","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2015, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2015, Oracle and\/or its affiliates. All rights reserved.\n@@ -47,1 +47,1 @@\n-        if (start != INVALID && elapsed > 0L) {\n+        if (start != INVALID && elapsed > 0l) {\n","filename":"src\/java.desktop\/share\/classes\/sun\/java2d\/marlin\/stats\/Monitor.java","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2015, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2015, 2016, Oracle and\/or its affiliates. All rights reserved.\n@@ -34,2 +34,2 @@\n-    public long count = 0L;\n-    public long sum = 0L;\n+    public long count = 0l;\n+    public long sum = 0l;\n@@ -44,2 +44,2 @@\n-        count = 0L;\n-        sum = 0L;\n+        count = 0l;\n+        sum = 0l;\n","filename":"src\/java.desktop\/share\/classes\/sun\/java2d\/marlin\/stats\/StatLong.java","additions":5,"deletions":5,"binary":false,"changes":10,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 1997, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 1997, 2016, Oracle and\/or its affiliates. All rights reserved.\n@@ -49,2 +49,0 @@\n-    private static final boolean DO_RENDER = !sun.java2d.marlin.MarlinProperties.isSkipRenderTiles();\n-\n@@ -53,2 +51,3 @@\n-            new ReentrantContextProviderTL<>(\n-                    ReentrantContextProvider.REF_HARD) {\n+            new ReentrantContextProviderTL<TileState>(\n+                    ReentrantContextProvider.REF_HARD)\n+            {\n@@ -164,5 +163,4 @@\n-            if (DO_RENDER) {\n-                context = outpipe.startSequence(sg, s,\n-                                                ts.computeDevBox(abox),\n-                                                abox);\n-            }\n+            context = outpipe.startSequence(sg, s,\n+                                            ts.computeDevBox(abox),\n+                                            abox);\n+\n@@ -190,3 +188,1 @@\n-                    if ((a == 0x00)\n-                            || (DO_RENDER && !outpipe.needTile(context, x, y, w, h)))\n-                    {\n+                    if (a == 0x00 || !outpipe.needTile(context, x, y, w, h)) {\n@@ -194,3 +190,1 @@\n-                        if (DO_RENDER) {\n-                            outpipe.skipTile(context, x, y);\n-                        }\n+                        outpipe.skipTile(context, x, y);\n@@ -206,3 +200,2 @@\n-                    if (DO_RENDER) {\n-                        outpipe.renderPathTile(context, atile, 0, tw, x, y, w, h);\n-                    }\n+\n+                    outpipe.renderPathTile(context, atile, 0, tw, x, y, w, h);\n","filename":"src\/java.desktop\/share\/classes\/sun\/java2d\/pipe\/AAShapePipe.java","additions":12,"deletions":19,"binary":false,"changes":31,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2009, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2009, 2017, Oracle and\/or its affiliates. All rights reserved.\n@@ -141,2 +141,1 @@\n-        var access = jComponentAccessor;\n-        if (access == null) {\n+        if (jComponentAccessor == null) {\n@@ -144,1 +143,0 @@\n-            access = jComponentAccessor;\n@@ -146,1 +144,2 @@\n-        return access;\n+\n+        return jComponentAccessor;\n@@ -165,2 +164,1 @@\n-        var access = jtextComponentAccessor;\n-        if (access == null) {\n+        if (jtextComponentAccessor == null) {\n@@ -168,1 +166,0 @@\n-            access = jtextComponentAccessor;\n@@ -170,1 +167,2 @@\n-        return access;\n+\n+        return jtextComponentAccessor;\n@@ -189,2 +187,1 @@\n-        var access = jLightweightFrameAccessor;\n-        if (access == null) {\n+        if (jLightweightFrameAccessor == null) {\n@@ -192,1 +189,0 @@\n-            access = jLightweightFrameAccessor;\n@@ -194,1 +190,1 @@\n-        return access;\n+        return jLightweightFrameAccessor;\n@@ -213,2 +209,1 @@\n-        var access = uiDefaultsAccessor;\n-        if (access == null) {\n+        if (uiDefaultsAccessor == null) {\n@@ -216,1 +211,0 @@\n-            access = uiDefaultsAccessor;\n@@ -218,1 +212,1 @@\n-        return access;\n+        return uiDefaultsAccessor;\n@@ -237,2 +231,1 @@\n-        var access = repaintManagerAccessor;\n-        if (access == null) {\n+        if (repaintManagerAccessor == null) {\n@@ -240,1 +233,0 @@\n-            access = repaintManagerAccessor;\n@@ -242,1 +234,1 @@\n-        return access;\n+        return repaintManagerAccessor;\n@@ -254,2 +246,1 @@\n-        var access = popupFactoryAccessor;\n-        if (access == null) {\n+        if (popupFactoryAccessor == null) {\n@@ -257,1 +248,0 @@\n-            access = popupFactoryAccessor;\n@@ -259,1 +249,1 @@\n-        return access;\n+        return popupFactoryAccessor;\n@@ -278,2 +268,1 @@\n-        var access = keyStrokeAccessor;\n-        if (access == null) {\n+        if (keyStrokeAccessor == null) {\n@@ -281,1 +270,0 @@\n-            access = keyStrokeAccessor;\n@@ -283,1 +271,1 @@\n-        return access;\n+        return keyStrokeAccessor;\n","filename":"src\/java.desktop\/share\/classes\/sun\/swing\/SwingAccessor.java","additions":17,"deletions":29,"binary":false,"changes":46,"status":"modified"},{"patch":"@@ -1,1 +1,1 @@\n-## Little Color Management System (LCMS) v2.14\n+## Little Color Management System (LCMS) v2.12\n@@ -6,8 +6,2 @@\n-README.1ST file information\n-\n-LittleCMS core is released under MIT License\n-\n----------------------------------\n-\n-Little CMS\n-Copyright (c) 1998-2022 Marti Maria Saguer\n+Little Color Management System\n+Copyright (c) 1998-2020 Marti Maria Saguer\n@@ -16,6 +10,5 @@\n-a copy of this software and associated documentation files (the\n-\"Software\"), to deal in the Software without restriction, including\n-without limitation the rights to use, copy, modify, merge, publish,\n-distribute, sublicense, and\/or sell copies of the Software, and to\n-permit persons to whom the Software is furnished to do so, subject\n-to the following conditions:\n+a copy of this software and associated documentation files (the \"Software\"),\n+to deal in the Software without restriction, including without limitation\n+the rights to use, copy, modify, merge, publish, distribute, sublicense,\n+and\/or sell copies of the Software, and to permit persons to whom the Software\n+is furnished to do so, subject to the following conditions:\n@@ -23,2 +16,2 @@\n-The above copyright notice and this permission notice shall be\n-included in all copies or substantial portions of the Software.\n+The above copyright notice and this permission notice shall be included in\n+all copies or substantial portions of the Software.\n@@ -27,20 +20,6 @@\n-EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n-MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.\n-IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY\n-CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT,\n-TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE\n-SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\n-\n----------------------------------\n-\n-The below license applies to the following files:\n-liblcms\/cmssm.c\n-\n-Copyright 2001, softSurfer (www.softsurfer.com)\n-\n-This code may be freely used and modified for any purpose\n-providing that this copyright notice is included with it.\n-SoftSurfer makes no warranty for this code, and cannot be held\n-liable for any real or imagined damage resulting from its use.\n-Users of this code must verify correctness for their application.\n-\n+EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO\n+THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND\n+NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE\n+LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION\n+OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION\n+WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\n@@ -49,59 +28,0 @@\n-\n-### AUTHORS File Information\n-```\n-\n-Main Author\n-------------\n-Marti Maria\n-\n-\n-Contributors\n-------------\n-Bob Friesenhahn\n-Kai-Uwe Behrmann\n-Stuart Nixon\n-Jordi Vilar\n-Richard Hughes\n-Auke Nauta\n-Chris Evans (Google)\n-Lorenzo Ridolfi\n-Robin Watts (Artifex)\n-Shawn Pedersen\n-Andrew Brygin\n-Samuli Suominen\n-Florian Hˆch\n-Aurelien Jarno\n-Claudiu Cebuc\n-Michael Vhrel (Artifex)\n-Michal Cihar\n-Daniel Kaneider\n-Mateusz Jurczyk (Google)\n-Paul Miller\n-SÈbastien LÈon\n-Christian Schmitz\n-XhmikosR\n-Stanislav Brabec (SuSe)\n-Leonhard Gruenschloss (Google)\n-Patrick Noffke\n-Christopher James Halse Rogers\n-John Hein\n-Thomas Weber (Debian)\n-Mark Allen\n-Noel Carboni\n-Sergei Trofimovic\n-Philipp Knechtges\n-\n-Special Thanks\n---------------\n-Artifex software\n-AlienSkin software\n-Jan Morovic\n-Jos Vernon (WebSupergoo)\n-Harald Schneider (Maxon)\n-Christian Albrecht\n-Dimitrios Anastassakis\n-Lemke Software\n-Tim Zaman\n-\n-\n-```\n","filename":"src\/java.desktop\/share\/legal\/lcms.md","additions":16,"deletions":96,"binary":false,"changes":112,"status":"modified"},{"patch":"@@ -49,0 +49,3 @@\n+#define IS_MUL_OVERFLOW(m, n) \\\n+        ((m) != 0 && (n) != 0 && (((size_t)((m)*(n))) != (((size_t)(m)) * ((size_t)(n)))))\n+\n@@ -51,1 +54,2 @@\n-     ((m) == 0 || (n) == 0 || (size_t)(n) <= (SIZE_MAX \/ (size_t)(m))))\n+     ((m) == 0 || (n) == 0 || (size_t)(n) <= (SIZE_MAX \/ (size_t)(m))) && \\\n+     !IS_MUL_OVERFLOW(m, n))\n@@ -74,1 +78,1 @@\n-    (IS_SAFE_SIZE_MUL((m), (n)) ? ((func)((size_t)(m) * (size_t)(n))) : FAILURE_RESULT)\n+    (IS_SAFE_SIZE_MUL((m), (n)) ? ((func)((m) * (n))) : FAILURE_RESULT)\n@@ -77,1 +81,1 @@\n-    (IS_SAFE_SIZE_MUL((m), (n)) ? ((func)((p), (size_t)(m) * (size_t)(n))) : FAILURE_RESULT)\n+    (IS_SAFE_SIZE_MUL((m), (n)) ? ((func)((p), (m) * (n))) : FAILURE_RESULT)\n@@ -91,1 +95,1 @@\n-    (IS_SAFE_SIZE_MUL(sizeof(type), (n)) ? (new type[(size_t)(n)]) : throw std::bad_alloc())\n+    (IS_SAFE_SIZE_MUL(sizeof(type), (n)) ? (new type[(n)]) : throw std::bad_alloc())\n@@ -94,2 +98,2 @@\n-    (IS_SAFE_SIZE_MUL((m), (n)) && IS_SAFE_SIZE_MUL(sizeof(type), (size_t)(n) * (size_t)(m)) ? \\\n-     (new type[(size_t)(n) * (size_t)(m)]) : throw std::bad_alloc())\n+    (IS_SAFE_SIZE_MUL((m), (n)) && IS_SAFE_SIZE_MUL(sizeof(type), (n) * (m)) ? \\\n+     (new type[(n) * (m)]) : throw std::bad_alloc())\n@@ -103,1 +107,1 @@\n-      IS_SAFE_SIZE_MUL((m), (n)) && IS_SAFE_SIZE_ADD((size_t)(m) * (size_t)(n), (a)) \\\n+      IS_SAFE_SIZE_MUL((m), (n)) && IS_SAFE_SIZE_ADD((m) * (n), (a)) \\\n@@ -115,1 +119,1 @@\n-    (IS_SAFE_STRUCT_SIZE((a), (m), (n)) ? ((func)((size_t)(a) + (size_t)(m) * (size_t)(n))) : FAILURE_RESULT)\n+    (IS_SAFE_STRUCT_SIZE((a), (m), (n)) ? ((func)((a) + (m) * (n))) : FAILURE_RESULT)\n","filename":"src\/java.desktop\/share\/native\/common\/awt\/utility\/sizecalc.h","additions":12,"deletions":8,"binary":false,"changes":20,"status":"modified"},{"patch":"@@ -716,1 +716,0 @@\n-        CHECK_NULL_RETURN(qdataBody, 0);\n","filename":"src\/java.desktop\/share\/native\/libjavajpeg\/imageioJPEG.c","additions":0,"deletions":1,"binary":false,"changes":1,"status":"modified"},{"patch":"@@ -1,23 +0,0 @@\n-# Tips and tasks when updating LittleCMS sources to a newer version.\n-\n-Download and unzip latest release from https:\/\/sourceforge.net\/projects\/lcms\/files\/\n-Replace files in src\/java.desktop\/share\/native\/liblcms with files from unzipped src and include folders\n-Replace is important because the lcms sources here are just the subset needed by JDK.\n-This is deliberate, so when updating be sure to import only the same files.\n-If a file has been removed from upstream you will notice it during the copy.\n-It should then be removed from the JDK sources.\n-If a new file is needed then the build will fail. Manually copy that in.\n-\n-Some re-editing of these updated files will be needed.\n-Use \"expand\" and \"sed\" to remove tabs and trailing white space from the imported files.\n-Re-apply the GPL headers used by the JDK. If done correctly these should then not\n-show up in the PR diff.\n-\n-Update src\/java.desktop\/share\/legal\/lcms.md per the current license\/copyrights\/attributions etc.\n-\n-Build on all platforms.\n-If there are compiler warnings causing build failures, update the disabled warnings in\n-make\/modules\/java.desktop\/lib\/Awt2dLibraries.gmk\n-Run all automated client tests on all platforms.\n-Also run J2Ddemo and pay particular attention to the \"color\" tab.\n-Visually verify the color transforms against the same with the current\/previous JDK\n\\ No newline at end of file\n","filename":"src\/java.desktop\/share\/native\/liblcms\/UPDATING.txt","additions":0,"deletions":23,"binary":false,"changes":23,"status":"deleted"},{"patch":"@@ -33,1 +33,1 @@\n-\/\/  Copyright (c) 1998-2022 Marti Maria Saguer\n+\/\/  Copyright (c) 1998-2020 Marti Maria Saguer\n@@ -223,1 +223,1 @@\n-    *(cmsUInt8Number*)dst = _cmsQuickSaturateByte(n * 255.0);\n+    *(cmsUInt8Number*)dst = _cmsQuickSaturateByte(n * 255.0f);\n@@ -230,1 +230,1 @@\n-    *(cmsUInt16Number*)dst = _cmsQuickSaturateWord(n * 65535.0);\n+    *(cmsUInt16Number*)dst = _cmsQuickSaturateWord(n * 65535.0f);\n@@ -237,1 +237,1 @@\n-    cmsUInt16Number i = _cmsQuickSaturateWord(n * 65535.0);\n+    cmsUInt16Number i = _cmsQuickSaturateWord(n * 65535.0f);\n@@ -275,1 +275,1 @@\n-       *(cmsUInt8Number*)dst = _cmsQuickSaturateByte(n * 255.0);\n+       *(cmsUInt8Number*)dst = _cmsQuickSaturateByte(n * 255.0f);\n@@ -288,1 +288,1 @@\n-       *(cmsUInt16Number*)dst = _cmsQuickSaturateWord(n * 65535.0);\n+       *(cmsUInt16Number*)dst = _cmsQuickSaturateWord(n * 65535.0f);\n@@ -300,1 +300,1 @@\n-    cmsUInt16Number i = _cmsQuickSaturateWord(n * 65535.0);\n+    cmsUInt16Number i = _cmsQuickSaturateWord(n * 65535.0f);\n@@ -446,3 +446,3 @@\n-       \/\/ Sanity check\n-       if (total_chans <= 0 || total_chans >= cmsMAXCHANNELS)\n-           return;\n+           \/\/ Sanity check\n+           if (total_chans <= 0 || total_chans >= cmsMAXCHANNELS)\n+                   return;\n","filename":"src\/java.desktop\/share\/native\/liblcms\/cmsalpha.c","additions":10,"deletions":10,"binary":false,"changes":20,"status":"modified"},{"patch":"@@ -33,1 +33,1 @@\n-\/\/  Copyright (c) 1998-2022 Marti Maria Saguer\n+\/\/  Copyright (c) 1998-2020 Marti Maria Saguer\n","filename":"src\/java.desktop\/share\/native\/liblcms\/cmscam02.c","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -33,1 +33,1 @@\n-\/\/  Copyright (c) 1998-2022 Marti Maria Saguer\n+\/\/  Copyright (c) 1998-2020 Marti Maria Saguer\n@@ -165,1 +165,1 @@\n-\/\/Very simple string\n+\/\/ This struct hold all information about an open IT8 handler.\n@@ -168,9 +168,0 @@\n-        struct struct_it8* it8;\n-        cmsInt32Number max;\n-        cmsInt32Number len;\n-        char* begin;\n-    } string;\n-\n-\n-\/\/ This struct hold all information about an open IT8 handler.\n-typedef struct struct_it8 {\n@@ -194,2 +185,2 @@\n-        string*        id;            \/\/ identifier\n-        string*        str;           \/\/ string\n+        char           id[MAXID];             \/\/ identifier\n+        char           str[MAXSTR];           \/\/ string\n@@ -280,1 +271,1 @@\n-                                                  \/\/ physical targets only (i.e . IT8.7\/1 and IT8.7\/2).\n+                                                  \/\/ physical targets only (i.e . IT8.7\/1 a nd IT8.7\/2).\n@@ -395,59 +386,0 @@\n-static\n-string* StringAlloc(cmsIT8* it8, int max)\n-{\n-    string* s = (string*) AllocChunk(it8, sizeof(string));\n-    if (s == NULL) return NULL;\n-\n-    s->it8 = it8;\n-    s->max = max;\n-    s->len = 0;\n-    s->begin = (char*) AllocChunk(it8, s->max);\n-\n-    return s;\n-}\n-\n-static\n-void StringClear(string* s)\n-{\n-    s->len = 0;\n-}\n-\n-static\n-void StringAppend(string* s, char c)\n-{\n-    if (s->len + 1 >= s->max)\n-    {\n-        char* new_ptr;\n-\n-        s->max *= 10;\n-        new_ptr = (char*) AllocChunk(s->it8, s->max);\n-        if (new_ptr != NULL && s->begin != NULL)\n-            memcpy(new_ptr, s->begin, s->len);\n-\n-        s->begin = new_ptr;\n-    }\n-\n-    if (s->begin != NULL)\n-    {\n-        s->begin[s->len++] = c;\n-        s->begin[s->len] = 0;\n-    }\n-}\n-\n-static\n-char* StringPtr(string* s)\n-{\n-    return s->begin;\n-}\n-\n-static\n-void StringCat(string* s, const char* c)\n-{\n-    while (*c)\n-    {\n-        StringAppend(s, *c);\n-        c++;\n-    }\n-}\n-\n-\n@@ -779,33 +711,0 @@\n-\/\/ Reads a string, special case to avoid infinite resursion on .include\n-static\n-void InStringSymbol(cmsIT8* it8)\n-{\n-    while (isseparator(it8->ch))\n-        NextCh(it8);\n-\n-    if (it8->ch == '\\'' || it8->ch == '\\\"')\n-    {\n-        int sng;\n-\n-        sng = it8->ch;\n-        StringClear(it8->str);\n-\n-        NextCh(it8);\n-\n-        while (it8->ch != sng) {\n-\n-            if (it8->ch == '\\n' || it8->ch == '\\r' || it8->ch == 0) break;\n-            else {\n-                StringAppend(it8->str, (char)it8->ch);\n-                NextCh(it8);\n-            }\n-        }\n-\n-        it8->sy = SSTRING;\n-        NextCh(it8);\n-    }\n-    else\n-        SynError(it8, \"String expected\");\n-\n-}\n-\n@@ -816,0 +715,2 @@\n+    CMSREGISTER char *idptr;\n+    CMSREGISTER int k;\n@@ -817,0 +718,1 @@\n+    int sng;\n@@ -825,1 +727,2 @@\n-            StringClear(it8->id);\n+            k = 0;\n+            idptr = it8->id;\n@@ -829,1 +732,1 @@\n-                StringAppend(it8->id, (char) it8->ch);\n+                if (++k < MAXID) *idptr++ = (char) it8->ch;\n@@ -835,0 +738,1 @@\n+            *idptr = '\\0';\n@@ -836,1 +740,2 @@\n-            key = BinSrchKey(StringPtr(it8->id));\n+\n+            key = BinSrchKey(it8->id);\n@@ -871,1 +776,0 @@\n-                                it8->sy = SEOF;\n@@ -893,1 +797,0 @@\n-                                it8->sy = SEOF;\n@@ -934,2 +837,0 @@\n-                    char buffer[127];\n-\n@@ -938,1 +839,1 @@\n-                        snprintf(buffer, sizeof(buffer), \"%d\", it8->inum);\n+                        snprintf(it8->id, 127, \"%d\", it8->inum);\n@@ -942,1 +843,1 @@\n-                        snprintf(buffer, sizeof(buffer), it8 ->DoubleFormatter, it8->dnum);\n+                        snprintf(it8->id, 127, it8 ->DoubleFormatter, it8->dnum);\n@@ -945,2 +846,2 @@\n-                    StringCat(it8->id, buffer);\n-\n+                    k = (int) strlen(it8 ->id);\n+                    idptr = it8 ->id + k;\n@@ -949,1 +850,1 @@\n-                        StringAppend(it8->id, (char) it8->ch);\n+                        if (++k < MAXID) *idptr++ = (char) it8->ch;\n@@ -955,0 +856,1 @@\n+                    *idptr = '\\0';\n@@ -963,1 +865,1 @@\n-        \/\/ Eof stream markers\n+        \/\/ EOF marker -- ignore it\n@@ -965,0 +867,4 @@\n+            NextCh(it8);\n+            break;\n+\n+        \/\/ Eof stream markers\n@@ -998,1 +904,18 @@\n-            InStringSymbol(it8);\n+            idptr = it8->str;\n+            sng = it8->ch;\n+            k = 0;\n+            NextCh(it8);\n+\n+            while (k < (MAXSTR-1) && it8->ch != sng) {\n+\n+                if (it8->ch == '\\n'|| it8->ch == '\\r') k = MAXSTR+1;\n+                else {\n+                    *idptr++ = (char) it8->ch;\n+                    NextCh(it8);\n+                    k++;\n+                }\n+            }\n+\n+            it8->sy = SSTRING;\n+            *idptr = '\\0';\n+            NextCh(it8);\n@@ -1004,1 +927,0 @@\n-            it8->sy = SEOF;\n@@ -1019,1 +941,0 @@\n-                    it8->sy = SEOF;\n@@ -1023,6 +944,2 @@\n-                InStringSymbol(it8);\n-                if (!Check(it8, SSTRING, \"Filename expected\"))\n-                {\n-                    it8->sy = SEOF;\n-                    return;\n-                }\n+                InSymbol(it8);\n+                if (!Check(it8, SSTRING, \"Filename expected\")) return;\n@@ -1034,5 +951,2 @@\n-                    if (FileNest == NULL) {\n-                        SynError(it8, \"Out of memory\");\n-                        it8->sy = SEOF;\n-                        return;\n-                    }\n+                    \/\/if(FileNest == NULL)\n+                    \/\/  TODO: how to manage out-of-memory conditions?\n@@ -1041,1 +955,1 @@\n-                if (BuildAbsolutePath(StringPtr(it8->str),\n+                if (BuildAbsolutePath(it8->str,\n@@ -1045,1 +959,0 @@\n-                    it8->sy = SEOF;\n@@ -1053,1 +966,0 @@\n-                        it8->sy = SEOF;\n@@ -1104,1 +1016,1 @@\n-    case SIDENT:  strncpy(Buffer, StringPtr(it8->id), max);\n+    case SIDENT:  strncpy(Buffer, it8->id, max);\n@@ -1109,1 +1021,1 @@\n-    case SSTRING: strncpy(Buffer, StringPtr(it8->str), max);\n+    case SSTRING: strncpy(Buffer, it8->str, max);\n@@ -1214,1 +1126,1 @@\n-        it8 ->Allocator.Block = (cmsUInt8Number*) AllocBigBlock(it8, it8 ->Allocator.BlockSize);\n+        it8 ->Allocator.Block = (cmsUInt8Number*)  AllocBigBlock(it8, it8 ->Allocator.BlockSize);\n@@ -1217,3 +1129,0 @@\n-    if (it8->Allocator.Block == NULL)\n-        return NULL;\n-\n@@ -1237,1 +1146,1 @@\n-    if (ptr) memcpy(ptr, str, Size-1);\n+    if (ptr) strncpy (ptr, str, Size-1);\n@@ -1436,3 +1345,0 @@\n-    it8->id = StringAlloc(it8, MAXSTR);\n-    it8->str = StringAlloc(it8, MAXSTR);\n-\n@@ -1560,15 +1466,0 @@\n-\/\/ A safe atoi that returns 0 when NULL input is given\n-static\n-cmsInt32Number satoi(const char* b)\n-{\n-    int n;\n-\n-    if (b == NULL) return 0;\n-\n-    n = atoi(b);\n-    if (n > 0x7fffffffL) return 0x7fffffffL;\n-    if (n < -0x7ffffffeL) return -0x7ffffffeL;\n-\n-    return (cmsInt32Number)n;\n-}\n-\n@@ -1577,1 +1468,1 @@\n-cmsBool AllocateDataFormat(cmsIT8* it8)\n+void AllocateDataFormat(cmsIT8* it8)\n@@ -1581,1 +1472,1 @@\n-    if (t -> DataFormat) return TRUE;    \/\/ Already allocated\n+    if (t -> DataFormat) return;    \/\/ Already allocated\n@@ -1583,1 +1474,1 @@\n-    t -> nSamples  = satoi(cmsIT8GetProperty(it8, \"NUMBER_OF_FIELDS\"));\n+    t -> nSamples  = (int) cmsIT8GetPropertyDbl(it8, \"NUMBER_OF_FIELDS\");\n@@ -1588,1 +1479,1 @@\n-        return FALSE;\n+        t -> nSamples = 10;\n@@ -1595,1 +1486,0 @@\n-        return FALSE;\n@@ -1598,1 +1488,0 @@\n-    return TRUE;\n@@ -1617,5 +1506,2 @@\n-    if (!t->DataFormat) {\n-\n-        if (!AllocateDataFormat(it8))\n-            return FALSE;\n-    }\n+    if (!t->DataFormat)\n+        AllocateDataFormat(it8);\n@@ -1630,1 +1516,0 @@\n-        if (t->DataFormat[n] == NULL) return FALSE;\n@@ -1643,1 +1528,1 @@\n-\/\/ Convert to binary\n+\/\/ A safe atoi that returns 0 when NULL input is given\n@@ -1645,1 +1530,1 @@\n-const char* satob(const char* v)\n+cmsInt32Number satoi(const char* b)\n@@ -1647,12 +1532,2 @@\n-    cmsUInt32Number x;\n-    static char buf[33];\n-    char *s = buf + 33;\n-\n-    if (v == NULL) return \"0\";\n-\n-    x = atoi(v);\n-    *--s = 0;\n-    if (!x) *--s = '0';\n-    for (; x; x \/= 2) *--s = '0' + x%2;\n-\n-    return s;\n+    if (b == NULL) return 0;\n+    return atoi(b);\n@@ -1661,1 +1536,0 @@\n-\n@@ -1663,1 +1537,1 @@\n-cmsBool AllocateDataSet(cmsIT8* it8)\n+void AllocateDataSet(cmsIT8* it8)\n@@ -1667,1 +1541,1 @@\n-    if (t -> Data) return TRUE;    \/\/ Already allocated\n+    if (t -> Data) return;    \/\/ Already allocated\n@@ -1675,1 +1549,0 @@\n-        return FALSE;\n@@ -1683,1 +1556,0 @@\n-            return FALSE;\n@@ -1687,1 +1559,0 @@\n-    return TRUE;\n@@ -1709,3 +1580,2 @@\n-    if (!t->Data) {\n-        if (!AllocateDataSet(it8)) return FALSE;\n-    }\n+    if (!t->Data)\n+        AllocateDataSet(it8);\n@@ -1851,1 +1721,1 @@\n-                    Writef(fp, \"\\t0b%s\", satob(p ->Value));\n+                    Writef(fp, \"\\t0x%B\", satoi(p ->Value));\n@@ -2021,1 +1891,1 @@\n-            if (!SetDataFormat(it8, iField, StringPtr(it8->id))) return FALSE;\n+            if (!SetDataFormat(it8, iField, it8->id)) return FALSE;\n@@ -2054,3 +1924,2 @@\n-    if (!t->Data) {\n-        if (!AllocateDataSet(it8)) return FALSE;\n-    }\n+    if (!t->Data)\n+        AllocateDataSet(it8);\n@@ -2068,16 +1937,0 @@\n-            switch (it8->sy)\n-            {\n-\n-            \/\/ To keep very long data\n-            case SIDENT:\n-                if (!SetData(it8, iSet, iField, StringPtr(it8->id)))\n-                    return FALSE;\n-                break;\n-\n-            case SSTRING:\n-                if (!SetData(it8, iSet, iField, StringPtr(it8->str)))\n-                    return FALSE;\n-                break;\n-\n-            default:\n-\n@@ -2089,1 +1942,0 @@\n-            }\n@@ -2145,1 +1997,1 @@\n-            strncpy(VarName, StringPtr(it8->id), MAXID - 1);\n+            strncpy(VarName, it8->id, MAXID - 1);\n@@ -2289,1 +2141,1 @@\n-                                         cmsIT8SetSheetType(it8, StringPtr(it8 ->id));\n+                                         cmsIT8SetSheetType(it8, it8 ->id);\n@@ -2301,1 +2153,1 @@\n-                                        cmsIT8SetSheetType(it8, StringPtr(it8 ->str));\n+                                        cmsIT8SetSheetType(it8, it8 ->str);\n@@ -2603,2 +2455,1 @@\n-        Props = (char**)AllocChunk(it8, sizeof(char*) * n);\n-        if (Props != NULL) {\n+    Props = (char **) AllocChunk(it8, sizeof(char *) * n);\n@@ -2606,8 +2457,5 @@\n-                \/\/ Pass#2 - Fill pointers\n-                n = 0;\n-                for (p = t->HeaderList; p != NULL; p = p->Next) {\n-                        Props[n++] = p->Keyword;\n-                }\n-\n-        }\n-        *PropertyNames = Props;\n+    \/\/ Pass#2 - Fill pointers\n+    n = 0;\n+    for (p = t -> HeaderList;  p != NULL; p = p->Next) {\n+        Props[n++] = p -> Keyword;\n+    }\n@@ -2615,0 +2463,1 @@\n+    *PropertyNames = Props;\n@@ -2646,1 +2495,0 @@\n-    if (Props != NULL) {\n@@ -2648,6 +2496,5 @@\n-        \/\/ Pass#2 - Fill pointers\n-        n = 0;\n-        for (tmp = p; tmp != NULL; tmp = tmp->NextSubkey) {\n-            if (tmp->Subkey != NULL)\n-                Props[n++] = p->Subkey;\n-        }\n+    \/\/ Pass#2 - Fill pointers\n+    n = 0;\n+    for (tmp = p;  tmp != NULL; tmp = tmp->NextSubkey) {\n+        if(tmp->Subkey != NULL)\n+            Props[n++] = p ->Subkey;\n@@ -2829,6 +2676,2 @@\n-        if (!AllocateDataFormat(it8))\n-            return FALSE;\n-\n-        if (!AllocateDataSet(it8))\n-            return FALSE;\n-\n+        AllocateDataFormat(it8);\n+        AllocateDataSet(it8);\n","filename":"src\/java.desktop\/share\/native\/liblcms\/cmscgats.c","additions":87,"deletions":244,"binary":false,"changes":331,"status":"modified"},{"patch":"@@ -33,1 +33,1 @@\n-\/\/  Copyright (c) 1998-2022 Marti Maria Saguer\n+\/\/  Copyright (c) 1998-2020 Marti Maria Saguer\n@@ -418,1 +418,1 @@\n-            cmsCIEXYZ BlackPointIn = { 0, 0, 0}, BlackPointOut = { 0, 0, 0 };\n+            cmsCIEXYZ BlackPointIn, BlackPointOut;\n@@ -662,1 +662,1 @@\n-                  cmsStage* clip = _cmsStageClipNegatives(Result->ContextID, cmsChannelsOfColorSpace(ColorSpaceOut));\n+                  cmsStage* clip = _cmsStageClipNegatives(Result->ContextID, cmsChannelsOf(ColorSpaceOut));\n","filename":"src\/java.desktop\/share\/native\/liblcms\/cmscnvrt.c","additions":3,"deletions":3,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -33,1 +33,1 @@\n-\/\/  Copyright (c) 1998-2022 Marti Maria Saguer\n+\/\/  Copyright (c) 1998-2020 Marti Maria Saguer\n@@ -111,1 +111,1 @@\n-\/\/ is up to the plug-in writer to keep in the safe side. There are only three functions\n+\/\/ is up to the plug-in writter to keep in the safe side. There are only three functions\n@@ -340,1 +340,1 @@\n-\/\/ I prefer this method over realloc due to the big impact on xput realloc may have if\n+\/\/ I prefer this method over realloc due to the big inpact on xput realloc may have if\n@@ -645,0 +645,1 @@\n+\n@@ -692,44 +693,0 @@\n-\n-\/\/ The global Context0 storage for parallelization plug-in\n- _cmsParallelizationPluginChunkType _cmsParallelizationPluginChunk = { 0 };\n-\n-\/\/ Allocate parallelization container.\n-void _cmsAllocParallelizationPluginChunk(struct _cmsContext_struct* ctx,\n-                                         const struct _cmsContext_struct* src)\n-{\n-    if (src != NULL) {\n-        void* from = src->chunks[ParallelizationPlugin];\n-        ctx->chunks[ParallelizationPlugin] = _cmsSubAllocDup(ctx->MemPool, from, sizeof(_cmsParallelizationPluginChunkType));\n-    }\n-    else {\n-        _cmsParallelizationPluginChunkType ParallelizationPluginChunk = { 0 };\n-        ctx->chunks[ParallelizationPlugin] = _cmsSubAllocDup(ctx->MemPool, &ParallelizationPluginChunk, sizeof(_cmsParallelizationPluginChunkType));\n-    }\n-}\n-\n-\/\/ Register parallel processing\n-cmsBool _cmsRegisterParallelizationPlugin(cmsContext ContextID, cmsPluginBase* Data)\n-{\n-    cmsPluginParalellization* Plugin = (cmsPluginParalellization*)Data;\n-    _cmsParallelizationPluginChunkType* ctx = (_cmsParallelizationPluginChunkType*)_cmsContextGetClientChunk(ContextID, ParallelizationPlugin);\n-\n-    if (Data == NULL) {\n-\n-        \/\/ No parallelization routines\n-        ctx->MaxWorkers = 0;\n-        ctx->WorkerFlags = 0;\n-        ctx->SchedulerFn = NULL;\n-        return TRUE;\n-    }\n-\n-    \/\/ callback is required\n-    if (Plugin->SchedulerFn == NULL) return FALSE;\n-\n-    ctx->MaxWorkers = Plugin->MaxWorkers;\n-    ctx->WorkerFlags = Plugin->WorkerFlags;\n-    ctx->SchedulerFn = Plugin->SchedulerFn;\n-\n-    \/\/ All is ok\n-    return TRUE;\n-}\n-\n","filename":"src\/java.desktop\/share\/native\/liblcms\/cmserr.c","additions":4,"deletions":47,"binary":false,"changes":51,"status":"modified"},{"patch":"@@ -33,1 +33,1 @@\n-\/\/  Copyright (c) 1998-2022 Marti Maria Saguer\n+\/\/  Copyright (c) 1998-2020 Marti Maria Saguer\n@@ -239,1 +239,1 @@\n-\/\/ no optimization curve is computed. nSegments may also be zero in the inverse case, where only the\n+\/\/ no optimation curve is computed. nSegments may also be zero in the inverse case, where only the\n@@ -459,2 +459,2 @@\n-    \/\/ Y = (aX + b)^Gamma + c | X <= -b\/a\n-    \/\/ Y = c                  | else\n+    \/\/ Y = (aX + b)^Gamma | X <= -b\/a\n+    \/\/ Y = c              | else\n@@ -494,2 +494,1 @@\n-        if (fabs(Params[0]) < MATRIX_DET_TOLERANCE ||\n-            fabs(Params[1]) < MATRIX_DET_TOLERANCE)\n+        if (fabs(Params[1]) < MATRIX_DET_TOLERANCE)\n@@ -540,4 +539,6 @@\n-\n-        e = Params[1] * Params[4] + Params[2];\n-        if (e < 0)\n-            disc = 0;\n+        if (fabs(Params[0]) < MATRIX_DET_TOLERANCE ||\n+            fabs(Params[1]) < MATRIX_DET_TOLERANCE ||\n+            fabs(Params[3]) < MATRIX_DET_TOLERANCE)\n+        {\n+            Val = 0;\n+        }\n@@ -545,6 +546,6 @@\n-            disc = pow(e, Params[0]);\n-\n-        if (R >= disc) {\n-\n-            if (fabs(Params[0]) < MATRIX_DET_TOLERANCE ||\n-                fabs(Params[1]) < MATRIX_DET_TOLERANCE)\n+        {\n+            e = Params[1] * Params[4] + Params[2];\n+            if (e < 0)\n+                disc = 0;\n+            else\n+                disc = pow(e, Params[0]);\n@@ -552,1 +553,1 @@\n-                Val = 0;\n+            if (R >= disc) {\n@@ -554,1 +555,0 @@\n-            else\n@@ -556,6 +556,2 @@\n-        }\n-        else {\n-\n-            if (fabs(Params[3]) < MATRIX_DET_TOLERANCE)\n-                Val = 0;\n-            else\n+            }\n+            else {\n@@ -563,0 +559,1 @@\n+            }\n@@ -564,1 +561,0 @@\n-\n@@ -591,10 +587,9 @@\n-        disc = Params[3] * Params[4] + Params[6];\n-        if (R >= disc) {\n-\n-            e = R - Params[5];\n-            if (e < 0)\n-                Val = 0;\n-            else\n-            {\n-                if (fabs(Params[0]) < MATRIX_DET_TOLERANCE ||\n-                    fabs(Params[1]) < MATRIX_DET_TOLERANCE)\n+        if (fabs(Params[1]) < MATRIX_DET_TOLERANCE ||\n+            fabs(Params[3]) < MATRIX_DET_TOLERANCE)\n+        {\n+            Val = 0;\n+        }\n+        else\n+        {\n+            disc = Params[3] * Params[4] + Params[6];\n+            if (R >= disc) {\n@@ -602,0 +597,2 @@\n+                e = R - Params[5];\n+                if (e < 0)\n@@ -606,5 +603,1 @@\n-        }\n-        else {\n-            if (fabs(Params[3]) < MATRIX_DET_TOLERANCE)\n-                Val = 0;\n-            else\n+            else {\n@@ -612,0 +605,1 @@\n+            }\n@@ -613,1 +607,0 @@\n-\n@@ -634,2 +627,1 @@\n-        if (fabs(Params[0]) < MATRIX_DET_TOLERANCE ||\n-            fabs(Params[1]) < MATRIX_DET_TOLERANCE)\n+        if (fabs(Params[1]) < MATRIX_DET_TOLERANCE)\n@@ -1507,3 +1499,0 @@\n-    \/\/ We need enough valid samples\n-    if (n <= 1) return -1.0;\n-\n","filename":"src\/java.desktop\/share\/native\/liblcms\/cmsgamma.c","additions":35,"deletions":46,"binary":false,"changes":81,"status":"modified"},{"patch":"@@ -33,1 +33,1 @@\n-\/\/  Copyright (c) 1998-2021 Marti Maria Saguer\n+\/\/  Copyright (c) 1998-2020 Marti Maria Saguer\n@@ -231,1 +231,1 @@\n-    cmsFloat64Number Threshold;         \/\/ The threshold after which is considered out of gamut\n+    cmsFloat64Number Thereshold;        \/\/ The thereshold after which is considered out of gamut\n@@ -236,1 +236,1 @@\n-\/\/ values with a transform going back and forth. Values above ERR_THRESHOLD\n+\/\/ values with a transform going back and forth. Values above ERR_THERESHOLD\n@@ -239,1 +239,1 @@\n-#define ERR_THRESHOLD      5\n+#define ERR_THERESHOLD      5\n@@ -278,1 +278,1 @@\n-    if (dE1 < t->Threshold && dE2 < t->Threshold)\n+    if (dE1 < t->Thereshold && dE2 < t->Thereshold)\n@@ -283,1 +283,1 @@\n-        if (dE1 < t->Threshold && dE2 > t->Threshold)\n+        if (dE1 < t->Thereshold && dE2 > t->Thereshold)\n@@ -287,2 +287,2 @@\n-            if (dE1 > t->Threshold && dE2 < t->Threshold)\n-                Out[0] = (cmsUInt16Number) _cmsQuickFloor((dE1 - t->Threshold) + .5);\n+            if (dE1 > t->Thereshold && dE2 < t->Thereshold)\n+                Out[0] = (cmsUInt16Number) _cmsQuickFloor((dE1 - t->Thereshold) + .5);\n@@ -298,2 +298,2 @@\n-                if (ErrorRatio > t->Threshold)\n-                    Out[0] = (cmsUInt16Number)  _cmsQuickFloor((ErrorRatio - t->Threshold) + .5);\n+                if (ErrorRatio > t->Thereshold)\n+                    Out[0] = (cmsUInt16Number)  _cmsQuickFloor((ErrorRatio - t->Thereshold) + .5);\n@@ -329,2 +329,1 @@\n-    cmsUInt32Number nGridpoints;\n-    cmsInt32Number nChannels;\n+    cmsUInt32Number nChannels, nGridpoints;\n@@ -356,1 +355,1 @@\n-        Chain.Threshold = 1.0;\n+        Chain.Thereshold = 1.0;\n@@ -359,1 +358,1 @@\n-        Chain.Threshold = ERR_THRESHOLD;\n+        Chain.Thereshold = ERR_THERESHOLD;\n@@ -379,1 +378,2 @@\n-    nChannels   = cmsChannelsOfColorSpace(ColorSpace);\n+\n+    nChannels   = cmsChannelsOf(ColorSpace);\n@@ -504,3 +504,0 @@\n-    \/\/ Unsupported color space?\n-    if (dwFormatter == 0) return 0;\n-\n@@ -623,66 +620,0 @@\n-\n-\/\/ Detect whatever a given ICC profile works in linear (gamma 1.0) space\n-\/\/ Actually, doing that \"well\" is quite hard, since every component may behave completely different.\n-\/\/ Since the true point of this function is to detect suitable optimizations, I am imposing some requirements\n-\/\/ that simplifies things: only RGB, and only profiles that can got in both directions.\n-\/\/ The algorithm obtains Y from a syntetical gray R=G=B. Then least squares fitting is used to estimate gamma.\n-\/\/ For gamma close to 1.0, RGB is linear. On profiles not supported, -1 is returned.\n-\n-cmsFloat64Number CMSEXPORT cmsDetectRGBProfileGamma(cmsHPROFILE hProfile, cmsFloat64Number threshold)\n-{\n-    cmsContext ContextID;\n-    cmsHPROFILE hXYZ;\n-    cmsHTRANSFORM xform;\n-    cmsToneCurve* Y_curve;\n-    cmsUInt16Number rgb[256][3];\n-    cmsCIEXYZ XYZ[256];\n-    cmsFloat32Number Y_normalized[256];\n-    cmsFloat64Number gamma;\n-    cmsProfileClassSignature cl;\n-    int i;\n-\n-    if (cmsGetColorSpace(hProfile) != cmsSigRgbData)\n-        return -1;\n-\n-    cl = cmsGetDeviceClass(hProfile);\n-    if (cl != cmsSigInputClass && cl != cmsSigDisplayClass &&\n-        cl != cmsSigOutputClass && cl != cmsSigColorSpaceClass)\n-        return -1;\n-\n-    ContextID = cmsGetProfileContextID(hProfile);\n-    hXYZ = cmsCreateXYZProfileTHR(ContextID);\n-    if (hXYZ == NULL)\n-        return -1;\n-    xform = cmsCreateTransformTHR(ContextID, hProfile, TYPE_RGB_16, hXYZ, TYPE_XYZ_DBL,\n-                                    INTENT_RELATIVE_COLORIMETRIC, cmsFLAGS_NOOPTIMIZE);\n-\n-    if (xform == NULL) { \/\/ If not RGB or forward direction is not supported, regret with the previous error\n-\n-        cmsCloseProfile(hXYZ);\n-        return -1;\n-    }\n-\n-    for (i = 0; i < 256; i++) {\n-        rgb[i][0] = rgb[i][1] = rgb[i][2] = FROM_8_TO_16(i);\n-    }\n-\n-    cmsDoTransform(xform, rgb, XYZ, 256);\n-\n-    cmsDeleteTransform(xform);\n-    cmsCloseProfile(hXYZ);\n-\n-    for (i = 0; i < 256; i++) {\n-        Y_normalized[i] = (cmsFloat32Number) XYZ[i].Y;\n-    }\n-\n-    Y_curve = cmsBuildTabulatedToneCurveFloat(ContextID, 256, Y_normalized);\n-    if (Y_curve == NULL)\n-        return -1;\n-\n-    gamma = cmsEstimateGamma(Y_curve, threshold);\n-\n-    cmsFreeToneCurve(Y_curve);\n-\n-    return gamma;\n-}\n-\n","filename":"src\/java.desktop\/share\/native\/liblcms\/cmsgmt.c","additions":15,"deletions":84,"binary":false,"changes":99,"status":"modified"},{"patch":"@@ -33,1 +33,1 @@\n-\/\/  Copyright (c) 1998-2022 Marti Maria Saguer\n+\/\/  Copyright (c) 1998-2020 Marti Maria Saguer\n@@ -409,1 +409,1 @@\n-static const cmsUInt16Number Offset[64] = {\n+static cmsUInt16Number Offset[64] = {\n","filename":"src\/java.desktop\/share\/native\/liblcms\/cmshalf.c","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -33,1 +33,1 @@\n-\/\/  Copyright (c) 1998-2022 Marti Maria Saguer\n+\/\/  Copyright (c) 1998-2020 Marti Maria Saguer\n@@ -232,2 +232,2 @@\n-    \/\/ if last value or just one point\n-    if (Value[0] == 0xffff || p->Domain[0] == 0) {\n+    \/\/ if last value...\n+    if (Value[0] == 0xffff) {\n@@ -272,1 +272,1 @@\n-       if (val2 == 1.0 || p->Domain[0] == 0) {\n+       if (val2 == 1.0) {\n@@ -306,0 +306,2 @@\n+       v = Input[0] * p16 -> Domain[0];\n+       fk = _cmsToFixedDomain(v);\n@@ -307,17 +309,2 @@\n-       \/\/ if last value...\n-       if (Input[0] == 0xffff || p16->Domain[0] == 0) {\n-\n-           cmsUInt32Number y0 = p16->Domain[0] * p16->opta[0];\n-\n-           for (OutChan = 0; OutChan < p16->nOutputs; OutChan++) {\n-               Output[OutChan] = LutTable[y0 + OutChan];\n-           }\n-       }\n-       else\n-       {\n-\n-           v = Input[0] * p16->Domain[0];\n-           fk = _cmsToFixedDomain(v);\n-\n-           k0 = FIXED_TO_INT(fk);\n-           rk = (cmsUInt16Number)FIXED_REST_TO_INT(fk);\n+       k0 = FIXED_TO_INT(fk);\n+       rk = (cmsUInt16Number) FIXED_REST_TO_INT(fk);\n@@ -325,1 +312,1 @@\n-           k1 = k0 + (Input[0] != 0xFFFFU ? 1 : 0);\n+       k1 = k0 + (Input[0] != 0xFFFFU ? 1 : 0);\n@@ -327,2 +314,2 @@\n-           K0 = p16->opta[0] * k0;\n-           K1 = p16->opta[0] * k1;\n+       K0 = p16 -> opta[0] * k0;\n+       K1 = p16 -> opta[0] * k1;\n@@ -330,1 +317,1 @@\n-           for (OutChan = 0; OutChan < p16->nOutputs; OutChan++) {\n+       for (OutChan=0; OutChan < p16->nOutputs; OutChan++) {\n@@ -332,2 +319,1 @@\n-               Output[OutChan] = LinearInterp(rk, LutTable[K0 + OutChan], LutTable[K1 + OutChan]);\n-           }\n+           Output[OutChan] = LinearInterp(rk, LutTable[K0+OutChan], LutTable[K1+OutChan]);\n@@ -354,1 +340,1 @@\n-    if (val2 == 1.0 || p->Domain[0] == 0) {\n+    if (val2 == 1.0) {\n@@ -356,1 +342,1 @@\n-        cmsUInt32Number start = p->Domain[0] * p->opta[0];\n+        y0 = LutTable[p->Domain[0]];\n@@ -359,1 +345,1 @@\n-            Output[OutChan] = LutTable[start + OutChan];\n+            Output[OutChan] = y0;\n","filename":"src\/java.desktop\/share\/native\/liblcms\/cmsintrp.c","additions":16,"deletions":30,"binary":false,"changes":46,"status":"modified"},{"patch":"@@ -33,1 +33,1 @@\n-\/\/  Copyright (c) 1998-2022 Marti Maria Saguer\n+\/\/  Copyright (c) 1998-2020 Marti Maria Saguer\n@@ -407,1 +407,0 @@\n-    char mode[4] = { 0,0,0,0 };\n@@ -415,34 +414,1 @@\n-    \/\/ Validate access mode\n-    while (*AccessMode) {\n-\n-        switch (*AccessMode)\n-        {\n-        case 'r':\n-        case 'w':\n-\n-            if (mode[0] == 0) {\n-                mode[0] = *AccessMode;\n-                mode[1] = 'b';\n-            }\n-            else {\n-                _cmsFree(ContextID, iohandler);\n-                cmsSignalError(ContextID, cmsERROR_FILE, \"Access mode already specified '%c'\", *AccessMode);\n-                return NULL;\n-            }\n-            break;\n-\n-        \/\/ Close on exec. Not all runtime supports that. Up to the caller to decide.\n-        case 'e':\n-            mode[2] = 'e';\n-            break;\n-\n-        default:\n-            _cmsFree(ContextID, iohandler);\n-            cmsSignalError(ContextID, cmsERROR_FILE, \"Wrong access mode '%c'\", *AccessMode);\n-            return NULL;\n-        }\n-\n-        AccessMode++;\n-    }\n-\n-    switch (mode[0]) {\n+    switch (*AccessMode) {\n@@ -451,1 +417,1 @@\n-        fm = fopen(FileName, mode);\n+        fm = fopen(FileName, \"rb\");\n@@ -457,1 +423,1 @@\n-        fileLen = (cmsInt32Number)cmsfilelength(fm);\n+        fileLen = cmsfilelength(fm);\n@@ -465,0 +431,1 @@\n+\n@@ -469,1 +436,1 @@\n-        fm = fopen(FileName, mode);\n+        fm = fopen(FileName, \"wb\");\n@@ -479,1 +446,2 @@\n-        _cmsFree(ContextID, iohandler);   \/\/ Would never reach\n+        _cmsFree(ContextID, iohandler);\n+         cmsSignalError(ContextID, cmsERROR_FILE, \"Unknown access mode '%c'\", *AccessMode);\n@@ -506,1 +474,1 @@\n-    fileSize = (cmsInt32Number)cmsfilelength(Stream);\n+    fileSize = cmsfilelength(Stream);\n@@ -543,1 +511,1 @@\n-    _cmsICCPROFILE* Icc = (_cmsICCPROFILE*)hProfile;\n+        _cmsICCPROFILE* Icc = (_cmsICCPROFILE*)hProfile;\n@@ -545,2 +513,2 @@\n-    if (Icc == NULL) return NULL;\n-    return Icc->IOhandler;\n+        if (Icc == NULL) return NULL;\n+        return Icc->IOhandler;\n@@ -552,0 +520,1 @@\n+    time_t now = time(NULL);\n@@ -563,3 +532,0 @@\n-    \/\/ Set default device class\n-    Icc->DeviceClass = cmsSigDisplayClass;\n-\n@@ -567,2 +533,1 @@\n-    if (!_cmsGetTime(&Icc->Created))\n-        goto Error;\n+    memmove(&Icc ->Created, gmtime(&now), sizeof(Icc ->Created));\n@@ -575,4 +540,0 @@\n-\n-Error:\n-    _cmsFree(ContextID, Icc);\n-    return NULL;\n@@ -724,21 +685,0 @@\n-\n-\n-\/\/ Checks for link compatibility\n-static\n-cmsBool CompatibleTypes(const cmsTagDescriptor* desc1, const cmsTagDescriptor* desc2)\n-{\n-    cmsUInt32Number i;\n-\n-    if (desc1 == NULL || desc2 == NULL) return FALSE;\n-\n-    if (desc1->nSupportedTypes != desc2->nSupportedTypes) return FALSE;\n-    if (desc1->ElemCount != desc2->ElemCount) return FALSE;\n-\n-    for (i = 0; i < desc1->nSupportedTypes; i++)\n-    {\n-        if (desc1->SupportedTypes[i] != desc2->SupportedTypes[i]) return FALSE;\n-    }\n-\n-    return TRUE;\n-}\n-\n@@ -770,23 +710,0 @@\n-\/\/ Check device class\n-static\n-cmsBool validDeviceClass(cmsProfileClassSignature cl)\n-{\n-    if ((int)cl == 0) return TRUE; \/\/ We allow zero because older lcms versions defaulted to that.\n-\n-    switch (cl)\n-    {\n-    case cmsSigInputClass:\n-    case cmsSigDisplayClass:\n-    case cmsSigOutputClass:\n-    case cmsSigLinkClass:\n-    case cmsSigAbstractClass:\n-    case cmsSigColorSpaceClass:\n-    case cmsSigNamedColorClass:\n-        return TRUE;\n-\n-    default:\n-        return FALSE;\n-    }\n-\n-}\n-\n@@ -829,10 +746,0 @@\n-    if (Icc->Version > 0x5000000) {\n-        cmsSignalError(Icc->ContextID, cmsERROR_UNKNOWN_EXTENSION, \"Unsupported profile version '0x%x'\", Icc->Version);\n-        return FALSE;\n-    }\n-\n-    if (!validDeviceClass(Icc->DeviceClass)) {\n-        cmsSignalError(Icc->ContextID, cmsERROR_UNKNOWN_EXTENSION, \"Unsupported device class '0x%x'\", Icc->DeviceClass);\n-        return FALSE;\n-    }\n-\n@@ -872,1 +779,0 @@\n-        if (Tag.size == 0 || Tag.offset == 0) continue;\n@@ -887,6 +793,1 @@\n-                \/\/ Check types.\n-                if (CompatibleTypes(_cmsGetTagDescriptor(Icc->ContextID, Icc->TagNames[j]),\n-                                    _cmsGetTagDescriptor(Icc->ContextID, Tag.sig))) {\n-\n-                    Icc->TagLinked[Icc->TagCount] = Icc->TagNames[j];\n-                }\n+                Icc ->TagLinked[Icc ->TagCount] = Icc ->TagNames[j];\n@@ -900,13 +801,0 @@\n-\n-    for (i = 0; i < Icc->TagCount; i++) {\n-        for (j = 0; j < Icc->TagCount; j++) {\n-\n-            \/\/ Tags cannot be duplicate\n-            if ((i != j) && (Icc->TagNames[i] == Icc->TagNames[j])) {\n-                cmsSignalError(Icc->ContextID, cmsERROR_RANGE, \"Duplicate tag found\");\n-                return FALSE;\n-            }\n-\n-        }\n-    }\n-\n@@ -1574,7 +1462,0 @@\n-\/\/ Free one tag contents\n-static\n-void freeOneTag(_cmsICCPROFILE* Icc, cmsUInt32Number i)\n-{\n-    if (Icc->TagPtrs[i]) {\n-\n-        cmsTagTypeHandler* TypeHandler = Icc->TagTypeHandlers[i];\n@@ -1582,11 +1463,0 @@\n-        if (TypeHandler != NULL) {\n-            cmsTagTypeHandler LocalTypeHandler = *TypeHandler;\n-\n-            LocalTypeHandler.ContextID = Icc->ContextID;\n-            LocalTypeHandler.ICCVersion = Icc->Version;\n-            LocalTypeHandler.FreePtr(&LocalTypeHandler, Icc->TagPtrs[i]);\n-        }\n-        else\n-            _cmsFree(Icc->ContextID, Icc->TagPtrs[i]);\n-    }\n-}\n@@ -1612,1 +1482,14 @@\n-        freeOneTag(Icc, i);\n+        if (Icc -> TagPtrs[i]) {\n+\n+            cmsTagTypeHandler* TypeHandler = Icc ->TagTypeHandlers[i];\n+\n+            if (TypeHandler != NULL) {\n+                cmsTagTypeHandler LocalTypeHandler = *TypeHandler;\n+\n+                LocalTypeHandler.ContextID = Icc ->ContextID;              \/\/ As an additional parameters\n+                LocalTypeHandler.ICCVersion = Icc ->Version;\n+                LocalTypeHandler.FreePtr(&LocalTypeHandler, Icc -> TagPtrs[i]);\n+            }\n+            else\n+                _cmsFree(Icc ->ContextID, Icc ->TagPtrs[i]);\n+        }\n@@ -1664,6 +1547,2 @@\n-    if (n < 0)\n-    {\n-        \/\/ Not found, return NULL\n-        _cmsUnlockMutex(Icc->ContextID, Icc->UsrMutex);\n-        return NULL;\n-    }\n+    if (n < 0) goto Error;               \/\/ Not found, return NULL\n+\n@@ -1698,7 +1577,0 @@\n-\n-    if (io == NULL) { \/\/ This is a built-in profile that has been manipulated, abort early\n-\n-        cmsSignalError(Icc->ContextID, cmsERROR_CORRUPTION_DETECTED, \"Corrupted built-in profile.\");\n-        goto Error;\n-    }\n-\n@@ -1772,1 +1644,1 @@\n-    \/\/ Return error and unlock the data\n+    \/\/ Return error and unlock tha data\n@@ -1774,4 +1646,0 @@\n-\n-    freeOneTag(Icc, n);\n-    Icc->TagPtrs[n] = NULL;\n-\n@@ -1916,3 +1784,5 @@\n-\/\/ Read and write raw data. Read\/Write Raw\/cooked pairs try to maintain consistency within the pair. Some sequences\n-\/\/ raw\/cooked would work, but at a cost. Data \"cooked\" may be converted to \"raw\" by using the \"write\" serialization logic.\n-\/\/ In general it is better to avoid mixing pairs.\n+\/\/ Read and write raw data. The only way those function would work and keep consistence with normal read and write\n+\/\/ is to do an additional step of serialization. That means, readRaw would issue a normal read and then convert the obtained\n+\/\/ data to raw bytes by using the \"write\" serialization logic. And vice-versa. I know this may end in situations where\n+\/\/ raw data written does not exactly correspond with the raw data proposed to cmsWriteRaw data, but this approach allows\n+\/\/ to write a tag as raw data and the read it as handled.\n@@ -1932,3 +1802,0 @@\n-    \/\/ Sanity check\n-    if (data != NULL && BufferSize == 0) return 0;\n-\n@@ -1938,1 +1805,0 @@\n-\n@@ -1945,1 +1811,1 @@\n-        \/\/ Not yet, get original position\n+        \/\/ No yet, get original position\n@@ -1950,1 +1816,0 @@\n-\n@@ -1954,1 +1819,1 @@\n-                goto Error;\n+                TagSize = BufferSize;\n@@ -1969,1 +1834,0 @@\n-\n@@ -1976,1 +1840,1 @@\n-                goto Error;\n+                TagSize = BufferSize;\n@@ -1989,1 +1853,1 @@\n-    \/\/ data to raw to get something that makes sense\n+    \/\/ data to raw in order to maintain consistency.\n","filename":"src\/java.desktop\/share\/native\/liblcms\/cmsio0.c","additions":41,"deletions":177,"binary":false,"changes":218,"status":"modified"},{"patch":"@@ -33,1 +33,1 @@\n-\/\/  Copyright (c) 1998-2022 Marti Maria Saguer\n+\/\/  Copyright (c) 1998-2020 Marti Maria Saguer\n@@ -292,1 +292,1 @@\n-\/\/ Read the DToAX tag, adjusting the encoding of Lab or XYZ if needed\n+\/\/ Read the DToAX tag, adjusting the encoding of Lab or XYZ if neded\n@@ -354,1 +354,2 @@\n-        if (Lut == NULL)\n+        if (Lut == NULL) {\n+            cmsFreeNamedColorList(nc);\n@@ -356,0 +357,1 @@\n+        }\n@@ -566,1 +568,1 @@\n-\/\/ Read the DToAX tag, adjusting the encoding of Lab or XYZ if needed\n+\/\/ Read the DToAX tag, adjusting the encoding of Lab or XYZ if neded\n@@ -691,1 +693,1 @@\n-\/\/ Read the AToD0 tag, adjusting the encoding of Lab or XYZ if needed\n+\/\/ Read the AToD0 tag, adjusting the encoding of Lab or XYZ if neded\n@@ -770,0 +772,1 @@\n+        cmsFreeNamedColorList(nc);\n","filename":"src\/java.desktop\/share\/native\/liblcms\/cmsio1.c","additions":8,"deletions":5,"binary":false,"changes":13,"status":"modified"},{"patch":"@@ -33,1 +33,1 @@\n-\/\/  Copyright (c) 1998-2022 Marti Maria Saguer\n+\/\/  Copyright (c) 1998-2020 Marti Maria Saguer\n@@ -499,1 +499,1 @@\n-        if (dim <= 1) return 0;  \/\/ Error\n+        if (dim == 0) return 0;  \/\/ Error\n@@ -1258,5 +1258,0 @@\n-cmsContext CMSEXPORT cmsGetStageContextID(const cmsStage* mpe)\n-{\n-    return mpe -> ContextID;\n-}\n-\n","filename":"src\/java.desktop\/share\/native\/liblcms\/cmslut.c","additions":2,"deletions":7,"binary":false,"changes":9,"status":"modified"},{"patch":"@@ -33,1 +33,1 @@\n-\/\/  Copyright (c) 1998-2022 Marti Maria Saguer\n+\/\/  Copyright (c) 1998-2020 Marti Maria Saguer\n","filename":"src\/java.desktop\/share\/native\/liblcms\/cmsmd5.c","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -33,1 +33,1 @@\n-\/\/  Copyright (c) 1998-2022 Marti Maria Saguer\n+\/\/  Copyright (c) 1998-2020 Marti Maria Saguer\n","filename":"src\/java.desktop\/share\/native\/liblcms\/cmsmtrx.c","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -33,1 +33,1 @@\n-\/\/  Copyright (c) 1998-2022 Marti Maria Saguer\n+\/\/  Copyright (c) 1998-2020 Marti Maria Saguer\n@@ -236,1 +236,1 @@\n-\/\/ In the case the user explicitly sets an empty string, we force a \\0\n+\/\/ In the case the user explicitely sets an empty string, we force a \\0\n@@ -574,1 +574,1 @@\n-    cmsNAMEDCOLORLIST* v;\n+    cmsNAMEDCOLORLIST* v = (cmsNAMEDCOLORLIST*) _cmsMallocZero(ContextID, sizeof(cmsNAMEDCOLORLIST));\n@@ -576,4 +576,0 @@\n-    if (ColorantCount > cmsMAXCHANNELS)\n-        return NULL;\n-\n-    v = (cmsNAMEDCOLORLIST*)_cmsMallocZero(ContextID, sizeof(cmsNAMEDCOLORLIST));\n@@ -677,1 +673,1 @@\n-\/\/ Info about a given color\n+\/\/ Info aboout a given color\n","filename":"src\/java.desktop\/share\/native\/liblcms\/cmsnamed.c","additions":4,"deletions":8,"binary":false,"changes":12,"status":"modified"},{"patch":"@@ -33,1 +33,1 @@\n-\/\/  Copyright (c) 1998-2022 Marti Maria Saguer\n+\/\/  Copyright (c) 1998-2020 Marti Maria Saguer\n@@ -679,0 +679,1 @@\n+    cmsStage* mpe;\n@@ -700,1 +701,1 @@\n-    nGridPoints = _cmsReasonableGridpointsByColorspace(ColorSpace, *dwFlags);\n+    nGridPoints      = _cmsReasonableGridpointsByColorspace(ColorSpace, *dwFlags);\n@@ -708,0 +709,7 @@\n+    \/\/ Named color pipelines cannot be optimized either\n+    for (mpe = cmsPipelineGetPtrToFirstStage(Src);\n+        mpe != NULL;\n+        mpe = cmsStageNext(mpe)) {\n+            if (cmsStageType(mpe) == cmsSigNamedColorElemType) return FALSE;\n+    }\n+\n@@ -1075,0 +1083,1 @@\n+    cmsStage* mpe;\n@@ -1096,0 +1105,7 @@\n+   \/\/ Named color pipelines cannot be optimized either\n+   for (mpe = cmsPipelineGetPtrToFirstStage(OriginalLut);\n+         mpe != NULL;\n+         mpe = cmsStageNext(mpe)) {\n+            if (cmsStageType(mpe) == cmsSigNamedColorElemType) return FALSE;\n+    }\n+\n@@ -1549,1 +1565,1 @@\n-\/\/ A fast matrix-shaper evaluator for 8 bits. This is a bit tricky since I'm using 1.14 signed fixed point\n+\/\/ A fast matrix-shaper evaluator for 8 bits. This is a bit ticky since I'm using 1.14 signed fixed point\n@@ -1552,1 +1568,1 @@\n-static CMS_NO_SANITIZE\n+static\n@@ -1934,1 +1950,0 @@\n-    cmsStage* mpe;\n@@ -1949,7 +1964,0 @@\n-    \/\/ Named color pipelines cannot be optimized\n-    for (mpe = cmsPipelineGetPtrToFirstStage(*PtrLut);\n-        mpe != NULL;\n-        mpe = cmsStageNext(mpe)) {\n-        if (cmsStageType(mpe) == cmsSigNamedColorElemType) return FALSE;\n-    }\n-\n","filename":"src\/java.desktop\/share\/native\/liblcms\/cmsopt.c","additions":20,"deletions":12,"binary":false,"changes":32,"status":"modified"},{"patch":"@@ -33,1 +33,1 @@\n-\/\/  Copyright (c) 1998-2022 Marti Maria Saguer\n+\/\/  Copyright (c) 1998-2020 Marti Maria Saguer\n@@ -111,1 +111,0 @@\n-#define ANYPREMUL       PREMUL_SH(1)\n@@ -135,2 +134,0 @@\n-    cmsUInt32Number Premul     = T_PREMUL(info->InputFormat);\n-\n@@ -138,1 +135,1 @@\n-    cmsUInt32Number v;\n+    cmsUInt16Number v;\n@@ -140,1 +137,0 @@\n-    cmsUInt32Number alpha_factor = 1;\n@@ -143,4 +139,0 @@\n-\n-        if (Premul && Extra)\n-            alpha_factor = _cmsToFixedDomain(FROM_8_TO_16(accum[0]));\n-\n@@ -149,5 +141,0 @@\n-    else\n-    {\n-        if (Premul && Extra)\n-            alpha_factor = _cmsToFixedDomain(FROM_8_TO_16(accum[nChan]));\n-    }\n@@ -156,1 +143,0 @@\n-\n@@ -161,8 +147,1 @@\n-\n-        if (Premul && alpha_factor > 0)\n-        {\n-            v = ((cmsUInt32Number)((cmsUInt32Number)v << 16) \/ alpha_factor);\n-            if (v > 0xffff) v = 0xffff;\n-        }\n-\n-        wIn[index] = (cmsUInt16Number) v;\n+        wIn[index] = v;\n@@ -190,1 +169,0 @@\n-\n@@ -203,3 +181,0 @@\n-    cmsUInt32Number ExtraFirst = DoSwap ^ SwapFirst;\n-    cmsUInt32Number Extra = T_EXTRA(info->InputFormat);\n-    cmsUInt32Number Premul = T_PREMUL(info->InputFormat);\n@@ -207,6 +182,0 @@\n-    cmsUInt32Number alpha_factor = 1;\n-\n-    if (ExtraFirst) {\n-\n-        if (Premul && Extra)\n-            alpha_factor = _cmsToFixedDomain(FROM_8_TO_16(accum[0]));\n@@ -214,7 +183,2 @@\n-\n-        accum += Extra * Stride;\n-    }\n-    else\n-    {\n-        if (Premul && Extra)\n-            alpha_factor = _cmsToFixedDomain(FROM_8_TO_16(accum[(nChan) * Stride]));\n+    if (DoSwap ^ SwapFirst) {\n+        accum += T_EXTRA(info -> InputFormat) * Stride;\n@@ -226,1 +190,1 @@\n-        cmsUInt32Number v = FROM_8_TO_16(*accum);\n+        cmsUInt16Number v = FROM_8_TO_16(*accum);\n@@ -228,9 +192,1 @@\n-        v = Reverse ? REVERSE_FLAVOR_16(v) : v;\n-\n-        if (Premul && alpha_factor > 0)\n-        {\n-            v = ((cmsUInt32Number)((cmsUInt32Number)v << 16) \/ alpha_factor);\n-            if (v > 0xffff) v = 0xffff;\n-        }\n-\n-        wIn[index] = (cmsUInt16Number) v;\n+        wIn[index] = Reverse ? REVERSE_FLAVOR_16(v) : v;\n@@ -243,1 +199,0 @@\n-\n@@ -594,52 +549,0 @@\n-\n-static\n-cmsUInt8Number* UnrollAnyWordsPremul(CMSREGISTER _cmsTRANSFORM* info,\n-                                     CMSREGISTER cmsUInt16Number wIn[],\n-                                     CMSREGISTER cmsUInt8Number* accum,\n-                                     CMSREGISTER cmsUInt32Number Stride)\n-{\n-   cmsUInt32Number nChan       = T_CHANNELS(info -> InputFormat);\n-   cmsUInt32Number SwapEndian  = T_ENDIAN16(info -> InputFormat);\n-   cmsUInt32Number DoSwap      = T_DOSWAP(info ->InputFormat);\n-   cmsUInt32Number Reverse     = T_FLAVOR(info ->InputFormat);\n-   cmsUInt32Number SwapFirst   = T_SWAPFIRST(info -> InputFormat);\n-   cmsUInt32Number ExtraFirst  = DoSwap ^ SwapFirst;\n-   cmsUInt32Number i;\n-\n-   cmsUInt16Number alpha = (ExtraFirst ? accum[0] : accum[nChan - 1]);\n-   cmsUInt32Number alpha_factor = _cmsToFixedDomain(FROM_8_TO_16(alpha));\n-\n-    if (ExtraFirst) {\n-        accum += sizeof(cmsUInt16Number);\n-    }\n-\n-    for (i=0; i < nChan; i++) {\n-\n-        cmsUInt32Number index = DoSwap ? (nChan - i - 1) : i;\n-        cmsUInt32Number v = *(cmsUInt16Number*) accum;\n-\n-        if (SwapEndian)\n-            v = CHANGE_ENDIAN(v);\n-\n-        if (alpha_factor > 0) {\n-\n-            v = (v << 16) \/ alpha_factor;\n-            if (v > 0xffff) v = 0xffff;\n-        }\n-\n-        wIn[index] = (cmsUInt16Number) (Reverse ? REVERSE_FLAVOR_16(v) : v);\n-\n-        accum += sizeof(cmsUInt16Number);\n-    }\n-\n-    if (!ExtraFirst) {\n-        accum += sizeof(cmsUInt16Number);\n-    }\n-\n-    return accum;\n-\n-    cmsUNUSED_PARAMETER(Stride);\n-}\n-\n-\n-\n@@ -679,43 +582,0 @@\n-static\n-cmsUInt8Number* UnrollPlanarWordsPremul(CMSREGISTER _cmsTRANSFORM* info,\n-                                        CMSREGISTER cmsUInt16Number wIn[],\n-                                        CMSREGISTER cmsUInt8Number* accum,\n-                                        CMSREGISTER cmsUInt32Number Stride)\n-{\n-    cmsUInt32Number nChan = T_CHANNELS(info -> InputFormat);\n-    cmsUInt32Number DoSwap= T_DOSWAP(info ->InputFormat);\n-    cmsUInt32Number SwapFirst = T_SWAPFIRST(info->InputFormat);\n-    cmsUInt32Number Reverse= T_FLAVOR(info ->InputFormat);\n-    cmsUInt32Number SwapEndian = T_ENDIAN16(info -> InputFormat);\n-    cmsUInt32Number i;\n-    cmsUInt32Number ExtraFirst = DoSwap ^ SwapFirst;\n-    cmsUInt8Number* Init = accum;\n-\n-    cmsUInt16Number  alpha = (ExtraFirst ? accum[0] : accum[(nChan - 1) * Stride]);\n-    cmsUInt32Number alpha_factor = _cmsToFixedDomain(FROM_8_TO_16(alpha));\n-\n-    if (ExtraFirst) {\n-        accum += Stride;\n-    }\n-\n-    for (i=0; i < nChan; i++) {\n-\n-        cmsUInt32Number index = DoSwap ? (nChan - i - 1) : i;\n-        cmsUInt32Number v = (cmsUInt32Number) *(cmsUInt16Number*) accum;\n-\n-        if (SwapEndian)\n-            v = CHANGE_ENDIAN(v);\n-\n-        if (alpha_factor > 0) {\n-\n-            v = (v << 16) \/ alpha_factor;\n-            if (v > 0xffff) v = 0xffff;\n-        }\n-\n-        wIn[index] = (cmsUInt16Number) (Reverse ? REVERSE_FLAVOR_16(v) : v);\n-\n-        accum +=  Stride;\n-    }\n-\n-    return (Init + sizeof(cmsUInt16Number));\n-}\n@@ -1259,104 +1119,0 @@\n-\/\/ For anything going from cmsUInt8Number\n-static\n-cmsUInt8Number* Unroll8ToFloat(_cmsTRANSFORM* info,\n-                               cmsFloat32Number wIn[],\n-                               cmsUInt8Number* accum,\n-                               cmsUInt32Number Stride)\n-{\n-\n-    cmsUInt32Number nChan = T_CHANNELS(info->InputFormat);\n-    cmsUInt32Number DoSwap = T_DOSWAP(info->InputFormat);\n-    cmsUInt32Number Reverse = T_FLAVOR(info->InputFormat);\n-    cmsUInt32Number SwapFirst = T_SWAPFIRST(info->InputFormat);\n-    cmsUInt32Number Extra = T_EXTRA(info->InputFormat);\n-    cmsUInt32Number ExtraFirst = DoSwap ^ SwapFirst;\n-    cmsUInt32Number Planar = T_PLANAR(info->InputFormat);\n-    cmsFloat32Number v;\n-    cmsUInt32Number i, start = 0;\n-\n-    Stride \/= PixelSize(info->InputFormat);\n-\n-    if (ExtraFirst)\n-        start = Extra;\n-\n-    for (i = 0; i < nChan; i++) {\n-\n-        cmsUInt32Number index = DoSwap ? (nChan - i - 1) : i;\n-\n-        if (Planar)\n-            v = (cmsFloat32Number) ((cmsUInt8Number *)accum)[(i + start) * Stride];\n-        else\n-            v = (cmsFloat32Number) ((cmsUInt8Number *)accum)[i + start];\n-\n-        v \/= 255.0F;\n-\n-        wIn[index] = Reverse ? 1 - v : v;\n-    }\n-\n-\n-    if (Extra == 0 && SwapFirst) {\n-        cmsFloat32Number tmp = wIn[0];\n-\n-        memmove(&wIn[0], &wIn[1], (nChan - 1) * sizeof(cmsFloat32Number));\n-        wIn[nChan - 1] = tmp;\n-    }\n-\n-    if (T_PLANAR(info->InputFormat))\n-        return accum + sizeof(cmsUInt8Number);\n-    else\n-        return accum + (nChan + Extra) * sizeof(cmsUInt8Number);\n-}\n-\n-\n-\/\/ For anything going from cmsUInt16Number\n-static\n-cmsUInt8Number* Unroll16ToFloat(_cmsTRANSFORM* info,\n-                                cmsFloat32Number wIn[],\n-                                cmsUInt8Number* accum,\n-                                cmsUInt32Number Stride)\n-{\n-\n-    cmsUInt32Number nChan = T_CHANNELS(info->InputFormat);\n-    cmsUInt32Number DoSwap = T_DOSWAP(info->InputFormat);\n-    cmsUInt32Number Reverse = T_FLAVOR(info->InputFormat);\n-    cmsUInt32Number SwapFirst = T_SWAPFIRST(info->InputFormat);\n-    cmsUInt32Number Extra = T_EXTRA(info->InputFormat);\n-    cmsUInt32Number ExtraFirst = DoSwap ^ SwapFirst;\n-    cmsUInt32Number Planar = T_PLANAR(info->InputFormat);\n-    cmsFloat32Number v;\n-    cmsUInt32Number i, start = 0;\n-\n-    Stride \/= PixelSize(info->InputFormat);\n-\n-    if (ExtraFirst)\n-        start = Extra;\n-\n-    for (i = 0; i < nChan; i++) {\n-\n-        cmsUInt32Number index = DoSwap ? (nChan - i - 1) : i;\n-\n-        if (Planar)\n-            v = (cmsFloat32Number)((cmsUInt16Number*)accum)[(i + start) * Stride];\n-        else\n-            v = (cmsFloat32Number)((cmsUInt16Number*)accum)[i + start];\n-\n-        v \/= 65535.0F;\n-\n-        wIn[index] = Reverse ? 1 - v : v;\n-    }\n-\n-\n-    if (Extra == 0 && SwapFirst) {\n-        cmsFloat32Number tmp = wIn[0];\n-\n-        memmove(&wIn[0], &wIn[1], (nChan - 1) * sizeof(cmsFloat32Number));\n-        wIn[nChan - 1] = tmp;\n-    }\n-\n-    if (T_PLANAR(info->InputFormat))\n-        return accum + sizeof(cmsUInt16Number);\n-    else\n-        return accum + (nChan + Extra) * sizeof(cmsUInt16Number);\n-}\n-\n-\n@@ -1371,5 +1127,5 @@\n-    cmsUInt32Number nChan = T_CHANNELS(info->InputFormat);\n-    cmsUInt32Number DoSwap = T_DOSWAP(info->InputFormat);\n-    cmsUInt32Number Reverse = T_FLAVOR(info->InputFormat);\n-    cmsUInt32Number SwapFirst = T_SWAPFIRST(info->InputFormat);\n-    cmsUInt32Number Extra = T_EXTRA(info->InputFormat);\n+    cmsUInt32Number nChan  = T_CHANNELS(info -> InputFormat);\n+    cmsUInt32Number DoSwap   = T_DOSWAP(info ->InputFormat);\n+    cmsUInt32Number Reverse    = T_FLAVOR(info ->InputFormat);\n+    cmsUInt32Number SwapFirst  = T_SWAPFIRST(info -> InputFormat);\n+    cmsUInt32Number Extra   = T_EXTRA(info -> InputFormat);\n@@ -1377,2 +1133,1 @@\n-    cmsUInt32Number Planar = T_PLANAR(info->InputFormat);\n-    cmsUInt32Number Premul = T_PREMUL(info->InputFormat);\n+    cmsUInt32Number Planar     = T_PLANAR(info -> InputFormat);\n@@ -1381,3 +1136,1 @@\n-    cmsFloat32Number maximum = IsInkSpace(info->InputFormat) ? 100.0F : 1.0F;\n-    cmsFloat32Number alpha_factor = 1.0f;\n-    cmsFloat32Number* ptr = (cmsFloat32Number*)accum;\n+    cmsFloat32Number maximum = IsInkSpace(info ->InputFormat) ? 100.0F : 1.0F;\n@@ -1387,8 +1140,0 @@\n-    if (Premul && Extra)\n-    {\n-        if (Planar)\n-            alpha_factor = (ExtraFirst ? ptr[0] : ptr[nChan * Stride]) \/ maximum;\n-        else\n-            alpha_factor = (ExtraFirst ? ptr[0] : ptr[nChan]) \/ maximum;\n-    }\n-\n@@ -1403,1 +1148,1 @@\n-            v = ptr[(i + start) * Stride];\n+            v = (cmsFloat32Number) ((cmsFloat32Number*) accum)[(i + start) * Stride];\n@@ -1405,4 +1150,1 @@\n-            v = ptr[i + start];\n-\n-        if (Premul && alpha_factor > 0)\n-            v \/= alpha_factor;\n+            v = (cmsFloat32Number) ((cmsFloat32Number*) accum)[i + start];\n@@ -1438,5 +1180,5 @@\n-    cmsUInt32Number nChan = T_CHANNELS(info->InputFormat);\n-    cmsUInt32Number DoSwap = T_DOSWAP(info->InputFormat);\n-    cmsUInt32Number Reverse = T_FLAVOR(info->InputFormat);\n-    cmsUInt32Number SwapFirst = T_SWAPFIRST(info->InputFormat);\n-    cmsUInt32Number Extra = T_EXTRA(info->InputFormat);\n+    cmsUInt32Number nChan  = T_CHANNELS(info -> InputFormat);\n+    cmsUInt32Number DoSwap   = T_DOSWAP(info ->InputFormat);\n+    cmsUInt32Number Reverse    = T_FLAVOR(info ->InputFormat);\n+    cmsUInt32Number SwapFirst  = T_SWAPFIRST(info -> InputFormat);\n+    cmsUInt32Number Extra   = T_EXTRA(info -> InputFormat);\n@@ -1444,2 +1186,1 @@\n-    cmsUInt32Number Planar = T_PLANAR(info->InputFormat);\n-    cmsUInt32Number Premul = T_PREMUL(info->InputFormat);\n+    cmsUInt32Number Planar     = T_PLANAR(info -> InputFormat);\n@@ -1449,2 +1190,0 @@\n-    cmsFloat64Number alpha_factor = 1.0;\n-    cmsFloat64Number* ptr = (cmsFloat64Number*)accum;\n@@ -1454,8 +1193,0 @@\n-    if (Premul && Extra)\n-    {\n-        if (Planar)\n-            alpha_factor = (ExtraFirst ? ptr[0] : ptr[(nChan) * Stride]) \/ maximum;\n-        else\n-            alpha_factor = (ExtraFirst ? ptr[0] : ptr[nChan]) \/ maximum;\n-    }\n-\n@@ -1474,4 +1205,0 @@\n-\n-        if (Premul && alpha_factor > 0)\n-            v \/= alpha_factor;\n-\n@@ -1559,0 +1286,2 @@\n+\n+\n@@ -1619,73 +1348,0 @@\n-cmsINLINE void lab4toFloat(cmsFloat32Number wIn[], cmsUInt16Number lab4[3])\n-{\n-    cmsFloat32Number L = (cmsFloat32Number) lab4[0] \/ 655.35F;\n-    cmsFloat32Number a = ((cmsFloat32Number) lab4[1] \/ 257.0F) - 128.0F;\n-    cmsFloat32Number b = ((cmsFloat32Number) lab4[2] \/ 257.0F) - 128.0F;\n-\n-    wIn[0] = (L \/ 100.0F);                    \/\/ from 0..100 to 0..1\n-    wIn[1] = ((a + 128.0F) \/ 255.0F);         \/\/ form -128..+127 to 0..1\n-    wIn[2] = ((b + 128.0F) \/ 255.0F);\n-\n-}\n-\n-static\n-cmsUInt8Number* UnrollLabV2_8ToFloat(_cmsTRANSFORM* info,\n-                                      cmsFloat32Number wIn[],\n-                                      cmsUInt8Number* accum,\n-                                      cmsUInt32Number Stride)\n-{\n-    cmsUInt16Number lab4[3];\n-\n-    lab4[0] = FomLabV2ToLabV4(FROM_8_TO_16(*accum)); accum++;     \/\/ L\n-    lab4[1] = FomLabV2ToLabV4(FROM_8_TO_16(*accum)); accum++;     \/\/ a\n-    lab4[2] = FomLabV2ToLabV4(FROM_8_TO_16(*accum)); accum++;     \/\/ b\n-\n-    lab4toFloat(wIn, lab4);\n-\n-    return accum;\n-\n-    cmsUNUSED_PARAMETER(info);\n-    cmsUNUSED_PARAMETER(Stride);\n-}\n-\n-static\n-cmsUInt8Number* UnrollALabV2_8ToFloat(_cmsTRANSFORM* info,\n-                                      cmsFloat32Number wIn[],\n-                                      cmsUInt8Number* accum,\n-                                      cmsUInt32Number Stride)\n-{\n-    cmsUInt16Number lab4[3];\n-\n-    accum++;  \/\/ A\n-    lab4[0] = FomLabV2ToLabV4(FROM_8_TO_16(*accum)); accum++;     \/\/ L\n-    lab4[1] = FomLabV2ToLabV4(FROM_8_TO_16(*accum)); accum++;     \/\/ a\n-    lab4[2] = FomLabV2ToLabV4(FROM_8_TO_16(*accum)); accum++;     \/\/ b\n-\n-    lab4toFloat(wIn, lab4);\n-\n-    return accum;\n-\n-    cmsUNUSED_PARAMETER(info);\n-    cmsUNUSED_PARAMETER(Stride);\n-}\n-\n-static\n-cmsUInt8Number* UnrollLabV2_16ToFloat(_cmsTRANSFORM* info,\n-                                      cmsFloat32Number wIn[],\n-                                      cmsUInt8Number* accum,\n-                                      cmsUInt32Number Stride)\n-{\n-    cmsUInt16Number lab4[3];\n-\n-    lab4[0] = FomLabV2ToLabV4(*(cmsUInt16Number*) accum); accum += 2;     \/\/ L\n-    lab4[1] = FomLabV2ToLabV4(*(cmsUInt16Number*) accum); accum += 2;     \/\/ a\n-    lab4[2] = FomLabV2ToLabV4(*(cmsUInt16Number*) accum); accum += 2;     \/\/ b\n-\n-    lab4toFloat(wIn, lab4);\n-\n-    return accum;\n-\n-    cmsUNUSED_PARAMETER(info);\n-    cmsUNUSED_PARAMETER(Stride);\n-}\n-\n@@ -1697,0 +1353,1 @@\n+\n@@ -1698,4 +1355,4 @@\n-cmsUInt8Number* PackChunkyBytes(CMSREGISTER _cmsTRANSFORM* info,\n-                                CMSREGISTER cmsUInt16Number wOut[],\n-                                CMSREGISTER cmsUInt8Number* output,\n-                                CMSREGISTER cmsUInt32Number Stride)\n+cmsUInt8Number* PackAnyBytes(CMSREGISTER _cmsTRANSFORM* info,\n+                             CMSREGISTER cmsUInt16Number wOut[],\n+                             CMSREGISTER cmsUInt8Number* output,\n+                             CMSREGISTER cmsUInt32Number Stride)\n@@ -1703,6 +1360,5 @@\n-    cmsUInt32Number nChan = T_CHANNELS(info->OutputFormat);\n-    cmsUInt32Number DoSwap = T_DOSWAP(info->OutputFormat);\n-    cmsUInt32Number Reverse = T_FLAVOR(info->OutputFormat);\n-    cmsUInt32Number Extra = T_EXTRA(info->OutputFormat);\n-    cmsUInt32Number SwapFirst = T_SWAPFIRST(info->OutputFormat);\n-    cmsUInt32Number Premul = T_PREMUL(info->OutputFormat);\n+    cmsUInt32Number nChan  = T_CHANNELS(info -> OutputFormat);\n+    cmsUInt32Number DoSwap   = T_DOSWAP(info ->OutputFormat);\n+    cmsUInt32Number Reverse    = T_FLAVOR(info ->OutputFormat);\n+    cmsUInt32Number Extra   = T_EXTRA(info -> OutputFormat);\n+    cmsUInt32Number SwapFirst  = T_SWAPFIRST(info -> OutputFormat);\n@@ -1711,1 +1367,1 @@\n-    cmsUInt16Number v = 0;\n+    cmsUInt8Number v = 0;\n@@ -1713,1 +1369,0 @@\n-    cmsUInt32Number alpha_factor = 0;\n@@ -1718,4 +1373,0 @@\n-\n-        if (Premul && Extra)\n-            alpha_factor = _cmsToFixedDomain(FROM_8_TO_16(output[0]));\n-\n@@ -1724,5 +1375,0 @@\n-    else\n-    {\n-        if (Premul && Extra)\n-            alpha_factor = _cmsToFixedDomain(FROM_8_TO_16(output[nChan]));\n-    }\n@@ -1734,1 +1380,1 @@\n-        v = wOut[index];\n+        v = FROM_16_TO_8(wOut[index]);\n@@ -1737,6 +1383,1 @@\n-            v = REVERSE_FLAVOR_16(v);\n-\n-        if (Premul && alpha_factor != 0)\n-        {\n-            v = (cmsUInt16Number)((cmsUInt32Number)((cmsUInt32Number)v * alpha_factor + 0x8000) >> 16);\n-        }\n+            v = REVERSE_FLAVOR_8(v);\n@@ -1744,1 +1385,1 @@\n-        *output++ = FROM_16_TO_8(v);\n+        *output++ = v;\n@@ -1754,1 +1395,1 @@\n-        *swap1 = FROM_16_TO_8(v);\n+        *swap1 = v;\n@@ -1757,0 +1398,1 @@\n+\n@@ -1762,0 +1404,2 @@\n+\n+\n@@ -1763,4 +1407,4 @@\n-cmsUInt8Number* PackChunkyWords(CMSREGISTER _cmsTRANSFORM* info,\n-                                CMSREGISTER cmsUInt16Number wOut[],\n-                                CMSREGISTER cmsUInt8Number* output,\n-                                CMSREGISTER cmsUInt32Number Stride)\n+cmsUInt8Number* PackAnyWords(CMSREGISTER _cmsTRANSFORM* info,\n+                             CMSREGISTER cmsUInt16Number wOut[],\n+                             CMSREGISTER cmsUInt8Number* output,\n+                             CMSREGISTER cmsUInt32Number Stride)\n@@ -1768,7 +1412,6 @@\n-    cmsUInt32Number nChan = T_CHANNELS(info->OutputFormat);\n-    cmsUInt32Number SwapEndian = T_ENDIAN16(info->OutputFormat);\n-    cmsUInt32Number DoSwap = T_DOSWAP(info->OutputFormat);\n-    cmsUInt32Number Reverse = T_FLAVOR(info->OutputFormat);\n-    cmsUInt32Number Extra = T_EXTRA(info->OutputFormat);\n-    cmsUInt32Number SwapFirst = T_SWAPFIRST(info->OutputFormat);\n-    cmsUInt32Number Premul = T_PREMUL(info->OutputFormat);\n+    cmsUInt32Number nChan  = T_CHANNELS(info -> OutputFormat);\n+    cmsUInt32Number SwapEndian = T_ENDIAN16(info -> OutputFormat);\n+    cmsUInt32Number DoSwap   = T_DOSWAP(info ->OutputFormat);\n+    cmsUInt32Number Reverse    = T_FLAVOR(info ->OutputFormat);\n+    cmsUInt32Number Extra   = T_EXTRA(info -> OutputFormat);\n+    cmsUInt32Number SwapFirst  = T_SWAPFIRST(info -> OutputFormat);\n@@ -1779,1 +1422,0 @@\n-    cmsUInt32Number alpha_factor = 0;\n@@ -1784,4 +1426,0 @@\n-\n-        if (Premul && Extra)\n-            alpha_factor = _cmsToFixedDomain(*(cmsUInt16Number*) output);\n-\n@@ -1790,5 +1428,0 @@\n-    else\n-    {\n-        if (Premul && Extra)\n-            alpha_factor = _cmsToFixedDomain(((cmsUInt16Number*) output)[nChan]);\n-    }\n@@ -1808,5 +1441,0 @@\n-        if (Premul && alpha_factor != 0)\n-        {\n-            v = (cmsUInt16Number)((cmsUInt32Number)((cmsUInt32Number)v * alpha_factor + 0x8000) >> 16);\n-        }\n-\n@@ -1828,0 +1456,1 @@\n+\n@@ -1834,1 +1463,0 @@\n-\n@@ -1841,7 +1469,4 @@\n-    cmsUInt32Number nChan = T_CHANNELS(info->OutputFormat);\n-    cmsUInt32Number DoSwap = T_DOSWAP(info->OutputFormat);\n-    cmsUInt32Number SwapFirst = T_SWAPFIRST(info->OutputFormat);\n-    cmsUInt32Number Reverse = T_FLAVOR(info->OutputFormat);\n-    cmsUInt32Number Extra = T_EXTRA(info->OutputFormat);\n-    cmsUInt32Number ExtraFirst = DoSwap ^ SwapFirst;\n-    cmsUInt32Number Premul = T_PREMUL(info->OutputFormat);\n+    cmsUInt32Number nChan     = T_CHANNELS(info -> OutputFormat);\n+    cmsUInt32Number DoSwap    = T_DOSWAP(info ->OutputFormat);\n+    cmsUInt32Number SwapFirst = T_SWAPFIRST(info ->OutputFormat);\n+    cmsUInt32Number Reverse   = T_FLAVOR(info ->OutputFormat);\n@@ -1850,4 +1475,0 @@\n-    cmsUInt32Number alpha_factor = 0;\n-\n-\n-    if (ExtraFirst) {\n@@ -1855,2 +1476,0 @@\n-        if (Premul && Extra)\n-            alpha_factor = _cmsToFixedDomain(FROM_8_TO_16(output[0]));\n@@ -1858,6 +1477,2 @@\n-        output += Extra * Stride;\n-    }\n-    else\n-    {\n-        if (Premul && Extra)\n-            alpha_factor = _cmsToFixedDomain(FROM_8_TO_16(output[nChan * Stride]));\n+    if (DoSwap ^ SwapFirst) {\n+        output += T_EXTRA(info -> OutputFormat) * Stride;\n@@ -1870,11 +1485,1 @@\n-        cmsUInt16Number v = wOut[index];\n-\n-        if (Reverse)\n-            v = REVERSE_FLAVOR_16(v);\n-\n-        if (Premul && alpha_factor != 0)\n-        {\n-            v = (cmsUInt16Number)((cmsUInt32Number)((cmsUInt32Number)v * alpha_factor + 0x8000) >> 16);\n-        }\n-\n-        *(cmsUInt8Number*)output = FROM_16_TO_8(v);\n+        cmsUInt8Number v = FROM_16_TO_8(wOut[index]);\n@@ -1882,0 +1487,1 @@\n+        *(cmsUInt8Number*)  output = (cmsUInt8Number) (Reverse ? REVERSE_FLAVOR_8(v) : v);\n@@ -1897,8 +1503,4 @@\n-    cmsUInt32Number nChan = T_CHANNELS(info->OutputFormat);\n-    cmsUInt32Number DoSwap = T_DOSWAP(info->OutputFormat);\n-    cmsUInt32Number SwapFirst = T_SWAPFIRST(info->OutputFormat);\n-    cmsUInt32Number Reverse = T_FLAVOR(info->OutputFormat);\n-    cmsUInt32Number Extra = T_EXTRA(info->OutputFormat);\n-    cmsUInt32Number ExtraFirst = DoSwap ^ SwapFirst;\n-    cmsUInt32Number Premul = T_PREMUL(info->OutputFormat);\n-    cmsUInt32Number SwapEndian = T_ENDIAN16(info->OutputFormat);\n+    cmsUInt32Number nChan      = T_CHANNELS(info -> OutputFormat);\n+    cmsUInt32Number DoSwap     = T_DOSWAP(info ->OutputFormat);\n+    cmsUInt32Number Reverse    = T_FLAVOR(info ->OutputFormat);\n+    cmsUInt32Number SwapEndian = T_ENDIAN16(info -> OutputFormat);\n@@ -1908,6 +1510,0 @@\n-    cmsUInt32Number alpha_factor = 0;\n-\n-    if (ExtraFirst) {\n-\n-        if (Premul && Extra)\n-            alpha_factor = _cmsToFixedDomain(((cmsUInt16Number*) output)[0]);\n@@ -1915,6 +1511,2 @@\n-        output += Extra * Stride;\n-    }\n-    else\n-    {\n-        if (Premul && Extra)\n-            alpha_factor = _cmsToFixedDomain(((cmsUInt16Number*)output)[nChan * Stride]);\n+    if (DoSwap) {\n+        output += T_EXTRA(info -> OutputFormat) * Stride;\n@@ -1935,5 +1527,0 @@\n-        if (Premul && alpha_factor != 0)\n-        {\n-            v = (cmsUInt16Number)((cmsUInt32Number)((cmsUInt32Number)v * alpha_factor + 0x8000) >> 16);\n-        }\n-\n@@ -3086,0 +2673,4 @@\n+\n+\n+\n+\n@@ -3470,1 +3061,1 @@\n-    { BYTES_SH(1)|PLANAR_SH(1), ANYFLAVOR|ANYSWAPFIRST|ANYPREMUL|\n+    { BYTES_SH(1)|PLANAR_SH(1), ANYFLAVOR|ANYSWAPFIRST|\n@@ -3473,1 +3064,1 @@\n-    { BYTES_SH(1),    ANYFLAVOR|ANYSWAPFIRST|ANYSWAP|ANYPREMUL|\n+    { BYTES_SH(1),    ANYFLAVOR|ANYSWAPFIRST|ANYSWAP|\n@@ -3495,4 +3086,0 @@\n-\n-    { BYTES_SH(2)|PLANAR_SH(1),  ANYFLAVOR|ANYSWAP|ANYENDIAN|ANYEXTRA|ANYCHANNELS|ANYSPACE|PREMUL_SH(1),  UnrollPlanarWordsPremul},\n-    { BYTES_SH(2),  ANYFLAVOR|ANYSWAPFIRST|ANYSWAP|ANYENDIAN|ANYEXTRA|ANYCHANNELS|ANYSPACE|PREMUL_SH(1),  UnrollAnyWordsPremul}\n-\n@@ -3514,1 +3101,1 @@\n-                                            ANYPREMUL|ANYCHANNELS|ANYSPACE,  UnrollFloatsToFloat},\n+                                                      ANYCHANNELS|ANYSPACE,  UnrollFloatsToFloat},\n@@ -3517,11 +3104,1 @@\n-                                              ANYCHANNELS|ANYSPACE|ANYPREMUL, UnrollDoublesToFloat},\n-\n-    {     TYPE_LabV2_8,                                                   0,  UnrollLabV2_8ToFloat },\n-    {     TYPE_ALabV2_8,                                                  0,  UnrollALabV2_8ToFloat },\n-    {     TYPE_LabV2_16,                                                  0,  UnrollLabV2_16ToFloat },\n-\n-    {     BYTES_SH(1),              ANYPLANAR|ANYSWAPFIRST|ANYSWAP|ANYEXTRA|\n-                                                        ANYCHANNELS|ANYSPACE, Unroll8ToFloat},\n-\n-    {     BYTES_SH(2),              ANYPLANAR|ANYSWAPFIRST|ANYSWAP|ANYEXTRA|\n-                                                        ANYCHANNELS|ANYSPACE, Unroll16ToFloat},\n+                                                        ANYCHANNELS|ANYSPACE,  UnrollDoublesToFloat},\n@@ -3530,1 +3107,1 @@\n-                                                        ANYCHANNELS|ANYSPACE, UnrollHalfToFloat},\n+                                                        ANYCHANNELS|ANYSPACE,  UnrollHalfToFloat},\n@@ -3624,0 +3201,2 @@\n+    { CHANNELS_SH(6)|BYTES_SH(1),                                  ANYSPACE,  Pack6Bytes},\n+    { CHANNELS_SH(6)|BYTES_SH(1)|DOSWAP_SH(1),                     ANYSPACE,  Pack6BytesSwap},\n@@ -3629,8 +3208,0 @@\n-    { CHANNELS_SH(6)|BYTES_SH(1),                                  ANYSPACE,  Pack6Bytes},\n-    { CHANNELS_SH(6)|BYTES_SH(1)|DOSWAP_SH(1),                     ANYSPACE,  Pack6BytesSwap},\n-\n-    { BYTES_SH(1),    ANYFLAVOR|ANYSWAPFIRST|ANYSWAP|ANYEXTRA|ANYCHANNELS|\n-                                                          ANYSPACE|ANYPREMUL, PackChunkyBytes},\n-\n-    { BYTES_SH(1)|PLANAR_SH(1),    ANYFLAVOR|ANYSWAPFIRST|ANYSWAP|ANYEXTRA|\n-                                              ANYCHANNELS|ANYSPACE|ANYPREMUL, PackPlanarBytes},\n@@ -3638,0 +3209,2 @@\n+    { BYTES_SH(1),                 ANYFLAVOR|ANYSWAPFIRST|ANYSWAP|ANYEXTRA|ANYCHANNELS|ANYSPACE, PackAnyBytes},\n+    { BYTES_SH(1)|PLANAR_SH(1),    ANYFLAVOR|ANYSWAPFIRST|ANYSWAP|ANYEXTRA|ANYCHANNELS|ANYSPACE, PackPlanarBytes},\n@@ -3662,4 +3235,2 @@\n-    { BYTES_SH(2),                  ANYFLAVOR|ANYSWAPFIRST|ANYSWAP|ANYENDIAN|\n-                                     ANYEXTRA|ANYCHANNELS|ANYSPACE|ANYPREMUL, PackChunkyWords},\n-    { BYTES_SH(2)|PLANAR_SH(1),     ANYFLAVOR|ANYENDIAN|ANYSWAP|ANYEXTRA|\n-                                     ANYCHANNELS|ANYSPACE|ANYPREMUL,          PackPlanarWords}\n+    { BYTES_SH(2)|PLANAR_SH(1),     ANYFLAVOR|ANYENDIAN|ANYSWAP|ANYEXTRA|ANYCHANNELS|ANYSPACE, PackPlanarWords},\n+    { BYTES_SH(2),                  ANYFLAVOR|ANYSWAPFIRST|ANYSWAP|ANYENDIAN|ANYEXTRA|ANYCHANNELS|ANYSPACE, PackAnyWords}\n@@ -3837,5 +3408,0 @@\n-    if (T_CHANNELS(Type) == 0) {\n-        static const cmsFormatter nullFormatter = { 0 };\n-        return nullFormatter;\n-    }\n-\n@@ -3876,1 +3442,1 @@\n-    cmsInt32Number         nOutputChans    = cmsChannelsOfColorSpace(ColorSpace);\n+    cmsUInt32Number        nOutputChans    = cmsChannelsOf(ColorSpace);\n@@ -3879,3 +3445,0 @@\n-    \/\/ Unsupported color space?\n-    if (nOutputChans < 0) return 0;\n-\n@@ -3896,3 +3459,0 @@\n-    \/\/ Unsupported color space?\n-    if (nOutputChans < 0) return 0;\n-\n","filename":"src\/java.desktop\/share\/native\/liblcms\/cmspack.c","additions":83,"deletions":523,"binary":false,"changes":606,"status":"modified"},{"patch":"@@ -33,1 +33,1 @@\n-\/\/  Copyright (c) 1998-2022 Marti Maria Saguer\n+\/\/  Copyright (c) 1998-2020 Marti Maria Saguer\n@@ -906,1 +906,1 @@\n-cmsInt32Number CMSEXPORT cmsChannelsOfColorSpace(cmsColorSpaceSignature ColorSpace)\n+cmsUInt32Number CMSEXPORT cmsChannelsOf(cmsColorSpaceSignature ColorSpace)\n@@ -967,1 +967,1 @@\n-    default: return -1;\n+    default: return 3;\n@@ -970,10 +970,0 @@\n-\n-\/**\n-* DEPRECATED: Provided for compatibility only\n-*\/\n-cmsUInt32Number CMSEXPORT cmsChannelsOf(cmsColorSpaceSignature ColorSpace)\n-{\n-    int n = cmsChannelsOfColorSpace(ColorSpace);\n-    if (n < 0) return 3;\n-    return (cmsUInt32Number)n;\n-}\n\\ No newline at end of file\n","filename":"src\/java.desktop\/share\/native\/liblcms\/cmspcs.c","additions":3,"deletions":13,"binary":false,"changes":16,"status":"modified"},{"patch":"@@ -33,1 +33,1 @@\n-\/\/  Copyright (c) 1998-2022 Marti Maria Saguer\n+\/\/  Copyright (c) 1998-2020 Marti Maria Saguer\n@@ -200,4 +200,1 @@\n-    union typeConverter {\n-        cmsUInt32Number integer;\n-        cmsFloat32Number floating_point;\n-    } tmp;\n+    cmsUInt32Number tmp;\n@@ -207,1 +204,1 @@\n-    if (io->Read(io, &tmp.integer, sizeof(cmsUInt32Number), 1) != 1)\n+    if (io->Read(io, &tmp, sizeof(cmsUInt32Number), 1) != 1)\n@@ -212,2 +209,2 @@\n-        tmp.integer = _cmsAdjustEndianess32(tmp.integer);\n-        *n = tmp.floating_point;\n+        tmp = _cmsAdjustEndianess32(tmp);\n+        *n = *(cmsFloat32Number*)(void*)&tmp;\n@@ -340,8 +337,7 @@\n-    union typeConverter {\n-        cmsUInt32Number integer;\n-        cmsFloat32Number floating_point;\n-    } tmp;\n-\n-    tmp.floating_point = n;\n-    tmp.integer = _cmsAdjustEndianess32(tmp.integer);\n-    if (io -> Write(io, sizeof(cmsUInt32Number), &tmp.integer) != 1)\n+    cmsUInt32Number tmp;\n+\n+    _cmsAssert(io != NULL);\n+\n+    tmp = *(cmsUInt32Number*) (void*) &n;\n+    tmp = _cmsAdjustEndianess32(tmp);\n+    if (io -> Write(io, sizeof(cmsUInt32Number), &tmp) != 1)\n@@ -657,4 +653,0 @@\n-                case cmsPluginParalellizationSig:\n-                    if (!_cmsRegisterParallelizationPlugin(id, Plugin)) return FALSE;\n-                    break;\n-\n@@ -683,2 +675,2 @@\n-    NULL,                                \/\/ Not in the linked list\n-    NULL,                                \/\/ No suballocator\n+    NULL,                              \/\/ Not in the linked list\n+    NULL,                              \/\/ No suballocator\n@@ -686,16 +678,15 @@\n-        NULL,                            \/\/  UserPtr,\n-        &_cmsLogErrorChunk,              \/\/  Logger,\n-        &_cmsAlarmCodesChunk,            \/\/  AlarmCodes,\n-        &_cmsAdaptationStateChunk,       \/\/  AdaptationState,\n-        &_cmsMemPluginChunk,             \/\/  MemPlugin,\n-        &_cmsInterpPluginChunk,          \/\/  InterpPlugin,\n-        &_cmsCurvesPluginChunk,          \/\/  CurvesPlugin,\n-        &_cmsFormattersPluginChunk,      \/\/  FormattersPlugin,\n-        &_cmsTagTypePluginChunk,         \/\/  TagTypePlugin,\n-        &_cmsTagPluginChunk,             \/\/  TagPlugin,\n-        &_cmsIntentsPluginChunk,         \/\/  IntentPlugin,\n-        &_cmsMPETypePluginChunk,         \/\/  MPEPlugin,\n-        &_cmsOptimizationPluginChunk,    \/\/  OptimizationPlugin,\n-        &_cmsTransformPluginChunk,       \/\/  TransformPlugin,\n-        &_cmsMutexPluginChunk,           \/\/  MutexPlugin,\n-        &_cmsParallelizationPluginChunk  \/\/  ParallelizationPlugin\n+        NULL,                          \/\/  UserPtr,\n+        &_cmsLogErrorChunk,            \/\/  Logger,\n+        &_cmsAlarmCodesChunk,          \/\/  AlarmCodes,\n+        &_cmsAdaptationStateChunk,     \/\/  AdaptationState,\n+        &_cmsMemPluginChunk,           \/\/  MemPlugin,\n+        &_cmsInterpPluginChunk,        \/\/  InterpPlugin,\n+        &_cmsCurvesPluginChunk,        \/\/  CurvesPlugin,\n+        &_cmsFormattersPluginChunk,    \/\/  FormattersPlugin,\n+        &_cmsTagTypePluginChunk,       \/\/  TagTypePlugin,\n+        &_cmsTagPluginChunk,           \/\/  TagPlugin,\n+        &_cmsIntentsPluginChunk,       \/\/  IntentPlugin,\n+        &_cmsMPETypePluginChunk,       \/\/  MPEPlugin,\n+        &_cmsOptimizationPluginChunk,  \/\/  OptimizationPlugin,\n+        &_cmsTransformPluginChunk,     \/\/  TransformPlugin,\n+        &_cmsMutexPluginChunk          \/\/  MutexPlugin\n@@ -712,47 +703,0 @@\n-\n-\/\/ Make sure context is initialized (needed on windows)\n-static\n-cmsBool InitContextMutex(void)\n-{\n-    \/\/ See the comments regarding locking in lcms2_internal.h\n-    \/\/ for an explanation of why we need the following code.\n-#ifndef CMS_NO_PTHREADS\n-#ifdef CMS_IS_WINDOWS_\n-#ifndef CMS_RELY_ON_WINDOWS_STATIC_MUTEX_INIT\n-\n-    static cmsBool already_initialized = FALSE;\n-\n-    if (!already_initialized)\n-    {\n-        static HANDLE _cmsWindowsInitMutex = NULL;\n-        static volatile HANDLE* mutex = &_cmsWindowsInitMutex;\n-\n-        if (*mutex == NULL)\n-        {\n-            HANDLE p = CreateMutex(NULL, FALSE, NULL);\n-            if (p && InterlockedCompareExchangePointer((void**)mutex, (void*)p, NULL) != NULL)\n-                CloseHandle(p);\n-        }\n-        if (*mutex == NULL || WaitForSingleObject(*mutex, INFINITE) == WAIT_FAILED)\n-        {\n-            cmsSignalError(0, cmsERROR_INTERNAL, \"Mutex lock failed\");\n-            return FALSE;\n-        }\n-        if (((void**)&_cmsContextPoolHeadMutex)[0] == NULL)\n-            InitializeCriticalSection(&_cmsContextPoolHeadMutex);\n-        if (*mutex == NULL || !ReleaseMutex(*mutex))\n-        {\n-            cmsSignalError(0, cmsERROR_INTERNAL, \"Mutex unlock failed\");\n-            return FALSE;\n-        }\n-        already_initialized = TRUE;\n-    }\n-#endif\n-#endif\n-#endif\n-\n-    return TRUE;\n-}\n-\n-\n-\n@@ -765,0 +709,1 @@\n+\n@@ -769,2 +714,0 @@\n-    InitContextMutex();\n-\n@@ -828,2 +771,0 @@\n-    struct _cmsContext_struct* ctx = _cmsGetContext(ContextID);\n-\n@@ -841,5 +782,0 @@\n-    _cmsRegisterParallelizationPlugin(ContextID, NULL);\n-\n-   if (ctx->MemPool != NULL)\n-       _cmsSubAllocDestroy(ctx->MemPool);\n-   ctx->MemPool = NULL;\n@@ -880,1 +816,25 @@\n-    if (!InitContextMutex()) return NULL;\n+    \/\/ See the comments regarding locking in lcms2_internal.h\n+    \/\/ for an explanation of why we need the following code.\n+#ifndef CMS_NO_PTHREADS\n+#ifdef CMS_IS_WINDOWS_\n+#ifndef CMS_RELY_ON_WINDOWS_STATIC_MUTEX_INIT\n+    {\n+        static HANDLE _cmsWindowsInitMutex = NULL;\n+        static volatile HANDLE* mutex = &_cmsWindowsInitMutex;\n+\n+        if (*mutex == NULL)\n+        {\n+            HANDLE p = CreateMutex(NULL, FALSE, NULL);\n+            if (p && InterlockedCompareExchangePointer((void **)mutex, (void*)p, NULL) != NULL)\n+                CloseHandle(p);\n+        }\n+        if (*mutex == NULL || WaitForSingleObject(*mutex, INFINITE) == WAIT_FAILED)\n+            return NULL;\n+        if (((void **)&_cmsContextPoolHeadMutex)[0] == NULL)\n+            InitializeCriticalSection(&_cmsContextPoolHeadMutex);\n+        if (*mutex == NULL || !ReleaseMutex(*mutex))\n+            return NULL;\n+    }\n+#endif\n+#endif\n+#endif\n@@ -929,1 +889,0 @@\n-    _cmsAllocParallelizationPluginChunk(ctx, NULL);\n@@ -957,2 +916,0 @@\n-    if (!InitContextMutex()) return NULL;\n-\n@@ -993,1 +950,0 @@\n-    _cmsAllocParallelizationPluginChunk(ctx, src);\n@@ -1019,3 +975,0 @@\n-\n-        InitContextMutex();\n-\n@@ -1068,29 +1021,0 @@\n-\/\/ Use context mutex to provide thread-safe time\n-cmsBool _cmsGetTime(struct tm* ptr_time)\n-{\n-    struct tm* t;\n-#if defined(HAVE_GMTIME_R) || defined(HAVE_GMTIME_S)\n-    struct tm tm;\n-#endif\n-\n-    time_t now = time(NULL);\n-\n-#ifdef HAVE_GMTIME_R\n-    t = gmtime_r(&now, &tm);\n-#elif defined(HAVE_GMTIME_S)\n-    t = gmtime_s(&tm, &now) == 0 ? &tm : NULL;\n-#else\n-    if (!InitContextMutex()) return FALSE;\n-\n-    _cmsEnterCriticalSectionPrimitive(&_cmsContextPoolHeadMutex);\n-    t = gmtime(&now);\n-    _cmsLeaveCriticalSectionPrimitive(&_cmsContextPoolHeadMutex);\n-#endif\n-\n-    if (t == NULL)\n-        return FALSE;\n-    else {\n-        *ptr_time = *t;\n-        return TRUE;\n-    }\n-}\n","filename":"src\/java.desktop\/share\/native\/liblcms\/cmsplugin.c","additions":55,"deletions":131,"binary":false,"changes":186,"status":"modified"},{"patch":"@@ -33,1 +33,1 @@\n-\/\/  Copyright (c) 1998-2022 Marti Maria Saguer\n+\/\/  Copyright (c) 1998-2020 Marti Maria Saguer\n@@ -507,1 +507,1 @@\n-    if (i % 10 == 0)\n+        if (i % 10 == 0)\n@@ -586,1 +586,1 @@\n-        buffer[sizeof(buffer)-1] = '\\0';\n+            buffer[sizeof(buffer)-1] = '\\0';\n","filename":"src\/java.desktop\/share\/native\/liblcms\/cmsps2.c","additions":3,"deletions":3,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -33,1 +33,1 @@\n-\/\/  Copyright (c) 1998-2022 Marti Maria Saguer\n+\/\/  Copyright (c) 1998-2020 Marti Maria Saguer\n@@ -158,1 +158,0 @@\n-    if (Lab.L < 0) Lab.L = 0;\n@@ -355,1 +354,0 @@\n-        if (fabs(b) < 1.0E-10) return 0;\n@@ -366,5 +364,1 @@\n-             double rt;\n-\n-             if (fabs(a) < 1.0E-10) return 0;\n-\n-             rt = (-b + sqrt(d)) \/ (2.0 * a);\n+             double rt = (-b + sqrt(d)) \/ (2.0 * a);\n","filename":"src\/java.desktop\/share\/native\/liblcms\/cmssamp.c","additions":2,"deletions":8,"binary":false,"changes":10,"status":"modified"},{"patch":"@@ -33,1 +33,1 @@\n-\/\/  Copyright (c) 1998-2022 Marti Maria Saguer\n+\/\/  Copyright (c) 1998-2020 Marti Maria Saguer\n","filename":"src\/java.desktop\/share\/native\/liblcms\/cmssm.c","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -33,1 +33,1 @@\n-\/\/  Copyright (c) 1998-2022 Marti Maria Saguer\n+\/\/  Copyright (c) 1998-2020 Marti Maria Saguer\n@@ -166,41 +166,0 @@\n-\/\/ Try to promote correctly to wchar_t when 32 bits\n-cmsINLINE cmsBool is_surrogate(cmsUInt32Number uc) { return (uc - 0xd800u) < 2048u; }\n-cmsINLINE cmsBool is_high_surrogate(cmsUInt32Number uc) { return (uc & 0xfffffc00) == 0xd800; }\n-cmsINLINE cmsBool is_low_surrogate(cmsUInt32Number uc)  { return (uc & 0xfffffc00) == 0xdc00; }\n-\n-cmsINLINE cmsUInt32Number surrogate_to_utf32(cmsUInt32Number high, cmsUInt32Number low)\n-{\n-    return (high << 10) + low - 0x35fdc00;\n-}\n-\n-cmsINLINE cmsBool convert_utf16_to_utf32(cmsIOHANDLER* io, cmsInt32Number n, wchar_t* output)\n-{\n-    cmsUInt16Number uc;\n-\n-    while (n > 0)\n-    {\n-        if (!_cmsReadUInt16Number(io, &uc)) return FALSE;\n-        n--;\n-\n-        if (!is_surrogate(uc))\n-        {\n-            *output++ = (wchar_t)uc;\n-        }\n-        else {\n-\n-            cmsUInt16Number low;\n-\n-            if (!_cmsReadUInt16Number(io, &low)) return FALSE;\n-            n--;\n-\n-            if (is_high_surrogate(uc) && is_low_surrogate(low))\n-                *output++ = (wchar_t)surrogate_to_utf32(uc, low);\n-            else\n-                return FALSE;   \/\/ Corrupted string, just ignore\n-        }\n-    }\n-\n-    return TRUE;\n-}\n-\n-\n@@ -213,1 +172,0 @@\n-    cmsBool is32 = sizeof(wchar_t) > sizeof(cmsUInt16Number);\n@@ -217,5 +175,0 @@\n-    if (is32 && Array != NULL)\n-    {\n-        return convert_utf16_to_utf32(io, n, Array);\n-    }\n-\n@@ -1386,1 +1339,1 @@\n-\/\/ time to UTC when setting these values. Programs that display these values may show\n+\/\/ time to UTC when setting these values. Programmes that display these values may show\n@@ -1582,4 +1535,1 @@\n-        if (!_cmsReadWCharArray(io, NumOfWchar, Block)) {\n-            _cmsFree(self->ContextID, Block);\n-            goto Error;\n-        }\n+        if (!_cmsReadWCharArray(io, NumOfWchar, Block)) goto Error;\n@@ -1828,1 +1778,1 @@\n-\/\/ 8 bit lut may be scaled easily to v4 PCS, but we need also to properly adjust\n+\/\/ 8 bit lut may be scaled easely to v4 PCS, but we need also to properly adjust\n@@ -1935,1 +1885,1 @@\n-    cmsUInt32Number j, nTabSize, i;\n+    cmsUInt32Number j, nTabSize, i, n;\n@@ -1970,1 +1920,1 @@\n-        cmsSignalError(self->ContextID, cmsERROR_UNKNOWN_EXTENSION, \"LUT is not suitable to be saved as LUT8\");\n+        cmsSignalError(mpe->ContextID, cmsERROR_UNKNOWN_EXTENSION, \"LUT is not suitable to be saved as LUT8\");\n@@ -1976,10 +1926,2 @@\n-    else {\n-        \/\/ Lut8 only allows same CLUT points in all dimensions\n-        clutPoints = clut->Params->nSamples[0];\n-        for (i = 1; i < cmsPipelineInputChannels(NewLUT); i++) {\n-            if (clut->Params->nSamples[i] != clutPoints) {\n-                cmsSignalError(self->ContextID, cmsERROR_UNKNOWN_EXTENSION, \"LUT with different samples per dimension not suitable to be saved as LUT16\");\n-                return FALSE;\n-            }\n-        }\n-    }\n+    else\n+        clutPoints    = clut->Params->nSamples[0];\n@@ -1987,2 +1929,2 @@\n-    if (!_cmsWriteUInt8Number(io, (cmsUInt8Number)cmsPipelineInputChannels(NewLUT))) return FALSE;\n-    if (!_cmsWriteUInt8Number(io, (cmsUInt8Number)cmsPipelineOutputChannels(NewLUT))) return FALSE;\n+    if (!_cmsWriteUInt8Number(io, (cmsUInt8Number) NewLUT ->InputChannels)) return FALSE;\n+    if (!_cmsWriteUInt8Number(io, (cmsUInt8Number) NewLUT ->OutputChannels)) return FALSE;\n@@ -1992,0 +1934,2 @@\n+        n = NewLUT->InputChannels * NewLUT->OutputChannels;\n+\n@@ -1994,4 +1938,4 @@\n-        for (i = 0; i < 9; i++)\n-        {\n-            if (!_cmsWrite15Fixed16Number(io, MatMPE->Double[i])) return FALSE;\n-        }\n+                for (i = 0; i < 9; i++)\n+                {\n+                        if (!_cmsWrite15Fixed16Number(io, MatMPE->Double[i])) return FALSE;\n+                }\n@@ -2115,1 +2059,1 @@\n-    for (i=0; i < Tables ->nCurves; i++) {\n+    nEntries = Tables->TheCurves[0]->nEntries;\n@@ -2117,1 +2061,1 @@\n-        nEntries = Tables->TheCurves[i]->nEntries;\n+    for (i=0; i < Tables ->nCurves; i++) {\n@@ -2261,1 +2205,1 @@\n-        cmsSignalError(self->ContextID, cmsERROR_UNKNOWN_EXTENSION, \"LUT is not suitable to be saved as LUT16\");\n+        cmsSignalError(mpe->ContextID, cmsERROR_UNKNOWN_EXTENSION, \"LUT is not suitable to be saved as LUT16\");\n@@ -2270,10 +2214,2 @@\n-    else {\n-        \/\/ Lut16 only allows same CLUT points in all dimensions\n-        clutPoints = clut->Params->nSamples[0];\n-        for (i = 1; i < InputChannels; i++) {\n-            if (clut->Params->nSamples[i] != clutPoints) {\n-                cmsSignalError(self->ContextID, cmsERROR_UNKNOWN_EXTENSION, \"LUT with different samples per dimension not suitable to be saved as LUT16\");\n-                return FALSE;\n-            }\n-        }\n-    }\n+    else\n+        clutPoints    = clut->Params->nSamples[0];\n@@ -2288,4 +2224,4 @@\n-        for (i = 0; i < 9; i++)\n-        {\n-            if (!_cmsWrite15Fixed16Number(io, MatMPE->Double[i])) return FALSE;\n-        }\n+                for (i = 0; i < 9; i++)\n+                {\n+                        if (!_cmsWrite15Fixed16Number(io, MatMPE->Double[i])) return FALSE;\n+                }\n@@ -2637,1 +2573,1 @@\n-    cmsUInt32Number i, n;\n+        cmsUInt32Number i, n;\n@@ -2641,1 +2577,1 @@\n-    n = mpe->InputChannels * mpe->OutputChannels;\n+        n = mpe->InputChannels * mpe->OutputChannels;\n@@ -2643,5 +2579,5 @@\n-    \/\/ Write the Matrix\n-    for (i = 0; i < n; i++)\n-    {\n-        if (!_cmsWrite15Fixed16Number(io, m->Double[i])) return FALSE;\n-    }\n+        \/\/ Write the Matrix\n+        for (i = 0; i < n; i++)\n+        {\n+                if (!_cmsWrite15Fixed16Number(io, m->Double[i])) return FALSE;\n+        }\n@@ -2649,1 +2585,1 @@\n-    if (m->Offset != NULL) {\n+        if (m->Offset != NULL) {\n@@ -2651,3 +2587,4 @@\n-        for (i = 0; i < mpe->OutputChannels; i++)\n-        {\n-            if (!_cmsWrite15Fixed16Number(io, m->Offset[i])) return FALSE;\n+                for (i = 0; i < mpe->OutputChannels; i++)\n+                {\n+                        if (!_cmsWrite15Fixed16Number(io, m->Offset[i])) return FALSE;\n+                }\n@@ -2655,5 +2592,5 @@\n-    }\n-    else {\n-        for (i = 0; i < mpe->OutputChannels; i++)\n-        {\n-            if (!_cmsWrite15Fixed16Number(io, 0)) return FALSE;\n+        else {\n+                for (i = 0; i < mpe->OutputChannels; i++)\n+                {\n+                        if (!_cmsWrite15Fixed16Number(io, 0)) return FALSE;\n+                }\n@@ -2661,1 +2598,0 @@\n-    }\n@@ -3192,0 +3128,1 @@\n+\n@@ -3263,2 +3200,2 @@\n-    memcpy(prefix, (const char*) NamedColorList->Prefix, sizeof(prefix));\n-    memcpy(suffix, (const char*) NamedColorList->Suffix, sizeof(suffix));\n+    strncpy(prefix, (const char*) NamedColorList->Prefix, 32);\n+    strncpy(suffix, (const char*) NamedColorList->Suffix, 32);\n@@ -3277,4 +3214,0 @@\n-       memset(Root, 0, sizeof(Root));\n-       memset(PCS, 0, sizeof(PCS));\n-       memset(Colorant, 0, sizeof(Colorant));\n-\n@@ -3521,0 +3454,1 @@\n+    SizeOfTag -= sizeof(cmsUInt32Number);\n@@ -3538,1 +3472,0 @@\n-    cmsUNUSED_PARAMETER(SizeOfTag);\n@@ -3614,1 +3547,0 @@\n-    cmsInt32Number SignedSizeOfTag = (cmsInt32Number)SizeOfTag;\n@@ -3621,2 +3553,0 @@\n-\n-    if (SignedSizeOfTag < (cmsInt32Number) sizeof(cmsUInt32Number)) return NULL;\n@@ -3624,1 +3554,2 @@\n-    SignedSizeOfTag -= sizeof(cmsUInt32Number);\n+    if (SizeOfTag < sizeof(cmsUInt32Number)) return NULL;\n+    SizeOfTag -= sizeof(cmsUInt32Number);\n@@ -3627,4 +3558,1 @@\n-    if (n ->Ucr == NULL) goto error;\n-\n-    if (SignedSizeOfTag < (cmsInt32Number)(CountUcr * sizeof(cmsUInt16Number))) goto error;\n-    if (!_cmsReadUInt16Array(io, CountUcr, n ->Ucr->Table16)) goto error;\n+    if (n ->Ucr == NULL) return NULL;\n@@ -3632,1 +3560,3 @@\n-    SignedSizeOfTag -= CountUcr * sizeof(cmsUInt16Number);\n+    if (!_cmsReadUInt16Array(io, CountUcr, n ->Ucr->Table16)) return NULL;\n+    if (SizeOfTag < sizeof(cmsUInt32Number)) return NULL;\n+    SizeOfTag -= CountUcr * sizeof(cmsUInt16Number);\n@@ -3635,4 +3565,3 @@\n-\n-    if (SignedSizeOfTag < (cmsInt32Number)sizeof(cmsUInt32Number)) goto error;\n-    if (!_cmsReadUInt32Number(io, &CountBg)) goto error;\n-    SignedSizeOfTag -= sizeof(cmsUInt32Number);\n+    if (!_cmsReadUInt32Number(io, &CountBg)) return NULL;\n+    if (SizeOfTag < sizeof(cmsUInt32Number)) return NULL;\n+    SizeOfTag -= sizeof(cmsUInt32Number);\n@@ -3641,7 +3570,5 @@\n-    if (n ->Bg == NULL) goto error;\n-\n-    if (SignedSizeOfTag < (cmsInt32Number) (CountBg * sizeof(cmsUInt16Number))) goto error;\n-    if (!_cmsReadUInt16Array(io, CountBg, n ->Bg->Table16)) goto error;\n-    SignedSizeOfTag -= CountBg * sizeof(cmsUInt16Number);\n-\n-    if (SignedSizeOfTag < 0 || SignedSizeOfTag > 32000) goto error;\n+    if (n ->Bg == NULL) return NULL;\n+    if (!_cmsReadUInt16Array(io, CountBg, n ->Bg->Table16)) return NULL;\n+    if (SizeOfTag < CountBg * sizeof(cmsUInt16Number)) return NULL;\n+    SizeOfTag -= CountBg * sizeof(cmsUInt16Number);\n+    if (SizeOfTag == UINT_MAX) return NULL;\n@@ -3651,1 +3578,1 @@\n-    if (n ->Desc == NULL) goto error;\n+    if (n ->Desc == NULL) return NULL;\n@@ -3653,8 +3580,3 @@\n-    ASCIIString = (char*) _cmsMalloc(self ->ContextID, SignedSizeOfTag + 1);\n-    if (io->Read(io, ASCIIString, sizeof(char), SignedSizeOfTag) != (cmsUInt32Number)SignedSizeOfTag)\n-    {\n-        _cmsFree(self->ContextID, ASCIIString);\n-        goto error;\n-    }\n-\n-    ASCIIString[SignedSizeOfTag] = 0;\n+    ASCIIString = (char*) _cmsMalloc(self ->ContextID, SizeOfTag + 1);\n+    if (io ->Read(io, ASCIIString, sizeof(char), SizeOfTag) != SizeOfTag) return NULL;\n+    ASCIIString[SizeOfTag] = 0;\n@@ -3666,10 +3588,0 @@\n-\n-error:\n-\n-    if (n->Ucr) cmsFreeToneCurve(n->Ucr);\n-    if (n->Bg) cmsFreeToneCurve(n->Bg);\n-    if (n->Desc) cmsMLUfree(n->Desc);\n-    _cmsFree(self->ContextID, n);\n-    *nItems = 0;\n-    return NULL;\n-\n@@ -3756,1 +3668,1 @@\n-cmsBool  ReadCountAndString(struct _cms_typehandler_struct* self, cmsIOHANDLER* io, cmsMLU* mlu, cmsUInt32Number* SizeOfTag, const char* Section)\n+cmsBool  ReadCountAndSting(struct _cms_typehandler_struct* self, cmsIOHANDLER* io, cmsMLU* mlu, cmsUInt32Number* SizeOfTag, const char* Section)\n@@ -3786,1 +3698,1 @@\n-cmsBool  WriteCountAndString(struct _cms_typehandler_struct* self, cmsIOHANDLER* io, cmsMLU* mlu, const char* Section)\n+cmsBool  WriteCountAndSting(struct _cms_typehandler_struct* self, cmsIOHANDLER* io, cmsMLU* mlu, const char* Section)\n@@ -3810,5 +3722,5 @@\n-    if (!ReadCountAndString(self, io, mlu, &SizeOfTag, \"nm\")) goto Error;\n-    if (!ReadCountAndString(self, io, mlu, &SizeOfTag, \"#0\")) goto Error;\n-    if (!ReadCountAndString(self, io, mlu, &SizeOfTag, \"#1\")) goto Error;\n-    if (!ReadCountAndString(self, io, mlu, &SizeOfTag, \"#2\")) goto Error;\n-    if (!ReadCountAndString(self, io, mlu, &SizeOfTag, \"#3\")) goto Error;\n+    if (!ReadCountAndSting(self, io, mlu, &SizeOfTag, \"nm\")) goto Error;\n+    if (!ReadCountAndSting(self, io, mlu, &SizeOfTag, \"#0\")) goto Error;\n+    if (!ReadCountAndSting(self, io, mlu, &SizeOfTag, \"#1\")) goto Error;\n+    if (!ReadCountAndSting(self, io, mlu, &SizeOfTag, \"#2\")) goto Error;\n+    if (!ReadCountAndSting(self, io, mlu, &SizeOfTag, \"#3\")) goto Error;\n@@ -3831,5 +3743,5 @@\n-    if (!WriteCountAndString(self, io, mlu, \"nm\")) goto Error;\n-    if (!WriteCountAndString(self, io, mlu, \"#0\")) goto Error;\n-    if (!WriteCountAndString(self, io, mlu, \"#1\")) goto Error;\n-    if (!WriteCountAndString(self, io, mlu, \"#2\")) goto Error;\n-    if (!WriteCountAndString(self, io, mlu, \"#3\")) goto Error;\n+    if (!WriteCountAndSting(self, io, mlu, \"nm\")) goto Error;\n+    if (!WriteCountAndSting(self, io, mlu, \"#0\")) goto Error;\n+    if (!WriteCountAndSting(self, io, mlu, \"#1\")) goto Error;\n+    if (!WriteCountAndSting(self, io, mlu, \"#2\")) goto Error;\n+    if (!WriteCountAndSting(self, io, mlu, \"#3\")) goto Error;\n@@ -4089,1 +4001,1 @@\n-           case cmsSigFormulaCurveSeg: {\n+            case cmsSigFormulaCurveSeg: {\n@@ -4091,2 +4003,2 @@\n-               cmsUInt16Number Type;\n-               cmsUInt32Number ParamsByType[] = { 4, 5, 5 };\n+                cmsUInt16Number Type;\n+                cmsUInt32Number ParamsByType[] = {4, 5, 5 };\n@@ -4094,2 +4006,2 @@\n-               if (!_cmsReadUInt16Number(io, &Type)) goto Error;\n-               if (!_cmsReadUInt16Number(io, NULL)) goto Error;\n+                if (!_cmsReadUInt16Number(io, &Type)) goto Error;\n+                if (!_cmsReadUInt16Number(io, NULL)) goto Error;\n@@ -4097,2 +4009,2 @@\n-               Segments[i].Type = Type + 6;\n-               if (Type > 2) goto Error;\n+                Segments[i].Type = Type + 6;\n+                if (Type > 2) goto Error;\n@@ -4100,1 +4012,1 @@\n-               for (j = 0; j < ParamsByType[Type]; j++) {\n+                for (j=0; j < ParamsByType[Type]; j++) {\n@@ -4102,6 +4014,6 @@\n-                   cmsFloat32Number f;\n-                   if (!_cmsReadFloat32Number(io, &f)) goto Error;\n-                   Segments[i].Params[j] = f;\n-               }\n-           }\n-           break;\n+                    cmsFloat32Number f;\n+                    if (!_cmsReadFloat32Number(io, &f)) goto Error;\n+                    Segments[i].Params[j] = f;\n+                }\n+                }\n+                break;\n@@ -4110,2 +4022,2 @@\n-           case cmsSigSampledCurveSeg: {\n-               cmsUInt32Number Count;\n+            case cmsSigSampledCurveSeg: {\n+                cmsUInt32Number Count;\n@@ -4113,1 +4025,1 @@\n-               if (!_cmsReadUInt32Number(io, &Count)) goto Error;\n+                if (!_cmsReadUInt32Number(io, &Count)) goto Error;\n@@ -4115,5 +4027,3 @@\n-               \/\/ The first point is implicit in the last stage, we allocate an extra note to be populated latter on\n-               Count++;\n-               Segments[i].nGridPoints = Count;\n-               Segments[i].SampledPoints = (cmsFloat32Number*)_cmsCalloc(self->ContextID, Count, sizeof(cmsFloat32Number));\n-               if (Segments[i].SampledPoints == NULL) goto Error;\n+                Segments[i].nGridPoints = Count;\n+                Segments[i].SampledPoints = (cmsFloat32Number*) _cmsCalloc(self ->ContextID, Count, sizeof(cmsFloat32Number));\n+                if (Segments[i].SampledPoints == NULL) goto Error;\n@@ -4121,6 +4031,5 @@\n-               Segments[i].SampledPoints[0] = 0;\n-               for (j = 1; j < Count; j++) {\n-                   if (!_cmsReadFloat32Number(io, &Segments[i].SampledPoints[j])) goto Error;\n-               }\n-           }\n-           break;\n+                for (j=0; j < Count; j++) {\n+                    if (!_cmsReadFloat32Number(io, &Segments[i].SampledPoints[j])) goto Error;\n+                }\n+                }\n+                break;\n@@ -4146,11 +4055,0 @@\n-\n-     \/\/ Explore for missing implicit points\n-     for (i = 0; i < nSegments; i++) {\n-\n-         \/\/ If sampled curve, fix it\n-         if (Curve->Segments[i].Type == 0) {\n-\n-             Curve->Segments[i].SampledPoints[0] = cmsEvalToneCurveFloat(Curve, Curve->Segments[i].x0);\n-         }\n-     }\n-\n@@ -4251,1 +4149,1 @@\n-            \/\/ This is a sampled curve. First point is implicit in the ICC format, but not in our representation\n+            \/\/ This is a sampled curve\n@@ -4254,1 +4152,1 @@\n-            if (!_cmsWriteUInt32Number(io, ActualSeg -> nGridPoints - 1)) goto Error;\n+            if (!_cmsWriteUInt32Number(io, ActualSeg -> nGridPoints)) goto Error;\n@@ -4256,1 +4154,1 @@\n-            for (j=1; j < g ->Segments[i].nGridPoints; j++) {\n+            for (j=0; j < g ->Segments[i].nGridPoints; j++) {\n@@ -4633,1 +4531,1 @@\n-\/\/ This one is a little bit more complex, so we don't use position tables this time.\n+\/\/ This one is a liitle bit more complex, so we don't use position tables this time.\n@@ -5065,1 +4963,1 @@\n-    \/\/ An offset of zero has special meaning and shall be preserved\n+    \/\/ An offset of zero has special meaning and shal be preserved\n@@ -5073,3 +4971,1 @@\n-cmsBool ReadOffsetArray(cmsIOHANDLER* io,  _cmsDICarray* a,\n-                        cmsUInt32Number Count, cmsUInt32Number Length, cmsUInt32Number BaseOffset,\n-                        cmsInt32Number* SignedSizeOfTagPtr)\n+cmsBool ReadOffsetArray(cmsIOHANDLER* io,  _cmsDICarray* a, cmsUInt32Number Count, cmsUInt32Number Length, cmsUInt32Number BaseOffset)\n@@ -5078,1 +4974,0 @@\n-    cmsInt32Number SignedSizeOfTag = *SignedSizeOfTagPtr;\n@@ -5083,3 +4978,0 @@\n-        if (SignedSizeOfTag < 4 * (cmsInt32Number) sizeof(cmsUInt32Number)) return FALSE;\n-        SignedSizeOfTag -= 4 * sizeof(cmsUInt32Number);\n-\n@@ -5091,3 +4983,0 @@\n-            if (SignedSizeOfTag < 2 * (cmsInt32Number) sizeof(cmsUInt32Number)) return FALSE;\n-            SignedSizeOfTag -= 2 * sizeof(cmsUInt32Number);\n-\n@@ -5100,3 +4989,0 @@\n-            if (SignedSizeOfTag < 2 * (cmsInt32Number) sizeof(cmsUInt32Number)) return FALSE;\n-            SignedSizeOfTag -= 2 * (cmsInt32Number) sizeof(cmsUInt32Number);\n-\n@@ -5106,2 +4992,0 @@\n-\n-    *SignedSizeOfTagPtr = SignedSizeOfTag;\n@@ -5255,1 +5139,1 @@\n-   cmsHANDLE hDict = NULL;\n+   cmsHANDLE hDict;\n@@ -5262,1 +5146,0 @@\n-   cmsInt32Number SignedSizeOfTag = (cmsInt32Number)SizeOfTag;\n@@ -5265,1 +5148,0 @@\n-    memset(&a, 0, sizeof(a));\n@@ -5271,2 +5153,0 @@\n-    SignedSizeOfTag -= sizeof(cmsUInt32Number);\n-    if (SignedSizeOfTag < 0) goto Error;\n@@ -5274,0 +5154,1 @@\n+    SizeOfTag -= sizeof(cmsUInt32Number);\n@@ -5276,2 +5157,0 @@\n-    SignedSizeOfTag -= sizeof(cmsUInt32Number);\n-    if (SignedSizeOfTag < 0) goto Error;\n@@ -5279,1 +5158,1 @@\n-\n+    SizeOfTag -= sizeof(cmsUInt32Number);\n@@ -5295,1 +5174,1 @@\n-    if (!ReadOffsetArray(io, &a, Count, Length, BaseOffset, &SignedSizeOfTag)) goto Error;\n+    if (!ReadOffsetArray(io, &a, Count, Length, BaseOffset)) goto Error;\n@@ -5335,1 +5214,1 @@\n-   if (hDict != NULL) cmsDictFree(hDict);\n+   cmsDictFree(hDict);\n@@ -5433,58 +5312,0 @@\n-\/\/ cicp VideoSignalType\n-\n-static\n-void* Type_VideoSignal_Read(struct _cms_typehandler_struct* self, cmsIOHANDLER* io, cmsUInt32Number* nItems, cmsUInt32Number SizeOfTag)\n-{\n-    cmsVideoSignalType* cicp = NULL;\n-\n-    if (SizeOfTag != 8) return NULL;\n-\n-    if (!_cmsReadUInt32Number(io, NULL)) return NULL;\n-\n-    cicp = (cmsVideoSignalType*)_cmsCalloc(self->ContextID, 1, sizeof(cmsVideoSignalType));\n-    if (cicp == NULL) return NULL;\n-\n-    if (!_cmsReadUInt8Number(io, &cicp->ColourPrimaries)) goto Error;\n-    if (!_cmsReadUInt8Number(io, &cicp->TransferCharacteristics)) goto Error;\n-    if (!_cmsReadUInt8Number(io, &cicp->MatrixCoefficients)) goto Error;\n-    if (!_cmsReadUInt8Number(io, &cicp->VideoFullRangeFlag)) goto Error;\n-\n-    \/\/ Success\n-    *nItems = 1;\n-    return cicp;\n-\n-Error:\n-    if (cicp != NULL) _cmsFree(self->ContextID, cicp);\n-    return NULL;\n-}\n-\n-static\n-cmsBool Type_VideoSignal_Write(struct _cms_typehandler_struct* self, cmsIOHANDLER* io, void* Ptr, cmsUInt32Number nItems)\n-{\n-    cmsVideoSignalType* cicp = (cmsVideoSignalType*)Ptr;\n-\n-    if (!_cmsWriteUInt32Number(io, 0)) return FALSE;\n-    if (!_cmsWriteUInt8Number(io, cicp->ColourPrimaries)) return FALSE;\n-    if (!_cmsWriteUInt8Number(io, cicp->TransferCharacteristics)) return FALSE;\n-    if (!_cmsWriteUInt8Number(io, cicp->MatrixCoefficients)) return FALSE;\n-    if (!_cmsWriteUInt8Number(io, cicp->VideoFullRangeFlag)) return FALSE;\n-\n-    return TRUE;\n-\n-    cmsUNUSED_PARAMETER(self);\n-    cmsUNUSED_PARAMETER(nItems);\n-}\n-\n-void* Type_VideoSignal_Dup(struct _cms_typehandler_struct* self, const void* Ptr, cmsUInt32Number n)\n-{\n-    return _cmsDupMem(self->ContextID, Ptr, sizeof(cmsVideoSignalType));\n-\n-    cmsUNUSED_PARAMETER(n);\n-}\n-\n-\n-static\n-void Type_VideoSignal_Free(struct _cms_typehandler_struct* self, void* Ptr)\n-{\n-    _cmsFree(self->ContextID, Ptr);\n-}\n@@ -5530,1 +5351,0 @@\n-{TYPE_HANDLER(cmsSigcicpType,                  VideoSignal),        (_cmsTagTypeLinkedList*) &SupportedTagTypes[31] },\n@@ -5725,2 +5545,0 @@\n-    { cmsSigcicpTag,                { 1, 1, { cmsSigcicpType},               NULL },   &SupportedTags[64]},\n-\n","filename":"src\/java.desktop\/share\/native\/liblcms\/cmstypes.c","additions":112,"deletions":294,"binary":false,"changes":406,"status":"modified"},{"patch":"@@ -33,1 +33,1 @@\n-\/\/  Copyright (c) 1998-2022 Marti Maria Saguer\n+\/\/  Copyright (c) 1998-2020 Marti Maria Saguer\n@@ -146,1 +146,1 @@\n-    cmsSetProfileVersion(hICC, 4.4);\n+    cmsSetProfileVersion(hICC, 4.3);\n@@ -267,1 +267,1 @@\n-    cmsSetProfileVersion(hICC, 4.4);\n+    cmsSetProfileVersion(hICC, 4.3);\n@@ -323,1 +323,1 @@\n-    cmsInt32Number nChannels;\n+    cmsUInt32Number nChannels;\n@@ -329,1 +329,1 @@\n-    cmsSetProfileVersion(hICC, 4.4);\n+    cmsSetProfileVersion(hICC, 4.3);\n@@ -338,1 +338,1 @@\n-    nChannels = cmsChannelsOfColorSpace(ColorSpace);\n+    nChannels = cmsChannelsOf(ColorSpace);\n@@ -400,1 +400,1 @@\n-    SumCMY   = (cmsFloat64Number) In[0]  + In[1] + In[2];\n+    SumCMY   = In[0]  + In[1] + In[2];\n@@ -429,1 +429,1 @@\n-    cmsInt32Number nChannels;\n+    cmsUInt32Number nChannels;\n@@ -448,1 +448,1 @@\n-    cmsSetProfileVersion(hICC, 4.4);\n+    cmsSetProfileVersion(hICC, 4.3);\n@@ -558,1 +558,1 @@\n-    cmsSetProfileVersion(hProfile, 4.4);\n+    cmsSetProfileVersion(hProfile, 4.3);\n@@ -604,1 +604,1 @@\n-    cmsSetProfileVersion(hProfile, 4.4);\n+    cmsSetProfileVersion(hProfile, 4.3);\n@@ -871,1 +871,1 @@\n-    cmsSetProfileVersion(hProfile, 4.4);\n+    cmsSetProfileVersion(hProfile, 4.3);\n@@ -1006,1 +1006,1 @@\n-        | BYTES_SH(2) | CHANNELS_SH(cmsChannelsOfColorSpace(v ->ExitColorSpace)));\n+        | BYTES_SH(2) | CHANNELS_SH(cmsChannelsOf(v ->ExitColorSpace)));\n@@ -1094,3 +1094,2 @@\n-        cmsUInt32Number FrmIn, FrmOut;\n-        cmsInt32Number ChansIn, ChansOut;\n-        int ColorSpaceBitsIn, ColorSpaceBitsOut;\n+    cmsUInt32Number FrmIn, FrmOut, ChansIn, ChansOut;\n+    int ColorSpaceBitsIn, ColorSpaceBitsOut;\n@@ -1147,2 +1146,2 @@\n-    ChansIn  = cmsChannelsOfColorSpace(xform -> EntryColorSpace);\n-    ChansOut = cmsChannelsOfColorSpace(xform -> ExitColorSpace);\n+    ChansIn  = cmsChannelsOf(xform -> EntryColorSpace);\n+    ChansOut = cmsChannelsOf(xform -> ExitColorSpace);\n","filename":"src\/java.desktop\/share\/native\/liblcms\/cmsvirt.c","additions":17,"deletions":18,"binary":false,"changes":35,"status":"modified"},{"patch":"@@ -33,1 +33,1 @@\n-\/\/  Copyright (c) 1998-2022 Marti Maria Saguer\n+\/\/  Copyright (c) 1998-2020 Marti Maria Saguer\n@@ -296,1 +296,1 @@\n-\/\/ aspects of the RGB to XYZ process, and assuming that the gamma correction\n+\/\/ aspects of the RGB to XYZ process, and assumming that the gamma correction\n@@ -299,1 +299,1 @@\n-\/\/ the algorithm:\n+\/\/ the alghoritm:\n@@ -304,2 +304,2 @@\n-\/\/              obtaining the coefficients of the transformation\n-\/\/            - Then, I apply these coefficients to the original matrix\n+\/\/              obtaining the coeficients of the transformation\n+\/\/            - Then, I apply these coeficients to the original matrix\n","filename":"src\/java.desktop\/share\/native\/liblcms\/cmswtpnt.c","additions":5,"deletions":5,"binary":false,"changes":10,"status":"modified"},{"patch":"@@ -33,1 +33,1 @@\n-\/\/  Copyright (c) 1998-2022 Marti Maria Saguer\n+\/\/  Copyright (c) 1998-2020 Marti Maria Saguer\n@@ -316,1 +316,1 @@\n-            \/\/ Any gamut check to do?\n+            \/\/ Any gamut chack to do?\n@@ -813,67 +813,0 @@\n-\/\/ Returns the worker callback for parallelization plug-ins\n-_cmsTransform2Fn CMSEXPORT _cmsGetTransformWorker(struct _cmstransform_struct* CMMcargo)\n-{\n-    _cmsAssert(CMMcargo != NULL);\n-    return CMMcargo->Worker;\n-}\n-\n-\/\/ This field holds maximum number of workers or -1 to auto\n-cmsInt32Number CMSEXPORT _cmsGetTransformMaxWorkers(struct _cmstransform_struct* CMMcargo)\n-{\n-    _cmsAssert(CMMcargo != NULL);\n-    return CMMcargo->MaxWorkers;\n-}\n-\n-\/\/ This field is actually unused and reserved\n-cmsUInt32Number CMSEXPORT _cmsGetTransformWorkerFlags(struct _cmstransform_struct* CMMcargo)\n-{\n-    _cmsAssert(CMMcargo != NULL);\n-    return CMMcargo->WorkerFlags;\n-}\n-\n-\/\/ In the case there is a parallelization plug-in, let it to do its job\n-static\n-void ParalellizeIfSuitable(_cmsTRANSFORM* p)\n-{\n-    _cmsParallelizationPluginChunkType* ctx = (_cmsParallelizationPluginChunkType*)_cmsContextGetClientChunk(p->ContextID, ParallelizationPlugin);\n-\n-    _cmsAssert(p != NULL);\n-    if (ctx != NULL && ctx->SchedulerFn != NULL) {\n-\n-        p->Worker = p->xform;\n-        p->xform = ctx->SchedulerFn;\n-        p->MaxWorkers = ctx->MaxWorkers;\n-        p->WorkerFlags = ctx->WorkerFlags;\n-    }\n-}\n-\n-\n-\/**\n-* An empty unroll to avoid a check with NULL on cmsDoTransform()\n-*\/\n-static\n-cmsUInt8Number* UnrollNothing(CMSREGISTER _cmsTRANSFORM* info,\n-                              CMSREGISTER cmsUInt16Number wIn[],\n-                              CMSREGISTER cmsUInt8Number* accum,\n-                              CMSREGISTER cmsUInt32Number Stride)\n-{\n-    return accum;\n-\n-    cmsUNUSED_PARAMETER(info);\n-    cmsUNUSED_PARAMETER(wIn);\n-    cmsUNUSED_PARAMETER(Stride);\n-}\n-\n-static\n-cmsUInt8Number* PackNothing(CMSREGISTER _cmsTRANSFORM* info,\n-                           CMSREGISTER cmsUInt16Number wOut[],\n-                           CMSREGISTER cmsUInt8Number* output,\n-                           CMSREGISTER cmsUInt32Number Stride)\n-{\n-    return output;\n-\n-    cmsUNUSED_PARAMETER(info);\n-    cmsUNUSED_PARAMETER(wOut);\n-    cmsUNUSED_PARAMETER(Stride);\n-}\n-\n@@ -935,1 +868,0 @@\n-                       ParalellizeIfSuitable(p);\n@@ -946,1 +878,1 @@\n-    if (_cmsFormatterIsFloat(*OutputFormat)) {\n+    if (_cmsFormatterIsFloat(*InputFormat) && _cmsFormatterIsFloat(*OutputFormat)) {\n@@ -972,1 +904,0 @@\n-        \/\/ Formats are intended to be changed before use\n@@ -974,2 +905,1 @@\n-            p->FromInput = UnrollNothing;\n-            p->ToOutput = PackNothing;\n+            p ->FromInput = p ->ToOutput = NULL;\n@@ -992,1 +922,1 @@\n-            BytesPerPixelInput = T_BYTES(*InputFormat);\n+            BytesPerPixelInput = T_BYTES(p ->InputFormat);\n@@ -1026,1 +956,0 @@\n-    ParalellizeIfSuitable(p);\n@@ -1184,9 +1113,0 @@\n-    \/\/ Check whatever the transform is 16 bits and involves linear RGB in first profile. If so, disable optimizations\n-    if (EntryColorSpace == cmsSigRgbData && T_BYTES(InputFormat) == 2 && !(dwFlags & cmsFLAGS_NOOPTIMIZE))\n-    {\n-        cmsFloat64Number gamma = cmsDetectRGBProfileGamma(hProfiles[0], 0.1);\n-\n-        if (gamma > 0 && gamma < 1.6)\n-            dwFlags |= cmsFLAGS_NOOPTIMIZE;\n-    }\n-\n@@ -1201,2 +1121,2 @@\n-    if ((cmsChannelsOfColorSpace(EntryColorSpace) != (cmsInt32Number) cmsPipelineInputChannels(Lut)) ||\n-        (cmsChannelsOfColorSpace(ExitColorSpace)  != (cmsInt32Number) cmsPipelineOutputChannels(Lut))) {\n+    if ((cmsChannelsOf(EntryColorSpace) != cmsPipelineInputChannels(Lut)) ||\n+        (cmsChannelsOf(ExitColorSpace)  != cmsPipelineOutputChannels(Lut))) {\n","filename":"src\/java.desktop\/share\/native\/liblcms\/cmsxform.c","additions":7,"deletions":87,"binary":false,"changes":94,"status":"modified"},{"patch":"@@ -33,1 +33,1 @@\n-\/\/  Copyright (c) 1998-2022 Marti Maria Saguer\n+\/\/  Copyright (c) 1998-2021 Marti Maria Saguer\n@@ -55,1 +55,1 @@\n-\/\/ Version 2.14\n+\/\/ Version 2.12\n@@ -113,1 +113,1 @@\n-#define LCMS_VERSION        2140\n+#define LCMS_VERSION        2120\n@@ -184,1 +184,1 @@\n-#if defined(CMS_NO_REGISTER_KEYWORD)\n+#if defined(CMS_NO_REGISTER_KEYWORD) && !defined(CMS_DLL) && !defined(CMS_DLL_BUILD)\n@@ -322,1 +322,0 @@\n-    cmsSigcicpType                          = 0x63696370,  \/\/ 'cicp'\n@@ -434,1 +433,0 @@\n-    cmsSigcicpTag                           = 0x63696370,  \/\/ 'cicp'\n@@ -700,2 +698,2 @@\n-\/\/                        4 3 2 10987 6 5 4 3 2 1 098 7654 321\n-\/\/                        M A O TTTTT U Y F P X S EEE CCCC BBB\n+\/\/                          3 2 10987 6 5 4 3 2 1 098 7654 321\n+\/\/                          A O TTTTT U Y F P X S EEE CCCC BBB\n@@ -703,1 +701,0 @@\n-\/\/            M: Premultiplied alpha (only works when extra samples is 1)\n@@ -716,1 +713,0 @@\n-#define PREMUL_SH(m)           ((m) << 23)\n@@ -730,1 +726,0 @@\n-#define T_PREMUL(m)           (((m)>>23)&1)\n@@ -759,0 +754,1 @@\n+\n@@ -774,0 +770,1 @@\n+\n@@ -787,1 +784,0 @@\n-#define TYPE_GRAYA_8_PREMUL    (COLORSPACE_SH(PT_GRAY)|EXTRA_SH(1)|CHANNELS_SH(1)|BYTES_SH(1)|PREMUL_SH(1))\n@@ -789,1 +785,0 @@\n-#define TYPE_GRAYA_16_PREMUL   (COLORSPACE_SH(PT_GRAY)|EXTRA_SH(1)|CHANNELS_SH(1)|BYTES_SH(2)|PREMUL_SH(1))\n@@ -806,1 +801,0 @@\n-#define TYPE_RGBA_8_PREMUL     (COLORSPACE_SH(PT_RGB)|EXTRA_SH(1)|CHANNELS_SH(3)|BYTES_SH(1)|PREMUL_SH(1))\n@@ -809,1 +803,0 @@\n-#define TYPE_RGBA_16_PREMUL    (COLORSPACE_SH(PT_RGB)|EXTRA_SH(1)|CHANNELS_SH(3)|BYTES_SH(2)|PREMUL_SH(1))\n@@ -814,1 +807,0 @@\n-#define TYPE_ARGB_8_PREMUL     (COLORSPACE_SH(PT_RGB)|EXTRA_SH(1)|CHANNELS_SH(3)|BYTES_SH(1)|SWAPFIRST_SH(1)|PREMUL_SH(1))\n@@ -817,1 +809,0 @@\n-#define TYPE_ARGB_16_PREMUL    (COLORSPACE_SH(PT_RGB)|EXTRA_SH(1)|CHANNELS_SH(3)|BYTES_SH(2)|SWAPFIRST_SH(1)|PREMUL_SH(1))\n@@ -820,1 +811,0 @@\n-#define TYPE_ABGR_8_PREMUL     (COLORSPACE_SH(PT_RGB)|EXTRA_SH(1)|CHANNELS_SH(3)|BYTES_SH(1)|DOSWAP_SH(1)|PREMUL_SH(1))\n@@ -823,1 +813,0 @@\n-#define TYPE_ABGR_16_PREMUL    (COLORSPACE_SH(PT_RGB)|EXTRA_SH(1)|CHANNELS_SH(3)|BYTES_SH(2)|DOSWAP_SH(1)|PREMUL_SH(1))\n@@ -828,1 +817,0 @@\n-#define TYPE_BGRA_8_PREMUL     (COLORSPACE_SH(PT_RGB)|EXTRA_SH(1)|CHANNELS_SH(3)|BYTES_SH(1)|DOSWAP_SH(1)|SWAPFIRST_SH(1)|PREMUL_SH(1))\n@@ -831,1 +819,0 @@\n-#define TYPE_BGRA_16_PREMUL    (COLORSPACE_SH(PT_RGB)|EXTRA_SH(1)|CHANNELS_SH(3)|BYTES_SH(2)|DOSWAP_SH(1)|SWAPFIRST_SH(1)|PREMUL_SH(1))\n@@ -948,1 +935,1 @@\n-\/\/ Named color index. Only 16 bits is allowed (don't check colorspace)\n+\/\/ Named color index. Only 16 bits allowed (don't check colorspace)\n@@ -956,2 +943,0 @@\n-#define TYPE_GRAYA_FLT        (FLOAT_SH(1)|COLORSPACE_SH(PT_GRAY)|CHANNELS_SH(1)|BYTES_SH(4)|EXTRA_SH(1))\n-#define TYPE_GRAYA_FLT_PREMUL (FLOAT_SH(1)|COLORSPACE_SH(PT_GRAY)|CHANNELS_SH(1)|BYTES_SH(4)|EXTRA_SH(1)|PREMUL_SH(1))\n@@ -961,1 +946,0 @@\n-#define TYPE_RGBA_FLT_PREMUL  (FLOAT_SH(1)|COLORSPACE_SH(PT_RGB)|EXTRA_SH(1)|CHANNELS_SH(3)|BYTES_SH(4)|PREMUL_SH(1))\n@@ -963,1 +947,0 @@\n-#define TYPE_ARGB_FLT_PREMUL  (FLOAT_SH(1)|COLORSPACE_SH(PT_RGB)|EXTRA_SH(1)|CHANNELS_SH(3)|BYTES_SH(4)|SWAPFIRST_SH(1)|PREMUL_SH(1))\n@@ -966,1 +949,0 @@\n-#define TYPE_BGRA_FLT_PREMUL  (FLOAT_SH(1)|COLORSPACE_SH(PT_RGB)|EXTRA_SH(1)|CHANNELS_SH(3)|BYTES_SH(4)|DOSWAP_SH(1)|SWAPFIRST_SH(1)|PREMUL_SH(1))\n@@ -968,1 +950,0 @@\n-#define TYPE_ABGR_FLT_PREMUL  (FLOAT_SH(1)|COLORSPACE_SH(PT_RGB)|EXTRA_SH(1)|CHANNELS_SH(3)|BYTES_SH(4)|DOSWAP_SH(1)|PREMUL_SH(1))\n@@ -1072,10 +1053,0 @@\n-typedef struct {\n-    cmsUInt8Number  ColourPrimaries;            \/\/ Recommendation ITU-T H.273\n-    cmsUInt8Number  TransferCharacteristics;    \/\/  (ISO\/IEC 23091-2)\n-    cmsUInt8Number  MatrixCoefficients;\n-    cmsUInt8Number  VideoFullRangeFlag;\n-\n-} cmsVideoSignalType;\n-\n-\n-\n@@ -1317,1 +1288,0 @@\n-CMSAPI cmsContext        CMSEXPORT cmsGetStageContextID(const cmsStage* mpe);\n@@ -1564,1 +1534,0 @@\n-\/\/ Deprecated, use cmsChannelsOfColorSpace instead\n@@ -1567,3 +1536,0 @@\n-\/\/ Get number of channels of color space or -1 if color space is not listed\/supported\n-CMSAPI cmsInt32Number CMSEXPORT cmsChannelsOfColorSpace(cmsColorSpaceSignature ColorSpace);\n-\n@@ -1972,2 +1938,0 @@\n-\/\/ Estimate gamma space, always positive. Returns -1 on error.\n-CMSAPI cmsFloat64Number CMSEXPORT cmsDetectRGBProfileGamma(cmsHPROFILE hProfile, cmsFloat64Number threshold);\n","filename":"src\/java.desktop\/share\/native\/liblcms\/lcms2.h","additions":9,"deletions":45,"binary":false,"changes":54,"status":"modified"},{"patch":"@@ -33,1 +33,1 @@\n-\/\/  Copyright (c) 1998-2022 Marti Maria Saguer\n+\/\/  Copyright (c) 1998-2020 Marti Maria Saguer\n@@ -315,2 +315,2 @@\n-    EnterCriticalSection(m);\n-    return 0;\n+        EnterCriticalSection(m);\n+        return 0;\n@@ -321,2 +321,2 @@\n-    LeaveCriticalSection(m);\n-    return 0;\n+        LeaveCriticalSection(m);\n+        return 0;\n@@ -327,2 +327,2 @@\n-    InitializeCriticalSection(m);\n-    return 0;\n+        InitializeCriticalSection(m);\n+        return 0;\n@@ -333,2 +333,2 @@\n-    DeleteCriticalSection(m);\n-    return 0;\n+        DeleteCriticalSection(m);\n+        return 0;\n@@ -339,2 +339,2 @@\n-    EnterCriticalSection(m);\n-    return 0;\n+        EnterCriticalSection(m);\n+        return 0;\n@@ -345,2 +345,2 @@\n-    LeaveCriticalSection(m);\n-    return 0;\n+        LeaveCriticalSection(m);\n+        return 0;\n@@ -360,1 +360,1 @@\n-    return pthread_mutex_lock(m);\n+        return pthread_mutex_lock(m);\n@@ -365,1 +365,1 @@\n-    return pthread_mutex_unlock(m);\n+        return pthread_mutex_unlock(m);\n@@ -370,1 +370,1 @@\n-    return pthread_mutex_init(m, NULL);\n+        return pthread_mutex_init(m, NULL);\n@@ -375,1 +375,1 @@\n-    return pthread_mutex_destroy(m);\n+        return pthread_mutex_destroy(m);\n@@ -380,1 +380,1 @@\n-    return pthread_mutex_lock(m);\n+        return pthread_mutex_lock(m);\n@@ -385,1 +385,1 @@\n-    return pthread_mutex_unlock(m);\n+        return pthread_mutex_unlock(m);\n@@ -398,1 +398,1 @@\n-    return 0;\n+        return 0;\n@@ -404,1 +404,1 @@\n-    return 0;\n+        return 0;\n@@ -410,1 +410,1 @@\n-    return 0;\n+        return 0;\n@@ -416,1 +416,1 @@\n-    return 0;\n+        return 0;\n@@ -422,1 +422,1 @@\n-    return 0;\n+        return 0;\n@@ -428,1 +428,1 @@\n-    return 0;\n+        return 0;\n@@ -470,3 +470,0 @@\n-\/\/ Paralellization\n-cmsBool _cmsRegisterParallelizationPlugin(cmsContext ContextID, cmsPluginBase* Plugin);\n-\n@@ -520,1 +517,0 @@\n-    ParallelizationPlugin,\n@@ -756,18 +752,0 @@\n-\/\/ Container for parallelization plug-in\n-typedef struct {\n-\n-    cmsInt32Number      MaxWorkers;       \/\/ Number of workers to do as maximum\n-    cmsInt32Number      WorkerFlags;      \/\/ reserved\n-    _cmsTransform2Fn    SchedulerFn;      \/\/ callback to setup functions\n-\n-} _cmsParallelizationPluginChunkType;\n-\n-\/\/ The global Context0 storage for parallelization plug-in\n-extern  _cmsParallelizationPluginChunkType _cmsParallelizationPluginChunk;\n-\n-\/\/ Allocate parallelization container.\n-void _cmsAllocParallelizationPluginChunk(struct _cmsContext_struct* ctx,\n-                                         const struct _cmsContext_struct* src);\n-\n-\n-\n@@ -1135,5 +1113,0 @@\n-    \/\/ A one-worker transform entry for parallelization\n-    _cmsTransform2Fn Worker;\n-    cmsInt32Number   MaxWorkers;\n-    cmsUInt32Number  WorkerFlags;\n-\n@@ -1177,3 +1150,0 @@\n-\/\/ thread-safe gettime\n-cmsBool _cmsGetTime(struct tm* ptr_time);\n-\n","filename":"src\/java.desktop\/share\/native\/liblcms\/lcms2_internal.h","additions":25,"deletions":55,"binary":false,"changes":80,"status":"modified"},{"patch":"@@ -33,1 +33,1 @@\n-\/\/  Copyright (c) 1998-2022 Marti Maria Saguer\n+\/\/  Copyright (c) 1998-2020 Marti Maria Saguer\n@@ -56,1 +56,1 @@\n-\/\/ It is provided for plug-in writers that may want to access the support\n+\/\/ It is provided for plug-in writters that may want to access the support\n@@ -241,1 +241,0 @@\n-#define cmsPluginParalellizationSig          0x70726C48     \/\/ 'prlH\n@@ -629,1 +628,1 @@\n-                                     cmsUInt32Number Stride);                 \/\/ Stride in bytes to the next plane in planar formats\n+                                     cmsUInt32Number Stride);                 \/\/ Stride in bytes to the next plana in planar formats\n@@ -702,19 +701,0 @@\n-\/\/----------------------------------------------------------------------------------------------------------\n-\/\/ Parallelization\n-\n-CMSAPI _cmsTransform2Fn CMSEXPORT _cmsGetTransformWorker(struct _cmstransform_struct* CMMcargo);\n-CMSAPI cmsInt32Number   CMSEXPORT _cmsGetTransformMaxWorkers(struct _cmstransform_struct* CMMcargo);\n-CMSAPI cmsUInt32Number  CMSEXPORT _cmsGetTransformWorkerFlags(struct _cmstransform_struct* CMMcargo);\n-\n-\/\/ Let's plug-in to guess the best number of workers\n-#define CMS_GUESS_MAX_WORKERS -1\n-\n-typedef struct {\n-    cmsPluginBase       base;\n-\n-    cmsInt32Number      MaxWorkers;       \/\/ Number of starts to do as maximum\n-    cmsUInt32Number     WorkerFlags;      \/\/ Reserved\n-    _cmsTransform2Fn    SchedulerFn;      \/\/ callback to setup functions\n-\n-}  cmsPluginParalellization;\n-\n","filename":"src\/java.desktop\/share\/native\/liblcms\/lcms2_plugin.h","additions":3,"deletions":23,"binary":false,"changes":26,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2002, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2002, 2017, Oracle and\/or its affiliates. All rights reserved.\n@@ -366,1 +366,1 @@\n-     * (<code>MBeanRegistration<\/code> interface) method of the MBean\n+     * ((<code>MBeanRegistration<\/code> interface) method of the MBean\n","filename":"src\/java.management.rmi\/share\/classes\/javax\/management\/remote\/rmi\/RMIConnection.java","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 1999, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 1999, 2016, Oracle and\/or its affiliates. All rights reserved.\n@@ -396,0 +396,1 @@\n+      * @throws RuntimeOperationsException {@inheritDoc}\n@@ -401,1 +402,2 @@\n-     *\/\n+      * @throws RuntimeOperationsException {@inheritDoc}\n+    *\/\n","filename":"src\/java.management\/share\/classes\/javax\/management\/MBeanServer.java","additions":4,"deletions":2,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2002, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2002, 2013, Oracle and\/or its affiliates. All rights reserved.\n@@ -357,1 +357,1 @@\n-     * (<CODE>MBeanRegistration<\/CODE> interface) method of the MBean\n+     * ((<CODE>MBeanRegistration<\/CODE> interface) method of the MBean\n","filename":"src\/java.management\/share\/classes\/javax\/management\/MBeanServerConnection.java","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2015, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2015, 2020, Oracle and\/or its affiliates. All rights reserved.\n@@ -47,1 +47,0 @@\n-import static jdk.internal.net.http.HttpClientImpl.KEEP_ALIVE_TIMEOUT; \/\/seconds\n@@ -54,0 +53,2 @@\n+    static final long KEEP_ALIVE = Utils.getIntegerNetProperty(\n+            \"jdk.httpclient.keepalive.timeout\", 1200); \/\/ seconds\n@@ -170,1 +171,1 @@\n-        returnToPool(conn, Instant.now(), KEEP_ALIVE_TIMEOUT);\n+        returnToPool(conn, Instant.now(), KEEP_ALIVE);\n@@ -380,1 +381,1 @@\n-            add(conn, Instant.now(), KEEP_ALIVE_TIMEOUT);\n+            add(conn, Instant.now(), KEEP_ALIVE);\n","filename":"src\/java.net.http\/share\/classes\/jdk\/internal\/net\/http\/ConnectionPool.java","additions":5,"deletions":4,"binary":false,"changes":9,"status":"modified"},{"patch":"@@ -211,5 +211,0 @@\n-        @Override\n-        protected void onSubscribed() {\n-            exchange.registerResponseSubscriber(this);\n-        }\n-\n@@ -467,0 +462,1 @@\n+        registerResponseSubscriber(bs);\n","filename":"src\/java.net.http\/share\/classes\/jdk\/internal\/net\/http\/Http1Exchange.java","additions":1,"deletions":5,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -33,1 +33,0 @@\n-import java.net.http.HttpConnectTimeoutException;\n@@ -36,1 +35,0 @@\n-import java.time.Duration;\n@@ -126,1 +124,0 @@\n-    private IdleConnectionTimeoutEvent idleConnectionTimeoutEvent;  \/\/ may be null\n@@ -187,30 +184,0 @@\n-    \/\/ An Idle connection is one that has no active streams\n-    \/\/ and has not sent the final stream flag\n-    final class IdleConnectionTimeoutEvent extends TimeoutEvent {\n-\n-        private boolean fired;\n-\n-        IdleConnectionTimeoutEvent(Duration duration) {\n-            super(duration);\n-            fired = false;\n-        }\n-\n-        @Override\n-        public void handle() {\n-            fired = true;\n-            if (debug.on()) {\n-                debug.log(\"HTTP connection idle for too long\");\n-            }\n-            HttpConnectTimeoutException hte = new HttpConnectTimeoutException(\"HTTP connection idle, no active streams. Shutting down.\");\n-            shutdown(hte);\n-        }\n-\n-        @Override\n-        public String toString() {\n-            return \"IdleConnectionTimeoutEvent, \" + super.toString();\n-        }\n-\n-        public boolean isFired() {\n-            return fired;\n-        }\n-    }\n@@ -1018,2 +985,0 @@\n-    \/\/ Check if this is the last stream aside from stream 0,\n-    \/\/ arm timeout\n@@ -1043,12 +1008,0 @@\n-        } else {\n-            \/\/ Start timer if property present and not already created\n-            synchronized (this) {\n-                \/\/ idleConnectionTimerEvent is always accessed within a synchronized block\n-                if (streams.isEmpty() && idleConnectionTimeoutEvent == null) {\n-                    idleConnectionTimeoutEvent = client().idleConnectionTimeout()\n-                            .map(IdleConnectionTimeoutEvent::new).orElse(null);\n-                    if (idleConnectionTimeoutEvent != null) {\n-                        client().registerTimer(idleConnectionTimeoutEvent);\n-                    }\n-                }\n-            }\n@@ -1227,5 +1180,0 @@\n-                \/\/ idleConnectionTimerEvent is always accessed within a synchronized block\n-                if (idleConnectionTimeoutEvent != null) {\n-                    client().cancelTimer(idleConnectionTimeoutEvent);\n-                    idleConnectionTimeoutEvent = null;\n-                }\n","filename":"src\/java.net.http\/share\/classes\/jdk\/internal\/net\/http\/Http2Connection.java","additions":0,"deletions":52,"binary":false,"changes":52,"status":"modified"},{"patch":"@@ -115,4 +115,0 @@\n-    static final int DEFAULT_KEEP_ALIVE_TIMEOUT = 1200;\n-    static final long KEEP_ALIVE_TIMEOUT = getTimeoutProp(\"jdk.httpclient.keepalive.timeout\", DEFAULT_KEEP_ALIVE_TIMEOUT);\n-    \/\/ Defaults to value used for HTTP\/1 Keep-Alive Timeout. Can be overridden by jdk.httpclient.keepalive.timeout.h2 property.\n-    static final long IDLE_CONNECTION_TIMEOUT = getTimeoutProp(\"jdk.httpclient.keepalive.timeout.h2\", KEEP_ALIVE_TIMEOUT);\n@@ -1551,4 +1547,0 @@\n-    Optional<Duration> idleConnectionTimeout() {\n-        return Optional.ofNullable(getIdleConnectionTimeout());\n-    }\n-\n@@ -1719,19 +1711,0 @@\n-    private Duration getIdleConnectionTimeout() {\n-        if (IDLE_CONNECTION_TIMEOUT >= 0)\n-            return Duration.ofSeconds(IDLE_CONNECTION_TIMEOUT);\n-        return null;\n-    }\n-\n-    private static long getTimeoutProp(String prop, long def) {\n-        String s = Utils.getNetProperty(prop);\n-        try {\n-            if (s != null) {\n-                long timeoutVal = Long.parseLong(s);\n-                if (timeoutVal >= 0) return timeoutVal;\n-            }\n-        } catch (NumberFormatException ignored) {\n-            Log.logTrace(\"Invalid value set for \" + prop + \" property: \" + ignored.toString());\n-        }\n-        return def;\n-    }\n-\n","filename":"src\/java.net.http\/share\/classes\/jdk\/internal\/net\/http\/HttpClientImpl.java","additions":0,"deletions":27,"binary":false,"changes":27,"status":"modified"},{"patch":"@@ -347,0 +347,1 @@\n+        registerResponseSubscriber(subscriber);\n@@ -1545,5 +1546,0 @@\n-        @Override\n-        protected void onSubscribed() {\n-            registerResponseSubscriber(this);\n-        }\n-\n@@ -1553,1 +1549,1 @@\n-                unregisterResponseSubscriber(this);\n+                Stream.this.unregisterResponseSubscriber(this);\n@@ -1560,1 +1556,1 @@\n-            unregisterResponseSubscriber(this);\n+            Stream.this.unregisterResponseSubscriber(this);\n","filename":"src\/java.net.http\/share\/classes\/jdk\/internal\/net\/http\/Stream.java","additions":3,"deletions":7,"binary":false,"changes":10,"status":"modified"},{"patch":"@@ -33,1 +33,0 @@\n-import java.util.concurrent.CompletableFuture;\n@@ -39,1 +38,0 @@\n-import java.util.concurrent.locks.ReentrantLock;\n@@ -67,1 +65,0 @@\n-    final ReentrantLock subscriptionLock = new ReentrantLock();\n@@ -106,1 +103,0 @@\n-        assert completed.get();\n@@ -113,2 +109,1 @@\n-            subscriptionLock.lock();\n-            try {\n+            synchronized (this) {\n@@ -118,2 +113,0 @@\n-            } finally {\n-                subscriptionLock.unlock();\n@@ -137,9 +130,0 @@\n-    \/**\n-     * Called right before the userSubscriber::onSubscribe is called.\n-     * @apiNote\n-     * This method may be used by subclasses to perform cleanup\n-     * related actions after a subscription has been succesfully\n-     * accepted.\n-     *\/\n-    protected void onSubscribed() { }\n-\n@@ -188,2 +172,1 @@\n-        subscriptionLock.lock();\n-        try {\n+        synchronized (this) {\n@@ -191,1 +174,0 @@\n-                onSubscribed();\n@@ -195,1 +177,5 @@\n-                subscription.cancel();\n+                \/\/ could be already subscribed and completed\n+                \/\/ if an unexpected error occurred before the actual\n+                \/\/ subscription - though that's not supposed\n+                \/\/ happen.\n+                assert completed.get();\n@@ -197,2 +183,0 @@\n-        } finally {\n-            subscriptionLock.unlock();\n@@ -204,1 +188,0 @@\n-        assert subscribed.get();\n","filename":"src\/java.net.http\/share\/classes\/jdk\/internal\/net\/http\/common\/HttpBodySubscriberWrapper.java","additions":7,"deletions":24,"binary":false,"changes":31,"status":"modified"},{"patch":"@@ -22,1 +22,1 @@\n-.\\\" Automatically generated by Pandoc 2.19.2\n+.\\\" Automatically generated by Pandoc 2.3.1\n@@ -24,15 +24,1 @@\n-.\\\" Define V font for inline verbatim, using C font in formats\n-.\\\" that render this, and otherwise B font.\n-.ie \"\\f[CB]x\\f[R]\"x\" \\{\\\n-. ftr V B\n-. ftr VI BI\n-. ftr VB B\n-. ftr VBI BI\n-.\\}\n-.el \\{\\\n-. ftr V CR\n-. ftr VI CI\n-. ftr VB CB\n-. ftr VBI CBI\n-.\\}\n-.TH \"RMIREGISTRY\" \"1\" \"2023\" \"JDK 20-ea\" \"JDK Commands\"\n+.TH \"RMIREGISTRY\" \"1\" \"2023\" \"JDK 20\\-ea\" \"JDK Commands\"\n@@ -42,2 +28,2 @@\n-rmiregistry - create and start a remote object registry on the specified\n-port on the current host\n+rmiregistry \\- create and start a remote object registry on the\n+specified port on the current host\n@@ -46,1 +32,1 @@\n-\\f[V]rmiregistry\\f[R] [\\f[I]options\\f[R]] [\\f[I]port\\f[R]]\n+\\f[CB]rmiregistry\\f[R] [\\f[I]options\\f[R]] [\\f[I]port\\f[R]]\n@@ -48,2 +34,2 @@\n-\\f[I]options\\f[R]\n-This represents the option for the \\f[V]rmiregistry\\f[R] command.\n+.B \\f[I]options\\f[R]\n+This represents the option for the \\f[CB]rmiregistry\\f[R] command.\n@@ -51,0 +37,2 @@\n+.RS\n+.RE\n@@ -52,1 +40,1 @@\n-\\f[I]port\\f[R]\n+.B \\f[I]port\\f[R]\n@@ -55,0 +43,2 @@\n+.RS\n+.RE\n@@ -57,1 +47,1 @@\n-The \\f[V]rmiregistry\\f[R] command creates and starts a remote object\n+The \\f[CB]rmiregistry\\f[R] command creates and starts a remote object\n@@ -60,2 +50,2 @@\n-The \\f[V]rmiregistry\\f[R] command produces no output and is typically\n-run in the background, for example:\n+The \\f[CB]rmiregistry\\f[R] command produces no output and is typically run\n+in the background, for example:\n@@ -64,1 +54,1 @@\n-\\f[V]rmiregistry &\\f[R]\n+\\f[CB]rmiregistry\\ &\\f[R]\n@@ -74,2 +64,2 @@\n-That object then provides application-specific support for finding other\n-objects.\n+That object then provides application\\-specific support for finding\n+other objects.\n@@ -77,1 +67,1 @@\n-The methods of the \\f[V]java.rmi.registry.LocateRegistry\\f[R] class are\n+The methods of the \\f[CB]java.rmi.registry.LocateRegistry\\f[R] class are\n@@ -81,1 +71,1 @@\n-The URL-based methods of the \\f[V]java.rmi.Naming\\f[R] class operate on\n+The URL\\-based methods of the \\f[CB]java.rmi.Naming\\f[R] class operate on\n@@ -97,1 +87,1 @@\n-\\f[V]-J\\f[R]\\f[I]option\\f[R]\n+.B \\f[CB]\\-J\\f[R]\\f[I]option\\f[R]\n@@ -99,1 +89,1 @@\n-\\f[V]-J\\f[R] (no spaces between the \\f[V]-J\\f[R] and the option) to the\n+\\f[CB]\\-J\\f[R] (no spaces between the \\f[CB]\\-J\\f[R] and the option) to the\n@@ -101,0 +91,2 @@\n+.RS\n+.RE\n","filename":"src\/java.rmi\/share\/man\/rmiregistry.1","additions":24,"deletions":32,"binary":false,"changes":56,"status":"modified"},{"patch":"@@ -22,1 +22,1 @@\n-.\\\" Automatically generated by Pandoc 2.19.2\n+.\\\" Automatically generated by Pandoc 2.3.1\n@@ -24,15 +24,1 @@\n-.\\\" Define V font for inline verbatim, using C font in formats\n-.\\\" that render this, and otherwise B font.\n-.ie \"\\f[CB]x\\f[R]\"x\" \\{\\\n-. ftr V B\n-. ftr VI BI\n-. ftr VB B\n-. ftr VBI BI\n-.\\}\n-.el \\{\\\n-. ftr V CR\n-. ftr VI CI\n-. ftr VB CB\n-. ftr VBI CBI\n-.\\}\n-.TH \"JRUNSCRIPT\" \"1\" \"2023\" \"JDK 20-ea\" \"JDK Commands\"\n+.TH \"JRUNSCRIPT\" \"1\" \"2023\" \"JDK 20\\-ea\" \"JDK Commands\"\n@@ -42,1 +28,1 @@\n-jrunscript - run a command-line script shell that supports interactive\n+jrunscript \\- run a command\\-line script shell that supports interactive\n@@ -50,1 +36,1 @@\n-\\f[V]jrunscript\\f[R] [\\f[I]options\\f[R]] [\\f[I]arguments\\f[R]]\n+\\f[CB]jrunscript\\f[R] [\\f[I]options\\f[R]] [\\f[I]arguments\\f[R]]\n@@ -52,2 +38,2 @@\n-\\f[I]options\\f[R]\n-This represents the \\f[V]jrunscript\\f[R] command-line options that can\n+.B \\f[I]options\\f[R]\n+This represents the \\f[CB]jrunscript\\f[R] command\\-line options that can\n@@ -56,0 +42,2 @@\n+.RS\n+.RE\n@@ -57,1 +45,1 @@\n-\\f[I]arguments\\f[R]\n+.B \\f[I]arguments\\f[R]\n@@ -61,0 +49,2 @@\n+.RS\n+.RE\n@@ -63,1 +53,1 @@\n-The \\f[V]jrunscript\\f[R] command is a language-independent command-line\n+The \\f[CB]jrunscript\\f[R] command is a language\\-independent command\\-line\n@@ -65,4 +55,4 @@\n-The \\f[V]jrunscript\\f[R] command supports both an interactive\n-(read-eval-print) mode and a batch (\\f[V]-f\\f[R] option) mode of script\n-execution.\n-By default, JavaScript is the language used, but the \\f[V]-l\\f[R] option\n+The \\f[CB]jrunscript\\f[R] command supports both an interactive\n+(read\\-eval\\-print) mode and a batch (\\f[CB]\\-f\\f[R] option) mode of\n+script execution.\n+By default, JavaScript is the language used, but the \\f[CB]\\-l\\f[R] option\n@@ -71,1 +61,1 @@\n-\\f[V]jrunscript\\f[R] command supports an exploratory programming style.\n+\\f[CB]jrunscript\\f[R] command supports an exploratory programming style.\n@@ -74,1 +64,1 @@\n-the \\f[V]jrunscript\\f[R] command initializes certain built-in functions\n+the \\f[CB]jrunscript\\f[R] command initializes certain built\\-in functions\n@@ -76,1 +66,1 @@\n-\\f[V]jrunscript\\f[R] JavaScript built-in functions.\n+\\f[CB]jrunscript\\f[R] JavaScript built\\-in functions.\n@@ -79,1 +69,1 @@\n-\\f[V]-cp\\f[R] \\f[I]path\\f[R] or \\f[V]-classpath\\f[R] \\f[I]path\\f[R]\n+.B \\f[CB]\\-cp\\f[R] \\f[I]path\\f[R] or \\f[CB]\\-classpath\\f[R] \\f[I]path\\f[R]\n@@ -81,0 +71,2 @@\n+.RS\n+.RE\n@@ -82,1 +74,1 @@\n-\\f[V]-D\\f[R]\\f[I]name\\f[R]\\f[V]=\\f[R]\\f[I]value\\f[R]\n+.B \\f[CB]\\-D\\f[R]\\f[I]name\\f[R]\\f[CB]=\\f[R]\\f[I]value\\f[R]\n@@ -84,0 +76,2 @@\n+.RS\n+.RE\n@@ -85,1 +79,1 @@\n-\\f[V]-J\\f[R]\\f[I]flag\\f[R]\n+.B \\f[CB]\\-J\\f[R]\\f[I]flag\\f[R]\n@@ -87,1 +81,3 @@\n-\\f[V]jrunscript\\f[R] command is running.\n+\\f[CB]jrunscript\\f[R] command is running.\n+.RS\n+.RE\n@@ -89,1 +85,1 @@\n-\\f[V]-l\\f[R] \\f[I]language\\f[R]\n+.B \\f[CB]\\-l\\f[R] \\f[I]language\\f[R]\n@@ -93,2 +89,4 @@\n-script engine\\[aq]s JAR file with the \\f[V]-cp\\f[R] or\n-\\f[V]-classpath\\f[R] option.\n+script engine\\[aq]s JAR file with the \\f[CB]\\-cp\\f[R] or\n+\\f[CB]\\-classpath\\f[R] option.\n+.RS\n+.RE\n@@ -96,1 +94,1 @@\n-\\f[V]-e\\f[R] \\f[I]script\\f[R]\n+.B \\f[CB]\\-e\\f[R] \\f[I]script\\f[R]\n@@ -98,1 +96,1 @@\n-This option can be used to run one-line scripts that are specified\n+This option can be used to run one\\-line scripts that are specified\n@@ -100,0 +98,2 @@\n+.RS\n+.RE\n@@ -101,1 +101,1 @@\n-\\f[V]-encoding\\f[R] \\f[I]encoding\\f[R]\n+.B \\f[CB]\\-encoding\\f[R] \\f[I]encoding\\f[R]\n@@ -103,0 +103,2 @@\n+.RS\n+.RE\n@@ -104,1 +106,1 @@\n-\\f[V]-f\\f[R] \\f[I]script-file\\f[R]\n+.B \\f[CB]\\-f\\f[R] \\f[I]script\\-file\\f[R]\n@@ -106,0 +108,2 @@\n+.RS\n+.RE\n@@ -107,1 +111,1 @@\n-\\f[V]-f -\\f[R]\n+.B \\f[CB]\\-f\\ \\-\\f[R]\n@@ -110,0 +114,2 @@\n+.RS\n+.RE\n@@ -111,1 +117,1 @@\n-\\f[V]-help\\f[R] or \\f[V]-?\\f[R]\n+.B \\f[CB]\\-help\\f[R] or \\f[CB]\\-?\\f[R]\n@@ -113,0 +119,2 @@\n+.RS\n+.RE\n@@ -114,1 +122,1 @@\n-\\f[V]-q\\f[R]\n+.B \\f[CB]\\-q\\f[R]\n@@ -116,0 +124,2 @@\n+.RS\n+.RE\n@@ -118,1 +128,1 @@\n-If arguments are present and if no \\f[V]-e\\f[R] or \\f[V]-f\\f[R] option\n+If arguments are present and if no \\f[CB]\\-e\\f[R] or \\f[CB]\\-f\\f[R] option\n@@ -121,1 +131,1 @@\n-If arguments and the \\f[V]-e\\f[R] or the \\f[V]-f\\f[R] option are used,\n+If arguments and the \\f[CB]\\-e\\f[R] or the \\f[CB]\\-f\\f[R] option are used,\n@@ -123,1 +133,1 @@\n-If arguments \\f[V]-e\\f[R] and \\f[V]-f\\f[R] are missing, then the\n+If arguments \\f[CB]\\-e\\f[R] and \\f[CB]\\-f\\f[R] are missing, then the\n@@ -128,1 +138,1 @@\n-\\f[V]jrunscript -e \\[dq]print(\\[aq]hello world\\[aq])\\[dq]\\f[R]\n+\\f[CB]jrunscript\\ \\-e\\ \"print(\\[aq]hello\\ world\\[aq])\"\\f[R]\n@@ -132,1 +142,1 @@\n-\\f[V]jrunscript -e \\[dq]cat(\\[aq]http:\/\/www.example.com\\[aq])\\[dq]\\f[R]\n+\\f[CB]jrunscript\\ \\-e\\ \"cat(\\[aq]http:\/\/www.example.com\\[aq])\"\\f[R]\n@@ -137,1 +147,1 @@\n-\\f[V]jrunscript -l js -f test.js\\f[R]\n+\\f[CB]jrunscript\\ \\-l\\ js\\ \\-f\\ test.js\\f[R]\n@@ -144,3 +154,3 @@\n-js> print(\\[aq]Hello World\\[rs]n\\[aq]);\n-Hello World\n-js> 34 + 55\n+js>\\ print(\\[aq]Hello\\ World\\\\n\\[aq]);\n+Hello\\ World\n+js>\\ 34\\ +\\ 55\n@@ -148,4 +158,4 @@\n-js> t = new java.lang.Thread(function() { print(\\[aq]Hello World\\[rs]n\\[aq]); })\n-Thread[Thread-0,5,main]\n-js> t.start()\n-js> Hello World\n+js>\\ t\\ =\\ new\\ java.lang.Thread(function()\\ {\\ print(\\[aq]Hello\\ World\\\\n\\[aq]);\\ })\n+Thread[Thread\\-0,5,main]\n+js>\\ t.start()\n+js>\\ Hello\\ World\n@@ -158,3 +168,3 @@\n-In this example, the \\f[V]test.js\\f[R] file is the script file.\n-The \\f[V]arg1\\f[R], \\f[V]arg2\\f[R], and \\f[V]arg3\\f[R] arguments are\n-passed to the script.\n+In this example, the \\f[CB]test.js\\f[R] file is the script file.\n+The \\f[CB]arg1\\f[R], \\f[CB]arg2\\f[R], and \\f[CB]arg3\\f[R] arguments are passed\n+to the script.\n@@ -164,1 +174,1 @@\n-\\f[V]jrunscript test.js arg1 arg2 arg3\\f[R]\n+\\f[CB]jrunscript\\ test.js\\ arg1\\ arg2\\ arg3\\f[R]\n","filename":"src\/java.scripting\/share\/man\/jrunscript.1","additions":70,"deletions":60,"binary":false,"changes":130,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2005, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2005, 2013, Oracle and\/or its affiliates. All rights reserved.\n@@ -90,1 +90,1 @@\n-     * Returns a copy of the data bytes in the response body. If this APDU has\n+     * Returns a copy of the data bytes in the response body. If this APDU as\n","filename":"src\/java.smartcardio\/share\/classes\/javax\/smartcardio\/ResponseAPDU.java","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -990,1 +990,1 @@\n-                        \"getCellEditor\", nullClass);\n+                        \"getCellEditorMethod\", nullClass);\n@@ -1636,1 +1636,1 @@\n-                        \"getCellEditor\", nullClass);\n+                        \"getCellEditorMethod\", nullClass);\n","filename":"src\/jdk.accessibility\/share\/classes\/com\/sun\/java\/accessibility\/util\/SwingEventMonitor.java","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -217,0 +217,2 @@\n+        } else if (fm.getClass().getName().equals(\"com.sun.tools.sjavac.comp.SmartFileManager\")) {\n+            useCtProps = !options.isSet(\"ignore.symbol.file\");\n","filename":"src\/jdk.compiler\/share\/classes\/com\/sun\/tools\/javac\/code\/ClassFinder.java","additions":2,"deletions":0,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -122,1 +122,0 @@\n-        qualifiedSymbolCache = new HashMap<>();\n@@ -3621,50 +3620,0 @@\n-    \/** Cache the symbol to reflect the qualifying type.\n-     *  key: corresponding type\n-     *  value: qualified symbol\n-     *\/\n-    private Map<Type, Symbol> qualifiedSymbolCache;\n-\n-    public void clearQualifiedSymbolCache() {\n-        qualifiedSymbolCache.clear();\n-    }\n-\n-    \/** Construct a symbol to reflect the qualifying type that should\n-     *  appear in the byte code as per JLS 13.1.\n-     *\n-     *  For {@literal target >= 1.2}: Clone a method with the qualifier as owner (except\n-     *  for those cases where we need to work around VM bugs).\n-     *\n-     *  For {@literal target <= 1.1}: If qualified variable or method is defined in a\n-     *  non-accessible class, clone it with the qualifier class as owner.\n-     *\n-     *  @param sym    The accessed symbol\n-     *  @param site   The qualifier's type.\n-     *\/\n-    public Symbol binaryQualifier(Symbol sym, Type site) {\n-\n-        if (site.hasTag(ARRAY)) {\n-            if (sym == syms.lengthVar ||\n-                    sym.owner != syms.arrayClass)\n-                return sym;\n-            \/\/ array clone can be qualified by the array type in later targets\n-            Symbol qualifier;\n-            if ((qualifier = qualifiedSymbolCache.get(site)) == null) {\n-                qualifier = new ClassSymbol(Flags.PUBLIC, site.tsym.name, site, syms.noSymbol);\n-                qualifiedSymbolCache.put(site, qualifier);\n-            }\n-            return sym.clone(qualifier);\n-        }\n-\n-        if (sym.owner == site.tsym ||\n-                (sym.flags() & (STATIC | SYNTHETIC)) == (STATIC | SYNTHETIC)) {\n-            return sym;\n-        }\n-\n-        \/\/ leave alone methods inherited from Object\n-        \/\/ JLS 13.1.\n-        if (sym.owner == syms.objectType.tsym)\n-            return sym;\n-\n-        return sym.clone(site.tsym);\n-    }\n-\n","filename":"src\/jdk.compiler\/share\/classes\/com\/sun\/tools\/javac\/code\/Types.java","additions":0,"deletions":51,"binary":false,"changes":51,"status":"modified"},{"patch":"@@ -2178,0 +2178,4 @@\n+                if (tree.sym == null) {\n+                    return;\n+                }\n+\n@@ -2264,0 +2268,9 @@\n+                if (tree.body == null) {\n+                    return;\n+                }\n+                \/*  Ignore synthetic methods, except for translated lambda methods.\n+                 *\/\n+                if ((tree.sym.flags() & (SYNTHETIC | LAMBDA_METHOD)) == SYNTHETIC) {\n+                    return;\n+                }\n+\n","filename":"src\/jdk.compiler\/share\/classes\/com\/sun\/tools\/javac\/comp\/Flow.java","additions":13,"deletions":0,"binary":false,"changes":13,"status":"modified"},{"patch":"@@ -521,3 +521,0 @@\n-        if (init != null) {\n-            refSym = (MethodSymbol) types.binaryQualifier(refSym, init.type);\n-        }\n","filename":"src\/jdk.compiler\/share\/classes\/com\/sun\/tools\/javac\/comp\/LambdaToMethod.java","additions":0,"deletions":3,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -3114,2 +3114,1 @@\n-        boolean isStaticSelector = TreeInfo.isStaticSelector(referenceTree.expr, names);\n-        ReferenceLookupResult boundRes = new ReferenceLookupResult(boundSym, boundSearchResolveContext, isStaticSelector);\n+        ReferenceLookupResult boundRes = new ReferenceLookupResult(boundSym, boundSearchResolveContext);\n@@ -3131,1 +3130,1 @@\n-            unboundRes = new ReferenceLookupResult(unboundSym, unboundSearchResolveContext, isStaticSelector);\n+            unboundRes = new ReferenceLookupResult(unboundSym, unboundSearchResolveContext);\n@@ -3242,2 +3241,2 @@\n-        ReferenceLookupResult(Symbol sym, MethodResolutionContext resolutionContext, boolean isStaticSelector) {\n-            this(sym, staticKind(sym, resolutionContext, isStaticSelector));\n+        ReferenceLookupResult(Symbol sym, MethodResolutionContext resolutionContext) {\n+            this(sym, staticKind(sym, resolutionContext));\n@@ -3251,11 +3250,11 @@\n-        private static StaticKind staticKind(Symbol sym, MethodResolutionContext resolutionContext, boolean isStaticSelector) {\n-            if (sym.kind == MTH && !isStaticSelector) {\n-                return StaticKind.from(sym);\n-            } else if (sym.kind == MTH || sym.kind == AMBIGUOUS) {\n-                return resolutionContext.candidates.stream()\n-                        .filter(c -> c.isApplicable() && c.step == resolutionContext.step)\n-                        .map(c -> StaticKind.from(c.sym))\n-                        .reduce(StaticKind::reduce)\n-                        .orElse(StaticKind.UNDEFINED);\n-            } else {\n-                return StaticKind.UNDEFINED;\n+        private static StaticKind staticKind(Symbol sym, MethodResolutionContext resolutionContext) {\n+            switch (sym.kind) {\n+                case MTH:\n+                case AMBIGUOUS:\n+                    return resolutionContext.candidates.stream()\n+                            .filter(c -> c.isApplicable() && c.step == resolutionContext.step)\n+                            .map(c -> StaticKind.from(c.sym))\n+                            .reduce(StaticKind::reduce)\n+                            .orElse(StaticKind.UNDEFINED);\n+                default:\n+                    return StaticKind.UNDEFINED;\n","filename":"src\/jdk.compiler\/share\/classes\/com\/sun\/tools\/javac\/comp\/Resolve.java","additions":15,"deletions":16,"binary":false,"changes":31,"status":"modified"},{"patch":"@@ -133,0 +133,1 @@\n+        qualifiedSymbolCache = new HashMap<>();\n@@ -174,0 +175,6 @@\n+    \/** Cache the symbol to reflect the qualifying type.\n+     *  key: corresponding type\n+     *  value: qualified symbol\n+     *\/\n+    Map<Type, Symbol> qualifiedSymbolCache;\n+\n@@ -217,0 +224,40 @@\n+    \/** Construct a symbol to reflect the qualifying type that should\n+     *  appear in the byte code as per JLS 13.1.\n+     *\n+     *  For {@literal target >= 1.2}: Clone a method with the qualifier as owner (except\n+     *  for those cases where we need to work around VM bugs).\n+     *\n+     *  For {@literal target <= 1.1}: If qualified variable or method is defined in a\n+     *  non-accessible class, clone it with the qualifier class as owner.\n+     *\n+     *  @param sym    The accessed symbol\n+     *  @param site   The qualifier's type.\n+     *\/\n+    Symbol binaryQualifier(Symbol sym, Type site) {\n+\n+        if (site.hasTag(ARRAY)) {\n+            if (sym == syms.lengthVar ||\n+                sym.owner != syms.arrayClass)\n+                return sym;\n+            \/\/ array clone can be qualified by the array type in later targets\n+            Symbol qualifier;\n+            if ((qualifier = qualifiedSymbolCache.get(site)) == null) {\n+                qualifier = new ClassSymbol(Flags.PUBLIC, site.tsym.name, site, syms.noSymbol);\n+                qualifiedSymbolCache.put(site, qualifier);\n+            }\n+            return sym.clone(qualifier);\n+        }\n+\n+        if (sym.owner == site.tsym ||\n+            (sym.flags() & (STATIC | SYNTHETIC)) == (STATIC | SYNTHETIC)) {\n+            return sym;\n+        }\n+\n+        \/\/ leave alone methods inherited from Object\n+        \/\/ JLS 13.1.\n+        if (sym.owner == syms.objectType.tsym)\n+            return sym;\n+\n+        return sym.clone(site.tsym);\n+    }\n+\n@@ -2236,1 +2283,1 @@\n-                sym = types.binaryQualifier(sym, env.enclClass.type);\n+                sym = binaryQualifier(sym, env.enclClass.type);\n@@ -2240,1 +2287,1 @@\n-            sym = types.binaryQualifier(sym, env.enclClass.type);\n+            sym = binaryQualifier(sym, env.enclClass.type);\n@@ -2293,1 +2340,1 @@\n-                sym = types.binaryQualifier(sym, tree.selected.type);\n+                sym = binaryQualifier(sym, tree.selected.type);\n@@ -2399,1 +2446,1 @@\n-            types.clearQualifiedSymbolCache();\n+            qualifiedSymbolCache.clear();\n","filename":"src\/jdk.compiler\/share\/classes\/com\/sun\/tools\/javac\/jvm\/Gen.java","additions":51,"deletions":4,"binary":false,"changes":55,"status":"modified"},{"patch":"@@ -85,2 +85,1 @@\n-    Check that API used is available in the specified profile.\\n\\\n-    This option is deprecated and may be removed in a future release.\n+    Check that API used is available in the specified profile\n@@ -129,0 +128,2 @@\n+javac.opt.arg.release=\\\n+    <release>\n","filename":"src\/jdk.compiler\/share\/classes\/com\/sun\/tools\/javac\/resources\/javac.properties","additions":3,"deletions":2,"binary":false,"changes":5,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2015, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2015, Oracle and\/or its affiliates. All rights reserved.\n@@ -26,1 +26,1 @@\n-package javacserver;\n+package com.sun.tools.sjavac;\n","filename":"src\/jdk.compiler\/share\/classes\/com\/sun\/tools\/sjavac\/AutoFlushWriter.java","additions":2,"deletions":2,"binary":false,"changes":4,"previous_filename":"make\/langtools\/tools\/javacserver\/AutoFlushWriter.java","status":"renamed"},{"patch":"@@ -0,0 +1,299 @@\n+\/*\n+ * Copyright (c) 2012, 2015, Oracle and\/or its affiliates. All rights reserved.\n+ * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+ *\n+ * This code is free software; you can redistribute it and\/or modify it\n+ * under the terms of the GNU General Public License version 2 only, as\n+ * published by the Free Software Foundation.  Oracle designates this\n+ * particular file as subject to the \"Classpath\" exception as provided\n+ * by Oracle in the LICENSE file that accompanied this code.\n+ *\n+ * This code is distributed in the hope that it will be useful, but WITHOUT\n+ * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+ * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+ * version 2 for more details (a copy is included in the LICENSE file that\n+ * accompanied this code).\n+ *\n+ * You should have received a copy of the GNU General Public License version\n+ * 2 along with this work; if not, write to the Free Software Foundation,\n+ * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n+ *\n+ * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n+ * or visit www.oracle.com if you need additional information or have any\n+ * questions.\n+ *\/\n+\n+package com.sun.tools.sjavac;\n+\n+import java.io.File;\n+import java.util.Collections;\n+import java.util.HashMap;\n+import java.util.Map;\n+import java.util.Set;\n+\n+import com.sun.tools.javac.util.Assert;\n+import com.sun.tools.sjavac.pubapi.PubApi;\n+\n+\/**\n+ * The build state class captures the source code and generated artifacts\n+ * from a build. There are usually two build states, the previous one (prev),\n+ * loaded from the javac_state file, and the current one (now).\n+ *\n+ *  <p><b>This is NOT part of any supported API.\n+ *  If you write code that depends on this, you do so at your own risk.\n+ *  This code and its internal interfaces are subject to change or\n+ *  deletion without notice.<\/b>\n+ *\/\n+public class BuildState {\n+    private Map<String,Module> modules = new HashMap<>();\n+    private Map<String,Package> packages = new HashMap<>();\n+    private Map<String,Source> sources = new HashMap<>();\n+    private Map<String,File> artifacts = new HashMap<>();\n+    \/\/ Map from package to a set of packages that depend on said package.\n+    private Map<String,Set<String>> dependents = new HashMap<>();\n+\n+    public  Map<String,Module> modules() { return modules; }\n+    public  Map<String,Package> packages() { return packages; }\n+    public  Map<String,Source> sources() { return sources; }\n+    public  Map<String,File> artifacts() { return artifacts; }\n+    public  Map<String,Set<String>> dependents() { return dependents; }\n+\n+    \/**\n+     * Lookup a module from a name. Create the module if it does\n+     * not exist yet.\n+     *\/\n+    public Module lookupModule(String mod) {\n+        Module m = modules.get(mod);\n+        if (m == null) {\n+            m = new Module(mod, \"???\");\n+            modules.put(mod, m);\n+        }\n+        return m;\n+    }\n+\n+    \/**\n+     * Find a module from a given package name. For example:\n+     * The package name \"base:java.lang\" will fetch the module named \"base\".\n+     * The package name \":java.net\" will fetch the default module.\n+     *\/\n+    Module findModuleFromPackageName(String pkg) {\n+        int cp = pkg.indexOf(':');\n+        Assert.check(cp != -1, \"Could not find package name\");\n+        String mod = pkg.substring(0, cp);\n+        return lookupModule(mod);\n+    }\n+\n+    \/**\n+     * Store references to all packages, sources and artifacts for all modules\n+     * into the build state. I.e. flatten the module tree structure\n+     * into global maps stored in the BuildState for easy access.\n+     *\n+     * @param m The set of modules.\n+     *\/\n+    public void flattenPackagesSourcesAndArtifacts(Map<String,Module> m) {\n+        modules = m;\n+        \/\/ Extract all the found packages.\n+        for (Module i : modules.values()) {\n+            for (Map.Entry<String,Package> j : i.packages().entrySet()) {\n+                Package p = packages.get(j.getKey());\n+                \/\/ Check that no two different packages are stored under same name.\n+                Assert.check(p == null || p == j.getValue());\n+                if (p == null) {\n+                    p = j.getValue();\n+                    packages.put(j.getKey(),j.getValue());\n+                }\n+                for (Map.Entry<String,Source> k : p.sources().entrySet()) {\n+                    Source s = sources.get(k.getKey());\n+                    \/\/ Check that no two different sources are stored under same name.\n+                    Assert.check(s == null || s == k.getValue());\n+                    if (s == null) {\n+                        s = k.getValue();\n+                        sources.put(k.getKey(), k.getValue());\n+                    }\n+                }\n+                for (Map.Entry<String,File> g : p.artifacts().entrySet()) {\n+                    File f = artifacts.get(g.getKey());\n+                    \/\/ Check that no two artifacts are stored under the same file.\n+                    Assert.check(f == null || f == g.getValue());\n+                    if (f == null) {\n+                        f = g.getValue();\n+                        artifacts.put(g.getKey(), g.getValue());\n+                    }\n+                }\n+            }\n+        }\n+    }\n+\n+    \/**\n+     * Store references to all artifacts found in the module tree into the maps\n+     * stored in the build state.\n+     *\n+     * @param m The set of modules.\n+     *\/\n+    public void flattenArtifacts(Map<String,Module> m) {\n+        modules = m;\n+        \/\/ Extract all the found packages.\n+        for (Module i : modules.values()) {\n+            for (Map.Entry<String,Package> j : i.packages().entrySet()) {\n+                Package p = packages.get(j.getKey());\n+                \/\/ Check that no two different packages are stored under same name.\n+                Assert.check(p == null || p == j.getValue());\n+                p = j.getValue();\n+                packages.put(j.getKey(),j.getValue());\n+                for (Map.Entry<String,File> g : p.artifacts().entrySet()) {\n+                    File f = artifacts.get(g.getKey());\n+                    \/\/ Check that no two artifacts are stored under the same file.\n+                    Assert.check(f == null || f == g.getValue());\n+                    artifacts.put(g.getKey(), g.getValue());\n+                }\n+            }\n+        }\n+    }\n+\n+    \/**\n+     * Calculate the package dependents (ie the reverse of the dependencies).\n+     *\/\n+    public void calculateDependents() {\n+        dependents = new HashMap<>();\n+\n+        for (String s : packages.keySet()) {\n+            Package p = packages.get(s);\n+\n+            \/\/ Collect all dependencies of the classes in this package\n+            Set<String> deps = p.typeDependencies()  \/\/ maps fqName -> set of dependencies\n+                                .values()\n+                                .stream()\n+                                .reduce(Collections.emptySet(), Util::union);\n+\n+            \/\/ Now reverse the direction\n+\n+            for (String dep : deps) {\n+                \/\/ Add the dependent information to the global dependent map.\n+                String depPkgStr = \":\" + dep.substring(0, dep.lastIndexOf('.'));\n+                dependents.merge(depPkgStr, Collections.singleton(s), Util::union);\n+\n+                \/\/ Also add the dependent information to the package specific map.\n+                \/\/ Normally, you do not compile java.lang et al. Therefore\n+                \/\/ there are several packages that p depends upon that you\n+                \/\/ do not have in your state database. This is perfectly fine.\n+                Package dp = packages.get(depPkgStr);\n+                if (dp != null) {\n+                    \/\/ But this package did exist in the state database.\n+                    dp.addDependent(p.name());\n+                }\n+            }\n+        }\n+    }\n+\n+    \/**\n+     * Verify that the setModules method above did the right thing when\n+     * running through the {@literal module->package->source} structure.\n+     *\/\n+    public void checkInternalState(String msg, boolean linkedOnly, Map<String,Source> srcs) {\n+        boolean baad = false;\n+        Map<String,Source> original = new HashMap<>();\n+        Map<String,Source> calculated = new HashMap<>();\n+\n+        for (String s : sources.keySet()) {\n+            Source ss = sources.get(s);\n+            if (ss.isLinkedOnly() == linkedOnly) {\n+                calculated.put(s,ss);\n+            }\n+        }\n+        for (String s : srcs.keySet()) {\n+            Source ss = srcs.get(s);\n+            if (ss.isLinkedOnly() == linkedOnly) {\n+                original.put(s,ss);\n+            }\n+        }\n+        if (original.size() != calculated.size()) {\n+            Log.error(\"INTERNAL ERROR \"+msg+\" original and calculated are not the same size!\");\n+            baad = true;\n+        }\n+        if (!original.keySet().equals(calculated.keySet())) {\n+            Log.error(\"INTERNAL ERROR \"+msg+\" original and calculated do not have the same domain!\");\n+            baad = true;\n+        }\n+        if (!baad) {\n+            for (String s : original.keySet()) {\n+                Source s1 = original.get(s);\n+                Source s2 = calculated.get(s);\n+                if (s1 == null || s2 == null || !s1.equals(s2)) {\n+                    Log.error(\"INTERNAL ERROR \"+msg+\" original and calculated have differing elements for \"+s);\n+                }\n+                baad = true;\n+            }\n+        }\n+        if (baad) {\n+            for (String s : original.keySet()) {\n+                Source ss = original.get(s);\n+                Source sss = calculated.get(s);\n+                if (sss == null) {\n+                    Log.error(\"The file \"+s+\" does not exist in calculated tree of sources.\");\n+                }\n+            }\n+            for (String s : calculated.keySet()) {\n+                Source ss = calculated.get(s);\n+                Source sss = original.get(s);\n+                if (sss == null) {\n+                    Log.error(\"The file \"+s+\" does not exist in original set of found sources.\");\n+                }\n+            }\n+        }\n+    }\n+\n+    \/**\n+     * Load a module from the javac state file.\n+     *\/\n+    public Module loadModule(String l) {\n+        Module m = Module.load(l);\n+        modules.put(m.name(), m);\n+        return m;\n+    }\n+\n+    \/**\n+     * Load a package from the javac state file.\n+     *\/\n+    public Package loadPackage(Module lastModule, String l) {\n+        Package p = Package.load(lastModule, l);\n+        lastModule.addPackage(p);\n+        packages.put(p.name(), p);\n+        return p;\n+    }\n+\n+    \/**\n+     * Load a source from the javac state file.\n+     *\/\n+    public Source loadSource(Package lastPackage, String l, boolean is_generated) {\n+        Source s = Source.load(lastPackage, l, is_generated);\n+        lastPackage.addSource(s);\n+        sources.put(s.name(), s);\n+        return s;\n+    }\n+\n+    \/**\n+     * During an incremental compile we need to copy the old javac state\n+     * information about packages that were not recompiled.\n+     *\/\n+    public void copyPackagesExcept(BuildState prev, Set<String> recompiled, Set<String> removed) {\n+        for (String pkg : prev.packages().keySet()) {\n+            \/\/ Do not copy recompiled or removed packages.\n+            if (recompiled.contains(pkg) || removed.contains(pkg))\n+                continue;\n+\n+            Module mnew = findModuleFromPackageName(pkg);\n+            Package pprev = prev.packages().get(pkg);\n+\n+            \/\/ Even though we haven't recompiled this package, we may have\n+            \/\/ information about its public API: It may be a classpath dependency\n+            if (packages.containsKey(pkg)) {\n+                pprev.setPubapi(PubApi.mergeTypes(pprev.getPubApi(),\n+                                                  packages.get(pkg).getPubApi()));\n+            }\n+\n+            mnew.addPackage(pprev);\n+            \/\/ Do not forget to update the flattened data. (See JDK-8071904)\n+            packages.put(pkg, pprev);\n+        }\n+    }\n+}\n","filename":"src\/jdk.compiler\/share\/classes\/com\/sun\/tools\/sjavac\/BuildState.java","additions":299,"deletions":0,"binary":false,"changes":299,"status":"added"},{"patch":"@@ -0,0 +1,159 @@\n+\/*\n+ * Copyright (c) 2001, 2016, Oracle and\/or its affiliates. All rights reserved.\n+ * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+ *\n+ * This code is free software; you can redistribute it and\/or modify it\n+ * under the terms of the GNU General Public License version 2 only, as\n+ * published by the Free Software Foundation.  Oracle designates this\n+ * particular file as subject to the \"Classpath\" exception as provided\n+ * by Oracle in the LICENSE file that accompanied this code.\n+ *\n+ * This code is distributed in the hope that it will be useful, but WITHOUT\n+ * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+ * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+ * version 2 for more details (a copy is included in the LICENSE file that\n+ * accompanied this code).\n+ *\n+ * You should have received a copy of the GNU General Public License version\n+ * 2 along with this work; if not, write to the Free Software Foundation,\n+ * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n+ *\n+ * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n+ * or visit www.oracle.com if you need additional information or have any\n+ * questions.\n+ *\/\n+\n+package com.sun.tools.sjavac;\n+\n+import java.io.BufferedWriter;\n+import java.io.File;\n+import java.io.FileInputStream;\n+import java.io.FileOutputStream;\n+import java.io.IOException;\n+import java.io.OutputStreamWriter;\n+import java.io.Writer;\n+import java.net.URI;\n+import java.util.ArrayList;\n+import java.util.Collections;\n+import java.util.HashSet;\n+import java.util.List;\n+import java.util.Map;\n+import java.util.Properties;\n+import java.util.Set;\n+\n+import com.sun.tools.sjavac.comp.CompilationService;\n+import com.sun.tools.sjavac.options.Options;\n+import com.sun.tools.sjavac.pubapi.PubApi;\n+\n+\/**\n+ * The clean properties transform should not be necessary.\n+ * Eventually we will cleanup the property file sources in the OpenJDK instead.\n+ *\n+ *  <p><b>This is NOT part of any supported API.\n+ *  If you write code that depends on this, you do so at your own risk.\n+ *  This code and its internal interfaces are subject to change or\n+ *  deletion without notice.<\/b>\n+ *\/\n+public class CleanProperties implements Transformer {\n+    public void setExtra(String e) {\n+        \/\/ Any extra information is ignored for clean properties.\n+    }\n+\n+    public void setExtra(Options a) {\n+        \/\/ Any extra information is ignored for clean properties.\n+    }\n+\n+    public boolean transform(CompilationService sjavac,\n+                             Map<String,Set<URI>> pkgSrcs,\n+                             Set<URI>             visibleSrcs,\n+                             Map<String,Set<String>> oldPackageDependencies,\n+                             URI destRoot,\n+                             Map<String,Set<URI>>    packageArtifacts,\n+                             Map<String, Map<String, Set<String>>> packageDependencies,\n+                             Map<String, Map<String, Set<String>>> packageCpDependencies,\n+                             Map<String, PubApi> packagePublicApis,\n+                             Map<String, PubApi> dependencyPublicApis,\n+                             int debugLevel,\n+                             boolean incremental,\n+                             int numCores) {\n+        boolean rc = true;\n+        for (String pkgName : pkgSrcs.keySet()) {\n+            String pkgNameF = pkgName.replace('.',File.separatorChar);\n+            for (URI u : pkgSrcs.get(pkgName)) {\n+                File src = new File(u);\n+                boolean r = clean(pkgName, pkgNameF, src, new File(destRoot), debugLevel,\n+                                  packageArtifacts);\n+                if (r == false) {\n+                    rc = false;\n+                }\n+            }\n+        }\n+        return rc;\n+    }\n+\n+    boolean clean(String pkgName,\n+                  String pkgNameF,\n+                  File src,\n+                  File destRoot,\n+                  int debugLevel,\n+                  Map<String,Set<URI>> packageArtifacts) {\n+        \/\/ Load the properties file.\n+        Properties p = new Properties();\n+        try {\n+            p.load(new FileInputStream(src));\n+        } catch (IOException e) {\n+            Log.error(\"Error reading file \"+src.getPath());\n+            return false;\n+        }\n+\n+        \/\/ Sort the properties in increasing key order.\n+        List<String> sortedKeys = new ArrayList<>();\n+        for (Object key : p.keySet()) {\n+            sortedKeys.add((String)key);\n+        }\n+        Collections.sort(sortedKeys);\n+\n+        \/\/ Collect the properties into a string buffer.\n+        StringBuilder data = new StringBuilder();\n+        for (String key : sortedKeys) {\n+            data.append(CompileProperties.escape(key))\n+                .append(\":\")\n+                .append(CompileProperties.escape((String) p.get(key)))\n+                .append(\"\\n\");\n+        }\n+\n+        String destFilename = destRoot.getPath()+File.separator+pkgNameF+File.separator+src.getName();\n+        File dest = new File(destFilename);\n+\n+        \/\/ Make sure the dest directories exist.\n+        if (!dest.getParentFile().isDirectory()) {\n+            if (!dest.getParentFile().mkdirs()) {\n+                Log.error(\"Could not create the directory \"+dest.getParentFile().getPath());\n+                return false;\n+            }\n+        }\n+\n+        Set<URI> as = packageArtifacts.get(pkgName);\n+        if (as == null) {\n+            as = new HashSet<>();\n+            packageArtifacts.put(pkgName, as);\n+        }\n+        as.add(dest.toURI());\n+\n+        if (dest.exists() && dest.lastModified() > src.lastModified()) {\n+            \/\/ A cleaned property file exists, and its timestamp is newer than the source.\n+            \/\/ Assume that we do not need to clean!\n+            \/\/ Thus we are done.\n+            return true;\n+        }\n+\n+        Log.info(\"Cleaning property file \"+pkgNameF+File.separator+src.getName());\n+        try (Writer writer = new BufferedWriter(new OutputStreamWriter(new FileOutputStream(dest)))) {\n+            writer.write(data.toString());\n+        } catch ( IOException e ) {\n+            Log.error(\"Could not write file \"+dest.getPath());\n+            return false;\n+        }\n+        return true;\n+    }\n+}\n","filename":"src\/jdk.compiler\/share\/classes\/com\/sun\/tools\/sjavac\/CleanProperties.java","additions":159,"deletions":0,"binary":false,"changes":159,"status":"added"},{"patch":"@@ -0,0 +1,57 @@\n+\/*\n+ * Copyright (c) 2012, 2014, Oracle and\/or its affiliates. All rights reserved.\n+ * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+ *\n+ * This code is free software; you can redistribute it and\/or modify it\n+ * under the terms of the GNU General Public License version 2 only, as\n+ * published by the Free Software Foundation.  Oracle designates this\n+ * particular file as subject to the \"Classpath\" exception as provided\n+ * by Oracle in the LICENSE file that accompanied this code.\n+ *\n+ * This code is distributed in the hope that it will be useful, but WITHOUT\n+ * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+ * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+ * version 2 for more details (a copy is included in the LICENSE file that\n+ * accompanied this code).\n+ *\n+ * You should have received a copy of the GNU General Public License version\n+ * 2 along with this work; if not, write to the Free Software Foundation,\n+ * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n+ *\n+ * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n+ * or visit www.oracle.com if you need additional information or have any\n+ * questions.\n+ *\/\n+\n+package com.sun.tools.sjavac;\n+\n+import java.net.URI;\n+import java.util.HashSet;\n+import java.util.Set;\n+\n+\/**\n+ * A compile chunk is a list of sources\/packages to be compiled. Possibly a subset of\n+ * the total number of sources\/packages to be compiled for this sjavac invocation.\n+ *\n+ *  <p><b>This is NOT part of any supported API.\n+ *  If you write code that depends on this, you do so at your own risk.\n+ *  This code and its internal interfaces are subject to change or\n+ *  deletion without notice.<\/b>\n+ *\/\n+public class CompileChunk implements Comparable<CompileChunk> {\n+    public int numPackages;\n+    public int numDependents;\n+    public Set<URI> srcs = new HashSet<>();\n+    public StringBuilder pkgNames = new StringBuilder();\n+    public String pkgFromTos = \"\";\n+\n+    public int compareTo(CompileChunk c) {\n+        if (numDependents == c.numDependents) return 0;\n+        if (numDependents > c.numDependents) return -1;\n+        return -1;\n+    }\n+\n+    boolean equal(CompileChunk c) {\n+        return numDependents == c.numDependents;\n+    }\n+}\n","filename":"src\/jdk.compiler\/share\/classes\/com\/sun\/tools\/sjavac\/CompileChunk.java","additions":57,"deletions":0,"binary":false,"changes":57,"status":"added"},{"patch":"@@ -0,0 +1,355 @@\n+\/*\n+ * Copyright (c) 2012, 2019, Oracle and\/or its affiliates. All rights reserved.\n+ * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+ *\n+ * This code is free software; you can redistribute it and\/or modify it\n+ * under the terms of the GNU General Public License version 2 only, as\n+ * published by the Free Software Foundation.  Oracle designates this\n+ * particular file as subject to the \"Classpath\" exception as provided\n+ * by Oracle in the LICENSE file that accompanied this code.\n+ *\n+ * This code is distributed in the hope that it will be useful, but WITHOUT\n+ * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+ * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+ * version 2 for more details (a copy is included in the LICENSE file that\n+ * accompanied this code).\n+ *\n+ * You should have received a copy of the GNU General Public License version\n+ * 2 along with this work; if not, write to the Free Software Foundation,\n+ * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n+ *\n+ * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n+ * or visit www.oracle.com if you need additional information or have any\n+ * questions.\n+ *\/\n+\n+package com.sun.tools.sjavac;\n+\n+import java.io.File;\n+import java.net.URI;\n+import java.util.ArrayList;\n+import java.util.Arrays;\n+import java.util.Collections;\n+import java.util.HashMap;\n+import java.util.List;\n+import java.util.Map;\n+import java.util.Random;\n+import java.util.Set;\n+import java.util.concurrent.Callable;\n+import java.util.concurrent.ExecutionException;\n+import java.util.concurrent.ExecutorService;\n+import java.util.concurrent.Executors;\n+import java.util.concurrent.Future;\n+\n+import com.sun.tools.javac.main.Main.Result;\n+import com.sun.tools.sjavac.comp.CompilationService;\n+import com.sun.tools.sjavac.options.Options;\n+import com.sun.tools.sjavac.pubapi.PubApi;\n+import com.sun.tools.sjavac.server.CompilationSubResult;\n+import com.sun.tools.sjavac.server.SysInfo;\n+\n+\/**\n+ * This transform compiles a set of packages containing Java sources.\n+ * The compile request is divided into separate sets of source files.\n+ * For each set a separate request thread is dispatched to a javac server\n+ * and the meta data is accumulated. The number of sets correspond more or\n+ * less to the number of cores. Less so now, than it will in the future.\n+ *\n+ * <p><b>This is NOT part of any supported API.\n+ * If you write code that depends on this, you do so at your own\n+ * risk.  This code and its internal interfaces are subject to change\n+ * or deletion without notice.<\/b><\/p>\n+ *\/\n+public class CompileJavaPackages implements Transformer {\n+\n+    \/\/ The current limited sharing of data between concurrent JavaCompilers\n+    \/\/ in the server will not give speedups above 3 cores. Thus this limit.\n+    \/\/ We hope to improve this in the future.\n+    static final int limitOnConcurrency = 3;\n+\n+    Options args;\n+\n+    public void setExtra(String e) {\n+    }\n+\n+    public void setExtra(Options a) {\n+        args = a;\n+    }\n+\n+    public boolean transform(final CompilationService sjavac,\n+                             Map<String,Set<URI>> pkgSrcs,\n+                             final Set<URI>             visibleSources,\n+                             Map<String,Set<String>> oldPackageDependents,\n+                             URI destRoot,\n+                             final Map<String,Set<URI>>    packageArtifacts,\n+                             final Map<String,Map<String, Set<String>>> packageDependencies,\n+                             final Map<String,Map<String, Set<String>>> packageCpDependencies,\n+                             final Map<String, PubApi> packagePubapis,\n+                             final Map<String, PubApi> dependencyPubapis,\n+                             int debugLevel,\n+                             boolean incremental,\n+                             int numCores) {\n+\n+        Log.debug(\"Performing CompileJavaPackages transform...\");\n+\n+        boolean rc = true;\n+        boolean concurrentCompiles = true;\n+\n+        \/\/ Fetch the id.\n+        final String id = String.valueOf(new Random().nextInt());\n+        \/\/ Only keep portfile and sjavac settings..\n+        \/\/String psServerSettings = Util.cleanSubOptions(Util.set(\"portfile\",\"sjavac\",\"background\",\"keepalive\"), sjavac.serverSettings());\n+\n+        SysInfo sysinfo = sjavac.getSysInfo();\n+        int numMBytes = (int)(sysinfo.maxMemory \/ ((long)(1024*1024)));\n+        Log.debug(\"Server reports \"+numMBytes+\"MiB of memory and \"+sysinfo.numCores+\" cores\");\n+\n+        if (numCores <= 0) {\n+            \/\/ Set the requested number of cores to the number of cores on the server.\n+            numCores = sysinfo.numCores;\n+            Log.debug(\"Number of jobs not explicitly set, defaulting to \"+sysinfo.numCores);\n+        } else if (sysinfo.numCores < numCores) {\n+            \/\/ Set the requested number of cores to the number of cores on the server.\n+            Log.debug(\"Limiting jobs from explicitly set \"+numCores+\" to cores available on server: \"+sysinfo.numCores);\n+            numCores = sysinfo.numCores;\n+        } else {\n+            Log.debug(\"Number of jobs explicitly set to \"+numCores);\n+        }\n+        \/\/ More than three concurrent cores does not currently give a speedup, at least for compiling the jdk\n+        \/\/ in the OpenJDK. This will change in the future.\n+        int numCompiles = numCores;\n+        if (numCores > limitOnConcurrency) numCompiles = limitOnConcurrency;\n+        \/\/ Split the work up in chunks to compiled.\n+\n+        int numSources = 0;\n+        for (String s : pkgSrcs.keySet()) {\n+            Set<URI> ss = pkgSrcs.get(s);\n+            numSources += ss.size();\n+        }\n+\n+        int sourcesPerCompile = numSources \/ numCompiles;\n+\n+        \/\/ For 64 bit Java, it seems we can compile the OpenJDK 8800 files with a 1500M of heap\n+        \/\/ in a single chunk, with reasonable performance.\n+        \/\/ For 32 bit java, it seems we need 1G of heap.\n+        \/\/ Number experimentally determined when compiling the OpenJDK.\n+        \/\/ Includes space for reasonably efficient garbage collection etc,\n+        \/\/ Calculating backwards gives us a requirement of\n+        \/\/ 1500M\/8800 = 175 KiB for 64 bit platforms\n+        \/\/ and 1G\/8800 = 119 KiB for 32 bit platform\n+        \/\/ for each compile.....\n+        int kbPerFile = 175;\n+        String osarch = System.getProperty(\"os.arch\");\n+        String dataModel = System.getProperty(\"sun.arch.data.model\");\n+        if (\"32\".equals(dataModel)) {\n+            \/\/ For 32 bit platforms, assume it is slightly smaller\n+            \/\/ because of smaller object headers and pointers.\n+            kbPerFile = 119;\n+        }\n+        int numRequiredMBytes = (kbPerFile*numSources)\/1024;\n+        Log.debug(\"For os.arch \"+osarch+\" the empirically determined heap required per file is \"+kbPerFile+\"KiB\");\n+        Log.debug(\"Server has \"+numMBytes+\"MiB of heap.\");\n+        Log.debug(\"Heuristics say that we need \"+numRequiredMBytes+\"MiB of heap for all source files.\");\n+        \/\/ Perform heuristics to see how many cores we can use,\n+        \/\/ or if we have to the work serially in smaller chunks.\n+        if (numMBytes < numRequiredMBytes) {\n+            \/\/ Ouch, cannot fit even a single compile into the heap.\n+            \/\/ Split it up into several serial chunks.\n+            concurrentCompiles = false;\n+            \/\/ Limit the number of sources for each compile to 500.\n+            if (numSources < 500) {\n+                numCompiles = 1;\n+                sourcesPerCompile = numSources;\n+                Log.debug(\"Compiling as a single source code chunk to stay within heap size limitations!\");\n+            } else if (sourcesPerCompile > 500) {\n+                \/\/ This number is very low, and tuned to dealing with the OpenJDK\n+                \/\/ where the source is >very< circular! In normal application,\n+                \/\/ with less circularity the number could perhaps be increased.\n+                numCompiles = numSources \/ 500;\n+                sourcesPerCompile = numSources\/numCompiles;\n+                Log.debug(\"Compiling source as \"+numCompiles+\" code chunks serially to stay within heap size limitations!\");\n+            }\n+        } else {\n+            if (numCompiles > 1) {\n+                \/\/ Ok, we can fit at least one full compilation on the heap.\n+                float usagePerCompile = (float)numRequiredMBytes \/ ((float)numCompiles * (float)0.7);\n+                int usage = (int)(usagePerCompile * (float)numCompiles);\n+                Log.debug(\"Heuristics say that for \"+numCompiles+\" concurrent compiles we need \"+usage+\"MiB\");\n+                if (usage > numMBytes) {\n+                    \/\/ Ouch it does not fit. Reduce to a single chunk.\n+                    numCompiles = 1;\n+                    sourcesPerCompile = numSources;\n+                    \/\/ What if the relationship between number of compile_chunks and num_required_mbytes\n+                    \/\/ is not linear? Then perhaps 2 chunks would fit where 3 does not. Well, this is\n+                    \/\/ something to experiment upon in the future.\n+                    Log.debug(\"Limiting compile to a single thread to stay within heap size limitations!\");\n+                }\n+            }\n+        }\n+\n+        Log.debug(\"Compiling sources in \"+numCompiles+\" chunk(s)\");\n+\n+        \/\/ Create the chunks to be compiled.\n+        final CompileChunk[] compileChunks = createCompileChunks(pkgSrcs, oldPackageDependents,\n+                numCompiles, sourcesPerCompile);\n+\n+        if (Log.isDebugging()) {\n+            int cn = 1;\n+            for (CompileChunk cc : compileChunks) {\n+                Log.debug(\"Chunk \"+cn+\" for \"+id+\" ---------------\");\n+                cn++;\n+                for (URI u : cc.srcs) {\n+                    Log.debug(\"\"+u);\n+                }\n+            }\n+        }\n+\n+        long start = System.currentTimeMillis();\n+\n+        \/\/ Prepare compilation calls\n+        List<Callable<CompilationSubResult>> compilationCalls = new ArrayList<>();\n+        final Object lock = new Object();\n+        for (int i = 0; i < numCompiles; i++) {\n+            CompileChunk cc = compileChunks[i];\n+            if (cc.srcs.isEmpty()) {\n+                continue;\n+            }\n+\n+            String chunkId = id + \"-\" + String.valueOf(i);\n+            Log log = Log.get();\n+            compilationCalls.add(() -> {\n+                Log.setLogForCurrentThread(log);\n+                CompilationSubResult result = sjavac.compile(\"n\/a\",\n+                                                             chunkId,\n+                                                             args.prepJavacArgs(),\n+                                                             Collections.emptyList(),\n+                                                             cc.srcs,\n+                                                             visibleSources);\n+                synchronized (lock) {\n+                    Util.getLines(result.stdout).forEach(Log::info);\n+                    Util.getLines(result.stderr).forEach(Log::error);\n+                }\n+                return result;\n+            });\n+        }\n+\n+        \/\/ Perform compilations and collect results\n+        List<CompilationSubResult> subResults = new ArrayList<>();\n+        List<Future<CompilationSubResult>> futs = new ArrayList<>();\n+        ExecutorService exec = Executors.newFixedThreadPool(concurrentCompiles ? compilationCalls.size() : 1);\n+        for (Callable<CompilationSubResult> compilationCall : compilationCalls) {\n+            futs.add(exec.submit(compilationCall));\n+        }\n+        for (Future<CompilationSubResult> fut : futs) {\n+            try {\n+                subResults.add(fut.get());\n+            } catch (ExecutionException ee) {\n+                Log.error(\"Compilation failed: \" + ee.getMessage());\n+                Log.error(ee);\n+            } catch (InterruptedException ie) {\n+                Log.error(\"Compilation interrupted: \" + ie.getMessage());\n+                Log.error(ie);\n+                Thread.currentThread().interrupt();\n+            }\n+        }\n+        exec.shutdownNow();\n+\n+        \/\/ Process each sub result\n+        for (CompilationSubResult subResult : subResults) {\n+            for (String pkg : subResult.packageArtifacts.keySet()) {\n+                Set<URI> pkgArtifacts = subResult.packageArtifacts.get(pkg);\n+                packageArtifacts.merge(pkg, pkgArtifacts, Util::union);\n+            }\n+\n+            for (String pkg : subResult.packageDependencies.keySet()) {\n+                packageDependencies.putIfAbsent(pkg, new HashMap<>());\n+                packageDependencies.get(pkg).putAll(subResult.packageDependencies.get(pkg));\n+            }\n+\n+            for (String pkg : subResult.packageCpDependencies.keySet()) {\n+                packageCpDependencies.putIfAbsent(pkg, new HashMap<>());\n+                packageCpDependencies.get(pkg).putAll(subResult.packageCpDependencies.get(pkg));\n+            }\n+\n+            for (String pkg : subResult.packagePubapis.keySet()) {\n+                packagePubapis.merge(pkg, subResult.packagePubapis.get(pkg), PubApi::mergeTypes);\n+            }\n+\n+            for (String pkg : subResult.dependencyPubapis.keySet()) {\n+                dependencyPubapis.merge(pkg, subResult.dependencyPubapis.get(pkg), PubApi::mergeTypes);\n+            }\n+\n+            \/\/ Check the return values.\n+            if (subResult.result != Result.OK) {\n+                rc = false;\n+            }\n+        }\n+\n+        long duration = System.currentTimeMillis() - start;\n+        long minutes = duration\/60000;\n+        long seconds = (duration-minutes*60000)\/1000;\n+        Log.debug(\"Compilation of \"+numSources+\" source files took \"+minutes+\"m \"+seconds+\"s\");\n+\n+        return rc;\n+    }\n+\n+    \/**\n+     * Split up the sources into compile chunks. If old package dependents information\n+     * is available, sort the order of the chunks into the most dependent first!\n+     * (Typically that chunk contains the java.lang package.) In the future\n+     * we could perhaps improve the heuristics to put the sources into even more sensible chunks.\n+     * Now the package are simple sorted in alphabetical order and chunked, then the chunks\n+     * are sorted on how dependent they are.\n+     *\n+     * @param pkgSrcs The sources to compile.\n+     * @param oldPackageDependents Old package dependents, if non-empty, used to sort the chunks.\n+     * @param numCompiles The number of chunks.\n+     * @param sourcesPerCompile The number of sources per chunk.\n+     * @return\n+     *\/\n+    CompileChunk[] createCompileChunks(Map<String,Set<URI>> pkgSrcs,\n+                                       Map<String,Set<String>> oldPackageDependents,\n+                                       int numCompiles,\n+                                       int sourcesPerCompile) {\n+\n+        CompileChunk[] compileChunks = new CompileChunk[numCompiles];\n+        for (int i=0; i<compileChunks.length; ++i) {\n+            compileChunks[i] = new CompileChunk();\n+        }\n+\n+        \/\/ Now go through the packages and spread out the source on the different chunks.\n+        int ci = 0;\n+        \/\/ Sort the packages\n+        String[] packageNames = pkgSrcs.keySet().toArray(new String[0]);\n+        Arrays.sort(packageNames);\n+        String from = null;\n+        for (String pkgName : packageNames) {\n+            CompileChunk cc = compileChunks[ci];\n+            Set<URI> s = pkgSrcs.get(pkgName);\n+            if (cc.srcs.size()+s.size() > sourcesPerCompile && ci < numCompiles-1) {\n+                from = null;\n+                ci++;\n+                cc = compileChunks[ci];\n+            }\n+            cc.numPackages++;\n+            cc.srcs.addAll(s);\n+\n+            \/\/ Calculate nice package names to use as information when compiling.\n+            String justPkgName = Util.justPackageName(pkgName);\n+            \/\/ Fetch how many packages depend on this package from the old build state.\n+            Set<String> ss = oldPackageDependents.get(pkgName);\n+            if (ss != null) {\n+                \/\/ Accumulate this information onto this chunk.\n+                cc.numDependents += ss.size();\n+            }\n+            if (from == null || from.trim().equals(\"\")) from = justPkgName;\n+            cc.pkgNames.append(justPkgName+\"(\"+s.size()+\") \");\n+            cc.pkgFromTos = from+\" to \"+justPkgName;\n+        }\n+        \/\/ If we are compiling serially, sort the chunks, so that the chunk (with the most dependents) (usually the chunk\n+        \/\/ containing java.lang.Object, is to be compiled first!\n+        \/\/ For concurrent compilation, this does not matter.\n+        Arrays.sort(compileChunks);\n+        return compileChunks;\n+    }\n+}\n","filename":"src\/jdk.compiler\/share\/classes\/com\/sun\/tools\/sjavac\/CompileJavaPackages.java","additions":355,"deletions":0,"binary":false,"changes":355,"status":"added"},{"patch":"@@ -0,0 +1,231 @@\n+\/*\n+ * Copyright (c) 2012, 2016, Oracle and\/or its affiliates. All rights reserved.\n+ * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+ *\n+ * This code is free software; you can redistribute it and\/or modify it\n+ * under the terms of the GNU General Public License version 2 only, as\n+ * published by the Free Software Foundation.  Oracle designates this\n+ * particular file as subject to the \"Classpath\" exception as provided\n+ * by Oracle in the LICENSE file that accompanied this code.\n+ *\n+ * This code is distributed in the hope that it will be useful, but WITHOUT\n+ * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+ * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+ * version 2 for more details (a copy is included in the LICENSE file that\n+ * accompanied this code).\n+ *\n+ * You should have received a copy of the GNU General Public License version\n+ * 2 along with this work; if not, write to the Free Software Foundation,\n+ * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n+ *\n+ * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n+ * or visit www.oracle.com if you need additional information or have any\n+ * questions.\n+ *\/\n+\n+package com.sun.tools.sjavac;\n+\n+import java.io.BufferedWriter;\n+import java.io.File;\n+import java.io.FileInputStream;\n+import java.io.FileOutputStream;\n+import java.io.IOException;\n+import java.io.OutputStreamWriter;\n+import java.io.PrintStream;\n+import java.io.Writer;\n+import java.net.URI;\n+import java.text.MessageFormat;\n+import java.util.ArrayList;\n+import java.util.Collections;\n+import java.util.HashSet;\n+import java.util.Iterator;\n+import java.util.List;\n+import java.util.Map;\n+import java.util.Properties;\n+import java.util.Set;\n+\n+import com.sun.tools.sjavac.comp.CompilationService;\n+import com.sun.tools.sjavac.options.Options;\n+import com.sun.tools.sjavac.pubapi.PubApi;\n+\n+\/**\n+ * Compile properties transform a properties file into a Java source file.\n+ * Java has built in support for reading properties from either a text file\n+ * in the source or a compiled java source file.\n+ *\n+ *  <p><b>This is NOT part of any supported API.\n+ *  If you write code that depends on this, you do so at your own risk.\n+ *  This code and its internal interfaces are subject to change or\n+ *  deletion without notice.<\/b>\n+ *\/\n+public class CompileProperties implements Transformer {\n+    \/\/ Any extra information passed from the command line, for example if:\n+    \/\/ -tr .proppp=com.sun.tools.javac.smart.CompileProperties,sun.util.resources.LocaleNamesBundle\n+    \/\/ then extra will be \"sun.util.resources.LocaleNamesBundle\"\n+    String extra;\n+\n+    public void setExtra(String e) {\n+        extra = e;\n+    }\n+\n+    public void setExtra(Options a) {\n+    }\n+\n+    public boolean transform(CompilationService compilationService,\n+                             Map<String,Set<URI>> pkgSrcs,\n+                             Set<URI>             visibleSrcs,\n+                             Map<String,Set<String>> oldPackageDependents,\n+                             URI destRoot,\n+                             Map<String,Set<URI>>    packageArtifacts,\n+                             Map<String,Map<String, Set<String>>> packageDependencies,\n+                             Map<String,Map<String, Set<String>>> packageCpDependencies,\n+                             Map<String, PubApi> packagePublicApis,\n+                             Map<String, PubApi> dependencyPublicApis,\n+                             int debugLevel,\n+                             boolean incremental,\n+                             int numCores) {\n+        boolean rc = true;\n+        for (String pkgName : pkgSrcs.keySet()) {\n+            String pkgNameF = Util.toFileSystemPath(pkgName);\n+            for (URI u : pkgSrcs.get(pkgName)) {\n+                File src = new File(u);\n+                boolean r = compile(pkgName, pkgNameF, src, new File(destRoot), debugLevel,\n+                                    packageArtifacts);\n+                if (r == false) {\n+                    rc = false;\n+                }\n+            }\n+        }\n+        return rc;\n+    }\n+\n+    boolean compile(String pkgName, String pkgNameF, File src, File destRoot, int debugLevel,\n+                    Map<String,Set<URI>> packageArtifacts)\n+    {\n+        String superClass = \"java.util.ListResourceBundle\";\n+\n+        if (extra != null) {\n+            superClass = extra;\n+        }\n+        \/\/ Load the properties file.\n+        Properties p = new Properties();\n+        try {\n+            p.load(new FileInputStream(src));\n+        } catch (IOException e) {\n+            Log.error(\"Error reading file \"+src.getPath());\n+            return false;\n+        }\n+\n+        \/\/ Calculate the name of the Java source file to be generated.\n+        int dp = src.getName().lastIndexOf(\".\");\n+        String classname = src.getName().substring(0,dp);\n+\n+        \/\/ Sort the properties in increasing key order.\n+        List<String> sortedKeys = new ArrayList<>();\n+        for (Object key : p.keySet()) {\n+            sortedKeys.add((String)key);\n+        }\n+        Collections.sort(sortedKeys);\n+        Iterator<String> keys = sortedKeys.iterator();\n+\n+        \/\/ Collect the properties into a string buffer.\n+        StringBuilder data = new StringBuilder();\n+        while (keys.hasNext()) {\n+            String key = keys.next();\n+            data.append(\"            { \\\"\" + escape(key) + \"\\\", \\\"\" +\n+                        escape((String)p.get(key)) + \"\\\" },\\n\");\n+        }\n+\n+        \/\/ Create dest file name. It is derived from the properties file name.\n+        String destFilename = destRoot.getPath()+File.separator+pkgNameF+File.separator+classname+\".java\";\n+        File dest = new File(destFilename);\n+\n+        \/\/ Make sure the dest directories exist.\n+        if (!dest.getParentFile().isDirectory()) {\n+            if (!dest.getParentFile().mkdirs()) {\n+                Log.error(\"Could not create the directory \"+dest.getParentFile().getPath());\n+                return false;\n+            }\n+        }\n+\n+        Set<URI> as = packageArtifacts.get(pkgName);\n+        if (as == null) {\n+            as = new HashSet<>();\n+            packageArtifacts.put(pkgName, as);\n+        }\n+        as.add(dest.toURI());\n+\n+        if (dest.exists() && dest.lastModified() > src.lastModified()) {\n+            \/\/ A generated file exists, and its timestamp is newer than the source.\n+            \/\/ Assume that we do not need to regenerate the dest file!\n+            \/\/ Thus we are done.\n+            return true;\n+        }\n+\n+        String packageString = \"package \" + pkgNameF.replace(File.separatorChar,'.') + \";\\n\\n\";\n+\n+        Log.info(\"Compiling property file \"+pkgNameF+File.separator+src.getName());\n+        try (Writer writer = new BufferedWriter(new OutputStreamWriter(new FileOutputStream(dest)))) {\n+            MessageFormat format = new MessageFormat(FORMAT);\n+            writer.write(format.format(new Object[] { packageString, classname, superClass, data }));\n+        } catch ( IOException e ) {\n+            Log.error(\"Could not write file \"+dest.getPath());\n+            return false;\n+        }\n+        return true;\n+    }\n+\n+    private static final String FORMAT =\n+            \"{0}\" +\n+            \"public final class {1} extends {2} '{'\\n\" +\n+            \"    protected final Object[][] getContents() '{'\\n\" +\n+            \"        return new Object[][] '{'\\n\" +\n+            \"{3}\" +\n+            \"        };\\n\" +\n+            \"    }\\n\" +\n+            \"}\\n\";\n+\n+    public static String escape(String theString) {\n+        int len = theString.length();\n+        StringBuilder outBuffer = new StringBuilder(len*2);\n+\n+        for(int x=0; x<len; x++) {\n+            char aChar = theString.charAt(x);\n+            switch(aChar) {\n+                case '\\\\':outBuffer.append('\\\\'); outBuffer.append('\\\\');\n+                break;\n+                case '\\t':outBuffer.append('\\\\'); outBuffer.append('t');\n+                break;\n+                case '\\n':outBuffer.append('\\\\'); outBuffer.append('n');\n+                break;\n+                case '\\r':outBuffer.append('\\\\'); outBuffer.append('r');\n+                break;\n+                case '\\f':outBuffer.append('\\\\'); outBuffer.append('f');\n+                break;\n+                default:\n+                    if ((aChar < 0x0020) || (aChar > 0x007e)) {\n+                        outBuffer.append('\\\\');\n+                        outBuffer.append('u');\n+                        outBuffer.append(toHex((aChar >> 12) & 0xF));\n+                        outBuffer.append(toHex((aChar >>  8) & 0xF));\n+                        outBuffer.append(toHex((aChar >>  4) & 0xF));\n+                        outBuffer.append(toHex( aChar        & 0xF));\n+                    } else {\n+                        if (aChar == '\"') {\n+                            outBuffer.append('\\\\');\n+                        }\n+                        outBuffer.append(aChar);\n+                    }\n+            }\n+        }\n+        return outBuffer.toString();\n+    }\n+\n+    private static char toHex(int nibble) {\n+        return hexDigit[(nibble & 0xF)];\n+    }\n+\n+    private static final char[] hexDigit = {\n+        '0','1','2','3','4','5','6','7','8','9','A','B','C','D','E','F'\n+    };\n+}\n","filename":"src\/jdk.compiler\/share\/classes\/com\/sun\/tools\/sjavac\/CompileProperties.java","additions":231,"deletions":0,"binary":false,"changes":231,"status":"added"},{"patch":"@@ -0,0 +1,118 @@\n+\/*\n+ * Copyright (c) 2012, 2021, Oracle and\/or its affiliates. All rights reserved.\n+ * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+ *\n+ * This code is free software; you can redistribute it and\/or modify it\n+ * under the terms of the GNU General Public License version 2 only, as\n+ * published by the Free Software Foundation.  Oracle designates this\n+ * particular file as subject to the \"Classpath\" exception as provided\n+ * by Oracle in the LICENSE file that accompanied this code.\n+ *\n+ * This code is distributed in the hope that it will be useful, but WITHOUT\n+ * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+ * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+ * version 2 for more details (a copy is included in the LICENSE file that\n+ * accompanied this code).\n+ *\n+ * You should have received a copy of the GNU General Public License version\n+ * 2 along with this work; if not, write to the Free Software Foundation,\n+ * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n+ *\n+ * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n+ * or visit www.oracle.com if you need additional information or have any\n+ * questions.\n+ *\/\n+\n+package com.sun.tools.sjavac;\n+\n+import java.io.File;\n+import java.io.IOException;\n+import java.net.URI;\n+import java.nio.file.Files;\n+import java.nio.file.StandardCopyOption;\n+import java.util.HashSet;\n+import java.util.Map;\n+import java.util.Set;\n+\n+import com.sun.tools.sjavac.comp.CompilationService;\n+import com.sun.tools.sjavac.options.Options;\n+import com.sun.tools.sjavac.pubapi.PubApi;\n+\n+\/**\n+ * The copy file transform simply copies a matching file from -src to -d .\n+ * Such files are typically images, xml documents and other data files.\n+ *\n+ *  <p><b>This is NOT part of any supported API.\n+ *  If you write code that depends on this, you do so at your own risk.\n+ *  This code and its internal interfaces are subject to change or\n+ *  deletion without notice.<\/b>\n+ *\/\n+public class CopyFile implements Transformer {\n+\n+    public void setExtra(String e) {\n+    }\n+\n+    public void setExtra(Options a) {\n+    }\n+\n+    public boolean transform(CompilationService compilationService,\n+                             Map<String,Set<URI>> pkgSrcs,\n+                             Set<URI> visibleSrcs,\n+                             Map<String,Set<String>> oldPackageDependents,\n+                             URI destRoot,\n+                             Map<String,Set<URI>>    packageArtifacts,\n+                             Map<String,Map<String, Set<String>>> packageDependencies,\n+                             Map<String,Map<String, Set<String>>> packageCpDependencies,\n+                             Map<String, PubApi> packagePubapis,\n+                             Map<String, PubApi> dependencyPubapis,\n+                             int debugLevel,\n+                             boolean incremental,\n+                             int numCores)\n+    {\n+        boolean rc = true;\n+        String dest_filename;\n+        File dest;\n+\n+        for (String pkgName : pkgSrcs.keySet()) {\n+            String pkgNameF = Util.toFileSystemPath(pkgName);\n+            for (URI u : pkgSrcs.get(pkgName)) {\n+                File src = new File(u);\n+                File destDir;\n+                destDir = new File(destRoot.getPath()+File.separator+pkgNameF);\n+                dest_filename = destRoot.getPath()+File.separator+pkgNameF+File.separator+src.getName();\n+                dest = new File(dest_filename);\n+\n+                if (!destDir.isDirectory()) {\n+                    if (!destDir.mkdirs()) {\n+                       Log.error(\"Error: The copier could not create the directory \"+\n+                                           destDir.getPath());\n+                        return false;\n+                    }\n+                }\n+\n+                Set<URI> as = packageArtifacts.get(pkgName);\n+                if (as == null) {\n+                    as = new HashSet<>();\n+                    packageArtifacts.put(pkgName, as);\n+                }\n+                as.add(dest.toURI());\n+\n+                if (dest.exists() && dest.lastModified() > src.lastModified()) {\n+                    \/\/ A copied file exists, and its timestamp is newer than the source.\n+                    continue;\n+                }\n+\n+                Log.info(\"Copying \"+pkgNameF+File.separator+src.getName());\n+\n+                try {\n+                    Files.copy(src.toPath(), dest.toPath(), StandardCopyOption.REPLACE_EXISTING);\n+                }\n+                catch(IOException e){\n+                    Log.error(\"Could not copy the file \"+src.getPath()+\" to \"+dest.getPath());\n+                    rc = false;\n+                }\n+            }\n+        }\n+        return rc;\n+    }\n+}\n","filename":"src\/jdk.compiler\/share\/classes\/com\/sun\/tools\/sjavac\/CopyFile.java","additions":118,"deletions":0,"binary":false,"changes":118,"status":"added"},{"patch":"@@ -0,0 +1,974 @@\n+\/*\n+ * Copyright (c) 2012, 2019, Oracle and\/or its affiliates. All rights reserved.\n+ * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+ *\n+ * This code is free software; you can redistribute it and\/or modify it\n+ * under the terms of the GNU General Public License version 2 only, as\n+ * published by the Free Software Foundation.  Oracle designates this\n+ * particular file as subject to the \"Classpath\" exception as provided\n+ * by Oracle in the LICENSE file that accompanied this code.\n+ *\n+ * This code is distributed in the hope that it will be useful, but WITHOUT\n+ * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+ * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+ * version 2 for more details (a copy is included in the LICENSE file that\n+ * accompanied this code).\n+ *\n+ * You should have received a copy of the GNU General Public License version\n+ * 2 along with this work; if not, write to the Free Software Foundation,\n+ * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n+ *\n+ * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n+ * or visit www.oracle.com if you need additional information or have any\n+ * questions.\n+ *\/\n+\n+package com.sun.tools.sjavac;\n+\n+import java.io.BufferedReader;\n+import java.io.File;\n+import java.io.FileNotFoundException;\n+import java.io.FileReader;\n+import java.io.FileWriter;\n+import java.io.IOException;\n+import java.io.Writer;\n+import java.net.URI;\n+import java.nio.file.NoSuchFileException;\n+import java.text.SimpleDateFormat;\n+import java.util.Collection;\n+import java.util.Collections;\n+import java.util.Date;\n+import java.util.HashMap;\n+import java.util.HashSet;\n+import java.util.List;\n+import java.util.Map;\n+import java.util.Set;\n+import java.util.stream.Collectors;\n+\n+import com.sun.tools.sjavac.comp.CompilationService;\n+import com.sun.tools.sjavac.options.Options;\n+import com.sun.tools.sjavac.pubapi.PubApi;\n+\n+\/**\n+ * The javac state class maintains the previous (prev) and the current (now)\n+ * build states and everything else that goes into the javac_state file.\n+ *\n+ *  <p><b>This is NOT part of any supported API.\n+ *  If you write code that depends on this, you do so at your own risk.\n+ *  This code and its internal interfaces are subject to change or\n+ *  deletion without notice.<\/b>\n+ *\/\n+public class JavacState {\n+    \/\/ The arguments to the compile. If not identical, then it cannot\n+    \/\/ be an incremental build!\n+    String theArgs;\n+    \/\/ The number of cores limits how many threads are used for heavy concurrent work.\n+    int numCores;\n+\n+    \/\/ The bin_dir\/javac_state\n+    private File javacState;\n+\n+    \/\/ The previous build state is loaded from javac_state\n+    private BuildState prev;\n+    \/\/ The current build state is constructed during the build,\n+    \/\/ then saved as the new javac_state.\n+    private BuildState now;\n+\n+    \/\/ Something has changed in the javac_state. It needs to be saved!\n+    private boolean needsSaving;\n+    \/\/ If this is a new javac_state file, then do not print unnecessary messages.\n+    private boolean newJavacState;\n+\n+    \/\/ These are packages where something has changed and the package\n+    \/\/ needs to be recompiled. Actions that trigger recompilation:\n+    \/\/ * source belonging to the package has changed\n+    \/\/ * artifact belonging to the package is lost, or its timestamp has been changed.\n+    \/\/ * an unknown artifact has appeared, we simply delete it, but we also trigger a recompilation.\n+    \/\/ * a package that is tainted, taints all packages that depend on it.\n+    private Set<String> taintedPackages;\n+    \/\/ After a compile, the pubapis are compared with the pubapis stored in the javac state file.\n+    \/\/ Any packages where the pubapi differ are added to this set.\n+    \/\/ Later we use this set and the dependency information to taint dependent packages.\n+    private Set<String> packagesWithChangedPublicApis;\n+    \/\/ When a module-info.java file is changed, taint the module,\n+    \/\/ then taint all modules that depend on that that module.\n+    \/\/ A module dependency can occur directly through a require, or\n+    \/\/ indirectly through a module that does a public export for the first tainted module.\n+    \/\/ When all modules are tainted, then taint all packages belonging to these modules.\n+    \/\/ Then rebuild. It is perhaps possible (and valuable?) to do a more fine-grained examination of the\n+    \/\/ change in module-info.java, but that will have to wait.\n+    private Set<String> taintedModules;\n+    \/\/ The set of all packages that has been recompiled.\n+    \/\/ Copy over the javac_state for the packages that did not need recompilation,\n+    \/\/ verbatim from the previous (prev) to the new (now) build state.\n+    private Set<String> recompiledPackages;\n+\n+    \/\/ The output directories filled with tasty artifacts.\n+    private File binDir, gensrcDir, headerDir, stateDir;\n+\n+    \/\/ The current status of the file system.\n+    private Set<File> binArtifacts;\n+    private Set<File> gensrcArtifacts;\n+    private Set<File> headerArtifacts;\n+\n+    \/\/ The status of the sources.\n+    Set<Source> removedSources = null;\n+    Set<Source> addedSources = null;\n+    Set<Source> modifiedSources = null;\n+\n+    \/\/ Visible sources for linking. These are the only\n+    \/\/ ones that -sourcepath is allowed to see.\n+    Set<URI> visibleSrcs;\n+\n+    \/\/ Setup transform that always exist.\n+    private CompileJavaPackages compileJavaPackages = new CompileJavaPackages();\n+\n+    \/\/ Command line options.\n+    private Options options;\n+\n+    JavacState(Options op, boolean removeJavacState) {\n+        options = op;\n+        numCores = options.getNumCores();\n+        theArgs = options.getStateArgsString();\n+        binDir = Util.pathToFile(options.getDestDir());\n+        gensrcDir = Util.pathToFile(options.getGenSrcDir());\n+        headerDir = Util.pathToFile(options.getHeaderDir());\n+        stateDir = Util.pathToFile(options.getStateDir());\n+        javacState = new File(stateDir, \"javac_state\");\n+        if (removeJavacState && javacState.exists()) {\n+            javacState.delete();\n+        }\n+        newJavacState = false;\n+        if (!javacState.exists()) {\n+            newJavacState = true;\n+            \/\/ If there is no javac_state then delete the contents of all the artifact dirs!\n+            \/\/ We do not want to risk building a broken incremental build.\n+            \/\/ BUT since the makefiles still copy things straight into the bin_dir et al,\n+            \/\/ we avoid deleting files here, if the option --permit-unidentified-classes was supplied.\n+            if (!options.areUnidentifiedArtifactsPermitted()) {\n+                deleteContents(binDir);\n+                deleteContents(gensrcDir);\n+                deleteContents(headerDir);\n+            }\n+            needsSaving = true;\n+        }\n+        prev = new BuildState();\n+        now = new BuildState();\n+        taintedPackages = new HashSet<>();\n+        recompiledPackages = new HashSet<>();\n+        packagesWithChangedPublicApis = new HashSet<>();\n+    }\n+\n+    public BuildState prev() { return prev; }\n+    public BuildState now() { return now; }\n+\n+    \/**\n+     * Remove args not affecting the state.\n+     *\/\n+    static String[] removeArgsNotAffectingState(String[] args) {\n+        String[] out = new String[args.length];\n+        int j = 0;\n+        for (int i = 0; i<args.length; ++i) {\n+            if (args[i].equals(\"-j\")) {\n+                \/\/ Just skip it and skip following value\n+                i++;\n+            } else if (args[i].startsWith(\"--server:\")) {\n+                \/\/ Just skip it.\n+            } else if (args[i].startsWith(\"--log=\")) {\n+                \/\/ Just skip it.\n+            } else if (args[i].equals(\"--compare-found-sources\")) {\n+                \/\/ Just skip it and skip verify file name\n+                i++;\n+            } else {\n+                \/\/ Copy argument.\n+                out[j] = args[i];\n+                j++;\n+            }\n+        }\n+        String[] ret = new String[j];\n+        System.arraycopy(out, 0, ret, 0, j);\n+        return ret;\n+    }\n+\n+    \/**\n+     * Specify which sources are visible to the compiler through -sourcepath.\n+     *\/\n+    public void setVisibleSources(Map<String,Source> vs) {\n+        visibleSrcs = new HashSet<>();\n+        for (String s : vs.keySet()) {\n+            Source src = vs.get(s);\n+            visibleSrcs.add(src.file().toURI());\n+        }\n+    }\n+\n+    \/**\n+     * Returns true if this is an incremental build.\n+     *\/\n+    public boolean isIncremental() {\n+        return !prev.sources().isEmpty();\n+    }\n+\n+    \/**\n+     * Find all artifacts that exists on disk.\n+     *\/\n+    public void findAllArtifacts() {\n+        binArtifacts = findAllFiles(binDir);\n+        gensrcArtifacts = findAllFiles(gensrcDir);\n+        headerArtifacts = findAllFiles(headerDir);\n+    }\n+\n+    \/**\n+     * Lookup the artifacts generated for this package in the previous build.\n+     *\/\n+    private Map<String,File> fetchPrevArtifacts(String pkg) {\n+        Package p = prev.packages().get(pkg);\n+        if (p != null) {\n+            return p.artifacts();\n+        }\n+        return new HashMap<>();\n+    }\n+\n+    \/**\n+     * Delete all prev artifacts in the currently tainted packages.\n+     *\/\n+    public void deleteClassArtifactsInTaintedPackages() {\n+        for (String pkg : taintedPackages) {\n+            Map<String,File> arts = fetchPrevArtifacts(pkg);\n+            for (File f : arts.values()) {\n+                if (f.exists() && f.getName().endsWith(\".class\")) {\n+                    f.delete();\n+                }\n+            }\n+        }\n+    }\n+\n+    \/**\n+     * Mark the javac_state file to be in need of saving and as a side effect,\n+     * it gets a new timestamp.\n+     *\/\n+    private void needsSaving() {\n+        needsSaving = true;\n+    }\n+\n+    \/**\n+     * Save the javac_state file.\n+     *\/\n+    public void save() throws IOException {\n+        if (!needsSaving)\n+            return;\n+        try (FileWriter out = new FileWriter(javacState)) {\n+            StringBuilder b = new StringBuilder();\n+            long millisNow = System.currentTimeMillis();\n+            Date d = new Date(millisNow);\n+            SimpleDateFormat df = new SimpleDateFormat(\"yyyy-MM-dd HH:mm:ss SSS\");\n+            b.append(\"# javac_state ver 0.4 generated \"+millisNow+\" \"+df.format(d)+\"\\n\");\n+            b.append(\"# This format might change at any time. Please do not depend on it.\\n\");\n+            b.append(\"# R arguments\\n\");\n+            b.append(\"# M module\\n\");\n+            b.append(\"# P package\\n\");\n+            b.append(\"# S C source_tobe_compiled timestamp\\n\");\n+            b.append(\"# S L link_only_source timestamp\\n\");\n+            b.append(\"# G C generated_source timestamp\\n\");\n+            b.append(\"# A artifact timestamp\\n\");\n+            b.append(\"# D S dependent -> source dependency\\n\");\n+            b.append(\"# D C dependent -> classpath dependency\\n\");\n+            b.append(\"# I pubapi\\n\");\n+            b.append(\"R \").append(theArgs).append(\"\\n\");\n+\n+            \/\/ Copy over the javac_state for the packages that did not need recompilation.\n+            now.copyPackagesExcept(prev, recompiledPackages, new HashSet<String>());\n+            \/\/ Save the packages, ie package names, dependencies, pubapis and artifacts!\n+            \/\/ I.e. the lot.\n+            Module.saveModules(now.modules(), b);\n+\n+            String s = b.toString();\n+            out.write(s, 0, s.length());\n+        }\n+    }\n+\n+    \/**\n+     * Load a javac_state file.\n+     *\/\n+    public static JavacState load(Options options) {\n+        JavacState db = new JavacState(options, false);\n+        Module  lastModule = null;\n+        Package lastPackage = null;\n+        Source  lastSource = null;\n+        boolean noFileFound = false;\n+        boolean foundCorrectVerNr = false;\n+        boolean newCommandLine = false;\n+        boolean syntaxError = false;\n+\n+        Log.debug(\"Loading javac state file: \" + db.javacState);\n+\n+        try (BufferedReader in = new BufferedReader(new FileReader(db.javacState))) {\n+            for (;;) {\n+                String l = in.readLine();\n+                if (l==null) break;\n+                if (l.length()>=3 && l.charAt(1) == ' ') {\n+                    char c = l.charAt(0);\n+                    if (c == 'M') {\n+                        lastModule = db.prev.loadModule(l);\n+                    } else\n+                    if (c == 'P') {\n+                        if (lastModule == null) { syntaxError = true; break; }\n+                        lastPackage = db.prev.loadPackage(lastModule, l);\n+                    } else\n+                    if (c == 'D') {\n+                        if (lastModule == null || lastPackage == null) { syntaxError = true; break; }\n+                        char depType = l.charAt(2);\n+                        if (depType != 'S' && depType != 'C')\n+                            throw new RuntimeException(\"Bad dependency string: \" + l);\n+                        lastPackage.parseAndAddDependency(l.substring(4), depType == 'C');\n+                    } else\n+                    if (c == 'I') {\n+                        if (lastModule == null || lastPackage == null) { syntaxError = true; break; }\n+                        lastPackage.getPubApi().appendItem(l.substring(2)); \/\/ Strip \"I \"\n+                    } else\n+                    if (c == 'A') {\n+                        if (lastModule == null || lastPackage == null) { syntaxError = true; break; }\n+                        lastPackage.loadArtifact(l);\n+                    } else\n+                    if (c == 'S') {\n+                        if (lastModule == null || lastPackage == null) { syntaxError = true; break; }\n+                        lastSource = db.prev.loadSource(lastPackage, l, false);\n+                    } else\n+                    if (c == 'G') {\n+                        if (lastModule == null || lastPackage == null) { syntaxError = true; break; }\n+                        lastSource = db.prev.loadSource(lastPackage, l, true);\n+                    } else\n+                    if (c == 'R') {\n+                        String ncmdl = \"R \"+db.theArgs;\n+                        if (!l.equals(ncmdl)) {\n+                            newCommandLine = true;\n+                        }\n+                    } else\n+                         if (c == '#') {\n+                        if (l.startsWith(\"# javac_state ver \")) {\n+                            int sp = l.indexOf(\" \", 18);\n+                            if (sp != -1) {\n+                                String ver = l.substring(18,sp);\n+                                if (!ver.equals(\"0.4\")) {\n+                    break;\n+                                 }\n+                foundCorrectVerNr = true;\n+                            }\n+                        }\n+                    }\n+                }\n+            }\n+        } catch (FileNotFoundException | NoSuchFileException e) {\n+            \/\/ Silently create a new javac_state file.\n+            noFileFound = true;\n+        } catch (IOException e) {\n+            Log.warn(\"Dropping old javac_state because of errors when reading it.\");\n+            db = new JavacState(options, true);\n+            foundCorrectVerNr = true;\n+            newCommandLine = false;\n+            syntaxError = false;\n+    }\n+        if (foundCorrectVerNr == false && !noFileFound) {\n+            Log.debug(\"Dropping old javac_state since it is of an old version.\");\n+            db = new JavacState(options, true);\n+        } else\n+        if (newCommandLine == true && !noFileFound) {\n+            Log.debug(\"Dropping old javac_state since a new command line is used!\");\n+            db = new JavacState(options, true);\n+        } else\n+        if (syntaxError == true) {\n+            Log.warn(\"Dropping old javac_state since it contains syntax errors.\");\n+            db = new JavacState(options, true);\n+        }\n+        db.prev.calculateDependents();\n+        return db;\n+    }\n+\n+    \/**\n+     * Mark a java package as tainted, ie it needs recompilation.\n+     *\/\n+    public void taintPackage(String name, String because) {\n+        if (!taintedPackages.contains(name)) {\n+            if (because != null) Log.debug(\"Tainting \"+Util.justPackageName(name)+\" because \"+because);\n+            \/\/ It has not been tainted before.\n+            taintedPackages.add(name);\n+            needsSaving();\n+            Package nowp = now.packages().get(name);\n+            if (nowp != null) {\n+                for (String d : nowp.dependents()) {\n+                    taintPackage(d, because);\n+                }\n+            }\n+        }\n+    }\n+\n+    \/**\n+     * This packages need recompilation.\n+     *\/\n+    public Set<String> taintedPackages() {\n+        return taintedPackages;\n+    }\n+\n+    \/**\n+     * Clean out the tainted package set, used after the first round of compiles,\n+     * prior to propagating dependencies.\n+     *\/\n+    public void clearTaintedPackages() {\n+        taintedPackages = new HashSet<>();\n+    }\n+\n+    \/**\n+     * Go through all sources and check which have been removed, added or modified\n+     * and taint the corresponding packages.\n+     *\/\n+    public void checkSourceStatus(boolean check_gensrc) {\n+        removedSources = calculateRemovedSources();\n+        for (Source s : removedSources) {\n+            if (!s.isGenerated() || check_gensrc) {\n+                taintPackage(s.pkg().name(), \"source \"+s.name()+\" was removed\");\n+            }\n+        }\n+\n+        addedSources = calculateAddedSources();\n+        for (Source s : addedSources) {\n+            String msg = null;\n+            if (isIncremental()) {\n+                \/\/ When building from scratch, there is no point\n+                \/\/ printing \"was added\" for every file since all files are added.\n+                \/\/ However for an incremental build it makes sense.\n+                msg = \"source \"+s.name()+\" was added\";\n+            }\n+            if (!s.isGenerated() || check_gensrc) {\n+                taintPackage(s.pkg().name(), msg);\n+            }\n+        }\n+\n+        modifiedSources = calculateModifiedSources();\n+        for (Source s : modifiedSources) {\n+            if (!s.isGenerated() || check_gensrc) {\n+                taintPackage(s.pkg().name(), \"source \"+s.name()+\" was modified\");\n+            }\n+        }\n+    }\n+\n+    \/**\n+     * Acquire the compile_java_packages suffix rule for .java files.\n+     *\/\n+    public Map<String,Transformer> getJavaSuffixRule() {\n+        Map<String,Transformer> sr = new HashMap<>();\n+        sr.put(\".java\", compileJavaPackages);\n+        return sr;\n+    }\n+\n+\n+    \/**\n+     * If artifacts have gone missing, force a recompile of the packages\n+     * they belong to.\n+     *\/\n+    public void taintPackagesThatMissArtifacts() {\n+        for (Package pkg : prev.packages().values()) {\n+            for (File f : pkg.artifacts().values()) {\n+                if (!f.exists()) {\n+                    \/\/ Hmm, the artifact on disk does not exist! Someone has removed it....\n+                    \/\/ Lets rebuild the package.\n+                    taintPackage(pkg.name(), \"\"+f+\" is missing.\");\n+                }\n+            }\n+        }\n+    }\n+\n+    \/**\n+     * Propagate recompilation through the dependency chains.\n+     * Avoid re-tainting packages that have already been compiled.\n+     *\/\n+    public void taintPackagesDependingOnChangedPackages(Set<String> pkgsWithChangedPubApi, Set<String> recentlyCompiled) {\n+        \/\/ For each to-be-recompiled-candidates...\n+        for (Package pkg : new HashSet<>(prev.packages().values())) {\n+            \/\/ Find out what it depends upon...\n+            Set<String> deps = pkg.typeDependencies()\n+                                  .values()\n+                                  .stream()\n+                                  .flatMap(Collection::stream)\n+                                  .collect(Collectors.toSet());\n+            for (String dep : deps) {\n+                String depPkg = \":\" + dep.substring(0, dep.lastIndexOf('.'));\n+                if (depPkg.equals(pkg.name()))\n+                    continue;\n+                \/\/ Checking if that dependency has changed\n+                if (pkgsWithChangedPubApi.contains(depPkg) && !recentlyCompiled.contains(pkg.name())) {\n+                    taintPackage(pkg.name(), \"its depending on \" + depPkg);\n+                }\n+            }\n+        }\n+    }\n+\n+    \/**\n+     * Compare the javac_state recorded public apis of packages on the classpath\n+     * with the actual public apis on the classpath.\n+     *\/\n+    public void taintPackagesDependingOnChangedClasspathPackages() throws IOException {\n+\n+        \/\/ 1. Collect fully qualified names of all interesting classpath dependencies\n+        Set<String> fqDependencies = new HashSet<>();\n+        for (Package pkg : prev.packages().values()) {\n+            \/\/ Check if this package was compiled. If it's presence is recorded\n+            \/\/ because it was on the class path and we needed to save it's\n+            \/\/ public api, it's not a candidate for tainting.\n+            if (pkg.sources().isEmpty())\n+                continue;\n+\n+            pkg.typeClasspathDependencies().values().forEach(fqDependencies::addAll);\n+        }\n+\n+        \/\/ 2. Extract the public APIs from the on disk .class files\n+        \/\/ (Reason for doing step 1 in a separate phase is to avoid extracting\n+        \/\/ public APIs of the same class twice.)\n+        PubApiExtractor pubApiExtractor = new PubApiExtractor(options);\n+        Map<String, PubApi> onDiskPubApi = new HashMap<>();\n+        for (String cpDep : fqDependencies) {\n+            onDiskPubApi.put(cpDep, pubApiExtractor.getPubApi(cpDep));\n+        }\n+        pubApiExtractor.close();\n+\n+        \/\/ 3. Compare them with the public APIs as of last compilation (loaded from javac_state)\n+        nextPkg:\n+        for (Package pkg : prev.packages().values()) {\n+            \/\/ Check if this package was compiled. If it's presence is recorded\n+            \/\/ because it was on the class path and we needed to save it's\n+            \/\/ public api, it's not a candidate for tainting.\n+            if (pkg.sources().isEmpty())\n+                continue;\n+\n+            Set<String> cpDepsOfThisPkg = new HashSet<>();\n+            for (Set<String> cpDeps : pkg.typeClasspathDependencies().values())\n+                cpDepsOfThisPkg.addAll(cpDeps);\n+\n+            for (String fqDep : cpDepsOfThisPkg) {\n+\n+                String depPkg = \":\" + fqDep.substring(0, fqDep.lastIndexOf('.'));\n+                PubApi prevPkgApi = prev.packages().get(depPkg).getPubApi();\n+\n+                \/\/ This PubApi directly lists the members of the class,\n+                \/\/ i.e. [ MEMBER1, MEMBER2, ... ]\n+                PubApi prevDepApi = prevPkgApi.types.get(fqDep).pubApi;\n+\n+                \/\/ In order to dive *into* the class, we need to add\n+                \/\/ .types.get(fqDep).pubApi below.\n+                PubApi currentDepApi = onDiskPubApi.get(fqDep).types.get(fqDep).pubApi;\n+\n+                if (!currentDepApi.isBackwardCompatibleWith(prevDepApi)) {\n+                    List<String> apiDiff = currentDepApi.diff(prevDepApi);\n+                    taintPackage(pkg.name(), \"depends on classpath \"\n+                                + \"package which has an updated package api: \"\n+                                + String.join(\"\\n\", apiDiff));\n+                    \/\/Log.debug(\"========================================\");\n+                    \/\/Log.debug(\"------ PREV API ------------------------\");\n+                    \/\/prevDepApi.asListOfStrings().forEach(Log::debug);\n+                    \/\/Log.debug(\"------ CURRENT API ---------------------\");\n+                    \/\/currentDepApi.asListOfStrings().forEach(Log::debug);\n+                    \/\/Log.debug(\"========================================\");\n+                    continue nextPkg;\n+                }\n+            }\n+        }\n+    }\n+\n+    \/**\n+     * Scan all output dirs for artifacts and remove those files (artifacts?)\n+     * that are not recognized as such, in the javac_state file.\n+     *\/\n+    public void removeUnidentifiedArtifacts() {\n+        Set<File> allKnownArtifacts = new HashSet<>();\n+        for (Package pkg : prev.packages().values()) {\n+            for (File f : pkg.artifacts().values()) {\n+                allKnownArtifacts.add(f);\n+            }\n+        }\n+        \/\/ Do not forget about javac_state....\n+        allKnownArtifacts.add(javacState);\n+\n+        for (File f : binArtifacts) {\n+            if (!allKnownArtifacts.contains(f) &&\n+                !options.isUnidentifiedArtifactPermitted(f.getAbsolutePath())) {\n+                Log.debug(\"Removing \"+f.getPath()+\" since it is unknown to the javac_state.\");\n+                f.delete();\n+            }\n+        }\n+        for (File f : headerArtifacts) {\n+            if (!allKnownArtifacts.contains(f)) {\n+                Log.debug(\"Removing \"+f.getPath()+\" since it is unknown to the javac_state.\");\n+                f.delete();\n+            }\n+        }\n+        for (File f : gensrcArtifacts) {\n+            if (!allKnownArtifacts.contains(f)) {\n+                Log.debug(\"Removing \"+f.getPath()+\" since it is unknown to the javac_state.\");\n+                f.delete();\n+            }\n+        }\n+    }\n+\n+    \/**\n+     * Remove artifacts that are no longer produced when compiling!\n+     *\/\n+    public void removeSuperfluousArtifacts(Set<String> recentlyCompiled) {\n+        \/\/ Nothing to do, if nothing was recompiled.\n+        if (recentlyCompiled.size() == 0) return;\n+\n+        for (String pkg : now.packages().keySet()) {\n+            \/\/ If this package has not been recompiled, skip the check.\n+            if (!recentlyCompiled.contains(pkg)) continue;\n+            Collection<File> arts = now.artifacts().values();\n+            for (File f : fetchPrevArtifacts(pkg).values()) {\n+                if (!arts.contains(f)) {\n+                    Log.debug(\"Removing \"+f.getPath()+\" since it is now superfluous!\");\n+                    if (f.exists()) f.delete();\n+                }\n+            }\n+        }\n+    }\n+\n+    \/**\n+     * Return those files belonging to prev, but not now.\n+     *\/\n+    private Set<Source> calculateRemovedSources() {\n+        Set<Source> removed = new HashSet<>();\n+        for (String src : prev.sources().keySet()) {\n+            if (now.sources().get(src) == null) {\n+                removed.add(prev.sources().get(src));\n+            }\n+        }\n+        return removed;\n+    }\n+\n+    \/**\n+     * Return those files belonging to now, but not prev.\n+     *\/\n+    private Set<Source> calculateAddedSources() {\n+        Set<Source> added = new HashSet<>();\n+        for (String src : now.sources().keySet()) {\n+            if (prev.sources().get(src) == null) {\n+                added.add(now.sources().get(src));\n+            }\n+        }\n+        return added;\n+    }\n+\n+    \/**\n+     * Return those files where the timestamp is newer.\n+     * If a source file timestamp suddenly is older than what is known\n+     * about it in javac_state, then consider it modified, but print\n+     * a warning!\n+     *\/\n+    private Set<Source> calculateModifiedSources() {\n+        Set<Source> modified = new HashSet<>();\n+        for (String src : now.sources().keySet()) {\n+            Source n = now.sources().get(src);\n+            Source t = prev.sources().get(src);\n+            if (prev.sources().get(src) != null) {\n+                if (t != null) {\n+                    if (n.lastModified() > t.lastModified()) {\n+                        modified.add(n);\n+                    } else if (n.lastModified() < t.lastModified()) {\n+                        modified.add(n);\n+                        Log.warn(\"The source file \"+n.name()+\" timestamp has moved backwards in time.\");\n+                    }\n+                }\n+            }\n+        }\n+        return modified;\n+    }\n+\n+    \/**\n+     * Recursively delete a directory and all its contents.\n+     *\/\n+    private void deleteContents(File dir) {\n+        if (dir != null && dir.exists()) {\n+            for (File f : dir.listFiles()) {\n+                if (f.isDirectory()) {\n+                    deleteContents(f);\n+                }\n+                if (!options.isUnidentifiedArtifactPermitted(f.getAbsolutePath())) {\n+                    Log.debug(\"Removing \"+f.getAbsolutePath());\n+                    f.delete();\n+                }\n+            }\n+        }\n+    }\n+\n+    \/**\n+     * Run the copy translator only.\n+     *\/\n+    public void performCopying(File binDir, Map<String,Transformer> suffixRules) {\n+        Map<String,Transformer> sr = new HashMap<>();\n+        for (Map.Entry<String,Transformer> e : suffixRules.entrySet()) {\n+            if (e.getValue().getClass().equals(CopyFile.class)) {\n+                sr.put(e.getKey(), e.getValue());\n+            }\n+        }\n+        perform(null, binDir, sr);\n+    }\n+\n+    \/**\n+     * Run all the translators that translate into java source code.\n+     * I.e. all translators that are not copy nor compile_java_source.\n+     *\/\n+    public void performTranslation(File gensrcDir, Map<String,Transformer> suffixRules) {\n+        Map<String,Transformer> sr = new HashMap<>();\n+        for (Map.Entry<String,Transformer> e : suffixRules.entrySet()) {\n+            Class<?> trClass = e.getValue().getClass();\n+            if (trClass == CompileJavaPackages.class || trClass == CopyFile.class)\n+                continue;\n+\n+            sr.put(e.getKey(), e.getValue());\n+        }\n+        perform(null, gensrcDir, sr);\n+    }\n+\n+    \/**\n+     * Compile all the java sources. Return true, if it needs to be called again!\n+     *\/\n+    public boolean performJavaCompilations(CompilationService sjavac,\n+                                           Options args,\n+                                           Set<String> recentlyCompiled,\n+                                           boolean[] rcValue) {\n+        Map<String,Transformer> suffixRules = new HashMap<>();\n+        suffixRules.put(\".java\", compileJavaPackages);\n+        compileJavaPackages.setExtra(args);\n+        rcValue[0] = perform(sjavac, binDir, suffixRules);\n+        recentlyCompiled.addAll(taintedPackages());\n+        clearTaintedPackages();\n+        boolean again = !packagesWithChangedPublicApis.isEmpty();\n+        taintPackagesDependingOnChangedPackages(packagesWithChangedPublicApis, recentlyCompiled);\n+        packagesWithChangedPublicApis = new HashSet<>();\n+        return again && rcValue[0];\n+\n+        \/\/ TODO: Figure out why 'again' checks packagesWithChangedPublicAPis.\n+        \/\/ (It shouldn't matter if packages had changed pub apis as long as no\n+        \/\/ one depends on them. Wouldn't it make more sense to let 'again'\n+        \/\/ depend on taintedPackages?)\n+    }\n+\n+    \/**\n+     * Store the source into the set of sources belonging to the given transform.\n+     *\/\n+    private void addFileToTransform(Map<Transformer,Map<String,Set<URI>>> gs, Transformer t, Source s) {\n+        Map<String,Set<URI>> fs = gs.get(t);\n+        if (fs == null) {\n+            fs = new HashMap<>();\n+            gs.put(t, fs);\n+        }\n+        Set<URI> ss = fs.get(s.pkg().name());\n+        if (ss == null) {\n+            ss = new HashSet<>();\n+            fs.put(s.pkg().name(), ss);\n+        }\n+        ss.add(s.file().toURI());\n+    }\n+\n+    \/**\n+     * For all packages, find all sources belonging to the package, group the sources\n+     * based on their transformers and apply the transformers on each source code group.\n+     *\/\n+    private boolean perform(CompilationService sjavac,\n+                            File outputDir,\n+                            Map<String,Transformer> suffixRules) {\n+        boolean rc = true;\n+        \/\/ Group sources based on transforms. A source file can only belong to a single transform.\n+        Map<Transformer,Map<String,Set<URI>>> groupedSources = new HashMap<>();\n+        for (Source src : now.sources().values()) {\n+            Transformer t = suffixRules.get(src.suffix());\n+            if (t != null) {\n+                if (taintedPackages.contains(src.pkg().name()) && !src.isLinkedOnly()) {\n+                    addFileToTransform(groupedSources, t, src);\n+                }\n+            }\n+        }\n+        \/\/ Go through the transforms and transform them.\n+        for (Map.Entry<Transformer, Map<String, Set<URI>>> e : groupedSources.entrySet()) {\n+            Transformer t = e.getKey();\n+            Map<String, Set<URI>> srcs = e.getValue();\n+            \/\/ These maps need to be synchronized since multiple threads will be\n+            \/\/ writing results into them.\n+            Map<String, Set<URI>> packageArtifacts = Collections.synchronizedMap(new HashMap<>());\n+            Map<String, Map<String, Set<String>>> packageDependencies = Collections.synchronizedMap(new HashMap<>());\n+            Map<String, Map<String, Set<String>>> packageCpDependencies = Collections.synchronizedMap(new HashMap<>());\n+            Map<String, PubApi> packagePublicApis = Collections.synchronizedMap(new HashMap<>());\n+            Map<String, PubApi> dependencyPublicApis = Collections.synchronizedMap(new HashMap<>());\n+\n+            boolean r = t.transform(sjavac,\n+                                    srcs,\n+                                    visibleSrcs,\n+                                    prev.dependents(),\n+                                    outputDir.toURI(),\n+                                    packageArtifacts,\n+                                    packageDependencies,\n+                                    packageCpDependencies,\n+                                    packagePublicApis,\n+                                    dependencyPublicApis,\n+                                    0,\n+                                    isIncremental(),\n+                                    numCores);\n+            if (!r)\n+                rc = false;\n+\n+            for (String p : srcs.keySet()) {\n+                recompiledPackages.add(p);\n+            }\n+            \/\/ The transform is done! Extract all the artifacts and store the info into the Package objects.\n+            for (Map.Entry<String, Set<URI>> a : packageArtifacts.entrySet()) {\n+                Module mnow = now.findModuleFromPackageName(a.getKey());\n+                mnow.addArtifacts(a.getKey(), a.getValue());\n+            }\n+            \/\/ Extract all the dependencies and store the info into the Package objects.\n+            for (Map.Entry<String, Map<String, Set<String>>> a : packageDependencies.entrySet()) {\n+                Map<String, Set<String>> deps = a.getValue();\n+                Module mnow = now.findModuleFromPackageName(a.getKey());\n+                mnow.setDependencies(a.getKey(), deps, false);\n+            }\n+            for (Map.Entry<String, Map<String, Set<String>>> a : packageCpDependencies.entrySet()) {\n+                Map<String, Set<String>> deps = a.getValue();\n+                Module mnow = now.findModuleFromPackageName(a.getKey());\n+                mnow.setDependencies(a.getKey(), deps, true);\n+            }\n+\n+            \/\/ This map contains the public api of the types that this\n+            \/\/ compilation depended upon. This means that it may not contain\n+            \/\/ full packages. In other words, we shouldn't remove knowledge of\n+            \/\/ public apis but merge these with what we already have.\n+            for (Map.Entry<String, PubApi> a : dependencyPublicApis.entrySet()) {\n+                String pkg = a.getKey();\n+                PubApi packagePartialPubApi = a.getValue();\n+                Package pkgNow = now.findModuleFromPackageName(pkg).lookupPackage(pkg);\n+                PubApi currentPubApi = pkgNow.getPubApi();\n+                PubApi newPubApi = PubApi.mergeTypes(currentPubApi, packagePartialPubApi);\n+                pkgNow.setPubapi(newPubApi);\n+\n+                \/\/ See JDK-8071904\n+                if (now.packages().containsKey(pkg))\n+                    now.packages().get(pkg).setPubapi(newPubApi);\n+                else\n+                    now.packages().put(pkg, pkgNow);\n+            }\n+\n+            \/\/ The packagePublicApis cover entire packages (since sjavac compiles\n+            \/\/ stuff on package level). This means that if a type is missing\n+            \/\/ in the public api of a given package, it means that it has been\n+            \/\/ removed. In other words, we should *set* the pubapi to whatever\n+            \/\/ this map contains, and not merge it with what we already have.\n+            for (Map.Entry<String, PubApi> a : packagePublicApis.entrySet()) {\n+                String pkg = a.getKey();\n+                PubApi newPubApi = a.getValue();\n+                Module mprev = prev.findModuleFromPackageName(pkg);\n+                Module mnow = now.findModuleFromPackageName(pkg);\n+                mnow.setPubapi(pkg, newPubApi);\n+                if (mprev.hasPubapiChanged(pkg, newPubApi)) {\n+                    \/\/ Aha! The pubapi of this package has changed!\n+                    \/\/ It can also be a new compile from scratch.\n+                    if (mprev.lookupPackage(pkg).existsInJavacState()) {\n+                        \/\/ This is an incremental compile! The pubapi\n+                        \/\/ did change. Trigger recompilation of dependents.\n+                        packagesWithChangedPublicApis.add(pkg);\n+                        Log.debug(\"The API of \" + Util.justPackageName(pkg) + \" has changed!\");\n+                    }\n+                }\n+            }\n+        }\n+        return rc;\n+    }\n+\n+    \/**\n+     * Utility method to recursively find all files below a directory.\n+     *\/\n+    private static Set<File> findAllFiles(File dir) {\n+        Set<File> foundFiles = new HashSet<>();\n+        if (dir == null) {\n+            return foundFiles;\n+        }\n+        recurse(dir, foundFiles);\n+        return foundFiles;\n+    }\n+\n+    private static void recurse(File dir, Set<File> foundFiles) {\n+        for (File f : dir.listFiles()) {\n+            if (f.isFile()) {\n+                foundFiles.add(f);\n+            } else if (f.isDirectory()) {\n+                recurse(f, foundFiles);\n+            }\n+        }\n+    }\n+\n+    \/**\n+     * Compare the calculate source list, with an explicit list, usually\n+     * supplied from the makefile. Used to detect bugs where the makefile and\n+     * sjavac have different opinions on which files should be compiled.\n+     *\/\n+    public void compareWithMakefileList(File makefileSourceList)\n+            throws ProblemException {\n+        \/\/ If we are building on win32 using for example cygwin the paths in the\n+        \/\/ makefile source list\n+        \/\/ might be \/cygdrive\/c\/.... which does not match c:\\....\n+        \/\/ We need to adjust our calculated sources to be identical, if\n+        \/\/ necessary.\n+        boolean mightNeedRewriting = File.pathSeparatorChar == ';';\n+\n+        if (makefileSourceList == null)\n+            return;\n+\n+        Set<String> calculatedSources = new HashSet<>();\n+        Set<String> listedSources = new HashSet<>();\n+\n+        \/\/ Create a set of filenames with full paths.\n+        for (Source s : now.sources().values()) {\n+            \/\/ Don't include link only sources when comparing sources to compile\n+            if (!s.isLinkedOnly()) {\n+                String path = s.file().getPath();\n+                if (mightNeedRewriting)\n+                    path = Util.normalizeDriveLetter(path);\n+                calculatedSources.add(path);\n+            }\n+        }\n+        \/\/ Read in the file and create another set of filenames with full paths.\n+        try(BufferedReader in = new BufferedReader(new FileReader(makefileSourceList))) {\n+            for (;;) {\n+                String l = in.readLine();\n+                if (l==null) break;\n+                l = l.trim();\n+                if (mightNeedRewriting) {\n+                    if (l.indexOf(\":\") == 1 && l.indexOf(\"\\\\\") == 2) {\n+                        \/\/ Everything a-ok, the format is already C:\\foo\\bar\n+                    } else if (l.indexOf(\":\") == 1 && l.indexOf(\"\/\") == 2) {\n+                        \/\/ The format is C:\/foo\/bar, rewrite into the above format.\n+                        l = l.replaceAll(\"\/\",\"\\\\\\\\\");\n+                    } else if (l.charAt(0) == '\/' && l.indexOf(\"\/\",1) != -1) {\n+                        \/\/ The format might be: \/cygdrive\/c\/foo\/bar, rewrite into the above format.\n+                        \/\/ Do not hardcode the name cygdrive here.\n+                        int slash = l.indexOf(\"\/\",1);\n+                        l = l.replaceAll(\"\/\",\"\\\\\\\\\");\n+                        l = \"\"+l.charAt(slash+1)+\":\"+l.substring(slash+2);\n+                    }\n+                    if (Character.isLowerCase(l.charAt(0))) {\n+                        l = Character.toUpperCase(l.charAt(0))+l.substring(1);\n+                    }\n+                }\n+                listedSources.add(l);\n+            }\n+        } catch (FileNotFoundException | NoSuchFileException e) {\n+            throw new ProblemException(\"Could not open \"+makefileSourceList.getPath()+\" since it does not exist!\");\n+        } catch (IOException e) {\n+            throw new ProblemException(\"Could not read \"+makefileSourceList.getPath());\n+        }\n+\n+        for (String s : listedSources) {\n+            if (!calculatedSources.contains(s)) {\n+                 throw new ProblemException(\"The makefile listed source \"+s+\" was not calculated by the smart javac wrapper!\");\n+            }\n+        }\n+\n+        for (String s : calculatedSources) {\n+            if (!listedSources.contains(s)) {\n+                throw new ProblemException(\"The smart javac wrapper calculated source \"+s+\" was not listed by the makefiles!\");\n+            }\n+        }\n+    }\n+}\n","filename":"src\/jdk.compiler\/share\/classes\/com\/sun\/tools\/sjavac\/JavacState.java","additions":974,"deletions":0,"binary":false,"changes":974,"status":"added"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2012, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2012, 2016, Oracle and\/or its affiliates. All rights reserved.\n@@ -26,1 +26,1 @@\n-package javacserver;\n+package com.sun.tools.sjavac;\n","filename":"src\/jdk.compiler\/share\/classes\/com\/sun\/tools\/sjavac\/Log.java","additions":2,"deletions":2,"binary":false,"changes":4,"previous_filename":"make\/langtools\/tools\/javacserver\/Log.java","status":"renamed"},{"patch":"@@ -0,0 +1,58 @@\n+\/*\n+ * Copyright (c) 2012, 2014, Oracle and\/or its affiliates. All rights reserved.\n+ * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+ *\n+ * This code is free software; you can redistribute it and\/or modify it\n+ * under the terms of the GNU General Public License version 2 only, as\n+ * published by the Free Software Foundation.  Oracle designates this\n+ * particular file as subject to the \"Classpath\" exception as provided\n+ * by Oracle in the LICENSE file that accompanied this code.\n+ *\n+ * This code is distributed in the hope that it will be useful, but WITHOUT\n+ * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+ * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+ * version 2 for more details (a copy is included in the LICENSE file that\n+ * accompanied this code).\n+ *\n+ * You should have received a copy of the GNU General Public License version\n+ * 2 along with this work; if not, write to the Free Software Foundation,\n+ * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n+ *\n+ * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n+ * or visit www.oracle.com if you need additional information or have any\n+ * questions.\n+ *\/\n+\n+package com.sun.tools.sjavac;\n+\n+import static com.sun.tools.sjavac.options.Option.STARTSERVER;\n+\n+import java.util.Arrays;\n+\n+import com.sun.tools.sjavac.client.ClientMain;\n+import com.sun.tools.sjavac.server.ServerMain;\n+\n+\/**\n+ * The application entry point of the smart javac wrapper tool.\n+ *\n+ *  <p><b>This is NOT part of any supported API.\n+ *  If you write code that depends on this, you do so at your own risk.\n+ *  This code and its internal interfaces are subject to change or\n+ *  deletion without notice.<\/b>\n+ *\/\n+public class Main {\n+\n+    public static void main(String... args)  {\n+        System.exit(go(args));\n+    }\n+\n+    public static int go(String[] args) {\n+\n+        \/\/ Server or client mode?\n+        boolean serverMode = Arrays.asList(args)\n+                                   .stream()\n+                                   .anyMatch(arg -> arg.startsWith(STARTSERVER.arg));\n+\n+        return serverMode ? ServerMain.run(args) : ClientMain.run(args);\n+    }\n+}\n","filename":"src\/jdk.compiler\/share\/classes\/com\/sun\/tools\/sjavac\/Main.java","additions":58,"deletions":0,"binary":false,"changes":58,"status":"added"},{"patch":"@@ -0,0 +1,141 @@\n+\/*\n+ * Copyright (c) 2012, 2021, Oracle and\/or its affiliates. All rights reserved.\n+ * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+ *\n+ * This code is free software; you can redistribute it and\/or modify it\n+ * under the terms of the GNU General Public License version 2 only, as\n+ * published by the Free Software Foundation.  Oracle designates this\n+ * particular file as subject to the \"Classpath\" exception as provided\n+ * by Oracle in the LICENSE file that accompanied this code.\n+ *\n+ * This code is distributed in the hope that it will be useful, but WITHOUT\n+ * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+ * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+ * version 2 for more details (a copy is included in the LICENSE file that\n+ * accompanied this code).\n+ *\n+ * You should have received a copy of the GNU General Public License version\n+ * 2 along with this work; if not, write to the Free Software Foundation,\n+ * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n+ *\n+ * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n+ * or visit www.oracle.com if you need additional information or have any\n+ * questions.\n+ *\/\n+\n+package com.sun.tools.sjavac;\n+\n+import java.io.File;\n+import java.net.URI;\n+import java.util.HashMap;\n+import java.util.Map;\n+import java.util.Set;\n+\n+import com.sun.tools.sjavac.pubapi.PubApi;\n+\n+\/**\n+ * The module is the root of a set of packages\/sources\/artifacts.\n+ * At the moment there is only one module in use, the empty\/no-name\/default module.\n+ *\n+ *  <p><b>This is NOT part of any supported API.\n+ *  If you write code that depends on this, you do so at your own risk.\n+ *  This code and its internal interfaces are subject to change or\n+ *  deletion without notice.<\/b>\n+ *\/\n+public class Module implements Comparable<Module> {\n+    private String name;\n+    private String dirname;\n+    private Map<String,Package> packages = new HashMap<>();\n+    private Map<String,Source> sources = new HashMap<>();\n+    private Map<String,File> artifacts = new HashMap<>();\n+\n+    public Module(String n, String dn) {\n+        name = n;\n+        dirname = n;\n+    }\n+\n+    public String name() { return name; }\n+    public String dirname() { return dirname; }\n+    public Map<String,Package> packages() { return packages; }\n+    public Map<String,Source> sources() { return sources; }\n+    public Map<String,File> artifacts() { return artifacts; }\n+\n+    @Override\n+    public boolean equals(Object o) {\n+        return (o instanceof Module module) && name.equals(module.name);\n+    }\n+\n+    @Override\n+    public int hashCode() {\n+        return name.hashCode();\n+    }\n+\n+    @Override\n+    public int compareTo(Module o) {\n+        return name.compareTo(o.name);\n+    }\n+\n+    public void save(StringBuilder b) {\n+        b.append(\"M \").append(name).append(\":\").append(\"\\n\");\n+        Package.savePackages(packages, b);\n+    }\n+\n+    public static Module load(String l) {\n+        int cp = l.indexOf(':',2);\n+        if (cp == -1) return null;\n+        String name = l.substring(2,cp);\n+        return new Module(name, \"\");\n+    }\n+\n+    public static void saveModules(Map<String,Module> ms, StringBuilder b) {\n+        for (Module m : ms.values()) {\n+            m.save(b);\n+        }\n+    }\n+\n+    public void addPackage(Package p) {\n+        packages.put(p.name(), p);\n+    }\n+\n+    public Package lookupPackage(String pkg) {\n+        \/\/ See JDK-8071904\n+        Package p = packages.get(pkg);\n+        if (p == null) {\n+            p = new Package(this, pkg);\n+            packages.put(pkg, p);\n+        }\n+        return p;\n+    }\n+\n+    public void addSource(String pkg, Source src) {\n+        Package p = lookupPackage(pkg);\n+        src.setPackage(p);\n+        p.addSource(src);\n+        sources.put(src.file().getPath(), src);\n+    }\n+\n+    public Source lookupSource(String path) {\n+        return sources.get(path);\n+    }\n+\n+    public void addArtifacts(String pkg, Set<URI> as) {\n+        Package p = lookupPackage(pkg);\n+        for (URI u : as) {\n+            p.addArtifact(new File(u));\n+        }\n+    }\n+\n+    public void setDependencies(String pkg, Map<String, Set<String>> deps, boolean cp) {\n+        lookupPackage(pkg).setDependencies(deps, cp);\n+    }\n+\n+    public void setPubapi(String pkg, PubApi ps) {\n+        Package p = lookupPackage(pkg);\n+        p.setPubapi(ps);\n+    }\n+\n+    public boolean hasPubapiChanged(String pkg, PubApi newPubApi) {\n+        Package p = lookupPackage(pkg);\n+        return p.hasPubApiChanged(newPubApi);\n+    }\n+}\n","filename":"src\/jdk.compiler\/share\/classes\/com\/sun\/tools\/sjavac\/Module.java","additions":141,"deletions":0,"binary":false,"changes":141,"status":"added"},{"patch":"@@ -0,0 +1,293 @@\n+\/*\n+ * Copyright (c) 2012, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+ *\n+ * This code is free software; you can redistribute it and\/or modify it\n+ * under the terms of the GNU General Public License version 2 only, as\n+ * published by the Free Software Foundation.  Oracle designates this\n+ * particular file as subject to the \"Classpath\" exception as provided\n+ * by Oracle in the LICENSE file that accompanied this code.\n+ *\n+ * This code is distributed in the hope that it will be useful, but WITHOUT\n+ * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+ * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+ * version 2 for more details (a copy is included in the LICENSE file that\n+ * accompanied this code).\n+ *\n+ * You should have received a copy of the GNU General Public License version\n+ * 2 along with this work; if not, write to the Free Software Foundation,\n+ * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n+ *\n+ * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n+ * or visit www.oracle.com if you need additional information or have any\n+ * questions.\n+ *\/\n+\n+package com.sun.tools.sjavac;\n+\n+import java.io.File;\n+import java.net.URI;\n+import java.util.ArrayList;\n+import java.util.Collections;\n+import java.util.HashMap;\n+import java.util.HashSet;\n+import java.util.List;\n+import java.util.Map;\n+import java.util.Set;\n+import java.util.TreeMap;\n+import java.util.regex.Matcher;\n+import java.util.regex.Pattern;\n+import java.util.stream.Stream;\n+\n+import com.sun.tools.javac.util.Assert;\n+import com.sun.tools.sjavac.pubapi.PubApi;\n+\n+\/**\n+ * The Package class maintains meta information about a package.\n+ * For example its sources, dependents, its pubapi and its artifacts.\n+ *\n+ * It might look odd that we track dependents\/pubapi\/artifacts on\n+ * a package level, but it makes sense since recompiling a full package\n+ * takes as long as recompiling a single java file in that package,\n+ * if you take into account the startup time of the jvm.\n+ *\n+ * Also the dependency information will be much smaller (good for the javac_state file size)\n+ * and it simplifies tracking artifact generation, you do not always know from which\n+ * source a class file was generated, but you always know which package it belongs to.\n+ *\n+ * It is also educational to see package dependencies triggering recompilation of\n+ * other packages. Even though the recompilation was perhaps not necessary,\n+ * the visible recompilation of the dependent packages indicates how much circular\n+ * dependencies your code has.\n+ *\n+ *  <p><b>This is NOT part of any supported API.\n+ *  If you write code that depends on this, you do so at your own risk.\n+ *  This code and its internal interfaces are subject to change or\n+ *  deletion without notice.<\/b>\n+ *\/\n+public class Package implements Comparable<Package> {\n+    \/\/ The module this package belongs to. (There is a legacy module with an empty string name,\n+    \/\/ used for all legacy sources.)\n+    private Module mod;\n+    \/\/ Name of this package, module:pkg\n+    \/\/ ex1 jdk.base:java.lang\n+    \/\/ ex2 :java.lang (when in legacy mode)\n+    private String name;\n+    \/\/ The directory path to the package. If the package belongs to a module,\n+    \/\/ then that module's file system name is part of the path.\n+    private String dirname;\n+    \/\/ This package has the following dependents, that depend on this package.\n+    private Set<String> dependents = new HashSet<>();\n+\n+    \/\/ Fully qualified name of class in this package -> fully qualified name of dependency\n+    private Map<String, Set<String>> dependencies = new TreeMap<>();\n+    \/\/ Fully qualified name of class in this package -> fully qualified name of dependency on class path\n+    private Map<String, Set<String>> cpDependencies = new TreeMap<>();\n+\n+    \/\/ This is the public api of this package.\n+    private PubApi pubApi = new PubApi();\n+    \/\/ Map from source file name to Source info object.\n+    private Map<String,Source> sources = new HashMap<>();\n+    \/\/ This package generated these artifacts.\n+    private Map<String,File> artifacts = new HashMap<>();\n+\n+    public Package(Module m, String n) {\n+        int c = n.indexOf(\":\");\n+        Assert.check(c != -1);\n+        Assert.check(m.name().equals(m.name()));\n+        name = n;\n+        dirname = n.replace('.', File.separatorChar);\n+        if (m.name().length() > 0) {\n+            \/\/ There is a module here, prefix the module dir name to the path.\n+            dirname = m.dirname()+File.separatorChar+dirname;\n+        }\n+    }\n+\n+    public Module mod() { return mod; }\n+    public String name() { return name; }\n+    public String dirname() { return dirname; }\n+    public Map<String,Source> sources() { return sources; }\n+    public Map<String,File> artifacts() { return artifacts; }\n+    public PubApi getPubApi() { return pubApi; }\n+\n+    public Map<String,Set<String>> typeDependencies() { return dependencies; }\n+    public Map<String,Set<String>> typeClasspathDependencies() { return cpDependencies; }\n+\n+    public Set<String> dependents() { return dependents; }\n+\n+    @Override\n+    public boolean equals(Object o) {\n+        return (o instanceof Package pac) && name.equals(pac.name);\n+    }\n+\n+    @Override\n+    public int hashCode() {\n+        return name.hashCode();\n+    }\n+\n+    @Override\n+    public int compareTo(Package o) {\n+        return name.compareTo(o.name);\n+    }\n+\n+    public void addSource(Source s) {\n+        sources.put(s.file().getPath(), s);\n+    }\n+\n+    private static Pattern DEP_PATTERN = Pattern.compile(\"(.*) -> (.*)\");\n+    public void parseAndAddDependency(String d, boolean cp) {\n+        Matcher m = DEP_PATTERN.matcher(d);\n+        if (!m.matches())\n+            throw new IllegalArgumentException(\"Bad dependency string: \" + d);\n+        addDependency(m.group(1), m.group(2), cp);\n+    }\n+\n+    public void addDependency(String fullyQualifiedFrom,\n+                              String fullyQualifiedTo,\n+                              boolean cp) {\n+        Map<String, Set<String>> map = cp ? cpDependencies : dependencies;\n+        if (!map.containsKey(fullyQualifiedFrom))\n+            map.put(fullyQualifiedFrom, new HashSet<>());\n+        map.get(fullyQualifiedFrom).add(fullyQualifiedTo);\n+    }\n+\n+    public void addDependent(String d) {\n+        dependents.add(d);\n+    }\n+\n+    \/**\n+     * Check if we have knowledge in the javac state that\n+     * describe the results of compiling this package before.\n+     *\/\n+    public boolean existsInJavacState() {\n+        return artifacts.size() > 0 || !pubApi.isEmpty();\n+    }\n+\n+    public boolean hasPubApiChanged(PubApi newPubApi) {\n+        return !newPubApi.isBackwardCompatibleWith(pubApi);\n+    }\n+\n+    public void setPubapi(PubApi newPubApi) {\n+        pubApi = newPubApi;\n+    }\n+\n+    public void setDependencies(Map<String, Set<String>> ds, boolean cp) {\n+        (cp ? cpDependencies : dependencies).clear();\n+        for (String fullyQualifiedFrom : ds.keySet())\n+            for (String fullyQualifiedTo : ds.get(fullyQualifiedFrom))\n+                addDependency(fullyQualifiedFrom, fullyQualifiedTo, cp);\n+    }\n+\n+    public void save(StringBuilder b) {\n+        b.append(\"P \").append(name).append(\"\\n\");\n+        Source.saveSources(sources, b);\n+        saveDependencies(b);\n+        savePubapi(b);\n+        saveArtifacts(b);\n+    }\n+\n+    public static Package load(Module module, String l) {\n+        String name = l.substring(2);\n+        return new Package(module, name);\n+    }\n+\n+    public void saveDependencies(StringBuilder b) {\n+\n+        \/\/ Dependencies where *to* is among sources\n+        for (String fullyQualifiedFrom : dependencies.keySet()) {\n+            for (String fullyQualifiedTo : dependencies.get(fullyQualifiedFrom)) {\n+                b.append(String.format(\"D S %s -> %s%n\", fullyQualifiedFrom, fullyQualifiedTo));\n+            }\n+        }\n+\n+        \/\/ Dependencies where *to* is on class path\n+        for (String fullyQualifiedFrom : cpDependencies.keySet()) {\n+            for (String fullyQualifiedTo : cpDependencies.get(fullyQualifiedFrom)) {\n+                b.append(String.format(\"D C %s -> %s%n\", fullyQualifiedFrom, fullyQualifiedTo));\n+            }\n+        }\n+    }\n+\n+    public void savePubapi(StringBuilder b) {\n+        pubApi.asListOfStrings()\n+              .stream()\n+              .flatMap(l -> Stream.of(\"I \", l, \"\\n\"))\n+              .forEach(b::append);\n+    }\n+\n+    public static void savePackages(Map<String,Package> packages, StringBuilder b) {\n+        List<String> sorted_packages = new ArrayList<>();\n+        for (String key : packages.keySet() ) {\n+            sorted_packages.add(key);\n+        }\n+        Collections.sort(sorted_packages);\n+        for (String s : sorted_packages) {\n+            Package p = packages.get(s);\n+            p.save(b);\n+        }\n+    }\n+\n+    public void addArtifact(String a) {\n+        artifacts.put(a, new File(a));\n+    }\n+\n+    public void addArtifact(File f) {\n+        artifacts.put(f.getPath(), f);\n+    }\n+\n+    public void addArtifacts(Set<URI> as) {\n+        for (URI u : as) {\n+            addArtifact(new File(u));\n+        }\n+    }\n+\n+    public void setArtifacts(Set<URI> as) {\n+        Assert.check(!artifacts.isEmpty());\n+        artifacts = new HashMap<>();\n+        addArtifacts(as);\n+    }\n+\n+    public void loadArtifact(String l) {\n+        \/\/ Find next space after \"A \".\n+        int dp = l.indexOf(' ',2);\n+        String fn = l.substring(2,dp);\n+        long last_modified = Long.parseLong(l.substring(dp+1));\n+        File f = new File(fn);\n+        if (f.exists() && f.lastModified() != last_modified) {\n+            \/\/ Hmm, the artifact on disk does not have the same last modified\n+            \/\/ timestamp as the information from the build database.\n+            \/\/ We no longer trust the artifact on disk. Delete it.\n+            \/\/ The smart javac wrapper will then rebuild the artifact.\n+            Log.debug(\"Removing \"+f.getPath()+\" since its timestamp does not match javac_state.\");\n+            f.delete();\n+        }\n+        artifacts.put(f.getPath(), f);\n+    }\n+\n+    public void saveArtifacts(StringBuilder b) {\n+        List<File> sorted_artifacts = new ArrayList<>();\n+        for (File f : artifacts.values()) {\n+            sorted_artifacts.add(f);\n+        }\n+        Collections.sort(sorted_artifacts);\n+        for (File f : sorted_artifacts) {\n+            \/\/ The last modified information is only used\n+            \/\/ to detect tampering with the output dir.\n+            \/\/ If the outputdir has been modified, not by javac,\n+            \/\/ then a mismatch will be detected in the last modified\n+            \/\/ timestamps stored in the build database compared\n+            \/\/ to the timestamps on disk and the artifact will be deleted.\n+\n+            b.append(\"A \"+f.getPath()+\" \"+f.lastModified()+\"\\n\");\n+        }\n+    }\n+\n+    \/**\n+     * Always clean out a tainted package before it is recompiled.\n+     *\/\n+    public void deleteArtifacts() {\n+        for (File a : artifacts.values()) {\n+            a.delete();\n+        }\n+    }\n+}\n","filename":"src\/jdk.compiler\/share\/classes\/com\/sun\/tools\/sjavac\/Package.java","additions":293,"deletions":0,"binary":false,"changes":293,"status":"added"},{"patch":"@@ -0,0 +1,41 @@\n+\/*\n+ * Copyright (c) 2012, 2014, Oracle and\/or its affiliates. All rights reserved.\n+ * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+ *\n+ * This code is free software; you can redistribute it and\/or modify it\n+ * under the terms of the GNU General Public License version 2 only, as\n+ * published by the Free Software Foundation.  Oracle designates this\n+ * particular file as subject to the \"Classpath\" exception as provided\n+ * by Oracle in the LICENSE file that accompanied this code.\n+ *\n+ * This code is distributed in the hope that it will be useful, but WITHOUT\n+ * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+ * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+ * version 2 for more details (a copy is included in the LICENSE file that\n+ * accompanied this code).\n+ *\n+ * You should have received a copy of the GNU General Public License version\n+ * 2 along with this work; if not, write to the Free Software Foundation,\n+ * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n+ *\n+ * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n+ * or visit www.oracle.com if you need additional information or have any\n+ * questions.\n+ *\/\n+\n+package com.sun.tools.sjavac;\n+\n+\/**\n+ * Used to signal serious problems when running sjavac.\n+ *\n+ *  <p><b>This is NOT part of any supported API.\n+ *  If you write code that depends on this, you do so at your own risk.\n+ *  This code and its internal interfaces are subject to change or\n+ *  deletion without notice.<\/b>\n+ *\/\n+public class ProblemException extends Exception {\n+    static final long serialVersionUID = -3387516993124229949L;\n+    public ProblemException(String s) {\n+        super(s);\n+    }\n+}\n","filename":"src\/jdk.compiler\/share\/classes\/com\/sun\/tools\/sjavac\/ProblemException.java","additions":41,"deletions":0,"binary":false,"changes":41,"status":"added"},{"patch":"@@ -0,0 +1,95 @@\n+\/*\n+ * Copyright (c) 2012, 2014, Oracle and\/or its affiliates. All rights reserved.\n+ * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+ *\n+ * This code is free software; you can redistribute it and\/or modify it\n+ * under the terms of the GNU General Public License version 2 only, as\n+ * published by the Free Software Foundation.  Oracle designates this\n+ * particular file as subject to the \"Classpath\" exception as provided\n+ * by Oracle in the LICENSE file that accompanied this code.\n+ *\n+ * This code is distributed in the hope that it will be useful, but WITHOUT\n+ * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+ * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+ * version 2 for more details (a copy is included in the LICENSE file that\n+ * accompanied this code).\n+ *\n+ * You should have received a copy of the GNU General Public License version\n+ * 2 along with this work; if not, write to the Free Software Foundation,\n+ * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n+ *\n+ * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n+ * or visit www.oracle.com if you need additional information or have any\n+ * questions.\n+ *\/\n+\n+package com.sun.tools.sjavac;\n+\n+import java.io.IOException;\n+import java.io.PrintWriter;\n+import java.util.Arrays;\n+\n+import javax.tools.JavaCompiler.CompilationTask;\n+import javax.tools.JavaFileManager;\n+\n+import com.sun.tools.javac.api.JavacTool;\n+import com.sun.tools.javac.code.ClassFinder;\n+import com.sun.tools.javac.code.Symbol.ClassSymbol;\n+import com.sun.tools.javac.code.Symtab;\n+import com.sun.tools.javac.main.JavaCompiler;\n+import com.sun.tools.javac.util.Context;\n+import com.sun.tools.javac.util.Convert;\n+import com.sun.tools.javac.util.Name;\n+import com.sun.tools.javac.util.Names;\n+import com.sun.tools.sjavac.comp.PubapiVisitor;\n+import com.sun.tools.sjavac.comp.SmartFileManager;\n+import com.sun.tools.sjavac.options.Options;\n+import com.sun.tools.sjavac.pubapi.PubApi;\n+\n+public class PubApiExtractor {\n+    \/\/ Setup a compiler context for finding classes in the classpath\n+    \/\/ and to execute annotation processors.\n+    final Context context;\n+    final CompilationTask task;\n+\n+    final SmartFileManager fileManager;\n+\n+    \/**\n+     * Setup a compilation context, used for reading public apis of classes on the classpath\n+     * as well as annotation processors.\n+     *\/\n+    public PubApiExtractor(Options options) {\n+        JavacTool compiler = com.sun.tools.javac.api.JavacTool.create();\n+        fileManager = new SmartFileManager(compiler.getStandardFileManager(null, null, null));\n+        context = new com.sun.tools.javac.util.Context();\n+        String[] args = options.prepJavacArgs();\n+        task = compiler.getTask(new PrintWriter(System.err),\n+                                fileManager,\n+                                null,\n+                                Arrays.asList(args),\n+                                null,\n+                                null,\n+                                context);\n+        \/\/ Trigger a creation of the JavaCompiler, necessary to get a sourceCompleter for ClassFinder.\n+        \/\/ The sourceCompleter is used for build situations where a classpath class references other classes\n+        \/\/ that happens to be on the sourcepath.\n+        JavaCompiler.instance(context);\n+\n+\/\/        context.put(JavaFileManager.class, fileManager);\n+    }\n+\n+    public PubApi getPubApi(String fullyQualifiedClassName) {\n+        Symtab syms = Symtab.instance(context);\n+        ClassFinder cr = ClassFinder.instance(context);\n+        Names ns = Names.instance(context);\n+        Name n = ns.fromString(fullyQualifiedClassName);\n+        ClassSymbol cs = cr.loadClass(syms.inferModule(Convert.packagePart(n)), n);\n+        PubapiVisitor v = new PubapiVisitor();\n+        v.visit(cs);\n+        return v.getCollectedPubApi();\n+    }\n+\n+    public void close() throws IOException {\n+        fileManager.close();\n+    }\n+}\n","filename":"src\/jdk.compiler\/share\/classes\/com\/sun\/tools\/sjavac\/PubApiExtractor.java","additions":95,"deletions":0,"binary":false,"changes":95,"status":"added"},{"patch":"@@ -0,0 +1,308 @@\n+\/*\n+ * Copyright (c) 2012, 2021, Oracle and\/or its affiliates. All rights reserved.\n+ * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+ *\n+ * This code is free software; you can redistribute it and\/or modify it\n+ * under the terms of the GNU General Public License version 2 only, as\n+ * published by the Free Software Foundation.  Oracle designates this\n+ * particular file as subject to the \"Classpath\" exception as provided\n+ * by Oracle in the LICENSE file that accompanied this code.\n+ *\n+ * This code is distributed in the hope that it will be useful, but WITHOUT\n+ * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+ * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+ * version 2 for more details (a copy is included in the LICENSE file that\n+ * accompanied this code).\n+ *\n+ * You should have received a copy of the GNU General Public License version\n+ * 2 along with this work; if not, write to the Free Software Foundation,\n+ * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n+ *\n+ * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n+ * or visit www.oracle.com if you need additional information or have any\n+ * questions.\n+ *\/\n+\n+package com.sun.tools.sjavac;\n+\n+import java.io.File;\n+import java.io.IOException;\n+import java.nio.file.FileSystem;\n+import java.nio.file.FileVisitResult;\n+import java.nio.file.Files;\n+import java.nio.file.Path;\n+import java.nio.file.PathMatcher;\n+import java.nio.file.SimpleFileVisitor;\n+import java.nio.file.attribute.BasicFileAttributes;\n+import java.util.Set;\n+import java.util.Collections;\n+import java.util.List;\n+import java.util.ArrayList;\n+import java.util.Map;\n+import java.util.regex.PatternSyntaxException;\n+\n+\/** A Source object maintains information about a source file.\n+ * For example which package it belongs to and kind of source it is.\n+ * The class also knows how to find source files (scanRoot) given include\/exclude\n+ * patterns and a root.\n+ *\n+ *  <p><b>This is NOT part of any supported API.\n+ *  If you write code that depends on this, you do so at your own risk.\n+ *  This code and its internal interfaces are subject to change or\n+ *  deletion without notice.<\/b>\n+ *\/\n+public class Source implements Comparable<Source> {\n+    \/\/ The package the source belongs to.\n+   private Package pkg;\n+    \/\/ Name of this source file, relative its source root.\n+    \/\/ For example: java\/lang\/Object.java\n+    \/\/ Or if the source file is inside a module:\n+    \/\/ jdk.base\/java\/lang\/Object.java\n+    private String name;\n+    \/\/ What kind of file is this.\n+    private String suffix;\n+    \/\/ When this source file was last_modified\n+    private long lastModified;\n+    \/\/ The source File.\n+    private File file;\n+    \/\/ If the source is generated.\n+    private boolean isGenerated;\n+    \/\/ If the source is only linked to, not compiled.\n+    private boolean linkedOnly;\n+\n+    @Override\n+    public boolean equals(Object o) {\n+        return (o instanceof Source source) && name.equals(source.name);\n+    }\n+\n+    @Override\n+    public int compareTo(Source o) {\n+        return name.compareTo(o.name);\n+    }\n+\n+    @Override\n+    public int hashCode() {\n+        return name.hashCode();\n+    }\n+\n+    public Source(Module m, String n, File f) {\n+        name = n;\n+        int dp = n.lastIndexOf(\".\");\n+        if (dp != -1) {\n+            suffix = n.substring(dp);\n+        } else {\n+            suffix = \"\";\n+        }\n+        file = f;\n+        lastModified = f.lastModified();\n+        linkedOnly = false;\n+    }\n+\n+    public Source(Package p, String n, long lm) {\n+        pkg = p;\n+        name = n;\n+        int dp = n.lastIndexOf(\".\");\n+        if (dp != -1) {\n+            suffix = n.substring(dp);\n+        } else {\n+            suffix = \"\";\n+        }\n+        file = null;\n+        lastModified = lm;\n+        linkedOnly = false;\n+        int ls = n.lastIndexOf('\/');\n+    }\n+\n+    public String name() { return name; }\n+    public String suffix() { return suffix; }\n+    public Package pkg() { return pkg; }\n+    public File   file() { return file; }\n+    public long lastModified() {\n+        return lastModified;\n+    }\n+\n+    public void setPackage(Package p) {\n+        pkg = p;\n+    }\n+\n+    public void markAsGenerated() {\n+        isGenerated = true;\n+    }\n+\n+    public boolean isGenerated() {\n+        return isGenerated;\n+    }\n+\n+    public void markAsLinkedOnly() {\n+        linkedOnly = true;\n+    }\n+\n+    public boolean isLinkedOnly() {\n+        return linkedOnly;\n+    }\n+\n+    private void save(StringBuilder b) {\n+        String CL = linkedOnly?\"L\":\"C\";\n+        String GS = isGenerated?\"G\":\"S\";\n+        b.append(GS+\" \"+CL+\" \"+name+\" \"+file.lastModified()+\"\\n\");\n+    }\n+    \/\/ Parse a line that looks like this:\n+    \/\/ S C \/code\/alfa\/A.java 1357631228000\n+    public static Source load(Package lastPackage, String l, boolean isGenerated) {\n+        int sp = l.indexOf(' ',4);\n+        if (sp == -1) return null;\n+        String name = l.substring(4,sp);\n+        long last_modified = Long.parseLong(l.substring(sp+1));\n+\n+        boolean isLinkedOnly = false;\n+        if (l.charAt(2) == 'L') {\n+            isLinkedOnly = true;\n+        } else if (l.charAt(2) == 'C') {\n+            isLinkedOnly = false;\n+        } else return null;\n+\n+        Source s = new Source(lastPackage, name, last_modified);\n+        s.file = new File(name);\n+        if (isGenerated) s.markAsGenerated();\n+        if (isLinkedOnly) s.markAsLinkedOnly();\n+        return s;\n+    }\n+\n+    public static void saveSources(Map<String,Source> sources, StringBuilder b) {\n+        List<String> sorted_sources = new ArrayList<>();\n+        for (String key : sources.keySet()) {\n+            sorted_sources.add(key);\n+        }\n+        Collections.sort(sorted_sources);\n+        for (String key : sorted_sources) {\n+            Source s = sources.get(key);\n+            s.save(b);\n+        }\n+    }\n+\n+    \/**\n+     * Recurse into the directory root and find all files matching the excl\/incl\/exclfiles\/inclfiles rules.\n+     * Detects the existence of module-info.java files and presumes that the directory it resides in\n+     * is the name of the current module.\n+     *\/\n+    public static void scanRoot(File root,\n+                                Set<String> suffixes,\n+                                List<String> excludes,\n+                                List<String> includes,\n+                                Map<String,Source> foundFiles,\n+                                Map<String,Module> foundModules,\n+                                final Module currentModule,\n+                                boolean permitSourcesWithoutPackage,\n+                                boolean inGensrc,\n+                                boolean inLinksrc)\n+                                        throws IOException, ProblemException {\n+\n+        if (root == null)\n+            return;\n+\n+        FileSystem fs = root.toPath().getFileSystem();\n+\n+        if (includes.isEmpty()) {\n+            includes = Collections.singletonList(\"**\");\n+        }\n+\n+        List<PathMatcher> includeMatchers = createPathMatchers(fs, includes);\n+        List<PathMatcher> excludeMatchers = createPathMatchers(fs, excludes);\n+\n+        Files.walkFileTree(root.toPath(), new SimpleFileVisitor<Path>() {\n+            @Override\n+            public FileVisitResult visitFile(Path file, BasicFileAttributes attrs) throws IOException {\n+\n+                Path relToRoot = root.toPath().relativize(file);\n+\n+                if (includeMatchers.stream().anyMatch(im -> im.matches(relToRoot))\n+                        && excludeMatchers.stream().noneMatch(em -> em.matches(relToRoot))\n+                        && suffixes.contains(Util.fileSuffix(file))) {\n+\n+                    \/\/ TODO: Test this.\n+                    Source existing = foundFiles.get(file);\n+                    if (existing != null) {\n+                        throw new IOException(\"You have already added the file \"+file+\" from \"+existing.file().getPath());\n+                    }\n+                    existing = currentModule.lookupSource(file.toString());\n+                    if (existing != null) {\n+\n+                            \/\/ Oops, the source is already added, could be ok, could be not, let's check.\n+                            if (inLinksrc) {\n+                                \/\/ So we are collecting sources for linking only.\n+                                if (existing.isLinkedOnly()) {\n+                                    \/\/ Ouch, this one is also for linking only. Bad.\n+                                    throw new IOException(\"You have already added the link only file \" + file + \" from \" + existing.file().getPath());\n+                                }\n+                                \/\/ Ok, the existing source is to be compiled. Thus this link only is redundant\n+                                \/\/ since all compiled are also linked to. Continue to the next source.\n+                                \/\/ But we need to add the source, so that it will be visible to linking,\n+                                \/\/ if not the multi core compile will fail because a JavaCompiler cannot\n+                                \/\/ find the necessary dependencies for its part of the source.\n+                                foundFiles.put(file.toString(), existing);\n+                            } else {\n+                                \/\/ We are looking for sources to compile, if we find an existing to be compiled\n+                                \/\/ source with the same name, it is an internal error, since we must\n+                                \/\/ find the sources to be compiled before we find the sources to be linked to.\n+                                throw new IOException(\"Internal error: Double add of file \" + file + \" from \" + existing.file().getPath());\n+                            }\n+\n+                    } else {\n+\n+                        \/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\n+                        \/\/ Add source\n+                        Source s = new Source(currentModule, file.toString(), file.toFile());\n+                        if (inGensrc) {\n+                            s.markAsGenerated();\n+                        }\n+                        if (inLinksrc) {\n+                            s.markAsLinkedOnly();\n+                        }\n+                        String pkg = packageOfJavaFile(root.toPath(), file);\n+                        pkg = currentModule.name() + \":\" + pkg;\n+                        foundFiles.put(file.toString(), s);\n+                        currentModule.addSource(pkg, s);\n+                        \/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\n+                    }\n+                }\n+\n+                return FileVisitResult.CONTINUE;\n+            }\n+        });\n+    }\n+\n+    private static List<PathMatcher> createPathMatchers(FileSystem fs, List<String> patterns) {\n+        List<PathMatcher> matchers = new ArrayList<>();\n+        for (String pattern : patterns) {\n+            try {\n+                matchers.add(fs.getPathMatcher(\"glob:\" + pattern));\n+            } catch (PatternSyntaxException e) {\n+                Log.error(\"Invalid pattern: \" + pattern);\n+                throw e;\n+            }\n+        }\n+        return matchers;\n+    }\n+\n+    private static String packageOfJavaFile(Path sourceRoot, Path javaFile) {\n+        Path javaFileDir = javaFile.getParent();\n+        Path packageDir = sourceRoot.relativize(javaFileDir);\n+        List<String> separateDirs = new ArrayList<>();\n+        for (Path pathElement : packageDir) {\n+            separateDirs.add(pathElement.getFileName().toString());\n+        }\n+        return String.join(\".\", separateDirs);\n+    }\n+\n+    @Override\n+    public String toString() {\n+        return String.format(\"%s[pkg: %s, name: %s, suffix: %s, file: %s, isGenerated: %b, linkedOnly: %b]\",\n+                             getClass().getSimpleName(),\n+                             pkg,\n+                             name,\n+                             suffix,\n+                             file,\n+                             isGenerated,\n+                             linkedOnly);\n+    }\n+}\n","filename":"src\/jdk.compiler\/share\/classes\/com\/sun\/tools\/sjavac\/Source.java","additions":308,"deletions":0,"binary":false,"changes":308,"status":"added"},{"patch":"@@ -0,0 +1,102 @@\n+\/*\n+ * Copyright (c) 2012, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+ *\n+ * This code is free software; you can redistribute it and\/or modify it\n+ * under the terms of the GNU General Public License version 2 only, as\n+ * published by the Free Software Foundation.  Oracle designates this\n+ * particular file as subject to the \"Classpath\" exception as provided\n+ * by Oracle in the LICENSE file that accompanied this code.\n+ *\n+ * This code is distributed in the hope that it will be useful, but WITHOUT\n+ * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+ * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+ * version 2 for more details (a copy is included in the LICENSE file that\n+ * accompanied this code).\n+ *\n+ * You should have received a copy of the GNU General Public License version\n+ * 2 along with this work; if not, write to the Free Software Foundation,\n+ * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n+ *\n+ * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n+ * or visit www.oracle.com if you need additional information or have any\n+ * questions.\n+ *\/\n+\n+package com.sun.tools.sjavac;\n+\n+import java.io.Writer;\n+import java.net.URI;\n+import java.util.Map;\n+import java.util.Set;\n+\n+import com.sun.tools.sjavac.comp.CompilationService;\n+import com.sun.tools.sjavac.options.Options;\n+import com.sun.tools.sjavac.pubapi.PubApi;\n+\n+\/**\n+ * The transform interface is used to transform content inside a package, from one form to another.\n+ * Usually the output form is an unpredictable number of output files. (eg class files)\n+ * but can also be an unpredictable number of generated source files (eg idl2java)\n+ * or a single predictable output file (eg when copying, cleaning or compiling a properties file).\n+ *\n+ *  <p><b>This is NOT part of any supported API.\n+ *  If you write code that depends on this, you do so at your own risk.\n+ *  This code and its internal interfaces are subject to change or\n+ *  deletion without notice.<\/b>\n+ *\/\n+public interface Transformer {\n+    \/**\n+     * The transform method takes a set of package names, mapped to their source files and to the\n+     * pubapis of the packages.\n+     *\n+     * The transform implementation must:\n+     *    store the names of the generated artifacts for each package into package_artifacts\n+     *    store found dependencies to other packages into the supplied set package_dependencies\n+     *    store the public api for a package into the supplied set package_pubapis\n+     *\n+     * Any benign messages as a result of running the transform\n+     * are written into stdout, and errors are written to stderr.\n+     *\n+     * The debug_level can be 0=silent (only warnings and errors) 1=normal 2=verbose 3 or greater=debug\n+     * setExtra is used to set the extra information information that can be passed on\n+     * the command line to the smart javac wrapper.\n+     *\n+     * If sjavac is building incrementally from an existing javac_state, the var incremental is true.\n+     *\n+     * The transformer will only be called if some source in the package (or dependency) has\n+     * a modified timestamp. Thus the transformer might get called with many sources, of which\n+     * only one has changed. The transformer is allowed to regenerate all artifacts but\n+     * a better transformer will only write those artifacts that need updating.\n+     *\n+     * However the transformer must verify that the existing artifacts really are there!\n+     * and it must always update package_artifacts, package_dependencies, and package_pubapis correctly.\n+     * This means that at least for Java source, it will always have to recompile the sources.\n+     *\n+     * The transformer is allowed to put files anywhere in the dest_root.\n+     * An example of this is, can be the META-INF transformer that copy files\n+     * below META-INF directories to the single META-INF directory below dest_root.\n+     *\n+     * False is returned if there was an error that prevented the transform.\n+     * I.e. something was printed on stderr.\n+     *\n+     * If num_cores is set to a non-zero value. The transform should attempt to use no more than these\n+     * number of threads for heavy work.\n+     *\/\n+    boolean transform(CompilationService sjavac,\n+                      Map<String,Set<URI>> pkgSrcs,\n+                      Set<URI>             visibleSources,\n+                      Map<String,Set<String>> oldPackageDependencies,\n+                      URI destRoot,\n+                      Map<String,Set<URI>>    packageArtifacts,\n+                      Map<String, Map<String, Set<String>>> packageDependencies,   \/\/ Package name -> Fully Qualified Type [from] -> Set of fully qualified type [to]\n+                      Map<String, Map<String, Set<String>>> packageCpDependencies, \/\/ Package name -> Fully Qualified Type [from] -> Set of fully qualified type [to]\n+                      Map<String, PubApi>     packagePublicApis,\n+                      Map<String, PubApi>     dependencyApis,\n+                      int debugLevel,\n+                      boolean incremental,\n+                      int numCores);\n+\n+    void setExtra(String e);\n+    void setExtra(Options args);\n+}\n","filename":"src\/jdk.compiler\/share\/classes\/com\/sun\/tools\/sjavac\/Transformer.java","additions":102,"deletions":0,"binary":false,"changes":102,"status":"added"},{"patch":"@@ -0,0 +1,255 @@\n+\/*\n+ * Copyright (c) 2012, 2020, Oracle and\/or its affiliates. All rights reserved.\n+ * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+ *\n+ * This code is free software; you can redistribute it and\/or modify it\n+ * under the terms of the GNU General Public License version 2 only, as\n+ * published by the Free Software Foundation.  Oracle designates this\n+ * particular file as subject to the \"Classpath\" exception as provided\n+ * by Oracle in the LICENSE file that accompanied this code.\n+ *\n+ * This code is distributed in the hope that it will be useful, but WITHOUT\n+ * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+ * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+ * version 2 for more details (a copy is included in the LICENSE file that\n+ * accompanied this code).\n+ *\n+ * You should have received a copy of the GNU General Public License version\n+ * 2 along with this work; if not, write to the Free Software Foundation,\n+ * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n+ *\n+ * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n+ * or visit www.oracle.com if you need additional information or have any\n+ * questions.\n+ *\/\n+\n+package com.sun.tools.sjavac;\n+\n+import java.io.File;\n+import java.io.PrintWriter;\n+import java.io.StringWriter;\n+import java.nio.file.Path;\n+import java.util.Arrays;\n+import java.util.Collection;\n+import java.util.HashSet;\n+import java.util.Map;\n+import java.util.Set;\n+import java.util.StringTokenizer;\n+import java.util.function.Function;\n+import java.util.regex.Pattern;\n+import java.util.stream.Collectors;\n+import java.util.stream.Stream;\n+\n+\/**\n+ * Utilities.\n+ *\n+ *  <p><b>This is NOT part of any supported API.\n+ *  If you write code that depends on this, you do so at your own risk.\n+ *  This code and its internal interfaces are subject to change or\n+ *  deletion without notice.<\/b>\n+ *\/\n+public class Util {\n+\n+    public static String toFileSystemPath(String pkgId) {\n+        if (pkgId == null || pkgId.length()==0) return null;\n+        String pn;\n+        if (pkgId.charAt(0) == ':') {\n+            \/\/ When the module is the default empty module.\n+            \/\/ Do not prepend the module directory, because there is none.\n+            \/\/ Thus :java.foo.bar translates to java\/foo\/bar (or \\)\n+            pn = pkgId.substring(1).replace('.',File.separatorChar);\n+        } else {\n+            \/\/ There is a module. Thus jdk.base:java.foo.bar translates\n+            \/\/ into jdk.base\/java\/foo\/bar\n+            int cp = pkgId.indexOf(':');\n+            String mn = pkgId.substring(0,cp);\n+            pn = mn+File.separatorChar+pkgId.substring(cp+1).replace('.',File.separatorChar);\n+        }\n+        return pn;\n+    }\n+\n+    public static String justPackageName(String pkgName) {\n+        int c = pkgName.indexOf(\":\");\n+        if (c == -1)\n+            throw new IllegalArgumentException(\"Expected ':' in package name (\" + pkgName + \")\");\n+        return pkgName.substring(c+1);\n+    }\n+\n+    public static String extractStringOption(String opName, String s) {\n+        return extractStringOption(opName, s, null);\n+    }\n+\n+    private static String extractStringOptionWithDelimiter(String opName, String s, String deflt, char delimiter) {\n+        int p = s.indexOf(opName+\"=\");\n+        if (p == -1) return deflt;\n+        p+=opName.length()+1;\n+        int pe = s.indexOf(delimiter, p);\n+        if (pe == -1) pe = s.length();\n+        return s.substring(p, pe);\n+    }\n+\n+    public static String extractStringOption(String opName, String s, String deflt) {\n+        return extractStringOptionWithDelimiter(opName, s, deflt, ',');\n+    }\n+\n+    public static String extractStringOptionLine(String opName, String s, String deflt) {\n+        return extractStringOptionWithDelimiter(opName, s, deflt, '\\n').strip();\n+    }\n+\n+    public static boolean extractBooleanOption(String opName, String s, boolean deflt) {\n+        String str = extractStringOption(opName, s);\n+        return \"true\".equals(str) ? true\n+             : \"false\".equals(str) ? false\n+             : deflt;\n+    }\n+\n+    public static int extractIntOption(String opName, String s) {\n+        return extractIntOption(opName, s, 0);\n+    }\n+\n+    public static int extractIntOption(String opName, String s, int deflt) {\n+        int p = s.indexOf(opName+\"=\");\n+        if (p == -1) return deflt;\n+        p+=opName.length()+1;\n+        int pe = s.indexOf(',', p);\n+        if (pe == -1) pe = s.length();\n+        int v = 0;\n+        try {\n+            v = Integer.parseInt(s.substring(p, pe));\n+        } catch (Exception e) {}\n+        return v;\n+    }\n+\n+    \/**\n+     * Extract the package name from a fully qualified class name.\n+     *\n+     * Example: Given \"pkg.subpkg.A\" this method returns \":pkg.subpkg\".\n+     * Given \"C\" this method returns \":\".\n+     *\n+     * @returns package name of the given class name\n+     *\/\n+    public static String pkgNameOfClassName(String fqClassName) {\n+        int i = fqClassName.lastIndexOf('.');\n+        String pkg = i == -1 ? \"\" : fqClassName.substring(0, i);\n+        return \":\" + pkg;\n+    }\n+\n+    \/**\n+     * Clean out unwanted sub options supplied inside a primary option.\n+     * For example to only had portfile remaining from:\n+     *    settings=\"--server:id=foo,portfile=bar\"\n+     * do settings = cleanOptions(\"--server:\",Util.set(\"-portfile\"),settings);\n+     *    now settings equals \"--server:portfile=bar\"\n+     *\n+     * @param allowedSubOptions A set of the allowed sub options, id portfile etc.\n+     * @param s The option settings string.\n+     *\/\n+    public static String cleanSubOptions(Set<String> allowedSubOptions, String s) {\n+        StringBuilder sb = new StringBuilder();\n+        StringTokenizer st = new StringTokenizer(s, \",\");\n+        while (st.hasMoreTokens()) {\n+            String o = st.nextToken();\n+            int p = o.indexOf('=');\n+            if (p>0) {\n+                String key = o.substring(0,p);\n+                String val = o.substring(p+1);\n+                if (allowedSubOptions.contains(key)) {\n+                    if (sb.length() > 0) sb.append(',');\n+                    sb.append(key+\"=\"+val);\n+                }\n+            }\n+        }\n+        return sb.toString();\n+    }\n+\n+    \/**\n+     * Convenience method to create a set with strings.\n+     *\/\n+    public static Set<String> set(String... ss) {\n+        Set<String> set = new HashSet<>();\n+        set.addAll(Arrays.asList(ss));\n+        return set;\n+    }\n+\n+    \/**\n+     * Normalize windows drive letter paths to upper case to enable string\n+     * comparison.\n+     *\n+     * @param file File name to normalize\n+     * @return The normalized string if file has a drive letter at the beginning,\n+     *         otherwise the original string.\n+     *\/\n+    public static String normalizeDriveLetter(String file) {\n+        if (file.length() > 2 && file.charAt(1) == ':') {\n+            return Character.toUpperCase(file.charAt(0)) + file.substring(1);\n+        } else if (file.length() > 3 && file.charAt(0) == '*'\n+                   && file.charAt(2) == ':') {\n+            \/\/ Handle a wildcard * at the beginning of the string.\n+            return file.substring(0, 1) + Character.toUpperCase(file.charAt(1))\n+                   + file.substring(2);\n+        }\n+        return file;\n+    }\n+\n+    \/**\n+     * Locate the setting for the server properties.\n+     *\/\n+    public static String findServerSettings(String[] args) {\n+        for (String s : args) {\n+            if (s.startsWith(\"--server:\")) {\n+                return s;\n+            }\n+        }\n+        return null;\n+    }\n+\n+    public static <E> Set<E> union(Set<? extends E> s1,\n+                                   Set<? extends E> s2) {\n+        Set<E> union = new HashSet<>();\n+        union.addAll(s1);\n+        union.addAll(s2);\n+        return union;\n+    }\n+\n+    public static <E> Set<E> subtract(Set<? extends E> orig,\n+                                      Set<? extends E> toSubtract) {\n+        Set<E> difference = new HashSet<>(orig);\n+        difference.removeAll(toSubtract);\n+        return difference;\n+    }\n+\n+    public static String getStackTrace(Throwable t) {\n+        StringWriter sw = new StringWriter();\n+        t.printStackTrace(new PrintWriter(sw));\n+        return sw.toString();\n+    }\n+\n+    \/\/ TODO: Remove when refactoring from java.io.File to java.nio.file.Path.\n+    public static File pathToFile(Path path) {\n+        return path == null ? null : path.toFile();\n+    }\n+\n+    public static <E> Set<E> intersection(Collection<? extends E> c1,\n+                                          Collection<? extends E> c2) {\n+        Set<E> intersection = new HashSet<E>(c1);\n+        intersection.retainAll(c2);\n+        return intersection;\n+    }\n+\n+    public static <I, T> Map<I, T> indexBy(Collection<? extends T> c,\n+                                           Function<? super T, ? extends I> indexFunction) {\n+        return c.stream().collect(Collectors.<T, I, T>toMap(indexFunction, o -> o));\n+    }\n+\n+    public static String fileSuffix(Path file) {\n+        String fileNameStr = file.getFileName().toString();\n+        int dotIndex = fileNameStr.indexOf('.');\n+        return dotIndex == -1 ? \"\" : fileNameStr.substring(dotIndex);\n+    }\n+\n+    public static Stream<String> getLines(String str) {\n+        return str.isEmpty()\n+                ? Stream.empty()\n+                : Stream.of(str.split(Pattern.quote(System.lineSeparator())));\n+    }\n+}\n","filename":"src\/jdk.compiler\/share\/classes\/com\/sun\/tools\/sjavac\/Util.java","additions":255,"deletions":0,"binary":false,"changes":255,"status":"added"},{"patch":"@@ -0,0 +1,87 @@\n+\/*\n+ * Copyright (c) 2014, 2016, Oracle and\/or its affiliates. All rights reserved.\n+ * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+ *\n+ * This code is free software; you can redistribute it and\/or modify it\n+ * under the terms of the GNU General Public License version 2 only, as\n+ * published by the Free Software Foundation.  Oracle designates this\n+ * particular file as subject to the \"Classpath\" exception as provided\n+ * by Oracle in the LICENSE file that accompanied this code.\n+ *\n+ * This code is distributed in the hope that it will be useful, but WITHOUT\n+ * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+ * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+ * version 2 for more details (a copy is included in the LICENSE file that\n+ * accompanied this code).\n+ *\n+ * You should have received a copy of the GNU General Public License version\n+ * 2 along with this work; if not, write to the Free Software Foundation,\n+ * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n+ *\n+ * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n+ * or visit www.oracle.com if you need additional information or have any\n+ * questions.\n+ *\/\n+\n+package com.sun.tools.sjavac.client;\n+\n+import java.io.OutputStreamWriter;\n+import java.io.Writer;\n+\n+import com.sun.tools.javac.main.Main;\n+import com.sun.tools.javac.main.Main.Result;\n+import com.sun.tools.sjavac.AutoFlushWriter;\n+import com.sun.tools.sjavac.Log;\n+import com.sun.tools.sjavac.Util;\n+import com.sun.tools.sjavac.comp.SjavacImpl;\n+import com.sun.tools.sjavac.options.Options;\n+import com.sun.tools.sjavac.server.Sjavac;\n+\n+\/**\n+ *  <p><b>This is NOT part of any supported API.\n+ *  If you write code that depends on this, you do so at your own risk.\n+ *  This code and its internal interfaces are subject to change or\n+ *  deletion without notice.<\/b>\n+ *\/\n+public class ClientMain {\n+\n+    public static int run(String[] args) {\n+        return run(args,\n+                   new AutoFlushWriter(new OutputStreamWriter(System.out)),\n+                   new AutoFlushWriter(new OutputStreamWriter(System.err)));\n+    }\n+\n+    public static int run(String[] args, Writer out, Writer err) {\n+\n+        Log.setLogForCurrentThread(new Log(out, err));\n+\n+        Options options;\n+        try {\n+            options = Options.parseArgs(args);\n+        } catch (IllegalArgumentException e) {\n+            Log.error(e.getMessage());\n+            return Result.CMDERR.exitCode;\n+        }\n+\n+        Log.setLogLevel(options.getLogLevel());\n+\n+        Log.debug(\"==========================================================\");\n+        Log.debug(\"Launching sjavac client with the following parameters:\");\n+        Log.debug(\"    \" + options.getStateArgsString());\n+        Log.debug(\"==========================================================\");\n+\n+        \/\/ Prepare sjavac object\n+        boolean useServer = options.getServerConf() != null;\n+        Sjavac sjavac = useServer ? new SjavacClient(options) : new SjavacImpl();\n+\n+        \/\/ Perform compilation\n+        Result result = sjavac.compile(args);\n+\n+        \/\/ If sjavac is running in the foreground we should shut it down at this point\n+        if (!useServer) {\n+            sjavac.shutdown();\n+        }\n+\n+        return result.exitCode;\n+    }\n+}\n","filename":"src\/jdk.compiler\/share\/classes\/com\/sun\/tools\/sjavac\/client\/ClientMain.java","additions":87,"deletions":0,"binary":false,"changes":87,"status":"added"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2015, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2015, Oracle and\/or its affiliates. All rights reserved.\n@@ -26,1 +26,1 @@\n-package javacserver.client;\n+package com.sun.tools.sjavac.client;\n","filename":"src\/jdk.compiler\/share\/classes\/com\/sun\/tools\/sjavac\/client\/PortFileInaccessibleException.java","additions":2,"deletions":2,"binary":false,"changes":4,"previous_filename":"make\/langtools\/tools\/javacserver\/client\/PortFileInaccessibleException.java","status":"renamed"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2014, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2014, 2021, Oracle and\/or its affiliates. All rights reserved.\n@@ -26,1 +26,1 @@\n-package javacserver.client;\n+package com.sun.tools.sjavac.client;\n@@ -43,7 +43,8 @@\n-import javacserver.Log;\n-import javacserver.Result;\n-import javacserver.Util;\n-import javacserver.options.Options;\n-import javacserver.server.PortFile;\n-import javacserver.server.Sjavac;\n-import javacserver.server.SjavacServer;\n+import com.sun.tools.javac.main.Main;\n+import com.sun.tools.javac.main.Main.Result;\n+import com.sun.tools.sjavac.Log;\n+import com.sun.tools.sjavac.Util;\n+import com.sun.tools.sjavac.options.Options;\n+import com.sun.tools.sjavac.server.PortFile;\n+import com.sun.tools.sjavac.server.Sjavac;\n+import com.sun.tools.sjavac.server.SjavacServer;\n@@ -64,1 +65,1 @@\n-    \/\/ It should point to a javacserver.Main that supports --startserver\n+    \/\/ It should point to a com.sun.tools.sjavac.Main that supports --startserver\n@@ -146,1 +147,1 @@\n-                    result = Result.valueOf(content);\n+                    result = Main.Result.valueOf(content);\n","filename":"src\/jdk.compiler\/share\/classes\/com\/sun\/tools\/sjavac\/client\/SjavacClient.java","additions":12,"deletions":11,"binary":false,"changes":23,"previous_filename":"make\/langtools\/tools\/javacserver\/client\/SjavacClient.java","status":"renamed"},{"patch":"@@ -0,0 +1,171 @@\n+\/*\n+ * Copyright (c) 2015, 2016, Oracle and\/or its affiliates. All rights reserved.\n+ * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+ *\n+ * This code is free software; you can redistribute it and\/or modify it\n+ * under the terms of the GNU General Public License version 2 only, as\n+ * published by the Free Software Foundation.  Oracle designates this\n+ * particular file as subject to the \"Classpath\" exception as provided\n+ * by Oracle in the LICENSE file that accompanied this code.\n+ *\n+ * This code is distributed in the hope that it will be useful, but WITHOUT\n+ * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+ * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+ * version 2 for more details (a copy is included in the LICENSE file that\n+ * accompanied this code).\n+ *\n+ * You should have received a copy of the GNU General Public License version\n+ * 2 along with this work; if not, write to the Free Software Foundation,\n+ * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n+ *\n+ * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n+ * or visit www.oracle.com if you need additional information or have any\n+ * questions.\n+ *\/\n+\n+package com.sun.tools.sjavac.comp;\n+\n+import java.io.File;\n+import java.io.IOException;\n+import java.io.PrintWriter;\n+import java.io.StringWriter;\n+import java.net.URI;\n+import java.util.Arrays;\n+import java.util.Iterator;\n+import java.util.List;\n+import java.util.Set;\n+\n+import javax.tools.JavaFileObject;\n+import javax.tools.StandardJavaFileManager;\n+import javax.tools.StandardLocation;\n+import javax.tools.ToolProvider;\n+\n+import com.sun.tools.javac.api.JavacTaskImpl;\n+import com.sun.tools.javac.api.JavacTool;\n+import com.sun.tools.javac.main.Main;\n+import com.sun.tools.javac.main.Main.Result;\n+import com.sun.tools.javac.util.Context;\n+import com.sun.tools.javac.util.Dependencies;\n+import com.sun.tools.javac.util.ListBuffer;\n+import com.sun.tools.sjavac.Log;\n+import com.sun.tools.sjavac.Util;\n+import com.sun.tools.sjavac.comp.dependencies.NewDependencyCollector;\n+import com.sun.tools.sjavac.comp.dependencies.PublicApiCollector;\n+import com.sun.tools.sjavac.server.CompilationSubResult;\n+import com.sun.tools.sjavac.server.SysInfo;\n+\n+\/**\n+ *  <p><b>This is NOT part of any supported API.\n+ *  If you write code that depends on this, you do so at your own risk.\n+ *  This code and its internal interfaces are subject to change or\n+ *  deletion without notice.<\/b>\n+ *\/\n+public class CompilationService {\n+\n+    public SysInfo getSysInfo() {\n+        return new SysInfo(Runtime.getRuntime().availableProcessors(),\n+                           Runtime.getRuntime().maxMemory());\n+    }\n+\n+    public CompilationSubResult compile(String protocolId,\n+                                     String invocationId,\n+                                     String[] args,\n+                                     List<File> explicitSources,\n+                                     Set<URI> sourcesToCompile,\n+                                     Set<URI> visibleSources) {\n+\n+        JavacTool compiler = (JavacTool) ToolProvider.getSystemJavaCompiler();\n+        try (StandardJavaFileManager fm = compiler.getStandardFileManager(null, null, null)) {\n+            SmartFileManager sfm = new SmartFileManager(fm);\n+            Context context = new Context();\n+\n+            Dependencies.GraphDependencies.preRegister(context);\n+\n+            \/\/ Now setup the actual compilation\n+            CompilationSubResult compilationResult = new CompilationSubResult(Result.OK);\n+\n+            \/\/ First deal with explicit source files on cmdline and in at file\n+            ListBuffer<JavaFileObject> explicitJFOs = new ListBuffer<>();\n+            for (JavaFileObject jfo : fm.getJavaFileObjectsFromFiles(explicitSources)) {\n+                explicitJFOs.append(SmartFileManager.locWrap(jfo, StandardLocation.SOURCE_PATH));\n+            }\n+            \/\/ Now deal with sources supplied as source_to_compile\n+            ListBuffer<File> sourcesToCompileFiles = new ListBuffer<>();\n+            for (URI u : sourcesToCompile)\n+                sourcesToCompileFiles.append(new File(u));\n+\n+            for (JavaFileObject jfo : fm.getJavaFileObjectsFromFiles(sourcesToCompileFiles))\n+                explicitJFOs.append(SmartFileManager.locWrap(jfo, StandardLocation.SOURCE_PATH));\n+\n+            \/\/ Create a log to capture compiler output\n+            StringWriter stderrLog = new StringWriter();\n+            Result result;\n+            PublicApiCollector pubApiCollector = new PublicApiCollector(context, explicitJFOs);\n+            PathAndPackageVerifier papVerifier = new PathAndPackageVerifier();\n+            NewDependencyCollector depsCollector = new NewDependencyCollector(context, explicitJFOs);\n+            try {\n+                if (explicitJFOs.size() > 0) {\n+                    sfm.setVisibleSources(visibleSources);\n+                    sfm.cleanArtifacts();\n+\n+                    \/\/ Do the compilation!\n+                    JavacTaskImpl task =\n+                            (JavacTaskImpl) compiler.getTask(new PrintWriter(stderrLog),\n+                                                             sfm,\n+                                                             null,\n+                                                             Arrays.asList(args),\n+                                                             null,\n+                                                             explicitJFOs,\n+                                                             context);\n+                    sfm.setSymbolFileEnabled(!com.sun.tools.javac.util.Options.instance(context).isSet(\"ignore.symbol.file\"));\n+                    task.addTaskListener(depsCollector);\n+                    task.addTaskListener(pubApiCollector);\n+                    task.addTaskListener(papVerifier);\n+                    logJavacInvocation(args);\n+                    result = task.doCall();\n+                    Log.debug(\"javac result: \" + result);\n+                    sfm.flush();\n+                } else {\n+                    result = Result.ERROR;\n+                }\n+            } catch (Exception e) {\n+                Log.error(Util.getStackTrace(e));\n+                stderrLog.append(Util.getStackTrace(e));\n+                result = Result.ERROR;\n+            }\n+\n+            compilationResult.packageArtifacts = sfm.getPackageArtifacts();\n+\n+            if (papVerifier.errorsDiscovered()) {\n+                result = Result.ERROR;\n+            }\n+\n+            compilationResult.packageDependencies = depsCollector.getDependencies(false);\n+            compilationResult.packageCpDependencies = depsCollector.getDependencies(true);\n+\n+            compilationResult.packagePubapis = pubApiCollector.getPubApis(true);\n+            compilationResult.dependencyPubapis = pubApiCollector.getPubApis(false);\n+            compilationResult.stderr = stderrLog.toString();\n+            compilationResult.result = result;\n+\n+            return compilationResult;\n+        } catch (IOException e) {\n+            throw new Error(e);\n+        }\n+    }\n+\n+    private void logJavacInvocation(String[] args) {\n+        Log.debug(\"Invoking javac with args\");\n+        Iterator<String> argIter = Arrays.asList(args).iterator();\n+        while (argIter.hasNext()) {\n+            String arg = argIter.next();\n+            String line = \"    \" + arg;\n+            if (arg.matches(\"\\\\-(d|cp|classpath|sourcepath|source|target)\")\n+                    && argIter.hasNext()) {\n+                line += \" \" + argIter.next();\n+            }\n+            Log.debug(line);\n+        }\n+    }\n+\n+}\n","filename":"src\/jdk.compiler\/share\/classes\/com\/sun\/tools\/sjavac\/comp\/CompilationService.java","additions":171,"deletions":0,"binary":false,"changes":171,"status":"added"},{"patch":"@@ -0,0 +1,55 @@\n+\/*\n+ * Copyright (c) 2014, 2015, Oracle and\/or its affiliates. All rights reserved.\n+ * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+ *\n+ * This code is free software; you can redistribute it and\/or modify it\n+ * under the terms of the GNU General Public License version 2 only, as\n+ * published by the Free Software Foundation.  Oracle designates this\n+ * particular file as subject to the \"Classpath\" exception as provided\n+ * by Oracle in the LICENSE file that accompanied this code.\n+ *\n+ * This code is distributed in the hope that it will be useful, but WITHOUT\n+ * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+ * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+ * version 2 for more details (a copy is included in the LICENSE file that\n+ * accompanied this code).\n+ *\n+ * You should have received a copy of the GNU General Public License version\n+ * 2 along with this work; if not, write to the Free Software Foundation,\n+ * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n+ *\n+ * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n+ * or visit www.oracle.com if you need additional information or have any\n+ * questions.\n+ *\/\n+\n+package com.sun.tools.sjavac.comp;\n+\n+import javax.tools.FileObject;\n+import javax.tools.ForwardingFileObject;\n+import javax.tools.JavaFileManager.Location;\n+\n+import com.sun.tools.javac.api.ClientCodeWrapper.Trusted;\n+\n+@Trusted\n+public class FileObjectWithLocation<F extends FileObject> extends ForwardingFileObject<F> {\n+\n+    private final Location loc;\n+\n+    public FileObjectWithLocation(F delegate, Location loc) {\n+        super(delegate);\n+        this.loc = loc;\n+    }\n+\n+    public Location getLocation() {\n+        return loc;\n+    }\n+\n+    public FileObject getDelegate() {\n+        return fileObject;\n+    }\n+\n+    public String toString() {\n+        return \"FileObjectWithLocation[\" + fileObject + \"]\";\n+    }\n+}\n","filename":"src\/jdk.compiler\/share\/classes\/com\/sun\/tools\/sjavac\/comp\/FileObjectWithLocation.java","additions":55,"deletions":0,"binary":false,"changes":55,"status":"added"},{"patch":"@@ -0,0 +1,67 @@\n+\/*\n+ * Copyright (c) 2014, 2021, Oracle and\/or its affiliates. All rights reserved.\n+ * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+ *\n+ * This code is free software; you can redistribute it and\/or modify it\n+ * under the terms of the GNU General Public License version 2 only, as\n+ * published by the Free Software Foundation.  Oracle designates this\n+ * particular file as subject to the \"Classpath\" exception as provided\n+ * by Oracle in the LICENSE file that accompanied this code.\n+ *\n+ * This code is distributed in the hope that it will be useful, but WITHOUT\n+ * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+ * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+ * version 2 for more details (a copy is included in the LICENSE file that\n+ * accompanied this code).\n+ *\n+ * You should have received a copy of the GNU General Public License version\n+ * 2 along with this work; if not, write to the Free Software Foundation,\n+ * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n+ *\n+ * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n+ * or visit www.oracle.com if you need additional information or have any\n+ * questions.\n+ *\/\n+\n+package com.sun.tools.sjavac.comp;\n+\n+import javax.tools.ForwardingJavaFileObject;\n+import javax.tools.JavaFileManager.Location;\n+import javax.tools.JavaFileObject;\n+\n+import com.sun.tools.javac.api.ClientCodeWrapper.Trusted;\n+\n+@Trusted\n+public class JavaFileObjectWithLocation<F extends JavaFileObject> extends ForwardingJavaFileObject<F> {\n+\n+    private final Location loc;\n+\n+    public JavaFileObjectWithLocation(F delegate, Location loc) {\n+        super(delegate);\n+        this.loc = loc;\n+    }\n+\n+    public Location getLocation() {\n+        return loc;\n+    }\n+\n+    public F getDelegate() {\n+        return fileObject;\n+    }\n+\n+    public String toString() {\n+        return \"JavaFileObjectWithLocation[loc: \" + loc + \", \" + fileObject + \"]\";\n+    }\n+\n+    @Override\n+    public int hashCode() {\n+        return loc.hashCode() ^ fileObject.hashCode();\n+    }\n+\n+    @Override\n+    public boolean equals(Object obj) {\n+        return (obj instanceof JavaFileObjectWithLocation<?> javaFileObjectWithLocation)\n+                && loc.equals(javaFileObjectWithLocation.loc)\n+                && fileObject.equals(javaFileObjectWithLocation.fileObject);\n+    }\n+}\n","filename":"src\/jdk.compiler\/share\/classes\/com\/sun\/tools\/sjavac\/comp\/JavaFileObjectWithLocation.java","additions":67,"deletions":0,"binary":false,"changes":67,"status":"added"},{"patch":"@@ -0,0 +1,152 @@\n+\/*\n+ * Copyright (c) 2014, 2021, Oracle and\/or its affiliates. All rights reserved.\n+ * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+ *\n+ * This code is free software; you can redistribute it and\/or modify it\n+ * under the terms of the GNU General Public License version 2 only, as\n+ * published by the Free Software Foundation.  Oracle designates this\n+ * particular file as subject to the \"Classpath\" exception as provided\n+ * by Oracle in the LICENSE file that accompanied this code.\n+ *\n+ * This code is distributed in the hope that it will be useful, but WITHOUT\n+ * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+ * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+ * version 2 for more details (a copy is included in the LICENSE file that\n+ * accompanied this code).\n+ *\n+ * You should have received a copy of the GNU General Public License version\n+ * 2 along with this work; if not, write to the Free Software Foundation,\n+ * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n+ *\n+ * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n+ * or visit www.oracle.com if you need additional information or have any\n+ * questions.\n+ *\/\n+\n+package com.sun.tools.sjavac.comp;\n+\n+import java.nio.file.Path;\n+import java.nio.file.Paths;\n+import java.util.HashSet;\n+import java.util.Iterator;\n+import java.util.Set;\n+\n+import javax.tools.JavaFileObject;\n+\n+import com.sun.source.tree.CompilationUnitTree;\n+import com.sun.source.util.TaskEvent;\n+import com.sun.source.util.TaskListener;\n+import com.sun.tools.javac.tree.JCTree;\n+import com.sun.tools.javac.tree.JCTree.JCFieldAccess;\n+import com.sun.tools.javac.tree.JCTree.JCIdent;\n+import com.sun.tools.javac.util.DefinedBy;\n+import com.sun.tools.javac.util.DefinedBy.Api;\n+import com.sun.tools.javac.util.Name;\n+import com.sun.tools.sjavac.Log;\n+\n+public class PathAndPackageVerifier implements TaskListener {\n+\n+    \/\/ Stores the set of compilation units whose source file path does not\n+    \/\/ match the package declaration.\n+    Set<CompilationUnitTree> misplacedCompilationUnits = new HashSet<>();\n+\n+    @Override\n+    @DefinedBy(Api.COMPILER_TREE)\n+    public void finished(TaskEvent e) {\n+        if (e.getKind() == TaskEvent.Kind.ANALYZE) {\n+\n+            CompilationUnitTree cu = e.getCompilationUnit();\n+            if (cu == null)\n+                return;\n+\n+            JavaFileObject jfo = cu.getSourceFile();\n+            if (jfo == null)\n+                return; \/\/ No source file -> package doesn't matter\n+\n+            JCTree pkg = (JCTree) cu.getPackageName();\n+            if (pkg == null)\n+                return; \/\/ Default package. See JDK-8048144.\n+\n+            Path dir = Paths.get(jfo.toUri()).normalize().getParent();\n+            if (!checkPathAndPackage(dir, pkg))\n+                misplacedCompilationUnits.add(cu);\n+        }\n+\n+        if (e.getKind() == TaskEvent.Kind.COMPILATION) {\n+            for (CompilationUnitTree cu : misplacedCompilationUnits) {\n+                Log.error(\"Misplaced compilation unit.\");\n+                Log.error(\"    Directory: \" + Paths.get(cu.getSourceFile().toUri()).getParent());\n+                Log.error(\"    Package:   \" + cu.getPackageName());\n+            }\n+        }\n+    }\n+\n+    public boolean errorsDiscovered() {\n+        return misplacedCompilationUnits.size() > 0;\n+    }\n+\n+    \/* Returns true if dir matches pkgName.\n+     *\n+     * Examples:\n+     *     (a\/b\/c, a.b.c) gives true\n+     *     (i\/j\/k, i.x.k) gives false\n+     *\n+     * Currently (x\/a\/b\/c, a.b.c) also gives true. See JDK-8059598.\n+     *\/\n+    private boolean checkPathAndPackage(Path dir, JCTree pkgName) {\n+        Iterator<String> pathIter = new ParentIterator(dir);\n+        Iterator<String> pkgIter = new EnclosingPkgIterator(pkgName);\n+        while (pathIter.hasNext() && pkgIter.hasNext()) {\n+            if (!pathIter.next().equals(pkgIter.next()))\n+                return false;\n+        }\n+        return !pkgIter.hasNext(); \/*&& !pathIter.hasNext() See JDK-8059598 *\/\n+    }\n+\n+    \/* Iterates over the names of the parents of the given path:\n+     * Example: dir1\/dir2\/dir3  results in  dir3 -> dir2 -> dir1\n+     *\/\n+    private static class ParentIterator implements Iterator<String> {\n+        Path next;\n+        ParentIterator(Path initial) {\n+            next = initial;\n+        }\n+        @Override\n+        public boolean hasNext() {\n+            return next != null;\n+        }\n+        @Override\n+        public String next() {\n+            String tmp = next.getFileName().toString();\n+            next = next.getParent();\n+            return tmp;\n+        }\n+    }\n+\n+    \/* Iterates over the names of the enclosing packages:\n+     * Example: pkg1.pkg2.pkg3  results in  pkg3 -> pkg2 -> pkg1\n+     *\/\n+    private static class EnclosingPkgIterator implements Iterator<String> {\n+        JCTree next;\n+        EnclosingPkgIterator(JCTree initial) {\n+            next = initial;\n+        }\n+        @Override\n+        public boolean hasNext() {\n+            return next != null;\n+        }\n+        @Override\n+        public String next() {\n+            Name name;\n+            if (next instanceof JCIdent identNext) {\n+                name = identNext.name;\n+                next = null;\n+            } else {\n+                JCFieldAccess fa = (JCFieldAccess) next;\n+                name = fa.name;\n+                next = fa.selected;\n+            }\n+            return name.toString();\n+        }\n+    }\n+}\n","filename":"src\/jdk.compiler\/share\/classes\/com\/sun\/tools\/sjavac\/comp\/PathAndPackageVerifier.java","additions":152,"deletions":0,"binary":false,"changes":152,"status":"added"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2014, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2014, 2016, Oracle and\/or its affiliates. All rights reserved.\n@@ -26,1 +26,5 @@\n-package javacserver.comp;\n+package com.sun.tools.sjavac.comp;\n+\n+import com.sun.tools.javac.main.Main.Result;\n+import com.sun.tools.sjavac.Log;\n+import com.sun.tools.sjavac.server.Sjavac;\n@@ -33,4 +37,0 @@\n-import javacserver.Log;\n-import javacserver.Result;\n-import javacserver.server.Sjavac;\n-\n","filename":"src\/jdk.compiler\/share\/classes\/com\/sun\/tools\/sjavac\/comp\/PooledSjavac.java","additions":6,"deletions":6,"binary":false,"changes":12,"previous_filename":"make\/langtools\/tools\/javacserver\/comp\/PooledSjavac.java","status":"renamed"},{"patch":"@@ -0,0 +1,108 @@\n+\/*\n+ * Copyright (c) 1999, 2015, Oracle and\/or its affiliates. All rights reserved.\n+ * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+ *\n+ * This code is free software; you can redistribute it and\/or modify it\n+ * under the terms of the GNU General Public License version 2 only, as\n+ * published by the Free Software Foundation.  Oracle designates this\n+ * particular file as subject to the \"Classpath\" exception as provided\n+ * by Oracle in the LICENSE file that accompanied this code.\n+ *\n+ * This code is distributed in the hope that it will be useful, but WITHOUT\n+ * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+ * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+ * version 2 for more details (a copy is included in the LICENSE file that\n+ * accompanied this code).\n+ *\n+ * You should have received a copy of the GNU General Public License version\n+ * 2 along with this work; if not, write to the Free Software Foundation,\n+ * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n+ *\n+ * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n+ * or visit www.oracle.com if you need additional information or have any\n+ * questions.\n+ *\/\n+\n+package com.sun.tools.sjavac.comp;\n+\n+import java.util.Collection;\n+import java.util.HashMap;\n+import java.util.Map;\n+\n+import javax.lang.model.element.Element;\n+import javax.tools.JavaFileObject;\n+\n+import com.sun.tools.javac.code.Symbol.ClassSymbol;\n+import com.sun.tools.javac.util.Context;\n+import com.sun.tools.javac.util.Log;\n+import com.sun.tools.sjavac.pubapi.PubApi;\n+\n+\/**\n+ * Utility class containing public API information.\n+ *\n+ *  <p><b>This is NOT part of any supported API.\n+ *  If you write code that depends on this, you do so at your own risk.\n+ *  This code and its internal interfaces are subject to change or\n+ *  deletion without notice.<\/b>\n+ *\/\n+public class PubAPIs {\n+    protected static final Context.Key<PubAPIs> pubApisKey = new Context.Key<>();\n+\n+    \/\/ The log to be used for error reporting.\n+    protected Log log;\n+\n+    \/\/ Map from a class name to its public api.\n+    \/\/ Will the Name encode the module in the future?\n+    \/\/ If not, this will have to change to map from Module+Name to public api.\n+    protected Map<ClassSymbol, PubApi> publicApiPerClass = new HashMap<>();\n+\n+    public static PubAPIs instance(Context context) {\n+        PubAPIs instance = context.get(pubApisKey);\n+        if (instance == null)\n+            instance = new PubAPIs(context);\n+        return instance;\n+    }\n+\n+    private PubAPIs(Context context) {\n+        context.put(pubApisKey, this);\n+        log = Log.instance(context);\n+    }\n+\n+    \/**\n+     * Convert the map from class names to their pubapi to a map\n+     * from package names to their pubapi.\n+     *\/\n+    public Map<String, PubApi> getPubapis(Collection<JavaFileObject> explicitJFOs, boolean explicits) {\n+\n+        \/\/ Maps \":java.lang\" to a package level pub api (with only types on top level)\n+        Map<String, PubApi> result = new HashMap<>();\n+        for (ClassSymbol cs : publicApiPerClass.keySet()) {\n+\n+            boolean amongExplicits = explicitJFOs.contains(cs.sourcefile);\n+            if (explicits != amongExplicits)\n+                continue;\n+\n+            String pkg = \":\" + cs.packge().fullname;\n+            PubApi currentPubApi = result.getOrDefault(pkg, new PubApi());\n+            result.put(pkg, PubApi.mergeTypes(currentPubApi, publicApiPerClass.get(cs)));\n+        }\n+\n+        return result;\n+    }\n+\n+    \/**\n+     * Visit the api of a class and construct a pubapi and\n+     * store it into the pubapi_perclass map.\n+     *\/\n+    @SuppressWarnings(\"deprecation\")\n+    public void visitPubapi(Element e) {\n+\n+        \/\/ Skip anonymous classes for now\n+        if (e == null)\n+            return;\n+\n+        PubapiVisitor v = new PubapiVisitor();\n+        v.visit(e);\n+        publicApiPerClass.put((ClassSymbol) e, v.getCollectedPubApi());\n+    }\n+}\n","filename":"src\/jdk.compiler\/share\/classes\/com\/sun\/tools\/sjavac\/comp\/PubAPIs.java","additions":108,"deletions":0,"binary":false,"changes":108,"status":"added"},{"patch":"@@ -0,0 +1,172 @@\n+\/*\n+ * Copyright (c) 2011, 2019, Oracle and\/or its affiliates. All rights reserved.\n+ * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+ *\n+ * This code is free software; you can redistribute it and\/or modify it\n+ * under the terms of the GNU General Public License version 2 only, as\n+ * published by the Free Software Foundation.  Oracle designates this\n+ * particular file as subject to the \"Classpath\" exception as provided\n+ * by Oracle in the LICENSE file that accompanied this code.\n+ *\n+ * This code is distributed in the hope that it will be useful, but WITHOUT\n+ * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+ * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+ * version 2 for more details (a copy is included in the LICENSE file that\n+ * accompanied this code).\n+ *\n+ * You should have received a copy of the GNU General Public License version\n+ * 2 along with this work; if not, write to the Free Software Foundation,\n+ * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n+ *\n+ * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n+ * or visit www.oracle.com if you need additional information or have any\n+ * questions.\n+ *\/\n+\n+package com.sun.tools.sjavac.comp;\n+\n+import static javax.lang.model.element.Modifier.PRIVATE;\n+\n+import java.util.List;\n+import java.util.stream.Collectors;\n+\n+import javax.lang.model.element.*;\n+import javax.lang.model.type.TypeMirror;\n+import javax.lang.model.util.ElementScanner14;\n+\n+import com.sun.tools.javac.code.Symbol.ClassSymbol;\n+import com.sun.tools.javac.util.DefinedBy;\n+import com.sun.tools.javac.util.DefinedBy.Api;\n+import com.sun.tools.sjavac.pubapi.PubApi;\n+import com.sun.tools.sjavac.pubapi.PubApiTypeParam;\n+import com.sun.tools.sjavac.pubapi.PubMethod;\n+import com.sun.tools.sjavac.pubapi.PubType;\n+import com.sun.tools.sjavac.pubapi.PubVar;\n+import com.sun.tools.sjavac.pubapi.TypeDesc;\n+\n+\/** Utility class that constructs a textual representation\n+ * of the public api of a class.\n+ *\n+ *  <p><b>This is NOT part of any supported API.\n+ *  If you write code that depends on this, you do so at your own risk.\n+ *  This code and its internal interfaces are subject to change or\n+ *  deletion without notice.<\/b>\n+ *\/\n+public class PubapiVisitor extends ElementScanner14<Void, Void> {\n+\n+    private PubApi collectedApi = new PubApi();\n+\n+    private boolean isNonPrivate(Element e) {\n+        return !e.getModifiers().contains(PRIVATE);\n+    }\n+\n+    @Override @DefinedBy(Api.LANGUAGE_MODEL)\n+    public Void visitType(TypeElement e, Void p) {\n+        if (isNonPrivate(e)) {\n+            PubApi prevApi = collectedApi;\n+            collectedApi = new PubApi();\n+            super.visitType(e, p);\n+            if (!isAnonymous(e)) {\n+                String name = ((ClassSymbol) e).flatname.toString();\n+                PubType t = new PubType(e.getModifiers(),\n+                                        name,\n+                                        \/\/e.getQualifiedName().toString(),\n+                                        collectedApi);\n+                prevApi.types.put(t.fqName, t);\n+            }\n+            collectedApi = prevApi;\n+        }\n+        return null;\n+    }\n+\n+    private boolean isAnonymous(TypeElement e) {\n+        return e.getQualifiedName().length() == 0;\n+    }\n+\n+    private static String encodeChar(int c) {\n+        return String.format(\"\\\\u%04x\", c);\n+    }\n+\n+    @Override @DefinedBy(Api.LANGUAGE_MODEL)\n+    public Void visitVariable(VariableElement e, Void p) {\n+        if (isNonPrivate(e)) {\n+            Object constVal = e.getConstantValue();\n+            String constValStr = null;\n+            \/\/ TODO: This doesn't seem to be entirely accurate. What if I change\n+            \/\/ from, say, 0 to 0L? (And the field is public static final so that\n+            \/\/ it could get inlined.)\n+            if (constVal != null) {\n+                if (e.asType().toString().equals(\"char\")) {\n+                    \/\/ What type is 'value'? Is it already a char?\n+                    char c = constVal.toString().charAt(0);\n+                    constValStr = \"'\" + encodeChar(c) + \"'\";\n+                } else {\n+                    constValStr = constVal.toString()\n+                                          .chars()\n+                                          .mapToObj(PubapiVisitor::encodeChar)\n+                                          .collect(Collectors.joining(\"\", \"\\\"\", \"\\\"\"));\n+                }\n+            }\n+\n+            PubVar v = new PubVar(e.getModifiers(),\n+                                  TypeDesc.fromType(e.asType()),\n+                                  e.toString(),\n+                                  constValStr);\n+            collectedApi.variables.put(v.identifier, v);\n+        }\n+\n+        \/\/ Safe to not recurse here, because the only thing\n+        \/\/ to visit here is the constructor of a variable declaration.\n+        \/\/ If it happens to contain an anonymous inner class (which it might)\n+        \/\/ then this class is never visible outside of the package anyway, so\n+        \/\/ we are allowed to ignore it here.\n+        return null;\n+    }\n+\n+    @Override @DefinedBy(Api.LANGUAGE_MODEL)\n+    public Void visitRecordComponent(RecordComponentElement e, Void p) {\n+        PubVar v = new PubVar(e.getModifiers(),\n+                TypeDesc.fromType(e.asType()),\n+                e.toString(),\n+                null);\n+        collectedApi.recordComponents.put(v.identifier, v);\n+        return null;\n+    }\n+\n+    @Override @DefinedBy(Api.LANGUAGE_MODEL)\n+    public Void visitExecutable(ExecutableElement e, Void p) {\n+        if (isNonPrivate(e)) {\n+            PubMethod m = new PubMethod(e.getModifiers(),\n+                                        getTypeParameters(e.getTypeParameters()),\n+                                        TypeDesc.fromType(e.getReturnType()),\n+                                        e.getSimpleName().toString(),\n+                                        getTypeDescs(getParamTypes(e)),\n+                                        getTypeDescs(e.getThrownTypes()));\n+            collectedApi.methods.put(m.asSignatureString(), m);\n+        }\n+        return null;\n+    }\n+\n+    private List<PubApiTypeParam> getTypeParameters(List<? extends TypeParameterElement> elements) {\n+        return elements.stream()\n+                       .map(e -> new PubApiTypeParam(e.getSimpleName().toString(), getTypeDescs(e.getBounds())))\n+                       .toList();\n+    }\n+\n+    private List<TypeMirror> getParamTypes(ExecutableElement e) {\n+        return e.getParameters()\n+                .stream()\n+                .map(VariableElement::asType)\n+                .toList();\n+    }\n+\n+    private List<TypeDesc> getTypeDescs(List<? extends TypeMirror> list) {\n+        return list.stream()\n+                   .map(TypeDesc::fromType)\n+                   .toList();\n+    }\n+\n+    public PubApi getCollectedPubApi() {\n+        return collectedApi;\n+    }\n+}\n","filename":"src\/jdk.compiler\/share\/classes\/com\/sun\/tools\/sjavac\/comp\/PubapiVisitor.java","additions":172,"deletions":0,"binary":false,"changes":172,"status":"added"},{"patch":"@@ -0,0 +1,399 @@\n+\/*\n+ * Copyright (c) 2014, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+ *\n+ * This code is free software; you can redistribute it and\/or modify it\n+ * under the terms of the GNU General Public License version 2 only, as\n+ * published by the Free Software Foundation.  Oracle designates this\n+ * particular file as subject to the \"Classpath\" exception as provided\n+ * by Oracle in the LICENSE file that accompanied this code.\n+ *\n+ * This code is distributed in the hope that it will be useful, but WITHOUT\n+ * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+ * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+ * version 2 for more details (a copy is included in the LICENSE file that\n+ * accompanied this code).\n+ *\n+ * You should have received a copy of the GNU General Public License version\n+ * 2 along with this work; if not, write to the Free Software Foundation,\n+ * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n+ *\n+ * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n+ * or visit www.oracle.com if you need additional information or have any\n+ * questions.\n+ *\/\n+\n+package com.sun.tools.sjavac.comp;\n+\n+import java.io.IOException;\n+import java.io.PrintWriter;\n+import java.io.StringWriter;\n+import java.nio.file.Files;\n+import java.nio.file.Path;\n+import java.util.ArrayList;\n+import java.util.Collections;\n+import java.util.HashMap;\n+import java.util.HashSet;\n+import java.util.List;\n+import java.util.Map;\n+import java.util.Set;\n+import java.util.stream.Stream;\n+\n+import com.sun.tools.javac.file.JavacFileManager;\n+import com.sun.tools.javac.main.Main;\n+import com.sun.tools.javac.main.Main.Result;\n+import com.sun.tools.javac.util.Context;\n+import com.sun.tools.sjavac.JavacState;\n+import com.sun.tools.sjavac.Log;\n+import com.sun.tools.sjavac.Module;\n+import com.sun.tools.sjavac.ProblemException;\n+import com.sun.tools.sjavac.Source;\n+import com.sun.tools.sjavac.Transformer;\n+import com.sun.tools.sjavac.Util;\n+import com.sun.tools.sjavac.options.Option;\n+import com.sun.tools.sjavac.options.Options;\n+import com.sun.tools.sjavac.options.SourceLocation;\n+import com.sun.tools.sjavac.server.Sjavac;\n+import java.io.UncheckedIOException;\n+\n+import javax.tools.JavaFileManager;\n+\n+\/**\n+ * The sjavac implementation that interacts with javac and performs the actual\n+ * compilation.\n+ *\n+ *  <p><b>This is NOT part of any supported API.\n+ *  If you write code that depends on this, you do so at your own risk.\n+ *  This code and its internal interfaces are subject to change or\n+ *  deletion without notice.<\/b>\n+ *\/\n+public class SjavacImpl implements Sjavac {\n+\n+    @Override\n+    public Result compile(String[] args) {\n+        Options options;\n+        try {\n+            options = Options.parseArgs(args);\n+        } catch (IllegalArgumentException e) {\n+            Log.error(e.getMessage());\n+            return Result.CMDERR;\n+        }\n+\n+        if (!validateOptions(options))\n+            return Result.CMDERR;\n+\n+        if (srcDstOverlap(options.getSources(), options.getDestDir())) {\n+            return Result.CMDERR;\n+        }\n+\n+        if (!createIfMissing(options.getDestDir()))\n+            return Result.ERROR;\n+\n+        Path stateDir = options.getStateDir();\n+        if (stateDir != null && !createIfMissing(options.getStateDir()))\n+            return Result.ERROR;\n+\n+        Path gensrc = options.getGenSrcDir();\n+        if (gensrc != null && !createIfMissing(gensrc))\n+            return Result.ERROR;\n+\n+        Path hdrdir = options.getHeaderDir();\n+        if (hdrdir != null && !createIfMissing(hdrdir))\n+            return Result.ERROR;\n+\n+        if (stateDir == null) {\n+            \/\/ Prepare context. Direct logging to our byte array stream.\n+            Context context = new Context();\n+            StringWriter strWriter = new StringWriter();\n+            PrintWriter printWriter = new PrintWriter(strWriter);\n+            com.sun.tools.javac.util.Log.preRegister(context, printWriter);\n+            JavacFileManager.preRegister(context);\n+\n+            \/\/ Prepare arguments\n+            String[] passThroughArgs = Stream.of(args)\n+                                             .filter(arg -> !arg.startsWith(Option.SERVER.arg))\n+                                             .toArray(String[]::new);\n+            \/\/ Compile\n+            Result result = new Main(\"javac\", printWriter).compile(passThroughArgs, context);\n+\n+            \/\/ Process compiler output (which is always errors)\n+            printWriter.flush();\n+            Util.getLines(strWriter.toString()).forEach(Log::error);\n+\n+            \/\/ Clean up\n+            JavaFileManager fileManager = context.get(JavaFileManager.class);\n+            if (fileManager instanceof JavacFileManager javacFileManager) {\n+                try {\n+                    javacFileManager.close();\n+                } catch (IOException es) {\n+                    throw new UncheckedIOException(es);\n+                }\n+            }\n+            return result;\n+\n+        } else {\n+            \/\/ Load the prev build state database.\n+            JavacState javac_state = JavacState.load(options);\n+\n+            \/\/ Setup the suffix rules from the command line.\n+            Map<String, Transformer> suffixRules = new HashMap<>();\n+\n+            \/\/ Handling of .java-compilation\n+            suffixRules.putAll(javac_state.getJavaSuffixRule());\n+\n+            \/\/ Handling of -copy and -tr\n+            suffixRules.putAll(options.getTranslationRules());\n+\n+            \/\/ All found modules are put here.\n+            Map<String,Module> modules = new HashMap<>();\n+            \/\/ We start out in the legacy empty no-name module.\n+            \/\/ As soon as we stumble on a module-info.java file we change to that module.\n+            Module current_module = new Module(\"\", \"\");\n+            modules.put(\"\", current_module);\n+\n+            try {\n+                \/\/ Find all sources, use the suffix rules to know which files are sources.\n+                Map<String,Source> sources = new HashMap<>();\n+\n+                \/\/ Find the files, this will automatically populate the found modules\n+                \/\/ with found packages where the sources are found!\n+                findSourceFiles(options.getSources(),\n+                                suffixRules.keySet(),\n+                                sources,\n+                                modules,\n+                                current_module,\n+                                options.isDefaultPackagePermitted(),\n+                                false);\n+\n+                if (sources.isEmpty()) {\n+                    Log.error(\"Found nothing to compile!\");\n+                    return Result.ERROR;\n+                }\n+\n+\n+                \/\/ Create a map of all source files that are available for linking. Both -src and\n+                \/\/ -sourcepath point to such files. It is possible to specify multiple\n+                \/\/ -sourcepath options to enable different filtering rules. If the\n+                \/\/ filters are the same for multiple sourcepaths, they may be concatenated\n+                \/\/ using :(;). Before sending the list of sourcepaths to javac, they are\n+                \/\/ all concatenated. The list created here is used by the SmartFileWrapper to\n+                \/\/ make sure only the correct sources are actually available.\n+                \/\/ We might find more modules here as well.\n+                Map<String,Source> sources_to_link_to = new HashMap<>();\n+\n+                List<SourceLocation> sourceResolutionLocations = new ArrayList<>();\n+                sourceResolutionLocations.addAll(options.getSources());\n+                sourceResolutionLocations.addAll(options.getSourceSearchPaths());\n+                findSourceFiles(sourceResolutionLocations,\n+                                Collections.singleton(\".java\"),\n+                                sources_to_link_to,\n+                                modules,\n+                                current_module,\n+                                options.isDefaultPackagePermitted(),\n+                                true);\n+\n+                \/\/ Add the set of sources to the build database.\n+                javac_state.now().flattenPackagesSourcesAndArtifacts(modules);\n+                javac_state.now().checkInternalState(\"checking sources\", false, sources);\n+                javac_state.now().checkInternalState(\"checking linked sources\", true, sources_to_link_to);\n+                javac_state.setVisibleSources(sources_to_link_to);\n+\n+                int round = 0;\n+                printRound(round);\n+\n+                \/\/ If there is any change in the source files, taint packages\n+                \/\/ and mark the database in need of saving.\n+                javac_state.checkSourceStatus(false);\n+\n+                \/\/ Find all existing artifacts. Their timestamp will match the last modified timestamps stored\n+                \/\/ in javac_state, simply because loading of the JavacState will clean out all artifacts\n+                \/\/ that do not match the javac_state database.\n+                javac_state.findAllArtifacts();\n+\n+                \/\/ Remove unidentified artifacts from the bin, gensrc and header dirs.\n+                \/\/ (Unless we allow them to be there.)\n+                \/\/ I.e. artifacts that are not known according to the build database (javac_state).\n+                \/\/ For examples, files that have been manually copied into these dirs.\n+                \/\/ Artifacts with bad timestamps (ie the on disk timestamp does not match the timestamp\n+                \/\/ in javac_state) have already been removed when the javac_state was loaded.\n+                if (!options.areUnidentifiedArtifactsPermitted()) {\n+                    javac_state.removeUnidentifiedArtifacts();\n+                }\n+                \/\/ Go through all sources and taint all packages that miss artifacts.\n+                javac_state.taintPackagesThatMissArtifacts();\n+\n+                \/\/ Check recorded classpath public apis. Taint packages that depend on\n+                \/\/ classpath classes whose public apis have changed.\n+                javac_state.taintPackagesDependingOnChangedClasspathPackages();\n+\n+                \/\/ Now clean out all known artifacts belonging to tainted packages.\n+                javac_state.deleteClassArtifactsInTaintedPackages();\n+                \/\/ Copy files, for example property files, images files, xml files etc etc.\n+                javac_state.performCopying(Util.pathToFile(options.getDestDir()), suffixRules);\n+                \/\/ Translate files, for example compile properties or compile idls.\n+                javac_state.performTranslation(Util.pathToFile(gensrc), suffixRules);\n+                \/\/ Add any potentially generated java sources to the tobe compiled list.\n+                \/\/ (Generated sources must always have a package.)\n+                Map<String,Source> generated_sources = new HashMap<>();\n+\n+                Source.scanRoot(Util.pathToFile(options.getGenSrcDir()),\n+                                Util.set(\".java\"),\n+                                Collections.emptyList(),\n+                                Collections.emptyList(),\n+                                generated_sources,\n+                                modules,\n+                                current_module,\n+                                false,\n+                                true,\n+                                false);\n+                javac_state.now().flattenPackagesSourcesAndArtifacts(modules);\n+                \/\/ Recheck the source files and their timestamps again.\n+                javac_state.checkSourceStatus(true);\n+\n+                \/\/ Now do a safety check that the list of source files is identical\n+                \/\/ to the list Make believes we are compiling. If we do not get this\n+                \/\/ right, then incremental builds will fail with subtility.\n+                \/\/ If any difference is detected, then we will fail hard here.\n+                \/\/ This is an important safety net.\n+                javac_state.compareWithMakefileList(Util.pathToFile(options.getSourceReferenceList()));\n+\n+                \/\/ Do the compilations, repeatedly until no tainted packages exist.\n+                boolean again;\n+                \/\/ Collect the name of all compiled packages.\n+                Set<String> recently_compiled = new HashSet<>();\n+                boolean[] rc = new boolean[1];\n+\n+                CompilationService compilationService = new CompilationService();\n+                do {\n+                    if (round > 0)\n+                        printRound(round);\n+                    \/\/ Clean out artifacts in tainted packages.\n+                    javac_state.deleteClassArtifactsInTaintedPackages();\n+                    again = javac_state.performJavaCompilations(compilationService,\n+                                                                options,\n+                                                                recently_compiled,\n+                                                                rc);\n+                    if (!rc[0]) {\n+                        Log.debug(\"Compilation failed.\");\n+                        break;\n+                    }\n+                    if (!again) {\n+                        Log.debug(\"Nothing left to do.\");\n+                    }\n+                    round++;\n+                } while (again);\n+                Log.debug(\"No need to do another round.\");\n+\n+                \/\/ Only update the state if the compile went well.\n+                if (rc[0]) {\n+                    javac_state.save();\n+                    \/\/ Reflatten only the artifacts.\n+                    javac_state.now().flattenArtifacts(modules);\n+                    \/\/ Remove artifacts that were generated during the last compile, but not this one.\n+                    javac_state.removeSuperfluousArtifacts(recently_compiled);\n+                }\n+\n+                return rc[0] ? Result.OK : Result.ERROR;\n+            } catch (ProblemException e) {\n+                \/\/ For instance make file list mismatch.\n+                Log.error(e.getMessage());\n+                Log.debug(e);\n+                return Result.ERROR;\n+            } catch (Exception e) {\n+                Log.error(e);\n+                return Result.ERROR;\n+            }\n+        }\n+    }\n+\n+    @Override\n+    public void shutdown() {\n+        \/\/ Nothing to clean up\n+    }\n+\n+    private static boolean validateOptions(Options options) {\n+\n+        String err = null;\n+\n+        if (options.getDestDir() == null) {\n+            err = \"Please specify output directory.\";\n+        } else if (options.isJavaFilesAmongJavacArgs()) {\n+            err = \"Sjavac does not handle explicit compilation of single .java files.\";\n+        } else if (!options.getImplicitPolicy().equals(\"none\")) {\n+            err = \"The only allowed setting for sjavac is -implicit:none\";\n+        } else if (options.getSources().isEmpty() && options.getStateDir() != null) {\n+            err = \"You have to specify -src when using --state-dir.\";\n+        } else if (options.getTranslationRules().size() > 1\n+                && options.getGenSrcDir() == null) {\n+            err = \"You have translators but no gensrc dir (-s) specified!\";\n+        }\n+\n+        if (err != null)\n+            Log.error(err);\n+\n+        return err == null;\n+\n+    }\n+\n+    private static boolean srcDstOverlap(List<SourceLocation> locs, Path dest) {\n+        for (SourceLocation loc : locs) {\n+            if (isOverlapping(loc.getPath(), dest)) {\n+                Log.error(\"Source location \" + loc.getPath() + \" overlaps with destination \" + dest);\n+                return true;\n+            }\n+        }\n+        return false;\n+    }\n+\n+    private static boolean isOverlapping(Path p1, Path p2) {\n+        p1 = p1.toAbsolutePath().normalize();\n+        p2 = p2.toAbsolutePath().normalize();\n+        return p1.startsWith(p2) || p2.startsWith(p1);\n+    }\n+\n+    private static boolean createIfMissing(Path dir) {\n+\n+        if (Files.isDirectory(dir))\n+            return true;\n+\n+        if (Files.exists(dir)) {\n+            Log.error(dir + \" is not a directory.\");\n+            return false;\n+        }\n+\n+        try {\n+            Files.createDirectories(dir);\n+        } catch (IOException e) {\n+            Log.error(\"Could not create directory: \" + e.getMessage());\n+            return false;\n+        }\n+\n+        return true;\n+    }\n+\n+    \/** Find source files in the given source locations. *\/\n+    public static void findSourceFiles(List<SourceLocation> sourceLocations,\n+                                       Set<String> sourceTypes,\n+                                       Map<String,Source> foundFiles,\n+                                       Map<String, Module> foundModules,\n+                                       Module currentModule,\n+                                       boolean permitSourcesInDefaultPackage,\n+                                       boolean inLinksrc)\n+                                               throws IOException {\n+\n+        for (SourceLocation source : sourceLocations) {\n+            source.findSourceFiles(sourceTypes,\n+                                   foundFiles,\n+                                   foundModules,\n+                                   currentModule,\n+                                   permitSourcesInDefaultPackage,\n+                                   inLinksrc);\n+        }\n+    }\n+\n+    private static void printRound(int round) {\n+        Log.debug(\"****************************************\");\n+        Log.debug(\"* Round \" + round + \"                              *\");\n+        Log.debug(\"****************************************\");\n+    }\n+}\n","filename":"src\/jdk.compiler\/share\/classes\/com\/sun\/tools\/sjavac\/comp\/SjavacImpl.java","additions":399,"deletions":0,"binary":false,"changes":399,"status":"added"},{"patch":"@@ -0,0 +1,275 @@\n+\/*\n+ * Copyright (c) 2012, 2021, Oracle and\/or its affiliates. All rights reserved.\n+ * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+ *\n+ * This code is free software; you can redistribute it and\/or modify it\n+ * under the terms of the GNU General Public License version 2 only, as\n+ * published by the Free Software Foundation.  Oracle designates this\n+ * particular file as subject to the \"Classpath\" exception as provided\n+ * by Oracle in the LICENSE file that accompanied this code.\n+ *\n+ * This code is distributed in the hope that it will be useful, but WITHOUT\n+ * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+ * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+ * version 2 for more details (a copy is included in the LICENSE file that\n+ * accompanied this code).\n+ *\n+ * You should have received a copy of the GNU General Public License version\n+ * 2 along with this work; if not, write to the Free Software Foundation,\n+ * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n+ *\n+ * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n+ * or visit www.oracle.com if you need additional information or have any\n+ * questions.\n+ *\/\n+\n+package com.sun.tools.sjavac.comp;\n+\n+import java.io.IOException;\n+import java.io.PrintWriter;\n+import java.net.URI;\n+import java.nio.file.Path;\n+import java.nio.file.Paths;\n+import java.util.HashMap;\n+import java.util.HashSet;\n+import java.util.Map;\n+import java.util.Set;\n+\n+import javax.tools.*;\n+import javax.tools.JavaFileObject.Kind;\n+\n+import com.sun.tools.javac.file.JavacFileManager;\n+import com.sun.tools.javac.util.DefinedBy;\n+import com.sun.tools.javac.util.DefinedBy.Api;\n+import com.sun.tools.javac.util.ListBuffer;\n+\n+\/**\n+ * Intercepts reads and writes to the file system to gather\n+ * information about what artifacts are generated.\n+ *\n+ * Traps writes to certain files, if the content written is identical\n+ * to the existing file.\n+ *\n+ * Can also blind out the file manager from seeing certain files in the file system.\n+ * Necessary to prevent javac from seeing some sources where the source path points.\n+ *\n+ *  <p><b>This is NOT part of any supported API.\n+ *  If you write code that depends on this, you do so at your own risk.\n+ *  This code and its internal interfaces are subject to change or\n+ *  deletion without notice.<\/b>\n+ *\/\n+@com.sun.tools.javac.api.ClientCodeWrapper.Trusted\n+public class SmartFileManager extends ForwardingJavaFileManager<JavaFileManager> {\n+\n+    \/\/ Set of sources that can be seen by javac.\n+    Set<URI> visibleSources = new HashSet<>();\n+    \/\/ Map from modulename:packagename to artifacts.\n+    Map<String,Set<URI>> packageArtifacts = new HashMap<>();\n+\n+    public SmartFileManager(JavaFileManager fileManager) {\n+        super(fileManager);\n+    }\n+\n+    public void setVisibleSources(Set<URI> s) {\n+        visibleSources = s;\n+    }\n+\n+    public void cleanArtifacts() {\n+        packageArtifacts = new HashMap<>();\n+    }\n+\n+    \/**\n+     * Set whether or not to use ct.sym as an alternate to rt.jar.\n+     *\/\n+    public void setSymbolFileEnabled(boolean b) {\n+        if (!(fileManager instanceof JavacFileManager javacFileManager))\n+            throw new IllegalStateException();\n+        javacFileManager.setSymbolFileEnabled(b);\n+    }\n+\n+    @DefinedBy(Api.COMPILER)\n+    public String inferBinaryName(Location location, JavaFileObject file) {\n+        return super.inferBinaryName(location, locUnwrap(file));\n+    }\n+\n+\n+    public Map<String,Set<URI>> getPackageArtifacts() {\n+        return packageArtifacts;\n+    }\n+\n+    @Override @DefinedBy(Api.COMPILER)\n+    public Iterable<JavaFileObject> list(Location location,\n+                                         String packageName,\n+                                         Set<Kind> kinds,\n+                                         boolean recurse) throws IOException {\n+        \/\/ TODO: Do this lazily by returning an iterable with a filtering Iterator\n+        \/\/ Acquire the list of files.\n+        Iterable<JavaFileObject> files = super.list(location, packageName, kinds, recurse);\n+        if (visibleSources.isEmpty()) {\n+            return locWrapMany(files, location);\n+        }\n+        \/\/ Now filter!\n+        ListBuffer<JavaFileObject> filteredFiles = new ListBuffer<>();\n+        for (JavaFileObject f : files) {\n+            URI uri = f.toUri();\n+            String t = uri.toString();\n+            if (t.startsWith(\"jar:\")\n+                || t.endsWith(\".class\")\n+                || visibleSources.contains(uri)) {\n+                filteredFiles.add(f);\n+            }\n+        }\n+\n+        return locWrapMany(filteredFiles, location);\n+    }\n+\n+    @Override @DefinedBy(Api.COMPILER)\n+    public JavaFileObject getJavaFileForInput(Location location,\n+                                              String className,\n+                                              Kind kind) throws IOException {\n+        JavaFileObject file = super.getJavaFileForInput(location, className, kind);\n+        file = locWrap(file, location);\n+        if (file == null || visibleSources.isEmpty()) {\n+            return file;\n+        }\n+\n+        if (visibleSources.contains(file.toUri()) || isModuleInfo(file)) {\n+            return file;\n+        }\n+        return null;\n+    }\n+\n+    @Override @DefinedBy(Api.COMPILER)\n+    public JavaFileObject getJavaFileForOutput(Location location,\n+                                               String className,\n+                                               Kind kind,\n+                                               FileObject sibling) throws IOException {\n+        JavaFileObject file = super.getJavaFileForOutput(location, className, kind, sibling);\n+        file = locWrap(file, location);\n+        if (file == null) return file;\n+        int dp = className.lastIndexOf('.');\n+        String pkg_name = \"\";\n+        if (dp != -1) {\n+            pkg_name = className.substring(0, dp);\n+        }\n+        \/\/ When modules are in use, then the mod_name might be something like \"jdk_base\"\n+        String mod_name = \"\";\n+        addArtifact(mod_name+\":\"+pkg_name, file.toUri());\n+        return file;\n+    }\n+\n+    @Override @DefinedBy(Api.COMPILER)\n+    public FileObject getFileForInput(Location location,\n+                                      String packageName,\n+                                      String relativeName) throws IOException {\n+        FileObject file =  super.getFileForInput(location, packageName, relativeName);\n+        file = locWrap(file, location);\n+        if (file == null || visibleSources.isEmpty()) {\n+            return file;\n+        }\n+\n+        if (visibleSources.contains(file.toUri()) || isModuleInfo(file)) {\n+            return file;\n+        }\n+        return null;\n+    }\n+\n+    private boolean isModuleInfo(FileObject fo) {\n+        return (fo instanceof JavaFileObject javaFileObject)\n+                && (javaFileObject.isNameCompatible(\"module-info\", Kind.SOURCE)\n+                    || javaFileObject.isNameCompatible(\"module-info\", Kind.CLASS));\n+    }\n+\n+    @Override @DefinedBy(Api.COMPILER)\n+    public FileObject getFileForOutput(Location location,\n+                                       String packageName,\n+                                       String relativeName,\n+                                       FileObject sibling) throws IOException {\n+        FileObject superFile = super.getFileForOutput(location, packageName, relativeName, sibling);\n+        FileObject file = locWrap(superFile, location);\n+        if (file == null) return file;\n+\n+        if (location.equals(StandardLocation.NATIVE_HEADER_OUTPUT) && superFile instanceof JavaFileObject) {\n+           file = new SmartFileObject((JavaFileObject) file);\n+           packageName = \":\" + packageNameFromFileName(relativeName);\n+        }\n+        if (packageName.equals(\"\")) {\n+            packageName = \":\";\n+        }\n+        addArtifact(packageName, file.toUri());\n+        return file;\n+    }\n+\n+    @Override @DefinedBy(Api.COMPILER)\n+    public Location getLocationForModule(Location location, JavaFileObject fo) throws IOException {\n+        return super.getLocationForModule(location, locUnwrap(fo));\n+    }\n+\n+    private static String packageNameFromFileName(String fn) {\n+        StringBuilder sb = new StringBuilder();\n+        int p = fn.indexOf('_'), pp = 0;\n+        while (p != -1) {\n+            if (sb.length() > 0) sb.append('.');\n+            sb.append(fn.substring(pp,p));\n+            if (p == fn.length()-1) break;\n+            pp = p+1;\n+            p = fn.indexOf('_',pp);\n+        }\n+        return sb.toString();\n+    }\n+\n+    void addArtifact(String pkgName, URI art) {\n+        Set<URI> s = packageArtifacts.get(pkgName);\n+        if (s == null) {\n+            s = new HashSet<>();\n+            packageArtifacts.put(pkgName, s);\n+        }\n+        s.add(art);\n+    }\n+\n+    public static JavaFileObject locWrap(JavaFileObject jfo, Location loc) {\n+\n+        \/\/ From sjavac's perspective platform classes are not interesting and\n+        \/\/ there is no need to track the location for these file objects.\n+        \/\/ Also, there exists some jfo instanceof checks which breaks if\n+        \/\/ the jfos for platform classes are wrapped.\n+        if (loc == StandardLocation.PLATFORM_CLASS_PATH)\n+            return jfo;\n+\n+        return jfo == null ? null : new JavaFileObjectWithLocation<>(jfo, loc);\n+    }\n+\n+    private static FileObject locWrap(FileObject fo, Location loc) {\n+        if (fo instanceof JavaFileObject javaFileObject)\n+            return locWrap(javaFileObject, loc);\n+        return fo == null ? null : new FileObjectWithLocation<>(fo, loc);\n+    }\n+\n+    @DefinedBy(Api.COMPILER)\n+    @Override\n+    public boolean isSameFile(FileObject a, FileObject b) {\n+        return super.isSameFile(locUnwrap(a), locUnwrap(b));\n+    }\n+\n+    private static ListBuffer<JavaFileObject> locWrapMany(Iterable<JavaFileObject> jfos,\n+                                                          Location loc) {\n+        ListBuffer<JavaFileObject> locWrapped = new ListBuffer<>();\n+        for (JavaFileObject f : jfos)\n+            locWrapped.add(locWrap(f, loc));\n+        return locWrapped;\n+    }\n+\n+    private static FileObject locUnwrap(FileObject fo) {\n+        if (fo instanceof FileObjectWithLocation<?> fileObjectWithLocation)\n+            return fileObjectWithLocation.getDelegate();\n+        if (fo instanceof JavaFileObjectWithLocation<?> javaFileObjectWithLocation)\n+            return javaFileObjectWithLocation.getDelegate();\n+        return fo;\n+    }\n+\n+    private static JavaFileObject locUnwrap(JavaFileObject fo) {\n+        if (fo instanceof JavaFileObjectWithLocation<?> javaFileObjectWithLocation)\n+            return javaFileObjectWithLocation.getDelegate();\n+        return fo;\n+    }\n+}\n","filename":"src\/jdk.compiler\/share\/classes\/com\/sun\/tools\/sjavac\/comp\/SmartFileManager.java","additions":275,"deletions":0,"binary":false,"changes":275,"status":"added"},{"patch":"@@ -0,0 +1,142 @@\n+\/*\n+ * Copyright (c) 2012, 2016, Oracle and\/or its affiliates. All rights reserved.\n+ * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+ *\n+ * This code is free software; you can redistribute it and\/or modify it\n+ * under the terms of the GNU General Public License version 2 only, as\n+ * published by the Free Software Foundation.  Oracle designates this\n+ * particular file as subject to the \"Classpath\" exception as provided\n+ * by Oracle in the LICENSE file that accompanied this code.\n+ *\n+ * This code is distributed in the hope that it will be useful, but WITHOUT\n+ * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+ * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+ * version 2 for more details (a copy is included in the LICENSE file that\n+ * accompanied this code).\n+ *\n+ * You should have received a copy of the GNU General Public License version\n+ * 2 along with this work; if not, write to the Free Software Foundation,\n+ * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n+ *\n+ * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n+ * or visit www.oracle.com if you need additional information or have any\n+ * questions.\n+ *\/\n+\n+package com.sun.tools.sjavac.comp;\n+\n+import java.io.*;\n+import java.net.URI;\n+import java.nio.file.NoSuchFileException;\n+\n+import javax.lang.model.element.Modifier;\n+import javax.lang.model.element.NestingKind;\n+import javax.tools.JavaFileObject;\n+\n+import com.sun.tools.javac.util.DefinedBy;\n+import com.sun.tools.javac.util.DefinedBy.Api;\n+\n+\/**\n+ * The SmartFileObject will return an outputstream that cache the written data\n+ * and compare the new content with the old content on disk. Only if they differ,\n+ * will the file be updated.\n+ *\n+ *  <p><b>This is NOT part of any supported API.\n+ *  If you write code that depends on this, you do so at your own risk.\n+ *  This code and its internal interfaces are subject to change or\n+ *  deletion without notice.<\/b>\n+ *\/\n+public class SmartFileObject implements JavaFileObject {\n+\n+    JavaFileObject file;\n+\n+    public SmartFileObject(JavaFileObject r) {\n+        file = r;\n+    }\n+\n+    @Override\n+    public boolean equals(Object other) {\n+        return file.equals(other);\n+    }\n+\n+    @Override\n+    public int hashCode() {\n+        return file.hashCode();\n+    }\n+\n+    @DefinedBy(Api.COMPILER)\n+    public Kind getKind() {\n+        return file.getKind();\n+    }\n+\n+    @DefinedBy(Api.COMPILER)\n+    public boolean isNameCompatible(String simpleName, Kind kind) {\n+        return file.isNameCompatible(simpleName, kind);\n+    }\n+\n+    @DefinedBy(Api.COMPILER)\n+    public URI toUri() {\n+        return file.toUri();\n+    }\n+\n+    @DefinedBy(Api.COMPILER)\n+    public String getName() {\n+        return file.getName();\n+    }\n+\n+    @DefinedBy(Api.COMPILER)\n+    public InputStream openInputStream() throws IOException {\n+        return file.openInputStream();\n+    }\n+\n+    @DefinedBy(Api.COMPILER)\n+    public OutputStream openOutputStream() throws IOException {\n+        return file.openOutputStream();\n+    }\n+\n+    @DefinedBy(Api.COMPILER)\n+    public CharSequence getCharContent(boolean ignoreEncodingErrors) throws IOException {\n+        return file.getCharContent(ignoreEncodingErrors);\n+    }\n+\n+    static String lineseparator = System.getProperty(\"line.separator\");\n+\n+    @DefinedBy(Api.COMPILER)\n+    public Writer openWriter() throws IOException {\n+        StringBuilder s = new StringBuilder();\n+        try (BufferedReader r = new BufferedReader(file.openReader(true))) {\n+            while (r.ready()) {\n+                s.append(r.readLine()+lineseparator);\n+            }\n+        } catch (FileNotFoundException | NoSuchFileException e) {\n+            \/\/ Perfectly ok.\n+        }\n+        return new SmartWriter(file, s.toString(), file.getName());\n+    }\n+\n+    @DefinedBy(Api.COMPILER)\n+    public long getLastModified() {\n+        return file.getLastModified();\n+    }\n+\n+    @DefinedBy(Api.COMPILER)\n+    public boolean delete() {\n+        return file.delete();\n+    }\n+\n+    @DefinedBy(Api.COMPILER)\n+    public Modifier getAccessLevel() {\n+        return file.getAccessLevel();\n+    }\n+\n+    @DefinedBy(Api.COMPILER)\n+    public NestingKind getNestingKind() {\n+        return file.getNestingKind();\n+    }\n+\n+    @DefinedBy(Api.COMPILER)\n+    public Reader openReader(boolean ignoreEncodingErrors) throws IOException {\n+        return file.openReader(ignoreEncodingErrors);\n+    }\n+\n+}\n","filename":"src\/jdk.compiler\/share\/classes\/com\/sun\/tools\/sjavac\/comp\/SmartFileObject.java","additions":142,"deletions":0,"binary":false,"changes":142,"status":"added"},{"patch":"@@ -0,0 +1,79 @@\n+\/*\n+ * Copyright (c) 2012, 2016, Oracle and\/or its affiliates. All rights reserved.\n+ * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+ *\n+ * This code is free software; you can redistribute it and\/or modify it\n+ * under the terms of the GNU General Public License version 2 only, as\n+ * published by the Free Software Foundation.  Oracle designates this\n+ * particular file as subject to the \"Classpath\" exception as provided\n+ * by Oracle in the LICENSE file that accompanied this code.\n+ *\n+ * This code is distributed in the hope that it will be useful, but WITHOUT\n+ * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+ * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+ * version 2 for more details (a copy is included in the LICENSE file that\n+ * accompanied this code).\n+ *\n+ * You should have received a copy of the GNU General Public License version\n+ * 2 along with this work; if not, write to the Free Software Foundation,\n+ * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n+ *\n+ * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n+ * or visit www.oracle.com if you need additional information or have any\n+ * questions.\n+ *\/\n+\n+package com.sun.tools.sjavac.comp;\n+\n+import com.sun.tools.sjavac.Log;\n+\n+import java.io.*;\n+import javax.tools.JavaFileObject;\n+\n+\/**\n+ * The SmartWriter will cache the written data and when the writer is closed,\n+ * then it will compare the cached data with the old_content string.\n+ * If different, then it will write all the new content to the file.\n+ * If not, the file is not touched.\n+ *\n+ *  <p><b>This is NOT part of any supported API.\n+ *  If you write code that depends on this, you do so at your own risk.\n+ *  This code and its internal interfaces are subject to change or\n+ *  deletion without notice.<\/b>\n+ *\/\n+public class SmartWriter extends Writer {\n+\n+    String name;\n+    JavaFileObject file;\n+    String oldContent;\n+    StringWriter newContent = new StringWriter();\n+    boolean closed;\n+\n+    public SmartWriter(JavaFileObject f, String s, String n) {\n+        name = n;\n+        file = f;\n+        oldContent = s;\n+        newContent = new StringWriter();\n+        closed = false;\n+    }\n+\n+    public void write(char[] chars, int i, int i1) {\n+        newContent.write(chars, i, i1);\n+    }\n+\n+    public void close() throws IOException {\n+        if (closed) return;\n+        closed = true;\n+        String s = newContent.toString();\n+        if (!oldContent.equals(s)) {\n+            int p = file.getName().lastIndexOf(File.separatorChar);\n+            try (Writer writer = file.openWriter()) {\n+                writer.write(s);\n+            }\n+            Log.debug(\"Writing \" + file.getName().substring(p + 1));\n+        }\n+    }\n+\n+    public void flush() throws IOException {\n+    }\n+}\n","filename":"src\/jdk.compiler\/share\/classes\/com\/sun\/tools\/sjavac\/comp\/SmartWriter.java","additions":79,"deletions":0,"binary":false,"changes":79,"status":"added"},{"patch":"@@ -0,0 +1,197 @@\n+\/*\n+ * Copyright (c) 2015, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+ *\n+ * This code is free software; you can redistribute it and\/or modify it\n+ * under the terms of the GNU General Public License version 2 only, as\n+ * published by the Free Software Foundation.  Oracle designates this\n+ * particular file as subject to the \"Classpath\" exception as provided\n+ * by Oracle in the LICENSE file that accompanied this code.\n+ *\n+ * This code is distributed in the hope that it will be useful, but WITHOUT\n+ * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+ * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+ * version 2 for more details (a copy is included in the LICENSE file that\n+ * accompanied this code).\n+ *\n+ * You should have received a copy of the GNU General Public License version\n+ * 2 along with this work; if not, write to the Free Software Foundation,\n+ * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n+ *\n+ * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n+ * or visit www.oracle.com if you need additional information or have any\n+ * questions.\n+ *\/\n+\n+package com.sun.tools.sjavac.comp.dependencies;\n+\n+import java.util.Collection;\n+import java.util.Collections;\n+import java.util.HashMap;\n+import java.util.HashSet;\n+import java.util.Map;\n+import java.util.Set;\n+import java.util.stream.Collectors;\n+import java.util.stream.Stream;\n+\n+import javax.tools.JavaFileManager.Location;\n+import javax.tools.JavaFileObject;\n+import javax.tools.StandardLocation;\n+\n+import com.sun.source.util.TaskEvent;\n+import com.sun.source.util.TaskListener;\n+import com.sun.tools.javac.code.Kinds.Kind;\n+import com.sun.tools.javac.code.Symbol;\n+import com.sun.tools.javac.code.Symbol.ClassSymbol;\n+import com.sun.tools.javac.code.Symbol.TypeSymbol;\n+import com.sun.tools.javac.code.Type;\n+import com.sun.tools.javac.util.Context;\n+import com.sun.tools.javac.util.DefinedBy;\n+import com.sun.tools.javac.util.DefinedBy.Api;\n+import com.sun.tools.javac.util.Dependencies.GraphDependencies;\n+import com.sun.tools.javac.util.Dependencies.GraphDependencies.CompletionNode;\n+import com.sun.tools.javac.util.GraphUtils.Node;\n+import com.sun.tools.sjavac.Util;\n+import com.sun.tools.sjavac.comp.JavaFileObjectWithLocation;\n+import com.sun.tools.sjavac.comp.PubAPIs;\n+\n+\n+public class NewDependencyCollector implements TaskListener {\n+\n+    private final Context context;\n+    private final Collection<JavaFileObject> explicitJFOs;\n+\n+    private Map<String, Map<String, Set<String>>> deps;\n+    private Map<String, Map<String, Set<String>>> cpDeps;\n+\n+    public NewDependencyCollector(Context context,\n+                                  Collection<JavaFileObject> explicitJFOs) {\n+        this.context = context;\n+        this.explicitJFOs = explicitJFOs;\n+    }\n+\n+    @Override\n+    @DefinedBy(Api.COMPILER_TREE)\n+    public void finished(TaskEvent e) {\n+        if (e.getKind() == TaskEvent.Kind.COMPILATION) {\n+            collectPubApisOfDependencies(context, explicitJFOs);\n+            deps = getDependencies(context, explicitJFOs, false);\n+            cpDeps = getDependencies(context, explicitJFOs, true);\n+        }\n+    }\n+\n+    public Map<String, Map<String, Set<String>>> getDependencies(boolean cp) {\n+        return cp ? cpDeps : deps;\n+    }\n+\n+    private Set<CompletionNode> getDependencyNodes(Context context,\n+                                                   Collection<JavaFileObject> explicitJFOs,\n+                                                   boolean explicits) {\n+        GraphDependencies deps = (GraphDependencies) GraphDependencies.instance(context);\n+\n+        return deps.getNodes()\n+                   .stream()\n+                   .map(n -> (CompletionNode) n)\n+                   .filter(n -> n.getClassSymbol().fullname != null)\n+                   .filter(n -> explicits == explicitJFOs.contains(n.getClassSymbol().classfile))\n+                   .collect(Collectors.toSet());\n+    }\n+\n+    private void collectPubApisOfDependencies(Context context,\n+                                              Collection<JavaFileObject> explicitJFOs) {\n+        PubAPIs pubApis = PubAPIs.instance(context);\n+        for (CompletionNode cDepNode : getDependencyNodes(context, explicitJFOs, false)) {\n+            ClassSymbol cs = cDepNode.getClassSymbol().outermostClass();\n+            Location loc = getLocationOf(cs);\n+            \/\/ We're completely ignorant of PLATFORM_CLASS_PATH classes\n+            if (loc == StandardLocation.CLASS_PATH || loc == StandardLocation.SOURCE_PATH)\n+                pubApis.visitPubapi(cs);\n+        }\n+    }\n+\n+    private Location getLocationOf(ClassSymbol cs) {\n+        JavaFileObject jfo = cs.outermostClass().classfile;\n+        if (jfo instanceof JavaFileObjectWithLocation<?> javaFileObjectWithLocation) {\n+            return javaFileObjectWithLocation.getLocation();\n+        }\n+\n+        \/\/ jfo is most likely on PLATFORM_CLASS_PATH.\n+        \/\/ See notes in SmartFileManager::locWrap\n+\n+        return null;\n+    }\n+\n+    \/\/ :Package -> fully qualified class name [from] -> set of fully qualified class names [to]\n+    private Map<String, Map<String, Set<String>>> getDependencies(Context context,\n+                                                                  Collection<JavaFileObject> explicitJFOs,\n+                                                                  boolean cp) {\n+        Map<String, Map<String, Set<String>>> result = new HashMap<>();\n+\n+        for (CompletionNode cnode : getDependencyNodes(context, explicitJFOs, true)) {\n+\n+            String fqDep = cnode.getClassSymbol().outermostClass().flatname.toString();\n+            String depPkg = Util.pkgNameOfClassName(fqDep);\n+\n+            Map<String, Set<String>> depsForThisClass = result.get(depPkg);\n+            if (depsForThisClass == null) {\n+                result.put(depPkg, depsForThisClass = new HashMap<>());\n+            }\n+\n+            Set<String> fqDeps = depsForThisClass.get(fqDep);\n+            if (fqDeps == null) {\n+                depsForThisClass.put(fqDep, fqDeps = new HashSet<>());\n+            }\n+\n+            for (Node<?,?> depNode : getAllDependencies(cnode)) {\n+                CompletionNode cDepNode = (CompletionNode) depNode;\n+                \/\/ Symbol is not regarded to depend on itself.\n+                if (cDepNode == cnode) {\n+                    continue;\n+                }\n+                \/\/ Skip anonymous classes\n+                if (cDepNode.getClassSymbol().fullname == null) {\n+                    continue;\n+                }\n+                if (isSymbolRelevant(cp, cDepNode.getClassSymbol())) {\n+                    fqDeps.add(cDepNode.getClassSymbol().outermostClass().flatname.toString());\n+                }\n+            }\n+\n+            \/\/ The completion dependency graph is not transitively closed for inheritance relations.\n+            \/\/ For sjavac's purposes however, a class depends on its super-supertype, so below we\n+            \/\/ make sure that we include supertypes.\n+            for (ClassSymbol cs : allSupertypes(cnode.getClassSymbol())) {\n+                if (isSymbolRelevant(cp, cs)) {\n+                    fqDeps.add(cs.outermostClass().flatname.toString());\n+                }\n+            }\n+\n+        }\n+        return result;\n+    }\n+\n+    public boolean isSymbolRelevant(boolean cp, ClassSymbol cs) {\n+        Location csLoc = getLocationOf(cs);\n+        Location relevantLocation = cp ? StandardLocation.CLASS_PATH : StandardLocation.SOURCE_PATH;\n+        return csLoc == relevantLocation;\n+    }\n+\n+    private Set<ClassSymbol> allSupertypes(TypeSymbol t) {\n+        if (t == null || !(t instanceof ClassSymbol classSymbol)) {\n+            return Collections.emptySet();\n+        }\n+        Set<ClassSymbol> result = new HashSet<>();\n+        result.add(classSymbol);\n+        result.addAll(allSupertypes(classSymbol.getSuperclass().tsym));\n+        for (Type it : classSymbol.getInterfaces()) {\n+            result.addAll(allSupertypes(it.tsym));\n+        }\n+        return result;\n+    }\n+\n+    private Collection<? extends Node<?, ?>> getAllDependencies(CompletionNode cnode) {\n+        return Stream.of(cnode.getSupportedDependencyKinds())\n+                     .flatMap(dk -> cnode.getDependenciesByKind(dk).stream())\n+                     .collect(Collectors.toSet());\n+    }\n+}\n","filename":"src\/jdk.compiler\/share\/classes\/com\/sun\/tools\/sjavac\/comp\/dependencies\/NewDependencyCollector.java","additions":197,"deletions":0,"binary":false,"changes":197,"status":"added"},{"patch":"@@ -0,0 +1,112 @@\n+\/*\n+ * Copyright (c) 2014, 2021, Oracle and\/or its affiliates. All rights reserved.\n+ * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+ *\n+ * This code is free software; you can redistribute it and\/or modify it\n+ * under the terms of the GNU General Public License version 2 only, as\n+ * published by the Free Software Foundation.  Oracle designates this\n+ * particular file as subject to the \"Classpath\" exception as provided\n+ * by Oracle in the LICENSE file that accompanied this code.\n+ *\n+ * This code is distributed in the hope that it will be useful, but WITHOUT\n+ * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+ * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+ * version 2 for more details (a copy is included in the LICENSE file that\n+ * accompanied this code).\n+ *\n+ * You should have received a copy of the GNU General Public License version\n+ * 2 along with this work; if not, write to the Free Software Foundation,\n+ * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n+ *\n+ * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n+ * or visit www.oracle.com if you need additional information or have any\n+ * questions.\n+ *\/\n+\n+package com.sun.tools.sjavac.comp.dependencies;\n+\n+import java.util.Collection;\n+import java.util.HashSet;\n+import java.util.Map;\n+import java.util.Set;\n+\n+import javax.tools.JavaFileObject;\n+\n+import com.sun.source.tree.Tree;\n+import com.sun.source.util.TaskEvent;\n+import com.sun.source.util.TaskListener;\n+import com.sun.tools.javac.code.Symbol.ClassSymbol;\n+import com.sun.tools.javac.tree.JCTree.JCClassDecl;\n+import com.sun.tools.javac.tree.JCTree.JCCompilationUnit;\n+import com.sun.tools.javac.util.Context;\n+import com.sun.tools.javac.util.DefinedBy;\n+import com.sun.tools.javac.util.DefinedBy.Api;\n+import com.sun.tools.sjavac.Log;\n+import com.sun.tools.sjavac.comp.PubAPIs;\n+import com.sun.tools.sjavac.pubapi.PubApi;\n+\n+\n+public class PublicApiCollector implements TaskListener {\n+\n+    private Context context;\n+    private final Set<ClassSymbol> classSymbols = new HashSet<>();\n+    private final Collection<JavaFileObject> explicitJFOs;\n+\n+    \/\/ Result collected upon compilation task finished\n+    private Map<String, PubApi> explicitPubApis;\n+    private Map<String, PubApi> nonExplicitPubApis;\n+\n+    public PublicApiCollector(Context context,\n+                              Collection<JavaFileObject> explicitJFOs) {\n+        this.context = context;\n+        this.explicitJFOs = explicitJFOs;\n+    }\n+\n+    @Override\n+    @DefinedBy(Api.COMPILER_TREE)\n+    public void finished(TaskEvent e) {\n+        switch (e.getKind()) {\n+        case ANALYZE:\n+            collectClassSymbols((JCCompilationUnit) e.getCompilationUnit());\n+            break;\n+        case COMPILATION:\n+            Log.debug(\"Compilation finished\");\n+            Log.debug(\"Extracting pub APIs for the following symbols:\");\n+            for (ClassSymbol cs : classSymbols)\n+                Log.debug(\"    \" + cs.fullname);\n+            extractPubApis();\n+\n+            \/\/ Save result for later retrieval. (Important that we do this\n+            \/\/ before we return from this method, because we may not access\n+            \/\/ symbols after compilation is finished.)\n+            PubAPIs pa = PubAPIs.instance(context);\n+            explicitPubApis = pa.getPubapis(explicitJFOs, true);\n+            nonExplicitPubApis = pa.getPubapis(explicitJFOs, false);\n+\n+            Log.debug(\"done\");\n+            break;\n+        }\n+    }\n+\n+    private void collectClassSymbols(JCCompilationUnit cu) {\n+        for (Tree t : cu.getTypeDecls()) {\n+            if (t instanceof JCClassDecl classDecl)  \/\/ Can also be a JCSkip\n+                classSymbols.add(classDecl.sym);\n+        }\n+    }\n+\n+    private void extractPubApis() {\n+        \/\/ To handle incremental builds (subsequent sjavac invocations) we need\n+        \/\/ to keep track of the public API of what we depend upon.\n+        \/\/\n+        \/\/ During the recompilation loop (within a single sjavac invocation) we\n+        \/\/ need to keep track of public API of what we're compiling to decide if\n+        \/\/ any dependants needs to be tainted.\n+        PubAPIs pubApis = PubAPIs.instance(context);\n+        classSymbols.forEach(pubApis::visitPubapi);\n+    }\n+\n+    public Map<String, PubApi> getPubApis(boolean explicit) {\n+        return explicit ? explicitPubApis : nonExplicitPubApis;\n+    }\n+}\n","filename":"src\/jdk.compiler\/share\/classes\/com\/sun\/tools\/sjavac\/comp\/dependencies\/PublicApiCollector.java","additions":112,"deletions":0,"binary":false,"changes":112,"status":"added"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2014, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2014, Oracle and\/or its affiliates. All rights reserved.\n@@ -26,1 +26,1 @@\n-package javacserver.options;\n+package com.sun.tools.sjavac.options;\n","filename":"src\/jdk.compiler\/share\/classes\/com\/sun\/tools\/sjavac\/options\/ArgumentIterator.java","additions":2,"deletions":2,"binary":false,"changes":4,"previous_filename":"make\/langtools\/tools\/javacserver\/options\/ArgumentIterator.java","status":"renamed"},{"patch":"@@ -0,0 +1,383 @@\n+\/*\n+ * Copyright (c) 2014, 2016, Oracle and\/or its affiliates. All rights reserved.\n+ * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+ *\n+ * This code is free software; you can redistribute it and\/or modify it\n+ * under the terms of the GNU General Public License version 2 only, as\n+ * published by the Free Software Foundation.  Oracle designates this\n+ * particular file as subject to the \"Classpath\" exception as provided\n+ * by Oracle in the LICENSE file that accompanied this code.\n+ *\n+ * This code is distributed in the hope that it will be useful, but WITHOUT\n+ * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+ * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+ * version 2 for more details (a copy is included in the LICENSE file that\n+ * accompanied this code).\n+ *\n+ * You should have received a copy of the GNU General Public License version\n+ * 2 along with this work; if not, write to the Free Software Foundation,\n+ * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n+ *\n+ * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n+ * or visit www.oracle.com if you need additional information or have any\n+ * questions.\n+ *\/\n+\n+package com.sun.tools.sjavac.options;\n+\n+import java.io.File;\n+import java.nio.file.Path;\n+import java.nio.file.Paths;\n+import java.util.ArrayList;\n+import java.util.List;\n+import java.util.regex.Matcher;\n+import java.util.regex.Pattern;\n+\n+import com.sun.tools.sjavac.CopyFile;\n+import com.sun.tools.sjavac.Transformer;\n+\n+\n+\/**\n+ * Sjavac options can be classified as:\n+ *\n+ *  (1) relevant only for sjavac, such as --server\n+ *  (2) relevant for sjavac and javac, such as -d, or\n+ *  (3) relevant only for javac, such as -g.\n+ *\n+ * This enum represents all options from (1) and (2). Note that instances of\n+ * this enum only entail static information about the option. For storage of\n+ * option values, refer to com.sun.tools.sjavac.options.Options.\n+ *\n+ *  <p><b>This is NOT part of any supported API.\n+ *  If you write code that depends on this, you do so at your own risk.\n+ *  This code and its internal interfaces are subject to change or\n+ *  deletion without notice.<\/b>\n+ *\/\n+public enum Option {\n+\n+    SRC(\"-src\", \"Location of source files to be compiled\") {\n+        @Override\n+        protected void processMatching(ArgumentIterator iter, OptionHelper helper) {\n+            List<Path> paths = getFileListArg(iter, helper);\n+            if (paths != null)\n+                helper.sourceRoots(paths);\n+        }\n+    },\n+    SOURCE_PATH(\"--source-path\", \"Specify search path for sources.\") {\n+        @Override\n+        protected void processMatching(ArgumentIterator iter, OptionHelper helper) {\n+            List<Path> paths = getFileListArg(iter, helper);\n+            if (paths != null)\n+                helper.sourcepath(paths);\n+        }\n+    },\n+    SOURCEPATH(\"-sourcepath\", \"An alias for -sourcepath\") {\n+        @Override\n+        protected void processMatching(ArgumentIterator iter, OptionHelper helper) {\n+            SOURCE_PATH.processMatching(iter, helper);\n+        }\n+    },\n+    MODULE_PATH(\"--module-path\", \"Specify search path for modules.\") {\n+        @Override\n+        protected void processMatching(ArgumentIterator iter, OptionHelper helper) {\n+            List<Path> paths = getFileListArg(iter, helper);\n+            if (paths != null)\n+                helper.modulepath(paths);\n+        }\n+    },\n+    P(\"-p\", \"An alias for --module-path\") {\n+        @Override\n+        protected void processMatching(ArgumentIterator iter, OptionHelper helper) {\n+            MODULE_PATH.processMatching(iter, helper);\n+        }\n+    },\n+    CLASS_PATH(\"--class-path\", \"Specify search path for classes.\") {\n+        @Override\n+        protected void processMatching(ArgumentIterator iter, OptionHelper helper) {\n+            List<Path> paths = getFileListArg(iter, helper);\n+            if (paths != null)\n+                helper.classpath(paths);\n+        }\n+    },\n+    CLASSPATH(\"-classpath\", \"An alias for -classpath.\") {\n+        @Override\n+        protected void processMatching(ArgumentIterator iter, OptionHelper helper) {\n+            CLASS_PATH.processMatching(iter, helper);\n+        }\n+    },\n+    CP(\"-cp\", \"An alias for -classpath\") {\n+        @Override\n+        protected void processMatching(ArgumentIterator iter, OptionHelper helper) {\n+            CLASS_PATH.processMatching(iter, helper);\n+        }\n+    },\n+    X(\"-x\", \"Exclude files matching the given pattern\") {\n+        @Override\n+        protected void processMatching(ArgumentIterator iter, OptionHelper helper) {\n+            String pattern = getFilePatternArg(iter, helper);\n+            if (pattern != null)\n+                helper.exclude(pattern);\n+        }\n+    },\n+    I(\"-i\", \"Include only files matching the given pattern\") {\n+        @Override\n+        protected void processMatching(ArgumentIterator iter, OptionHelper helper) {\n+            String pattern = getFilePatternArg(iter, helper);\n+            if (pattern != null)\n+                helper.include(pattern);\n+        }\n+    },\n+    TR(\"-tr\", \"Translate resources\") {\n+        @Override\n+        protected void processMatching(ArgumentIterator iter, OptionHelper helper) {\n+\n+            if (!iter.hasNext()) {\n+                helper.reportError(arg + \" must be followed by a translation rule\");\n+                return;\n+            }\n+\n+            String trArg = iter.next();\n+\n+            \/\/ Validate argument syntax. Examples:\n+            \/\/   .prop=com.sun.tools.javac.smart.CompileProperties\n+            \/\/   .idl=com.sun.corba.CompileIdl\n+            \/\/   .g3=antlr.CompileGrammar,debug=true\n+            String ident = \"[a-zA-Z_][a-zA-Z0-9_]*\";\n+            Pattern p = Pattern.compile(\"(?<suffix>\\\\.\" + ident + \")=\" +\n+                                        \"(?<class>\" + ident + \"(\\\\.\" + ident + \")*)\" +\n+                                        \"(?<extra>,.*)?\");\n+            \/\/ Check syntax\n+            Matcher m = p.matcher(trArg);\n+            if (!m.matches()) {\n+                helper.reportError(\"The string \\\"\" + trArg + \"\\\" is not a \" +\n+                                   \"valid translate pattern\");\n+                return;\n+            }\n+\n+            \/\/ Extract relevant parts\n+            String suffix = m.group(\"suffix\");\n+            String classname = m.group(\"class\");\n+            String extra = m.group(\"extra\");\n+\n+            \/\/ Valid suffix?\n+            if (suffix.matches(\"\\\\.(class|java)\")) {\n+                helper.reportError(\"You cannot have a translator for \" +\n+                                   suffix + \" files!\");\n+                return;\n+            }\n+\n+            \/\/ Construct transformer\n+            try {\n+                Class<?> trCls = Class.forName(classname);\n+                Transformer transformer =\n+                    (Transformer) trCls.getConstructor().newInstance();\n+                transformer.setExtra(extra);\n+                helper.addTransformer(suffix, transformer);\n+            } catch (Exception e) {\n+                helper.reportError(\"Cannot use \" + classname +\n+                                   \" as a translator: \" + e.getMessage());\n+            }\n+        }\n+    },\n+    COPY(\"-copy\", \"Copy resources\") {\n+        @Override\n+        protected void processMatching(ArgumentIterator iter, OptionHelper helper) {\n+            if (!iter.hasNext()) {\n+                helper.reportError(arg + \" must be followed by a resource type\");\n+                return;\n+            }\n+\n+            String copyArg = iter.next();\n+\n+            \/\/ Validate argument syntax. Examples: .gif, .html\n+            if (!copyArg.matches(\"\\\\.[a-zA-Z_][a-zA-Z0-9_]*\")) {\n+                helper.reportError(\"The string \\\"\" + copyArg + \"\\\" is not a \" +\n+                                   \"valid resource type.\");\n+                return;\n+            }\n+\n+            helper.addTransformer(copyArg, new CopyFile());\n+        }\n+    },\n+    J(\"-j\", \"Number of cores\") {\n+        @Override\n+        protected void processMatching(ArgumentIterator iter, OptionHelper helper) {\n+            if (!iter.hasNext() || !iter.peek().matches(\"\\\\d+\")) {\n+                helper.reportError(arg + \" must be followed by an integer\");\n+                return;\n+            }\n+            helper.numCores(Integer.parseInt(iter.next()));\n+        }\n+    },\n+    SERVER(\"--server:\", \"Specify server configuration file of running server\") {\n+        @Override\n+        protected void processMatching(ArgumentIterator iter, OptionHelper helper) {\n+            helper.serverConf(iter.current().substring(arg.length()));\n+        }\n+    },\n+    STARTSERVER(\"--startserver:\", \"Start server and use the given configuration file\") {\n+        @Override\n+        protected void processMatching(ArgumentIterator iter, OptionHelper helper) {\n+            helper.startServerConf(iter.current().substring(arg.length()));\n+        }\n+    },\n+    IMPLICIT(\"-implicit:\", \"Specify how to treat implicitly referenced source code\") {\n+        @Override\n+        protected void processMatching(ArgumentIterator iter, OptionHelper helper) {\n+            helper.implicit(iter.current().substring(arg.length()));\n+        }\n+    },\n+    LOG(\"--log=\", \"Specify logging level\") {\n+        @Override\n+        protected void processMatching(ArgumentIterator iter, OptionHelper helper) {\n+            helper.logLevel(iter.current().substring(arg.length()));\n+        }\n+    },\n+    VERBOSE(\"-verbose\", \"Set verbosity level to \\\"info\\\"\") {\n+        @Override\n+        protected void processMatching(ArgumentIterator iter, OptionHelper helper) {\n+            helper.logLevel(\"info\");\n+        }\n+    },\n+    PERMIT_ARTIFACT(\"--permit-artifact=\", \"Allow this artifact in destination directory\") {\n+        @Override\n+        protected void processMatching(ArgumentIterator iter, OptionHelper helper) {\n+            String a = iter.current().substring(arg.length());\n+            helper.permitArtifact(Paths.get(a).toFile().getAbsolutePath());\n+        }\n+    },\n+    PERMIT_UNIDENTIFIED_ARTIFACTS(\"--permit-unidentified-artifacts\", \"Allow unidentified artifacts in destination directory\") {\n+        @Override\n+        protected void processMatching(ArgumentIterator iter, OptionHelper helper) {\n+            helper.permitUnidentifiedArtifacts();\n+        }\n+    },\n+    PERMIT_SOURCES_WITHOUT_PACKAGE(\"--permit-sources-without-package\", \"Permit sources in the default package\") {\n+        @Override\n+        protected void processMatching(ArgumentIterator iter, OptionHelper helper) {\n+            helper.permitDefaultPackage();\n+        }\n+    },\n+    COMPARE_FOUND_SOURCES(\"--compare-found-sources\", \"Compare found sources with given sources\") {\n+        @Override\n+        protected void processMatching(ArgumentIterator iter, OptionHelper helper) {\n+            Path referenceSourceList = getFileArg(iter, helper, true, false);\n+            if (referenceSourceList != null)\n+                helper.compareFoundSources(referenceSourceList);\n+        }\n+    },\n+    D(\"-d\", \"Output destination directory\") {\n+        @Override\n+        protected void processMatching(ArgumentIterator iter, OptionHelper helper) {\n+            Path dir = getFileArg(iter, helper, false, true);\n+            if (dir != null)\n+                helper.destDir(dir);\n+        }\n+    },\n+    S(\"-s\", \"Directory for generated sources\") {\n+        @Override\n+        protected void processMatching(ArgumentIterator iter, OptionHelper helper) {\n+            Path dir = getFileArg(iter, helper, false, true);\n+            if (dir != null)\n+                helper.generatedSourcesDir(dir);\n+        }\n+    },\n+    H(\"-h\", \"Directory for header files\") {\n+        @Override\n+        protected void processMatching(ArgumentIterator iter, OptionHelper helper) {\n+            Path dir = getFileArg(iter, helper, false, true);\n+            if (dir != null)\n+                helper.headerDir(dir);\n+        }\n+    },\n+    STATE_DIR(\"--state-dir=\", \"Directory used to store sjavac state and log files.\") {\n+        @Override\n+        protected void processMatching(ArgumentIterator iter, OptionHelper helper) {\n+            String p = iter.current().substring(arg.length());\n+            helper.stateDir(Paths.get(p));\n+        }\n+    };\n+\n+\n+    public final String arg;\n+\n+    final String description;\n+\n+    private Option(String arg, String description) {\n+        this.arg = arg;\n+        this.description = description;\n+    }\n+\n+    \/** Retrieve and verify syntax of file list argument. *\/\n+    List<Path> getFileListArg(ArgumentIterator iter, OptionHelper helper) {\n+        if (!iter.hasNext()) {\n+            helper.reportError(arg + \" must be followed by a list of files \" +\n+                              \"separated by \" + File.pathSeparator);\n+            return null;\n+        }\n+        List<Path> result = new ArrayList<>();\n+        for (String pathStr : iter.next().split(File.pathSeparator))\n+            result.add(Paths.get(pathStr));\n+        return result;\n+    }\n+\n+    \/** Retrieve and verify syntax of file argument. *\/\n+    Path getFileArg(ArgumentIterator iter, OptionHelper helper, boolean fileAcceptable, boolean dirAcceptable) {\n+\n+        if (!iter.hasNext()) {\n+            String errmsg = arg + \" must be followed by \";\n+            if (fileAcceptable && dirAcceptable) errmsg += \"a file or directory.\";\n+            else if (fileAcceptable) errmsg += \"a file.\";\n+            else if (dirAcceptable)  errmsg += \"a directory.\";\n+            else throw new IllegalArgumentException(\"File or directory must be acceptable.\");\n+            helper.reportError(errmsg);\n+            return null;\n+        }\n+\n+        return Paths.get(iter.next());\n+    }\n+\n+    \/** Retrieve the next file or package argument. *\/\n+    String getFilePatternArg(ArgumentIterator iter, OptionHelper helper) {\n+\n+        if (!iter.hasNext()) {\n+            helper.reportError(arg + \" must be followed by a glob pattern.\");\n+            return null;\n+        }\n+\n+        return iter.next();\n+    }\n+\n+    \/\/ Future cleanup: Change the \"=\" syntax to \":\" syntax to be consistent and\n+    \/\/ to follow the javac-option style.\n+\n+    public boolean hasOption() {\n+        return arg.endsWith(\":\") || arg.endsWith(\"=\");\n+    }\n+\n+\n+    \/**\n+     * Process current argument of argIter.\n+     *\n+     * It's final, since the option customization is typically done in\n+     * processMatching.\n+     *\n+     * @param argIter Iterator to read current and succeeding arguments from.\n+     * @param helper The helper to report back to.\n+     * @return true iff the argument was processed by this option.\n+     *\/\n+    public final boolean processCurrent(ArgumentIterator argIter,\n+                                        OptionHelper helper) {\n+        String fullArg = argIter.current(); \/\/ \"-tr\" or \"-log=level\"\n+        if (hasOption() ? fullArg.startsWith(arg) : fullArg.equals(arg)) {\n+            processMatching(argIter, helper);\n+            return true;\n+        }\n+        \/\/ Did not match\n+        return false;\n+    }\n+\n+    \/** Called by process if the current argument matches this option. *\/\n+    protected abstract void processMatching(ArgumentIterator argIter,\n+                                            OptionHelper helper);\n+}\n","filename":"src\/jdk.compiler\/share\/classes\/com\/sun\/tools\/sjavac\/options\/Option.java","additions":383,"deletions":0,"binary":false,"changes":383,"status":"added"},{"patch":"@@ -0,0 +1,161 @@\n+\/*\n+ * Copyright (c) 2014, Oracle and\/or its affiliates. All rights reserved.\n+ * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+ *\n+ * This code is free software; you can redistribute it and\/or modify it\n+ * under the terms of the GNU General Public License version 2 only, as\n+ * published by the Free Software Foundation.  Oracle designates this\n+ * particular file as subject to the \"Classpath\" exception as provided\n+ * by Oracle in the LICENSE file that accompanied this code.\n+ *\n+ * This code is distributed in the hope that it will be useful, but WITHOUT\n+ * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+ * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+ * version 2 for more details (a copy is included in the LICENSE file that\n+ * accompanied this code).\n+ *\n+ * You should have received a copy of the GNU General Public License version\n+ * 2 along with this work; if not, write to the Free Software Foundation,\n+ * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n+ *\n+ * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n+ * or visit www.oracle.com if you need additional information or have any\n+ * questions.\n+ *\/\n+\n+package com.sun.tools.sjavac.options;\n+\n+import java.nio.file.Path;\n+import java.nio.file.Paths;\n+import java.util.Arrays;\n+import java.util.List;\n+\n+import com.sun.tools.javac.main.CommandLine;\n+import com.sun.tools.sjavac.Transformer;\n+\n+\/**\n+ * This class is used to decode sjavac options.\n+ * See com.sun.tools.sjavac.options.Options for example usage.\n+ *\n+ *  <p><b>This is NOT part of any supported API.\n+ *  If you write code that depends on this, you do so at your own risk.\n+ *  This code and its internal interfaces are subject to change or\n+ *  deletion without notice.<\/b>\n+ *\/\n+public abstract class OptionHelper {\n+\n+    \/** Handle error *\/\n+    public abstract void reportError(String msg);\n+\n+    \/** Record a package exclusion pattern *\/\n+    public abstract void exclude(String excl);\n+\n+    \/** Record a package inclusion pattern *\/\n+    public abstract void include(String incl);\n+\n+    \/** Record a root of sources to be compiled *\/\n+    public abstract void sourceRoots(List<Path> path);\n+\n+    \/** Record a suffix + transformer *\/\n+    public abstract void addTransformer(String suffix, Transformer tr);\n+\n+    \/** Record a sourcepath to be used *\/\n+    public abstract void sourcepath(List<Path> path);\n+\n+    \/** Record a modulepath to be used *\/\n+    public abstract void modulepath(List<Path> path);\n+\n+    \/** Record a classpath to be used *\/\n+    public abstract void classpath(List<Path> path);\n+\n+    \/** Record the number of cores *\/\n+    public abstract void numCores(int parseInt);\n+\n+    \/** Record desired log level *\/\n+    public abstract void logLevel(String level);\n+\n+    \/** Record path for reference source list *\/\n+    public abstract void compareFoundSources(Path referenceList);\n+\n+    \/** Record a single permitted artifact *\/\n+    public abstract void permitArtifact(String f);\n+\n+    \/** Record the fact that unidentified artifacts are permitted *\/\n+    public abstract void permitUnidentifiedArtifacts();\n+\n+    \/** Record the fact that sources in the default package are permitted *\/\n+    public abstract void permitDefaultPackage();\n+\n+    \/** Record server configuration parameters *\/\n+    public abstract void serverConf(String serverConf);\n+\n+    \/** Record server launch configuration parameters *\/\n+    public abstract void startServerConf(String serverConf);\n+\n+    \/** Record some arguments to be passed on to javac *\/\n+    public abstract void javacArg(String... arg);\n+\n+    \/** Sets the destination directory for the compilation *\/\n+    public abstract void destDir(Path dir);\n+\n+    \/** Sets the directory for generated sources *\/\n+    public abstract void generatedSourcesDir(Path genSrcDir);\n+\n+    \/** Sets the directory for generated headers *\/\n+    public abstract void headerDir(Path dir);\n+\n+    \/** Sets the directory for state and log files generated by sjavac *\/\n+    public abstract void stateDir(Path dir);\n+\n+    \/** Sets the implicit policy *\/\n+    public abstract void implicit(String policy);\n+\n+\n+    \/**\n+     * Traverses an array of arguments and performs the appropriate callbacks.\n+     *\n+     * @param args the arguments to traverse.\n+     *\/\n+    void traverse(String[] args) {\n+        Iterable<String> allArgs;\n+        try {\n+            allArgs = CommandLine.parse(List.of(args)); \/\/ Detect @file and load it as a command line.\n+        } catch (java.io.IOException e) {\n+            throw new IllegalArgumentException(\"Problem reading @\"+e.getMessage());\n+        }\n+        ArgumentIterator argIter = new ArgumentIterator(allArgs);\n+\n+        nextArg:\n+        while (argIter.hasNext()) {\n+\n+            String arg = argIter.next();\n+\n+            if (arg.startsWith(\"-\")) {\n+                for (Option opt : Option.values()) {\n+                    if (opt.processCurrent(argIter, this))\n+                        continue nextArg;\n+                }\n+\n+                javacArg(arg);\n+\n+                \/\/ Does this javac argument take an argument? If so, don't\n+                \/\/ let it pass on to sjavac as a source root directory.\n+                for (com.sun.tools.javac.main.Option javacOpt : com.sun.tools.javac.main.Option.values()) {\n+                    if (javacOpt.matches(arg)) {\n+                        boolean takesArgument = javacOpt.hasArg();\n+                        boolean separateToken = !arg.contains(\":\") && !arg.contains(\"=\");\n+                        if (takesArgument && separateToken)\n+                            javacArg(argIter.next());\n+                    }\n+                }\n+            } else {\n+                sourceRoots(Arrays.asList(Paths.get(arg)));\n+            }\n+        }\n+    }\n+\n+    public static String unescapeCmdArg(String arg) {\n+        return arg.replaceAll(\"%20\", \" \")\n+                  .replaceAll(\"%2C\", \",\");\n+    }\n+}\n","filename":"src\/jdk.compiler\/share\/classes\/com\/sun\/tools\/sjavac\/options\/OptionHelper.java","additions":161,"deletions":0,"binary":false,"changes":161,"status":"added"},{"patch":"@@ -0,0 +1,521 @@\n+\/*\n+ * Copyright (c) 2014, 2018, Oracle and\/or its affiliates. All rights reserved.\n+ * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+ *\n+ * This code is free software; you can redistribute it and\/or modify it\n+ * under the terms of the GNU General Public License version 2 only, as\n+ * published by the Free Software Foundation.  Oracle designates this\n+ * particular file as subject to the \"Classpath\" exception as provided\n+ * by Oracle in the LICENSE file that accompanied this code.\n+ *\n+ * This code is distributed in the hope that it will be useful, but WITHOUT\n+ * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+ * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+ * version 2 for more details (a copy is included in the LICENSE file that\n+ * accompanied this code).\n+ *\n+ * You should have received a copy of the GNU General Public License version\n+ * 2 along with this work; if not, write to the Free Software Foundation,\n+ * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n+ *\n+ * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n+ * or visit www.oracle.com if you need additional information or have any\n+ * questions.\n+ *\/\n+\n+package com.sun.tools.sjavac.options;\n+\n+import java.nio.file.Path;\n+import java.util.ArrayList;\n+import java.util.Arrays;\n+import java.util.Collection;\n+import java.util.HashMap;\n+import java.util.List;\n+import java.util.Map;\n+import java.util.Set;\n+import java.util.HashSet;\n+import java.util.StringJoiner;\n+\n+import com.sun.tools.sjavac.Transformer;\n+import com.sun.tools.sjavac.Util;\n+\n+\/**\n+ * Instances of this class represent values for sjavac command line options.\n+ *\n+ *  <p><b>This is NOT part of any supported API.\n+ *  If you write code that depends on this, you do so at your own risk.\n+ *  This code and its internal interfaces are subject to change or\n+ *  deletion without notice.<\/b>\n+ *\/\n+public class Options {\n+\n+    \/\/ Output directories\n+    private Path destDir, genSrcDir, headerDir, stateDir;\n+\n+    \/\/ Input directories\n+    private List<SourceLocation> sources = new ArrayList<>();\n+    private List<SourceLocation> sourceSearchPaths = new ArrayList<>();\n+    private List<SourceLocation> classSearchPaths = new ArrayList<>();\n+    private List<SourceLocation> moduleSearchPaths = new ArrayList<>();\n+\n+    private String logLevel = \"info\";\n+\n+    private Set<String> permitted_artifacts = new HashSet<>();\n+    private boolean permitUnidentifiedArtifacts = false;\n+    private boolean permitSourcesInDefaultPackage = false;\n+\n+    private Path sourceReferenceList;\n+    private int numCores = 4;\n+    private String implicitPolicy = \"none\";\n+    private List<String> javacArgs = new ArrayList<>();\n+\n+    private Map<String, Transformer> trRules = new HashMap<>();\n+\n+    private boolean startServer = false;\n+\n+    \/\/ Server configuration string\n+    private String serverConf;\n+\n+    \/** Get the policy for implicit classes *\/\n+    public String getImplicitPolicy() {\n+        return implicitPolicy;\n+    }\n+\n+    \/** Get the path for generated sources (or null if no such path is set) *\/\n+    public Path getGenSrcDir() {\n+        return genSrcDir;\n+    }\n+\n+    \/** Get the path for the destination directory *\/\n+    public Path getDestDir() {\n+        return destDir;\n+    }\n+\n+    \/** Get the path for the header directory (or null if no such path is set) *\/\n+    public Path getHeaderDir() {\n+        return headerDir;\n+    }\n+\n+    \/** Get the path for the state directory, defaults to destDir. *\/\n+    public Path getStateDir() {\n+        return stateDir;\n+    }\n+\n+    \/** Get all source locations for files to be compiled *\/\n+    public List<SourceLocation> getSources() {\n+        return sources;\n+    }\n+\n+    \/**\n+     * Get all paths to search for classes in .java format. (Java-files in\n+     * found here should not be compiled.\n+     *\/\n+    public List<SourceLocation> getSourceSearchPaths() {\n+        return sourceSearchPaths;\n+    }\n+\n+    \/** Get all paths to search for classes in. *\/\n+    public List<SourceLocation> getClassSearchPath() {\n+        return classSearchPaths;\n+    }\n+\n+    \/** Get all paths to search for modules in. *\/\n+    public List<SourceLocation> getModuleSearchPaths() {\n+        return moduleSearchPaths;\n+    }\n+\n+    \/** Get the log level. *\/\n+    public String getLogLevel() {\n+        return logLevel;\n+    }\n+\n+    \/** Returns true iff the artifact is permitted in the output dir. *\/\n+    public boolean isUnidentifiedArtifactPermitted(String f) {\n+        return permitted_artifacts.contains(f);\n+    }\n+\n+    \/** Returns true iff artifacts in the output directories should be kept,\n+     * even if they would not be generated in a clean build. *\/\n+    public boolean areUnidentifiedArtifactsPermitted() {\n+        return permitUnidentifiedArtifacts;\n+    }\n+\n+    \/** Returns true iff sources in the default package should be permitted. *\/\n+    public boolean isDefaultPackagePermitted() {\n+        return permitSourcesInDefaultPackage;\n+    }\n+\n+    \/** Get the path to the list of reference sources (or null if none is set) *\/\n+    public Path getSourceReferenceList() {\n+        return sourceReferenceList;\n+    }\n+\n+    \/** Get the number of cores to be used by sjavac *\/\n+    public int getNumCores() {\n+        return numCores;\n+    }\n+\n+    \/** Returns all arguments relevant to javac but irrelevant to sjavac. *\/\n+    public List<String> getJavacArgs() {\n+        return javacArgs;\n+    }\n+\n+    \/**\n+     * Get a map which maps suffixes to transformers (for example\n+     * \".java\" {@literal ->} CompileJavaPackages)\n+     *\/\n+    public Map<String, Transformer> getTranslationRules() {\n+        return trRules;\n+    }\n+\n+    \/** Return true iff a new server should be started *\/\n+    public boolean startServerFlag() {\n+        return startServer;\n+    }\n+\n+    \/** Return the server configuration string. *\/\n+    public String getServerConf() {\n+        return serverConf;\n+    }\n+\n+    \/**\n+     * Parses the given argument array and returns a corresponding Options\n+     * instance.\n+     *\/\n+    public static Options parseArgs(String... args) {\n+        Options options = new Options();\n+        options.new ArgDecoderOptionHelper().traverse(args);\n+        return options;\n+    }\n+\n+    \/** Returns true iff a .java file is among the javac arguments *\/\n+    public boolean isJavaFilesAmongJavacArgs() {\n+        for (String javacArg : javacArgs)\n+            if (javacArg.endsWith(\".java\"))\n+                return true;\n+        return false;\n+    }\n+\n+    \/**\n+     * Returns a string representation of the options that affect the result of\n+     * the compilation. (Used for saving the state of the options used in a\n+     * previous compile.)\n+     *\/\n+    public String getStateArgsString() {\n+\n+        \/\/ Local utility class for collecting the arguments\n+        class StateArgs {\n+\n+            private List<String> args = new ArrayList<>();\n+\n+            void addArg(Option opt) {\n+                args.add(opt.arg);\n+            }\n+\n+            void addArg(Option opt, Object val) {\n+                addArg(opt);\n+                args.add(val.toString());\n+            }\n+\n+            void addSourceLocations(Option opt, List<SourceLocation> locs) {\n+                for (SourceLocation sl : locs) {\n+                    for (String pkg : sl.includes) addArg(Option.I, pkg);\n+                    for (String pkg : sl.excludes) addArg(Option.X, pkg);\n+                    addArg(opt, sl.getPath());\n+                }\n+            }\n+\n+            String getResult() {\n+                return String.join(\" \", args);\n+            }\n+\n+            public void addAll(Collection<String> toAdd) {\n+                args.addAll(toAdd);\n+            }\n+        }\n+\n+        StateArgs args = new StateArgs();\n+\n+        \/\/ Directories\n+        if (genSrcDir != null)\n+            args.addArg(Option.S, genSrcDir.normalize());\n+\n+        if (headerDir != null)\n+            args.addArg(Option.H, headerDir.normalize());\n+\n+        if (destDir != null)\n+            args.addArg(Option.D, destDir.normalize());\n+\n+        if (stateDir != null)\n+            args.addArg(Option.STATE_DIR, stateDir.normalize());\n+\n+        \/\/ Source roots\n+        args.addSourceLocations(Option.SRC, sources);\n+        args.addSourceLocations(Option.SOURCE_PATH, sourceSearchPaths);\n+        args.addSourceLocations(Option.CLASS_PATH,  classSearchPaths);\n+        args.addSourceLocations(Option.MODULE_PATH, moduleSearchPaths);\n+\n+        \/\/ Boolean options\n+        if (permitSourcesInDefaultPackage)\n+            args.addArg(Option.PERMIT_SOURCES_WITHOUT_PACKAGE);\n+\n+        for (String f : permitted_artifacts) {\n+            args.addArg(Option.PERMIT_ARTIFACT, f);\n+        }\n+\n+        if (permitUnidentifiedArtifacts)\n+            args.addArg(Option.PERMIT_UNIDENTIFIED_ARTIFACTS);\n+\n+        \/\/ Translation rules\n+        for (Map.Entry<String, Transformer> tr : trRules.entrySet()) {\n+            String val = tr.getKey() + \"=\" + tr.getValue().getClass().getName();\n+            args.addArg(Option.TR, val);\n+        }\n+\n+        \/\/ Javac args\n+        args.addAll(javacArgs);\n+\n+        return args.getResult();\n+    }\n+\n+\n+    \/** Extract the arguments to be passed on to javac. *\/\n+    public String[] prepJavacArgs() {\n+        List<String> args = new ArrayList<>();\n+\n+        \/\/ Output directories\n+        args.add(\"-d\");\n+        args.add(destDir.toString());\n+\n+        if (getGenSrcDir() != null) {\n+            args.add(\"-s\");\n+            args.add(genSrcDir.toString());\n+        }\n+\n+        if (headerDir != null) {\n+            args.add(\"-h\");\n+            args.add(headerDir.toString());\n+        }\n+\n+        \/\/ Prep sourcepath\n+        List<SourceLocation> sourcepath = new ArrayList<>();\n+        sourcepath.addAll(sources);\n+        sourcepath.addAll(sourceSearchPaths);\n+        if (sourcepath.size() > 0) {\n+            args.add(\"-sourcepath\");\n+            args.add(concatenateSourceLocations(sourcepath));\n+        }\n+\n+        \/\/ Prep classpath\n+        if (classSearchPaths.size() > 0) {\n+            args.add(\"-classpath\");\n+            args.add(concatenateSourceLocations(classSearchPaths));\n+        }\n+\n+        \/\/ Enable dependency generation\n+        args.add(\"--debug=completionDeps=source,class\");\n+\n+        \/\/ This can't be anything but 'none'. Enforced by sjavac main method.\n+        args.add(\"-implicit:\" + implicitPolicy);\n+\n+        \/\/ If this option is not used, Object for instance is erroneously\n+        \/\/ picked up from PLATFORM_CLASS_PATH instead of CLASS_PATH.\n+        \/\/\n+        \/\/ Discussing this further led to the decision of letting bootclasspath\n+        \/\/ be a dummy (empty) directory when building the JDK.\n+        \/\/args.add(\"-XXuserPathsFirst\");\n+\n+        \/\/ Append javac-options (i.e. pass through options not recognized by\n+        \/\/ sjavac to javac.)\n+        args.addAll(javacArgs);\n+\n+        return args.toArray(new String[args.size()]);\n+    }\n+\n+    \/\/ Helper method to join a list of source locations separated by\n+    \/\/ File.pathSeparator\n+    private static String concatenateSourceLocations(List<SourceLocation> locs) {\n+        StringJoiner joiner = new StringJoiner(java.io.File.pathSeparator);\n+        for (SourceLocation loc : locs) {\n+            joiner.add(loc.getPath().toString());\n+        }\n+        return joiner.toString();\n+    }\n+\n+    \/\/ OptionHelper that records the traversed options in this Options instance.\n+    private class ArgDecoderOptionHelper extends OptionHelper {\n+\n+        List<String> includes, excludes, includeFiles, excludeFiles;\n+        {\n+            resetFilters();\n+        }\n+\n+        boolean headerProvided = false;\n+        boolean genSrcProvided = false;\n+        boolean stateProvided = false;\n+\n+        @Override\n+        public void reportError(String msg) {\n+            throw new IllegalArgumentException(msg);\n+        }\n+\n+        @Override\n+        public void sourceRoots(List<Path> paths) {\n+            sources.addAll(createSourceLocations(paths));\n+        }\n+\n+        @Override\n+        public void exclude(String exclPattern) {\n+            exclPattern = Util.normalizeDriveLetter(exclPattern);\n+            excludes.add(exclPattern);\n+        }\n+\n+        @Override\n+        public void include(String inclPattern) {\n+            inclPattern = Util.normalizeDriveLetter(inclPattern);\n+            includes.add(inclPattern);\n+        }\n+\n+        @Override\n+        public void addTransformer(String suffix, Transformer tr) {\n+            if (trRules.containsKey(suffix)) {\n+                reportError(\"More than one transformer specified for \" +\n+                            \"suffix \" + suffix + \".\");\n+                return;\n+            }\n+            trRules.put(suffix, tr);\n+        }\n+\n+        @Override\n+        public void sourcepath(List<Path> paths) {\n+            sourceSearchPaths.addAll(createSourceLocations(paths));\n+        }\n+\n+        @Override\n+        public void modulepath(List<Path> paths) {\n+            moduleSearchPaths.addAll(createSourceLocations(paths));\n+        }\n+\n+        @Override\n+        public void classpath(List<Path> paths) {\n+            classSearchPaths.addAll(createSourceLocations(paths));\n+        }\n+\n+        @Override\n+        public void numCores(int n) {\n+            numCores = n;\n+        }\n+\n+        @Override\n+        public void logLevel(String level) {\n+            logLevel = level;\n+        }\n+\n+        @Override\n+        public void compareFoundSources(Path referenceList) {\n+            sourceReferenceList = referenceList;\n+        }\n+\n+        @Override\n+        public void permitArtifact(String f) {\n+            permitted_artifacts.add(f);\n+        }\n+\n+        @Override\n+        public void permitUnidentifiedArtifacts() {\n+            permitUnidentifiedArtifacts = true;\n+        }\n+\n+        @Override\n+        public void permitDefaultPackage() {\n+            permitSourcesInDefaultPackage = true;\n+        }\n+\n+        @Override\n+        public void serverConf(String conf) {\n+            if (serverConf != null)\n+                reportError(\"Can not specify more than one server configuration.\");\n+            else\n+                serverConf = conf;\n+        }\n+\n+        @Override\n+        public void implicit(String policy) {\n+            implicitPolicy = policy;\n+        }\n+\n+        @Override\n+        public void startServerConf(String conf) {\n+            if (serverConf != null)\n+                reportError(\"Can not specify more than one server configuration.\");\n+            else {\n+                startServer = true;\n+                serverConf = conf;\n+            }\n+        }\n+\n+        @Override\n+        public void javacArg(String... arg) {\n+            javacArgs.addAll(Arrays.asList(arg));\n+        }\n+\n+        @Override\n+        public void destDir(Path dir) {\n+            if (destDir != null) {\n+                reportError(\"Destination directory already specified.\");\n+                return;\n+            }\n+            destDir = dir.toAbsolutePath();\n+        }\n+\n+        @Override\n+        public void generatedSourcesDir(Path dir) {\n+            if (genSrcProvided) {\n+                reportError(\"Directory for generated sources already specified.\");\n+                return;\n+            }\n+            genSrcProvided = true;\n+            genSrcDir = dir.toAbsolutePath();\n+        }\n+\n+        @Override\n+        public void headerDir(Path dir) {\n+            if (headerProvided) {\n+                reportError(\"Header directory already specified.\");\n+                return;\n+            }\n+            headerProvided = true;\n+            headerDir = dir.toAbsolutePath();\n+        }\n+\n+        @Override\n+        public void stateDir(Path dir) {\n+            if (stateProvided) {\n+                reportError(\"State directory already specified.\");\n+                return;\n+            }\n+            stateProvided = true;\n+            stateDir = dir.toAbsolutePath();\n+        }\n+\n+        private List<SourceLocation> createSourceLocations(List<Path> paths) {\n+            List<SourceLocation> result = new ArrayList<>();\n+            for (Path path : paths) {\n+                result.add(new SourceLocation(\n+                        path,\n+                        includes,\n+                        excludes));\n+            }\n+            resetFilters();\n+            return result;\n+        }\n+\n+        private void resetFilters() {\n+            includes = new ArrayList<>();\n+            excludes = new ArrayList<>();\n+            includeFiles = new ArrayList<>();\n+            excludeFiles = new ArrayList<>();\n+        }\n+    }\n+\n+}\n","filename":"src\/jdk.compiler\/share\/classes\/com\/sun\/tools\/sjavac\/options\/Options.java","additions":521,"deletions":0,"binary":false,"changes":521,"status":"added"},{"patch":"@@ -0,0 +1,119 @@\n+\/*\n+ * Copyright (c) 2014, Oracle and\/or its affiliates. All rights reserved.\n+ * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+ *\n+ * This code is free software; you can redistribute it and\/or modify it\n+ * under the terms of the GNU General Public License version 2 only, as\n+ * published by the Free Software Foundation.  Oracle designates this\n+ * particular file as subject to the \"Classpath\" exception as provided\n+ * by Oracle in the LICENSE file that accompanied this code.\n+ *\n+ * This code is distributed in the hope that it will be useful, but WITHOUT\n+ * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+ * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+ * version 2 for more details (a copy is included in the LICENSE file that\n+ * accompanied this code).\n+ *\n+ * You should have received a copy of the GNU General Public License version\n+ * 2 along with this work; if not, write to the Free Software Foundation,\n+ * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n+ *\n+ * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n+ * or visit www.oracle.com if you need additional information or have any\n+ * questions.\n+ *\/\n+\n+package com.sun.tools.sjavac.options;\n+\n+import java.io.IOException;\n+import java.nio.file.Path;\n+import java.util.List;\n+import java.util.Map;\n+import java.util.Set;\n+\n+import com.sun.tools.sjavac.Log;\n+import com.sun.tools.sjavac.Module;\n+import com.sun.tools.sjavac.ProblemException;\n+import com.sun.tools.sjavac.Source;\n+\n+\/**\n+ * Represents a directory to be used for input to sjavac. (For instance a\n+ * sourcepath or classpath.)\n+ *\n+ *  <p><b>This is NOT part of any supported API.\n+ *  If you write code that depends on this, you do so at your own risk.\n+ *  This code and its internal interfaces are subject to change or\n+ *  deletion without notice.<\/b>\n+ *\/\n+public class SourceLocation {\n+\n+    \/\/ Path to the root directory\n+    private Path path;\n+\n+    \/\/ Package include \/ exclude patterns and file includes \/ excludes.\n+    List<String> includes, excludes;\n+\n+    public SourceLocation(Path path,\n+                          List<String> includes,\n+                          List<String> excludes) {\n+        this.path = path;\n+        this.includes = includes;\n+        this.excludes = excludes;\n+    }\n+\n+\n+    \/**\n+     * Finds all files with the given suffix that pass the include \/ exclude\n+     * filters in this source location.\n+     *\n+     * @param suffixes The set of suffixes to search for\n+     * @param foundFiles The map in which to store the found files\n+     * @param foundModules The map in which to store the found modules\n+     * @param currentModule The current module\n+     * @param permitSourcesInDefaultPackage true if sources in default package\n+     *                                      are to be permitted\n+     * @param inLinksrc true if in link source\n+     *\/\n+    public void findSourceFiles(Set<String> suffixes,\n+                                Map<String, Source> foundFiles,\n+                                Map<String, Module> foundModules,\n+                                Module currentModule,\n+                                boolean permitSourcesInDefaultPackage,\n+                                boolean inLinksrc)\n+                                        throws IOException {\n+        try {\n+            Source.scanRoot(path.toFile(),\n+                            suffixes,\n+                            excludes,\n+                            includes,\n+                            foundFiles,\n+                            foundModules,\n+                            currentModule,\n+                            permitSourcesInDefaultPackage,\n+                            false,\n+                            inLinksrc);\n+        } catch (ProblemException e) {\n+            e.printStackTrace();\n+        }\n+    }\n+    \/** Get the root directory of this source location *\/\n+    public Path getPath() {\n+        return path;\n+    }\n+\n+    \/** Get the package include patterns *\/\n+    public List<String> getIncludes() {\n+        return includes;\n+    }\n+\n+    \/** Get the package exclude patterns *\/\n+    public List<String> getExcludes() {\n+        return excludes;\n+    }\n+\n+    @Override\n+    public String toString() {\n+        return String.format(\"%s[\\\"%s\\\", includes: %s, excludes: %s]\",\n+                             getClass().getSimpleName(), path, includes, excludes);\n+    }\n+}\n","filename":"src\/jdk.compiler\/share\/classes\/com\/sun\/tools\/sjavac\/options\/SourceLocation.java","additions":119,"deletions":0,"binary":false,"changes":119,"status":"added"},{"patch":"@@ -0,0 +1,55 @@\n+\/*\n+ * Copyright (c) 2014, 2015, Oracle and\/or its affiliates. All rights reserved.\n+ * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+ *\n+ * This code is free software; you can redistribute it and\/or modify it\n+ * under the terms of the GNU General Public License version 2 only, as\n+ * published by the Free Software Foundation.  Oracle designates this\n+ * particular file as subject to the \"Classpath\" exception as provided\n+ * by Oracle in the LICENSE file that accompanied this code.\n+ *\n+ * This code is distributed in the hope that it will be useful, but WITHOUT\n+ * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+ * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+ * version 2 for more details (a copy is included in the LICENSE file that\n+ * accompanied this code).\n+ *\n+ * You should have received a copy of the GNU General Public License version\n+ * 2 along with this work; if not, write to the Free Software Foundation,\n+ * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n+ *\n+ * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n+ * or visit www.oracle.com if you need additional information or have any\n+ * questions.\n+ *\/\n+\n+package com.sun.tools.sjavac.pubapi;\n+\n+import java.io.Serializable;\n+\n+import javax.lang.model.type.TypeKind;\n+\n+public class ArrayTypeDesc extends TypeDesc implements Serializable {\n+\n+    private static final long serialVersionUID = -1177329549163314996L;\n+\n+    TypeDesc compTypeDesc;\n+\n+    public ArrayTypeDesc(TypeDesc compTypeDesc) {\n+        super(TypeKind.ARRAY);\n+        this.compTypeDesc = compTypeDesc;\n+    }\n+\n+    @Override\n+    public boolean equals(Object obj) {\n+        if (!super.equals(obj))\n+            return false;\n+        return compTypeDesc.equals(((ArrayTypeDesc) obj).compTypeDesc);\n+    }\n+\n+    @Override\n+    public int hashCode() {\n+        return super.hashCode() ^ compTypeDesc.hashCode();\n+    }\n+\n+}\n","filename":"src\/jdk.compiler\/share\/classes\/com\/sun\/tools\/sjavac\/pubapi\/ArrayTypeDesc.java","additions":55,"deletions":0,"binary":false,"changes":55,"status":"added"},{"patch":"@@ -0,0 +1,50 @@\n+\/*\n+ * Copyright (c) 2014, 2015, Oracle and\/or its affiliates. All rights reserved.\n+ * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+ *\n+ * This code is free software; you can redistribute it and\/or modify it\n+ * under the terms of the GNU General Public License version 2 only, as\n+ * published by the Free Software Foundation.  Oracle designates this\n+ * particular file as subject to the \"Classpath\" exception as provided\n+ * by Oracle in the LICENSE file that accompanied this code.\n+ *\n+ * This code is distributed in the hope that it will be useful, but WITHOUT\n+ * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+ * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+ * version 2 for more details (a copy is included in the LICENSE file that\n+ * accompanied this code).\n+ *\n+ * You should have received a copy of the GNU General Public License version\n+ * 2 along with this work; if not, write to the Free Software Foundation,\n+ * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n+ *\n+ * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n+ * or visit www.oracle.com if you need additional information or have any\n+ * questions.\n+ *\/\n+\n+package com.sun.tools.sjavac.pubapi;\n+\n+import java.io.Serializable;\n+\n+import javax.lang.model.type.TypeKind;\n+\n+import com.sun.tools.javac.util.StringUtils;\n+\n+public class PrimitiveTypeDesc extends TypeDesc implements Serializable {\n+\n+    private static final long serialVersionUID = 6051065543149129106L;\n+\n+    public PrimitiveTypeDesc(TypeKind typeKind) {\n+        super(typeKind);\n+        if (!typeKind.isPrimitive() && typeKind != TypeKind.VOID)\n+            throw new IllegalArgumentException(\"Only primitives or void accepted\");\n+    }\n+\n+    \/\/ This class has no fields, so the inherited hashCode and equals should do fine.\n+\n+    @Override\n+    public String toString() {\n+        return StringUtils.toLowerCase(typeKind.toString());\n+    }\n+}\n","filename":"src\/jdk.compiler\/share\/classes\/com\/sun\/tools\/sjavac\/pubapi\/PrimitiveTypeDesc.java","additions":50,"deletions":0,"binary":false,"changes":50,"status":"added"},{"patch":"@@ -0,0 +1,437 @@\n+\/*\n+ * Copyright (c) 2014, 2021, Oracle and\/or its affiliates. All rights reserved.\n+ * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+ *\n+ * This code is free software; you can redistribute it and\/or modify it\n+ * under the terms of the GNU General Public License version 2 only, as\n+ * published by the Free Software Foundation.  Oracle designates this\n+ * particular file as subject to the \"Classpath\" exception as provided\n+ * by Oracle in the LICENSE file that accompanied this code.\n+ *\n+ * This code is distributed in the hope that it will be useful, but WITHOUT\n+ * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+ * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+ * version 2 for more details (a copy is included in the LICENSE file that\n+ * accompanied this code).\n+ *\n+ * You should have received a copy of the GNU General Public License version\n+ * 2 along with this work; if not, write to the Free Software Foundation,\n+ * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n+ *\n+ * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n+ * or visit www.oracle.com if you need additional information or have any\n+ * questions.\n+ *\/\n+\n+package com.sun.tools.sjavac.pubapi;\n+\n+\n+import static com.sun.tools.sjavac.Util.union;\n+\n+import java.io.Serializable;\n+import java.util.ArrayList;\n+import java.util.Collection;\n+import java.util.Collections;\n+import java.util.Comparator;\n+import java.util.HashMap;\n+import java.util.HashSet;\n+import java.util.List;\n+import java.util.Map;\n+import java.util.Optional;\n+import java.util.Set;\n+import java.util.regex.Matcher;\n+import java.util.regex.Pattern;\n+import java.util.stream.Collectors;\n+import java.util.stream.Stream;\n+\n+import javax.lang.model.element.Modifier;\n+\n+import com.sun.tools.javac.util.Assert;\n+import com.sun.tools.javac.util.StringUtils;\n+\n+@SuppressWarnings(\"serial\") \/\/ Types of instance fields are not Serializable\n+public class PubApi implements Serializable {\n+\n+    private static final long serialVersionUID = 5926627347801986850L;\n+\n+    \/\/ Used to have Set here. Problem is that the objects are mutated during\n+    \/\/ javac_state loading, causing them to change hash codes. We could probably\n+    \/\/ change back to Set once javac_state loading is cleaned up.\n+    public final Map<String, PubType> types = new HashMap<>();\n+    public final Map<String, PubVar> variables = new HashMap<>();\n+    public final Map<String, PubMethod> methods = new HashMap<>();\n+    public final Map<String, PubVar> recordComponents = new HashMap<>();\n+\n+    public PubApi() {\n+    }\n+\n+    public PubApi(Collection<PubType> types,\n+                  Collection<PubVar> variables,\n+                  Collection<PubMethod> methods) {\n+        types.forEach(this::addPubType);\n+        variables.forEach(this::addPubVar);\n+        methods.forEach(this::addPubMethod);\n+    }\n+\n+    \/\/ Currently this is implemented as equality. This is far from optimal. It\n+    \/\/ should preferably make sure that all previous methods are still available\n+    \/\/ and no abstract methods are added. It should also be aware of inheritance\n+    \/\/ of course.\n+    public boolean isBackwardCompatibleWith(PubApi older) {\n+        return equals(older);\n+    }\n+\n+    private static String typeLine(PubType type) {\n+        if (type.fqName.isEmpty())\n+            throw new RuntimeException(\"empty class name \" + type);\n+        return String.format(\"TYPE %s%s\", asString(type.modifiers), type.fqName);\n+    }\n+\n+    private static String varLine(PubVar var) {\n+        return String.format(\"VAR %s%s %s%s\",\n+                             asString(var.modifiers),\n+                             TypeDesc.encodeAsString(var.type),\n+                             var.identifier,\n+                             var.getConstValue().map(v -> \" = \" + v).orElse(\"\"));\n+    }\n+\n+    private static String methodLine(PubMethod method) {\n+        return String.format(\"METHOD %s%s%s %s(%s)%s\",\n+                             asString(method.modifiers),\n+                             method.typeParams.isEmpty() ? \"\" : (\"<\" + method.typeParams.stream().map(PubApiTypeParam::asString).collect(Collectors.joining(\",\")) + \"> \"),\n+                             TypeDesc.encodeAsString(method.returnType),\n+                             method.identifier,\n+                             commaSeparated(method.paramTypes),\n+                             method.throwDecls.isEmpty()\n+                                 ? \"\"\n+                                 : \" throws \" + commaSeparated(method.throwDecls));\n+    }\n+\n+    public List<String> asListOfStrings() {\n+        List<String> lines = new ArrayList<>();\n+\n+        \/\/ Types\n+        types.values()\n+             .stream()\n+             .sorted(Comparator.comparing(PubApi::typeLine))\n+             .forEach(type -> {\n+                 lines.add(typeLine(type));\n+                 for (String subline : type.pubApi.asListOfStrings())\n+                     lines.add(\"  \" + subline);\n+             });\n+\n+        \/\/ Variables\n+        variables.values()\n+                 .stream()\n+                 .map(PubApi::varLine)\n+                 .sorted()\n+                 .forEach(lines::add);\n+\n+        \/\/ Methods\n+        methods.values()\n+               .stream()\n+               .map(PubApi::methodLine)\n+               .sorted()\n+               .forEach(lines::add);\n+\n+        return lines;\n+    }\n+\n+    @Override\n+    public boolean equals(Object obj) {\n+        if (getClass() != obj.getClass())\n+            return false;\n+        PubApi other = (PubApi) obj;\n+        return types.equals(other.types)\n+            && variables.equals(other.variables)\n+            && methods.equals(other.methods);\n+    }\n+\n+    @Override\n+    public int hashCode() {\n+        return types.keySet().hashCode()\n+             ^ variables.keySet().hashCode()\n+             ^ methods.keySet().hashCode();\n+    }\n+\n+    private static String commaSeparated(List<TypeDesc> typeDescs) {\n+        return typeDescs.stream()\n+                        .map(TypeDesc::encodeAsString)\n+                        .collect(Collectors.joining(\",\"));\n+    }\n+\n+    \/\/ Create space separated list of modifiers (with a trailing space)\n+    private static String asString(Set<Modifier> modifiers) {\n+        return modifiers.stream()\n+                        .map(mod -> mod + \" \")\n+                        .sorted()\n+                        .collect(Collectors.joining());\n+    }\n+\n+    \/\/ Used to combine class PubApis to package level PubApis\n+    public static PubApi mergeTypes(PubApi api1, PubApi api2) {\n+        Assert.check(api1.methods.isEmpty(), \"Can only merge types.\");\n+        Assert.check(api2.methods.isEmpty(), \"Can only merge types.\");\n+        Assert.check(api1.variables.isEmpty(), \"Can only merge types.\");\n+        Assert.check(api2.variables.isEmpty(), \"Can only merge types.\");\n+        PubApi merged = new PubApi();\n+        merged.types.putAll(api1.types);\n+        merged.types.putAll(api2.types);\n+        return merged;\n+    }\n+\n+\n+    \/\/ Used for line-by-line parsing\n+    private PubType lastInsertedType = null;\n+\n+    private static final String MODIFIERS = Stream.of(Modifier.values())\n+                                                  .map(Modifier::name)\n+                                                  .map(StringUtils::toLowerCase)\n+                                                  .collect(Collectors.joining(\"|\", \"(\", \")\"));\n+\n+    private static final Pattern MOD_PATTERN = Pattern.compile(\"(\" + MODIFIERS + \" )*\");\n+    private static final Pattern METHOD_PATTERN = Pattern.compile(\"(?<ret>.+?) (?<name>\\\\S+)\\\\((?<params>.*)\\\\)( throws (?<throws>.*))?\");\n+    private static final Pattern VAR_PATTERN = Pattern.compile(\"VAR (?<modifiers>(\"+MODIFIERS+\" )*)(?<type>.+?) (?<id>\\\\S+)( = (?<val>.*))?\");\n+    private static final Pattern TYPE_PATTERN = Pattern.compile(\"TYPE (?<modifiers>(\"+MODIFIERS+\" )*)(?<fullyQualified>\\\\S+)\");\n+\n+    public void appendItem(String l) {\n+        try {\n+            if (l.startsWith(\"  \")) {\n+                lastInsertedType.pubApi.appendItem(l.substring(2));\n+                return;\n+            }\n+\n+            if (l.startsWith(\"METHOD\")) {\n+                l = l.substring(\"METHOD \".length());\n+                Set<Modifier> modifiers = new HashSet<>();\n+                Matcher modMatcher = MOD_PATTERN.matcher(l);\n+                if (modMatcher.find()) {\n+                    String modifiersStr = modMatcher.group();\n+                    modifiers.addAll(parseModifiers(modifiersStr));\n+                    l = l.substring(modifiersStr.length());\n+                }\n+                List<PubApiTypeParam> typeParams = new ArrayList<>();\n+                if (l.startsWith(\"<\")) {\n+                    int closingPos = findClosingTag(l, 0);\n+                    String str = l.substring(1, closingPos);\n+                    l = l.substring(closingPos+1);\n+                    typeParams.addAll(parseTypeParams(splitOnTopLevelCommas(str)));\n+                }\n+                Matcher mm = METHOD_PATTERN.matcher(l);\n+                if (!mm.matches())\n+                    throw new AssertionError(\"Could not parse return type, identifier, parameter types or throws declaration of method: \" + l);\n+\n+                List<String> params = splitOnTopLevelCommas(mm.group(\"params\"));\n+                String th = Optional.ofNullable(mm.group(\"throws\")).orElse(\"\");\n+                List<String> throwz = splitOnTopLevelCommas(th);\n+                PubMethod m = new PubMethod(modifiers,\n+                                            typeParams,\n+                                            TypeDesc.decodeString(mm.group(\"ret\")),\n+                                            mm.group(\"name\"),\n+                                            parseTypeDescs(params),\n+                                            parseTypeDescs(throwz));\n+                addPubMethod(m);\n+                return;\n+            }\n+\n+            Matcher vm = VAR_PATTERN.matcher(l);\n+            if (vm.matches()) {\n+                addPubVar(new PubVar(parseModifiers(vm.group(\"modifiers\")),\n+                                     TypeDesc.decodeString(vm.group(\"type\")),\n+                                     vm.group(\"id\"),\n+                                     vm.group(\"val\")));\n+                return;\n+            }\n+\n+            Matcher tm = TYPE_PATTERN.matcher(l);\n+            if (tm.matches()) {\n+                addPubType(new PubType(parseModifiers(tm.group(\"modifiers\")),\n+                                       tm.group(\"fullyQualified\"),\n+                                       new PubApi()));\n+                return;\n+            }\n+\n+            throw new AssertionError(\"No matching line pattern.\");\n+        } catch (Throwable e) {\n+            throw new AssertionError(\"Could not parse API line: \" + l, e);\n+        }\n+    }\n+\n+    public void addPubType(PubType t) {\n+        types.put(t.fqName, t);\n+        lastInsertedType = t;\n+    }\n+\n+    public void addPubVar(PubVar v) {\n+        variables.put(v.identifier, v);\n+    }\n+\n+    public void addPubMethod(PubMethod m) {\n+        methods.put(m.asSignatureString(), m);\n+    }\n+\n+    private static List<TypeDesc> parseTypeDescs(List<String> strs) {\n+        return strs.stream()\n+                   .map(TypeDesc::decodeString)\n+                   .toList();\n+    }\n+\n+    private static List<PubApiTypeParam> parseTypeParams(List<String> strs) {\n+        return strs.stream().map(PubApi::parseTypeParam).toList();\n+    }\n+\n+    \/\/ Parse a type parameter string. Example input:\n+    \/\/     identifier\n+    \/\/     identifier extends Type (& Type)*\n+    private static PubApiTypeParam parseTypeParam(String typeParamString) {\n+        int extPos = typeParamString.indexOf(\" extends \");\n+        if (extPos == -1)\n+            return new PubApiTypeParam(typeParamString, Collections.emptyList());\n+        String identifier = typeParamString.substring(0, extPos);\n+        String rest = typeParamString.substring(extPos + \" extends \".length());\n+        List<TypeDesc> bounds = parseTypeDescs(splitOnTopLevelChars(rest, '&'));\n+        return new PubApiTypeParam(identifier, bounds);\n+    }\n+\n+    public Set<Modifier> parseModifiers(String modifiers) {\n+        if (modifiers == null)\n+            return Collections.emptySet();\n+        return Stream.of(modifiers.split(\" \"))\n+                     .map(String::trim)\n+                     .map(StringUtils::toUpperCase)\n+                     .filter(s -> !s.isEmpty())\n+                     .map(Modifier::valueOf)\n+                     .collect(Collectors.toSet());\n+    }\n+\n+    \/\/ Find closing tag of the opening tag at the given 'pos'.\n+    private static int findClosingTag(String l, int pos) {\n+        while (true) {\n+            pos = pos + 1;\n+            if (l.charAt(pos) == '>')\n+                return pos;\n+            if (l.charAt(pos) == '<')\n+                pos = findClosingTag(l, pos);\n+        }\n+    }\n+\n+    public List<String> splitOnTopLevelCommas(String s) {\n+        return splitOnTopLevelChars(s, ',');\n+    }\n+\n+    public static List<String> splitOnTopLevelChars(String s, char split) {\n+        if (s.isEmpty())\n+            return Collections.emptyList();\n+        List<String> result = new ArrayList<>();\n+        StringBuilder buf = new StringBuilder();\n+        int depth = 0;\n+        for (char c : s.toCharArray()) {\n+            if (c == split && depth == 0) {\n+                result.add(buf.toString().trim());\n+                buf = new StringBuilder();\n+            } else {\n+                if (c == '<') depth++;\n+                if (c == '>') depth--;\n+                buf.append(c);\n+            }\n+        }\n+        result.add(buf.toString().trim());\n+        return result;\n+    }\n+\n+    public boolean isEmpty() {\n+        return types.isEmpty() && variables.isEmpty() && methods.isEmpty();\n+    }\n+\n+    \/\/ Used for descriptive debug messages when figuring out what triggers\n+    \/\/ recompilation.\n+    public List<String> diff(PubApi prevApi) {\n+        return diff(\"\", prevApi);\n+    }\n+    private List<String> diff(String scopePrefix, PubApi prevApi) {\n+\n+        List<String> diffs = new ArrayList<>();\n+\n+        for (String typeKey : union(types.keySet(), prevApi.types.keySet())) {\n+            PubType type = types.get(typeKey);\n+            PubType prevType = prevApi.types.get(typeKey);\n+            if (prevType == null) {\n+                diffs.add(\"Type \" + scopePrefix + typeKey + \" was added\");\n+            } else if (type == null) {\n+                diffs.add(\"Type \" + scopePrefix + typeKey + \" was removed\");\n+            } else {\n+                \/\/ Check modifiers\n+                if (!type.modifiers.equals(prevType.modifiers)) {\n+                    diffs.add(\"Modifiers for type \" + scopePrefix + typeKey\n+                            + \" changed from \" + prevType.modifiers + \" to \"\n+                            + type.modifiers);\n+                }\n+\n+                \/\/ Recursively check types pub API\n+                diffs.addAll(type.pubApi.diff(prevType.pubApi));\n+            }\n+        }\n+\n+        for (String varKey : union(variables.keySet(), prevApi.variables.keySet())) {\n+            PubVar var = variables.get(varKey);\n+            PubVar prevVar = prevApi.variables.get(varKey);\n+            if (prevVar == null) {\n+                diffs.add(\"Variable \" + scopePrefix + varKey + \" was added\");\n+            } else if (var == null) {\n+                diffs.add(\"Variable \" + scopePrefix + varKey + \" was removed\");\n+            } else {\n+                if (!var.modifiers.equals(prevVar.modifiers)) {\n+                    diffs.add(\"Modifiers for var \" + scopePrefix + varKey\n+                            + \" changed from \" + prevVar.modifiers + \" to \"\n+                            + var.modifiers);\n+                }\n+                if (!var.type.equals(prevVar.type)) {\n+                    diffs.add(\"Type of \" + scopePrefix + varKey\n+                            + \" changed from \" + prevVar.type + \" to \"\n+                            + var.type);\n+                }\n+                if (!var.getConstValue().equals(prevVar.getConstValue())) {\n+                    diffs.add(\"Const value of \" + scopePrefix + varKey\n+                            + \" changed from \" + prevVar.getConstValue().orElse(\"<none>\")\n+                            + \" to \" + var.getConstValue().orElse(\"<none>\"));\n+                }\n+            }\n+        }\n+\n+        for (String methodKey : union(methods.keySet(), prevApi.methods.keySet())) {\n+            PubMethod method = methods.get(methodKey);\n+            PubMethod prevMethod = prevApi.methods.get(methodKey);\n+            if (prevMethod == null) {\n+                diffs.add(\"Method \" + scopePrefix + methodKey + \" was added\");\n+            } else if (method == null) {\n+                diffs.add(\"Method \" + scopePrefix + methodKey + \" was removed\");\n+            } else {\n+                if (!method.modifiers.equals(prevMethod.modifiers)) {\n+                    diffs.add(\"Modifiers for method \" + scopePrefix + methodKey\n+                            + \" changed from \" + prevMethod.modifiers + \" to \"\n+                            + method.modifiers);\n+                }\n+                if (!method.typeParams.equals(prevMethod.typeParams)) {\n+                    diffs.add(\"Type parameters for method \" + scopePrefix\n+                            + methodKey + \" changed from \" + prevMethod.typeParams\n+                            + \" to \" + method.typeParams);\n+                }\n+                if (!method.throwDecls.equals(prevMethod.throwDecls)) {\n+                    diffs.add(\"Throw decl for method \" + scopePrefix + methodKey\n+                            + \" changed from \" + prevMethod.throwDecls + \" to \"\n+                            + \" to \" + method.throwDecls);\n+                }\n+            }\n+        }\n+\n+        return diffs;\n+    }\n+\n+    public String toString() {\n+        return String.format(\"%s[types: %s, variables: %s, methods: %s]\",\n+                             getClass().getSimpleName(),\n+                             types.values(),\n+                             variables.values(),\n+                             methods.values());\n+    }\n+}\n","filename":"src\/jdk.compiler\/share\/classes\/com\/sun\/tools\/sjavac\/pubapi\/PubApi.java","additions":437,"deletions":0,"binary":false,"changes":437,"status":"added"},{"patch":"@@ -0,0 +1,75 @@\n+\/*\n+ * Copyright (c) 2015, 2021, Oracle and\/or its affiliates. All rights reserved.\n+ * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+ *\n+ * This code is free software; you can redistribute it and\/or modify it\n+ * under the terms of the GNU General Public License version 2 only, as\n+ * published by the Free Software Foundation.  Oracle designates this\n+ * particular file as subject to the \"Classpath\" exception as provided\n+ * by Oracle in the LICENSE file that accompanied this code.\n+ *\n+ * This code is distributed in the hope that it will be useful, but WITHOUT\n+ * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+ * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+ * version 2 for more details (a copy is included in the LICENSE file that\n+ * accompanied this code).\n+ *\n+ * You should have received a copy of the GNU General Public License version\n+ * 2 along with this work; if not, write to the Free Software Foundation,\n+ * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n+ *\n+ * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n+ * or visit www.oracle.com if you need additional information or have any\n+ * questions.\n+ *\/\n+\n+package com.sun.tools.sjavac.pubapi;\n+\n+import java.io.Serializable;\n+import java.util.List;\n+import java.util.stream.Collectors;\n+\n+@SuppressWarnings(\"serial\") \/\/ Types of instance fields are not Serializable\n+public class PubApiTypeParam implements Serializable {\n+\n+    private static final long serialVersionUID = 8899204612014329162L;\n+\n+    private final String identifier;\n+    private final List<TypeDesc> bounds;\n+\n+    public PubApiTypeParam(String identifier, List<TypeDesc> bounds) {\n+        this.identifier = identifier;\n+        this.bounds = bounds;\n+    }\n+\n+    @Override\n+    public boolean equals(Object obj) {\n+        if (getClass() != obj.getClass())\n+            return false;\n+        PubApiTypeParam other = (PubApiTypeParam) obj;\n+        return identifier.equals(other.identifier)\n+            && bounds.equals(other.bounds);\n+    }\n+\n+    @Override\n+    public int hashCode() {\n+        return identifier.hashCode() ^ bounds.hashCode();\n+    }\n+\n+    public String asString() {\n+        if (bounds.isEmpty())\n+            return identifier;\n+        String boundsStr = bounds.stream()\n+                                 .map(TypeDesc::encodeAsString)\n+                                 .collect(Collectors.joining(\" & \"));\n+        return identifier + \" extends \" + boundsStr;\n+    }\n+\n+    @Override\n+    public String toString() {\n+        return String.format(\"%s[id: %s, bounds: %s]\",\n+                             getClass().getSimpleName(),\n+                             identifier,\n+                             bounds);\n+    }\n+}\n","filename":"src\/jdk.compiler\/share\/classes\/com\/sun\/tools\/sjavac\/pubapi\/PubApiTypeParam.java","additions":75,"deletions":0,"binary":false,"changes":75,"status":"added"},{"patch":"@@ -0,0 +1,117 @@\n+\/*\n+ * Copyright (c) 2014, 2021, Oracle and\/or its affiliates. All rights reserved.\n+ * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+ *\n+ * This code is free software; you can redistribute it and\/or modify it\n+ * under the terms of the GNU General Public License version 2 only, as\n+ * published by the Free Software Foundation.  Oracle designates this\n+ * particular file as subject to the \"Classpath\" exception as provided\n+ * by Oracle in the LICENSE file that accompanied this code.\n+ *\n+ * This code is distributed in the hope that it will be useful, but WITHOUT\n+ * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+ * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+ * version 2 for more details (a copy is included in the LICENSE file that\n+ * accompanied this code).\n+ *\n+ * You should have received a copy of the GNU General Public License version\n+ * 2 along with this work; if not, write to the Free Software Foundation,\n+ * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n+ *\n+ * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n+ * or visit www.oracle.com if you need additional information or have any\n+ * questions.\n+ *\/\n+\n+package com.sun.tools.sjavac.pubapi;\n+\n+import java.io.Serializable;\n+import java.util.List;\n+import java.util.Set;\n+import java.util.stream.Collectors;\n+\n+import javax.lang.model.element.Modifier;\n+\n+@SuppressWarnings(\"serial\") \/\/ Types of instance fields are not Serializable\n+public class PubMethod implements Serializable {\n+\n+    private static final long serialVersionUID = -7813050194553446243L;\n+\n+    Set<Modifier> modifiers;\n+    List<PubApiTypeParam> typeParams;\n+    TypeDesc returnType;\n+    String identifier;\n+    List<TypeDesc> paramTypes;\n+    List<TypeDesc> throwDecls;\n+\n+    public PubMethod(Set<Modifier> modifiers,\n+                     List<PubApiTypeParam> typeParams,\n+                     TypeDesc returnType,\n+                     String identifier,\n+                     List<TypeDesc> paramTypes,\n+                     List<TypeDesc> throwDecls) {\n+        this.modifiers = modifiers;\n+        this.typeParams = typeParams;\n+        this.returnType = returnType;\n+        this.identifier = identifier;\n+        this.paramTypes = paramTypes;\n+        this.throwDecls = throwDecls;\n+    }\n+\n+    \/\/ We need to include return type and type parameters to be sure to have\n+    \/\/ different values for different methods. (A method can be overloaded with\n+    \/\/ the only difference being the upper bound of the return type.)\n+    public String asSignatureString() {\n+        StringBuilder sb = new StringBuilder();\n+\n+        \/\/ <A extends String, Serializable, B extends List>\n+        if (typeParams.size() > 0) {\n+            sb.append(typeParams.stream()\n+                                .map(PubApiTypeParam::asString)\n+                                .collect(Collectors.joining(\",\", \"<\", \"> \")));\n+        }\n+        sb.append(TypeDesc.encodeAsString(returnType));\n+        sb.append(\" \");\n+        sb.append(identifier);\n+        sb.append(\"(\");\n+        sb.append(paramTypes.stream()\n+                            .map(TypeDesc::encodeAsString)\n+                            .collect(Collectors.joining(\",\")));\n+        sb.append(\")\");\n+        return sb.toString();\n+    }\n+\n+    @Override\n+    public boolean equals(Object obj) {\n+        if (getClass() != obj.getClass())\n+            return false;\n+        PubMethod other = (PubMethod) obj;\n+        return modifiers.equals(other.modifiers)\n+            && typeParams.equals(other.typeParams)\n+            && returnType.equals(other.returnType)\n+            && identifier.equals(other.identifier)\n+            && paramTypes.equals(other.paramTypes)\n+            && throwDecls.equals(other.throwDecls);\n+    }\n+\n+    @Override\n+    public int hashCode() {\n+        return modifiers.hashCode()\n+             ^ typeParams.hashCode()\n+             ^ returnType.hashCode()\n+             ^ identifier.hashCode()\n+             ^ paramTypes.hashCode()\n+             ^ throwDecls.hashCode();\n+    }\n+\n+    public String toString() {\n+        return String.format(\"%s[modifiers: %s, typeParams: %s, retType: %s, identifier: %s, params: %s, throws: %s]\",\n+                             getClass().getSimpleName(),\n+                             modifiers,\n+                             typeParams,\n+                             returnType,\n+                             identifier,\n+                             paramTypes,\n+                             throwDecls);\n+    }\n+}\n","filename":"src\/jdk.compiler\/share\/classes\/com\/sun\/tools\/sjavac\/pubapi\/PubMethod.java","additions":117,"deletions":0,"binary":false,"changes":117,"status":"added"},{"patch":"@@ -0,0 +1,77 @@\n+\/*\n+ * Copyright (c) 2014, 2021, Oracle and\/or its affiliates. All rights reserved.\n+ * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+ *\n+ * This code is free software; you can redistribute it and\/or modify it\n+ * under the terms of the GNU General Public License version 2 only, as\n+ * published by the Free Software Foundation.  Oracle designates this\n+ * particular file as subject to the \"Classpath\" exception as provided\n+ * by Oracle in the LICENSE file that accompanied this code.\n+ *\n+ * This code is distributed in the hope that it will be useful, but WITHOUT\n+ * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+ * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+ * version 2 for more details (a copy is included in the LICENSE file that\n+ * accompanied this code).\n+ *\n+ * You should have received a copy of the GNU General Public License version\n+ * 2 along with this work; if not, write to the Free Software Foundation,\n+ * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n+ *\n+ * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n+ * or visit www.oracle.com if you need additional information or have any\n+ * questions.\n+ *\/\n+\n+package com.sun.tools.sjavac.pubapi;\n+\n+import java.io.Serializable;\n+import java.util.Set;\n+\n+import javax.lang.model.element.Modifier;\n+\n+@SuppressWarnings(\"serial\") \/\/ Types of instance fields are not Serializable\n+public class PubType implements Serializable {\n+\n+    private static final long serialVersionUID = -7423416049253889793L;\n+\n+    public final Set<Modifier> modifiers;\n+    public final String fqName;\n+    public final PubApi pubApi;\n+\n+    public PubType(Set<Modifier> modifiers,\n+                   String fqName,\n+                   PubApi pubApi) {\n+        this.modifiers = modifiers;\n+        this.fqName = fqName;\n+        this.pubApi = pubApi;\n+    }\n+\n+    public String getFqName() {\n+        return fqName.toString();\n+    }\n+\n+    @Override\n+    public boolean equals(Object obj) {\n+        if (getClass() != obj.getClass())\n+            return false;\n+        PubType other = (PubType) obj;\n+        return modifiers.equals(other.modifiers)\n+            && fqName.equals(other.fqName)\n+            && pubApi.equals(other.pubApi);\n+    }\n+\n+    @Override\n+    public int hashCode() {\n+        return modifiers.hashCode() ^ fqName.hashCode() ^ pubApi.hashCode();\n+    }\n+\n+    @Override\n+    public String toString() {\n+        return String.format(\"%s[modifiers: %s, fqName: %s, pubApi: %s]\",\n+                             getClass().getSimpleName(),\n+                             modifiers,\n+                             fqName,\n+                             pubApi);\n+    }\n+}\n","filename":"src\/jdk.compiler\/share\/classes\/com\/sun\/tools\/sjavac\/pubapi\/PubType.java","additions":77,"deletions":0,"binary":false,"changes":77,"status":"added"},{"patch":"@@ -0,0 +1,89 @@\n+\/*\n+ * Copyright (c) 2014, 2021, Oracle and\/or its affiliates. All rights reserved.\n+ * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+ *\n+ * This code is free software; you can redistribute it and\/or modify it\n+ * under the terms of the GNU General Public License version 2 only, as\n+ * published by the Free Software Foundation.  Oracle designates this\n+ * particular file as subject to the \"Classpath\" exception as provided\n+ * by Oracle in the LICENSE file that accompanied this code.\n+ *\n+ * This code is distributed in the hope that it will be useful, but WITHOUT\n+ * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+ * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+ * version 2 for more details (a copy is included in the LICENSE file that\n+ * accompanied this code).\n+ *\n+ * You should have received a copy of the GNU General Public License version\n+ * 2 along with this work; if not, write to the Free Software Foundation,\n+ * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n+ *\n+ * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n+ * or visit www.oracle.com if you need additional information or have any\n+ * questions.\n+ *\/\n+\n+package com.sun.tools.sjavac.pubapi;\n+\n+import java.io.Serializable;\n+import java.util.Optional;\n+import java.util.Set;\n+\n+import javax.lang.model.element.Modifier;\n+\n+@SuppressWarnings(\"serial\") \/\/ Types of instance fields are not Serializable\n+public class PubVar implements Serializable {\n+\n+    private static final long serialVersionUID = 5806536061153374575L;\n+\n+    public final Set<Modifier> modifiers;\n+    public final TypeDesc type;\n+    public final String identifier;\n+    private final String constValue;\n+\n+    public PubVar(Set<Modifier> modifiers,\n+                  TypeDesc type,\n+                  String identifier,\n+                  String constValue) {\n+        this.modifiers = modifiers;\n+        this.type = type;\n+        this.identifier = identifier;\n+        this.constValue = constValue;\n+    }\n+\n+    public String getIdentifier() {\n+        return identifier;\n+    }\n+\n+    @Override\n+    public boolean equals(Object obj) {\n+        if (getClass() != obj.getClass())\n+            return false;\n+        PubVar other = (PubVar) obj;\n+        return modifiers.equals(other.modifiers)\n+            && type.equals(other.type)\n+            && identifier.equals(other.identifier)\n+            && getConstValue().equals(other.getConstValue());\n+    }\n+\n+    @Override\n+    public int hashCode() {\n+        return modifiers.hashCode()\n+             ^ type.hashCode()\n+             ^ identifier.hashCode()\n+             ^ getConstValue().hashCode();\n+    }\n+\n+    public String toString() {\n+        return String.format(\"%s[modifiers: %s, type: %s, identifier: %s, constValue: %s]\",\n+                             getClass().getSimpleName(),\n+                             modifiers,\n+                             type,\n+                             identifier,\n+                             constValue);\n+    }\n+\n+    public Optional<String> getConstValue() {\n+        return Optional.ofNullable(constValue);\n+    }\n+}\n","filename":"src\/jdk.compiler\/share\/classes\/com\/sun\/tools\/sjavac\/pubapi\/PubVar.java","additions":89,"deletions":0,"binary":false,"changes":89,"status":"added"},{"patch":"@@ -0,0 +1,60 @@\n+\/*\n+ * Copyright (c) 2014, 2015, Oracle and\/or its affiliates. All rights reserved.\n+ * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+ *\n+ * This code is free software; you can redistribute it and\/or modify it\n+ * under the terms of the GNU General Public License version 2 only, as\n+ * published by the Free Software Foundation.  Oracle designates this\n+ * particular file as subject to the \"Classpath\" exception as provided\n+ * by Oracle in the LICENSE file that accompanied this code.\n+ *\n+ * This code is distributed in the hope that it will be useful, but WITHOUT\n+ * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+ * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+ * version 2 for more details (a copy is included in the LICENSE file that\n+ * accompanied this code).\n+ *\n+ * You should have received a copy of the GNU General Public License version\n+ * 2 along with this work; if not, write to the Free Software Foundation,\n+ * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n+ *\n+ * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n+ * or visit www.oracle.com if you need additional information or have any\n+ * questions.\n+ *\/\n+\n+package com.sun.tools.sjavac.pubapi;\n+\n+import java.io.Serializable;\n+\n+import javax.lang.model.type.TypeKind;\n+\n+public class ReferenceTypeDesc extends TypeDesc implements Serializable {\n+\n+    private static final long serialVersionUID = 3357616754544796372L;\n+\n+    \/\/ Example: \"java.util.Vector<java.lang.String>\"\n+    String javaType;\n+\n+    public ReferenceTypeDesc(String javaType) {\n+        super(TypeKind.DECLARED);\n+        this.javaType = javaType;\n+    }\n+\n+    @Override\n+    public boolean equals(Object obj) {\n+        if (!super.equals(obj))\n+            return false;\n+        return javaType.equals(((ReferenceTypeDesc) obj).javaType);\n+    }\n+\n+    @Override\n+    public int hashCode() {\n+        return super.hashCode() ^ javaType.hashCode();\n+    }\n+\n+    @Override\n+    public String toString() {\n+        return String.format(\"%s[type: %s]\", getClass().getSimpleName(), javaType);\n+    }\n+}\n","filename":"src\/jdk.compiler\/share\/classes\/com\/sun\/tools\/sjavac\/pubapi\/ReferenceTypeDesc.java","additions":60,"deletions":0,"binary":false,"changes":60,"status":"added"},{"patch":"@@ -0,0 +1,140 @@\n+\/*\n+ * Copyright (c) 2014, 2019, Oracle and\/or its affiliates. All rights reserved.\n+ * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+ *\n+ * This code is free software; you can redistribute it and\/or modify it\n+ * under the terms of the GNU General Public License version 2 only, as\n+ * published by the Free Software Foundation.  Oracle designates this\n+ * particular file as subject to the \"Classpath\" exception as provided\n+ * by Oracle in the LICENSE file that accompanied this code.\n+ *\n+ * This code is distributed in the hope that it will be useful, but WITHOUT\n+ * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+ * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+ * version 2 for more details (a copy is included in the LICENSE file that\n+ * accompanied this code).\n+ *\n+ * You should have received a copy of the GNU General Public License version\n+ * 2 along with this work; if not, write to the Free Software Foundation,\n+ * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n+ *\n+ * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n+ * or visit www.oracle.com if you need additional information or have any\n+ * questions.\n+ *\/\n+\n+package com.sun.tools.sjavac.pubapi;\n+\n+import java.io.Serializable;\n+\n+import javax.lang.model.type.ArrayType;\n+import javax.lang.model.type.DeclaredType;\n+import javax.lang.model.type.ErrorType;\n+import javax.lang.model.type.NoType;\n+import javax.lang.model.type.PrimitiveType;\n+import javax.lang.model.type.TypeKind;\n+import javax.lang.model.type.TypeMirror;\n+import javax.lang.model.type.TypeVariable;\n+import javax.lang.model.type.TypeVisitor;\n+import javax.lang.model.util.SimpleTypeVisitor14;\n+\n+import com.sun.tools.javac.code.Type.ClassType;\n+import com.sun.tools.javac.util.DefinedBy;\n+import com.sun.tools.javac.util.DefinedBy.Api;\n+import com.sun.tools.javac.util.StringUtils;\n+\n+public abstract class TypeDesc implements Serializable {\n+\n+    private static final long serialVersionUID = -8201634143915519172L;\n+\n+    TypeKind typeKind;\n+\n+    public TypeDesc(TypeKind typeKind) {\n+        this.typeKind = typeKind;\n+    }\n+\n+    public static TypeDesc decodeString(String s) {\n+        s = s.trim();\n+        if (s.endsWith(\"[]\")) {\n+            String componentPart = s.substring(0, s.length()-2);\n+            return new ArrayTypeDesc(decodeString(componentPart));\n+        }\n+\n+        if (s.startsWith(\"#\"))\n+            return new TypeVarTypeDesc(s.substring(1));\n+\n+        if (s.matches(\"boolean|byte|char|double|float|int|long|short|void\")) {\n+            TypeKind tk = TypeKind.valueOf(StringUtils.toUpperCase(s));\n+            return new PrimitiveTypeDesc(tk);\n+        }\n+\n+        return new ReferenceTypeDesc(s);\n+    }\n+\n+    public static String encodeAsString(TypeDesc td) {\n+        if (td.typeKind.isPrimitive() || td.typeKind == TypeKind.VOID)\n+            return StringUtils.toLowerCase(td.typeKind.toString());\n+\n+        if (td.typeKind == TypeKind.ARRAY)\n+            return encodeAsString(((ArrayTypeDesc) td).compTypeDesc) + \"[]\";\n+\n+        if (td.typeKind == TypeKind.TYPEVAR)\n+            return \"#\" + ((TypeVarTypeDesc) td).identifier;\n+\n+        if (td.typeKind == TypeKind.DECLARED)\n+            return ((ReferenceTypeDesc) td).javaType.toString();\n+\n+        throw new AssertionError(\"Unhandled type: \" + td.typeKind);\n+    }\n+\n+    public static TypeDesc fromType(TypeMirror type) {\n+        TypeVisitor<TypeDesc, Void> v = new SimpleTypeVisitor14<TypeDesc, Void>() {\n+            @Override @DefinedBy(Api.LANGUAGE_MODEL)\n+            public TypeDesc visitArray(ArrayType t, Void p) {\n+                return new ArrayTypeDesc(t.getComponentType().accept(this, p));\n+            }\n+\n+            @Override @DefinedBy(Api.LANGUAGE_MODEL)\n+            public TypeDesc visitDeclared(DeclaredType t, Void p) {\n+                return new ReferenceTypeDesc(((ClassType) t).tsym.flatName().toString());\n+            }\n+\n+            @Override @DefinedBy(Api.LANGUAGE_MODEL)\n+            public TypeDesc visitNoType(NoType t, Void p) {\n+                return new PrimitiveTypeDesc(TypeKind.VOID);\n+            }\n+\n+            @Override @DefinedBy(Api.LANGUAGE_MODEL)\n+            public TypeDesc visitTypeVariable(TypeVariable t, Void p) {\n+                return new TypeVarTypeDesc(t.toString());\n+            }\n+\n+            @Override @DefinedBy(Api.LANGUAGE_MODEL)\n+            public TypeDesc visitPrimitive(PrimitiveType t, Void p) {\n+                return new PrimitiveTypeDesc(t.getKind());\n+            }\n+\n+            @Override @DefinedBy(Api.LANGUAGE_MODEL)\n+            public TypeDesc visitError(ErrorType t, Void p) {\n+                return new ReferenceTypeDesc(\"<error type>\");\n+            }\n+        };\n+\n+        TypeDesc td = v.visit(type);\n+        if (td == null)\n+            throw new AssertionError(\"Unhandled type mirror: \" + type + \" (\" + type.getClass() + \")\");\n+        return td;\n+    }\n+\n+    @Override\n+    public boolean equals(Object obj) {\n+        if (getClass() != obj.getClass())\n+            return false;\n+        return typeKind.equals(((TypeDesc) obj).typeKind);\n+    }\n+\n+    @Override\n+    public int hashCode() {\n+        return typeKind.hashCode();\n+    }\n+}\n","filename":"src\/jdk.compiler\/share\/classes\/com\/sun\/tools\/sjavac\/pubapi\/TypeDesc.java","additions":140,"deletions":0,"binary":false,"changes":140,"status":"added"},{"patch":"@@ -0,0 +1,61 @@\n+\/*\n+ * Copyright (c) 2014, 2015, Oracle and\/or its affiliates. All rights reserved.\n+ * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+ *\n+ * This code is free software; you can redistribute it and\/or modify it\n+ * under the terms of the GNU General Public License version 2 only, as\n+ * published by the Free Software Foundation.  Oracle designates this\n+ * particular file as subject to the \"Classpath\" exception as provided\n+ * by Oracle in the LICENSE file that accompanied this code.\n+ *\n+ * This code is distributed in the hope that it will be useful, but WITHOUT\n+ * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+ * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+ * version 2 for more details (a copy is included in the LICENSE file that\n+ * accompanied this code).\n+ *\n+ * You should have received a copy of the GNU General Public License version\n+ * 2 along with this work; if not, write to the Free Software Foundation,\n+ * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n+ *\n+ * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n+ * or visit www.oracle.com if you need additional information or have any\n+ * questions.\n+ *\/\n+\n+package com.sun.tools.sjavac.pubapi;\n+\n+import java.io.Serializable;\n+\n+import javax.lang.model.type.TypeKind;\n+\n+public class TypeVarTypeDesc extends TypeDesc implements Serializable {\n+\n+    private static final long serialVersionUID = 3357616754544796373L;\n+\n+    String identifier; \/\/ Example: \"T\"\n+\n+    public TypeVarTypeDesc(String identifier) {\n+        super(TypeKind.TYPEVAR);\n+        this.identifier = identifier;\n+    }\n+\n+    @Override\n+    public boolean equals(Object obj) {\n+        if (!super.equals(obj))\n+            return false;\n+        return identifier.equals(((TypeVarTypeDesc) obj).identifier);\n+    }\n+\n+    @Override\n+    public int hashCode() {\n+        return super.hashCode() ^ identifier.hashCode();\n+    }\n+\n+    @Override\n+    public String toString() {\n+        return String.format(\"%s[identifier: %s]\",\n+                             getClass().getSimpleName(),\n+                             identifier);\n+    }\n+}\n","filename":"src\/jdk.compiler\/share\/classes\/com\/sun\/tools\/sjavac\/pubapi\/TypeVarTypeDesc.java","additions":61,"deletions":0,"binary":false,"changes":61,"status":"added"},{"patch":"@@ -0,0 +1,65 @@\n+\/*\n+ * Copyright (c) 2014, 2021, Oracle and\/or its affiliates. All rights reserved.\n+ * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+ *\n+ * This code is free software; you can redistribute it and\/or modify it\n+ * under the terms of the GNU General Public License version 2 only, as\n+ * published by the Free Software Foundation.  Oracle designates this\n+ * particular file as subject to the \"Classpath\" exception as provided\n+ * by Oracle in the LICENSE file that accompanied this code.\n+ *\n+ * This code is distributed in the hope that it will be useful, but WITHOUT\n+ * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+ * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+ * version 2 for more details (a copy is included in the LICENSE file that\n+ * accompanied this code).\n+ *\n+ * You should have received a copy of the GNU General Public License version\n+ * 2 along with this work; if not, write to the Free Software Foundation,\n+ * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n+ *\n+ * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n+ * or visit www.oracle.com if you need additional information or have any\n+ * questions.\n+ *\/\n+\n+package com.sun.tools.sjavac.server;\n+\n+import java.io.Serializable;\n+import java.net.URI;\n+import java.util.HashMap;\n+import java.util.Map;\n+import java.util.Set;\n+\n+import com.sun.tools.javac.main.Main.Result;\n+import com.sun.tools.sjavac.pubapi.PubApi;\n+\n+\/**\n+ *\n+ *  <p><b>This is NOT part of any supported API.\n+ *  If you write code that depends on this, you do so at your own risk.\n+ *  This code and its internal interfaces are subject to change or\n+ *  deletion without notice.<\/b>\n+ *\/\n+@SuppressWarnings(\"serial\") \/\/ Types of instance fields are not Serializable\n+public class CompilationSubResult implements Serializable {\n+\n+    static final long serialVersionUID = 46739181113L;\n+\n+    public Result result;\n+    public Map<String, Set<URI>> packageArtifacts = new HashMap<>();\n+    public Map<String, Map<String, Set<String>>> packageDependencies = new HashMap<>();\n+    public Map<String, Map<String, Set<String>>> packageCpDependencies = new HashMap<>();\n+    public Map<String, PubApi> packagePubapis = new HashMap<>();\n+    public Map<String, PubApi> dependencyPubapis = new HashMap<>();\n+    public String stdout = \"\";\n+    public String stderr = \"\";\n+\n+    public CompilationSubResult(Result result) {\n+        this.result = result;\n+    }\n+\n+    public void setResult(Result result) {\n+        this.result = result;\n+    }\n+}\n","filename":"src\/jdk.compiler\/share\/classes\/com\/sun\/tools\/sjavac\/server\/CompilationSubResult.java","additions":65,"deletions":0,"binary":false,"changes":65,"status":"added"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2014, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2014, 2016, Oracle and\/or its affiliates. All rights reserved.\n@@ -26,1 +26,4 @@\n-package javacserver.server;\n+package com.sun.tools.sjavac.server;\n+\n+import com.sun.tools.javac.main.Main.Result;\n+import com.sun.tools.sjavac.Log;\n@@ -31,3 +34,0 @@\n-import javacserver.Log;\n-import javacserver.Result;\n-\n","filename":"src\/jdk.compiler\/share\/classes\/com\/sun\/tools\/sjavac\/server\/IdleResetSjavac.java","additions":5,"deletions":5,"binary":false,"changes":10,"previous_filename":"make\/langtools\/tools\/javacserver\/server\/IdleResetSjavac.java","status":"renamed"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2012, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2012, 2019, Oracle and\/or its affiliates. All rights reserved.\n@@ -26,1 +26,1 @@\n-package javacserver.server;\n+package com.sun.tools.sjavac.server;\n@@ -38,2 +38,3 @@\n-import javacserver.Log;\n-import javacserver.client.PortFileInaccessibleException;\n+import com.sun.tools.javac.util.Assert;\n+import com.sun.tools.sjavac.Log;\n+import com.sun.tools.sjavac.client.PortFileInaccessibleException;\n@@ -153,0 +154,1 @@\n+        Assert.check(containsPortInfo);\n@@ -160,0 +162,1 @@\n+        Assert.check(containsPortInfo);\n@@ -167,0 +170,1 @@\n+        Assert.check(lock != null);\n","filename":"src\/jdk.compiler\/share\/classes\/com\/sun\/tools\/sjavac\/server\/PortFile.java","additions":8,"deletions":4,"binary":false,"changes":12,"previous_filename":"make\/langtools\/tools\/javacserver\/server\/PortFile.java","status":"renamed"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2014, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2014, 2016, Oracle and\/or its affiliates. All rights reserved.\n@@ -26,1 +26,3 @@\n-package javacserver.server;\n+package com.sun.tools.sjavac.server;\n+\n+import com.sun.tools.sjavac.Log;\n@@ -32,2 +34,0 @@\n-import javacserver.Log;\n-\n","filename":"src\/jdk.compiler\/share\/classes\/com\/sun\/tools\/sjavac\/server\/PortFileMonitor.java","additions":4,"deletions":4,"binary":false,"changes":8,"previous_filename":"make\/langtools\/tools\/javacserver\/server\/PortFileMonitor.java","status":"renamed"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2014, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2014, 2016, Oracle and\/or its affiliates. All rights reserved.\n@@ -26,1 +26,5 @@\n-package javacserver.server;\n+package com.sun.tools.sjavac.server;\n+\n+import com.sun.tools.javac.main.Main;\n+import com.sun.tools.sjavac.Log;\n+import com.sun.tools.sjavac.Util;\n@@ -34,5 +38,1 @@\n-import javacserver.Log;\n-import javacserver.Result;\n-import javacserver.Util;\n-\n-import static javacserver.server.SjavacServer.LINE_TYPE_RC;\n+import static com.sun.tools.sjavac.server.SjavacServer.LINE_TYPE_RC;\n@@ -104,1 +104,1 @@\n-            Result rc = sjavac.compile(args);\n+            Main.Result rc = sjavac.compile(args);\n","filename":"src\/jdk.compiler\/share\/classes\/com\/sun\/tools\/sjavac\/server\/RequestHandler.java","additions":8,"deletions":8,"binary":false,"changes":16,"previous_filename":"make\/langtools\/tools\/javacserver\/server\/RequestHandler.java","status":"renamed"},{"patch":"@@ -0,0 +1,98 @@\n+\/*\n+ * Copyright (c) 2014, 2016, Oracle and\/or its affiliates. All rights reserved.\n+ * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+ *\n+ * This code is free software; you can redistribute it and\/or modify it\n+ * under the terms of the GNU General Public License version 2 only, as\n+ * published by the Free Software Foundation.  Oracle designates this\n+ * particular file as subject to the \"Classpath\" exception as provided\n+ * by Oracle in the LICENSE file that accompanied this code.\n+ *\n+ * This code is distributed in the hope that it will be useful, but WITHOUT\n+ * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+ * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+ * version 2 for more details (a copy is included in the LICENSE file that\n+ * accompanied this code).\n+ *\n+ * You should have received a copy of the GNU General Public License version\n+ * 2 along with this work; if not, write to the Free Software Foundation,\n+ * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n+ *\n+ * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n+ * or visit www.oracle.com if you need additional information or have any\n+ * questions.\n+ *\/\n+\n+package com.sun.tools.sjavac.server;\n+\n+import java.io.FileWriter;\n+import java.io.FilterOutputStream;\n+import java.io.FilterWriter;\n+import java.io.IOException;\n+import java.io.PrintStream;\n+import java.lang.Thread.UncaughtExceptionHandler;\n+\n+import com.sun.tools.javac.main.Main;\n+import com.sun.tools.javac.main.Main.Result;\n+import com.sun.tools.sjavac.Log;\n+import com.sun.tools.sjavac.Log.Level;\n+import com.sun.tools.sjavac.server.log.LazyInitFileLog;\n+import com.sun.tools.sjavac.server.log.LoggingOutputStream;\n+\n+import static com.sun.tools.sjavac.Log.Level.ERROR;\n+import static com.sun.tools.sjavac.Log.Level.INFO;\n+\n+\/**\n+ *  <p><b>This is NOT part of any supported API.\n+ *  If you write code that depends on this, you do so at your own risk.\n+ *  This code and its internal interfaces are subject to change or\n+ *  deletion without notice.<\/b>\n+ *\/\n+public class ServerMain {\n+\n+    \/\/ For logging server internal (non request specific) errors.\n+    private static LazyInitFileLog errorLog;\n+\n+    public static int run(String[] args) {\n+\n+        \/\/ Under normal operation, all logging messages generated server-side\n+        \/\/ are due to compilation requests. These logging messages should\n+        \/\/ be relayed back to the requesting client rather than written to the\n+        \/\/ server log. The only messages that should be written to the server\n+        \/\/ log (in production mode) should be errors,\n+        Log.setLogForCurrentThread(errorLog = new LazyInitFileLog(\"server.log\"));\n+        Log.setLogLevel(ERROR); \/\/ should be set to ERROR.\n+\n+        \/\/ Make sure no exceptions go under the radar\n+        Thread.setDefaultUncaughtExceptionHandler((t, e) -> {\n+            Log.setLogForCurrentThread(errorLog);\n+            Log.error(e);\n+        });\n+\n+        \/\/ Inevitably someone will try to print messages using System.{out,err}.\n+        \/\/ Make sure this output also ends up in the log.\n+        System.setOut(new PrintStream(new LoggingOutputStream(System.out, INFO, \"[stdout] \")));\n+        System.setErr(new PrintStream(new LoggingOutputStream(System.err, ERROR, \"[stderr] \")));\n+\n+        \/\/ Any options other than --startserver?\n+        if (args.length > 1) {\n+            Log.error(\"When spawning a background server, only a single --startserver argument is allowed.\");\n+            return Result.CMDERR.exitCode;\n+        }\n+\n+        int exitCode;\n+        try {\n+            SjavacServer server = new SjavacServer(args[0]);\n+            exitCode = server.startServer();\n+        } catch (IOException | InterruptedException ex) {\n+            ex.printStackTrace();\n+            exitCode = Result.ERROR.exitCode;\n+        }\n+\n+        return exitCode;\n+    }\n+\n+    public static LazyInitFileLog getErrorLog() {\n+        return errorLog;\n+    }\n+}\n","filename":"src\/jdk.compiler\/share\/classes\/com\/sun\/tools\/sjavac\/server\/ServerMain.java","additions":98,"deletions":0,"binary":false,"changes":98,"status":"added"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2014, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2014, 2016, Oracle and\/or its affiliates. All rights reserved.\n@@ -26,1 +26,5 @@\n-package javacserver.server;\n+package com.sun.tools.sjavac.server;\n+\n+import com.sun.tools.javac.main.Main.Result;\n+\n+import java.io.Writer;\n@@ -28,1 +32,0 @@\n-import javacserver.Result;\n","filename":"src\/jdk.compiler\/share\/classes\/com\/sun\/tools\/sjavac\/server\/Sjavac.java","additions":6,"deletions":3,"binary":false,"changes":9,"previous_filename":"make\/langtools\/tools\/javacserver\/server\/Sjavac.java","status":"renamed"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2011, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2011, 2016, Oracle and\/or its affiliates. All rights reserved.\n@@ -26,1 +26,1 @@\n-package javacserver.server;\n+package com.sun.tools.sjavac.server;\n@@ -29,0 +29,1 @@\n+import java.io.FileWriter;\n@@ -30,0 +31,2 @@\n+import java.io.PrintStream;\n+import java.io.PrintWriter;\n@@ -40,5 +43,7 @@\n-import javacserver.Log;\n-import javacserver.Result;\n-import javacserver.Util;\n-import javacserver.comp.PooledSjavac;\n-import javacserver.comp.SjavacImpl;\n+import com.sun.tools.javac.main.Main;\n+import com.sun.tools.javac.main.Main.Result;\n+import com.sun.tools.sjavac.Log;\n+import com.sun.tools.sjavac.Util;\n+import com.sun.tools.sjavac.client.PortFileInaccessibleException;\n+import com.sun.tools.sjavac.comp.PooledSjavac;\n+import com.sun.tools.sjavac.comp.SjavacImpl;\n","filename":"src\/jdk.compiler\/share\/classes\/com\/sun\/tools\/sjavac\/server\/SjavacServer.java","additions":12,"deletions":7,"binary":false,"changes":19,"previous_filename":"make\/langtools\/tools\/javacserver\/server\/SjavacServer.java","status":"renamed"},{"patch":"@@ -0,0 +1,56 @@\n+\/*\n+ * Copyright (c) 2012, 2014, Oracle and\/or its affiliates. All rights reserved.\n+ * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+ *\n+ * This code is free software; you can redistribute it and\/or modify it\n+ * under the terms of the GNU General Public License version 2 only, as\n+ * published by the Free Software Foundation.  Oracle designates this\n+ * particular file as subject to the \"Classpath\" exception as provided\n+ * by Oracle in the LICENSE file that accompanied this code.\n+ *\n+ * This code is distributed in the hope that it will be useful, but WITHOUT\n+ * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+ * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+ * version 2 for more details (a copy is included in the LICENSE file that\n+ * accompanied this code).\n+ *\n+ * You should have received a copy of the GNU General Public License version\n+ * 2 along with this work; if not, write to the Free Software Foundation,\n+ * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n+ *\n+ * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n+ * or visit www.oracle.com if you need additional information or have any\n+ * questions.\n+ *\/\n+\n+\/**\n+ * A utility class used to report information about the system\n+ * where the javac server is running.\n+ *\n+ * <p><b>This is NOT part of any supported API.\n+ * If you write code that depends on this, you do so at your own\n+ * risk.  This code and its internal interfaces are subject to change\n+ * or deletion without notice.<\/b><\/p>\n+ *\/\n+package com.sun.tools.sjavac.server;\n+\n+import java.io.Serializable;\n+\n+\/**\n+ *  <p><b>This is NOT part of any supported API.\n+ *  If you write code that depends on this, you do so at your own risk.\n+ *  This code and its internal interfaces are subject to change or\n+ *  deletion without notice.<\/b>\n+ *\/\n+public class SysInfo implements Serializable {\n+\n+    static final long serialVersionUID = -3096346807579L;\n+\n+    public int numCores;\n+    public long maxMemory;\n+\n+    public SysInfo(int nc, long mm) {\n+        numCores = nc;\n+        maxMemory = mm;\n+    }\n+}\n","filename":"src\/jdk.compiler\/share\/classes\/com\/sun\/tools\/sjavac\/server\/SysInfo.java","additions":56,"deletions":0,"binary":false,"changes":56,"status":"added"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2014, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2014, Oracle and\/or its affiliates. All rights reserved.\n@@ -26,1 +26,1 @@\n-package javacserver.server;\n+package com.sun.tools.sjavac.server;\n","filename":"src\/jdk.compiler\/share\/classes\/com\/sun\/tools\/sjavac\/server\/Terminable.java","additions":2,"deletions":2,"binary":false,"changes":4,"previous_filename":"make\/langtools\/tools\/javacserver\/server\/Terminable.java","status":"renamed"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2016, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2016, Oracle and\/or its affiliates. All rights reserved.\n@@ -26,1 +26,3 @@\n-package javacserver.server.log;\n+package com.sun.tools.sjavac.server.log;\n+\n+import com.sun.tools.sjavac.Log;\n@@ -35,2 +37,0 @@\n-import javacserver.Log;\n-\n","filename":"src\/jdk.compiler\/share\/classes\/com\/sun\/tools\/sjavac\/server\/log\/LazyInitFileLog.java","additions":4,"deletions":4,"binary":false,"changes":8,"previous_filename":"make\/langtools\/tools\/javacserver\/server\/log\/LazyInitFileLog.java","status":"renamed"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2016, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2016, Oracle and\/or its affiliates. All rights reserved.\n@@ -26,1 +26,3 @@\n-package javacserver.server.log;\n+package com.sun.tools.sjavac.server.log;\n+\n+import com.sun.tools.sjavac.Log;\n@@ -33,2 +35,0 @@\n-import javacserver.Log;\n-\n","filename":"src\/jdk.compiler\/share\/classes\/com\/sun\/tools\/sjavac\/server\/log\/LoggingOutputStream.java","additions":4,"deletions":4,"binary":false,"changes":8,"previous_filename":"make\/langtools\/tools\/javacserver\/server\/log\/LoggingOutputStream.java","status":"renamed"},{"patch":"@@ -22,1 +22,1 @@\n-.\\\" Automatically generated by Pandoc 2.19.2\n+.\\\" Automatically generated by Pandoc 2.3.1\n@@ -24,15 +24,1 @@\n-.\\\" Define V font for inline verbatim, using C font in formats\n-.\\\" that render this, and otherwise B font.\n-.ie \"\\f[CB]x\\f[R]\"x\" \\{\\\n-. ftr V B\n-. ftr VI BI\n-. ftr VB B\n-. ftr VBI BI\n-.\\}\n-.el \\{\\\n-. ftr V CR\n-. ftr VI CI\n-. ftr VB CB\n-. ftr VBI CBI\n-.\\}\n-.TH \"JAVAC\" \"1\" \"2023\" \"JDK 20-ea\" \"JDK Commands\"\n+.TH \"JAVAC\" \"1\" \"2023\" \"JDK 20\\-ea\" \"JDK Commands\"\n@@ -42,1 +28,1 @@\n-javac - read Java declarations and compile them into class files\n+javac \\- read Java declarations and compile them into class files\n@@ -45,2 +31,1 @@\n-\\f[V]javac\\f[R] [\\f[I]options\\f[R]]\n-[\\f[I]sourcefiles-or-classnames\\f[R]]\n+\\f[CB]javac\\f[R] [\\f[I]options\\f[R]] [\\f[I]sourcefiles\\-or\\-classnames\\f[R]]\n@@ -48,2 +33,4 @@\n-\\f[I]options\\f[R]\n-Command-line options.\n+.B \\f[I]options\\f[R]\n+Command\\-line options.\n+.RS\n+.RE\n@@ -51,2 +38,2 @@\n-\\f[I]sourcefiles-or-classnames\\f[R]\n-Source files to be compiled (for example, \\f[V]Shape.java\\f[R]) or the\n+.B \\f[I]sourcefiles\\-or\\-classnames\\f[R]\n+Source files to be compiled (for example, \\f[CB]Shape.java\\f[R]) or the\n@@ -54,1 +41,3 @@\n-(for example, \\f[V]geometry.MyShape\\f[R]).\n+(for example, \\f[CB]geometry.MyShape\\f[R]).\n+.RS\n+.RE\n@@ -57,1 +46,1 @@\n-The \\f[V]javac\\f[R] command reads \\f[I]source files\\f[R] that contain\n+The \\f[CB]javac\\f[R] command reads \\f[I]source files\\f[R] that contain\n@@ -62,2 +51,2 @@\n-The \\f[V]javac\\f[R] command can also \\f[B]process annotations\\f[R] in\n-Java source files and classes.\n+The \\f[CB]javac\\f[R] command can also \\f[B]process annotations\\f[R] in Java\n+source files and classes.\n@@ -65,2 +54,2 @@\n-Source files must have a file name extension of \\f[V].java\\f[R].\n-Class files have a file name extension of \\f[V].class\\f[R].\n+Source files must have a file name extension of \\f[CB]\\&.java\\f[R].\n+Class files have a file name extension of \\f[CB]\\&.class\\f[R].\n@@ -69,3 +58,3 @@\n-For example, a class called \\f[V]Shape\\f[R] would be declared in a\n-source file called \\f[V]Shape.java\\f[R], and compiled into a class file\n-called \\f[V]Shape.class\\f[R].\n+For example, a class called \\f[CB]Shape\\f[R] would be declared in a source\n+file called \\f[CB]Shape.java\\f[R], and compiled into a class file called\n+\\f[CB]Shape.class\\f[R].\n@@ -73,1 +62,1 @@\n-There are two ways to specify source files to \\f[V]javac\\f[R]:\n+There are two ways to specify source files to \\f[CB]javac\\f[R]:\n@@ -79,2 +68,2 @@\n-\\f[B]\\f[VB]\\[at]\\f[B]\\f[BI]filename\\f[B]\\f[R] option on the command line\n-to specify an \\f[I]argument file\\f[R] that lists their file names.\n+\\f[B]\\f[BC]\\@\\f[B]\\f[BI]filename\\f[B]\\f[R] option on the command line to\n+specify an \\f[I]argument file\\f[R] that lists their file names.\n@@ -82,2 +71,2 @@\n-\\f[B]Command-Line Argument Files\\f[R] for a description of\n-\\f[V]javac\\f[R] argument files.\n+\\f[B]Command\\-Line Argument Files\\f[R] for a description of\n+\\f[CB]javac\\f[R] argument files.\n@@ -87,1 +76,1 @@\n-\\f[V]javac\\f[R] will compile the files together, as a group, and will\n+\\f[CB]javac\\f[R] will compile the files together, as a group, and will\n@@ -91,1 +80,1 @@\n-\\f[V]javac\\f[R] expects that source files are arranged in one or more\n+\\f[CB]javac\\f[R] expects that source files are arranged in one or more\n@@ -95,1 +84,1 @@\n-To compile a source file, \\f[V]javac\\f[R] needs to find the declaration\n+To compile a source file, \\f[CB]javac\\f[R] needs to find the declaration\n@@ -98,1 +87,1 @@\n-This lets \\f[V]javac\\f[R] check that the code has the right to access\n+This lets \\f[CB]javac\\f[R] check that the code has the right to access\n@@ -101,1 +90,1 @@\n-explicitly, you can use command-line options to tell \\f[V]javac\\f[R]\n+explicitly, you can use command\\-line options to tell \\f[CB]javac\\f[R]\n@@ -104,1 +93,1 @@\n-to tell \\f[V]javac\\f[R] where to search for the corresponding class\n+to tell \\f[CB]javac\\f[R] where to search for the corresponding class\n@@ -106,4 +95,4 @@\n-The options, which all have names ending in \\[dq]path\\[dq], are\n-described in \\f[B]Standard Options\\f[R], and further described in\n-\\f[B]Configuring a Compilation\\f[R] and \\f[B]Searching for Module,\n-Package and Type Declarations\\f[R].\n+The options, which all have names ending in \"path\", are described in\n+\\f[B]Standard Options\\f[R], and further described in \\f[B]Configuring a\n+Compilation\\f[R] and \\f[B]Searching for Module, Package and Type\n+Declarations\\f[R].\n@@ -111,1 +100,1 @@\n-By default, \\f[V]javac\\f[R] compiles each source file to a class file in\n+By default, \\f[CB]javac\\f[R] compiles each source file to a class file in\n@@ -114,1 +103,1 @@\n-with the \\f[B]\\f[VB]-d\\f[B]\\f[R] option.\n+with the \\f[B]\\f[BC]\\-d\\f[B]\\f[R] option.\n@@ -116,2 +105,2 @@\n-Command-line \\f[B]options\\f[R] and \\f[B]environment variables\\f[R] also\n-control how \\f[V]javac\\f[R] performs various tasks:\n+Command\\-line \\f[B]options\\f[R] and \\f[B]environment variables\\f[R] also\n+control how \\f[CB]javac\\f[R] performs various tasks:\n@@ -125,2 +114,2 @@\n-Checking for problems in \\f[V]javadoc\\f[R] comments\n-(\\f[V]\/** ... *\/\\f[R]).\n+Checking for problems in \\f[CB]javadoc\\f[R] comments\n+(\\f[CB]\/**\\ ...\\ *\/\\f[R]).\n@@ -130,1 +119,1 @@\n-Upgrading and patching modules in the compile-time environment.\n+Upgrading and patching modules in the compile\\-time environment.\n@@ -132,1 +121,1 @@\n-\\f[V]javac\\f[R] supports \\f[B]Compiling for Earlier Releases Of The\n+\\f[CB]javac\\f[R] supports \\f[B]Compiling for Earlier Releases Of The\n@@ -137,2 +126,2 @@\n-\\f[V]javac\\f[R] provides \\f[B]standard options\\f[R], and \\f[B]extra\n-options\\f[R] that are either non-standard or are for advanced use.\n+\\f[CB]javac\\f[R] provides \\f[B]standard options\\f[R], and \\f[B]extra\n+options\\f[R] that are either non\\-standard or are for advanced use.\n@@ -144,1 +133,1 @@\n-If the option begins with a single dash (\\f[V]-\\f[R]) the argument\n+If the option begins with a single dash (\\f[CB]\\-\\f[R]) the argument\n@@ -146,3 +135,3 @@\n-with a colon (\\f[V]:\\f[R]) or whitespace, depending on the option.\n-If the option begins with a double dash (\\f[V]--\\f[R]), the argument may\n-be separated either by whitespace or by an equals (\\f[V]=\\f[R])\n+with a colon (\\f[CB]:\\f[R]) or whitespace, depending on the option.\n+If the option begins with a double dash (\\f[CB]\\-\\-\\f[R]), the argument\n+may be separated either by whitespace or by an equals (\\f[CB]=\\f[R])\n@@ -154,5 +143,5 @@\n--Aname=\\[dq]J. Duke\\[dq]\n--proc:only\n--d myDirectory\n---module-version 3\n---module-version=3\n+\\-Aname=\"J.\\ Duke\"\n+\\-proc:only\n+\\-d\\ myDirectory\n+\\-\\-module\\-version\\ 3\n+\\-\\-module\\-version=3\n@@ -165,3 +154,3 @@\n-\\f[V];\\f[R] on Windows, or colon \\f[V]:\\f[R] on other systems.)\n-Depending on the option, the file system locations may be directories,\n-JAR files or JMOD files.\n+\\f[CB];\\f[R] on Windows, or colon \\f[CB]:\\f[R] on other systems.) Depending\n+on the option, the file system locations may be directories, JAR files\n+or JMOD files.\n@@ -170,1 +159,1 @@\n-\\f[V]\\[at]\\f[R]\\f[I]filename\\f[R]\n+.B \\f[CB]\\@\\f[R]\\f[I]filename\\f[R]\n@@ -172,4 +161,4 @@\n-To shorten or simplify the \\f[V]javac\\f[R] command, you can specify one\n-or more files that contain arguments to the \\f[V]javac\\f[R] command\n-(except \\f[B]\\f[VB]-J\\f[B]\\f[R] options).\n-This lets you to create \\f[V]javac\\f[R] commands of any length on any\n+To shorten or simplify the \\f[CB]javac\\f[R] command, you can specify one\n+or more files that contain arguments to the \\f[CB]javac\\f[R] command\n+(except \\f[B]\\f[BC]\\-J\\f[B]\\f[R] options).\n+This lets you to create \\f[CB]javac\\f[R] commands of any length on any\n@@ -177,1 +166,3 @@\n-See \\f[B]Command-Line Argument Files\\f[R].\n+See \\f[B]Command\\-Line Argument Files\\f[R].\n+.RS\n+.RE\n@@ -179,1 +170,1 @@\n-\\f[V]-A\\f[R]\\f[I]key\\f[R][\\f[V]=\\f[R]\\f[I]value\\f[R]]\n+.B \\f[CB]\\-A\\f[R]\\f[I]key\\f[R][\\f[CB]=\\f[R]\\f[I]value\\f[R]]\n@@ -181,1 +172,1 @@\n-These options are not interpreted by \\f[V]javac\\f[R] directly, but are\n+These options are not interpreted by \\f[CB]javac\\f[R] directly, but are\n@@ -184,1 +175,3 @@\n-dot (\\f[V].\\f[R]).\n+dot (\\f[CB]\\&.\\f[R]).\n+.RS\n+.RE\n@@ -186,1 +179,1 @@\n-\\f[V]--add-modules\\f[R] \\f[I]module\\f[R]\\f[V],\\f[R]\\f[I]module\\f[R]\n+.B \\f[CB]\\-\\-add\\-modules\\f[R] \\f[I]module\\f[R]\\f[CB],\\f[R]\\f[I]module\\f[R]\n@@ -189,1 +182,3 @@\n-\\f[V]ALL-MODULE-PATH\\f[R].\n+\\f[CB]ALL\\-MODULE\\-PATH\\f[R].\n+.RS\n+.RE\n@@ -191,1 +186,1 @@\n-\\f[V]--boot-class-path\\f[R] \\f[I]path\\f[R] or \\f[V]-bootclasspath\\f[R] \\f[I]path\\f[R]\n+.B \\f[CB]\\-\\-boot\\-class\\-path\\f[R] \\f[I]path\\f[R] or \\f[CB]\\-bootclasspath\\f[R] \\f[I]path\\f[R]\n@@ -197,2 +192,2 @@\n-As applicable, see the descriptions in \\f[B]\\f[VB]--release\\f[B]\\f[R],\n-\\f[B]\\f[VB]-source\\f[B]\\f[R], or \\f[B]\\f[VB]-target\\f[B]\\f[R] for\n+As applicable, see the descriptions in \\f[B]\\f[BC]\\-\\-release\\f[B]\\f[R],\n+\\f[B]\\f[BC]\\-source\\f[B]\\f[R], or \\f[B]\\f[BC]\\-target\\f[B]\\f[R] for\n@@ -200,1 +195,1 @@\n-For JDK 9 or later, see \\f[B]\\f[VB]--system\\f[B]\\f[R].\n+For JDK 9 or later, see \\f[B]\\f[BC]\\-\\-system\\f[B]\\f[R].\n@@ -203,1 +198,1 @@\n-\\f[V]--class-path\\f[R] \\f[I]path\\f[R], \\f[V]-classpath\\f[R] \\f[I]path\\f[R], or \\f[V]-cp\\f[R] \\f[I]path\\f[R]\n+.B \\f[CB]\\-\\-class\\-path\\f[R] \\f[I]path\\f[R], \\f[CB]\\-classpath\\f[R] \\f[I]path\\f[R], or \\f[CB]\\-cp\\f[R] \\f[I]path\\f[R]\n@@ -205,1 +200,1 @@\n-This class path overrides the user class path in the \\f[V]CLASSPATH\\f[R]\n+This class path overrides the user class path in the \\f[CB]CLASSPATH\\f[R]\n@@ -209,1 +204,1 @@\n-If \\f[V]--class-path\\f[R], \\f[V]-classpath\\f[R], or \\f[V]-cp\\f[R] are\n+If \\f[CB]\\-\\-class\\-path\\f[R], \\f[CB]\\-classpath\\f[R], or \\f[CB]\\-cp\\f[R] are\n@@ -211,1 +206,1 @@\n-\\f[V]CLASSPATH\\f[R] environment variable, if that is set, or else the\n+\\f[CB]CLASSPATH\\f[R] environment variable, if that is set, or else the\n@@ -215,1 +210,1 @@\n-\\f[B]\\f[VB]--source-path\\f[B]\\f[R] or -sourcepath\\[ga] option is not\n+\\f[B]\\f[BC]\\-\\-source\\-path\\f[B]\\f[R] or \\-sourcepath` option is not\n@@ -218,1 +213,1 @@\n-If the \\f[B]\\f[VB]-processorpath\\f[B]\\f[R] option is not specified, then\n+If the \\f[B]\\f[BC]\\-processorpath\\f[B]\\f[R] option is not specified, then\n@@ -222,1 +217,1 @@\n-\\f[V]-d\\f[R] \\f[I]directory\\f[R]\n+.B \\f[CB]\\-d\\f[R] \\f[I]directory\\f[R]\n@@ -225,3 +220,3 @@\n-If a class is part of a package, then \\f[V]javac\\f[R] puts the class\n-file in a subdirectory that reflects the module name (if appropriate)\n-and package name.\n+If a class is part of a package, then \\f[CB]javac\\f[R] puts the class file\n+in a subdirectory that reflects the module name (if appropriate) and\n+package name.\n@@ -232,1 +227,1 @@\n-If the \\f[V]-d\\f[R] option is not specified, then \\f[V]javac\\f[R] puts\n+If the \\f[CB]\\-d\\f[R] option is not specified, then \\f[CB]javac\\f[R] puts\n@@ -250,1 +245,1 @@\n-\\f[V]--class-path\\f[R] option or one of its alternate forms.\n+\\f[CB]\\-\\-class\\-path\\f[R] option or one of its alternate forms.\n@@ -253,1 +248,1 @@\n-\\f[V]-deprecation\\f[R]\n+.B \\f[CB]\\-deprecation\\f[R]\n@@ -256,1 +251,1 @@\n-Without the \\f[V]-deprecation\\f[R] option, \\f[V]javac\\f[R] shows a\n+Without the \\f[CB]\\-deprecation\\f[R] option, \\f[CB]javac\\f[R] shows a\n@@ -259,2 +254,4 @@\n-The \\f[V]-deprecation\\f[R] option is shorthand for\n-\\f[V]-Xlint:deprecation\\f[R].\n+The \\f[CB]\\-deprecation\\f[R] option is shorthand for\n+\\f[CB]\\-Xlint:deprecation\\f[R].\n+.RS\n+.RE\n@@ -262,1 +259,1 @@\n-\\f[V]--enable-preview\\f[R]\n+.B \\f[CB]\\-\\-enable\\-preview\\f[R]\n@@ -264,2 +261,4 @@\n-Used in conjunction with either \\f[B]\\f[VB]-source\\f[B]\\f[R] or\n-\\f[B]\\f[VB]--release\\f[B]\\f[R].\n+Used in conjunction with either \\f[B]\\f[BC]\\-source\\f[B]\\f[R] or\n+\\f[B]\\f[BC]\\-\\-release\\f[B]\\f[R].\n+.RS\n+.RE\n@@ -267,4 +266,4 @@\n-\\f[V]-encoding\\f[R] \\f[I]encoding\\f[R]\n-Specifies character encoding used by source files, such as EUC-JP and\n-UTF-8.\n-If the \\f[V]-encoding\\f[R] option is not specified, then the platform\n+.B \\f[CB]\\-encoding\\f[R] \\f[I]encoding\\f[R]\n+Specifies character encoding used by source files, such as EUC\\-JP and\n+UTF\\-8.\n+If the \\f[CB]\\-encoding\\f[R] option is not specified, then the platform\n@@ -272,0 +271,2 @@\n+.RS\n+.RE\n@@ -273,1 +274,1 @@\n-\\f[V]-endorseddirs\\f[R] \\f[I]directories\\f[R]\n+.B \\f[CB]\\-endorseddirs\\f[R] \\f[I]directories\\f[R]\n@@ -279,2 +280,2 @@\n-As applicable, see the descriptions in \\f[B]\\f[VB]--release\\f[B]\\f[R],\n-\\f[B]\\f[VB]-source\\f[B]\\f[R], or \\f[B]\\f[VB]-target\\f[B]\\f[R] for\n+As applicable, see the descriptions in \\f[B]\\f[BC]\\-\\-release\\f[B]\\f[R],\n+\\f[B]\\f[BC]\\-source\\f[B]\\f[R], or \\f[B]\\f[BC]\\-target\\f[B]\\f[R] for\n@@ -284,1 +285,1 @@\n-\\f[V]-extdirs\\f[R] \\f[I]directories\\f[R]\n+.B \\f[CB]\\-extdirs\\f[R] \\f[I]directories\\f[R]\n@@ -286,3 +287,2 @@\n-\\f[V]directories\\f[R] is a list of directories, separated by the\n-platform path separator (\\f[V];\\f[R] on Windows, and \\f[V]:\\f[R]\n-otherwise).\n+\\f[CB]directories\\f[R] is a list of directories, separated by the platform\n+path separator (\\f[CB];\\f[R] on Windows, and \\f[CB]:\\f[R] otherwise).\n@@ -300,2 +300,2 @@\n-As applicable, see the descriptions in \\f[B]\\f[VB]--release\\f[B]\\f[R],\n-\\f[B]\\f[VB]-source\\f[B]\\f[R], or \\f[B]\\f[VB]-target\\f[B]\\f[R] for\n+As applicable, see the descriptions in \\f[B]\\f[BC]\\-\\-release\\f[B]\\f[R],\n+\\f[B]\\f[BC]\\-source\\f[B]\\f[R], or \\f[B]\\f[BC]\\-target\\f[B]\\f[R] for\n@@ -305,1 +305,1 @@\n-\\f[V]-g\\f[R]\n+.B \\f[CB]\\-g\\f[R]\n@@ -308,0 +308,2 @@\n+.RS\n+.RE\n@@ -309,1 +311,1 @@\n-\\f[V]-g:\\f[R][\\f[V]lines\\f[R], \\f[V]vars\\f[R], \\f[V]source\\f[R]]\n+.B \\f[CB]\\-g:\\f[R][\\f[CB]lines\\f[R], \\f[CB]vars\\f[R], \\f[CB]source\\f[R]]\n@@ -311,1 +313,1 @@\n-comma-separated list of keywords.\n+comma\\-separated list of keywords.\n@@ -315,1 +317,1 @@\n-\\f[V]lines\\f[R]\n+.B \\f[CB]lines\\f[R]\n@@ -317,0 +319,2 @@\n+.RS\n+.RE\n@@ -318,1 +322,1 @@\n-\\f[V]vars\\f[R]\n+.B \\f[CB]vars\\f[R]\n@@ -320,0 +324,2 @@\n+.RS\n+.RE\n@@ -321,1 +327,1 @@\n-\\f[V]source\\f[R]\n+.B \\f[CB]source\\f[R]\n@@ -323,0 +329,2 @@\n+.RS\n+.RE\n@@ -325,1 +333,1 @@\n-\\f[V]-g:none\\f[R]\n+.B \\f[CB]\\-g:none\\f[R]\n@@ -327,0 +335,2 @@\n+.RS\n+.RE\n@@ -328,1 +338,1 @@\n-\\f[V]-h\\f[R] \\f[I]directory\\f[R]\n+.B \\f[CB]\\-h\\f[R] \\f[I]directory\\f[R]\n@@ -334,1 +344,1 @@\n-annotated with the \\f[B]\\f[VB]java.lang.annotation.Native\\f[B]\\f[R]\n+annotated with the \\f[B]\\f[BC]java.lang.annotation.Native\\f[B]\\f[R]\n@@ -343,1 +353,1 @@\n-\\f[V]--help\\f[R], \\f[V]-help\\f[R] or \\f[V]-?\\f[R]\n+.B \\f[CB]\\-\\-help\\f[R], \\f[CB]\\-help\\f[R] or \\f[CB]\\-?\\f[R]\n@@ -345,0 +355,2 @@\n+.RS\n+.RE\n@@ -346,1 +358,1 @@\n-\\f[V]--help-extra\\f[R] or \\f[V]-X\\f[R]\n+.B \\f[CB]\\-\\-help\\-extra\\f[R] or \\f[CB]\\-X\\f[R]\n@@ -348,0 +360,2 @@\n+.RS\n+.RE\n@@ -349,2 +363,4 @@\n-\\f[V]--help-lint\\f[R]\n-Prints the supported keys for the \\f[V]-Xlint\\f[R] option.\n+.B \\f[CB]\\-\\-help\\-lint\\f[R]\n+Prints the supported keys for the \\f[CB]\\-Xlint\\f[R] option.\n+.RS\n+.RE\n@@ -352,1 +368,1 @@\n-\\f[V]-implicit:\\f[R][\\f[V]none\\f[R], \\f[V]class\\f[R]]\n+.B \\f[CB]\\-implicit:\\f[R][\\f[CB]none\\f[R], \\f[CB]class\\f[R]]\n@@ -357,1 +373,1 @@\n-\\f[V]-implicit:class\\f[R] --- Automatically generates class files.\n+\\f[CB]\\-implicit:class\\f[R] \\-\\-\\- Automatically generates class files.\n@@ -359,1 +375,1 @@\n-\\f[V]-implicit:none\\f[R] --- Suppresses class file generation.\n+\\f[CB]\\-implicit:none\\f[R] \\-\\-\\- Suppresses class file generation.\n@@ -365,1 +381,1 @@\n-The warning is not issued when the \\f[V]-implicit\\f[R] option is\n+The warning is not issued when the \\f[CB]\\-implicit\\f[R] option is\n@@ -370,1 +386,1 @@\n-\\f[V]-J\\f[R]\\f[I]option\\f[R]\n+.B \\f[CB]\\-J\\f[R]\\f[I]option\\f[R]\n@@ -373,1 +389,1 @@\n-For example, \\f[V]-J-Xms48m\\f[R] sets the startup memory to 48 MB.\n+For example, \\f[CB]\\-J\\-Xms48m\\f[R] sets the startup memory to 48 MB.\n@@ -376,4 +392,4 @@\n-\\f[B]Note:\\f[R] The \\f[V]CLASSPATH\\f[R] environment variable,\n-\\f[V]-classpath\\f[R] option, \\f[V]-bootclasspath\\f[R] option, and\n-\\f[V]-extdirs\\f[R] option do not specify the classes used to run\n-\\f[V]javac\\f[R].\n+\\f[B]Note:\\f[R] The \\f[CB]CLASSPATH\\f[R] environment variable,\n+\\f[CB]\\-classpath\\f[R] option, \\f[CB]\\-bootclasspath\\f[R] option, and\n+\\f[CB]\\-extdirs\\f[R] option do not specify the classes used to run\n+\\f[CB]javac\\f[R].\n@@ -383,1 +399,1 @@\n-\\f[V]-J\\f[R] option to pass options through to the underlying Java\n+\\f[CB]\\-J\\f[R] option to pass options through to the underlying Java\n@@ -387,1 +403,1 @@\n-\\f[V]--limit-modules\\f[R] \\f[I]module\\f[R]\\f[V],\\f[R]\\f[I]module\\f[R]*\n+.B \\f[CB]\\-\\-limit\\-modules\\f[R] \\f[I]module\\f[R]\\f[CB],\\f[R]\\f[I]module\\f[R]*\n@@ -389,0 +405,2 @@\n+.RS\n+.RE\n@@ -390,1 +408,1 @@\n-\\f[V]--module\\f[R] \\f[I]module-name\\f[R] (\\f[V],\\f[R]\\f[I]module-name\\f[R])* or \\f[V]-m\\f[R] \\f[I]module-name\\f[R] (\\f[V],\\f[R]\\f[I]module-name\\f[R])*\n+.B \\f[CB]\\-\\-module\\f[R] \\f[I]module\\-name\\f[R] (\\f[CB],\\f[R]\\f[I]module\\-name\\f[R])* or \\f[CB]\\-m\\f[R] \\f[I]module\\-name\\f[R] (\\f[CB],\\f[R]\\f[I]module\\-name\\f[R])*\n@@ -393,0 +411,2 @@\n+.RS\n+.RE\n@@ -394,1 +414,1 @@\n-\\f[V]--module-path\\f[R] \\f[I]path\\f[R] or \\f[V]-p\\f[R] \\f[I]path\\f[R]\n+.B \\f[CB]\\-\\-module\\-path\\f[R] \\f[I]path\\f[R] or \\f[CB]\\-p\\f[R] \\f[I]path\\f[R]\n@@ -396,0 +416,2 @@\n+.RS\n+.RE\n@@ -397,1 +419,1 @@\n-\\f[V]--module-source-path\\f[R] \\f[I]module-source-path\\f[R]\n+.B \\f[CB]\\-\\-module\\-source\\-path\\f[R] \\f[I]module\\-source\\-path\\f[R]\n@@ -401,0 +423,2 @@\n+.RS\n+.RE\n@@ -402,1 +426,1 @@\n-\\f[V]--module-version\\f[R] \\f[I]version\\f[R]\n+.B \\f[CB]\\-\\-module\\-version\\f[R] \\f[I]version\\f[R]\n@@ -404,0 +428,2 @@\n+.RS\n+.RE\n@@ -405,1 +431,1 @@\n-\\f[V]-nowarn\\f[R]\n+.B \\f[CB]\\-nowarn\\f[R]\n@@ -407,1 +433,3 @@\n-This option operates the same as the \\f[V]-Xlint:none\\f[R] option.\n+This option operates the same as the \\f[CB]\\-Xlint:none\\f[R] option.\n+.RS\n+.RE\n@@ -409,1 +437,1 @@\n-\\f[V]-parameters\\f[R]\n+.B \\f[CB]\\-parameters\\f[R]\n@@ -413,1 +441,1 @@\n-\\f[V]java.lang.reflect.Executable.getParameters\\f[R] from the Reflection\n+\\f[CB]java.lang.reflect.Executable.getParameters\\f[R] from the Reflection\n@@ -415,0 +443,2 @@\n+.RS\n+.RE\n@@ -416,1 +446,1 @@\n-\\f[V]-proc:\\f[R][\\f[V]none\\f[R], \\f[V]only\\f[R]]\n+.B \\f[CB]\\-proc:\\f[R][\\f[CB]none\\f[R], \\f[CB]only\\f[R]]\n@@ -418,1 +448,1 @@\n-\\f[V]-proc:none\\f[R] means that compilation takes place without\n+\\f[CB]\\-proc:none\\f[R] means that compilation takes place without\n@@ -420,1 +450,1 @@\n-\\f[V]-proc:only\\f[R] means that only annotation processing is done,\n+\\f[CB]\\-proc:only\\f[R] means that only annotation processing is done,\n@@ -422,0 +452,2 @@\n+.RS\n+.RE\n@@ -423,1 +455,1 @@\n-\\f[V]-processor\\f[R] \\f[I]class1\\f[R][\\f[V],\\f[R]\\f[I]class2\\f[R]\\f[V],\\f[R]\\f[I]class3\\f[R]...]\n+.B \\f[CB]\\-processor\\f[R] \\f[I]class1\\f[R][\\f[CB],\\f[R]\\f[I]class2\\f[R]\\f[CB],\\f[R]\\f[I]class3\\f[R]...]\n@@ -426,0 +458,2 @@\n+.RS\n+.RE\n@@ -427,1 +461,1 @@\n-\\f[V]--processor-module-path\\f[R] \\f[I]path\\f[R]\n+.B \\f[CB]\\-\\-processor\\-module\\-path\\f[R] \\f[I]path\\f[R]\n@@ -429,0 +463,2 @@\n+.RS\n+.RE\n@@ -430,1 +466,1 @@\n-\\f[V]--processor-path\\f[R] \\f[I]path\\f[R] or \\f[V]-processorpath\\f[R] \\f[I]path\\f[R]\n+.B \\f[CB]\\-\\-processor\\-path\\f[R] \\f[I]path\\f[R] or \\f[CB]\\-processorpath\\f[R] \\f[I]path\\f[R]\n@@ -434,0 +470,2 @@\n+.RS\n+.RE\n@@ -435,1 +473,1 @@\n-\\f[V]-profile\\f[R] \\f[I]profile\\f[R]\n+.B \\f[CB]\\-profile\\f[R] \\f[I]profile\\f[R]\n@@ -441,2 +479,2 @@\n-As applicable, see the descriptions in \\f[B]\\f[VB]--release\\f[B]\\f[R],\n-\\f[B]\\f[VB]-source\\f[B]\\f[R], or \\f[B]\\f[VB]-target\\f[B]\\f[R] for\n+As applicable, see the descriptions in \\f[B]\\f[BC]\\-\\-release\\f[B]\\f[R],\n+\\f[B]\\f[BC]\\-source\\f[B]\\f[R], or \\f[B]\\f[BC]\\-target\\f[B]\\f[R] for\n@@ -446,1 +484,1 @@\n-\\f[V]--release\\f[R] \\f[I]release\\f[R]\n+.B \\f[CB]\\-\\-release\\f[R] \\f[I]release\\f[R]\n@@ -454,3 +492,3 @@\n-The supported values of \\f[I]release\\f[R] are the current Java SE\n-release and a limited number of previous releases, detailed in the\n-command-line help.\n+The supported values of \\f[I]release\\f[R] are the current Java SE release\n+and a limited number of previous releases, detailed in the command\\-line\n+help.\n@@ -459,5 +497,5 @@\n-\\f[V]java.*\\f[R], \\f[V]javax.*\\f[R], and \\f[V]org.*\\f[R] packages that\n-are exported by the Java SE modules in the release; the JDK API consists\n-of the \\f[V]com.*\\f[R] and \\f[V]jdk.*\\f[R] packages that are exported by\n-the JDK modules in the release, plus the \\f[V]javax.*\\f[R] packages that\n-are exported by standard, but non-Java SE, modules in the release.\n+\\f[CB]java.*\\f[R], \\f[CB]javax.*\\f[R], and \\f[CB]org.*\\f[R] packages that are\n+exported by the Java SE modules in the release; the JDK API consists of\n+the \\f[CB]com.*\\f[R] and \\f[CB]jdk.*\\f[R] packages that are exported by the\n+JDK modules in the release, plus the \\f[CB]javax.*\\f[R] packages that are\n+exported by standard, but non\\-Java SE, modules in the release.\n@@ -468,3 +506,3 @@\n-\\f[B]Note:\\f[R] When using \\f[V]--release\\f[R], you cannot also use the\n-\\f[B]\\f[VB]--source\\f[B]\\f[R]\/\\f[V]-source\\f[R] or\n-\\f[B]\\f[VB]--target\\f[B]\\f[R]\/\\f[V]-target\\f[R] options.\n+\\f[B]Note:\\f[R] When using \\f[CB]\\-\\-release\\f[R], you cannot also use the\n+\\f[B]\\f[BC]\\-\\-source\\f[B]\\f[R]\/\\f[CB]\\-source\\f[R] or\n+\\f[B]\\f[BC]\\-\\-target\\f[B]\\f[R]\/\\f[CB]\\-target\\f[R] options.\n@@ -472,2 +510,2 @@\n-\\f[B]Note:\\f[R] When using \\f[V]--release\\f[R] to specify a release that\n-supports the Java Platform Module System, the \\f[V]--add-exports\\f[R]\n+\\f[B]Note:\\f[R] When using \\f[CB]\\-\\-release\\f[R] to specify a release that\n+supports the Java Platform Module System, the \\f[CB]\\-\\-add\\-exports\\f[R]\n@@ -478,1 +516,1 @@\n-\\f[V]-s\\f[R] \\f[I]directory\\f[R]\n+.B \\f[CB]\\-s\\f[R] \\f[I]directory\\f[R]\n@@ -495,1 +533,1 @@\n-\\f[V]--source\\f[R] \\f[I]release\\f[R] or \\f[V]-source\\f[R] \\f[I]release\\f[R]\n+.B \\f[CB]\\-\\-source\\f[R] \\f[I]release\\f[R] or \\f[CB]\\-source\\f[R] \\f[I]release\\f[R]\n@@ -498,3 +536,3 @@\n-The supported values of \\f[I]release\\f[R] are the current Java SE\n-release and a limited number of previous releases, detailed in the\n-command-line help.\n+The supported values of \\f[I]release\\f[R] are the current Java SE release\n+and a limited number of previous releases, detailed in the command\\-line\n+help.\n@@ -508,1 +546,1 @@\n-\\f[V]--source-path\\f[R] \\f[I]path\\f[R] or \\f[V]-sourcepath\\f[R] \\f[I]path\\f[R]\n+.B \\f[CB]\\-\\-source\\-path\\f[R] \\f[I]path\\f[R] or \\f[CB]\\-sourcepath\\f[R] \\f[I]path\\f[R]\n@@ -519,1 +557,1 @@\n-\\f[V]--system\\f[R] \\f[I]jdk\\f[R] | \\f[V]none\\f[R]\n+.B \\f[CB]\\-\\-system\\f[R] \\f[I]jdk\\f[R] | \\f[CB]none\\f[R]\n@@ -521,0 +559,2 @@\n+.RS\n+.RE\n@@ -522,2 +562,2 @@\n-\\f[V]--target\\f[R] \\f[I]release\\f[R] or \\f[V]-target\\f[R] \\f[I]release\\f[R]\n-Generates \\f[V]class\\f[R] files suitable for the specified Java SE\n+.B \\f[CB]\\-\\-target\\f[R] \\f[I]release\\f[R] or \\f[CB]\\-target\\f[R] \\f[I]release\\f[R]\n+Generates \\f[CB]class\\f[R] files suitable for the specified Java SE\n@@ -525,3 +565,3 @@\n-The supported values of \\f[I]release\\f[R] are the current Java SE\n-release and a limited number of previous releases, detailed in the\n-command-line help.\n+The supported values of \\f[I]release\\f[R] are the current Java SE release\n+and a limited number of previous releases, detailed in the command\\-line\n+help.\n@@ -532,1 +572,1 @@\n-(See \\f[B]\\f[VB]--source\\f[B]\\f[R].)\n+(See \\f[B]\\f[BC]\\-\\-source\\f[B]\\f[R].)\n@@ -535,1 +575,1 @@\n-\\f[V]--upgrade-module-path\\f[R] \\f[I]path\\f[R]\n+.B \\f[CB]\\-\\-upgrade\\-module\\-path\\f[R] \\f[I]path\\f[R]\n@@ -537,0 +577,2 @@\n+.RS\n+.RE\n@@ -538,1 +580,1 @@\n-\\f[V]-verbose\\f[R]\n+.B \\f[CB]\\-verbose\\f[R]\n@@ -542,0 +584,2 @@\n+.RS\n+.RE\n@@ -543,1 +587,1 @@\n-\\f[V]--version\\f[R] or \\f[V]-version\\f[R]\n+.B \\f[CB]\\-\\-version\\f[R] or \\f[CB]\\-version\\f[R]\n@@ -545,0 +589,2 @@\n+.RS\n+.RE\n@@ -546,1 +592,1 @@\n-\\f[V]-Werror\\f[R]\n+.B \\f[CB]\\-Werror\\f[R]\n@@ -548,0 +594,2 @@\n+.RS\n+.RE\n@@ -550,1 +598,1 @@\n-\\f[V]--add-exports\\f[R] \\f[I]module\\f[R]\\f[V]\/\\f[R]\\f[I]package\\f[R]\\f[V]=\\f[R]\\f[I]other-module\\f[R](\\f[V],\\f[R]\\f[I]other-module\\f[R])*\n+.B \\f[CB]\\-\\-add\\-exports\\f[R] \\f[I]module\\f[R]\\f[CB]\/\\f[R]\\f[I]package\\f[R]\\f[CB]=\\f[R]\\f[I]other\\-module\\f[R](\\f[CB],\\f[R]\\f[I]other\\-module\\f[R])*\n@@ -553,1 +601,3 @@\n-\\f[I]other-module\\f[R] is \\f[V]ALL-UNNAMED\\f[R].\n+\\f[I]other\\-module\\f[R] is \\f[CB]ALL\\-UNNAMED\\f[R].\n+.RS\n+.RE\n@@ -555,1 +605,1 @@\n-\\f[V]--add-reads\\f[R] \\f[I]module\\f[R]\\f[V]=\\f[R]\\f[I]other-module\\f[R](\\f[V],\\f[R]\\f[I]other-module\\f[R])*\n+.B \\f[CB]\\-\\-add\\-reads\\f[R] \\f[I]module\\f[R]\\f[CB]=\\f[R]\\f[I]other\\-module\\f[R](\\f[CB],\\f[R]\\f[I]other\\-module\\f[R])*\n@@ -558,0 +608,2 @@\n+.RS\n+.RE\n@@ -559,1 +611,1 @@\n-\\f[V]--default-module-for-created-files\\f[R] \\f[I]module-name\\f[R]\n+.B \\f[CB]\\-\\-default\\-module\\-for\\-created\\-files\\f[R] \\f[I]module\\-name\\f[R]\n@@ -562,0 +614,2 @@\n+.RS\n+.RE\n@@ -563,1 +617,1 @@\n-\\f[V]-Djava.endorsed.dirs=\\f[R]\\f[I]dirs\\f[R]\n+.B \\f[CB]\\-Djava.endorsed.dirs=\\f[R]\\f[I]dirs\\f[R]\n@@ -569,2 +623,2 @@\n-As applicable, see the descriptions in \\f[B]\\f[VB]--release\\f[B]\\f[R],\n-\\f[B]\\f[VB]-source\\f[B]\\f[R], or \\f[B]\\f[VB]-target\\f[B]\\f[R] for\n+As applicable, see the descriptions in \\f[B]\\f[BC]\\-\\-release\\f[B]\\f[R],\n+\\f[B]\\f[BC]\\-source\\f[B]\\f[R], or \\f[B]\\f[BC]\\-target\\f[B]\\f[R] for\n@@ -574,1 +628,1 @@\n-\\f[V]-Djava.ext.dirs=\\f[R]\\f[I]dirs\\f[R]\n+.B \\f[CB]\\-Djava.ext.dirs=\\f[R]\\f[I]dirs\\f[R]\n@@ -580,2 +634,2 @@\n-As applicable, see the descriptions in \\f[B]\\f[VB]--release\\f[B]\\f[R],\n-\\f[B]\\f[VB]-source\\f[B]\\f[R], or \\f[B]\\f[VB]-target\\f[B]\\f[R] for\n+As applicable, see the descriptions in \\f[B]\\f[BC]\\-\\-release\\f[B]\\f[R],\n+\\f[B]\\f[BC]\\-source\\f[B]\\f[R], or \\f[B]\\f[BC]\\-target\\f[B]\\f[R] for\n@@ -585,1 +639,1 @@\n-\\f[V]--patch-module\\f[R] \\f[I]module\\f[R]\\f[V]=\\f[R]\\f[I]path\\f[R]\n+.B \\f[CB]\\-\\-patch\\-module\\f[R] \\f[I]module\\f[R]\\f[CB]=\\f[R]\\f[I]path\\f[R]\n@@ -588,0 +642,2 @@\n+.RS\n+.RE\n@@ -589,1 +645,1 @@\n-\\f[V]-Xbootclasspath:\\f[R]\\f[I]path\\f[R]\n+.B \\f[CB]\\-Xbootclasspath:\\f[R]\\f[I]path\\f[R]\n@@ -595,2 +651,2 @@\n-As applicable, see the descriptions in \\f[B]\\f[VB]--release\\f[B]\\f[R],\n-\\f[B]\\f[VB]-source\\f[B]\\f[R], or \\f[B]\\f[VB]-target\\f[B]\\f[R] for\n+As applicable, see the descriptions in \\f[B]\\f[BC]\\-\\-release\\f[B]\\f[R],\n+\\f[B]\\f[BC]\\-source\\f[B]\\f[R], or \\f[B]\\f[BC]\\-target\\f[B]\\f[R] for\n@@ -600,1 +656,1 @@\n-\\f[V]-Xbootclasspath\/a:\\f[R]\\f[I]path\\f[R]\n+.B \\f[CB]\\-Xbootclasspath\/a:\\f[R]\\f[I]path\\f[R]\n@@ -606,2 +662,2 @@\n-As applicable, see the descriptions in \\f[B]\\f[VB]--release\\f[B]\\f[R],\n-\\f[B]\\f[VB]-source\\f[B]\\f[R], or \\f[B]\\f[VB]-target\\f[B]\\f[R] for\n+As applicable, see the descriptions in \\f[B]\\f[BC]\\-\\-release\\f[B]\\f[R],\n+\\f[B]\\f[BC]\\-source\\f[B]\\f[R], or \\f[B]\\f[BC]\\-target\\f[B]\\f[R] for\n@@ -611,1 +667,1 @@\n-\\f[V]-Xbootclasspath\/p:\\f[R]\\f[I]path\\f[R]\n+.B \\f[CB]\\-Xbootclasspath\/p:\\f[R]\\f[I]path\\f[R]\n@@ -617,2 +673,2 @@\n-As applicable, see the descriptions in \\f[B]\\f[VB]--release\\f[B]\\f[R],\n-\\f[B]\\f[VB]-source\\f[B]\\f[R], or \\f[B]\\f[VB]-target\\f[B]\\f[R] for\n+As applicable, see the descriptions in \\f[B]\\f[BC]\\-\\-release\\f[B]\\f[R],\n+\\f[B]\\f[BC]\\-source\\f[B]\\f[R], or \\f[B]\\f[BC]\\-target\\f[B]\\f[R] for\n@@ -622,1 +678,1 @@\n-\\f[V]-Xdiags:\\f[R][\\f[V]compact\\f[R], \\f[V]verbose\\f[R]]\n+.B \\f[CB]\\-Xdiags:\\f[R][\\f[CB]compact\\f[R], \\f[CB]verbose\\f[R]]\n@@ -624,0 +680,2 @@\n+.RS\n+.RE\n@@ -625,1 +683,1 @@\n-\\f[V]-Xdoclint\\f[R]\n+.B \\f[CB]\\-Xdoclint\\f[R]\n@@ -627,0 +685,2 @@\n+.RS\n+.RE\n@@ -628,1 +688,1 @@\n-\\f[V]-Xdoclint:\\f[R](\\f[V]all\\f[R]|\\f[V]none\\f[R]|[\\f[V]-\\f[R]]\\f[I]group\\f[R])[\\f[V]\/\\f[R]\\f[I]access\\f[R]]\n+.B \\f[CB]\\-Xdoclint:\\f[R](\\f[CB]all\\f[R]|\\f[CB]none\\f[R]|[\\f[CB]\\-\\f[R]]\\f[I]group\\f[R])[\\f[CB]\/\\f[R]\\f[I]access\\f[R]]\n@@ -633,2 +693,2 @@\n-\\f[V]accessibility\\f[R], \\f[V]html\\f[R], \\f[V]missing\\f[R],\n-\\f[V]reference\\f[R], \\f[V]syntax\\f[R].\n+\\f[CB]accessibility\\f[R], \\f[CB]html\\f[R], \\f[CB]missing\\f[R],\n+\\f[CB]reference\\f[R], \\f[CB]syntax\\f[R].\n@@ -637,1 +697,1 @@\n-classes and members that the \\f[V]-Xdoclint\\f[R] option checks.\n+classes and members that the \\f[CB]\\-Xdoclint\\f[R] option checks.\n@@ -639,2 +699,2 @@\n-visible): \\f[V]public\\f[R], \\f[V]protected\\f[R], \\f[V]package\\f[R],\n-\\f[V]private\\f[R].\n+visible): \\f[CB]public\\f[R], \\f[CB]protected\\f[R], \\f[CB]package\\f[R],\n+\\f[CB]private\\f[R].\n@@ -642,1 +702,1 @@\n-The default \\f[I]access\\f[R] level is \\f[V]private\\f[R].\n+The default \\f[I]access\\f[R] level is \\f[CB]private\\f[R].\n@@ -644,4 +704,4 @@\n-When prefixed by \\f[V]doclint:\\f[R], the \\f[I]group\\f[R] names and\n-\\f[V]all\\f[R] can be used with \\f[V]\\[at]SuppressWarnings\\f[R] to\n-suppress warnings about documentation comments in parts of the code\n-being compiled.\n+When prefixed by \\f[CB]doclint:\\f[R], the \\f[I]group\\f[R] names and\n+\\f[CB]all\\f[R] can be used with \\f[CB]\\@SuppressWarnings\\f[R] to suppress\n+warnings about documentation comments in parts of the code being\n+compiled.\n@@ -650,4 +710,3 @@\n-\\f[B]DocLint\\f[R] section of the \\f[V]javadoc\\f[R] command\n-documentation.\n-The \\f[V]-Xdoclint\\f[R] option is disabled by default in the\n-\\f[V]javac\\f[R] command.\n+\\f[B]DocLint\\f[R] section of the \\f[CB]javadoc\\f[R] command documentation.\n+The \\f[CB]\\-Xdoclint\\f[R] option is disabled by default in the\n+\\f[CB]javac\\f[R] command.\n@@ -660,1 +719,1 @@\n-\\f[V]-Xdoclint:all\/protected\\f[R]\n+\\f[CB]\\-Xdoclint:all\/protected\\f[R]\n@@ -669,1 +728,1 @@\n-\\f[V]-Xdoclint:all,-html\/package\\f[R]\n+\\f[CB]\\-Xdoclint:all,\\-html\/package\\f[R]\n@@ -673,1 +732,1 @@\n-\\f[V]-Xdoclint\/package:\\f[R][\\f[V]-\\f[R]]\\f[I]packages\\f[R](\\f[V],\\f[R][\\f[V]-\\f[R]]\\f[I]package\\f[R])*\n+.B \\f[CB]\\-Xdoclint\/package:\\f[R][\\f[CB]\\-\\f[R]]\\f[I]packages\\f[R](\\f[CB],\\f[R][\\f[CB]\\-\\f[R]]\\f[I]package\\f[R])*\n@@ -676,3 +735,3 @@\n-package name prefix followed by \\f[V].*\\f[R], which expands to all\n-sub-packages of the given package.\n-Each \\f[I]package\\f[R] can be prefixed with a hyphen (\\f[V]-\\f[R]) to\n+package name prefix followed by \\f[CB]\\&.*\\f[R], which expands to all\n+sub\\-packages of the given package.\n+Each \\f[I]package\\f[R] can be prefixed with a hyphen (\\f[CB]\\-\\f[R]) to\n@@ -683,1 +742,1 @@\n-\\f[V]javadoc\\f[R] command documentation.\n+\\f[CB]javadoc\\f[R] command documentation.\n@@ -686,1 +745,1 @@\n-\\f[V]-Xlint\\f[R]\n+.B \\f[CB]\\-Xlint\\f[R]\n@@ -689,0 +748,2 @@\n+.RS\n+.RE\n@@ -690,1 +751,1 @@\n-\\f[V]-Xlint:\\f[R][\\f[V]-\\f[R]]\\f[I]key\\f[R](\\f[V],\\f[R][\\f[V]-\\f[R]]\\f[I]key\\f[R])*\n+.B \\f[CB]\\-Xlint:\\f[R][\\f[CB]\\-\\f[R]]\\f[I]key\\f[R](\\f[CB],\\f[R][\\f[CB]\\-\\f[R]]\\f[I]key\\f[R])*\n@@ -692,1 +753,1 @@\n-Precede a key by a hyphen (\\f[V]-\\f[R]) to disable the specified\n+Precede a key by a hyphen (\\f[CB]\\-\\f[R]) to disable the specified\n@@ -698,1 +759,1 @@\n-\\f[V]all\\f[R]: Enables all warnings.\n+\\f[CB]all\\f[R]: Enables all warnings.\n@@ -700,1 +761,1 @@\n-\\f[V]auxiliaryclass\\f[R]: Warns about an auxiliary class that is hidden\n+\\f[CB]auxiliaryclass\\f[R]: Warns about an auxiliary class that is hidden\n@@ -703,1 +764,1 @@\n-\\f[V]cast\\f[R]: Warns about the use of unnecessary casts.\n+\\f[CB]cast\\f[R]: Warns about the use of unnecessary casts.\n@@ -705,1 +766,1 @@\n-\\f[V]classfile\\f[R]: Warns about the issues related to classfile\n+\\f[CB]classfile\\f[R]: Warns about the issues related to classfile\n@@ -708,1 +769,1 @@\n-\\f[V]deprecation\\f[R]: Warns about the use of deprecated items.\n+\\f[CB]deprecation\\f[R]: Warns about the use of deprecated items.\n@@ -710,2 +771,2 @@\n-\\f[V]dep-ann\\f[R]: Warns about the items marked as deprecated in\n-\\f[V]javadoc\\f[R] but without the \\f[V]\\[at]Deprecated\\f[R] annotation.\n+\\f[CB]dep\\-ann\\f[R]: Warns about the items marked as deprecated in\n+\\f[CB]javadoc\\f[R] but without the \\f[CB]\\@Deprecated\\f[R] annotation.\n@@ -713,1 +774,1 @@\n-\\f[V]divzero\\f[R]: Warns about the division by the constant integer 0.\n+\\f[CB]divzero\\f[R]: Warns about the division by the constant integer 0.\n@@ -715,1 +776,1 @@\n-\\f[V]empty\\f[R]: Warns about an empty statement after \\f[V]if\\f[R].\n+\\f[CB]empty\\f[R]: Warns about an empty statement after \\f[CB]if\\f[R].\n@@ -717,1 +778,1 @@\n-\\f[V]exports\\f[R]: Warns about the issues regarding module exports.\n+\\f[CB]exports\\f[R]: Warns about the issues regarding module exports.\n@@ -719,2 +780,2 @@\n-\\f[V]fallthrough\\f[R]: Warns about the falling through from one case of\n-a switch statement to the next.\n+\\f[CB]fallthrough\\f[R]: Warns about the falling through from one case of a\n+switch statement to the next.\n@@ -722,1 +783,1 @@\n-\\f[V]finally\\f[R]: Warns about \\f[V]finally\\f[R] clauses that do not\n+\\f[CB]finally\\f[R]: Warns about \\f[CB]finally\\f[R] clauses that do not\n@@ -725,1 +786,4 @@\n-\\f[V]missing-explicit-ctor\\f[R]: Warns about missing explicit\n+\\f[CB]lossy\\-conversions\\f[R]: Warns about possible lossy conversions\n+in compound assignment.\n+.IP \\[bu] 2\n+\\f[CB]missing\\-explicit\\-ctor\\f[R]: Warns about missing explicit\n@@ -728,1 +792,1 @@\n-\\f[V]module\\f[R]: Warns about the module system-related issues.\n+\\f[CB]module\\f[R]: Warns about the module system\\-related issues.\n@@ -730,1 +794,1 @@\n-\\f[V]opens\\f[R]: Warns about the issues related to module opens.\n+\\f[CB]opens\\f[R]: Warns about the issues related to module opens.\n@@ -732,2 +796,2 @@\n-\\f[V]options\\f[R]: Warns about the issues relating to use of command\n-line options.\n+\\f[CB]options\\f[R]: Warns about the issues relating to use of command line\n+options.\n@@ -735,1 +799,1 @@\n-\\f[V]overloads\\f[R]: Warns about the issues related to method overloads.\n+\\f[CB]overloads\\f[R]: Warns about the issues related to method overloads.\n@@ -737,1 +801,1 @@\n-\\f[V]overrides\\f[R]: Warns about the issues related to method overrides.\n+\\f[CB]overrides\\f[R]: Warns about the issues related to method overrides.\n@@ -739,1 +803,1 @@\n-\\f[V]path\\f[R]: Warns about the invalid path elements on the command\n+\\f[CB]path\\f[R]: Warns about the invalid path elements on the command\n@@ -742,1 +806,1 @@\n-\\f[V]preview\\f[R]: Warns about the use of preview language features.\n+\\f[CB]preview\\f[R]: Warns about the use of preview language features.\n@@ -744,1 +808,1 @@\n-\\f[V]processing\\f[R]: Warns about the issues related to annotation\n+\\f[CB]processing\\f[R]: Warns about the issues related to annotation\n@@ -747,1 +811,1 @@\n-\\f[V]rawtypes\\f[R]: Warns about the use of raw types.\n+\\f[CB]rawtypes\\f[R]: Warns about the use of raw types.\n@@ -749,2 +813,2 @@\n-\\f[V]removal\\f[R]: Warns about the use of an API that has been marked\n-for removal.\n+\\f[CB]removal\\f[R]: Warns about the use of an API that has been marked for\n+removal.\n@@ -752,1 +816,1 @@\n-\\f[V]requires-automatic\\f[R]: Warns developers about the use of\n+\\f[CB]requires\\-automatic\\f[R]: Warns developers about the use of\n@@ -755,1 +819,1 @@\n-\\f[V]requires-transitive-automatic\\f[R]: Warns about automatic modules\n+\\f[CB]requires\\-transitive\\-automatic\\f[R]: Warns about automatic modules\n@@ -758,1 +822,1 @@\n-\\f[V]serial\\f[R]: Warns about the serializable classes that do not\n+\\f[CB]serial\\f[R]: Warns about the serializable classes that do not\n@@ -760,1 +824,1 @@\n-Also warns about access to non-public members from a serializable\n+Also warns about access to non\\-public members from a serializable\n@@ -763,1 +827,1 @@\n-\\f[V]static\\f[R]: Warns about the accessing a static member using an\n+\\f[CB]static\\f[R]: Warns about the accessing a static member using an\n@@ -766,2 +830,2 @@\n-\\f[V]strictfp\\f[R]: Warns about unnecessary use of the\n-\\f[V]strictfp\\f[R] modifier.\n+\\f[CB]strictfp\\f[R]: Warns about unnecessary use of the \\f[CB]strictfp\\f[R]\n+modifier.\n@@ -769,2 +833,2 @@\n-\\f[V]synchronization\\f[R]: Warns about synchronization attempts on\n-instances of value-based classes.\n+\\f[CB]synchronization\\f[R]: Warns about synchronization attempts on\n+instances of value\\-based classes.\n@@ -772,1 +836,1 @@\n-\\f[V]text-blocks\\f[R]: Warns about inconsistent white space characters\n+\\f[CB]text\\-blocks\\f[R]: Warns about inconsistent white space characters\n@@ -775,2 +839,2 @@\n-\\f[V]try\\f[R]: Warns about the issues relating to the use of try blocks\n-(that is, try-with-resources).\n+\\f[CB]try\\f[R]: Warns about the issues relating to the use of try blocks\n+(that is, try\\-with\\-resources).\n@@ -778,1 +842,1 @@\n-\\f[V]unchecked\\f[R]: Warns about the unchecked operations.\n+\\f[CB]unchecked\\f[R]: Warns about the unchecked operations.\n@@ -780,1 +844,1 @@\n-\\f[V]varargs\\f[R]: Warns about the potentially unsafe \\f[V]vararg\\f[R]\n+\\f[CB]varargs\\f[R]: Warns about the potentially unsafe \\f[CB]vararg\\f[R]\n@@ -783,1 +847,1 @@\n-\\f[V]none\\f[R]: Disables all warnings.\n+\\f[CB]none\\f[R]: Disables all warnings.\n@@ -785,2 +849,2 @@\n-With the exception of \\f[V]all\\f[R] and \\f[V]none\\f[R], the keys can be\n-used with the \\f[V]\\[at]SuppressWarnings\\f[R] annotation to suppress\n+With the exception of \\f[CB]all\\f[R] and \\f[CB]none\\f[R], the keys can be\n+used with the \\f[CB]\\@SuppressWarnings\\f[R] annotation to suppress\n@@ -789,1 +853,1 @@\n-See \\f[B]Examples of Using -Xlint keys\\f[R].\n+See \\f[B]Examples of Using \\-Xlint keys\\f[R].\n@@ -792,1 +856,1 @@\n-\\f[V]-Xmaxerrs\\f[R] \\f[I]number\\f[R]\n+.B \\f[CB]\\-Xmaxerrs\\f[R] \\f[I]number\\f[R]\n@@ -794,0 +858,2 @@\n+.RS\n+.RE\n@@ -795,1 +861,1 @@\n-\\f[V]-Xmaxwarns\\f[R] \\f[I]number\\f[R]\n+.B \\f[CB]\\-Xmaxwarns\\f[R] \\f[I]number\\f[R]\n@@ -797,0 +863,2 @@\n+.RS\n+.RE\n@@ -798,3 +866,3 @@\n-\\f[V]-Xpkginfo:\\f[R][\\f[V]always\\f[R], \\f[V]legacy\\f[R], \\f[V]nonempty\\f[R]]\n-Specifies when and how the \\f[V]javac\\f[R] command generates\n-\\f[V]package-info.class\\f[R] files from \\f[V]package-info.java\\f[R]\n+.B \\f[CB]\\-Xpkginfo:\\f[R][\\f[CB]always\\f[R], \\f[CB]legacy\\f[R], \\f[CB]nonempty\\f[R]]\n+Specifies when and how the \\f[CB]javac\\f[R] command generates\n+\\f[CB]package\\-info.class\\f[R] files from \\f[CB]package\\-info.java\\f[R]\n@@ -804,3 +872,3 @@\n-\\f[V]always\\f[R]\n-Generates a \\f[V]package-info.class\\f[R] file for every\n-\\f[V]package-info.java\\f[R] file.\n+.B \\f[CB]always\\f[R]\n+Generates a \\f[CB]package\\-info.class\\f[R] file for every\n+\\f[CB]package\\-info.java\\f[R] file.\n@@ -808,2 +876,4 @@\n-checks that each \\f[V].java\\f[R] file has a corresponding\n-\\f[V].class\\f[R] file.\n+checks that each \\f[CB]\\&.java\\f[R] file has a corresponding\n+\\f[CB]\\&.class\\f[R] file.\n+.RS\n+.RE\n@@ -811,5 +881,5 @@\n-\\f[V]legacy\\f[R]\n-Generates a \\f[V]package-info.class\\f[R] file only if\n-\\f[V]package-info.java\\f[R] contains annotations.\n-This option does not generate a \\f[V]package-info.class\\f[R] file if\n-\\f[V]package-info.java\\f[R] contains only comments.\n+.B \\f[CB]legacy\\f[R]\n+Generates a \\f[CB]package\\-info.class\\f[R] file only if\n+\\f[CB]package\\-info.java\\f[R] contains annotations.\n+This option does not generate a \\f[CB]package\\-info.class\\f[R] file if\n+\\f[CB]package\\-info.java\\f[R] contains only comments.\n@@ -818,3 +888,3 @@\n-\\f[B]Note:\\f[R] A \\f[V]package-info.class\\f[R] file might be generated\n-but be empty if all the annotations in the \\f[V]package-info.java\\f[R]\n-file have \\f[V]RetentionPolicy.SOURCE\\f[R].\n+\\f[B]Note:\\f[R] A \\f[CB]package\\-info.class\\f[R] file might be generated\n+but be empty if all the annotations in the \\f[CB]package\\-info.java\\f[R]\n+file have \\f[CB]RetentionPolicy.SOURCE\\f[R].\n@@ -823,4 +893,6 @@\n-\\f[V]nonempty\\f[R]\n-Generates a \\f[V]package-info.class\\f[R] file only if\n-\\f[V]package-info.java\\f[R] contains annotations with\n-\\f[V]RetentionPolicy.CLASS\\f[R] or \\f[V]RetentionPolicy.RUNTIME\\f[R].\n+.B \\f[CB]nonempty\\f[R]\n+Generates a \\f[CB]package\\-info.class\\f[R] file only if\n+\\f[CB]package\\-info.java\\f[R] contains annotations with\n+\\f[CB]RetentionPolicy.CLASS\\f[R] or \\f[CB]RetentionPolicy.RUNTIME\\f[R].\n+.RS\n+.RE\n@@ -829,4 +901,4 @@\n-\\f[V]-Xplugin:\\f[R]\\f[I]name\\f[R] \\f[I]args\\f[R]\n-Specifies the name and optional arguments for a plug-in to be run.\n-If \\f[I]args\\f[R] are provided, \\f[I]name\\f[R] and \\f[I]args\\f[R] should\n-be quoted or otherwise escape the whitespace characters between the name\n+.B \\f[CB]\\-Xplugin:\\f[R]\\f[I]name\\f[R] \\f[I]args\\f[R]\n+Specifies the name and optional arguments for a plug\\-in to be run.\n+If \\f[I]args\\f[R] are provided, \\f[I]name\\f[R] and \\f[I]args\\f[R] should be\n+quoted or otherwise escape the whitespace characters between the name\n@@ -836,0 +908,2 @@\n+.RS\n+.RE\n@@ -837,1 +911,1 @@\n-\\f[V]-Xprefer:\\f[R][\\f[V]source\\f[R], \\f[V]newer\\f[R]]\n+.B \\f[CB]\\-Xprefer:\\f[R][\\f[CB]source\\f[R], \\f[CB]newer\\f[R]]\n@@ -844,1 +918,1 @@\n-\\f[V]-Xprefer:newer\\f[R]: Reads the newer of the source or class files\n+\\f[CB]\\-Xprefer:newer\\f[R]: Reads the newer of the source or class files\n@@ -847,2 +921,2 @@\n-\\f[V]-Xprefer:source\\f[R] : Reads the source file.\n-Use \\f[V]-Xprefer:source\\f[R] when you want to be sure that any\n+\\f[CB]\\-Xprefer:source\\f[R] : Reads the source file.\n+Use \\f[CB]\\-Xprefer:source\\f[R] when you want to be sure that any\n@@ -850,1 +924,1 @@\n-policy of \\f[V]SOURCE\\f[R].\n+policy of \\f[CB]SOURCE\\f[R].\n@@ -853,1 +927,1 @@\n-\\f[V]-Xprint\\f[R]\n+.B \\f[CB]\\-Xprint\\f[R]\n@@ -858,0 +932,2 @@\n+.RS\n+.RE\n@@ -859,1 +935,1 @@\n-\\f[V]-XprintProcessorInfo\\f[R]\n+.B \\f[CB]\\-XprintProcessorInfo\\f[R]\n@@ -862,0 +938,2 @@\n+.RS\n+.RE\n@@ -863,1 +941,1 @@\n-\\f[V]-XprintRounds\\f[R]\n+.B \\f[CB]\\-XprintRounds\\f[R]\n@@ -866,0 +944,2 @@\n+.RS\n+.RE\n@@ -867,1 +947,1 @@\n-\\f[V]-Xstdout\\f[R] \\f[I]filename\\f[R]\n+.B \\f[CB]\\-Xstdout\\f[R] \\f[I]filename\\f[R]\n@@ -869,1 +949,3 @@\n-By default, compiler messages go to \\f[V]System.err\\f[R].\n+By default, compiler messages go to \\f[CB]System.err\\f[R].\n+.RS\n+.RE\n@@ -873,3 +955,3 @@\n-If the \\f[B]\\f[VB]--class-path\\f[B]\\f[R] option or any of its alternate\n-forms are not specified, the class path will default to the value of the\n-\\f[V]CLASSPATH\\f[R] environment variable if it is set.\n+If the \\f[B]\\f[BC]\\-\\-class\\-path\\f[B]\\f[R] option or any of its\n+alternate forms are not specified, the class path will default to the\n+value of the \\f[CB]CLASSPATH\\f[R] environment variable if it is set.\n@@ -877,1 +959,1 @@\n-\\f[I]not\\f[R] be set, and that the \\f[V]--class-path\\f[R] option should\n+\\f[I]not\\f[R] be set, and that the \\f[CB]\\-\\-class\\-path\\f[R] option should\n@@ -882,5 +964,4 @@\n-The content of the \\f[V]JDK_JAVAC_OPTIONS\\f[R] environment variable,\n-separated by white-spaces ( ) or white-space characters\n-(\\f[V]\\[rs]n\\f[R], \\f[V]\\[rs]t\\f[R], \\f[V]\\[rs]r\\f[R], or\n-\\f[V]\\[rs]f\\f[R]) is prepended to the command line arguments passed to\n-\\f[V]javac\\f[R] as a list of arguments.\n+The content of the \\f[CB]JDK_JAVAC_OPTIONS\\f[R] environment variable,\n+separated by white\\-spaces ( ) or white\\-space characters (\\f[CB]\\\\n\\f[R],\n+\\f[CB]\\\\t\\f[R], \\f[CB]\\\\r\\f[R], or \\f[CB]\\\\f\\f[R]) is prepended to the command\n+line arguments passed to \\f[CB]javac\\f[R] as a list of arguments.\n@@ -889,2 +970,2 @@\n-\\f[V]javac\\f[R] command line on the system.\n-\\f[V]JDK_JAVAC_OPTIONS\\f[R] environment variable content is treated in\n+\\f[CB]javac\\f[R] command line on the system.\n+\\f[CB]JDK_JAVAC_OPTIONS\\f[R] environment variable content is treated in\n@@ -893,2 +974,2 @@\n-Single quotes (\\f[V]\\[aq]\\f[R]) or double quotes (\\f[V]\\[dq]\\f[R]) can\n-be used to enclose arguments that contain whitespace characters.\n+Single quotes (\\f[CB]\\[aq]\\f[R]) or double quotes (\\f[CB]\"\\f[R]) can be used\n+to enclose arguments that contain whitespace characters.\n@@ -899,3 +980,3 @@\n-\\f[V]\\[at]\\f[R]\\f[I]files\\f[R] are supported as they are specified in\n-the command line.\n-However, as in \\f[V]\\[at]\\f[R]\\f[I]files\\f[R], use of a wildcard is not\n+\\f[CB]\\@\\f[R]\\f[I]files\\f[R] are supported as they are specified in the\n+command line.\n+However, as in \\f[CB]\\@\\f[R]\\f[I]files\\f[R], use of a wildcard is not\n@@ -907,1 +988,1 @@\n-\\f[V]export JDK_JAVAC_OPTIONS=\\[aq]\\[at]\\[dq]C:\\[rs]white spaces\\[rs]argfile\\[dq]\\[aq]\\f[R]\n+\\f[CB]export\\ JDK_JAVAC_OPTIONS=\\[aq]\\@\"C:\\\\white\\ spaces\\\\argfile\"\\[aq]\\f[R]\n@@ -911,1 +992,1 @@\n-\\f[V]export JDK_JAVAC_OPTIONS=\\[aq]\\[dq]\\[at]C:\\[rs]white spaces\\[rs]argfile\\[dq]\\[aq]\\f[R]\n+\\f[CB]export\\ JDK_JAVAC_OPTIONS=\\[aq]\"\\@C:\\\\white\\ spaces\\\\argfile\"\\[aq]\\f[R]\n@@ -915,1 +996,1 @@\n-\\f[V]export JDK_JAVAC_OPTIONS=\\[aq]\\[at]C:\\[rs]\\[dq]white spaces\\[dq]\\[rs]argfile\\[aq]\\f[R]\n+\\f[CB]export\\ JDK_JAVAC_OPTIONS=\\[aq]\\@C:\\\\\"white\\ spaces\"\\\\argfile\\[aq]\\f[R]\n@@ -917,1 +998,1 @@\n-.SH COMMAND-LINE ARGUMENT FILES\n+.SH COMMAND\\-LINE ARGUMENT FILES\n@@ -919,1 +1000,1 @@\n-An argument file can include command-line options and source file names\n+An argument file can include command\\-line options and source file names\n@@ -928,5 +1009,5 @@\n-Wildcards (\\f[V]*\\f[R]) are not allowed in these lists (such as for\n-specifying \\f[V]*.java\\f[R]).\n-Use of the at sign (\\f[V]\\[at]\\f[R]) to recursively interpret files is\n-not supported.\n-The \\f[V]-J\\f[R] options are not supported because they\\[aq]re passed to\n+Wildcards (\\f[CB]*\\f[R]) are not allowed in these lists (such as for\n+specifying \\f[CB]*.java\\f[R]).\n+Use of the at sign (\\f[CB]\\@\\f[R]) to recursively interpret files is not\n+supported.\n+The \\f[CB]\\-J\\f[R] options are not supported because they\\[aq]re passed to\n@@ -935,6 +1016,6 @@\n-When executing the \\f[V]javac\\f[R] command, pass in the path and name of\n-each argument file with the at sign (\\f[V]\\[at]\\f[R]) leading character.\n-When the \\f[V]javac\\f[R] command encounters an argument beginning with\n-the at sign (\\f[V]\\[at]\\f[R]), it expands the contents of that file into\n-the argument list.\n-.SS Examples of Using javac \\[at]filename\n+When executing the \\f[CB]javac\\f[R] command, pass in the path and name of\n+each argument file with the at sign (\\f[CB]\\@\\f[R]) leading character.\n+When the \\f[CB]javac\\f[R] command encounters an argument beginning with\n+the at sign (\\f[CB]\\@\\f[R]), it expands the contents of that file into the\n+argument list.\n+.SS Examples of Using javac \\@filename\n@@ -942,3 +1023,3 @@\n-Single Argument File\n-You could use a single argument file named \\f[V]argfile\\f[R] to hold all\n-\\f[V]javac\\f[R] arguments:\n+.B Single Argument File\n+You could use a single argument file named \\f[CB]argfile\\f[R] to hold all\n+\\f[CB]javac\\f[R] arguments:\n@@ -948,1 +1029,1 @@\n-\\f[V]javac \\[at]argfile\\f[R]\n+\\f[CB]javac\\ \\@argfile\\f[R]\n@@ -955,2 +1036,2 @@\n-Two Argument Files\n-You can create two argument files: one for the \\f[V]javac\\f[R] options\n+.B Two Argument Files\n+You can create two argument files: one for the \\f[CB]javac\\f[R] options\n@@ -958,1 +1039,1 @@\n-Note that the following lists have no line-continuation characters.\n+Note that the following lists have no line\\-continuation characters.\n@@ -961,1 +1042,1 @@\n-Create a file named \\f[V]options\\f[R] that contains the following:\n+Create a file named \\f[CB]options\\f[R] that contains the following:\n@@ -967,3 +1048,3 @@\n--d classes\n--g\n--sourcepath \/java\/pubs\/ws\/1.3\/src\/share\/classes\n+\\-d\\ classes\n+\\-g\n+\\-sourcepath\\ \/java\/pubs\/ws\/1.3\/src\/share\/classes\n@@ -977,3 +1058,3 @@\n--d classes\n--g\n--sourcepath C:\\[rs]java\\[rs]pubs\\[rs]ws\\[rs]1.3\\[rs]src\\[rs]share\\[rs]classes\n+\\-d\\ classes\n+\\-g\n+\\-sourcepath\\ C:\\\\java\\\\pubs\\\\ws\\\\1.3\\\\src\\\\share\\\\classes\n@@ -983,1 +1064,1 @@\n-Create a file named \\f[V]sources\\f[R] that contains the following:\n+Create a file named \\f[CB]sources\\f[R] that contains the following:\n@@ -993,1 +1074,1 @@\n-Then, run the \\f[V]javac\\f[R] command as follows:\n+Then, run the \\f[CB]javac\\f[R] command as follows:\n@@ -996,1 +1077,1 @@\n-\\f[V]javac \\[at]options \\[at]sources\\f[R]\n+\\f[CB]javac\\ \\@options\\ \\@sources\\f[R]\n@@ -1000,1 +1081,1 @@\n-Argument Files with Paths\n+.B Argument Files with Paths\n@@ -1002,2 +1083,2 @@\n-are relative to the current working directory (not \\f[V]path1\\f[R] or\n-\\f[V]path2\\f[R]):\n+are relative to the current working directory (not \\f[CB]path1\\f[R] or\n+\\f[CB]path2\\f[R]):\n@@ -1007,1 +1088,1 @@\n-\\f[V]javac \\[at]path1\/options \\[at]path2\/sources\\f[R]\n+\\f[CB]javac\\ \\@path1\/options\\ \\@path2\/sources\\f[R]\n@@ -1014,1 +1095,1 @@\n-\\f[V]javac\\f[R] expects that the physical arrangement of source files in\n+\\f[CB]javac\\f[R] expects that the physical arrangement of source files in\n@@ -1019,2 +1100,2 @@\n-begin with a lower-case letter, and that class names begin with an\n-upper-case letter.\n+begin with a lower\\-case letter, and that class names begin with an\n+upper\\-case letter.\n@@ -1029,2 +1110,1 @@\n-The package \\f[V]p\\f[R] is represented as a directory called\n-\\f[V]p\\f[R].\n+The package \\f[CB]p\\f[R] is represented as a directory called \\f[CB]p\\f[R].\n@@ -1032,5 +1112,5 @@\n-The package \\f[V]p.q\\f[R] -- that is, the subpackage \\f[V]q\\f[R] of\n-package \\f[V]p\\f[R] -- is represented as the subdirectory \\f[V]q\\f[R] of\n-directory \\f[V]p\\f[R].\n-The directory tree representing package \\f[V]p.q\\f[R] is therefore\n-\\f[V]p\\[rs]q\\f[R] on Windows, and \\f[V]p\/q\\f[R] on other systems.\n+The package \\f[CB]p.q\\f[R] \\-\\- that is, the subpackage \\f[CB]q\\f[R] of\n+package \\f[CB]p\\f[R] \\-\\- is represented as the subdirectory \\f[CB]q\\f[R] of\n+directory \\f[CB]p\\f[R].\n+The directory tree representing package \\f[CB]p.q\\f[R] is therefore\n+\\f[CB]p\\\\q\\f[R] on Windows, and \\f[CB]p\/q\\f[R] on other systems.\n@@ -1038,3 +1118,2 @@\n-The package \\f[V]p.q.r\\f[R] is represented as the directory tree\n-\\f[V]p\\[rs]q\\[rs]r\\f[R] (on Windows) or \\f[V]p\/q\/r\\f[R] (on other\n-systems).\n+The package \\f[CB]p.q.r\\f[R] is represented as the directory tree\n+\\f[CB]p\\\\q\\\\r\\f[R] (on Windows) or \\f[CB]p\/q\/r\\f[R] (on other systems).\n@@ -1042,1 +1121,1 @@\n-Within a directory or subdirectory, \\f[V].java\\f[R] files represent\n+Within a directory or subdirectory, \\f[CB]\\&.java\\f[R] files represent\n@@ -1047,2 +1126,2 @@\n-The class \\f[V]X\\f[R] declared in package \\f[V]p\\f[R] is represented by\n-the file \\f[V]X.java\\f[R] in the \\f[V]p\\f[R] directory.\n+The class \\f[CB]X\\f[R] declared in package \\f[CB]p\\f[R] is represented by\n+the file \\f[CB]X.java\\f[R] in the \\f[CB]p\\f[R] directory.\n@@ -1050,3 +1129,3 @@\n-The class \\f[V]Y\\f[R] declared in package \\f[V]p.q\\f[R] is represented\n-by the file \\f[V]Y.java\\f[R] in the \\f[V]q\\f[R] subdirectory of\n-directory \\f[V]p\\f[R].\n+The class \\f[CB]Y\\f[R] declared in package \\f[CB]p.q\\f[R] is represented by\n+the file \\f[CB]Y.java\\f[R] in the \\f[CB]q\\f[R] subdirectory of directory\n+\\f[CB]p\\f[R].\n@@ -1054,3 +1133,3 @@\n-The class \\f[V]Z\\f[R] declared in package \\f[V]p.q.r\\f[R] is represented\n-by the file \\f[V]Z.java\\f[R] in the \\f[V]r\\f[R] subdirectory of\n-\\f[V]p\\[rs]q\\f[R] (on Windows) or \\f[V]p\/q\\f[R] (on other systems).\n+The class \\f[CB]Z\\f[R] declared in package \\f[CB]p.q.r\\f[R] is represented\n+by the file \\f[CB]Z.java\\f[R] in the \\f[CB]r\\f[R] subdirectory of\n+\\f[CB]p\\\\q\\f[R] (on Windows) or \\f[CB]p\/q\\f[R] (on other systems).\n@@ -1060,1 +1139,1 @@\n-of directories specified to \\f[V]javac\\f[R].\n+of directories specified to \\f[CB]javac\\f[R].\n@@ -1064,2 +1143,2 @@\n-In addition to \\f[V].java\\f[R] files for classes and interfaces, each\n-module has a source file called \\f[V]module-info.java\\f[R] which:\n+In addition to \\f[CB]\\&.java\\f[R] files for classes and interfaces, each\n+module has a source file called \\f[CB]module\\-info.java\\f[R] which:\n@@ -1077,1 +1156,1 @@\n-which contains the \\f[V]module-info.java\\f[R] file.\n+which contains the \\f[CB]module\\-info.java\\f[R] file.\n@@ -1079,1 +1158,1 @@\n-named after the module, to contain the \\f[V]module-info.java\\f[R] file\n+named after the module, to contain the \\f[CB]module\\-info.java\\f[R] file\n@@ -1088,2 +1167,2 @@\n-The module \\f[V]a.b.c\\f[R] may be represented by the directory\n-\\f[V]a.b.c\\f[R], on all systems.\n+The module \\f[CB]a.b.c\\f[R] may be represented by the directory\n+\\f[CB]a.b.c\\f[R], on all systems.\n@@ -1092,1 +1171,1 @@\n-\\f[V]module-info.java\\f[R] in the \\f[V]a.b.c\\f[R] directory.\n+\\f[CB]module\\-info.java\\f[R] in the \\f[CB]a.b.c\\f[R] directory.\n@@ -1094,3 +1173,3 @@\n-If the module contains package \\f[V]p.q.r\\f[R], then the \\f[V]a.b.c\\f[R]\n-directory contains the directory tree \\f[V]p\\[rs]q\\[rs]r\\f[R] (on\n-Windows) or \\f[V]p\/q\/r\\f[R] (on other systems).\n+If the module contains package \\f[CB]p.q.r\\f[R], then the \\f[CB]a.b.c\\f[R]\n+directory contains the directory tree \\f[CB]p\\\\q\\\\r\\f[R] (on Windows) or\n+\\f[CB]p\/q\/r\\f[R] (on other systems).\n@@ -1100,1 +1179,1 @@\n-read by \\f[V]javac\\f[R].\n+read by \\f[CB]javac\\f[R].\n@@ -1104,2 +1183,2 @@\n-The module \\f[V]a.b.c\\f[R] may be represented by the directory\n-\\f[V]a.b.c\\f[R]\n+The module \\f[CB]a.b.c\\f[R] may be represented by the directory\n+\\f[CB]a.b.c\\f[R]\n@@ -1108,3 +1187,2 @@\n-some subdirectory of \\f[V]a.b.c\\f[R], such as\n-\\f[V]src\\[rs]main\\[rs]java\\f[R] (on Windows) or \\f[V]src\/main\/java\\f[R]\n-(on other systems).\n+some subdirectory of \\f[CB]a.b.c\\f[R], such as \\f[CB]src\\\\main\\\\java\\f[R]\n+(on Windows) or \\f[CB]src\/main\/java\\f[R] (on other systems).\n@@ -1113,1 +1191,1 @@\n-This section describes how to configure \\f[V]javac\\f[R] to perform a\n+This section describes how to configure \\f[CB]javac\\f[R] to perform a\n@@ -1129,1 +1207,1 @@\n-indirectly, by using the \\f[B]\\f[VB]--module\\f[B]\\f[R] or \\f[V]-m\\f[R]\n+indirectly, by using the \\f[B]\\f[BC]\\-\\-module\\f[B]\\f[R] or \\f[CB]\\-m\\f[R]\n@@ -1133,1 +1211,1 @@\n-Use the \\f[B]\\f[VB]-d\\f[B]\\f[R] option to specify an output directory in\n+Use the \\f[B]\\f[BC]\\-d\\f[B]\\f[R] option to specify an output directory in\n@@ -1152,2 +1230,2 @@\n-Use the \\f[B]\\f[VB]--class-path\\f[B]\\f[R] option to specify libraries to\n-be placed on the class path.\n+Use the \\f[B]\\f[BC]\\-\\-class\\-path\\f[B]\\f[R] option to specify libraries\n+to be placed on the class path.\n@@ -1156,2 +1234,2 @@\n-You can also use alternate forms of the option: \\f[V]-classpath\\f[R] or\n-\\f[V]-cp\\f[R].\n+You can also use alternate forms of the option: \\f[CB]\\-classpath\\f[R] or\n+\\f[CB]\\-cp\\f[R].\n@@ -1159,1 +1237,1 @@\n-Use the \\f[B]\\f[VB]--module-path\\f[B]\\f[R] option to specify libraries\n+Use the \\f[B]\\f[BC]\\-\\-module\\-path\\f[B]\\f[R] option to specify libraries\n@@ -1163,1 +1241,1 @@\n-You can also use an alternate form of the option: \\f[V]-p\\f[R].\n+You can also use an alternate form of the option: \\f[CB]\\-p\\f[R].\n@@ -1184,1 +1262,1 @@\n-Use the \\f[B]\\f[VB]--source-path\\f[B]\\f[R] option to specify the\n+Use the \\f[B]\\f[BC]\\-\\-source\\-path\\f[B]\\f[R] option to specify the\n@@ -1188,1 +1266,1 @@\n-You can also use an alternate form of the option: \\f[V]-sourcepath\\f[R].\n+You can also use an alternate form of the option: \\f[CB]\\-sourcepath\\f[R].\n@@ -1190,1 +1268,1 @@\n-Use the \\f[B]\\f[VB]--module-source-path\\f[B]\\f[R] option one or more\n+Use the \\f[B]\\f[BC]\\-\\-module\\-source\\-path\\f[B]\\f[R] option one or more\n@@ -1200,1 +1278,1 @@\n-do not want them to be compiled, use the \\f[B]\\f[VB]-implicit\\f[B]\\f[R]\n+do not want them to be compiled, use the \\f[B]\\f[BC]\\-implicit\\f[B]\\f[R]\n@@ -1209,3 +1287,3 @@\n-This example compiles the \\f[V]Aloha.java\\f[R], \\f[V]GutenTag.java\\f[R],\n-\\f[V]Hello.java\\f[R], and \\f[V]Hi.java\\f[R] source files in the\n-\\f[V]greetings\\f[R] package.\n+This example compiles the \\f[CB]Aloha.java\\f[R], \\f[CB]GutenTag.java\\f[R],\n+\\f[CB]Hello.java\\f[R], and \\f[CB]Hi.java\\f[R] source files in the\n+\\f[CB]greetings\\f[R] package.\n@@ -1217,4 +1295,4 @@\n-% javac greetings\/*.java\n-% ls greetings\n-Aloha.class         GutenTag.class      Hello.class         Hi.class\n-Aloha.java          GutenTag.java       Hello.java          Hi.java\n+%\\ javac\\ greetings\/*.java\n+%\\ ls\\ greetings\n+Aloha.class\\ \\ \\ \\ \\ \\ \\ \\ \\ GutenTag.class\\ \\ \\ \\ \\ \\ Hello.class\\ \\ \\ \\ \\ \\ \\ \\ \\ Hi.class\n+Aloha.java\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ GutenTag.java\\ \\ \\ \\ \\ \\ \\ Hello.java\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ Hi.java\n@@ -1228,4 +1306,4 @@\n-C:\\[rs]>javac greetings\\[rs]*.java\n-C:\\[rs]>dir greetings\n-Aloha.class         GutenTag.class      Hello.class         Hi.class\n-Aloha.java          GutenTag.java       Hello.java          Hi.java\n+C:\\\\>javac\\ greetings\\\\*.java\n+C:\\\\>dir\\ greetings\n+Aloha.class\\ \\ \\ \\ \\ \\ \\ \\ \\ GutenTag.class\\ \\ \\ \\ \\ \\ Hello.class\\ \\ \\ \\ \\ \\ \\ \\ \\ Hi.class\n+Aloha.java\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ GutenTag.java\\ \\ \\ \\ \\ \\ \\ Hello.java\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ Hi.java\n@@ -1245,1 +1323,1 @@\n-javac greetings\/Hi.java\n+javac\\ greetings\/Hi.java\n@@ -1253,3 +1331,3 @@\n-C:\\[rs]>cd\n-\\[rs]examples\n-C:\\[rs]>javac greetings\\[rs]Hi.java\n+C:\\\\>cd\n+\\\\examples\n+C:\\\\>javac\\ greetings\\\\Hi.java\n@@ -1259,2 +1337,2 @@\n-Because \\f[V]greetings.Hi\\f[R] refers to other classes in the\n-\\f[V]greetings\\f[R] package, the compiler needs to find these other\n+Because \\f[CB]greetings.Hi\\f[R] refers to other classes in the\n+\\f[CB]greetings\\f[R] package, the compiler needs to find these other\n@@ -1266,2 +1344,2 @@\n-setting \\f[V]CLASSPATH\\f[R].\n-This example uses the \\f[V]-classpath\\f[R] option.\n+setting \\f[CB]CLASSPATH\\f[R].\n+This example uses the \\f[CB]\\-classpath\\f[R] option.\n@@ -1272,1 +1350,1 @@\n-\\f[V]javac -classpath \/examples \/examples\/greetings\/Hi.java\\f[R]\n+\\f[CB]javac\\ \\-classpath\\ \/examples\\ \/examples\/greetings\/Hi.java\\f[R]\n@@ -1278,1 +1356,1 @@\n-\\f[V]C:\\[rs]>javac -classpath \\[rs]examples \\[rs]examples\\[rs]greetings\\[rs]Hi.java\\f[R]\n+\\f[CB]C:\\\\>javac\\ \\-classpath\\ \\\\examples\\ \\\\examples\\\\greetings\\\\Hi.java\\f[R]\n@@ -1281,1 +1359,1 @@\n-If you change \\f[V]greetings.Hi\\f[R] to use a banner utility, then that\n+If you change \\f[CB]greetings.Hi\\f[R] to use a banner utility, then that\n@@ -1288,2 +1366,2 @@\n-javac -classpath \/examples:\/lib\/Banners.jar \\[rs]\n-            \/examples\/greetings\/Hi.java\n+javac\\ \\-classpath\\ \/examples:\/lib\/Banners.jar\\ \\\\\n+\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \/examples\/greetings\/Hi.java\n@@ -1297,2 +1375,2 @@\n-C:\\[rs]>javac -classpath \\[rs]examples;\\[rs]lib\\[rs]Banners.jar \\[ha]\n-            \\[rs]examples\\[rs]greetings\\[rs]Hi.java\n+C:\\\\>javac\\ \\-classpath\\ \\\\examples;\\\\lib\\\\Banners.jar\\ ^\n+\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\\\examples\\\\greetings\\\\Hi.java\n@@ -1302,3 +1380,3 @@\n-To execute a class in the \\f[V]greetings\\f[R] package, the program needs\n-access to the \\f[V]greetings\\f[R] package, and to the classes that the\n-\\f[V]greetings\\f[R] classes use.\n+To execute a class in the \\f[CB]greetings\\f[R] package, the program needs\n+access to the \\f[CB]greetings\\f[R] package, and to the classes that the\n+\\f[CB]greetings\\f[R] classes use.\n@@ -1309,1 +1387,1 @@\n-\\f[V]java -classpath \/examples:\/lib\/Banners.jar greetings.Hi\\f[R]\n+\\f[CB]java\\ \\-classpath\\ \/examples:\/lib\/Banners.jar\\ greetings.Hi\\f[R]\n@@ -1315,1 +1393,1 @@\n-\\f[V]C:\\[rs]>java -classpath \\[rs]examples;\\[rs]lib\\[rs]Banners.jar greetings.Hi\\f[R]\n+\\f[CB]C:\\\\>java\\ \\-classpath\\ \\\\examples;\\\\lib\\\\Banners.jar\\ greetings.Hi\\f[R]\n@@ -1320,1 +1398,1 @@\n-\\f[B]\\f[VB]--add-modules\\f[B]\\f[R] option.\n+\\f[B]\\f[BC]\\-\\-add\\-modules\\f[B]\\f[R] option.\n@@ -1326,1 +1404,1 @@\n-\\f[B]\\f[VB]--limit-modules\\f[B]\\f[R] option.\n+\\f[B]\\f[BC]\\-\\-limit\\-modules\\f[B]\\f[R] option.\n@@ -1333,2 +1411,2 @@\n-\\f[B]\\f[VB]--add-exports\\f[B]\\f[R] option.\n-This may be useful when performing white-box testing; relying on access\n+\\f[B]\\f[BC]\\-\\-add\\-exports\\f[B]\\f[R] option.\n+This may be useful when performing white\\-box testing; relying on access\n@@ -1338,2 +1416,2 @@\n-required by a module, use the \\f[B]\\f[VB]--add-reads\\f[B]\\f[R] option.\n-This may be useful when performing white-box testing; relying on access\n+required by a module, use the \\f[B]\\f[BC]\\-\\-add\\-reads\\f[B]\\f[R] option.\n+This may be useful when performing white\\-box testing; relying on access\n@@ -1343,1 +1421,1 @@\n-\\f[B]\\f[VB]--patch-module\\f[B]\\f[R] option.\n+\\f[B]\\f[BC]\\-\\-patch\\-module\\f[B]\\f[R] option.\n@@ -1351,2 +1429,2 @@\n-\\f[V]javac\\f[R] needs type information for every class or interface\n-used, extended, or implemented in the source file.\n+\\f[CB]javac\\f[R] needs type information for every class or interface used,\n+extended, or implemented in the source file.\n@@ -1356,4 +1434,4 @@\n-For example, when you create a subclass of \\f[V]java.awt.Window\\f[R],\n-you are also using the ancestor classes of \\f[V]Window\\f[R]:\n-\\f[V]java.awt.Container\\f[R], \\f[V]java.awt.Component\\f[R], and\n-\\f[V]java.lang.Object\\f[R].\n+For example, when you create a subclass of \\f[CB]java.awt.Window\\f[R], you\n+are also using the ancestor classes of \\f[CB]Window\\f[R]:\n+\\f[CB]java.awt.Container\\f[R], \\f[CB]java.awt.Component\\f[R], and\n+\\f[CB]java.lang.Object\\f[R].\n@@ -1365,1 +1443,1 @@\n-If both are found, then you can use the \\f[B]\\f[VB]-Xprefer\\f[B]\\f[R]\n+If both are found, then you can use the \\f[B]\\f[BC]\\-Xprefer\\f[B]\\f[R]\n@@ -1368,3 +1446,3 @@\n-If a search finds and uses a source file, then by default\n-\\f[V]javac\\f[R] compiles that source file.\n-This behavior can be altered with \\f[B]\\f[VB]-implicit\\f[B]\\f[R].\n+If a search finds and uses a source file, then by default \\f[CB]javac\\f[R]\n+compiles that source file.\n+This behavior can be altered with \\f[B]\\f[BC]\\-implicit\\f[B]\\f[R].\n@@ -1375,1 +1453,1 @@\n-\\f[B]\\f[VB]-implicit\\f[B]\\f[R] option is specified, the compiler gives a\n+\\f[B]\\f[BC]\\-implicit\\f[B]\\f[R] option is specified, the compiler gives a\n@@ -1380,1 +1458,1 @@\n-\\f[B]\\f[VB]-implicit\\f[B]\\f[R] option to specify whether or not class\n+\\f[B]\\f[BC]\\-implicit\\f[B]\\f[R] option to specify whether or not class\n@@ -1383,1 +1461,1 @@\n-The way that \\f[V]javac\\f[R] locates the declarations of those types\n+The way that \\f[CB]javac\\f[R] locates the declarations of those types\n@@ -1388,1 +1466,1 @@\n-oriented locations, \\f[V]javac\\f[R] will check each location on the path\n+oriented locations, \\f[CB]javac\\f[R] will check each location on the path\n@@ -1391,1 +1469,1 @@\n-occurrences of like-named files.\n+occurrences of like\\-named files.\n@@ -1395,1 +1473,1 @@\n-grouped in different locations, such as shared code, platform-specific\n+grouped in different locations, such as shared code, platform\\-specific\n@@ -1404,1 +1482,1 @@\n-\\f[V]javac\\f[R] will lazily scan the following paths and locations to\n+\\f[CB]javac\\f[R] will lazily scan the following paths and locations to\n@@ -1408,1 +1486,1 @@\n-\\f[B]\\f[VB]--module-source-path\\f[B]\\f[R] option)\n+\\f[B]\\f[BC]\\-\\-module\\-source\\-path\\f[B]\\f[R] option)\n@@ -1411,1 +1489,1 @@\n-\\f[B]\\f[VB]--upgrade-module-path\\f[B]\\f[R] option)\n+\\f[B]\\f[BC]\\-\\-upgrade\\-module\\-path\\f[B]\\f[R] option)\n@@ -1413,1 +1491,1 @@\n-The system modules (see the \\f[B]\\f[VB]--system\\f[B]\\f[R] option)\n+The system modules (see the \\f[B]\\f[BC]\\-\\-system\\f[B]\\f[R] option)\n@@ -1415,1 +1493,1 @@\n-The user module path ( see the \\f[B]\\f[VB]--module-path\\f[B]\\f[R]\n+The user module path ( see the \\f[B]\\f[BC]\\-\\-module\\-path\\f[B]\\f[R]\n@@ -1419,1 +1497,1 @@\n-completely shadows (hides) any subsequent appearance of a like-named\n+completely shadows (hides) any subsequent appearance of a like\\-named\n@@ -1421,1 +1499,1 @@\n-While locating the modules, \\f[V]javac\\f[R] is able to determine the\n+While locating the modules, \\f[CB]javac\\f[R] is able to determine the\n@@ -1426,1 +1504,1 @@\n-directory-like hierarchy, such as a JAR file.\n+directory\\-like hierarchy, such as a JAR file.\n@@ -1428,2 +1506,2 @@\n-exported by a module, \\f[V]javac\\f[R] can locate the declaration\n-directly and efficiently.\n+exported by a module, \\f[CB]javac\\f[R] can locate the declaration directly\n+and efficiently.\n@@ -1433,1 +1511,1 @@\n-located in a file named \\f[V]module-info.class\\f[R] in the root of the\n+located in a file named \\f[CB]module\\-info.class\\f[R] in the root of the\n@@ -1437,1 +1515,1 @@\n-declaration will be either the file named \\f[V]module-info.class\\f[R] in\n+declaration will be either the file named \\f[CB]module\\-info.class\\f[R] in\n@@ -1439,1 +1517,1 @@\n-directory, or the file named \\f[V]module-info.java\\f[R] in one of the\n+directory, or the file named \\f[CB]module\\-info.java\\f[R] in one of the\n@@ -1442,1 +1520,2 @@\n-.SS Searching for the Declaration of a Type When the Reference is not in a Module\n+.SS Searching for the Declaration of a Type When the Reference is not in\n+a Module\n@@ -1445,1 +1524,1 @@\n-module, \\f[V]javac\\f[R] will look in the following places:\n+module, \\f[CB]javac\\f[R] will look in the following places:\n@@ -1457,1 +1536,1 @@\n-If both are specified, \\f[V]javac\\f[R] looks for compiled class files on\n+If both are specified, \\f[CB]javac\\f[R] looks for compiled class files on\n@@ -1460,1 +1539,1 @@\n-If the class path is specified, but not source path, \\f[V]javac\\f[R]\n+If the class path is specified, but not source path, \\f[CB]javac\\f[R]\n@@ -1472,1 +1551,1 @@\n-You can use the \\f[B]\\f[VB]-Xprefer\\f[B]\\f[R] option to override the\n+You can use the \\f[B]\\f[BC]\\-Xprefer\\f[B]\\f[R] option to override the\n@@ -1474,1 +1553,2 @@\n-.SS Searching for the Declaration of a Type When the Reference is in a Module\n+.SS Searching for the Declaration of a Type When the Reference is in a\n+Module\n@@ -1477,1 +1557,1 @@\n-\\f[V]javac\\f[R] will examine the declaration of the enclosing module to\n+\\f[CB]javac\\f[R] will examine the declaration of the enclosing module to\n@@ -1480,1 +1560,1 @@\n-If so, \\f[V]javac\\f[R] will simply and directly go to the definition of\n+If so, \\f[CB]javac\\f[R] will simply and directly go to the definition of\n@@ -1483,2 +1563,2 @@\n-\\f[V]javac\\f[R] will only look for compiled class files files.\n-In other words, \\f[V]javac\\f[R] will not look for source files in\n+\\f[CB]javac\\f[R] will only look for compiled class files files.\n+In other words, \\f[CB]javac\\f[R] will not look for source files in\n@@ -1488,1 +1568,1 @@\n-\\f[V]javac\\f[R] will examine the module being compiled to try and find\n+\\f[CB]javac\\f[R] will examine the module being compiled to try and find\n@@ -1490,1 +1570,1 @@\n-\\f[V]javac\\f[R] will look for the declaration of the type as follows:\n+\\f[CB]javac\\f[R] will look for the declaration of the type as follows:\n@@ -1498,1 +1578,1 @@\n-\\f[V]javac\\f[R] generally assumes that source files and compiled class\n+\\f[CB]javac\\f[R] generally assumes that source files and compiled class\n@@ -1506,1 +1586,1 @@\n-While \\f[V]javac\\f[R] is fairly relaxed about the organization of source\n+While \\f[CB]javac\\f[R] is fairly relaxed about the organization of source\n@@ -1510,1 +1590,1 @@\n-general, and \\f[V]javac\\f[R] and the Java launcher in particular, are\n+general, and \\f[CB]javac\\f[R] and the Java launcher in particular, are\n@@ -1515,3 +1595,4 @@\n-The location of these hierarchies are specified to \\f[V]javac\\f[R] with\n-command-line options, whose names typically end in \\[dq]path\\[dq], like\n-\\f[B]\\f[VB]--source-path\\f[B]\\f[R] or \\f[B]\\f[VB]--class-path\\f[B]\\f[R].\n+The location of these hierarchies are specified to \\f[CB]javac\\f[R] with\n+command\\-line options, whose names typically end in \"path\", like\n+\\f[B]\\f[BC]\\-\\-source\\-path\\f[B]\\f[R] or\n+\\f[B]\\f[BC]\\-\\-class\\-path\\f[B]\\f[R].\n@@ -1519,3 +1600,3 @@\n-\\f[V]module\\f[R], like \\f[B]\\f[VB]--module-path\\f[B]\\f[R], are used to\n-specify module hierarchies, although some module-related path options\n-allow a package hierarchy to be specified on a per-module basis.\n+\\f[CB]module\\f[R], like \\f[B]\\f[BC]\\-\\-module\\-path\\f[B]\\f[R], are used to\n+specify module hierarchies, although some module\\-related path options\n+allow a package hierarchy to be specified on a per\\-module basis.\n@@ -1528,1 +1609,1 @@\n-extension of \\f[V].java\\f[R] or \\f[V].class\\f[R] in the most nested\n+extension of \\f[CB]\\&.java\\f[R] or \\f[CB]\\&.class\\f[R] in the most nested\n@@ -1532,1 +1613,1 @@\n-\\f[V]com.example.MyClass\\f[R] will be stored in the file\n+\\f[CB]com.example.MyClass\\f[R] will be stored in the file\n@@ -1541,2 +1622,2 @@\n-called \\f[V]com.example.MyClass\\f[R] in a module called\n-\\f[V]my.library\\f[R] will be stored in\n+called \\f[CB]com.example.MyClass\\f[R] in a module called\n+\\f[CB]my.library\\f[R] will be stored in\n@@ -1545,1 +1626,1 @@\n-The various output directories used by \\f[V]javac\\f[R] (the class output\n+The various output directories used by \\f[CB]javac\\f[R] (the class output\n@@ -1560,2 +1641,2 @@\n-called \\f[V]com.example.MyClass\\f[R] in a module called\n-\\f[V]my.library\\f[R] may be stored in a file such as\n+called \\f[CB]com.example.MyClass\\f[R] in a module called\n+\\f[CB]my.library\\f[R] may be stored in a file such as\n@@ -1565,2 +1646,2 @@\n-The \\f[B]\\f[VB]--module-source-path\\f[B]\\f[R] option has two forms: a\n-\\f[I]module-specific form\\f[R], in which a package path is given for\n+The \\f[B]\\f[BC]\\-\\-module\\-source\\-path\\f[B]\\f[R] option has two forms: a\n+\\f[I]module\\-specific form\\f[R], in which a package path is given for\n@@ -1568,1 +1649,1 @@\n-\\f[I]module-pattern\\f[R] form, in which the source path for each module\n+\\f[I]module\\-pattern\\f[R] form, in which the source path for each module\n@@ -1570,2 +1651,2 @@\n-The module-specific form is generally simpler to use when only a small\n-number of modules are involved; the module-pattern form may be more\n+The module\\-specific form is generally simpler to use when only a small\n+number of modules are involved; the module\\-pattern form may be more\n@@ -1575,3 +1656,3 @@\n-Multiple instances of the \\f[V]--module-source-path\\f[R] option may be\n-given, each one using either the module-pattern form or the\n-module-specific form, subject to the following limitations:\n+Multiple instances of the \\f[CB]\\-\\-module\\-source\\-path\\f[R] option may\n+be given, each one using either the module\\-pattern form or the\n+module\\-specific form, subject to the following limitations:\n@@ -1579,1 +1660,1 @@\n-the module-pattern form may be used at most once\n+the module\\-pattern form may be used at most once\n@@ -1581,1 +1662,1 @@\n-the module-specific form may be used at most once for any given module\n+the module\\-specific form may be used at most once for any given module\n@@ -1583,1 +1664,1 @@\n-If the module-specific form is used for any module, the associated\n+If the module\\-specific form is used for any module, the associated\n@@ -1585,2 +1666,2 @@\n-from the module-pattern form.\n-.SS Module-specific form\n+from the module\\-pattern form.\n+.SS Module\\-specific form\n@@ -1588,1 +1669,1 @@\n-The module-specific form allows an explicit search path to be given for\n+The module\\-specific form allows an explicit search path to be given for\n@@ -1592,3 +1673,3 @@\n-\\f[V]--module-source-path\\f[R]\n-\\f[I]module-name\\f[R]\\f[V]=\\f[R]\\f[I]file-path\\f[R]\n-(\\f[I]path-separator\\f[R] \\f[I]file-path\\f[R])*\n+\\f[CB]\\-\\-module\\-source\\-path\\f[R]\n+\\f[I]module\\-name\\f[R]\\f[CB]=\\f[R]\\f[I]file\\-path\\f[R]\n+(\\f[I]path\\-separator\\f[R] \\f[I]file\\-path\\f[R])*\n@@ -1596,1 +1677,1 @@\n-The path separator character is \\f[V];\\f[R] on Windows, and \\f[V]:\\f[R]\n+The path separator character is \\f[CB];\\f[R] on Windows, and \\f[CB]:\\f[R]\n@@ -1600,2 +1681,2 @@\n-\\f[B]\\f[VB]--patch-module\\f[B]\\f[R] option.\n-.SS Module-pattern form\n+\\f[B]\\f[BC]\\-\\-patch\\-module\\f[B]\\f[R] option.\n+.SS Module\\-pattern form\n@@ -1603,1 +1684,1 @@\n-The module-pattern form allows a concise specification of the module\n+The module\\-pattern form allows a concise specification of the module\n@@ -1606,1 +1687,1 @@\n-\\f[V]--module-source-path\\f[R] \\f[I]pattern\\f[R]\n+\\f[CB]\\-\\-module\\-source\\-path\\f[R] \\f[I]pattern\\f[R]\n@@ -1612,1 +1693,1 @@\n-path separator character (\\f[V];\\f[R] on Windows, and \\f[V]:\\f[R]\n+path separator character (\\f[CB];\\f[R] on Windows, and \\f[CB]:\\f[R]\n@@ -1620,1 +1701,1 @@\n-string1{alt1 ( ,alt2 )* } string2\n+string1{alt1\\ (\\ ,alt2\\ )*\\ }\\ string2\n@@ -1625,1 +1706,1 @@\n-\\[dq]expanding\\[dq] the braces:\n+\"expanding\" the braces:\n@@ -1629,3 +1710,3 @@\n-string1 alt1 string2\n-string1 alt2 string2\n-and so on...\n+string1\\ alt1\\ string2\n+string1\\ alt2\\ string2\n+and\\ so\\ on...\n@@ -1640,1 +1721,1 @@\n-Each segment must have at most one asterisk (\\f[V]*\\f[R]).\n+Each segment must have at most one asterisk (\\f[CB]*\\f[R]).\n@@ -1651,1 +1732,1 @@\n-It should not be confused with the use of \\f[V]*\\f[R] as a file name\n+It should not be confused with the use of \\f[CB]*\\f[R] as a file name\n@@ -1657,1 +1738,1 @@\n-patched into any module using the \\f[B]\\f[VB]--patch-module\\f[B]\\f[R]\n+patched into any module using the \\f[B]\\f[BC]\\-\\-patch\\-module\\f[B]\\f[R]\n@@ -1665,3 +1746,3 @@\n-\\f[V]--patch-module\\f[R]\n-\\f[I]module-name\\f[R]\\f[V]=\\f[R]\\f[I]file-path\\f[R]\n-(\\f[I]path-separator\\f[R] \\f[I]file-path\\f[R] )*\n+\\f[CB]\\-\\-patch\\-module\\f[R]\n+\\f[I]module\\-name\\f[R]\\f[CB]=\\f[R]\\f[I]file\\-path\\f[R]\n+(\\f[I]path\\-separator\\f[R] \\f[I]file\\-path\\f[R] )*\n@@ -1669,1 +1750,1 @@\n-The path separator character is \\f[V];\\f[R] on Windows, and \\f[V]:\\f[R]\n+The path separator character is \\f[CB];\\f[R] on Windows, and \\f[CB]:\\f[R]\n@@ -1675,1 +1756,1 @@\n-Any content on the path will hide any like-named content later in the\n+Any content on the path will hide any like\\-named content later in the\n@@ -1679,2 +1760,2 @@\n-\\f[B]\\f[VB]--module-source-path\\f[B]\\f[R] must also be used, so that the\n-output directory is organized in a module hierarchy, and capable of\n+\\f[B]\\f[BC]\\-\\-module\\-source\\-path\\f[B]\\f[R] must also be used, so that\n+the output directory is organized in a module hierarchy, and capable of\n@@ -1684,1 +1765,1 @@\n-The \\f[V]javac\\f[R] command provides direct support for annotation\n+The \\f[CB]javac\\f[R] command provides direct support for annotation\n@@ -1688,1 +1769,1 @@\n-\\f[V]javax.annotation.processing\\f[R] and \\f[V]javax.lang.model\\f[R]\n+\\f[CB]javax.annotation.processing\\f[R] and \\f[CB]javax.lang.model\\f[R]\n@@ -1693,1 +1774,1 @@\n-\\f[B]\\f[VB]-proc:none\\f[B]\\f[R] option, the compiler searches for any\n+\\f[B]\\f[BC]\\-proc:none\\f[B]\\f[R] option, the compiler searches for any\n@@ -1696,1 +1777,1 @@\n-\\f[B]\\f[VB]-processorpath\\f[B]\\f[R] option.\n+\\f[B]\\f[BC]\\-processorpath\\f[B]\\f[R] option.\n@@ -1698,2 +1779,2 @@\n-Processors are located by means of service provider-configuration files\n-named \\f[V]META-INF\/services\/javax.annotation.processing\\f[R].\n+Processors are located by means of service provider\\-configuration files\n+named \\f[CB]META\\-INF\/services\/javax.annotation.processing\\f[R].\n@@ -1704,1 +1785,1 @@\n-\\f[B]\\f[VB]-processor\\f[B]\\f[R] option.\n+\\f[B]\\f[BC]\\-processor\\f[B]\\f[R] option.\n@@ -1725,1 +1806,1 @@\n-Finally, unless the \\f[B]\\f[VB]-proc:only\\f[B]\\f[R] option is used, the\n+Finally, unless the \\f[B]\\f[BC]\\-proc:only\\f[B]\\f[R] option is used, the\n@@ -1733,1 +1814,1 @@\n-\\f[B]\\f[VB]--default-module-for-created-files\\f[B]\\f[R] option.\n+\\f[B]\\f[BC]\\-\\-default\\-module\\-for\\-created\\-files\\f[B]\\f[R] option.\n@@ -1737,7 +1818,7 @@\n-analyzed by \\f[V]javac\\f[R] in a \\f[I]compilation environment\\f[R] that\n-is distinct from the \\f[I]runtime environment\\f[R] used to execute\n-\\f[V]javac\\f[R] itself.\n-Although there is a deliberate similarity between many \\f[V]javac\\f[R]\n-options and like-named options for the Java \\f[B]launcher\\f[R], such as\n-\\f[V]--class-path\\f[R], \\f[V]--module-path\\f[R] and so on, it is\n-important to understand that in general the \\f[V]javac\\f[R] options just\n+analyzed by \\f[CB]javac\\f[R] in a \\f[I]compilation environment\\f[R] that is\n+distinct from the \\f[I]runtime environment\\f[R] used to execute\n+\\f[CB]javac\\f[R] itself.\n+Although there is a deliberate similarity between many \\f[CB]javac\\f[R]\n+options and like\\-named options for the Java \\f[B]launcher\\f[R], such as\n+\\f[CB]\\-\\-class\\-path\\f[R], \\f[CB]\\-\\-module\\-path\\f[R] and so on, it is\n+important to understand that in general the \\f[CB]javac\\f[R] options just\n@@ -1745,1 +1826,1 @@\n-not affect the operation of \\f[V]javac\\f[R] itself.\n+not affect the operation of \\f[CB]javac\\f[R] itself.\n@@ -1755,5 +1836,5 @@\n-(See the \\f[B]\\f[VB]--processor-path\\f[B]\\f[R] option.)\n-If the annotation processor and its dependencies are in modules, you\n-should use the processor module path instead.\n-(See the \\f[B]\\f[VB]--processor-module-path\\f[B]\\f[R] option.)\n-When those are insufficient, it may be necessary to provide further\n+(See the \\f[B]\\f[BC]\\-\\-processor\\-path\\f[B]\\f[R] option.) If the\n+annotation processor and its dependencies are in modules, you should use\n+the processor module path instead.\n+(See the \\f[B]\\f[BC]\\-\\-processor\\-module\\-path\\f[B]\\f[R] option.) When\n+those are insufficient, it may be necessary to provide further\n@@ -1763,1 +1844,1 @@\n-If \\f[V]javac\\f[R] is invoked from the command line, options can be\n+If \\f[CB]javac\\f[R] is invoked from the command line, options can be\n@@ -1765,1 +1846,1 @@\n-\\f[B]\\f[VB]-J\\f[B]\\f[R].\n+\\f[B]\\f[BC]\\-J\\f[B]\\f[R].\n@@ -1769,1 +1850,1 @@\n-\\f[V]javac\\f[R] can be invoked via one of its \\f[B]APIs\\f[R].\n+\\f[CB]javac\\f[R] can be invoked via one of its \\f[B]APIs\\f[R].\n@@ -1772,4 +1853,4 @@\n-\\f[V]javac\\f[R] can compile code that is to be used on other releases of\n-the platform, using either the \\f[B]\\f[VB]--release\\f[B]\\f[R] option, or\n-the \\f[B]\\f[VB]--source\\f[B]\\f[R]\/\\f[V]-source\\f[R] and\n-\\f[B]\\f[VB]--target\\f[B]\\f[R]\/\\f[V]-target\\f[R] options, together with\n+\\f[CB]javac\\f[R] can compile code that is to be used on other releases of\n+the platform, using either the \\f[B]\\f[BC]\\-\\-release\\f[B]\\f[R] option,\n+or the \\f[B]\\f[BC]\\-\\-source\\f[B]\\f[R]\/\\f[CB]\\-source\\f[R] and\n+\\f[B]\\f[BC]\\-\\-target\\f[B]\\f[R]\/\\f[CB]\\-target\\f[R] options, together with\n@@ -1786,10 +1867,11 @@\n-\\f[B]\\f[VB]--module-source-path\\f[B]\\f[R],\n-\\f[B]\\f[VB]--upgrade-module-path\\f[B]\\f[R],\n-\\f[B]\\f[VB]--system\\f[B]\\f[R], \\f[B]\\f[VB]--module-path\\f[B]\\f[R],\n-\\f[B]\\f[VB]--add-modules\\f[B]\\f[R], \\f[B]\\f[VB]--add-exports\\f[B]\\f[R],\n-\\f[V]--add-opens\\f[R], \\f[B]\\f[VB]--add-reads\\f[B]\\f[R],\n-\\f[B]\\f[VB]--limit-modules\\f[B]\\f[R],\n-\\f[B]\\f[VB]--patch-module\\f[B]\\f[R]\n-.PP\n-If you use the \\f[V]--source\\f[R]\/\\f[V]-source\\f[R] or\n-\\f[V]--target\\f[R]\/\\f[V]-target\\f[R] options, you should also set the\n+\\f[B]\\f[BC]\\-\\-module\\-source\\-path\\f[B]\\f[R],\n+\\f[B]\\f[BC]\\-\\-upgrade\\-module\\-path\\f[B]\\f[R],\n+\\f[B]\\f[BC]\\-\\-system\\f[B]\\f[R], \\f[B]\\f[BC]\\-\\-module\\-path\\f[B]\\f[R],\n+\\f[B]\\f[BC]\\-\\-add\\-modules\\f[B]\\f[R],\n+\\f[B]\\f[BC]\\-\\-add\\-exports\\f[B]\\f[R], \\f[CB]\\-\\-add\\-opens\\f[R],\n+\\f[B]\\f[BC]\\-\\-add\\-reads\\f[B]\\f[R],\n+\\f[B]\\f[BC]\\-\\-limit\\-modules\\f[B]\\f[R],\n+\\f[B]\\f[BC]\\-\\-patch\\-module\\f[B]\\f[R]\n+.PP\n+If you use the \\f[CB]\\-\\-source\\f[R]\/\\f[CB]\\-source\\f[R] or\n+\\f[CB]\\-\\-target\\f[R]\/\\f[CB]\\-target\\f[R] options, you should also set the\n@@ -1805,7 +1887,7 @@\n-\\f[B]\\f[VB]-Xbootclasspath\/p:\\f[B]\\f[R],\n-\\f[B]\\f[VB]-Xbootclasspath\\f[B]\\f[R],\n-\\f[B]\\f[VB]-Xbootclasspath\/a:\\f[B]\\f[R],\n-\\f[B]\\f[VB]-endorseddirs\\f[B]\\f[R],\n-\\f[B]\\f[VB]-Djava.endorsed.dirs\\f[B]\\f[R],\n-\\f[B]\\f[VB]-extdirs\\f[B]\\f[R], \\f[B]\\f[VB]-Djava.ext.dirs\\f[B]\\f[R],\n-\\f[B]\\f[VB]-profile\\f[B]\\f[R]\n+\\f[B]\\f[BC]\\-Xbootclasspath\/p:\\f[B]\\f[R],\n+\\f[B]\\f[BC]\\-Xbootclasspath\\f[B]\\f[R],\n+\\f[B]\\f[BC]\\-Xbootclasspath\/a:\\f[B]\\f[R],\n+\\f[B]\\f[BC]\\-endorseddirs\\f[B]\\f[R],\n+\\f[B]\\f[BC]\\-Djava.endorsed.dirs\\f[B]\\f[R],\n+\\f[B]\\f[BC]\\-extdirs\\f[B]\\f[R], \\f[B]\\f[BC]\\-Djava.ext.dirs\\f[B]\\f[R],\n+\\f[B]\\f[BC]\\-profile\\f[B]\\f[R]\n@@ -1813,4 +1895,4 @@\n-If you use the \\f[V]--source\\f[R]\/\\f[V]-source\\f[R] or\n-\\f[V]--target\\f[R]\/\\f[V]-target\\f[R] options, you should also set the\n-appropriate platform classes using the \\f[V]--system\\f[R] option to give\n-the location of an appropriate installed release of JDK.\n+If you use the \\f[CB]\\-\\-source\\f[R]\/\\f[CB]\\-source\\f[R] or\n+\\f[CB]\\-\\-target\\f[R]\/\\f[CB]\\-target\\f[R] options, you should also set the\n+appropriate platform classes using the \\f[CB]\\-\\-system\\f[R] option to\n+give the location of an appropriate installed release of JDK.\n@@ -1819,3 +1901,3 @@\n-When using the \\f[V]--release\\f[R] option, only the supported documented\n-API for that release may be used; you cannot use any options to break\n-encapsulation to access any internal classes.\n+When using the \\f[CB]\\-\\-release\\f[R] option, only the supported\n+documented API for that release may be used; you cannot use any options\n+to break encapsulation to access any internal classes.\n@@ -1824,1 +1906,1 @@\n-The \\f[V]javac\\f[R] compiler can be invoked using an API in three\n+The \\f[CB]javac\\f[R] compiler can be invoked using an API in three\n@@ -1827,1 +1909,1 @@\n-The \\f[B]Java Compiler API\\f[R]\n+.B The \\f[B]Java Compiler API\\f[R]\n@@ -1830,1 +1912,3 @@\n-non-standard file systems.\n+non\\-standard file systems.\n+.RS\n+.RE\n@@ -1832,3 +1916,3 @@\n-The \\f[B]ToolProvider API\\f[R]\n-A \\f[V]ToolProvider\\f[R] for \\f[V]javac\\f[R] can be obtained by calling\n-\\f[V]ToolProvider.findFirst(\\[dq]javac\\[dq])\\f[R].\n+.B The \\f[B]ToolProvider API\\f[R]\n+A \\f[CB]ToolProvider\\f[R] for \\f[CB]javac\\f[R] can be obtained by calling\n+\\f[CB]ToolProvider.findFirst(\"javac\")\\f[R].\n@@ -1836,1 +1920,1 @@\n-command-line tool.\n+command\\-line tool.\n@@ -1839,2 +1923,2 @@\n-\\f[B]Note\\f[R]: This API should not be confused with the like-named API\n-in the \\f[B]\\f[VB]javax.tools\\f[B]\\f[R] package.\n+\\f[B]Note\\f[R]: This API should not be confused with the like\\-named API\n+in the \\f[B]\\f[BC]javax.tools\\f[B]\\f[R] package.\n@@ -1843,1 +1927,1 @@\n-The \\f[V]javac\\f[R] \\f[B]Legacy API\\f[R]\n+.B The \\f[CB]javac\\f[R] \\f[B]Legacy API\\f[R]\n@@ -1847,0 +1931,2 @@\n+.RS\n+.RE\n@@ -1849,2 +1935,2 @@\n-names that start with \\f[V]com.sun.tools.javac\\f[R] (subpackages of\n-\\f[V]com.sun.tools.javac\\f[R]) are strictly internal and subject to\n+names that start with \\f[CB]com.sun.tools.javac\\f[R] (subpackages of\n+\\f[CB]com.sun.tools.javac\\f[R]) are strictly internal and subject to\n@@ -1852,1 +1938,1 @@\n-.SH EXAMPLES OF USING -XLINT KEYS\n+.SH EXAMPLES OF USING \\-XLINT KEYS\n@@ -1854,1 +1940,1 @@\n-\\f[V]cast\\f[R]\n+.B \\f[CB]cast\\f[R]\n@@ -1859,1 +1945,1 @@\n-\\f[V]String s = (String) \\[dq]Hello!\\[dq]\\f[R]\n+\\f[CB]String\\ s\\ =\\ (String)\\ \"Hello!\"\\f[R]\n@@ -1863,1 +1949,1 @@\n-\\f[V]classfile\\f[R]\n+.B \\f[CB]classfile\\f[R]\n@@ -1865,0 +1951,2 @@\n+.RS\n+.RE\n@@ -1866,1 +1954,1 @@\n-\\f[V]deprecation\\f[R]\n+.B \\f[CB]deprecation\\f[R]\n@@ -1873,2 +1961,2 @@\n-java.util.Date myDate = new java.util.Date();\n-int currentDay = myDate.getDay();\n+java.util.Date\\ myDate\\ =\\ new\\ java.util.Date();\n+int\\ currentDay\\ =\\ myDate.getDay();\n@@ -1878,1 +1966,1 @@\n-The method \\f[V]java.util.Date.getDay\\f[R] has been deprecated since JDK\n+The method \\f[CB]java.util.Date.getDay\\f[R] has been deprecated since JDK\n@@ -1882,4 +1970,4 @@\n-\\f[V]dep-ann\\f[R]\n-Warns about items that are documented with the \\f[V]\\[at]deprecated\\f[R]\n-Javadoc comment, but do not have the \\f[V]\\[at]Deprecated\\f[R]\n-annotation, for example:\n+.B \\f[CB]dep\\-ann\\f[R]\n+Warns about items that are documented with the \\f[CB]\\@deprecated\\f[R]\n+Javadoc comment, but do not have the \\f[CB]\\@Deprecated\\f[R] annotation,\n+for example:\n@@ -1891,4 +1979,4 @@\n-  * \\[at]deprecated As of Java SE 7, replaced by {\\[at]link #newMethod()}\n-  *\/\n-public static void deprecatedMethod() { }\n-public static void newMethod() { }\n+\\ \\ *\\ \\@deprecated\\ As\\ of\\ Java\\ SE\\ 7,\\ replaced\\ by\\ {\\@link\\ #newMethod()}\n+\\ \\ *\/\n+public\\ static\\ void\\ deprecatedMethod()\\ {\\ }\n+public\\ static\\ void\\ newMethod()\\ {\\ }\n@@ -1899,1 +1987,1 @@\n-\\f[V]divzero\\f[R]\n+.B \\f[CB]divzero\\f[R]\n@@ -1904,1 +1992,1 @@\n-\\f[V]int divideByZero = 42 \/ 0;\\f[R]\n+\\f[CB]int\\ divideByZero\\ =\\ 42\\ \/\\ 0;\\f[R]\n@@ -1908,2 +1996,2 @@\n-\\f[V]empty\\f[R]\n-Warns about empty statements after \\f[V]if\\f[R]statements, for example:\n+.B \\f[CB]empty\\f[R]\n+Warns about empty statements after \\f[CB]if\\f[R]statements, for example:\n@@ -1914,4 +2002,4 @@\n-class E {\n-    void m() {\n-         if (true) ;\n-    }\n+class\\ E\\ {\n+\\ \\ \\ \\ void\\ m()\\ {\n+\\ \\ \\ \\ \\ \\ \\ \\ \\ if\\ (true)\\ ;\n+\\ \\ \\ \\ }\n@@ -1923,2 +2011,2 @@\n-\\f[V]fallthrough\\f[R]\n-Checks the switch blocks for fall-through cases and provides a warning\n+.B \\f[CB]fallthrough\\f[R]\n+Checks the switch blocks for fall\\-through cases and provides a warning\n@@ -1926,3 +2014,4 @@\n-Fall-through cases are cases in a switch block, other than the last case\n-in the block, whose code does not include a \\f[V]break\\f[R] statement,\n-allowing code execution to fall through from that case to the next case.\n+Fall\\-through cases are cases in a switch block, other than the last\n+case in the block, whose code does not include a \\f[CB]break\\f[R]\n+statement, allowing code execution to fall through from that case to the\n+next case.\n@@ -1930,1 +2019,1 @@\n-does not end with a \\f[V]break\\f[R] statement:\n+does not end with a \\f[CB]break\\f[R] statement:\n@@ -1935,6 +2024,6 @@\n-switch (x) {\n-case 1:\n-  System.out.println(\\[dq]1\\[dq]);\n-  \/\/ No break statement here.\n-case 2:\n-  System.out.println(\\[dq]2\\[dq]);\n+switch\\ (x)\\ {\n+case\\ 1:\n+\\ \\ System.out.println(\"1\");\n+\\ \\ \/\/\\ No\\ break\\ statement\\ here.\n+case\\ 2:\n+\\ \\ System.out.println(\"2\");\n@@ -1945,3 +2034,3 @@\n-If the \\f[V]-Xlint:fallthrough\\f[R] option was used when compiling this\n-code, then the compiler emits a warning about possible fall-through into\n-case, with the line number of the case in question.\n+If the \\f[CB]\\-Xlint:fallthrough\\f[R] option was used when compiling this\n+code, then the compiler emits a warning about possible fall\\-through\n+into case, with the line number of the case in question.\n@@ -1950,2 +2039,2 @@\n-\\f[V]finally\\f[R]\n-Warns about \\f[V]finally\\f[R] clauses that cannot be completed normally,\n+.B \\f[CB]finally\\f[R]\n+Warns about \\f[CB]finally\\f[R] clauses that cannot be completed normally,\n@@ -1957,10 +2046,10 @@\n-public static int m() {\n-  try {\n-     throw new NullPointerException();\n-  }  catch (NullPointerException(); {\n-     System.err.println(\\[dq]Caught NullPointerException.\\[dq]);\n-     return 1;\n-   } finally {\n-     return 0;\n-   }\n-  }\n+public\\ static\\ int\\ m()\\ {\n+\\ \\ try\\ {\n+\\ \\ \\ \\ \\ throw\\ new\\ NullPointerException();\n+\\ \\ }\\ \\ catch\\ (NullPointerException();\\ {\n+\\ \\ \\ \\ \\ System.err.println(\"Caught\\ NullPointerException.\");\n+\\ \\ \\ \\ \\ return\\ 1;\n+\\ \\ \\ }\\ finally\\ {\n+\\ \\ \\ \\ \\ return\\ 0;\n+\\ \\ \\ }\n+\\ \\ }\n@@ -1970,1 +2059,1 @@\n-The compiler generates a warning for the \\f[V]finally\\f[R] block in this\n+The compiler generates a warning for the \\f[CB]finally\\f[R] block in this\n@@ -1972,5 +2061,5 @@\n-When the \\f[V]int\\f[R] method is called, it returns a value of 0.\n-A \\f[V]finally\\f[R] block executes when the \\f[V]try\\f[R] block exits.\n-In this example, when control is transferred to the \\f[V]catch\\f[R]\n-block, the \\f[V]int\\f[R] method exits.\n-However, the \\f[V]finally\\f[R] block must execute, so it\\[aq]s executed,\n+When the \\f[CB]int\\f[R] method is called, it returns a value of 0.\n+A \\f[CB]finally\\f[R] block executes when the \\f[CB]try\\f[R] block exits.\n+In this example, when control is transferred to the \\f[CB]catch\\f[R]\n+block, the \\f[CB]int\\f[R] method exits.\n+However, the \\f[CB]finally\\f[R] block must execute, so it\\[aq]s executed,\n@@ -1980,2 +2069,2 @@\n-\\f[V]options\\f[R]\n-Warns about issues that related to the use of command-line options.\n+.B \\f[CB]options\\f[R]\n+Warns about issues that related to the use of command\\-line options.\n@@ -1983,0 +2072,2 @@\n+.RS\n+.RE\n@@ -1984,1 +2075,1 @@\n-\\f[V]overrides\\f[R]\n+.B \\f[CB]overrides\\f[R]\n@@ -1991,2 +2082,2 @@\n-public class ClassWithVarargsMethod {\n-  void varargsMethod(String... s) { }\n+public\\ class\\ ClassWithVarargsMethod\\ {\n+\\ \\ void\\ varargsMethod(String...\\ s)\\ {\\ }\n@@ -1995,3 +2086,3 @@\n-public class ClassWithOverridingMethod extends ClassWithVarargsMethod {\n-   \\[at]Override\n-   void varargsMethod(String[] s) { }\n+public\\ class\\ ClassWithOverridingMethod\\ extends\\ ClassWithVarargsMethod\\ {\n+\\ \\ \\ \\@Override\n+\\ \\ \\ void\\ varargsMethod(String[]\\ s)\\ {\\ }\n@@ -2006,3 +2097,3 @@\n-warning: [override] varargsMethod(String[]) in ClassWithOverridingMethod\n-overrides varargsMethod(String...) in ClassWithVarargsMethod; overriding\n-method is missing \\[aq]...\\[aq]\n+warning:\\ [override]\\ varargsMethod(String[])\\ in\\ ClassWithOverridingMethod\n+overrides\\ varargsMethod(String...)\\ in\\ ClassWithVarargsMethod;\\ overriding\n+method\\ is\\ missing\\ \\[aq]...\\[aq]\n@@ -2012,5 +2103,5 @@\n-When the compiler encounters a \\f[V]varargs\\f[R] method, it translates\n-the \\f[V]varargs\\f[R] formal parameter into an array.\n-In the method \\f[V]ClassWithVarargsMethod.varargsMethod\\f[R], the\n-compiler translates the \\f[V]varargs\\f[R] formal parameter\n-\\f[V]String... s\\f[R] to the formal parameter \\f[V]String[] s\\f[R], an\n+When the compiler encounters a \\f[CB]varargs\\f[R] method, it translates\n+the \\f[CB]varargs\\f[R] formal parameter into an array.\n+In the method \\f[CB]ClassWithVarargsMethod.varargsMethod\\f[R], the\n+compiler translates the \\f[CB]varargs\\f[R] formal parameter\n+\\f[CB]String...\\ s\\f[R] to the formal parameter \\f[CB]String[]\\ s\\f[R], an\n@@ -2018,1 +2109,1 @@\n-\\f[V]ClassWithOverridingMethod.varargsMethod\\f[R].\n+\\f[CB]ClassWithOverridingMethod.varargsMethod\\f[R].\n@@ -2022,1 +2113,1 @@\n-\\f[V]path\\f[R]\n+.B \\f[CB]path\\f[R]\n@@ -2026,2 +2117,2 @@\n-Such warnings cannot be suppressed with the\n-\\f[V]\\[at]SuppressWarnings\\f[R] annotation.\n+Such warnings cannot be suppressed with the \\f[CB]\\@SuppressWarnings\\f[R]\n+annotation.\n@@ -2032,1 +2123,1 @@\n-\\f[V]javac -Xlint:path -classpath \/nonexistentpath Example.java\\f[R]\n+\\f[CB]javac\\ \\-Xlint:path\\ \\-classpath\\ \/nonexistentpath\\ Example.java\\f[R]\n@@ -2035,1 +2126,1 @@\n-\\f[V]javac -Xlint:path -classpath C:\\[rs]nonexistentpath Example.java\\f[R]\n+\\f[CB]javac\\ \\-Xlint:path\\ \\-classpath\\ C:\\\\nonexistentpath\\ Example.java\\f[R]\n@@ -2038,1 +2129,1 @@\n-\\f[V]processing\\f[R]\n+.B \\f[CB]processing\\f[R]\n@@ -2050,4 +2141,4 @@\n-import java.util.*;\n-import javax.annotation.processing.*;\n-import javax.lang.model.*;\n-import javax.lang.model.element.*;\n+import\\ java.util.*;\n+import\\ javax.annotation.processing.*;\n+import\\ javax.lang.model.*;\n+import\\ javax.lang.model.element.*;\n@@ -2055,5 +2146,5 @@\n-\\[at]SupportedAnnotationTypes(\\[dq]NotAnno\\[dq])\n-public class AnnoProc extends AbstractProcessor {\n-  public boolean process(Set<? extends TypeElement> elems, RoundEnvironment renv){\n-     return true;\n-  }\n+\\@SupportedAnnotationTypes(\"NotAnno\")\n+public\\ class\\ AnnoProc\\ extends\\ AbstractProcessor\\ {\n+\\ \\ public\\ boolean\\ process(Set<?\\ extends\\ TypeElement>\\ elems,\\ RoundEnvironment\\ renv){\n+\\ \\ \\ \\ \\ return\\ true;\n+\\ \\ }\n@@ -2061,3 +2152,3 @@\n-  public SourceVersion getSupportedSourceVersion() {\n-     return SourceVersion.latest();\n-   }\n+\\ \\ public\\ SourceVersion\\ getSupportedSourceVersion()\\ {\n+\\ \\ \\ \\ \\ return\\ SourceVersion.latest();\n+\\ \\ \\ }\n@@ -2072,1 +2163,1 @@\n-\\[at]interface Anno { }\n+\\@interface\\ Anno\\ {\\ }\n@@ -2074,2 +2165,2 @@\n-\\[at]Anno\n-class AnnosWithoutProcessors { }\n+\\@Anno\n+class\\ AnnosWithoutProcessors\\ {\\ }\n@@ -2080,2 +2171,2 @@\n-\\f[V]AnnoProc\\f[R], then run this annotation processor against the\n-source file \\f[V]AnnosWithoutProcessors.java\\f[R]:\n+\\f[CB]AnnoProc\\f[R], then run this annotation processor against the source\n+file \\f[CB]AnnosWithoutProcessors.java\\f[R]:\n@@ -2085,2 +2176,2 @@\n-javac AnnoProc.java\n-javac -cp . -Xlint:processing -processor AnnoProc -proc:only AnnosWithoutProcessors.java\n+javac\\ AnnoProc.java\n+javac\\ \\-cp\\ .\\ \\-Xlint:processing\\ \\-processor\\ AnnoProc\\ \\-proc:only\\ AnnosWithoutProcessors.java\n@@ -2091,1 +2182,1 @@\n-\\f[V]AnnosWithoutProcessors.java\\f[R], it generates the following\n+\\f[CB]AnnosWithoutProcessors.java\\f[R], it generates the following\n@@ -2096,1 +2187,1 @@\n-warning: [processing] No processor claimed any of these annotations: Anno\n+warning:\\ [processing]\\ No\\ processor\\ claimed\\ any\\ of\\ these\\ annotations:\\ Anno\n@@ -2101,2 +2192,2 @@\n-the class \\f[V]AnnosWithoutProcessors\\f[R] from \\f[V]Anno\\f[R] to\n-\\f[V]NotAnno\\f[R].\n+the class \\f[CB]AnnosWithoutProcessors\\f[R] from \\f[CB]Anno\\f[R] to\n+\\f[CB]NotAnno\\f[R].\n@@ -2105,1 +2196,1 @@\n-\\f[V]rawtypes\\f[R]\n+.B \\f[CB]rawtypes\\f[R]\n@@ -2107,1 +2198,1 @@\n-The following statement generates a \\f[V]rawtypes\\f[R] warning:\n+The following statement generates a \\f[CB]rawtypes\\f[R] warning:\n@@ -2111,1 +2202,1 @@\n-\\f[V]void countElements(List l) { ... }\\f[R]\n+\\f[CB]void\\ countElements(List\\ l)\\ {\\ ...\\ }\\f[R]\n@@ -2114,1 +2205,1 @@\n-The following example does not generate a \\f[V]rawtypes\\f[R] warning:\n+The following example does not generate a \\f[CB]rawtypes\\f[R] warning:\n@@ -2117,1 +2208,1 @@\n-\\f[V]void countElements(List<?> l) { ... }\\f[R]\n+\\f[CB]void\\ countElements(List<?>\\ l)\\ {\\ ...\\ }\\f[R]\n@@ -2120,3 +2211,3 @@\n-\\f[V]List\\f[R] is a raw type.\n-However, \\f[V]List<?>\\f[R] is an unbounded wildcard parameterized type.\n-Because \\f[V]List\\f[R] is a parameterized interface, always specify its\n+\\f[CB]List\\f[R] is a raw type.\n+However, \\f[CB]List<?>\\f[R] is an unbounded wildcard parameterized type.\n+Because \\f[CB]List\\f[R] is a parameterized interface, always specify its\n@@ -2124,4 +2215,4 @@\n-In this example, the \\f[V]List\\f[R] formal argument is specified with an\n-unbounded wildcard (\\f[V]?\\f[R]) as its formal type parameter, which\n-means that the \\f[V]countElements\\f[R] method can accept any\n-instantiation of the \\f[V]List\\f[R] interface.\n+In this example, the \\f[CB]List\\f[R] formal argument is specified with an\n+unbounded wildcard (\\f[CB]?\\f[R]) as its formal type parameter, which\n+means that the \\f[CB]countElements\\f[R] method can accept any\n+instantiation of the \\f[CB]List\\f[R] interface.\n@@ -2130,2 +2221,2 @@\n-\\f[V]serial\\f[R]\n-Warns about missing \\f[V]serialVersionUID\\f[R] definitions on\n+.B \\f[CB]serial\\f[R]\n+Warns about missing \\f[CB]serialVersionUID\\f[R] definitions on\n@@ -2138,1 +2229,1 @@\n-public class PersistentTime implements Serializable\n+public\\ class\\ PersistentTime\\ implements\\ Serializable\n@@ -2140,1 +2231,1 @@\n-  private Date time;\n+\\ \\ private\\ Date\\ time;\n@@ -2142,3 +2233,3 @@\n-   public PersistentTime() {\n-     time = Calendar.getInstance().getTime();\n-   }\n+\\ \\ \\ public\\ PersistentTime()\\ {\n+\\ \\ \\ \\ \\ time\\ =\\ Calendar.getInstance().getTime();\n+\\ \\ \\ }\n@@ -2146,3 +2237,3 @@\n-   public Date getTime() {\n-     return time;\n-   }\n+\\ \\ \\ public\\ Date\\ getTime()\\ {\n+\\ \\ \\ \\ \\ return\\ time;\n+\\ \\ \\ }\n@@ -2157,1 +2248,1 @@\n-warning: [serial] serializable class PersistentTime has no definition of\n+warning:\\ [serial]\\ serializable\\ class\\ PersistentTime\\ has\\ no\\ definition\\ of\n@@ -2163,2 +2254,2 @@\n-\\f[V]serialVersionUID\\f[R], then the serialization runtime environment\n-calculates a default \\f[V]serialVersionUID\\f[R] value for that class\n+\\f[CB]serialVersionUID\\f[R], then the serialization runtime environment\n+calculates a default \\f[CB]serialVersionUID\\f[R] value for that class\n@@ -2168,2 +2259,2 @@\n-explicitly declare \\f[V]serialVersionUID\\f[R] values because the default\n-process of computing \\f[V]serialVersionUID\\f[R] values is highly\n+explicitly declare \\f[CB]serialVersionUID\\f[R] values because the default\n+process of computing \\f[CB]serialVersionUID\\f[R] values is highly\n@@ -2173,2 +2264,2 @@\n-\\f[V]InvalidClassExceptions\\f[R] during deserialization.\n-To guarantee a consistent \\f[V]serialVersionUID\\f[R] value across\n+\\f[CB]InvalidClassExceptions\\f[R] during deserialization.\n+To guarantee a consistent \\f[CB]serialVersionUID\\f[R] value across\n@@ -2176,1 +2267,1 @@\n-declare an explicit \\f[V]serialVersionUID\\f[R] value.\n+declare an explicit \\f[CB]serialVersionUID\\f[R] value.\n@@ -2179,1 +2270,1 @@\n-\\f[V]static\\f[R]\n+.B \\f[CB]static\\f[R]\n@@ -2185,3 +2276,3 @@\n-class XLintStatic {\n-    static void m1() { }\n-    void m2() { this.m1(); }\n+class\\ XLintStatic\\ {\n+\\ \\ \\ \\ static\\ void\\ m1()\\ {\\ }\n+\\ \\ \\ \\ void\\ m2()\\ {\\ this.m1();\\ }\n@@ -2196,2 +2287,2 @@\n-warning: [static] static method should be qualified by type name,\n-XLintStatic, instead of by an expression\n+warning:\\ [static]\\ static\\ method\\ should\\ be\\ qualified\\ by\\ type\\ name,\n+XLintStatic,\\ instead\\ of\\ by\\ an\\ expression\n@@ -2201,2 +2292,2 @@\n-To resolve this issue, you can call the \\f[V]static\\f[R] method\n-\\f[V]m1\\f[R] as follows:\n+To resolve this issue, you can call the \\f[CB]static\\f[R] method\n+\\f[CB]m1\\f[R] as follows:\n@@ -2205,1 +2296,1 @@\n-\\f[V]XLintStatic.m1();\\f[R]\n+\\f[CB]XLintStatic.m1();\\f[R]\n@@ -2208,2 +2299,2 @@\n-Alternately, you can remove the \\f[V]static\\f[R] keyword from the\n-declaration of the method \\f[V]m1\\f[R].\n+Alternately, you can remove the \\f[CB]static\\f[R] keyword from the\n+declaration of the method \\f[CB]m1\\f[R].\n@@ -2212,3 +2303,3 @@\n-\\f[V]try\\f[R]\n-Warns about issues relating to the use of \\f[V]try\\f[R] blocks,\n-including try-with-resources statements.\n+.B \\f[CB]try\\f[R]\n+Warns about issues relating to the use of \\f[CB]try\\f[R] blocks, including\n+try\\-with\\-resources statements.\n@@ -2216,2 +2307,1 @@\n-the resource \\f[V]ac\\f[R] declared in the \\f[V]try\\f[R] block is not\n-used:\n+the resource \\f[CB]ac\\f[R] declared in the \\f[CB]try\\f[R] block is not used:\n@@ -2222,1 +2312,1 @@\n-try ( AutoCloseable ac = getResource() ) {    \/\/ do nothing}\n+try\\ (\\ AutoCloseable\\ ac\\ =\\ getResource()\\ )\\ {\\ \\ \\ \\ \/\/\\ do\\ nothing}\n@@ -2227,1 +2317,1 @@\n-\\f[V]unchecked\\f[R]\n+.B \\f[CB]unchecked\\f[R]\n@@ -2234,2 +2324,2 @@\n-List l = new ArrayList<Number>();\n-List<String> ls = l;       \/\/ unchecked warning\n+List\\ l\\ =\\ new\\ ArrayList<Number>();\n+List<String>\\ ls\\ =\\ l;\\ \\ \\ \\ \\ \\ \\ \/\/\\ unchecked\\ warning\n@@ -2239,2 +2329,2 @@\n-During type erasure, the types \\f[V]ArrayList<Number>\\f[R] and\n-\\f[V]List<String>\\f[R] become \\f[V]ArrayList\\f[R] and \\f[V]List\\f[R],\n+During type erasure, the types \\f[CB]ArrayList<Number>\\f[R] and\n+\\f[CB]List<String>\\f[R] become \\f[CB]ArrayList\\f[R] and \\f[CB]List\\f[R],\n@@ -2243,4 +2333,4 @@\n-The \\f[V]ls\\f[R] command has the parameterized type\n-\\f[V]List<String>\\f[R].\n-When the \\f[V]List\\f[R] referenced by \\f[V]l\\f[R] is assigned to\n-\\f[V]ls\\f[R], the compiler generates an unchecked warning.\n+The \\f[CB]ls\\f[R] command has the parameterized type\n+\\f[CB]List<String>\\f[R].\n+When the \\f[CB]List\\f[R] referenced by \\f[CB]l\\f[R] is assigned to\n+\\f[CB]ls\\f[R], the compiler generates an unchecked warning.\n@@ -2248,3 +2338,2 @@\n-\\f[V]l\\f[R] refers to a \\f[V]List<String>\\f[R] type.\n-In this case, \\f[V]l\\f[R] does not refer to a \\f[V]List<String>\\f[R]\n-type.\n+\\f[CB]l\\f[R] refers to a \\f[CB]List<String>\\f[R] type.\n+In this case, \\f[CB]l\\f[R] does not refer to a \\f[CB]List<String>\\f[R] type.\n@@ -2253,4 +2342,4 @@\n-A heap pollution situation occurs when the \\f[V]List\\f[R] object\n-\\f[V]l\\f[R], whose static type is \\f[V]List<Number>\\f[R], is assigned to\n-another \\f[V]List\\f[R] object, \\f[V]ls\\f[R], that has a different static\n-type, \\f[V]List<String>\\f[R].\n+A heap pollution situation occurs when the \\f[CB]List\\f[R] object\n+\\f[CB]l\\f[R], whose static type is \\f[CB]List<Number>\\f[R], is assigned to\n+another \\f[CB]List\\f[R] object, \\f[CB]ls\\f[R], that has a different static\n+type, \\f[CB]List<String>\\f[R].\n@@ -2260,2 +2349,2 @@\n-Because of type erasure, \\f[V]List<Number>\\f[R] and\n-\\f[V]List<String>\\f[R] both become \\f[V]List\\f[R].\n+Because of type erasure, \\f[CB]List<Number>\\f[R] and \\f[CB]List<String>\\f[R]\n+both become \\f[CB]List\\f[R].\n@@ -2263,2 +2352,2 @@\n-\\f[V]l\\f[R], which has a raw type of \\f[V]List\\f[R], to the object\n-\\f[V]ls\\f[R].\n+\\f[CB]l\\f[R], which has a raw type of \\f[CB]List\\f[R], to the object\n+\\f[CB]ls\\f[R].\n@@ -2267,4 +2356,3 @@\n-\\f[V]varargs\\f[R]\n-Warns about unsafe use of variable arguments (\\f[V]varargs\\f[R])\n-methods, in particular, those that contain non-reifiable arguments, for\n-example:\n+.B \\f[CB]varargs\\f[R]\n+Warns about unsafe use of variable arguments (\\f[CB]varargs\\f[R]) methods,\n+in particular, those that contain non\\-reifiable arguments, for example:\n@@ -2275,6 +2363,6 @@\n-public class ArrayBuilder {\n-  public static <T> void addToList (List<T> listArg, T... elements) {\n-    for (T x : elements) {\n-      listArg.add(x);\n-    }\n-  }\n+public\\ class\\ ArrayBuilder\\ {\n+\\ \\ public\\ static\\ <T>\\ void\\ addToList\\ (List<T>\\ listArg,\\ T...\\ elements)\\ {\n+\\ \\ \\ \\ for\\ (T\\ x\\ :\\ elements)\\ {\n+\\ \\ \\ \\ \\ \\ listArg.add(x);\n+\\ \\ \\ \\ }\n+\\ \\ }\n@@ -2285,1 +2373,1 @@\n-A non-reifiable type is a type whose type information is not fully\n+A non\\-reifiable type is a type whose type information is not fully\n@@ -2289,1 +2377,1 @@\n-method \\f[V]ArrayBuilder.addToList\\f[R]:\n+method \\f[CB]ArrayBuilder.addToList\\f[R]:\n@@ -2293,1 +2381,1 @@\n-warning: [varargs] Possible heap pollution from parameterized vararg type T\n+warning:\\ [varargs]\\ Possible\\ heap\\ pollution\\ from\\ parameterized\\ vararg\\ type\\ T\n@@ -2298,1 +2386,1 @@\n-\\f[V]varargs\\f[R] formal parameter into an array.\n+\\f[CB]varargs\\f[R] formal parameter into an array.\n@@ -2301,3 +2389,3 @@\n-In the method \\f[V]ArrayBuilder.addToList\\f[R], the compiler translates\n-the \\f[V]varargs\\f[R] formal parameter \\f[V]T...\\f[R] elements to the\n-formal parameter \\f[V]T[]\\f[R] elements, an array.\n+In the method \\f[CB]ArrayBuilder.addToList\\f[R], the compiler translates\n+the \\f[CB]varargs\\f[R] formal parameter \\f[CB]T...\\f[R] elements to the\n+formal parameter \\f[CB]T[]\\f[R] elements, an array.\n@@ -2305,1 +2393,1 @@\n-\\f[V]varargs\\f[R] formal parameter to \\f[V]Object[]\\f[R] elements.\n+\\f[CB]varargs\\f[R] formal parameter to \\f[CB]Object[]\\f[R] elements.\n","filename":"src\/jdk.compiler\/share\/man\/javac.1","additions":895,"deletions":807,"binary":false,"changes":1702,"status":"modified"},{"patch":"@@ -22,1 +22,1 @@\n-.\\\" Automatically generated by Pandoc 2.19.2\n+.\\\" Automatically generated by Pandoc 2.3.1\n@@ -24,15 +24,1 @@\n-.\\\" Define V font for inline verbatim, using C font in formats\n-.\\\" that render this, and otherwise B font.\n-.ie \"\\f[CB]x\\f[R]\"x\" \\{\\\n-. ftr V B\n-. ftr VI BI\n-. ftr VB B\n-. ftr VBI BI\n-.\\}\n-.el \\{\\\n-. ftr V CR\n-. ftr VI CI\n-. ftr VB CB\n-. ftr VBI CBI\n-.\\}\n-.TH \"SERIALVER\" \"1\" \"2023\" \"JDK 20-ea\" \"JDK Commands\"\n+.TH \"SERIALVER\" \"1\" \"2023\" \"JDK 20\\-ea\" \"JDK Commands\"\n@@ -42,1 +28,1 @@\n-serialver - return the \\f[V]serialVersionUID\\f[R] for one or more\n+serialver \\- return the \\f[CB]serialVersionUID\\f[R] for one or more\n@@ -46,1 +32,1 @@\n-\\f[V]serialver\\f[R] [\\f[I]options\\f[R]] [\\f[I]classnames\\f[R]]\n+\\f[CB]serialver\\f[R] [\\f[I]options\\f[R]] [\\f[I]classnames\\f[R]]\n@@ -48,2 +34,2 @@\n-\\f[I]options\\f[R]\n-This represents the command-line options for the \\f[V]serialver\\f[R]\n+.B \\f[I]options\\f[R]\n+This represents the command\\-line options for the \\f[CB]serialver\\f[R]\n@@ -52,0 +38,2 @@\n+.RS\n+.RE\n@@ -53,2 +41,4 @@\n-\\f[I]classnames\\f[R]\n-The classes for which \\f[V]serialVersionUID\\f[R] is to be returned.\n+.B \\f[I]classnames\\f[R]\n+The classes for which \\f[CB]serialVersionUID\\f[R] is to be returned.\n+.RS\n+.RE\n@@ -57,2 +47,2 @@\n-The \\f[V]serialver\\f[R] command returns the \\f[V]serialVersionUID\\f[R]\n-for one or more classes in a form suitable for copying into an evolving\n+The \\f[CB]serialver\\f[R] command returns the \\f[CB]serialVersionUID\\f[R] for\n+one or more classes in a form suitable for copying into an evolving\n@@ -60,1 +50,1 @@\n-When called with no arguments, the \\f[V]serialver\\f[R] command prints a\n+When called with no arguments, the \\f[CB]serialver\\f[R] command prints a\n@@ -64,1 +54,1 @@\n-\\f[V]-classpath\\f[R] \\f[I]path-files\\f[R]\n+.B \\f[CB]\\-classpath\\f[R] \\f[I]path\\-files\\f[R]\n@@ -67,0 +57,2 @@\n+.RS\n+.RE\n@@ -68,1 +60,1 @@\n-\\f[V]-J\\f[R]\\f[I]option\\f[R]\n+.B \\f[CB]\\-J\\f[R]\\f[I]option\\f[R]\n@@ -72,1 +64,3 @@\n-For example, \\f[V]-J-Xms48m\\f[R] sets the startup memory to 48 MB.\n+For example, \\f[CB]\\-J\\-Xms48m\\f[R] sets the startup memory to 48 MB.\n+.RS\n+.RE\n@@ -75,1 +69,1 @@\n-The \\f[V]serialver\\f[R] command loads and initializes the specified\n+The \\f[CB]serialver\\f[R] command loads and initializes the specified\n@@ -78,1 +72,1 @@\n-If the \\f[V]serialver\\f[R] command is to be run with untrusted classes,\n+If the \\f[CB]serialver\\f[R] command is to be run with untrusted classes,\n@@ -82,1 +76,1 @@\n-\\f[V]-J-Djava.security.manager\\f[R]\n+\\f[CB]\\-J\\-Djava.security.manager\\f[R]\n@@ -89,1 +83,1 @@\n-\\f[V]-J-Djava.security.policy=\\f[R]\\f[I]policy_file\\f[R]\n+\\f[CB]\\-J\\-Djava.security.policy=\\f[R]\\f[I]policy_file\\f[R]\n","filename":"src\/jdk.compiler\/share\/man\/serialver.1","additions":26,"deletions":32,"binary":false,"changes":58,"status":"modified"},{"patch":"@@ -209,0 +209,3 @@\n+        ImmutableIntegerModuloP xElem = ops.getField().getElement(x);\n+        ImmutableIntegerModuloP yElem = ops.getField().getElement(y);\n+        AffinePoint affP = new AffinePoint(xElem, yElem);\n@@ -211,1 +214,1 @@\n-        Point product = ops.multiply(key.getW(), order);\n+        Point product = ops.multiply(affP, order);\n@@ -275,2 +278,6 @@\n-        Point product =\n-                ops.multiply(pubKey.getW(), scalar.asByteArray(keySize));\n+        ImmutableIntegerModuloP x =\n+            field.getElement(pubKey.getW().getAffineX());\n+        ImmutableIntegerModuloP y =\n+            field.getElement(pubKey.getW().getAffineY());\n+        Point product = ops.multiply(new AffinePoint(x, y),\n+            scalar.asByteArray(keySize));\n","filename":"src\/jdk.crypto.ec\/share\/classes\/sun\/security\/ec\/ECDHKeyAgreement.java","additions":10,"deletions":3,"binary":false,"changes":13,"status":"modified"},{"patch":"@@ -246,0 +246,3 @@\n+        AffinePoint pub = new AffinePoint(field.getElement(pp.getAffineX()),\n+                field.getElement(pp.getAffineY()));\n+\n@@ -253,1 +256,1 @@\n-        MutablePoint p2 = ecOps.multiply(pp, temp2);\n+        MutablePoint p2 = ecOps.multiply(pub, temp2);\n","filename":"src\/jdk.crypto.ec\/share\/classes\/sun\/security\/ec\/ECDSAOperations.java","additions":4,"deletions":1,"binary":false,"changes":5,"status":"modified"},{"patch":"@@ -194,1 +194,5 @@\n-        Point pub = ops.multiply(ecParams.getGenerator(), privArr);\n+        ECPoint genPoint = ecParams.getGenerator();\n+        ImmutableIntegerModuloP x = field.getElement(genPoint.getAffineX());\n+        ImmutableIntegerModuloP y = field.getElement(genPoint.getAffineY());\n+        AffinePoint affGen = new AffinePoint(x, y);\n+        Point pub = ops.multiply(affGen, privArr);\n","filename":"src\/jdk.crypto.ec\/share\/classes\/sun\/security\/ec\/ECKeyPairGenerator.java","additions":5,"deletions":1,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -29,2 +29,0 @@\n-import sun.security.util.CurveDB;\n-import sun.security.util.KnownOIDs;\n@@ -51,4 +49,0 @@\n-    private static final ECOperations secp256r1Ops =\n-        new ECOperations(IntegerPolynomialP256.ONE.getElement(\n-                CurveDB.lookup(KnownOIDs.secp256r1.value()).getCurve().getB()),\n-                P256OrderField.ONE);\n@@ -81,1 +75,1 @@\n-        if (!(curve.getField() instanceof ECFieldFp primeField)) {\n+        if (!(curve.getField() instanceof ECFieldFp)) {\n@@ -84,0 +78,1 @@\n+        ECFieldFp primeField = (ECFieldFp) curve.getField();\n@@ -201,0 +196,29 @@\n+    \/*\n+     * 4-bit branchless array lookup for projective points.\n+     *\/\n+    private void lookup4(ProjectivePoint.Immutable[] arr, int index,\n+        ProjectivePoint.Mutable result, IntegerModuloP zero) {\n+\n+        for (int i = 0; i < 16; i++) {\n+            int xor = index ^ i;\n+            int bit3 = (xor & 0x8) >>> 3;\n+            int bit2 = (xor & 0x4) >>> 2;\n+            int bit1 = (xor & 0x2) >>> 1;\n+            int bit0 = (xor & 0x1);\n+            int inverse = bit0 | bit1 | bit2 | bit3;\n+            int set = 1 - inverse;\n+\n+            ProjectivePoint.Immutable pi = arr[i];\n+            result.conditionalSet(pi, set);\n+        }\n+    }\n+\n+    private void double4(ProjectivePoint.Mutable p, MutableIntegerModuloP t0,\n+        MutableIntegerModuloP t1, MutableIntegerModuloP t2,\n+        MutableIntegerModuloP t3, MutableIntegerModuloP t4) {\n+\n+        for (int i = 0; i < 4; i++) {\n+            setDouble(p, t0, t1, t2, t3, t4);\n+        }\n+    }\n+\n@@ -210,2 +234,0 @@\n-        return PointMultiplier.of(this, affineP).pointMultiply(s);\n-    }\n@@ -213,2 +235,51 @@\n-    public MutablePoint multiply(ECPoint ecPoint, byte[] s) {\n-        return PointMultiplier.of(this, ecPoint).pointMultiply(s);\n+        \/\/ 4-bit windowed multiply with branchless lookup.\n+        \/\/ The mixed addition is faster, so it is used to construct the array\n+        \/\/ at the beginning of the operation.\n+\n+        IntegerFieldModuloP field = affineP.getX().getField();\n+        ImmutableIntegerModuloP zero = field.get0();\n+        \/\/ temporaries\n+        MutableIntegerModuloP t0 = zero.mutable();\n+        MutableIntegerModuloP t1 = zero.mutable();\n+        MutableIntegerModuloP t2 = zero.mutable();\n+        MutableIntegerModuloP t3 = zero.mutable();\n+        MutableIntegerModuloP t4 = zero.mutable();\n+\n+        ProjectivePoint.Mutable result = new ProjectivePoint.Mutable(field);\n+        result.getY().setValue(field.get1().mutable());\n+\n+        ProjectivePoint.Immutable[] pointMultiples =\n+            new ProjectivePoint.Immutable[16];\n+        \/\/ 0P is neutral---same as initial result value\n+        pointMultiples[0] = result.fixed();\n+\n+        ProjectivePoint.Mutable ps = new ProjectivePoint.Mutable(field);\n+        ps.setValue(affineP);\n+        \/\/ 1P = P\n+        pointMultiples[1] = ps.fixed();\n+\n+        \/\/ the rest are calculated using mixed point addition\n+        for (int i = 2; i < 16; i++) {\n+            setSum(ps, affineP, t0, t1, t2, t3, t4);\n+            pointMultiples[i] = ps.fixed();\n+        }\n+\n+        ProjectivePoint.Mutable lookupResult = ps.mutable();\n+\n+        for (int i = s.length - 1; i >= 0; i--) {\n+\n+            double4(result, t0, t1, t2, t3, t4);\n+\n+            int high = (0xFF & s[i]) >>> 4;\n+            lookup4(pointMultiples, high, lookupResult, zero);\n+            setSum(result, lookupResult, t0, t1, t2, t3, t4);\n+\n+            double4(result, t0, t1, t2, t3, t4);\n+\n+            int low = 0xF & s[i];\n+            lookup4(pointMultiples, low, lookupResult, zero);\n+            setSum(result, lookupResult, t0, t1, t2, t3, t4);\n+        }\n+\n+        return result;\n+\n@@ -336,0 +407,1 @@\n+\n@@ -401,0 +473,1 @@\n+\n@@ -416,286 +489,0 @@\n-\n-    sealed interface PointMultiplier {\n-        Map<ECPoint, PointMultiplier> multipliers = Map.of(\n-                Secp256R1GeneratorMultiplier.generator,\n-                Secp256R1GeneratorMultiplier.multiplier);\n-\n-        \/\/ Multiply the point by a scalar and return the result as a mutable\n-        \/\/ point.  The multiplier point is specified by the implementation of\n-        \/\/ this interface, which could be a general EC point or EC generator\n-        \/\/ point.\n-        \/\/\n-        \/\/ Multiply the ECPoint (that is specified in the implementation) by\n-        \/\/ a scalar and return the result as a ProjectivePoint.Mutable point.\n-        \/\/ The point to be multiplied can be a general EC point or the\n-        \/\/ generator of a named EC group.  The scalar multiplier is an integer\n-        \/\/ in little endian byte array representation.\n-        ProjectivePoint.Mutable pointMultiply(byte[] scalar);\n-\n-        static PointMultiplier of(ECOperations ecOps, AffinePoint affPoint) {\n-            PointMultiplier multiplier = multipliers.get(affPoint.toECPoint());\n-            if (multiplier == null) {\n-                multiplier = new Default(ecOps, affPoint);\n-            }\n-\n-            return multiplier;\n-        }\n-\n-        static PointMultiplier of(ECOperations ecOps, ECPoint ecPoint) {\n-            PointMultiplier multiplier = multipliers.get(ecPoint);\n-            if (multiplier == null) {\n-                AffinePoint affPoint =\n-                        AffinePoint.fromECPoint(ecPoint, ecOps.getField());\n-                multiplier = new Default(ecOps, affPoint);\n-            }\n-\n-            return multiplier;\n-        }\n-\n-        private static void lookup(\n-                ProjectivePoint.Immutable[] ips, int index,\n-                ProjectivePoint.Mutable result) {\n-            for (int i = 0; i < 16; i++) {\n-                int xor = index ^ i;\n-                int bit3 = (xor & 0x8) >>> 3;\n-                int bit2 = (xor & 0x4) >>> 2;\n-                int bit1 = (xor & 0x2) >>> 1;\n-                int bit0 = (xor & 0x1);\n-                int inverse = bit0 | bit1 | bit2 | bit3;\n-                int set = 1 - inverse;\n-\n-                ProjectivePoint.Immutable pi = ips[i];\n-                result.conditionalSet(pi, set);\n-            }\n-        }\n-\n-        final class Default implements PointMultiplier {\n-            private final AffinePoint affineP;\n-            private final ECOperations ecOps;\n-\n-            private Default(ECOperations ecOps, AffinePoint affineP) {\n-                this.ecOps = ecOps;\n-                this.affineP = affineP;\n-            }\n-\n-            @Override\n-            public ProjectivePoint.Mutable pointMultiply(byte[] s) {\n-                \/\/ 4-bit windowed multiply with branchless lookup.\n-                \/\/ The mixed addition is faster, so it is used to construct\n-                \/\/ the array at the beginning of the operation.\n-\n-                IntegerFieldModuloP field = affineP.getX().getField();\n-                ImmutableIntegerModuloP zero = field.get0();\n-                \/\/ temporaries\n-                MutableIntegerModuloP t0 = zero.mutable();\n-                MutableIntegerModuloP t1 = zero.mutable();\n-                MutableIntegerModuloP t2 = zero.mutable();\n-                MutableIntegerModuloP t3 = zero.mutable();\n-                MutableIntegerModuloP t4 = zero.mutable();\n-\n-                ProjectivePoint.Mutable result =\n-                        new ProjectivePoint.Mutable(field);\n-                result.getY().setValue(field.get1().mutable());\n-\n-                ProjectivePoint.Immutable[] pointMultiples =\n-                        new ProjectivePoint.Immutable[16];\n-                \/\/ 0P is neutral---same as initial result value\n-                pointMultiples[0] = result.fixed();\n-\n-                ProjectivePoint.Mutable ps = new ProjectivePoint.Mutable(field);\n-                ps.setValue(affineP);\n-                \/\/ 1P = P\n-                pointMultiples[1] = ps.fixed();\n-\n-                \/\/ the rest are calculated using mixed point addition\n-                for (int i = 2; i < 16; i++) {\n-                    ecOps.setSum(ps, affineP, t0, t1, t2, t3, t4);\n-                    pointMultiples[i] = ps.fixed();\n-                }\n-\n-                ProjectivePoint.Mutable lookupResult = ps.mutable();\n-\n-                for (int i = s.length - 1; i >= 0; i--) {\n-                    double4(result, t0, t1, t2, t3, t4);\n-\n-                    int high = (0xFF & s[i]) >>> 4;\n-                    lookup(pointMultiples, high, lookupResult);\n-                    ecOps.setSum(result, lookupResult, t0, t1, t2, t3, t4);\n-\n-                    double4(result, t0, t1, t2, t3, t4);\n-\n-                    int low = 0xF & s[i];\n-                    lookup(pointMultiples, low, lookupResult);\n-                    ecOps.setSum(result, lookupResult, t0, t1, t2, t3, t4);\n-                }\n-\n-                return result;\n-            }\n-\n-            private void double4(ProjectivePoint.Mutable p,\n-                    MutableIntegerModuloP t0, MutableIntegerModuloP t1,\n-                    MutableIntegerModuloP t2, MutableIntegerModuloP t3,\n-                    MutableIntegerModuloP t4) {\n-                for (int i = 0; i < 4; i++) {\n-                    ecOps.setDouble(p, t0, t1, t2, t3, t4);\n-                }\n-            }\n-        }\n-\n-        final class Secp256R1GeneratorMultiplier implements PointMultiplier {\n-            private static final ECPoint generator =\n-                    CurveDB.lookup(\"secp256r1\").getGenerator();\n-            private static final PointMultiplier multiplier =\n-                    new Secp256R1GeneratorMultiplier();\n-\n-            private static final ImmutableIntegerModuloP zero =\n-                    IntegerPolynomialP256.ONE.get0();\n-            private static final ImmutableIntegerModuloP one =\n-                    IntegerPolynomialP256.ONE.get1();\n-\n-            @Override\n-            public ProjectivePoint.Mutable pointMultiply(byte[] s) {\n-                MutableIntegerModuloP t0 = zero.mutable();\n-                MutableIntegerModuloP t1 = zero.mutable();\n-                MutableIntegerModuloP t2 = zero.mutable();\n-                MutableIntegerModuloP t3 = zero.mutable();\n-                MutableIntegerModuloP t4 = zero.mutable();\n-\n-                ProjectivePoint.Mutable d = new ProjectivePoint.Mutable(\n-                        zero.mutable(),\n-                        one.mutable(),\n-                        zero.mutable());\n-                ProjectivePoint.Mutable r = d.mutable();\n-                for (int i = 15; i >= 0; i--) {\n-                    secp256r1Ops.setDouble(d, t0, t1, t2, t3, t4);\n-                    for (int j = 3; j >= 0; j--) {\n-                        int pos = i + j * 16;\n-                        int index = (bit(s, pos + 192) << 3) |\n-                                    (bit(s, pos + 128) << 2) |\n-                                    (bit(s, pos +  64) << 1) |\n-                                     bit(s, pos);\n-\n-                        lookup(P256.points[j], index, r);\n-                        secp256r1Ops.setSum(d, r, t0, t1, t2, t3, t4);\n-                    }\n-                }\n-\n-                return d;\n-            }\n-\n-            private static int bit(byte[] k, int i) {\n-                return (k[i >> 3] >> (i & 0x07)) & 0x01;\n-            }\n-\n-            \/\/ Lazy loading of the tables.\n-            private static final class P256 {\n-                \/\/ Pre-computed table to speed up the point multiplication.\n-                \/\/\n-                \/\/ This is a 4x16 array of ProjectivePoint.Immutable elements.\n-                \/\/ The first row contains the following multiples of the\n-                \/\/ generator.\n-                \/\/\n-                \/\/ index   |    point\n-                \/\/ --------+----------------\n-                \/\/ 0x0000  | 0G\n-                \/\/ 0x0001  | 1G\n-                \/\/ 0x0002  | (2^64)G\n-                \/\/ 0x0003  | (2^64 + 1)G\n-                \/\/ 0x0004  | 2^128G\n-                \/\/ 0x0005  | (2^128 + 1)G\n-                \/\/ 0x0006  | (2^128 + 2^64)G\n-                \/\/ 0x0007  | (2^128 + 2^64 + 1)G\n-                \/\/ 0x0008  | 2^192G\n-                \/\/ 0x0009  | (2^192 + 1)G\n-                \/\/ 0x000A  | (2^192 + 2^64)G\n-                \/\/ 0x000B  | (2^192 + 2^64 + 1)G\n-                \/\/ 0x000C  | (2^192 + 2^128)G\n-                \/\/ 0x000D  | (2^192 + 2^128 + 1)G\n-                \/\/ 0x000E  | (2^192 + 2^128 + 2^64)G\n-                \/\/ 0x000F  | (2^192 + 2^128 + 2^64 + 1)G\n-                \/\/\n-                \/\/ For the other 3 rows, points[i][j] = 2^16 * (points[i-1][j].\n-                private static final ProjectivePoint.Immutable[][] points;\n-\n-                \/\/ Generate the pre-computed tables.  This block may be\n-                \/\/ replaced with hard-coded tables in order to speed up\n-                \/\/ the class loading.\n-                static {\n-                    points = new ProjectivePoint.Immutable[4][16];\n-                    BigInteger[] factors = new BigInteger[] {\n-                            BigInteger.ONE,\n-                            BigInteger.TWO.pow(64),\n-                            BigInteger.TWO.pow(128),\n-                            BigInteger.TWO.pow(192)\n-                    };\n-\n-                    BigInteger[] base = new BigInteger[16];\n-                    base[0] = BigInteger.ZERO;\n-                    base[1] = BigInteger.ONE;\n-                    base[2] = factors[1];\n-                    for (int i = 3; i < 16; i++) {\n-                        base[i] = BigInteger.ZERO;\n-                        for (int k = 0; k < 4; k++) {\n-                            if (((i >>> k) & 0x01) != 0) {\n-                                base[i] = base[i].add(factors[k]);\n-                            }\n-                        }\n-                    }\n-\n-                    for (int d = 0; d < 4; d++) {\n-                        for (int w = 0; w < 16; w++) {\n-                            BigInteger bi = base[w];\n-                            if (d != 0) {\n-                                bi = bi.multiply(BigInteger.TWO.pow(d * 16));\n-                            }\n-                            if (w == 0) {\n-                                points[d][0] = new ProjectivePoint.Immutable(\n-                                    zero.fixed(), one.fixed(), zero.fixed());\n-                            } else {\n-                                PointMultiplier multiplier = new Default(\n-                                    secp256r1Ops, AffinePoint.fromECPoint(\n-                                        generator, zero.getField()));\n-                                byte[] s = bi.toByteArray();\n-                                ArrayUtil.reverse(s);\n-                                ProjectivePoint.Mutable m =\n-                                        multiplier.pointMultiply(s);\n-                                points[d][w] = m.setValue(m.asAffine()).fixed();\n-                            }\n-                        }\n-                    }\n-\n-                    \/\/ Check that the tables are correctly generated.\n-                    if (ECOperations.class.desiredAssertionStatus()) {\n-                        verifyTables(base);\n-                    }\n-                }\n-\n-                private static void verifyTables(BigInteger[] base) {\n-                    for (int d = 0; d < 4; d++) {\n-                        for (int w = 0; w < 16; w++) {\n-                            BigInteger bi = base[w];\n-                            if (d != 0) {\n-                                bi = bi.multiply(BigInteger.TWO.pow(d * 16));\n-                            }\n-                            if (w != 0) {\n-                                byte[] s = new byte[32];\n-                                byte[] b = bi.toByteArray();\n-                                ArrayUtil.reverse(b);\n-                                System.arraycopy(b, 0, s, 0, b.length);\n-\n-                                ProjectivePoint.Mutable m =\n-                                        multiplier.pointMultiply(s);\n-                                ProjectivePoint.Immutable v =\n-                                        m.setValue(m.asAffine()).fixed();\n-                                if (!v.getX().asBigInteger().equals(\n-                                        points[d][w].getX().asBigInteger()) ||\n-                                    !v.getY().asBigInteger().equals(\n-                                        points[d][w].getY().asBigInteger())) {\n-                                    throw new RuntimeException();\n-                                }\n-                            }\n-                        }\n-                    }\n-                }\n-            }\n-        }\n-    }\n@@ -703,0 +490,1 @@\n+\n","filename":"src\/jdk.crypto.ec\/share\/classes\/sun\/security\/ec\/ECOperations.java","additions":85,"deletions":297,"binary":false,"changes":382,"status":"modified"},{"patch":"@@ -28,1 +28,0 @@\n-import sun.security.util.math.IntegerFieldModuloP;\n@@ -30,1 +29,0 @@\n-import java.security.spec.ECPoint;\n@@ -49,11 +47,0 @@\n-    public static AffinePoint fromECPoint(\n-            ECPoint ecPoint, IntegerFieldModuloP field) {\n-        return new AffinePoint(\n-                field.getElement(ecPoint.getAffineX()),\n-                field.getElement(ecPoint.getAffineY()));\n-    }\n-\n-    public ECPoint toECPoint() {\n-        return new ECPoint(x.asBigInteger(), y.asBigInteger());\n-    }\n-\n","filename":"src\/jdk.crypto.ec\/share\/classes\/sun\/security\/ec\/point\/AffinePoint.java","additions":0,"deletions":13,"binary":false,"changes":13,"status":"modified"},{"patch":"@@ -22,1 +22,1 @@\n-.\\\" Automatically generated by Pandoc 2.19.2\n+.\\\" Automatically generated by Pandoc 2.3.1\n@@ -24,15 +24,1 @@\n-.\\\" Define V font for inline verbatim, using C font in formats\n-.\\\" that render this, and otherwise B font.\n-.ie \"\\f[CB]x\\f[R]\"x\" \\{\\\n-. ftr V B\n-. ftr VI BI\n-. ftr VB B\n-. ftr VBI BI\n-.\\}\n-.el \\{\\\n-. ftr V CR\n-. ftr VI CI\n-. ftr VB CB\n-. ftr VBI CBI\n-.\\}\n-.TH \"JHSDB\" \"1\" \"2023\" \"JDK 20-ea\" \"JDK Commands\"\n+.TH \"JHSDB\" \"1\" \"2023\" \"JDK 20\\-ea\" \"JDK Commands\"\n@@ -42,1 +28,1 @@\n-jhsdb - attach to a Java process or launch a postmortem debugger to\n+jhsdb \\- attach to a Java process or launch a postmortem debugger to\n@@ -47,2 +33,2 @@\n-\\f[V]jhsdb\\f[R] \\f[V]clhsdb\\f[R] [\\f[V]--pid\\f[R] \\f[I]pid\\f[R] |\n-\\f[V]--exe\\f[R] \\f[I]executable\\f[R] \\f[V]--core\\f[R]\n+\\f[CB]jhsdb\\f[R] \\f[CB]clhsdb\\f[R] [\\f[CB]\\-\\-pid\\f[R] \\f[I]pid\\f[R] |\n+\\f[CB]\\-\\-exe\\f[R] \\f[I]executable\\f[R] \\f[CB]\\-\\-core\\f[R]\n@@ -51,2 +37,2 @@\n-\\f[V]jhsdb\\f[R] \\f[V]hsdb\\f[R] [\\f[V]--pid\\f[R] \\f[I]pid\\f[R] |\n-\\f[V]--exe\\f[R] \\f[I]executable\\f[R] \\f[V]--core\\f[R]\n+\\f[CB]jhsdb\\f[R] \\f[CB]hsdb\\f[R] [\\f[CB]\\-\\-pid\\f[R] \\f[I]pid\\f[R] |\n+\\f[CB]\\-\\-exe\\f[R] \\f[I]executable\\f[R] \\f[CB]\\-\\-core\\f[R]\n@@ -55,2 +41,2 @@\n-\\f[V]jhsdb\\f[R] \\f[V]debugd\\f[R] (\\f[V]--pid\\f[R] \\f[I]pid\\f[R] |\n-\\f[V]--exe\\f[R] \\f[I]executable\\f[R] \\f[V]--core\\f[R]\n+\\f[CB]jhsdb\\f[R] \\f[CB]debugd\\f[R] (\\f[CB]\\-\\-pid\\f[R] \\f[I]pid\\f[R] |\n+\\f[CB]\\-\\-exe\\f[R] \\f[I]executable\\f[R] \\f[CB]\\-\\-core\\f[R]\n@@ -59,3 +45,3 @@\n-\\f[V]jhsdb\\f[R] \\f[V]jstack\\f[R] (\\f[V]--pid\\f[R] \\f[I]pid\\f[R] |\n-\\f[V]--exe\\f[R] \\f[I]executable\\f[R] \\f[V]--core\\f[R] \\f[I]coredump\\f[R]\n-| \\f[V]--connect\\f[R] \\f[I][server-id\\[at]]debugd-host\\f[R])\n+\\f[CB]jhsdb\\f[R] \\f[CB]jstack\\f[R] (\\f[CB]\\-\\-pid\\f[R] \\f[I]pid\\f[R] |\n+\\f[CB]\\-\\-exe\\f[R] \\f[I]executable\\f[R] \\f[CB]\\-\\-core\\f[R] \\f[I]coredump\\f[R]\n+| \\f[CB]\\-\\-connect\\f[R] \\f[I][server\\-id\\@]debugd\\-host\\f[R])\n@@ -64,3 +50,3 @@\n-\\f[V]jhsdb\\f[R] \\f[V]jmap\\f[R] (\\f[V]--pid\\f[R] \\f[I]pid\\f[R] |\n-\\f[V]--exe\\f[R] \\f[I]executable\\f[R] \\f[V]--core\\f[R] \\f[I]coredump\\f[R]\n-| \\f[V]--connect\\f[R] \\f[I][server-id\\[at]]debugd-host\\f[R])\n+\\f[CB]jhsdb\\f[R] \\f[CB]jmap\\f[R] (\\f[CB]\\-\\-pid\\f[R] \\f[I]pid\\f[R] |\n+\\f[CB]\\-\\-exe\\f[R] \\f[I]executable\\f[R] \\f[CB]\\-\\-core\\f[R] \\f[I]coredump\\f[R]\n+| \\f[CB]\\-\\-connect\\f[R] \\f[I][server\\-id\\@]debugd\\-host\\f[R])\n@@ -69,3 +55,3 @@\n-\\f[V]jhsdb\\f[R] \\f[V]jinfo\\f[R] (\\f[V]--pid\\f[R] \\f[I]pid\\f[R] |\n-\\f[V]--exe\\f[R] \\f[I]executable\\f[R] \\f[V]--core\\f[R] \\f[I]coredump\\f[R]\n-| \\f[V]--connect\\f[R] \\f[I][server-id\\[at]]debugd-host\\f[R])\n+\\f[CB]jhsdb\\f[R] \\f[CB]jinfo\\f[R] (\\f[CB]\\-\\-pid\\f[R] \\f[I]pid\\f[R] |\n+\\f[CB]\\-\\-exe\\f[R] \\f[I]executable\\f[R] \\f[CB]\\-\\-core\\f[R] \\f[I]coredump\\f[R]\n+| \\f[CB]\\-\\-connect\\f[R] \\f[I][server\\-id\\@]debugd\\-host\\f[R])\n@@ -74,3 +60,3 @@\n-\\f[V]jhsdb\\f[R] \\f[V]jsnap\\f[R] (\\f[V]--pid\\f[R] \\f[I]pid\\f[R] |\n-\\f[V]--exe\\f[R] \\f[I]executable\\f[R] \\f[V]--core\\f[R] \\f[I]coredump\\f[R]\n-| \\f[V]--connect\\f[R] \\f[I][server-id\\[at]]debugd-host\\f[R])\n+\\f[CB]jhsdb\\f[R] \\f[CB]jsnap\\f[R] (\\f[CB]\\-\\-pid\\f[R] \\f[I]pid\\f[R] |\n+\\f[CB]\\-\\-exe\\f[R] \\f[I]executable\\f[R] \\f[CB]\\-\\-core\\f[R] \\f[I]coredump\\f[R]\n+| \\f[CB]\\-\\-connect\\f[R] \\f[I][server\\-id\\@]debugd\\-host\\f[R])\n@@ -79,2 +65,2 @@\n-\\f[I]pid\\f[R]\n-The process ID to which the \\f[V]jhsdb\\f[R] tool should attach.\n+.B \\f[I]pid\\f[R]\n+The process ID to which the \\f[CB]jhsdb\\f[R] tool should attach.\n@@ -83,1 +69,1 @@\n-\\f[V]ps\\f[R] command or, if the JVM processes are not running in a\n+\\f[CB]ps\\f[R] command or, if the JVM processes are not running in a\n@@ -85,0 +71,2 @@\n+.RS\n+.RE\n@@ -86,1 +74,1 @@\n-\\f[I]executable\\f[R]\n+.B \\f[I]executable\\f[R]\n@@ -88,0 +76,2 @@\n+.RS\n+.RE\n@@ -89,2 +79,4 @@\n-\\f[I]coredump\\f[R]\n-The core file to which the \\f[V]jhsdb\\f[R] tool should attach.\n+.B \\f[I]coredump\\f[R]\n+The core file to which the \\f[CB]jhsdb\\f[R] tool should attach.\n+.RS\n+.RE\n@@ -92,1 +84,1 @@\n-\\f[I][server-id\\[at]]debugd-host\\f[R]\n+.B \\f[I][server\\-id\\@]debugd\\-host\\f[R]\n@@ -95,0 +87,2 @@\n+.RS\n+.RE\n@@ -96,2 +90,2 @@\n-\\f[I]options\\f[R]\n-The command-line options for a \\f[V]jhsdb\\f[R] mode.\n+.B \\f[I]options\\f[R]\n+The command\\-line options for a \\f[CB]jhsdb\\f[R] mode.\n@@ -99,2 +93,4 @@\n-Mode\\f[R], \\f[B]Options for the jmap Mode\\f[R], \\f[B]Options for the\n-jinfo Mode\\f[R], and \\f[B]Options for the jsnap Mode\\f[R].\n+Mode\\f[R], \\f[B]Options for the jmap Mode\\f[R], \\f[B]Options for the jinfo\n+Mode\\f[R], and \\f[B]Options for the jsnap Mode\\f[R].\n+.RS\n+.RE\n@@ -105,3 +101,3 @@\n-\\f[I]core\\f[R] files or the \\f[I][server-id\\[at]]debugd-host\\f[R] must\n-be provided for \\f[V]debugd\\f[R], \\f[V]jstack\\f[R], \\f[V]jmap\\f[R],\n-\\f[V]jinfo\\f[R] and \\f[V]jsnap\\f[R] modes.\n+\\f[I]core\\f[R] files or the \\f[I][server\\-id\\@]debugd\\-host\\f[R] must be\n+provided for \\f[CB]debugd\\f[R], \\f[CB]jstack\\f[R], \\f[CB]jmap\\f[R],\n+\\f[CB]jinfo\\f[R] and \\f[CB]jsnap\\f[R] modes.\n@@ -110,2 +106,2 @@\n-You can use the \\f[V]jhsdb\\f[R] tool to attach to a Java process or to\n-launch a postmortem debugger to analyze the content of a core-dump from\n+You can use the \\f[CB]jhsdb\\f[R] tool to attach to a Java process or to\n+launch a postmortem debugger to analyze the content of a core\\-dump from\n@@ -117,1 +113,1 @@\n-Attaching the \\f[V]jhsdb\\f[R] tool to a live process will cause the\n+Attaching the \\f[CB]jhsdb\\f[R] tool to a live process will cause the\n@@ -121,1 +117,1 @@\n-The \\f[V]jhsdb\\f[R] tool can be launched in any one of the following\n+The \\f[CB]jhsdb\\f[R] tool can be launched in any one of the following\n@@ -124,2 +120,4 @@\n-\\f[V]jhsdb clhsdb\\f[R]\n-Starts the interactive command-line debugger.\n+.B \\f[CB]jhsdb\\ clhsdb\\f[R]\n+Starts the interactive command\\-line debugger.\n+.RS\n+.RE\n@@ -127,1 +125,1 @@\n-\\f[V]jhsdb hsdb\\f[R]\n+.B \\f[CB]jhsdb\\ hsdb\\f[R]\n@@ -129,0 +127,2 @@\n+.RS\n+.RE\n@@ -130,1 +130,1 @@\n-\\f[V]jhsdb debugd\\f[R]\n+.B \\f[CB]jhsdb\\ debugd\\f[R]\n@@ -132,0 +132,2 @@\n+.RS\n+.RE\n@@ -133,1 +135,1 @@\n-\\f[V]jhsdb jstack\\f[R]\n+.B \\f[CB]jhsdb\\ jstack\\f[R]\n@@ -135,0 +137,2 @@\n+.RS\n+.RE\n@@ -136,1 +140,1 @@\n-\\f[V]jhsdb jmap\\f[R]\n+.B \\f[CB]jhsdb\\ jmap\\f[R]\n@@ -138,0 +142,2 @@\n+.RS\n+.RE\n@@ -139,1 +145,1 @@\n-\\f[V]jhsdb jinfo\\f[R]\n+.B \\f[CB]jhsdb\\ jinfo\\f[R]\n@@ -141,0 +147,2 @@\n+.RS\n+.RE\n@@ -142,1 +150,1 @@\n-\\f[V]jhsdb jsnap\\f[R]\n+.B \\f[CB]jhsdb\\ jsnap\\f[R]\n@@ -144,0 +152,2 @@\n+.RS\n+.RE\n@@ -145,1 +155,1 @@\n-\\f[V]jhsdb\\f[R] \\f[I]command\\f[R] \\f[V]--help\\f[R]\n+.B \\f[CB]jhsdb\\f[R] \\f[I]command\\f[R] \\f[CB]\\-\\-help\\f[R]\n@@ -147,0 +157,2 @@\n+.RS\n+.RE\n@@ -149,1 +161,1 @@\n-\\f[V]--serverid\\f[R] \\f[I]server-id\\f[R]\n+.B \\f[CB]\\-\\-serverid\\f[R] \\f[I]server\\-id\\f[R]\n@@ -152,0 +164,2 @@\n+.RS\n+.RE\n@@ -153,1 +167,1 @@\n-\\f[V]--rmiport\\f[R] \\f[I]port\\f[R]\n+.B \\f[CB]\\-\\-rmiport\\f[R] \\f[I]port\\f[R]\n@@ -156,0 +170,2 @@\n+.RS\n+.RE\n@@ -157,1 +173,1 @@\n-\\f[V]--registryport\\f[R] \\f[I]port\\f[R]\n+.B \\f[CB]\\-\\-registryport\\f[R] \\f[I]port\\f[R]\n@@ -163,0 +179,2 @@\n+.RS\n+.RE\n@@ -164,1 +182,1 @@\n-\\f[V]--hostname\\f[R] \\f[I]hostname\\f[R]\n+.B \\f[CB]\\-\\-hostname\\f[R] \\f[I]hostname\\f[R]\n@@ -171,0 +189,2 @@\n+.RS\n+.RE\n@@ -173,1 +193,1 @@\n-\\f[V]--flags\\f[R]\n+.B \\f[CB]\\-\\-flags\\f[R]\n@@ -175,0 +195,2 @@\n+.RS\n+.RE\n@@ -176,1 +198,1 @@\n-\\f[V]--sysprops\\f[R]\n+.B \\f[CB]\\-\\-sysprops\\f[R]\n@@ -178,0 +200,2 @@\n+.RS\n+.RE\n@@ -179,1 +203,1 @@\n-no option\n+.B no option\n@@ -181,0 +205,2 @@\n+.RS\n+.RE\n@@ -183,2 +209,4 @@\n-no option\n-Prints the same information as Solaris \\f[V]pmap\\f[R].\n+.B no option\n+Prints the same information as Solaris \\f[CB]pmap\\f[R].\n+.RS\n+.RE\n@@ -186,2 +214,4 @@\n-\\f[V]--heap\\f[R]\n-Prints the \\f[V]java\\f[R] heap summary.\n+.B \\f[CB]\\-\\-heap\\f[R]\n+Prints the \\f[CB]java\\f[R] heap summary.\n+.RS\n+.RE\n@@ -189,2 +219,4 @@\n-\\f[V]--binaryheap\\f[R]\n-Dumps the \\f[V]java\\f[R] heap in \\f[V]hprof\\f[R] binary format.\n+.B \\f[CB]\\-\\-binaryheap\\f[R]\n+Dumps the \\f[CB]java\\f[R] heap in \\f[CB]hprof\\f[R] binary format.\n+.RS\n+.RE\n@@ -192,1 +224,1 @@\n-\\f[V]--dumpfile\\f[R] \\f[I]name\\f[R]\n+.B \\f[CB]\\-\\-dumpfile\\f[R] \\f[I]name\\f[R]\n@@ -194,0 +226,2 @@\n+.RS\n+.RE\n@@ -195,2 +229,4 @@\n-\\f[V]--histo\\f[R]\n-Prints the histogram of \\f[V]java\\f[R] object heap.\n+.B \\f[CB]\\-\\-histo\\f[R]\n+Prints the histogram of \\f[CB]java\\f[R] object heap.\n+.RS\n+.RE\n@@ -198,1 +234,1 @@\n-\\f[V]--clstats\\f[R]\n+.B \\f[CB]\\-\\-clstats\\f[R]\n@@ -200,0 +236,2 @@\n+.RS\n+.RE\n@@ -201,1 +239,1 @@\n-\\f[V]--finalizerinfo\\f[R]\n+.B \\f[CB]\\-\\-finalizerinfo\\f[R]\n@@ -203,0 +241,2 @@\n+.RS\n+.RE\n@@ -205,2 +245,4 @@\n-\\f[V]--locks\\f[R]\n-Prints the \\f[V]java.util.concurrent\\f[R] locks information.\n+.B \\f[CB]\\-\\-locks\\f[R]\n+Prints the \\f[CB]java.util.concurrent\\f[R] locks information.\n+.RS\n+.RE\n@@ -208,2 +250,2 @@\n-\\f[V]--mixed\\f[R]\n-Attempts to print both \\f[V]java\\f[R] and native frames if the platform\n+.B \\f[CB]\\-\\-mixed\\f[R]\n+Attempts to print both \\f[CB]java\\f[R] and native frames if the platform\n@@ -211,0 +253,2 @@\n+.RS\n+.RE\n@@ -213,1 +257,1 @@\n-\\f[V]--all\\f[R]\n+.B \\f[CB]\\-\\-all\\f[R]\n@@ -215,0 +259,2 @@\n+.RS\n+.RE\n","filename":"src\/jdk.hotspot.agent\/share\/man\/jhsdb.1","additions":131,"deletions":85,"binary":false,"changes":216,"status":"modified"},{"patch":"@@ -22,1 +22,1 @@\n-.\\\" Automatically generated by Pandoc 2.19.2\n+.\\\" Automatically generated by Pandoc 2.3.1\n@@ -24,15 +24,1 @@\n-.\\\" Define V font for inline verbatim, using C font in formats\n-.\\\" that render this, and otherwise B font.\n-.ie \"\\f[CB]x\\f[R]\"x\" \\{\\\n-. ftr V B\n-. ftr VI BI\n-. ftr VB B\n-. ftr VBI BI\n-.\\}\n-.el \\{\\\n-. ftr V CR\n-. ftr VI CI\n-. ftr VB CB\n-. ftr VBI CBI\n-.\\}\n-.TH \"JWEBSERVER\" \"1\" \"2023\" \"JDK 20-ea\" \"JDK Commands\"\n+.TH \"JWEBSERVER\" \"1\" \"2023\" \"JDK 20\\-ea\" \"JDK Commands\"\n@@ -42,1 +28,1 @@\n-jwebserver - launch the Java Simple Web Server\n+jwebserver \\- launch the Java Simple Web Server\n@@ -45,1 +31,1 @@\n-\\f[V]jwebserver\\f[R] [\\f[I]options\\f[R]]\n+\\f[CB]jwebserver\\f[R] [\\f[I]options\\f[R]]\n@@ -47,2 +33,2 @@\n-\\f[I]options\\f[R]\n-Command-line options.\n+.B \\f[I]options\\f[R]\n+Command\\-line options.\n@@ -50,0 +36,2 @@\n+.RS\n+.RE\n@@ -52,2 +40,2 @@\n-The \\f[V]jwebserver\\f[R] tool provides a minimal HTTP server, designed\n-to be used for prototyping, testing, and debugging.\n+The \\f[CB]jwebserver\\f[R] tool provides a minimal HTTP server, designed to\n+be used for prototyping, testing, and debugging.\n@@ -58,2 +46,2 @@\n-Any other requests receive a \\f[V]501 - Not Implemented\\f[R] or a\n-\\f[V]405 - Not Allowed\\f[R] response.\n+Any other requests receive a \\f[CB]501\\ \\-\\ Not\\ Implemented\\f[R] or a\n+\\f[CB]405\\ \\-\\ Not\\ Allowed\\f[R] response.\n@@ -71,3 +59,3 @@\n-MIME types are configured automatically, using the built-in table.\n-For example, \\f[V].html\\f[R] files are served as \\f[V]text\/html\\f[R] and\n-\\f[V].java\\f[R] files are served as \\f[V]text\/plain\\f[R].\n+MIME types are configured automatically, using the built\\-in table.\n+For example, \\f[CB]\\&.html\\f[R] files are served as \\f[CB]text\/html\\f[R] and\n+\\f[CB]\\&.java\\f[R] files are served as \\f[CB]text\/plain\\f[R].\n@@ -75,2 +63,2 @@\n-\\f[V]jwebserver\\f[R] is located in the jdk.httpserver module, and can\n-alternatively be started with \\f[V]java -m jdk.httpserver\\f[R].\n+\\f[CB]jwebserver\\f[R] is located in the jdk.httpserver module, and can\n+alternatively be started with \\f[CB]java\\ \\-m\\ jdk.httpserver\\f[R].\n@@ -78,2 +66,2 @@\n-\\f[V]com.sun.net.httpserver\\f[R] package.\n-The \\f[V]com.sun.net.httpserver.SimpleFileServer\\f[R] class provides a\n+\\f[CB]com.sun.net.httpserver\\f[R] package.\n+The \\f[CB]com.sun.net.httpserver.SimpleFileServer\\f[R] class provides a\n@@ -86,3 +74,3 @@\n-jwebserver [-b bind address] [-p port] [-d directory]\n-           [-o none|info|verbose] [-h to show options]\n-           [-version to show version information]\n+jwebserver\\ [\\-b\\ bind\\ address]\\ [\\-p\\ port]\\ [\\-d\\ directory]\n+\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ [\\-o\\ none|info|verbose]\\ [\\-h\\ to\\ show\\ options]\n+\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ [\\-version\\ to\\ show\\ version\\ information]\n@@ -93,1 +81,1 @@\n-\\f[V]-h\\f[R] or \\f[V]-?\\f[R] or \\f[V]--help\\f[R]\n+.B \\f[CB]\\-h\\f[R] or \\f[CB]\\-?\\f[R] or \\f[CB]\\-\\-help\\f[R]\n@@ -95,0 +83,2 @@\n+.RS\n+.RE\n@@ -96,1 +86,1 @@\n-\\f[V]-b\\f[R] \\f[I]addr\\f[R] or \\f[V]--bind-address\\f[R] \\f[I]addr\\f[R]\n+.B \\f[CB]\\-b\\f[R] \\f[I]addr\\f[R] or \\f[CB]\\-\\-bind\\-address\\f[R] \\f[I]addr\\f[R]\n@@ -99,1 +89,3 @@\n-For all interfaces use \\f[V]-b 0.0.0.0\\f[R] or \\f[V]-b ::\\f[R].\n+For all interfaces use \\f[CB]\\-b\\ 0.0.0.0\\f[R] or \\f[CB]\\-b\\ ::\\f[R].\n+.RS\n+.RE\n@@ -101,1 +93,1 @@\n-\\f[V]-d\\f[R] \\f[I]dir\\f[R] or \\f[V]--directory\\f[R] \\f[I]dir\\f[R]\n+.B \\f[CB]\\-d\\f[R] \\f[I]dir\\f[R] or \\f[CB]\\-\\-directory\\f[R] \\f[I]dir\\f[R]\n@@ -104,0 +96,2 @@\n+.RS\n+.RE\n@@ -105,1 +99,1 @@\n-\\f[V]-o\\f[R] \\f[I]level\\f[R] or \\f[V]--output\\f[R] \\f[I]level\\f[R]\n+.B \\f[CB]\\-o\\f[R] \\f[I]level\\f[R] or \\f[CB]\\-\\-output\\f[R] \\f[I]level\\f[R]\n@@ -107,2 +101,4 @@\n-\\f[V]none\\f[R] | \\f[V]info\\f[R] | \\f[V]verbose\\f[R].\n-Default: \\f[V]info\\f[R].\n+\\f[CB]none\\f[R] | \\f[CB]info\\f[R] | \\f[CB]verbose\\f[R].\n+Default: \\f[CB]info\\f[R].\n+.RS\n+.RE\n@@ -110,1 +106,1 @@\n-\\f[V]-p\\f[R] \\f[I]port\\f[R] or \\f[V]--port\\f[R] \\f[I]port\\f[R]\n+.B \\f[CB]\\-p\\f[R] \\f[I]port\\f[R] or \\f[CB]\\-\\-port\\f[R] \\f[I]port\\f[R]\n@@ -113,0 +109,2 @@\n+.RS\n+.RE\n@@ -114,1 +112,1 @@\n-\\f[V]-version\\f[R] or \\f[V]--version\\f[R]\n+.B \\f[CB]\\-version\\f[R] or \\f[CB]\\-\\-version\\f[R]\n@@ -116,0 +114,2 @@\n+.RS\n+.RE\n@@ -117,1 +117,1 @@\n-To stop the server, press \\f[V]Ctrl + C\\f[R].\n+To stop the server, press \\f[CB]Ctrl\\ +\\ C\\f[R].\n@@ -124,1 +124,1 @@\n-$ jwebserver\n+$\\ jwebserver\n@@ -129,1 +129,1 @@\n-\\f[V]System.out\\f[R] listing the local address and the absolute path of\n+\\f[CB]System.out\\f[R] listing the local address and the absolute path of\n@@ -135,4 +135,4 @@\n-$ jwebserver\n-Binding to loopback by default. For all interfaces use \\[dq]-b 0.0.0.0\\[dq] or \\[dq]-b ::\\[dq].\n-Serving \/cwd and subdirectories on 127.0.0.1 port 8000\n-URL http:\/\/127.0.0.1:8000\/\n+$\\ jwebserver\n+Binding\\ to\\ loopback\\ by\\ default.\\ For\\ all\\ interfaces\\ use\\ \"\\-b\\ 0.0.0.0\"\\ or\\ \"\\-b\\ ::\".\n+Serving\\ \/cwd\\ and\\ subdirectories\\ on\\ 127.0.0.1\\ port\\ 8000\n+URL\\ http:\/\/127.0.0.1:8000\/\n@@ -145,1 +145,4 @@\n-This can be changed with the \\f[V]-b\\f[R] and \\f[V]-p\\f[R] options.\n+This can be changed with the \\f[CB]\\-b\\f[R] and \\f[CB]\\-p\\f[R] options.\n+.PD 0\n+.P\n+.PD\n@@ -150,3 +153,3 @@\n-$ jwebserver -b 0.0.0.0\n-Serving \/cwd and subdirectories on 0.0.0.0 (all interfaces) port 8000\n-URL http:\/\/123.456.7.891:8000\/\n+$\\ jwebserver\\ \\-b\\ 0.0.0.0\n+Serving\\ \/cwd\\ and\\ subdirectories\\ on\\ 0.0.0.0\\ (all\\ interfaces)\\ port\\ 8000\n+URL\\ http:\/\/123.456.7.891:8000\/\n@@ -165,1 +168,1 @@\n-$ jwebserver -p 9000\n+$\\ jwebserver\\ \\-p\\ 9000\n@@ -170,1 +173,1 @@\n-A different directory can be specified with the \\f[V]-d\\f[R] option.\n+A different directory can be specified with the \\f[CB]\\-d\\f[R] option.\n@@ -177,1 +180,1 @@\n-127.0.0.1 - - [10\/Feb\/2021:14:34:11 +0000] \\[dq]GET \/some\/subdirectory\/ HTTP\/1.1\\[dq] 200 -\n+127.0.0.1\\ \\-\\ \\-\\ [10\/Feb\/2021:14:34:11\\ +0000]\\ \"GET\\ \/some\/subdirectory\/\\ HTTP\/1.1\"\\ 200\\ \\-\n@@ -181,3 +184,3 @@\n-Logging output can be changed with the \\f[V]-o\\f[R] option.\n-The default setting is \\f[V]info\\f[R].\n-The \\f[V]verbose\\f[R] setting additionally includes the request and\n+Logging output can be changed with the \\f[CB]\\-o\\f[R] option.\n+The default setting is \\f[CB]info\\f[R].\n+The \\f[CB]verbose\\f[R] setting additionally includes the request and\n@@ -189,1 +192,1 @@\n-\\f[V]SIGINT\\f[R] signal (\\f[V]Ctrl+C\\f[R] in a terminal window).\n+\\f[CB]SIGINT\\f[R] signal (\\f[CB]Ctrl+C\\f[R] in a terminal window).\n@@ -192,2 +195,2 @@\n-The \\f[V]-h\\f[R] option displays a help message describing the usage and\n-the options of the \\f[V]jwebserver\\f[R].\n+The \\f[CB]\\-h\\f[R] option displays a help message describing the usage and\n+the options of the \\f[CB]jwebserver\\f[R].\n","filename":"src\/jdk.httpserver\/share\/man\/jwebserver.1","additions":66,"deletions":63,"binary":false,"changes":129,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2004, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2004, 2021, Oracle and\/or its affiliates. All rights reserved.\n@@ -47,0 +47,1 @@\n+    private FilenameFilter oldtmpFileFilter;\n@@ -55,1 +56,1 @@\n-        \/\/ The files are in {tmpdir}\/hsperfdata_{any_user_name}\/[0-9]+\n+        \/\/ 1.4.2 and later: The files are in {tmpdir}\/hsperfdata_{any_user_name}\/[0-9]+\n@@ -69,0 +70,9 @@\n+\n+        \/\/ 1.4.1 (or earlier?): the files are stored directly under {tmpdir}\/ with\n+        \/\/ the following pattern.\n+        Pattern oldtmpFilePattern = Pattern.compile(PerfDataFile.tmpFileNamePattern);\n+        oldtmpFileFilter = new FilenameFilter() {\n+            public boolean accept(File dir, String name) {\n+                return oldtmpFilePattern.matcher(name).matches();\n+            }\n+        };\n@@ -93,1 +103,1 @@\n-            \/\/ Look for the files {tmpdir}\/hsperfdata_{any_user_name}\/[0-9]+\n+            \/\/ 1.4.2 and later: Look for the files {tmpdir}\/hsperfdata_{any_user_name}\/[0-9]+\n@@ -114,0 +124,14 @@\n+\n+            \/\/ look for any 1.4.1 files that are readable by the current user.\n+            File[] files = tmpdir.listFiles(oldtmpFileFilter);\n+            if (files != null) {\n+                for (File file : files) {\n+                    if (file.isFile() && file.canRead()) {\n+                        int vmid = PerfDataFile.getLocalVmId(file);\n+                        if (vmid != -1) {\n+                            jvmSet.add(vmid);\n+                        }\n+                    }\n+                }\n+            }\n+\n","filename":"src\/jdk.internal.jvmstat\/share\/classes\/sun\/jvmstat\/perfdata\/monitor\/protocol\/local\/LocalVmManager.java","additions":27,"deletions":3,"binary":false,"changes":30,"status":"modified"},{"patch":"@@ -64,0 +64,1 @@\n+            \/\/ Try 1.4.2 and later first\n@@ -66,1 +67,25 @@\n-        } catch (IOException | IllegalArgumentException e) {\n+\n+        } catch (IllegalArgumentException e) {\n+            \/\/ now try 1.4.1 by attempting to directly map the files.\n+            try {\n+                String filename = PerfDataFile.getTempDirectory()\n+                                  + PerfDataFile.dirNamePrefix\n+                                  + Integer.toString(vmid.getLocalVmId());\n+\n+                File f = new File(filename);\n+\n+                FileChannel fc = new RandomAccessFile(f, \"r\").getChannel();\n+                ByteBuffer bb = fc.map(FileChannel.MapMode.READ_ONLY, 0L,\n+                                       (int)fc.size());\n+                fc.close();\n+                createPerfDataBuffer(bb, vmid.getLocalVmId());\n+\n+            } catch (FileNotFoundException e2) {\n+                \/\/ re-throw the exception from the 1.4.2 attach method\n+                throw new MonitorException(vmid.getLocalVmId() + \" not found\",\n+                                           e);\n+            } catch (IOException e2) {\n+                throw new MonitorException(\"Could not map 1.4.1 file for \"\n+                                           + vmid.getLocalVmId(), e2);\n+            }\n+        } catch (IOException e) {\n","filename":"src\/jdk.internal.jvmstat\/share\/classes\/sun\/jvmstat\/perfdata\/monitor\/protocol\/local\/PerfDataBuffer.java","additions":26,"deletions":1,"binary":false,"changes":27,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2004, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2004, 2021, Oracle and\/or its affiliates. All rights reserved.\n@@ -67,2 +67,1 @@\n-     * used by the 1.4.2 and later HotSpot JVM. Earlier versions are\n-     * no longer supported.\n+     * used by the 1.4.2 and later HotSpot JVM.\n@@ -72,0 +71,10 @@\n+    \/**\n+     * The file name pattern for 1.4.1 PerfData shared memory files.\n+     * <p>\n+     * This pattern must be kept in synch with the file name pattern\n+     * used by the 1.4.1 HotSpot JVM.\n+     *\/\n+    public static final String tmpFileNamePattern =\n+            \"^hsperfdata_[0-9]+(_[1-2]+)?$\";\n+\n+\n@@ -91,0 +100,1 @@\n+            \/\/ try 1.4.2 and later format first\n@@ -94,1 +104,14 @@\n-        throw new IllegalArgumentException(\"Cannot convert '\" + file + \"' to VM id\");\n+        \/\/ now try the 1.4.1 format\n+        String name = file.getName();\n+        if (name.startsWith(dirNamePrefix)) {\n+            int first = name.indexOf('_');\n+            int last = name.lastIndexOf('_');\n+            try {\n+                if (first == last) {\n+                    return Integer.parseInt(name.substring(first + 1));\n+                } else {\n+                    return Integer.parseInt(name.substring(first + 1, last));\n+                }\n+            } catch (NumberFormatException e) { }\n+        }\n+        throw new IllegalArgumentException(\"file name does not match pattern\");\n","filename":"src\/jdk.internal.jvmstat\/share\/classes\/sun\/jvmstat\/perfdata\/monitor\/protocol\/local\/PerfDataFile.java","additions":27,"deletions":4,"binary":false,"changes":31,"status":"modified"},{"patch":"@@ -234,1 +234,0 @@\n-        AVX512_IFMA,\n","filename":"src\/jdk.internal.vm.ci\/share\/classes\/jdk.vm.ci.amd64\/src\/jdk\/vm\/ci\/amd64\/AMD64.java","additions":0,"deletions":1,"binary":false,"changes":1,"status":"modified"},{"patch":"@@ -28,1 +28,0 @@\n-import jdk.vm.ci.services.Services;\n@@ -36,3 +35,0 @@\n-    public final boolean linuxOs = Services.getSavedProperty(\"os.name\", \"\").startsWith(\"Linux\");\n-    public final boolean macOs = Services.getSavedProperty(\"os.name\", \"\").startsWith(\"Mac\");\n-\n","filename":"src\/jdk.internal.vm.ci\/share\/classes\/jdk.vm.ci.code\/src\/jdk\/vm\/ci\/code\/TargetDescription.java","additions":0,"deletions":4,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -96,1 +96,1 @@\n-        boolean canUsePlatformRegister = target.linuxOs;\n+        boolean canUsePlatformRegister = config.linuxOs;\n","filename":"src\/jdk.internal.vm.ci\/share\/classes\/jdk.vm.ci.hotspot.aarch64\/src\/jdk\/vm\/ci\/hotspot\/aarch64\/AArch64HotSpotJVMCIBackendFactory.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -231,21 +231,0 @@\n-    private int parseStackArg(ValueKind<?> valueKind, AllocatableValue[] locations, int index, int currentStackOffset, HotSpotCallingConventionType type) {\n-        int kindSize = valueKind.getPlatformKind().getSizeInBytes();\n-        locations[index] = StackSlot.get(valueKind, currentStackOffset, !type.out);\n-        currentStackOffset += Math.max(kindSize, target.wordSize);\n-        return currentStackOffset;\n-    }\n-\n-    private int parseDarwinNativeStackArg(ValueKind<?> valueKind, AllocatableValue[] locations, int index, int currentStackOffset, HotSpotCallingConventionType type) {\n-        int kindSize = valueKind.getPlatformKind().getSizeInBytes();\n-        if (currentStackOffset % kindSize != 0) {\n-            \/\/ In MacOS natural alignment is used\n-            \/\/ See https:\/\/developer.apple.com\/documentation\/xcode\/writing-arm64-code-for-apple-platforms\n-            currentStackOffset += kindSize - currentStackOffset % kindSize;\n-        }\n-        locations[index] = StackSlot.get(valueKind, currentStackOffset, !type.out);\n-        \/\/ In MacOS \"Function arguments may consume slots on the stack that are not multiples of 8 bytes\"\n-        \/\/ See https:\/\/developer.apple.com\/documentation\/xcode\/writing-arm64-code-for-apple-platforms\n-        currentStackOffset += kindSize;\n-        return currentStackOffset;\n-    }\n-\n@@ -288,5 +267,3 @@\n-                if (target.macOs && type == HotSpotCallingConventionType.NativeCall) {\n-                    currentStackOffset = parseDarwinNativeStackArg(valueKindFactory.getValueKind(kind), locations, i, currentStackOffset, type);\n-                } else {\n-                    currentStackOffset = parseStackArg(valueKindFactory.getValueKind(kind), locations, i, currentStackOffset, type);\n-                }\n+                ValueKind<?> valueKind = valueKindFactory.getValueKind(kind);\n+                locations[i] = StackSlot.get(valueKind, currentStackOffset, !type.out);\n+                currentStackOffset += Math.max(valueKind.getPlatformKind().getSizeInBytes(), target.wordSize);\n","filename":"src\/jdk.internal.vm.ci\/share\/classes\/jdk.vm.ci.hotspot.aarch64\/src\/jdk\/vm\/ci\/hotspot\/aarch64\/AArch64HotSpotRegisterConfig.java","additions":3,"deletions":26,"binary":false,"changes":29,"status":"modified"},{"patch":"@@ -27,0 +27,1 @@\n+import jdk.vm.ci.services.Services;\n@@ -39,0 +40,2 @@\n+    final boolean linuxOs = Services.getSavedProperty(\"os.name\", \"\").startsWith(\"Linux\");\n+\n","filename":"src\/jdk.internal.vm.ci\/share\/classes\/jdk.vm.ci.hotspot.aarch64\/src\/jdk\/vm\/ci\/hotspot\/aarch64\/AArch64HotSpotVMConfig.java","additions":3,"deletions":0,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -254,12 +254,0 @@\n-    \/**\n-     * Resolves the entry at index {@code cpi} in {@code constantPool} to an interned String object.\n-     *\n-     * The behavior of this method is undefined if {@code cpi} does not denote an\n-     * {@code JVM_CONSTANT_String}.\n-     *\/\n-    JavaConstant getUncachedStringInPool(HotSpotConstantPool constantPool, int cpi) {\n-        return getUncachedStringInPool(constantPool, constantPool.getConstantPoolPointer(), cpi);\n-    }\n-\n-    private native JavaConstant getUncachedStringInPool(HotSpotConstantPool constantPool, long constantPoolPointer, int cpi);\n-\n","filename":"src\/jdk.internal.vm.ci\/share\/classes\/jdk.vm.ci.hotspot\/src\/jdk\/vm\/ci\/hotspot\/CompilerToVM.java","additions":0,"deletions":12,"binary":false,"changes":12,"status":"modified"},{"patch":"@@ -259,3 +259,1 @@\n-            if (index >= 0) {\n-                throw new IllegalArgumentException(\"not an invokedynamic constant pool index \" + index);\n-            }\n+            assert index < 0 : \"not an invokedynamic constant pool index \" + index;\n@@ -263,13 +261,3 @@\n-            if (opcode == Bytecodes.GETFIELD ||\n-                            opcode == Bytecodes.PUTFIELD ||\n-                            opcode == Bytecodes.GETSTATIC ||\n-                            opcode == Bytecodes.PUTSTATIC ||\n-                            opcode == Bytecodes.INVOKEINTERFACE ||\n-                            opcode == Bytecodes.INVOKEVIRTUAL ||\n-                            opcode == Bytecodes.INVOKESPECIAL ||\n-                            opcode == Bytecodes.INVOKESTATIC) {\n-                index = rawIndex + config().constantPoolCpCacheIndexTag;\n-            } else {\n-                throw new IllegalArgumentException(\"unexpected opcode \" + opcode);\n-\n-            }\n+            assert opcode == Bytecodes.GETFIELD || opcode == Bytecodes.PUTFIELD || opcode == Bytecodes.GETSTATIC || opcode == Bytecodes.PUTSTATIC || opcode == Bytecodes.INVOKEINTERFACE ||\n+                            opcode == Bytecodes.INVOKEVIRTUAL || opcode == Bytecodes.INVOKESPECIAL || opcode == Bytecodes.INVOKESTATIC : \"unexpected invoke opcode \" + opcode;\n+            index = rawIndex + config().constantPoolCpCacheIndexTag;\n@@ -307,3 +295,1 @@\n-        if (!isInvokedynamicIndex(i)) {\n-            throw new IllegalArgumentException(\"not an invokedynamic index: \" + i);\n-        }\n+        assert isInvokedynamicIndex(i) : i;\n@@ -332,1 +318,1 @@\n-        checkBounds(index);\n+        assert checkBounds(index);\n@@ -349,1 +335,1 @@\n-        checkBounds(index);\n+        assert checkBounds(index);\n@@ -361,1 +347,1 @@\n-        checkTag(index, constants.jvmInteger);\n+        assert checkTag(index, constants.jvmInteger);\n@@ -373,1 +359,1 @@\n-        checkTag(index, constants.jvmLong);\n+        assert checkTag(index, constants.jvmLong);\n@@ -385,1 +371,1 @@\n-        checkTag(index, constants.jvmFloat);\n+        assert checkTag(index, constants.jvmFloat);\n@@ -397,1 +383,1 @@\n-        checkTag(index, constants.jvmDouble);\n+        assert checkTag(index, constants.jvmDouble);\n@@ -409,1 +395,1 @@\n-        checkTag(index, constants.jvmNameAndType);\n+        assert checkTag(index, constants.jvmNameAndType);\n@@ -491,1 +477,1 @@\n-        checkTagIsFieldOrMethod(index);\n+        assert checkTagIsFieldOrMethod(index);\n@@ -502,1 +488,1 @@\n-     * @throws IndexOutOfBoundsException if the check fails\n+     * @throws AssertionError if the check fails\n@@ -504,4 +490,3 @@\n-    private void checkBounds(int index) {\n-        if (index < 1 || index >= length()) {\n-            throw new IndexOutOfBoundsException(\"index \" + index + \" not between 1 and \" + length());\n-        }\n+    private boolean checkBounds(int index) {\n+        assert 0 <= index && index < length() : \"index \" + index + \" not between 0 and \" + length();\n+        return true;\n@@ -515,1 +500,1 @@\n-     * @throws IllegalArgumentException if the check fails\n+     * @throws AssertionError if the check fails\n@@ -517,1 +502,1 @@\n-    private void checkTag(int index, JvmConstant tag) {\n+    private boolean checkTag(int index, JvmConstant tag) {\n@@ -519,3 +504,2 @@\n-        if (tagAt != tag) {\n-            throw new IllegalArgumentException(\"constant pool tag at index \" + index + \" is \" + tagAt + \" but expected \" + tag);\n-        }\n+        assert tagAt == tag : \"constant pool tag at index \" + index + \" is \" + tagAt + \" but expected \" + tag;\n+        return true;\n@@ -530,1 +514,1 @@\n-     * @throws IllegalArgumentException if the check fails\n+     * @throws AssertionError if the check fails\n@@ -532,1 +516,1 @@\n-    private void checkTagIsFieldOrMethod(int index) {\n+    private boolean checkTagIsFieldOrMethod(int index) {\n@@ -534,3 +518,2 @@\n-        if (tagAt != constants.jvmFieldref && tagAt != constants.jvmMethodref && tagAt != constants.jvmInterfaceMethodref) {\n-            throw new IllegalArgumentException(\"constant pool tag at index \" + index + \" is \" + tagAt);\n-        }\n+        assert tagAt == constants.jvmFieldref || tagAt == constants.jvmMethodref || tagAt == constants.jvmInterfaceMethodref : tagAt;\n+        return true;\n@@ -639,21 +622,0 @@\n-    \/**\n-     * Gets the {@link JavaConstant} for the {@code ConstantValue} attribute of a field.\n-     *\/\n-    JavaConstant getStaticFieldConstantValue(int cpi) {\n-        final JvmConstant tag = getTagAt(cpi);\n-        switch (tag.name) {\n-            case \"Integer\":\n-                return JavaConstant.forInt(getIntAt(cpi));\n-            case \"Long\":\n-                return JavaConstant.forLong(getLongAt(cpi));\n-            case \"Float\":\n-                return JavaConstant.forFloat(getFloatAt(cpi));\n-            case \"Double\":\n-                return JavaConstant.forDouble(getDoubleAt(cpi));\n-            case \"String\":\n-                return compilerToVM().getUncachedStringInPool(this, cpi);\n-            default:\n-                throw new IllegalArgumentException(\"Illegal entry for a ConstantValue attribute:\" + tag);\n-        }\n-    }\n-\n@@ -662,0 +624,1 @@\n+        assert cpi != 0;\n@@ -698,1 +661,1 @@\n-        checkTag(cpi, constants.jvmUtf8);\n+        assert checkTag(cpi, constants.jvmUtf8);\n@@ -709,4 +672,1 @@\n-        if (!Bytecodes.isInvoke(opcode)) {\n-            throw new IllegalArgumentException(\"expected an invoke bytecode at \" + cpi + \", got \" + opcode);\n-        }\n-\n+        assert Bytecodes.isInvoke(opcode);\n@@ -844,3 +804,1 @@\n-            if (opcode != Bytecodes.INVOKEDYNAMIC) {\n-                throw new IllegalArgumentException(\"expected INVOKEDYNAMIC at \" + rawIndex + \", got \" + opcode);\n-            }\n+            assert opcode == Bytecodes.INVOKEDYNAMIC;\n@@ -849,3 +807,1 @@\n-            if (opcode == Bytecodes.INVOKEDYNAMIC) {\n-                throw new IllegalArgumentException(\"unexpected INVOKEDYNAMIC at \" + rawIndex);\n-            }\n+            assert opcode != Bytecodes.INVOKEDYNAMIC;\n@@ -862,1 +818,0 @@\n-    @Override\n@@ -924,1 +879,1 @@\n-                        checkTag(compilerToVM().constantPoolRemapInstructionOperandFromCache(this, methodRefCacheIndex), constants.jvmMethodref);\n+                        assert checkTag(compilerToVM().constantPoolRemapInstructionOperandFromCache(this, methodRefCacheIndex), constants.jvmMethodref);\n@@ -976,1 +931,1 @@\n-            checkTag(compilerToVM().constantPoolRemapInstructionOperandFromCache(this, methodRefCacheIndex), constants.jvmMethodref);\n+            assert checkTag(compilerToVM().constantPoolRemapInstructionOperandFromCache(this, methodRefCacheIndex), constants.jvmMethodref);\n","filename":"src\/jdk.internal.vm.ci\/share\/classes\/jdk.vm.ci.hotspot\/src\/jdk\/vm\/ci\/hotspot\/HotSpotConstantPool.java","additions":32,"deletions":77,"binary":false,"changes":109,"status":"modified"},{"patch":"@@ -286,1 +286,1 @@\n-    static Executable getMethod(HotSpotResolvedJavaMethodImpl method) {\n+    private static Executable getMethod(HotSpotResolvedJavaMethodImpl method) {\n@@ -306,1 +306,1 @@\n-    static Field getField(HotSpotResolvedJavaFieldImpl field) {\n+    private static Field getField(HotSpotResolvedJavaFieldImpl field) {\n","filename":"src\/jdk.internal.vm.ci\/share\/classes\/jdk.vm.ci.hotspot\/src\/jdk\/vm\/ci\/hotspot\/HotSpotJDKReflection.java","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -38,2 +38,0 @@\n-import java.lang.reflect.Executable;\n-import java.lang.reflect.Field;\n@@ -65,2 +63,0 @@\n-import jdk.vm.ci.meta.ResolvedJavaField;\n-import jdk.vm.ci.meta.ResolvedJavaMethod;\n@@ -776,1 +772,1 @@\n-     * Gets the {@link Class} corresponding to {@code type}.\n+     * Get the {@link Class} corresponding to {@code type}.\n@@ -790,30 +786,0 @@\n-    \/**\n-     * Gets the {@link Executable} corresponding to {@code method}.\n-     *\n-     * @param method the method for which an {@link Executable} is requested\n-     * @return the original Java method or constructor corresponding to {@code method} or\n-     *         {@code null} if this runtime does not support mapping {@link ResolvedJavaMethod}\n-     *         instances to {@link Executable} instances\n-     *\/\n-    public Executable getMirror(ResolvedJavaMethod method) {\n-        if (method instanceof HotSpotResolvedJavaMethodImpl && reflection instanceof HotSpotJDKReflection) {\n-            return HotSpotJDKReflection.getMethod((HotSpotResolvedJavaMethodImpl) method);\n-        }\n-        return null;\n-    }\n-\n-    \/**\n-     * Gets the {@link Field} corresponding to {@code field}.\n-     *\n-     * @param field the field for which a {@link Field} is requested\n-     * @return the original Java field corresponding to {@code field} or {@code null} if this\n-     *         runtime does not support mapping {@link ResolvedJavaField} instances to {@link Field}\n-     *         instances\n-     *\/\n-    public Field getMirror(ResolvedJavaField field) {\n-        if (field instanceof HotSpotResolvedJavaFieldImpl && reflection instanceof HotSpotJDKReflection) {\n-            return HotSpotJDKReflection.getField((HotSpotResolvedJavaFieldImpl) field);\n-        }\n-        return null;\n-    }\n-\n","filename":"src\/jdk.internal.vm.ci\/share\/classes\/jdk.vm.ci.hotspot\/src\/jdk\/vm\/ci\/hotspot\/HotSpotJVMCIRuntime.java","additions":1,"deletions":35,"binary":false,"changes":36,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2012, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2012, Oracle and\/or its affiliates. All rights reserved.\n@@ -48,3 +48,0 @@\n-        if (!method.getDeclaringClass().isLinked()) {\n-            throw new IllegalArgumentException(method.format(\"%H.%n(%p) must be linked\"));\n-        }\n","filename":"src\/jdk.internal.vm.ci\/share\/classes\/jdk.vm.ci.hotspot\/src\/jdk\/vm\/ci\/hotspot\/HotSpotProfilingInfo.java","additions":1,"deletions":4,"binary":false,"changes":5,"status":"modified"},{"patch":"@@ -25,1 +25,0 @@\n-import static jdk.internal.misc.Unsafe.ADDRESS_SIZE;\n@@ -29,0 +28,1 @@\n+import static jdk.internal.misc.Unsafe.ADDRESS_SIZE;\n@@ -48,2 +48,1 @@\n-     * Offset (in bytes) of field from start of its storage container (i.e. {@code instanceOop} or\n-     * {@code Klass*}).\n+     * Value of {@code fieldDescriptor::access_flags()}.\n@@ -56,1 +55,1 @@\n-    private final int index;\n+    private final short index;\n@@ -63,1 +62,1 @@\n-    HotSpotResolvedJavaFieldImpl(HotSpotResolvedObjectTypeImpl holder, JavaType type, int offset, int modifiers, int index) {\n+    HotSpotResolvedJavaFieldImpl(HotSpotResolvedObjectTypeImpl holder, JavaType type, long offset, int modifiers, int index) {\n@@ -66,2 +65,5 @@\n-        this.index = index;\n-        this.offset = offset;\n+        this.index = (short) index;\n+        assert this.index == index;\n+        assert offset != -1;\n+        assert offset == (int) offset : \"offset larger than int\";\n+        this.offset = (int) offset;\n@@ -144,4 +146,0 @@\n-    \/**\n-     * Gets the offset (in bytes) of field from start of its storage container (i.e.\n-     * {@code instanceOop} or {@code Klass*}).\n-     *\/\n@@ -219,5 +217,0 @@\n-\n-    @Override\n-    public JavaConstant getConstantValue() {\n-        return holder.createFieldInfo(index).getConstantValue();\n-    }\n","filename":"src\/jdk.internal.vm.ci\/share\/classes\/jdk.vm.ci.hotspot\/src\/jdk\/vm\/ci\/hotspot\/HotSpotResolvedJavaFieldImpl.java","additions":9,"deletions":16,"binary":false,"changes":25,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2011, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2011, 2021, Oracle and\/or its affiliates. All rights reserved.\n@@ -259,5 +259,1 @@\n-        int codeSize = UNSAFE.getChar(getConstMethod() + config().constMethodCodeSizeOffset);\n-        if (codeSize > 0 && !getDeclaringClass().isLinked()) {\n-            return -1;\n-        }\n-        return codeSize;\n+        return UNSAFE.getChar(getConstMethod() + config().constMethodCodeSizeOffset);\n","filename":"src\/jdk.internal.vm.ci\/share\/classes\/jdk.vm.ci.hotspot\/src\/jdk\/vm\/ci\/hotspot\/HotSpotResolvedJavaMethodImpl.java","additions":2,"deletions":6,"binary":false,"changes":8,"status":"modified"},{"patch":"@@ -579,1 +579,1 @@\n-    HotSpotResolvedJavaField createField(JavaType type, int offset, int rawFlags, int index) {\n+    HotSpotResolvedJavaField createField(JavaType type, long offset, int rawFlags, int index) {\n@@ -692,4 +692,0 @@\n-        private int getConstantValueIndex() {\n-            return readFieldSlot(config().fieldInfoConstantValueIndexOffset);\n-        }\n-\n@@ -731,13 +727,0 @@\n-        \/**\n-         * Gets the {@link JavaConstant} for the {@code ConstantValue} attribute of this field.\n-         *\n-         * @return {@code null} if this field has no {@code ConstantValue} attribute\n-         *\/\n-        public JavaConstant getConstantValue() {\n-            int cvIndex = getConstantValueIndex();\n-            if (cvIndex == 0) {\n-                return null;\n-            }\n-            return constantPool.getStaticFieldConstantValue(cvIndex);\n-        }\n-\n@@ -999,9 +982,0 @@\n-        link();\n-        return runtime().compilerToVm.getDeclaredConstructors(this);\n-    }\n-\n-    @Override\n-    public ResolvedJavaMethod[] getDeclaredConstructors(boolean forceLink) {\n-        if (forceLink) {\n-            link();\n-        }\n@@ -1013,8 +987,0 @@\n-        return getDeclaredMethods(true);\n-    }\n-\n-    @Override\n-    public ResolvedJavaMethod[] getDeclaredMethods(boolean forceLink) {\n-        if (forceLink) {\n-            link();\n-        }\n","filename":"src\/jdk.internal.vm.ci\/share\/classes\/jdk.vm.ci.hotspot\/src\/jdk\/vm\/ci\/hotspot\/HotSpotResolvedObjectTypeImpl.java","additions":1,"deletions":35,"binary":false,"changes":36,"status":"modified"},{"patch":"@@ -122,1 +122,0 @@\n-    final int fieldInfoConstantValueIndexOffset = getConstant(\"FieldInfo::initval_index_offset\", Integer.class);\n","filename":"src\/jdk.internal.vm.ci\/share\/classes\/jdk.vm.ci.hotspot\/src\/jdk\/vm\/ci\/hotspot\/HotSpotVMConfig.java","additions":0,"deletions":1,"binary":false,"changes":1,"status":"modified"},{"patch":"@@ -52,18 +52,0 @@\n-    \/**\n-     * Ensures that the type referenced by the specified constant pool entry is loaded. This can be\n-     * used to compile time resolve a type. It works for field, method, or type constant pool\n-     * entries.\n-     *\n-     * @param cpi the index of the constant pool entry that references the type\n-     * @param opcode the opcode of the instruction that references the type\n-     * @param initialize if {@code true}, the referenced type is either guaranteed to be initialized\n-     *            upon return or an initialization exception is thrown\n-     *\/\n-    default void loadReferencedType(int cpi, int opcode, boolean initialize) {\n-        if (initialize) {\n-            loadReferencedType(cpi, opcode);\n-        } else {\n-            throw new UnsupportedOperationException();\n-        }\n-    }\n-\n","filename":"src\/jdk.internal.vm.ci\/share\/classes\/jdk.vm.ci.meta\/src\/jdk\/vm\/ci\/meta\/ConstantPool.java","additions":0,"deletions":18,"binary":false,"changes":18,"status":"modified"},{"patch":"@@ -43,4 +43,0 @@\n-    \/**\n-     * Returns the offset of the field relative to the base of its storage container (e.g.,\n-     * {@code instanceOop} for an instance field or {@code Klass*} for a static field on HotSpot).\n-     *\/\n@@ -70,11 +66,0 @@\n-\n-    \/**\n-     * Gets the value of the {@code ConstantValue} attribute ({@jvms 4.7.2}) associated with this\n-     * field.\n-     *\n-     * @return {@code null} if this field has no {@code ConstantValue} attribute\n-     * @throws UnsupportedOperationException if this operation is not supported\n-     *\/\n-    default JavaConstant getConstantValue() {\n-        throw new UnsupportedOperationException();\n-    }\n","filename":"src\/jdk.internal.vm.ci\/share\/classes\/jdk.vm.ci.meta\/src\/jdk\/vm\/ci\/meta\/ResolvedJavaField.java","additions":0,"deletions":15,"binary":false,"changes":15,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2009, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2009, 2019, Oracle and\/or its affiliates. All rights reserved.\n@@ -39,3 +39,4 @@\n-     * Returns the method's bytecode. The returned bytecode does not contain breakpoints or non-Java\n-     * bytecodes. This will return {@code null} if {@link #getCodeSize()} returns {@code <= 0} or if\n-     * {@link #hasBytecodes()} returns {@code false}.\n+     * Returns the bytecode of this method, if the method has code. The returned byte array does not\n+     * contain breakpoints or non-Java bytecodes. This may return null if the\n+     * {@linkplain #getDeclaringClass() declaring class} is not\n+     * {@linkplain ResolvedJavaType#isLinked() linked}.\n@@ -43,1 +44,1 @@\n-     * The contained constant pool indexes may not be the ones found in the original class file but\n+     * The contained constant pool indices may not be the ones found in the original class file but\n@@ -46,2 +47,2 @@\n-     * @return {@code null} if {@code getLinkedCodeSize() <= 0} otherwise the bytecode of the method\n-     *         whose length is guaranteed to be {@code > 0}\n+     * @return the bytecode of the method, or {@code null} if {@code getCodeSize() == 0} or if the\n+     *         code is not ready.\n@@ -52,2 +53,2 @@\n-     * Returns the size of the method's bytecode. If this method returns a value {@code > 0} then\n-     * {@link #getCode()} will not return {@code null}.\n+     * Returns the size of the bytecode of this method, if the method has code. This is equivalent\n+     * to {@link #getCode()}. {@code length} if the method has code.\n@@ -55,4 +56,1 @@\n-     * @return 0 if the method has no bytecode, {@code -1} if the method does have bytecode but its\n-     *         {@linkplain #getDeclaringClass() declaring class} is not\n-     *         {@linkplain ResolvedJavaType#isLinked() linked} otherwise the size of the bytecode in\n-     *         bytes (guaranteed to be {@code > 0})\n+     * @return the size of the bytecode in bytes, or 0 if no bytecode is available\n@@ -442,2 +440,6 @@\n-     * @see #getCodeSize()\n-     * @return {@code getCodeSize() > 0}\n+     * Checks whether the method has bytecodes associated with it. Note that even if this method\n+     * returns {@code true}, {@link #getCode} can return {@code null} if\n+     * {@linkplain #getDeclaringClass() declaring class} is not\n+     * {@linkplain ResolvedJavaType#isLinked() linked}.\n+     *\n+     * @return {@code this.getCodeSize() != 0}\n@@ -446,1 +448,1 @@\n-        return getCodeSize() > 0;\n+        return getCodeSize() != 0;\n","filename":"src\/jdk.internal.vm.ci\/share\/classes\/jdk.vm.ci.meta\/src\/jdk\/vm\/ci\/meta\/ResolvedJavaMethod.java","additions":18,"deletions":16,"binary":false,"changes":34,"status":"modified"},{"patch":"@@ -342,10 +342,0 @@\n-    \/**\n-     * Returns an array reflecting all the constructors declared by this type. This method is\n-     * similar to {@link Class#getDeclaredConstructors()} in terms of returned constructors.\n-     *\n-     * @param forceLink if {@code true}, forces this type to be {@link #link linked}\n-     *\/\n-    default ResolvedJavaMethod[] getDeclaredConstructors(boolean forceLink) {\n-        throw new UnsupportedOperationException();\n-    }\n-\n@@ -359,10 +349,0 @@\n-    \/**\n-     * Returns an array reflecting all the methods declared by this type. This method is similar to\n-     * {@link Class#getDeclaredMethods()} in terms of returned methods.\n-     *\n-     * @param forceLink if {@code true}, forces this type to be {@link #link linked}\n-     *\/\n-    default ResolvedJavaMethod[] getDeclaredMethods(boolean forceLink) {\n-        throw new UnsupportedOperationException();\n-    }\n-\n","filename":"src\/jdk.internal.vm.ci\/share\/classes\/jdk.vm.ci.meta\/src\/jdk\/vm\/ci\/meta\/ResolvedJavaType.java","additions":0,"deletions":20,"binary":false,"changes":20,"status":"modified"},{"patch":"@@ -108,1 +108,1 @@\n-        return attrs.majorVersion >= that.attrs.majorVersion;\n+        return attrs.version >= that.attrs.version;\n@@ -239,1 +239,1 @@\n-        private int majorVersion;\n+        private int version;\n@@ -258,1 +258,1 @@\n-            this.majorVersion = version & 0xFFFF; \/\/ JDK-8296329: extract major version only\n+            this.version = version;\n","filename":"src\/jdk.jartool\/share\/classes\/sun\/tools\/jar\/FingerPrint.java","additions":3,"deletions":3,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -22,1 +22,1 @@\n-.\\\" Automatically generated by Pandoc 2.19.2\n+.\\\" Automatically generated by Pandoc 2.3.1\n@@ -24,15 +24,1 @@\n-.\\\" Define V font for inline verbatim, using C font in formats\n-.\\\" that render this, and otherwise B font.\n-.ie \"\\f[CB]x\\f[R]\"x\" \\{\\\n-. ftr V B\n-. ftr VI BI\n-. ftr VB B\n-. ftr VBI BI\n-.\\}\n-.el \\{\\\n-. ftr V CR\n-. ftr VI CI\n-. ftr VB CB\n-. ftr VBI CBI\n-.\\}\n-.TH \"JAR\" \"1\" \"2023\" \"JDK 20-ea\" \"JDK Commands\"\n+.TH \"JAR\" \"1\" \"2022\" \"JDK 20\\-internal\" \"JDK Commands\"\n@@ -42,1 +28,1 @@\n-jar - create an archive for classes and resources, and manipulate or\n+jar \\- create an archive for classes and resources, and manipulate or\n@@ -46,3 +32,2 @@\n-\\f[V]jar\\f[R] [\\f[I]OPTION\\f[R] ...]\n-[ [\\f[V]--release\\f[R] \\f[I]VERSION\\f[R]] [\\f[V]-C\\f[R] \\f[I]dir\\f[R]]\n-\\f[I]files\\f[R]] ...\n+\\f[CB]jar\\f[R] [\\f[I]OPTION\\f[R] ...] [ [\\f[CB]\\-\\-release\\f[R]\n+\\f[I]VERSION\\f[R]] [\\f[CB]\\-C\\f[R] \\f[I]dir\\f[R]] \\f[I]files\\f[R]] ...\n@@ -51,1 +36,1 @@\n-The \\f[V]jar\\f[R] command is a general-purpose archiving and compression\n+The \\f[CB]jar\\f[R] command is a general\\-purpose archiving and compression\n@@ -53,4 +38,3 @@\n-Initially, the \\f[V]jar\\f[R] command was designed to package Java\n-applets (not supported since JDK 11) or applications; however, beginning\n-with JDK 9, users can use the \\f[V]jar\\f[R] command to create modular\n-JARs.\n+Initially, the \\f[CB]jar\\f[R] command was designed to package Java applets\n+(not supported since JDK 11) or applications; however, beginning with\n+JDK 9, users can use the \\f[CB]jar\\f[R] command to create modular JARs.\n@@ -60,2 +44,2 @@\n-The syntax for the \\f[V]jar\\f[R] command resembles the syntax for the\n-\\f[V]tar\\f[R] command.\n+The syntax for the \\f[CB]jar\\f[R] command resembles the syntax for the\n+\\f[CB]tar\\f[R] command.\n@@ -72,1 +56,1 @@\n-The \\f[V]jar\\f[R] command also compresses files, which further improves\n+The \\f[CB]jar\\f[R] command also compresses files, which further improves\n@@ -74,2 +58,2 @@\n-The \\f[V]jar\\f[R] command also enables individual entries in a file to\n-be signed so that their origin can be authenticated.\n+The \\f[CB]jar\\f[R] command also enables individual entries in a file to be\n+signed so that their origin can be authenticated.\n@@ -80,2 +64,2 @@\n-\\f[V]module-info.class\\f[R], in the root of the given directories or in\n-the root of the \\f[V].jar\\f[R] archive.\n+\\f[CB]module\\-info.class\\f[R], in the root of the given directories or in\n+the root of the \\f[CB]\\&.jar\\f[R] archive.\n@@ -84,1 +68,1 @@\n-updating a modular jar or updating an existing non-modular jar:\n+updating a modular jar or updating an existing non\\-modular jar:\n@@ -86,1 +70,1 @@\n-\\f[V]--module-version\\f[R]\n+\\f[CB]\\-\\-module\\-version\\f[R]\n@@ -88,1 +72,1 @@\n-\\f[V]--hash-modules\\f[R]\n+\\f[CB]\\-\\-hash\\-modules\\f[R]\n@@ -90,1 +74,1 @@\n-\\f[V]--module-path\\f[R]\n+\\f[CB]\\-\\-module\\-path\\f[R]\n@@ -98,1 +82,1 @@\n-When using the \\f[V]jar\\f[R] command, you must specify the operation for\n+When using the \\f[CB]jar\\f[R] command, you must specify the operation for\n@@ -100,3 +84,3 @@\n-You specify the operation mode for the \\f[V]jar\\f[R] command by\n-including the appropriate operation arguments described in this section.\n-You can mix an operation argument with other one-letter options.\n+You specify the operation mode for the \\f[CB]jar\\f[R] command by including\n+the appropriate operation arguments described in this section.\n+You can mix an operation argument with other one\\-letter options.\n@@ -106,1 +90,1 @@\n-\\f[V]-c\\f[R] or \\f[V]--create\\f[R]\n+.B \\f[CB]\\-c\\f[R] or \\f[CB]\\-\\-create\\f[R]\n@@ -108,0 +92,2 @@\n+.RS\n+.RE\n@@ -109,1 +95,1 @@\n-\\f[V]-i\\f[R] \\f[I]FILE\\f[R] or \\f[V]--generate-index=\\f[R]\\f[I]FILE\\f[R]\n+.B \\f[CB]\\-i\\f[R] \\f[I]FILE\\f[R] or \\f[CB]\\-\\-generate\\-index=\\f[R]\\f[I]FILE\\f[R]\n@@ -111,0 +97,2 @@\n+.RS\n+.RE\n@@ -112,1 +100,1 @@\n-\\f[V]-t\\f[R] or \\f[V]--list\\f[R]\n+.B \\f[CB]\\-t\\f[R] or \\f[CB]\\-\\-list\\f[R]\n@@ -114,0 +102,2 @@\n+.RS\n+.RE\n@@ -115,1 +105,1 @@\n-\\f[V]-u\\f[R] or \\f[V]--update\\f[R]\n+.B \\f[CB]\\-u\\f[R] or \\f[CB]\\-\\-update\\f[R]\n@@ -117,0 +107,2 @@\n+.RS\n+.RE\n@@ -118,1 +110,1 @@\n-\\f[V]-x\\f[R] or \\f[V]--extract\\f[R]\n+.B \\f[CB]\\-x\\f[R] or \\f[CB]\\-\\-extract\\f[R]\n@@ -120,0 +112,2 @@\n+.RS\n+.RE\n@@ -121,1 +115,1 @@\n-\\f[V]-d\\f[R] or \\f[V]--describe-module\\f[R]\n+.B \\f[CB]\\-d\\f[R] or \\f[CB]\\-\\-describe\\-module\\f[R]\n@@ -123,0 +117,2 @@\n+.RS\n+.RE\n@@ -126,1 +122,1 @@\n-operation mode included in the \\f[V]jar\\f[R] command.\n+operation mode included in the \\f[CB]jar\\f[R] command.\n@@ -128,1 +124,1 @@\n-\\f[V]-C\\f[R] \\f[I]DIR\\f[R]\n+.B \\f[CB]\\-C\\f[R] \\f[I]DIR\\f[R]\n@@ -133,3 +129,2 @@\n-\\f[V]jar\\f[R] [\\f[I]OPTION\\f[R] ...]\n-[ [\\f[V]--release\\f[R] \\f[I]VERSION\\f[R]] [\\f[V]-C\\f[R] \\f[I]dir\\f[R]]\n-\\f[I]files\\f[R]]\n+\\f[CB]jar\\f[R] [\\f[I]OPTION\\f[R] ...] [ [\\f[CB]\\-\\-release\\f[R]\n+\\f[I]VERSION\\f[R]] [\\f[CB]\\-C\\f[R] \\f[I]dir\\f[R]] \\f[I]files\\f[R]]\n@@ -138,1 +133,1 @@\n-\\f[V]-f\\f[R] \\f[I]FILE\\f[R] or \\f[V]--file=\\f[R]\\f[I]FILE\\f[R]\n+.B \\f[CB]\\-f\\f[R] \\f[I]FILE\\f[R] or \\f[CB]\\-\\-file=\\f[R]\\f[I]FILE\\f[R]\n@@ -140,0 +135,2 @@\n+.RS\n+.RE\n@@ -141,1 +138,1 @@\n-\\f[V]--release\\f[R] \\f[I]VERSION\\f[R]\n+.B \\f[CB]\\-\\-release\\f[R] \\f[I]VERSION\\f[R]\n@@ -145,1 +142,1 @@\n-\\f[V]META-INF\/versions\/\\f[R]\\f[I]VERSION\\f[R]\\f[V]\/\\f[R], where\n+\\f[CB]META\\-INF\/versions\/\\f[R]\\f[I]VERSION\\f[R]\\f[CB]\/\\f[R], where\n@@ -152,2 +149,2 @@\n-directory tree whose \\f[I]VERSION\\f[R] number matches the JDK\\[aq]s\n-major version number.\n+directory tree whose \\f[I]VERSION\\f[R] number matches the JDK\\[aq]s major\n+version number.\n@@ -158,1 +155,1 @@\n-\\f[V]-v\\f[R] or \\f[V]--verbose\\f[R]\n+.B \\f[CB]\\-v\\f[R] or \\f[CB]\\-\\-verbose\\f[R]\n@@ -160,0 +157,2 @@\n+.RS\n+.RE\n@@ -165,1 +164,1 @@\n-\\f[V]-e\\f[R] \\f[I]CLASSNAME\\f[R] or \\f[V]--main-class=\\f[R]\\f[I]CLASSNAME\\f[R]\n+.B \\f[CB]\\-e\\f[R] \\f[I]CLASSNAME\\f[R] or \\f[CB]\\-\\-main\\-class=\\f[R]\\f[I]CLASSNAME\\f[R]\n@@ -168,0 +167,2 @@\n+.RS\n+.RE\n@@ -169,1 +170,1 @@\n-\\f[V]-m\\f[R] \\f[I]FILE\\f[R] or \\f[V]--manifest=\\f[R]\\f[I]FILE\\f[R]\n+.B \\f[CB]\\-m\\f[R] \\f[I]FILE\\f[R] or \\f[CB]\\-\\-manifest=\\f[R]\\f[I]FILE\\f[R]\n@@ -171,0 +172,2 @@\n+.RS\n+.RE\n@@ -172,1 +175,1 @@\n-\\f[V]-M\\f[R] or \\f[V]--no-manifest\\f[R]\n+.B \\f[CB]\\-M\\f[R] or \\f[CB]\\-\\-no\\-manifest\\f[R]\n@@ -174,0 +177,2 @@\n+.RS\n+.RE\n@@ -175,1 +180,1 @@\n-\\f[V]--module-version=\\f[R]\\f[I]VERSION\\f[R]\n+.B \\f[CB]\\-\\-module\\-version=\\f[R]\\f[I]VERSION\\f[R]\n@@ -177,1 +182,3 @@\n-file, or updating a non-modular JAR file.\n+file, or updating a non\\-modular JAR file.\n+.RS\n+.RE\n@@ -179,1 +186,1 @@\n-\\f[V]--hash-modules=\\f[R]\\f[I]PATTERN\\f[R]\n+.B \\f[CB]\\-\\-hash\\-modules=\\f[R]\\f[I]PATTERN\\f[R]\n@@ -182,1 +189,3 @@\n-created or a non-modular JAR file being updated.\n+created or a non\\-modular JAR file being updated.\n+.RS\n+.RE\n@@ -184,1 +193,1 @@\n-\\f[V]-p\\f[R] or \\f[V]--module-path\\f[R]\n+.B \\f[CB]\\-p\\f[R] or \\f[CB]\\-\\-module\\-path\\f[R]\n@@ -186,0 +195,2 @@\n+.RS\n+.RE\n@@ -187,3 +198,6 @@\n-\\f[V]\\[at]\\f[R]\\f[I]file\\f[R]\n-Reads \\f[V]jar\\f[R] options and file names from a text file.\n-.SH OPERATION MODIFIERS VALID ONLY IN CREATE, UPDATE, AND GENERATE-INDEX MODES\n+.B \\f[CB]\\@\\f[R]\\f[I]file\\f[R]\n+Reads \\f[CB]jar\\f[R] options and file names from a text file.\n+.RS\n+.RE\n+.SH OPERATION MODIFIERS VALID ONLY IN CREATE, UPDATE, AND\n+GENERATE\\-INDEX MODES\n@@ -192,3 +206,3 @@\n-(\\f[V]-c\\f[R] or \\f[V]--create\\f[R]) the update (\\f[V]-u\\f[R] or\n-\\f[V]--update\\f[R] ) and the generate-index (\\f[V]-i\\f[R] or\n-\\f[V]--generate-index=\\f[R]\\f[I]FILE\\f[R]) main operation modes:\n+(\\f[CB]\\-c\\f[R] or \\f[CB]\\-\\-create\\f[R]) the update (\\f[CB]\\-u\\f[R] or\n+\\f[CB]\\-\\-update\\f[R] ) and the generate\\-index (\\f[CB]\\-i\\f[R] or\n+\\f[CB]\\-\\-generate\\-index=\\f[R]\\f[I]FILE\\f[R]) main operation modes:\n@@ -196,1 +210,1 @@\n-\\f[V]-0\\f[R] or \\f[V]--no-compress\\f[R]\n+.B \\f[CB]\\-0\\f[R] or \\f[CB]\\-\\-no\\-compress\\f[R]\n@@ -198,0 +212,2 @@\n+.RS\n+.RE\n@@ -199,4 +215,6 @@\n-\\f[V]--date=\\f[R]\\f[I]TIMESTAMP\\f[R]\n-The timestamp in ISO-8601 extended offset date-time with optional\n-time-zone format, to use for the timestamp of the entries, e.g.\n-\\[dq]2022-02-12T12:30:00-05:00\\[dq].\n+.B \\f[CB]\\-\\-date=\\f[R]\\f[I]TIMESTAMP\\f[R]\n+The timestamp in ISO\\-8601 extended offset date\\-time with optional\n+time\\-zone format, to use for the timestamp of the entries, e.g.\n+\"2022\\-02\\-12T12:30:00\\-05:00\".\n+.RS\n+.RE\n@@ -205,2 +223,2 @@\n-The following options are recognized by the \\f[V]jar\\f[R] command and\n-not used with operation modes:\n+The following options are recognized by the \\f[CB]jar\\f[R] command and not\n+used with operation modes:\n@@ -208,2 +226,2 @@\n-\\f[V]-h\\f[R] or \\f[V]--help\\f[R][\\f[V]:compat\\f[R]]\n-Displays the command-line help for the \\f[V]jar\\f[R] command or\n+.B \\f[CB]\\-h\\f[R] or \\f[CB]\\-\\-help\\f[R][\\f[CB]:compat\\f[R]]\n+Displays the command\\-line help for the \\f[CB]jar\\f[R] command or\n@@ -211,0 +229,2 @@\n+.RS\n+.RE\n@@ -212,1 +232,1 @@\n-\\f[V]--help-extra\\f[R]\n+.B \\f[CB]\\-\\-help\\-extra\\f[R]\n@@ -214,0 +234,2 @@\n+.RS\n+.RE\n@@ -215,1 +237,1 @@\n-\\f[V]--version\\f[R]\n+.B \\f[CB]\\-\\-version\\f[R]\n@@ -217,0 +239,2 @@\n+.RS\n+.RE\n@@ -219,2 +243,2 @@\n-Create an archive, \\f[V]classes.jar\\f[R], that contains two class files,\n-\\f[V]Foo.class\\f[R] and \\f[V]Bar.class\\f[R].\n+Create an archive, \\f[CB]classes.jar\\f[R], that contains two class files,\n+\\f[CB]Foo.class\\f[R] and \\f[CB]Bar.class\\f[R].\n@@ -224,1 +248,1 @@\n-\\f[V]jar --create --file classes.jar Foo.class Bar.class\\f[R]\n+\\f[CB]jar\\ \\-\\-create\\ \\-\\-file\\ classes.jar\\ Foo.class\\ Bar.class\\f[R]\n@@ -228,3 +252,3 @@\n-Create an archive, \\f[V]classes.jar\\f[R], that contains two class files,\n-\\f[V]Foo.class\\f[R] and \\f[V]Bar.class\\f[R] setting the last modified\n-date and time to \\f[V]2021 Jan 6 12:36:00\\f[R].\n+Create an archive, \\f[CB]classes.jar\\f[R], that contains two class files,\n+\\f[CB]Foo.class\\f[R] and \\f[CB]Bar.class\\f[R] setting the last modified date\n+and time to \\f[CB]2021\\ Jan\\ 6\\ 12:36:00\\f[R].\n@@ -234,1 +258,1 @@\n-\\f[V]jar --create --date=\\[dq]2021-01-06T14:36:00+02:00\\[dq] --file=classes.jar Foo.class Bar.class\\f[R]\n+\\f[CB]jar\\ \\-\\-create\\ \\-\\-date=\"2021\\-01\\-06T14:36:00+02:00\"\\ \\-\\-file=classes.jar\\ Foo.class\\ Bar.class\\f[R]\n@@ -238,3 +262,3 @@\n-Create an archive, \\f[V]classes.jar\\f[R], by using an existing manifest,\n-\\f[V]mymanifest\\f[R], that contains all of the files in the directory\n-\\f[V]foo\/\\f[R].\n+Create an archive, \\f[CB]classes.jar\\f[R], by using an existing manifest,\n+\\f[CB]mymanifest\\f[R], that contains all of the files in the directory\n+\\f[CB]foo\/\\f[R].\n@@ -244,1 +268,1 @@\n-\\f[V]jar --create --file classes.jar --manifest mymanifest -C foo\/\\f[R]\n+\\f[CB]jar\\ \\-\\-create\\ \\-\\-file\\ classes.jar\\ \\-\\-manifest\\ mymanifest\\ \\-C\\ foo\/\\f[R]\n@@ -248,2 +272,2 @@\n-Create a modular JAR archive,\\f[V]foo.jar\\f[R], where the module\n-descriptor is located in \\f[V]classes\/module-info.class\\f[R].\n+Create a modular JAR archive,\\f[CB]foo.jar\\f[R], where the module\n+descriptor is located in \\f[CB]classes\/module\\-info.class\\f[R].\n@@ -253,1 +277,1 @@\n-\\f[V]jar --create --file foo.jar --main-class com.foo.Main --module-version 1.0 -C foo\/classes resources\\f[R]\n+\\f[CB]jar\\ \\-\\-create\\ \\-\\-file\\ foo.jar\\ \\-\\-main\\-class\\ com.foo.Main\\ \\-\\-module\\-version\\ 1.0\\ \\-C\\ foo\/classes\\ resources\\f[R]\n@@ -257,1 +281,1 @@\n-Update an existing non-modular JAR, \\f[V]foo.jar\\f[R], to a modular JAR\n+Update an existing non\\-modular JAR, \\f[CB]foo.jar\\f[R], to a modular JAR\n@@ -262,1 +286,1 @@\n-\\f[V]jar --update --file foo.jar --main-class com.foo.Main --module-version 1.0 -C foo\/module-info.class\\f[R]\n+\\f[CB]jar\\ \\-\\-update\\ \\-\\-file\\ foo.jar\\ \\-\\-main\\-class\\ com.foo.Main\\ \\-\\-module\\-version\\ 1.0\\ \\-C\\ foo\/module\\-info.class\\f[R]\n@@ -266,4 +290,4 @@\n-Create a versioned or multi-release JAR, \\f[V]foo.jar\\f[R], that places\n-the files in the \\f[V]classes\\f[R] directory at the root of the JAR, and\n-the files in the \\f[V]classes-10\\f[R] directory in the\n-\\f[V]META-INF\/versions\/10\\f[R] directory of the JAR.\n+Create a versioned or multi\\-release JAR, \\f[CB]foo.jar\\f[R], that places\n+the files in the \\f[CB]classes\\f[R] directory at the root of the JAR, and\n+the files in the \\f[CB]classes\\-10\\f[R] directory in the\n+\\f[CB]META\\-INF\/versions\/10\\f[R] directory of the JAR.\n@@ -272,5 +296,5 @@\n-In this example, the \\f[V]classes\/com\/foo\\f[R] directory contains two\n-classes, \\f[V]com.foo.Hello\\f[R] (the entry point class) and\n-\\f[V]com.foo.NameProvider\\f[R], both compiled for JDK 8.\n-The \\f[V]classes-10\/com\/foo\\f[R] directory contains a different version\n-of the \\f[V]com.foo.NameProvider\\f[R] class, this one containing JDK 10\n+In this example, the \\f[CB]classes\/com\/foo\\f[R] directory contains two\n+classes, \\f[CB]com.foo.Hello\\f[R] (the entry point class) and\n+\\f[CB]com.foo.NameProvider\\f[R], both compiled for JDK 8.\n+The \\f[CB]classes\\-10\/com\/foo\\f[R] directory contains a different version\n+of the \\f[CB]com.foo.NameProvider\\f[R] class, this one containing JDK 10\n@@ -279,1 +303,1 @@\n-Given this setup, create a multirelease JAR file \\f[V]foo.jar\\f[R] by\n+Given this setup, create a multirelease JAR file \\f[CB]foo.jar\\f[R] by\n@@ -281,1 +305,1 @@\n-directories \\f[V]classes\\f[R] and \\f[V]classes-10\\f[R] .\n+directories \\f[CB]classes\\f[R] and \\f[CB]classes\\-10\\f[R] .\n@@ -284,1 +308,1 @@\n-\\f[V]jar --create --file foo.jar --main-class com.foo.Hello -C classes . --release 10 -C classes-10 .\\f[R]\n+\\f[CB]jar\\ \\-\\-create\\ \\-\\-file\\ foo.jar\\ \\-\\-main\\-class\\ com.foo.Hello\\ \\-C\\ classes\\ .\\ \\-\\-release\\ 10\\ \\-C\\ classes\\-10\\ .\\f[R]\n@@ -287,1 +311,1 @@\n-The JAR file \\f[V]foo.jar\\f[R] now contains:\n+The JAR file \\f[CB]foo.jar\\f[R] now contains:\n@@ -291,1 +315,1 @@\n-% jar -tf foo.jar\n+%\\ jar\\ \\-tf\\ foo.jar\n@@ -293,2 +317,2 @@\n-META-INF\/\n-META-INF\/MANIFEST.MF\n+META\\-INF\/\n+META\\-INF\/MANIFEST.MF\n@@ -299,3 +323,3 @@\n-META-INF\/versions\/10\/com\/\n-META-INF\/versions\/10\/com\/foo\/\n-META-INF\/versions\/10\/com\/foo\/NameProvider.class\n+META\\-INF\/versions\/10\/com\/\n+META\\-INF\/versions\/10\/com\/foo\/\n+META\\-INF\/versions\/10\/com\/foo\/NameProvider.class\n@@ -305,1 +329,1 @@\n-As well as other information, the file \\f[V]META-INF\/MANIFEST.MF\\f[R],\n+As well as other information, the file \\f[CB]META\\-INF\/MANIFEST.MF\\f[R],\n@@ -307,1 +331,1 @@\n-JAR file with an entry point of \\f[V]com.foo.Hello\\f[R].\n+JAR file with an entry point of \\f[CB]com.foo.Hello\\f[R].\n@@ -312,2 +336,2 @@\n-Main-Class: com.foo.Hello\n-Multi-Release: true\n+Main\\-Class:\\ com.foo.Hello\n+Multi\\-Release:\\ true\n@@ -317,4 +341,4 @@\n-Assuming that the \\f[V]com.foo.Hello\\f[R] class calls a method on the\n-\\f[V]com.foo.NameProvider\\f[R] class, running the program using JDK 10\n-will ensure that the \\f[V]com.foo.NameProvider\\f[R] class is the one in\n-\\f[V]META-INF\/versions\/10\/com\/foo\/\\f[R].\n+Assuming that the \\f[CB]com.foo.Hello\\f[R] class calls a method on the\n+\\f[CB]com.foo.NameProvider\\f[R] class, running the program using JDK 10\n+will ensure that the \\f[CB]com.foo.NameProvider\\f[R] class is the one in\n+\\f[CB]META\\-INF\/versions\/10\/com\/foo\/\\f[R].\n@@ -322,2 +346,2 @@\n-\\f[V]com.foo.NameProvider\\f[R] class is the one at the root of the JAR,\n-in \\f[V]com\/foo\\f[R].\n+\\f[CB]com.foo.NameProvider\\f[R] class is the one at the root of the JAR,\n+in \\f[CB]com\/foo\\f[R].\n@@ -326,2 +350,2 @@\n-Create an archive, \\f[V]my.jar\\f[R], by reading options and lists of\n-class files from the file \\f[V]classes.list\\f[R].\n+Create an archive, \\f[CB]my.jar\\f[R], by reading options and lists of\n+class files from the file \\f[CB]classes.list\\f[R].\n@@ -332,3 +356,3 @@\n-To shorten or simplify the \\f[V]jar\\f[R] command, you can specify\n-arguments in a separate text file and pass it to the \\f[V]jar\\f[R]\n-command with the at sign (\\f[V]\\[at]\\f[R]) as a prefix.\n+To shorten or simplify the \\f[CB]jar\\f[R] command, you can specify\n+arguments in a separate text file and pass it to the \\f[CB]jar\\f[R]\n+command with the at sign (\\f[CB]\\@\\f[R]) as a prefix.\n@@ -337,1 +361,1 @@\n-\\f[V]jar --create --file my.jar \\[at]classes.list\\f[R]\n+\\f[CB]jar\\ \\-\\-create\\ \\-\\-file\\ my.jar\\ \\@classes.list\\f[R]\n","filename":"src\/jdk.jartool\/share\/man\/jar.1","additions":157,"deletions":133,"binary":false,"changes":290,"status":"modified"},{"patch":"@@ -22,2 +22,2 @@\n-'\\\" t\n-.\\\" Automatically generated by Pandoc 2.19.2\n+.\\\"t\n+.\\\" Automatically generated by Pandoc 2.3.1\n@@ -25,15 +25,1 @@\n-.\\\" Define V font for inline verbatim, using C font in formats\n-.\\\" that render this, and otherwise B font.\n-.ie \"\\f[CB]x\\f[R]\"x\" \\{\\\n-. ftr V B\n-. ftr VI BI\n-. ftr VB B\n-. ftr VBI BI\n-.\\}\n-.el \\{\\\n-. ftr V CR\n-. ftr VI CI\n-. ftr VB CB\n-. ftr VBI CBI\n-.\\}\n-.TH \"JARSIGNER\" \"1\" \"2023\" \"JDK 20-ea\" \"JDK Commands\"\n+.TH \"JARSIGNER\" \"1\" \"2023\" \"JDK 20\\-ea\" \"JDK Commands\"\n@@ -43,1 +29,1 @@\n-jarsigner - sign and verify Java Archive (JAR) files\n+jarsigner \\- sign and verify Java Archive (JAR) files\n@@ -46,2 +32,1 @@\n-\\f[V]jarsigner\\f[R] [\\f[I]options\\f[R]] \\f[I]jar-file\\f[R]\n-\\f[I]alias\\f[R]\n+\\f[CB]jarsigner\\f[R] [\\f[I]options\\f[R]] \\f[I]jar\\-file\\f[R] \\f[I]alias\\f[R]\n@@ -49,2 +34,2 @@\n-\\f[V]jarsigner\\f[R] \\f[V]-verify\\f[R] [\\f[I]options\\f[R]]\n-\\f[I]jar-file\\f[R] [\\f[I]alias\\f[R] ...]\n+\\f[CB]jarsigner\\f[R] \\f[CB]\\-verify\\f[R] [\\f[I]options\\f[R]]\n+\\f[I]jar\\-file\\f[R] [\\f[I]alias\\f[R] ...]\n@@ -52,1 +37,1 @@\n-\\f[V]jarsigner\\f[R] \\f[V]-version\\f[R]\n+\\f[CB]jarsigner\\f[R] \\f[CB]\\-version\\f[R]\n@@ -54,2 +39,2 @@\n-\\f[I]options\\f[R]\n-The command-line options.\n+.B \\f[I]options\\f[R]\n+The command\\-line options.\n@@ -57,0 +42,2 @@\n+.RS\n+.RE\n@@ -58,2 +45,2 @@\n-\\f[V]-verify\\f[R]\n-The \\f[V]-verify\\f[R] option can take zero or more keystore alias names\n+.B \\f[CB]\\-verify\\f[R]\n+The \\f[CB]\\-verify\\f[R] option can take zero or more keystore alias names\n@@ -61,1 +48,1 @@\n-When the \\f[V]-verify\\f[R] option is specified, the \\f[V]jarsigner\\f[R]\n+When the \\f[CB]\\-verify\\f[R] option is specified, the \\f[CB]jarsigner\\f[R]\n@@ -64,1 +51,1 @@\n-The aliases are defined in the keystore specified by \\f[V]-keystore\\f[R]\n+The aliases are defined in the keystore specified by \\f[CB]\\-keystore\\f[R]\n@@ -68,3 +55,3 @@\n-If you also specify the \\f[V]-strict\\f[R] option, and the\n-\\f[V]jarsigner\\f[R] command detects severe warnings, the message,\n-\\[dq]jar verified, with signer errors\\[dq] is displayed.\n+If you also specify the \\f[CB]\\-strict\\f[R] option, and the\n+\\f[CB]jarsigner\\f[R] command detects severe warnings, the message, \"jar\n+verified, with signer errors\" is displayed.\n@@ -73,1 +60,1 @@\n-\\f[I]jar-file\\f[R]\n+.B \\f[I]jar\\-file\\f[R]\n@@ -77,3 +64,3 @@\n-If you also specified the \\f[V]-strict\\f[R] option, and the\n-\\f[V]jarsigner\\f[R] command detected severe warnings, the message,\n-\\[dq]jar signed, with signer errors\\[dq] is displayed.\n+If you also specified the \\f[CB]\\-strict\\f[R] option, and the\n+\\f[CB]jarsigner\\f[R] command detected severe warnings, the message, \"jar\n+signed, with signer errors\" is displayed.\n@@ -82,2 +69,2 @@\n-\\f[I]alias\\f[R]\n-The aliases are defined in the keystore specified by \\f[V]-keystore\\f[R]\n+.B \\f[I]alias\\f[R]\n+The aliases are defined in the keystore specified by \\f[CB]\\-keystore\\f[R]\n@@ -85,0 +72,2 @@\n+.RS\n+.RE\n@@ -86,3 +75,5 @@\n-\\f[V]-version\\f[R]\n-The \\f[V]-version\\f[R] option prints the program version of\n-\\f[V]jarsigner\\f[R].\n+.B \\f[CB]\\-version\\f[R]\n+The \\f[CB]\\-version\\f[R] option prints the program version of\n+\\f[CB]jarsigner\\f[R].\n+.RS\n+.RE\n@@ -91,1 +82,1 @@\n-The \\f[V]jarsigner\\f[R] tool has two purposes:\n+The \\f[CB]jarsigner\\f[R] tool has two purposes:\n@@ -100,1 +91,1 @@\n-A tool named \\f[V]jar\\f[R] enables developers to produce JAR files.\n+A tool named \\f[CB]jar\\f[R] enables developers to produce JAR files.\n@@ -102,3 +93,3 @@\n-when created by the \\f[V]jar\\f[R] command or processed by the\n-\\f[V]jarsigner\\f[R] command, JAR files also contain a\n-\\f[V]META-INF\/MANIFEST.MF\\f[R] file.)\n+when created by the \\f[CB]jar\\f[R] command or processed by the\n+\\f[CB]jarsigner\\f[R] command, JAR files also contain a\n+\\f[CB]META\\-INF\/MANIFEST.MF\\f[R] file.)\n@@ -130,2 +121,2 @@\n-The \\f[V]jarsigner\\f[R] command uses key and certificate information\n-from a keystore to generate digital signatures for JAR files.\n+The \\f[CB]jarsigner\\f[R] command uses key and certificate information from\n+a keystore to generate digital signatures for JAR files.\n@@ -134,2 +125,1 @@\n-The \\f[V]keytool\\f[R] command is used to create and administer\n-keystores.\n+The \\f[CB]keytool\\f[R] command is used to create and administer keystores.\n@@ -137,1 +127,1 @@\n-The \\f[V]jarsigner\\f[R] command uses an entity\\[aq]s private key to\n+The \\f[CB]jarsigner\\f[R] command uses an entity\\[aq]s private key to\n@@ -142,1 +132,1 @@\n-The \\f[V]jarsigner\\f[R] command can verify the digital signature of the\n+The \\f[CB]jarsigner\\f[R] command can verify the digital signature of the\n@@ -146,1 +136,1 @@\n-The \\f[V]jarsigner\\f[R] command can generate signatures that include a\n+The \\f[CB]jarsigner\\f[R] command can generate signatures that include a\n@@ -153,2 +143,2 @@\n-At this time, the \\f[V]jarsigner\\f[R] command can only sign JAR files\n-created by the \\f[V]jar\\f[R] command or zip files.\n+At this time, the \\f[CB]jarsigner\\f[R] command can only sign JAR files\n+created by the \\f[CB]jar\\f[R] command or zip files.\n@@ -156,3 +146,3 @@\n-\\f[V]META-INF\/MANIFEST.MF\\f[R] file.\n-A \\f[V]META-INF\/MANIFEST.MF\\f[R] file is created when the\n-\\f[V]jarsigner\\f[R] command signs a zip file.\n+\\f[CB]META\\-INF\/MANIFEST.MF\\f[R] file.\n+A \\f[CB]META\\-INF\/MANIFEST.MF\\f[R] file is created when the\n+\\f[CB]jarsigner\\f[R] command signs a zip file.\n@@ -160,1 +150,1 @@\n-The default \\f[V]jarsigner\\f[R] command behavior is to sign a JAR or zip\n+The default \\f[CB]jarsigner\\f[R] command behavior is to sign a JAR or zip\n@@ -162,1 +152,1 @@\n-Use the \\f[V]-verify\\f[R] option to verify a signed JAR file.\n+Use the \\f[CB]\\-verify\\f[R] option to verify a signed JAR file.\n@@ -164,1 +154,1 @@\n-The \\f[V]jarsigner\\f[R] command also attempts to validate the\n+The \\f[CB]jarsigner\\f[R] command also attempts to validate the\n@@ -167,1 +157,1 @@\n-in the signer\\[aq]s certificate chain when the \\f[V]-revCheck\\f[R]\n+in the signer\\[aq]s certificate chain when the \\f[CB]\\-revCheck\\f[R]\n@@ -171,1 +161,1 @@\n-If you specify the \\f[V]-strict\\f[R] option, then the command treats\n+If you specify the \\f[CB]\\-strict\\f[R] option, then the command treats\n@@ -178,3 +168,3 @@\n-When you use the \\f[V]jarsigner\\f[R] command to sign a JAR file, you\n-must specify the alias for the keystore entry that contains the private\n-key needed to generate the signature.\n+When you use the \\f[CB]jarsigner\\f[R] command to sign a JAR file, you must\n+specify the alias for the keystore entry that contains the private key\n+needed to generate the signature.\n@@ -194,1 +184,1 @@\n-The \\f[V]jarsigner\\f[R] command has a \\f[V]-keystore\\f[R] option for\n+The \\f[CB]jarsigner\\f[R] command has a \\f[CB]\\-keystore\\f[R] option for\n@@ -196,3 +186,3 @@\n-The keystore is by default stored in a file named \\f[V].keystore\\f[R] in\n-the user\\[aq]s home directory, as determined by the \\f[V]user.home\\f[R]\n-system property.\n+The keystore is by default stored in a file named \\f[CB]\\&.keystore\\f[R]\n+in the user\\[aq]s home directory, as determined by the\n+\\f[CB]user.home\\f[R] system property.\n@@ -200,1 +190,1 @@\n-\\f[B]Linux and OS X:\\f[R] \\f[V]user.home\\f[R] defaults to the user\\[aq]s\n+\\f[B]Linux and OS X:\\f[R] \\f[CB]user.home\\f[R] defaults to the user\\[aq]s\n@@ -203,5 +193,5 @@\n-The input stream from the \\f[V]-keystore\\f[R] option is passed to the\n-\\f[V]KeyStore.load\\f[R] method.\n-If \\f[V]NONE\\f[R] is specified as the URL, then a null stream is passed\n-to the \\f[V]KeyStore.load\\f[R] method.\n-\\f[V]NONE\\f[R] should be specified when the \\f[V]KeyStore\\f[R] class\n+The input stream from the \\f[CB]\\-keystore\\f[R] option is passed to the\n+\\f[CB]KeyStore.load\\f[R] method.\n+If \\f[CB]NONE\\f[R] is specified as the URL, then a null stream is passed\n+to the \\f[CB]KeyStore.load\\f[R] method.\n+\\f[CB]NONE\\f[R] should be specified when the \\f[CB]KeyStore\\f[R] class\n@@ -212,2 +202,2 @@\n-The \\f[V]KeyStore\\f[R] class provided in the \\f[V]java.security\\f[R]\n-package supplies a number of well-defined interfaces to access and\n+The \\f[CB]KeyStore\\f[R] class provided in the \\f[CB]java.security\\f[R]\n+package supplies a number of well\\-defined interfaces to access and\n@@ -218,2 +208,2 @@\n-Currently, there are two command-line tools that use keystore\n-implementations (\\f[V]keytool\\f[R] and \\f[V]jarsigner\\f[R]).\n+Currently, there are two command\\-line tools that use keystore\n+implementations (\\f[CB]keytool\\f[R] and \\f[CB]jarsigner\\f[R]).\n@@ -221,1 +211,1 @@\n-The default keystore implementation is \\f[V]PKCS12\\f[R].\n+The default keystore implementation is \\f[CB]PKCS12\\f[R].\n@@ -226,1 +216,1 @@\n-There is another built-in implementation, provided by Oracle.\n+There is another built\\-in implementation, provided by Oracle.\n@@ -228,1 +218,1 @@\n-(format) named \\f[V]JKS\\f[R].\n+(format) named \\f[CB]JKS\\f[R].\n@@ -233,5 +223,5 @@\n-Keystore implementations are provider-based, which means the application\n-interfaces supplied by the \\f[V]KeyStore\\f[R] class are implemented in\n-terms of a Service Provider Interface (SPI).\n-There is a corresponding abstract \\f[V]KeystoreSpi\\f[R] class, also in\n-the \\f[V]java.security package\\f[R], that defines the Service Provider\n+Keystore implementations are provider\\-based, which means the\n+application interfaces supplied by the \\f[CB]KeyStore\\f[R] class are\n+implemented in terms of a Service Provider Interface (SPI).\n+There is a corresponding abstract \\f[CB]KeystoreSpi\\f[R] class, also in\n+the \\f[CB]java.security\\ package\\f[R], that defines the Service Provider\n@@ -243,1 +233,1 @@\n-and supply a \\f[V]KeystoreSpi\\f[R] subclass implementation, as described\n+and supply a \\f[CB]KeystoreSpi\\f[R] subclass implementation, as described\n@@ -246,1 +236,1 @@\n-[https:\/\/www.oracle.com\/pls\/topic\/lookup?ctx=en\/java\/javase&id=security_guide_implement_provider_jca].\n+[https:\/\/www.oracle.com\/pls\/topic\/lookup?ctx=en\/java\/javase\/11\/tools&id=JSSEC\\-GUID\\-2BCFDD85\\-D533\\-4E6C\\-8CE9\\-29990DEB0190].\n@@ -249,2 +239,2 @@\n-different providers, with the \\f[V]getInstance\\f[R] factory method in\n-the \\f[V]KeyStore\\f[R] class.\n+different providers, with the \\f[CB]getInstance\\f[R] factory method in the\n+\\f[CB]KeyStore\\f[R] class.\n@@ -256,1 +246,1 @@\n-The \\f[V]jarsigner\\f[R] commands can read file-based keystores from any\n+The \\f[CB]jarsigner\\f[R] commands can read file\\-based keystores from any\n@@ -258,1 +248,1 @@\n-In addition, these commands can read non-file-based keystores such as\n+In addition, these commands can read non\\-file\\-based keystores such as\n@@ -261,1 +251,1 @@\n-For the \\f[V]jarsigner\\f[R] and \\f[V]keytool\\f[R] commands, you can\n+For the \\f[CB]jarsigner\\f[R] and \\f[CB]keytool\\f[R] commands, you can\n@@ -263,1 +253,1 @@\n-\\f[V]-storetype\\f[R] option.\n+\\f[CB]\\-storetype\\f[R] option.\n@@ -267,1 +257,1 @@\n-\\f[V]keystore.type\\f[R] property specified in the security properties\n+\\f[CB]keystore.type\\f[R] property specified in the security properties\n@@ -269,1 +259,1 @@\n-The security properties file is called \\f[V]java.security\\f[R], and it\n+The security properties file is called \\f[CB]java.security\\f[R], and it\n@@ -271,1 +261,1 @@\n-\\f[V]java.home\/conf\/security\\f[R].\n+\\f[CB]java.home\/conf\/security\\f[R].\n@@ -273,1 +263,1 @@\n-Each tool gets the \\f[V]keystore.type\\f[R] value and then examines all\n+Each tool gets the \\f[CB]keystore.type\\f[R] value and then examines all\n@@ -278,3 +268,3 @@\n-The \\f[V]KeyStore\\f[R] class defines a static method named\n-\\f[V]getDefaultType\\f[R] that lets applications retrieve the value of\n-the \\f[V]keystore.type\\f[R] property.\n+The \\f[CB]KeyStore\\f[R] class defines a static method named\n+\\f[CB]getDefaultType\\f[R] that lets applications retrieve the value of the\n+\\f[CB]keystore.type\\f[R] property.\n@@ -282,1 +272,1 @@\n-type as specified in the \\f[V]keystore.type\\f[R] property:\n+type as specified in the \\f[CB]keystore.type\\f[R] property:\n@@ -285,1 +275,1 @@\n-\\f[V]KeyStore keyStore = KeyStore.getInstance(KeyStore.getDefaultType());\\f[R]\n+\\f[CB]KeyStore\\ keyStore\\ =\\ KeyStore.getInstance(KeyStore.getDefaultType());\\f[R]\n@@ -288,1 +278,1 @@\n-The default keystore type is \\f[V]pkcs12\\f[R], which is a cross platform\n+The default keystore type is \\f[CB]pkcs12\\f[R], which is a cross platform\n@@ -294,1 +284,1 @@\n-\\f[V]keystore.type=pkcs12\\f[R]\n+\\f[CB]keystore.type=pkcs12\\f[R]\n@@ -298,1 +288,1 @@\n-For example, \\f[V]JKS\\f[R] is the same as \\f[V]jks\\f[R].\n+For example, \\f[CB]JKS\\f[R] is the same as \\f[CB]jks\\f[R].\n@@ -302,1 +292,1 @@\n-For example, if you want to use the Oracle\\[aq]s \\f[V]jks\\f[R] keystore\n+For example, if you want to use the Oracle\\[aq]s \\f[CB]jks\\f[R] keystore\n@@ -306,1 +296,1 @@\n-\\f[V]keystore.type=jks\\f[R]\n+\\f[CB]keystore.type=jks\\f[R]\n@@ -310,3 +300,3 @@\n-By default, the \\f[V]jarsigner\\f[R] command signs a JAR file using one\n-of the following algorithms and block file extensions depending on the\n-type and size of the private key:\n+By default, the \\f[CB]jarsigner\\f[R] command signs a JAR file using one of\n+the following algorithms and block file extensions depending on the type\n+and size of the private key:\n@@ -377,1 +367,1 @@\n-RSASSA-PSS\n+RSASSA\\-PSS\n@@ -381,1 +371,1 @@\n-RSASSA-PSS (with SHA-256)\n+RSASSA\\-PSS (with SHA\\-256)\n@@ -389,1 +379,1 @@\n-RSASSA-PSS (with SHA-384)\n+RSASSA\\-PSS (with SHA\\-384)\n@@ -396,1 +386,1 @@\n-RSASSA-PSS (with SHA-512)\n+RSASSA\\-PSS (with SHA\\-512)\n@@ -417,2 +407,2 @@\n-If an RSASSA-PSS key is encoded with parameters, then jarsigner will use\n-the same parameters in the signature.\n+If an RSASSA\\-PSS key is encoded with parameters, then jarsigner will\n+use the same parameters in the signature.\n@@ -421,2 +411,2 @@\n-For example, an 3072-bit RSASSA-PSS key will use RSASSA-PSS as the\n-signature algorithm and SHA-384 as the hash and MGF1 algorithms.\n+For example, an 3072\\-bit RSASSA\\-PSS key will use RSASSA\\-PSS as the\n+signature algorithm and SHA\\-384 as the hash and MGF1 algorithms.\n@@ -425,1 +415,1 @@\n-\\f[V]-sigalg\\f[R] option.\n+\\f[CB]\\-sigalg\\f[R] option.\n@@ -427,3 +417,3 @@\n-The \\f[V]jarsigner\\f[R] command uses the\n-\\f[V]jdk.jar.disabledAlgorithms\\f[R] and\n-\\f[V]jdk.security.legacyAlgorithms\\f[R] security properties to determine\n+The \\f[CB]jarsigner\\f[R] command uses the\n+\\f[CB]jdk.jar.disabledAlgorithms\\f[R] and\n+\\f[CB]jdk.security.legacyAlgorithms\\f[R] security properties to determine\n@@ -437,5 +427,5 @@\n-\\f[V]-J-Djava.security.debug=jar\\f[R].\n-The \\f[V]jdk.jar.disabledAlgorithms\\f[R] and\n-\\f[V]jdk.security.legacyAlgorithms\\f[R] security properties are defined\n-in the \\f[V]java.security\\f[R] file (located in the JDK\\[aq]s\n-\\f[V]$JAVA_HOME\/conf\/security\\f[R] directory).\n+\\f[CB]\\-J\\-Djava.security.debug=jar\\f[R].\n+The \\f[CB]jdk.jar.disabledAlgorithms\\f[R] and\n+\\f[CB]jdk.security.legacyAlgorithms\\f[R] security properties are defined\n+in the \\f[CB]java.security\\f[R] file (located in the JDK\\[aq]s\n+\\f[CB]$JAVA_HOME\/conf\/security\\f[R] directory).\n@@ -450,1 +440,1 @@\n-use the \\f[V]-sigalg\\f[R] option to override the default values at your\n+use the \\f[CB]\\-sigalg\\f[R] option to override the default values at your\n@@ -454,1 +444,1 @@\n-When the \\f[V]jarsigner\\f[R] command is used to sign a JAR file, the\n+When the \\f[CB]jarsigner\\f[R] command is used to sign a JAR file, the\n@@ -456,1 +446,1 @@\n-that it has two additional files placed in the META-INF directory:\n+that it has two additional files placed in the META\\-INF directory:\n@@ -458,1 +448,1 @@\n-A signature file with an \\f[V].SF\\f[R] extension\n+A signature file with an \\f[CB]\\&.SF\\f[R] extension\n@@ -460,2 +450,2 @@\n-A signature block file with a \\f[V].DSA\\f[R], \\f[V].RSA\\f[R], or\n-\\f[V].EC\\f[R] extension\n+A signature block file with a \\f[CB]\\&.DSA\\f[R], \\f[CB]\\&.RSA\\f[R], or\n+\\f[CB]\\&.EC\\f[R] extension\n@@ -464,3 +454,3 @@\n-\\f[V]-sigfile\\f[R] option.\n-For example, when the option is \\f[V]-sigfile MKSIGN\\f[R], the files are\n-named \\f[V]MKSIGN.SF\\f[R] and \\f[V]MKSIGN.RSA\\f[R].\n+\\f[CB]\\-sigfile\\f[R] option.\n+For example, when the option is \\f[CB]\\-sigfile\\ MKSIGN\\f[R], the files\n+are named \\f[CB]MKSIGN.SF\\f[R] and \\f[CB]MKSIGN.RSA\\f[R].\n@@ -469,2 +459,2 @@\n-If no \\f[V]-sigfile\\f[R] option appears on the command line, then the\n-base file name for the \\f[V].SF\\f[R] and the signature block files is\n+If no \\f[CB]\\-sigfile\\f[R] option appears on the command line, then the\n+base file name for the \\f[CB]\\&.SF\\f[R] and the signature block files is\n@@ -481,2 +471,2 @@\n-A signature file (\\f[V].SF\\f[R] file) looks similar to the manifest file\n-that is always included in a JAR file when the \\f[V]jarsigner\\f[R]\n+A signature file (\\f[CB]\\&.SF\\f[R] file) looks similar to the manifest\n+file that is always included in a JAR file when the \\f[CB]jarsigner\\f[R]\n@@ -484,1 +474,1 @@\n-For each source file included in the JAR file, the \\f[V].SF\\f[R] file\n+For each source file included in the JAR file, the \\f[CB]\\&.SF\\f[R] file\n@@ -500,1 +490,1 @@\n-In the \\f[V].SF\\f[R] file, the digest value for a specified source file\n+In the \\f[CB]\\&.SF\\f[R] file, the digest value for a specified source file\n@@ -510,1 +500,1 @@\n-The \\f[V].SF\\f[R] file is signed and the signature is placed in the\n+The \\f[CB]\\&.SF\\f[R] file is signed and the signature is placed in the\n@@ -515,2 +505,2 @@\n-The file has the extension \\f[V].DSA\\f[R], \\f[V].RSA\\f[R], or\n-\\f[V].EC\\f[R], depending on the key algorithm used.\n+The file has the extension \\f[CB]\\&.DSA\\f[R], \\f[CB]\\&.RSA\\f[R], or\n+\\f[CB]\\&.EC\\f[R], depending on the key algorithm used.\n@@ -520,2 +510,2 @@\n-The \\f[V]jarsigner\\f[R] command used with the following options\n-generates and stores a signature time stamp when signing a JAR file:\n+The \\f[CB]jarsigner\\f[R] command used with the following options generates\n+and stores a signature time stamp when signing a JAR file:\n@@ -523,1 +513,1 @@\n-\\f[V]-tsa\\f[R] \\f[I]url\\f[R]\n+\\f[CB]\\-tsa\\f[R] \\f[I]url\\f[R]\n@@ -525,1 +515,1 @@\n-\\f[V]-tsacert\\f[R] \\f[I]alias\\f[R]\n+\\f[CB]\\-tsacert\\f[R] \\f[I]alias\\f[R]\n@@ -527,1 +517,1 @@\n-\\f[V]-tsapolicyid\\f[R] \\f[I]policyid\\f[R]\n+\\f[CB]\\-tsapolicyid\\f[R] \\f[I]policyid\\f[R]\n@@ -529,1 +519,1 @@\n-\\f[V]-tsadigestalg\\f[R] \\f[I]algorithm\\f[R]\n+\\f[CB]\\-tsadigestalg\\f[R] \\f[I]algorithm\\f[R]\n@@ -539,1 +529,1 @@\n-Verify the signature of the \\f[V].SF\\f[R] file.\n+Verify the signature of the \\f[CB]\\&.SF\\f[R] file.\n@@ -547,2 +537,2 @@\n-corresponding signature (\\f[V].SF\\f[R]) file, and thus the \\f[V].SF\\f[R]\n-file wasn\\[aq]t tampered with.\n+corresponding signature (\\f[CB]\\&.SF\\f[R]) file, and thus the\n+\\f[CB]\\&.SF\\f[R] file wasn\\[aq]t tampered with.\n@@ -551,1 +541,1 @@\n-Verify the digest listed in each entry in the \\f[V].SF\\f[R] file with\n+Verify the digest listed in each entry in the \\f[CB]\\&.SF\\f[R] file with\n@@ -555,2 +545,2 @@\n-The \\f[V].SF\\f[R] file by default includes a header that contains a hash\n-of the entire manifest file.\n+The \\f[CB]\\&.SF\\f[R] file by default includes a header that contains a\n+hash of the entire manifest file.\n@@ -563,1 +553,1 @@\n-\\f[V].SF\\f[R] file equals the hash of its corresponding section in the\n+\\f[CB]\\&.SF\\f[R] file equals the hash of its corresponding section in the\n@@ -568,1 +558,1 @@\n-\\f[V].SF\\f[R] file header might not equal the hash of the current\n+\\f[CB]\\&.SF\\f[R] file header might not equal the hash of the current\n@@ -572,2 +562,2 @@\n-(using the \\f[V]jar\\f[R] tool) that already contains a signature and a\n-\\f[V].SF\\f[R] file.\n+(using the \\f[CB]jar\\f[R] tool) that already contains a signature and a\n+\\f[CB]\\&.SF\\f[R] file.\n@@ -576,2 +566,2 @@\n-\\f[V]jarsigner\\f[R] tool) and a new \\f[V].SF\\f[R] file is created, but\n-the original \\f[V].SF\\f[R] file is unchanged.\n+\\f[CB]jarsigner\\f[R] tool) and a new \\f[CB]\\&.SF\\f[R] file is created, but\n+the original \\f[CB]\\&.SF\\f[R] file is unchanged.\n@@ -581,3 +571,3 @@\n-This is because the hashes in the non-header sections of the\n-\\f[V].SF\\f[R] file equal the hashes of the corresponding sections in the\n-manifest file.\n+This is because the hashes in the non\\-header sections of the\n+\\f[CB]\\&.SF\\f[R] file equal the hashes of the corresponding sections in\n+the manifest file.\n@@ -586,1 +576,1 @@\n-Read each file in the JAR file that has an entry in the \\f[V].SF\\f[R]\n+Read each file in the JAR file that has an entry in the \\f[CB]\\&.SF\\f[R]\n@@ -595,1 +585,1 @@\n-The \\f[V]jarsigner\\f[R] command catches and displays the exception.\n+The \\f[CB]jarsigner\\f[R] command catches and displays the exception.\n@@ -604,2 +594,2 @@\n-\\f[V]-strict\\f[R] option), as well as the content of the certificate (by\n-specifying the \\f[V]-verbose\\f[R] and \\f[V]-certs\\f[R] options) to\n+\\f[CB]\\-strict\\f[R] option), as well as the content of the certificate (by\n+specifying the \\f[CB]\\-verbose\\f[R] and \\f[CB]\\-certs\\f[R] options) to\n@@ -610,2 +600,2 @@\n-\\f[V]jarsigner\\f[R] command on the file multiple times and specifying\n-the alias for a different person each time, as follows:\n+\\f[CB]jarsigner\\f[R] command on the file multiple times and specifying the\n+alias for a different person each time, as follows:\n@@ -615,2 +605,2 @@\n-jarsigner myBundle.jar susan\n-jarsigner myBundle.jar kevin\n+jarsigner\\ myBundle.jar\\ susan\n+jarsigner\\ myBundle.jar\\ kevin\n@@ -621,1 +611,1 @@\n-\\f[V].SF\\f[R] and signature block files in the resulting JAR file, one\n+\\f[CB]\\&.SF\\f[R] and signature block files in the resulting JAR file, one\n@@ -636,1 +626,1 @@\n-The following sections describe the options for the \\f[V]jarsigner\\f[R].\n+The following sections describe the options for the \\f[CB]jarsigner\\f[R].\n@@ -639,1 +629,1 @@\n-All option names are preceded by a hyphen sign (-).\n+All option names are preceded by a hyphen sign (\\-).\n@@ -646,3 +636,3 @@\n-The \\f[V]-storepass\\f[R], \\f[V]-keypass\\f[R], \\f[V]-sigfile\\f[R],\n-\\f[V]-sigalg\\f[R], \\f[V]-digestalg\\f[R], \\f[V]-signedjar\\f[R], and\n-TSA-related options are only relevant when signing a JAR file; they\n+The \\f[CB]\\-storepass\\f[R], \\f[CB]\\-keypass\\f[R], \\f[CB]\\-sigfile\\f[R],\n+\\f[CB]\\-sigalg\\f[R], \\f[CB]\\-digestalg\\f[R], \\f[CB]\\-signedjar\\f[R], and\n+TSA\\-related options are only relevant when signing a JAR file; they\n@@ -650,1 +640,1 @@\n-The \\f[V]-keystore\\f[R] option is relevant for signing and verifying a\n+The \\f[CB]\\-keystore\\f[R] option is relevant for signing and verifying a\n@@ -655,1 +645,1 @@\n-\\f[V]-keystore\\f[R] \\f[I]url\\f[R]\n+.B \\f[CB]\\-keystore\\f[R] \\f[I]url\\f[R]\n@@ -657,2 +647,2 @@\n-This defaults to the file \\f[V].keystore\\f[R] in the user\\[aq]s home\n-directory, as determined by the \\f[V]user.home\\f[R] system property.\n+This defaults to the file \\f[CB]\\&.keystore\\f[R] in the user\\[aq]s home\n+directory, as determined by the \\f[CB]user.home\\f[R] system property.\n@@ -666,1 +656,1 @@\n-the default exists and the \\f[V]-verbose\\f[R] option was also specified,\n+the default exists and the \\f[CB]\\-verbose\\f[R] option was also specified,\n@@ -671,1 +661,1 @@\n-The \\f[V]-keystore\\f[R] argument can be a file name and path\n+The \\f[CB]\\-keystore\\f[R] argument can be a file name and path\n@@ -675,1 +665,1 @@\n-\\f[V]-keystore\\f[R] \\f[I]filePathAndName\\f[R]\n+\\f[CB]\\-keystore\\f[R] \\f[I]filePathAndName\\f[R]\n@@ -677,1 +667,1 @@\n-\\f[V]-keystore file:\\f[R]\\f[I]filePathAndName\\f[R]\n+\\f[CB]\\-keystore\\ file:\\f[R]\\f[I]filePathAndName\\f[R]\n@@ -680,3 +670,3 @@\n-\\f[V]java.security\\f[R] security properties file (located in the\n-JDK\\[aq]s \\f[V]$JAVA_HOME\/conf\/security\\f[R] directory), then the\n-\\f[V]keytool\\f[R] and \\f[V]jarsigner\\f[R] tools can operate on the PKCS\n+\\f[CB]java.security\\f[R] security properties file (located in the\n+JDK\\[aq]s \\f[CB]$JAVA_HOME\/conf\/security\\f[R] directory), then the\n+\\f[CB]keytool\\f[R] and \\f[CB]jarsigner\\f[R] tools can operate on the PKCS\n@@ -686,1 +676,1 @@\n-\\f[V]-keystore NONE -storetype PKCS11\\f[R]\n+\\f[CB]\\-keystore\\ NONE\\ \\-storetype\\ PKCS11\\f[R]\n@@ -693,1 +683,1 @@\n-\\f[V]keytool -keystore NONE -storetype PKCS11 -list\\f[R]\n+\\f[CB]keytool\\ \\-keystore\\ NONE\\ \\-storetype\\ PKCS11\\ \\-list\\f[R]\n@@ -697,1 +687,1 @@\n-\\f[V]-storepass\\f[R] [\\f[V]:env\\f[R] | \\f[V]:file\\f[R]] \\f[I]argument\\f[R]\n+.B \\f[CB]\\-storepass\\f[R] [\\f[CB]:env\\f[R] | \\f[CB]:file\\f[R]] \\f[I]argument\\f[R]\n@@ -700,1 +690,1 @@\n-In that case, if a \\f[V]-storepass\\f[R] option isn\\[aq]t provided at the\n+In that case, if a \\f[CB]\\-storepass\\f[R] option isn\\[aq]t provided at the\n@@ -704,2 +694,2 @@\n-If the modifier \\f[V]env\\f[R] or \\f[V]file\\f[R] isn\\[aq]t specified,\n-then the password has the value \\f[V]argument\\f[R].\n+If the modifier \\f[CB]env\\f[R] or \\f[CB]file\\f[R] isn\\[aq]t specified, then\n+the password has the value \\f[CB]argument\\f[R].\n@@ -708,1 +698,1 @@\n-\\f[V]env\\f[R]: Retrieve the password from the environment variable named\n+\\f[CB]env\\f[R]: Retrieve the password from the environment variable named\n@@ -711,1 +701,1 @@\n-\\f[V]file\\f[R]: Retrieve the password from the file named\n+\\f[CB]file\\f[R]: Retrieve the password from the file named\n@@ -720,1 +710,1 @@\n-\\f[V]-storetype\\f[R] \\f[I]storetype\\f[R]\n+.B \\f[CB]\\-storetype\\f[R] \\f[I]storetype\\f[R]\n@@ -723,3 +713,3 @@\n-the \\f[V]keystore.type\\f[R] property in the security properties file,\n-which is returned by the static \\f[V]getDefaultType\\f[R] method in\n-\\f[V]java.security.KeyStore\\f[R].\n+the \\f[CB]keystore.type\\f[R] property in the security properties file,\n+which is returned by the static \\f[CB]getDefaultType\\f[R] method in\n+\\f[CB]java.security.KeyStore\\f[R].\n@@ -729,2 +719,2 @@\n-\\f[V]-storepass\\f[R] option.\n-If none is specified, then the \\f[V]keytool\\f[R] and \\f[V]jarsigner\\f[R]\n+\\f[CB]\\-storepass\\f[R] option.\n+If none is specified, then the \\f[CB]keytool\\f[R] and \\f[CB]jarsigner\\f[R]\n@@ -733,1 +723,1 @@\n-PIN-pad or a biometric reader), then the \\f[V]-protected\\f[R] option\n+PIN\\-pad or a biometric reader), then the \\f[CB]\\-protected\\f[R] option\n@@ -737,1 +727,1 @@\n-\\f[V]-keypass\\f[R] [\\f[V]:env\\f[R] | \\f[V]:file\\f[R]] \\f[I]argument\\f[R] \\f[V]-certchain\\f[R] \\f[I]file\\f[R]\n+.B \\f[CB]\\-keypass\\f[R] [\\f[CB]:env\\f[R] | \\f[CB]:file\\f[R]] \\f[I]argument\\f[R] \\f[CB]\\-certchain\\f[R] \\f[I]file\\f[R]\n@@ -740,1 +730,1 @@\n-The password is required when using \\f[V]jarsigner\\f[R] to sign a JAR\n+The password is required when using \\f[CB]jarsigner\\f[R] to sign a JAR\n@@ -747,2 +737,2 @@\n-If the modifier \\f[V]env\\f[R] or \\f[V]file\\f[R] isn\\[aq]t specified,\n-then the password has the value \\f[V]argument\\f[R].\n+If the modifier \\f[CB]env\\f[R] or \\f[CB]file\\f[R] isn\\[aq]t specified, then\n+the password has the value \\f[CB]argument\\f[R].\n@@ -751,1 +741,1 @@\n-\\f[V]env\\f[R]: Retrieve the password from the environment variable named\n+\\f[CB]env\\f[R]: Retrieve the password from the environment variable named\n@@ -754,1 +744,1 @@\n-\\f[V]file\\f[R]: Retrieve the password from the file named\n+\\f[CB]file\\f[R]: Retrieve the password from the file named\n@@ -763,1 +753,1 @@\n-\\f[V]-certchain\\f[R] \\f[I]file\\f[R]\n+.B \\f[CB]\\-certchain\\f[R] \\f[I]file\\f[R]\n@@ -774,0 +764,2 @@\n+.RS\n+.RE\n@@ -775,2 +767,2 @@\n-\\f[V]-sigfile\\f[R] \\f[I]file\\f[R]\n-Specifies the base file name to be used for the generated \\f[V].SF\\f[R]\n+.B \\f[CB]\\-sigfile\\f[R] \\f[I]file\\f[R]\n+Specifies the base file name to be used for the generated \\f[CB]\\&.SF\\f[R]\n@@ -778,3 +770,3 @@\n-For example, if file is \\f[V]DUKESIGN\\f[R], then the generated\n-\\f[V].SF\\f[R] and signature block files are named \\f[V]DUKESIGN.SF\\f[R]\n-and \\f[V]DUKESIGN.RSA\\f[R], and placed in the \\f[V]META-INF\\f[R]\n+For example, if file is \\f[CB]DUKESIGN\\f[R], then the generated\n+\\f[CB]\\&.SF\\f[R] and signature block files are named \\f[CB]DUKESIGN.SF\\f[R]\n+and \\f[CB]DUKESIGN.RSA\\f[R], and placed in the \\f[CB]META\\-INF\\f[R]\n@@ -784,1 +776,2 @@\n-The characters in the file must come from the set \\f[V]a-zA-Z0-9_-\\f[R].\n+The characters in the file must come from the set\n+\\f[CB]a\\-zA\\-Z0\\-9_\\-\\f[R].\n@@ -787,1 +780,1 @@\n-\\f[V].SF\\f[R] and signature block file names.\n+\\f[CB]\\&.SF\\f[R] and signature block file names.\n@@ -789,2 +782,2 @@\n-If no \\f[V]-sigfile\\f[R] option appears on the command line, then the\n-base file name for the \\f[V].SF\\f[R] and signature block files is the\n+If no \\f[CB]\\-sigfile\\f[R] option appears on the command line, then the\n+base file name for the \\f[CB]\\&.SF\\f[R] and signature block files is the\n@@ -800,1 +793,1 @@\n-\\f[V]-signedjar\\f[R] \\f[I]file\\f[R]\n+.B \\f[CB]\\-signedjar\\f[R] \\f[I]file\\f[R]\n@@ -802,0 +795,2 @@\n+.RS\n+.RE\n@@ -803,1 +798,1 @@\n-\\f[V]-digestalg\\f[R] \\f[I]algorithm\\f[R]\n+.B \\f[CB]\\-digestalg\\f[R] \\f[I]algorithm\\f[R]\n@@ -811,1 +806,1 @@\n-If this option isn\\[aq]t specified, then \\f[V]SHA-384\\f[R] is used.\n+If this option isn\\[aq]t specified, then \\f[CB]SHA\\-384\\f[R] is used.\n@@ -814,1 +809,1 @@\n-with the \\f[V]-addprovider\\f[R] or \\f[V]-providerClass\\f[R] options;\n+with the \\f[CB]\\-addprovider\\f[R] or \\f[CB]\\-providerClass\\f[R] options;\n@@ -818,1 +813,1 @@\n-\\f[V]-sigalg\\f[R] \\f[I]algorithm\\f[R]\n+.B \\f[CB]\\-sigalg\\f[R] \\f[I]algorithm\\f[R]\n@@ -830,1 +825,1 @@\n-the \\f[V]-addprovider\\f[R] or \\f[V]-providerClass\\f[R] option;\n+the \\f[CB]\\-addprovider\\f[R] or \\f[CB]\\-providerClass\\f[R] option;\n@@ -837,1 +832,1 @@\n-\\f[V]-verify\\f[R]\n+.B \\f[CB]\\-verify\\f[R]\n@@ -839,0 +834,2 @@\n+.RS\n+.RE\n@@ -840,3 +837,3 @@\n-\\f[V]-verbose\\f[R][\\f[V]:\\f[R]\\f[I]suboptions\\f[R]]\n-When the \\f[V]-verbose\\f[R] option appears on the command line, it\n-indicates that the \\f[V]jarsigner\\f[R] use the verbose mode when signing\n+.B \\f[CB]\\-verbose\\f[R][\\f[CB]:\\f[R]\\f[I]suboptions\\f[R]]\n+When the \\f[CB]\\-verbose\\f[R] option appears on the command line, it\n+indicates that the \\f[CB]jarsigner\\f[R] use the verbose mode when signing\n@@ -845,1 +842,1 @@\n-This causes the , which causes \\f[V]jarsigner\\f[R] to output extra\n+This causes the , which causes \\f[CB]jarsigner\\f[R] to output extra\n@@ -847,2 +844,2 @@\n-The \\f[I]suboptions\\f[R] can be \\f[V]all\\f[R], \\f[V]grouped\\f[R], or\n-\\f[V]summary\\f[R].\n+The \\f[I]suboptions\\f[R] can be \\f[CB]all\\f[R], \\f[CB]grouped\\f[R], or\n+\\f[CB]summary\\f[R].\n@@ -851,2 +848,2 @@\n-If the \\f[V]-certs\\f[R] option is also specified, then the default mode\n-(or suboption \\f[V]all\\f[R]) displays each entry as it is being\n+If the \\f[CB]\\-certs\\f[R] option is also specified, then the default mode\n+(or suboption \\f[CB]all\\f[R]) displays each entry as it is being\n@@ -856,1 +853,1 @@\n-If the \\f[V]-certs\\f[R] and the \\f[V]-verbose:grouped\\f[R] suboptions\n+If the \\f[CB]\\-certs\\f[R] and the \\f[CB]\\-verbose:grouped\\f[R] suboptions\n@@ -860,1 +857,1 @@\n-If \\f[V]-certs\\f[R] and the \\f[V]-verbose:summary\\f[R] suboptions are\n+If \\f[CB]\\-certs\\f[R] and the \\f[CB]\\-verbose:summary\\f[R] suboptions are\n@@ -870,3 +867,3 @@\n-\\f[V]-certs\\f[R]\n-If the \\f[V]-certs\\f[R] option appears on the command line with the\n-\\f[V]-verify\\f[R] and \\f[V]-verbose\\f[R] options, then the output\n+.B \\f[CB]\\-certs\\f[R]\n+If the \\f[CB]\\-certs\\f[R] option appears on the command line with the\n+\\f[CB]\\-verify\\f[R] and \\f[CB]\\-verbose\\f[R] options, then the output\n@@ -877,1 +874,1 @@\n-\\f[V]java.security.cert.X509Certificate\\f[R]), then the distinguished\n+\\f[CB]java.security.cert.X509Certificate\\f[R]), then the distinguished\n@@ -889,1 +886,1 @@\n-\\f[V]-revCheck\\f[R]\n+.B \\f[CB]\\-revCheck\\f[R]\n@@ -892,2 +889,2 @@\n-The \\f[V]jarsigner\\f[R] command attempts to make network connections to\n-fetch OCSP responses and CRLs if the \\f[V]-revCheck\\f[R] option is\n+The \\f[CB]jarsigner\\f[R] command attempts to make network connections to\n+fetch OCSP responses and CRLs if the \\f[CB]\\-revCheck\\f[R] option is\n@@ -897,0 +894,2 @@\n+.RS\n+.RE\n@@ -898,2 +897,2 @@\n-\\f[V]-tsa\\f[R] \\f[I]url\\f[R]\n-If \\f[V]-tsa http:\/\/example.tsa.url\\f[R] appears on the command line\n+.B \\f[CB]\\-tsa\\f[R] \\f[I]url\\f[R]\n+If \\f[CB]\\-tsa\\ http:\/\/example.tsa.url\\f[R] appears on the command line\n@@ -902,4 +901,4 @@\n-The URL, \\f[V]http:\/\/example.tsa.url\\f[R], identifies the location of\n-the Time Stamping Authority (TSA) and overrides any URL found with the\n-\\f[V]-tsacert\\f[R] option.\n-The \\f[V]-tsa\\f[R] option doesn\\[aq]t require the TSA public key\n+The URL, \\f[CB]http:\/\/example.tsa.url\\f[R], identifies the location of the\n+Time Stamping Authority (TSA) and overrides any URL found with the\n+\\f[CB]\\-tsacert\\f[R] option.\n+The \\f[CB]\\-tsa\\f[R] option doesn\\[aq]t require the TSA public key\n@@ -909,2 +908,2 @@\n-To generate the time stamp, \\f[V]jarsigner\\f[R] communicates with the\n-TSA with the Time-Stamp Protocol (TSP) defined in RFC 3161.\n+To generate the time stamp, \\f[CB]jarsigner\\f[R] communicates with the TSA\n+with the Time\\-Stamp Protocol (TSP) defined in RFC 3161.\n@@ -915,2 +914,2 @@\n-\\f[V]-tsacert\\f[R] \\f[I]alias\\f[R]\n-When \\f[V]-tsacert\\f[R] \\f[I]alias\\f[R] appears on the command line when\n+.B \\f[CB]\\-tsacert\\f[R] \\f[I]alias\\f[R]\n+When \\f[CB]\\-tsacert\\f[R] \\f[I]alias\\f[R] appears on the command line when\n@@ -925,1 +924,1 @@\n-using the \\f[V]-tsacert\\f[R] option.\n+using the \\f[CB]\\-tsacert\\f[R] option.\n@@ -928,1 +927,1 @@\n-\\f[V]-tsapolicyid\\f[R] \\f[I]policyid\\f[R]\n+.B \\f[CB]\\-tsapolicyid\\f[R] \\f[I]policyid\\f[R]\n@@ -936,3 +935,3 @@\n-Telecommunication Standardization Sector (ITU-T) standard.\n-These identifiers are typically period-separated sets of non-negative\n-digits like \\f[V]1.2.3.4\\f[R], for example.\n+Telecommunication Standardization Sector (ITU\\-T) standard.\n+These identifiers are typically period\\-separated sets of non\\-negative\n+digits like \\f[CB]1.2.3.4\\f[R], for example.\n@@ -941,1 +940,1 @@\n-\\f[V]-tsadigestalg\\f[R] \\f[I]algorithm\\f[R]\n+.B \\f[CB]\\-tsadigestalg\\f[R] \\f[I]algorithm\\f[R]\n@@ -944,1 +943,1 @@\n-If this option isn\\[aq]t specified, SHA-384 will be used.\n+If this option isn\\[aq]t specified, SHA\\-384 will be used.\n@@ -953,1 +952,1 @@\n-\\f[V]-internalsf\\f[R]\n+.B \\f[CB]\\-internalsf\\f[R]\n@@ -955,1 +954,1 @@\n-signed included a complete encoded copy of the \\f[V].SF\\f[R] file\n+signed included a complete encoded copy of the \\f[CB]\\&.SF\\f[R] file\n@@ -959,1 +958,1 @@\n-file by default doesn\\[aq]t contain a copy of the \\f[V].SF\\f[R] file\n+file by default doesn\\[aq]t contain a copy of the \\f[CB]\\&.SF\\f[R] file\n@@ -961,1 +960,1 @@\n-If \\f[V]-internalsf\\f[R] appears on the command line, then the old\n+If \\f[CB]\\-internalsf\\f[R] appears on the command line, then the old\n@@ -964,1 +963,1 @@\n-In practice, don\\[aq]t use the \\f[V]-internalsf\\f[R] option because it\n+In practice, don\\[aq]t use the \\f[CB]\\-internalsf\\f[R] option because it\n@@ -966,0 +965,2 @@\n+.RS\n+.RE\n@@ -967,3 +968,3 @@\n-\\f[V]-sectionsonly\\f[R]\n-If the \\f[V]-sectionsonly\\f[R] option appears on the command line, then\n-the \\f[V].SF\\f[R] file (signature file) generated when a JAR file is\n+.B \\f[CB]\\-sectionsonly\\f[R]\n+If the \\f[CB]\\-sectionsonly\\f[R] option appears on the command line, then\n+the \\f[CB]\\&.SF\\f[R] file (signature file) generated when a JAR file is\n@@ -984,1 +985,1 @@\n-the \\f[V].SF\\f[R] file equals the hash of its corresponding section in\n+the \\f[CB]\\&.SF\\f[R] file equals the hash of its corresponding section in\n@@ -988,1 +989,1 @@\n-The \\f[V]-sectionsonly\\f[R] option is primarily used for testing.\n+The \\f[CB]\\-sectionsonly\\f[R] option is primarily used for testing.\n@@ -993,3 +994,3 @@\n-\\f[V]-protected\\f[R]\n-Values can be either \\f[V]true\\f[R] or \\f[V]false\\f[R].\n-Specify \\f[V]true\\f[R] when a password must be specified through a\n+.B \\f[CB]\\-protected\\f[R]\n+Values can be either \\f[CB]true\\f[R] or \\f[CB]false\\f[R].\n+Specify \\f[CB]true\\f[R] when a password must be specified through a\n@@ -997,0 +998,2 @@\n+.RS\n+.RE\n@@ -998,3 +1001,3 @@\n-\\f[V]-providerName\\f[R] \\f[I]providerName\\f[R]\n-If more than one provider was configured in the \\f[V]java.security\\f[R]\n-security properties file, then you can use the \\f[V]-providerName\\f[R]\n+.B \\f[CB]\\-providerName\\f[R] \\f[I]providerName\\f[R]\n+If more than one provider was configured in the \\f[CB]java.security\\f[R]\n+security properties file, then you can use the \\f[CB]\\-providerName\\f[R]\n@@ -1006,2 +1009,2 @@\n-\\f[V]SunPKCS11-\\f[R]\\f[I]TokenName\\f[R], where \\f[I]TokenName\\f[R] is\n-the name suffix that the provider instance has been configured with, as\n+\\f[CB]SunPKCS11\\-\\f[R]\\f[I]TokenName\\f[R], where \\f[I]TokenName\\f[R] is the\n+name suffix that the provider instance has been configured with, as\n@@ -1010,2 +1013,2 @@\n-\\f[V]PKCS #11\\f[R] keystore provider instance with name suffix\n-\\f[V]SmartCard\\f[R]:\n+\\f[CB]PKCS\\ #11\\f[R] keystore provider instance with name suffix\n+\\f[CB]SmartCard\\f[R]:\n@@ -1014,1 +1017,1 @@\n-\\f[V]jarsigner -keystore NONE -storetype PKCS11 -providerName SunPKCS11-SmartCard -list\\f[R]\n+\\f[CB]jarsigner\\ \\-keystore\\ NONE\\ \\-storetype\\ PKCS11\\ \\-providerName\\ SunPKCS11\\-SmartCard\\ \\-list\\f[R]\n@@ -1018,1 +1021,1 @@\n-\\f[V]-addprovider\\f[R] \\f[I]name\\f[R] [\\f[V]-providerArg\\f[R] \\f[I]arg\\f[R]]\n+.B \\f[CB]\\-addprovider\\f[R] \\f[I]name\\f[R] [\\f[CB]\\-providerArg\\f[R] \\f[I]arg\\f[R]]\n@@ -1025,3 +1028,3 @@\n-Used with the \\f[V]-providerArg ConfigFilePath\\f[R] option, the\n-\\f[V]keytool\\f[R] and \\f[V]jarsigner\\f[R] tools install the provider\n-dynamically and use \\f[V]ConfigFilePath\\f[R] for the path to the token\n+Used with the \\f[CB]\\-providerArg\\ ConfigFilePath\\f[R] option, the\n+\\f[CB]keytool\\f[R] and \\f[CB]jarsigner\\f[R] tools install the provider\n+dynamically and use \\f[CB]ConfigFilePath\\f[R] for the path to the token\n@@ -1029,1 +1032,1 @@\n-The following example shows a command to list a \\f[V]PKCS #11\\f[R]\n+The following example shows a command to list a \\f[CB]PKCS\\ #11\\f[R]\n@@ -1034,1 +1037,1 @@\n-\\f[V]jarsigner -keystore NONE -storetype PKCS11 -addprovider SunPKCS11 -providerArg \/mydir1\/mydir2\/token.config\\f[R]\n+\\f[CB]jarsigner\\ \\-keystore\\ NONE\\ \\-storetype\\ PKCS11\\ \\-addprovider\\ SunPKCS11\\ \\-providerArg\\ \/mydir1\/mydir2\/token.config\\f[R]\n@@ -1038,1 +1041,1 @@\n-\\f[V]-providerClass\\f[R] \\f[I]provider-class-name\\f[R] [\\f[V]-providerArg\\f[R] \\f[I]arg\\f[R]]\n+.B \\f[CB]\\-providerClass\\f[R] \\f[I]provider\\-class\\-name\\f[R] [\\f[CB]\\-providerArg\\f[R] \\f[I]arg\\f[R]]\n@@ -1041,2 +1044,2 @@\n-\\f[V]java.security\\f[R] security properties file.\n-Adds a security provider by fully-qualified class name and an optional\n+\\f[CB]java.security\\f[R] security properties file.\n+Adds a security provider by fully\\-qualified class name and an optional\n@@ -1049,1 +1052,1 @@\n-See \\f[V]-addprovider\\f[R].\n+See \\f[CB]\\-addprovider\\f[R].\n@@ -1052,1 +1055,1 @@\n-\\f[V]-providerPath\\f[R] \\f[I]classpath\\f[R]\n+.B \\f[CB]\\-providerPath\\f[R] \\f[I]classpath\\f[R]\n@@ -1054,3 +1057,5 @@\n-\\f[V]-providerClass\\f[R] option.\n-Multiple paths should be separated by the system-dependent\n-path-separator character.\n+\\f[CB]\\-providerClass\\f[R] option.\n+Multiple paths should be separated by the system\\-dependent\n+path\\-separator character.\n+.RS\n+.RE\n@@ -1058,1 +1063,1 @@\n-\\f[V]-J\\f[R]\\f[I]javaoption\\f[R]\n+.B \\f[CB]\\-J\\f[R]\\f[I]javaoption\\f[R]\n@@ -1061,1 +1066,1 @@\n-The \\f[V]jarsigner\\f[R] command is a wrapper around the interpreter.\n+The \\f[CB]jarsigner\\f[R] command is a wrapper around the interpreter.\n@@ -1064,2 +1069,4 @@\n-For a list of possible interpreter options, type \\f[V]java -h\\f[R] or\n-\\f[V]java -X\\f[R] at the command line.\n+For a list of possible interpreter options, type \\f[CB]java\\ \\-h\\f[R] or\n+\\f[CB]java\\ \\-X\\f[R] at the command line.\n+.RS\n+.RE\n@@ -1067,1 +1074,1 @@\n-\\f[V]-strict\\f[R]\n+.B \\f[CB]\\-strict\\f[R]\n@@ -1073,0 +1080,2 @@\n+.RS\n+.RE\n@@ -1074,2 +1083,2 @@\n-\\f[V]-conf\\f[R] \\f[I]url\\f[R]\n-Specifies a pre-configured options file.\n+.B \\f[CB]\\-conf\\f[R] \\f[I]url\\f[R]\n+Specifies a pre\\-configured options file.\n@@ -1077,4 +1086,3 @@\n-The property keys supported are \\[dq]jarsigner.all\\[dq] for all actions,\n-\\[dq]jarsigner.sign\\[dq] for signing, and \\[dq]jarsigner.verify\\[dq] for\n-verification.\n-\\f[V]jarsigner\\f[R] arguments including the JAR file name and alias\n+The property keys supported are \"jarsigner.all\" for all actions,\n+\"jarsigner.sign\" for signing, and \"jarsigner.verify\" for verification.\n+\\f[CB]jarsigner\\f[R] arguments including the JAR file name and alias\n@@ -1082,0 +1090,2 @@\n+.RS\n+.RE\n@@ -1083,1 +1093,1 @@\n-\\f[V]-version\\f[R]\n+.B \\f[CB]\\-version\\f[R]\n@@ -1085,0 +1095,2 @@\n+.RS\n+.RE\n@@ -1087,1 +1099,1 @@\n-The following \\f[V]jarsigner\\f[R] options are deprecated as of JDK 9 and\n+The following \\f[CB]jarsigner\\f[R] options are deprecated as of JDK 9 and\n@@ -1090,1 +1102,1 @@\n-\\f[V]-altsigner\\f[R] \\f[I]class\\f[R]\n+.B \\f[CB]\\-altsigner\\f[R] \\f[I]class\\f[R]\n@@ -1093,2 +1105,2 @@\n-\\f[V]com.sun.jarsigner.ContentSigner\\f[R] abstract class.\n-The path to this class file is defined by the \\f[V]-altsignerpath\\f[R]\n+\\f[CB]com.sun.jarsigner.ContentSigner\\f[R] abstract class.\n+The path to this class file is defined by the \\f[CB]\\-altsignerpath\\f[R]\n@@ -1096,1 +1108,1 @@\n-If the \\f[V]-altsigner\\f[R] option is used, then the \\f[V]jarsigner\\f[R]\n+If the \\f[CB]\\-altsigner\\f[R] option is used, then the \\f[CB]jarsigner\\f[R]\n@@ -1098,1 +1110,1 @@\n-Otherwise, the \\f[V]jarsigner\\f[R] command uses its default signing\n+Otherwise, the \\f[CB]jarsigner\\f[R] command uses its default signing\n@@ -1103,2 +1115,2 @@\n-\\f[V]com.sun.sun.jarsigner.AuthSigner\\f[R], use the \\f[V]jarsigner\\f[R]\n-option \\f[V]-altsigner com.sun.jarsigner.AuthSigner\\f[R].\n+\\f[CB]com.sun.sun.jarsigner.AuthSigner\\f[R], use the \\f[CB]jarsigner\\f[R]\n+option \\f[CB]\\-altsigner\\ com.sun.jarsigner.AuthSigner\\f[R].\n@@ -1107,1 +1119,1 @@\n-\\f[V]-altsignerpath\\f[R] \\f[I]classpathlist\\f[R]\n+.B \\f[CB]\\-altsignerpath\\f[R] \\f[I]classpathlist\\f[R]\n@@ -1109,1 +1121,1 @@\n-The class file name is specified with the \\f[V]-altsigner\\f[R] option.\n+The class file name is specified with the \\f[CB]\\-altsigner\\f[R] option.\n@@ -1119,1 +1131,1 @@\n-Colon (\\f[V]:\\f[R]) on Linux and macOS\n+Colon (\\f[CB]:\\f[R]) on Linux and macOS\n@@ -1121,1 +1133,1 @@\n-Semicolon (\\f[V];\\f[R]) on Windows\n+Semicolon (\\f[CB];\\f[R]) on Windows\n@@ -1131,1 +1143,1 @@\n-\\f[V]-altsignerpath \/home\/user\/lib\/authsigner.jar\\f[R]\n+\\f[CB]\\-altsignerpath\\ \/home\/user\/lib\/authsigner.jar\\f[R]\n@@ -1139,1 +1151,1 @@\n-\\f[V]-altsignerpath \/home\/user\/classes\/com\/sun\/tools\/jarsigner\/\\f[R]\n+\\f[CB]\\-altsignerpath\\ \/home\/user\/classes\/com\/sun\/tools\/jarsigner\/\\f[R]\n@@ -1144,1 +1156,1 @@\n-During the signing or verifying process, the \\f[V]jarsigner\\f[R] command\n+During the signing or verifying process, the \\f[CB]jarsigner\\f[R] command\n@@ -1147,2 +1159,1 @@\n-If there is a failure, the \\f[V]jarsigner\\f[R] command exits with code\n-1.\n+If there is a failure, the \\f[CB]jarsigner\\f[R] command exits with code 1.\n@@ -1150,3 +1161,3 @@\n-\\f[V]jarsigner\\f[R] command exits with code 0 when the \\f[V]-strict\\f[R]\n-option is \\f[B]not\\f[R] specified, or exits with the OR-value of the\n-warning codes when the \\f[V]-strict\\f[R] is specified.\n+\\f[CB]jarsigner\\f[R] command exits with code 0 when the \\f[CB]\\-strict\\f[R]\n+option is \\f[B]not\\f[R] specified, or exits with the OR\\-value of the\n+warning codes when the \\f[CB]\\-strict\\f[R] is specified.\n@@ -1158,2 +1169,2 @@\n-\\f[V]jarsigner\\f[R] command exits with code 12 (=4+8) when the\n-\\f[V]-strict\\f[R] option is specified.\n+\\f[CB]jarsigner\\f[R] command exits with code 12 (=4+8) when the\n+\\f[CB]\\-strict\\f[R] option is specified.\n@@ -1165,1 +1176,1 @@\n-the errors and warnings that the \\f[V]jarsigner\\f[R] command can issue.\n+the errors and warnings that the \\f[CB]jarsigner\\f[R] command can issue.\n@@ -1168,4 +1179,3 @@\n-Reasons why the \\f[V]jarsigner\\f[R] command fails include (but\n-aren\\[aq]t limited to) a command line parsing error, the inability to\n-find a keypair to sign the JAR file, or the verification of a signed JAR\n-fails.\n+Reasons why the \\f[CB]jarsigner\\f[R] command fails include (but aren\\[aq]t\n+limited to) a command line parsing error, the inability to find a\n+keypair to sign the JAR file, or the verification of a signed JAR fails.\n@@ -1173,1 +1183,1 @@\n-failure\n+.B failure\n@@ -1176,0 +1186,2 @@\n+.RS\n+.RE\n@@ -1181,1 +1193,1 @@\n-\\f[V]-strict\\f[R] option.\n+\\f[CB]\\-strict\\f[R] option.\n@@ -1183,1 +1195,1 @@\n-Reasons why the \\f[V]jarsigner\\f[R] command issues a severe warning\n+Reasons why the \\f[CB]jarsigner\\f[R] command issues a severe warning\n@@ -1187,1 +1199,1 @@\n-hasExpiredCert\n+.B hasExpiredCert\n@@ -1190,0 +1202,2 @@\n+.RS\n+.RE\n@@ -1191,1 +1205,1 @@\n-hasExpiredTsaCert\n+.B hasExpiredTsaCert\n@@ -1194,0 +1208,2 @@\n+.RS\n+.RE\n@@ -1195,1 +1211,1 @@\n-notYetValidCert\n+.B notYetValidCert\n@@ -1198,0 +1214,2 @@\n+.RS\n+.RE\n@@ -1199,1 +1217,1 @@\n-chainNotValidated\n+.B chainNotValidated\n@@ -1202,0 +1220,2 @@\n+.RS\n+.RE\n@@ -1203,1 +1223,1 @@\n-tsaChainNotValidated\n+.B tsaChainNotValidated\n@@ -1206,0 +1226,2 @@\n+.RS\n+.RE\n@@ -1207,1 +1229,1 @@\n-signerSelfSigned\n+.B signerSelfSigned\n@@ -1210,0 +1232,2 @@\n+.RS\n+.RE\n@@ -1211,1 +1235,1 @@\n-disabledAlg\n+.B disabledAlg\n@@ -1214,0 +1238,2 @@\n+.RS\n+.RE\n@@ -1215,1 +1241,1 @@\n-badKeyUsage\n+.B badKeyUsage\n@@ -1219,0 +1245,2 @@\n+.RS\n+.RE\n@@ -1220,1 +1248,1 @@\n-badExtendedKeyUsage\n+.B badExtendedKeyUsage\n@@ -1224,0 +1252,2 @@\n+.RS\n+.RE\n@@ -1225,1 +1255,1 @@\n-badNetscapeCertType\n+.B badNetscapeCertType\n@@ -1229,0 +1259,2 @@\n+.RS\n+.RE\n@@ -1230,1 +1262,1 @@\n-hasUnsignedEntry\n+.B hasUnsignedEntry\n@@ -1233,1 +1265,3 @@\n-integrity-checked.\n+integrity\\-checked.\n+.RS\n+.RE\n@@ -1235,1 +1269,1 @@\n-notSignedByAlias\n+.B notSignedByAlias\n@@ -1239,0 +1273,2 @@\n+.RS\n+.RE\n@@ -1240,1 +1276,1 @@\n-aliasNotInStore\n+.B aliasNotInStore\n@@ -1244,0 +1280,2 @@\n+.RS\n+.RE\n@@ -1245,1 +1283,1 @@\n-tsaChainNotValidated\n+.B tsaChainNotValidated\n@@ -1248,0 +1286,2 @@\n+.RS\n+.RE\n@@ -1254,1 +1294,1 @@\n-extraAttributesDetected\n+.B extraAttributesDetected\n@@ -1257,1 +1297,1 @@\n-The \\f[V]jarsigner\\f[R] tool preserves these attributes in the newly\n+The \\f[CB]jarsigner\\f[R] tool preserves these attributes in the newly\n@@ -1260,0 +1300,2 @@\n+.RS\n+.RE\n@@ -1261,1 +1303,1 @@\n-hasExpiringCert\n+.B hasExpiringCert\n@@ -1264,0 +1306,2 @@\n+.RS\n+.RE\n@@ -1265,2 +1309,4 @@\n-hasExpiringTsaCert\n-The timestamp will expire within one year on \\f[V]YYYY-MM-DD\\f[R].\n+.B hasExpiringTsaCert\n+The timestamp will expire within one year on \\f[CB]YYYY\\-MM\\-DD\\f[R].\n+.RS\n+.RE\n@@ -1268,1 +1314,1 @@\n-legacyAlg\n+.B legacyAlg\n@@ -1270,0 +1316,2 @@\n+.RS\n+.RE\n@@ -1271,1 +1319,1 @@\n-noTimestamp\n+.B noTimestamp\n@@ -1275,1 +1323,3 @@\n-(\\f[V]YYYY-MM-DD\\f[R]) or after any future revocation date.\n+(\\f[CB]YYYY\\-MM\\-DD\\f[R]) or after any future revocation date.\n+.RS\n+.RE\n@@ -1278,4 +1328,4 @@\n-Use the following command to sign \\f[V]bundle.jar\\f[R] with the private\n-key of a user whose keystore alias is \\f[V]jane\\f[R] in a keystore named\n-\\f[V]mystore\\f[R] in the \\f[V]working\\f[R] directory and name the signed\n-JAR file \\f[V]sbundle.jar\\f[R]:\n+Use the following command to sign \\f[CB]bundle.jar\\f[R] with the private\n+key of a user whose keystore alias is \\f[CB]jane\\f[R] in a keystore named\n+\\f[CB]mystore\\f[R] in the \\f[CB]working\\f[R] directory and name the signed\n+JAR file \\f[CB]sbundle.jar\\f[R]:\n@@ -1284,2 +1334,2 @@\n-\\f[V]jarsigner -keystore \/working\/mystore -storepass\\f[R]\n-\\f[I]keystore_password\\f[R] \\f[V]-keypass\\f[R]\n+\\f[CB]jarsigner\\ \\-keystore\\ \/working\/mystore\\ \\-storepass\\f[R]\n+\\f[I]keystore_password\\f[R] \\f[CB]\\-keypass\\f[R]\n@@ -1287,1 +1337,1 @@\n-\\f[V]-signedjar sbundle.jar bundle.jar jane\\f[R]\n+\\f[CB]\\-signedjar\\ sbundle.jar\\ bundle.jar\\ jane\\f[R]\n@@ -1290,2 +1340,2 @@\n-There is no \\f[V]-sigfile\\f[R] specified in the previous command so the\n-generated \\f[V].SF\\f[R] and signature block files to be placed in the\n+There is no \\f[CB]\\-sigfile\\f[R] specified in the previous command so the\n+generated \\f[CB]\\&.SF\\f[R] and signature block files to be placed in the\n@@ -1293,1 +1343,1 @@\n-They are named \\f[V]JANE.SF\\f[R] and \\f[V]JANE.RSA\\f[R].\n+They are named \\f[CB]JANE.SF\\f[R] and \\f[CB]JANE.RSA\\f[R].\n@@ -1299,1 +1349,1 @@\n-\\f[V]jarsigner -keystore \/working\/mystore -signedjar sbundle.jar bundle.jar jane\\f[R]\n+\\f[CB]jarsigner\\ \\-keystore\\ \/working\/mystore\\ \\-signedjar\\ sbundle.jar\\ bundle.jar\\ jane\\f[R]\n@@ -1302,3 +1352,3 @@\n-If the \\f[V]keystore\\f[R] is the default \\f[V]keystore\\f[R]\n-(\\f[V].keystore\\f[R] in your home directory), then you don\\[aq]t need to\n-specify a \\f[V]keystore\\f[R], as follows:\n+If the \\f[CB]keystore\\f[R] is the default \\f[CB]keystore\\f[R]\n+(\\f[CB]\\&.keystore\\f[R] in your home directory), then you don\\[aq]t need\n+to specify a \\f[CB]keystore\\f[R], as follows:\n@@ -1307,1 +1357,1 @@\n-\\f[V]jarsigner -signedjar sbundle.jar bundle.jar jane\\f[R]\n+\\f[CB]jarsigner\\ \\-signedjar\\ sbundle.jar\\ bundle.jar\\ jane\\f[R]\n@@ -1311,2 +1361,2 @@\n-(\\f[V]bundle.jar\\f[R]), then you don\\[aq]t need to specify a\n-\\f[V]-signedjar\\f[R] option, as follows:\n+(\\f[CB]bundle.jar\\f[R]), then you don\\[aq]t need to specify a\n+\\f[CB]\\-signedjar\\f[R] option, as follows:\n@@ -1315,1 +1365,1 @@\n-\\f[V]jarsigner bundle.jar jane\\f[R]\n+\\f[CB]jarsigner\\ bundle.jar\\ jane\\f[R]\n@@ -1324,1 +1374,1 @@\n-\\f[V]jarsigner -verify ButtonDemo.jar\\f[R]\n+\\f[CB]jarsigner\\ \\-verify\\ ButtonDemo.jar\\f[R]\n@@ -1327,1 +1377,1 @@\n-When the verification is successful, \\f[V]jar verified\\f[R] is\n+When the verification is successful, \\f[CB]jar\\ verified\\f[R] is\n@@ -1330,2 +1380,2 @@\n-You can get more information when you use the \\f[V]-verbose\\f[R] option.\n-A sample use of \\f[V]jarsigner\\f[R] with the \\f[V]-verbose\\f[R] option\n+You can get more information when you use the \\f[CB]\\-verbose\\f[R] option.\n+A sample use of \\f[CB]jarsigner\\f[R] with the \\f[CB]\\-verbose\\f[R] option\n@@ -1336,1 +1386,1 @@\n-jarsigner -verify -verbose ButtonDemo.jar\n+jarsigner\\ \\-verify\\ \\-verbose\\ ButtonDemo.jar\n@@ -1338,12 +1388,12 @@\n-s       866 Tue Sep 12 20:08:48 EDT 2017 META-INF\/MANIFEST.MF\n-        825 Tue Sep 12 20:08:48 EDT 2017 META-INF\/ORACLE_C.SF\n-       7475 Tue Sep 12 20:08:48 EDT 2017 META-INF\/ORACLE_C.RSA\n-          0 Tue Sep 12 20:07:54 EDT 2017 META-INF\/\n-          0 Tue Sep 12 20:07:16 EDT 2017 components\/\n-          0 Tue Sep 12 20:07:16 EDT 2017 components\/images\/\n-sm      523 Tue Sep 12 20:07:16 EDT 2017 components\/ButtonDemo$1.class\n-sm     3440 Tue Sep 12 20:07:16 EDT 2017 components\/ButtonDemo.class\n-sm     2346 Tue Sep 12 20:07:16 EDT 2017 components\/ButtonDemo.jnlp\n-sm      172 Tue Sep 12 20:07:16 EDT 2017 components\/images\/left.gif\n-sm      235 Tue Sep 12 20:07:16 EDT 2017 components\/images\/middle.gif\n-sm      172 Tue Sep 12 20:07:16 EDT 2017 components\/images\/right.gif\n+s\\ \\ \\ \\ \\ \\ \\ 866\\ Tue\\ Sep\\ 12\\ 20:08:48\\ EDT\\ 2017\\ META\\-INF\/MANIFEST.MF\n+\\ \\ \\ \\ \\ \\ \\ \\ 825\\ Tue\\ Sep\\ 12\\ 20:08:48\\ EDT\\ 2017\\ META\\-INF\/ORACLE_C.SF\n+\\ \\ \\ \\ \\ \\ \\ 7475\\ Tue\\ Sep\\ 12\\ 20:08:48\\ EDT\\ 2017\\ META\\-INF\/ORACLE_C.RSA\n+\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ 0\\ Tue\\ Sep\\ 12\\ 20:07:54\\ EDT\\ 2017\\ META\\-INF\/\n+\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ 0\\ Tue\\ Sep\\ 12\\ 20:07:16\\ EDT\\ 2017\\ components\/\n+\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ 0\\ Tue\\ Sep\\ 12\\ 20:07:16\\ EDT\\ 2017\\ components\/images\/\n+sm\\ \\ \\ \\ \\ \\ 523\\ Tue\\ Sep\\ 12\\ 20:07:16\\ EDT\\ 2017\\ components\/ButtonDemo$1.class\n+sm\\ \\ \\ \\ \\ 3440\\ Tue\\ Sep\\ 12\\ 20:07:16\\ EDT\\ 2017\\ components\/ButtonDemo.class\n+sm\\ \\ \\ \\ \\ 2346\\ Tue\\ Sep\\ 12\\ 20:07:16\\ EDT\\ 2017\\ components\/ButtonDemo.jnlp\n+sm\\ \\ \\ \\ \\ \\ 172\\ Tue\\ Sep\\ 12\\ 20:07:16\\ EDT\\ 2017\\ components\/images\/left.gif\n+sm\\ \\ \\ \\ \\ \\ 235\\ Tue\\ Sep\\ 12\\ 20:07:16\\ EDT\\ 2017\\ components\/images\/middle.gif\n+sm\\ \\ \\ \\ \\ \\ 172\\ Tue\\ Sep\\ 12\\ 20:07:16\\ EDT\\ 2017\\ components\/images\/right.gif\n@@ -1351,3 +1401,3 @@\n-  s = signature was verified\n-  m = entry is listed in manifest\n-  k = at least one certificate was found in keystore\n+\\ \\ s\\ =\\ signature\\ was\\ verified\n+\\ \\ m\\ =\\ entry\\ is\\ listed\\ in\\ manifest\n+\\ \\ k\\ =\\ at\\ least\\ one\\ certificate\\ was\\ found\\ in\\ keystore\n@@ -1355,6 +1405,6 @@\n-- Signed by \\[dq]CN=\\[dq]Oracle America, Inc.\\[dq], OU=Software Engineering, O=\\[dq]Oracle America, Inc.\\[dq], L=Redwood City, ST=California, C=US\\[dq]\n-    Digest algorithm: SHA-256\n-    Signature algorithm: SHA256withRSA, 2048-bit key\n-  Timestamped by \\[dq]CN=Symantec Time Stamping Services Signer - G4, O=Symantec Corporation, C=US\\[dq] on Tue Sep 12 20:08:49 UTC 2017\n-    Timestamp digest algorithm: SHA-1\n-    Timestamp signature algorithm: SHA1withRSA, 2048-bit key\n+\\-\\ Signed\\ by\\ \"CN=\"Oracle\\ America,\\ Inc.\",\\ OU=Software\\ Engineering,\\ O=\"Oracle\\ America,\\ Inc.\",\\ L=Redwood\\ City,\\ ST=California,\\ C=US\"\n+\\ \\ \\ \\ Digest\\ algorithm:\\ SHA\\-256\n+\\ \\ \\ \\ Signature\\ algorithm:\\ SHA256withRSA,\\ 2048\\-bit\\ key\n+\\ \\ Timestamped\\ by\\ \"CN=Symantec\\ Time\\ Stamping\\ Services\\ Signer\\ \\-\\ G4,\\ O=Symantec\\ Corporation,\\ C=US\"\\ on\\ Tue\\ Sep\\ 12\\ 20:08:49\\ UTC\\ 2017\n+\\ \\ \\ \\ Timestamp\\ digest\\ algorithm:\\ SHA\\-1\n+\\ \\ \\ \\ Timestamp\\ signature\\ algorithm:\\ SHA1withRSA,\\ 2048\\-bit\\ key\n@@ -1362,1 +1412,1 @@\n-jar verified.\n+jar\\ verified.\n@@ -1364,1 +1414,1 @@\n-The signer certificate expired on 2018-02-01. However, the JAR will be valid until the timestamp expires on 2020-12-29.\n+The\\ signer\\ certificate\\ expired\\ on\\ 2018\\-02\\-01.\\ However,\\ the\\ JAR\\ will\\ be\\ valid\\ until\\ the\\ timestamp\\ expires\\ on\\ 2020\\-12\\-29.\n@@ -1369,2 +1419,2 @@\n-If you specify the \\f[V]-certs\\f[R] option with the \\f[V]-verify\\f[R]\n-and \\f[V]-verbose\\f[R] options, then the output includes certificate\n+If you specify the \\f[CB]\\-certs\\f[R] option with the \\f[CB]\\-verify\\f[R]\n+and \\f[CB]\\-verbose\\f[R] options, then the output includes certificate\n@@ -1379,1 +1429,1 @@\n-jarsigner -keystore $JAVA_HOME\/lib\/security\/cacerts -verify -verbose -certs ButtonDemo.jar\n+jarsigner\\ \\-keystore\\ $JAVA_HOME\/lib\/security\/cacerts\\ \\-verify\\ \\-verbose\\ \\-certs\\ ButtonDemo.jar\n@@ -1381,1 +1431,1 @@\n-s k     866 Tue Sep 12 20:08:48 EDT 2017 META-INF\/MANIFEST.MF\n+s\\ k\\ \\ \\ \\ \\ 866\\ Tue\\ Sep\\ 12\\ 20:08:48\\ EDT\\ 2017\\ META\\-INF\/MANIFEST.MF\n@@ -1383,12 +1433,12 @@\n-      >>> Signer\n-      X.509, CN=\\[dq]Oracle America, Inc.\\[dq], OU=Software Engineering, O=\\[dq]Oracle America, Inc.\\[dq], L=Redwood City, ST=California, C=US\n-      [certificate is valid from 2017-01-30, 7:00 PM to 2018-02-01, 6:59 PM]\n-      X.509, CN=Symantec Class 3 SHA256 Code Signing CA, OU=Symantec Trust Network, O=Symantec Corporation, C=US\n-      [certificate is valid from 2013-12-09, 7:00 PM to 2023-12-09, 6:59 PM]\n-      X.509, CN=VeriSign Class 3 Public Primary Certification Authority - G5, OU=\\[dq](c) 2006 VeriSign, Inc. - For authorized use only\\[dq], OU=VeriSign Trust Network, O=\\[dq]VeriSign, Inc.\\[dq], C=US (verisignclass3g5ca [jdk])\n-      [trusted certificate]\n-      >>> TSA\n-      X.509, CN=Symantec Time Stamping Services Signer - G4, O=Symantec Corporation, C=US\n-      [certificate is valid from 2012-10-17, 8:00 PM to 2020-12-29, 6:59 PM]\n-      X.509, CN=Symantec Time Stamping Services CA - G2, O=Symantec Corporation, C=US\n-      [certificate is valid from 2012-12-20, 7:00 PM to 2020-12-30, 6:59 PM]\n+\\ \\ \\ \\ \\ \\ >>>\\ Signer\n+\\ \\ \\ \\ \\ \\ X.509,\\ CN=\"Oracle\\ America,\\ Inc.\",\\ OU=Software\\ Engineering,\\ O=\"Oracle\\ America,\\ Inc.\",\\ L=Redwood\\ City,\\ ST=California,\\ C=US\n+\\ \\ \\ \\ \\ \\ [certificate\\ is\\ valid\\ from\\ 2017\\-01\\-30,\\ 7:00\\ PM\\ to\\ 2018\\-02\\-01,\\ 6:59\\ PM]\n+\\ \\ \\ \\ \\ \\ X.509,\\ CN=Symantec\\ Class\\ 3\\ SHA256\\ Code\\ Signing\\ CA,\\ OU=Symantec\\ Trust\\ Network,\\ O=Symantec\\ Corporation,\\ C=US\n+\\ \\ \\ \\ \\ \\ [certificate\\ is\\ valid\\ from\\ 2013\\-12\\-09,\\ 7:00\\ PM\\ to\\ 2023\\-12\\-09,\\ 6:59\\ PM]\n+\\ \\ \\ \\ \\ \\ X.509,\\ CN=VeriSign\\ Class\\ 3\\ Public\\ Primary\\ Certification\\ Authority\\ \\-\\ G5,\\ OU=\"(c)\\ 2006\\ VeriSign,\\ Inc.\\ \\-\\ For\\ authorized\\ use\\ only\",\\ OU=VeriSign\\ Trust\\ Network,\\ O=\"VeriSign,\\ Inc.\",\\ C=US\\ (verisignclass3g5ca\\ [jdk])\n+\\ \\ \\ \\ \\ \\ [trusted\\ certificate]\n+\\ \\ \\ \\ \\ \\ >>>\\ TSA\n+\\ \\ \\ \\ \\ \\ X.509,\\ CN=Symantec\\ Time\\ Stamping\\ Services\\ Signer\\ \\-\\ G4,\\ O=Symantec\\ Corporation,\\ C=US\n+\\ \\ \\ \\ \\ \\ [certificate\\ is\\ valid\\ from\\ 2012\\-10\\-17,\\ 8:00\\ PM\\ to\\ 2020\\-12\\-29,\\ 6:59\\ PM]\n+\\ \\ \\ \\ \\ \\ X.509,\\ CN=Symantec\\ Time\\ Stamping\\ Services\\ CA\\ \\-\\ G2,\\ O=Symantec\\ Corporation,\\ C=US\n+\\ \\ \\ \\ \\ \\ [certificate\\ is\\ valid\\ from\\ 2012\\-12\\-20,\\ 7:00\\ PM\\ to\\ 2020\\-12\\-30,\\ 6:59\\ PM]\n@@ -1396,6 +1446,6 @@\n-        825 Tue Sep 12 20:08:48 EDT 2017 META-INF\/ORACLE_C.SF\n-       7475 Tue Sep 12 20:08:48 EDT 2017 META-INF\/ORACLE_C.RSA\n-          0 Tue Sep 12 20:07:54 EDT 2017 META-INF\/\n-          0 Tue Sep 12 20:07:16 EDT 2017 components\/\n-          0 Tue Sep 12 20:07:16 EDT 2017 components\/images\/\n-smk     523 Tue Sep 12 20:07:16 EDT 2017 components\/ButtonDemo$1.class\n+\\ \\ \\ \\ \\ \\ \\ \\ 825\\ Tue\\ Sep\\ 12\\ 20:08:48\\ EDT\\ 2017\\ META\\-INF\/ORACLE_C.SF\n+\\ \\ \\ \\ \\ \\ \\ 7475\\ Tue\\ Sep\\ 12\\ 20:08:48\\ EDT\\ 2017\\ META\\-INF\/ORACLE_C.RSA\n+\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ 0\\ Tue\\ Sep\\ 12\\ 20:07:54\\ EDT\\ 2017\\ META\\-INF\/\n+\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ 0\\ Tue\\ Sep\\ 12\\ 20:07:16\\ EDT\\ 2017\\ components\/\n+\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ 0\\ Tue\\ Sep\\ 12\\ 20:07:16\\ EDT\\ 2017\\ components\/images\/\n+smk\\ \\ \\ \\ \\ 523\\ Tue\\ Sep\\ 12\\ 20:07:16\\ EDT\\ 2017\\ components\/ButtonDemo$1.class\n@@ -1403,13 +1453,13 @@\n-      [entry was signed on 2017-09-12, 4:08 PM]\n-      >>> Signer\n-      X.509, CN=\\[dq]Oracle America, Inc.\\[dq], OU=Software Engineering, O=\\[dq]Oracle America, Inc.\\[dq], L=Redwood City, ST=California, C=US\n-      [certificate is valid from 2017-01-30, 7:00 PM to 2018-02-01, 6:59 PM]\n-      X.509, CN=Symantec Class 3 SHA256 Code Signing CA, OU=Symantec Trust Network, O=Symantec Corporation, C=US\n-      [certificate is valid from 2013-12-09, 7:00 PM to 2023-12-09, 6:59 PM]\n-      X.509, CN=VeriSign Class 3 Public Primary Certification Authority - G5, OU=\\[dq](c) 2006 VeriSign, Inc. - For authorized use only\\[dq], OU=VeriSign Trust Network, O=\\[dq]VeriSign, Inc.\\[dq], C=US (verisignclass3g5ca [jdk])\n-      [trusted certificate]\n-      >>> TSA\n-      X.509, CN=Symantec Time Stamping Services Signer - G4, O=Symantec Corporation, C=US\n-      [certificate is valid from 2012-10-17, 8:00 PM to 2020-12-29, 6:59 PM]\n-      X.509, CN=Symantec Time Stamping Services CA - G2, O=Symantec Corporation, C=US\n-      [certificate is valid from 2012-12-20, 7:00 PM to 2020-12-30, 6:59 PM]\n+\\ \\ \\ \\ \\ \\ [entry\\ was\\ signed\\ on\\ 2017\\-09\\-12,\\ 4:08\\ PM]\n+\\ \\ \\ \\ \\ \\ >>>\\ Signer\n+\\ \\ \\ \\ \\ \\ X.509,\\ CN=\"Oracle\\ America,\\ Inc.\",\\ OU=Software\\ Engineering,\\ O=\"Oracle\\ America,\\ Inc.\",\\ L=Redwood\\ City,\\ ST=California,\\ C=US\n+\\ \\ \\ \\ \\ \\ [certificate\\ is\\ valid\\ from\\ 2017\\-01\\-30,\\ 7:00\\ PM\\ to\\ 2018\\-02\\-01,\\ 6:59\\ PM]\n+\\ \\ \\ \\ \\ \\ X.509,\\ CN=Symantec\\ Class\\ 3\\ SHA256\\ Code\\ Signing\\ CA,\\ OU=Symantec\\ Trust\\ Network,\\ O=Symantec\\ Corporation,\\ C=US\n+\\ \\ \\ \\ \\ \\ [certificate\\ is\\ valid\\ from\\ 2013\\-12\\-09,\\ 7:00\\ PM\\ to\\ 2023\\-12\\-09,\\ 6:59\\ PM]\n+\\ \\ \\ \\ \\ \\ X.509,\\ CN=VeriSign\\ Class\\ 3\\ Public\\ Primary\\ Certification\\ Authority\\ \\-\\ G5,\\ OU=\"(c)\\ 2006\\ VeriSign,\\ Inc.\\ \\-\\ For\\ authorized\\ use\\ only\",\\ OU=VeriSign\\ Trust\\ Network,\\ O=\"VeriSign,\\ Inc.\",\\ C=US\\ (verisignclass3g5ca\\ [jdk])\n+\\ \\ \\ \\ \\ \\ [trusted\\ certificate]\n+\\ \\ \\ \\ \\ \\ >>>\\ TSA\n+\\ \\ \\ \\ \\ \\ X.509,\\ CN=Symantec\\ Time\\ Stamping\\ Services\\ Signer\\ \\-\\ G4,\\ O=Symantec\\ Corporation,\\ C=US\n+\\ \\ \\ \\ \\ \\ [certificate\\ is\\ valid\\ from\\ 2012\\-10\\-17,\\ 8:00\\ PM\\ to\\ 2020\\-12\\-29,\\ 6:59\\ PM]\n+\\ \\ \\ \\ \\ \\ X.509,\\ CN=Symantec\\ Time\\ Stamping\\ Services\\ CA\\ \\-\\ G2,\\ O=Symantec\\ Corporation,\\ C=US\n+\\ \\ \\ \\ \\ \\ [certificate\\ is\\ valid\\ from\\ 2012\\-12\\-20,\\ 7:00\\ PM\\ to\\ 2020\\-12\\-30,\\ 6:59\\ PM]\n@@ -1417,1 +1467,1 @@\n-smk    3440 Tue Sep 12 20:07:16 EDT 2017 components\/ButtonDemo.class\n+smk\\ \\ \\ \\ 3440\\ Tue\\ Sep\\ 12\\ 20:07:16\\ EDT\\ 2017\\ components\/ButtonDemo.class\n@@ -1419,1 +1469,1 @@\n-smk    2346 Tue Sep 12 20:07:16 EDT 2017 components\/ButtonDemo.jnlp\n+smk\\ \\ \\ \\ 2346\\ Tue\\ Sep\\ 12\\ 20:07:16\\ EDT\\ 2017\\ components\/ButtonDemo.jnlp\n@@ -1421,1 +1471,1 @@\n-smk     172 Tue Sep 12 20:07:16 EDT 2017 components\/images\/left.gif\n+smk\\ \\ \\ \\ \\ 172\\ Tue\\ Sep\\ 12\\ 20:07:16\\ EDT\\ 2017\\ components\/images\/left.gif\n@@ -1423,1 +1473,1 @@\n-smk     235 Tue Sep 12 20:07:16 EDT 2017 components\/images\/middle.gif\n+smk\\ \\ \\ \\ \\ 235\\ Tue\\ Sep\\ 12\\ 20:07:16\\ EDT\\ 2017\\ components\/images\/middle.gif\n@@ -1425,1 +1475,1 @@\n-smk     172 Tue Sep 12 20:07:16 EDT 2017 components\/images\/right.gif\n+smk\\ \\ \\ \\ \\ 172\\ Tue\\ Sep\\ 12\\ 20:07:16\\ EDT\\ 2017\\ components\/images\/right.gif\n@@ -1428,3 +1478,3 @@\n-  s = signature was verified\n-  m = entry is listed in manifest\n-  k = at least one certificate was found in keystore\n+\\ \\ s\\ =\\ signature\\ was\\ verified\n+\\ \\ m\\ =\\ entry\\ is\\ listed\\ in\\ manifest\n+\\ \\ k\\ =\\ at\\ least\\ one\\ certificate\\ was\\ found\\ in\\ keystore\n@@ -1432,6 +1482,6 @@\n-- Signed by \\[dq]CN=\\[dq]Oracle America, Inc.\\[dq], OU=Software Engineering, O=\\[dq]Oracle America, Inc.\\[dq], L=Redwood City, ST=California, C=US\\[dq]\n-    Digest algorithm: SHA-256\n-    Signature algorithm: SHA256withRSA, 2048-bit key\n-  Timestamped by \\[dq]CN=Symantec Time Stamping Services Signer - G4, O=Symantec Corporation, C=US\\[dq] on Tue Sep 12 20:08:49 UTC 2017\n-    Timestamp digest algorithm: SHA-1\n-    Timestamp signature algorithm: SHA1withRSA, 2048-bit key\n+\\-\\ Signed\\ by\\ \"CN=\"Oracle\\ America,\\ Inc.\",\\ OU=Software\\ Engineering,\\ O=\"Oracle\\ America,\\ Inc.\",\\ L=Redwood\\ City,\\ ST=California,\\ C=US\"\n+\\ \\ \\ \\ Digest\\ algorithm:\\ SHA\\-256\n+\\ \\ \\ \\ Signature\\ algorithm:\\ SHA256withRSA,\\ 2048\\-bit\\ key\n+\\ \\ Timestamped\\ by\\ \"CN=Symantec\\ Time\\ Stamping\\ Services\\ Signer\\ \\-\\ G4,\\ O=Symantec\\ Corporation,\\ C=US\"\\ on\\ Tue\\ Sep\\ 12\\ 20:08:49\\ UTC\\ 2017\n+\\ \\ \\ \\ Timestamp\\ digest\\ algorithm:\\ SHA\\-1\n+\\ \\ \\ \\ Timestamp\\ signature\\ algorithm:\\ SHA1withRSA,\\ 2048\\-bit\\ key\n@@ -1439,1 +1489,1 @@\n-jar verified.\n+jar\\ verified.\n@@ -1441,1 +1491,1 @@\n-The signer certificate expired on 2018-02-01. However, the JAR will be valid until the timestamp expires on 2020-12-29.\n+The\\ signer\\ certificate\\ expired\\ on\\ 2018\\-02\\-01.\\ However,\\ the\\ JAR\\ will\\ be\\ valid\\ until\\ the\\ timestamp\\ expires\\ on\\ 2020\\-12\\-29.\n@@ -1449,1 +1499,1 @@\n-\\f[V]bob\\f[R], then you would get: \\f[V]PGP, (bob)\\f[R].\n+\\f[CB]bob\\f[R], then you would get: \\f[CB]PGP,\\ (bob)\\f[R].\n","filename":"src\/jdk.jartool\/share\/man\/jarsigner.1","additions":514,"deletions":464,"binary":false,"changes":978,"status":"modified"},{"patch":"@@ -814,2 +814,2 @@\n-    @Deprecated(forRemoval = true)\n-    private Content throwsTagOutput(Element element, ThrowsTree throwsTag, TypeMirror substituteType) {\n+    @Override\n+    public Content throwsTagOutput(Element element, ThrowsTree throwsTag, TypeMirror substituteType) {\n@@ -821,1 +821,1 @@\n-            excName = htmlWriter.getLink(new HtmlLinkInfo(configuration, HtmlLinkInfo.Kind.MEMBER,\n+           excName = htmlWriter.getLink(new HtmlLinkInfo(configuration, HtmlLinkInfo.Kind.MEMBER,\n@@ -824,1 +824,1 @@\n-            excName = Text.of(throwsTag.getExceptionName().toString());\n+            excName = RawHtml.of(throwsTag.getExceptionName().toString());\n@@ -844,10 +844,3 @@\n-    public Content throwsTagOutput(TypeMirror throwsType, Optional<Content> content) {\n-        var linkInfo = new HtmlLinkInfo(configuration, HtmlLinkInfo.Kind.MEMBER, throwsType);\n-        linkInfo.excludeTypeBounds = true;\n-        var link = htmlWriter.getLink(linkInfo);\n-        var concat = new ContentBuilder(HtmlTree.CODE(link));\n-        if (content.isPresent()) {\n-            concat.add(\" - \");\n-            concat.add(content.get());\n-        }\n-        return HtmlTree.DD(concat);\n+    public Content throwsTagOutput(TypeMirror throwsType) {\n+        return HtmlTree.DD(HtmlTree.CODE(htmlWriter.getLink(\n+                new HtmlLinkInfo(configuration, HtmlLinkInfo.Kind.MEMBER, throwsType))));\n","filename":"src\/jdk.javadoc\/share\/classes\/jdk\/javadoc\/internal\/doclets\/formats\/html\/TagletWriterImpl.java","additions":7,"deletions":14,"binary":false,"changes":21,"status":"modified"},{"patch":"@@ -110,2 +110,0 @@\n-doclet.throws.reference_not_found=cannot find exception type by name\n-doclet.throws.reference_bad_type=not an exception type: {0}\n@@ -534,1 +532,1 @@\n-    <name>,<name>,...\n+    <name>:...\n@@ -536,2 +534,1 @@\n-    Exclude any doc-files subdirectories with given name.\\n\\\n-    ':' can also be used anywhere in the argument as a separator.\n+    Exclude any doc-files subdirectories with given name\n@@ -540,1 +537,1 @@\n-    <name> <g1>,<g2>...\n+    <name> <g1>:<g2>...\n@@ -542,2 +539,1 @@\n-    Group specified elements together in overview page.\\n\\\n-    ':' can also be used anywhere in the argument as a separator.\n+    Group specified elements together in overview page\n@@ -557,1 +553,1 @@\n-    <name1>,<name2>,...\n+    <name1>:<name2>:...\n@@ -559,2 +555,1 @@\n-    Exclude the list of qualifiers from the output.\\n\\\n-    ':' can also be used anywhere in the argument as a separator.\n+    Exclude the list of qualifiers from the output\n","filename":"src\/jdk.javadoc\/share\/classes\/jdk\/javadoc\/internal\/doclets\/formats\/html\/resources\/standard.properties","additions":6,"deletions":11,"binary":false,"changes":17,"status":"modified"},{"patch":"@@ -474,5 +474,1 @@\n-                \/* Since there are few constraints on the characters in a tag name,\n-                 * and real world examples with ':' in the tag name, we cannot simply use\n-                 * String.split(regex);  instead, we tokenize the string, allowing\n-                 * special characters to be escaped with '\\'. *\/\n-                List<String> tokens = tokenize(args.get(1), 3);\n+                List<String> tokens = tokenize(args.get(1), TagletManager.SIMPLE_TAGLET_OPT_SEPARATOR, 3);\n@@ -480,1 +476,1 @@\n-                    case 1 -> {\n+                    case 1:\n@@ -491,1 +487,1 @@\n-                    }\n+                        break;\n@@ -493,1 +489,1 @@\n-                    case 2 ->\n+                    case 2:\n@@ -496,0 +492,1 @@\n+                        break;\n@@ -497,1 +494,1 @@\n-                    case 3 ->\n+                    case 3:\n@@ -499,0 +496,1 @@\n+                        break;\n@@ -500,1 +498,1 @@\n-                    default ->\n+                    default:\n@@ -510,3 +508,3 @@\n-     * Given a string, return an array of tokens, separated by ':'.\n-     * The separator character can be escaped with the '\\' character.\n-     * The '\\' character may also be escaped with the '\\' character.\n+     * Given a string, return an array of tokens.  The separator can be escaped\n+     * with the '\\' character.  The '\\' character may also be escaped by the\n+     * '\\' character.\n@@ -514,1 +512,2 @@\n-     * @param s         the string to tokenize\n+     * @param s         the string to tokenize.\n+     * @param separator the separator char.\n@@ -518,1 +517,1 @@\n-     * @return an array of tokens\n+     * @return an array of tokens.\n@@ -520,1 +519,1 @@\n-    private List<String> tokenize(String s, int maxTokens) {\n+    private List<String> tokenize(String s, char separator, int maxTokens) {\n@@ -530,1 +529,1 @@\n-            } else if (currentChar == ':' && tokens.size() < maxTokens - 1) {\n+            } else if (currentChar == separator && tokens.size() < maxTokens - 1) {\n","filename":"src\/jdk.javadoc\/share\/classes\/jdk\/javadoc\/internal\/doclets\/toolkit\/BaseConfiguration.java","additions":16,"deletions":17,"binary":false,"changes":33,"status":"modified"},{"patch":"@@ -422,1 +422,1 @@\n-                        excludedDocFileDirs.addAll(List.of(args.get(0).split(\"[,:]\")));\n+                        addToSet(excludedDocFileDirs, args.get(0));\n@@ -539,1 +539,1 @@\n-                        excludedQualifiers.addAll(List.of(args.get(0).split(\"[,:]\")));\n+                        addToSet(excludedQualifiers, args.get(0));\n@@ -767,0 +767,9 @@\n+    private void addToSet(Set<String> s, String str) {\n+        StringTokenizer st = new StringTokenizer(str, \":\");\n+        String current;\n+        while (st.hasMoreTokens()) {\n+            current = st.nextToken();\n+            s.add(current);\n+        }\n+    }\n+\n","filename":"src\/jdk.javadoc\/share\/classes\/jdk\/javadoc\/internal\/doclets\/toolkit\/BaseOptions.java","additions":11,"deletions":2,"binary":false,"changes":13,"status":"modified"},{"patch":"@@ -36,1 +36,0 @@\n-import java.util.Optional;\n@@ -54,1 +53,0 @@\n-import jdk.javadoc.internal.doclets.toolkit.util.DocFinder.Result;\n@@ -265,11 +263,11 @@\n-                if (utils.isMethod(member)) {\n-                    var docFinder = utils.docFinder();\n-                    Optional<List<? extends DocTree>> r = docFinder.search((ExecutableElement) member, (m -> {\n-                        var firstSentenceTrees = utils.getFirstSentenceTrees(m);\n-                        Optional<List<? extends DocTree>> optional = firstSentenceTrees.isEmpty() ? Optional.empty() : Optional.of(firstSentenceTrees);\n-                        return Result.fromOptional(optional);\n-                    })).toOptional();\n-                    \/\/ The fact that we use `member` for possibly unrelated tags is suspicious\n-                    writer.addMemberSummary(typeElement, member, r.orElse(List.of()));\n-                } else {\n-                    writer.addMemberSummary(typeElement, member, utils.getFirstSentenceTrees(member));\n+                List<? extends DocTree> firstSentenceTags = utils.getFirstSentenceTrees(member);\n+                if (utils.isMethod(member) && firstSentenceTags.isEmpty()) {\n+                    \/\/Inherit comments from overridden or implemented method if\n+                    \/\/necessary.\n+                    DocFinder.Output inheritedDoc =\n+                            DocFinder.search(configuration,\n+                                    new DocFinder.Input(utils, member));\n+                    if (inheritedDoc.holder != null\n+                            && !utils.getFirstSentenceTrees(inheritedDoc.holder).isEmpty()) {\n+                        firstSentenceTags = utils.getFirstSentenceTrees(inheritedDoc.holder);\n+                    }\n@@ -277,0 +275,1 @@\n+                writer.addMemberSummary(typeElement, member, firstSentenceTags);\n","filename":"src\/jdk.javadoc\/share\/classes\/jdk\/javadoc\/internal\/doclets\/toolkit\/builders\/MemberSummaryBuilder.java","additions":12,"deletions":13,"binary":false,"changes":25,"status":"modified"},{"patch":"@@ -35,1 +35,0 @@\n-import com.sun.source.doctree.DocTree;\n@@ -41,1 +40,0 @@\n-import jdk.javadoc.internal.doclets.toolkit.util.DocFinder.Result;\n@@ -170,4 +168,7 @@\n-            var docFinder = utils.docFinder();\n-            Optional<ExecutableElement> r = docFinder.search(currentMethod,\n-                    m -> Result.fromOptional(utils.getFullBody(m).isEmpty() ? Optional.empty() : Optional.of(m))).toOptional();\n-            ExecutableElement method = r.orElse(currentMethod);\n+            ExecutableElement method = currentMethod;\n+            if (utils.getFullBody(currentMethod).isEmpty()) {\n+                DocFinder.Output docs = DocFinder.search(configuration,\n+                        new DocFinder.Input(utils, currentMethod));\n+                if (!docs.inlineTags.isEmpty())\n+                    method = (ExecutableElement) docs.holder;\n+            }\n","filename":"src\/jdk.javadoc\/share\/classes\/jdk\/javadoc\/internal\/doclets\/toolkit\/builders\/MethodBuilder.java","additions":7,"deletions":6,"binary":false,"changes":13,"status":"modified"},{"patch":"@@ -121,3 +121,0 @@\n-doclet.inheritDocNoDoc=overridden methods do not document exception type {0}\n-doclet.throwsInheritDocUnsupported=@inheritDoc is not supported for exception-type type parameters \\\n-  that are not declared by a method; document such exception types directly\n","filename":"src\/jdk.javadoc\/share\/classes\/jdk\/javadoc\/internal\/doclets\/toolkit\/resources\/doclets.properties","additions":0,"deletions":3,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -29,2 +29,0 @@\n-import java.util.List;\n-import java.util.Optional;\n@@ -43,1 +41,0 @@\n-import jdk.javadoc.internal.doclets.toolkit.util.DocFinder.Result;\n@@ -67,1 +64,1 @@\n-     * @param method the method that we are documenting.\n+     * @param e the {@link Element} that we are documenting.\n@@ -72,1 +69,1 @@\n-                                                   ExecutableElement method,\n+                                                   Element e,\n@@ -79,1 +76,1 @@\n-        CommentHelper ch = utils.getCommentHelper(method);\n+        CommentHelper ch = utils.getCommentHelper(e);\n@@ -82,18 +79,3 @@\n-        if (holderTag.getKind() == DocTree.Kind.DOC_COMMENT) {\n-            try {\n-                var docFinder = utils.docFinder();\n-                Optional<Documentation> r = docFinder.trySearch(method,\n-                        m -> Result.fromOptional(extractMainDescription(m, isFirstSentence, utils))).toOptional();\n-                if (r.isPresent()) {\n-                    replacement = writer.commentTagsToOutput(r.get().method, null,\n-                            r.get().mainDescription, isFirstSentence);\n-                }\n-            } catch (DocFinder.NoOverriddenMethodsFound e) {\n-                String signature = utils.getSimpleName(method)\n-                        + utils.flatSignature(method, writer.getCurrentPageElement());\n-                messages.warning(method, \"doclet.noInheritedDoc\", signature);\n-            }\n-            return replacement;\n-        }\n-\n-        Taglet taglet = configuration.tagletManager.getTaglet(ch.getTagName(holderTag));\n+        Taglet taglet = holderTag.getKind() == DocTree.Kind.DOC_COMMENT\n+                ? null\n+                : configuration.tagletManager.getTaglet(ch.getTagName(holderTag));\n@@ -105,6 +87,7 @@\n-\n-        InheritableTaglet.Output inheritedDoc = ((InheritableTaglet) taglet).inherit(method, holderTag, isFirstSentence, configuration);\n-        if (inheritedDoc.isValidInheritDocTag()) {\n-            if (!inheritedDoc.inlineTags().isEmpty()) {\n-                replacement = writer.commentTagsToOutput(inheritedDoc.holder(), inheritedDoc.holderTag(),\n-                        inheritedDoc.inlineTags(), isFirstSentence);\n+        var input = new DocFinder.Input(utils, e, (InheritableTaglet) taglet,\n+                new DocFinder.DocTreeInfo(holderTag, e), isFirstSentence, true);\n+        DocFinder.Output inheritedDoc = DocFinder.search(configuration, input);\n+        if (inheritedDoc.isValidInheritDocTag) {\n+            if (!inheritedDoc.inlineTags.isEmpty()) {\n+                replacement = writer.commentTagsToOutput(inheritedDoc.holder, inheritedDoc.holderTag,\n+                        inheritedDoc.inlineTags, isFirstSentence);\n@@ -113,3 +96,5 @@\n-            String signature = utils.getSimpleName(method)\n-                    + utils.flatSignature(method, writer.getCurrentPageElement());\n-            messages.warning(method, \"doclet.noInheritedDoc\", signature);\n+            String signature = utils.getSimpleName(e) +\n+                    ((utils.isExecutableElement(e))\n+                            ? utils.flatSignature((ExecutableElement) e, writer.getCurrentPageElement())\n+                            : e.toString());\n+            messages.warning(e, \"doclet.noInheritedDoc\", signature);\n@@ -120,11 +105,0 @@\n-    private record Documentation(List<? extends DocTree> mainDescription, ExecutableElement method) { }\n-\n-    private static Optional<Documentation> extractMainDescription(ExecutableElement m,\n-                                                                boolean extractFirstSentenceOnly,\n-                                                                Utils utils) {\n-        List<? extends DocTree> docTrees = extractFirstSentenceOnly\n-                ? utils.getFirstSentenceTrees(m)\n-                : utils.getFullBody(m);\n-        return docTrees.isEmpty() ? Optional.empty() : Optional.of(new Documentation(docTrees, m));\n-    }\n-\n@@ -136,1 +110,1 @@\n-        return retrieveInheritedDocumentation(tagletWriter, (ExecutableElement) e, inheritDoc, tagletWriter.isFirstSentence);\n+        return retrieveInheritedDocumentation(tagletWriter, e, inheritDoc, tagletWriter.isFirstSentence);\n","filename":"src\/jdk.javadoc\/share\/classes\/jdk\/javadoc\/internal\/doclets\/toolkit\/taglets\/InheritDocTaglet.java","additions":19,"deletions":45,"binary":false,"changes":64,"status":"modified"},{"patch":"@@ -28,7 +28,1 @@\n-\n-import java.util.List;\n-\n-import javax.lang.model.element.Element;\n-\n-import com.sun.source.doctree.DocTree;\n-import jdk.javadoc.internal.doclets.toolkit.BaseConfiguration;\n+import jdk.javadoc.internal.doclets.toolkit.util.DocFinder;\n@@ -42,3 +36,4 @@\n-    \/*\n-     * Called by InheritDocTaglet on an inheritable taglet to expand {@inheritDoc}\n-     * found inside a tag corresponding to that taglet.\n+    \/**\n+     * Given an {@link jdk.javadoc.internal.doclets.toolkit.util.DocFinder.Output}\n+     * object, set its values with the appropriate information to inherit\n+     * documentation.\n@@ -46,8 +41,2 @@\n-     * When inheriting failed some assumption, or caused an error, the taglet\n-     * can return either of:\n-     *\n-     *   - new Output(null, null, List.of(), false)\n-     *   - new Output(null, null, List.of(), true)\n-     *\n-     * In the future, this could be reworked using some other mechanism,\n-     * such as throwing an exception.\n+     * @param input  the input for documentation search\n+     * @param output the output for documentation search\n@@ -55,7 +44,1 @@\n-    Output inherit(Element owner, DocTree tag, boolean isFirstSentence, BaseConfiguration configuration);\n-\n-    record Output(DocTree holderTag,\n-                  Element holder,\n-                  List<? extends DocTree> inlineTags,\n-                  boolean isValidInheritDocTag) {\n-    }\n+    void inherit(DocFinder.Input input, DocFinder.Output output);\n","filename":"src\/jdk.javadoc\/share\/classes\/jdk\/javadoc\/internal\/doclets\/toolkit\/taglets\/InheritableTaglet.java","additions":8,"deletions":25,"binary":false,"changes":33,"status":"modified"},{"patch":"@@ -31,1 +31,0 @@\n-import javax.lang.model.element.ElementKind;\n@@ -38,1 +37,0 @@\n-import jdk.javadoc.internal.doclets.toolkit.BaseConfiguration;\n@@ -43,1 +41,1 @@\n-import jdk.javadoc.internal.doclets.toolkit.util.DocFinder.Result;\n+import jdk.javadoc.internal.doclets.toolkit.util.DocFinder.Input;\n@@ -67,17 +65,21 @@\n-    public Output inherit(Element owner, DocTree tag, boolean isFirstSentence, BaseConfiguration configuration) {\n-        assert owner.getKind() == ElementKind.METHOD;\n-        assert tag.getKind() == DocTree.Kind.PARAM;\n-        var method = (ExecutableElement) owner;\n-        var param = (ParamTree) tag;\n-        \/\/ find the position of an owner parameter described by the given tag\n-        List<? extends Element> parameterElements;\n-        if (param.isTypeParameter()) {\n-            parameterElements = method.getTypeParameters();\n-        } else {\n-            parameterElements = method.getParameters();\n-        }\n-        Map<String, Integer> stringIntegerMap = mapNameToPosition(configuration.utils, parameterElements);\n-        CommentHelper ch = configuration.utils.getCommentHelper(owner);\n-        Integer position = stringIntegerMap.get(ch.getParameterName(param));\n-        if (position == null) {\n-            return new Output(null, null, List.of(), true);\n+    public void inherit(DocFinder.Input input, DocFinder.Output output) {\n+        Utils utils = input.utils;\n+        if (input.tagId == null) {\n+            var tag = (ParamTree) input.docTreeInfo.docTree();\n+            input.isTypeVariableParamTag = tag.isTypeParameter();\n+            ExecutableElement ee = (ExecutableElement) input.docTreeInfo.element();\n+            CommentHelper ch = utils.getCommentHelper(ee);\n+            List<? extends Element> parameters = input.isTypeVariableParamTag\n+                    ? ee.getTypeParameters()\n+                    : ee.getParameters();\n+            String target = ch.getParameterName(tag);\n+            for (int i = 0; i < parameters.size(); i++) {\n+                Element e = parameters.get(i);\n+                String candidate = input.isTypeVariableParamTag\n+                        ? utils.getTypeName(e.asType(), false)\n+                        : utils.getSimpleName(e);\n+                if (candidate.equals(target)) {\n+                    input.tagId = Integer.toString(i);\n+                    break;\n+                }\n+            }\n@@ -85,10 +87,20 @@\n-        \/\/ try to inherit description of the respective parameter in an overridden method\n-        try {\n-            var docFinder = configuration.utils.docFinder();\n-            var r = docFinder.trySearch(method,\n-                            m -> Result.fromOptional(extract(configuration.utils, m, position, param.isTypeParameter())))\n-                    .toOptional();\n-            return r.map(result -> new Output(result.paramTree, result.method, result.paramTree.getDescription(), true))\n-                    .orElseGet(() -> new Output(null, null, List.of(), true));\n-        } catch (DocFinder.NoOverriddenMethodsFound e) {\n-            return new Output(null, null, List.of(), false);\n+        if (input.tagId == null)\n+            return;\n+        int position = Integer.parseInt(input.tagId);\n+        ExecutableElement ee = (ExecutableElement) input.element;\n+        CommentHelper ch = utils.getCommentHelper(ee);\n+        List<ParamTree> tags = input.isTypeVariableParamTag\n+                ? utils.getTypeParamTrees(ee)\n+                : utils.getParamTrees(ee);\n+        List<? extends Element> parameters = input.isTypeVariableParamTag\n+                ? ee.getTypeParameters()\n+                : ee.getParameters();\n+        Map<String, Integer> positionOfName = mapNameToPosition(utils, parameters);\n+        for (ParamTree tag : tags) {\n+            String paramName = ch.getParameterName(tag);\n+            if (positionOfName.containsKey(paramName) && positionOfName.get(paramName).equals(position)) {\n+                output.holder = input.element;\n+                output.holderTag = tag;\n+                output.inlineTags = ch.getBody(tag);\n+                return;\n+            }\n@@ -230,4 +242,4 @@\n-        var r = utils.docFinder().search((ExecutableElement) holder,\n-                        m -> Result.fromOptional(extract(utils, m, position, kind == ParamKind.TYPE_PARAMETER)))\n-                .toOptional();\n-        if (r.isPresent()) {\n+        Input input = new DocFinder.Input(writer.configuration().utils, holder, this,\n+                Integer.toString(position), kind == ParamKind.TYPE_PARAMETER);\n+        DocFinder.Output inheritedDoc = DocFinder.search(writer.configuration(), input);\n+        if (!inheritedDoc.inlineTags.isEmpty()) {\n@@ -237,2 +249,3 @@\n-            Content content = convertParam(r.get().method, kind, writer,\n-                    r.get().paramTree, name, isFirst);\n+            Content content = convertParam(inheritedDoc.holder, kind, writer,\n+                    (ParamTree) inheritedDoc.holderTag,\n+                    name, isFirst);\n@@ -244,15 +257,0 @@\n-    private record Documentation(ParamTree paramTree, ExecutableElement method) { }\n-\n-    private static Optional<Documentation> extract(Utils utils, ExecutableElement method, Integer position, boolean typeParam) {\n-        var ch = utils.getCommentHelper(method);\n-        List<ParamTree> tags = typeParam\n-                ? utils.getTypeParamTrees(method)\n-                : utils.getParamTrees(method);\n-        List<? extends Element> parameters = typeParam\n-                ? method.getTypeParameters()\n-                : method.getParameters();\n-        var positionOfName = mapNameToPosition(utils, parameters);\n-        return tags.stream().filter(t -> position.equals(positionOfName.get(ch.getParameterName(t))))\n-                .map(t -> new Documentation(t, method)).findAny();\n-    }\n-\n","filename":"src\/jdk.javadoc\/share\/classes\/jdk\/javadoc\/internal\/doclets\/toolkit\/taglets\/ParamTaglet.java","additions":49,"deletions":51,"binary":false,"changes":100,"status":"modified"},{"patch":"@@ -28,0 +28,1 @@\n+import java.util.ArrayList;\n@@ -30,2 +31,0 @@\n-import java.util.Optional;\n-import java.util.stream.Stream;\n@@ -34,1 +33,0 @@\n-import javax.lang.model.element.ElementKind;\n@@ -41,1 +39,0 @@\n-import jdk.javadoc.internal.doclets.toolkit.BaseConfiguration;\n@@ -44,0 +41,1 @@\n+import jdk.javadoc.internal.doclets.toolkit.util.CommentHelper;\n@@ -45,1 +43,1 @@\n-import jdk.javadoc.internal.doclets.toolkit.util.DocFinder.Result;\n+import jdk.javadoc.internal.doclets.toolkit.util.DocFinder.Input;\n@@ -63,8 +61,21 @@\n-    public Output inherit(Element owner, DocTree tag, boolean isFirstSentence, BaseConfiguration configuration) {\n-        try {\n-            var docFinder = configuration.utils.docFinder();\n-            var r = docFinder.trySearch((ExecutableElement) owner, m -> Result.fromOptional(extract(configuration.utils, m))).toOptional();\n-            return r.map(result -> new Output(result.returnTree, result.method, result.returnTree.getDescription(), true))\n-                    .orElseGet(() -> new Output(null, null, List.of(), true));\n-        } catch (DocFinder.NoOverriddenMethodsFound e) {\n-            return new Output(null, null, List.of(), false);\n+    public void inherit(DocFinder.Input input, DocFinder.Output output) {\n+        Utils utils = input.utils;\n+        CommentHelper ch = utils.getCommentHelper(input.element);\n+\n+        ReturnTree tag = null;\n+        List<? extends ReturnTree> tags = utils.getReturnTrees(input.element);\n+        if (!tags.isEmpty()) {\n+            tag = tags.get(0);\n+        } else {\n+            List<? extends DocTree> firstSentence = utils.getFirstSentenceTrees(input.element);\n+            if (firstSentence.size() == 1 && firstSentence.get(0).getKind() == DocTree.Kind.RETURN) {\n+                tag = (ReturnTree) firstSentence.get(0);\n+            }\n+        }\n+\n+        if (tag != null) {\n+            output.holder = input.element;\n+            output.holderTag = tag;\n+            output.inlineTags = input.isFirstSentence\n+                    ? ch.getFirstSentenceTrees(output.holderTag)\n+                    : ch.getDescription(output.holderTag);\n@@ -81,2 +92,0 @@\n-        assert holder.getKind() == ElementKind.METHOD : holder.getKind();\n-        var method = (ExecutableElement) holder;\n@@ -87,2 +96,2 @@\n-        \/\/ make sure we are not using @return on a method with the void return type\n-        TypeMirror returnType = utils.getReturnType(writer.getCurrentPageElement(), method);\n+        \/\/ Make sure we are not using @return tag on method with void return type.\n+        TypeMirror returnType = utils.getReturnType(writer.getCurrentPageElement(), (ExecutableElement) holder);\n@@ -96,3 +105,3 @@\n-        \/\/ it would also be good to check if there are more than one @return\n-        \/\/ tags and produce a warning or error similarly to how it's done\n-        \/\/ above for a case where @return is used for void\n+        if (!tags.isEmpty()) {\n+            return writer.returnTagOutput(holder, tags.get(0), false);\n+        }\n@@ -100,5 +109,5 @@\n-        var docFinder = utils.docFinder();\n-        return docFinder.search(method, m -> Result.fromOptional(extract(utils, m))).toOptional()\n-                .map(r -> writer.returnTagOutput(r.method, r.returnTree, false))\n-                .orElse(null);\n-    }\n+        \/\/ Check for inline tag in first sentence.\n+        List<? extends DocTree> firstSentence = utils.getFirstSentenceTrees(holder);\n+        if (firstSentence.size() == 1 && firstSentence.get(0).getKind() == DocTree.Kind.RETURN) {\n+            return writer.returnTagOutput(holder, (ReturnTree) firstSentence.get(0), false);\n+        }\n@@ -106,15 +115,7 @@\n-    private record Documentation(ReturnTree returnTree, ExecutableElement method) { }\n-\n-    private static Optional<Documentation> extract(Utils utils, ExecutableElement method) {\n-        \/\/ TODO\n-        \/\/  Using getBlockTags(..., Kind.RETURN) for clarity. Since @return has become a bimodal tag,\n-        \/\/  Utils.getReturnTrees is now a misnomer: it returns only block returns, not all returns.\n-        \/\/  We could revisit this later.\n-        Stream<? extends ReturnTree> blockTags = utils.getBlockTags(method, DocTree.Kind.RETURN, ReturnTree.class).stream();\n-        Stream<? extends ReturnTree> mainDescriptionTags = utils.getFirstSentenceTrees(method).stream()\n-                .mapMulti((t, c) -> {\n-                    if (t.getKind() == DocTree.Kind.RETURN) c.accept((ReturnTree) t);\n-                });\n-        \/\/ this method should not check validity of @return tags, hence findAny and not findFirst or what have you\n-        return Stream.concat(blockTags, mainDescriptionTags)\n-                .map(t -> new Documentation(t, method)).findAny();\n+        \/\/ Inherit @return tag if necessary.\n+        Input input = new DocFinder.Input(utils, holder, this);\n+        DocFinder.Output inheritedDoc = DocFinder.search(writer.configuration(), input);\n+        if (inheritedDoc.holderTag != null) {\n+            return writer.returnTagOutput(inheritedDoc.holder, (ReturnTree) inheritedDoc.holderTag, false);\n+        }\n+        return null;\n","filename":"src\/jdk.javadoc\/share\/classes\/jdk\/javadoc\/internal\/doclets\/toolkit\/taglets\/ReturnTaglet.java","additions":41,"deletions":40,"binary":false,"changes":81,"status":"modified"},{"patch":"@@ -30,1 +30,0 @@\n-import java.util.Optional;\n@@ -33,1 +32,0 @@\n-import javax.lang.model.element.ExecutableElement;\n@@ -38,1 +36,0 @@\n-import jdk.javadoc.internal.doclets.toolkit.BaseConfiguration;\n@@ -40,1 +37,3 @@\n-import jdk.javadoc.internal.doclets.toolkit.util.DocFinder.Result;\n+import jdk.javadoc.internal.doclets.toolkit.util.CommentHelper;\n+import jdk.javadoc.internal.doclets.toolkit.util.DocFinder;\n+import jdk.javadoc.internal.doclets.toolkit.util.DocFinder.Input;\n@@ -53,2 +52,10 @@\n-    public Output inherit(Element owner, DocTree tag, boolean isFirstSentence, BaseConfiguration configuration) {\n-        throw new UnsupportedOperationException(\"Not yet implemented\");\n+    public void inherit(DocFinder.Input input, DocFinder.Output output) {\n+        List<? extends SeeTree> tags = input.utils.getSeeTrees(input.element);\n+        if (!tags.isEmpty()) {\n+            CommentHelper ch = input.utils.getCommentHelper(input.element);\n+            output.holder = input.element;\n+            output.holderTag = tags.get(0);\n+            output.inlineTags = input.isFirstSentence\n+                    ? ch.getFirstSentenceTrees(output.holderTag)\n+                    : ch.getReference(output.holderTag);\n+        }\n@@ -62,8 +69,6 @@\n-        if (utils.isMethod(holder)) {\n-            var docFinder = utils.docFinder();\n-            Optional<Documentation> result = docFinder.search((ExecutableElement) holder,\n-                    m -> Result.fromOptional(extract(utils, m))).toOptional();\n-            if (result.isPresent()) {\n-                ExecutableElement m = result.get().method();\n-                tags = utils.getSeeTrees(m);\n-                e = m;\n+        if (tags.isEmpty() && utils.isMethod(holder)) {\n+            Input input = new DocFinder.Input(utils, holder, this);\n+            DocFinder.Output inheritedDoc = DocFinder.search(writer.configuration(), input);\n+            if (inheritedDoc.holder != null) {\n+                tags = utils.getSeeTrees(inheritedDoc.holder);\n+                e = inheritedDoc.holder;\n@@ -74,7 +79,0 @@\n-\n-    private record Documentation(List<? extends SeeTree> seeTrees, ExecutableElement method) { }\n-\n-    private static Optional<Documentation> extract(Utils utils, ExecutableElement method) {\n-        List<? extends SeeTree> tags = utils.getSeeTrees(method);\n-        return tags.isEmpty() ? Optional.empty() : Optional.of(new Documentation(tags, method));\n-    }\n","filename":"src\/jdk.javadoc\/share\/classes\/jdk\/javadoc\/internal\/doclets\/toolkit\/taglets\/SeeTaglet.java","additions":19,"deletions":21,"binary":false,"changes":40,"status":"modified"},{"patch":"@@ -30,1 +30,0 @@\n-import java.util.Optional;\n@@ -34,2 +33,0 @@\n-import javax.lang.model.element.ElementKind;\n-import javax.lang.model.element.ExecutableElement;\n@@ -40,1 +37,0 @@\n-import jdk.javadoc.internal.doclets.toolkit.BaseConfiguration;\n@@ -42,0 +38,1 @@\n+import jdk.javadoc.internal.doclets.toolkit.util.CommentHelper;\n@@ -43,1 +40,0 @@\n-import jdk.javadoc.internal.doclets.toolkit.util.DocFinder.Result;\n@@ -166,11 +162,9 @@\n-    public Output inherit(Element owner, DocTree tag, boolean isFirstSentence, BaseConfiguration configuration) {\n-        assert owner.getKind() == ElementKind.METHOD;\n-        assert !isFirstSentence;\n-        try {\n-            var docFinder = configuration.utils.docFinder();\n-            var r = docFinder.trySearch((ExecutableElement) owner,\n-                    m -> Result.fromOptional(extractFirst(m, configuration.utils))).toOptional();\n-            return r.map(result -> new Output(result.tag, result.method, result.description, true))\n-                    .orElseGet(()->new Output(null, null, List.of(), true));\n-        } catch (DocFinder.NoOverriddenMethodsFound e) {\n-            return new Output(null, null, List.of(), false);\n+    public void inherit(DocFinder.Input input, DocFinder.Output output) {\n+        List<? extends DocTree> tags = input.utils.getBlockTags(input.element, this);\n+        if (!tags.isEmpty()) {\n+            output.holder = input.element;\n+            output.holderTag = tags.get(0);\n+            CommentHelper ch = input.utils.getCommentHelper(output.holder);\n+            output.inlineTags = input.isFirstSentence\n+                    ? ch.getFirstSentenceTrees(output.holderTag)\n+                    : ch.getTags(output.holderTag);\n@@ -180,11 +174,0 @@\n-    record Documentation(DocTree tag, List<? extends DocTree> description, ExecutableElement method) { }\n-\n-    private Optional<Documentation> extractFirst(ExecutableElement m, Utils utils) {\n-        List<? extends DocTree> tags = utils.getBlockTags(m, this);\n-        if (tags.isEmpty()) {\n-            return Optional.empty();\n-        }\n-        DocTree t = tags.get(0);\n-        return Optional.of(new Documentation(t, utils.getCommentHelper(m).getDescription(t), m));\n-    }\n-\n","filename":"src\/jdk.javadoc\/share\/classes\/jdk\/javadoc\/internal\/doclets\/toolkit\/taglets\/SimpleTaglet.java","additions":10,"deletions":27,"binary":false,"changes":37,"status":"modified"},{"patch":"@@ -30,1 +30,0 @@\n-import java.util.Optional;\n@@ -32,1 +31,0 @@\n-import javax.lang.model.element.ExecutableElement;\n@@ -37,1 +35,0 @@\n-import jdk.javadoc.internal.doclets.toolkit.BaseConfiguration;\n@@ -39,1 +36,3 @@\n-import jdk.javadoc.internal.doclets.toolkit.util.DocFinder.Result;\n+import jdk.javadoc.internal.doclets.toolkit.util.CommentHelper;\n+import jdk.javadoc.internal.doclets.toolkit.util.DocFinder;\n+import jdk.javadoc.internal.doclets.toolkit.util.DocFinder.Input;\n@@ -52,2 +51,10 @@\n-    public Output inherit(Element owner, DocTree tag, boolean isFirstSentence, BaseConfiguration configuration) {\n-        throw new UnsupportedOperationException(\"Not yet implemented\");\n+    public void inherit(Input input, DocFinder.Output output) {\n+        List<? extends SpecTree> tags = input.utils.getSpecTrees(input.element);\n+        if (!tags.isEmpty()) {\n+            CommentHelper ch =  input.utils.getCommentHelper(input.element);\n+            output.holder = input.element;\n+            output.holderTag = tags.get(0);\n+            output.inlineTags = input.isFirstSentence\n+                    ? ch.getFirstSentenceTrees(output.holderTag)\n+                    : ch.getTags(output.holderTag);\n+        }\n@@ -61,8 +68,6 @@\n-        if (utils.isMethod(holder)) {\n-            var docFinder = utils.docFinder();\n-            Optional<Documentation> result = docFinder.search((ExecutableElement) holder,\n-                    m -> Result.fromOptional(extract(utils, m))).toOptional();\n-            if (result.isPresent()) {\n-                ExecutableElement m = result.get().method();\n-                tags = utils.getSpecTrees(m);\n-                e = m;\n+        if (tags.isEmpty() && utils.isExecutableElement(holder)) {\n+            Input input = new Input(utils, holder, this);\n+            DocFinder.Output inheritedDoc = DocFinder.search(writer.configuration(), input);\n+            if (inheritedDoc.holder != null) {\n+                tags = utils.getSpecTrees(inheritedDoc.holder);\n+                e = inheritedDoc.holder;\n@@ -73,7 +78,0 @@\n-\n-    private record Documentation(List<? extends SpecTree> seeTrees, ExecutableElement method) { }\n-\n-    private static Optional<Documentation> extract(Utils utils, ExecutableElement method) {\n-        List<? extends SpecTree> tags = utils.getSpecTrees(method);\n-        return tags.isEmpty() ? Optional.empty() : Optional.of(new Documentation(tags, method));\n-    }\n","filename":"src\/jdk.javadoc\/share\/classes\/jdk\/javadoc\/internal\/doclets\/toolkit\/taglets\/SpecTaglet.java","additions":19,"deletions":21,"binary":false,"changes":40,"status":"modified"},{"patch":"@@ -88,0 +88,5 @@\n+    \/**\n+     * The default separator for the simple tag option.\n+     *\/\n+    public static final char SIMPLE_TAGLET_OPT_SEPARATOR = ':';\n+\n@@ -596,1 +601,1 @@\n-        addStandardTaglet(new ThrowsTaglet(configuration), EXCEPTION);\n+        addStandardTaglet(new ThrowsTaglet(), EXCEPTION);\n","filename":"src\/jdk.javadoc\/share\/classes\/jdk\/javadoc\/internal\/doclets\/toolkit\/taglets\/TagletManager.java","additions":6,"deletions":1,"binary":false,"changes":7,"status":"modified"},{"patch":"@@ -226,0 +226,11 @@\n+    \/**\n+     * Returns the output for a {@code @throws} tag.\n+     *\n+     * @param element        The element that owns the doc comment\n+     * @param throwsTag      the throws tag\n+     * @param substituteType instantiated type of a generic type-variable, or null\n+     *\n+     * @return the output\n+     *\/\n+    protected abstract Content throwsTagOutput(Element element, ThrowsTree throwsTag, TypeMirror substituteType);\n+\n@@ -230,1 +241,0 @@\n-     * @param content    the optional content to add as a description\n@@ -234,1 +244,1 @@\n-    protected abstract Content throwsTagOutput(TypeMirror throwsType, Optional<Content> content);\n+    protected abstract Content throwsTagOutput(TypeMirror throwsType);\n","filename":"src\/jdk.javadoc\/share\/classes\/jdk\/javadoc\/internal\/doclets\/toolkit\/taglets\/TagletWriter.java","additions":12,"deletions":2,"binary":false,"changes":14,"status":"modified"},{"patch":"@@ -28,1 +28,1 @@\n-import java.util.Arrays;\n+import java.util.Collections;\n@@ -32,0 +32,1 @@\n+import java.util.Iterator;\n@@ -33,1 +34,0 @@\n-import java.util.LinkedList;\n@@ -35,1 +35,0 @@\n-import java.util.Locale;\n@@ -37,1 +36,0 @@\n-import java.util.Optional;\n@@ -43,3 +41,0 @@\n-import javax.lang.model.element.ModuleElement;\n-import javax.lang.model.element.PackageElement;\n-import javax.lang.model.element.QualifiedNameable;\n@@ -47,1 +42,0 @@\n-import javax.lang.model.element.TypeParameterElement;\n@@ -56,2 +50,0 @@\n-import jdk.javadoc.internal.doclets.formats.html.markup.ContentBuilder;\n-import jdk.javadoc.internal.doclets.toolkit.BaseConfiguration;\n@@ -60,2 +52,0 @@\n-import jdk.javadoc.internal.doclets.toolkit.util.DocFinder.Result;\n-import jdk.javadoc.internal.doclets.toolkit.util.Utils;\n@@ -64,2 +54,2 @@\n- * A taglet that processes {@link ThrowsTree}, which represents {@code @throws}\n- * and {@code @exception} tags, collectively referred to as exception tags.\n+ * A taglet that processes {@link ThrowsTree}, which represents\n+ * {@code @throws} and {@code @exception} tags.\n@@ -69,90 +59,1 @@\n-    \/*\n-     * Relevant bits from JLS\n-     * ======================\n-     *\n-     * This list is _incomplete_ because some parts cannot be summarized here\n-     * and require careful reading of JLS.\n-     *\n-     * 11.1.1 The Kinds of Exceptions\n-     *\n-     *   Throwable and all its subclasses are, collectively, the exception\n-     *   classes.\n-     *\n-     * 8.4.6 Method Throws\n-     *\n-     *   Throws:\n-     *     throws ExceptionTypeList\n-     *\n-     *   ExceptionTypeList:\n-     *     ExceptionType {, ExceptionType}\n-     *\n-     *   ExceptionType:\n-     *     ClassType\n-     *     TypeVariable\n-     *\n-     *   It is a compile-time error if an ExceptionType mentioned in a throws\n-     *   clause is not a subtype (4.10) of Throwable.\n-     *\n-     *   Type variables are allowed in a throws clause even though they are\n-     *   not allowed in a catch clause (14.20).\n-     *\n-     *   It is permitted but not required to mention unchecked exception\n-     *   classes (11.1.1) in a throws clause.\n-     *\n-     * 8.1.2 Generic Classes and Type Parameters\n-     *\n-     *   It is a compile-time error if a generic class is a direct or indirect\n-     *   subclass of Throwable.\n-     *\n-     * 8.8.5. Constructor Throws\n-     *\n-     *   The throws clause for a constructor is identical in structure and\n-     *   behavior to the throws clause for a method (8.4.6).\n-     *\n-     * 8.8. Constructor Declarations\n-     *\n-     *   Constructor declarations are ... never inherited and therefore are not\n-     *   subject to hiding or overriding.\n-     *\n-     * 8.4.4. Generic Methods\n-     *\n-     *   A method is generic if it declares one or more type variables (4.4).\n-     *   These type variables are known as the type parameters of the method.\n-     *\n-     *   ...\n-     *\n-     *   Two methods or constructors M and N have the same type parameters if\n-     *   both of the following are true:\n-     *\n-     *      - M and N have same number of type parameters (possibly zero).\n-     *      ...\n-     *\n-     * 8.4.2. Method Signature\n-     *\n-     *   Two methods or constructors, M and N, have the same signature if they\n-     *   have ... the same type parameters (if any) (8.4.4) ...\n-     *   ...\n-     *   The signature of a method m1 is a subsignature of the signature of\n-     *   a method m2 if either:\n-     *\n-     *     - m2 has the same signature as m1, or\n-     *     - the signature of m1 is the same as the erasure (4.6) of the\n-     *       signature of m2.\n-     *\n-     *   Two method signatures m1 and m2 are override-equivalent iff either\n-     *   m1 is a subsignature of m2 or m2 is a subsignature of m1.\n-     *\n-     * 8.4.8.1. Overriding (by Instance Methods)\n-     *\n-     *   An instance method mC declared in or inherited by class C, overrides\n-     *   from C another method mA declared in class A, iff all of the following\n-     *   are true:\n-     *\n-     *     ...\n-     *     - The signature of mC is a subsignature (8.4.2) of the signature of\n-     *       mA as a member of the supertype of C that names A.\n-     *\/\n-\n-    public ThrowsTaglet(BaseConfiguration configuration) {\n-        \/\/ of all language elements only constructors and methods can declare\n-        \/\/ thrown exceptions and, hence, document them\n+    public ThrowsTaglet() {\n@@ -160,2 +61,0 @@\n-        this.configuration = configuration;\n-        this.utils = this.configuration.utils;\n@@ -164,3 +63,0 @@\n-    private final BaseConfiguration configuration;\n-    private final Utils utils;\n-\n@@ -168,7 +64,13 @@\n-    public Output inherit(Element owner, DocTree tag, boolean isFirstSentence, BaseConfiguration configuration) {\n-        \/\/ This method shouldn't be called because {@inheritDoc} tags inside\n-        \/\/ exception tags aren't dealt with individually. {@inheritDoc} tags\n-        \/\/ inside exception tags are collectively dealt with in\n-        \/\/ getAllBlockTagOutput.\n-        throw newAssertionError(owner, tag, isFirstSentence);\n-    }\n+    public void inherit(DocFinder.Input input, DocFinder.Output output) {\n+        var utils = input.utils;\n+        Element target;\n+        var ch = utils.getCommentHelper(input.element);\n+        if (input.tagId == null) {\n+            var tag = (ThrowsTree) input.docTreeInfo.docTree();\n+            target = ch.getException(tag);\n+            input.tagId = target == null\n+                    ? tag.getExceptionName().getSignature()\n+                    : utils.getFullyQualifiedName(target);\n+        } else {\n+            target = input.utils.findClass(input.element, input.tagId);\n+        }\n@@ -176,26 +78,14 @@\n-    @Override\n-    public Content getAllBlockTagOutput(Element holder, TagletWriter writer) {\n-        try {\n-            return getAllBlockTagOutput0(holder, writer);\n-        } catch (Failure f) {\n-            \/\/ note that `f.holder()` is not necessarily the same as `holder`\n-            var ch = utils.getCommentHelper(f.holder());\n-            var messages = configuration.getMessages();\n-            if (f instanceof Failure.ExceptionTypeNotFound e) {\n-                var path = ch.getDocTreePath(e.tag().getExceptionName());\n-                messages.warning(path, \"doclet.throws.reference_not_found\");\n-            } else if (f instanceof Failure.NotExceptionType e) {\n-                var path = ch.getDocTreePath(e.tag().getExceptionName());\n-                \/\/ output the type we found to help the user diagnose the issue\n-                messages.warning(path, \"doclet.throws.reference_bad_type\", diagnosticDescriptionOf(e.type()));\n-            } else if (f instanceof Failure.Invalid e) {\n-                messages.error(ch.getDocTreePath(e.tag()), \"doclet.inheritDocWithinInappropriateTag\");\n-            } else if (f instanceof Failure.UnsupportedTypeParameter e) {\n-                var path = ch.getDocTreePath(e.tag().getExceptionName());\n-                messages.warning(path, \"doclet.throwsInheritDocUnsupported\");\n-            } else if (f instanceof Failure.Undocumented e) {\n-                messages.warning(ch.getDocTreePath(e.tag()), \"doclet.inheritDocNoDoc\", diagnosticDescriptionOf(e.exceptionElement));\n-            } else {\n-                \/\/ TODO: instead of if-else, use pattern matching for switch for both\n-                \/\/  readability and exhaustiveness when it's available\n-                throw newAssertionError(f);\n+        \/\/ TODO warn if target == null as we cannot guarantee type-match, but at most FQN-match.\n+\n+        for (ThrowsTree tag : input.utils.getThrowsTrees(input.element)) {\n+            Element candidate = ch.getException(tag);\n+            if (candidate != null && (input.tagId.equals(utils.getSimpleName(candidate)) ||\n+                    (input.tagId.equals(utils.getFullyQualifiedName(candidate))))) {\n+                output.holder = input.element;\n+                output.holderTag = tag;\n+                output.inlineTags = ch.getBody(output.holderTag);\n+                output.tagList.add(tag);\n+            } else if (target != null && candidate != null &&\n+                    utils.isTypeElement(candidate) && utils.isTypeElement(target) &&\n+                    utils.isSubclassOf((TypeElement) candidate, (TypeElement) target)) {\n+                output.tagList.add(tag);\n@@ -203,6 +93,0 @@\n-        } catch (DocFinder.NoOverriddenMethodsFound e) {\n-            \/\/ since {@inheritDoc} in @throws is processed by ThrowsTaglet (this taglet) rather than\n-            \/\/ InheritDocTaglet, we have to duplicate some of the behavior of the latter taglet\n-            String signature = utils.getSimpleName(holder)\n-                    + utils.flatSignature((ExecutableElement) holder, writer.getCurrentPageElement());\n-            configuration.getMessages().warning(holder, \"doclet.noInheritedDoc\", signature);\n@@ -210,1 +94,0 @@\n-        return writer.getOutputInstance(); \/\/ TODO: consider invalid rather than empty output\n@@ -213,16 +96,3 @@\n-    private Content getAllBlockTagOutput0(Element holder,\n-                                          TagletWriter writer)\n-            throws Failure.ExceptionTypeNotFound,\n-                   Failure.NotExceptionType,\n-                   Failure.Invalid,\n-                   Failure.Undocumented,\n-                   Failure.UnsupportedTypeParameter,\n-                   DocFinder.NoOverriddenMethodsFound\n-    {\n-        ElementKind kind = holder.getKind();\n-        if (kind != ElementKind.METHOD && kind != ElementKind.CONSTRUCTOR) {\n-            \/\/ Elements are processed by applicable taglets only. This taglet\n-            \/\/ is only applicable to executable elements such as methods\n-            \/\/ and constructors.\n-            throw newAssertionError(holder, kind);\n-        }\n+    @Override\n+    public Content getAllBlockTagOutput(Element holder, TagletWriter writer) {\n+        var utils = writer.configuration().utils;\n@@ -232,3 +102,2 @@\n-        List<? extends TypeMirror> substitutedExceptionTypes = instantiatedType.getThrownTypes();\n-        List<? extends TypeMirror> originalExceptionTypes = executable.getThrownTypes();\n-        Map<TypeMirror, TypeMirror> typeSubstitutions = getSubstitutedThrownTypes(\n+        List<? extends TypeMirror> thrownTypes = instantiatedType.getThrownTypes();\n+        Map<String, TypeMirror> typeSubstitutions = getSubstitutedThrownTypes(\n@@ -236,74 +105,10 @@\n-                originalExceptionTypes,\n-                substitutedExceptionTypes);\n-        var exceptionSection = new ExceptionSectionBuilder(writer);\n-        \/\/ Step 1: Document exception tags\n-        Set<TypeMirror> alreadyDocumentedExceptions = new HashSet<>();\n-        List<ThrowsTree> exceptionTags = utils.getThrowsTrees(executable);\n-        for (ThrowsTree t : exceptionTags) {\n-            Element exceptionElement = getExceptionType(t, executable);\n-            outputAnExceptionTagDeeply(exceptionSection, exceptionElement, t, executable, alreadyDocumentedExceptions, typeSubstitutions, writer);\n-        }\n-        \/\/ Step 2: Document exception types from the `throws` clause (of a method)\n-        \/\/\n-        \/\/ While methods can be inherited and overridden, constructors can be neither of those (JLS 8.8).\n-        \/\/ Therefore, it's only methods that participate in Step 2, which is about inheriting exception\n-        \/\/ documentation from ancestors.\n-        if (executable.getKind() == ElementKind.METHOD) {\n-            for (TypeMirror exceptionType : substitutedExceptionTypes) {\n-                Element exceptionElement = utils.typeUtils.asElement(exceptionType);\n-                Map<ThrowsTree, ExecutableElement> r;\n-                try {\n-                    r = expandShallowly(exceptionElement, executable);\n-                } catch (Failure | DocFinder.NoOverriddenMethodsFound e) {\n-                    \/\/ Ignore errors here because unlike @throws tags, the `throws` clause is implicit\n-                    \/\/ documentation inheritance. It triggers a best-effort attempt to inherit\n-                    \/\/ documentation. If there are errors in ancestors, they will likely be caught\n-                    \/\/ once those ancestors are documented.\n-                    continue;\n-                }\n-                if (r.isEmpty()) {\n-                    \/\/ `exceptionType` is not documented by any tags from ancestors, skip it till Step 3\n-                    continue;\n-                }\n-                if (!alreadyDocumentedExceptions.add(exceptionType)) {\n-                    \/\/ it expands to something that has to have been documented on Step 1, skip\n-                    continue;\n-                }\n-                for (Map.Entry<ThrowsTree, ExecutableElement> e : r.entrySet()) {\n-                    outputAnExceptionTagDeeply(exceptionSection, exceptionElement, e.getKey(), e.getValue(), alreadyDocumentedExceptions, typeSubstitutions, writer);\n-                }\n-            }\n-        }\n-        \/\/ Step 3: List those exceptions from the `throws` clause for which no documentation was found on Step 2\n-        for (TypeMirror e : substitutedExceptionTypes) {\n-            if (!alreadyDocumentedExceptions.add(e)) {\n-                continue;\n-            }\n-            exceptionSection.beginEntry(e);\n-            \/\/ this JavaDoc warning is similar to but different from that of DocLint:\n-            \/\/     dc.missing.throws = no @throws for {0}\n-            \/\/ TODO: comment out for now and revisit later;\n-            \/\/  commented out because of the generated noise for readObject\/writeObject for serialized-form.html:\n-            \/\/    exceptionSection.continueEntry(writer.invalidTagOutput(configuration.getDocResources().getText(\"doclet.throws.undocumented\", e), Optional.empty()));\n-            \/\/    configuration.getMessages().warning(holder, \"doclet.throws.undocumented\", e);\n-            exceptionSection.endEntry();\n-        }\n-        assert alreadyDocumentedExceptions.containsAll(substitutedExceptionTypes);\n-        return exceptionSection.build();\n-    }\n-\n-    private void outputAnExceptionTagDeeply(ExceptionSectionBuilder exceptionSection,\n-                                            Element originalExceptionElement,\n-                                            ThrowsTree tag,\n-                                            ExecutableElement holder,\n-                                            Set<TypeMirror> alreadyDocumentedExceptions,\n-                                            Map<TypeMirror, TypeMirror> typeSubstitutions,\n-                                            TagletWriter writer)\n-            throws Failure.ExceptionTypeNotFound,\n-                   Failure.NotExceptionType,\n-                   Failure.Invalid,\n-                   Failure.Undocumented,\n-                   Failure.UnsupportedTypeParameter,\n-                   DocFinder.NoOverriddenMethodsFound\n-    {\n-        outputAnExceptionTagDeeply(exceptionSection, originalExceptionElement, tag, holder, true, alreadyDocumentedExceptions, typeSubstitutions, writer);\n+                executable.getThrownTypes(),\n+                thrownTypes);\n+        Map<ThrowsTree, ExecutableElement> tagsMap = new LinkedHashMap<>();\n+        utils.getThrowsTrees(executable).forEach(t -> tagsMap.put(t, executable));\n+        Content result = writer.getOutputInstance();\n+        Set<String> alreadyDocumented = new HashSet<>();\n+        result.add(throwsTagsOutput(tagsMap, alreadyDocumented, typeSubstitutions, writer));\n+        result.add(inheritThrowsDocumentation(executable, thrownTypes, alreadyDocumented, typeSubstitutions, writer));\n+        result.add(linkToUndocumentedDeclaredExceptions(thrownTypes, alreadyDocumented, writer));\n+        return result;\n@@ -312,107 +117,20 @@\n-    private void outputAnExceptionTagDeeply(ExceptionSectionBuilder exceptionSection,\n-                                            Element originalExceptionElement,\n-                                            ThrowsTree tag,\n-                                            ExecutableElement holder,\n-                                            boolean beginNewEntry,\n-                                            Set<TypeMirror> alreadyDocumentedExceptions,\n-                                            Map<TypeMirror, TypeMirror> typeSubstitutions,\n-                                            TagletWriter writer)\n-            throws Failure.ExceptionTypeNotFound,\n-                   Failure.NotExceptionType,\n-                   Failure.Invalid,\n-                   Failure.Undocumented,\n-                   Failure.UnsupportedTypeParameter,\n-                   DocFinder.NoOverriddenMethodsFound\n-    {\n-        var originalExceptionType = originalExceptionElement.asType();\n-        var exceptionType = typeSubstitutions.getOrDefault(originalExceptionType, originalExceptionType); \/\/ FIXME: ugh..........\n-        alreadyDocumentedExceptions.add(exceptionType);\n-        var description = tag.getDescription();\n-        int i = indexOfInheritDoc(tag, holder);\n-        if (i == -1) {\n-            \/\/ Since the description does not contain {@inheritDoc}, we either add a new entry, or\n-            \/\/ append to the current one. Here's an example of when we add a new entry:\n-            \/\/\n-            \/\/     ... -> {@inheritDoc} -> <text>\n-            \/\/\n-            \/\/ And here's an example of when we append to the current entry:\n-            \/\/\n-            \/\/     ... -> <text> {@inheritDoc} <text> -> <text>\n-\n-            \/\/ if we don't need to add a new entry, assume it has been added before\n-            assert exceptionSection.debugEntryBegun() || beginNewEntry;\n-            if (beginNewEntry) { \/\/ add a new entry?\n-                \/\/ originalExceptionElement might be different from that that triggers this entry: for example, a\n-                \/\/ renamed exception-type type parameter\n-                exceptionSection.beginEntry(exceptionType);\n-            }\n-            \/\/ append to the current entry\n-            exceptionSection.continueEntry(writer.commentTagsToOutput(holder, description));\n-            if (beginNewEntry) { \/\/ if added a new entry, end it\n-                exceptionSection.endEntry();\n-            }\n-        } else { \/\/ expand a single {@inheritDoc}\n-            assert holder.getKind() == ElementKind.METHOD : holder.getKind(); \/\/ only methods can use {@inheritDoc}\n-            \/\/ Is the {@inheritDoc} that we found standalone (i.e. without preceding and following text)?\n-            boolean loneInheritDoc = description.size() == 1;\n-            assert !loneInheritDoc || i == 0 : i;\n-            boolean add = !loneInheritDoc && beginNewEntry;\n-            \/\/ we add a new entry if the {@inheritDoc} that we found has something else around\n-            \/\/ it and we can add a new entry (as instructed by the parent call)\n-            if (add) {\n-                exceptionSection.beginEntry(exceptionType);\n-            }\n-            if (i > 0) {\n-                \/\/ if there's anything preceding {@inheritDoc}, assume an entry has been added before\n-                assert exceptionSection.debugEntryBegun();\n-                Content beforeInheritDoc = writer.commentTagsToOutput(holder, description.subList(0, i));\n-                exceptionSection.continueEntry(beforeInheritDoc);\n-            }\n-            Map<ThrowsTree, ExecutableElement> tags;\n-            try {\n-                tags = expandShallowly(originalExceptionElement, holder);\n-            } catch (Failure.UnsupportedTypeParameter e) {\n-                \/\/ repack to fill in missing tag information\n-                throw new Failure.UnsupportedTypeParameter(e.element, tag, holder);\n-            }\n-            if (tags.isEmpty()) {\n-                throw new Failure.Undocumented(tag, holder, originalExceptionElement);\n-            }\n-            \/\/ if {@inheritDoc} is the only tag in the @throws description and\n-            \/\/ this call can add new entries to the exception section,\n-            \/\/ so can the recursive call\n-            boolean addNewEntryRecursively = beginNewEntry && !add;\n-            if (!addNewEntryRecursively && tags.size() > 1) {\n-                \/\/ current tag has more to description than just {@inheritDoc}\n-                \/\/ and thus cannot expand to multiple tags;\n-                \/\/ it's likely a documentation error\n-                throw new Failure.Invalid(tag, holder);\n-            }\n-            for (Map.Entry<ThrowsTree, ExecutableElement> e : tags.entrySet()) {\n-                outputAnExceptionTagDeeply(exceptionSection, originalExceptionElement, e.getKey(), e.getValue(), addNewEntryRecursively, alreadyDocumentedExceptions, typeSubstitutions, writer);\n-            }\n-            \/\/ this might be an empty list, which is fine\n-            if (!loneInheritDoc) {\n-                Content afterInheritDoc = writer.commentTagsToOutput(holder, description.subList(i + 1, description.size()));\n-                exceptionSection.continueEntry(afterInheritDoc);\n-            }\n-            if (add) {\n-                exceptionSection.endEntry();\n-            }\n-        }\n-    }\n-\n-    private static int indexOfInheritDoc(ThrowsTree tag, ExecutableElement holder)\n-            throws Failure.Invalid\n-    {\n-        var description = tag.getDescription();\n-        int i = -1;\n-        for (var iterator = description.listIterator(); iterator.hasNext(); ) {\n-            DocTree t = iterator.next();\n-            if (t.getKind() == DocTree.Kind.INHERIT_DOC) {\n-                if (i != -1) {\n-                    \/\/ an exception tag description contains more than one {@inheritDoc};\n-                    \/\/ we consider it nonsensical and, hence, a documentation error\n-                    throw new Failure.Invalid(t, holder);\n-                }\n-                i = iterator.previousIndex();\n+    \/**\n+     * Returns a map of substitutions for a list of thrown types with the original type-variable\n+     * name as a key and the instantiated type as a value. If no types need to be substituted\n+     * an empty map is returned.\n+     * @param declaredThrownTypes the originally declared thrown types.\n+     * @param instantiatedThrownTypes the thrown types in the context of the current type.\n+     * @return map of declared to instantiated thrown types or an empty map.\n+     *\/\n+    private Map<String, TypeMirror> getSubstitutedThrownTypes(Types types,\n+                                                              List<? extends TypeMirror> declaredThrownTypes,\n+                                                              List<? extends TypeMirror> instantiatedThrownTypes) {\n+        if (!declaredThrownTypes.equals(instantiatedThrownTypes)) {\n+            Map<String, TypeMirror> map = new HashMap<>();\n+            Iterator<? extends TypeMirror> i1 = declaredThrownTypes.iterator();\n+            Iterator<? extends TypeMirror> i2 = instantiatedThrownTypes.iterator();\n+            while (i1.hasNext() && i2.hasNext()) {\n+                TypeMirror t1 = i1.next();\n+                TypeMirror t2 = i2.next();\n+                if (!types.isSameType(t1, t2))\n+                    map.put(t1.toString(), t2);\n@@ -420,0 +138,1 @@\n+            return map;\n@@ -421,28 +140,1 @@\n-        return i;\n-    }\n-\n-    private Element getExceptionType(ThrowsTree tag, ExecutableElement holder)\n-            throws Failure.ExceptionTypeNotFound, Failure.NotExceptionType\n-    {\n-        Element e = utils.getCommentHelper(holder).getException(tag);\n-        if (e == null) {\n-            throw new Failure.ExceptionTypeNotFound(tag, holder);\n-        }\n-        \/\/ translate to a type mirror to perform a subtype test, which covers not only\n-        \/\/ classes (e.g. class X extends Exception) but also type variables\n-        \/\/ (e.g. <X extends Exception>)\n-        var t = e.asType();\n-        var subtypeTestInapplicable = switch (t.getKind()) {\n-            case EXECUTABLE, PACKAGE, MODULE -> true;\n-            default -> false;\n-        };\n-        if (subtypeTestInapplicable || !utils.typeUtils.isSubtype(t, utils.getThrowableType())) {\n-            \/\/ Aside from documentation errors, this condition might arise if the\n-            \/\/ source cannot be compiled or element we found is not what the\n-            \/\/ documentation author intended. Whatever the reason is (e.g.\n-            \/\/ see 8295543), we should not process such an element.\n-            throw new Failure.NotExceptionType(tag, holder, e);\n-        }\n-        var k = e.getKind();\n-        assert k == ElementKind.CLASS || k == ElementKind.TYPE_PARAMETER : k; \/\/ JLS 8.4.6\n-        return e;\n+        return Map.of();\n@@ -451,43 +143,30 @@\n-    @SuppressWarnings(\"serial\")\n-    private static sealed class Failure extends Exception {\n-\n-        private final DocTree tag;\n-        private final ExecutableElement holder;\n-\n-        Failure(DocTree tag, ExecutableElement holder) {\n-            super();\n-            this.tag = tag;\n-            this.holder = holder;\n-        }\n-\n-        DocTree tag() { return tag; }\n-\n-        ExecutableElement holder() { return holder; }\n-\n-        static final class ExceptionTypeNotFound extends Failure {\n-\n-            ExceptionTypeNotFound(ThrowsTree tag, ExecutableElement holder) {\n-                super(tag, holder);\n-            }\n-\n-            @Override ThrowsTree tag() { return (ThrowsTree) super.tag(); }\n-        }\n-\n-        static final class NotExceptionType extends Failure {\n-\n-            private final Element type;\n-\n-            public NotExceptionType(ThrowsTree tag, ExecutableElement holder, Element type) {\n-                super(tag, holder);\n-                this.type = type;\n-            }\n-\n-            Element type() { return type; }\n-\n-            @Override ThrowsTree tag() { return (ThrowsTree) super.tag(); }\n-        }\n-\n-        static final class Invalid extends Failure {\n-\n-            public Invalid(DocTree tag, ExecutableElement holder) {\n-                super(tag, holder);\n+    \/**\n+     * Returns the generated content for a collection of {@code @throws} tags.\n+     *\n+     * @param throwsTags        the tags to be converted; each tag is mapped to\n+     *                          a method it appears on\n+     * @param alreadyDocumented the set of exceptions that have already been\n+     *                          documented and thus must not be documented by\n+     *                          this method. All exceptions documented by this\n+     *                          method will be added to this set upon the\n+     *                          method's return.\n+     * @param writer            the taglet-writer used by the doclet\n+     * @return the generated content for the tags\n+     *\/\n+    private Content throwsTagsOutput(Map<ThrowsTree, ExecutableElement> throwsTags,\n+                                     Set<String> alreadyDocumented,\n+                                     Map<String, TypeMirror> typeSubstitutions,\n+                                     TagletWriter writer) {\n+        var utils = writer.configuration().utils;\n+        Content result = writer.getOutputInstance();\n+        var documentedInThisCall = new HashSet<String>();\n+        Map<ThrowsTree, ExecutableElement> flattenedExceptions = flatten(throwsTags, writer);\n+        flattenedExceptions.forEach((ThrowsTree t, ExecutableElement e) -> {\n+            var ch = utils.getCommentHelper(e);\n+            Element te = ch.getException(t);\n+            String excName = t.getExceptionName().toString();\n+            TypeMirror substituteType = typeSubstitutions.get(excName);\n+            if (alreadyDocumented.contains(excName)\n+                    || (te != null && alreadyDocumented.contains(utils.getFullyQualifiedName(te, false)))\n+                    || (substituteType != null && alreadyDocumented.contains(substituteType.toString()))) {\n+                return;\n@@ -495,9 +174,2 @@\n-        }\n-\n-        static final class Undocumented extends Failure {\n-\n-            private final Element exceptionElement;\n-\n-            public Undocumented(DocTree tag, ExecutableElement holder, Element exceptionElement) {\n-                super(tag, holder);\n-                this.exceptionElement = exceptionElement;\n+            if (alreadyDocumented.isEmpty() && documentedInThisCall.isEmpty()) {\n+                result.add(writer.getThrowsHeader());\n@@ -505,10 +177,7 @@\n-        }\n-\n-        static final class UnsupportedTypeParameter extends Failure {\n-\n-            private final Element element;\n-\n-            \/\/ careful: tag might be null\n-            public UnsupportedTypeParameter(Element element, ThrowsTree tag, ExecutableElement holder) {\n-                super(tag, holder);\n-                this.element = element;\n+            result.add(writer.throwsTagOutput(e, t, substituteType));\n+            if (substituteType != null) {\n+                documentedInThisCall.add(substituteType.toString());\n+            } else {\n+                documentedInThisCall.add(te != null\n+                        ? utils.getFullyQualifiedName(te, false)\n+                        : excName);\n@@ -516,3 +185,3 @@\n-\n-            @Override ThrowsTree tag() { return (ThrowsTree) super.tag(); }\n-        }\n+        });\n+        alreadyDocumented.addAll(documentedInThisCall);\n+        return result;\n@@ -522,5 +191,2 @@\n-     * Returns immediately inherited tags that document the provided exception type.\n-     *\n-     * A map associates a doc tree with its holder element externally. Such maps\n-     * have defined iteration order of entries, whose keys and values\n-     * are non-null.\n+     * A single @throws tag from an overriding method can correspond to multiple\n+     * @throws tags from an overridden method.\n@@ -528,54 +194,9 @@\n-    private Map<ThrowsTree, ExecutableElement> expandShallowly(Element exceptionType,\n-                                                               ExecutableElement holder)\n-            throws Failure.ExceptionTypeNotFound,\n-                   Failure.NotExceptionType,\n-                   Failure.Invalid,\n-                   Failure.UnsupportedTypeParameter,\n-                   DocFinder.NoOverriddenMethodsFound\n-    {\n-        ElementKind kind = exceptionType.getKind();\n-        DocFinder.Criterion<Map<ThrowsTree, ExecutableElement>, Failure> criterion;\n-        if (kind == ElementKind.CLASS) {\n-            criterion = method -> {\n-                var tags = findByTypeElement(exceptionType, method);\n-                return toResult(exceptionType, method, tags);\n-            };\n-        } else {\n-            \/\/ Type parameters declared by a method are matched by position; the basis for\n-            \/\/ such position matching is JLS sections 8.4.2 and 8.4.4. We don't match\n-            \/\/ type parameters not declared by a method (e.g. declared by the\n-            \/\/ enclosing class or interface) because\n-            criterion = method -> {\n-                \/\/ TODO: add a test for the throws clause mentioning\n-                \/\/  a type parameter which is not declared by holder\n-                int i = holder.getTypeParameters().indexOf((TypeParameterElement) exceptionType);\n-                if (i == -1) { \/\/ the type parameter is not declared by `holder`\n-                    throw new Failure.UnsupportedTypeParameter(exceptionType, null \/* don't know if tag-related *\/, holder);\n-                }\n-                \/\/ if one method overrides the other, then those methods must\n-                \/\/ have the same number of type parameters (JLS 8.4.2)\n-                assert utils.elementUtils.overrides(holder, method, (TypeElement) holder.getEnclosingElement());\n-                var typeParameterElement = method.getTypeParameters().get(i);\n-                var tags = findByTypeElement(typeParameterElement, method);\n-                return toResult(exceptionType, method, tags);\n-            };\n-        }\n-        Result<Map<ThrowsTree, ExecutableElement>> result;\n-        try {\n-            result = utils.docFinder().trySearch(holder, criterion);\n-        } catch (Failure.NotExceptionType\n-                 | Failure.ExceptionTypeNotFound\n-                 | Failure.UnsupportedTypeParameter x) {\n-            \/\/ Here's why we do this ugly exception processing: the language does not allow us to\n-            \/\/ instantiate the exception type parameter in criterion with a union of specific\n-            \/\/ exceptions (i.e. Failure.ExceptionTypeNotFound | Failure.NotExceptionType),\n-            \/\/ so we instantiate it with a general Failure. We then refine the specific\n-            \/\/ exception being thrown, from the general exception we caught.\n-            throw x;\n-        } catch (Failure f) {\n-            throw newAssertionError(f);\n-        }\n-        if (result instanceof Result.Conclude<Map<ThrowsTree, ExecutableElement>> c) {\n-            return c.value();\n-        }\n-        return Map.of(); \/\/ an empty map is effectively ordered\n+    private Map<ThrowsTree, ExecutableElement> flatten(Map<ThrowsTree, ExecutableElement> throwsTags,\n+                                                       TagletWriter writer) {\n+        Map<ThrowsTree, ExecutableElement> result = new LinkedHashMap<>();\n+        throwsTags.forEach((tag, taggedElement) -> {\n+            var expandedTags = expand(tag, taggedElement, writer);\n+            assert Collections.disjoint(result.entrySet(), expandedTags.entrySet());\n+            result.putAll(expandedTags);\n+        });\n+        return result;\n@@ -584,21 +205,3 @@\n-    private static Result<Map<ThrowsTree, ExecutableElement>> toResult(Element target,\n-                                                                       ExecutableElement holder,\n-                                                                       List<ThrowsTree> tags) {\n-        if (!tags.isEmpty()) {\n-            \/\/ if there are tags for the target exception type, conclude search successfully\n-            return Result.CONCLUDE(toExceptionTags(holder, tags));\n-        }\n-        return Result.CONTINUE();\n-\/\/ TODO: reintroduce this back for JDK-8295800:\n-\/\/        if (holder.getThrownTypes().contains(target.asType())) {\n-\/\/            \/\/ if there are no tags for the target exception type, BUT that type is\n-\/\/            \/\/ mentioned in the `throws` clause, continue search\n-\/\/            return Result.CONTINUE();\n-\/\/        }\n-\/\/        \/\/ there are no tags for the target exception type AND that type is not\n-\/\/        \/\/ mentioned in the `throws` clause, skip search on the remaining part\n-\/\/        \/\/ of the current branch of the hierarchy\n-\/\/        \/\/ TODO: expand on this and add a test in JDK-8295800;\n-\/\/        \/\/  for both checked and unchecked exceptions\n-\/\/        return Result.SKIP();\n-    }\n+    private Map<ThrowsTree, ExecutableElement> expand(ThrowsTree tag,\n+                                                      ExecutableElement e,\n+                                                      TagletWriter writer) {\n@@ -606,41 +209,3 @@\n-    \/*\n-     * Associates exception tags with their holder.\n-     *\n-     * Such a map is used as a data structure to pass around methods that output tags to content.\n-     *\/\n-    private static Map<ThrowsTree, ExecutableElement> toExceptionTags(ExecutableElement holder,\n-                                                                      List<ThrowsTree> tags)\n-    {\n-        \/\/ preserve the tag order using the linked hash map\n-        var map = new LinkedHashMap<ThrowsTree, ExecutableElement>();\n-        for (var t : tags) {\n-            var prev = map.put(t, holder);\n-            assert prev == null; \/\/ there should be no equal exception tags\n-        }\n-        return map;\n-    }\n-\n-    private List<ThrowsTree> findByTypeElement(Element targetExceptionType,\n-                                               ExecutableElement executable)\n-            throws Failure.ExceptionTypeNotFound,\n-                   Failure.NotExceptionType\n-    {\n-        var result = new LinkedList<ThrowsTree>();\n-        for (ThrowsTree t : utils.getThrowsTrees(executable)) {\n-            Element candidate = getExceptionType(t, executable);\n-            if (targetExceptionType.equals(candidate)) {\n-                result.add(t);\n-            }\n-        }\n-        return List.copyOf(result);\n-    }\n-\n-    \/*\n-     * An exception section (that is, the \"Throws:\" section in the Method\n-     * or Constructor Details section) builder.\n-     *\n-     * The section is being built sequentially from top to bottom.\n-     *\n-     * Adapts one-off methods of writer to continuous building.\n-     *\/\n-    private static class ExceptionSectionBuilder {\n+        \/\/ This method uses Map.of() to create maps of size zero and one.\n+        \/\/ While such maps are effectively ordered, the syntax is more\n+        \/\/ compact than that of LinkedHashMap.\n@@ -648,39 +213,4 @@\n-        private final TagletWriter writer;\n-        private final Content result;\n-        private ContentBuilder current;\n-        private boolean began;\n-        private boolean headerAdded;\n-        private TypeMirror exceptionType;\n-\n-        ExceptionSectionBuilder(TagletWriter writer) {\n-            this.writer = writer;\n-            this.result = writer.getOutputInstance();\n-        }\n-\n-        void beginEntry(TypeMirror exceptionType) {\n-            if (began) {\n-                throw new IllegalStateException();\n-            }\n-            began = true;\n-            current = new ContentBuilder();\n-            this.exceptionType = exceptionType;\n-        }\n-\n-        void continueEntry(Content c) {\n-            if (!began) {\n-                throw new IllegalStateException();\n-            }\n-            current.add(c);\n-        }\n-\n-        public void endEntry() {\n-            if (!began) {\n-                throw new IllegalStateException();\n-            }\n-            began = false;\n-            if (!headerAdded) {\n-                headerAdded = true;\n-                result.add(writer.getThrowsHeader());\n-            }\n-            result.add(writer.throwsTagOutput(exceptionType, current.isEmpty() ? Optional.empty() : Optional.of(current)));\n-            current = null;\n+        \/\/ peek into @throws description\n+        if (tag.getDescription().stream().noneMatch(d -> d.getKind() == DocTree.Kind.INHERIT_DOC)) {\n+            \/\/ nothing to inherit\n+            return Map.of(tag, e);\n@@ -688,3 +218,5 @@\n-\n-        Content build() {\n-            return result;\n+        var input = new DocFinder.Input(writer.configuration().utils, e, this, new DocFinder.DocTreeInfo(tag, e), false, true);\n+        var output = DocFinder.search(writer.configuration(), input);\n+        if (output.tagList.size() <= 1) {\n+            \/\/ outer code will handle this trivial case of inheritance\n+            return Map.of(tag, e);\n@@ -692,4 +224,6 @@\n-\n-        \/\/ for debugging purposes only\n-        boolean debugEntryBegun() {\n-            return began;\n+        if (tag.getDescription().size() > 1) {\n+            \/\/ there's more to description than just {@inheritDoc}\n+            \/\/ it's likely a documentation error\n+            var ch = writer.configuration().utils.getCommentHelper(e);\n+            writer.configuration().getMessages().error(ch.getDocTreePath(tag), \"doclet.inheritDocWithinInappropriateTag\");\n+            return Map.of();\n@@ -697,0 +231,3 @@\n+        Map<ThrowsTree, ExecutableElement> tags = new LinkedHashMap<>();\n+        output.tagList.forEach(t -> tags.put((ThrowsTree) t, (ExecutableElement) output.holder));\n+        return tags;\n@@ -700,6 +237,2 @@\n-     * Returns a map of substitutions for a list of thrown types with the original type-variable\n-     * as a key and the instantiated type as a value. If no types need to be substituted\n-     * an empty map is returned.\n-     * @param declaredThrownTypes the originally declared thrown types.\n-     * @param instantiatedThrownTypes the thrown types in the context of the current type.\n-     * @return map of declared to instantiated thrown types or an empty map.\n+     * Inherit throws documentation for exceptions that were declared but not\n+     * documented.\n@@ -707,11 +240,31 @@\n-    private Map<TypeMirror, TypeMirror> getSubstitutedThrownTypes(Types types,\n-                                                                  List<? extends TypeMirror> declaredThrownTypes,\n-                                                                  List<? extends TypeMirror> instantiatedThrownTypes) {\n-        Map<TypeMirror, TypeMirror> map = new HashMap<>();\n-        var i1 = declaredThrownTypes.iterator();\n-        var i2 = instantiatedThrownTypes.iterator();\n-        while (i1.hasNext() && i2.hasNext()) {\n-            TypeMirror t1 = i1.next();\n-            TypeMirror t2 = i2.next();\n-            if (!types.isSameType(t1, t2)) {\n-                map.put(t1, t2);\n+    private Content inheritThrowsDocumentation(ExecutableElement holder,\n+                                               List<? extends TypeMirror> declaredExceptionTypes,\n+                                               Set<String> alreadyDocumented,\n+                                               Map<String, TypeMirror> typeSubstitutions,\n+                                               TagletWriter writer) {\n+        Content result = writer.getOutputInstance();\n+        if (holder.getKind() != ElementKind.METHOD) {\n+            \/\/ (Optimization.)\n+            \/\/ Of all executable elements, only methods and constructors are documented.\n+            \/\/ Of these two, only methods inherit documentation.\n+            \/\/ Don't waste time on constructors.\n+            assert holder.getKind() == ElementKind.CONSTRUCTOR : holder.getKind();\n+            return result;\n+        }\n+        var utils = writer.configuration().utils;\n+        Map<ThrowsTree, ExecutableElement> declaredExceptionTags = new LinkedHashMap<>();\n+        for (TypeMirror declaredExceptionType : declaredExceptionTypes) {\n+            var input = new DocFinder.Input(utils, holder, this,\n+                    utils.getTypeName(declaredExceptionType, false));\n+            DocFinder.Output inheritedDoc = DocFinder.search(writer.configuration(), input);\n+            if (inheritedDoc.tagList.isEmpty()) {\n+                input = new DocFinder.Input(utils, holder, this,\n+                        utils.getTypeName(declaredExceptionType, true));\n+                inheritedDoc = DocFinder.search(writer.configuration(), input);\n+            }\n+            if (!inheritedDoc.tagList.isEmpty()) {\n+                if (inheritedDoc.holder == null) {\n+                    inheritedDoc.holder = holder;\n+                }\n+                var h = (ExecutableElement) inheritedDoc.holder;\n+                inheritedDoc.tagList.forEach(t -> declaredExceptionTags.put((ThrowsTree) t, h));\n@@ -720,17 +273,3 @@\n-        \/\/ correspondence between types is established positionally, i.e.\n-        \/\/ pairwise, which means that the lists must have the same\n-        \/\/ number of elements; if they don't, this algorithm is\n-        \/\/ broken\n-        assert !i1.hasNext() && !i2.hasNext();\n-        \/\/ copyOf is unordered and this is fine: this map is for queries;\n-        \/\/ it doesn't control rendering order\n-        return Map.copyOf(map);\n-    }\n-\n-    private static AssertionError newAssertionError(Object... objects) {\n-        return new AssertionError(Arrays.toString(objects));\n-    }\n-\n-    private static String diagnosticDescriptionOf(Element e) {\n-        var name = e instanceof QualifiedNameable q ? q.getQualifiedName() : e.getSimpleName();\n-        return name + \" (\" + detailedDescriptionOf(e) + \")\";\n+        result.add(throwsTagsOutput(declaredExceptionTags, alreadyDocumented, typeSubstitutions,\n+                writer));\n+        return result;\n@@ -739,21 +278,16 @@\n-    private static String detailedDescriptionOf(Element e) {\n-        \/\/ It might be important to describe the element in detail. Sometimes\n-        \/\/ elements share the same simple and\/or qualified name. Outputting\n-        \/\/ individual components of that name as well as their kinds helps\n-        \/\/ the user disambiguate such elements.\n-        var lowerCasedKind = e.getKind().toString().toLowerCase(Locale.ROOT);\n-        var thisElementDescription = lowerCasedKind + \" \" + switch (e.getKind()) {\n-            \/\/ A package is never enclosed in a package and a module is\n-            \/\/ never never enclosed in a module, no matter what their\n-            \/\/ qualified name might suggest. Get their qualified\n-            \/\/ name directly. Also, unnamed packages and\n-            \/\/ modules require special treatment.\n-            case PACKAGE -> {\n-                var p = (PackageElement) e;\n-                \/\/ might use i18n in the future\n-                yield p.isUnnamed() ? \"<unnamed package>\" : p.getQualifiedName();\n-            }\n-            case MODULE -> {\n-                var m = (ModuleElement) e;\n-                \/\/ might use i18n in the future, if there's value in displaying an unnamed module\n-                yield m.isUnnamed() ? \"<unnamed module>\" : m.getQualifiedName();\n+    private Content linkToUndocumentedDeclaredExceptions(List<? extends TypeMirror> declaredExceptionTypes,\n+                                                         Set<String> alreadyDocumented,\n+                                                         TagletWriter writer) {\n+        \/\/ TODO: assert declaredExceptionTypes are instantiated\n+        var utils = writer.configuration().utils;\n+        Content result = writer.getOutputInstance();\n+        for (TypeMirror declaredExceptionType : declaredExceptionTypes) {\n+            TypeElement te = utils.asTypeElement(declaredExceptionType);\n+            if (te != null &&\n+                    !alreadyDocumented.contains(declaredExceptionType.toString()) &&\n+                    !alreadyDocumented.contains(utils.getFullyQualifiedName(te, false))) {\n+                if (alreadyDocumented.isEmpty()) {\n+                    result.add(writer.getThrowsHeader());\n+                }\n+                result.add(writer.throwsTagOutput(declaredExceptionType));\n+                alreadyDocumented.add(utils.getSimpleName(te));\n@@ -761,4 +295,0 @@\n-            default -> e.getSimpleName();\n-        };\n-        if (e.getEnclosingElement() == null) {\n-            return thisElementDescription;\n@@ -766,2 +296,1 @@\n-        var enclosingElementDescription = detailedDescriptionOf(e.getEnclosingElement());\n-        return enclosingElementDescription + \" \" + thisElementDescription;\n+        return result;\n","filename":"src\/jdk.javadoc\/share\/classes\/jdk\/javadoc\/internal\/doclets\/toolkit\/taglets\/ThrowsTaglet.java","additions":199,"deletions":670,"binary":false,"changes":869,"status":"modified"},{"patch":"@@ -59,1 +59,0 @@\n-import jdk.javadoc.internal.doclets.toolkit.util.DocFinder.Result;\n@@ -70,1 +69,0 @@\n-import java.util.Optional;\n@@ -130,1 +128,0 @@\n-        \/\/ We need to lookup type variables and other types\n@@ -539,7 +536,4 @@\n-        var docFinder = utils.docFinder();\n-        Optional<ExecutableElement> inheritedDoc = docFinder.search(ee,\n-                (m -> {\n-                    Optional<ExecutableElement> optional = utils.getFullBody(m).isEmpty() ? Optional.empty() : Optional.of(m);\n-                    return Result.fromOptional(optional);\n-                })).toOptional();\n-        return inheritedDoc.isEmpty() || inheritedDoc.get().equals(ee)\n+        DocFinder.Output inheritedDoc =\n+                DocFinder.search(configuration,\n+                        new DocFinder.Input(utils, ee));\n+        return inheritedDoc.holder == ee\n@@ -547,1 +541,1 @@\n-                : utils.getCommentHelper(inheritedDoc.get()).getDocTreePath(dtree);\n+                : utils.getCommentHelper(inheritedDoc.holder).getDocTreePath(dtree);\n","filename":"src\/jdk.javadoc\/share\/classes\/jdk\/javadoc\/internal\/doclets\/toolkit\/util\/CommentHelper.java","additions":5,"deletions":11,"binary":false,"changes":16,"status":"modified"},{"patch":"@@ -28,6 +28,1 @@\n-import java.util.ArrayList;\n-import java.util.Iterator;\n-import java.util.Objects;\n-import java.util.Optional;\n-import java.util.function.BiFunction;\n-import java.util.function.Function;\n+import java.util.*;\n@@ -35,0 +30,1 @@\n+import javax.lang.model.element.Element;\n@@ -36,0 +32,1 @@\n+import javax.lang.model.element.TypeElement;\n@@ -37,0 +34,7 @@\n+import com.sun.source.doctree.DocTree;\n+import jdk.javadoc.internal.doclets.toolkit.BaseConfiguration;\n+import jdk.javadoc.internal.doclets.toolkit.taglets.InheritableTaglet;\n+\n+\/**\n+ * Search for the requested documentation.  Inherit documentation if necessary.\n+ *\/\n@@ -39,5 +43,4 @@\n-    \/*\n-     * A specialized, possibly stateful, function that accepts a method in the\n-     * hierarchy and returns a value that controls the search or throws an\n-     * exception, which terminates the search and transparently bubbles\n-     * up the stack.\n+    public record DocTreeInfo(DocTree docTree, Element element) { }\n+\n+    \/**\n+     * The class that encapsulates the input.\n@@ -45,4 +48,1 @@\n-    @FunctionalInterface\n-    public interface Criterion<T, X extends Throwable> {\n-        Result<T> apply(ExecutableElement method) throws X;\n-    }\n+    public static class Input {\n@@ -50,2 +50,4 @@\n-    private final Function<ExecutableElement, ExecutableElement> overriddenMethodLookup;\n-    private final BiFunction<ExecutableElement, ExecutableElement, Iterable<ExecutableElement>> implementedMethodsLookup;\n+        \/**\n+         * The element to search documentation from.\n+         *\/\n+        public Element element;\n@@ -53,5 +55,5 @@\n-    DocFinder(Function<ExecutableElement, ExecutableElement> overriddenMethodLookup,\n-              BiFunction<ExecutableElement, ExecutableElement, Iterable<ExecutableElement>> implementedMethodsLookup) {\n-        this.overriddenMethodLookup = overriddenMethodLookup;\n-        this.implementedMethodsLookup = implementedMethodsLookup;\n-    }\n+        \/**\n+         * The taglet to search for documentation on behalf of. Null if we want\n+         * to search for overall documentation.\n+         *\/\n+        public InheritableTaglet taglet;\n@@ -59,2 +61,4 @@\n-    @SuppressWarnings(\"serial\")\n-    public static final class NoOverriddenMethodsFound extends Exception {\n+        \/**\n+         * The id of the tag to retrieve documentation for.\n+         *\/\n+        public String tagId;\n@@ -62,3 +66,5 @@\n-        \/\/ only DocFinder should instantiate this exception\n-        private NoOverriddenMethodsFound() { }\n-    }\n+        \/**\n+         * The tag to retrieve documentation for.  This is only used for the\n+         * {@code {@inheritDoc}} tag.\n+         *\/\n+        public final DocTreeInfo docTreeInfo;\n@@ -66,6 +72,4 @@\n-    public <T, X extends Throwable> Result<T> search(ExecutableElement method,\n-                                                     Criterion<T, X> criterion)\n-            throws X\n-    {\n-        return search(method, true, criterion);\n-    }\n+        \/**\n+         * True if we only want to search for the first sentence.\n+         *\/\n+        public boolean isFirstSentence;\n@@ -73,12 +77,4 @@\n-    public <T, X extends Throwable> Result<T> search(ExecutableElement method,\n-                                                     boolean includeMethod,\n-                                                     Criterion<T, X> criterion)\n-            throws X\n-    {\n-        try {\n-            return search0(method, includeMethod, false, criterion);\n-        } catch (NoOverriddenMethodsFound e) {\n-            \/\/ should not happen because the exception flag is unset\n-            throw new AssertionError(e);\n-        }\n-    }\n+        \/**\n+         * True if we are looking for documentation to replace the {@code {@inheritDoc}} tag.\n+         *\/\n+        public boolean isInheritDocTag;\n@@ -86,6 +82,5 @@\n-    public <T, X extends Throwable> Result<T> trySearch(ExecutableElement method,\n-                                                        Criterion<T, X> criterion)\n-            throws NoOverriddenMethodsFound, X\n-    {\n-        return search0(method, false, true, criterion);\n-    }\n+        \/**\n+         * Used to distinguish between type variable param tags and regular\n+         * param tags.\n+         *\/\n+        public boolean isTypeVariableParamTag;\n@@ -93,35 +88,9 @@\n-    \/*\n-     * Searches through the overridden methods hierarchy of the provided method.\n-     *\n-     * Depending on how it is instructed, the search begins from either the given\n-     * method or the first method that the given method overrides. The search\n-     * then applies the given criterion to methods it encounters, in the\n-     * hierarchy order, until either of the following happens:\n-     *\n-     *  - the criterion concludes the search\n-     *  - the criterion throws an exception\n-     *  - the hierarchy is exhausted\n-     *\n-     * If the search succeeds, the returned result is of type Conclude.\n-     * Otherwise, the returned result is generally that of the most\n-     * recent call to Criterion::apply.\n-     *\n-     * If the given method overrides no methods (i.e. hierarchy consists of the\n-     * given method only) and the search is instructed to detect that, the\n-     * search terminates with an exception.\n-     *\/\n-    private <T, X extends Throwable> Result<T> search0(ExecutableElement method,\n-                                                       boolean includeMethodInSearch,\n-                                                       boolean throwExceptionIfDoesNotOverride,\n-                                                       Criterion<T, X> criterion)\n-            throws NoOverriddenMethodsFound, X\n-    {\n-        \/\/ if the \"overrides\" check is requested and does not pass, throw the exception\n-        \/\/ first so that it trumps the result that the search would otherwise had\n-        Iterator<ExecutableElement> methods = methodsOverriddenBy(method);\n-        if (throwExceptionIfDoesNotOverride && !methods.hasNext() ) {\n-            throw new NoOverriddenMethodsFound();\n-        }\n-        Result<T> r = includeMethodInSearch ? criterion.apply(method) : Result.CONTINUE();\n-        if (!(r instanceof Result.Continue<T>)) {\n-            return r;\n+        public final Utils utils;\n+\n+        public Input(Utils utils,\n+                     Element element,\n+                     InheritableTaglet taglet,\n+                     String tagId) {\n+            this(utils, element);\n+            this.taglet = taglet;\n+            this.tagId = tagId;\n@@ -129,6 +98,10 @@\n-        while (methods.hasNext()) {\n-            ExecutableElement m = methods.next();\n-            r = search0(m, true, false \/* don't check for overrides *\/, criterion);\n-            if (r instanceof Result.Conclude<T>) {\n-                return r;\n-            }\n+\n+        public Input(Utils utils,\n+                     Element element,\n+                     InheritableTaglet taglet,\n+                     String tagId,\n+                     boolean isTypeVariableParamTag) {\n+            this(utils, element);\n+            this.taglet = taglet;\n+            this.tagId = tagId;\n+            this.isTypeVariableParamTag = isTypeVariableParamTag;\n@@ -136,2 +109,0 @@\n-        return r;\n-    }\n@@ -139,8 +110,3 @@\n-    \/\/ We see both overridden and implemented methods as overridden\n-    \/\/ (see JLS 8.4.8.1. Overriding (by Instance Methods))\n-    private Iterator<ExecutableElement> methodsOverriddenBy(ExecutableElement method) {\n-        \/\/ TODO: create a lazy iterator if required\n-        var list = new ArrayList<ExecutableElement>();\n-        ExecutableElement overridden = overriddenMethodLookup.apply(method);\n-        if (overridden != null) {\n-            list.add(overridden);\n+        public Input(Utils utils, Element element, InheritableTaglet taglet) {\n+            this(utils, element);\n+            this.taglet = taglet;\n@@ -148,3 +114,0 @@\n-        implementedMethodsLookup.apply(method, method).forEach(list::add);\n-        return list.iterator();\n-    }\n@@ -152,2 +115,5 @@\n-    private static final Result<?> SKIP = new Skipped<>();\n-    private static final Result<?> CONTINUE = new Continued<>();\n+        public Input(Utils utils, Element element) {\n+            this.element = Objects.requireNonNull(element);\n+            this.utils = utils;\n+            this.docTreeInfo = new DocTreeInfo(null, null);\n+        }\n@@ -155,8 +121,13 @@\n-    \/*\n-     * Use static factory methods to get the desired result to return from\n-     * Criterion. Use instanceof to check for a result type returned from\n-     * a search. If a use case permits and you prefer Optional API, use\n-     * the fromOptional\/toOptional convenience methods to get and\n-     * check for the result respectively.\n-     *\/\n-    public sealed interface Result<T> {\n+        public Input(Utils utils,\n+                     Element element,\n+                     InheritableTaglet taglet,\n+                     DocTreeInfo dtInfo,\n+                     boolean isFirstSentence,\n+                     boolean isInheritDocTag) {\n+            this.utils = utils;\n+            this.element = Objects.requireNonNull(element);\n+            this.taglet = taglet;\n+            this.isFirstSentence = isFirstSentence;\n+            this.isInheritDocTag = isInheritDocTag;\n+            this.docTreeInfo = dtInfo;\n+        }\n@@ -164,1 +135,7 @@\n-        sealed interface Skip<T> extends Result<T> permits Skipped { }\n+        private Input copy() {\n+            var copy = new Input(utils, element, taglet, docTreeInfo,\n+                    isFirstSentence, isInheritDocTag);\n+            copy.tagId = tagId;\n+            copy.isTypeVariableParamTag = isTypeVariableParamTag;\n+            return copy;\n+        }\n@@ -166,1 +143,15 @@\n-        sealed interface Continue<T> extends Result<T> permits Continued { }\n+        \/**\n+         * For debugging purposes.\n+         *\/\n+        @Override\n+        public String toString() {\n+            String encl = element == null ? \"\" : element.getEnclosingElement().toString() + \"::\";\n+            return \"Input{\" + \"element=\" + encl + element\n+                    + \", taglet=\" + taglet\n+                    + \", tagId=\" + tagId + \", tag=\" + docTreeInfo\n+                    + \", isFirstSentence=\" + isFirstSentence\n+                    + \", isInheritDocTag=\" + isInheritDocTag\n+                    + \", isTypeVariableParamTag=\" + isTypeVariableParamTag\n+                    + \", utils=\" + utils + '}';\n+        }\n+    }\n@@ -168,1 +159,4 @@\n-        sealed interface Conclude<T> extends Result<T> permits Concluded {\n+    \/**\n+     * The class that encapsulates the output.\n+     *\/\n+    public static class Output {\n@@ -170,2 +164,5 @@\n-            T value();\n-        }\n+        \/**\n+         * The tag that holds the documentation.  Null if documentation\n+         * is not held by a tag.\n+         *\/\n+        public DocTree holderTag;\n@@ -173,4 +170,2 @@\n-        \/*\n-         * Skips the search on the part of the hierarchy above the method for\n-         * which this result is returned and continues the search from that\n-         * method sibling, if any.\n+        \/**\n+         * The element that holds the documentation.\n@@ -178,4 +173,1 @@\n-        @SuppressWarnings(\"unchecked\")\n-        static <T> Result<T> SKIP() {\n-            return (Result<T>) SKIP;\n-        }\n+        public Element holder;\n@@ -183,2 +175,2 @@\n-        \/*\n-         * Continues the search.\n+        \/**\n+         * The inherited documentation.\n@@ -186,4 +178,1 @@\n-        @SuppressWarnings(\"unchecked\")\n-        static <T> Result<T> CONTINUE() {\n-            return (Result<T>) CONTINUE;\n-        }\n+        public List<? extends DocTree> inlineTags = List.of();\n@@ -191,2 +180,2 @@\n-        \/*\n-         * Concludes the search with the given result.\n+        \/**\n+         * False if documentation could not be inherited.\n@@ -194,3 +183,1 @@\n-        static <T> Result<T> CONCLUDE(T value) {\n-            return new Concluded<>(value);\n-        }\n+        public boolean isValidInheritDocTag = true;\n@@ -198,6 +185,6 @@\n-        \/*\n-         * Translates this Result into Optional.\n-         *\n-         * Convenience method. Call on the result of a search if you are only\n-         * interested in whether the search succeeded or failed and you\n-         * prefer the Optional API.\n+        \/**\n+         * When automatically inheriting throws tags, you sometimes must inherit\n+         * more than one tag.  For example, if a method declares that it throws\n+         * IOException and the overridden method has {@code @throws} tags for IOException and\n+         * ZipException, both tags would be inherited because ZipException is a\n+         * subclass of IOException.  This allows multiple tag inheritance.\n@@ -205,3 +192,1 @@\n-        default Optional<T> toOptional() {\n-            return Optional.empty();\n-        }\n+        public final List<DocTree> tagList = new ArrayList<>();\n@@ -209,6 +194,2 @@\n-        \/*\n-         * Translates the given Optional into a binary decision whether to\n-         * conclude the search or continue it.\n-         *\n-         * Convenience method. Use in Criterion that can easily provide\n-         * suitable Optional. Don't use if Criterion needs to skip.\n+        \/**\n+         * For debugging purposes.\n@@ -216,2 +197,8 @@\n-        static <T> Result<T> fromOptional(Optional<T> optional) {\n-            return optional.map(Result::CONCLUDE).orElseGet(Result::CONTINUE);\n+        @Override\n+        public String toString() {\n+            String encl = holder == null ? \"\" : holder.getEnclosingElement().toString() + \"::\";\n+            return \"Output{\" + \"holderTag=\" + holderTag\n+                    + \", holder=\" + encl + holder\n+                    + \", inlineTags=\" + inlineTags\n+                    + \", isValidInheritDocTag=\" + isValidInheritDocTag\n+                    + \", tagList=\" + tagList + '}';\n@@ -221,14 +208,22 @@\n-    \/\/ Note: we hide records behind interfaces, as implementation detail.\n-    \/\/ We don't directly implement Result with these records because it\n-    \/\/ would require more exposure and commitment than is desired. For\n-    \/\/ example, there would need to be public constructors, which\n-    \/\/ would circumvent static factory methods.\n-\n-    private record Skipped<T>() implements DocFinder.Result.Skip<T> { }\n-\n-    private record Continued<T>() implements DocFinder.Result.Continue<T> { }\n-\n-    private record Concluded<T>(T value) implements DocFinder.Result.Conclude<T> {\n-\n-        Concluded {\n-            Objects.requireNonNull(value);\n+    \/**\n+     * Search for the requested comments in the given element.  If it does not\n+     * have comments, return the inherited comments if possible.\n+     *\n+     * @param input the input object used to perform the search.\n+     *\n+     * @return an Output object representing the documentation that was found.\n+     *\/\n+    public static Output search(BaseConfiguration configuration, Input input) {\n+        Output output = new Output();\n+        Utils utils = configuration.utils;\n+        if (input.isInheritDocTag) {\n+            \/\/Do nothing because \"element\" does not have any documentation.\n+            \/\/All it has is {@inheritDoc}.\n+        } else if (input.taglet == null) {\n+            \/\/We want overall documentation.\n+            output.inlineTags = input.isFirstSentence\n+                    ? utils.getFirstSentenceTrees(input.element)\n+                    : utils.getFullBody(input.element);\n+            output.holder = input.element;\n+        } else {\n+            input.taglet.inherit(input, output);\n@@ -237,3 +232,28 @@\n-        @Override\n-        public Optional<T> toOptional() {\n-            return Optional.of(value);\n+        if (!output.inlineTags.isEmpty()) {\n+            return output;\n+        }\n+        output.isValidInheritDocTag = false;\n+        Input inheritedSearchInput = input.copy();\n+        inheritedSearchInput.isInheritDocTag = false;\n+        if (utils.isMethod(input.element)) {\n+            ExecutableElement m = (ExecutableElement) input.element;\n+            ExecutableElement overriddenMethod = utils.overriddenMethod(m);\n+            if (overriddenMethod != null) {\n+                inheritedSearchInput.element = overriddenMethod;\n+                output = search(configuration, inheritedSearchInput);\n+                output.isValidInheritDocTag = true;\n+                if (!output.inlineTags.isEmpty()) {\n+                    return output;\n+                }\n+            }\n+            TypeElement encl = utils.getEnclosingTypeElement(input.element);\n+            VisibleMemberTable vmt = configuration.getVisibleMemberTable(encl);\n+            List<ExecutableElement> implementedMethods = vmt.getImplementedMethods(m);\n+            for (ExecutableElement implementedMethod : implementedMethods) {\n+                inheritedSearchInput.element = implementedMethod;\n+                output = search(configuration, inheritedSearchInput);\n+                output.isValidInheritDocTag = true;\n+                if (!output.inlineTags.isEmpty()) {\n+                    return output;\n+                }\n+            }\n@@ -241,0 +261,1 @@\n+        return output;\n","filename":"src\/jdk.javadoc\/share\/classes\/jdk\/javadoc\/internal\/doclets\/toolkit\/util\/DocFinder.java","additions":194,"deletions":173,"binary":false,"changes":367,"status":"modified"},{"patch":"@@ -118,1 +118,1 @@\n-        String[] mdlPatterns = moduleNameFormList.split(\"[,:]\");\n+        String[] mdlPatterns = moduleNameFormList.split(\":\");\n@@ -164,1 +164,1 @@\n-        String[] pkgPatterns = pkgNameFormList.split(\"[,:]\");\n+        String[] pkgPatterns = pkgNameFormList.split(\":\");\n","filename":"src\/jdk.javadoc\/share\/classes\/jdk\/javadoc\/internal\/doclets\/toolkit\/util\/Group.java","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -141,1 +141,0 @@\n-    private final DocFinder docFinder = newDocFinder();\n@@ -1918,3 +1917,0 @@\n-    \/\/ If `e` is a static nested class, this method will return e's simple name\n-    \/\/ preceded by `.` and an outer type; this is not how JLS defines \"simple\n-    \/\/ name\". See \"Simple Name\", \"Qualified Name\", \"Fully Qualified Name\".\n@@ -1934,1 +1930,1 @@\n-                            && (enclosed.getKind().isDeclaredType())) {\n+                            && (enclosed.getKind().isClass() || enclosed.getKind().isInterface())) {\n@@ -2803,12 +2799,0 @@\n-    public DocFinder docFinder() {\n-        return docFinder;\n-    }\n-\n-    private DocFinder newDocFinder() {\n-        return new DocFinder(this::overriddenMethod, this::implementedMethods);\n-    }\n-\n-    private Iterable<ExecutableElement> implementedMethods(ExecutableElement originalMethod, ExecutableElement m) {\n-        var type = configuration.utils.getEnclosingTypeElement(m);\n-        return configuration.getVisibleMemberTable(type).getImplementedMethods(originalMethod);\n-    }\n","filename":"src\/jdk.javadoc\/share\/classes\/jdk\/javadoc\/internal\/doclets\/toolkit\/util\/Utils.java","additions":1,"deletions":17,"binary":false,"changes":18,"status":"modified"},{"patch":"@@ -1,1 +1,1 @@\n-.\\\" Copyright (c) 1994, 2022, Oracle and\/or its affiliates. All rights reserved.\n+.\\\" Copyright (c) 1994, 2021, Oracle and\/or its affiliates. All rights reserved.\n@@ -22,1 +22,1 @@\n-.\\\" Automatically generated by Pandoc 2.19.2\n+.\\\" Automatically generated by Pandoc 2.3.1\n@@ -24,15 +24,1 @@\n-.\\\" Define V font for inline verbatim, using C font in formats\n-.\\\" that render this, and otherwise B font.\n-.ie \"\\f[CB]x\\f[R]\"x\" \\{\\\n-. ftr V B\n-. ftr VI BI\n-. ftr VB B\n-. ftr VBI BI\n-.\\}\n-.el \\{\\\n-. ftr V CR\n-. ftr VI CI\n-. ftr VB CB\n-. ftr VBI CBI\n-.\\}\n-.TH \"JAVADOC\" \"1\" \"2023\" \"JDK 20-ea\" \"JDK Commands\"\n+.TH \"JAVADOC\" \"1\" \"2023\" \"JDK 20\\-ea\" \"JDK Commands\"\n@@ -42,1 +28,1 @@\n-javadoc - generate HTML pages of API documentation from Java source\n+javadoc \\- generate HTML pages of API documentation from Java source\n@@ -46,2 +32,2 @@\n-\\f[V]javadoc\\f[R] [\\f[I]options\\f[R]] [\\f[I]packagenames\\f[R]]\n-[\\f[I]sourcefiles\\f[R]] [\\f[V]\\[at]\\f[R]\\f[I]files\\f[R]]\n+\\f[CB]javadoc\\f[R] [\\f[I]options\\f[R]] [\\f[I]packagenames\\f[R]]\n+[\\f[I]sourcefiles\\f[R]] [\\f[CB]\\@\\f[R]\\f[I]files\\f[R]]\n@@ -49,4 +35,4 @@\n-\\f[I]options\\f[R]\n-Specifies command-line options, separated by spaces.\n-See \\f[B]Standard \\f[VB]javadoc\\f[B] Options\\f[R], \\f[B]Extra\n-\\f[VB]javadoc\\f[B] Options\\f[R], \\f[B]Standard Options for the Standard\n+.B \\f[I]options\\f[R]\n+Specifies command\\-line options, separated by spaces.\n+See \\f[B]Standard \\f[BC]javadoc\\f[B] Options\\f[R], \\f[B]Extra\n+\\f[BC]javadoc\\f[B] Options\\f[R], \\f[B]Standard Options for the Standard\n@@ -54,0 +40,2 @@\n+.RS\n+.RE\n@@ -55,1 +43,1 @@\n-\\f[I]packagenames\\f[R]\n+.B \\f[I]packagenames\\f[R]\n@@ -57,1 +45,1 @@\n-spaces, for example \\f[V]java.lang java.lang.reflect java.awt\\f[R].\n+spaces, for example \\f[CB]java.lang\\ java.lang.reflect\\ java.awt\\f[R].\n@@ -59,1 +47,1 @@\n-\\f[V]-subpackages\\f[R] option to specify the packages.\n+\\f[CB]\\-subpackages\\f[R] option to specify the packages.\n@@ -62,1 +50,1 @@\n-By default, \\f[V]javadoc\\f[R] looks for the specified packages in the\n+By default, \\f[CB]javadoc\\f[R] looks for the specified packages in the\n@@ -64,1 +52,1 @@\n-Use the \\f[V]-sourcepath\\f[R] option to specify the list of directories\n+Use the \\f[CB]\\-sourcepath\\f[R] option to specify the list of directories\n@@ -68,1 +56,1 @@\n-\\f[I]sourcefiles\\f[R]\n+.B \\f[I]sourcefiles\\f[R]\n@@ -71,2 +59,2 @@\n-\\f[V]Class.java Object.java Button.java\\f[R].\n-By default, \\f[V]javadoc\\f[R] looks for the specified classes in the\n+\\f[CB]Class.java\\ Object.java\\ Button.java\\f[R].\n+By default, \\f[CB]javadoc\\f[R] looks for the specified classes in the\n@@ -76,1 +64,1 @@\n-\\f[V]\/home\/src\/java\/awt\/Graphics*.java\\f[R].\n+\\f[CB]\/home\/src\/java\/awt\/Graphics*.java\\f[R].\n@@ -78,0 +66,2 @@\n+.RS\n+.RE\n@@ -79,2 +69,2 @@\n-\\f[V]\\[at]\\f[R]\\f[I]files\\f[R]\n-Specifies names of files that contain a list of \\f[V]javadoc\\f[R] tool\n+.B \\f[CB]\\@\\f[R]\\f[I]files\\f[R]\n+Specifies names of files that contain a list of \\f[CB]javadoc\\f[R] tool\n@@ -82,0 +72,2 @@\n+.RS\n+.RE\n@@ -84,1 +76,1 @@\n-The \\f[V]javadoc\\f[R] tool parses the declarations and documentation\n+The \\f[CB]javadoc\\f[R] tool parses the declarations and documentation\n@@ -89,1 +81,1 @@\n-You can use the \\f[V]javadoc\\f[R] tool to generate the API documentation\n+You can use the \\f[CB]javadoc\\f[R] tool to generate the API documentation\n@@ -92,1 +84,1 @@\n-You can run the \\f[V]javadoc\\f[R] tool on entire packages, individual\n+You can run the \\f[CB]javadoc\\f[R] tool on entire packages, individual\n@@ -94,1 +86,1 @@\n-When documenting entire packages, you can use the \\f[V]-subpackages\\f[R]\n+When documenting entire packages, you can use the \\f[CB]\\-subpackages\\f[R]\n@@ -105,1 +97,1 @@\n-arise when generating non-conformant output or output containing\n+arise when generating non\\-conformant output or output containing\n@@ -114,1 +106,1 @@\n-[https:\/\/www.w3.org\/TR\/html5\/infrastructure.html#conformance-requirements]\n+[https:\/\/www.w3.org\/TR\/html5\/infrastructure.html#conformance\\-requirements]\n@@ -121,2 +113,2 @@\n-\\f[V]javadoc\\f[R] supports command-line options for both the main\n-\\f[V]javadoc\\f[R] tool and the currently selected doclet.\n+\\f[CB]javadoc\\f[R] supports command\\-line options for both the main\n+\\f[CB]javadoc\\f[R] tool and the currently selected doclet.\n@@ -125,2 +117,2 @@\n-GNU-style options (that is, those beginning with \\f[V]--\\f[R]) can use\n-an equal sign (\\f[V]=\\f[R]) instead of whitespace characters to separate\n+GNU\\-style options (that is, those beginning with \\f[CB]\\-\\-\\f[R]) can use\n+an equal sign (\\f[CB]=\\f[R]) instead of whitespace characters to separate\n@@ -128,1 +120,1 @@\n-.SS Standard \\f[V]javadoc\\f[R] Options\n+.SS Standard \\f[CB]javadoc\\f[R] Options\n@@ -130,2 +122,2 @@\n-The following core \\f[V]javadoc\\f[R] options are equivalent to\n-corresponding \\f[V]javac\\f[R] options.\n+The following core \\f[CB]javadoc\\f[R] options are equivalent to\n+corresponding \\f[CB]javac\\f[R] options.\n@@ -135,1 +127,1 @@\n-\\f[V]--add-modules\\f[R]\n+\\f[CB]\\-\\-add\\-modules\\f[R]\n@@ -137,1 +129,1 @@\n-\\f[V]-bootclasspath\\f[R]\n+\\f[CB]\\-bootclasspath\\f[R]\n@@ -139,1 +131,1 @@\n-\\f[V]--class-path\\f[R], \\f[V]-classpath\\f[R], or \\f[V]-cp\\f[R]\n+\\f[CB]\\-\\-class\\-path\\f[R], \\f[CB]\\-classpath\\f[R], or \\f[CB]\\-cp\\f[R]\n@@ -141,1 +133,1 @@\n-\\f[V]--enable-preview\\f[R]\n+\\f[CB]\\-\\-enable\\-preview\\f[R]\n@@ -143,1 +135,1 @@\n-\\f[V]-encoding\\f[R]\n+\\f[CB]\\-encoding\\f[R]\n@@ -145,1 +137,1 @@\n-\\f[V]-extdirs\\f[R]\n+\\f[CB]\\-extdirs\\f[R]\n@@ -147,1 +139,1 @@\n-\\f[V]--limit-modules\\f[R]\n+\\f[CB]\\-\\-limit\\-modules\\f[R]\n@@ -149,1 +141,1 @@\n-\\f[V]--module\\f[R]\n+\\f[CB]\\-\\-module\\f[R]\n@@ -151,1 +143,1 @@\n-\\f[V]--module-path\\f[R] or \\f[V]-p\\f[R]\n+\\f[CB]\\-\\-module\\-path\\f[R] or \\f[CB]\\-p\\f[R]\n@@ -153,1 +145,1 @@\n-\\f[V]--module-source-path\\f[R]\n+\\f[CB]\\-\\-module\\-source\\-path\\f[R]\n@@ -155,1 +147,1 @@\n-\\f[V]--release\\f[R]\n+\\f[CB]\\-\\-release\\f[R]\n@@ -157,1 +149,1 @@\n-\\f[V]--source\\f[R] or \\f[V]-source\\f[R]\n+\\f[CB]\\-\\-source\\f[R] or \\f[CB]\\-source\\f[R]\n@@ -159,1 +151,1 @@\n-\\f[V]--source-path\\f[R] or \\f[V]-sourcepath\\f[R]\n+\\f[CB]\\-\\-source\\-path\\f[R] or \\f[CB]\\-sourcepath\\f[R]\n@@ -161,1 +153,1 @@\n-\\f[V]--system\\f[R]\n+\\f[CB]\\-\\-system\\f[R]\n@@ -163,1 +155,1 @@\n-\\f[V]--upgrade-module-path\\f[R]\n+\\f[CB]\\-\\-upgrade\\-module\\-path\\f[R]\n@@ -165,2 +157,2 @@\n-The following options are the core \\f[V]javadoc\\f[R] options that are\n-not equivalent to a corresponding \\f[V]javac\\f[R] option:\n+The following options are the core \\f[CB]javadoc\\f[R] options that are not\n+equivalent to a corresponding \\f[CB]javac\\f[R] option:\n@@ -168,2 +160,2 @@\n-\\f[V]-breakiterator\\f[R]\n-Computes the first sentence with \\f[V]BreakIterator\\f[R].\n+.B \\f[CB]\\-breakiterator\\f[R]\n+Computes the first sentence with \\f[CB]BreakIterator\\f[R].\n@@ -172,1 +164,1 @@\n-The \\f[V]BreakIterator\\f[R] class is used to determine the end of a\n+The \\f[CB]BreakIterator\\f[R] class is used to determine the end of a\n@@ -176,2 +168,2 @@\n-English default sentence-break algorithm --- Stops at a period followed\n-by a space or an HTML block tag, such as \\f[V]<P>\\f[R].\n+English default sentence\\-break algorithm \\-\\-\\- Stops at a period\n+followed by a space or an HTML block tag, such as \\f[CB]<P>\\f[R].\n@@ -179,7 +171,7 @@\n-Breakiterator sentence-break algorithm --- Stops at a period, question\n-mark, or exclamation point followed by a space when the next word starts\n-with a capital letter.\n-This is meant to handle most abbreviations (such as \\[dq]The serial no.\n-is valid\\[dq], but will not handle \\[dq]Mr.\n-Smith\\[dq]).\n-The \\f[V]-breakiterator\\f[R] option doesn\\[aq]t stop at HTML tags or\n+Breakiterator sentence\\-break algorithm \\-\\-\\- Stops at a period,\n+question mark, or exclamation point followed by a space when the next\n+word starts with a capital letter.\n+This is meant to handle most abbreviations (such as \"The serial no.\n+is valid\", but will not handle \"Mr.\n+Smith\").\n+The \\f[CB]\\-breakiterator\\f[R] option doesn\\[aq]t stop at HTML tags or\n@@ -187,1 +179,1 @@\n-The algorithm stops at the last period in \\f[V]..\/filename\\f[R], even\n+The algorithm stops at the last period in \\f[CB]\\&..\/filename\\f[R], even\n@@ -191,1 +183,1 @@\n-\\f[V]-doclet\\f[R] \\f[I]class\\f[R]\n+.B \\f[CB]\\-doclet\\f[R] \\f[I]class\\f[R]\n@@ -195,2 +187,2 @@\n-If the \\f[V]-doclet\\f[R] option isn\\[aq]t used, then the\n-\\f[V]javadoc\\f[R] tool uses the standard doclet for generating the\n+If the \\f[CB]\\-doclet\\f[R] option isn\\[aq]t used, then the\n+\\f[CB]javadoc\\f[R] tool uses the standard doclet for generating the\n@@ -198,2 +190,2 @@\n-This class must contain the \\f[V]start(Root)\\f[R] method.\n-The path to this starting class is defined by the \\f[V]-docletpath\\f[R]\n+This class must contain the \\f[CB]start(Root)\\f[R] method.\n+The path to this starting class is defined by the \\f[CB]\\-docletpath\\f[R]\n@@ -201,0 +193,2 @@\n+.RS\n+.RE\n@@ -202,1 +196,1 @@\n-\\f[V]-docletpath\\f[R] \\f[I]path\\f[R]\n+.B \\f[CB]\\-docletpath\\f[R] \\f[I]path\\f[R]\n@@ -204,1 +198,1 @@\n-\\f[V]-doclet\\f[R] option) and any JAR files it depends on.\n+\\f[CB]\\-doclet\\f[R] option) and any JAR files it depends on.\n@@ -209,4 +203,4 @@\n-If \\f[V]classpathlist\\f[R] contains multiple paths or JAR files, then\n-they should be separated with a colon (\\f[V]:\\f[R]) on Linux and a\n-semi-colon (\\f[V];\\f[R]) on Windows.\n-This option isn\\[aq]t necessary when the \\f[V]doclet\\f[R] starting class\n+If \\f[CB]classpathlist\\f[R] contains multiple paths or JAR files, then\n+they should be separated with a colon (\\f[CB]:\\f[R]) on Linux and a\n+semi\\-colon (\\f[CB];\\f[R]) on Windows.\n+This option isn\\[aq]t necessary when the \\f[CB]doclet\\f[R] starting class\n@@ -214,0 +208,2 @@\n+.RS\n+.RE\n@@ -215,1 +211,1 @@\n-\\f[V]-exclude\\f[R] \\f[I]pkglist\\f[R]\n+.B \\f[CB]\\-exclude\\f[R] \\f[I]pkglist\\f[R]\n@@ -217,1 +213,1 @@\n-from the list formed by \\f[V]-subpackages\\f[R].\n+from the list formed by \\f[CB]\\-subpackages\\f[R].\n@@ -219,1 +215,1 @@\n-some earlier or later \\f[V]-subpackages\\f[R] option.\n+some earlier or later \\f[CB]\\-subpackages\\f[R] option.\n@@ -222,5 +218,5 @@\n-The following example would include \\f[V]java.io\\f[R],\n-\\f[V]java.util\\f[R], and \\f[V]java.math\\f[R] (among others), but would\n-exclude packages rooted at \\f[V]java.net\\f[R] and \\f[V]java.lang\\f[R].\n-Notice that these examples exclude \\f[V]java.lang.ref\\f[R], which is a\n-subpackage of \\f[V]java.lang\\f[R].\n+The following example would include \\f[CB]java.io\\f[R],\n+\\f[CB]java.util\\f[R], and \\f[CB]java.math\\f[R] (among others), but would\n+exclude packages rooted at \\f[CB]java.net\\f[R] and \\f[CB]java.lang\\f[R].\n+Notice that these examples exclude \\f[CB]java.lang.ref\\f[R], which is a\n+subpackage of \\f[CB]java.lang\\f[R].\n@@ -233,1 +229,1 @@\n-javadoc -sourcepath \/home\/user\/src -subpackages java -exclude java.net:java.lang\n+javadoc\\ \\-sourcepath\\ \/home\/user\/src\\ \\-subpackages\\ java\\ \\-exclude\\ java.net:java.lang\n@@ -243,1 +239,1 @@\n-javadoc -sourcepath \\[rs]user\\[rs]src -subpackages java -exclude java.net:java.lang\n+javadoc\\ \\-sourcepath\\ \\\\user\\\\src\\ \\-subpackages\\ java\\ \\-exclude\\ java.net:java.lang\n@@ -249,1 +245,1 @@\n-\\f[V]--expand-requires\\f[R] \\f[I]value\\f[R]\n+.B \\f[CB]\\-\\-expand\\-requires\\f[R] \\f[I]value\\f[R]\n@@ -257,1 +253,1 @@\n-\\f[V]transitive\\f[R]: additionally includes all the required transitive\n+\\f[CB]transitive\\f[R]: additionally includes all the required transitive\n@@ -260,1 +256,1 @@\n-\\f[V]all\\f[R]: includes all dependencies.\n+\\f[CB]all\\f[R]: includes all dependencies.\n@@ -263,1 +259,1 @@\n-\\f[V]--help\\f[R], \\f[V]-help\\f[R], \\f[V]-h\\f[R], or \\f[V]-?\\f[R]\n+.B \\f[CB]\\-\\-help\\f[R], \\f[CB]\\-help\\f[R], \\f[CB]\\-h\\f[R], or \\f[CB]\\-?\\f[R]\n@@ -265,0 +261,2 @@\n+.RS\n+.RE\n@@ -266,1 +264,1 @@\n-\\f[V]--help-extra\\f[R] or \\f[V]-X\\f[R]\n+.B \\f[CB]\\-\\-help\\-extra\\f[R] or \\f[CB]\\-X\\f[R]\n@@ -268,0 +266,2 @@\n+.RS\n+.RE\n@@ -269,3 +269,3 @@\n-\\f[V]-J\\f[R]\\f[I]flag\\f[R]\n-Passes \\f[I]flag\\f[R] directly to the Java Runtime Environment (JRE)\n-that runs the \\f[V]javadoc\\f[R] tool.\n+.B \\f[CB]\\-J\\f[R]\\f[I]flag\\f[R]\n+Passes \\f[I]flag\\f[R] directly to the Java Runtime Environment (JRE) that\n+runs the \\f[CB]javadoc\\f[R] tool.\n@@ -274,3 +274,3 @@\n-call the \\f[V]-Xmx\\f[R] option as follows:\n-\\f[V]javadoc -J-Xmx32m -J-Xms32m com.mypackage\\f[R].\n-Be aware that \\f[V]-Xms\\f[R] is optional because it only sets the size\n+call the \\f[CB]\\-Xmx\\f[R] option as follows:\n+\\f[CB]javadoc\\ \\-J\\-Xmx32m\\ \\-J\\-Xms32m\\ com.mypackage\\f[R].\n+Be aware that \\f[CB]\\-Xms\\f[R] is optional because it only sets the size\n@@ -281,1 +281,1 @@\n-There is no space between the \\f[V]J\\f[R] and the \\f[V]flag\\f[R].\n+There is no space between the \\f[CB]J\\f[R] and the \\f[CB]flag\\f[R].\n@@ -283,2 +283,2 @@\n-Use the \\f[V]-version\\f[R] option to report the version of the JRE being\n-used to run the \\f[V]javadoc\\f[R] tool.\n+Use the \\f[CB]\\-version\\f[R] option to report the version of the JRE being\n+used to run the \\f[CB]javadoc\\f[R] tool.\n@@ -288,4 +288,4 @@\n-javadoc -J-version\n-java version \\[dq]17\\[dq] 2021-09-14 LTS\n-Java(TM) SE Runtime Environment (build 17+35-LTS-2724)\n-Java HotSpot(TM) 64-Bit Server VM (build 17+35-LTS-2724, mixed mode, sharing)\n+javadoc\\ \\-J\\-version\n+java\\ version\\ \"17\"\\ 2021\\-09\\-14\\ LTS\n+Java(TM)\\ SE\\ Runtime\\ Environment\\ (build\\ 17+35\\-LTS\\-2724)\n+Java\\ HotSpot(TM)\\ 64\\-Bit\\ Server\\ VM\\ (build\\ 17+35\\-LTS\\-2724,\\ mixed\\ mode,\\ sharing)\n@@ -296,2 +296,2 @@\n-\\f[V]-locale\\f[R] \\f[I]name\\f[R]\n-Specifies the locale that the \\f[V]javadoc\\f[R] tool uses when it\n+.B \\f[CB]\\-locale\\f[R] \\f[I]name\\f[R]\n+Specifies the locale that the \\f[CB]javadoc\\f[R] tool uses when it\n@@ -300,2 +300,2 @@\n-\\f[V]java.util.Locale\\f[R] documentation, such as \\f[V]en_US\\f[R]\n-(English, United States) or \\f[V]en_US_WIN\\f[R] (Windows variant).\n+\\f[CB]java.util.Locale\\f[R] documentation, such as \\f[CB]en_US\\f[R]\n+(English, United States) or \\f[CB]en_US_WIN\\f[R] (Windows variant).\n@@ -304,1 +304,1 @@\n-Specifying a locale causes the \\f[V]javadoc\\f[R] tool to choose the\n+Specifying a locale causes the \\f[CB]javadoc\\f[R] tool to choose the\n@@ -307,1 +307,1 @@\n-comments in the \\f[V]stylesheet.css\\f[R] file, and so on.\n+comments in the \\f[CB]stylesheet.css\\f[R] file, and so on.\n@@ -310,1 +310,1 @@\n-The \\f[V]-locale\\f[R] option doesn\\[aq]t determine the locale of the\n+The \\f[CB]\\-locale\\f[R] option doesn\\[aq]t determine the locale of the\n@@ -315,1 +315,1 @@\n-\\f[V]-package\\f[R]\n+.B \\f[CB]\\-package\\f[R]\n@@ -317,0 +317,2 @@\n+.RS\n+.RE\n@@ -318,1 +320,1 @@\n-\\f[V]-private\\f[R]\n+.B \\f[CB]\\-private\\f[R]\n@@ -320,0 +322,2 @@\n+.RS\n+.RE\n@@ -321,1 +325,1 @@\n-\\f[V]-protected\\f[R]\n+.B \\f[CB]\\-protected\\f[R]\n@@ -324,0 +328,2 @@\n+.RS\n+.RE\n@@ -325,1 +331,1 @@\n-\\f[V]-public\\f[R]\n+.B \\f[CB]\\-public\\f[R]\n@@ -327,0 +333,2 @@\n+.RS\n+.RE\n@@ -328,1 +336,1 @@\n-\\f[V]-quiet\\f[R]\n+.B \\f[CB]\\-quiet\\f[R]\n@@ -331,1 +339,3 @@\n-It also suppresses the \\f[V]version\\f[R] string.\n+It also suppresses the \\f[CB]version\\f[R] string.\n+.RS\n+.RE\n@@ -333,1 +343,1 @@\n-\\f[V]--show-members\\f[R] \\f[I]value\\f[R]\n+.B \\f[CB]\\-\\-show\\-members\\f[R] \\f[I]value\\f[R]\n@@ -338,1 +348,1 @@\n-\\f[V]public\\f[R] --- shows only public members\n+\\f[CB]public\\f[R] \\-\\-\\- shows only public members\n@@ -340,2 +350,2 @@\n-\\f[V]protected\\f[R] --- shows public and protected members; this is the\n-default\n+\\f[CB]protected\\f[R] \\-\\-\\- shows public and protected members; this is\n+the default\n@@ -343,1 +353,1 @@\n-\\f[V]package\\f[R] --- shows public, protected, and package members\n+\\f[CB]package\\f[R] \\-\\-\\- shows public, protected, and package members\n@@ -345,1 +355,1 @@\n-\\f[V]private\\f[R] --- shows all members\n+\\f[CB]private\\f[R] \\-\\-\\- shows all members\n@@ -348,1 +358,1 @@\n-\\f[V]--show-module-contents\\f[R] \\f[I]value\\f[R]\n+.B \\f[CB]\\-\\-show\\-module\\-contents\\f[R] \\f[I]value\\f[R]\n@@ -350,1 +360,3 @@\n-\\f[I]value\\f[R] can be \\f[V]api\\f[R] or \\f[V]all\\f[R].\n+\\f[I]value\\f[R] can be \\f[CB]api\\f[R] or \\f[CB]all\\f[R].\n+.RS\n+.RE\n@@ -352,1 +364,1 @@\n-\\f[V]--show-packages\\f[R] \\f[I]value\\f[R]\n+.B \\f[CB]\\-\\-show\\-packages\\f[R] \\f[I]value\\f[R]\n@@ -354,1 +366,3 @@\n-can be \\f[V]exported\\f[R] or \\f[V]all\\f[R] packages.\n+can be \\f[CB]exported\\f[R] or \\f[CB]all\\f[R] packages.\n+.RS\n+.RE\n@@ -356,3 +370,3 @@\n-\\f[V]--show-types\\f[R] \\f[I]value\\f[R]\n-Specifies which types (classes, interfaces, etc.)\n-are documented, where \\f[I]value\\f[R] can be any of the following:\n+.B \\f[CB]\\-\\-show\\-types\\f[R] \\f[I]value\\f[R]\n+Specifies which types (classes, interfaces, etc.) are documented, where\n+\\f[I]value\\f[R] can be any of the following:\n@@ -361,1 +375,1 @@\n-\\f[V]public\\f[R] --- shows only public types\n+\\f[CB]public\\f[R] \\-\\-\\- shows only public types\n@@ -363,1 +377,1 @@\n-\\f[V]protected\\f[R] --- shows public and protected types; this is the\n+\\f[CB]protected\\f[R] \\-\\-\\- shows public and protected types; this is the\n@@ -366,1 +380,1 @@\n-\\f[V]package\\f[R] --- shows public, protected, and package types\n+\\f[CB]package\\f[R] \\-\\-\\- shows public, protected, and package types\n@@ -368,1 +382,1 @@\n-\\f[V]private\\f[R] --- shows all types\n+\\f[CB]private\\f[R] \\-\\-\\- shows all types\n@@ -371,1 +385,1 @@\n-\\f[V]-subpackages\\f[R] \\f[I]subpkglist\\f[R]\n+.B \\f[CB]\\-subpackages\\f[R] \\f[I]subpkglist\\f[R]\n@@ -376,3 +390,3 @@\n-Each package argument is any top-level subpackage (such as\n-\\f[V]java\\f[R]) or fully qualified package (such as\n-\\f[V]javax.swing\\f[R]) that doesn\\[aq]t need to contain source files.\n+Each package argument is any top\\-level subpackage (such as\n+\\f[CB]java\\f[R]) or fully qualified package (such as \\f[CB]javax.swing\\f[R])\n+that doesn\\[aq]t need to contain source files.\n@@ -381,1 +395,1 @@\n-Use \\f[V]-sourcepath\\f[R] to specify where to find the packages.\n+Use \\f[CB]\\-sourcepath\\f[R] to specify where to find the packages.\n@@ -387,1 +401,1 @@\n-named \\f[V]java\\f[R] and \\f[V]javax.swing\\f[R] and all of their\n+named \\f[CB]java\\f[R] and \\f[CB]javax.swing\\f[R] and all of their\n@@ -395,1 +409,1 @@\n-javadoc -d docs -sourcepath \/home\/user\/src -subpackages java:javax.swing\n+javadoc\\ \\-d\\ docs\\ \\-sourcepath\\ \/home\/user\/src\\ \\-subpackages\\ java:javax.swing\n@@ -405,1 +419,1 @@\n-javadoc -d docs -sourcepath \\[rs]user\\[rs]src -subpackages java:javax.swing\n+javadoc\\ \\-d\\ docs\\ \\-sourcepath\\ \\\\user\\\\src\\ \\-subpackages\\ java:javax.swing\n@@ -411,3 +425,3 @@\n-\\f[V]-verbose\\f[R]\n-Provides more detailed messages while the \\f[V]javadoc\\f[R] tool runs.\n-Without the \\f[V]-verbose\\f[R] option, messages appear for loading the\n+.B \\f[CB]\\-verbose\\f[R]\n+Provides more detailed messages while the \\f[CB]javadoc\\f[R] tool runs.\n+Without the \\f[CB]\\-verbose\\f[R] option, messages appear for loading the\n@@ -416,1 +430,1 @@\n-The \\f[V]-verbose\\f[R] option causes the printing of additional messages\n+The \\f[CB]\\-verbose\\f[R] option causes the printing of additional messages\n@@ -418,0 +432,2 @@\n+.RS\n+.RE\n@@ -419,1 +435,1 @@\n-\\f[V]--version\\f[R]\n+.B \\f[CB]\\-\\-version\\f[R]\n@@ -421,0 +437,2 @@\n+.RS\n+.RE\n@@ -422,1 +440,1 @@\n-\\f[V]-Werror\\f[R]\n+.B \\f[CB]\\-Werror\\f[R]\n@@ -424,1 +442,3 @@\n-.SS Extra \\f[V]javadoc\\f[R] Options\n+.RS\n+.RE\n+.SS Extra \\f[CB]javadoc\\f[R] Options\n@@ -426,1 +446,1 @@\n-\\f[I]Note:\\f[R] The additional options for \\f[V]javadoc\\f[R] are subject\n+\\f[I]Note:\\f[R] The additional options for \\f[CB]javadoc\\f[R] are subject\n@@ -429,2 +449,2 @@\n-The following additional \\f[V]javadoc\\f[R] options are equivalent to\n-corresponding \\f[V]javac\\f[R] options.\n+The following additional \\f[CB]javadoc\\f[R] options are equivalent to\n+corresponding \\f[CB]javac\\f[R] options.\n@@ -434,1 +454,1 @@\n-\\f[V]--add-exports\\f[R]\n+\\f[CB]\\-\\-add\\-exports\\f[R]\n@@ -436,1 +456,1 @@\n-\\f[V]--add-reads\\f[R]\n+\\f[CB]\\-\\-add\\-reads\\f[R]\n@@ -438,1 +458,1 @@\n-\\f[V]--patch-module\\f[R]\n+\\f[CB]\\-\\-patch\\-module\\f[R]\n@@ -440,1 +460,1 @@\n-\\f[V]-Xmaxerrs\\f[R]\n+\\f[CB]\\-Xmaxerrs\\f[R]\n@@ -442,1 +462,1 @@\n-\\f[V]-Xmaxwarns\\f[R]\n+\\f[CB]\\-Xmaxwarns\\f[R]\n@@ -447,1 +467,1 @@\n-\\f[V]--add-script\\f[R] \\f[I]file\\f[R]\n+.B \\f[CB]\\-\\-add\\-script\\f[R] \\f[I]file\\f[R]\n@@ -454,1 +474,1 @@\n-Command-line example:\n+Command\\-line example:\n@@ -457,1 +477,1 @@\n-\\f[V]javadoc --add-script first_script.js --add-script second_script.js pkg_foo\\f[R]\n+\\f[CB]javadoc\\ \\-\\-add\\-script\\ first_script.js\\ \\-\\-add\\-script\\ second_script.js\\ pkg_foo\\f[R]\n@@ -461,1 +481,1 @@\n-\\f[V]--add-stylesheet\\f[R] \\f[I]file\\f[R]\n+.B \\f[CB]\\-\\-add\\-stylesheet\\f[R] \\f[I]file\\f[R]\n@@ -468,1 +488,1 @@\n-Command-line example:\n+Command\\-line example:\n@@ -472,1 +492,1 @@\n-javadoc --add-stylesheet new_stylesheet_1.css --add-stylesheet new_stylesheet_2.css pkg_foo\n+javadoc\\ \\-\\-add\\-stylesheet\\ new_stylesheet_1.css\\ \\-\\-add\\-stylesheet\\ new_stylesheet_2.css\\ pkg_foo\n@@ -477,1 +497,1 @@\n-\\f[V]--allow-script-in-comments\\f[R]\n+.B \\f[CB]\\-\\-allow\\-script\\-in\\-comments\\f[R]\n@@ -479,0 +499,2 @@\n+.RS\n+.RE\n@@ -480,2 +502,4 @@\n-\\f[V]-author\\f[R]\n-Includes the \\f[V]\\[at]author\\f[R] text in the generated docs.\n+.B \\f[CB]\\-author\\f[R]\n+Includes the \\f[CB]\\@author\\f[R] text in the generated docs.\n+.RS\n+.RE\n@@ -483,1 +507,1 @@\n-\\f[V]-bottom\\f[R] \\f[I]html-code\\f[R]\n+.B \\f[CB]\\-bottom\\f[R] \\f[I]html\\-code\\f[R]\n@@ -490,0 +514,2 @@\n+.RS\n+.RE\n@@ -491,1 +517,1 @@\n-\\f[V]-charset\\f[R] \\f[I]name\\f[R]\n+.B \\f[CB]\\-charset\\f[R] \\f[I]name\\f[R]\n@@ -495,1 +521,1 @@\n-[http:\/\/www.iana.org\/assignments\/character-sets].\n+[http:\/\/www.iana.org\/assignments\/character\\-sets].\n@@ -502,1 +528,1 @@\n-javadoc -charset \\[dq]iso-8859-1\\[dq] mypackage\n+javadoc\\ \\-charset\\ \"iso\\-8859\\-1\"\\ mypackage\n@@ -511,1 +537,1 @@\n-<meta http-equiv=\\[dq]Content-Type\\[dq] content=\\[dq]text\/html; charset=ISO-8859-1\\[dq]>\n+<meta\\ http\\-equiv=\"Content\\-Type\"\\ content=\"text\/html;\\ charset=ISO\\-8859\\-1\">\n@@ -515,1 +541,1 @@\n-The \\f[V]meta\\f[R] tag is described in the \\f[B]HTML standard (4197265\n+The \\f[CB]meta\\f[R] tag is described in the \\f[B]HTML standard (4197265\n@@ -517,1 +543,1 @@\n-[http:\/\/www.w3.org\/TR\/REC-html40\/charset.html#h-5.2.2].\n+[http:\/\/www.w3.org\/TR\/REC\\-html40\/charset.html#h\\-5.2.2].\n@@ -520,2 +546,2 @@\n-\\f[V]-d\\f[R] \\f[I]directory\\f[R]\n-Specifies the destination directory where the \\f[V]javadoc\\f[R] tool\n+.B \\f[CB]\\-d\\f[R] \\f[I]directory\\f[R]\n+Specifies the destination directory where the \\f[CB]javadoc\\f[R] tool\n@@ -523,1 +549,1 @@\n-If you omit the \\f[V]-d\\f[R] option, then the files are saved to the\n+If you omit the \\f[CB]\\-d\\f[R] option, then the files are saved to the\n@@ -525,1 +551,1 @@\n-The \\f[V]directory\\f[R] value can be absolute or relative to the current\n+The \\f[CB]directory\\f[R] value can be absolute or relative to the current\n@@ -528,1 +554,1 @@\n-\\f[V]javadoc\\f[R] tool runs.\n+\\f[CB]javadoc\\f[R] tool runs.\n@@ -532,2 +558,2 @@\n-the documentation for the package \\f[V]com.mypackage\\f[R] and saves the\n-results in the \\f[V]\/user\/doc\/\\f[R] directory:\n+the documentation for the package \\f[CB]com.mypackage\\f[R] and saves the\n+results in the \\f[CB]\/user\/doc\/\\f[R] directory:\n@@ -538,1 +564,1 @@\n-javadoc -d \/user\/doc\/ com.mypackage\n+javadoc\\ \\-d\\ \/user\/doc\/\\ com.mypackage\n@@ -544,2 +570,2 @@\n-documentation for the package \\f[V]com.mypackage\\f[R] and saves the\n-results in the \\f[V]\\[rs]user\\[rs]doc\\[rs]\\f[R] directory:\n+documentation for the package \\f[CB]com.mypackage\\f[R] and saves the\n+results in the \\f[CB]\\\\user\\\\doc\\\\\\f[R] directory:\n@@ -550,1 +576,1 @@\n-javadoc -d \\[rs]user\\[rs]doc\\[rs] com.mypackage\n+javadoc\\ \\-d\\ \\\\user\\\\doc\\\\\\ com.mypackage\n@@ -556,1 +582,1 @@\n-\\f[V]-docencoding\\f[R] \\f[I]name\\f[R]\n+.B \\f[CB]\\-docencoding\\f[R] \\f[I]name\\f[R]\n@@ -560,1 +586,1 @@\n-[http:\/\/www.iana.org\/assignments\/character-sets].\n+[http:\/\/www.iana.org\/assignments\/character\\-sets].\n@@ -563,1 +589,1 @@\n-Three options are available for use in a \\f[V]javadoc\\f[R] encoding\n+Three options are available for use in a \\f[CB]javadoc\\f[R] encoding\n@@ -565,3 +591,3 @@\n-The \\f[V]-encoding\\f[R] option is used for encoding the files read by\n-the \\f[V]javadoc\\f[R] tool, while the \\f[V]-docencoding\\f[R] and\n-\\f[V]-charset\\f[R] options are used for encoding the files written by\n+The \\f[CB]\\-encoding\\f[R] option is used for encoding the files read by\n+the \\f[CB]javadoc\\f[R] tool, while the \\f[CB]\\-docencoding\\f[R] and\n+\\f[CB]\\-charset\\f[R] options are used for encoding the files written by\n@@ -579,1 +605,1 @@\n-javadoc -docencoding \\[dq]iso-8859-1\\[dq] mypackage\n+javadoc\\ \\-docencoding\\ \"iso\\-8859\\-1\"\\ mypackage\n@@ -584,9 +610,4 @@\n-\\f[V]-docfilessubdirs\\f[R]\n-Recursively copies doc-file subdirectories.\n-Enables deep copying of doc-files directories.\n-Subdirectories and all contents are recursively copied to the\n-destination.\n-For example, the directory \\f[V]doc-files\/example\/images\\f[R] and all of\n-its contents are copied.\n-The \\f[B]\\f[VB]-excludedocfilessubdir\\f[B]\\f[R] option can be used to\n-exclude specific subdirectories.\n+.B \\f[CB]\\-docfilessubdirs\\f[R]\n+Recursively copies doc\\-file subdirectories.\n+.RS\n+.RE\n@@ -594,1 +615,1 @@\n-\\f[V]-doctitle\\f[R] \\f[I]html-code\\f[R]\n+.B \\f[CB]\\-doctitle\\f[R] \\f[I]html\\-code\\f[R]\n@@ -596,3 +617,3 @@\n-The text specified in the \\f[V]title\\f[R] tag is placed as a centered,\n-level-one heading directly beneath the top navigation bar.\n-The \\f[V]title\\f[R] tag can contain HTML tags and white space, but when\n+The text specified in the \\f[CB]title\\f[R] tag is placed as a centered,\n+level\\-one heading directly beneath the top navigation bar.\n+The \\f[CB]title\\f[R] tag can contain HTML tags and white space, but when\n@@ -600,1 +621,1 @@\n-Additional quotation marks within the \\f[V]title\\f[R] tag must be\n+Additional quotation marks within the \\f[CB]title\\f[R] tag must be\n@@ -603,1 +624,3 @@\n-\\f[V]javadoc -doctitle \\[dq]<b>My Library<\/b><br>v1.0\\[dq] com.mypackage\\f[R].\n+\\f[CB]javadoc\\ \\-doctitle\\ \"<b>My\\ Library<\/b><br>v1.0\"\\ com.mypackage\\f[R].\n+.RS\n+.RE\n@@ -605,6 +628,10 @@\n-\\f[V]-excludedocfilessubdir\\f[R] \\f[I]name1\\f[R]\\f[V],\\f[R]\\f[I]name2...\\f[R]\n-Excludes any subdirectories with the given names when recursively\n-copying doc-file subdirectories.\n-See \\f[B]\\f[VB]-docfilessubdirs\\f[B]\\f[R].\n-For historical reasons, \\f[V]:\\f[R] can be used anywhere in the argument\n-as a separator instead of \\f[V],\\f[R].\n+.B \\f[CB]\\-excludedocfilessubdir\\f[R] \\f[I]name\\f[R]\n+Excludes any doc files subdirectories with the given name.\n+Enables deep copying of doc\\-files directories.\n+Subdirectories and all contents are recursively copied to the\n+destination.\n+For example, the directory \\f[CB]doc\\-files\/example\/images\\f[R] and all of\n+its contents are copied.\n+There is also an option to exclude subdirectories.\n+.RS\n+.RE\n@@ -612,1 +639,1 @@\n-\\f[V]-footer\\f[R] \\f[I]html-code\\f[R]\n+.B \\f[CB]\\-footer\\f[R] \\f[I]html\\-code\\f[R]\n@@ -615,1 +642,1 @@\n-The\\f[V]html-code\\f[R] value is placed to the right of the lower\n+The\\f[CB]html\\-code\\f[R] value is placed to the right of the lower\n@@ -617,2 +644,2 @@\n-The \\f[V]html-code\\f[R] value can contain HTML tags and white space, but\n-when it does, the \\f[V]html-code\\f[R] value must be enclosed in\n+The \\f[CB]html\\-code\\f[R] value can contain HTML tags and white space, but\n+when it does, the \\f[CB]html\\-code\\f[R] value must be enclosed in\n@@ -621,0 +648,2 @@\n+.RS\n+.RE\n@@ -622,1 +651,1 @@\n-\\f[V]-group\\f[R] \\f[I]name\\f[R] \\f[I]p1\\f[R]\\f[V],\\f[R]\\f[I]p2...\\f[R]\n+.B \\f[CB]\\-group\\f[R] \\f[I]namep1\\f[R]\\f[CB]:\\f[R]\\f[I]p2\\f[R]\n@@ -624,2 +653,2 @@\n-For historical reasons, \\f[V]:\\f[R] can be used as a separator anywhere\n-in the argument instead of \\f[V],\\f[R].\n+.RS\n+.RE\n@@ -627,1 +656,1 @@\n-\\f[V]-header\\f[R] \\f[I]html-code\\f[R]\n+.B \\f[CB]\\-header\\f[R] \\f[I]html\\-code\\f[R]\n@@ -630,2 +659,2 @@\n-The \\f[V]header\\f[R] can contain HTML tags and white space, but when it\n-does, the \\f[V]header\\f[R] must be enclosed in quotation marks.\n+The \\f[CB]header\\f[R] can contain HTML tags and white space, but when it\n+does, the \\f[CB]header\\f[R] must be enclosed in quotation marks.\n@@ -634,1 +663,3 @@\n-\\f[V]javadoc -header \\[dq]<b>My Library<\/b><br>v1.0\\[dq] com.mypackage\\f[R].\n+\\f[CB]javadoc\\ \\-header\\ \"<b>My\\ Library<\/b><br>v1.0\"\\ com.mypackage\\f[R].\n+.RS\n+.RE\n@@ -636,1 +667,1 @@\n-\\f[V]-helpfile\\f[R] \\f[I]filename\\f[R]\n+.B \\f[CB]\\-helpfile\\f[R] \\f[I]filename\\f[R]\n@@ -639,2 +670,2 @@\n-Without this option, the \\f[V]javadoc\\f[R] tool creates a help file\n-\\f[V]help-doc.html\\f[R] that is hard-coded in the \\f[V]javadoc\\f[R]\n+Without this option, the \\f[CB]javadoc\\f[R] tool creates a help file\n+\\f[CB]help\\-doc.html\\f[R] that is hard\\-coded in the \\f[CB]javadoc\\f[R]\n@@ -644,2 +675,2 @@\n-\\f[V]help-doc.html\\f[R].\n-The \\f[V]javadoc\\f[R] tool adjusts the links in the navigation bar\n+\\f[CB]help\\-doc.html\\f[R].\n+The \\f[CB]javadoc\\f[R] tool adjusts the links in the navigation bar\n@@ -655,1 +686,1 @@\n-javadoc -helpfile \/home\/user\/myhelp.html java.awt\n+javadoc\\ \\-helpfile\\ \/home\/user\/myhelp.html\\ java.awt\n@@ -665,1 +696,1 @@\n-javadoc -helpfile C:\\[rs]user\\[rs]myhelp.html java.awt\n+javadoc\\ \\-helpfile\\ C:\\\\user\\\\myhelp.html\\ java.awt\n@@ -671,2 +702,5 @@\n-\\f[V]-html5\\f[R]\n-This option is a no-op and is just retained for backwards compatibility.\n+.B \\f[CB]\\-html5\\f[R]\n+This option is a no\\-op and is just retained for backwards\n+compatibility.\n+.RS\n+.RE\n@@ -674,1 +708,1 @@\n-\\f[V]--javafx\\f[R] or \\f[V]-javafx\\f[R]\n+.B \\f[CB]\\-\\-javafx\\f[R] or \\f[CB]\\-javafx\\f[R]\n@@ -678,0 +712,2 @@\n+.RS\n+.RE\n@@ -679,2 +715,2 @@\n-\\f[V]-keywords\\f[R]\n-Adds HTML keyword \\f[V]<meta>\\f[R] tags to the generated file for each\n+.B \\f[CB]\\-keywords\\f[R]\n+Adds HTML keyword \\f[CB]<meta>\\f[R] tags to the generated file for each\n@@ -682,1 +718,1 @@\n-These tags can help search engines that look for \\f[V]<meta>\\f[R] tags\n+These tags can help search engines that look for \\f[CB]<meta>\\f[R] tags\n@@ -685,1 +721,1 @@\n-\\f[V]<meta>\\f[R] tags, because pages can misuse them.\n+\\f[CB]<meta>\\f[R] tags, because pages can misuse them.\n@@ -687,2 +723,2 @@\n-own website can benefit by looking at \\f[V]<meta>\\f[R] tags.\n-The \\f[V]<meta>\\f[R] tags include the fully qualified name of the class\n+own website can benefit by looking at \\f[CB]<meta>\\f[R] tags.\n+The \\f[CB]<meta>\\f[R] tags include the fully qualified name of the class\n@@ -692,1 +728,1 @@\n-For example, the class \\f[V]String\\f[R] starts with these keywords:\n+For example, the class \\f[CB]String\\f[R] starts with these keywords:\n@@ -697,4 +733,4 @@\n-<meta name=\\[dq]keywords\\[dq] content=\\[dq]java.lang.String class\\[dq]>\n-<meta name=\\[dq]keywords\\[dq] content=\\[dq]CASE_INSENSITIVE_ORDER\\[dq]>\n-<meta name=\\[dq]keywords\\[dq] content=\\[dq]length()\\[dq]>\n-<meta name=\\[dq]keywords\\[dq] content=\\[dq]charAt()\\[dq]>\n+<meta\\ name=\"keywords\"\\ content=\"java.lang.String\\ class\">\n+<meta\\ name=\"keywords\"\\ content=\"CASE_INSENSITIVE_ORDER\">\n+<meta\\ name=\"keywords\"\\ content=\"length()\">\n+<meta\\ name=\"keywords\"\\ content=\"charAt()\">\n@@ -705,2 +741,2 @@\n-\\f[V]-link\\f[R] \\f[I]url\\f[R]\n-Creates links to existing \\f[V]javadoc\\f[R] generated documentation of\n+.B \\f[CB]\\-link\\f[R] \\f[I]url\\f[R]\n+Creates links to existing \\f[CB]javadoc\\f[R] generated documentation of\n@@ -709,1 +745,1 @@\n-directory that contains the external \\f[V]javadoc\\f[R] generated\n+directory that contains the external \\f[CB]javadoc\\f[R] generated\n@@ -711,2 +747,2 @@\n-You can specify multiple \\f[V]-link\\f[R] options in a specified\n-\\f[V]javadoc\\f[R] tool run to link to multiple documents.\n+You can specify multiple \\f[CB]\\-link\\f[R] options in a specified\n+\\f[CB]javadoc\\f[R] tool run to link to multiple documents.\n@@ -715,1 +751,1 @@\n-Either a \\f[V]package-list\\f[R] or an \\f[V]element-list\\f[R] file must\n+Either a \\f[CB]package\\-list\\f[R] or an \\f[CB]element\\-list\\f[R] file must\n@@ -717,1 +753,1 @@\n-\\f[V]-linkoffline\\f[R] option).\n+\\f[CB]\\-linkoffline\\f[R] option).\n@@ -719,3 +755,3 @@\n-\\f[I]Note:\\f[R] The \\f[V]package-list\\f[R] and \\f[V]element-list\\f[R]\n-files are generated by the \\f[V]javadoc\\f[R] tool when generating the\n-API documentation and should not be modified by the user.\n+\\f[I]Note:\\f[R] The \\f[CB]package\\-list\\f[R] and \\f[CB]element\\-list\\f[R]\n+files are generated by the \\f[CB]javadoc\\f[R] tool when generating the API\n+documentation and should not be modified by the user.\n@@ -723,2 +759,2 @@\n-When you use the \\f[V]javadoc\\f[R] tool to document packages, it uses\n-the \\f[V]package-list\\f[R] file to determine the packages declared in an\n+When you use the \\f[CB]javadoc\\f[R] tool to document packages, it uses the\n+\\f[CB]package\\-list\\f[R] file to determine the packages declared in an\n@@ -726,2 +762,2 @@\n-When you generate API documents for modules, the \\f[V]javadoc\\f[R] tool\n-uses the \\f[V]element-list\\f[R] file to determine the modules and\n+When you generate API documents for modules, the \\f[CB]javadoc\\f[R] tool\n+uses the \\f[CB]element\\-list\\f[R] file to determine the modules and\n@@ -730,2 +766,2 @@\n-The \\f[V]javadoc\\f[R] tool reads the names from the appropriate list\n-file and then links to the packages or modules at that URL.\n+The \\f[CB]javadoc\\f[R] tool reads the names from the appropriate list file\n+and then links to the packages or modules at that URL.\n@@ -733,2 +769,2 @@\n-When the \\f[V]javadoc\\f[R] tool runs, the \\f[I]url\\f[R] value is copied\n-into the \\f[V]<A HREF>\\f[R] links that are created.\n+When the \\f[CB]javadoc\\f[R] tool runs, the \\f[I]url\\f[R] value is copied\n+into the \\f[CB]<A\\ HREF>\\f[R] links that are created.\n@@ -743,1 +779,1 @@\n-\\f[V]-d\\f[R] option) to the directory containing the packages being\n+\\f[CB]\\-d\\f[R] option) to the directory containing the packages being\n@@ -751,4 +787,3 @@\n-separator, whether the URL is absolute or relative, and\n-\\f[V]https:\\f[R], \\f[V]http:\\f[R], or \\f[V]file:\\f[R] as specified in\n-the \\f[B]URL Memo: Uniform Resource Locators\\f[R]\n-[http:\/\/www.ietf.org\/rfc\/rfc1738.txt].\n+separator, whether the URL is absolute or relative, and \\f[CB]https:\\f[R],\n+\\f[CB]http:\\f[R], or \\f[CB]file:\\f[R] as specified in the \\f[B]URL Memo:\n+Uniform Resource Locators\\f[R] [http:\/\/www.ietf.org\/rfc\/rfc1738.txt].\n@@ -758,4 +793,4 @@\n--link https:\/\/<host>\/<directory>\/<directory>\/...\/<name>\n--link http:\/\/<host>\/<directory>\/<directory>\/...\/<name>\n--link file:\/\/<host>\/<directory>\/<directory>\/...\/<name>\n--link <directory>\/<directory>\/...\/<name>\n+\\-link\\ https:\/\/<host>\/<directory>\/<directory>\/...\/<name>\n+\\-link\\ http:\/\/<host>\/<directory>\/<directory>\/...\/<name>\n+\\-link\\ file:\/\/<host>\/<directory>\/<directory>\/...\/<name>\n+\\-link\\ <directory>\/<directory>\/...\/<name>\n@@ -766,1 +801,1 @@\n-\\f[V]--link-modularity-mismatch\\f[R] (\\f[V]warn\\f[R]|\\f[V]info\\f[R])\n+.B \\f[CB]\\-\\-link\\-modularity\\-mismatch\\f[R] (\\f[CB]warn\\f[R]|\\f[CB]info\\f[R])\n@@ -768,3 +803,3 @@\n-non-modular documentation for a modular library, or the reverse case)\n-should be reported as a warning (\\f[V]warn\\f[R]) or just a message\n-(\\f[V]info\\f[R]).\n+non\\-modular documentation for a modular library, or the reverse case)\n+should be reported as a warning (\\f[CB]warn\\f[R]) or just a message\n+(\\f[CB]info\\f[R]).\n@@ -772,0 +807,2 @@\n+.RS\n+.RE\n@@ -773,3 +810,3 @@\n-\\f[V]-linkoffline\\f[R] \\f[I]url1\\f[R] \\f[I]url2\\f[R]\n-This option is a variation of the \\f[V]-link\\f[R] option.\n-They both create links to \\f[V]javadoc\\f[R] generated documentation for\n+.B \\f[CB]\\-linkoffline\\f[R] \\f[I]url1\\f[R] \\f[I]url2\\f[R]\n+This option is a variation of the \\f[CB]\\-link\\f[R] option.\n+They both create links to \\f[CB]javadoc\\f[R] generated documentation for\n@@ -777,2 +814,2 @@\n-You can specify multiple \\f[V]-linkoffline\\f[R] options in a specified\n-\\f[V]javadoc\\f[R] tool run.\n+You can specify multiple \\f[CB]\\-linkoffline\\f[R] options in a specified\n+\\f[CB]javadoc\\f[R] tool run.\n@@ -781,1 +818,1 @@\n-Use the \\f[V]-linkoffline\\f[R] option when:\n+Use the \\f[CB]\\-linkoffline\\f[R] option when:\n@@ -783,1 +820,1 @@\n-Linking to a document on the web that the \\f[V]javadoc\\f[R] tool\n+Linking to a document on the web that the \\f[CB]javadoc\\f[R] tool\n@@ -786,1 +823,1 @@\n-The \\f[V]package-list\\f[R] or \\f[V]element-list\\f[R] file of the\n+The \\f[CB]package\\-list\\f[R] or \\f[CB]element\\-list\\f[R] file of the\n@@ -789,1 +826,1 @@\n-specified by either the \\f[V]package-list\\f[R] or \\f[V]element-list\\f[R]\n+specified by either the \\f[CB]package\\-list\\f[R] or \\f[CB]element\\-list\\f[R]\n@@ -792,3 +829,3 @@\n-\\f[I]Note:\\f[R] The \\f[V]package-list\\f[R] and \\f[V]element-list\\f[R]\n-files are generated by the \\f[V]javadoc\\f[R] tool when generating the\n-API documentation and should not be modified by the user.\n+\\f[I]Note:\\f[R] The \\f[CB]package\\-list\\f[R] and \\f[CB]element\\-list\\f[R]\n+files are generated by the \\f[CB]javadoc\\f[R] tool when generating the API\n+documentation and should not be modified by the user.\n@@ -797,2 +834,2 @@\n-\\f[V]-linkoffline\\f[R] option removes the constraint that the\n-\\f[V]javadoc\\f[R] tool must have a web connection to generate\n+\\f[CB]\\-linkoffline\\f[R] option removes the constraint that the\n+\\f[CB]javadoc\\f[R] tool must have a web connection to generate\n@@ -801,1 +838,1 @@\n-Another use of the \\f[V]-linkoffline\\f[R] option is as a work-around to\n+Another use of the \\f[CB]\\-linkoffline\\f[R] option is as a work\\-around to\n@@ -803,3 +840,3 @@\n-After you have run the \\f[V]javadoc\\f[R] tool on a full set of packages\n-or modules, you can run the \\f[V]javadoc\\f[R] tool again on a smaller\n-set of changed packages or modules, so that the updated files can be\n+After you have run the \\f[CB]javadoc\\f[R] tool on a full set of packages\n+or modules, you can run the \\f[CB]javadoc\\f[R] tool again on a smaller set\n+of changed packages or modules, so that the updated files can be\n@@ -808,4 +845,4 @@\n-For example, the \\f[V]-linkoffline\\f[R] option takes two arguments.\n-The first is for the string to be embedded in the \\f[V]<a href>\\f[R]\n-links, and the second tells the \\f[V]javadoc\\f[R] tool where to find\n-either the \\f[V]package-list\\f[R] or \\f[V]element-list\\f[R] file.\n+For example, the \\f[CB]\\-linkoffline\\f[R] option takes two arguments.\n+The first is for the string to be embedded in the \\f[CB]<a\\ href>\\f[R]\n+links, and the second tells the \\f[CB]javadoc\\f[R] tool where to find\n+either the \\f[CB]package\\-list\\f[R] or \\f[CB]element\\-list\\f[R] file.\n@@ -813,3 +850,3 @@\n-The \\f[I]url1\\f[R] or \\f[I]url2\\f[R] value is the absolute or relative\n-URL of the directory that contains the external \\f[V]javadoc\\f[R]\n-generated documentation that you want to link to.\n+The \\f[I]url1\\f[R] or \\f[I]url2\\f[R] value is the absolute or relative URL\n+of the directory that contains the external \\f[CB]javadoc\\f[R] generated\n+documentation that you want to link to.\n@@ -817,1 +854,1 @@\n-destination directory (specified with the \\f[V]-d\\f[R] option) to the\n+destination directory (specified with the \\f[CB]\\-d\\f[R] option) to the\n@@ -819,1 +856,1 @@\n-See \\f[I]url\\f[R] in the \\f[V]-link\\f[R] option.\n+See \\f[I]url\\f[R] in the \\f[CB]\\-link\\f[R] option.\n@@ -822,1 +859,1 @@\n-\\f[V]--link-platform-properties\\f[R] \\f[I]url\\f[R]\n+.B \\f[CB]\\-\\-link\\-platform\\-properties\\f[R] \\f[I]url\\f[R]\n@@ -829,2 +866,2 @@\n-\\f[V]<version>\\f[R] is the platform version as passed to the\n-\\f[V]--release\\f[R] or \\f[V]--source\\f[R] option and \\f[V]<url>\\f[R] is\n+\\f[CB]<version>\\f[R] is the platform version as passed to the\n+\\f[CB]\\-\\-release\\f[R] or \\f[CB]\\-\\-source\\f[R] option and \\f[CB]<url>\\f[R] is\n@@ -854,1 +891,1 @@\n-\\f[V]-linksource\\f[R]\n+.B \\f[CB]\\-linksource\\f[R]\n@@ -865,2 +902,2 @@\n-of private methods, regardless of the \\f[V]-public\\f[R],\n-\\f[V]-package\\f[R], \\f[V]-protected\\f[R], and \\f[V]-private\\f[R]\n+of private methods, regardless of the \\f[CB]\\-public\\f[R],\n+\\f[CB]\\-package\\f[R], \\f[CB]\\-protected\\f[R], and \\f[CB]\\-private\\f[R]\n@@ -868,1 +905,1 @@\n-Unless you also use the \\f[V]-private\\f[R] option, not all private\n+Unless you also use the \\f[CB]\\-private\\f[R] option, not all private\n@@ -872,2 +909,2 @@\n-For example, the link to the source code of the \\f[V]Button\\f[R] class\n-would be on the word \\f[V]Button\\f[R]:\n+For example, the link to the source code of the \\f[CB]Button\\f[R] class\n+would be on the word \\f[CB]Button\\f[R]:\n@@ -877,1 +914,1 @@\n-public class Button extends Component implements Accessible\n+public\\ class\\ Button\\ extends\\ Component\\ implements\\ Accessible\n@@ -881,2 +918,2 @@\n-The link to the source code of the \\f[V]getLabel\\f[R] method in the\n-\\f[V]Button\\f[R] class is on the word \\f[V]getLabel\\f[R]:\n+The link to the source code of the \\f[CB]getLabel\\f[R] method in the\n+\\f[CB]Button\\f[R] class is on the word \\f[CB]getLabel\\f[R]:\n@@ -886,1 +923,1 @@\n-public String getLabel()\n+public\\ String\\ getLabel()\n@@ -891,1 +928,1 @@\n-\\f[V]--main-stylesheet\\f[R] \\f[I]file\\f[R] or \\f[V]-stylesheetfile\\f[R] \\f[I]file\\f[R]\n+.B \\f[CB]\\-\\-main\\-stylesheet\\f[R] \\f[I]file\\f[R] or \\f[CB]\\-stylesheetfile\\f[R] \\f[I]file\\f[R]\n@@ -895,1 +932,1 @@\n-If you do not specify the option, the \\f[V]javadoc\\f[R] tool will create\n+If you do not specify the option, the \\f[CB]javadoc\\f[R] tool will create\n@@ -898,2 +935,2 @@\n-\\f[V]stylesheet.css\\f[R].\n-The \\f[V]--main-stylesheet\\f[R] option is the preferred form.\n+\\f[CB]stylesheet.css\\f[R].\n+The \\f[CB]\\-\\-main\\-stylesheet\\f[R] option is the preferred form.\n@@ -902,1 +939,1 @@\n-Command-line example:\n+Command\\-line example:\n@@ -906,1 +943,1 @@\n-javadoc --main-stylesheet main_stylesheet.css pkg_foo\n+javadoc\\ \\-\\-main\\-stylesheet\\ main_stylesheet.css\\ pkg_foo\n@@ -911,1 +948,1 @@\n-\\f[V]-nocomment\\f[R]\n+.B \\f[CB]\\-nocomment\\f[R]\n@@ -917,0 +954,2 @@\n+.RS\n+.RE\n@@ -918,1 +957,1 @@\n-\\f[V]-nodeprecated\\f[R]\n+.B \\f[CB]\\-nodeprecated\\f[R]\n@@ -920,1 +959,1 @@\n-This does what the \\f[V]-nodeprecatedlist\\f[R] option does, and it\n+This does what the \\f[CB]\\-nodeprecatedlist\\f[R] option does, and it\n@@ -925,0 +964,2 @@\n+.RS\n+.RE\n@@ -926,1 +967,1 @@\n-\\f[V]-nodeprecatedlist\\f[R]\n+.B \\f[CB]\\-nodeprecatedlist\\f[R]\n@@ -928,1 +969,1 @@\n-APIs (\\f[V]deprecated-list.html\\f[R]) and the link in the navigation bar\n+APIs (\\f[CB]deprecated\\-list.html\\f[R]) and the link in the navigation bar\n@@ -930,1 +971,1 @@\n-The \\f[V]javadoc\\f[R] tool continues to generate the deprecated API\n+The \\f[CB]javadoc\\f[R] tool continues to generate the deprecated API\n@@ -934,0 +975,2 @@\n+.RS\n+.RE\n@@ -935,1 +978,1 @@\n-\\f[V]-nohelp\\f[R]\n+.B \\f[CB]\\-nohelp\\f[R]\n@@ -938,0 +981,2 @@\n+.RS\n+.RE\n@@ -939,1 +984,1 @@\n-\\f[V]-noindex\\f[R]\n+.B \\f[CB]\\-noindex\\f[R]\n@@ -942,0 +987,2 @@\n+.RS\n+.RE\n@@ -943,1 +990,1 @@\n-\\f[V]-nonavbar\\f[R]\n+.B \\f[CB]\\-nonavbar\\f[R]\n@@ -946,1 +993,1 @@\n-The \\f[V]-nonavbar\\f[R] option has no effect on the \\f[V]-bottom\\f[R]\n+The \\f[CB]\\-nonavbar\\f[R] option has no effect on the \\f[CB]\\-bottom\\f[R]\n@@ -948,1 +995,1 @@\n-The \\f[V]-nonavbar\\f[R] option is useful when you are interested only in\n+The \\f[CB]\\-nonavbar\\f[R] option is useful when you are interested only in\n@@ -951,0 +998,2 @@\n+.RS\n+.RE\n@@ -952,1 +1001,1 @@\n-\\f[V]--no-platform-links\\f[R]\n+.B \\f[CB]\\-\\-no\\-platform\\-links\\f[R]\n@@ -955,0 +1004,2 @@\n+.RS\n+.RE\n@@ -956,1 +1007,1 @@\n-\\f[V]-noqualifier\\f[R] \\f[I]name1\\f[R]\\f[V],\\f[R]\\f[I]name2...\\f[R]\n+.B \\f[CB]\\-noqualifier\\f[R] \\f[I]name1\\f[R]\\f[CB]:\\f[R]\\f[I]name2\\f[R]...\n@@ -960,2 +1011,0 @@\n-For historical reasons, \\f[V]:\\f[R] can be used anywhere in the argument\n-as a separator instead of \\f[V],\\f[R].\n@@ -965,1 +1014,1 @@\n-\\f[V]-noqualifier all\\f[R].\n+\\f[CB]\\-noqualifier\\ all\\f[R].\n@@ -967,2 +1016,2 @@\n-The following example omits \\f[V]java.lang\\f[R] and \\f[V]java.io\\f[R]\n-package qualifiers: \\f[V]-noqualifier java.lang:java.io\\f[R].\n+The following example omits \\f[CB]java.lang\\f[R] and \\f[CB]java.io\\f[R]\n+package qualifiers: \\f[CB]\\-noqualifier\\ java.lang:java.io\\f[R].\n@@ -971,2 +1020,2 @@\n-\\f[V]java\\f[R] and \\f[V]com.sun\\f[R] subpackages, but not\n-\\f[V]javax: -noqualifier java.*:com.sun.*\\f[R].\n+\\f[CB]java\\f[R] and \\f[CB]com.sun\\f[R] subpackages, but not\n+\\f[CB]javax:\\ \\-noqualifier\\ java.*:com.sun.*\\f[R].\n@@ -976,1 +1025,1 @@\n-This rule is in effect whether or not the \\f[V]-noqualifier\\f[R] option\n+This rule is in effect whether or not the \\f[CB]\\-noqualifier\\f[R] option\n@@ -980,3 +1029,5 @@\n-\\f[V]-nosince\\f[R]\n-Omits from the generated documents the \\f[V]Since\\f[R] sections\n-associated with the \\f[V]\\[at]since\\f[R] tags.\n+.B \\f[CB]\\-nosince\\f[R]\n+Omits from the generated documents the \\f[CB]Since\\f[R] sections\n+associated with the \\f[CB]\\@since\\f[R] tags.\n+.RS\n+.RE\n@@ -984,1 +1035,1 @@\n-\\f[V]-notimestamp\\f[R]\n+.B \\f[CB]\\-notimestamp\\f[R]\n@@ -987,8 +1038,10 @@\n-The \\f[V]-notimestamp\\f[R] option is useful when you want to run the\n-\\f[V]javadoc\\f[R] tool on two source bases and get the differences\n-between \\f[V]diff\\f[R] them, because it prevents time stamps from\n-causing a \\f[V]diff\\f[R] (which would otherwise be a \\f[V]diff\\f[R] on\n-every page).\n-The time stamp includes the \\f[V]javadoc\\f[R] tool release number.\n-.TP\n-\\f[V]-notree\\f[R]\n+The \\f[CB]\\-notimestamp\\f[R] option is useful when you want to run the\n+\\f[CB]javadoc\\f[R] tool on two source bases and get the differences\n+between \\f[CB]diff\\f[R] them, because it prevents time stamps from causing\n+a \\f[CB]diff\\f[R] (which would otherwise be a \\f[CB]diff\\f[R] on every\n+page).\n+The time stamp includes the \\f[CB]javadoc\\f[R] tool release number.\n+.RS\n+.RE\n+.TP\n+.B \\f[CB]\\-notree\\f[R]\n@@ -1000,0 +1053,2 @@\n+.RS\n+.RE\n@@ -1001,1 +1056,1 @@\n-\\f[V]--override-methods\\f[R] (\\f[V]detail\\f[R]|\\f[V]summary\\f[R])\n+.B \\f[CB]\\-\\-override\\-methods\\f[R] (\\f[CB]detail\\f[R]|\\f[CB]summary\\f[R])\n@@ -1003,1 +1058,3 @@\n-The default is \\f[V]detail\\f[R].\n+The default is \\f[CB]detail\\f[R].\n+.RS\n+.RE\n@@ -1005,2 +1062,2 @@\n-\\f[V]-overview\\f[R] \\f[I]filename\\f[R]\n-Specifies that the \\f[V]javadoc\\f[R] tool should retrieve the text for\n+.B \\f[CB]\\-overview\\f[R] \\f[I]filename\\f[R]\n+Specifies that the \\f[CB]javadoc\\f[R] tool should retrieve the text for\n@@ -1008,2 +1065,2 @@\n-\\f[V]filename\\f[R] and place it on the Overview page\n-(\\f[V]overview-summary.html\\f[R]).\n+\\f[CB]filename\\f[R] and place it on the Overview page\n+(\\f[CB]overview\\-summary.html\\f[R]).\n@@ -1014,1 +1071,1 @@\n-While you can use any name you want for the \\f[V]filename\\f[R] value and\n+While you can use any name you want for the \\f[CB]filename\\f[R] value and\n@@ -1016,1 +1073,1 @@\n-\\f[V]overview.html\\f[R] and place it in the source tree at the directory\n+\\f[CB]overview.html\\f[R] and place it in the source tree at the directory\n@@ -1019,1 +1076,1 @@\n-the \\f[V]-sourcepath\\f[R] option points to this file.\n+the \\f[CB]\\-sourcepath\\f[R] option points to this file.\n@@ -1022,2 +1079,2 @@\n-\\f[V]java.lang\\f[R] package is \\f[V]src\/classes\/java\/lang\/\\f[R], then\n-you could place the overview file at src\/classes\/overview.html.\n+\\f[CB]java.lang\\f[R] package is \\f[CB]src\/classes\/java\/lang\/\\f[R], then you\n+could place the overview file at src\/classes\/overview.html.\n@@ -1026,3 +1083,3 @@\n-\\f[V]java.lang\\f[R] package is\n-\\f[V]src\\[rs]classes\\[rs]java\\[rs]lang\\[rs]\\f[R], then you could place\n-the overview file at \\f[V]src\\[rs]classes\\[rs]overview.html\\f[R]\n+\\f[CB]java.lang\\f[R] package is \\f[CB]src\\\\classes\\\\java\\\\lang\\\\\\f[R], then\n+you could place the overview file at\n+\\f[CB]src\\\\classes\\\\overview.html\\f[R]\n@@ -1031,2 +1088,2 @@\n-names to the \\f[V]javadoc\\f[R] tool.\n-The title on the overview page is set by \\f[V]-doctitle\\f[R].\n+names to the \\f[CB]javadoc\\f[R] tool.\n+The title on the overview page is set by \\f[CB]\\-doctitle\\f[R].\n@@ -1035,2 +1092,2 @@\n-\\f[V]-serialwarn\\f[R]\n-Generates compile-time warnings for missing \\f[V]\\[at]serial\\f[R] tags.\n+.B \\f[CB]\\-serialwarn\\f[R]\n+Generates compile\\-time warnings for missing \\f[CB]\\@serial\\f[R] tags.\n@@ -1039,2 +1096,3 @@\n-document default serializable fields and \\f[V]writeExternal\\f[R]\n-methods.\n+document default serializable fields and \\f[CB]writeExternal\\f[R] methods.\n+.RS\n+.RE\n@@ -1042,1 +1100,1 @@\n-\\f[V]--since\\f[R] \\f[I]release\\f[R](\\f[V],\\f[R]\\f[I]release\\f[R])*\n+.B \\f[CB]\\-\\-since\\f[R] \\f[I]release\\f[R](\\f[CB],\\f[R]\\f[I]release\\f[R])*\n@@ -1047,1 +1105,1 @@\n-If the \\f[V]\\[at]since\\f[R] tag in the \\f[V]javadoc\\f[R] comment of an\n+If the \\f[CB]\\@since\\f[R] tag in the \\f[CB]javadoc\\f[R] comment of an\n@@ -1050,1 +1108,1 @@\n-added in is included in a \\[dq]New API\\[dq] page.\n+added in is included in a \"New API\" page.\n@@ -1052,5 +1110,5 @@\n-If the \\[dq]Deprecated API\\[dq] page is generated and the\n-\\f[V]since\\f[R] element of the \\f[V]java.lang.Deprecated\\f[R] annotation\n-of a documented element matches a \\f[I]release\\f[R] in the option\n-arguments, information about the release the element was deprecated in\n-is added to the \\[dq]Deprecated API\\[dq] page.\n+If the \"Deprecated API\" page is generated and the \\f[CB]since\\f[R] element\n+of the \\f[CB]java.lang.Deprecated\\f[R] annotation of a documented element\n+matches a \\f[I]release\\f[R] in the option arguments, information about\n+the release the element was deprecated in is added to the \"Deprecated\n+API\" page.\n@@ -1058,1 +1116,1 @@\n-Releases are compared using case-sensitive string comparison.\n+Releases are compared using case\\-sensitive string comparison.\n@@ -1061,3 +1119,2 @@\n-\\f[V]--since-label\\f[R] \\f[I]text\\f[R]\n-Specifies the \\f[I]text\\f[R] to use in the heading of the \\[dq]New\n-API\\[dq] page.\n+.B \\f[CB]\\-\\-since\\-label\\f[R] \\f[I]text\\f[R]\n+Specifies the \\f[I]text\\f[R] to use in the heading of the \"New API\" page.\n@@ -1066,1 +1123,3 @@\n-\\[dq]New API in release 2.0\\[dq], or \\[dq]New API since release 1\\[dq].\n+\"New API in release 2.0\", or \"New API since release 1\".\n+.RS\n+.RE\n@@ -1068,1 +1127,1 @@\n-\\f[V]--snippet-path\\f[R] \\f[I]snippetpathlist\\f[R]\n+.B \\f[CB]\\-\\-snippet\\-path\\f[R] \\f[I]snippetpathlist\\f[R]\n@@ -1071,5 +1130,6 @@\n-them with the platform path separator (\\f[V];\\f[R] on Windows;\n-\\f[V]:\\f[R] on other platforms.)\n-The Standard Doclet first searches the \\f[V]snippet-files\\f[R]\n-subdirectory in the package containing the snippet, and then searches\n-all the directories in the given list.\n+them with the platform path separator (\\f[CB];\\f[R] on Windows; \\f[CB]:\\f[R]\n+on other platforms.) The Standard Doclet first searches the\n+\\f[CB]snippet\\-files\\f[R] subdirectory in the package containing the\n+snippet, and then searches all the directories in the given list.\n+.RS\n+.RE\n@@ -1077,1 +1137,1 @@\n-\\f[V]-sourcetab\\f[R] \\f[I]tab-length\\f[R]\n+.B \\f[CB]\\-sourcetab\\f[R] \\f[I]tablength\\f[R]\n@@ -1079,0 +1139,2 @@\n+.RS\n+.RE\n@@ -1080,3 +1142,3 @@\n-\\f[V]--spec-base-url\\f[R] \\f[I]url\\f[R]\n-Specifies the base URL for relative URLs in \\f[V]\\[at]spec\\f[R] tags, to\n-be used when generating links to any external specifications.\n+.B \\f[CB]\\-\\-spec\\-base\\-url\\f[R] \\f[I]url\\f[R]\n+Specifies the base URL for relative URLs in \\f[CB]\\@spec\\f[R] tags, to be\n+used when generating links to any external specifications.\n@@ -1085,1 +1147,3 @@\n-The default value is equivalent to \\f[V]{\\[at]docRoot}\/..\/specs\\f[R].\n+The default value is equivalent to \\f[CB]{\\@docRoot}\/..\/specs\\f[R].\n+.RS\n+.RE\n@@ -1087,1 +1151,1 @@\n-\\f[V]-splitindex\\f[R]\n+.B \\f[CB]\\-splitindex\\f[R]\n@@ -1090,1 +1154,3 @@\n-non-alphabetical symbols.\n+non\\-alphabetical symbols.\n+.RS\n+.RE\n@@ -1092,1 +1158,1 @@\n-\\f[V]-tag\\f[R] \\f[I]name\\f[R]:\\f[I]locations\\f[R]:\\f[I]header\\f[R]\n+.B \\f[CB]\\-tag\\f[R] \\f[I]name\\f[R]:\\f[I]locations\\f[R]:\\f[I]header\\f[R]\n@@ -1094,3 +1160,3 @@\n-For the \\f[V]javadoc\\f[R] tool to spell-check tag names, it is important\n-to include a \\f[V]-tag\\f[R] option for every custom tag that is present\n-in the source code, disabling (with \\f[V]X\\f[R]) those that aren\\[aq]t\n+For the \\f[CB]javadoc\\f[R] tool to spell\\-check tag names, it is important\n+to include a \\f[CB]\\-tag\\f[R] option for every custom tag that is present\n+in the source code, disabling (with \\f[CB]X\\f[R]) those that aren\\[aq]t\n@@ -1098,4 +1164,2 @@\n-The colon (\\f[V]:\\f[R]) is always the separator.\n-To include a colon in the tag name, escape it with a backward slash\n-(\\f[V]\\[rs]\\f[R]).\n-The \\f[V]-tag\\f[R] option outputs the tag heading, \\f[I]header\\f[R], in\n+The colon (\\f[CB]:\\f[R]) is always the separator.\n+The \\f[CB]\\-tag\\f[R] option outputs the tag heading, \\f[I]header\\f[R], in\n@@ -1105,2 +1169,2 @@\n-The output is similar to standard one-argument tags, such as the\n-\\f[V]\\[at]return\\f[R] and \\f[V]\\[at]author\\f[R] tags.\n+The output is similar to standard one\\-argument tags, such as the\n+\\f[CB]\\@return\\f[R] and \\f[CB]\\@author\\f[R] tags.\n@@ -1109,3 +1173,0 @@\n-\\f[I]locations\\f[R] is a list of characters specifying the kinds of\n-declarations in which the tag may be used.\n-The following characters may be used, in either uppercase or lowercase:\n@@ -1113,25 +1174,0 @@\n-.IP \\[bu] 2\n-\\f[V]A\\f[R]: all declarations\n-.IP \\[bu] 2\n-\\f[V]C\\f[R]: constructors\n-.IP \\[bu] 2\n-\\f[V]F\\f[R]: fields\n-.IP \\[bu] 2\n-\\f[V]M\\f[R]: methods\n-.IP \\[bu] 2\n-\\f[V]O\\f[R]: the overview page and other documentation files in\n-\\f[V]doc-files\\f[R] subdirectories\n-.IP \\[bu] 2\n-\\f[V]P\\f[R]: packages\n-.IP \\[bu] 2\n-\\f[V]S\\f[R]: modules\n-.IP \\[bu] 2\n-\\f[V]T\\f[R]: types (classes and interfaces)\n-.IP \\[bu] 2\n-\\f[V]X\\f[R]: nowhere: the tag is disabled, and will be ignored\n-.PP\n-The order in which tags are given on the command line will be used as\n-the order in which the tags appear in the generated output.\n-You can include standard tags in the order given on the command line by\n-using the \\f[V]-tag\\f[R] option with no \\f[I]locations\\f[R] or\n-\\f[I]header\\f[R].\n@@ -1140,1 +1176,1 @@\n-\\f[V]-taglet\\f[R] \\f[I]class\\f[R]\n+.B \\f[CB]\\-taglet\\f[R] \\f[I]class\\f[R]\n@@ -1160,1 +1196,1 @@\n-Use the \\f[V]-tagletpath\\f[R] option to specify the path to the taglet.\n+Use the \\f[CB]\\-tagletpath\\f[R] option to specify the path to the taglet.\n@@ -1166,7 +1202,7 @@\n--taglet com.sun.tools.doclets.ToDoTaglet\n--tagletpath \/home\/taglets\n--tag return\n--tag param\n--tag todo\n--tag throws\n--tag see\n+\\-taglet\\ com.sun.tools.doclets.ToDoTaglet\n+\\-tagletpath\\ \/home\/taglets\n+\\-tag\\ return\n+\\-tag\\ param\n+\\-tag\\ todo\n+\\-tag\\ throws\n+\\-tag\\ see\n@@ -1176,2 +1212,2 @@\n-Alternately, you can use the \\f[V]-taglet\\f[R] option in place of its\n-\\f[V]-tag\\f[R] option, but that might be difficult to read.\n+Alternately, you can use the \\f[CB]\\-taglet\\f[R] option in place of its\n+\\f[CB]\\-tag\\f[R] option, but that might be difficult to read.\n@@ -1180,1 +1216,1 @@\n-\\f[V]-tagletpath\\f[R] \\f[I]tagletpathlist\\f[R]\n+.B \\f[CB]\\-tagletpath\\f[R] \\f[I]tagletpathlist\\f[R]\n@@ -1183,4 +1219,5 @@\n-them with the platform path separator (\\f[V];\\f[R] on Windows;\n-\\f[V]:\\f[R] on other platforms.)\n-The \\f[V]javadoc\\f[R] tool searches all subdirectories of the specified\n-paths.\n+them with the platform path separator (\\f[CB];\\f[R] on Windows; \\f[CB]:\\f[R]\n+on other platforms.) The \\f[CB]javadoc\\f[R] tool searches all\n+subdirectories of the specified paths.\n+.RS\n+.RE\n@@ -1188,1 +1225,1 @@\n-\\f[V]-top\\f[R] \\f[I]html-code\\f[R]\n+.B \\f[CB]\\-top\\f[R] \\f[I]html\\-code\\f[R]\n@@ -1190,0 +1227,2 @@\n+.RS\n+.RE\n@@ -1191,1 +1230,1 @@\n-\\f[V]-use\\f[R]\n+.B \\f[CB]\\-use\\f[R]\n@@ -1199,5 +1238,5 @@\n-For example, you can look at the Use page for the \\f[V]String\\f[R] type.\n-Because the \\f[V]getName\\f[R] method in the \\f[V]java.awt.Font\\f[R]\n-class returns type \\f[V]String\\f[R], the \\f[V]getName\\f[R] method uses\n-\\f[V]String\\f[R] and so the \\f[V]getName\\f[R] method appears on the Use\n-page for \\f[V]String\\f[R].\n+For example, you can look at the Use page for the \\f[CB]String\\f[R] type.\n+Because the \\f[CB]getName\\f[R] method in the \\f[CB]java.awt.Font\\f[R] class\n+returns type \\f[CB]String\\f[R], the \\f[CB]getName\\f[R] method uses\n+\\f[CB]String\\f[R] and so the \\f[CB]getName\\f[R] method appears on the Use\n+page for \\f[CB]String\\f[R].\n@@ -1205,1 +1244,1 @@\n-When a method uses \\f[V]String\\f[R] in its implementation, but\n+When a method uses \\f[CB]String\\f[R] in its implementation, but\n@@ -1207,1 +1246,1 @@\n-isn\\[aq]t considered a use of \\f[V]String\\f[R].To access the generated\n+isn\\[aq]t considered a use of \\f[CB]String\\f[R].To access the generated\n@@ -1210,0 +1249,2 @@\n+.RS\n+.RE\n@@ -1211,1 +1252,1 @@\n-\\f[V]-version\\f[R]\n+.B \\f[CB]\\-version\\f[R]\n@@ -1214,8 +1255,10 @@\n-To find out what version of the \\f[V]javadoc\\f[R] tool you are using,\n-use the \\f[V]-J-version\\f[R] option.\n-.TP\n-\\f[V]-windowtitle\\f[R] \\f[I]title\\f[R]\n-Specifies the title to be placed in the HTML \\f[V]<title>\\f[R] tag.\n-The text specified in the \\f[V]title\\f[R] tag appears in the window\n-title and in any browser bookmarks (favorite places) that someone\n-creates for this page.\n+To find out what version of the \\f[CB]javadoc\\f[R] tool you are using, use\n+the \\f[CB]\\-J\\-version\\f[R] option.\n+.RS\n+.RE\n+.TP\n+.B \\f[CB]\\-windowtitle\\f[R] \\f[I]title\\f[R]\n+Specifies the title to be placed in the HTML \\f[CB]<title>\\f[R] tag.\n+The text specified in the \\f[CB]title\\f[R] tag appears in the window title\n+and in any browser bookmarks (favorite places) that someone creates for\n+this page.\n@@ -1225,4 +1268,4 @@\n-\\f[V]title\\f[R] tag.\n-If the \\f[V]-windowtitle\\f[R] option is omitted, then the\n-\\f[V]javadoc\\f[R] tool uses the value of the \\f[V]-doctitle\\f[R] option\n-for the \\f[V]-windowtitle\\f[R] option.\n+\\f[CB]title\\f[R] tag.\n+If the \\f[CB]\\-windowtitle\\f[R] option is omitted, then the\n+\\f[CB]javadoc\\f[R] tool uses the value of the \\f[CB]\\-doctitle\\f[R] option\n+for the \\f[CB]\\-windowtitle\\f[R] option.\n@@ -1230,1 +1273,3 @@\n-\\f[V]javadoc -windowtitle \\[dq]My Library\\[dq] com.mypackage\\f[R].\n+\\f[CB]javadoc\\ \\-windowtitle\\ \"My\\ Library\"\\ com.mypackage\\f[R].\n+.RS\n+.RE\n@@ -1238,1 +1283,1 @@\n-\\f[V]--date\\f[R] \\f[I]date-and-time\\f[R]\n+.B \\f[CB]\\-\\-date\\f[R] \\f[I]date\\-and\\-time\\f[R]\n@@ -1241,1 +1286,1 @@\n-[https:\/\/www.iso.org\/iso-8601-date-and-time-format.html] format.\n+[https:\/\/www.iso.org\/iso\\-8601\\-date\\-and\\-time\\-format.html] format.\n@@ -1244,2 +1289,2 @@\n-It is an error to specify both \\f[V]-notimestamp\\f[R] and\n-\\f[V]--date\\f[R].\n+It is an error to specify both \\f[CB]\\-notimestamp\\f[R] and\n+\\f[CB]\\-\\-date\\f[R].\n@@ -1247,1 +1292,1 @@\n-a \\f[B]reproducible build\\f[R] [https:\/\/reproducible-builds.org\/].\n+a \\f[B]reproducible build\\f[R] [https:\/\/reproducible\\-builds.org\/].\n@@ -1255,1 +1300,1 @@\n-javadoc --date 2022-02-01T17:41:59-08:00 mypackage\n+javadoc\\ \\-\\-date\\ 2022\\-02\\-01T17:41:59\\-08:00\\ mypackage\n@@ -1260,1 +1305,1 @@\n-\\f[V]--legal-notices\\f[R] (\\f[V]default\\f[R]|\\f[V]none\\f[R]|\\f[I]directory\\f[R])\n+.B \\f[CB]\\-\\-legal\\-notices\\f[R] (\\f[CB]default\\f[R]|\\f[CB]none\\f[R]|\\f[I]directory\\f[R])\n@@ -1264,2 +1309,2 @@\n-\\f[V]default\\f[R], the files are copied from the default location.\n-If the argument is used with value \\f[V]none\\f[R], no files are copied.\n+\\f[CB]default\\f[R], the files are copied from the default location.\n+If the argument is used with value \\f[CB]none\\f[R], no files are copied.\n@@ -1268,0 +1313,2 @@\n+.RS\n+.RE\n@@ -1269,2 +1316,5 @@\n-\\f[V]--no-frames\\f[R]\n-This option is a no-op and is just retained for backwards compatibility.\n+.B \\f[CB]\\-\\-no\\-frames\\f[R]\n+This option is a no\\-op and is just retained for backwards\n+compatibility.\n+.RS\n+.RE\n@@ -1272,1 +1322,1 @@\n-\\f[V]-Xdoclint\\f[R]\n+.B \\f[CB]\\-Xdoclint\\f[R]\n@@ -1276,2 +1326,2 @@\n-By default, the \\f[V]-Xdoclint\\f[R] option is enabled.\n-Disable it with the option \\f[V]-Xdoclint:none\\f[R].\n+By default, the \\f[CB]\\-Xdoclint\\f[R] option is enabled.\n+Disable it with the option \\f[CB]\\-Xdoclint:none\\f[R].\n@@ -1282,1 +1332,1 @@\n-\\f[V]-Xdoclint:\\f[R]\\f[I]flag\\f[R],\\f[I]flag\\f[R],...\n+.B \\f[CB]\\-Xdoclint:\\f[R]\\f[I]flag\\f[R],\\f[I]flag\\f[R],...\n@@ -1287,4 +1337,4 @@\n-Each \\f[I]flag\\f[R] can be one of \\f[V]all\\f[R], \\f[V]none\\f[R], or\n-\\f[V][-]\\f[R]\\f[I]group\\f[R] where \\f[I]group\\f[R] has one of the\n-following values: \\f[V]accessibility\\f[R], \\f[V]html\\f[R],\n-\\f[V]missing\\f[R], \\f[V]reference\\f[R], \\f[V]syntax\\f[R].\n+Each \\f[I]flag\\f[R] can be one of \\f[CB]all\\f[R], \\f[CB]none\\f[R], or\n+\\f[CB][\\-]\\f[R]\\f[I]group\\f[R] where \\f[I]group\\f[R] has one of the\n+following values: \\f[CB]accessibility\\f[R], \\f[CB]html\\f[R],\n+\\f[CB]missing\\f[R], \\f[CB]reference\\f[R], \\f[CB]syntax\\f[R].\n@@ -1294,1 +1344,1 @@\n-\\f[V]-Xdoclint:...\\f[R] option, listing all the desired flags, or you\n+\\f[CB]\\-Xdoclint:...\\f[R] option, listing all the desired flags, or you\n@@ -1297,1 +1347,1 @@\n-syntax, and accessibility issues in the file \\f[V]MyFile.java\\f[R].\n+syntax, and accessibility issues in the file \\f[CB]MyFile.java\\f[R].\n@@ -1301,2 +1351,2 @@\n-javadoc -Xdoclint:html -Xdoclint:syntax -Xdoclint:accessibility MyFile.java\n-javadoc -Xdoclint:html,syntax,accessibility MyFile.java\n+javadoc\\ \\-Xdoclint:html\\ \\-Xdoclint:syntax\\ \\-Xdoclint:accessibility\\ MyFile.java\n+javadoc\\ \\-Xdoclint:html,syntax,accessibility\\ MyFile.java\n@@ -1308,1 +1358,1 @@\n-\\f[V]-Xdoclint:none\\f[R] --- disables all checks\n+\\f[CB]\\-Xdoclint:none\\f[R] \\-\\-\\- disables all checks\n@@ -1310,1 +1360,1 @@\n-\\f[V]-Xdoclint:\\f[R]\\f[I]group\\f[R] --- enables \\f[I]group\\f[R] checks\n+\\f[CB]\\-Xdoclint:\\f[R]\\f[I]group\\f[R] \\-\\-\\- enables \\f[I]group\\f[R] checks\n@@ -1312,1 +1362,1 @@\n-\\f[V]-Xdoclint:all\\f[R] --- enables all groups of checks\n+\\f[CB]\\-Xdoclint:all\\f[R] \\-\\-\\- enables all groups of checks\n@@ -1314,2 +1364,2 @@\n-\\f[V]-Xdoclint:all,-\\f[R]\\f[I]group\\f[R] --- enables all checks except\n-\\f[I]group\\f[R] checks\n+\\f[CB]\\-Xdoclint:all,\\-\\f[R]\\f[I]group\\f[R] \\-\\-\\- enables all checks\n+except \\f[I]group\\f[R] checks\n@@ -1320,1 +1370,1 @@\n-\\f[V]-Xdoclint\/package:\\f[R][\\f[V]-\\f[R]]\\f[I]packages\\f[R]\n+.B \\f[CB]\\-Xdoclint\/package:\\f[R][\\f[CB]\\-\\f[R]]\\f[I]packages\\f[R]\n@@ -1324,1 +1374,1 @@\n-name prefix followed by \\f[V]*\\f[R], which expands to all subpackages of\n+name prefix followed by \\f[CB]*\\f[R], which expands to all subpackages of\n@@ -1326,1 +1376,1 @@\n-Prefix the package specifier with \\f[V]-\\f[R] to disable checks for the\n+Prefix the package specifier with \\f[CB]\\-\\f[R] to disable checks for the\n@@ -1333,2 +1383,2 @@\n-\\f[V]-Xdocrootparent\\f[R] \\f[I]url\\f[R]\n-Replaces all \\f[V]\\[at]docRoot\\f[R] items followed by \\f[V]\/..\\f[R] in\n+.B \\f[CB]\\-Xdocrootparent\\f[R] \\f[I]url\\f[R]\n+Replaces all \\f[CB]\\@docRoot\\f[R] items followed by \\f[CB]\/..\\f[R] in\n@@ -1336,0 +1386,2 @@\n+.RS\n+.RE\n@@ -1348,2 +1400,1 @@\n-\\f[B]suppressed\\f[R] by using \\f[V]\\[at]SuppressWarnings\\f[R]\n-annotations.\n+\\f[B]suppressed\\f[R] by using \\f[CB]\\@SuppressWarnings\\f[R] annotations.\n@@ -1351,1 +1402,1 @@\n-When invoked from \\f[V]javadoc\\f[R], by default DocLint checks all\n+When invoked from \\f[CB]javadoc\\f[R], by default DocLint checks all\n@@ -1353,1 +1404,1 @@\n-It thus relies on other command-line options to determine which\n+It thus relies on other command\\-line options to determine which\n@@ -1358,1 +1409,1 @@\n-documented in the generated \\f[V]Serialized Forms\\f[R] page.\n+documented in the generated \\f[CB]Serialized\\ Forms\\f[R] page.\n@@ -1360,3 +1411,3 @@\n-In contrast, when DocLint is invoked from \\f[V]javac\\f[R], DocLint\n-solely relies on the various \\f[V]-Xdoclint...\\f[R] options to determine\n-which documentation comments to check.\n+In contrast, when DocLint is invoked from \\f[CB]javac\\f[R], DocLint solely\n+relies on the various \\f[CB]\\-Xdoclint...\\f[R] options to determine which\n+documentation comments to check.\n@@ -1374,1 +1425,1 @@\n-command-line options, or suppressed with \\f[V]\\[at]SuppressWarnings\\f[R]\n+command\\-line options, or suppressed with \\f[CB]\\@SuppressWarnings\\f[R]\n@@ -1379,4 +1430,4 @@\n-\\f[V]accessibility\\f[R] --- Checks for issues related to accessibility.\n-For example, no \\f[V]alt\\f[R] attribute specified in an \\f[V]<img>\\f[R]\n-element, or no caption or summary attributes specified in a\n-\\f[V]<table>\\f[R] element.\n+\\f[CB]accessibility\\f[R] \\-\\-\\- Checks for issues related to\n+accessibility. For example, no \\f[CB]alt\\f[R] attribute specified in an\n+\\f[CB]<img>\\f[R] element, or no caption or summary attributes specified in\n+a \\f[CB]<table>\\f[R] element.\n@@ -1386,1 +1437,1 @@\n-expected to report an error in the files generated by \\f[V]javadoc\\f[R].\n+expected to report an error in the files generated by \\f[CB]javadoc\\f[R].\n@@ -1389,1 +1440,1 @@\n-[https:\/\/www.w3.org\/WAI\/standards-guidelines\/wcag\/].\n+[https:\/\/www.w3.org\/WAI\/standards\\-guidelines\/wcag\/].\n@@ -1392,3 +1443,3 @@\n-\\f[V]html\\f[R] --- Detects common high-level HTML issues.\n-For example, putting block elements inside inline elements, or not\n-closing elements that require an end tag.\n+\\f[CB]html\\f[R] \\-\\-\\- Detects common high\\-level HTML issues. For\n+example, putting block elements inside inline elements, or not closing\n+elements that require an end tag.\n@@ -1398,1 +1449,1 @@\n-expected to report an error in the files generated by \\f[V]javadoc\\f[R].\n+expected to report an error in the files generated by \\f[CB]javadoc\\f[R].\n@@ -1404,3 +1455,3 @@\n-\\f[V]missing\\f[R] --- Checks for missing documentation comments or tags.\n-For example, a missing comment on a class declaration, or a missing\n-\\f[V]\\[at]param\\f[R] or \\f[V]\\[at]return\\f[R] tag in the comment for a\n+\\f[CB]missing\\f[R] \\-\\-\\- Checks for missing documentation comments or\n+tags. For example, a missing comment on a class declaration, or a\n+missing \\f[CB]\\@param\\f[R] or \\f[CB]\\@return\\f[R] tag in the comment for a\n@@ -1413,1 +1464,1 @@\n-\\f[V]javadoc\\f[R].\n+\\f[CB]javadoc\\f[R].\n@@ -1416,5 +1467,4 @@\n-\\f[V]reference\\f[R] --- Checks for issues relating to the references to\n-Java API elements from documentation comment tags.\n-For example, the reference in \\f[V]\\[at]see\\f[R] or\n-\\f[V]{\\[at]link ...}\\f[R] cannot be found, or a bad name is given for\n-\\f[V]\\[at]param\\f[R] or \\f[V]\\[at]throws\\f[R].\n+\\f[CB]reference\\f[R] \\-\\-\\- Checks for issues relating to the references\n+to Java API elements from documentation comment tags. For example, the\n+reference in \\f[CB]\\@see\\f[R] or \\f[CB]{\\@link\\ ...}\\f[R] cannot be found,\n+or a bad name is given for \\f[CB]\\@param\\f[R] or \\f[CB]\\@throws\\f[R].\n@@ -1428,4 +1478,4 @@\n-\\f[V]syntax\\f[R] --- Checks for low-level syntactic issues in\n-documentation comments.\n-For example, unescaped angle brackets (\\f[V]<\\f[R] and \\f[V]>\\f[R]) and\n-ampersands (\\f[V]&\\f[R]) and invalid documentation comment tags.\n+\\f[CB]syntax\\f[R] \\-\\-\\- Checks for low\\-level syntactic issues in\n+documentation comments. For example, unescaped angle brackets\n+(\\f[CB]<\\f[R] and \\f[CB]>\\f[R]) and ampersands (\\f[CB]&\\f[R]) and invalid\n+documentation comment tags.\n@@ -1440,1 +1490,1 @@\n-arguments for an \\f[V]\\[at]SuppressWarnings\\f[R] annotation.\n+arguments for an \\f[CB]\\@SuppressWarnings\\f[R] annotation.\n@@ -1442,1 +1492,1 @@\n-\\f[V]doclint\\f[R]\n+\\f[CB]doclint\\f[R]\n@@ -1444,1 +1494,1 @@\n-\\f[V]doclint:\\f[R]\\f[I]LIST\\f[R]\n+\\f[CB]doclint:\\f[R]\\f[I]LIST\\f[R]\n@@ -1446,3 +1496,3 @@\n-where \\f[I]LIST\\f[R] is a comma-separated list of one or more of\n-\\f[V]accessibility\\f[R], \\f[V]html\\f[R], \\f[V]missing\\f[R],\n-\\f[V]syntax\\f[R], \\f[V]reference\\f[R].\n+where \\f[I]LIST\\f[R] is a comma\\-separated list of one or more of\n+\\f[CB]accessibility\\f[R], \\f[CB]html\\f[R], \\f[CB]missing\\f[R],\n+\\f[CB]syntax\\f[R], \\f[CB]reference\\f[R].\n@@ -1451,5 +1501,5 @@\n-by the command-line \\f[V]-Xdoclint\\f[R] option for \\f[V]javac\\f[R] and\n-\\f[V]javadoc\\f[R].\n-(This is the same convention honored by the \\f[V]javac\\f[R]\n-\\f[V]-Xlint\\f[R] option and the corresponding names supported by\n-\\f[V]\\[at]SuppressWarnings\\f[R].)\n+by the command\\-line \\f[CB]\\-Xdoclint\\f[R] option for \\f[CB]javac\\f[R] and\n+\\f[CB]javadoc\\f[R].\n+(This is the same convention honored by the \\f[CB]javac\\f[R]\n+\\f[CB]\\-Xlint\\f[R] option and the corresponding names supported by\n+\\f[CB]\\@SuppressWarnings\\f[R].)\n@@ -1461,1 +1511,1 @@\n-\\f[V]\\[at]SuppressWarnings(\\[dq]doclint:accessibility,missing\\[dq])\\f[R]\n+\\f[CB]\\@SuppressWarnings(\"doclint:accessibility,missing\")\\f[R]\n@@ -1463,1 +1513,1 @@\n-\\f[V]\\[at]SuppressWarnings(\\[dq]doclint:accessibility\\[dq], \\[dq]doclint:missing\\[dq])\\f[R]\n+\\f[CB]\\@SuppressWarnings(\"doclint:accessibility\",\\ \"doclint:missing\")\\f[R]\n@@ -1466,1 +1516,1 @@\n-the presence of \\f[V]\\[at]SuppressWarnings\\f[R] on the associated\n+the presence of \\f[CB]\\@SuppressWarnings\\f[R] on the associated\n@@ -1469,3 +1519,2 @@\n-simple string \\f[V]doclint\\f[R] or the longer form\n-\\f[V]doclint:LIST\\f[R] where \\f[I]LIST\\f[R] contains the name of the\n-group for the issue.\n+simple string \\f[CB]doclint\\f[R] or the longer form \\f[CB]doclint:LIST\\f[R]\n+where \\f[I]LIST\\f[R] contains the name of the group for the issue.\n@@ -1473,4 +1522,4 @@\n-\\f[I]Note:\\f[R] as with other uses of \\f[V]\\[at]SuppressWarnings\\f[R],\n-using the annotation on a module or package declaration only affects\n-that declaration; it does not affect the contents of the module or\n-package in other source files.\n+\\f[I]Note:\\f[R] as with other uses of \\f[CB]\\@SuppressWarnings\\f[R], using\n+the annotation on a module or package declaration only affects that\n+declaration; it does not affect the contents of the module or package in\n+other source files.\n@@ -1479,2 +1528,2 @@\n-appropriate \\f[V]\\[at]SuppressWarnings\\f[R] annotation: this includes\n-errors as well as warnings.\n+appropriate \\f[CB]\\@SuppressWarnings\\f[R] annotation: this includes errors\n+as well as warnings.\n@@ -1483,5 +1532,4 @@\n-If an annotation of \\f[V]\\[at]SuppressWarnings(\\[dq]doclint\\[dq])\\f[R]\n-is given on a top-level declaration, all DocLint messages for that\n-declaration and any enclosed declarations will be suppressed; it is not\n-possible to selectively re-enable messages for issues in enclosed\n-declarations.\n+If an annotation of \\f[CB]\\@SuppressWarnings(\"doclint\")\\f[R] is given on a\n+top\\-level declaration, all DocLint messages for that declaration and\n+any enclosed declarations will be suppressed; it is not possible to\n+selectively re\\-enable messages for issues in enclosed declarations.\n@@ -1490,3 +1538,2 @@\n-DocLint is a utility built into \\f[V]javac\\f[R] and \\f[V]javadoc\\f[R]\n-that checks the content of documentation comments, as found in source\n-files.\n+DocLint is a utility built into \\f[CB]javac\\f[R] and \\f[CB]javadoc\\f[R] that\n+checks the content of documentation comments, as found in source files.\n@@ -1494,1 +1541,1 @@\n-output generated from those documentation comments by \\f[V]javadoc\\f[R]\n+output generated from those documentation comments by \\f[CB]javadoc\\f[R]\n@@ -1503,2 +1550,2 @@\n-comments, the Standard Doclet itself, user-provided taglets, and content\n-supplied via command-line options.\n+comments, the Standard Doclet itself, user\\-provided taglets, and\n+content supplied via command\\-line options.\n@@ -1516,2 +1563,2 @@\n-\\f[V]\\[at]return\\f[R] tag in a method returning \\f[V]void\\f[R], or an\n-\\f[V]\\[at]param\\f[R] tag describing a non-existent parameter.\n+\\f[CB]\\@return\\f[R] tag in a method returning \\f[CB]void\\f[R], or an\n+\\f[CB]\\@param\\f[R] tag describing a non\\-existent parameter.\n@@ -1519,1 +1566,1 @@\n-links, or errors in user-provided custom taglets, or problems in the\n+links, or errors in user\\-provided custom taglets, or problems in the\n","filename":"src\/jdk.javadoc\/share\/man\/javadoc.1","additions":639,"deletions":592,"binary":false,"changes":1231,"status":"modified"},{"patch":"@@ -22,1 +22,1 @@\n-.\\\" Automatically generated by Pandoc 2.19.2\n+.\\\" Automatically generated by Pandoc 2.3.1\n@@ -24,15 +24,1 @@\n-.\\\" Define V font for inline verbatim, using C font in formats\n-.\\\" that render this, and otherwise B font.\n-.ie \"\\f[CB]x\\f[R]\"x\" \\{\\\n-. ftr V B\n-. ftr VI BI\n-. ftr VB B\n-. ftr VBI BI\n-.\\}\n-.el \\{\\\n-. ftr V CR\n-. ftr VI CI\n-. ftr VB CB\n-. ftr VBI CBI\n-.\\}\n-.TH \"JCMD\" \"1\" \"2023\" \"JDK 20-ea\" \"JDK Commands\"\n+.TH \"JCMD\" \"1\" \"2023\" \"JDK 20\\-ea\" \"JDK Commands\"\n@@ -42,1 +28,1 @@\n-jcmd - send diagnostic command requests to a running Java Virtual\n+jcmd \\- send diagnostic command requests to a running Java Virtual\n@@ -46,3 +32,2 @@\n-\\f[V]jcmd\\f[R] [\\f[I]pid\\f[R] | \\f[I]main-class\\f[R]]\n-\\f[I]command\\f[R]...\n-| \\f[V]PerfCounter.print\\f[R] | \\f[V]-f\\f[R] \\f[I]filename\\f[R]\n+\\f[CB]jcmd\\f[R] [\\f[I]pid\\f[R] | \\f[I]main\\-class\\f[R]] \\f[I]command\\f[R]...\n+| \\f[CB]PerfCounter.print\\f[R] | \\f[CB]\\-f\\f[R] \\f[I]filename\\f[R]\n@@ -50,1 +35,1 @@\n-\\f[V]jcmd\\f[R] [\\f[V]-l\\f[R]]\n+\\f[CB]jcmd\\f[R] [\\f[CB]\\-l\\f[R]]\n@@ -52,1 +37,1 @@\n-\\f[V]jcmd\\f[R] \\f[V]-h\\f[R]\n+\\f[CB]jcmd\\f[R] \\f[CB]\\-h\\f[R]\n@@ -54,2 +39,2 @@\n-\\f[I]pid\\f[R]\n-When used, the \\f[V]jcmd\\f[R] utility sends the diagnostic command\n+.B \\f[I]pid\\f[R]\n+When used, the \\f[CB]jcmd\\f[R] utility sends the diagnostic command\n@@ -57,0 +42,2 @@\n+.RS\n+.RE\n@@ -58,2 +45,2 @@\n-\\f[I]main-class\\f[R]\n-When used, the \\f[V]jcmd\\f[R] utility sends the diagnostic command\n+.B \\f[I]main\\-class\\f[R]\n+When used, the \\f[CB]jcmd\\f[R] utility sends the diagnostic command\n@@ -61,0 +48,2 @@\n+.RS\n+.RE\n@@ -62,2 +51,2 @@\n-\\f[I]command\\f[R]\n-The \\f[V]command\\f[R] must be a valid \\f[V]jcmd\\f[R] command for the\n+.B \\f[I]command\\f[R]\n+The \\f[CB]command\\f[R] must be a valid \\f[CB]jcmd\\f[R] command for the\n@@ -65,2 +54,2 @@\n-The list of available commands for \\f[V]jcmd\\f[R] is obtained by running\n-the \\f[V]help\\f[R] command (\\f[V]jcmd\\f[R] \\f[I]pid\\f[R] \\f[V]help\\f[R])\n+The list of available commands for \\f[CB]jcmd\\f[R] is obtained by running\n+the \\f[CB]help\\f[R] command (\\f[CB]jcmd\\f[R] \\f[I]pid\\f[R] \\f[CB]help\\f[R])\n@@ -68,1 +57,1 @@\n-If the \\f[I]pid\\f[R] is \\f[V]0\\f[R], commands will be sent to all Java\n+If the \\f[I]pid\\f[R] is \\f[CB]0\\f[R], commands will be sent to all Java\n@@ -73,2 +62,4 @@\n-with the main class and command-line arguments that were used to launch\n-the process (the same as using \\f[V]-l\\f[R]).\n+with the main class and command\\-line arguments that were used to launch\n+the process (the same as using \\f[CB]\\-l\\f[R]).\n+.RS\n+.RE\n@@ -76,1 +67,1 @@\n-\\f[V]Perfcounter.print\\f[R]\n+.B \\f[CB]Perfcounter.print\\f[R]\n@@ -78,0 +69,2 @@\n+.RS\n+.RE\n@@ -79,1 +72,1 @@\n-\\f[V]-f\\f[R] \\f[I]filename\\f[R]\n+.B \\f[CB]\\-f\\f[R] \\f[I]filename\\f[R]\n@@ -81,0 +74,2 @@\n+.RS\n+.RE\n@@ -82,1 +77,1 @@\n-\\f[V]-l\\f[R]\n+.B \\f[CB]\\-l\\f[R]\n@@ -85,1 +80,1 @@\n-command-line arguments that were used to launch the process.\n+command\\-line arguments that were used to launch the process.\n@@ -87,1 +82,1 @@\n-\\f[V]ps\\f[R] to look up the PID.\n+\\f[CB]ps\\f[R] to look up the PID.\n@@ -92,2 +87,2 @@\n-Using \\f[V]jcmd\\f[R] without arguments is the same as using\n-\\f[V]jcmd -l\\f[R].\n+Using \\f[CB]jcmd\\f[R] without arguments is the same as using\n+\\f[CB]jcmd\\ \\-l\\f[R].\n@@ -96,2 +91,4 @@\n-\\f[V]-h\\f[R]\n-Displays the \\f[V]jcmd\\f[R] utility\\[aq]s command-line help.\n+.B \\f[CB]\\-h\\f[R]\n+Displays the \\f[CB]jcmd\\f[R] utility\\[aq]s command\\-line help.\n+.RS\n+.RE\n@@ -100,2 +97,2 @@\n-The \\f[V]jcmd\\f[R] utility is used to send diagnostic command requests\n-to the JVM.\n+The \\f[CB]jcmd\\f[R] utility is used to send diagnostic command requests to\n+the JVM.\n@@ -111,1 +108,1 @@\n-\\f[V]jcmd\\f[R] \\f[I]pid\\f[R] \\f[V]help\\f[R] \\f[I]command\\f[R]\n+\\f[CB]jcmd\\f[R] \\f[I]pid\\f[R] \\f[CB]help\\f[R] \\f[I]command\\f[R]\n@@ -115,1 +112,1 @@\n-double quotation marks (\\f[V]\\[aq]\\f[R] or \\f[V]\\[dq]\\f[R]).\n+double quotation marks (\\f[CB]\\[aq]\\f[R] or \\f[CB]\"\\f[R]).\n@@ -117,1 +114,1 @@\n-backslash (\\f[V]\\[rs]\\f[R]) to prevent the operating system shell from\n+backslash (\\f[CB]\\\\\\f[R]) to prevent the operating system shell from\n@@ -124,1 +121,1 @@\n-(\\f[I]main-class\\f[R]) as the first argument, then the \\f[V]jcmd\\f[R]\n+(\\f[I]main\\-class\\f[R]) as the first argument, then the \\f[CB]jcmd\\f[R]\n@@ -129,1 +126,1 @@\n-processes by specifying \\f[V]0\\f[R] as the process identifier.\n+processes by specifying \\f[CB]0\\f[R] as the process identifier.\n@@ -132,1 +129,1 @@\n-The \\f[I]command\\f[R] must be a valid \\f[V]jcmd\\f[R] diagnostic command\n+The \\f[I]command\\f[R] must be a valid \\f[CB]jcmd\\f[R] diagnostic command\n@@ -134,2 +131,2 @@\n-The list of available commands for \\f[V]jcmd\\f[R] is obtained by running\n-the \\f[V]help\\f[R] command (\\f[V]jcmd\\f[R] \\f[I]pid\\f[R] \\f[V]help\\f[R])\n+The list of available commands for \\f[CB]jcmd\\f[R] is obtained by running\n+the \\f[CB]help\\f[R] command (\\f[CB]jcmd\\f[R] \\f[I]pid\\f[R] \\f[CB]help\\f[R])\n@@ -137,1 +134,1 @@\n-If the \\f[I]pid\\f[R] is \\f[V]0\\f[R], commands will be sent to all Java\n+If the \\f[I]pid\\f[R] is \\f[CB]0\\f[R], commands will be sent to all Java\n@@ -143,2 +140,2 @@\n-command-line arguments that were used to launch the process (the same as\n-using \\f[V]-l\\f[R]).\n+command\\-line arguments that were used to launch the process (the same\n+as using \\f[CB]\\-l\\f[R]).\n@@ -148,1 +145,1 @@\n-\\f[V]help\\f[R] [\\f[I]options\\f[R]] [\\f[I]arguments\\f[R]]\n+.B \\f[CB]help\\f[R] [\\f[I]options\\f[R]] [\\f[I]arguments\\f[R]]\n@@ -160,1 +157,1 @@\n-\\f[I]key\\f[R] or \\f[I]key\\f[R]\\f[V]=\\f[R]\\f[I]value\\f[R] syntax.\n+\\f[I]key\\f[R] or \\f[I]key\\f[R]\\f[CB]=\\f[R]\\f[I]value\\f[R] syntax.\n@@ -164,1 +161,1 @@\n-\\f[V]-all\\f[R]: (Optional) Show help for all commands (BOOLEAN, false) .\n+\\f[CB]\\-all\\f[R]: (Optional) Show help for all commands (BOOLEAN, false) .\n@@ -167,1 +164,1 @@\n-\\f[V]Compiler.codecache\\f[R]\n+.B \\f[CB]Compiler.codecache\\f[R]\n@@ -173,1 +170,1 @@\n-Permission: \\f[V]java.lang.management.ManagementPermission(monitor)\\f[R]\n+Permission: \\f[CB]java.lang.management.ManagementPermission(monitor)\\f[R]\n@@ -176,1 +173,1 @@\n-\\f[V]Compiler.codelist\\f[R]\n+.B \\f[CB]Compiler.codelist\\f[R]\n@@ -182,1 +179,1 @@\n-Permission: \\f[V]java.lang.management.ManagementPermission(monitor)\\f[R]\n+Permission: \\f[CB]java.lang.management.ManagementPermission(monitor)\\f[R]\n@@ -185,1 +182,1 @@\n-\\f[V]Compiler.perfmap\\f[R] (Linux only)\n+.B \\f[CB]Compiler.perfmap\\f[R] (Linux only)\n@@ -191,1 +188,1 @@\n-Permission: \\f[V]java.lang.management.ManagementPermission(monitor)\\f[R]\n+Permission: \\f[CB]java.lang.management.ManagementPermission(monitor)\\f[R]\n@@ -194,1 +191,1 @@\n-\\f[V]Compiler.queue\\f[R]\n+.B \\f[CB]Compiler.queue\\f[R]\n@@ -200,1 +197,1 @@\n-Permission: \\f[V]java.lang.management.ManagementPermission(monitor)\\f[R]\n+Permission: \\f[CB]java.lang.management.ManagementPermission(monitor)\\f[R]\n@@ -203,1 +200,1 @@\n-\\f[V]Compiler.directives_add *filename* *arguments*\\f[R]\n+.B \\f[CB]Compiler.directives_add\\ *filename*\\ *arguments*\\f[R]\n@@ -209,1 +206,1 @@\n-Permission: \\f[V]java.lang.management.ManagementPermission(monitor)\\f[R]\n+Permission: \\f[CB]java.lang.management.ManagementPermission(monitor)\\f[R]\n@@ -217,1 +214,1 @@\n-\\f[V]Compiler.directives_clear\\f[R]\n+.B \\f[CB]Compiler.directives_clear\\f[R]\n@@ -223,1 +220,1 @@\n-Permission: \\f[V]java.lang.management.ManagementPermission(monitor)\\f[R]\n+Permission: \\f[CB]java.lang.management.ManagementPermission(monitor)\\f[R]\n@@ -226,1 +223,1 @@\n-\\f[V]Compiler.directives_print\\f[R]\n+.B \\f[CB]Compiler.directives_print\\f[R]\n@@ -232,1 +229,1 @@\n-Permission: \\f[V]java.lang.management.ManagementPermission(monitor)\\f[R]\n+Permission: \\f[CB]java.lang.management.ManagementPermission(monitor)\\f[R]\n@@ -235,1 +232,1 @@\n-\\f[V]Compiler.directives_remove\\f[R]\n+.B \\f[CB]Compiler.directives_remove\\f[R]\n@@ -241,1 +238,1 @@\n-Permission: \\f[V]java.lang.management.ManagementPermission(monitor)\\f[R]\n+Permission: \\f[CB]java.lang.management.ManagementPermission(monitor)\\f[R]\n@@ -244,1 +241,1 @@\n-\\f[V]GC.class_histogram\\f[R] [\\f[I]options\\f[R]]\n+.B \\f[CB]GC.class_histogram\\f[R] [\\f[I]options\\f[R]]\n@@ -248,1 +245,1 @@\n-Impact: High --- depends on Java heap size and content.\n+Impact: High \\-\\-\\- depends on Java heap size and content.\n@@ -250,1 +247,1 @@\n-Permission: \\f[V]java.lang.management.ManagementPermission(monitor)\\f[R]\n+Permission: \\f[CB]java.lang.management.ManagementPermission(monitor)\\f[R]\n@@ -255,1 +252,1 @@\n-\\f[I]key\\f[R]\\f[V]=\\f[R]\\f[I]value\\f[R] syntax.\n+\\f[I]key\\f[R]\\f[CB]=\\f[R]\\f[I]value\\f[R] syntax.\n@@ -259,1 +256,1 @@\n-\\f[V]-all\\f[R]: (Optional) Inspects all objects, including unreachable\n+\\f[CB]\\-all\\f[R]: (Optional) Inspects all objects, including unreachable\n@@ -262,1 +259,1 @@\n-\\f[V]-parallel\\f[R]: (Optional) Number of parallel threads to use for\n+\\f[CB]\\-parallel\\f[R]: (Optional) Number of parallel threads to use for\n@@ -271,1 +268,1 @@\n-\\f[V]GC.finalizer_info\\f[R]\n+.B \\f[CB]GC.finalizer_info\\f[R]\n@@ -277,1 +274,1 @@\n-Permission: \\f[V]java.lang.management.ManagementPermission(monitor)\\f[R]\n+Permission: \\f[CB]java.lang.management.ManagementPermission(monitor)\\f[R]\n@@ -280,1 +277,1 @@\n-\\f[V]GC.heap_dump\\f[R] [\\f[I]options\\f[R]] [\\f[I]arguments\\f[R]]\n+.B \\f[CB]GC.heap_dump\\f[R] [\\f[I]options\\f[R]] [\\f[I]arguments\\f[R]]\n@@ -284,2 +281,2 @@\n-Impact: High --- depends on the Java heap size and content.\n-Request a full GC unless the \\f[V]-all\\f[R] option is specified.\n+Impact: High \\-\\-\\- depends on the Java heap size and content.\n+Request a full GC unless the \\f[CB]\\-all\\f[R] option is specified.\n@@ -287,1 +284,1 @@\n-Permission: \\f[V]java.lang.management.ManagementPermission(monitor)\\f[R]\n+Permission: \\f[CB]java.lang.management.ManagementPermission(monitor)\\f[R]\n@@ -292,1 +289,1 @@\n-\\f[I]key\\f[R] or \\f[I]key\\f[R]\\f[V]=\\f[R]\\f[I]value\\f[R] syntax.\n+\\f[I]key\\f[R] or \\f[I]key\\f[R]\\f[CB]=\\f[R]\\f[I]value\\f[R] syntax.\n@@ -296,1 +293,1 @@\n-\\f[V]-all\\f[R]: (Optional) Dump all objects, including unreachable\n+\\f[CB]\\-all\\f[R]: (Optional) Dump all objects, including unreachable\n@@ -299,1 +296,1 @@\n-\\f[V]-gz\\f[R]: (Optional) If specified, the heap dump is written in\n+\\f[CB]\\-gz\\f[R]: (Optional) If specified, the heap dump is written in\n@@ -304,1 +301,1 @@\n-\\f[V]-overwrite\\f[R]: (Optional) If specified, the dump file will be\n+\\f[CB]\\-overwrite\\f[R]: (Optional) If specified, the dump file will be\n@@ -312,1 +309,1 @@\n-\\f[V]GC.heap_info\\f[R]\n+.B \\f[CB]GC.heap_info\\f[R]\n@@ -318,1 +315,1 @@\n-Permission: \\f[V]java.lang.management.ManagementPermission(monitor)\\f[R]\n+Permission: \\f[CB]java.lang.management.ManagementPermission(monitor)\\f[R]\n@@ -321,2 +318,2 @@\n-\\f[V]GC.run\\f[R]\n-Calls \\f[V]java.lang.System.gc()\\f[R].\n+.B \\f[CB]GC.run\\f[R]\n+Calls \\f[CB]java.lang.System.gc()\\f[R].\n@@ -325,1 +322,1 @@\n-Impact: Medium --- depends on the Java heap size and content.\n+Impact: Medium \\-\\-\\- depends on the Java heap size and content.\n@@ -328,2 +325,2 @@\n-\\f[V]GC.run_finalization\\f[R]\n-Calls \\f[V]java.lang.System.runFinalization()\\f[R].\n+.B \\f[CB]GC.run_finalization\\f[R]\n+Calls \\f[CB]java.lang.System.runFinalization()\\f[R].\n@@ -332,1 +329,1 @@\n-Impact: Medium --- depends on the Java content.\n+Impact: Medium \\-\\-\\- depends on the Java content.\n@@ -335,1 +332,1 @@\n-\\f[V]JFR.check\\f[R] [\\f[I]options\\f[R]]\n+.B \\f[CB]JFR.check\\f[R] [\\f[I]options\\f[R]]\n@@ -344,1 +341,1 @@\n-\\f[I]key\\f[R]\\f[V]=\\f[R]\\f[I]value\\f[R] syntax.\n+\\f[I]key\\f[R]\\f[CB]=\\f[R]\\f[I]value\\f[R] syntax.\n@@ -350,1 +347,1 @@\n-\\f[V]name\\f[R]: (Optional) Name of the flight recording.\n+\\f[CB]name\\f[R]: (Optional) Name of the flight recording.\n@@ -353,1 +350,1 @@\n-\\f[V]verbose\\f[R]: (Optional) Flag for printing the event settings for\n+\\f[CB]verbose\\f[R]: (Optional) Flag for printing the event settings for\n@@ -357,1 +354,1 @@\n-\\f[V]JFR.configure\\f[R] [\\f[I]options\\f[R]]\n+.B \\f[CB]JFR.configure\\f[R] [\\f[I]options\\f[R]]\n@@ -366,1 +363,1 @@\n-\\f[I]key\\f[R]\\f[V]=\\f[R]\\f[I]value\\f[R] syntax.\n+\\f[I]key\\f[R]\\f[CB]=\\f[R]\\f[I]value\\f[R] syntax.\n@@ -371,3 +368,3 @@\n-\\f[V]globalbuffercount\\f[R]: (Optional) Number of global buffers.\n-This option is a legacy option: change the \\f[V]memorysize\\f[R]\n-parameter to alter the number of global buffers.\n+\\f[CB]globalbuffercount\\f[R]: (Optional) Number of global buffers.\n+This option is a legacy option: change the \\f[CB]memorysize\\f[R] parameter\n+to alter the number of global buffers.\n@@ -375,1 +372,1 @@\n-(STRING, default determined by the value for \\f[V]memorysize\\f[R])\n+(STRING, default determined by the value for \\f[CB]memorysize\\f[R])\n@@ -377,1 +374,1 @@\n-\\f[V]globalbuffersize\\f[R]: (Optional) Size of the global buffers, in\n+\\f[CB]globalbuffersize\\f[R]: (Optional) Size of the global buffers, in\n@@ -379,2 +376,2 @@\n-This option is a legacy option: change the \\f[V]memorysize\\f[R]\n-parameter to alter the size of the global buffers.\n+This option is a legacy option: change the \\f[CB]memorysize\\f[R] parameter\n+to alter the size of the global buffers.\n@@ -382,1 +379,1 @@\n-(STRING, default determined by the value for \\f[V]memorysize\\f[R])\n+(STRING, default determined by the value for \\f[CB]memorysize\\f[R])\n@@ -384,1 +381,1 @@\n-\\f[V]maxchunksize\\f[R]: (Optional) Maximum size of an individual data\n+\\f[CB]maxchunksize\\f[R]: (Optional) Maximum size of an individual data\n@@ -391,1 +388,1 @@\n-\\f[V]memorysize\\f[R]: (Optional) Overall memory size, in bytes if one of\n+\\f[CB]memorysize\\f[R]: (Optional) Overall memory size, in bytes if one of\n@@ -397,1 +394,1 @@\n-\\f[V]repositorypath\\f[R]: (Optional) Path to the location where\n+\\f[CB]repositorypath\\f[R]: (Optional) Path to the location where\n@@ -401,2 +398,2 @@\n-On Linux operating systems, the temporary directory is \\f[V]\/tmp\\f[R].\n-On Windwows, the temporary directory is specified by the \\f[V]TMP\\f[R]\n+On Linux operating systems, the temporary directory is \\f[CB]\/tmp\\f[R].\n+On Windwows, the temporary directory is specified by the \\f[CB]TMP\\f[R]\n@@ -405,1 +402,1 @@\n-\\f[V]stackdepth\\f[R]: (Optional) Stack depth for stack traces.\n+\\f[CB]stackdepth\\f[R]: (Optional) Stack depth for stack traces.\n@@ -411,1 +408,1 @@\n-\\f[V]thread_buffer_size\\f[R]: (Optional) Local buffer size for each\n+\\f[CB]thread_buffer_size\\f[R]: (Optional) Local buffer size for each\n@@ -420,1 +417,1 @@\n-\\f[V]samplethreads\\f[R]: (Optional) Flag for activating thread sampling.\n+\\f[CB]samplethreads\\f[R]: (Optional) Flag for activating thread sampling.\n@@ -424,1 +421,1 @@\n-\\f[V]JFR.dump\\f[R] [\\f[I]options\\f[R]]\n+.B \\f[CB]JFR.dump\\f[R] [\\f[I]options\\f[R]]\n@@ -433,1 +430,1 @@\n-\\f[I]key\\f[R]\\f[V]=\\f[R]\\f[I]value\\f[R] syntax.\n+\\f[I]key\\f[R]\\f[CB]=\\f[R]\\f[I]value\\f[R] syntax.\n@@ -439,1 +436,1 @@\n-\\f[V]begin\\f[R]: (Optional) Specify the time from which recording data\n+\\f[CB]begin\\f[R]: (Optional) Specify the time from which recording data\n@@ -444,1 +441,1 @@\n-\\f[V]end\\f[R]: (Optional) Specify the time to which recording data will\n+\\f[CB]end\\f[R]: (Optional) Specify the time to which recording data will\n@@ -450,3 +447,2 @@\n-\\f[B]Note:\\f[R] For both \\f[V]begin\\f[R] and \\f[V]end\\f[R], the time\n-must be in a format that can be read by\n-java.time.LocalTime::parse(STRING),\n+\\f[B]Note:\\f[R] For both \\f[CB]begin\\f[R] and \\f[CB]end\\f[R], the time must\n+be in a format that can be read by java.time.LocalTime::parse(STRING),\n@@ -455,2 +451,2 @@\n-For example, \\[dq]13:20:15\\[dq], \\[dq]2020-03-17T09:00:00\\[dq] or\n-\\[dq]2020-03-17T09:00:00Z\\[dq].\n+For example, \"13:20:15\", \"2020\\-03\\-17T09:00:00\" or\n+\"2020\\-03\\-17T09:00:00Z\".\n@@ -458,3 +454,3 @@\n-\\f[B]Note:\\f[R] \\f[V]begin\\f[R] and \\f[V]end\\f[R] times correspond to\n-the timestamps found within the recorded information in the flight\n-recording data.\n+\\f[B]Note:\\f[R] \\f[CB]begin\\f[R] and \\f[CB]end\\f[R] times correspond to the\n+timestamps found within the recorded information in the flight recording\n+data.\n@@ -463,3 +459,2 @@\n-specified by a negative integer followed by \\[dq]s\\[dq], \\[dq]m\\[dq] or\n-\\[dq]h\\[dq].\n-For example, \\[dq]-12h\\[dq], \\[dq]-15m\\[dq] or \\[dq]-30s\\[dq]\n+specified by a negative integer followed by \"s\", \"m\" or \"h\".\n+For example, \"\\-12h\", \"\\-15m\" or \"\\-30s\"\n@@ -468,1 +463,1 @@\n-\\f[V]filename\\f[R]: (Optional) Name of the file to which the flight\n+\\f[CB]filename\\f[R]: (Optional) Name of the file to which the flight\n@@ -476,1 +471,1 @@\n-\\f[V]maxage\\f[R]: (Optional) Length of time for dumping the flight\n+\\f[CB]maxage\\f[R]: (Optional) Length of time for dumping the flight\n@@ -481,3 +476,3 @@\n-\\f[V]maxsize\\f[R]: (Optional) Maximum size for the amount of data to\n-dump from a flight recording in bytes if one of the following suffixes\n-is not used: \\[aq]m\\[aq] or \\[aq]M\\[aq] for megabytes OR \\[aq]g\\[aq] or\n+\\f[CB]maxsize\\f[R]: (Optional) Maximum size for the amount of data to dump\n+from a flight recording in bytes if one of the following suffixes is not\n+used: \\[aq]m\\[aq] or \\[aq]M\\[aq] for megabytes OR \\[aq]g\\[aq] or\n@@ -487,1 +482,1 @@\n-\\f[V]name\\f[R]: (Optional) Name of the recording.\n+\\f[CB]name\\f[R]: (Optional) Name of the recording.\n@@ -491,1 +486,1 @@\n-\\f[V]path-to-gc-root\\f[R]: (Optional) Flag for saving the path to\n+\\f[CB]path\\-to\\-gc\\-root\\f[R]: (Optional) Flag for saving the path to\n@@ -500,1 +495,1 @@\n-\\f[V]JFR.start\\f[R] [\\f[I]options\\f[R]]\n+.B \\f[CB]JFR.start\\f[R] [\\f[I]options\\f[R]]\n@@ -509,1 +504,1 @@\n-\\f[I]key\\f[R]\\f[V]=\\f[R]\\f[I]value\\f[R] syntax.\n+\\f[I]key\\f[R]\\f[CB]=\\f[R]\\f[I]value\\f[R] syntax.\n@@ -515,1 +510,1 @@\n-\\f[V]delay\\f[R]: (Optional) Length of time to wait before starting to\n+\\f[CB]delay\\f[R]: (Optional) Length of time to wait before starting to\n@@ -519,1 +514,1 @@\n-\\f[V]disk\\f[R]: (Optional) Flag for also writing the data to disk while\n+\\f[CB]disk\\f[R]: (Optional) Flag for also writing the data to disk while\n@@ -522,1 +517,1 @@\n-\\f[V]dumponexit\\f[R]: (Optional) Flag for writing the recording to disk\n+\\f[CB]dumponexit\\f[R]: (Optional) Flag for writing the recording to disk\n@@ -524,1 +519,1 @@\n-If set to \\[aq]true\\[aq] and no value is given for \\f[V]filename\\f[R],\n+If set to \\[aq]true\\[aq] and no value is given for \\f[CB]filename\\f[R],\n@@ -527,1 +522,1 @@\n-The file name is a system-generated name that contains the process ID,\n+The file name is a system\\-generated name that contains the process ID,\n@@ -529,1 +524,1 @@\n-(For example: \\f[V]id-1-2019_12_12_10_41.jfr\\f[R]) (BOOLEAN, false)\n+(For example: \\f[CB]id\\-1\\-2019_12_12_10_41.jfr\\f[R]) (BOOLEAN, false)\n@@ -531,3 +526,3 @@\n-\\f[V]duration\\f[R]: (Optional) Length of time to record.\n-Note that \\f[V]0s\\f[R] means forever (INTEGER followed by \\[aq]s\\[aq]\n-for seconds \\[aq]m\\[aq] for minutes or \\[aq]h\\[aq] for hours, 0s)\n+\\f[CB]duration\\f[R]: (Optional) Length of time to record.\n+Note that \\f[CB]0s\\f[R] means forever (INTEGER followed by \\[aq]s\\[aq] for\n+seconds \\[aq]m\\[aq] for minutes or \\[aq]h\\[aq] for hours, 0s)\n@@ -535,1 +530,1 @@\n-\\f[V]filename\\f[R]: (Optional) Name of the file to which the flight\n+\\f[CB]filename\\f[R]: (Optional) Name of the file to which the flight\n@@ -544,1 +539,1 @@\n-\\f[V]maxage\\f[R]: (Optional) Maximum time to keep the recorded data on\n+\\f[CB]maxage\\f[R]: (Optional) Maximum time to keep the recorded data on\n@@ -546,3 +541,3 @@\n-This parameter is valid only when the \\f[V]disk\\f[R] parameter is set to\n-\\f[V]true\\f[R].\n-Note \\f[V]0s\\f[R] means forever.\n+This parameter is valid only when the \\f[CB]disk\\f[R] parameter is set to\n+\\f[CB]true\\f[R].\n+Note \\f[CB]0s\\f[R] means forever.\n@@ -552,2 +547,2 @@\n-\\f[V]maxsize\\f[R]: (Optional) Maximum size of the data to keep on disk\n-in bytes if one of the following suffixes is not used: \\[aq]m\\[aq] or\n+\\f[CB]maxsize\\f[R]: (Optional) Maximum size of the data to keep on disk in\n+bytes if one of the following suffixes is not used: \\[aq]m\\[aq] or\n@@ -555,1 +550,1 @@\n-This parameter is valid only when the \\f[V]disk\\f[R] parameter is set to\n+This parameter is valid only when the \\f[CB]disk\\f[R] parameter is set to\n@@ -557,2 +552,2 @@\n-The value must not be less than the value for the \\f[V]maxchunksize\\f[R]\n-parameter set with the \\f[V]JFR.configure\\f[R] command.\n+The value must not be less than the value for the \\f[CB]maxchunksize\\f[R]\n+parameter set with the \\f[CB]JFR.configure\\f[R] command.\n@@ -561,1 +556,1 @@\n-\\f[V]name\\f[R]: (Optional) Name of the recording.\n+\\f[CB]name\\f[R]: (Optional) Name of the recording.\n@@ -565,1 +560,1 @@\n-(STRING, system-generated default name)\n+(STRING, system\\-generated default name)\n@@ -567,1 +562,1 @@\n-\\f[V]path-to-gc-root\\f[R]: (Optional) Flag for saving the path to\n+\\f[CB]path\\-to\\-gc\\-root\\f[R]: (Optional) Flag for saving the path to\n@@ -573,3 +568,3 @@\n-If the \\f[V]settings\\f[R] parameter is set to \\[aq]profile\\[aq], then\n-the information collected includes the stack trace from where the\n-potential leaking object was allocated.\n+If the \\f[CB]settings\\f[R] parameter is set to \\[aq]profile\\[aq], then the\n+information collected includes the stack trace from where the potential\n+leaking object was allocated.\n@@ -578,1 +573,1 @@\n-\\f[V]settings\\f[R]: (Optional) Name of the settings file that identifies\n+\\f[CB]settings\\f[R]: (Optional) Name of the settings file that identifies\n@@ -582,1 +577,1 @@\n-Include the path if the file is not in \\f[V]JAVA-HOME\\f[R]\/lib\/jfr.\n+Include the path if the file is not in \\f[CB]JAVA\\-HOME\\f[R]\/lib\/jfr.\n@@ -584,1 +579,1 @@\n-\\f[V]JAVA-HOME\\f[R]\/lib\/jfr directory: \\[aq]default.jfc\\[aq]: collects a\n+\\f[CB]JAVA\\-HOME\\f[R]\/lib\/jfr directory: \\[aq]default.jfc\\[aq]: collects a\n@@ -592,1 +587,1 @@\n-Use \\f[V]none\\f[R] to start a recording without a predefined\n+Use \\f[CB]none\\f[R] to start a recording without a predefined\n@@ -594,1 +589,1 @@\n-(STRING, \\f[V]JAVA-HOME\\f[R]\/lib\/jfr\/default.jfc)\n+(STRING, \\f[CB]JAVA\\-HOME\\f[R]\/lib\/jfr\/default.jfc)\n@@ -599,2 +594,2 @@\n-\\f[V]option\\f[R]: (Optional) Specifies the option value to modify.\n-To list available options, use the \\f[V]JAVA_HOME\\f[R]\/bin\/jfr tool.\n+\\f[CB]option\\f[R]: (Optional) Specifies the option value to modify.\n+To list available options, use the \\f[CB]JAVA_HOME\\f[R]\/bin\/jfr tool.\n@@ -602,1 +597,1 @@\n-\\f[V]event-setting\\f[R]: (Optional) Specifies the event setting value to\n+\\f[CB]event\\-setting\\f[R]: (Optional) Specifies the event setting value to\n@@ -604,2 +599,2 @@\n-Use the form: \\f[V]<event-name>#<setting-name>=<value>\\f[R] To add a new\n-event setting, prefix the event name with \\[aq]+\\[aq].\n+Use the form: \\f[CB]<event\\-name>#<setting\\-name>=<value>\\f[R] To add a\n+new event setting, prefix the event name with \\[aq]+\\[aq].\n@@ -617,1 +612,1 @@\n-\\f[V]JFR.stop\\f[R] [\\f[I]options\\f[R]]\n+.B \\f[CB]JFR.stop\\f[R] [\\f[I]options\\f[R]]\n@@ -626,1 +621,1 @@\n-\\f[I]key\\f[R]\\f[V]=\\f[R]\\f[I]value\\f[R] syntax.\n+\\f[I]key\\f[R]\\f[CB]=\\f[R]\\f[I]value\\f[R] syntax.\n@@ -631,2 +626,2 @@\n-\\f[V]filename\\f[R]: (Optional) Name of the file to which the recording\n-is written when the recording is stopped.\n+\\f[CB]filename\\f[R]: (Optional) Name of the file to which the recording is\n+written when the recording is stopped.\n@@ -636,1 +631,1 @@\n-\\f[V]name\\f[R]: (Optional) Name of the recording (STRING, no default\n+\\f[CB]name\\f[R]: (Optional) Name of the recording (STRING, no default\n@@ -640,1 +635,1 @@\n-\\f[V]JVMTI.agent_load\\f[R] [\\f[I]arguments\\f[R]]\n+.B \\f[CB]JVMTI.agent_load\\f[R] [\\f[I]arguments\\f[R]]\n@@ -646,1 +641,1 @@\n-Permission: \\f[V]java.lang.management.ManagementPermission(control)\\f[R]\n+Permission: \\f[CB]java.lang.management.ManagementPermission(control)\\f[R]\n@@ -657,2 +652,2 @@\n-\\f[V]JVMTI.data_dump\\f[R]\n-Signals the JVM to do a data-dump request for JVMTI.\n+.B \\f[CB]JVMTI.data_dump\\f[R]\n+Signals the JVM to do a data\\-dump request for JVMTI.\n@@ -663,1 +658,1 @@\n-Permission: \\f[V]java.lang.management.ManagementPermission(monitor)\\f[R]\n+Permission: \\f[CB]java.lang.management.ManagementPermission(monitor)\\f[R]\n@@ -666,1 +661,1 @@\n-\\f[V]ManagementAgent.start\\f[R] [\\f[I]options\\f[R]]\n+.B \\f[CB]ManagementAgent.start\\f[R] [\\f[I]options\\f[R]]\n@@ -670,1 +665,1 @@\n-Impact: Low --- no impact\n+Impact: Low \\-\\-\\- no impact\n@@ -675,1 +670,1 @@\n-\\f[I]key\\f[R] or \\f[I]key\\f[R]\\f[V]=\\f[R]\\f[I]value\\f[R] syntax.\n+\\f[I]key\\f[R] or \\f[I]key\\f[R]\\f[CB]=\\f[R]\\f[I]value\\f[R] syntax.\n@@ -679,2 +674,2 @@\n-\\f[V]config.file\\f[R]: (Optional) Sets\n-\\f[V]com.sun.management.config.file\\f[R] (STRING, no default value)\n+\\f[CB]config.file\\f[R]: (Optional) Sets\n+\\f[CB]com.sun.management.config.file\\f[R] (STRING, no default value)\n@@ -682,2 +677,2 @@\n-\\f[V]jmxremote.host\\f[R]: (Optional) Sets\n-\\f[V]com.sun.management.jmxremote.host\\f[R] (STRING, no default value)\n+\\f[CB]jmxremote.host\\f[R]: (Optional) Sets\n+\\f[CB]com.sun.management.jmxremote.host\\f[R] (STRING, no default value)\n@@ -685,2 +680,2 @@\n-\\f[V]jmxremote.port\\f[R]: (Optional) Sets\n-\\f[V]com.sun.management.jmxremote.port\\f[R] (STRING, no default value)\n+\\f[CB]jmxremote.port\\f[R]: (Optional) Sets\n+\\f[CB]com.sun.management.jmxremote.port\\f[R] (STRING, no default value)\n@@ -688,2 +683,2 @@\n-\\f[V]jmxremote.rmi.port\\f[R]: (Optional) Sets\n-\\f[V]com.sun.management.jmxremote.rmi.port\\f[R] (STRING, no default\n+\\f[CB]jmxremote.rmi.port\\f[R]: (Optional) Sets\n+\\f[CB]com.sun.management.jmxremote.rmi.port\\f[R] (STRING, no default\n@@ -692,2 +687,2 @@\n-\\f[V]jmxremote.ssl\\f[R]: (Optional) Sets\n-\\f[V]com.sun.management.jmxremote.ssl\\f[R] (STRING, no default value)\n+\\f[CB]jmxremote.ssl\\f[R]: (Optional) Sets\n+\\f[CB]com.sun.management.jmxremote.ssl\\f[R] (STRING, no default value)\n@@ -695,2 +690,2 @@\n-\\f[V]jmxremote.registry.ssl\\f[R]: (Optional) Sets\n-\\f[V]com.sun.management.jmxremote.registry.ssl\\f[R] (STRING, no default\n+\\f[CB]jmxremote.registry.ssl\\f[R]: (Optional) Sets\n+\\f[CB]com.sun.management.jmxremote.registry.ssl\\f[R] (STRING, no default\n@@ -699,2 +694,2 @@\n-\\f[V]jmxremote.authenticate\\f[R]: (Optional) Sets\n-\\f[V]com.sun.management.jmxremote.authenticate\\f[R] (STRING, no default\n+\\f[CB]jmxremote.authenticate\\f[R]: (Optional) Sets\n+\\f[CB]com.sun.management.jmxremote.authenticate\\f[R] (STRING, no default\n@@ -704,1 +699,1 @@\n-\\f[V]com.sun.management.jmxremote.password.file\\f[R] (STRING, no default\n+\\f[CB]com.sun.management.jmxremote.password.file\\f[R] (STRING, no default\n@@ -707,2 +702,2 @@\n-\\f[V]jmxremote.access.file\\f[R]: (Optional) Sets\n-\\f[V]com.sun.management.jmxremote.acce ss.file\\f[R] (STRING, no default\n+\\f[CB]jmxremote.access.file\\f[R]: (Optional) Sets\n+\\f[CB]com.sun.management.jmxremote.acce\\ ss.file\\f[R] (STRING, no default\n@@ -711,2 +706,2 @@\n-\\f[V]jmxremote.login.config\\f[R]: (Optional) Sets\n-\\f[V]com.sun.management.jmxremote.log in.config\\f[R] (STRING, no default\n+\\f[CB]jmxremote.login.config\\f[R]: (Optional) Sets\n+\\f[CB]com.sun.management.jmxremote.log\\ in.config\\f[R] (STRING, no default\n@@ -715,2 +710,2 @@\n-\\f[V]jmxremote.ssl.enabled.cipher.suites\\f[R]: (Optional) Sets\n-\\f[V]com.sun.management\\f[R].\n+\\f[CB]jmxremote.ssl.enabled.cipher.suites\\f[R]: (Optional) Sets\n+\\f[CB]com.sun.management\\f[R].\n@@ -718,1 +713,1 @@\n-\\f[V]jmxremote.ssl.enabled.cipher.suite\\f[R]: (STRING, no default value)\n+\\f[CB]jmxremote.ssl.enabled.cipher.suite\\f[R]: (STRING, no default value)\n@@ -720,2 +715,2 @@\n-\\f[V]jmxremote.ssl.enabled.protocols\\f[R]: (Optional) Sets\n-\\f[V]com.sun.management.jmxr emote.ssl.enabled.protocols\\f[R] (STRING,\n+\\f[CB]jmxremote.ssl.enabled.protocols\\f[R]: (Optional) Sets\n+\\f[CB]com.sun.management.jmxr\\ emote.ssl.enabled.protocols\\f[R] (STRING,\n@@ -724,2 +719,2 @@\n-\\f[V]jmxremote.ssl.need.client.auth\\f[R]: (Optional) Sets\n-\\f[V]com.sun.management.jmxre mote.need.client.auth\\f[R] (STRING, no\n+\\f[CB]jmxremote.ssl.need.client.auth\\f[R]: (Optional) Sets\n+\\f[CB]com.sun.management.jmxre\\ mote.need.client.auth\\f[R] (STRING, no\n@@ -728,2 +723,2 @@\n-\\f[V]jmxremote.ssl.config.file\\f[R]: (Optional) Sets\n-\\f[V]com.sun.management.jmxremote. ssl_config_file\\f[R] (STRING, no\n+\\f[CB]jmxremote.ssl.config.file\\f[R]: (Optional) Sets\n+\\f[CB]com.sun.management.jmxremote.\\ ssl_config_file\\f[R] (STRING, no\n@@ -732,2 +727,2 @@\n-\\f[V]jmxremote.autodiscovery\\f[R]: (Optional) Sets\n-\\f[V]com.sun.management.jmxremote.au todiscovery\\f[R] (STRING, no\n+\\f[CB]jmxremote.autodiscovery\\f[R]: (Optional) Sets\n+\\f[CB]com.sun.management.jmxremote.au\\ todiscovery\\f[R] (STRING, no\n@@ -736,2 +731,2 @@\n-\\f[V]jdp.port\\f[R]: (Optional) Sets\n-\\f[V]com.sun.management.jdp.port\\f[R] (INT, no default value)\n+\\f[CB]jdp.port\\f[R]: (Optional) Sets \\f[CB]com.sun.management.jdp.port\\f[R]\n+(INT, no default value)\n@@ -739,2 +734,2 @@\n-\\f[V]jdp.address\\f[R]: (Optional) Sets\n-\\f[V]com.sun.management.jdp.address\\f[R] (STRING, no default value)\n+\\f[CB]jdp.address\\f[R]: (Optional) Sets\n+\\f[CB]com.sun.management.jdp.address\\f[R] (STRING, no default value)\n@@ -742,2 +737,2 @@\n-\\f[V]jdp.source_addr\\f[R]: (Optional) Sets\n-\\f[V]com.sun.management.jdp.source_addr\\f[R] (STRING, no default value)\n+\\f[CB]jdp.source_addr\\f[R]: (Optional) Sets\n+\\f[CB]com.sun.management.jdp.source_addr\\f[R] (STRING, no default value)\n@@ -745,1 +740,1 @@\n-\\f[V]jdp.ttl\\f[R]: (Optional) Sets \\f[V]com.sun.management.jdp.ttl\\f[R]\n+\\f[CB]jdp.ttl\\f[R]: (Optional) Sets \\f[CB]com.sun.management.jdp.ttl\\f[R]\n@@ -748,2 +743,2 @@\n-\\f[V]jdp.pause\\f[R]: (Optional) Sets\n-\\f[V]com.sun.management.jdp.pause\\f[R] (INT, no default value)\n+\\f[CB]jdp.pause\\f[R]: (Optional) Sets\n+\\f[CB]com.sun.management.jdp.pause\\f[R] (INT, no default value)\n@@ -751,2 +746,2 @@\n-\\f[V]jdp.name\\f[R]: (Optional) Sets\n-\\f[V]com.sun.management.jdp.name\\f[R] (STRING, no default value)\n+\\f[CB]jdp.name\\f[R]: (Optional) Sets \\f[CB]com.sun.management.jdp.name\\f[R]\n+(STRING, no default value)\n@@ -755,1 +750,1 @@\n-\\f[V]ManagementAgent.start_local\\f[R]\n+.B \\f[CB]ManagementAgent.start_local\\f[R]\n@@ -759,1 +754,1 @@\n-Impact: Low --- no impact\n+Impact: Low \\-\\-\\- no impact\n@@ -762,1 +757,1 @@\n-\\f[V]ManagementAgent.status\\f[R]\n+.B \\f[CB]ManagementAgent.status\\f[R]\n@@ -766,1 +761,1 @@\n-Impact: Low --- no impact\n+Impact: Low \\-\\-\\- no impact\n@@ -768,1 +763,1 @@\n-Permission: \\f[V]java.lang.management.ManagementPermission(monitor)\\f[R]\n+Permission: \\f[CB]java.lang.management.ManagementPermission(monitor)\\f[R]\n@@ -771,1 +766,1 @@\n-\\f[V]ManagementAgent.stop\\f[R]\n+.B \\f[CB]ManagementAgent.stop\\f[R]\n@@ -775,1 +770,1 @@\n-Impact: Low --- no impact\n+Impact: Low \\-\\-\\- no impact\n@@ -778,2 +773,2 @@\n-\\f[V]System.trim_native_heap\\f[R] (Linux only)\n-Attempts to free up memory by trimming the C-heap.\n+.B \\f[CB]System.trim_native_heap\\f[R] (Linux only)\n+Attempts to free up memory by trimming the C\\-heap.\n@@ -784,1 +779,1 @@\n-Permission: \\f[V]java.lang.management.ManagementPermission(control)\\f[R]\n+Permission: \\f[CB]java.lang.management.ManagementPermission(control)\\f[R]\n@@ -787,1 +782,1 @@\n-\\f[V]Thread.print\\f[R] [\\f[I]options\\f[R]]\n+.B \\f[CB]Thread.print\\f[R] [\\f[I]options\\f[R]]\n@@ -791,1 +786,1 @@\n-Impact: Medium --- depends on the number of threads.\n+Impact: Medium \\-\\-\\- depends on the number of threads.\n@@ -793,1 +788,1 @@\n-Permission: \\f[V]java.lang.management.ManagementPermission(monitor)\\f[R]\n+Permission: \\f[CB]java.lang.management.ManagementPermission(monitor)\\f[R]\n@@ -798,1 +793,1 @@\n-\\f[I]key\\f[R] or \\f[I]key\\f[R]\\f[V]=\\f[R]\\f[I]value\\f[R] syntax.\n+\\f[I]key\\f[R] or \\f[I]key\\f[R]\\f[CB]=\\f[R]\\f[I]value\\f[R] syntax.\n@@ -802,1 +797,1 @@\n-\\f[V]-e\\f[R]: (Optional) Print extended thread information (BOOLEAN,\n+\\f[CB]\\-e\\f[R]: (Optional) Print extended thread information (BOOLEAN,\n@@ -805,1 +800,1 @@\n-\\f[V]-l\\f[R]: (Optional) Prints \\f[V]java.util.concurrent\\f[R] locks\n+\\f[CB]\\-l\\f[R]: (Optional) Prints \\f[CB]java.util.concurrent\\f[R] locks\n@@ -809,1 +804,1 @@\n-\\f[V]VM.cds\\f[R] [\\f[I]arguments\\f[R]]\n+.B \\f[CB]VM.cds\\f[R] [\\f[I]arguments\\f[R]]\n@@ -814,1 +809,1 @@\n-Impact: Medium --- pause time depends on number of loaded classes\n+Impact: Medium \\-\\-\\- pause time depends on number of loaded classes\n@@ -816,1 +811,1 @@\n-Permission: \\f[V]java.lang.management.ManagementPermission(monitor)\\f[R]\n+Permission: \\f[CB]java.lang.management.ManagementPermission(monitor)\\f[R]\n@@ -820,2 +815,2 @@\n-\\f[V]subcmd\\f[R]: must be either \\f[V]static_dump\\f[R] or\n-\\f[V]dynamic_dump\\f[R] (STRING, no default value)\n+\\f[CB]subcmd\\f[R]: must be either \\f[CB]static_dump\\f[R] or\n+\\f[CB]dynamic_dump\\f[R] (STRING, no default value)\n@@ -823,1 +818,1 @@\n-\\f[V]filename\\f[R]: (Optional) Name of the shared archive to be dumped\n+\\f[CB]filename\\f[R]: (Optional) Name of the shared archive to be dumped\n@@ -826,1 +821,1 @@\n-If \\f[V]filename\\f[R] is not specified, a default file name is chosen\n+If \\f[CB]filename\\f[R] is not specified, a default file name is chosen\n@@ -830,1 +825,1 @@\n-If \\f[V]filename\\f[R] is not specified as an absolute path, the archive\n+If \\f[CB]filename\\f[R] is not specified as an absolute path, the archive\n@@ -834,2 +829,2 @@\n-If \\f[V]dynamic_dump\\f[R] is specified, the target JVM must be started\n-with the JVM option \\f[V]-XX:+RecordDynamicDumpInfo\\f[R].\n+If \\f[CB]dynamic_dump\\f[R] is specified, the target JVM must be started\n+with the JVM option \\f[CB]\\-XX:+RecordDynamicDumpInfo\\f[R].\n@@ -838,1 +833,1 @@\n-\\f[V]VM.classloaders\\f[R] [\\f[I]options\\f[R]]\n+.B \\f[CB]VM.classloaders\\f[R] [\\f[I]options\\f[R]]\n@@ -842,1 +837,1 @@\n-Impact: Medium --- Depends on number of class loaders and classes\n+Impact: Medium \\-\\-\\- Depends on number of class loaders and classes\n@@ -845,1 +840,1 @@\n-Permission: \\f[V]java.lang.management.ManagementPermission(monitor)\\f[R]\n+Permission: \\f[CB]java.lang.management.ManagementPermission(monitor)\\f[R]\n@@ -848,1 +843,1 @@\n-\\f[I]key\\f[R] or \\f[I]key\\f[R]\\f[V]=\\f[R]\\f[I]value\\f[R] syntax.\n+\\f[I]key\\f[R] or \\f[I]key\\f[R]\\f[CB]=\\f[R]\\f[I]value\\f[R] syntax.\n@@ -852,1 +847,1 @@\n-\\f[V]show-classes\\f[R]: (Optional) Print loaded classes.\n+\\f[CB]show\\-classes\\f[R]: (Optional) Print loaded classes.\n@@ -855,1 +850,1 @@\n-\\f[V]verbose\\f[R]: (Optional) Print detailed information.\n+\\f[CB]verbose\\f[R]: (Optional) Print detailed information.\n@@ -858,1 +853,1 @@\n-\\f[V]fold\\f[R]: (Optional) Show loaders of the same name and class as\n+\\f[CB]fold\\f[R]: (Optional) Show loaders of the same name and class as\n@@ -863,1 +858,1 @@\n-\\f[V]VM.classloader_stats\\f[R]\n+.B \\f[CB]VM.classloader_stats\\f[R]\n@@ -869,1 +864,1 @@\n-Permission: \\f[V]java.lang.management.ManagementPermission(monitor)\\f[R]\n+Permission: \\f[CB]java.lang.management.ManagementPermission(monitor)\\f[R]\n@@ -872,1 +867,1 @@\n-\\f[V]VM.class_hierarchy\\f[R] [\\f[I]options\\f[R]] [\\f[I]arguments\\f[R]]\n+.B \\f[CB]VM.class_hierarchy\\f[R] [\\f[I]options\\f[R]] [\\f[I]arguments\\f[R]]\n@@ -876,2 +871,1 @@\n-ClassLoader, or \\[dq]null\\[dq] if it is loaded by the bootstrap class\n-loader.\n+ClassLoader, or \"null\" if it is loaded by the bootstrap class loader.\n@@ -880,1 +874,1 @@\n-Impact: Medium --- depends on the number of loaded classes.\n+Impact: Medium \\-\\-\\- depends on the number of loaded classes.\n@@ -882,1 +876,1 @@\n-Permission: \\f[V]java.lang.management.ManagementPermission(monitor)\\f[R]\n+Permission: \\f[CB]java.lang.management.ManagementPermission(monitor)\\f[R]\n@@ -887,1 +881,1 @@\n-\\f[I]key\\f[R] or \\f[I]key\\f[R]\\f[V]=\\f[R]\\f[I]value\\f[R] syntax.\n+\\f[I]key\\f[R] or \\f[I]key\\f[R]\\f[CB]=\\f[R]\\f[I]value\\f[R] syntax.\n@@ -891,1 +885,1 @@\n-\\f[V]-i\\f[R]: (Optional) Inherited interfaces should be printed.\n+\\f[CB]\\-i\\f[R]: (Optional) Inherited interfaces should be printed.\n@@ -894,1 +888,1 @@\n-\\f[V]-s\\f[R]: (Optional) If a classname is specified, print its\n+\\f[CB]\\-s\\f[R]: (Optional) If a classname is specified, print its\n@@ -907,1 +901,1 @@\n-\\f[V]VM.command_line\\f[R]\n+.B \\f[CB]VM.command_line\\f[R]\n@@ -913,1 +907,1 @@\n-Permission: \\f[V]java.lang.management.ManagementPermission(monitor)\\f[R]\n+Permission: \\f[CB]java.lang.management.ManagementPermission(monitor)\\f[R]\n@@ -916,1 +910,1 @@\n-\\f[V]VM.dynlibs\\f[R]\n+.B \\f[CB]VM.dynlibs\\f[R]\n@@ -922,1 +916,1 @@\n-Permission: \\f[V]java.lang.management.ManagementPermission(monitor)\\f[R]\n+Permission: \\f[CB]java.lang.management.ManagementPermission(monitor)\\f[R]\n@@ -925,1 +919,1 @@\n-\\f[V]VM.events\\f[R] [\\f[I]options\\f[R]]\n+.B \\f[CB]VM.events\\f[R] [\\f[I]options\\f[R]]\n@@ -929,1 +923,1 @@\n-Impact: Low --- Depends on event log size.\n+Impact: Low \\-\\-\\- Depends on event log size.\n@@ -931,1 +925,1 @@\n-Permission: \\f[V]java.lang.management.ManagementPermission(monitor)\\f[R]\n+Permission: \\f[CB]java.lang.management.ManagementPermission(monitor)\\f[R]\n@@ -938,1 +932,1 @@\n-\\f[I]key\\f[R] or \\f[I]key\\f[R]\\f[V]=\\f[R]\\f[I]value\\f[R] syntax.\n+\\f[I]key\\f[R] or \\f[I]key\\f[R]\\f[CB]=\\f[R]\\f[I]value\\f[R] syntax.\n@@ -940,1 +934,1 @@\n-\\f[V]log\\f[R]: (Optional) Name of log to be printed.\n+\\f[CB]log\\f[R]: (Optional) Name of log to be printed.\n@@ -944,1 +938,1 @@\n-\\f[V]max\\f[R]: (Optional) Maximum number of events to be printed (newest\n+\\f[CB]max\\f[R]: (Optional) Maximum number of events to be printed (newest\n@@ -950,1 +944,1 @@\n-\\f[V]VM.info\\f[R]\n+.B \\f[CB]VM.info\\f[R]\n@@ -956,1 +950,1 @@\n-Permission: \\f[V]java.lang.management.ManagementPermission(monitor)\\f[R]\n+Permission: \\f[CB]java.lang.management.ManagementPermission(monitor)\\f[R]\n@@ -959,1 +953,1 @@\n-\\f[V]VM.log\\f[R] [\\f[I]options\\f[R]]\n+.B \\f[CB]VM.log\\f[R] [\\f[I]options\\f[R]]\n@@ -966,1 +960,1 @@\n-Permission: \\f[V]java.lang.management.ManagementPermission(control)\\f[R]\n+Permission: \\f[CB]java.lang.management.ManagementPermission(control)\\f[R]\n@@ -973,1 +967,1 @@\n-\\f[I]key\\f[R] or \\f[I]key\\f[R]\\f[V]=\\f[R]\\f[I]value\\f[R] syntax.\n+\\f[I]key\\f[R] or \\f[I]key\\f[R]\\f[CB]=\\f[R]\\f[I]value\\f[R] syntax.\n@@ -975,1 +969,1 @@\n-\\f[V]output\\f[R]: (Optional) The name or index (#) of output to\n+\\f[CB]output\\f[R]: (Optional) The name or index (#) of output to\n@@ -979,1 +973,1 @@\n-\\f[V]output_options\\f[R]: (Optional) Options for the output.\n+\\f[CB]output_options\\f[R]: (Optional) Options for the output.\n@@ -982,1 +976,1 @@\n-\\f[V]what\\f[R]: (Optional) Configures what tags to log.\n+\\f[CB]what\\f[R]: (Optional) Configures what tags to log.\n@@ -985,1 +979,1 @@\n-\\f[V]decorators\\f[R]: (Optional) Configures which decorators to use.\n+\\f[CB]decorators\\f[R]: (Optional) Configures which decorators to use.\n@@ -989,1 +983,1 @@\n-\\f[V]disable\\f[R]: (Optional) Turns off all logging and clears the log\n+\\f[CB]disable\\f[R]: (Optional) Turns off all logging and clears the log\n@@ -993,1 +987,1 @@\n-\\f[V]list\\f[R]: (Optional) Lists current log configuration.\n+\\f[CB]list\\f[R]: (Optional) Lists current log configuration.\n@@ -996,1 +990,1 @@\n-\\f[V]rotate\\f[R]: (Optional) Rotates all logs.\n+\\f[CB]rotate\\f[R]: (Optional) Rotates all logs.\n@@ -1000,1 +994,1 @@\n-\\f[V]VM.flags\\f[R] [\\f[I]options\\f[R]]\n+.B \\f[CB]VM.flags\\f[R] [\\f[I]options\\f[R]]\n@@ -1006,1 +1000,1 @@\n-Permission: \\f[V]java.lang.management.ManagementPermission(monitor)\\f[R]\n+Permission: \\f[CB]java.lang.management.ManagementPermission(monitor)\\f[R]\n@@ -1011,1 +1005,1 @@\n-\\f[I]key\\f[R] or \\f[I]key\\f[R]\\f[V]=\\f[R]\\f[I]value\\f[R] syntax.\n+\\f[I]key\\f[R] or \\f[I]key\\f[R]\\f[CB]=\\f[R]\\f[I]value\\f[R] syntax.\n@@ -1015,1 +1009,1 @@\n-\\f[V]-all\\f[R]: (Optional) Prints all flags supported by the VM\n+\\f[CB]\\-all\\f[R]: (Optional) Prints all flags supported by the VM\n@@ -1019,1 +1013,1 @@\n-\\f[V]VM.metaspace\\f[R] [\\f[I]options\\f[R]]\n+.B \\f[CB]VM.metaspace\\f[R] [\\f[I]options\\f[R]]\n@@ -1023,1 +1017,1 @@\n-Impact: Medium --- Depends on number of classes loaded.\n+Impact: Medium \\-\\-\\- Depends on number of classes loaded.\n@@ -1025,1 +1019,1 @@\n-Permission: \\f[V]java.lang.management.ManagementPermission(monitor)\\f[R]\n+Permission: \\f[CB]java.lang.management.ManagementPermission(monitor)\\f[R]\n@@ -1030,1 +1024,1 @@\n-\\f[I]key\\f[R] or \\f[I]key\\f[R]\\f[V]=\\f[R]\\f[I]value\\f[R] syntax.\n+\\f[I]key\\f[R] or \\f[I]key\\f[R]\\f[CB]=\\f[R]\\f[I]value\\f[R] syntax.\n@@ -1034,1 +1028,1 @@\n-\\f[V]basic\\f[R]: (Optional) Prints a basic summary (does not need a\n+\\f[CB]basic\\f[R]: (Optional) Prints a basic summary (does not need a\n@@ -1038,1 +1032,1 @@\n-\\f[V]show-loaders\\f[R]: (Optional) Shows usage by class loader.\n+\\f[CB]show\\-loaders\\f[R]: (Optional) Shows usage by class loader.\n@@ -1041,1 +1035,1 @@\n-\\f[V]show-classes\\f[R]: (Optional) If show-loaders is set, shows loaded\n+\\f[CB]show\\-classes\\f[R]: (Optional) If show\\-loaders is set, shows loaded\n@@ -1045,1 +1039,1 @@\n-\\f[V]by-chunktype\\f[R]: (Optional) Break down numbers by chunk type.\n+\\f[CB]by\\-chunktype\\f[R]: (Optional) Break down numbers by chunk type.\n@@ -1048,1 +1042,1 @@\n-\\f[V]by-spacetype\\f[R]: (Optional) Break down numbers by loader type.\n+\\f[CB]by\\-spacetype\\f[R]: (Optional) Break down numbers by loader type.\n@@ -1051,1 +1045,1 @@\n-\\f[V]vslist\\f[R]: (Optional) Shows details about the underlying virtual\n+\\f[CB]vslist\\f[R]: (Optional) Shows details about the underlying virtual\n@@ -1055,3 +1049,3 @@\n-\\f[V]scale\\f[R]: (Optional) Memory usage in which to scale.\n-Valid values are: 1, KB, MB or GB (fixed scale) or \\[dq]dynamic\\[dq] for\n-a dynamically chosen scale.\n+\\f[CB]scale\\f[R]: (Optional) Memory usage in which to scale.\n+Valid values are: 1, KB, MB or GB (fixed scale) or \"dynamic\" for a\n+dynamically chosen scale.\n@@ -1061,1 +1055,1 @@\n-\\f[V]VM.native_memory\\f[R] [\\f[I]options\\f[R]]\n+.B \\f[CB]VM.native_memory\\f[R] [\\f[I]options\\f[R]]\n@@ -1067,1 +1061,1 @@\n-Permission: \\f[V]java.lang.management.ManagementPermission(monitor)\\f[R]\n+Permission: \\f[CB]java.lang.management.ManagementPermission(monitor)\\f[R]\n@@ -1072,1 +1066,1 @@\n-\\f[I]key\\f[R] or \\f[I]key\\f[R]\\f[V]=\\f[R]\\f[I]value\\f[R] syntax.\n+\\f[I]key\\f[R] or \\f[I]key\\f[R]\\f[CB]=\\f[R]\\f[I]value\\f[R] syntax.\n@@ -1076,1 +1070,1 @@\n-\\f[V]summary\\f[R]: (Optional) Requests runtime to report current memory\n+\\f[CB]summary\\f[R]: (Optional) Requests runtime to report current memory\n@@ -1081,2 +1075,2 @@\n-\\f[V]detail\\f[R]: (Optional) Requests runtime to report memory\n-allocation >= 1K by each callsite.\n+\\f[CB]detail\\f[R]: (Optional) Requests runtime to report memory allocation\n+>= 1K by each callsite.\n@@ -1085,1 +1079,1 @@\n-\\f[V]baseline\\f[R]: (Optional) Requests runtime to baseline current\n+\\f[CB]baseline\\f[R]: (Optional) Requests runtime to baseline current\n@@ -1089,1 +1083,1 @@\n-\\f[V]summary.diff\\f[R]: (Optional) Requests runtime to report memory\n+\\f[CB]summary.diff\\f[R]: (Optional) Requests runtime to report memory\n@@ -1093,1 +1087,1 @@\n-\\f[V]detail.diff\\f[R]: (Optional) Requests runtime to report memory\n+\\f[CB]detail.diff\\f[R]: (Optional) Requests runtime to report memory\n@@ -1098,1 +1092,1 @@\n-\\f[V]statistics\\f[R]: (Optional) Prints tracker statistics for tuning\n+\\f[CB]statistics\\f[R]: (Optional) Prints tracker statistics for tuning\n@@ -1102,1 +1096,1 @@\n-\\f[V]scale\\f[R]: (Optional) Memory usage in which scale, KB, MB or GB\n+\\f[CB]scale\\f[R]: (Optional) Memory usage in which scale, KB, MB or GB\n@@ -1106,1 +1100,1 @@\n-\\f[V]VM.print_touched_methods\\f[R]\n+.B \\f[CB]VM.print_touched_methods\\f[R]\n@@ -1111,1 +1105,1 @@\n-Impact: Medium --- depends on Java content.\n+Impact: Medium \\-\\-\\- depends on Java content.\n@@ -1114,1 +1108,1 @@\n-\\f[V]VM.set_flag\\f[R] [\\f[I]arguments\\f[R]]\n+.B \\f[CB]VM.set_flag\\f[R] [\\f[I]arguments\\f[R]]\n@@ -1120,1 +1114,1 @@\n-Permission: \\f[V]java.lang.management.ManagementPermission(control)\\f[R]\n+Permission: \\f[CB]java.lang.management.ManagementPermission(control)\\f[R]\n@@ -1131,1 +1125,1 @@\n-\\f[V]VM.stringtable\\f[R] [\\f[I]options\\f[R]]\n+.B \\f[CB]VM.stringtable\\f[R] [\\f[I]options\\f[R]]\n@@ -1135,1 +1129,1 @@\n-Impact: Medium --- depends on the Java content.\n+Impact: Medium \\-\\-\\- depends on the Java content.\n@@ -1137,1 +1131,1 @@\n-Permission: \\f[V]java.lang.management.ManagementPermission(monitor)\\f[R]\n+Permission: \\f[CB]java.lang.management.ManagementPermission(monitor)\\f[R]\n@@ -1142,1 +1136,1 @@\n-\\f[I]key\\f[R] or \\f[I]key\\f[R]\\f[V]=\\f[R]\\f[I]value\\f[R] syntax.\n+\\f[I]key\\f[R] or \\f[I]key\\f[R]\\f[CB]=\\f[R]\\f[I]value\\f[R] syntax.\n@@ -1146,1 +1140,1 @@\n-\\f[V]-verbose\\f[R]: (Optional) Dumps the content of each string in the\n+\\f[CB]\\-verbose\\f[R]: (Optional) Dumps the content of each string in the\n@@ -1150,1 +1144,1 @@\n-\\f[V]VM.symboltable\\f[R] [\\f[I]options\\f[R]]\n+.B \\f[CB]VM.symboltable\\f[R] [\\f[I]options\\f[R]]\n@@ -1154,1 +1148,1 @@\n-Impact: Medium --- depends on the Java content.\n+Impact: Medium \\-\\-\\- depends on the Java content.\n@@ -1156,1 +1150,1 @@\n-Permission: \\f[V]java.lang.management.ManagementPermission(monitor)\\f[R]\n+Permission: \\f[CB]java.lang.management.ManagementPermission(monitor)\\f[R]\n@@ -1161,1 +1155,1 @@\n-\\f[I]key\\f[R] or \\f[I]key\\f[R]\\f[V]=\\f[R]\\f[I]value\\f[R] syntax).\n+\\f[I]key\\f[R] or \\f[I]key\\f[R]\\f[CB]=\\f[R]\\f[I]value\\f[R] syntax).\n@@ -1165,1 +1159,1 @@\n-\\f[V]-verbose\\f[R]: (Optional) Dumps the content of each symbol in the\n+\\f[CB]\\-verbose\\f[R]: (Optional) Dumps the content of each symbol in the\n@@ -1169,1 +1163,1 @@\n-\\f[V]VM.systemdictionary\\f[R]\n+.B \\f[CB]VM.systemdictionary\\f[R]\n@@ -1175,1 +1169,1 @@\n-Permission: \\f[V]java.lang.management.ManagementPermission(monitor)\\f[R]\n+Permission: \\f[CB]java.lang.management.ManagementPermission(monitor)\\f[R]\n@@ -1180,1 +1174,1 @@\n-\\f[I]key\\f[R] or \\f[I]key\\f[R]\\f[V]=\\f[R]\\f[I]value\\f[R] syntax.\n+\\f[I]key\\f[R] or \\f[I]key\\f[R]\\f[CB]=\\f[R]\\f[I]value\\f[R] syntax.\n@@ -1184,1 +1178,1 @@\n-\\f[V]verbose\\f[R]: (Optional) Dump the content of each dictionary entry\n+\\f[CB]verbose\\f[R]: (Optional) Dump the content of each dictionary entry\n@@ -1188,1 +1182,1 @@\n-\\f[V]VM.system_properties\\f[R]\n+.B \\f[CB]VM.system_properties\\f[R]\n@@ -1194,1 +1188,1 @@\n-Permission: \\f[V]java.util.PropertyPermission(*, read)\\f[R]\n+Permission: \\f[CB]java.util.PropertyPermission(*,\\ read)\\f[R]\n@@ -1197,1 +1191,1 @@\n-\\f[V]VM.uptime\\f[R] [\\f[I]options\\f[R]]\n+.B \\f[CB]VM.uptime\\f[R] [\\f[I]options\\f[R]]\n@@ -1206,1 +1200,1 @@\n-\\f[I]key\\f[R] or \\f[I]key\\f[R]\\f[V]=\\f[R]\\f[I]value\\f[R] syntax.\n+\\f[I]key\\f[R] or \\f[I]key\\f[R]\\f[CB]=\\f[R]\\f[I]value\\f[R] syntax.\n@@ -1210,1 +1204,1 @@\n-\\f[V]-date\\f[R]: (Optional) Adds a prefix with the current date\n+\\f[CB]\\-date\\f[R]: (Optional) Adds a prefix with the current date\n@@ -1214,1 +1208,1 @@\n-\\f[V]VM.version\\f[R]\n+.B \\f[CB]VM.version\\f[R]\n@@ -1221,1 +1215,1 @@\n-\\f[V]java.util.PropertyPermission(java.vm.version, read)\\f[R]\n+\\f[CB]java.util.PropertyPermission(java.vm.version,\\ read)\\f[R]\n","filename":"src\/jdk.jcmd\/share\/man\/jcmd.1","additions":345,"deletions":351,"binary":false,"changes":696,"status":"modified"},{"patch":"@@ -22,1 +22,1 @@\n-.\\\" Automatically generated by Pandoc 2.19.2\n+.\\\" Automatically generated by Pandoc 2.3.1\n@@ -24,15 +24,1 @@\n-.\\\" Define V font for inline verbatim, using C font in formats\n-.\\\" that render this, and otherwise B font.\n-.ie \"\\f[CB]x\\f[R]\"x\" \\{\\\n-. ftr V B\n-. ftr VI BI\n-. ftr VB B\n-. ftr VBI BI\n-.\\}\n-.el \\{\\\n-. ftr V CR\n-. ftr VI CI\n-. ftr VB CB\n-. ftr VBI CBI\n-.\\}\n-.TH \"JINFO\" \"1\" \"2023\" \"JDK 20-ea\" \"JDK Commands\"\n+.TH \"JINFO\" \"1\" \"2023\" \"JDK 20\\-ea\" \"JDK Commands\"\n@@ -42,1 +28,1 @@\n-jinfo - generate Java configuration information for a specified Java\n+jinfo \\- generate Java configuration information for a specified Java\n@@ -48,1 +34,1 @@\n-\\f[V]jinfo\\f[R] [\\f[I]option\\f[R]] \\f[I]pid\\f[R]\n+\\f[CB]jinfo\\f[R] [\\f[I]option\\f[R]] \\f[I]pid\\f[R]\n@@ -50,2 +36,2 @@\n-\\f[I]option\\f[R]\n-This represents the \\f[V]jinfo\\f[R] command-line options.\n+.B \\f[I]option\\f[R]\n+This represents the \\f[CB]jinfo\\f[R] command\\-line options.\n@@ -53,0 +39,2 @@\n+.RS\n+.RE\n@@ -54,1 +42,1 @@\n-\\f[I]pid\\f[R]\n+.B \\f[I]pid\\f[R]\n@@ -58,1 +46,1 @@\n-\\f[V]ps\\f[R] command or, if the JVM processes are not running in a\n+\\f[CB]ps\\f[R] command or, if the JVM processes are not running in a\n@@ -60,0 +48,2 @@\n+.RS\n+.RE\n@@ -62,1 +52,1 @@\n-The \\f[V]jinfo\\f[R] command prints Java configuration information for a\n+The \\f[CB]jinfo\\f[R] command prints Java configuration information for a\n@@ -65,3 +55,3 @@\n-command-line flags.\n-If the specified process is running on a 64-bit JVM, then you might need\n-to specify the \\f[V]-J-d64\\f[R] option, for example:\n+command\\-line flags.\n+If the specified process is running on a 64\\-bit JVM, then you might\n+need to specify the \\f[CB]\\-J\\-d64\\f[R] option, for example:\n@@ -70,1 +60,1 @@\n-\\f[V]jinfo -J-d64 -sysprops\\f[R] \\f[I]pid\\f[R]\n+\\f[CB]jinfo\\ \\-J\\-d64\\ \\-sysprops\\f[R] \\f[I]pid\\f[R]\n@@ -75,1 +65,1 @@\n-In Windows Systems where \\f[V]dbgeng.dll\\f[R] is not present, the\n+In Windows Systems where \\f[CB]dbgeng.dll\\f[R] is not present, the\n@@ -77,2 +67,2 @@\n-The \\f[V]PATH\\f[R] environment variable should contain the location of\n-the \\f[V]jvm.dll\\f[R] that\\[aq]s used by the target process or the\n+The \\f[CB]PATH\\f[R] environment variable should contain the location of\n+the \\f[CB]jvm.dll\\f[R] that\\[aq]s used by the target process or the\n@@ -84,2 +74,2 @@\n-If none of the following options are used, both the command-line flags\n-and the system property name-value pairs are printed.\n+If none of the following options are used, both the command\\-line flags\n+and the system property name\\-value pairs are printed.\n@@ -87,2 +77,4 @@\n-\\f[V]-flag\\f[R] \\f[I]name\\f[R]\n-Prints the name and value of the specified command-line flag.\n+.B \\f[CB]\\-flag\\f[R] \\f[I]name\\f[R]\n+Prints the name and value of the specified command\\-line flag.\n+.RS\n+.RE\n@@ -90,2 +82,4 @@\n-\\f[V]-flag\\f[R] [\\f[V]+\\f[R]|\\f[V]-\\f[R]]\\f[I]name\\f[R]\n-Enables or disables the specified Boolean command-line flag.\n+.B \\f[CB]\\-flag\\f[R] [\\f[CB]+\\f[R]|\\f[CB]\\-\\f[R]]\\f[I]name\\f[R]\n+Enables or disables the specified Boolean command\\-line flag.\n+.RS\n+.RE\n@@ -93,2 +87,4 @@\n-\\f[V]-flag\\f[R] \\f[I]name\\f[R]\\f[V]=\\f[R]\\f[I]value\\f[R]\n-Sets the specified command-line flag to the specified value.\n+.B \\f[CB]\\-flag\\f[R] \\f[I]name\\f[R]\\f[CB]=\\f[R]\\f[I]value\\f[R]\n+Sets the specified command\\-line flag to the specified value.\n+.RS\n+.RE\n@@ -96,2 +92,4 @@\n-\\f[V]-flags\\f[R]\n-Prints command-line flags passed to the JVM.\n+.B \\f[CB]\\-flags\\f[R]\n+Prints command\\-line flags passed to the JVM.\n+.RS\n+.RE\n@@ -99,2 +97,4 @@\n-\\f[V]-sysprops\\f[R]\n-Prints Java system properties as name-value pairs.\n+.B \\f[CB]\\-sysprops\\f[R]\n+Prints Java system properties as name\\-value pairs.\n+.RS\n+.RE\n@@ -102,1 +102,1 @@\n-\\f[V]-h\\f[R] or \\f[V]-help\\f[R]\n+.B \\f[CB]\\-h\\f[R] or \\f[CB]\\-help\\f[R]\n@@ -104,0 +104,2 @@\n+.RS\n+.RE\n","filename":"src\/jdk.jcmd\/share\/man\/jinfo.1","additions":45,"deletions":43,"binary":false,"changes":88,"status":"modified"},{"patch":"@@ -22,1 +22,1 @@\n-.\\\" Automatically generated by Pandoc 2.19.2\n+.\\\" Automatically generated by Pandoc 2.3.1\n@@ -24,15 +24,1 @@\n-.\\\" Define V font for inline verbatim, using C font in formats\n-.\\\" that render this, and otherwise B font.\n-.ie \"\\f[CB]x\\f[R]\"x\" \\{\\\n-. ftr V B\n-. ftr VI BI\n-. ftr VB B\n-. ftr VBI BI\n-.\\}\n-.el \\{\\\n-. ftr V CR\n-. ftr VI CI\n-. ftr VB CB\n-. ftr VBI CBI\n-.\\}\n-.TH \"JMAP\" \"1\" \"2023\" \"JDK 20-ea\" \"JDK Commands\"\n+.TH \"JMAP\" \"1\" \"2023\" \"JDK 20\\-ea\" \"JDK Commands\"\n@@ -42,1 +28,1 @@\n-jmap - print details of a specified process\n+jmap \\- print details of a specified process\n@@ -47,1 +33,1 @@\n-\\f[V]jmap\\f[R] [\\f[I]options\\f[R]] \\f[I]pid\\f[R]\n+\\f[CB]jmap\\f[R] [\\f[I]options\\f[R]] \\f[I]pid\\f[R]\n@@ -49,2 +35,2 @@\n-\\f[I]options\\f[R]\n-This represents the \\f[V]jmap\\f[R] command-line options.\n+.B \\f[I]options\\f[R]\n+This represents the \\f[CB]jmap\\f[R] command\\-line options.\n@@ -52,0 +38,2 @@\n+.RS\n+.RE\n@@ -53,1 +41,1 @@\n-\\f[I]pid\\f[R]\n+.B \\f[I]pid\\f[R]\n@@ -58,1 +46,1 @@\n-\\f[V]ps\\f[R] command or, if the JVM processes are not running in a\n+\\f[CB]ps\\f[R] command or, if the JVM processes are not running in a\n@@ -60,0 +48,2 @@\n+.RS\n+.RE\n@@ -62,2 +52,1 @@\n-The \\f[V]jmap\\f[R] command prints details of a specified running\n-process.\n+The \\f[CB]jmap\\f[R] command prints details of a specified running process.\n@@ -69,5 +58,5 @@\n-On Windows Systems where the \\f[V]dbgeng.dll\\f[R] file isn\\[aq]t\n-present, the Debugging Tools for Windows must be installed to make these\n-tools work.\n-The \\f[V]PATH\\f[R] environment variable should contain the location of\n-the \\f[V]jvm.dll\\f[R] file that\\[aq]s used by the target process or the\n+On Windows Systems where the \\f[CB]dbgeng.dll\\f[R] file isn\\[aq]t present,\n+the Debugging Tools for Windows must be installed to make these tools\n+work.\n+The \\f[CB]PATH\\f[R] environment variable should contain the location of\n+the \\f[CB]jvm.dll\\f[R] file that\\[aq]s used by the target process or the\n@@ -77,1 +66,1 @@\n-\\f[V]-clstats\\f[R] \\f[I]pid\\f[R]\n+.B \\f[CB]\\-clstats\\f[R] \\f[I]pid\\f[R]\n@@ -80,0 +69,2 @@\n+.RS\n+.RE\n@@ -81,1 +72,1 @@\n-\\f[V]-finalizerinfo\\f[R] \\f[I]pid\\f[R]\n+.B \\f[CB]\\-finalizerinfo\\f[R] \\f[I]pid\\f[R]\n@@ -84,0 +75,2 @@\n+.RS\n+.RE\n@@ -85,1 +78,1 @@\n-\\f[V]-histo\\f[R][\\f[V]:live\\f[R]] \\f[I]pid\\f[R]\n+.B \\f[CB]\\-histo\\f[R][\\f[CB]:live\\f[R]] \\f[I]pid\\f[R]\n@@ -88,1 +81,1 @@\n-If the \\f[V]live\\f[R] suboption is specified, it then counts only live\n+If the \\f[CB]live\\f[R] suboption is specified, it then counts only live\n@@ -90,0 +83,2 @@\n+.RS\n+.RE\n@@ -91,1 +86,1 @@\n-\\f[V]-dump:\\f[R]\\f[I]dump_options\\f[R] \\f[I]pid\\f[R]\n+.B \\f[CB]\\-dump:\\f[R]\\f[I]dump_options\\f[R] \\f[I]pid\\f[R]\n@@ -96,1 +91,1 @@\n-\\f[V]live\\f[R] --- When specified, dumps only the live objects; if not\n+\\f[CB]live\\f[R] \\-\\-\\- When specified, dumps only the live objects; if not\n@@ -99,1 +94,1 @@\n-\\f[V]format=b\\f[R] --- Dumps the Java heap in \\f[V]hprof\\f[R] binary\n+\\f[CB]format=b\\f[R] \\-\\-\\- Dumps the Java heap in \\f[CB]hprof\\f[R] binary\n@@ -102,1 +97,1 @@\n-\\f[V]file=\\f[R]\\f[I]filename\\f[R] --- Dumps the heap to\n+\\f[CB]file=\\f[R]\\f[I]filename\\f[R] \\-\\-\\- Dumps the heap to\n@@ -105,1 +100,1 @@\n-Example: \\f[V]jmap -dump:live,format=b,file=heap.bin\\f[R] \\f[I]pid\\f[R]\n+Example: \\f[CB]jmap\\ \\-dump:live,format=b,file=heap.bin\\f[R] \\f[I]pid\\f[R]\n","filename":"src\/jdk.jcmd\/share\/man\/jmap.1","additions":33,"deletions":38,"binary":false,"changes":71,"status":"modified"},{"patch":"@@ -22,1 +22,1 @@\n-.\\\" Automatically generated by Pandoc 2.19.2\n+.\\\" Automatically generated by Pandoc 2.3.1\n@@ -24,15 +24,1 @@\n-.\\\" Define V font for inline verbatim, using C font in formats\n-.\\\" that render this, and otherwise B font.\n-.ie \"\\f[CB]x\\f[R]\"x\" \\{\\\n-. ftr V B\n-. ftr VI BI\n-. ftr VB B\n-. ftr VBI BI\n-.\\}\n-.el \\{\\\n-. ftr V CR\n-. ftr VI CI\n-. ftr VB CB\n-. ftr VBI CBI\n-.\\}\n-.TH \"JPS\" \"1\" \"2023\" \"JDK 20-ea\" \"JDK Commands\"\n+.TH \"JPS\" \"1\" \"2023\" \"JDK 20\\-ea\" \"JDK Commands\"\n@@ -42,1 +28,1 @@\n-jps - list the instrumented JVMs on the target system\n+jps \\- list the instrumented JVMs on the target system\n@@ -47,1 +33,1 @@\n-\\f[V]jps\\f[R] [\\f[V]-q\\f[R]] [\\f[V]-mlvV\\f[R]] [\\f[I]hostid\\f[R]]\n+\\f[CB]jps\\f[R] [\\f[CB]\\-q\\f[R]] [\\f[CB]\\-mlvV\\f[R]] [\\f[I]hostid\\f[R]]\n@@ -49,1 +35,1 @@\n-\\f[V]jps\\f[R] [\\f[V]-help\\f[R]]\n+\\f[CB]jps\\f[R] [\\f[CB]\\-help\\f[R]]\n@@ -52,1 +38,1 @@\n-\\f[V]-q\\f[R]\n+.B \\f[CB]\\-q\\f[R]\n@@ -54,1 +40,1 @@\n-passed to the \\f[V]main\\f[R] method, producing a list of only local JVM\n+passed to the \\f[CB]main\\f[R] method, producing a list of only local JVM\n@@ -56,0 +42,2 @@\n+.RS\n+.RE\n@@ -57,1 +45,1 @@\n-\\f[V]-mlvV\\f[R]\n+.B \\f[CB]\\-mlvV\\f[R]\n@@ -61,2 +49,2 @@\n-\\f[V]-m\\f[R] displays the arguments passed to the \\f[V]main\\f[R] method.\n-The output may be \\f[V]null\\f[R] for embedded JVMs.\n+\\f[CB]\\-m\\f[R] displays the arguments passed to the \\f[CB]main\\f[R] method.\n+The output may be \\f[CB]null\\f[R] for embedded JVMs.\n@@ -64,2 +52,2 @@\n-\\f[V]-l\\f[R] displays the full package name for the application\\[aq]s\n-\\f[V]main\\f[R] class or the full path name to the application\\[aq]s JAR\n+\\f[CB]\\-l\\f[R] displays the full package name for the application\\[aq]s\n+\\f[CB]main\\f[R] class or the full path name to the application\\[aq]s JAR\n@@ -68,1 +56,1 @@\n-\\f[V]-v\\f[R] displays the arguments passed to the JVM.\n+\\f[CB]\\-v\\f[R] displays the arguments passed to the JVM.\n@@ -70,2 +58,2 @@\n-\\f[V]-V\\f[R] suppresses the output of the class name, JAR file name, and\n-arguments passed to the \\f[V]main\\f[R] method, producing a list of only\n+\\f[CB]\\-V\\f[R] suppresses the output of the class name, JAR file name, and\n+arguments passed to the \\f[CB]main\\f[R] method, producing a list of only\n@@ -75,1 +63,1 @@\n-\\f[I]hostid\\f[R]\n+.B \\f[I]hostid\\f[R]\n@@ -78,1 +66,1 @@\n-The \\f[V]hostid\\f[R] can include optional components that indicate the\n+The \\f[CB]hostid\\f[R] can include optional components that indicate the\n@@ -82,0 +70,2 @@\n+.RS\n+.RE\n@@ -83,2 +73,4 @@\n-\\f[V]-help\\f[R]\n-Displays the help message for the \\f[V]jps\\f[R] command.\n+.B \\f[CB]\\-help\\f[R]\n+Displays the help message for the \\f[CB]jps\\f[R] command.\n+.RS\n+.RE\n@@ -87,1 +79,1 @@\n-The \\f[V]jps\\f[R] command lists the instrumented Java HotSpot VMs on the\n+The \\f[CB]jps\\f[R] command lists the instrumented Java HotSpot VMs on the\n@@ -92,4 +84,3 @@\n-If the \\f[V]jps\\f[R] command is run without specifying a\n-\\f[V]hostid\\f[R], then it searches for instrumented JVMs on the local\n-host.\n-If started with a \\f[V]hostid\\f[R], then it searches for JVMs on the\n+If the \\f[CB]jps\\f[R] command is run without specifying a \\f[CB]hostid\\f[R],\n+then it searches for instrumented JVMs on the local host.\n+If started with a \\f[CB]hostid\\f[R], then it searches for JVMs on the\n@@ -97,1 +88,1 @@\n-A \\f[V]jstatd\\f[R] process is assumed to be running on the target host.\n+A \\f[CB]jstatd\\f[R] process is assumed to be running on the target host.\n@@ -99,3 +90,3 @@\n-The \\f[V]jps\\f[R] command reports the local JVM identifier, or\n-\\f[V]lvmid\\f[R], for each instrumented JVM found on the target system.\n-The \\f[V]lvmid\\f[R] is typically, but not necessarily, the operating\n+The \\f[CB]jps\\f[R] command reports the local JVM identifier, or\n+\\f[CB]lvmid\\f[R], for each instrumented JVM found on the target system.\n+The \\f[CB]lvmid\\f[R] is typically, but not necessarily, the operating\n@@ -103,2 +94,2 @@\n-With no options, the \\f[V]jps\\f[R] command lists each Java\n-application\\[aq]s \\f[V]lvmid\\f[R] followed by the short form of the\n+With no options, the \\f[CB]jps\\f[R] command lists each Java\n+application\\[aq]s \\f[CB]lvmid\\f[R] followed by the short form of the\n@@ -109,1 +100,1 @@\n-The \\f[V]jps\\f[R] command uses the Java launcher to find the class name\n+The \\f[CB]jps\\f[R] command uses the Java launcher to find the class name\n@@ -112,1 +103,1 @@\n-JAR file name, and the arguments to the \\f[V]main\\f[R] method aren\\[aq]t\n+JAR file name, and the arguments to the \\f[CB]main\\f[R] method aren\\[aq]t\n@@ -114,3 +105,3 @@\n-In this case, the \\f[V]jps\\f[R] command outputs the string\n-\\f[V]Unknown\\f[R] for the class name, or JAR file name, and for the\n-arguments to the \\f[V]main\\f[R] method.\n+In this case, the \\f[CB]jps\\f[R] command outputs the string\n+\\f[CB]Unknown\\f[R] for the class name, or JAR file name, and for the\n+arguments to the \\f[CB]main\\f[R] method.\n@@ -118,1 +109,1 @@\n-The list of JVMs produced by the \\f[V]jps\\f[R] command can be limited by\n+The list of JVMs produced by the \\f[CB]jps\\f[R] command can be limited by\n@@ -121,1 +112,1 @@\n-rights as determined by operating system-specific access control\n+rights as determined by operating system\\-specific access control\n@@ -125,1 +116,1 @@\n-The host identifier, or \\f[V]hostid\\f[R], is a string that indicates the\n+The host identifier, or \\f[CB]hostid\\f[R], is a string that indicates the\n@@ -127,1 +118,1 @@\n-The syntax of the \\f[V]hostid\\f[R] string corresponds to the syntax of a\n+The syntax of the \\f[CB]hostid\\f[R] string corresponds to the syntax of a\n@@ -131,1 +122,1 @@\n-[\\f[I]protocol\\f[R]\\f[V]:\\f[R]][[\\f[V]\/\/\\f[R]]\\f[I]hostname\\f[R]][\\f[V]:\\f[R]\\f[I]port\\f[R]][\\f[V]\/\\f[R]\\f[I]servername\\f[R]]\n+[\\f[I]protocol\\f[R]\\f[CB]:\\f[R]][[\\f[CB]\/\/\\f[R]]\\f[I]hostname\\f[R]][\\f[CB]:\\f[R]\\f[I]port\\f[R]][\\f[CB]\/\\f[R]\\f[I]servername\\f[R]]\n@@ -134,1 +125,1 @@\n-\\f[I]protocol\\f[R]\n+.B \\f[I]protocol\\f[R]\n@@ -137,1 +128,1 @@\n-specified, then the default protocol is a platform-specific, optimized,\n+specified, then the default protocol is a platform\\-specific, optimized,\n@@ -140,1 +131,3 @@\n-default protocol is \\f[V]rmi\\f[R].\n+default protocol is \\f[CB]rmi\\f[R].\n+.RS\n+.RE\n@@ -142,1 +135,1 @@\n-\\f[I]hostname\\f[R]\n+.B \\f[I]hostname\\f[R]\n@@ -144,2 +137,4 @@\n-If you omit the \\f[I]hostname\\f[R] parameter, then the target host is\n-the local host.\n+If you omit the \\f[I]hostname\\f[R] parameter, then the target host is the\n+local host.\n+.RS\n+.RE\n@@ -147,1 +142,1 @@\n-\\f[I]port\\f[R]\n+.B \\f[I]port\\f[R]\n@@ -150,2 +145,2 @@\n-parameter specifies an optimized, local protocol, then the\n-\\f[I]port\\f[R] parameter is ignored.\n+parameter specifies an optimized, local protocol, then the \\f[I]port\\f[R]\n+parameter is ignored.\n@@ -153,3 +148,3 @@\n-implementation-specific.\n-For the default \\f[V]rmi\\f[R] protocol, the \\f[I]port\\f[R] parameter\n-indicates the port number for the \\f[V]rmiregistry\\f[R] on the remote\n+implementation\\-specific.\n+For the default \\f[CB]rmi\\f[R] protocol, the \\f[I]port\\f[R] parameter\n+indicates the port number for the \\f[CB]rmiregistry\\f[R] on the remote\n@@ -158,2 +153,4 @@\n-parameter indicates \\f[V]rmi\\f[R], then the default\n-\\f[V]rmiregistry\\f[R] port (\\f[V]1099\\f[R]) is used.\n+parameter indicates \\f[CB]rmi\\f[R], then the default \\f[CB]rmiregistry\\f[R]\n+port (\\f[CB]1099\\f[R]) is used.\n+.RS\n+.RE\n@@ -161,1 +158,1 @@\n-\\f[I]servername\\f[R]\n+.B \\f[I]servername\\f[R]\n@@ -164,1 +161,1 @@\n-For the \\f[V]rmi\\f[R] protocol, this parameter is a string that\n+For the \\f[CB]rmi\\f[R] protocol, this parameter is a string that\n@@ -166,1 +163,3 @@\n-See the \\f[B]jstatd\\f[R] command \\f[V]-n\\f[R] option.\n+See the \\f[B]jstatd\\f[R] command \\f[CB]\\-n\\f[R] option.\n+.RS\n+.RE\n@@ -169,1 +168,1 @@\n-The output of the \\f[V]jps\\f[R] command has the following pattern:\n+The output of the \\f[CB]jps\\f[R] command has the following pattern:\n@@ -173,1 +172,1 @@\n-\\f[V]\\[dq]Unknown\\[dq]\\f[R]] [ \\f[I]arg\\f[R]* ] [ \\f[I]jvmarg\\f[R]* ] ]\n+\\f[CB]\"Unknown\"\\f[R]] [ \\f[I]arg\\f[R]* ] [ \\f[I]jvmarg\\f[R]* ] ]\n@@ -177,1 +176,1 @@\n-An \\f[V]arg\\f[R] value that includes embedded white space introduces\n+An \\f[CB]arg\\f[R] value that includes embedded white space introduces\n@@ -184,2 +183,2 @@\n-\\f[V]jps\\f[R] output because the format might change in future releases.\n-If you write scripts that parse \\f[V]jps\\f[R] output, then expect to\n+\\f[CB]jps\\f[R] output because the format might change in future releases.\n+If you write scripts that parse \\f[CB]jps\\f[R] output, then expect to\n@@ -189,1 +188,1 @@\n-This section provides examples of the \\f[V]jps\\f[R] command.\n+This section provides examples of the \\f[CB]jps\\f[R] command.\n@@ -196,3 +195,3 @@\n-18027 Java2Demo.JAR\n-18032 jps\n-18005 jstat\n+18027\\ Java2Demo.JAR\n+18032\\ jps\n+18005\\ jstat\n@@ -203,2 +202,2 @@\n-This example assumes that the \\f[V]jstat\\f[R] server and either the its\n-internal RMI registry or a separate external \\f[V]rmiregistry\\f[R]\n+This example assumes that the \\f[CB]jstat\\f[R] server and either the its\n+internal RMI registry or a separate external \\f[CB]rmiregistry\\f[R]\n@@ -206,1 +205,1 @@\n-\\f[V]1099\\f[R]).\n+\\f[CB]1099\\f[R]).\n@@ -209,1 +208,1 @@\n-This example includes the \\f[V]-l\\f[R] option to output the long form of\n+This example includes the \\f[CB]\\-l\\f[R] option to output the long form of\n@@ -214,3 +213,3 @@\n-jps -l remote.domain\n-3002 \/opt\/jdk1.7.0\/demo\/jfc\/Java2D\/Java2Demo.JAR\n-2857 sun.tools.jstatd.jstatd\n+jps\\ \\-l\\ remote.domain\n+3002\\ \/opt\/jdk1.7.0\/demo\/jfc\/Java2D\/Java2Demo.JAR\n+2857\\ sun.tools.jstatd.jstatd\n@@ -222,5 +221,4 @@\n-This example assumes that the \\f[V]jstatd\\f[R] server, with an internal\n-RMI registry bound to port \\f[V]2002\\f[R], is running on the remote\n-host.\n-This example also uses the \\f[V]-m\\f[R] option to include the arguments\n-passed to the \\f[V]main\\f[R] method of each of the listed Java\n+This example assumes that the \\f[CB]jstatd\\f[R] server, with an internal\n+RMI registry bound to port \\f[CB]2002\\f[R], is running on the remote host.\n+This example also uses the \\f[CB]\\-m\\f[R] option to include the arguments\n+passed to the \\f[CB]main\\f[R] method of each of the listed Java\n@@ -231,3 +229,3 @@\n-jps -m remote.domain:2002\n-3002 \/opt\/jdk1.7.0\/demo\/jfc\/Java2D\/Java2Demo.JAR\n-3102 sun.tools.jstatd.jstatd -p 2002\n+jps\\ \\-m\\ remote.domain:2002\n+3002\\ \/opt\/jdk1.7.0\/demo\/jfc\/Java2D\/Java2Demo.JAR\n+3102\\ sun.tools.jstatd.jstatd\\ \\-p\\ 2002\n","filename":"src\/jdk.jcmd\/share\/man\/jps.1","additions":93,"deletions":95,"binary":false,"changes":188,"status":"modified"},{"patch":"@@ -22,1 +22,1 @@\n-.\\\" Automatically generated by Pandoc 2.19.2\n+.\\\" Automatically generated by Pandoc 2.3.1\n@@ -24,15 +24,1 @@\n-.\\\" Define V font for inline verbatim, using C font in formats\n-.\\\" that render this, and otherwise B font.\n-.ie \"\\f[CB]x\\f[R]\"x\" \\{\\\n-. ftr V B\n-. ftr VI BI\n-. ftr VB B\n-. ftr VBI BI\n-.\\}\n-.el \\{\\\n-. ftr V CR\n-. ftr VI CI\n-. ftr VB CB\n-. ftr VBI CBI\n-.\\}\n-.TH \"JSTACK\" \"1\" \"2023\" \"JDK 20-ea\" \"JDK Commands\"\n+.TH \"JSTACK\" \"1\" \"2023\" \"JDK 20\\-ea\" \"JDK Commands\"\n@@ -42,1 +28,1 @@\n-jstack - print Java stack traces of Java threads for a specified Java\n+jstack \\- print Java stack traces of Java threads for a specified Java\n@@ -48,1 +34,1 @@\n-\\f[V]jstack\\f[R] [\\f[I]options\\f[R]] \\f[I]pid\\f[R]\n+\\f[CB]jstack\\f[R] [\\f[I]options\\f[R]] \\f[I]pid\\f[R]\n@@ -50,2 +36,2 @@\n-\\f[I]options\\f[R]\n-This represents the \\f[V]jstack\\f[R] command-line options.\n+.B \\f[I]options\\f[R]\n+This represents the \\f[CB]jstack\\f[R] command\\-line options.\n@@ -53,0 +39,2 @@\n+.RS\n+.RE\n@@ -54,1 +42,1 @@\n-\\f[I]pid\\f[R]\n+.B \\f[I]pid\\f[R]\n@@ -58,1 +46,1 @@\n-\\f[V]ps\\f[R] command or, if the JVM processes are not running in a\n+\\f[CB]ps\\f[R] command or, if the JVM processes are not running in a\n@@ -60,0 +48,2 @@\n+.RS\n+.RE\n@@ -62,2 +52,2 @@\n-The \\f[V]jstack\\f[R] command prints Java stack traces of Java threads\n-for a specified Java process.\n+The \\f[CB]jstack\\f[R] command prints Java stack traces of Java threads for\n+a specified Java process.\n@@ -68,4 +58,4 @@\n-\\f[V]c++filt\\f[R].\n-When the specified process is running on a 64-bit JVM, you might need to\n-specify the \\f[V]-J-d64\\f[R] option, for example:\n-\\f[V]jstack -J-d64\\f[R] \\f[I]pid\\f[R].\n+\\f[CB]c++filt\\f[R].\n+When the specified process is running on a 64\\-bit JVM, you might need\n+to specify the \\f[CB]\\-J\\-d64\\f[R] option, for example:\n+\\f[CB]jstack\\ \\-J\\-d64\\f[R] \\f[I]pid\\f[R].\n@@ -77,6 +67,6 @@\n-In Windows Systems where the \\f[V]dbgeng.dll\\f[R] file isn\\[aq]t\n-present, the Debugging Tools for Windows must be installed so that these\n-tools work.\n-The \\f[V]PATH\\f[R] environment variable needs to contain the location of\n-the \\f[V]jvm.dll\\f[R] that is used by the target process, or the\n-location from which the core dump file was produced.\n+In Windows Systems where the \\f[CB]dbgeng.dll\\f[R] file isn\\[aq]t present,\n+the Debugging Tools for Windows must be installed so that these tools\n+work.\n+The \\f[CB]PATH\\f[R] environment variable needs to contain the location of\n+the \\f[CB]jvm.dll\\f[R] that is used by the target process, or the location\n+from which the core dump file was produced.\n@@ -85,1 +75,1 @@\n-\\f[V]-l\\f[R]\n+.B \\f[CB]\\-l\\f[R]\n@@ -87,0 +77,2 @@\n+.RS\n+.RE\n@@ -88,1 +80,1 @@\n-\\f[V]-h\\f[R] or \\f[V]-help\\f[R]\n+.B \\f[CB]\\-h\\f[R] or \\f[CB]\\-help\\f[R]\n@@ -90,0 +82,2 @@\n+.RS\n+.RE\n","filename":"src\/jdk.jcmd\/share\/man\/jstack.1","additions":30,"deletions":36,"binary":false,"changes":66,"status":"modified"},{"patch":"@@ -22,1 +22,1 @@\n-.\\\" Automatically generated by Pandoc 2.19.2\n+.\\\" Automatically generated by Pandoc 2.3.1\n@@ -24,15 +24,1 @@\n-.\\\" Define V font for inline verbatim, using C font in formats\n-.\\\" that render this, and otherwise B font.\n-.ie \"\\f[CB]x\\f[R]\"x\" \\{\\\n-. ftr V B\n-. ftr VI BI\n-. ftr VB B\n-. ftr VBI BI\n-.\\}\n-.el \\{\\\n-. ftr V CR\n-. ftr VI CI\n-. ftr VB CB\n-. ftr VBI CBI\n-.\\}\n-.TH \"JSTAT\" \"1\" \"2023\" \"JDK 20-ea\" \"JDK Commands\"\n+.TH \"JSTAT\" \"1\" \"2023\" \"JDK 20\\-ea\" \"JDK Commands\"\n@@ -42,1 +28,1 @@\n-jstat - monitor JVM statistics\n+jstat \\- monitor JVM statistics\n@@ -47,1 +33,1 @@\n-\\f[V]jstat\\f[R] \\f[I]generalOptions\\f[R]\n+\\f[CB]jstat\\f[R] \\f[I]generalOptions\\f[R]\n@@ -49,1 +35,1 @@\n-\\f[V]jstat\\f[R] \\f[I]outputOptions\\f[R] [\\f[V]-t\\f[R]] [\\f[V]-h\\f[R]\n+\\f[CB]jstat\\f[R] \\f[I]outputOptions\\f[R] [\\f[CB]\\-t\\f[R]] [\\f[CB]\\-h\\f[R]\n@@ -52,2 +38,2 @@\n-\\f[I]generalOptions\\f[R]\n-A single general command-line option.\n+.B \\f[I]generalOptions\\f[R]\n+A single general command\\-line option.\n@@ -55,0 +41,2 @@\n+.RS\n+.RE\n@@ -56,5 +44,4 @@\n-\\f[I]outputOptions\\f[R]\n-An option reported by the \\f[V]-options\\f[R] option.\n-One or more output options that consist of a single\n-\\f[V]statOption\\f[R], plus any of the \\f[V]-t\\f[R], \\f[V]-h\\f[R], and\n-\\f[V]-J\\f[R] options.\n+.B \\f[I]outputOptions\\f[R]\n+An option reported by the \\f[CB]\\-options\\f[R] option.\n+One or more output options that consist of a single \\f[CB]statOption\\f[R],\n+plus any of the \\f[CB]\\-t\\f[R], \\f[CB]\\-h\\f[R], and \\f[CB]\\-J\\f[R] options.\n@@ -62,0 +49,2 @@\n+.RS\n+.RE\n@@ -63,2 +52,2 @@\n-\\f[V]-t\\f[R]\n-Displays a time-stamp column as the first column of output.\n+.B \\f[CB]\\-t\\f[R]\n+Displays a time\\-stamp column as the first column of output.\n@@ -66,0 +55,2 @@\n+.RS\n+.RE\n@@ -67,1 +58,1 @@\n-\\f[V]-h\\f[R] \\f[I]n\\f[R]\n+.B \\f[CB]\\-h\\f[R] \\f[I]n\\f[R]\n@@ -70,2 +61,4 @@\n-The default value is \\f[V]0\\f[R], which displays the column header of\n-the first row of data.\n+The default value is \\f[CB]0\\f[R], which displays the column header of the\n+first row of data.\n+.RS\n+.RE\n@@ -73,1 +66,1 @@\n-\\f[I]vmid\\f[R]\n+.B \\f[I]vmid\\f[R]\n@@ -77,0 +70,2 @@\n+.RS\n+.RE\n@@ -78,1 +73,1 @@\n-\\f[I]interval\\f[R]\n+.B \\f[I]interval\\f[R]\n@@ -83,1 +78,1 @@\n-When specified, the \\f[V]jstat\\f[R] command produces its output at each\n+When specified, the \\f[CB]jstat\\f[R] command produces its output at each\n@@ -85,0 +80,2 @@\n+.RS\n+.RE\n@@ -86,1 +83,1 @@\n-\\f[I]count\\f[R]\n+.B \\f[I]count\\f[R]\n@@ -88,1 +85,1 @@\n-The default value is infinity, which causes the \\f[V]jstat\\f[R] command\n+The default value is infinity, which causes the \\f[CB]jstat\\f[R] command\n@@ -90,1 +87,1 @@\n-\\f[V]jstat\\f[R] command is terminated.\n+\\f[CB]jstat\\f[R] command is terminated.\n@@ -92,0 +89,2 @@\n+.RS\n+.RE\n@@ -94,1 +93,1 @@\n-The \\f[V]jstat\\f[R] command displays performance statistics for an\n+The \\f[CB]jstat\\f[R] command displays performance statistics for an\n@@ -97,1 +96,1 @@\n-\\f[V]vmid\\f[R] option.\n+\\f[CB]vmid\\f[R] option.\n@@ -99,1 +98,1 @@\n-The \\f[V]jstat\\f[R] command supports two types of options, general\n+The \\f[CB]jstat\\f[R] command supports two types of options, general\n@@ -101,2 +100,2 @@\n-General options cause the \\f[V]jstat\\f[R] command to display simple\n-usage and version information.\n+General options cause the \\f[CB]jstat\\f[R] command to display simple usage\n+and version information.\n@@ -113,1 +112,1 @@\n-\\f[V]-help\\f[R]\n+.B \\f[CB]\\-help\\f[R]\n@@ -115,0 +114,2 @@\n+.RS\n+.RE\n@@ -116,1 +117,1 @@\n-\\f[V]-options\\f[R]\n+.B \\f[CB]\\-options\\f[R]\n@@ -119,0 +120,2 @@\n+.RS\n+.RE\n@@ -123,5 +126,5 @@\n-Output options determine the content and format of the \\f[V]jstat\\f[R]\n-command\\[aq]s output, and consist of a single \\f[V]statOption\\f[R], plus\n-any of the other output options (\\f[V]-h\\f[R], \\f[V]-t\\f[R], and\n-\\f[V]-J\\f[R]).\n-The \\f[V]statOption\\f[R] must come first.\n+Output options determine the content and format of the \\f[CB]jstat\\f[R]\n+command\\[aq]s output, and consist of a single \\f[CB]statOption\\f[R], plus\n+any of the other output options (\\f[CB]\\-h\\f[R], \\f[CB]\\-t\\f[R], and\n+\\f[CB]\\-J\\f[R]).\n+The \\f[CB]statOption\\f[R] must come first.\n@@ -132,1 +135,1 @@\n-Use the \\f[V]-h\\f[R] option to set the frequency at which the header is\n+Use the \\f[CB]\\-h\\f[R] option to set the frequency at which the header is\n@@ -138,1 +141,1 @@\n-Use the \\f[V]-t\\f[R] option to display a time-stamp column, labeled\n+Use the \\f[CB]\\-t\\f[R] option to display a time\\-stamp column, labeled\n@@ -147,1 +150,1 @@\n-how many times, respectively, the \\f[V]jstat\\f[R] command displays its\n+how many times, respectively, the \\f[CB]jstat\\f[R] command displays its\n@@ -152,3 +155,3 @@\n-Don\\[aq]t write scripts to parse the \\f[V]jstat\\f[R] command\\[aq]s\n-output because the format might change in future releases.\n-If you write scripts that parse the \\f[V]jstat\\f[R] command output, then\n+Don\\[aq]t write scripts to parse the \\f[CB]jstat\\f[R] command\\[aq]s output\n+because the format might change in future releases.\n+If you write scripts that parse the \\f[CB]jstat\\f[R] command output, then\n@@ -157,2 +160,2 @@\n-\\f[V]-statOption\\f[R]\n-Determines the statistics information that the \\f[V]jstat\\f[R] command\n+.B \\f[CB]\\-statOption\\f[R]\n+Determines the statistics information that the \\f[CB]jstat\\f[R] command\n@@ -161,1 +164,1 @@\n-Use the \\f[V]-options\\f[R] general option to display the list of options\n+Use the \\f[CB]\\-options\\f[R] general option to display the list of options\n@@ -166,1 +169,1 @@\n-\\f[V]class\\f[R]: Displays statistics about the behavior of the class\n+\\f[CB]class\\f[R]: Displays statistics about the behavior of the class\n@@ -169,2 +172,2 @@\n-\\f[V]compiler\\f[R]: Displays statistics about the behavior of the Java\n-HotSpot VM Just-in-Time compiler.\n+\\f[CB]compiler\\f[R]: Displays statistics about the behavior of the Java\n+HotSpot VM Just\\-in\\-Time compiler.\n@@ -172,1 +175,1 @@\n-\\f[V]gc\\f[R]: Displays statistics about the behavior of the garbage\n+\\f[CB]gc\\f[R]: Displays statistics about the behavior of the garbage\n@@ -175,1 +178,1 @@\n-\\f[V]gccapacity\\f[R]: Displays statistics about the capacities of the\n+\\f[CB]gccapacity\\f[R]: Displays statistics about the capacities of the\n@@ -178,3 +181,3 @@\n-\\f[V]gccause\\f[R]: Displays a summary about garbage collection\n-statistics (same as \\f[V]-gcutil\\f[R]), with the cause of the last and\n-current (when applicable) garbage collection events.\n+\\f[CB]gccause\\f[R]: Displays a summary about garbage collection statistics\n+(same as \\f[CB]\\-gcutil\\f[R]), with the cause of the last and current\n+(when applicable) garbage collection events.\n@@ -182,1 +185,1 @@\n-\\f[V]gcnew\\f[R]: Displays statistics about the behavior of the new\n+\\f[CB]gcnew\\f[R]: Displays statistics about the behavior of the new\n@@ -185,1 +188,1 @@\n-\\f[V]gcnewcapacity\\f[R]: Displays statistics about the sizes of the new\n+\\f[CB]gcnewcapacity\\f[R]: Displays statistics about the sizes of the new\n@@ -188,1 +191,1 @@\n-\\f[V]gcold\\f[R]: Displays statistics about the behavior of the old\n+\\f[CB]gcold\\f[R]: Displays statistics about the behavior of the old\n@@ -191,1 +194,1 @@\n-\\f[V]gcoldcapacity\\f[R]: Displays statistics about the sizes of the old\n+\\f[CB]gcoldcapacity\\f[R]: Displays statistics about the sizes of the old\n@@ -194,1 +197,1 @@\n-\\f[V]gcmetacapacity\\f[R]: Displays statistics about the sizes of the\n+\\f[CB]gcmetacapacity\\f[R]: Displays statistics about the sizes of the\n@@ -197,2 +200,1 @@\n-\\f[V]gcutil\\f[R]: Displays a summary about garbage collection\n-statistics.\n+\\f[CB]gcutil\\f[R]: Displays a summary about garbage collection statistics.\n@@ -200,1 +202,1 @@\n-\\f[V]printcompilation\\f[R]: Displays Java HotSpot VM compilation method\n+\\f[CB]printcompilation\\f[R]: Displays Java HotSpot VM compilation method\n@@ -204,1 +206,1 @@\n-\\f[V]-J\\f[R]\\f[I]javaOption\\f[R]\n+.B \\f[CB]\\-J\\f[R]\\f[I]javaOption\\f[R]\n@@ -206,1 +208,1 @@\n-For example, \\f[V]-J-Xms48m\\f[R] sets the startup memory to 48 MB.\n+For example, \\f[CB]\\-J\\-Xms48m\\f[R] sets the startup memory to 48 MB.\n@@ -208,0 +210,2 @@\n+.RS\n+.RE\n@@ -210,2 +214,2 @@\n-The following information summarizes the columns that the\n-\\f[V]jstat\\f[R] command outputs for each \\f[I]statOption\\f[R].\n+The following information summarizes the columns that the \\f[CB]jstat\\f[R]\n+command outputs for each \\f[I]statOption\\f[R].\n@@ -213,1 +217,1 @@\n-\\f[V]-class\\f[R] \\f[I]option\\f[R]\n+.B \\f[CB]\\-class\\f[R] \\f[I]option\\f[R]\n@@ -217,1 +221,1 @@\n-\\f[V]Loaded\\f[R]: Number of classes loaded.\n+\\f[CB]Loaded\\f[R]: Number of classes loaded.\n@@ -219,1 +223,1 @@\n-\\f[V]Bytes\\f[R]: Number of KB loaded.\n+\\f[CB]Bytes\\f[R]: Number of KB loaded.\n@@ -221,1 +225,1 @@\n-\\f[V]Unloaded\\f[R]: Number of classes unloaded.\n+\\f[CB]Unloaded\\f[R]: Number of classes unloaded.\n@@ -223,1 +227,1 @@\n-\\f[V]Bytes\\f[R]: Number of KB unloaded.\n+\\f[CB]Bytes\\f[R]: Number of KB unloaded.\n@@ -225,1 +229,1 @@\n-\\f[V]Time\\f[R]: Time spent performing class loading and unloading\n+\\f[CB]Time\\f[R]: Time spent performing class loading and unloading\n@@ -229,2 +233,2 @@\n-\\f[V]-compiler\\f[R] \\f[I]option\\f[R]\n-Java HotSpot VM Just-in-Time compiler statistics.\n+.B \\f[CB]\\-compiler\\f[R] \\f[I]option\\f[R]\n+Java HotSpot VM Just\\-in\\-Time compiler statistics.\n@@ -233,1 +237,1 @@\n-\\f[V]Compiled\\f[R]: Number of compilation tasks performed.\n+\\f[CB]Compiled\\f[R]: Number of compilation tasks performed.\n@@ -235,1 +239,1 @@\n-\\f[V]Failed\\f[R]: Number of compilations tasks failed.\n+\\f[CB]Failed\\f[R]: Number of compilations tasks failed.\n@@ -237,1 +241,1 @@\n-\\f[V]Invalid\\f[R]: Number of compilation tasks that were invalidated.\n+\\f[CB]Invalid\\f[R]: Number of compilation tasks that were invalidated.\n@@ -239,1 +243,1 @@\n-\\f[V]Time\\f[R]: Time spent performing compilation tasks.\n+\\f[CB]Time\\f[R]: Time spent performing compilation tasks.\n@@ -241,1 +245,1 @@\n-\\f[V]FailedType\\f[R]: Compile type of the last failed compilation.\n+\\f[CB]FailedType\\f[R]: Compile type of the last failed compilation.\n@@ -243,1 +247,1 @@\n-\\f[V]FailedMethod\\f[R]: Class name and method of the last failed\n+\\f[CB]FailedMethod\\f[R]: Class name and method of the last failed\n@@ -247,1 +251,1 @@\n-\\f[V]-gc\\f[R] \\f[I]option\\f[R]\n+.B \\f[CB]\\-gc\\f[R] \\f[I]option\\f[R]\n@@ -251,1 +255,1 @@\n-\\f[V]S0C\\f[R]: Current survivor space 0 capacity (KB).\n+\\f[CB]S0C\\f[R]: Current survivor space 0 capacity (KB).\n@@ -253,1 +257,1 @@\n-\\f[V]S1C\\f[R]: Current survivor space 1 capacity (KB).\n+\\f[CB]S1C\\f[R]: Current survivor space 1 capacity (KB).\n@@ -255,1 +259,1 @@\n-\\f[V]S0U\\f[R]: Survivor space 0 utilization (KB).\n+\\f[CB]S0U\\f[R]: Survivor space 0 utilization (KB).\n@@ -257,1 +261,1 @@\n-\\f[V]S1U\\f[R]: Survivor space 1 utilization (KB).\n+\\f[CB]S1U\\f[R]: Survivor space 1 utilization (KB).\n@@ -259,1 +263,1 @@\n-\\f[V]EC\\f[R]: Current eden space capacity (KB).\n+\\f[CB]EC\\f[R]: Current eden space capacity (KB).\n@@ -261,1 +265,1 @@\n-\\f[V]EU\\f[R]: Eden space utilization (KB).\n+\\f[CB]EU\\f[R]: Eden space utilization (KB).\n@@ -263,1 +267,1 @@\n-\\f[V]OC\\f[R]: Current old space capacity (KB).\n+\\f[CB]OC\\f[R]: Current old space capacity (KB).\n@@ -265,1 +269,1 @@\n-\\f[V]OU\\f[R]: Old space utilization (KB).\n+\\f[CB]OU\\f[R]: Old space utilization (KB).\n@@ -267,1 +271,1 @@\n-\\f[V]MC\\f[R]: Metaspace Committed Size (KB).\n+\\f[CB]MC\\f[R]: Metaspace Committed Size (KB).\n@@ -269,1 +273,1 @@\n-\\f[V]MU\\f[R]: Metaspace utilization (KB).\n+\\f[CB]MU\\f[R]: Metaspace utilization (KB).\n@@ -271,1 +275,1 @@\n-\\f[V]CCSC\\f[R]: Compressed class committed size (KB).\n+\\f[CB]CCSC\\f[R]: Compressed class committed size (KB).\n@@ -273,1 +277,1 @@\n-\\f[V]CCSU\\f[R]: Compressed class space used (KB).\n+\\f[CB]CCSU\\f[R]: Compressed class space used (KB).\n@@ -275,2 +279,1 @@\n-\\f[V]YGC\\f[R]: Number of young generation garbage collection (GC)\n-events.\n+\\f[CB]YGC\\f[R]: Number of young generation garbage collection (GC) events.\n@@ -278,1 +281,1 @@\n-\\f[V]YGCT\\f[R]: Young generation garbage collection time.\n+\\f[CB]YGCT\\f[R]: Young generation garbage collection time.\n@@ -280,1 +283,1 @@\n-\\f[V]FGC\\f[R]: Number of full GC events.\n+\\f[CB]FGC\\f[R]: Number of full GC events.\n@@ -282,1 +285,1 @@\n-\\f[V]FGCT\\f[R]: Full garbage collection time.\n+\\f[CB]FGCT\\f[R]: Full garbage collection time.\n@@ -284,1 +287,1 @@\n-\\f[V]GCT\\f[R]: Total garbage collection time.\n+\\f[CB]GCT\\f[R]: Total garbage collection time.\n@@ -287,1 +290,1 @@\n-\\f[V]-gccapacity\\f[R] \\f[I]option\\f[R]\n+.B \\f[CB]\\-gccapacity\\f[R] \\f[I]option\\f[R]\n@@ -291,1 +294,1 @@\n-\\f[V]NGCMN\\f[R]: Minimum new generation capacity (KB).\n+\\f[CB]NGCMN\\f[R]: Minimum new generation capacity (KB).\n@@ -293,1 +296,1 @@\n-\\f[V]NGCMX\\f[R]: Maximum new generation capacity (KB).\n+\\f[CB]NGCMX\\f[R]: Maximum new generation capacity (KB).\n@@ -295,1 +298,1 @@\n-\\f[V]NGC\\f[R]: Current new generation capacity (KB).\n+\\f[CB]NGC\\f[R]: Current new generation capacity (KB).\n@@ -297,1 +300,1 @@\n-\\f[V]S0C\\f[R]: Current survivor space 0 capacity (KB).\n+\\f[CB]S0C\\f[R]: Current survivor space 0 capacity (KB).\n@@ -299,1 +302,1 @@\n-\\f[V]S1C\\f[R]: Current survivor space 1 capacity (KB).\n+\\f[CB]S1C\\f[R]: Current survivor space 1 capacity (KB).\n@@ -301,1 +304,1 @@\n-\\f[V]EC\\f[R]: Current eden space capacity (KB).\n+\\f[CB]EC\\f[R]: Current eden space capacity (KB).\n@@ -303,1 +306,1 @@\n-\\f[V]OGCMN\\f[R]: Minimum old generation capacity (KB).\n+\\f[CB]OGCMN\\f[R]: Minimum old generation capacity (KB).\n@@ -305,1 +308,1 @@\n-\\f[V]OGCMX\\f[R]: Maximum old generation capacity (KB).\n+\\f[CB]OGCMX\\f[R]: Maximum old generation capacity (KB).\n@@ -307,1 +310,1 @@\n-\\f[V]OGC\\f[R]: Current old generation capacity (KB).\n+\\f[CB]OGC\\f[R]: Current old generation capacity (KB).\n@@ -309,1 +312,1 @@\n-\\f[V]OC\\f[R]: Current old space capacity (KB).\n+\\f[CB]OC\\f[R]: Current old space capacity (KB).\n@@ -311,1 +314,1 @@\n-\\f[V]MCMN\\f[R]: Minimum metaspace capacity (KB).\n+\\f[CB]MCMN\\f[R]: Minimum metaspace capacity (KB).\n@@ -313,1 +316,1 @@\n-\\f[V]MCMX\\f[R]: Maximum metaspace capacity (KB).\n+\\f[CB]MCMX\\f[R]: Maximum metaspace capacity (KB).\n@@ -315,1 +318,1 @@\n-\\f[V]MC\\f[R]: Metaspace Committed Size (KB).\n+\\f[CB]MC\\f[R]: Metaspace Committed Size (KB).\n@@ -317,1 +320,1 @@\n-\\f[V]CCSMN\\f[R]: Compressed class space minimum capacity (KB).\n+\\f[CB]CCSMN\\f[R]: Compressed class space minimum capacity (KB).\n@@ -319,1 +322,1 @@\n-\\f[V]CCSMX\\f[R]: Compressed class space maximum capacity (KB).\n+\\f[CB]CCSMX\\f[R]: Compressed class space maximum capacity (KB).\n@@ -321,1 +324,1 @@\n-\\f[V]CCSC\\f[R]: Compressed class committed size (KB).\n+\\f[CB]CCSC\\f[R]: Compressed class committed size (KB).\n@@ -323,1 +326,1 @@\n-\\f[V]YGC\\f[R]: Number of young generation GC events.\n+\\f[CB]YGC\\f[R]: Number of young generation GC events.\n@@ -325,1 +328,1 @@\n-\\f[V]FGC\\f[R]: Number of full GC events.\n+\\f[CB]FGC\\f[R]: Number of full GC events.\n@@ -328,1 +331,1 @@\n-\\f[V]-gccause\\f[R] \\f[I]option\\f[R]\n+.B \\f[CB]\\-gccause\\f[R] \\f[I]option\\f[R]\n@@ -330,1 +333,1 @@\n-as the \\f[V]-gcutil\\f[R] option, but includes the causes of the last\n+as the \\f[CB]\\-gcutil\\f[R] option, but includes the causes of the last\n@@ -333,1 +336,1 @@\n-In addition to the columns listed for \\f[V]-gcutil\\f[R], this option\n+In addition to the columns listed for \\f[CB]\\-gcutil\\f[R], this option\n@@ -337,1 +340,1 @@\n-\\f[V]LGCC\\f[R]: Cause of last garbage collection\n+\\f[CB]LGCC\\f[R]: Cause of last garbage collection\n@@ -339,1 +342,1 @@\n-\\f[V]GCC\\f[R]: Cause of current garbage collection\n+\\f[CB]GCC\\f[R]: Cause of current garbage collection\n@@ -342,1 +345,1 @@\n-\\f[V]-gcnew\\f[R] \\f[I]option\\f[R]\n+.B \\f[CB]\\-gcnew\\f[R] \\f[I]option\\f[R]\n@@ -346,1 +349,1 @@\n-\\f[V]S0C\\f[R]: Current survivor space 0 capacity (KB).\n+\\f[CB]S0C\\f[R]: Current survivor space 0 capacity (KB).\n@@ -348,1 +351,1 @@\n-\\f[V]S1C\\f[R]: Current survivor space 1 capacity (KB).\n+\\f[CB]S1C\\f[R]: Current survivor space 1 capacity (KB).\n@@ -350,1 +353,1 @@\n-\\f[V]S0U\\f[R]: Survivor space 0 utilization (KB).\n+\\f[CB]S0U\\f[R]: Survivor space 0 utilization (KB).\n@@ -352,1 +355,1 @@\n-\\f[V]S1U\\f[R]: Survivor space 1 utilization (KB).\n+\\f[CB]S1U\\f[R]: Survivor space 1 utilization (KB).\n@@ -354,1 +357,1 @@\n-\\f[V]TT\\f[R]: Tenuring threshold.\n+\\f[CB]TT\\f[R]: Tenuring threshold.\n@@ -356,1 +359,1 @@\n-\\f[V]MTT\\f[R]: Maximum tenuring threshold.\n+\\f[CB]MTT\\f[R]: Maximum tenuring threshold.\n@@ -358,1 +361,1 @@\n-\\f[V]DSS\\f[R]: Desired survivor size (KB).\n+\\f[CB]DSS\\f[R]: Desired survivor size (KB).\n@@ -360,1 +363,1 @@\n-\\f[V]EC\\f[R]: Current eden space capacity (KB).\n+\\f[CB]EC\\f[R]: Current eden space capacity (KB).\n@@ -362,1 +365,1 @@\n-\\f[V]EU\\f[R]: Eden space utilization (KB).\n+\\f[CB]EU\\f[R]: Eden space utilization (KB).\n@@ -364,1 +367,1 @@\n-\\f[V]YGC\\f[R]: Number of young generation GC events.\n+\\f[CB]YGC\\f[R]: Number of young generation GC events.\n@@ -366,1 +369,1 @@\n-\\f[V]YGCT\\f[R]: Young generation garbage collection time.\n+\\f[CB]YGCT\\f[R]: Young generation garbage collection time.\n@@ -369,1 +372,1 @@\n-\\f[V]-gcnewcapacity\\f[R] \\f[I]option\\f[R]\n+.B \\f[CB]\\-gcnewcapacity\\f[R] \\f[I]option\\f[R]\n@@ -373,1 +376,1 @@\n-\\f[V]NGCMN\\f[R]: Minimum new generation capacity (KB).\n+\\f[CB]NGCMN\\f[R]: Minimum new generation capacity (KB).\n@@ -375,1 +378,1 @@\n-\\f[V]NGCMX\\f[R]: Maximum new generation capacity (KB).\n+\\f[CB]NGCMX\\f[R]: Maximum new generation capacity (KB).\n@@ -377,1 +380,1 @@\n-\\f[V]NGC\\f[R]: Current new generation capacity (KB).\n+\\f[CB]NGC\\f[R]: Current new generation capacity (KB).\n@@ -379,1 +382,1 @@\n-\\f[V]S0CMX\\f[R]: Maximum survivor space 0 capacity (KB).\n+\\f[CB]S0CMX\\f[R]: Maximum survivor space 0 capacity (KB).\n@@ -381,1 +384,1 @@\n-\\f[V]S0C\\f[R]: Current survivor space 0 capacity (KB).\n+\\f[CB]S0C\\f[R]: Current survivor space 0 capacity (KB).\n@@ -383,1 +386,1 @@\n-\\f[V]S1CMX\\f[R]: Maximum survivor space 1 capacity (KB).\n+\\f[CB]S1CMX\\f[R]: Maximum survivor space 1 capacity (KB).\n@@ -385,1 +388,1 @@\n-\\f[V]S1C\\f[R]: Current survivor space 1 capacity (KB).\n+\\f[CB]S1C\\f[R]: Current survivor space 1 capacity (KB).\n@@ -387,1 +390,1 @@\n-\\f[V]ECMX\\f[R]: Maximum eden space capacity (KB).\n+\\f[CB]ECMX\\f[R]: Maximum eden space capacity (KB).\n@@ -389,1 +392,1 @@\n-\\f[V]EC\\f[R]: Current eden space capacity (KB).\n+\\f[CB]EC\\f[R]: Current eden space capacity (KB).\n@@ -391,1 +394,1 @@\n-\\f[V]YGC\\f[R]: Number of young generation GC events.\n+\\f[CB]YGC\\f[R]: Number of young generation GC events.\n@@ -393,1 +396,1 @@\n-\\f[V]FGC\\f[R]: Number of full GC events.\n+\\f[CB]FGC\\f[R]: Number of full GC events.\n@@ -396,1 +399,1 @@\n-\\f[V]-gcold\\f[R] \\f[I]option\\f[R]\n+.B \\f[CB]\\-gcold\\f[R] \\f[I]option\\f[R]\n@@ -400,1 +403,1 @@\n-\\f[V]MC\\f[R]: Metaspace Committed Size (KB).\n+\\f[CB]MC\\f[R]: Metaspace Committed Size (KB).\n@@ -402,1 +405,1 @@\n-\\f[V]MU\\f[R]: Metaspace utilization (KB).\n+\\f[CB]MU\\f[R]: Metaspace utilization (KB).\n@@ -404,1 +407,1 @@\n-\\f[V]CCSC\\f[R]: Compressed class committed size (KB).\n+\\f[CB]CCSC\\f[R]: Compressed class committed size (KB).\n@@ -406,1 +409,1 @@\n-\\f[V]CCSU\\f[R]: Compressed class space used (KB).\n+\\f[CB]CCSU\\f[R]: Compressed class space used (KB).\n@@ -408,1 +411,1 @@\n-\\f[V]OC\\f[R]: Current old space capacity (KB).\n+\\f[CB]OC\\f[R]: Current old space capacity (KB).\n@@ -410,1 +413,1 @@\n-\\f[V]OU\\f[R]: Old space utilization (KB).\n+\\f[CB]OU\\f[R]: Old space utilization (KB).\n@@ -412,1 +415,1 @@\n-\\f[V]YGC\\f[R]: Number of young generation GC events.\n+\\f[CB]YGC\\f[R]: Number of young generation GC events.\n@@ -414,1 +417,1 @@\n-\\f[V]FGC\\f[R]: Number of full GC events.\n+\\f[CB]FGC\\f[R]: Number of full GC events.\n@@ -416,1 +419,1 @@\n-\\f[V]FGCT\\f[R]: Full garbage collection time.\n+\\f[CB]FGCT\\f[R]: Full garbage collection time.\n@@ -418,1 +421,1 @@\n-\\f[V]GCT\\f[R]: Total garbage collection time.\n+\\f[CB]GCT\\f[R]: Total garbage collection time.\n@@ -421,1 +424,1 @@\n-\\f[V]-gcoldcapacity\\f[R] \\f[I]option\\f[R]\n+.B \\f[CB]\\-gcoldcapacity\\f[R] \\f[I]option\\f[R]\n@@ -425,1 +428,1 @@\n-\\f[V]OGCMN\\f[R]: Minimum old generation capacity (KB).\n+\\f[CB]OGCMN\\f[R]: Minimum old generation capacity (KB).\n@@ -427,1 +430,1 @@\n-\\f[V]OGCMX\\f[R]: Maximum old generation capacity (KB).\n+\\f[CB]OGCMX\\f[R]: Maximum old generation capacity (KB).\n@@ -429,1 +432,1 @@\n-\\f[V]OGC\\f[R]: Current old generation capacity (KB).\n+\\f[CB]OGC\\f[R]: Current old generation capacity (KB).\n@@ -431,1 +434,1 @@\n-\\f[V]OC\\f[R]: Current old space capacity (KB).\n+\\f[CB]OC\\f[R]: Current old space capacity (KB).\n@@ -433,1 +436,1 @@\n-\\f[V]YGC\\f[R]: Number of young generation GC events.\n+\\f[CB]YGC\\f[R]: Number of young generation GC events.\n@@ -435,1 +438,1 @@\n-\\f[V]FGC\\f[R]: Number of full GC events.\n+\\f[CB]FGC\\f[R]: Number of full GC events.\n@@ -437,1 +440,1 @@\n-\\f[V]FGCT\\f[R]: Full garbage collection time.\n+\\f[CB]FGCT\\f[R]: Full garbage collection time.\n@@ -439,1 +442,1 @@\n-\\f[V]GCT\\f[R]: Total garbage collection time.\n+\\f[CB]GCT\\f[R]: Total garbage collection time.\n@@ -442,1 +445,1 @@\n-\\f[V]-gcmetacapacity\\f[R] \\f[I]option\\f[R]\n+.B \\f[CB]\\-gcmetacapacity\\f[R] \\f[I]option\\f[R]\n@@ -446,1 +449,1 @@\n-\\f[V]MCMN\\f[R]: Minimum metaspace capacity (KB).\n+\\f[CB]MCMN\\f[R]: Minimum metaspace capacity (KB).\n@@ -448,1 +451,1 @@\n-\\f[V]MCMX\\f[R]: Maximum metaspace capacity (KB).\n+\\f[CB]MCMX\\f[R]: Maximum metaspace capacity (KB).\n@@ -450,1 +453,1 @@\n-\\f[V]MC\\f[R]: Metaspace Committed Size (KB).\n+\\f[CB]MC\\f[R]: Metaspace Committed Size (KB).\n@@ -452,1 +455,1 @@\n-\\f[V]CCSMN\\f[R]: Compressed class space minimum capacity (KB).\n+\\f[CB]CCSMN\\f[R]: Compressed class space minimum capacity (KB).\n@@ -454,1 +457,1 @@\n-\\f[V]CCSMX\\f[R]: Compressed class space maximum capacity (KB).\n+\\f[CB]CCSMX\\f[R]: Compressed class space maximum capacity (KB).\n@@ -456,1 +459,1 @@\n-\\f[V]YGC\\f[R]: Number of young generation GC events.\n+\\f[CB]YGC\\f[R]: Number of young generation GC events.\n@@ -458,1 +461,1 @@\n-\\f[V]FGC\\f[R]: Number of full GC events.\n+\\f[CB]FGC\\f[R]: Number of full GC events.\n@@ -460,1 +463,1 @@\n-\\f[V]FGCT\\f[R]: Full garbage collection time.\n+\\f[CB]FGCT\\f[R]: Full garbage collection time.\n@@ -462,1 +465,1 @@\n-\\f[V]GCT\\f[R]: Total garbage collection time.\n+\\f[CB]GCT\\f[R]: Total garbage collection time.\n@@ -465,1 +468,1 @@\n-\\f[V]-gcutil\\f[R] \\f[I]option\\f[R]\n+.B \\f[CB]\\-gcutil\\f[R] \\f[I]option\\f[R]\n@@ -469,1 +472,1 @@\n-\\f[V]S0\\f[R]: Survivor space 0 utilization as a percentage of the\n+\\f[CB]S0\\f[R]: Survivor space 0 utilization as a percentage of the\n@@ -472,1 +475,1 @@\n-\\f[V]S1\\f[R]: Survivor space 1 utilization as a percentage of the\n+\\f[CB]S1\\f[R]: Survivor space 1 utilization as a percentage of the\n@@ -475,1 +478,1 @@\n-\\f[V]E\\f[R]: Eden space utilization as a percentage of the space\\[aq]s\n+\\f[CB]E\\f[R]: Eden space utilization as a percentage of the space\\[aq]s\n@@ -478,1 +481,1 @@\n-\\f[V]O\\f[R]: Old space utilization as a percentage of the space\\[aq]s\n+\\f[CB]O\\f[R]: Old space utilization as a percentage of the space\\[aq]s\n@@ -481,1 +484,1 @@\n-\\f[V]M\\f[R]: Metaspace utilization as a percentage of the space\\[aq]s\n+\\f[CB]M\\f[R]: Metaspace utilization as a percentage of the space\\[aq]s\n@@ -484,1 +487,1 @@\n-\\f[V]CCS\\f[R]: Compressed class space utilization as a percentage.\n+\\f[CB]CCS\\f[R]: Compressed class space utilization as a percentage.\n@@ -486,1 +489,1 @@\n-\\f[V]YGC\\f[R]: Number of young generation GC events.\n+\\f[CB]YGC\\f[R]: Number of young generation GC events.\n@@ -488,1 +491,1 @@\n-\\f[V]YGCT\\f[R]: Young generation garbage collection time.\n+\\f[CB]YGCT\\f[R]: Young generation garbage collection time.\n@@ -490,1 +493,1 @@\n-\\f[V]FGC\\f[R]: Number of full GC events.\n+\\f[CB]FGC\\f[R]: Number of full GC events.\n@@ -492,1 +495,1 @@\n-\\f[V]FGCT\\f[R]: Full garbage collection time.\n+\\f[CB]FGCT\\f[R]: Full garbage collection time.\n@@ -494,1 +497,1 @@\n-\\f[V]GCT\\f[R]: Total garbage collection time.\n+\\f[CB]GCT\\f[R]: Total garbage collection time.\n@@ -497,1 +500,1 @@\n-\\f[V]-printcompilation\\f[R] \\f[I]option\\f[R]\n+.B \\f[CB]\\-printcompilation\\f[R] \\f[I]option\\f[R]\n@@ -501,1 +504,1 @@\n-\\f[V]Compiled\\f[R]: Number of compilation tasks performed by the most\n+\\f[CB]Compiled\\f[R]: Number of compilation tasks performed by the most\n@@ -504,1 +507,1 @@\n-\\f[V]Size\\f[R]: Number of bytes of byte code of the most recently\n+\\f[CB]Size\\f[R]: Number of bytes of byte code of the most recently\n@@ -507,1 +510,1 @@\n-\\f[V]Type\\f[R]: Compilation type of the most recently compiled method.\n+\\f[CB]Type\\f[R]: Compilation type of the most recently compiled method.\n@@ -509,1 +512,1 @@\n-\\f[V]Method\\f[R]: Class name and method name identifying the most\n+\\f[CB]Method\\f[R]: Class name and method name identifying the most\n@@ -511,2 +514,2 @@\n-Class name uses a slash (\/) instead of a dot (.)\n-as a name space separator.\n+Class name uses a slash (\/) instead of a dot (.) as a name space\n+separator.\n@@ -515,1 +518,1 @@\n-\\f[V]-XX:+PrintCompilation\\f[R] option.\n+\\f[CB]\\-XX:+PrintCompilation\\f[R] option.\n@@ -519,1 +522,1 @@\n-The syntax of the \\f[V]vmid\\f[R] string corresponds to the syntax of a\n+The syntax of the \\f[CB]vmid\\f[R] string corresponds to the syntax of a\n@@ -523,1 +526,1 @@\n-[\\f[I]protocol\\f[R]\\f[V]:\\f[R]][\\f[V]\/\/\\f[R]]\\f[I]lvmid\\f[R][\\f[V]\\[at]\\f[R]\\f[I]hostname\\f[R][\\f[V]:\\f[R]\\f[I]port\\f[R]][\\f[V]\/\\f[R]\\f[I]servername\\f[R]]\n+[\\f[I]protocol\\f[R]\\f[CB]:\\f[R]][\\f[CB]\/\/\\f[R]]\\f[I]lvmid\\f[R][\\f[CB]\\@\\f[R]\\f[I]hostname\\f[R][\\f[CB]:\\f[R]\\f[I]port\\f[R]][\\f[CB]\/\\f[R]\\f[I]servername\\f[R]]\n@@ -526,1 +529,1 @@\n-The syntax of the \\f[V]vmid\\f[R] string corresponds to the syntax of a\n+The syntax of the \\f[CB]vmid\\f[R] string corresponds to the syntax of a\n@@ -528,1 +531,1 @@\n-The \\f[V]vmid\\f[R] string can vary from a simple integer that represents\n+The \\f[CB]vmid\\f[R] string can vary from a simple integer that represents\n@@ -530,1 +533,1 @@\n-communications protocol, port number, and other implementation-specific\n+communications protocol, port number, and other implementation\\-specific\n@@ -533,1 +536,1 @@\n-\\f[I]protocol\\f[R]\n+.B \\f[I]protocol\\f[R]\n@@ -536,1 +539,1 @@\n-specified, then the default protocol is a platform-specific optimized\n+specified, then the default protocol is a platform\\-specific optimized\n@@ -539,1 +542,3 @@\n-then the default protocol is \\f[V]rmi\\f[R].\n+then the default protocol is \\f[CB]rmi\\f[R].\n+.RS\n+.RE\n@@ -541,1 +546,1 @@\n-\\f[I]lvmid\\f[R]\n+.B \\f[I]lvmid\\f[R]\n@@ -543,1 +548,1 @@\n-The \\f[I]lvmid\\f[R] is a platform-specific value that uniquely\n+The \\f[I]lvmid\\f[R] is a platform\\-specific value that uniquely\n@@ -549,1 +554,1 @@\n-You can use the \\f[V]jps\\f[R] command to determine the \\f[I]lvmid\\f[R]\n+You can use the \\f[CB]jps\\f[R] command to determine the \\f[I]lvmid\\f[R]\n@@ -552,1 +557,1 @@\n-with the \\f[V]ps\\f[R] command, and on Windows with the Windows Task\n+with the \\f[CB]ps\\f[R] command, and on Windows with the Windows Task\n@@ -554,0 +559,2 @@\n+.RS\n+.RE\n@@ -555,1 +562,1 @@\n-\\f[I]hostname\\f[R]\n+.B \\f[I]hostname\\f[R]\n@@ -559,0 +566,2 @@\n+.RS\n+.RE\n@@ -560,1 +569,1 @@\n-\\f[I]port\\f[R]\n+.B \\f[I]port\\f[R]\n@@ -562,3 +571,3 @@\n-If the \\f[I]hostname\\f[R] value is omitted or the \\f[I]protocol\\f[R]\n-value specifies an optimized, local protocol, then the \\f[I]port\\f[R]\n-value is ignored.\n+If the \\f[I]hostname\\f[R] value is omitted or the \\f[I]protocol\\f[R] value\n+specifies an optimized, local protocol, then the \\f[I]port\\f[R] value is\n+ignored.\n@@ -566,3 +575,3 @@\n-implementation-specific.\n-For the default \\f[V]rmi\\f[R] protocol, the port value indicates the\n-port number for the \\f[V]rmiregistry\\f[R] on the remote host.\n+implementation\\-specific.\n+For the default \\f[CB]rmi\\f[R] protocol, the port value indicates the port\n+number for the \\f[CB]rmiregistry\\f[R] on the remote host.\n@@ -570,1 +579,1 @@\n-indicates \\f[V]rmi\\f[R], then the default rmiregistry port (1099) is\n+indicates \\f[CB]rmi\\f[R], then the default rmiregistry port (1099) is\n@@ -572,0 +581,2 @@\n+.RS\n+.RE\n@@ -573,1 +584,1 @@\n-\\f[I]servername\\f[R]\n+.B \\f[I]servername\\f[R]\n@@ -577,1 +588,1 @@\n-For the \\f[V]rmi\\f[R] protocol, it represents the name of the RMI remote\n+For the \\f[CB]rmi\\f[R] protocol, it represents the name of the RMI remote\n@@ -579,0 +590,2 @@\n+.RS\n+.RE\n@@ -587,1 +600,1 @@\n-\\f[V]-gcutil\\f[R] option.\n+\\f[CB]\\-gcutil\\f[R] option.\n@@ -599,9 +612,9 @@\n-jstat -gcutil 21891 250 7\n-  S0     S1     E      O      M     CCS    YGC     YGCT    FGC    FGCT     GCT\n-  0.00  97.02  70.31  66.80  95.52  89.14      7    0.300     0    0.000    0.300\n-  0.00  97.02  86.23  66.80  95.52  89.14      7    0.300     0    0.000    0.300\n-  0.00  97.02  96.53  66.80  95.52  89.14      7    0.300     0    0.000    0.300\n- 91.03   0.00   1.98  68.19  95.89  91.24      8    0.378     0    0.000    0.378\n- 91.03   0.00  15.82  68.19  95.89  91.24      8    0.378     0    0.000    0.378\n- 91.03   0.00  17.80  68.19  95.89  91.24      8    0.378     0    0.000    0.378\n- 91.03   0.00  17.80  68.19  95.89  91.24      8    0.378     0    0.000    0.378\n+jstat\\ \\-gcutil\\ 21891\\ 250\\ 7\n+\\ \\ S0\\ \\ \\ \\ \\ S1\\ \\ \\ \\ \\ E\\ \\ \\ \\ \\ \\ O\\ \\ \\ \\ \\ \\ M\\ \\ \\ \\ \\ CCS\\ \\ \\ \\ YGC\\ \\ \\ \\ \\ YGCT\\ \\ \\ \\ FGC\\ \\ \\ \\ FGCT\\ \\ \\ \\ \\ GCT\n+\\ \\ 0.00\\ \\ 97.02\\ \\ 70.31\\ \\ 66.80\\ \\ 95.52\\ \\ 89.14\\ \\ \\ \\ \\ \\ 7\\ \\ \\ \\ 0.300\\ \\ \\ \\ \\ 0\\ \\ \\ \\ 0.000\\ \\ \\ \\ 0.300\n+\\ \\ 0.00\\ \\ 97.02\\ \\ 86.23\\ \\ 66.80\\ \\ 95.52\\ \\ 89.14\\ \\ \\ \\ \\ \\ 7\\ \\ \\ \\ 0.300\\ \\ \\ \\ \\ 0\\ \\ \\ \\ 0.000\\ \\ \\ \\ 0.300\n+\\ \\ 0.00\\ \\ 97.02\\ \\ 96.53\\ \\ 66.80\\ \\ 95.52\\ \\ 89.14\\ \\ \\ \\ \\ \\ 7\\ \\ \\ \\ 0.300\\ \\ \\ \\ \\ 0\\ \\ \\ \\ 0.000\\ \\ \\ \\ 0.300\n+\\ 91.03\\ \\ \\ 0.00\\ \\ \\ 1.98\\ \\ 68.19\\ \\ 95.89\\ \\ 91.24\\ \\ \\ \\ \\ \\ 8\\ \\ \\ \\ 0.378\\ \\ \\ \\ \\ 0\\ \\ \\ \\ 0.000\\ \\ \\ \\ 0.378\n+\\ 91.03\\ \\ \\ 0.00\\ \\ 15.82\\ \\ 68.19\\ \\ 95.89\\ \\ 91.24\\ \\ \\ \\ \\ \\ 8\\ \\ \\ \\ 0.378\\ \\ \\ \\ \\ 0\\ \\ \\ \\ 0.000\\ \\ \\ \\ 0.378\n+\\ 91.03\\ \\ \\ 0.00\\ \\ 17.80\\ \\ 68.19\\ \\ 95.89\\ \\ 91.24\\ \\ \\ \\ \\ \\ 8\\ \\ \\ \\ 0.378\\ \\ \\ \\ \\ 0\\ \\ \\ \\ 0.000\\ \\ \\ \\ 0.378\n+\\ 91.03\\ \\ \\ 0.00\\ \\ 17.80\\ \\ 68.19\\ \\ 95.89\\ \\ 91.24\\ \\ \\ \\ \\ \\ 8\\ \\ \\ \\ 0.378\\ \\ \\ \\ \\ 0\\ \\ \\ \\ 0.000\\ \\ \\ \\ 0.378\n@@ -614,2 +627,2 @@\n-\\f[V]-gcnew\\f[R] option.\n-In addition, it uses the \\f[V]-h3\\f[R] option to output the column\n+\\f[CB]\\-gcnew\\f[R] option.\n+In addition, it uses the \\f[CB]\\-h3\\f[R] option to output the column\n@@ -632,11 +645,11 @@\n-jstat -gcnew -h3 21891 250\n- S0C    S1C    S0U    S1U   TT MTT  DSS      EC       EU     YGC     YGCT\n-  64.0   64.0    0.0   31.7 31  31   32.0    512.0    178.6    249    0.203\n-  64.0   64.0    0.0   31.7 31  31   32.0    512.0    355.5    249    0.203\n-  64.0   64.0   35.4    0.0  2  31   32.0    512.0     21.9    250    0.204\n- S0C    S1C    S0U    S1U   TT MTT  DSS      EC       EU     YGC     YGCT\n-  64.0   64.0   35.4    0.0  2  31   32.0    512.0    245.9    250    0.204\n-  64.0   64.0   35.4    0.0  2  31   32.0    512.0    421.1    250    0.204\n-  64.0   64.0    0.0   19.0 31  31   32.0    512.0     84.4    251    0.204\n- S0C    S1C    S0U    S1U   TT MTT  DSS      EC       EU     YGC     YGCT\n-  64.0   64.0    0.0   19.0 31  31   32.0    512.0    306.7    251    0.204\n+jstat\\ \\-gcnew\\ \\-h3\\ 21891\\ 250\n+\\ S0C\\ \\ \\ \\ S1C\\ \\ \\ \\ S0U\\ \\ \\ \\ S1U\\ \\ \\ TT\\ MTT\\ \\ DSS\\ \\ \\ \\ \\ \\ EC\\ \\ \\ \\ \\ \\ \\ EU\\ \\ \\ \\ \\ YGC\\ \\ \\ \\ \\ YGCT\n+\\ \\ 64.0\\ \\ \\ 64.0\\ \\ \\ \\ 0.0\\ \\ \\ 31.7\\ 31\\ \\ 31\\ \\ \\ 32.0\\ \\ \\ \\ 512.0\\ \\ \\ \\ 178.6\\ \\ \\ \\ 249\\ \\ \\ \\ 0.203\n+\\ \\ 64.0\\ \\ \\ 64.0\\ \\ \\ \\ 0.0\\ \\ \\ 31.7\\ 31\\ \\ 31\\ \\ \\ 32.0\\ \\ \\ \\ 512.0\\ \\ \\ \\ 355.5\\ \\ \\ \\ 249\\ \\ \\ \\ 0.203\n+\\ \\ 64.0\\ \\ \\ 64.0\\ \\ \\ 35.4\\ \\ \\ \\ 0.0\\ \\ 2\\ \\ 31\\ \\ \\ 32.0\\ \\ \\ \\ 512.0\\ \\ \\ \\ \\ 21.9\\ \\ \\ \\ 250\\ \\ \\ \\ 0.204\n+\\ S0C\\ \\ \\ \\ S1C\\ \\ \\ \\ S0U\\ \\ \\ \\ S1U\\ \\ \\ TT\\ MTT\\ \\ DSS\\ \\ \\ \\ \\ \\ EC\\ \\ \\ \\ \\ \\ \\ EU\\ \\ \\ \\ \\ YGC\\ \\ \\ \\ \\ YGCT\n+\\ \\ 64.0\\ \\ \\ 64.0\\ \\ \\ 35.4\\ \\ \\ \\ 0.0\\ \\ 2\\ \\ 31\\ \\ \\ 32.0\\ \\ \\ \\ 512.0\\ \\ \\ \\ 245.9\\ \\ \\ \\ 250\\ \\ \\ \\ 0.204\n+\\ \\ 64.0\\ \\ \\ 64.0\\ \\ \\ 35.4\\ \\ \\ \\ 0.0\\ \\ 2\\ \\ 31\\ \\ \\ 32.0\\ \\ \\ \\ 512.0\\ \\ \\ \\ 421.1\\ \\ \\ \\ 250\\ \\ \\ \\ 0.204\n+\\ \\ 64.0\\ \\ \\ 64.0\\ \\ \\ \\ 0.0\\ \\ \\ 19.0\\ 31\\ \\ 31\\ \\ \\ 32.0\\ \\ \\ \\ 512.0\\ \\ \\ \\ \\ 84.4\\ \\ \\ \\ 251\\ \\ \\ \\ 0.204\n+\\ S0C\\ \\ \\ \\ S1C\\ \\ \\ \\ S0U\\ \\ \\ \\ S1U\\ \\ \\ TT\\ MTT\\ \\ DSS\\ \\ \\ \\ \\ \\ EC\\ \\ \\ \\ \\ \\ \\ EU\\ \\ \\ \\ \\ YGC\\ \\ \\ \\ \\ YGCT\n+\\ \\ 64.0\\ \\ \\ 64.0\\ \\ \\ \\ 0.0\\ \\ \\ 19.0\\ 31\\ \\ 31\\ \\ \\ 32.0\\ \\ \\ \\ 512.0\\ \\ \\ \\ 306.7\\ \\ \\ \\ 251\\ \\ \\ \\ 0.204\n@@ -649,1 +662,1 @@\n-The \\f[V]-t\\f[R] option is used to generate a time stamp for each sample\n+The \\f[CB]\\-t\\f[R] option is used to generate a time stamp for each sample\n@@ -654,1 +667,1 @@\n-In addition, the \\f[V]-gcoldcapacity\\f[R] output shows the old\n+In addition, the \\f[CB]\\-gcoldcapacity\\f[R] output shows the old\n@@ -658,1 +671,1 @@\n-after the eighty-first full garbage collection (FGC).\n+after the eighty\\-first full garbage collection (FGC).\n@@ -664,4 +677,4 @@\n-Timestamp      OGCMN    OGCMX     OGC       OC       YGC   FGC    FGCT    GCT\n-          150.1   1408.0  60544.0  11696.0  11696.0   194    80    2.874   3.799\n-          150.4   1408.0  60544.0  13820.0  13820.0   194    81    2.938   3.863\n-          150.7   1408.0  60544.0  13820.0  13820.0   194    81    2.938   3.863\n+Timestamp\\ \\ \\ \\ \\ \\ OGCMN\\ \\ \\ \\ OGCMX\\ \\ \\ \\ \\ OGC\\ \\ \\ \\ \\ \\ \\ OC\\ \\ \\ \\ \\ \\ \\ YGC\\ \\ \\ FGC\\ \\ \\ \\ FGCT\\ \\ \\ \\ GCT\n+\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ 150.1\\ \\ \\ 1408.0\\ \\ 60544.0\\ \\ 11696.0\\ \\ 11696.0\\ \\ \\ 194\\ \\ \\ \\ 80\\ \\ \\ \\ 2.874\\ \\ \\ 3.799\n+\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ 150.4\\ \\ \\ 1408.0\\ \\ 60544.0\\ \\ 13820.0\\ \\ 13820.0\\ \\ \\ 194\\ \\ \\ \\ 81\\ \\ \\ \\ 2.938\\ \\ \\ 3.863\n+\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ 150.7\\ \\ \\ 1408.0\\ \\ 60544.0\\ \\ 13820.0\\ \\ 13820.0\\ \\ \\ 194\\ \\ \\ \\ 81\\ \\ \\ \\ 2.938\\ \\ \\ 3.863\n@@ -673,1 +686,1 @@\n-\\f[V]remote.domain\\f[R] using the \\f[V]-gcutil\\f[R] option, with samples\n+\\f[CB]remote.domain\\f[R] using the \\f[CB]\\-gcutil\\f[R] option, with samples\n@@ -677,6 +690,6 @@\n-vmid of \\f[V]40496\\[at]remote.domain\\f[R].\n-This vmid results in the use of the \\f[V]rmi\\f[R] protocol to\n-communicate to the default \\f[V]jstatd\\f[R] server on the remote host.\n-The \\f[V]jstatd\\f[R] server is located using the \\f[V]rmiregistry\\f[R]\n-command on \\f[V]remote.domain\\f[R] that\\[aq]s bound to the default port\n-of the \\f[V]rmiregistry\\f[R] command (port 1099).\n+vmid of \\f[CB]40496\\@remote.domain\\f[R].\n+This vmid results in the use of the \\f[CB]rmi\\f[R] protocol to communicate\n+to the default \\f[CB]jstatd\\f[R] server on the remote host.\n+The \\f[CB]jstatd\\f[R] server is located using the \\f[CB]rmiregistry\\f[R]\n+command on \\f[CB]remote.domain\\f[R] that\\[aq]s bound to the default port\n+of the \\f[CB]rmiregistry\\f[R] command (port 1099).\n@@ -686,2 +699,2 @@\n-jstat -gcutil 40496\\[at]remote.domain 1000\n-\\&... output omitted\n+jstat\\ \\-gcutil\\ 40496\\@remote.domain\\ 1000\n+\\&...\\ output\\ omitted\n","filename":"src\/jdk.jcmd\/share\/man\/jstat.1","additions":284,"deletions":271,"binary":false,"changes":555,"status":"modified"},{"patch":"@@ -22,1 +22,1 @@\n-.\\\" Automatically generated by Pandoc 2.19.2\n+.\\\" Automatically generated by Pandoc 2.3.1\n@@ -24,15 +24,1 @@\n-.\\\" Define V font for inline verbatim, using C font in formats\n-.\\\" that render this, and otherwise B font.\n-.ie \"\\f[CB]x\\f[R]\"x\" \\{\\\n-. ftr V B\n-. ftr VI BI\n-. ftr VB B\n-. ftr VBI BI\n-.\\}\n-.el \\{\\\n-. ftr V CR\n-. ftr VI CI\n-. ftr VB CB\n-. ftr VBI CBI\n-.\\}\n-.TH \"JCONSOLE\" \"1\" \"2023\" \"JDK 20-ea\" \"JDK Commands\"\n+.TH \"JCONSOLE\" \"1\" \"2023\" \"JDK 20\\-ea\" \"JDK Commands\"\n@@ -42,1 +28,1 @@\n-jconsole - start a graphical console to monitor and manage Java\n+jconsole \\- start a graphical console to monitor and manage Java\n@@ -46,2 +32,2 @@\n-\\f[V]jconsole\\f[R] [\\f[V]-interval=\\f[R]\\f[I]n\\f[R]] [\\f[V]-notile\\f[R]]\n-[\\f[V]-plugin\\f[R] \\f[I]path\\f[R]] [\\f[V]-version\\f[R]]\n+\\f[CB]jconsole\\f[R] [\\f[CB]\\-interval=\\f[R]\\f[I]n\\f[R]] [\\f[CB]\\-notile\\f[R]]\n+[\\f[CB]\\-plugin\\f[R] \\f[I]path\\f[R]] [\\f[CB]\\-version\\f[R]]\n@@ -49,1 +35,1 @@\n-] [\\f[V]-J\\f[R]\\f[I]input_arguments\\f[R]]\n+] [\\f[CB]\\-J\\f[R]\\f[I]input_arguments\\f[R]]\n@@ -51,1 +37,1 @@\n-\\f[V]jconsole\\f[R] \\f[V]-help\\f[R]\n+\\f[CB]jconsole\\f[R] \\f[CB]\\-help\\f[R]\n@@ -54,2 +40,4 @@\n-\\f[V]-interval\\f[R]\n-Sets the update interval to \\f[V]n\\f[R] seconds (default is 4 seconds).\n+.B \\f[CB]\\-interval\\f[R]\n+Sets the update interval to \\f[CB]n\\f[R] seconds (default is 4 seconds).\n+.RS\n+.RE\n@@ -57,1 +45,1 @@\n-\\f[V]-notile\\f[R]\n+.B \\f[CB]\\-notile\\f[R]\n@@ -59,0 +47,2 @@\n+.RS\n+.RE\n@@ -60,5 +50,5 @@\n-\\f[V]-pluginpath\\f[R] \\f[I]path\\f[R]\n-Specifies the path that \\f[V]jconsole\\f[R] uses to look up plug-ins.\n-The plug-in \\f[I]path\\f[R] should contain a provider-configuration file\n-named \\f[V]META-INF\/services\/com.sun.tools.jconsole.JConsolePlugin\\f[R]\n-that contains one line for each plug-in.\n+.B \\f[CB]\\-pluginpath\\f[R] \\f[I]path\\f[R]\n+Specifies the path that \\f[CB]jconsole\\f[R] uses to look up plug\\-ins.\n+The plug\\-in \\f[I]path\\f[R] should contain a provider\\-configuration file\n+named \\f[CB]META\\-INF\/services\/com.sun.tools.jconsole.JConsolePlugin\\f[R]\n+that contains one line for each plug\\-in.\n@@ -66,1 +56,3 @@\n-implementing the \\f[V]com.sun.tools.jconsole.JConsolePlugin\\f[R] class.\n+implementing the \\f[CB]com.sun.tools.jconsole.JConsolePlugin\\f[R] class.\n+.RS\n+.RE\n@@ -68,1 +60,1 @@\n-\\f[V]-version\\f[R]\n+.B \\f[CB]\\-version\\f[R]\n@@ -70,0 +62,2 @@\n+.RS\n+.RE\n@@ -71,1 +65,1 @@\n-\\f[I]connection\\f[R] = \\f[I]pid\\f[R] | \\f[I]host\\f[R]\\f[V]:\\f[R]\\f[I]port\\f[R] | \\f[I]jmxURL\\f[R]\n+.B \\f[I]connection\\f[R] = \\f[I]pid\\f[R] | \\f[I]host\\f[R]\\f[CB]:\\f[R]\\f[I]port\\f[R] | \\f[I]jmxURL\\f[R]\n@@ -73,1 +67,1 @@\n-\\f[I]host\\f[R]\\f[V]:\\f[R]\\f[I]port\\f[R] or \\f[I]jmxURL\\f[R].\n+\\f[I]host\\f[R]\\f[CB]:\\f[R]\\f[I]port\\f[R] or \\f[I]jmxURL\\f[R].\n@@ -78,1 +72,1 @@\n-\\f[V]jconsole\\f[R] command.\n+\\f[CB]jconsole\\f[R] command.\n@@ -80,4 +74,4 @@\n-The \\f[I]host\\f[R]\\f[V]:\\f[R]\\f[I]port\\f[R] values are the name of the\n-host system on which the JVM is running, and the port number specified\n-by the system property \\f[V]com.sun.management.jmxremote.port\\f[R] when\n-the JVM was started.\n+The \\f[I]host\\f[R]\\f[CB]:\\f[R]\\f[I]port\\f[R] values are the name of the host\n+system on which the JVM is running, and the port number specified by the\n+system property \\f[CB]com.sun.management.jmxremote.port\\f[R] when the JVM\n+was started.\n@@ -89,1 +83,1 @@\n-\\f[V]-J\\f[R]\\f[I]input_arguments\\f[R]\n+.B \\f[CB]\\-J\\f[R]\\f[I]input_arguments\\f[R]\n@@ -91,1 +85,3 @@\n-\\f[V]jconsole\\f[R] command is run.\n+\\f[CB]jconsole\\f[R] command is run.\n+.RS\n+.RE\n@@ -93,1 +89,1 @@\n-\\f[V]-help\\f[R] or \\f[V]--help\\f[R]\n+.B \\f[CB]\\-help\\f[R] or \\f[CB]\\-\\-help\\f[R]\n@@ -95,0 +91,2 @@\n+.RS\n+.RE\n@@ -97,1 +95,1 @@\n-The \\f[V]jconsole\\f[R] command starts a graphical console tool that lets\n+The \\f[CB]jconsole\\f[R] command starts a graphical console tool that lets\n@@ -101,1 +99,1 @@\n-On Windows, the \\f[V]jconsole\\f[R] command doesn\\[aq]t associate with a\n+On Windows, the \\f[CB]jconsole\\f[R] command doesn\\[aq]t associate with a\n@@ -104,1 +102,1 @@\n-\\f[V]jconsole\\f[R] command fails.\n+\\f[CB]jconsole\\f[R] command fails.\n","filename":"src\/jdk.jconsole\/share\/man\/jconsole.1","additions":42,"deletions":44,"binary":false,"changes":86,"status":"modified"},{"patch":"@@ -22,1 +22,1 @@\n-.\\\" Automatically generated by Pandoc 2.19.2\n+.\\\" Automatically generated by Pandoc 2.3.1\n@@ -24,15 +24,1 @@\n-.\\\" Define V font for inline verbatim, using C font in formats\n-.\\\" that render this, and otherwise B font.\n-.ie \"\\f[CB]x\\f[R]\"x\" \\{\\\n-. ftr V B\n-. ftr VI BI\n-. ftr VB B\n-. ftr VBI BI\n-.\\}\n-.el \\{\\\n-. ftr V CR\n-. ftr VI CI\n-. ftr VB CB\n-. ftr VBI CBI\n-.\\}\n-.TH \"JAVAP\" \"1\" \"2023\" \"JDK 20-ea\" \"JDK Commands\"\n+.TH \"JAVAP\" \"1\" \"2023\" \"JDK 20\\-ea\" \"JDK Commands\"\n@@ -42,1 +28,1 @@\n-javap - disassemble one or more class files\n+javap \\- disassemble one or more class files\n@@ -45,1 +31,1 @@\n-\\f[V]javap\\f[R] [\\f[I]options\\f[R]] \\f[I]classes\\f[R]...\n+\\f[CB]javap\\f[R] [\\f[I]options\\f[R]] \\f[I]classes\\f[R]...\n@@ -47,2 +33,2 @@\n-\\f[I]options\\f[R]\n-Specifies the command-line options.\n+.B \\f[I]options\\f[R]\n+Specifies the command\\-line options.\n@@ -50,0 +36,2 @@\n+.RS\n+.RE\n@@ -51,1 +39,1 @@\n-\\f[I]classes\\f[R]\n+.B \\f[I]classes\\f[R]\n@@ -61,1 +49,1 @@\n-\\f[V]path\/to\/MyClass.class\\f[R]\n+\\f[CB]path\/to\/MyClass.class\\f[R]\n@@ -65,1 +53,1 @@\n-\\f[V]jar:file:\/\/\/path\/to\/MyJar.jar!\/mypkg\/MyClass.class\\f[R]\n+\\f[CB]jar:file:\/\/\/path\/to\/MyJar.jar!\/mypkg\/MyClass.class\\f[R]\n@@ -69,1 +57,1 @@\n-\\f[V]java.lang.Object\\f[R]\n+\\f[CB]java.lang.Object\\f[R]\n@@ -74,1 +62,1 @@\n-The \\f[V]javap\\f[R] command disassembles one or more class files.\n+The \\f[CB]javap\\f[R] command disassembles one or more class files.\n@@ -76,1 +64,1 @@\n-When no options are used, the \\f[V]javap\\f[R] command prints the\n+When no options are used, the \\f[CB]javap\\f[R] command prints the\n@@ -79,1 +67,1 @@\n-The \\f[V]javap\\f[R] command isn\\[aq]t multirelease JAR aware.\n+The \\f[CB]javap\\f[R] command isn\\[aq]t multirelease JAR aware.\n@@ -85,1 +73,1 @@\n-The \\f[V]javap\\f[R] command prints its output to \\f[V]stdout\\f[R].\n+The \\f[CB]javap\\f[R] command prints its output to \\f[CB]stdout\\f[R].\n@@ -89,2 +77,2 @@\n-In tools that support \\f[V]--\\f[R] style options, the GNU-style options\n-can use the equal sign (\\f[V]=\\f[R]) instead of a white space to\n+In tools that support \\f[CB]\\-\\-\\f[R] style options, the GNU\\-style\n+options can use the equal sign (\\f[CB]=\\f[R]) instead of a white space to\n@@ -94,2 +82,4 @@\n-\\f[V]--help\\f[R], \\f[V]-help\\f[R] , \\f[V]-h\\f[R], or \\f[V]-?\\f[R]\n-Prints a help message for the \\f[V]javap\\f[R] command.\n+.B \\f[CB]\\-\\-help\\f[R], \\f[CB]\\-help\\f[R] , \\f[CB]\\-h\\f[R], or \\f[CB]\\-?\\f[R]\n+Prints a help message for the \\f[CB]javap\\f[R] command.\n+.RS\n+.RE\n@@ -97,1 +87,1 @@\n-\\f[V]-version\\f[R]\n+.B \\f[CB]\\-version\\f[R]\n@@ -99,0 +89,2 @@\n+.RS\n+.RE\n@@ -100,1 +92,1 @@\n-\\f[V]-verbose\\f[R] or \\f[V]-v\\f[R]\n+.B \\f[CB]\\-verbose\\f[R] or \\f[CB]\\-v\\f[R]\n@@ -102,0 +94,2 @@\n+.RS\n+.RE\n@@ -103,1 +97,1 @@\n-\\f[V]-l\\f[R]\n+.B \\f[CB]\\-l\\f[R]\n@@ -105,0 +99,2 @@\n+.RS\n+.RE\n@@ -106,1 +102,1 @@\n-\\f[V]-public\\f[R]\n+.B \\f[CB]\\-public\\f[R]\n@@ -108,0 +104,2 @@\n+.RS\n+.RE\n@@ -109,1 +107,1 @@\n-\\f[V]-protected\\f[R]\n+.B \\f[CB]\\-protected\\f[R]\n@@ -111,0 +109,2 @@\n+.RS\n+.RE\n@@ -112,1 +112,1 @@\n-\\f[V]-package\\f[R]\n+.B \\f[CB]\\-package\\f[R]\n@@ -114,0 +114,2 @@\n+.RS\n+.RE\n@@ -115,1 +117,1 @@\n-\\f[V]-private\\f[R] or \\f[V]-p\\f[R]\n+.B \\f[CB]\\-private\\f[R] or \\f[CB]\\-p\\f[R]\n@@ -117,0 +119,2 @@\n+.RS\n+.RE\n@@ -118,1 +122,1 @@\n-\\f[V]-c\\f[R]\n+.B \\f[CB]\\-c\\f[R]\n@@ -121,0 +125,2 @@\n+.RS\n+.RE\n@@ -122,1 +128,1 @@\n-\\f[V]-s\\f[R]\n+.B \\f[CB]\\-s\\f[R]\n@@ -124,0 +130,2 @@\n+.RS\n+.RE\n@@ -125,2 +133,2 @@\n-\\f[V]-sysinfo\\f[R]\n-Shows system information (path, size, date, SHA-256 hash) of the class\n+.B \\f[CB]\\-sysinfo\\f[R]\n+Shows system information (path, size, date, SHA\\-256 hash) of the class\n@@ -128,0 +136,2 @@\n+.RS\n+.RE\n@@ -129,2 +139,4 @@\n-\\f[V]-constants\\f[R]\n-Shows \\f[V]static final\\f[R] constants.\n+.B \\f[CB]\\-constants\\f[R]\n+Shows \\f[CB]static\\ final\\f[R] constants.\n+.RS\n+.RE\n@@ -132,1 +144,1 @@\n-\\f[V]--module\\f[R] \\f[I]module\\f[R] or \\f[V]-m\\f[R] \\f[I]module\\f[R]\n+.B \\f[CB]\\-\\-module\\f[R] \\f[I]module\\f[R] or \\f[CB]\\-m\\f[R] \\f[I]module\\f[R]\n@@ -134,0 +146,2 @@\n+.RS\n+.RE\n@@ -135,1 +149,1 @@\n-\\f[V]--module-path\\f[R] \\f[I]path\\f[R]\n+.B \\f[CB]\\-\\-module\\-path\\f[R] \\f[I]path\\f[R]\n@@ -137,0 +151,2 @@\n+.RS\n+.RE\n@@ -138,1 +154,1 @@\n-\\f[V]--system\\f[R] \\f[I]jdk\\f[R]\n+.B \\f[CB]\\-\\-system\\f[R] \\f[I]jdk\\f[R]\n@@ -140,0 +156,2 @@\n+.RS\n+.RE\n@@ -141,2 +159,2 @@\n-\\f[V]--class-path\\f[R] \\f[I]path\\f[R], \\f[V]-classpath\\f[R] \\f[I]path\\f[R], or \\f[V]-cp\\f[R] \\f[I]path\\f[R]\n-Specifies the path that the \\f[V]javap\\f[R] command uses to find user\n+.B \\f[CB]\\-\\-class\\-path\\f[R] \\f[I]path\\f[R], \\f[CB]\\-classpath\\f[R] \\f[I]path\\f[R], or \\f[CB]\\-cp\\f[R] \\f[I]path\\f[R]\n+Specifies the path that the \\f[CB]javap\\f[R] command uses to find user\n@@ -144,1 +162,1 @@\n-It overrides the default or the \\f[V]CLASSPATH\\f[R] environment variable\n+It overrides the default or the \\f[CB]CLASSPATH\\f[R] environment variable\n@@ -146,0 +164,2 @@\n+.RS\n+.RE\n@@ -147,1 +167,1 @@\n-\\f[V]-bootclasspath\\f[R] \\f[I]path\\f[R]\n+.B \\f[CB]\\-bootclasspath\\f[R] \\f[I]path\\f[R]\n@@ -149,0 +169,2 @@\n+.RS\n+.RE\n@@ -150,2 +172,4 @@\n-\\f[V]--multi-release\\f[R] \\f[I]version\\f[R]\n-Specifies the version to select in multi-release JAR files.\n+.B \\f[CB]\\-\\-multi\\-release\\f[R] \\f[I]version\\f[R]\n+Specifies the version to select in multi\\-release JAR files.\n+.RS\n+.RE\n@@ -153,1 +177,1 @@\n-\\f[V]-J\\f[R]\\f[I]option\\f[R]\n+.B \\f[CB]\\-J\\f[R]\\f[I]option\\f[R]\n@@ -160,1 +184,1 @@\n-javap -J-version\n+javap\\ \\-J\\-version\n@@ -162,1 +186,1 @@\n-javap -J-Djava.security.manager -J-Djava.security.policy=MyPolicy MyClassName\n+javap\\ \\-J\\-Djava.security.manager\\ \\-J\\-Djava.security.policy=MyPolicy\\ MyClassName\n@@ -170,1 +194,1 @@\n-Compile the following \\f[V]HelloWorldFrame\\f[R] class:\n+Compile the following \\f[CB]HelloWorldFrame\\f[R] class:\n@@ -174,1 +198,1 @@\n-import java.awt.Graphics;\n+import\\ java.awt.Graphics;\n@@ -176,2 +200,2 @@\n-import javax.swing.JFrame;\n-import javax.swing.JPanel;\n+import\\ javax.swing.JFrame;\n+import\\ javax.swing.JPanel;\n@@ -179,1 +203,1 @@\n-public class HelloWorldFrame extends JFrame {\n+public\\ class\\ HelloWorldFrame\\ extends\\ JFrame\\ {\n@@ -181,1 +205,1 @@\n-   String message = \\[dq]Hello World!\\[dq];\n+\\ \\ \\ String\\ message\\ =\\ \"Hello\\ World!\";\n@@ -183,12 +207,12 @@\n-   public HelloWorldFrame(){\n-        setContentPane(new JPanel(){\n-            \\[at]Override\n-            protected void paintComponent(Graphics g) {\n-                g.drawString(message, 15, 30);\n-            }\n-        });\n-        setSize(100, 100);\n-    }\n-    public static void main(String[] args) {\n-        HelloWorldFrame frame = new HelloWorldFrame();\n-        frame.setVisible(true);\n+\\ \\ \\ public\\ HelloWorldFrame(){\n+\\ \\ \\ \\ \\ \\ \\ \\ setContentPane(new\\ JPanel(){\n+\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\@Override\n+\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ protected\\ void\\ paintComponent(Graphics\\ g)\\ {\n+\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ g.drawString(message,\\ 15,\\ 30);\n+\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ }\n+\\ \\ \\ \\ \\ \\ \\ \\ });\n+\\ \\ \\ \\ \\ \\ \\ \\ setSize(100,\\ 100);\n+\\ \\ \\ \\ }\n+\\ \\ \\ \\ public\\ static\\ void\\ main(String[]\\ args)\\ {\n+\\ \\ \\ \\ \\ \\ \\ \\ HelloWorldFrame\\ frame\\ =\\ new\\ HelloWorldFrame();\n+\\ \\ \\ \\ \\ \\ \\ \\ frame.setVisible(true);\n@@ -196,1 +220,1 @@\n-    }\n+\\ \\ \\ \\ }\n@@ -202,1 +226,1 @@\n-The output from the \\f[V]javap HelloWorldFrame.class\\f[R] command yields\n+The output from the \\f[CB]javap\\ HelloWorldFrame.class\\f[R] command yields\n@@ -207,5 +231,5 @@\n-Compiled from \\[dq]HelloWorldFrame.java\\[dq]\n-public class HelloWorldFrame extends javax.swing.JFrame {\n-  java.lang.String message;\n-  public HelloWorldFrame();\n-  public static void main(java.lang.String[]);\n+Compiled\\ from\\ \"HelloWorldFrame.java\"\n+public\\ class\\ HelloWorldFrame\\ extends\\ javax.swing.JFrame\\ {\n+\\ \\ java.lang.String\\ message;\n+\\ \\ public\\ HelloWorldFrame();\n+\\ \\ public\\ static\\ void\\ main(java.lang.String[]);\n@@ -216,1 +240,1 @@\n-The output from the \\f[V]javap -c HelloWorldFrame.class\\f[R] command\n+The output from the \\f[CB]javap\\ \\-c\\ HelloWorldFrame.class\\f[R] command\n@@ -221,3 +245,3 @@\n-Compiled from \\[dq]HelloWorldFrame.java\\[dq]\n-public class HelloWorldFrame extends javax.swing.JFrame {\n-  java.lang.String message;\n+Compiled\\ from\\ \"HelloWorldFrame.java\"\n+public\\ class\\ HelloWorldFrame\\ extends\\ javax.swing.JFrame\\ {\n+\\ \\ java.lang.String\\ message;\n@@ -225,18 +249,18 @@\n-  public HelloWorldFrame();\n-    Code:\n-       0: aload_0\n-       1: invokespecial #1        \/\/ Method javax\/swing\/JFrame.\\[dq]<init>\\[dq]:()V\n-       4: aload_0\n-       5: ldc           #2        \/\/ String Hello World!\n-       7: putfield      #3        \/\/ Field message:Ljava\/lang\/String;\n-      10: aload_0\n-      11: new           #4        \/\/ class HelloWorldFrame$1\n-      14: dup\n-      15: aload_0\n-      16: invokespecial #5        \/\/ Method HelloWorldFrame$1.\\[dq]<init>\\[dq]:(LHelloWorldFrame;)V\n-      19: invokevirtual #6        \/\/ Method setContentPane:(Ljava\/awt\/Container;)V\n-      22: aload_0\n-      23: bipush        100\n-      25: bipush        100\n-      27: invokevirtual #7        \/\/ Method setSize:(II)V\n-      30: return\n+\\ \\ public\\ HelloWorldFrame();\n+\\ \\ \\ \\ Code:\n+\\ \\ \\ \\ \\ \\ \\ 0:\\ aload_0\n+\\ \\ \\ \\ \\ \\ \\ 1:\\ invokespecial\\ #1\\ \\ \\ \\ \\ \\ \\ \\ \/\/\\ Method\\ javax\/swing\/JFrame.\"<init>\":()V\n+\\ \\ \\ \\ \\ \\ \\ 4:\\ aload_0\n+\\ \\ \\ \\ \\ \\ \\ 5:\\ ldc\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ #2\\ \\ \\ \\ \\ \\ \\ \\ \/\/\\ String\\ Hello\\ World!\n+\\ \\ \\ \\ \\ \\ \\ 7:\\ putfield\\ \\ \\ \\ \\ \\ #3\\ \\ \\ \\ \\ \\ \\ \\ \/\/\\ Field\\ message:Ljava\/lang\/String;\n+\\ \\ \\ \\ \\ \\ 10:\\ aload_0\n+\\ \\ \\ \\ \\ \\ 11:\\ new\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ #4\\ \\ \\ \\ \\ \\ \\ \\ \/\/\\ class\\ HelloWorldFrame$1\n+\\ \\ \\ \\ \\ \\ 14:\\ dup\n+\\ \\ \\ \\ \\ \\ 15:\\ aload_0\n+\\ \\ \\ \\ \\ \\ 16:\\ invokespecial\\ #5\\ \\ \\ \\ \\ \\ \\ \\ \/\/\\ Method\\ HelloWorldFrame$1.\"<init>\":(LHelloWorldFrame;)V\n+\\ \\ \\ \\ \\ \\ 19:\\ invokevirtual\\ #6\\ \\ \\ \\ \\ \\ \\ \\ \/\/\\ Method\\ setContentPane:(Ljava\/awt\/Container;)V\n+\\ \\ \\ \\ \\ \\ 22:\\ aload_0\n+\\ \\ \\ \\ \\ \\ 23:\\ bipush\\ \\ \\ \\ \\ \\ \\ \\ 100\n+\\ \\ \\ \\ \\ \\ 25:\\ bipush\\ \\ \\ \\ \\ \\ \\ \\ 100\n+\\ \\ \\ \\ \\ \\ 27:\\ invokevirtual\\ #7\\ \\ \\ \\ \\ \\ \\ \\ \/\/\\ Method\\ setSize:(II)V\n+\\ \\ \\ \\ \\ \\ 30:\\ return\n@@ -244,10 +268,10 @@\n-  public static void main(java.lang.String[]);\n-    Code:\n-       0: new           #8        \/\/ class HelloWorldFrame\n-       3: dup\n-       4: invokespecial #9        \/\/ Method \\[dq]<init>\\[dq]:()V\n-       7: astore_1\n-       8: aload_1\n-       9: iconst_1\n-      10: invokevirtual #10       \/\/ Method setVisible:(Z)V\n-      13: return\n+\\ \\ public\\ static\\ void\\ main(java.lang.String[]);\n+\\ \\ \\ \\ Code:\n+\\ \\ \\ \\ \\ \\ \\ 0:\\ new\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ #8\\ \\ \\ \\ \\ \\ \\ \\ \/\/\\ class\\ HelloWorldFrame\n+\\ \\ \\ \\ \\ \\ \\ 3:\\ dup\n+\\ \\ \\ \\ \\ \\ \\ 4:\\ invokespecial\\ #9\\ \\ \\ \\ \\ \\ \\ \\ \/\/\\ Method\\ \"<init>\":()V\n+\\ \\ \\ \\ \\ \\ \\ 7:\\ astore_1\n+\\ \\ \\ \\ \\ \\ \\ 8:\\ aload_1\n+\\ \\ \\ \\ \\ \\ \\ 9:\\ iconst_1\n+\\ \\ \\ \\ \\ \\ 10:\\ invokevirtual\\ #10\\ \\ \\ \\ \\ \\ \\ \/\/\\ Method\\ setVisible:(Z)V\n+\\ \\ \\ \\ \\ \\ 13:\\ return\n","filename":"src\/jdk.jdeps\/share\/man\/javap.1","additions":138,"deletions":114,"binary":false,"changes":252,"status":"modified"},{"patch":"@@ -22,1 +22,1 @@\n-.\\\" Automatically generated by Pandoc 2.19.2\n+.\\\" Automatically generated by Pandoc 2.3.1\n@@ -24,15 +24,1 @@\n-.\\\" Define V font for inline verbatim, using C font in formats\n-.\\\" that render this, and otherwise B font.\n-.ie \"\\f[CB]x\\f[R]\"x\" \\{\\\n-. ftr V B\n-. ftr VI BI\n-. ftr VB B\n-. ftr VBI BI\n-.\\}\n-.el \\{\\\n-. ftr V CR\n-. ftr VI CI\n-. ftr VB CB\n-. ftr VBI CBI\n-.\\}\n-.TH \"JDEPRSCAN\" \"1\" \"2023\" \"JDK 20-ea\" \"JDK Commands\"\n+.TH \"JDEPRSCAN\" \"1\" \"2023\" \"JDK 20\\-ea\" \"JDK Commands\"\n@@ -42,1 +28,1 @@\n-jdeprscan - static analysis tool that scans a jar file (or some other\n+jdeprscan \\- static analysis tool that scans a jar file (or some other\n@@ -46,1 +32,1 @@\n-\\f[V]jdeprscan\\f[R] [\\f[I]options\\f[R]]\n+\\f[CB]jdeprscan\\f[R] [\\f[I]options\\f[R]]\n@@ -49,1 +35,1 @@\n-\\f[I]options\\f[R]\n+.B \\f[I]options\\f[R]\n@@ -51,0 +37,2 @@\n+.RS\n+.RE\n@@ -52,2 +40,2 @@\n-\\f[I]dir\\f[R]|\\f[I]jar\\f[R]|\\f[I]class\\f[R]\n-\\f[V]jdeprscan\\f[R] command scans each argument for usages of deprecated\n+.B \\f[I]dir\\f[R]|\\f[I]jar\\f[R]|\\f[I]class\\f[R]\n+\\f[CB]jdeprscan\\f[R] command scans each argument for usages of deprecated\n@@ -64,1 +52,1 @@\n-The class name should use a dot (\\f[V].\\f[R]) as a separator.\n+The class name should use a dot (\\f[CB]\\&.\\f[R]) as a separator.\n@@ -67,1 +55,1 @@\n-\\f[V]java.lang.Thread\\f[R]\n+\\f[CB]java.lang.Thread\\f[R]\n@@ -69,1 +57,1 @@\n-For nested classes, the dollar sign \\f[V]$\\f[R] separator character\n+For nested classes, the dollar sign \\f[CB]$\\f[R] separator character\n@@ -73,1 +61,1 @@\n-\\f[V]java.lang.Thread$State\\f[R]\n+\\f[CB]java.lang.Thread$State\\f[R]\n@@ -78,1 +66,1 @@\n-\\f[V]build\/classes\/java\/lang\/Thread$State.class\\f[R]\n+\\f[CB]build\/classes\/java\/lang\/Thread$State.class\\f[R]\n@@ -82,1 +70,1 @@\n-The \\f[V]jdeprscan\\f[R] tool is a static analysis tool provided by the\n+The \\f[CB]jdeprscan\\f[R] tool is a static analysis tool provided by the\n@@ -85,1 +73,1 @@\n-The deprecated APIs identified by the \\f[V]jdeprscan\\f[R] tool are only\n+The deprecated APIs identified by the \\f[CB]jdeprscan\\f[R] tool are only\n@@ -87,1 +75,1 @@\n-Deprecated APIs defined by third-party libraries aren\\[aq]t reported.\n+Deprecated APIs defined by third\\-party libraries aren\\[aq]t reported.\n@@ -92,2 +80,2 @@\n-Set the class path using the \\f[V]--class-path\\f[R] option described in\n-\\f[B]Options for the jdeprscan Command\\f[R].\n+Set the class path using the \\f[CB]\\-\\-class\\-path\\f[R] option described\n+in \\f[B]Options for the jdeprscan Command\\f[R].\n@@ -97,1 +85,1 @@\n-If the \\f[V]jdeprscan\\f[R] can\\[aq]t find all the dependent classes, it\n+If the \\f[CB]jdeprscan\\f[R] can\\[aq]t find all the dependent classes, it\n@@ -102,1 +90,1 @@\n-\\f[V]error: cannot find class ...\\f[R]\n+\\f[CB]error:\\ cannot\\ find\\ class\\ ...\\f[R]\n@@ -111,1 +99,1 @@\n-\\f[V]--class-path\\f[R] \\f[I]path\\f[R]\n+.B \\f[CB]\\-\\-class\\-path\\f[R] \\f[I]path\\f[R]\n@@ -116,1 +104,1 @@\n-directories separated by the system-specific path separator.\n+directories separated by the system\\-specific path separator.\n@@ -123,1 +111,1 @@\n-\\f[V]--class-path \/some\/directory:\/another\/different\/dir\\f[R]\n+\\f[CB]\\-\\-class\\-path\\ \/some\/directory:\/another\/different\/dir\\f[R]\n@@ -129,2 +117,2 @@\n-On Windows, use a semicolon (\\f[V];\\f[R]) as the separator instead of a\n-colon (\\f[V]:\\f[R]).\n+On Windows, use a semicolon (\\f[CB];\\f[R]) as the separator instead of a\n+colon (\\f[CB]:\\f[R]).\n@@ -136,1 +124,1 @@\n-\\f[V]--class-path \\[rs]some\\[rs]directory;\\[rs]another\\[rs]different\\[rs]dir\\f[R]\n+\\f[CB]\\-\\-class\\-path\\ \\\\some\\\\directory;\\\\another\\\\different\\\\dir\\f[R]\n@@ -141,1 +129,1 @@\n-\\f[V]--for-removal\\f[R]\n+.B \\f[CB]\\-\\-for\\-removal\\f[R]\n@@ -144,0 +132,2 @@\n+.RS\n+.RE\n@@ -145,1 +135,1 @@\n-\\f[V]--full-version\\f[R]\n+.B \\f[CB]\\-\\-full\\-version\\f[R]\n@@ -147,0 +137,2 @@\n+.RS\n+.RE\n@@ -148,1 +140,1 @@\n-\\f[V]--help\\f[R] or \\f[V]-h\\f[R]\n+.B \\f[CB]\\-\\-help\\f[R] or \\f[CB]\\-h\\f[R]\n@@ -150,0 +142,2 @@\n+.RS\n+.RE\n@@ -151,1 +145,1 @@\n-\\f[V]--list\\f[R] or \\f[V]-l\\f[R]\n+.B \\f[CB]\\-\\-list\\f[R] or \\f[CB]\\-l\\f[R]\n@@ -155,0 +149,2 @@\n+.RS\n+.RE\n@@ -156,1 +152,1 @@\n-\\f[V]--release\\f[R] \\f[V]6\\f[R]|\\f[V]7\\f[R]|\\f[V]8\\f[R]|\\f[V]9\\f[R]\n+.B \\f[CB]\\-\\-release\\f[R] \\f[CB]6\\f[R]|\\f[CB]7\\f[R]|\\f[CB]8\\f[R]|\\f[CB]9\\f[R]\n@@ -159,0 +155,2 @@\n+.RS\n+.RE\n@@ -160,1 +158,1 @@\n-\\f[V]--verbose\\f[R] or \\f[V]-v\\f[R]\n+.B \\f[CB]\\-\\-verbose\\f[R] or \\f[CB]\\-v\\f[R]\n@@ -162,0 +160,2 @@\n+.RS\n+.RE\n@@ -163,1 +163,1 @@\n-\\f[V]--version\\f[R]\n+.B \\f[CB]\\-\\-version\\f[R]\n@@ -165,0 +165,2 @@\n+.RS\n+.RE\n@@ -168,1 +170,1 @@\n-\\f[V]commons-math3-3.6.1.jar\\f[R].\n+\\f[CB]commons\\-math3\\-3.6.1.jar\\f[R].\n@@ -173,1 +175,1 @@\n-\\f[V]jdeprscan commons-math3-3.6.1.jar\\f[R]\n+\\f[CB]jdeprscan\\ commons\\-math3\\-3.6.1.jar\\f[R]\n@@ -181,1 +183,1 @@\n-class org\/apache\/commons\/math3\/util\/MathUtils uses deprecated method java\/lang\/Double::<init>(D)V\n+class\\ org\/apache\/commons\/math3\/util\/MathUtils\\ uses\\ deprecated\\ method\\ java\/lang\/Double::<init>(D)V\n@@ -187,1 +189,1 @@\n-The class name is specified using the slash-separated binary name as\n+The class name is specified using the slash\\-separated binary name as\n@@ -191,1 +193,1 @@\n-The deprecated API it uses is a method on the \\f[V]java.lang.Double\\f[R]\n+The deprecated API it uses is a method on the \\f[CB]java.lang.Double\\f[R]\n@@ -194,3 +196,3 @@\n-The name of the deprecated method is \\f[V]<init>\\f[R], which is a\n-special name that means that the method is actually a constructor.\n-Another special name is \\f[V]<clinit>\\f[R], which indicates a class\n+The name of the deprecated method is \\f[CB]<init>\\f[R], which is a special\n+name that means that the method is actually a constructor.\n+Another special name is \\f[CB]<clinit>\\f[R], which indicates a class\n@@ -203,1 +205,1 @@\n-\\f[V](D)V\\f[R]\n+\\f[CB](D)V\\f[R]\n@@ -213,1 +215,1 @@\n-class org\/apache\/commons\/math3\/util\/Precision uses deprecated method java\/math\/BigDecimal::setScale(II)Ljava\/math\/BigDecimal;\n+class\\ org\/apache\/commons\/math3\/util\/Precision\\ uses\\ deprecated\\ method\\ java\/math\/BigDecimal::setScale(II)Ljava\/math\/BigDecimal;\n@@ -218,2 +220,2 @@\n-\\f[V]java.math.BigDecimal\\f[R], and the method is \\f[V]setScale()\\f[R].\n-In this case, the \\f[V](II)\\f[R] means that it takes two \\f[V]int\\f[R]\n+\\f[CB]java.math.BigDecimal\\f[R], and the method is \\f[CB]setScale()\\f[R].\n+In this case, the \\f[CB](II)\\f[R] means that it takes two \\f[CB]int\\f[R]\n@@ -221,3 +223,3 @@\n-The \\f[V]Ljava\/math\/BigDecimal;\\f[R] after the parentheses means that it\n-returns a reference to \\f[V]java.math.BigDecimal\\f[R].\n-.SH JDEPRSCAN ANALYSIS CAN BE VERSION-SPECIFIC\n+The \\f[CB]Ljava\/math\/BigDecimal;\\f[R] after the parentheses means that it\n+returns a reference to \\f[CB]java.math.BigDecimal\\f[R].\n+.SH JDEPRSCAN ANALYSIS CAN BE VERSION\\-SPECIFIC\n@@ -225,1 +227,1 @@\n-You can use \\f[V]jdeprscan\\f[R] relative to the previous three JDK\n+You can use \\f[CB]jdeprscan\\f[R] relative to the previous three JDK\n@@ -234,3 +236,3 @@\n-public class Deprecations {\n-   SecurityManager sm = new RMISecurityManager();    \/\/ deprecated in 8\n-   Boolean b2 = new Boolean(true);          \/\/ deprecated in 9\n+public\\ class\\ Deprecations\\ {\n+\\ \\ \\ SecurityManager\\ sm\\ =\\ new\\ RMISecurityManager();\\ \\ \\ \\ \/\/\\ deprecated\\ in\\ 8\n+\\ \\ \\ Boolean\\ b2\\ =\\ new\\ Boolean(true);\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \/\/\\ deprecated\\ in\\ 9\n@@ -243,1 +245,1 @@\n-If you run \\f[V]jdeprscan\\f[R] on a system with JDK 9, then you see:\n+If you run \\f[CB]jdeprscan\\f[R] on a system with JDK 9, then you see:\n@@ -247,2 +249,2 @@\n-$ jdeprscan --class-path classes --release 7 example.Deprecations\n-(no output)\n+$\\ jdeprscan\\ \\-\\-class\\-path\\ classes\\ \\-\\-release\\ 7\\ example.Deprecations\n+(no\\ output)\n@@ -252,1 +254,1 @@\n-Run \\f[V]jdeprscan\\f[R] with a release value of 8:\n+Run \\f[CB]jdeprscan\\f[R] with a release value of 8:\n@@ -256,3 +258,3 @@\n-$ jdeprscan --class-path classes --release 8 example.Deprecations\n-class example\/Deprecations uses type java\/rmi\/RMISecurityManager deprecated\n-class example\/Deprecations uses method in type java\/rmi\/RMISecurityManager deprecated\n+$\\ jdeprscan\\ \\-\\-class\\-path\\ classes\\ \\-\\-release\\ 8\\ example.Deprecations\n+class\\ example\/Deprecations\\ uses\\ type\\ java\/rmi\/RMISecurityManager\\ deprecated\n+class\\ example\/Deprecations\\ uses\\ method\\ in\\ type\\ java\/rmi\/RMISecurityManager\\ deprecated\n@@ -262,1 +264,1 @@\n-Run \\f[V]jdeprscan\\f[R] on JDK 9:\n+Run \\f[CB]jdeprscan\\f[R] on JDK 9:\n@@ -266,4 +268,4 @@\n-$ jdeprscan --class-path classes example.Deprecations\n-class example\/Deprecations uses type java\/rmi\/RMISecurityManager deprecated\n-class example\/Deprecations uses method in type java\/rmi\/RMISecurityManager deprecated\n-class example\/Deprecations uses method java\/lang\/Boolean <init> (Z)V deprecated\n+$\\ jdeprscan\\ \\-\\-class\\-path\\ classes\\ example.Deprecations\n+class\\ example\/Deprecations\\ uses\\ type\\ java\/rmi\/RMISecurityManager\\ deprecated\n+class\\ example\/Deprecations\\ uses\\ method\\ in\\ type\\ java\/rmi\/RMISecurityManager\\ deprecated\n+class\\ example\/Deprecations\\ uses\\ method\\ java\/lang\/Boolean\\ <init>\\ (Z)V\\ deprecated\n","filename":"src\/jdk.jdeps\/share\/man\/jdeprscan.1","additions":79,"deletions":77,"binary":false,"changes":156,"status":"modified"},{"patch":"@@ -22,1 +22,1 @@\n-.\\\" Automatically generated by Pandoc 2.19.2\n+.\\\" Automatically generated by Pandoc 2.3.1\n@@ -24,15 +24,1 @@\n-.\\\" Define V font for inline verbatim, using C font in formats\n-.\\\" that render this, and otherwise B font.\n-.ie \"\\f[CB]x\\f[R]\"x\" \\{\\\n-. ftr V B\n-. ftr VI BI\n-. ftr VB B\n-. ftr VBI BI\n-.\\}\n-.el \\{\\\n-. ftr V CR\n-. ftr VI CI\n-. ftr VB CB\n-. ftr VBI CBI\n-.\\}\n-.TH \"JDEPS\" \"1\" \"2023\" \"JDK 20-ea\" \"JDK Commands\"\n+.TH \"JDEPS\" \"1\" \"2023\" \"JDK 20\\-ea\" \"JDK Commands\"\n@@ -42,1 +28,1 @@\n-jdeps - launch the Java class dependency analyzer\n+jdeps \\- launch the Java class dependency analyzer\n@@ -45,1 +31,1 @@\n-\\f[V]jdeps\\f[R] [\\f[I]options\\f[R]] \\f[I]path\\f[R] ...\n+\\f[CB]jdeps\\f[R] [\\f[I]options\\f[R]] \\f[I]path\\f[R] ...\n@@ -47,2 +33,2 @@\n-\\f[I]options\\f[R]\n-Command-line options.\n+.B \\f[I]options\\f[R]\n+Command\\-line options.\n@@ -61,2 +47,2 @@\n-\\f[I]path\\f[R]\n-A pathname to the \\f[V].class\\f[R] file, directory, or JAR file to\n+.B \\f[I]path\\f[R]\n+A pathname to the \\f[CB]\\&.class\\f[R] file, directory, or JAR file to\n@@ -64,0 +50,2 @@\n+.RS\n+.RE\n@@ -66,1 +54,1 @@\n-The \\f[V]jdeps\\f[R] command shows the package-level or class-level\n+The \\f[CB]jdeps\\f[R] command shows the package\\-level or class\\-level\n@@ -68,1 +56,1 @@\n-The input class can be a path name to a \\f[V].class\\f[R] file, a\n+The input class can be a path name to a \\f[CB]\\&.class\\f[R] file, a\n@@ -72,1 +60,1 @@\n-By default, the \\f[V]jdeps\\f[R] command writes the dependencies to the\n+By default, the \\f[CB]jdeps\\f[R] command writes the dependencies to the\n@@ -75,1 +63,1 @@\n-\\f[V]-dotoutput\\f[R] option).\n+\\f[CB]\\-dotoutput\\f[R] option).\n@@ -78,1 +66,1 @@\n-\\f[V]-?\\f[R] or \\f[V]-h\\f[R] or \\f[V]--help\\f[R]\n+.B \\f[CB]\\-?\\f[R] or \\f[CB]\\-h\\f[R] or \\f[CB]\\-\\-help\\f[R]\n@@ -80,0 +68,2 @@\n+.RS\n+.RE\n@@ -81,1 +71,1 @@\n-\\f[V]-dotoutput\\f[R] \\f[I]dir\\f[R] or \\f[V]--dot-output\\f[R] \\f[I]dir\\f[R]\n+.B \\f[CB]\\-dotoutput\\f[R] \\f[I]dir\\f[R] or \\f[CB]\\-\\-dot\\-output\\f[R] \\f[I]dir\\f[R]\n@@ -83,4 +73,4 @@\n-If this option is specified, then the \\f[V]jdeps\\f[R]command generates\n-one \\f[V].dot\\f[R] file for each analyzed archive named\n-\\f[V]archive-file-name.dot\\f[R] that lists the dependencies, and also a\n-summary file named \\f[V]summary.dot\\f[R] that lists the dependencies\n+If this option is specified, then the \\f[CB]jdeps\\f[R]command generates\n+one \\f[CB]\\&.dot\\f[R] file for each analyzed archive named\n+\\f[CB]archive\\-file\\-name.dot\\f[R] that lists the dependencies, and also a\n+summary file named \\f[CB]summary.dot\\f[R] that lists the dependencies\n@@ -88,0 +78,2 @@\n+.RS\n+.RE\n@@ -89,1 +81,1 @@\n-\\f[V]-s\\f[R] or \\f[V]-summary\\f[R]\n+.B \\f[CB]\\-s\\f[R] or \\f[CB]\\-summary\\f[R]\n@@ -91,0 +83,2 @@\n+.RS\n+.RE\n@@ -92,2 +86,2 @@\n-\\f[V]-v\\f[R] or \\f[V]-verbose\\f[R]\n-Prints all class-level dependencies.\n+.B \\f[CB]\\-v\\f[R] or \\f[CB]\\-verbose\\f[R]\n+Prints all class\\-level dependencies.\n@@ -98,1 +92,1 @@\n-\\f[V]-verbose:class -filter:none\\f[R]\n+\\f[CB]\\-verbose:class\\ \\-filter:none\\f[R]\n@@ -102,2 +96,2 @@\n-\\f[V]-verbose:package\\f[R]\n-Prints package-level dependencies excluding, by default, dependences\n+.B \\f[CB]\\-verbose:package\\f[R]\n+Prints package\\-level dependencies excluding, by default, dependences\n@@ -105,0 +99,2 @@\n+.RS\n+.RE\n@@ -106,2 +102,2 @@\n-\\f[V]-verbose:class\\f[R]\n-Prints class-level dependencies excluding, by default, dependencies\n+.B \\f[CB]\\-verbose:class\\f[R]\n+Prints class\\-level dependencies excluding, by default, dependencies\n@@ -109,0 +105,2 @@\n+.RS\n+.RE\n@@ -110,1 +108,1 @@\n-\\f[V]-apionly\\f[R] or \\f[V]--api-only\\f[R]\n+.B \\f[CB]\\-apionly\\f[R] or \\f[CB]\\-\\-api\\-only\\f[R]\n@@ -112,1 +110,1 @@\n-signature of \\f[V]public\\f[R] and \\f[V]protected\\f[R] members of public\n+signature of \\f[CB]public\\f[R] and \\f[CB]protected\\f[R] members of public\n@@ -115,0 +113,2 @@\n+.RS\n+.RE\n@@ -116,2 +116,2 @@\n-\\f[V]-jdkinternals\\f[R] or \\f[V]--jdk-internals\\f[R]\n-Finds class-level dependences in the JDK internal APIs.\n+.B \\f[CB]\\-jdkinternals\\f[R] or \\f[CB]\\-\\-jdk\\-internals\\f[R]\n+Finds class\\-level dependences in the JDK internal APIs.\n@@ -119,4 +119,4 @@\n-\\f[V]--classpath\\f[R] option and input files unless you specified the\n-\\f[V]-include\\f[R] option.\n-You can\\[aq]t use this option with the \\f[V]-p\\f[R], \\f[V]-e\\f[R], and\n-\\f[V]-s\\f[R] options.\n+\\f[CB]\\-\\-classpath\\f[R] option and input files unless you specified the\n+\\f[CB]\\-include\\f[R] option.\n+You can\\[aq]t use this option with the \\f[CB]\\-p\\f[R], \\f[CB]\\-e\\f[R], and\n+\\f[CB]\\-s\\f[R] options.\n@@ -128,1 +128,1 @@\n-\\f[V]-cp\\f[R] \\f[I]path\\f[R], \\f[V]-classpath\\f[R] \\f[I]path\\f[R], or \\f[V]--class-path\\f[R] \\f[I]path\\f[R]\n+.B \\f[CB]\\-cp\\f[R] \\f[I]path\\f[R], \\f[CB]\\-classpath\\f[R] \\f[I]path\\f[R], or \\f[CB]\\-\\-class\\-path\\f[R] \\f[I]path\\f[R]\n@@ -130,0 +130,2 @@\n+.RS\n+.RE\n@@ -131,1 +133,1 @@\n-\\f[V]--module-path\\f[R] \\f[I]module-path\\f[R]\n+.B \\f[CB]\\-\\-module\\-path\\f[R] \\f[I]module\\-path\\f[R]\n@@ -133,0 +135,2 @@\n+.RS\n+.RE\n@@ -134,1 +138,1 @@\n-\\f[V]--upgrade-module-path\\f[R] \\f[I]module-path\\f[R]\n+.B \\f[CB]\\-\\-upgrade\\-module\\-path\\f[R] \\f[I]module\\-path\\f[R]\n@@ -136,0 +140,2 @@\n+.RS\n+.RE\n@@ -137,1 +143,1 @@\n-\\f[V]--system\\f[R] \\f[I]java-home\\f[R]\n+.B \\f[CB]\\-\\-system\\f[R] \\f[I]java\\-home\\f[R]\n@@ -139,0 +145,2 @@\n+.RS\n+.RE\n@@ -140,1 +148,1 @@\n-\\f[V]--add-modules\\f[R] \\f[I]module-name\\f[R][\\f[V],\\f[R] \\f[I]module-name\\f[R]...]\n+.B \\f[CB]\\-\\-add\\-modules\\f[R] \\f[I]module\\-name\\f[R][\\f[CB],\\f[R] \\f[I]module\\-name\\f[R]...]\n@@ -142,0 +150,2 @@\n+.RS\n+.RE\n@@ -143,2 +153,2 @@\n-\\f[V]--multi-release\\f[R] \\f[I]version\\f[R]\n-Specifies the version when processing multi-release JAR files.\n+.B \\f[CB]\\-\\-multi\\-release\\f[R] \\f[I]version\\f[R]\n+Specifies the version when processing multi\\-release JAR files.\n@@ -146,0 +156,2 @@\n+.RS\n+.RE\n@@ -147,1 +159,1 @@\n-\\f[V]-q\\f[R] or \\f[V]-quiet\\f[R]\n+.B \\f[CB]\\-q\\f[R] or \\f[CB]\\-quiet\\f[R]\n@@ -149,1 +161,3 @@\n-\\f[V]-generate-module-info\\f[R] output.\n+\\f[CB]\\-generate\\-module\\-info\\f[R] output.\n+.RS\n+.RE\n@@ -151,1 +165,1 @@\n-\\f[V]-version\\f[R] or \\f[V]--version\\f[R]\n+.B \\f[CB]\\-version\\f[R] or \\f[CB]\\-\\-version\\f[R]\n@@ -153,0 +167,2 @@\n+.RS\n+.RE\n@@ -155,1 +171,1 @@\n-\\f[V]-m\\f[R] \\f[I]module-name\\f[R] or \\f[V]--module\\f[R] \\f[I]module-name\\f[R]\n+.B \\f[CB]\\-m\\f[R] \\f[I]module\\-name\\f[R] or \\f[CB]\\-\\-module\\f[R] \\f[I]module\\-name\\f[R]\n@@ -157,0 +173,2 @@\n+.RS\n+.RE\n@@ -158,2 +176,2 @@\n-\\f[V]--generate-module-info\\f[R] \\f[I]dir\\f[R]\n-Generates \\f[V]module-info.java\\f[R] under the specified directory.\n+.B \\f[CB]\\-\\-generate\\-module\\-info\\f[R] \\f[I]dir\\f[R]\n+Generates \\f[CB]module\\-info.java\\f[R] under the specified directory.\n@@ -161,3 +179,5 @@\n-This option cannot be used with \\f[V]--dot-output\\f[R] or\n-\\f[V]--class-path\\f[R] options.\n-Use the \\f[V]--generate-open-module\\f[R] option for open modules.\n+This option cannot be used with \\f[CB]\\-\\-dot\\-output\\f[R] or\n+\\f[CB]\\-\\-class\\-path\\f[R] options.\n+Use the \\f[CB]\\-\\-generate\\-open\\-module\\f[R] option for open modules.\n+.RS\n+.RE\n@@ -165,2 +185,2 @@\n-\\f[V]--generate-open-module\\f[R] \\f[I]dir\\f[R]\n-Generates \\f[V]module-info.java\\f[R] for the specified JAR files under\n+.B \\f[CB]\\-\\-generate\\-open\\-module\\f[R] \\f[I]dir\\f[R]\n+Generates \\f[CB]module\\-info.java\\f[R] for the specified JAR files under\n@@ -168,2 +188,4 @@\n-This option cannot be used with the \\f[V]--dot-output\\f[R] or\n-\\f[V]--class-path\\f[R] options.\n+This option cannot be used with the \\f[CB]\\-\\-dot\\-output\\f[R] or\n+\\f[CB]\\-\\-class\\-path\\f[R] options.\n+.RS\n+.RE\n@@ -171,1 +193,1 @@\n-\\f[V]--check\\f[R] \\f[I]module-name\\f[R] [\\f[V],\\f[R] \\f[I]module-name\\f[R]...]\n+.B \\f[CB]\\-\\-check\\f[R] \\f[I]module\\-name\\f[R] [\\f[CB],\\f[R] \\f[I]module\\-name\\f[R]...]\n@@ -176,0 +198,2 @@\n+.RS\n+.RE\n@@ -177,1 +201,1 @@\n-\\f[V]--list-deps\\f[R]\n+.B \\f[CB]\\-\\-list\\-deps\\f[R]\n@@ -182,1 +206,1 @@\n-Use \\f[V]--no-recursive\\f[R] option for non-transitive dependency\n+Use \\f[CB]\\-\\-no\\-recursive\\f[R] option for non\\-transitive dependency\n@@ -184,0 +208,2 @@\n+.RS\n+.RE\n@@ -185,2 +211,2 @@\n-\\f[V]--list-reduced-deps\\f[R]\n-Same as \\f[V]--list-deps\\f[R] without listing the implied reads edges\n+.B \\f[CB]\\-\\-list\\-reduced\\-deps\\f[R]\n+Same as \\f[CB]\\-\\-list\\-deps\\f[R] without listing the implied reads edges\n@@ -190,0 +216,2 @@\n+.RS\n+.RE\n@@ -191,4 +219,4 @@\n-\\f[V]--print-module-deps\\f[R]\n-Same as \\f[V]--list-reduced-deps\\f[R] with printing a comma-separated\n-list of module dependences.\n-The output can be used by \\f[V]jlink --add-modules\\f[R] to create a\n+.B \\f[CB]\\-\\-print\\-module\\-deps\\f[R]\n+Same as \\f[CB]\\-\\-list\\-reduced\\-deps\\f[R] with printing a\n+comma\\-separated list of module dependences.\n+The output can be used by \\f[CB]jlink\\ \\-\\-add\\-modules\\f[R] to create a\n@@ -197,0 +225,2 @@\n+.RS\n+.RE\n@@ -198,1 +228,1 @@\n-\\f[V]--ignore-missing-deps\\f[R]\n+.B \\f[CB]\\-\\-ignore\\-missing\\-deps\\f[R]\n@@ -200,0 +230,2 @@\n+.RS\n+.RE\n@@ -202,1 +234,1 @@\n-\\f[V]-p\\f[R] \\f[I]pkg_name\\f[R], \\f[V]-package\\f[R] \\f[I]pkg_name\\f[R], or \\f[V]--package\\f[R] \\f[I]pkg_name\\f[R]\n+.B \\f[CB]\\-p\\f[R] \\f[I]pkg_name\\f[R], \\f[CB]\\-package\\f[R] \\f[I]pkg_name\\f[R], or \\f[CB]\\-\\-package\\f[R] \\f[I]pkg_name\\f[R]\n@@ -205,1 +237,3 @@\n-The \\f[V]-p\\f[R] and \\f[V]-e\\f[R] options are mutually exclusive.\n+The \\f[CB]\\-p\\f[R] and \\f[CB]\\-e\\f[R] options are mutually exclusive.\n+.RS\n+.RE\n@@ -207,1 +241,1 @@\n-\\f[V]-e\\f[R] \\f[I]regex\\f[R], \\f[V]-regex\\f[R] \\f[I]regex\\f[R], or \\f[V]--regex\\f[R] \\f[I]regex\\f[R]\n+.B \\f[CB]\\-e\\f[R] \\f[I]regex\\f[R], \\f[CB]\\-regex\\f[R] \\f[I]regex\\f[R], or \\f[CB]\\-\\-regex\\f[R] \\f[I]regex\\f[R]\n@@ -209,1 +243,3 @@\n-The \\f[V]-p\\f[R] and \\f[V]-e\\f[R] options are mutually exclusive.\n+The \\f[CB]\\-p\\f[R] and \\f[CB]\\-e\\f[R] options are mutually exclusive.\n+.RS\n+.RE\n@@ -211,1 +247,1 @@\n-\\f[V]--require\\f[R] \\f[I]module-name\\f[R]\n+.B \\f[CB]\\-\\-require\\f[R] \\f[I]module\\-name\\f[R]\n@@ -214,1 +250,1 @@\n-The \\f[V]--package\\f[R], \\f[V]--regex\\f[R], and \\f[V]--require\\f[R]\n+The \\f[CB]\\-\\-package\\f[R], \\f[CB]\\-\\-regex\\f[R], and \\f[CB]\\-\\-require\\f[R]\n@@ -216,0 +252,2 @@\n+.RS\n+.RE\n@@ -217,1 +255,1 @@\n-\\f[V]-f\\f[R] \\f[I]regex\\f[R] or \\f[V]-filter\\f[R] \\f[I]regex\\f[R]\n+.B \\f[CB]\\-f\\f[R] \\f[I]regex\\f[R] or \\f[CB]\\-filter\\f[R] \\f[I]regex\\f[R]\n@@ -220,0 +258,2 @@\n+.RS\n+.RE\n@@ -221,1 +261,1 @@\n-\\f[V]-filter:package\\f[R]\n+.B \\f[CB]\\-filter:package\\f[R]\n@@ -224,0 +264,2 @@\n+.RS\n+.RE\n@@ -225,1 +267,1 @@\n-\\f[V]-filter:archive\\f[R]\n+.B \\f[CB]\\-filter:archive\\f[R]\n@@ -227,0 +269,2 @@\n+.RS\n+.RE\n@@ -228,1 +272,1 @@\n-\\f[V]-filter:module\\f[R]\n+.B \\f[CB]\\-filter:module\\f[R]\n@@ -230,0 +274,2 @@\n+.RS\n+.RE\n@@ -231,3 +277,5 @@\n-\\f[V]-filter:none\\f[R]\n-No \\f[V]-filter:package\\f[R] and \\f[V]-filter:archive\\f[R] filtering.\n-Filtering specified via the \\f[V]-filter\\f[R] option still applies.\n+.B \\f[CB]\\-filter:none\\f[R]\n+No \\f[CB]\\-filter:package\\f[R] and \\f[CB]\\-filter:archive\\f[R] filtering.\n+Filtering specified via the \\f[CB]\\-filter\\f[R] option still applies.\n+.RS\n+.RE\n@@ -235,1 +283,1 @@\n-\\f[V]--missing-deps\\f[R]\n+.B \\f[CB]\\-\\-missing\\-deps\\f[R]\n@@ -237,2 +285,4 @@\n-This option cannot be used with \\f[V]-p\\f[R], \\f[V]-e\\f[R] and\n-\\f[V]-s\\f[R] options.\n+This option cannot be used with \\f[CB]\\-p\\f[R], \\f[CB]\\-e\\f[R] and\n+\\f[CB]\\-s\\f[R] options.\n+.RS\n+.RE\n@@ -241,1 +291,1 @@\n-\\f[V]-include\\f[R] \\f[I]regex\\f[R]\n+.B \\f[CB]\\-include\\f[R] \\f[I]regex\\f[R]\n@@ -244,1 +294,1 @@\n-It can be used together with \\f[V]-p\\f[R] and \\f[V]-e\\f[R], which apply\n+It can be used together with \\f[CB]\\-p\\f[R] and \\f[CB]\\-e\\f[R], which apply\n@@ -246,0 +296,2 @@\n+.RS\n+.RE\n@@ -247,1 +299,1 @@\n-\\f[V]-P\\f[R] or \\f[V]-profile\\f[R]\n+.B \\f[CB]\\-P\\f[R] or \\f[CB]\\-profile\\f[R]\n@@ -249,0 +301,2 @@\n+.RS\n+.RE\n@@ -250,4 +304,4 @@\n-\\f[V]-R\\f[R] or \\f[V]--recursive\\f[R]\n-Recursively traverses all run-time dependences.\n-The \\f[V]-R\\f[R] option implies \\f[V]-filter:none\\f[R].\n-If \\f[V]-p\\f[R], \\f[V]-e\\f[R], or \\f[V]-f\\f[R] options are specified,\n+.B \\f[CB]\\-R\\f[R] or \\f[CB]\\-\\-recursive\\f[R]\n+Recursively traverses all run\\-time dependences.\n+The \\f[CB]\\-R\\f[R] option implies \\f[CB]\\-filter:none\\f[R].\n+If \\f[CB]\\-p\\f[R], \\f[CB]\\-e\\f[R], or \\f[CB]\\-f\\f[R] options are specified,\n@@ -255,0 +309,2 @@\n+.RS\n+.RE\n@@ -256,1 +312,1 @@\n-\\f[V]--no-recursive\\f[R]\n+.B \\f[CB]\\-\\-no\\-recursive\\f[R]\n@@ -258,0 +314,2 @@\n+.RS\n+.RE\n@@ -259,1 +317,1 @@\n-\\f[V]-I\\f[R] or \\f[V]--inverse\\f[R]\n+.B \\f[CB]\\-I\\f[R] or \\f[CB]\\-\\-inverse\\f[R]\n@@ -262,1 +320,1 @@\n-This is equivalent to the inverse of the compile-time view analysis and\n+This is equivalent to the inverse of the compile\\-time view analysis and\n@@ -264,2 +322,4 @@\n-This option must be used with the \\f[V]--require\\f[R],\n-\\f[V]--package\\f[R], or \\f[V]--regex\\f[R] options.\n+This option must be used with the \\f[CB]\\-\\-require\\f[R],\n+\\f[CB]\\-\\-package\\f[R], or \\f[CB]\\-\\-regex\\f[R] options.\n+.RS\n+.RE\n@@ -267,3 +327,3 @@\n-\\f[V]--compile-time\\f[R]\n-Analyzes the compile-time view of transitive dependencies, such as the\n-compile-time view of the \\f[V]-R\\f[R] option.\n+.B \\f[CB]\\-\\-compile\\-time\\f[R]\n+Analyzes the compile\\-time view of transitive dependencies, such as the\n+compile\\-time view of the \\f[CB]\\-R\\f[R] option.\n@@ -273,0 +333,2 @@\n+.RS\n+.RE\n@@ -276,1 +338,1 @@\n-\\f[V]Notepad.jar\\f[R] file.\n+\\f[CB]Notepad.jar\\f[R] file.\n@@ -282,19 +344,19 @@\n-$ jdeps demo\/jfc\/Notepad\/Notepad.jar\n-Notepad.jar -> java.base\n-Notepad.jar -> java.desktop\n-Notepad.jar -> java.logging\n-   <unnamed> (Notepad.jar)\n-      -> java.awt\n-      -> java.awt.event\n-      -> java.beans\n-      -> java.io\n-      -> java.lang\n-      -> java.net\n-      -> java.util\n-      -> java.util.logging\n-      -> javax.swing\n-      -> javax.swing.border\n-      -> javax.swing.event\n-      -> javax.swing.text\n-      -> javax.swing.tree\n-      -> javax.swing.undo\n+$\\ jdeps\\ demo\/jfc\/Notepad\/Notepad.jar\n+Notepad.jar\\ \\->\\ java.base\n+Notepad.jar\\ \\->\\ java.desktop\n+Notepad.jar\\ \\->\\ java.logging\n+\\ \\ \\ <unnamed>\\ (Notepad.jar)\n+\\ \\ \\ \\ \\ \\ \\->\\ java.awt\n+\\ \\ \\ \\ \\ \\ \\->\\ java.awt.event\n+\\ \\ \\ \\ \\ \\ \\->\\ java.beans\n+\\ \\ \\ \\ \\ \\ \\->\\ java.io\n+\\ \\ \\ \\ \\ \\ \\->\\ java.lang\n+\\ \\ \\ \\ \\ \\ \\->\\ java.net\n+\\ \\ \\ \\ \\ \\ \\->\\ java.util\n+\\ \\ \\ \\ \\ \\ \\->\\ java.util.logging\n+\\ \\ \\ \\ \\ \\ \\->\\ javax.swing\n+\\ \\ \\ \\ \\ \\ \\->\\ javax.swing.border\n+\\ \\ \\ \\ \\ \\ \\->\\ javax.swing.event\n+\\ \\ \\ \\ \\ \\ \\->\\ javax.swing.text\n+\\ \\ \\ \\ \\ \\ \\->\\ javax.swing.tree\n+\\ \\ \\ \\ \\ \\ \\->\\ javax.swing.undo\n@@ -308,19 +370,19 @@\n-C:\\[rs]Java\\[rs]jdk1.9.0>jdeps demo\\[rs]jfc\\[rs]Notepad\\[rs]Notepad.jar\n-Notepad.jar -> java.base\n-Notepad.jar -> java.desktop\n-Notepad.jar -> java.logging\n-   <unnamed> (Notepad.jar)\n-      -> java.awt\n-      -> java.awt.event\n-      -> java.beans\n-      -> java.io\n-      -> java.lang\n-      -> java.net\n-      -> java.util\n-      -> java.util.logging\n-      -> javax.swing\n-      -> javax.swing.border\n-      -> javax.swing.event\n-      -> javax.swing.text\n-      -> javax.swing.tree\n-      -> javax.swing.undo\n+C:\\\\Java\\\\jdk1.9.0>jdeps\\ demo\\\\jfc\\\\Notepad\\\\Notepad.jar\n+Notepad.jar\\ \\->\\ java.base\n+Notepad.jar\\ \\->\\ java.desktop\n+Notepad.jar\\ \\->\\ java.logging\n+\\ \\ \\ <unnamed>\\ (Notepad.jar)\n+\\ \\ \\ \\ \\ \\ \\->\\ java.awt\n+\\ \\ \\ \\ \\ \\ \\->\\ java.awt.event\n+\\ \\ \\ \\ \\ \\ \\->\\ java.beans\n+\\ \\ \\ \\ \\ \\ \\->\\ java.io\n+\\ \\ \\ \\ \\ \\ \\->\\ java.lang\n+\\ \\ \\ \\ \\ \\ \\->\\ java.net\n+\\ \\ \\ \\ \\ \\ \\->\\ java.util\n+\\ \\ \\ \\ \\ \\ \\->\\ java.util.logging\n+\\ \\ \\ \\ \\ \\ \\->\\ javax.swing\n+\\ \\ \\ \\ \\ \\ \\->\\ javax.swing.border\n+\\ \\ \\ \\ \\ \\ \\->\\ javax.swing.event\n+\\ \\ \\ \\ \\ \\ \\->\\ javax.swing.text\n+\\ \\ \\ \\ \\ \\ \\->\\ javax.swing.tree\n+\\ \\ \\ \\ \\ \\ \\->\\ javax.swing.undo\n@@ -329,1 +391,1 @@\n-.SH EXAMPLE USING THE --INVERSE OPTION\n+.SH EXAMPLE USING THE \\-\\-INVERSE OPTION\n@@ -333,7 +395,7 @@\n- $ jdeps --inverse --require java.xml.bind\n-Inverse transitive dependences on [java.xml.bind]\n-java.xml.bind <- java.se.ee\n-java.xml.bind <- jdk.xml.ws\n-java.xml.bind <- java.xml.ws <- java.se.ee\n-java.xml.bind <- java.xml.ws <- jdk.xml.ws\n-java.xml.bind <- jdk.xml.bind <- jdk.xml.ws\n+\\ $\\ jdeps\\ \\-\\-inverse\\ \\-\\-require\\ java.xml.bind\n+Inverse\\ transitive\\ dependences\\ on\\ [java.xml.bind]\n+java.xml.bind\\ <\\-\\ java.se.ee\n+java.xml.bind\\ <\\-\\ jdk.xml.ws\n+java.xml.bind\\ <\\-\\ java.xml.ws\\ <\\-\\ java.se.ee\n+java.xml.bind\\ <\\-\\ java.xml.ws\\ <\\-\\ jdk.xml.ws\n+java.xml.bind\\ <\\-\\ jdk.xml.bind\\ <\\-\\ jdk.xml.ws\n","filename":"src\/jdk.jdeps\/share\/man\/jdeps.1","additions":218,"deletions":156,"binary":false,"changes":374,"status":"modified"},{"patch":"@@ -22,1 +22,1 @@\n-.\\\" Automatically generated by Pandoc 2.19.2\n+.\\\" Automatically generated by Pandoc 2.3.1\n@@ -24,15 +24,1 @@\n-.\\\" Define V font for inline verbatim, using C font in formats\n-.\\\" that render this, and otherwise B font.\n-.ie \"\\f[CB]x\\f[R]\"x\" \\{\\\n-. ftr V B\n-. ftr VI BI\n-. ftr VB B\n-. ftr VBI BI\n-.\\}\n-.el \\{\\\n-. ftr V CR\n-. ftr VI CI\n-. ftr VB CB\n-. ftr VBI CBI\n-.\\}\n-.TH \"JDB\" \"1\" \"2023\" \"JDK 20-ea\" \"JDK Commands\"\n+.TH \"JDB\" \"1\" \"2023\" \"JDK 20\\-ea\" \"JDK Commands\"\n@@ -42,1 +28,1 @@\n-jdb - find and fix bugs in Java platform programs\n+jdb \\- find and fix bugs in Java platform programs\n@@ -45,1 +31,1 @@\n-\\f[V]jdb\\f[R] [\\f[I]options\\f[R]] [\\f[I]classname\\f[R]]\n+\\f[CB]jdb\\f[R] [\\f[I]options\\f[R]] [\\f[I]classname\\f[R]]\n@@ -48,2 +34,2 @@\n-\\f[I]options\\f[R]\n-This represents the \\f[V]jdb\\f[R] command-line options.\n+.B \\f[I]options\\f[R]\n+This represents the \\f[CB]jdb\\f[R] command\\-line options.\n@@ -51,0 +37,2 @@\n+.RS\n+.RE\n@@ -52,1 +40,1 @@\n-\\f[I]classname\\f[R]\n+.B \\f[I]classname\\f[R]\n@@ -54,0 +42,2 @@\n+.RS\n+.RE\n@@ -55,2 +45,2 @@\n-\\f[I]arguments\\f[R]\n-This represents the arguments that are passed to the \\f[V]main()\\f[R]\n+.B \\f[I]arguments\\f[R]\n+This represents the arguments that are passed to the \\f[CB]main()\\f[R]\n@@ -58,0 +48,2 @@\n+.RS\n+.RE\n@@ -60,1 +52,1 @@\n-The Java Debugger (JDB) is a simple command-line debugger for Java\n+The Java Debugger (JDB) is a simple command\\-line debugger for Java\n@@ -62,2 +54,2 @@\n-The \\f[V]jdb\\f[R] command and its options call the JDB.\n-The \\f[V]jdb\\f[R] command demonstrates the Java Platform Debugger\n+The \\f[CB]jdb\\f[R] command and its options call the JDB.\n+The \\f[CB]jdb\\f[R] command demonstrates the Java Platform Debugger\n@@ -71,1 +63,1 @@\n-Do this by substituting the \\f[V]jdb\\f[R] command for the \\f[V]java\\f[R]\n+Do this by substituting the \\f[CB]jdb\\f[R] command for the \\f[CB]java\\f[R]\n@@ -73,1 +65,1 @@\n-For example, if your application\\[aq]s main class is \\f[V]MyClass\\f[R],\n+For example, if your application\\[aq]s main class is \\f[CB]MyClass\\f[R],\n@@ -77,1 +69,1 @@\n-\\f[V]jdb MyClass\\f[R]\n+\\f[CB]jdb\\ MyClass\\f[R]\n@@ -80,1 +72,1 @@\n-When started this way, the \\f[V]jdb\\f[R] command calls a second JVM with\n+When started this way, the \\f[CB]jdb\\f[R] command calls a second JVM with\n@@ -84,1 +76,1 @@\n-Another way to use the \\f[V]jdb\\f[R] command is by attaching it to a JVM\n+Another way to use the \\f[CB]jdb\\f[R] command is by attaching it to a JVM\n@@ -86,1 +78,1 @@\n-Syntax for starting a JVM to which the \\f[V]jdb\\f[R] command attaches\n+Syntax for starting a JVM to which the \\f[CB]jdb\\f[R] command attaches\n@@ -88,1 +80,1 @@\n-This loads in-process debugging libraries and specifies the kind of\n+This loads in\\-process debugging libraries and specifies the kind of\n@@ -92,1 +84,1 @@\n-\\f[V]java -agentlib:jdwp=transport=dt_socket,server=y,suspend=n MyClass\\f[R]\n+\\f[CB]java\\ \\-agentlib:jdwp=transport=dt_socket,server=y,suspend=n\\ MyClass\\f[R]\n@@ -95,1 +87,1 @@\n-You can then attach the \\f[V]jdb\\f[R] command to the JVM with the\n+You can then attach the \\f[CB]jdb\\f[R] command to the JVM with the\n@@ -99,1 +91,1 @@\n-\\f[V]jdb -attach 8000\\f[R]\n+\\f[CB]jdb\\ \\-attach\\ 8000\\f[R]\n@@ -104,3 +96,3 @@\n-The \\f[V]MyClass\\f[R] argument isn\\[aq]t specified in the \\f[V]jdb\\f[R]\n-command line in this case because the \\f[V]jdb\\f[R] command is\n-connecting to an existing JVM instead of launching a new JVM.\n+The \\f[CB]MyClass\\f[R] argument isn\\[aq]t specified in the \\f[CB]jdb\\f[R]\n+command line in this case because the \\f[CB]jdb\\f[R] command is connecting\n+to an existing JVM instead of launching a new JVM.\n@@ -109,1 +101,1 @@\n-them are supported by the \\f[V]jdb\\f[R] command.\n+them are supported by the \\f[CB]jdb\\f[R] command.\n@@ -117,2 +109,2 @@\n-The command \\f[V]stop at MyClass:22\\f[R] sets a breakpoint at the first\n-instruction for line 22 of the source file containing \\f[V]MyClass\\f[R].\n+The command \\f[CB]stop\\ at\\ MyClass:22\\f[R] sets a breakpoint at the first\n+instruction for line 22 of the source file containing \\f[CB]MyClass\\f[R].\n@@ -120,2 +112,2 @@\n-The command \\f[V]stop in java.lang.String.length\\f[R] sets a breakpoint\n-at the beginning of the method \\f[V]java.lang.String.length\\f[R].\n+The command \\f[CB]stop\\ in\\ java.lang.String.length\\f[R] sets a breakpoint\n+at the beginning of the method \\f[CB]java.lang.String.length\\f[R].\n@@ -123,2 +115,2 @@\n-The command \\f[V]stop in MyClass.<clinit>\\f[R] uses \\f[V]<clinit>\\f[R]\n-to identify the static initialization code for \\f[V]MyClass\\f[R].\n+The command \\f[CB]stop\\ in\\ MyClass.<clinit>\\f[R] uses \\f[CB]<clinit>\\f[R]\n+to identify the static initialization code for \\f[CB]MyClass\\f[R].\n@@ -128,2 +120,2 @@\n-For example, \\f[V]MyClass.myMethod(int,java.lang.String)\\f[R] or\n-\\f[V]MyClass.myMethod()\\f[R].\n+For example, \\f[CB]MyClass.myMethod(int,java.lang.String)\\f[R] or\n+\\f[CB]MyClass.myMethod()\\f[R].\n@@ -131,3 +123,3 @@\n-The \\f[V]clear\\f[R] command removes breakpoints using the following\n-syntax: \\f[V]clear MyClass:45\\f[R].\n-Using the \\f[V]clear\\f[R] or \\f[V]stop\\f[R] command with no argument\n+The \\f[CB]clear\\f[R] command removes breakpoints using the following\n+syntax: \\f[CB]clear\\ MyClass:45\\f[R].\n+Using the \\f[CB]clear\\f[R] or \\f[CB]stop\\f[R] command with no argument\n@@ -135,1 +127,1 @@\n-The \\f[V]cont\\f[R] command continues execution.\n+The \\f[CB]cont\\f[R] command continues execution.\n@@ -138,1 +130,1 @@\n-The \\f[V]step\\f[R] command advances execution to the next line whether\n+The \\f[CB]step\\f[R] command advances execution to the next line whether\n@@ -140,1 +132,1 @@\n-The \\f[V]next\\f[R] command advances execution to the next line in the\n+The \\f[CB]next\\f[R] command advances execution to the next line in the\n@@ -144,1 +136,1 @@\n-When an exception occurs for which there isn\\[aq]t a \\f[V]catch\\f[R]\n+When an exception occurs for which there isn\\[aq]t a \\f[CB]catch\\f[R]\n@@ -149,1 +141,1 @@\n-You can then use the \\f[V]jdb\\f[R] command to diagnose the cause of the\n+You can then use the \\f[CB]jdb\\f[R] command to diagnose the cause of the\n@@ -152,4 +144,4 @@\n-Use the \\f[V]catch\\f[R] command to cause the debugged application to\n-stop at other thrown exceptions, for example:\n-\\f[V]catch java.io.FileNotFoundException\\f[R] or \\f[V]catch\\f[R]\n-\\f[V]mypackage.BigTroubleException\\f[R].\n+Use the \\f[CB]catch\\f[R] command to cause the debugged application to stop\n+at other thrown exceptions, for example:\n+\\f[CB]catch\\ java.io.FileNotFoundException\\f[R] or \\f[CB]catch\\f[R]\n+\\f[CB]mypackage.BigTroubleException\\f[R].\n@@ -159,4 +151,4 @@\n-The \\f[V]ignore\\f[R] command negates the effect of an earlier\n-\\f[V]catch\\f[R] command.\n-The \\f[V]ignore\\f[R] command doesn\\[aq]t cause the debugged JVM to\n-ignore specific exceptions, but only to ignore the debugger.\n+The \\f[CB]ignore\\f[R] command negates the effect of an earlier\n+\\f[CB]catch\\f[R] command.\n+The \\f[CB]ignore\\f[R] command doesn\\[aq]t cause the debugged JVM to ignore\n+specific exceptions, but only to ignore the debugger.\n@@ -165,3 +157,3 @@\n-When you use the \\f[V]jdb\\f[R] command instead of the \\f[V]java\\f[R]\n-command on the command line, the \\f[V]jdb\\f[R] command accepts many of\n-the same options as the \\f[V]java\\f[R] command.\n+When you use the \\f[CB]jdb\\f[R] command instead of the \\f[CB]java\\f[R]\n+command on the command line, the \\f[CB]jdb\\f[R] command accepts many of\n+the same options as the \\f[CB]java\\f[R] command.\n@@ -169,1 +161,1 @@\n-The following options are accepted by the \\f[V]jdb\\f[R] command:\n+The following options are accepted by the \\f[CB]jdb\\f[R] command:\n@@ -171,1 +163,1 @@\n-\\f[V]-help\\f[R]\n+.B \\f[CB]\\-help\\f[R]\n@@ -173,0 +165,2 @@\n+.RS\n+.RE\n@@ -174,1 +168,1 @@\n-\\f[V]-sourcepath\\f[R] \\f[I]dir1\\f[R]\\f[V]:\\f[R]\\f[I]dir2\\f[R]\\f[V]:\\f[R]...\n+.B \\f[CB]\\-sourcepath\\f[R] \\f[I]dir1\\f[R]\\f[CB]:\\f[R]\\f[I]dir2\\f[R]\\f[CB]:\\f[R]...\n@@ -178,1 +172,3 @@\n-(\\f[V].\\f[R]).\n+(\\f[CB]\\&.\\f[R]).\n+.RS\n+.RE\n@@ -180,1 +176,1 @@\n-\\f[V]-attach\\f[R] \\f[I]address\\f[R]\n+.B \\f[CB]\\-attach\\f[R] \\f[I]address\\f[R]\n@@ -183,0 +179,2 @@\n+.RS\n+.RE\n@@ -184,1 +182,1 @@\n-\\f[V]-listen\\f[R] \\f[I]address\\f[R]\n+.B \\f[CB]\\-listen\\f[R] \\f[I]address\\f[R]\n@@ -187,0 +185,2 @@\n+.RS\n+.RE\n@@ -188,1 +188,1 @@\n-\\f[V]-listenany\\f[R]\n+.B \\f[CB]\\-listenany\\f[R]\n@@ -191,0 +191,2 @@\n+.RS\n+.RE\n@@ -192,1 +194,1 @@\n-\\f[V]-launch\\f[R]\n+.B \\f[CB]\\-launch\\f[R]\n@@ -194,2 +196,2 @@\n-\\f[V]jdb\\f[R] command.\n-The \\f[V]-launch\\f[R] option removes the need for the \\f[V]run\\f[R]\n+\\f[CB]jdb\\f[R] command.\n+The \\f[CB]\\-launch\\f[R] option removes the need for the \\f[CB]run\\f[R]\n@@ -200,1 +202,3 @@\n-\\f[V]cont\\f[R] command to continue execution.\n+\\f[CB]cont\\f[R] command to continue execution.\n+.RS\n+.RE\n@@ -202,1 +206,1 @@\n-\\f[V]-listconnectors\\f[R]\n+.B \\f[CB]\\-listconnectors\\f[R]\n@@ -204,0 +208,2 @@\n+.RS\n+.RE\n@@ -205,1 +211,1 @@\n-\\f[V]-connect\\f[R] \\f[I]connector-name\\f[R]\\f[V]:\\f[R]\\f[I]name1\\f[R]\\f[V]=\\f[R]\\f[I]value1\\f[R]....\n+.B \\f[CB]\\-connect\\f[R] \\f[I]connector\\-name\\f[R]\\f[CB]:\\f[R]\\f[I]name1\\f[R]\\f[CB]=\\f[R]\\f[I]value1\\f[R]....\n@@ -208,0 +214,2 @@\n+.RS\n+.RE\n@@ -209,2 +217,4 @@\n-\\f[V]-dbgtrace\\f[R] [\\f[I]flags\\f[R]]\n-Prints information for debugging the \\f[V]jdb\\f[R] command.\n+.B \\f[CB]\\-dbgtrace\\f[R] [\\f[I]flags\\f[R]]\n+Prints information for debugging the \\f[CB]jdb\\f[R] command.\n+.RS\n+.RE\n@@ -212,1 +222,1 @@\n-\\f[V]-tclient\\f[R]\n+.B \\f[CB]\\-tclient\\f[R]\n@@ -214,0 +224,2 @@\n+.RS\n+.RE\n@@ -215,1 +227,1 @@\n-\\f[V]-trackallthreads\\f[R]\n+.B \\f[CB]\\-trackallthreads\\f[R]\n@@ -219,0 +231,2 @@\n+.RS\n+.RE\n@@ -220,1 +234,1 @@\n-\\f[V]-tserver\\f[R]\n+.B \\f[CB]\\-tserver\\f[R]\n@@ -222,0 +236,2 @@\n+.RS\n+.RE\n@@ -223,1 +239,1 @@\n-\\f[V]-J\\f[R]\\f[I]option\\f[R]\n+.B \\f[CB]\\-J\\f[R]\\f[I]option\\f[R]\n@@ -227,1 +243,1 @@\n-For example, \\f[V]-J-Xms48m\\f[R] sets the startup memory to 48 MB.\n+For example, \\f[CB]\\-J\\-Xms48m\\f[R] sets the startup memory to 48 MB.\n@@ -229,0 +245,2 @@\n+.RS\n+.RE\n@@ -232,1 +250,1 @@\n-\\f[V]-R\\f[R]\\f[I]option\\f[R]\n+.B \\f[CB]\\-R\\f[R]\\f[I]option\\f[R]\n@@ -236,1 +254,1 @@\n-For example, \\f[V]-R-Xms48m\\f[R] sets the startup memory to 48 MB.\n+For example, \\f[CB]\\-R\\-Xms48m\\f[R] sets the startup memory to 48 MB.\n@@ -238,0 +256,2 @@\n+.RS\n+.RE\n@@ -239,1 +259,1 @@\n-\\f[V]-v\\f[R] or \\f[V]-verbose\\f[R][\\f[V]:\\f[R]\\f[I]class\\f[R]|\\f[V]gc\\f[R]|\\f[V]jni\\f[R]]\n+.B \\f[CB]\\-v\\f[R] or \\f[CB]\\-verbose\\f[R][\\f[CB]:\\f[R]\\f[I]class\\f[R]|\\f[CB]gc\\f[R]|\\f[CB]jni\\f[R]]\n@@ -241,0 +261,2 @@\n+.RS\n+.RE\n@@ -242,1 +264,1 @@\n-\\f[V]-D\\f[R]\\f[I]name\\f[R]\\f[V]=\\f[R]\\f[I]value\\f[R]\n+.B \\f[CB]\\-D\\f[R]\\f[I]name\\f[R]\\f[CB]=\\f[R]\\f[I]value\\f[R]\n@@ -244,0 +266,2 @@\n+.RS\n+.RE\n@@ -245,1 +269,1 @@\n-\\f[V]-classpath\\f[R] \\f[I]dir\\f[R]\n+.B \\f[CB]\\-classpath\\f[R] \\f[I]dir\\f[R]\n@@ -247,0 +271,2 @@\n+.RS\n+.RE\n@@ -248,1 +274,1 @@\n-\\f[V]-X\\f[R] \\f[I]option\\f[R]\n+.B \\f[CB]\\-X\\f[R] \\f[I]option\\f[R]\n@@ -250,0 +276,2 @@\n+.RS\n+.RE\n@@ -265,1 +293,1 @@\n-The \\f[V]-trackallthreads\\f[R] option can be used to make JDB track all\n+The \\f[CB]\\-trackallthreads\\f[R] option can be used to make JDB track all\n@@ -273,2 +301,2 @@\n-The Debug Agent has an \\f[V]includevirtualthreads\\f[R] option that can\n-be enabled to change this behavior so all known virtual threads will be\n+The Debug Agent has an \\f[CB]includevirtualthreads\\f[R] option that can be\n+enabled to change this behavior so all known virtual threads will be\n@@ -276,1 +304,1 @@\n-The JDB \\f[V]-trackallthreads\\f[R] option will cause JDB to\n+The JDB \\f[CB]\\-trackallthreads\\f[R] option will cause JDB to\n@@ -278,1 +306,1 @@\n-\\f[V]includevirtualthreads\\f[R] option when JDB launches an application\n+\\f[CB]includevirtualthreads\\f[R] option when JDB launches an application\n","filename":"src\/jdk.jdi\/share\/man\/jdb.1","additions":126,"deletions":98,"binary":false,"changes":224,"status":"modified"},{"patch":"@@ -61,0 +61,4 @@\n+ *\n+ * suspendCount is the number of outstanding suspends\n+ * from the debugger. suspends from the app itself are\n+ * not included in this count.\n@@ -73,0 +77,1 @@\n+    unsigned int handlingAppResume : 1;\n@@ -75,1 +80,2 @@\n-    jint suspendCount;     \/* Number of outstanding suspends from the debugger. *\/\n+    jint suspendCount;\n+    jint resumeFrameDepth; \/* !=0 => This thread is in a call to Thread.resume() *\/\n@@ -109,0 +115,4 @@\n+static jlocation resumeLocation;\n+static HandlerNode *breakpointHandlerNode;\n+static HandlerNode *framePopHandlerNode;\n+static HandlerNode *catchHandlerNode;\n@@ -145,0 +155,14 @@\n+static jint\n+getStackDepth(jthread thread)\n+{\n+    jint count = 0;\n+    jvmtiError error;\n+\n+    error = JVMTI_FUNC_PTR(gdata->jvmti,GetFrameCount)\n+                        (gdata->jvmti, thread, &count);\n+    if (error != JVMTI_ERROR_NONE) {\n+        EXIT_ERROR(error, \"getting frame count\");\n+    }\n+    return count;\n+}\n+\n@@ -293,1 +317,1 @@\n-removeNode(ThreadNode *node)\n+removeNode(ThreadList *list, ThreadNode *node)\n@@ -297,1 +321,2 @@\n-    ThreadList *list;\n+\n+    JDI_ASSERT(list == node->list);\n@@ -300,1 +325,0 @@\n-    list = node->list;\n@@ -470,1 +494,1 @@\n-  removeNode(node);\n+  removeNode(node->list, node);\n@@ -496,1 +520,1 @@\n-        removeNode(node);\n+        removeNode(list, node);\n@@ -505,1 +529,1 @@\n-    removeNode(node);\n+    removeNode(source, node);\n@@ -663,0 +687,3 @@\n+    jlocation unused;\n+    jvmtiError error;\n+\n@@ -669,0 +696,200 @@\n+    if (gdata->threadClass==NULL) {\n+        EXIT_ERROR(AGENT_ERROR_NULL_POINTER, \"no java.lang.thread class\");\n+    }\n+    if (gdata->threadResume==0) {\n+        EXIT_ERROR(AGENT_ERROR_NULL_POINTER, \"cannot resume thread\");\n+    }\n+    \/* Get the java.lang.Thread.resume() method beginning location *\/\n+    error = methodLocation(gdata->threadResume, &resumeLocation, &unused);\n+    if (error != JVMTI_ERROR_NONE) {\n+        EXIT_ERROR(error, \"getting method location\");\n+    }\n+}\n+\n+static jthread\n+getResumee(jthread resumingThread)\n+{\n+    jthread resumee = NULL;\n+    jvmtiError error;\n+    jobject object;\n+    FrameNumber fnum = 0;\n+\n+    error = JVMTI_FUNC_PTR(gdata->jvmti,GetLocalObject)\n+                    (gdata->jvmti, resumingThread, fnum, 0, &object);\n+    if (error == JVMTI_ERROR_NONE) {\n+        resumee = object;\n+    }\n+    return resumee;\n+}\n+\n+\n+static jboolean\n+pendingAppResume(jboolean includeSuspended)\n+{\n+    ThreadList *list;\n+    ThreadNode *node;\n+\n+    list = &runningThreads;\n+    node = list->first;\n+    while (node != NULL) {\n+        if (node->resumeFrameDepth > 0) {\n+            if (includeSuspended) {\n+                return JNI_TRUE;\n+            } else {\n+                jvmtiError error;\n+                jint       state;\n+\n+                error = threadState(node->thread, &state);\n+                if (error != JVMTI_ERROR_NONE) {\n+                    EXIT_ERROR(error, \"getting thread state\");\n+                }\n+                \/* !node->handlingAppResume && resumeFrameDepth > 0\n+                 * means the thread has entered Thread.resume() *\/\n+                if (!(state & JVMTI_THREAD_STATE_SUSPENDED) &&\n+                    !node->handlingAppResume) {\n+                    return JNI_TRUE;\n+                }\n+            }\n+        }\n+        node = node->next;\n+        if (node == NULL && list == &runningThreads) {\n+            \/\/ We need to look at runningVThreads after we are done with runningThreads.\n+            list = &runningVThreads;\n+            node = list->first;\n+        }\n+    }\n+    return JNI_FALSE;\n+}\n+\n+static void\n+notifyAppResumeComplete(void)\n+{\n+    debugMonitorNotifyAll(threadLock);\n+    if (!pendingAppResume(JNI_TRUE)) {\n+        if (framePopHandlerNode != NULL) {\n+            (void)eventHandler_free(framePopHandlerNode);\n+            framePopHandlerNode = NULL;\n+        }\n+        if (catchHandlerNode != NULL) {\n+            (void)eventHandler_free(catchHandlerNode);\n+            catchHandlerNode = NULL;\n+        }\n+    }\n+}\n+\n+\/*\n+ * Event handler for FRAME_POP and EXCEPTION_CATCH when in Thread.resume()\n+ * so we can detect its completion.\n+ *\/\n+static void\n+handleAppResumeCompletion(JNIEnv *env, EventInfo *evinfo,\n+                          HandlerNode *handlerNode,\n+                          struct bag *eventBag)\n+{\n+    ThreadNode *node;\n+    jthread     thread;\n+\n+    thread = evinfo->thread;\n+\n+    debugMonitorEnter(threadLock);\n+\n+    node = findRunningThread(thread);\n+    if (node != NULL) {\n+        if (node->resumeFrameDepth > 0) {\n+            jint compareDepth = getStackDepth(thread);\n+            if (evinfo->ei == EI_FRAME_POP) {\n+                compareDepth--;\n+            }\n+            if (compareDepth < node->resumeFrameDepth) {\n+                node->resumeFrameDepth = 0;\n+                notifyAppResumeComplete();\n+            }\n+        }\n+    }\n+\n+    debugMonitorExit(threadLock);\n+}\n+\n+static void\n+blockOnDebuggerSuspend(jthread thread)\n+{\n+    ThreadNode *node;\n+\n+    node = findThread(NULL, thread);\n+    if (node != NULL) {\n+        while (node && node->suspendCount > 0) {\n+            debugMonitorWait(threadLock);\n+            node = findThread(NULL, thread);\n+        }\n+    }\n+}\n+\n+\/*\n+ * The caller is expected to hold threadLock and handlerLock.\n+ * eventHandler_createInternalThreadOnly() can deadlock because of\n+ * wrong lock ordering if the caller does not hold handlerLock.\n+ *\/\n+static void\n+trackAppResume(jthread thread)\n+{\n+    jvmtiError  error;\n+    FrameNumber fnum;\n+    ThreadNode *node;\n+\n+    fnum = 0;\n+    node = findRunningThread(thread);\n+    if (node != NULL) {\n+        JDI_ASSERT(node->resumeFrameDepth == 0);\n+        error = JVMTI_FUNC_PTR(gdata->jvmti,NotifyFramePop)\n+                        (gdata->jvmti, thread, fnum);\n+        if (error == JVMTI_ERROR_NONE) {\n+            jint frameDepth = getStackDepth(thread);\n+            if ((frameDepth > 0) && (framePopHandlerNode == NULL)) {\n+                framePopHandlerNode = eventHandler_createInternalThreadOnly(\n+                                           EI_FRAME_POP,\n+                                           handleAppResumeCompletion,\n+                                           thread);\n+                catchHandlerNode = eventHandler_createInternalThreadOnly(\n+                                           EI_EXCEPTION_CATCH,\n+                                           handleAppResumeCompletion,\n+                                           thread);\n+                if ((framePopHandlerNode == NULL) ||\n+                    (catchHandlerNode == NULL)) {\n+                    (void)eventHandler_free(framePopHandlerNode);\n+                    framePopHandlerNode = NULL;\n+                    (void)eventHandler_free(catchHandlerNode);\n+                    catchHandlerNode = NULL;\n+                }\n+            }\n+            if ((framePopHandlerNode != NULL) &&\n+                (catchHandlerNode != NULL) &&\n+                (frameDepth > 0)) {\n+                node->resumeFrameDepth = frameDepth;\n+            }\n+        }\n+    }\n+}\n+\n+\/* Global breakpoint handler for Thread.resume() *\/\n+static void\n+handleAppResumeBreakpoint(JNIEnv *env, EventInfo *evinfo,\n+                          HandlerNode *handlerNode,\n+                          struct bag *eventBag)\n+{\n+    jthread resumer = evinfo->thread;\n+\n+    debugMonitorEnter(threadLock);\n+\n+    \/*\n+     * Actual handling has to be deferred. We cannot block right here if the\n+     * target of the resume call is suspended by the debugger since we are\n+     * holding handlerLock which must not be released. See doPendingTasks().\n+     *\/\n+    if (resumer != NULL) {\n+        ThreadNode* node = findThread(&runningThreads, resumer);\n+        if (node != NULL) {\n+            node->handlingAppResume = JNI_TRUE;\n+        }\n+    }\n+\n+    debugMonitorExit(threadLock);\n@@ -674,0 +901,3 @@\n+    breakpointHandlerNode = eventHandler_createInternalBreakpoint(\n+                 handleAppResumeBreakpoint, NULL,\n+                 gdata->threadClass, gdata->threadResume, resumeLocation);\n@@ -679,0 +909,12 @@\n+    if (breakpointHandlerNode != NULL) {\n+        (void)eventHandler_free(breakpointHandlerNode);\n+        breakpointHandlerNode = NULL;\n+    }\n+    if (framePopHandlerNode != NULL) {\n+        (void)eventHandler_free(framePopHandlerNode);\n+        framePopHandlerNode = NULL;\n+    }\n+    if (catchHandlerNode != NULL) {\n+        (void)eventHandler_free(catchHandlerNode);\n+        catchHandlerNode = NULL;\n+    }\n@@ -752,2 +994,2 @@\n-     * JVMTI_ERROR_THREAD_SUSPENDED used to be possible when Thread.suspend()\n-     * was still supported, but now we should no longer ever see it.\n+     * If the thread was suspended by another app thread,\n+     * do nothing and report no error (we won't resume it later).\n@@ -755,1 +997,3 @@\n-    JDI_ASSERT(error != JVMTI_ERROR_THREAD_SUSPENDED);\n+     if (error == JVMTI_ERROR_THREAD_SUSPENDED) {\n+        error = JVMTI_ERROR_NONE;\n+     }\n@@ -757,1 +1001,1 @@\n-    return error;\n+     return error;\n@@ -858,3 +1102,2 @@\n-        if ((node->suspendCount == 0) && node->toBeResumed) {\n-            \/\/ We should never see both toBeResumed and suspendOnStart set true.\n-            JDI_ASSERT(!node->suspendOnStart);\n+        if ((node->suspendCount == 0) && node->toBeResumed &&\n+            !node->suspendOnStart) {\n@@ -900,0 +1143,26 @@\n+\n+    \/*\n+     * Delay any suspend while a call to java.lang.Thread.resume is in\n+     * progress (not including those in suspended threads). The wait is\n+     * timed because the threads suspended through\n+     * java.lang.Thread.suspend won't result in a notify even though\n+     * it may change the result of pendingAppResume()\n+     *\/\n+    while (pendingAppResume(JNI_FALSE)) {\n+        \/*\n+         * This is ugly but we need to release the locks from getLocks\n+         * or else the notify will never happen. The locks must be\n+         * released and reacquired in the right order. else deadlocks\n+         * can happen. It is possible that, during this dance, the\n+         * notify will be missed, but since the wait needs to be timed\n+         * anyway, it won't be a disaster. Note that this code will\n+         * execute only on very rare occasions anyway.\n+         *\/\n+        releaseLocks();\n+\n+        debugMonitorEnter(threadLock);\n+        debugMonitorTimedWait(threadLock, 1000);\n+        debugMonitorExit(threadLock);\n+\n+        getLocks();\n+    }\n@@ -966,0 +1235,9 @@\n+     * Another case to be handled here is when the debugger suspends\n+     * the thread while the app has it suspended. In this case,\n+     * the toBeResumed flag has been cleared indicating that\n+     * the thread should not be resumed when the debugger does a resume.\n+     * In this case, we also have to decrement the suspend count.\n+     * If we don't then when the app resumes the thread and our Thread.resume\n+     * bkpt handler is called, blockOnDebuggerSuspend will not resume\n+     * the thread because suspendCount will be 1 meaning that the\n+     * debugger has the thread suspended.  See bug 6224859.\n@@ -967,3 +1245,1 @@\n-    if (node->suspendCount == 1 && node->suspendOnStart) {\n-        \/\/ We should never see both toBeResumed and suspendOnStart set true.\n-        JDI_ASSERT(!node->toBeResumed);\n+    if (node->suspendCount == 1 && (!node->toBeResumed || node->suspendOnStart)) {\n@@ -982,2 +1258,3 @@\n-     * JVMTI SuspendThread() or JVMTI SuspendThreadList() was called\n-     * on this thread.\n+     * JVM\/DI SuspendThread() or JVM\/DI SuspendThreadList() was called\n+     * on this thread. The check for !suspendOnStart is paranoia that\n+     * we inherited from resumeThreadByNode().\n@@ -985,3 +1262,1 @@\n-    if (node->suspendCount == 1 && node->toBeResumed) {\n-        \/\/ We should never see both toBeResumed and suspendOnStart set true.\n-        JDI_ASSERT(!node->suspendOnStart);\n+    if (node->suspendCount == 1 && node->toBeResumed && !node->suspendOnStart) {\n@@ -989,0 +1264,1 @@\n+\n@@ -1006,2 +1282,3 @@\n-     * JVMTI SuspendThread() or JVMTDI SuspendThreadList() was called\n-     * on this thread.\n+     * JVM\/DI SuspendThread() or JVM\/DI SuspendThreadList() was called\n+     * on this thread. The check for !suspendOnStart is paranoia that\n+     * we inherited from resumeThreadByNode().\n@@ -1009,3 +1286,1 @@\n-    if (node->suspendCount == 1 && node->toBeResumed) {\n-        \/\/ We should never see both toBeResumed and suspendOnStart set true.\n-        JDI_ASSERT(!node->suspendOnStart);\n+    if (node->suspendCount == 1 && node->toBeResumed && !node->suspendOnStart) {\n@@ -1013,0 +1288,1 @@\n+\n@@ -1114,1 +1390,1 @@\n-         * resumeThreadByNode() assumes that JVMTI ResumeThread()\n+         * resumeThreadByNode() assumes that JVM\/DI ResumeThread()\n@@ -2115,0 +2391,53 @@\n+    \/* Deferred breakpoint handling for Thread.resume() *\/\n+    if (node->handlingAppResume) {\n+        jthread resumer = node->thread;\n+        jthread resumee = getResumee(resumer);\n+\n+        if (resumer != NULL) {\n+            \/*\n+             * trackAppResume indirectly acquires handlerLock. For proper lock\n+             * ordering handlerLock has to be acquired before threadLock.\n+             *\/\n+            debugMonitorExit(threadLock);\n+            eventHandler_lock();\n+            debugMonitorEnter(threadLock);\n+\n+            \/*\n+             * Track the resuming thread by marking it as being within\n+             * a resume and by setting up for notification on\n+             * a frame pop or exception. We won't allow the debugger\n+             * to suspend threads while any thread is within a\n+             * call to resume. This (along with the block below)\n+             * ensures that when the debugger\n+             * suspends a thread it will remain suspended.\n+             *\/\n+            trackAppResume(resumer);\n+\n+            \/*\n+             * handlerLock is not needed anymore. We must release it before calling\n+             * blockOnDebuggerSuspend() because it is required for resumes done by\n+             * the debugger. If resumee is currently suspended by the debugger, then\n+             * blockOnDebuggerSuspend() will block until a debugger resume is done.\n+             * If it blocks while holding the handlerLock, then the resume will deadlock.\n+             *\/\n+            eventHandler_unlock();\n+        }\n+\n+        if (resumee != NULL) {\n+            \/*\n+             * Hold up any attempt to resume as long as the debugger\n+             * has suspended the resumee.\n+             *\/\n+            blockOnDebuggerSuspend(resumee);\n+        }\n+\n+        node->handlingAppResume = JNI_FALSE;\n+\n+        \/*\n+         * The blocks exit condition: resumee's suspendCount == 0.\n+         *\n+         * Debugger suspends are blocked if any thread is executing\n+         * Thread.resume(), i.e. !handlingAppResume && frameDepth > 0.\n+         *\/\n+    }\n+\n@@ -2159,0 +2488,1 @@\n+            jboolean inResume = (node->resumeFrameDepth > 0);\n@@ -2161,0 +2491,8 @@\n+\n+            \/*\n+             * Clean up mechanism used to detect end of\n+             * resume.\n+             *\/\n+            if (inResume) {\n+                notifyAppResumeComplete();\n+            }\n","filename":"src\/jdk.jdwp.agent\/share\/native\/libjdwp\/threadControl.c","additions":366,"deletions":28,"binary":false,"changes":394,"status":"modified"},{"patch":"@@ -225,0 +225,2 @@\n+        gdata->threadResume =\n+                getMethod(env, gdata->threadClass, \"resume\", \"()V\");\n@@ -278,0 +280,1 @@\n+            saveGlobalRef(env, localAgentProperties, &(gdata->agent_properties));\n@@ -283,1 +286,0 @@\n-            saveGlobalRef(env, localAgentProperties, &(gdata->agent_properties));\n","filename":"src\/jdk.jdwp.agent\/share\/native\/libjdwp\/util.c","additions":3,"deletions":1,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -110,0 +110,1 @@\n+    jmethodID           threadResume;\n","filename":"src\/jdk.jdwp.agent\/share\/native\/libjdwp\/util.h","additions":1,"deletions":0,"binary":false,"changes":1,"status":"modified"},{"patch":"@@ -78,5 +78,0 @@\n-\n-    @Label(\"Container Host Total Memory\")\n-    @Description(\"Total memory of the host running the container\")\n-    @DataAmount\n-    public long hostTotalMemory;\n","filename":"src\/jdk.jfr\/share\/classes\/jdk\/jfr\/events\/ContainerConfigurationEvent.java","additions":0,"deletions":5,"binary":false,"changes":5,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2018, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2018, Oracle and\/or its affiliates. All rights reserved.\n@@ -32,1 +32,0 @@\n-import jdk.jfr.Unsigned;\n@@ -56,1 +55,0 @@\n-    @Unsigned\n","filename":"src\/jdk.jfr\/share\/classes\/jdk\/jfr\/events\/TLSHandshakeEvent.java","additions":1,"deletions":3,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2018, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2018, Oracle and\/or its affiliates. All rights reserved.\n@@ -57,1 +57,0 @@\n-    @Unsigned\n","filename":"src\/jdk.jfr\/share\/classes\/jdk\/jfr\/events\/X509CertificateEvent.java","additions":1,"deletions":2,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2018, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2018, Oracle and\/or its affiliates. All rights reserved.\n@@ -39,1 +39,0 @@\n-    @Unsigned\n","filename":"src\/jdk.jfr\/share\/classes\/jdk\/jfr\/events\/X509ValidationEvent.java","additions":1,"deletions":2,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -638,6 +638,0 @@\n-\n-    \/**\n-     * Returns the total amount of memory of the host system whether or not this\n-     * JVM runs in a container.\n-     *\/\n-    public native long hostTotalMemory();\n","filename":"src\/jdk.jfr\/share\/classes\/jdk\/jfr\/internal\/JVM.java","additions":0,"deletions":6,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2019, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2019, 2021, Oracle and\/or its affiliates. All rights reserved.\n@@ -65,0 +65,1 @@\n+    private volatile Thread thread;\n@@ -216,1 +217,1 @@\n-        Thread thread = SecuritySupport.createThreadWitNoPermissions(nextThreadName(), r);\n+        thread = SecuritySupport.createThreadWitNoPermissions(nextThreadName(), r);\n@@ -223,0 +224,1 @@\n+        thread = Thread.currentThread();\n","filename":"src\/jdk.jfr\/share\/classes\/jdk\/jfr\/internal\/consumer\/AbstractEventStream.java","additions":4,"deletions":2,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -224,1 +224,0 @@\n-            t.hostTotalMemory = JVM.getJVM().hostTotalMemory();\n","filename":"src\/jdk.jfr\/share\/classes\/jdk\/jfr\/internal\/instrument\/JDKEvents.java","additions":0,"deletions":1,"binary":false,"changes":1,"status":"modified"},{"patch":"@@ -156,1 +156,1 @@\n-            long duration = EventConfiguration.timestamp() - start;\n+            long duration = EventConfiguration.timestamp();\n","filename":"src\/jdk.jfr\/share\/classes\/jdk\/jfr\/internal\/instrument\/RandomAccessFileInstrumentor.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2018, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2018, 2021, Oracle and\/or its affiliates. All rights reserved.\n@@ -31,1 +31,0 @@\n-import java.math.BigInteger;\n@@ -42,1 +41,0 @@\n-import jdk.jfr.Unsigned;\n@@ -52,1 +50,1 @@\n-        TIMESPAN, TIMESTAMP, UNSIGNED, OTHER\n+        TIMESPAN, TIMESTAMP, OTHER\n@@ -123,20 +121,7 @@\n-        String name = v.getName();\n-        return switch (valueType) {\n-            case TIMESPAN -> object.getDuration(name);\n-            case TIMESTAMP -> PRIVATE_ACCESS.getOffsetDataTime(object, name);\n-            case UNSIGNED -> getUnsigned(object, name);\n-            case OTHER -> object.getValue(name);\n-        };\n-    }\n-\n-    private Object getUnsigned(RecordedObject object, String name) {\n-        \/\/ RecordedObject::getLong handles unsigned byte, short, int\n-        long value = object.getLong(name);\n-        \/\/ If unsigned long value exceeds 2^63, return (upper << 32) + lower\n-        if (value < 0) {\n-            int upper = (int) (value >>> 32);\n-            int lower = (int) value;\n-            BigInteger u = BigInteger.valueOf(Integer.toUnsignedLong(upper));\n-            u = u.shiftLeft(32);\n-            BigInteger l = BigInteger.valueOf(Integer.toUnsignedLong(lower));\n-            return u.add(l);\n+        switch (valueType) {\n+        case TIMESPAN:\n+            return object.getDuration(v.getName());\n+        case TIMESTAMP:\n+            return PRIVATE_ACCESS.getOffsetDataTime(object, v.getName());\n+        default:\n+            return object.getValue(v.getName());\n@@ -144,1 +129,0 @@\n-        return Long.valueOf(value);\n@@ -146,2 +130,1 @@\n-\n-    \/\/ Somewhat expensive operation\n+    \/\/ It's expensive t check\n@@ -155,6 +138,0 @@\n-        if (v.getAnnotation(Unsigned.class) != null) {\n-            return switch(v.getTypeName()) {\n-                case \"byte\", \"short\", \"int\", \"long\" -> ValueType.UNSIGNED;\n-                default -> ValueType.OTHER;\n-            };\n-        }\n","filename":"src\/jdk.jfr\/share\/classes\/jdk\/jfr\/internal\/tool\/EventPrintWriter.java","additions":10,"deletions":33,"binary":false,"changes":43,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2018, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2018, Oracle and\/or its affiliates. All rights reserved.\n@@ -44,1 +44,1 @@\n-        System.out.println(System.getProperty(\"java.version\"));\n+        System.out.println(\"1.0\");\n","filename":"src\/jdk.jfr\/share\/classes\/jdk\/jfr\/internal\/tool\/Version.java","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -22,1 +22,1 @@\n-.\\\" Automatically generated by Pandoc 2.19.2\n+.\\\" Automatically generated by Pandoc 2.3.1\n@@ -24,15 +24,1 @@\n-.\\\" Define V font for inline verbatim, using C font in formats\n-.\\\" that render this, and otherwise B font.\n-.ie \"\\f[CB]x\\f[R]\"x\" \\{\\\n-. ftr V B\n-. ftr VI BI\n-. ftr VB B\n-. ftr VBI BI\n-.\\}\n-.el \\{\\\n-. ftr V CR\n-. ftr VI CI\n-. ftr VB CB\n-. ftr VBI CBI\n-.\\}\n-.TH \"JFR\" \"1\" \"2023\" \"JDK 20-ea\" \"JDK Commands\"\n+.TH \"JFR\" \"1\" \"2023\" \"JDK 20\\-ea\" \"JDK Commands\"\n@@ -42,1 +28,1 @@\n-jfr - parse and print Flight Recorder files\n+jfr \\- parse and print Flight Recorder files\n@@ -47,1 +33,1 @@\n-\\f[V]jfr\\f[R] \\f[V]print\\f[R] [\\f[I]options\\f[R]] \\f[I]file\\f[R]\n+\\f[CB]jfr\\f[R] \\f[CB]print\\f[R] [\\f[I]options\\f[R]] \\f[I]file\\f[R]\n@@ -51,1 +37,1 @@\n-\\f[V]jfr\\f[R] \\f[V]metadata\\f[R] \\f[I]file\\f[R]\n+\\f[CB]jfr\\f[R] \\f[CB]metadata\\f[R] \\f[I]file\\f[R]\n@@ -55,1 +41,1 @@\n-\\f[V]jfr\\f[R] \\f[V]assemble\\f[R] \\f[I]repository\\f[R] \\f[I]file\\f[R]\n+\\f[CB]jfr\\f[R] \\f[CB]assemble\\f[R] \\f[I]repository\\f[R] \\f[I]file\\f[R]\n@@ -59,1 +45,1 @@\n-\\f[V]jfr\\f[R] \\f[V]disassmble\\f[R] [\\f[I]options\\f[R]] \\f[I]file\\f[R]\n+\\f[CB]jfr\\f[R] \\f[CB]disassmble\\f[R] [\\f[I]options\\f[R]] \\f[I]file\\f[R]\n@@ -63,1 +49,1 @@\n-\\f[V]jfr\\f[R] \\f[V]summary\\f[R] \\f[I]file\\f[R]\n+\\f[CB]jfr\\f[R] \\f[CB]summary\\f[R] \\f[I]file\\f[R]\n@@ -65,2 +51,2 @@\n-\\f[I]options\\f[R]\n-Optional: Specifies command-line options separated by spaces.\n+.B \\f[I]options\\f[R]\n+Optional: Specifies command\\-line options separated by spaces.\n@@ -69,0 +55,2 @@\n+.RS\n+.RE\n@@ -70,2 +58,5 @@\n-\\f[I]file\\f[R]\n-Specifies the name of the target flight recording file (\\f[V].jfr\\f[R]).\n+.B \\f[I]file\\f[R]\n+Specifies the name of the target flight recording file\n+(\\f[CB]\\&.jfr\\f[R]).\n+.RS\n+.RE\n@@ -73,1 +64,1 @@\n-\\f[I]repository\\f[R]\n+.B \\f[I]repository\\f[R]\n@@ -76,0 +67,2 @@\n+.RS\n+.RE\n@@ -78,2 +71,2 @@\n-The \\f[V]jfr\\f[R] command provides a tool for interacting with flight\n-recorder files (\\f[V].jfr\\f[R]).\n+The \\f[CB]jfr\\f[R] command provides a tool for interacting with flight\n+recorder files (\\f[CB]\\&.jfr\\f[R]).\n@@ -90,1 +83,1 @@\n-The \\f[V]jfr\\f[R] command has several subcommands:\n+The \\f[CB]jfr\\f[R] command has several subcommands:\n@@ -92,1 +85,1 @@\n-\\f[V]print\\f[R]\n+\\f[CB]print\\f[R]\n@@ -94,1 +87,1 @@\n-\\f[V]summary\\f[R]\n+\\f[CB]summary\\f[R]\n@@ -96,1 +89,1 @@\n-\\f[V]assemble\\f[R]\n+\\f[CB]assemble\\f[R]\n@@ -98,1 +91,1 @@\n-\\f[V]disassemble\\f[R]\n+\\f[CB]disassemble\\f[R]\n@@ -100,2 +93,2 @@\n-\\f[V]metadata\\f[R]\n-.SS \\f[V]jfr print\\f[R] subcommand\n+\\f[CB]metadata\\f[R]\n+.SS \\f[CB]jfr\\ print\\f[R] subcommand\n@@ -103,1 +96,1 @@\n-Use \\f[V]jfr print\\f[R] to print the contents of a flight recording file\n+Use \\f[CB]jfr\\ print\\f[R] to print the contents of a flight recording file\n@@ -107,3 +100,3 @@\n-\\f[V]jfr print\\f[R] [\\f[V]--xml\\f[R]|\\f[V]--json\\f[R]]\n-[\\f[V]--categories\\f[R] <\\f[I]filters\\f[R]>] [\\f[V]--events\\f[R]\n-<\\f[I]filters\\f[R]>] [\\f[V]--stack-depth\\f[R] <\\f[I]depth\\f[R]>]\n+\\f[CB]jfr\\ print\\f[R] [\\f[CB]\\-\\-xml\\f[R]|\\f[CB]\\-\\-json\\f[R]]\n+[\\f[CB]\\-\\-categories\\f[R] <\\f[I]filters\\f[R]>] [\\f[CB]\\-\\-events\\f[R]\n+<\\f[I]filters\\f[R]>] [\\f[CB]\\-\\-stack\\-depth\\f[R] <\\f[I]depth\\f[R]>]\n@@ -114,1 +107,1 @@\n-\\f[V]--xml\\f[R]\n+.B \\f[CB]\\-\\-xml\\f[R]\n@@ -116,0 +109,2 @@\n+.RS\n+.RE\n@@ -117,1 +112,1 @@\n-\\f[V]--json\\f[R]\n+.B \\f[CB]\\-\\-json\\f[R]\n@@ -119,0 +114,2 @@\n+.RS\n+.RE\n@@ -120,1 +117,1 @@\n-\\f[V]--categories\\f[R] <\\f[I]filters\\f[R]>\n+.B \\f[CB]\\-\\-categories\\f[R] <\\f[I]filters\\f[R]>\n@@ -122,1 +119,1 @@\n-The filter is a comma-separated list of names, simple and\/or qualified,\n+The filter is a comma\\-separated list of names, simple and\/or qualified,\n@@ -124,0 +121,2 @@\n+.RS\n+.RE\n@@ -125,1 +124,1 @@\n-\\f[V]--events\\f[R] <\\f[I]filters\\f[R]>\n+.B \\f[CB]\\-\\-events\\f[R] <\\f[I]filters\\f[R]>\n@@ -127,1 +126,1 @@\n-The filter is a comma-separated list of names, simple and\/or qualified,\n+The filter is a comma\\-separated list of names, simple and\/or qualified,\n@@ -129,0 +128,2 @@\n+.RS\n+.RE\n@@ -130,1 +131,1 @@\n-\\f[V]--stack-depth\\f[R] <\\f[I]depth\\f[R]>\n+.B \\f[CB]\\-\\-stack\\-depth\\f[R] <\\f[I]depth\\f[R]>\n@@ -132,0 +133,2 @@\n+.RS\n+.RE\n@@ -133,2 +136,4 @@\n-<\\f[I]file\\f[R]>\n-Location of the recording file (\\f[V].jfr\\f[R])\n+.B <\\f[I]file\\f[R]>\n+Location of the recording file (\\f[CB]\\&.jfr\\f[R])\n+.RS\n+.RE\n@@ -137,4 +142,4 @@\n-file is human readable form unless either \\f[V]xml\\f[R] or\n-\\f[V]json\\f[R] is specified.\n-These options provide machine-readable output that can be further parsed\n-or processed by user created scripts.\n+file is human readable form unless either \\f[CB]xml\\f[R] or \\f[CB]json\\f[R]\n+is specified.\n+These options provide machine\\-readable output that can be further\n+parsed or processed by user created scripts.\n@@ -142,1 +147,1 @@\n-Use \\f[V]jfr --help print\\f[R] to see example usage of filters.\n+Use \\f[CB]jfr\\ \\-\\-help\\ print\\f[R] to see example usage of filters.\n@@ -147,2 +152,2 @@\n-\\f[V]\\[at]Name\\f[R] annotation, or the category name, set by using the\n-\\f[V]\\[at]Category\\f[R] annotation.\n+\\f[CB]\\@Name\\f[R] annotation, or the category name, set by using the\n+\\f[CB]\\@Category\\f[R] annotation.\n@@ -157,1 +162,1 @@\n-\\f[V]jfr print --categories GC --events CPULoad recording.jfr\\f[R]\n+\\f[CB]jfr\\ print\\ \\-\\-categories\\ GC\\ \\-\\-events\\ CPULoad\\ recording.jfr\\f[R]\n@@ -161,1 +166,1 @@\n-For example, a field with the \\f[V]jdk.jfr.Percentage\\f[R] annotation\n+For example, a field with the \\f[CB]jdk.jfr.Percentage\\f[R] annotation\n@@ -165,1 +170,1 @@\n-increased\/decreased using the \\f[V]--stack-depth\\f[R] command-line\n+increased\/decreased using the \\f[CB]\\-\\-stack\\-depth\\f[R] command\\-line\n@@ -167,1 +172,1 @@\n-.SS \\f[V]jfr summary\\f[R] subcommand\n+.SS \\f[CB]jfr\\ summary\\f[R] subcommand\n@@ -169,1 +174,1 @@\n-Use \\f[V]jfr summary\\f[R] to print statistics for a recording.\n+Use \\f[CB]jfr\\ summary\\f[R] to print statistics for a recording.\n@@ -177,1 +182,1 @@\n-\\f[V]jfr summary\\f[R] <\\f[I]file\\f[R]>\n+\\f[CB]jfr\\ summary\\f[R] <\\f[I]file\\f[R]>\n@@ -181,3 +186,5 @@\n-<\\f[I]file\\f[R]>\n-Location of the flight recording file (\\f[V].jfr\\f[R])\n-.SS \\f[V]jfr metadata\\f[R] subcommand\n+.B <\\f[I]file\\f[R]>\n+Location of the flight recording file (\\f[CB]\\&.jfr\\f[R])\n+.RS\n+.RE\n+.SS \\f[CB]jfr\\ metadata\\f[R] subcommand\n@@ -185,1 +192,1 @@\n-Use \\f[V]jfr metadata\\f[R] to view information about events, such as\n+Use \\f[CB]jfr\\ metadata\\f[R] to view information about events, such as\n@@ -189,1 +196,1 @@\n-\\f[V]jfr metadata\\f[R] <\\f[I]file\\f[R]>\n+\\f[CB]jfr\\ metadata\\f[R] <\\f[I]file\\f[R]>\n@@ -193,3 +200,5 @@\n-<\\f[I]file\\f[R]>\n-Location of the flight recording file (\\f[V].jfr\\f[R])\n-.SS jfr \\f[V]assemble\\f[R] subcommand\n+.B <\\f[I]file\\f[R]>\n+Location of the flight recording file (\\f[CB]\\&.jfr\\f[R])\n+.RS\n+.RE\n+.SS jfr \\f[CB]assemble\\f[R] subcommand\n@@ -197,2 +206,1 @@\n-Use jfr \\f[V]assemble\\f[R] to assemble chunk files into a recording\n-file.\n+Use jfr \\f[CB]assemble\\f[R] to assemble chunk files into a recording file.\n@@ -202,1 +210,1 @@\n-\\f[V]jfr assemble\\f[R] <\\f[I]repository\\f[R]> <\\f[I]file\\f[R]>\n+\\f[CB]jfr\\ assemble\\f[R] <\\f[I]repository\\f[R]> <\\f[I]file\\f[R]>\n@@ -206,1 +214,1 @@\n-<\\f[I]repository\\f[R]>\n+.B <\\f[I]repository\\f[R]>\n@@ -208,0 +216,2 @@\n+.RS\n+.RE\n@@ -209,2 +219,4 @@\n-<\\f[I]file\\f[R]>\n-Location of the flight recording file (\\f[V].jfr\\f[R])\n+.B <\\f[I]file\\f[R]>\n+Location of the flight recording file (\\f[CB]\\&.jfr\\f[R])\n+.RS\n+.RE\n@@ -216,1 +228,1 @@\n-a flight recording file using this \\f[V]jfr assemble\\f[R] command.\n+a flight recording file using this \\f[CB]jfr\\ assemble\\f[R] command.\n@@ -219,1 +231,1 @@\n-.SS \\f[V]jfr disassemble\\f[R] subcommand\n+.SS \\f[CB]jfr\\ disassemble\\f[R] subcommand\n@@ -221,1 +233,1 @@\n-Use \\f[V]jfr disassemble\\f[R] to decompose a flight recording file into\n+Use \\f[CB]jfr\\ disassemble\\f[R] to decompose a flight recording file into\n@@ -225,2 +237,2 @@\n-\\f[V]jfr disassemble\\f[R] [\\f[V]--max-chunks\\f[R] <\\f[I]chunks\\f[R]>]\n-[\\f[V]--output\\f[R] <\\f[I]directory\\f[R]>] <\\f[I]file\\f[R]>\n+\\f[CB]jfr\\ disassemble\\f[R] [\\f[CB]\\-\\-max\\-chunks\\f[R] <\\f[I]chunks\\f[R]>]\n+[\\f[CB]\\-\\-output\\f[R] <\\f[I]directory\\f[R]>] <\\f[I]file\\f[R]>\n@@ -230,1 +242,1 @@\n-\\f[V]--output\\f[R] <\\f[I]directory\\f[R]>\n+.B \\f[CB]\\-\\-output\\f[R] <\\f[I]directory\\f[R]>\n@@ -233,0 +245,2 @@\n+.RS\n+.RE\n@@ -234,1 +248,1 @@\n-\\f[V]--max-chunks\\f[R] <\\f[I]chunks\\f[R]>\n+.B \\f[CB]\\-\\-max\\-chunks\\f[R] <\\f[I]chunks\\f[R]>\n@@ -237,0 +251,2 @@\n+.RS\n+.RE\n@@ -238,1 +254,1 @@\n-\\f[V]--max-size\\f[R] <\\f[I]size\\f[R]>\n+.B \\f[CB]\\-\\-max\\-size\\f[R] <\\f[I]size\\f[R]>\n@@ -240,0 +256,2 @@\n+.RS\n+.RE\n@@ -241,2 +259,4 @@\n-<\\f[I]file\\f[R]>\n-Location of the flight recording file (\\f[V].jfr\\f[R])\n+.B <\\f[I]file\\f[R]>\n+Location of the flight recording file (\\f[CB]\\&.jfr\\f[R])\n+.RS\n+.RE\n@@ -248,2 +268,2 @@\n-The resulting chunk files are named \\f[V]myfile_1.jfr\\f[R],\n-\\f[V]myfile_2.jfr\\f[R], etc.\n+The resulting chunk files are named \\f[CB]myfile_1.jfr\\f[R],\n+\\f[CB]myfile_2.jfr\\f[R], etc.\n@@ -252,1 +272,1 @@\n-For example, the chunk file name is \\f[V]myfile_001.jfr\\f[R] if the\n+For example, the chunk file name is \\f[CB]myfile_001.jfr\\f[R] if the\n@@ -256,2 +276,2 @@\n-Use \\f[V]jfr --version\\f[R] or \\f[V]jfr version\\f[R] to view the version\n-string information for this jfr command.\n+Use \\f[CB]jfr\\ \\-\\-version\\f[R] or \\f[CB]jfr\\ version\\f[R] to view the\n+version string information for this jfr command.\n@@ -261,1 +281,1 @@\n-\\f[V]jfr <--help|help>\\f[R] [\\f[I]subcommand\\f[R]]\n+\\f[CB]jfr\\ <\\-\\-help|help>\\f[R] [\\f[I]subcommand\\f[R]]\n@@ -267,1 +287,1 @@\n-\\f[V]print\\f[R]\n+\\f[CB]print\\f[R]\n@@ -269,1 +289,1 @@\n-\\f[V]metadata\\f[R]\n+\\f[CB]metadata\\f[R]\n@@ -271,1 +291,1 @@\n-\\f[V]summary\\f[R]\n+\\f[CB]summary\\f[R]\n@@ -273,1 +293,1 @@\n-\\f[V]assemble\\f[R]\n+\\f[CB]assemble\\f[R]\n@@ -275,1 +295,1 @@\n-\\f[V]disassemble\\f[R]\n+\\f[CB]disassemble\\f[R]\n","filename":"src\/jdk.jfr\/share\/man\/jfr.1","additions":117,"deletions":97,"binary":false,"changes":214,"status":"modified"},{"patch":"@@ -22,1 +22,1 @@\n-.\\\" Automatically generated by Pandoc 2.19.2\n+.\\\" Automatically generated by Pandoc 2.3.1\n@@ -24,15 +24,1 @@\n-.\\\" Define V font for inline verbatim, using C font in formats\n-.\\\" that render this, and otherwise B font.\n-.ie \"\\f[CB]x\\f[R]\"x\" \\{\\\n-. ftr V B\n-. ftr VI BI\n-. ftr VB B\n-. ftr VBI BI\n-.\\}\n-.el \\{\\\n-. ftr V CR\n-. ftr VI CI\n-. ftr VB CB\n-. ftr VBI CBI\n-.\\}\n-.TH \"JLINK\" \"1\" \"2023\" \"JDK 20-ea\" \"JDK Commands\"\n+.TH \"JLINK\" \"1\" \"2023\" \"JDK 20\\-ea\" \"JDK Commands\"\n@@ -42,1 +28,1 @@\n-jlink - assemble and optimize a set of modules and their dependencies\n+jlink \\- assemble and optimize a set of modules and their dependencies\n@@ -46,2 +32,2 @@\n-\\f[V]jlink\\f[R] [\\f[I]options\\f[R]] \\f[V]--module-path\\f[R]\n-\\f[I]modulepath\\f[R] \\f[V]--add-modules\\f[R] \\f[I]module\\f[R] [,\n+\\f[CB]jlink\\f[R] [\\f[I]options\\f[R]] \\f[CB]\\-\\-module\\-path\\f[R]\n+\\f[I]modulepath\\f[R] \\f[CB]\\-\\-add\\-modules\\f[R] \\f[I]module\\f[R] [,\n@@ -50,2 +36,2 @@\n-\\f[I]options\\f[R]\n-Command-line options separated by spaces.\n+.B \\f[I]options\\f[R]\n+Command\\-line options separated by spaces.\n@@ -53,0 +39,2 @@\n+.RS\n+.RE\n@@ -54,2 +42,2 @@\n-\\f[I]modulepath\\f[R]\n-The path where the \\f[V]jlink\\f[R] tool discovers observable modules.\n+.B \\f[I]modulepath\\f[R]\n+The path where the \\f[CB]jlink\\f[R] tool discovers observable modules.\n@@ -57,0 +45,2 @@\n+.RS\n+.RE\n@@ -58,1 +48,1 @@\n-\\f[I]module\\f[R]\n+.B \\f[I]module\\f[R]\n@@ -60,1 +50,1 @@\n-The \\f[V]jlink\\f[R] tool adds these modules and their transitive\n+The \\f[CB]jlink\\f[R] tool adds these modules and their transitive\n@@ -62,0 +52,2 @@\n+.RS\n+.RE\n@@ -64,1 +56,1 @@\n-The \\f[V]jlink\\f[R] tool links a set of modules, along with their\n+The \\f[CB]jlink\\f[R] tool links a set of modules, along with their\n@@ -72,1 +64,1 @@\n-\\f[V]--add-modules\\f[R] \\f[I]mod\\f[R] [\\f[V],\\f[R] \\f[I]mod\\f[R]...]\n+.B \\f[CB]\\-\\-add\\-modules\\f[R] \\f[I]mod\\f[R] [\\f[CB],\\f[R] \\f[I]mod\\f[R]...]\n@@ -76,0 +68,2 @@\n+.RS\n+.RE\n@@ -77,1 +71,1 @@\n-\\f[V]--bind-services\\f[R]\n+.B \\f[CB]\\-\\-bind\\-services\\f[R]\n@@ -79,0 +73,2 @@\n+.RS\n+.RE\n@@ -80,1 +76,1 @@\n-\\f[V]-c ={0|1|2}\\f[R] or \\f[V]--compress={0|1|2}\\f[R]\n+.B \\f[CB]\\-c\\ ={0|1|2}\\f[R] or \\f[CB]\\-\\-compress={0|1|2}\\f[R]\n@@ -84,1 +80,1 @@\n-\\f[V]0\\f[R]: No compression\n+\\f[CB]0\\f[R]: No compression\n@@ -86,1 +82,1 @@\n-\\f[V]1\\f[R]: Constant string sharing\n+\\f[CB]1\\f[R]: Constant string sharing\n@@ -88,1 +84,1 @@\n-\\f[V]2\\f[R]: ZIP\n+\\f[CB]2\\f[R]: ZIP\n@@ -91,3 +87,5 @@\n-\\f[V]--disable-plugin\\f[R] \\f[I]pluginname\\f[R]\n-Disables the specified plug-in.\n-See \\f[B]jlink Plug-ins\\f[R] for the list of supported plug-ins.\n+.B \\f[CB]\\-\\-disable\\-plugin\\f[R] \\f[I]pluginname\\f[R]\n+Disables the specified plug\\-in.\n+See \\f[B]jlink Plug\\-ins\\f[R] for the list of supported plug\\-ins.\n+.RS\n+.RE\n@@ -95,1 +93,1 @@\n-\\f[V]--endian\\f[R] {\\f[V]little\\f[R]|\\f[V]big\\f[R]}\n+.B \\f[CB]\\-\\-endian\\f[R] {\\f[CB]little\\f[R]|\\f[CB]big\\f[R]}\n@@ -98,0 +96,2 @@\n+.RS\n+.RE\n@@ -99,1 +99,1 @@\n-\\f[V]-h\\f[R] or \\f[V]--help\\f[R]\n+.B \\f[CB]\\-h\\f[R] or \\f[CB]\\-\\-help\\f[R]\n@@ -101,0 +101,2 @@\n+.RS\n+.RE\n@@ -102,1 +104,1 @@\n-\\f[V]--ignore-signing-information\\f[R]\n+.B \\f[CB]\\-\\-ignore\\-signing\\-information\\f[R]\n@@ -105,2 +107,4 @@\n-The signature-related files of the signed modular JARs aren\\[aq]t copied\n-to the runtime image.\n+The signature\\-related files of the signed modular JARs aren\\[aq]t\n+copied to the runtime image.\n+.RS\n+.RE\n@@ -108,1 +112,1 @@\n-\\f[V]--launcher\\f[R] \\f[I]command\\f[R]\\f[V]=\\f[R]\\f[I]module\\f[R] or \\f[V]--launcher\\f[R] \\f[I]command\\f[R]\\f[V]=\\f[R]\\f[I]module\\f[R]\\f[V]\/\\f[R]\\f[I]main\\f[R]\n+.B \\f[CB]\\-\\-launcher\\f[R] \\f[I]command\\f[R]\\f[CB]=\\f[R]\\f[I]module\\f[R] or \\f[CB]\\-\\-launcher\\f[R] \\f[I]command\\f[R]\\f[CB]=\\f[R]\\f[I]module\\f[R]\\f[CB]\/\\f[R]\\f[I]main\\f[R]\n@@ -111,1 +115,3 @@\n-separated by a slash (\\f[V]\/\\f[R])).\n+separated by a slash (\\f[CB]\/\\f[R])).\n+.RS\n+.RE\n@@ -113,1 +119,1 @@\n-\\f[V]--limit-modules\\f[R] \\f[I]mod\\f[R] [\\f[V],\\f[R] \\f[I]mod\\f[R]...]\n+.B \\f[CB]\\-\\-limit\\-modules\\f[R] \\f[I]mod\\f[R] [\\f[CB],\\f[R] \\f[I]mod\\f[R]...]\n@@ -115,2 +121,2 @@\n-closure of the named modules, \\f[V]mod\\f[R], plus the main module, if\n-any, plus any further modules specified in the \\f[V]--add-modules\\f[R]\n+closure of the named modules, \\f[CB]mod\\f[R], plus the main module, if\n+any, plus any further modules specified in the \\f[CB]\\-\\-add\\-modules\\f[R]\n@@ -118,0 +124,2 @@\n+.RS\n+.RE\n@@ -119,3 +127,5 @@\n-\\f[V]--list-plugins\\f[R]\n-Lists available plug-ins, which you can access through command-line\n-options; see \\f[B]jlink Plug-ins\\f[R].\n+.B \\f[CB]\\-\\-list\\-plugins\\f[R]\n+Lists available plug\\-ins, which you can access through command\\-line\n+options; see \\f[B]jlink Plug\\-ins\\f[R].\n+.RS\n+.RE\n@@ -123,1 +133,1 @@\n-\\f[V]-p\\f[R] or \\f[V]--module-path\\f[R] \\f[I]modulepath\\f[R]\n+.B \\f[CB]\\-p\\f[R] or \\f[CB]\\-\\-module\\-path\\f[R] \\f[I]modulepath\\f[R]\n@@ -128,2 +138,2 @@\n-\\f[V]$JAVA_HOME\/jmods\\f[R].\n-This directory contains the \\f[V]java.base\\f[R] module and the other\n+\\f[CB]$JAVA_HOME\/jmods\\f[R].\n+This directory contains the \\f[CB]java.base\\f[R] module and the other\n@@ -131,3 +141,3 @@\n-If this option is specified but the \\f[V]java.base\\f[R] module cannot be\n-resolved from it, then the \\f[V]jlink\\f[R] command appends\n-\\f[V]$JAVA_HOME\/jmods\\f[R] to the module path.\n+If this option is specified but the \\f[CB]java.base\\f[R] module cannot be\n+resolved from it, then the \\f[CB]jlink\\f[R] command appends\n+\\f[CB]$JAVA_HOME\/jmods\\f[R] to the module path.\n@@ -136,1 +146,1 @@\n-\\f[V]--no-header-files\\f[R]\n+.B \\f[CB]\\-\\-no\\-header\\-files\\f[R]\n@@ -138,0 +148,2 @@\n+.RS\n+.RE\n@@ -139,1 +151,1 @@\n-\\f[V]--no-man-pages\\f[R]\n+.B \\f[CB]\\-\\-no\\-man\\-pages\\f[R]\n@@ -141,0 +153,2 @@\n+.RS\n+.RE\n@@ -142,1 +156,1 @@\n-\\f[V]--output\\f[R] \\f[I]path\\f[R]\n+.B \\f[CB]\\-\\-output\\f[R] \\f[I]path\\f[R]\n@@ -144,0 +158,2 @@\n+.RS\n+.RE\n@@ -145,2 +161,4 @@\n-\\f[V]--save-opts\\f[R] \\f[I]filename\\f[R]\n-Saves \\f[V]jlink\\f[R] options in the specified file.\n+.B \\f[CB]\\-\\-save\\-opts\\f[R] \\f[I]filename\\f[R]\n+Saves \\f[CB]jlink\\f[R] options in the specified file.\n+.RS\n+.RE\n@@ -148,1 +166,1 @@\n-\\f[V]--suggest-providers\\f[R] [\\f[I]name\\f[R]\\f[V],\\f[R] ...]\n+.B \\f[CB]\\-\\-suggest\\-providers\\f[R] [\\f[I]name\\f[R]\\f[CB],\\f[R] ...]\n@@ -151,0 +169,2 @@\n+.RS\n+.RE\n@@ -152,1 +172,1 @@\n-\\f[V]--version\\f[R]\n+.B \\f[CB]\\-\\-version\\f[R]\n@@ -154,0 +174,2 @@\n+.RS\n+.RE\n@@ -155,1 +177,1 @@\n-\\f[V]\\[at]\\f[R]\\f[I]filename\\f[R]\n+.B \\f[CB]\\@\\f[R]\\f[I]filename\\f[R]\n@@ -163,2 +185,2 @@\n-You may comment out lines by prefixing a hash symbol (\\f[V]#\\f[R]) to\n-the beginning of the line.\n+You may comment out lines by prefixing a hash symbol (\\f[CB]#\\f[R]) to the\n+beginning of the line.\n@@ -166,1 +188,1 @@\n-The following is an example of an options file for the \\f[V]jlink\\f[R]\n+The following is an example of an options file for the \\f[CB]jlink\\f[R]\n@@ -171,4 +193,4 @@\n-#Wed Dec 07 00:40:19 EST 2016\n---module-path mlib\n---add-modules com.greetings\n---output greetingsapp\n+#Wed\\ Dec\\ 07\\ 00:40:19\\ EST\\ 2016\n+\\-\\-module\\-path\\ mlib\n+\\-\\-add\\-modules\\ com.greetings\n+\\-\\-output\\ greetingsapp\n@@ -178,1 +200,1 @@\n-.SH JLINK PLUG-INS\n+.SH JLINK PLUG\\-INS\n@@ -182,2 +204,2 @@\n-Plug-ins not listed in this section aren\\[aq]t supported and are subject\n-to change.\n+Plug\\-ins not listed in this section aren\\[aq]t supported and are\n+subject to change.\n@@ -185,2 +207,2 @@\n-For plug-in options that require a \\f[I]pattern-list\\f[R], the value is\n-a comma-separated list of elements, with each element using one the\n+For plug\\-in options that require a \\f[I]pattern\\-list\\f[R], the value is\n+a comma\\-separated list of elements, with each element using one the\n@@ -189,1 +211,1 @@\n-\\f[I]glob-pattern\\f[R]\n+\\f[I]glob\\-pattern\\f[R]\n@@ -191,1 +213,1 @@\n-\\f[V]glob:\\f[R]\\f[I]glob-pattern\\f[R]\n+\\f[CB]glob:\\f[R]\\f[I]glob\\-pattern\\f[R]\n@@ -193,1 +215,1 @@\n-\\f[V]regex:\\f[R]\\f[I]regex-pattern\\f[R]\n+\\f[CB]regex:\\f[R]\\f[I]regex\\-pattern\\f[R]\n@@ -195,1 +217,1 @@\n-\\f[V]\\[at]\\f[R]\\f[I]filename\\f[R]\n+\\f[CB]\\@\\f[R]\\f[I]filename\\f[R]\n@@ -202,3 +224,3 @@\n-For a complete list of all available plug-ins, run the command\n-\\f[V]jlink --list-plugins\\f[R].\n-.SS Plugin \\f[V]compress\\f[R]\n+For a complete list of all available plug\\-ins, run the command\n+\\f[CB]jlink\\ \\-\\-list\\-plugins\\f[R].\n+.SS Plugin \\f[CB]compress\\f[R]\n@@ -206,2 +228,4 @@\n-Options\n-\\f[V]--compress=\\f[R]{\\f[V]0\\f[R]|\\f[V]1\\f[R]|\\f[V]2\\f[R]}[\\f[V]:filter=\\f[R]\\f[I]pattern-list\\f[R]]\n+.B Options\n+\\f[CB]\\-\\-compress=\\f[R]{\\f[CB]0\\f[R]|\\f[CB]1\\f[R]|\\f[CB]2\\f[R]}[\\f[CB]:filter=\\f[R]\\f[I]pattern\\-list\\f[R]]\n+.RS\n+.RE\n@@ -209,1 +233,1 @@\n-Description\n+.B Description\n@@ -219,1 +243,1 @@\n-An optional \\f[I]pattern-list\\f[R] filter can be specified to list the\n+An optional \\f[I]pattern\\-list\\f[R] filter can be specified to list the\n@@ -222,1 +246,1 @@\n-.SS Plugin \\f[V]include-locales\\f[R]\n+.SS Plugin \\f[CB]include\\-locales\\f[R]\n@@ -224,2 +248,4 @@\n-Options\n-\\f[V]--include-locales=\\f[R]\\f[I]langtag\\f[R][\\f[V],\\f[R]\\f[I]langtag\\f[R]]*\n+.B Options\n+\\f[CB]\\-\\-include\\-locales=\\f[R]\\f[I]langtag\\f[R][\\f[CB],\\f[R]\\f[I]langtag\\f[R]]*\n+.RS\n+.RE\n@@ -227,3 +253,3 @@\n-Description\n-Includes the list of locales where \\f[I]langtag\\f[R] is a BCP 47\n-language tag.\n+.B Description\n+Includes the list of locales where \\f[I]langtag\\f[R] is a BCP 47 language\n+tag.\n@@ -237,1 +263,1 @@\n-\\f[V]--add-modules jdk.localedata --include-locales=en,ja,*-IN\\f[R]\n+\\f[CB]\\-\\-add\\-modules\\ jdk.localedata\\ \\-\\-include\\-locales=en,ja,*\\-IN\\f[R]\n@@ -240,1 +266,1 @@\n-.SS Plugin \\f[V]order-resources\\f[R]\n+.SS Plugin \\f[CB]order\\-resources\\f[R]\n@@ -242,2 +268,4 @@\n-Options\n-\\f[V]--order-resources=\\f[R]\\f[I]pattern-list\\f[R]\n+.B Options\n+\\f[CB]\\-\\-order\\-resources=\\f[R]\\f[I]pattern\\-list\\f[R]\n+.RS\n+.RE\n@@ -245,1 +273,1 @@\n-Description\n+.B Description\n@@ -247,2 +275,2 @@\n-If \\f[V]\\[at]\\f[R]\\f[I]filename\\f[R] is specified, then each line in\n-\\f[I]pattern-list\\f[R] must be an exact match for the paths to be\n+If \\f[CB]\\@\\f[R]\\f[I]filename\\f[R] is specified, then each line in\n+\\f[I]pattern\\-list\\f[R] must be an exact match for the paths to be\n@@ -255,1 +283,1 @@\n-\\f[V]--order-resources=\/module-info.class,\\[at]classlist,\/java.base\/java\/lang\/\\f[R]\n+\\f[CB]\\-\\-order\\-resources=\/module\\-info.class,\\@classlist,\/java.base\/java\/lang\/\\f[R]\n@@ -258,1 +286,1 @@\n-.SS Plugin \\f[V]strip-debug\\f[R]\n+.SS Plugin \\f[CB]strip\\-debug\\f[R]\n@@ -260,2 +288,4 @@\n-Options\n-\\f[V]--strip-debug\\f[R]\n+.B Options\n+\\f[CB]\\-\\-strip\\-debug\\f[R]\n+.RS\n+.RE\n@@ -263,1 +293,1 @@\n-Description\n+.B Description\n@@ -265,1 +295,3 @@\n-.SS Plugin \\f[V]generate-cds-archive\\f[R]\n+.RS\n+.RE\n+.SS Plugin \\f[CB]generate\\-cds\\-archive\\f[R]\n@@ -267,2 +299,4 @@\n-Options\n-\\f[V]--generate-cds-archive\\f[R]\n+.B Options\n+\\f[CB]\\-\\-generate\\-cds\\-archive\\f[R]\n+.RS\n+.RE\n@@ -270,1 +304,1 @@\n-Description\n+.B Description\n@@ -272,0 +306,2 @@\n+.RS\n+.RE\n@@ -275,3 +311,3 @@\n-\\f[V]greetingsapp\\f[R].\n-This command links the module \\f[V]com.greetings\\f[R], whose module\n-definition is contained in the directory \\f[V]mlib\\f[R].\n+\\f[CB]greetingsapp\\f[R].\n+This command links the module \\f[CB]com.greetings\\f[R], whose module\n+definition is contained in the directory \\f[CB]mlib\\f[R].\n@@ -281,1 +317,1 @@\n-jlink --module-path mlib --add-modules com.greetings --output greetingsapp\n+jlink\\ \\-\\-module\\-path\\ mlib\\ \\-\\-add\\-modules\\ com.greetings\\ \\-\\-output\\ greetingsapp\n@@ -286,1 +322,1 @@\n-\\f[V]greetingsapp\\f[R]:\n+\\f[CB]greetingsapp\\f[R]:\n@@ -290,1 +326,1 @@\n-greetingsapp\/bin\/java --list-modules\n+greetingsapp\/bin\/java\\ \\-\\-list\\-modules\n@@ -292,3 +328,3 @@\n-java.base\\[at]11\n-java.logging\\[at]11\n-org.astro\\[at]1.0\n+java.base\\@11\n+java.logging\\@11\n+org.astro\\@1.0\n@@ -304,1 +340,1 @@\n-jlink --add-modules jdk.localedata --strip-debug --compress=2 --include-locales=fr --output compressedrt\n+jlink\\ \\-\\-add\\-modules\\ jdk.localedata\\ \\-\\-strip\\-debug\\ \\-\\-compress=2\\ \\-\\-include\\-locales=fr\\ \\-\\-output\\ compressedrt\n@@ -309,1 +345,1 @@\n-\\f[V]compressedrt\\f[R] with \\f[V]fr_rt\\f[R], which isn\\[aq]t stripped of\n+\\f[CB]compressedrt\\f[R] with \\f[CB]fr_rt\\f[R], which isn\\[aq]t stripped of\n@@ -314,1 +350,1 @@\n-jlink --add-modules jdk.localedata --include-locales=fr --output fr_rt\n+jlink\\ \\-\\-add\\-modules\\ jdk.localedata\\ \\-\\-include\\-locales=fr\\ \\-\\-output\\ fr_rt\n@@ -316,3 +352,3 @@\n-du -sh .\/compressedrt .\/fr_rt\n-23M     .\/compressedrt\n-36M     .\/fr_rt\n+du\\ \\-sh\\ .\/compressedrt\\ .\/fr_rt\n+23M\\ \\ \\ \\ \\ .\/compressedrt\n+36M\\ \\ \\ \\ \\ .\/fr_rt\n@@ -323,1 +359,1 @@\n-\\f[V]java.security.Provider\\f[R]:\n+\\f[CB]java.security.Provider\\f[R]:\n@@ -327,1 +363,1 @@\n-jlink --suggest-providers java.security.Provider\n+jlink\\ \\-\\-suggest\\-providers\\ java.security.Provider\n@@ -329,10 +365,10 @@\n-Suggested providers:\n-  java.naming provides java.security.Provider used by java.base\n-  java.security.jgss provides java.security.Provider used by java.base\n-  java.security.sasl provides java.security.Provider used by java.base\n-  java.smartcardio provides java.security.Provider used by java.base\n-  java.xml.crypto provides java.security.Provider used by java.base\n-  jdk.crypto.cryptoki provides java.security.Provider used by java.base\n-  jdk.crypto.ec provides java.security.Provider used by java.base\n-  jdk.crypto.mscapi provides java.security.Provider used by java.base\n-  jdk.security.jgss provides java.security.Provider used by java.base\n+Suggested\\ providers:\n+\\ \\ java.naming\\ provides\\ java.security.Provider\\ used\\ by\\ java.base\n+\\ \\ java.security.jgss\\ provides\\ java.security.Provider\\ used\\ by\\ java.base\n+\\ \\ java.security.sasl\\ provides\\ java.security.Provider\\ used\\ by\\ java.base\n+\\ \\ java.smartcardio\\ provides\\ java.security.Provider\\ used\\ by\\ java.base\n+\\ \\ java.xml.crypto\\ provides\\ java.security.Provider\\ used\\ by\\ java.base\n+\\ \\ jdk.crypto.cryptoki\\ provides\\ java.security.Provider\\ used\\ by\\ java.base\n+\\ \\ jdk.crypto.ec\\ provides\\ java.security.Provider\\ used\\ by\\ java.base\n+\\ \\ jdk.crypto.mscapi\\ provides\\ java.security.Provider\\ used\\ by\\ java.base\n+\\ \\ jdk.security.jgss\\ provides\\ java.security.Provider\\ used\\ by\\ java.base\n@@ -343,2 +379,2 @@\n-\\f[V]mybuild\\f[R] that includes only \\f[V]java.naming\\f[R] and\n-\\f[V]jdk.crypto.cryptoki\\f[R] and their dependencies but no other\n+\\f[CB]mybuild\\f[R] that includes only \\f[CB]java.naming\\f[R] and\n+\\f[CB]jdk.crypto.cryptoki\\f[R] and their dependencies but no other\n@@ -350,1 +386,1 @@\n-jlink --add-modules java.naming,jdk.crypto.cryptoki --output mybuild\n+jlink\\ \\-\\-add\\-modules\\ java.naming,jdk.crypto.cryptoki\\ \\-\\-output\\ mybuild\n@@ -355,1 +391,1 @@\n-named \\f[V]greetingsapp\\f[R], except that it will link the modules\n+named \\f[CB]greetingsapp\\f[R], except that it will link the modules\n@@ -357,1 +393,1 @@\n-\\f[B]\\f[VB]Configuration.resolveAndBind\\f[B]\\f[R] method.\n+\\f[B]\\f[BC]Configuration.resolveAndBind\\f[B]\\f[R] method.\n@@ -361,1 +397,1 @@\n-jlink --module-path mlib --add-modules com.greetings --output greetingsapp --bind-services\n+jlink\\ \\-\\-module\\-path\\ mlib\\ \\-\\-add\\-modules\\ com.greetings\\ \\-\\-output\\ greetingsapp\\ \\-\\-bind\\-services\n@@ -370,1 +406,1 @@\n-greetingsapp\/bin\/java --list-modules\n+greetingsapp\/bin\/java\\ \\-\\-list\\-modules\n@@ -372,36 +408,36 @@\n-java.base\\[at]11\n-java.compiler\\[at]11\n-java.datatransfer\\[at]11\n-java.desktop\\[at]11\n-java.logging\\[at]11\n-java.management\\[at]11\n-java.management.rmi\\[at]11\n-java.naming\\[at]11\n-java.prefs\\[at]11\n-java.rmi\\[at]11\n-java.security.jgss\\[at]11\n-java.security.sasl\\[at]11\n-java.smartcardio\\[at]11\n-java.xml\\[at]11\n-java.xml.crypto\\[at]11\n-jdk.accessibility\\[at]11\n-jdk.charsets\\[at]11\n-jdk.compiler\\[at]11\n-jdk.crypto.cryptoki\\[at]11\n-jdk.crypto.ec\\[at]11\n-jdk.crypto.mscapi\\[at]11\n-jdk.internal.opt\\[at]11\n-jdk.jartool\\[at]11\n-jdk.javadoc\\[at]11\n-jdk.jdeps\\[at]11\n-jdk.jfr\\[at]11\n-jdk.jlink\\[at]11\n-jdk.localedata\\[at]11\n-jdk.management\\[at]11\n-jdk.management.jfr\\[at]11\n-jdk.naming.dns\\[at]11\n-jdk.naming.rmi\\[at]11\n-jdk.security.auth\\[at]11\n-jdk.security.jgss\\[at]11\n-jdk.zipfs\\[at]11\n-org.astro\\[at]1.0\n+java.base\\@11\n+java.compiler\\@11\n+java.datatransfer\\@11\n+java.desktop\\@11\n+java.logging\\@11\n+java.management\\@11\n+java.management.rmi\\@11\n+java.naming\\@11\n+java.prefs\\@11\n+java.rmi\\@11\n+java.security.jgss\\@11\n+java.security.sasl\\@11\n+java.smartcardio\\@11\n+java.xml\\@11\n+java.xml.crypto\\@11\n+jdk.accessibility\\@11\n+jdk.charsets\\@11\n+jdk.compiler\\@11\n+jdk.crypto.cryptoki\\@11\n+jdk.crypto.ec\\@11\n+jdk.crypto.mscapi\\@11\n+jdk.internal.opt\\@11\n+jdk.jartool\\@11\n+jdk.javadoc\\@11\n+jdk.jdeps\\@11\n+jdk.jfr\\@11\n+jdk.jlink\\@11\n+jdk.localedata\\@11\n+jdk.management\\@11\n+jdk.management.jfr\\@11\n+jdk.naming.dns\\@11\n+jdk.naming.rmi\\@11\n+jdk.security.auth\\@11\n+jdk.security.jgss\\@11\n+jdk.zipfs\\@11\n+org.astro\\@1.0\n","filename":"src\/jdk.jlink\/share\/man\/jlink.1","additions":213,"deletions":177,"binary":false,"changes":390,"status":"modified"},{"patch":"@@ -1,1 +1,1 @@\n-.\\\" Copyright (c) 2017, 2022, Oracle and\/or its affiliates. All rights reserved.\n+.\\\" Copyright (c) 2017, 2021, Oracle and\/or its affiliates. All rights reserved.\n@@ -22,1 +22,1 @@\n-.\\\" Automatically generated by Pandoc 2.19.2\n+.\\\" Automatically generated by Pandoc 2.3.1\n@@ -24,15 +24,1 @@\n-.\\\" Define V font for inline verbatim, using C font in formats\n-.\\\" that render this, and otherwise B font.\n-.ie \"\\f[CB]x\\f[R]\"x\" \\{\\\n-. ftr V B\n-. ftr VI BI\n-. ftr VB B\n-. ftr VBI BI\n-.\\}\n-.el \\{\\\n-. ftr V CR\n-. ftr VI CI\n-. ftr VB CB\n-. ftr VBI CBI\n-.\\}\n-.TH \"JMOD\" \"1\" \"2023\" \"JDK 20-ea\" \"JDK Commands\"\n+.TH \"JMOD\" \"1\" \"2023\" \"JDK 20\\-ea\" \"JDK Commands\"\n@@ -42,1 +28,1 @@\n-jmod - create JMOD files and list the content of existing JMOD files\n+jmod \\- create JMOD files and list the content of existing JMOD files\n@@ -45,3 +31,3 @@\n-\\f[V]jmod\\f[R]\n-(\\f[V]create\\f[R]|\\f[V]extract\\f[R]|\\f[V]list\\f[R]|\\f[V]describe\\f[R]|\\f[V]hash\\f[R])\n-[\\f[I]options\\f[R]] \\f[I]jmod-file\\f[R]\n+\\f[CB]jmod\\f[R]\n+(\\f[CB]create\\f[R]|\\f[CB]extract\\f[R]|\\f[CB]list\\f[R]|\\f[CB]describe\\f[R]|\\f[CB]hash\\f[R])\n+[\\f[I]options\\f[R]] \\f[I]jmod\\-file\\f[R]\n@@ -53,1 +39,1 @@\n-\\f[V]create\\f[R]\n+.B \\f[CB]create\\f[R]\n@@ -55,0 +41,2 @@\n+.RS\n+.RE\n@@ -56,1 +44,1 @@\n-\\f[V]extract\\f[R]\n+.B \\f[CB]extract\\f[R]\n@@ -58,0 +46,2 @@\n+.RS\n+.RE\n@@ -59,1 +49,1 @@\n-\\f[V]list\\f[R]\n+.B \\f[CB]list\\f[R]\n@@ -61,0 +51,2 @@\n+.RS\n+.RE\n@@ -62,1 +54,1 @@\n-\\f[V]describe\\f[R]\n+.B \\f[CB]describe\\f[R]\n@@ -64,0 +56,2 @@\n+.RS\n+.RE\n@@ -65,1 +59,1 @@\n-\\f[V]hash\\f[R]\n+.B \\f[CB]hash\\f[R]\n@@ -68,0 +62,2 @@\n+.RS\n+.RE\n@@ -71,1 +67,1 @@\n-\\f[I]options\\f[R]\n+.B \\f[I]options\\f[R]\n@@ -73,0 +69,2 @@\n+.RS\n+.RE\n@@ -76,1 +74,1 @@\n-\\f[I]jmod-file\\f[R]\n+.B \\f[I]jmod\\-file\\f[R]\n@@ -79,0 +77,2 @@\n+.RS\n+.RE\n@@ -84,1 +84,1 @@\n-The \\f[V]jmod\\f[R] tool is intended for modules that have native\n+The \\f[CB]jmod\\f[R] tool is intended for modules that have native\n@@ -89,1 +89,1 @@\n-\\f[V].class\\f[R] files, metadata, and resources.\n+\\f[CB]\\&.class\\f[R] files, metadata, and resources.\n@@ -93,1 +93,1 @@\n-Many \\f[V]jmod\\f[R] options involve specifying a path whose contents are\n+Many \\f[CB]jmod\\f[R] options involve specifying a path whose contents are\n@@ -97,1 +97,1 @@\n-the pattern specified by the \\f[V]--exclude\\f[R] option.\n+the pattern specified by the \\f[CB]\\-\\-exclude\\f[R] option.\n@@ -99,1 +99,1 @@\n-With the \\f[V]--hash-modules\\f[R] option or the \\f[V]jmod hash\\f[R]\n+With the \\f[CB]\\-\\-hash\\-modules\\f[R] option or the \\f[CB]jmod\\ hash\\f[R]\n@@ -101,3 +101,3 @@\n-content of the modules that are allowed to depend upon it, thus\n-\\[dq]tying\\[dq] together these modules.\n-This enables a package to be exported to one or more specifically-named\n+content of the modules that are allowed to depend upon it, thus \"tying\"\n+together these modules.\n+This enables a package to be exported to one or more specifically\\-named\n@@ -109,1 +109,1 @@\n-\\f[V]--class-path\\f[R] \\f[I]path\\f[R]\n+.B \\f[CB]\\-\\-class\\-path\\f[R] \\f[I]path\\f[R]\n@@ -112,0 +112,2 @@\n+.RS\n+.RE\n@@ -113,1 +115,1 @@\n-\\f[V]--cmds\\f[R] \\f[I]path\\f[R]\n+.B \\f[CB]\\-\\-cmds\\f[R] \\f[I]path\\f[R]\n@@ -116,0 +118,2 @@\n+.RS\n+.RE\n@@ -117,10 +121,5 @@\n-\\f[V]--compress\\f[R] \\f[I]compress\\f[R]\n-Specifies the compression to use in creating the JMOD file.\n-The accepted values are \\f[V]zip-[0-9]\\f[R], where \\f[V]zip-0\\f[R]\n-provides no compression, and \\f[V]zip-9\\f[R] provides the best\n-compression.\n-Default is \\f[V]zip-6\\f[R].\n-.TP\n-\\f[V]--config\\f[R] \\f[I]path\\f[R]\n-Specifies the location of user-editable configuration files to copy into\n-the resulting JMOD file.\n+.B \\f[CB]\\-\\-config\\f[R] \\f[I]path\\f[R]\n+Specifies the location of user\\-editable configuration files to copy\n+into the resulting JMOD file.\n+.RS\n+.RE\n@@ -128,4 +127,6 @@\n-\\f[V]--date\\f[R]\\f[I]TIMESTAMP\\f[R]\n-The timestamp in ISO-8601 extended offset date-time with optional\n-time-zone format, to use for the timestamp of the entries, e.g.\n-\\[dq]2022-02-12T12:30:00-05:00\\[dq].\n+.B \\f[CB]\\-\\-date\\f[R]\\f[I]TIMESTAMP\\f[R]\n+The timestamp in ISO\\-8601 extended offset date\\-time with optional\n+time\\-zone format, to use for the timestamp of the entries, e.g.\n+\"2022\\-02\\-12T12:30:00\\-05:00\".\n+.RS\n+.RE\n@@ -133,3 +134,5 @@\n-\\f[V]--dir\\f[R] \\f[I]path\\f[R]\n-Specifies the location where \\f[V]jmod\\f[R] puts extracted files from\n-the specified JMOD archive.\n+.B \\f[CB]\\-\\-dir\\f[R] \\f[I]path\\f[R]\n+Specifies the location where \\f[CB]jmod\\f[R] puts extracted files from the\n+specified JMOD archive.\n+.RS\n+.RE\n@@ -137,1 +140,1 @@\n-\\f[V]--dry-run\\f[R]\n+.B \\f[CB]\\-\\-dry\\-run\\f[R]\n@@ -141,0 +144,2 @@\n+.RS\n+.RE\n@@ -142,2 +147,2 @@\n-\\f[V]--exclude\\f[R] \\f[I]pattern-list\\f[R]\n-Excludes files matching the supplied comma-separated pattern list, each\n+.B \\f[CB]\\-\\-exclude\\f[R] \\f[I]pattern\\-list\\f[R]\n+Excludes files matching the supplied comma\\-separated pattern list, each\n@@ -147,1 +152,1 @@\n-\\f[I]glob-pattern\\f[R]\n+\\f[I]glob\\-pattern\\f[R]\n@@ -149,1 +154,1 @@\n-\\f[V]glob:\\f[R]\\f[I]glob-pattern\\f[R]\n+\\f[CB]glob:\\f[R]\\f[I]glob\\-pattern\\f[R]\n@@ -151,1 +156,1 @@\n-\\f[V]regex:\\f[R]\\f[I]regex-pattern\\f[R]\n+\\f[CB]regex:\\f[R]\\f[I]regex\\-pattern\\f[R]\n@@ -153,4 +158,4 @@\n-See the \\f[B]\\f[VB]FileSystem.getPathMatcher\\f[B]\\f[R] method for the\n-syntax of \\f[I]glob-pattern\\f[R].\n-See the \\f[B]\\f[VB]Pattern\\f[B]\\f[R] class for the syntax of\n-\\f[I]regex-pattern\\f[R], which represents a regular expression.\n+See the \\f[B]\\f[BC]FileSystem.getPathMatcher\\f[B]\\f[R] method for the\n+syntax of \\f[I]glob\\-pattern\\f[R].\n+See the \\f[B]\\f[BC]Pattern\\f[B]\\f[R] class for the syntax of\n+\\f[I]regex\\-pattern\\f[R], which represents a regular expression.\n@@ -159,1 +164,1 @@\n-\\f[V]--hash-modules\\f[R] \\f[I]regex-pattern\\f[R]\n+.B \\f[CB]\\-\\-hash\\-modules\\f[R] \\f[I]regex\\-pattern\\f[R]\n@@ -162,1 +167,1 @@\n-modules matching the given \\f[I]regex-pattern\\f[R].\n+modules matching the given \\f[I]regex\\-pattern\\f[R].\n@@ -165,1 +170,3 @@\n-\\f[V]jmod hash\\f[R] command.\n+\\f[CB]jmod\\ hash\\f[R] command.\n+.RS\n+.RE\n@@ -167,1 +174,1 @@\n-\\f[V]--header-files\\f[R] \\f[I]path\\f[R]\n+.B \\f[CB]\\-\\-header\\-files\\f[R] \\f[I]path\\f[R]\n@@ -170,0 +177,2 @@\n+.RS\n+.RE\n@@ -171,1 +180,1 @@\n-\\f[V]--help\\f[R] or \\f[V]-h\\f[R]\n+.B \\f[CB]\\-\\-help\\f[R] or \\f[CB]\\-h\\f[R]\n@@ -173,0 +182,2 @@\n+.RS\n+.RE\n@@ -174,1 +185,1 @@\n-\\f[V]--help-extra\\f[R]\n+.B \\f[CB]\\-\\-help\\-extra\\f[R]\n@@ -176,0 +187,2 @@\n+.RS\n+.RE\n@@ -177,1 +190,1 @@\n-\\f[V]--legal-notices\\f[R] \\f[I]path\\f[R]\n+.B \\f[CB]\\-\\-legal\\-notices\\f[R] \\f[I]path\\f[R]\n@@ -180,0 +193,2 @@\n+.RS\n+.RE\n@@ -181,1 +196,1 @@\n-\\f[V]--libs\\f[R] \\f[I]path\\f[R]\n+.B \\f[CB]\\-\\-libs\\f[R] \\f[I]path\\f[R]\n@@ -184,0 +199,2 @@\n+.RS\n+.RE\n@@ -185,2 +202,4 @@\n-\\f[V]--main-class\\f[R] \\f[I]class-name\\f[R]\n-Specifies main class to record in the module-info.class file.\n+.B \\f[CB]\\-\\-main\\-class\\f[R] \\f[I]class\\-name\\f[R]\n+Specifies main class to record in the module\\-info.class file.\n+.RS\n+.RE\n@@ -188,1 +207,1 @@\n-\\f[V]--man-pages\\f[R] \\f[I]path\\f[R]\n+.B \\f[CB]\\-\\-man\\-pages\\f[R] \\f[I]path\\f[R]\n@@ -191,0 +210,2 @@\n+.RS\n+.RE\n@@ -192,2 +213,4 @@\n-\\f[V]--module-version\\f[R] \\f[I]module-version\\f[R]\n-Specifies the module version to record in the module-info.class file.\n+.B \\f[CB]\\-\\-module\\-version\\f[R] \\f[I]module\\-version\\f[R]\n+Specifies the module version to record in the module\\-info.class file.\n+.RS\n+.RE\n@@ -195,1 +218,1 @@\n-\\f[V]--module-path\\f[R] \\f[I]path\\f[R] or \\f[V]-p\\f[R] \\f[I]path\\f[R]\n+.B \\f[CB]\\-\\-module\\-path\\f[R] \\f[I]path\\f[R] or \\f[CB]\\-p\\f[R] \\f[I]path\\f[R]\n@@ -197,1 +220,3 @@\n-This option is required if you also specify \\f[V]--hash-modules\\f[R].\n+This option is required if you also specify \\f[CB]\\-\\-hash\\-modules\\f[R].\n+.RS\n+.RE\n@@ -199,1 +224,1 @@\n-\\f[V]--target-platform\\f[R] \\f[I]platform\\f[R]\n+.B \\f[CB]\\-\\-target\\-platform\\f[R] \\f[I]platform\\f[R]\n@@ -201,0 +226,2 @@\n+.RS\n+.RE\n@@ -202,2 +229,4 @@\n-\\f[V]--version\\f[R]\n-Prints version information of the \\f[V]jmod\\f[R] tool.\n+.B \\f[CB]\\-\\-version\\f[R]\n+Prints version information of the \\f[CB]jmod\\f[R] tool.\n+.RS\n+.RE\n@@ -205,1 +234,1 @@\n-\\f[V]\\[at]\\f[R]\\f[I]filename\\f[R]\n+.B \\f[CB]\\@\\f[R]\\f[I]filename\\f[R]\n@@ -213,1 +242,1 @@\n-You may comment out lines by prefixinga hash symbol (\\f[V]#\\f[R]) to the\n+You may comment out lines by prefixinga hash symbol (\\f[CB]#\\f[R]) to the\n@@ -216,1 +245,1 @@\n-The following is an example of an options file for the \\f[V]jmod\\f[R]\n+The following is an example of an options file for the \\f[CB]jmod\\f[R]\n@@ -221,7 +250,7 @@\n-#Wed Dec 07 00:40:19 EST 2016\n-create --class-path mods\/com.greetings --module-path mlib\n-  --cmds commands --config configfiles --header-files src\/h\n-  --libs lib --main-class com.greetings.Main\n-  --man-pages man --module-version 1.0\n-  --os-arch \\[dq]x86_x64\\[dq] --os-name \\[dq]Mac OS X\\[dq]\n-  --os-version \\[dq]10.10.5\\[dq] greetingsmod\n+#Wed\\ Dec\\ 07\\ 00:40:19\\ EST\\ 2016\n+create\\ \\-\\-class\\-path\\ mods\/com.greetings\\ \\-\\-module\\-path\\ mlib\n+\\ \\ \\-\\-cmds\\ commands\\ \\-\\-config\\ configfiles\\ \\-\\-header\\-files\\ src\/h\n+\\ \\ \\-\\-libs\\ lib\\ \\-\\-main\\-class\\ com.greetings.Main\n+\\ \\ \\-\\-man\\-pages\\ man\\ \\-\\-module\\-version\\ 1.0\n+\\ \\ \\-\\-os\\-arch\\ \"x86_x64\"\\ \\-\\-os\\-name\\ \"Mac\\ OS\\ X\"\n+\\ \\ \\-\\-os\\-version\\ \"10.10.5\"\\ greetingsmod\n@@ -236,1 +265,1 @@\n-\\f[V]--do-not-resolve-by-default\\f[R]\n+.B \\f[CB]\\-\\-do\\-not\\-resolve\\-by\\-default\\f[R]\n@@ -238,0 +267,2 @@\n+.RS\n+.RE\n@@ -239,1 +270,1 @@\n-\\f[V]--warn-if-resolved\\f[R]\n+.B \\f[CB]\\-\\-warn\\-if\\-resolved\\f[R]\n@@ -241,1 +272,3 @@\n-One of deprecated, deprecated-for-removal, or incubating.\n+One of deprecated, deprecated\\-for\\-removal, or incubating.\n+.RS\n+.RE\n@@ -248,5 +281,5 @@\n-jmod create --class-path mods\/com.greetings --cmds commands\n-  --config configfiles --header-files src\/h --libs lib\n-  --main-class com.greetings.Main --man-pages man --module-version 1.0\n-  --os-arch \\[dq]x86_x64\\[dq] --os-name \\[dq]Mac OS X\\[dq]\n-  --os-version \\[dq]10.10.5\\[dq] greetingsmod\n+jmod\\ create\\ \\-\\-class\\-path\\ mods\/com.greetings\\ \\-\\-cmds\\ commands\n+\\ \\ \\-\\-config\\ configfiles\\ \\-\\-header\\-files\\ src\/h\\ \\-\\-libs\\ lib\n+\\ \\ \\-\\-main\\-class\\ com.greetings.Main\\ \\-\\-man\\-pages\\ man\\ \\-\\-module\\-version\\ 1.0\n+\\ \\ \\-\\-os\\-arch\\ \"x86_x64\"\\ \\-\\-os\\-name\\ \"Mac\\ OS\\ X\"\n+\\ \\ \\-\\-os\\-version\\ \"10.10.5\"\\ greetingsmod\n@@ -257,1 +290,1 @@\n-\\f[V]2022 March 15 00:00:00\\f[R]:\n+\\f[CB]2022\\ March\\ 15\\ 00:00:00\\f[R]:\n@@ -261,2 +294,2 @@\n-jmod create --class-path build\/foo\/classes --date 2022-03-15T00:00:00Z\n-   jmods\/foo1.jmod\n+jmod\\ create\\ \\-\\-class\\-path\\ build\/foo\/classes\\ \\-\\-date\\ 2022\\-03\\-15T00:00:00Z\n+\\ \\ \\ jmods\/foo1.jmod\n@@ -268,2 +301,2 @@\n-leaf module (in this example, \\f[V]ma\\f[R]) with a required module\n-(\\f[V]mb\\f[R]), and the hash value recorded in the required module\n+leaf module (in this example, \\f[CB]ma\\f[R]) with a required module\n+(\\f[CB]mb\\f[R]), and the hash value recorded in the required module\n@@ -272,1 +305,1 @@\n-Create and compile the following \\f[V].java\\f[R] files:\n+Create and compile the following \\f[CB]\\&.java\\f[R] files:\n@@ -275,1 +308,1 @@\n-\\f[V]jmodhashex\/src\/ma\/module-info.java\\f[R]\n+\\f[CB]jmodhashex\/src\/ma\/module\\-info.java\\f[R]\n@@ -280,2 +313,2 @@\n-module ma {\n-  requires mb;\n+module\\ ma\\ {\n+\\ \\ requires\\ mb;\n@@ -287,1 +320,1 @@\n-\\f[V]jmodhashex\/src\/mb\/module-info.java\\f[R]\n+\\f[CB]jmodhashex\/src\/mb\/module\\-info.java\\f[R]\n@@ -292,1 +325,1 @@\n-module mb {\n+module\\ mb\\ {\n@@ -298,1 +331,1 @@\n-\\f[V]jmodhashex2\/src\/ma\/module-info.java\\f[R]\n+\\f[CB]jmodhashex2\/src\/ma\/module\\-info.java\\f[R]\n@@ -303,2 +336,2 @@\n-module ma {\n-  requires mb;\n+module\\ ma\\ {\n+\\ \\ requires\\ mb;\n@@ -310,1 +343,1 @@\n-\\f[V]jmodhashex2\/src\/mb\/module-info.java\\f[R]\n+\\f[CB]jmodhashex2\/src\/mb\/module\\-info.java\\f[R]\n@@ -315,1 +348,1 @@\n-module mb {\n+module\\ mb\\ {\n@@ -323,3 +356,3 @@\n-Create the directories \\f[V]jmodhashex\/jmods\\f[R] and\n-\\f[V]jmodhashex2\/jmods\\f[R], and then run the following commands from\n-the \\f[V]jmodhashex\\f[R] directory, then from the \\f[V]jmodhashex2\\f[R]\n+Create the directories \\f[CB]jmodhashex\/jmods\\f[R] and\n+\\f[CB]jmodhashex2\/jmods\\f[R], and then run the following commands from the\n+\\f[CB]jmodhashex\\f[R] directory, then from the \\f[CB]jmodhashex2\\f[R]\n@@ -329,1 +362,1 @@\n-\\f[V]jmod create --class-path mods\/ma jmods\/ma.jmod\\f[R]\n+\\f[CB]jmod\\ create\\ \\-\\-class\\-path\\ mods\/ma\\ jmods\/ma.jmod\\f[R]\n@@ -331,1 +364,1 @@\n-\\f[V]jmod create --class-path mods\/mb jmods\/mb.jmod\\f[R]\n+\\f[CB]jmod\\ create\\ \\-\\-class\\-path\\ mods\/mb\\ jmods\/mb.jmod\\f[R]\n@@ -334,2 +367,2 @@\n-Optionally preview the \\f[V]jmod hash\\f[R] command.\n-Run the following command from the \\f[V]jmodhashex\\f[R] directory:\n+Optionally preview the \\f[CB]jmod\\ hash\\f[R] command.\n+Run the following command from the \\f[CB]jmodhashex\\f[R] directory:\n@@ -338,1 +371,1 @@\n-\\f[V]jmod hash --dry-run -module-path jmods --hash-modules .*\\f[R]\n+\\f[CB]jmod\\ hash\\ \\-\\-dry\\-run\\ \\-module\\-path\\ jmods\\ \\-\\-hash\\-modules\\ .*\\f[R]\n@@ -344,1 +377,1 @@\n-Dry run:\n+Dry\\ run:\n@@ -346,1 +379,1 @@\n-  hashes ma SHA-256 07667d5032004b37b42ec2bb81b46df380cf29e66962a16481ace2e71e74073a\n+\\ \\ hashes\\ ma\\ SHA\\-256\\ 07667d5032004b37b42ec2bb81b46df380cf29e66962a16481ace2e71e74073a\n@@ -350,3 +383,3 @@\n-This indicates that the \\f[V]jmod hash\\f[R] command (without the\n-\\f[V]--dry-run\\f[R] option) will record the hash value of the leaf\n-module \\f[V]ma\\f[R] in the module \\f[V]mb\\f[R].\n+This indicates that the \\f[CB]jmod\\ hash\\f[R] command (without the\n+\\f[CB]\\-\\-dry\\-run\\f[R] option) will record the hash value of the leaf\n+module \\f[CB]ma\\f[R] in the module \\f[CB]mb\\f[R].\n@@ -356,2 +389,2 @@\n-\\f[V]jmodhashex\\f[R] directory.\n-Run the following command from the \\f[V]jmodhashex\\f[R] directory:\n+\\f[CB]jmodhashex\\f[R] directory.\n+Run the following command from the \\f[CB]jmodhashex\\f[R] directory:\n@@ -361,1 +394,1 @@\n-\\f[V]jmod hash --module-path jmods --hash-modules .*\\f[R]\n+\\f[CB]jmod\\ hash\\ \\-\\-module\\-path\\ jmods\\ \\-\\-hash\\-modules\\ .*\\f[R]\n@@ -367,1 +400,1 @@\n-\\f[V]Hashes are recorded in module mb\\f[R]\n+\\f[CB]Hashes\\ are\\ recorded\\ in\\ module\\ mb\\f[R]\n@@ -372,2 +405,2 @@\n-\\f[V]jmodhashex\\f[R] directory.\n-Run the highlighted commands from the \\f[V]jmodhashex\\f[R] directory:\n+\\f[CB]jmodhashex\\f[R] directory.\n+Run the highlighted commands from the \\f[CB]jmodhashex\\f[R] directory:\n@@ -378,1 +411,1 @@\n-jmod describe jmods\/ma.jmod\n+jmod\\ describe\\ jmods\/ma.jmod\n@@ -381,2 +414,2 @@\n-  requires mandated java.base\n-  requires mb\n+\\ \\ requires\\ mandated\\ java.base\n+\\ \\ requires\\ mb\n@@ -384,1 +417,1 @@\n-jmod describe jmods\/mb.jmod\n+jmod\\ describe\\ jmods\/mb.jmod\n@@ -387,2 +420,2 @@\n-  requires mandated java.base\n-  hashes ma SHA-256 07667d5032004b37b42ec2bb81b46df380cf29e66962a16481ace2e71e74073a\n+\\ \\ requires\\ mandated\\ java.base\n+\\ \\ hashes\\ ma\\ SHA\\-256\\ 07667d5032004b37b42ec2bb81b46df380cf29e66962a16481ace2e71e74073a\n@@ -393,4 +426,4 @@\n-Attempt to create a runtime image that contains the module \\f[V]ma\\f[R]\n-from the directory \\f[V]jmodhashex2\\f[R] but the module \\f[V]mb\\f[R]\n-from the directory \\f[V]jmodhashex\\f[R].\n-Run the following command from the \\f[V]jmodhashex2\\f[R] directory:\n+Attempt to create a runtime image that contains the module \\f[CB]ma\\f[R]\n+from the directory \\f[CB]jmodhashex2\\f[R] but the module \\f[CB]mb\\f[R] from\n+the directory \\f[CB]jmodhashex\\f[R].\n+Run the following command from the \\f[CB]jmodhashex2\\f[R] directory:\n@@ -403,1 +436,1 @@\n-\\f[V]jlink --module-path $JAVA_HOME\/jmods:jmods\/ma.jmod:..\/jmodhashex\/jmods\/mb.jmod --add-modules ma --output ma-app\\f[R]\n+\\f[CB]jlink\\ \\-\\-module\\-path\\ $JAVA_HOME\/jmods:jmods\/ma.jmod:..\/jmodhashex\/jmods\/mb.jmod\\ \\-\\-add\\-modules\\ ma\\ \\-\\-output\\ ma\\-app\\f[R]\n@@ -411,1 +444,1 @@\n-\\f[V]jlink --module-path %JAVA_HOME%\/jmods;jmods\/ma.jmod;..\/jmodhashex\/jmods\/mb.jmod --add-modules ma --output ma-app\\f[R]\n+\\f[CB]jlink\\ \\-\\-module\\-path\\ %JAVA_HOME%\/jmods;jmods\/ma.jmod;..\/jmodhashex\/jmods\/mb.jmod\\ \\-\\-add\\-modules\\ ma\\ \\-\\-output\\ ma\\-app\\f[R]\n@@ -419,2 +452,2 @@\n-Error: Hash of ma (a2d77889b0cb067df02a3abc39b01ac1151966157a68dc4241562c60499150d2) differs to\n-expected hash (07667d5032004b37b42ec2bb81b46df380cf29e66962a16481ace2e71e74073a) recorded in mb\n+Error:\\ Hash\\ of\\ ma\\ (a2d77889b0cb067df02a3abc39b01ac1151966157a68dc4241562c60499150d2)\\ differs\\ to\n+expected\\ hash\\ (07667d5032004b37b42ec2bb81b46df380cf29e66962a16481ace2e71e74073a)\\ recorded\\ in\\ mb\n","filename":"src\/jdk.jlink\/share\/man\/jmod.1","additions":183,"deletions":150,"binary":false,"changes":333,"status":"modified"},{"patch":"@@ -22,1 +22,1 @@\n-.\\\" Automatically generated by Pandoc 2.19.2\n+.\\\" Automatically generated by Pandoc 2.3.1\n@@ -24,15 +24,1 @@\n-.\\\" Define V font for inline verbatim, using C font in formats\n-.\\\" that render this, and otherwise B font.\n-.ie \"\\f[CB]x\\f[R]\"x\" \\{\\\n-. ftr V B\n-. ftr VI BI\n-. ftr VB B\n-. ftr VBI BI\n-.\\}\n-.el \\{\\\n-. ftr V CR\n-. ftr VI CI\n-. ftr VB CB\n-. ftr VBI CBI\n-.\\}\n-.TH \"JPACKAGE\" \"1\" \"2023\" \"JDK 20-ea\" \"JDK Commands\"\n+.TH \"JPACKAGE\" \"1\" \"2023\" \"JDK 20\\-ea\" \"JDK Commands\"\n@@ -42,1 +28,1 @@\n-jpackage - tool for packaging self-contained Java applications.\n+jpackage \\- tool for packaging self\\-contained Java applications.\n@@ -45,1 +31,1 @@\n-\\f[V]jpackage\\f[R] [\\f[I]options\\f[R]]\n+\\f[CB]jpackage\\f[R] [\\f[I]options\\f[R]]\n@@ -47,2 +33,2 @@\n-\\f[I]options\\f[R]\n-Command-line options separated by spaces.\n+.B \\f[I]options\\f[R]\n+Command\\-line options separated by spaces.\n@@ -50,0 +36,2 @@\n+.RS\n+.RE\n@@ -52,2 +40,2 @@\n-The \\f[V]jpackage\\f[R] tool will take as input a Java application and a\n-Java run-time image, and produce a Java application image that includes\n+The \\f[CB]jpackage\\f[R] tool will take as input a Java application and a\n+Java run\\-time image, and produce a Java application image that includes\n@@ -55,1 +43,1 @@\n-It will be able to produce a native package in a platform-specific\n+It will be able to produce a native package in a platform\\-specific\n@@ -58,1 +46,1 @@\n-cross-platform support.\n+cross\\-platform support.\n@@ -64,1 +52,1 @@\n-\\f[V]\\[at]\\f[R]\\f[I]filename\\f[R]\n+.B \\f[CB]\\@\\f[R]\\f[I]filename\\f[R]\n@@ -71,1 +59,1 @@\n-\\f[V]--type\\f[R] or \\f[V]-t\\f[R] \\f[I]type\\f[R]\n+.B \\f[CB]\\-\\-type\\f[R] or \\f[CB]\\-t\\f[R] \\f[I]type\\f[R]\n@@ -75,2 +63,2 @@\n-Valid values are: {\\[dq]app-image\\[dq], \\[dq]exe\\[dq], \\[dq]msi\\[dq],\n-\\[dq]rpm\\[dq], \\[dq]deb\\[dq], \\[dq]pkg\\[dq], \\[dq]dmg\\[dq]}\n+Valid values are: {\"app\\-image\", \"exe\", \"msi\", \"rpm\", \"deb\", \"pkg\",\n+\"dmg\"}\n@@ -82,1 +70,1 @@\n-\\f[V]--app-version\\f[R] \\f[I]version\\f[R]\n+.B \\f[CB]\\-\\-app\\-version\\f[R] \\f[I]version\\f[R]\n@@ -84,0 +72,2 @@\n+.RS\n+.RE\n@@ -85,1 +75,1 @@\n-\\f[V]--copyright\\f[R] \\f[I]copyright\\f[R]\n+.B \\f[CB]\\-\\-copyright\\f[R] \\f[I]copyright\\f[R]\n@@ -87,0 +77,2 @@\n+.RS\n+.RE\n@@ -88,1 +80,1 @@\n-\\f[V]--description\\f[R] \\f[I]description\\f[R]\n+.B \\f[CB]\\-\\-description\\f[R] \\f[I]description\\f[R]\n@@ -90,0 +82,2 @@\n+.RS\n+.RE\n@@ -91,1 +85,1 @@\n-\\f[V]--help\\f[R] or \\f[V]-h\\f[R]\n+.B \\f[CB]\\-\\-help\\f[R] or \\f[CB]\\-h\\f[R]\n@@ -94,0 +88,2 @@\n+.RS\n+.RE\n@@ -95,1 +91,1 @@\n-\\f[V]--icon\\f[R] \\f[I]path\\f[R]\n+.B \\f[CB]\\-\\-icon\\f[R] \\f[I]path\\f[R]\n@@ -102,1 +98,1 @@\n-\\f[V]--name\\f[R] or \\f[V]-n\\f[R] \\f[I]name\\f[R]\n+.B \\f[CB]\\-\\-name\\f[R] or \\f[CB]\\-n\\f[R] \\f[I]name\\f[R]\n@@ -104,0 +100,2 @@\n+.RS\n+.RE\n@@ -105,1 +103,1 @@\n-\\f[V]--dest\\f[R] or \\f[V]-d\\f[R] \\f[I]destination\\f[R]\n+.B \\f[CB]\\-\\-dest\\f[R] or \\f[CB]\\-d\\f[R] \\f[I]destination\\f[R]\n@@ -114,1 +112,1 @@\n-\\f[V]--temp\\f[R] \\f[I]directory\\f[R]\n+.B \\f[CB]\\-\\-temp\\f[R] \\f[I]directory\\f[R]\n@@ -127,1 +125,1 @@\n-\\f[V]--vendor\\f[R] \\f[I]vendor\\f[R]\n+.B \\f[CB]\\-\\-vendor\\f[R] \\f[I]vendor\\f[R]\n@@ -129,0 +127,2 @@\n+.RS\n+.RE\n@@ -130,1 +130,1 @@\n-\\f[V]--verbose\\f[R]\n+.B \\f[CB]\\-\\-verbose\\f[R]\n@@ -132,0 +132,2 @@\n+.RS\n+.RE\n@@ -133,1 +135,1 @@\n-\\f[V]--version\\f[R]\n+.B \\f[CB]\\-\\-version\\f[R]\n@@ -135,0 +137,2 @@\n+.RS\n+.RE\n@@ -137,2 +141,2 @@\n-\\f[V]--add-modules\\f[R] \\f[I]module-name\\f[R] [\\f[V],\\f[R]\\f[I]module-name\\f[R]...]\n-A comma (\\[dq],\\[dq]) separated list of modules to add\n+.B \\f[CB]\\-\\-add\\-modules\\f[R] \\f[I]module\\-name\\f[R] [\\f[CB],\\f[R]\\f[I]module\\-name\\f[R]...]\n+A comma (\",\") separated list of modules to add\n@@ -142,4 +146,4 @@\n-passed to jlink as the --add-module argument.\n-If not specified, either just the main module (if --module is\n-specified), or the default set of modules (if --main-jar is specified)\n-are used.\n+passed to jlink as the \\-\\-add\\-module argument.\n+If not specified, either just the main module (if \\-\\-module is\n+specified), or the default set of modules (if \\-\\-main\\-jar is\n+specified) are used.\n@@ -150,1 +154,1 @@\n-\\f[V]--module-path\\f[R] or \\f[V]-p\\f[R] \\f[I]module-path\\f[R] [\\f[V],\\f[R]\\f[I]module-path\\f[R]...]\n+.B \\f[CB]\\-\\-module\\-path\\f[R] or \\f[CB]\\-p\\f[R] \\f[I]module\\-path\\f[R] [\\f[CB],\\f[R]\\f[I]module\\-path\\f[R]...]\n@@ -160,1 +164,1 @@\n-\\f[V]--jlink-options\\f[R] \\f[I]options\\f[R]\n+.B \\f[CB]\\-\\-jlink\\-options\\f[R] \\f[I]options\\f[R]\n@@ -164,2 +168,2 @@\n-If not specified, defaults to \\[dq]--strip-native-commands --strip-debug\n---no-man-pages --no-header-files\\[dq]\n+If not specified, defaults to \"\\-\\-strip\\-native\\-commands\n+\\-\\-strip\\-debug \\-\\-no\\-man\\-pages \\-\\-no\\-header\\-files\"\n@@ -170,1 +174,1 @@\n-\\f[V]--runtime-image\\f[R] \\f[I]directory\\f[R]\n+.B \\f[CB]\\-\\-runtime\\-image\\f[R] \\f[I]directory\\f[R]\n@@ -177,2 +181,2 @@\n-If --runtime-image is not specified, jpackage will run jlink to create\n-the runtime image using options specified by --jlink-options.\n+If \\-\\-runtime\\-image is not specified, jpackage will run jlink to\n+create the runtime image using options specified by \\-\\-jlink\\-options.\n@@ -182,1 +186,1 @@\n-\\f[V]--input\\f[R] or \\f[V]-i\\f[R] \\f[I]directory\\f[R]\n+.B \\f[CB]\\-\\-input\\f[R] or \\f[CB]\\-i\\f[R] \\f[I]directory\\f[R]\n@@ -192,1 +196,1 @@\n-\\[ga]--app-content \\f[I]additional-content\\f[R][,\\f[I]additional-content\\f[R]...]\n+.B `\\-\\-app\\-content \\f[I]additional\\-content\\f[R][,\\f[I]additional\\-content\\f[R]...]\n@@ -201,1 +205,1 @@\n-\\f[V]--add-launcher\\f[R] \\f[I]name\\f[R]=\\f[I]path\\f[R]\n+.B \\f[CB]\\-\\-add\\-launcher\\f[R] \\f[I]name\\f[R]=\\f[I]path\\f[R]\n@@ -208,5 +212,4 @@\n-The keys \\[dq]module\\[dq], \\[dq]main-jar\\[dq], \\[dq]main-class\\[dq],\n-\\[dq]description\\[dq], \\[dq]arguments\\[dq], \\[dq]java-options\\[dq],\n-\\[dq]app-version\\[dq], \\[dq]icon\\[dq], \\[dq]launcher-as-service\\[dq],\n-\\[dq]win-console\\[dq], \\[dq]win-shortcut\\[dq], \\[dq]win-menu\\[dq],\n-\\[dq]linux-app-category\\[dq], and \\[dq]linux-shortcut\\[dq] can be used.\n+The keys \"module\", \"main\\-jar\", \"main\\-class\", \"description\",\n+\"arguments\", \"java\\-options\", \"app\\-version\", \"icon\",\n+\"launcher\\-as\\-service\", \"win\\-console\", \"win\\-shortcut\", \"win\\-menu\",\n+\"linux\\-app\\-category\", and \"linux\\-shortcut\" can be used.\n@@ -223,1 +226,1 @@\n-\\f[V]--arguments\\f[R] \\f[I]arguments\\f[R]\n+.B \\f[CB]\\-\\-arguments\\f[R] \\f[I]arguments\\f[R]\n@@ -231,1 +234,1 @@\n-\\f[V]--java-options\\f[R] \\f[I]options\\f[R]\n+.B \\f[CB]\\-\\-java\\-options\\f[R] \\f[I]options\\f[R]\n@@ -238,1 +241,1 @@\n-\\f[V]--main-class\\f[R] \\f[I]class-name\\f[R]\n+.B \\f[CB]\\-\\-main\\-class\\f[R] \\f[I]class\\-name\\f[R]\n@@ -242,1 +245,1 @@\n-This option can only be used if --main-jar is specified.\n+This option can only be used if \\-\\-main\\-jar is specified.\n@@ -245,1 +248,1 @@\n-\\f[V]--main-jar\\f[R] \\f[I]main-jar\\f[R]\n+.B \\f[CB]\\-\\-main\\-jar\\f[R] \\f[I]main\\-jar\\f[R]\n@@ -250,1 +253,1 @@\n-Either --module or --main-jar option can be specified but not both.\n+Either \\-\\-module or \\-\\-main\\-jar option can be specified but not both.\n@@ -253,1 +256,1 @@\n-\\f[V]--module\\f[R] or \\f[V]-m\\f[R] \\f[I]module-name\\f[R][\/\\f[I]main-class\\f[R]]\n+.B \\f[CB]\\-\\-module\\f[R] or \\f[CB]\\-m\\f[R] \\f[I]module\\-name\\f[R][\/\\f[I]main\\-class\\f[R]]\n@@ -261,1 +264,1 @@\n-Either --module or --main-jar option can be specified but not both.\n+Either \\-\\-module or \\-\\-main\\-jar option can be specified but not both.\n@@ -266,1 +269,1 @@\n-\\f[V]--win-console\\f[R]\n+.B \\f[CB]\\-\\-win\\-console\\f[R]\n@@ -269,0 +272,2 @@\n+.RS\n+.RE\n@@ -271,1 +276,1 @@\n-\\f[V]--mac-package-identifier\\f[R] \\f[I]identifier\\f[R]\n+.B \\f[CB]\\-\\-mac\\-package\\-identifier\\f[R] \\f[I]identifier\\f[R]\n@@ -277,1 +282,1 @@\n-May only use alphanumeric (A-Z,a-z,0-9), hyphen (-), and period (.)\n+May only use alphanumeric (A\\-Z,a\\-z,0\\-9), hyphen (\\-), and period (.)\n@@ -281,1 +286,1 @@\n-\\f[V]--mac-package-name\\f[R] \\f[I]name\\f[R]\n+.B \\f[CB]\\-\\-mac\\-package\\-name\\f[R] \\f[I]name\\f[R]\n@@ -292,1 +297,1 @@\n-\\f[V]--mac-package-signing-prefix\\f[R] \\f[I]prefix\\f[R]\n+.B \\f[CB]\\-\\-mac\\-package\\-signing\\-prefix\\f[R] \\f[I]prefix\\f[R]\n@@ -296,0 +301,2 @@\n+.RS\n+.RE\n@@ -297,1 +304,1 @@\n-\\f[V]--mac-sign\\f[R]\n+.B \\f[CB]\\-\\-mac\\-sign\\f[R]\n@@ -299,0 +306,2 @@\n+.RS\n+.RE\n@@ -300,1 +309,1 @@\n-\\f[V]--mac-signing-keychain\\f[R] \\f[I]keychain-name\\f[R]\n+.B \\f[CB]\\-\\-mac\\-signing\\-keychain\\f[R] \\f[I]keychain\\-name\\f[R]\n@@ -307,1 +316,1 @@\n-\\f[V]--mac-signing-key-user-name\\f[R] \\f[I]name\\f[R]\n+.B \\f[CB]\\-\\-mac\\-signing\\-key\\-user\\-name\\f[R] \\f[I]name\\f[R]\n@@ -309,0 +318,2 @@\n+.RS\n+.RE\n@@ -310,1 +321,1 @@\n-\\f[V]--mac-app-store\\f[R]\n+.B \\f[CB]\\-\\-mac\\-app\\-store\\f[R]\n@@ -312,0 +323,2 @@\n+.RS\n+.RE\n@@ -313,1 +326,1 @@\n-\\f[V]--mac-entitlements\\f[R] \\f[I]path\\f[R]\n+.B \\f[CB]\\-\\-mac\\-entitlements\\f[R] \\f[I]path\\f[R]\n@@ -316,0 +329,2 @@\n+.RS\n+.RE\n@@ -317,1 +332,1 @@\n-\\f[V]--mac-app-category\\f[R] \\f[I]category\\f[R]\n+.B \\f[CB]\\-\\-mac\\-app\\-category\\f[R] \\f[I]category\\f[R]\n@@ -321,1 +336,1 @@\n-The default value is \\[dq]utilities\\[dq].\n+The default value is \"utilities\".\n@@ -325,1 +340,1 @@\n-\\f[V]--about-url\\f[R] \\f[I]url\\f[R]\n+.B \\f[CB]\\-\\-about\\-url\\f[R] \\f[I]url\\f[R]\n@@ -327,0 +342,2 @@\n+.RS\n+.RE\n@@ -328,1 +345,1 @@\n-\\f[V]--app-image\\f[R] \\f[I]directory\\f[R]\n+.B \\f[CB]\\-\\-app\\-image\\f[R] \\f[I]directory\\f[R]\n@@ -336,1 +353,1 @@\n-\\f[V]--file-associations\\f[R] \\f[I]path\\f[R]\n+.B \\f[CB]\\-\\-file\\-associations\\f[R] \\f[I]path\\f[R]\n@@ -342,2 +359,2 @@\n-The keys \\[dq]extension\\[dq], \\[dq]mime-type\\[dq], \\[dq]icon\\[dq], and\n-\\[dq]description\\[dq] can be used to describe the association.\n+The keys \"extension\", \"mime\\-type\", \"icon\", and \"description\" can be\n+used to describe the association.\n@@ -348,1 +365,1 @@\n-\\f[V]--install-dir\\f[R] \\f[I]path\\f[R]\n+.B \\f[CB]\\-\\-install\\-dir\\f[R] \\f[I]path\\f[R]\n@@ -350,2 +367,4 @@\n-or linux), or relative sub-path of the installation directory such as\n-\\[dq]Program Files\\[dq] or \\[dq]AppData\\[dq] (on Windows)\n+or linux), or relative sub\\-path of the installation directory such as\n+\"Program Files\" or \"AppData\" (on Windows)\n+.RS\n+.RE\n@@ -353,1 +372,1 @@\n-\\f[V]--license-file\\f[R] \\f[I]path\\f[R]\n+.B \\f[CB]\\-\\-license\\-file\\f[R] \\f[I]path\\f[R]\n@@ -360,1 +379,1 @@\n-\\f[V]--resource-dir\\f[R] \\f[I]path\\f[R]\n+.B \\f[CB]\\-\\-resource\\-dir\\f[R] \\f[I]path\\f[R]\n@@ -367,1 +386,1 @@\n-over-ridden by adding replacement resources to this directory.\n+over\\-ridden by adding replacement resources to this directory.\n@@ -370,1 +389,1 @@\n-\\f[V]--runtime-image\\f[R] \\f[I]path\\f[R]\n+.B \\f[CB]\\-\\-runtime\\-image\\f[R] \\f[I]path\\f[R]\n@@ -379,1 +398,1 @@\n-\\f[V]--launcher-as-service\\f[R]\n+.B \\f[CB]\\-\\-launcher\\-as\\-service\\f[R]\n@@ -381,1 +400,3 @@\n-launcher as a background service-type application.\n+launcher as a background service\\-type application.\n+.RS\n+.RE\n@@ -385,1 +406,1 @@\n-\\f[V]--win-dir-chooser\\f[R]\n+.B \\f[CB]\\-\\-win\\-dir\\-chooser\\f[R]\n@@ -388,0 +409,2 @@\n+.RS\n+.RE\n@@ -389,1 +412,1 @@\n-\\f[V]--win-help-url\\f[R] \\f[I]url\\f[R]\n+.B \\f[CB]\\-\\-win\\-help\\-url\\f[R] \\f[I]url\\f[R]\n@@ -391,0 +414,2 @@\n+.RS\n+.RE\n@@ -392,1 +417,1 @@\n-\\f[V]--win-menu\\f[R]\n+.B \\f[CB]\\-\\-win\\-menu\\f[R]\n@@ -394,0 +419,2 @@\n+.RS\n+.RE\n@@ -395,1 +422,1 @@\n-\\f[V]--win-menu-group\\f[R] \\f[I]menu-group-name\\f[R]\n+.B \\f[CB]\\-\\-win\\-menu\\-group\\f[R] \\f[I]menu\\-group\\-name\\f[R]\n@@ -397,0 +424,2 @@\n+.RS\n+.RE\n@@ -398,2 +427,4 @@\n-\\f[V]--win-per-user-install\\f[R]\n-Request to perform an install on a per-user basis\n+.B \\f[CB]\\-\\-win\\-per\\-user\\-install\\f[R]\n+Request to perform an install on a per\\-user basis\n+.RS\n+.RE\n@@ -401,1 +432,1 @@\n-\\f[V]--win-shortcut\\f[R]\n+.B \\f[CB]\\-\\-win\\-shortcut\\f[R]\n@@ -403,0 +434,2 @@\n+.RS\n+.RE\n@@ -404,1 +437,1 @@\n-\\f[V]--win-shortcut-prompt\\f[R]\n+.B \\f[CB]\\-\\-win\\-shortcut\\-prompt\\f[R]\n@@ -407,0 +440,2 @@\n+.RS\n+.RE\n@@ -408,1 +443,1 @@\n-\\f[V]--win-update-url\\f[R] \\f[I]url\\f[R]\n+.B \\f[CB]\\-\\-win\\-update\\-url\\f[R] \\f[I]url\\f[R]\n@@ -410,0 +445,2 @@\n+.RS\n+.RE\n@@ -411,1 +448,1 @@\n-\\f[V]--win-upgrade-uuid\\f[R] \\f[I]id\\f[R]\n+.B \\f[CB]\\-\\-win\\-upgrade\\-uuid\\f[R] \\f[I]id\\f[R]\n@@ -413,0 +450,2 @@\n+.RS\n+.RE\n@@ -415,1 +454,1 @@\n-\\f[V]--linux-package-name\\f[R] \\f[I]name\\f[R]\n+.B \\f[CB]\\-\\-linux\\-package\\-name\\f[R] \\f[I]name\\f[R]\n@@ -422,1 +461,1 @@\n-\\f[V]--linux-deb-maintainer\\f[R] \\f[I]email-address\\f[R]\n+.B \\f[CB]\\-\\-linux\\-deb\\-maintainer\\f[R] \\f[I]email\\-address\\f[R]\n@@ -424,0 +463,2 @@\n+.RS\n+.RE\n@@ -425,1 +466,1 @@\n-\\f[V]--linux-menu-group\\f[R] \\f[I]menu-group-name\\f[R]\n+.B \\f[CB]\\-\\-linux\\-menu\\-group\\f[R] \\f[I]menu\\-group\\-name\\f[R]\n@@ -427,0 +468,2 @@\n+.RS\n+.RE\n@@ -428,1 +471,1 @@\n-\\f[V]--linux-package-deps\\f[R]\n+.B \\f[CB]\\-\\-linux\\-package\\-deps\\f[R]\n@@ -430,0 +473,2 @@\n+.RS\n+.RE\n@@ -431,3 +476,4 @@\n-\\f[V]--linux-rpm-license-type\\f[R] \\f[I]type\\f[R]\n-Type of the license (\\[dq]License: \\f[I]value\\f[R]\\[dq] of the RPM\n-\\&.spec)\n+.B \\f[CB]\\-\\-linux\\-rpm\\-license\\-type\\f[R] \\f[I]type\\f[R]\n+Type of the license (\"License: \\f[I]value\\f[R]\" of the RPM .spec)\n+.RS\n+.RE\n@@ -435,1 +481,1 @@\n-\\f[V]--linux-app-release\\f[R] \\f[I]release\\f[R]\n+.B \\f[CB]\\-\\-linux\\-app\\-release\\f[R] \\f[I]release\\f[R]\n@@ -438,0 +484,2 @@\n+.RS\n+.RE\n@@ -439,1 +487,1 @@\n-\\f[V]--linux-app-category\\f[R] \\f[I]category-value\\f[R]\n+.B \\f[CB]\\-\\-linux\\-app\\-category\\f[R] \\f[I]category\\-value\\f[R]\n@@ -441,0 +489,2 @@\n+.RS\n+.RE\n@@ -442,1 +492,1 @@\n-\\f[V]--linux-shortcut\\f[R]\n+.B \\f[CB]\\-\\-linux\\-shortcut\\f[R]\n@@ -444,0 +494,2 @@\n+.RS\n+.RE\n@@ -446,1 +498,1 @@\n-\\[aq]--mac-dmg-content \\f[I]additional-content\\f[R][,\\f[I]additional-content\\f[R]...]\n+.B \\[aq]\\-\\-mac\\-dmg\\-content \\f[I]additional\\-content\\f[R][,\\f[I]additional\\-content\\f[R]...]\n@@ -456,1 +508,1 @@\n-Generate an application package suitable for the host system:\n+Generate\\ an\\ application\\ package\\ suitable\\ for\\ the\\ host\\ system:\n@@ -462,7 +514,7 @@\n-For a modular application:\n-    jpackage -n name -p modulePath -m moduleName\/className\n-For a non-modular application:\n-    jpackage -i inputDir -n name \\[rs]\n-        --main-class className --main-jar myJar.jar\n-From a pre-built application image:\n-    jpackage -n name --app-image appImageDir\n+For\\ a\\ modular\\ application:\n+\\ \\ \\ \\ jpackage\\ \\-n\\ name\\ \\-p\\ modulePath\\ \\-m\\ moduleName\/className\n+For\\ a\\ non\\-modular\\ application:\n+\\ \\ \\ \\ jpackage\\ \\-i\\ inputDir\\ \\-n\\ name\\ \\\\\n+\\ \\ \\ \\ \\ \\ \\ \\ \\-\\-main\\-class\\ className\\ \\-\\-main\\-jar\\ myJar.jar\n+From\\ a\\ pre\\-built\\ application\\ image:\n+\\ \\ \\ \\ jpackage\\ \\-n\\ name\\ \\-\\-app\\-image\\ appImageDir\n@@ -474,1 +526,1 @@\n-Generate an application image:\n+Generate\\ an\\ application\\ image:\n@@ -480,12 +532,12 @@\n-For a modular application:\n-    jpackage --type app-image -n name -p modulePath \\[rs]\n-        -m moduleName\/className\n-For a non-modular application:\n-    jpackage --type app-image -i inputDir -n name \\[rs]\n-        --main-class className --main-jar myJar.jar\n-To provide your own options to jlink, run jlink separately:\n-    jlink --output appRuntimeImage -p modulePath \\[rs]\n-        --add-modules moduleName \\[rs]\n-        --no-header-files [<additional jlink options>...]\n-    jpackage --type app-image -n name \\[rs]\n-        -m moduleName\/className --runtime-image appRuntimeImage\n+For\\ a\\ modular\\ application:\n+\\ \\ \\ \\ jpackage\\ \\-\\-type\\ app\\-image\\ \\-n\\ name\\ \\-p\\ modulePath\\ \\\\\n+\\ \\ \\ \\ \\ \\ \\ \\ \\-m\\ moduleName\/className\n+For\\ a\\ non\\-modular\\ application:\n+\\ \\ \\ \\ jpackage\\ \\-\\-type\\ app\\-image\\ \\-i\\ inputDir\\ \\-n\\ name\\ \\\\\n+\\ \\ \\ \\ \\ \\ \\ \\ \\-\\-main\\-class\\ className\\ \\-\\-main\\-jar\\ myJar.jar\n+To\\ provide\\ your\\ own\\ options\\ to\\ jlink,\\ run\\ jlink\\ separately:\n+\\ \\ \\ \\ jlink\\ \\-\\-output\\ appRuntimeImage\\ \\-p\\ modulePath\\ \\\\\n+\\ \\ \\ \\ \\ \\ \\ \\ \\-\\-add\\-modules\\ moduleName\\ \\\\\n+\\ \\ \\ \\ \\ \\ \\ \\ \\-\\-no\\-header\\-files\\ [<additional\\ jlink\\ options>...]\n+\\ \\ \\ \\ jpackage\\ \\-\\-type\\ app\\-image\\ \\-n\\ name\\ \\\\\n+\\ \\ \\ \\ \\ \\ \\ \\ \\-m\\ moduleName\/className\\ \\-\\-runtime\\-image\\ appRuntimeImage\n@@ -497,1 +549,1 @@\n-Generate a Java runtime package:\n+Generate\\ a\\ Java\\ runtime\\ package:\n@@ -503,1 +555,1 @@\n-jpackage -n name --runtime-image <runtime-image>\n+jpackage\\ \\-n\\ name\\ \\-\\-runtime\\-image\\ <runtime\\-image>\n@@ -509,1 +561,1 @@\n-Sign the predefined application image (on macOS):\n+Sign\\ the\\ predefined\\ application\\ image\\ (on\\ macOS):\n@@ -515,2 +567,2 @@\n-jpackage --type app-image --app-image <app-image> \\[rs]\n-    --mac-sign [<additional signing options>...]\n+jpackage\\ \\-\\-type\\ app\\-image\\ \\-\\-app\\-image\\ <app\\-image>\\ \\\\\n+\\ \\ \\ \\ \\-\\-mac\\-sign\\ [<additional\\ signing\\ options>...]\n@@ -518,2 +570,2 @@\n-Note: the only additional options that are permitted in this mode are:\n-      the set of additional mac signing options and --verbose\n+Note:\\ the\\ only\\ additional\\ options\\ that\\ are\\ permitted\\ in\\ this\\ mode\\ are:\n+\\ \\ \\ \\ \\ \\ the\\ set\\ of\\ additional\\ mac\\ signing\\ options\\ and\\ \\-\\-verbose\n@@ -525,1 +577,1 @@\n-over-ridden by adding replacement resources to this directory.\n+over\\-ridden by adding replacement resources to this directory.\n@@ -529,1 +581,1 @@\n-\\f[V]<launcher-name>.png\\f[R]\n+.B \\f[CB]<launcher\\-name>.png\\f[R]\n@@ -536,2 +588,2 @@\n-\\f[V]<launcher-name>.desktop\\f[R]\n-A desktop file to be used with \\f[V]xdg-desktop-menu\\f[R] command\n+.B \\f[CB]<launcher\\-name>.desktop\\f[R]\n+A desktop file to be used with \\f[CB]xdg\\-desktop\\-menu\\f[R] command\n@@ -545,1 +597,2 @@\n-.SS Resource directory files considered only when building Linux DEB\/RPM installer:\n+.SS Resource directory files considered only when building Linux DEB\/RPM\n+installer:\n@@ -547,1 +600,1 @@\n-\\f[V]<package-name>-<launcher-name>.service\\f[R]\n+.B \\f[CB]<package\\-name>\\-<launcher\\-name>.service\\f[R]\n@@ -549,1 +602,1 @@\n-service-type application\n+service\\-type application\n@@ -552,1 +605,1 @@\n-Default resource is \\f[I]unit-template.service\\f[R]\n+Default resource is \\f[I]unit\\-template.service\\f[R]\n@@ -554,1 +607,2 @@\n-.SS Resource directory files considered only when building Linux RPM installer:\n+.SS Resource directory files considered only when building Linux RPM\n+installer:\n@@ -556,1 +610,1 @@\n-\\f[V]<package-name>.spec\\f[R]\n+.B \\f[CB]<package\\-name>.spec\\f[R]\n@@ -562,1 +616,2 @@\n-.SS Resource directory files considered only when building Linux DEB installer:\n+.SS Resource directory files considered only when building Linux DEB\n+installer:\n@@ -564,1 +619,1 @@\n-\\f[V]control\\f[R]\n+.B \\f[CB]control\\f[R]\n@@ -571,1 +626,1 @@\n-\\f[V]copyright\\f[R]\n+.B \\f[CB]copyright\\f[R]\n@@ -578,2 +633,2 @@\n-\\f[V]preinstall\\f[R]\n-Pre-install shell script\n+.B \\f[CB]preinstall\\f[R]\n+Pre\\-install shell script\n@@ -585,2 +640,2 @@\n-\\f[V]prerm\\f[R]\n-Pre-remove shell script\n+.B \\f[CB]prerm\\f[R]\n+Pre\\-remove shell script\n@@ -592,2 +647,2 @@\n-\\f[V]postinstall\\f[R]\n-Post-install shell script\n+.B \\f[CB]postinstall\\f[R]\n+Post\\-install shell script\n@@ -599,2 +654,2 @@\n-\\f[V]postrm\\f[R]\n-Post-remove shell script\n+.B \\f[CB]postrm\\f[R]\n+Post\\-remove shell script\n@@ -607,1 +662,1 @@\n-\\f[V]<launcher-name>.ico\\f[R]\n+.B \\f[CB]<launcher\\-name>.ico\\f[R]\n@@ -614,1 +669,1 @@\n-\\f[V]<launcher-name>.properties\\f[R]\n+.B \\f[CB]<launcher\\-name>.properties\\f[R]\n@@ -620,1 +675,2 @@\n-.SS Resource directory files considered only when building Windows MSI\/EXE installer:\n+.SS Resource directory files considered only when building Windows\n+MSI\/EXE installer:\n@@ -622,1 +678,1 @@\n-\\f[V]<application-name>-post-image.wsf\\f[R]\n+.B \\f[CB]<application\\-name>\\-post\\-image.wsf\\f[R]\n@@ -624,0 +680,2 @@\n+.RS\n+.RE\n@@ -625,1 +683,1 @@\n-\\f[V]main.wxs\\f[R]\n+.B \\f[CB]main.wxs\\f[R]\n@@ -632,1 +690,1 @@\n-\\f[V]overrides.wxi\\f[R]\n+.B \\f[CB]overrides.wxi\\f[R]\n@@ -639,1 +697,1 @@\n-\\f[V]service-installer.exe\\f[R]\n+.B \\f[CB]service\\-installer.exe\\f[R]\n@@ -644,1 +702,1 @@\n-service-type applications\n+service\\-type applications\n@@ -647,1 +705,1 @@\n-\\f[V]<launcher-name>-service-install.wxi\\f[R]\n+.B \\f[CB]<launcher\\-name>\\-service\\-install.wxi\\f[R]\n@@ -652,1 +710,1 @@\n-service-type applications\n+service\\-type applications\n@@ -654,1 +712,1 @@\n-Default resource is \\f[I]service-install.wxi\\f[R]\n+Default resource is \\f[I]service\\-install.wxi\\f[R]\n@@ -657,1 +715,1 @@\n-\\f[V]<launcher-name>-service-config.wxi\\f[R]\n+.B \\f[CB]<launcher\\-name>\\-service\\-config.wxi\\f[R]\n@@ -662,1 +720,1 @@\n-service-type applications\n+service\\-type applications\n@@ -664,1 +722,1 @@\n-Default resource is \\f[I]service-config.wxi\\f[R]\n+Default resource is \\f[I]service\\-config.wxi\\f[R]\n@@ -667,1 +725,1 @@\n-\\f[V]InstallDirNotEmptyDlg.wxs\\f[R]\n+.B \\f[CB]InstallDirNotEmptyDlg.wxs\\f[R]\n@@ -675,1 +733,1 @@\n-\\f[V]ShortcutPromptDlg.wxs\\f[R]\n+.B \\f[CB]ShortcutPromptDlg.wxs\\f[R]\n@@ -682,1 +740,1 @@\n-\\f[V]bundle.wxf\\f[R]\n+.B \\f[CB]bundle.wxf\\f[R]\n@@ -684,0 +742,2 @@\n+.RS\n+.RE\n@@ -685,1 +745,1 @@\n-\\f[V]ui.wxf\\f[R]\n+.B \\f[CB]ui.wxf\\f[R]\n@@ -687,1 +747,4 @@\n-.SS Resource directory files considered only when building Windows EXE installer:\n+.RS\n+.RE\n+.SS Resource directory files considered only when building Windows EXE\n+installer:\n@@ -689,1 +752,1 @@\n-\\f[V]WinInstaller.properties\\f[R]\n+.B \\f[CB]WinInstaller.properties\\f[R]\n@@ -696,1 +759,1 @@\n-\\f[V]<package-name>-post-msi.wsf\\f[R]\n+.B \\f[CB]<package\\-name>\\-post\\-msi.wsf\\f[R]\n@@ -699,0 +762,2 @@\n+.RS\n+.RE\n@@ -701,1 +766,1 @@\n-\\f[V]<launcher-name>.icns\\f[R]\n+.B \\f[CB]<launcher\\-name>.icns\\f[R]\n@@ -708,1 +773,1 @@\n-\\f[V]Info.plist\\f[R]\n+.B \\f[CB]Info.plist\\f[R]\n@@ -712,1 +777,1 @@\n-Default resource is \\f[I]Info-lite.plist.template\\f[R]\n+Default resource is \\f[I]Info\\-lite.plist.template\\f[R]\n@@ -715,1 +780,1 @@\n-\\f[V]Runtime-Info.plist\\f[R]\n+.B \\f[CB]Runtime\\-Info.plist\\f[R]\n@@ -719,1 +784,1 @@\n-Default resource is \\f[I]Runtime-Info.plist.template\\f[R]\n+Default resource is \\f[I]Runtime\\-Info.plist.template\\f[R]\n@@ -722,1 +787,1 @@\n-\\f[V]<application-name>.entitlements\\f[R]\n+.B \\f[CB]<application\\-name>.entitlements\\f[R]\n@@ -728,1 +793,2 @@\n-.SS Resource directory files considered only when building macOS PKG\/DMG installer:\n+.SS Resource directory files considered only when building macOS PKG\/DMG\n+installer:\n@@ -730,1 +796,1 @@\n-\\f[V]<package-name>-post-image.sh\\f[R]\n+.B \\f[CB]<package\\-name>\\-post\\-image.sh\\f[R]\n@@ -732,1 +798,4 @@\n-.SS Resource directory files considered only when building macOS PKG installer:\n+.RS\n+.RE\n+.SS Resource directory files considered only when building macOS PKG\n+installer:\n@@ -734,1 +803,1 @@\n-\\f[V]uninstaller\\f[R]\n+.B \\f[CB]uninstaller\\f[R]\n@@ -739,1 +808,1 @@\n-service-type applications\n+service\\-type applications\n@@ -744,2 +813,2 @@\n-\\f[V]preinstall\\f[R]\n-Pre-install shell script\n+.B \\f[CB]preinstall\\f[R]\n+Pre\\-install shell script\n@@ -751,2 +820,2 @@\n-\\f[V]postinstall\\f[R]\n-Post-install shell script\n+.B \\f[CB]postinstall\\f[R]\n+Post\\-install shell script\n@@ -758,2 +827,2 @@\n-\\f[V]services-preinstall\\f[R]\n-Pre-install shell script for services package\n+.B \\f[CB]services\\-preinstall\\f[R]\n+Pre\\-install shell script for services package\n@@ -763,1 +832,1 @@\n-service-type applications\n+service\\-type applications\n@@ -765,1 +834,1 @@\n-Default resource is \\f[I]services-preinstall.template\\f[R]\n+Default resource is \\f[I]services\\-preinstall.template\\f[R]\n@@ -768,2 +837,2 @@\n-\\f[V]services-postinstall\\f[R]\n-Post-install shell script for services package\n+.B \\f[CB]services\\-postinstall\\f[R]\n+Post\\-install shell script for services package\n@@ -773,1 +842,1 @@\n-service-type applications\n+service\\-type applications\n@@ -775,1 +844,1 @@\n-Default resource is \\f[I]services-postinstall.template\\f[R]\n+Default resource is \\f[I]services\\-postinstall.template\\f[R]\n@@ -778,1 +847,1 @@\n-\\f[V]<package-name>-background.png\\f[R]\n+.B \\f[CB]<package\\-name>\\-background.png\\f[R]\n@@ -785,1 +854,1 @@\n-\\f[V]<package-name>-background-darkAqua.png\\f[R]\n+.B \\f[CB]<package\\-name>\\-background\\-darkAqua.png\\f[R]\n@@ -792,1 +861,1 @@\n-\\f[V]product-def.plist\\f[R]\n+.B \\f[CB]product\\-def.plist\\f[R]\n@@ -796,1 +865,1 @@\n-Default resource is \\f[I]product-def.plist\\f[R]\n+Default resource is \\f[I]product\\-def.plist\\f[R]\n@@ -799,1 +868,1 @@\n-\\f[V]<package-name>-<launcher-name>.plist\\f[R]\n+.B \\f[CB]<package\\-name>\\-<launcher\\-name>.plist\\f[R]\n@@ -801,1 +870,1 @@\n-background service-type application\n+background service\\-type application\n@@ -806,1 +875,2 @@\n-.SS Resource directory files considered only when building macOS DMG installer:\n+.SS Resource directory files considered only when building macOS DMG\n+installer:\n@@ -808,1 +878,1 @@\n-\\f[V]<package-name>-dmg-setup.scpt\\f[R]\n+.B \\f[CB]<package\\-name>\\-dmg\\-setup.scpt\\f[R]\n@@ -815,1 +885,1 @@\n-\\f[V]<package-name>-license.plist\\f[R]\n+.B \\f[CB]<package\\-name>\\-license.plist\\f[R]\n@@ -822,1 +892,1 @@\n-\\f[V]<package-name>-background.tiff\\f[R]\n+.B \\f[CB]<package\\-name>\\-background.tiff\\f[R]\n@@ -829,1 +899,1 @@\n-\\f[V]<package-name>-volume.icns\\f[R]\n+.B \\f[CB]<package\\-name>\\-volume.icns\\f[R]\n","filename":"src\/jdk.jpackage\/share\/man\/jpackage.1","additions":289,"deletions":219,"binary":false,"changes":508,"status":"modified"},{"patch":"@@ -3093,1 +3093,1 @@\n-                    } else if (interactiveModeBegun) {\n+                    } else {\n@@ -3103,2 +3103,0 @@\n-                    } else {\n-                        throw new FileNotFoundException(filename);\n","filename":"src\/jdk.jshell\/share\/classes\/jdk\/internal\/jshell\/tool\/JShellTool.java","additions":1,"deletions":3,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -330,2 +330,0 @@\n-\/open <URL>\\n\\t\\\n-    Download and use the specified URL as the jshell tool input.\\n\\\n","filename":"src\/jdk.jshell\/share\/classes\/jdk\/internal\/jshell\/tool\/resources\/l10n.properties","additions":0,"deletions":2,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -22,2 +22,2 @@\n-'\\\" t\n-.\\\" Automatically generated by Pandoc 2.19.2\n+.\\\"t\n+.\\\" Automatically generated by Pandoc 2.3.1\n@@ -25,15 +25,1 @@\n-.\\\" Define V font for inline verbatim, using C font in formats\n-.\\\" that render this, and otherwise B font.\n-.ie \"\\f[CB]x\\f[R]\"x\" \\{\\\n-. ftr V B\n-. ftr VI BI\n-. ftr VB B\n-. ftr VBI BI\n-.\\}\n-.el \\{\\\n-. ftr V CR\n-. ftr VI CI\n-. ftr VB CB\n-. ftr VBI CBI\n-.\\}\n-.TH \"JSHELL\" \"1\" \"2023\" \"JDK 20-ea\" \"JDK Commands\"\n+.TH \"JSHELL\" \"1\" \"2023\" \"JDK 20\\-ea\" \"JDK Commands\"\n@@ -43,2 +29,2 @@\n-jshell - interactively evaluate declarations, statements, and\n-expressions of the Java programming language in a read-eval-print loop\n+jshell \\- interactively evaluate declarations, statements, and\n+expressions of the Java programming language in a read\\-eval\\-print loop\n@@ -48,1 +34,1 @@\n-\\f[V]jshell\\f[R] [\\f[I]options\\f[R]] [\\f[I]load-files\\f[R]]\n+\\f[CB]jshell\\f[R] [\\f[I]options\\f[R]] [\\f[I]load\\-files\\f[R]]\n@@ -50,2 +36,2 @@\n-\\f[I]options\\f[R]\n-Command-line options, separated by spaces.\n+.B \\f[I]options\\f[R]\n+Command\\-line options, separated by spaces.\n@@ -53,0 +39,2 @@\n+.RS\n+.RE\n@@ -54,1 +42,1 @@\n-\\f[I]load-files\\f[R]\n+.B \\f[I]load\\-files\\f[R]\n@@ -61,1 +49,1 @@\n-\\f[V]DEFAULT\\f[R]\n+.B \\f[CB]DEFAULT\\f[R]\n@@ -63,0 +51,2 @@\n+.RS\n+.RE\n@@ -64,1 +54,1 @@\n-\\f[V]JAVASE\\f[R]\n+.B \\f[CB]JAVASE\\f[R]\n@@ -66,0 +56,2 @@\n+.RS\n+.RE\n@@ -67,3 +59,5 @@\n-\\f[V]PRINTING\\f[R]\n-Defines \\f[V]print\\f[R], \\f[V]println\\f[R], and \\f[V]printf\\f[R] as\n-\\f[V]jshell\\f[R] methods for use within the tool.\n+.B \\f[CB]PRINTING\\f[R]\n+Defines \\f[CB]print\\f[R], \\f[CB]println\\f[R], and \\f[CB]printf\\f[R] as\n+\\f[CB]jshell\\f[R] methods for use within the tool.\n+.RS\n+.RE\n@@ -74,3 +68,2 @@\n-Command-line scripts are run after startup scripts.\n-To run a script after JShell is started, use the \\f[V]\/open\\f[R]\n-command.\n+Command\\-line scripts are run after startup scripts.\n+To run a script after JShell is started, use the \\f[CB]\/open\\f[R] command.\n@@ -79,2 +72,2 @@\n-enter a hyphen (-) for \\f[I]load-files\\f[R].\n-This option enables the use of the \\f[V]jshell\\f[R] tool in pipe chains.\n+enter a hyphen (\\-) for \\f[I]load\\-files\\f[R].\n+This option enables the use of the \\f[CB]jshell\\f[R] tool in pipe chains.\n@@ -100,1 +93,1 @@\n-Command-line options are available for configuring the initial\n+Command\\-line options are available for configuring the initial\n@@ -112,1 +105,1 @@\n-\\f[V]--add-exports\\f[R] \\f[I]module\\f[R]\/\\f[I]package\\f[R]\n+.B \\f[CB]\\-\\-add\\-exports\\f[R] \\f[I]module\\f[R]\/\\f[I]package\\f[R]\n@@ -115,0 +108,2 @@\n+.RS\n+.RE\n@@ -116,1 +111,1 @@\n-\\f[V]--add-modules\\f[R] \\f[I]module\\f[R][\\f[V],\\f[R]\\f[I]module\\f[R]...]\n+.B \\f[CB]\\-\\-add\\-modules\\f[R] \\f[I]module\\f[R][\\f[CB],\\f[R]\\f[I]module\\f[R]...]\n@@ -118,0 +113,2 @@\n+.RS\n+.RE\n@@ -119,1 +116,1 @@\n-\\f[V]-C\\f[R]\\f[I]flag\\f[R]\n+.B \\f[CB]\\-C\\f[R]\\f[I]flag\\f[R]\n@@ -123,0 +120,2 @@\n+.RS\n+.RE\n@@ -124,1 +123,1 @@\n-\\f[V]--class-path\\f[R] \\f[I]path\\f[R]\n+.B \\f[CB]\\-\\-class\\-path\\f[R] \\f[I]path\\f[R]\n@@ -127,1 +126,1 @@\n-This option overrides the path in the \\f[V]CLASSPATH\\f[R] environment\n+This option overrides the path in the \\f[CB]CLASSPATH\\f[R] environment\n@@ -133,0 +132,2 @@\n+.RS\n+.RE\n@@ -134,1 +135,1 @@\n-\\f[V]--enable-preview\\f[R]\n+.B \\f[CB]\\-\\-enable\\-preview\\f[R]\n@@ -136,0 +137,2 @@\n+.RS\n+.RE\n@@ -137,3 +140,3 @@\n-\\f[V]--execution\\f[R] \\f[I]specification\\f[R]\n-Specifies an alternate execution engine, where \\f[I]specification\\f[R]\n-is an ExecutionControl spec.\n+.B \\f[CB]\\-\\-execution\\f[R] \\f[I]specification\\f[R]\n+Specifies an alternate execution engine, where \\f[I]specification\\f[R] is\n+an ExecutionControl spec.\n@@ -142,0 +145,2 @@\n+.RS\n+.RE\n@@ -143,1 +148,1 @@\n-\\f[V]--feedback\\f[R] \\f[I]mode\\f[R]\n+.B \\f[CB]\\-\\-feedback\\f[R] \\f[I]mode\\f[R]\n@@ -147,2 +152,2 @@\n-\\f[V]\/set feedback\\f[R] \\f[I]mode\\f[R] command.\n-The default is \\f[V]normal\\f[R].\n+\\f[CB]\/set\\ feedback\\f[R] \\f[I]mode\\f[R] command.\n+The default is \\f[CB]normal\\f[R].\n@@ -153,1 +158,1 @@\n-\\f[V]verbose\\f[R]\n+.B \\f[CB]verbose\\f[R]\n@@ -158,0 +163,2 @@\n+.RS\n+.RE\n@@ -159,1 +166,1 @@\n-\\f[V]normal\\f[R]\n+.B \\f[CB]normal\\f[R]\n@@ -162,0 +169,2 @@\n+.RS\n+.RE\n@@ -163,1 +172,1 @@\n-\\f[V]concise\\f[R]\n+.B \\f[CB]concise\\f[R]\n@@ -166,0 +175,2 @@\n+.RS\n+.RE\n@@ -167,1 +178,1 @@\n-\\f[V]silent\\f[R]\n+.B \\f[CB]silent\\f[R]\n@@ -170,0 +181,2 @@\n+.RS\n+.RE\n@@ -171,1 +184,1 @@\n-\\f[I]custom\\f[R]\n+.B \\f[I]custom\\f[R]\n@@ -174,1 +187,3 @@\n-\\f[V]\/set mode\\f[R] command.\n+\\f[CB]\/set\\ mode\\f[R] command.\n+.RS\n+.RE\n@@ -177,1 +192,1 @@\n-\\f[V]--help\\f[R] or \\f[V]-h\\f[R] or \\f[V]-?\\f[R]\n+.B \\f[CB]\\-\\-help\\f[R] or \\f[CB]\\-h\\f[R] or \\f[CB]\\-?\\f[R]\n@@ -179,0 +194,2 @@\n+.RS\n+.RE\n@@ -180,1 +197,1 @@\n-\\f[V]--help-extra\\f[R] or \\f[V]-X\\f[R]\n+.B \\f[CB]\\-\\-help\\-extra\\f[R] or \\f[CB]\\-X\\f[R]\n@@ -183,0 +200,2 @@\n+.RS\n+.RE\n@@ -184,1 +203,1 @@\n-\\f[V]-J\\f[R]\\f[I]flag\\f[R]\n+.B \\f[CB]\\-J\\f[R]\\f[I]flag\\f[R]\n@@ -188,0 +207,2 @@\n+.RS\n+.RE\n@@ -189,1 +210,1 @@\n-\\f[V]--module-path\\f[R] \\f[I]modulepath\\f[R]\n+.B \\f[CB]\\-\\-module\\-path\\f[R] \\f[I]modulepath\\f[R]\n@@ -193,0 +214,2 @@\n+.RS\n+.RE\n@@ -194,1 +217,1 @@\n-\\f[V]--no-startup\\f[R]\n+.B \\f[CB]\\-\\-no\\-startup\\f[R]\n@@ -199,1 +222,4 @@\n-This option can\\[aq]t be used if the \\f[V]--startup\\f[R] option is used.\n+This option can\\[aq]t be used if the \\f[CB]\\-\\-startup\\f[R] option is\n+used.\n+.RS\n+.RE\n@@ -201,3 +227,5 @@\n-\\f[V]-q\\f[R]\n-Sets the feedback mode to \\f[V]concise\\f[R], which is the same as\n-entering \\f[V]--feedback concise\\f[R].\n+.B \\f[CB]\\-q\\f[R]\n+Sets the feedback mode to \\f[CB]concise\\f[R], which is the same as\n+entering \\f[CB]\\-\\-feedback\\ concise\\f[R].\n+.RS\n+.RE\n@@ -205,1 +233,1 @@\n-\\f[V]-R\\f[R]\\f[I]flag\\f[R]\n+.B \\f[CB]\\-R\\f[R]\\f[I]flag\\f[R]\n@@ -209,0 +237,2 @@\n+.RS\n+.RE\n@@ -210,3 +240,5 @@\n-\\f[V]-s\\f[R]\n-Sets the feedback mode to \\f[V]silent\\f[R], which is the same as\n-entering \\f[V]--feedback silent\\f[R].\n+.B \\f[CB]\\-s\\f[R]\n+Sets the feedback mode to \\f[CB]silent\\f[R], which is the same as entering\n+\\f[CB]\\-\\-feedback\\ silent\\f[R].\n+.RS\n+.RE\n@@ -214,1 +246,1 @@\n-\\f[V]--show-version\\f[R]\n+.B \\f[CB]\\-\\-show\\-version\\f[R]\n@@ -216,0 +248,2 @@\n+.RS\n+.RE\n@@ -217,1 +251,1 @@\n-\\f[V]--startup\\f[R] \\f[I]file\\f[R]\n+.B \\f[CB]\\-\\-startup\\f[R] \\f[I]file\\f[R]\n@@ -225,1 +259,1 @@\n-\\f[V]DEFAULT\\f[R]\n+.B \\f[CB]DEFAULT\\f[R]\n@@ -227,0 +261,2 @@\n+.RS\n+.RE\n@@ -228,1 +264,1 @@\n-\\f[V]JAVASE\\f[R]\n+.B \\f[CB]JAVASE\\f[R]\n@@ -230,0 +266,2 @@\n+.RS\n+.RE\n@@ -231,3 +269,5 @@\n-\\f[V]PRINTING\\f[R]\n-Defines \\f[V]print\\f[R], \\f[V]println\\f[R], and \\f[V]printf\\f[R] as\n-\\f[V]jshell\\f[R] methods for use within the tool.\n+.B \\f[CB]PRINTING\\f[R]\n+Defines \\f[CB]print\\f[R], \\f[CB]println\\f[R], and \\f[CB]printf\\f[R] as\n+\\f[CB]jshell\\f[R] methods for use within the tool.\n+.RS\n+.RE\n@@ -238,2 +278,2 @@\n-session is restarted with the \\f[V]\/reset\\f[R], \\f[V]\/reload\\f[R], or\n-\\f[V]\/env\\f[R] command.\n+session is restarted with the \\f[CB]\/reset\\f[R], \\f[CB]\/reload\\f[R], or\n+\\f[CB]\/env\\f[R] command.\n@@ -243,1 +283,1 @@\n-This option can\\[aq]t be used if the \\f[V]--no-startup\\f[R] option is\n+This option can\\[aq]t be used if the \\f[CB]\\-\\-no\\-startup\\f[R] option is\n@@ -247,3 +287,5 @@\n-\\f[V]-v\\f[R]\n-Sets the feedback mode to \\f[V]verbose\\f[R], which is the same as\n-entering \\f[V]--feedback verbose\\f[R].\n+.B \\f[CB]\\-v\\f[R]\n+Sets the feedback mode to \\f[CB]verbose\\f[R], which is the same as\n+entering \\f[CB]\\-\\-feedback\\ verbose\\f[R].\n+.RS\n+.RE\n@@ -251,1 +293,1 @@\n-\\f[V]--version\\f[R]\n+.B \\f[CB]\\-\\-version\\f[R]\n@@ -253,0 +295,2 @@\n+.RS\n+.RE\n@@ -255,1 +299,1 @@\n-Within the \\f[V]jshell\\f[R] tool, commands are used to modify the\n+Within the \\f[CB]jshell\\f[R] tool, commands are used to modify the\n@@ -258,1 +302,1 @@\n-\\f[V]\/drop\\f[R] {\\f[I]name\\f[R]|\\f[I]id\\f[R]|\\f[I]startID\\f[R]\\f[V]-\\f[R]\\f[I]endID\\f[R]} [{\\f[I]name\\f[R]|\\f[I]id\\f[R]|\\f[I]startID\\f[R]\\f[V]-\\f[R]\\f[I]endID\\f[R]}...]\n+.B \\f[CB]\/drop\\f[R] {\\f[I]name\\f[R]|\\f[I]id\\f[R]|\\f[I]startID\\f[R]\\f[CB]\\-\\f[R]\\f[I]endID\\f[R]} [{\\f[I]name\\f[R]|\\f[I]id\\f[R]|\\f[I]startID\\f[R]\\f[CB]\\-\\f[R]\\f[I]endID\\f[R]}...]\n@@ -264,1 +308,3 @@\n-Use the \\f[V]\/list\\f[R] command to see the IDs of code snippets.\n+Use the \\f[CB]\/list\\f[R] command to see the IDs of code snippets.\n+.RS\n+.RE\n@@ -266,1 +312,1 @@\n-\\f[V]\/edit\\f[R] [\\f[I]option\\f[R]]\n+.B \\f[CB]\/edit\\f[R] [\\f[I]option\\f[R]]\n@@ -273,1 +319,1 @@\n-{\\f[I]name\\f[R]|\\f[I]id\\f[R]|\\f[I]startID\\f[R]\\f[V]-\\f[R]\\f[I]endID\\f[R]} [{\\f[I]name\\f[R]|\\f[I]id\\f[R]|\\f[I]startID\\f[R]\\f[V]-\\f[R]\\f[I]endID\\f[R]}...]\n+.B {\\f[I]name\\f[R]|\\f[I]id\\f[R]|\\f[I]startID\\f[R]\\f[CB]\\-\\f[R]\\f[I]endID\\f[R]} [{\\f[I]name\\f[R]|\\f[I]id\\f[R]|\\f[I]startID\\f[R]\\f[CB]\\-\\f[R]\\f[I]endID\\f[R]}...]\n@@ -278,1 +324,3 @@\n-Use the \\f[V]\/list\\f[R] command to see the IDs of code snippets.\n+Use the \\f[CB]\/list\\f[R] command to see the IDs of code snippets.\n+.RS\n+.RE\n@@ -280,1 +328,1 @@\n-\\f[V]-all\\f[R]\n+.B \\f[CB]\\-all\\f[R]\n@@ -283,0 +331,2 @@\n+.RS\n+.RE\n@@ -284,1 +334,1 @@\n-\\f[V]-start\\f[R]\n+.B \\f[CB]\\-start\\f[R]\n@@ -287,0 +337,2 @@\n+.RS\n+.RE\n@@ -289,1 +341,1 @@\n-provided if the \\f[V]-wait\\f[R] option was used when the editor was set.\n+provided if the \\f[CB]\\-wait\\f[R] option was used when the editor was set.\n@@ -291,1 +343,1 @@\n-Use the \\f[V]\/set editor\\f[R] command to specify the editor to use.\n+Use the \\f[CB]\/set\\ editor\\f[R] command to specify the editor to use.\n@@ -293,2 +345,2 @@\n-checked in order: \\f[V]JSHELLEDITOR\\f[R], \\f[V]VISUAL\\f[R], and\n-\\f[V]EDITOR\\f[R].\n+checked in order: \\f[CB]JSHELLEDITOR\\f[R], \\f[CB]VISUAL\\f[R], and\n+\\f[CB]EDITOR\\f[R].\n@@ -299,1 +351,1 @@\n-\\f[V]\/env\\f[R] [\\f[I]options\\f[R]]\n+.B \\f[CB]\/env\\f[R] [\\f[I]options\\f[R]]\n@@ -315,3 +367,3 @@\n-The history includes all valid snippets or \\f[V]\/drop\\f[R] commands\n-entered at the \\f[V]jshell\\f[R] prompt, in scripts entered on the\n-command line, or scripts entered with the \\f[V]\/open\\f[R] command.\n+The history includes all valid snippets or \\f[CB]\/drop\\f[R] commands\n+entered at the \\f[CB]jshell\\f[R] prompt, in scripts entered on the command\n+line, or scripts entered with the \\f[CB]\/open\\f[R] command.\n@@ -320,2 +372,2 @@\n-previous \\f[V]\/reset\\f[R], \\f[V]\/env\\f[R], or \\f[V]\/reload\\f[R] command\n-are maintained unless an \\f[I]option\\f[R] is entered that overwrites the\n+previous \\f[CB]\/reset\\f[R], \\f[CB]\/env\\f[R], or \\f[CB]\/reload\\f[R] command are\n+maintained unless an \\f[I]option\\f[R] is entered that overwrites the\n@@ -326,1 +378,1 @@\n-\\f[V]--add-modules\\f[R] \\f[I]module\\f[R][\\f[V],\\f[R]\\f[I]module\\f[R]...]\n+.B \\f[CB]\\-\\-add\\-modules\\f[R] \\f[I]module\\f[R][\\f[CB],\\f[R]\\f[I]module\\f[R]...]\n@@ -328,0 +380,2 @@\n+.RS\n+.RE\n@@ -329,3 +383,5 @@\n-\\f[V]--add-exports\\f[R] \\f[I]source-module\\f[R]\\f[V]\/\\f[R]\\f[I]package\\f[R]\\f[V]=\\f[R]\\f[I]target-module\\f[R][\\f[V],\\f[R]\\f[I]target-module\\f[R]]*\n-Adds an export of \\f[I]package\\f[R] from \\f[I]source-module\\f[R] to\n-\\f[I]target-module\\f[R].\n+.B \\f[CB]\\-\\-add\\-exports\\f[R] \\f[I]source\\-module\\f[R]\\f[CB]\/\\f[R]\\f[I]package\\f[R]\\f[CB]=\\f[R]\\f[I]target\\-module\\f[R][\\f[CB],\\f[R]\\f[I]target\\-module\\f[R]]*\n+Adds an export of \\f[I]package\\f[R] from \\f[I]source\\-module\\f[R] to\n+\\f[I]target\\-module\\f[R].\n+.RS\n+.RE\n@@ -333,1 +389,1 @@\n-\\f[V]--class-path\\f[R] \\f[I]path\\f[R]\n+.B \\f[CB]\\-\\-class\\-path\\f[R] \\f[I]path\\f[R]\n@@ -336,1 +392,1 @@\n-This option overrides the path in the \\f[V]CLASSPATH\\f[R] environment\n+This option overrides the path in the \\f[CB]CLASSPATH\\f[R] environment\n@@ -340,1 +396,1 @@\n-For Linux and macOS, use a colon (\\f[V]:\\f[R]) to separate items in the\n+For Linux and macOS, use a colon (\\f[CB]:\\f[R]) to separate items in the\n@@ -342,1 +398,3 @@\n-For Windows, use a semicolon (\\f[V];\\f[R]) to separate items.\n+For Windows, use a semicolon (\\f[CB];\\f[R]) to separate items.\n+.RS\n+.RE\n@@ -344,1 +402,1 @@\n-\\f[V]--module-path\\f[R] \\f[I]modulepath\\f[R]\n+.B \\f[CB]\\-\\-module\\-path\\f[R] \\f[I]modulepath\\f[R]\n@@ -346,1 +404,1 @@\n-For Linux and macOS, use a colon (\\f[V]:\\f[R]) to separate items in the\n+For Linux and macOS, use a colon (\\f[CB]:\\f[R]) to separate items in the\n@@ -348,1 +406,3 @@\n-For Windows, use a semicolon (\\f[V];\\f[R]) to separate items.\n+For Windows, use a semicolon (\\f[CB];\\f[R]) to separate items.\n+.RS\n+.RE\n@@ -351,1 +411,1 @@\n-\\f[V]\/exit\\f[R] [\\f[I]integer-expression-snippet\\f[R]]\n+.B \\f[CB]\/exit\\f[R] [\\f[I]integer\\-expression\\-snippet\\f[R]]\n@@ -358,0 +418,2 @@\n+.RS\n+.RE\n@@ -359,1 +421,1 @@\n-\\f[V]\/history\\f[R]\n+.B \\f[CB]\/history\\f[R]\n@@ -361,0 +423,2 @@\n+.RS\n+.RE\n@@ -362,1 +426,1 @@\n-\\f[V]\/help\\f[R] [\\f[I]command\\f[R]|\\f[I]subject\\f[R]]\n+.B \\f[CB]\/help\\f[R] [\\f[I]command\\f[R]|\\f[I]subject\\f[R]]\n@@ -374,1 +438,1 @@\n-\\f[V]context\\f[R]\n+.B \\f[CB]context\\f[R]\n@@ -377,0 +441,2 @@\n+.RS\n+.RE\n@@ -378,1 +444,1 @@\n-\\f[V]intro\\f[R]\n+.B \\f[CB]intro\\f[R]\n@@ -380,0 +446,2 @@\n+.RS\n+.RE\n@@ -381,1 +449,1 @@\n-\\f[V]shortcuts\\f[R]\n+.B \\f[CB]shortcuts\\f[R]\n@@ -384,0 +452,2 @@\n+.RS\n+.RE\n@@ -386,1 +456,1 @@\n-\\f[V]\/imports\\f[R]\n+.B \\f[CB]\/imports\\f[R]\n@@ -390,0 +460,2 @@\n+.RS\n+.RE\n@@ -391,1 +463,1 @@\n-\\f[V]\/list\\f[R] [\\f[I]option\\f[R]]\n+.B \\f[CB]\/list\\f[R] [\\f[I]option\\f[R]]\n@@ -399,1 +471,1 @@\n-{\\f[I]name\\f[R]|\\f[I]id\\f[R]|\\f[I]startID\\f[R]\\f[V]-\\f[R]\\f[I]endID\\f[R]} [{\\f[I]name\\f[R]|\\f[I]id\\f[R]|\\f[I]startID\\f[R]\\f[V]-\\f[R]\\f[I]endID\\f[R]}...]\n+.B {\\f[I]name\\f[R]|\\f[I]id\\f[R]|\\f[I]startID\\f[R]\\f[CB]\\-\\f[R]\\f[I]endID\\f[R]} [{\\f[I]name\\f[R]|\\f[I]id\\f[R]|\\f[I]startID\\f[R]\\f[CB]\\-\\f[R]\\f[I]endID\\f[R]}...]\n@@ -404,0 +476,2 @@\n+.RS\n+.RE\n@@ -405,1 +479,1 @@\n-\\f[V]-all\\f[R]\n+.B \\f[CB]\\-all\\f[R]\n@@ -408,2 +482,4 @@\n-IDs that begin with \\f[V]s\\f[R] are startup snippets.\n-IDs that begin with \\f[V]e\\f[R] are snippets that failed.\n+IDs that begin with \\f[CB]s\\f[R] are startup snippets.\n+IDs that begin with \\f[CB]e\\f[R] are snippets that failed.\n+.RS\n+.RE\n@@ -411,1 +487,1 @@\n-\\f[V]-start\\f[R]\n+.B \\f[CB]\\-start\\f[R]\n@@ -413,0 +489,2 @@\n+.RS\n+.RE\n@@ -415,1 +493,1 @@\n-\\f[V]\/methods\\f[R] [\\f[I]option\\f[R]]\n+.B \\f[CB]\/methods\\f[R] [\\f[I]option\\f[R]]\n@@ -423,1 +501,1 @@\n-{\\f[I]name\\f[R]|\\f[I]id\\f[R]|\\f[I]startID\\f[R]\\f[V]-\\f[R]\\f[I]endID\\f[R]} [{\\f[I]name\\f[R]|\\f[I]id\\f[R]|\\f[I]startID\\f[R]\\f[V]-\\f[R]\\f[I]endID\\f[R]}...]\n+.B {\\f[I]name\\f[R]|\\f[I]id\\f[R]|\\f[I]startID\\f[R]\\f[CB]\\-\\f[R]\\f[I]endID\\f[R]} [{\\f[I]name\\f[R]|\\f[I]id\\f[R]|\\f[I]startID\\f[R]\\f[CB]\\-\\f[R]\\f[I]endID\\f[R]}...]\n@@ -428,1 +506,3 @@\n-Use the \\f[V]\/list\\f[R] command to see the IDs of code snippets.\n+Use the \\f[CB]\/list\\f[R] command to see the IDs of code snippets.\n+.RS\n+.RE\n@@ -430,1 +510,1 @@\n-\\f[V]-all\\f[R]\n+.B \\f[CB]\\-all\\f[R]\n@@ -433,0 +513,2 @@\n+.RS\n+.RE\n@@ -434,1 +516,1 @@\n-\\f[V]-start\\f[R]\n+.B \\f[CB]\\-start\\f[R]\n@@ -437,0 +519,2 @@\n+.RS\n+.RE\n@@ -439,1 +523,1 @@\n-\\f[V]\/open\\f[R] \\f[I]file\\f[R]\n+.B \\f[CB]\/open\\f[R] \\f[I]file\\f[R]\n@@ -445,1 +529,1 @@\n-\\f[V]DEFAULT\\f[R]\n+.B \\f[CB]DEFAULT\\f[R]\n@@ -447,0 +531,2 @@\n+.RS\n+.RE\n@@ -448,1 +534,1 @@\n-\\f[V]JAVASE\\f[R]\n+.B \\f[CB]JAVASE\\f[R]\n@@ -450,0 +536,2 @@\n+.RS\n+.RE\n@@ -451,3 +539,5 @@\n-\\f[V]PRINTING\\f[R]\n-Defines \\f[V]print\\f[R], \\f[V]println\\f[R], and \\f[V]printf\\f[R] as\n-\\f[V]jshell\\f[R] methods for use within the tool.\n+.B \\f[CB]PRINTING\\f[R]\n+Defines \\f[CB]print\\f[R], \\f[CB]println\\f[R], and \\f[CB]printf\\f[R] as\n+\\f[CB]jshell\\f[R] methods for use within the tool.\n+.RS\n+.RE\n@@ -456,1 +546,1 @@\n-\\f[V]\/reload\\f[R] [\\f[I]options\\f[R]]\n+.B \\f[CB]\/reload\\f[R] [\\f[I]options\\f[R]]\n@@ -467,3 +557,3 @@\n-The history includes all valid snippets or \\f[V]\/drop\\f[R] commands\n-entered at the \\f[V]jshell\\f[R] prompt, in scripts entered on the\n-command line, or scripts entered with the \\f[V]\/open\\f[R] command.\n+The history includes all valid snippets or \\f[CB]\/drop\\f[R] commands\n+entered at the \\f[CB]jshell\\f[R] prompt, in scripts entered on the command\n+line, or scripts entered with the \\f[CB]\/open\\f[R] command.\n@@ -472,2 +562,2 @@\n-previous \\f[V]\/reset\\f[R], \\f[V]\/env\\f[R], or \\f[V]\/reload\\f[R] command\n-are maintained unless an \\f[I]option\\f[R] is entered that overwrites the\n+previous \\f[CB]\/reset\\f[R], \\f[CB]\/env\\f[R], or \\f[CB]\/reload\\f[R] command are\n+maintained unless an \\f[I]option\\f[R] is entered that overwrites the\n@@ -478,1 +568,1 @@\n-\\f[V]--add-modules\\f[R] \\f[I]module\\f[R][\\f[V],\\f[R]\\f[I]module\\f[R]...]\n+.B \\f[CB]\\-\\-add\\-modules\\f[R] \\f[I]module\\f[R][\\f[CB],\\f[R]\\f[I]module\\f[R]...]\n@@ -480,0 +570,2 @@\n+.RS\n+.RE\n@@ -481,3 +573,5 @@\n-\\f[V]--add-exports\\f[R] \\f[I]source-module\\f[R]\\f[V]\/\\f[R]\\f[I]package\\f[R]\\f[V]=\\f[R]\\f[I]target-module\\f[R][\\f[V],\\f[R]\\f[I]target-module\\f[R]]*\n-Adds an export of \\f[I]package\\f[R] from \\f[I]source-module\\f[R] to\n-\\f[I]target-module\\f[R].\n+.B \\f[CB]\\-\\-add\\-exports\\f[R] \\f[I]source\\-module\\f[R]\\f[CB]\/\\f[R]\\f[I]package\\f[R]\\f[CB]=\\f[R]\\f[I]target\\-module\\f[R][\\f[CB],\\f[R]\\f[I]target\\-module\\f[R]]*\n+Adds an export of \\f[I]package\\f[R] from \\f[I]source\\-module\\f[R] to\n+\\f[I]target\\-module\\f[R].\n+.RS\n+.RE\n@@ -485,1 +579,1 @@\n-\\f[V]--class-path\\f[R] \\f[I]path\\f[R]\n+.B \\f[CB]\\-\\-class\\-path\\f[R] \\f[I]path\\f[R]\n@@ -488,1 +582,1 @@\n-This option overrides the path in the \\f[V]CLASSPATH\\f[R] environment\n+This option overrides the path in the \\f[CB]CLASSPATH\\f[R] environment\n@@ -492,1 +586,1 @@\n-For Linux and macOS, use a colon (\\f[V]:\\f[R]) to separate items in the\n+For Linux and macOS, use a colon (\\f[CB]:\\f[R]) to separate items in the\n@@ -494,1 +588,3 @@\n-For Windows, use a semicolon (\\f[V];\\f[R]) to separate items.\n+For Windows, use a semicolon (\\f[CB];\\f[R]) to separate items.\n+.RS\n+.RE\n@@ -496,1 +592,1 @@\n-\\f[V]--module-path\\f[R] \\f[I]modulepath\\f[R]\n+.B \\f[CB]\\-\\-module\\-path\\f[R] \\f[I]modulepath\\f[R]\n@@ -498,1 +594,1 @@\n-For Linux and macOS, use a colon (\\f[V]:\\f[R]) to separate items in the\n+For Linux and macOS, use a colon (\\f[CB]:\\f[R]) to separate items in the\n@@ -500,1 +596,3 @@\n-For Windows, use a semicolon (\\f[V];\\f[R]) to separate items.\n+For Windows, use a semicolon (\\f[CB];\\f[R]) to separate items.\n+.RS\n+.RE\n@@ -502,1 +600,1 @@\n-\\f[V]-quiet\\f[R]\n+.B \\f[CB]\\-quiet\\f[R]\n@@ -505,0 +603,2 @@\n+.RS\n+.RE\n@@ -506,1 +606,1 @@\n-\\f[V]-restore\\f[R]\n+.B \\f[CB]\\-restore\\f[R]\n@@ -508,2 +608,2 @@\n-the tool or to the last time a \\f[V]\/reset\\f[R], \\f[V]\/reload\\f[R], or\n-\\f[V]\/env\\f[R] command was executed in the previous run.\n+the tool or to the last time a \\f[CB]\/reset\\f[R], \\f[CB]\/reload\\f[R], or\n+\\f[CB]\/env\\f[R] command was executed in the previous run.\n@@ -512,0 +612,2 @@\n+.RS\n+.RE\n@@ -514,1 +616,1 @@\n-\\f[V]\/reset\\f[R] [\\f[I]options\\f[R]]\n+.B \\f[CB]\/reset\\f[R] [\\f[I]options\\f[R]]\n@@ -528,2 +630,2 @@\n-previous \\f[V]\/reset\\f[R], \\f[V]\/env\\f[R], or \\f[V]\/reload\\f[R] command\n-are maintained unless an \\f[I]option\\f[R] is entered that overwrites the\n+previous \\f[CB]\/reset\\f[R], \\f[CB]\/env\\f[R], or \\f[CB]\/reload\\f[R] command are\n+maintained unless an \\f[I]option\\f[R] is entered that overwrites the\n@@ -534,1 +636,1 @@\n-\\f[V]--add-modules\\f[R] \\f[I]module\\f[R][\\f[V],\\f[R]\\f[I]module\\f[R]...]\n+.B \\f[CB]\\-\\-add\\-modules\\f[R] \\f[I]module\\f[R][\\f[CB],\\f[R]\\f[I]module\\f[R]...]\n@@ -536,0 +638,2 @@\n+.RS\n+.RE\n@@ -537,3 +641,5 @@\n-\\f[V]--add-exports\\f[R] \\f[I]source-module\\f[R]\\f[V]\/\\f[R]\\f[I]package\\f[R]\\f[V]=\\f[R]\\f[I]target-module\\f[R][\\f[V],\\f[R]\\f[I]target-module\\f[R]]*\n-Adds an export of \\f[I]package\\f[R] from \\f[I]source-module\\f[R] to\n-\\f[I]target-module\\f[R].\n+.B \\f[CB]\\-\\-add\\-exports\\f[R] \\f[I]source\\-module\\f[R]\\f[CB]\/\\f[R]\\f[I]package\\f[R]\\f[CB]=\\f[R]\\f[I]target\\-module\\f[R][\\f[CB],\\f[R]\\f[I]target\\-module\\f[R]]*\n+Adds an export of \\f[I]package\\f[R] from \\f[I]source\\-module\\f[R] to\n+\\f[I]target\\-module\\f[R].\n+.RS\n+.RE\n@@ -541,1 +647,1 @@\n-\\f[V]--class-path\\f[R] \\f[I]path\\f[R]\n+.B \\f[CB]\\-\\-class\\-path\\f[R] \\f[I]path\\f[R]\n@@ -544,1 +650,1 @@\n-This option overrides the path in the \\f[V]CLASSPATH\\f[R] environment\n+This option overrides the path in the \\f[CB]CLASSPATH\\f[R] environment\n@@ -548,1 +654,1 @@\n-For Linux and macOS, use a colon (\\f[V]:\\f[R]) to separate items in the\n+For Linux and macOS, use a colon (\\f[CB]:\\f[R]) to separate items in the\n@@ -550,1 +656,3 @@\n-For Windows, use a semicolon (\\f[V];\\f[R]) to separate items.\n+For Windows, use a semicolon (\\f[CB];\\f[R]) to separate items.\n+.RS\n+.RE\n@@ -552,1 +660,1 @@\n-\\f[V]--module-path\\f[R] \\f[I]modulepath\\f[R]\n+.B \\f[CB]\\-\\-module\\-path\\f[R] \\f[I]modulepath\\f[R]\n@@ -554,1 +662,1 @@\n-For Linux and macOS, use a colon (\\f[V]:\\f[R]) to separate items in the\n+For Linux and macOS, use a colon (\\f[CB]:\\f[R]) to separate items in the\n@@ -556,1 +664,3 @@\n-For Windows, use a semicolon (\\f[V];\\f[R]) to separate items.\n+For Windows, use a semicolon (\\f[CB];\\f[R]) to separate items.\n+.RS\n+.RE\n@@ -559,1 +669,1 @@\n-\\f[V]\/save\\f[R] [\\f[I]options\\f[R]] \\f[I]file\\f[R]\n+.B \\f[CB]\/save\\f[R] [\\f[I]options\\f[R]] \\f[I]file\\f[R]\n@@ -566,1 +676,1 @@\n-{\\f[I]name\\f[R]|\\f[I]id\\f[R]|\\f[I]startID\\f[R]\\f[V]-\\f[R]\\f[I]endID\\f[R]} [{\\f[I]name\\f[R]|\\f[I]id\\f[R]|\\f[I]startID\\f[R]\\f[V]-\\f[R]\\f[I]endID\\f[R]}...]\n+.B {\\f[I]name\\f[R]|\\f[I]id\\f[R]|\\f[I]startID\\f[R]\\f[CB]\\-\\f[R]\\f[I]endID\\f[R]} [{\\f[I]name\\f[R]|\\f[I]id\\f[R]|\\f[I]startID\\f[R]\\f[CB]\\-\\f[R]\\f[I]endID\\f[R]}...]\n@@ -571,1 +681,3 @@\n-Use the \\f[V]\/list\\f[R] command to see the IDs of the code snippets.\n+Use the \\f[CB]\/list\\f[R] command to see the IDs of the code snippets.\n+.RS\n+.RE\n@@ -573,1 +685,1 @@\n-\\f[V]-all\\f[R]\n+.B \\f[CB]\\-all\\f[R]\n@@ -576,0 +688,2 @@\n+.RS\n+.RE\n@@ -577,1 +691,1 @@\n-\\f[V]-history\\f[R]\n+.B \\f[CB]\\-history\\f[R]\n@@ -580,0 +694,2 @@\n+.RS\n+.RE\n@@ -581,1 +697,1 @@\n-\\f[V]-start\\f[R]\n+.B \\f[CB]\\-start\\f[R]\n@@ -584,0 +700,2 @@\n+.RS\n+.RE\n@@ -586,1 +704,1 @@\n-\\f[V]\/set\\f[R] [\\f[I]setting\\f[R]]\n+.B \\f[CB]\/set\\f[R] [\\f[I]setting\\f[R]]\n@@ -595,1 +713,1 @@\n-The following values are valid for \\f[V]setting\\f[R]:\n+The following values are valid for \\f[CB]setting\\f[R]:\n@@ -597,1 +715,1 @@\n-\\f[V]editor\\f[R] [\\f[I]options\\f[R]] [\\f[I]command\\f[R]]\n+.B \\f[CB]editor\\f[R] [\\f[I]options\\f[R]] [\\f[I]command\\f[R]]\n@@ -599,1 +717,1 @@\n-\\f[V]\/edit\\f[R] command is entered.\n+\\f[CB]\/edit\\f[R] command is entered.\n@@ -607,1 +725,1 @@\n-\\f[V]-default\\f[R]\n+.B \\f[CB]\\-default\\f[R]\n@@ -611,0 +729,2 @@\n+.RS\n+.RE\n@@ -612,1 +732,1 @@\n-\\f[V]-delete\\f[R]\n+.B \\f[CB]\\-delete\\f[R]\n@@ -614,1 +734,1 @@\n-If used with the \\f[V]-retain\\f[R] option, then the retained editor\n+If used with the \\f[CB]\\-retain\\f[R] option, then the retained editor\n@@ -616,2 +736,2 @@\n-environment variables found: \\f[V]JSHELLEDITOR\\f[R], \\f[V]VISUAL\\f[R],\n-or \\f[V]EDITOR\\f[R].\n+environment variables found: \\f[CB]JSHELLEDITOR\\f[R], \\f[CB]VISUAL\\f[R], or\n+\\f[CB]EDITOR\\f[R].\n@@ -626,1 +746,1 @@\n-\\f[V]-retain\\f[R]\n+.B \\f[CB]\\-retain\\f[R]\n@@ -630,0 +750,2 @@\n+.RS\n+.RE\n@@ -631,1 +753,1 @@\n-\\f[V]-wait\\f[R]\n+.B \\f[CB]\\-wait\\f[R]\n@@ -638,0 +760,2 @@\n+.RS\n+.RE\n@@ -640,1 +764,1 @@\n-\\f[V]feedback\\f[R] [\\f[I]mode\\f[R]]\n+.B \\f[CB]feedback\\f[R] [\\f[I]mode\\f[R]]\n@@ -645,3 +769,3 @@\n-The following modes are valid: \\f[V]concise\\f[R], \\f[V]normal\\f[R],\n-\\f[V]silent\\f[R], \\f[V]verbose\\f[R], and any custom mode created with\n-the \\f[V]\/set mode\\f[R] command.\n+The following modes are valid: \\f[CB]concise\\f[R], \\f[CB]normal\\f[R],\n+\\f[CB]silent\\f[R], \\f[CB]verbose\\f[R], and any custom mode created with the\n+\\f[CB]\/set\\ mode\\f[R] command.\n@@ -650,1 +774,1 @@\n-\\f[V]format\\f[R] \\f[I]mode\\f[R] \\f[I]field\\f[R] \\f[V]\\[dq]\\f[R]\\f[I]format-string\\f[R]\\f[V]\\[dq]\\f[R] \\f[I]selector\\f[R]\n+.B \\f[CB]format\\f[R] \\f[I]mode\\f[R] \\f[I]field\\f[R] \\f[CB]\"\\f[R]\\f[I]format\\-string\\f[R]\\f[CB]\"\\f[R] \\f[I]selector\\f[R]\n@@ -662,1 +786,1 @@\n-\\f[I]mode\\f[R]\n+.B \\f[I]mode\\f[R]\n@@ -664,1 +788,1 @@\n-Only custom modes created with the \\f[V]\/set mode\\f[R] command can be\n+Only custom modes created with the \\f[CB]\/set\\ mode\\f[R] command can be\n@@ -666,0 +790,2 @@\n+.RS\n+.RE\n@@ -667,2 +793,2 @@\n-\\f[I]field\\f[R]\n-Specifies a context-specific field to which the response format is\n+.B \\f[I]field\\f[R]\n+Specifies a context\\-specific field to which the response format is\n@@ -671,1 +797,3 @@\n-JShell using the \\f[V]\/help \/set format\\f[R] command.\n+JShell using the \\f[CB]\/help\\ \/set\\ format\\f[R] command.\n+.RS\n+.RE\n@@ -673,1 +801,1 @@\n-\\f[V]\\[dq]\\f[R]\\f[I]format-string\\f[R]\\f[V]\\[dq]\\f[R]\n+.B \\f[CB]\"\\f[R]\\f[I]format\\-string\\f[R]\\f[CB]\"\\f[R]\n@@ -677,1 +805,1 @@\n-which is accessed from JShell using the \\f[V]\/help \/set format\\f[R]\n+which is accessed from JShell using the \\f[CB]\/help\\ \/set\\ format\\f[R]\n@@ -679,0 +807,2 @@\n+.RS\n+.RE\n@@ -680,1 +810,1 @@\n-\\f[I]selector\\f[R]\n+.B \\f[I]selector\\f[R]\n@@ -683,1 +813,3 @@\n-JShell using the \\f[V]\/help \/set format\\f[R] command.\n+JShell using the \\f[CB]\/help\\ \/set\\ format\\f[R] command.\n+.RS\n+.RE\n@@ -686,1 +818,1 @@\n-\\f[V]mode\\f[R] [\\f[I]mode-name\\f[R]] [\\f[I]existing-mode\\f[R]] [\\f[I]options\\f[R]]\n+.B \\f[CB]mode\\f[R] [\\f[I]mode\\-name\\f[R]] [\\f[I]existing\\-mode\\f[R]] [\\f[I]options\\f[R]]\n@@ -697,1 +829,1 @@\n-\\f[V]-command\\f[R]|\\f[V]-quiet\\f[R]\n+.B \\f[CB]\\-command\\f[R]|\\f[CB]\\-quiet\\f[R]\n@@ -701,1 +833,1 @@\n-Use \\f[V]-command\\f[R] to show information and verification feedback for\n+Use \\f[CB]\\-command\\f[R] to show information and verification feedback for\n@@ -703,1 +835,1 @@\n-Use \\f[V]-quiet\\f[R] to show only essential feedback for commands, such\n+Use \\f[CB]\\-quiet\\f[R] to show only essential feedback for commands, such\n@@ -705,0 +837,2 @@\n+.RS\n+.RE\n@@ -706,1 +840,1 @@\n-\\f[V]-delete\\f[R]\n+.B \\f[CB]\\-delete\\f[R]\n@@ -709,1 +843,1 @@\n-To permanently delete a retained mode, use the \\f[V]-retain\\f[R] option\n+To permanently delete a retained mode, use the \\f[CB]\\-retain\\f[R] option\n@@ -712,0 +846,2 @@\n+.RS\n+.RE\n@@ -713,1 +849,1 @@\n-\\f[V]-retain\\f[R]\n+.B \\f[CB]\\-retain\\f[R]\n@@ -716,0 +852,2 @@\n+.RS\n+.RE\n@@ -717,2 +855,2 @@\n-Configure the new feedback mode using the \\f[V]\/set prompt\\f[R],\n-\\f[V]\/set format\\f[R], and \\f[V]\/set truncation\\f[R] commands.\n+Configure the new feedback mode using the \\f[CB]\/set\\ prompt\\f[R],\n+\\f[CB]\/set\\ format\\f[R], and \\f[CB]\/set\\ truncation\\f[R] commands.\n@@ -720,1 +858,1 @@\n-To start using the new mode, use the \\f[V]\/set feedback\\f[R] command.\n+To start using the new mode, use the \\f[CB]\/set\\ feedback\\f[R] command.\n@@ -723,1 +861,1 @@\n-\\f[V]prompt\\f[R] \\f[I]mode\\f[R] \\f[V]\\[dq]\\f[R]\\f[I]prompt-string\\f[R]\\f[V]\\[dq]\\f[R] \\f[V]\\[dq]\\f[R]\\f[I]continuation-prompt-string\\f[R]\\f[V]\\[dq]\\f[R]\n+.B \\f[CB]prompt\\f[R] \\f[I]mode\\f[R] \\f[CB]\"\\f[R]\\f[I]prompt\\-string\\f[R]\\f[CB]\"\\f[R] \\f[CB]\"\\f[R]\\f[I]continuation\\-prompt\\-string\\f[R]\\f[CB]\"\\f[R]\n@@ -733,1 +871,1 @@\n-\\f[I]mode\\f[R]\n+.B \\f[I]mode\\f[R]\n@@ -735,1 +873,1 @@\n-Only custom modes created with the \\f[V]\/set mode\\f[R] command can be\n+Only custom modes created with the \\f[CB]\/set\\ mode\\f[R] command can be\n@@ -737,0 +875,2 @@\n+.RS\n+.RE\n@@ -738,1 +878,1 @@\n-\\f[V]\\[dq]\\f[R]\\f[I]prompt-string\\f[R]\\f[V]\\[dq]\\f[R]\n+.B \\f[CB]\"\\f[R]\\f[I]prompt\\-string\\f[R]\\f[CB]\"\\f[R]\n@@ -740,0 +880,2 @@\n+.RS\n+.RE\n@@ -741,1 +883,1 @@\n-\\f[V]\\[dq]\\f[R]\\f[I]continuation-prompt-string\\f[R]\\f[V]\\[dq]\\f[R]\n+.B \\f[CB]\"\\f[R]\\f[I]continuation\\-prompt\\-string\\f[R]\\f[CB]\"\\f[R]\n@@ -744,0 +886,2 @@\n+.RS\n+.RE\n@@ -746,1 +890,1 @@\n-\\f[V]start\\f[R] [\\f[V]-retain\\f[R]] [\\f[I]file\\f[R] [\\f[I]file\\f[R]...]|\\f[I]option\\f[R]]\n+.B \\f[CB]start\\f[R] [\\f[CB]\\-retain\\f[R]] [\\f[I]file\\f[R] [\\f[I]file\\f[R]...]|\\f[I]option\\f[R]]\n@@ -748,2 +892,1 @@\n-\\f[V]\/reset\\f[R], \\f[V]\/reload\\f[R], or \\f[V]\/env\\f[R] command is\n-entered.\n+\\f[CB]\/reset\\f[R], \\f[CB]\/reload\\f[R], or \\f[CB]\/env\\f[R] command is entered.\n@@ -759,1 +902,1 @@\n-\\f[V]DEFAULT\\f[R]\n+.B \\f[CB]DEFAULT\\f[R]\n@@ -761,0 +904,2 @@\n+.RS\n+.RE\n@@ -762,1 +907,1 @@\n-\\f[V]JAVASE\\f[R]\n+.B \\f[CB]JAVASE\\f[R]\n@@ -764,0 +909,2 @@\n+.RS\n+.RE\n@@ -765,3 +912,5 @@\n-\\f[V]PRINTING\\f[R]\n-Defines \\f[V]print\\f[R], \\f[V]println\\f[R], and \\f[V]printf\\f[R] as\n-\\f[V]jshell\\f[R] methods for use within the tool.\n+.B \\f[CB]PRINTING\\f[R]\n+Defines \\f[CB]print\\f[R], \\f[CB]println\\f[R], and \\f[CB]printf\\f[R] as\n+\\f[CB]jshell\\f[R] methods for use within the tool.\n+.RS\n+.RE\n@@ -771,1 +920,1 @@\n-\\f[V]-default\\f[R]\n+.B \\f[CB]\\-default\\f[R]\n@@ -773,0 +922,2 @@\n+.RS\n+.RE\n@@ -774,1 +925,1 @@\n-\\f[V]-none\\f[R]\n+.B \\f[CB]\\-none\\f[R]\n@@ -776,0 +927,2 @@\n+.RS\n+.RE\n@@ -777,1 +930,1 @@\n-Use the \\f[V]-retain\\f[R] option to save the start setting across\n+Use the \\f[CB]\\-retain\\f[R] option to save the start setting across\n@@ -781,1 +934,1 @@\n-\\f[V]truncation\\f[R] \\f[I]mode\\f[R] \\f[I]length\\f[R] \\f[I]selector\\f[R]\n+.B \\f[CB]truncation\\f[R] \\f[I]mode\\f[R] \\f[I]length\\f[R] \\f[I]selector\\f[R]\n@@ -791,1 +944,1 @@\n-\\f[I]mode\\f[R]\n+.B \\f[I]mode\\f[R]\n@@ -793,1 +946,1 @@\n-Only custom modes created with the \\f[V]\/set mode\\f[R] command can be\n+Only custom modes created with the \\f[CB]\/set\\ mode\\f[R] command can be\n@@ -795,0 +948,2 @@\n+.RS\n+.RE\n@@ -796,1 +951,1 @@\n-\\f[I]length\\f[R]\n+.B \\f[I]length\\f[R]\n@@ -799,0 +954,2 @@\n+.RS\n+.RE\n@@ -800,1 +957,1 @@\n-\\f[I]selector\\f[R]\n+.B \\f[I]selector\\f[R]\n@@ -803,1 +960,3 @@\n-JShell using the \\f[V]\/help \/set truncation\\f[R] command.\n+JShell using the \\f[CB]\/help\\ \/set\\ truncation\\f[R] command.\n+.RS\n+.RE\n@@ -807,1 +966,1 @@\n-\\f[V]\/types\\f[R] [\\f[I]option\\f[R]]\n+.B \\f[CB]\/types\\f[R] [\\f[I]option\\f[R]]\n@@ -815,1 +974,1 @@\n-{\\f[I]name\\f[R]|\\f[I]id\\f[R]|\\f[I]startID\\f[R]\\f[V]-\\f[R]\\f[I]endID\\f[R]} [{\\f[I]name\\f[R]|\\f[I]id\\f[R]|\\f[I]startID\\f[R]\\f[V]-\\f[R]\\f[I]endID\\f[R]}...]\n+.B {\\f[I]name\\f[R]|\\f[I]id\\f[R]|\\f[I]startID\\f[R]\\f[CB]\\-\\f[R]\\f[I]endID\\f[R]} [{\\f[I]name\\f[R]|\\f[I]id\\f[R]|\\f[I]startID\\f[R]\\f[CB]\\-\\f[R]\\f[I]endID\\f[R]}...]\n@@ -821,1 +980,3 @@\n-Use the \\f[V]\/list\\f[R] command to see the IDs of the code snippets.\n+Use the \\f[CB]\/list\\f[R] command to see the IDs of the code snippets.\n+.RS\n+.RE\n@@ -823,1 +984,1 @@\n-\\f[V]-all\\f[R]\n+.B \\f[CB]\\-all\\f[R]\n@@ -827,0 +988,2 @@\n+.RS\n+.RE\n@@ -828,1 +991,1 @@\n-\\f[V]-start\\f[R]\n+.B \\f[CB]\\-start\\f[R]\n@@ -831,0 +994,2 @@\n+.RS\n+.RE\n@@ -833,1 +998,1 @@\n-\\f[V]\/vars\\f[R] [\\f[I]option\\f[R]]\n+.B \\f[CB]\/vars\\f[R] [\\f[I]option\\f[R]]\n@@ -841,1 +1006,1 @@\n-{\\f[I]name\\f[R]|\\f[I]id\\f[R]|\\f[I]startID\\f[R]\\f[V]-\\f[R]\\f[I]endID\\f[R]} [{\\f[I]name\\f[R]|\\f[I]id\\f[R]|\\f[I]startID\\f[R]\\f[V]-\\f[R]\\f[I]endID\\f[R]}...]\n+.B {\\f[I]name\\f[R]|\\f[I]id\\f[R]|\\f[I]startID\\f[R]\\f[CB]\\-\\f[R]\\f[I]endID\\f[R]} [{\\f[I]name\\f[R]|\\f[I]id\\f[R]|\\f[I]startID\\f[R]\\f[CB]\\-\\f[R]\\f[I]endID\\f[R]}...]\n@@ -846,1 +1011,3 @@\n-Use the \\f[V]\/list\\f[R] command to see the IDs of the code snippets.\n+Use the \\f[CB]\/list\\f[R] command to see the IDs of the code snippets.\n+.RS\n+.RE\n@@ -848,1 +1015,1 @@\n-\\f[V]-all\\f[R]\n+.B \\f[CB]\\-all\\f[R]\n@@ -852,0 +1019,2 @@\n+.RS\n+.RE\n@@ -853,1 +1022,1 @@\n-\\f[V]-start\\f[R]\n+.B \\f[CB]\\-start\\f[R]\n@@ -856,0 +1025,2 @@\n+.RS\n+.RE\n@@ -858,2 +1029,4 @@\n-\\f[V]\/?\\f[R]\n-Same as the \\f[V]\/help\\f[R] command.\n+.B \\f[CB]\/?\\f[R]\n+Same as the \\f[CB]\/help\\f[R] command.\n+.RS\n+.RE\n@@ -861,1 +1034,1 @@\n-\\f[V]\/!\\f[R]\n+.B \\f[CB]\/!\\f[R]\n@@ -863,0 +1036,2 @@\n+.RS\n+.RE\n@@ -864,1 +1039,1 @@\n-\\f[V]\/\\f[R]{\\f[I]name\\f[R]|\\f[I]id\\f[R]|\\f[I]startID\\f[R]\\f[V]-\\f[R]\\f[I]endID\\f[R]} [{\\f[I]name\\f[R]|\\f[I]id\\f[R]|\\f[I]startID\\f[R]\\f[V]-\\f[R]\\f[I]endID\\f[R]}...]\n+.B \\f[CB]\/\\f[R]{\\f[I]name\\f[R]|\\f[I]id\\f[R]|\\f[I]startID\\f[R]\\f[CB]\\-\\f[R]\\f[I]endID\\f[R]} [{\\f[I]name\\f[R]|\\f[I]id\\f[R]|\\f[I]startID\\f[R]\\f[CB]\\-\\f[R]\\f[I]endID\\f[R]}...]\n@@ -870,1 +1045,3 @@\n-Use the \\f[V]\/list\\f[R] command to see the IDs of the code snippets.\n+Use the \\f[CB]\/list\\f[R] command to see the IDs of the code snippets.\n+.RS\n+.RE\n@@ -872,3 +1049,3 @@\n-\\f[V]\/-\\f[R]\\f[I]n\\f[R]\n-Reruns the -\\f[I]n\\f[R]th previous snippet.\n-For example, if 15 code snippets were entered, then \\f[V]\/-4\\f[R] runs\n+.B \\f[CB]\/\\-\\f[R]\\f[I]n\\f[R]\n+Reruns the \\-\\f[I]n\\f[R]th previous snippet.\n+For example, if 15 code snippets were entered, then \\f[CB]\/\\-4\\f[R] runs\n@@ -877,0 +1054,2 @@\n+.RS\n+.RE\n@@ -883,1 +1062,1 @@\n-\\f[B]<tab>\\f[R]\n+.B \\f[B]<tab>\\f[R]\n@@ -900,1 +1079,1 @@\n-\\f[B]Shift+<Tab> V\\f[R]\n+.B \\f[B]Shift+<Tab> V\\f[R]\n@@ -904,0 +1083,2 @@\n+.RS\n+.RE\n@@ -905,1 +1086,1 @@\n-\\f[B]Shift+<Tab> M\\f[R]\n+.B \\f[B]Shift+<Tab> M\\f[R]\n@@ -910,0 +1091,2 @@\n+.RS\n+.RE\n@@ -911,1 +1094,1 @@\n-\\f[B]Shift+<Tab> I\\f[R]\n+.B \\f[B]Shift+<Tab> I\\f[R]\n@@ -915,0 +1098,2 @@\n+.RS\n+.RE\n@@ -919,6 +1104,5 @@\n-For example, \\f[V]\/l\\f[R] is recognized as the \\f[V]\/list\\f[R] command.\n-However, \\f[V]\/s\\f[R] isn\\[aq]t a valid abbreviation because it\n-can\\[aq]t be determined if the \\f[V]\/set\\f[R] or \\f[V]\/save\\f[R] command\n-is meant.\n-Use \\f[V]\/se\\f[R] for the \\f[V]\/set\\f[R] command or \\f[V]\/sa\\f[R] for\n-the \\f[V]\/save\\f[R] command.\n+For example, \\f[CB]\/l\\f[R] is recognized as the \\f[CB]\/list\\f[R] command.\n+However, \\f[CB]\/s\\f[R] isn\\[aq]t a valid abbreviation because it can\\[aq]t\n+be determined if the \\f[CB]\/set\\f[R] or \\f[CB]\/save\\f[R] command is meant.\n+Use \\f[CB]\/se\\f[R] for the \\f[CB]\/set\\f[R] command or \\f[CB]\/sa\\f[R] for the\n+\\f[CB]\/save\\f[R] command.\n@@ -928,1 +1112,1 @@\n-For example, use \\f[V]\/m -a\\f[R] to display all methods.\n+For example, use \\f[CB]\/m\\ \\-a\\f[R] to display all methods.\n@@ -1038,1 +1222,1 @@\n-To start a session, enter \\f[V]jshell\\f[R] on the command line.\n+To start a session, enter \\f[CB]jshell\\f[R] on the command line.\n@@ -1044,3 +1228,3 @@\n-% jshell\n-|  Welcome to JShell -- Version 9\n-|  For an introduction type: \/help intro\n+%\\ jshell\n+|\\ \\ Welcome\\ to\\ JShell\\ \\-\\-\\ Version\\ 9\n+|\\ \\ For\\ an\\ introduction\\ type:\\ \/help\\ intro\n@@ -1053,1 +1237,1 @@\n-the \\f[V]\/list -start\\f[R] command.\n+the \\f[CB]\/list\\ \\-start\\f[R] command.\n@@ -1060,1 +1244,1 @@\n-jshell> \/list -start\n+jshell>\\ \/list\\ \\-start\n@@ -1062,10 +1246,10 @@\n-  s1 : import java.io.*;\n-  s2 : import java.math.*;\n-  s3 : import java.net.*;\n-  s4 : import java.nio.file.*;\n-  s5 : import java.util.*;\n-  s6 : import java.util.concurrent.*;\n-  s7 : import java.util.function.*;\n-  s8 : import java.util.prefs.*;\n-  s9 : import java.util.regex.*;\n- s10 : import java.util.stream.*;\n+\\ \\ s1\\ :\\ import\\ java.io.*;\n+\\ \\ s2\\ :\\ import\\ java.math.*;\n+\\ \\ s3\\ :\\ import\\ java.net.*;\n+\\ \\ s4\\ :\\ import\\ java.nio.file.*;\n+\\ \\ s5\\ :\\ import\\ java.util.*;\n+\\ \\ s6\\ :\\ import\\ java.util.concurrent.*;\n+\\ \\ s7\\ :\\ import\\ java.util.function.*;\n+\\ \\ s8\\ :\\ import\\ java.util.prefs.*;\n+\\ \\ s9\\ :\\ import\\ java.util.regex.*;\n+\\ s10\\ :\\ import\\ java.util.stream.*;\n@@ -1077,1 +1261,1 @@\n-To end the session, use the \\f[V]\/exit\\f[R] command.\n+To end the session, use the \\f[CB]\/exit\\f[R] command.\n@@ -1081,2 +1265,2 @@\n-jshell> \/exit\n-|  Goodbye\n+jshell>\\ \/exit\n+|\\ \\ Goodbye\n@@ -1101,2 +1285,2 @@\n-jshell> int a=4\n-a ==> 4\n+jshell>\\ int\\ a=4\n+a\\ ==>\\ 4\n@@ -1104,2 +1288,2 @@\n-jshell> int b=8\n-b ==> 8\n+jshell>\\ int\\ b=8\n+b\\ ==>\\ 8\n@@ -1107,4 +1291,4 @@\n-jshell> int square(int i1) {\n-   ...> return i1 * i1;\n-   ...> }\n-|  created method square(int)\n+jshell>\\ int\\ square(int\\ i1)\\ {\n+\\ \\ \\ ...>\\ return\\ i1\\ *\\ i1;\n+\\ \\ \\ ...>\\ }\n+|\\ \\ created\\ method\\ square(int)\n@@ -1112,2 +1296,2 @@\n-jshell> square(b)\n-$5 ==> 64\n+jshell>\\ square(b)\n+$5\\ ==>\\ 64\n@@ -1125,7 +1309,7 @@\n-jshell> String grade(int testScore) {\n-   ...>     if (testScore >= 90) {\n-   ...>         return \\[dq]Pass\\[dq];\n-   ...>     }\n-   ...>     return \\[dq]Fail\\[dq];\n-   ...> }\n-|  created method grade(int)\n+jshell>\\ String\\ grade(int\\ testScore)\\ {\n+\\ \\ \\ ...>\\ \\ \\ \\ \\ if\\ (testScore\\ >=\\ 90)\\ {\n+\\ \\ \\ ...>\\ \\ \\ \\ \\ \\ \\ \\ \\ return\\ \"Pass\";\n+\\ \\ \\ ...>\\ \\ \\ \\ \\ }\n+\\ \\ \\ ...>\\ \\ \\ \\ \\ return\\ \"Fail\";\n+\\ \\ \\ ...>\\ }\n+|\\ \\ created\\ method\\ grade(int)\n@@ -1133,2 +1317,2 @@\n-jshell> grade(88)\n-$3 ==> \\[dq]Fail\\[dq]\n+jshell>\\ grade(88)\n+$3\\ ==>\\ \"Fail\"\n@@ -1138,1 +1322,1 @@\n-To change the method \\f[V]grade\\f[R] to allow more students to pass,\n+To change the method \\f[CB]grade\\f[R] to allow more students to pass,\n@@ -1140,1 +1324,1 @@\n-\\f[V]80\\f[R].\n+\\f[CB]80\\f[R].\n@@ -1142,1 +1326,1 @@\n-reenter them and make the change in the \\f[V]if\\f[R] statement.\n+reenter them and make the change in the \\f[CB]if\\f[R] statement.\n@@ -1148,7 +1332,7 @@\n-jshell> String grade(int testScore) {\n-   ...>     if (testScore >= 80) {\n-   ...>         return \\[dq]Pass\\[dq];\n-   ...>     }\n-   ...>     return \\[dq]Fail\\[dq];\n-   ...> }\n-|  modified method grade(int)\n+jshell>\\ String\\ grade(int\\ testScore)\\ {\n+\\ \\ \\ ...>\\ \\ \\ \\ \\ if\\ (testScore\\ >=\\ 80)\\ {\n+\\ \\ \\ ...>\\ \\ \\ \\ \\ \\ \\ \\ \\ return\\ \"Pass\";\n+\\ \\ \\ ...>\\ \\ \\ \\ \\ }\n+\\ \\ \\ ...>\\ \\ \\ \\ \\ return\\ \"Fail\";\n+\\ \\ \\ ...>\\ }\n+|\\ \\ modified\\ method\\ grade(int)\n@@ -1156,2 +1340,2 @@\n-jshell> grade(88)\n-$5 ==> \\[dq]Pass\\[dq]\n+jshell>\\ grade(88)\n+$5\\ ==>\\ \"Pass\"\n@@ -1162,1 +1346,1 @@\n-few changes, use the \\f[V]\/edit\\f[R] command to open the snippet in an\n+few changes, use the \\f[CB]\/edit\\f[R] command to open the snippet in an\n@@ -1168,2 +1352,2 @@\n-The \\f[V]\/list\\f[R] command is used to show that the pass score was\n-changed to \\f[V]85\\f[R].\n+The \\f[CB]\/list\\f[R] command is used to show that the pass score was\n+changed to \\f[CB]85\\f[R].\n@@ -1173,3 +1357,3 @@\n-jshell> \/edit grade\n-|  modified method grade(int)\n-jshell> \/list grade\n+jshell>\\ \/edit\\ grade\n+|\\ \\ modified\\ method\\ grade(int)\n+jshell>\\ \/list\\ grade\n@@ -1177,6 +1361,6 @@\n-   6 : String grade(int testScore) {\n-           if (testScore >= 85) {\n-               return \\[dq]Pass\\[dq];\n-           }\n-           return \\[dq]Fail\\[dq];\n-       }\n+\\ \\ \\ 6\\ :\\ String\\ grade(int\\ testScore)\\ {\n+\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ if\\ (testScore\\ >=\\ 85)\\ {\n+\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ return\\ \"Pass\";\n+\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ }\n+\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ return\\ \"Fail\";\n+\\ \\ \\ \\ \\ \\ \\ }\n@@ -1193,3 +1377,3 @@\n-Use the \\f[V]\/set mode\\f[R] command to create a new feedback mode.\n-In the following example, the new mode \\f[V]mymode\\f[R], is based on the\n-predefined feedback mode, \\f[V]normal\\f[R], and verifying command\n+Use the \\f[CB]\/set\\ mode\\f[R] command to create a new feedback mode.\n+In the following example, the new mode \\f[CB]mymode\\f[R], is based on the\n+predefined feedback mode, \\f[CB]normal\\f[R], and verifying command\n@@ -1200,2 +1384,2 @@\n-jshell> \/set mode mymode normal -command\n-|  Created new feedback mode: mymode\n+jshell>\\ \/set\\ mode\\ mymode\\ normal\\ \\-command\n+|\\ \\ Created\\ new\\ feedback\\ mode:\\ mymode\n@@ -1205,1 +1389,1 @@\n-Because the new mode is based on the \\f[V]normal\\f[R] mode, the prompts\n+Because the new mode is based on the \\f[CB]normal\\f[R] mode, the prompts\n@@ -1215,2 +1399,2 @@\n-jshell> \/set prompt mymode\n-|  \/set prompt mymode \\[dq]\\[rs]njshell> \\[dq] \\[dq]   ...> \\[dq]\n+jshell>\\ \/set\\ prompt\\ mymode\n+|\\ \\ \/set\\ prompt\\ mymode\\ \"\\\\njshell>\\ \"\\ \"\\ \\ \\ ...>\\ \"\n@@ -1218,1 +1402,1 @@\n-jshell> \/set prompt mymode \\[dq]\\[rs]nprompt$ \\[dq] \\[dq]   continue$ \\[dq]\n+jshell>\\ \/set\\ prompt\\ mymode\\ \"\\\\nprompt$\\ \"\\ \"\\ \\ \\ continue$\\ \"\n@@ -1230,1 +1414,1 @@\n-jshell> \/set truncation mymode 72\n+jshell>\\ \/set\\ truncation\\ mymode\\ 72\n@@ -1232,1 +1416,1 @@\n-jshell> \/set truncation mymode 500 varvalue\n+jshell>\\ \/set\\ truncation\\ mymode\\ 500\\ varvalue\n@@ -1239,1 +1423,1 @@\n-In the predefined mode \\f[V]normal\\f[R], the string \\f[V]created\\f[R] is\n+In the predefined mode \\f[CB]normal\\f[R], the string \\f[CB]created\\f[R] is\n@@ -1242,1 +1426,1 @@\n-\\f[V]defined\\f[R]:\n+\\f[CB]defined\\f[R]:\n@@ -1246,1 +1430,1 @@\n-jshell> \/set format mymode action \\[dq]defined\\[dq] added-primary\n+jshell>\\ \/set\\ format\\ mymode\\ action\\ \"defined\"\\ added\\-primary\n@@ -1250,1 +1434,1 @@\n-Use the \\f[V]\/set feedback\\f[R] command to start using the feedback mode\n+Use the \\f[CB]\/set\\ feedback\\f[R] command to start using the feedback mode\n@@ -1256,2 +1440,2 @@\n-jshell> \/set feedback mymode\n-|  Feedback mode: mymode\n+jshell>\\ \/set\\ feedback\\ mymode\n+|\\ \\ Feedback\\ mode:\\ mymode\n@@ -1259,4 +1443,4 @@\n-prompt$ int square (int num1){\n-   continue$ return num1*num1;\n-   continue$ }\n-|  defined method square(int)\n+prompt$\\ int\\ square\\ (int\\ num1){\n+\\ \\ \\ continue$\\ return\\ num1*num1;\n+\\ \\ \\ continue$\\ }\n+|\\ \\ defined\\ method\\ square(int)\n","filename":"src\/jdk.jshell\/share\/man\/jshell.1","additions":526,"deletions":342,"binary":false,"changes":868,"status":"modified"},{"patch":"@@ -22,1 +22,1 @@\n-.\\\" Automatically generated by Pandoc 2.19.2\n+.\\\" Automatically generated by Pandoc 2.3.1\n@@ -24,15 +24,1 @@\n-.\\\" Define V font for inline verbatim, using C font in formats\n-.\\\" that render this, and otherwise B font.\n-.ie \"\\f[CB]x\\f[R]\"x\" \\{\\\n-. ftr V B\n-. ftr VI BI\n-. ftr VB B\n-. ftr VBI BI\n-.\\}\n-.el \\{\\\n-. ftr V CR\n-. ftr VI CI\n-. ftr VB CB\n-. ftr VBI CBI\n-.\\}\n-.TH \"JSTATD\" \"1\" \"2023\" \"JDK 20-ea\" \"JDK Commands\"\n+.TH \"JSTATD\" \"1\" \"2023\" \"JDK 20\\-ea\" \"JDK Commands\"\n@@ -42,1 +28,1 @@\n-jstatd - monitor the creation and termination of instrumented Java\n+jstatd \\- monitor the creation and termination of instrumented Java\n@@ -48,1 +34,1 @@\n-\\f[V]jstatd\\f[R] [\\f[I]options\\f[R]]\n+\\f[CB]jstatd\\f[R] [\\f[I]options\\f[R]]\n@@ -50,2 +36,2 @@\n-\\f[I]options\\f[R]\n-This represents the \\f[V]jstatd\\f[R] command-line options.\n+.B \\f[I]options\\f[R]\n+This represents the \\f[CB]jstatd\\f[R] command\\-line options.\n@@ -53,0 +39,2 @@\n+.RS\n+.RE\n@@ -55,1 +43,1 @@\n-The \\f[V]jstatd\\f[R] command is an RMI server application that monitors\n+The \\f[CB]jstatd\\f[R] command is an RMI server application that monitors\n@@ -57,2 +45,2 @@\n-provides an interface to enable remote monitoring tools, \\f[V]jstat\\f[R]\n-and \\f[V]jps\\f[R], to attach to JVMs that are running on the local host\n+provides an interface to enable remote monitoring tools, \\f[CB]jstat\\f[R]\n+and \\f[CB]jps\\f[R], to attach to JVMs that are running on the local host\n@@ -61,4 +49,4 @@\n-The \\f[V]jstatd\\f[R] server requires an RMI registry on the local host.\n-The \\f[V]jstatd\\f[R] server attempts to attach to the RMI registry on\n-the default port, or on the port you specify with the \\f[V]-p\\f[R]\n-\\f[V]port\\f[R] option.\n+The \\f[CB]jstatd\\f[R] server requires an RMI registry on the local host.\n+The \\f[CB]jstatd\\f[R] server attempts to attach to the RMI registry on the\n+default port, or on the port you specify with the \\f[CB]\\-p\\f[R]\n+\\f[CB]port\\f[R] option.\n@@ -66,4 +54,3 @@\n-\\f[V]jstatd\\f[R] application that\\[aq]s bound to the port that\\[aq]s\n-indicated by the \\f[V]-p\\f[R] \\f[V]port\\f[R] option or to the default\n-RMI registry port when the \\f[V]-p\\f[R] \\f[V]port\\f[R] option is\n-omitted.\n+\\f[CB]jstatd\\f[R] application that\\[aq]s bound to the port that\\[aq]s\n+indicated by the \\f[CB]\\-p\\f[R] \\f[CB]port\\f[R] option or to the default RMI\n+registry port when the \\f[CB]\\-p\\f[R] \\f[CB]port\\f[R] option is omitted.\n@@ -71,1 +58,1 @@\n-\\f[V]-nr\\f[R] option.\n+\\f[CB]\\-nr\\f[R] option.\n@@ -74,1 +61,1 @@\n-\\f[V]-nr\\f[R]\n+.B \\f[CB]\\-nr\\f[R]\n@@ -76,1 +63,1 @@\n-the \\f[V]jstatd\\f[R] process when an existing RMI registry isn\\[aq]t\n+the \\f[CB]jstatd\\f[R] process when an existing RMI registry isn\\[aq]t\n@@ -78,0 +65,2 @@\n+.RS\n+.RE\n@@ -79,1 +68,1 @@\n-\\f[V]-p\\f[R] \\f[I]port\\f[R]\n+.B \\f[CB]\\-p\\f[R] \\f[I]port\\f[R]\n@@ -81,1 +70,1 @@\n-be found, or when not found, created if the \\f[V]-nr\\f[R] option\n+be found, or when not found, created if the \\f[CB]\\-nr\\f[R] option\n@@ -83,0 +72,2 @@\n+.RS\n+.RE\n@@ -84,1 +75,1 @@\n-\\f[V]-r\\f[R] \\f[I]rmiport\\f[R]\n+.B \\f[CB]\\-r\\f[R] \\f[I]rmiport\\f[R]\n@@ -87,0 +78,2 @@\n+.RS\n+.RE\n@@ -88,1 +81,1 @@\n-\\f[V]-n\\f[R] \\f[I]rminame\\f[R]\n+.B \\f[CB]\\-n\\f[R] \\f[I]rminame\\f[R]\n@@ -91,2 +84,2 @@\n-The default name is \\f[V]JStatRemoteHost\\f[R].\n-If multiple \\f[V]jstatd\\f[R] servers are started on the same host, then\n+The default name is \\f[CB]JStatRemoteHost\\f[R].\n+If multiple \\f[CB]jstatd\\f[R] servers are started on the same host, then\n@@ -96,1 +89,3 @@\n-the monitoring client\\[aq]s \\f[V]hostid\\f[R] and \\f[V]vmid\\f[R] strings.\n+the monitoring client\\[aq]s \\f[CB]hostid\\f[R] and \\f[CB]vmid\\f[R] strings.\n+.RS\n+.RE\n@@ -98,2 +93,2 @@\n-\\f[V]-J\\f[R]\\f[I]option\\f[R]\n-This option passes a Java \\f[V]option\\f[R] to the JVM, where the option\n+.B \\f[CB]\\-J\\f[R]\\f[I]option\\f[R]\n+This option passes a Java \\f[CB]option\\f[R] to the JVM, where the option\n@@ -102,1 +97,1 @@\n-For example, \\f[V]-J-Xms48m\\f[R] sets the startup memory to 48 MB.\n+For example, \\f[CB]\\-J\\-Xms48m\\f[R] sets the startup memory to 48 MB.\n@@ -104,0 +99,2 @@\n+.RS\n+.RE\n@@ -106,1 +103,1 @@\n-The \\f[V]jstatd\\f[R] server can monitor only JVMs for which it has the\n+The \\f[CB]jstatd\\f[R] server can monitor only JVMs for which it has the\n@@ -108,1 +105,1 @@\n-Therefore, the \\f[V]jstatd\\f[R] process must be running with the same\n+Therefore, the \\f[CB]jstatd\\f[R] process must be running with the same\n@@ -113,1 +110,1 @@\n-A \\f[V]jstatd\\f[R] process running with such credentials can monitor any\n+A \\f[CB]jstatd\\f[R] process running with such credentials can monitor any\n@@ -116,1 +113,1 @@\n-The \\f[V]jstatd\\f[R] server doesn\\[aq]t provide any authentication of\n+The \\f[CB]jstatd\\f[R] server doesn\\[aq]t provide any authentication of\n@@ -118,3 +115,3 @@\n-Therefore, running a \\f[V]jstatd\\f[R] server process exposes the\n-instrumentation export by all JVMs for which the \\f[V]jstatd\\f[R]\n-process has access permissions to any user on the network.\n+Therefore, running a \\f[CB]jstatd\\f[R] server process exposes the\n+instrumentation export by all JVMs for which the \\f[CB]jstatd\\f[R] process\n+has access permissions to any user on the network.\n@@ -123,1 +120,1 @@\n-\\f[V]jstatd\\f[R] process, particularly in production environments or on\n+\\f[CB]jstatd\\f[R] process, particularly in production environments or on\n@@ -126,1 +123,1 @@\n-For security purposes, the \\f[V]jstatd\\f[R] server uses an RMI\n+For security purposes, the \\f[CB]jstatd\\f[R] server uses an RMI\n@@ -130,4 +127,4 @@\n-is to not run the \\f[V]jstatd\\f[R] server and use the \\f[V]jstat\\f[R]\n-and \\f[V]jps\\f[R] tools locally.\n-However, when using \\f[V]jps\\f[R] to get a list of instrumented JVMs,\n-the list will not include any JVMs running in docker containers.\n+is to not run the \\f[CB]jstatd\\f[R] server and use the \\f[CB]jstat\\f[R] and\n+\\f[CB]jps\\f[R] tools locally.\n+However, when using \\f[CB]jps\\f[R] to get a list of instrumented JVMs, the\n+list will not include any JVMs running in docker containers.\n@@ -136,2 +133,2 @@\n-The interface exported by the \\f[V]jstatd\\f[R] process is proprietary\n-and guaranteed to change.\n+The interface exported by the \\f[CB]jstatd\\f[R] process is proprietary and\n+guaranteed to change.\n@@ -141,2 +138,2 @@\n-The following are examples of the \\f[V]jstatd\\f[R] command.\n-The \\f[V]jstatd\\f[R] scripts automatically start the server in the\n+The following are examples of the \\f[CB]jstatd\\f[R] command.\n+The \\f[CB]jstatd\\f[R] scripts automatically start the server in the\n@@ -146,1 +143,1 @@\n-This example shows how to start a \\f[V]jstatd\\f[R] session with an\n+This example shows how to start a \\f[CB]jstatd\\f[R] session with an\n@@ -149,1 +146,1 @@\n-registry port (port \\f[V]1099\\f[R]).\n+registry port (port \\f[CB]1099\\f[R]).\n@@ -152,1 +149,1 @@\n-\\f[V]jstatd\\f[R]\n+\\f[CB]jstatd\\f[R]\n@@ -156,1 +153,1 @@\n-This example starts a \\f[V]jstatd\\f[R] session with an external RMI\n+This example starts a \\f[CB]jstatd\\f[R] session with an external RMI\n@@ -166,2 +163,2 @@\n-This example starts a \\f[V]jstatd\\f[R] session with an external RMI\n-registry server on port \\f[V]2020\\f[R].\n+This example starts a \\f[CB]jstatd\\f[R] session with an external RMI\n+registry server on port \\f[CB]2020\\f[R].\n@@ -171,2 +168,2 @@\n-jrmiregistry 2020&\n-jstatd -p 2020\n+jrmiregistry\\ 2020&\n+jstatd\\ \\-p\\ 2020\n@@ -176,3 +173,3 @@\n-This example starts a \\f[V]jstatd\\f[R] session with an external RMI\n-registry server on port \\f[V]2020\\f[R] and JMX connector bound to port\n-\\f[V]2021\\f[R].\n+This example starts a \\f[CB]jstatd\\f[R] session with an external RMI\n+registry server on port \\f[CB]2020\\f[R] and JMX connector bound to port\n+\\f[CB]2021\\f[R].\n@@ -182,2 +179,2 @@\n-jrmiregistry 2020&\n-jstatd -p 2020 -r 2021\n+jrmiregistry\\ 2020&\n+jstatd\\ \\-p\\ 2020\\ \\-r\\ 2021\n@@ -187,1 +184,1 @@\n-This example starts a \\f[V]jstatd\\f[R] session with an external RMI\n+This example starts a \\f[CB]jstatd\\f[R] session with an external RMI\n@@ -189,1 +186,1 @@\n-\\f[V]AlternateJstatdServerName\\f[R].\n+\\f[CB]AlternateJstatdServerName\\f[R].\n@@ -193,2 +190,2 @@\n-rmiregistry 2020&\n-jstatd -p 2020 -n AlternateJstatdServerName\n+rmiregistry\\ 2020&\n+jstatd\\ \\-p\\ 2020\\ \\-n\\ AlternateJstatdServerName\n@@ -197,1 +194,1 @@\n-.SH STOP THE CREATION OF AN IN-PROCESS RMI REGISTRY\n+.SH STOP THE CREATION OF AN IN\\-PROCESS RMI REGISTRY\n@@ -199,2 +196,2 @@\n-This example starts a \\f[V]jstatd\\f[R] session that doesn\\[aq]t create\n-an RMI registry when one isn\\[aq]t found.\n+This example starts a \\f[CB]jstatd\\f[R] session that doesn\\[aq]t create an\n+RMI registry when one isn\\[aq]t found.\n@@ -206,1 +203,1 @@\n-\\f[V]jstatd -nr\\f[R]\n+\\f[CB]jstatd\\ \\-nr\\f[R]\n@@ -210,1 +207,1 @@\n-This example starts a \\f[V]jstatd\\f[R] session with RMI logging\n+This example starts a \\f[CB]jstatd\\f[R] session with RMI logging\n@@ -216,1 +213,1 @@\n-\\f[V]jstatd -J-Djava.rmi.server.logCalls=true\\f[R]\n+\\f[CB]jstatd\\ \\-J\\-Djava.rmi.server.logCalls=true\\f[R]\n","filename":"src\/jdk.jstatd\/share\/man\/jstatd.1","additions":81,"deletions":84,"binary":false,"changes":165,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2020, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2020, 2021, Oracle and\/or its affiliates. All rights reserved.\n@@ -432,1 +432,1 @@\n-            DiskChunk oldestChunk = chunks.peekLast();\n+            DiskChunk oldestChunk = chunks.getLast();\n@@ -443,1 +443,1 @@\n-        DiskChunk chunk = chunks.pollLast();\n+        DiskChunk chunk = chunks.poll();\n@@ -450,1 +450,1 @@\n-            DiskChunk oldestChunk = chunks.peekLast();\n+            DiskChunk oldestChunk = chunks.peek();\n@@ -463,1 +463,1 @@\n-        chunks.addFirst(chunk);\n+        chunks.push(chunk);\n@@ -503,4 +503,1 @@\n-        \/\/ replay history by iterating from oldest to most recent\n-        Iterator<DiskChunk> it = chunks.descendingIterator();\n-        while (it.hasNext()) {\n-            DiskChunk dc = it.next();\n+        for (DiskChunk dc : chunks) {\n@@ -509,1 +506,0 @@\n-\n","filename":"src\/jdk.management.jfr\/share\/classes\/jdk\/management\/jfr\/DiskRepository.java","additions":6,"deletions":10,"binary":false,"changes":16,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2021, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2021, Oracle and\/or its affiliates. All rights reserved.\n@@ -32,1 +32,1 @@\n-import java.util.Deque;\n+import java.util.Queue;\n@@ -37,1 +37,1 @@\n-    private final Deque<DiskChunk> chunks = new ArrayDeque<>();\n+    private final Queue<DiskChunk> chunks = new ArrayDeque<>();\n@@ -50,1 +50,1 @@\n-        chunks.addFirst(dc);\n+        chunks.add(dc);\n@@ -78,1 +78,1 @@\n-                    return chunks.pollLast();\n+                    return chunks.poll();\n@@ -89,1 +89,0 @@\n-        DiskChunk chunk = null;\n@@ -91,0 +90,1 @@\n+            DiskChunk chunk = null;\n@@ -95,2 +95,0 @@\n-                chunk.release();\n-                chunk = null;\n@@ -99,3 +97,0 @@\n-            if (chunk != null) {\n-                chunk.release();\n-            }\n","filename":"src\/jdk.management.jfr\/share\/classes\/jdk\/management\/jfr\/FileDump.java","additions":6,"deletions":11,"binary":false,"changes":17,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2020, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2020, 2021, Oracle and\/or its affiliates. All rights reserved.\n@@ -159,4 +159,1 @@\n-    \/\/ always guarded by lock\n-    private boolean started;\n-    private Duration maxAge;\n-    private long maxSize;\n+    private boolean started; \/\/ always guarded by lock\n@@ -421,5 +418,1 @@\n-        synchronized (lock) {\n-            repository.setMaxAge(maxAge);\n-            this.maxAge = maxAge;\n-            updateOnCompleteHandler();\n-        }\n+        repository.setMaxAge(maxAge);\n@@ -451,5 +444,1 @@\n-        synchronized (lock) {\n-            repository.setMaxSize(maxSize);\n-            this.maxSize = maxSize;\n-            updateOnCompleteHandler();\n-        }\n+        repository.setMaxSize(maxSize);\n@@ -659,9 +648,0 @@\n-    private void updateOnCompleteHandler() {\n-        if (maxAge != null || maxSize != 0) {\n-            \/\/ User has set a chunk removal policy\n-            ManagementSupport.setOnChunkCompleteHandler(stream, null);\n-        } else {\n-            ManagementSupport.setOnChunkCompleteHandler(stream, new ChunkConsumer(repository));\n-        }\n-    }\n-\n","filename":"src\/jdk.management.jfr\/share\/classes\/jdk\/management\/jfr\/RemoteRecordingStream.java","additions":4,"deletions":24,"binary":false,"changes":28,"status":"modified"},{"patch":"@@ -52,2 +52,2 @@\n-        private volatile long usageTicks;\n-        private volatile long totalTicks;\n+        private long usageTicks = 0;\n+        private long totalTicks = 0;\n","filename":"src\/jdk.management\/unix\/classes\/com\/sun\/management\/internal\/OperatingSystemImpl.java","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -1,279 +0,0 @@\n-\/*\n- * Copyright (c) 2017, 2022, Oracle and\/or its affiliates. All rights reserved.\n- * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n- *\n- * This code is free software; you can redistribute it and\/or modify it\n- * under the terms of the GNU General Public License version 2 only, as\n- * published by the Free Software Foundation.  Oracle designates this\n- * particular file as subject to the \"Classpath\" exception as provided\n- * by Oracle in the LICENSE file that accompanied this code.\n- *\n- * This code is distributed in the hope that it will be useful, but WITHOUT\n- * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n- * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n- * version 2 for more details (a copy is included in the LICENSE file that\n- * accompanied this code).\n- *\n- * You should have received a copy of the GNU General Public License version\n- * 2 along with this work; if not, write to the Free Software Foundation,\n- * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n- *\n- * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n- * or visit www.oracle.com if you need additional information or have any\n- * questions.\n- *\/\n-package com.sun.jndi.dns;\n-\n-import java.io.IOException;\n-import java.net.DatagramSocket;\n-import java.net.ProtocolFamily;\n-import java.net.InetSocketAddress;\n-import java.nio.channels.DatagramChannel;\n-import java.security.AccessController;\n-import java.security.PrivilegedExceptionAction;\n-import java.util.Objects;\n-import java.util.Random;\n-\n-class DNSDatagramChannelFactory {\n-    static final int DEVIATION = 3;\n-    static final int THRESHOLD = 6;\n-    static final int BIT_DEVIATION = 2;\n-    static final int HISTORY = 32;\n-    static final int MAX_RANDOM_TRIES = 5;\n-    \/**\n-     * The dynamic allocation port range (aka ephemeral ports), as configured\n-     * on the system. Use nested class for lazy evaluation.\n-     *\/\n-    static final class EphemeralPortRange {\n-        private EphemeralPortRange() {}\n-        static final int LOWER = sun.net.PortConfig.getLower();\n-        static final int UPPER = sun.net.PortConfig.getUpper();\n-        static final int RANGE = UPPER - LOWER + 1;\n-    }\n-\n-    private static int findFirstFreePort() {\n-        PrivilegedExceptionAction<DatagramSocket> action = () -> new DatagramSocket(0);\n-        int port;\n-        try {\n-            @SuppressWarnings({\"deprecated\", \"removal\"})\n-            DatagramSocket ds = AccessController.doPrivileged(action);\n-            try (DatagramSocket ds1 = ds) {\n-                port = ds1.getLocalPort();\n-            }\n-        } catch (Exception x) {\n-            port = 0;\n-        }\n-        return port;\n-    }\n-\n-    \/\/ Records a subset of max {@code capacity} previously used ports\n-    static final class PortHistory {\n-        final int capacity;\n-        final int[] ports;\n-        final Random random;\n-        int index;\n-        PortHistory(int capacity, Random random) {\n-            this.random = random;\n-            this.capacity = capacity;\n-            this.ports = new int[capacity];\n-        }\n-        \/\/ returns true if the history contains the specified port.\n-        public boolean contains(int port) {\n-            int p = 0;\n-            for (int i=0; i<capacity; i++) {\n-                if ((p = ports[i]) == 0 || p == port) break;\n-            }\n-            return p == port;\n-        }\n-        \/\/ Adds the port to the history - doesn't check whether the port\n-        \/\/ is already present. Always adds the port and always return true.\n-        public boolean add(int port) {\n-            if (ports[index] != 0) { \/\/ at max capacity\n-                \/\/ remove one port at random and store the new port there\n-                \/\/ don't remove the last port\n-                int remove = random.nextInt(capacity);\n-                if ((remove +1) % capacity == index) remove = index;\n-                ports[index = remove] = port;\n-            } else { \/\/ there's a free slot\n-                ports[index] = port;\n-            }\n-            if (++index == capacity) index = 0;\n-            return true;\n-        }\n-        \/\/ Adds the port to the history if not already present.\n-        \/\/ Return true if the port was added, false if the port was already\n-        \/\/ present.\n-        public boolean offer(int port) {\n-            if (contains(port)) return false;\n-            else return add(port);\n-        }\n-    }\n-\n-    int lastport = findFirstFreePort();\n-    int lastSystemAllocated = lastport;\n-    int suitablePortCount;\n-    int unsuitablePortCount;\n-    final ProtocolFamily family; \/\/ null (default) means dual stack\n-    final int thresholdCount; \/\/ decision point\n-    final int deviation;\n-    final Random random;\n-    final PortHistory history;\n-\n-    DNSDatagramChannelFactory() {\n-        this(new Random());\n-    }\n-\n-    DNSDatagramChannelFactory(Random random) {\n-        this(Objects.requireNonNull(random), null, DEVIATION, THRESHOLD);\n-    }\n-    DNSDatagramChannelFactory(Random random,\n-                              ProtocolFamily family,\n-                              int deviation,\n-                              int threshold) {\n-        this.random = Objects.requireNonNull(random);\n-        this.history = new PortHistory(HISTORY, random);\n-        this.family = family;\n-        this.deviation = Math.max(1, deviation);\n-        this.thresholdCount = Math.max(2, threshold);\n-    }\n-\n-    \/**\n-     * Opens a datagram socket listening to the wildcard address on a\n-     * random port. If the underlying OS supports UDP port randomization\n-     * out of the box (if binding a socket to port 0 binds it to a random\n-     * port) then the underlying OS implementation is used. Otherwise, this\n-     * method will allocate and bind a socket on a randomly selected ephemeral\n-     * port in the dynamic range.\n-     *\n-     * @return A new DatagramChannel bound to a random port.\n-     * @throws IOException if the socket cannot be created.\n-     *\/\n-    public synchronized DatagramChannel open() throws IOException {\n-        int lastseen = lastport;\n-        DatagramChannel s;\n-\n-        boolean thresholdCrossed = unsuitablePortCount > thresholdCount;\n-        if (thresholdCrossed) {\n-            \/\/ Underlying stack does not support random UDP port out of the box.\n-            \/\/ Use our own algorithm to allocate a random UDP port\n-            s = openRandom();\n-            if (s != null) return s;\n-\n-            \/\/ couldn't allocate a random port: reset all counters and fall\n-            \/\/ through.\n-            unsuitablePortCount = 0; suitablePortCount = 0; lastseen = 0;\n-        }\n-\n-        \/\/ Allocate an ephemeral port (port 0)\n-        s = openDefault();\n-        lastport = getLocalPort(s);\n-        if (lastseen == 0) {\n-            lastSystemAllocated = lastport;\n-            history.offer(lastport);\n-            return s;\n-        }\n-\n-        thresholdCrossed = suitablePortCount > thresholdCount;\n-        boolean farEnough = farEnough(lastseen);\n-        if (farEnough && lastSystemAllocated > 0) {\n-            farEnough = farEnough(lastSystemAllocated);\n-        }\n-        boolean recycled = history.contains(lastport);\n-        boolean suitable = (thresholdCrossed || farEnough && !recycled);\n-        if (suitable && !recycled) history.add(lastport);\n-\n-        if (suitable) {\n-            if (!thresholdCrossed) {\n-                suitablePortCount++;\n-            } else if (!farEnough || recycled) {\n-                unsuitablePortCount = 1;\n-                suitablePortCount = thresholdCount\/2;\n-            }\n-            \/\/ Either the underlying stack supports random UDP port allocation,\n-            \/\/ or the new port is sufficiently distant from last port to make\n-            \/\/ it look like it is. Let's use it.\n-            lastSystemAllocated = lastport;\n-            return s;\n-        }\n-\n-        \/\/ Undecided... the new port was too close. Let's allocate a random\n-        \/\/ port using our own algorithm\n-        assert !thresholdCrossed;\n-        DatagramChannel ss = openRandom();\n-        if (ss == null) return s;\n-        unsuitablePortCount++;\n-        s.close();\n-        return ss;\n-    }\n-\n-    private DatagramChannel openDefault() throws IOException {\n-        DatagramChannel c = family != null ? DatagramChannel.open(family)\n-                                           : DatagramChannel.open();\n-        try {\n-            c.bind(null);\n-            return c;\n-        } catch (Throwable x) {\n-            c.close();\n-            throw x;\n-        }\n-    }\n-\n-    synchronized boolean isUsingNativePortRandomization() {\n-        return unsuitablePortCount <= thresholdCount\n-                && suitablePortCount > thresholdCount;\n-    }\n-\n-    synchronized boolean isUsingJavaPortRandomization() {\n-        return unsuitablePortCount > thresholdCount ;\n-    }\n-\n-    synchronized boolean isUndecided() {\n-        return !isUsingJavaPortRandomization()\n-                && !isUsingNativePortRandomization();\n-    }\n-\n-    private boolean farEnough(int port) {\n-        return Integer.bitCount(port ^ lastport) > BIT_DEVIATION\n-                && Math.abs(port - lastport) > deviation;\n-    }\n-\n-    private DatagramChannel openRandom() throws IOException {\n-        int maxtries = MAX_RANDOM_TRIES;\n-        while (maxtries-- > 0) {\n-            int port;\n-            boolean suitable;\n-            boolean recycled;\n-            int maxrandom = MAX_RANDOM_TRIES;\n-            do {\n-                port = EphemeralPortRange.LOWER\n-                        + random.nextInt(EphemeralPortRange.RANGE);\n-                recycled = history.contains(port);\n-                suitable = lastport == 0 || (farEnough(port) && !recycled);\n-            } while (maxrandom-- > 0 && !suitable);\n-\n-            \/\/ if no suitable port was found, try again\n-            \/\/ this means we might call random MAX_RANDOM_TRIES x MAX_RANDOM_TRIES\n-            \/\/ times - but that should be OK with MAX_RANDOM_TRIES = 5.\n-            if (!suitable) continue;\n-\n-            DatagramChannel dc = (family != null)\n-                    ? DatagramChannel.open(family)\n-                    : DatagramChannel.open();\n-            try {\n-                dc.bind(new InetSocketAddress(port));\n-                lastport = getLocalPort(dc);\n-                if (!recycled) history.add(port);\n-                return dc;\n-            } catch (IOException x) {\n-                dc.close();\n-                \/\/ try again until maxtries == 0;\n-            }\n-        }\n-        return null;\n-    }\n-\n-    private static int getLocalPort(DatagramChannel dc) throws IOException {\n-        return ((InetSocketAddress) dc.getLocalAddress()).getPort();\n-    }\n-\n-}\n","filename":"src\/jdk.naming.dns\/share\/classes\/com\/sun\/jndi\/dns\/DNSDatagramChannelFactory.java","additions":0,"deletions":279,"binary":false,"changes":279,"status":"deleted"},{"patch":"@@ -0,0 +1,293 @@\n+\/*\n+ * Copyright (c) 2017, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+ *\n+ * This code is free software; you can redistribute it and\/or modify it\n+ * under the terms of the GNU General Public License version 2 only, as\n+ * published by the Free Software Foundation.  Oracle designates this\n+ * particular file as subject to the \"Classpath\" exception as provided\n+ * by Oracle in the LICENSE file that accompanied this code.\n+ *\n+ * This code is distributed in the hope that it will be useful, but WITHOUT\n+ * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+ * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+ * version 2 for more details (a copy is included in the LICENSE file that\n+ * accompanied this code).\n+ *\n+ * You should have received a copy of the GNU General Public License version\n+ * 2 along with this work; if not, write to the Free Software Foundation,\n+ * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n+ *\n+ * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n+ * or visit www.oracle.com if you need additional information or have any\n+ * questions.\n+ *\/\n+package com.sun.jndi.dns;\n+\n+import java.io.IOException;\n+import java.net.DatagramSocket;\n+import java.net.ProtocolFamily;\n+import java.net.SocketException;\n+import java.net.InetSocketAddress;\n+import java.nio.channels.DatagramChannel;\n+import java.security.AccessController;\n+import java.security.PrivilegedExceptionAction;\n+import java.util.Objects;\n+import java.util.Random;\n+\n+class DNSDatagramSocketFactory {\n+    static final int DEVIATION = 3;\n+    static final int THRESHOLD = 6;\n+    static final int BIT_DEVIATION = 2;\n+    static final int HISTORY = 32;\n+    static final int MAX_RANDOM_TRIES = 5;\n+    \/**\n+     * The dynamic allocation port range (aka ephemeral ports), as configured\n+     * on the system. Use nested class for lazy evaluation.\n+     *\/\n+    static final class EphemeralPortRange {\n+        private EphemeralPortRange() {}\n+        static final int LOWER = sun.net.PortConfig.getLower();\n+        static final int UPPER = sun.net.PortConfig.getUpper();\n+        static final int RANGE = UPPER - LOWER + 1;\n+    }\n+\n+    private static int findFirstFreePort() {\n+        PrivilegedExceptionAction<DatagramSocket> action = () -> new DatagramSocket(0);\n+        int port;\n+        try {\n+            @SuppressWarnings({\"deprecated\", \"removal\"})\n+            DatagramSocket ds = AccessController.doPrivileged(action);\n+            try (DatagramSocket ds1 = ds) {\n+                port = ds1.getLocalPort();\n+            }\n+        } catch (Exception x) {\n+            port = 0;\n+        }\n+        return port;\n+    }\n+\n+    \/\/ Records a subset of max {@code capacity} previously used ports\n+    static final class PortHistory {\n+        final int capacity;\n+        final int[] ports;\n+        final Random random;\n+        int index;\n+        PortHistory(int capacity, Random random) {\n+            this.random = random;\n+            this.capacity = capacity;\n+            this.ports = new int[capacity];\n+        }\n+        \/\/ returns true if the history contains the specified port.\n+        public boolean contains(int port) {\n+            int p = 0;\n+            for (int i=0; i<capacity; i++) {\n+                if ((p = ports[i]) == 0 || p == port) break;\n+            }\n+            return p == port;\n+        }\n+        \/\/ Adds the port to the history - doesn't check whether the port\n+        \/\/ is already present. Always adds the port and always return true.\n+        public boolean add(int port) {\n+            if (ports[index] != 0) { \/\/ at max capacity\n+                \/\/ remove one port at random and store the new port there\n+                \/\/ don't remove the last port\n+                int remove = random.nextInt(capacity);\n+                if ((remove +1) % capacity == index) remove = index;\n+                ports[index = remove] = port;\n+            } else { \/\/ there's a free slot\n+                ports[index] = port;\n+            }\n+            if (++index == capacity) index = 0;\n+            return true;\n+        }\n+        \/\/ Adds the port to the history if not already present.\n+        \/\/ Return true if the port was added, false if the port was already\n+        \/\/ present.\n+        public boolean offer(int port) {\n+            if (contains(port)) return false;\n+            else return add(port);\n+        }\n+    }\n+\n+    int lastport = findFirstFreePort();\n+    int lastSystemAllocated = lastport;\n+    int suitablePortCount;\n+    int unsuitablePortCount;\n+    final ProtocolFamily family; \/\/ null (default) means dual stack\n+    final int thresholdCount; \/\/ decision point\n+    final int deviation;\n+    final Random random;\n+    final PortHistory history;\n+\n+    DNSDatagramSocketFactory() {\n+        this(new Random());\n+    }\n+\n+    DNSDatagramSocketFactory(Random random) {\n+        this(Objects.requireNonNull(random), null, DEVIATION, THRESHOLD);\n+    }\n+    DNSDatagramSocketFactory(Random random,\n+                             ProtocolFamily family,\n+                             int deviation,\n+                             int threshold) {\n+        this.random = Objects.requireNonNull(random);\n+        this.history = new PortHistory(HISTORY, random);\n+        this.family = family;\n+        this.deviation = Math.max(1, deviation);\n+        this.thresholdCount = Math.max(2, threshold);\n+    }\n+\n+    \/**\n+     * Opens a datagram socket listening to the wildcard address on a\n+     * random port. If the underlying OS supports UDP port randomization\n+     * out of the box (if binding a socket to port 0 binds it to a random\n+     * port) then the underlying OS implementation is used. Otherwise, this\n+     * method will allocate and bind a socket on a randomly selected ephemeral\n+     * port in the dynamic range.\n+     * @return A new DatagramSocket bound to a random port.\n+     * @throws SocketException if the socket cannot be created.\n+     *\/\n+    public synchronized DatagramSocket open() throws SocketException {\n+        int lastseen = lastport;\n+        DatagramSocket s;\n+\n+        boolean thresholdCrossed = unsuitablePortCount > thresholdCount;\n+        if (thresholdCrossed) {\n+            \/\/ Underlying stack does not support random UDP port out of the box.\n+            \/\/ Use our own algorithm to allocate a random UDP port\n+            s = openRandom();\n+            if (s != null) return s;\n+\n+            \/\/ couldn't allocate a random port: reset all counters and fall\n+            \/\/ through.\n+            unsuitablePortCount = 0; suitablePortCount = 0; lastseen = 0;\n+        }\n+\n+        \/\/ Allocate an ephemeral port (port 0)\n+        s = openDefault();\n+        lastport = s.getLocalPort();\n+        if (lastseen == 0) {\n+            lastSystemAllocated = lastport;\n+            history.offer(lastport);\n+            return s;\n+        }\n+\n+        thresholdCrossed = suitablePortCount > thresholdCount;\n+        boolean farEnough = farEnough(lastseen);\n+        if (farEnough && lastSystemAllocated > 0) {\n+            farEnough = farEnough(lastSystemAllocated);\n+        }\n+        boolean recycled = history.contains(lastport);\n+        boolean suitable = (thresholdCrossed || farEnough && !recycled);\n+        if (suitable && !recycled) history.add(lastport);\n+\n+        if (suitable) {\n+            if (!thresholdCrossed) {\n+                suitablePortCount++;\n+            } else if (!farEnough || recycled) {\n+                unsuitablePortCount = 1;\n+                suitablePortCount = thresholdCount\/2;\n+            }\n+            \/\/ Either the underlying stack supports random UDP port allocation,\n+            \/\/ or the new port is sufficiently distant from last port to make\n+            \/\/ it look like it is. Let's use it.\n+            lastSystemAllocated = lastport;\n+            return s;\n+        }\n+\n+        \/\/ Undecided... the new port was too close. Let's allocate a random\n+        \/\/ port using our own algorithm\n+        assert !thresholdCrossed;\n+        DatagramSocket ss = openRandom();\n+        if (ss == null) return s;\n+        unsuitablePortCount++;\n+        s.close();\n+        return ss;\n+    }\n+\n+    private DatagramSocket openDefault() throws SocketException {\n+        if (family != null) {\n+            try {\n+                DatagramChannel c = DatagramChannel.open(family);\n+                try {\n+                    DatagramSocket s = c.socket();\n+                    s.bind(null);\n+                    return s;\n+                } catch (Throwable x) {\n+                    c.close();\n+                    throw x;\n+                }\n+            } catch (SocketException x) {\n+                throw x;\n+            } catch (IOException x) {\n+                throw new SocketException(x.getMessage(), x);\n+            }\n+        }\n+        return new DatagramSocket();\n+    }\n+\n+    synchronized boolean isUsingNativePortRandomization() {\n+        return  unsuitablePortCount <= thresholdCount\n+                && suitablePortCount > thresholdCount;\n+    }\n+\n+    synchronized boolean isUsingJavaPortRandomization() {\n+        return unsuitablePortCount > thresholdCount ;\n+    }\n+\n+    synchronized boolean isUndecided() {\n+        return !isUsingJavaPortRandomization()\n+                && !isUsingNativePortRandomization();\n+    }\n+\n+    private boolean farEnough(int port) {\n+        return Integer.bitCount(port ^ lastport) > BIT_DEVIATION\n+                && Math.abs(port - lastport) > deviation;\n+    }\n+\n+    private DatagramSocket openRandom() {\n+        int maxtries = MAX_RANDOM_TRIES;\n+        while (maxtries-- > 0) {\n+            int port;\n+            boolean suitable;\n+            boolean recycled;\n+            int maxrandom = MAX_RANDOM_TRIES;\n+            do {\n+                port = EphemeralPortRange.LOWER\n+                        + random.nextInt(EphemeralPortRange.RANGE);\n+                recycled = history.contains(port);\n+                suitable = lastport == 0 || (farEnough(port) && !recycled);\n+            } while (maxrandom-- > 0 && !suitable);\n+\n+            \/\/ if no suitable port was found, try again\n+            \/\/ this means we might call random MAX_RANDOM_TRIES x MAX_RANDOM_TRIES\n+            \/\/ times - but that should be OK with MAX_RANDOM_TRIES = 5.\n+            if (!suitable) continue;\n+\n+            try {\n+                if (family != null) {\n+                    DatagramChannel c = DatagramChannel.open(family);\n+                    try {\n+                        DatagramSocket s = c.socket();\n+                        s.bind(new InetSocketAddress(port));\n+                        lastport = s.getLocalPort();\n+                        if (!recycled) history.add(port);\n+                        return s;\n+                    } catch (Throwable x) {\n+                        c.close();\n+                        throw x;\n+                    }\n+                }\n+                DatagramSocket s = new DatagramSocket(port);\n+                lastport = s.getLocalPort();\n+                if (!recycled) history.add(port);\n+                return s;\n+            } catch (IOException x) {\n+                \/\/ try again until maxtries == 0;\n+            }\n+        }\n+        return null;\n+    }\n+\n+}\n","filename":"src\/jdk.naming.dns\/share\/classes\/com\/sun\/jndi\/dns\/DNSDatagramSocketFactory.java","additions":293,"deletions":0,"binary":false,"changes":293,"status":"added"},{"patch":"@@ -30,0 +30,2 @@\n+import java.net.DatagramSocket;\n+import java.net.DatagramPacket;\n@@ -35,5 +37,0 @@\n-import java.nio.ByteBuffer;\n-import java.nio.channels.ClosedSelectorException;\n-import java.nio.channels.DatagramChannel;\n-import java.nio.channels.SelectionKey;\n-import java.nio.channels.Selector;\n@@ -41,8 +38,2 @@\n-import javax.naming.CommunicationException;\n-import javax.naming.ConfigurationException;\n-import javax.naming.NameNotFoundException;\n-import javax.naming.NamingException;\n-import javax.naming.OperationNotSupportedException;\n-import javax.naming.ServiceUnavailableException;\n-\n-import java.util.Arrays;\n+import javax.naming.*;\n+\n@@ -52,1 +43,0 @@\n-import java.util.concurrent.locks.ReentrantLock;\n@@ -96,1 +86,0 @@\n-    private static final int MIN_TIMEOUT = 50; \/\/ msec after which there are no retries.\n@@ -103,6 +92,3 @@\n-    private final ReentrantLock udpChannelLock = new ReentrantLock();\n-\n-    private final Selector udpChannelSelector;\n-\n-    private static final DNSDatagramChannelFactory factory =\n-            new DNSDatagramChannelFactory(random);\n+    private final Object udpSocketLock = new Object();\n+    private static final DNSDatagramSocketFactory factory =\n+            new DNSDatagramSocketFactory(random);\n@@ -152,9 +138,0 @@\n-\n-        try {\n-            udpChannelSelector = Selector.open();\n-        } catch (IOException e) {\n-            NamingException ne = new ConfigurationException(\n-                    \"Channel selector configuration error\");\n-            ne.setRootCause(e);\n-            throw ne;\n-        }\n@@ -166,1 +143,1 @@\n-    DatagramChannel getDatagramChannel() throws NamingException {\n+    DatagramSocket getDatagramSocket() throws NamingException {\n@@ -169,1 +146,1 @@\n-        } catch (IOException e) {\n+        } catch (java.net.SocketException e) {\n@@ -185,4 +162,0 @@\n-        try {\n-            udpChannelSelector.close();\n-        } catch (IOException ioException) {\n-        }\n@@ -242,3 +215,17 @@\n-                        byte[] msg = doUdpQuery(pkt, servers[i], serverPorts[i],\n-                                                retry, xid);\n-                        assert msg != null;\n+                        byte[] msg = null;\n+                        msg = doUdpQuery(pkt, servers[i], serverPorts[i],\n+                                            retry, xid);\n+                        \/\/\n+                        \/\/ If the matching response is not got within the\n+                        \/\/ given timeout, check if the response was enqueued\n+                        \/\/ by some other thread, if not proceed with the next\n+                        \/\/ server or retry.\n+                        \/\/\n+                        if (msg == null) {\n+                            if (resps.size() > 0) {\n+                                msg = lookupResponse(xid);\n+                            }\n+                            if (msg == null) { \/\/ try next server or retry\n+                                continue;\n+                            }\n+                        }\n@@ -310,7 +297,0 @@\n-                    } catch (ClosedSelectorException e) {\n-                        \/\/ ClosedSelectorException is thrown by blockingReceive if\n-                        \/\/ the datagram channel selector associated with DNS client\n-                        \/\/ is unexpectedly closed\n-                        var ce = new CommunicationException(\"DNS client closed\");\n-                        ce.setRootCause(e);\n-                        throw ce;\n@@ -425,6 +405,7 @@\n-        udpChannelLock.lock();\n-        try {\n-            try (DatagramChannel udpChannel = getDatagramChannel()) {\n-                ByteBuffer opkt = ByteBuffer.wrap(pkt.getData(), 0, pkt.length());\n-                byte[] data = new byte[8000];\n-                ByteBuffer ipkt = ByteBuffer.wrap(data);\n+        int minTimeout = 50; \/\/ msec after which there are no retries.\n+\n+        synchronized (udpSocketLock) {\n+            try (DatagramSocket udpSocket = getDatagramSocket()) {\n+                DatagramPacket opkt = new DatagramPacket(\n+                        pkt.getData(), pkt.length(), server, port);\n+                DatagramPacket ipkt = new DatagramPacket(new byte[8000], 8000);\n@@ -432,2 +413,1 @@\n-                InetSocketAddress target = new InetSocketAddress(server, port);\n-                udpChannel.connect(target);\n+                udpSocket.connect(server, port);\n@@ -435,1 +415,1 @@\n-                udpChannel.write(opkt);\n+                udpSocket.send(opkt);\n@@ -437,1 +417,1 @@\n-                \/\/ timeout remaining after successive 'blockingReceive()'\n+                \/\/ timeout remaining after successive 'receive()'\n@@ -440,1 +420,0 @@\n-                boolean gotData = false;\n@@ -442,5 +421,0 @@\n-                    \/\/ prepare for retry\n-                    if (gotData) {\n-                        Arrays.fill(data, 0, ipkt.position(), (byte) 0);\n-                        ipkt.clear();\n-                    }\n@@ -454,0 +428,1 @@\n+                    udpSocket.setSoTimeout(timeoutLeft);\n@@ -455,1 +430,1 @@\n-                    gotData = blockingReceive(udpChannel, ipkt, timeoutLeft);\n+                    udpSocket.receive(ipkt);\n@@ -457,2 +432,3 @@\n-                    assert gotData || ipkt.position() == 0;\n-                    if (gotData && isMatchResponse(data, xid)) {\n+\n+                    byte[] data = ipkt.getData();\n+                    if (isMatchResponse(data, xid)) {\n@@ -460,8 +436,0 @@\n-                    } else if (resps.size() > 0) {\n-                        \/\/ If the matching response is not found, check if\n-                        \/\/ the response was enqueued by some other thread,\n-                        \/\/ if not continue\n-                        byte[] cachedMsg = lookupResponse(xid);\n-                        if (cachedMsg != null) { \/\/ found in cache\n-                            return cachedMsg;\n-                        }\n@@ -470,21 +438,2 @@\n-                } while (timeoutLeft > MIN_TIMEOUT);\n-                \/\/ no matching packets received within the timeout\n-                throw new SocketTimeoutException();\n-            }\n-        } finally {\n-            udpChannelLock.unlock();\n-        }\n-    }\n-\n-    boolean blockingReceive(DatagramChannel dc, ByteBuffer buffer, long timeout) throws IOException {\n-        boolean dataReceived = false;\n-        \/\/ The provided datagram channel will be used by the caller only to receive data after\n-        \/\/ it is put to non-blocking mode\n-        dc.configureBlocking(false);\n-        var selectionKey = dc.register(udpChannelSelector, SelectionKey.OP_READ);\n-        try {\n-            udpChannelSelector.select(timeout);\n-            var keys = udpChannelSelector.selectedKeys();\n-            if (keys.contains(selectionKey) && selectionKey.isReadable()) {\n-                dc.receive(buffer);\n-                dataReceived = true;\n+                } while (timeoutLeft > minTimeout);\n+                return null; \/\/ no matching packet received within the timeout\n@@ -492,5 +441,0 @@\n-            keys.clear();\n-        } finally {\n-            selectionKey.cancel();\n-            \/\/ Flush the canceled key out of the selected key set\n-            udpChannelSelector.selectNow();\n@@ -498,1 +442,0 @@\n-        return dataReceived;\n@@ -689,1 +632,1 @@\n-                resps.put(hdr.xid, pkt.clone());\n+                resps.put(hdr.xid, pkt);\n","filename":"src\/jdk.naming.dns\/share\/classes\/com\/sun\/jndi\/dns\/DnsClient.java","additions":44,"deletions":101,"binary":false,"changes":145,"status":"modified"},{"patch":"@@ -45,2 +45,1 @@\n-            p.addSelectedNodes(c.getNodes(), true);\n-            p.centerSelectedNodes();\n+            p.addSelectedNodes(c.getNodes());\n","filename":"src\/utils\/IdealGraphVisualizer\/Bytecodes\/src\/main\/java\/com\/sun\/hotspot\/igv\/bytecodes\/SelectBytecodesAction.java","additions":1,"deletions":2,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -102,3 +102,0 @@\n-        edgeLayer.removeChildren();\n-        mainLayer.removeChildren();\n-\n@@ -124,1 +121,1 @@\n-    private void clearSelection() {\n+    public void clearSelection() {\n@@ -132,1 +129,1 @@\n-    private void selectionChanged() {\n+    public void selectionChanged() {\n@@ -140,2 +137,1 @@\n-            p.addSelectedNodes(inputNodes, true);\n-            p.centerSelectedNodes();\n+            p.addSelectedNodes(inputNodes);\n@@ -145,1 +141,1 @@\n-    private void addToSelection(BlockWidget widget) {\n+    public void addToSelection(BlockWidget widget) {\n@@ -151,1 +147,1 @@\n-    private void removeFromSelection(BlockWidget widget) {\n+    public void removeFromSelection(BlockWidget widget) {\n","filename":"src\/utils\/IdealGraphVisualizer\/ControlFlow\/src\/main\/java\/com\/sun\/hotspot\/igv\/controlflow\/ControlFlowScene.java","additions":5,"deletions":9,"binary":false,"changes":14,"status":"modified"},{"patch":"@@ -32,1 +32,0 @@\n-import javax.swing.SwingUtilities;\n@@ -106,7 +105,5 @@\n-        SwingUtilities.invokeLater(() -> {\n-            if (lastProvider != null) {\n-                InputGraph graph = lastProvider.getGraph();\n-                if (graph != null) {\n-                    scene.setGraph(graph);\n-                    return;\n-                }\n+        if (lastProvider != null) {\n+            InputGraph graph = lastProvider.getGraph();\n+            if (graph != null) {\n+                scene.setGraph(graph);\n+                return;\n@@ -114,2 +111,2 @@\n-            scene.setGraph(new InputGraph(\"\"));\n-        });\n+        }\n+        scene.setGraph(new InputGraph(\"\"));\n","filename":"src\/utils\/IdealGraphVisualizer\/ControlFlow\/src\/main\/java\/com\/sun\/hotspot\/igv\/controlflow\/ControlFlowTopComponent.java","additions":7,"deletions":10,"binary":false,"changes":17,"status":"modified"},{"patch":"@@ -181,4 +181,0 @@\n-            <file name=\"SeparatorOptions.instance\">\n-                <attr name=\"instanceClass\" stringvalue=\"javax.swing.JSeparator\"\/>\n-                <attr name=\"position\" intvalue=\"50\"\/>\n-            <\/file>\n","filename":"src\/utils\/IdealGraphVisualizer\/Coordinator\/src\/main\/resources\/com\/sun\/hotspot\/igv\/coordinator\/layer.xml","additions":0,"deletions":4,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -258,6 +258,1 @@\n-        Group group = getGroup();\n-        if (group != null) {\n-            return group.getGraphs().indexOf(this);\n-        } else {\n-            return -1;\n-        }\n+        return getGroup().getGraphs().indexOf(this);\n","filename":"src\/utils\/IdealGraphVisualizer\/Data\/src\/main\/java\/com\/sun\/hotspot\/igv\/data\/InputGraph.java","additions":1,"deletions":6,"binary":false,"changes":7,"status":"modified"},{"patch":"@@ -39,3 +39,1 @@\n-    void centerSelectedNodes();\n-\n-    void addSelectedNodes(Collection<InputNode> nodes, boolean showIfHidden);\n+    void addSelectedNodes(Collection<InputNode> nodes);\n@@ -45,0 +43,1 @@\n+\n","filename":"src\/utils\/IdealGraphVisualizer\/Data\/src\/main\/java\/com\/sun\/hotspot\/igv\/data\/services\/InputGraphProvider.java","additions":2,"deletions":3,"binary":false,"changes":5,"status":"modified"},{"patch":"@@ -26,1 +26,0 @@\n-import com.sun.hotspot.igv.data.Properties;\n@@ -28,0 +27,1 @@\n+import com.sun.hotspot.igv.data.Properties;\n@@ -271,10 +271,0 @@\n-\n-    public Figure getRootFigure() {\n-        Properties.PropertySelector<Figure> selector = new Properties.PropertySelector<>(figures);\n-        Figure root = selector.selectSingle(new Properties.StringPropertyMatcher(\"name\", \"Root\"));\n-        if (root == null) {\n-            root = selector.selectSingle(new Properties.StringPropertyMatcher(\"name\", \"Start\"));\n-        }\n-        return root;\n-    }\n-\n","filename":"src\/utils\/IdealGraphVisualizer\/Graph\/src\/main\/java\/com\/sun\/hotspot\/igv\/graph\/Diagram.java","additions":1,"deletions":11,"binary":false,"changes":12,"status":"modified"},{"patch":"@@ -48,5 +48,5 @@\n-    public RangeSliderModel() {\n-        changedEvent = new ChangedEvent<>(this);\n-        colorChangedEvent = new ChangedEvent<>(this);\n-        positions = new ArrayList<>();\n-        colors = new ArrayList<>();\n+    public RangeSliderModel(List<String> positions) {\n+        assert positions.size() > 0;\n+        this.changedEvent = new ChangedEvent<>(this);\n+        this.colorChangedEvent = new ChangedEvent<>(this);\n+        setPositions(positions);\n@@ -91,6 +91,4 @@\n-        if (firstPosition != fp || secondPosition != sp) {\n-            firstPosition = fp;\n-            secondPosition = sp;\n-            ensureOrder();\n-            changedEvent.fire();\n-        }\n+        firstPosition = fp;\n+        secondPosition = sp;\n+        ensureOrder();\n+        changedEvent.fire();\n","filename":"src\/utils\/IdealGraphVisualizer\/Util\/src\/main\/java\/com\/sun\/hotspot\/igv\/util\/RangeSliderModel.java","additions":9,"deletions":11,"binary":false,"changes":20,"status":"modified"},{"patch":"@@ -97,1 +97,0 @@\n-                            editor.centerSelectedNodes();\n","filename":"src\/utils\/IdealGraphVisualizer\/View\/src\/main\/java\/com\/sun\/hotspot\/igv\/view\/BlockQuickSearch.java","additions":0,"deletions":1,"binary":false,"changes":1,"status":"modified"},{"patch":"@@ -35,4 +35,1 @@\n-import com.sun.hotspot.igv.util.ColorIcon;\n-import com.sun.hotspot.igv.util.DoubleClickAction;\n-import com.sun.hotspot.igv.util.DoubleClickHandler;\n-import com.sun.hotspot.igv.util.PropertiesSheet;\n+import com.sun.hotspot.igv.util.*;\n@@ -44,1 +41,3 @@\n-import java.awt.event.*;\n+import java.awt.event.ActionEvent;\n+import java.awt.event.MouseEvent;\n+import java.awt.event.MouseWheelListener;\n@@ -55,2 +54,1 @@\n-import org.netbeans.api.visual.animator.AnimatorEvent;\n-import org.netbeans.api.visual.animator.AnimatorListener;\n+import org.netbeans.api.visual.animator.SceneAnimator;\n@@ -82,0 +80,1 @@\n+    private final LayerWidget connectionLayer;\n@@ -86,1 +85,0 @@\n-    private final LayerWidget connectionLayer;\n@@ -164,1 +162,1 @@\n-        validateAll();\n+        validate();\n@@ -174,0 +172,1 @@\n+        \/\/ Fix for jumping during zooming\n@@ -175,1 +174,2 @@\n-        validateAll();\n+        getView().scrollRectToVisible(visibleRect);\n+\n@@ -186,15 +186,15 @@\n-    private final ControllableChangedListener<SelectionCoordinator> highlightedCoordinatorListener = new ControllableChangedListener<SelectionCoordinator>() {\n-\n-        @Override\n-        public void filteredChanged(SelectionCoordinator coordinator) {\n-            if (model.getGlobalSelection()) {\n-                Set<Integer> ids = coordinator.getHighlightedObjects();\n-                Set<Object> highlightedObjects = new HashSet<>();\n-                for (Figure figure : getModel().getDiagram().getFigures()) {\n-                    if (ids.contains(figure.getInputNode().getId())) {\n-                        highlightedObjects.add(figure);\n-                    }\n-                    for (Slot slot : figure.getSlots()) {\n-                        if (!Collections.disjoint(slot.getSource().getSourceNodesAsSet(), ids)) {\n-                            highlightedObjects.add(slot);\n-                        }\n+    @Override\n+    public void centerFigures(Collection<Figure> figures) {\n+        getModel().showFigures(figures);\n+        Rectangle overallRect = null;\n+        for (Figure figure : figures) {\n+            FigureWidget figureWidget = getWidget(figure);\n+            if (figureWidget != null) {\n+                Rectangle bounds = figureWidget.getBounds();\n+                if (bounds != null) {\n+                    Point location = figureWidget.getLocation();\n+                    Rectangle figureRect = new Rectangle(location.x, location.y, bounds.width, bounds.height);\n+                    if (overallRect == null) {\n+                        overallRect = figureRect;\n+                    } else {\n+                        overallRect = overallRect.union(figureRect);\n@@ -203,2 +203,0 @@\n-                setHighlightedObjects(highlightedObjects);\n-                validateAll();\n@@ -207,0 +205,12 @@\n+        if (overallRect != null) {\n+            centerRectangle(overallRect);\n+        }\n+    }\n+\n+    private final ControllableChangedListener<SelectionCoordinator> highlightedCoordinatorListener = new ControllableChangedListener<SelectionCoordinator>() {\n+\n+        @Override\n+        public void filteredChanged(SelectionCoordinator source) {\n+            setHighlightedObjects(idSetToObjectSet(source.getHighlightedObjects()));\n+            validate();\n+        }\n@@ -211,8 +221,6 @@\n-        public void filteredChanged(SelectionCoordinator coordinator) {\n-            if (model.getGlobalSelection()) {\n-                Set<Integer> ids = coordinator.getSelectedObjects();\n-                Set<Figure> selectedFigures = new HashSet<>();\n-                for (Figure figure : getModel().getDiagram().getFigures()) {\n-                    if (ids.contains(figure.getInputNode().getId())) {\n-                        selectedFigures.add(figure);\n-                    }\n+        public void filteredChanged(SelectionCoordinator source) {\n+            Set<Integer> ids = source.getSelectedObjects();\n+            Set<Figure> figures = new HashSet<>();\n+            for (Figure f : getModel().getDiagram().getFigures()) {\n+                if (ids.contains(f.getInputNode().getId())) {\n+                    figures.add(f);\n@@ -220,3 +228,0 @@\n-                setFigureSelection(selectedFigures);\n-                centerSelectedFigures();\n-                validateAll();\n@@ -224,0 +229,3 @@\n+            centerFigures(figures);\n+            setSelectedObjects(idSetToObjectSet(ids));\n+            validate();\n@@ -231,2 +239,2 @@\n-    private void setScrollPosition(Point position) {\n-        scrollPane.getViewport().setViewPosition(position);\n+    private void setScrollPosition(Point p) {\n+        scrollPane.getViewport().setViewPosition(p);\n@@ -336,1 +344,1 @@\n-            Widget widget = new Widget(this);\n+            Widget widget = new Widget(DiagramScene.this);\n@@ -338,0 +346,1 @@\n+            widget.setForeground(Color.red);\n@@ -437,0 +446,1 @@\n+\n@@ -473,17 +483,5 @@\n-        modelState = new ModelState(model);\n-\n-        model.getDiagramChangedEvent().addListener(m -> update());\n-        model.getGraphChangedEvent().addListener(m -> graphChanged());\n-        model.getHiddenNodesChangedEvent().addListener(m -> hiddenNodesChanged());\n-        scrollPane.addHierarchyBoundsListener(new HierarchyBoundsListener() {\n-            @Override\n-            public void ancestorMoved(HierarchyEvent e) {}\n-\n-            @Override\n-            public void ancestorResized(HierarchyEvent e) {\n-                if (scrollPane.getBounds().width > 0) {\n-                    centerRootNode();\n-                    scrollPane.removeHierarchyBoundsListener(this);\n-                }\n-            }\n-        });\n+        this.modelState = new ModelState(model);\n+        this.model.getDiagramChangedEvent().addListener(m -> update());\n+        this.model.getGraphChangedEvent().addListener(m -> addUndo());\n+        this.model.getSelectedNodesChangedEvent().addListener(m -> selectedNodesChanged());\n+        this.model.getHiddenNodesChangedEvent().addListener(m -> hiddenNodesChanged());\n@@ -493,1 +491,0 @@\n-    @Override\n@@ -504,1 +501,1 @@\n-        return model.getHiddenNodes().isEmpty();\n+        return getModel().getHiddenNodes().isEmpty();\n@@ -525,2 +522,1 @@\n-                model.showFigures(model.getSelectedFigures());\n-                centerSelectedFigures();\n+                centerFigures(Collections.singleton(figure));\n@@ -546,1 +542,6 @@\n-    private void clearObjects() {\n+    private void update() {\n+        mainLayer.removeChildren();\n+        blockLayer.removeChildren();\n+\n+        rebuilding = true;\n+\n@@ -551,1 +552,0 @@\n-    }\n@@ -553,2 +553,7 @@\n-    private void updateFigureTexts() {\n-        for (Figure figure : getModel().getDiagram().getFigures()) {\n+        Diagram d = getModel().getDiagram();\n+\n+        Map<InputBlock, Integer> maxWidth = new HashMap<>();\n+        for (InputBlock b : d.getInputBlocks()) {\n+            maxWidth.put(b, 10);\n+        }\n+        for (Figure f : d.getFigures()) {\n@@ -556,1 +561,5 @@\n-            figure.updateLines();\n+            f.updateLines();\n+            \/\/ Compute max node width in each block.\n+            if (f.getWidth() > maxWidth.get(f.getBlock().getInputBlock())) {\n+                maxWidth.put(f.getBlock().getInputBlock(), f.getWidth());\n+            }\n@@ -558,1 +567,0 @@\n-    }\n@@ -560,15 +568,4 @@\n-    private void updateFigureWidths() {\n-        if (getModel().getShowCFG()) {\n-            Map<InputBlock, Integer> maxWidth = new HashMap<>();\n-            for (InputBlock inputBlock : getModel().getDiagram().getInputBlocks()) {\n-                maxWidth.put(inputBlock, 10);\n-            }\n-            for (Figure figure : getModel().getDiagram().getFigures()) {\n-                \/\/ Compute max node width in each block.\n-                if (figure.getWidth() > maxWidth.get(figure.getBlock().getInputBlock())) {\n-                    maxWidth.put(figure.getBlock().getInputBlock(), figure.getWidth());\n-                }\n-            }\n-            for (Figure figure : getModel().getDiagram().getFigures()) {\n-                \/\/ Set all nodes' width to the maximum width in the blocks?\n-                figure.setWidth(maxWidth.get(figure.getBlock().getInputBlock()));\n+        for (Figure f : d.getFigures()) {\n+            \/\/ Set all nodes' width to the maximum width in the blocks?\n+            if (getModel().getShowCFG()) {\n+                f.setWidth(maxWidth.get(f.getBlock().getInputBlock()));\n@@ -576,2 +573,0 @@\n-        }\n-    }\n@@ -579,17 +574,14 @@\n-    private void rebuildMainLayer() {\n-        mainLayer.removeChildren();\n-        for (Figure figure : getModel().getDiagram().getFigures()) {\n-            FigureWidget figureWidget = new FigureWidget(figure, this);\n-            figureWidget.setVisible(false);\n-            figureWidget.getActions().addAction(ActionFactory.createPopupMenuAction(figureWidget));\n-            figureWidget.getActions().addAction(selectAction);\n-            figureWidget.getActions().addAction(hoverAction);\n-            addObject(figure, figureWidget);\n-            mainLayer.addChild(figureWidget);\n-\n-            for (InputSlot inputSlot : figure.getInputSlots()) {\n-                SlotWidget slotWidget = new InputSlotWidget(inputSlot, this, figureWidget, figureWidget);\n-                slotWidget.getActions().addAction(new DoubleClickAction(slotWidget));\n-                slotWidget.getActions().addAction(hoverAction);\n-                slotWidget.getActions().addAction(selectAction);\n-                addObject(inputSlot, slotWidget);\n+            FigureWidget w = new FigureWidget(f, this, mainLayer);\n+            w.getActions().addAction(ActionFactory.createPopupMenuAction(w));\n+            w.getActions().addAction(selectAction);\n+            w.getActions().addAction(hoverAction);\n+            w.setVisible(false);\n+\n+            addObject(f, w);\n+\n+            for (InputSlot s : f.getInputSlots()) {\n+                SlotWidget sw = new InputSlotWidget(s, this, w, w);\n+                addObject(s, sw);\n+                sw.getActions().addAction(new DoubleClickAction(sw));\n+                sw.getActions().addAction(hoverAction);\n+                sw.getActions().addAction(selectAction);\n@@ -598,6 +590,6 @@\n-            for (OutputSlot outputSlot : figure.getOutputSlots()) {\n-                SlotWidget slotWidget = new OutputSlotWidget(outputSlot, this, figureWidget, figureWidget);\n-                slotWidget.getActions().addAction(new DoubleClickAction(slotWidget));\n-                slotWidget.getActions().addAction(hoverAction);\n-                slotWidget.getActions().addAction(selectAction);\n-                addObject(outputSlot, slotWidget);\n+            for (OutputSlot s : f.getOutputSlots()) {\n+                SlotWidget sw = new OutputSlotWidget(s, this, w, w);\n+                addObject(s, sw);\n+                sw.getActions().addAction(new DoubleClickAction(sw));\n+                sw.getActions().addAction(hoverAction);\n+                sw.getActions().addAction(selectAction);\n@@ -606,1 +598,0 @@\n-    }\n@@ -608,2 +599,0 @@\n-    private void rebuildBlockLayer() {\n-        blockLayer.removeChildren();\n@@ -611,6 +600,6 @@\n-            for (InputBlock inputBlock : getModel().getDiagram().getInputBlocks()) {\n-                BlockWidget blockWidget = new BlockWidget(this, inputBlock);\n-                blockWidget.getActions().addAction(new DoubleClickAction(blockWidget));\n-                blockWidget.setVisible(false);\n-                addObject(inputBlock, blockWidget);\n-                blockLayer.addChild(blockWidget);\n+            for (InputBlock bn : d.getInputBlocks()) {\n+                BlockWidget w = new BlockWidget(this, bn);\n+                w.getActions().addAction(new DoubleClickAction(w));\n+                w.setVisible(false);\n+                addObject(bn, w);\n+                blockLayer.addChild(w);\n@@ -619,1 +608,0 @@\n-    }\n@@ -621,11 +609,0 @@\n-    private void update() {\n-        rebuilding = true;\n-        clearObjects();\n-        updateFigureTexts();\n-        updateFigureWidths();\n-        rebuildMainLayer();\n-        rebuildBlockLayer();\n-        relayout();\n-        setFigureSelection(model.getSelectedFigures());\n-        validateAll();\n-        centerSelectedFigures();\n@@ -633,0 +610,1 @@\n+        updateHiddenNodes(model.getHiddenNodes(), true);\n@@ -635,8 +613,2 @@\n-    public void validateAll() {\n-        validate();\n-        scrollPane.validate();\n-    }\n-\n-    private void graphChanged() {\n-        update();\n-        centerRootNode();\n+    private void hiddenNodesChanged() {\n+        updateHiddenNodes(model.getHiddenNodes(), true);\n@@ -646,22 +618,2 @@\n-    private void centerRootNode() {\n-        if (getModel().getSelectedNodes().isEmpty()) {\n-            Figure rootFigure = getModel().getDiagram().getRootFigure();\n-            if (rootFigure != null) {\n-                int rootId = rootFigure.getInputNode().getId();\n-                if (!getModel().getHiddenNodes().contains(rootId)) {\n-                    FigureWidget rootWidget = getWidget(rootFigure);\n-                    if (rootWidget != null) {\n-                        Rectangle bounds = rootWidget.getBounds();\n-                        if (bounds != null) {\n-                            Point location = rootWidget.getLocation();\n-                            centerRectangle(new Rectangle(location.x, location.y, bounds.width, bounds.height));\n-                        }\n-                    }\n-                }\n-            }\n-        }\n-    }\n-\n-    private void hiddenNodesChanged() {\n-        relayout();\n-        addUndo();\n+    private void selectedNodesChanged() {\n+        updateHiddenNodes(model.getHiddenNodes(), false);\n@@ -693,0 +645,31 @@\n+    private void relayout(Set<Widget> oldVisibleWidgets) {\n+        Diagram diagram = getModel().getDiagram();\n+\n+        HashSet<Figure> figures = new HashSet<>();\n+\n+        for (Figure f : diagram.getFigures()) {\n+            FigureWidget w = getWidget(f);\n+            if (w.isVisible()) {\n+                figures.add(f);\n+            }\n+        }\n+\n+        HashSet<Connection> edges = new HashSet<>();\n+\n+        for (Connection c : diagram.getConnections()) {\n+            if (isVisible(c)) {\n+                edges.add(c);\n+            }\n+        }\n+\n+        if (getModel().getShowSea()) {\n+            doSeaLayout(figures, edges);\n+        } else if (getModel().getShowBlocks()) {\n+            doClusteredLayout(edges);\n+        } else if (getModel().getShowCFG()) {\n+            doCFGLayout(figures, edges);\n+        }\n+\n+        relayoutWithoutLayout(oldVisibleWidgets);\n+    }\n+\n@@ -758,1 +741,1 @@\n-\n+    private Set<Pair<Point, Point>> lineCache = new HashSet<>();\n@@ -770,0 +753,63 @@\n+    private void relayoutWithoutLayout(Set<Widget> oldVisibleWidgets) {\n+        assert oldVisibleWidgets != null;\n+\n+        Diagram diagram = getModel().getDiagram();\n+        connectionLayer.removeChildren();\n+\n+        SceneAnimator connectionAnimator = getSceneAnimator();\n+        boolean doAnimation = shouldAnimate();\n+        if (!doAnimation) {\n+            connectionAnimator = null;\n+        }\n+\n+        Set<Pair<Point, Point>> lastLineCache = lineCache;\n+        lineCache = new HashSet<>();\n+        for (Figure figure : diagram.getFigures()) {\n+            for (OutputSlot outputSlot : figure.getOutputSlots()) {\n+                List<Connection> connectionList = new ArrayList<>(outputSlot.getConnections());\n+                processOutputSlot(lastLineCache, outputSlot, connectionList, 0, null, null, connectionAnimator);\n+            }\n+        }\n+\n+        if (getModel().getShowCFG()) {\n+            for (BlockConnection c : diagram.getBlockConnections()) {\n+                if (isVisible(c)) {\n+                    processOutputSlot(lastLineCache, null, Collections.singletonList(c), 0, null, null, connectionAnimator);\n+                }\n+            }\n+        }\n+\n+        SceneAnimator animator = getSceneAnimator();\n+        for (Figure f : diagram.getFigures()) {\n+            FigureWidget w = getWidget(f);\n+            if (w.isVisible()) {\n+                Point p = f.getPosition();\n+                Point p2 = new Point(p.x, p.y);\n+                if (doAnimation && oldVisibleWidgets.contains(w)) {\n+                    animator.animatePreferredLocation(w, p2);\n+                } else {\n+                    w.setPreferredLocation(p2);\n+                    animator.animatePreferredLocation(w, p2);\n+                }\n+            }\n+        }\n+\n+        if (getModel().getShowBlocks() || getModel().getShowCFG()) {\n+            for (Block b : diagram.getBlocks()) {\n+                BlockWidget w = getWidget(b.getInputBlock());\n+                if (w != null && w.isVisible()) {\n+                    Point location = new Point(b.getBounds().x, b.getBounds().y);\n+                    Rectangle r = new Rectangle(location.x, location.y, b.getBounds().width, b.getBounds().height);\n+\n+                    if (doAnimation && oldVisibleWidgets.contains(w)) {\n+                        animator.animatePreferredBounds(w, r);\n+                    } else {\n+                        w.setPreferredBounds(r);\n+                        animator.animatePreferredBounds(w, r);\n+                    }\n+                }\n+            }\n+        }\n+\n+        validate();\n+    }\n@@ -772,1 +818,1 @@\n-    private void processOutputSlot(OutputSlot outputSlot, List<Connection> connections, int controlPointIndex, Point lastPoint, LineWidget predecessor) {\n+    private void processOutputSlot(Set<Pair<Point, Point>> lastLineCache, OutputSlot outputSlot, List<Connection> connections, int controlPointIndex, Point lastPoint, LineWidget predecessor, SceneAnimator animator) {\n@@ -812,0 +858,1 @@\n+\n@@ -813,0 +860,1 @@\n+\n@@ -815,2 +863,0 @@\n-                } else if (c.getStyle() == Connection.ConnectionStyle.INVISIBLE) {\n-                    isVisible = false;\n@@ -818,0 +864,1 @@\n+\n@@ -821,0 +868,4 @@\n+\n+                if (c.getStyle() == Connection.ConnectionStyle.INVISIBLE) {\n+                    isVisible = false;\n+                }\n@@ -825,8 +876,16 @@\n-                Point src = new Point(lastPoint);\n-                Point dest = new Point(currentPoint);\n-                newPredecessor = new LineWidget(this, outputSlot, connectionList, src, dest, predecessor, isBold, isDashed);\n-                newPredecessor.setVisible(isVisible);\n-\n-                connectionLayer.addChild(newPredecessor);\n-                addObject(new ConnectionSet(connectionList), newPredecessor);\n-                newPredecessor.getActions().addAction(hoverAction);\n+                Point p1 = new Point(lastPoint.x, lastPoint.y);\n+                Point p2 = new Point(currentPoint.x, currentPoint.y);\n+\n+                Pair<Point, Point> curPair = new Pair<>(p1, p2);\n+                SceneAnimator curAnimator = animator;\n+                if (lastLineCache.contains(curPair)) {\n+                    curAnimator = null;\n+                }\n+                LineWidget lineWidget = new LineWidget(this, outputSlot, connectionList, p1, p2, predecessor, curAnimator, isBold, isDashed);\n+                lineWidget.setVisible(isVisible);\n+                lineCache.add(curPair);\n+\n+                newPredecessor = lineWidget;\n+                connectionLayer.addChild(lineWidget);\n+                addObject(new ConnectionSet(connectionList), lineWidget);\n+                lineWidget.getActions().addAction(hoverAction);\n@@ -835,1 +894,1 @@\n-            processOutputSlot(outputSlot, connectionList, controlPointIndex + 1, currentPoint, newPredecessor);\n+            processOutputSlot(lastLineCache, outputSlot, connectionList, controlPointIndex + 1, currentPoint, newPredecessor, animator);\n@@ -848,1 +907,1 @@\n-        clearSelectedNodes();\n+        setSelectedObjects(Collections.emptySet());\n@@ -876,10 +935,5 @@\n-    @Override\n-    public void addSelectedNodes(Collection<InputNode> nodes, boolean showIfHidden) {\n-        Set<Integer> nodeIds = new HashSet<>(model.getSelectedNodes());\n-        for (InputNode inputNode : nodes) {\n-            nodeIds.add(inputNode.getId());\n-        }\n-        Set<Figure> selectedFigures = new HashSet<>();\n-        for (Figure figure : model.getDiagram().getFigures()) {\n-            if (nodeIds.contains(figure.getInputNode().getId())) {\n-                selectedFigures.add(figure);\n+    private Set<Object> idSetToObjectSet(Set<Integer> ids) {\n+        Set<Object> result = new HashSet<>();\n+        for (Figure f : getModel().getDiagram().getFigures()) {\n+            if (ids.contains(f.getInputNode().getId())) {\n+                result.add(f);\n@@ -887,11 +941,0 @@\n-        }\n-        setFigureSelection(selectedFigures);\n-        if (showIfHidden) {\n-            model.showFigures(model.getSelectedFigures());\n-        }\n-    }\n-\n-    @Override\n-    public void clearSelectedNodes() {\n-        setSelectedObjects(Collections.emptySet());\n-    }\n@@ -899,16 +942,3 @@\n-    @Override\n-    public void centerSelectedFigures() {\n-        Set<Figure> selectedFigures = model.getSelectedFigures();\n-        Rectangle overallRect = null;\n-        for (Figure figure : selectedFigures) {\n-            FigureWidget figureWidget = getWidget(figure);\n-            if (figureWidget != null) {\n-                Rectangle bounds = figureWidget.getBounds();\n-                if (bounds != null) {\n-                    Point location = figureWidget.getLocation();\n-                    Rectangle figureRect = new Rectangle(location.x, location.y, bounds.width, bounds.height);\n-                    if (overallRect == null) {\n-                        overallRect = figureRect;\n-                    } else {\n-                        overallRect = overallRect.union(figureRect);\n-                    }\n+            for (Slot s : f.getSlots()) {\n+                if (!Collections.disjoint(s.getSource().getSourceNodesAsSet(), ids)) {\n+                    result.add(s);\n@@ -918,3 +948,1 @@\n-        if (overallRect != null) {\n-            centerRectangle(overallRect);\n-        }\n+        return result;\n@@ -926,1 +954,0 @@\n-\n@@ -928,6 +955,2 @@\n-        double zoomFactor = getZoomFactor();\n-        double newZoomFactor = zoomFactor * factor;\n-        if (factor < 1.0 || zoomFactor < 1.0) {\n-            newZoomFactor = Math.min(1.0, newZoomFactor);\n-            centredZoom(newZoomFactor, null);\n-            factor = newZoomFactor \/ zoomFactor;\n+        if (factor < 1.0) {\n+            centredZoom(getZoomFactor() * factor, null);\n@@ -943,1 +966,1 @@\n-        viewRect.x = Math.min(getView().getBounds().width - viewRect.width, viewRect.x);\n+        viewRect.x = Math.min(scrollPane.getViewport().getViewSize().width - viewRect.width, viewRect.x);\n@@ -945,1 +968,1 @@\n-        viewRect.y = Math.min(getView().getBounds().height - viewRect.height, viewRect.y);\n+        viewRect.y = Math.min(scrollPane.getViewport().getViewSize().height - viewRect.height, viewRect.y);\n@@ -949,1 +972,2 @@\n-    private void setFigureSelection(Set<Figure> list) {\n+    @Override\n+    public void setFigureSelection(Set<Figure> list) {\n@@ -979,8 +1003,1 @@\n-    private void rebuildConnectionLayer() {\n-        connectionLayer.removeChildren();\n-        for (Figure figure : getModel().getDiagram().getFigures()) {\n-            for (OutputSlot outputSlot : figure.getOutputSlots()) {\n-                List<Connection> connectionList = new ArrayList<>(outputSlot.getConnections());\n-                processOutputSlot(outputSlot, connectionList, 0, null, null);\n-            }\n-        }\n+    private void updateHiddenNodes(Set<Integer> newHiddenNodes, boolean doRelayout) {\n@@ -988,8 +1005,2 @@\n-        if (getModel().getShowCFG()) {\n-            for (BlockConnection blockConnection : getModel().getDiagram().getBlockConnections()) {\n-                if (isVisible(blockConnection)) {\n-                    processOutputSlot(null, Collections.singletonList(blockConnection), 0, null, null);\n-                }\n-            }\n-        }\n-    }\n+        Diagram diagram = getModel().getDiagram();\n+        assert diagram != null;\n@@ -997,6 +1008,7 @@\n-    private Set<FigureWidget> getVisibleFigureWidgets() {\n-        Set<FigureWidget> visibleFigureWidgets = new HashSet<>();\n-        for (Figure figure : getModel().getDiagram().getFigures()) {\n-            FigureWidget figureWidget = getWidget(figure);\n-            if (figureWidget != null && figureWidget.isVisible()) {\n-                visibleFigureWidgets.add(figureWidget);\n+        Set<InputBlock> visibleBlocks = new HashSet<>();\n+        Set<Widget> oldVisibleWidgets = new HashSet<>();\n+\n+        for (Figure f : diagram.getFigures()) {\n+            FigureWidget w = getWidget(f);\n+            if (w != null && w.isVisible()) {\n+                oldVisibleWidgets.add(w);\n@@ -1005,2 +1017,0 @@\n-        return visibleFigureWidgets;\n-    }\n@@ -1008,2 +1018,0 @@\n-    private Set<BlockWidget> getVisibleBlockWidgets() {\n-        Set<BlockWidget> visibleBlockWidgets = new HashSet<>();\n@@ -1011,4 +1019,4 @@\n-            for (InputBlock inputBlock : getModel().getDiagram().getInputBlocks()) {\n-                BlockWidget blockWidget = getWidget(inputBlock);\n-                if (blockWidget.isVisible()) {\n-                    visibleBlockWidgets.add(blockWidget);\n+            for (InputBlock b : diagram.getInputBlocks()) {\n+                BlockWidget w = getWidget(b);\n+                if (w.isVisible()) {\n+                    oldVisibleWidgets.add(w);\n@@ -1018,2 +1026,0 @@\n-        return visibleBlockWidgets;\n-    }\n@@ -1021,5 +1027,11 @@\n-    private void updateVisibleFigureWidgets() {\n-        for (Figure figure : getModel().getDiagram().getFigures()) {\n-            FigureWidget figureWidget = getWidget(figure);\n-            figureWidget.setBoundary(false);\n-            figureWidget.setVisible(!model.getHiddenNodes().contains(figure.getInputNode().getId()));\n+        for (Figure f : diagram.getFigures()) {\n+            FigureWidget w = getWidget(f);\n+            w.setBoundary(false);\n+            if (newHiddenNodes.contains(f.getInputNode().getId())) {\n+                \/\/ Figure is hidden\n+                w.setVisible(false);\n+            } else {\n+                \/\/ Figure is shown\n+                w.setVisible(true);\n+                visibleBlocks.add(f.getBlock().getInputBlock());\n+            }\n@@ -1027,1 +1039,0 @@\n-    }\n@@ -1029,1 +1040,0 @@\n-    private void updateNodeHull() {\n@@ -1032,7 +1042,8 @@\n-            for (Figure figure : getModel().getDiagram().getFigures()) {\n-                FigureWidget figureWidget = getWidget(figure);\n-                if (!figureWidget.isVisible()) {\n-                    Set<Figure> neighborSet = new HashSet<>(figure.getPredecessorSet());\n-                    neighborSet.addAll(figure.getSuccessorSet());\n-                    boolean hasVisibleNeighbor = false;\n-                    for (Figure neighbor : neighborSet) {\n+            for (Figure f : diagram.getFigures()) {\n+                FigureWidget w = getWidget(f);\n+                if (!w.isVisible()) {\n+                    Set<Figure> set = new HashSet<>(f.getPredecessorSet());\n+                    set.addAll(f.getSuccessorSet());\n+\n+                    boolean b = false;\n+                    for (Figure neighbor : set) {\n@@ -1041,1 +1052,1 @@\n-                            hasVisibleNeighbor = true;\n+                            b = true;\n@@ -1045,13 +1056,0 @@\n-                    if (hasVisibleNeighbor) {\n-                        figureWidget.setBoundary(true);\n-                        boundaries.add(figureWidget);\n-                    }\n-                }\n-            }\n-            for (FigureWidget figureWidget : boundaries) {\n-                figureWidget.setVisible(true);\n-            }\n-        } else {\n-            getModel().getSelectedNodes().removeAll(getModel().getHiddenNodes());\n-        }\n-    }\n@@ -1059,19 +1057,4 @@\n-    private void updateVisibleBlockWidgets() {\n-        if (getModel().getShowBlocks() || getModel().getShowCFG()) {\n-            Set<InputBlock> visibleBlocks = new HashSet<>();\n-            for (Figure figure : getModel().getDiagram().getFigures()) {\n-                FigureWidget figureWidget = getWidget(figure);\n-                if (figureWidget.isVisible()) {\n-                    visibleBlocks.add(figure.getBlock().getInputBlock());\n-                }\n-            }\n-            if (getModel().getShowCFG() && getModel().getShowEmptyBlocks()) {\n-                \/\/ Add remaining blocks.\n-                visibleBlocks.addAll(getModel().getDiagram().getInputBlocks());\n-            }\n-            if (getModel().getShowCFG()) {\n-                \/\/ Blockless figures and artificial blocks are hidden in this view.\n-                for (Figure figure : getModel().getDiagram().getFigures()) {\n-                    if (figure.getBlock().getInputBlock().isArtificial()) {\n-                        FigureWidget figureWidget = getWidget(figure);\n-                        figureWidget.setVisible(false);\n+                    if (b) {\n+                        w.setBoundary(true);\n+                        visibleBlocks.add(f.getBlock().getInputBlock());\n+                        boundaries.add(w);\n@@ -1082,43 +1065,3 @@\n-            for (InputBlock inputBlock : getModel().getDiagram().getInputBlocks()) {\n-                \/\/ A block is visible if it is marked as such, except for\n-                \/\/ artificial or null blocks in the CFG view.\n-                boolean visibleAfter = visibleBlocks.contains(inputBlock) &&\n-                        !(getModel().getShowCFG() && (inputBlock.isArtificial() || inputBlock.getNodes().isEmpty()));\n-\n-                BlockWidget blockWidget = getWidget(inputBlock);\n-                blockWidget.setVisible(visibleAfter);\n-            }\n-        }\n-    }\n-\n-    private HashSet<Figure> getVisibleFigures() {\n-        HashSet<Figure> visibleFigures = new HashSet<>();\n-        for (Figure figure : getModel().getDiagram().getFigures()) {\n-            FigureWidget figureWidget = getWidget(figure);\n-            if (figureWidget.isVisible()) {\n-                visibleFigures.add(figure);\n-            }\n-        }\n-        return visibleFigures;\n-    }\n-\n-    private HashSet<Connection> getVisibleConnections() {\n-        HashSet<Connection> visibleConnections = new HashSet<>();\n-        for (Connection connection : getModel().getDiagram().getConnections()) {\n-            if (isVisible(connection)) {\n-                visibleConnections.add(connection);\n-            }\n-        }\n-        return visibleConnections;\n-    }\n-\n-    private void updateFigureWidgetLocations(Set<FigureWidget> oldVisibleFigureWidgets) {\n-        boolean doAnimation = shouldAnimate();\n-        for (Figure figure : getModel().getDiagram().getFigures()) {\n-            FigureWidget figureWidget = getWidget(figure);\n-            if (figureWidget.isVisible()) {\n-                Point location = new Point(figure.getPosition());\n-                if (doAnimation && oldVisibleFigureWidgets.contains(figureWidget)) {\n-                    getSceneAnimator().animatePreferredLocation(figureWidget, location);\n-                } else {\n-                    figureWidget.setPreferredLocation(location);\n+            for (FigureWidget w : boundaries) {\n+                if (w.isBoundary()) {\n+                    w.setVisible(true);\n@@ -1128,1 +1071,0 @@\n-    }\n@@ -1130,12 +1072,6 @@\n-    private void updateBlockWidgetBounds(Set<BlockWidget> oldVisibleBlockWidgets) {\n-        if (getModel().getShowBlocks() || getModel().getShowCFG()) {\n-            boolean doAnimation = shouldAnimate();\n-            for (Block block : getModel().getDiagram().getBlocks()) {\n-                BlockWidget blockWidget = getWidget(block.getInputBlock());\n-                if (blockWidget != null && blockWidget.isVisible()) {\n-                    Rectangle bounds = new Rectangle(block.getBounds());\n-                    if (doAnimation && oldVisibleBlockWidgets.contains(blockWidget)) {\n-                        getSceneAnimator().animatePreferredBounds(blockWidget, bounds);\n-                    } else {\n-                        blockWidget.setPreferredBounds(bounds);\n-                    }\n+        if (getModel().getShowCFG()) {\n+            \/\/ Blockless figures and artificial blocks are hidden in this view.\n+            for (Figure f : diagram.getFigures()) {\n+                if (f.getBlock().getInputBlock().isArtificial()) {\n+                    FigureWidget w = getWidget(f);\n+                    w.setVisible(false);\n@@ -1144,0 +1080,4 @@\n+            if (getModel().getShowEmptyBlocks()) {\n+                \/\/ Add remaining blocks.\n+                visibleBlocks.addAll(diagram.getInputBlocks());\n+            }\n@@ -1145,8 +1085,0 @@\n-    }\n-\n-    private void centerSingleSelectedFigure() {\n-        if (model.getSelectedFigures().size() == 1) {\n-            if (getSceneAnimator().getPreferredLocationAnimator().isRunning()) {\n-                getSceneAnimator().getPreferredLocationAnimator().addAnimatorListener(new AnimatorListener() {\n-                    @Override\n-                    public void animatorStarted(AnimatorEvent animatorEvent) {}\n@@ -1154,7 +1086,2 @@\n-                    @Override\n-                    public void animatorReset(AnimatorEvent animatorEvent) {}\n-\n-                    @Override\n-                    public void animatorFinished(AnimatorEvent animatorEvent) {\n-                        getSceneAnimator().getPreferredLocationAnimator().removeAnimatorListener(this);\n-                    }\n+        if (getModel().getShowBlocks() || getModel().getShowCFG()) {\n+            for (InputBlock b : diagram.getInputBlocks()) {\n@@ -1162,2 +1089,4 @@\n-                    @Override\n-                    public void animatorPreTick(AnimatorEvent animatorEvent) {}\n+                \/\/ A block is visible if it is marked as such, except for\n+                \/\/ artificial or null blocks in the CFG view.\n+                boolean visibleAfter = visibleBlocks.contains(b) &&\n+                    !(getModel().getShowCFG() && (b.isArtificial() || b.getNodes().isEmpty()));\n@@ -1165,8 +1094,2 @@\n-                    @Override\n-                    public void animatorPostTick(AnimatorEvent animatorEvent) {\n-                        validateAll();\n-                        centerSelectedFigures();\n-                    }\n-                });\n-            } else {\n-                centerSelectedFigures();\n+                BlockWidget w = getWidget(b);\n+                w.setVisible(visibleAfter);\n@@ -1175,6 +1098,0 @@\n-    }\n-\n-    private void relayout() {\n-        rebuilding = true;\n-        Set<FigureWidget> oldVisibleFigureWidgets = getVisibleFigureWidgets();\n-        Set<BlockWidget> oldVisibleBlockWidgets = getVisibleBlockWidgets();\n@@ -1182,12 +1099,2 @@\n-        updateVisibleFigureWidgets();\n-        updateNodeHull();\n-        updateVisibleBlockWidgets();\n-\n-        HashSet<Figure> visibleFigures = getVisibleFigures();\n-        HashSet<Connection> visibleConnections = getVisibleConnections();\n-        if (getModel().getShowSea()) {\n-            doSeaLayout(visibleFigures, visibleConnections);\n-        } else if (getModel().getShowBlocks()) {\n-            doClusteredLayout(visibleConnections);\n-        } else if (getModel().getShowCFG()) {\n-            doCFGLayout(visibleFigures, visibleConnections);\n+        if (doRelayout) {\n+            relayout(oldVisibleWidgets);\n@@ -1195,8 +1102,1 @@\n-        rebuildConnectionLayer();\n-\n-        updateFigureWidgetLocations(oldVisibleFigureWidgets);\n-        updateBlockWidgetBounds(oldVisibleBlockWidgets);\n-        validateAll();\n-\n-        centerSingleSelectedFigure();\n-        rebuilding = false;\n+        validate();\n","filename":"src\/utils\/IdealGraphVisualizer\/View\/src\/main\/java\/com\/sun\/hotspot\/igv\/view\/DiagramScene.java","additions":309,"deletions":409,"binary":false,"changes":718,"status":"modified"},{"patch":"@@ -38,1 +38,0 @@\n-import com.sun.hotspot.igv.view.actions.GlobalSelectionAction;\n@@ -69,1 +68,0 @@\n-    private static boolean globalSelection = false;\n@@ -71,1 +69,1 @@\n-    private final ChangedListener<FilterChain> filterChainChangedListener = source -> filterChanged();\n+    private final ChangedListener<FilterChain> filterChainChangedListener = source -> rebuildDiagram();\n@@ -77,9 +75,0 @@\n-    public boolean getGlobalSelection() {\n-        return globalSelection;\n-    }\n-\n-    public void setGlobalSelection(boolean enable) {\n-        globalSelection = enable;\n-        diagramChangedEvent.fire();\n-    }\n-\n@@ -132,1 +121,0 @@\n-        this.hideDuplicates = hideDuplicates;\n@@ -144,0 +132,1 @@\n+        diagramChangedEvent.fire();\n@@ -148,0 +137,1 @@\n+        super(Collections.singletonList(\"default\"));\n@@ -153,1 +143,0 @@\n-        globalSelection = GlobalSelectionAction.get(GlobalSelectionAction.class).isSelected();\n@@ -216,1 +205,1 @@\n-        selectedNodes = nodes;\n+        this.selectedNodes = nodes;\n@@ -257,1 +246,1 @@\n-        boolean somethingChanged = false;\n+        HashSet<Integer> newHiddenNodes = new HashSet<>(hiddenNodes);\n@@ -259,6 +248,1 @@\n-            if (hiddenNodes.remove(f.getInputNode().getId())) {\n-                somethingChanged = true;\n-            }\n-        }\n-        if (somethingChanged) {\n-            hiddenNodesChangedEvent.fire();\n+            newHiddenNodes.remove(f.getInputNode().getId());\n@@ -266,0 +250,1 @@\n+        setHiddenNodes(newHiddenNodes);\n@@ -285,2 +270,1 @@\n-        hiddenNodes = nodes;\n-        selectedNodes.removeAll(hiddenNodes);\n+        this.hiddenNodes = nodes;\n@@ -294,5 +278,0 @@\n-    private void filterChanged() {\n-        rebuildDiagram();\n-        diagramChangedEvent.fire();\n-    }\n-\n@@ -321,0 +300,2 @@\n+\n+        diagramChangedEvent.fire();\n","filename":"src\/utils\/IdealGraphVisualizer\/View\/src\/main\/java\/com\/sun\/hotspot\/igv\/view\/DiagramViewModel.java","additions":10,"deletions":29,"binary":false,"changes":39,"status":"modified"},{"patch":"@@ -28,1 +28,1 @@\n-import com.sun.hotspot.igv.data.InputNode;\n+import com.sun.hotspot.igv.graph.Figure;\n@@ -34,0 +34,1 @@\n+import java.util.Set;\n@@ -79,1 +80,1 @@\n-    void centerSelectedFigures();\n+    void setFigureSelection(Set<Figure> list);\n@@ -81,3 +82,1 @@\n-    void addSelectedNodes(Collection<InputNode> nodes, boolean showIfHidden);\n-\n-    void clearSelectedNodes();\n+    void centerFigures(Collection<Figure> list);\n","filename":"src\/utils\/IdealGraphVisualizer\/View\/src\/main\/java\/com\/sun\/hotspot\/igv\/view\/DiagramViewer.java","additions":4,"deletions":5,"binary":false,"changes":9,"status":"modified"},{"patch":"@@ -60,1 +60,1 @@\n-    public void centerSelectedNodes() {\n+    public void addSelectedNodes(Collection<InputNode> nodes) {\n@@ -62,10 +62,1 @@\n-            editor.centerSelectedNodes();\n-            editor.requestActive();\n-        }\n-    }\n-\n-    @Override\n-    public void addSelectedNodes(Collection<InputNode> nodes, boolean showIfHidden) {\n-        if (editor != null && EditorTopComponent.isOpen(editor)) {\n-            editor.addSelectedNodes(nodes, showIfHidden);\n-            editor.requestActive();\n+            editor.addSelectedNodes(nodes, false);\n@@ -79,1 +70,0 @@\n-            editor.requestActive();\n","filename":"src\/utils\/IdealGraphVisualizer\/View\/src\/main\/java\/com\/sun\/hotspot\/igv\/view\/EditorInputGraphProvider.java","additions":2,"deletions":12,"binary":false,"changes":14,"status":"modified"},{"patch":"@@ -26,4 +26,1 @@\n-import com.sun.hotspot.igv.data.GraphDocument;\n-import com.sun.hotspot.igv.data.Group;\n-import com.sun.hotspot.igv.data.InputGraph;\n-import com.sun.hotspot.igv.data.InputNode;\n+import com.sun.hotspot.igv.data.*;\n@@ -33,0 +30,2 @@\n+import com.sun.hotspot.igv.graph.Diagram;\n+import com.sun.hotspot.igv.graph.Figure;\n@@ -78,0 +77,1 @@\n+\n@@ -150,1 +150,5 @@\n-        diagramViewModel.getGraphChangedEvent().addListener(model -> graphChanged(model));\n+        diagramViewModel.getDiagramChangedEvent().addListener(model -> {\n+            setDisplayName(model.getGraph().getDisplayName());\n+            setToolTipText(model.getGroup().getDisplayName());\n+            graphContent.set(Collections.singletonList(new EditorInputGraphProvider(this)), null);\n+        });\n@@ -221,4 +225,0 @@\n-\n-        JToggleButton globalSelectionButton = new JToggleButton(GlobalSelectionAction.get(GlobalSelectionAction.class));\n-        globalSelectionButton.setHideActionText(true);\n-        toolBar.add(globalSelectionButton);\n@@ -246,8 +246,0 @@\n-\n-        graphChanged(diagramViewModel);\n-    }\n-\n-    private void graphChanged(DiagramViewModel model) {\n-        setDisplayName(model.getGraph().getDisplayName());\n-        setToolTipText(model.getGroup().getDisplayName());\n-        graphContent.set(Collections.singletonList(new EditorInputGraphProvider(this)), null);\n@@ -260,0 +252,4 @@\n+    private Diagram getDiagram() {\n+        return getModel().getDiagram();\n+    }\n+\n@@ -333,6 +329,15 @@\n-    public void addSelectedNodes(Collection<InputNode> nodes, boolean showIfHidden) {\n-        scene.addSelectedNodes(nodes, showIfHidden);\n-    }\n-\n-    public void centerSelectedNodes() {\n-        scene.centerSelectedFigures();\n+    public void addSelectedNodes(Collection<InputNode> nodes, boolean centerSelection) {\n+        Set<Integer> ids = new HashSet<>(getModel().getSelectedNodes());\n+        for (InputNode n : nodes) {\n+            ids.add(n.getId());\n+        }\n+        Set<Figure> selectedFigures = new HashSet<>();\n+        for (Figure f : getDiagram().getFigures()) {\n+            if (ids.contains(f.getInputNode().getId())) {\n+                selectedFigures.add(f);\n+            }\n+        }\n+        scene.setFigureSelection(selectedFigures);\n+        if (centerSelection) {\n+            scene.centerFigures(selectedFigures);\n+        }\n@@ -342,1 +347,1 @@\n-        scene.clearSelectedNodes();\n+        scene.setFigureSelection(Collections.emptySet());\n","filename":"src\/utils\/IdealGraphVisualizer\/View\/src\/main\/java\/com\/sun\/hotspot\/igv\/view\/EditorTopComponent.java","additions":29,"deletions":24,"binary":false,"changes":53,"status":"modified"},{"patch":"@@ -126,1 +126,0 @@\n-                            editor.centerSelectedNodes();\n@@ -156,1 +155,0 @@\n-                                editor.centerSelectedNodes();\n","filename":"src\/utils\/IdealGraphVisualizer\/View\/src\/main\/java\/com\/sun\/hotspot\/igv\/view\/NodeQuickSearch.java","additions":0,"deletions":2,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -1,73 +0,0 @@\n-\/*\n- * Copyright (c) 2022, Oracle and\/or its affiliates. All rights reserved.\n- * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n- *\n- * This code is free software; you can redistribute it and\/or modify it\n- * under the terms of the GNU General Public License version 2 only, as\n- * published by the Free Software Foundation.\n- *\n- * This code is distributed in the hope that it will be useful, but WITHOUT\n- * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n- * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n- * version 2 for more details (a copy is included in the LICENSE file that\n- * accompanied this code).\n- *\n- * You should have received a copy of the GNU General Public License version\n- * 2 along with this work; if not, write to the Free Software Foundation,\n- * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n- *\n- * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n- * or visit www.oracle.com if you need additional information or have any\n- * questions.\n- *\n- *\/\n-package com.sun.hotspot.igv.view.actions;\n-\n-import com.sun.hotspot.igv.view.DiagramViewModel;\n-import com.sun.hotspot.igv.view.EditorTopComponent;\n-import org.openide.awt.ActionID;\n-import org.openide.awt.ActionReference;\n-import org.openide.awt.ActionReferences;\n-import org.openide.awt.ActionRegistration;\n-import org.openide.util.NbBundle;\n-\n-@ActionID(category = \"View\", id = \"com.sun.hotspot.igv.view.actions.CenterSelectedNodesAction\")\n-@ActionRegistration(displayName = \"#CTL_CenterSelectedNodesAction\")\n-@ActionReferences({\n-        @ActionReference(path = \"Menu\/View\", position = 600),\n-        @ActionReference(path = \"Shortcuts\", name = \"D-9\")\n-})\n-@NbBundle.Messages({\n-        \"CTL_CenterSelectedNodesAction=Center selected nodes\",\n-        \"HINT_CenterSelectedNodesAction=Center the selected nodes\"\n-})\n-public final class CenterSelectedNodesAction extends ModelAwareAction {\n-\n-    @Override\n-    protected String iconResource() {\n-        return \"com\/sun\/hotspot\/igv\/view\/images\/centerSelectedNodes.svg\"; \/\/ NOI18N\n-    }\n-\n-    @Override\n-    public String getName() {\n-        return NbBundle.getMessage(NextDiagramAction.class, \"CTL_CenterSelectedNodesAction\");\n-    }\n-\n-    @Override\n-    protected String getDescription() {\n-        return NbBundle.getMessage(NextDiagramAction.class, \"HINT_CenterSelectedNodesAction\");\n-    }\n-\n-    @Override\n-    public void performAction(DiagramViewModel model) {\n-        EditorTopComponent editor = EditorTopComponent.findEditorForGraph(model.getGraph());\n-        if (editor != null) {\n-            editor.centerSelectedNodes();\n-        }\n-    }\n-\n-    @Override\n-    public boolean isEnabled(DiagramViewModel model) {\n-        return !model.getSelectedNodes().isEmpty();\n-    }\n-}\n","filename":"src\/utils\/IdealGraphVisualizer\/View\/src\/main\/java\/com\/sun\/hotspot\/igv\/view\/actions\/CenterSelectedNodesAction.java","additions":0,"deletions":73,"binary":false,"changes":73,"status":"deleted"},{"patch":"@@ -55,1 +55,1 @@\n-        return NbBundle.getMessage(ExpandDiffAction.class, \"CTL_ExpandDiffAction\");\n+        return NbBundle.getMessage(NextDiagramAction.class, \"CTL_ExpandDiffAction\");\n@@ -60,1 +60,1 @@\n-        return NbBundle.getMessage(ExpandDiffAction.class, \"HINT_ExpandDiffAction\");\n+        return NbBundle.getMessage(NextDiagramAction.class, \"HINT_ExpandDiffAction\");\n","filename":"src\/utils\/IdealGraphVisualizer\/View\/src\/main\/java\/com\/sun\/hotspot\/igv\/view\/actions\/ExpandDiffAction.java","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -57,1 +57,1 @@\n-        return NbBundle.getMessage(ExtractAction.class, \"HINT_ExtractAction\");\n+        return NbBundle.getMessage(NextDiagramAction.class, \"HINT_ExtractAction\");\n@@ -62,1 +62,1 @@\n-        return NbBundle.getMessage(ExtractAction.class, \"CTL_ExtractAction\");\n+        return NbBundle.getMessage(NextDiagramAction.class, \"CTL_ExtractAction\");\n","filename":"src\/utils\/IdealGraphVisualizer\/View\/src\/main\/java\/com\/sun\/hotspot\/igv\/view\/actions\/ExtractAction.java","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -1,98 +0,0 @@\n-\/*\n- * Copyright (c) 2022, Oracle and\/or its affiliates. All rights reserved.\n- * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n- *\n- * This code is free software; you can redistribute it and\/or modify it\n- * under the terms of the GNU General Public License version 2 only, as\n- * published by the Free Software Foundation.\n- *\n- * This code is distributed in the hope that it will be useful, but WITHOUT\n- * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n- * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n- * version 2 for more details (a copy is included in the LICENSE file that\n- * accompanied this code).\n- *\n- * You should have received a copy of the GNU General Public License version\n- * 2 along with this work; if not, write to the Free Software Foundation,\n- * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n- *\n- * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n- * or visit www.oracle.com if you need additional information or have any\n- * questions.\n- *\n- *\/\n-package com.sun.hotspot.igv.view.actions;\n-\n-import com.sun.hotspot.igv.view.EditorTopComponent;\n-import javax.swing.AbstractAction;\n-import javax.swing.Action;\n-import javax.swing.ImageIcon;\n-import javax.swing.SwingUtilities;\n-import org.openide.awt.ActionID;\n-import org.openide.awt.ActionReference;\n-import org.openide.awt.ActionReferences;\n-import org.openide.awt.ActionRegistration;\n-import org.openide.util.HelpCtx;\n-import org.openide.util.ImageUtilities;\n-import org.openide.util.NbBundle;\n-import org.openide.util.actions.CallableSystemAction;\n-\n-@ActionID(category = \"View\", id = \"com.sun.hotspot.igv.view.actions.GlobalSelectionAction\")\n-@ActionRegistration(displayName = \"#CTL_GlobalSelectionAction\")\n-@ActionReferences({\n-        @ActionReference(path = \"Menu\/Options\", position = 300),\n-        @ActionReference(path = \"Shortcuts\", name = \"D-L\")\n-})\n-@NbBundle.Messages({\n-        \"CTL_GlobalSelectionAction=Link selection globally\",\n-        \"HINT_GlobalSelectionAction=Link node selection globally\"\n-})\n-public final class GlobalSelectionAction extends CallableSystemAction {\n-\n-    private boolean isSelected;\n-\n-    public GlobalSelectionAction() {\n-        putValue(AbstractAction.SMALL_ICON, new ImageIcon(ImageUtilities.loadImage(iconResource())));\n-        putValue(Action.SHORT_DESCRIPTION, getDescription());\n-        putValue(SELECTED_KEY, false);\n-        isSelected = false;\n-    }\n-\n-    @Override\n-    public String getName() {\n-        return NbBundle.getMessage(GlobalSelectionAction.class, \"CTL_GlobalSelectionAction\");\n-    }\n-\n-    @Override\n-    public HelpCtx getHelpCtx() {\n-        return HelpCtx.DEFAULT_HELP;\n-    }\n-\n-    @Override\n-    public void performAction() {\n-        isSelected = !isSelected;\n-        putValue(SELECTED_KEY, isSelected);\n-        EditorTopComponent editor = EditorTopComponent.getActive();\n-        if (editor != null) {\n-            SwingUtilities.invokeLater(() -> editor.getModel().setGlobalSelection(isSelected));\n-        }\n-    }\n-\n-    public boolean isSelected() {\n-        return isSelected;\n-    }\n-\n-    private String getDescription() {\n-        return NbBundle.getMessage(GlobalSelectionAction.class, \"HINT_GlobalSelectionAction\");\n-    }\n-\n-    @Override\n-    protected boolean asynchronous() {\n-        return false;\n-    }\n-\n-    @Override\n-    public String iconResource() {\n-        return \"com\/sun\/hotspot\/igv\/view\/images\/chain.png\";\n-    }\n-}\n","filename":"src\/utils\/IdealGraphVisualizer\/View\/src\/main\/java\/com\/sun\/hotspot\/igv\/view\/actions\/GlobalSelectionAction.java","additions":0,"deletions":98,"binary":false,"changes":98,"status":"deleted"},{"patch":"@@ -59,1 +59,1 @@\n-        return NbBundle.getMessage(HideAction.class, \"CTL_HideAction\");\n+        return NbBundle.getMessage(NextDiagramAction.class, \"CTL_HideAction\");\n@@ -64,1 +64,1 @@\n-        return NbBundle.getMessage(HideAction.class, \"HINT_HideAction\");\n+        return NbBundle.getMessage(NextDiagramAction.class, \"HINT_HideAction\");\n","filename":"src\/utils\/IdealGraphVisualizer\/View\/src\/main\/java\/com\/sun\/hotspot\/igv\/view\/actions\/HideAction.java","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -57,1 +57,1 @@\n-        return NbBundle.getMessage(PrevDiagramAction.class, \"CTL_PrevDiagramAction\");\n+        return NbBundle.getMessage(NextDiagramAction.class, \"CTL_PrevDiagramAction\");\n@@ -62,1 +62,1 @@\n-        return NbBundle.getMessage(PrevDiagramAction.class, \"HINT_PrevDiagramAction\");\n+        return NbBundle.getMessage(NextDiagramAction.class, \"HINT_PrevDiagramAction\");\n","filename":"src\/utils\/IdealGraphVisualizer\/View\/src\/main\/java\/com\/sun\/hotspot\/igv\/view\/actions\/PrevDiagramAction.java","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -55,1 +55,1 @@\n-        return NbBundle.getMessage(ReduceDiffAction.class, \"HINT_ReduceDiffAction\");\n+        return NbBundle.getMessage(NextDiagramAction.class, \"HINT_ReduceDiffAction\");\n@@ -60,1 +60,1 @@\n-        return NbBundle.getMessage(ReduceDiffAction.class, \"CTL_ReduceDiffAction\");\n+        return NbBundle.getMessage(NextDiagramAction.class, \"CTL_ReduceDiffAction\");\n","filename":"src\/utils\/IdealGraphVisualizer\/View\/src\/main\/java\/com\/sun\/hotspot\/igv\/view\/actions\/ReduceDiffAction.java","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -58,1 +58,1 @@\n-        return NbBundle.getMessage(ShowAllAction.class, \"HINT_ShowAllAction\");\n+        return NbBundle.getMessage(NextDiagramAction.class, \"HINT_ShowAllAction\");\n@@ -63,1 +63,1 @@\n-        return NbBundle.getMessage(ShowAllAction.class, \"CTL_ShowAllAction\");\n+        return NbBundle.getMessage(NextDiagramAction.class, \"CTL_ShowAllAction\");\n","filename":"src\/utils\/IdealGraphVisualizer\/View\/src\/main\/java\/com\/sun\/hotspot\/igv\/view\/actions\/ShowAllAction.java","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -69,1 +69,1 @@\n-        return NbBundle.getMessage(ZoomInAction.class, \"CTL_ZoomInAction\");\n+        return NbBundle.getMessage(NextDiagramAction.class, \"CTL_ZoomInAction\");\n@@ -73,1 +73,1 @@\n-        return NbBundle.getMessage(ZoomInAction.class, \"HINT_ZoomInAction\");\n+        return NbBundle.getMessage(NextDiagramAction.class, \"HINT_ZoomInAction\");\n","filename":"src\/utils\/IdealGraphVisualizer\/View\/src\/main\/java\/com\/sun\/hotspot\/igv\/view\/actions\/ZoomInAction.java","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -68,1 +68,1 @@\n-        return NbBundle.getMessage(ZoomOutAction.class, \"CTL_ZoomOutAction\");\n+        return NbBundle.getMessage(NextDiagramAction.class, \"CTL_ZoomOutAction\");\n@@ -72,1 +72,1 @@\n-        return NbBundle.getMessage(ZoomOutAction.class, \"HINT_ZoomOutAction\");\n+        return NbBundle.getMessage(NextDiagramAction.class, \"HINT_ZoomOutAction\");\n","filename":"src\/utils\/IdealGraphVisualizer\/View\/src\/main\/java\/com\/sun\/hotspot\/igv\/view\/actions\/ZoomOutAction.java","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -44,2 +44,2 @@\n-        \"CTL_ZoomResetAction=Reset zoom (100%)\",\n-        \"HINT_ZoomResetAction=Reset the zoom level to 100%\"\n+        \"CTL_ZoomResetAction=Reset zoom (100%\",\n+        \"HINT_ZoomResetAction=Rest the zoom level to 100%\"\n@@ -64,1 +64,1 @@\n-        return NbBundle.getMessage(ZoomResetAction.class, \"CTL_ZoomResetAction\");\n+        return NbBundle.getMessage(NextDiagramAction.class, \"CTL_ZoomResetAction\");\n@@ -68,1 +68,1 @@\n-        return NbBundle.getMessage(ZoomResetAction.class, \"HINT_ZoomResetAction\");\n+        return NbBundle.getMessage(NextDiagramAction.class, \"HINT_ZoomResetAction\");\n","filename":"src\/utils\/IdealGraphVisualizer\/View\/src\/main\/java\/com\/sun\/hotspot\/igv\/view\/actions\/ZoomResetAction.java","additions":4,"deletions":4,"binary":false,"changes":8,"status":"modified"},{"patch":"@@ -86,1 +86,1 @@\n-            graphProvider.addSelectedNodes(blockWidget.blockNode.getNodes(), false);\n+            graphProvider.addSelectedNodes(blockWidget.blockNode.getNodes());\n","filename":"src\/utils\/IdealGraphVisualizer\/View\/src\/main\/java\/com\/sun\/hotspot\/igv\/view\/widgets\/BlockWidget.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -87,1 +87,1 @@\n-    public FigureWidget(final Figure f, DiagramScene scene) {\n+    public FigureWidget(final Figure f, DiagramScene scene, Widget parent) {\n@@ -96,0 +96,1 @@\n+        parent.addChild(this);\n","filename":"src\/utils\/IdealGraphVisualizer\/View\/src\/main\/java\/com\/sun\/hotspot\/igv\/view\/widgets\/FigureWidget.java","additions":2,"deletions":1,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -46,0 +46,1 @@\n+import org.netbeans.api.visual.animator.SceneAnimator;\n@@ -75,1 +76,1 @@\n-    public LineWidget(DiagramScene scene, OutputSlot s, List<Connection> connections, Point from, Point to, LineWidget predecessor, boolean isBold, boolean isDashed) {\n+    public LineWidget(DiagramScene scene, OutputSlot s, List<Connection> connections, Point from, Point to, LineWidget predecessor, SceneAnimator animator, boolean isBold, boolean isDashed) {\n@@ -119,1 +120,6 @@\n-        setBackground(color);\n+        if (animator == null) {\n+            this.setBackground(color);\n+        } else {\n+            this.setBackground(Color.WHITE);\n+            animator.animateBackgroundColor(this, color);\n+        }\n","filename":"src\/utils\/IdealGraphVisualizer\/View\/src\/main\/java\/com\/sun\/hotspot\/igv\/view\/widgets\/LineWidget.java","additions":8,"deletions":2,"binary":false,"changes":10,"status":"modified"},{"patch":"@@ -1,196 +0,0 @@\n-<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?>\n-<!--\n-\n-    Licensed to the Apache Software Foundation (ASF) under one\n-    or more contributor license agreements.  See the NOTICE file\n-    distributed with this work for additional information\n-    regarding copyright ownership.  The ASF licenses this file\n-    to you under the Apache License, Version 2.0 (the\n-    \"License\"); you may not use this file except in compliance\n-    with the License.  You may obtain a copy of the License at\n-\n-      http:\/\/www.apache.org\/licenses\/LICENSE-2.0\n-\n-    Unless required by applicable law or agreed to in writing,\n-    software distributed under the License is distributed on an\n-    \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n-    KIND, either express or implied.  See the License for the\n-    specific language governing permissions and limitations\n-    under the License.\n-\n--->\n-\n-<!-- Generator: Adobe Illustrator 23.0.1, SVG Export Plug-In . SVG Version: 6.00 Build 0)  -->\n-\n-<svg\n-   version=\"1.1\"\n-   id=\"Vector_Icons\"\n-   x=\"0px\"\n-   y=\"0px\"\n-   width=\"16px\"\n-   height=\"16px\"\n-   viewBox=\"0 0 16 16\"\n-   style=\"enable-background:new 0 0 16 16;\"\n-   xml:space=\"preserve\"\n-   sodipodi:docname=\"zoomIn copy.svg\"\n-   inkscape:version=\"1.2.1 (9c6d41e, 2022-07-14)\"\n-   xmlns:inkscape=\"http:\/\/www.inkscape.org\/namespaces\/inkscape\"\n-   xmlns:sodipodi=\"http:\/\/sodipodi.sourceforge.net\/DTD\/sodipodi-0.dtd\"\n-   xmlns=\"http:\/\/www.w3.org\/2000\/svg\"\n-   xmlns:svg=\"http:\/\/www.w3.org\/2000\/svg\"><defs\n-   id=\"defs30\" \/><sodipodi:namedview\n-   id=\"namedview28\"\n-   pagecolor=\"#ffffff\"\n-   bordercolor=\"#000000\"\n-   borderopacity=\"0.25\"\n-   inkscape:showpageshadow=\"2\"\n-   inkscape:pageopacity=\"0.0\"\n-   inkscape:pagecheckerboard=\"0\"\n-   inkscape:deskcolor=\"#d1d1d1\"\n-   showgrid=\"false\"\n-   inkscape:zoom=\"64.1875\"\n-   inkscape:cx=\"3.5598832\"\n-   inkscape:cy=\"9.4956183\"\n-   inkscape:window-width=\"2452\"\n-   inkscape:window-height=\"1205\"\n-   inkscape:window-x=\"2204\"\n-   inkscape:window-y=\"257\"\n-   inkscape:window-maximized=\"0\"\n-   inkscape:current-layer=\"Vector_Icons\" \/>\n-<style\n-   type=\"text\/css\"\n-   id=\"style9\">\n-\t.st0{fill:#FFFFFF;}\n-\t.st1{opacity:0.25;}\n-\t.st2{fill:#FAFAFA;}\n-\t.st3{opacity:0.33;}\n-\t.st4{fill:none;stroke:#474747;stroke-miterlimit:10;}\n-\t.st5{opacity:0.42;}\n-\t.st6{fill:#CAE3FF;}\n-\t.st7{opacity:0.2;}\n-\t.st8{opacity:0.03;}\n-\t.st9{opacity:0.1;}\n-\t.st10{opacity:0.15;}\n-\t.st11{opacity:0.45;}\n-\t.st12{fill:#FFE1B0;}\n-\t.st13{fill:#B3DBFF;}\n-\t.st14{fill:#FBDC7C;}\n-\t.st15{fill:#FFDB43;}\n-\t.st16{fill:#E79B00;}\n-\t.st17{fill:#3883CE;}\n-\t.st18{fill:none;stroke:#003399;stroke-width:1.375;stroke-miterlimit:10;}\n-\t.st19{fill:#E8513D;}\n-\t.st20{fill:#1E1E1E;}\n-\t.st21{fill:#FFC36D;}\n-\t.st22{fill:#9FCBFF;}\n-\t.st23{fill:#E9F7FF;}\n-\t.st24{fill:#62707C;}\n-\t.st25{fill:#7A8896;}\n-\t.st26{fill:#57BFFF;}\n-\t.st27{fill:#E69D35;}\n-\t.st28{fill:#9CFF73;}\n-\t.st29{fill:#4891CC;}\n-\t.st30{fill:#474747;}\n-\t.st31{fill:#CCA05E;}\n-\t.st32{opacity:0.67;}\n-\t.st33{opacity:0.3;}\n-\t.st34{fill:#EAEAEA;}\n-\t.st35{fill:#FFE945;}\n-\t.st36{fill:#FFCF8C;}\n-\t.st37{fill:#FF5252;}\n-\t.st38{opacity:0.12;}\n-\t.st39{fill:#45A5F4;}\n-\t.st40{fill:url(#SVGID_1_);}\n-\t.st41{fill:url(#SVGID_2_);}\n-\t.st42{opacity:0.05;}\n-\t.st43{fill:#3D81F5;}\n-\t.st44{fill:#CECECE;}\n-\t.st45{fill:#B5B5B5;}\n-\t.st46{opacity:0.4;}\n-\t.st47{fill:#595959;}\n-\t.st48{fill:#80FF80;}\n-\t.st49{fill:#C8FF80;}\n-\t.st50{fill:#FFEE80;}\n-\t.st51{fill:#FFA680;}\n-\t.st52{fill:#FF8080;}\n-\t.st53{fill:none;}\n-\t.st54{fill:#007AFF;}\n-\t.st55{fill:#EFFF78;}\n-\t.st56{fill:#FFDA00;}\n-\t.st57{fill:#3EADFF;}\n-\t.st58{opacity:0.67;fill:#FFFFFF;}\n-\t.st59{fill:#2E92FF;}\n-\t.st60{fill:#3AEA00;}\n-\t.st61{fill:#303030;}\n-<\/style>\n-\n-\n-\n-\n-<g\n-   id=\"g976\"><g\n-     id=\"g936\"><line\n-       class=\"st18\"\n-       x1=\"1.4835176\"\n-       y1=\"1.5341178\"\n-       x2=\"6.5766888\"\n-       y2=\"1.5341178\"\n-       id=\"line25\"\n-       style=\"fill:#000000;stroke:#000000;stroke-linecap:round;stroke-opacity:1\" \/><line\n-       class=\"st18\"\n-       x1=\"1.4800391\"\n-       y1=\"6.6342201\"\n-       x2=\"1.4800391\"\n-       y2=\"1.5410478\"\n-       id=\"line25-9\"\n-       style=\"fill:#000000;stroke:#000000;stroke-width:1.375;stroke-linecap:round;stroke-miterlimit:10;stroke-opacity:1\" \/><\/g><g\n-     id=\"g936-9\"\n-     transform=\"rotate(90,8.0582129,8.1116407)\"><line\n-       class=\"st18\"\n-       x1=\"1.4835176\"\n-       y1=\"1.5341178\"\n-       x2=\"6.5766888\"\n-       y2=\"1.5341178\"\n-       id=\"line25-7\"\n-       style=\"fill:#000000;stroke:#000000;stroke-width:1.375;stroke-linecap:round;stroke-miterlimit:10;stroke-opacity:1\" \/><line\n-       class=\"st18\"\n-       x1=\"1.4800391\"\n-       y1=\"6.6342201\"\n-       x2=\"1.4800391\"\n-       y2=\"1.5410478\"\n-       id=\"line25-9-0\"\n-       style=\"fill:#000000;stroke:#000000;stroke-width:1.375;stroke-linecap:round;stroke-miterlimit:10;stroke-opacity:1\" \/><\/g><\/g><g\n-   id=\"g976-9\"\n-   transform=\"rotate(180,8.0562076,8.1003438)\"><g\n-     id=\"g936-8\"><line\n-       class=\"st18\"\n-       x1=\"1.4835176\"\n-       y1=\"1.5341178\"\n-       x2=\"6.5766888\"\n-       y2=\"1.5341178\"\n-       id=\"line25-2\"\n-       style=\"fill:#000000;stroke:#000000;stroke-width:1.375;stroke-linecap:round;stroke-miterlimit:10;stroke-opacity:1\" \/><line\n-       class=\"st18\"\n-       x1=\"1.4800391\"\n-       y1=\"6.6342201\"\n-       x2=\"1.4800391\"\n-       y2=\"1.5410478\"\n-       id=\"line25-9-07\"\n-       style=\"fill:#000000;stroke:#000000;stroke-width:1.375;stroke-linecap:round;stroke-miterlimit:10;stroke-opacity:1\" \/><\/g><g\n-     id=\"g936-9-4\"\n-     transform=\"rotate(90,8.0582129,8.1116407)\"><line\n-       class=\"st18\"\n-       x1=\"1.4835176\"\n-       y1=\"1.5341178\"\n-       x2=\"6.5766888\"\n-       y2=\"1.5341178\"\n-       id=\"line25-7-8\"\n-       style=\"fill:#000000;stroke:#000000;stroke-width:1.375;stroke-linecap:round;stroke-miterlimit:10;stroke-opacity:1\" \/><line\n-       class=\"st18\"\n-       x1=\"1.4800391\"\n-       y1=\"6.6342201\"\n-       x2=\"1.4800391\"\n-       y2=\"1.5410478\"\n-       id=\"line25-9-0-5\"\n-       style=\"fill:#000000;stroke:#000000;stroke-width:1.375;stroke-linecap:round;stroke-miterlimit:10;stroke-opacity:1\" \/><\/g><\/g>\n-<\/svg>\n","filename":"src\/utils\/IdealGraphVisualizer\/View\/src\/main\/resources\/com\/sun\/hotspot\/igv\/view\/images\/centerSelectedNodes.svg","additions":0,"deletions":196,"binary":false,"changes":196,"status":"deleted"},{"filename":"src\/utils\/IdealGraphVisualizer\/View\/src\/main\/resources\/com\/sun\/hotspot\/igv\/view\/images\/chain.png","binary":true,"status":"deleted"},{"patch":"@@ -24,1 +24,1 @@\n-default_options=\"-J-Dnetbeans.exception.report.min.level=1000 -J--add-opens=java.base\/java.net=ALL-UNNAMED -J--add-opens=java.desktop\/javax.swing.plaf.synth=ALL-UNNAMED -J--add-opens=java.desktop\/com.sun.java.swing.plaf.gtk=ALL-UNNAMED -J--add-opens=java.desktop\/javax.swing=ALL-UNNAMED -J--add-exports=java.desktop\/sun.awt=ALL-UNNAMED\"\n+default_options=\"-J--add-opens=java.base\/java.net=ALL-UNNAMED -J--add-opens=java.desktop\/javax.swing.plaf.synth=ALL-UNNAMED -J--add-opens=java.desktop\/com.sun.java.swing.plaf.gtk=ALL-UNNAMED -J--add-opens=java.desktop\/javax.swing=ALL-UNNAMED -J--add-exports=java.desktop\/sun.awt=ALL-UNNAMED\"\n\\ No newline at end of file\n","filename":"src\/utils\/IdealGraphVisualizer\/application\/src\/main\/resources\/idealgraphvisualizer.conf","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -960,3 +960,1 @@\n-        if (self._name in [\"fcvtsh\", \"fcvths\"]):\n-            return self._name[:len(self._name)-2]\n-        elif (self._name.endswith(\"s\") | self._name.endswith(\"d\")):\n+        if (self._name.endswith(\"s\") | self._name.endswith(\"d\")):\n@@ -1017,2 +1015,0 @@\n-        elif name == \"revb\":\n-            self._width = RegVariant(1, 3)\n@@ -1465,1 +1461,1 @@\n-          [\"fcvts\", \"ds\"], [\"fcvtsh\", \"hs\"], [\"fcvths\", \"sh\"],\n+          [\"fcvts\", \"ds\"],\n","filename":"test\/hotspot\/gtest\/aarch64\/aarch64-asmtest.py","additions":2,"deletions":6,"binary":false,"changes":8,"status":"modified"},{"patch":"@@ -496,7 +496,5 @@\n-    __ fcvtsh(v6, v15);                                \/\/       fcvt    h6, s15\n-    __ fcvths(v3, v3);                                 \/\/       fcvt    s3, h3\n-    __ fmovd(v28, v3);                                 \/\/       fmov    d28, d3\n-    __ fabsd(v27, v14);                                \/\/       fabs    d27, d14\n-    __ fnegd(v14, v10);                                \/\/       fneg    d14, d10\n-    __ fsqrtd(v12, v11);                               \/\/       fsqrt   d12, d11\n-    __ fcvtd(v17, v10);                                \/\/       fcvt    s17, d10\n+    __ fmovd(v6, v15);                                 \/\/       fmov    d6, d15\n+    __ fabsd(v3, v3);                                  \/\/       fabs    d3, d3\n+    __ fnegd(v28, v3);                                 \/\/       fneg    d28, d3\n+    __ fsqrtd(v27, v14);                               \/\/       fsqrt   d27, d14\n+    __ fcvtd(v14, v10);                                \/\/       fcvt    s14, d10\n@@ -505,16 +503,16 @@\n-    __ fcvtzsw(r25, v7);                               \/\/       fcvtzs  w25, s7\n-    __ fcvtzs(r7, v14);                                \/\/       fcvtzs  x7, s14\n-    __ fcvtzdw(r28, v0);                               \/\/       fcvtzs  w28, d0\n-    __ fcvtzd(r22, v0);                                \/\/       fcvtzs  x22, d0\n-    __ scvtfws(v12, r23);                              \/\/       scvtf   s12, w23\n-    __ scvtfs(v13, r13);                               \/\/       scvtf   s13, x13\n-    __ scvtfwd(v7, r14);                               \/\/       scvtf   d7, w14\n-    __ scvtfd(v7, r8);                                 \/\/       scvtf   d7, x8\n-    __ fcvtassw(r20, v17);                             \/\/       fcvtas  w20, s17\n-    __ fcvtasd(r28, v30);                              \/\/       fcvtas  x28, d30\n-    __ fcvtmssw(r16, v2);                              \/\/       fcvtms  w16, s2\n-    __ fcvtmsd(r9, v16);                               \/\/       fcvtms  x9, d16\n-    __ fmovs(r20, v29);                                \/\/       fmov    w20, s29\n-    __ fmovd(r4, v1);                                  \/\/       fmov    x4, d1\n-    __ fmovs(v26, r24);                                \/\/       fmov    s26, w24\n-    __ fmovd(v23, r14);                                \/\/       fmov    d23, x14\n+    __ fcvtzsw(r12, v11);                              \/\/       fcvtzs  w12, s11\n+    __ fcvtzs(r17, v10);                               \/\/       fcvtzs  x17, s10\n+    __ fcvtzdw(r25, v7);                               \/\/       fcvtzs  w25, d7\n+    __ fcvtzd(r7, v14);                                \/\/       fcvtzs  x7, d14\n+    __ scvtfws(v28, r0);                               \/\/       scvtf   s28, w0\n+    __ scvtfs(v22, r0);                                \/\/       scvtf   s22, x0\n+    __ scvtfwd(v12, r23);                              \/\/       scvtf   d12, w23\n+    __ scvtfd(v13, r13);                               \/\/       scvtf   d13, x13\n+    __ fcvtassw(r7, v14);                              \/\/       fcvtas  w7, s14\n+    __ fcvtasd(r7, v8);                                \/\/       fcvtas  x7, d8\n+    __ fcvtmssw(r20, v17);                             \/\/       fcvtms  w20, s17\n+    __ fcvtmsd(r28, v30);                              \/\/       fcvtms  x28, d30\n+    __ fmovs(r16, v2);                                 \/\/       fmov    w16, s2\n+    __ fmovd(r9, v16);                                 \/\/       fmov    x9, d16\n+    __ fmovs(v20, r29);                                \/\/       fmov    s20, w29\n+    __ fmovd(v4, r1);                                  \/\/       fmov    d4, x1\n@@ -523,4 +521,4 @@\n-    __ fcmps(v21, v12);                                \/\/       fcmp    s21, s12\n-    __ fcmpd(v5, v12);                                 \/\/       fcmp    d5, d12\n-    __ fcmps(v24, 0.0);                                \/\/       fcmp    s24, #0.0\n-    __ fcmpd(v24, 0.0);                                \/\/       fcmp    d24, #0.0\n+    __ fcmps(v26, v24);                                \/\/       fcmp    s26, s24\n+    __ fcmpd(v23, v14);                                \/\/       fcmp    d23, d14\n+    __ fcmps(v21, 0.0);                                \/\/       fcmp    s21, #0.0\n+    __ fcmpd(v12, 0.0);                                \/\/       fcmp    d12, #0.0\n@@ -529,5 +527,5 @@\n-    __ stpw(r27, r21, Address(r16, 128));              \/\/       stp     w27, w21, [x16, #128]\n-    __ ldpw(r17, r13, Address(r22, 32));               \/\/       ldp     w17, w13, [x22, #32]\n-    __ ldpsw(r6, r13, Address(r17, -16));              \/\/       ldpsw   x6, x13, [x17, #-16]\n-    __ stp(r28, r26, Address(r17, -160));              \/\/       stp     x28, x26, [x17, #-160]\n-    __ ldp(r21, r6, Address(r13, -192));               \/\/       ldp     x21, x6, [x13, #-192]\n+    __ stpw(r12, r24, Address(r24, -192));             \/\/       stp     w12, w24, [x24, #-192]\n+    __ ldpw(r22, r5, Address(r16, 128));               \/\/       ldp     w22, w5, [x16, #128]\n+    __ ldpsw(r20, r19, Address(r13, 112));             \/\/       ldpsw   x20, x19, [x13, #112]\n+    __ stp(r17, r6, Address(r13, 96));                 \/\/       stp     x17, x6, [x13, #96]\n+    __ ldp(r5, r1, Address(r17, -160));                \/\/       ldp     x5, x1, [x17, #-160]\n@@ -536,5 +534,5 @@\n-    __ stpw(r26, r23, Address(__ pre(r19, 16)));       \/\/       stp     w26, w23, [x19, #16]!\n-    __ ldpw(r4, r16, Address(__ pre(r10, 128)));       \/\/       ldp     w4, w16, [x10, #128]!\n-    __ ldpsw(r14, r4, Address(__ pre(r23, -96)));      \/\/       ldpsw   x14, x4, [x23, #-96]!\n-    __ stp(r29, r12, Address(__ pre(r16, 32)));        \/\/       stp     x29, x12, [x16, #32]!\n-    __ ldp(r26, r17, Address(__ pre(r27, 96)));        \/\/       ldp     x26, x17, [x27, #96]!\n+    __ stpw(r13, r20, Address(__ pre(r22, -208)));     \/\/       stp     w13, w20, [x22, #-208]!\n+    __ ldpw(r30, r27, Address(__ pre(r10, 80)));       \/\/       ldp     w30, w27, [x10, #80]!\n+    __ ldpsw(r13, r20, Address(__ pre(r26, 16)));      \/\/       ldpsw   x13, x20, [x26, #16]!\n+    __ stp(r4, r23, Address(__ pre(r29, -80)));        \/\/       stp     x4, x23, [x29, #-80]!\n+    __ ldp(r22, r0, Address(__ pre(r6, -112)));        \/\/       ldp     x22, x0, [x6, #-112]!\n@@ -543,5 +541,5 @@\n-    __ stpw(r6, r0, Address(__ post(r4, -96)));        \/\/       stp     w6, w0, [x4], #-96\n-    __ ldpw(r2, r30, Address(__ post(r14, 0)));        \/\/       ldp     w2, w30, [x14], #0\n-    __ ldpsw(r23, r24, Address(__ post(r7, -256)));    \/\/       ldpsw   x23, x24, [x7], #-256\n-    __ stp(r0, r26, Address(__ post(r5, 128)));        \/\/       stp     x0, x26, [x5], #128\n-    __ ldp(r6, r11, Address(__ post(r15, -160)));      \/\/       ldp     x6, x11, [x15], #-160\n+    __ stpw(r17, r27, Address(__ post(r5, 80)));       \/\/       stp     w17, w27, [x5], #80\n+    __ ldpw(r14, r11, Address(__ post(r16, -256)));    \/\/       ldp     w14, w11, [x16], #-256\n+    __ ldpsw(r12, r23, Address(__ post(r9, -240)));    \/\/       ldpsw   x12, x23, [x9], #-240\n+    __ stp(r23, r7, Address(__ post(r0, 32)));         \/\/       stp     x23, x7, [x0], #32\n+    __ ldp(r17, r8, Address(__ post(r26, 80)));        \/\/       ldp     x17, x8, [x26], #80\n@@ -550,4 +548,4 @@\n-    __ stnpw(r25, r8, Address(r2, -128));              \/\/       stnp    w25, w8, [x2, #-128]\n-    __ ldnpw(r30, r14, Address(r1, -208));             \/\/       ldnp    w30, w14, [x1, #-208]\n-    __ stnp(r22, r0, Address(r13, -144));              \/\/       stnp    x22, x0, [x13, #-144]\n-    __ ldnp(r3, r12, Address(r27, 0));                 \/\/       ldnp    x3, x12, [x27, #0]\n+    __ stnpw(r11, r15, Address(r10, -176));            \/\/       stnp    w11, w15, [x10, #-176]\n+    __ ldnpw(r19, r16, Address(r4, 64));               \/\/       ldnp    w19, w16, [x4, #64]\n+    __ stnp(r30, r14, Address(r9, -240));              \/\/       stnp    x30, x14, [x9, #-240]\n+    __ ldnp(r29, r23, Address(r20, 32));               \/\/       ldnp    x29, x23, [x20, #32]\n@@ -556,22 +554,22 @@\n-    __ ld1(v10, __ T8B, Address(r0));                  \/\/       ld1     {v10.8B}, [x0]\n-    __ ld1(v12, v13, __ T16B, Address(__ post(r17, 32))); \/\/    ld1     {v12.16B, v13.16B}, [x17], 32\n-    __ ld1(v10, v11, v12, __ T1D, Address(__ post(r24, r2))); \/\/        ld1     {v10.1D, v11.1D, v12.1D}, [x24], x2\n-    __ ld1(v8, v9, v10, v11, __ T8H, Address(__ post(r17, 64))); \/\/     ld1     {v8.8H, v9.8H, v10.8H, v11.8H}, [x17], 64\n-    __ ld1r(v23, __ T8B, Address(r30));                \/\/       ld1r    {v23.8B}, [x30]\n-    __ ld1r(v22, __ T4S, Address(__ post(r2, 4)));     \/\/       ld1r    {v22.4S}, [x2], 4\n-    __ ld1r(v30, __ T1D, Address(__ post(r30, r15)));  \/\/       ld1r    {v30.1D}, [x30], x15\n-    __ ld2(v20, v21, __ T2D, Address(r5));             \/\/       ld2     {v20.2D, v21.2D}, [x5]\n-    __ ld2(v24, v25, __ T4H, Address(__ post(r9, 16))); \/\/      ld2     {v24.4H, v25.4H}, [x9], 16\n-    __ ld2r(v16, v17, __ T16B, Address(r12));          \/\/       ld2r    {v16.16B, v17.16B}, [x12]\n-    __ ld2r(v23, v24, __ T2S, Address(__ post(r7, 8))); \/\/      ld2r    {v23.2S, v24.2S}, [x7], 8\n-    __ ld2r(v26, v27, __ T2D, Address(__ post(r16, r3))); \/\/    ld2r    {v26.2D, v27.2D}, [x16], x3\n-    __ ld3(v25, v26, v27, __ T4S, Address(__ post(r11, r7))); \/\/        ld3     {v25.4S, v26.4S, v27.4S}, [x11], x7\n-    __ ld3(v30, v31, v0, __ T2S, Address(r12));        \/\/       ld3     {v30.2S, v31.2S, v0.2S}, [x12]\n-    __ ld3r(v15, v16, v17, __ T8H, Address(r9));       \/\/       ld3r    {v15.8H, v16.8H, v17.8H}, [x9]\n-    __ ld3r(v30, v31, v0, __ T4S, Address(__ post(r6, 12))); \/\/ ld3r    {v30.4S, v31.4S, v0.4S}, [x6], 12\n-    __ ld3r(v7, v8, v9, __ T1D, Address(__ post(r23, r13))); \/\/ ld3r    {v7.1D, v8.1D, v9.1D}, [x23], x13\n-    __ ld4(v4, v5, v6, v7, __ T8H, Address(__ post(r6, 64))); \/\/        ld4     {v4.8H, v5.8H, v6.8H, v7.8H}, [x6], 64\n-    __ ld4(v4, v5, v6, v7, __ T8B, Address(__ post(r19, r15))); \/\/      ld4     {v4.8B, v5.8B, v6.8B, v7.8B}, [x19], x15\n-    __ ld4r(v25, v26, v27, v28, __ T8B, Address(r14)); \/\/       ld4r    {v25.8B, v26.8B, v27.8B, v28.8B}, [x14]\n-    __ ld4r(v26, v27, v28, v29, __ T4H, Address(__ post(r28, 8))); \/\/   ld4r    {v26.4H, v27.4H, v28.4H, v29.4H}, [x28], 8\n-    __ ld4r(v25, v26, v27, v28, __ T2S, Address(__ post(r5, r6))); \/\/   ld4r    {v25.2S, v26.2S, v27.2S, v28.2S}, [x5], x6\n+    __ ld1(v5, __ T8B, Address(r27));                  \/\/       ld1     {v5.8B}, [x27]\n+    __ ld1(v10, v11, __ T16B, Address(__ post(r25, 32))); \/\/    ld1     {v10.16B, v11.16B}, [x25], 32\n+    __ ld1(v15, v16, v17, __ T1D, Address(__ post(r30, r19))); \/\/       ld1     {v15.1D, v16.1D, v17.1D}, [x30], x19\n+    __ ld1(v17, v18, v19, v20, __ T8H, Address(__ post(r16, 64))); \/\/   ld1     {v17.8H, v18.8H, v19.8H, v20.8H}, [x16], 64\n+    __ ld1r(v30, __ T8B, Address(r23));                \/\/       ld1r    {v30.8B}, [x23]\n+    __ ld1r(v17, __ T4S, Address(__ post(r8, 4)));     \/\/       ld1r    {v17.4S}, [x8], 4\n+    __ ld1r(v12, __ T1D, Address(__ post(r9, r3)));    \/\/       ld1r    {v12.1D}, [x9], x3\n+    __ ld2(v19, v20, __ T2D, Address(r2));             \/\/       ld2     {v19.2D, v20.2D}, [x2]\n+    __ ld2(v21, v22, __ T4H, Address(__ post(r8, 16))); \/\/      ld2     {v21.4H, v22.4H}, [x8], 16\n+    __ ld2r(v13, v14, __ T16B, Address(r4));           \/\/       ld2r    {v13.16B, v14.16B}, [x4]\n+    __ ld2r(v28, v29, __ T2S, Address(__ post(r3, 8))); \/\/      ld2r    {v28.2S, v29.2S}, [x3], 8\n+    __ ld2r(v29, v30, __ T2D, Address(__ post(r29, r0))); \/\/    ld2r    {v29.2D, v30.2D}, [x29], x0\n+    __ ld3(v7, v8, v9, __ T4S, Address(__ post(r1, r21))); \/\/   ld3     {v7.4S, v8.4S, v9.4S}, [x1], x21\n+    __ ld3(v17, v18, v19, __ T2S, Address(r0));        \/\/       ld3     {v17.2S, v18.2S, v19.2S}, [x0]\n+    __ ld3r(v26, v27, v28, __ T8H, Address(r5));       \/\/       ld3r    {v26.8H, v27.8H, v28.8H}, [x5]\n+    __ ld3r(v25, v26, v27, __ T4S, Address(__ post(r1, 12))); \/\/        ld3r    {v25.4S, v26.4S, v27.4S}, [x1], 12\n+    __ ld3r(v22, v23, v24, __ T1D, Address(__ post(r2, r29))); \/\/       ld3r    {v22.1D, v23.1D, v24.1D}, [x2], x29\n+    __ ld4(v13, v14, v15, v16, __ T8H, Address(__ post(r27, 64))); \/\/   ld4     {v13.8H, v14.8H, v15.8H, v16.8H}, [x27], 64\n+    __ ld4(v29, v30, v31, v0, __ T8B, Address(__ post(r24, r23))); \/\/   ld4     {v29.8B, v30.8B, v31.8B, v0.8B}, [x24], x23\n+    __ ld4r(v13, v14, v15, v16, __ T8B, Address(r15)); \/\/       ld4r    {v13.8B, v14.8B, v15.8B, v16.8B}, [x15]\n+    __ ld4r(v15, v16, v17, v18, __ T4H, Address(__ post(r14, 8))); \/\/   ld4r    {v15.4H, v16.4H, v17.4H, v18.4H}, [x14], 8\n+    __ ld4r(v27, v28, v29, v30, __ T2S, Address(__ post(r20, r23))); \/\/ ld4r    {v27.2S, v28.2S, v29.2S, v30.2S}, [x20], x23\n@@ -580,3 +578,3 @@\n-    __ addv(v14, __ T8B, v15);                         \/\/       addv    b14, v15.8B\n-    __ addv(v10, __ T16B, v11);                        \/\/       addv    b10, v11.16B\n-    __ addv(v13, __ T4H, v14);                         \/\/       addv    h13, v14.4H\n+    __ addv(v24, __ T8B, v25);                         \/\/       addv    b24, v25.8B\n+    __ addv(v15, __ T16B, v16);                        \/\/       addv    b15, v16.16B\n+    __ addv(v25, __ T4H, v26);                         \/\/       addv    h25, v26.4H\n@@ -584,15 +582,15 @@\n-    __ addv(v20, __ T4S, v21);                         \/\/       addv    s20, v21.4S\n-    __ smaxv(v1, __ T8B, v2);                          \/\/       smaxv   b1, v2.8B\n-    __ smaxv(v22, __ T16B, v23);                       \/\/       smaxv   b22, v23.16B\n-    __ smaxv(v30, __ T4H, v31);                        \/\/       smaxv   h30, v31.4H\n-    __ smaxv(v14, __ T8H, v15);                        \/\/       smaxv   h14, v15.8H\n-    __ smaxv(v2, __ T4S, v3);                          \/\/       smaxv   s2, v3.4S\n-    __ fmaxv(v6, __ T4S, v7);                          \/\/       fmaxv   s6, v7.4S\n-    __ sminv(v3, __ T8B, v4);                          \/\/       sminv   b3, v4.8B\n-    __ uminv(v7, __ T8B, v8);                          \/\/       uminv   b7, v8.8B\n-    __ sminv(v24, __ T16B, v25);                       \/\/       sminv   b24, v25.16B\n-    __ uminv(v0, __ T16B, v1);                         \/\/       uminv   b0, v1.16B\n-    __ sminv(v27, __ T4H, v28);                        \/\/       sminv   h27, v28.4H\n-    __ uminv(v29, __ T4H, v30);                        \/\/       uminv   h29, v30.4H\n-    __ sminv(v5, __ T8H, v6);                          \/\/       sminv   h5, v6.8H\n-    __ uminv(v5, __ T8H, v6);                          \/\/       uminv   h5, v6.8H\n+    __ addv(v10, __ T4S, v11);                         \/\/       addv    s10, v11.4S\n+    __ smaxv(v13, __ T8B, v14);                        \/\/       smaxv   b13, v14.8B\n+    __ smaxv(v14, __ T16B, v15);                       \/\/       smaxv   b14, v15.16B\n+    __ smaxv(v20, __ T4H, v21);                        \/\/       smaxv   h20, v21.4H\n+    __ smaxv(v1, __ T8H, v2);                          \/\/       smaxv   h1, v2.8H\n+    __ smaxv(v22, __ T4S, v23);                        \/\/       smaxv   s22, v23.4S\n+    __ fmaxv(v30, __ T4S, v31);                        \/\/       fmaxv   s30, v31.4S\n+    __ sminv(v14, __ T8B, v15);                        \/\/       sminv   b14, v15.8B\n+    __ uminv(v2, __ T8B, v3);                          \/\/       uminv   b2, v3.8B\n+    __ sminv(v6, __ T16B, v7);                         \/\/       sminv   b6, v7.16B\n+    __ uminv(v3, __ T16B, v4);                         \/\/       uminv   b3, v4.16B\n+    __ sminv(v7, __ T4H, v8);                          \/\/       sminv   h7, v8.4H\n+    __ uminv(v24, __ T4H, v25);                        \/\/       uminv   h24, v25.4H\n+    __ sminv(v0, __ T8H, v1);                          \/\/       sminv   h0, v1.8H\n+    __ uminv(v27, __ T8H, v28);                        \/\/       uminv   h27, v28.8H\n@@ -600,6 +598,6 @@\n-    __ uminv(v11, __ T4S, v12);                        \/\/       uminv   s11, v12.4S\n-    __ fminv(v25, __ T4S, v26);                        \/\/       fminv   s25, v26.4S\n-    __ fmaxp(v0, v1, __ S);                            \/\/       fmaxp   s0, v1.2S\n-    __ fmaxp(v30, v31, __ D);                          \/\/       fmaxp   d30, v31.2D\n-    __ fminp(v0, v1, __ S);                            \/\/       fminp   s0, v1.2S\n-    __ fminp(v17, v18, __ D);                          \/\/       fminp   d17, v18.2D\n+    __ uminv(v5, __ T4S, v6);                          \/\/       uminv   s5, v6.4S\n+    __ fminv(v5, __ T4S, v6);                          \/\/       fminv   s5, v6.4S\n+    __ fmaxp(v29, v30, __ S);                          \/\/       fmaxp   s29, v30.2S\n+    __ fmaxp(v11, v12, __ D);                          \/\/       fmaxp   d11, v12.2D\n+    __ fminp(v25, v26, __ S);                          \/\/       fminp   s25, v26.2S\n+    __ fminp(v0, v1, __ D);                            \/\/       fminp   d0, v1.2D\n@@ -608,18 +606,18 @@\n-    __ absr(v28, __ T8B, v29);                         \/\/       abs     v28.8B, v29.8B\n-    __ absr(v25, __ T16B, v26);                        \/\/       abs     v25.16B, v26.16B\n-    __ absr(v9, __ T4H, v10);                          \/\/       abs     v9.4H, v10.4H\n-    __ absr(v25, __ T8H, v26);                         \/\/       abs     v25.8H, v26.8H\n-    __ absr(v12, __ T2S, v13);                         \/\/       abs     v12.2S, v13.2S\n-    __ absr(v15, __ T4S, v16);                         \/\/       abs     v15.4S, v16.4S\n-    __ absr(v11, __ T2D, v12);                         \/\/       abs     v11.2D, v12.2D\n-    __ fabs(v10, __ T2S, v11);                         \/\/       fabs    v10.2S, v11.2S\n-    __ fabs(v17, __ T4S, v18);                         \/\/       fabs    v17.4S, v18.4S\n-    __ fabs(v24, __ T2D, v25);                         \/\/       fabs    v24.2D, v25.2D\n-    __ fneg(v21, __ T2S, v22);                         \/\/       fneg    v21.2S, v22.2S\n-    __ fneg(v23, __ T4S, v24);                         \/\/       fneg    v23.4S, v24.4S\n-    __ fneg(v0, __ T2D, v1);                           \/\/       fneg    v0.2D, v1.2D\n-    __ fsqrt(v16, __ T2S, v17);                        \/\/       fsqrt   v16.2S, v17.2S\n-    __ fsqrt(v10, __ T4S, v11);                        \/\/       fsqrt   v10.4S, v11.4S\n-    __ fsqrt(v6, __ T2D, v7);                          \/\/       fsqrt   v6.2D, v7.2D\n-    __ notr(v28, __ T8B, v29);                         \/\/       not     v28.8B, v29.8B\n-    __ notr(v6, __ T16B, v7);                          \/\/       not     v6.16B, v7.16B\n+    __ absr(v30, __ T8B, v31);                         \/\/       abs     v30.8B, v31.8B\n+    __ absr(v0, __ T16B, v1);                          \/\/       abs     v0.16B, v1.16B\n+    __ absr(v17, __ T4H, v18);                         \/\/       abs     v17.4H, v18.4H\n+    __ absr(v28, __ T8H, v29);                         \/\/       abs     v28.8H, v29.8H\n+    __ absr(v25, __ T2S, v26);                         \/\/       abs     v25.2S, v26.2S\n+    __ absr(v9, __ T4S, v10);                          \/\/       abs     v9.4S, v10.4S\n+    __ absr(v25, __ T2D, v26);                         \/\/       abs     v25.2D, v26.2D\n+    __ fabs(v12, __ T2S, v13);                         \/\/       fabs    v12.2S, v13.2S\n+    __ fabs(v15, __ T4S, v16);                         \/\/       fabs    v15.4S, v16.4S\n+    __ fabs(v11, __ T2D, v12);                         \/\/       fabs    v11.2D, v12.2D\n+    __ fneg(v10, __ T2S, v11);                         \/\/       fneg    v10.2S, v11.2S\n+    __ fneg(v17, __ T4S, v18);                         \/\/       fneg    v17.4S, v18.4S\n+    __ fneg(v24, __ T2D, v25);                         \/\/       fneg    v24.2D, v25.2D\n+    __ fsqrt(v21, __ T2S, v22);                        \/\/       fsqrt   v21.2S, v22.2S\n+    __ fsqrt(v23, __ T4S, v24);                        \/\/       fsqrt   v23.4S, v24.4S\n+    __ fsqrt(v0, __ T2D, v1);                          \/\/       fsqrt   v0.2D, v1.2D\n+    __ notr(v16, __ T8B, v17);                         \/\/       not     v16.8B, v17.8B\n+    __ notr(v10, __ T16B, v11);                        \/\/       not     v10.16B, v11.16B\n@@ -628,26 +626,26 @@\n-    __ andr(v5, __ T8B, v6, v7);                       \/\/       and     v5.8B, v6.8B, v7.8B\n-    __ andr(v5, __ T16B, v6, v7);                      \/\/       and     v5.16B, v6.16B, v7.16B\n-    __ orr(v20, __ T8B, v21, v22);                     \/\/       orr     v20.8B, v21.8B, v22.8B\n-    __ orr(v17, __ T16B, v18, v19);                    \/\/       orr     v17.16B, v18.16B, v19.16B\n-    __ eor(v15, __ T8B, v16, v17);                     \/\/       eor     v15.8B, v16.8B, v17.8B\n-    __ eor(v17, __ T16B, v18, v19);                    \/\/       eor     v17.16B, v18.16B, v19.16B\n-    __ addv(v29, __ T8B, v30, v31);                    \/\/       add     v29.8B, v30.8B, v31.8B\n-    __ addv(v26, __ T16B, v27, v28);                   \/\/       add     v26.16B, v27.16B, v28.16B\n-    __ addv(v28, __ T4H, v29, v30);                    \/\/       add     v28.4H, v29.4H, v30.4H\n-    __ addv(v1, __ T8H, v2, v3);                       \/\/       add     v1.8H, v2.8H, v3.8H\n-    __ addv(v27, __ T2S, v28, v29);                    \/\/       add     v27.2S, v28.2S, v29.2S\n-    __ addv(v0, __ T4S, v1, v2);                       \/\/       add     v0.4S, v1.4S, v2.4S\n-    __ addv(v20, __ T2D, v21, v22);                    \/\/       add     v20.2D, v21.2D, v22.2D\n-    __ fadd(v28, __ T2S, v29, v30);                    \/\/       fadd    v28.2S, v29.2S, v30.2S\n-    __ fadd(v15, __ T4S, v16, v17);                    \/\/       fadd    v15.4S, v16.4S, v17.4S\n-    __ fadd(v12, __ T2D, v13, v14);                    \/\/       fadd    v12.2D, v13.2D, v14.2D\n-    __ subv(v10, __ T8B, v11, v12);                    \/\/       sub     v10.8B, v11.8B, v12.8B\n-    __ subv(v28, __ T16B, v29, v30);                   \/\/       sub     v28.16B, v29.16B, v30.16B\n-    __ subv(v28, __ T4H, v29, v30);                    \/\/       sub     v28.4H, v29.4H, v30.4H\n-    __ subv(v19, __ T8H, v20, v21);                    \/\/       sub     v19.8H, v20.8H, v21.8H\n-    __ subv(v22, __ T2S, v23, v24);                    \/\/       sub     v22.2S, v23.2S, v24.2S\n-    __ subv(v10, __ T4S, v11, v12);                    \/\/       sub     v10.4S, v11.4S, v12.4S\n-    __ subv(v4, __ T2D, v5, v6);                       \/\/       sub     v4.2D, v5.2D, v6.2D\n-    __ fsub(v30, __ T2S, v31, v0);                     \/\/       fsub    v30.2S, v31.2S, v0.2S\n-    __ fsub(v20, __ T4S, v21, v22);                    \/\/       fsub    v20.4S, v21.4S, v22.4S\n-    __ fsub(v8, __ T2D, v9, v10);                      \/\/       fsub    v8.2D, v9.2D, v10.2D\n+    __ andr(v6, __ T8B, v7, v8);                       \/\/       and     v6.8B, v7.8B, v8.8B\n+    __ andr(v28, __ T16B, v29, v30);                   \/\/       and     v28.16B, v29.16B, v30.16B\n+    __ orr(v6, __ T8B, v7, v8);                        \/\/       orr     v6.8B, v7.8B, v8.8B\n+    __ orr(v5, __ T16B, v6, v7);                       \/\/       orr     v5.16B, v6.16B, v7.16B\n+    __ eor(v5, __ T8B, v6, v7);                        \/\/       eor     v5.8B, v6.8B, v7.8B\n+    __ eor(v20, __ T16B, v21, v22);                    \/\/       eor     v20.16B, v21.16B, v22.16B\n+    __ addv(v17, __ T8B, v18, v19);                    \/\/       add     v17.8B, v18.8B, v19.8B\n+    __ addv(v15, __ T16B, v16, v17);                   \/\/       add     v15.16B, v16.16B, v17.16B\n+    __ addv(v17, __ T4H, v18, v19);                    \/\/       add     v17.4H, v18.4H, v19.4H\n+    __ addv(v29, __ T8H, v30, v31);                    \/\/       add     v29.8H, v30.8H, v31.8H\n+    __ addv(v26, __ T2S, v27, v28);                    \/\/       add     v26.2S, v27.2S, v28.2S\n+    __ addv(v28, __ T4S, v29, v30);                    \/\/       add     v28.4S, v29.4S, v30.4S\n+    __ addv(v1, __ T2D, v2, v3);                       \/\/       add     v1.2D, v2.2D, v3.2D\n+    __ fadd(v27, __ T2S, v28, v29);                    \/\/       fadd    v27.2S, v28.2S, v29.2S\n+    __ fadd(v0, __ T4S, v1, v2);                       \/\/       fadd    v0.4S, v1.4S, v2.4S\n+    __ fadd(v20, __ T2D, v21, v22);                    \/\/       fadd    v20.2D, v21.2D, v22.2D\n+    __ subv(v28, __ T8B, v29, v30);                    \/\/       sub     v28.8B, v29.8B, v30.8B\n+    __ subv(v15, __ T16B, v16, v17);                   \/\/       sub     v15.16B, v16.16B, v17.16B\n+    __ subv(v12, __ T4H, v13, v14);                    \/\/       sub     v12.4H, v13.4H, v14.4H\n+    __ subv(v10, __ T8H, v11, v12);                    \/\/       sub     v10.8H, v11.8H, v12.8H\n+    __ subv(v28, __ T2S, v29, v30);                    \/\/       sub     v28.2S, v29.2S, v30.2S\n+    __ subv(v28, __ T4S, v29, v30);                    \/\/       sub     v28.4S, v29.4S, v30.4S\n+    __ subv(v19, __ T2D, v20, v21);                    \/\/       sub     v19.2D, v20.2D, v21.2D\n+    __ fsub(v22, __ T2S, v23, v24);                    \/\/       fsub    v22.2S, v23.2S, v24.2S\n+    __ fsub(v10, __ T4S, v11, v12);                    \/\/       fsub    v10.4S, v11.4S, v12.4S\n+    __ fsub(v4, __ T2D, v5, v6);                       \/\/       fsub    v4.2D, v5.2D, v6.2D\n@@ -655,53 +653,53 @@\n-    __ mulv(v17, __ T16B, v18, v19);                   \/\/       mul     v17.16B, v18.16B, v19.16B\n-    __ mulv(v10, __ T4H, v11, v12);                    \/\/       mul     v10.4H, v11.4H, v12.4H\n-    __ mulv(v27, __ T8H, v28, v29);                    \/\/       mul     v27.8H, v28.8H, v29.8H\n-    __ mulv(v2, __ T2S, v3, v4);                       \/\/       mul     v2.2S, v3.2S, v4.2S\n-    __ mulv(v24, __ T4S, v25, v26);                    \/\/       mul     v24.4S, v25.4S, v26.4S\n-    __ fabd(v4, __ T2S, v5, v6);                       \/\/       fabd    v4.2S, v5.2S, v6.2S\n-    __ fabd(v3, __ T4S, v4, v5);                       \/\/       fabd    v3.4S, v4.4S, v5.4S\n-    __ fabd(v8, __ T2D, v9, v10);                      \/\/       fabd    v8.2D, v9.2D, v10.2D\n-    __ fmul(v22, __ T2S, v23, v24);                    \/\/       fmul    v22.2S, v23.2S, v24.2S\n-    __ fmul(v17, __ T4S, v18, v19);                    \/\/       fmul    v17.4S, v18.4S, v19.4S\n-    __ fmul(v13, __ T2D, v14, v15);                    \/\/       fmul    v13.2D, v14.2D, v15.2D\n-    __ mlav(v4, __ T4H, v5, v6);                       \/\/       mla     v4.4H, v5.4H, v6.4H\n-    __ mlav(v28, __ T8H, v29, v30);                    \/\/       mla     v28.8H, v29.8H, v30.8H\n-    __ mlav(v23, __ T2S, v24, v25);                    \/\/       mla     v23.2S, v24.2S, v25.2S\n-    __ mlav(v21, __ T4S, v22, v23);                    \/\/       mla     v21.4S, v22.4S, v23.4S\n-    __ fmla(v25, __ T2S, v26, v27);                    \/\/       fmla    v25.2S, v26.2S, v27.2S\n-    __ fmla(v24, __ T4S, v25, v26);                    \/\/       fmla    v24.4S, v25.4S, v26.4S\n-    __ fmla(v3, __ T2D, v4, v5);                       \/\/       fmla    v3.2D, v4.2D, v5.2D\n-    __ mlsv(v23, __ T4H, v24, v25);                    \/\/       mls     v23.4H, v24.4H, v25.4H\n-    __ mlsv(v26, __ T8H, v27, v28);                    \/\/       mls     v26.8H, v27.8H, v28.8H\n-    __ mlsv(v23, __ T2S, v24, v25);                    \/\/       mls     v23.2S, v24.2S, v25.2S\n-    __ mlsv(v14, __ T4S, v15, v16);                    \/\/       mls     v14.4S, v15.4S, v16.4S\n-    __ fmls(v21, __ T2S, v22, v23);                    \/\/       fmls    v21.2S, v22.2S, v23.2S\n-    __ fmls(v3, __ T4S, v4, v5);                       \/\/       fmls    v3.4S, v4.4S, v5.4S\n-    __ fmls(v23, __ T2D, v24, v25);                    \/\/       fmls    v23.2D, v24.2D, v25.2D\n-    __ fdiv(v8, __ T2S, v9, v10);                      \/\/       fdiv    v8.2S, v9.2S, v10.2S\n-    __ fdiv(v24, __ T4S, v25, v26);                    \/\/       fdiv    v24.4S, v25.4S, v26.4S\n-    __ fdiv(v19, __ T2D, v20, v21);                    \/\/       fdiv    v19.2D, v20.2D, v21.2D\n-    __ maxv(v15, __ T8B, v16, v17);                    \/\/       smax    v15.8B, v16.8B, v17.8B\n-    __ maxv(v16, __ T16B, v17, v18);                   \/\/       smax    v16.16B, v17.16B, v18.16B\n-    __ maxv(v2, __ T4H, v3, v4);                       \/\/       smax    v2.4H, v3.4H, v4.4H\n-    __ maxv(v1, __ T8H, v2, v3);                       \/\/       smax    v1.8H, v2.8H, v3.8H\n-    __ maxv(v0, __ T2S, v1, v2);                       \/\/       smax    v0.2S, v1.2S, v2.2S\n-    __ maxv(v24, __ T4S, v25, v26);                    \/\/       smax    v24.4S, v25.4S, v26.4S\n-    __ smaxp(v4, __ T8B, v5, v6);                      \/\/       smaxp   v4.8B, v5.8B, v6.8B\n-    __ smaxp(v3, __ T16B, v4, v5);                     \/\/       smaxp   v3.16B, v4.16B, v5.16B\n-    __ smaxp(v11, __ T4H, v12, v13);                   \/\/       smaxp   v11.4H, v12.4H, v13.4H\n-    __ smaxp(v30, __ T8H, v31, v0);                    \/\/       smaxp   v30.8H, v31.8H, v0.8H\n-    __ smaxp(v27, __ T2S, v28, v29);                   \/\/       smaxp   v27.2S, v28.2S, v29.2S\n-    __ smaxp(v9, __ T4S, v10, v11);                    \/\/       smaxp   v9.4S, v10.4S, v11.4S\n-    __ fmax(v25, __ T2S, v26, v27);                    \/\/       fmax    v25.2S, v26.2S, v27.2S\n-    __ fmax(v2, __ T4S, v3, v4);                       \/\/       fmax    v2.4S, v3.4S, v4.4S\n-    __ fmax(v12, __ T2D, v13, v14);                    \/\/       fmax    v12.2D, v13.2D, v14.2D\n-    __ minv(v17, __ T8B, v18, v19);                    \/\/       smin    v17.8B, v18.8B, v19.8B\n-    __ minv(v30, __ T16B, v31, v0);                    \/\/       smin    v30.16B, v31.16B, v0.16B\n-    __ minv(v1, __ T4H, v2, v3);                       \/\/       smin    v1.4H, v2.4H, v3.4H\n-    __ minv(v12, __ T8H, v13, v14);                    \/\/       smin    v12.8H, v13.8H, v14.8H\n-    __ minv(v28, __ T2S, v29, v30);                    \/\/       smin    v28.2S, v29.2S, v30.2S\n-    __ minv(v0, __ T4S, v1, v2);                       \/\/       smin    v0.4S, v1.4S, v2.4S\n-    __ sminp(v17, __ T8B, v18, v19);                   \/\/       sminp   v17.8B, v18.8B, v19.8B\n-    __ sminp(v12, __ T16B, v13, v14);                  \/\/       sminp   v12.16B, v13.16B, v14.16B\n-    __ sminp(v17, __ T4H, v18, v19);                   \/\/       sminp   v17.4H, v18.4H, v19.4H\n-    __ sminp(v21, __ T8H, v22, v23);                   \/\/       sminp   v21.8H, v22.8H, v23.8H\n+    __ mulv(v20, __ T16B, v21, v22);                   \/\/       mul     v20.16B, v21.16B, v22.16B\n+    __ mulv(v8, __ T4H, v9, v10);                      \/\/       mul     v8.4H, v9.4H, v10.4H\n+    __ mulv(v30, __ T8H, v31, v0);                     \/\/       mul     v30.8H, v31.8H, v0.8H\n+    __ mulv(v17, __ T2S, v18, v19);                    \/\/       mul     v17.2S, v18.2S, v19.2S\n+    __ mulv(v10, __ T4S, v11, v12);                    \/\/       mul     v10.4S, v11.4S, v12.4S\n+    __ fabd(v27, __ T2S, v28, v29);                    \/\/       fabd    v27.2S, v28.2S, v29.2S\n+    __ fabd(v2, __ T4S, v3, v4);                       \/\/       fabd    v2.4S, v3.4S, v4.4S\n+    __ fabd(v24, __ T2D, v25, v26);                    \/\/       fabd    v24.2D, v25.2D, v26.2D\n+    __ fmul(v4, __ T2S, v5, v6);                       \/\/       fmul    v4.2S, v5.2S, v6.2S\n+    __ fmul(v3, __ T4S, v4, v5);                       \/\/       fmul    v3.4S, v4.4S, v5.4S\n+    __ fmul(v8, __ T2D, v9, v10);                      \/\/       fmul    v8.2D, v9.2D, v10.2D\n+    __ mlav(v22, __ T4H, v23, v24);                    \/\/       mla     v22.4H, v23.4H, v24.4H\n+    __ mlav(v17, __ T8H, v18, v19);                    \/\/       mla     v17.8H, v18.8H, v19.8H\n+    __ mlav(v13, __ T2S, v14, v15);                    \/\/       mla     v13.2S, v14.2S, v15.2S\n+    __ mlav(v4, __ T4S, v5, v6);                       \/\/       mla     v4.4S, v5.4S, v6.4S\n+    __ fmla(v28, __ T2S, v29, v30);                    \/\/       fmla    v28.2S, v29.2S, v30.2S\n+    __ fmla(v23, __ T4S, v24, v25);                    \/\/       fmla    v23.4S, v24.4S, v25.4S\n+    __ fmla(v21, __ T2D, v22, v23);                    \/\/       fmla    v21.2D, v22.2D, v23.2D\n+    __ mlsv(v25, __ T4H, v26, v27);                    \/\/       mls     v25.4H, v26.4H, v27.4H\n+    __ mlsv(v24, __ T8H, v25, v26);                    \/\/       mls     v24.8H, v25.8H, v26.8H\n+    __ mlsv(v3, __ T2S, v4, v5);                       \/\/       mls     v3.2S, v4.2S, v5.2S\n+    __ mlsv(v23, __ T4S, v24, v25);                    \/\/       mls     v23.4S, v24.4S, v25.4S\n+    __ fmls(v26, __ T2S, v27, v28);                    \/\/       fmls    v26.2S, v27.2S, v28.2S\n+    __ fmls(v23, __ T4S, v24, v25);                    \/\/       fmls    v23.4S, v24.4S, v25.4S\n+    __ fmls(v14, __ T2D, v15, v16);                    \/\/       fmls    v14.2D, v15.2D, v16.2D\n+    __ fdiv(v21, __ T2S, v22, v23);                    \/\/       fdiv    v21.2S, v22.2S, v23.2S\n+    __ fdiv(v3, __ T4S, v4, v5);                       \/\/       fdiv    v3.4S, v4.4S, v5.4S\n+    __ fdiv(v23, __ T2D, v24, v25);                    \/\/       fdiv    v23.2D, v24.2D, v25.2D\n+    __ maxv(v8, __ T8B, v9, v10);                      \/\/       smax    v8.8B, v9.8B, v10.8B\n+    __ maxv(v24, __ T16B, v25, v26);                   \/\/       smax    v24.16B, v25.16B, v26.16B\n+    __ maxv(v19, __ T4H, v20, v21);                    \/\/       smax    v19.4H, v20.4H, v21.4H\n+    __ maxv(v15, __ T8H, v16, v17);                    \/\/       smax    v15.8H, v16.8H, v17.8H\n+    __ maxv(v16, __ T2S, v17, v18);                    \/\/       smax    v16.2S, v17.2S, v18.2S\n+    __ maxv(v2, __ T4S, v3, v4);                       \/\/       smax    v2.4S, v3.4S, v4.4S\n+    __ smaxp(v1, __ T8B, v2, v3);                      \/\/       smaxp   v1.8B, v2.8B, v3.8B\n+    __ smaxp(v0, __ T16B, v1, v2);                     \/\/       smaxp   v0.16B, v1.16B, v2.16B\n+    __ smaxp(v24, __ T4H, v25, v26);                   \/\/       smaxp   v24.4H, v25.4H, v26.4H\n+    __ smaxp(v4, __ T8H, v5, v6);                      \/\/       smaxp   v4.8H, v5.8H, v6.8H\n+    __ smaxp(v3, __ T2S, v4, v5);                      \/\/       smaxp   v3.2S, v4.2S, v5.2S\n+    __ smaxp(v11, __ T4S, v12, v13);                   \/\/       smaxp   v11.4S, v12.4S, v13.4S\n+    __ fmax(v30, __ T2S, v31, v0);                     \/\/       fmax    v30.2S, v31.2S, v0.2S\n+    __ fmax(v27, __ T4S, v28, v29);                    \/\/       fmax    v27.4S, v28.4S, v29.4S\n+    __ fmax(v9, __ T2D, v10, v11);                     \/\/       fmax    v9.2D, v10.2D, v11.2D\n+    __ minv(v25, __ T8B, v26, v27);                    \/\/       smin    v25.8B, v26.8B, v27.8B\n+    __ minv(v2, __ T16B, v3, v4);                      \/\/       smin    v2.16B, v3.16B, v4.16B\n+    __ minv(v12, __ T4H, v13, v14);                    \/\/       smin    v12.4H, v13.4H, v14.4H\n+    __ minv(v17, __ T8H, v18, v19);                    \/\/       smin    v17.8H, v18.8H, v19.8H\n+    __ minv(v30, __ T2S, v31, v0);                     \/\/       smin    v30.2S, v31.2S, v0.2S\n+    __ minv(v1, __ T4S, v2, v3);                       \/\/       smin    v1.4S, v2.4S, v3.4S\n+    __ sminp(v12, __ T8B, v13, v14);                   \/\/       sminp   v12.8B, v13.8B, v14.8B\n+    __ sminp(v28, __ T16B, v29, v30);                  \/\/       sminp   v28.16B, v29.16B, v30.16B\n+    __ sminp(v0, __ T4H, v1, v2);                      \/\/       sminp   v0.4H, v1.4H, v2.4H\n+    __ sminp(v17, __ T8H, v18, v19);                   \/\/       sminp   v17.8H, v18.8H, v19.8H\n@@ -709,10 +707,10 @@\n-    __ sminp(v27, __ T4S, v28, v29);                   \/\/       sminp   v27.4S, v28.4S, v29.4S\n-    __ fmin(v29, __ T2S, v30, v31);                    \/\/       fmin    v29.2S, v30.2S, v31.2S\n-    __ fmin(v30, __ T4S, v31, v0);                     \/\/       fmin    v30.4S, v31.4S, v0.4S\n-    __ fmin(v1, __ T2D, v2, v3);                       \/\/       fmin    v1.2D, v2.2D, v3.2D\n-    __ cmeq(v25, __ T8B, v26, v27);                    \/\/       cmeq    v25.8B, v26.8B, v27.8B\n-    __ cmeq(v27, __ T16B, v28, v29);                   \/\/       cmeq    v27.16B, v28.16B, v29.16B\n-    __ cmeq(v4, __ T4H, v5, v6);                       \/\/       cmeq    v4.4H, v5.4H, v6.4H\n-    __ cmeq(v29, __ T8H, v30, v31);                    \/\/       cmeq    v29.8H, v30.8H, v31.8H\n-    __ cmeq(v3, __ T2S, v4, v5);                       \/\/       cmeq    v3.2S, v4.2S, v5.2S\n-    __ cmeq(v6, __ T4S, v7, v8);                       \/\/       cmeq    v6.4S, v7.4S, v8.4S\n+    __ sminp(v17, __ T4S, v18, v19);                   \/\/       sminp   v17.4S, v18.4S, v19.4S\n+    __ fmin(v21, __ T2S, v22, v23);                    \/\/       fmin    v21.2S, v22.2S, v23.2S\n+    __ fmin(v12, __ T4S, v13, v14);                    \/\/       fmin    v12.4S, v13.4S, v14.4S\n+    __ fmin(v27, __ T2D, v28, v29);                    \/\/       fmin    v27.2D, v28.2D, v29.2D\n+    __ cmeq(v29, __ T8B, v30, v31);                    \/\/       cmeq    v29.8B, v30.8B, v31.8B\n+    __ cmeq(v30, __ T16B, v31, v0);                    \/\/       cmeq    v30.16B, v31.16B, v0.16B\n+    __ cmeq(v1, __ T4H, v2, v3);                       \/\/       cmeq    v1.4H, v2.4H, v3.4H\n+    __ cmeq(v25, __ T8H, v26, v27);                    \/\/       cmeq    v25.8H, v26.8H, v27.8H\n+    __ cmeq(v27, __ T2S, v28, v29);                    \/\/       cmeq    v27.2S, v28.2S, v29.2S\n+    __ cmeq(v4, __ T4S, v5, v6);                       \/\/       cmeq    v4.4S, v5.4S, v6.4S\n@@ -720,40 +718,40 @@\n-    __ fcmeq(v25, __ T2S, v26, v27);                   \/\/       fcmeq   v25.2S, v26.2S, v27.2S\n-    __ fcmeq(v17, __ T4S, v18, v19);                   \/\/       fcmeq   v17.4S, v18.4S, v19.4S\n-    __ fcmeq(v8, __ T2D, v9, v10);                     \/\/       fcmeq   v8.2D, v9.2D, v10.2D\n-    __ cmgt(v7, __ T8B, v8, v9);                       \/\/       cmgt    v7.8B, v8.8B, v9.8B\n-    __ cmgt(v12, __ T16B, v13, v14);                   \/\/       cmgt    v12.16B, v13.16B, v14.16B\n-    __ cmgt(v0, __ T4H, v1, v2);                       \/\/       cmgt    v0.4H, v1.4H, v2.4H\n-    __ cmgt(v19, __ T8H, v20, v21);                    \/\/       cmgt    v19.8H, v20.8H, v21.8H\n-    __ cmgt(v1, __ T2S, v2, v3);                       \/\/       cmgt    v1.2S, v2.2S, v3.2S\n-    __ cmgt(v23, __ T4S, v24, v25);                    \/\/       cmgt    v23.4S, v24.4S, v25.4S\n-    __ cmgt(v2, __ T2D, v3, v4);                       \/\/       cmgt    v2.2D, v3.2D, v4.2D\n-    __ cmhi(v0, __ T8B, v1, v2);                       \/\/       cmhi    v0.8B, v1.8B, v2.8B\n-    __ cmhi(v8, __ T16B, v9, v10);                     \/\/       cmhi    v8.16B, v9.16B, v10.16B\n-    __ cmhi(v23, __ T4H, v24, v25);                    \/\/       cmhi    v23.4H, v24.4H, v25.4H\n-    __ cmhi(v25, __ T8H, v26, v27);                    \/\/       cmhi    v25.8H, v26.8H, v27.8H\n-    __ cmhi(v15, __ T2S, v16, v17);                    \/\/       cmhi    v15.2S, v16.2S, v17.2S\n-    __ cmhi(v29, __ T4S, v30, v31);                    \/\/       cmhi    v29.4S, v30.4S, v31.4S\n-    __ cmhi(v3, __ T2D, v4, v5);                       \/\/       cmhi    v3.2D, v4.2D, v5.2D\n-    __ cmhs(v10, __ T8B, v11, v12);                    \/\/       cmhs    v10.8B, v11.8B, v12.8B\n-    __ cmhs(v22, __ T16B, v23, v24);                   \/\/       cmhs    v22.16B, v23.16B, v24.16B\n-    __ cmhs(v10, __ T4H, v11, v12);                    \/\/       cmhs    v10.4H, v11.4H, v12.4H\n-    __ cmhs(v4, __ T8H, v5, v6);                       \/\/       cmhs    v4.8H, v5.8H, v6.8H\n-    __ cmhs(v17, __ T2S, v18, v19);                    \/\/       cmhs    v17.2S, v18.2S, v19.2S\n-    __ cmhs(v1, __ T4S, v2, v3);                       \/\/       cmhs    v1.4S, v2.4S, v3.4S\n-    __ cmhs(v11, __ T2D, v12, v13);                    \/\/       cmhs    v11.2D, v12.2D, v13.2D\n-    __ fcmgt(v7, __ T2S, v8, v9);                      \/\/       fcmgt   v7.2S, v8.2S, v9.2S\n-    __ fcmgt(v10, __ T4S, v11, v12);                   \/\/       fcmgt   v10.4S, v11.4S, v12.4S\n-    __ fcmgt(v15, __ T2D, v16, v17);                   \/\/       fcmgt   v15.2D, v16.2D, v17.2D\n-    __ cmge(v16, __ T8B, v17, v18);                    \/\/       cmge    v16.8B, v17.8B, v18.8B\n-    __ cmge(v2, __ T16B, v3, v4);                      \/\/       cmge    v2.16B, v3.16B, v4.16B\n-    __ cmge(v9, __ T4H, v10, v11);                     \/\/       cmge    v9.4H, v10.4H, v11.4H\n-    __ cmge(v11, __ T8H, v12, v13);                    \/\/       cmge    v11.8H, v12.8H, v13.8H\n-    __ cmge(v12, __ T2S, v13, v14);                    \/\/       cmge    v12.2S, v13.2S, v14.2S\n-    __ cmge(v14, __ T4S, v15, v16);                    \/\/       cmge    v14.4S, v15.4S, v16.4S\n-    __ cmge(v13, __ T2D, v14, v15);                    \/\/       cmge    v13.2D, v14.2D, v15.2D\n-    __ fcmge(v2, __ T2S, v3, v4);                      \/\/       fcmge   v2.2S, v3.2S, v4.2S\n-    __ fcmge(v6, __ T4S, v7, v8);                      \/\/       fcmge   v6.4S, v7.4S, v8.4S\n-    __ fcmge(v19, __ T2D, v20, v21);                   \/\/       fcmge   v19.2D, v20.2D, v21.2D\n-    __ facgt(v25, __ T2S, v26, v27);                   \/\/       facgt   v25.2S, v26.2S, v27.2S\n-    __ facgt(v15, __ T4S, v16, v17);                   \/\/       facgt   v15.4S, v16.4S, v17.4S\n-    __ facgt(v4, __ T2D, v5, v6);                      \/\/       facgt   v4.2D, v5.2D, v6.2D\n+    __ fcmeq(v3, __ T2S, v4, v5);                      \/\/       fcmeq   v3.2S, v4.2S, v5.2S\n+    __ fcmeq(v6, __ T4S, v7, v8);                      \/\/       fcmeq   v6.4S, v7.4S, v8.4S\n+    __ fcmeq(v29, __ T2D, v30, v31);                   \/\/       fcmeq   v29.2D, v30.2D, v31.2D\n+    __ cmgt(v25, __ T8B, v26, v27);                    \/\/       cmgt    v25.8B, v26.8B, v27.8B\n+    __ cmgt(v17, __ T16B, v18, v19);                   \/\/       cmgt    v17.16B, v18.16B, v19.16B\n+    __ cmgt(v8, __ T4H, v9, v10);                      \/\/       cmgt    v8.4H, v9.4H, v10.4H\n+    __ cmgt(v7, __ T8H, v8, v9);                       \/\/       cmgt    v7.8H, v8.8H, v9.8H\n+    __ cmgt(v12, __ T2S, v13, v14);                    \/\/       cmgt    v12.2S, v13.2S, v14.2S\n+    __ cmgt(v0, __ T4S, v1, v2);                       \/\/       cmgt    v0.4S, v1.4S, v2.4S\n+    __ cmgt(v19, __ T2D, v20, v21);                    \/\/       cmgt    v19.2D, v20.2D, v21.2D\n+    __ cmhi(v1, __ T8B, v2, v3);                       \/\/       cmhi    v1.8B, v2.8B, v3.8B\n+    __ cmhi(v23, __ T16B, v24, v25);                   \/\/       cmhi    v23.16B, v24.16B, v25.16B\n+    __ cmhi(v2, __ T4H, v3, v4);                       \/\/       cmhi    v2.4H, v3.4H, v4.4H\n+    __ cmhi(v0, __ T8H, v1, v2);                       \/\/       cmhi    v0.8H, v1.8H, v2.8H\n+    __ cmhi(v8, __ T2S, v9, v10);                      \/\/       cmhi    v8.2S, v9.2S, v10.2S\n+    __ cmhi(v23, __ T4S, v24, v25);                    \/\/       cmhi    v23.4S, v24.4S, v25.4S\n+    __ cmhi(v25, __ T2D, v26, v27);                    \/\/       cmhi    v25.2D, v26.2D, v27.2D\n+    __ cmhs(v15, __ T8B, v16, v17);                    \/\/       cmhs    v15.8B, v16.8B, v17.8B\n+    __ cmhs(v29, __ T16B, v30, v31);                   \/\/       cmhs    v29.16B, v30.16B, v31.16B\n+    __ cmhs(v3, __ T4H, v4, v5);                       \/\/       cmhs    v3.4H, v4.4H, v5.4H\n+    __ cmhs(v10, __ T8H, v11, v12);                    \/\/       cmhs    v10.8H, v11.8H, v12.8H\n+    __ cmhs(v22, __ T2S, v23, v24);                    \/\/       cmhs    v22.2S, v23.2S, v24.2S\n+    __ cmhs(v10, __ T4S, v11, v12);                    \/\/       cmhs    v10.4S, v11.4S, v12.4S\n+    __ cmhs(v4, __ T2D, v5, v6);                       \/\/       cmhs    v4.2D, v5.2D, v6.2D\n+    __ fcmgt(v17, __ T2S, v18, v19);                   \/\/       fcmgt   v17.2S, v18.2S, v19.2S\n+    __ fcmgt(v1, __ T4S, v2, v3);                      \/\/       fcmgt   v1.4S, v2.4S, v3.4S\n+    __ fcmgt(v11, __ T2D, v12, v13);                   \/\/       fcmgt   v11.2D, v12.2D, v13.2D\n+    __ cmge(v7, __ T8B, v8, v9);                       \/\/       cmge    v7.8B, v8.8B, v9.8B\n+    __ cmge(v10, __ T16B, v11, v12);                   \/\/       cmge    v10.16B, v11.16B, v12.16B\n+    __ cmge(v15, __ T4H, v16, v17);                    \/\/       cmge    v15.4H, v16.4H, v17.4H\n+    __ cmge(v16, __ T8H, v17, v18);                    \/\/       cmge    v16.8H, v17.8H, v18.8H\n+    __ cmge(v2, __ T2S, v3, v4);                       \/\/       cmge    v2.2S, v3.2S, v4.2S\n+    __ cmge(v9, __ T4S, v10, v11);                     \/\/       cmge    v9.4S, v10.4S, v11.4S\n+    __ cmge(v11, __ T2D, v12, v13);                    \/\/       cmge    v11.2D, v12.2D, v13.2D\n+    __ fcmge(v12, __ T2S, v13, v14);                   \/\/       fcmge   v12.2S, v13.2S, v14.2S\n+    __ fcmge(v14, __ T4S, v15, v16);                   \/\/       fcmge   v14.4S, v15.4S, v16.4S\n+    __ fcmge(v13, __ T2D, v14, v15);                   \/\/       fcmge   v13.2D, v14.2D, v15.2D\n+    __ facgt(v2, __ T2S, v3, v4);                      \/\/       facgt   v2.2S, v3.2S, v4.2S\n+    __ facgt(v6, __ T4S, v7, v8);                      \/\/       facgt   v6.4S, v7.4S, v8.4S\n+    __ facgt(v19, __ T2D, v20, v21);                   \/\/       facgt   v19.2D, v20.2D, v21.2D\n@@ -762,6 +760,6 @@\n-    __ sve_fcm(Assembler::EQ, p1, __ S, p4, z4, 0.0);  \/\/       fcmeq   p1.s, p4\/z, z4.s, #0.0\n-    __ sve_fcm(Assembler::GT, p10, __ D, p2, z16, 0.0); \/\/      fcmgt   p10.d, p2\/z, z16.d, #0.0\n-    __ sve_fcm(Assembler::GE, p10, __ S, p6, z22, 0.0); \/\/      fcmge   p10.s, p6\/z, z22.s, #0.0\n-    __ sve_fcm(Assembler::LT, p11, __ S, p2, z28, 0.0); \/\/      fcmlt   p11.s, p2\/z, z28.s, #0.0\n-    __ sve_fcm(Assembler::LE, p12, __ S, p7, z1, 0.0); \/\/       fcmle   p12.s, p7\/z, z1.s, #0.0\n-    __ sve_fcm(Assembler::NE, p5, __ S, p0, z15, 0.0); \/\/       fcmne   p5.s, p0\/z, z15.s, #0.0\n+    __ sve_fcm(Assembler::EQ, p13, __ S, p0, z15, 0.0); \/\/      fcmeq   p13.s, p0\/z, z15.s, #0.0\n+    __ sve_fcm(Assembler::GT, p2, __ D, p5, z11, 0.0); \/\/       fcmgt   p2.d, p5\/z, z11.d, #0.0\n+    __ sve_fcm(Assembler::GE, p8, __ S, p5, z17, 0.0); \/\/       fcmge   p8.s, p5\/z, z17.s, #0.0\n+    __ sve_fcm(Assembler::LT, p11, __ D, p5, z12, 0.0); \/\/      fcmlt   p11.d, p5\/z, z12.d, #0.0\n+    __ sve_fcm(Assembler::LE, p14, __ S, p6, z14, 0.0); \/\/      fcmle   p14.s, p6\/z, z14.s, #0.0\n+    __ sve_fcm(Assembler::NE, p0, __ D, p2, z11, 0.0); \/\/       fcmne   p0.d, p2\/z, z11.d, #0.0\n@@ -1018,9 +1016,9 @@\n-    __ swp(Assembler::xword, r3, r13, r19);            \/\/       swp     x3, x13, [x19]\n-    __ ldadd(Assembler::xword, r17, r16, r3);          \/\/       ldadd   x17, x16, [x3]\n-    __ ldbic(Assembler::xword, r1, r11, r30);          \/\/       ldclr   x1, x11, [x30]\n-    __ ldeor(Assembler::xword, r5, r8, r15);           \/\/       ldeor   x5, x8, [x15]\n-    __ ldorr(Assembler::xword, r29, r30, r0);          \/\/       ldset   x29, x30, [x0]\n-    __ ldsmin(Assembler::xword, r20, r7, r20);         \/\/       ldsmin  x20, x7, [x20]\n-    __ ldsmax(Assembler::xword, r23, r28, r21);        \/\/       ldsmax  x23, x28, [x21]\n-    __ ldumin(Assembler::xword, r27, r25, r5);         \/\/       ldumin  x27, x25, [x5]\n-    __ ldumax(Assembler::xword, r1, r23, r16);         \/\/       ldumax  x1, x23, [x16]\n+    __ swp(Assembler::xword, r16, r7, r2);             \/\/       swp     x16, x7, [x2]\n+    __ ldadd(Assembler::xword, r3, r13, r19);          \/\/       ldadd   x3, x13, [x19]\n+    __ ldbic(Assembler::xword, r17, r16, r3);          \/\/       ldclr   x17, x16, [x3]\n+    __ ldeor(Assembler::xword, r1, r11, r30);          \/\/       ldeor   x1, x11, [x30]\n+    __ ldorr(Assembler::xword, r5, r8, r15);           \/\/       ldset   x5, x8, [x15]\n+    __ ldsmin(Assembler::xword, r29, r30, r0);         \/\/       ldsmin  x29, x30, [x0]\n+    __ ldsmax(Assembler::xword, r20, r7, r20);         \/\/       ldsmax  x20, x7, [x20]\n+    __ ldumin(Assembler::xword, r23, r28, r21);        \/\/       ldumin  x23, x28, [x21]\n+    __ ldumax(Assembler::xword, r27, r25, r5);         \/\/       ldumax  x27, x25, [x5]\n@@ -1029,9 +1027,9 @@\n-    __ swpa(Assembler::xword, zr, r5, r12);            \/\/       swpa    xzr, x5, [x12]\n-    __ ldadda(Assembler::xword, r9, r28, r15);         \/\/       ldadda  x9, x28, [x15]\n-    __ ldbica(Assembler::xword, r29, r22, sp);         \/\/       ldclra  x29, x22, [sp]\n-    __ ldeora(Assembler::xword, r19, zr, r5);          \/\/       ldeora  x19, xzr, [x5]\n-    __ ldorra(Assembler::xword, r14, r16, sp);         \/\/       ldseta  x14, x16, [sp]\n-    __ ldsmina(Assembler::xword, r16, r27, r20);       \/\/       ldsmina x16, x27, [x20]\n-    __ ldsmaxa(Assembler::xword, r16, r12, r11);       \/\/       ldsmaxa x16, x12, [x11]\n-    __ ldumina(Assembler::xword, r9, r6, r30);         \/\/       ldumina x9, x6, [x30]\n-    __ ldumaxa(Assembler::xword, r17, r27, r28);       \/\/       ldumaxa x17, x27, [x28]\n+    __ swpa(Assembler::xword, r1, r23, r16);           \/\/       swpa    x1, x23, [x16]\n+    __ ldadda(Assembler::xword, zr, r5, r12);          \/\/       ldadda  xzr, x5, [x12]\n+    __ ldbica(Assembler::xword, r9, r28, r15);         \/\/       ldclra  x9, x28, [x15]\n+    __ ldeora(Assembler::xword, r29, r22, sp);         \/\/       ldeora  x29, x22, [sp]\n+    __ ldorra(Assembler::xword, r19, zr, r5);          \/\/       ldseta  x19, xzr, [x5]\n+    __ ldsmina(Assembler::xword, r14, r16, sp);        \/\/       ldsmina x14, x16, [sp]\n+    __ ldsmaxa(Assembler::xword, r16, r27, r20);       \/\/       ldsmaxa x16, x27, [x20]\n+    __ ldumina(Assembler::xword, r16, r12, r11);       \/\/       ldumina x16, x12, [x11]\n+    __ ldumaxa(Assembler::xword, r9, r6, r30);         \/\/       ldumaxa x9, x6, [x30]\n@@ -1040,9 +1038,9 @@\n-    __ swpal(Assembler::xword, r30, r7, r10);          \/\/       swpal   x30, x7, [x10]\n-    __ ldaddal(Assembler::xword, r20, r10, r4);        \/\/       ldaddal x20, x10, [x4]\n-    __ ldbical(Assembler::xword, r24, r17, r17);       \/\/       ldclral x24, x17, [x17]\n-    __ ldeoral(Assembler::xword, r22, r3, r29);        \/\/       ldeoral x22, x3, [x29]\n-    __ ldorral(Assembler::xword, r15, r22, r19);       \/\/       ldsetal x15, x22, [x19]\n-    __ ldsminal(Assembler::xword, r19, r22, r2);       \/\/       ldsminal        x19, x22, [x2]\n-    __ ldsmaxal(Assembler::xword, r15, r6, r12);       \/\/       ldsmaxal        x15, x6, [x12]\n-    __ lduminal(Assembler::xword, r16, r11, r13);      \/\/       lduminal        x16, x11, [x13]\n-    __ ldumaxal(Assembler::xword, r23, r1, r30);       \/\/       ldumaxal        x23, x1, [x30]\n+    __ swpal(Assembler::xword, r17, r27, r28);         \/\/       swpal   x17, x27, [x28]\n+    __ ldaddal(Assembler::xword, r30, r7, r10);        \/\/       ldaddal x30, x7, [x10]\n+    __ ldbical(Assembler::xword, r20, r10, r4);        \/\/       ldclral x20, x10, [x4]\n+    __ ldeoral(Assembler::xword, r24, r17, r17);       \/\/       ldeoral x24, x17, [x17]\n+    __ ldorral(Assembler::xword, r22, r3, r29);        \/\/       ldsetal x22, x3, [x29]\n+    __ ldsminal(Assembler::xword, r15, r22, r19);      \/\/       ldsminal        x15, x22, [x19]\n+    __ ldsmaxal(Assembler::xword, r19, r22, r2);       \/\/       ldsmaxal        x19, x22, [x2]\n+    __ lduminal(Assembler::xword, r15, r6, r12);       \/\/       lduminal        x15, x6, [x12]\n+    __ ldumaxal(Assembler::xword, r16, r11, r13);      \/\/       ldumaxal        x16, x11, [x13]\n@@ -1051,9 +1049,9 @@\n-    __ swpl(Assembler::xword, r19, r5, r17);           \/\/       swpl    x19, x5, [x17]\n-    __ ldaddl(Assembler::xword, r2, r16, r22);         \/\/       ldaddl  x2, x16, [x22]\n-    __ ldbicl(Assembler::xword, r13, r10, r21);        \/\/       ldclrl  x13, x10, [x21]\n-    __ ldeorl(Assembler::xword, r29, r27, r12);        \/\/       ldeorl  x29, x27, [x12]\n-    __ ldorrl(Assembler::xword, r27, r3, r1);          \/\/       ldsetl  x27, x3, [x1]\n-    __ ldsminl(Assembler::xword, zr, r24, r19);        \/\/       ldsminl xzr, x24, [x19]\n-    __ ldsmaxl(Assembler::xword, r17, r9, r28);        \/\/       ldsmaxl x17, x9, [x28]\n-    __ lduminl(Assembler::xword, r27, r15, r7);        \/\/       lduminl x27, x15, [x7]\n-    __ ldumaxl(Assembler::xword, r21, r23, sp);        \/\/       ldumaxl x21, x23, [sp]\n+    __ swpl(Assembler::xword, r23, r1, r30);           \/\/       swpl    x23, x1, [x30]\n+    __ ldaddl(Assembler::xword, r19, r5, r17);         \/\/       ldaddl  x19, x5, [x17]\n+    __ ldbicl(Assembler::xword, r2, r16, r22);         \/\/       ldclrl  x2, x16, [x22]\n+    __ ldeorl(Assembler::xword, r13, r10, r21);        \/\/       ldeorl  x13, x10, [x21]\n+    __ ldorrl(Assembler::xword, r29, r27, r12);        \/\/       ldsetl  x29, x27, [x12]\n+    __ ldsminl(Assembler::xword, r27, r3, r1);         \/\/       ldsminl x27, x3, [x1]\n+    __ ldsmaxl(Assembler::xword, zr, r24, r19);        \/\/       ldsmaxl xzr, x24, [x19]\n+    __ lduminl(Assembler::xword, r17, r9, r28);        \/\/       lduminl x17, x9, [x28]\n+    __ ldumaxl(Assembler::xword, r27, r15, r7);        \/\/       ldumaxl x27, x15, [x7]\n@@ -1062,9 +1060,9 @@\n-    __ swp(Assembler::word, r25, r2, sp);              \/\/       swp     w25, w2, [sp]\n-    __ ldadd(Assembler::word, r27, r16, r10);          \/\/       ldadd   w27, w16, [x10]\n-    __ ldbic(Assembler::word, r23, r19, r3);           \/\/       ldclr   w23, w19, [x3]\n-    __ ldeor(Assembler::word, r16, r0, r25);           \/\/       ldeor   w16, w0, [x25]\n-    __ ldorr(Assembler::word, r26, r23, r2);           \/\/       ldset   w26, w23, [x2]\n-    __ ldsmin(Assembler::word, r16, r12, r4);          \/\/       ldsmin  w16, w12, [x4]\n-    __ ldsmax(Assembler::word, r28, r30, r29);         \/\/       ldsmax  w28, w30, [x29]\n-    __ ldumin(Assembler::word, r16, r27, r6);          \/\/       ldumin  w16, w27, [x6]\n-    __ ldumax(Assembler::word, r9, r29, r15);          \/\/       ldumax  w9, w29, [x15]\n+    __ swp(Assembler::word, r21, r23, sp);             \/\/       swp     w21, w23, [sp]\n+    __ ldadd(Assembler::word, r25, r2, sp);            \/\/       ldadd   w25, w2, [sp]\n+    __ ldbic(Assembler::word, r27, r16, r10);          \/\/       ldclr   w27, w16, [x10]\n+    __ ldeor(Assembler::word, r23, r19, r3);           \/\/       ldeor   w23, w19, [x3]\n+    __ ldorr(Assembler::word, r16, r0, r25);           \/\/       ldset   w16, w0, [x25]\n+    __ ldsmin(Assembler::word, r26, r23, r2);          \/\/       ldsmin  w26, w23, [x2]\n+    __ ldsmax(Assembler::word, r16, r12, r4);          \/\/       ldsmax  w16, w12, [x4]\n+    __ ldumin(Assembler::word, r28, r30, r29);         \/\/       ldumin  w28, w30, [x29]\n+    __ ldumax(Assembler::word, r16, r27, r6);          \/\/       ldumax  w16, w27, [x6]\n@@ -1073,9 +1071,9 @@\n-    __ swpa(Assembler::word, r7, r4, r7);              \/\/       swpa    w7, w4, [x7]\n-    __ ldadda(Assembler::word, r15, r9, r23);          \/\/       ldadda  w15, w9, [x23]\n-    __ ldbica(Assembler::word, r8, r2, r28);           \/\/       ldclra  w8, w2, [x28]\n-    __ ldeora(Assembler::word, r21, zr, r5);           \/\/       ldeora  w21, wzr, [x5]\n-    __ ldorra(Assembler::word, r27, r0, r17);          \/\/       ldseta  w27, w0, [x17]\n-    __ ldsmina(Assembler::word, r15, r4, r26);         \/\/       ldsmina w15, w4, [x26]\n-    __ ldsmaxa(Assembler::word, r8, r28, r22);         \/\/       ldsmaxa w8, w28, [x22]\n-    __ ldumina(Assembler::word, r27, r27, r25);        \/\/       ldumina w27, w27, [x25]\n-    __ ldumaxa(Assembler::word, r23, r0, r4);          \/\/       ldumaxa w23, w0, [x4]\n+    __ swpa(Assembler::word, r9, r29, r15);            \/\/       swpa    w9, w29, [x15]\n+    __ ldadda(Assembler::word, r7, r4, r7);            \/\/       ldadda  w7, w4, [x7]\n+    __ ldbica(Assembler::word, r15, r9, r23);          \/\/       ldclra  w15, w9, [x23]\n+    __ ldeora(Assembler::word, r8, r2, r28);           \/\/       ldeora  w8, w2, [x28]\n+    __ ldorra(Assembler::word, r21, zr, r5);           \/\/       ldseta  w21, wzr, [x5]\n+    __ ldsmina(Assembler::word, r27, r0, r17);         \/\/       ldsmina w27, w0, [x17]\n+    __ ldsmaxa(Assembler::word, r15, r4, r26);         \/\/       ldsmaxa w15, w4, [x26]\n+    __ ldumina(Assembler::word, r8, r28, r22);         \/\/       ldumina w8, w28, [x22]\n+    __ ldumaxa(Assembler::word, r27, r27, r25);        \/\/       ldumaxa w27, w27, [x25]\n@@ -1084,9 +1082,9 @@\n-    __ swpal(Assembler::word, r6, r16, r0);            \/\/       swpal   w6, w16, [x0]\n-    __ ldaddal(Assembler::word, r4, r15, r1);          \/\/       ldaddal w4, w15, [x1]\n-    __ ldbical(Assembler::word, r10, r7, r5);          \/\/       ldclral w10, w7, [x5]\n-    __ ldeoral(Assembler::word, r10, r28, r7);         \/\/       ldeoral w10, w28, [x7]\n-    __ ldorral(Assembler::word, r20, r23, r21);        \/\/       ldsetal w20, w23, [x21]\n-    __ ldsminal(Assembler::word, r6, r11, r8);         \/\/       ldsminal        w6, w11, [x8]\n-    __ ldsmaxal(Assembler::word, r17, zr, r6);         \/\/       ldsmaxal        w17, wzr, [x6]\n-    __ lduminal(Assembler::word, r17, r2, r12);        \/\/       lduminal        w17, w2, [x12]\n-    __ ldumaxal(Assembler::word, r30, r29, r3);        \/\/       ldumaxal        w30, w29, [x3]\n+    __ swpal(Assembler::word, r23, r0, r4);            \/\/       swpal   w23, w0, [x4]\n+    __ ldaddal(Assembler::word, r6, r16, r0);          \/\/       ldaddal w6, w16, [x0]\n+    __ ldbical(Assembler::word, r4, r15, r1);          \/\/       ldclral w4, w15, [x1]\n+    __ ldeoral(Assembler::word, r10, r7, r5);          \/\/       ldeoral w10, w7, [x5]\n+    __ ldorral(Assembler::word, r10, r28, r7);         \/\/       ldsetal w10, w28, [x7]\n+    __ ldsminal(Assembler::word, r20, r23, r21);       \/\/       ldsminal        w20, w23, [x21]\n+    __ ldsmaxal(Assembler::word, r6, r11, r8);         \/\/       ldsmaxal        w6, w11, [x8]\n+    __ lduminal(Assembler::word, r17, zr, r6);         \/\/       lduminal        w17, wzr, [x6]\n+    __ ldumaxal(Assembler::word, r17, r2, r12);        \/\/       ldumaxal        w17, w2, [x12]\n@@ -1095,9 +1093,9 @@\n-    __ swpl(Assembler::word, r27, r22, r29);           \/\/       swpl    w27, w22, [x29]\n-    __ ldaddl(Assembler::word, r14, r13, r28);         \/\/       ldaddl  w14, w13, [x28]\n-    __ ldbicl(Assembler::word, r17, r24, r5);          \/\/       ldclrl  w17, w24, [x5]\n-    __ ldeorl(Assembler::word, r2, r14, r10);          \/\/       ldeorl  w2, w14, [x10]\n-    __ ldorrl(Assembler::word, r16, r11, r27);         \/\/       ldsetl  w16, w11, [x27]\n-    __ ldsminl(Assembler::word, r23, r12, r4);         \/\/       ldsminl w23, w12, [x4]\n-    __ ldsmaxl(Assembler::word, r22, r17, r4);         \/\/       ldsmaxl w22, w17, [x4]\n-    __ lduminl(Assembler::word, r1, r19, r16);         \/\/       lduminl w1, w19, [x16]\n-    __ ldumaxl(Assembler::word, r16, r13, r14);        \/\/       ldumaxl w16, w13, [x14]\n+    __ swpl(Assembler::word, r30, r29, r3);            \/\/       swpl    w30, w29, [x3]\n+    __ ldaddl(Assembler::word, r27, r22, r29);         \/\/       ldaddl  w27, w22, [x29]\n+    __ ldbicl(Assembler::word, r14, r13, r28);         \/\/       ldclrl  w14, w13, [x28]\n+    __ ldeorl(Assembler::word, r17, r24, r5);          \/\/       ldeorl  w17, w24, [x5]\n+    __ ldorrl(Assembler::word, r2, r14, r10);          \/\/       ldsetl  w2, w14, [x10]\n+    __ ldsminl(Assembler::word, r16, r11, r27);        \/\/       ldsminl w16, w11, [x27]\n+    __ ldsmaxl(Assembler::word, r23, r12, r4);         \/\/       ldsmaxl w23, w12, [x4]\n+    __ lduminl(Assembler::word, r22, r17, r4);         \/\/       lduminl w22, w17, [x4]\n+    __ ldumaxl(Assembler::word, r1, r19, r16);         \/\/       ldumaxl w1, w19, [x16]\n@@ -1106,4 +1104,4 @@\n-    __ bcax(v12, __ T16B, v2, v16, v3);                \/\/       bcax            v12.16B, v2.16B, v16.16B, v3.16B\n-    __ eor3(v20, __ T16B, v23, v5, v6);                \/\/       eor3            v20.16B, v23.16B, v5.16B, v6.16B\n-    __ rax1(v7, __ T2D, v17, v12);                     \/\/       rax1            v7.2D, v17.2D, v12.2D\n-    __ xar(v27, __ T2D, v16, v16, 13);                 \/\/       xar             v27.2D, v16.2D, v16.2D, #13\n+    __ bcax(v17, __ T16B, v12, v14, v12);              \/\/       bcax            v17.16B, v12.16B, v14.16B, v12.16B\n+    __ eor3(v2, __ T16B, v16, v3, v20);                \/\/       eor3            v2.16B, v16.16B, v3.16B, v20.16B\n+    __ rax1(v23, __ T2D, v5, v6);                      \/\/       rax1            v23.2D, v5.2D, v6.2D\n+    __ xar(v7, __ T2D, v17, v12, 56);                  \/\/       xar             v7.2D, v17.2D, v12.2D, #56\n@@ -1112,4 +1110,4 @@\n-    __ sha512h(v2, __ T2D, v28, v3);                   \/\/       sha512h         q2, q28, v3.2D\n-    __ sha512h2(v4, __ T2D, v6, v17);                  \/\/       sha512h2                q4, q6, v17.2D\n-    __ sha512su0(v19, __ T2D, v13);                    \/\/       sha512su0               v19.2D, v13.2D\n-    __ sha512su1(v12, __ T2D, v19, v8);                \/\/       sha512su1               v12.2D, v19.2D, v8.2D\n+    __ sha512h(v16, __ T2D, v16, v6);                  \/\/       sha512h         q16, q16, v6.2D\n+    __ sha512h2(v2, __ T2D, v28, v3);                  \/\/       sha512h2                q2, q28, v3.2D\n+    __ sha512su0(v4, __ T2D, v6);                      \/\/       sha512su0               v4.2D, v6.2D\n+    __ sha512su1(v17, __ T2D, v19, v13);               \/\/       sha512su1               v17.2D, v19.2D, v13.2D\n@@ -1118,5 +1116,5 @@\n-    __ sve_add(z24, __ S, 154u);                       \/\/       add     z24.s, z24.s, #0x9a\n-    __ sve_sub(z0, __ H, 196u);                        \/\/       sub     z0.h, z0.h, #0xc4\n-    __ sve_and(z6, __ S, 1073733632u);                 \/\/       and     z6.s, z6.s, #0x3fffe000\n-    __ sve_eor(z16, __ B, 62u);                        \/\/       eor     z16.b, z16.b, #0x3e\n-    __ sve_orr(z14, __ S, 62915520u);                  \/\/       orr     z14.s, z14.s, #0x3c003c0\n+    __ sve_add(z12, __ S, 67u);                        \/\/       add     z12.s, z12.s, #0x43\n+    __ sve_sub(z24, __ S, 154u);                       \/\/       sub     z24.s, z24.s, #0x9a\n+    __ sve_and(z0, __ H, 511u);                        \/\/       and     z0.h, z0.h, #0x1ff\n+    __ sve_eor(z19, __ D, 9241386433220968447u);       \/\/       eor     z19.d, z19.d, #0x803fffff803fffff\n+    __ sve_orr(z6, __ B, 128u);                        \/\/       orr     z6.b, z6.b, #0x80\n@@ -1125,5 +1123,5 @@\n-    __ sve_add(z10, __ S, 170u);                       \/\/       add     z10.s, z10.s, #0xaa\n-    __ sve_sub(z22, __ D, 22u);                        \/\/       sub     z22.d, z22.d, #0x16\n-    __ sve_and(z3, __ H, 51199u);                      \/\/       and     z3.h, z3.h, #0xc7ff\n-    __ sve_eor(z7, __ B, 62u);                         \/\/       eor     z7.b, z7.b, #0x3e\n-    __ sve_orr(z0, __ H, 51199u);                      \/\/       orr     z0.h, z0.h, #0xc7ff\n+    __ sve_add(z17, __ D, 74u);                        \/\/       add     z17.d, z17.d, #0x4a\n+    __ sve_sub(z10, __ S, 170u);                       \/\/       sub     z10.s, z10.s, #0xaa\n+    __ sve_and(z22, __ D, 17179852800u);               \/\/       and     z22.d, z22.d, #0x3ffffc000\n+    __ sve_eor(z15, __ S, 8388600u);                   \/\/       eor     z15.s, z15.s, #0x7ffff8\n+    __ sve_orr(z4, __ D, 8064u);                       \/\/       orr     z4.d, z4.d, #0x1f80\n@@ -1132,5 +1130,5 @@\n-    __ sve_add(z22, __ B, 130u);                       \/\/       add     z22.b, z22.b, #0x82\n-    __ sve_sub(z9, __ S, 92u);                         \/\/       sub     z9.s, z9.s, #0x5c\n-    __ sve_and(z25, __ B, 131u);                       \/\/       and     z25.b, z25.b, #0x83\n-    __ sve_eor(z13, __ S, 496u);                       \/\/       eor     z13.s, z13.s, #0x1f0\n-    __ sve_orr(z13, __ H, 33279u);                     \/\/       orr     z13.h, z13.h, #0x81ff\n+    __ sve_add(z8, __ S, 162u);                        \/\/       add     z8.s, z8.s, #0xa2\n+    __ sve_sub(z22, __ B, 130u);                       \/\/       sub     z22.b, z22.b, #0x82\n+    __ sve_and(z9, __ S, 4292870159u);                 \/\/       and     z9.s, z9.s, #0xffe0000f\n+    __ sve_eor(z5, __ D, 1150687262887383032u);        \/\/       eor     z5.d, z5.d, #0xff80ff80ff80ff8\n+    __ sve_orr(z22, __ H, 32256u);                     \/\/       orr     z22.h, z22.h, #0x7e00\n@@ -1139,5 +1137,5 @@\n-    __ sve_add(z25, __ H, 39u);                        \/\/       add     z25.h, z25.h, #0x27\n-    __ sve_sub(z4, __ S, 67u);                         \/\/       sub     z4.s, z4.s, #0x43\n-    __ sve_and(z6, __ D, 18446744069548802047u);       \/\/       and     z6.d, z6.d, #0xffffffff07ffffff\n-    __ sve_eor(z16, __ D, 4503599627354112u);          \/\/       eor     z16.d, z16.d, #0xfffffffffc000\n-    __ sve_orr(z14, __ B, 254u);                       \/\/       orr     z14.b, z14.b, #0xfe\n+    __ sve_add(z8, __ S, 134u);                        \/\/       add     z8.s, z8.s, #0x86\n+    __ sve_sub(z25, __ H, 39u);                        \/\/       sub     z25.h, z25.h, #0x27\n+    __ sve_and(z4, __ S, 4186112u);                    \/\/       and     z4.s, z4.s, #0x3fe000\n+    __ sve_eor(z29, __ B, 131u);                       \/\/       eor     z29.b, z29.b, #0x83\n+    __ sve_orr(z29, __ D, 4611685469745315712u);       \/\/       orr     z29.d, z29.d, #0x3fffff803fffff80\n@@ -1146,5 +1144,5 @@\n-    __ sve_add(z3, __ B, 10u);                         \/\/       add     z3.b, z3.b, #0xa\n-    __ sve_sub(z26, __ S, 150u);                       \/\/       sub     z26.s, z26.s, #0x96\n-    __ sve_and(z14, __ H, 57343u);                     \/\/       and     z14.h, z14.h, #0xdfff\n-    __ sve_eor(z24, __ B, 191u);                       \/\/       eor     z24.b, z24.b, #0xbf\n-    __ sve_orr(z17, __ S, 4294966791u);                \/\/       orr     z17.s, z17.s, #0xfffffe07\n+    __ sve_add(z2, __ H, 237u);                        \/\/       add     z2.h, z2.h, #0xed\n+    __ sve_sub(z3, __ B, 10u);                         \/\/       sub     z3.b, z3.b, #0xa\n+    __ sve_and(z26, __ S, 1610637312u);                \/\/       and     z26.s, z26.s, #0x60006000\n+    __ sve_eor(z8, __ S, 4290777087u);                 \/\/       eor     z8.s, z8.s, #0xffc00fff\n+    __ sve_orr(z5, __ S, 3758096384u);                 \/\/       orr     z5.s, z5.s, #0xe0000000\n@@ -1153,5 +1151,5 @@\n-    __ sve_add(z20, __ S, 3u);                         \/\/       add     z20.s, z20.s, #0x3\n-    __ sve_sub(z4, __ S, 196u);                        \/\/       sub     z4.s, z4.s, #0xc4\n-    __ sve_and(z4, __ S, 4286578691u);                 \/\/       and     z4.s, z4.s, #0xff800003\n-    __ sve_eor(z25, __ S, 33553408u);                  \/\/       eor     z25.s, z25.s, #0x1fffc00\n-    __ sve_orr(z8, __ H, 49663u);                      \/\/       orr     z8.h, z8.h, #0xc1ff\n+    __ sve_add(z22, __ S, 244u);                       \/\/       add     z22.s, z22.s, #0xf4\n+    __ sve_sub(z20, __ S, 3u);                         \/\/       sub     z20.s, z20.s, #0x3\n+    __ sve_and(z4, __ S, 491520u);                     \/\/       and     z4.s, z4.s, #0x78000\n+    __ sve_eor(z19, __ B, 239u);                       \/\/       eor     z19.b, z19.b, #0xef\n+    __ sve_orr(z19, __ B, 96u);                        \/\/       orr     z19.b, z19.b, #0x60\n@@ -1160,55 +1158,55 @@\n-    __ sve_add(z30, __ D, z21, z4);                    \/\/       add     z30.d, z21.d, z4.d\n-    __ sve_sub(z1, __ H, z10, z19);                    \/\/       sub     z1.h, z10.h, z19.h\n-    __ sve_fadd(z0, __ D, z9, z7);                     \/\/       fadd    z0.d, z9.d, z7.d\n-    __ sve_fmul(z17, __ S, z4, z27);                   \/\/       fmul    z17.s, z4.s, z27.s\n-    __ sve_fsub(z9, __ S, z27, z23);                   \/\/       fsub    z9.s, z27.s, z23.s\n-    __ sve_abs(z16, __ S, p7, z22);                    \/\/       abs     z16.s, p7\/m, z22.s\n-    __ sve_add(z20, __ H, p7, z28);                    \/\/       add     z20.h, p7\/m, z20.h, z28.h\n-    __ sve_and(z13, __ S, p5, z7);                     \/\/       and     z13.s, p5\/m, z13.s, z7.s\n-    __ sve_asr(z28, __ H, p2, z11);                    \/\/       asr     z28.h, p2\/m, z28.h, z11.h\n-    __ sve_bic(z11, __ D, p5, z1);                     \/\/       bic     z11.d, p5\/m, z11.d, z1.d\n-    __ sve_clz(z8, __ S, p4, z13);                     \/\/       clz     z8.s, p4\/m, z13.s\n-    __ sve_cnt(z17, __ B, p4, z4);                     \/\/       cnt     z17.b, p4\/m, z4.b\n-    __ sve_eor(z3, __ H, p3, z7);                      \/\/       eor     z3.h, p3\/m, z3.h, z7.h\n-    __ sve_lsl(z14, __ H, p4, z4);                     \/\/       lsl     z14.h, p4\/m, z14.h, z4.h\n-    __ sve_lsr(z29, __ H, p1, z0);                     \/\/       lsr     z29.h, p1\/m, z29.h, z0.h\n-    __ sve_mul(z21, __ B, p6, z3);                     \/\/       mul     z21.b, p6\/m, z21.b, z3.b\n-    __ sve_neg(z9, __ H, p4, z28);                     \/\/       neg     z9.h, p4\/m, z28.h\n-    __ sve_not(z24, __ B, p1, z19);                    \/\/       not     z24.b, p1\/m, z19.b\n-    __ sve_orr(z23, __ S, p7, z13);                    \/\/       orr     z23.s, p7\/m, z23.s, z13.s\n-    __ sve_rbit(z10, __ S, p6, z12);                   \/\/       rbit    z10.s, p6\/m, z12.s\n-    __ sve_revb(z30, __ H, p4, z14);                   \/\/       revb    z30.h, p4\/m, z14.h\n-    __ sve_smax(z29, __ S, p4, z21);                   \/\/       smax    z29.s, p4\/m, z29.s, z21.s\n-    __ sve_smin(z7, __ B, p5, z2);                     \/\/       smin    z7.b, p5\/m, z7.b, z2.b\n-    __ sve_sub(z26, __ S, p4, z9);                     \/\/       sub     z26.s, p4\/m, z26.s, z9.s\n-    __ sve_fabs(z17, __ S, p5, z0);                    \/\/       fabs    z17.s, p5\/m, z0.s\n-    __ sve_fadd(z2, __ S, p6, z14);                    \/\/       fadd    z2.s, p6\/m, z2.s, z14.s\n-    __ sve_fdiv(z11, __ D, p5, z14);                   \/\/       fdiv    z11.d, p5\/m, z11.d, z14.d\n-    __ sve_fmax(z29, __ S, p3, z3);                    \/\/       fmax    z29.s, p3\/m, z29.s, z3.s\n-    __ sve_fmin(z22, __ D, p2, z3);                    \/\/       fmin    z22.d, p2\/m, z22.d, z3.d\n-    __ sve_fmul(z27, __ D, p0, z19);                   \/\/       fmul    z27.d, p0\/m, z27.d, z19.d\n-    __ sve_fneg(z7, __ S, p6, z21);                    \/\/       fneg    z7.s, p6\/m, z21.s\n-    __ sve_frintm(z5, __ S, p2, z25);                  \/\/       frintm  z5.s, p2\/m, z25.s\n-    __ sve_frintn(z21, __ S, p4, z17);                 \/\/       frintn  z21.s, p4\/m, z17.s\n-    __ sve_frintp(z3, __ S, p2, z19);                  \/\/       frintp  z3.s, p2\/m, z19.s\n-    __ sve_fsqrt(z7, __ D, p3, z14);                   \/\/       fsqrt   z7.d, p3\/m, z14.d\n-    __ sve_fsub(z17, __ D, p2, z13);                   \/\/       fsub    z17.d, p2\/m, z17.d, z13.d\n-    __ sve_fmad(z17, __ D, p7, z17, z8);               \/\/       fmad    z17.d, p7\/m, z17.d, z8.d\n-    __ sve_fmla(z14, __ D, p6, z22, z27);              \/\/       fmla    z14.d, p6\/m, z22.d, z27.d\n-    __ sve_fmls(z7, __ D, p2, z5, z27);                \/\/       fmls    z7.d, p2\/m, z5.d, z27.d\n-    __ sve_fmsb(z10, __ D, p0, z14, z24);              \/\/       fmsb    z10.d, p0\/m, z14.d, z24.d\n-    __ sve_fnmad(z20, __ D, p0, z3, z22);              \/\/       fnmad   z20.d, p0\/m, z3.d, z22.d\n-    __ sve_fnmsb(z5, __ D, p6, z29, z17);              \/\/       fnmsb   z5.d, p6\/m, z29.d, z17.d\n-    __ sve_fnmla(z1, __ S, p3, z14, z29);              \/\/       fnmla   z1.s, p3\/m, z14.s, z29.s\n-    __ sve_fnmls(z0, __ D, p4, z2, z30);               \/\/       fnmls   z0.d, p4\/m, z2.d, z30.d\n-    __ sve_mla(z22, __ H, p5, z29, z12);               \/\/       mla     z22.h, p5\/m, z29.h, z12.h\n-    __ sve_mls(z2, __ S, p0, z14, z23);                \/\/       mls     z2.s, p0\/m, z14.s, z23.s\n-    __ sve_and(z0, z19, z25);                          \/\/       and     z0.d, z19.d, z25.d\n-    __ sve_eor(z23, z12, z21);                         \/\/       eor     z23.d, z12.d, z21.d\n-    __ sve_orr(z1, z1, z10);                           \/\/       orr     z1.d, z1.d, z10.d\n-    __ sve_bic(z11, z19, z23);                         \/\/       bic     z11.d, z19.d, z23.d\n-    __ sve_uzp1(z8, __ S, z30, z17);                   \/\/       uzp1    z8.s, z30.s, z17.s\n-    __ sve_uzp2(z19, __ S, z20, z4);                   \/\/       uzp2    z19.s, z20.s, z4.s\n-    __ sve_fabd(z13, __ D, p7, z22);                   \/\/       fabd    z13.d, p7\/m, z13.d, z22.d\n-    __ sve_bext(z30, __ S, z25, z17);                  \/\/       bext    z30.s, z25.s, z17.s\n-    __ sve_bdep(z14, __ D, z11, z12);                  \/\/       bdep    z14.d, z11.d, z12.d\n+    __ sve_add(z14, __ D, z24, z17);                   \/\/       add     z14.d, z24.d, z17.d\n+    __ sve_sub(z21, __ B, z4, z30);                    \/\/       sub     z21.b, z4.b, z30.b\n+    __ sve_fadd(z10, __ S, z19, z12);                  \/\/       fadd    z10.s, z19.s, z12.s\n+    __ sve_fmul(z9, __ D, z7, z24);                    \/\/       fmul    z9.d, z7.d, z24.d\n+    __ sve_fsub(z4, __ S, z27, z6);                    \/\/       fsub    z4.s, z27.s, z6.s\n+    __ sve_abs(z27, __ S, p6, z13);                    \/\/       abs     z27.s, p6\/m, z13.s\n+    __ sve_add(z30, __ S, p5, z22);                    \/\/       add     z30.s, p5\/m, z30.s, z22.s\n+    __ sve_and(z30, __ H, p7, z9);                     \/\/       and     z30.h, p7\/m, z30.h, z9.h\n+    __ sve_asr(z19, __ D, p1, z20);                    \/\/       asr     z19.d, p1\/m, z19.d, z20.d\n+    __ sve_bic(z9, __ H, p2, z13);                     \/\/       bic     z9.h, p2\/m, z9.h, z13.h\n+    __ sve_clz(z19, __ H, p0, z24);                    \/\/       clz     z19.h, p0\/m, z24.h\n+    __ sve_cnt(z19, __ S, p3, z17);                    \/\/       cnt     z19.s, p3\/m, z17.s\n+    __ sve_eor(z16, __ B, p1, z0);                     \/\/       eor     z16.b, p1\/m, z16.b, z0.b\n+    __ sve_lsl(z11, __ H, p2, z15);                    \/\/       lsl     z11.h, p2\/m, z11.h, z15.h\n+    __ sve_lsr(z15, __ D, p1, z15);                    \/\/       lsr     z15.d, p1\/m, z15.d, z15.d\n+    __ sve_mul(z5, __ S, p0, z10);                     \/\/       mul     z5.s, p0\/m, z5.s, z10.s\n+    __ sve_neg(z26, __ H, p0, z0);                     \/\/       neg     z26.h, p0\/m, z0.h\n+    __ sve_not(z19, __ D, p7, z10);                    \/\/       not     z19.d, p7\/m, z10.d\n+    __ sve_orr(z3, __ D, p5, z7);                      \/\/       orr     z3.d, p5\/m, z3.d, z7.d\n+    __ sve_rbit(z28, __ H, p3, z21);                   \/\/       rbit    z28.h, p3\/m, z21.h\n+    __ sve_revb(z26, __ D, p3, z17);                   \/\/       revb    z26.d, p3\/m, z17.d\n+    __ sve_smax(z17, __ D, p3, z2);                    \/\/       smax    z17.d, p3\/m, z17.d, z2.d\n+    __ sve_smin(z16, __ B, p5, z20);                   \/\/       smin    z16.b, p5\/m, z16.b, z20.b\n+    __ sve_sub(z19, __ D, p0, z1);                     \/\/       sub     z19.d, p0\/m, z19.d, z1.d\n+    __ sve_fabs(z17, __ D, p2, z16);                   \/\/       fabs    z17.d, p2\/m, z16.d\n+    __ sve_fadd(z21, __ S, p0, z4);                    \/\/       fadd    z21.s, p0\/m, z21.s, z4.s\n+    __ sve_fdiv(z23, __ S, p3, z6);                    \/\/       fdiv    z23.s, p3\/m, z23.s, z6.s\n+    __ sve_fmax(z20, __ D, p3, z16);                   \/\/       fmax    z20.d, p3\/m, z20.d, z16.d\n+    __ sve_fmin(z12, __ D, p0, z3);                    \/\/       fmin    z12.d, p0\/m, z12.d, z3.d\n+    __ sve_fmul(z9, __ D, p0, z24);                    \/\/       fmul    z9.d, p0\/m, z9.d, z24.d\n+    __ sve_fneg(z3, __ S, p4, z22);                    \/\/       fneg    z3.s, p4\/m, z22.s\n+    __ sve_frintm(z25, __ S, p5, z13);                 \/\/       frintm  z25.s, p5\/m, z13.s\n+    __ sve_frintn(z7, __ D, p6, z5);                   \/\/       frintn  z7.d, p6\/m, z5.d\n+    __ sve_frintp(z17, __ S, p4, z0);                  \/\/       frintp  z17.s, p4\/m, z0.s\n+    __ sve_fsqrt(z9, __ S, p5, z11);                   \/\/       fsqrt   z9.s, p5\/m, z11.s\n+    __ sve_fsub(z11, __ D, p3, z17);                   \/\/       fsub    z11.d, p3\/m, z11.d, z17.d\n+    __ sve_fmad(z11, __ D, p3, z24, z17);              \/\/       fmad    z11.d, p3\/m, z24.d, z17.d\n+    __ sve_fmla(z17, __ D, p2, z15, z14);              \/\/       fmla    z17.d, p2\/m, z15.d, z14.d\n+    __ sve_fmls(z22, __ S, p7, z22, z7);               \/\/       fmls    z22.s, p7\/m, z22.s, z7.s\n+    __ sve_fmsb(z5, __ S, p7, z27, z10);               \/\/       fmsb    z5.s, p7\/m, z27.s, z10.s\n+    __ sve_fnmad(z14, __ S, p6, z21, z20);             \/\/       fnmad   z14.s, p6\/m, z21.s, z20.s\n+    __ sve_fnmsb(z3, __ D, p5, z25, z5);               \/\/       fnmsb   z3.d, p5\/m, z25.d, z5.d\n+    __ sve_fnmla(z29, __ S, p4, z17, z1);              \/\/       fnmla   z29.s, p4\/m, z17.s, z1.s\n+    __ sve_fnmls(z14, __ D, p7, z13, z0);              \/\/       fnmls   z14.d, p7\/m, z13.d, z0.d\n+    __ sve_mla(z2, __ S, p7, z20, z22);                \/\/       mla     z2.s, p7\/m, z20.s, z22.s\n+    __ sve_mls(z29, __ B, p3, z8, z2);                 \/\/       mls     z29.b, p3\/m, z8.b, z2.b\n+    __ sve_and(z14, z23, z22);                         \/\/       and     z14.d, z23.d, z22.d\n+    __ sve_eor(z19, z25, z26);                         \/\/       eor     z19.d, z25.d, z26.d\n+    __ sve_orr(z12, z21, z21);                         \/\/       orr     z12.d, z21.d, z21.d\n+    __ sve_bic(z1, z10, z19);                          \/\/       bic     z1.d, z10.d, z19.d\n+    __ sve_uzp1(z19, __ H, z23, z23);                  \/\/       uzp1    z19.h, z23.h, z23.h\n+    __ sve_uzp2(z30, __ S, z17, z19);                  \/\/       uzp2    z30.s, z17.s, z19.s\n+    __ sve_fabd(z20, __ S, p1, z20);                   \/\/       fabd    z20.s, p1\/m, z20.s, z20.s\n+    __ sve_bext(z30, __ D, z22, z30);                  \/\/       bext    z30.d, z22.d, z30.d\n+    __ sve_bdep(z25, __ H, z17, z17);                  \/\/       bdep    z25.h, z17.h, z17.h\n@@ -1217,9 +1215,9 @@\n-    __ sve_andv(v20, __ H, p1, z1);                    \/\/       andv h20, p1, z1.h\n-    __ sve_orv(v13, __ H, p0, z7);                     \/\/       orv h13, p0, z7.h\n-    __ sve_eorv(v11, __ D, p4, z4);                    \/\/       eorv d11, p4, z4.d\n-    __ sve_smaxv(v15, __ D, p0, z3);                   \/\/       smaxv d15, p0, z3.d\n-    __ sve_sminv(v0, __ S, p5, z5);                    \/\/       sminv s0, p5, z5.s\n-    __ sve_fminv(v30, __ S, p7, z13);                  \/\/       fminv s30, p7, z13.s\n-    __ sve_fmaxv(v8, __ S, p3, z29);                   \/\/       fmaxv s8, p3, z29.s\n-    __ sve_fadda(v14, __ S, p7, z3);                   \/\/       fadda s14, p7, s14, z3.s\n-    __ sve_uaddv(v25, __ H, p2, z24);                  \/\/       uaddv d25, p2, z24.h\n+    __ sve_andv(v11, __ S, p3, z28);                   \/\/       andv s11, p3, z28.s\n+    __ sve_orv(v5, __ H, p0, z13);                     \/\/       orv h5, p0, z13.h\n+    __ sve_eorv(v2, __ H, p1, z10);                    \/\/       eorv h2, p1, z10.h\n+    __ sve_smaxv(v19, __ H, p1, z25);                  \/\/       smaxv h19, p1, z25.h\n+    __ sve_sminv(v2, __ B, p0, z29);                   \/\/       sminv b2, p0, z29.b\n+    __ sve_fminv(v20, __ D, p1, z20);                  \/\/       fminv d20, p1, z20.d\n+    __ sve_fmaxv(v28, __ S, p3, z13);                  \/\/       fmaxv s28, p3, z13.s\n+    __ sve_fadda(v13, __ S, p7, z1);                   \/\/       fadda s13, p7, s13, z1.s\n+    __ sve_uaddv(v27, __ D, p0, z3);                   \/\/       uaddv d27, p0, z3.d\n@@ -1244,7 +1242,7 @@\n-    0x14000000,     0x17ffffd7,     0x14000401,     0x94000000,\n-    0x97ffffd4,     0x940003fe,     0x3400000a,     0x34fffa2a,\n-    0x34007f6a,     0x35000008,     0x35fff9c8,     0x35007f08,\n-    0xb400000b,     0xb4fff96b,     0xb4007eab,     0xb500001d,\n-    0xb5fff91d,     0xb5007e5d,     0x10000013,     0x10fff8b3,\n-    0x10007df3,     0x90000013,     0x36300016,     0x3637f836,\n-    0x36307d76,     0x3758000c,     0x375ff7cc,     0x37587d0c,\n+    0x14000000,     0x17ffffd7,     0x140003ff,     0x94000000,\n+    0x97ffffd4,     0x940003fc,     0x3400000a,     0x34fffa2a,\n+    0x34007f2a,     0x35000008,     0x35fff9c8,     0x35007ec8,\n+    0xb400000b,     0xb4fff96b,     0xb4007e6b,     0xb500001d,\n+    0xb5fff91d,     0xb5007e1d,     0x10000013,     0x10fff8b3,\n+    0x10007db3,     0x90000013,     0x36300016,     0x3637f836,\n+    0x36307d36,     0x3758000c,     0x375ff7cc,     0x37587ccc,\n@@ -1255,13 +1253,13 @@\n-    0x54007ae0,     0x54000001,     0x54fff541,     0x54007a81,\n-    0x54000002,     0x54fff4e2,     0x54007a22,     0x54000002,\n-    0x54fff482,     0x540079c2,     0x54000003,     0x54fff423,\n-    0x54007963,     0x54000003,     0x54fff3c3,     0x54007903,\n-    0x54000004,     0x54fff364,     0x540078a4,     0x54000005,\n-    0x54fff305,     0x54007845,     0x54000006,     0x54fff2a6,\n-    0x540077e6,     0x54000007,     0x54fff247,     0x54007787,\n-    0x54000008,     0x54fff1e8,     0x54007728,     0x54000009,\n-    0x54fff189,     0x540076c9,     0x5400000a,     0x54fff12a,\n-    0x5400766a,     0x5400000b,     0x54fff0cb,     0x5400760b,\n-    0x5400000c,     0x54fff06c,     0x540075ac,     0x5400000d,\n-    0x54fff00d,     0x5400754d,     0x5400000e,     0x54ffefae,\n-    0x540074ee,     0x5400000f,     0x54ffef4f,     0x5400748f,\n+    0x54007aa0,     0x54000001,     0x54fff541,     0x54007a41,\n+    0x54000002,     0x54fff4e2,     0x540079e2,     0x54000002,\n+    0x54fff482,     0x54007982,     0x54000003,     0x54fff423,\n+    0x54007923,     0x54000003,     0x54fff3c3,     0x540078c3,\n+    0x54000004,     0x54fff364,     0x54007864,     0x54000005,\n+    0x54fff305,     0x54007805,     0x54000006,     0x54fff2a6,\n+    0x540077a6,     0x54000007,     0x54fff247,     0x54007747,\n+    0x54000008,     0x54fff1e8,     0x540076e8,     0x54000009,\n+    0x54fff189,     0x54007689,     0x5400000a,     0x54fff12a,\n+    0x5400762a,     0x5400000b,     0x54fff0cb,     0x540075cb,\n+    0x5400000c,     0x54fff06c,     0x5400756c,     0x5400000d,\n+    0x54fff00d,     0x5400750d,     0x5400000e,     0x54ffefae,\n+    0x540074ae,     0x5400000f,     0x54ffef4f,     0x5400744f,\n@@ -1333,168 +1331,168 @@\n-    0x1e214275,     0x1e21c174,     0x1e22c291,     0x1e23c1e6,\n-    0x1ee24063,     0x1e60407c,     0x1e60c1db,     0x1e61414e,\n-    0x1e61c16c,     0x1e624151,     0x1e3800f9,     0x9e3801c7,\n-    0x1e78001c,     0x9e780016,     0x1e2202ec,     0x9e2201ad,\n-    0x1e6201c7,     0x9e620107,     0x1e240234,     0x9e6403dc,\n-    0x1e300050,     0x9e700209,     0x1e2603b4,     0x9e660024,\n-    0x1e27031a,     0x9e6701d7,     0x1e2c22a0,     0x1e6c20a0,\n-    0x1e202308,     0x1e602308,     0x2910561b,     0x294436d1,\n-    0x697e3626,     0xa9366a3c,     0xa97419b5,     0x29825e7a,\n-    0x29d04144,     0x69f412ee,     0xa982321d,     0xa9c6477a,\n-    0x28b40086,     0x28c079c2,     0x68e060f7,     0xa88868a0,\n-    0xa8f62de6,     0x28302059,     0x2866383e,     0xa83701b6,\n-    0xa8403363,     0x0c40700a,     0x4cdfa22c,     0x0cc26f0a,\n-    0x4cdf2628,     0x0d40c3d7,     0x4ddfc856,     0x0dcfcfde,\n-    0x4c408cb4,     0x0cdf8538,     0x4d60c190,     0x0dffc8f7,\n-    0x4de3ce1a,     0x4cc74979,     0x0c40499e,     0x4d40e52f,\n-    0x4ddfe8de,     0x0dcdeee7,     0x4cdf04c4,     0x0ccf0264,\n-    0x0d60e1d9,     0x0dffe79a,     0x0de6e8b9,     0x0e31b9ee,\n-    0x4e31b96a,     0x0e71b9cd,     0x4e71b9ee,     0x4eb1bab4,\n-    0x0e30a841,     0x4e30aaf6,     0x0e70abfe,     0x4e70a9ee,\n-    0x4eb0a862,     0x6e30f8e6,     0x0e31a883,     0x2e31a907,\n-    0x4e31ab38,     0x6e31a820,     0x0e71ab9b,     0x2e71abdd,\n-    0x4e71a8c5,     0x6e71a8c5,     0x4eb1abdd,     0x6eb1a98b,\n-    0x6eb0fb59,     0x7e30f820,     0x7e70fbfe,     0x7eb0f820,\n-    0x7ef0fa51,     0x0e20bbbc,     0x4e20bb59,     0x0e60b949,\n-    0x4e60bb59,     0x0ea0b9ac,     0x4ea0ba0f,     0x4ee0b98b,\n-    0x0ea0f96a,     0x4ea0fa51,     0x4ee0fb38,     0x2ea0fad5,\n-    0x6ea0fb17,     0x6ee0f820,     0x2ea1fa30,     0x6ea1f96a,\n-    0x6ee1f8e6,     0x2e205bbc,     0x6e2058e6,     0x0e271cc5,\n-    0x4e271cc5,     0x0eb61eb4,     0x4eb31e51,     0x2e311e0f,\n-    0x6e331e51,     0x0e3f87dd,     0x4e3c877a,     0x0e7e87bc,\n-    0x4e638441,     0x0ebd879b,     0x4ea28420,     0x4ef686b4,\n-    0x0e3ed7bc,     0x4e31d60f,     0x4e6ed5ac,     0x2e2c856a,\n-    0x6e3e87bc,     0x2e7e87bc,     0x6e758693,     0x2eb886f6,\n-    0x6eac856a,     0x6ee684a4,     0x0ea0d7fe,     0x4eb6d6b4,\n-    0x4eead528,     0x0e209ffe,     0x4e339e51,     0x0e6c9d6a,\n-    0x4e7d9f9b,     0x0ea49c62,     0x4eba9f38,     0x2ea6d4a4,\n-    0x6ea5d483,     0x6eead528,     0x2e38def6,     0x6e33de51,\n-    0x6e6fddcd,     0x0e6694a4,     0x4e7e97bc,     0x0eb99717,\n-    0x4eb796d5,     0x0e3bcf59,     0x4e3acf38,     0x4e65cc83,\n-    0x2e799717,     0x6e7c977a,     0x2eb99717,     0x6eb095ee,\n-    0x0eb7ced5,     0x4ea5cc83,     0x4ef9cf17,     0x2e2afd28,\n-    0x6e3aff38,     0x6e75fe93,     0x0e31660f,     0x4e326630,\n-    0x0e646462,     0x4e636441,     0x0ea26420,     0x4eba6738,\n-    0x0e26a4a4,     0x4e25a483,     0x0e6da58b,     0x4e60a7fe,\n-    0x0ebda79b,     0x4eaba549,     0x0e3bf759,     0x4e24f462,\n-    0x4e6ef5ac,     0x0e336e51,     0x4e206ffe,     0x0e636c41,\n-    0x4e6e6dac,     0x0ebe6fbc,     0x4ea26c20,     0x0e33ae51,\n-    0x4e2eadac,     0x0e73ae51,     0x4e77aed5,     0x0eaeadac,\n-    0x4ebdaf9b,     0x0ebff7dd,     0x4ea0f7fe,     0x4ee3f441,\n-    0x2e3b8f59,     0x6e3d8f9b,     0x2e668ca4,     0x6e7f8fdd,\n-    0x2ea58c83,     0x6ea88ce6,     0x6eff8fdd,     0x0e3be759,\n-    0x4e33e651,     0x4e6ae528,     0x0e293507,     0x4e2e35ac,\n-    0x0e623420,     0x4e753693,     0x0ea33441,     0x4eb93717,\n-    0x4ee43462,     0x2e223420,     0x6e2a3528,     0x2e793717,\n-    0x6e7b3759,     0x2eb1360f,     0x6ebf37dd,     0x6ee53483,\n-    0x2e2c3d6a,     0x6e383ef6,     0x2e6c3d6a,     0x6e663ca4,\n-    0x2eb33e51,     0x6ea33c41,     0x6eed3d8b,     0x2ea9e507,\n-    0x6eace56a,     0x6ef1e60f,     0x0e323e30,     0x4e243c62,\n-    0x0e6b3d49,     0x4e6d3d8b,     0x0eae3dac,     0x4eb03dee,\n-    0x4eef3dcd,     0x2e24e462,     0x6e28e4e6,     0x6e75e693,\n-    0x2ebbef59,     0x6eb1ee0f,     0x6ee6eca4,     0x65923081,\n-    0x65d02a1a,     0x65903aca,     0x65912b8b,     0x65913c3c,\n-    0x659321e5,     0xba5fd3e3,     0x3a5f03e5,     0xfa411be4,\n-    0x7a42cbe2,     0x93df03ff,     0xc820ffff,     0x8822fc7f,\n-    0xc8247cbf,     0x88267fff,     0x4e010fe0,     0x5e040420,\n-    0x4e081fe1,     0x4e0c1fe1,     0x4e0a1fe1,     0x4e071fe1,\n-    0x4e042c20,     0x4e062c20,     0x4e052c20,     0x4e083c20,\n-    0x0e0c3c20,     0x0e0a3c20,     0x0e073c20,     0x9eae0020,\n-    0x0f03f409,     0x6f03f40e,     0x4cc0ac3f,     0x0ea1b820,\n-    0x4e21c862,     0x4e61b8a4,     0x05a08020,     0x05104fe0,\n-    0x05505001,     0x05906fe2,     0x05d03005,     0x05101fea,\n-    0x05901feb,     0x04b0e3e0,     0x0470e7e1,     0x042f9c20,\n-    0x043f9c35,     0x047f9c20,     0x04ff9c20,     0x04299420,\n-    0x04319160,     0x0461943e,     0x04a19020,     0x04038100,\n-    0x040381a0,     0x040387e1,     0x04438be2,     0x04c38fe3,\n-    0x040181e0,     0x04018100,     0x04018621,     0x04418b22,\n-    0x04418822,     0x04818c23,     0x040081e0,     0x04008120,\n-    0x04008761,     0x04008621,     0x04408822,     0x04808c23,\n-    0x042053ff,     0x047f5401,     0x25208028,     0x2538cfe0,\n-    0x2578d001,     0x25b8efe2,     0x25f8f007,     0x2538dfea,\n-    0x25b8dfeb,     0xa400a3e0,     0xa420a7e0,     0xa4484be0,\n-    0xa467afe0,     0xa4a8a7ea,     0xa547a814,     0xa4084ffe,\n-    0xa55c53e0,     0xa5e1540b,     0xe400fbf6,     0xe408ffff,\n-    0xe420e7e0,     0xe4484be0,     0xe460efe0,     0xe547e400,\n-    0xe4014be0,     0xe4a84fe0,     0xe5f15000,     0x858043e0,\n-    0x85a043ff,     0xe59f5d08,     0x0420e3e9,     0x0460e3ea,\n-    0x04a0e3eb,     0x04e0e3ec,     0x25104042,     0x25104871,\n-    0x25904861,     0x25904c92,     0x05344020,     0x05744041,\n-    0x05b44062,     0x05f44083,     0x252c8840,     0x253c1420,\n-    0x25681572,     0x25a21ce3,     0x25ea1e34,     0x253c0421,\n-    0x25680572,     0x25a20ce3,     0x25ea0e34,     0x0522c020,\n-    0x05e6c0a4,     0x2401a001,     0x2443a051,     0x24858881,\n-    0x24c78cd1,     0x24850891,     0x24c70cc1,     0x250f9001,\n-    0x25508051,     0x25802491,     0x25df28c1,     0x25850c81,\n-    0x251e10d1,     0x65816001,     0x65c36051,     0x65854891,\n-    0x65c74cc1,     0x05733820,     0x05b238a4,     0x05f138e6,\n-    0x0570396a,     0x65d0a001,     0x65d6a443,     0x65d4a826,\n-    0x6594ac26,     0x6554ac26,     0x6556ac26,     0x6552ac26,\n-    0x65cbac85,     0x65caac01,     0x65dea833,     0x659ca509,\n-    0x65d8a801,     0x65dcac01,     0x655cb241,     0x0520a1e0,\n-    0x0521a601,     0x052281e0,     0x05238601,     0x04a14026,\n-    0x042244a6,     0x046344a6,     0x04a444a6,     0x04e544a7,\n-    0x0568aca7,     0x05b23230,     0x853040af,     0xc5b040af,\n-    0xe57080af,     0xe5b080af,     0x25034440,     0x254054c4,\n-    0x25034640,     0x25415a05,     0x25834440,     0x25c54489,\n-    0x250b5d3a,     0x2550dc20,     0x2518e3e1,     0x2518e021,\n-    0x2518e0a1,     0x2518e121,     0x2518e1a1,     0x2558e3e2,\n-    0x2558e042,     0x2558e0c2,     0x2558e142,     0x2598e3e3,\n-    0x2598e063,     0x2598e0e3,     0x2598e163,     0x25d8e3e4,\n-    0x25d8e084,     0x25d8e104,     0x25d8e184,     0x2518e407,\n-    0x05214800,     0x05614800,     0x05a14800,     0x05e14800,\n-    0x05214c00,     0x05614c00,     0x05a14c00,     0x05e14c00,\n-    0x05304001,     0x05314001,     0x05a18610,     0x05e18610,\n-    0x05271e11,     0x6545e891,     0x6585e891,     0x65c5e891,\n-    0x6545c891,     0x6585c891,     0x65c5c891,     0x45b0c210,\n-    0x45f1c231,     0x1e601000,     0x1e603000,     0x1e621000,\n-    0x1e623000,     0x1e641000,     0x1e643000,     0x1e661000,\n-    0x1e663000,     0x1e681000,     0x1e683000,     0x1e6a1000,\n-    0x1e6a3000,     0x1e6c1000,     0x1e6c3000,     0x1e6e1000,\n-    0x1e6e3000,     0x1e701000,     0x1e703000,     0x1e721000,\n-    0x1e723000,     0x1e741000,     0x1e743000,     0x1e761000,\n-    0x1e763000,     0x1e781000,     0x1e783000,     0x1e7a1000,\n-    0x1e7a3000,     0x1e7c1000,     0x1e7c3000,     0x1e7e1000,\n-    0x1e7e3000,     0xf823826d,     0xf8310070,     0xf82113cb,\n-    0xf82521e8,     0xf83d301e,     0xf8345287,     0xf83742bc,\n-    0xf83b70b9,     0xf8216217,     0xf8bf8185,     0xf8a901fc,\n-    0xf8bd13f6,     0xf8b320bf,     0xf8ae33f0,     0xf8b0529b,\n-    0xf8b0416c,     0xf8a973c6,     0xf8b1639b,     0xf8fe8147,\n-    0xf8f4008a,     0xf8f81231,     0xf8f623a3,     0xf8ef3276,\n-    0xf8f35056,     0xf8ef4186,     0xf8f071ab,     0xf8f763c1,\n-    0xf8738225,     0xf86202d0,     0xf86d12aa,     0xf87d219b,\n-    0xf87b3023,     0xf87f5278,     0xf8714389,     0xf87b70ef,\n-    0xf87563f7,     0xb83983e2,     0xb83b0150,     0xb8371073,\n-    0xb8302320,     0xb83a3057,     0xb830508c,     0xb83c43be,\n-    0xb83070db,     0xb82961fd,     0xb8a780e4,     0xb8af02e9,\n-    0xb8a81382,     0xb8b520bf,     0xb8bb3220,     0xb8af5344,\n-    0xb8a842dc,     0xb8bb733b,     0xb8b76080,     0xb8e68010,\n-    0xb8e4002f,     0xb8ea10a7,     0xb8ea20fc,     0xb8f432b7,\n-    0xb8e6510b,     0xb8f140df,     0xb8f17182,     0xb8fe607d,\n-    0xb87b83b6,     0xb86e038d,     0xb87110b8,     0xb862214e,\n-    0xb870336b,     0xb877508c,     0xb8764091,     0xb8617213,\n-    0xb87061cd,     0xce300c4c,     0xce051af4,     0xce6c8e27,\n-    0xce90361b,     0xce638382,     0xce7184c4,     0xcec081b3,\n-    0xce688a6c,     0x25a0d358,     0x2561d880,     0x05809a06,\n-    0x05403e90,     0x0500546e,     0x25a0d54a,     0x25e1c2d6,\n-    0x05801583,     0x05403e87,     0x05001580,     0x2520d056,\n-    0x25a1cb89,     0x05800e59,     0x0540e08d,     0x05000d2d,\n-    0x2560c4f9,     0x25a1c864,     0x05830746,     0x054394b0,\n-    0x05003ece,     0x2520c143,     0x25a1d2da,     0x058015ce,\n-    0x05400ed8,     0x0500bb31,     0x25a0c074,     0x25a1d884,\n-    0x05804944,     0x0540b1d9,     0x05001548,     0x04e402be,\n-    0x04730541,     0x65c70120,     0x659b0891,     0x65970769,\n-    0x0496bed0,     0x04401f94,     0x049a14ed,     0x0450897c,\n-    0x04db142b,     0x0499b1a8,     0x041ab091,     0x04590ce3,\n-    0x0453908e,     0x0451841d,     0x04101875,     0x0457b389,\n-    0x041ea678,     0x04981db7,     0x05a7998a,     0x056491de,\n-    0x048812bd,     0x040a1447,     0x0481113a,     0x049cb411,\n-    0x658099c2,     0x65cd95cb,     0x65868c7d,     0x65c78876,\n-    0x65c2827b,     0x049dbaa7,     0x6582ab25,     0x6580b235,\n-    0x6581aa63,     0x65cdadc7,     0x65c189b1,     0x65e89e31,\n-    0x65fb1ace,     0x65fb28a7,     0x65f8a1ca,     0x65f6c074,\n-    0x65f1fba5,     0x65bd4dc1,     0x65fe7040,     0x044c57b6,\n-    0x049761c2,     0x04393260,     0x04b53197,     0x046a3021,\n-    0x04f7326b,     0x05b16bc8,     0x05a46e93,     0x65c89ecd,\n-    0x4591b33e,     0x45ccb56e,     0x045a2434,     0x045820ed,\n-    0x04d9308b,     0x04c8206f,     0x048a34a0,     0x65873dbe,\n-    0x65862fa8,     0x65983c6e,     0x04412b19,\n+    0x1e214275,     0x1e21c174,     0x1e22c291,     0x1e6041e6,\n+    0x1e60c063,     0x1e61407c,     0x1e61c1db,     0x1e62414e,\n+    0x1e38016c,     0x9e380151,     0x1e7800f9,     0x9e7801c7,\n+    0x1e22001c,     0x9e220016,     0x1e6202ec,     0x9e6201ad,\n+    0x1e2401c7,     0x9e640107,     0x1e300234,     0x9e7003dc,\n+    0x1e260050,     0x9e660209,     0x1e2703b4,     0x9e670024,\n+    0x1e382340,     0x1e6e22e0,     0x1e2022a8,     0x1e602188,\n+    0x2928630c,     0x29501616,     0x694e4db4,     0xa90619b1,\n+    0xa9760625,     0x29a652cd,     0x29ca6d5e,     0x69c2534d,\n+    0xa9bb5fa4,     0xa9f900d6,     0x288a6cb1,     0x28e02e0e,\n+    0x68e25d2c,     0xa8821c17,     0xa8c52351,     0x282a3d4b,\n+    0x28484093,     0xa831393e,     0xa8425e9d,     0x0c407365,\n+    0x4cdfa32a,     0x0cd36fcf,     0x4cdf2611,     0x0d40c2fe,\n+    0x4ddfc911,     0x0dc3cd2c,     0x4c408c53,     0x0cdf8515,\n+    0x4d60c08d,     0x0dffc87c,     0x4de0cfbd,     0x4cd54827,\n+    0x0c404811,     0x4d40e4ba,     0x4ddfe839,     0x0dddec56,\n+    0x4cdf076d,     0x0cd7031d,     0x0d60e1ed,     0x0dffe5cf,\n+    0x0df7ea9b,     0x0e31bb38,     0x4e31ba0f,     0x0e71bb59,\n+    0x4e71b9ee,     0x4eb1b96a,     0x0e30a9cd,     0x4e30a9ee,\n+    0x0e70aab4,     0x4e70a841,     0x4eb0aaf6,     0x6e30fbfe,\n+    0x0e31a9ee,     0x2e31a862,     0x4e31a8e6,     0x6e31a883,\n+    0x0e71a907,     0x2e71ab38,     0x4e71a820,     0x6e71ab9b,\n+    0x4eb1abdd,     0x6eb1a8c5,     0x6eb0f8c5,     0x7e30fbdd,\n+    0x7e70f98b,     0x7eb0fb59,     0x7ef0f820,     0x0e20bbfe,\n+    0x4e20b820,     0x0e60ba51,     0x4e60bbbc,     0x0ea0bb59,\n+    0x4ea0b949,     0x4ee0bb59,     0x0ea0f9ac,     0x4ea0fa0f,\n+    0x4ee0f98b,     0x2ea0f96a,     0x6ea0fa51,     0x6ee0fb38,\n+    0x2ea1fad5,     0x6ea1fb17,     0x6ee1f820,     0x2e205a30,\n+    0x6e20596a,     0x0e281ce6,     0x4e3e1fbc,     0x0ea81ce6,\n+    0x4ea71cc5,     0x2e271cc5,     0x6e361eb4,     0x0e338651,\n+    0x4e31860f,     0x0e738651,     0x4e7f87dd,     0x0ebc877a,\n+    0x4ebe87bc,     0x4ee38441,     0x0e3dd79b,     0x4e22d420,\n+    0x4e76d6b4,     0x2e3e87bc,     0x6e31860f,     0x2e6e85ac,\n+    0x6e6c856a,     0x2ebe87bc,     0x6ebe87bc,     0x6ef58693,\n+    0x0eb8d6f6,     0x4eacd56a,     0x4ee6d4a4,     0x0e209ffe,\n+    0x4e369eb4,     0x0e6a9d28,     0x4e609ffe,     0x0eb39e51,\n+    0x4eac9d6a,     0x2ebdd79b,     0x6ea4d462,     0x6efad738,\n+    0x2e26dca4,     0x6e25dc83,     0x6e6add28,     0x0e7896f6,\n+    0x4e739651,     0x0eaf95cd,     0x4ea694a4,     0x0e3ecfbc,\n+    0x4e39cf17,     0x4e77ced5,     0x2e7b9759,     0x6e7a9738,\n+    0x2ea59483,     0x6eb99717,     0x0ebccf7a,     0x4eb9cf17,\n+    0x4ef0cdee,     0x2e37fed5,     0x6e25fc83,     0x6e79ff17,\n+    0x0e2a6528,     0x4e3a6738,     0x0e756693,     0x4e71660f,\n+    0x0eb26630,     0x4ea46462,     0x0e23a441,     0x4e22a420,\n+    0x0e7aa738,     0x4e66a4a4,     0x0ea5a483,     0x4eada58b,\n+    0x0e20f7fe,     0x4e3df79b,     0x4e6bf549,     0x0e3b6f59,\n+    0x4e246c62,     0x0e6e6dac,     0x4e736e51,     0x0ea06ffe,\n+    0x4ea36c41,     0x0e2eadac,     0x4e3eafbc,     0x0e62ac20,\n+    0x4e73ae51,     0x0eaeadac,     0x4eb3ae51,     0x0eb7f6d5,\n+    0x4eaef5ac,     0x4efdf79b,     0x2e3f8fdd,     0x6e208ffe,\n+    0x2e638c41,     0x6e7b8f59,     0x2ebd8f9b,     0x6ea68ca4,\n+    0x6eff8fdd,     0x0e25e483,     0x4e28e4e6,     0x4e7fe7dd,\n+    0x0e3b3759,     0x4e333651,     0x0e6a3528,     0x4e693507,\n+    0x0eae35ac,     0x4ea23420,     0x4ef53693,     0x2e233441,\n+    0x6e393717,     0x2e643462,     0x6e623420,     0x2eaa3528,\n+    0x6eb93717,     0x6efb3759,     0x2e313e0f,     0x6e3f3fdd,\n+    0x2e653c83,     0x6e6c3d6a,     0x2eb83ef6,     0x6eac3d6a,\n+    0x6ee63ca4,     0x2eb3e651,     0x6ea3e441,     0x6eede58b,\n+    0x0e293d07,     0x4e2c3d6a,     0x0e713e0f,     0x4e723e30,\n+    0x0ea43c62,     0x4eab3d49,     0x4eed3d8b,     0x2e2ee5ac,\n+    0x6e30e5ee,     0x6e6fe5cd,     0x2ea4ec62,     0x6ea8ece6,\n+    0x6ef5ee93,     0x659221ed,     0x65d03572,     0x65903628,\n+    0x65d1358b,     0x659139de,     0x65d32960,     0xba5fd3e3,\n+    0x3a5f03e5,     0xfa411be4,     0x7a42cbe2,     0x93df03ff,\n+    0xc820ffff,     0x8822fc7f,     0xc8247cbf,     0x88267fff,\n+    0x4e010fe0,     0x5e040420,     0x4e081fe1,     0x4e0c1fe1,\n+    0x4e0a1fe1,     0x4e071fe1,     0x4e042c20,     0x4e062c20,\n+    0x4e052c20,     0x4e083c20,     0x0e0c3c20,     0x0e0a3c20,\n+    0x0e073c20,     0x9eae0020,     0x0f03f409,     0x6f03f40e,\n+    0x4cc0ac3f,     0x0ea1b820,     0x4e21c862,     0x4e61b8a4,\n+    0x05a08020,     0x05104fe0,     0x05505001,     0x05906fe2,\n+    0x05d03005,     0x05101fea,     0x05901feb,     0x04b0e3e0,\n+    0x0470e7e1,     0x042f9c20,     0x043f9c35,     0x047f9c20,\n+    0x04ff9c20,     0x04299420,     0x04319160,     0x0461943e,\n+    0x04a19020,     0x04038100,     0x040381a0,     0x040387e1,\n+    0x04438be2,     0x04c38fe3,     0x040181e0,     0x04018100,\n+    0x04018621,     0x04418b22,     0x04418822,     0x04818c23,\n+    0x040081e0,     0x04008120,     0x04008761,     0x04008621,\n+    0x04408822,     0x04808c23,     0x042053ff,     0x047f5401,\n+    0x25208028,     0x2538cfe0,     0x2578d001,     0x25b8efe2,\n+    0x25f8f007,     0x2538dfea,     0x25b8dfeb,     0xa400a3e0,\n+    0xa420a7e0,     0xa4484be0,     0xa467afe0,     0xa4a8a7ea,\n+    0xa547a814,     0xa4084ffe,     0xa55c53e0,     0xa5e1540b,\n+    0xe400fbf6,     0xe408ffff,     0xe420e7e0,     0xe4484be0,\n+    0xe460efe0,     0xe547e400,     0xe4014be0,     0xe4a84fe0,\n+    0xe5f15000,     0x858043e0,     0x85a043ff,     0xe59f5d08,\n+    0x0420e3e9,     0x0460e3ea,     0x04a0e3eb,     0x04e0e3ec,\n+    0x25104042,     0x25104871,     0x25904861,     0x25904c92,\n+    0x05344020,     0x05744041,     0x05b44062,     0x05f44083,\n+    0x252c8840,     0x253c1420,     0x25681572,     0x25a21ce3,\n+    0x25ea1e34,     0x253c0421,     0x25680572,     0x25a20ce3,\n+    0x25ea0e34,     0x0522c020,     0x05e6c0a4,     0x2401a001,\n+    0x2443a051,     0x24858881,     0x24c78cd1,     0x24850891,\n+    0x24c70cc1,     0x250f9001,     0x25508051,     0x25802491,\n+    0x25df28c1,     0x25850c81,     0x251e10d1,     0x65816001,\n+    0x65c36051,     0x65854891,     0x65c74cc1,     0x05733820,\n+    0x05b238a4,     0x05f138e6,     0x0570396a,     0x65d0a001,\n+    0x65d6a443,     0x65d4a826,     0x6594ac26,     0x6554ac26,\n+    0x6556ac26,     0x6552ac26,     0x65cbac85,     0x65caac01,\n+    0x65dea833,     0x659ca509,     0x65d8a801,     0x65dcac01,\n+    0x655cb241,     0x0520a1e0,     0x0521a601,     0x052281e0,\n+    0x05238601,     0x04a14026,     0x042244a6,     0x046344a6,\n+    0x04a444a6,     0x04e544a7,     0x0568aca7,     0x05b23230,\n+    0x853040af,     0xc5b040af,     0xe57080af,     0xe5b080af,\n+    0x25034440,     0x254054c4,     0x25034640,     0x25415a05,\n+    0x25834440,     0x25c54489,     0x250b5d3a,     0x2550dc20,\n+    0x2518e3e1,     0x2518e021,     0x2518e0a1,     0x2518e121,\n+    0x2518e1a1,     0x2558e3e2,     0x2558e042,     0x2558e0c2,\n+    0x2558e142,     0x2598e3e3,     0x2598e063,     0x2598e0e3,\n+    0x2598e163,     0x25d8e3e4,     0x25d8e084,     0x25d8e104,\n+    0x25d8e184,     0x2518e407,     0x05214800,     0x05614800,\n+    0x05a14800,     0x05e14800,     0x05214c00,     0x05614c00,\n+    0x05a14c00,     0x05e14c00,     0x05304001,     0x05314001,\n+    0x05a18610,     0x05e18610,     0x05271e11,     0x6545e891,\n+    0x6585e891,     0x65c5e891,     0x6545c891,     0x6585c891,\n+    0x65c5c891,     0x45b0c210,     0x45f1c231,     0x1e601000,\n+    0x1e603000,     0x1e621000,     0x1e623000,     0x1e641000,\n+    0x1e643000,     0x1e661000,     0x1e663000,     0x1e681000,\n+    0x1e683000,     0x1e6a1000,     0x1e6a3000,     0x1e6c1000,\n+    0x1e6c3000,     0x1e6e1000,     0x1e6e3000,     0x1e701000,\n+    0x1e703000,     0x1e721000,     0x1e723000,     0x1e741000,\n+    0x1e743000,     0x1e761000,     0x1e763000,     0x1e781000,\n+    0x1e783000,     0x1e7a1000,     0x1e7a3000,     0x1e7c1000,\n+    0x1e7c3000,     0x1e7e1000,     0x1e7e3000,     0xf8308047,\n+    0xf823026d,     0xf8311070,     0xf82123cb,     0xf82531e8,\n+    0xf83d501e,     0xf8344287,     0xf83772bc,     0xf83b60b9,\n+    0xf8a18217,     0xf8bf0185,     0xf8a911fc,     0xf8bd23f6,\n+    0xf8b330bf,     0xf8ae53f0,     0xf8b0429b,     0xf8b0716c,\n+    0xf8a963c6,     0xf8f1839b,     0xf8fe0147,     0xf8f4108a,\n+    0xf8f82231,     0xf8f633a3,     0xf8ef5276,     0xf8f34056,\n+    0xf8ef7186,     0xf8f061ab,     0xf87783c1,     0xf8730225,\n+    0xf86212d0,     0xf86d22aa,     0xf87d319b,     0xf87b5023,\n+    0xf87f4278,     0xf8717389,     0xf87b60ef,     0xb83583f7,\n+    0xb83903e2,     0xb83b1150,     0xb8372073,     0xb8303320,\n+    0xb83a5057,     0xb830408c,     0xb83c73be,     0xb83060db,\n+    0xb8a981fd,     0xb8a700e4,     0xb8af12e9,     0xb8a82382,\n+    0xb8b530bf,     0xb8bb5220,     0xb8af4344,     0xb8a872dc,\n+    0xb8bb633b,     0xb8f78080,     0xb8e60010,     0xb8e4102f,\n+    0xb8ea20a7,     0xb8ea30fc,     0xb8f452b7,     0xb8e6410b,\n+    0xb8f170df,     0xb8f16182,     0xb87e807d,     0xb87b03b6,\n+    0xb86e138d,     0xb87120b8,     0xb862314e,     0xb870536b,\n+    0xb877408c,     0xb8767091,     0xb8616213,     0xce2e3191,\n+    0xce035202,     0xce668cb7,     0xce8ce227,     0xce668210,\n+    0xce638782,     0xcec080c4,     0xce6d8a71,     0x25a0c86c,\n+    0x25a1d358,     0x05800500,     0x05400ad3,     0x05000e06,\n+    0x25e0c951,     0x25a1d54a,     0x05839276,     0x0540ea6f,\n+    0x0503c8a4,     0x25a0d448,     0x2521d056,     0x058059c9,\n+    0x05406d05,     0x05003cb6,     0x25a0d0c8,     0x2561c4f9,\n+    0x05809904,     0x05400e5d,     0x0500cadd,     0x2560dda2,\n+    0x2521c143,     0x05801c3a,     0x054052a8,     0x05001845,\n+    0x25a0de96,     0x25a1c074,     0x05808864,     0x05401ed3,\n+    0x05001e33,     0x04f1030e,     0x043e0495,     0x658c026a,\n+    0x65d808e9,     0x65860764,     0x0496b9bb,     0x048016de,\n+    0x045a1d3e,     0x04d08693,     0x045b09a9,     0x0459a313,\n+    0x049aae33,     0x04190410,     0x045389eb,     0x04d185ef,\n+    0x04900145,     0x0457a01a,     0x04debd53,     0x04d814e3,\n+    0x05678ebc,     0x05e48e3a,     0x04c80c51,     0x040a1690,\n+    0x04c10033,     0x04dcaa11,     0x65808095,     0x658d8cd7,\n+    0x65c68e14,     0x65c7806c,     0x65c28309,     0x049db2c3,\n+    0x6582b5b9,     0x65c0b8a7,     0x6581b011,     0x658db569,\n+    0x65c18e2b,     0x65f18f0b,     0x65ee09f1,     0x65a73ed6,\n+    0x65aabf65,     0x65b4daae,     0x65e5f723,     0x65a1523d,\n+    0x65e07dae,     0x04965e82,     0x04026d1d,     0x043632ee,\n+    0x04ba3333,     0x047532ac,     0x04f33141,     0x05776af3,\n+    0x05b36e3e,     0x65888694,     0x45deb2de,     0x4551b639,\n+    0x049a2f8b,     0x045821a5,     0x04592542,     0x04482733,\n+    0x040a23a2,     0x65c72694,     0x65862dbc,     0x65983c2d,\n+    0x04c1207b,\n","filename":"test\/hotspot\/gtest\/aarch64\/asmtest.out.h","additions":605,"deletions":607,"binary":false,"changes":1212,"status":"modified"},{"patch":"@@ -25,1 +25,0 @@\n-#include \"classfile\/symbolTable.hpp\"\n@@ -27,0 +26,1 @@\n+#include \"classfile\/symbolTable.hpp\"\n","filename":"test\/hotspot\/gtest\/classfile\/test_symbolTable.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -25,0 +25,3 @@\n+\n+#include <locale.h>\n+\n@@ -30,2 +33,0 @@\n-#include <locale.h>\n-\n","filename":"test\/hotspot\/gtest\/compiler\/test_directivesParser.cpp","additions":3,"deletions":2,"binary":false,"changes":5,"status":"modified"},{"patch":"@@ -25,0 +25,1 @@\n+\n","filename":"test\/hotspot\/gtest\/gc\/g1\/test_freeRegionList.cpp","additions":1,"deletions":0,"binary":false,"changes":1,"status":"modified"},{"patch":"@@ -26,1 +26,0 @@\n-#include \"gc\/g1\/g1Analytics.hpp\"\n@@ -28,0 +27,1 @@\n+#include \"gc\/g1\/g1Analytics.hpp\"\n","filename":"test\/hotspot\/gtest\/gc\/g1\/test_g1Analytics.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -26,0 +26,1 @@\n+\n","filename":"test\/hotspot\/gtest\/gc\/g1\/test_g1BatchedGangTask.cpp","additions":1,"deletions":0,"binary":false,"changes":1,"status":"modified"},{"patch":"@@ -25,1 +25,0 @@\n-#include \"gc\/g1\/g1CodeCacheRemSet.hpp\"\n@@ -27,0 +26,1 @@\n+#include \"gc\/g1\/g1CodeCacheRemSet.hpp\"\n","filename":"test\/hotspot\/gtest\/gc\/g1\/test_g1CodeCacheRemSet.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -28,1 +28,0 @@\n-#include \"gc\/shared\/workerThread.hpp\"\n@@ -30,0 +29,1 @@\n+#include \"gc\/shared\/workerThread.hpp\"\n","filename":"test\/hotspot\/gtest\/gc\/g1\/test_stressCommitUncommit.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -26,1 +26,0 @@\n-#include \"gc\/parallel\/psCompactionManager.inline.hpp\"\n@@ -28,0 +27,1 @@\n+#include \"gc\/parallel\/psCompactionManager.inline.hpp\"\n","filename":"test\/hotspot\/gtest\/gc\/parallel\/test_psParallelCompact.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -28,1 +28,0 @@\n-#include \"runtime\/atomic.hpp\"\n@@ -30,0 +29,1 @@\n+#include \"runtime\/atomic.hpp\"\n","filename":"test\/hotspot\/gtest\/gc\/shared\/test_ptrQueueBufferAllocator.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -25,6 +25,0 @@\n-#include \"jni.h\"\n-#include \"runtime\/os.hpp\"\n-#include \"runtime\/thread.inline.hpp\"\n-#include \"utilities\/globalDefinitions.hpp\"\n-#include \"unittest.hpp\"\n-\n@@ -35,1 +29,1 @@\n-#include <dlfcn.h>\n+#  include <dlfcn.h>\n@@ -37,0 +31,1 @@\n+\n@@ -43,0 +38,7 @@\n+#include \"jni.h\"\n+#include \"unittest.hpp\"\n+\n+#include \"runtime\/os.hpp\"\n+#include \"runtime\/thread.inline.hpp\"\n+#include \"utilities\/globalDefinitions.hpp\"\n+\n","filename":"test\/hotspot\/gtest\/gtestMain.cpp","additions":9,"deletions":7,"binary":false,"changes":16,"status":"modified"},{"patch":"@@ -36,0 +36,2 @@\n+#include <cmath>\n+\n@@ -45,1 +47,0 @@\n-#include \"unittest.hpp\"\n@@ -47,1 +48,1 @@\n-#include <cmath>\n+#include \"unittest.hpp\"\n","filename":"test\/hotspot\/gtest\/jfr\/test_adaptiveSampler.cpp","additions":3,"deletions":2,"binary":false,"changes":5,"status":"modified"},{"patch":"@@ -35,0 +35,1 @@\n+#include \"logging\/log.hpp\"\n@@ -40,1 +41,0 @@\n-#include \"logging\/log.hpp\"\n@@ -44,0 +44,1 @@\n+\n","filename":"test\/hotspot\/gtest\/jfr\/test_networkUtilization.cpp","additions":2,"deletions":1,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -35,0 +35,1 @@\n+#include \"logging\/log.hpp\"\n@@ -40,2 +41,0 @@\n-#include \"logging\/log.hpp\"\n-#include \"runtime\/os.hpp\"\n@@ -43,0 +42,2 @@\n+#include \"runtime\/os.hpp\"\n+\n","filename":"test\/hotspot\/gtest\/jfr\/test_threadCpuLoad.cpp","additions":3,"deletions":2,"binary":false,"changes":5,"status":"modified"},{"patch":"@@ -25,1 +25,0 @@\n-#include \"gc\/shared\/gcTraceTime.inline.hpp\"\n@@ -27,0 +26,1 @@\n+#include \"gc\/shared\/gcTraceTime.inline.hpp\"\n","filename":"test\/hotspot\/gtest\/logging\/test_gcTraceTime.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -25,1 +25,0 @@\n-#include \"gc\/shared\/gcTraceTime.inline.hpp\"\n@@ -27,1 +26,1 @@\n-#include \"logging\/log.hpp\"\n+#include \"gc\/shared\/gcTraceTime.inline.hpp\"\n@@ -30,0 +29,1 @@\n+#include \"logging\/log.hpp\"\n","filename":"test\/hotspot\/gtest\/logging\/test_log.cpp","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -25,1 +25,0 @@\n-#include \"concurrentTestRunner.inline.hpp\"\n@@ -27,0 +26,1 @@\n+#include \"concurrentTestRunner.inline.hpp\"\n","filename":"test\/hotspot\/gtest\/logging\/test_logConfiguration.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -27,1 +27,0 @@\n-#include \"runtime\/os.hpp\"\n@@ -29,0 +28,1 @@\n+#include \"runtime\/os.hpp\" \/\/ malloc\n","filename":"test\/hotspot\/gtest\/logging\/test_logDecorators.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -1,99 +0,0 @@\n-\/*\n- * Copyright (c) 2022, Oracle and\/or its affiliates. All rights reserved.\n- *\n- * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n- *\n- * This code is free software; you can redistribute it and\/or modify it\n- * under the terms of the GNU General Public License version 2 only, as\n- * published by the Free Software Foundation.\n- *\n- * This code is distributed in the hope that it will be useful, but WITHOUT\n- * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n- * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n- * version 2 for more details (a copy is included in the LICENSE file that\n- * accompanied this code).\n- *\n- * You should have received a copy of the GNU General Public License version\n- * 2 along with this work; if not, write to the Free Software Foundation,\n- * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n- *\n- * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n- * or visit www.oracle.com if you need additional information or have any\n- * questions.\n- *\/\n-\n-#include \"precompiled.hpp\"\n-#include \"memory\/allocation.inline.hpp\"\n-#include \"unittest.hpp\"\n-\n-using Element = struct TestArrayAllocatorElement {\n-  double a;\n-  int b;\n-};\n-\n-static void fill(Element* elements, int start, int size) {\n-  for (int i = 0; i < size; i++) {\n-    new (&elements[start + i]) Element{0.0, start + i};\n-  }\n-}\n-\n-static Element* allocate_and_fill(int size) {\n-  Element* const elements = MallocArrayAllocator<Element>::allocate(size, mtTest);\n-\n-  fill(elements, 0, size);\n-\n-  return elements;\n-}\n-\n-TEST_VM(ArrayAllocator, allocate) {\n-  const int size = 10;\n-\n-  Element* const elements = allocate_and_fill(size);\n-\n-  for (int i = 0; i < size; i++) {\n-    ASSERT_EQ(elements[i].b, i);\n-  }\n-\n-  MallocArrayAllocator<Element>::free(elements);\n-}\n-\n-TEST_VM(ArrayAllocator, reallocate_0) {\n-  const int size = 10;\n-\n-  Element* const elements = allocate_and_fill(size);\n-\n-  Element* const ret = MallocArrayAllocator<Element>::reallocate(elements, 0, mtTest);\n-  ASSERT_NE(ret, nullptr) << \"We've chosen to NOT return nullptr when reallcting with 0\";\n-\n-  MallocArrayAllocator<Element>::free(ret);\n-}\n-\n-TEST_VM(ArrayAllocator, reallocate_shrink) {\n-  const int size = 10;\n-\n-  Element* const elements = allocate_and_fill(size);\n-\n-  Element* const ret = MallocArrayAllocator<Element>::reallocate(elements, size \/ 2, mtTest);\n-\n-  for (int i = 0; i < size \/ 2; i++) {\n-    ASSERT_EQ(ret[i].b, i);\n-  }\n-\n-  MallocArrayAllocator<Element>::free(ret);\n-}\n-\n-TEST_VM(ArrayAllocator, reallocate_grow) {\n-  const int size = 10;\n-\n-  Element* const elements = allocate_and_fill(size);\n-\n-  Element* const ret = MallocArrayAllocator<Element>::reallocate(elements, size * 2, mtTest);\n-\n-  fill(ret, size, size);\n-\n-  for (int i = 0; i < size * 2; i++) {\n-    ASSERT_EQ(ret[i].b, i);\n-  }\n-\n-  MallocArrayAllocator<Element>::free(ret);\n-}\n","filename":"test\/hotspot\/gtest\/memory\/test_arrayAllocator.cpp","additions":0,"deletions":99,"binary":false,"changes":99,"status":"deleted"},{"patch":"@@ -25,0 +25,1 @@\n+#include \"memory\/allocation.hpp\"\n","filename":"test\/hotspot\/gtest\/memory\/test_guardedMemory.cpp","additions":1,"deletions":0,"binary":false,"changes":1,"status":"modified"},{"patch":"@@ -26,1 +26,0 @@\n-#include \"oops\/oop.hpp\"\n@@ -28,0 +27,1 @@\n+#include \"oops\/oop.hpp\"\n","filename":"test\/hotspot\/gtest\/memory\/test_virtualspace.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -29,2 +29,0 @@\n-#include \"unittest.hpp\"\n-\n@@ -32,0 +30,1 @@\n+#include \"unittest.hpp\"\n","filename":"test\/hotspot\/gtest\/metaprogramming\/test_enableIf.cpp","additions":1,"deletions":2,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -30,1 +30,0 @@\n-#include \"runtime\/os.hpp\"\n@@ -32,0 +31,1 @@\n+#include \"runtime\/os.hpp\"\n","filename":"test\/hotspot\/gtest\/metaspace\/metaspaceGtestCommon.hpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -1,143 +0,0 @@\n-\/*\n- * Copyright (c) 2022 SAP SE. All rights reserved.\n- * Copyright (c) 2022, Oracle and\/or its affiliates. All rights reserved.\n- * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n- *\n- * This code is free software; you can redistribute it and\/or modify it\n- * under the terms of the GNU General Public License version 2 only, as\n- * published by the Free Software Foundation.\n- *\n- * This code is distributed in the hope that it will be useful, but WITHOUT\n- * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n- * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n- * version 2 for more details (a copy is included in the LICENSE file that\n- * accompanied this code).\n- *\n- * You should have received a copy of the GNU General Public License version\n- * 2 along with this work; if not, write to the Free Software Foundation,\n- * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n- *\n- * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n- * or visit www.oracle.com if you need additional information or have any\n- * questions.\n- *\/\n-\n-#include \"precompiled.hpp\"\n-#include \"memory\/allocation.hpp\"\n-#include \"runtime\/os.hpp\"\n-#include \"services\/mallocHeader.inline.hpp\"\n-#include \"services\/mallocTracker.hpp\"\n-#include \"services\/memTracker.hpp\"\n-#include \"testutils.hpp\"\n-#include \"unittest.hpp\"\n-\n-\/\/ Check NMT header for integrity, as well as expected type and size.\n-static void check_expected_malloc_header(const void* payload, MEMFLAGS type, size_t size) {\n-  const MallocHeader* hdr = MallocTracker::malloc_header(payload);\n-  hdr->assert_block_integrity();\n-  EXPECT_EQ(hdr->size(), size);\n-  EXPECT_EQ(hdr->flags(), type);\n-}\n-\n-\/\/ Check that a malloc with an overflowing size is rejected.\n-TEST_VM(NMT, malloc_failure1) {\n-  void* p = os::malloc(SIZE_MAX, mtTest);\n-  EXPECT_NULL(p);\n-}\n-\n-\/\/ Check that gigantic mallocs are rejected, even if no size overflow happens.\n-TEST_VM(NMT, malloc_failure2) {\n-  void* p = os::malloc(SIZE_MAX - M, mtTest);\n-  EXPECT_NULL(p);\n-}\n-\n-\/\/ Check correct handling of failing reallocs.\n-static void check_failing_realloc(size_t failing_request_size) {\n-\n-  \/\/ We test this with both NMT enabled and disabled.\n-  bool nmt_enabled = MemTracker::enabled();\n-  const size_t first_size = 0x100;\n-\n-  void* p = os::malloc(first_size, mtTest);\n-  EXPECT_NOT_NULL(p);\n-  if (nmt_enabled) {\n-    check_expected_malloc_header(p, mtTest, first_size);\n-  }\n-  GtestUtils::mark_range(p, first_size);\n-\n-  \/\/ should fail\n-  void* p2 = os::realloc(p, failing_request_size, mtTest);\n-  EXPECT_NULL(p2);\n-\n-  \/\/ original allocation should still be intact\n-  GtestUtils::check_range(p, first_size);\n-  if (nmt_enabled) {\n-    check_expected_malloc_header(p, mtTest, first_size);\n-  }\n-\n-  os::free(p);\n-}\n-\n-TEST_VM(NMT, realloc_failure_overflowing_size) {\n-  check_failing_realloc(SIZE_MAX);\n-  check_failing_realloc(SIZE_MAX - MemTracker::overhead_per_malloc());\n-}\n-\n-TEST_VM(NMT, realloc_failure_gigantic_size) {\n-  check_failing_realloc(SIZE_MAX - M);\n-}\n-\n-static void* do_realloc(void* p, size_t old_size, size_t new_size, uint8_t old_content, bool check_nmt_header) {\n-\n-  EXPECT_NOT_NULL(p);\n-  if (check_nmt_header) {\n-    check_expected_malloc_header(p, mtTest, old_size);\n-  }\n-\n-  void* p2 = os::realloc(p, new_size, mtTest);\n-\n-  EXPECT_NOT_NULL(p2);\n-  if (check_nmt_header) {\n-    check_expected_malloc_header(p2, mtTest, new_size);\n-  }\n-\n-  \/\/ Check old content, and possibly zapped area (if block grew)\n-  if (old_size < new_size) {\n-    GtestUtils::check_range((char*)p2, old_size, old_content);\n-#ifdef ASSERT\n-    GtestUtils::check_range((char*)p2 + old_size, new_size - old_size, uninitBlockPad);\n-#endif\n-  } else {\n-    GtestUtils::check_range((char*)p2, new_size, old_content);\n-  }\n-\n-  return p2;\n-}\n-\n-\/\/ Check a random sequence of reallocs. For enlarging reallocs, we expect the\n-\/\/ newly allocated memory to be zapped (in debug) while the old section should be\n-\/\/ left intact.\n-TEST_VM(NMT, random_reallocs) {\n-\n-  bool nmt_enabled = MemTracker::enabled();\n-  size_t size = 256;\n-  uint8_t content = 'A';\n-\n-  void* p = os::malloc(size, mtTest);\n-  ASSERT_NOT_NULL(p);\n-  if (nmt_enabled) {\n-    check_expected_malloc_header(p, mtTest, size);\n-  }\n-  GtestUtils::mark_range_with(p, size, content);\n-\n-  for (int n = 0; n < 100; n ++) {\n-    size_t new_size = (size_t)(os::random() % 512) + 1;\n-    \/\/ LOG_HERE(\"reallocating \" SIZE_FORMAT \"->\" SIZE_FORMAT, size, new_size);\n-    p = do_realloc(p, size, new_size, content, nmt_enabled);\n-    size = new_size;\n-    content = (n % 26) + 'A';\n-    GtestUtils::mark_range_with(p, size, content);\n-  }\n-\n-  os::free(p);\n-}\n","filename":"test\/hotspot\/gtest\/nmt\/test_nmt_cornercases.cpp","additions":0,"deletions":143,"binary":false,"changes":143,"status":"deleted"},{"patch":"@@ -28,1 +28,0 @@\n-#include \"services\/memTracker.hpp\"\n@@ -78,1 +77,1 @@\n-    assert(!MemTracker::is_initialized(),\n+    assert(NMTPreInit::in_preinit_phase(),\n@@ -116,1 +115,1 @@\n-    assert(MemTracker::is_initialized(),\n+    assert(NMTPreInit::in_preinit_phase() == false,\n@@ -130,1 +129,1 @@\n-    assert(MemTracker::is_initialized(),\n+    assert(NMTPreInit::in_preinit_phase() == false,\n","filename":"test\/hotspot\/gtest\/nmt\/test_nmtpreinit.cpp","additions":3,"deletions":4,"binary":false,"changes":7,"status":"modified"},{"patch":"@@ -34,1 +34,0 @@\n-#include \"runtime\/semaphore.inline.hpp\"\n@@ -36,0 +35,1 @@\n+#include \"runtime\/semaphore.inline.hpp\"\n","filename":"test\/hotspot\/gtest\/oops\/test_markWord.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -31,1 +31,0 @@\n-\n","filename":"test\/hotspot\/gtest\/runtime\/test_arguments.cpp","additions":0,"deletions":1,"binary":false,"changes":1,"status":"modified"},{"patch":"@@ -27,1 +27,0 @@\n-#include \"runtime\/interfaceSupport.inline.hpp\"\n@@ -29,0 +28,1 @@\n+#include \"runtime\/interfaceSupport.inline.hpp\"\n","filename":"test\/hotspot\/gtest\/runtime\/test_classPrinter.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -25,0 +25,4 @@\n+\n+\/\/ Included early because the NMT flags don't include it.\n+#include \"utilities\/macros.hpp\"\n+\n@@ -29,1 +33,0 @@\n-#include \"utilities\/macros.hpp\"\n@@ -32,0 +35,1 @@\n+\n","filename":"test\/hotspot\/gtest\/runtime\/test_committed_virtualmemory.cpp","additions":5,"deletions":1,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -27,2 +27,1 @@\n-#include \"runtime\/frame.inline.hpp\"\n-#include \"runtime\/os.inline.hpp\"\n+#include \"runtime\/os.hpp\"\n@@ -30,1 +29,0 @@\n-#include \"runtime\/threads.hpp\"\n@@ -32,1 +30,0 @@\n-#include \"utilities\/align.hpp\"\n@@ -36,0 +33,1 @@\n+#include \"utilities\/align.hpp\"\n@@ -37,0 +35,2 @@\n+#include \"runtime\/frame.inline.hpp\"\n+#include \"runtime\/threads.hpp\"\n@@ -893,34 +893,0 @@\n-\n-#ifdef __GLIBC__\n-TEST_VM(os, trim_native_heap) {\n-  EXPECT_TRUE(os::can_trim_native_heap());\n-  os::size_change_t sc;\n-  sc.before = sc.after = (size_t)-1;\n-  EXPECT_TRUE(os::trim_native_heap(&sc));\n-  tty->print_cr(SIZE_FORMAT \"->\" SIZE_FORMAT, sc.before, sc.after);\n-  \/\/ Regardless of whether we freed memory, both before and after\n-  \/\/ should be somewhat believable numbers (RSS).\n-  const size_t min = 5 * M;\n-  const size_t max = LP64_ONLY(20 * G) NOT_LP64(3 * G);\n-  ASSERT_LE(min, sc.before);\n-  ASSERT_GT(max, sc.before);\n-  ASSERT_LE(min, sc.after);\n-  ASSERT_GT(max, sc.after);\n-  \/\/ Should also work\n-  EXPECT_TRUE(os::trim_native_heap());\n-}\n-#else\n-TEST_VM(os, trim_native_heap) {\n-  EXPECT_FALSE(os::can_trim_native_heap());\n-}\n-#endif \/\/ __GLIBC__\n-\n-TEST_VM(os, open_O_CLOEXEC) {\n-#if !defined(_WIN32)\n-  int fd = os::open(\"test_file.txt\", O_RDWR | O_CREAT | O_TRUNC, 0666); \/\/ open will use O_CLOEXEC\n-  EXPECT_TRUE(fd > 0);\n-  int flags = ::fcntl(fd, F_GETFD);\n-  EXPECT_TRUE((flags & FD_CLOEXEC) != 0); \/\/ if O_CLOEXEC worked, then FD_CLOEXEC should be ON\n-  ::close(fd);\n-#endif\n-}\n","filename":"test\/hotspot\/gtest\/runtime\/test_os.cpp","additions":4,"deletions":38,"binary":false,"changes":42,"status":"modified"},{"patch":"@@ -28,2 +28,2 @@\n-#include \"os_linux.hpp\"\n-#include \"prims\/jniCheck.hpp\"\n+#include <sys\/mman.h>\n+\n@@ -32,2 +32,0 @@\n-#include \"utilities\/align.hpp\"\n-#include \"utilities\/decoder.hpp\"\n@@ -35,1 +33,1 @@\n-#include \"testutils.hpp\"\n+#include \"os_linux.hpp\"\n@@ -37,3 +35,2 @@\n-\n-#include <sys\/mman.h>\n-\n+#include \"utilities\/align.hpp\"\n+#include \"utilities\/decoder.hpp\"\n@@ -440,2 +437,2 @@\n-#if !defined(__clang_major__) || (__clang_major__ >= 5) \/\/ DWARF does not support Clang versions older than 5.0.\n-\/\/ Test valid address of method ReportJNIFatalError in jniCheck.hpp. We should get \"jniCheck.hpp\" in the buffer and a valid line number.\n+#ifndef PRODUCT\n+\/\/ Test valid address of method JNI_CreateJavaVM in jni.cpp. We should get \"jni.cpp\" in the buffer and a valid line number.\n@@ -445,1 +442,1 @@\n-  address valid_function_pointer = (address)ReportJNIFatalError;\n+  address valid_function_pointer = (address)JNI_CreateJavaVM;\n@@ -447,1 +444,15 @@\n-  ASSERT_TRUE(strcmp(buf, \"jniCheck.hpp\") == 0);\n+  ASSERT_TRUE(strcmp(buf, \"jni.cpp\") == 0);\n+  ASSERT_TRUE(line > 0);\n+}\n+\n+\/\/ Same test as \"decoder_get_source_info_valid\" but with a too-small output buffer. Everything should work the same except\n+\/\/ that the output buffer truncates \"jni.cpp\" such that we find \"jni.cp\" instead. The line number must be found as before.\n+TEST_VM(os_linux, decoder_get_source_info_valid_truncated) {\n+  char buf[128] = \"\";\n+  int line = -1;\n+  memset(buf, 'X', sizeof(buf));\n+  address valid_function_pointer = (address)JNI_CreateJavaVM;\n+  ASSERT_TRUE(Decoder::get_source_info(valid_function_pointer, buf, 7, &line));\n+  ASSERT_TRUE(buf[7 - 1] == '\\0');\n+  ASSERT_TRUE(buf[7] == 'X');\n+  ASSERT_TRUE(strcmp(buf, \"jni.cp\") == 0);\n@@ -462,2 +473,3 @@\n-    ASSERT_TRUE(buf[0] == '\\0'); \/\/ Should contain \"\" on error\n-    ASSERT_TRUE(line == -1); \/\/ Should contain -1 on error\n+    \/\/ buffer should contain \"\", offset should contain -1\n+    ASSERT_TRUE(buf[0] == '\\0');\n+    ASSERT_TRUE(line == -1);\n@@ -466,47 +478,1 @@\n-\n-\/\/ Test with valid address but a too small buffer to store the entire filename. Should find generic <OVERFLOW> message\n-\/\/ and a valid line number.\n-TEST_VM(os_linux, decoder_get_source_info_valid_overflow) {\n-  char buf[11] = \"\";\n-  int line = -1;\n-  address valid_function_pointer = (address)ReportJNIFatalError;\n-  ASSERT_TRUE(Decoder::get_source_info(valid_function_pointer, buf, 11, &line));\n-  ASSERT_TRUE(strcmp(buf, \"<OVERFLOW>\") == 0);\n-  ASSERT_TRUE(line > 0);\n-}\n-\n-\/\/ Test with valid address but a too small buffer that can neither store the entire filename nor the generic <OVERFLOW>\n-\/\/ message. We should find \"L\" as filename and a valid line number.\n-TEST_VM(os_linux, decoder_get_source_info_valid_overflow_minimal) {\n-  char buf[2] = \"\";\n-  int line = -1;\n-  address valid_function_pointer = (address)ReportJNIFatalError;\n-  ASSERT_TRUE(Decoder::get_source_info(valid_function_pointer, buf, 2, &line));\n-  ASSERT_TRUE(strcmp(buf, \"L\") == 0); \/\/ Overflow message does not fit, so we fall back to \"L:line_number\"\n-  ASSERT_TRUE(line > 0); \/\/ Line should correctly be found and returned\n-}\n-#endif \/\/ clang\n-\n-#ifdef __GLIBC__\n-TEST_VM(os_linux, glibc_mallinfo_wrapper) {\n-  \/\/ Very basic test. Call it. That proves that resolution and invocation works.\n-  os::Linux::glibc_mallinfo mi;\n-  bool did_wrap = false;\n-\n-  os::Linux::get_mallinfo(&mi, &did_wrap);\n-\n-  void* p = os::malloc(2 * K, mtTest);\n-  ASSERT_NOT_NULL(p);\n-\n-  \/\/ We should see total allocation values > 0\n-  ASSERT_GE((mi.uordblks + mi.hblkhd), 2 * K);\n-\n-  \/\/ These values also should exceed some reasonable size.\n-  ASSERT_LT(mi.fordblks, 2 * G);\n-  ASSERT_LT(mi.uordblks, 2 * G);\n-  ASSERT_LT(mi.hblkhd, 2 * G);\n-\n-  os::free(p);\n-}\n-#endif \/\/ __GLIBC__\n-\n+#endif \/\/ NOT PRODUCT\n","filename":"test\/hotspot\/gtest\/runtime\/test_os_linux.cpp","additions":27,"deletions":61,"binary":false,"changes":88,"status":"modified"},{"patch":"@@ -29,0 +29,1 @@\n+#include \"runtime\/os.hpp\"\n@@ -31,1 +32,0 @@\n-#include \"runtime\/os.hpp\"\n","filename":"test\/hotspot\/gtest\/runtime\/test_os_windows.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -24,1 +24,0 @@\n-#include \"runtime\/arguments.hpp\"\n@@ -26,0 +25,1 @@\n+#include \"runtime\/arguments.hpp\"\n","filename":"test\/hotspot\/gtest\/runtime\/test_special_flags.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -53,3 +53,1 @@\n-\/\/ Mimicking the official ASSERT_xx and EXPECT_xx counterparts of the googletest suite.\n-\/\/ (ASSERT|EXPECT)_NOT_NULL: check that the given pointer is not NULL\n-\/\/ (ASSERT|EXPECT)_NULL: check that the given pointer is NULL\n+\/\/ Convenience asserts\n@@ -58,2 +56,0 @@\n-#define EXPECT_NOT_NULL(p)  EXPECT_NE(p2i(p), 0)\n-#define EXPECT_NULL(p)      EXPECT_EQ(p2i(p), 0)\n","filename":"test\/hotspot\/gtest\/testutils.hpp","additions":1,"deletions":5,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -28,1 +28,0 @@\n-#include \"runtime\/interfaceSupport.inline.hpp\"\n@@ -31,0 +30,1 @@\n+#include \"runtime\/interfaceSupport.inline.hpp\"\n@@ -32,1 +32,0 @@\n-#include \"runtime\/vmOperations.hpp\"\n@@ -34,0 +33,1 @@\n+#include \"runtime\/vmOperations.hpp\"\n","filename":"test\/hotspot\/gtest\/threadHelper.inline.hpp","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -28,2 +28,0 @@\n-#include \"unittest.hpp\"\n-\n@@ -31,0 +29,1 @@\n+#include \"unittest.hpp\"\n","filename":"test\/hotspot\/gtest\/utilities\/test_align.cpp","additions":1,"deletions":2,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -25,1 +25,1 @@\n-#include \"runtime\/os.hpp\"\n+#include \"runtime\/os.hpp\" \/\/ malloc\n@@ -31,2 +31,0 @@\n-#include \"unittest.hpp\"\n-\n@@ -34,0 +32,1 @@\n+#include \"unittest.hpp\"\n","filename":"test\/hotspot\/gtest\/utilities\/test_bitMap_setops.cpp","additions":2,"deletions":3,"binary":false,"changes":5,"status":"modified"},{"patch":"@@ -27,1 +27,1 @@\n-#include \"runtime\/os.hpp\"\n+#include \"runtime\/os.hpp\" \/\/ malloc\n","filename":"test\/hotspot\/gtest\/utilities\/test_concurrentHashtable.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -26,2 +26,0 @@\n-#include \"unittest.hpp\"\n-\n@@ -29,0 +27,1 @@\n+#include \"unittest.hpp\"\n","filename":"test\/hotspot\/gtest\/utilities\/test_enumIterator.cpp","additions":1,"deletions":2,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -28,0 +28,1 @@\n+#include \"utilities\/globalCounter.hpp\"\n","filename":"test\/hotspot\/gtest\/utilities\/test_globalCounter.cpp","additions":1,"deletions":0,"binary":false,"changes":1,"status":"modified"},{"patch":"@@ -27,0 +27,1 @@\n+#include \"utilities\/globalCounter.hpp\"\n","filename":"test\/hotspot\/gtest\/utilities\/test_globalCounter_nested.cpp","additions":1,"deletions":0,"binary":false,"changes":1,"status":"modified"},{"patch":"@@ -30,2 +30,0 @@\n-#include \"unittest.hpp\"\n-\n@@ -33,0 +31,1 @@\n+#include \"unittest.hpp\"\n","filename":"test\/hotspot\/gtest\/utilities\/test_globalDefinitions.cpp","additions":1,"deletions":2,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -53,2 +53,2 @@\n-  static bool elements_on_resource_area(const GrowableArray<E>* array) {\n-    return array->on_resource_area();\n+  static bool elements_on_stack(const GrowableArray<E>* array) {\n+    return array->on_stack();\n@@ -474,1 +474,1 @@\n-    ASSERT_TRUE(elements_on_resource_area(a));\n+    ASSERT_TRUE(elements_on_stack(a));\n@@ -502,1 +502,1 @@\n-    ASSERT_TRUE(elements_on_resource_area(&a));\n+    ASSERT_TRUE(elements_on_stack(&a));\n@@ -525,1 +525,1 @@\n-    ASSERT_TRUE(elements_on_resource_area(&w._a));\n+    ASSERT_TRUE(elements_on_stack(&w._a));\n","filename":"test\/hotspot\/gtest\/utilities\/test_growableArray.cpp","additions":5,"deletions":5,"binary":false,"changes":10,"status":"modified"},{"patch":"@@ -31,1 +31,0 @@\n-\n","filename":"test\/hotspot\/gtest\/utilities\/test_lockFreeStack.cpp","additions":0,"deletions":1,"binary":false,"changes":1,"status":"modified"},{"patch":"@@ -32,1 +32,0 @@\n-\n","filename":"test\/hotspot\/gtest\/utilities\/test_nonblockingQueue.cpp","additions":0,"deletions":1,"binary":false,"changes":1,"status":"modified"},{"patch":"@@ -30,2 +30,0 @@\n-#include \"unittest.hpp\"\n-\n@@ -33,0 +31,1 @@\n+#include \"unittest.hpp\"\n","filename":"test\/hotspot\/gtest\/utilities\/test_population_count.cpp","additions":1,"deletions":2,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -28,2 +28,0 @@\n-#include \"unittest.hpp\"\n-\n@@ -32,0 +30,1 @@\n+#include \"unittest.hpp\"\n","filename":"test\/hotspot\/gtest\/utilities\/test_powerOfTwo.cpp","additions":1,"deletions":2,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -26,1 +26,0 @@\n-#include \"runtime\/atomic.hpp\"\n@@ -28,0 +27,1 @@\n+#include \"runtime\/atomic.hpp\"\n","filename":"test\/hotspot\/gtest\/utilities\/test_singleWriterSynchronizer.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -34,0 +34,5 @@\n+####\n+## NSK JVMTI tests failing with wrapper\n+\n+vmTestbase\/nsk\/jvmti\/GetAllThreads\/allthr001\/TestDescription.java 8284027 generic-all\n+\n","filename":"test\/hotspot\/jtreg\/ProblemList-svc-vthread.txt","additions":5,"deletions":0,"binary":false,"changes":5,"status":"modified"},{"patch":"@@ -49,0 +49,1 @@\n+compiler\/jvmci\/jdk.vm.ci.code.test\/src\/jdk\/vm\/ci\/code\/test\/NativeCallTest.java 8262901 macosx-aarch64\n@@ -55,11 +56,11 @@\n-compiler\/rtm\/locking\/TestRTMAbortRatio.java 8183263 generic-x64,generic-i586\n-compiler\/rtm\/locking\/TestRTMAbortThreshold.java 8183263 generic-x64,generic-i586\n-compiler\/rtm\/locking\/TestRTMAfterNonRTMDeopt.java 8183263 generic-x64,generic-i586\n-compiler\/rtm\/locking\/TestRTMDeoptOnHighAbortRatio.java 8183263 generic-x64,generic-i586\n-compiler\/rtm\/locking\/TestRTMDeoptOnLowAbortRatio.java 8183263 generic-x64,generic-i586\n-compiler\/rtm\/locking\/TestRTMLockingCalculationDelay.java 8183263 generic-x64,generic-i586\n-compiler\/rtm\/locking\/TestRTMLockingThreshold.java 8183263 generic-x64,generic-i586\n-compiler\/rtm\/locking\/TestRTMSpinLoopCount.java 8183263 generic-x64,generic-i586\n-compiler\/rtm\/locking\/TestUseRTMDeopt.java 8183263 generic-x64,generic-i586\n-compiler\/rtm\/locking\/TestUseRTMXendForLockBusy.java 8183263 generic-x64,generic-i586\n-compiler\/rtm\/print\/TestPrintPreciseRTMLockingStatistics.java 8183263 generic-x64,generic-i586\n+compiler\/rtm\/locking\/TestRTMAbortRatio.java 8183263 generic-x64\n+compiler\/rtm\/locking\/TestRTMAbortThreshold.java 8183263 generic-x64\n+compiler\/rtm\/locking\/TestRTMAfterNonRTMDeopt.java 8183263 generic-x64\n+compiler\/rtm\/locking\/TestRTMDeoptOnHighAbortRatio.java 8183263 generic-x64\n+compiler\/rtm\/locking\/TestRTMDeoptOnLowAbortRatio.java 8183263 generic-x64\n+compiler\/rtm\/locking\/TestRTMLockingCalculationDelay.java 8183263 generic-x64\n+compiler\/rtm\/locking\/TestRTMLockingThreshold.java 8183263 generic-x64\n+compiler\/rtm\/locking\/TestRTMSpinLoopCount.java 8183263 generic-x64\n+compiler\/rtm\/locking\/TestUseRTMDeopt.java 8183263 generic-x64\n+compiler\/rtm\/locking\/TestUseRTMXendForLockBusy.java 8183263 generic-x64\n+compiler\/rtm\/print\/TestPrintPreciseRTMLockingStatistics.java 8183263 generic-x64\n@@ -71,3 +72,0 @@\n-compiler\/debug\/TestStressCM.java 8297343 generic-all\n-compiler\/debug\/TestStressIGVNAndCCP.java 8297343 generic-all\n-\n@@ -103,2 +101,0 @@\n-runtime\/vthread\/RedefineClass.java 8297286 generic-all\n-runtime\/vthread\/TestObjectAllocationSampleEvent.java 8297286 generic-all\n","filename":"test\/hotspot\/jtreg\/ProblemList.txt","additions":12,"deletions":16,"binary":false,"changes":28,"status":"modified"},{"patch":"@@ -1,51 +0,0 @@\n-\/*\n- * Copyright (c) 2022, Oracle and\/or its affiliates. All rights reserved.\n- * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n- *\n- * This code is free software; you can redistribute it and\/or modify it\n- * under the terms of the GNU General Public License version 2 only, as\n- * published by the Free Software Foundation.\n- *\n- * This code is distributed in the hope that it will be useful, but WITHOUT\n- * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n- * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n- * version 2 for more details (a copy is included in the LICENSE file that\n- * accompanied this code).\n- *\n- * You should have received a copy of the GNU General Public License version\n- * 2 along with this work; if not, write to the Free Software Foundation,\n- * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n- *\n- * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n- * or visit www.oracle.com if you need additional information or have any\n- * questions.\n- *\/\n-\n-\/*\n- * @test\n- * @summary Checks that -XX:+PrintC1Statistics works\n- * @bug 8296969\n- * @requires vm.debug == true & vm.compiler1.enabled\n- * @library \/test\/lib\n- * @run main\/othervm -XX:+Verbose compiler.c1.TestPrintC1Statistics\n- *\/\n-\n-package compiler.c1;\n-\n-import java.util.ArrayList;\n-import java.util.List;\n-\n-import jdk.test.lib.process.OutputAnalyzer;\n-import jdk.test.lib.process.ProcessTools;\n-\n-public class TestPrintC1Statistics {\n-    public static void main(String[] args) throws Exception {\n-        List<String> options = new ArrayList<String>();\n-        options.add(\"-XX:+PrintC1Statistics\");\n-        options.add(\"--version\");\n-\n-        OutputAnalyzer oa = ProcessTools.executeTestJvm(options);\n-\n-        oa.shouldHaveExitValue(0).shouldContain(\"C1 Runtime statistics\");\n-    }\n- }\n","filename":"test\/hotspot\/jtreg\/compiler\/c1\/TestPrintC1Statistics.java","additions":0,"deletions":51,"binary":false,"changes":51,"status":"deleted"},{"patch":"@@ -26,1 +26,1 @@\n- * @bug 8284358 8296912\n+ * @bug 8284358\n@@ -30,1 +30,1 @@\n- *                   -XX:CompileCommand=compileonly,*TestDeadDataLoop::test* -XX:CompileCommand=dontinline,*TestDeadDataLoop::notInlined*\n+ *                   -XX:CompileCommand=compileonly,*TestDeadDataLoop::test* -XX:CompileCommand=dontinline,*TestDeadDataLoop::notInlined\n@@ -33,4 +33,1 @@\n- *                   -XX:CompileCommand=compileonly,*TestDeadDataLoop::test* -XX:CompileCommand=dontinline,*TestDeadDataLoop::notInlined*\n- *                   compiler.c2.TestDeadDataLoop\n- * @run main\/othervm -Xcomp -XX:-TieredCompilation -XX:+UnlockDiagnosticVMOptions -XX:+StressIGVN -XX:StressSeed=2472844645\n- *                   -XX:CompileCommand=compileonly,*TestDeadDataLoop::test* -XX:CompileCommand=dontinline,*TestDeadDataLoop::notInlined*\n+ *                   -XX:CompileCommand=compileonly,*TestDeadDataLoop::test* -XX:CompileCommand=dontinline,*TestDeadDataLoop::notInlined\n@@ -39,1 +36,1 @@\n- *                   -XX:CompileCommand=compileonly,*TestDeadDataLoop::test* -XX:CompileCommand=dontinline,*TestDeadDataLoop::notInlined*\n+ *                   -XX:CompileCommand=compileonly,*TestDeadDataLoop::test* -XX:CompileCommand=dontinline,*TestDeadDataLoop::notInlined\n@@ -222,15 +219,0 @@\n-    static long l;\n-\n-    static void test11(boolean never) {\n-        float f = 1;\n-        boolean b;\n-        for (int i = 0; i < 5; ++i) {\n-            b = (never || l < 0);\n-            l = notInlined2();\n-            if (!never) {\n-                f += i;\n-            }\n-        }\n-        l += f;\n-    }\n-\n@@ -241,4 +223,0 @@\n-    public static int notInlined2() {\n-        return 42;\n-    }\n-\n@@ -259,1 +237,0 @@\n-        test11(false);\n","filename":"test\/hotspot\/jtreg\/compiler\/c2\/TestDeadDataLoop.java","additions":4,"deletions":27,"binary":false,"changes":31,"status":"modified"},{"patch":"@@ -135,1 +135,1 @@\n-        t.runTest(methodObjClassCast,  false,  svalue);\n+        t.runTest(methodObjClassCast,  true,  svalue);\n","filename":"test\/hotspot\/jtreg\/compiler\/intrinsics\/klass\/CastNullCheckDroppingsTest.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -1,37 +0,0 @@\n-\/*\n- * Copyright (c) 2022, Oracle and\/or its affiliates. All rights reserved.\n- * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n- *\n- * This code is free software; you can redistribute it and\/or modify it\n- * under the terms of the GNU General Public License version 2 only, as\n- * published by the Free Software Foundation.\n- *\n- * This code is distributed in the hope that it will be useful, but WITHOUT\n- * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n- * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n- * version 2 for more details (a copy is included in the LICENSE file that\n- * accompanied this code).\n- *\n- * You should have received a copy of the GNU General Public License version\n- * 2 along with this work; if not, write to the Free Software Foundation,\n- * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n- *\n- * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n- * or visit www.oracle.com if you need additional information or have any\n- * questions.\n- *\/\n-\n-package jdk.vm.ci.hotspot;\n-\n-import jdk.vm.ci.meta.JavaType;\n-import jdk.vm.ci.meta.ResolvedJavaField;\n-\n-public class HotSpotResolvedJavaFieldHelper {\n-    public static ResolvedJavaField createField(HotSpotResolvedObjectTypeImpl holder, JavaType type, int offset, int modifiers, int index) {\n-        return new HotSpotResolvedJavaFieldImpl(holder, type, offset, modifiers, index);\n-    }\n-\n-    public static int getIndex(ResolvedJavaField field) {\n-        return ((HotSpotResolvedJavaFieldImpl) field).getIndex();\n-    }\n-}\n","filename":"test\/hotspot\/jtreg\/compiler\/jvmci\/common\/patches\/jdk.internal.vm.ci\/jdk\/vm\/ci\/hotspot\/HotSpotResolvedJavaFieldHelper.java","additions":0,"deletions":37,"binary":false,"changes":37,"status":"deleted"},{"patch":"@@ -192,33 +192,0 @@\n-jint JNICALL I32I(jint i00, jint i01, jint i02, jint i03, jint i04, jint i05, jint i06, jint i07,\n-                  jint i08, jint i09, jint i0a, jint i0b, jint i0c, jint i0d, jint i0e, jint i0f,\n-                  jint i10, jint i11, jint i12, jint i13, jint i14, jint i15, jint i16, jint i17,\n-                  jint i18, jint i19, jint i1a, jint i1b, jint i1c, jint i1d, jint i1e, jint i1f,\n-                  jint a) {\n-  return i00 + i01 + i02 + i03 + i04 + i05 + i06 + i07 +\n-         i08 + i09 + i0a + i0b + i0c + i0d + i0e + i0f +\n-         i10 + i11 + i12 + i13 + i14 + i15 + i16 + i17 +\n-         i18 + i19 + i1a + i1b + i1c + i1d + i1e + i1f +\n-         a;\n-}\n-\n-JNIEXPORT jlong JNICALL Java_jdk_vm_ci_code_test_NativeCallTest_getI32I(JNIEnv *env, jclass clazz) {\n-  return (jlong) (intptr_t) I32I;\n-}\n-\n-JNIEXPORT jint JNICALL Java_jdk_vm_ci_code_test_NativeCallTest__1I32I(JNIEnv *env, jclass clazz,\n-                                                                      jint i00, jint i01, jint i02, jint i03,\n-                                                                      jint i04, jint i05, jint i06, jint i07,\n-                                                                      jint i08, jint i09, jint i0a, jint i0b,\n-                                                                      jint i0c, jint i0d, jint i0e, jint i0f,\n-                                                                      jint i10, jint i11, jint i12, jint i13,\n-                                                                      jint i14, jint i15, jint i16, jint i17,\n-                                                                      jint i18, jint i19, jint i1a, jint i1b,\n-                                                                      jint i1c, jint i1d, jint i1e, jint i1f,\n-                                                                      jint a) {\n-  return I32I(i00, i01, i02, i03, i04, i05, i06, i07,\n-              i08, i09, i0a, i0b, i0c, i0d, i0e, i0f,\n-              i10, i11, i12, i13, i14, i15, i16, i17,\n-              i18, i19, i1a, i1b, i1c, i1d, i1e, i1f,\n-              a);\n-}\n-\n","filename":"test\/hotspot\/jtreg\/compiler\/jvmci\/jdk.vm.ci.code.test\/libNativeCallTest.c","additions":0,"deletions":33,"binary":false,"changes":33,"status":"modified"},{"patch":"@@ -129,20 +129,0 @@\n-    @Test\n-    public void testI32I() {\n-        int sCount = 32;\n-        \/\/ Pairs of <Object>, <Class>\n-        Object[] remainingArgs = new Object[]{\n-                        12, int.class\n-        };\n-        Class<?>[] argClazz = new Class[sCount + remainingArgs.length \/ 2];\n-        Object[] argValues = new Object[sCount + remainingArgs.length \/ 2];\n-        for (int i = 0; i < sCount; i++) {\n-            argValues[i] = i;\n-            argClazz[i] = int.class;\n-        }\n-        for (int i = 0; i < remainingArgs.length; i += 2) {\n-            argValues[sCount + i \/ 2] = remainingArgs[i + 0];\n-            argClazz[sCount + i \/ 2] = (Class<?>) remainingArgs[i + 1];\n-        }\n-        test(\"I32I\", getI32I(), int.class, argClazz, argValues);\n-    }\n-\n@@ -162,7 +142,1 @@\n-                if (returnClazz == float.class) {\n-                    asm.emitFloatRet(((RegisterValue) cc.getReturn()).getRegister());\n-                } else if (returnClazz == int.class) {\n-                    asm.emitIntRet(((RegisterValue) cc.getReturn()).getRegister());\n-                } else {\n-                    assert false : \"Unimplemented return type: \" + returnClazz;\n-                }\n+                asm.emitFloatRet(((RegisterValue) cc.getReturn()).getRegister());\n@@ -274,20 +248,0 @@\n-\n-    public static native long getI32I();\n-\n-    public static native int _I32I(int i00, int i01, int i02, int i03, int i04, int i05, int i06, int i07,\n-                    int i08, int i09, int i0a, int i0b, int i0c, int i0d, int i0e, int i0f,\n-                    int i10, int i11, int i12, int i13, int i14, int i15, int i16, int i17,\n-                    int i18, int i19, int i1a, int i1b, int i1c, int i1d, int i1e, int i1f,\n-                    int a);\n-\n-    public static int I32I(int i00, int i01, int i02, int i03, int i04, int i05, int i06, int i07,\n-                    int i08, int i09, int i0a, int i0b, int i0c, int i0d, int i0e, int i0f,\n-                    int i10, int i11, int i12, int i13, int i14, int i15, int i16, int i17,\n-                    int i18, int i19, int i1a, int i1b, int i1c, int i1d, int i1e, int i1f,\n-                    int a) {\n-        return _I32I(i00, i01, i02, i03, i04, i05, i06, i07,\n-                    i08, i09, i0a, i0b, i0c, i0d, i0e, i0f,\n-                    i10, i11, i12, i13, i14, i15, i16, i17,\n-                    i18, i19, i1a, i1b, i1c, i1d, i1e, i1f,\n-                    a);\n-    }\n","filename":"test\/hotspot\/jtreg\/compiler\/jvmci\/jdk.vm.ci.code.test\/src\/jdk\/vm\/ci\/code\/test\/NativeCallTest.java","additions":1,"deletions":47,"binary":false,"changes":48,"status":"modified"},{"patch":"@@ -275,1 +275,2 @@\n-        growFrame(cc.getStackSize());\n+        emitGrowStack(cc.getStackSize());\n+        frameSize += cc.getStackSize();\n@@ -284,1 +285,2 @@\n-        growFrame(-cc.getStackSize());\n+        emitGrowStack(-cc.getStackSize());\n+        frameSize -= cc.getStackSize();\n","filename":"test\/hotspot\/jtreg\/compiler\/jvmci\/jdk.vm.ci.code.test\/src\/jdk\/vm\/ci\/code\/test\/aarch64\/AArch64TestAssembler.java","additions":4,"deletions":2,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -406,1 +406,2 @@\n-        growFrame(cc.getStackSize());\n+        emitGrowStack(cc.getStackSize());\n+        frameSize += cc.getStackSize();\n@@ -429,1 +430,2 @@\n-        growFrame(-cc.getStackSize());\n+        emitGrowStack(-cc.getStackSize());\n+        frameSize -= cc.getStackSize();\n","filename":"test\/hotspot\/jtreg\/compiler\/jvmci\/jdk.vm.ci.code.test\/src\/jdk\/vm\/ci\/code\/test\/amd64\/AMD64TestAssembler.java","additions":4,"deletions":2,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -1,145 +0,0 @@\n-\/*\n- * Copyright (c) 2022, Oracle and\/or its affiliates. All rights reserved.\n- * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n- *\n- * This code is free software; you can redistribute it and\/or modify it\n- * under the terms of the GNU General Public License version 2 only, as\n- * published by the Free Software Foundation.\n- *\n- * This code is distributed in the hope that it will be useful, but WITHOUT\n- * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n- * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n- * version 2 for more details (a copy is included in the LICENSE file that\n- * accompanied this code).\n- *\n- * You should have received a copy of the GNU General Public License version\n- * 2 along with this work; if not, write to the Free Software Foundation,\n- * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n- *\n- * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n- * or visit www.oracle.com if you need additional information or have any\n- * questions.\n- *\/\n-package jdk.vm.ci.hotspot.test;\n-\n-import static java.lang.reflect.Modifier.FINAL;\n-import static java.lang.reflect.Modifier.PRIVATE;\n-import static java.lang.reflect.Modifier.PROTECTED;\n-import static java.lang.reflect.Modifier.PUBLIC;\n-import static java.lang.reflect.Modifier.STATIC;\n-import static java.lang.reflect.Modifier.TRANSIENT;\n-import static java.lang.reflect.Modifier.VOLATILE;\n-\n-import java.lang.reflect.Field;\n-import java.lang.reflect.InvocationTargetException;\n-import java.lang.reflect.Method;\n-\n-import org.junit.Assert;\n-import org.junit.Test;\n-\n-import jdk.vm.ci.hotspot.HotSpotJVMCIRuntime;\n-import jdk.vm.ci.hotspot.HotSpotResolvedJavaField;\n-import jdk.vm.ci.hotspot.HotSpotVMConfigAccess;\n-import jdk.vm.ci.meta.JavaType;\n-import jdk.vm.ci.meta.MetaAccessProvider;\n-import jdk.vm.ci.meta.ResolvedJavaField;\n-import jdk.vm.ci.meta.ResolvedJavaType;\n-import jdk.vm.ci.runtime.JVMCI;\n-\n-\/**\n- * Tests {@link HotSpotResolvedJavaField} functionality.\n- *\/\n-public class HotSpotResolvedJavaFieldTest {\n-\n-    private static final Class<?>[] classesWithInternalFields = {Class.class, ClassLoader.class};\n-\n-    private static final Method createFieldMethod;\n-    private static final Field indexField;\n-\n-    static {\n-        Method m = null;\n-        Field f = null;\n-        try {\n-            Class<?> typeImpl = Class.forName(\"jdk.vm.ci.hotspot.HotSpotResolvedObjectTypeImpl\");\n-            m = typeImpl.getDeclaredMethod(\"createField\", JavaType.class, long.class, int.class, int.class);\n-            m.setAccessible(true);\n-            Class<?> fieldImpl = Class.forName(\"jdk.vm.ci.hotspot.HotSpotResolvedJavaFieldImpl\");\n-            f = fieldImpl.getDeclaredField(\"index\");\n-            f.setAccessible(true);\n-        } catch (Exception e) {\n-            throw new AssertionError(e);\n-        }\n-\n-        createFieldMethod = m;\n-        indexField = f;\n-    }\n-\n-    \/**\n-     * Same as {@code HotSpotModifiers.jvmFieldModifiers()} but works when using a JVMCI version\n-     * prior to the introduction of that method.\n-     *\/\n-    private int jvmFieldModifiers() {\n-        HotSpotJVMCIRuntime runtime = runtime();\n-        HotSpotVMConfigAccess access = new HotSpotVMConfigAccess(runtime.getConfigStore());\n-        int accEnum = access.getConstant(\"JVM_ACC_ENUM\", Integer.class, 0x4000);\n-        int accSynthetic = access.getConstant(\"JVM_ACC_SYNTHETIC\", Integer.class, 0x1000);\n-        return PUBLIC | PRIVATE | PROTECTED | STATIC | FINAL | VOLATILE | TRANSIENT | accEnum | accSynthetic;\n-    }\n-\n-    HotSpotJVMCIRuntime runtime() {\n-        return (HotSpotJVMCIRuntime) JVMCI.getRuntime();\n-    }\n-\n-    MetaAccessProvider getMetaAccess() {\n-        return runtime().getHostJVMCIBackend().getMetaAccess();\n-    }\n-\n-    \/**\n-     * Tests that {@link HotSpotResolvedJavaField#getModifiers()} only includes the modifiers\n-     * returned by {@link Field#getModifiers()}. Namely, it must not include\n-     * {@code HotSpotResolvedJavaField#FIELD_INTERNAL_FLAG}.\n-     *\/\n-    @Test\n-    public void testModifiersForInternal() {\n-        for (Class<?> c : classesWithInternalFields) {\n-            ResolvedJavaType type = getMetaAccess().lookupJavaType(c);\n-            for (ResolvedJavaField field : type.getInstanceFields(false)) {\n-                if (field.isInternal()) {\n-                    Assert.assertEquals(0, ~jvmFieldModifiers() & field.getModifiers());\n-                }\n-            }\n-        }\n-    }\n-\n-    \/**\n-     * Tests that {@code HotSpotResolvedObjectTypeImpl#createField(String, JavaType, long, int)}\n-     * always returns an {@linkplain ResolvedJavaField#equals(Object) equivalent} object for an\n-     * internal field.\n-     *\n-     * @throws InvocationTargetException\n-     * @throws IllegalArgumentException\n-     * @throws IllegalAccessException\n-     *\/\n-    @Test\n-    public void testEquivalenceForInternalFields() throws IllegalAccessException, IllegalArgumentException, InvocationTargetException {\n-        for (Class<?> c : classesWithInternalFields) {\n-            ResolvedJavaType type = getMetaAccess().lookupJavaType(c);\n-            for (ResolvedJavaField field : type.getInstanceFields(false)) {\n-                if (field.isInternal()) {\n-                    HotSpotResolvedJavaField expected = (HotSpotResolvedJavaField) field;\n-                    int index = indexField.getInt(expected);\n-                    ResolvedJavaField actual = (ResolvedJavaField) createFieldMethod.invoke(type, expected.getType(), expected.getOffset(), expected.getModifiers(), index);\n-                    Assert.assertEquals(expected, actual);\n-                }\n-            }\n-        }\n-    }\n-\n-    @Test\n-    public void testIsInObject() {\n-        for (Field f : String.class.getDeclaredFields()) {\n-            HotSpotResolvedJavaField rf = (HotSpotResolvedJavaField) getMetaAccess().lookupJavaField(f);\n-            Assert.assertEquals(rf.toString(), rf.isInObject(runtime().getHostJVMCIBackend().getConstantReflection().forString(\"a string\")), !rf.isStatic());\n-        }\n-    }\n-}\n","filename":"test\/hotspot\/jtreg\/compiler\/jvmci\/jdk.vm.ci.hotspot.test\/src\/jdk\/vm\/ci\/hotspot\/test\/HotSpotResolvedJavaFieldTest.java","additions":0,"deletions":145,"binary":false,"changes":145,"status":"deleted"},{"patch":"@@ -1,66 +0,0 @@\n-\/*\n- * Copyright (c) 2022, Oracle and\/or its affiliates. All rights reserved.\n- * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n- *\n- * This code is free software; you can redistribute it and\/or modify it\n- * under the terms of the GNU General Public License version 2 only, as\n- * published by the Free Software Foundation.\n- *\n- * This code is distributed in the hope that it will be useful, but WITHOUT\n- * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n- * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n- * version 2 for more details (a copy is included in the LICENSE file that\n- * accompanied this code).\n- *\n- * You should have received a copy of the GNU General Public License version\n- * 2 along with this work; if not, write to the Free Software Foundation,\n- * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n- *\n- * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n- * or visit www.oracle.com if you need additional information or have any\n- * questions.\n- *\/\n-\n-\/*\n- * @test\n- * @requires vm.jvmci\n- * @modules jdk.internal.vm.ci\/jdk.vm.ci.hotspot\n- *          jdk.internal.vm.ci\/jdk.vm.ci.meta\n- * @library \/compiler\/jvmci\/common\/patches\n- * @build jdk.internal.vm.ci\/jdk.vm.ci.hotspot.HotSpotResolvedJavaFieldHelper\n- * @run testng\/othervm\n- *      -XX:+UnlockExperimentalVMOptions -XX:+EnableJVMCI -XX:-UseJVMCICompiler\n- *      jdk.vm.ci.hotspot.test.TestHotSpotResolvedJavaField\n- *\/\n-\n-package jdk.vm.ci.hotspot.test;\n-\n-import org.testng.Assert;\n-import org.testng.annotations.Test;\n-\n-import jdk.vm.ci.hotspot.HotSpotResolvedJavaFieldHelper;\n-import jdk.vm.ci.meta.ResolvedJavaField;\n-\n-public class TestHotSpotResolvedJavaField {\n-\n-    @Test\n-    public void testIndex() {\n-        int max = Character.MAX_VALUE;\n-        int[] valid = {0, 1, max - 1, max};\n-        for (int index : valid) {\n-            ResolvedJavaField field = HotSpotResolvedJavaFieldHelper.createField(null, null, 0, 0, index);\n-            Assert.assertEquals(HotSpotResolvedJavaFieldHelper.getIndex(field), index);\n-        }\n-    }\n-\n-    @Test\n-    public void testOffset() {\n-        int min = Integer.MIN_VALUE;\n-        int max = Integer.MAX_VALUE;\n-        int[] valid = {min, min + 1, -2, 0, 1, max - 1, max};\n-        for (int offset : valid) {\n-            ResolvedJavaField field = HotSpotResolvedJavaFieldHelper.createField(null, null, offset, 0, 0);\n-            Assert.assertEquals(field.getOffset(), offset);\n-        }\n-    }\n-}\n","filename":"test\/hotspot\/jtreg\/compiler\/jvmci\/jdk.vm.ci.hotspot.test\/src\/jdk\/vm\/ci\/hotspot\/test\/TestHotSpotResolvedJavaField.java","additions":0,"deletions":66,"binary":false,"changes":66,"status":"deleted"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2012, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2012, 2020, Oracle and\/or its affiliates. All rights reserved.\n@@ -28,0 +28,1 @@\n+ * @ignore 8249621\n@@ -30,1 +31,0 @@\n- *          jdk.internal.vm.ci\/jdk.vm.ci.common\n@@ -40,2 +40,0 @@\n-import static org.junit.Assert.assertNotEquals;\n-import static org.junit.Assert.assertNull;\n@@ -51,1 +49,0 @@\n-import java.lang.reflect.Modifier;\n@@ -60,3 +57,0 @@\n-import jdk.vm.ci.common.JVMCIError;\n-import jdk.vm.ci.meta.ConstantReflectionProvider;\n-import jdk.vm.ci.meta.JavaConstant;\n@@ -126,48 +120,0 @@\n-    @Test\n-    public void getDeclaringClassTest() {\n-        for (Map.Entry<Field, ResolvedJavaField> e : fields.entrySet()) {\n-            ResolvedJavaField field = e.getValue();\n-            ResolvedJavaType actual = field.getDeclaringClass();\n-            ResolvedJavaType expect = metaAccess.lookupJavaType(e.getKey().getDeclaringClass());\n-            assertEquals(field.toString(), expect, actual);\n-        }\n-    }\n-\n-    @Test\n-    public void getOffsetTest() {\n-        for (Map.Entry<Field, ResolvedJavaField> e : fields.entrySet()) {\n-            Field javaField = e.getKey();\n-            ResolvedJavaField field = e.getValue();\n-            int actual = field.getOffset();\n-            long expect = field.isStatic() ? unsafe.staticFieldOffset(javaField) : unsafe.objectFieldOffset(javaField);\n-            assertEquals(field.toString(), expect, actual);\n-        }\n-    }\n-\n-    @Test\n-    public void isFinalTest() {\n-        for (Map.Entry<Field, ResolvedJavaField> e : fields.entrySet()) {\n-            ResolvedJavaField field = e.getValue();\n-            boolean actual = field.isFinal();\n-            boolean expect = Modifier.isFinal(e.getKey().getModifiers());\n-            assertEquals(field.toString(), expect, actual);\n-        }\n-    }\n-\n-    @Test\n-    public void isInternalTest() {\n-        for (Class<?> c : classes) {\n-            ResolvedJavaType type = metaAccess.lookupJavaType(c);\n-            for (ResolvedJavaField field : type.getInstanceFields(false)) {\n-                if (field.isInternal()) {\n-                    try {\n-                        c.getDeclaredField(field.getName());\n-                        throw new AssertionError(\"got reflection object for internal field: \" + field);\n-                    } catch (NoSuchFieldException e) {\n-                        \/\/ expected\n-                    }\n-                }\n-            }\n-        }\n-    }\n-\n@@ -186,0 +132,4 @@\n+        \"getDeclaringClass\",\n+        \"getOffset\",\n+        \"isInternal\",\n+        \"isFinal\"\n@@ -285,64 +235,0 @@\n-\n-    @Test\n-    public void getConstantValueTest() {\n-        ConstantReflectionProvider cr = constantReflection;\n-        Map<String, JavaConstant> expects = Map.of(\n-                        \"INT\", JavaConstant.forInt(42),\n-                        \"SHORT\", JavaConstant.forInt(43),\n-                        \"CHAR\", JavaConstant.forInt(44),\n-                        \"BYTE\", JavaConstant.forInt(45),\n-                        \"FLOAT\", JavaConstant.forFloat(46.46F),\n-                        \"LONG\", JavaConstant.forLong(47L),\n-                        \"DOUBLE\", JavaConstant.forDouble(48.48D));\n-        ResolvedJavaType type = metaAccess.lookupJavaType(FieldsWithConstantValueAttributes.class);\n-        for (ResolvedJavaField field : type.getStaticFields()) {\n-            JavaConstant actual = field.getConstantValue();\n-            String name = field.getName();\n-            if (name.endsWith(\"2\")) {\n-                assertNull(field.toString(), actual);\n-            } else if (name.equals(\"STRING\")) {\n-                JavaConstant expect = cr.forString(\"STRING_VALUE\");\n-                assertEquals(field.toString(), expect, actual);\n-\n-                \/\/ String ConstantValues are interned so should not\n-                \/\/ be identical to a newly allocated String\n-                expect = cr.forString(new String(\"STRING_VALUE\"));\n-                assertNotEquals(field.toString(), expect, actual);\n-            } else {\n-                JavaConstant expect = expects.get(name);\n-                assertEquals(field.toString(), expect, actual);\n-            }\n-        }\n-    }\n-}\n-\n-class FieldsWithConstantValueAttributes {\n-    public static final String STRING = \"STRING_VALUE\";\n-    public static final int INT = 42;\n-    public static final short SHORT = 43;\n-    public static final char CHAR = 44;\n-    public static final byte BYTE = 45;\n-    public static final float FLOAT = 46.46F;\n-    public static final long LONG = 47L;\n-    public static final double DOUBLE = 48.48D;\n-\n-    public static final String STRING2;\n-    public static final int INT2;\n-    public static final short SHORT2;\n-    public static final char CHAR2;\n-    public static final byte BYTE2;\n-    public static final float FLOAT2;\n-    public static final long LONG2;\n-    public static final double DOUBLE2;\n-\n-    static {\n-        JVMCIError.shouldNotReachHere(\"should not be initialized\");\n-        STRING2 = STRING;\n-        INT2 = INT;\n-        SHORT2 = SHORT;\n-        BYTE2 = BYTE;\n-        CHAR2 = CHAR;\n-        FLOAT2 = FLOAT;\n-        LONG2 = LONG;\n-        DOUBLE2 = DOUBLE;\n-    }\n","filename":"test\/hotspot\/jtreg\/compiler\/jvmci\/jdk.vm.ci.runtime.test\/src\/jdk\/vm\/ci\/runtime\/test\/TestResolvedJavaField.java","additions":6,"deletions":120,"binary":false,"changes":126,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2012, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2012, 2020, Oracle and\/or its affiliates. All rights reserved.\n@@ -48,1 +48,0 @@\n-import java.lang.reflect.Executable;\n@@ -53,1 +52,0 @@\n-import java.util.ArrayList;\n@@ -57,1 +55,0 @@\n-import java.util.List;\n@@ -83,2 +80,2 @@\n-        for (ResolvedJavaMethod m : joinValues(methods, constructors)) {\n-            String ms = m.toString();\n+        for (Map.Entry<Method, ResolvedJavaMethod> e : methods.entrySet()) {\n+            ResolvedJavaMethod m = e.getValue();\n@@ -87,1 +84,1 @@\n-                assertEquals(ms, m.getCodeSize(), 0);\n+                assertTrue(m.getCodeSize() == 0);\n@@ -89,1 +86,5 @@\n-                assertTrue(ms, code.length > 0);\n+                if (m.isAbstract()) {\n+                    assertTrue(code.length == 0);\n+                } else if (!m.isNative()) {\n+                    assertTrue(code.length > 0);\n+                }\n@@ -99,3 +100,2 @@\n-        ResolvedJavaType unlinkedType = metaAccess.lookupJavaType(UnlinkedType.class);\n-        assertTrue(!unlinkedType.isLinked());\n-        for (ResolvedJavaMethod m : addExecutables(joinValues(methods, constructors), unlinkedType, false)) {\n+        for (Map.Entry<Method, ResolvedJavaMethod> e : methods.entrySet()) {\n+            ResolvedJavaMethod m = e.getValue();\n@@ -103,7 +103,4 @@\n-            String ms = m.toString();\n-            if (m.isAbstract() || m.isNative()) {\n-                assertEquals(ms, codeSize, 0);\n-            } else if (!m.getDeclaringClass().isLinked()) {\n-                assertEquals(ms, -1, codeSize);\n-            } else {\n-                assertTrue(ms, codeSize > 0);\n+            if (m.isAbstract()) {\n+                assertTrue(codeSize == 0);\n+            } else if (!m.isNative()) {\n+                assertTrue(codeSize > 0);\n@@ -112,1 +109,0 @@\n-        assertTrue(!unlinkedType.isLinked());\n@@ -117,3 +113,2 @@\n-        List<ResolvedJavaMethod> executables = joinValues(methods, constructors);\n-        for (ResolvedJavaMethod m : executables) {\n-            for (ResolvedJavaMethod that : executables) {\n+        for (ResolvedJavaMethod m : methods.values()) {\n+            for (ResolvedJavaMethod that : methods.values()) {\n@@ -129,1 +124,7 @@\n-        for (Map.Entry<Executable, ResolvedJavaMethod> e : join(methods, constructors).entrySet()) {\n+        for (Map.Entry<Method, ResolvedJavaMethod> e : methods.entrySet()) {\n+            ResolvedJavaMethod m = e.getValue();\n+            int expected = e.getKey().getModifiers();\n+            int actual = m.getModifiers();\n+            assertEquals(String.format(\"%s: 0x%x != 0x%x\", m, expected, actual), expected, actual);\n+        }\n+        for (Map.Entry<Constructor<?>, ResolvedJavaMethod> e : constructors.entrySet()) {\n@@ -142,1 +143,1 @@\n-        for (Map.Entry<Executable, ResolvedJavaMethod> e : join(methods, constructors).entrySet()) {\n+        for (Map.Entry<Method, ResolvedJavaMethod> e : methods.entrySet()) {\n@@ -147,0 +148,4 @@\n+        for (Map.Entry<Constructor<?>, ResolvedJavaMethod> e : constructors.entrySet()) {\n+            ResolvedJavaMethod m = e.getValue();\n+            assertFalse(m.isClassInitializer());\n+        }\n@@ -163,1 +168,5 @@\n-        for (Map.Entry<Executable, ResolvedJavaMethod> e : join(methods, constructors).entrySet()) {\n+        for (Map.Entry<Method, ResolvedJavaMethod> e : methods.entrySet()) {\n+            ResolvedJavaMethod m = e.getValue();\n+            assertEquals(e.getKey().isSynthetic(), m.isSynthetic());\n+        }\n+        for (Map.Entry<Constructor<?>, ResolvedJavaMethod> e : constructors.entrySet()) {\n@@ -183,1 +192,5 @@\n-        for (Map.Entry<Executable, ResolvedJavaMethod> e : join(methods, constructors).entrySet()) {\n+        for (Map.Entry<Method, ResolvedJavaMethod> e : methods.entrySet()) {\n+            ResolvedJavaMethod m = e.getValue();\n+            assertEquals(e.getKey().isVarArgs(), m.isVarArgs());\n+        }\n+        for (Map.Entry<Constructor<?>, ResolvedJavaMethod> e : constructors.entrySet()) {\n@@ -191,1 +204,5 @@\n-        for (Map.Entry<Executable, ResolvedJavaMethod> e : join(methods, constructors).entrySet()) {\n+        for (Map.Entry<Method, ResolvedJavaMethod> e : methods.entrySet()) {\n+            ResolvedJavaMethod m = e.getValue();\n+            assertEquals(Modifier.isSynchronized(e.getKey().getModifiers()), m.isSynchronized());\n+        }\n+        for (Map.Entry<Constructor<?>, ResolvedJavaMethod> e : constructors.entrySet()) {\n@@ -214,5 +231,5 @@\n-                        Modifier.isPrivate(modifiers) ||\n-                        Modifier.isStatic(modifiers) ||\n-                        method instanceof Constructor ||\n-                        Modifier.isFinal(method.getDeclaringClass().getModifiers())) &&\n-                        !Modifier.isAbstract(modifiers);\n+                Modifier.isPrivate(modifiers) ||\n+                Modifier.isStatic(modifiers) ||\n+                method instanceof Constructor ||\n+                Modifier.isFinal(method.getDeclaringClass().getModifiers())) &&\n+                !Modifier.isAbstract(modifiers);\n@@ -265,1 +282,1 @@\n-        for (Map.Entry<Executable, ResolvedJavaMethod> e : join(methods, constructors).entrySet()) {\n+        for (Map.Entry<Method, ResolvedJavaMethod> e : methods.entrySet()) {\n@@ -402,6 +419,0 @@\n-    public static List<ResolvedJavaMethod> addExecutables(List<ResolvedJavaMethod> to, ResolvedJavaType declaringType, boolean forceLink) {\n-        to.addAll(List.of(declaringType.getDeclaredMethods(forceLink)));\n-        to.addAll(List.of(declaringType.getDeclaredConstructors(forceLink)));\n-        return to;\n-    }\n-\n@@ -410,6 +421,7 @@\n-        ResolvedJavaType unlinkedType = metaAccess.lookupJavaType(UnlinkedType.class);\n-        assertTrue(!unlinkedType.isLinked());\n-        for (ResolvedJavaMethod m : addExecutables(joinValues(methods, constructors), unlinkedType, false)) {\n-            boolean expect = m.getDeclaringClass().isLinked() && m.isConcrete() && !m.isNative();\n-            boolean actual = m.hasBytecodes();\n-            assertEquals(m.toString(), expect, actual);\n+        for (Map.Entry<Method, ResolvedJavaMethod> e : methods.entrySet()) {\n+            ResolvedJavaMethod m = e.getValue();\n+            assertTrue(m.hasBytecodes() == (m.isConcrete() && !m.isNative()));\n+        }\n+        for (Map.Entry<Constructor<?>, ResolvedJavaMethod> e : constructors.entrySet()) {\n+            ResolvedJavaMethod m = e.getValue();\n+            assertTrue(m.hasBytecodes());\n@@ -417,1 +429,0 @@\n-        assertTrue(!unlinkedType.isLinked());\n@@ -439,7 +450,1 @@\n-    abstract static class UnlinkedType {\n-        abstract void abstractMethod();\n-\n-        void concreteMethod() {\n-        }\n-\n-        native void nativeMethod();\n+    static class UnlinkedType {\n@@ -528,18 +533,0 @@\n-\n-    @SafeVarargs\n-    public static <K, V> Map<K, V> join(Map<? extends K, V>... maps) {\n-        Map<K, V> res = new HashMap<>();\n-        for (Map<? extends K, V> e : maps) {\n-            res.putAll(e);\n-        }\n-        return res;\n-    }\n-\n-    @SafeVarargs\n-    public static <V> List<V> joinValues(Map<?, V>... maps) {\n-        List<V> res = new ArrayList<>();\n-        for (Map<?, V> e : maps) {\n-            res.addAll(e.values());\n-        }\n-        return res;\n-    }\n","filename":"test\/hotspot\/jtreg\/compiler\/jvmci\/jdk.vm.ci.runtime.test\/src\/jdk\/vm\/ci\/runtime\/test\/TestResolvedJavaMethod.java","additions":58,"deletions":71,"binary":false,"changes":129,"status":"modified"},{"patch":"@@ -170,2 +170,3 @@\n-        String optoRegex = \"(.*precise .*\\\\R((.*(?i:mov|xorl|nop|spill).*|\\\\s*)\\\\R)*.*(?i:call,static).*wrapper for: _new_instance_Java\" + END;\n-        allocNodes(ALLOC, \"Allocate\", optoRegex);\n+        String idealIndependentRegex = START + \"Allocate\" + MID + END;\n+        String optoRegex = \"(.*precise .*\\\\R((.*(?i:mov|xorl|nop|spill).*|\\\\s*|.*LGHI.*)\\\\R)*.*(?i:call,static).*wrapper for: _new_instance_Java\" + END;\n+        allocNodes(ALLOC, idealIndependentRegex, optoRegex);\n@@ -176,1 +177,1 @@\n-        String regex = \"(.*precise .*\" + IS_REPLACED + \":.*\\\\R((.*(?i:mov|xorl|nop|spill).*|\\\\s*)\\\\R)*.*(?i:call,static).*wrapper for: _new_instance_Java\" + END;\n+        String regex = \"(.*precise .*\" + IS_REPLACED + \":.*\\\\R((.*(?i:mov|xorl|nop|spill).*|\\\\s*|.*LGHI.*)\\\\R)*.*(?i:call,static).*wrapper for: _new_instance_Java\" + END;\n@@ -182,2 +183,3 @@\n-        String optoRegex = \"(.*precise \\\\[.*\\\\R((.*(?i:mov|xor|nop|spill).*|\\\\s*|.*(LGHI|LI).*)\\\\R)*.*(?i:call,static).*wrapper for: _new_array_Java\" + END;\n-        allocNodes(ALLOC_ARRAY, \"AllocateArray\", optoRegex);\n+        String idealIndependentRegex = START + \"AllocateArray\" + MID + END;\n+        String optoRegex = \"(.*precise \\\\[.*\\\\R((.*(?i:mov|xor|nop|spill).*|\\\\s*|.*LGHI.*)\\\\R)*.*(?i:call,static).*wrapper for: _new_array_Java\" + END;\n+        allocNodes(ALLOC_ARRAY, idealIndependentRegex, optoRegex);\n@@ -188,1 +190,1 @@\n-        String regex = \"(.*precise \\\\[.*\" + IS_REPLACED + \":.*\\\\R((.*(?i:mov|xorl|nop|spill).*|\\\\s*|.*(LGHI|LI).*)\\\\R)*.*(?i:call,static).*wrapper for: _new_array_Java\" + END;\n+        String regex = \"(.*precise \\\\[.*\" + IS_REPLACED + \":.*\\\\R((.*(?i:mov|xorl|nop|spill).*|\\\\s*|.*LGHI.*)\\\\R)*.*(?i:call,static).*wrapper for: _new_array_Java\" + END;\n@@ -1183,2 +1185,1 @@\n-    private static void allocNodes(String irNode, String irNodeName, String optoRegex) {\n-        String idealIndependentRegex = START + irNodeName + \"\\\\b\" + MID + END;\n+    private static void allocNodes(String irNode, String idealRegex, String optoRegex) {\n@@ -1187,1 +1188,1 @@\n-                               idealIndependentRegex);\n+                               idealRegex);\n","filename":"test\/hotspot\/jtreg\/compiler\/lib\/ir_framework\/IRNode.java","additions":10,"deletions":9,"binary":false,"changes":19,"status":"modified"},{"patch":"@@ -1,72 +0,0 @@\n-\/*\n- * Copyright (c) 2022, Red Hat, Inc. All rights reserved.\n- * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n- *\n- * This code is free software; you can redistribute it and\/or modify it\n- * under the terms of the GNU General Public License version 2 only, as\n- * published by the Free Software Foundation.\n- *\n- * This code is distributed in the hope that it will be useful, but WITHOUT\n- * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n- * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n- * version 2 for more details (a copy is included in the LICENSE file that\n- * accompanied this code).\n- *\n- * You should have received a copy of the GNU General Public License version\n- * 2 along with this work; if not, write to the Free Software Foundation,\n- * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n- *\n- * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n- * or visit www.oracle.com if you need additional information or have any\n- * questions.\n- *\/\n-\n-\/**\n- * @test\n- * @bug 8294217\n- * @summary Assertion failure: parsing found no loops but there are some\n- * @library \/test\/lib\n- *\n- * @run main\/othervm -Xmx1G -XX:-BackgroundCompilation TestInfiniteLoopNest\n- *\n- *\/\n-\n-import jdk.test.lib.Utils;\n-\n-public class TestInfiniteLoopNest {\n-    long l;\n-\n-    void q() {\n-        if (b) {\n-            Object o = new Object();\n-            return;\n-        }\n-\n-        do {\n-            l++;\n-            while (l != 1) --l;\n-            l = 9;\n-        } while (l != 5);\n-\n-    }\n-\n-    public static void main(String[] p) throws Exception {\n-        Thread thread = new Thread() {\n-            public void run() {\n-                TestInfiniteLoopNest t = new TestInfiniteLoopNest();\n-                for (int i = 524; i < 19710; i += 1) {\n-                    b = true;\n-                    t.q();\n-                    b = false;\n-                }\n-                t.q();\n-            }\n-        };\n-        \/\/ Give thread some time to trigger compilation\n-        thread.setDaemon(true);\n-        thread.start();\n-        Thread.sleep(Utils.adjustTimeout(4000));\n-    }\n-\n-    static Boolean b;\n-}\n","filename":"test\/hotspot\/jtreg\/compiler\/loopopts\/TestInfiniteLoopNest.java","additions":0,"deletions":72,"binary":false,"changes":72,"status":"deleted"},{"patch":"@@ -1,65 +0,0 @@\n-\/*\n- * Copyright (c) 2022, Arm Limited. All rights reserved.\n- * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n- *\n- * This code is free software; you can redistribute it and\/or modify it\n- * under the terms of the GNU General Public License version 2 only, as\n- * published by the Free Software Foundation.\n- *\n- * This code is distributed in the hope that it will be useful, but WITHOUT\n- * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n- * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n- * version 2 for more details (a copy is included in the LICENSE file that\n- * accompanied this code).\n- *\n- * You should have received a copy of the GNU General Public License version\n- * 2 along with this work; if not, write to the Free Software Foundation,\n- * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n- *\n- * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n- * or visit www.oracle.com if you need additional information or have any\n- * questions.\n- *\/\n-\n-\/*\n- * @test\n- * @bug 8295407\n- * @summary Superword should remove unsupported cmove packs from candidate packset\n- * @library \/test\/lib \/\n- * @run main TestUnsupportedConditionalMove\n- *\/\n-\n-import jdk.test.lib.Asserts;\n-\n-public class TestUnsupportedConditionalMove {\n-    public static int LENGTH = 3000;\n-    public static float[] fa = new float[LENGTH];\n-    public static float[] fb = new float[LENGTH];\n-    public static boolean[] mask = new boolean[LENGTH];\n-\n-    public static void test() {\n-        for (int i = 0; i < fa.length; i++) {\n-            fb[i] = mask[i]? fa[i]: -fa[i];\n-        }\n-    }\n-\n-    public static void main(String[] k) {\n-        for (int i= 0; i < LENGTH; i++) {\n-            mask[i] = (i % 3 == 0);\n-            fa[i] = i + 1.0f;\n-        }\n-\n-        for (int i = 0; i < 10_000; i++) {\n-            test();\n-        }\n-\n-        for (int i = 0; i < LENGTH; i++) {\n-            if (i % 3 == 0) {\n-                Asserts.assertEquals(fb[i], i + 1.0f);\n-            } else {\n-                Asserts.assertEquals(fb[i], - (i + 1.0f));\n-            }\n-        }\n-    }\n-\n-}\n","filename":"test\/hotspot\/jtreg\/compiler\/loopopts\/TestUnsupportedConditionalMove.java","additions":0,"deletions":65,"binary":false,"changes":65,"status":"deleted"},{"patch":"@@ -1,61 +0,0 @@\n-\/*\n- * Copyright (c) 2022, Red Hat, Inc. All rights reserved.\n- * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n- *\n- * This code is free software; you can redistribute it and\/or modify it\n- * under the terms of the GNU General Public License version 2 only, as\n- * published by the Free Software Foundation.\n- *\n- * This code is distributed in the hope that it will be useful, but WITHOUT\n- * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n- * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n- * version 2 for more details (a copy is included in the LICENSE file that\n- * accompanied this code).\n- *\n- * You should have received a copy of the GNU General Public License version\n- * 2 along with this work; if not, write to the Free Software Foundation,\n- * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n- *\n- * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n- * or visit www.oracle.com if you need additional information or have any\n- * questions.\n- *\/\n-\n-\/**\n- * @test\n- * @bug 8295788\n- * @summary C2 compilation hits \"assert((mode == ControlAroundStripMined && use == sfpt) || !use->is_reachable_from_root()) failed: missed a node\"\n- *\n- * @run main\/othervm -Xcomp -XX:CompileOnly=TestUseFromInnerInOuterUnusedBySfpt TestUseFromInnerInOuterUnusedBySfpt\n- *\n- *\/\n-\n-public class TestUseFromInnerInOuterUnusedBySfpt {\n-\n-    public static final int N = 400;\n-\n-    public static void dMeth(long l, int i5, int i6) {\n-\n-        int i7=14, i8=-14, i9=7476, i11=0;\n-        long lArr[]=new long[N];\n-\n-        for (i7 = 3; i7 < 177; i7++) {\n-            lArr[i7 + 1] >>= l;\n-            l -= i8;\n-            i6 = (int)l;\n-        }\n-        for (i9 = 15; i9 < 356; i9 += 3) {\n-            i11 = 14;\n-            do {\n-                i5 |= i6;\n-            } while (--i11 > 0);\n-        }\n-    }\n-\n-    public static void main(String[] strArr) {\n-        TestUseFromInnerInOuterUnusedBySfpt _instance = new TestUseFromInnerInOuterUnusedBySfpt();\n-        for (int i = 0; i < 10; i++) {\n-            _instance.dMeth(-12L, -50242, 20);\n-        }\n-    }\n-}\n","filename":"test\/hotspot\/jtreg\/compiler\/loopstripmining\/TestUseFromInnerInOuterUnusedBySfpt.java","additions":0,"deletions":61,"binary":false,"changes":61,"status":"deleted"},{"patch":"@@ -1,125 +0,0 @@\n-\/*\n- * Copyright (c) 2022, Oracle and\/or its affiliates. All rights reserved.\n- * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n- *\n- * This code is free software; you can redistribute it and\/or modify it\n- * under the terms of the GNU General Public License version 2 only, as\n- * published by the Free Software Foundation.\n- *\n- * This code is distributed in the hope that it will be useful, but WITHOUT\n- * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n- * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n- * version 2 for more details (a copy is included in the LICENSE file that\n- * accompanied this code).\n- *\n- * You should have received a copy of the GNU General Public License version\n- * 2 along with this work; if not, write to the Free Software Foundation,\n- * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n- *\n- * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n- * or visit www.oracle.com if you need additional information or have any\n- * questions.\n- *\/\n-\n-package compiler.vectorapi;\n-\n-import jdk.incubator.vector.IntVector;\n-import jdk.test.lib.Asserts;\n-\n-\/*\n- * @test\n- * @bug 8276064 8271600\n- * @summary Verify that CheckCastPPs with raw oop inputs are not floating below a safepoint.\n- * @library \/test\/lib\n- * @modules jdk.incubator.vector\n- * @run main\/othervm -XX:-TieredCompilation -Xbatch\n- *                   -XX:CompileCommand=compileonly,compiler.vectorapi.TestRawOopAtSafepoint::test*\n- *                   -XX:CompileCommand=dontinline,compiler.vectorapi.TestRawOopAtSafepoint::safepoint\n- *                   compiler.vectorapi.TestRawOopAtSafepoint\n- *\/\n-public class TestRawOopAtSafepoint {\n-\n-    static int iFld = 42;\n-\n-    public static void safepoint(boolean gc) {\n-        if (gc) {\n-            \/\/ Give the GC a chance to move the IntVector object on the heap\n-            \/\/ and thus invalidate the oop if it's not in the oopMap.\n-            System.gc();\n-        }\n-    }\n-\n-    \/\/ Loop unswitching moves a CheckCastPP out of a loop such that the raw oop\n-    \/\/ input crosses a safepoint. We then SIGSEGV after the GC moved the IntVector\n-    \/\/ object when deferencing the now stale oop.\n-    public static IntVector test1(boolean flag, boolean gc) {\n-        IntVector vector = null;\n-        for (int i = 0; i < 100; i++) {\n-            \/\/ Trigger loop unswitching\n-            if (flag) {\n-                iFld++;\n-            }\n-            \/\/ Allocate an IntVector that will be scalarized in the\n-            \/\/ safepoint debug info but not in the return.\n-            vector = IntVector.zero(IntVector.SPECIES_MAX);\n-            safepoint((i == 99) && gc);\n-        }\n-        return vector;\n-    }\n-\n-    \/\/ Same as test1 but we hit an assert in OopFlow::build_oop_map instead.\n-    public static IntVector test2(boolean flag, boolean gc) {\n-        for (int i = 0; i < 100; i++) {\n-            \/\/ Trigger loop unswitching\n-            if (flag) {\n-                iFld++;\n-            }\n-            IntVector vector = IntVector.zero(IntVector.SPECIES_MAX);\n-            safepoint((i == 99) && gc);\n-            if (flag) {\n-                return vector;\n-            }\n-        }\n-        return IntVector.zero(IntVector.SPECIES_MAX);\n-    }\n-\n-    \/\/ Same as test1 but PhaseIdealLoop::try_sink_out_of_loop moves the CheckCastPP.\n-    public static IntVector test3(boolean flag, boolean gc) {\n-        IntVector vector = null;\n-        for (int i = 0; i < 10; i++) {\n-            vector = IntVector.zero(IntVector.SPECIES_MAX);\n-            safepoint((i == 9) && gc);\n-        }\n-        return vector;\n-    }\n-\n-    \/\/ Same as test2 but PhaseIdealLoop::try_sink_out_of_loop moves the CheckCastPP.\n-    public static IntVector test4(boolean flag, boolean gc) {\n-        IntVector vector = null;\n-        for (int i = 0; i < 2; i++) {\n-            vector = IntVector.zero(IntVector.SPECIES_MAX);\n-            safepoint((i == 9) && gc);\n-        }\n-        return vector;\n-    }\n-\n-    public static void main(String[] args) {\n-        int sum = 0;\n-        for (int i = 0; i < 15_000; ++i) {\n-            boolean flag = ((i % 2) == 0);\n-            boolean gc = (i > 14_500);\n-            IntVector vector1 = test1(flag, gc);\n-            sum += vector1.lane(0);\n-\n-            IntVector vector2 = test2(flag, gc);\n-            sum += vector2.lane(0);\n-\n-            IntVector vector3 = test3(flag, gc);\n-            sum += vector3.lane(0);\n-\n-            IntVector vector4 = test4(flag, gc);\n-            sum += vector4.lane(0);\n-        }\n-        Asserts.assertEQ(sum, 0);\n-    }\n-}\n","filename":"test\/hotspot\/jtreg\/compiler\/vectorapi\/TestRawOopAtSafepoint.java","additions":0,"deletions":125,"binary":false,"changes":125,"status":"deleted"},{"patch":"@@ -54,1 +54,0 @@\n-    private static final int UNKNOWN = -100;\n@@ -86,2 +85,0 @@\n-        long hostTotalMemory = getHostTotalMemory();\n-        System.out.println(\"Debug: Host total memory is \" + hostTotalMemory);\n@@ -93,1 +90,1 @@\n-                testContainerInfo(cpus, mem, hostTotalMemory);\n+                testContainerInfo(cpus, mem);\n@@ -98,14 +95,2 @@\n-    private static long getHostTotalMemory() throws Exception {\n-        DockerRunOptions opts = Common.newOpts(imageName);\n-\n-        String hostMem = Common.run(opts).firstMatch(\"total physical memory: (\\\\d+)\", 1);\n-        try {\n-            return Long.parseLong(hostMem);\n-        } catch (NumberFormatException e) {\n-            System.out.println(\"Could not parse total physical memory '\" + hostMem + \"' returning \" + UNKNOWN);\n-            return UNKNOWN;\n-        }\n-    }\n-\n-    private static void testContainerInfo(int expectedCPUs, int expectedMemoryMB, long hostTotalMemory) throws Exception {\n-        Common.logNewTestCase(\"ContainerInfo: --cpus=\" + expectedCPUs + \" --memory=\" + expectedMemoryMB + \"m\");\n+    private static void testContainerInfo(int expectedCPUs, int expectedMemoryMB) throws Exception {\n+        Common.logNewTestCase(\"ContainerInfo: --cpus = \" + expectedCPUs + \" --memory=\" + expectedMemoryMB + \"m\");\n@@ -120,1 +105,0 @@\n-        String totalMem = \"hostTotalMemory\";\n@@ -131,2 +115,1 @@\n-            .shouldContain(memoryLimitFld + \" = \" + expectedMemoryLimit)\n-            .shouldContain(totalMem + \" = \" + hostTotalMemory);\n+            .shouldContain(memoryLimitFld + \" = \" + expectedMemoryLimit);\n","filename":"test\/hotspot\/jtreg\/containers\/docker\/TestJFREvents.java","additions":4,"deletions":21,"binary":false,"changes":25,"status":"modified"},{"patch":"@@ -1,105 +0,0 @@\n-\/*\n- * Copyright (c) 2022, Oracle and\/or its affiliates. All rights reserved.\n- * Copyright (c) 2022 SAP SE. All rights reserved.\n- * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n- *\n- * This code is free software; you can redistribute it and\/or modify it\n- * under the terms of the GNU General Public License version 2 only, as\n- * published by the Free Software Foundation.\n- *\n- * This code is distributed in the hope that it will be useful, but WITHOUT\n- * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n- * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n- * version 2 for more details (a copy is included in the LICENSE file that\n- * accompanied this code).\n- *\n- * You should have received a copy of the GNU General Public License version\n- * 2 along with this work; if not, write to the Free Software Foundation,\n- * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n- *\n- * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n- * or visit www.oracle.com if you need additional information or have any\n- * questions.\n- *\/\n-\n-import jdk.test.lib.process.OutputAnalyzer;\n-\n-import java.io.*;\n-import java.util.regex.Pattern;\n-\n-public class HsErrFileUtils {\n-\n-    \/**\n-     * Given the output of a java VM that crashed, extract the name of the hs-err file from the output\n-     *\/\n-    public static String extractHsErrFileNameFromOutput(OutputAnalyzer output) {\n-        output.shouldMatch(\"# A fatal error has been detected.*\");\n-\n-        \/\/ extract hs-err file\n-        String hs_err_file = output.firstMatch(\"# *(\\\\S*hs_err_pid\\\\d+\\\\.log)\", 1);\n-        if (hs_err_file == null) {\n-            throw new RuntimeException(\"Did not find hs-err file in output.\\n\");\n-        }\n-\n-        return hs_err_file;\n-    }\n-\n-    \/**\n-     * Given the output of a java VM that crashed, extract the name of the hs-err file from the output,\n-     * open that file and return its File.\n-     * @param output\n-     * @return\n-     *\/\n-    public static File openHsErrFileFromOutput(OutputAnalyzer output) {\n-        String name = extractHsErrFileNameFromOutput(output);\n-        File f = new File(name);\n-        if (!f.exists()) {\n-            throw new RuntimeException(\"Cannot find hs-err file at \" + f.getAbsolutePath());\n-        }\n-        return f;\n-    }\n-\n-    \/**\n-     * Given an open hs-err file, read it line by line and check for pattern. Pattern\n-     * need to appear in order, but not necessarily uninterrupted.\n-     *\/\n-    public static void checkHsErrFileContent(File f, Pattern[] patterns, boolean verbose) throws IOException {\n-\n-        FileInputStream fis = new FileInputStream(f);\n-        BufferedReader br = new BufferedReader(new InputStreamReader(fis));\n-        String line = null;\n-\n-        int currentPattern = 0;\n-\n-        String lastLine = null;\n-        while ((line = br.readLine()) != null) {\n-            if (verbose) {\n-                System.out.println(line);\n-            }\n-            if (currentPattern < patterns.length) {\n-                if (patterns[currentPattern].matcher(line).matches()) {\n-                    if (!verbose) {\n-                        System.out.println(line);\n-                    }\n-                    System.out.println(\"^^^ Match \" + currentPattern + \": matches \" + patterns[currentPattern] + \"^^^\");\n-                    currentPattern ++;\n-                }\n-            }\n-            lastLine = line;\n-        }\n-        br.close();\n-\n-        if (currentPattern < patterns.length) {\n-            throw new RuntimeException(\"hs-err file incomplete (found \" + currentPattern + \" matching pattern, \" +\n-                                       \"first missing pattern: \" + patterns[currentPattern] + \")\");\n-        }\n-\n-        if (!lastLine.equals(\"END.\")) {\n-            throw new RuntimeException(\"hs-err file incomplete (missing END marker.)\");\n-        }\n-\n-        System.out.println(\"Found all expected pattern in hs-err file at \" + f.getAbsolutePath());\n-\n-    }\n-\n-}\n","filename":"test\/hotspot\/jtreg\/runtime\/ErrorHandling\/HsErrFileUtils.java","additions":0,"deletions":105,"binary":false,"changes":105,"status":"deleted"},{"patch":"@@ -1,80 +0,0 @@\n-\/*\n- * Copyright (c) 2022, Oracle and\/or its affiliates. All rights reserved.\n- * Copyright (c) 2022 SAP SE. All rights reserved.\n- * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n- *\n- * This code is free software; you can redistribute it and\/or modify it\n- * under the terms of the GNU General Public License version 2 only, as\n- * published by the Free Software Foundation.\n- *\n- * This code is distributed in the hope that it will be useful, but WITHOUT\n- * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n- * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n- * version 2 for more details (a copy is included in the LICENSE file that\n- * accompanied this code).\n- *\n- * You should have received a copy of the GNU General Public License version\n- * 2 along with this work; if not, write to the Free Software Foundation,\n- * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n- *\n- * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n- * or visit www.oracle.com if you need additional information or have any\n- * questions.\n- *\/\n-\n-\n-\/*\n- * @test segv\n- * @summary Test that for a given crash situation we see the correct siginfo in the hs-err file\n- * @library \/test\/lib\n- * @requires vm.debug\n- * @requires os.family != \"windows\"\n- * @modules java.base\/jdk.internal.misc\n- *          java.management\n- * @run driver TestSigInfoInHsErrFile\n- *\/\n-\n-import jdk.test.lib.Platform;\n-import jdk.test.lib.process.OutputAnalyzer;\n-import jdk.test.lib.process.ProcessTools;\n-import java.io.File;\n-import java.util.ArrayList;\n-import java.util.regex.Pattern;\n-\n-public class TestSigInfoInHsErrFile {\n-\n-  public static void main(String[] args) throws Exception {\n-\n-    ProcessBuilder pb = ProcessTools.createJavaProcessBuilder(\n-        \"-XX:+UnlockDiagnosticVMOptions\",\n-        \"-Xmx100M\",\n-        \"-XX:-CreateCoredumpOnCrash\",\n-        \"-XX:ErrorHandlerTest=14\",\n-        \"-version\");\n-\n-    OutputAnalyzer output = new OutputAnalyzer(pb.start());\n-    output.shouldNotHaveExitValue(0);\n-\n-    \/\/ we should have crashed with a SIGSEGV\n-    output.shouldMatch(\"#.+SIGSEGV.*\");\n-\n-    \/\/ extract hs-err file\n-    File f = HsErrFileUtils.openHsErrFileFromOutput(output);\n-\n-    ArrayList<Pattern> patterns = new ArrayList<>();\n-    patterns.add(Pattern.compile(\"# A fatal error has been detected.*\"));\n-    patterns.add(Pattern.compile(\"# *SIGSEGV.*\"));\n-    patterns.add(Pattern.compile(\"# *Problematic frame.*\"));\n-    patterns.add(Pattern.compile(\"# .*VMError::controlled_crash.*\"));\n-\n-    \/\/ Crash address: see VMError::_segfault_address\n-    String crashAddress = Platform.isAix() ? \"0x0*1400\" : \"0x0*400\";\n-    patterns.add(Pattern.compile(\"siginfo: si_signo: \\\\d+ \\\\(SIGSEGV\\\\), si_code: \\\\d+ \\\\(SEGV_.*\\\\), si_addr: \" + crashAddress + \".*\"));\n-\n-    HsErrFileUtils.checkHsErrFileContent(f, patterns.toArray(new Pattern[] {}), true);\n-\n-  }\n-\n-}\n-\n-\n","filename":"test\/hotspot\/jtreg\/runtime\/ErrorHandling\/TestSigInfoInHsErrFile.java","additions":0,"deletions":80,"binary":false,"changes":80,"status":"deleted"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2020, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2020, 2021, Oracle and\/or its affiliates. All rights reserved.\n@@ -38,2 +38,2 @@\n-        \"shared class paths mismatch (hint: enable -Xlog:class+path=info to diagnose the failure)\",\n-        \"Unable to map shared spaces\"};\n+        \"UseSharedSpaces: shared class paths mismatch (hint: enable -Xlog:class+path=info to diagnose the failure)\",\n+        \"UseSharedSpaces: Unable to map shared spaces\"};\n","filename":"test\/hotspot\/jtreg\/runtime\/cds\/appcds\/MismatchedPathTriggerMemoryRelease.java","additions":3,"deletions":3,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -63,1 +63,1 @@\n-        \"Header checksum verification failed.\",\n+        \"UseSharedSpaces: Header checksum verification failed.\",\n","filename":"test\/hotspot\/jtreg\/runtime\/cds\/appcds\/SharedArchiveConsistency.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2018, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2018, 2020, Oracle and\/or its affiliates. All rights reserved.\n@@ -51,1 +51,1 @@\n-                            \"com\/sun\/tools\/javac\/main\/Main\"),\n+                            \"com\/sun\/tools\/sjavac\/client\/ClientMain\"),\n@@ -56,1 +56,1 @@\n-                             \"[class,load] com.sun.tools.javac.main.Main\",\n+                             \"[class,load] com.sun.tools.sjavac.client.ClientMain\",\n","filename":"test\/hotspot\/jtreg\/runtime\/cds\/appcds\/UnusedCPDuringDump.java","additions":3,"deletions":3,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -44,2 +44,1 @@\n-    String mismatchMsg = \"shared class paths mismatch\";\n-    String hintMsg = \"(hint: enable -Xlog:class+path=info to diagnose the failure)\";\n+    String mismatchMsg = \"shared class paths mismatch (hint: enable -Xlog:class+path=info to diagnose the failure)\";\n@@ -55,1 +54,1 @@\n-        .assertAbnormalExit(unableToUseMsg, mismatchMsg, hintMsg);\n+        .assertAbnormalExit(unableToUseMsg, mismatchMsg);\n@@ -60,13 +59,1 @@\n-    output.shouldContain(mismatchMsg)\n-          .shouldContain(hintMsg);\n-\n-    \/\/ Run with -Xshare:on and -Xlog:class+path=info, the mismatchMsg should\n-    \/\/ be there, the hintMsg should NOT be there.\n-    TestCommon.run(\n-        \"-Xlog:class+path=info\",\n-        \"Hello\")\n-        .assertAbnormalExit( out -> {\n-            out.shouldContain(unableToUseMsg)\n-               .shouldContain(mismatchMsg)\n-               .shouldNotContain(hintMsg);\n-        });\n+    output.shouldContain(mismatchMsg);\n@@ -82,1 +69,1 @@\n-        .assertAbnormalExit(unableToUseMsg, mismatchMsg, hintMsg);\n+        .assertAbnormalExit(unableToUseMsg, mismatchMsg);\n","filename":"test\/hotspot\/jtreg\/runtime\/cds\/appcds\/WrongClasspath.java","additions":4,"deletions":17,"binary":false,"changes":21,"status":"modified"},{"patch":"@@ -339,2 +339,2 @@\n-                      .shouldContain(\"The shared archive file has the wrong version\")\n-                      .shouldContain(\"Initialize dynamic archive failed\")\n+                      .shouldContain(\"UseSharedSpaces: The shared archive file has the wrong version\")\n+                      .shouldContain(\"UseSharedSpaces: Initialize dynamic archive failed\")\n@@ -403,1 +403,1 @@\n-                    output.shouldContain(\"Header checksum verification failed\")\n+                    output.shouldContain(\"UseSharedSpaces: Header checksum verification failed\")\n@@ -608,1 +608,1 @@\n-                    output.shouldContain(\"Header checksum verification failed\");\n+                    output.shouldContain(\"UseSharedSpaces: Header checksum verification failed\");\n@@ -637,1 +637,1 @@\n-                    output.shouldContain(\"Header checksum verification failed\");\n+                    output.shouldContain(\"UseSharedSpaces: Header checksum verification failed\");\n","filename":"test\/hotspot\/jtreg\/runtime\/cds\/appcds\/dynamicArchive\/TestAutoCreateSharedArchive.java","additions":5,"deletions":5,"binary":false,"changes":10,"status":"modified"},{"patch":"@@ -115,2 +115,2 @@\n-                      .shouldContain(\"Initialize static archive failed\")\n-                      .shouldContain(\"Unable to map shared spaces\")\n+                      .shouldContain(\"UseSharedSpaces: Initialize static archive failed\")\n+                      .shouldContain(\"UseSharedSpaces: Unable to map shared spaces\")\n@@ -135,2 +135,2 @@\n-                      .shouldContain(\"Initialize static archive failed\")\n-                      .shouldContain(\"Unable to map shared spaces\")\n+                      .shouldContain(\"UseSharedSpaces: Initialize static archive failed\")\n+                      .shouldContain(\"UseSharedSpaces: Unable to map shared spaces\")\n","filename":"test\/hotspot\/jtreg\/runtime\/cds\/appcds\/dynamicArchive\/TestAutoCreateSharedArchiveNoDefaultArchive.java","additions":4,"deletions":4,"binary":false,"changes":8,"status":"modified"},{"patch":"@@ -64,2 +64,0 @@\n-        String mismatchMsg = \"shared class paths mismatch\";\n-        String hintMsg = \"(hint: enable -Xlog:class+path=info to diagnose the failure)\";\n@@ -87,14 +85,2 @@\n-          .assertNormalExit(topArchiveMsg, mismatchMsg, hintMsg);\n-\n-        \/\/ Enable class+path logging and run with -Xshare:on, the mismatchMsg\n-        \/\/ should be there, the hintMsg should NOT be there.\n-        run2_WB(baseArchiveName, topArchiveName,\n-                \"-Xlog:class+path=info\",\n-                \"-Xshare:on\",\n-                \"-cp\", wrongJar, mainClass,\n-                \"assertShared:java.lang.Object\",  \/\/ base archive still useable\n-                \"assertNotShared:GenericTestApp\") \/\/ but top archive is not useable\n-          .assertAbnormalExit( output -> {\n-            output.shouldContain(mismatchMsg)\n-                  .shouldNotContain(hintMsg);\n-          });\n+          .assertNormalExit(topArchiveMsg,\n+                            \"shared class paths mismatch (hint: enable -Xlog:class+path=info to diagnose the failure)\");\n","filename":"test\/hotspot\/jtreg\/runtime\/cds\/appcds\/dynamicArchive\/WrongTopClasspath.java","additions":2,"deletions":16,"binary":false,"changes":18,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2015, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2015, 2019, Oracle and\/or its affiliates. All rights reserved.\n@@ -48,1 +48,1 @@\n-              \"com.sun.tools.jdeps.JdepsTask\", \"com.sun.tools.jdeps.Main\"},\n+              \"com.sun.tools.sjavac.Util\", \"com.sun.tools.sjavac.Main\"},\n","filename":"test\/hotspot\/jtreg\/runtime\/cds\/appcds\/test-classes\/JimageClassProtDomain.java","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -187,1 +187,1 @@\n-                    out.shouldContain(\"CDS is disabled because early JVMTI ClassFileLoadHook is in use.\");\n+                    out.shouldContain(\"UseSharedSpaces: CDS is disabled because early JVMTI ClassFileLoadHook is in use.\");\n@@ -192,1 +192,1 @@\n-                        if (!out.getOutput().contains(\"Unable to map at required address in java heap\")) {\n+                        if (!out.getOutput().contains(\"UseSharedSpaces: Unable to map at required address in java heap\")) {\n","filename":"test\/hotspot\/jtreg\/runtime\/cds\/serviceability\/ReplaceCriticalClasses.java","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -34,1 +34,1 @@\n- * @requires (os.family==\"linux\") & !vm.musl\n+ * @requires os.family == \"linux\"\n@@ -45,1 +45,4 @@\n-        output.shouldMatch(\".*Trim native heap: RSS\\\\+Swap: \\\\d+[BKM]->\\\\d+[BKM].*\");\n+        output.shouldMatch(\"(Done|Not available)\"); \/\/ Not available could happen on Linux + non-glibc (eg. muslc)\n+        if (output.firstMatch(\"Done\") != null) {\n+            output.shouldMatch(\"(Virtual size before|RSS before|Swap before|No details available)\");\n+        }\n","filename":"test\/hotspot\/jtreg\/serviceability\/dcmd\/vm\/TrimLibcHeapTest.java","additions":5,"deletions":2,"binary":false,"changes":7,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2021, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2021, Oracle and\/or its affiliates. All rights reserved.\n@@ -34,2 +34,0 @@\n-import java.util.ArrayList;\n-import java.util.List;\n@@ -43,1 +41,1 @@\n-    public static void main(String[] args) throws Exception {\n+    public static void main(String[] args) {\n@@ -46,1 +44,1 @@\n-        Thread threadChangeENM = new Thread(() -> {\n+        Thread t = new Thread(() -> {\n@@ -49,2 +47,2 @@\n-        threadChangeENM.setDaemon(true);\n-        threadChangeENM.start();\n+        t.setDaemon(true);\n+        t.start();\n@@ -52,13 +50,5 @@\n-        for (int i = 0; i < 10; i++) {\n-            List<Thread> threads = new ArrayList();\n-            for (int j = 0; j < 200; j++) {\n-                Thread t = new Thread(() -> {\n-                        String result = \"string\" + System.currentTimeMillis();\n-                        Reference.reachabilityFence(result);\n-                });\n-                threads.add(t);\n-                t.start();\n-            }\n-            for (Thread t: threads) {\n-                t.join();\n-            }\n+        for (int i = 0; i < 2000; i++) {\n+            new Thread(() -> {\n+                String result = \"string\" + System.currentTimeMillis();\n+                Reference.reachabilityFence(result);\n+            }).start();\n","filename":"test\/hotspot\/jtreg\/serviceability\/jvmti\/DynamicCodeGenerated\/DynamicCodeGeneratedTest.java","additions":10,"deletions":20,"binary":false,"changes":30,"status":"modified"},{"patch":"@@ -1,80 +0,0 @@\n-\/*\n- * Copyright (c) 2022, Oracle and\/or its affiliates. All rights reserved.\n- * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n- *\n- * This code is free software; you can redistribute it and\/or modify it\n- * under the terms of the GNU General Public License version 2 only, as\n- * published by the Free Software Foundation.\n- *\n- * This code is distributed in the hope that it will be useful, but WITHOUT\n- * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n- * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n- * version 2 for more details (a copy is included in the LICENSE file that\n- * accompanied this code).\n- *\n- * You should have received a copy of the GNU General Public License version\n- * 2 along with this work; if not, write to the Free Software Foundation,\n- * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n- *\n- * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n- * or visit www.oracle.com if you need additional information or have any\n- * questions.\n- *\/\n-\n-\/**\n- * @test\n- * @summary Verifies JVMTI GetStackTrace does not truncate virtual thread stack trace with agent attach\n- * @requires vm.jvmti\n- * @requires vm.continuations\n- * @enablePreview\n- * @run main\/othervm\/native -Djdk.attach.allowAttachSelf=true VirtualStackTraceTest\n- *\/\n-\n-import com.sun.tools.attach.VirtualMachine;\n-\n-import java.util.Arrays;\n-import java.util.List;\n-import java.util.Objects;\n-\n-public class VirtualStackTraceTest {\n-    private static final String AGENT_LIB = \"VirtualStackTraceTest\";\n-\n-    public static native String[] getStackTrace();\n-\n-    public static void main(String[] args) throws Exception {\n-        VirtualMachine vm = VirtualMachine.attach(String.valueOf(ProcessHandle.current().pid()));\n-        vm.loadAgentLibrary(AGENT_LIB);\n-        VirtualStackTraceTest t = new VirtualStackTraceTest();\n-        t.runTest();\n-    }\n-\n-    void runTest() throws Exception {\n-        Thread thr = Thread.ofVirtual().name(\"VT\").start(VirtualStackTraceTest::test);\n-        thr.join();\n-    }\n-\n-    private static void test() {\n-        work();\n-    }\n-\n-    private static void work() {\n-        inner();\n-    }\n-\n-    private static void inner() {\n-        checkCurrentThread();\n-    }\n-\n-    private static void checkCurrentThread() {\n-        System.out.println(\"Stack trace for \" + Thread.currentThread() + \": \");\n-        var javaStackTrace = Arrays.stream(Thread.currentThread().getStackTrace()).map(StackTraceElement::getMethodName).toList();\n-        var jvmtiStackTrace = List.of(getStackTrace());\n-\n-        System.out.println(\"JVMTI: \" + jvmtiStackTrace);\n-        System.out.println(\"Java : \" + javaStackTrace);\n-\n-        if (!Objects.equals(jvmtiStackTrace, javaStackTrace)) {\n-            throw new RuntimeException(\"VirtualStackTraceTest failed: stack traces do not match\");\n-        }\n-    }\n-}\n","filename":"test\/hotspot\/jtreg\/serviceability\/jvmti\/vthread\/VirtualStackTraceTest\/VirtualStackTraceTest.java","additions":0,"deletions":80,"binary":false,"changes":80,"status":"deleted"},{"patch":"@@ -1,96 +0,0 @@\n-\/*\n- * Copyright (c) 2022, Oracle and\/or its affiliates. All rights reserved.\n- * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n- *\n- * This code is free software; you can redistribute it and\/or modify it\n- * under the terms of the GNU General Public License version 2 only, as\n- * published by the Free Software Foundation.\n- *\n- * This code is distributed in the hope that it will be useful, but WITHOUT\n- * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n- * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n- * version 2 for more details (a copy is included in the LICENSE file that\n- * accompanied this code).\n- *\n- * You should have received a copy of the GNU General Public License version\n- * 2 along with this work; if not, write to the Free Software Foundation,\n- * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n- *\n- * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n- * or visit www.oracle.com if you need additional information or have any\n- * questions.\n- *\/\n-\n-#include <cstdlib>\n-#include <cstring>\n-#include <jvmti.h>\n-#include \"jvmti_common.h\"\n-\n-extern \"C\" {\n-\n-const int MAX_COUNT = 50;\n-static jvmtiEnv *jvmti;\n-\n-JNIEXPORT jobjectArray JNICALL\n-Java_VirtualStackTraceTest_getStackTrace(JNIEnv* jni, jclass clazz) {\n-  jvmtiError err;\n-  jint count = 0;\n-  jint skipped = 0;\n-\n-  jobject visibleFrames[MAX_COUNT];\n-  jvmtiFrameInfo frameInfo[MAX_COUNT];\n-\n-  err = jvmti->GetStackTrace(NULL, 0, MAX_COUNT, frameInfo, &count);\n-  check_jvmti_status(jni, err, \"event handler: error in JVMTI GetStackTrace call\");\n-\n-  for (int idx = 0; idx < count; idx++) {\n-    jclass declaringClass = NULL;\n-    char *clasSignature = NULL;\n-    char *methodName = NULL;\n-\n-    err = jvmti->GetMethodDeclaringClass(frameInfo[idx].method, &declaringClass);\n-    check_jvmti_status(jni, err, \"event handler: error in JVMTI GetMethodDeclaringClass call\");\n-\n-    err = jvmti->GetClassSignature(declaringClass, &clasSignature, NULL);\n-    check_jvmti_status(jni, err, \"event handler: error in JVMTI GetClassSignature call\");\n-\n-    err = jvmti->GetMethodName(frameInfo[idx].method, &methodName, NULL, NULL);\n-    check_jvmti_status(jni, err, \"event handler: error in JVMTI GetMethodName call\");\n-\n-    if (strchr(clasSignature, '.')) {\n-      skipped++;\n-      continue;\n-    }\n-    visibleFrames[idx - skipped] = jni->NewStringUTF(methodName);\n-\n-    jvmti->Deallocate(reinterpret_cast<unsigned char*>(methodName));\n-    jvmti->Deallocate(reinterpret_cast<unsigned char*>(clasSignature));\n-  }\n-  jobjectArray methodNames = jni->NewObjectArray(count - skipped, jni->FindClass(\"java\/lang\/String\"), NULL);\n-  for (int idx = 0; idx < count - skipped; idx++) {\n-    jni->SetObjectArrayElement(methodNames, idx, visibleFrames[idx]);\n-  }\n-  print_stack_trace(jvmti, jni, NULL);\n-\n-  return methodNames;\n-}\n-\n-JNIEXPORT jint JNICALL\n-Agent_OnLoad(JavaVM *jvm, char *options, void *reserved) {\n-  LOG(\"Agent_OnLoad started\\n\");\n-  if (jvm->GetEnv((void **) (&jvmti), JVMTI_VERSION) != JNI_OK) {\n-    return JNI_ERR;\n-  }\n-  return JNI_OK;\n-}\n-\n-JNIEXPORT jint JNICALL\n-Agent_OnAttach(JavaVM *jvm, char *options, void *reserved) {\n-  LOG(\"Agent_OnAttach started\\n\");\n-  if (jvm->GetEnv((void **) (&jvmti), JVMTI_VERSION) != JNI_OK) {\n-    return JNI_ERR;\n-  }\n-  return JNI_OK;\n-}\n-\n-} \/\/ extern \"C\"\n","filename":"test\/hotspot\/jtreg\/serviceability\/jvmti\/vthread\/VirtualStackTraceTest\/libVirtualStackTraceTest.cpp","additions":0,"deletions":96,"binary":false,"changes":96,"status":"deleted"},{"patch":"@@ -1,66 +0,0 @@\n-\/*\n- * Copyright (c) 2022, Oracle and\/or its affiliates. All rights reserved.\n- * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n- *\n- * This code is free software; you can redistribute it and\/or modify it\n- * under the terms of the GNU General Public License version 2 only, as\n- * published by the Free Software Foundation.\n- *\n- * This code is distributed in the hope that it will be useful, but WITHOUT\n- * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n- * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n- * version 2 for more details (a copy is included in the LICENSE file that\n- * accompanied this code).\n- *\n- * You should have received a copy of the GNU General Public License version\n- * 2 along with this work; if not, write to the Free Software Foundation,\n- * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n- *\n- * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n- * or visit www.oracle.com if you need additional information or have any\n- * questions.\n- *\/\n-\n-\/**\n- * @test\n- * @summary Verifies JVMTI can_support_virtual_threads works for agents loaded at startup and into running VM\n- * @requires vm.jvmti\n- * @requires vm.continuations\n- * @enablePreview\n- * @run main\/othervm\/native -agentlib:VirtualThreadStartTest VirtualThreadStartTest\n- * @run main\/othervm\/native -agentlib:VirtualThreadStartTest=can_support_virtual_threads VirtualThreadStartTest\n- * @run main\/othervm\/native -Djdk.attach.allowAttachSelf=true VirtualThreadStartTest attach\n- * @run main\/othervm\/native -Djdk.attach.allowAttachSelf=true VirtualThreadStartTest attach can_support_virtual_threads\n- *\/\n-\n-import com.sun.tools.attach.VirtualMachine;\n-\n-public class VirtualThreadStartTest {\n-    private static final String AGENT_LIB = \"VirtualThreadStartTest\";\n-    private static final int THREAD_CNT = 10;\n-\n-    private static native int getAndResetStartedThreads();\n-\n-    public static void main(String[] args) throws Exception {\n-        System.out.println(\"loading \" + AGENT_LIB + \" lib\");\n-\n-        if (args.length > 0 && args[0].equals(\"attach\")) { \/\/ agent loaded into running VM case\n-            String arg = args.length == 2 ? args[1] : \"\";\n-            VirtualMachine vm = VirtualMachine.attach(String.valueOf(ProcessHandle.current().pid()));\n-            vm.loadAgentLibrary(AGENT_LIB, arg);\n-        } else {\n-            System.loadLibrary(AGENT_LIB);\n-        }\n-        getAndResetStartedThreads();\n-\n-        for (int i = 0; i < THREAD_CNT; i++) {\n-            Thread.ofVirtual().name(\"Tested-VT-\" + i).start(() -> {}).join();\n-        }\n-\n-        int startedThreads = getAndResetStartedThreads();\n-        System.out.println(\"ThreadStart event count: \" + startedThreads + \", expected: \" + THREAD_CNT);\n-        if (startedThreads != THREAD_CNT) {\n-            throw new RuntimeException(\"Failed: wrong ThreadStart event count\");\n-        }\n-    }\n-}\n","filename":"test\/hotspot\/jtreg\/serviceability\/jvmti\/vthread\/VirtualThreadStartTest\/VirtualThreadStartTest.java","additions":0,"deletions":66,"binary":false,"changes":66,"status":"deleted"},{"patch":"@@ -1,144 +0,0 @@\n-\/*\n- * Copyright (c) 2022, Oracle and\/or its affiliates. All rights reserved.\n- * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n- *\n- * This code is free software; you can redistribute it and\/or modify it\n- * under the terms of the GNU General Public License version 2 only, as\n- * published by the Free Software Foundation.\n- *\n- * This code is distributed in the hope that it will be useful, but WITHOUT\n- * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n- * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n- * version 2 for more details (a copy is included in the LICENSE file that\n- * accompanied this code).\n- *\n- * You should have received a copy of the GNU General Public License version\n- * 2 along with this work; if not, write to the Free Software Foundation,\n- * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n- *\n- * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n- * or visit www.oracle.com if you need additional information or have any\n- * questions.\n- *\/\n-\n-#include <cstdlib>\n-#include <cstring>\n-#include <jvmti.h>\n-#include \"jvmti_common.h\"\n-\n-extern \"C\" {\n-\n-static jvmtiEnv *jvmti;\n-static int started_thread_cnt = 0;\n-static jrawMonitorID agent_event_lock = NULL;\n-static const char* TESTED_TNAME_START = \"Tested-VT\";\n-static const size_t TESTED_TNAME_START_LEN = strlen(TESTED_TNAME_START);\n-static bool can_support_vt_enabled = false;\n-\n-void JNICALL ThreadStart(jvmtiEnv *jvmti, JNIEnv* jni, jthread thread) {\n-  char* tname = get_thread_name(jvmti, jni, thread);\n-\n-  RawMonitorLocker agent_start_locker(jvmti, jni, agent_event_lock);\n-\n-  if (tname != NULL && strncmp(tname, TESTED_TNAME_START, TESTED_TNAME_START_LEN) == 0) {\n-    jboolean is_virtual = jni->IsVirtualThread(thread);\n-    if (!is_virtual) {\n-      fatal(jni, \"Failed: tested thread expected to be virtual\");\n-    }\n-    if (can_support_vt_enabled) {\n-      fatal(jni, \"Failed: expected VirtualThreadStart instead of ThreadStart event\");\n-    }\n-    printf(\"ThreadStart event: %s\\n\", tname);\n-    started_thread_cnt++;\n-  }\n-  deallocate(jvmti, jni, (void*)tname);\n-}\n-\n-void JNICALL VirtualThreadStart(jvmtiEnv *jvmti, JNIEnv* jni, jthread thread) {\n-  char* tname = get_thread_name(jvmti, jni, thread);\n-\n-  RawMonitorLocker agent_start_locker(jvmti, jni, agent_event_lock);\n-\n-  if (tname != NULL && strncmp(tname, TESTED_TNAME_START, TESTED_TNAME_START_LEN) == 0) {\n-    jboolean is_virtual = jni->IsVirtualThread(thread);\n-    if (!is_virtual) {\n-      fatal(jni, \"Failed: tested thread expected to be virtual\");\n-    }\n-    if (!can_support_vt_enabled) {\n-      fatal(jni, \"Failed: expected ThreadStart instead of VirtualThreadStart event\");\n-    }\n-    printf(\"VirtualThreadStart event: %s\\n\", tname);\n-    started_thread_cnt++;\n-  }\n-  deallocate(jvmti, jni, (void*)tname);\n-}\n-\n-JNIEXPORT jint JNICALL\n-Java_VirtualThreadStartTest_getAndResetStartedThreads(JNIEnv* jni, jclass clazz) {\n-  RawMonitorLocker agent_start_locker(jvmti, jni, agent_event_lock);\n-\n-  int result = started_thread_cnt;\n-  started_thread_cnt = 0;\n-  return result;\n-}\n-\n-jint agent_init(JavaVM *jvm, char *options, void *reserved) {\n-  jvmtiCapabilities caps;\n-  jvmtiEventCallbacks callbacks;\n-  jvmtiError err;\n-\n-  if (jvm->GetEnv((void **) (&jvmti), JVMTI_VERSION) != JNI_OK) {\n-    return JNI_ERR;\n-  }\n-  memset(&caps, 0, sizeof(caps));\n-  memset(&callbacks, 0, sizeof(callbacks));\n-  callbacks.ThreadStart = &ThreadStart;\n-  callbacks.VirtualThreadStart = &VirtualThreadStart;\n-\n-  if (options != NULL && strcmp(options, \"can_support_virtual_threads\") == 0) {\n-    can_support_vt_enabled = true;\n-    caps.can_support_virtual_threads = 1;\n-\n-    err = jvmti->AddCapabilities(&caps);\n-    if (err != JVMTI_ERROR_NONE) {\n-      LOG(\"Agent init: error in JVMTI AddCapabilities: %s (%d)\\n\", TranslateError(err), err);\n-      return JNI_ERR;\n-    }\n-    err = jvmti->SetEventNotificationMode(JVMTI_ENABLE, JVMTI_EVENT_VIRTUAL_THREAD_START, NULL);\n-    if (err != JVMTI_ERROR_NONE) {\n-      LOG(\"Agent init: error in JVMTI SetEventNotificationMode: %s (%d)\\n\", TranslateError(err), err);\n-      return JNI_ERR;\n-    }\n-  } else {\n-    err = jvmti->SetEventNotificationMode(JVMTI_ENABLE, JVMTI_EVENT_THREAD_START, NULL);\n-    if (err != JVMTI_ERROR_NONE) {\n-      LOG(\"Agent init: error in JVMTI SetEventNotificationMode: %s (%d)\\n\", TranslateError(err), err);\n-      return JNI_ERR;\n-    }\n-  }\n-  printf(\"agent_init: can_support_virtual_threads capability: %d\\n\",\n-         caps.can_support_virtual_threads);\n-\n-  err = jvmti->SetEventCallbacks(&callbacks, (jint)sizeof(callbacks));\n-  if (err != JVMTI_ERROR_NONE) {\n-    LOG(\"Agent init: error in JVMTI AddCapabilities: %s (%d)\\n\", TranslateError(err), err);\n-    return JNI_ERR;\n-  }\n-  agent_event_lock = create_raw_monitor(jvmti, \"agent_event_lock\");\n-\n-  return JNI_OK;\n-}\n-\n-JNIEXPORT jint JNICALL\n-Agent_OnLoad(JavaVM *jvm, char *options, void *reserved) {\n-  LOG(\"Agent_OnLoad started\\n\");\n-  return agent_init(jvm, options, reserved);\n-}\n-\n-JNIEXPORT jint JNICALL\n-Agent_OnAttach(JavaVM *jvm, char *options, void *reserved) {\n-  LOG(\"Agent_OnAttach started\\n\");\n-  return agent_init(jvm, options, reserved);\n-}\n-\n-} \/\/ extern \"C\"\n","filename":"test\/hotspot\/jtreg\/serviceability\/jvmti\/vthread\/VirtualThreadStartTest\/libVirtualThreadStartTest.cpp","additions":0,"deletions":144,"binary":false,"changes":144,"status":"deleted"},{"patch":"@@ -50,1 +50,1 @@\n-WB_SRC_FILES = $(shell find $(TESTLIBRARY_DIR)\/jdk\/test\/lib\/compiler $(TESTLIBRARY_DIR)\/jdk\/test\/whitebox -name '*.java')\n+WB_SRC_FILES = $(shell find $(TESTLIBRARY_DIR)\/sun\/hotspot $(TESTLIBRARY_DIR)\/jdk\/test\/whitebox -name '*.java')\n","filename":"test\/hotspot\/jtreg\/testlibrary\/ctw\/Makefile","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -107,2 +107,0 @@\n-    Object obj3;\n-    Object obj4;\n@@ -248,10 +246,0 @@\n-\n-    @Test\n-    @IR(counts = {IRNode.ALLOC, \"2\", IRNode.ALLOC_ARRAY, \"2\"}, \/\/ works for all phases\n-        phase = {CompilePhase.BEFORE_REMOVEUSELESS, CompilePhase.CCP1, CompilePhase.PRINT_OPTO_ASSEMBLY, CompilePhase.DEFAULT})\n-    public void alloc2() {\n-        obj = new Object();\n-        obj2 = new Object[1];\n-        obj3 = new Object();\n-        obj4 = new Object[2];\n-    }\n","filename":"test\/hotspot\/jtreg\/testlibrary_tests\/ir_framework\/tests\/TestPhaseIRMatching.java","additions":0,"deletions":12,"binary":false,"changes":12,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2001, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2001, 2021, Oracle and\/or its affiliates. All rights reserved.\n@@ -136,3 +136,2 @@\n-                                 log1(\"checking if thread2 completed\");\n-                                 if (!JDIUtils.waitForCompletion(test_thread)) {\n-                                     log1(\"thread2 is alive after vm.dispose().\");\n+                                 log1(\"checking on: thread2.isAlive\");\n+                                 if (test_thread.isAlive()) {\n","filename":"test\/hotspot\/jtreg\/vmTestbase\/nsk\/jdi\/VirtualMachine\/dispose\/dispose002a.java","additions":3,"deletions":4,"binary":false,"changes":7,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2001, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2001, 2021, Oracle and\/or its affiliates. All rights reserved.\n@@ -138,1 +138,2 @@\n-                                 if (!JDIUtils.waitForCompletion(test_thread)) {\n+                                 if (test_thread.isAlive()) {\n+                                     test_thread.resume();\n@@ -140,3 +141,0 @@\n-                                     logErr(\"ERROR thread is alive after vm.dispose()\");\n-                                     exitCode = FAILED;\n-                                     break;\n","filename":"test\/hotspot\/jtreg\/vmTestbase\/nsk\/jdi\/VirtualMachine\/dispose\/dispose003a.java","additions":3,"deletions":5,"binary":false,"changes":8,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2001, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2001, 2021, Oracle and\/or its affiliates. All rights reserved.\n@@ -139,1 +139,2 @@\n-                                 if (!JDIUtils.waitForCompletion(test_thread)) {\n+                                 if (test_thread.isAlive()) {\n+                                     test_thread.resume();\n@@ -141,3 +142,0 @@\n-                                     logErr(\"ERROR thread is alive after vm.dispose()\");\n-                                     exitCode = FAILED;\n-                                     break;\n","filename":"test\/hotspot\/jtreg\/vmTestbase\/nsk\/jdi\/VirtualMachine\/dispose\/dispose004a.java","additions":3,"deletions":5,"binary":false,"changes":8,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2001, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2001, 2018, Oracle and\/or its affiliates. All rights reserved.\n@@ -155,1 +155,1 @@\n-                                 log1(\"checking on: test_thread.done\");\n+                                 log1(\"checking on: testedThread.isAlive\");\n@@ -157,0 +157,1 @@\n+                                     test_thread.resume();\n@@ -158,3 +159,0 @@\n-                                     logErr(\"ERROR test_thread.done is false after vm.dispose()\");\n-                                     exitCode = FAILED;\n-                                     break;\n","filename":"test\/hotspot\/jtreg\/vmTestbase\/nsk\/jdi\/VirtualMachine\/dispose\/dispose005a.java","additions":3,"deletions":5,"binary":false,"changes":8,"status":"modified"},{"patch":"@@ -1,44 +0,0 @@\n-\/*\n- * Copyright (c) 2022, Oracle and\/or its affiliates. All rights reserved.\n- * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n- *\n- * This code is free software; you can redistribute it and\/or modify it\n- * under the terms of the GNU General Public License version 2 only, as\n- * published by the Free Software Foundation.\n- *\n- * This code is distributed in the hope that it will be useful, but WITHOUT\n- * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n- * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n- * version 2 for more details (a copy is included in the LICENSE file that\n- * accompanied this code).\n- *\n- * You should have received a copy of the GNU General Public License version\n- * 2 along with this work; if not, write to the Free Software Foundation,\n- * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n- *\n- * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n- * or visit www.oracle.com if you need additional information or have any\n- * questions.\n- *\/\n-\n-package nsk.share.jdi;\n-\n-public class JDIUtils {\n-\n-    \/*\n-     * Wait until thread is no longer alive, but only wait\n-     * for a short period of time since it shouldn't take long.\n-     *\/\n-    public static boolean waitForCompletion(Thread thread) {\n-        for (int attempt = 1; attempt <= 5; attempt++) {\n-            if (!thread.isAlive()) {\n-                return true;\n-            }\n-            try {\n-                Thread.sleep(attempt * 1000);\n-            } catch (InterruptedException ie) {\n-            }\n-        }\n-        return false;\n-    }\n-}\n","filename":"test\/hotspot\/jtreg\/vmTestbase\/nsk\/share\/jdi\/JDIUtils.java","additions":0,"deletions":44,"binary":false,"changes":44,"status":"deleted"},{"patch":"@@ -35,1 +35,1 @@\n- *     wait on a monitor. Then the test calls java.lang.Thread.getStackTrace()\n+ *     waits for a monitor. Then the test calls java.lang.Thread.getStackTrace()\n@@ -37,1 +37,6 @@\n- *     The test fails if the stacks for each thread do not match.\n+ *     The test fails if:\n+ *     - amount of stack trace elements and stack trace elements themselves are\n+ *       the same for both methods;\n+ *     - there is at least one element corresponding to invocation of unexpected\n+ *       method. Expected methods are Thread.sleep(), Thread.run() and the\n+ *       recursive method.\n@@ -53,1 +58,1 @@\n- * The test runs <code>THRD_COUNT<\/code> instances of <code>strace013Thread<\/code>,\n+ * The test runs <code>THRD_COUNT<\/code> instances of <code>strace010Thread<\/code>,\n@@ -55,1 +60,1 @@\n- * <code>DEPTH<\/code> of recursion, each thread is switched to wait on a monitor.\n+ * <code>DEPTH<\/code> of recursion, each thread is switched to wait a monitor.\n@@ -60,1 +65,1 @@\n- * for both stack traces correspond to invocation of one of the methods\n+ * for both stack traces must be corresponded to invocation of one of the methods\n@@ -62,4 +67,0 @@\n- *\n- * There is some leeway in the expected stack depth as a thread may not have\n- * reached the native wait0() call when the stacktrace is taken. So we allow\n- * a difference of 3 for the methods: wait(), wait(0), and wait0(0)\n@@ -72,1 +73,1 @@\n-            \"java.lang.Object.wait\", \/\/ two variants\n+            \"java.lang.Object.wait\",\n@@ -174,1 +175,1 @@\n-            if (count - k > 3) {\n+            if (count - k > 2) {\n","filename":"test\/hotspot\/jtreg\/vmTestbase\/nsk\/stress\/strace\/strace013.java","additions":12,"deletions":11,"binary":false,"changes":23,"status":"modified"},{"patch":"@@ -33,0 +33,2 @@\n+com\/sun\/jdi\/JdbLastErrorTest.java 8293829 windows-x64\n+\n","filename":"test\/jdk\/ProblemList-Xcomp.txt","additions":2,"deletions":0,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -122,0 +122,1 @@\n+java\/awt\/Focus\/UnaccessibleChoice\/AccessibleChoiceTest.java 8239801 macosx-all\n@@ -126,0 +127,1 @@\n+java\/awt\/dnd\/MissingEventsOnModalDialog\/MissingEventsOnModalDialogTest.java 8164464 linux-all,macosx-all\n@@ -188,0 +190,1 @@\n+java\/awt\/event\/KeyEvent\/KeyTyped\/CtrlASCII.java 8252713 linux-all\n@@ -191,0 +194,1 @@\n+java\/awt\/Scrollbar\/ScrollbarMouseWheelTest\/ScrollbarMouseWheelTest.java 8196018 windows-all,linux-all\n@@ -223,0 +227,1 @@\n+sun\/java2d\/DirectX\/OnScreenRenderingResizeTest\/OnScreenRenderingResizeTest.java 8022403 generic-all\n@@ -226,1 +231,1 @@\n-sun\/java2d\/SunGraphics2D\/DrawImageBilinear.java 8297175 linux-all\n+sun\/java2d\/SunGraphics2D\/DrawImageBilinear.java 8191406 generic-all\n@@ -241,0 +246,1 @@\n+java\/awt\/Robot\/ModifierRobotKey\/ModifierRobotKeyTest.java 8157173 generic-all\n@@ -375,0 +381,1 @@\n+java\/awt\/Mouse\/EnterExitEvents\/DragWindowTest.java 8023562 macosx-all\n@@ -427,0 +434,1 @@\n+java\/awt\/Mouse\/TitleBarDoubleClick\/TitleBarDoubleClick.java 8148041 linux-all\n@@ -503,1 +511,1 @@\n-java\/io\/File\/TempDirDoesNotExist.java                           8297528 windows-all\n+java\/io\/File\/GetXSpace.java                                     8291911 windows-all\n@@ -555,2 +563,0 @@\n-java\/nio\/channels\/FileChannel\/FileExtensionAndMap.java          8297292 generic-all\n-\n@@ -633,0 +639,1 @@\n+javax\/sound\/midi\/Sequencer\/MetaCallback.java 8178698 linux-all\n@@ -653,0 +660,1 @@\n+javax\/swing\/JTree\/6263446\/bug6263446.java 8296083 linux-all\n@@ -673,3 +681,0 @@\n-java\/awt\/Mouse\/EnterExitEvents\/DragWindowTest.java 8297296 macosx-all\n-javax\/swing\/JFileChooser\/8046391\/bug8046391.java 8293862 windows-x64\n-\n@@ -692,5 +697,0 @@\n-############################################################################\n-\n-# core_svc\n-tools\/launcher\/TestXcheckJNIWarnings.java#jdwp-agent   8296936 generic-all\n-\n@@ -703,0 +703,2 @@\n+com\/sun\/jdi\/NashornPopFrameTest.java                            8225620 generic-all\n+\n@@ -757,1 +759,1 @@\n-jdk\/jfr\/api\/consumer\/TestRecordingFileWrite.java                8287699 generic-all\n+jdk\/jfr\/api\/consumer\/TestRecordingFileWrite.java                8287699 linux-x64,macosx-x64\n","filename":"test\/jdk\/ProblemList.txt","additions":15,"deletions":13,"binary":false,"changes":28,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2018, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2018, Oracle and\/or its affiliates. All rights reserved.\n@@ -31,38 +31,0 @@\n-\n-\/*\n- * @test\n- * @key randomness\n- * @modules java.base\/com.sun.crypto.provider\n- * @run main java.base\/com.sun.crypto.provider.Poly1305IntrinsicFuzzTest\n- * @summary Unit test for com.sun.crypto.provider.Poly1305.\n- *\/\n-\n-\/*\n- * @test\n- * @modules java.base\/com.sun.crypto.provider\n- * @run main java.base\/com.sun.crypto.provider.Poly1305KAT\n- * @summary Unit test for com.sun.crypto.provider.Poly1305.\n- *\/\n-\n-\/*\n- * @test\n- * @key randomness\n- * @modules java.base\/com.sun.crypto.provider\n- * @summary Unit test for IntrinsicCandidate in com.sun.crypto.provider.Poly1305.\n- * @run main\/othervm -Xcomp -XX:-TieredCompilation java.base\/com.sun.crypto.provider.Poly1305IntrinsicFuzzTest\n- *\/\n-\n-\/*\n- * @test\n- * @modules java.base\/com.sun.crypto.provider\n- * @summary Unit test for IntrinsicCandidate in com.sun.crypto.provider.Poly1305.\n- * @run main\/othervm -Xcomp -XX:-TieredCompilation java.base\/com.sun.crypto.provider.Poly1305KAT\n- *\/\n-\n-package com.sun.crypto.provider.Cipher.ChaCha20;\n-\n-public class Poly1305UnitTestDriver {\n-    static public void main(String[] args) {\n-        System.out.println(\"Passed\");\n-    }\n-}\n","filename":"test\/jdk\/com\/sun\/crypto\/provider\/Cipher\/ChaCha20\/unittest\/Poly1305UnitTestDriver.java","additions":1,"deletions":39,"binary":false,"changes":40,"status":"modified"},{"patch":"@@ -1,95 +0,0 @@\n-\/*\n- * Copyright (c) 2022, Intel Corporation. All rights reserved.\n- *\n- * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n- *\n- * This code is free software; you can redistribute it and\/or modify it\n- * under the terms of the GNU General Public License version 2 only, as\n- * published by the Free Software Foundation.\n- *\n- * This code is distributed in the hope that it will be useful, but WITHOUT\n- * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n- * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n- * version 2 for more details (a copy is included in the LICENSE file that\n- * accompanied this code).\n- *\n- * You should have received a copy of the GNU General Public License version\n- * 2 along with this work; if not, write to the Free Software Foundation,\n- * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n- *\n- * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n- * or visit www.oracle.com if you need additional information or have any\n- * questions.\n- *\/\n-\n-package com.sun.crypto.provider;\n-\n-import java.nio.ByteBuffer;\n-import java.util.Arrays;\n-\n-import javax.crypto.spec.SecretKeySpec;\n-\n-\/\/ This test case relies on the fact that single-byte Poly1305.engineUpdate(byte) does not have an intrinsic\n-\/\/ In this way we can compare if the intrinsic and pure java produce same result\n-\/\/ This test case is NOT entirely deterministic, it uses a random seed for pseudo-random number generator\n-\/\/ If a failure occurs, hardcode the seed to make the test case deterministic\n-public class Poly1305IntrinsicFuzzTest {\n-        public static void main(String[] args) throws Exception {\n-                \/\/Note: it might be useful to increase this number during development of new Poly1305 intrinsics\n-                final int repeat = 100;\n-                for (int i = 0; i < repeat; i++) {\n-                        run();\n-                }\n-                System.out.println(\"Fuzz Success\");\n-        }\n-\n-        public static void run() throws Exception {\n-                java.util.Random rnd = new java.util.Random();\n-                long seed = rnd.nextLong();\n-                rnd.setSeed(seed);\n-\n-                byte[] key = new byte[32];\n-                rnd.nextBytes(key);\n-                int msgLen = rnd.nextInt(128, 4096); \/\/ x86_64 intrinsic requires 256 bytes minimum\n-                byte[] message = new byte[msgLen];\n-\n-                Poly1305 authenticator = new Poly1305();\n-                Poly1305 authenticatorSlow = new Poly1305();\n-                if (authenticator.engineGetMacLength() != 16) {\n-                        throw new RuntimeException(\"The length of Poly1305 MAC must be 16-bytes.\");\n-                }\n-\n-                authenticator.engineInit(new SecretKeySpec(key, 0, 32, \"Poly1305\"), null);\n-                authenticatorSlow.engineInit(new SecretKeySpec(key, 0, 32, \"Poly1305\"), null);\n-\n-                if (rnd.nextBoolean()) {\n-                        \/\/ Prime just the buffer and\/or accumulator (buffer can keep at most 16 bytes from previous engineUpdate)\n-                        int initDataLen = rnd.nextInt(8, 24);\n-                        authenticator.engineUpdate(message, 0, initDataLen);\n-                        slowUpdate(authenticatorSlow, message, 0, initDataLen);\n-                }\n-\n-                if (rnd.nextBoolean()) {\n-                        \/\/ Multiple calls to engineUpdate\n-                        authenticator.engineUpdate(message, 0, message.length);\n-                        slowUpdate(authenticatorSlow, message, 0, message.length);\n-                }\n-\n-                authenticator.engineUpdate(message, 0, message.length);\n-                slowUpdate(authenticatorSlow, message, 0, message.length);\n-\n-                byte[] tag = authenticator.engineDoFinal();\n-                byte[] tagSlow = authenticatorSlow.engineDoFinal();\n-\n-                if (!Arrays.equals(tag, tagSlow)) {\n-                        throw new RuntimeException(\"[Seed \"+seed+\"] Tag mismatch: \" + Arrays.toString(tag) + \" != \" + Arrays.toString(tagSlow));\n-                }\n-        }\n-\n-        static void slowUpdate(Poly1305 authenticator, byte[] message, int offset, int len) {\n-                len = Math.min(message.length, offset + len);\n-                for (int i = offset; i < len; i++) {\n-                        authenticator.engineUpdate(message[i]);\n-                }\n-        }\n-}\n","filename":"test\/jdk\/com\/sun\/crypto\/provider\/Cipher\/ChaCha20\/unittest\/java.base\/com\/sun\/crypto\/provider\/Poly1305IntrinsicFuzzTest.java","additions":0,"deletions":95,"binary":false,"changes":95,"status":"deleted"},{"patch":"@@ -1,199 +0,0 @@\n-\/*\n- * Copyright (c) 2022, Intel Corporation. All rights reserved.\n- *\n- * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n- *\n- * This code is free software; you can redistribute it and\/or modify it\n- * under the terms of the GNU General Public License version 2 only, as\n- * published by the Free Software Foundation.\n- *\n- * This code is distributed in the hope that it will be useful, but WITHOUT\n- * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n- * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n- * version 2 for more details (a copy is included in the LICENSE file that\n- * accompanied this code).\n- *\n- * You should have received a copy of the GNU General Public License version\n- * 2 along with this work; if not, write to the Free Software Foundation,\n- * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n- *\n- * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n- * or visit www.oracle.com if you need additional information or have any\n- * questions.\n- *\/\n-\n-package com.sun.crypto.provider;\n-\n-import java.util.*;\n-import java.nio.ByteBuffer;\n-import java.util.Arrays;\n-\n-import javax.crypto.spec.SecretKeySpec;\n-\n-public class Poly1305KAT {\n-    public static class TestData {\n-        public TestData(String name, String keyStr, String inputStr, String outStr) {\n-            HexFormat hex = HexFormat.of();\n-            testName = Objects.requireNonNull(name);\n-            key = hex.parseHex(Objects.requireNonNull(keyStr));\n-            input = hex.parseHex(Objects.requireNonNull(inputStr));\n-            expOutput = hex.parseHex(Objects.requireNonNull(outStr));\n-        }\n-\n-        public final String testName;\n-        public final byte[] key;\n-        public final byte[] input;\n-        public final byte[] expOutput;\n-    }\n-\n-    public static final List<TestData> testList = new LinkedList<TestData>() {{\n-        add(new TestData(\"RFC 7539 A.3 Test Vector #1\",\n-            \"0000000000000000000000000000000000000000000000000000000000000000\",\n-            \"0000000000000000000000000000000000000000000000000000000000000000\" +\n-            \"0000000000000000000000000000000000000000000000000000000000000000\",\n-            \"00000000000000000000000000000000\"));\n-        add(new TestData(\"RFC 7539 A.3 Test Vector #2\",\n-            \"0000000000000000000000000000000036e5f6b5c5e06070f0efca96227a863e\",\n-            \"416e79207375626d697373696f6e20746f20746865204945544620696e74656e\" +\n-            \"6465642062792074686520436f6e7472696275746f7220666f72207075626c69\" +\n-            \"636174696f6e20617320616c6c206f722070617274206f6620616e2049455446\" +\n-            \"20496e7465726e65742d4472616674206f722052464320616e6420616e792073\" +\n-            \"746174656d656e74206d6164652077697468696e2074686520636f6e74657874\" +\n-            \"206f6620616e204945544620616374697669747920697320636f6e7369646572\" +\n-            \"656420616e20224945544620436f6e747269627574696f6e222e205375636820\" +\n-            \"73746174656d656e747320696e636c756465206f72616c2073746174656d656e\" +\n-            \"747320696e20494554462073657373696f6e732c2061732077656c6c20617320\" +\n-            \"7772697474656e20616e6420656c656374726f6e696320636f6d6d756e696361\" +\n-            \"74696f6e73206d61646520617420616e792074696d65206f7220706c6163652c\" +\n-            \"207768696368206172652061646472657373656420746f\",\n-            \"36e5f6b5c5e06070f0efca96227a863e\"));\n-        add(new TestData(\"RFC 7539 A.3 Test Vector #3\",\n-            \"36e5f6b5c5e06070f0efca96227a863e00000000000000000000000000000000\",\n-             \"416e79207375626d697373696f6e20746f20746865204945544620696e74656e\" +\n-             \"6465642062792074686520436f6e7472696275746f7220666f72207075626c69\" +\n-             \"636174696f6e20617320616c6c206f722070617274206f6620616e2049455446\" +\n-             \"20496e7465726e65742d4472616674206f722052464320616e6420616e792073\" +\n-             \"746174656d656e74206d6164652077697468696e2074686520636f6e74657874\" +\n-             \"206f6620616e204945544620616374697669747920697320636f6e7369646572\" +\n-             \"656420616e20224945544620436f6e747269627574696f6e222e205375636820\" +\n-             \"73746174656d656e747320696e636c756465206f72616c2073746174656d656e\" +\n-             \"747320696e20494554462073657373696f6e732c2061732077656c6c20617320\" +\n-             \"7772697474656e20616e6420656c656374726f6e696320636f6d6d756e696361\" +\n-             \"74696f6e73206d61646520617420616e792074696d65206f7220706c6163652c\" +\n-             \"207768696368206172652061646472657373656420746f\",\n-             \"f3477e7cd95417af89a6b8794c310cf0\"));\n-        add(new TestData(\"RFC 7539 A.3 Test Vector #4\",\n-            \"1c9240a5eb55d38af333888604f6b5f0473917c1402b80099dca5cbc207075c0\",\n-            \"2754776173206272696c6c69672c20616e642074686520736c6974687920746f\" +\n-            \"7665730a446964206779726520616e642067696d626c6520696e207468652077\" +\n-            \"6162653a0a416c6c206d696d737920776572652074686520626f726f676f7665\" +\n-            \"732c0a416e6420746865206d6f6d65207261746873206f757467726162652e\",\n-            \"4541669a7eaaee61e708dc7cbcc5eb62\"));\n-        add(new TestData(\"RFC 7539 A.3 Test Vector #5: If one uses 130-bit partial reduction, does the code handle the case where partially reducedfinal result is not fully reduced?\",\n-            \"0200000000000000000000000000000000000000000000000000000000000000\",\n-            \"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF\",\n-            \"03000000000000000000000000000000\"));\n-        add(new TestData(\"RFC 7539 A.3 Test Vector #6: What happens if addition of s overflows modulo 2^128?\",\n-            \"02000000000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF\",\n-            \"02000000000000000000000000000000\",\n-            \"03000000000000000000000000000000\"));\n-        add(new TestData(\"RFC 7539 A.3 Test Vector #7: What happens if data limb is all ones and there is carry from lower limb?\",\n-            \"0100000000000000000000000000000000000000000000000000000000000000\",\n-            \"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF0FFFFFFFFFFFFFFFFFFFFFFFFFFFFFF\" +\n-            \"11000000000000000000000000000000\",\n-             \"05000000000000000000000000000000\"));\n-        add(new TestData(\"RFC 7539 A.3 Test Vector #8: What happens if final result from polynomial part is exactly 2^130-5?\",\n-            \"0100000000000000000000000000000000000000000000000000000000000000\",\n-            \"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFBFEFEFEFEFEFEFEFEFEFEFEFEFEFEFE\" +\n-            \"01010101010101010101010101010101\",\n-            \"00000000000000000000000000000000\"));\n-        add(new TestData(\"RFC 7539 A.3 Test Vector #9: What happens if final result from polynomial part is exactly 2^130-6?\",\n-            \"0200000000000000000000000000000000000000000000000000000000000000\",\n-            \"FDFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF\",\n-            \"FAFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF\"));\n-        add(new TestData(\"RFC 7539 A.3 Test Vector #10: What happens if 5*H+L-type reduction produces 131-bit intermediate result?\",\n-            \"0100000000000000040000000000000000000000000000000000000000000000\",\n-            \"E33594D7505E43B900000000000000003394D7505E4379CD0100000000000000\" +\n-            \"0000000000000000000000000000000001000000000000000000000000000000\",\n-            \"14000000000000005500000000000000\"));\n-        add(new TestData(\"RFC 7539 A.3 Test Vector #11: What happens if 5*H+L-type reduction produces 131-bit final result?\",\n-            \"0100000000000000040000000000000000000000000000000000000000000000\",\n-            \"E33594D7505E43B900000000000000003394D7505E4379CD0100000000000000\" +\n-            \"00000000000000000000000000000000\",\n-            \"13000000000000000000000000000000\"));\n-    }};\n-\n-    public static void main(String args[]) throws Exception {\n-        int testsPassed = 0;\n-        int testNumber = 0;\n-\n-        for (TestData test : testList) {\n-            System.out.println(\"*** Test \" + ++testNumber + \": \" +\n-                    test.testName);\n-            if (runSingleTest(test)) {\n-                testsPassed++;\n-            }\n-        }\n-        System.out.println();\n-\n-        if (testsPassed != testNumber) {\n-            throw new RuntimeException(\"One or more tests failed.  \" +\n-                    \"Check output for details\");\n-        }\n-    }\n-\n-    private static boolean runSingleTest(TestData testData) throws Exception {\n-        Poly1305 authenticator = new Poly1305(false);\n-        authenticator.engineInit(new SecretKeySpec(testData.key, 0, testData.key.length, \"Poly1305\"), null);\n-        authenticator.engineUpdate(testData.input, 0, testData.input.length);\n-        byte[] tag = authenticator.engineDoFinal();\n-        if (!Arrays.equals(tag, testData.expOutput)) {\n-                System.out.println(\"ERROR - Output Mismatch!\");\n-                System.out.println(\"Expected:\\n\" +\n-                        dumpHexBytes(testData.expOutput, testData.expOutput.length, \"\\n\", \" \"));\n-                System.out.println(\"Actual:\\n\" +\n-                        dumpHexBytes(tag, tag.length, \"\\n\", \" \"));\n-                System.out.println();\n-                return false;\n-        }\n-        return true;\n-    }\n-\n-    \/**\n-     * Dump the hex bytes of a buffer into string form.\n-     *\n-     * @param data The array of bytes to dump to stdout.\n-     * @param itemsPerLine The number of bytes to display per line\n-     *      if the {@code lineDelim} character is blank then all bytes\n-     *      will be printed on a single line.\n-     * @param lineDelim The delimiter between lines\n-     * @param itemDelim The delimiter between bytes\n-     *\n-     * @return The hexdump of the byte array\n-     *\/\n-    private static String dumpHexBytes(byte[] data, int itemsPerLine,\n-            String lineDelim, String itemDelim) {\n-        return dumpHexBytes(ByteBuffer.wrap(data), itemsPerLine, lineDelim,\n-                itemDelim);\n-    }\n-\n-    private static String dumpHexBytes(ByteBuffer data, int itemsPerLine,\n-            String lineDelim, String itemDelim) {\n-        StringBuilder sb = new StringBuilder();\n-        if (data != null) {\n-            data.mark();\n-            int i = 0;\n-            while (data.remaining() > 0) {\n-                if (i % itemsPerLine == 0 && i != 0) {\n-                    sb.append(lineDelim);\n-                }\n-                sb.append(String.format(\"%02X\", data.get())).append(itemDelim);\n-                i++;\n-            }\n-            data.reset();\n-        }\n-\n-        return sb.toString();\n-    }\n-}\n-\n","filename":"test\/jdk\/com\/sun\/crypto\/provider\/Cipher\/ChaCha20\/unittest\/java.base\/com\/sun\/crypto\/provider\/Poly1305KAT.java","additions":0,"deletions":199,"binary":false,"changes":199,"status":"deleted"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2012, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2012, 2014, Oracle and\/or its affiliates. All rights reserved.\n@@ -33,1 +33,0 @@\n-import javax.crypto.spec.SecretKeySpec;\n@@ -72,2 +71,1 @@\n-                        || !theTest.translateSpoiledKey()\n-                        || !theTest.testGeneralSecretKey()) {\n+                        || !theTest.translateSpoiledKey()) {\n@@ -193,39 +191,0 @@\n-    \/**\n-     * The test case scenario implemented in the method: - create a general\n-     * secret key (does not implement PBEKey) - try calling\n-     * translate and getKeySpec methods and see if the expected\n-     * InvalidKeyException and InvalidKeySpecException is thrown.\n-     *\n-     * @return true if the expected Exception occurred; false - otherwise\n-     * @throws NoSuchAlgorithmException\n-     *\/\n-    public boolean testGeneralSecretKey() throws NoSuchAlgorithmException {\n-        SecretKey key = new SecretKeySpec(\"random#s\".getBytes(), algoToTest);\n-        SecretKeyFactory skf = SecretKeyFactory.getInstance(algoToTest);\n-        try {\n-            skf.translateKey(key);\n-            System.out.println(\"Error: expected IKE not thrown\");\n-            return false;\n-        } catch (InvalidKeyException e) {\n-            if (e.getMessage().indexOf(\"PBEKey\") == -1) {\n-                System.out.println(\"Error: IKE message should \" +\n-                        \"indicate that PBEKey is required\");\n-                return false;\n-            }\n-        }\n-\n-        try {\n-            skf.getKeySpec(key, PBEKeySpec.class);\n-            System.out.println(\"Error: expected IKSE not thrown\");\n-            return false;\n-        } catch (InvalidKeySpecException e) {\n-            if (e.getMessage().indexOf(\"PBEKey\") == -1) {\n-                System.out.println(\"Error: IKSE message should \" +\n-                        \"indicate that PBEKey is required\");\n-                return false;\n-            }\n-        }\n-\n-        return true;\n-    }\n-\n","filename":"test\/jdk\/com\/sun\/crypto\/provider\/Cipher\/PBE\/PBKDF2Translate.java","additions":2,"deletions":43,"binary":false,"changes":45,"status":"modified"},{"patch":"@@ -1,218 +0,0 @@\n-\/*\n- * Copyright (c) 2022, Oracle and\/or its affiliates. All rights reserved.\n- * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n- *\n- * This code is free software; you can redistribute it and\/or modify it\n- * under the terms of the GNU General Public License version 2 only, as\n- * published by the Free Software Foundation.\n- *\n- * This code is distributed in the hope that it will be useful, but WITHOUT\n- * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n- * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n- * version 2 for more details (a copy is included in the LICENSE file that\n- * accompanied this code).\n- *\n- * You should have received a copy of the GNU General Public License version\n- * 2 along with this work; if not, write to the Free Software Foundation,\n- * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n- *\n- * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n- * or visit www.oracle.com if you need additional information or have any\n- * questions.\n- *\/\n-\n-\/*\n- * @test\n- * @bug 6972078\n- * @key headful\n- * @requires (os.family == \"linux\")\n- * @summary Verifies if user is able to select single directory if multi selection\n- * is enabled for JFileChooser.\n- * @run main TestFileChooserSingleDirectorySelection\n- *\/\n-\n-import java.io.File;\n-import java.awt.BorderLayout;\n-import java.awt.event.ActionEvent;\n-import java.awt.event.ActionListener;\n-import java.awt.event.InputEvent;\n-import java.awt.Point;\n-import java.awt.Robot;\n-import javax.swing.JButton;\n-import javax.swing.JFileChooser;\n-import javax.swing.JFrame;\n-import javax.swing.SwingUtilities;\n-import javax.swing.UIManager;\n-import javax.swing.UnsupportedLookAndFeelException;\n-\n-public class TestFileChooserSingleDirectorySelection {\n-    private static JFrame frame;\n-    private static JFileChooser fileChooser;\n-    private static JButton getSelectedFilesButton;\n-    private static Robot robot;\n-    private static boolean passed;\n-    private static File[] testDir;\n-    private static File[] tempFile;\n-\n-    public static void main(String[] args) throws Exception {\n-        System.setProperty(\"sun.java2d.uiScale\", \"1.0\");\n-        robot = new Robot();\n-        robot.setAutoDelay(100);\n-\n-        try {\n-            \/\/ create test directory\n-            String tmpDir = System.getProperty(\"user.home\");\n-            testDir = new File[1];\n-            testDir[0] = new File(tmpDir, \"testDir\");\n-            if (!testDir[0].exists())\n-                testDir[0].mkdir();\n-            testDir[0].deleteOnExit();\n-\n-            \/\/ create temporary files inside testDir\n-            tempFile = new File[5];\n-            for (int i = 0; i < 5; ++i) {\n-                tempFile[i] = File.createTempFile(\"temp\", \".txt\",\n-                        new File(testDir[0].getAbsolutePath()));\n-                tempFile[i].deleteOnExit();\n-            }\n-        } catch (Exception e) {\n-            e.printStackTrace();\n-        }\n-        for (UIManager.LookAndFeelInfo laf :\n-                        UIManager.getInstalledLookAndFeels()) {\n-            System.out.println(\"Testing LAF: \" + laf.getClassName());\n-            SwingUtilities.invokeAndWait(() -> setLookAndFeel(laf));\n-            checkFileOnlyTest(laf);\n-            checkDirectoriesOnlyTest(laf);\n-            checkFilesAndDirectoriesTest(laf);\n-            System.out.println(\"Passed\");\n-        }\n-    }\n-\n-    private static void checkFileOnlyTest(UIManager.LookAndFeelInfo laf)\n-            throws Exception {\n-        System.out.println(\"Testing File Only mode\");\n-        try {\n-            SwingUtilities.invokeAndWait(() -> {\n-                createAndShowUI();\n-                fileChooser.setCurrentDirectory(testDir[0]);\n-            });\n-\n-            robot.waitForIdle();\n-            robot.delay(1000);\n-            fileChooser.setFileSelectionMode(JFileChooser.FILES_ONLY);\n-            doTesting(laf, 230);\n-        } finally {\n-            SwingUtilities.invokeAndWait(() -> {\n-                if (frame != null) {\n-                    frame.dispose();\n-                }\n-            });\n-        }\n-    }\n-\n-    private static void checkDirectoriesOnlyTest(UIManager.LookAndFeelInfo laf)\n-            throws Exception {\n-        System.out.println(\"Testing Directories Only mode\");\n-        try {\n-            SwingUtilities.invokeAndWait(() -> {\n-                createAndShowUI();\n-            });\n-            robot.waitForIdle();\n-            robot.delay(1000);\n-            fileChooser.setFileSelectionMode(JFileChooser.DIRECTORIES_ONLY);\n-            doTesting(laf, 50);\n-        } finally {\n-            SwingUtilities.invokeAndWait(() -> {\n-                if (frame != null) {\n-                    frame.dispose();\n-                }\n-            });\n-        }\n-    }\n-\n-    private static void checkFilesAndDirectoriesTest(UIManager.LookAndFeelInfo laf)\n-            throws Exception {\n-        System.out.println(\"Testing Files and Directories mode\");\n-        try {\n-            SwingUtilities.invokeAndWait(() -> {\n-                createAndShowUI();\n-            });\n-            robot.waitForIdle();\n-            robot.delay(1000);\n-            fileChooser.setFileSelectionMode(JFileChooser.FILES_AND_DIRECTORIES);\n-            doTesting(laf, 50);\n-        } finally {\n-            SwingUtilities.invokeAndWait(() -> {\n-                if (frame != null) {\n-                    frame.dispose();\n-                }\n-            });\n-        }\n-    }\n-\n-    private static void createAndShowUI() {\n-        frame = new JFrame(\"Test File Chooser Single Directory Selection\");\n-        frame.getContentPane().setLayout(new BorderLayout());\n-        fileChooser = new JFileChooser(\"user.home\");\n-        fileChooser.setMultiSelectionEnabled(true);\n-        fileChooser.setControlButtonsAreShown(false);\n-\n-        getSelectedFilesButton = new JButton();\n-        getSelectedFilesButton.setText(\"Print selected Files\");\n-        getSelectedFilesButton.addActionListener(new ActionListener() {\n-            public void actionPerformed(ActionEvent evt) {\n-                passed = false;\n-                File files[] = fileChooser.getSelectedFiles();\n-                if (files.length != 0) {\n-                    passed = true;\n-                }\n-            }\n-        });\n-\n-        frame.getContentPane().add(fileChooser, BorderLayout.CENTER);\n-        frame.getContentPane().add(getSelectedFilesButton, BorderLayout.SOUTH);\n-        frame.pack();\n-        frame.setLocationRelativeTo(null);\n-        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);\n-        frame.setVisible(true);\n-    }\n-\n-    private static void setLookAndFeel(UIManager.LookAndFeelInfo laf) {\n-        try {\n-            UIManager.setLookAndFeel(laf.getClassName());\n-        } catch (UnsupportedLookAndFeelException ignored) {\n-            System.out.println(\"Unsupported LAF: \" + laf.getClassName());\n-        } catch (ClassNotFoundException | InstantiationException\n-                 | IllegalAccessException e) {\n-            throw new RuntimeException(e);\n-        }\n-    }\n-\n-    private static void doTesting(UIManager.LookAndFeelInfo laf, int xOffset) {\n-        Point frameLocation = fileChooser.getLocationOnScreen();\n-        int frameWidth = frame.getWidth();\n-        int frameHeight = frame.getHeight();\n-\n-        Point btnLocation = getSelectedFilesButton.getLocationOnScreen();\n-        int btnWidth = getSelectedFilesButton.getWidth();\n-        int btnHeight = getSelectedFilesButton.getHeight();\n-        clickMouse(frameLocation, 0, frameHeight, xOffset);\n-        clickMouse(btnLocation, btnWidth, btnHeight, 0);\n-        checkResult(laf);\n-    }\n-\n-    private static void clickMouse(Point point, int width, int height,\n-                                   int xOffset) {\n-        robot.mouseMove(point.x + width\/2 + xOffset , point.y + height\/3);\n-        robot.mousePress(InputEvent.BUTTON1_DOWN_MASK);\n-        robot.mouseRelease(InputEvent.BUTTON1_DOWN_MASK);\n-        robot.delay(100);\n-    }\n-\n-    private static void checkResult(UIManager.LookAndFeelInfo laf) {\n-        if (!passed)\n-            throw new RuntimeException(\"getSelectedFiles returned \" +\n-                    \"empty array for LAF: \"+laf.getClassName());\n-    }\n-}\n","filename":"test\/jdk\/com\/sun\/java\/swing\/plaf\/gtk\/TestFileChooserSingleDirectorySelection.java","additions":0,"deletions":218,"binary":false,"changes":218,"status":"deleted"},{"patch":"@@ -28,1 +28,1 @@\n- * @requires (os.family == \"windows\") & (vm.compMode != \"Xcomp\") & (vm.compMode != \"Xint\")\n+ * @requires (os.family == \"windows\")\n@@ -30,2 +30,2 @@\n- * @enablePreview\n- * @run main\/othervm JdbLastErrorTest\n+ * @run compile --release 20 --enable-preview JdbLastErrorTest.java\n+ * @run main\/othervm --enable-preview JdbLastErrorTest\n","filename":"test\/jdk\/com\/sun\/jdi\/JdbLastErrorTest.java","additions":3,"deletions":3,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2002, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2002, 2018, Oracle and\/or its affiliates. All rights reserved.\n@@ -27,3 +27,0 @@\n-import java.net.DatagramSocket;\n-import java.net.InetAddress;\n-import java.net.InetSocketAddress;\n@@ -34,2 +31,0 @@\n-import jdk.test.lib.net.URIBuilder;\n-\n@@ -41,1 +36,1 @@\n- * @library ..\/lib\/ \/test\/lib\n+ * @library ..\/lib\/\n@@ -47,0 +42,7 @@\n+    \/\/ Host 10.0.0.0 is a bit bucket, used here to simulate a DNS server that\n+    \/\/ doesn't respond. 10.0.0.0 server shouldn't be reachable.\n+    \/\/ Ping to this address should not give any reply\n+    private static final String HOST = \"10.0.0.0\";\n+    \/\/ Port 9 is a bit bucket, used here to simulate a DNS server that\n+    \/\/ doesn't respond.\n+    private static final int PORT = 9;\n@@ -68,14 +70,5 @@\n-        \/\/ Create a DatagramSocket and bind it to the loopback address to simulate\n-        \/\/ UDP DNS server that doesn't respond\n-        try (DatagramSocket ds = new DatagramSocket(\n-                new InetSocketAddress(InetAddress.getLoopbackAddress(), 0))) {\n-            String allQuietUrl = URIBuilder.newBuilder()\n-                    .scheme(\"dns\")\n-                    .loopback()\n-                    .port(ds.getLocalPort())\n-                    .build()\n-                    .toString();\n-            env().put(Context.PROVIDER_URL, allQuietUrl);\n-            env().put(\"com.sun.jndi.dns.timeout.initial\", String.valueOf(TIMEOUT));\n-            env().put(\"com.sun.jndi.dns.timeout.retries\", String.valueOf(RETRIES));\n-            setContext(new InitialDirContext(env()));\n+        String allQuietUrl = \"dns:\/\/\" + HOST + \":\" + PORT;\n+        env().put(Context.PROVIDER_URL, allQuietUrl);\n+        env().put(\"com.sun.jndi.dns.timeout.initial\", String.valueOf(TIMEOUT));\n+        env().put(\"com.sun.jndi.dns.timeout.retries\", String.valueOf(RETRIES));\n+        setContext(new InitialDirContext(env()));\n@@ -83,3 +76,3 @@\n-            \/\/ Any request should fail after timeouts have expired.\n-            startTime = Instant.now();\n-            context().getAttributes(\"\");\n+        \/\/ Any request should fail after timeouts have expired.\n+        startTime = Instant.now();\n+        context().getAttributes(\"\");\n@@ -87,3 +80,2 @@\n-            throw new RuntimeException(\n-                    \"Failed: getAttributes succeeded unexpectedly\");\n-        }\n+        throw new RuntimeException(\n+                \"Failed: getAttributes succeeded unexpectedly\");\n","filename":"test\/jdk\/com\/sun\/jndi\/dns\/ConfigTests\/Timeout.java","additions":19,"deletions":27,"binary":false,"changes":46,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2021, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2021, Oracle and\/or its affiliates. All rights reserved.\n@@ -28,1 +28,1 @@\n- * @run testng\/othervm\/timeout=180 StressDirListings\n+ * @run testng\/othervm StressDirListings\n@@ -60,8 +60,0 @@\n-    static final long start = System.nanoTime();\n-    public static String now() {\n-        long now = System.nanoTime() - start;\n-        long secs = now \/ 1000_000_000;\n-        long mill = (now % 1000_000_000) \/ 1000_000;\n-        long nan = now % 1000_000;\n-        return String.format(\"[%d s, %d ms, %d ns] \", secs, mill, nan);\n-    }\n@@ -73,1 +65,0 @@\n-        out.println(now() + \" creating server\");\n@@ -82,1 +73,0 @@\n-        out.println(now() + \" server started\");\n@@ -87,1 +77,0 @@\n-        out.println(now() + \" stopping server\");\n@@ -89,1 +78,0 @@\n-        out.println(now() + \" server stopped\");\n@@ -103,1 +91,0 @@\n-        out.println(now() + \" starting test\");\n@@ -112,3 +99,0 @@\n-            if (i % 1000 == 0) {\n-                out.println(now());\n-            }\n@@ -116,1 +100,0 @@\n-        out.println(now() + \" test finished\");\n","filename":"test\/jdk\/com\/sun\/net\/httpserver\/simpleserver\/StressDirListings.java","additions":2,"deletions":19,"binary":false,"changes":21,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2002, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2002, 2020, Oracle and\/or its affiliates. All rights reserved.\n@@ -28,2 +28,0 @@\n-import java.awt.GraphicsConfiguration;\n-import java.awt.GraphicsEnvironment;\n@@ -37,3 +35,0 @@\n-import java.awt.image.BufferedImage;\n-import java.io.File;\n-import java.io.IOException;\n@@ -43,2 +38,0 @@\n-import javax.imageio.ImageIO;\n-\n@@ -59,1 +52,1 @@\n-    public static void main(final String[] args) throws IOException {\n+    public static void main(final String[] args) {\n@@ -64,1 +57,1 @@\n-    private void test() throws IOException {\n+    private void test() {\n@@ -87,1 +80,1 @@\n-    public void start () throws IOException {\n+    public void start () {\n@@ -99,2 +92,1 @@\n-        robot.waitForIdle();\n-        robot.delay(1000);\n+        robot.delay(2000);\n@@ -107,2 +99,2 @@\n-        robot.mousePress(InputEvent.BUTTON1_DOWN_MASK);\n-        robot.mouseRelease(InputEvent.BUTTON1_DOWN_MASK);\n+        robot.mousePress(InputEvent.BUTTON1_MASK);\n+        robot.mouseRelease(InputEvent.BUTTON1_MASK);\n@@ -131,2 +123,0 @@\n-        robot.delay(500);\n-\n@@ -137,1 +127,0 @@\n-            robot.delay(500);\n@@ -146,10 +135,0 @@\n-            \/\/ Print out os name to check if mac conditional is relevant\n-            System.err.println(\"Failed on os: \" + osName);\n-\n-            \/\/ Save image to better debug the status of test when failing\n-            GraphicsConfiguration ge = GraphicsEnvironment\n-                    .getLocalGraphicsEnvironment().getDefaultScreenDevice()\n-                    .getDefaultConfiguration();\n-            BufferedImage failImage = robot.createScreenCapture(ge.getBounds());\n-            ImageIO.write(failImage, \"png\", new File(\"failImage.png\"));\n-\n","filename":"test\/jdk\/java\/awt\/Focus\/UnaccessibleChoice\/AccessibleChoiceTest.java","additions":7,"deletions":28,"binary":false,"changes":35,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2015, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2015, Oracle and\/or its affiliates. All rights reserved.\n@@ -27,1 +27,1 @@\n- *          if transform includes INFINITY\n+ *          if transform includes INIFINITY\n@@ -30,4 +30,4 @@\n-import java.awt.Font;\n-import java.awt.Graphics2D;\n-import java.awt.geom.AffineTransform;\n-import java.awt.image.BufferedImage;\n+import java.awt.*;\n+import java.awt.font.*;\n+import java.awt.geom.*;\n+import java.awt.image.*;\n@@ -44,10 +44,3 @@\n-            System.out.println(\"Task running at \" + System.currentTimeMillis());\n-            System.out.flush();\n-            synchronized (DrawStringWithInfiniteXform.class) {\n-               System.out.println(\n-                   \"Checking done at \" + System.currentTimeMillis());\n-               System.out.flush();\n-                if (!done) {\n-                    throw new RuntimeException(\n-                       \"drawString with InfiniteXform transform takes long time\");\n-                }\n+            if (!done) {\n+                throw new\n+                RuntimeException(\"drawString with InfiniteXform transform takes long time\");\n@@ -59,1 +52,1 @@\n-        timer.schedule(new ScheduleTask(), 30000);\n+        timer.schedule(new ScheduleTask(), 20000);\n@@ -68,2 +61,0 @@\n-        System.out.println(\"start at \" + System.currentTimeMillis());\n-        System.out.flush();\n@@ -71,3 +62,1 @@\n-        for (int i=0; i<6; i++) {\n-            vals[i] = Float.POSITIVE_INFINITY;\n-        }\n+        for (int i=0;i<6;i++) vals[i]=Float.POSITIVE_INFINITY;\n@@ -76,1 +65,1 @@\n-        BufferedImage bi = new BufferedImage(1, 1, BufferedImage.TYPE_INT_RGB);\n+        BufferedImage bi = new BufferedImage(1,1,BufferedImage.TYPE_INT_RGB);\n@@ -87,6 +76,2 @@\n-        System.out.println(\"Loop done at \" + System.currentTimeMillis());\n-        System.out.flush();\n-        synchronized (DrawStringWithInfiniteXform.class) {\n-            done = true;\n-            timer.cancel();\n-        }\n+        done = true;\n+        timer.cancel();\n","filename":"test\/jdk\/java\/awt\/FontClass\/DrawStringWithInfiniteXform.java","additions":14,"deletions":29,"binary":false,"changes":43,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2002, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2002, 2018, Oracle and\/or its affiliates. All rights reserved.\n@@ -29,0 +29,2 @@\n+  @library    ..\/..\/regtesthelpers\n+  @build      Util\n@@ -32,10 +34,3 @@\n-import java.awt.AWTError;\n-import java.awt.AWTException;\n-import java.awt.Frame;\n-import java.awt.Rectangle;\n-import java.awt.Robot;\n-import java.awt.event.InputEvent;\n-import java.awt.event.MouseEvent;\n-import java.awt.event.MouseListener;\n-import java.awt.event.WindowEvent;\n-import java.awt.event.WindowListener;\n+import java.awt.*;\n+import java.awt.event.*;\n+import test.java.awt.regtesthelpers.Util;\n@@ -44,1 +39,1 @@\n-        WindowListener\n+ WindowListener\n@@ -53,4 +48,3 @@\n-    private volatile boolean failed = false;\n-\n-    public static void main(final String[] args) throws AWTException {\n-        new TitleBarDoubleClick().doTest();\n+    public static void main(final String[] args) {\n+        TitleBarDoubleClick app = new TitleBarDoubleClick();\n+        app.start();\n@@ -59,3 +53,6 @@\n-    public TitleBarDoubleClick() throws AWTException {\n-        robot = new Robot();\n-        robot.setAutoDelay(100);\n+    public void start ()\n+    {\n+            robot = Util.createRobot();\n+            robot.setAutoDelay(100);\n+            robot.mouseMove(BOUNDS.x + (BOUNDS.width \/ 2),\n+                            BOUNDS.y + (BOUNDS.height\/ 2));\n@@ -63,4 +60,6 @@\n-        robot.mouseMove(\n-                BOUNDS.x + (BOUNDS.width \/ 2),\n-                BOUNDS.y + (BOUNDS.height\/ 2)\n-        );\n+            frame = new Frame(\"TitleBarDoubleClick\");\n+            frame.setBounds(BOUNDS);\n+            frame.addMouseListener(this);\n+            frame.addWindowListener(this);\n+            frame.setVisible(true);\n+    }\/\/ start()\n@@ -68,5 +67,3 @@\n-        frame = new Frame(\"TitleBarDoubleClick\");\n-        frame.setBounds(BOUNDS);\n-        frame.addMouseListener(this);\n-        frame.addWindowListener(this);\n-        frame.setVisible(true);\n+    \/\/ Move the mouse into the title bar and double click to maximize the\n+    \/\/ Frame\n+    static boolean hasRun = false;\n@@ -74,3 +71,3 @@\n-        robot.waitForIdle();\n-        robot.delay(1000);\n-    }\n+    private void doTest() {\n+        if (hasRun) return;\n+        hasRun = true;\n@@ -78,1 +75,0 @@\n-    public void doTest() throws AWTException {\n@@ -80,33 +76,17 @@\n-        robot.mouseMove(\n-                BOUNDS.x + (BOUNDS.width \/ 2),\n-                BOUNDS.y + TITLE_BAR_OFFSET\n-        );\n-        robot.waitForIdle();\n-\n-        System.out.println(\"1st press:   currentTimeMillis: \"\n-                + System.currentTimeMillis());\n-        robot.mousePress(InputEvent.BUTTON1_DOWN_MASK);\n-\n-        System.out.println(\"1st release: currentTimeMillis: \"\n-                + System.currentTimeMillis());\n-        robot.mouseRelease(InputEvent.BUTTON1_DOWN_MASK);\n-\n-        System.out.println(\"2nd press:   currentTimeMillis: \"\n-                + System.currentTimeMillis());\n-        robot.mousePress(InputEvent.BUTTON1_DOWN_MASK);\n-\n-        System.out.println(\"2nd release: currentTimeMillis: \"\n-                + System.currentTimeMillis());\n-        robot.mouseRelease(InputEvent.BUTTON1_DOWN_MASK);\n-\n-        System.out.println(\"done:        currentTimeMillis: \"\n-                + System.currentTimeMillis());\n-\n-        robot.waitForIdle();\n-        robot.delay(500);\n-\n-        frame.dispose();\n-\n-        if (failed) {\n-            throw new AWTError(\"Test failed\");\n-        }\n+            robot.mouseMove(BOUNDS.x + (BOUNDS.width \/ 2),\n+                            BOUNDS.y + TITLE_BAR_OFFSET);\n+            robot.delay(50);\n+            \/\/ Util.waitForIdle(robot) seem always hangs here.\n+            \/\/ Need to use it instead robot.delay() when the bug become fixed.\n+            System.out.println(\"1st press:   currentTimeMillis: \" + System.currentTimeMillis());\n+            robot.mousePress(InputEvent.BUTTON1_MASK);\n+            robot.delay(50);\n+            System.out.println(\"1st release: currentTimeMillis: \" + System.currentTimeMillis());\n+            robot.mouseRelease(InputEvent.BUTTON1_MASK);\n+            robot.delay(50);\n+            System.out.println(\"2nd press:   currentTimeMillis: \" + System.currentTimeMillis());\n+            robot.mousePress(InputEvent.BUTTON1_MASK);\n+            robot.delay(50);\n+            System.out.println(\"2nd release: currentTimeMillis: \" + System.currentTimeMillis());\n+            robot.mouseRelease(InputEvent.BUTTON1_MASK);\n+            System.out.println(\"done:        currentTimeMillis: \" + System.currentTimeMillis());\n@@ -115,3 +95,2 @@\n-    private void fail(MouseEvent e) {\n-        System.err.println(\"Failed: \" + e);\n-        failed = true;\n+    private void fail() {\n+        throw new AWTError(\"Test failed\");\n@@ -122,11 +101,11 @@\n-    public void mousePressed(MouseEvent e) { fail(e); }\n-    public void mouseReleased(MouseEvent e) { fail(e); }\n-    public void mouseClicked(MouseEvent e) { fail(e); }\n-\n-    public void windowActivated(WindowEvent e) {}\n-    public void windowClosed(WindowEvent e) {}\n-    public void windowClosing(WindowEvent e) {}\n-    public void windowDeactivated(WindowEvent e) {}\n-    public void windowDeiconified(WindowEvent e) {}\n-    public void windowIconified(WindowEvent e) {}\n-    public void windowOpened(WindowEvent e) {}\n+    public void mousePressed(MouseEvent e) {fail();}\n+    public void mouseReleased(MouseEvent e) {fail();}\n+    public void mouseClicked(MouseEvent e) {fail();}\n+\n+    public void windowActivated(WindowEvent  e) {doTest();}\n+    public void windowClosed(WindowEvent  e) {}\n+    public void windowClosing(WindowEvent  e) {}\n+    public void windowDeactivated(WindowEvent  e) {}\n+    public void windowDeiconified(WindowEvent  e) {}\n+    public void windowIconified(WindowEvent  e) {}\n+    public void windowOpened(WindowEvent  e) {}\n","filename":"test\/jdk\/java\/awt\/Mouse\/TitleBarDoubleClick\/TitleBarDoubleClick.java","additions":58,"deletions":79,"binary":false,"changes":137,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2007, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2007, 2020, Oracle and\/or its affiliates. All rights reserved.\n@@ -34,1 +34,0 @@\n-import java.util.Arrays;\n@@ -53,2 +52,2 @@\n-    private volatile boolean focusGained = false;\n-    private volatile boolean startTest = false;\n+    private boolean focusGained = false;\n+    private boolean startTest = false;\n@@ -56,1 +55,1 @@\n-    private volatile Frame frame;\n+    private Frame frame;\n@@ -61,2 +60,2 @@\n-    private final int[] textKeys, modifierKeys, inputMasks;\n-    private final boolean[] modifierStatus, textStatus;\n+    private int[] textKeys, modifierKeys, inputMasks;\n+    private boolean[] modifierStatus, textStatus;\n@@ -81,3 +80,3 @@\n-            inputMasks[0] = InputEvent.SHIFT_DOWN_MASK;\n-            inputMasks[1] = InputEvent.CTRL_DOWN_MASK;\n-            inputMasks[2] = InputEvent.ALT_DOWN_MASK;\n+            inputMasks[0] =  InputEvent.SHIFT_MASK;\n+            inputMasks[1] =  InputEvent.CTRL_MASK;\n+            inputMasks[2] =  InputEvent.ALT_MASK;\n@@ -92,4 +91,4 @@\n-            inputMasks[0] = InputEvent.SHIFT_DOWN_MASK;\n-            inputMasks[1] = InputEvent.CTRL_DOWN_MASK;\n-            inputMasks[2] = InputEvent.ALT_DOWN_MASK;\n-            inputMasks[3] = InputEvent.ALT_GRAPH_DOWN_MASK;\n+            inputMasks[0] =  InputEvent.SHIFT_MASK;\n+            inputMasks[1] =  InputEvent.CTRL_MASK;\n+            inputMasks[2] =  InputEvent.ALT_MASK;\n+            inputMasks[3] =  InputEvent.ALT_GRAPH_MASK;\n@@ -111,1 +110,1 @@\n-        EventQueue.invokeAndWait(this::initializeGUI);\n+        EventQueue.invokeAndWait( () -> { initializeGUI(); });\n@@ -119,1 +118,1 @@\n-            if (!startTest) {\n+            if (! startTest) {\n@@ -123,1 +122,1 @@\n-                if ((event.getModifiersEx() & inputMasks[x]) != 0) {\n+                if ((event.getModifiers() & inputMasks[x]) != 0) {\n@@ -125,1 +124,1 @@\n-                            InputEvent.getModifiersExText(inputMasks[x]));\n+                                      event.getKeyModifiersText(inputMasks[x]));\n@@ -132,1 +131,1 @@\n-                            KeyEvent.getKeyText(textKeys[x]));\n+                                                 event.getKeyText(textKeys[x]));\n@@ -153,19 +152,53 @@\n-        try {\n-            robot = new ExtendedRobot();\n-            robot.setAutoDelay(50);\n-            robot.waitForIdle(1000);\n-\n-            robot.mouseMove(\n-                    (int) frame.getLocationOnScreen().getX() +\n-                            frame.getSize().width \/ 2,\n-                    (int) frame.getLocationOnScreen().getY() +\n-                            frame.getSize().height \/ 2\n-            );\n-            robot.click(MouseEvent.BUTTON1_DOWN_MASK);\n-            robot.waitForIdle();\n-            assertTrue(focusGained, \"FAIL: Canvas gained focus!\");\n-\n-            String error = null;\n-            exit1:\n-            for (int i = 0; i < modifierKeys.length; i++) {\n-                for (int j = 0; j < textKeys.length; j++) {\n+        robot = new ExtendedRobot();\n+        robot.setAutoDelay(20);\n+        robot.waitForIdle();\n+\n+        robot.mouseMove((int) frame.getLocationOnScreen().getX() +\n+                                                    frame.getSize().width \/ 2,\n+                        (int) frame.getLocationOnScreen().getY() +\n+                                                    frame.getSize().height \/ 2);\n+        robot.click(MouseEvent.BUTTON1_MASK);\n+        robot.waitForIdle();\n+        assertTrue(focusGained, \"FAIL: Canvas gained focus!\");\n+\n+        String error = null;\n+        exit1:\n+        for (int i = 0; i < modifierKeys.length; i++) {\n+            for (int j = 0; j < textKeys.length; j++) {\n+                if (error != null) {\n+                    break exit1;\n+                }\n+                robot.waitForIdle(100);\n+                synchronized (lock) {\n+                    tempPress = false;\n+                    robot.keyPress(modifierKeys[i]);\n+                    lock.wait(WAIT_DELAY);\n+                }\n+                if (!tempPress) {\n+                    error =\"FAIL: keyPressed triggered for i=\" + i;\n+                }\n+\n+                synchronized (lock) {\n+                    resetStatus();\n+                    startTest = true;\n+                    robot.keyPress(textKeys[j]);\n+                    lock.wait(WAIT_DELAY);\n+                }\n+\n+                if (!(modifierStatus[i] && textStatus[j])) {\n+                    error = \"FAIL: KeyEvent not proper!\"+\n+                            \"Key checked: i=\" + i + \"; j=\" + j+\n+                            \"ModifierStatus = \" + modifierStatus[i]+\n+                            \"TextStatus = \" + textStatus[j];\n+                }\n+\n+                startTest = false;\n+                robot.keyRelease(textKeys[j]);\n+                robot.keyRelease(modifierKeys[i]);\n+            }\n+        }\n+\n+        exit2:\n+        for (int i = 0; i < modifierKeys.length; i++) {\n+            for (int j = i + 1; j < modifierKeys.length; j++) {\n+                for (int k = 0; k < textKeys.length; k++) {\n@@ -173,1 +206,1 @@\n-                        break exit1;\n+                        break exit2;\n@@ -175,29 +208,10 @@\n-                    try {\n-                        robot.waitForIdle(100);\n-                        synchronized (lock) {\n-                            tempPress = false;\n-                            robot.keyPress(modifierKeys[i]);\n-                            lock.wait(WAIT_DELAY);\n-                        }\n-                        if (!tempPress) {\n-                            error = \"FAIL: keyPressed triggered for i=\" + i;\n-                        }\n-\n-                        synchronized (lock) {\n-                            resetStatus();\n-                            startTest = true;\n-                            robot.keyPress(textKeys[j]);\n-                            lock.wait(WAIT_DELAY);\n-                        }\n-\n-                        if (!(modifierStatus[i] && textStatus[j])) {\n-                            error = \"FAIL: KeyEvent not proper!\" +\n-                                    \"Key checked: i=\" + i + \"; j=\" + j +\n-                                    \"ModifierStatus = \" + modifierStatus[i] +\n-                                    \"TextStatus = \" + textStatus[j];\n-                        }\n-\n-                        startTest = false;\n-                    } finally {\n-                        robot.keyRelease(textKeys[j]);\n-                        robot.keyRelease(modifierKeys[i]);\n+                    robot.waitForIdle(100);\n+                    synchronized (lock) {\n+                        tempPress = false;\n+                        robot.keyPress(modifierKeys[i]);\n+                        lock.wait(WAIT_DELAY);\n+                    }\n+\n+                    if (!tempPress) {\n+                        error = \"FAIL: MultiKeyTest: keyPressed \" +\n+                                                         \"triggered for i=\" + i;\n@@ -205,2 +219,0 @@\n-                }\n-            }\n@@ -208,52 +220,24 @@\n-            exit2:\n-            for (int i = 0; i < modifierKeys.length; i++) {\n-                for (int j = i + 1; j < modifierKeys.length; j++) {\n-                    for (int k = 0; k < textKeys.length; k++) {\n-                        if (error != null) {\n-                            break exit2;\n-                        }\n-                        try {\n-                            robot.waitForIdle(100);\n-                            synchronized (lock) {\n-                                tempPress = false;\n-                                robot.keyPress(modifierKeys[i]);\n-                                lock.wait(WAIT_DELAY);\n-                            }\n-\n-                            if (!tempPress) {\n-                                error = \"FAIL: MultiKeyTest: keyPressed \" +\n-                                        \"triggered for i=\" + i;\n-                            }\n-\n-                            synchronized (lock) {\n-                                tempPress = false;\n-                                robot.keyPress(modifierKeys[j]);\n-                                lock.wait(WAIT_DELAY);\n-                            }\n-                            if (!tempPress) {\n-                                error = \"FAIL: MultiKeyTest keyPressed \" +\n-                                        \"triggered for j=\" + j;\n-                            }\n-\n-                            synchronized (lock) {\n-                                resetStatus();\n-                                startTest = true;\n-                                robot.keyPress(textKeys[k]);\n-                                lock.wait(WAIT_DELAY);\n-                            }\n-                            if (!(modifierStatus[i]\n-                                    && modifierStatus[j]\n-                                    && textStatus[k])) {\n-                                error = \"FAIL: KeyEvent not proper!\" +\n-                                        \"Key checked: i=\" + i + \"; j=\" + j + \"; k=\" + k +\n-                                        \"Modifier1Status = \" + modifierStatus[i] +\n-                                        \"Modifier2Status = \" + modifierStatus[j] +\n-                                        \"TextStatus = \" + textStatus[k];\n-                            }\n-\n-                            startTest = false;\n-                        } finally {\n-                            robot.keyRelease(textKeys[k]);\n-                            robot.keyRelease(modifierKeys[j]);\n-                            robot.keyRelease(modifierKeys[i]);\n-                        }\n+                    synchronized (lock) {\n+                        tempPress = false;\n+                        robot.keyPress(modifierKeys[j]);\n+                        lock.wait(WAIT_DELAY);\n+                    }\n+                    if (!tempPress) {\n+                        error = \"FAIL: MultiKeyTest keyPressed \" +\n+                                                         \"triggered for j=\" + j;\n+                    };\n+\n+                    synchronized (lock) {\n+                        resetStatus();\n+                        startTest = true;\n+                        robot.keyPress(textKeys[k]);\n+                        lock.wait(WAIT_DELAY);\n+                    }\n+                    if (!(modifierStatus[i] && modifierStatus[j]\n+                                                              && textStatus[k]))\n+                    {\n+                        error = \"FAIL: KeyEvent not proper!\" +\n+                               \"Key checked: i=\" + i + \"; j=\" + j + \"; k=\" + k +\n+                               \"Modifier1Status = \" + modifierStatus[i] +\n+                               \"Modifier2Status = \" + modifierStatus[j] +\n+                               \"TextStatus = \" + textStatus[k];\n@@ -261,0 +245,5 @@\n+\n+                    startTest = false;\n+                    robot.keyRelease(textKeys[k]);\n+                    robot.keyRelease(modifierKeys[j]);\n+                    robot.keyRelease(modifierKeys[i]);\n@@ -263,4 +252,0 @@\n-\n-            assertNull(error, error);\n-        } finally {\n-            frame.dispose();\n@@ -268,0 +253,3 @@\n+\n+        frame.dispose();\n+        assertNull(error, error);\n@@ -271,2 +259,6 @@\n-        Arrays.fill(modifierStatus, false);\n-        Arrays.fill(textStatus, false);\n+        for (int i = 0; i < modifierStatus.length; i++) {\n+            modifierStatus[i] = false;\n+        }\n+        for (int i = 0; i < textStatus.length; i++) {\n+            textStatus[i] = false;\n+        }\n","filename":"test\/jdk\/java\/awt\/Robot\/ModifierRobotKey\/ModifierRobotKeyTest.java","additions":120,"deletions":128,"binary":false,"changes":248,"status":"modified"},{"patch":"@@ -24,11 +24,2 @@\n-import java.awt.AWTException;\n-import java.awt.Component;\n-import java.awt.Frame;\n-import java.awt.GridLayout;\n-import java.awt.Panel;\n-import java.awt.Point;\n-import java.awt.Robot;\n-import java.awt.Scrollbar;\n-import java.awt.Toolkit;\n-import java.awt.event.MouseWheelEvent;\n-import java.awt.event.MouseWheelListener;\n+import java.awt.*;\n+import java.awt.event.*;\n@@ -44,5 +35,1 @@\n-        implements MouseWheelListener {\n-\n-    final static boolean isWindows =\n-            Toolkit.getDefaultToolkit().getClass()\n-                    .getName().equals(\"sun.awt.windows.WToolkit\");\n+        implements MouseWheelListener, WindowListener {\n@@ -50,0 +37,1 @@\n+    final static String tk = Toolkit.getDefaultToolkit().getClass().getName();\n@@ -56,1 +44,1 @@\n-    final static int PANEL_REPS = isWindows ? REPS * 2: REPS;\n+    final static int PANEL_REPS = tk.equals(\"sun.awt.windows.WToolkit\")? REPS * 2: REPS;\n@@ -61,0 +49,6 @@\n+    class Sema {\n+        boolean flag;\n+        boolean getVal() { return flag;}\n+        void setVal(boolean b) { flag = b;}\n+    }\n+    Sema sema = new Sema();\n@@ -64,2 +58,2 @@\n-    volatile int sb1upevents, sb2upevents, pnlupevents;\n-    volatile int sb1downevents, sb2downevents, pnldownevents;\n+    int sb1upevents, sb2upevents, pnlupevents;\n+    int sb1downevents, sb2downevents, pnldownevents;\n@@ -78,0 +72,1 @@\n+\n@@ -80,1 +75,1 @@\n-        robot.setAutoDelay(250);\n+        robot.setAutoDelay(500);\n@@ -85,0 +80,1 @@\n+        frame.addWindowListener(this);\n@@ -99,3 +95,8 @@\n-        robot.waitForIdle();\n-        robot.delay(1000);\n-\n+        \/\/ When Frame is active, start testing (handled in windowActivated())\n+        while (true) {\n+            synchronized (sema) {\n+                if (sema.getVal()) {\n+                    break;\n+                }\n+            }\n+        }\n@@ -110,3 +111,0 @@\n-\n-        robot.delay(500);\n-\n@@ -114,1 +112,0 @@\n-\n@@ -172,0 +169,13 @@\n+\n+    public void windowActivated(WindowEvent we) {\n+        synchronized (sema) {\n+            sema.setVal(true);\n+        }\n+    }\n+\n+    public void windowClosed(WindowEvent we) {}\n+    public void windowClosing(WindowEvent we) {}\n+    public void windowDeactivated(WindowEvent we) {}\n+    public void windowDeiconified(WindowEvent we) {}\n+    public void windowIconified(WindowEvent we) {}\n+    public void windowOpened(WindowEvent we) {}\n","filename":"test\/jdk\/java\/awt\/Scrollbar\/ScrollbarMouseWheelTest\/ScrollbarMouseWheelTest.java","additions":37,"deletions":27,"binary":false,"changes":64,"status":"modified"},{"patch":"@@ -1,51 +0,0 @@\n-\/*\n- * Copyright Amazon.com Inc. or its affiliates. All Rights Reserved.\n- * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n- *\n- * This code is free software; you can redistribute it and\/or modify it\n- * under the terms of the GNU General Public License version 2 only, as\n- * published by the Free Software Foundation.\n- *\n- * This code is distributed in the hope that it will be useful, but WITHOUT\n- * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n- * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n- * version 2 for more details (a copy is included in the LICENSE file that\n- * accompanied this code).\n- *\n- * You should have received a copy of the GNU General Public License version\n- * 2 along with this work; if not, write to the Free Software Foundation,\n- * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n- *\n- * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n- * or visit www.oracle.com if you need additional information or have any\n- * questions.\n- *\/\n-\n-import java.awt.Color;\n-import java.awt.color.ColorSpace;\n-\n-\/**\n- * @test\n- * @bug 6528710\n- * @summary Verifies sRGB-ColorSpace to sRGB-ColorSpace conversion quality\n- *\/\n-public final class SimpleSRGBConversionQualityTest {\n-\n-    public static void main(String[] args) {\n-        ColorSpace cspace = ColorSpace.getInstance(ColorSpace.CS_sRGB);\n-        float fvalue[] = {1.0f, 1.0f, 1.0f};\n-\n-        Color c = new Color(cspace, fvalue, 1.0f);\n-        if (c.getRed() != 255 || c.getGreen() != 255 || c.getBlue() != 255) {\n-            throw new RuntimeException(\"Wrong color: \" + c);\n-        }\n-\n-        float frgbvalue[] = cspace.toRGB(fvalue);\n-        for (int i = 0; i < 3; ++i) {\n-            if (frgbvalue[i] != 1.0f) {\n-                System.err.println(fvalue[i] + \" -> \" + frgbvalue[i]);\n-                throw new RuntimeException(\"Wrong value\");\n-            }\n-        }\n-    }\n-}\n","filename":"test\/jdk\/java\/awt\/color\/ICC_ColorSpace\/SimpleSRGBConversionQualityTest.java","additions":0,"deletions":51,"binary":false,"changes":51,"status":"deleted"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2015, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2015, 2017, Oracle and\/or its affiliates. All rights reserved.\n@@ -94,1 +94,0 @@\n-        robot.waitForIdle();\n@@ -97,1 +96,0 @@\n-        robot.delay(1000);\n@@ -105,1 +103,1 @@\n-        long time = System.currentTimeMillis() + 2000;\n+        long time = System.currentTimeMillis() + 1000;\n@@ -146,1 +144,1 @@\n-        robot.mousePress(InputEvent.BUTTON1_DOWN_MASK);\n+        robot.mousePress(InputEvent.BUTTON1_MASK);\n@@ -152,1 +150,1 @@\n-        robot.mouseRelease(InputEvent.BUTTON1_DOWN_MASK);\n+        robot.mouseRelease(InputEvent.BUTTON1_MASK);\n@@ -243,0 +241,8 @@\n+            long time = System.currentTimeMillis() + 200;\n+\n+            while (!dialog.isVisible()) {\n+                if (time < System.currentTimeMillis()) {\n+                    throw new RuntimeException(\"Dialog is not visible!\");\n+                }\n+                Thread.sleep(10);\n+            }\n@@ -246,4 +252,1 @@\n-            robot.delay(1000);\n-            if (!dialog.isVisible()) {\n-                throw new RuntimeException(\"Dialog is not visible!\");\n-            }\n+            robot.delay(200);\n@@ -254,2 +257,3 @@\n-            robot.mousePress(InputEvent.BUTTON1_DOWN_MASK);\n-            robot.mouseRelease(InputEvent.BUTTON1_DOWN_MASK);\n+            robot.mousePress(InputEvent.BUTTON1_MASK);\n+            robot.mouseRelease(InputEvent.BUTTON1_MASK);\n+\n@@ -258,2 +262,0 @@\n-        } finally {\n-            dialog.dispose();\n","filename":"test\/jdk\/java\/awt\/dnd\/MissingEventsOnModalDialog\/MissingEventsOnModalDialogTest.java","additions":16,"deletions":14,"binary":false,"changes":30,"status":"modified"},{"patch":"@@ -1,141 +0,0 @@\n-\/*\n- * Copyright (c) 2007, 2022, Oracle and\/or its affiliates. All rights reserved.\n- * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n- *\n- * This code is free software; you can redistribute it and\/or modify it\n- * under the terms of the GNU General Public License version 2 only, as\n- * published by the Free Software Foundation.\n- *\n- * This code is distributed in the hope that it will be useful, but WITHOUT\n- * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n- * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n- * version 2 for more details (a copy is included in the LICENSE file that\n- * accompanied this code).\n- *\n- * You should have received a copy of the GNU General Public License version\n- * 2 along with this work; if not, write to the Free Software Foundation,\n- * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n- *\n- * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n- * or visit www.oracle.com if you need additional information or have any\n- * questions.\n- *\/\n-\n-import java.awt.Dimension;\n-import java.awt.EventQueue;\n-import java.awt.FlowLayout;\n-import java.awt.Frame;\n-import java.awt.Point;\n-import java.awt.Robot;\n-import java.awt.TextArea;\n-import java.awt.event.InputEvent;\n-import java.awt.event.KeyEvent;\n-\n-\/*\n- * @test\n- * @key headful\n- * @bug 8296632\n- * @summary Verify the content changes of a TextArea via TextListener.\n- * @run main TextAreaTextEventTest\n- *\/\n-public class TextAreaTextEventTest {\n-\n-    private static Frame frame;\n-    private volatile static TextArea textArea;\n-    private volatile static boolean textChanged = false;\n-    private volatile static Point textAreaAt;\n-    private volatile static Dimension textAreaSize;\n-    private static Robot robot = null;\n-\n-    public static void main(String[] args) throws Exception {\n-        try {\n-            EventQueue.invokeAndWait(TextAreaTextEventTest::initializeGUI);\n-\n-            robot = new Robot();\n-            robot.setAutoDelay(100);\n-\n-            robot.waitForIdle();\n-            EventQueue.invokeAndWait(() -> {\n-                textAreaAt = textArea.getLocationOnScreen();\n-                textAreaSize = textArea.getSize();\n-            });\n-            robot.mouseMove(textAreaAt.x + textAreaSize.width \/ 2,\n-                textAreaAt.y + textAreaSize.height \/ 2);\n-            robot.mousePress(InputEvent.BUTTON1_DOWN_MASK);\n-            robot.mouseRelease(InputEvent.BUTTON1_DOWN_MASK);\n-            typeKey(KeyEvent.VK_T);\n-\n-            robot.waitForIdle();\n-            if (!textChanged) {\n-                throw new RuntimeException(\n-                    \"FAIL: TextEvent not triggered when key 'T' typed on TextArea\");\n-            }\n-\n-            typeKey(KeyEvent.VK_E);\n-            typeKey(KeyEvent.VK_S);\n-            typeKey(KeyEvent.VK_T);\n-\n-            textChanged = false;\n-            typeKey(KeyEvent.VK_ENTER);\n-\n-            robot.waitForIdle();\n-            if (!textChanged) {\n-                throw new RuntimeException(\n-                    \"FAIL: TextEvent not triggered when Enter pressed on TextArea\");\n-            }\n-\n-            textChanged = false;\n-            robot.mouseMove(textAreaAt.x + 4, textAreaAt.y + 10);\n-            robot.mousePress(InputEvent.BUTTON1_DOWN_MASK);\n-            robot.mouseRelease(InputEvent.BUTTON1_DOWN_MASK);\n-            robot.mousePress(InputEvent.BUTTON1_DOWN_MASK);\n-            for (int i = 0; i < textAreaSize.width \/ 2; i++) {\n-                robot.mouseMove(textAreaAt.x + 4 + i, textAreaAt.y + 10);\n-            }\n-            robot.mouseRelease(InputEvent.BUTTON1_DOWN_MASK);\n-\n-            robot.waitForIdle();\n-            if (textChanged) {\n-                throw new RuntimeException(\n-                    \"FAIL: TextEvent triggered when text is selected on TextArea!\");\n-            }\n-\n-            textChanged = false;\n-            typeKey(KeyEvent.VK_F3);\n-\n-            robot.waitForIdle();\n-            if (textChanged) {\n-                throw new RuntimeException(\n-                    \"FAIL: TextEvent triggered when special key F3 is pressed on TextArea!\");\n-            }\n-            System.out.println(\"Test passed!\");\n-        } finally {\n-            EventQueue.invokeAndWait(TextAreaTextEventTest::disposeFrame);\n-        }\n-    }\n-\n-    private static void initializeGUI() {\n-        frame = new Frame(\"Test Frame\");\n-        frame.setLayout(new FlowLayout());\n-        textArea = new TextArea(5, 15);\n-        textArea.addTextListener((event) -> {\n-            System.out.println(\"Got a text event: \" + event);\n-            textChanged = true;\n-        });\n-        frame.add(textArea);\n-        frame.pack();\n-        frame.setLocationRelativeTo(null);\n-        frame.setVisible(true);\n-    }\n-\n-    public static void disposeFrame() {\n-        if (frame != null) {\n-            frame.dispose();\n-        }\n-    }\n-\n-    private static void typeKey(int key) throws Exception {\n-        robot.keyPress(key);\n-        robot.keyRelease(key);\n-    }\n-}\n","filename":"test\/jdk\/java\/awt\/event\/ComponentEvent\/TextAreaTextEventTest.java","additions":0,"deletions":141,"binary":false,"changes":141,"status":"deleted"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2007, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2007, 2018, Oracle and\/or its affiliates. All rights reserved.\n@@ -28,2 +28,2 @@\n-  @summary Tests that pressing of Ctrl+ascii mostly fires KEY_TYPED with a Unicode control symbols\n-  @run main\/timeout=600 CtrlASCII\n+  @summary ests that pressing of Ctrl+ascii mostly fires KEY_TYPED with a Unicode control symbols\n+  @run main CtrlASCII\n@@ -32,10 +32,3 @@\n-import java.awt.AWTException;\n-import java.awt.BorderLayout;\n-import java.awt.Frame;\n-import java.awt.Point;\n-import java.awt.Robot;\n-import java.awt.TextField;\n-import java.awt.event.InputEvent;\n-import java.awt.event.KeyEvent;\n-import java.awt.event.KeyListener;\n-import java.util.HashMap;\n+import java.awt.*;\n+import java.awt.event.*;\n+import java.util.*;\n@@ -52,1 +45,2 @@\n-public class CtrlASCII extends Frame implements KeyListener {\n+public class CtrlASCII extends Frame implements KeyListener\n+{\n@@ -54,3 +48,3 @@\n-    static final HashMap<Character, Integer> KEYCHAR_MAP = new HashMap<>();\n-    static volatile boolean testFailed = false;\n-\n+    static Hashtable<Character, Integer> keycharHash = new Hashtable<Character, Integer>();\n+    static boolean testFailed = false;\n+    \/\/Frame frame;\n@@ -60,70 +54,63 @@\n-    static void fillHash() {\n-        KEYCHAR_MAP.put((char) 0x20, KeyEvent.VK_SPACE);             \/*32,x20*\/ \/*' ' *\/\n-        KEYCHAR_MAP.put((char) 0x21, KeyEvent.VK_EXCLAMATION_MARK);  \/*33,x21*\/ \/*'!' fr*\/\n-        KEYCHAR_MAP.put((char) 0x22, KeyEvent.VK_QUOTEDBL);          \/*34,x22*\/ \/*'\"' fr*\/\n-        KEYCHAR_MAP.put((char) 0x23, KeyEvent.VK_NUMBER_SIGN);       \/*35,x23*\/ \/*'#' de*\/\n-        KEYCHAR_MAP.put((char) 0x24, KeyEvent.VK_DOLLAR);            \/*36,x24*\/ \/*'$', de_CH*\/\n-        \/\/keycharHash.put('%', (char)0x25 );                         \/*37,x25*\/ \/*no VK, cannot test*\/\n-        KEYCHAR_MAP.put((char) 0x26, KeyEvent.VK_AMPERSAND);         \/*38,x26*\/ \/*'&', fr*\/\n-        KEYCHAR_MAP.put((char) 0x27, KeyEvent.VK_QUOTE);             \/*39,x27*\/ \/*''', fr*\/\n-        KEYCHAR_MAP.put((char) 0x28, KeyEvent.VK_LEFT_PARENTHESIS);  \/*40,x28*\/ \/*'(', fr*\/\n-        KEYCHAR_MAP.put((char) 0x29, KeyEvent.VK_RIGHT_PARENTHESIS); \/*41,x29*\/ \/*')', fr*\/\n-        KEYCHAR_MAP.put((char) 0x2a, KeyEvent.VK_ASTERISK);          \/*42,x2a*\/ \/*'*', fr*\/\n-        KEYCHAR_MAP.put((char) 0x2b, KeyEvent.VK_PLUS);              \/*43,x2b*\/ \/*'+', de*\/\n-        KEYCHAR_MAP.put((char) 0x2c, KeyEvent.VK_COMMA);             \/*44,x2c*\/  \/*','*\/\n-        KEYCHAR_MAP.put((char) 0x2d, KeyEvent.VK_MINUS);             \/*45,x2d*\/ \/*'-'*\/\n-        KEYCHAR_MAP.put((char) 0x2e, KeyEvent.VK_PERIOD);            \/*46,x2e*\/ \/*'.'*\/\n-        KEYCHAR_MAP.put((char) 0x2f, KeyEvent.VK_SLASH);             \/*47,x2f*\/ \/*'\/'*\/\n-        KEYCHAR_MAP.put((char) 0x30, KeyEvent.VK_0);                 \/*48,x30*\/\n-        KEYCHAR_MAP.put((char) 0x31, KeyEvent.VK_1);                 \/*49,x31*\/\n-        KEYCHAR_MAP.put((char) 0x32, KeyEvent.VK_2);                 \/*50,x32*\/\n-        KEYCHAR_MAP.put((char) 0x33, KeyEvent.VK_3);                 \/*51,x33*\/\n-        KEYCHAR_MAP.put((char) 0x34, KeyEvent.VK_4);                 \/*52,x34*\/\n-        KEYCHAR_MAP.put((char) 0x35, KeyEvent.VK_5);                 \/*53,x35*\/\n-        KEYCHAR_MAP.put((char) 0x36, KeyEvent.VK_6);                 \/*54,x36*\/\n-        KEYCHAR_MAP.put((char) 0x37, KeyEvent.VK_7);                 \/*55,x37*\/\n-        KEYCHAR_MAP.put((char) 0x38, KeyEvent.VK_8);                 \/*56,x38*\/\n-        KEYCHAR_MAP.put((char) 0x39, KeyEvent.VK_9);                 \/*57,x39*\/\n-        KEYCHAR_MAP.put((char) 0x3a, KeyEvent.VK_COLON);             \/*58,x3a*\/ \/*':', fr*\/\n-        KEYCHAR_MAP.put((char) 0x3b, KeyEvent.VK_SEMICOLON);         \/*59,x3b*\/ \/*';'*\/\n-        KEYCHAR_MAP.put((char) 0x3c, KeyEvent.VK_LESS);              \/*60,x3c*\/ \/*'<' us 102*\/\n-        KEYCHAR_MAP.put((char) 0x3d, KeyEvent.VK_EQUALS);            \/*61,x3d*\/\n-        KEYCHAR_MAP.put((char) 0x3e, KeyEvent.VK_GREATER);           \/*62,x3e*\/ \/*'>' ?????? where???*\/\n-        \/\/ Javadoc says: \"there is no keycode for the question mark because\n-        \/\/ there is no keyboard for which it appears on the primary layer.\"\n-        \/\/ Well, it's Lithuanian standard.\n-        \/\/keycharHash.put('?', (char)0x3f);                          \/*63,x3f*\/ \/*no VK, cannot test*\/\n-        KEYCHAR_MAP.put((char) 0x40, KeyEvent.VK_AT);                \/*64,x40*\/ \/*'@' ?????? where???*\/\n-        KEYCHAR_MAP.put((char) 0x1, KeyEvent.VK_A);                  \/*65,x41*\/\n-        KEYCHAR_MAP.put((char) 0x2, KeyEvent.VK_B);                  \/*66,x42*\/\n-        KEYCHAR_MAP.put((char) 0x3, KeyEvent.VK_C);                  \/*67,x43*\/\n-        KEYCHAR_MAP.put((char) 0x4, KeyEvent.VK_D);                  \/*68,x44*\/\n-        KEYCHAR_MAP.put((char) 0x5, KeyEvent.VK_E);                  \/*69,x45*\/\n-        KEYCHAR_MAP.put((char) 0x6, KeyEvent.VK_F);                  \/*70,x46*\/\n-        KEYCHAR_MAP.put((char) 0x7, KeyEvent.VK_G);                  \/*71,x47*\/\n-        KEYCHAR_MAP.put((char) 0x8, KeyEvent.VK_H);                  \/*72,x48*\/\n-        KEYCHAR_MAP.put((char) 0x9, KeyEvent.VK_I);                  \/*73,x49*\/\n-        KEYCHAR_MAP.put((char) 0xa, KeyEvent.VK_J);                  \/*74,x4a*\/\n-        KEYCHAR_MAP.put((char) 0xb, KeyEvent.VK_K);                  \/*75,x4b*\/\n-        KEYCHAR_MAP.put((char) 0xc, KeyEvent.VK_L);                  \/*76,x4c*\/\n-        KEYCHAR_MAP.put((char) 0xd, KeyEvent.VK_M);                  \/*77,x4d*\/\n-        KEYCHAR_MAP.put((char) 0xe, KeyEvent.VK_N);                  \/*78,x4e*\/\n-        KEYCHAR_MAP.put((char) 0xf, KeyEvent.VK_O);                  \/*79,x4f*\/\n-        KEYCHAR_MAP.put((char) 0x10, KeyEvent.VK_P);                 \/*80,x50*\/\n-        KEYCHAR_MAP.put((char) 0x11, KeyEvent.VK_Q);                 \/*81,x51*\/\n-        KEYCHAR_MAP.put((char) 0x12, KeyEvent.VK_R);                 \/*82,x52*\/\n-        KEYCHAR_MAP.put((char) 0x13, KeyEvent.VK_S);                 \/*83,x53*\/\n-        KEYCHAR_MAP.put((char) 0x14, KeyEvent.VK_T);                 \/*84,x54*\/\n-        KEYCHAR_MAP.put((char) 0x15, KeyEvent.VK_U);                 \/*85,x55*\/\n-        KEYCHAR_MAP.put((char) 0x16, KeyEvent.VK_V);                 \/*86,x56*\/\n-        KEYCHAR_MAP.put((char) 0x17, KeyEvent.VK_W);                 \/*87,x57*\/\n-        KEYCHAR_MAP.put((char) 0x18, KeyEvent.VK_X);                 \/*88,x58*\/\n-        KEYCHAR_MAP.put((char) 0x19, KeyEvent.VK_Y);                 \/*89,x59*\/\n-        KEYCHAR_MAP.put((char) 0x1a, KeyEvent.VK_Z);                 \/*90,x5a*\/\n-\n-        KEYCHAR_MAP.put((char) 0x1b, KeyEvent.VK_OPEN_BRACKET);      \/*91,x5b*\/ \/*'['*\/\n-        KEYCHAR_MAP.put((char) 0x1c, KeyEvent.VK_BACK_SLASH);        \/*92,x5c*\/ \/*'\\'*\/\n-        KEYCHAR_MAP.put((char) 0x1d, KeyEvent.VK_CLOSE_BRACKET);     \/*93,x5d*\/ \/*']'*\/\n-        KEYCHAR_MAP.put((char) 0x5e, KeyEvent.VK_CIRCUMFLEX);        \/*94,x5e*\/  \/*'^' ?? nodead fr, de??*\/\n-        KEYCHAR_MAP.put((char) 0x1f, KeyEvent.VK_UNDERSCORE);        \/*95,x5f*\/  \/*'_' fr*\/\n-        KEYCHAR_MAP.put((char) 0x60, KeyEvent.VK_BACK_QUOTE);        \/*96,x60*\/\n+    static void fillHash( boolean isMSWindows ) {\n+        keycharHash.put(    (char)0x20         , KeyEvent.VK_SPACE        );                      \/*32,x20*\/ \/*' ' *\/\n+        keycharHash.put(    (char)0x21         , KeyEvent.VK_EXCLAMATION_MARK        );           \/*33,x21*\/ \/*'!' fr*\/\n+        keycharHash.put(    (char)0x22         , KeyEvent.VK_QUOTEDBL        );                   \/*34,x22*\/ \/*'\"' fr*\/\n+        keycharHash.put(    (char)0x23         , KeyEvent.VK_NUMBER_SIGN        );                \/*35,x23*\/ \/*'#' de*\/\n+        keycharHash.put(    (char)0x24         , KeyEvent.VK_DOLLAR        );                      \/*36,x24*\/ \/*'$', de_CH*\/\n+        \/\/keycharHash.put('%',                                  (char)0x25        );                                  \/*37,x25*\/ \/*no VK, cannot test*\/\n+        keycharHash.put(    (char)0x26    , KeyEvent.VK_AMPERSAND        );                  \/*38,x26*\/ \/*'&', fr*\/\n+        keycharHash.put(    (char)0x27    , KeyEvent.VK_QUOTE        );                      \/*39,x27*\/ \/*''', fr*\/\n+        keycharHash.put(    (char)0x28    , KeyEvent.VK_LEFT_PARENTHESIS        );           \/*40,x28*\/ \/*'(', fr*\/\n+        keycharHash.put(    (char)0x29    , KeyEvent.VK_RIGHT_PARENTHESIS        );           \/*41,x29*\/ \/*')', fr*\/\n+        keycharHash.put(    (char)0x2a    , KeyEvent.VK_ASTERISK        );                    \/*42,x2a*\/ \/*'*', fr*\/\n+        keycharHash.put(    (char)0x2b    , KeyEvent.VK_PLUS        );                        \/*43,x2b*\/ \/*'+', de*\/\n+        keycharHash.put(    (char)0x2c    , KeyEvent.VK_COMMA        );                       \/*44,x2c*\/  \/*','*\/\n+        keycharHash.put(    (char)0x2d    , KeyEvent.VK_MINUS        );                       \/*45,x2d*\/ \/*'-'*\/\n+        keycharHash.put(    (char)0x2e    , KeyEvent.VK_PERIOD        );                      \/*46,x2e*\/ \/*'.'*\/\n+        keycharHash.put(    (char)0x2f    , KeyEvent.VK_SLASH        );                       \/*47,x2f*\/ \/*'\/'*\/\n+        keycharHash.put(    (char)0x30    , KeyEvent.VK_0        );                           \/*48,x30*\/\n+        keycharHash.put(    (char)0x31    , KeyEvent.VK_1        );                           \/*49,x31*\/\n+        keycharHash.put(    (char)0x32    , KeyEvent.VK_2        );                           \/*50,x32*\/\n+        keycharHash.put(    (char)0x33    , KeyEvent.VK_3        );                           \/*51,x33*\/\n+        keycharHash.put(    (char)0x34    , KeyEvent.VK_4        );                           \/*52,x34*\/\n+        keycharHash.put(    (char)0x35    , KeyEvent.VK_5        );                           \/*53,x35*\/\n+        keycharHash.put(    (char)0x36    , KeyEvent.VK_6        );                           \/*54,x36*\/\n+        keycharHash.put(    (char)0x37    , KeyEvent.VK_7        );                           \/*55,x37*\/\n+        keycharHash.put(    (char)0x38    , KeyEvent.VK_8        );                           \/*56,x38*\/\n+        keycharHash.put(    (char)0x39    , KeyEvent.VK_9        );                           \/*57,x39*\/\n+        keycharHash.put(    (char)0x3a    , KeyEvent.VK_COLON        );                       \/*58,x3a*\/ \/*':', fr*\/\n+        keycharHash.put(    (char)0x3b    , KeyEvent.VK_SEMICOLON        );                   \/*59,x3b*\/ \/*';'*\/\n+        keycharHash.put(    (char)0x3c    , KeyEvent.VK_LESS        );                        \/*60,x3c*\/ \/*'<' us 102*\/\n+        keycharHash.put(    (char)0x3d    , KeyEvent.VK_EQUALS        );                      \/*61,x3d*\/\n+        keycharHash.put(    (char)0x3e    , KeyEvent.VK_GREATER        );                     \/*62,x3e*\/ \/*'>' ?????? where???*\/\n+            \/\/ Javadoc says: \"there is no keycode for the question mark because\n+            \/\/ there is no keyboard for which it appears on the primary layer.\"\n+            \/\/ Well, it's Lithuanian standard.\n+        \/\/keycharHash.put('?',                                 (char)0x3f        );                                   \/*63,x3f*\/ \/*no VK, cannot test*\/\n+        keycharHash.put(    (char)0x40   , KeyEvent.VK_AT        );                          \/*64,x40*\/ \/*'@' ?????? where???*\/\n+        keycharHash.put(    (char)0x1    , KeyEvent.VK_A        );                             \/*65,x41*\/\n+        keycharHash.put(    (char)0x2    , KeyEvent.VK_B        );                            \/*66,x42*\/\n+        keycharHash.put(    (char)0x3    , KeyEvent.VK_C        );                            \/*67,x43*\/\n+        keycharHash.put(    (char)0x4    , KeyEvent.VK_D        );                            \/*68,x44*\/\n+        keycharHash.put(    (char)0x5    , KeyEvent.VK_E        );                            \/*69,x45*\/\n+        keycharHash.put(    (char)0x6    , KeyEvent.VK_F        );                            \/*70,x46*\/\n+        keycharHash.put(    (char)0x7    , KeyEvent.VK_G        );                            \/*71,x47*\/\n+        keycharHash.put(    (char)0x8    , KeyEvent.VK_H        );                            \/*72,x48*\/\n+        keycharHash.put(    (char)0x9    , KeyEvent.VK_I        );                            \/*73,x49*\/\n+        keycharHash.put(    (char)0xa    , KeyEvent.VK_J        );                            \/*74,x4a*\/\n+        keycharHash.put(    (char)0xb    , KeyEvent.VK_K        );                            \/*75,x4b*\/\n+        keycharHash.put(    (char)0xc    , KeyEvent.VK_L        );                            \/*76,x4c*\/\n+        keycharHash.put(    (char)0xd    , KeyEvent.VK_M        );                            \/*77,x4d*\/\n+        keycharHash.put(    (char)0xe    , KeyEvent.VK_N        );                            \/*78,x4e*\/\n+        keycharHash.put(    (char)0xf    , KeyEvent.VK_O        );                            \/*79,x4f*\/\n+        keycharHash.put(    (char)0x10   , KeyEvent.VK_P        );                           \/*80,x50*\/\n+        keycharHash.put(    (char)0x11   , KeyEvent.VK_Q        );                           \/*81,x51*\/\n+        keycharHash.put(    (char)0x12   , KeyEvent.VK_R        );                           \/*82,x52*\/\n+        keycharHash.put(    (char)0x13   , KeyEvent.VK_S        );                           \/*83,x53*\/\n+        keycharHash.put(    (char)0x14   , KeyEvent.VK_T        );                           \/*84,x54*\/\n+        keycharHash.put(    (char)0x15   , KeyEvent.VK_U        );                           \/*85,x55*\/\n+        keycharHash.put(    (char)0x16   , KeyEvent.VK_V        );                           \/*86,x56*\/\n+        keycharHash.put(    (char)0x17   , KeyEvent.VK_W        );                           \/*87,x57*\/\n+        keycharHash.put(    (char)0x18   , KeyEvent.VK_X        );                           \/*88,x58*\/\n+        keycharHash.put(    (char)0x19   , KeyEvent.VK_Y        );                           \/*89,x59*\/\n+        keycharHash.put(    (char)0x1a   , KeyEvent.VK_Z        );                           \/*90,x5a*\/\n@@ -131,0 +118,6 @@\n+        keycharHash.put(    (char)0x1b   , KeyEvent.VK_OPEN_BRACKET        );             \/*91,x5b*\/ \/*'['*\/\n+        keycharHash.put(    (char)0x1c   , KeyEvent.VK_BACK_SLASH        );               \/*92,x5c*\/ \/*'\\'*\/\n+        keycharHash.put(    (char)0x1d   , KeyEvent.VK_CLOSE_BRACKET        );            \/*93,x5d*\/ \/*']'*\/\n+        keycharHash.put(    (char)0x5e   , KeyEvent.VK_CIRCUMFLEX        );               \/*94,x5e*\/  \/*'^' ?? nodead fr, de??*\/\n+        keycharHash.put(    (char)0x1f   , KeyEvent.VK_UNDERSCORE        );               \/*95,x5f*\/  \/*'_' fr*\/\n+        keycharHash.put(    (char)0x60   , KeyEvent.VK_BACK_QUOTE        );               \/*96,x60*\/\n@@ -132,26 +125,31 @@\n-        \/\/keycharHash.put((char)0x1, KeyEvent.VK_a);                 \/*97,x61*\/\n-        \/\/keycharHash.put((char)0x2, KeyEvent.VK_b);                 \/*98,x62*\/\n-        \/\/keycharHash.put((char)0x3, KeyEvent.VK_c);                 \/*99,x63*\/\n-        \/\/keycharHash.put((char)0x4, KeyEvent.VK_d);                 \/*100,x64*\/\n-        \/\/keycharHash.put((char)0x5, KeyEvent.VK_e);                 \/*101,x65*\/\n-        \/\/keycharHash.put((char)0x6, KeyEvent.VK_f);                 \/*102,x66*\/\n-        \/\/keycharHash.put((char)0x7, KeyEvent.VK_g);                 \/*103,x67*\/\n-        \/\/keycharHash.put((char)0x8, KeyEvent.VK_h);                 \/*104,x68*\/\n-        \/\/keycharHash.put((char)0x9, KeyEvent.VK_i);                 \/*105,x69*\/\n-        \/\/keycharHash.put((char)0xa, KeyEvent.VK_j);                 \/*106,x6a*\/\n-        \/\/keycharHash.put((char)0xb, KeyEvent.VK_k);                 \/*107,x6b*\/\n-        \/\/keycharHash.put((char)0xc, KeyEvent.VK_l);                 \/*108,x6c*\/\n-        \/\/keycharHash.put((char)0xd, KeyEvent.VK_m);                 \/*109,x6d*\/\n-        \/\/keycharHash.put((char)0xe, KeyEvent.VK_n);                 \/*110,x6e*\/\n-        \/\/keycharHash.put((char)0xf, KeyEvent.VK_o);                 \/*111,x6f*\/\n-        \/\/keycharHash.put((char)0x10, KeyEvent.VK_p);                \/*112,x70*\/\n-        \/\/keycharHash.put((char)0x11, KeyEvent.VK_q);                \/*113,x71*\/\n-        \/\/keycharHash.put((char)0x12, KeyEvent.VK_r);                \/*114,x72*\/\n-        \/\/keycharHash.put((char)0x13, KeyEvent.VK_s);                \/*115,x73*\/\n-        \/\/keycharHash.put((char)0x14, KeyEvent.VK_t);                \/*116,x74*\/\n-        \/\/keycharHash.put((char)0x15, KeyEvent.VK_u);                \/*117,x75*\/\n-        \/\/keycharHash.put((char)0x16, KeyEvent.VK_v);                \/*118,x76*\/\n-        \/\/keycharHash.put((char)0x17, KeyEvent.VK_w);                \/*119,x77*\/\n-        \/\/keycharHash.put((char)0x18, KeyEvent.VK_x);                \/*120,x78*\/\n-        \/\/keycharHash.put((char)0x19, KeyEvent.VK_y);                \/*121,x79*\/\n-        \/\/keycharHash.put((char)0x1a, KeyEvent.VK_z);                \/*122,x7a*\/\n+        \/\/keycharHash.put(  (char)0x1         , KeyEvent.VK_a        );\/*97,x61*\/\n+        \/\/keycharHash.put(  (char)0x2         , KeyEvent.VK_b        );\/*98,x62*\/\n+        \/\/keycharHash.put(  (char)0x3         , KeyEvent.VK_c        );\/*99,x63*\/\n+        \/\/keycharHash.put(  (char)0x4         , KeyEvent.VK_d        );\/*100,x64*\/\n+        \/\/keycharHash.put(  (char)0x5         , KeyEvent.VK_e        );\/*101,x65*\/\n+        \/\/keycharHash.put(  (char)0x6         , KeyEvent.VK_f        );\/*102,x66*\/\n+        \/\/keycharHash.put(  (char)0x7         , KeyEvent.VK_g        );\/*103,x67*\/\n+        \/\/keycharHash.put(  (char)0x8         , KeyEvent.VK_h        );\/*104,x68*\/\n+        \/\/keycharHash.put(  (char)0x9         , KeyEvent.VK_i        );\/*105,x69*\/\n+        \/\/keycharHash.put(  (char)0xa         , KeyEvent.VK_j        );\/*106,x6a*\/\n+        \/\/keycharHash.put(  (char)0xb         , KeyEvent.VK_k        );\/*107,x6b*\/\n+        \/\/keycharHash.put(  (char)0xc         , KeyEvent.VK_l        );\/*108,x6c*\/\n+        \/\/keycharHash.put(  (char)0xd         , KeyEvent.VK_m        );\/*109,x6d*\/\n+        \/\/keycharHash.put(  (char)0xe         , KeyEvent.VK_n        );\/*110,x6e*\/\n+        \/\/keycharHash.put(  (char)0xf         , KeyEvent.VK_o        );\/*111,x6f*\/\n+        \/\/keycharHash.put(  (char)0x10        , KeyEvent.VK_p        );\/*112,x70*\/\n+        \/\/keycharHash.put(  (char)0x11        , KeyEvent.VK_q        );\/*113,x71*\/\n+        \/\/keycharHash.put(  (char)0x12        , KeyEvent.VK_r        );\/*114,x72*\/\n+        \/\/keycharHash.put(  (char)0x13        , KeyEvent.VK_s        );\/*115,x73*\/\n+        \/\/keycharHash.put(  (char)0x14        , KeyEvent.VK_t        );\/*116,x74*\/\n+        \/\/keycharHash.put(  (char)0x15        , KeyEvent.VK_u        );\/*117,x75*\/\n+        \/\/keycharHash.put(  (char)0x16        , KeyEvent.VK_v        );\/*118,x76*\/\n+        \/\/keycharHash.put(  (char)0x17        , KeyEvent.VK_w        );\/*119,x77*\/\n+        \/\/keycharHash.put(  (char)0x18        , KeyEvent.VK_x        );\/*120,x78*\/\n+        \/\/keycharHash.put(  (char)0x19        , KeyEvent.VK_y        );\/*121,x79*\/\n+        \/\/keycharHash.put(  (char)0x1a        , KeyEvent.VK_z        );\/*122,x7a*\/\n+\n+        keycharHash.put(    (char)0x7b      , KeyEvent.VK_BRACELEFT        );             \/*123,x7b*\/ \/*'{' la (Latin American)*\/\n+        \/\/keycharHash.put(  (char)0x1c        , KeyEvent.VK_|        );                   \/*124,x7c*\/ \/* no VK, cannot test*\/\n+        keycharHash.put(    (char)0x7d      , KeyEvent.VK_BRACERIGHT        );            \/*125,x7d*\/ \/*'}' la *\/\n+        \/\/keycharHash.put(  (char)0x1e        , KeyEvent.VK_~        );                   \/*126,x7e*\/ \/* no VK, cannot test*\/\n@@ -159,5 +157,0 @@\n-        KEYCHAR_MAP.put((char) 0x7b, KeyEvent.VK_BRACELEFT);         \/*123,x7b*\/ \/*'{' la (Latin American)*\/\n-        \/\/keycharHash.put(char) 0x1c, KeyEvent.VK_|);                \/*124,x7c*\/ \/* no VK, cannot test*\/\n-        KEYCHAR_MAP.put((char) 0x7d, KeyEvent.VK_BRACERIGHT);        \/*125,x7d*\/ \/*'}' la *\/\n-        \/\/keycharHash.put((char) 0x1e, KeyEvent.VK_~);               \/*126,x7e*\/ \/* no VK, cannot test*\/\n-    }\n@@ -165,1 +158,2 @@\n-    public static void main(String[] args) throws AWTException {\n+    }\n+    public static void main(String[] args) {\n@@ -171,6 +165,4 @@\n-    public void init() throws AWTException {\n-        fillHash();\n-\n-        robot = new Robot();\n-        robot.setAutoWaitForIdle(true);\n-        robot.setAutoDelay(100);\n+    public void init()\n+    {\n+        fillHash( false );\n+        this.setLayout (new BorderLayout ());\n@@ -178,1 +170,1 @@\n-        setLayout(new BorderLayout());\n+    }\/\/End  init()\n@@ -180,1 +172,3 @@\n-        setSize(400, 300);\n+    public void start ()\n+    {\n+        setSize(400,300);\n@@ -190,2 +184,4 @@\n-        robot.waitForIdle();\n-        robot.delay(1000);\n+        try {\n+            robot = new Robot();\n+            robot.setAutoWaitForIdle(true);\n+            robot.setAutoDelay(100);\n@@ -193,2 +189,1 @@\n-        this.requestFocus();\n-        tf.requestFocusInWindow();\n+            robot.waitForIdle();\n@@ -196,2 +191,4 @@\n-        robot.waitForIdle();\n-    }\/\/End  init()\n+            \/\/ wait for focus, etc.  (Hack.)\n+            robot.delay(2000);\n+            this.requestFocus();\n+            tf.requestFocusInWindow();\n@@ -199,2 +196,0 @@\n-    public void start() {\n-        try {\n@@ -202,6 +197,5 @@\n-            robot.mouseMove(pt.x + 100, pt.y + 100);\n-            robot.delay(1000);\n-            robot.mousePress(InputEvent.BUTTON1_DOWN_MASK);\n-            robot.mouseRelease(InputEvent.BUTTON1_DOWN_MASK);\n-\n-            KEYCHAR_MAP.forEach((k, v) -> punchCtrlKey(v));\n+            robot.mouseMove( pt.x+100, pt.y+100 );\n+            robot.delay(2000);\n+            robot.mousePress( InputEvent.BUTTON1_MASK );\n+            robot.mouseRelease( InputEvent.BUTTON1_MASK );\n+            Enumeration<Integer> enuElem = keycharHash.elements();\n@@ -209,0 +203,5 @@\n+            int kc;\n+            while( enuElem.hasMoreElements()) {\n+                kc = enuElem.nextElement();\n+                punchCtrlKey( robot, kc );\n+            }\n@@ -212,2 +211,0 @@\n-        } finally {\n-            dispose();\n@@ -215,1 +212,1 @@\n-        if (testFailed) {\n+        if( testFailed ) {\n@@ -221,2 +218,2 @@\n-\n-    public void punchCtrlKey(int keyCode) {\n+    public void punchCtrlKey( Robot ro, int keyCode ) {\n+        ro.keyPress(KeyEvent.VK_CONTROL);\n@@ -224,11 +221,4 @@\n-            robot.keyPress(KeyEvent.VK_CONTROL);\n-            robot.keyPress(keyCode);\n-        } catch (IllegalArgumentException iae) {\n-            System.err.println(\"skip probably invalid keyCode \" + keyCode);\n-        } finally {\n-            try {\n-                robot.keyRelease(keyCode);\n-            } catch (IllegalArgumentException iae) {\n-                System.err.println(\"skip probably invalid keyCode \" + keyCode);\n-            }\n-            robot.keyRelease(KeyEvent.VK_CONTROL);\n+            ro.keyPress(keyCode);\n+            ro.keyRelease(keyCode);\n+        }catch(IllegalArgumentException iae) {\n+            System.err.println(\"skip probably invalid keyCode \"+keyCode);\n@@ -236,1 +226,2 @@\n-        robot.delay(200);\n+        ro.keyRelease(KeyEvent.VK_CONTROL);\n+        ro.delay(200);\n@@ -238,2 +229,2 @@\n-\n-    public void keyPressed(KeyEvent evt) {\n+    public void keyPressed(KeyEvent evt)\n+    {\n@@ -243,1 +234,2 @@\n-    public void keyTyped(KeyEvent evt) {\n+    public void keyTyped(KeyEvent evt)\n+    {\n@@ -246,2 +238,3 @@\n-        if (!KEYCHAR_MAP.containsKey(keych)) {\n-            System.out.println(\"Unexpected keychar: \" + keych);\n+        if( !keycharHash.containsKey( keych ) ) {\n+            System.out.println(\"Unexpected keychar: \"+keych);\n+            System.out.println(\"Unexpected keychar: \"+keych);\n@@ -252,1 +245,2 @@\n-    public void keyReleased(KeyEvent evt) {\n+    public void keyReleased(KeyEvent evt)\n+    {\n@@ -256,9 +250,12 @@\n-    protected void printKey(KeyEvent evt) {\n-        switch (evt.getID()) {\n-            case KeyEvent.KEY_TYPED:\n-            case KeyEvent.KEY_PRESSED:\n-            case KeyEvent.KEY_RELEASED:\n-                break;\n-            default:\n-                System.out.println(\"Other Event \");\n-                return;\n+    protected void printKey(KeyEvent evt)\n+    {\n+        switch(evt.getID())\n+        {\n+          case KeyEvent.KEY_TYPED:\n+          case KeyEvent.KEY_PRESSED:\n+          case KeyEvent.KEY_RELEASED:\n+            break;\n+          default:\n+            System.out.println(\"Other Event \");\n+            System.out.println(\"Other Event \");\n+            return;\n@@ -266,1 +263,2 @@\n-        System.out.println(\" 0x\" + Integer.toHexString(evt.getKeyChar()));\n+        System.out.print(\" 0x\"+ Integer.toHexString(evt.getKeyChar()));\n+        System.out.println    (\" 0x\"+ Integer.toHexString(evt.getKeyChar()));\n","filename":"test\/jdk\/java\/awt\/event\/KeyEvent\/KeyTyped\/CtrlASCII.java","additions":172,"deletions":174,"binary":false,"changes":346,"status":"modified"},{"patch":"@@ -60,1 +60,1 @@\n-    private static final Pattern DF_PATTERN = Pattern.compile(\"([^\\\\s]+)\\\\s+(\\\\d+)\\\\s+(\\\\d+)\\\\s+(\\\\d+)\\\\s+\\\\d+%\\\\s+([^\\\\s].*)\\n\");\n+    private static final Pattern DF_PATTERN = Pattern.compile(\"([^\\\\s]+)\\\\s+(\\\\d+)\\\\s+\\\\d+\\\\s+(\\\\d+)\\\\s+\\\\d+%\\\\s+([^\\\\s].*)\\n\");\n@@ -106,2 +106,1 @@\n-        private final long used;\n-        private final long available;\n+        private final long free;\n@@ -109,2 +108,1 @@\n-        Space(String name, String total, String used, String available) {\n-            this.name = name;\n+        Space(String total, String free, String name) {\n@@ -113,2 +111,1 @@\n-                this.used = Long.parseLong(used) * KSIZE;\n-                this.available = Long.parseLong(available) * KSIZE;\n+                this.free = Long.parseLong(free) * KSIZE;\n@@ -118,0 +115,1 @@\n+            this.name = name;\n@@ -122,3 +120,1 @@\n-        long used() { return used; }\n-        long available() { return available; }\n-        long free() { return total - used; }\n+        long free() { return free; }\n@@ -126,2 +122,1 @@\n-            return ((freeSpace >= (available \/ 10)) &&\n-                    (freeSpace <= (available * 10)));\n+            return ((freeSpace >= (free \/ 10)) && (freeSpace <= (free * 10)));\n@@ -130,1 +125,1 @@\n-            return String.format(\"%s (%d\/%d\/%d)\", name, total, used, available);\n+            return String.format(\"%s (%d\/%d)\", name, free, total);\n@@ -134,18 +129,0 @@\n-    private static void diskFree() throws IOException {\n-        ArrayList<Space> al = new ArrayList<>();\n-\n-        String cmd = \"fsutil volume diskFree C:\\\\\";\n-        StringBuilder sb = new StringBuilder();\n-        Process p = Runtime.getRuntime().exec(cmd);\n-        try (BufferedReader in = p.inputReader()) {\n-            String s;\n-            int i = 0;\n-            while ((s = in.readLine()) != null) {\n-                \/\/ skip header\n-                if (i++ == 0) continue;\n-                sb.append(s).append(\"\\n\");\n-            }\n-        }\n-        out.println(sb);\n-    }\n-\n@@ -178,1 +155,1 @@\n-                        name = Platform.isWindows() ? m.group(1) : m.group(5);\n+                        name = Platform.isWindows() ? m.group(1) : m.group(4);\n@@ -180,1 +157,1 @@\n-                    al.add(new Space(name, m.group(2), m.group(3), m.group(4)));\n+                    al.add(new Space(m.group(2), m.group(3), name));\n@@ -193,1 +170,1 @@\n-            al.add(new Space(name, \"0\", \"0\", \"0\"));\n+            al.add(new Space(\"0\", \"0\", name));\n@@ -235,2 +212,2 @@\n-        String fmt = \"  %-4s total = %12d free = %12d usable = %12d%n\";\n-        out.format(fmt, \"df\", s.total(), s.free(), s.available());\n+        String fmt = \"  %-4s total= %12d free = %12d usable = %12d%n\";\n+        out.format(fmt, \"df\", s.total(), 0, s.free());\n@@ -262,16 +239,3 @@\n-            if (!Platform.isOSX() || blockSize != 512 || numBlocks % 2 == 0 ||\n-                ts - s.total() != 512) {\n-                if (Platform.isWindows()) {\n-                    \/\/\n-                    \/\/ In Cygwin, 'df' has been observed to account for quotas\n-                    \/\/ when reporting the total disk size, but the total size\n-                    \/\/ reported by GetDiskFreeSpaceExW() has been observed not\n-                    \/\/ to account for the quota in which case the latter value\n-                    \/\/ should be larger.\n-                    \/\/\n-                    if (s.total() > ts) {\n-                        fail(s.name() + \" total space\", s.total(), \">\", ts);\n-                    }\n-                } else {\n-                    fail(s.name() + \" total space\", s.total(), \"!=\", ts);\n-                }\n+            if (!Platform.isOSX() || blockSize != 512 || numBlocks % 2 == 0\n+                || ts - s.total() != 512) {\n+                fail(s.name(), s.total(), \"!=\", ts);\n@@ -286,1 +250,1 @@\n-            fail(s.name(), s.available(), \"??\", tsp);\n+            fail(s.name(), s.free(), \"??\", tsp);\n@@ -419,3 +383,0 @@\n-            if (Platform.isWindows()) {\n-                diskFree();\n-            }\n","filename":"test\/jdk\/java\/io\/File\/GetXSpace.java","additions":17,"deletions":56,"binary":false,"changes":73,"status":"modified"},{"patch":"@@ -1,115 +0,0 @@\n-\/*\n- * Copyright (c) 2022, Oracle and\/or its affiliates. All rights reserved.\n- * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n- *\n- * This code is free software; you can redistribute it and\/or modify it\n- * under the terms of the GNU General Public License version 2 only, as\n- * published by the Free Software Foundation.\n- *\n- * This code is distributed in the hope that it will be useful, but WITHOUT\n- * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n- * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n- * version 2 for more details (a copy is included in the LICENSE file that\n- * accompanied this code).\n- *\n- * You should have received a copy of the GNU General Public License version\n- * 2 along with this work; if not, write to the Free Software Foundation,\n- * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n- *\n- * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n- * or visit www.oracle.com if you need additional information or have any\n- * questions.\n- *\/\n-\n-\/* @test\n- * @bug 8290313\n- * @library \/test\/lib\n- * @summary Produce warning when user specified java.io.tmpdir directory doesn't exist\n- *\/\n-\n-import jdk.test.lib.process.ProcessTools;\n-import jdk.test.lib.process.OutputAnalyzer;\n-\n-import java.io.File;\n-import java.nio.file.Files;\n-import java.nio.file.Path;\n-import java.util.List;\n-import java.util.stream.Collectors;\n-\n-public class TempDirDoesNotExist {\n-    final static String ioWarningMsg = \"WARNING: java.io.tmpdir directory does not exist\";\n-\n-    public static void main(String... args) throws Exception {\n-\n-        String userDir = System.getProperty(\"user.home\");\n-        String timeStamp = java.time.Instant.now().toString();\n-        String tempDir = Path.of(userDir,\"non-existing-\", timeStamp).toString();\n-\n-        for (String arg : args) {\n-            if (arg.equals(\"io\")) {\n-                try {\n-                    File.createTempFile(\"prefix\", \".suffix\");\n-                } catch (Exception e) {\n-                    e.printStackTrace();\n-                }\n-            } else if (arg.equals(\"nio\")) {\n-                try {\n-                    Files.createTempFile(\"prefix\", \".suffix\");\n-                } catch (Exception e) {\n-                    e.printStackTrace();\n-                }\n-            } else {\n-                throw new Exception(\"unknown case: \" + arg);\n-            }\n-        }\n-\n-        if (args.length == 0) {\n-            \/\/ standard test with default setting for java.io.tmpdir\n-            testMessageNotExist(0, ioWarningMsg, \"TempDirDoesNotExist\", \"io\");\n-            testMessageNotExist(0, ioWarningMsg, \"TempDirDoesNotExist\", \"nio\");\n-\n-            \/\/ valid custom java.io.tmpdir\n-            testMessageNotExist(0, ioWarningMsg, \"-Djava.io.tmpdir=\" + userDir,\n-                    \"TempDirDoesNotExist\", \"io\");\n-            testMessageNotExist(0, ioWarningMsg, \"-Djava.io.tmpdir=\" + userDir,\n-                    \"TempDirDoesNotExist\", \"nio\");\n-\n-            \/\/ invalid custom java.io.tmpdir\n-            testMessageExist(0, ioWarningMsg, \"-Djava.io.tmpdir=\" + tempDir,\n-                    \"TempDirDoesNotExist\", \"io\");\n-            testMessageExist(0, ioWarningMsg, \"-Djava.io.tmpdir=\" + tempDir,\n-                    \"TempDirDoesNotExist\", \"nio\");\n-\n-            \/\/ test with security manager\n-            testMessageExist(0, ioWarningMsg, \"-Djava.io.tmpdir=\" + tempDir\n-                            + \" -Djava.security.manager\",\n-                    \"TempDirDoesNotExist\", \"io\");\n-\n-            testMessageExist(0, ioWarningMsg, \"-Djava.io.tmpdir=\" + tempDir\n-                            + \" -Djava.security.manager\",\n-                    \"TempDirDoesNotExist\", \"nio\");\n-\n-            \/\/ error message printed only once\n-            testMessageCounter(0, \"-Djava.io.tmpdir=\" + tempDir,\n-                    \"TempDirDoesNotExist\", \"io\", \"nio\");\n-        }\n-    }\n-\n-    private static void testMessageExist(int exitValue, String errorMsg, String... options) throws Exception {\n-        ProcessTools.executeTestJvm(options).shouldContain(errorMsg)\n-                .shouldHaveExitValue(exitValue);\n-    }\n-\n-    private static void testMessageNotExist(int exitValue, String errorMsg,String... options) throws Exception {\n-        ProcessTools.executeTestJvm(options).shouldNotContain(errorMsg).shouldHaveExitValue(exitValue);\n-    }\n-\n-    private static void testMessageCounter(int exitValue,String... options) throws Exception {\n-        OutputAnalyzer originalOutput = ProcessTools.executeTestJvm(options);\n-        List<String> list = originalOutput.asLines().stream().filter(line\n-                -> line.equalsIgnoreCase(ioWarningMsg)).collect(Collectors.toList());\n-        if (list.size() != 1 || originalOutput.getExitValue() != exitValue)\n-            throw new Exception(\"counter of messages is not one, but \" + list.size()\n-                    + \"\\n\" + originalOutput.asLines().toString() + \"\\n\");\n-    }\n-}\n\\ No newline at end of file\n","filename":"test\/jdk\/java\/io\/File\/TempDirDoesNotExist.java","additions":0,"deletions":115,"binary":false,"changes":115,"status":"deleted"},{"patch":"@@ -1,209 +0,0 @@\n-\/*\n- * Copyright (c) 2022, Oracle and\/or its affiliates. All rights reserved.\n- * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n- *\n- * This code is free software; you can redistribute it and\/or modify it\n- * under the terms of the GNU General Public License version 2 only, as\n- * published by the Free Software Foundation.\n- *\n- * This code is distributed in the hope that it will be useful, but WITHOUT\n- * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n- * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n- * version 2 for more details (a copy is included in the LICENSE file that\n- * accompanied this code).\n- *\n- * You should have received a copy of the GNU General Public License version\n- * 2 along with this work; if not, write to the Free Software Foundation,\n- * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n- *\n- * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n- * or visit www.oracle.com if you need additional information or have any\n- * questions.\n- *\/\n-\n-import java.io.ByteArrayInputStream;\n-import java.io.ByteArrayOutputStream;\n-import java.io.InputStream;\n-import java.io.OutputStream;\n-import java.io.PushbackInputStream;\n-import java.util.Arrays;\n-import java.util.Random;\n-import java.util.concurrent.atomic.AtomicReference;\n-import java.util.function.Consumer;\n-import java.util.function.Supplier;\n-\n-import org.testng.annotations.Test;\n-\n-import jdk.test.lib.RandomFactory;\n-\n-import static java.lang.String.format;\n-\n-import static org.testng.Assert.assertEquals;\n-import static org.testng.Assert.assertThrows;\n-import static org.testng.Assert.assertTrue;\n-\n-\/*\n- * @test\n- * @library \/test\/lib\n- * @build jdk.test.lib.RandomFactory\n- * @run testng\/othervm\/timeout=180 TransferTo\n- * @bug 8296431\n- * @summary Tests whether java.io.PushbackInputStream.transferTo conforms to the\n- *          InputStream.transferTo specification\n- * @key randomness\n- *\/\n-public class TransferTo {\n-    private static final int MIN_SIZE      = 10_000;\n-    private static final int MAX_SIZE_INCR = 100_000_000 - MIN_SIZE;\n-\n-    private static final int ITERATIONS = 10;\n-\n-    private static final Random RND = RandomFactory.getRandom();\n-\n-    \/*\n-     * Testing API compliance: input stream must throw NullPointerException\n-     * when parameter \"out\" is null.\n-     *\/\n-    @Test\n-    public void testNullPointerException() throws Exception {\n-        \/\/ factory for incoming data provider\n-        InputStreamProvider inputStreamProvider = byteArrayInput();\n-\n-        \/\/ tests empty input stream\n-        assertThrows(NullPointerException.class,\n-                () -> inputStreamProvider.input().transferTo(null));\n-\n-        \/\/ tests single-byte input stream\n-        assertThrows(NullPointerException.class,\n-                () -> inputStreamProvider.input((byte) 1).transferTo(null));\n-\n-        \/\/ tests dual-byte input stream\n-        assertThrows(NullPointerException.class,\n-                () -> inputStreamProvider.input((byte) 1, (byte) 2).transferTo(null));\n-    }\n-\n-    \/*\n-     * Testing API compliance: complete content of input stream must be\n-     * transferred to output stream.\n-     *\/\n-    @Test\n-    public void testStreamContents() throws Exception {\n-        \/\/ factory for incoming data provider\n-        InputStreamProvider inputStreamProvider = byteArrayInput();\n-\n-        \/\/ factory for outgoing data recorder\n-        OutputStreamProvider outputStreamProvider = byteArrayOutput();\n-\n-        \/\/ tests empty input stream\n-        checkTransferredContents(inputStreamProvider,\n-                outputStreamProvider, new byte[0]);\n-\n-        \/\/ tests input stream with a length between 1k and 4k\n-        checkTransferredContents(inputStreamProvider,\n-                outputStreamProvider, createRandomBytes(1024, 4096));\n-\n-        \/\/ tests input stream with several data chunks, as 16k is more than a\n-        \/\/ single chunk can hold\n-        checkTransferredContents(inputStreamProvider,\n-                outputStreamProvider, createRandomBytes(16384, 16384));\n-\n-        \/\/ tests randomly chosen starting positions within source and\n-        \/\/ target stream and random pushback\n-        for (int i = 0; i < ITERATIONS; i++) {\n-            byte[] inBytes = createRandomBytes(MIN_SIZE, MAX_SIZE_INCR);\n-            int posIn = RND.nextInt(inBytes.length);\n-            int posOut = RND.nextInt(MIN_SIZE);\n-            checkTransferredContents(inputStreamProvider,\n-                    outputStreamProvider, inBytes, posIn, posOut, 1);\n-        }\n-\n-        \/\/ tests reading beyond source EOF (must not transfer any bytes)\n-        checkTransferredContents(inputStreamProvider,\n-                outputStreamProvider, createRandomBytes(4096, 0), 4096, 0, 0);\n-\n-        \/\/ tests writing beyond target EOF (must extend output stream)\n-        checkTransferredContents(inputStreamProvider,\n-                outputStreamProvider, createRandomBytes(4096, 0), 0, 4096, 0);\n-    }\n-\n-    \/*\n-     * Asserts that the transferred content is correct, i.e., compares the bytes\n-     * actually transferred to those expected. The position of the input and\n-     * output streams before the transfer are zero (BOF), and no pushback occurs.\n-     *\/\n-    private static void checkTransferredContents(InputStreamProvider inputStreamProvider,\n-            OutputStreamProvider outputStreamProvider, byte[] inBytes) throws Exception {\n-        checkTransferredContents(inputStreamProvider,\n-                outputStreamProvider, inBytes, 0, 0, 0);\n-    }\n-\n-    \/*\n-     * Asserts that the transferred content is correct, i. e. compares the bytes\n-     * actually transferred to those expected. The positions of the input and\n-     * output streams before the transfer are provided by the caller.\n-     *\/\n-    private static void checkTransferredContents(InputStreamProvider inputStreamProvider,\n-            OutputStreamProvider outputStreamProvider, byte[] inBytes, int posIn,\n-            int posOut, int pushBackBytes) throws Exception {\n-        AtomicReference<Supplier<byte[]>> recorder = new AtomicReference<>();\n-        try (InputStream in = inputStreamProvider.input(inBytes);\n-            OutputStream out = outputStreamProvider.output(recorder::set)) {\n-            \/\/ skip bytes until starting position\n-            in.skipNBytes(posIn);\n-            out.write(new byte[posOut]);\n-\n-            \/\/ pushback\n-            if (in instanceof PushbackInputStream pis) {\n-                byte[] bytes = new byte[pushBackBytes];\n-                int read = pis.read(bytes);\n-                pis.unread(bytes, 0, read);\n-            }\n-\n-            long reported = in.transferTo(out);\n-            int count = inBytes.length - posIn;\n-\n-            assertEquals(reported, count,\n-                    format(\"reported %d bytes but should report %d\", reported, count));\n-\n-            byte[] outBytes = recorder.get().get();\n-            assertTrue(Arrays.equals(inBytes, posIn, posIn + count,\n-                    outBytes, posOut, posOut + count),\n-                    format(\"inBytes.length=%d, outBytes.length=%d\", count, outBytes.length));\n-        }\n-    }\n-\n-    \/*\n-     * Creates an array of random size (between min and min + maxRandomAdditive)\n-     * filled with random bytes\n-     *\/\n-    private static byte[] createRandomBytes(int min, int maxRandomAdditive) {\n-        byte[] bytes = new byte[min +\n-                                (maxRandomAdditive == 0 ? 0 : RND.nextInt(maxRandomAdditive))];\n-        RND.nextBytes(bytes);\n-        return bytes;\n-    }\n-\n-    private interface InputStreamProvider {\n-        InputStream input(byte... bytes) throws Exception;\n-    }\n-\n-    private interface OutputStreamProvider {\n-        OutputStream output(Consumer<Supplier<byte[]>> spy) throws Exception;\n-    }\n-\n-    private static InputStreamProvider byteArrayInput() {\n-        return bytes -> new PushbackInputStream(new ByteArrayInputStream(bytes));\n-    }\n-\n-    private static OutputStreamProvider byteArrayOutput() {\n-        return new OutputStreamProvider() {\n-            @Override\n-            public OutputStream output(Consumer<Supplier<byte[]>> spy) {\n-                ByteArrayOutputStream outputStream = new ByteArrayOutputStream();\n-                spy.accept(outputStream::toByteArray);\n-                return outputStream;\n-            }\n-        };\n-    }\n-\n-}\n","filename":"test\/jdk\/java\/io\/PushbackInputStream\/TransferTo.java","additions":0,"deletions":209,"binary":false,"changes":209,"status":"deleted"},{"patch":"@@ -1,136 +0,0 @@\n-\/*\n- * Copyright (c) 2022, Oracle and\/or its affiliates. All rights reserved.\n- * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n- *\n- * This code is free software; you can redistribute it and\/or modify it\n- * under the terms of the GNU General Public License version 2 only, as\n- * published by the Free Software Foundation.\n- *\n- * This code is distributed in the hope that it will be useful, but WITHOUT\n- * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n- * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n- * version 2 for more details (a copy is included in the LICENSE file that\n- * accompanied this code).\n- *\n- * You should have received a copy of the GNU General Public License version\n- * 2 along with this work; if not, write to the Free Software Foundation,\n- * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n- *\n- * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n- * or visit www.oracle.com if you need additional information or have any\n- * questions.\n- *\/\n-\n-import java.lang.reflect.Modifier;\n-import java.lang.annotation.*;\n-\n-\/*\n- * @test\n- * @bug 8296743\n- * @summary Verify array classes and primitives have expected modifiers\n- *\/\n-@ExpectedModifiers(Modifier.PUBLIC | Modifier.FINAL | Modifier.ABSTRACT)\n-public class TestPrimitiveAndArrayModifiers {\n-\n-    \/*\n-     * Relevant excerpt of the Class.getModifiers() specification:\n-     * <p> If the underlying class is an array class:\n-     * <ul>\n-     * <li> its {@code public}, {@code private} and {@code protected}\n-     *      modifiers are the same as those of its component type\n-     * <li> its {@code final} and {@code abstract} modifiers are always\n-     *      {@code true}\n-     * <li> its interface modifier is always {@code false}, even when\n-     *      the component type is an interface\n-     * <\/ul>\n-     *\/\n-\n-    public static void main(String... args) throws Exception {\n-        testPrimitives();\n-        testArrays();\n-    }\n-\n-    private static void testArrays() {\n-        Class<?>[] testCases = {\n-            TestPrimitiveAndArrayModifiers.class,\n-\n-            PackagePrivateClass.class,\n-            ProtectedClass.class,\n-            PrivateClass.class,\n-\n-            PublicInterface.class,\n-            PackagePrivateInterface.class,\n-            ProtectedInterface.class,\n-            PrivateInterface.class,\n-        };\n-\n-        for(var testCase : testCases) {\n-            int expectedModifiers =\n-                testCase.getAnnotation(ExpectedModifiers.class).value();\n-            Class<?> arrayClass = testCase.arrayType();\n-            int actualModifiers = arrayClass.getModifiers();\n-            if (expectedModifiers != actualModifiers) {\n-                throw new RuntimeException(\"Expected \" + Modifier.toString(expectedModifiers) +\n-                                           \"on \" + testCase.getCanonicalName() +\n-                                           \", but got \" + Modifier.toString(actualModifiers));\n-            }\n-        }\n-    }\n-\n-    @ExpectedModifiers(Modifier.FINAL | Modifier.ABSTRACT)\n-    class PackagePrivateClass {}\n-\n-    @ExpectedModifiers(Modifier.FINAL | Modifier.ABSTRACT | Modifier.PROTECTED)\n-    protected class ProtectedClass {}\n-\n-    @ExpectedModifiers(Modifier.FINAL | Modifier.ABSTRACT | Modifier.PRIVATE)\n-    private class  PrivateClass {}\n-\n-    @ExpectedModifiers(Modifier.FINAL | Modifier.ABSTRACT | Modifier.PUBLIC)\n-    public interface PublicInterface {}\n-\n-    @ExpectedModifiers(Modifier.FINAL | Modifier.ABSTRACT)\n-    interface PackagePrivateInterface {}\n-\n-    @ExpectedModifiers(Modifier.FINAL | Modifier.ABSTRACT | Modifier.PROTECTED)\n-    protected interface ProtectedInterface {}\n-\n-    @ExpectedModifiers(Modifier.FINAL | Modifier.ABSTRACT | Modifier.PRIVATE)\n-    private interface PrivateInterface {}\n-\n-    \/*\n-     * Relevant excerpt of the Class.getModifiers() specification:\n-     *\n-     * If this {@code Class} object represents a primitive type or\n-     * void, its {@code public}, {@code abstract}, and {@code final}\n-     * modifiers are always {@code true}.\n-     *\/\n-    private static void testPrimitives() {\n-        Class<?>[] testCases = {\n-            void.class,\n-            boolean.class,\n-            byte.class,\n-            short.class,\n-            char.class,\n-            int.class,\n-            float.class,\n-            long.class,\n-            double.class,\n-        };\n-\n-        for(var testCase : testCases) {\n-            int actualModifiers = testCase.getModifiers();\n-            if ((Modifier.PUBLIC | Modifier.ABSTRACT | Modifier.FINAL) !=\n-                actualModifiers) {\n-                throw new RuntimeException(\"Bad modifiers \" +\n-                                           Modifier.toString(actualModifiers) +\n-                                           \" on primitive type \" + testCase);\n-            }\n-        }\n-    }\n-}\n-\n-@Retention(RetentionPolicy.RUNTIME)\n-@interface ExpectedModifiers {\n-    int value() default 0;\n-}\n","filename":"test\/jdk\/java\/lang\/Class\/getModifiers\/TestPrimitiveAndArrayModifiers.java","additions":0,"deletions":136,"binary":false,"changes":136,"status":"deleted"},{"patch":"@@ -1,45 +0,0 @@\n-\/*\n- * Copyright (c) 2022, Oracle and\/or its affiliates. All rights reserved.\n- * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n- *\n- * This code is free software; you can redistribute it and\/or modify it\n- * under the terms of the GNU General Public License version 2 only, as\n- * published by the Free Software Foundation.\n- *\n- * This code is distributed in the hope that it will be useful, but WITHOUT\n- * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n- * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n- * version 2 for more details (a copy is included in the LICENSE file that\n- * accompanied this code).\n- *\n- * You should have received a copy of the GNU General Public License version\n- * 2 along with this work; if not, write to the Free Software Foundation,\n- * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n- *\n- * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n- * or visit www.oracle.com if you need additional information or have any\n- * questions.\n- *\/\n-\n-\/*\n- * @test\n- * @summary Verify that when a child returns exit value 259, Process.waitFor does not throw\n- * @bug 8294899\n- * @requires (os.family == \"windows\")\n- * @run junit WindowsExitValue\n- *\/\n-\n-import java.io.IOException;\n-\n-import org.junit.*;\n-import static org.junit.Assert.*;\n-\n-public class WindowsExitValue {\n-\n-    @Test\n-    public void checkExit259() throws IOException, InterruptedException {\n-        Process process = new ProcessBuilder(\"cmd\", \"\/c\", \"exit \/b 259\").start();\n-        int exitValue = process.waitFor();\n-        assertEquals(exitValue, 259);\n-    }\n-}\n","filename":"test\/jdk\/java\/lang\/ProcessBuilder\/WindowsExitValue.java","additions":0,"deletions":45,"binary":false,"changes":45,"status":"deleted"},{"patch":"@@ -26,1 +26,1 @@\n- * @bug 8266670 8291734 8296743\n+ * @bug 8266670 8291734\n@@ -101,3 +101,4 @@\n-        var expected = Set.of(AccessFlag.PUBLIC,\n-                              AccessFlag.FINAL,\n-                              AccessFlag.ABSTRACT);\n+        var mustBePresent = Set.of(AccessFlag.PUBLIC, AccessFlag.FINAL);\n+        var mustBeAbsent = Set.of(AccessFlag.PRIVATE,\n+                                  AccessFlag.PROTECTED,\n+                                  AccessFlag.INTERFACE);\n@@ -106,0 +107,3 @@\n+            \/\/ PUBLIC must be present, PROTECTED and PRIVATE must be\n+            \/\/ absent.\n+            \/\/ FINAL must be present, INTERFACE must be absent.\n@@ -107,2 +111,7 @@\n-            if (!accessFlags.equals(expected)) {\n-                throw new RuntimeException(\"Unexpected flags on \" +\n+            if (!accessFlags.containsAll(mustBePresent)) {\n+                throw new RuntimeException(\"Missing mandatory flags on \" +\n+                                           primClass);\n+            }\n+\n+            if (containsAny(accessFlags, mustBeAbsent)) {\n+                throw new RuntimeException(\"Unexpected flags present on \" +\n","filename":"test\/jdk\/java\/lang\/reflect\/AccessFlag\/ClassAccessFlagTest.java","additions":15,"deletions":6,"binary":false,"changes":21,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2016, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2016, 2017, Oracle and\/or its affiliates. All rights reserved.\n@@ -63,1 +63,1 @@\n- * @run main\/othervm -XX:+IgnoreUnrecognizedVMOptions -XX:-VerifyDependencies PublicMethodsTest\n+ * @run main PublicMethodsTest\n","filename":"test\/jdk\/java\/lang\/reflect\/PublicMethods\/PublicMethodsTest.java","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -27,1 +27,1 @@\n- *      7171415 6339649 6933879 8037396 8272072 8051627\n+ *      7171415 6339649 6933879 8037396 8272072\n@@ -1620,1 +1620,0 @@\n-        b8051627();\n@@ -1681,43 +1680,0 @@\n-    \/\/ 8051627 - Invariants about java.net.URI resolve and relativize are wrong\n-    private static void b8051627() {\n-        try {\n-            \/\/ Let u be a normalized absolute URI u which ends with \"\/\" and\n-            \/\/ v be a normalized relative URI v which does not start with \".\" or \"\/\", then\n-            \/\/ u.relativize(u.resolve(v)).equals(v) should be true\n-            reltivizeAfterResolveTest(\"http:\/\/a\/b\/\", \"c\/d\", \"c\/d\");\n-            reltivizeAfterResolveTest(\"http:\/\/a\/b\/\", \"g;x?y#s\", \"g;x?y#s\");\n-\n-            \/\/ when the URI condition is not met, u.relativize(u.resolve(v)).equals(v) may be false\n-            \/\/ In the following examples, that should be false\n-            reltivizeAfterResolveTest(\"http:\/\/a\/b\", \"c\/d\", \"http:\/\/a\/c\/d\");\n-            reltivizeAfterResolveTest(\"http:\/\/a\/b\/\", \"..\/c\/d\", \"http:\/\/a\/c\/d\");\n-            reltivizeAfterResolveTest(\"http:\/\/a\/b\/\", \"\/c\/d\", \"http:\/\/a\/c\/d\");\n-            reltivizeAfterResolveTest(\"http:\/\/a\/b\/\", \"http:\/\/a\/b\/c\/d\", \"c\/d\");\n-\n-            \/\/ Let u be a normalized absolute URI u which ends with \"\/\" and\n-            \/\/ v be a normalized absolute URI v, then\n-            \/\/ u.resolve(u.relativize(v)).equals(v) should be true\n-            resolveAfterRelativizeTest(\"http:\/\/a\/b\/\", \"http:\/\/a\/b\/c\/d\", \"http:\/\/a\/b\/c\/d\");\n-            resolveAfterRelativizeTest(\"http:\/\/a\/b\/\", \"http:\/\/a\/b\/c\/g;x?y#s\", \"http:\/\/a\/b\/c\/g;x?y#s\");\n-\n-            \/\/ when the URI condition is not met, u.resolve(u.relativize(v)).equals(v) may be false\n-            \/\/ In the following examples, that should be false\n-            resolveAfterRelativizeTest(\"http:\/\/a\/b\", \"http:\/\/a\/b\/c\/d\", \"http:\/\/a\/c\/d\");\n-            resolveAfterRelativizeTest(\"http:\/\/a\/b\/\", \"c\/d\", \"http:\/\/a\/b\/c\/d\");\n-        } catch (URISyntaxException e) {\n-            throw new AssertionError(\"shouldn't ever happen\", e);\n-        }\n-    }\n-    private static void reltivizeAfterResolveTest(String base, String target, String expected)\n-        throws URISyntaxException {\n-            URI baseURI = URI.create(base);\n-            URI targetURI = URI.create(target);\n-            eq(URI.create(expected), baseURI.relativize(baseURI.resolve(targetURI)));\n-    }\n-    private static void resolveAfterRelativizeTest(String base, String target, String expected)\n-        throws URISyntaxException {\n-            URI baseURI = URI.create(base);\n-            URI targetURI = URI.create(target);\n-            eq(URI.create(expected), baseURI.resolve(baseURI.relativize(targetURI)));\n-    }\n-\n","filename":"test\/jdk\/java\/net\/URI\/Test.java","additions":1,"deletions":45,"binary":false,"changes":46,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2013, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2013, 2016, Oracle and\/or its affiliates. All rights reserved.\n@@ -29,3 +29,1 @@\n- * @bug 8010464 8027570 8027687 8029354 8114860 8071660 8161291 8294378\n- * @run main URLPermissionTest\n- * @run main\/othervm -Duser.language=tr URLPermissionTest\n+ * @bug 8010464 8027570 8027687 8029354 8114860 8071660 8161291\n@@ -397,3 +395,1 @@\n-        eqtest(\"http:\/\/@foo.com\/bar\",\"http:\/\/foo.com\/bar\", true),\n-        eqtest(\"http:\/\/www.IOU.com\", \"http:\/\/www.iou.com\", true),\n-        eqtest(\"HTTPI:\/\/www.IOU.com\", \"httpi:\/\/www.iou.com\", true)\n+        eqtest(\"http:\/\/@foo.com\/bar\",\"http:\/\/foo.com\/bar\", true)\n","filename":"test\/jdk\/java\/net\/URLPermission\/URLPermissionTest.java","additions":3,"deletions":7,"binary":false,"changes":10,"status":"modified"},{"patch":"@@ -26,1 +26,1 @@\n- * @bug 8245462 8229822 8254786 8297075 8297149\n+ * @bug 8245462 8229822 8254786\n","filename":"test\/jdk\/java\/net\/httpclient\/CancelRequestTest.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -26,1 +26,1 @@\n- * @bug 8294916 8297075 8297149\n+ * @bug 8294916\n","filename":"test\/jdk\/java\/net\/httpclient\/CancelStreamedBodyTest.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -1,193 +0,0 @@\n-\/*\n- * Copyright (c) 2022, Oracle and\/or its affiliates. All rights reserved.\n- * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n- *\n- * This code is free software; you can redistribute it and\/or modify it\n- * under the terms of the GNU General Public License version 2 only, as\n- * published by the Free Software Foundation.\n- *\n- * This code is distributed in the hope that it will be useful, but WITHOUT\n- * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n- * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n- * version 2 for more details (a copy is included in the LICENSE file that\n- * accompanied this code).\n- *\n- * You should have received a copy of the GNU General Public License version\n- * 2 along with this work; if not, write to the Free Software Foundation,\n- * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n- *\n- * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n- * or visit www.oracle.com if you need additional information or have any\n- * questions.\n- *\/\n-\n-\/*\n- * @test\n- * @bug 8288717\n- * @summary Tests that when the idleConnectionTimeoutEvent is configured in HTTP\/2,\n- *          an HTTP\/2 connection will close within the specified interval if there\n- *          are no active streams on the connection.\n- * @library \/test\/lib server\n- * @modules java.base\/sun.net.www.http\n- *          java.net.http\/jdk.internal.net.http.common\n- *          java.net.http\/jdk.internal.net.http.frame\n- *          java.net.http\/jdk.internal.net.http.hpack\n- *\n- * @run testng\/othervm -Djdk.httpclient.HttpClient.log=errors -Djdk.httpclient.keepalive.timeout=1\n- *                                                             IdleConnectionTimeoutTest\n- * @run testng\/othervm -Djdk.httpclient.HttpClient.log=errors -Djdk.httpclient.keepalive.timeout=2\n- *                                                             IdleConnectionTimeoutTest\n- *\n- * @run testng\/othervm -Djdk.httpclient.HttpClient.log=errors -Djdk.httpclient.keepalive.timeout.h2=1\n- *                                                             IdleConnectionTimeoutTest\n- * @run testng\/othervm -Djdk.httpclient.HttpClient.log=errors -Djdk.httpclient.keepalive.timeout.h2=2\n- *                                                             IdleConnectionTimeoutTest\n- *\n- * @run testng\/othervm -Djdk.httpclient.HttpClient.log=errors -Djdk.httpclient.keepalive.timeout.h2=1\n- *                                                            -Djdk.httpclient.keepalive.timeout=2\n- *                                                             IdleConnectionTimeoutTest\n- *\n- * @run testng\/othervm -Djdk.httpclient.HttpClient.log=errors IdleConnectionTimeoutTest\n- * @run testng\/othervm -Djdk.httpclient.HttpClient.log=errors -Djdk.httpclient.keepalive.timeout.h2=-1\n- *                                                             IdleConnectionTimeoutTest\n- * @run testng\/othervm -Djdk.httpclient.HttpClient.log=errors,trace -Djdk.httpclient.keepalive.timeout.h2=abc\n- *                                                                   IdleConnectionTimeoutTest\n- *\/\n-\n-import org.testng.annotations.BeforeTest;\n-import org.testng.annotations.Test;\n-\n-import java.io.IOException;\n-import java.io.PrintStream;\n-import java.net.InetSocketAddress;\n-import java.net.URI;\n-import java.net.http.HttpClient;\n-import java.net.http.HttpRequest;\n-import java.net.http.HttpResponse;\n-import java.util.concurrent.CompletableFuture;\n-\n-import static java.nio.charset.StandardCharsets.UTF_8;\n-import static java.net.http.HttpClient.Version.HTTP_2;\n-import static org.testng.Assert.assertEquals;\n-\n-public class IdleConnectionTimeoutTest {\n-\n-    Http2TestServer http2TestServer;\n-    URI timeoutUri;\n-    URI noTimeoutUri;\n-    final String IDLE_CONN_PROPERTY = \"jdk.httpclient.keepalive.timeout.h2\";\n-    final String KEEP_ALIVE_PROPERTY = \"jdk.httpclient.keepalive.timeout\";\n-    final String TIMEOUT_PATH = \"\/serverTimeoutHandler\";\n-    final String NO_TIMEOUT_PATH = \"\/noServerTimeoutHandler\";\n-    static final PrintStream testLog = System.err;\n-\n-    @BeforeTest\n-    public void setup() throws Exception {\n-        http2TestServer = new Http2TestServer(false, 0);\n-        http2TestServer.addHandler(new ServerTimeoutHandler(), TIMEOUT_PATH);\n-        http2TestServer.addHandler(new ServerNoTimeoutHandler(), NO_TIMEOUT_PATH);\n-\n-        http2TestServer.start();\n-        int port = http2TestServer.getAddress().getPort();\n-        timeoutUri = new URI(\"http:\/\/localhost:\" + port + TIMEOUT_PATH);\n-        noTimeoutUri = new URI(\"http:\/\/localhost:\" + port + NO_TIMEOUT_PATH);\n-    }\n-\n-    \/*\n-       If the InetSocketAddress of the first remote connection is not equal to the address of the\n-       second remote connection, then the idleConnectionTimeoutEvent has occurred and a new connection\n-       was made to carry out the second request by the client.\n-    *\/\n-    @Test\n-    public void test() throws InterruptedException {\n-        String timeoutVal = System.getProperty(IDLE_CONN_PROPERTY);\n-        String keepAliveVal = System.getProperty(KEEP_ALIVE_PROPERTY);\n-        testLog.println(\"Test run for \" + IDLE_CONN_PROPERTY + \"=\" + timeoutVal);\n-\n-        int sleepTime = 0;\n-        HttpClient hc = HttpClient.newBuilder().version(HTTP_2).build();\n-        HttpRequest hreq;\n-        HttpResponse<String> hresp;\n-        if (timeoutVal != null) {\n-            if (keepAliveVal != null) {\n-                \/\/ In this case, specified h2 timeout should override keep alive timeout.\n-                \/\/ Timeout should occur\n-                hreq = HttpRequest.newBuilder(timeoutUri).version(HTTP_2).GET().build();\n-                sleepTime = 2000;\n-                hresp = runRequest(hc, hreq, sleepTime);\n-                assertEquals(hresp.statusCode(), 200, \"idleConnectionTimeoutEvent was expected but did not occur\");\n-            } else if (timeoutVal.equals(\"1\")) {\n-                \/\/ Timeout should occur\n-                hreq = HttpRequest.newBuilder(timeoutUri).version(HTTP_2).GET().build();\n-                sleepTime = 2000;\n-                hresp = runRequest(hc, hreq, sleepTime);\n-                assertEquals(hresp.statusCode(), 200, \"idleConnectionTimeoutEvent was expected but did not occur\");\n-            } else if (timeoutVal.equals(\"2\")) {\n-                \/\/ Timeout should not occur\n-                hreq = HttpRequest.newBuilder(noTimeoutUri).version(HTTP_2).GET().build();\n-                sleepTime = 1000;\n-                hresp = runRequest(hc, hreq, sleepTime);\n-                assertEquals(hresp.statusCode(), 200, \"idleConnectionTimeoutEvent was not expected but occurred\");\n-            } else if (timeoutVal.equals(\"abc\") || timeoutVal.equals(\"-1\")) {\n-                \/\/ Timeout should not occur\n-                hreq = HttpRequest.newBuilder(noTimeoutUri).version(HTTP_2).GET().build();\n-                hresp = runRequest(hc, hreq, sleepTime);\n-                assertEquals(hresp.statusCode(), 200, \"idleConnectionTimeoutEvent was not expected but occurred\");\n-            }\n-        } else {\n-            \/\/ When no value is specified then no timeout should occur (default keep alive value of 600 used)\n-            hreq = HttpRequest.newBuilder(noTimeoutUri).version(HTTP_2).GET().build();\n-            hresp = runRequest(hc, hreq, sleepTime);\n-            assertEquals(hresp.statusCode(), 200, \"idleConnectionTimeoutEvent should not occur, no value was specified for this property\");\n-        }\n-    }\n-\n-    private HttpResponse<String> runRequest(HttpClient hc, HttpRequest req, int sleepTime) throws InterruptedException {\n-        CompletableFuture<HttpResponse<String>> request = hc.sendAsync(req, HttpResponse.BodyHandlers.ofString(UTF_8));\n-        HttpResponse<String> hresp = request.join();\n-        assertEquals(hresp.statusCode(), 200);\n-\n-        Thread.sleep(sleepTime);\n-        request = hc.sendAsync(req, HttpResponse.BodyHandlers.ofString(UTF_8));\n-        return request.join();\n-    }\n-\n-    static class ServerTimeoutHandler implements Http2Handler {\n-\n-        InetSocketAddress remote;\n-\n-        @Override\n-        public void handle(Http2TestExchange exchange) throws IOException {\n-            if (remote == null) {\n-                remote = exchange.getRemoteAddress();\n-                exchange.sendResponseHeaders(200, 0);\n-            } else if (!remote.equals(exchange.getRemoteAddress())) {\n-                testLog.println(\"ServerTimeoutHandler: New Connection was used, idleConnectionTimeoutEvent fired.\"\n-                        + \" First remote: \" + remote + \", Second Remote: \" + exchange.getRemoteAddress());\n-                exchange.sendResponseHeaders(200, 0);\n-            } else {\n-                exchange.sendResponseHeaders(400, 0);\n-            }\n-        }\n-    }\n-\n-    static class ServerNoTimeoutHandler implements Http2Handler {\n-\n-        InetSocketAddress oldRemote;\n-\n-        @Override\n-        public void handle(Http2TestExchange exchange) throws IOException {\n-            InetSocketAddress newRemote = exchange.getRemoteAddress();\n-            if (oldRemote == null) {\n-                oldRemote = newRemote;\n-                exchange.sendResponseHeaders(200, 0);\n-            } else if (oldRemote.equals(newRemote)) {\n-                testLog.println(\"ServerNoTimeoutHandler: Same Connection was used, idleConnectionTimeoutEvent did not fire.\"\n-                        + \" First remote: \" + oldRemote + \", Second Remote: \" + newRemote);\n-                exchange.sendResponseHeaders(200, 0);\n-            } else {\n-                exchange.sendResponseHeaders(400, 0);\n-            }\n-        }\n-    }\n-}\n","filename":"test\/jdk\/java\/net\/httpclient\/http2\/IdleConnectionTimeoutTest.java","additions":0,"deletions":193,"binary":false,"changes":193,"status":"deleted"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2010, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2010, 2011, Oracle and\/or its affiliates. All rights reserved.\n@@ -28,1 +28,0 @@\n- * @run junit\/othervm SelectWhenRefused\n@@ -35,5 +34,0 @@\n-import java.util.Set;\n-\n-import org.junit.jupiter.api.Test;\n-\n-import static org.junit.jupiter.api.Assertions.assertNotEquals;\n@@ -42,2 +36,0 @@\n-    static final int MAX_TRIES = 3;\n-    static final String GREETINGS_MESSAGE = \"Greetings from SelectWhenRefused!\";\n@@ -45,2 +37,1 @@\n-    @Test\n-    public void test() throws IOException {\n+    public static void main(String[] args) throws IOException {\n@@ -62,5 +53,8 @@\n-            for (int i = 1; i <= MAX_TRIES; i++) {\n-                if (testNoPUEBeforeConnection(dc, refuser, sel, i)) {\n-                    break; \/\/ test succeeded\n-                }\n-                assertNotEquals(i, MAX_TRIES, \"testNoPUEBeforeConnection: too many retries\");\n+            sendDatagram(dc, refuser);\n+            int n = sel.select(2000);\n+            if (n > 0) {\n+                sel.selectedKeys().clear();\n+                \/\/ BindException will be thrown if another service is using\n+                \/\/ our expected refuser port, cannot run just exit.\n+                DatagramChannel.open().bind(refuser).close();\n+                throw new RuntimeException(\"Unexpected wakeup\");\n@@ -72,3 +66,9 @@\n-                for (int i = 1; i <= MAX_TRIES; i++) {\n-                    if (testPUEOnConnect(dc, refuser, sel, i)) {\n-                        break; \/\/ test passed\n+                sendDatagram(dc, refuser);\n+                n = sel.select(2000);\n+                if (n > 0) {\n+                    sel.selectedKeys().clear();\n+                    try {\n+                        n = dc.read(ByteBuffer.allocate(100));\n+                        throw new RuntimeException(\"Unexpected datagram received\");\n+                    } catch (PortUnreachableException pue) {\n+                        \/\/ expected\n@@ -76,1 +76,0 @@\n-                    assertNotEquals(i, MAX_TRIES, \"testPUEOnConnect: too many retries\");\n@@ -83,5 +82,4 @@\n-            for (int i = 1; i <= MAX_TRIES; i++) {\n-                if (testNoPUEAfterDisconnect(dc, refuser, sel, i)) {\n-                    break; \/\/ test passed\n-                }\n-                assertNotEquals(i, MAX_TRIES, \"testNoPUEAfterDisconnect: too many retries\");\n+            sendDatagram(dc, refuser);\n+            n = sel.select(2000);\n+            if (n > 0) {\n+                throw new RuntimeException(\"Unexpected wakeup after disconnect\");\n@@ -89,1 +87,2 @@\n-        } catch (BindException e) {\n+\n+        } catch(BindException e) {\n@@ -91,1 +90,0 @@\n-            System.out.println(\"Skipping test: refuser port has been reused: \" + e);\n@@ -98,107 +96,0 @@\n-    \/*\n-     * Send a datagram to non existent unconnected UDP end point\n-     * This shouldn't result in an PortUnreachableException\n-     * Handle unexpected read events on the senders DC with\n-     * retry when message received is external and Throw Exception\n-     * on receipt of own message\n-     *\/\n-    static boolean testNoPUEBeforeConnection(DatagramChannel dc,\n-                                             SocketAddress refuser,\n-                                             Selector sel,\n-                                             int retryCount) throws IOException {\n-        sendDatagram(dc, refuser);\n-        int n = sel.select(2000);\n-        if (n > 0) {\n-            boolean mayRetry = checkUnexpectedWakeup(sel.selectedKeys());\n-            boolean tooManyRetries = retryCount >= MAX_TRIES;\n-            sel.selectedKeys().clear();\n-\n-            if (mayRetry && !tooManyRetries) {\n-                return false; \/\/ will retry\n-            }\n-\n-            \/\/ BindException will be thrown if another service is using\n-            \/\/ our expected refuser port, cannot run just exit.\n-            DatagramChannel.open().bind(refuser).close();\n-            throw new RuntimeException(\"Unexpected wakeup\");\n-        }\n-        return true; \/\/ test passed\n-    }\n-\n-    \/*\n-     * Send a datagram to a connected UDP end point\n-     * This should result in an PortUnreachableException\n-     * Handle unexpected read events on the senders DC with\n-     * retry when message received is external and Throw Exception\n-     * on receipt of own message\n-     *\/\n-    static boolean testPUEOnConnect(DatagramChannel dc,\n-                                    SocketAddress refuser,\n-                                    Selector sel,\n-                                    int retryCount) throws IOException {\n-        sendDatagram(dc, refuser);\n-        int n = sel.select(2000);\n-        if (n > 0) {\n-            sel.selectedKeys().clear();\n-\n-            try {\n-                \/\/ Attempt to read from Selected Key\n-                ByteBuffer buf = ByteBuffer.allocate(100);\n-                SocketAddress sa = dc.receive(buf);\n-\n-                if (sa != null) {\n-                    buf.flip();\n-                    byte[] bytes = new byte[buf.remaining()];\n-                    buf.get(bytes);\n-                    String message = new String(bytes);\n-                    System.out.format(\"received %s at %s from %s%n\", message, dc.getLocalAddress(), sa);\n-\n-                    \/\/ If any received data contains the message from sendDatagram then throw exception\n-                    if (message.contains(GREETINGS_MESSAGE)) {\n-                        throw new RuntimeException(\"Unexpected datagram received\");\n-                    }\n-                }\n-\n-                boolean mayRetry = retryCount < MAX_TRIES;\n-                if (mayRetry) {\n-                    return false; \/\/ will retry\n-                }\n-\n-                \/\/ BindException will be thrown if another service is using\n-                \/\/ our expected refuser port, cannot run just exit.\n-                DatagramChannel.open().bind(refuser).close();\n-                throw new RuntimeException(\"PortUnreachableException not raised\");\n-            } catch (PortUnreachableException pue) {\n-                System.out.println(\"Got expected PortUnreachableException \" + pue);\n-            }\n-        }\n-        return true; \/\/ test passed\n-    }\n-\n-    \/*\n-     * Send a datagram to a disconnected UDP end point\n-     * This should result in an PortUnreachableException\n-     * Handle unexpected read events on the senders DC with\n-     * retry when message received is external and Throw Exception\n-     * on receipt of own message\n-     *\/\n-    static boolean testNoPUEAfterDisconnect(DatagramChannel dc,\n-                                            SocketAddress refuser,\n-                                            Selector sel,\n-                                            int retryCount) throws IOException {\n-        sendDatagram(dc, refuser);\n-        int n = sel.select(2000);\n-        if (n > 0) {\n-            boolean mayRetry = checkUnexpectedWakeup(sel.selectedKeys());\n-            boolean tooManyRetries = retryCount >= MAX_TRIES;\n-            sel.selectedKeys().clear();\n-\n-            if (mayRetry && !tooManyRetries) {\n-                return false; \/\/ will retry\n-            }\n-\n-            throw new RuntimeException(\"Unexpected wakeup after disconnect\");\n-        }\n-        return true; \/\/ test passed\n-    }\n-\n@@ -206,2 +97,3 @@\n-            throws IOException {\n-        ByteBuffer bb = ByteBuffer.wrap(GREETINGS_MESSAGE.getBytes());\n+        throws IOException\n+    {\n+        ByteBuffer bb = ByteBuffer.wrap(\"Greetings!\".getBytes());\n@@ -210,41 +102,0 @@\n-\n-    \/*\n-     * Attempt to read and Log the data from SelectedKeys,\n-     * If a message can be received, and it came from\n-     * another test return True\n-     *\n-     *\/\n-    static boolean checkUnexpectedWakeup(Set<SelectionKey> selectedKeys) {\n-        System.out.format(\"Received %d keys%n\", selectedKeys.size());\n-\n-        for (SelectionKey key : selectedKeys) {\n-            if (!key.isValid() || !key.isReadable()) {\n-                System.out.println(\"Invalid or unreadable key: \" + key);\n-                continue;\n-            }\n-\n-            try {\n-                System.out.println(\"Attempting to read datagram from key: \" + key);\n-                DatagramChannel datagramChannel = (DatagramChannel) key.channel();\n-                ByteBuffer buf = ByteBuffer.allocate(100);\n-                SocketAddress sa = datagramChannel.receive(buf);\n-\n-                if (sa != null) {\n-                    buf.flip();\n-                    byte[] bytes = new byte[buf.remaining()];\n-                    buf.get(bytes);\n-                    String message = new String(bytes);\n-                    System.out.format(\"received %s at %s from %s%n\", message, datagramChannel.getLocalAddress(), sa);\n-\n-                    \/\/ If any received data contains the message from sendDatagram then return false\n-                    if (message.contains(GREETINGS_MESSAGE)) {\n-                        return false;\n-                    }\n-                }\n-\n-            } catch (IOException io) {\n-                System.out.println(\"Unable to read from datagram \" + io);\n-            }\n-        }\n-        return true;\n-    }\n","filename":"test\/jdk\/java\/nio\/channels\/DatagramChannel\/SelectWhenRefused.java","additions":28,"deletions":177,"binary":false,"changes":205,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2016, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2016, Oracle and\/or its affiliates. All rights reserved.\n@@ -25,0 +25,1 @@\n+ * @ignore This test has huge disk space requirements\n@@ -28,2 +29,0 @@\n- * @requires (sun.arch.data.model == \"64\")\n- * @library \/test\/lib\/\n@@ -46,1 +45,0 @@\n-import java.util.List;\n@@ -52,1 +50,0 @@\n-import jtreg.SkippedException;\n@@ -63,3 +60,0 @@\n-    private static final long FILESIZE = 3L * 1024L * 1024L * 1024L;\n-    private static final int PARALLELISM = 3;\n-\n@@ -79,1 +73,0 @@\n-\n@@ -87,2 +80,0 @@\n-        checkRequiredDiskSpace(defaultFolder);\n-\n@@ -92,1 +83,1 @@\n-        ForkJoinPool fjPool = new ForkJoinPool(PARALLELISM);\n+        ForkJoinPool fjPool = new ForkJoinPool(3);\n@@ -129,27 +120,0 @@\n-    private static void checkRequiredDiskSpace(String destinationFolder) throws IOException {\n-        Path destinationPath = Path.of(destinationFolder);\n-        Path tmpDir = Path.of(TMPDIR);\n-\n-        long totalDiskSpaceNeeded = FILESIZE * PARALLELISM;\n-\n-        if (Files.getFileStore(tmpDir).equals(Files.getFileStore(destinationPath))) {\n-            totalDiskSpaceNeeded *= 2; \/\/ writing and copying to same FS\n-            long usableDiskSpace = Files.getFileStore(tmpDir).getUsableSpace();\n-            if (usableDiskSpace < totalDiskSpaceNeeded) {\n-                throw new SkippedException(\"Insufficient disk space on \" + TMPDIR\n-                        + \". Test requires: \" + totalDiskSpaceNeeded\n-                        + \". Available on disk: \" + usableDiskSpace);\n-            }\n-\n-        } else {\n-            for (Path p : List.of(destinationPath, tmpDir)) {\n-                long usableDiskSpace = Files.getFileStore(p).getUsableSpace();\n-                if (usableDiskSpace < totalDiskSpaceNeeded) {\n-                    throw new SkippedException(\"Insufficient disk space on \" + p\n-                            + \". Test requires: \" + totalDiskSpaceNeeded\n-                            + \". Available on disk: \" + usableDiskSpace);\n-                }\n-            }\n-        }\n-    }\n-\n@@ -166,1 +130,1 @@\n-\n+        long fileSize = 3L * 1024L * 1024L * 1024L;\n@@ -168,1 +132,1 @@\n-        int loopCount = (int) Math.floorDiv(FILESIZE, blockSize);\n+        int loopCount = (int) Math.floorDiv(fileSize, blockSize);\n@@ -174,1 +138,1 @@\n-                raf.setLength(FILESIZE);\n+                raf.setLength(fileSize);\n","filename":"test\/jdk\/java\/nio\/channels\/FileChannel\/FileExtensionAndMap.java","additions":6,"deletions":42,"binary":false,"changes":48,"status":"modified"},{"patch":"@@ -69,0 +69,1 @@\n+import jdk.test.lib.Platform;\n@@ -109,1 +110,1 @@\n-                \/\/ write to sc1 when current thread blocks in sc2.read\n+                \/\/ delayed write to sc1\n@@ -132,1 +133,1 @@\n-                \/\/ read from sc2 to EOF when current thread blocks in sc1.write\n+                \/\/ delayed read from sc2 to EOF\n@@ -176,1 +177,1 @@\n-                \/\/ interrupt current thread when it blocks in read\n+                \/\/ delayed interrupt of current thread\n@@ -196,19 +197,9 @@\n-            boolean retry = true;\n-            while (retry) {\n-                try (var connection = new Connection()) {\n-                    SocketChannel sc = connection.channel1();\n-\n-                    \/\/ close sc when current thread blocks in write\n-                    runAfterParkedAsync(sc::close);\n-                    try {\n-                        ByteBuffer bb = ByteBuffer.allocate(100*1024);\n-                        for (;;) {\n-                            int n = sc.write(bb);\n-                            assertTrue(n > 0);\n-                            bb.clear();\n-                        }\n-                    } catch (AsynchronousCloseException expected) {\n-                        \/\/ closed when blocked in write\n-                        retry = false;\n-                    } catch (ClosedChannelException e) {\n-                        \/\/ closed when not blocked in write, need to retry test\n+            try (var connection = new Connection()) {\n+                SocketChannel sc = connection.channel1();\n+                runAfterParkedAsync(sc::close);\n+                try {\n+                    ByteBuffer bb = ByteBuffer.allocate(100*1024);\n+                    for (;;) {\n+                        int n = sc.write(bb);\n+                        assertTrue(n > 0);\n+                        bb.clear();\n@@ -216,0 +207,5 @@\n+                } catch (AsynchronousCloseException e) {\n+                    \/\/ expected\n+                } catch (ClosedChannelException e) {\n+                    \/\/ on macOS the write loop may block more than once\n+                    if (!Platform.isOSX()) throw e;\n@@ -227,22 +223,13 @@\n-            boolean retry = true;\n-            while (retry) {\n-                try (var connection = new Connection()) {\n-                    SocketChannel sc = connection.channel1();\n-\n-                    \/\/ interrupt current thread when it blocks in write\n-                    Thread thisThread = Thread.currentThread();\n-                    runAfterParkedAsync(thisThread::interrupt);\n-\n-                    try {\n-                        ByteBuffer bb = ByteBuffer.allocate(100*1024);\n-                        for (;;) {\n-                            int n = sc.write(bb);\n-                            assertTrue(n > 0);\n-                            bb.clear();\n-                        }\n-                    } catch (ClosedByInterruptException e) {\n-                        \/\/ closed when blocked in write\n-                        assertTrue(Thread.interrupted());\n-                        retry = false;\n-                    } catch (ClosedChannelException e) {\n-                        \/\/ closed when not blocked in write, need to retry test\n+            try (var connection = new Connection()) {\n+                SocketChannel sc = connection.channel1();\n+\n+                \/\/ delayed interrupt of current thread\n+                Thread thisThread = Thread.currentThread();\n+                runAfterParkedAsync(thisThread::interrupt);\n+\n+                try {\n+                    ByteBuffer bb = ByteBuffer.allocate(100*1024);\n+                    for (;;) {\n+                        int n = sc.write(bb);\n+                        assertTrue(n > 0);\n+                        bb.clear();\n@@ -250,0 +237,5 @@\n+                } catch (ClosedByInterruptException e) {\n+                    assertTrue(Thread.interrupted());\n+                } catch (ClosedChannelException e) {\n+                    \/\/ on macOS the write loop may block more than once\n+                    if (!Platform.isOSX()) throw e;\n@@ -277,1 +269,1 @@\n-                \/\/ write to sc1 when currnet thread blocks reading from sc2\n+                \/\/ delayed write to sc1\n@@ -319,1 +311,1 @@\n-                \/\/ connect when current thread when it blocks in accept\n+                \/\/ delayed connect\n@@ -359,1 +351,1 @@\n-                \/\/ interrupt current thread when it blocks in accept\n+                \/\/ delayed interrupt of current thread\n@@ -396,1 +388,1 @@\n-                \/\/ interrupt current thread when it blocks in accept\n+                \/\/ delayed connect\n@@ -446,1 +438,1 @@\n-                \/\/ send from dc1 when current thread blocked in dc2.receive\n+                \/\/ delayed send from sc1\n@@ -486,1 +478,1 @@\n-                \/\/ interrupt current thread when it blocks in receive\n+                \/\/ delayed interrupt of current thread\n@@ -524,1 +516,1 @@\n-                \/\/ send from dc1 when current thread blocks in dc2 receive\n+                \/\/ delayed send from dc2\n@@ -567,1 +559,1 @@\n-                \/\/ close channel\/socket when current thread blocks in receive\n+                \/\/ delayed close of channel\/socket\n@@ -603,1 +595,1 @@\n-                \/\/ interrupt current thread when it blocks in receive\n+                \/\/ delayed interrupt of current thread\n@@ -651,1 +643,1 @@\n-                \/\/ write from sink when current thread blocks reading from source\n+                \/\/ delayed write from sink\n@@ -674,1 +666,1 @@\n-                \/\/ read from source to EOF when current thread blocking in write\n+                \/\/ delayed read from source to EOF\n@@ -699,2 +691,1 @@\n-            try (Pipe.SinkChannel sink = p.sink();\n-                 Pipe.SourceChannel source = p.source()) {\n+            try (Pipe.SourceChannel source = p.source()) {\n@@ -717,2 +708,1 @@\n-            try (Pipe.SinkChannel sink = p.sink();\n-                 Pipe.SourceChannel source = p.source()) {\n+            try (Pipe.SourceChannel source = p.source()) {\n@@ -720,1 +710,1 @@\n-                \/\/ interrupt current thread when it blocks reading from source\n+                \/\/ delayed interrupt of current thread\n@@ -740,20 +730,9 @@\n-            boolean retry = true;\n-            while (retry) {\n-                Pipe p = Pipe.open();\n-                try (Pipe.SinkChannel sink = p.sink();\n-                     Pipe.SourceChannel source = p.source()) {\n-\n-                    \/\/ close sink when current thread blocks in write\n-                    runAfterParkedAsync(sink::close);\n-                    try {\n-                        ByteBuffer bb = ByteBuffer.allocate(100*1024);\n-                        for (;;) {\n-                            int n = sink.write(bb);\n-                            assertTrue(n > 0);\n-                            bb.clear();\n-                        }\n-                    } catch (AsynchronousCloseException e) {\n-                        \/\/ closed when blocked in write\n-                        retry = false;\n-                    } catch (ClosedChannelException e) {\n-                        \/\/ closed when not blocked in write, need to retry test\n+            Pipe p = Pipe.open();\n+            try (Pipe.SinkChannel sink = p.sink()) {\n+                runAfterParkedAsync(sink::close);\n+                try {\n+                    ByteBuffer bb = ByteBuffer.allocate(100*1024);\n+                    for (;;) {\n+                        int n = sink.write(bb);\n+                        assertTrue(n > 0);\n+                        bb.clear();\n@@ -761,1 +740,1 @@\n-                }\n+                } catch (AsynchronousCloseException expected) { }\n@@ -772,23 +751,13 @@\n-            boolean retry = true;\n-            while (retry) {\n-                Pipe p = Pipe.open();\n-                try (Pipe.SinkChannel sink = p.sink();\n-                     Pipe.SourceChannel source = p.source()) {\n-\n-                    \/\/ interrupt current thread when it blocks in write\n-                    Thread thisThread = Thread.currentThread();\n-                    runAfterParkedAsync(thisThread::interrupt);\n-\n-                    try {\n-                        ByteBuffer bb = ByteBuffer.allocate(100*1024);\n-                        for (;;) {\n-                            int n = sink.write(bb);\n-                            assertTrue(n > 0);\n-                            bb.clear();\n-                        }\n-                    } catch (ClosedByInterruptException expected) {\n-                        \/\/ closed when blocked in write\n-                        assertTrue(Thread.interrupted());\n-                        retry = false;\n-                    } catch (ClosedChannelException e) {\n-                        \/\/ closed when not blocked in write, need to retry test\n+            Pipe p = Pipe.open();\n+            try (Pipe.SinkChannel sink = p.sink()) {\n+\n+                \/\/ delayed interrupt of current thread\n+                Thread thisThread = Thread.currentThread();\n+                runAfterParkedAsync(thisThread::interrupt);\n+\n+                try {\n+                    ByteBuffer bb = ByteBuffer.allocate(100*1024);\n+                    for (;;) {\n+                        int n = sink.write(bb);\n+                        assertTrue(n > 0);\n+                        bb.clear();\n@@ -796,0 +765,2 @@\n+                } catch (ClosedByInterruptException expected) {\n+                    assertTrue(Thread.interrupted());\n","filename":"test\/jdk\/java\/nio\/channels\/vthread\/BlockingChannelOps.java","additions":75,"deletions":104,"binary":false,"changes":179,"status":"modified"},{"patch":"@@ -1,77 +0,0 @@\n-\/*\n- * Copyright (c) 2022, Oracle and\/or its affiliates. All rights reserved.\n- * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n- *\n- * This code is free software; you can redistribute it and\/or modify it\n- * under the terms of the GNU General Public License version 2 only, as\n- * published by the Free Software Foundation.\n- *\n- * This code is distributed in the hope that it will be useful, but WITHOUT\n- * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n- * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n- * version 2 for more details (a copy is included in the LICENSE file that\n- * accompanied this code).\n- *\n- * You should have received a copy of the GNU General Public License version\n- * 2 along with this work; if not, write to the Free Software Foundation,\n- * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n- *\n- * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n- * or visit www.oracle.com if you need additional information or have any\n- * questions.\n- *\/\n-\n-import jdk.test.lib.Asserts;\n-import sun.security.x509.CRLExtensions;\n-import sun.security.x509.CRLNumberExtension;\n-import sun.security.x509.X500Name;\n-import sun.security.x509.X509CRLImpl;\n-\n-import java.math.BigInteger;\n-import java.security.KeyPairGenerator;\n-import java.security.cert.X509CRLSelector;\n-import java.util.Date;\n-\n-\/**\n- * @test\n- * @bug 8296399\n- * @summary crlNumExtVal might be null inside X509CRLSelector::match\n- * @library \/test\/lib\n- * @modules java.base\/sun.security.x509\n- *\/\n-\n-public class CRLNumberMissing {\n-\n-    public static void main(String[] args) throws Exception {\n-\n-        var pk = KeyPairGenerator.getInstance(\"Ed25519\")\n-                .generateKeyPair().getPrivate();\n-\n-        var crlWithoutNum = X509CRLImpl.newSigned(\n-                new X509CRLImpl.TBSCertList(\n-                        new X500Name(\"CN=CRL\"), new Date(), new Date()),\n-                pk, \"Ed25519\");\n-\n-        var exts = new CRLExtensions();\n-        exts.setExtension(\"CRLNumber\", new CRLNumberExtension(1));\n-        var crlWithNum = X509CRLImpl.newSigned(\n-                new X509CRLImpl.TBSCertList(\n-                        new X500Name(\"CN=CRL\"), new Date(), new Date(),\n-                        null, exts),\n-                pk, \"Ed25519\");\n-\n-        var sel = new X509CRLSelector();\n-        Asserts.assertTrue(sel.match(crlWithNum));\n-        Asserts.assertTrue(sel.match(crlWithoutNum));\n-\n-        sel = new X509CRLSelector();\n-        sel.setMinCRLNumber(BigInteger.ZERO);\n-        Asserts.assertTrue(sel.match(crlWithNum));\n-        Asserts.assertFalse(sel.match(crlWithoutNum));\n-\n-        sel = new X509CRLSelector();\n-        sel.setMinCRLNumber(BigInteger.TWO);\n-        Asserts.assertFalse(sel.match(crlWithNum));\n-        Asserts.assertFalse(sel.match(crlWithoutNum));\n-    }\n-}\n","filename":"test\/jdk\/java\/security\/cert\/X509CRLSelector\/CRLNumberMissing.java","additions":0,"deletions":77,"binary":false,"changes":77,"status":"deleted"},{"patch":"@@ -413,1 +413,1 @@\n-        signAlg.encode(topLevelItems);\n+        signAlg.derEncode(topLevelItems);\n@@ -462,1 +462,1 @@\n-        signAlg.encode(tbsCertItems);\n+        signAlg.derEncode(tbsCertItems);\n","filename":"test\/jdk\/java\/security\/testlibrary\/CertificateBuilder.java","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -1357,1 +1357,1 @@\n-                sigAlgId.encode(basicORItemStream);\n+                sigAlgId.derEncode(basicORItemStream);\n","filename":"test\/jdk\/java\/security\/testlibrary\/SimpleOCSPServer.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -2,1 +2,0 @@\n- * Copyright (c) 2018, 2022, Oracle and\/or its affiliates. All rights reserved.\n@@ -199,25 +198,0 @@\n-\n-    \/**\n-     * Calls Collections.unmodifiableMap().entrySet().iterator().forEachRemaining() by passing\n-     * that method a {@code null} action and expects that call to fail with a\n-     * {@code NullPointerException}.\n-     *\/\n-    @Test\n-    public void testUnmodifiableForEachRemainingNPE() {\n-        final Iterator<?> it = Collections.unmodifiableMap(Map.of()).entrySet().iterator();\n-        \/\/ pass null action and expect a NPE\n-        Assert.assertThrows(NullPointerException.class, () -> it.forEachRemaining(null));\n-    }\n-\n-    \/**\n-     * Calls Collections.checkedMap().entrySet().iterator().forEachRemaining() by passing\n-     * that method a {@code null} action and expects that call to fail with a\n-     * {@code NullPointerException}.\n-     *\/\n-    @Test\n-    public void testCheckedMapForEachRemainingNPE() {\n-        final Iterator<?> it = Collections.checkedMap(Map.of(), String.class,\n-                String.class).entrySet().iterator();\n-        \/\/ pass null \"action\" and expect it to fail with NPE\n-        Assert.assertThrows(NullPointerException.class, () -> it.forEachRemaining(null));\n-    }\n","filename":"test\/jdk\/java\/util\/Collections\/DelegatingIteratorForEachRemaining.java","additions":0,"deletions":26,"binary":false,"changes":26,"status":"modified"},{"patch":"@@ -29,1 +29,1 @@\n- *          (LSR Revision: 2022-08-08) with Locale and Locale.LanguageRange\n+ *          (LSR Revision: 2022-03-02) with Locale and Locale.LanguageRange\n","filename":"test\/jdk\/java\/util\/Locale\/LanguageSubtagRegistryTest.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2020, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2020, 2021, Oracle and\/or its affiliates. All rights reserved.\n@@ -31,1 +31,2 @@\n-import java.util.Arrays;\n+\/\/ TODO: this test is far too slow\n+\n@@ -40,0 +41,2 @@\n+import java.util.concurrent.RejectedExecutionException;\n+import java.util.concurrent.ScheduledExecutorService;\n@@ -41,1 +44,0 @@\n-import static java.lang.Thread.State.*;\n@@ -43,0 +45,2 @@\n+import org.testng.annotations.AfterClass;\n+import org.testng.annotations.BeforeClass;\n@@ -55,0 +59,23 @@\n+    private ScheduledExecutorService scheduledExecutor;\n+\n+    @BeforeClass\n+    public void setup() {\n+        scheduledExecutor = Executors.newScheduledThreadPool(1);\n+    }\n+\n+    @AfterClass\n+    public void teardown() {\n+        scheduledExecutor.shutdown();\n+    }\n+\n+    \/**\n+     * Schedule the given executor service to be shutdown abruptly after the given\n+     * delay, in seconds.\n+     *\/\n+    private void scheduleShutdownNow(ExecutorService executor, int delayInSeconds) {\n+        scheduledExecutor.schedule(() -> {\n+            executor.shutdownNow();\n+            return null;\n+        }, delayInSeconds, TimeUnit.SECONDS);\n+    }\n+\n@@ -72,1 +99,3 @@\n-        try (executor) {\n+        scheduleShutdownNow(executor, 5);\n+        try {\n+            \/\/ submit long running task, the task should be cancelled\n@@ -74,3 +103,0 @@\n-\n-            \/\/ shutdownNow when main thread waits in ForkJoinTask.get\n-            onWait(\"java.util.concurrent.ForkJoinTask.get\", executor::shutdownNow);\n@@ -79,2 +105,2 @@\n-                fail();\n-            } catch (ExecutionException | CancellationException e) {\n+                assertTrue(false);\n+            } catch (ExecutionException | RejectedExecutionException e) {\n@@ -83,0 +109,2 @@\n+        } finally {\n+            executor.shutdown();\n@@ -92,1 +120,3 @@\n-        try (executor) {\n+        scheduleShutdownNow(executor, 5);\n+        try {\n+            \/\/ submit long running task, the task should be cancelled\n@@ -94,3 +124,0 @@\n-\n-            \/\/ shutdownNow when main thread waits in ForkJoinTask.get\n-            onWait(\"java.util.concurrent.ForkJoinTask.get\", executor::shutdownNow);\n@@ -99,2 +126,2 @@\n-                fail();\n-            } catch (ExecutionException | CancellationException e) {\n+                assertTrue(false);\n+            } catch (ExecutionException | RejectedExecutionException e) {\n@@ -103,0 +130,2 @@\n+        } finally {\n+            executor.shutdown();\n@@ -112,3 +141,3 @@\n-        try (executor) {\n-            \/\/ shutdownNow when main thread waits in ForkJoinTask.quietlyJoin\n-            onWait(\"java.util.concurrent.ForkJoinTask.quietlyJoin\", executor::shutdownNow);\n+        scheduleShutdownNow(executor, 5);\n+        try {\n+            \/\/ execute long running tasks\n@@ -120,1 +149,1 @@\n-                    fail();\n+                    assertTrue(false);\n@@ -125,0 +154,2 @@\n+        } finally {\n+            executor.shutdown();\n@@ -131,1 +162,1 @@\n-    @Test(dataProvider = \"executors\", enabled = false)\n+    @Test(dataProvider = \"executors\")\n@@ -134,3 +165,2 @@\n-        try (executor) {\n-            \/\/ shutdownNow when main thread waits in ForkJoinTask.get\n-            onWait(\"java.util.concurrent.ForkJoinTask.get\", executor::shutdownNow);\n+        scheduleShutdownNow(executor, 5);\n+        try {\n@@ -138,0 +168,1 @@\n+                \/\/ execute long running tasks\n@@ -139,2 +170,2 @@\n-                fail();\n-            } catch (ExecutionException e) {\n+                assertTrue(false);\n+            } catch (ExecutionException | RejectedExecutionException e) {\n@@ -143,0 +174,2 @@\n+        } finally {\n+            executor.shutdown();\n@@ -145,42 +178,0 @@\n-\n-    \/**\n-     * Runs the given action when the current thread is sampled as waiting (timed or\n-     * untimed) at the given location. The location takes the form \"{@code c.m}\" where\n-     * {@code c} is the fully qualified class name and {@code m} is the method name.\n-     *\/\n-    private void onWait(String location, Runnable action) {\n-        int index = location.lastIndexOf('.');\n-        String className = location.substring(0, index);\n-        String methodName = location.substring(index + 1);\n-        Thread target = Thread.currentThread();\n-        var thread = new Thread(() -> {\n-            try {\n-                boolean found = false;\n-                while (!found) {\n-                    Thread.State state = target.getState();\n-                    assertTrue(state != TERMINATED);\n-                    if ((state == WAITING || state == TIMED_WAITING)\n-                            && contains(target.getStackTrace(), className, methodName)) {\n-                        found = true;\n-                    } else {\n-                        Thread.sleep(20);\n-                    }\n-                }\n-                action.run();\n-            } catch (Exception e) {\n-                e.printStackTrace();\n-            }\n-        });\n-        thread.setDaemon(true);\n-        thread.start();\n-    }\n-\n-    \/**\n-     * Returns true if the given stack trace contains an element for the given class\n-     * and method name.\n-     *\/\n-    private boolean contains(StackTraceElement[] stack, String className, String methodName) {\n-        return Arrays.stream(stack)\n-                .anyMatch(e -> className.equals(e.getClassName())\n-                        && methodName.equals(e.getMethodName()));\n-    }\n","filename":"test\/jdk\/java\/util\/concurrent\/forkjoin\/AsyncShutdownNow.java","additions":58,"deletions":67,"binary":false,"changes":125,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2003, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2003, 2007, Oracle and\/or its affiliates. All rights reserved.\n@@ -26,1 +26,1 @@\n- * @bug 4941596 8296442\n+ * @bug 4941596\n@@ -30,0 +30,3 @@\n+import java.util.*;\n+import java.nio.*;\n+import java.io.*;\n@@ -31,0 +34,2 @@\n+import java.util.Arrays;\n+import java.security.spec.*;\n@@ -59,12 +64,2 @@\n-                System.out.println(\"...expected: \" + algo);\n-                System.out.println(\"     ...got: \" + epki.getAlgName());\n-                status = false;\n-            }\n-\n-            \/\/ Make sure EncryptedPrivateKeyInfo can be created with an\n-            \/\/ uninitialized AlgorithmParameters.\n-            AlgorithmParameters ap2 = AlgorithmParameters.getInstance(ap.getAlgorithm());\n-            epki = new EncryptedPrivateKeyInfo(ap2, BYTES);\n-            if (!epki.getAlgName().equalsIgnoreCase(algo)) {\n-                System.out.println(\"...expected: \" + algo);\n-                System.out.println(\"     ...got: \" + epki.getAlgName());\n+                System.out.println(\"...expect: \" + algo);\n+                System.out.println(\"...got: \" + epki.getAlgName());\n","filename":"test\/jdk\/javax\/crypto\/EncryptedPrivateKeyInfo\/GetAlgName.java","additions":9,"deletions":14,"binary":false,"changes":23,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2021, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2021, Oracle and\/or its affiliates. All rights reserved.\n@@ -26,1 +26,1 @@\n- * @bug 8261779 8296442\n+ * @bug 8261779\n@@ -59,8 +59,0 @@\n-\n-        try {\n-            epki1.getEncoded();\n-            throw new Exception(\"Should have thrown IOException\");\n-        } catch (IOException ioe) {\n-            \/\/ test passed, expected exception\n-        }\n-\n","filename":"test\/jdk\/javax\/crypto\/EncryptedPrivateKeyInfo\/GetEncoded.java","additions":2,"deletions":10,"binary":false,"changes":12,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2003, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2003, 2017, Oracle and\/or its affiliates. All rights reserved.\n@@ -34,3 +34,0 @@\n-import java.util.ArrayList;\n-import java.util.Collections;\n-import java.util.List;\n@@ -43,1 +40,1 @@\n- * @run main\/othervm\/timeout=120 MetaCallback\n+ * @run main\/othervm MetaCallback\n@@ -65,5 +62,2 @@\n-    volatile int metaCount = 0;\n-    volatile boolean finished = false;\n-    \/\/ On M1 Mac sometimes system notifies listener about the same message twice\n-    static List<MetaMessage> received = Collections.synchronizedList(new ArrayList<>());\n-    long startTimeMs;\n+    int metaCount = 0;\n+    boolean finished = false;\n@@ -73,1 +67,0 @@\n-        startTimeMs = System.currentTimeMillis();\n@@ -111,4 +104,1 @@\n-    void stop() {\n-        sequencer.stop();\n-        sequencer.close();\n-    }\n+    void stop() {sequencer.stop();}\n@@ -121,12 +111,0 @@\n-            if (!received.contains(msg)) {\n-                received.add(msg);\n-            } else {\n-                \/\/ Add some additional debug output for the case of duplicate meta message\n-                \/\/ The test will fail anyway at the end\n-                System.out.println(\"Duplicate message received after getting \"\n-                        + received.size() + \" messages.\");\n-                System.out.println(\"Sequencer in use: \" + sequencer);\n-                System.out.println(\"Time from test start: \" +\n-                        (System.currentTimeMillis() - startTimeMs) + \"ms\");\n-                Thread.dumpStack();\n-            }\n","filename":"test\/jdk\/javax\/sound\/midi\/Sequencer\/MetaCallback.java","additions":5,"deletions":27,"binary":false,"changes":32,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2011, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2011, 2012, Oracle and\/or its affiliates. All rights reserved.\n@@ -41,1 +41,1 @@\n-    private static final String FIRST = \"AAAAA\";\n+    private static final String FIRST = \"AAAAAAAAAAA\";\n@@ -65,1 +65,0 @@\n-            robot.waitForIdle();\n@@ -69,1 +68,0 @@\n-            robot.waitForIdle();\n@@ -73,1 +71,0 @@\n-            robot.waitForIdle();\n@@ -77,1 +74,0 @@\n-            robot.waitForIdle();\n@@ -83,1 +79,0 @@\n-            robot.waitForIdle();\n@@ -87,1 +82,0 @@\n-            robot.waitForIdle();\n@@ -92,1 +86,0 @@\n-            robot.waitForIdle();\n@@ -95,1 +88,0 @@\n-            robot.waitForIdle();\n@@ -99,1 +91,0 @@\n-            robot.waitForIdle();\n@@ -103,1 +94,0 @@\n-            robot.waitForIdle();\n@@ -107,1 +97,0 @@\n-            robot.waitForIdle();\n@@ -113,1 +102,0 @@\n-            robot.waitForIdle();\n@@ -117,1 +105,0 @@\n-            robot.waitForIdle();\n@@ -125,1 +112,0 @@\n-            robot.waitForIdle();\n@@ -129,1 +115,0 @@\n-            robot.waitForIdle();\n@@ -133,1 +118,0 @@\n-            robot.waitForIdle();\n@@ -147,0 +131,1 @@\n+            robot.waitForIdle();\n@@ -159,1 +144,1 @@\n-                Point p = new Point(rect.x + rect.width\/2, rect.y + rect.height\/2);\n+                Point p = new Point(rect.x + rect.width \/ 2, rect.y + 2);\n@@ -184,1 +169,0 @@\n-        frame.setAlwaysOnTop(true);\n@@ -188,1 +172,0 @@\n-        frame.toFront();\n@@ -203,1 +186,0 @@\n-\n@@ -269,1 +251,0 @@\n-        robot.waitForIdle();\n@@ -271,1 +252,0 @@\n-        robot.waitForIdle();\n","filename":"test\/jdk\/javax\/swing\/JTree\/6263446\/bug6263446.java","additions":4,"deletions":24,"binary":false,"changes":28,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2018, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2018, 2021, Oracle and\/or its affiliates. All rights reserved.\n@@ -95,1 +95,0 @@\n-                                \"-XX:-TieredCompilation\",\n","filename":"test\/jdk\/jdk\/jfr\/event\/runtime\/TestShutdownEvent.java","additions":1,"deletions":2,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -64,1 +64,1 @@\n-                Events.assertField(e, \"certificateId\").equal(TestTLSHandshake.CERT_ID);\n+                Events.assertField(e, \"certificateId\").equal(TestTLSHandshake.HASHCODE);\n","filename":"test\/jdk\/jdk\/jfr\/event\/security\/TestTLSHandshakeEvent.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -131,3 +131,2 @@\n-                    int hash = TestCertificate.ROOT_CA.certificate().getPublicKey().hashCode();\n-                    Long id = Integer.toUnsignedLong(hash);\n-                    Asserts.assertEquals(e.getLong(\"certificateId\"), id);\n+                    Asserts.assertEquals(e.getLong(\"certificateId\"),\n+                        Long.valueOf(TestCertificate.ROOT_CA.certificate().getPublicKey().hashCode()));\n","filename":"test\/jdk\/jdk\/jfr\/event\/security\/TestX509ValidationEvent.java","additions":2,"deletions":3,"binary":false,"changes":5,"status":"modified"},{"patch":"@@ -1,130 +0,0 @@\n-\/*\n- * Copyright (c) 2022, Oracle and\/or its affiliates. All rights reserved.\n- * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n- *\n- * This code is free software; you can redistribute it and\/or modify it\n- * under the terms of the GNU General Public License version 2 only, as\n- * published by the Free Software Foundation.\n- *\n- * This code is distributed in the hope that it will be useful, but WITHOUT\n- * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n- * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n- * version 2 for more details (a copy is included in the LICENSE file that\n- * accompanied this code).\n- *\n- * You should have received a copy of the GNU General Public License version\n- * 2 along with this work; if not, write to the Free Software Foundation,\n- * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n- *\n- * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n- * or visit www.oracle.com if you need additional information or have any\n- * questions.\n- *\/\n-\n-package jdk.jfr.jmx.streaming;\n-\n-import java.lang.management.ManagementFactory;\n-import java.nio.file.Files;\n-import java.nio.file.Path;\n-import java.util.List;\n-import java.util.concurrent.ArrayBlockingQueue;\n-import java.util.concurrent.CountDownLatch;\n-import java.util.concurrent.atomic.AtomicLong;\n-\n-import javax.management.MBeanServerConnection;\n-\n-import jdk.jfr.Event;\n-import jdk.jfr.StackTrace;\n-import jdk.jfr.Recording;\n-import jdk.jfr.consumer.RecordedEvent;\n-import jdk.jfr.consumer.RecordingFile;\n-import jdk.management.jfr.RemoteRecordingStream;\n-\n-\/**\n- * @test\n- * @key jfr\n- * @summary Tests that chunks arrive in the same order they were committed\n- * @requires vm.hasJFR\n- * @library \/test\/lib \/test\/jdk\n- * @run main\/othervm jdk.jfr.jmx.streaming.TestDumpOrder\n- *\/\n-public class TestDumpOrder {\n-\n-    private static final MBeanServerConnection CONNECTION = ManagementFactory.getPlatformMBeanServer();\n-\n-    @StackTrace(false)\n-    static class Ant extends Event {\n-        long id;\n-    }\n-\n-    public static void main(String... args) throws Exception {\n-        \/\/ Set up the test so half of the events have been consumed\n-        \/\/ when the dump occurs.\n-        AtomicLong eventCount = new AtomicLong();\n-        CountDownLatch halfLatch = new CountDownLatch(1);\n-        CountDownLatch dumpLatch = new CountDownLatch(1);\n-        Path directory = Path.of(\"chunks\");\n-        Files.createDirectory(directory);\n-        try (var rs = new RemoteRecordingStream(CONNECTION, directory)) {\n-            rs.setMaxSize(100_000_000); \/\/ keep all data\n-            rs.onEvent(event -> {\n-                try {\n-                    eventCount.incrementAndGet();\n-                    if (eventCount.get() == 10) {\n-                        halfLatch.countDown();\n-                        dumpLatch.await();\n-                    }\n-                } catch (InterruptedException ie) {\n-                    ie.printStackTrace();\n-                }\n-            });\n-            rs.startAsync();\n-            long counter = 0;\n-            for (int i = 0; i < 10; i++) {\n-                try (Recording r = new Recording()) {\n-                    r.start();\n-                    Ant a = new Ant();\n-                    a.id = counter++;\n-                    a.commit();\n-                    Ant b = new Ant();\n-                    b.id = counter++;\n-                    b.commit();\n-                }\n-                if (counter == 10) {\n-                    halfLatch.await();\n-                }\n-            }\n-            Path file = Path.of(\"events.jfr\");\n-            \/\/ Wait for most (but not all) chunk files to be downloaded\n-            \/\/ before invoking dump()\n-            awaitChunkFiles(directory);\n-            \/\/ To stress the implementation, release consumer thread\n-            \/\/ during the dump\n-            dumpLatch.countDown();\n-            rs.dump(file);\n-            List<RecordedEvent> events = RecordingFile.readAllEvents(file);\n-            if (events.isEmpty()) {\n-                throw new AssertionError(\"No events found\");\n-            }\n-            \/\/ Print events for debugging purposes\n-            events.forEach(System.out::println);\n-            long expected = 0;\n-            for (var event : events) {\n-                long value = event.getLong(\"id\");\n-                if (value != expected) {\n-                    throw new Exception(\"Expected \" + expected + \", got \" + value);\n-                }\n-                expected++;\n-            }\n-            if (expected != counter) {\n-                throw new Exception(\"Not all events found\");\n-            }\n-        }\n-    }\n-\n-    private static void awaitChunkFiles(Path directory) throws Exception {\n-        while (Files.list(directory).count() < 7) {\n-            Thread.sleep(10);\n-        }\n-    }\n-}\n","filename":"test\/jdk\/jdk\/jfr\/jmx\/streaming\/TestDumpOrder.java","additions":0,"deletions":130,"binary":false,"changes":130,"status":"deleted"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2021, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2021, Oracle and\/or its affiliates. All rights reserved.\n@@ -29,1 +29,0 @@\n-import java.util.List;\n@@ -35,1 +34,0 @@\n-import java.util.function.Consumer;\n@@ -37,1 +35,0 @@\n-import javax.management.MBeanServerConnection;\n@@ -41,1 +38,0 @@\n-import jdk.jfr.Recording;\n@@ -57,2 +53,0 @@\n-    private static final MBeanServerConnection CONNECTION = ManagementFactory.getPlatformMBeanServer();\n-\n@@ -69,3 +63,0 @@\n-        testSetNoPolicy();\n-        testSetMaxAge();\n-        testSetMaxSize();\n@@ -76,1 +67,1 @@\n-        var rs = new RemoteRecordingStream(CONNECTION);\n+        var rs = new RecordingStream();\n@@ -88,1 +79,1 @@\n-        var rs = new RemoteRecordingStream(CONNECTION);\n+        var rs = new RecordingStream();\n@@ -100,64 +91,0 @@\n-    private static List<RecordedEvent> recordWithPolicy(String filename, Consumer<RemoteRecordingStream> policy) throws Exception {\n-        CountDownLatch latch1 = new CountDownLatch(1);\n-        CountDownLatch latch2 = new CountDownLatch(2);\n-        CountDownLatch latch3 = new CountDownLatch(3);\n-        try (var rs = new RemoteRecordingStream(CONNECTION)) {\n-            policy.accept(rs);\n-            rs.onEvent(e -> {\n-                latch1.countDown();\n-                latch2.countDown();\n-                latch3.countDown();\n-            });\n-            rs.startAsync();\n-            DumpEvent e1 = new DumpEvent();\n-            e1.commit();\n-            latch1.await();\n-            \/\/ Force chunk rotation\n-            try (Recording r = new Recording()) {\n-                r.start();\n-                DumpEvent e2 = new DumpEvent();\n-                e2.commit();\n-            }\n-            latch2.await();\n-            DumpEvent e3 = new DumpEvent();\n-            e3.commit();\n-            latch3.await();\n-            Path p = Path.of(filename);\n-            rs.dump(p);\n-            return RecordingFile.readAllEvents(p);\n-        }\n-    }\n-\n-    private static void testSetMaxSize() throws Exception {\n-        var events = recordWithPolicy(\"max-size.jfr\", rs -> {\n-            \/\/ keeps all events for the dump\n-            rs.setMaxSize(100_000_000);\n-        });\n-        if (events.size() != 3) {\n-            throw new Exception(\"Expected all 3 events to be in dump after setMaxSize\");\n-        }\n-\n-    }\n-\n-    private static void testSetMaxAge() throws Exception {\n-        var events = recordWithPolicy(\"max-age.jfr\", rs -> {\n-            \/\/ keeps all events for the dump\n-            rs.setMaxAge(Duration.ofDays(1));\n-        });\n-        if (events.size() != 3) {\n-            throw new Exception(\"Expected all 3 events to be in dump after setMaxAge\");\n-        }\n-\n-    }\n-\n-    private static void testSetNoPolicy() throws Exception {\n-        var events = recordWithPolicy(\"no-policy.jfr\", rs -> {\n-            \/\/ use default policy, remove after consumption\n-        });\n-        \/\/ Since latch3 have been triggered at least two events\/chunks\n-        \/\/ before must have been consumed, possibly 3, but it's a race.\n-        if (events.size() > 1) {\n-            throw new Exception(\"Expected at most one event to not be consumed\");\n-        }\n-    }\n-\n@@ -166,1 +93,2 @@\n-        try (var rs = new RemoteRecordingStream(CONNECTION)) {\n+        var conn = ManagementFactory.getPlatformMBeanServer();\n+        try (var rs = new RemoteRecordingStream(conn)) {\n@@ -203,1 +131,2 @@\n-        try (var rs = new RemoteRecordingStream(CONNECTION)) {\n+        var conn = ManagementFactory.getPlatformMBeanServer();\n+        try (var rs = new RemoteRecordingStream(conn)) {\n@@ -224,1 +153,1 @@\n-        try (var rs = new RemoteRecordingStream(CONNECTION)) {\n+        try (var rs = new RecordingStream()) {\n","filename":"test\/jdk\/jdk\/jfr\/jmx\/streaming\/TestRemoteDump.java","additions":8,"deletions":79,"binary":false,"changes":87,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2016, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2016, 2021, Oracle and\/or its affiliates. All rights reserved.\n@@ -126,1 +126,0 @@\n-        options.add(\"-XX:-TieredCompilation\"); \/\/ Avoid secondary crashes (see JDK-8293166)\n","filename":"test\/jdk\/jdk\/jfr\/jvm\/TestDumpOnCrash.java","additions":1,"deletions":2,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -55,1 +55,0 @@\n-import jdk.jfr.Unsigned;\n@@ -153,3 +152,0 @@\n-                if (expectedValue instanceof Number && v.getAnnotation(Unsigned.class) != null) {\n-                    expectedValue = Long.toUnsignedString(re.getLong(name));\n-                }\n","filename":"test\/jdk\/jdk\/jfr\/tool\/TestPrintXML.java","additions":0,"deletions":4,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -43,2 +43,2 @@\n-                TestTLSHandshake.ANCHOR_CERT_ID +\n-                \", \" + TestTLSHandshake.CERT_ID);\n+                TestTLSHandshake.ANCHOR_HASHCODE +\n+                \", \" + TestTLSHandshake.HASHCODE);\n@@ -48,1 +48,1 @@\n-        l.addExpected(TestTLSHandshake.CIPHER_SUITE +\", \" + TestTLSHandshake.CERT_ID);\n+        l.addExpected(TestTLSHandshake.CIPHER_SUITE +\", \" + TestTLSHandshake.HASHCODE);\n","filename":"test\/jdk\/jdk\/security\/logging\/TestTLSHandshakeLog.java","additions":3,"deletions":3,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2007, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2007, 2016, Oracle and\/or its affiliates. All rights reserved.\n@@ -28,1 +28,2 @@\n- *          doesn't produce artifacts or crashes\n+ * doesn't produce artifacts or crashes\n+ * @author Dmitri.Trembovetski@sun.com: area=Graphics\n@@ -35,0 +36,1 @@\n+import java.awt.EventQueue;\n@@ -39,0 +41,1 @@\n+import java.awt.Insets;\n@@ -42,1 +45,2 @@\n-import java.awt.EventQueue;\n+import java.awt.event.WindowAdapter;\n+import java.awt.event.WindowEvent;\n@@ -51,0 +55,1 @@\n+    private static volatile boolean done = false;\n@@ -53,5 +58,4 @@\n-    private static int FRAME_W;\n-    private static int FRAME_H;\n-    private static int IMAGE_W;\n-    private static int IMAGE_H;\n-    private static final int tolerance = 12;\n+    private static final int FRAME_W = 256;\n+    private static final int FRAME_H = 256;\n+    private static final int IMAGE_W = 128;\n+    private static final int IMAGE_H = 128;\n@@ -63,15 +67,1 @@\n-    private static Frame frame;\n-\n-    private static void createAndShowGUI() {\n-        frame = new Frame() {\n-            public void paint(Graphics g) {}\n-            public void update(Graphics g) {}\n-        };\n-        frame.setBackground(bgColor);\n-        frame.setUndecorated(true);\n-        frame.setAlwaysOnTop(true);\n-        frame.pack();\n-        frame.setVisible(true);\n-    }\n-\n-    public static void main(String[] args) throws Exception {\n+    public static void main(String[] args) {\n@@ -87,2 +77,1 @@\n-                System.err.println(\"Usage: OnScreenRenderingResizeTest\" +\n-                                   \" [-inf][-nocheck]\");\n+                System.err.println(\"Usage: OnScreenRenderingResizeTest [-inf][-nocheck]\");\n@@ -92,0 +81,24 @@\n+        BufferedImage output =\n+            new BufferedImage(IMAGE_W, IMAGE_H, BufferedImage.TYPE_INT_RGB);\n+        output.setAccelerationPriority(0.0f);\n+        Graphics g = output.getGraphics();\n+        g.setColor(renderColor);\n+        g.fillRect(0, 0, output.getWidth(), output.getHeight());\n+\n+        final Frame frame = new Frame(\"OnScreenRenderingResizeTest\") {\n+            public void paint(Graphics g) {}\n+            public void update(Graphics g) {}\n+        };\n+        frame.setBackground(bgColor);\n+        frame.setUndecorated(true);\n+        frame.pack();\n+\n+        GraphicsConfiguration gc = frame.getGraphicsConfiguration();\n+        Rectangle gcBounds = gc.getBounds();\n+        frame.setBounds(gcBounds.width \/ 4, gcBounds.height \/ 4, FRAME_W, FRAME_H);\n+\n+        frame.addWindowListener(new WindowAdapter() {\n+            public void windowClosing(WindowEvent e) {\n+                done = true;\n+            }\n+        });\n@@ -95,1 +108,1 @@\n-                    createAndShowGUI();\n+                    frame.setVisible(true);\n@@ -98,0 +111,1 @@\n+            \/\/ wait for Vista's effects to complete\n@@ -103,34 +117,11 @@\n-        try {\n-            GraphicsConfiguration gc = frame.getGraphicsConfiguration();\n-            Rectangle gcBounds = gc.getBounds();\n-            FRAME_W = (gcBounds.width \/ 4);\n-            FRAME_H = (gcBounds.height \/ 4);\n-            IMAGE_W = (gcBounds.width \/ 8);\n-            IMAGE_H = (gcBounds.height \/ 8);\n-            frame.setBounds(gcBounds.width \/ 4, gcBounds.height \/ 4,\n-                            FRAME_W, FRAME_H);\n-\n-            BufferedImage output =\n-                new BufferedImage(IMAGE_W, IMAGE_H,\n-                                  BufferedImage.TYPE_INT_RGB);\n-            output.setAccelerationPriority(0.0f);\n-            Graphics g = output.getGraphics();\n-            g.setColor(renderColor);\n-            g.fillRect(0, 0, IMAGE_W, IMAGE_H);\n-\n-            int maxW = gcBounds.width \/ 2;\n-            int maxH = gcBounds.height \/ 2;\n-            int minW = FRAME_W;\n-            int minH = FRAME_H;\n-            int incW = 10, incH = 10, cnt = 0;\n-            Robot robot = null;\n-            if (!nocheck && gc.getColorModel().getPixelSize() > 8) {\n-                try {\n-                    robot = new Robot();\n-                    robot.setAutoDelay(100);\n-                    robot.mouseMove(0,0);\n-                } catch (AWTException ex) {\n-                    System.err.println(\"Robot creation failed, continuing.\");\n-                }\n-            } else {\n-                System.err.println(\"No screen rendering checks.\");\n+        int maxW = gcBounds.width \/2;\n+        int maxH = gcBounds.height\/2;\n+        int minW = frame.getWidth();\n+        int minH = frame.getHeight();\n+        int incW = 10, incH = 10, cnt = 0;\n+        Robot robot = null;\n+        if (!nocheck && gc.getColorModel().getPixelSize() > 8) {\n+            try {\n+                robot = new Robot();\n+            } catch (AWTException ex) {\n+                System.err.println(\"Robot creation failed, continuing.\");\n@@ -138,20 +129,15 @@\n-            VolatileImage vi = gc.\n-                createCompatibleVolatileImage(IMAGE_W, IMAGE_H);\n-            vi.validate(gc);\n-            long timeStarted = System.currentTimeMillis();\n-            while ((System.currentTimeMillis() - timeStarted) < RUN_TIME) {\n-\n-                if (++cnt > 100) {\n-                    int w = frame.getWidth() + incW;\n-                    int h = frame.getHeight() + incH;\n-                    if (w < minW || w > maxW ) {\n-                        incW = -incW;\n-                    }\n-                    if (h < minH || h > maxH ) {\n-                        incH = -incH;\n-                    }\n-                    frame.setSize(w, h);\n-                    if (robot != null) {\n-                        robot.waitForIdle();\n-                    }\n-                    cnt = 0;\n+        } else {\n+            System.err.println(\"No screen rendering checks.\");\n+        }\n+\n+        VolatileImage vi = gc.createCompatibleVolatileImage(512, 512);\n+        vi.validate(gc);\n+\n+        long timeStarted = System.currentTimeMillis();\n+        while (!done && (System.currentTimeMillis() - timeStarted) < RUN_TIME) {\n+\n+            if (++cnt > 100) {\n+                int w = frame.getWidth() + incW;\n+                int h = frame.getHeight() + incH;\n+                if (w < minW || w > maxW ) {\n+                    incW = -incW;\n@@ -159,33 +145,2 @@\n-                \/\/ try to put the device into non-default state, for example,\n-                \/\/ this operation below will set the transform\n-                vi.validate(gc);\n-                Graphics2D vig = (Graphics2D)vi.getGraphics();\n-                vig.rotate(30.0f, IMAGE_W\/2, IMAGE_H\/2);\n-                vig.drawImage(output, 0, 0,\n-                              IMAGE_W, IMAGE_H, null);\n-\n-                frame.getGraphics().\n-                    drawImage(output, 0, 0, null);\n-                if (cnt == 90 && robot != null) {\n-                    robot.waitForIdle();\n-                    \/\/ area where we blit and should be either white or green\n-                    Point p = frame.getLocationOnScreen();\n-                    p.translate(10, 10);\n-                    BufferedImage bi =\n-                        robot.createScreenCapture(\n-                            new Rectangle(p.x, p.y,\n-                                          (IMAGE_W \/ 2), (IMAGE_H \/ 2)));\n-                    int accepted1[] = {Color.white.getRGB(),\n-                                       Color.green.getRGB()};\n-                    checkBI(bi, accepted1);\n-\n-                    \/\/ the area where we didn't render should stay white\n-                    robot.waitForIdle();\n-                    p = frame.getLocationOnScreen();\n-                    p.translate(10, IMAGE_H + 10);\n-                    bi = robot.createScreenCapture(\n-                        new Rectangle(p.x, p.y,\n-                                      frame.getWidth() - 20,\n-                                      frame.getHeight() - 20 - (IMAGE_H)));\n-                    int accepted2[] = { Color.white.getRGB() };\n-                    checkBI(bi, accepted2);\n+                if (h < minH || h > maxH ) {\n+                    incH = -incH;\n@@ -193,1 +148,2 @@\n-                Thread.yield();\n+                frame.setSize(w, h);\n+                cnt = 0;\n@@ -195,2 +151,34 @@\n-        } finally {\n-            frame.dispose();\n+\n+            \/\/ try to put the device into non-default state, for example,\n+            \/\/ this operation below will set the transform\n+            vi.validate(gc);\n+            Graphics2D vig = (Graphics2D)vi.getGraphics();\n+            vig.rotate(30.0f, vi.getWidth()\/2, vi.getHeight()\/2);\n+            vig.drawImage(output, 0, 0,\n+                          vi.getWidth(), vi.getHeight(), null);\n+\n+            Insets in = frame.getInsets();\n+            frame.getGraphics().drawImage(output, in.left, in.top, null);\n+            if (cnt == 90 && robot != null) {\n+                robot.waitForIdle();\n+                \/\/ area where we blitted to should be either white or green\n+                Point p = frame.getLocationOnScreen();\n+                p.translate(in.left+10, in.top+10);\n+                BufferedImage bi =\n+                    robot.createScreenCapture(\n+                        new Rectangle(p.x, p.y, IMAGE_W\/2, IMAGE_H\/2));\n+                int accepted1[] = { Color.white.getRGB(), Color.green.getRGB()};\n+                checkBI(bi, accepted1);\n+\n+                \/\/ the are where we didn't render should stay white\n+                p = frame.getLocationOnScreen();\n+                p.translate(in.left, in.top+IMAGE_H+5);\n+                bi = robot.createScreenCapture(\n+                    new Rectangle(p.x, p.y,\n+                                  frame.getWidth()-in.left-in.right,\n+                                  frame.getHeight()-in.top-in.bottom-5-IMAGE_H));\n+                int accepted2[] = { Color.white.getRGB() };\n+                checkBI(bi, accepted2);\n+            }\n+\n+            Thread.yield();\n@@ -198,0 +186,1 @@\n+        frame.dispose();\n@@ -204,5 +193,1 @@\n-                int actual = bi.getRGB(x, y);\n-                int alpha = (actual >> 24) & 0xFF;\n-                int red = (actual >> 16) & 0xFF;\n-                int green = (actual >> 8) & 0xFF;\n-                int blue = (actual) & 0xFF;\n+                int pix = bi.getRGB(x, y);\n@@ -211,8 +196,1 @@\n-                    int accAlpha = (acc >> 24) & 0xFF;\n-                    int accRed = (acc >> 16) & 0xFF;\n-                    int accGreen = (acc >> 8) & 0xFF;\n-                    int accBlue = (acc) & 0xFF;\n-                    if (!(Math.abs(alpha - accAlpha) > tolerance ||\n-                          Math.abs(red - accRed) > tolerance ||\n-                          Math.abs(green - accGreen) > tolerance ||\n-                          Math.abs(blue - accBlue) > tolerance)) {\n+                    if (pix == acc) {\n@@ -229,0 +207,1 @@\n+\n@@ -231,2 +210,1 @@\n-                                         \" rgb=0x\" + Integer.\n-                                         toHexString(actual));\n+                                         \" rgb=0x\" + Integer.toHexString(pix));\n","filename":"test\/jdk\/sun\/java2d\/DirectX\/OnScreenRenderingResizeTest\/OnScreenRenderingResizeTest.java","additions":109,"deletions":131,"binary":false,"changes":240,"status":"modified"},{"patch":"@@ -1,518 +0,0 @@\n-\/*\n- * Copyright (c) 2003, 2022, Oracle and\/or its affiliates. All rights reserved.\n- * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n- *\n- * This code is free software; you can redistribute it and\/or modify it\n- * under the terms of the GNU General Public License version 2 only, as\n- * published by the Free Software Foundation.\n- *\n- * This code is distributed in the hope that it will be useful, but WITHOUT\n- * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n- * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n- * version 2 for more details (a copy is included in the LICENSE file that\n- * accompanied this code).\n- *\n- * You should have received a copy of the GNU General Public License version\n- * 2 along with this work; if not, write to the Free Software Foundation,\n- * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n- *\n- * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n- * or visit www.oracle.com if you need additional information or have any\n- * questions.\n- *\/\n-\n-\/**\n- * @test\n- * @bug 4925447 4887054 8285604\n- * @key headful\n- * @summary verifies that most basic rendering operations going are successfully\n- * clipped against a complex clip shape\n- * @run main ClipShapeRendering\n-*\/\n-\n-\/**\n- * This test creates a complex clip shape (basically, a rectangular hole\n- * cut out of the center of the rendering area) and then cycles through\n- * various rendering primitives (image copies, lines, text, and shapes)\n- * under various situations (default, scaled transform, and wide lines).\n- * After all of that, Robot is used to check whether the clip shape has\n- * been disturbed by any of the rendering (no pixels from the rendering\n- * operations should have done anything inside the clipped-out area); the\n- * test passes or fails based on whether the clip shape is undisturbed.\n- *\n- * There is a performance-test version of this app which runs all of the\n- * tests in loops and times the results.  This can be useful to see, for\n- * example, the difference in performance between old and new internal\n- * implementations of this clip-shape situation.  To run the performance\n- * test, run ClipShapeRendering -perf.\n- *\/\n-\n-import java.awt.AWTException;\n-import java.awt.BasicStroke;\n-import java.awt.Color;\n-import java.awt.Component;\n-import java.awt.Frame;\n-import java.awt.Graphics;\n-import java.awt.Graphics2D;\n-import java.awt.Image;\n-import java.awt.Point;\n-import java.awt.Rectangle;\n-import java.awt.RenderingHints;\n-import java.awt.Robot;\n-import java.awt.Stroke;\n-import java.awt.Toolkit;\n-import java.awt.geom.AffineTransform;\n-import java.awt.geom.Area;\n-import java.awt.geom.GeneralPath;\n-import java.awt.image.BufferedImage;\n-import java.awt.image.ColorModel;\n-import java.awt.image.DirectColorModel;\n-import java.awt.image.WritableRaster;\n-\n-\n-public class ClipShapeRendering extends Frame {\n-    BufferedImage image;\n-    BufferedImage imageBM;\n-\n-    static Image offScreenImage;\n-    static boolean timeToRun = false;\n-    static Color imageColor = Color.red;\n-    static Color fillColor = Color.blue;\n-    static boolean perfMode = false;\n-    static boolean showCapture = false;\n-    static Rectangle clipRect = new Rectangle(100, 100, 100, 100);\n-\n-    \/\/ move away from cursor\n-    private final static int OFFSET_X = 20;\n-    private final static int OFFSET_Y = 20;\n-\n-    public ClipShapeRendering() {\n-        super(\"On-screen rendering test frame\");\n-    }\n-\n-    public void initImages(Color imageColor) {\n-        int w = getWidth();\n-        int h = getHeight();\n-\n-        ColorModel cm = new DirectColorModel(25, 0xff0000, 0xff00, 0xff, 0x1000000);\n-        WritableRaster wr =\n-            cm.createCompatibleWritableRaster(w, h);\n-        imageBM = new BufferedImage(cm, wr,\n-                                  cm.isAlphaPremultiplied(), null);\n-        Graphics g2 = imageBM.createGraphics();\n-        g2.setColor(imageColor);\n-        g2.fillRect(0, 0, w, h);\n-\n-        image = new BufferedImage(w, h,\n-                                  BufferedImage.TYPE_INT_RGB);\n-        g2 = image.createGraphics();\n-        g2.setColor(imageColor);\n-        g2.fillRect(0,0, w, h);\n-        g2.dispose();\n-\n-        offScreenImage = createImage(w, h);\n-    }\n-\n-    public void paint(Graphics g) {\n-        synchronized (this) {\n-            timeToRun = true;\n-            notifyAll();\n-        }\n-    }\n-\n-    public void runTests() {\n-        initImages(imageColor);\n-\n-        \/\/ run off-screen test\n-        System.out.println(\"Running OFF-SCREEN tests..\");\n-        runTest(offScreenImage.getGraphics());\n-\n-        \/\/ run on-screen test\n-        System.out.println(\"Running ON-SCREEN tests..\");\n-        runTest(getGraphics());\n-    }\n-\n-    \/**\n-     * Set various parameters on the Graphics object and call the\n-     * rendering loop with each variation\n-     *\/\n-    public void runTest(Graphics g) {\n-        int w = getWidth();\n-        int h = getHeight();\n-        Area area = new Area( new Rectangle(0,0, w, h));\n-        area.subtract(new Area(clipRect));\n-        \/\/ Fill completely with background color\n-        g.setColor(fillColor);\n-        g.fillRect(0, 0, w, h);\n-\n-        \/\/ Set the clip shape\n-        g.setClip(area);\n-\n-        \/\/ Now perform various rendering operations\n-        g.setColor(Color.black);\n-        Graphics2D g2 = (Graphics2D)g;\n-        if (perfMode) {\n-            System.out.println(\"Default Graphics Results:\");\n-            System.out.println(\"-------------------------\");\n-        }\n-        renderingLoop(g2);\n-\n-        if (perfMode) {\n-            System.out.println(\"Scaling Transform Results:\");\n-            System.out.println(\"-------------------------\");\n-        }\n-        AffineTransform oldXform = g2.getTransform();\n-        g2.scale(.9, 1.15);\n-        renderingLoop(g2);\n-        g2.setTransform(oldXform);\n-\n-        if (perfMode) {\n-            System.out.println(\"Wide Lines Results:\");\n-            System.out.println(\"-------------------\");\n-        }\n-        Stroke oldStroke = g2.getStroke();\n-        g2.setStroke(new BasicStroke(5.0f));\n-        renderingLoop(g2);\n-        g2.setStroke(oldStroke);\n-    }\n-\n-    public void renderingLoop(Graphics2D g) {\n-        int numReps = 1;\n-        int numTextReps = 1;\n-        long start, end;\n-        if (perfMode) {\n-            numReps = 1000;\n-            numTextReps = 50;\n-        }\n-        int w = getWidth();\n-        int h = getHeight();\n-\n-        \/\/ Image copies\n-        robot.waitForIdle();\n-        start = System.currentTimeMillis();\n-        for (int i = 0; i < numReps; ++i) {\n-            g.drawImage(image, 0, 0, null);\n-            g.drawImage(image, -10, -10, null);\n-            g.drawImage(image, 50, 50, null);\n-            g.drawImage(image, 40, 10, null);\n-        }\n-        for (int i = 0; i < numReps; ++i) {\n-            g.drawImage(imageBM, 0, 0, Color.yellow, null);\n-            g.drawImage(imageBM, -10, -10, Color.yellow, null);\n-            g.drawImage(imageBM, 50, 50, Color.yellow, null);\n-            g.drawImage(imageBM, 40, 10, Color.yellow, null);\n-        }\n-        robot.waitForIdle();\n-        end = System.currentTimeMillis();\n-        if (perfMode) {\n-            System.out.println(\"Image Copies   : \" + (end - start) + \" ms\");\n-        }\n-\n-        \/\/ Image scales\n-        start = System.currentTimeMillis();\n-        for (int i = 0; i < numReps; ++i) {\n-            g.drawImage(image, 0, 0, 500, 500, null);\n-        }\n-        robot.waitForIdle();\n-        end = System.currentTimeMillis();\n-        if (perfMode) {\n-            System.out.println(\"Image scales   : \" + (end - start) + \" ms\");\n-        }\n-\n-        \/\/ Lines\n-        start = System.currentTimeMillis();\n-        for (int i = 0; i < numReps; ++i) {\n-            g.drawLine(0, 0, w, h);\n-            g.drawLine(0, h, w, 0);\n-            g.drawLine(0, h \/ 2, w, h \/ 2);\n-            g.drawLine(w \/ 2, 0, w \/ 2, h);\n-        }\n-        robot.waitForIdle();\n-        end = System.currentTimeMillis();\n-        if (perfMode) {\n-            System.out.println(\"drawLine       : \" + (end - start) + \" ms\");\n-        }\n-\n-        \/\/ Text\n-\n-        \/\/ Non-AA\n-        start = System.currentTimeMillis();\n-        for (int i = 0; i < numTextReps; ++i) {\n-            for (int x = 0; x < w; x += 20) {\n-                for (int y = 0; y < h; y += 17) {\n-                    g.drawString(\"This is a string, this is only a string\", x,\n-                                 y);\n-                }\n-            }\n-        }\n-        robot.waitForIdle();\n-        end = System.currentTimeMillis();\n-        if (perfMode) {\n-            System.out.println(\"Text Non-AA    : \" + (end - start) + \" ms\");\n-        }\n-        \/\/ Anti-Aliased\n-        Graphics2D g2 = (Graphics2D)g;\n-        g2.setRenderingHint(RenderingHints.KEY_ANTIALIASING,\n-                            RenderingHints.VALUE_ANTIALIAS_ON);\n-        start = System.currentTimeMillis();\n-        for (int i = 0; i < numTextReps; ++i) {\n-            for (int x = 0; x < w; x += 20) {\n-                for (int y = 0; y < h; y += 17) {\n-                    g.drawString(\"This is a string, this is only a string\", x,\n-                                 y);\n-                }\n-            }\n-        }\n-        robot.waitForIdle();\n-        end = System.currentTimeMillis();\n-        if (perfMode) {\n-            System.out.println(\"Text General AA: \" + (end - start) + \" ms\");\n-        }\n-        g2.setRenderingHint(RenderingHints.KEY_ANTIALIASING,\n-                            RenderingHints.VALUE_ANTIALIAS_OFF);\n-        \/\/ Text AA\n-        g2.setRenderingHint(RenderingHints.KEY_TEXT_ANTIALIASING,\n-                            RenderingHints.VALUE_TEXT_ANTIALIAS_ON);\n-        start = System.currentTimeMillis();\n-        for (int i = 0; i < numTextReps; ++i) {\n-            for (int x = 0; x < w; x += 20) {\n-                for (int y = 0; y < h; y += 17) {\n-                    g.drawString(\"This is a string, this is only a string\", x,\n-                                 y);\n-                }\n-            }\n-        }\n-        robot.waitForIdle();\n-        end = System.currentTimeMillis();\n-        if (perfMode) {\n-            System.out.println(\"Text textAA    : \" + (end - start) + \" ms\");\n-        }\n-        g2.setRenderingHint(RenderingHints.KEY_TEXT_ANTIALIASING,\n-                            RenderingHints.VALUE_TEXT_ANTIALIAS_OFF);\n-\n-        \/\/ Arcs\n-        start = System.currentTimeMillis();\n-        if (numReps > 1) {\n-            numReps \/= 10;\n-        }\n-        for (int i = 0; i < numReps; ++i) {\n-            for (int x = 0; x < w; x += 20) {\n-                for (int y = 0; y < h; y += 17) {\n-                    g.drawArc(x, y, 30, 30, 0, 45);\n-                    g.fillArc(x, y, 25, 25, 0, 45);\n-                }\n-            }\n-        }\n-        robot.waitForIdle();\n-        end = System.currentTimeMillis();\n-        if (perfMode) {\n-            System.out.println(\"arcs           : \" + (end - start) + \" ms\");\n-        }\n-\n-        \/\/ Ovals\n-        start = System.currentTimeMillis();\n-        if (numReps > 1) {\n-            numReps \/= 10;\n-        }\n-        for (int i = 0; i < numReps; ++i) {\n-            for (int x = 0; x < w; x += 20) {\n-                for (int y = 0; y < h; y += 17) {\n-                    g.drawOval(x, y, 20, 20);\n-                    g.fillOval(x, y, 15, 15);\n-                }\n-            }\n-        }\n-        robot.waitForIdle();\n-        end = System.currentTimeMillis();\n-        if (perfMode) {\n-            System.out.println(\"ovals          : \" + (end - start) + \" ms\");\n-        }\n-\n-        \/\/ Rects\n-        start = System.currentTimeMillis();\n-        for (int i = 0; i < numReps; ++i) {\n-            for (int x = 0; x < w; x += 20) {\n-                for (int y = 0; y < h; y += 17) {\n-                    g.drawRect(x, y, 20, 20);\n-                    g.fillRect(x, y, 18, 18);\n-                }\n-            }\n-        }\n-        robot.waitForIdle();\n-        end = System.currentTimeMillis();\n-        if (perfMode) {\n-            System.out.println(\"rects          : \" + (end - start) + \" ms\");\n-        }\n-\n-        \/\/ GeneralPath rendering\n-        GeneralPath drawGP = new GeneralPath();\n-        for (int i = 0; i < 30; ++i) {\n-            Rectangle rect = new Rectangle(5 * i, 2 * i, 27, 19);\n-            drawGP.append(rect, false);\n-        }\n-        GeneralPath fillGP = new GeneralPath();\n-        for (int i = 0; i < 30; ++i) {\n-            Rectangle rect = new Rectangle(5 * i, 100 + 2 * i, 27, 19);\n-            fillGP.append(rect, false);\n-        }\n-        Graphics2D g2d = (Graphics2D)g;\n-        start = System.currentTimeMillis();\n-        for (int i = 0; i < numReps; ++i) {\n-            g2d.draw(drawGP);\n-            g2d.fill(fillGP);\n-        }\n-        robot.waitForIdle();\n-        end = System.currentTimeMillis();\n-        if (perfMode) {\n-            System.out.println(\"GeneralPath    : \" + (end - start) + \" ms\");\n-        }\n-\n-    }\n-\n-    public static void usage() {\n-        System.err.println(\"java ClipShapeRendering [-perf] [-show]\");\n-        System.err.println(\"  -perf : runs performance benchmark (1000 reps)\");\n-        System.err.println(\"  -show : shows a frame with captured clip area\");\n-        System.exit(1);\n-    }\n-\n-    public static boolean checkResult(BufferedImage clientPixels) {\n-        int pixels[] = new int[clipRect.width * clipRect.height];\n-        clientPixels.getRGB(0, 0, clipRect.width,\n-                            clipRect.height, pixels, 0,\n-                            clipRect.width);\n-        int pixelIndex = 0;\n-        for (int row = 0; row < clipRect.height; ++row) {\n-            for (int col = 0; col < clipRect.width; ++col) {\n-                if (!(new Color(pixels[pixelIndex])).equals(fillColor)) {\n-                    System.err.println(\"Incorrect color \" +\n-                                       Integer.toHexString(pixels[pixelIndex]) +\n-                                       \" instead of \" +\n-                                       Integer.toHexString(fillColor.getRGB()) +\n-                                       \" in pixel (\" + (clipRect.x + col) +\n-                                       \", \" + (clipRect.y + row) + \")\");\n-                    return false;\n-                }\n-                pixelIndex++;\n-            }\n-        }\n-        return true;\n-    }\n-\n-    static volatile Robot robot;\n-    public static void main(String args[]) throws Exception {\n-\n-        for (int i = 0; i < args.length; ++i) {\n-            if (args[i].equals(\"-perf\")) {\n-                perfMode = true;\n-            } else if (args[i].equals(\"-show\")) {\n-                showCapture = true;\n-            } else {\n-                usage();\n-            }\n-        }\n-\n-        try {\n-            robot = new Robot();\n-        } catch (AWTException e) {\n-            throw new RuntimeException(\"Can't create robot: \" + e);\n-        }\n-\n-        ClipShapeRendering clipTest = new ClipShapeRendering();\n-        clipTest.setSize(300, 300);\n-        clipTest.setLocationRelativeTo(null);\n-        clipTest.setAlwaysOnTop(true);\n-        clipTest.setVisible(true);\n-        try {\n-            synchronized (clipTest) {\n-                while (!timeToRun) {\n-                    clipTest.wait(300);\n-                }\n-            }\n-        } catch (InterruptedException e) {}\n-\n-        clipTest.runTests();\n-\n-        \/\/ check off-screen rendering;\n-        BufferedImage offScreenClientPixels =\n-            (BufferedImage)clipTest.createImage(clipRect.width,\n-                                                clipRect.height);\n-        Graphics clientG = offScreenClientPixels.getGraphics();\n-        clientG.drawImage(offScreenImage,\n-                          0, 0, clipRect.width, clipRect.height,\n-                          clipRect.x, clipRect.y,\n-                          clipRect.x + clipRect.width,\n-                          clipRect.y + clipRect.height,\n-                          null);\n-        if (showCapture) {\n-            CaptureFrame f =\n-                new CaptureFrame(\"OffScreen Image\", offScreenImage);\n-            f.setVisible(true);\n-        }\n-\n-        \/\/ check onscreen rendering\n-        Point clientLoc = clipTest.getLocationOnScreen();\n-        Rectangle r = (Rectangle)clipRect.clone();\n-        r.translate(clientLoc.x, clientLoc.y);\n-\n-        \/\/ move mouse cursor away from captured region as in some system\n-        \/\/ cursor remain visible in composite captured image\n-        robot.mouseMove(r.x - OFFSET_X, r.y - OFFSET_Y);\n-        robot.waitForIdle();\n-        BufferedImage onScreenClientPixels = robot.createScreenCapture(r);\n-        try { Thread.sleep(1000); } catch (Exception e) {}\n-        if (showCapture) {\n-            CaptureFrame f =\n-                new CaptureFrame(\"Onscreen clip area\", onScreenClientPixels);\n-            f.setVisible(true);\n-        } else {\n-            clipTest.dispose();\n-        }\n-\n-\n-        System.out.print(\"Checking results for off-screen rendering..\");\n-        boolean offScreenPassed = checkResult(offScreenClientPixels);\n-        System.out.println(\"done.\");\n-\n-        System.out.print(\"Checking results for on-screen rendering..\");\n-        boolean onScreenPassed = checkResult(onScreenClientPixels);\n-        System.out.println(\"done.\");\n-        if (!offScreenPassed || !onScreenPassed) {\n-            javax.imageio.ImageIO.write(offScreenClientPixels, \"png\", new java.io.File(\"offscreen.png\"));\n-            javax.imageio.ImageIO.write(onScreenClientPixels, \"png\", new java.io.File(\"onscreen.png\"));\n-            throw new RuntimeException(\"Test failed. off-screen: \" +\n-                                       (offScreenPassed?\"passed\":\"failed\") +\n-                                       \"   on-screen: \" +\n-                                       (onScreenPassed?\"passed\":\"failed\"));\n-        }\n-        System.out.println(\"Passed\");\n-    }\n-\n-    static {\n-        System.setProperty(\"sun.java2d.pmoffscreen\", \"true\");\n-    }\n-\n-}\n-\n-class CaptureFrame extends Frame {\n-   static int x = 300, y = 0;\n-   Image clientPixels;\n-   public CaptureFrame(String title,  Image clientPixels) {\n-       super(\"Capture Frame: \" + title);\n-       this.clientPixels = clientPixels;\n-       int w = clientPixels.getWidth(null);\n-       int h = clientPixels.getHeight(null);\n-       setSize(w, h + 30);\n-       setLocation(x, y);\n-       x += w;\n-       if (x + w > 1024) {\n-           x = 300;\n-           y += h;\n-       }\n-       add(new Component() {\n-           public void paint(Graphics g) {\n-               g.drawImage(CaptureFrame.this.clientPixels, 0, 0, null);\n-           }\n-       });\n-   }\n-};\n","filename":"test\/jdk\/sun\/java2d\/GdiRendering\/ClipShapeRendering.java","additions":0,"deletions":518,"binary":false,"changes":518,"status":"deleted"},{"patch":"@@ -1,271 +0,0 @@\n-\/*\n- * Copyright (c) 2003, 2022, Oracle and\/or its affiliates. All rights reserved.\n- * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n- *\n- * This code is free software; you can redistribute it and\/or modify it\n- * under the terms of the GNU General Public License version 2 only, as\n- * published by the Free Software Foundation.\n- *\n- * This code is distributed in the hope that it will be useful, but WITHOUT\n- * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n- * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n- * version 2 for more details (a copy is included in the LICENSE file that\n- * accompanied this code).\n- *\n- * You should have received a copy of the GNU General Public License version\n- * 2 along with this work; if not, write to the Free Software Foundation,\n- * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n- *\n- * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n- * or visit www.oracle.com if you need additional information or have any\n- * questions.\n- *\/\n-\n-\/*\n- * @test\n- * @bug 4975116 7040022 8023577 8025447 8286624\n- * @key headful\n- * @summary verify the rounding of negative coordinates in Shape objects\n- * @run main\/othervm CoordinateTruncationBug\n- *\/\n-\n-import java.awt.Frame;\n-import java.awt.Canvas;\n-import java.awt.Graphics;\n-import java.awt.Graphics2D;\n-import java.awt.Robot;\n-import java.awt.Rectangle;\n-import java.awt.Point;\n-import java.awt.Dimension;\n-import java.awt.Color;\n-import java.awt.AWTException;\n-import java.awt.geom.Line2D;\n-import java.awt.image.BufferedImage;\n-import java.awt.image.VolatileImage;\n-\n-public class CoordinateTruncationBug {\n-    static boolean failure;\n-    static boolean verbose;\n-\n-    static final int W = 80;\n-    static final int H = 80;\n-\n-    static final Line2D vertline = new Line2D.Float(-0.7f, 0f, -0.7f, H);\n-    static final Line2D horizline = new Line2D.Float(0f, -0.7f, W, -0.7f);\n-\n-    public static void main(String argv[]) {\n-        verbose = (argv.length > 0);\n-        new Screen().test();\n-        new BufImg().test();\n-        new VolImg().test();\n-        if (failure) {\n-            throw new RuntimeException(\"Test failed due to 1 or more failures\");\n-        }\n-    }\n-\n-    public static abstract class Test {\n-        public abstract String getName();\n-        public abstract void makeDest();\n-        public abstract void runTest();\n-        public abstract void dispose();\n-        public abstract BufferedImage getSnapshot();\n-\n-        public void test() {\n-            makeDest();\n-            runTest();\n-            dispose();\n-        }\n-\n-        public void runTest(Graphics2D g2d) {\n-            g2d.setColor(Color.white);\n-            g2d.fillRect(0, 0, W, H);\n-\n-            if (!checkAllWhite()) {\n-                System.err.println(\"Aborting test of \"+getName()+\n-                                   \" due to readback failure!\");\n-                return;\n-            }\n-\n-            g2d.setColor(Color.red);\n-            g2d.draw(vertline);\n-            g2d.draw(horizline);\n-            if (!checkAllWhite()) {\n-                System.err.println(getName()+\" failed!\");\n-                failure = true;\n-            }\n-        }\n-\n-        public boolean checkAllWhite() {\n-            BufferedImage bimg = getSnapshot();\n-            if (bimg == null) {\n-                System.err.println(getName()+\" returned null snapshot!\");\n-                return false;\n-            }\n-            boolean ret = true;\n-            for (int y = 0; y < H; y++) {\n-                for (int x = 0; x < W; x++) {\n-                    int rgb = bimg.getRGB(x, y);\n-                    if (rgb != -1) {\n-                        System.err.println(getName()+\"(\"+x+\", \"+y+\") == \"+\n-                                           Integer.toHexString(rgb));\n-                        if (verbose) {\n-                            ret = false;\n-                        } else {\n-                            return false;\n-                        }\n-                    }\n-                }\n-            }\n-            return ret;\n-        }\n-    }\n-\n-    public static class Screen extends Test {\n-        Frame frame;\n-        TestCanvas canvas;\n-\n-        public String getName() {\n-            return \"Screen\";\n-        }\n-\n-        public void makeDest() {\n-            frame = new Frame(\"Screen test\");\n-            frame.setUndecorated(true);\n-            canvas = new TestCanvas(this);\n-            frame.add(canvas);\n-            frame.pack();\n-            frame.setLocationRelativeTo(null);\n-        }\n-\n-        public void runTest() {\n-            frame.show();\n-            canvas.waitForTest();\n-        }\n-\n-        public Graphics2D createGraphics() {\n-            return null;\n-        }\n-\n-        public BufferedImage getSnapshot() {\n-            \/\/ bypass window animation\n-            try {\n-                Thread.sleep(500);\n-            } catch (InterruptedException e) {\n-            };\n-\n-            try {\n-                Robot r = new Robot();\n-                Point p = canvas.getLocationOnScreen();\n-                return r.createScreenCapture(new Rectangle(p.x, p.y, W, H));\n-            } catch (AWTException e) {\n-                return null;\n-            }\n-        }\n-\n-        public void dispose() {\n-            frame.hide();\n-            frame.dispose();\n-        }\n-\n-        public static class TestCanvas extends Canvas {\n-            Test test;\n-            boolean done;\n-\n-            public TestCanvas(Test test) {\n-                this.test = test;\n-            }\n-\n-            public Dimension getPreferredSize() {\n-                return new Dimension(W, H);\n-            }\n-\n-            public synchronized void waitForTest() {\n-                while (!done) {\n-                    try {\n-                        wait();\n-                    } catch (InterruptedException e) {\n-                        System.err.println(getName()+\" interrupted!\");\n-                        failure = true;\n-                        break;\n-                    }\n-                }\n-            }\n-\n-            public void paint(Graphics g) {\n-                if (!done) {\n-                    test.runTest((Graphics2D) g);\n-                    notifyDone();\n-                }\n-            }\n-\n-            public synchronized void notifyDone() {\n-                done = true;\n-                notifyAll();\n-            }\n-        }\n-    }\n-\n-    public abstract static class Standalone extends Test {\n-        public abstract Graphics2D createGraphics();\n-\n-        public void runTest() {\n-            Graphics2D g2d = createGraphics();\n-            runTest(g2d);\n-            g2d.dispose();\n-        }\n-    }\n-\n-    public static class BufImg extends Standalone {\n-        public BufferedImage bimg;\n-\n-        public String getName() {\n-            return \"BufferedImage\";\n-        }\n-\n-        public void makeDest() {\n-            bimg = new BufferedImage(W, H, BufferedImage.TYPE_INT_RGB);\n-        }\n-\n-        public Graphics2D createGraphics() {\n-            return bimg.createGraphics();\n-        }\n-\n-        public BufferedImage getSnapshot() {\n-            return bimg;\n-        }\n-\n-        public void dispose() {\n-        }\n-    }\n-\n-    public static class VolImg extends Standalone {\n-        Frame frame;\n-        VolatileImage vimg;\n-\n-        public String getName() {\n-            return \"VolatileImage\";\n-        }\n-\n-        public void makeDest() {\n-            frame = new Frame();\n-            frame.setSize(W, H);\n-            frame.setLocationRelativeTo(null);\n-            frame.show();\n-            vimg = frame.createVolatileImage(W, H);\n-        }\n-\n-        public Graphics2D createGraphics() {\n-            return vimg.createGraphics();\n-        }\n-\n-        public BufferedImage getSnapshot() {\n-            return vimg.getSnapshot();\n-        }\n-\n-        public void dispose() {\n-            vimg.flush();\n-            frame.hide();\n-            frame.dispose();\n-        }\n-    }\n-}\n","filename":"test\/jdk\/sun\/java2d\/SunGraphics2D\/CoordinateTruncationBug.java","additions":0,"deletions":271,"binary":false,"changes":271,"status":"deleted"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2007, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2007, 2020, Oracle and\/or its affiliates. All rights reserved.\n@@ -28,1 +28,1 @@\n- *          leave artifacts at the edges.\n+ * leave artifacts at the edges.\n@@ -31,0 +31,1 @@\n+ * @author campbelc\n@@ -35,0 +36,1 @@\n+import java.awt.Component;\n@@ -36,1 +38,0 @@\n-import java.awt.EventQueue;\n@@ -57,3 +58,16 @@\n-    private static BufferedImage capture;\n-    private static DrawImageBilinear test;\n-    private static Frame frame;\n+    private static volatile BufferedImage capture;\n+    private static void doCapture(Component test) {\n+        try {\n+            Thread.sleep(2000);\n+        } catch (InterruptedException ex) {}\n+        \/\/ Grab the screen region\n+        try {\n+            Robot robot = new Robot();\n+            Point pt1 = test.getLocationOnScreen();\n+            Rectangle rect =\n+                new Rectangle(pt1.x, pt1.y, test.getWidth(), test.getHeight());\n+            capture = robot.createScreenCapture(rect);\n+        } catch (Exception e) {\n+            e.printStackTrace();\n+        }\n+    }\n@@ -64,0 +78,2 @@\n+        \/\/g.setColor(Color.green);\n+        \/\/g.drawRect(0, 0, SIZE-1, SIZE-1);\n@@ -95,1 +111,3 @@\n-            g2d.drawImage(bimg2, 80, 10, 40, 40, null);\n+            if (!skipOglTextureTest) {\n+                g2d.drawImage(bimg2, 80, 10, 40, 40, null);\n+            }\n@@ -98,2 +116,1 @@\n-            if (vimg.validate(getGraphicsConfiguration()) !=\n-                VolatileImage.IMAGE_OK) {\n+            if (vimg.validate(getGraphicsConfiguration()) != VolatileImage.IMAGE_OK) {\n@@ -106,0 +123,8 @@\n+\n+        synchronized (this) {\n+            if (!done) {\n+                doCapture(this);\n+                done = true;\n+            }\n+            notifyAll();\n+        }\n@@ -134,3 +159,17 @@\n-    private static void createAndShowGUI() {\n-        test = new DrawImageBilinear();\n-        frame = new Frame();\n+    private static boolean skipOglTextureTest = false;\n+\n+    public static void main(String[] args) {\n+        boolean show = false;\n+        for (String arg : args) {\n+            if (\"-show\".equals(arg)) {\n+                show = true;\n+            }\n+        }\n+\n+        String arch = System.getProperty(\"os.arch\");\n+        boolean isOglEnabled = Boolean.getBoolean(\"sun.java2d.opengl\");\n+        skipOglTextureTest = false;\n+        System.out.println(\"Skip OpenGL texture test: \" + skipOglTextureTest);\n+\n+        DrawImageBilinear test = new DrawImageBilinear();\n+        Frame frame = new Frame();\n@@ -138,3 +177,0 @@\n-        frame.setUndecorated(true);\n-        frame.setAlwaysOnTop(true);\n-        frame.setLocationRelativeTo(null);\n@@ -143,1 +179,0 @@\n-    }\n@@ -145,21 +180,8 @@\n-    public static void main(String[] args) throws Exception {\n-        try {\n-            EventQueue.invokeAndWait(() -> createAndShowGUI());\n-            GraphicsConfiguration gc = frame.getGraphicsConfiguration();\n-            if (gc.getColorModel() instanceof IndexColorModel) {\n-                System.out.println(\"IndexColorModel detected: \" +\n-                                   \"test considered PASSED\");\n-                return;\n-            }\n-            Robot robot = new Robot();\n-            robot.setAutoDelay(100);\n-            robot.mouseMove(0,0);\n-            robot.waitForIdle();\n-            Point pt1 = frame.getLocationOnScreen();\n-            Rectangle rect =\n-                new Rectangle(pt1.x, pt1.y,\n-                    frame.getWidth(), frame.getHeight());\n-            capture = robot.createScreenCapture(rect);\n-            robot.waitForIdle();\n-            if (capture == null) {\n-                throw new RuntimeException(\"Failed: capture is null\");\n+        \/\/ Wait until the component's been painted\n+        synchronized (test) {\n+            while (!done) {\n+                try {\n+                    test.wait();\n+                } catch (InterruptedException e) {\n+                    throw new RuntimeException(\"Failed: Interrupted\");\n+                }\n@@ -167,0 +189,1 @@\n+        }\n@@ -168,6 +191,7 @@\n-            \/\/ Test background color\n-            int pixel = capture.getRGB(5, 5);\n-            if (pixel != 0xffffffff) {\n-                throw new RuntimeException(\"Failed: Incorrect color for \" +\n-                                           \"background\");\n-            }\n+        GraphicsConfiguration gc = frame.getGraphicsConfiguration();\n+        if (gc.getColorModel() instanceof IndexColorModel) {\n+            System.out.println(\"IndexColorModel detected: \" +\n+                               \"test considered PASSED\");\n+            frame.dispose();\n+            return;\n+        }\n@@ -175,8 +199,2 @@\n-            \/\/ Test pixels\n-            testRegion(capture, new Rectangle(10, 10, 40, 40));\n-            testRegion(capture, new Rectangle(80, 10, 40, 40));\n-            testRegion(capture, new Rectangle(150, 10, 40, 40));\n-        } finally {\n-            if (frame != null) {\n-                frame.dispose();\n-            }\n+        if (!show) {\n+            frame.dispose();\n@@ -184,0 +202,15 @@\n+        if (capture == null) {\n+            throw new RuntimeException(\"Failed: capture is null\");\n+        }\n+\n+        \/\/ Test background color\n+        int pixel = capture.getRGB(5, 5);\n+        if (pixel != 0xffffffff) {\n+            throw new RuntimeException(\"Failed: Incorrect color for \" +\n+                                       \"background\");\n+        }\n+\n+        \/\/ Test pixels\n+        testRegion(capture, new Rectangle(10, 10, 40, 40));\n+        testRegion(capture, new Rectangle(80, 10, 40, 40));\n+        testRegion(capture, new Rectangle(150, 10, 40, 40));\n","filename":"test\/jdk\/sun\/java2d\/SunGraphics2D\/DrawImageBilinear.java","additions":84,"deletions":51,"binary":false,"changes":135,"status":"modified"},{"patch":"@@ -47,1 +47,0 @@\n- * @run main\/othervm\/timeout=600 UnexpectedSourceImageSize\n","filename":"test\/jdk\/sun\/java2d\/cmm\/ColorConvertOp\/UnexpectedSourceImageSize.java","additions":0,"deletions":1,"binary":false,"changes":1,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2015, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2015, 2016, Oracle and\/or its affiliates. All rights reserved.\n@@ -34,6 +34,5 @@\n-    public static String toHexString(double f) {\n-        if (!Double.isNaN(f)) {\n-            return Double.toHexString(f);\n-        } else {\n-            return \"NaN(0x\" + Long.toHexString(Double.doubleToRawLongBits(f)) + \")\";\n-        }\n+    public static String toHexString(float f) {\n+        if (!Float.isNaN(f))\n+            return Float.toHexString(f);\n+        else\n+            return \"NaN(0x\" + Integer.toHexString(Float.floatToRawIntBits(f)) + \")\";\n@@ -42,3 +41,3 @@\n-    public static int test(String testName, double input,\n-                           double result, double expected) {\n-        if (Double.compare(expected, result) != 0) {\n+    public static int test(String testName, float input,\n+                           float result, float expected) {\n+        if (Float.compare(expected, result) != 0) {\n@@ -55,2 +54,2 @@\n-    public static int test_skip_0(String testName, double input,\n-                           double result, double expected)\n+    public static int test_skip_0(String testName, float input,\n+                           float result, float expected)\n@@ -60,1 +59,1 @@\n-        if (Double.compare(expected, result) != 0 && (expected != 0.0))\n+        if (Float.compare(expected, result) != 0 && (expected != 0f))\n@@ -72,1 +71,1 @@\n-    private static int testCeilCase(double input, double expected) {\n+    private static int testCeilCase(float input, float expected) {\n@@ -74,0 +73,2 @@\n+        \/\/ float result:\n+        failures += test(\"FloatMath.ceil_f\", input, FloatMath.ceil_f(input), expected);\n@@ -76,0 +77,1 @@\n+        failures += test(\"FloatMath.ceil_f (int)\", input, (int)FloatMath.ceil_f(input), (int)expected);\n@@ -79,1 +81,1 @@\n-    private static int testFloorCase(double input, double expected) {\n+    private static int testFloorCase(float input, float expected) {\n@@ -81,0 +83,2 @@\n+        \/\/ float result:\n+        failures += test       (\"FloatMath.floor_f\", input, FloatMath.floor_f(input), expected);\n@@ -83,0 +87,1 @@\n+        failures += test_skip_0(\"FloatMath.floor_f (int)\", input, (int)FloatMath.floor_f(input), (int)expected);\n@@ -89,7 +94,7 @@\n-        double [] fixedPoints = {\n-            -0.0,\n-             0.0,\n-            -1.0,\n-             1.0,\n-            -0x1.0p52,\n-             0x1.0p52,\n+        float [] fixedPoints = {\n+            -0.0f,\n+             0.0f,\n+            -1.0f,\n+             1.0f,\n+            -0x1.0p52f,\n+             0x1.0p52f,\n@@ -103,1 +108,1 @@\n-        for(double fixedPoint : fixedPoints) {\n+        for(float fixedPoint : fixedPoints) {\n@@ -109,3 +114,3 @@\n-            double powerOfTwo   = Math.scalb(1.0f, i);\n-            double neighborDown = Math.nextDown(powerOfTwo);\n-            double neighborUp   = Math.nextUp(powerOfTwo);\n+            float powerOfTwo   = Math.scalb(1.0f, i);\n+            float neighborDown = Math.nextDown(powerOfTwo);\n+            float neighborUp   = Math.nextUp(powerOfTwo);\n@@ -114,2 +119,2 @@\n-                failures += testCeilCase( powerOfTwo,  1.0);\n-                failures += testCeilCase(-powerOfTwo, -0.0);\n+                failures += testCeilCase( powerOfTwo,  1.0f);\n+                failures += testCeilCase(-powerOfTwo, -0.0f);\n@@ -117,2 +122,2 @@\n-                failures += testFloorCase( powerOfTwo,  0.0);\n-                failures += testFloorCase(-powerOfTwo, -1.0);\n+                failures += testFloorCase( powerOfTwo,  0.0f);\n+                failures += testFloorCase(-powerOfTwo, -1.0f);\n@@ -120,2 +125,2 @@\n-                failures += testCeilCase( neighborDown, 1.0);\n-                failures += testCeilCase(-neighborDown, -0.0);\n+                failures += testCeilCase( neighborDown, 1.0f);\n+                failures += testCeilCase(-neighborDown, -0.0f);\n@@ -123,2 +128,2 @@\n-                failures += testFloorCase( neighborUp,  0.0);\n-                failures += testFloorCase(-neighborUp, -1.0);\n+                failures += testFloorCase( neighborUp,  0.0f);\n+                failures += testFloorCase(-neighborUp, -1.0f);\n@@ -154,3 +159,3 @@\n-            double f = (double) i;\n-            double neighborDown = Math.nextDown(f);\n-            double neighborUp   = Math.nextUp(f);\n+            float f = (float) i;\n+            float neighborDown = Math.nextDown(f);\n+            float neighborUp   = Math.nextUp(f);\n@@ -178,7 +183,13 @@\n-        double [][] testCases = {\n-            { Float.MIN_VALUE,                           1.0},\n-            {-Float.MIN_VALUE,                          -0.0},\n-            { Math.nextDown(Float.MIN_NORMAL),           1.0},\n-            {-Math.nextDown(Float.MIN_NORMAL),          -0.0},\n-            { Float.MIN_NORMAL,                          1.0},\n-            {-Float.MIN_NORMAL,                         -0.0},\n+        float [][] testCases = {\n+            { Float.MIN_VALUE,                           1.0f},\n+            {-Float.MIN_VALUE,                          -0.0f},\n+            { Math.nextDown(Float.MIN_NORMAL),           1.0f},\n+            {-Math.nextDown(Float.MIN_NORMAL),          -0.0f},\n+            { Float.MIN_NORMAL,                          1.0f},\n+            {-Float.MIN_NORMAL,                         -0.0f},\n+\n+            { 0.1f,                                        1.0f},\n+            {-0.1f,                                       -0.0f},\n+\n+            { 0.5f,                                        1.0f},\n+            {-0.5f,                                       -0.0f},\n@@ -186,2 +197,2 @@\n-            { 0.1,                                        1.0},\n-            {-0.1,                                       -0.0},\n+            { 1.5f,                                        2.0f},\n+            {-1.5f,                                       -1.0f},\n@@ -189,2 +200,2 @@\n-            { 0.5,                                        1.0},\n-            {-0.5,                                       -0.0},\n+            { 2.5f,                                        3.0f},\n+            {-2.5f,                                       -2.0f},\n@@ -192,2 +203,2 @@\n-            { 1.5,                                        2.0},\n-            {-1.5,                                       -1.0},\n+            { 12.3456789f,                                13.0f},\n+            {-12.3456789f,                               -12.0f},\n@@ -195,2 +206,2 @@\n-            { 2.5,                                        3.0},\n-            {-2.5,                                       -2.0},\n+            { Math.nextDown(1.0f),                         1.0f},\n+            { Math.nextDown(-1.0f),                       -1.0f},\n@@ -198,2 +209,2 @@\n-            { 12.3456789,                                13.0},\n-            {-12.3456789,                               -12.0},\n+            { Math.nextUp(1.0f),                           2.0f},\n+            { Math.nextUp(-1.0f),                         -0.0f},\n@@ -201,2 +212,2 @@\n-            { Math.nextDown(1.0),                         1.0},\n-            { Math.nextDown(-1.0),                       -1.0},\n+            { 0x1.0p22f,                                 0x1.0p22f},\n+            {-0x1.0p22f,                                -0x1.0p22f},\n@@ -204,2 +215,2 @@\n-            { Math.nextUp(1.0),                           2.0},\n-            { Math.nextUp(-1.0),                         -0.0},\n+            { Math.nextDown(0x1.0p22f),                  0x1.0p22f},\n+            {-Math.nextUp(0x1.0p22f),                   -0x1.0p22f},\n@@ -207,2 +218,2 @@\n-            { 0x1.0p22,                                 0x1.0p22},\n-            {-0x1.0p22,                                -0x1.0p22},\n+            { Math.nextUp(0x1.0p22f),                    0x1.0p22f+1f},\n+            {-Math.nextDown(0x1.0p22f),                 -0x1.0p22f+1f},\n@@ -210,2 +221,2 @@\n-            { Math.nextDown(0x1.0p22),                  0x1.0p22},\n-            {-Math.nextUp(0x1.0p22),                   -0x1.0p22},\n+            { Math.nextDown(0x1.0p23f),                  0x1.0p23f},\n+            {-Math.nextUp(0x1.0p23f),                   -0x1.0p23f-1f},\n@@ -213,2 +224,2 @@\n-            { Math.nextUp(0x1.0p22),                    0x1.0p22 + 1.0},\n-            {-Math.nextDown(0x1.0p22),                 -0x1.0p22 + 1.0}\n+            { Math.nextUp(0x1.0p23f),                    0x1.0p23f+1f},\n+            {-Math.nextDown(0x1.0p23f),                 -0x1.0p23f+1f},\n@@ -217,1 +228,1 @@\n-        for(double[] testCase : testCases) {\n+        for(float[] testCase : testCases) {\n","filename":"test\/jdk\/sun\/java2d\/marlin\/CeilAndFloorTests.java","additions":76,"deletions":65,"binary":false,"changes":141,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2009, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2009, Oracle and\/or its affiliates. All rights reserved.\n@@ -32,0 +32,2 @@\n+import javax.swing.JButton;\n+import javax.swing.JFrame;\n@@ -33,0 +35,1 @@\n+import javax.swing.WindowConstants;\n@@ -60,4 +63,4 @@\n-                @Override\n-                public void run() {\n-                    drawGui();\n-                }\n+            @Override\n+            public void run() {\n+                drawGui();\n+            }\n@@ -65,1 +68,1 @@\n-                });\n+            });\n","filename":"test\/jdk\/sun\/java2d\/marlin\/DashStrokeTest.java","additions":9,"deletions":6,"binary":false,"changes":15,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2018, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2018, Oracle and\/or its affiliates. All rights reserved.\n@@ -62,1 +62,1 @@\n-        System.out.println(\"DashedRectTest: size = \" + size);\n+        System.out.println(\"DashedRectClipTest: size = \" + size);\n@@ -98,1 +98,1 @@\n-                    final File file = new File(\"DashedRectTest-MAX-\" + MAX + \"-dashed.png\");\n+                    final File file = new File(\"DashedRectClipTest-MAX-\" + MAX + \"-dashed.png\");\n","filename":"test\/jdk\/sun\/java2d\/marlin\/DashedRectTest.java","additions":3,"deletions":3,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -1,148 +0,0 @@\n-\/*\n- * Copyright (c) 2022, Oracle and\/or its affiliates. All rights reserved.\n- * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n- *\n- * This code is free software; you can redistribute it and\/or modify it\n- * under the terms of the GNU General Public License version 2 only, as\n- * published by the Free Software Foundation.\n- *\n- * This code is distributed in the hope that it will be useful, but WITHOUT\n- * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n- * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n- * version 2 for more details (a copy is included in the LICENSE file that\n- * accompanied this code).\n- *\n- * You should have received a copy of the GNU General Public License version\n- * 2 along with this work; if not, write to the Free Software Foundation,\n- * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n- *\n- * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n- * or visit www.oracle.com if you need additional information or have any\n- * questions.\n- *\/\n-\n-import java.awt.BasicStroke;\n-import java.awt.Color;\n-import java.awt.Graphics2D;\n-import java.awt.RenderingHints;\n-import java.awt.geom.Path2D;\n-import java.awt.image.BufferedImage;\n-import java.io.File;\n-import java.io.IOException;\n-import javax.imageio.ImageIO;\n-\n-\/**\n- * Clip rendering test\n- *\n- * @test\n- * @bug 8297230\n- * @summary verify that huge polygon is properly rasterized\n- *\/\n-public class HugePolygonClipTest {\n-\n-    private static final double LARGE_X_COORDINATE = 4194304.250;\n-    private static final int SCENE_WIDTH = 600;\n-    private static final int SCENE_HEIGHT = 400;\n-\n-    private static final float WIDTH = 2.73f;\n-\n-    private static final int G_MASK = 0x0000ff00;\n-    private static final int R_MASK = 0x00ff0000;\n-    private static final int RGB_MASK = 0x00ffffff;\n-\n-    static final boolean SAVE_IMAGE = false;\n-\n-    public static void main(final String[] args) {\n-\n-        \/\/ First display which renderer is tested:\n-        \/\/ JDK9 only:\n-        System.setProperty(\"sun.java2d.renderer.verbose\", \"true\");\n-\n-        \/\/ enable Marlin logging:\n-        System.setProperty(\"sun.java2d.renderer.log\", \"true\");\n-        System.setProperty(\"sun.java2d.renderer.clip\", \"true\");\n-        System.setProperty(\"sun.java2d.renderer.subPixel_log2_X\", \"8\");\n-\n-        System.out.println(\"HugePolygonClipTest: size = \" + SCENE_WIDTH + \" x \" + SCENE_HEIGHT);\n-\n-        final BufferedImage image = new BufferedImage(SCENE_WIDTH, SCENE_HEIGHT, BufferedImage.TYPE_INT_ARGB);\n-\n-        final Graphics2D g2d = (Graphics2D) image.getGraphics();\n-        try {\n-            g2d.setBackground(Color.BLACK);\n-            g2d.clearRect(0, 0, SCENE_WIDTH, SCENE_HEIGHT);\n-\n-            g2d.setRenderingHint(RenderingHints.KEY_ANTIALIASING, RenderingHints.VALUE_ANTIALIAS_ON);\n-            g2d.setRenderingHint(RenderingHints.KEY_RENDERING, RenderingHints.VALUE_RENDER_QUALITY);\n-            g2d.setRenderingHint(RenderingHints.KEY_STROKE_CONTROL, RenderingHints.VALUE_STROKE_PURE);\n-\n-            \/\/ original test case => large moveTo in Filler but no bug in Stroker:\n-            double longWidth = LARGE_X_COORDINATE + SCENE_WIDTH + 0.001;\n-\n-            final Path2D veryWidePolygon = new Path2D.Double();\n-            veryWidePolygon.moveTo(longWidth, 50.0);\n-            veryWidePolygon.lineTo(longWidth, 100.0);\n-            veryWidePolygon.lineTo(0.0, 100.0);\n-            veryWidePolygon.lineTo(0.0, 0.0);\n-            veryWidePolygon.closePath();\n-\n-            g2d.translate(-longWidth + SCENE_WIDTH, 100.0);\n-\n-            g2d.setPaint(Color.RED);\n-            g2d.fill(veryWidePolygon);\n-\n-            g2d.setPaint(Color.GREEN);\n-            g2d.setStroke(new BasicStroke(WIDTH));\n-            g2d.draw(veryWidePolygon);\n-\n-            if (SAVE_IMAGE) {\n-                try {\n-                    final File file = new File(\"TestHugePolygonCoords.png\");\n-\n-                    System.out.println(\"Writing file: \" + file.getAbsolutePath());\n-                    ImageIO.write(image, \"PNG\", file);\n-                } catch (IOException ex) {\n-                    ex.printStackTrace();\n-                }\n-            }\n-\n-            \/\/ Check image on few pixels:\n-            final int x = SCENE_WIDTH \/ 2;\n-            checkColumn(image, x, SCENE_HEIGHT);\n-\n-        } finally {\n-            g2d.dispose();\n-        }\n-    }\n-\n-    private static void checkColumn(final BufferedImage image, final int x, final int maxY) {\n-        boolean trigger = false;\n-        boolean inside = false;\n-\n-        for (int y = 0; y < maxY; y++) {\n-            final int rgb = image.getRGB(x, y);\n-            \/\/ System.out.println(\"pixel at (\" + x + \", \" + y + \") = \" + rgb);\n-\n-            if ((rgb & G_MASK) != 0) {\n-                if (!trigger) {\n-                    trigger = true;\n-                    inside = !inside;\n-                    \/\/ System.out.println(\"inside: \"+inside);\n-                }\n-            } else {\n-                trigger = false;\n-\n-                final int mask = (inside) ? R_MASK : RGB_MASK;\n-\n-                final int expected = (rgb & mask);\n-\n-                \/\/ System.out.println(\"pix[\" + y + \"] = \" + expected + \" inside: \" + inside);\n-                if ((inside && (expected == 0))\n-                        || (!inside && (expected != 0))) {\n-                    throw new IllegalStateException(\"bad pixel at (\" + x + \", \" + y\n-                            + \") = \" + expected + \" inside: \" + inside);\n-                }\n-            }\n-        }\n-    }\n-}\n","filename":"test\/jdk\/sun\/java2d\/marlin\/HugePolygonClipTest.java","additions":0,"deletions":148,"binary":false,"changes":148,"status":"deleted"},{"patch":"@@ -82,4 +82,3 @@\n-        X509CRLImpl crl = X509CRLImpl.newSigned(\n-                new X509CRLImpl.TBSCertList(new X500Name(\"CN=Issuer\"),\n-                        new Date(), new Date()),\n-                kp.getPrivate(), name);\n+        X509CRLImpl crl = new X509CRLImpl(\n+                new X500Name(\"CN=Issuer\"), new Date(), new Date());\n+        crl.sign(kp.getPrivate(), name);\n","filename":"test\/jdk\/sun\/security\/ec\/ed\/EdCRLSign.java","additions":3,"deletions":4,"binary":false,"changes":7,"status":"modified"},{"patch":"@@ -118,1 +118,1 @@\n-        signerInfo.encode(strm);\n+        signerInfo.derEncode(strm);\n@@ -129,1 +129,1 @@\n-            signerInfos[i].encode(strm);\n+            signerInfos[i].derEncode(strm);\n@@ -257,1 +257,2 @@\n-        certLocal = X509CertImpl.newSigned(info, privateKey, algId.getName());\n+        certLocal = new X509CertImpl(info);\n+        certLocal.sign(privateKey, algId.getName());\n","filename":"test\/jdk\/sun\/security\/pkcs\/pkcs7\/SignerOrder.java","additions":4,"deletions":3,"binary":false,"changes":7,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2020, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2020, Oracle and\/or its affiliates. All rights reserved.\n@@ -26,1 +26,1 @@\n- * @bug 8239950 8296736\n+ * @bug 8239950\n@@ -36,1 +36,0 @@\n-import sun.security.util.DerOutputStream;\n@@ -127,3 +126,0 @@\n-\n-                put(\"SigningCertificateInfo\",\n-                    \"3018060b2a864886f70d010910020c3109300730053003040100\");\n@@ -169,1 +165,1 @@\n-                \/\/ Decode each HEX test vector into DER and place into\n+                \/\/ Decode each Base64 test vector into DER and place into\n@@ -173,10 +169,0 @@\n-\n-                \/\/ There is a value inside\n-                if (p9Attr.getValue() == null) {\n-                    throw new IOException(\"Empty attribute\");\n-                }\n-\n-                \/\/ Encoding is supported\n-                DerOutputStream dos = new DerOutputStream();\n-                p9Attr.encode(dos);\n-\n","filename":"test\/jdk\/sun\/security\/pkcs\/pkcs9\/PKCS9AttrTypeTests.java","additions":3,"deletions":17,"binary":false,"changes":20,"status":"modified"},{"patch":"@@ -61,1 +61,1 @@\n-        p2.encode(dout);\n+        p2.derEncode(dout);\n@@ -79,1 +79,1 @@\n-        p3.encode(dout);\n+        p3.derEncode(dout);\n","filename":"test\/jdk\/sun\/security\/pkcs\/pkcs9\/UnknownAttribute.java","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -72,3 +72,2 @@\n-        X509CRLImpl crl = X509CRLImpl.newSigned(\n-                new X509CRLImpl.TBSCertList(owner, date, date, badCerts),\n-                privateKey, sigAlgName);\n+        X509CRLImpl crl = new X509CRLImpl(owner, date, date, badCerts);\n+        crl.sign(privateKey, sigAlgName);\n","filename":"test\/jdk\/sun\/security\/provider\/X509Factory\/BigCRL.java","additions":2,"deletions":3,"binary":false,"changes":5,"status":"modified"},{"patch":"@@ -52,3 +52,3 @@\n-        X509CRLImpl crl = X509CRLImpl.newSigned(\n-                new X509CRLImpl.TBSCertList(new X500Name(\"CN=Issuer\"), new Date(), new Date()),\n-                kpg.generateKeyPair().getPrivate(), \"RSASSA-PSS\");\n+        X509CRLImpl crl = new X509CRLImpl(\n+                new X500Name(\"CN=Issuer\"), new Date(), new Date());\n+        crl.sign(kpg.generateKeyPair().getPrivate(), \"RSASSA-PSS\");\n","filename":"test\/jdk\/sun\/security\/rsa\/pss\/DefaultParamSpec.java","additions":3,"deletions":3,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -228,1 +228,1 @@\n-        return new X509CertImpl(null, null, null, new byte[0]) {\n+        return new X509CertImpl() {\n","filename":"test\/jdk\/sun\/security\/util\/HostnameChecker\/TestHostnameChecker.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -158,5 +158,0 @@\n-\n-        @Override\n-        public long[] getLimbs() {\n-            return null;\n-        }\n","filename":"test\/jdk\/sun\/security\/util\/math\/BigIntegerModuloP.java","additions":0,"deletions":5,"binary":false,"changes":5,"status":"modified"},{"patch":"@@ -1,49 +0,0 @@\n-\/*\n- * Copyright (c) 2022, Oracle and\/or its affiliates. All rights reserved.\n- * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n- *\n- * This code is free software; you can redistribute it and\/or modify it\n- * under the terms of the GNU General Public License version 2 only, as\n- * published by the Free Software Foundation.\n- *\n- * This code is distributed in the hope that it will be useful, but WITHOUT\n- * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n- * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n- * version 2 for more details (a copy is included in the LICENSE file that\n- * accompanied this code).\n- *\n- * You should have received a copy of the GNU General Public License version\n- * 2 along with this work; if not, write to the Free Software Foundation,\n- * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n- *\n- * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n- * or visit www.oracle.com if you need additional information or have any\n- * questions.\n- *\/\n-\n-\/*\n- * @test\n- * @bug 8296442\n- * @summary EncryptedPrivateKeyInfo can be created with an uninitialized AlgorithmParameters\n- * @modules java.base\/sun.security.x509\n- *\/\n-\n-import sun.security.x509.AlgorithmId;\n-\n-import java.security.AlgorithmParameters;\n-\n-public class Uninitialized {\n-    public static void main(String[] args) throws Exception {\n-        AlgorithmParameters ap = AlgorithmParameters.getInstance(\"EC\");\n-        boolean success;\n-        try {\n-            AlgorithmId.get(ap);\n-            success = true;\n-        } catch (Exception e) {\n-            success = false;\n-        }\n-        if (success) {\n-            throw new RuntimeException();\n-        }\n-    }\n-}\n","filename":"test\/jdk\/sun\/security\/x509\/AlgorithmId\/Uninitialized.java","additions":0,"deletions":49,"binary":false,"changes":49,"status":"deleted"},{"patch":"@@ -1,51 +0,0 @@\n-\/*\n- * Copyright (c) 2022, Oracle and\/or its affiliates. All rights reserved.\n- * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n- *\n- * This code is free software; you can redistribute it and\/or modify it\n- * under the terms of the GNU General Public License version 2 only, as\n- * published by the Free Software Foundation.\n- *\n- * This code is distributed in the hope that it will be useful, but WITHOUT\n- * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n- * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n- * version 2 for more details (a copy is included in the LICENSE file that\n- * accompanied this code).\n- *\n- * You should have received a copy of the GNU General Public License version\n- * 2 along with this work; if not, write to the Free Software Foundation,\n- * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n- *\n- * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n- * or visit www.oracle.com if you need additional information or have any\n- * questions.\n- *\/\n-\n-\/* @test\n- * @bug 8296900\n- * @summary CertificateValidity fields are not be optional\n- * @library \/test\/lib\n- * @modules java.base\/sun.security.x509\n- *\/\n-\n-import jdk.test.lib.Utils;\n-import sun.security.x509.CertificateValidity;\n-\n-import java.util.Date;\n-\n-public class NullName {\n-\n-    public static void main(String[] argv) throws Exception {\n-        Date now = new Date();\n-        Utils.runAndCheckException(\n-                () -> new CertificateValidity(null, null),\n-                NullPointerException.class);\n-        Utils.runAndCheckException(\n-                () -> new CertificateValidity(now, null),\n-                NullPointerException.class);\n-        Utils.runAndCheckException(\n-                () -> new CertificateValidity(null, now),\n-                NullPointerException.class);\n-        new CertificateValidity(now, now);\n-    }\n-}\n","filename":"test\/jdk\/sun\/security\/x509\/CertificateValidity\/NullName.java","additions":0,"deletions":51,"binary":false,"changes":51,"status":"deleted"},{"patch":"@@ -1,48 +0,0 @@\n-\/*\n- * Copyright (c) 2022, Oracle and\/or its affiliates. All rights reserved.\n- * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n- *\n- * This code is free software; you can redistribute it and\/or modify it\n- * under the terms of the GNU General Public License version 2 only, as\n- * published by the Free Software Foundation.\n- *\n- * This code is distributed in the hope that it will be useful, but WITHOUT\n- * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n- * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n- * version 2 for more details (a copy is included in the LICENSE file that\n- * accompanied this code).\n- *\n- * You should have received a copy of the GNU General Public License version\n- * 2 along with this work; if not, write to the Free Software Foundation,\n- * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n- *\n- * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n- * or visit www.oracle.com if you need additional information or have any\n- * questions.\n- *\/\n-\n-\/* @test\n- * @bug 8296741\n- * @summary Illegal X400Address and EDIPartyName should not be created\n- * @library \/test\/lib\n- * @modules java.base\/sun.security.x509\n- *\/\n-\n-import jdk.test.lib.Utils;\n-import sun.security.x509.EDIPartyName;\n-\n-public class NullName {\n-\n-    public static void main(String[] argv) throws Exception {\n-        Utils.runAndCheckException(\n-                () -> new EDIPartyName((String)null),\n-                NullPointerException.class);\n-        Utils.runAndCheckException(\n-                () -> new EDIPartyName(null, null),\n-                NullPointerException.class);\n-        Utils.runAndCheckException(\n-                () -> new EDIPartyName(\"hello\", null),\n-                NullPointerException.class);\n-        new EDIPartyName(null, \"hello\");\n-    }\n-}\n","filename":"test\/jdk\/sun\/security\/x509\/EDIPartyName\/NullName.java","additions":0,"deletions":48,"binary":false,"changes":48,"status":"deleted"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2015, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2015, Oracle and\/or its affiliates. All rights reserved.\n@@ -30,1 +30,0 @@\n- *          java.base\/sun.security.util\n@@ -33,3 +32,0 @@\n-import sun.security.util.ObjectIdentifier;\n-import sun.security.x509.CertificatePolicyId;\n-import sun.security.x509.CertificatePolicyMap;\n@@ -39,2 +35,0 @@\n-import java.util.List;\n-\n@@ -43,1 +37,1 @@\n-        PolicyConstraintsExtension pce = new PolicyConstraintsExtension(1, 1);\n+        PolicyConstraintsExtension pce = new PolicyConstraintsExtension(-1,-1);\n@@ -49,3 +43,1 @@\n-        CertificatePolicyId id = new CertificatePolicyId(ObjectIdentifier.of(\"1.2.3.4\"));\n-        PolicyMappingsExtension pme = new PolicyMappingsExtension(List.of(\n-                new CertificatePolicyMap(id, id)));\n+        PolicyMappingsExtension pme = new PolicyMappingsExtension();\n","filename":"test\/jdk\/sun\/security\/x509\/Extensions\/DefaultCriticality.java","additions":3,"deletions":11,"binary":false,"changes":14,"status":"modified"},{"patch":"@@ -1,141 +0,0 @@\n-\/*\n- * Copyright (c) 2022, Oracle and\/or its affiliates. All rights reserved.\n- * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n- *\n- * This code is free software; you can redistribute it and\/or modify it\n- * under the terms of the GNU General Public License version 2 only, as\n- * published by the Free Software Foundation.\n- *\n- * This code is distributed in the hope that it will be useful, but WITHOUT\n- * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n- * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n- * version 2 for more details (a copy is included in the LICENSE file that\n- * accompanied this code).\n- *\n- * You should have received a copy of the GNU General Public License version\n- * 2 along with this work; if not, write to the Free Software Foundation,\n- * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n- *\n- * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n- * or visit www.oracle.com if you need additional information or have any\n- * questions.\n- *\/\n-\n-\/*\n- * @test\n- * @bug 8296742\n- * @summary Illegal X509 Extension should not be created\n- * @modules java.base\/sun.security.util\n- *          java.base\/sun.security.x509\n- * @library \/test\/lib\n- *\/\n-\n-import jdk.test.lib.Utils;\n-import sun.security.util.ObjectIdentifier;\n-import sun.security.x509.*;\n-\n-import java.math.BigInteger;\n-import java.util.Collections;\n-import java.util.Date;\n-import java.util.List;\n-import java.util.Vector;\n-\n-public class IllegalExtensions {\n-\n-    public static void main(String [] args) throws Exception {\n-\n-        var oid = ObjectIdentifier.of(\"1.2.3.4\");\n-        var emptyNames = new GeneralNames();\n-        var name = new GeneralName(new X500Name(\"CN=one\"));\n-        var names = new GeneralNames();\n-        names.add(name);\n-\n-        var ad = new AccessDescription(AccessDescription.Ad_CAISSUERS_Id, name);\n-        new AuthorityInfoAccessExtension(List.of(ad));\n-        Utils.runAndCheckException(() -> new AuthorityInfoAccessExtension(List.of()), IllegalArgumentException.class);\n-        Utils.runAndCheckException(() -> new AuthorityInfoAccessExtension(null), IllegalArgumentException.class);\n-\n-        var kid = new KeyIdentifier(new byte[32]);\n-        var sn = new SerialNumber(0);\n-        new AuthorityKeyIdentifierExtension(kid, null, null);\n-        new AuthorityKeyIdentifierExtension(null, names, null);\n-        new AuthorityKeyIdentifierExtension(null, null, sn);\n-        Utils.runAndCheckException(() -> new AuthorityKeyIdentifierExtension(null, null, null), IllegalArgumentException.class);\n-\n-        new CertificateIssuerExtension(names);\n-        Utils.runAndCheckException(() -> new CertificateIssuerExtension(null), IllegalArgumentException.class);\n-        Utils.runAndCheckException(() -> new CertificateIssuerExtension(emptyNames), IllegalArgumentException.class);\n-\n-        var pi = new PolicyInformation(new CertificatePolicyId(oid), Collections.emptySet());\n-        new CertificatePoliciesExtension(List.of(pi));\n-        Utils.runAndCheckException(() -> new CertificatePoliciesExtension(null), IllegalArgumentException.class);\n-        Utils.runAndCheckException(() -> new CertificatePoliciesExtension(List.of()), IllegalArgumentException.class);\n-\n-        var dp = new DistributionPoint(names, null, null);\n-        new CRLDistributionPointsExtension(List.of(dp));\n-        Utils.runAndCheckException(() -> new CRLDistributionPointsExtension(List.of()), IllegalArgumentException.class);\n-        Utils.runAndCheckException(() -> new CRLDistributionPointsExtension(null), IllegalArgumentException.class);\n-\n-        new CRLNumberExtension(0);\n-        new CRLNumberExtension(BigInteger.ONE);\n-        Utils.runAndCheckException(() -> new CRLNumberExtension(null), IllegalArgumentException.class);\n-\n-        new CRLReasonCodeExtension(1);\n-        Utils.runAndCheckException(() -> new CRLReasonCodeExtension(0), IllegalArgumentException.class);\n-        Utils.runAndCheckException(() -> new CRLReasonCodeExtension(-1), IllegalArgumentException.class);\n-\n-        new ExtendedKeyUsageExtension(new Vector<>(List.of(oid)));\n-        Utils.runAndCheckException(() -> new ExtendedKeyUsageExtension(null), IllegalArgumentException.class);\n-        Utils.runAndCheckException(() -> new ExtendedKeyUsageExtension(new Vector<>()), IllegalArgumentException.class);\n-\n-        new InhibitAnyPolicyExtension(0);\n-        new InhibitAnyPolicyExtension(-1);\n-        Utils.runAndCheckException(() -> new InhibitAnyPolicyExtension(-2), IllegalArgumentException.class);\n-\n-        new InvalidityDateExtension(new Date());\n-        Utils.runAndCheckException(() -> new InvalidityDateExtension(null), IllegalArgumentException.class);\n-\n-        new IssuerAlternativeNameExtension(names);\n-        Utils.runAndCheckException(() -> new IssuerAlternativeNameExtension(null), IllegalArgumentException.class);\n-        Utils.runAndCheckException(() -> new IssuerAlternativeNameExtension(emptyNames), IllegalArgumentException.class);\n-\n-        var dpn = new DistributionPointName(names);\n-        var rf = new ReasonFlags(new boolean[1]);\n-        new IssuingDistributionPointExtension(dpn, null, false, false, false, false);\n-        new IssuingDistributionPointExtension(null, rf, false, false, false, false);\n-        new IssuingDistributionPointExtension(null, null, true, false, false, false);\n-        new IssuingDistributionPointExtension(null, null, false, true, false, false);\n-        new IssuingDistributionPointExtension(null, null, false, false, true, false);\n-        new IssuingDistributionPointExtension(null, null, false, false, false, true);\n-        Utils.runAndCheckException(() -> new IssuingDistributionPointExtension(null, null, false, false, false, false), IllegalArgumentException.class);\n-\n-        var gss = new GeneralSubtrees();\n-        new NameConstraintsExtension(gss, null);\n-        new NameConstraintsExtension((GeneralSubtrees) null, gss);\n-        Utils.runAndCheckException(() -> new NameConstraintsExtension((GeneralSubtrees) null, null), IllegalArgumentException.class);\n-\n-        new PolicyConstraintsExtension(0, 0);\n-        new PolicyConstraintsExtension(-1, 0);\n-        new PolicyConstraintsExtension(0, -1);\n-        Utils.runAndCheckException(() -> new PolicyConstraintsExtension(-1, -1), IllegalArgumentException.class);\n-\n-        var cpi = new CertificatePolicyId(oid);\n-        var cpm = new CertificatePolicyMap(cpi, cpi);\n-        new PolicyMappingsExtension(List.of(cpm));\n-        Utils.runAndCheckException(() -> new PolicyMappingsExtension(List.of()), IllegalArgumentException.class);\n-        Utils.runAndCheckException(() -> new PolicyMappingsExtension(null), IllegalArgumentException.class);\n-\n-        new PrivateKeyUsageExtension(new Date(), new Date());\n-        new PrivateKeyUsageExtension(new Date(), null);\n-        new PrivateKeyUsageExtension((Date) null, new Date());\n-        Utils.runAndCheckException(() -> new PrivateKeyUsageExtension((Date) null, null), IllegalArgumentException.class);\n-\n-        new SubjectAlternativeNameExtension(names);\n-        Utils.runAndCheckException(() -> new SubjectAlternativeNameExtension(null), IllegalArgumentException.class);\n-        Utils.runAndCheckException(() -> new SubjectAlternativeNameExtension(emptyNames), IllegalArgumentException.class);\n-\n-        new SubjectInfoAccessExtension(List.of(ad));\n-        Utils.runAndCheckException(() -> new SubjectInfoAccessExtension(List.of()), IllegalArgumentException.class);\n-        Utils.runAndCheckException(() -> new SubjectInfoAccessExtension(null), IllegalArgumentException.class);\n-    }\n-}\n","filename":"test\/jdk\/sun\/security\/x509\/Extensions\/IllegalExtensions.java","additions":0,"deletions":141,"binary":false,"changes":141,"status":"deleted"},{"patch":"@@ -58,0 +58,1 @@\n+        X509CRLImpl crl = new X509CRLImpl(owner, new Date(), new Date(), badCerts);\n@@ -59,3 +60,1 @@\n-        X509CRLImpl crl = X509CRLImpl.newSigned(\n-                new X509CRLImpl.TBSCertList(owner, new Date(), new Date(), badCerts),\n-                kpg.genKeyPair().getPrivate(), \"SHA1withRSA\");\n+        crl.sign(kpg.genKeyPair().getPrivate(), \"SHA1withRSA\");\n","filename":"test\/jdk\/sun\/security\/x509\/X509CRLImpl\/OrderAndDup.java","additions":2,"deletions":3,"binary":false,"changes":5,"status":"modified"},{"patch":"@@ -60,1 +60,0 @@\n-import sun.security.util.DerOutputStream;\n@@ -158,0 +157,8 @@\n+        SubjectAlternativeNameExtension subjectName\n+                = new SubjectAlternativeNameExtension();\n+        IssuerAlternativeNameExtension issuerName\n+                = new IssuerAlternativeNameExtension();\n+\n+        GeneralNames subjectNames = subjectName.getNames();\n+\n+        GeneralNames issuerNames = issuerName.getNames();\n@@ -159,1 +166,0 @@\n-        GeneralNames subjectNames = new GeneralNames();\n@@ -163,2 +169,0 @@\n-        SubjectAlternativeNameExtension subjectName\n-                = new SubjectAlternativeNameExtension(subjectNames);\n@@ -166,1 +170,0 @@\n-        GeneralNames issuerNames = new GeneralNames();\n@@ -169,2 +172,0 @@\n-        IssuerAlternativeNameExtension issuerName\n-                = new IssuerAlternativeNameExtension(issuerNames);\n@@ -206,1 +207,2 @@\n-        X509CertImpl crt = X509CertImpl.newSigned(cert, privateKey, sigAlg);\n+        X509CertImpl crt = new X509CertImpl(cert);\n+        crt.sign(privateKey, sigAlg);\n@@ -213,3 +215,1 @@\n-            DerOutputStream dos = new DerOutputStream();\n-            crt.encode(dos);\n-            fos.write(dos.toByteArray());\n+            crt.encode((OutputStream) fos);\n","filename":"test\/jdk\/sun\/security\/x509\/X509CertImpl\/V3Certificate.java","additions":11,"deletions":11,"binary":false,"changes":22,"status":"modified"},{"patch":"@@ -7874,4 +7874,0 @@\n-\n-# tzdata2022f\n-TimeZoneNames\/en\/America\\\/Ojinaga\/1=Central Standard Time\n-TimeZoneNames\/en\/America\\\/Chihuahua\/1=Central Standard Time\n","filename":"test\/jdk\/sun\/text\/resources\/LocaleData.cldr","additions":0,"deletions":4,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -43,1 +43,1 @@\n- *      8251317 8274658 8283277 8283805 8265315 8287868 8295564 8284840 8296715\n+ *      8251317 8274658 8283277 8283805 8265315 8287868 8295564 8284840\n","filename":"test\/jdk\/sun\/text\/resources\/LocaleDataTest.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -105,4 +105,0 @@\n-        javac(dest, List.of(), sourceFiles);\n-    }\n-\n-    void javac(Path dest, List<String> extraParameters, Path... sourceFiles) throws Throwable {\n@@ -120,1 +116,0 @@\n-        commands.addAll(extraParameters);\n@@ -129,0 +124,1 @@\n+\n","filename":"test\/jdk\/tools\/jar\/multiRelease\/MRTestBase.java","additions":1,"deletions":5,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -1,118 +0,0 @@\n-\/*\n- * Copyright (c) 2022, Oracle and\/or its affiliates. All rights reserved.\n- * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n- *\n- * This code is free software; you can redistribute it and\/or modify it\n- * under the terms of the GNU General Public License version 2 only, as\n- * published by the Free Software Foundation.\n- *\n- * This code is distributed in the hope that it will be useful, but WITHOUT\n- * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n- * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n- * version 2 for more details (a copy is included in the LICENSE file that\n- * accompanied this code).\n- *\n- * You should have received a copy of the GNU General Public License version\n- * 2 along with this work; if not, write to the Free Software Foundation,\n- * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n- *\n- * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n- * or visit www.oracle.com if you need additional information or have any\n- * questions.\n- *\/\n-\n-\/*\n-* @test\n-# @bug 8296329\n-* @summary Tests for version validator.\n-* @library \/test\/lib\n-* @modules java.base\/jdk.internal.misc\n-*          jdk.compiler\n-*          jdk.jartool\n-* @build jdk.test.lib.Utils\n-*        jdk.test.lib.Asserts\n-*        jdk.test.lib.JDKToolFinder\n-*        jdk.test.lib.JDKToolLauncher\n-*        jdk.test.lib.Platform\n-*        jdk.test.lib.process.*\n-*        MRTestBase\n-* @run testng\/timeout=1200 VersionValidatorTest\n-*\/\n-\n-import org.testng.annotations.BeforeMethod;\n-import org.testng.annotations.DataProvider;\n-import org.testng.annotations.Test;\n-\n-import java.lang.reflect.Method;\n-import java.nio.file.Files;\n-import java.nio.file.Path;\n-import java.nio.file.Paths;\n-import java.util.List;\n-\n-public class VersionValidatorTest extends MRTestBase {\n-    private Path root;\n-\n-    @BeforeMethod\n-    void testInit(Method method) {\n-        root = Paths.get(method.getName());\n-    }\n-\n-    @Test(dataProvider = \"differentMajorVersions\")\n-    public void onlyCompatibleVersionIsAllowedInMultiReleaseJar(String baseMajorVersion, String otherMajorVersion,\n-            boolean enablePreviewForBaseVersion, boolean enablePreviewForOtherVersion, boolean isAcceptable)\n-            throws Throwable {\n-        Path baseVersionClassesDir = compileLibClass(baseMajorVersion, enablePreviewForBaseVersion);\n-        Path otherVersionClassesDir = compileLibClass(otherMajorVersion, enablePreviewForOtherVersion);\n-\n-        var result = jar(\"--create\", \"--file\", \"lib.jar\", \"-C\", baseVersionClassesDir.toString(), \"Lib.class\",\n-                \"--release\", otherMajorVersion, \"-C\", otherVersionClassesDir.toString(), \"Lib.class\");\n-\n-        if (isAcceptable) {\n-            result.shouldHaveExitValue(SUCCESS)\n-                    .shouldBeEmptyIgnoreVMWarnings();\n-        } else {\n-            result.shouldNotHaveExitValue(SUCCESS)\n-                    .shouldContain(\"has a class version incompatible with an earlier version\");\n-        }\n-    }\n-\n-    private Path compileLibClass(String majorVersion, boolean enablePreview) throws Throwable {\n-        String classTemplate = \"\"\"\n-                public class Lib {\n-                    public static int version = $VERSION;\n-                }\n-                    \"\"\";\n-\n-        Path sourceFile = Files.createDirectories(root.resolve(\"src\").resolve(majorVersion)).resolve(\"Lib.java\");\n-        Files.write(sourceFile, classTemplate.replace(\"$VERSION\", majorVersion).getBytes());\n-\n-        Path classesDir = root.resolve(\"classes\").resolve(majorVersion);\n-\n-        javac(classesDir, List.of(\"--release\", majorVersion), sourceFile);\n-        if (enablePreview) {\n-            rewriteMinorVersionForEnablePreviewClass(classesDir.resolve(\"Lib.class\"));\n-        }\n-        return classesDir;\n-    }\n-\n-    private void rewriteMinorVersionForEnablePreviewClass(Path classFile) throws Throwable {\n-        byte[] classBytes = Files.readAllBytes(classFile);\n-        classBytes[4] = -1;\n-        classBytes[5] = -1;\n-        Files.write(classFile, classBytes);\n-    }\n-\n-    @DataProvider\n-    Object[][] differentMajorVersions() {\n-        return new Object[][] {\n-                { \"19\", \"20\", false, true, true },\n-                { \"19\", \"20\", false, false, true },\n-                { \"19\", \"20\", true, true, true },\n-                { \"19\", \"20\", true, false, true },\n-                { \"20\", \"19\", false, true, false },\n-                { \"20\", \"19\", false, false, false },\n-                { \"20\", \"19\", true, true, false },\n-                { \"20\", \"19\", true, false, false },\n-        };\n-    }\n-}\n","filename":"test\/jdk\/tools\/jar\/multiRelease\/VersionValidatorTest.java","additions":0,"deletions":118,"binary":false,"changes":118,"status":"deleted"},{"patch":"@@ -26,1 +26,1 @@\n- * @bug 8027634 8231863 8293041\n+ * @bug 8027634 8231863\n@@ -225,4 +225,0 @@\n-        \/\/ --disable-@files should never pass to VM\n-        tr = doExec(env, javaCmd, \"@argKill\", \"--disable-@files\", \"--version\");\n-        tr.checkPositive();\n-\n","filename":"test\/jdk\/tools\/launcher\/ArgsFileTest.java","additions":1,"deletions":5,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2017, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2017, Oracle and\/or its affiliates. All rights reserved.\n@@ -28,1 +28,1 @@\n- * @test id=noagent\n+ * @test\n@@ -33,0 +33,1 @@\n+ * @compile TestXcheckJNIWarnings.java\n@@ -35,9 +36,0 @@\n-\n-\/**\n- * @test id=jdwp-agent\n- * @bug 8187442\n- * @summary Launching app with jdwp agent shouldn't produce any jni warnings.\n- * @modules jdk.compiler\n- *          jdk.zipfs\n- * @run main TestXcheckJNIWarnings -agentlib:jdwp=transport=dt_socket,server=y,suspend=n\n- *\/\n@@ -57,8 +49,2 @@\n-\n-        TestResult tr;\n-        if (args.length > 0) {\n-            tr = doExec(javaCmd, \"-jar\", \"-Xcheck:jni\", args[0], testJarFile.getName());\n-        } else {\n-            tr = doExec(javaCmd, \"-jar\", \"-Xcheck:jni\", testJarFile.getName());\n-        }\n-\n+        TestResult tr = doExec(javaCmd, \"-jar\", \"-Xcheck:jni\",\n+                               testJarFile.getName());\n","filename":"test\/jdk\/tools\/launcher\/TestXcheckJNIWarnings.java","additions":5,"deletions":19,"binary":false,"changes":24,"status":"modified"},{"patch":"@@ -38,0 +38,1 @@\n+jdk\/jshell\/CommandCompletionTest.java                                           8295814    linux-all\n@@ -59,0 +60,12 @@\n+###########################################################################\n+#\n+# sjavac\n+\n+tools\/sjavac\/IncCompileFullyQualifiedRef.java                                   8152055    generic-all    Requires dependency code to deal with in-method dependencies.\n+tools\/sjavac\/IncCompileWithChanges.java                                         8152055    generic-all    Requires dependency code to deal with in-method dependencies.\n+\n+tools\/sjavac\/ApiExtraction.java                                                 8158002    generic-all    Requires investigation\n+tools\/sjavac\/IgnoreSymbolFile.java                                              8158002    generic-all    Requires investigation\n+tools\/sjavac\/ClasspathDependencies.java                                         8158002    generic-all    Requires investigation\n+\n+\n","filename":"test\/langtools\/ProblemList.txt","additions":13,"deletions":0,"binary":false,"changes":13,"status":"modified"},{"patch":"@@ -66,0 +66,4 @@\n+langtools_sjavac = \\\n+    tools\/all \\\n+    tools\/sjavac\n+\n","filename":"test\/langtools\/TEST.groups","additions":4,"deletions":0,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2009, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2009, 2021, Oracle and\/or its affiliates. All rights reserved.\n@@ -188,1 +188,1 @@\n-                    <dd><code>java.awt.HeadlessException<\/code><\/dd>\n+                    <dd><code>HeadlessException<\/code><\/dd>\n@@ -307,1 +307,1 @@\n-                    <dd><code>java.awt.HeadlessException<\/code><\/dd>\n+                    <dd><code>HeadlessException<\/code><\/dd>\n","filename":"test\/langtools\/jdk\/javadoc\/doclet\/testHtmlDefinitionListTag\/TestHtmlDefinitionListTag.java","additions":3,"deletions":3,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2009, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2009, 2019, Oracle and\/or its affiliates. All rights reserved.\n@@ -77,1 +77,1 @@\n-     * @exception java.awt.HeadlessException\n+     * @exception HeadlessException\n","filename":"test\/langtools\/jdk\/javadoc\/doclet\/testHtmlDefinitionListTag\/pkg1\/C1.java","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -57,1 +57,1 @@\n-        for (int i = 1; i < 39; i++) {\n+        for (int i = 1; i < 40; i++) {\n","filename":"test\/langtools\/jdk\/javadoc\/doclet\/testTagInheritance\/TestTagInheritance.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2001, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2001, 2003, Oracle and\/or its affiliates. All rights reserved.\n@@ -69,0 +69,1 @@\n+     * @throws java.util.zip.ZipException Test 39 passes.\n","filename":"test\/langtools\/jdk\/javadoc\/doclet\/testTagInheritance\/pkg\/TestAbstractClass.java","additions":2,"deletions":1,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2014, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2014, 2015, Oracle and\/or its affiliates. All rights reserved.\n@@ -32,18 +32,0 @@\n-    \/\/ NOTE: Not sure why this test suggests that IndexOutOfBoundsException\n-    \/\/ should not appear due to compatibility with some buggy behavior.\n-    \/\/\n-    \/\/ Here's the expected behavior: documentation for an exception X is never\n-    \/\/ inherited by an overrider unless it \"pulls\" it by either (or both)\n-    \/\/ of these:\n-    \/\/\n-    \/\/   * tag:\n-    \/\/       @throws X {@inheritDoc}\n-    \/\/   * clause:\n-    \/\/       throws ..., X,...\n-    \/\/\n-    \/\/ Neither of those are applicable here. Even taking into account\n-    \/\/ mechanisms such as the one introduced in 4947455, neither of\n-    \/\/ NullPointerException and IndexOutOfBoundsException is a subclass\n-    \/\/ of the other.\n-    \/\/\n-    \/\/ So, IndexOutOfBoundsException should not appear in Extender.\n","filename":"test\/langtools\/jdk\/javadoc\/doclet\/testThrowsInheritance\/pkg\/Abstract.java","additions":1,"deletions":19,"binary":false,"changes":20,"status":"modified"},{"patch":"@@ -1,490 +0,0 @@\n-\/*\n- * Copyright (c) 2022, Oracle and\/or its affiliates. All rights reserved.\n- * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n- *\n- * This code is free software; you can redistribute it and\/or modify it\n- * under the terms of the GNU General Public License version 2 only, as\n- * published by the Free Software Foundation.\n- *\n- * This code is distributed in the hope that it will be useful, but WITHOUT\n- * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n- * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n- * version 2 for more details (a copy is included in the LICENSE file that\n- * accompanied this code).\n- *\n- * You should have received a copy of the GNU General Public License version\n- * 2 along with this work; if not, write to the Free Software Foundation,\n- * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n- *\n- * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n- * or visit www.oracle.com if you need additional information or have any\n- * questions.\n- *\/\n-\n-\/*\n- * @test\n- * @bug 8291869\n- * @library \/tools\/lib ..\/..\/lib\n- * @modules jdk.compiler\/com.sun.tools.javac.api\n- *          jdk.compiler\/com.sun.tools.javac.main\n- *          jdk.javadoc\/jdk.javadoc.internal.tool\n- * @build toolbox.ToolBox javadoc.tester.*\n- * @run main TestExceptionTypeMatching\n- *\/\n-\n-import javadoc.tester.JavadocTester;\n-import toolbox.ToolBox;\n-\n-import java.nio.file.Path;\n-import java.nio.file.Paths;\n-\n-\/*\n- * The goal of the tests in this suite is two-fold:\n- *\n- * 1. Provoke javadoc into treating like-named but different elements as\n- *    the same element\n- * 2. Provoke javadoc into treating differently named but semantically\n- *    same elements as different elements\n- *\/\n-public class TestExceptionTypeMatching extends JavadocTester {\n-\n-    public static void main(String... args) throws Exception {\n-        var tester = new TestExceptionTypeMatching();\n-        tester.runTests(m -> new Object[]{Paths.get(m.getName())});\n-    }\n-\n-    private final ToolBox tb = new ToolBox();\n-\n-    \/*\n-     * In Child, MyException is c.MyException, whereas in Parent, MyException\n-     * is p.MyException. Those are different exceptions which happen to\n-     * share the simple name.\n-     *\/\n-    @Test\n-    public void testDifferentPackages(Path base) throws Exception {\n-        var src = base.resolve(\"src\");\n-        tb.writeJavaFiles(src, \"\"\"\n-                package c;\n-\n-                import p.Parent;\n-\n-                public class Child extends Parent {\n-\n-                    \/** @throws MyException {@inheritDoc} *\/\n-                    @Override\n-                    public void m() { }\n-                }\n-                \"\"\", \"\"\"\n-                package c;\n-\n-                public class MyException extends RuntimeException { }\n-\n-                \"\"\", \"\"\"\n-                package p;\n-\n-                public class Parent {\n-\n-                    \/** @throws MyException sometimes *\/\n-                    public void m() { }\n-                }\n-                \"\"\", \"\"\"\n-                package p;\n-\n-                public class MyException extends RuntimeException { }\n-                \"\"\");\n-        javadoc(\"-d\", base.resolve(\"out\").toString(), \"-sourcepath\", src.toString(), \"c\", \"p\");\n-        checkExit(Exit.OK);\n-        checkOutput(Output.OUT, true, \"\"\"\n-                Child.java:7: warning: overridden methods do not document exception type c.MyException \\\n-                (module <unnamed module> package c class MyException)\n-                    \/** @throws MyException {@inheritDoc} *\/\n-                        ^\n-                \"\"\");\n-    }\n-\n-    \/*\n-     * Type parameters declared by methods where one of the methods overrides\n-     * the other, are matched by position, not by name. In this example, <P>\n-     * and <R> are semantically the same.\n-     *\/\n-    @Test\n-    public void testDifferentTypeVariables1(Path base) throws Exception {\n-        var src = base.resolve(\"src\");\n-        tb.writeJavaFiles(src, \"\"\"\n-                package x;\n-\n-                public class Parent {\n-\n-                    \/** @throws P sometimes *\/\n-                    public <P extends RuntimeException> void m() { }\n-                }\n-                \"\"\", \"\"\"\n-                package x;\n-\n-                public class Child extends Parent {\n-\n-                    \/** @throws R {@inheritDoc} *\/\n-                    @Override\n-                    public <R extends RuntimeException> void m() { }\n-                }\n-                \"\"\");\n-        javadoc(\"-d\", base.resolve(\"out\").toString(), \"-sourcepath\", src.toString(), \"x\");\n-        checkExit(Exit.OK);\n-        checkOutput(\"x\/Child.html\", true, \"\"\"\n-                <dl class=\"notes\">\n-                <dt>Overrides:<\/dt>\n-                <dd><code><a href=\"Parent.html#m()\">m<\/a><\/code>&nbsp;in class&nbsp;<code>\\\n-                <a href=\"Parent.html\" title=\"class in x\">Parent<\/a><\/code><\/dd>\n-                <dt>Throws:<\/dt>\n-                <dd><code>R<\/code> - sometimes<\/dd>\n-                <\/dl>\n-                \"\"\");\n-    }\n-\n-    \/*\n-     * Type parameters declared by methods where one of the methods overrides\n-     * the other, are matched by position, not by name.\n-     *\n-     * Here the match is criss-cross:\n-     *\n-     *   - Child.m's <K> corresponds to Parent.m's <V>\n-     *   - Child.m's <V> corresponds to Parent.m's <K>\n-     *\/\n-    @Test\n-    public void testDifferentTypeVariables2(Path base) throws Exception {\n-        var src = base.resolve(\"src\");\n-        tb.writeJavaFiles(src, \"\"\"\n-                package x;\n-\n-                public class Parent {\n-\n-                    \/**\n-                     * @throws K some of the times\n-                     * @throws V other times\n-                     *\/\n-                    public <K extends RuntimeException, V extends RuntimeException> void m() { }\n-                }\n-                \"\"\", \"\"\"\n-                package x;\n-\n-                public class Child extends Parent {\n-\n-                    \/**\n-                     * @throws K {@inheritDoc}\n-                     * @throws V {@inheritDoc}\n-                     *\/\n-                    @Override\n-                    public <V extends RuntimeException, K extends RuntimeException> void m() { }\n-                }\n-                \"\"\");\n-        javadoc(\"-d\", base.resolve(\"out\").toString(), \"-sourcepath\", src.toString(), \"x\");\n-        checkExit(Exit.OK);\n-        checkOutput(\"x\/Child.html\", true, \"\"\"\n-                <dl class=\"notes\">\n-                <dt>Overrides:<\/dt>\n-                <dd><code><a href=\"Parent.html#m()\">m<\/a><\/code>&nbsp;in class&nbsp;<code>\\\n-                <a href=\"Parent.html\" title=\"class in x\">Parent<\/a><\/code><\/dd>\n-                <dt>Throws:<\/dt>\n-                <dd><code>K<\/code> - other times<\/dd>\n-                <dd><code>V<\/code> - some of the times<\/dd>\n-                <\/dl>\n-                \"\"\");\n-    }\n-\n-    \/*\n-     * X is unknown to Child.m as it isn't defined by Child.m and\n-     * type parameters declared by methods are not inherited.\n-     *\/\n-    @Test\n-    public void testUndefinedTypeParameter(Path base) throws Exception {\n-        var src = base.resolve(\"src\");\n-        tb.writeJavaFiles(src, \"\"\"\n-                package x;\n-\n-                public class Parent {\n-\n-                    \/** @throws T sometimes *\/\n-                    public <T extends RuntimeException> void m() { }\n-                }\n-                \"\"\", \"\"\"\n-                package x;\n-\n-                public class Child extends Parent {\n-\n-                    \/** @throws T {@inheritDoc} *\/\n-                    @Override\n-                    public void m() { }\n-                }\n-                \"\"\");\n-        \/\/ turn off DocLint so that it does not interfere with diagnostics\n-        \/\/ by raising an error for the condition we are testing:\n-        \/\/\n-        \/\/ Child.java:5: error: reference not found\n-        \/\/    \/** @throws T {@inheritDoc} *\/\n-        \/\/        ^\n-        javadoc(\"-Xdoclint:none\", \"-d\", base.resolve(\"out\").toString(), \"-sourcepath\", src.toString(), \"x\");\n-        checkExit(Exit.OK);\n-        checkOutput(Output.OUT, true, \"\"\"\n-                Child.java:5: warning: cannot find exception type by name\n-                    \/** @throws T {@inheritDoc} *\/\n-                                ^\n-                \"\"\");\n-    }\n-\n-    \/\/ A related (but separate from this test suite) test. This test is\n-    \/\/ introduced here because it tests for the error condition that is\n-    \/\/ detected by JDK-8291869, which is tested by tests in this test\n-    \/\/ suite.\n-    \/\/ TODO: consider moving this test to a more suitable test suite.\n-    @Test\n-    public void testWrongType(Path base) throws Exception {\n-        var src = base.resolve(\"src\");\n-        tb.writeJavaFiles(src, \"\"\"\n-                package x;\n-\n-                public class MyClass {\n-\n-                    \/** @throws OtherClass description *\/\n-                    public void m() { }\n-                }\n-                \"\"\", \"\"\"\n-                package x;\n-\n-                public class OtherClass { }\n-                \"\"\");\n-        \/\/ turn off DocLint so that it does not interfere with diagnostics\n-        \/\/ by raising an error for the condition we are testing\n-        javadoc(\"-Xdoclint:none\", \"-d\", base.resolve(\"out\").toString(), \"-sourcepath\", src.toString(), \"x\");\n-        checkExit(Exit.OK);\n-        checkOutput(Output.OUT, true, \"\"\"\n-                MyClass.java:5: warning: not an exception type: \\\n-                x.OtherClass (module <unnamed module> package x class OtherClass)\n-                    \/** @throws OtherClass description *\/\n-                                ^\n-                \"\"\");\n-        checkOutput(\"x\/MyClass.html\", false, \"\"\"\n-                <dl class=\"notes\">\n-                <dt>Throws:<\/dt>\n-                <dd><code><a href=\"OtherClass.html\" title=\"class in x\">OtherClass<\/a><\/code> - description<\/dd>\n-                <\/dl>\n-                \"\"\");\n-    }\n-\n-    \/\/ A related (but separate from this test suite) test. This test is\n-    \/\/ introduced here because it tests for the error condition that is\n-    \/\/ detected by JDK-8291869, which is tested by tests in this test\n-    \/\/ suite.\n-    \/\/ TODO: consider moving this test to a more suitable test suite.\n-    @Test\n-    public void testExceptionTypeNotFound(Path base) throws Exception {\n-        var src = base.resolve(\"src\");\n-        tb.writeJavaFiles(src, \"\"\"\n-                package x;\n-\n-                public class MyClass {\n-\n-                    \/** @throws un1queEn0ughS0asT0N0tBeF0und description *\/\n-                    public void m() { }\n-                }\n-                \"\"\");\n-        \/\/ turn off DocLint so that it does not interfere with diagnostics\n-        \/\/ by raising an error for the condition we are testing\n-        javadoc(\"-Xdoclint:none\", \"-d\", base.resolve(\"out\").toString(), \"-sourcepath\", src.toString(), \"x\");\n-        checkExit(Exit.OK);\n-        checkOutput(Output.OUT, true, \"\"\"\n-                MyClass.java:5: warning: cannot find exception type by name\n-                    \/** @throws un1queEn0ughS0asT0N0tBeF0und description *\/\n-                                ^\n-                \"\"\");\n-    }\n-\n-    \/*\n-     * In Child, R is a class residing in an unnamed package, whereas\n-     * in Parent, R is a type variable.\n-     *\/\n-    @Test\n-    public void testTypeAndTypeParameter(Path base) throws Exception {\n-        var src = base.resolve(\"src\");\n-        tb.writeJavaFiles(src, \"\"\"\n-                public class Parent {\n-\n-                    \/** @throws R sometimes *\/\n-                    public <R extends RuntimeException> void m() { }\n-                }\n-                \"\"\", \"\"\"\n-                public class Child extends Parent {\n-\n-                    \/** @throws R {@inheritDoc} *\/\n-                    @Override public void m() { }\n-                }\n-                \"\"\", \"\"\"\n-                public class R extends RuntimeException { }\n-                \"\"\");\n-        javadoc(\"-d\", base.resolve(\"out\").toString(), src.resolve(\"Parent.java\").toString(),\n-                src.resolve(\"Child.java\").toString(), src.resolve(\"R.java\").toString());\n-        checkExit(Exit.OK);\n-        checkOutput(Output.OUT, true, \"\"\"\n-                Child.java:3: warning: overridden methods do not document exception type R \\\n-                (module <unnamed module> package <unnamed package> class R)\n-                    \/** @throws R {@inheritDoc} *\/\n-                        ^\n-                \"\"\");\n-        checkOutput(\"Child.html\", false, \"\"\"\n-                <dl class=\"notes\">\n-                <dt>Overrides:<\/dt>\n-                <dd><code><a href=\"Parent.html#m()\">m<\/a><\/code>&nbsp;in class&nbsp;<code>\\\n-                <a href=\"Parent.html\" title=\"class in Unnamed Package\">Parent<\/a><\/code><\/dd>\n-                <dt>Throws:<\/dt>\n-                <dd><code><a href=\"R.html\" title=\"class in Unnamed Package\">R<\/a><\/code> - sometimes<\/dd>\n-                <\/dl>\"\"\");\n-        checkOutput(\"Child.html\", false, \"\"\"\n-                <dl class=\"notes\">\n-                <dt>Overrides:<\/dt>\n-                <dd><code><a href=\"Parent.html#m()\">m<\/a><\/code>&nbsp;in class&nbsp;<code>\\\n-                <a href=\"Parent.html\" title=\"class in Unnamed Package\">Parent<\/a><\/code><\/dd>\n-                <dt>Throws:<\/dt>\n-                <dd><code>R<\/code> - sometimes<\/dd>\n-                <\/dl>\"\"\");\n-    }\n-\n-    \/*\n-     * There are two different exceptions that share the same simple name:\n-     *\n-     *   1. P.MyException (a nested static class in an unnamed package)\n-     *   2. P.MyException (a public class in the P package)\n-     *\n-     * Although unconventional, it is not prohibited for a package name to\n-     * start with an upper case letter. This test disregards that\n-     * convention for the setup to work: the package and the\n-     * class should have the same FQN to be confusing.\n-     *\n-     * A permissible but equally unconventional alternative would be to\n-     * keep the package lower-case but give the class a lower-case name p.\n-     *\n-     * This setup works likely because of JLS 6.3. Scope of a Declaration:\n-     *\n-     *     The scope of a top level class or interface (7.6) is all class\n-     *     and interface declarations in the package in which the top\n-     *     level class or interface is declared.\n-     *\/\n-    @Test\n-    public void testOuterClassAndPackage(Path base) throws Exception {\n-        var src = base.resolve(\"src\");\n-        tb.writeJavaFiles(src, \"\"\"\n-                package P;\n-\n-                public class MyException extends RuntimeException { }\n-                \"\"\", \"\"\"\n-                package pkg;\n-\n-                public class Parent {\n-\n-                    \/** @throws P.MyException sometimes *\/\n-                    public void m() { }\n-                }\n-                \"\"\", \"\"\"\n-                public class Child extends pkg.Parent {\n-\n-                    \/** @throws P.MyException {@inheritDoc} *\/\n-                    @Override\n-                    public void m() { }\n-                }\n-                \"\"\", \"\"\"\n-                public class P {\n-                    public static class MyException extends RuntimeException { }\n-                }\n-                \"\"\");\n-        setAutomaticCheckLinks(false); \/\/ otherwise the link checker reports that P.MyException is defined twice\n-                                       \/\/ (tracked by 8297085)\n-        javadoc(\"-d\",\n-                base.resolve(\"out\").toString(),\n-                src.resolve(\"P\").resolve(\"MyException.java\").toString(),\n-                src.resolve(\"pkg\").resolve(\"Parent.java\").toString(),\n-                src.resolve(\"Child.java\").toString(),\n-                src.resolve(\"P.java\").toString());\n-        checkExit(Exit.OK);\n-        checkOutput(Output.OUT, true, \"\"\"\n-                Child.java:3: warning: overridden methods do not document exception type P.MyException \\\n-                (module <unnamed module> package <unnamed package> class P class MyException)\n-                    \/** @throws P.MyException {@inheritDoc} *\/\n-                        ^\n-                \"\"\");\n-        checkOutput(\"Child.html\", false, \"\"\"\n-                <dl class=\"notes\">\n-                <dt>Overrides:<\/dt>\n-                <dd><code><a href=\"pkg\/Parent.html#m()\">m<\/a><\/code>&nbsp;in class&nbsp;<code>\\\n-                <a href=\"pkg\/Parent.html\" title=\"class in pkg\">Parent<\/a><\/code><\/dd>\n-                <dt>Throws:<\/dt>\n-                <dd><code><a href=\"P.MyException.html\" title=\"class in Unnamed Package\">P.MyException<\/a><\/code> - sometimes<\/dd>\n-                <\/dl>\"\"\");\n-        checkOutput(\"Child.html\", false, \"P\/MyException.html\");\n-    }\n-\n-    \/*\n-     * It's unclear how to match type parameters that aren't declared by\n-     * a method. For example, consider that for B to be a subtype of A,\n-     * it is not necessary for A and B to have the same number or\n-     * types of type parameters.\n-     *\n-     * For that reason, exception documentation inheritance involving\n-     * such parameters is currently unsupported. This test simply\n-     * checks that we produce helpful warnings.\n-     *\/\n-    @Test\n-    public void testGenericTypes(Path base) throws Exception {\n-        var src = base.resolve(\"src\");\n-        tb.writeJavaFiles(src, \"\"\"\n-                package x;\n-\n-                public class Parent<T extends RuntimeException> {\n-\n-                    \/** @throws T description *\/\n-                    public void m() { }\n-                }\n-                \"\"\", \"\"\"\n-                package x;\n-\n-                public class Child1<T extends RuntimeException> extends Parent<T> {\n-\n-                    \/** @throws T {@inheritDoc} *\/\n-                    @Override public void m() { }\n-                }\n-                \"\"\", \"\"\"\n-                package x;\n-\n-                public class Child2<T extends IllegalArgumentException> extends Parent<T> {\n-\n-                    \/** @throws T {@inheritDoc} *\/\n-                    @Override public void m() { }\n-                }\n-                \"\"\", \"\"\"\n-                package x;\n-\n-                public class Child3 extends Parent<NullPointerException> {\n-\n-                    \/** @throws NullPointerException {@inheritDoc} *\/\n-                    @Override public void m() { }\n-                }\n-                \"\"\");\n-        javadoc(\"-d\", base.resolve(\"out\").toString(), \"-sourcepath\", src.toString(), \"x\");\n-        checkExit(Exit.OK);\n-        checkOutput(Output.OUT, true, \"\"\"\n-                Child1.java:5: warning: @inheritDoc is not supported for exception-type type parameters \\\n-                that are not declared by a method; document such exception types directly\n-                    \/** @throws T {@inheritDoc} *\/\n-                                ^\n-                \"\"\");\n-        checkOutput(Output.OUT, true, \"\"\"\n-                Child2.java:5: warning: @inheritDoc is not supported for exception-type type parameters \\\n-                that are not declared by a method; document such exception types directly\n-                    \/** @throws T {@inheritDoc} *\/\n-                                ^\n-                \"\"\");\n-        checkOutput(Output.OUT, true, \"\"\"\n-                Child3.java:5: warning: overridden methods do not document exception type java.lang.NullPointerException \\\n-                (module java.base package java.lang class NullPointerException)\n-                    \/** @throws NullPointerException {@inheritDoc} *\/\n-                        ^\n-                    \"\"\");\n-    }\n-}\n","filename":"test\/langtools\/jdk\/javadoc\/doclet\/testThrowsInheritanceMatching\/TestExceptionTypeMatching.java","additions":0,"deletions":490,"binary":false,"changes":490,"status":"deleted"},{"patch":"@@ -26,1 +26,1 @@\n- * @bug 8067757 6509045 8295277\n+ * @bug 8067757 6509045\n@@ -567,174 +567,0 @@\n-\n-    @Test\n-    public void testDeeperError(Path base) throws Exception {\n-        var src = base.resolve(\"src\");\n-        tb.writeJavaFiles(src, \"\"\"\n-                package x;\n-\n-                public class MyRuntimeException extends RuntimeException { }\n-                \"\"\", \"\"\"\n-                package x;\n-\n-                public interface I {\n-\n-                    \/**\n-                     * @throws MyRuntimeException sometimes\n-                     * @throws MyRuntimeException rarely\n-                     *\/\n-                    void m();\n-                }\n-                \"\"\", \"\"\"\n-                package x;\n-\n-                public interface I1 extends I {\n-\n-                    \/**\n-                     * @throws MyRuntimeException \"{@inheritDoc}\"\n-                     *\/\n-                    @Override\n-                    void m();\n-                }\n-                \"\"\", \"\"\"\n-                package x;\n-\n-                public interface I2 extends I1 {\n-\n-                    \/**\n-                     * @throws MyRuntimeException '{@inheritDoc}'\n-                     *\/\n-                    @Override\n-                    void m();\n-                }\n-                \"\"\");\n-        javadoc(\"-d\", base.resolve(\"out\").toString(),\n-                \"-sourcepath\", src.toString(),\n-                \"x\");\n-        checkExit(Exit.ERROR);\n-        new OutputChecker(Output.OUT)\n-                .setExpectFound(true)\n-                .checkAnyOf(\n-                        \"\"\"\n-                        I2.java:6: error: @inheritDoc cannot be used within this tag\n-                             * @throws MyRuntimeException '{@inheritDoc}'\n-                               ^\"\"\",\n-                        \"\"\"\n-                        I1.java:6: error: @inheritDoc cannot be used within this tag\n-                             * @throws MyRuntimeException \"{@inheritDoc}\"\n-                               ^\"\"\");\n-    }\n-\n-    @Test\n-    public void testFullExpansion(Path base) throws Exception {\n-        var src = base.resolve(\"src\");\n-        tb.writeJavaFiles(src, \"\"\"\n-                package x;\n-\n-                public class MyRuntimeException extends RuntimeException { }\n-                \"\"\", \"\"\"\n-                package x;\n-\n-                public interface Child extends Parent {\n-\n-                    \/**\n-                     * @throws MyRuntimeException child 1\n-                     * @throws MyRuntimeException {@inheritDoc}\n-                     *\/\n-                    @Override void m();\n-                }\n-                \"\"\", \"\"\"\n-                package x;\n-\n-                public interface Parent extends GrandParent {\n-\n-                    \/**\n-                     * @throws MyRuntimeException parent 1\n-                     * @throws MyRuntimeException {@inheritDoc}\n-                     *\/\n-                    @Override void m();\n-                }\n-                \"\"\", \"\"\"\n-                package x;\n-\n-                public interface GrandParent {\n-\n-                    \/**\n-                     * @throws MyRuntimeException grandparent 1\n-                     * @throws MyRuntimeException grandparent 2\n-                     *\/\n-                    void m();\n-                }\n-                \"\"\");\n-        javadoc(\"-d\", base.resolve(\"out\").toString(),\n-                \"-sourcepath\", src.toString(),\n-                \"x\");\n-        checkExit(Exit.OK);\n-        checkOutput(\"x\/Child.html\", true, \"\"\"\n-                <dl class=\"notes\">\n-                <dt>Specified by:<\/dt>\n-                <dd><code><a href=\"GrandParent.html#m()\">m<\/a><\/code>&nbsp;in interface&nbsp;<code><a href=\"GrandParent.html\" title=\"interface in x\">GrandParent<\/a><\/code><\/dd>\n-                <dt>Specified by:<\/dt>\n-                <dd><code><a href=\"Parent.html#m()\">m<\/a><\/code>&nbsp;in interface&nbsp;<code><a href=\"Parent.html\" title=\"interface in x\">Parent<\/a><\/code><\/dd>\n-                <dt>Throws:<\/dt>\n-                <dd><code><a href=\"MyRuntimeException.html\" title=\"class in x\">MyRuntimeException<\/a><\/code> - child 1<\/dd>\n-                <dd><code><a href=\"MyRuntimeException.html\" title=\"class in x\">MyRuntimeException<\/a><\/code> - parent 1<\/dd>\n-                <dd><code><a href=\"MyRuntimeException.html\" title=\"class in x\">MyRuntimeException<\/a><\/code> - grandparent 1<\/dd>\n-                <dd><code><a href=\"MyRuntimeException.html\" title=\"class in x\">MyRuntimeException<\/a><\/code> - grandparent 2<\/dd>\n-                <\/dl>\n-                <\/section>\n-                \"\"\");\n-    }\n-\n-    @Test\n-    public void testChainEmbeddedInheritDoc(Path base) throws Exception {\n-        var src = base.resolve(\"src\");\n-        tb.writeJavaFiles(src, \"\"\"\n-                package x;\n-\n-                public class MyRuntimeException extends RuntimeException { }\n-                \"\"\", \"\"\"\n-                package x;\n-\n-                public interface Child extends Parent {\n-\n-                    \/**\n-                     * @throws MyRuntimeException \"{@inheritDoc}\"\n-                     *\/\n-                    @Override void m();\n-                }\n-                \"\"\", \"\"\"\n-                package x;\n-\n-                public interface Parent extends GrandParent {\n-\n-                    \/**\n-                     * @throws MyRuntimeException '{@inheritDoc}'\n-                     *\/\n-                    @Override void m();\n-                }\n-                \"\"\", \"\"\"\n-                package x;\n-\n-                public interface GrandParent {\n-\n-                    \/**\n-                     * @throws MyRuntimeException grandparent\n-                     *\/\n-                    void m();\n-                }\n-                \"\"\");\n-        javadoc(\"-d\", base.resolve(\"out\").toString(),\n-                \"-sourcepath\", src.toString(),\n-                \"x\");\n-        checkExit(Exit.OK);\n-        checkOutput(\"x\/Child.html\", true, \"\"\"\n-                <dl class=\"notes\">\n-                <dt>Specified by:<\/dt>\n-                <dd><code><a href=\"GrandParent.html#m()\">m<\/a><\/code>&nbsp;in interface&nbsp;<code><a href=\"GrandParent.html\" title=\"interface in x\">GrandParent<\/a><\/code><\/dd>\n-                <dt>Specified by:<\/dt>\n-                <dd><code><a href=\"Parent.html#m()\">m<\/a><\/code>&nbsp;in interface&nbsp;<code><a href=\"Parent.html\" title=\"interface in x\">Parent<\/a><\/code><\/dd>\n-                <dt>Throws:<\/dt>\n-                <dd><code><a href=\"MyRuntimeException.html\" title=\"class in x\">MyRuntimeException<\/a><\/code> - \"'grandparent'\"<\/dd>\n-                <\/dl>\n-                <\/section>\n-                \"\"\");\n-    }\n","filename":"test\/langtools\/jdk\/javadoc\/doclet\/testThrowsInheritanceMultiple\/TestOneToMany.java","additions":1,"deletions":175,"binary":false,"changes":176,"status":"modified"},{"patch":"@@ -89,1 +89,1 @@\n-                    <div class=\"block\">The value 3.1415926525 is %5.2f.<\/div>\"\"\".formatted(3.14));\n+                    <div class=\"block\">The value 3.1415926525 is  3.14.<\/div>\"\"\");\n","filename":"test\/langtools\/jdk\/javadoc\/doclet\/testValueTag\/TestValueFormats.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -45,0 +45,1 @@\n+     * @throws DoesNotExist   oops, javadoc does not see this\n","filename":"test\/langtools\/jdk\/javadoc\/tool\/6964914\/TestStdDoclet.java","additions":1,"deletions":0,"binary":false,"changes":1,"status":"modified"},{"patch":"@@ -74,5 +74,0 @@\n-        out.println(Files.readAllLines(file).stream()\n-                .filter(l -> l.contains(\"Automatically generated by Pandoc\"))\n-                .findFirst()\n-                .map(l -> l.substring(l.indexOf(\"Auto\")))\n-                .orElse(\"version string not found\"));\n@@ -230,4 +225,3 @@\n-        \/\/      \\f[V]-....\n-        \/\/ 2. options implemented by the tool or doclet appear in pairs of lines of the form\n-        \/\/      .TP\n-        \/\/      \\f[V]-...\n+        \/\/      \\f[CB]\\-....\n+        \/\/ 2. options implemented by the tool or doclet appear in lines of the form\n+        \/\/      .B \\f[CB]\\-...\n@@ -235,2 +229,2 @@\n-        Pattern p1 = Pattern.compile(\"\\\\R\" + Pattern.quote(\".IP \\\\[bu] 2\") + \"\\\\R\" + Pattern.quote(\"\\\\f[V]-\") + \".*\");\n-        Pattern p2 = Pattern.compile(\"\\\\R\" + Pattern.quote(\".TP\")          + \"\\\\R\" + Pattern.quote(\"\\\\f[V]-\") + \".*\");\n+        Pattern p1 = Pattern.compile(\"\\\\R\" + Pattern.quote(\".IP \\\\[bu] 2\") + \"\\\\R\" + Pattern.quote(\"\\\\f[CB]\\\\-\") + \".*\");\n+        Pattern p2 = Pattern.compile(\"\\\\R\" + Pattern.quote(\".B \\\\f[CB]\\\\-\") + \".*\");\n@@ -241,1 +235,1 @@\n-        \/\/      \\f[V]OPTION\\f[R] or \\f[V]OPTION:\n+        \/\/      \\f[CB]OPTION\\f[R] or \\f[CB]OPTION:\n@@ -245,1 +239,1 @@\n-        Pattern inner = Pattern.compile(\"\\\\s\\\\\\\\f\\\\[V](-[^ :]+?)(:|\\\\\\\\f\\\\[R])\");\n+        Pattern inner = Pattern.compile(\"\\\\s\\\\\\\\f\\\\[CB](\\\\\\\\-[^ :]+?)(:|\\\\\\\\f\\\\[R])\");\n@@ -249,1 +243,1 @@\n-            out.println(\"found:\" + lines);\n+            out.println(\"found:\" + lines + \"\\n\");\n@@ -253,2 +247,1 @@\n-                String option = innerMatcher.group(1);\n-                out.println(\"  found option:\" + option);\n+                String option = innerMatcher.group(1).replace(\"\\\\-\", \"-\");\n@@ -257,1 +250,0 @@\n-            out.println();\n","filename":"test\/langtools\/jdk\/javadoc\/tool\/CheckManPageOptions.java","additions":9,"deletions":17,"binary":false,"changes":26,"status":"modified"},{"patch":"@@ -39,0 +39,1 @@\n+import java.nio.file.FileSystems;\n@@ -43,0 +44,1 @@\n+import java.util.Collections;\n@@ -48,0 +50,1 @@\n+import java.util.stream.StreamSupport;\n@@ -76,10 +79,0 @@\n-    public void assertCompletion(boolean after, String code, int minElements) {\n-        if (!after) {\n-            setCommandInput(\"\\n\");\n-        } else {\n-            List<String> completions = computeCompletions(code, false);\n-            assertTrue(completions.size() >= minElements, \"Command: \" + code + \", output: \" +\n-                    completions.toString() + \", expected output with at least \" + minElements + \" elements\");\n-        }\n-    }\n-\n@@ -96,3 +89,2 @@\n-        List<String> expectedL = Arrays.asList(expected);\n-        assertEquals(completions, expectedL, \"Command: \" + code + \", output: \" +\n-                completions.toString() + \", expected: \" + expectedL.toString());\n+        assertEquals(completions, Arrays.asList(expected), \"Command: \" + code + \", output: \" +\n+                completions.toString());\n@@ -283,0 +275,3 @@\n+        List<String> p1 = listFiles(Paths.get(\"\"));\n+        getRootDirectories().forEach(s -> p1.add(s.toString()));\n+        Collections.sort(p1);\n@@ -284,1 +279,1 @@\n-                a -> assertCompletion(a, \"\/open |\", 1)\n+                a -> assertCompletion(a, \"\/open |\", false, p1.toArray(new String[p1.size()]))\n@@ -287,0 +282,1 @@\n+        List<String> p2 = listFiles(classDir);\n@@ -288,1 +284,1 @@\n-                a -> assertCompletion(a, \"\/open \" + classDir + \"\/|\", 1)\n+                a -> assertCompletion(a, \"\/open \" + classDir + \"\/|\", false, p2.toArray(new String[p2.size()]))\n@@ -298,0 +294,4 @@\n+        List<String> p1 = listFiles(Paths.get(\"\"));\n+        Collections.addAll(p1, \"-all \", \"-history \", \"-start \");\n+        getRootDirectories().forEach(s -> p1.add(s.toString()));\n+        Collections.sort(p1);\n@@ -299,1 +299,1 @@\n-                a -> assertCompletion(a, \"\/save |\", 4)\n+                a -> assertCompletion(a, \"\/save |\", false, p1.toArray(new String[p1.size()]))\n@@ -302,0 +302,1 @@\n+        List<String> p2 = listFiles(classDir);\n@@ -303,2 +304,4 @@\n-                a -> assertCompletion(a, \"\/save \" + classDir + \"\/|\", 1),\n-                a -> assertCompletion(a, \"\/save -all \" + classDir + \"\/|\", 1)\n+                a -> assertCompletion(a, \"\/save \" + classDir + \"\/|\",\n+                false, p2.toArray(new String[p2.size()])),\n+                a -> assertCompletion(a, \"\/save -all \" + classDir + \"\/|\",\n+                false, p2.toArray(new String[p2.size()]))\n@@ -376,0 +379,3 @@\n+        List<String> p1 = listFiles(Paths.get(\"\"));\n+        getRootDirectories().forEach(s -> p1.add(s.toString()));\n+        Collections.sort(p1);\n@@ -386,1 +392,1 @@\n-                a -> assertCompletion(a, \"\/set editor |\", 1),\n+                a -> assertCompletion(a, \"\/set editor |\", false, p1.toArray(new String[p1.size()])),\n@@ -410,1 +416,1 @@\n-                a -> assertCompletion(a, \"\/set st |\", 1),\n+                a -> assertCompletion(a, \"\/set st |\", false, p1.toArray(new String[p1.size()])),\n@@ -444,0 +450,8 @@\n+    private static Iterable<? extends Path> getRootDirectories() {\n+        return StreamSupport.stream(FileSystems.getDefault()\n+                                               .getRootDirectories()\n+                                               .spliterator(),\n+                                    false)\n+                            .filter(p -> Files.exists(p))\n+                            .collect(Collectors.toList());\n+    }\n","filename":"test\/langtools\/jdk\/jshell\/CommandCompletionTest.java","additions":34,"deletions":20,"binary":false,"changes":54,"status":"modified"},{"patch":"@@ -232,5 +232,0 @@\n-    public void test(String[] args, String expectedErrorOutput,\n-                     ReplTest... tests) {\n-        test(Locale.ROOT, true, args, expectedErrorOutput, DEFAULT_STARTUP_MESSAGE, tests);\n-    }\n-\n@@ -246,5 +241,0 @@\n-        test(locale, isDefaultStartUp, args, \"\", startUpMessage, tests);\n-    }\n-\n-    public void test(Locale locale, boolean isDefaultStartUp, String[] args,\n-                     String expectedErrorOutput, String startUpMessage, ReplTest... tests) {\n@@ -259,1 +249,1 @@\n-        testRaw(locale, args, expectedErrorOutput, wtests);\n+        testRaw(locale, args, wtests);\n@@ -304,2 +294,1 @@\n-    private void testRaw(Locale locale, String[] args,\n-                         String expectedErrorOutput, ReplTest... tests) {\n+    private void testRaw(Locale locale, String[] args, ReplTest... tests) {\n@@ -308,1 +297,1 @@\n-        testRawCheck(locale, expectedErrorOutput);\n+        testRawCheck(locale);\n@@ -330,1 +319,1 @@\n-    private void testRawCheck(Locale locale, String expectedErrorOutput) {\n+    private void testRawCheck(Locale locale) {\n@@ -338,4 +327,1 @@\n-        assertEquals(ceos,\n-                     expectedErrorOutput,\n-                     \"Expected \\\"\" + expectedErrorOutput +\n-                     \"\\\" command error output, got: \\\"\" + ceos + \"\\\"\");\n+        assertTrue(ceos.isEmpty(), \"Expected empty command error output, got: \" + ceos);\n","filename":"test\/langtools\/jdk\/jshell\/ReplToolTesting.java","additions":5,"deletions":19,"binary":false,"changes":24,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2015, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2015, 2021, Oracle and\/or its affiliates. All rights reserved.\n@@ -26,1 +26,1 @@\n- * @bug 8143037 8142447 8144095 8140265 8144906 8146138 8147887 8147886 8148316 8148317 8143955 8157953 8080347 8154714 8166649 8167643 8170162 8172102 8165405 8174796 8174797 8175304 8167554 8180508 8166232 8196133 8199912 8211694 8223688 8254196 8295984\n+ * @bug 8143037 8142447 8144095 8140265 8144906 8146138 8147887 8147886 8148316 8148317 8143955 8157953 8080347 8154714 8166649 8167643 8170162 8172102 8165405 8174796 8174797 8175304 8167554 8180508 8166232 8196133 8199912 8211694 8223688 8254196\n@@ -545,2 +545,0 @@\n-            test(new String[] {urlAddress},\n-                 \"File '\" + urlAddress + \"' for 'jshell' is not found.\\n\");\n","filename":"test\/langtools\/jdk\/jshell\/ToolBasicTest.java","additions":2,"deletions":4,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -111,4 +111,2 @@\n-            inputSink.write(\"Frame\");\n-            inputSink.write(FIX + \"i\");\n-            while (!waitOutput(out, \"java.awt.Frame\", \"Results may be incomplete\")) {\n-                Thread.sleep(1000);\n+            do {\n+                inputSink.write(\"Frame\");\n@@ -116,4 +114,3 @@\n-            }\n-            inputSink.write(\"1\");\n-            inputSink.write(\".WIDTH\\n\");\n-            waitOutput(out, \"==> 1\");\n+                inputSink.write(\"1\");\n+                inputSink.write(\".WIDTH\\n\");\n+            } while (!waitOutput(out, \"==> 1\", \"Results may be incomplete\"));\n","filename":"test\/langtools\/jdk\/jshell\/ToolShiftTabTest.java","additions":5,"deletions":8,"binary":false,"changes":13,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2013, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2013, 2021, Oracle and\/or its affiliates. All rights reserved.\n@@ -71,0 +71,1 @@\n+                \"com.sun.tools.sjavac\",\n","filename":"test\/langtools\/tools\/javac\/NoStringToLower.java","additions":2,"deletions":1,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -27,1 +27,2 @@\n- * @enablePreview\n+ * @compile --enable-preview -source ${jdk.version} T8290379.java\n+ * @run main\/othervm --enable-preview T8290379\n","filename":"test\/langtools\/tools\/javac\/T8290379.java","additions":2,"deletions":1,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -31,2 +31,2 @@\n- * @enablePreview\n- * @run main Patterns\n+ * @compile --enable-preview -source ${jdk.version} Patterns.java\n+ * @run main\/othervm --enable-preview Patterns\n","filename":"test\/langtools\/tools\/javac\/annotations\/typeAnnotations\/classfile\/Patterns.java","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -1,77 +0,0 @@\n-\/*\n- * Copyright (c) 2022, Oracle and\/or its affiliates. All rights reserved.\n- * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n- *\n- * This code is free software; you can redistribute it and\/or modify it\n- * under the terms of the GNU General Public License version 2 only, as\n- * published by the Free Software Foundation.\n- *\n- * This code is distributed in the hope that it will be useful, but WITHOUT\n- * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n- * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n- * version 2 for more details (a copy is included in the LICENSE file that\n- * accompanied this code).\n- *\n- * You should have received a copy of the GNU General Public License version\n- * 2 along with this work; if not, write to the Free Software Foundation,\n- * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n- *\n- * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n- * or visit www.oracle.com if you need additional information or have any\n- * questions.\n- *\/\n-\n-\/**\n- * @test\n- * @bug 8059632\n- * @summary Method reference compilation uses incorrect qualifying type\n- * @compile MethodRefQualifyingTypeTest.java\n- * @compile MethodSupplierImpl.java\n- * @run main MethodRefQualifyingTypeTest\n- *\/\n-\n-import java.lang.reflect.Method;\n-\n-public class MethodRefQualifyingTypeTest {\n-\n-    static abstract class MethodSupplierImpl implements MethodSupplier {\n-        class Inner {\n-            MethodRefQualifyingTypeTest.MyFunctionalInterface createMethodReference() {\n-                return MethodSupplierImpl.this::<Integer>m;\n-            }\n-        }\n-    }\n-\n-    interface MethodSupplier {\n-        int m(int a);\n-    }\n-\n-    interface MyFunctionalInterface {\n-        int invokeMethodReference(int a);\n-    }\n-\n-    static class MethodInvoker {\n-        public static void invoke() {\n-            MyFunctionalInterface instance = null;\n-            MethodSupplierImpl ms = new MethodSupplierImpl() {\n-                    public int m(int a) {\n-                        return a;\n-                    }\n-                };\n-            instance = ms.new Inner().createMethodReference();\n-            instance.invokeMethodReference(1);\n-        }\n-    }\n-\n-    public static void main(String argv[]) throws Exception {\n-\n-        \/\/ Without the fix for JDK-8059632, the invocation below will fail with\n-        \/\/ java.lang.invoke.LambdaConversionException: Invalid receiver type class MethodRefQualifyingTypeTest$MethodSupplierImpl; not a subtype of implementation type interface MethodRefQualifyingTypeTest$MethodSupplier\n-\n-        \/\/ With the fix for JDK-8059632, the invocation would succeed since the bootstrap section\n-        \/\/ would refer to the type of the receiver and not the type of the declaring interface,\n-        \/\/ per JLS 13.1 (see \"the qualifying type of the method invocation\").\n-\n-        Class.forName(\"MethodRefQualifyingTypeTest$MethodInvoker\").getMethod(\"invoke\").invoke(null);\n-    }\n-}\n","filename":"test\/langtools\/tools\/javac\/lambda\/methodReference\/8059632\/MethodRefQualifyingTypeTest.java","additions":0,"deletions":77,"binary":false,"changes":77,"status":"deleted"},{"patch":"@@ -1,26 +0,0 @@\n-\/*\n- * Copyright (c) 2022, Oracle and\/or its affiliates. All rights reserved.\n- * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n- *\n- * This code is free software; you can redistribute it and\/or modify it\n- * under the terms of the GNU General Public License version 2 only, as\n- * published by the Free Software Foundation.\n- *\n- * This code is distributed in the hope that it will be useful, but WITHOUT\n- * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n- * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n- * version 2 for more details (a copy is included in the LICENSE file that\n- * accompanied this code).\n- *\n- * You should have received a copy of the GNU General Public License version\n- * 2 along with this work; if not, write to the Free Software Foundation,\n- * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n- *\n- * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n- * or visit www.oracle.com if you need additional information or have any\n- * questions.\n- *\/\n-\n-class MethodRefQualifyingTypeTest$MethodSupplierImpl {\n-    int m(int a) { return a; }\n-}\n","filename":"test\/langtools\/tools\/javac\/lambda\/methodReference\/8059632\/MethodSupplierImpl.java","additions":0,"deletions":26,"binary":false,"changes":26,"status":"deleted"},{"patch":"@@ -1,168 +0,0 @@\n-\/*\n- * Copyright (c) 2022, Oracle and\/or its affiliates. All rights reserved.\n- * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n- *\n- * This code is free software; you can redistribute it and\/or modify it\n- * under the terms of the GNU General Public License version 2 only, as\n- * published by the Free Software Foundation.\n- *\n- * This code is distributed in the hope that it will be useful, but WITHOUT\n- * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n- * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n- * version 2 for more details (a copy is included in the LICENSE file that\n- * accompanied this code).\n- *\n- * You should have received a copy of the GNU General Public License version\n- * 2 along with this work; if not, write to the Free Software Foundation,\n- * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n- *\n- * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n- * or visit www.oracle.com if you need additional information or have any\n- * questions.\n- *\/\n-\n-\/*\n- * @test\n- * @bug 8059632\n- * @summary Method reference compilation uses incorrect qualifying type\n- * @library \/tools\/javac\/lib\n- * @modules jdk.jdeps\/com.sun.tools.classfile\n- *          jdk.compiler\/com.sun.tools.javac.api\n- *          jdk.compiler\/com.sun.tools.javac.jvm\n- *\/\n-\n-import java.io.File;\n-import java.net.URI;\n-import java.util.ArrayList;\n-import java.util.Arrays;\n-import java.util.Locale;\n-\n-import javax.tools.Diagnostic;\n-import javax.tools.JavaCompiler;\n-import javax.tools.JavaFileObject;\n-import javax.tools.SimpleJavaFileObject;\n-import javax.tools.ToolProvider;\n-\n-import com.sun.tools.classfile.Attribute;\n-import com.sun.tools.classfile.BootstrapMethods_attribute;\n-import com.sun.tools.classfile.ClassFile;\n-import com.sun.tools.javac.api.JavacTaskImpl;\n-import static com.sun.tools.javac.jvm.ClassFile.*;\n-import com.sun.tools.classfile.ConstantPool.*;\n-\n-public class TestBootstrapInvocation {\n-\n-    public static void main(String... args) throws Exception {\n-        JavaCompiler comp = ToolProvider.getSystemJavaCompiler();\n-        new TestBootstrapInvocation().run(comp);\n-    }\n-\n-    DiagChecker dc;\n-\n-    TestBootstrapInvocation() {\n-        dc = new DiagChecker();\n-    }\n-\n-    public void run(JavaCompiler comp) {\n-        JavaSource source = new JavaSource();\n-        JavacTaskImpl ct = (JavacTaskImpl)comp.getTask(null, null, dc,\n-                Arrays.asList(\"-g\"), null, Arrays.asList(source));\n-        try {\n-            ct.generate();\n-        } catch (Throwable t) {\n-            t.printStackTrace();\n-            throw new AssertionError(\n-                    String.format(\"Error thrown when compiling following code\\n%s\",\n-                            source.source));\n-        }\n-        if (dc.diagFound) {\n-            throw new AssertionError(\n-                    String.format(\"Diags found when compiling following code\\n%s\\n\\n%s\",\n-                            source.source, dc.printDiags()));\n-        }\n-        verifyBytecode();\n-    }\n-\n-    void verifyBytecode() {\n-        File compiledTest = new File(\"Test.class\");\n-        try {\n-            ClassFile cf = ClassFile.read(compiledTest);\n-            BootstrapMethods_attribute bsm_attr =\n-                    (BootstrapMethods_attribute)cf\n-                            .getAttribute(Attribute.BootstrapMethods);\n-            int length = bsm_attr.bootstrap_method_specifiers.length;\n-            if (length != 1) {\n-                throw new Error(\"Bad number of method specifiers \" +\n-                        \"in BootstrapMethods attribute: \" + length);\n-            }\n-            BootstrapMethods_attribute.BootstrapMethodSpecifier bsm_spec =\n-                    bsm_attr.bootstrap_method_specifiers[0];\n-\n-            if (bsm_spec.bootstrap_arguments.length != 3) {\n-                throw new Error(\"Bad number of static invokedynamic args \" +\n-                        \"in BootstrapMethod attribute\");\n-            }\n-            CONSTANT_MethodHandle_info mh =\n-                    (CONSTANT_MethodHandle_info)cf.constant_pool.get(bsm_spec.bootstrap_arguments[1]);\n-\n-            if (mh.reference_kind != RefKind.REF_invokeVirtual) {\n-                throw new Error(\"Bad invoke kind in implementation method handle: \" + mh.reference_kind);\n-            }\n-            if (!mh.getCPRefInfo().getClassName().equals(\"Test$C\")) {\n-                throw new Error(\"Unexpected class name: \" + mh.getCPRefInfo().getClassName());\n-            }\n-            if (!mh.getCPRefInfo().getNameAndTypeInfo().getName().equals(\"m\")) {\n-                throw new Error(\"Unexpected method referenced in method handle in bootstrap section: \" +\n-                                     mh.getCPRefInfo().getNameAndTypeInfo().getName());\n-            }\n-        } catch (Exception e) {\n-            e.printStackTrace();\n-            throw new Error(\"error reading \" + compiledTest +\": \" + e);\n-        }\n-    }\n-\n-    class JavaSource extends SimpleJavaFileObject {\n-\n-        static final String source =\n-\n-            \"\"\"\n-            class Test {\n-                interface I { void m(); }\n-                abstract class C implements I {}\n-                public void test(C arg) {\n-                    Runnable r = arg::m;\n-                }\n-            }\n-            \"\"\";\n-\n-        JavaSource() {\n-            super(URI.create(\"myfo:\/Test.java\"), JavaFileObject.Kind.SOURCE);\n-        }\n-\n-        @Override\n-        public CharSequence getCharContent(boolean ignoreEncodingErrors) {\n-            return source;\n-        }\n-    }\n-\n-    static class DiagChecker\n-            implements javax.tools.DiagnosticListener<JavaFileObject> {\n-\n-        boolean diagFound;\n-        ArrayList<String> diags = new ArrayList<>();\n-\n-        public void report(Diagnostic<? extends JavaFileObject> diagnostic) {\n-            diags.add(diagnostic.getMessage(Locale.getDefault()));\n-            diagFound = true;\n-        }\n-\n-        String printDiags() {\n-            StringBuilder buf = new StringBuilder();\n-            for (String s : diags) {\n-                buf.append(s);\n-                buf.append(\"\\n\");\n-            }\n-            return buf.toString();\n-        }\n-    }\n-}\n","filename":"test\/langtools\/tools\/javac\/lambda\/methodReference\/8059632\/TestBootstrapInvocation.java","additions":0,"deletions":168,"binary":false,"changes":168,"status":"deleted"},{"patch":"@@ -135,20 +135,0 @@\n-\n-        assertOK(\n-                getDiagConsumer(0, -1),\n-                \"\"\"\n-                import java.util.function.*;\n-\n-                interface Intf {\n-                    Object apply(String... args);\n-                }\n-\n-                public class Test {\n-                    public static Object foo(Object o) { return \"bar\"; }\n-                    public final Object foo(Object... o) { return \"foo\"; }\n-\n-                    public void test() {\n-                        Intf f = this::foo;\n-                    }\n-                }\n-                \"\"\"\n-        );\n","filename":"test\/langtools\/tools\/javac\/lambda\/methodReference\/BoundUnboundSearchTest.java","additions":0,"deletions":20,"binary":false,"changes":20,"status":"modified"},{"patch":"@@ -4,2 +4,1 @@\n- * @enablePreview\n- * @compile\/fail\/ref=DeconstructionPatternErrors.out -XDrawDiagnostics -XDshould-stop.at=FLOW -XDdev DeconstructionPatternErrors.java\n+ * @compile\/fail\/ref=DeconstructionPatternErrors.out --enable-preview -source ${jdk.version} -XDrawDiagnostics -XDshould-stop.at=FLOW -XDdev DeconstructionPatternErrors.java\n@@ -7,0 +6,1 @@\n+\n","filename":"test\/langtools\/tools\/javac\/patterns\/DeconstructionPatternErrors.java","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -31,1 +31,2 @@\n- * @enablePreview\n+ * @compile --enable-preview -source ${jdk.version} DisambiguatePatterns.java\n+ * @run main\/othervm --enable-preview DisambiguatePatterns\n","filename":"test\/langtools\/tools\/javac\/patterns\/DisambiguatePatterns.java","additions":2,"deletions":1,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -28,2 +28,1 @@\n- * @enablePreview\n- * @compile\/fail\/ref=Domination.out -XDrawDiagnostics Domination.java\n+ * @compile\/fail\/ref=Domination.out -XDrawDiagnostics --enable-preview -source ${jdk.version} Domination.java\n@@ -32,0 +31,1 @@\n+\n","filename":"test\/langtools\/tools\/javac\/patterns\/Domination.java","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -26,2 +26,1 @@\n- * @enablePreview\n- * @compile EmptyRecordClass.java\n+ * @compile --enable-preview -source ${jdk.version} EmptyRecordClass.java\n","filename":"test\/langtools\/tools\/javac\/patterns\/EmptyRecordClass.java","additions":1,"deletions":2,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -28,4 +28,3 @@\n- * @enablePreview\n- * @compile EnumTypeChanges.java\n- * @compile EnumTypeChanges2.java\n- * @run main EnumTypeChanges\n+ * @compile --enable-preview -source ${jdk.version} EnumTypeChanges.java\n+ * @compile --enable-preview -source ${jdk.version} EnumTypeChanges2.java\n+ * @run main\/othervm --enable-preview EnumTypeChanges\n","filename":"test\/langtools\/tools\/javac\/patterns\/EnumTypeChanges.java","additions":3,"deletions":4,"binary":false,"changes":7,"status":"modified"},{"patch":"@@ -26,1 +26,2 @@\n- * @enablePreview\n+ * @compile --enable-preview -source ${jdk.version} GenericRecordDeconstructionPattern.java\n+ * @run main\/othervm --enable-preview GenericRecordDeconstructionPattern\n","filename":"test\/langtools\/tools\/javac\/patterns\/GenericRecordDeconstructionPattern.java","additions":2,"deletions":1,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -28,1 +28,2 @@\n- * @enablePreview\n+ * @compile --enable-preview -source ${jdk.version} Guards.java\n+ * @run main\/othervm --enable-preview Guards\n","filename":"test\/langtools\/tools\/javac\/patterns\/Guards.java","additions":2,"deletions":1,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -28,2 +28,1 @@\n- * @enablePreview\n- * @compile\/fail\/ref=GuardsErrors.out -XDrawDiagnostics GuardsErrors.java\n+ * @compile\/fail\/ref=GuardsErrors.out -XDrawDiagnostics --enable-preview -source ${jdk.version} GuardsErrors.java\n@@ -33,0 +32,1 @@\n+\n","filename":"test\/langtools\/tools\/javac\/patterns\/GuardsErrors.java","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2021, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2021, Oracle and\/or its affiliates. All rights reserved.\n@@ -29,1 +29,2 @@\n- * @enablePreview\n+ * @compile --enable-preview -source ${jdk.version} LambdaCannotCapturePatternVariables.java\n+ * @run main\/othervm --enable-preview LambdaCannotCapturePatternVariables\n","filename":"test\/langtools\/tools\/javac\/patterns\/LambdaCannotCapturePatternVariables.java","additions":3,"deletions":2,"binary":false,"changes":5,"status":"modified"},{"patch":"@@ -26,1 +26,2 @@\n- * @enablePreview\n+ * @compile --enable-preview -source ${jdk.version} NestedDeconstructionPattern.java\n+ * @run main\/othervm --enable-preview NestedDeconstructionPattern\n","filename":"test\/langtools\/tools\/javac\/patterns\/NestedDeconstructionPattern.java","additions":2,"deletions":1,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -26,1 +26,2 @@\n- * @enablePreview\n+ * @compile --enable-preview -source ${jdk.version} NestedPrimitiveDeconstructionPattern.java\n+ * @run main\/othervm --enable-preview NestedPrimitiveDeconstructionPattern\n","filename":"test\/langtools\/tools\/javac\/patterns\/NestedPrimitiveDeconstructionPattern.java","additions":2,"deletions":1,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -5,1 +5,2 @@\n- * @enablePreview\n+ * @compile --enable-preview -source ${jdk.version} NullSwitch.java\n+ * @run main\/othervm --enable-preview NullSwitch\n","filename":"test\/langtools\/tools\/javac\/patterns\/NullSwitch.java","additions":2,"deletions":1,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -4,1 +4,2 @@\n- * @enablePreview\n+ * @compile --enable-preview -source ${jdk.version} NullsInDeconstructionPatterns.java\n+ * @run main\/othervm --enable-preview NullsInDeconstructionPatterns\n","filename":"test\/langtools\/tools\/javac\/patterns\/NullsInDeconstructionPatterns.java","additions":2,"deletions":1,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -28,1 +28,2 @@\n- * @enablePreview\n+ * @compile --enable-preview -source ${jdk.version} Parenthesized.java\n+ * @run main\/othervm --enable-preview Parenthesized\n","filename":"test\/langtools\/tools\/javac\/patterns\/Parenthesized.java","additions":2,"deletions":1,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -5,2 +5,1 @@\n- * @enablePreview\n- * @compile\/fail\/ref=PatternCaseErrorRecovery.out -XDrawDiagnostics PatternCaseErrorRecovery.java\n+ * @compile\/fail\/ref=PatternCaseErrorRecovery.out --enable-preview -source ${jdk.version} -XDrawDiagnostics PatternCaseErrorRecovery.java\n@@ -8,0 +7,1 @@\n+\n","filename":"test\/langtools\/tools\/javac\/patterns\/PatternCaseErrorRecovery.java","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -5,1 +5,1 @@\n- * @compile\/fail\/ref=PatternErrorRecovery.out -XDrawDiagnostics -XDshould-stop.at=FLOW --enable-preview -source ${jdk.version} PatternErrorRecovery.java\n+* @compile\/fail\/ref=PatternErrorRecovery.out -XDrawDiagnostics -XDshould-stop.at=FLOW --enable-preview -source ${jdk.version} PatternErrorRecovery.java\n","filename":"test\/langtools\/tools\/javac\/patterns\/PatternErrorRecovery.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -28,1 +28,2 @@\n- * @enablePreview\n+ * @compile --enable-preview -source ${jdk.version} PrettyTest.java\n+ * @run main\/othervm --enable-preview PrettyTest\n","filename":"test\/langtools\/tools\/javac\/patterns\/PrettyTest.java","additions":2,"deletions":1,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -28,1 +28,2 @@\n- * @enablePreview\n+ * @compile --enable-preview -source ${jdk.version} ProxyMethodLookup.java\n+ * @run main\/othervm --enable-preview ProxyMethodLookup\n","filename":"test\/langtools\/tools\/javac\/patterns\/ProxyMethodLookup.java","additions":2,"deletions":1,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -5,2 +5,1 @@\n- * @enablePreview\n- * @compile\/ref=RawTypeBindingWarning.out -Xlint:rawtypes -XDrawDiagnostics RawTypeBindingWarning.java\n+ * @compile\/ref=RawTypeBindingWarning.out -Xlint:rawtypes -XDrawDiagnostics --enable-preview -source ${jdk.version} RawTypeBindingWarning.java\n","filename":"test\/langtools\/tools\/javac\/patterns\/RawTypeBindingWarning.java","additions":1,"deletions":2,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -1,4 +1,4 @@\n-RawTypeBindingWarning.java:10:29: compiler.warn.raw.class.use: RawTypeBindingWarning, RawTypeBindingWarning<T>\n-RawTypeBindingWarning.java:14:18: compiler.warn.raw.class.use: RawTypeBindingWarning, RawTypeBindingWarning<T>\n-RawTypeBindingWarning.java:18:19: compiler.warn.raw.class.use: RawTypeBindingWarning, RawTypeBindingWarning<T>\n-RawTypeBindingWarning.java:22:18: compiler.warn.raw.class.use: RawTypeBindingWarning, RawTypeBindingWarning<T>\n+RawTypeBindingWarning.java:9:29: compiler.warn.raw.class.use: RawTypeBindingWarning, RawTypeBindingWarning<T>\n+RawTypeBindingWarning.java:13:18: compiler.warn.raw.class.use: RawTypeBindingWarning, RawTypeBindingWarning<T>\n+RawTypeBindingWarning.java:17:19: compiler.warn.raw.class.use: RawTypeBindingWarning, RawTypeBindingWarning<T>\n+RawTypeBindingWarning.java:21:18: compiler.warn.raw.class.use: RawTypeBindingWarning, RawTypeBindingWarning<T>\n","filename":"test\/langtools\/tools\/javac\/patterns\/RawTypeBindingWarning.out","additions":4,"deletions":4,"binary":false,"changes":8,"status":"modified"},{"patch":"@@ -28,4 +28,3 @@\n- * @enablePreview\n- * @compile SealedTypeChanges.java\n- * @compile SealedTypeChanges2.java\n- * @run main SealedTypeChanges\n+ * @compile --enable-preview -source ${jdk.version} SealedTypeChanges.java\n+ * @compile --enable-preview -source ${jdk.version} SealedTypeChanges2.java\n+ * @run main\/othervm --enable-preview SealedTypeChanges\n@@ -37,0 +36,1 @@\n+\n","filename":"test\/langtools\/tools\/javac\/patterns\/SealedTypeChanges.java","additions":4,"deletions":4,"binary":false,"changes":8,"status":"modified"},{"patch":"@@ -26,3 +26,2 @@\n- * @enablePreview\n- * @compile -doe SimpleAndGuardPattern.java\n- * @run main SimpleAndGuardPattern\n+ * @compile --enable-preview -source ${jdk.version} -doe SimpleAndGuardPattern.java\n+ * @run main\/othervm --enable-preview SimpleAndGuardPattern\n","filename":"test\/langtools\/tools\/javac\/patterns\/SimpleAndGuardPattern.java","additions":2,"deletions":3,"binary":false,"changes":5,"status":"modified"},{"patch":"@@ -5,2 +5,1 @@\n- * @enablePreview\n- * @compile\/fail\/ref=SwitchErrors.out -XDrawDiagnostics -XDshould-stop.at=FLOW SwitchErrors.java\n+ * @compile\/fail\/ref=SwitchErrors.out --enable-preview -source ${jdk.version} -XDrawDiagnostics -XDshould-stop.at=FLOW SwitchErrors.java\n","filename":"test\/langtools\/tools\/javac\/patterns\/SwitchErrors.java","additions":1,"deletions":2,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -1,55 +1,55 @@\n-SwitchErrors.java:11:18: compiler.err.constant.label.not.compatible: java.lang.String, java.lang.Object\n-SwitchErrors.java:17:18: compiler.err.constant.label.not.compatible: int, java.lang.Object\n-SwitchErrors.java:23:18: compiler.err.prob.found.req: (compiler.misc.inconvertible.types: java.lang.String, java.lang.Integer)\n-SwitchErrors.java:24:18: compiler.err.prob.found.req: (compiler.misc.inconvertible.types: java.lang.Integer, java.lang.CharSequence)\n-SwitchErrors.java:29:18: compiler.err.prob.found.req: (compiler.misc.inconvertible.types: compiler.misc.type.null, int)\n-SwitchErrors.java:30:18: compiler.err.prob.found.req: (compiler.misc.inconvertible.types: java.lang.String, int)\n-SwitchErrors.java:31:18: compiler.err.prob.found.req: (compiler.misc.inconvertible.types: int, java.lang.CharSequence)\n-SwitchErrors.java:37:13: compiler.err.unconditional.pattern.and.default\n-SwitchErrors.java:43:24: compiler.err.unconditional.pattern.and.default\n-SwitchErrors.java:49:18: compiler.err.unconditional.pattern.and.default\n-SwitchErrors.java:55:18: compiler.err.duplicate.unconditional.pattern\n-SwitchErrors.java:61:13: compiler.err.duplicate.default.label\n-SwitchErrors.java:67:13: compiler.err.duplicate.default.label\n-SwitchErrors.java:72:27: compiler.err.duplicate.default.label\n-SwitchErrors.java:78:18: compiler.err.duplicate.case.label\n-SwitchErrors.java:83:24: compiler.err.duplicate.case.label\n-SwitchErrors.java:88:28: compiler.err.flows.through.to.pattern\n-SwitchErrors.java:94:18: compiler.err.flows.through.to.pattern\n-SwitchErrors.java:101:18: compiler.err.flows.through.to.pattern\n-SwitchErrors.java:108:18: compiler.err.flows.through.to.pattern\n-SwitchErrors.java:113:18: compiler.err.prob.found.req: (compiler.misc.inconvertible.types: java.lang.String, java.lang.Integer)\n-SwitchErrors.java:119:18: compiler.err.instanceof.reifiable.not.safe: java.util.List, java.util.List<java.lang.Integer>\n-SwitchErrors.java:125:18: compiler.err.cant.resolve.location: kindname.class, Undefined, , , (compiler.misc.location: kindname.class, SwitchErrors, null)\n-SwitchErrors.java:132:18: compiler.err.type.found.req: int, (compiler.misc.type.req.class.array)\n-SwitchErrors.java:138:28: compiler.err.flows.through.from.pattern\n-SwitchErrors.java:144:18: compiler.err.flows.through.from.pattern\n-SwitchErrors.java:149:27: compiler.err.flows.through.to.pattern\n-SwitchErrors.java:155:18: compiler.err.flows.through.to.pattern\n-SwitchErrors.java:167:18: compiler.err.pattern.expected\n-SwitchErrors.java:173:78: compiler.err.cant.resolve.location: kindname.variable, n, , , (compiler.misc.location: kindname.class, SwitchErrors, null)\n-SwitchErrors.java:179:73: compiler.err.cant.resolve.location: kindname.variable, n, , , (compiler.misc.location: kindname.class, SwitchErrors, null)\n-SwitchErrors.java:186:21: compiler.err.flows.through.to.pattern\n-SwitchErrors.java:195:44: compiler.err.flows.through.from.pattern\n-SwitchErrors.java:213:29: compiler.err.unconditional.pattern.and.default\n-SwitchErrors.java:220:21: compiler.err.flows.through.to.pattern\n-SwitchErrors.java:220:47: compiler.err.flows.through.from.pattern\n-SwitchErrors.java:227:44: compiler.err.flows.through.from.pattern\n-SwitchErrors.java:227:47: compiler.err.flows.through.from.pattern\n-SwitchErrors.java:239:18: compiler.err.duplicate.unconditional.pattern\n-SwitchErrors.java:244:18: compiler.err.prob.found.req: (compiler.misc.not.applicable.types: int, java.lang.Integer)\n-SwitchErrors.java:249:18: compiler.err.type.found.req: int, (compiler.misc.type.req.class.array)\n-SwitchErrors.java:262:24: compiler.err.flows.through.to.pattern\n-SwitchErrors.java:276:37: compiler.err.flows.through.from.pattern\n-SwitchErrors.java:10:9: compiler.err.not.exhaustive.statement\n-SwitchErrors.java:16:9: compiler.err.not.exhaustive.statement\n-SwitchErrors.java:22:9: compiler.err.not.exhaustive.statement\n-SwitchErrors.java:28:9: compiler.err.not.exhaustive.statement\n-SwitchErrors.java:76:9: compiler.err.not.exhaustive.statement\n-SwitchErrors.java:82:9: compiler.err.not.exhaustive.statement\n-SwitchErrors.java:87:9: compiler.err.not.exhaustive.statement\n-SwitchErrors.java:92:9: compiler.err.not.exhaustive.statement\n-SwitchErrors.java:98:9: compiler.err.not.exhaustive.statement\n-SwitchErrors.java:105:9: compiler.err.not.exhaustive.statement\n-SwitchErrors.java:159:9: compiler.err.not.exhaustive.statement\n-SwitchErrors.java:232:9: compiler.err.not.exhaustive.statement\n+SwitchErrors.java:10:18: compiler.err.constant.label.not.compatible: java.lang.String, java.lang.Object\n+SwitchErrors.java:16:18: compiler.err.constant.label.not.compatible: int, java.lang.Object\n+SwitchErrors.java:22:18: compiler.err.prob.found.req: (compiler.misc.inconvertible.types: java.lang.String, java.lang.Integer)\n+SwitchErrors.java:23:18: compiler.err.prob.found.req: (compiler.misc.inconvertible.types: java.lang.Integer, java.lang.CharSequence)\n+SwitchErrors.java:28:18: compiler.err.prob.found.req: (compiler.misc.inconvertible.types: compiler.misc.type.null, int)\n+SwitchErrors.java:29:18: compiler.err.prob.found.req: (compiler.misc.inconvertible.types: java.lang.String, int)\n+SwitchErrors.java:30:18: compiler.err.prob.found.req: (compiler.misc.inconvertible.types: int, java.lang.CharSequence)\n+SwitchErrors.java:36:13: compiler.err.unconditional.pattern.and.default\n+SwitchErrors.java:42:24: compiler.err.unconditional.pattern.and.default\n+SwitchErrors.java:48:18: compiler.err.unconditional.pattern.and.default\n+SwitchErrors.java:54:18: compiler.err.duplicate.unconditional.pattern\n+SwitchErrors.java:60:13: compiler.err.duplicate.default.label\n+SwitchErrors.java:66:13: compiler.err.duplicate.default.label\n+SwitchErrors.java:71:27: compiler.err.duplicate.default.label\n+SwitchErrors.java:77:18: compiler.err.duplicate.case.label\n+SwitchErrors.java:82:24: compiler.err.duplicate.case.label\n+SwitchErrors.java:87:28: compiler.err.flows.through.to.pattern\n+SwitchErrors.java:93:18: compiler.err.flows.through.to.pattern\n+SwitchErrors.java:100:18: compiler.err.flows.through.to.pattern\n+SwitchErrors.java:107:18: compiler.err.flows.through.to.pattern\n+SwitchErrors.java:112:18: compiler.err.prob.found.req: (compiler.misc.inconvertible.types: java.lang.String, java.lang.Integer)\n+SwitchErrors.java:118:18: compiler.err.instanceof.reifiable.not.safe: java.util.List, java.util.List<java.lang.Integer>\n+SwitchErrors.java:124:18: compiler.err.cant.resolve.location: kindname.class, Undefined, , , (compiler.misc.location: kindname.class, SwitchErrors, null)\n+SwitchErrors.java:131:18: compiler.err.type.found.req: int, (compiler.misc.type.req.class.array)\n+SwitchErrors.java:137:28: compiler.err.flows.through.from.pattern\n+SwitchErrors.java:143:18: compiler.err.flows.through.from.pattern\n+SwitchErrors.java:148:27: compiler.err.flows.through.to.pattern\n+SwitchErrors.java:154:18: compiler.err.flows.through.to.pattern\n+SwitchErrors.java:166:18: compiler.err.pattern.expected\n+SwitchErrors.java:172:78: compiler.err.cant.resolve.location: kindname.variable, n, , , (compiler.misc.location: kindname.class, SwitchErrors, null)\n+SwitchErrors.java:178:73: compiler.err.cant.resolve.location: kindname.variable, n, , , (compiler.misc.location: kindname.class, SwitchErrors, null)\n+SwitchErrors.java:185:21: compiler.err.flows.through.to.pattern\n+SwitchErrors.java:194:44: compiler.err.flows.through.from.pattern\n+SwitchErrors.java:212:29: compiler.err.unconditional.pattern.and.default\n+SwitchErrors.java:219:21: compiler.err.flows.through.to.pattern\n+SwitchErrors.java:219:47: compiler.err.flows.through.from.pattern\n+SwitchErrors.java:226:44: compiler.err.flows.through.from.pattern\n+SwitchErrors.java:226:47: compiler.err.flows.through.from.pattern\n+SwitchErrors.java:238:18: compiler.err.duplicate.unconditional.pattern\n+SwitchErrors.java:243:18: compiler.err.prob.found.req: (compiler.misc.not.applicable.types: int, java.lang.Integer)\n+SwitchErrors.java:248:18: compiler.err.type.found.req: int, (compiler.misc.type.req.class.array)\n+SwitchErrors.java:261:24: compiler.err.flows.through.to.pattern\n+SwitchErrors.java:275:37: compiler.err.flows.through.from.pattern\n+SwitchErrors.java:9:9: compiler.err.not.exhaustive.statement\n+SwitchErrors.java:15:9: compiler.err.not.exhaustive.statement\n+SwitchErrors.java:21:9: compiler.err.not.exhaustive.statement\n+SwitchErrors.java:27:9: compiler.err.not.exhaustive.statement\n+SwitchErrors.java:75:9: compiler.err.not.exhaustive.statement\n+SwitchErrors.java:81:9: compiler.err.not.exhaustive.statement\n+SwitchErrors.java:86:9: compiler.err.not.exhaustive.statement\n+SwitchErrors.java:91:9: compiler.err.not.exhaustive.statement\n+SwitchErrors.java:97:9: compiler.err.not.exhaustive.statement\n+SwitchErrors.java:104:9: compiler.err.not.exhaustive.statement\n+SwitchErrors.java:158:9: compiler.err.not.exhaustive.statement\n+SwitchErrors.java:231:9: compiler.err.not.exhaustive.statement\n@@ -58,1 +58,1 @@\n-55 errors\n+55 errors\n\\ No newline at end of file\n","filename":"test\/langtools\/tools\/javac\/patterns\/SwitchErrors.out","additions":56,"deletions":56,"binary":false,"changes":112,"status":"modified"},{"patch":"@@ -1,1 +0,0 @@\n-\n@@ -34,1 +33,2 @@\n- * @enablePreview\n+ * @compile --enable-preview -source ${jdk.version} Switches.java\n+ * @run main\/othervm --enable-preview Switches\n","filename":"test\/langtools\/tools\/javac\/patterns\/Switches.java","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -27,2 +27,1 @@\n- * @enablePreview\n- * @compile T8291657.java\n+ * @compile --enable-preview -source ${jdk.version} T8291657.java\n","filename":"test\/langtools\/tools\/javac\/patterns\/T8291657.java","additions":1,"deletions":2,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -26,1 +26,2 @@\n- * @enablePreview\n+ * @compile --enable-preview -source ${jdk.version} TypedDeconstructionPatternExc.java\n+ * @run main\/othervm --enable-preview TypedDeconstructionPatternExc\n","filename":"test\/langtools\/tools\/javac\/patterns\/TypedDeconstructionPatternExc.java","additions":2,"deletions":1,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -4,2 +4,1 @@\n- * @enablePreview\n- * @compile\/fail\/ref=VarErrors.out -XDrawDiagnostics -XDshould-stop.at=FLOW -XDdev VarErrors.java\n+ * @compile\/fail\/ref=VarErrors.out --enable-preview -source ${jdk.version} -XDrawDiagnostics -XDshould-stop.at=FLOW -XDdev VarErrors.java\n","filename":"test\/langtools\/tools\/javac\/patterns\/VarErrors.java","additions":1,"deletions":2,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -1,3 +1,3 @@\n-VarErrors.java:9:27: compiler.err.restricted.type.not.allowed.here: var\n-VarErrors.java:13:18: compiler.err.restricted.type.not.allowed.here: var\n-VarErrors.java:18:18: compiler.err.restricted.type.not.allowed.here: var\n+VarErrors.java:8:27: compiler.err.restricted.type.not.allowed.here: var\n+VarErrors.java:12:18: compiler.err.restricted.type.not.allowed.here: var\n+VarErrors.java:17:18: compiler.err.restricted.type.not.allowed.here: var\n","filename":"test\/langtools\/tools\/javac\/patterns\/VarErrors.out","additions":3,"deletions":3,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2021, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2021, Oracle and\/or its affiliates. All rights reserved.\n@@ -28,1 +28,2 @@\n- * @enablePreview\n+ * @compile --enable-preview -source ${jdk.version} SwitchNull.java\n+ * @run main\/othervm --enable-preview SwitchNull\n","filename":"test\/langtools\/tools\/javac\/switchnull\/SwitchNull.java","additions":3,"deletions":2,"binary":false,"changes":5,"status":"modified"},{"patch":"@@ -31,2 +31,1 @@\n-    @Override\n-    public void encode(DerOutputStream out) throws IOException {\n+    public void derEncode(DerOutputStream out) throws IOException {\n","filename":"test\/langtools\/tools\/jdeps\/jdkinternals\/src\/q\/NoRepl.java","additions":1,"deletions":2,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -74,1 +74,2 @@\n- * javac, javah, and javap. (For javadoc support, see JavadocTester.)\n+ * javac, javah, javap, and sjavac. (For javadoc support,\n+ * see JavadocTester.)\n@@ -992,0 +993,1 @@\n+\n","filename":"test\/langtools\/tools\/lib\/toolbox\/ToolBox.java","additions":3,"deletions":1,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -0,0 +1,217 @@\n+\/*\n+ * Copyright (c) 2015, 2016, Oracle and\/or its affiliates. All rights reserved.\n+ * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+ *\n+ * This code is free software; you can redistribute it and\/or modify it\n+ * under the terms of the GNU General Public License version 2 only, as\n+ * published by the Free Software Foundation.\n+ *\n+ * This code is distributed in the hope that it will be useful, but WITHOUT\n+ * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+ * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+ * version 2 for more details (a copy is included in the LICENSE file that\n+ * accompanied this code).\n+ *\n+ * You should have received a copy of the GNU General Public License version\n+ * 2 along with this work; if not, write to the Free Software Foundation,\n+ * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n+ *\n+ * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n+ * or visit www.oracle.com if you need additional information or have any\n+ * questions.\n+ *\/\n+\n+\/*\n+ * @test\n+ * @bug 8054717\n+ * @summary Make sure extraction of non-private APIs work as expected.\n+ * @library \/tools\/lib\n+ * @modules jdk.compiler\/com.sun.tools.javac.api\n+ *          jdk.compiler\/com.sun.tools.javac.main\n+ *          jdk.compiler\/com.sun.tools.sjavac\n+ *          jdk.compiler\/com.sun.tools.sjavac.options\n+ *          jdk.compiler\/com.sun.tools.sjavac.pubapi\n+ * @build Wrapper toolbox.ToolBox toolbox.JavacTask\n+ * @run main Wrapper ApiExtraction\n+ *\/\n+\n+import static java.util.Arrays.asList;\n+import static java.util.Collections.emptyList;\n+import static javax.lang.model.element.Modifier.FINAL;\n+import static javax.lang.model.element.Modifier.PROTECTED;\n+import static javax.lang.model.element.Modifier.PUBLIC;\n+import static javax.lang.model.element.Modifier.STATIC;\n+\n+import java.io.IOException;\n+import java.util.HashSet;\n+import java.util.List;\n+import java.util.Set;\n+\n+import javax.lang.model.type.TypeKind;\n+\n+import com.sun.tools.sjavac.PubApiExtractor;\n+import com.sun.tools.sjavac.options.Options;\n+import com.sun.tools.sjavac.pubapi.PrimitiveTypeDesc;\n+import com.sun.tools.sjavac.pubapi.PubApi;\n+import com.sun.tools.sjavac.pubapi.PubMethod;\n+import com.sun.tools.sjavac.pubapi.PubType;\n+import com.sun.tools.sjavac.pubapi.PubVar;\n+import com.sun.tools.sjavac.pubapi.ReferenceTypeDesc;\n+\n+import toolbox.JavacTask;\n+import toolbox.ToolBox;\n+\n+public class ApiExtraction {\n+    public static void main(String[] args) throws IOException {\n+\n+        String testSrc = String.join(\"\\n\",\n+                \"import java.util.*;\",\n+                \"public final class TestClass extends Thread {\",\n+\n+                \/\/ Fields with various combination of modifiers\n+                \"    private String s1 = \\\"str 1\\\";\",\n+                \"    public String s2 = \\\"str 2\\\";\",\n+                \"    protected final String s3 = \\\"str 3\\\";\",\n+                \"    static String s4 = \\\"str 4\\\";\",\n+\n+                \/\/ Methods with various combinations of types and modifiers\n+                \"    protected void m1() {}\",\n+                \"    public static Map<Integer, List<String>> m2() {\",\n+                \"        return null;\",\n+                \"    }\",\n+                \"    final void m3(Set<Map<Integer, Map<String, String>>> s) {}\",\n+\n+                \/\/ Some inner classes\n+                \"    static class DummyInner1 implements Runnable {\",\n+                \"        protected int field;\",\n+                \"        public void run() {}\",\n+                \"    }\",\n+                \"    final class DummyInner2 { }\",\n+                \"}\");\n+\n+        \/\/ Create class file to extract API from\n+        new JavacTask(new ToolBox()).sources(testSrc).run();\n+\n+        \/\/ Extract PubApi\n+        Options options = Options.parseArgs(\"-d\", \"bin\", \"--state-dir=bin\", \"-cp\", \".\");\n+        PubApiExtractor pubApiExtr = new PubApiExtractor(options);\n+        PubApi actualApi = pubApiExtr.getPubApi(\"TestClass\");\n+        pubApiExtr.close();\n+\n+        \/\/ Validate result\n+        PubApi expectedApi = getExpectedPubApi();\n+        if (!expectedApi.equals(actualApi)) {\n+            List<String> diffs = expectedApi.diff(actualApi);\n+            System.out.println(diffs.size() + \" differences found.\");\n+            for (String diff : diffs) {\n+                System.out.println(diff);\n+            }\n+            throw new AssertionError(\"Actual API differs from expected API.\");\n+        }\n+    }\n+\n+    private static PubApi getExpectedPubApi() {\n+\n+        ReferenceTypeDesc string = new ReferenceTypeDesc(\"java.lang.String\");\n+\n+        \/\/ Fields\n+        \/\/ (s1 is private and therefore not included)\n+        PubVar s2 = new PubVar(setOf(PUBLIC), string, \"s2\", null);\n+        PubVar s4 = new PubVar(setOf(STATIC), string, \"s4\", null);\n+        PubVar s3 = new PubVar(setOf(PROTECTED, FINAL), string, \"s3\",\n+                                   \"\\\"\\\\u0073\\\\u0074\\\\u0072\\\\u0020\\\\u0033\\\"\");\n+\n+        \/\/ Methods\n+        PubMethod init = new PubMethod(setOf(PUBLIC),\n+                                       emptyList(),\n+                                       new PrimitiveTypeDesc(TypeKind.VOID),\n+                                       \"<init>\",\n+                                       emptyList(),\n+                                       emptyList());\n+\n+        PubMethod clinit = new PubMethod(setOf(STATIC),\n+                                         emptyList(),\n+                                         new PrimitiveTypeDesc(TypeKind.VOID),\n+                                         \"<clinit>\",\n+                                         emptyList(),\n+                                         emptyList());\n+\n+        PubMethod m1 = new PubMethod(setOf(PROTECTED),\n+                                     emptyList(),\n+                                     new PrimitiveTypeDesc(TypeKind.VOID),\n+                                     \"m1\",\n+                                     emptyList(),\n+                                     emptyList());\n+\n+        PubMethod m2 = new PubMethod(setOf(PUBLIC, STATIC),\n+                                     emptyList(),\n+                                     new ReferenceTypeDesc(\"java.util.Map\"),\n+                                     \"m2\",\n+                                     emptyList(),\n+                                     emptyList());\n+\n+        PubMethod m3 = new PubMethod(setOf(FINAL),\n+                                     emptyList(),\n+                                     new PrimitiveTypeDesc(TypeKind.VOID),\n+                                     \"m3\",\n+                                     asList(new ReferenceTypeDesc(\"java.util.Set\")),\n+                                     emptyList());\n+\n+        \/\/ Complete class\n+        PubType testClass = new PubType(setOf(PUBLIC, FINAL),\n+                                        \"TestClass\",\n+                                        new PubApi(asList(getDummyInner1(), getDummyInner2()),\n+                                                   asList(s2, s3, s4),\n+                                                   asList(init, clinit, m1, m2, m3)));\n+\n+        \/\/ Wrap in \"package level\" PubApi\n+        return new PubApi(asList(testClass), emptyList(), emptyList());\n+    }\n+\n+    private static PubType getDummyInner1() {\n+        PubMethod init = new PubMethod(setOf(),\n+                                       emptyList(),\n+                                       new PrimitiveTypeDesc(TypeKind.VOID),\n+                                       \"<init>\",\n+                                       emptyList(),\n+                                       emptyList());\n+\n+        PubMethod run = new PubMethod(setOf(PUBLIC),\n+                                      emptyList(),\n+                                      new PrimitiveTypeDesc(TypeKind.VOID),\n+                                      \"run\",\n+                                      emptyList(),\n+                                      emptyList());\n+\n+        PubVar field = new PubVar(setOf(PROTECTED),\n+                                  new PrimitiveTypeDesc(TypeKind.INT),\n+                                  \"field\",\n+                                  null);\n+\n+        return new PubType(setOf(STATIC),\n+                           \"TestClass$DummyInner1\",\n+                           new PubApi(emptyList(),\n+                                      asList(field),\n+                                      asList(init, run)));\n+    }\n+\n+    private static PubType getDummyInner2() {\n+        PubMethod init = new PubMethod(setOf(),\n+                                       emptyList(),\n+                                       new PrimitiveTypeDesc(TypeKind.VOID),\n+                                       \"<init>\",\n+                                       emptyList(),\n+                                       emptyList());\n+\n+        return new PubType(setOf(FINAL),\n+                           \"TestClass$DummyInner2\",\n+                           new PubApi(emptyList(),\n+                                      emptyList(),\n+                                      asList(init)));\n+    }\n+\n+    @SafeVarargs\n+    private static <T> Set<T> setOf(T... elements) {\n+        return new HashSet<>(asList(elements));\n+    }\n+}\n","filename":"test\/langtools\/tools\/sjavac\/ApiExtraction.java","additions":217,"deletions":0,"binary":false,"changes":217,"status":"added"},{"patch":"@@ -0,0 +1,137 @@\n+\/*\n+ * Copyright (c) 2015, 2016, Oracle and\/or its affiliates. All rights reserved.\n+ * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+ *\n+ * This code is free software; you can redistribute it and\/or modify it\n+ * under the terms of the GNU General Public License version 2 only, as\n+ * published by the Free Software Foundation.\n+ *\n+ * This code is distributed in the hope that it will be useful, but WITHOUT\n+ * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+ * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+ * version 2 for more details (a copy is included in the LICENSE file that\n+ * accompanied this code).\n+ *\n+ * You should have received a copy of the GNU General Public License version\n+ * 2 along with this work; if not, write to the Free Software Foundation,\n+ * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n+ *\n+ * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n+ * or visit www.oracle.com if you need additional information or have any\n+ * questions.\n+ *\/\n+\n+\/*\n+ * @test\n+ * @bug 8054717\n+ * @summary Make sure changes of public API on classpath triggers recompilation\n+ * @library \/tools\/lib\n+ * @modules jdk.compiler\/com.sun.tools.javac.api\n+ *          jdk.compiler\/com.sun.tools.javac.main\n+ *          jdk.compiler\/com.sun.tools.sjavac\n+ * @build Wrapper toolbox.ToolBox toolbox.Assert\n+ * @run main Wrapper ClasspathDependencies\n+ *\/\n+\n+\n+import java.io.IOException;\n+import java.nio.file.FileVisitResult;\n+import java.nio.file.Files;\n+import java.nio.file.Path;\n+import java.nio.file.Paths;\n+import java.nio.file.SimpleFileVisitor;\n+import java.nio.file.attribute.BasicFileAttributes;\n+import java.nio.file.attribute.FileTime;\n+\n+import static toolbox.Assert.check;\n+\n+public class ClasspathDependencies extends SjavacBase {\n+\n+    public static void main(String... args) throws Exception {\n+\n+        Path root = Paths.get(ClasspathDependencies.class.getSimpleName() + \"Test\");\n+\n+        delete(root);\n+\n+        Path src = root.resolve(\"src\");\n+        Path classes = root.resolve(\"classes\");\n+        Path srcDep = root.resolve(\"srcDep\");\n+        Path classesDep = root.resolve(\"classesDep\");\n+\n+        \/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\n+        headline(\"Create a test dependency, Dep.class, and put it in the classpath dir\");\n+        String depCode = \"package dep; public class Dep { public void m1() {} }\";\n+        toolbox.writeFile(srcDep.resolve(\"dep\/Dep.java\"), depCode);\n+        int rc = compile(\"-d\", classesDep, \"--state-dir=\" + classesDep, srcDep);\n+        check(rc == 0, \"Compilation failed unexpectedly\");\n+\n+        \/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\n+        headline(\"Compile and link against the Dep.class\");\n+        toolbox.writeFile(src.resolve(\"pkg\/C.java\"),\n+                          \"package pkg;\" +\n+                          \"import dep.Dep;\" +\n+                          \"public class C { Dep dep; public void m() { new Dep().m1(); } }\");\n+        rc = compile(\"-d\", classes, \"--state-dir=\" + classes, src, \"-cp\", classesDep);\n+        check(rc == 0, \"Compilation failed unexpectedly\");\n+        FileTime modTime1 = Files.getLastModifiedTime(classes.resolve(\"pkg\/C.class\"));\n+\n+        \/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\n+        headline(\"Update dependency (without changing the public api)\");\n+        Thread.sleep(2000);\n+        depCode = depCode.replaceAll(\"}$\", \"private void m2() {} }\");\n+        toolbox.writeFile(srcDep.resolve(\"dep\/Dep.java\"), depCode);\n+        rc = compile(\"-d\", classesDep, \"--state-dir=\" + classesDep, srcDep);\n+        check(rc == 0, \"Compilation failed unexpectedly\");\n+\n+        \/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\n+        headline(\"Make sure that this does not trigger recompilation of C.java\");\n+        rc = compile(\"-d\", classes, \"--state-dir=\" + classes, src, \"-cp\", classesDep);\n+        check(rc == 0, \"Compilation failed unexpectedly\");\n+        FileTime modTime2 = Files.getLastModifiedTime(classes.resolve(\"pkg\/C.class\"));\n+        check(modTime1.equals(modTime2), \"Recompilation erroneously triggered\");\n+\n+        \/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\n+        headline(\"Update public API of dependency\");\n+        Thread.sleep(2000);\n+        depCode = depCode.replace(\"m1()\", \"m1(String... arg)\");\n+        toolbox.writeFile(srcDep.resolve(\"dep\/Dep.java\"), depCode);\n+        rc = compile(\"-d\", classesDep, \"--state-dir=\" + classesDep, srcDep);\n+        check(rc == 0, \"Compilation failed unexpectedly\");\n+\n+        \/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\n+        headline(\"Make sure that recompilation of C.java is triggered\");\n+        rc = compile(\"-d\", classes, \"--state-dir=\" + classes, src, \"-cp\", classesDep);\n+        check(rc == 0, \"Compilation failed unexpectedly\");\n+        FileTime modTime3 = Files.getLastModifiedTime(classes.resolve(\"pkg\/C.class\"));\n+        check(modTime2.compareTo(modTime3) < 0, \"Recompilation not triggered\");\n+    }\n+\n+    static void headline(String str) {\n+        System.out.println();\n+        System.out.println(str);\n+        System.out.println(str.replaceAll(\".\", \"-\"));\n+    }\n+\n+    static void delete(Path root) throws IOException {\n+        if (!Files.exists(root))\n+            return;\n+        Files.walkFileTree(root, new SimpleFileVisitor<Path>() {\n+                 @Override\n+                 public FileVisitResult visitFile(Path f, BasicFileAttributes a)\n+                         throws IOException {\n+                     Files.delete(f);\n+                     return FileVisitResult.CONTINUE;\n+                 }\n+\n+                 @Override\n+                 public FileVisitResult postVisitDirectory(Path dir, IOException e)\n+                         throws IOException {\n+                     if (e != null)\n+                         throw e;\n+                     if (!dir.equals(root))\n+                         Files.delete(dir);\n+                     return FileVisitResult.CONTINUE;\n+                 }\n+            });\n+    }\n+}\n","filename":"test\/langtools\/tools\/sjavac\/ClasspathDependencies.java","additions":137,"deletions":0,"binary":false,"changes":137,"status":"added"},{"patch":"@@ -0,0 +1,75 @@\n+\/*\n+ * Copyright (c) 2014, 2016, Oracle and\/or its affiliates. All rights reserved.\n+ * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+ *\n+ * This code is free software; you can redistribute it and\/or modify it\n+ * under the terms of the GNU General Public License version 2 only, as\n+ * published by the Free Software Foundation.\n+ *\n+ * This code is distributed in the hope that it will be useful, but WITHOUT\n+ * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+ * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+ * version 2 for more details (a copy is included in the LICENSE file that\n+ * accompanied this code).\n+ *\n+ * You should have received a copy of the GNU General Public License version\n+ * 2 along with this work; if not, write to the Free Software Foundation,\n+ * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n+ *\n+ * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n+ * or visit www.oracle.com if you need additional information or have any\n+ * questions.\n+ *\/\n+\n+\/*\n+ * @test\n+ * @summary Verify that circular sources split on multiple cores can be compiled\n+ * @bug 8054689\n+ * @author Fredrik O\n+ * @author sogoel (rewrite)\n+ * @library \/tools\/lib\n+ * @modules jdk.compiler\/com.sun.tools.javac.api\n+ *          jdk.compiler\/com.sun.tools.javac.main\n+ *          jdk.compiler\/com.sun.tools.sjavac\n+ * @build Wrapper toolbox.ToolBox\n+ * @run main Wrapper CompileCircularSources\n+ *\/\n+\n+import java.io.IOException;\n+import java.util.*;\n+import java.nio.file.*;\n+\n+public class CompileCircularSources extends SJavacTester {\n+    public static void main(String... args) throws Exception {\n+        CompileCircularSources ccs = new CompileCircularSources();\n+        ccs.test();\n+    }\n+\n+    void test() throws Exception {\n+        Files.createDirectories(BIN);\n+        Files.createDirectories(GENSRC);\n+\n+        Map<String,Long> previous_bin_state = collectState(BIN);\n+\n+        tb.writeFile(GENSRC.resolve(\"alfa\/omega\/A.java\"),\n+                     \"package alfa.omega; public class A { beta.B b; }\");\n+        tb.writeFile(GENSRC.resolve(\"beta\/B.java\"),\n+                     \"package beta; public class B { gamma.C c; }\");\n+        tb.writeFile(GENSRC.resolve(\"gamma\/C.java\"),\n+                     \"package gamma; public class C { alfa.omega.A a; }\");\n+\n+        compile(GENSRC.toString(),\n+                \"-d\", BIN.toString(),\n+                \"-h\", HEADERS.toString(),\n+                \"--state-dir=\" + BIN,\n+                \"-j\", \"3\",\n+                \"--log=debug\");\n+        Map<String,Long> new_bin_state = collectState(BIN);\n+        verifyThatFilesHaveBeenAdded(previous_bin_state,\n+                                     new_bin_state,\n+                                     BIN + \"\/alfa\/omega\/A.class\",\n+                                     BIN + \"\/beta\/B.class\",\n+                                     BIN + \"\/gamma\/C.class\",\n+                                     BIN + \"\/javac_state\");\n+    }\n+}\n","filename":"test\/langtools\/tools\/sjavac\/CompileCircularSources.java","additions":75,"deletions":0,"binary":false,"changes":75,"status":"added"},{"patch":"@@ -0,0 +1,68 @@\n+\/*\n+ * Copyright (c) 2014, 2016, Oracle and\/or its affiliates. All rights reserved.\n+ * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+ *\n+ * This code is free software; you can redistribute it and\/or modify it\n+ * under the terms of the GNU General Public License version 2 only, as\n+ * published by the Free Software Foundation.\n+ *\n+ * This code is distributed in the hope that it will be useful, but WITHOUT\n+ * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+ * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+ * version 2 for more details (a copy is included in the LICENSE file that\n+ * accompanied this code).\n+ *\n+ * You should have received a copy of the GNU General Public License version\n+ * 2 along with this work; if not, write to the Free Software Foundation,\n+ * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n+ *\n+ * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n+ * or visit www.oracle.com if you need additional information or have any\n+ * questions.\n+ *\/\n+\n+\/*\n+ * @test\n+ * @summary Tests compiling class A that depends on class B without compiling class B\n+ * @bug 8054689\n+ * @author Fredrik O\n+ * @author sogoel (rewrite)\n+ * @library \/tools\/lib\n+ * @modules jdk.compiler\/com.sun.tools.javac.api\n+ *          jdk.compiler\/com.sun.tools.javac.main\n+ *          jdk.compiler\/com.sun.tools.sjavac\n+ * @build Wrapper toolbox.ToolBox\n+ * @run main Wrapper CompileExcludingDependency\n+ *\/\n+\n+import java.util.*;\n+import java.nio.file.*;\n+\n+public class CompileExcludingDependency extends SJavacTester {\n+    public static void main(String... args) throws Exception {\n+        CompileExcludingDependency ced = new CompileExcludingDependency();\n+        ced.test();\n+    }\n+\n+    \/\/ Verify that excluding classes from compilation but not from linking works\n+    void test() throws Exception {\n+        Files.createDirectories(BIN);\n+        Map<String,Long> previous_bin_state = collectState(BIN);\n+        tb.writeFile(GENSRC.resolve(\"alfa\/omega\/A.java\"),\n+                     \"package alfa.omega; public class A { beta.B b; }\");\n+        tb.writeFile(GENSRC.resolve(\"beta\/B.java\"),\n+                     \"package beta; public class B { }\");\n+\n+        compile(\"-x\", \"beta\/*\",\n+                \"-src\", GENSRC.toString(),\n+                \"-x\", \"alfa\/omega\/*\",\n+                \"-sourcepath\", GENSRC.toString(),\n+                \"-d\", BIN.toString(),\n+                \"--state-dir=\" + BIN);\n+\n+        Map<String,Long> new_bin_state = collectState(BIN);\n+        verifyThatFilesHaveBeenAdded(previous_bin_state, new_bin_state,\n+                                     BIN + \"\/alfa\/omega\/A.class\",\n+                                     BIN + \"\/javac_state\");\n+    }\n+}\n","filename":"test\/langtools\/tools\/sjavac\/CompileExcludingDependency.java","additions":68,"deletions":0,"binary":false,"changes":68,"status":"added"},{"patch":"@@ -0,0 +1,72 @@\n+\/*\n+ * Copyright (c) 2014, 2016, Oracle and\/or its affiliates. All rights reserved.\n+ * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+ *\n+ * This code is free software; you can redistribute it and\/or modify it\n+ * under the terms of the GNU General Public License version 2 only, as\n+ * published by the Free Software Foundation.\n+ *\n+ * This code is distributed in the hope that it will be useful, but WITHOUT\n+ * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+ * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+ * version 2 for more details (a copy is included in the LICENSE file that\n+ * accompanied this code).\n+ *\n+ * You should have received a copy of the GNU General Public License version\n+ * 2 along with this work; if not, write to the Free Software Foundation,\n+ * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n+ *\n+ * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n+ * or visit www.oracle.com if you need additional information or have any\n+ * questions.\n+ *\/\n+\n+\/*\n+ * @test\n+ * @summary Test \\@atfile with command line content\n+ * @bug 8054689\n+ * @author Fredrik O\n+ * @author sogoel (rewrite)\n+ * @library \/tools\/lib\n+ * @modules jdk.compiler\/com.sun.tools.javac.api\n+ *          jdk.compiler\/com.sun.tools.javac.main\n+ *          jdk.compiler\/com.sun.tools.sjavac\n+ * @build Wrapper toolbox.ToolBox\n+ * @run main Wrapper CompileWithAtFile\n+ *\/\n+\n+import java.util.*;\n+import java.nio.file.*;\n+\n+public class CompileWithAtFile extends SJavacTester {\n+    public static void main(String... args) throws Exception {\n+        CompileWithAtFile cwf = new CompileWithAtFile();\n+        cwf.test();\n+    }\n+\n+    void test() throws Exception {\n+        tb.writeFile(GENSRC.resolve(\"list.txt\"),\n+                     \"-i alfa\/omega\/A.java\\n\" +\n+                     \"-i beta\/B.java\\n\" +\n+                     GENSRC + \"\\n\" +\n+                     \"-d \" + BIN + \"\\n\" +\n+                     \"--state-dir=\" + BIN + \"\\n\");\n+        tb.writeFile(GENSRC.resolve(\"alfa\/omega\/A.java\"),\n+                     \"package alfa.omega; import beta.B; public class A { B b; }\");\n+        tb.writeFile(GENSRC.resolve(\"beta\/B.java\"),\n+                     \"package beta; public class B { }\");\n+        tb.writeFile(GENSRC.resolve(\"beta\/C.java\"),\n+                     \"broken\");\n+\n+        Files.createDirectory(BIN);\n+        Map<String,Long> previous_bin_state = collectState(BIN);\n+\n+        compile(\"@\" + GENSRC + \"\/list.txt\");\n+\n+        Map<String,Long> new_bin_state = collectState(BIN);\n+        verifyThatFilesHaveBeenAdded(previous_bin_state, new_bin_state,\n+                         BIN + \"\/javac_state\",\n+                         BIN + \"\/alfa\/omega\/A.class\",\n+                         BIN + \"\/beta\/B.class\");\n+    }\n+}\n","filename":"test\/langtools\/tools\/sjavac\/CompileWithAtFile.java","additions":72,"deletions":0,"binary":false,"changes":72,"status":"added"},{"patch":"@@ -0,0 +1,91 @@\n+\/*\n+ * Copyright (c) 2014, 2016, Oracle and\/or its affiliates. All rights reserved.\n+ * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+ *\n+ * This code is free software; you can redistribute it and\/or modify it\n+ * under the terms of the GNU General Public License version 2 only, as\n+ * published by the Free Software Foundation.\n+ *\n+ * This code is distributed in the hope that it will be useful, but WITHOUT\n+ * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+ * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+ * version 2 for more details (a copy is included in the LICENSE file that\n+ * accompanied this code).\n+ *\n+ * You should have received a copy of the GNU General Public License version\n+ * 2 along with this work; if not, write to the Free Software Foundation,\n+ * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n+ *\n+ * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n+ * or visit www.oracle.com if you need additional information or have any\n+ * questions.\n+ *\/\n+\n+\/*\n+ * @test\n+ * @summary Verify that we can make sources invisible to linking (sourcepath)\n+ * @bug 8054689\n+ * @author Fredrik O\n+ * @author sogoel (rewrite)\n+ * @library \/tools\/lib\n+ * @modules jdk.compiler\/com.sun.tools.javac.api\n+ *          jdk.compiler\/com.sun.tools.javac.main\n+ *          jdk.compiler\/com.sun.tools.sjavac\n+ * @build Wrapper toolbox.ToolBox\n+ * @run main Wrapper CompileWithInvisibleSources\n+ *\/\n+\n+import java.util.*;\n+import java.nio.file.*;\n+\n+public class CompileWithInvisibleSources extends SJavacTester {\n+    public static void main(String... args) throws Exception {\n+        CompileWithInvisibleSources cis = new CompileWithInvisibleSources();\n+        cis.test();\n+    }\n+\n+    \/\/ Compile gensrc and link against gensrc2 and gensrc3\n+    \/\/ gensrc2 contains broken code in beta.B, thus exclude that package\n+    \/\/ gensrc3 contains a proper beta.B\n+    void test() throws Exception {\n+        Files.createDirectories(BIN);\n+\n+        Map<String,Long> previous_bin_state = collectState(BIN);\n+\n+        tb.writeFile(GENSRC.resolve(\"alfa\/omega\/A.java\"),\n+                     \"package alfa.omega; import beta.B; import gamma.C; public class A { B b; C c; }\");\n+        tb.writeFile(GENSRC2.resolve(\"beta\/B.java\"),\n+                     \"package beta; public class B { broken\");\n+        tb.writeFile(GENSRC2.resolve(\"gamma\/C.java\"),\n+                     \"package gamma; public class C { }\");\n+        tb.writeFile(GENSRC3.resolve(\"beta\/B.java\"),\n+                     \"package beta; public class B { }\");\n+\n+        compile(GENSRC.toString(),\n+                \"-x\", \"beta\/*\",\n+                \"-sourcepath\", GENSRC2.toString(),\n+                \"-sourcepath\", GENSRC3.toString(),\n+                \"-d\", BIN.toString(),\n+                \"--state-dir=\" + BIN,\n+                \"-h\", HEADERS.toString(),\n+                \"-j\", \"1\");\n+\n+        System.out.println(\"The first compile went well!\");\n+        Map<String,Long> new_bin_state = collectState(BIN);\n+        verifyThatFilesHaveBeenAdded(previous_bin_state, new_bin_state,\n+                                     BIN + \"\/alfa\/omega\/A.class\",\n+                                     BIN + \"\/javac_state\");\n+\n+        System.out.println(\"----- Compile with exluded beta went well!\");\n+        tb.cleanDirectory(BIN);\n+        compileExpectFailure(GENSRC.toString(),\n+                             \"-sourcepath\", GENSRC2.toString(),\n+                             \"-sourcepath\", GENSRC3.toString(),\n+                             \"-d\", BIN.toString(),\n+                             \"--state-dir=\" + BIN,\n+                             \"-h\", HEADERS.toString(),\n+                             \"-j\", \"1\");\n+\n+        System.out.println(\"----- Compile without exluded beta failed, as expected! Good!\");\n+    }\n+}\n","filename":"test\/langtools\/tools\/sjavac\/CompileWithInvisibleSources.java","additions":91,"deletions":0,"binary":false,"changes":91,"status":"added"},{"patch":"@@ -0,0 +1,88 @@\n+\/*\n+ * Copyright (c) 2014, 2016, Oracle and\/or its affiliates. All rights reserved.\n+ * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+ *\n+ * This code is free software; you can redistribute it and\/or modify it\n+ * under the terms of the GNU General Public License version 2 only, as\n+ * published by the Free Software Foundation.\n+ *\n+ * This code is distributed in the hope that it will be useful, but WITHOUT\n+ * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+ * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+ * version 2 for more details (a copy is included in the LICENSE file that\n+ * accompanied this code).\n+ *\n+ * You should have received a copy of the GNU General Public License version\n+ * 2 along with this work; if not, write to the Free Software Foundation,\n+ * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n+ *\n+ * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n+ * or visit www.oracle.com if you need additional information or have any\n+ * questions.\n+ *\/\n+\n+\/*\n+ * @test\n+ * @summary verify that we can override sources to be compiled\n+ * @bug 8054689\n+ * @author Fredrik O\n+ * @author sogoel (rewrite)\n+ * @library \/tools\/lib\n+ * @modules jdk.compiler\/com.sun.tools.javac.api\n+ *          jdk.compiler\/com.sun.tools.javac.main\n+ *          jdk.compiler\/com.sun.tools.sjavac\n+ * @build Wrapper toolbox.ToolBox\n+ * @run main Wrapper CompileWithOverrideSources\n+ *\/\n+\n+import java.util.*;\n+import java.nio.file.*;\n+\n+public class CompileWithOverrideSources extends SJavacTester {\n+    public static void main(String... args) throws Exception {\n+        CompileWithOverrideSources cos = new CompileWithOverrideSources();\n+        cos.test();\n+    }\n+\n+    \/\/ Compile gensrc and gensrc2. However do not compile broken beta.B in gensrc,\n+    \/\/ only compile ok beta.B in gensrc2\n+    void test() throws Exception {\n+        Files.createDirectories(BIN);\n+\n+        Map<String,Long> previous_bin_state = collectState(BIN);\n+        tb.writeFile(GENSRC.resolve(\"alfa\/omega\/A.java\"),\n+                     \"package alfa.omega; import beta.B; import gamma.C; public class A { B b; C c; }\");\n+        tb.writeFile(GENSRC.resolve(\"beta\/B.java\"),\n+                     \"package beta; public class B { broken\");\n+        tb.writeFile(GENSRC.resolve(\"gamma\/C.java\"),\n+                     \"package gamma; public class C { }\");\n+\n+        tb.writeFile(GENSRC2.resolve(\"beta\/B.java\"),\n+                     \"package beta; public class B { }\");\n+\n+        compile(\"-x\", \"beta\/*\",\n+                GENSRC.toString(),\n+                GENSRC2.toString(),\n+                \"-d\", BIN.toString(),\n+                \"--state-dir=\" + BIN,\n+                \"-h\", HEADERS.toString(),\n+                \"-j\", \"1\");\n+        Map<String,Long> new_bin_state = collectState(BIN);\n+        verifyThatFilesHaveBeenAdded(previous_bin_state, new_bin_state,\n+                                     BIN + \"\/alfa\/omega\/A.class\",\n+                                     BIN + \"\/beta\/B.class\",\n+                                     BIN + \"\/gamma\/C.class\",\n+                                     BIN + \"\/javac_state\");\n+\n+        System.out.println(\"----- Compile with exluded beta went well!\");\n+        tb.cleanDirectory(BIN);\n+        compileExpectFailure(GENSRC.toString(),\n+                             GENSRC2.toString(),\n+                             \"-d\", BIN.toString(),\n+                             \"--state-dir=\" + BIN,\n+                             \"-h\", HEADERS.toString(),\n+                             \"-j\", \"1\");\n+\n+        System.out.println(\"----- Compile without exluded beta failed, as expected! Good!\");\n+    }\n+}\n","filename":"test\/langtools\/tools\/sjavac\/CompileWithOverrideSources.java","additions":88,"deletions":0,"binary":false,"changes":88,"status":"added"},{"patch":"@@ -0,0 +1,67 @@\n+\/*\n+ * Copyright (c) 2015, 2016, Oracle and\/or its affiliates. All rights reserved.\n+ * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+ *\n+ * This code is free software; you can redistribute it and\/or modify it\n+ * under the terms of the GNU General Public License version 2 only, as\n+ * published by the Free Software Foundation.\n+ *\n+ * This code is distributed in the hope that it will be useful, but WITHOUT\n+ * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+ * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+ * version 2 for more details (a copy is included in the LICENSE file that\n+ * accompanied this code).\n+ *\n+ * You should have received a copy of the GNU General Public License version\n+ * 2 along with this work; if not, write to the Free Software Foundation,\n+ * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n+ *\n+ * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n+ * or visit www.oracle.com if you need additional information or have any\n+ * questions.\n+ *\/\n+\n+\/*\n+ * @test\n+ * @bug 8144226\n+ * @summary Ensures that excluded files are inaccessible (even for implicit\n+ *          compilation)\n+ * @modules jdk.compiler\/com.sun.tools.javac.main\n+ *          jdk.compiler\/com.sun.tools.sjavac\n+ *          jdk.compiler\/com.sun.tools.sjavac.server\n+ * @library \/tools\/lib\n+ * @build Wrapper toolbox.ToolBox toolbox.Assert\n+ * @run main Wrapper HiddenFiles\n+ *\/\n+\n+\n+import java.nio.file.Files;\n+import java.nio.file.Path;\n+import java.nio.file.Paths;\n+\n+import com.sun.tools.javac.main.Main.Result;\n+\n+import toolbox.Assert;\n+\n+public class HiddenFiles extends SjavacBase {\n+\n+    public static void main(String[] ignore) throws Exception {\n+        Path BIN = Paths.get(\"bin\");\n+        Path STATE_DIR = Paths.get(\"state-dir\");\n+        Path SRC = Paths.get(\"src\");\n+\n+        Files.createDirectories(BIN);\n+        Files.createDirectories(STATE_DIR);\n+\n+        toolbox.writeJavaFiles(SRC, \"package pkg; class A { B b; }\");\n+        toolbox.writeJavaFiles(SRC, \"package pkg; class B { }\");\n+\n+        \/\/ This compilation should fail (return RC_FATAL) since A.java refers to B.java and B.java\n+        \/\/ is excluded.\n+        int rc = compile(\"-x\", \"pkg\/B.java\", SRC.toString(),\n+                         \"-d\", BIN.toString(),\n+                         \"--state-dir=\" + STATE_DIR);\n+\n+        Assert.check(rc == Result.ERROR.exitCode, \"Compilation succeeded unexpectedly.\");\n+    }\n+}\n","filename":"test\/langtools\/tools\/sjavac\/HiddenFiles.java","additions":67,"deletions":0,"binary":false,"changes":67,"status":"added"},{"patch":"@@ -0,0 +1,121 @@\n+\/*\n+ * Copyright (c) 2014, 2019, Oracle and\/or its affiliates. All rights reserved.\n+ * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+ *\n+ * This code is free software; you can redistribute it and\/or modify it\n+ * under the terms of the GNU General Public License version 2 only, as\n+ * published by the Free Software Foundation.\n+ *\n+ * This code is distributed in the hope that it will be useful, but WITHOUT\n+ * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+ * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+ * version 2 for more details (a copy is included in the LICENSE file that\n+ * accompanied this code).\n+ *\n+ * You should have received a copy of the GNU General Public License version\n+ * 2 along with this work; if not, write to the Free Software Foundation,\n+ * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n+ *\n+ * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n+ * or visit www.oracle.com if you need additional information or have any\n+ * questions.\n+ *\/\n+\n+\/*\n+ * @test\n+ * @bug 8044131\n+ * @summary Tests the hooks used for detecting idleness of the sjavac server.\n+ * @modules jdk.compiler\/com.sun.tools.javac.main\n+ *          jdk.compiler\/com.sun.tools.sjavac.server\n+ * @build Wrapper\n+ * @run main Wrapper IdleShutdown\n+ *\/\n+\n+import java.util.concurrent.atomic.AtomicLong;\n+\n+import com.sun.tools.javac.main.Main.Result;\n+import com.sun.tools.sjavac.server.IdleResetSjavac;\n+import com.sun.tools.sjavac.server.Sjavac;\n+import com.sun.tools.sjavac.server.Terminable;\n+\n+\n+public class IdleShutdown {\n+\n+    final static long TEST_START = System.currentTimeMillis();\n+    final static long TIMEOUT_MS = 3000;\n+\n+    public static void main(String[] args) throws InterruptedException {\n+\n+        final AtomicLong timeoutTimestamp = new AtomicLong(-1);\n+\n+        log(\"Starting IdleCallbackJavacService with timeout: \" + TIMEOUT_MS);\n+        Sjavac service = new IdleResetSjavac(\n+                new NoopJavacService(),\n+                new Terminable() {\n+                    public void shutdown(String msg) {\n+                        \/\/ Record the idle timeout time\n+                        log(\"Timeout detected\");\n+                        timeoutTimestamp.set(System.currentTimeMillis());\n+                    }\n+                },\n+                TIMEOUT_MS);\n+\n+        \/\/ Make sure it didn't timeout immediately\n+        if (timeoutTimestamp.get() != -1)\n+            throw new AssertionError(\"Premature timeout detected.\");\n+\n+        \/\/ Use Sjavac object and wait less than TIMEOUT_MS in between calls\n+        Thread.sleep(TIMEOUT_MS - 1000);\n+        log(\"Compiling\");\n+        service.compile(new String[0]);\n+\n+        Thread.sleep(TIMEOUT_MS - 1000);\n+        log(\"Compiling\");\n+        service.compile(new String[0]);\n+\n+        if (timeoutTimestamp.get() != -1)\n+            throw new AssertionError(\"Premature timeout detected.\");\n+\n+        long expectedTimeout = System.currentTimeMillis() + TIMEOUT_MS;\n+\n+        \/\/ Wait for actual timeout\n+        log(\"Awaiting idle timeout\");\n+        Thread.sleep(TIMEOUT_MS + 1000);\n+\n+        \/\/ Check result\n+        if (timeoutTimestamp.get() == -1)\n+            throw new AssertionError(\"Timeout never occurred\");\n+\n+        long error = Math.abs(expectedTimeout - timeoutTimestamp.get());\n+        log(\"Timeout error: \" + error + \" ms\");\n+        String timeoutFactorText = System.getProperty(\"test.timeout.factor\", \"1.0\");\n+        double timeoutFactor = Double.parseDouble(timeoutFactorText);\n+        double allowedError = TIMEOUT_MS * 0.1 * timeoutFactor;\n+        if (error > allowedError) {\n+            throw new AssertionError(\"Timeout error too large, error is \" + error +\n+                                     \" milliseconds, we allowed \" + allowedError + \" milliseconds\");\n+        }\n+        log(\"Shutting down\");\n+        service.shutdown();\n+    }\n+\n+    private static void log(String msg) {\n+        long logTime = System.currentTimeMillis() - TEST_START;\n+        System.out.printf(\"After %5d ms: %s%n\", logTime, msg);\n+    }\n+\n+    private static class NoopJavacService implements Sjavac {\n+        @Override\n+        public void shutdown() {\n+        }\n+        @Override\n+        public Result compile(String[] args) {\n+            \/\/ Attempt to trigger idle timeout during a call by sleeping\n+            try {\n+                Thread.sleep(TIMEOUT_MS + 1000);\n+            } catch (InterruptedException e) {\n+            }\n+            return Result.OK;\n+        }\n+    }\n+}\n","filename":"test\/langtools\/tools\/sjavac\/IdleShutdown.java","additions":121,"deletions":0,"binary":false,"changes":121,"status":"added"},{"patch":"@@ -0,0 +1,101 @@\n+\/*\n+ * Copyright (c) 2014, 2016, Oracle and\/or its affiliates. All rights reserved.\n+ * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+ *\n+ * This code is free software; you can redistribute it and\/or modify it\n+ * under the terms of the GNU General Public License version 2 only, as\n+ * published by the Free Software Foundation.\n+ *\n+ * This code is distributed in the hope that it will be useful, but WITHOUT\n+ * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+ * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+ * version 2 for more details (a copy is included in the LICENSE file that\n+ * accompanied this code).\n+ *\n+ * You should have received a copy of the GNU General Public License version\n+ * 2 along with this work; if not, write to the Free Software Foundation,\n+ * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n+ *\n+ * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n+ * or visit www.oracle.com if you need additional information or have any\n+ * questions.\n+ *\/\n+\n+\/*\n+ * @test\n+ * @bug 8047183\n+ * @summary JDK build fails with sjavac enabled\n+ * @modules jdk.compiler\/com.sun.tools.sjavac\n+ * @build Wrapper\n+ * @run main Wrapper IgnoreSymbolFile\n+ *\/\n+\n+import java.io.File;\n+import java.io.FileWriter;\n+import java.io.IOException;\n+import java.io.PrintStream;\n+import java.lang.reflect.Method;\n+import java.util.Arrays;\n+\n+public class IgnoreSymbolFile {\n+    public static void main(String... args) throws Exception {\n+        IgnoreSymbolFile test = new IgnoreSymbolFile();\n+        test.run();\n+    }\n+\n+    void run() throws Exception {\n+        String body =\n+                \"package p;\\n\"\n+                + \"import sun.reflect.annotation.*;\\n\"\n+                + \"class X {\\n\"\n+                + \"    ExceptionProxy proxy;\"\n+                + \"}\";\n+        writeFile(\"src\/p\/X.java\", body);\n+\n+        new File(\"classes\").mkdirs();\n+\n+        int rc1 = compile(\"-d\", \"classes\",\n+                          \"--state-dir=classes\",\n+                          \"-Werror\",\n+                          \"src\");\n+        if (rc1 == 0)\n+            error(\"compilation succeeded unexpectedly\");\n+\n+        int rc2 = compile(\"-d\", \"classes\",\n+                          \"--state-dir=classes\",\n+                          \"-Werror\",\n+                          \"-XDignore.symbol.file=true\",\n+                          \"src\");\n+        if (rc2 != 0)\n+            error(\"compilation failed unexpectedly: rc=\" + rc2);\n+\n+        if (errors > 0)\n+            throw new Exception(errors + \" errors occurred\");\n+    }\n+\n+    int compile(String... args) throws ReflectiveOperationException {\n+        \/\/ Use reflection to avoid a compile-time dependency on sjavac Main\n+        System.err.println(\"compile: \" + Arrays.toString(args));\n+        Class<?> c = Class.forName(\"com.sun.tools.sjavac.Main\");\n+        Method m = c.getDeclaredMethod(\"go\", String[].class);\n+        int rc = (Integer) m.invoke(null, (Object) args);\n+        System.err.println(\"rc=\" + rc);\n+        return rc;\n+    }\n+\n+    void writeFile(String path, String body) throws IOException {\n+        File f = new File(path);\n+        if (f.getParentFile() != null)\n+            f.getParentFile().mkdirs();\n+        try (FileWriter w = new FileWriter(f)) {\n+            w.write(body);\n+        }\n+    }\n+\n+    void error(String msg) {\n+        System.err.println(\"Error: \" + msg);\n+        errors++;\n+    }\n+\n+    int errors;\n+}\n","filename":"test\/langtools\/tools\/sjavac\/IgnoreSymbolFile.java","additions":101,"deletions":0,"binary":false,"changes":101,"status":"added"},{"patch":"@@ -0,0 +1,71 @@\n+\/*\n+ * Copyright (c) 2014, 2016, Oracle and\/or its affiliates. All rights reserved.\n+ * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+ *\n+ * This code is free software; you can redistribute it and\/or modify it\n+ * under the terms of the GNU General Public License version 2 only, as\n+ * published by the Free Software Foundation.\n+ *\n+ * This code is distributed in the hope that it will be useful, but WITHOUT\n+ * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+ * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+ * version 2 for more details (a copy is included in the LICENSE file that\n+ * accompanied this code).\n+ *\n+ * You should have received a copy of the GNU General Public License version\n+ * 2 along with this work; if not, write to the Free Software Foundation,\n+ * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n+ *\n+ * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n+ * or visit www.oracle.com if you need additional information or have any\n+ * questions.\n+ *\/\n+\n+\/*\n+ * @test\n+ * @bug 8056258\n+ * @summary Analysis of public API does not take super classes into account\n+ * @library \/tools\/lib\n+ * @modules jdk.compiler\/com.sun.tools.javac.api\n+ *          jdk.compiler\/com.sun.tools.javac.main\n+ *          jdk.compiler\/com.sun.tools.sjavac\n+ * @build Wrapper toolbox.ToolBox\n+ * @run main Wrapper IncCompInheritance\n+ *\/\n+\n+import java.nio.file.Path;\n+import java.nio.file.Paths;\n+\n+public class IncCompInheritance extends SjavacBase {\n+    public static void main(String... args) throws Exception {\n+\n+        Path root = Paths.get(IncCompInheritance.class.getSimpleName() + \"Test\");\n+        Path src = root.resolve(\"src\");\n+        Path classes = root.resolve(\"classes\");\n+\n+        \/\/ Prep source files: A <- B <- C\n+        String a = \"package pkga; public class A { public void m() {} }\";\n+        String b = \"package pkgb; public class B extends pkga.A {}\";\n+        String c = \"package pkgc; public class C extends pkgb.B {{ new pkgb.B().m(); }}\";\n+        toolbox.writeFile(src.resolve(\"pkga\/A.java\"), a);\n+        toolbox.writeFile(src.resolve(\"pkgb\/B.java\"), b);\n+        toolbox.writeFile(src.resolve(\"pkgc\/C.java\"), c);\n+\n+        \/\/ Initial compile (should succeed)\n+        int rc1 = compile(\"-d\", classes, \"--state-dir=\" + classes, src);\n+        if (rc1 != 0)\n+            throw new AssertionError(\"Compilation failed unexpectedly\");\n+\n+        \/\/ Remove method A.m\n+        Thread.sleep(2500); \/\/ Make sure we get a new timestamp\n+        String aModified = \"package pkga; public class A { }\";\n+        toolbox.writeFile(src.resolve(\"pkga\/A.java\"), aModified);\n+\n+        \/\/ Incremental compile (C should now be recompiled even though it\n+        \/\/ depends on A only through inheritance via B).\n+        \/\/ Since A.m is removed, this should fail.\n+        int rc2 = compile(\"-d\", classes, \"--state-dir=\" + classes, src);\n+        if (rc2 == 0)\n+            throw new AssertionError(\"Compilation succeeded unexpectedly\");\n+    }\n+}\n","filename":"test\/langtools\/tools\/sjavac\/IncCompInheritance.java","additions":71,"deletions":0,"binary":false,"changes":71,"status":"added"},{"patch":"@@ -0,0 +1,119 @@\n+\/*\n+ * Copyright (c) 2014, 2016, Oracle and\/or its affiliates. All rights reserved.\n+ * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+ *\n+ * This code is free software; you can redistribute it and\/or modify it\n+ * under the terms of the GNU General Public License version 2 only, as\n+ * published by the Free Software Foundation.\n+ *\n+ * This code is distributed in the hope that it will be useful, but WITHOUT\n+ * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+ * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+ * version 2 for more details (a copy is included in the LICENSE file that\n+ * accompanied this code).\n+ *\n+ * You should have received a copy of the GNU General Public License version\n+ * 2 along with this work; if not, write to the Free Software Foundation,\n+ * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n+ *\n+ * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n+ * or visit www.oracle.com if you need additional information or have any\n+ * questions.\n+ *\/\n+\n+\/*\n+ * @test\n+ * @summary Verify native files are removed when native method is removed\n+ * @bug 8054689\n+ * @author Fredrik O\n+ * @author sogoel (rewrite)\n+ * @library \/tools\/lib\n+ * @modules jdk.compiler\/com.sun.tools.javac.api\n+ *          jdk.compiler\/com.sun.tools.javac.main\n+ *          jdk.compiler\/com.sun.tools.sjavac\n+ * @build Wrapper toolbox.ToolBox\n+ * @run main Wrapper IncCompileChangeNative\n+ *\/\n+\n+import java.util.*;\n+import java.nio.file.*;\n+\n+public class IncCompileChangeNative extends SJavacTester {\n+    public static void main(String... args) throws Exception {\n+        IncCompileChangeNative cn = new IncCompileChangeNative();\n+        cn.test();\n+    }\n+\n+    \/\/ Remember the previous bin and headers state here.\n+    Map<String,Long> previous_bin_state;\n+    Map<String,Long> previous_headers_state;\n+\n+    void test() throws Exception {\n+        Files.createDirectories(GENSRC);\n+        Files.createDirectories(BIN);\n+        Files.createDirectories(HEADERS);\n+\n+        initialCompile();\n+        incrementalCompileDropAllNatives();\n+        incrementalCompileAddNative();\n+    }\n+\n+    \/\/ Update B.java with one less native method i.e. it has no longer any methods\n+    \/\/ Verify that beta_B.h is removed\n+    void incrementalCompileDropAllNatives() throws Exception {\n+        previous_bin_state = collectState(BIN);\n+        previous_headers_state = collectState(HEADERS);\n+        System.out.println(\"\\nIn incrementalCompileDropAllNatives() \");\n+        System.out.println(\"Verify that beta_B.h is removed\");\n+        tb.writeFile(GENSRC.resolve(\"beta\/B.java\"),\n+                     \"package beta; import alfa.omega.A; \" +\n+                     \"public class B { private int b() { return A.DEFINITION; } }\");\n+\n+        compile(GENSRC.toString(),\n+                \"-d\", BIN.toString(),\n+                \"--state-dir=\" + BIN,\n+                \"-h\", HEADERS.toString(),\n+                \"-j\", \"1\",\n+                \"--log=debug\");\n+        Map<String,Long> new_bin_state = collectState(BIN);\n+        verifyNewerFiles(previous_bin_state, new_bin_state,\n+                         BIN + \"\/beta\/B.class\",\n+                         BIN + \"\/beta\/BINT.class\",\n+                         BIN + \"\/javac_state\");\n+        previous_bin_state = new_bin_state;\n+\n+        Map<String,Long> new_headers_state = collectState(HEADERS);\n+        verifyThatFilesHaveBeenRemoved(previous_headers_state, new_headers_state,\n+                                       HEADERS + \"\/beta_B.h\");\n+        previous_headers_state = new_headers_state;\n+    }\n+\n+    \/\/ Update the B.java with a final static annotated with @Native\n+    \/\/ Verify that beta_B.h is added again\n+    void incrementalCompileAddNative() throws Exception {\n+        System.out.println(\"\\nIn incrementalCompileAddNative() \");\n+        System.out.println(\"Verify that beta_B.h is added again\");\n+        tb.writeFile(GENSRC.resolve(\"beta\/B.java\"),\n+                     \"package beta; import alfa.omega.A; public class B {\"+\n+                     \"private int b() { return A.DEFINITION; } \"+\n+                     \"@java.lang.annotation.Native final static int alfa = 42; }\");\n+\n+        compile(GENSRC.toString(),\n+                \"-d\", BIN.toString(),\n+                \"--state-dir=\" + BIN,\n+                \"-h\", HEADERS.toString(),\n+                \"-j\", \"1\",\n+                \"--log=debug\");\n+        Map<String,Long> new_bin_state = collectState(BIN);\n+        verifyNewerFiles(previous_bin_state, new_bin_state,\n+                         BIN + \"\/beta\/B.class\",\n+                         BIN + \"\/beta\/BINT.class\",\n+                         BIN + \"\/javac_state\");\n+        previous_bin_state = new_bin_state;\n+\n+        Map<String,Long> new_headers_state = collectState(HEADERS);\n+        verifyThatFilesHaveBeenAdded(previous_headers_state, new_headers_state,\n+                                     HEADERS + \"\/beta_B.h\");\n+        previous_headers_state = new_headers_state;\n+    }\n+}\n","filename":"test\/langtools\/tools\/sjavac\/IncCompileChangeNative.java","additions":119,"deletions":0,"binary":false,"changes":119,"status":"added"},{"patch":"@@ -0,0 +1,85 @@\n+\/*\n+ * Copyright (c) 2014, 2016, Oracle and\/or its affiliates. All rights reserved.\n+ * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+ *\n+ * This code is free software; you can redistribute it and\/or modify it\n+ * under the terms of the GNU General Public License version 2 only, as\n+ * published by the Free Software Foundation.\n+ *\n+ * This code is distributed in the hope that it will be useful, but WITHOUT\n+ * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+ * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+ * version 2 for more details (a copy is included in the LICENSE file that\n+ * accompanied this code).\n+ *\n+ * You should have received a copy of the GNU General Public License version\n+ * 2 along with this work; if not, write to the Free Software Foundation,\n+ * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n+ *\n+ * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n+ * or visit www.oracle.com if you need additional information or have any\n+ * questions.\n+ *\/\n+\n+\/*\n+ * @test\n+ * @summary Verify deletion of a source file results in dropping of all .class files including inner classes\n+ * @bug 8054689\n+ * @author Fredrik O\n+ * @author sogoel (rewrite)\n+ * @library \/tools\/lib\n+ * @modules jdk.compiler\/com.sun.tools.javac.api\n+ *          jdk.compiler\/com.sun.tools.javac.main\n+ *          jdk.compiler\/com.sun.tools.sjavac\n+ * @build Wrapper toolbox.ToolBox\n+ * @run main Wrapper IncCompileDropClasses\n+ *\/\n+\n+import java.util.*;\n+import java.nio.file.*;\n+\n+public class IncCompileDropClasses extends SJavacTester {\n+    public static void main(String... args) throws Exception {\n+        IncCompileDropClasses dc = new IncCompileDropClasses();\n+        dc.test();\n+    }\n+\n+    \/\/ Remember the previous bin and headers state here.\n+    Map<String,Long> previous_bin_state;\n+    Map<String,Long> previous_headers_state;\n+\n+    void test() throws Exception {\n+        Files.createDirectories(GENSRC);\n+        Files.createDirectories(BIN);\n+        Files.createDirectories(HEADERS);\n+\n+        initialCompile();\n+        incrementalCompileDroppingClasses();\n+    }\n+\n+    \/\/ Testing that deleting AA.java deletes all generated inner class including AA.class\n+    void incrementalCompileDroppingClasses() throws Exception {\n+        previous_bin_state = collectState(BIN);\n+        previous_headers_state = collectState(HEADERS);\n+        System.out.println(\"\\nIn incrementalCompileDroppingClasses() \");\n+        System.out.println(\"Testing that deleting AA.java deletes all generated inner class including AA.class\");\n+        removeFrom(GENSRC, \"alfa\/omega\/AA.java\");\n+        compile(GENSRC.toString(),\n+                \"-d\", BIN.toString(),\n+                \"--state-dir=\" + BIN,\n+                \"-h\", HEADERS.toString(),\n+                \"-j\", \"1\",\n+                \"--log=debug\");\n+        Map<String,Long> new_bin_state = collectState(BIN);\n+        verifyThatFilesHaveBeenRemoved(previous_bin_state, new_bin_state,\n+                                       BIN + \"\/alfa\/omega\/AA$1.class\",\n+                                       BIN + \"\/alfa\/omega\/AA$AAAA.class\",\n+                                       BIN + \"\/alfa\/omega\/AA$AAA.class\",\n+                                       BIN + \"\/alfa\/omega\/AAAAA.class\",\n+                                       BIN + \"\/alfa\/omega\/AA.class\");\n+\n+        previous_bin_state = new_bin_state;\n+        Map<String,Long> new_headers_state = collectState(HEADERS);\n+        verifyEqual(previous_headers_state, new_headers_state);\n+    }\n+}\n","filename":"test\/langtools\/tools\/sjavac\/IncCompileDropClasses.java","additions":85,"deletions":0,"binary":false,"changes":85,"status":"added"},{"patch":"@@ -0,0 +1,88 @@\n+\/*\n+ * Copyright (c) 2014, 2016, Oracle and\/or its affiliates. All rights reserved.\n+ * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+ *\n+ * This code is free software; you can redistribute it and\/or modify it\n+ * under the terms of the GNU General Public License version 2 only, as\n+ * published by the Free Software Foundation.\n+ *\n+ * This code is distributed in the hope that it will be useful, but WITHOUT\n+ * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+ * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+ * version 2 for more details (a copy is included in the LICENSE file that\n+ * accompanied this code).\n+ *\n+ * You should have received a copy of the GNU General Public License version\n+ * 2 along with this work; if not, write to the Free Software Foundation,\n+ * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n+ *\n+ * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n+ * or visit www.oracle.com if you need additional information or have any\n+ * questions.\n+ *\/\n+\n+\/*\n+ * @test\n+ * @summary Verify that \"alfa.omega.A a\" does create a proper dependency\n+ * @bug 8054689\n+ * @author Fredrik O\n+ * @author sogoel (rewrite)\n+ * @library \/tools\/lib\n+ * @modules jdk.compiler\/com.sun.tools.javac.api\n+ *          jdk.compiler\/com.sun.tools.javac.main\n+ *          jdk.compiler\/com.sun.tools.sjavac\n+ * @ignore Requires dependency code to deal with in-method dependencies.\n+ * @build Wrapper toolbox.ToolBox\n+ * @run main Wrapper IncCompileFullyQualifiedRef\n+ *\/\n+\n+import java.util.Map;\n+\n+import toolbox.ToolBox;\n+\n+public class IncCompileFullyQualifiedRef extends SJavacTester {\n+    public static void main(String... args) throws Exception {\n+        IncCompileFullyQualifiedRef fr = new IncCompileFullyQualifiedRef();\n+        fr.test();\n+    }\n+\n+    void test() throws Exception {\n+        clean(TEST_ROOT);\n+        tb.writeFile(GENSRC.resolve(\"alfa\/omega\/A.java\"),\n+                     \"package alfa.omega; public class A { \"+\n+                     \"  public final static int DEFINITION = 18; \"+\n+                     \"  public void hello() { }\"+\n+                     \"}\");\n+        tb.writeFile(GENSRC.resolve(\"beta\/B.java\"),\n+                     \"package beta; public class B { \"+\n+                     \"  public void world() { alfa.omega.A a; }\"+\n+                     \"}\");\n+\n+        compile(GENSRC.toString(),\n+                \"-d\", BIN.toString(),\n+                \"--state-dir=\" + BIN,\n+                \"-j\", \"1\",\n+                \"--log=debug\");\n+        Map<String,Long> previous_bin_state = collectState(BIN);\n+\n+        \/\/ Change pubapi of A, this should trigger a recompile of B.\n+        tb.writeFile(GENSRC.resolve(\"alfa\/omega\/A.java\"),\n+                     \"package alfa.omega; public class A { \"+\n+                     \"  public final static int DEFINITION = 19; \"+\n+                     \"  public void hello() { }\"+\n+                     \"}\");\n+\n+        compile(GENSRC.toString(),\n+                \"-d\", BIN.toString(),\n+                \"--state-dir=\" + BIN,\n+                \"-j\", \"1\",\n+                \"--log=debug\");\n+        Map<String,Long> new_bin_state = collectState(BIN);\n+\n+        verifyNewerFiles(previous_bin_state, new_bin_state,\n+                         BIN + \"\/alfa\/omega\/A.class\",\n+                         BIN + \"\/beta\/B.class\",\n+                         BIN + \"\/javac_state\");\n+        clean(GENSRC,BIN);\n+    }\n+}\n","filename":"test\/langtools\/tools\/sjavac\/IncCompileFullyQualifiedRef.java","additions":88,"deletions":0,"binary":false,"changes":88,"status":"added"},{"patch":"@@ -0,0 +1,77 @@\n+\/*\n+ * Copyright (c) 2014, 2016, Oracle and\/or its affiliates. All rights reserved.\n+ * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+ *\n+ * This code is free software; you can redistribute it and\/or modify it\n+ * under the terms of the GNU General Public License version 2 only, as\n+ * published by the Free Software Foundation.\n+ *\n+ * This code is distributed in the hope that it will be useful, but WITHOUT\n+ * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+ * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+ * version 2 for more details (a copy is included in the LICENSE file that\n+ * accompanied this code).\n+ *\n+ * You should have received a copy of the GNU General Public License version\n+ * 2 along with this work; if not, write to the Free Software Foundation,\n+ * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n+ *\n+ * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n+ * or visit www.oracle.com if you need additional information or have any\n+ * questions.\n+ *\/\n+\n+\/*\n+ * @test\n+ * @summary Verify no change in sources implies no change in binaries\n+ * @bug 8054689\n+ * @author Fredrik O\n+ * @author sogoel (rewrite)\n+ * @library \/tools\/lib\n+ * @modules jdk.compiler\/com.sun.tools.javac.api\n+ *          jdk.compiler\/com.sun.tools.javac.main\n+ *          jdk.compiler\/com.sun.tools.sjavac\n+ * @build Wrapper toolbox.ToolBox\n+ * @run main Wrapper IncCompileNoChanges\n+ *\/\n+\n+import java.util.*;\n+import java.nio.file.*;\n+\n+public class IncCompileNoChanges  extends SJavacTester {\n+    public static void main(String... args) throws Exception {\n+        IncCompileNoChanges nc = new IncCompileNoChanges();\n+        nc.test();\n+    }\n+\n+    \/\/ Remember the previous bin and headers state here.\n+    Map<String,Long> previous_bin_state;\n+    Map<String,Long> previous_headers_state;\n+\n+    void test() throws Exception {\n+        Files.createDirectories(GENSRC);\n+        Files.createDirectories(BIN);\n+        Files.createDirectories(HEADERS);\n+\n+        initialCompile();\n+        incrementalCompileNoChanges();\n+    }\n+\n+    \/\/ Testing that no change in sources implies no change in binaries\n+    void incrementalCompileNoChanges() throws Exception {\n+        previous_bin_state = collectState(BIN);\n+        previous_headers_state = collectState(HEADERS);\n+        System.out.println(\"\\nIn incrementalCompileNoChanges() \");\n+        System.out.println(\"Testing that no change in sources implies no change in binaries\");\n+        compile(GENSRC.toString(),\n+                \"-d\", BIN.toString(),\n+                \"--state-dir=\" + BIN,\n+                \"-h\", HEADERS.toString(),\n+                \"-j\", \"1\",\n+                \"--log=debug\");\n+        Map<String,Long> new_bin_state = collectState(BIN);\n+        verifyEqual(new_bin_state, previous_bin_state);\n+        Map<String,Long> new_headers_state = collectState(HEADERS);\n+        verifyEqual(previous_headers_state, new_headers_state);\n+    }\n+}\n","filename":"test\/langtools\/tools\/sjavac\/IncCompileNoChanges.java","additions":77,"deletions":0,"binary":false,"changes":77,"status":"added"},{"patch":"@@ -0,0 +1,90 @@\n+\/*\n+ * Copyright (c) 2014, 2016, Oracle and\/or its affiliates. All rights reserved.\n+ * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+ *\n+ * This code is free software; you can redistribute it and\/or modify it\n+ * under the terms of the GNU General Public License version 2 only, as\n+ * published by the Free Software Foundation.\n+ *\n+ * This code is distributed in the hope that it will be useful, but WITHOUT\n+ * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+ * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+ * version 2 for more details (a copy is included in the LICENSE file that\n+ * accompanied this code).\n+ *\n+ * You should have received a copy of the GNU General Public License version\n+ * 2 along with this work; if not, write to the Free Software Foundation,\n+ * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n+ *\n+ * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n+ * or visit www.oracle.com if you need additional information or have any\n+ * questions.\n+ *\/\n+\n+\/*\n+ * @test\n+ * @summary Verify native files are rewritten\n+ * @bug 8054689\n+ * @author Fredrik O\n+ * @author sogoel (rewrite)\n+ * @library \/tools\/lib\n+ * @modules jdk.compiler\/com.sun.tools.javac.api\n+ *          jdk.compiler\/com.sun.tools.javac.main\n+ *          jdk.compiler\/com.sun.tools.sjavac\n+ * @build Wrapper toolbox.ToolBox\n+ * @run main Wrapper IncCompileUpdateNative\n+ *\/\n+\n+import java.util.*;\n+import java.nio.file.*;\n+\n+public class IncCompileUpdateNative extends SJavacTester {\n+    public static void main(String... args) throws Exception {\n+        IncCompileUpdateNative un = new IncCompileUpdateNative();\n+        un.test();\n+    }\n+\n+    \/\/ Remember the previous bin and headers state here.\n+    Map<String,Long> previous_bin_state;\n+    Map<String,Long> previous_headers_state;\n+\n+    void test() throws Exception {\n+        Files.createDirectories(GENSRC);\n+        Files.createDirectories(BIN);\n+        Files.createDirectories(HEADERS);\n+\n+        initialCompile();\n+        incrementalCompileChangeNative();\n+    }\n+\n+    \/\/ Update B.java with a new value for the final static annotated with @Native\n+    \/\/ Verify that beta_B.h is rewritten again\n+    void incrementalCompileChangeNative() throws Exception {\n+        previous_bin_state = collectState(BIN);\n+        previous_headers_state = collectState(HEADERS);\n+        System.out.println(\"\\nIn incrementalCompileChangeNative() \");\n+        System.out.println(\"Verify that beta_B.h is rewritten again\");\n+        tb.writeFile(GENSRC.resolve(\"beta\/B.java\"),\n+                     \"package beta; import alfa.omega.A; public class B {\"+\n+                     \"private int b() { return A.DEFINITION; } \"+\n+                      \"@java.lang.annotation.Native final static int alfa = 43; }\");\n+\n+        compile(GENSRC.toString(),\n+                \"-d\", BIN.toString(),\n+                \"--state-dir=\" + BIN,\n+                \"-h\", HEADERS.toString(),\n+                \"-j\", \"1\",\n+                \"--log=debug\");\n+        Map<String,Long> new_bin_state = collectState(BIN);\n+        verifyNewerFiles(previous_bin_state, new_bin_state,\n+                         BIN + \"\/beta\/B.class\",\n+                         BIN + \"\/beta\/BINT.class\",\n+                         BIN + \"\/javac_state\");\n+        previous_bin_state = new_bin_state;\n+\n+        Map<String,Long> new_headers_state = collectState(HEADERS);\n+        verifyNewerFiles(previous_headers_state, new_headers_state,\n+                         HEADERS + \"\/beta_B.h\");\n+        previous_headers_state = new_headers_state;\n+    }\n+}\n","filename":"test\/langtools\/tools\/sjavac\/IncCompileUpdateNative.java","additions":90,"deletions":0,"binary":false,"changes":90,"status":"added"},{"patch":"@@ -0,0 +1,103 @@\n+\/*\n+ * Copyright (c) 2014, 2016, Oracle and\/or its affiliates. All rights reserved.\n+ * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+ *\n+ * This code is free software; you can redistribute it and\/or modify it\n+ * under the terms of the GNU General Public License version 2 only, as\n+ * published by the Free Software Foundation.\n+ *\n+ * This code is distributed in the hope that it will be useful, but WITHOUT\n+ * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+ * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+ * version 2 for more details (a copy is included in the LICENSE file that\n+ * accompanied this code).\n+ *\n+ * You should have received a copy of the GNU General Public License version\n+ * 2 along with this work; if not, write to the Free Software Foundation,\n+ * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n+ *\n+ * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n+ * or visit www.oracle.com if you need additional information or have any\n+ * questions.\n+ *\/\n+\n+\/*\n+ * @test\n+ * @summary Verify incremental changes in gensrc are handled as expected\n+ * @bug 8054689\n+ * @author Fredrik O\n+ * @author sogoel (rewrite)\n+ * @library \/tools\/lib\n+ * @modules jdk.compiler\/com.sun.tools.javac.api\n+ *          jdk.compiler\/com.sun.tools.javac.main\n+ *          jdk.compiler\/com.sun.tools.sjavac\n+ * @ignore Requires dependency code to deal with in-method dependencies.\n+ * @build Wrapper toolbox.ToolBox\n+ * @run main Wrapper IncCompileWithChanges\n+ *\/\n+\n+import java.util.*;\n+import java.nio.file.*;\n+\n+import toolbox.ToolBox;\n+\n+public class IncCompileWithChanges extends SJavacTester {\n+    public static void main(String... args) throws Exception {\n+        IncCompileWithChanges wc = new IncCompileWithChanges();\n+        wc.test();\n+    }\n+\n+    \/\/ Remember the previous bin and headers state here.\n+    Map<String,Long> previous_bin_state;\n+    Map<String,Long> previous_headers_state;\n+\n+    void test() throws Exception {\n+        clean(TEST_ROOT);\n+        Files.createDirectories(GENSRC);\n+        Files.createDirectories(BIN);\n+        Files.createDirectories(HEADERS);\n+\n+        initialCompile();\n+        incrementalCompileWithChange();\n+    }\n+\n+    \/* Update A.java with a new timestamp and new final static definition.\n+     * This should trigger a recompile, not only of alfa, but also beta.\n+     * Generated native header should not be updated since native api of B was not modified.\n+     *\/\n+    void incrementalCompileWithChange() throws Exception {\n+        previous_bin_state = collectState(BIN);\n+        previous_headers_state = collectState(HEADERS);\n+        System.out.println(\"\\nIn incrementalCompileWithChange() \");\n+        System.out.println(\"A.java updated to trigger a recompile\");\n+        System.out.println(\"Generated native header should not be updated since native api of B was not modified\");\n+        tb.writeFile(GENSRC.resolve(\"alfa\/omega\/A.java\"),\n+                     \"package alfa.omega; public class A implements AINT { \" +\n+                     \"public final static int DEFINITION = 18;\" +\n+                     \"public void aint() { } private void foo() { } }\");\n+\n+        compile(GENSRC.toString(),\n+                \"-d\", BIN.toString(),\n+                \"--state-dir=\" + BIN,\n+                \"-h\", HEADERS.toString(),\n+                \"-j\", \"1\",\n+                \"--log=debug\");\n+        Map<String,Long> new_bin_state = collectState(BIN);\n+\n+        verifyNewerFiles(previous_bin_state, new_bin_state,\n+                         BIN + \"\/alfa\/omega\/A.class\",\n+                         BIN + \"\/alfa\/omega\/AINT.class\",\n+                         BIN + \"\/alfa\/omega\/AA$AAAA.class\",\n+                         BIN + \"\/alfa\/omega\/AAAAA.class\",\n+                         BIN + \"\/alfa\/omega\/AA$AAA.class\",\n+                         BIN + \"\/alfa\/omega\/AA.class\",\n+                         BIN + \"\/alfa\/omega\/AA$1.class\",\n+                         BIN + \"\/beta\/B.class\",\n+                         BIN + \"\/beta\/BINT.class\",\n+                         BIN + \"\/javac_state\");\n+        previous_bin_state = new_bin_state;\n+\n+        Map<String,Long> new_headers_state = collectState(HEADERS);\n+        verifyEqual(new_headers_state, previous_headers_state);\n+    }\n+}\n","filename":"test\/langtools\/tools\/sjavac\/IncCompileWithChanges.java","additions":103,"deletions":0,"binary":false,"changes":103,"status":"added"},{"patch":"@@ -0,0 +1,169 @@\n+\/*\n+ * Copyright (c) 2014, 2016, Oracle and\/or its affiliates. All rights reserved.\n+ * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+ *\n+ * This code is free software; you can redistribute it and\/or modify it\n+ * under the terms of the GNU General Public License version 2 only, as\n+ * published by the Free Software Foundation.\n+ *\n+ * This code is distributed in the hope that it will be useful, but WITHOUT\n+ * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+ * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+ * version 2 for more details (a copy is included in the LICENSE file that\n+ * accompanied this code).\n+ *\n+ * You should have received a copy of the GNU General Public License version\n+ * 2 along with this work; if not, write to the Free Software Foundation,\n+ * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n+ *\n+ * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n+ * or visit www.oracle.com if you need additional information or have any\n+ * questions.\n+ *\/\n+\n+\/*\n+ * @test\n+ * @bug 8037085\n+ * @summary Ensures that sjavac can handle various exclusion patterns.\n+ *\n+ * @modules jdk.compiler\/com.sun.tools.javac.main\n+ *          jdk.compiler\/com.sun.tools.sjavac\n+ *          jdk.compiler\/com.sun.tools.sjavac.server\n+ * @library \/tools\/lib\n+ * @build Wrapper toolbox.ToolBox toolbox.Assert\n+ * @run main Wrapper IncludeExcludePatterns\n+ *\/\n+\n+import java.io.File;\n+import java.io.IOException;\n+import java.nio.file.Files;\n+import java.nio.file.Path;\n+import java.nio.file.Paths;\n+import java.util.Arrays;\n+import java.util.Collection;\n+import java.util.HashSet;\n+import java.util.Set;\n+import java.util.stream.Collectors;\n+import java.util.stream.Stream;\n+\n+import com.sun.tools.javac.main.Main.Result;\n+\n+import toolbox.Assert;\n+\n+public class IncludeExcludePatterns extends SjavacBase {\n+\n+    final Path SRC = Paths.get(\"src\");\n+    final Path BIN = Paths.get(\"bin\");\n+    final Path STATE_DIR = Paths.get(\"state-dir\");\n+\n+    \/\/ An arbitrarily but sufficiently complicated source tree.\n+    final Path A = Paths.get(\"pkga\/A.java\");\n+    final Path X1 = Paths.get(\"pkga\/subpkg\/Xx.java\");\n+    final Path Y = Paths.get(\"pkga\/subpkg\/subsubpkg\/Y.java\");\n+    final Path B = Paths.get(\"pkgb\/B.java\");\n+    final Path C = Paths.get(\"pkgc\/C.java\");\n+    final Path X2 = Paths.get(\"pkgc\/Xx.java\");\n+\n+    final Path[] ALL_PATHS = {A, X1, Y, B, C, X2};\n+\n+    public static void main(String[] ignore) throws Exception {\n+        new IncludeExcludePatterns().runTest();\n+    }\n+\n+    public void runTest() throws IOException, ReflectiveOperationException {\n+        Files.createDirectories(BIN);\n+        Files.createDirectories(STATE_DIR);\n+        for (Path p : ALL_PATHS) {\n+            writeDummyClass(p);\n+        }\n+\n+        \/\/ Single file\n+        testPattern(\"pkga\/A.java\", A);\n+\n+        \/\/ Leading wild cards\n+        testPattern(\"*\/A.java\", A);\n+        testPattern(\"**\/Xx.java\", X1, X2);\n+        testPattern(\"**x.java\", X1, X2);\n+\n+        \/\/ Wild card in middle of path\n+        testPattern(\"pkga\/*\/Xx.java\", X1);\n+        testPattern(\"pkga\/**\/Y.java\", Y);\n+\n+        \/\/ Trailing wild cards\n+        testPattern(\"pkga\/*\", A);\n+        testPattern(\"pkga\/**\", A, X1, Y);\n+\n+        \/\/ Multiple wildcards\n+        testPattern(\"pkga\/*\/*\/Y.java\", Y);\n+        testPattern(\"**\/*\/**\", X1, Y);\n+\n+    }\n+\n+    \/\/ Given \"src\/pkg\/subpkg\/A.java\" this method returns \"A\"\n+    String classNameOf(Path javaFile) {\n+        return javaFile.getFileName()\n+                       .toString()\n+                       .replace(\".java\", \"\");\n+    }\n+\n+    \/\/ Puts an empty (dummy) class definition in the given path.\n+    void writeDummyClass(Path javaFile) throws IOException {\n+        String pkg = javaFile.getParent().toString().replace(File.separatorChar, '.');\n+        String cls = javaFile.getFileName().toString().replace(\".java\", \"\");\n+        toolbox.writeFile(SRC.resolve(javaFile), \"package \" + pkg + \"; class \" + cls + \" {}\");\n+    }\n+\n+    void testPattern(String filterArgs, Path... sourcesExpectedToBeVisible)\n+            throws ReflectiveOperationException, IOException {\n+        testFilter(\"-i \" + filterArgs, Arrays.asList(sourcesExpectedToBeVisible));\n+\n+        Set<Path> complement = new HashSet<>(Arrays.asList(ALL_PATHS));\n+        complement.removeAll(Arrays.asList(sourcesExpectedToBeVisible));\n+        testFilter(\"-x \" + filterArgs, complement);\n+    }\n+\n+    void testFilter(String filterArgs, Collection<Path> sourcesExpectedToBeVisible)\n+            throws IOException, ReflectiveOperationException {\n+        System.out.println(\"Testing filter: \" + filterArgs);\n+        toolbox.cleanDirectory(BIN);\n+        toolbox.cleanDirectory(STATE_DIR);\n+        String args = filterArgs + \" \" + SRC\n+                + \" -d \" + BIN\n+                + \" --state-dir=\" + STATE_DIR;\n+        int rc = compile((Object[]) args.split(\" \"));\n+\n+        \/\/ Compilation should always pass in these tests\n+        Assert.check(rc == Result.OK.exitCode, \"Compilation failed unexpectedly.\");\n+\n+        \/\/ The resulting .class files should correspond to the visible source files\n+        Set<Path> result = allFilesInDir(BIN);\n+        Set<Path> expected = correspondingClassFiles(sourcesExpectedToBeVisible);\n+        if (!result.equals(expected)) {\n+            System.out.println(\"Result:\");\n+            printPaths(result);\n+            System.out.println(\"Expected:\");\n+            printPaths(expected);\n+            Assert.error(\"Test case failed: \" + filterArgs);\n+        }\n+    }\n+\n+    void printPaths(Collection<Path> paths) {\n+        paths.stream()\n+             .sorted()\n+             .forEachOrdered(p -> System.out.println(\"    \" + p));\n+    }\n+\n+    \/\/ Given \"pkg\/A.java, pkg\/B.java\" this method returns \"bin\/pkg\/A.class, bin\/pkg\/B.class\"\n+    Set<Path> correspondingClassFiles(Collection<Path> javaFiles) {\n+        return javaFiles.stream()\n+                        .map(javaFile -> javaFile.resolveSibling(classNameOf(javaFile) + \".class\"))\n+                        .map(BIN::resolve)\n+                        .collect(Collectors.toSet());\n+    }\n+\n+    Set<Path> allFilesInDir(Path p) throws IOException {\n+        try (Stream<Path> files = Files.walk(p).filter(Files::isRegularFile)) {\n+            return files.collect(Collectors.toSet());\n+        }\n+    }\n+}\n","filename":"test\/langtools\/tools\/sjavac\/IncludeExcludePatterns.java","additions":169,"deletions":0,"binary":false,"changes":169,"status":"added"},{"patch":"@@ -0,0 +1,179 @@\n+\/*\n+ * Copyright (c) 2014, 2018, Oracle and\/or its affiliates. All rights reserved.\n+ * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+ *\n+ * This code is free software; you can redistribute it and\/or modify it\n+ * under the terms of the GNU General Public License version 2 only, as\n+ * published by the Free Software Foundation.\n+ *\n+ * This code is distributed in the hope that it will be useful, but WITHOUT\n+ * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+ * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+ * version 2 for more details (a copy is included in the LICENSE file that\n+ * accompanied this code).\n+ *\n+ * You should have received a copy of the GNU General Public License version\n+ * 2 along with this work; if not, write to the Free Software Foundation,\n+ * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n+ *\n+ * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n+ * or visit www.oracle.com if you need additional information or have any\n+ * questions.\n+ *\/\n+\n+\/*\n+ * @test\n+ * @bug 8035063\n+ * @summary Tests the preparation of javac-arguments.\n+ *\n+ * @modules jdk.compiler\/com.sun.tools.sjavac.options\n+ * @build Wrapper\n+ * @run main Wrapper JavacOptionPrep\n+ *\/\n+\n+import java.io.File;\n+import java.io.IOException;\n+import java.nio.file.Files;\n+import java.nio.file.Paths;\n+import java.util.Arrays;\n+import java.util.Iterator;\n+\n+import com.sun.tools.sjavac.options.Options;\n+\n+\n+public class JavacOptionPrep {\n+\n+    enum TestPath {\n+        CP1, CP2, SRC1, SRC2, SOURCEPATH1, SOURCEPATH2;\n+\n+        public String toString() {\n+            return name().toLowerCase();\n+        }\n+    }\n+\n+    private final static String SEP = File.pathSeparator;\n+\n+    public static void main(String[] unused) throws IOException {\n+\n+        for (TestPath p : TestPath.values())\n+            Files.createDirectory(Paths.get(p.toString()));\n+\n+        \/\/ Test some various cases:\n+        \/\/  - Paths combined with File.pathSeparator (CP1 \/ CP2)\n+        \/\/  - Paths given as duplicate options (SOURCEPATH1 \/ SOURCEPATH2)\n+        \/\/  - Sources provided by -src (SRC1)\n+        \/\/  - Sources provided without preceding option (SRC2)\n+        \/\/  - An unrecognized option which is to be passed on to javac\n+        String sjavacArgs = \"-cp \" + TestPath.CP1 + SEP + TestPath.CP2 +\n+                            \" -d dest\" +\n+                            \" -h header\" +\n+                            \" -sourcepath \" + TestPath.SOURCEPATH1 +\n+                            \" -src \" + TestPath.SRC1 +\n+                            \" -s gensrc\" +\n+                            \" -sourcepath \" + TestPath.SOURCEPATH2 +\n+                            \" \" + TestPath.SRC2 +\n+                            \" -unrecognized\";\n+\n+        Options options = Options.parseArgs(sjavacArgs.split(\" \"));\n+\n+        \/\/ Extract javac-options\n+        String[] javacArgs = options.prepJavacArgs();\n+\n+        \/\/ Check the result\n+        boolean destDirFound = false;\n+        boolean userPathsFirst = false;\n+        boolean headerDirFound = false;\n+        boolean gensrcDirFound = false;\n+        boolean classPathFound = false;\n+        boolean sourcePathFound = false;\n+        boolean unrecognizedFound = false;\n+        boolean implicitNoneFound = false;\n+\n+        Iterator<String> javacArgIter = Arrays.asList(javacArgs).iterator();\n+        while (javacArgIter.hasNext()) {\n+\n+            String option = javacArgIter.next();\n+\n+            \/\/ Ignore this option for now. When the file=... requirement goes\n+            \/\/ away, this will be easier to handle.\n+            if (option.startsWith(\"--debug=completionDeps\"))\n+                continue;\n+\n+            switch (option) {\n+            case \"-classpath\":\n+            case \"-cp\":\n+                classPathFound = true;\n+                assertEquals(TestPath.CP1 + SEP + TestPath.CP2,\n+                             javacArgIter.next());\n+                break;\n+\n+            case \"-d\":\n+                destDirFound = true;\n+                assertEquals(Paths.get(\"dest\").toAbsolutePath().toString(),\n+                             javacArgIter.next());\n+                break;\n+\n+            case \"-h\":\n+                headerDirFound = true;\n+                assertEquals(Paths.get(\"header\").toAbsolutePath().toString(),\n+                             javacArgIter.next());\n+                break;\n+\n+            case \"-s\":\n+                gensrcDirFound = true;\n+                assertEquals(Paths.get(\"gensrc\").toAbsolutePath().toString(),\n+                             javacArgIter.next());\n+                break;\n+\n+            case \"-sourcepath\":\n+                sourcePathFound = true;\n+                assertEquals(TestPath.SRC1 + SEP +\n+                             TestPath.SRC2 + SEP +\n+                             TestPath.SOURCEPATH1 + SEP +\n+                             TestPath.SOURCEPATH2,\n+                             javacArgIter.next());\n+                break;\n+\n+            case \"-unrecognized\":\n+                unrecognizedFound = true;\n+                break;\n+\n+            case \"-implicit:none\":\n+                implicitNoneFound = true;\n+                break;\n+\n+                \/\/ Note that *which* files to actually compile is not dealt\n+                \/\/ with by prepJavacArgs.\n+\n+            default:\n+                throw new AssertionError(\"Unexpected option found: \" + option);\n+            }\n+        }\n+\n+        if (!destDirFound)\n+            throw new AssertionError(\"Dest directory not found.\");\n+\n+        if (!headerDirFound)\n+            throw new AssertionError(\"Header directory not found.\");\n+\n+        if (!gensrcDirFound)\n+            throw new AssertionError(\"Generated source directory not found.\");\n+\n+        if (!classPathFound)\n+            throw new AssertionError(\"Class path not found.\");\n+\n+        if (!sourcePathFound)\n+            throw new AssertionError(\"Source path not found.\");\n+\n+        if (!unrecognizedFound)\n+            throw new AssertionError(\"\\\"-unrecognized\\\" not found.\");\n+\n+        if (!implicitNoneFound)\n+            throw new AssertionError(\"\\\"-implicit:none\\\" not found.\");\n+    }\n+\n+    static void assertEquals(Object expected, Object actual) {\n+        if (!expected.equals(actual))\n+            throw new AssertionError(\"Expected \" + expected + \" but got \" + actual);\n+    }\n+}\n","filename":"test\/langtools\/tools\/sjavac\/JavacOptionPrep.java","additions":179,"deletions":0,"binary":false,"changes":179,"status":"added"},{"patch":"@@ -0,0 +1,66 @@\n+\/*\n+ * Copyright (c) 2015, 2016, Oracle and\/or its affiliates. All rights reserved.\n+ * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+ *\n+ * This code is free software; you can redistribute it and\/or modify it\n+ * under the terms of the GNU General Public License version 2 only, as\n+ * published by the Free Software Foundation.\n+ *\n+ * This code is distributed in the hope that it will be useful, but WITHOUT\n+ * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+ * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+ * version 2 for more details (a copy is included in the LICENSE file that\n+ * accompanied this code).\n+ *\n+ * You should have received a copy of the GNU General Public License version\n+ * 2 along with this work; if not, write to the Free Software Foundation,\n+ * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n+ *\n+ * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n+ * or visit www.oracle.com if you need additional information or have any\n+ * questions.\n+ *\/\n+\n+\/*\n+ * @test\n+ * @summary Test --no-state option\n+ * @bug 8135131\n+  * @library \/tools\/lib\n+ * @modules jdk.compiler\/com.sun.tools.javac.api\n+ *          jdk.compiler\/com.sun.tools.javac.main\n+ *          jdk.compiler\/com.sun.tools.sjavac\n+ * @build Wrapper toolbox.ToolBox toolbox.Assert\n+ * @run main Wrapper NoState\n+ *\/\n+\n+import java.io.IOException;\n+import java.nio.file.*;\n+import java.util.stream.Stream;\n+\n+import toolbox.Assert;\n+\n+public class NoState extends SJavacTester {\n+    public static void main(String... args) throws Exception {\n+        new NoState().run();\n+    }\n+\n+    public void run() throws Exception {\n+        tb.writeFile(GENSRC.resolve(\"pkg\/A.java\"), \"package pkg; class A {}\");\n+        Files.createDirectory(BIN);\n+        compile(\"-d\", BIN.toString(),\n+                GENSRC + \"\/pkg\/A.java\");\n+\n+        \/\/ Make sure file was compiled\n+        Assert.check(Files.exists(BIN.resolve(\"pkg\/A.class\")));\n+\n+        \/\/ Make sure we have no other files (such as a javac_state file) in the bin directory\n+        Assert.check(countPathsInDir(BIN) == 1);\n+        Assert.check(countPathsInDir(BIN.resolve(\"pkg\")) == 1);\n+    }\n+\n+    private long countPathsInDir(Path dir) throws IOException {\n+        try (Stream<Path> files = Files.list(dir)) {\n+            return files.count();\n+        }\n+    }\n+}\n","filename":"test\/langtools\/tools\/sjavac\/NoState.java","additions":66,"deletions":0,"binary":false,"changes":66,"status":"added"},{"patch":"@@ -0,0 +1,174 @@\n+\/*\n+ * Copyright (c) 2014, 2016, Oracle and\/or its affiliates. All rights reserved.\n+ * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+ *\n+ * This code is free software; you can redistribute it and\/or modify it\n+ * under the terms of the GNU General Public License version 2 only, as\n+ * published by the Free Software Foundation.\n+ *\n+ * This code is distributed in the hope that it will be useful, but WITHOUT\n+ * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+ * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+ * version 2 for more details (a copy is included in the LICENSE file that\n+ * accompanied this code).\n+ *\n+ * You should have received a copy of the GNU General Public License version\n+ * 2 along with this work; if not, write to the Free Software Foundation,\n+ * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n+ *\n+ * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n+ * or visit www.oracle.com if you need additional information or have any\n+ * questions.\n+ *\/\n+\n+\/*\n+ * @test\n+ * @bug 8035063 8054465\n+ * @summary Tests decoding of String[] into Options.\n+ *\n+ * @modules jdk.compiler\/com.sun.tools.sjavac\n+ *          jdk.compiler\/com.sun.tools.sjavac.client\n+ *          jdk.compiler\/com.sun.tools.sjavac.comp\n+ *          jdk.compiler\/com.sun.tools.sjavac.options\n+ * @build Wrapper\n+ * @run main Wrapper OptionDecoding\n+ *\/\n+\n+import static util.OptionTestUtil.assertEquals;\n+import static util.OptionTestUtil.checkFilesFound;\n+\n+import java.io.File;\n+import java.io.IOException;\n+import java.nio.file.Files;\n+import java.nio.file.Path;\n+import java.nio.file.Paths;\n+import java.util.ArrayList;\n+import java.util.Arrays;\n+import java.util.Collections;\n+import java.util.HashMap;\n+import java.util.List;\n+import java.util.Map;\n+\n+import com.sun.tools.sjavac.CopyFile;\n+import com.sun.tools.sjavac.Module;\n+import com.sun.tools.sjavac.Source;\n+import com.sun.tools.sjavac.client.ClientMain;\n+import com.sun.tools.sjavac.comp.SjavacImpl;\n+import com.sun.tools.sjavac.options.Options;\n+import com.sun.tools.sjavac.options.SourceLocation;\n+\n+public class OptionDecoding {\n+\n+    public static void main(String[] args) throws IOException {\n+        testPaths();\n+        testDupPaths();\n+        testSimpleOptions();\n+        testServerConf();\n+        testSearchPaths();\n+        testTranslationRules();\n+    }\n+\n+    \/\/ Test decoding of output paths\n+    static void testPaths() throws IOException {\n+        final String H = \"headers\";\n+        final String G = \"gensrc\";\n+        final String D = \"dest\";\n+        final String stateDir = \"stateDir\";\n+        final String CMP = \"srcRefList.txt\";\n+\n+        Options options = Options.parseArgs(\"-h\", H, \"-s\", G, \"-d\", D, \"--state-dir=\" + stateDir,\n+                                            \"--compare-found-sources\", CMP);\n+\n+        assertEquals(Paths.get(H).toAbsolutePath(), options.getHeaderDir());\n+        assertEquals(Paths.get(G).toAbsolutePath(), options.getGenSrcDir());\n+        assertEquals(Paths.get(D).toAbsolutePath(), options.getDestDir());\n+        assertEquals(Paths.get(stateDir).toAbsolutePath(), options.getStateDir());\n+        assertEquals(Paths.get(CMP), options.getSourceReferenceList());\n+    }\n+\n+    \/\/ Providing duplicate header \/ dest \/ gensrc paths should produce an error.\n+    static void testDupPaths() throws IOException {\n+        try {\n+            Options.parseArgs(\"-h\", \"dir1\", \"-h\", \"dir2\");\n+            throw new RuntimeException(\"Duplicate header directories should fail.\");\n+        } catch (IllegalArgumentException iae) {\n+            \/\/ Expected\n+        }\n+\n+        try {\n+            Options.parseArgs(\"-s\", \"dir1\", \"-s\", \"dir2\");\n+            throw new RuntimeException(\"Duplicate paths for generated sources should fail.\");\n+        } catch (IllegalArgumentException iae) {\n+            \/\/ Expected\n+        }\n+\n+        try {\n+            Options.parseArgs(\"-d\", \"dir1\", \"-d\", \"dir2\");\n+            throw new RuntimeException(\"Duplicate destination directories should fail.\");\n+        } catch (IllegalArgumentException iae) {\n+            \/\/ Expected\n+        }\n+    }\n+\n+    \/\/ Test basic options\n+    static void testSimpleOptions() {\n+        Options options = Options.parseArgs(\"-j\", \"17\", \"--log=debug\");\n+        assertEquals(17, options.getNumCores());\n+        assertEquals(\"debug\", options.getLogLevel());\n+        assertEquals(false, options.isDefaultPackagePermitted());\n+        assertEquals(false, options.areUnidentifiedArtifactsPermitted());\n+        assertEquals(false, options.isUnidentifiedArtifactPermitted(Paths.get(\"bar.txt\").toFile().getAbsolutePath()));\n+\n+        options = Options.parseArgs(\"--permit-unidentified-artifacts\",\n+                                    \"--permit-artifact=bar.txt\",\n+                                    \"--permit-sources-without-package\");\n+        assertEquals(\"info\", options.getLogLevel());\n+        assertEquals(true, options.isDefaultPackagePermitted());\n+        assertEquals(true, options.areUnidentifiedArtifactsPermitted());\n+        assertEquals(true, options.isUnidentifiedArtifactPermitted(Paths.get(\"bar.txt\").toFile().getAbsolutePath()));\n+    }\n+\n+    \/\/ Test server configuration options\n+    static void testServerConf() {\n+        Options options = Options.parseArgs(\"--server:someServerConfiguration\");\n+        assertEquals(\"someServerConfiguration\", options.getServerConf());\n+        assertEquals(false, options.startServerFlag());\n+\n+        options = Options.parseArgs(\"--startserver:someServerConfiguration\");\n+        assertEquals(\"someServerConfiguration\", options.getServerConf());\n+        assertEquals(true, options.startServerFlag());\n+    }\n+\n+    \/\/ Test input paths\n+    static void testSearchPaths() {\n+        List<String> i, x, iF, xF;\n+        i = x = iF = xF = new ArrayList<>();\n+\n+        SourceLocation dir1 = new SourceLocation(Paths.get(\"dir1\"), i, x);\n+        SourceLocation dir2 = new SourceLocation(Paths.get(\"dir2\"), i, x);\n+        String dir1_PS_dir2 = \"dir1\" + File.pathSeparator + \"dir2\";\n+\n+        Options options = Options.parseArgs(\"--source-path\", dir1_PS_dir2);\n+        assertEquals(options.getSourceSearchPaths(), Arrays.asList(dir1, dir2));\n+\n+        options = Options.parseArgs(\"--module-path\", dir1_PS_dir2);\n+        assertEquals(options.getModuleSearchPaths(), Arrays.asList(dir1, dir2));\n+\n+        options = Options.parseArgs(\"--class-path\", dir1_PS_dir2);\n+        assertEquals(options.getClassSearchPath(), Arrays.asList(dir1, dir2));\n+    }\n+\n+    \/\/ Test -tr option\n+    static void testTranslationRules() {\n+        Class<?> cls = com.sun.tools.sjavac.CompileJavaPackages.class;\n+\n+        Options options = Options.parseArgs(\n+                \"-tr\", \".exa=\" + cls.getName(),\n+                \"-tr\", \".exb=\" + cls.getName(),\n+                \"-copy\", \".html\");\n+\n+        assertEquals(cls, options.getTranslationRules().get(\".exa\").getClass());\n+        assertEquals(cls, options.getTranslationRules().get(\".exb\").getClass());\n+        assertEquals(CopyFile.class, options.getTranslationRules().get(\".html\").getClass());\n+    }\n+}\n","filename":"test\/langtools\/tools\/sjavac\/OptionDecoding.java","additions":174,"deletions":0,"binary":false,"changes":174,"status":"added"},{"patch":"@@ -0,0 +1,101 @@\n+\/*\n+ * Copyright (c) 2016, Oracle and\/or its affiliates. All rights reserved.\n+ * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+ *\n+ * This code is free software; you can redistribute it and\/or modify it\n+ * under the terms of the GNU General Public License version 2 only, as\n+ * published by the Free Software Foundation.\n+ *\n+ * This code is distributed in the hope that it will be useful, but WITHOUT\n+ * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+ * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+ * version 2 for more details (a copy is included in the LICENSE file that\n+ * accompanied this code).\n+ *\n+ * You should have received a copy of the GNU General Public License version\n+ * 2 along with this work; if not, write to the Free Software Foundation,\n+ * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n+ *\n+ * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n+ * or visit www.oracle.com if you need additional information or have any\n+ * questions.\n+ *\/\n+\n+\/*\n+ * @test\n+ * @summary Make sure sjavac doesn't allow overlapping source and destination\n+ *          directories.\n+ * @bug 8061320\n+ * @library \/tools\/lib\n+ * @modules jdk.compiler\/com.sun.tools.javac.api\n+ *          jdk.compiler\/com.sun.tools.javac.main\n+ *          jdk.compiler\/com.sun.tools.sjavac\n+ * @build Wrapper toolbox.ToolBox\n+ * @run main Wrapper OverlappingSrcDst\n+ *\/\n+\n+import java.io.File;\n+import java.nio.file.Paths;\n+\n+import toolbox.ToolBox;\n+\n+public class OverlappingSrcDst extends SJavacTester {\n+    public static void main(String... args) {\n+        new OverlappingSrcDst().run();\n+    }\n+\n+    public void run() {\n+        String abs = ToolBox.currDir.toAbsolutePath().toString();\n+\n+        \/\/ Relative vs relative\n+        test(\"dir\", \"dir\", false);\n+        test(\"dir\", \"dir\/dst\", false);\n+        test(\"dir\/src\", \"dir\", false);\n+        test(\"src\", \"dst\", true);\n+\n+        \/\/ Absolute vs absolute\n+        test(abs + \"\/dir\", abs + \"\/dir\", false);\n+        test(abs + \"\/dir\", abs + \"\/dir\/dst\", false);\n+        test(abs + \"\/dir\/src\", abs + \"\/dir\", false);\n+        test(abs + \"\/src\", abs + \"\/dst\", true);\n+\n+        \/\/ Absolute vs relative\n+        test(abs + \"\/dir\", \"dir\", false);\n+        test(abs + \"\/dir\", \"dir\/dst\", false);\n+        test(abs + \"\/dir\/src\", \"dir\", false);\n+        test(abs + \"\/src\", \"dst\", true);\n+\n+        \/\/ Relative vs absolute\n+        test(\"dir\", abs + \"\/dir\", false);\n+        test(\"dir\", abs + \"\/dir\/dst\", false);\n+        test(\"dir\/src\", abs + \"\/dir\", false);\n+        test(\"src\", abs + \"\/dst\", true);\n+    }\n+\n+    private void test(String srcDir, String dstDir, boolean shouldSucceed) {\n+        boolean succeeded = testCompilation(srcDir, dstDir);\n+        if (shouldSucceed != succeeded) {\n+            throw new AssertionError(\n+                    String.format(\"Test failed for \"\n+                                          + \"srcDir=\\\"%s\\\", \"\n+                                          + \"dstDir=\\\"%s\\\". \"\n+                                          + \"Compilation was expected to %s but %s.\",\n+                                  srcDir,\n+                                  dstDir,\n+                                  shouldSucceed ? \"succeed\" : \"fail\",\n+                                  succeeded ? \"succeeded\" : \"failed\"));\n+        }\n+    }\n+\n+    private boolean testCompilation(String srcDir, String dstDir) {\n+        try {\n+            srcDir = srcDir.replace('\/', File.separatorChar);\n+            dstDir = dstDir.replace('\/', File.separatorChar);\n+            tb.writeFile(Paths.get(srcDir, \"pkg\", \"A.java\"), \"package pkg; class A {}\");\n+            compile(\"--state-dir=state\", \"-src\", srcDir, \"-d\", dstDir);\n+            return true;\n+        } catch (Exception e) {\n+            return false;\n+        }\n+    }\n+}\n","filename":"test\/langtools\/tools\/sjavac\/OverlappingSrcDst.java","additions":101,"deletions":0,"binary":false,"changes":101,"status":"added"},{"patch":"@@ -0,0 +1,56 @@\n+\/*\n+ * Copyright (c) 2014, 2016, Oracle and\/or its affiliates. All rights reserved.\n+ * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+ *\n+ * This code is free software; you can redistribute it and\/or modify it\n+ * under the terms of the GNU General Public License version 2 only, as\n+ * published by the Free Software Foundation.\n+ *\n+ * This code is distributed in the hope that it will be useful, but WITHOUT\n+ * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+ * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+ * version 2 for more details (a copy is included in the LICENSE file that\n+ * accompanied this code).\n+ *\n+ * You should have received a copy of the GNU General Public License version\n+ * 2 along with this work; if not, write to the Free Software Foundation,\n+ * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n+ *\n+ * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n+ * or visit www.oracle.com if you need additional information or have any\n+ * questions.\n+ *\/\n+\n+\/*\n+ * @test\n+ * @bug 8059349\n+ * @summary This test makes sure file paths matches package declarations\n+ * @library \/tools\/lib\n+ * @modules jdk.compiler\/com.sun.tools.javac.api\n+ *          jdk.compiler\/com.sun.tools.javac.main\n+ *          jdk.compiler\/com.sun.tools.sjavac\n+ * @build Wrapper toolbox.ToolBox\n+ * @run main Wrapper PackagePathMismatch\n+ *\/\n+\n+import java.nio.file.Path;\n+import java.nio.file.Paths;\n+\n+public class PackagePathMismatch extends SjavacBase {\n+    public static void main(String... args) throws Exception {\n+\n+        Path root = Paths.get(PackagePathMismatch.class.getSimpleName() + \"Test\");\n+        Path src = root.resolve(\"src\");\n+        Path classes = root.resolve(\"classes\");\n+\n+        toolbox.writeFile(src.resolve(\"a\/x\/c\/Test.java\"),\n+                          \"package a.b.c; class Test { }\");\n+\n+        \/\/ Compile should fail since package a.b.c does not match path a\/x\/c.\n+        int rc1 = compile(\"-d\", classes,\n+                          \"--state-dir=\" + classes,\n+                          src);\n+        if (rc1 == 0)\n+            throw new AssertionError(\"Compilation succeeded unexpectedly\");\n+    }\n+}\n","filename":"test\/langtools\/tools\/sjavac\/PackagePathMismatch.java","additions":56,"deletions":0,"binary":false,"changes":56,"status":"added"},{"patch":"@@ -0,0 +1,63 @@\n+\/*\n+ * Copyright (c) 2015, 2016, Oracle and\/or its affiliates. All rights reserved.\n+ * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+ *\n+ * This code is free software; you can redistribute it and\/or modify it\n+ * under the terms of the GNU General Public License version 2 only, as\n+ * published by the Free Software Foundation.\n+ *\n+ * This code is distributed in the hope that it will be useful, but WITHOUT\n+ * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+ * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+ * version 2 for more details (a copy is included in the LICENSE file that\n+ * accompanied this code).\n+ *\n+ * You should have received a copy of the GNU General Public License version\n+ * 2 along with this work; if not, write to the Free Software Foundation,\n+ * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n+ *\n+ * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n+ * or visit www.oracle.com if you need additional information or have any\n+ * questions.\n+ *\/\n+\n+\/*\n+ * @test\n+ * @summary Test to check that -j option works with more than one value\n+ * @bug 8071629\n+ * @author sogoel\n+ * @library \/tools\/lib\n+ * @modules jdk.compiler\/com.sun.tools.javac.api\n+ *          jdk.compiler\/com.sun.tools.javac.main\n+ *          jdk.compiler\/com.sun.tools.sjavac\n+ * @build Wrapper toolbox.ToolBox\n+ * @run main Wrapper ParallelCompilations\n+ *\/\n+\n+import java.io.*;\n+import java.nio.file.*;\n+import com.sun.tools.sjavac.Main;\n+\n+class ParallelCompilations extends SJavacTester {\n+  public static void main(String[] args) throws Exception {\n+    new ParallelCompilations().run();\n+  }\n+\n+  public void run() throws Exception {\n+    \/\/ Generate 10 files\n+    for (int i = 0; i < 10; i++) {\n+      String content = \"package foo\"+ i + \";\\n\" +\n+                       \"public class Test\" + i + \"{\\n\" +\n+                       \"  public static void main(String[] args) {}\\n\" +\n+                       \"\\n}\";\n+      Path srcDir = Paths.get(\"src\");\n+      tb.writeJavaFiles(srcDir, content);\n+    }\n+    \/\/ Method will throw an exception if compilation fails\n+    compile(\"src\",\n+            \"-d\", BIN.toString(),\n+            \"--state-dir=\" + BIN,\n+            \"-j\", \"10\",\n+            \"--log=debug\");\n+  }\n+}\n","filename":"test\/langtools\/tools\/sjavac\/ParallelCompilations.java","additions":63,"deletions":0,"binary":false,"changes":63,"status":"added"},{"patch":"@@ -0,0 +1,72 @@\n+\/*\n+ * Copyright (c) 2014, 2016, Oracle and\/or its affiliates. All rights reserved.\n+ * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+ *\n+ * This code is free software; you can redistribute it and\/or modify it\n+ * under the terms of the GNU General Public License version 2 only, as\n+ * published by the Free Software Foundation.\n+ *\n+ * This code is distributed in the hope that it will be useful, but WITHOUT\n+ * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+ * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+ * version 2 for more details (a copy is included in the LICENSE file that\n+ * accompanied this code).\n+ *\n+ * You should have received a copy of the GNU General Public License version\n+ * 2 along with this work; if not, write to the Free Software Foundation,\n+ * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n+ *\n+ * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n+ * or visit www.oracle.com if you need additional information or have any\n+ * questions.\n+ *\/\n+\n+\/*\n+ * @test\n+ * @summary Test white listing of external artifacts inside the destination dir\n+ * @bug 8054689\n+ * @author Fredrik O\n+ * @author sogoel (rewrite)\n+ * @library \/tools\/lib\n+ * @modules jdk.compiler\/com.sun.tools.javac.api\n+ *          jdk.compiler\/com.sun.tools.javac.main\n+ *          jdk.compiler\/com.sun.tools.sjavac\n+ * @build Wrapper toolbox.ToolBox\n+ * @run main Wrapper PermittedArtifact\n+ *\/\n+\n+import java.nio.file.Files;\n+import java.util.Map;\n+\n+public class PermittedArtifact extends SJavacTester {\n+    public static void main(String... args) throws Exception {\n+        PermittedArtifact pa = new PermittedArtifact();\n+        pa.test();\n+    }\n+\n+    \/\/Verify that --permit-artifact=bin works\n+    void test() throws Exception {\n+        Files.createDirectories(BIN);\n+\n+        Map<String,Long> previous_bin_state = collectState(BIN);\n+\n+        tb.writeFile(GENSRC + \"\/alfa\/omega\/A.java\",\n+                     \"package alfa.omega; public class A { }\");\n+\n+        tb.writeFile(BIN + \"\/alfa\/omega\/AA.class\",\n+                     \"Ugh, a messy build system (tobefixed) wrote this class file, \" +\n+                     \"sjavac must not delete it.\");\n+\n+        compile(\"--log=debug\",\n+                \"--permit-artifact=\" + BIN + \"\/alfa\/omega\/AA.class\",\n+                \"-src\", GENSRC.toString(),\n+                \"-d\", BIN.toString(),\n+                \"--state-dir=\" + BIN);\n+\n+        Map<String,Long> new_bin_state = collectState(BIN);\n+        verifyThatFilesHaveBeenAdded(previous_bin_state, new_bin_state,\n+                                     BIN + \"\/alfa\/omega\/A.class\",\n+                                     BIN + \"\/alfa\/omega\/AA.class\",\n+                                     BIN + \"\/javac_state\");\n+    }\n+}\n","filename":"test\/langtools\/tools\/sjavac\/PermittedArtifact.java","additions":72,"deletions":0,"binary":false,"changes":72,"status":"added"},{"patch":"@@ -0,0 +1,136 @@\n+\/*\n+ * Copyright (c) 2014, 2016, Oracle and\/or its affiliates. All rights reserved.\n+ * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+ *\n+ * This code is free software; you can redistribute it and\/or modify it\n+ * under the terms of the GNU General Public License version 2 only, as\n+ * published by the Free Software Foundation.\n+ *\n+ * This code is distributed in the hope that it will be useful, but WITHOUT\n+ * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+ * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+ * version 2 for more details (a copy is included in the LICENSE file that\n+ * accompanied this code).\n+ *\n+ * You should have received a copy of the GNU General Public License version\n+ * 2 along with this work; if not, write to the Free Software Foundation,\n+ * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n+ *\n+ * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n+ * or visit www.oracle.com if you need additional information or have any\n+ * questions.\n+ *\/\n+\n+\/*\n+ * @test\n+ * @bug 8044131\n+ * @summary Makes sure sjavac poolsize option is honored.\n+ * @modules jdk.compiler\/com.sun.tools.javac.main\n+ *          jdk.compiler\/com.sun.tools.sjavac.comp\n+ *          jdk.compiler\/com.sun.tools.sjavac.server\n+ * @build Wrapper\n+ * @run main Wrapper PooledExecution\n+ *\/\n+\n+import java.util.concurrent.CountDownLatch;\n+import java.util.concurrent.atomic.AtomicInteger;\n+\n+import com.sun.tools.javac.main.Main.Result;\n+import com.sun.tools.sjavac.comp.PooledSjavac;\n+import com.sun.tools.sjavac.server.Sjavac;\n+\n+\n+public class PooledExecution {\n+\n+    public static void main(String[] args) throws InterruptedException {\n+        new PooledExecutionTest().runTest();\n+    }\n+\n+    static class PooledExecutionTest {\n+\n+        final int POOL_SIZE = 15;\n+        final int NUM_REQUESTS = 100;\n+\n+        \/\/ Number of tasks that has not yet started\n+        CountDownLatch leftToStart = new CountDownLatch(NUM_REQUESTS);\n+\n+        \/\/ Highest number of concurrently active request seen\n+        int highWaterMark = 0;\n+\n+        public void runTest() throws InterruptedException {\n+            ConcurrencyLoggingService loggingService = new ConcurrencyLoggingService();\n+            final Sjavac service = new PooledSjavac(loggingService, POOL_SIZE);\n+\n+            \/\/ Keep track of the number of finished tasks so we can make sure all\n+            \/\/ tasks finishes gracefully upon shutdown.\n+            Thread[] tasks = new Thread[NUM_REQUESTS];\n+            final AtomicInteger tasksFinished = new AtomicInteger(0);\n+\n+            for (int i = 0; i < NUM_REQUESTS; i++) {\n+                tasks[i] = new Thread() {\n+                    public void run() {\n+                        service.compile(new String[0]);\n+                        tasksFinished.incrementAndGet();\n+                    }\n+                };\n+                tasks[i].start();\n+            }\n+\n+            \/\/ Wait for all tasks to start (but not necessarily run to completion)\n+            leftToStart.await();\n+\n+            \/\/ Shutdown before all tasks are completed\n+            System.out.println(\"Shutting down!\");\n+            service.shutdown();\n+\n+            \/\/ Wait for all tasks to complete\n+            for (Thread t : tasks)\n+                t.join();\n+\n+            if (tasksFinished.get() != NUM_REQUESTS) {\n+                throw new AssertionError(tasksFinished.get() + \" out of \" +\n+                        NUM_REQUESTS + \" finished. Broken shutdown?\");\n+            }\n+\n+            if (highWaterMark > POOL_SIZE) {\n+                throw new AssertionError(\"Pool size overused: \" + highWaterMark +\n+                                         \" used out of \" + POOL_SIZE + \" allowed.\");\n+            }\n+\n+            \/\/ Assuming more than POOL_SIZE requests can be processed within 1 sek:\n+            if (highWaterMark < POOL_SIZE) {\n+                throw new AssertionError(\"Pool size underused: \" + highWaterMark +\n+                                         \" used out of \" + POOL_SIZE + \" allowed.\");\n+            }\n+        }\n+\n+\n+        private class ConcurrencyLoggingService implements Sjavac {\n+\n+            \/\/ Keeps track of currently active requests\n+            AtomicInteger activeRequests = new AtomicInteger(0);\n+\n+            @Override\n+            public Result compile(String[] args) {\n+                leftToStart.countDown();\n+                int numActiveRequests = activeRequests.incrementAndGet();\n+                System.out.printf(\"Left to start: %2d \/ Currently active: %2d%n\",\n+                                  leftToStart.getCount(),\n+                                  numActiveRequests);\n+                highWaterMark = Math.max(highWaterMark, numActiveRequests);\n+                try {\n+                    Thread.sleep(1000);\n+                } catch (InterruptedException ie) {\n+                    throw new RuntimeException(\"Interrupted\", ie);\n+                }\n+                activeRequests.decrementAndGet();\n+                System.out.println(\"Task completed\");\n+                return Result.OK;\n+            }\n+\n+            @Override\n+            public void shutdown() {\n+            }\n+        }\n+    }\n+}\n","filename":"test\/langtools\/tools\/sjavac\/PooledExecution.java","additions":136,"deletions":0,"binary":false,"changes":136,"status":"added"},{"patch":"@@ -0,0 +1,109 @@\n+\/*\n+ * Copyright (c) 2020, Oracle and\/or its affiliates. All rights reserved.\n+ * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+ *\n+ * This code is free software; you can redistribute it and\/or modify it\n+ * under the terms of the GNU General Public License version 2 only, as\n+ * published by the Free Software Foundation.\n+ *\n+ * This code is distributed in the hope that it will be useful, but WITHOUT\n+ * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+ * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+ * version 2 for more details (a copy is included in the LICENSE file that\n+ * accompanied this code).\n+ *\n+ * You should have received a copy of the GNU General Public License version\n+ * 2 along with this work; if not, write to the Free Software Foundation,\n+ * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n+ *\n+ * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n+ * or visit www.oracle.com if you need additional information or have any\n+ * questions.\n+ *\/\n+\n+ \/*\n+ * @test\n+ * @bug 8241312 8246774\n+ * @summary test for com.sun.tools.sjavac.comp.PubAPIs and com.sun.tools.sjavac.comp.PubapiVisitor\n+ * @library \/tools\/lib\n+ * @modules jdk.compiler\/com.sun.tools.javac.util\n+ *          jdk.compiler\/com.sun.tools.sjavac.comp\n+ *          jdk.compiler\/com.sun.tools.sjavac.pubapi\n+ *\/\n+import com.sun.source.util.JavacTask;\n+import com.sun.tools.javac.util.Context;\n+import java.io.IOException;\n+import com.sun.tools.sjavac.comp.PubAPIs;\n+import com.sun.tools.sjavac.pubapi.PubApi;\n+import java.net.URI;\n+import static java.util.Arrays.asList;\n+import static java.util.Collections.emptySet;\n+import java.util.List;\n+import javax.tools.JavaFileObject;\n+import javax.tools.SimpleJavaFileObject;\n+import javax.tools.ToolProvider;\n+\n+public class PubApisTest {\n+\n+    public static void main(String[] args) throws Throwable {\n+        javax.tools.JavaCompiler c = ToolProvider.getSystemJavaCompiler();\n+        JavacTask t = (JavacTask) c.getTask(null, null, null, null, null,\n+                List.of(new SimpleJavaFileObject(URI.create(\"TestClass.java\"), JavaFileObject.Kind.SOURCE) {\n+            @Override\n+            public CharSequence getCharContent(boolean ignoreEncodingErrors) throws IOException {\n+                return String.join(\"\\n\",\n+                        \"import java.util.*;\",\n+                        \"public final class TestClass {\",\n+                        \"    private String s1 = \\\"str 1\\\";\",\n+                        \"    public String s2 = \\\"str 2\\\";\",\n+                        \"    protected final String s3 = \\\"str 3\\\";\",\n+                        \"    static String s4 = \\\"str 4\\\";\",\n+                        \"    protected TestClass(int i) {}\",\n+                        \"    protected void m1() {}\",\n+                        \"    public static Map<Integer, List<String>> m2() {\",\n+                        \"        return null;\",\n+                        \"    }\",\n+                        \"    final void m3(Set<Map<Integer, Map<String, String>>> s) {}\",\n+                        \"    static class DummyInner1 implements Runnable {\",\n+                        \"        protected int field;\",\n+                        \"        public void run() {}\",\n+                        \"    }\",\n+                        \"    final class DummyInner2 { }\",\n+                        \"    public record Record3(int f1, String f2) {}\",\n+                        \"}\");\n+            }\n+        }));\n+        PubAPIs apis = PubAPIs.instance(new Context());\n+        t.analyze().forEach(apis::visitPubapi);\n+        PubApi actualApi = (PubApi) apis.getPubapis(emptySet(), false).get(\":\");\n+        PubApi expectedApi = new PubApi();\n+        asList( \"TYPE final public TestClass\",\n+                \"  VAR public java.lang.String s2\",\n+                \"  VAR final protected java.lang.String s3 = \\\"\\\\u0073\\\\u0074\\\\u0072\\\\u0020\\\\u0033\\\"\",\n+                \"  VAR static java.lang.String s4\",\n+                \"  METHOD protected void m1()\",\n+                \"  METHOD public static java.util.Map m2()\",\n+                \"  METHOD final void m3(java.util.Set)\",\n+                \"  METHOD protected void <init>(int)\",\n+                \"  TYPE static TestClass$DummyInner1\",\n+                \"    VAR protected int field\",\n+                \"    METHOD public void run()\",\n+                \"    METHOD void <init>()\",\n+                \"  TYPE final TestClass$DummyInner2\",\n+                \"    METHOD void <init>()\",\n+                \"  TYPE final public static TestClass$Record3\",\n+                \"    METHOD final public boolean equals(java.lang.Object)\",\n+                \"    METHOD final public int hashCode()\",\n+                \"    METHOD public int f1()\",\n+                \"    METHOD public java.lang.String f2()\",\n+                \"    METHOD final public java.lang.String toString()\",\n+                \"    METHOD public void <init>(int,java.lang.String)\"\n+        ).forEach(expectedApi::appendItem);\n+        if (!expectedApi.equals(actualApi)) {\n+            List<String> diffs = expectedApi.diff(actualApi);\n+            System.out.println(diffs.size() + \" differences found.\");\n+            diffs.forEach(System.out::println);\n+            throw new AssertionError(\"Actual API differs from expected API.\");\n+        }\n+    }\n+}\n","filename":"test\/langtools\/tools\/sjavac\/PubApisTest.java","additions":109,"deletions":0,"binary":false,"changes":109,"status":"added"},{"patch":"@@ -0,0 +1,241 @@\n+\/*\n+ * Copyright (c) 2014, 2016, Oracle and\/or its affiliates. All rights reserved.\n+ * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+ *\n+ * This code is free software; you can redistribute it and\/or modify it\n+ * under the terms of the GNU General Public License version 2 only, as\n+ * published by the Free Software Foundation.\n+ *\n+ * This code is distributed in the hope that it will be useful, but WITHOUT\n+ * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+ * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+ * version 2 for more details (a copy is included in the LICENSE file that\n+ * accompanied this code).\n+ *\n+ * You should have received a copy of the GNU General Public License version\n+ * 2 along with this work; if not, write to the Free Software Foundation,\n+ * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n+ *\n+ * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n+ * or visit www.oracle.com if you need additional information or have any\n+ * questions.\n+ *\/\n+\n+import java.util.*;\n+import java.io.*;\n+import java.nio.file.*;\n+import java.nio.file.attribute.*;\n+\n+import com.sun.tools.sjavac.Main;\n+\n+import toolbox.ToolBox;\n+\n+public class SJavacTester {\n+\n+    final ToolBox tb = new ToolBox();\n+    final Path TEST_ROOT = Paths.get(getClass().getSimpleName());\n+\n+    \/\/ Generated sources that will test aspects of sjavac\n+    final Path GENSRC = TEST_ROOT.resolve(\"gensrc\");\n+    \/\/ Gensrc dirs used to test merging of serveral source roots.\n+    final Path GENSRC2 = TEST_ROOT.resolve(\"gensrc2\");\n+    final Path GENSRC3 = TEST_ROOT.resolve(\"gensrc3\");\n+\n+    \/\/ Dir for compiled classes.\n+    final Path BIN = TEST_ROOT.resolve(\"bin\");\n+    \/\/ Dir for c-header files.\n+    final Path HEADERS = TEST_ROOT.resolve(\"headers\");\n+\n+    \/\/ Remember the previous bin and headers state here.\n+    Map<String,Long> previous_bin_state;\n+    Map<String,Long> previous_headers_state;\n+\n+    void initialCompile() throws Exception {\n+        System.out.println(\"\\nInitial compile of gensrc.\");\n+        tb.writeFile(GENSRC.resolve(\"alfa\/omega\/AINT.java\"),\n+                     \"package alfa.omega; public interface AINT { void aint(); }\");\n+        tb.writeFile(GENSRC.resolve(\"alfa\/omega\/A.java\"),\n+                     \"package alfa.omega; public class A implements AINT { \"+\n+                     \"public final static int DEFINITION = 17; public void aint() { } }\");\n+        tb.writeFile(GENSRC.resolve(\"alfa\/omega\/AA.java\"),\n+            \"package alfa.omega;\"+\n+            \"\/\/ A package private class, not contributing to the public api.\\n\"+\n+            \"class AA {\"+\n+            \"   \/\/ A properly nested static inner class.\\n\"+\n+            \"    static class AAA { }\\n\"+\n+            \"    \/\/ A properly nested inner class.\\n\"+\n+            \"    class AAAA { }\\n\"+\n+            \"    Runnable foo() {\\n\"+\n+            \"        \/\/ A proper anonymous class.\\n\"+\n+            \"        return new Runnable() { public void run() { } };\\n\"+\n+            \"    }\\n\"+\n+            \"    AAA aaa;\\n\"+\n+            \"    AAAA aaaa;\\n\"+\n+            \"    AAAAA aaaaa;\\n\"+\n+            \"}\\n\"+\n+            \"class AAAAA {\\n\"+\n+            \"    \/\/ A bad auxiliary class, but no one is referencing it\\n\"+\n+            \"    \/\/ from outside of this source file, therefore it is ok.\\n\"+\n+            \"}\\n\");\n+        tb.writeFile(GENSRC.resolve(\"beta\/BINT.java\"),\n+                     \"package beta;public interface BINT { void foo(); }\");\n+        tb.writeFile(GENSRC.resolve(\"beta\/B.java\"),\n+                     \"package beta; import alfa.omega.A; public class B {\"+\n+                     \"private int b() { return A.DEFINITION; } native void foo(); }\");\n+\n+        compile(GENSRC.toString(),\n+                \"-d\", BIN.toString(),\n+                \"--state-dir=\" + BIN,\n+                \"-h\", HEADERS.toString(),\n+                \"-j\", \"1\",\n+                \"--log=debug\");\n+    }\n+\n+    void removeFrom(Path dir, String... args) throws IOException {\n+        for (String filename : args) {\n+            Path p = dir.resolve(filename);\n+            Files.delete(p);\n+        }\n+    }\n+\n+    void compile(String... args) throws Exception {\n+        int rc = Main.go(args);\n+        if (rc != 0) throw new Exception(\"Error during compile!\");\n+\n+        \/\/ Wait a second, to get around the (temporary) problem with\n+        \/\/ second resolution in the Java file api. But do not do this\n+        \/\/ on windows where the timestamps work.\n+        long in_a_sec = System.currentTimeMillis()+1000;\n+        while (in_a_sec > System.currentTimeMillis()) {\n+            try {\n+                Thread.sleep(1000);\n+            } catch (InterruptedException e) {\n+            }\n+        }\n+    }\n+\n+    void compileExpectFailure(String... args) throws Exception {\n+        int rc = Main.go(args);\n+        if (rc == 0) throw new Exception(\"Expected error during compile! Did not fail!\");\n+    }\n+\n+    Map<String,Long> collectState(Path dir) throws IOException {\n+        final Map<String,Long> files = new HashMap<>();\n+        Files.walkFileTree(dir, new SimpleFileVisitor<Path>() {\n+                 @Override\n+                 public FileVisitResult visitFile(Path file, BasicFileAttributes attrs)\n+                   throws IOException\n+                 {\n+                     files.put(file.toString(),new Long(Files.getLastModifiedTime(file).toMillis()));\n+                     return FileVisitResult.CONTINUE;\n+                 }\n+            });\n+        return files;\n+    }\n+\n+    void verifyThatFilesHaveBeenRemoved(Map<String,Long> from,\n+                                        Map<String,Long> to,\n+                                        String... args) throws Exception {\n+\n+        Set<String> froms = from.keySet();\n+        Set<String> tos = to.keySet();\n+\n+        if (froms.equals(tos)) {\n+            throw new Exception(\"Expected new state to have fewer files than previous state!\");\n+        }\n+\n+        for (String t : tos) {\n+            if (!froms.contains(t)) {\n+                throw new Exception(\"Expected \"+t+\" to exist in previous state!\");\n+            }\n+        }\n+\n+        for (String f : args) {\n+            f = f.replace(\"\/\", File.separator);\n+            if (!froms.contains(f)) {\n+                throw new Exception(\"Expected \"+f+\" to exist in previous state!\");\n+            }\n+            if (tos.contains(f)) {\n+                throw new Exception(\"Expected \"+f+\" to have been removed from the new state!\");\n+            }\n+        }\n+\n+        if (froms.size() - args.length != tos.size()) {\n+            throw new Exception(\"There are more removed files than the expected list!\");\n+        }\n+    }\n+\n+    void verifyThatFilesHaveBeenAdded(Map<String,Long> from,\n+                                      Map<String,Long> to,\n+                                      String... args) throws Exception {\n+\n+        Set<String> froms = from.keySet();\n+        Set<String> tos = to.keySet();\n+\n+        if (froms.equals(tos)) {\n+            throw new Exception(\"Expected new state to have more files than previous state!\");\n+        }\n+\n+        for (String t : froms) {\n+            if (!tos.contains(t)) {\n+                throw new Exception(\"Expected \"+t+\" to exist in new state!\");\n+            }\n+        }\n+\n+        for (String f : args) {\n+            f = f.replace(\"\/\", File.separator);\n+            if (!tos.contains(f)) {\n+                throw new Exception(\"Expected \"+f+\" to have been added to new state!\");\n+            }\n+            if (froms.contains(f)) {\n+                throw new Exception(\"Expected \"+f+\" to not exist in previous state!\");\n+            }\n+        }\n+\n+        if (froms.size() + args.length != tos.size()) {\n+            throw new Exception(\"There are more added files than the expected list!\");\n+        }\n+    }\n+\n+    void verifyNewerFiles(Map<String,Long> from,\n+                          Map<String,Long> to,\n+                          String... args) throws Exception {\n+        if (!from.keySet().equals(to.keySet())) {\n+            throw new Exception(\"Expected the set of files to be identical!\");\n+        }\n+        Set<String> files = new HashSet<String>();\n+        for (String s : args) {\n+            files.add(s.replace(\"\/\", File.separator));\n+        }\n+        for (String fn : from.keySet()) {\n+            long f = from.get(fn);\n+            long t = to.get(fn);\n+            if (files.contains(fn)) {\n+                if (t <= f) {\n+                    throw new Exception(\"Expected \"+fn+\" to have a more recent timestamp!\");\n+                }\n+            } else {\n+                if (t != f) {\n+                    throw new Exception(\"Expected \"+fn+\" to have the same timestamp!\");\n+                }\n+            }\n+        }\n+    }\n+\n+    String print(Map<String,Long> m) {\n+        StringBuilder b = new StringBuilder();\n+        Set<String> keys = m.keySet();\n+        for (String k : keys) {\n+            b.append(k+\" \"+m.get(k)+\"\\n\");\n+        }\n+        return b.toString();\n+    }\n+\n+    void verifyEqual(Map<String,Long> from, Map<String,Long> to) throws Exception {\n+        if (!from.equals(to)) {\n+            System.out.println(\"FROM---\"+print(from));\n+            System.out.println(\"TO-----\"+print(to));\n+            throw new Exception(\"The dir should not differ! But it does!\");\n+        }\n+    }\n+}\n","filename":"test\/langtools\/tools\/sjavac\/SJavacTester.java","additions":241,"deletions":0,"binary":false,"changes":241,"status":"added"},{"patch":"@@ -0,0 +1,105 @@\n+\/*\n+ * Copyright (c) 2014, 2015, Oracle and\/or its affiliates. All rights reserved.\n+ * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+ *\n+ * This code is free software; you can redistribute it and\/or modify it\n+ * under the terms of the GNU General Public License version 2 only, as\n+ * published by the Free Software Foundation.\n+ *\n+ * This code is distributed in the hope that it will be useful, but WITHOUT\n+ * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+ * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+ * version 2 for more details (a copy is included in the LICENSE file that\n+ * accompanied this code).\n+ *\n+ * You should have received a copy of the GNU General Public License version\n+ * 2 along with this work; if not, write to the Free Software Foundation,\n+ * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n+ *\n+ * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n+ * or visit www.oracle.com if you need additional information or have any\n+ * questions.\n+ *\/\n+\n+\/*\n+ * @test\n+ * @bug 8035063\n+ *\n+ * @summary Tests serialization of options. The options needs to be serialized\n+ *          and saved in the state file since the files need to be recompiled\n+ *          if new options are provided.\n+ *\n+ * @modules jdk.compiler\/com.sun.tools.sjavac\n+ *          jdk.compiler\/com.sun.tools.sjavac.options\n+ * @build Wrapper\n+ * @run main Wrapper Serialization\n+ *\/\n+\n+import static util.OptionTestUtil.assertEquals;\n+\n+import java.io.IOException;\n+import java.util.Map;\n+\n+import com.sun.tools.sjavac.CompileJavaPackages;\n+import com.sun.tools.sjavac.Transformer;\n+import com.sun.tools.sjavac.options.Option;\n+import com.sun.tools.sjavac.options.Options;\n+import com.sun.tools.sjavac.options.SourceLocation;\n+\n+\n+public class Serialization {\n+\n+    public static void main(String[] args) throws IOException {\n+\n+        \/\/ Create reference options\n+        Options options1 = Options.parseArgs(\n+                Option.H.arg, \"headers\",\n+                Option.S.arg, \"gensrc\",\n+                Option.D.arg, \"dest\",\n+                Option.I.arg, \"pkg\/*\",\n+                Option.X.arg, \"pkg\/pkg\/*\",\n+                Option.SRC.arg, \"root\",\n+                Option.SOURCEPATH.arg, \"sourcepath\",\n+                Option.CLASSPATH.arg, \"classpath\",\n+                Option.MODULE_PATH.arg, \"modulepath\",\n+                Option.PERMIT_SOURCES_WITHOUT_PACKAGE.arg,\n+                Option.PERMIT_UNIDENTIFIED_ARTIFACTS.arg,\n+                Option.TR.arg, \".prop=\" + CompileJavaPackages.class.getName(),\n+                Option.J.arg, \"999\",\n+                \"-someJavacArg\",\n+                \"-someOtherJavacArg\");\n+\n+        \/\/ Serialize\n+        String serialized = options1.getStateArgsString();\n+\n+        \/\/ Deserialize\n+        Options options2 = Options.parseArgs(serialized.split(\" \"));\n+\n+        \/\/ Make sure we got the same result\n+        assertEquals(options1.getHeaderDir(), options2.getHeaderDir());\n+        assertEquals(options1.getGenSrcDir(), options2.getGenSrcDir());\n+        assertEquals(options1.getDestDir(), options2.getDestDir());\n+\n+        SourceLocation sl1 = options1.getSources().get(0);\n+        SourceLocation sl2 = options2.getSources().get(0);\n+        assertEquals(sl1.getPath(), sl2.getPath());\n+        assertEquals(sl1.getIncludes(), sl2.getIncludes());\n+        assertEquals(sl1.getExcludes(), sl2.getExcludes());\n+\n+        assertEquals(options1.getClassSearchPath(), options2.getClassSearchPath());\n+        assertEquals(options1.getSourceSearchPaths(), options2.getSourceSearchPaths());\n+        assertEquals(options1.getModuleSearchPaths(), options2.getModuleSearchPaths());\n+\n+        Map<String, Transformer> trRules1 = options1.getTranslationRules();\n+        Map<String, Transformer> trRules2 = options2.getTranslationRules();\n+        assertEquals(trRules1.keySet(), trRules2.keySet());\n+        assertEquals(trRules1.values().iterator().next().getClass(),\n+                     trRules2.values().iterator().next().getClass());\n+        assertEquals(options1.getJavacArgs(), options2.getJavacArgs());\n+\n+        assertEquals(999, options1.getNumCores());\n+        if (options2.getNumCores() == 999)\n+            throw new AssertionError(\"Num cores should not be part of serialization\");\n+    }\n+\n+}\n","filename":"test\/langtools\/tools\/sjavac\/Serialization.java","additions":105,"deletions":0,"binary":false,"changes":105,"status":"added"},{"patch":"@@ -0,0 +1,49 @@\n+\/*\n+ * Copyright (c) 2014, 2016, Oracle and\/or its affiliates. All rights reserved.\n+ * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+ *\n+ * This code is free software; you can redistribute it and\/or modify it\n+ * under the terms of the GNU General Public License version 2 only, as\n+ * published by the Free Software Foundation.\n+ *\n+ * This code is distributed in the hope that it will be useful, but WITHOUT\n+ * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+ * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+ * version 2 for more details (a copy is included in the LICENSE file that\n+ * accompanied this code).\n+ *\n+ * You should have received a copy of the GNU General Public License version\n+ * 2 along with this work; if not, write to the Free Software Foundation,\n+ * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n+ *\n+ * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n+ * or visit www.oracle.com if you need additional information or have any\n+ * questions.\n+ *\/\n+\n+import java.lang.reflect.Method;\n+import java.util.Arrays;\n+\n+import toolbox.ToolBox;\n+\n+public class SjavacBase {\n+\n+    protected final static ToolBox toolbox = new ToolBox();\n+\n+    \/**\n+     * Utility method for invoking sjavac. Method accepts Objects as arguments\n+     * (which are turned into Strings through Object::toString) to allow clients\n+     * to pass for instance Path objects.\n+     *\/\n+    public static int compile(Object... args) throws ReflectiveOperationException {\n+        \/\/ Use reflection to avoid a compile-time dependency on sjavac Main\n+        System.out.println(\"compile: \" + Arrays.toString(args));\n+        Class<?> c = Class.forName(\"com.sun.tools.sjavac.Main\");\n+        Method m = c.getDeclaredMethod(\"go\", String[].class);\n+        String[] strArgs = new String[args.length];\n+        for (int i = 0; i < args.length; i++)\n+            strArgs[i] = args[i].toString();\n+        int rc = (Integer) m.invoke(null, (Object) strArgs);\n+        return rc;\n+    }\n+}\n","filename":"test\/langtools\/tools\/sjavac\/SjavacBase.java","additions":49,"deletions":0,"binary":false,"changes":49,"status":"added"},{"patch":"@@ -0,0 +1,69 @@\n+\/*\n+ * Copyright (c) 2014, 2016, Oracle and\/or its affiliates. All rights reserved.\n+ * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+ *\n+ * This code is free software; you can redistribute it and\/or modify it\n+ * under the terms of the GNU General Public License version 2 only, as\n+ * published by the Free Software Foundation.\n+ *\n+ * This code is distributed in the hope that it will be useful, but WITHOUT\n+ * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+ * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+ * version 2 for more details (a copy is included in the LICENSE file that\n+ * accompanied this code).\n+ *\n+ * You should have received a copy of the GNU General Public License version\n+ * 2 along with this work; if not, write to the Free Software Foundation,\n+ * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n+ *\n+ * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n+ * or visit www.oracle.com if you need additional information or have any\n+ * questions.\n+ *\/\n+\n+\/*\n+ * @test\n+ * @summary Verify that --state-dir=bar works\n+ * @bug 8054689\n+ * @author Fredrik O\n+ * @author sogoel (rewrite)\n+ * @library \/tools\/lib\n+ * @modules jdk.compiler\/com.sun.tools.javac.api\n+ *          jdk.compiler\/com.sun.tools.javac.main\n+ *          jdk.compiler\/com.sun.tools.sjavac\n+ * @build Wrapper toolbox.ToolBox\n+ * @run main Wrapper StateDir\n+ *\/\n+\n+import java.util.*;\n+import java.nio.file.*;\n+\n+public class StateDir extends SJavacTester {\n+    public static void main(String... args) throws Exception {\n+        StateDir sd = new StateDir();\n+        sd.test();\n+    }\n+\n+    void test() throws Exception {\n+        Path BAR = TEST_ROOT.resolve(\"bar\");\n+        Files.createDirectories(BAR);\n+        Files.createDirectories(BIN);\n+\n+        Map<String,Long> previous_bin_state = collectState(BIN);\n+        Map<String,Long> previous_bar_state = collectState(BAR);\n+\n+        tb.writeFile(GENSRC.resolve(\"alfa\/omega\/A.java\"),\n+                     \"package alfa.omega; public class A { }\");\n+\n+        compile(\"--state-dir=\" + BAR,\n+                \"-src\", GENSRC.toString(),\n+                \"-d\", BIN.toString());\n+\n+        Map<String,Long> new_bin_state = collectState(BIN);\n+        verifyThatFilesHaveBeenAdded(previous_bin_state, new_bin_state,\n+                                     BIN + \"\/alfa\/omega\/A.class\");\n+        Map<String,Long> new_bar_state = collectState(BAR);\n+        verifyThatFilesHaveBeenAdded(previous_bar_state, new_bar_state,\n+                                     BAR + \"\/javac_state\");\n+    }\n+}\n","filename":"test\/langtools\/tools\/sjavac\/StateDir.java","additions":69,"deletions":0,"binary":false,"changes":69,"status":"added"},{"patch":"@@ -0,0 +1,85 @@\n+\/*\n+ * Copyright (c) 2014, 2016, Oracle and\/or its affiliates. All rights reserved.\n+ * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+ *\n+ * This code is free software; you can redistribute it and\/or modify it\n+ * under the terms of the GNU General Public License version 2 only, as\n+ * published by the Free Software Foundation.\n+ *\n+ * This code is distributed in the hope that it will be useful, but WITHOUT\n+ * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+ * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+ * version 2 for more details (a copy is included in the LICENSE file that\n+ * accompanied this code).\n+ *\n+ * You should have received a copy of the GNU General Public License version\n+ * 2 along with this work; if not, write to the Free Software Foundation,\n+ * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n+ *\n+ * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n+ * or visit www.oracle.com if you need additional information or have any\n+ * questions.\n+ *\/\n+\n+import java.io.IOException;\n+import java.lang.reflect.Method;\n+import java.nio.file.Files;\n+import java.nio.file.Path;\n+import java.nio.file.Paths;\n+import java.util.ArrayList;\n+import java.util.Arrays;\n+import java.util.List;\n+import java.util.stream.Collectors;\n+\n+public class Wrapper {\n+    public static void main(String... args) throws Exception {\n+        if (!isSJavacOnClassPath()) {\n+            System.out.println(\"sjavac not available: pass by default\");\n+            return;\n+        }\n+\n+        String testClassName = args[0];\n+        String[] testArgs = Arrays.copyOfRange(args, 1, args.length);\n+\n+        Path srcDir = Paths.get(System.getProperty(\"test.src\"));\n+        Path clsDir = Paths.get(System.getProperty(\"test.classes\"));\n+        String clsPath = System.getProperty(\"test.class.path\");\n+        String tstMdls = System.getProperty(\"test.modules\");\n+\n+        Path src = srcDir.resolve(testClassName + \".java\");\n+        Path cls = clsDir.resolve(testClassName + \".class\");\n+\n+        if (isNewer(src, cls)) {\n+            System.err.println(\"Recompiling test class...\");\n+            List<String> javacArgs = new ArrayList<>();\n+            javacArgs.addAll(Arrays.asList(\"-d\", clsDir.toString()));\n+            javacArgs.addAll(Arrays.asList(\"-sourcepath\", srcDir.toString()));\n+            javacArgs.addAll(Arrays.asList(\"-classpath\", clsPath));\n+            Arrays.stream(tstMdls.split(\"\\\\s+\"))\n+                .filter(s -> s.contains(\"\/\"))\n+                .map(s -> \"--add-exports=\" + s + \"=ALL-UNNAMED\")\n+                .collect(Collectors.toCollection(() -> javacArgs));\n+            javacArgs.add(src.toString());\n+            System.out.println(\"javac: \" + javacArgs);\n+            int rc = com.sun.tools.javac.Main.compile(\n+                javacArgs.toArray(new String[javacArgs.size()]));\n+            if (rc != 0)\n+                throw new Exception(\"compilation failed\");\n+        }\n+\n+        Class<?> sjavac = Class.forName(testClassName);\n+        Method main = sjavac.getMethod(\"main\", String[].class);\n+        main.invoke(null, new Object[] { testArgs });\n+    }\n+\n+    private static boolean isNewer(Path a, Path b) throws IOException {\n+        if (Files.notExists(b))\n+            return true;\n+        return Files.getLastModifiedTime(a).compareTo(Files.getLastModifiedTime(b)) > 0;\n+    }\n+\n+    private static boolean isSJavacOnClassPath() {\n+        String cls = \"com\/sun\/tools\/sjavac\/Main.class\";\n+        return Wrapper.class.getClassLoader().getResource(cls) != null;\n+    }\n+}\n","filename":"test\/langtools\/tools\/sjavac\/Wrapper.java","additions":85,"deletions":0,"binary":false,"changes":85,"status":"added"},{"patch":"@@ -0,0 +1,75 @@\n+\/*\n+ * Copyright (c) 2014, Oracle and\/or its affiliates. All rights reserved.\n+ * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+ *\n+ * This code is free software; you can redistribute it and\/or modify it\n+ * under the terms of the GNU General Public License version 2 only, as\n+ * published by the Free Software Foundation.\n+ *\n+ * This code is distributed in the hope that it will be useful, but WITHOUT\n+ * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+ * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+ * version 2 for more details (a copy is included in the LICENSE file that\n+ * accompanied this code).\n+ *\n+ * You should have received a copy of the GNU General Public License version\n+ * 2 along with this work; if not, write to the Free Software Foundation,\n+ * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n+ *\n+ * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n+ * or visit www.oracle.com if you need additional information or have any\n+ * questions.\n+ *\/\n+\n+package util;\n+\n+import java.nio.file.Path;\n+import java.util.Collection;\n+import java.util.HashSet;\n+import java.util.Iterator;\n+import java.util.List;\n+\n+import com.sun.tools.sjavac.options.SourceLocation;\n+\n+\n+public class OptionTestUtil {\n+\n+    public static void checkFilesFound(Collection<String> found, Path... expected) {\n+\n+        Collection<String> expectedStrs = new HashSet<String>();\n+        for (Path p : expected)\n+            expectedStrs.add(p.toString());\n+\n+        if (!expectedStrs.containsAll(found))\n+            throw new AssertionError(\"Expected (\" + expectedStrs + \") does not \" +\n+                                     \"contain all actual (\" + found + \")\");\n+\n+        if (!found.containsAll(expectedStrs))\n+            throw new AssertionError(\"Actual (\" + found + \") does not \" +\n+                                     \"contain all expected (\" + expectedStrs + \")\");\n+    }\n+\n+    public static void assertEquals(List<SourceLocation> expected, List<SourceLocation> actual) {\n+        if (expected.size() != actual.size())\n+            throw new AssertionError(\"Expected locs of length \" + expected.size() + \" but got something of size \" + actual.size());\n+\n+        Iterator<SourceLocation> iter1 = expected.iterator();\n+        Iterator<SourceLocation> iter2 = actual.iterator();\n+\n+        while (iter1.hasNext()) {\n+            SourceLocation sl1 = iter1.next();\n+            SourceLocation sl2 = iter2.next();\n+\n+            if (!sl1.getPath().equals(sl2.getPath()) ||\n+                    !sl1.getIncludes().equals(sl2.getIncludes()) ||\n+                    !sl1.getExcludes().equals(sl2.getExcludes()))\n+                throw new AssertionError(\"Expected \" + sl1 + \" but got \" + sl2);\n+        }\n+    }\n+\n+    public static void assertEquals(Object expected, Object actual) {\n+        if (!expected.equals(actual))\n+            throw new AssertionError(\"Expected \" + expected + \" but got \" + actual);\n+    }\n+\n+}\n","filename":"test\/langtools\/tools\/sjavac\/util\/OptionTestUtil.java","additions":75,"deletions":0,"binary":false,"changes":75,"status":"added"},{"patch":"@@ -68,1 +68,1 @@\n-                    \"cet_ss\",       \"avx512_ifma\"\n+                    \"cet_ss\"\n","filename":"test\/lib-test\/jdk\/test\/whitebox\/CPUInfoTest.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -25,1 +25,0 @@\n-import java.math.BigInteger;\n@@ -321,1 +320,1 @@\n-                new BigInteger(value);\n+                Long.parseLong(value);\n","filename":"test\/lib\/jdk\/test\/lib\/json\/JSONValue.java","additions":1,"deletions":2,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -297,10 +297,1 @@\n-  static const char* UNNAMED_STR = \"<Unnamed thread>\";\n-  static size_t UNNAMED_LEN = strlen(UNNAMED_STR);\n-  char* tname = thr_info.name;\n-  if (tname == NULL) {\n-    err = jvmti->Allocate((jlong)(UNNAMED_LEN + 1), (unsigned char**)&tname);\n-    check_jvmti_status(jni, err, \"get_method_class_name: error in JVMTI Allocate\");\n-    strncpy(tname, UNNAMED_STR, UNNAMED_LEN);\n-    tname[UNNAMED_LEN] = '\\0';\n-  }\n-  return tname;\n+  return thr_info.name == NULL ? (char*)\"<Unnamed thread>\" : thr_info.name;\n","filename":"test\/lib\/jdk\/test\/lib\/jvmti\/jvmti_common.h","additions":1,"deletions":10,"binary":false,"changes":11,"status":"modified"},{"patch":"@@ -142,1 +142,1 @@\n-                    int hash, String encoded) {\n+                    long certId, String encoded) {\n@@ -148,1 +148,1 @@\n-        this.certId = Integer.toUnsignedLong(hash);\n+        this.certId = certId;\n","filename":"test\/lib\/jdk\/test\/lib\/security\/TestCertificate.java","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2018, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2018, Oracle and\/or its affiliates. All rights reserved.\n@@ -36,2 +36,2 @@\n-    public static final long CERT_ID = Integer.toUnsignedLong(-1057291798);\n-    public static final long ANCHOR_CERT_ID = Integer.toUnsignedLong(1688661792);\n+    public static final long HASHCODE = -1057291798L;\n+    public static final long ANCHOR_HASHCODE = 1688661792L;\n","filename":"test\/lib\/jdk\/test\/lib\/security\/TestTLSHandshake.java","additions":3,"deletions":3,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -28,1 +28,2 @@\n-import java.security.spec.*;\n+import java.security.spec.ECGenParameterSpec;\n+import java.security.spec.NamedParameterSpec;\n@@ -39,1 +40,1 @@\n-    private static Signature signer;\n+    private Signature signer;\n@@ -42,1 +43,1 @@\n-    private static int messageLength;\n+    private int messageLength;\n@@ -44,2 +45,2 @@\n-    @Param({\"secp256r1\", \"secp384r1\", \"secp521r1\"})\n-    private String algorithm;\n+    @Param({\"secp256r1\", \"secp384r1\", \"secp521r1\", \"Ed25519\", \"Ed448\"})\n+    private String curveName;\n@@ -47,1 +48,5 @@\n-    private static byte[] message;\n+    private byte[] message;\n+\n+    record CurveSpec(String curveName, String signName) {\n+        \/\/ blank\n+    }\n@@ -54,1 +59,1 @@\n-        String signName = switch (algorithm) {\n+        String signName = switch (curveName) {\n@@ -58,0 +63,2 @@\n+            case \"Ed25519\" -> \"Ed25519\";\n+            case \"Ed448\" -> \"Ed448\";\n@@ -61,5 +68,7 @@\n-        AlgorithmParameters params =\n-                AlgorithmParameters.getInstance(\"EC\", \"SunEC\");\n-        params.init(new ECGenParameterSpec(algorithm));\n-        ECGenParameterSpec ecParams =\n-                params.getParameterSpec(ECGenParameterSpec.class);\n+        KeyPair kp;\n+        if (curveName.startsWith(\"secp\")) {\n+            AlgorithmParameters params =\n+                    AlgorithmParameters.getInstance(\"EC\", \"SunEC\");\n+            params.init(new ECGenParameterSpec(curveName));\n+            ECGenParameterSpec ecParams =\n+                    params.getParameterSpec(ECGenParameterSpec.class);\n@@ -67,4 +76,11 @@\n-        KeyPairGenerator kpg =\n-                KeyPairGenerator.getInstance(\"EC\", \"SunEC\");\n-        kpg.initialize(ecParams);\n-        KeyPair kp = kpg.generateKeyPair();\n+            KeyPairGenerator kpg =\n+                    KeyPairGenerator.getInstance(\"EC\", \"SunEC\");\n+            kpg.initialize(ecParams);\n+            kp = kpg.generateKeyPair();\n+        } else {\n+            KeyPairGenerator kpg =\n+                    KeyPairGenerator.getInstance(curveName, \"SunEC\");\n+            NamedParameterSpec spec = new NamedParameterSpec(curveName);\n+            kpg.initialize(spec);\n+            kp = kpg.generateKeyPair();\n+        }\n@@ -81,115 +97,0 @@\n-\n-    public static class EdDSA extends Signatures {\n-        @Param({\"Ed25519\", \"Ed448\"})\n-        private String algorithm;\n-\n-        @Setup\n-        public void setup() throws Exception {\n-            message = new byte[messageLength];\n-            (new Random(System.nanoTime())).nextBytes(message);\n-\n-            KeyPairGenerator kpg =\n-                    KeyPairGenerator.getInstance(algorithm, \"SunEC\");\n-            NamedParameterSpec spec = new NamedParameterSpec(algorithm);\n-            kpg.initialize(spec);\n-            KeyPair kp = kpg.generateKeyPair();\n-\n-            signer = Signature.getInstance(algorithm, \"SunEC\");\n-            signer.initSign(kp.getPrivate());\n-        }\n-    }\n-\n-    public static class DSA extends Signatures {\n-        @Param({\"SHA256withDSA\", \"SHA384withDSA\", \"SHA512withDSA\"})\n-        private String algorithm;\n-\n-        @Setup\n-        public void setup() throws Exception {\n-            message = new byte[messageLength];\n-            (new Random(System.nanoTime())).nextBytes(message);\n-\n-            int keyLength = switch (algorithm) {\n-                case \"SHA256withDSA\" -> 2048;\n-                case \"SHA384withDSA\" -> 3072;\n-                case \"SHA512withDSA\" -> 3072;\n-                default -> throw new RuntimeException();\n-            };\n-\n-            KeyPairGenerator kpg = KeyPairGenerator.getInstance(\"DSA\");\n-            kpg.initialize(keyLength);\n-            KeyPair kp = kpg.generateKeyPair();\n-\n-            signer = Signature.getInstance(algorithm);\n-            signer.initSign(kp.getPrivate());\n-        }\n-    }\n-\n-    public static class RSA extends Signatures {\n-        @Param({\"SHA256withRSA\", \"SHA384withRSA\", \"SHA512withRSA\"})\n-        private String algorithm;\n-\n-        @Setup\n-        public void setup() throws Exception {\n-            message = new byte[messageLength];\n-            (new Random(System.nanoTime())).nextBytes(message);\n-\n-            int keyLength = switch (algorithm) {\n-                case \"SHA256withRSA\" -> 2048;\n-                case \"SHA384withRSA\" -> 3072;\n-                case \"SHA512withRSA\" -> 4096;\n-                default -> throw new RuntimeException();\n-            };\n-\n-            KeyPairGenerator kpg = KeyPairGenerator.getInstance(\"RSA\");\n-            kpg.initialize(keyLength);\n-            KeyPair kp = kpg.generateKeyPair();\n-\n-            signer = Signature.getInstance(algorithm);\n-            signer.initSign(kp.getPrivate());\n-        }\n-    }\n-\n-    public static class RSASSAPSS extends Signatures {\n-        @Param({\"SHA256\", \"SHA384\", \"SHA512\"})\n-        private String algorithm;\n-\n-        @Setup\n-        public void setup() throws Exception {\n-            message = new byte[messageLength];\n-            (new Random(System.nanoTime())).nextBytes(message);\n-\n-            int keyLength = switch (algorithm) {\n-               case \"SHA256\" -> 2048;\n-               case \"SHA384\" -> 3072;\n-               case \"SHA512\" -> 4096;\n-               default -> throw new RuntimeException();\n-            };\n-\n-            PSSParameterSpec spec = switch (algorithm) {\n-               case \"SHA256\" ->\n-                       new PSSParameterSpec(\n-                               \"SHA-256\", \"MGF1\",\n-                               MGF1ParameterSpec.SHA256,\n-                               32, PSSParameterSpec.TRAILER_FIELD_BC);\n-               case \"SHA384\" ->\n-                       new PSSParameterSpec(\n-                               \"SHA-384\", \"MGF1\",\n-                               MGF1ParameterSpec.SHA384,\n-                               48, PSSParameterSpec.TRAILER_FIELD_BC);\n-               case \"SHA512\" ->\n-                        new PSSParameterSpec(\n-                               \"SHA-512\", \"MGF1\",\n-                               MGF1ParameterSpec.SHA512,\n-                               64, PSSParameterSpec.TRAILER_FIELD_BC);\n-               default -> throw new RuntimeException();\n-            };\n-\n-            KeyPairGenerator kpg = KeyPairGenerator.getInstance(\"RSASSA-PSS\");\n-            kpg.initialize(keyLength);\n-            KeyPair kp = kpg.generateKeyPair();\n-\n-            signer = Signature.getInstance(\"RSASSA-PSS\");\n-            signer.setParameter(spec);\n-            signer.initSign(kp.getPrivate());\n-        }\n-    }\n","filename":"test\/micro\/org\/openjdk\/bench\/java\/security\/Signatures.java","additions":32,"deletions":131,"binary":false,"changes":163,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2015, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2015, 2020, Oracle and\/or its affiliates. All rights reserved.\n@@ -46,2 +46,1 @@\n-        generator = (prov == null) ? KeyPairGenerator.getInstance(algorithm)\n-                                : KeyPairGenerator.getInstance(algorithm, prov);\n+        generator = (prov == null) ? KeyPairGenerator.getInstance(algorithm) : KeyPairGenerator.getInstance(algorithm, prov);\n@@ -61,1 +60,1 @@\n-        @Param({\"1024\", \"2048\", \"3072\", \"4096\"})\n+        @Param({\"1024\", \"2048\", \"3072\"})\n@@ -63,6 +62,0 @@\n-    }\n-\n-    public static class RSASSAPSS extends KeyPairGeneratorBench {\n-\n-        @Param({\"RSASSA-PSS\"})\n-        private String algorithm;\n@@ -70,2 +63,0 @@\n-        @Param({\"1024\", \"2048\", \"3072\", \"4096\"})\n-        private int keyLength;\n@@ -81,1 +72,0 @@\n-    }\n@@ -83,7 +73,0 @@\n-    public static class EdDSA extends KeyPairGeneratorBench {\n-\n-        @Param({\"EdDSA\"})\n-        private String algorithm;\n-\n-        @Param({\"255\", \"448\"})\n-        private int keyLength;\n@@ -92,8 +75,0 @@\n-    public static class XDH extends KeyPairGeneratorBench {\n-\n-        @Param({\"XDH\"})\n-        private String algorithm;\n-\n-        @Param({\"255\", \"448\"})\n-        private int keyLength;\n-    }\n","filename":"test\/micro\/org\/openjdk\/bench\/javax\/crypto\/full\/KeyPairGeneratorBench.java","additions":3,"deletions":28,"binary":false,"changes":31,"status":"modified"},{"patch":"@@ -1,97 +0,0 @@\n-\/*\n- * Copyright (c) 2022, Intel Corporation. All rights reserved.\n- *\n- * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n- *\n- * This code is free software; you can redistribute it and\/or modify it\n- * under the terms of the GNU General Public License version 2 only, as\n- * published by the Free Software Foundation.\n- *\n- * This code is distributed in the hope that it will be useful, but WITHOUT\n- * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n- * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n- * version 2 for more details (a copy is included in the LICENSE file that\n- * accompanied this code).\n- *\n- * You should have received a copy of the GNU General Public License version\n- * 2 along with this work; if not, write to the Free Software Foundation,\n- * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n- *\n- * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n- * or visit www.oracle.com if you need additional information or have any\n- * questions.\n- *\/\n-package org.openjdk.bench.javax.crypto.full;\n-\n-import org.openjdk.jmh.annotations.Benchmark;\n-import org.openjdk.jmh.annotations.Param;\n-import org.openjdk.jmh.annotations.Setup;\n-\n-import java.lang.invoke.MethodHandle;\n-import java.lang.invoke.MethodHandles;\n-import java.lang.reflect.Method;\n-import java.lang.reflect.Constructor;\n-import java.security.Key;\n-import java.security.spec.AlgorithmParameterSpec;\n-import javax.crypto.spec.SecretKeySpec;\n-import org.openjdk.jmh.annotations.Fork;\n-import org.openjdk.jmh.annotations.Warmup;\n-import org.openjdk.jmh.annotations.Measurement;\n-\n-@Measurement(iterations = 3, time = 10)\n-@Warmup(iterations = 3, time = 10)\n-@Fork(value = 1, jvmArgsAppend = {\"--add-opens\", \"java.base\/com.sun.crypto.provider=ALL-UNNAMED\"})\n-public class Poly1305DigestBench extends CryptoBase {\n-    public static final int SET_SIZE = 128;\n-\n-    @Param({\"64\", \"256\", \"1024\", \"\" + 16*1024, \"\" + 1024*1024})\n-    int dataSize;\n-\n-    private byte[][] data;\n-    int index = 0;\n-    private static MethodHandle polyEngineInit, polyEngineUpdate, polyEngineFinal;\n-    private static Object polyObj;\n-\n-    static {\n-        try {\n-            MethodHandles.Lookup lookup = MethodHandles.lookup();\n-            Class<?> polyClazz = Class.forName(\"com.sun.crypto.provider.Poly1305\");\n-            Constructor<?> constructor = polyClazz.getDeclaredConstructor();\n-            constructor.setAccessible(true);\n-            polyObj = constructor.newInstance();\n-\n-            Method m = polyClazz.getDeclaredMethod(\"engineInit\", Key.class, AlgorithmParameterSpec.class);\n-            m.setAccessible(true);\n-            polyEngineInit = lookup.unreflect(m);\n-\n-            m = polyClazz.getDeclaredMethod(\"engineUpdate\", byte[].class, int.class, int.class);\n-            m.setAccessible(true);\n-            polyEngineUpdate = lookup.unreflect(m);\n-\n-            m = polyClazz.getDeclaredMethod(\"engineDoFinal\");\n-            m.setAccessible(true);\n-            polyEngineFinal = lookup.unreflect(m);\n-        } catch (Throwable ex) {\n-            throw new RuntimeException(ex);\n-        }\n-    }\n-\n-    @Setup\n-    public void setup() {\n-        setupProvider();\n-        data = fillRandom(new byte[SET_SIZE][dataSize]);\n-    }\n-\n-    @Benchmark\n-    public byte[] digest() {\n-        try {\n-            byte[] d = data[index];\n-            index = (index +1) % SET_SIZE;\n-            polyEngineInit.invoke(polyObj, new SecretKeySpec(d, 0, 32, \"Poly1305\"), null);\n-            polyEngineUpdate.invoke(polyObj, d, 0, d.length);\n-            return (byte[])polyEngineFinal.invoke(polyObj);\n-        } catch (Throwable ex) {\n-            throw new RuntimeException(ex);\n-        }\n-    }\n-}\n","filename":"test\/micro\/org\/openjdk\/bench\/javax\/crypto\/full\/Poly1305DigestBench.java","additions":0,"deletions":97,"binary":false,"changes":97,"status":"deleted"}]}