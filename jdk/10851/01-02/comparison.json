{"files":[{"patch":"@@ -40,1 +40,1 @@\n-        \/\/If another datagram test interferes with this test ignoreStrayWakeup\n+        \/\/ If another datagram test interferes with this test ignoreStrayWakeup\n@@ -58,1 +58,1 @@\n-            for (;;) {\n+            for (int i = 0; i < 3; i++) {\n@@ -73,1 +73,2 @@\n-\n+            }\n+            for (int i = 0; i < 3; i++) {\n@@ -78,1 +79,1 @@\n-                    n = sel.select(2000);\n+                    int n = sel.select(2000);\n@@ -87,1 +88,1 @@\n-                            if (message.contains(\"Greetings!\")) {\n+                            if (message.contains(\"Greetings from SelectWhenRefused!\")) {\n@@ -90,2 +91,4 @@\n-                            \/\/unexpected datagram received from elsewhere, retry\n-                            continue;\n+                            \/\/ BindException will be thrown if another service is using\n+                            \/\/ our expected refuser port, cannot run just exit.\n+                            DatagramChannel.open().bind(refuser).close();\n+                            throw new RuntimeException(\"PortUnreachableException not raised\");\n@@ -99,1 +102,2 @@\n-\n+            }\n+            for (int i = 0; i < 3; i++) {\n@@ -102,1 +106,1 @@\n-                n = sel.select(2000);\n+                int n = sel.select(2000);\n@@ -124,1 +128,1 @@\n-        ByteBuffer bb = ByteBuffer.wrap(\"Greetings!\".getBytes());\n+        ByteBuffer bb = ByteBuffer.wrap(\"Greetings from SelectWhenRefused!\".getBytes());\n@@ -129,0 +133,1 @@\n+        System.out.format(\"Received %d keys%n\", selectedKeys.size());\n@@ -139,1 +144,1 @@\n-                System.out.format(\"received %s from %s%n\", message, sa);\n+                System.out.format(\"received %s at %s from %s%n\", message, dc.getLocalAddress(), sa);\n@@ -141,1 +146,1 @@\n-                if (message.contains(\"Greetings!\")) {\n+                if (message.contains(\"Greetings from SelectWhenRefused!\")) {\n","filename":"test\/jdk\/java\/nio\/channels\/DatagramChannel\/SelectWhenRefused.java","additions":17,"deletions":12,"binary":false,"changes":29,"status":"modified"}]}