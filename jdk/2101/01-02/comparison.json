{"files":[{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2001, 2020, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2001, 2021, Oracle and\/or its affiliates. All rights reserved.\n@@ -401,0 +401,9 @@\n+HeapWord* ParallelScavengeHeap::allocate_old_gen_and_record(size_t size) {\n+  assert_locked_or_safepoint(Heap_lock);\n+  HeapWord* res = old_gen()->allocate(size);\n+  if (res != NULL) {\n+    _size_policy->tenured_allocation(size * HeapWordSize);\n+  }\n+  return res;\n+}\n+\n@@ -404,1 +413,1 @@\n-    return old_gen()->allocate_and_record(size);\n+    return allocate_old_gen_and_record(size);\n@@ -412,1 +421,1 @@\n-      return old_gen()->allocate_and_record(size);\n+      return allocate_old_gen_and_record(size);\n@@ -460,1 +469,1 @@\n-    result = old_gen()->allocate_and_record(size);\n+    result = allocate_old_gen_and_record(size);\n@@ -473,1 +482,1 @@\n-    result = old_gen()->allocate_and_record(size);\n+    result = allocate_old_gen_and_record(size);\n","filename":"src\/hotspot\/share\/gc\/parallel\/parallelScavengeHeap.cpp","additions":14,"deletions":5,"binary":false,"changes":19,"status":"modified"},{"patch":"@@ -82,0 +82,3 @@\n+  \/\/ Allocate in oldgen and record the allocation with the size_policy.\n+  HeapWord* allocate_old_gen_and_record(size_t word_size);\n+\n","filename":"src\/hotspot\/share\/gc\/parallel\/parallelScavengeHeap.hpp","additions":3,"deletions":0,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -150,10 +150,0 @@\n-HeapWord* PSOldGen::allocate_and_record(size_t word_size) {\n-  assert_locked_or_safepoint(Heap_lock);\n-  HeapWord* res = allocate(word_size);\n-  if (res != NULL) {\n-    ParallelScavengeHeap* heap = ParallelScavengeHeap::heap();\n-    heap->size_policy()->tenured_allocation(word_size * HeapWordSize);\n-  }\n-  return res;\n-}\n-\n","filename":"src\/hotspot\/share\/gc\/parallel\/psOldGen.cpp","additions":0,"deletions":10,"binary":false,"changes":10,"status":"modified"},{"patch":"@@ -137,1 +137,0 @@\n-  \/\/ Allocate memory, but don't record as an oldgen mutator allocation.\n@@ -143,3 +142,0 @@\n-  \/\/ Allocate memory and record as a mutator allocation.\n-  HeapWord* allocate_and_record(size_t word_size);\n-\n","filename":"src\/hotspot\/share\/gc\/parallel\/psOldGen.hpp","additions":0,"deletions":4,"binary":false,"changes":4,"status":"modified"}]}