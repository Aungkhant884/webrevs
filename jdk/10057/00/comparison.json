{"files":[{"patch":"@@ -30,1 +30,1 @@\n-  return emit_shared_stubs_to_interp<MacroAssembler, Assembler::imm_operand>(this, _shared_stub_to_interp_requests);\n+  return emit_shared_stubs_to_interp<MacroAssembler>(this, _shared_stub_to_interp_requests);\n","filename":"src\/hotspot\/cpu\/riscv\/codeBuffer_riscv.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"previous_filename":"src\/hotspot\/cpu\/x86\/codeBuffer_x86.cpp","status":"copied"},{"patch":"@@ -32,6 +32,1 @@\n-  bool pd_finalize_stubs() {\n-    if (_finalize_stubs) {\n-      Unimplemented();\n-    }\n-    return true;\n-  }\n+  bool pd_finalize_stubs();\n@@ -41,1 +36,1 @@\n-  static constexpr bool supports_shared_stubs() { return false; }\n+  static constexpr bool supports_shared_stubs() { return true; }\n","filename":"src\/hotspot\/cpu\/riscv\/codeBuffer_riscv.hpp","additions":2,"deletions":7,"binary":false,"changes":9,"status":"modified"},{"patch":"@@ -2270,5 +2270,11 @@\n-      \/\/ Emit stub for static call\n-      address stub = CompiledStaticCall::emit_to_interp_stub(cbuf);\n-      if (stub == NULL) {\n-        ciEnv::current()->record_failure(\"CodeCache is full\");\n-        return;\n+      if (CodeBuffer::supports_shared_stubs() && _method->can_be_statically_bound()) {\n+        \/\/ Calls of the same statically bound method can share\n+        \/\/ a stub to the interpreter.\n+        cbuf.shared_stub_to_interp_for(_method, cbuf.insts()->mark_off());\n+      } else {\n+        \/\/ Emit stub for static call\n+        address stub = CompiledStaticCall::emit_to_interp_stub(cbuf);\n+        if (stub == NULL) {\n+          ciEnv::current()->record_failure(\"CodeCache is full\");\n+          return;\n+        }\n","filename":"src\/hotspot\/cpu\/riscv\/riscv.ad","additions":11,"deletions":5,"binary":false,"changes":16,"status":"modified"},{"patch":"@@ -31,1 +31,1 @@\n- * @requires os.arch==\"amd64\" | os.arch==\"x86_64\" | os.arch==\"i386\" | os.arch==\"x86\" | os.arch==\"aarch64\"\n+ * @requires os.arch==\"amd64\" | os.arch==\"x86_64\" | os.arch==\"i386\" | os.arch==\"x86\" | os.arch==\"aarch64\" | os.arch==\"riscv64\"\n","filename":"test\/hotspot\/jtreg\/compiler\/sharedstubs\/SharedStubToInterpTest.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"}]}