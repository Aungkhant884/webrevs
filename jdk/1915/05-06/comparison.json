{"files":[{"patch":"@@ -56,1 +56,1 @@\n-    private static final int TRANSFER_BUFFER_SIZE = 8192;\n+    private static final int WORK_BUFFER_SIZE = 8192;\n@@ -151,0 +151,6 @@\n+    \/**\n+     * Work buffer, null until allocated, guarded by #lock,\n+     * may grow up to WORK_BUFFER_SIZE.\n+     *\/\n+    private char[] workBuffer = null;\n+\n@@ -189,1 +195,1 @@\n-            char cbuf[] = target.array();\n+            char[] cbuf = target.array();\n@@ -200,1 +206,1 @@\n-            char cbuf[] = new char[Math.min(remaining, TRANSFER_BUFFER_SIZE)];\n+            int bufferSize = Math.min(remaining, WORK_BUFFER_SIZE);\n@@ -203,0 +209,2 @@\n+                if ((workBuffer == null) || (workBuffer.length < bufferSize))\n+                    workBuffer = new char[bufferSize];\n@@ -206,2 +214,2 @@\n-                    if ((n = read(cbuf, 0, Math.min(remaining, cbuf.length))) > 0) {\n-                        target.put(cbuf, 0, n);\n+                    if ((n = read(workBuffer, 0, Math.min(remaining, bufferSize))) > 0) {\n+                        target.put(workBuffer, 0, n);\n@@ -233,1 +241,1 @@\n-        char cb[] = new char[1];\n+        char[] cb = new char[1];\n@@ -258,1 +266,1 @@\n-    public int read(char cbuf[]) throws IOException {\n+    public int read(char[] cbuf) throws IOException {\n@@ -285,7 +293,1 @@\n-    public abstract int read(char cbuf[], int off, int len) throws IOException;\n-\n-    \/** Maximum skip-buffer size *\/\n-    private static final int maxSkipBufferSize = 8192;\n-\n-    \/** Skip buffer, null until allocated *\/\n-    private char skipBuffer[] = null;\n+    public abstract int read(char[] cbuf, int off, int len) throws IOException;\n@@ -307,1 +309,1 @@\n-        int nn = (int) Math.min(n, maxSkipBufferSize);\n+        int nn = (int) Math.min(n, WORK_BUFFER_SIZE);\n@@ -309,2 +311,2 @@\n-            if ((skipBuffer == null) || (skipBuffer.length < nn))\n-                skipBuffer = new char[nn];\n+            if ((workBuffer == null) || (workBuffer.length < nn))\n+                workBuffer = new char[nn];\n@@ -313,1 +315,1 @@\n-                int nc = read(skipBuffer, 0, (int)Math.min(r, nn));\n+                int nc = read(workBuffer, 0, (int)Math.min(r, nn));\n@@ -418,1 +420,1 @@\n-        char[] buffer = new char[TRANSFER_BUFFER_SIZE];\n+        char[] buffer = new char[WORK_BUFFER_SIZE];\n@@ -420,1 +422,1 @@\n-        while ((nRead = read(buffer, 0, TRANSFER_BUFFER_SIZE)) >= 0) {\n+        while ((nRead = read(buffer, 0, WORK_BUFFER_SIZE)) >= 0) {\n","filename":"src\/java.base\/share\/classes\/java\/io\/Reader.java","additions":22,"deletions":20,"binary":false,"changes":42,"status":"modified"}]}