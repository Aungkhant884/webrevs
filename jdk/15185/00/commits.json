[{"commit":{"message":"6415065: Submenu is shown on wrong screen in multiple monitor environment\n\nWhat happens here is that when the position of a popup menu is\ncalculated, it can expand above or below, depending on the position of\nthe parent menu, the item being expanded and the size of the submenu and\nscreen resolution.\n\nIf the menu decides to expand above, the position calculation in\nJMenu.getPopupMenuOrigin may yield a coordinate above the current\nscreen.  Later, JPopupMenu.adjustPopupLocationToFitScreen tries to fit\nthe entire menu into the screen.  However, it has no idea which screen\nis correct, as all it has is an (x, y) location. If that location is\ninvalid, it may correct it by fitting it into the screen. However, if it\nis valid, but located on an incorrect screen, then the whole logic goes\nawry and the menu is fitted into the wrong screen.\n\nIn theory, a similar issue is possible if the menu decides to expand\nbelow, though it's not easily reproducible as it would require a rather\nunique combination of factors, such as unusually large\nMenu.submenuPopupOffsetY.\n\nThe same thing could also happen to the X location, although it's less\nlikely because the popup menu has to be unusually wide for that.\n\nFix by pre-adjusting the location to fit into the correct screen in\nJMenu.getPopupMenuOrigin, where the correct screen is still known.  The\nresulting location may still not be final, as the menu's height needs to\nbe taken into account as well, but that's exactly what\nJPopupMenu.adjustPopupLocationToFitScreen does.  Since the coordinate is\non the correct screen now, it fits the menu into the same screen, which\nguarantees it'll be the correct one."},"files":[{"filename":"src\/java.desktop\/share\/classes\/javax\/swing\/JMenu.java"}],"sha":"3fb94a6b6a409446b40fd6b71122d16c2030b1f4"}]