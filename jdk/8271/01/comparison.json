{"files":[{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2003, 2019, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2003, 2022, Oracle and\/or its affiliates. All rights reserved.\n@@ -272,4 +272,0 @@\n-            \/\/ Determine which NamedGroup we'll be using, then use\n-            \/\/ the creator functions.\n-            NamedGroup namedGroup = null;\n-\n@@ -278,10 +274,1 @@\n-            NamedParameterSpec namedParams = null;\n-            if (ecParams != null) {\n-                namedGroup = NamedGroup.valueOf(ecParams);\n-            }\n-\n-            \/\/ Wasn't EC, try XEC.\n-            if (ecParams == null) {\n-                namedParams = x509Possession.getXECParameterSpec();\n-                namedGroup = NamedGroup.nameOf(namedParams.getName());\n-            }\n+            NamedParameterSpec namedParams = x509Possession.getXECParameterSpec();\n@@ -296,0 +283,4 @@\n+            \/\/ Determine which NamedGroup we'll be using, then use\n+            \/\/ the creator functions.\n+            NamedGroup namedGroup = x509Possession.getNamedGroup();\n+\n","filename":"src\/java.base\/share\/classes\/sun\/security\/ssl\/ECDHClientKeyExchange.java","additions":6,"deletions":15,"binary":false,"changes":21,"status":"modified"},{"patch":"@@ -300,1 +300,1 @@\n-                NamedGroup ng = NamedGroup.valueOf(params);\n+                NamedGroup ng = ((X509Possession)poss).getECNamedGroup();\n","filename":"src\/java.base\/share\/classes\/sun\/security\/ssl\/ECDHKeyExchange.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -475,0 +475,4 @@\n+\n+        ECParameterSpec params = x509Possession.getECParameterSpec();\n+        NamedGroup namedGroup = x509Possession.getECNamedGroup();\n+\n@@ -491,4 +495,1 @@\n-                    ECParameterSpec params =\n-                            x509Possession.getECParameterSpec();\n-                    if (params != null &&\n-                            ss.namedGroup == NamedGroup.valueOf(params)) {\n+                    if (namedGroup == ss.namedGroup) {\n@@ -517,10 +518,5 @@\n-                    ECParameterSpec params =\n-                            x509Possession.getECParameterSpec();\n-                    if (params != null) {\n-                        NamedGroup keyGroup = NamedGroup.valueOf(params);\n-                        if (keyGroup != null &&\n-                                SupportedGroups.isSupported(keyGroup)) {\n-                            Signature signer = ss.getSigner(signingKey);\n-                            if (signer != null) {\n-                                return new SimpleImmutableEntry<>(ss, signer);\n-                            }\n+                    if (namedGroup != null &&\n+                            SupportedGroups.isSupported(namedGroup)) {\n+                        Signature signer = ss.getSigner(signingKey);\n+                        if (signer != null) {\n+                            return new SimpleImmutableEntry<>(ss, signer);\n","filename":"src\/java.base\/share\/classes\/sun\/security\/ssl\/SignatureScheme.java","additions":10,"deletions":14,"binary":false,"changes":24,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2018, 2021, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2018, 2022, Oracle and\/or its affiliates. All rights reserved.\n@@ -125,0 +125,6 @@\n+        private final ECParameterSpec     ecParams;\n+        private final NamedGroup          ecNamedGroup;\n+\n+        private final NamedParameterSpec  xecParams;\n+        private final NamedGroup          xecNamedGroup;\n+\n@@ -129,0 +135,16 @@\n+\n+            ecParams = getECParams();\n+\n+            if (ecParams != null) {\n+                ecNamedGroup = NamedGroup.valueOf(ecParams);\n+\n+                xecParams = null;\n+                xecNamedGroup = null;\n+            } else {\n+                ecNamedGroup = null;\n+\n+                \/\/ Wasn't EC, try XEC.\n+                xecParams = getXECParams();\n+                xecNamedGroup = xecParams != null\n+                        ? NamedGroup.nameOf(xecParams.getName()) : null;\n+            }\n@@ -132,0 +154,4 @@\n+            return ecParams;\n+        }\n+\n+        private ECParameterSpec getECParams() {\n@@ -151,1 +177,0 @@\n-        \/\/ Similar to above, but for XEC.\n@@ -153,0 +178,5 @@\n+            return xecParams;\n+        }\n+\n+        \/\/ Similar to above, but for XEC.\n+        private NamedParameterSpec getXECParams() {\n@@ -179,0 +209,8 @@\n+\n+        NamedGroup getNamedGroup() {\n+            return ecNamedGroup != null ? ecNamedGroup : xecNamedGroup;\n+        }\n+\n+        NamedGroup getECNamedGroup() {\n+            return ecNamedGroup;\n+        }\n","filename":"src\/java.base\/share\/classes\/sun\/security\/ssl\/X509Authentication.java","additions":40,"deletions":2,"binary":false,"changes":42,"status":"modified"}]}