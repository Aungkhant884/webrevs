{"files":[{"patch":"@@ -272,11 +272,0 @@\n-            \/\/ Iteratively determine the X509Possession type's ParameterSpec.\n-            ECParameterSpec ecParams = x509Possession.getECParameterSpec();\n-            NamedParameterSpec namedParams = x509Possession.getXECParameterSpec();\n-\n-            \/\/ Can't figure this out, bail.\n-            if ((ecParams == null) && (namedParams == null)) {\n-                \/\/ unlikely, have been checked during cipher suite negotiation.\n-                throw shc.conContext.fatal(Alert.ILLEGAL_PARAMETER,\n-                    \"Not EC\/XDH server cert for ECDH client key exchange\");\n-            }\n-\n@@ -292,0 +281,7 @@\n+            }\n+\n+            \/\/ unlikely, have been checked during cipher suite negotiation.\n+            if (namedGroup.spec != NamedGroup.NamedGroupSpec.NAMED_GROUP_ECDHE\n+                    && namedGroup.spec != NamedGroup.NamedGroupSpec.NAMED_GROUP_XDH) {\n+                throw shc.conContext.fatal(Alert.ILLEGAL_PARAMETER,\n+                    \"Not EC\/XDH server cert for ECDH client key exchange\");\n","filename":"src\/java.base\/share\/classes\/sun\/security\/ssl\/ECDHClientKeyExchange.java","additions":7,"deletions":11,"binary":false,"changes":18,"status":"modified"},{"patch":"@@ -476,1 +476,0 @@\n-        ECParameterSpec params = x509Possession.getECParameterSpec();\n@@ -506,1 +505,2 @@\n-                            \"), unsupported EC parameter spec: \" + params);\n+                            \"), unsupported EC parameter spec: \" +\n+                            x509Possession.getECParameterSpec());\n@@ -530,1 +530,2 @@\n-                            \"), unsupported EC parameter spec: \" + params);\n+                            \"), unsupported EC parameter spec: \" +\n+                            x509Possession.getECParameterSpec());\n","filename":"src\/java.base\/share\/classes\/sun\/security\/ssl\/SignatureScheme.java","additions":4,"deletions":3,"binary":false,"changes":7,"status":"modified"},{"patch":"@@ -125,1 +125,1 @@\n-        private final ECParameterSpec     ecParams;\n+        private final ECParameterSpec     ecParamSpec;\n@@ -128,1 +128,1 @@\n-        private final NamedParameterSpec  xecParams;\n+        private final NamedParameterSpec  xecParamSpec;\n@@ -136,1 +136,1 @@\n-            ecParams = getECParams();\n+            ecParamSpec = getECParamSpec();\n@@ -138,2 +138,2 @@\n-            if (ecParams != null) {\n-                ecNamedGroup = NamedGroup.valueOf(ecParams);\n+            if (ecParamSpec != null) {\n+                ecNamedGroup = NamedGroup.valueOf(ecParamSpec);\n@@ -141,1 +141,1 @@\n-                xecParams = null;\n+                xecParamSpec = null;\n@@ -147,3 +147,3 @@\n-                xecParams = getXECParams();\n-                xecNamedGroup = xecParams != null\n-                        ? NamedGroup.nameOf(xecParams.getName()) : null;\n+                xecParamSpec = getXECParamSpec();\n+                xecNamedGroup = xecParamSpec != null\n+                        ? NamedGroup.nameOf(xecParamSpec.getName()) : null;\n@@ -154,1 +154,1 @@\n-            return ecParams;\n+            return ecParamSpec;\n@@ -157,1 +157,1 @@\n-        private ECParameterSpec getECParams() {\n+        private ECParameterSpec getECParamSpec() {\n@@ -178,1 +178,1 @@\n-            return xecParams;\n+            return xecParamSpec;\n@@ -182,1 +182,1 @@\n-        private NamedParameterSpec getXECParams() {\n+        private NamedParameterSpec getXECParamSpec() {\n","filename":"src\/java.base\/share\/classes\/sun\/security\/ssl\/X509Authentication.java","additions":13,"deletions":13,"binary":false,"changes":26,"status":"modified"}]}