{"files":[{"patch":"@@ -696,1 +696,2 @@\n-  bool force_JVMCI_intialization = false;\n+  bool force_JVMCI_initialization = false;\n+  bool forced_JVMCI_initialization_must_succeed = true;\n@@ -700,1 +701,1 @@\n-    force_JVMCI_intialization = EagerJVMCI || JVMCIPrintProperties || JVMCILibDumpJNIConfig;\n+    force_JVMCI_initialization = EagerJVMCI || JVMCIPrintProperties || JVMCILibDumpJNIConfig;\n@@ -702,1 +703,1 @@\n-    if (!force_JVMCI_intialization) {\n+    if (!force_JVMCI_initialization) {\n@@ -705,1 +706,2 @@\n-      force_JVMCI_intialization = UseJVMCICompiler && (!UseInterpreter || !BackgroundCompilation);\n+      force_JVMCI_initialization = UseJVMCICompiler && (!UseInterpreter || !BackgroundCompilation);\n+      forced_JVMCI_initialization_must_succeed = false;\n@@ -712,1 +714,1 @@\n-  if (JVMCI_ONLY(!force_JVMCI_intialization) NOT_JVMCI(true)) {\n+  if (JVMCI_ONLY(!force_JVMCI_initialization) NOT_JVMCI(true)) {\n@@ -757,2 +759,13 @@\n-  if (force_JVMCI_intialization) {\n-    JVMCI::initialize_compiler(CHECK_JNI_ERR);\n+  if (force_JVMCI_initialization) {\n+    JVMCI::initialize_compiler(THREAD);\n+    if (HAS_PENDING_EXCEPTION) {\n+      if (forced_JVMCI_initialization_must_succeed) {\n+        return JNI_ERR;\n+      } else {\n+        ResourceMark rm(THREAD);\n+        stringStream st;\n+        java_lang_Throwable::print(PENDING_EXCEPTION, &st);\n+        CLEAR_PENDING_EXCEPTION;\n+        JVMCI_event_1(\"Error during eager JVMCI initialization: %s\", st.as_string());\n+      }\n+    }\n","filename":"src\/hotspot\/share\/runtime\/threads.cpp","additions":20,"deletions":7,"binary":false,"changes":27,"status":"modified"}]}