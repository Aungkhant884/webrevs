{"files":[{"patch":"@@ -35,0 +35,1 @@\n+import java.nio.file.Files;\n@@ -36,0 +37,1 @@\n+import java.nio.file.Paths;\n@@ -39,0 +41,2 @@\n+    private static final String JAVA_SECURITY_FILE = \"java.security\";\n+\n@@ -100,0 +104,4 @@\n+        Files.writeString(Files.createFile(Paths.get(JAVA_SECURITY_FILE)),\n+                \"jdk.certpath.disabledAlgorithms=\\n\" +\n+                \"jdk.jar.disabledAlgorithms=MD5\\n\");\n+\n@@ -102,1 +110,19 @@\n-                \"-verbose\" +\n+                \"-verbose \" +\n+                \"-J-Djava.security.properties=\" +\n+                JAVA_SECURITY_FILE +\n+                \" a.jar ee\")\n+                .shouldNotContain(\"Signature algorithm: MD5withRSA (disabled), 2048-bit key\")\n+                .shouldContain(\"Signature algorithm: SHA256withRSA, 2048-bit key\")\n+                .shouldNotContain(\"Invalid certificate chain: Algorithm constraints check failed on signature algorithm: MD5withRSA\")\n+                .shouldHaveExitValue(0);\n+\n+        Files.deleteIfExists(Paths.get(JAVA_SECURITY_FILE));\n+        Files.writeString(Files.createFile(Paths.get(JAVA_SECURITY_FILE)),\n+                \"jdk.certpath.disabledAlgorithms=MD5\\n\" +\n+                \"jdk.jar.disabledAlgorithms=\\n\");\n+\n+        SecurityTools.jarsigner(\"-keystore ks -storepass changeit \" +\n+                \"-signedjar signeda.jar \" +\n+                \"-verbose \" +\n+                \"-J-Djava.security.properties=\" +\n+                JAVA_SECURITY_FILE +\n","filename":"test\/jdk\/sun\/security\/tools\/jarsigner\/CheckSignerCertChain.java","additions":27,"deletions":1,"binary":false,"changes":28,"status":"modified"}]}