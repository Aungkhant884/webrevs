{"files":[{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2003, 2020, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2003, 2021, Oracle and\/or its affiliates. All rights reserved.\n@@ -554,0 +554,1 @@\n+  JavaThread* thread = THREAD->as_Java_thread();\n@@ -555,1 +556,1 @@\n-  if (SafepointMechanism::should_process(THREAD)) {\n+  if (SafepointMechanism::should_process(thread)) {\n@@ -580,1 +581,0 @@\n-  JavaThread* thread = THREAD->as_Java_thread();\n@@ -642,0 +642,1 @@\n+  JavaThread* thread = THREAD->as_Java_thread();\n@@ -643,1 +644,1 @@\n-  if (SafepointMechanism::should_process(THREAD)) {\n+  if (SafepointMechanism::should_process(thread)) {\n@@ -669,1 +670,0 @@\n-  JavaThread* thread = THREAD->as_Java_thread();\n@@ -737,1 +737,1 @@\n-  if (SafepointMechanism::should_process(THREAD)) {\n+  if (SafepointMechanism::should_process(thread)) {\n","filename":"src\/hotspot\/cpu\/zero\/zeroInterpreter_zero.cpp","additions":6,"deletions":6,"binary":false,"changes":12,"status":"modified"},{"patch":"@@ -51,1 +51,0 @@\n-  static inline bool local_poll(Thread* thread);\n@@ -83,1 +82,1 @@\n-  static inline bool should_process(Thread* thread);\n+  static inline bool should_process(JavaThread* thread);\n","filename":"src\/hotspot\/share\/runtime\/safepointMechanism.hpp","additions":1,"deletions":2,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2017, 2020, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2017, 2021, Oracle and\/or its affiliates. All rights reserved.\n@@ -63,11 +63,2 @@\n-bool SafepointMechanism::local_poll(Thread* thread) {\n-  if (thread->is_Java_thread()) {\n-    return local_poll_armed(thread->as_Java_thread());\n-  } else {\n-    \/\/ If the poll is on a non-java thread we can only check the global state.\n-    return global_poll();\n-  }\n-}\n-\n-bool SafepointMechanism::should_process(Thread* thread) {\n-  return local_poll(thread);\n+bool SafepointMechanism::should_process(JavaThread* thread) {\n+  return local_poll_armed(thread);\n@@ -76,3 +67,3 @@\n-void SafepointMechanism::process_if_requested(JavaThread *thread) {\n-  if (!local_poll_armed(thread)) {\n-    return;\n+void SafepointMechanism::process_if_requested(JavaThread* thread) {\n+  if (local_poll_armed(thread)) {\n+    process_if_requested_slow(thread);\n@@ -80,1 +71,0 @@\n-  process_if_requested_slow(thread);\n","filename":"src\/hotspot\/share\/runtime\/safepointMechanism.inline.hpp","additions":6,"deletions":16,"binary":false,"changes":22,"status":"modified"}]}