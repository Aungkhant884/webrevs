{"files":[{"patch":"@@ -44,0 +44,1 @@\n+import java.nio.file.DirectoryStream;\n@@ -51,2 +52,0 @@\n-import sun.security.util.ObjectIdentifier;\n-import sun.security.util.KnownOIDs;\n@@ -61,9 +60,12 @@\n-        Files.newDirectoryStream(Path.of(System.getProperty(\"test.src\"), \"params\"))\n-                .forEach(p -> {\n-                    try (InputStream is = Files.newInputStream(p);\n-                         OutputStream os = Files.newOutputStream(p.getFileName())){\n-                        Base64.getMimeDecoder().wrap(is).transferTo(os);\n-                    } catch (IOException e) {\n-                        throw new UncheckedIOException(e);\n-                    }\n-                });\n+        try (DirectoryStream<Path> stream = Files.newDirectoryStream(\n+                Path.of(System.getProperty(\"test.src\"), \"params\"),\n+                p -> !p.getFileName().toString().equals(\"README\"))) {\n+            stream.forEach(p -> {\n+                try (InputStream is = Files.newInputStream(p);\n+                     OutputStream os = Files.newOutputStream(p.getFileName())) {\n+                    Base64.getMimeDecoder().wrap(is).transferTo(os);\n+                } catch (IOException e) {\n+                    throw new UncheckedIOException(e);\n+                }\n+            });\n+        }\n@@ -128,4 +130,0 @@\n-        keytool(\"-importkeystore -srckeystore ks -srcstorepass changeit \"\n-                + \"-destkeystore ksnormal -deststorepass changeit \"\n-                + \"-J-Dkeystore.pkcs12.legacy\");\n-\n","filename":"test\/jdk\/sun\/security\/pkcs12\/ParamsTest.java","additions":13,"deletions":15,"binary":false,"changes":28,"status":"modified"},{"patch":"@@ -2,0 +2,1 @@\n+Do not use OpenSSL 3.0.0. The default algorithms for pkcs12 are changed.\n@@ -3,0 +4,1 @@\n+(\n@@ -5,1 +7,1 @@\n-keytool -keystore ks -genkeypair -storepass changeit -alias a -dname CN=A\n+keytool -keystore ks -keyalg ec -genkeypair -storepass changeit -alias a -dname CN=A\n@@ -20,0 +22,1 @@\n+)\n@@ -26,4 +29,4 @@\n-openssl pkcs12 -in ks2 -passin pass:changeit -info -nokeys -nocerts 2> t2 || exit 20\n-grep \"MAC:sha1 Iteration 100000\" t2 || exit 21\n-grep \"Shrouded Keybag: pbeWithSHA1And3-KeyTripleDES-CBC, Iteration 50000\" t2 || exit 23\n-grep \"PKCS7 Encrypted data: pbeWithSHA1And40BitRC2-CBC, Iteration 50000\" t2 || exit 24\n+openssl pkcs12 -in ksnormal -passin pass:changeit -info -nokeys -nocerts 2> t2 || exit 20\n+grep \"MAC: sha256, Iteration 10000\" t2 || exit 21\n+grep \"Shrouded Keybag: PBES2, PBKDF2, AES-256-CBC, Iteration 10000, PRF hmacWithSHA256\" t2 || exit 23\n+grep \"PKCS7 Encrypted data: PBES2, PBKDF2, AES-256-CBC, Iteration 10000, PRF hmacWithSHA256\" t2 || exit 24\n@@ -31,1 +34,1 @@\n-openssl pkcs12 -in ks22 -passin pass:changeit -info -nokeys -nocerts 2> t22 || exit 25\n+openssl pkcs12 -in ksnormaldup -passin pass:changeit -info -nokeys -nocerts 2> t22 || exit 25\n@@ -34,1 +37,1 @@\n-openssl pkcs12 -in ks3 -passin pass:changeit -info -nokeys -nocerts && exit 30\n+openssl pkcs12 -in ksnopass -passin pass:changeit -info -nokeys -nocerts && exit 30\n@@ -36,1 +39,1 @@\n-openssl pkcs12 -in ks3 -passin pass:changeit -info -nokeys -nocerts -nomacver 2> t3 || exit 31\n+openssl pkcs12 -in ksnopass -passin pass:changeit -info -nokeys -nocerts -nomacver 2> t3 || exit 31\n@@ -38,2 +41,2 @@\n-grep \"Shrouded Keybag: pbeWithSHA1And3-KeyTripleDES-CBC, Iteration 50000\" t3 || exit 34\n-grep \"Shrouded Keybag: pbeWithSHA1And128BitRC4, Iteration 50000\" t3 || exit 35\n+grep \"Shrouded Keybag: PBES2, PBKDF2, AES-256-CBC, Iteration 10000, PRF hmacWithSHA256\" t3 || exit 34\n+grep \"Shrouded Keybag: pbeWithSHA1And128BitRC4, Iteration 10000\" t3 || exit 35\n@@ -41,1 +44,1 @@\n-openssl pkcs12 -in ks33 -passin pass:changeit -info -nokeys -nocerts -nomacver 2> t33 || exit 36\n+openssl pkcs12 -in ksnopassdup -passin pass:changeit -info -nokeys -nocerts -nomacver 2> t33 || exit 36\n@@ -44,5 +47,5 @@\n-openssl pkcs12 -in ks4 -passin pass:changeit -info -nokeys -nocerts 2> t4 || exit 40\n-grep \"MAC:sha1 Iteration 5555\" t4 || exit 41\n-grep \"Shrouded Keybag: pbeWithSHA1And3-KeyTripleDES-CBC, Iteration 7777\" t4 || exit 43\n-grep \"Shrouded Keybag: pbeWithSHA1And128BitRC4, Iteration 50000\" t4 || exit 44\n-grep \"PKCS7 Encrypted data: pbeWithSHA1And40BitRC2-CBC, Iteration 6666\" t4 || exit 45\n+openssl pkcs12 -in ksnewic -passin pass:changeit -info -nokeys -nocerts 2> t4 || exit 40\n+grep \"MAC: sha256, Iteration 5555\" t4 || exit 41\n+grep \"Shrouded Keybag: PBES2, PBKDF2, AES-256-CBC, Iteration 7777, PRF hmacWithSHA256\" t4 || exit 43\n+grep \"Shrouded Keybag: pbeWithSHA1And128BitRC4, Iteration 10000\" t4 || exit 44\n+grep \"PKCS7 Encrypted data: PBES2, PBKDF2, AES-256-CBC, Iteration 6666, PRF hmacWithSHA256\" t4 || exit 45\n@@ -50,1 +53,1 @@\n-openssl pkcs12 -in ks44 -passin pass:changeit -info -nokeys -nocerts 2> t44 || exit 46\n+openssl pkcs12 -in ksnewicdup -passin pass:changeit -info -nokeys -nocerts 2> t44 || exit 46\n","filename":"test\/jdk\/sun\/security\/pkcs12\/params\/README","additions":20,"deletions":17,"binary":false,"changes":37,"status":"modified"}]}