{"files":[{"patch":"@@ -92,2 +92,2 @@\n-    \/\/ singleton instance or null if not available\n-    private static final RandomIO INSTANCE = initIO(Variant.MIXED);\n+    \/\/ ThreadLocal instance or null if not available\n+    private static final ThreadLocal<RandomIO> INSTANCE = initIO(Variant.MIXED);\n@@ -130,1 +130,1 @@\n-    private static RandomIO initIO(final Variant v) {\n+    private static ThreadLocal<RandomIO> initIO(final Variant v) {\n@@ -132,1 +132,1 @@\n-            new PrivilegedAction<>() {\n+            new PrivilegedAction<ThreadLocal<RandomIO>>() {\n@@ -134,1 +134,1 @@\n-                public RandomIO run() {\n+                public ThreadLocal<RandomIO> run() {\n@@ -191,5 +191,7 @@\n-                    try {\n-                        return new RandomIO(seedFile, nextFile);\n-                    } catch (Exception e) {\n-                        return null;\n-                    }\n+                    return ThreadLocal.withInitial(() -> {\n+                        try {\n+                            return new RandomIO(seedFile, nextFile);\n+                        } catch (Exception e) {\n+                            return null;\n+                        }\n+                    });\n@@ -202,1 +204,1 @@\n-        return INSTANCE != null;\n+        return INSTANCE.get() != null;\n@@ -208,1 +210,1 @@\n-        if (INSTANCE == null) {\n+        if (INSTANCE.get() == null) {\n@@ -216,1 +218,1 @@\n-        INSTANCE.implSetSeed(seed);\n+        INSTANCE.get().implSetSeed(seed);\n@@ -222,1 +224,1 @@\n-        INSTANCE.implNextBytes(bytes);\n+        INSTANCE.get().implNextBytes(bytes);\n@@ -228,1 +230,1 @@\n-        return INSTANCE.implGenerateSeed(numBytes);\n+        return INSTANCE.get().implGenerateSeed(numBytes);\n@@ -246,1 +248,2 @@\n-        private static final RandomIO INSTANCE = initIO(Variant.BLOCKING);\n+       \/\/ private static final ThreadLocal<RandomIO> INSTANCE = new ThreadLocal<> ();\n+        private static final ThreadLocal<RandomIO> INSTANCE = initIO(Variant.BLOCKING);\n@@ -250,1 +253,1 @@\n-            return INSTANCE != null;\n+            return INSTANCE.get() != null;\n@@ -256,1 +259,1 @@\n-            if (INSTANCE == null) {\n+            if (INSTANCE.get() == null) {\n@@ -264,1 +267,1 @@\n-            INSTANCE.implSetSeed(seed);\n+            INSTANCE.get().implSetSeed(seed);\n@@ -270,1 +273,1 @@\n-            INSTANCE.implNextBytes(bytes);\n+            INSTANCE.get().implNextBytes(bytes);\n@@ -276,1 +279,1 @@\n-            return INSTANCE.implGenerateSeed(numBytes);\n+            return INSTANCE.get().implGenerateSeed(numBytes);\n@@ -295,1 +298,1 @@\n-        private static final RandomIO INSTANCE = initIO(Variant.NONBLOCKING);\n+        private static final ThreadLocal<RandomIO> INSTANCE = initIO(Variant.NONBLOCKING);\n@@ -299,1 +302,1 @@\n-            return INSTANCE != null;\n+            return INSTANCE.get() != null;\n@@ -305,1 +308,1 @@\n-            if (INSTANCE == null) {\n+            if (INSTANCE.get() == null) {\n@@ -314,1 +317,1 @@\n-            INSTANCE.implSetSeed(seed);\n+            INSTANCE.get().implSetSeed(seed);\n@@ -320,1 +323,1 @@\n-            INSTANCE.implNextBytes(bytes);\n+            INSTANCE.get().implNextBytes(bytes);\n@@ -326,1 +329,1 @@\n-            return INSTANCE.implGenerateSeed(numBytes);\n+            return INSTANCE.get().implGenerateSeed(numBytes);\n","filename":"src\/java.base\/unix\/classes\/sun\/security\/provider\/NativePRNG.java","additions":30,"deletions":27,"binary":false,"changes":57,"status":"modified"}]}