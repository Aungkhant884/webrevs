{"files":[{"patch":"@@ -70,0 +70,1 @@\n+NOT_PRODUCT(cflags(PrintIdealLevel,     uintx, PrintIdealLevel, PrintIdealLevel)) \\\n","filename":"src\/hotspot\/share\/compiler\/compilerDirectives.hpp","additions":1,"deletions":0,"binary":false,"changes":1,"status":"modified"},{"patch":"@@ -82,1 +82,2 @@\n-  option(PrintIdeal, \"PrintIdeal\", Bool) \\\n+  option(PrintIdeal, \"PrintIdeal\", Bool)  \\\n+  option(PrintIdealLevel, \"PrintIdealLevel\", Uintx) \\\n","filename":"src\/hotspot\/share\/compiler\/compilerOracle.hpp","additions":2,"deletions":1,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -115,0 +115,5 @@\n+  notproduct(uintx, PrintIdealLevel, 0,                                     \\\n+          \"Print ideal IR on stdout. \"                                      \\\n+          \"Same levels as PrintIdealGraphLevel\")                            \\\n+          range(0, 4)                                                       \\\n+                                                                            \\\n","filename":"src\/hotspot\/share\/opto\/c2_globals.hpp","additions":5,"deletions":0,"binary":false,"changes":5,"status":"modified"},{"patch":"@@ -538,0 +538,20 @@\n+#ifndef PRODUCT\n+void Compile::print_ideal_ir(const char* phase_name) {\n+  ttyLocker ttyl;\n+  \/\/ keep the following output all in one block\n+  \/\/ This output goes directly to the tty, not the compiler log.\n+  \/\/ To enable tools to match it up with the compilation activity,\n+  \/\/ be sure to tag this tty output with the compile ID.\n+  if (xtty != NULL) {\n+    xtty->head(\"ideal compile_id='%d'%s compile_phase='%s'\",\n+               compile_id(),\n+               is_osr_compilation() ? \" compile_kind='osr'\" : \"\",\n+               phase_name);\n+  }\n+  root()->dump(9999);\n+  if (xtty != NULL) {\n+    xtty->tail(\"ideal\");\n+  }\n+}\n+#endif\n+\n@@ -566,1 +586,0 @@\n-                  _print_ideal(directive->PrintIdealOption),\n@@ -585,1 +604,1 @@\n-                  NOT_PRODUCT(_printer(NULL) COMMA)\n+                  NOT_PRODUCT(_igv_printer(NULL) COMMA)\n@@ -767,2 +786,2 @@\n-  if (should_print(1)) {\n-    _printer->print_inlining();\n+  if (should_print_igv(1)) {\n+    _igv_printer->print_inlining();\n@@ -795,14 +814,2 @@\n-  if (print_ideal()) {\n-    ttyLocker ttyl;  \/\/ keep the following output all in one block\n-    \/\/ This output goes directly to the tty, not the compiler log.\n-    \/\/ To enable tools to match it up with the compilation activity,\n-    \/\/ be sure to tag this tty output with the compile ID.\n-    if (xtty != NULL) {\n-      xtty->head(\"ideal compile_id='%d'%s\", compile_id(),\n-                 is_osr_compilation()    ? \" compile_kind='osr'\" :\n-                 \"\");\n-    }\n-    root()->dump(9999);\n-    if (xtty != NULL) {\n-      xtty->tail(\"ideal\");\n-    }\n+  if (should_print_ideal()) {\n+    print_ideal_ir(\"print_ideal\");\n@@ -864,1 +871,0 @@\n-    _print_ideal(directive->PrintIdealOption),\n@@ -876,1 +882,1 @@\n-    NOT_PRODUCT(_printer(NULL) COMMA)\n+    NOT_PRODUCT(_igv_printer(NULL) COMMA)\n@@ -4833,2 +4839,5 @@\n-  if (should_print(level)) {\n-    _printer->print_method(name, level);\n+  if (should_print_igv(level)) {\n+    _igv_printer->print_method(name, level);\n+  }\n+  if (should_print_ideal(level)) {\n+    print_ideal_ir(name);\n@@ -4843,2 +4852,2 @@\n-  if (_method != NULL && should_print(1)) {\n-    _printer->begin_method();\n+  if (_method != NULL && should_print_igv(1)) {\n+    _igv_printer->begin_method();\n@@ -4858,2 +4867,2 @@\n-  if (_method != NULL && should_print(1)) {\n-    _printer->end_method();\n+  if (_method != NULL && should_print_igv(1)) {\n+    _igv_printer->end_method();\n@@ -4864,1 +4873,1 @@\n-bool Compile::should_print(int level) {\n+bool Compile::should_print_igv(int level) {\n@@ -4871,3 +4880,3 @@\n-  if (need && _printer == nullptr) {\n-    _printer = IdealGraphPrinter::printer();\n-    _printer->set_compile(this);\n+  if (need && !_igv_printer) {\n+    _igv_printer = IdealGraphPrinter::printer();\n+    _igv_printer->set_compile(this);\n","filename":"src\/hotspot\/share\/opto\/compile.cpp","additions":39,"deletions":30,"binary":false,"changes":69,"status":"modified"},{"patch":"@@ -330,1 +330,0 @@\n-  bool                  _print_ideal;\n@@ -357,1 +356,1 @@\n-  IdealGraphPrinter*    _printer;\n+  IdealGraphPrinter*    _igv_printer;\n@@ -492,1 +491,1 @@\n-  IdealGraphPrinter* printer() { return _printer; }\n+  IdealGraphPrinter* igv_printer() { return _igv_printer; }\n@@ -639,1 +638,3 @@\n-  bool          print_ideal() const             { return _print_ideal; }\n+  void          print_ideal_ir(const char* phase_name);\n+  bool          should_print_ideal() const      { return _directive->PrintIdealOption; }\n+  bool          should_print_ideal(uint level) const { return _directive->PrintIdealLevelOption >= level; }\n@@ -655,1 +656,1 @@\n-  bool should_print(int level);\n+  bool should_print_igv(int level);\n","filename":"src\/hotspot\/share\/opto\/compile.hpp","additions":6,"deletions":5,"binary":false,"changes":11,"status":"modified"},{"patch":"@@ -765,1 +765,1 @@\n-  if (C->should_print(level)) {\n+  if (C->should_print_igv(level)) {\n","filename":"src\/hotspot\/share\/opto\/idealGraphPrinter.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -2755,2 +2755,2 @@\n-  if (C->should_print(1)) {\n-    IdealGraphPrinter* printer = C->printer();\n+  if (C->should_print_igv(1)) {\n+    IdealGraphPrinter* printer = C->igv_printer();\n","filename":"src\/hotspot\/share\/opto\/parse2.cpp","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"}]}