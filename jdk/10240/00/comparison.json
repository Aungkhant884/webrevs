{"files":[{"patch":"@@ -351,0 +351,6 @@\n+void Assembler::emit_arith_operand_imm32(int op1, Register rm, Address adr, int32_t imm32) {\n+  assert(op1 == 0x81, \"unexpected opcode\");\n+  emit_int8(op1);\n+  emit_operand(rm, adr, 4);\n+  emit_int32(imm32);\n+}\n@@ -594,1 +600,1 @@\n-                                    int rip_relative_correction) {\n+                                    int post_addr_length) {\n@@ -682,1 +688,1 @@\n-      address next_ip = pc() + sizeof(int32_t) + rip_relative_correction;\n+      address next_ip = pc() + sizeof(int32_t) + post_addr_length;\n@@ -705,1 +711,1 @@\n-                             int rip_relative_correction) {\n+                             int post_addr_length) {\n@@ -708,1 +714,1 @@\n-                      scale, disp, rspec, rip_relative_correction);\n+                      scale, disp, rspec, post_addr_length);\n@@ -713,1 +719,2 @@\n-                             RelocationHolder const& rspec) {\n+                             RelocationHolder const& rspec,\n+                             int post_addr_length) {\n@@ -717,1 +724,1 @@\n-                      scale, disp, rspec);\n+                      scale, disp, rspec, post_addr_length);\n@@ -722,1 +729,2 @@\n-                             RelocationHolder const& rspec) {\n+                             RelocationHolder const& rspec,\n+                             int post_addr_length) {\n@@ -726,1 +734,1 @@\n-                      scale, disp, rspec, \/* rip_relative_correction *\/ 0);\n+                      scale, disp, rspec, post_addr_length);\n@@ -730,1 +738,1 @@\n-                             int rip_relative_correction) {\n+                             int post_addr_length) {\n@@ -733,1 +741,1 @@\n-               rip_relative_correction);\n+               post_addr_length);\n@@ -739,1 +747,1 @@\n-                             int rip_relative_correction) {\n+                             int post_addr_length) {\n@@ -742,1 +750,1 @@\n-                      scale, disp, rspec, rip_relative_correction);\n+                      scale, disp, rspec, post_addr_length);\n@@ -1250,5 +1258,2 @@\n-void Assembler::emit_operand(Register reg, Address adr,\n-                             int rip_relative_correction) {\n-  emit_operand(reg, adr._base, adr._index, adr._scale, adr._disp,\n-               adr._rspec,\n-               rip_relative_correction);\n+void Assembler::emit_operand(Register reg, Address adr, int post_addr_length) {\n+  emit_operand(reg, adr._base, adr._index, adr._scale, adr._disp, adr._rspec, post_addr_length);\n@@ -1257,1 +1262,1 @@\n-void Assembler::emit_operand(XMMRegister reg, Address adr) {\n+void Assembler::emit_operand(XMMRegister reg, Address adr, int post_addr_length) {\n@@ -1259,1 +1264,1 @@\n-     emit_operand(reg, adr._base, adr._xmmindex, adr._scale, adr._disp, adr._rspec);\n+     emit_operand(reg, adr._base, adr._xmmindex, adr._scale, adr._disp, adr._rspec, post_addr_length);\n@@ -1261,2 +1266,1 @@\n-     emit_operand(reg, adr._base, adr._index, adr._scale, adr._disp,\n-     adr._rspec);\n+     emit_operand(reg, adr._base, adr._index, adr._scale, adr._disp, adr._rspec, post_addr_length);\n@@ -1278,1 +1282,1 @@\n-  emit_operand(src, dst);\n+  emit_operand(src, dst, 0);\n@@ -1290,1 +1294,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -1313,0 +1317,1 @@\n+  emit_int8(0x66);\n@@ -1330,1 +1335,1 @@\n-  emit_operand(src, dst);\n+  emit_operand(src, dst, 0);\n@@ -1342,1 +1347,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -1406,1 +1411,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -1423,1 +1428,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -1432,1 +1437,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -1457,1 +1462,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -1481,1 +1486,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -1505,1 +1510,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -1527,1 +1532,1 @@\n-  emit_operand(src, dst);\n+  emit_operand(src, dst, 0);\n@@ -1550,1 +1555,1 @@\n-  emit_operand(src, dst);\n+  emit_operand(src, dst, 0);\n@@ -1557,1 +1562,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -1578,1 +1583,1 @@\n-  emit_operand(dst, src2);\n+  emit_operand(dst, src2, 0);\n@@ -1613,1 +1618,1 @@\n-  emit_operand(rbx, src);\n+  emit_operand(rbx, src, 0);\n@@ -1630,1 +1635,1 @@\n-  emit_operand(rdx, src);\n+  emit_operand(rdx, src, 0);\n@@ -1646,1 +1651,1 @@\n-  emit_operand(rcx, src);\n+  emit_operand(rcx, src, 0);\n@@ -1681,1 +1686,1 @@\n-  emit_operand(rdx, adr);\n+  emit_operand(rdx, adr, 0);\n@@ -1719,1 +1724,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -1733,3 +1738,1 @@\n-  emit_int8((unsigned char)0x81);\n-  emit_operand(rdi, dst, 4);\n-  emit_int32(imm32);\n+  emit_arith_operand(0x81, as_Register(7), dst, imm32);\n@@ -1748,1 +1751,1 @@\n-void Assembler::cmpl(Register dst, Address  src) {\n+void Assembler::cmpl(Register dst, Address src) {\n@@ -1752,1 +1755,7 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n+}\n+\n+void Assembler::cmpl_imm32(Address dst, int32_t imm32) {\n+  InstructionMark im(this);\n+  prefix(dst);\n+  emit_arith_operand_imm32(0x81, as_Register(7), dst, imm32);\n@@ -1770,1 +1779,1 @@\n-  emit_operand(reg, adr);\n+  emit_operand(reg, adr, 0);\n@@ -1778,1 +1787,1 @@\n-  emit_operand(reg, adr);\n+  emit_operand(reg, adr, 0);\n@@ -1788,1 +1797,1 @@\n-  emit_operand(reg, adr);\n+  emit_operand(reg, adr, 0);\n@@ -1801,1 +1810,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -1819,1 +1828,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -1907,1 +1916,1 @@\n-  emit_operand(crc, adr);\n+  emit_operand(crc, adr, 0);\n@@ -1954,1 +1963,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -1971,1 +1980,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -1988,1 +1997,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -2012,1 +2021,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -2231,1 +2240,1 @@\n-  emit_operand(rcx, dst);\n+  emit_operand(rcx, dst, 0);\n@@ -2242,1 +2251,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -2260,1 +2269,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -2301,1 +2310,1 @@\n-    emit_operand(dst, src);\n+    emit_operand(dst, src, 1);\n@@ -2305,1 +2314,1 @@\n-    emit_operand(dst, src);\n+    emit_operand(dst, src, 4);\n@@ -2324,1 +2333,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -2333,1 +2342,1 @@\n-  emit_operand(rax, dst);\n+  emit_operand(rax, dst, 0);\n@@ -2393,1 +2402,1 @@\n-  emit_operand(rsp, adr);\n+  emit_operand(rsp, adr, 0);\n@@ -2464,1 +2473,1 @@\n-    emit_operand(as_Register(2), src);\n+    emit_operand(as_Register(2), src, 0);\n@@ -2470,1 +2479,1 @@\n-    emit_operand(as_Register(2), src);\n+    emit_operand(as_Register(2), src, 0);\n@@ -2478,1 +2487,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -2506,1 +2515,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -2554,1 +2563,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -2574,1 +2583,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -2585,1 +2594,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -2629,1 +2638,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -2638,1 +2647,1 @@\n-  emit_operand(src, dst);\n+  emit_operand(src, dst, 0);\n@@ -2675,1 +2684,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -2684,1 +2693,1 @@\n-  emit_operand(src, dst);\n+  emit_operand(src, dst, 0);\n@@ -2964,1 +2973,1 @@\n-  emit_operand(src, dst);\n+  emit_operand(src, dst, 0);\n@@ -2989,1 +2998,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -2999,1 +3008,1 @@\n-  emit_operand(src, dst);\n+  emit_operand(src, dst, 0);\n@@ -3016,1 +3025,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -3026,1 +3035,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -3044,1 +3053,1 @@\n-  emit_operand(src, dst);\n+  emit_operand(src, dst, 0);\n@@ -3062,1 +3071,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -3075,1 +3084,1 @@\n-  emit_operand(src, dst);\n+  emit_operand(src, dst, 0);\n@@ -3084,1 +3093,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -3093,1 +3102,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -3102,1 +3111,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -3111,1 +3120,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -3120,1 +3129,1 @@\n-  emit_operand(src, dst);\n+  emit_operand(src, dst, 0);\n@@ -3129,1 +3138,1 @@\n-  emit_operand(src, dst);\n+  emit_operand(src, dst, 0);\n@@ -3162,1 +3171,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -3183,1 +3192,1 @@\n-  emit_operand(src, dst);\n+  emit_operand(src, dst, 0);\n@@ -3203,1 +3212,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -3224,1 +3233,1 @@\n-  emit_operand(src, dst);\n+  emit_operand(src, dst, 0);\n@@ -3261,1 +3270,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -3282,1 +3291,1 @@\n-  emit_operand(src, dst);\n+  emit_operand(src, dst, 0);\n@@ -3287,1 +3296,0 @@\n-  if (dst->encoding() == src->encoding()) return;\n@@ -3320,1 +3328,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -3341,1 +3349,1 @@\n-  emit_operand(src, dst);\n+  emit_operand(src, dst, 0);\n@@ -3361,1 +3369,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -3376,1 +3384,1 @@\n-  emit_operand(src, dst);\n+  emit_operand(src, dst, 0);\n@@ -3390,1 +3398,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -3401,1 +3409,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -3412,1 +3420,1 @@\n-  emit_operand(src, dst);\n+  emit_operand(src, dst, 0);\n@@ -3442,1 +3450,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -3467,1 +3475,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -3479,1 +3487,1 @@\n-  emit_operand(src, dst);\n+  emit_operand(src, dst, 0);\n@@ -3496,1 +3504,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -3507,1 +3515,1 @@\n-  emit_operand(src, dst);\n+  emit_operand(src, dst, 0);\n@@ -3514,1 +3522,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -3529,1 +3537,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -3539,1 +3547,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -3549,1 +3557,1 @@\n-  emit_operand(src, dst);\n+  emit_operand(src, dst, 0);\n@@ -3559,1 +3567,1 @@\n-  emit_operand(src, dst);\n+  emit_operand(src, dst, 0);\n@@ -3577,1 +3585,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -3585,1 +3593,1 @@\n-  emit_operand(src, dst);\n+  emit_operand(src, dst, 0);\n@@ -3592,1 +3600,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -3605,1 +3613,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -3617,1 +3625,1 @@\n-  emit_operand(rsp, src);\n+  emit_operand(rsp, src, 0);\n@@ -3633,1 +3641,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -3651,1 +3659,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -3670,1 +3678,1 @@\n-  emit_operand(as_Register(3), dst);\n+  emit_operand(as_Register(3), dst, 0);\n@@ -4004,1 +4012,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -4016,1 +4024,1 @@\n-  emit_operand(src, dst);\n+  emit_operand(src, dst, 0);\n@@ -4031,1 +4039,1 @@\n-  emit_operand(src, dst);\n+  emit_operand(src, dst, 0);\n@@ -4070,1 +4078,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -4133,1 +4141,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -4161,1 +4169,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -4238,1 +4246,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 1);\n@@ -4292,1 +4300,1 @@\n-  emit_operand(as_Register(dst_enc), src);\n+  emit_operand(as_Register(dst_enc), src, 0);\n@@ -4306,1 +4314,1 @@\n-  emit_operand(as_Register(dst_enc), src);\n+  emit_operand(as_Register(dst_enc), src, 0);\n@@ -4326,1 +4334,1 @@\n-  emit_operand(as_Register(dst_enc), src);\n+  emit_operand(as_Register(dst_enc), src, 1);\n@@ -4339,1 +4347,1 @@\n-  emit_operand(as_Register(dst_enc), src);\n+  emit_operand(as_Register(dst_enc), src, 0);\n@@ -4352,1 +4360,1 @@\n-  emit_operand(as_Register(kdst->encoding()), src);\n+  emit_operand(as_Register(kdst->encoding()), src, 0);\n@@ -4390,1 +4398,1 @@\n-  emit_operand(as_Register(dst_enc), src);\n+  emit_operand(as_Register(dst_enc), src, 0);\n@@ -4432,1 +4440,1 @@\n-  emit_operand(as_Register(dst_enc), src);\n+  emit_operand(as_Register(dst_enc), src, 0);\n@@ -4489,1 +4497,1 @@\n-  emit_operand(as_Register(dst_enc), src);\n+  emit_operand(as_Register(dst_enc), src, 0);\n@@ -4542,1 +4550,1 @@\n-  emit_operand(src, dst);\n+  emit_operand(src, dst, 1);\n@@ -4559,1 +4567,1 @@\n-  emit_operand(src, dst);\n+  emit_operand(src, dst, 1);\n@@ -4576,1 +4584,1 @@\n-  emit_operand(src, dst);\n+  emit_operand(src, dst, 1);\n@@ -4593,1 +4601,1 @@\n-  emit_operand(src, dst);\n+  emit_operand(src, dst, 1);\n@@ -4610,1 +4618,1 @@\n-  emit_operand(dst,src);\n+  emit_operand(dst, src, 1);\n@@ -4634,1 +4642,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 1);\n@@ -4658,1 +4666,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 1);\n@@ -4675,1 +4683,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 1);\n@@ -4714,1 +4722,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -4774,1 +4782,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -4805,1 +4813,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -4896,1 +4904,1 @@\n-  emit_operand(src, dst);\n+  emit_operand(src, dst, 0);\n@@ -4910,1 +4918,1 @@\n-  emit_operand(src, dst);\n+  emit_operand(src, dst, 0);\n@@ -4922,1 +4930,1 @@\n-  emit_operand(src, dst);\n+  emit_operand(src, dst, 0);\n@@ -4989,1 +4997,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -5061,1 +5069,1 @@\n-  emit_operand(rax, dst);\n+  emit_operand(rax, dst, 0);\n@@ -5070,1 +5078,1 @@\n-  emit_operand(rax, src); \/\/ 0, src\n+  emit_operand(rax, src, 0); \/\/ 0, src\n@@ -5078,1 +5086,1 @@\n-  emit_operand(rax, src); \/\/ 0, src\n+  emit_operand(rax, src, 0); \/\/ 0, src\n@@ -5086,1 +5094,1 @@\n-  emit_operand(rcx, src); \/\/ 1, src\n+  emit_operand(rcx, src, 0); \/\/ 1, src\n@@ -5094,1 +5102,1 @@\n-  emit_operand(rdx, src); \/\/ 2, src\n+  emit_operand(rdx, src, 0); \/\/ 2, src\n@@ -5102,1 +5110,1 @@\n-  emit_operand(rbx, src); \/\/ 3, src\n+  emit_operand(rbx, src, 0); \/\/ 3, src\n@@ -5110,1 +5118,1 @@\n-  emit_operand(rcx, src); \/\/ 1, src\n+  emit_operand(rcx, src, 0); \/\/ 1, src\n@@ -5152,1 +5160,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -5183,1 +5191,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 1);\n@@ -5212,1 +5220,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 1);\n@@ -5296,1 +5304,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -5315,1 +5323,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -5349,1 +5357,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -5367,1 +5375,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -5407,1 +5415,1 @@\n-  emit_operand(rsi, src);\n+  emit_operand(rsi, src, 0);\n@@ -5567,1 +5575,1 @@\n-    emit_operand(as_Register(4), dst);\n+    emit_operand(as_Register(4), dst, 0);\n@@ -5571,1 +5579,1 @@\n-    emit_operand(as_Register(4), dst);\n+    emit_operand(as_Register(4), dst, 1);\n@@ -5580,1 +5588,1 @@\n-  emit_operand(as_Register(4), dst);\n+  emit_operand(as_Register(4), dst, 0);\n@@ -5604,1 +5612,1 @@\n-    emit_operand(as_Register(7), dst);\n+    emit_operand(as_Register(7), dst, 0);\n@@ -5608,1 +5616,1 @@\n-    emit_operand(as_Register(7), dst);\n+    emit_operand(as_Register(7), dst, 1);\n@@ -5617,1 +5625,1 @@\n-  emit_operand(as_Register(7), dst);\n+  emit_operand(as_Register(7), dst, 0);\n@@ -5651,1 +5659,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -5790,1 +5798,1 @@\n-  emit_operand(as_Register(5), dst);\n+  emit_operand(as_Register(5), dst, 0);\n@@ -5799,1 +5807,1 @@\n-    emit_operand(as_Register(5), dst);\n+    emit_operand(as_Register(5), dst, 0);\n@@ -5803,1 +5811,1 @@\n-    emit_operand(as_Register(5), dst);\n+    emit_operand(as_Register(5), dst, 1);\n@@ -5847,1 +5855,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 1);\n@@ -5867,1 +5875,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -5888,1 +5896,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -5898,1 +5906,1 @@\n-    emit_operand(as_Register(3), dst);\n+    emit_operand(as_Register(3), dst, 0);\n@@ -5904,1 +5912,1 @@\n-    emit_operand(as_Register(3), dst);\n+    emit_operand(as_Register(3), dst, 0);\n@@ -5918,1 +5926,1 @@\n-  emit_operand(src, dst);\n+  emit_operand(src, dst, 0);\n@@ -5936,1 +5944,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -5960,1 +5968,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -5977,1 +5985,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -6000,4 +6008,0 @@\n-  if (imm32 >= 0 && is8bit(imm32)) {\n-    testb(dst, imm32);\n-    return;\n-  }\n@@ -6005,0 +6009,1 @@\n+  prefix(dst);\n@@ -6006,1 +6011,1 @@\n-  emit_operand(as_Register(0), dst);\n+  emit_operand(as_Register(0), dst, 4);\n@@ -6011,4 +6016,0 @@\n-  if (imm32 >= 0 && is8bit(imm32) && dst->has_byte_register()) {\n-    testb(dst, imm32);\n-    return;\n-  }\n@@ -6038,1 +6039,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -6056,1 +6057,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -6072,1 +6073,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -6083,1 +6084,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -6101,1 +6102,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -6119,1 +6120,1 @@\n-  emit_operand(src, dst);\n+  emit_operand(src, dst, 0);\n@@ -6127,1 +6128,1 @@\n-  emit_operand(src, dst);\n+  emit_operand(src, dst, 0);\n@@ -6134,1 +6135,1 @@\n-  emit_operand(src, dst);\n+  emit_operand(src, dst, 0);\n@@ -6157,1 +6158,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -6165,1 +6166,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -6172,1 +6173,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -6203,1 +6204,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -6215,1 +6216,1 @@\n-  emit_operand(src, dst);\n+  emit_operand(src, dst, 0);\n@@ -6222,1 +6223,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -6229,1 +6230,1 @@\n-  emit_operand(src, dst);\n+  emit_operand(src, dst, 0);\n@@ -6247,1 +6248,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -6265,1 +6266,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -6283,1 +6284,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -6301,1 +6302,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -6333,1 +6334,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -6351,1 +6352,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -6369,1 +6370,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -6387,1 +6388,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -6417,1 +6418,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -6451,1 +6452,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -6461,1 +6462,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -6502,1 +6503,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -6512,1 +6513,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -6531,1 +6532,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -6564,1 +6565,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -6574,1 +6575,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -6598,1 +6599,1 @@\n-  emit_operand(dst, src2);\n+  emit_operand(dst, src2, 0);\n@@ -6608,1 +6609,1 @@\n-  emit_operand(dst, src2);\n+  emit_operand(dst, src2, 0);\n@@ -6649,1 +6650,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -6659,1 +6660,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -6675,1 +6676,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 1);\n@@ -6696,1 +6697,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 1);\n@@ -6716,1 +6717,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -6733,1 +6734,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -6758,1 +6759,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -6769,1 +6770,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -6795,1 +6796,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -6805,1 +6806,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -6848,1 +6849,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -6858,1 +6859,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -6884,1 +6885,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -6894,1 +6895,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -6941,1 +6942,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -7002,1 +7003,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -7012,1 +7013,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -7022,1 +7023,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -7033,1 +7034,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -7108,1 +7109,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -7118,1 +7119,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -7128,1 +7129,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -7139,1 +7140,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -7208,1 +7209,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -7218,1 +7219,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -7229,1 +7230,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -7704,1 +7705,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -7821,1 +7822,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -7858,1 +7859,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -7888,1 +7889,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -7924,1 +7925,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -7952,1 +7953,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -7967,1 +7968,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -7994,1 +7995,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -8021,1 +8022,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -8041,1 +8042,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -8163,1 +8164,1 @@\n-  emit_operand(dst, src3);\n+  emit_operand(dst, src3, 1);\n@@ -8278,1 +8279,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 1);\n@@ -8308,1 +8309,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 1);\n@@ -8351,1 +8352,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 1);\n@@ -8379,1 +8380,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 1);\n@@ -8409,1 +8410,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 1);\n@@ -8439,1 +8440,1 @@\n-  emit_operand(src, dst);\n+  emit_operand(src, dst, 1);\n@@ -8470,1 +8471,1 @@\n-  emit_operand(src, dst);\n+  emit_operand(src, dst, 1);\n@@ -8515,1 +8516,1 @@\n-  emit_operand(src, dst);\n+  emit_operand(src, dst, 1);\n@@ -8543,1 +8544,1 @@\n-  emit_operand(src, dst);\n+  emit_operand(src, dst, 1);\n@@ -8574,1 +8575,1 @@\n-  emit_operand(src, dst);\n+  emit_operand(src, dst, 1);\n@@ -8619,1 +8620,1 @@\n-  emit_operand(src, dst);\n+  emit_operand(src, dst, 1);\n@@ -8642,1 +8643,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -8662,1 +8663,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -8725,1 +8726,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -8752,1 +8753,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -8781,1 +8782,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -8810,1 +8811,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -8839,1 +8840,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -8868,1 +8869,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -8895,1 +8896,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -8922,1 +8923,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -8951,1 +8952,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -8980,1 +8981,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -9009,1 +9010,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -9038,1 +9039,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -9065,1 +9066,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -9094,1 +9095,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -9121,1 +9122,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -9150,1 +9151,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -9179,1 +9180,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -9208,1 +9209,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -9237,1 +9238,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -9267,1 +9268,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -9296,1 +9297,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -9325,1 +9326,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -9354,1 +9355,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -9385,1 +9386,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -9416,1 +9417,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -9445,1 +9446,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -9474,1 +9475,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -9500,1 +9501,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -9526,1 +9527,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -9552,1 +9553,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -9578,1 +9579,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -9946,1 +9947,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -9972,1 +9973,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -10000,1 +10001,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -10028,1 +10029,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -10055,1 +10056,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -10081,1 +10082,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -10109,1 +10110,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -10137,1 +10138,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -10167,1 +10168,1 @@\n-  emit_operand(dst, src3);\n+  emit_operand(dst, src3, 1);\n@@ -10198,1 +10199,1 @@\n-  emit_operand(dst, src3);\n+  emit_operand(dst, src3, 1);\n@@ -10235,1 +10236,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -10257,1 +10258,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -10271,1 +10272,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -10294,1 +10295,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -10316,1 +10317,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -10340,1 +10341,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -10353,1 +10354,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -10404,1 +10405,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -10417,1 +10418,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -10430,1 +10431,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -10443,1 +10444,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -10460,1 +10461,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -10478,1 +10479,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -10496,1 +10497,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -10514,1 +10515,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -10528,1 +10529,1 @@\n-  emit_operand(src, dst);\n+  emit_operand(src, dst, 0);\n@@ -10542,1 +10543,1 @@\n-  emit_operand(src, dst);\n+  emit_operand(src, dst, 0);\n@@ -10556,1 +10557,1 @@\n-  emit_operand(src, dst);\n+  emit_operand(src, dst, 0);\n@@ -10570,1 +10571,1 @@\n-  emit_operand(src, dst);\n+  emit_operand(src, dst, 0);\n@@ -10627,1 +10628,1 @@\n-  emit_operand32(rbp, adr);\n+  emit_operand32(rbp, adr, 0);\n@@ -10633,1 +10634,1 @@\n-  emit_operand32(rdi, adr);\n+  emit_operand32(rdi, adr, 0);\n@@ -10636,1 +10637,1 @@\n-void Assembler::emit_operand32(Register reg, Address adr) {\n+void Assembler::emit_operand32(Register reg, Address adr, int post_addr_length) {\n@@ -10639,2 +10640,1 @@\n-  emit_operand(reg, adr._base, adr._index, adr._scale, adr._disp,\n-               adr._rspec);\n+  emit_operand(reg, adr._base, adr._index, adr._scale, adr._disp, adr._rspec, post_addr_length);\n@@ -10666,1 +10666,1 @@\n-  emit_operand(rdi, src1);\n+  emit_operand(rdi, src1, 4);\n@@ -10676,1 +10676,1 @@\n-  emit_operand(rcx, adr);\n+  emit_operand(rcx, adr, 0);\n@@ -10703,1 +10703,1 @@\n-  emit_operand32(rax, src);\n+  emit_operand32(rax, src, 0);\n@@ -10709,1 +10709,1 @@\n-  emit_operand32(rax, src);\n+  emit_operand32(rax, src, 0);\n@@ -10735,1 +10735,1 @@\n-  emit_operand32(rbx, src);\n+  emit_operand32(rbx, src, 0);\n@@ -10741,1 +10741,1 @@\n-  emit_operand32(rbx, src);\n+  emit_operand32(rbx, src, 0);\n@@ -10763,1 +10763,1 @@\n-  emit_operand32(rsi, src);\n+  emit_operand32(rsi, src, 0);\n@@ -10769,1 +10769,1 @@\n-  emit_operand32(rsi, src);\n+  emit_operand32(rsi, src, 0);\n@@ -10790,1 +10790,1 @@\n-  emit_operand32(rdi, src);\n+  emit_operand32(rdi, src, 0);\n@@ -10796,1 +10796,1 @@\n-  emit_operand32(rdi, src);\n+  emit_operand32(rdi, src, 0);\n@@ -10814,1 +10814,1 @@\n-  emit_operand32(rbp, adr);\n+  emit_operand32(rbp, adr, 0);\n@@ -10820,1 +10820,1 @@\n-  emit_operand32(rax, adr);\n+  emit_operand32(rax, adr, 0);\n@@ -10834,1 +10834,1 @@\n-  emit_operand32(rdx, adr);\n+  emit_operand32(rdx, adr, 0);\n@@ -10840,1 +10840,1 @@\n-  emit_operand32(rdi, adr);\n+  emit_operand32(rdi, adr, 0);\n@@ -10846,1 +10846,1 @@\n-  emit_operand32(rbx, adr);\n+  emit_operand32(rbx, adr, 0);\n@@ -10856,1 +10856,1 @@\n-  emit_operand32(rax, adr);\n+  emit_operand32(rax, adr, 0);\n@@ -10862,1 +10862,1 @@\n-  emit_operand32(rax, adr);\n+  emit_operand32(rax, adr, 0);\n@@ -10873,1 +10873,1 @@\n-  emit_operand32(rbp, src);\n+  emit_operand32(rbp, src, 0);\n@@ -10879,1 +10879,1 @@\n-  emit_operand32(rsp, src);\n+  emit_operand32(rsp, src, 0);\n@@ -10913,1 +10913,1 @@\n-  emit_operand32(rcx, src);\n+  emit_operand32(rcx, src, 0);\n@@ -10919,1 +10919,1 @@\n-  emit_operand32(rcx, src);\n+  emit_operand32(rcx, src, 0);\n@@ -10933,1 +10933,1 @@\n-  emit_operand32(rsi, dst);\n+  emit_operand32(rsi, dst, 0);\n@@ -10939,1 +10939,1 @@\n-  emit_operand32(rdi, src);\n+  emit_operand32(rdi, src, 0);\n@@ -10957,1 +10957,1 @@\n-  emit_operand32(rsp, src);\n+  emit_operand32(rsp, src, 0);\n@@ -10971,1 +10971,1 @@\n-  emit_operand32(rdx, adr);\n+  emit_operand32(rdx, adr, 0);\n@@ -10977,1 +10977,1 @@\n-  emit_operand32(rdx, adr);\n+  emit_operand32(rdx, adr, 0);\n@@ -10983,1 +10983,1 @@\n-  emit_operand32(rbx, adr);\n+  emit_operand32(rbx, adr, 0);\n@@ -10993,1 +10993,1 @@\n-  emit_operand32(rbx, adr);\n+  emit_operand32(rbx, adr, 0);\n@@ -11003,1 +11003,1 @@\n-  emit_operand32(rsp, src);\n+  emit_operand32(rsp, src, 0);\n@@ -11009,1 +11009,1 @@\n-  emit_operand32(rsp, src);\n+  emit_operand32(rsp, src, 0);\n@@ -11027,1 +11027,1 @@\n-  emit_operand32(rbp, src);\n+  emit_operand32(rbp, src, 0);\n@@ -11033,1 +11033,1 @@\n-  emit_operand32(rbp, src);\n+  emit_operand32(rbp, src, 0);\n@@ -11523,1 +11523,1 @@\n-  emit_operand(as_Register(dst_enc), src);\n+  emit_operand(as_Register(dst_enc), src, 1);\n@@ -11556,1 +11556,1 @@\n-  emit_operand(as_Register(dst_enc), src);\n+  emit_operand(as_Register(dst_enc), src, 1);\n@@ -11591,1 +11591,1 @@\n-  emit_operand(as_Register(dst_enc), src);\n+  emit_operand(as_Register(dst_enc), src, 1);\n@@ -11626,1 +11626,1 @@\n-  emit_operand(as_Register(dst_enc), src);\n+  emit_operand(as_Register(dst_enc), src, 1);\n@@ -11855,1 +11855,1 @@\n-  emit_operand(dst, src2);\n+  emit_operand(dst, src2, 0);\n@@ -11864,1 +11864,1 @@\n-  emit_operand(dst, src2);\n+  emit_operand(dst, src2, 0);\n@@ -11873,1 +11873,1 @@\n-  emit_operand(dst, src2);\n+  emit_operand(dst, src2, 0);\n@@ -11882,1 +11882,1 @@\n-  emit_operand(dst, src2);\n+  emit_operand(dst, src2, 0);\n@@ -11898,1 +11898,1 @@\n-  emit_operand(dst, src1);\n+  emit_operand(dst, src1, 0);\n@@ -11914,1 +11914,1 @@\n-  emit_operand(dst, src1);\n+  emit_operand(dst, src1, 0);\n@@ -11930,1 +11930,1 @@\n-  emit_operand(dst, src1);\n+  emit_operand(dst, src1, 0);\n@@ -11946,1 +11946,1 @@\n-  emit_operand(dst, src1);\n+  emit_operand(dst, src1, 0);\n@@ -11962,1 +11962,1 @@\n-  emit_operand(dst, src1);\n+  emit_operand(dst, src1, 0);\n@@ -11978,1 +11978,1 @@\n-  emit_operand(dst, src1);\n+  emit_operand(dst, src1, 0);\n@@ -12137,1 +12137,1 @@\n-  emit_operand(rax, dst);\n+  emit_operand(rax, dst, 4);\n@@ -12557,1 +12557,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -12574,1 +12574,1 @@\n-  emit_operand(src, dst);\n+  emit_operand(src, dst, 0);\n@@ -12585,1 +12585,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -12627,1 +12627,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -12638,1 +12638,1 @@\n-  emit_operand(src, dst);\n+  emit_operand(src, dst, 0);\n@@ -12654,1 +12654,1 @@\n-  emit_operand(dst, src2);\n+  emit_operand(dst, src2, 0);\n@@ -12685,1 +12685,1 @@\n-  emit_operand(rbx, src);\n+  emit_operand(rbx, src, 0);\n@@ -12701,1 +12701,1 @@\n-  emit_operand(rdx, src);\n+  emit_operand(rdx, src, 0);\n@@ -12717,1 +12717,1 @@\n-  emit_operand(rcx, src);\n+  emit_operand(rcx, src, 0);\n@@ -12728,1 +12728,1 @@\n-  emit_operand(rdi, adr);\n+  emit_operand(rdi, adr, 0);\n@@ -12743,1 +12743,1 @@\n-  emit_operand(rdi, adr);\n+  emit_operand(rdi, adr, 0);\n@@ -12758,1 +12758,1 @@\n-  emit_operand(rsi, adr);\n+  emit_operand(rsi, adr, 0);\n@@ -12769,1 +12769,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -12774,3 +12774,2 @@\n-  emit_int16(get_prefixq(dst), (unsigned char)0x81);\n-  emit_operand(rdi, dst, 4);\n-  emit_int32(imm32);\n+  prefixq(dst);\n+  emit_arith_operand(0x81, as_Register(7), dst, imm32);\n@@ -12787,1 +12786,1 @@\n-  emit_operand(src, dst);\n+  emit_operand(src, dst, 0);\n@@ -12798,1 +12797,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -12804,1 +12803,1 @@\n-  emit_operand(reg, adr);\n+  emit_operand(reg, adr, 0);\n@@ -12821,1 +12820,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -12831,1 +12830,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -12840,1 +12839,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -12882,1 +12881,1 @@\n-  emit_operand(rcx, dst);\n+  emit_operand(rcx, dst, 0);\n@@ -12887,1 +12886,1 @@\n-  emit_operand(as_Register(1), src);\n+  emit_operand(as_Register(1), src, 0);\n@@ -12892,1 +12891,1 @@\n-  emit_operand(as_Register(5), src);\n+  emit_operand(as_Register(5), src, 0);\n@@ -12897,1 +12896,1 @@\n-  emit_operand(as_Register(0), dst);\n+  emit_operand(as_Register(0), dst, 0);\n@@ -12902,1 +12901,1 @@\n-  emit_operand(as_Register(4), dst);\n+  emit_operand(as_Register(4), dst, 0);\n@@ -12930,1 +12929,1 @@\n-    emit_operand(dst, src);\n+    emit_operand(dst, src, 1);\n@@ -12934,1 +12933,1 @@\n-    emit_operand(dst, src);\n+    emit_operand(dst, src, 4);\n@@ -12952,1 +12951,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -12973,1 +12972,1 @@\n-  emit_operand(rax, dst);\n+  emit_operand(rax, dst, 0);\n@@ -12983,1 +12982,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -13050,1 +13049,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -13080,1 +13079,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -13086,1 +13085,1 @@\n-  emit_operand(src, dst);\n+  emit_operand(src, dst, 0);\n@@ -13092,1 +13091,1 @@\n-  emit_operand(as_Register(0), dst);\n+  emit_operand(as_Register(0), dst, 4);\n@@ -13107,1 +13106,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -13137,1 +13136,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -13150,1 +13149,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -13163,1 +13162,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -13176,1 +13175,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -13187,1 +13186,1 @@\n-  emit_operand(rsp, src);\n+  emit_operand(rsp, src, 0);\n@@ -13210,1 +13209,1 @@\n-  emit_operand(as_Register(3), dst);\n+  emit_operand(as_Register(3), dst, 0);\n@@ -13247,1 +13246,1 @@\n-  emit_operand(src, dst);\n+  emit_operand(src, dst, 0);\n@@ -13258,1 +13257,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -13273,1 +13272,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -13286,1 +13285,1 @@\n-  emit_operand(rax, dst);\n+  emit_operand(rax, dst, 0);\n@@ -13424,1 +13423,1 @@\n-  emit_operand(rsi, src);\n+  emit_operand(rsi, src, 0);\n@@ -13460,1 +13459,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 1);\n@@ -13477,1 +13476,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 1);\n@@ -13487,1 +13486,1 @@\n-    emit_operand(as_Register(4), dst);\n+    emit_operand(as_Register(4), dst, 0);\n@@ -13491,1 +13490,1 @@\n-    emit_operand(as_Register(4), dst);\n+    emit_operand(as_Register(4), dst, 1);\n@@ -13499,1 +13498,1 @@\n-  emit_operand(as_Register(4), dst);\n+  emit_operand(as_Register(4), dst, 0);\n@@ -13522,1 +13521,1 @@\n-    emit_operand(as_Register(7), dst);\n+    emit_operand(as_Register(7), dst, 0);\n@@ -13526,1 +13525,1 @@\n-    emit_operand(as_Register(7), dst);\n+    emit_operand(as_Register(7), dst, 1);\n@@ -13534,1 +13533,1 @@\n-  emit_operand(as_Register(7), dst);\n+  emit_operand(as_Register(7), dst, 0);\n@@ -13567,1 +13566,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -13609,1 +13608,1 @@\n-  emit_operand(as_Register(5), dst);\n+  emit_operand(as_Register(5), dst, 0);\n@@ -13617,1 +13616,1 @@\n-    emit_operand(as_Register(5), dst);\n+    emit_operand(as_Register(5), dst, 0);\n@@ -13621,1 +13620,1 @@\n-    emit_operand(as_Register(5), dst);\n+    emit_operand(as_Register(5), dst, 1);\n@@ -13635,1 +13634,1 @@\n-  emit_operand(src, dst);\n+  emit_operand(src, dst, 0);\n@@ -13652,1 +13651,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -13661,4 +13660,0 @@\n-  if (imm32 >= 0) {\n-    testl(dst, imm32);\n-    return;\n-  }\n@@ -13667,1 +13662,1 @@\n-  emit_operand(as_Register(0), dst);\n+  emit_operand(as_Register(0), dst, 4);\n@@ -13672,4 +13667,0 @@\n-  if (imm32 >= 0) {\n-    testl(dst, imm32);\n-    return;\n-  }\n@@ -13699,1 +13690,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -13705,1 +13696,1 @@\n-  emit_operand(src, dst);\n+  emit_operand(src, dst, 0);\n@@ -13711,1 +13702,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -13727,1 +13718,1 @@\n-  emit_operand(dst, src);\n+  emit_operand(dst, src, 0);\n@@ -13744,1 +13735,1 @@\n-  emit_operand(src, dst);\n+  emit_operand(src, dst, 0);\n","filename":"src\/hotspot\/cpu\/x86\/assembler_x86.cpp","additions":455,"deletions":464,"binary":false,"changes":919,"status":"modified"},{"patch":"@@ -758,1 +758,1 @@\n-                           int rip_relative_correction = 0);\n+                           int post_addr_length);\n@@ -764,1 +764,1 @@\n-                    int rip_relative_correction = 0);\n+                    int post_addr_length);\n@@ -769,1 +769,2 @@\n-                    RelocationHolder const& rspec);\n+                    RelocationHolder const& rspec,\n+                    int post_addr_length);\n@@ -774,1 +775,2 @@\n-                    RelocationHolder const& rspec);\n+                    RelocationHolder const& rspec,\n+                    int post_addr_length);\n@@ -777,1 +779,1 @@\n-                    int rip_relative_correction = 0);\n+                    int post_addr_length);\n@@ -782,1 +784,2 @@\n-                    RelocationHolder const& rspec);\n+                    RelocationHolder const& rspec,\n+                    int post_addr_length);\n@@ -788,1 +791,1 @@\n-                           int rip_relative_correction = 0);\n+                           int post_addr_length);\n@@ -791,1 +794,1 @@\n-                    int rip_relative_correction = 0);\n+                    int post_addr_length);\n@@ -797,1 +800,1 @@\n-                    int rip_relative_correction = 0);\n+                    int post_addr_length);\n@@ -799,1 +802,1 @@\n-  void emit_operand(XMMRegister reg, Address adr);\n+  void emit_operand(XMMRegister reg, Address adr, int post_addr_length);\n@@ -803,0 +806,1 @@\n+  void emit_arith_operand_imm32(int op1, Register rm, Address adr, int32_t imm32);\n@@ -1102,0 +1106,1 @@\n+  void cmpl_imm32(Address dst, int32_t imm32);\n@@ -1369,1 +1374,1 @@\n-  void emit_operand32(Register reg, Address adr);\n+  void emit_operand32(Register reg, Address adr, int post_addr_length);\n","filename":"src\/hotspot\/cpu\/x86\/assembler_x86.hpp","additions":16,"deletions":11,"binary":false,"changes":27,"status":"modified"},{"patch":"@@ -288,1 +288,1 @@\n-  __ cmpl(disarmed_addr, 0);\n+  __ cmpl_imm32(disarmed_addr, 0);\n@@ -316,1 +316,1 @@\n-  __ cmpl(disarmed_addr, 0);\n+  __ cmpl_imm32(disarmed_addr, 0);\n","filename":"src\/hotspot\/cpu\/x86\/gc\/shared\/barrierSetAssembler_x86.cpp","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -3128,0 +3128,16 @@\n+void MacroAssembler::testl(Address dst, int32_t imm32) {\n+  if (imm32 >= 0 && is8bit(imm32)) {\n+    testb(dst, imm32);\n+  } else {\n+    Assembler::testl(dst, imm32);\n+  }\n+}\n+\n+void MacroAssembler::testl(Register dst, int32_t imm32) {\n+  if (imm32 >= 0 && is8bit(imm32) && dst->has_byte_register()) {\n+    testb(dst, imm32);\n+  } else {\n+    Assembler::testl(dst, imm32);\n+  }\n+}\n+\n@@ -3129,1 +3145,1 @@\n-  assert(reachable(src), \"Address should be reachable\");\n+  assert(always_reachable(src), \"Address should be reachable\");\n@@ -3133,0 +3149,20 @@\n+#ifdef _LP64\n+\n+void MacroAssembler::testq(Address dst, int32_t imm32) {\n+  if (imm32 >= 0) {\n+    testl(dst, imm32);\n+  } else {\n+    Assembler::testq(dst, imm32);\n+  }\n+}\n+\n+void MacroAssembler::testq(Register dst, int32_t imm32) {\n+  if (imm32 >= 0) {\n+    testl(dst, imm32);\n+  } else {\n+    Assembler::testq(dst, imm32);\n+  }\n+}\n+\n+#endif\n+\n","filename":"src\/hotspot\/cpu\/x86\/macroAssembler_x86.cpp","additions":37,"deletions":1,"binary":false,"changes":38,"status":"modified"},{"patch":"@@ -834,0 +834,2 @@\n+  void testl(Address dst, int32_t imm32);\n+  void testl(Register dst, int32_t imm32);\n@@ -835,0 +837,3 @@\n+  using Assembler::testq;\n+  void testq(Address dst, int32_t imm32);\n+  void testq(Register dst, int32_t imm32);\n","filename":"src\/hotspot\/cpu\/x86\/macroAssembler_x86.hpp","additions":5,"deletions":0,"binary":false,"changes":5,"status":"modified"}]}