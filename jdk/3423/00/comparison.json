{"files":[{"patch":"@@ -194,7 +194,2 @@\n-  if (ShenandoahStringDedup::is_enabled()) {\n-    ShenandoahMarkRefsDedupClosure cl(q, _rp);\n-    _root_scanner.roots_do(&cl, worker_id);\n-  } else {\n-    ShenandoahMarkRefsClosure cl(q, _rp);\n-    _root_scanner.roots_do(&cl, worker_id);\n-  }\n+  ShenandoahMarkRefsClosure cl(q, _rp);\n+  _root_scanner.roots_do(&cl, worker_id);\n","filename":"src\/hotspot\/share\/gc\/shenandoah\/shenandoahConcurrentMark.cpp","additions":2,"deletions":7,"binary":false,"changes":9,"status":"modified"},{"patch":"@@ -44,0 +44,5 @@\n+ShenandoahInitMarkRootsClosure::ShenandoahInitMarkRootsClosure(ShenandoahObjToScanQueue* q) :\n+  _queue(q),\n+  _mark_context(ShenandoahHeap::heap()->marking_context()) {\n+}\n+\n","filename":"src\/hotspot\/share\/gc\/shenandoah\/shenandoahMark.cpp","additions":5,"deletions":0,"binary":false,"changes":5,"status":"modified"},{"patch":"@@ -34,0 +34,15 @@\n+class ShenandoahInitMarkRootsClosure : public OopClosure {\n+private:\n+  ShenandoahObjToScanQueue* const _queue;\n+  ShenandoahMarkingContext* const _mark_context;\n+\n+  template <class T>\n+  inline void do_oop_work(T* p);\n+\n+public:\n+  ShenandoahInitMarkRootsClosure(ShenandoahObjToScanQueue* q);\n+\n+  void do_oop(narrowOop* p) { do_oop_work(p); }\n+  void do_oop(oop* p)       { do_oop_work(p); }\n+};\n+\n","filename":"src\/hotspot\/share\/gc\/shenandoah\/shenandoahMark.hpp","additions":15,"deletions":0,"binary":false,"changes":15,"status":"modified"},{"patch":"@@ -42,0 +42,5 @@\n+template <class T>\n+void ShenandoahInitMarkRootsClosure::do_oop_work(T* p) {\n+  ShenandoahMark::mark_through_ref<T, NO_DEDUP>(p, _queue, _mark_context, false);\n+}\n+\n","filename":"src\/hotspot\/share\/gc\/shenandoah\/shenandoahMark.inline.hpp","additions":5,"deletions":0,"binary":false,"changes":5,"status":"modified"},{"patch":"@@ -36,1 +36,0 @@\n-#include \"gc\/shenandoah\/shenandoahStringDedup.hpp\"\n@@ -40,28 +39,0 @@\n-template <StringDedupMode STRING_DEDUP>\n-class ShenandoahInitMarkRootsClosure : public OopClosure {\n-private:\n-  ShenandoahObjToScanQueue* const _queue;\n-  ShenandoahMarkingContext* const _mark_context;\n-\n-  template <class T>\n-  inline void do_oop_work(T* p);\n-\n-public:\n-  ShenandoahInitMarkRootsClosure(ShenandoahObjToScanQueue* q);\n-\n-  void do_oop(narrowOop* p) { do_oop_work(p); }\n-  void do_oop(oop* p)       { do_oop_work(p); }\n-};\n-\n-template <StringDedupMode STRING_DEDUP>\n-ShenandoahInitMarkRootsClosure<STRING_DEDUP>::ShenandoahInitMarkRootsClosure(ShenandoahObjToScanQueue* q) :\n-  _queue(q),\n-  _mark_context(ShenandoahHeap::heap()->marking_context()) {\n-}\n-\n-template <StringDedupMode STRING_DEDUP>\n-template <class T>\n-void ShenandoahInitMarkRootsClosure<STRING_DEDUP>::do_oop_work(T* p) {\n-  ShenandoahMark::mark_through_ref<T, STRING_DEDUP>(p, _queue, _mark_context, false);\n-}\n-\n@@ -131,7 +102,2 @@\n-  if (ShenandoahStringDedup::is_enabled()) {\n-    ShenandoahInitMarkRootsClosure<ENQUEUE_DEDUP> init_mark(task_queues()->queue(worker_id));\n-    _root_scanner.roots_do(&init_mark, worker_id);\n-  } else {\n-    ShenandoahInitMarkRootsClosure<NO_DEDUP> init_mark(task_queues()->queue(worker_id));\n-    _root_scanner.roots_do(&init_mark, worker_id);\n-  }\n+  ShenandoahInitMarkRootsClosure  init_mark(task_queues()->queue(worker_id));\n+  _root_scanner.roots_do(&init_mark, worker_id);\n@@ -149,0 +115,1 @@\n+\n","filename":"src\/hotspot\/share\/gc\/shenandoah\/shenandoahSTWMark.cpp","additions":3,"deletions":36,"binary":false,"changes":39,"status":"modified"}]}