{"files":[{"patch":"@@ -704,0 +704,8 @@\n+  $1_SANITIZER_DEFAULT_OPTIONS_PREFIX := $(TOPDIR)\/make\/src\/native\/\n+\n+  ifneq ($$(filter %.cpp %.cc, $$($1_SRCS)), )\n+    $1_SANITIZER_DEFAULT_OPTIONS_SUFFIX := .cpp\n+  else\n+    $1_SANITIZER_DEFAULT_OPTIONS_SUFFIX := .c\n+  endif\n+\n@@ -706,1 +714,1 @@\n-      $1_SRCS += $(TOPDIR)\/make\/src\/native\/__ubsan_default_options.cpp\n+      $1_SRCS += $$($1_SANITIZER_DEFAULT_OPTIONS_PREFIX)__ubsan_default_options$$($1_SANITIZER_DEFAULT_OPTIONS_SUFFIX)\n","filename":"make\/common\/NativeCompilation.gmk","additions":9,"deletions":1,"binary":false,"changes":10,"status":"modified"},{"patch":"@@ -26,4 +26,0 @@\n-#ifdef __cplusplus\n-extern \"C\" {\n-#endif\n-\n@@ -39,4 +35,0 @@\n-\n-#ifdef __cplusplus\n-}  \/\/ extern \"C\"\n-#endif\n","filename":"make\/src\/native\/__ubsan_default_options.c","additions":0,"deletions":8,"binary":false,"changes":8,"previous_filename":"make\/src\/native\/__ubsan_default_options.cpp","status":"copied"},{"patch":"@@ -26,1 +26,0 @@\n-#ifdef __cplusplus\n@@ -28,1 +27,0 @@\n-#endif\n@@ -30,9 +28,1 @@\n-\/\/ Override weak symbol exposed by UBSan to override default options. This is called by UBSan\n-\/\/ extremely early during library loading, before main is called. We need to override the default\n-\/\/ options because by default UBSan only prints a warning for each occurrence. We want jtreg tests\n-\/\/ to fail when undefined behavior is encountered. We also want a full stack trace for the offending\n-\/\/ thread so it is easier to track down. You can override these options by setting the environment\n-\/\/ variable UBSAN_OPTIONS.\n-__attribute__((visibility(\"default\"))) const char* __ubsan_default_options() {\n-  return \"halt_on_error=1,print_stacktrace=1\";\n-}\n+#include \".\/__ubsan_default_options.c\"\n@@ -40,3 +30,1 @@\n-#ifdef __cplusplus\n-}  \/\/ extern \"C\"\n-#endif\n+}\n","filename":"make\/src\/native\/__ubsan_default_options.cpp","additions":2,"deletions":14,"binary":false,"changes":16,"status":"modified"}]}