{"files":[{"patch":"@@ -50,0 +50,2 @@\n+import java.text.ParseException;\n+import java.text.SimpleDateFormat;\n@@ -4900,1 +4902,1 @@\n-            CertPathConstraintsParameters cpcp) {\n+            CertPathConstraintsParameters cpcp) throws Exception {\n@@ -4914,6 +4916,14 @@\n-                    String separator = \"java.security: \";\n-                    int sepPos = eMessage.indexOf(separator);\n-                    String denyAfterDate = \"0000-00-00\";\n-                    if (sepPos > 0) {\n-                        denyAfterDate = eMessage.substring(sepPos + separator.length(),\n-                                sepPos + separator.length() + denyAfterDate.length());\n+                    String startSeparator = \"Constraint date: \";\n+                    int startSepPos = eMessage.indexOf(startSeparator);\n+                    String endSeparator = \"; params date\";\n+                    int endSepPos = eMessage.indexOf(endSeparator);\n+                    String denyAfterDate = eMessage.substring(startSepPos + startSeparator.length(),\n+                            endSepPos);\n+\n+                    SimpleDateFormat formatter = new SimpleDateFormat(\"EEE MMM dd HH:mm:ss Z yyyy\");\n+                    Date dateObj = null;\n+                    try {\n+                        dateObj = formatter.parse(denyAfterDate);\n+                    } catch (ParseException e1) {\n+                        throw new Exception(rb.getString(\n+                                \"Unable.to.parse.denyAfter.string.in.exception.message\"));\n@@ -4921,0 +4931,2 @@\n+                    formatter = new SimpleDateFormat(\"yyyy-MM-dd\");\n+                    denyAfterDate = formatter.format(dateObj);\n@@ -5010,1 +5022,1 @@\n-            throws KeyStoreException {\n+            throws KeyStoreException, Exception {\n@@ -5020,1 +5032,1 @@\n-            CertPathConstraintsParameters cpcp) {\n+            CertPathConstraintsParameters cpcp) throws Exception {\n@@ -5026,1 +5038,1 @@\n-            CertPathConstraintsParameters cpcp) {\n+            CertPathConstraintsParameters cpcp) throws Exception {\n","filename":"src\/java.base\/share\/classes\/sun\/security\/tools\/keytool\/Main.java","additions":22,"deletions":10,"binary":false,"changes":32,"status":"modified"},{"patch":"@@ -487,0 +487,1 @@\n+        {\"Unable.to.parse.denyAfter.string.in.exception.message\", \"Unable to parse denyAfter date string in exception message\"},\n","filename":"src\/java.base\/share\/classes\/sun\/security\/tools\/keytool\/Resources.java","additions":1,"deletions":0,"binary":false,"changes":1,"status":"modified"},{"patch":"@@ -48,1 +48,1 @@\n-                .shouldMatch(\"cannot be used to sign JARs after 2019-01-01\")\n+                .shouldMatch(\"cannot be used to sign JARs after 2018-12-31\")\n@@ -58,1 +58,1 @@\n-                .shouldMatch(\"cannot be used to sign JARs after 2019-01-01\")\n+                .shouldMatch(\"cannot be used to sign JARs after 2018-12-31\")\n","filename":"test\/jdk\/sun\/security\/tools\/keytool\/TestSha1Usage.java","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"}]}