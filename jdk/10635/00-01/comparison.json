{"files":[{"patch":"@@ -31,1 +31,1 @@\n- * @run main\/manual\/othervm i18n en\n+ * @run main\/manual\/othervm -Duser.language=en i18n\n@@ -41,1 +41,1 @@\n- * @run main\/manual\/othervm i18n de\n+ * @run main\/manual\/othervm -Duser.language=de i18n\n@@ -51,1 +51,1 @@\n- * @run main\/manual\/othervm i18n ja\n+ * @run main\/manual\/othervm -Duser.language=ja i18n\n@@ -61,1 +61,1 @@\n- * @run main\/manual\/othervm i18n zh CN\n+ * @run main\/manual\/othervm -Duser.language=zh -Duser.country=CN i18n\n@@ -64,0 +64,2 @@\n+import jdk.test.lib.TestUI;\n+\n@@ -65,3 +67,0 @@\n-import java.awt.event.ActionListener;\n-import java.awt.event.WindowAdapter;\n-import java.awt.event.WindowEvent;\n@@ -250,75 +249,0 @@\n-    public static class DialogBuilder {\n-        private JDialog dialog;\n-        private JTextArea instructionsText;\n-        private JTextArea messageText;\n-        private JButton pass;\n-        private JButton fail;\n-\n-        public DialogBuilder() {\n-            dialog = new JDialog(new JFrame());\n-            dialog.setDefaultCloseOperation(JDialog.DO_NOTHING_ON_CLOSE);\n-            instructionsText = new JTextArea(\"\", 5, 100);\n-\n-            dialog.add(\"North\", new JScrollPane(instructionsText,\n-                    JScrollPane.VERTICAL_SCROLLBAR_ALWAYS,\n-                    JScrollPane.HORIZONTAL_SCROLLBAR_ALWAYS));\n-\n-            messageText = new JTextArea(\"\", 20, 100);\n-            dialog.add(\"Center\", new JScrollPane(messageText,\n-                    JScrollPane.VERTICAL_SCROLLBAR_ALWAYS,\n-                    JScrollPane.HORIZONTAL_SCROLLBAR_ALWAYS));\n-\n-            JPanel buttons = new JPanel();\n-            pass = new JButton(\"pass\");\n-            pass.setActionCommand(\"pass\");\n-            buttons.add(\"East\", pass);\n-\n-            fail = new JButton(\"fail\");\n-            fail.setActionCommand(\"fail\");\n-            buttons.add(\"West\", fail);\n-\n-            dialog.add(\"South\", buttons);\n-        }\n-\n-        public DialogBuilder setTitle(String title) {\n-            dialog.setTitle(title);\n-            return this;\n-        }\n-\n-        public DialogBuilder setInstruction(String instruction) {\n-            instructionsText.setText(\"Test instructions:\\n\" + instruction);\n-            return this;\n-        }\n-\n-        public DialogBuilder setMessage(String message) {\n-            messageText.setText(message);\n-            return this;\n-        }\n-\n-        public DialogBuilder setPassAction(ActionListener action) {\n-            pass.addActionListener(action);\n-            return this;\n-        }\n-\n-        public DialogBuilder setFailAction(ActionListener action) {\n-            fail.addActionListener(action);\n-            return this;\n-        }\n-\n-        public DialogBuilder setAbortAction(Runnable action) {\n-            dialog.addWindowListener(new WindowAdapter() {\n-                @Override\n-                public void windowClosing(WindowEvent e) {\n-                    super.windowClosing(e);\n-                    action.run();\n-                }\n-            });\n-            return this;\n-        }\n-\n-        public JDialog build() {\n-            dialog.pack();\n-            return dialog;\n-        }\n-    }\n-\n@@ -330,4 +254,9 @@\n-        if (args.length == 1) {\n-            Locale.setDefault(Locale.of(args[0]));\n-        } else if (args.length == 2) {\n-            Locale.setDefault(Locale.of(args[0], args[1]));\n+        final String lang = System.getProperty(\"user.language\");\n+        final String country = System.getProperty(\"user.country\");\n+\n+        if (lang != null) {\n+            if (country != null) {\n+                Locale.setDefault(Locale.of(lang, country));\n+            } else {\n+                Locale.setDefault(Locale.of(lang));\n+            }\n@@ -335,1 +264,2 @@\n-        final String LANG = Locale.getDefault().getDisplayLanguage();\n+\n+        final String displayName = Locale.getDefault().getDisplayName();\n@@ -342,1 +272,1 @@\n-            String instruction = entry[1].replaceAll(\"\\\\$\\\\{LANG\\\\}\", LANG);\n+            String instruction = entry[1].replaceAll(\"\\\\$\\\\{LANG\\\\}\", displayName);\n@@ -378,1 +308,1 @@\n-        JDialog dialog = new DialogBuilder()\n+        JDialog dialog = new TestUI.DialogBuilder()\n@@ -384,1 +314,1 @@\n-                .setAbortAction(() -> abort())\n+                .setCloseAction(() -> abort())\n","filename":"test\/jdk\/sun\/security\/tools\/keytool\/i18n.java","additions":20,"deletions":90,"binary":false,"changes":110,"status":"modified"},{"patch":"@@ -0,0 +1,105 @@\n+\/*\n+ * Copyright (c) 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+ *\n+ * This code is free software; you can redistribute it and\/or modify it\n+ * under the terms of the GNU General Public License version 2 only, as\n+ * published by the Free Software Foundation.\n+ *\n+ * This code is distributed in the hope that it will be useful, but WITHOUT\n+ * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+ * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+ * version 2 for more details (a copy is included in the LICENSE file that\n+ * accompanied this code).\n+ *\n+ * You should have received a copy of the GNU General Public License version\n+ * 2 along with this work; if not, write to the Free Software Foundation,\n+ * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n+ *\n+ * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n+ * or visit www.oracle.com if you need additional information or have any\n+ * questions.\n+ *\/\n+package jdk.test.lib;\n+\n+import javax.swing.*;\n+import java.awt.event.ActionListener;\n+import java.awt.event.WindowAdapter;\n+import java.awt.event.WindowEvent;\n+\n+public class TestUI {\n+    public static class DialogBuilder {\n+        private JDialog dialog;\n+        private JTextArea instructionsText;\n+        private JTextArea messageText;\n+        private JButton pass;\n+        private JButton fail;\n+\n+        public DialogBuilder() {\n+            dialog = new JDialog(new JFrame());\n+            dialog.setDefaultCloseOperation(JDialog.DO_NOTHING_ON_CLOSE);\n+            instructionsText = new JTextArea(\"\", 5, 100);\n+\n+            dialog.add(\"North\", new JScrollPane(instructionsText,\n+                    JScrollPane.VERTICAL_SCROLLBAR_ALWAYS,\n+                    JScrollPane.HORIZONTAL_SCROLLBAR_ALWAYS));\n+\n+            messageText = new JTextArea(\"\", 20, 100);\n+            dialog.add(\"Center\", new JScrollPane(messageText,\n+                    JScrollPane.VERTICAL_SCROLLBAR_ALWAYS,\n+                    JScrollPane.HORIZONTAL_SCROLLBAR_ALWAYS));\n+\n+            JPanel buttons = new JPanel();\n+            pass = new JButton(\"pass\");\n+            pass.setActionCommand(\"pass\");\n+            buttons.add(\"East\", pass);\n+\n+            fail = new JButton(\"fail\");\n+            fail.setActionCommand(\"fail\");\n+            buttons.add(\"West\", fail);\n+\n+            dialog.add(\"South\", buttons);\n+        }\n+\n+        public DialogBuilder setTitle(String title) {\n+            dialog.setTitle(title);\n+            return this;\n+        }\n+\n+        public DialogBuilder setInstruction(String instruction) {\n+            instructionsText.setText(\"Test instructions:\\n\" + instruction);\n+            return this;\n+        }\n+\n+        public DialogBuilder setMessage(String message) {\n+            messageText.setText(message);\n+            return this;\n+        }\n+\n+        public DialogBuilder setPassAction(ActionListener action) {\n+            pass.addActionListener(action);\n+            return this;\n+        }\n+\n+        public DialogBuilder setFailAction(ActionListener action) {\n+            fail.addActionListener(action);\n+            return this;\n+        }\n+\n+        public DialogBuilder setCloseAction(Runnable action) {\n+            dialog.addWindowListener(new WindowAdapter() {\n+                @Override\n+                public void windowClosing(WindowEvent e) {\n+                    super.windowClosing(e);\n+                    action.run();\n+                }\n+            });\n+            return this;\n+        }\n+\n+        public JDialog build() {\n+            dialog.pack();\n+            return dialog;\n+        }\n+    }\n+}\n","filename":"test\/lib\/jdk\/test\/lib\/TestUI.java","additions":105,"deletions":0,"binary":false,"changes":105,"status":"added"}]}