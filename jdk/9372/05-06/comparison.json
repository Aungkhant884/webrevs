{"files":[{"patch":"@@ -58,4 +58,0 @@\n-\n-import jdk.internal.platform.Metrics;\n-import jdk.internal.platform.SystemMetrics;\n-import sun.management.ContainerInfo;\n@@ -1022,16 +1018,0 @@\n-    private static class ReadOnlyExtensionMBeanInitializer {\n-       public static void init() {\n-            Metrics containerMetrics = SystemMetrics.instance();\n-            if (containerMetrics != null) {\n-                MBeanServer mbs = ManagementFactory.getPlatformMBeanServer();\n-                ContainerInfoMXBean mbean = new ContainerInfo(containerMetrics);\n-                try {\n-                    ObjectName name = new ObjectName(\"java.lang:type=Container\");\n-                    mbs.registerMBean(mbean, name);\n-                } catch (Exception e) {\n-                }\n-            }\n-\n-        }\n-    }\n-\n@@ -1040,1 +1020,0 @@\n-        ReadOnlyExtensionMBeanInitializer.init();\n","filename":"src\/java.management\/share\/classes\/java\/lang\/management\/ManagementFactory.java","additions":0,"deletions":21,"binary":false,"changes":21,"status":"modified"},{"patch":"@@ -24,1 +24,1 @@\n-package java.lang.management;\n+package java.lang.management.internal.mBeans;\n","filename":"src\/java.management\/share\/classes\/java\/lang\/management\/internal\/mBeans\/ContainerInfoMXBean.java","additions":1,"deletions":1,"binary":false,"changes":2,"previous_filename":"src\/java.management\/share\/classes\/java\/lang\/management\/ContainerInfoMXBean.java","status":"renamed"},{"patch":"@@ -52,0 +52,1 @@\n+    exports java.lang.management.internal.mBeans;\n","filename":"src\/java.management\/share\/classes\/module-info.java","additions":1,"deletions":0,"binary":false,"changes":1,"status":"modified"},{"patch":"@@ -28,1 +28,1 @@\n-import java.lang.management.ContainerInfoMXBean;\n+import java.lang.management.internal.mBeans.ContainerInfoMXBean;\n","filename":"src\/java.management\/share\/classes\/sun\/management\/ContainerInfo.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -45,0 +45,2 @@\n+import jdk.internal.platform.Metrics;\n+import jdk.internal.platform.SystemMetrics;\n@@ -63,0 +65,4 @@\n+\n+    private static final String CONTAINER_MBEAN_NAME =\n+            \"java.lang:type=Container\";\n+\n@@ -69,0 +75,5 @@\n+        MBeanServer mbs = ManagementFactory.getPlatformMBeanServer();\n+        ContainerInfo containerInfoMBean = getContainerInfoMBean();\n+        if (containerInfoMBean != null) {\n+            addMBean(mbs, containerInfoMBean, CONTAINER_MBEAN_NAME);\n+        }\n@@ -408,0 +419,11 @@\n+    private static ContainerInfo containerInfoMBean = null;\n+\n+    private static synchronized ContainerInfo getContainerInfoMBean() {\n+        if (containerInfoMBean == null) {\n+            Metrics containerMetrics = SystemMetrics.instance();\n+            if (containerMetrics != null) {\n+                containerInfoMBean = new ContainerInfo(containerMetrics);\n+            }\n+        }\n+        return containerInfoMBean;\n+    }\n","filename":"src\/java.management\/share\/classes\/sun\/management\/ManagementFactoryHelper.java","additions":22,"deletions":0,"binary":false,"changes":22,"status":"modified"}]}