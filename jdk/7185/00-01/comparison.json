{"files":[{"patch":"@@ -31,0 +31,3 @@\n+\n+import jdk.internal.access.JavaLangReflectAccess;\n+import jdk.internal.access.SharedSecrets;\n@@ -202,1 +205,2 @@\n-                        return InvocationHandler.invokeDefault(proxy, method, args);\n+                        \/\/ no additional access check is performed\n+                        return JLRA.invokeDefault(proxy, method, null, args);\n@@ -319,0 +323,2 @@\n+\n+    private static final JavaLangReflectAccess JLRA = SharedSecrets.getJavaLangReflectAccess();\n","filename":"src\/java.base\/share\/classes\/java\/lang\/invoke\/MethodHandleProxies.java","additions":7,"deletions":1,"binary":false,"changes":8,"status":"modified"},{"patch":"@@ -31,1 +31,0 @@\n-import java.lang.invoke.MethodHandle;\n@@ -265,28 +264,1 @@\n-\n-        \/\/ verify that the object is actually a proxy instance\n-        if (!Proxy.isProxyClass(proxy.getClass())) {\n-            throw new IllegalArgumentException(\"'proxy' is not a proxy instance\");\n-        }\n-        if (!method.isDefault()) {\n-            throw new IllegalArgumentException(\"\\\"\" + method + \"\\\" is not a default method\");\n-        }\n-        @SuppressWarnings(\"unchecked\")\n-        Class<? extends Proxy> proxyClass = (Class<? extends Proxy>)proxy.getClass();\n-\n-        Class<?> intf = method.getDeclaringClass();\n-        \/\/ access check on the default method\n-        method.checkAccess(Reflection.getCallerClass(), intf, proxyClass, method.getModifiers());\n-\n-        MethodHandle mh = Proxy.defaultMethodHandle(proxyClass, method);\n-        \/\/ invoke the super method\n-        try {\n-            \/\/ the args array can be null if the number of formal parameters required by\n-            \/\/ the method is zero (consistent with Method::invoke)\n-            Object[] params = args != null ? args : Proxy.EMPTY_ARGS;\n-            return mh.invokeExact(proxy, params);\n-        } catch (ClassCastException | NullPointerException e) {\n-            throw new IllegalArgumentException(e.getMessage(), e);\n-        } catch (Proxy.InvocationException e) {\n-            \/\/ unwrap and throw the exception thrown by the default method\n-            throw e.getCause();\n-        }\n+        return Proxy.invokeDefault(proxy, method, args, Reflection.getCallerClass());\n","filename":"src\/java.base\/share\/classes\/java\/lang\/reflect\/InvocationHandler.java","additions":1,"deletions":29,"binary":false,"changes":30,"status":"modified"},{"patch":"@@ -1317,0 +1317,40 @@\n+    \/*\n+     * Invoke the default method of the given proxy with an explicit caller class.\n+     *\n+     * @throws IllegalAccessException if the proxy interface is inaccessible to the caller\n+     *         if caller is non-null\n+     *\/\n+    static Object invokeDefault(Object proxy, Method method, Object[] args, Class<?> caller)\n+            throws Throwable {\n+        \/\/ verify that the object is actually a proxy instance\n+        if (!Proxy.isProxyClass(proxy.getClass())) {\n+            throw new IllegalArgumentException(\"'proxy' is not a proxy instance\");\n+        }\n+        if (!method.isDefault()) {\n+            throw new IllegalArgumentException(\"\\\"\" + method + \"\\\" is not a default method\");\n+        }\n+        @SuppressWarnings(\"unchecked\")\n+        Class<? extends Proxy> proxyClass = (Class<? extends Proxy>)proxy.getClass();\n+\n+        \/\/ skip access check if caller is null\n+        if (caller != null) {\n+            Class<?> intf = method.getDeclaringClass();\n+            \/\/ access check on the default method\n+            method.checkAccess(caller, intf, proxyClass, method.getModifiers());\n+        }\n+\n+        MethodHandle mh = Proxy.defaultMethodHandle(proxyClass, method);\n+        \/\/ invoke the super method\n+        try {\n+            \/\/ the args array can be null if the number of formal parameters required by\n+            \/\/ the method is zero (consistent with Method::invoke)\n+            Object[] params = args != null ? args : Proxy.EMPTY_ARGS;\n+            return mh.invokeExact(proxy, params);\n+        } catch (ClassCastException | NullPointerException e) {\n+            throw new IllegalArgumentException(e.getMessage(), e);\n+        } catch (Proxy.InvocationException e) {\n+            \/\/ unwrap and throw the exception thrown by the default method\n+            throw e.getCause();\n+        }\n+    }\n+\n","filename":"src\/java.base\/share\/classes\/java\/lang\/reflect\/Proxy.java","additions":40,"deletions":0,"binary":false,"changes":40,"status":"modified"},{"patch":"@@ -130,0 +130,5 @@\n+\n+    public Object invokeDefault(Object proxy, Method method, Object[] args, Class<?> caller)\n+            throws Throwable {\n+        return Proxy.invokeDefault(proxy, method, args, caller);\n+    }\n","filename":"src\/java.base\/share\/classes\/java\/lang\/reflect\/ReflectAccess.java","additions":5,"deletions":0,"binary":false,"changes":5,"status":"modified"},{"patch":"@@ -105,0 +105,3 @@\n+\n+    public Object invokeDefault(Object proxy, Method method, Object[] args, Class<?> caller)\n+        throws Throwable;\n","filename":"src\/java.base\/share\/classes\/jdk\/internal\/access\/JavaLangReflectAccess.java","additions":3,"deletions":0,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -0,0 +1,32 @@\n+\/*\n+ * Copyright (c) 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+ *\n+ * This code is free software; you can redistribute it and\/or modify it\n+ * under the terms of the GNU General Public License version 2 only, as\n+ * published by the Free Software Foundation.\n+ *\n+ * This code is distributed in the hope that it will be useful, but WITHOUT\n+ * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+ * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+ * version 2 for more details (a copy is included in the LICENSE file that\n+ * accompanied this code).\n+ *\n+ * You should have received a copy of the GNU General Public License version\n+ * 2 along with this work; if not, write to the Free Software Foundation,\n+ * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n+ *\n+ * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n+ * or visit www.oracle.com if you need additional information or have any\n+ * questions.\n+ *\/\n+\n+\/**\n+ * @test\n+ * @bug 8280377\n+ * @build m1\/* m2\/* Unnamed\n+ * @run testng\/othervm m1\/p1.Main\n+ * @run testng\/othervm Unnamed\n+ * @summary Test MethodHandleProxies::asInterfaceInstance with a default\n+ *          method with varargs\n+ *\/\n","filename":"test\/jdk\/java\/lang\/invoke\/MethodHandleProxies\/Driver.java","additions":32,"deletions":0,"binary":false,"changes":32,"status":"added"},{"patch":"@@ -0,0 +1,122 @@\n+\/*\n+ * Copyright (c) 2018, 2021, Oracle and\/or its affiliates. All rights reserved.\n+ * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+ *\n+ * This code is free software; you can redistribute it and\/or modify it\n+ * under the terms of the GNU General Public License version 2 only, as\n+ * published by the Free Software Foundation.\n+ *\n+ * This code is distributed in the hope that it will be useful, but WITHOUT\n+ * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+ * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+ * version 2 for more details (a copy is included in the LICENSE file that\n+ * accompanied this code).\n+ *\n+ * You should have received a copy of the GNU General Public License version\n+ * 2 along with this work; if not, write to the Free Software Foundation,\n+ * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n+ *\n+ * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n+ * or visit www.oracle.com if you need additional information or have any\n+ * questions.\n+ *\/\n+\n+\/* @test\n+ * @bug 8206955 8269351\n+ * @run testng\/othervm -ea -esa test.java.lang.invoke.MethodHandlesProxiesTest\n+ *\/\n+\n+package test.java.lang.invoke;\n+\n+import org.testng.annotations.Test;\n+\n+import java.lang.invoke.MethodHandle;\n+import java.lang.invoke.MethodHandleProxies;\n+import java.lang.invoke.MethodHandles;\n+\n+import static org.testng.Assert.assertEquals;\n+\n+public class MethodHandlesProxiesTest {\n+\n+    public interface A {\n+        default String a() {\n+            return \"A\";\n+        }\n+    }\n+\n+    public interface B {\n+        default String b() {\n+            return \"B\";\n+        }\n+    }\n+\n+    public interface C extends A, B {\n+        String f();\n+\n+        default String c() {\n+            return \"C\";\n+        }\n+\n+        default String concat() {\n+            return a() + b() + c();\n+        }\n+    }\n+\n+    public interface Override extends C {\n+        String f();\n+\n+        default String a() {\n+            return \"OA\";\n+        }\n+\n+        default String b() {\n+            return \"OB\";\n+        }\n+\n+        default String c() {\n+            return \"OC\";\n+        }\n+    }\n+\n+    @Test\n+    public static void testDefaultMethods() throws Throwable {\n+        MethodHandle target = MethodHandles.constant(String.class, \"F\");\n+        C proxy = MethodHandleProxies.asInterfaceInstance(C.class, target);\n+\n+        assertEquals(proxy.f(), \"F\");\n+        assertEquals(proxy.a(), \"A\");\n+        assertEquals(proxy.b(), \"B\");\n+        assertEquals(proxy.c(), \"C\");\n+        assertEquals(proxy.concat(), \"ABC\");\n+    }\n+\n+    @Test\n+    public static void testOverriddenDefaultMethods() throws Throwable {\n+        MethodHandle target = MethodHandles.constant(String.class, \"F\");\n+        Override proxy = MethodHandleProxies.asInterfaceInstance(Override.class, target);\n+\n+        assertEquals(proxy.a(), \"OA\");\n+        assertEquals(proxy.b(), \"OB\");\n+        assertEquals(proxy.c(), \"OC\");\n+    }\n+\n+    public sealed interface Intf permits NonSealedInterface {\n+        String m();\n+    }\n+\n+    public non-sealed interface NonSealedInterface extends Intf {\n+    }\n+\n+    @Test(expectedExceptions = { IllegalArgumentException.class })\n+    public void testSealedInterface() {\n+        MethodHandle target = MethodHandles.constant(String.class, \"Sealed\");\n+        MethodHandleProxies.asInterfaceInstance(Intf.class, target);\n+    }\n+\n+    @Test\n+    public void testNonSealedInterface() {\n+        MethodHandle target = MethodHandles.constant(String.class, \"Non-Sealed\");\n+        NonSealedInterface proxy = MethodHandleProxies.asInterfaceInstance(NonSealedInterface.class, target);\n+        assertEquals(proxy.m(), \"Non-Sealed\");\n+    }\n+}\n","filename":"test\/jdk\/java\/lang\/invoke\/MethodHandleProxies\/MethodHandlesProxiesTest.java","additions":122,"deletions":0,"binary":false,"changes":122,"status":"added"},{"patch":"@@ -0,0 +1,45 @@\n+\/*\n+ * Copyright (c) 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+ *\n+ * This code is free software; you can redistribute it and\/or modify it\n+ * under the terms of the GNU General Public License version 2 only, as\n+ * published by the Free Software Foundation.\n+ *\n+ * This code is distributed in the hope that it will be useful, but WITHOUT\n+ * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+ * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+ * version 2 for more details (a copy is included in the LICENSE file that\n+ * accompanied this code).\n+ *\n+ * You should have received a copy of the GNU General Public License version\n+ * 2 along with this work; if not, write to the Free Software Foundation,\n+ * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n+ *\n+ * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n+ * or visit www.oracle.com if you need additional information or have any\n+ * questions.\n+ *\/\n+\n+import java.lang.invoke.MethodHandle;\n+import java.lang.invoke.MethodHandleProxies;\n+import java.lang.invoke.MethodHandles;\n+import java.lang.reflect.Method;\n+\n+import static org.testng.Assert.*;\n+\n+\/*\n+ * Test MethodHandleProxies::asInterfaceInstance with an inaccessible interface\n+ *\/\n+public class Unnamed {\n+    public static void main(String... args) throws Throwable {\n+        MethodHandle target = MethodHandles.constant(String.class, \"test\");\n+        Class<?> intf = Class.forName(\"p2.TestIntf\");\n+        Object t = MethodHandleProxies.asInterfaceInstance(intf, target);\n+\n+        \/\/ verify that the caller has no access to the proxy created on an\n+        \/\/ inaccessible interface\n+        Method m = intf.getMethod(\"test\", Object[].class);\n+        assertFalse(m.canAccess(null));\n+    }\n+}\n","filename":"test\/jdk\/java\/lang\/invoke\/MethodHandleProxies\/Unnamed.java","additions":45,"deletions":0,"binary":false,"changes":45,"status":"added"},{"patch":"@@ -0,0 +1,27 @@\n+\/*\n+ * Copyright (c) 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+ *\n+ * This code is free software; you can redistribute it and\/or modify it\n+ * under the terms of the GNU General Public License version 2 only, as\n+ * published by the Free Software Foundation.\n+ *\n+ * This code is distributed in the hope that it will be useful, but WITHOUT\n+ * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+ * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+ * version 2 for more details (a copy is included in the LICENSE file that\n+ * accompanied this code).\n+ *\n+ * You should have received a copy of the GNU General Public License version\n+ * 2 along with this work; if not, write to the Free Software Foundation,\n+ * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n+ *\n+ * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n+ * or visit www.oracle.com if you need additional information or have any\n+ * questions.\n+ *\/\n+module m1 {\n+    requires m2;\n+    requires org.testng;\n+    exports p1;\n+}\n","filename":"test\/jdk\/java\/lang\/invoke\/MethodHandleProxies\/m1\/module-info.java","additions":27,"deletions":0,"binary":false,"changes":27,"status":"added"},{"patch":"@@ -0,0 +1,80 @@\n+\/*\n+ * Copyright (c) 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+ *\n+ * This code is free software; you can redistribute it and\/or modify it\n+ * under the terms of the GNU General Public License version 2 only, as\n+ * published by the Free Software Foundation.\n+ *\n+ * This code is distributed in the hope that it will be useful, but WITHOUT\n+ * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+ * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+ * version 2 for more details (a copy is included in the LICENSE file that\n+ * accompanied this code).\n+ *\n+ * You should have received a copy of the GNU General Public License version\n+ * 2 along with this work; if not, write to the Free Software Foundation,\n+ * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n+ *\n+ * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n+ * or visit www.oracle.com if you need additional information or have any\n+ * questions.\n+ *\/\n+\n+package p1;\n+\n+import java.lang.invoke.MethodHandle;\n+import java.lang.invoke.MethodHandleProxies;\n+import java.lang.invoke.MethodHandles;\n+import java.lang.invoke.MethodType;\n+import java.util.Arrays;\n+import java.util.stream.Collectors;\n+\n+import p2.TestIntf;\n+\n+import org.testng.annotations.Test;\n+\n+import static org.testng.Assert.*;\n+\n+public class Main {\n+    public interface A {\n+        default String aConcat(Object... objs) { return Arrays.deepToString(objs); }\n+    }\n+\n+    public interface B {\n+        default String bConcat(Object[] objs) { return Arrays.deepToString(objs); }\n+    }\n+\n+    public interface C extends A, B {\n+        String c(Object... objs);\n+    }\n+\n+    private static String concat(Object... objs) {\n+        return Arrays.stream(objs).map(Object::toString).collect(Collectors.joining());\n+    }\n+\n+    \/*\n+     * Test the invocation of default methods with varargs\n+     *\/\n+    @Test\n+    public static void testVarargsMethods() throws Throwable {\n+        MethodHandle target = MethodHandles.lookup().findStatic(Main.class,\n+                \"concat\", MethodType.methodType(String.class, Object[].class));\n+        C proxy = MethodHandleProxies.asInterfaceInstance(C.class, target);\n+\n+        assertEquals(proxy.c(\"a\", \"b\", \"c\"), \"abc\");\n+        assertEquals(proxy.aConcat(\"a\", \"b\", \"c\"), \"[a, b, c]\");\n+        assertEquals(proxy.aConcat(new Object[] { \"a\", \"b\", \"c\" }), \"[a, b, c]\");\n+        assertEquals(proxy.bConcat(new Object[] { \"a\", \"b\", \"c\" }), \"[a, b, c]\");\n+    }\n+\n+    \/*\n+     * Test the invocation of a default method of an accessible interface\n+     *\/\n+    @Test\n+    public static void modulePrivateInterface() {\n+        MethodHandle target = MethodHandles.constant(String.class, \"test\");\n+        TestIntf t = MethodHandleProxies.asInterfaceInstance(TestIntf.class, target);\n+        assertEquals(t.test(), \"test\");\n+    }\n+}\n","filename":"test\/jdk\/java\/lang\/invoke\/MethodHandleProxies\/m1\/p1\/Main.java","additions":80,"deletions":0,"binary":false,"changes":80,"status":"added"},{"patch":"@@ -0,0 +1,25 @@\n+\/*\n+ * Copyright (c) 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+ *\n+ * This code is free software; you can redistribute it and\/or modify it\n+ * under the terms of the GNU General Public License version 2 only, as\n+ * published by the Free Software Foundation.\n+ *\n+ * This code is distributed in the hope that it will be useful, but WITHOUT\n+ * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+ * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+ * version 2 for more details (a copy is included in the LICENSE file that\n+ * accompanied this code).\n+ *\n+ * You should have received a copy of the GNU General Public License version\n+ * 2 along with this work; if not, write to the Free Software Foundation,\n+ * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n+ *\n+ * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n+ * or visit www.oracle.com if you need additional information or have any\n+ * questions.\n+ *\/\n+module m2 {\n+    exports p2 to m1;\n+}\n","filename":"test\/jdk\/java\/lang\/invoke\/MethodHandleProxies\/m2\/module-info.java","additions":25,"deletions":0,"binary":false,"changes":25,"status":"added"},{"patch":"@@ -0,0 +1,27 @@\n+\/*\n+ * Copyright (c) 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+ *\n+ * This code is free software; you can redistribute it and\/or modify it\n+ * under the terms of the GNU General Public License version 2 only, as\n+ * published by the Free Software Foundation.\n+ *\n+ * This code is distributed in the hope that it will be useful, but WITHOUT\n+ * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+ * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+ * version 2 for more details (a copy is included in the LICENSE file that\n+ * accompanied this code).\n+ *\n+ * You should have received a copy of the GNU General Public License version\n+ * 2 along with this work; if not, write to the Free Software Foundation,\n+ * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n+ *\n+ * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n+ * or visit www.oracle.com if you need additional information or have any\n+ * questions.\n+ *\/\n+package p2;\n+\n+public interface TestIntf {\n+    String test();\n+}\n","filename":"test\/jdk\/java\/lang\/invoke\/MethodHandleProxies\/m2\/p2\/TestIntf.java","additions":27,"deletions":0,"binary":false,"changes":27,"status":"added"},{"patch":"@@ -1,130 +0,0 @@\n-\/*\n- * Copyright (c) 2018, 2022, Oracle and\/or its affiliates. All rights reserved.\n- * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n- *\n- * This code is free software; you can redistribute it and\/or modify it\n- * under the terms of the GNU General Public License version 2 only, as\n- * published by the Free Software Foundation.\n- *\n- * This code is distributed in the hope that it will be useful, but WITHOUT\n- * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n- * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n- * version 2 for more details (a copy is included in the LICENSE file that\n- * accompanied this code).\n- *\n- * You should have received a copy of the GNU General Public License version\n- * 2 along with this work; if not, write to the Free Software Foundation,\n- * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n- *\n- * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n- * or visit www.oracle.com if you need additional information or have any\n- * questions.\n- *\/\n-\n-\/* @test\n- * @bug 8206955 8269351 8280377\n- * @run testng\/othervm -ea -esa test.java.lang.invoke.MethodHandlesProxiesTest\n- *\/\n-\n-package test.java.lang.invoke;\n-\n-import org.testng.annotations.Test;\n-\n-import java.lang.invoke.MethodHandle;\n-import java.lang.invoke.MethodHandleProxies;\n-import java.lang.invoke.MethodHandles;\n-import java.util.Arrays;\n-\n-import static org.testng.Assert.assertEquals;\n-\n-public class MethodHandlesProxiesTest {\n-\n-    public interface A {\n-        default String a() {\n-            return \"A\";\n-        }\n-        default String aConcat(Object... objs) { return Arrays.deepToString(objs); }\n-    }\n-\n-    public interface B {\n-        default String b() {\n-            return \"B\";\n-        }\n-        default String bConcat(Object[] objs) { return Arrays.deepToString(objs); }\n-    }\n-\n-    public interface C extends A, B {\n-        String f();\n-\n-        default String c() {\n-            return \"C\";\n-        }\n-\n-        default String concat() {\n-            return a() + b() + c();\n-        }\n-    }\n-\n-    public interface Override extends C {\n-        String f();\n-\n-        default String a() {\n-            return \"OA\";\n-        }\n-\n-        default String b() {\n-            return \"OB\";\n-        }\n-\n-        default String c() {\n-            return \"OC\";\n-        }\n-    }\n-\n-    @Test\n-    public static void testDefaultMethods() throws Throwable {\n-        MethodHandle target = MethodHandles.constant(String.class, \"F\");\n-        C proxy = MethodHandleProxies.asInterfaceInstance(C.class, target);\n-\n-        assertEquals(proxy.f(), \"F\");\n-        assertEquals(proxy.a(), \"A\");\n-        assertEquals(proxy.b(), \"B\");\n-        assertEquals(proxy.c(), \"C\");\n-        assertEquals(proxy.concat(), \"ABC\");\n-\n-        \/\/ test varargs\n-        assertEquals(proxy.aConcat(\"a\", \"b\", \"c\"), \"[a, b, c]\");\n-        assertEquals(proxy.aConcat(new Object[] { \"a\", \"b\", \"c\" }), \"[a, b, c]\");\n-        assertEquals(proxy.bConcat(new Object[] { \"a\", \"b\", \"c\" }), \"[a, b, c]\");\n-    }\n-\n-    @Test\n-    public static void testOverriddenDefaultMethods() throws Throwable {\n-        MethodHandle target = MethodHandles.constant(String.class, \"F\");\n-        Override proxy = MethodHandleProxies.asInterfaceInstance(Override.class, target);\n-\n-        assertEquals(proxy.a(), \"OA\");\n-        assertEquals(proxy.b(), \"OB\");\n-        assertEquals(proxy.c(), \"OC\");\n-    }\n-\n-    public sealed interface Intf permits NonSealedInterface {\n-        String m();\n-    }\n-\n-    public non-sealed interface NonSealedInterface extends Intf {\n-    }\n-\n-    @Test(expectedExceptions = { IllegalArgumentException.class })\n-    public void testSealedInterface() {\n-        MethodHandle target = MethodHandles.constant(String.class, \"Sealed\");\n-        MethodHandleProxies.asInterfaceInstance(Intf.class, target);\n-    }\n-\n-    @Test\n-    public void testNonSealedInterface() {\n-        MethodHandle target = MethodHandles.constant(String.class, \"Non-Sealed\");\n-        NonSealedInterface proxy = MethodHandleProxies.asInterfaceInstance(NonSealedInterface.class, target);\n-        assertEquals(proxy.m(), \"Non-Sealed\");\n-    }\n-}\n","filename":"test\/jdk\/java\/lang\/invoke\/MethodHandlesProxiesTest.java","additions":0,"deletions":130,"binary":false,"changes":130,"status":"deleted"}]}