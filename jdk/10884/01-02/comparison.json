{"files":[{"patch":"@@ -5196,2 +5196,6 @@\n-    __ addi(t0, as_Register($mem$$base), $mem$$disp);\n-    __ prefetch_w(t0, 0);\n+    if ((($mem$$disp) & 0x1f) == 0) {\n+      __ prefetch_w(as_Register($mem$$base), $mem$$disp);\n+    } else {\n+      __ addi(t0, as_Register($mem$$base), $mem$$disp);\n+      __ prefetch_w(t0, 0);\n+    }\n","filename":"src\/hotspot\/cpu\/riscv\/riscv.ad","additions":6,"deletions":2,"binary":false,"changes":8,"status":"modified"},{"patch":"@@ -33,4 +33,3 @@\n-    void (*stub)(const void*, intptr_t) =\n-        (void (*)(const void*, intptr_t))StubRoutines::riscv::prefetch_r();\n-    if (interval >= 0 && stub != NULL) {\n-        stub(loc, interval);\n+    if (interval >= 0 && UseZicbop) {\n+        \/\/ encoding for prefetch.r\n+        asm(\"ori zero, %0, 1\" : : \"r\"(intptr_t(loc)+interval));\n@@ -41,4 +40,3 @@\n-    void (*stub)(const void*, intptr_t) =\n-        (void (*)(const void*, intptr_t))StubRoutines::riscv::prefetch_w();\n-    if (interval >= 0 && stub != NULL) {\n-        stub(loc, interval);\n+    if (interval >= 0 && UseZicbop) {\n+        \/\/ encoding for prefetch.w\n+        asm(\"ori zero, %0, 3\" : : \"r\"(intptr_t(loc)+interval));\n","filename":"src\/hotspot\/os_cpu\/linux_riscv\/prefetch_linux_riscv.inline.hpp","additions":6,"deletions":8,"binary":false,"changes":14,"status":"modified"}]}