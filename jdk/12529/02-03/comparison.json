{"files":[{"patch":"@@ -351,1 +351,2 @@\n-void G1FullCollector::add_regions_for_serial_compaction() {\n+void G1FullCollector::phase2c_prepare_serial_compaction() {\n+  GCTraceTime(Debug, gc, phases) debug(\"Phase 2: Prepare serial compaction\", scope()->timer());\n@@ -379,1 +380,1 @@\n-\n+  HeapWord* dense_prefix_top = nullptr;\n@@ -382,25 +383,13 @@\n-      serial_cp->add(_heap->region_at(i));\n-    }\n-  }\n-}\n-\n-void G1FullCollector::phase2c_prepare_serial_compaction() {\n-  GCTraceTime(Debug, gc, phases) debug(\"Phase 2: Prepare serial compaction\", scope()->timer());\n-\n-  add_regions_for_serial_compaction();\n-  \/\/ Update the forwarding information for the regions in the serial\n-  \/\/ compaction point.\n-  G1FullGCCompactionPoint* cp = serial_compaction_point();\n-  HeapWord* dense_prefix_top = nullptr;\n-  for (GrowableArrayIterator<HeapRegion*> it = cp->regions()->begin(); it != cp->regions()->end(); ++it) {\n-    HeapRegion* current = *it;\n-    if (!cp->is_initialized()) {\n-      \/\/ Initialize the compaction point. Nothing more is needed for the first heap region\n-      \/\/ since it is already prepared for compaction.\n-      cp->initialize(current);\n-      dense_prefix_top = compaction_top(current);\n-    } else {\n-      assert(!current->is_humongous(), \"Should be no humongous regions in compaction queue\");\n-      G1SerialRePrepareClosure re_prepare(cp, current, dense_prefix_top);\n-      set_compaction_top(current, current->bottom());\n-      current->apply_to_marked_objects(mark_bitmap(), &re_prepare);\n+      HeapRegion* current = _heap->region_at(i);\n+      serial_cp->add(current);\n+      if (!serial_cp->is_initialized()) {\n+        \/\/ Initialize the compaction point. Nothing more is needed for the first heap region\n+        \/\/ since it is already prepared for compaction.\n+        serial_cp->initialize(current);\n+        dense_prefix_top = compaction_top(current);\n+      } else {\n+        assert(!current->is_humongous(), \"Should be no humongous regions in compaction queue\");\n+        G1SerialRePrepareClosure re_prepare(serial_cp, current, dense_prefix_top);\n+        set_compaction_top(current, current->bottom());\n+        current->apply_to_marked_objects(mark_bitmap(), &re_prepare);\n+      }\n@@ -409,1 +398,1 @@\n-  cp->update();\n+  serial_cp->update();\n","filename":"src\/hotspot\/share\/gc\/g1\/g1FullCollector.cpp","additions":17,"deletions":28,"binary":false,"changes":45,"status":"modified"},{"patch":"@@ -147,1 +147,0 @@\n-  void add_regions_for_serial_compaction();\n","filename":"src\/hotspot\/share\/gc\/g1\/g1FullCollector.hpp","additions":0,"deletions":1,"binary":false,"changes":1,"status":"modified"}]}