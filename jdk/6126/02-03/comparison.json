{"files":[{"patch":"@@ -2888,1 +2888,0 @@\n-                int signerCnt = 0;\n@@ -2892,1 +2891,0 @@\n-                            signerCnt++;\n@@ -2896,0 +2894,2 @@\n+                }\n+            }\n@@ -2897,2 +2897,17 @@\n-                    if (signerCnt == 0) {\n-                        continue;\n+            for (CodeSigner signer: ss) {\n+                out.printf(rb.getString(\"Signer.d.\"), ++pos);\n+                out.println();\n+                out.println();\n+\n+                List<? extends Certificate> certs\n+                        = signer.getSignerCertPath().getCertificates();\n+                int cc = 0;\n+                for (Certificate cert: certs) {\n+                    out.printf(rb.getString(\"Certificate.d.\"), ++cc);\n+                    out.println();\n+                    X509Certificate x = (X509Certificate)cert;\n+                    if (rfc) {\n+                        out.println(rb.getString(\"Certificate.owner.\") + x.getSubjectX500Principal() + \"\\n\");\n+                        dumpCert(x, out);\n+                    } else {\n+                        printX509Cert(x, out);\n@@ -2900,3 +2915,14 @@\n-                    for (CodeSigner signer: ss) {\n-                        out.printf(rb.getString(\"Signer.d.\"), ++pos);\n-                        out.println();\n+                    out.println();\n+                    checkWeak(oneInManys(rb.getString(\n+                            \"the.certificate\"), cc,\n+                            certs.size(), pos,\n+                            ss.size()), x);\n+                }\n+                Timestamp ts = signer.getTimestamp();\n+                if (ts != null) {\n+                    out.println(rb.getString(\"Timestamp.\"));\n+                    out.println();\n+                    certs = ts.getSignerCertPath().getCertificates();\n+                    cc = 0;\n+                    for (Certificate cert: certs) {\n+                        out.printf(rb.getString(\"Certificate.d.\"), ++cc);\n@@ -2904,42 +2930,6 @@\n-\n-                        List<? extends Certificate> certs\n-                                = signer.getSignerCertPath().getCertificates();\n-                        int cc = 0;\n-                        for (Certificate cert: certs) {\n-                            out.printf(rb.getString(\"Certificate.d.\"), ++cc);\n-                            out.println();\n-                            X509Certificate x = (X509Certificate)cert;\n-                            if (rfc) {\n-                                out.println(rb.getString(\"Certificate.owner.\") + x.getSubjectX500Principal() + \"\\n\");\n-                                dumpCert(x, out);\n-                            } else {\n-                                printX509Cert(x, out);\n-                            }\n-                            out.println();\n-                            checkWeak(oneInManys(rb.getString(\n-                                    \"the.certificate\"), cc,\n-                                    certs.size(), pos,\n-                                    signerCnt), x);\n-                        }\n-                        Timestamp ts = signer.getTimestamp();\n-                        if (ts != null) {\n-                            out.println(rb.getString(\"Timestamp.\"));\n-                            out.println();\n-                            certs = ts.getSignerCertPath().getCertificates();\n-                            cc = 0;\n-                            for (Certificate cert: certs) {\n-                                out.printf(rb.getString(\"Certificate.d.\"), ++cc);\n-                                out.println();\n-                                X509Certificate x = (X509Certificate)cert;\n-                                if (rfc) {\n-                                    out.println(rb.getString(\"Certificate.owner.\") + x.getSubjectX500Principal() + \"\\n\");\n-                                    dumpCert(x, out);\n-                                } else {\n-                                    printX509Cert(x, out);\n-                                }\n-                                out.println();\n-                                checkWeak(oneInManys(rb.getString(\n-                                        \"the.tsa.certificate\"), cc,\n-                                        certs.size(), pos,\n-                                        signerCnt), x);\n-                            }\n+                        X509Certificate x = (X509Certificate)cert;\n+                        if (rfc) {\n+                            out.println(rb.getString(\"Certificate.owner.\") + x.getSubjectX500Principal() + \"\\n\");\n+                            dumpCert(x, out);\n+                        } else {\n+                            printX509Cert(x, out);\n@@ -2947,0 +2937,5 @@\n+                        out.println();\n+                        checkWeak(oneInManys(rb.getString(\n+                                \"the.tsa.certificate\"), cc,\n+                                certs.size(), pos,\n+                                ss.size()), x);\n","filename":"src\/java.base\/share\/classes\/sun\/security\/tools\/keytool\/Main.java","additions":44,"deletions":49,"binary":false,"changes":93,"status":"modified"}]}