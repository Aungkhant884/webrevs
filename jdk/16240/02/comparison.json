{"files":[{"patch":"@@ -1790,1 +1790,1 @@\n-  char* result = pd_attempt_reserve_memory_at(requested_addr, bytes, !ExecMem);\n+  char* result = pd_attempt_reserve_memory_at(requested_addr, bytes, !ExecMem, nullptr);\n","filename":"src\/hotspot\/os\/bsd\/os_bsd.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -3417,1 +3417,1 @@\n-  return pd_attempt_reserve_memory_at(nullptr \/* addr *\/, bytes, exec);\n+  return pd_attempt_reserve_memory_at(nullptr \/* addr *\/, bytes, exec, nullptr);\n","filename":"src\/hotspot\/os\/windows\/os_windows.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -509,1 +509,2 @@\n-  address p2 = (address)os::attempt_reserve_memory_at((char*)p_middle_stripes, middle_stripe_len);\n+  address p2 = (address)os::attempt_reserve_memory_at((char*)p_middle_stripes, middle_stripe_len, false);\n+\n@@ -511,0 +512,1 @@\n+\n@@ -554,2 +556,2 @@\n-  const size_t stripe_len = 4 * M;\n-  const int num_stripes = 4;\n+  const size_t stripe_len = os::vm_allocation_granularity();\n+  const int num_stripes = 6;\n@@ -560,1 +562,0 @@\n-  ASSERT_NE(p, (address)NULL);\n@@ -562,0 +563,1 @@\n+  ASSERT_NE(p, (address)nullptr);\n@@ -563,2 +565,3 @@\n-  \/\/ .. release it...\n-  ASSERT_TRUE(os::release_memory((char*)p, total_range_len));\n+  \/\/ reserve at border of the region\n+  address border = p + num_stripes * stripe_len;\n+  address p2 = (address)os::attempt_reserve_memory_at((char*)border, stripe_len, false);\n@@ -567,4 +570,1 @@\n-  \/\/ re-reserve it. This should work unless release failed.\n-  address p2 = (address)os::attempt_reserve_memory_at((char*)p, total_range_len);\n-  ASSERT_EQ(p2, p);\n-  PRINT_MAPPINGS(\"C\");\n+  ASSERT_TRUE(p2 == nullptr || p2 == border);\n@@ -573,1 +573,6 @@\n-  PRINT_MAPPINGS(\"D\");\n+  PRINT_MAPPINGS(\"C\");\n+\n+  if (p2 != nullptr) {\n+    ASSERT_TRUE(os::release_memory((char*)p2, stripe_len));\n+    PRINT_MAPPINGS(\"D\");\n+  }\n","filename":"test\/hotspot\/gtest\/runtime\/test_os.cpp","additions":16,"deletions":11,"binary":false,"changes":27,"status":"modified"}]}