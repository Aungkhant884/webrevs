{"files":[{"patch":"@@ -107,1 +107,2 @@\n-    Compile C(env, target, entry_bci, subsume_loads, do_escape_analysis, eliminate_boxing, do_locks_coarsening, install_code, directive);\n+    Options options(subsume_loads, do_escape_analysis, eliminate_boxing, do_locks_coarsening, install_code);\n+    Compile C(env, target, entry_bci, options, directive);\n","filename":"src\/hotspot\/share\/opto\/c2compiler.cpp","additions":2,"deletions":1,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -490,1 +490,1 @@\n-  if (_subsume_loads == false && PrintOpto) {\n+  if (!subsume_loads() && PrintOpto) {\n@@ -496,1 +496,1 @@\n-  if (_do_escape_analysis != DoEscapeAnalysis && PrintOpto) {\n+  if ((do_escape_analysis() != DoEscapeAnalysis) && PrintOpto) {\n@@ -502,1 +502,1 @@\n-  if (_eliminate_boxing != EliminateAutoBox && PrintOpto) {\n+  if ((eliminate_boxing() != EliminateAutoBox) && PrintOpto) {\n@@ -508,1 +508,1 @@\n-  if ((_do_locks_coarsening != EliminateLocks) && PrintOpto) {\n+  if ((do_locks_coarsening() != EliminateLocks) && PrintOpto) {\n@@ -541,2 +541,1 @@\n-                  bool subsume_loads, bool do_escape_analysis, bool eliminate_boxing,\n-                  bool do_locks_coarsening, bool install_code, DirectiveSet* directive)\n+                  Options options, DirectiveSet* directive)\n@@ -545,5 +544,1 @@\n-                  _subsume_loads(subsume_loads),\n-                  _do_escape_analysis(do_escape_analysis),\n-                  _install_code(install_code),\n-                  _eliminate_boxing(eliminate_boxing),\n-                  _do_locks_coarsening(do_locks_coarsening),\n+                  _options(options),\n@@ -849,5 +844,1 @@\n-    _subsume_loads(true),\n-    _do_escape_analysis(false),\n-    _install_code(true),\n-    _eliminate_boxing(false),\n-    _do_locks_coarsening(false),\n+    _options(Options::for_runtime_stub()),\n@@ -1037,1 +1028,1 @@\n-  if (!_do_escape_analysis && aliaslevel == 3)\n+  if (!do_escape_analysis() && aliaslevel == 3) {\n@@ -1039,0 +1030,1 @@\n+  }\n@@ -2163,1 +2155,1 @@\n-  if (_do_escape_analysis && ConnectionGraph::has_candidates(this)) {\n+  if (do_escape_analysis() && ConnectionGraph::has_candidates(this)) {\n","filename":"src\/hotspot\/share\/opto\/compile.cpp","additions":10,"deletions":18,"binary":false,"changes":28,"status":"modified"},{"patch":"@@ -165,0 +165,31 @@\n+class Options {\n+  friend class Compile;\n+  friend class VMStructs;\n+ private:\n+  const bool _subsume_loads;         \/\/ Load can be matched as part of a larger op.\n+  const bool _do_escape_analysis;    \/\/ Do escape analysis.\n+  const bool _eliminate_boxing;      \/\/ Do boxing elimination.\n+  const bool _do_locks_coarsening;   \/\/ Do locks coarsening\n+  const bool _install_code;          \/\/ Install the code that was compiled\n+ public:\n+  Options(bool subsume_loads, bool do_escape_analysis,\n+          bool eliminate_boxing, bool do_locks_coarsening,\n+          bool install_code) :\n+          _subsume_loads(subsume_loads),\n+          _do_escape_analysis(do_escape_analysis),\n+          _eliminate_boxing(eliminate_boxing),\n+          _do_locks_coarsening(do_locks_coarsening),\n+          _install_code(install_code) {\n+  }\n+\n+  static Options for_runtime_stub() {\n+    return Options(\n+       \/* subsume_loads = *\/ true,\n+       \/* do_escape_analysis = *\/ false,\n+       \/* eliminate_boxing = *\/ false,\n+       \/* do_lock_coarsening = *\/ false,\n+       \/* install_code = *\/ true\n+    );\n+  }\n+};\n+\n@@ -249,5 +280,1 @@\n-  const bool            _subsume_loads;         \/\/ Load can be matched as part of a larger op.\n-  const bool            _do_escape_analysis;    \/\/ Do escape analysis.\n-  const bool            _install_code;          \/\/ Install the code that was compiled\n-  const bool            _eliminate_boxing;      \/\/ Do boxing elimination.\n-  const bool            _do_locks_coarsening;   \/\/ Do locks coarsening\n+  const Options         _options;               \/\/ Compilation options\n@@ -507,1 +534,1 @@\n-  bool              subsume_loads() const       { return _subsume_loads; }\n+  bool              subsume_loads() const       { return _options._subsume_loads; }\n@@ -509,1 +536,1 @@\n-  bool              do_escape_analysis() const  { return _do_escape_analysis; }\n+  bool              do_escape_analysis() const  { return _options._do_escape_analysis; }\n@@ -511,1 +538,1 @@\n-  bool              eliminate_boxing() const    { return _eliminate_boxing; }\n+  bool              eliminate_boxing() const    { return _options._eliminate_boxing; }\n@@ -513,2 +540,2 @@\n-  bool              aggressive_unboxing() const { return _eliminate_boxing && AggressiveUnboxing; }\n-  bool              should_install_code() const { return _install_code; }\n+  bool              aggressive_unboxing() const { return _options._eliminate_boxing && AggressiveUnboxing; }\n+  bool              should_install_code() const { return _options._install_code; }\n@@ -516,1 +543,1 @@\n-  bool              do_locks_coarsening() const { return _do_locks_coarsening; }\n+  bool              do_locks_coarsening() const { return _options._do_locks_coarsening; }\n@@ -1037,3 +1064,1 @@\n-          int entry_bci, bool subsume_loads, bool do_escape_analysis,\n-          bool eliminate_boxing, bool do_locks_coarsening,\n-          bool install_code, DirectiveSet* directive);\n+          int entry_bci, Options options, DirectiveSet* directive);\n","filename":"src\/hotspot\/share\/opto\/compile.hpp","additions":39,"deletions":14,"binary":false,"changes":53,"status":"modified"},{"patch":"@@ -888,3 +888,1 @@\n-  c2_nonstatic_field(Compile,                  _subsume_loads,                                const bool)                            \\\n-  c2_nonstatic_field(Compile,                  _do_escape_analysis,                           const bool)                            \\\n-  c2_nonstatic_field(Compile,                  _eliminate_boxing,                             const bool)                            \\\n+  c2_nonstatic_field(Compile,                  _options,                                      const Options)                         \\\n@@ -893,0 +891,6 @@\n+  c2_nonstatic_field(Options,                  _subsume_loads,                                const bool)                            \\\n+  c2_nonstatic_field(Options,                  _do_escape_analysis,                           const bool)                            \\\n+  c2_nonstatic_field(Options,                  _eliminate_boxing,                             const bool)                            \\\n+  c2_nonstatic_field(Options,                  _do_locks_coarsening,                          const bool)                            \\\n+  c2_nonstatic_field(Options,                  _install_code,                                 const bool)                            \\\n+                                                                                                                                     \\\n@@ -1444,0 +1448,1 @@\n+  declare_c2_toplevel_type(Options)                                       \\\n","filename":"src\/hotspot\/share\/runtime\/vmStructs.cpp","additions":8,"deletions":3,"binary":false,"changes":11,"status":"modified"}]}