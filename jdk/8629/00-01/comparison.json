{"files":[{"patch":"@@ -80,28 +80,8 @@\n-          int buflen;\n-          strncpy(buf, _mount_point, MAXPATHLEN);\n-          buf[MAXPATHLEN-1] = '\\0';\n-          buflen = strlen(buf);\n-          if ((buflen + strlen(cgroup_path)) > (MAXPATHLEN-1)) {\n-              return;\n-          }\n-          char tmp_root_buf[MAXPATHLEN+1];\n-          char tmp_cgroup_buf[MAXPATHLEN+1];\n-          strcpy(tmp_root_buf, _root);\n-          strcpy(tmp_cgroup_buf, cgroup_path);\n-          char* tmp_root = &tmp_root_buf[0];\n-          char* tmp_cgroup = &tmp_cgroup_buf[0];\n-          char* root_save = NULL;\n-          char* cgroup_save = NULL;\n-          char* root_token = NULL;\n-          char* cg_token = NULL;\n-          char* buf_ptr = buf + buflen;\n-          while ((root_token = strtok_r(tmp_root, \"\/\", &root_save)) != NULL &&\n-                 (cg_token = strtok_r(tmp_cgroup, \"\/\", &cgroup_save)) != NULL) {\n-            if (root_token == NULL || cg_token == NULL) {\n-              break;\n-            }\n-            if (strcmp(root_token, cg_token) == 0) {\n-              strncpy(buf_ptr, \"\/\", 2);\n-              buf_ptr++;\n-              strcpy(buf_ptr, root_token);\n-              buf_ptr = buf_ptr + strlen(root_token);\n+          stringStream ss;\n+          ss.print_raw(_mount_point);\n+          const char* root_p = _root;\n+          const char* cgroup_p = cgroup_path;\n+          int last_matching_slash_pos = -1;\n+          for (int i = 0; *root_p == *cgroup_p && *root_p != 0; i++) {\n+            if (*root_p == '\/') {\n+              last_matching_slash_pos = i;\n@@ -109,2 +89,1 @@\n-            tmp_root = NULL;\n-            tmp_cgroup = NULL;\n+            root_p++; cgroup_p++;\n@@ -112,2 +91,2 @@\n-          buf[MAXPATHLEN-1] = '\\0';\n-          _path = os::strdup(buf);\n+          ss.print_raw(_root, last_matching_slash_pos);\n+          _path = os::strdup(ss.base());\n","filename":"src\/hotspot\/os\/linux\/cgroupV1Subsystem_linux.cpp","additions":11,"deletions":32,"binary":false,"changes":43,"status":"modified"}]}