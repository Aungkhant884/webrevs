{"files":[{"patch":"@@ -82,1 +82,1 @@\n-  entry->set_pd_set(NULL);\n+  entry->release_set_pd_set(NULL);\n@@ -87,1 +87,0 @@\n-\n@@ -93,3 +92,3 @@\n-  while (entry->pd_set() != NULL) {\n-    ProtectionDomainEntry* to_delete = entry->pd_set();\n-    entry->set_pd_set(to_delete->next());\n+  if (entry->pd_set_acquire() != NULL) {\n+    ProtectionDomainEntry* to_delete = entry->pd_set_acquire();\n+    entry->release_set_pd_set(to_delete->next_acquire());\n@@ -154,1 +153,1 @@\n-    for (ProtectionDomainEntry* current = pd_set();\n+    for (ProtectionDomainEntry* current = pd_set_acquire();\n@@ -156,1 +155,1 @@\n-                                current = current->next()) {\n+                                current = current->next_acquire()) {\n@@ -174,1 +173,1 @@\n-  for (ProtectionDomainEntry* current = pd_set();\n+  for (ProtectionDomainEntry* current = pd_set_acquire();\n@@ -176,1 +175,1 @@\n-                              current = current->next()) {\n+                              current = current->next_acquire()) {\n@@ -190,1 +189,1 @@\n-    set_pd_set(new_head);\n+    release_set_pd_set(new_head);\n@@ -422,1 +421,1 @@\n-  assert_locked_or_safepoint(SystemDictionary_lock);\n+  assert_lock_strong(SystemDictionary_lock);\n@@ -436,1 +435,1 @@\n-      ProtectionDomainEntry* current = probe->pd_set();\n+      ProtectionDomainEntry* current = probe->pd_set_acquire();\n@@ -450,2 +449,2 @@\n-          if (probe->pd_set() == current) {\n-            probe->set_pd_set(current->next());\n+          if (probe->pd_set_acquire() == current) {\n+            probe->release_set_pd_set(current->next_acquire());\n@@ -454,1 +453,1 @@\n-            prev->set_next(current->next());\n+            prev->release_set_next(current->next_acquire());\n@@ -457,1 +456,1 @@\n-          current = current->next();\n+          current = current->next_acquire();\n@@ -460,1 +459,1 @@\n-          current = current->next();\n+          current = current->next_acquire();\n@@ -552,1 +551,1 @@\n-  for (ProtectionDomainEntry* current = pd_set(); \/\/ accessed at a safepoint\n+  for (ProtectionDomainEntry* current = pd_set_acquire(); \/\/ accessed at a safepoint\n@@ -554,1 +553,1 @@\n-                              current = current->next()) {\n+                              current = current->next_acquire()) {\n@@ -561,1 +560,1 @@\n-  for (ProtectionDomainEntry* current = pd_set();  \/\/ accessed inside SD lock\n+  for (ProtectionDomainEntry* current = pd_set_acquire();  \/\/ accessed inside SD lock\n@@ -563,1 +562,1 @@\n-                              current = current->next()) {\n+                              current = current->next_acquire()) {\n","filename":"src\/hotspot\/share\/classfile\/dictionary.cpp","additions":20,"deletions":21,"binary":false,"changes":41,"status":"modified"},{"patch":"@@ -144,2 +144,2 @@\n-  ProtectionDomainEntry* pd_set() const            { return Atomic::load(&_pd_set); }\n-  void set_pd_set(ProtectionDomainEntry* entry)    { Atomic::store(&_pd_set, entry); }\n+  ProtectionDomainEntry* pd_set_acquire() const            { return Atomic::load_acquire(&_pd_set); }\n+  void release_set_pd_set(ProtectionDomainEntry* entry)    { Atomic::release_store(&_pd_set, entry); }\n","filename":"src\/hotspot\/share\/classfile\/dictionary.hpp","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -114,2 +114,2 @@\n-  ProtectionDomainEntry* next() { return Atomic::load(&_next); }\n-  void set_next(ProtectionDomainEntry* entry) { Atomic::store(&_next, entry); }\n+  ProtectionDomainEntry* next_acquire() { return Atomic::load_acquire(&_next); }\n+  void release_set_next(ProtectionDomainEntry* entry) { Atomic::release_store(&_next, entry); }\n","filename":"src\/hotspot\/share\/classfile\/protectionDomainCache.hpp","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"}]}