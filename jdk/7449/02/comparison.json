{"files":[{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 1997, 2015, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 1997, 2022, Oracle and\/or its affiliates. All rights reserved.\n@@ -122,0 +122,14 @@\n+    private void paintBorderRect(Graphics g, Color c, int w, int h) {\n+        g.setColor(c);\n+        g.drawRect(0, 0, w-2, h-2);\n+    }\n+\n+    private void paintBorderShadow(Graphics g, Color c, int w, int h) {\n+        g.setColor(c);\n+        g.drawLine(1, h-3, 1, 1);\n+        g.drawLine(1, 1, w-3, 1);\n+\n+        g.drawLine(0, h-1, w-1, h-1);\n+        g.drawLine(w-1, h-1, w-1, 0);\n+    }\n+\n@@ -139,6 +153,9 @@\n-        g.setColor(etchType == LOWERED? getShadowColor(c) : getHighlightColor(c));\n-        g.drawRect(0, 0, w-2, h-2);\n-\n-        g.setColor(etchType == LOWERED? getHighlightColor(c) : getShadowColor(c));\n-        g.drawLine(1, h-3, 1, 1);\n-        g.drawLine(1, 1, w-3, 1);\n+        \/\/ 8279614: The dark line was being overdrawn by the light line. The fix was to\n+        \/\/ make sure that the dark line is always drawn second.\n+        if (etchType == LOWERED) {\n+            paintBorderShadow(g, getHighlightColor(c), w, h);\n+            paintBorderRect(g, getShadowColor(c), w, h);\n+        } else {\n+            paintBorderRect(g, getHighlightColor(c), w, h);\n+            paintBorderShadow(g, getShadowColor(c), w, h);\n+        }\n@@ -146,2 +163,0 @@\n-        g.drawLine(0, h-1, w-1, h-1);\n-        g.drawLine(w-1, h-1, w-1, 0);\n","filename":"src\/java.desktop\/share\/classes\/javax\/swing\/border\/EtchedBorder.java","additions":24,"deletions":9,"binary":false,"changes":33,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 1997, 2015, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 1997, 2022, Oracle and\/or its affiliates. All rights reserved.\n@@ -36,0 +36,1 @@\n+import java.awt.geom.Rectangle2D;\n","filename":"src\/java.desktop\/share\/classes\/javax\/swing\/border\/TitledBorder.java","additions":2,"deletions":1,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -0,0 +1,131 @@\n+\/*\n+ * Copyright (c) 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+ *\n+ * This code is free software; you can redistribute it and\/or modify it\n+ * under the terms of the GNU General Public License version 2 only, as\n+ * published by the Free Software Foundation.  Oracle designates this\n+ * particular file as subject to the \"Classpath\" exception as provided\n+ * by Oracle in the LICENSE file that accompanied this code.\n+ *\n+ * This code is distributed in the hope that it will be useful, but WITHOUT\n+ * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+ * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+ * version 2 for more details (a copy is included in the LICENSE file that\n+ * accompanied this code).\n+ *\n+ * You should have received a copy of the GNU General Public License version\n+ * 2 along with this work; if not, write to the Free Software Foundation,\n+ * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n+ *\n+ * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n+ * or visit www.oracle.com if you need additional information or have any\n+ * questions.\n+ *\/\n+import javax.imageio.ImageIO;\n+import javax.swing.BorderFactory;\n+import javax.swing.JCheckBox;\n+import javax.swing.JFrame;\n+import javax.swing.JPanel;\n+import javax.swing.SwingUtilities;\n+import javax.swing.UIManager;\n+import javax.swing.UIManager.LookAndFeelInfo;\n+import javax.swing.UnsupportedLookAndFeelException;\n+import java.awt.BorderLayout;\n+import java.awt.Graphics2D;\n+import java.awt.Robot;\n+import java.awt.image.BufferedImage;\n+import java.io.File;\n+import java.io.IOException;\n+\n+\/*\n+ * @test\n+ * @key headful\n+ * @bug 8279614\n+ * @summary The left line of the TitledBorder is not painted on 150 scale factor\n+ * @requires (os.family == \"windows\")\n+ * @run main TitledBorderTest\n+ *\/\n+public class TitledBorderTest {\n+\n+  public static JFrame frame;\n+  public static JPanel parentPanel;\n+  public static JPanel childPanel;\n+\n+  public static void main(String[] args) throws Exception {\n+    LookAndFeelInfo laf = UIManager.getInstalledLookAndFeels()[3];\n+    System.out.println(laf);\n+    SwingUtilities.invokeAndWait(() -> setLookAndFeel(laf));\n+    SwingUtilities.invokeAndWait(() -> createAndShowGUI());\n+\n+    Robot robot = new Robot();\n+\n+    BufferedImage buff = new BufferedImage(frame.getWidth()*2, frame.getHeight()*2,\n+            BufferedImage.TYPE_INT_ARGB);\n+    Graphics2D graph = buff.createGraphics();\n+    graph.scale(1.5, 1.5);\n+    frame.paint(graph);\n+    graph.dispose();\n+\n+    robot.waitForIdle();\n+    boolean testFail = true;\n+    for (int i = 15; i < 25 && testFail == true; i++) {\n+      for (int j = 80; j < 100; j++) {\n+        if (buff.getRGB(i, j) == -6250336) {\n+          System.out.println(i + \" \" + j + \" Color \" + buff.getRGB(i, j));\n+          testFail = false;\n+          break;\n+        }\n+      }\n+    }\n+\n+    if (testFail) {\n+      saveImage(buff, \"test.png\");\n+      throw new RuntimeException(\"Border was clipped or overdrawn.\");\n+    }\n+\n+    frame.dispose();\n+  }\n+\n+  private static void createAndShowGUI() {\n+    frame = new JFrame(\"Swing Test\");\n+    frame.setSize(new java.awt.Dimension(300, 200));\n+    frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);\n+\n+    parentPanel = new JPanel(new BorderLayout());\n+    parentPanel.setBorder(BorderFactory.createEmptyBorder(5, 5, 5, 5));\n+\n+    childPanel = new JPanel(new BorderLayout());\n+    childPanel.setBorder(BorderFactory.createTitledBorder(\"Title\"));\n+    childPanel.add(new JCheckBox(), BorderLayout.CENTER);\n+\n+    parentPanel.add(childPanel, BorderLayout.CENTER);\n+\n+    frame.getContentPane().add(parentPanel, BorderLayout.CENTER);\n+\n+    frame.pack();\n+    frame.setLocationRelativeTo(null);\n+    frame.setVisible(true);\n+  }\n+\n+  private static void saveImage(BufferedImage image, String filename) {\n+    try {\n+      ImageIO.write(image, \"png\", new File(filename));\n+    } catch (IOException e) {\n+      \/\/ Donâ€™t propagate the exception\n+      e.printStackTrace();\n+    }\n+  }\n+\n+  private static void setLookAndFeel(UIManager.LookAndFeelInfo laf) {\n+    try {\n+      UIManager.setLookAndFeel(laf.getClassName());\n+      System.out.println(laf.getName());\n+    } catch (UnsupportedLookAndFeelException ignored){\n+      System.out.println(\"Unsupported LookAndFeel: \" + laf.getClassName());\n+    } catch (ClassNotFoundException | InstantiationException |\n+            IllegalAccessException e) {\n+      throw new RuntimeException(e);\n+    }\n+  }\n+}\n","filename":"test\/jdk\/java\/awt\/TitledBorder\/TitledBorderTest.java","additions":131,"deletions":0,"binary":false,"changes":131,"status":"added"}]}