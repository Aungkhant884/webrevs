{"files":[{"patch":"@@ -1767,1 +1767,10 @@\n-static bool _print_ascii_file(const char* filename, outputStream* st, const char* hdr = nullptr) {\n+static unsigned count_newlines(const char* s) {\n+  unsigned n = 0;\n+  for (const char* s2 = strchr(s, '\\n');\n+       s2 != nullptr; s2 = strchr(s2 + 1, '\\n')) {\n+    n++;\n+  }\n+  return n;\n+}\n+\n+static bool _print_ascii_file(const char* filename, outputStream* st, unsigned* num_lines = nullptr, const char* hdr = nullptr) {\n@@ -1780,0 +1789,1 @@\n+  unsigned lines = 0;\n@@ -1782,0 +1792,8 @@\n+    \/\/ count newlines\n+    if (num_lines != nullptr) {\n+      lines += count_newlines(buf);\n+    }\n+  }\n+\n+  if (num_lines != nullptr) {\n+    (*num_lines) = lines;\n@@ -1803,2 +1821,2 @@\n-\n-  if (!_print_ascii_file(fname, st)) {\n+  unsigned num = 0;\n+  if (!_print_ascii_file(fname, st, &num)) {\n@@ -1807,0 +1825,1 @@\n+  st->print_cr(\"Total number of mappings: %u\", num);\n@@ -2153,1 +2172,1 @@\n-  return _print_ascii_file(\"\/etc\/ld.so.preload\", st, \"\/etc\/ld.so.preload:\");\n+  return _print_ascii_file(\"\/etc\/ld.so.preload\", st, nullptr, \"\/etc\/ld.so.preload:\");\n","filename":"src\/hotspot\/os\/linux\/os_linux.cpp","additions":23,"deletions":4,"binary":false,"changes":27,"status":"modified"}]}