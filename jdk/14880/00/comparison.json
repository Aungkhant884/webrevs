{"files":[{"patch":"@@ -57,1 +57,1 @@\n-} TimerName;\n+} TimerId;\n@@ -81,1 +81,2 @@\n-  TimerName _timer;\n+  TimerId _timer_id;\n+  bool _dolog;\n@@ -84,3 +85,3 @@\n-  PhaseTraceTime(TimerName timer)\n-  : TraceTime(\"\", &timers[timer], CITime || CITimeEach, Verbose),\n-    _log(nullptr), _timer(timer)\n+  PhaseTraceTime(TimerId timer_id)\n+  : TraceTime(timer_name[timer_id], &timers[timer_id], CITime, CITimeVerbose),\n+    _log(nullptr), _timer_id(timer_id), _dolog(CITimeVerbose)\n@@ -88,1 +89,2 @@\n-    if (Compilation::current() != nullptr) {\n+    if (_dolog) {\n+      assert(Compilation::current() != nullptr, \"sanity check\");\n@@ -93,1 +95,1 @@\n-      _log->begin_head(\"phase name='%s'\", timer_name[_timer]);\n+      _log->begin_head(\"phase name='%s'\", timer_name[_timer_id]);\n@@ -101,1 +103,1 @@\n-      _log->done(\"phase name='%s'\", timer_name[_timer]);\n+      _log->done(\"phase name='%s'\", timer_name[_timer_id]);\n@@ -590,1 +592,0 @@\n-  PhaseTraceTime timeit(_t_compile);\n@@ -595,0 +596,1 @@\n+  PhaseTraceTime timeit(_t_compile);\n","filename":"src\/hotspot\/share\/c1\/c1_Compilation.cpp","additions":11,"deletions":9,"binary":false,"changes":20,"status":"modified"},{"patch":"@@ -670,7 +670,0 @@\n-  if (CITimeVerbose) {\n-    tty->print(\" \");\n-    target->holder()->name()->print();\n-    tty->print(\".\");\n-    target->print_short_name();\n-    tty->print(\"  \");\n-  }\n@@ -4334,1 +4327,1 @@\n-    _phase_name(name), _dolog(CITimeVerbose)\n+    _compile(nullptr), _log(nullptr), _phase_name(name), _dolog(CITimeVerbose)\n@@ -4337,5 +4330,2 @@\n-    C = Compile::current();\n-    _log = C->log();\n-  } else {\n-    C = nullptr;\n-    _log = nullptr;\n+    _compile = Compile::current();\n+    _log = _compile->log();\n@@ -4344,1 +4334,1 @@\n-    _log->begin_head(\"phase name='%s' nodes='%d' live='%d'\", _phase_name, C->unique(), C->live_nodes());\n+    _log->begin_head(\"phase name='%s' nodes='%d' live='%d'\", _phase_name, _compile->unique(), _compile->live_nodes());\n@@ -4351,8 +4341,0 @@\n-\n-  C = Compile::current();\n-  if (_dolog) {\n-    _log = C->log();\n-  } else {\n-    _log = nullptr;\n-  }\n-\n@@ -4362,1 +4344,1 @@\n-                  _phase_name, C->unique(), C->live_nodes(), C->count_live_nodes_by_graph_walk());\n+                  _phase_name, _compile->unique(), _compile->live_nodes(), _compile->count_live_nodes_by_graph_walk());\n@@ -4371,1 +4353,1 @@\n-    _log->done(\"phase name='%s' nodes='%d' live='%d'\", _phase_name, C->unique(), C->live_nodes());\n+    _log->done(\"phase name='%s' nodes='%d' live='%d'\", _phase_name, _compile->unique(), _compile->live_nodes());\n","filename":"src\/hotspot\/share\/opto\/compile.cpp","additions":6,"deletions":24,"binary":false,"changes":30,"status":"modified"},{"patch":"@@ -227,1 +227,1 @@\n-    Compile*    C;\n+    Compile*    _compile;\n","filename":"src\/hotspot\/share\/opto\/compile.hpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -360,1 +360,1 @@\n-    int n = os::snprintf(buffer, sizeof(buffer), \"%.*s_done\", (int)kind_len, kind);\n+    int n = os::snprintf(buffer, sizeof(buffer), \"%.*s_done%s\", (int)kind_len, kind, kind + kind_len);\n@@ -364,1 +364,1 @@\n-    int n = os::snprintf(buffer, sizeof(buffer), \"%s_done%s\", kind, kind + kind_len);\n+    int n = os::snprintf(buffer, sizeof(buffer), \"%s_done\", kind);\n","filename":"src\/hotspot\/share\/utilities\/xmlstream.cpp","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"}]}