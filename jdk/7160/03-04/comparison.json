{"files":[{"patch":"@@ -675,1 +675,1 @@\n-class FindInRegionWalker : public VirtualMemoryWalker {\n+class FindAndSnapshotRegionWalker : public VirtualMemoryWalker {\n@@ -677,2 +677,3 @@\n-  const address               _p;\n-  const ReservedMemoryRegion* _region;\n+  ReservedMemoryRegion& _region;\n+  const address         _p;\n+  bool                  _found_region;\n@@ -680,1 +681,2 @@\n-  FindInRegionWalker(void* p) : _p((address)p), _region(nullptr) { }\n+  FindAndSnapshotRegionWalker(void* p, ReservedMemoryRegion& region) :\n+    _region(region), _p((address)p), _found_region(false) { }\n@@ -684,1 +686,2 @@\n-      _region = rgn;\n+      _region = *rgn;\n+      _found_region = true;\n@@ -689,2 +692,1 @@\n-\n-  const ReservedMemoryRegion* region() const { return _region; }\n+  bool found_region() const { return _found_region; }\n@@ -693,2 +695,2 @@\n-const ReservedMemoryRegion* VirtualMemoryTracker::find_region(void* p) {\n-  FindInRegionWalker walker(p);\n+const bool VirtualMemoryTracker::snapshot_region_contains(void* p, ReservedMemoryRegion& region) {\n+  FindAndSnapshotRegionWalker walker(p, region);\n@@ -696,1 +698,1 @@\n-  return walker.region();\n+  return walker.found_region();\n","filename":"src\/hotspot\/share\/services\/virtualMemoryTracker.cpp","additions":12,"deletions":10,"binary":false,"changes":22,"status":"modified"},{"patch":"@@ -390,1 +390,1 @@\n-  static const ReservedMemoryRegion* find_region(void* p);\n+  static const bool snapshot_region_contains(void* p, ReservedMemoryRegion& region);\n","filename":"src\/hotspot\/share\/services\/virtualMemoryTracker.hpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -490,3 +490,3 @@\n-      \/\/ Check if it is in a known mmap'd memory region\n-      const ReservedMemoryRegion* rgn = VirtualMemoryTracker::find_region(p);\n-      if (rgn != nullptr) {\n+      ReservedMemoryRegion region(0, 0);\n+      \/\/ Check and snapshot a mmap'd region that contains the pointer\n+      if (VirtualMemoryTracker::snapshot_region_contains(p, region)) {\n@@ -494,1 +494,1 @@\n-          p2i(p), p2i(rgn->base()), p2i(rgn->base() + rgn->size()), rgn->flag_name());\n+          p2i(p), p2i(region.base()), p2i(region.base() + region.size()), region.flag_name());\n@@ -496,1 +496,1 @@\n-          rgn->call_stack()->print_on(tty);\n+          region.call_stack()->print_on(tty);\n","filename":"src\/hotspot\/share\/utilities\/debug.cpp","additions":5,"deletions":5,"binary":false,"changes":10,"status":"modified"}]}