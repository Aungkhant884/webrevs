{"files":[{"patch":"@@ -41,3 +41,0 @@\n-  CardTableBarrierSet* ctbs = barrier_set_cast<CardTableBarrierSet>(bs);\n-  CardTable* ct = ctbs->card_table();\n-\n@@ -58,3 +55,0 @@\n-    if (ct->scanned_concurrently()) {\n-      __ membar(Assembler::StoreStore);\n-    }\n@@ -67,4 +61,0 @@\n-  BarrierSet* bs = BarrierSet::barrier_set();\n-  CardTableBarrierSet* ctbs = barrier_set_cast<CardTableBarrierSet>(bs);\n-  CardTable* ct = ctbs->card_table();\n-\n@@ -84,3 +74,0 @@\n-  if (ct->scanned_concurrently()) {\n-    __ membar(__ StoreStore);\n-  }\n","filename":"src\/hotspot\/cpu\/aarch64\/gc\/shared\/cardTableBarrierSetAssembler_aarch64.cpp","additions":0,"deletions":13,"binary":false,"changes":13,"status":"modified"},{"patch":"@@ -369,3 +369,0 @@\n-  CardTableBarrierSet* ctbs = barrier_set_cast<CardTableBarrierSet>(BarrierSet::barrier_set());\n-  CardTable* ct = ctbs->card_table();\n-\n@@ -385,3 +382,0 @@\n-    if (ct->scanned_concurrently()) {\n-      __ membar_storeload();\n-    }\n@@ -397,3 +391,0 @@\n-    if (ct->scanned_concurrently()) {\n-      __ membar_storestore();\n-    }\n","filename":"src\/hotspot\/cpu\/arm\/c1_LIRGenerator_arm.cpp","additions":0,"deletions":9,"binary":false,"changes":9,"status":"modified"},{"patch":"@@ -131,3 +131,0 @@\n-  CardTableBarrierSet* ctbs = barrier_set_cast<CardTableBarrierSet>(bs);\n-  CardTable* ct = ctbs->card_table();\n-\n@@ -138,3 +135,0 @@\n-    if (ct->scanned_concurrently()) {\n-      __ membar(MacroAssembler::Membar_mask_bits(MacroAssembler::StoreLoad), noreg);\n-    }\n@@ -150,3 +144,0 @@\n-    if (ct->scanned_concurrently()) {\n-      __ membar(MacroAssembler::Membar_mask_bits(MacroAssembler::StoreStore), noreg);\n-    }\n","filename":"src\/hotspot\/cpu\/arm\/gc\/shared\/cardTableBarrierSetAssembler_arm.cpp","additions":0,"deletions":9,"binary":false,"changes":9,"status":"modified"},{"patch":"@@ -46,2 +46,0 @@\n-  CardTableBarrierSet* ctbs = barrier_set_cast<CardTableBarrierSet>(BarrierSet::barrier_set());\n-  CardTable* ct = ctbs->card_table();\n@@ -52,2 +50,0 @@\n-  if (ct->scanned_concurrently()) { __ membar(Assembler::StoreStore); }\n-\n@@ -77,2 +73,0 @@\n-  CardTableBarrierSet* ctbs = barrier_set_cast<CardTableBarrierSet>(BarrierSet::barrier_set());\n-  CardTable* ct = ctbs->card_table();\n@@ -83,1 +77,0 @@\n-  if (ct->scanned_concurrently()) { __ membar(Assembler::StoreStore); }\n","filename":"src\/hotspot\/cpu\/ppc\/gc\/shared\/cardTableBarrierSetAssembler_ppc.cpp","additions":0,"deletions":7,"binary":false,"changes":7,"status":"modified"},{"patch":"@@ -121,3 +121,0 @@\n-    if (ct->scanned_concurrently()) {\n-      __ membar(Assembler::StoreLoad);\n-    }\n","filename":"src\/hotspot\/cpu\/x86\/gc\/shared\/cardTableBarrierSetAssembler_x86.cpp","additions":0,"deletions":3,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -56,0 +56,4 @@\n+  virtual bool card_mark_must_follow_store() const {\n+    return true;\n+  }\n+\n","filename":"src\/hotspot\/share\/gc\/g1\/g1BarrierSet.hpp","additions":4,"deletions":0,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -82,1 +82,1 @@\n-  G1CardTable(MemRegion whole_heap): CardTable(whole_heap, \/* scanned concurrently *\/ true), _listener() {\n+  G1CardTable(MemRegion whole_heap): CardTable(whole_heap), _listener() {\n","filename":"src\/hotspot\/share\/gc\/g1\/g1CardTable.hpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -54,1 +54,1 @@\n-  PSCardTable(MemRegion whole_heap) : CardTable(whole_heap, \/* scanned_concurrently *\/ false) {}\n+  PSCardTable(MemRegion whole_heap) : CardTable(whole_heap) {}\n","filename":"src\/hotspot\/share\/gc\/parallel\/psCardTable.hpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -86,3 +86,0 @@\n-    if (ct->scanned_concurrently()) {\n-      __ membar_storeload();\n-    }\n@@ -97,3 +94,0 @@\n-    if (ct->scanned_concurrently()) {\n-      __ membar_storestore();\n-    }\n","filename":"src\/hotspot\/share\/gc\/shared\/c1\/cardTableBarrierSetC1.cpp","additions":0,"deletions":6,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -61,2 +61,0 @@\n-  CardTableBarrierSet* ctbs = barrier_set_cast<CardTableBarrierSet>(BarrierSet::barrier_set());\n-  CardTable* ct = ctbs->card_table();\n@@ -108,4 +106,0 @@\n-    if (ct->scanned_concurrently()) {\n-      kit->insert_mem_bar(Op_MemBarVolatile, oop_store);\n-      __ sync_kit(kit);\n-    }\n@@ -124,6 +118,1 @@\n-  if (!ct->scanned_concurrently()) {\n-    __ store(__ ctrl(), card_adr, zero, T_BYTE, adr_type, MemNode::unordered);\n-  } else {\n-    \/\/ Specialized path for CM store barrier\n-    __ storeCM(__ ctrl(), card_adr, zero, oop_store, adr_idx, T_BYTE, adr_type);\n-  }\n+  __ store(__ ctrl(), card_adr, zero, T_BYTE, adr_type, MemNode::unordered);\n","filename":"src\/hotspot\/share\/gc\/shared\/c2\/cardTableBarrierSetC2.cpp","additions":1,"deletions":12,"binary":false,"changes":13,"status":"modified"},{"patch":"@@ -44,2 +44,1 @@\n-CardTable::CardTable(MemRegion whole_heap, bool conc_scan) :\n-  _scanned_concurrently(conc_scan),\n+CardTable::CardTable(MemRegion whole_heap) :\n","filename":"src\/hotspot\/share\/gc\/shared\/cardTable.cpp","additions":1,"deletions":2,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -46,1 +46,0 @@\n-  const bool      _scanned_concurrently;\n@@ -116,1 +115,1 @@\n-  CardTable(MemRegion whole_heap, bool conc_scan);\n+  CardTable(MemRegion whole_heap);\n@@ -248,1 +247,0 @@\n-  bool scanned_concurrently() const { return _scanned_concurrently; }\n","filename":"src\/hotspot\/share\/gc\/shared\/cardTable.hpp","additions":1,"deletions":3,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -195,1 +195,1 @@\n- return _card_table->scanned_concurrently();\n+  return false;\n","filename":"src\/hotspot\/share\/gc\/shared\/cardTableBarrierSet.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -35,6 +35,1 @@\n-  if (_card_table->scanned_concurrently()) {\n-    \/\/ Perform a releasing store if the card table is scanned concurrently\n-    Atomic::release_store(byte, CardTable::dirty_card_val());\n-  } else {\n-    *byte = CardTable::dirty_card_val();\n-  }\n+  *byte = CardTable::dirty_card_val();\n","filename":"src\/hotspot\/share\/gc\/shared\/cardTableBarrierSet.inline.hpp","additions":1,"deletions":6,"binary":false,"changes":7,"status":"modified"},{"patch":"@@ -437,2 +437,2 @@\n-CardTableRS::CardTableRS(MemRegion whole_heap, bool scanned_concurrently) :\n-  CardTable(whole_heap, scanned_concurrently) { }\n+CardTableRS::CardTableRS(MemRegion whole_heap) :\n+  CardTable(whole_heap) { }\n","filename":"src\/hotspot\/share\/gc\/shared\/cardTableRS.cpp","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -48,1 +48,1 @@\n-  CardTableRS(MemRegion whole_heap, bool scanned_concurrently);\n+  CardTableRS(MemRegion whole_heap);\n","filename":"src\/hotspot\/share\/gc\/shared\/cardTableRS.hpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -145,1 +145,1 @@\n-  return new CardTableRS(reserved_region, false \/* scan_concurrently *\/);\n+  return new CardTableRS(reserved_region);\n","filename":"src\/hotspot\/share\/gc\/shared\/genCollectedHeap.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"}]}