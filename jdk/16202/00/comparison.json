{"files":[{"patch":"@@ -136,1 +136,1 @@\n-     * @since 21\n+     * @since 22\n@@ -357,1 +357,1 @@\n-     * @since 21\n+     * @since 22\n@@ -381,1 +381,1 @@\n-     * @since 21\n+     * @since 22\n","filename":"src\/java.base\/share\/classes\/java\/lang\/StringConcatHelper.java","additions":3,"deletions":3,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -112,1 +112,1 @@\n- * @since 21\n+ * @since 22\n","filename":"src\/java.base\/share\/classes\/java\/lang\/StringTemplate.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -119,1 +119,1 @@\n-     * @since 21\n+     * @since 22\n@@ -1060,1 +1060,1 @@\n-     * @since 21\n+     * @since 22\n@@ -1191,1 +1191,1 @@\n-     * @since 21\n+     * @since 22\n@@ -1268,1 +1268,1 @@\n-     * @since 21\n+     * @since 22\n","filename":"src\/java.base\/share\/classes\/java\/lang\/invoke\/StringConcatFactory.java","additions":4,"deletions":4,"binary":false,"changes":8,"status":"modified"},{"patch":"@@ -83,1 +83,1 @@\n- * @since 21\n+ * @since 22\n","filename":"src\/java.base\/share\/classes\/java\/lang\/runtime\/Carriers.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -48,1 +48,1 @@\n- * @since 21\n+ * @since 22\n","filename":"src\/java.base\/share\/classes\/java\/lang\/runtime\/StringTemplateImpl.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -41,1 +41,1 @@\n- * @since 21\n+ * @since 22\n","filename":"src\/java.base\/share\/classes\/java\/lang\/runtime\/StringTemplateImplFactory.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -96,1 +96,1 @@\n- * @since 21\n+ * @since 22\n","filename":"src\/java.base\/share\/classes\/java\/lang\/runtime\/TemplateRuntime.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -40,1 +40,1 @@\n- * @since 21\n+ * @since 22\n","filename":"src\/java.base\/share\/classes\/java\/lang\/runtime\/TemplateSupport.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -49,1 +49,1 @@\n- * @since 21\n+ * @since 22\n","filename":"src\/java.base\/share\/classes\/java\/util\/FormatItem.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -93,1 +93,1 @@\n- * @since 21\n+ * @since 22\n","filename":"src\/java.base\/share\/classes\/java\/util\/FormatProcessor.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -53,1 +53,1 @@\n- * @since 21\n+ * @since 22\n","filename":"src\/java.base\/share\/classes\/java\/util\/FormatterBuilder.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -422,0 +422,1 @@\n+    * @since 22\n@@ -428,0 +429,1 @@\n+    * @since 22\n@@ -434,0 +436,1 @@\n+     * @since 22\n","filename":"src\/java.base\/share\/classes\/jdk\/internal\/access\/JavaLangAccess.java","additions":3,"deletions":0,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -70,2 +70,1 @@\n-\n-        @JEP(number=430, title=\"String Templates\")\n+        @JEP(number=459, title=\"String Templates\", status=\"Second Preview\")\n","filename":"src\/java.base\/share\/classes\/jdk\/internal\/javac\/PreviewFeature.java","additions":1,"deletions":2,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -33,1 +33,1 @@\n- * @since 21\n+ * @since 22\n","filename":"src\/java.base\/share\/classes\/jdk\/internal\/util\/FormatConcatItem.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -35,1 +35,1 @@\n- * @since 21\n+ * @since 22\n","filename":"src\/jdk.compiler\/share\/classes\/com\/sun\/source\/tree\/StringTemplateTree.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -180,0 +180,1 @@\n+         * @since 22\n","filename":"src\/jdk.compiler\/share\/classes\/com\/sun\/source\/tree\/Tree.java","additions":1,"deletions":0,"binary":false,"changes":1,"status":"modified"},{"patch":"@@ -267,0 +267,1 @@\n+     * @since 22\n","filename":"src\/jdk.compiler\/share\/classes\/com\/sun\/source\/tree\/TreeVisitor.java","additions":1,"deletions":0,"binary":false,"changes":1,"status":"modified"},{"patch":"@@ -637,0 +637,1 @@\n+     * @since 22\n","filename":"src\/jdk.compiler\/share\/classes\/com\/sun\/source\/util\/SimpleTreeVisitor.java","additions":1,"deletions":0,"binary":false,"changes":1,"status":"modified"},{"patch":"@@ -786,0 +786,1 @@\n+     * @since 22\n","filename":"src\/jdk.compiler\/share\/classes\/com\/sun\/source\/util\/TreeScanner.java","additions":1,"deletions":0,"binary":false,"changes":1,"status":"modified"},{"patch":"@@ -247,1 +247,1 @@\n-        STRING_TEMPLATES(JDK21, Fragments.FeatureStringTemplates, DiagKind.PLURAL),\n+        STRING_TEMPLATES(JDK22, Fragments.FeatureStringTemplates, DiagKind.PLURAL),\n","filename":"src\/jdk.compiler\/share\/classes\/com\/sun\/tools\/javac\/code\/Source.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -5027,6 +5027,4 @@\n-        Type resultType = syms.stringTemplateType;\n-\n-        if (processor != null) {\n-            resultType = attribTree(processor, env, new ResultInfo(KindSelector.VAL, Type.noType));\n-            resultType = chk.checkProcessorType(processor, resultType, env);\n-        }\n+        Type processorType = attribTree(processor, env, new ResultInfo(KindSelector.VAL, Type.noType));\n+        chk.checkProcessorType(processor, processorType, env);\n+        Type processMethodType = getProcessMethodType(tree, processorType);\n+        Type resultType = processMethodType.getReturnType();\n@@ -5042,1 +5040,0 @@\n-\n@@ -5046,0 +5043,7 @@\n+    private Type getProcessMethodType(JCStringTemplate tree, Type processorType) {\n+        MethodSymbol processSymbol = rs.resolveInternalMethod(tree.pos(),\n+                env, types.skipTypeVars(processorType, false),\n+                names.process, List.of(syms.stringTemplateType), List.nil());\n+        return types.memberType(processorType, processSymbol);\n+    }\n+\n","filename":"src\/jdk.compiler\/share\/classes\/com\/sun\/tools\/javac\/comp\/Attr.java","additions":11,"deletions":7,"binary":false,"changes":18,"status":"modified"},{"patch":"@@ -4373,2 +4373,1 @@\n-                log.error(DiagnosticFlag.RESOLVE_ERROR, processor.pos,\n-                        Errors.ProcessorTypeCannotBeARawType(processorType.tsym));\n+                resultType = syms.objectType;\n","filename":"src\/jdk.compiler\/share\/classes\/com\/sun\/tools\/javac\/comp\/Check.java","additions":1,"deletions":2,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -1682,0 +1682,1 @@\n+            Type processMethodType = getProcessMethodType(tree, processor.type);\n@@ -1683,15 +1684,2 @@\n-            if (processor != null) {\n-                scan(processor);\n-                Type interfaceType = types.asSuper(processor.type, syms.processorType.tsym);\n-\n-                if (interfaceType != null) {\n-                    List<Type> typeArguments = interfaceType.getTypeArguments();\n-\n-                    if (typeArguments.size() == 2) {\n-                        Type throwType = typeArguments.tail.head;\n-\n-                        if (throwType != null) {\n-                            markThrown(tree, throwType);\n-                        }\n-                    }\n-                }\n+            for (Type thrown : processMethodType.getThrownTypes()) {\n+                markThrown(tree, thrown);\n@@ -1703,0 +1691,7 @@\n+        private Type getProcessMethodType(JCStringTemplate tree, Type processorType) {\n+            MethodSymbol processSymbol = rs.resolveInternalMethod(tree.pos(),\n+                    attrEnv, types.skipTypeVars(processorType, false),\n+                    names.process, List.of(syms.stringTemplateType), List.nil());\n+            return types.memberType(processorType, processSymbol);\n+        }\n+\n","filename":"src\/jdk.compiler\/share\/classes\/com\/sun\/tools\/javac\/comp\/Flow.java","additions":10,"deletions":15,"binary":false,"changes":25,"status":"modified"},{"patch":"@@ -257,1 +257,6 @@\n-            if (processor instanceof JCIdent ident && ident.sym instanceof VarSymbol varSym) {\n+            Symbol sym = switch (processor) {\n+                case JCIdent ident -> ident.sym;\n+                case JCFieldAccess access -> access.sym;\n+                default -> null;\n+            };\n+            if (sym instanceof VarSymbol varSym) {\n@@ -268,2 +273,1 @@\n-            return processor != null &&\n-                   !useValuesList &&\n+            return !useValuesList &&\n@@ -281,1 +285,1 @@\n-            if (processor == null || isNamedProcessor(names.RAW)) {\n+            if (isNamedProcessor(names.RAW)) {\n","filename":"src\/jdk.compiler\/share\/classes\/com\/sun\/tools\/javac\/comp\/TransLiterals.java","additions":8,"deletions":4,"binary":false,"changes":12,"status":"modified"},{"patch":"@@ -1357,4 +1357,0 @@\n-# 0: symbol\n-compiler.err.processor.type.cannot.be.a.raw.type=\\\n-    processor type cannot be a raw type: {0}\n-\n","filename":"src\/jdk.compiler\/share\/classes\/com\/sun\/tools\/javac\/resources\/compiler.properties","additions":0,"deletions":4,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -1483,3 +1483,1 @@\n-            if (processor != null) {\n-                printExpr(processor);\n-            }\n+            printExpr(processor);\n","filename":"src\/jdk.compiler\/share\/classes\/com\/sun\/tools\/javac\/tree\/Pretty.java","additions":1,"deletions":3,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -551,5 +551,1 @@\n-                if (node.processor == null) {\n-                    return node.pos;\n-                } else {\n-                    return getStartPos(node.processor);\n-                }\n+                return node.processor == null ? node.pos : getStartPos(node.processor);\n","filename":"src\/jdk.compiler\/share\/classes\/com\/sun\/tools\/javac\/tree\/TreeInfo.java","additions":1,"deletions":5,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -25,0 +25,2 @@\n+ \/\/ key: compiler.err.cant.resolve.location.args\n+ \/\/ key: compiler.misc.location\n","filename":"test\/langtools\/tools\/javac\/diags\/examples\/StringTemplateNotProcessor.java","additions":2,"deletions":0,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -28,1 +28,0 @@\n- \/\/ key: compiler.err.processor.type.cannot.be.a.raw.type\n","filename":"test\/langtools\/tools\/javac\/diags\/examples\/StringTemplateRawProcessor.java","additions":0,"deletions":1,"binary":false,"changes":1,"status":"modified"}]}