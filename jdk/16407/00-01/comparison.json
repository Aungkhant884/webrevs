{"files":[{"patch":"@@ -89,1 +89,3 @@\n-            t.typarams_field = rewriteTypeParameters(t.typarams_field, CLASS_TYPE_PARAMETER_BOUND);\n+            if (t.typarams_field != null) {\n+                t.typarams_field = rewriteTypeParameters(t.typarams_field, CLASS_TYPE_PARAMETER_BOUND);\n+            }\n@@ -203,1 +205,0 @@\n-            Assert.check(attributesByPath.isEmpty(), \"Failed to locate types for all type paths\");\n@@ -312,1 +313,11 @@\n-            return attributes != null ? mapped.annotatedType(attributes) : mapped;\n+            if (attributes == null) {\n+                return mapped;\n+            }\n+            \/\/ Runtime-visible and -invisible annotations are completed separately, so if the same type has annotations\n+            \/\/ from both it will get annotated twice.\n+            TypeMetadata.Annotations existing = mapped.getMetadata(TypeMetadata.Annotations.class);\n+            if (existing != null) {\n+                existing.annotationBuffer().addAll(attributes);\n+                return mapped;\n+            }\n+            return mapped.addMetadata(new TypeMetadata.Annotations(attributes));\n","filename":"src\/jdk.compiler\/share\/classes\/com\/sun\/tools\/javac\/code\/TypeAnnotationMapper.java","additions":14,"deletions":3,"binary":false,"changes":17,"status":"modified"}]}