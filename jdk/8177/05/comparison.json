{"files":[{"patch":"@@ -361,0 +361,14 @@\n+\n+      # gcc assembly files must contain an appropriate relative .file\n+      # path for reproducible builds.\n+      ifeq ($(TOOLCHAIN_TYPE), gcc)\n+        # If no absolute paths allowed, work out relative source file path\n+        # for assembly .file substitution, otherwise use full file path\n+        ifeq ($(ALLOW_ABSOLUTE_PATHS_IN_OUTPUT), false)\n+          $1_REL_ASM_SRC := $$(call RelativePath, $$($1_FILE), $(WORKSPACE_ROOT))\n+        else\n+          $1_REL_ASM_SRC := $$($1_FILE)\n+        endif\n+        $1_FLAGS := $$($1_FLAGS) -DASSEMBLY_SRC_FILE='\"$$($1_REL_ASM_SRC)\"' \\\n+            -include $(TOPDIR)\/make\/data\/autoheaders\/assemblyprefix.h\n+      endif\n@@ -1152,13 +1166,0 @@\n-    # Debuginfo of ASM objects always embeds the absolute object path,\n-    # as ASM debuginfo paths do not get prefix mapped.\n-    # So for reproducible builds use relative paths to ensure a reproducible\n-    # debuginfo and libs, when creating debug symbols.\n-    ifeq ($$(ENABLE_REPRODUCIBLE_BUILD), true)\n-      ifeq ($(call isTargetOs, linux), true)\n-        ifeq ($$($1_COMPILE_WITH_DEBUG_SYMBOLS), true)\n-          $1_LINK_OBJS_RELATIVE := true\n-          $1_ALL_OBJS_RELATIVE := $$(patsubst $$(OUTPUTDIR)\/%, %, $$($1_ALL_OBJS))\n-        endif\n-      endif\n-    endif\n-\n","filename":"make\/common\/NativeCompilation.gmk","additions":14,"deletions":13,"binary":false,"changes":27,"status":"modified"},{"patch":"@@ -0,0 +1,29 @@\n+#\n+# Copyright (c) 2022, Oracle and\/or its affiliates. All rights reserved.\n+# DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+#\n+# This code is free software; you can redistribute it and\/or modify it\n+# under the terms of the GNU General Public License version 2 only, as\n+# published by the Free Software Foundation.\n+#\n+# This code is distributed in the hope that it will be useful, but WITHOUT\n+# ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+# FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+# version 2 for more details (a copy is included in the LICENSE file that\n+# accompanied this code).\n+#\n+# You should have received a copy of the GNU General Public License version\n+# 2 along with this work; if not, write to the Free Software Foundation,\n+# Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n+#\n+# Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n+# or visit www.oracle.com if you need additional information or have any\n+# questions.\n+#\n+\n+\/\/ ASSEMBLY_SRC_FILE gets replaced by relative or absolute file path\n+\/\/ in NativeCompilation.gmk for gcc tooling on Linux. This ensures a\n+\/\/ reproducible object file through a predictable value of the STT_FILE\n+\/\/ symbol, and subsequently a reproducible .debuginfo.\n+.file ASSEMBLY_SRC_FILE\n+\n","filename":"make\/data\/autoheaders\/assemblyprefix.h","additions":29,"deletions":0,"binary":false,"changes":29,"status":"added"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2018, 2021, Intel Corporation. All rights reserved.\n+ * Copyright (c) 2018, 2022, Intel Corporation. All rights reserved.\n@@ -31,1 +31,0 @@\n-\t.file \"svml_d_acos.c\"\n","filename":"src\/jdk.incubator.vector\/linux\/native\/libjsvml\/jsvml_d_acos_linux_x86.S","additions":1,"deletions":2,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2018, 2021, Intel Corporation. All rights reserved.\n+ * Copyright (c) 2018, 2022, Intel Corporation. All rights reserved.\n@@ -31,1 +31,0 @@\n-\t.file \"svml_d_asin.c\"\n","filename":"src\/jdk.incubator.vector\/linux\/native\/libjsvml\/jsvml_d_asin_linux_x86.S","additions":1,"deletions":2,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2018, 2021, Intel Corporation. All rights reserved.\n+ * Copyright (c) 2018, 2022, Intel Corporation. All rights reserved.\n@@ -31,1 +31,0 @@\n-\t.file \"svml_d_atan2.c\"\n","filename":"src\/jdk.incubator.vector\/linux\/native\/libjsvml\/jsvml_d_atan2_linux_x86.S","additions":1,"deletions":2,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2018, 2021, Intel Corporation. All rights reserved.\n+ * Copyright (c) 2018, 2022, Intel Corporation. All rights reserved.\n@@ -31,1 +31,0 @@\n-\t.file \"svml_d_atan.c\"\n","filename":"src\/jdk.incubator.vector\/linux\/native\/libjsvml\/jsvml_d_atan_linux_x86.S","additions":1,"deletions":2,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2018, 2021, Intel Corporation. All rights reserved.\n+ * Copyright (c) 2018, 2022, Intel Corporation. All rights reserved.\n@@ -31,1 +31,0 @@\n-\t.file \"svml_d_cbrt.c\"\n","filename":"src\/jdk.incubator.vector\/linux\/native\/libjsvml\/jsvml_d_cbrt_linux_x86.S","additions":1,"deletions":2,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2018, 2021, Intel Corporation. All rights reserved.\n+ * Copyright (c) 2018, 2022, Intel Corporation. All rights reserved.\n@@ -31,1 +31,0 @@\n-\t.file \"svml_d_cos.c\"\n","filename":"src\/jdk.incubator.vector\/linux\/native\/libjsvml\/jsvml_d_cos_linux_x86.S","additions":1,"deletions":2,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2018, 2021, Intel Corporation. All rights reserved.\n+ * Copyright (c) 2018, 2022, Intel Corporation. All rights reserved.\n@@ -31,1 +31,0 @@\n-\t.file \"svml_d_cosh.c\"\n","filename":"src\/jdk.incubator.vector\/linux\/native\/libjsvml\/jsvml_d_cosh_linux_x86.S","additions":1,"deletions":2,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2018, 2021, Intel Corporation. All rights reserved.\n+ * Copyright (c) 2018, 2022, Intel Corporation. All rights reserved.\n@@ -31,1 +31,0 @@\n-\t.file \"svml_d_exp.c\"\n","filename":"src\/jdk.incubator.vector\/linux\/native\/libjsvml\/jsvml_d_exp_linux_x86.S","additions":1,"deletions":2,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2018, 2021, Intel Corporation. All rights reserved.\n+ * Copyright (c) 2018, 2022, Intel Corporation. All rights reserved.\n@@ -31,1 +31,0 @@\n-\t.file \"svml_d_expm1.c\"\n","filename":"src\/jdk.incubator.vector\/linux\/native\/libjsvml\/jsvml_d_expm1_linux_x86.S","additions":1,"deletions":2,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2018, 2021, Intel Corporation. All rights reserved.\n+ * Copyright (c) 2018, 2022, Intel Corporation. All rights reserved.\n@@ -31,1 +31,0 @@\n-\t.file \"svml_d_hypot.c\"\n","filename":"src\/jdk.incubator.vector\/linux\/native\/libjsvml\/jsvml_d_hypot_linux_x86.S","additions":1,"deletions":2,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2018, 2021, Intel Corporation. All rights reserved.\n+ * Copyright (c) 2018, 2022, Intel Corporation. All rights reserved.\n@@ -31,1 +31,0 @@\n-\t.file \"svml_d_log10.c\"\n","filename":"src\/jdk.incubator.vector\/linux\/native\/libjsvml\/jsvml_d_log10_linux_x86.S","additions":1,"deletions":2,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2018, 2021, Intel Corporation. All rights reserved.\n+ * Copyright (c) 2018, 2022, Intel Corporation. All rights reserved.\n@@ -31,1 +31,0 @@\n-\t.file \"svml_d_log1p.c\"\n","filename":"src\/jdk.incubator.vector\/linux\/native\/libjsvml\/jsvml_d_log1p_linux_x86.S","additions":1,"deletions":2,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2018, 2021, Intel Corporation. All rights reserved.\n+ * Copyright (c) 2018, 2022, Intel Corporation. All rights reserved.\n@@ -31,1 +31,0 @@\n-\t.file \"svml_d_log.c\"\n","filename":"src\/jdk.incubator.vector\/linux\/native\/libjsvml\/jsvml_d_log_linux_x86.S","additions":1,"deletions":2,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2018, 2021, Intel Corporation. All rights reserved.\n+ * Copyright (c) 2018, 2022, Intel Corporation. All rights reserved.\n@@ -31,1 +31,0 @@\n-\t.file \"svml_d_pow.c\"\n","filename":"src\/jdk.incubator.vector\/linux\/native\/libjsvml\/jsvml_d_pow_linux_x86.S","additions":1,"deletions":2,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2018, 2021, Intel Corporation. All rights reserved.\n+ * Copyright (c) 2018, 2022, Intel Corporation. All rights reserved.\n@@ -31,1 +31,0 @@\n-\t.file \"svml_d_sin.c\"\n","filename":"src\/jdk.incubator.vector\/linux\/native\/libjsvml\/jsvml_d_sin_linux_x86.S","additions":1,"deletions":2,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2018, 2021, Intel Corporation. All rights reserved.\n+ * Copyright (c) 2018, 2022, Intel Corporation. All rights reserved.\n@@ -31,1 +31,0 @@\n-\t.file \"svml_d_sinh.c\"\n","filename":"src\/jdk.incubator.vector\/linux\/native\/libjsvml\/jsvml_d_sinh_linux_x86.S","additions":1,"deletions":2,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2018, 2021, Intel Corporation. All rights reserved.\n+ * Copyright (c) 2018, 2022, Intel Corporation. All rights reserved.\n@@ -31,1 +31,0 @@\n-\t.file \"svml_d_tan.c\"\n","filename":"src\/jdk.incubator.vector\/linux\/native\/libjsvml\/jsvml_d_tan_linux_x86.S","additions":1,"deletions":2,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2018, 2021, Intel Corporation. All rights reserved.\n+ * Copyright (c) 2018, 2022, Intel Corporation. All rights reserved.\n@@ -31,1 +31,0 @@\n-\t.file \"svml_d_tanh.c\"\n","filename":"src\/jdk.incubator.vector\/linux\/native\/libjsvml\/jsvml_d_tanh_linux_x86.S","additions":1,"deletions":2,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2018, 2021, Intel Corporation. All rights reserved.\n+ * Copyright (c) 2018, 2022, Intel Corporation. All rights reserved.\n@@ -31,1 +31,0 @@\n-\t.file \"svml_s_acos.c\"\n","filename":"src\/jdk.incubator.vector\/linux\/native\/libjsvml\/jsvml_s_acos_linux_x86.S","additions":1,"deletions":2,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2018, 2021, Intel Corporation. All rights reserved.\n+ * Copyright (c) 2018, 2022, Intel Corporation. All rights reserved.\n@@ -31,1 +31,0 @@\n-\t.file \"svml_s_asin.c\"\n","filename":"src\/jdk.incubator.vector\/linux\/native\/libjsvml\/jsvml_s_asin_linux_x86.S","additions":1,"deletions":2,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2018, 2021, Intel Corporation. All rights reserved.\n+ * Copyright (c) 2018, 2022, Intel Corporation. All rights reserved.\n@@ -31,1 +31,0 @@\n-\t.file \"svml_s_atan2.c\"\n","filename":"src\/jdk.incubator.vector\/linux\/native\/libjsvml\/jsvml_s_atan2_linux_x86.S","additions":1,"deletions":2,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2018, 2021, Intel Corporation. All rights reserved.\n+ * Copyright (c) 2018, 2022, Intel Corporation. All rights reserved.\n@@ -31,1 +31,0 @@\n-\t.file \"svml_s_atan.c\"\n","filename":"src\/jdk.incubator.vector\/linux\/native\/libjsvml\/jsvml_s_atan_linux_x86.S","additions":1,"deletions":2,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2018, 2021, Intel Corporation. All rights reserved.\n+ * Copyright (c) 2018, 2022, Intel Corporation. All rights reserved.\n@@ -31,1 +31,0 @@\n-\t.file \"svml_s_cbrt.c\"\n","filename":"src\/jdk.incubator.vector\/linux\/native\/libjsvml\/jsvml_s_cbrt_linux_x86.S","additions":1,"deletions":2,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2018, 2021, Intel Corporation. All rights reserved.\n+ * Copyright (c) 2018, 2022, Intel Corporation. All rights reserved.\n@@ -31,1 +31,0 @@\n-\t.file \"svml_s_cos.c\"\n","filename":"src\/jdk.incubator.vector\/linux\/native\/libjsvml\/jsvml_s_cos_linux_x86.S","additions":1,"deletions":2,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2018, 2021, Intel Corporation. All rights reserved.\n+ * Copyright (c) 2018, 2022, Intel Corporation. All rights reserved.\n@@ -31,1 +31,0 @@\n-\t.file \"svml_s_cosh.c\"\n","filename":"src\/jdk.incubator.vector\/linux\/native\/libjsvml\/jsvml_s_cosh_linux_x86.S","additions":1,"deletions":2,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2018, 2021, Intel Corporation. All rights reserved.\n+ * Copyright (c) 2018, 2022, Intel Corporation. All rights reserved.\n@@ -31,1 +31,0 @@\n-\t.file \"svml_s_exp.c\"\n","filename":"src\/jdk.incubator.vector\/linux\/native\/libjsvml\/jsvml_s_exp_linux_x86.S","additions":1,"deletions":2,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2018, 2021, Intel Corporation. All rights reserved.\n+ * Copyright (c) 2018, 2022, Intel Corporation. All rights reserved.\n@@ -31,1 +31,0 @@\n-\t.file \"svml_s_expm1.c\"\n","filename":"src\/jdk.incubator.vector\/linux\/native\/libjsvml\/jsvml_s_expm1_linux_x86.S","additions":1,"deletions":2,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2018, 2021, Intel Corporation. All rights reserved.\n+ * Copyright (c) 2018, 2022, Intel Corporation. All rights reserved.\n@@ -31,1 +31,0 @@\n-\t.file \"svml_s_hypot.c\"\n","filename":"src\/jdk.incubator.vector\/linux\/native\/libjsvml\/jsvml_s_hypot_linux_x86.S","additions":1,"deletions":2,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2018, 2021, Intel Corporation. All rights reserved.\n+ * Copyright (c) 2018, 2022, Intel Corporation. All rights reserved.\n@@ -31,1 +31,0 @@\n-\t.file \"svml_s_log10.c\"\n","filename":"src\/jdk.incubator.vector\/linux\/native\/libjsvml\/jsvml_s_log10_linux_x86.S","additions":1,"deletions":2,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2018, 2021, Intel Corporation. All rights reserved.\n+ * Copyright (c) 2018, 2022, Intel Corporation. All rights reserved.\n@@ -31,1 +31,0 @@\n-\t.file \"svml_s_log1p.c\"\n","filename":"src\/jdk.incubator.vector\/linux\/native\/libjsvml\/jsvml_s_log1p_linux_x86.S","additions":1,"deletions":2,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2018, 2021, Intel Corporation. All rights reserved.\n+ * Copyright (c) 2018, 2022, Intel Corporation. All rights reserved.\n@@ -31,1 +31,0 @@\n-\t.file \"svml_s_log.c\"\n","filename":"src\/jdk.incubator.vector\/linux\/native\/libjsvml\/jsvml_s_log_linux_x86.S","additions":1,"deletions":2,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2018, 2021, Intel Corporation. All rights reserved.\n+ * Copyright (c) 2018, 2022, Intel Corporation. All rights reserved.\n@@ -31,1 +31,0 @@\n-\t.file \"svml_s_pow.c\"\n","filename":"src\/jdk.incubator.vector\/linux\/native\/libjsvml\/jsvml_s_pow_linux_x86.S","additions":1,"deletions":2,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2018, 2021, Intel Corporation. All rights reserved.\n+ * Copyright (c) 2018, 2022, Intel Corporation. All rights reserved.\n@@ -31,1 +31,0 @@\n-\t.file \"svml_s_sin.c\"\n","filename":"src\/jdk.incubator.vector\/linux\/native\/libjsvml\/jsvml_s_sin_linux_x86.S","additions":1,"deletions":2,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2018, 2021, Intel Corporation. All rights reserved.\n+ * Copyright (c) 2018, 2022, Intel Corporation. All rights reserved.\n@@ -31,1 +31,0 @@\n-\t.file \"svml_s_sinh.c\"\n","filename":"src\/jdk.incubator.vector\/linux\/native\/libjsvml\/jsvml_s_sinh_linux_x86.S","additions":1,"deletions":2,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2018, 2021, Intel Corporation. All rights reserved.\n+ * Copyright (c) 2018, 2022, Intel Corporation. All rights reserved.\n@@ -31,1 +31,0 @@\n-\t.file \"svml_s_tan.c\"\n","filename":"src\/jdk.incubator.vector\/linux\/native\/libjsvml\/jsvml_s_tan_linux_x86.S","additions":1,"deletions":2,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2018, 2021, Intel Corporation. All rights reserved.\n+ * Copyright (c) 2018, 2022, Intel Corporation. All rights reserved.\n@@ -31,1 +31,0 @@\n-\t.file \"svml_s_tanh.c\"\n","filename":"src\/jdk.incubator.vector\/linux\/native\/libjsvml\/jsvml_s_tanh_linux_x86.S","additions":1,"deletions":2,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2019, 2021, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2019, 2022, Oracle and\/or its affiliates. All rights reserved.\n@@ -51,0 +51,1 @@\n+    private static final boolean IS_LINUX   = System.getProperty(\"os.name\").toLowerCase().contains(\"linux\");\n@@ -167,1 +168,1 @@\n-                } else if (fileName.endsWith(\".debuginfo\") || fileName.endsWith(\".pdb\")) {\n+                } else if ((fileName.endsWith(\".debuginfo\") && !IS_LINUX) || fileName.endsWith(\".pdb\")) {\n","filename":"test\/jdk\/build\/AbsPathsInImage.java","additions":3,"deletions":2,"binary":false,"changes":5,"status":"modified"}]}