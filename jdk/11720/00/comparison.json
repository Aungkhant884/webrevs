{"files":[{"patch":"@@ -229,24 +229,1 @@\n-        final int UNIT_SIZE = 1024000;\n-        if (sizeOfPalette < UNIT_SIZE) {\n-            palette = new byte[sizeOfPalette];\n-            iis.readFully(palette, 0, sizeOfPalette);\n-        } else {\n-            int bytesToRead = sizeOfPalette;\n-            int bytesRead = 0;\n-            List<byte[]> bufs = new ArrayList<>();\n-            while (bytesToRead != 0) {\n-                int sz = Math.min(bytesToRead, UNIT_SIZE);\n-                byte[] unit = new byte[sz];\n-                iis.readFully(unit, 0, sz);\n-                bufs.add(unit);\n-                bytesRead += sz;\n-                bytesToRead -= sz;\n-            }\n-            byte[] paletteData = new byte[bytesRead];\n-            int copiedBytes = 0;\n-            for (byte[] ba : bufs) {\n-                System.arraycopy(ba, 0, paletteData, copiedBytes, ba.length);\n-                copiedBytes += ba.length;\n-            }\n-            palette = paletteData;\n-        }\n+        palette = ReaderUtil.staggeredReadByteStream(iis, sizeOfPalette);\n","filename":"src\/java.desktop\/share\/classes\/com\/sun\/imageio\/plugins\/bmp\/BMPImageReader.java","additions":1,"deletions":24,"binary":false,"changes":25,"status":"modified"}]}