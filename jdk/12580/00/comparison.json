{"files":[{"patch":"@@ -418,1 +418,2 @@\n-            test \"x$TOOLCHAIN_TYPE\" = \"xclang\"; then\n+           test \"x$TOOLCHAIN_TYPE\" = \"xclang\" ||\n+           test \"x$TOOLCHAIN_TYPE\" = \"xmicrosoft\"; then\n@@ -426,5 +427,14 @@\n-        # ASan is simply incompatible with gcc -Wstringop-truncation. See\n-        # https:\/\/gcc.gnu.org\/bugzilla\/show_bug.cgi?id=85650\n-        # It's harmless to be suppressed in clang as well.\n-        ASAN_CFLAGS=\"-fsanitize=address -Wno-stringop-truncation -fno-omit-frame-pointer -fno-common -DADDRESS_SANITIZER\"\n-        ASAN_LDFLAGS=\"-fsanitize=address\"\n+        ASAN_CFLAGS=\"-fsanitize=address\"\n+        ASAN_LDFLAGS=\"\"\n+        if test \"x$TOOLCHAIN_TYPE\" = \"xgcc\" ||\n+           test \"x$TOOLCHAIN_TYPE\" = \"xclang\"; then\n+          # ASan is simply incompatible with gcc -Wstringop-truncation. See\n+          # https:\/\/gcc.gnu.org\/bugzilla\/show_bug.cgi?id=85650\n+          # It's harmless to be suppressed in clang as well.\n+          ASAN_CFLAGS=\"$ASAN_CFLAGS -Wno-stringop-truncation -fno-omit-frame-pointer -fno-common\"\n+          ASAN_LDFLAGS=\"$ASAN_LDFLAGS -fsanitize=address\"\n+        elif test \"x$TOOLCHAIN_TYPE\" = \"xmicrosoft\"; then\n+          # MSVC produces a warning if you pass -fsanitize=address to the linker.\n+          ASAN_CFLAGS=\"$ASAN_CFLAGS -Oy-\"\n+        fi\n+        ASAN_CFLAGS=\"$ASAN_CFLAGS -DADDRESS_SANITIZER\"\n","filename":"make\/autoconf\/jdk-options.m4","additions":16,"deletions":6,"binary":false,"changes":22,"status":"modified"},{"patch":"@@ -36,0 +36,2 @@\n+#elif defined(_MSC_VER)\n+#define ATTRIBUTE_DEFAULT_VISIBILITY __declspec(dllexport)\n@@ -46,0 +48,6 @@\n+#if defined(_MSC_VER)\n+#define CDECL __cdecl\n+#else\n+#define CDECL\n+#endif\n+\n@@ -51,1 +59,1 @@\n-ATTRIBUTE_DEFAULT_VISIBILITY ATTRIBUTE_USED const char* __asan_default_options() {\n+ATTRIBUTE_DEFAULT_VISIBILITY ATTRIBUTE_USED const char* CDECL __asan_default_options() {\n","filename":"make\/data\/asan\/asan_default_options.c","additions":9,"deletions":1,"binary":false,"changes":10,"status":"modified"}]}