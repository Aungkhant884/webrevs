{"files":[{"patch":"@@ -35,1 +35,0 @@\n- * @requires vm.debug\n@@ -47,0 +46,1 @@\n+        commands.add(\"-XX:+UnlockDiagnosticVMOptions\");\n","filename":"test\/hotspot\/jtreg\/runtime\/handshake\/HandshakeTransitionTest.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -28,0 +28,3 @@\n+import java.util.ArrayList;\n+import java.util.Arrays;\n+import java.util.List;\n@@ -32,1 +35,1 @@\n- * @requires vm.debug & (os.family == \"linux\" | os.family == \"windows\")\n+ * @requires os.family == \"linux\" | os.family == \"windows\"\n@@ -34,2 +37,2 @@\n- * @build HandshakeTransitionTest\n- * @run main\/othervm\/native HandshakeTransitionTest -XX:+UnlockExperimentalVMOptions -XX:+UseSystemMemoryBarrier\n+ * @build SystemMembarHandshakeTransitionTest HandshakeTransitionTest\n+ * @run main\/native SystemMembarHandshakeTransitionTest\n@@ -37,0 +40,24 @@\n+\n+public class SystemMembarHandshakeTransitionTest {\n+\n+    public static void main(String[] args) throws Exception {\n+        List<String> commands = new ArrayList<>();\n+        commands.add(\"-Djava.library.path=\" + Utils.TEST_NATIVE_PATH);\n+        commands.add(\"-XX:+UnlockDiagnosticVMOptions\");\n+        commands.add(\"-XX:+SafepointALot\");\n+        commands.add(\"-XX:+HandshakeALot\");\n+        commands.add(\"-XX:GuaranteedSafepointInterval=20\");\n+        commands.add(\"-XX:ParallelGCThreads=1\");\n+        commands.add(\"-XX:ConcGCThreads=1\");\n+        commands.add(\"-XX:CICompilerCount=2\");\n+        commands.add(\"-XX:+UnlockExperimentalVMOptions\");\n+        commands.add(\"-XX:+UseSystemMemoryBarrier\");\n+        commands.addAll(Arrays.asList(args));\n+        commands.add(\"HandshakeTransitionTest$Test\");\n+        ProcessBuilder pb = ProcessTools.createTestJvm(commands);\n+\n+        OutputAnalyzer output = ProcessTools.executeProcess(pb);\n+        output.reportDiagnosticSummary();\n+        output.shouldMatch(\"(JOINED|Failed to initialize request system memory barrier synchronization.)\");\n+    }\n+}\n","filename":"test\/hotspot\/jtreg\/runtime\/handshake\/SystemMembarHandshakeTransitionTest.java","additions":30,"deletions":3,"binary":false,"changes":33,"status":"modified"}]}