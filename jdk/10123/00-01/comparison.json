{"files":[{"patch":"@@ -407,3 +407,0 @@\n-    AC_CHECK_DECL(MEMBARRIER_CMD_PRIVATE_EXPEDITED, ,\n-        [CFLAGS_OS_DEF_JVM=\"$CFLAGS_OS_DEF_JVM -DMEMBARRIER_NOT_FOUND\"],\n-        [#include <linux\/membarrier.h>])\n","filename":"make\/autoconf\/flags-cflags.m4","additions":0,"deletions":3,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -31,2 +31,0 @@\n-#if defined(AMD64) || defined(AARCH64)\n-\n@@ -34,0 +32,1 @@\n+\n@@ -35,3 +34,8 @@\n-#if !defined(SYS_membarrier)\n-#define SYS_membarrier 324\n-#endif\n+\/\/ Oracle x64 builds may use old sysroot (pre 4.3)\n+#ifndef SYS_membarrier\n+  #if defined(AMD64)\n+  #define SYS_membarrier 324\n+  #else\n+  #error define SYS_membarrier for the arch\n+  #endif\n+#endif \/\/ SYS_membarrier\n@@ -39,1 +43,0 @@\n-#ifdef MEMBARRIER_NOT_FOUND\n@@ -47,3 +50,0 @@\n-#else\n-#include <linux\/membarrier.h>\n-#endif\n@@ -85,10 +85,0 @@\n-#else \/\/ Not AMD64 and not AARCH64\n-bool LinuxSystemMemoryBarrier::initialize() {\n-  log_error(os)(\"SystemMemoryBarrier not supported on this platform\");\n-  return false;\n-}\n-\n-void LinuxSystemMemoryBarrier::emit() {\n-  fatal(\"Trying to emit a system memory barrier in unsupported configuration\");\n-}\n-#endif\n","filename":"src\/hotspot\/os\/linux\/systemMemoryBarrier_linux.cpp","additions":9,"deletions":19,"binary":false,"changes":28,"status":"modified"},{"patch":"@@ -32,1 +32,1 @@\n- * @requires vm.debug & vm.flavor != \"zero\" & (os.arch==\"x86_64\" | os.arch==\"aarch64\") & (os.family == \"linux\" | os.family == \"windows\")\n+ * @requires vm.debug & (os.family == \"linux\" | os.family == \"windows\")\n","filename":"test\/hotspot\/jtreg\/runtime\/handshake\/SystemMembarHandshakeTransitionTest.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"}]}