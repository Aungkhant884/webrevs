{"files":[{"patch":"@@ -40,0 +40,2 @@\n+import jdk.test.lib.net.IPSupport;\n+\n@@ -44,0 +46,1 @@\n+ * @library \/test\/lib\n@@ -136,0 +139,8 @@\n+    private static InetSocketAddress getLoopback(int port) throws IOException {\n+        if (IPSupport.hasIPv4()) {\n+            return new InetSocketAddress(\"127.0.0.1\", port);\n+        } else {\n+            return new InetSocketAddress(\"::1\", port);\n+        }\n+    }\n+\n@@ -141,1 +152,1 @@\n-        InetSocketAddress proxyAddr=null;\n+        InetSocketAddress proxyAddr;\n@@ -145,1 +156,1 @@\n-            proxyAddr = new InetSocketAddress(\"127.0.0.1\", proxy.getPort());\n+            proxyAddr = getLoopback(proxy.getPort());\n@@ -150,0 +161,1 @@\n+            proxyAddr = null;\n@@ -154,1 +166,2 @@\n-        HttpClient.Builder builder = HttpClient\n+        \/\/ proxyAddr == null => proxying disabled\n+        HttpClient client = HttpClient\n@@ -156,1 +169,3 @@\n-                .authenticator(new Auth());\n+                .authenticator(new Auth())\n+                .proxy(ProxySelector.of(proxyAddr))\n+                .build();\n@@ -158,4 +173,0 @@\n-        if (useProxy) {\n-            builder.proxy(ProxySelector.of(proxyAddr));\n-        }\n-        HttpClient client = builder.build();\n","filename":"test\/jdk\/java\/net\/httpclient\/AuthFilter.java","additions":19,"deletions":8,"binary":false,"changes":27,"status":"modified"}]}