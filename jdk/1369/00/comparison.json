{"files":[{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2005, 2016, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2005, 2020, Oracle and\/or its affiliates. All rights reserved.\n@@ -88,2 +88,10 @@\n-    HINSTANCE retval = ::ShellExecute(NULL, verb_c, fileOrUri_c, NULL, NULL, SW_SHOWNORMAL);\n-    DWORD error = ::GetLastError();\n+    HRESULT hr = ::CoInitializeEx(NULL, COINIT_APARTMENTTHREADED |\n+                                        COINIT_DISABLE_OLE1DDE);\n+    HINSTANCE retval;\n+    DWORD error;\n+    if (SUCCEEDED(hr)) {\n+        retval = ::ShellExecute(NULL, verb_c, fileOrUri_c, NULL, NULL,\n+                                SW_SHOWNORMAL);\n+        error = ::GetLastError();\n+        ::CoUninitialize();\n+    }\n@@ -95,0 +103,3 @@\n+    if (FAILED(hr)) {\n+        return JNU_NewStringPlatform(env, L\"CoInitializeEx() failed.\");\n+    }\n","filename":"src\/java.desktop\/windows\/native\/libawt\/windows\/awt_Desktop.cpp","additions":14,"deletions":3,"binary":false,"changes":17,"status":"modified"}]}