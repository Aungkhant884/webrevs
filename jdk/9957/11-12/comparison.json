{"files":[{"patch":"@@ -44,1 +44,1 @@\n-  bool _last_printed_methods;\n+  bool _has_printed_methods;\n@@ -53,1 +53,1 @@\n-      _flags(flags), _st(st), _num(0), _last_printed_methods(false)\n+      _flags(flags), _st(st), _num(0), _has_printed_methods(false)\n@@ -76,0 +76,10 @@\n+  static bool match(const char* pattern, Symbol* sym) {\n+    return (pattern == NULL || sym->is_star_match(pattern));\n+  }\n+\n+  void print_klass_name(InstanceKlass* ik) {\n+    _st->print(\"[%3d] \" INTPTR_FORMAT \" class %s \", _num++, p2i(ik), ik->name()->as_C_string());\n+    ik->class_loader_data()->print_value_on(_st);\n+    _st->cr();\n+  }\n+\n@@ -79,1 +89,3 @@\n-      if (_last_printed_methods) {\n+      if (_has_printed_methods) {\n+        \/\/ We have printed some methods in the previous class.\n+        \/\/ Print a new line to separate the two classes\n@@ -82,4 +94,1 @@\n-      _last_printed_methods = false;\n-      _st->print(\"[%3d] \" INTPTR_FORMAT \" class %s \", _num++, p2i(ik), ik->name()->as_C_string());\n-      ik->class_loader_data()->print_value_on(_st);\n-      _st->cr();\n+      _has_printed_methods = false;\n@@ -94,10 +103,11 @@\n-          if (_method_name_pattern != NULL &&\n-              !m->name()->is_star_match(_method_name_pattern)) {\n-            continue;\n-          }\n-          if (_method_signature_pattern != NULL &&\n-              !m->signature()->is_star_match(_method_signature_pattern)) {\n-            continue;\n-          }\n-          if (print_codes && num_methods_printed++ > 0) {\n-            _st->cr();\n+          if (match(_method_name_pattern, m->name()) &&\n+              match(_method_signature_pattern, m->signature())) {\n+            if (print_codes && num_methods_printed++ > 0) {\n+              _st->cr();\n+            }\n+\n+            if (_has_printed_methods == false) {\n+              print_klass_name(ik);\n+              _has_printed_methods = true;\n+            }\n+            print_method(m);\n@@ -105,2 +115,0 @@\n-          print_method(m);\n-          _last_printed_methods = true;\n@@ -108,0 +116,2 @@\n+      } else {\n+        print_klass_name(ik);\n","filename":"src\/hotspot\/share\/classfile\/classPrinter.cpp","additions":29,"deletions":19,"binary":false,"changes":48,"status":"modified"}]}