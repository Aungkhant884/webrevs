{"files":[{"patch":"@@ -140,1 +140,1 @@\n-  static OopMap* save_live_registers(MacroAssembler* masm, int additional_frame_words, int* total_frame_words, bool save_vectors = false);\n+  static OopMap* save_live_registers(MacroAssembler* masm, int additional_frame_words, int* total_frame_words, bool save_vectors);\n@@ -165,3 +165,2 @@\n-  if (save_vectors) {\n-    assert(UseAVX > 0, \"Vectors larger than 16 byte long are supported only with AVX\");\n-    assert(MaxVectorSize <= 64, \"Only up to 64 byte long vectors are supported\");\n+  if (save_vectors && UseAVX == 0) {\n+    save_vectors = false; \/\/ vectors larger than 16 byte long are supported only with AVX\n@@ -169,0 +168,1 @@\n+  assert(!save_vectors || MaxVectorSize <= 64, \"Only up to 64 byte long vectors are supported\");\n@@ -170,1 +170,1 @@\n-  assert(!save_vectors, \"vectors are generated only by C2 and JVMCI\");\n+  save_vectors = false; \/\/ vectors are generated only by C2 and JVMCI\n@@ -2601,0 +2601,3 @@\n+  if (UseAVX > 2) {\n+    pad += 1024;\n+  }\n@@ -2606,1 +2609,1 @@\n-  CodeBuffer buffer(\"deopt_blob\", 2048+pad, 1024);\n+  CodeBuffer buffer(\"deopt_blob\", 2560+pad, 1024);\n@@ -2648,1 +2651,1 @@\n-  map = RegisterSaver::save_live_registers(masm, 0, &frame_size_in_words);\n+  map = RegisterSaver::save_live_registers(masm, 0, &frame_size_in_words, \/*save_vectors*\/ true);\n@@ -2666,1 +2669,1 @@\n-  (void) RegisterSaver::save_live_registers(masm, 0, &frame_size_in_words);\n+  (void) RegisterSaver::save_live_registers(masm, 0, &frame_size_in_words, \/*save_vectors*\/ true);\n@@ -2685,1 +2688,1 @@\n-    RegisterSaver::save_live_registers(masm, 0, &frame_size_in_words);\n+    RegisterSaver::save_live_registers(masm, 0, &frame_size_in_words, \/*save_vectors*\/ true);\n@@ -2732,1 +2735,1 @@\n-  map = RegisterSaver::save_live_registers(masm, 0, &frame_size_in_words);\n+  map = RegisterSaver::save_live_registers(masm, 0, &frame_size_in_words, \/*save_vectors*\/ true);\n@@ -3334,1 +3337,2 @@\n-  map = RegisterSaver::save_live_registers(masm, 0, &frame_size_in_words);\n+  \/\/ No need to save vector registers since they are caller-saved anyway.\n+  map = RegisterSaver::save_live_registers(masm, 0, &frame_size_in_words, \/*save_vectors*\/ false);\n","filename":"src\/hotspot\/cpu\/x86\/sharedRuntime_x86_64.cpp","additions":15,"deletions":11,"binary":false,"changes":26,"status":"modified"}]}