{"files":[{"patch":"@@ -686,1 +686,0 @@\n-sanity\/client\/SwingSet\/src\/ScrollPaneDemoTest.java 8225013 linux-all\n","filename":"test\/jdk\/ProblemList.txt","additions":0,"deletions":1,"binary":false,"changes":1,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2010, 2018, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2010, 2022, Oracle and\/or its affiliates. All rights reserved.\n@@ -24,0 +24,2 @@\n+import com.sun.swingset3.demos.ResourceManager;\n+import org.jemmy2ext.JemmyExt;\n@@ -28,0 +30,3 @@\n+\n+import javax.swing.ImageIcon;\n+import javax.swing.JLabel;\n@@ -29,0 +34,6 @@\n+\n+import org.netbeans.jemmy.ComponentSearcher;\n+import org.netbeans.jemmy.operators.ComponentOperator;\n+import org.netbeans.jemmy.operators.ContainerOperator;\n+import org.netbeans.jemmy.operators.JLabelOperator;\n+import org.netbeans.jemmy.util.Dumper;\n@@ -35,0 +46,4 @@\n+import java.awt.MediaTracker;\n+import java.awt.Rectangle;\n+import java.awt.Toolkit;\n+\n@@ -49,0 +64,1 @@\n+\n@@ -53,0 +69,3 @@\n+    public static final String IMAGE_DESCRIPTION =\n+            new ResourceManager(ScrollPaneDemo.class).getString(\"ScrollPaneDemo.crayons\");\n+\n@@ -60,1 +79,3 @@\n-        JScrollPaneOperator jspo = new JScrollPaneOperator(frame);\n+        ContainerOperator<ScrollPaneDemo> scrollPaneDemo =\n+                new ContainerOperator<>(frame, c -> c instanceof ScrollPaneDemo);\n+        JScrollPaneOperator jspo = new JScrollPaneOperator(scrollPaneDemo);\n@@ -69,0 +90,17 @@\n+        JLabelOperator imageLabel = new JLabelOperator(scrollPaneDemo, c -> {\n+            if(c instanceof JLabel) {\n+                var icon = ((JLabel)c).getIcon();\n+                if(icon instanceof ImageIcon) {\n+                    return ((ImageIcon)icon).getDescription().equals(IMAGE_DESCRIPTION);\n+                }\n+            }\n+            return false;\n+        });\n+        imageLabel.waitState(c -> ((ImageIcon)((JLabel)c).getIcon()).getImageLoadStatus() == MediaTracker.COMPLETE);\n+\n+        \/\/this additional instrumentation is related to JDK-8225013\n+        \/\/after the image has been completely loaded, the UI is supposed to be functional\n+        \/\/screenshot and dump are created to capture the state of the UI, should the test fail again\n+        JemmyExt.save(JemmyExt.capture(), \"after-image-load\");\n+        Dumper.dumpAll(\"after-image-load-\" + JemmyExt.lafShortName() + \"xml\");\n+\n","filename":"test\/jdk\/sanity\/client\/SwingSet\/src\/ScrollPaneDemoTest.java","additions":40,"deletions":2,"binary":false,"changes":42,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2015, 2020, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2015, 2022, Oracle and\/or its affiliates. All rights reserved.\n@@ -322,0 +322,4 @@\n+    public static BufferedImage capture() {\n+        return capture(new Rectangle(Toolkit.getDefaultToolkit().getScreenSize()));\n+    }\n+\n@@ -323,2 +327,5 @@\n-        Rectangle boundary = new Rectangle(operator.getLocationOnScreen(),\n-                operator.getSize());\n+        return capture(new Rectangle(operator.getLocationOnScreen(),\n+                    operator.getSize()));\n+    }\n+\n+    public static BufferedImage capture(Rectangle boundary) {\n@@ -406,1 +413,1 @@\n-    private static String lafShortName() { return UIManager.getLookAndFeel().getClass().getSimpleName(); }\n+    public static String lafShortName() { return UIManager.getLookAndFeel().getClass().getSimpleName(); }\n","filename":"test\/jdk\/sanity\/client\/lib\/Extensions\/src\/org\/jemmy2ext\/JemmyExt.java","additions":11,"deletions":4,"binary":false,"changes":15,"status":"modified"}]}