{"files":[{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 1997, 2015, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 1997, 2023, Oracle and\/or its affiliates. All rights reserved.\n@@ -36,0 +36,1 @@\n+#include <wchar.h>\n@@ -382,7 +383,16 @@\n-                        ret = processCreate(\n-                            env,\n-                            pcmd,\n-                            penvBlock,\n-                            pdir,\n-                            handles,\n-                            redirectErrorStream);\n+                        \/\/ Copy command line to mutable char buffer; CreateProcessW may modify it\n+                        jsize cmdLen = (*env)->GetStringLength(env, cmd);\n+                        WCHAR *pcmdCopy = (WCHAR*)malloc((cmdLen + 1) * sizeof(WCHAR));\n+                        if (pcmdCopy != NULL) {\n+                            wmemcpy(pcmdCopy, pcmd, cmdLen);\n+                            pcmdCopy[cmdLen] = 0;    \/\/ null terminate\n+\n+                            ret = processCreate(\n+                                env,\n+                                pcmd,\n+                                penvBlock,\n+                                pdir,\n+                                handles,\n+                                redirectErrorStream);\n+                            free(pcmdCopy);   \/\/ free mutable command line\n+                        }\n","filename":"src\/java.base\/windows\/native\/libjava\/ProcessImpl_md.c","additions":18,"deletions":8,"binary":false,"changes":26,"status":"modified"}]}