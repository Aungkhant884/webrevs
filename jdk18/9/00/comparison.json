{"files":[{"patch":"@@ -32,4 +32,4 @@\n-uint   SuspendibleThreadSet::_nthreads          = 0;\n-uint   SuspendibleThreadSet::_nthreads_stopped  = 0;\n-bool   SuspendibleThreadSet::_suspend_all       = false;\n-double SuspendibleThreadSet::_suspend_all_start = 0.0;\n+uint   SuspendibleThreadSet::_nthreads            = 0;\n+uint   SuspendibleThreadSet::_nthreads_stopped    = 0;\n+volatile bool SuspendibleThreadSet::_suspend_all  = false;\n+double SuspendibleThreadSet::_suspend_all_start   = 0.0;\n@@ -53,1 +53,1 @@\n-  while (_suspend_all) {\n+  while (suspend_all()) {\n@@ -66,1 +66,1 @@\n-  if (_suspend_all && is_synchronized()) {\n+  if (suspend_all() && is_synchronized()) {\n@@ -75,1 +75,1 @@\n-  if (_suspend_all) {\n+  if (suspend_all()) {\n@@ -85,1 +85,1 @@\n-    while (_suspend_all) {\n+    while (suspend_all()) {\n@@ -100,2 +100,2 @@\n-    assert(!_suspend_all, \"Only one at a time\");\n-    _suspend_all = true;\n+    assert(!suspend_all(), \"Only one at a time\");\n+    Atomic::store(&_suspend_all, true);\n@@ -123,1 +123,1 @@\n-  assert(_suspend_all, \"STS not synchronizing\");\n+  assert(suspend_all(), \"STS not synchronizing\");\n@@ -131,1 +131,1 @@\n-  assert(_suspend_all, \"STS not synchronizing\");\n+  assert(suspend_all(), \"STS not synchronizing\");\n@@ -133,1 +133,1 @@\n-  _suspend_all = false;\n+  Atomic::store(&_suspend_all, false);\n","filename":"src\/hotspot\/share\/gc\/shared\/suspendibleThreadSet.cpp","additions":13,"deletions":13,"binary":false,"changes":26,"status":"modified"},{"patch":"@@ -29,0 +29,1 @@\n+#include \"runtime\/atomic.hpp\"\n@@ -43,0 +44,2 @@\n+  static volatile bool _suspend_all;\n+\n@@ -45,1 +48,0 @@\n-  static bool   _suspend_all;\n@@ -56,0 +58,2 @@\n+  static bool suspend_all() { return Atomic::load(&_suspend_all); }\n+\n@@ -58,1 +62,1 @@\n-  static bool should_yield() { return _suspend_all; }\n+  static bool should_yield() { return suspend_all(); }\n","filename":"src\/hotspot\/share\/gc\/shared\/suspendibleThreadSet.hpp","additions":6,"deletions":2,"binary":false,"changes":8,"status":"modified"}]}