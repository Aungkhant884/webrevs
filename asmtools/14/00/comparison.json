{"files":[{"patch":"@@ -3,1 +3,1 @@\n-Copyright (c) 2014, 2019, Oracle and\/or its affiliates. All rights reserved.\n+Copyright (c) 2014, 2021, Oracle and\/or its affiliates. All rights reserved.\n@@ -27,2 +27,1 @@\n-\n-<project name=\"asmtools\" default=\"build\" basedir=\".\">\n+<project name=\"asmtools\" default=\"build\" basedir=\".\" xmlns:if=\"ant:if\">\n@@ -44,0 +43,2 @@\n+    <property environment=\"env\"\/>\n+\n@@ -81,1 +82,0 @@\n-\n@@ -120,1 +120,0 @@\n-\n@@ -135,2 +134,1 @@\n-    <target name=\"prepare\" depends=\"preparebuildarea,preparereleasearea\" description=\"Prepares the build generation areas.\" \/>\n-\n+    <target name=\"prepare\" depends=\"prepare-build-area,prepare-release-area\" description=\"Prepares the build generation areas.\" \/>\n@@ -154,2 +152,0 @@\n-\n-\n@@ -157,1 +153,1 @@\n-    <target name=\"preparebuildarea\" depends=\"prepareGenArea\" >\n+    <target name=\"prepare-build-area\" depends=\"prepareGenArea\" >\n@@ -170,1 +166,0 @@\n-\n@@ -176,1 +171,1 @@\n-    <target name=\"preparereleasearea\" depends=\"prepareGenArea\" >\n+    <target name=\"prepare-release-area\" depends=\"prepareGenArea\" >\n@@ -223,1 +218,1 @@\n-    <target name=\"release\" depends=\"devbuild, examples, releaseproduct\"\/>\n+    <target name=\"release\" depends=\"devbuild, examples, release-product\"\/>\n@@ -225,1 +220,1 @@\n-    <target name=\"devbuild\"  depends=\"prepare, replace-tokens, jar, javadoc\"\/>\n+    <target name=\"devbuild\"  depends=\"prepare, replace-tokens, jar, javadoc, -create-release-file\"\/>\n@@ -232,0 +227,24 @@\n+    <!-- generate release file -->\n+    <target name=\"-check-build-result\" description=\"checks the jar existence\">\n+        <available property=\"jar.ok\" file=\"${build.lib.dir}\/${PRODUCT_JAR_NAME}\"\/>\n+    <\/target>\n+\n+    <target name=\"-create-release-file\" depends=\"-check-build-result\" if=\"jar.ok\">\n+        <available file=\"git\" filepath=\"${env.PATH}\" property=\"git.present\"\/>\n+        <exec executable=\"git\" failonerror=\"false\" failifexecutionfails=\"false\" outputproperty=\"git.revision\"\n+              if:set=\"git.present\">\n+            <arg line=\"log -1 --format=%H\"\/>\n+        <\/exec>\n+        <condition property=\"git.revision\" value=\"N\/A\">\n+            <not>\n+                <isset property=\"git.revision\"\/>\n+            <\/not>\n+        <\/condition>\n+        <echo file=\"${buildArea.dir}\/release\">\n+SOURCE=\"git:${git.revision}\"\n+VERSION=\"${PRODUCT_VERSION}_${PRODUCT_BUILDNUMBER}\"\n+VERSION_DATE=\"${build.date}\"\n+MILESTONE=\"${PRODUCT_MILESTONE}\"\n+        <\/echo>\n+        <copy file=\"${buildArea.dir}\/release\" todir=\"${releaseArea.dir}\" failonerror=\"false\"\/>\n+    <\/target>\n@@ -250,1 +269,0 @@\n-\n@@ -273,1 +291,0 @@\n-\n@@ -277,1 +294,1 @@\n-    <target name=\"releaseproduct\" depends=\"preparereleasearea,preparerelease\" description=\"Bundle the asmtools product.\">\n+    <target name=\"release-product\" depends=\"prepare-release-area,prepare-release\" description=\"Bundle the asmtools product.\">\n@@ -288,1 +305,1 @@\n-    <target name=\"preparerelease\" description=\"Build and Bundle the product.\">\n+    <target name=\"prepare-release\" description=\"Build and Bundle the product.\">\n@@ -316,1 +333,0 @@\n-\n","filename":"build\/build.xml","additions":35,"deletions":19,"binary":false,"changes":54,"status":"modified"},{"patch":"@@ -1,1 +1,1 @@\n-# Copyright (c) 2014, 2017, Oracle and\/or its affiliates. All rights reserved.\n+# Copyright (c) 2014, 2021, Oracle and\/or its affiliates. All rights reserved.\n@@ -30,1 +30,1 @@\n-PRODUCT_BUILDNUMBER = b09\n+PRODUCT_BUILDNUMBER = 10\n","filename":"build\/productinfo.properties","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"}]}