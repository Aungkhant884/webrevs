{"files":[{"patch":"@@ -53,0 +53,6 @@\n+#define SAFE_FREE(PTR)  \\\n+    if ((PTR) != NULL) {  \\\n+        free(PTR);     \\\n+        (PTR) = NULL;     \\\n+    }\n+\n@@ -162,1 +168,8 @@\n-    if(count == 0) goto fail;\n+    jint *glyphs = NULL;\n+    jint *widths = NULL;\n+    jint *cluster = NULL;\n+    if (count <= 0) goto fail;\n+    if ((size_t)count >= INT_MAX \/ sizeof(jint)) {\n+        fprintf(stderr, \"OS_NATIVE error: large glyph count value in pango_1shape\\n\");\n+        goto fail;\n+    }\n@@ -168,3 +181,9 @@\n-        jint glyphs[count];\n-        jint widths[count];\n-        jint cluster[count];\n+        glyphs = (jint*) malloc(count * sizeof(jint));\n+        widths = (jint*) malloc(count * sizeof(jint));\n+        cluster = (jint*) malloc(count * sizeof(jint));\n+        if (glyphs == NULL ||\n+            widths == NULL ||\n+            cluster == NULL) {\n+            fprintf(stderr, \"OS_NATIVE error: Unable to allocate memory in pango_1shape\\n\");\n+            goto fail;\n+        }\n@@ -209,0 +228,3 @@\n+    SAFE_FREE(glyphs);\n+    SAFE_FREE(widths);\n+    SAFE_FREE(cluster);\n","filename":"modules\/javafx.graphics\/src\/main\/native-font\/pango.c","additions":26,"deletions":4,"binary":false,"changes":30,"status":"modified"}]}