{"files":[{"patch":"@@ -1205,1 +1205,1 @@\n-    __ load_klass(t0, obj);\n+    __ load_klass(t0, obj, t1);\n","filename":"src\/hotspot\/cpu\/riscv\/c1_LIRAssembler_riscv.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -149,1 +149,1 @@\n-  assert_different_registers(obj, klass, len);\n+  assert_different_registers(obj, klass, len, tmp1, tmp2);\n@@ -155,1 +155,1 @@\n-    encode_klass_not_null(tmp1, klass);\n+    encode_klass_not_null(tmp1, klass, tmp2);\n@@ -301,1 +301,2 @@\n-  cmp_klass(receiver, iCache, t0, L);\n+  assert_different_registers(receiver, iCache, t0, t2);\n+  cmp_klass(receiver, iCache, t0, t2 \/* call-clobbered t2 as a tmp *\/, L);\n","filename":"src\/hotspot\/cpu\/riscv\/c1_MacroAssembler_riscv.cpp","additions":4,"deletions":3,"binary":false,"changes":7,"status":"modified"},{"patch":"@@ -1635,1 +1635,2 @@\n-void MacroAssembler::cmp_klass(Register oop, Register trial_klass, Register tmp, Label &L) {\n+void MacroAssembler::cmp_klass(Register oop, Register trial_klass, Register tmp1, Register tmp2, Label &L) {\n+  assert_different_registers(oop, trial_klass, tmp1, tmp2);\n@@ -1637,1 +1638,1 @@\n-      lwu(tmp, Address(oop, oopDesc::klass_offset_in_bytes()));\n+    lwu(tmp1, Address(oop, oopDesc::klass_offset_in_bytes()));\n@@ -1639,2 +1640,2 @@\n-      slli(tmp, tmp, CompressedKlassPointers::shift());\n-      beq(trial_klass, tmp, L);\n+      slli(tmp1, tmp1, CompressedKlassPointers::shift());\n+      beq(trial_klass, tmp1, L);\n@@ -1643,1 +1644,1 @@\n-    decode_klass_not_null(tmp);\n+    decode_klass_not_null(tmp1, tmp2);\n@@ -1645,1 +1646,1 @@\n-    ld(tmp, Address(oop, oopDesc::klass_offset_in_bytes()));\n+    ld(tmp1, Address(oop, oopDesc::klass_offset_in_bytes()));\n@@ -1647,1 +1648,1 @@\n-  beq(trial_klass, tmp, L);\n+  beq(trial_klass, tmp1, L);\n@@ -1827,1 +1828,3 @@\n-void MacroAssembler::load_klass(Register dst, Register src) {\n+void MacroAssembler::load_klass(Register dst, Register src, Register tmp) {\n+  assert_different_registers(dst, tmp);\n+  assert_different_registers(src, tmp);\n@@ -1830,1 +1833,1 @@\n-    decode_klass_not_null(dst);\n+    decode_klass_not_null(dst, tmp);\n@@ -1836,1 +1839,1 @@\n-void MacroAssembler::store_klass(Register dst, Register src) {\n+void MacroAssembler::store_klass(Register dst, Register src, Register tmp) {\n@@ -1840,1 +1843,1 @@\n-    encode_klass_not_null(src);\n+    encode_klass_not_null(src, tmp);\n@@ -1854,2 +1857,3 @@\n-void  MacroAssembler::decode_klass_not_null(Register r) {\n-  decode_klass_not_null(r, r);\n+void MacroAssembler::decode_klass_not_null(Register r, Register tmp) {\n+  assert_different_registers(r, tmp);\n+  decode_klass_not_null(r, r, tmp);\n@@ -1886,2 +1890,0 @@\n-\n-  if (xbase == xheapbase) { reinit_heapbase(); }\n@@ -1890,2 +1892,3 @@\n-void MacroAssembler::encode_klass_not_null(Register r) {\n-  encode_klass_not_null(r, r);\n+void MacroAssembler::encode_klass_not_null(Register r, Register tmp) {\n+  assert_different_registers(r, tmp);\n+  encode_klass_not_null(r, r, tmp);\n@@ -1925,3 +1928,0 @@\n-  if (xbase == xheapbase) {\n-    reinit_heapbase();\n-  }\n","filename":"src\/hotspot\/cpu\/riscv\/macroAssembler_riscv.cpp","additions":20,"deletions":20,"binary":false,"changes":40,"status":"modified"},{"patch":"@@ -192,8 +192,8 @@\n-  void load_klass(Register dst, Register src);\n-  void store_klass(Register dst, Register src);\n-  void cmp_klass(Register oop, Register trial_klass, Register tmp, Label &L);\n-\n-  void encode_klass_not_null(Register r);\n-  void decode_klass_not_null(Register r);\n-  void encode_klass_not_null(Register dst, Register src, Register tmp = xheapbase);\n-  void decode_klass_not_null(Register dst, Register src, Register tmp = xheapbase);\n+  void load_klass(Register dst, Register src, Register tmp = t0);\n+  void store_klass(Register dst, Register src, Register tmp = t0);\n+  void cmp_klass(Register oop, Register trial_klass, Register tmp1, Register tmp2, Label &L);\n+\n+  void encode_klass_not_null(Register r, Register tmp = t0);\n+  void decode_klass_not_null(Register r, Register tmp = t0);\n+  void encode_klass_not_null(Register dst, Register src, Register tmp);\n+  void decode_klass_not_null(Register dst, Register src, Register tmp);\n","filename":"src\/hotspot\/cpu\/riscv\/macroAssembler_riscv.hpp","additions":8,"deletions":8,"binary":false,"changes":16,"status":"modified"},{"patch":"@@ -76,1 +76,1 @@\n-  Register temp = t1;\n+  Register temp1 = t1;\n@@ -82,3 +82,3 @@\n-  __ push_reg(RegSet::of(temp, temp2), sp);\n-  __ load_klass(temp, obj);\n-  __ cmpptr(temp, ExternalAddress((address) klass_addr), L_ok);\n+  __ push_reg(RegSet::of(temp1, temp2), sp);\n+  __ load_klass(temp1, obj, temp2);\n+  __ cmpptr(temp1, ExternalAddress((address) klass_addr), L_ok);\n@@ -86,3 +86,3 @@\n-  __ ld(temp, Address(temp, super_check_offset));\n-  __ cmpptr(temp, ExternalAddress((address) klass_addr), L_ok);\n-  __ pop_reg(RegSet::of(temp, temp2), sp);\n+  __ ld(temp1, Address(temp1, super_check_offset));\n+  __ cmpptr(temp1, ExternalAddress((address) klass_addr), L_ok);\n+  __ pop_reg(RegSet::of(temp1, temp2), sp);\n@@ -92,1 +92,1 @@\n-  __ pop_reg(RegSet::of(temp, temp2), sp);\n+  __ pop_reg(RegSet::of(temp1, temp2), sp);\n","filename":"src\/hotspot\/cpu\/riscv\/methodHandles_riscv.cpp","additions":8,"deletions":8,"binary":false,"changes":16,"status":"modified"},{"patch":"@@ -1718,1 +1718,1 @@\n-  __ cmp_klass(j_rarg0, t1, t0, skip);\n+  __ cmp_klass(j_rarg0, t1, t0, t2 \/* call-clobbered t2 as a tmp *\/, skip);\n","filename":"src\/hotspot\/cpu\/riscv\/riscv.ad","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -631,1 +631,1 @@\n-    __ load_klass(t0, receiver);\n+    __ load_klass(t0, receiver, tmp);\n@@ -1291,1 +1291,0 @@\n-  assert_different_registers(ic_reg, receiver, t0);\n@@ -1293,1 +1292,2 @@\n-  __ cmp_klass(receiver, ic_reg, t0, hit);\n+  assert_different_registers(ic_reg, receiver, t0, t2);\n+  __ cmp_klass(receiver, ic_reg, t0, t2 \/* call-clobbered t2 as a tmp *\/, hit);\n","filename":"src\/hotspot\/cpu\/riscv\/sharedRuntime_riscv.cpp","additions":3,"deletions":3,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -1781,1 +1781,1 @@\n-      __ load_klass(t0, dst);\n+      __ load_klass(t0, dst, t1);\n","filename":"src\/hotspot\/cpu\/riscv\/stubGenerator_riscv.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"}]}