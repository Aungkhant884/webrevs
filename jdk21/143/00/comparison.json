{"files":[{"patch":"@@ -381,11 +381,0 @@\n-  if (Continuations::enabled()) {\n-    \/\/ Virtual threads support. There is a performance impact when VTMS transitions are enabled.\n-    if (JvmtiEnv::get_phase() == JVMTI_PHASE_LIVE) {\n-      if (!JvmtiVTMSTransitionDisabler::VTMS_notify_jvmti_events()) {\n-        ThreadInVMfromNative __tiv(JavaThread::current());\n-        JvmtiEnvBase::enable_virtual_threads_notify_jvmti();\n-      }\n-    } else {\n-      JvmtiVTMSTransitionDisabler::set_VTMS_notify_jvmti_events(true);\n-    }\n-  }\n@@ -402,0 +391,8 @@\n+\n+    if (Continuations::enabled()) {\n+      \/\/ Virtual threads support for agents loaded into running VM.\n+      \/\/ There is a performance impact when VTMS transitions are enabled.\n+      if (!JvmtiVTMSTransitionDisabler::VTMS_notify_jvmti_events()) {\n+        JvmtiEnvBase::enable_virtual_threads_notify_jvmti();\n+      }\n+    }\n@@ -408,0 +405,6 @@\n+\n+    if (Continuations::enabled()) {\n+      \/\/ Virtual threads support for agents loaded at startup.\n+      \/\/ There is a performance impact when VTMS transitions are enabled.\n+      JvmtiVTMSTransitionDisabler::set_VTMS_notify_jvmti_events(true);\n+    }\n","filename":"src\/hotspot\/share\/prims\/jvmtiExport.cpp","additions":14,"deletions":11,"binary":false,"changes":25,"status":"modified"},{"patch":"@@ -122,1 +122,0 @@\n-serviceability\/jvmti\/vthread\/VThreadTLSTest\/VThreadTLSTest.java#id1 8300051 generic-all\n","filename":"test\/hotspot\/jtreg\/ProblemList.txt","additions":0,"deletions":1,"binary":false,"changes":1,"status":"modified"}]}