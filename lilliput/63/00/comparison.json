{"files":[{"patch":"@@ -3779,1 +3779,1 @@\n-    Label no_count;\n+    Label count, no_count;\n@@ -3798,1 +3798,1 @@\n-        __ fast_lock(oop, disp_hdr, tmp, rscratch1, cont, false);\n+        __ fast_lock(oop, disp_hdr, tmp, rscratch1, no_count, false);\n@@ -3802,0 +3802,1 @@\n+        __ b(count);\n@@ -3830,0 +3831,1 @@\n+        __ b(cont);\n@@ -3833,0 +3835,1 @@\n+      __ b(cont);\n@@ -3834,1 +3837,0 @@\n-    __ b(cont);\n@@ -3869,0 +3871,1 @@\n+    __ bind(count);\n@@ -3882,1 +3885,1 @@\n-    Label no_count;\n+    Label count, no_count;\n@@ -3901,1 +3904,1 @@\n-        __ fast_unlock(oop, tmp, box, disp_hdr, cont);\n+        __ fast_unlock(oop, tmp, box, disp_hdr, no_count);\n@@ -3905,0 +3908,1 @@\n+        __ b(count);\n@@ -3912,0 +3916,1 @@\n+        __ b(cont);\n@@ -3915,0 +3920,1 @@\n+      __ b(cont);\n@@ -3916,1 +3922,0 @@\n-    __ b(cont);\n@@ -3928,1 +3933,5 @@\n-      __ tbnz(disp_hdr, (unsigned char)(intptr_t) ANONYMOUS_OWNER, cont);\n+      \/\/ We cannot use tbnz here: tbnz would leave the condition flags untouched,\n+      \/\/ but we want to carry-over the NE condition to the exit at the cont label,\n+      \/\/ in order to take the slow-path.\n+      __ tst(disp_hdr, (uint64_t)(intptr_t) ANONYMOUS_OWNER);\n+      __ br(Assembler::NE, no_count);\n@@ -3957,0 +3966,1 @@\n+    __ bind(count);\n","filename":"src\/hotspot\/cpu\/aarch64\/aarch64.ad","additions":17,"deletions":7,"binary":false,"changes":24,"status":"modified"}]}