{"files":[{"patch":"@@ -95,0 +95,23 @@\n+inline float fromLinear(float c)\n+{\n+    if (isnan(c)) c = 0.0;\n+    if (c > 1.0)\n+          c = 1.0;\n+    else if (c < 0.0)\n+          c = 0.0;\n+    else if (c < 0.0031308)\n+          c = 12.92 * c;\n+    else\n+    c = 1.055 * powr(c, 1.0\/2.4) - 0.055;\n+    return c;\n+}\n+\n+inline float3 fromLinear3(float3 c) {\n+    \/\/c.r = fromLinear(c.r);\n+    \/\/c.g = fromLinear(c.g);\n+    \/\/c.b = fromLinear(c.b);\n+    \/\/ Use approximated calculations to match software rendering\n+    c.rgb = 1.055 * pow(c.rgb, float3(0.416667)) - 0.055;\n+    return c;\n+}\n+\n@@ -133,1 +156,1 @@\n-          c.rgb = 1.055 * pow(c.rgb, float3(0.416667)) - 0.055;\n+          c.rgb = fromLinear3(c.rgb);\n@@ -331,1 +354,1 @@\n-    float3 v = float3(in.position.x, in.position.y, 1);\n+    float3 v = float3(in.position.x-0.5, in.position.y-0.5, 1);\n@@ -358,1 +381,1 @@\n-    float3 fragCoord = float3(in.position.x+0.5, in.position.y-0.5, 1);\n+    float3 fragCoord = float3(in.position.x-0.5, in.position.y-0.5, 1);\n@@ -504,1 +527,1 @@\n-    float3 v = float3(in.position.x, in.position.y, 1);\n+    float3 v = float3(in.position.x-0.5, in.position.y-0.5, 1);\n@@ -512,1 +535,1 @@\n-    float3 v = float3(in.position.x, in.position.y, 1);\n+    float3 v = float3(in.position.x-0.5, in.position.y-0.5, 1);\n@@ -519,1 +542,1 @@\n-    float3 fragCoord = float3(in.position.x+0.5, in.position.y-0.5, 1);\n+    float3 fragCoord = float3(in.position.x-0.5, in.position.y-0.5, 1);\n","filename":"src\/java.desktop\/macosx\/native\/libawt_lwawt\/awt\/shaders.metal","additions":29,"deletions":6,"binary":false,"changes":35,"status":"modified"}]}