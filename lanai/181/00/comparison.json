{"files":[{"patch":"@@ -116,14 +116,14 @@\n-  jboolean ret = JNI_FALSE;\n-  JNI_COCOA_ENTER(env);\n-  NSMutableArray * retArray = [NSMutableArray arrayWithCapacity:3];\n-  [retArray addObject: [NSNumber numberWithInt: (int)displayID]];\n-  [retArray addObject: [NSString stringWithUTF8String: JNU_GetStringPlatformChars(env, shadersLibName, 0)]];\n-  if ([NSThread isMainThread]) {\n-      [MTLGraphicsConfigUtil _tryLoadMetalLibrary: retArray];\n-  } else {\n-      [MTLGraphicsConfigUtil performSelectorOnMainThread: @selector(_tryLoadMetalLibrary:) withObject: retArray waitUntilDone: YES];\n-  }\n-  NSNumber * num = (NSNumber *)[retArray objectAtIndex: 0];\n-  ret = (jboolean)[num boolValue];\n-  JNI_COCOA_EXIT(env);\n-  return ret;\n+    jboolean ret = JNI_FALSE;\n+    JNI_COCOA_ENTER(env);\n+    NSMutableArray * retArray = [NSMutableArray arrayWithCapacity:3];\n+    [retArray addObject: [NSNumber numberWithInt: (int)displayID]];\n+    [retArray addObject: [NSString stringWithUTF8String: JNU_GetStringPlatformChars(env, shadersLibName, 0)]];\n+\n+    [ThreadUtilities performOnMainThreadWaiting:YES block:^() {\n+        [MTLGraphicsConfigUtil _tryLoadMetalLibrary: retArray];\n+    }];\n+\n+    NSNumber * num = (NSNumber *)[retArray objectAtIndex: 0];\n+    ret = (jboolean)[num boolValue];\n+    JNI_COCOA_EXIT(env);\n+    return ret;\n@@ -147,14 +147,14 @@\n-  jlong ret = 0L;\n-  JNI_COCOA_ENTER(env);\n-  NSMutableArray * retArray = [NSMutableArray arrayWithCapacity:3];\n-  [retArray addObject: [NSNumber numberWithInt: (int)displayID]];\n-  [retArray addObject: [NSString stringWithUTF8String: JNU_GetStringPlatformChars(env, mtlShadersLib, 0)]];\n-  if ([NSThread isMainThread]) {\n-      [MTLGraphicsConfigUtil _getMTLConfigInfo: retArray];\n-  } else {\n-      [MTLGraphicsConfigUtil performSelectorOnMainThread: @selector(_getMTLConfigInfo:) withObject: retArray waitUntilDone: YES];\n-  }\n-  NSNumber * num = (NSNumber *)[retArray objectAtIndex: 0];\n-  ret = (jlong)[num longValue];\n-  JNI_COCOA_EXIT(env);\n-  return ret;\n+    jlong ret = 0L;\n+    JNI_COCOA_ENTER(env);\n+    NSMutableArray * retArray = [NSMutableArray arrayWithCapacity:3];\n+    [retArray addObject: [NSNumber numberWithInt: (int)displayID]];\n+    [retArray addObject: [NSString stringWithUTF8String: JNU_GetStringPlatformChars(env, mtlShadersLib, 0)]];\n+\n+    [ThreadUtilities performOnMainThreadWaiting:YES block:^() {\n+        [MTLGraphicsConfigUtil _getMTLConfigInfo: retArray];\n+    }];\n+\n+    NSNumber * num = (NSNumber *)[retArray objectAtIndex: 0];\n+    ret = (jlong)[num longValue];\n+    JNI_COCOA_EXIT(env);\n+    return ret;\n","filename":"src\/java.desktop\/macosx\/native\/libawt_lwawt\/java2d\/metal\/MTLGraphicsConfig.m","additions":28,"deletions":28,"binary":false,"changes":56,"status":"modified"}]}