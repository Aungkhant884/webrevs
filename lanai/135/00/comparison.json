{"files":[{"patch":"@@ -232,2 +232,6 @@\n-    const int sw = srcInfo->bounds.x2 - srcInfo->bounds.x1;\n-    const int sh = srcInfo->bounds.y2 - srcInfo->bounds.y1;\n+    int sw = srcInfo->bounds.x2 - srcInfo->bounds.x1;\n+    int sh = srcInfo->bounds.y2 - srcInfo->bounds.y1;\n+\n+    sw = MIN(sw, mtlc.maxTextureSize);\n+    sh = MIN(sh, mtlc.maxTextureSize);\n+\n","filename":"src\/java.desktop\/macosx\/native\/libawt_lwawt\/java2d\/metal\/MTLBlitLoops.m","additions":6,"deletions":2,"binary":false,"changes":8,"status":"modified"},{"patch":"@@ -43,1 +43,4 @@\n-#define MTLC_BLIT_TILE_SIZE 128\n+\/\/ Constants from\n+\/\/ https:\/\/developer.apple.com\/metal\/Metal-Feature-Set-Tables.pdf\n+#define MTL_GPU_FAMILY_APPLE_1_TXT_SIZE 8192\n+#define MTL_GPU_FAMILY_APPLE_3_TXT_SIZE 16384\n@@ -71,0 +74,1 @@\n+@property (readonly) jint                      maxTextureSize;\n","filename":"src\/java.desktop\/macosx\/native\/libawt_lwawt\/java2d\/metal\/MTLContext.h","additions":5,"deletions":1,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -118,1 +118,1 @@\n-            texturePool, paint=_paint;\n+            texturePool, paint=_paint, maxTextureSize;\n@@ -127,0 +127,6 @@\n+        if (@available(macOS 10.15, *)) {\n+            maxTextureSize = [d supportsFamily:MTLGPUFamilyApple3] ?\n+                    MTL_GPU_FAMILY_APPLE_3_TXT_SIZE : MTL_GPU_FAMILY_APPLE_1_TXT_SIZE;\n+        } else {\n+            maxTextureSize = MTL_GPU_FAMILY_APPLE_1_TXT_SIZE;\n+        }\n","filename":"src\/java.desktop\/macosx\/native\/libawt_lwawt\/java2d\/metal\/MTLContext.m","additions":7,"deletions":1,"binary":false,"changes":8,"status":"modified"}]}