{"files":[{"patch":"@@ -259,0 +259,1 @@\n+                       constant TxtFrameUniforms& uniforms [[buffer(1)]],\n@@ -263,0 +264,1 @@\n+    const float srcA = uniforms.isSrcOpaque ? 1 : paintColor.a;\n@@ -266,1 +268,1 @@\n-                 renderColor.a);\n+                 srcA*renderColor.a) * uniforms.extraAlpha;\n@@ -602,1 +604,3 @@\n-        texture2d<float, access::sample> renderTexture [[texture(0)]])\n+        texture2d<float, access::sample> renderTexture [[texture(0)]],\n+        constant TxtFrameUniforms& uniforms [[buffer(1)]],\n+        sampler textureSampler [[sampler(0)]])\n@@ -604,4 +608,0 @@\n-    constexpr sampler textureSampler (address::repeat,\n-                                      mag_filter::nearest,\n-                                      min_filter::nearest);\n-\n@@ -609,4 +609,2 @@\n-    return half4(pixelColor.r, pixelColor.g, pixelColor.b, 1.0);\n-\n-    \/\/ This implementation defaults alpha to 1.0 as if source is opaque\n-    \/\/TODO : implement alpha component value if source is transparent\n+    const float srcA = uniforms.isSrcOpaque ? 1 : pixelColor.a;\n+    return half4(pixelColor.r, pixelColor.g, pixelColor.b, srcA) * uniforms.extraAlpha;\n","filename":"src\/java.desktop\/macosx\/native\/libawt_lwawt\/awt\/shaders.metal","additions":8,"deletions":10,"binary":false,"changes":18,"status":"modified"},{"patch":"@@ -438,0 +438,1 @@\n+                                                  isOpaque:srcOps->isOpaque\n@@ -444,1 +445,1 @@\n-                                                      yp3:yp3] autorelease] ;\n+                                                      yp3:yp3] autorelease];\n","filename":"src\/java.desktop\/macosx\/native\/libawt_lwawt\/java2d\/metal\/MTLContext.m","additions":2,"deletions":1,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -136,0 +136,1 @@\n+               isOpaque:(jboolean)isOpaque\n","filename":"src\/java.desktop\/macosx\/native\/libawt_lwawt\/java2d\/metal\/MTLPaints.h","additions":1,"deletions":0,"binary":false,"changes":1,"status":"modified"},{"patch":"@@ -660,0 +660,1 @@\n+    jboolean _isOpaque;\n@@ -664,0 +665,1 @@\n+               isOpaque:(jboolean)isOpaque\n@@ -683,0 +685,1 @@\n+        _isOpaque = isOpaque;\n@@ -704,1 +707,1 @@\n-    return [NSString stringWithFormat:@\"radial_gradient\"];\n+    return [NSString stringWithFormat:@\"texture_paint\"];\n@@ -725,2 +728,0 @@\n-        setTxtUniforms(encoder, 0, 0, renderOptions->interpolation, YES, [mtlc.composite getExtraAlpha],\n-                   &renderOptions->srcFlags, &renderOptions->dstFlags);\n@@ -731,0 +732,4 @@\n+    const SurfaceRasterFlags srcFlags = {_isOpaque, renderOptions->srcFlags.isPremultiplied};\n+    setTxtUniforms(encoder, 0, 0,\n+                   renderOptions->interpolation, YES, [mtlc.composite getExtraAlpha],\n+                   &srcFlags, &renderOptions->dstFlags);\n","filename":"src\/java.desktop\/macosx\/native\/libawt_lwawt\/java2d\/metal\/MTLPaints.m","additions":8,"deletions":3,"binary":false,"changes":11,"status":"modified"}]}