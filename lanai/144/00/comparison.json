{"files":[{"patch":"@@ -358,0 +358,8 @@\n+\n+    \/\/ TODO: Find out why we cannot use\n+    \/\/ if (_mtlc.clip.stencilMaskGenerationInProgress == YES) {\n+    \/\/     ca.loadAction = MTLLoadActionClear;\n+    \/\/     ca.clearColor = MTLClearColorMake(0.0f, 0.0f,0.0f, 0.0f);\n+    \/\/ }\n+    \/\/ here to avoid creation of clearEncoder in beginShapeClip\n+\n","filename":"src\/java.desktop\/macosx\/native\/libawt_lwawt\/java2d\/metal\/EncoderManager.m","additions":8,"deletions":0,"binary":false,"changes":8,"status":"modified"},{"patch":"@@ -155,1 +155,7 @@\n-        id <MTLBuffer> buff = [mtlc.device newBufferWithLength:size options:MTLResourceStorageModePrivate];\n+\n+        MTLRenderPassDescriptor* clearPassDescriptor = [MTLRenderPassDescriptor renderPassDescriptor];\n+        \/\/ set color buffer properties\n+        clearPassDescriptor.colorAttachments[0].texture = dstOps->pStencilData;\n+        clearPassDescriptor.colorAttachments[0].loadAction = MTLLoadActionClear;\n+        clearPassDescriptor.colorAttachments[0].clearColor = MTLClearColorMake(0.0f, 0.0f,0.0f, 0.0f);\n+\n@@ -157,15 +163,2 @@\n-        id<MTLBlitCommandEncoder> blitEncoder = [commandBuf blitCommandEncoder];\n-        [blitEncoder fillBuffer:buff range:NSMakeRange(0, size) value:0];\n-\n-        MTLOrigin origin = MTLOriginMake(0, 0, 0);\n-        MTLSize sourceSize = MTLSizeMake(width, height, 1);\n-        [blitEncoder copyFromBuffer:buff\n-                       sourceOffset:0\n-                  sourceBytesPerRow:width\n-                sourceBytesPerImage:size\n-                         sourceSize:sourceSize\n-                          toTexture:dstOps->pStencilData\n-                   destinationSlice:0\n-                   destinationLevel:0\n-                  destinationOrigin:origin];\n-        [blitEncoder endEncoding];\n+        id <MTLRenderCommandEncoder> clearEncoder = [commandBuf renderCommandEncoderWithDescriptor:clearPassDescriptor];\n+        [clearEncoder endEncoding];\n@@ -173,2 +166,0 @@\n-\n-        [buff release];\n","filename":"src\/java.desktop\/macosx\/native\/libawt_lwawt\/java2d\/metal\/MTLClip.m","additions":9,"deletions":18,"binary":false,"changes":27,"status":"modified"}]}