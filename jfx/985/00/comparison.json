{"files":[{"patch":"@@ -132,0 +132,14 @@\n+            double newValue = ((getMax() - getMin()) * Utils.clamp(0, pos, 1)) + getMin();\n+            \/**\n+             * JDK-8173321: Click on trough has no effect when cell height > viewport height:\n+             * Solution: Scroll one cell further up resp. down if only one cell is shown.\n+             *\/\n+            IndexedCell firstVisibleCell = flow.getFirstVisibleCell();\n+            IndexedCell lastVisibleCell = flow.getLastVisibleCell();\n+            if (firstVisibleCell == lastVisibleCell) {\n+                int index = firstVisibleCell.getIndex();\n+                if (newValue < oldValue) {\n+                    flow.scrollTo(index - 1);\n+                } else {\n+                    flow.scrollTo(index + 1);\n+                }\n@@ -133,9 +147,12 @@\n-            double newValue = ((getMax() - getMin()) * Utils.clamp(0, pos, 1))+getMin();\n-            if (newValue < oldValue) {\n-                IndexedCell cell = flow.getFirstVisibleCell();\n-                if (cell == null) return;\n-                flow.scrollToBottom(cell);\n-            } else if (newValue > oldValue) {\n-                IndexedCell cell = flow.getLastVisibleCell();\n-                if (cell == null) return;\n-                flow.scrollToTop(cell);\n+            } else {\n+                if (newValue < oldValue) {\n+                    IndexedCell cell = firstVisibleCell;\n+                    if (cell == null)\n+                        return;\n+                    flow.scrollToBottom(cell);\n+                } else if (newValue > oldValue) {\n+                    IndexedCell cell = lastVisibleCell;\n+                    if (cell == null)\n+                        return;\n+                    flow.scrollToTop(cell);\n+                }\n@@ -143,1 +160,0 @@\n-\n","filename":"modules\/javafx.controls\/src\/main\/java\/com\/sun\/javafx\/scene\/control\/VirtualScrollBar.java","additions":26,"deletions":10,"binary":false,"changes":36,"status":"modified"},{"patch":"@@ -2595,1 +2595,1 @@\n-            int numCellsVisibleOnScreen = 0;\n+            float numCellsVisibleOnScreen = 0;\n@@ -2599,1 +2599,2 @@\n-                    sumCellLength += (isVertical ? cell.getHeight() : cell.getWidth());\n+                    double lengthToAdd = (isVertical ? cell.getHeight() : cell.getWidth());\n+                    sumCellLength += lengthToAdd;\n@@ -2601,0 +2602,1 @@\n+                        numCellsVisibleOnScreen += ( 1 - (sumCellLength - flowLength )\/ lengthToAdd);\n@@ -2609,7 +2611,1 @@\n-            if (numCellsVisibleOnScreen == 0 && cellCount == 1) {\n-                \/\/ special case to help resolve RT-17701 and the case where we have\n-                \/\/ only a single row and it is bigger than the viewport\n-                lengthBar.setVisibleAmount(flowLength \/ sumCellLength);\n-            } else {\n-                lengthBar.setVisibleAmount(viewportLength \/ estimatedSize);\n-            }\n+            lengthBar.setVisibleAmount( numCellsVisibleOnScreen \/ (float) cellCount);\n","filename":"modules\/javafx.controls\/src\/main\/java\/javafx\/scene\/control\/skin\/VirtualFlow.java","additions":5,"deletions":9,"binary":false,"changes":14,"status":"modified"}]}