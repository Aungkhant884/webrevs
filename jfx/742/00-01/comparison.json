{"files":[{"patch":"@@ -844,1 +844,1 @@\n-                                        me.getButton(), me.getButtons(), me.getClickCount(),\n+                                        me.getButton(), me.getButtonMask(), me.getClickCount(),\n@@ -2684,1 +2684,1 @@\n-                                                int button, int buttons, int clickCount,\n+                                                int button, int buttonMask, int clickCount,\n","filename":"modules\/javafx.web\/src\/main\/java\/com\/sun\/webkit\/WebPage.java","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -49,1 +49,1 @@\n-    private final int buttons;\n+    private final int buttonMask;\n@@ -65,1 +65,1 @@\n-                        long when, boolean shift, boolean control, boolean alt, boolean meta, boolean popupTrigger, int buttons) {\n+                        long when, boolean shift, boolean control, boolean alt, boolean meta, boolean popupTrigger, int buttonMask) {\n@@ -79,1 +79,1 @@\n-        this.buttons = buttons;\n+        this.buttonMask = buttonMask;\n@@ -105,1 +105,1 @@\n-    public int getButtons() { return buttons; }\n+    public int getButtonMask() { return buttonMask; }\n","filename":"modules\/javafx.web\/src\/main\/java\/com\/sun\/webkit\/event\/WCMouseEvent.java","additions":4,"deletions":4,"binary":false,"changes":8,"status":"modified"},{"patch":"@@ -1088,2 +1088,3 @@\n-        final int buttonMask = ((ev.isPrimaryButtonDown() ? WCMouseEvent.BUTTON1 : WCMouseEvent.NOBUTTON) | (ev.isMiddleButtonDown() ? WCMouseEvent.BUTTON2 : WCMouseEvent.NOBUTTON) |\n-                                    (ev.isSecondaryButtonDown() ? WCMouseEvent.BUTTON3 : WCMouseEvent.NOBUTTON));\n+        final int buttonMask = ((ev.isPrimaryButtonDown()   ? WCMouseEvent.BUTTON1 : WCMouseEvent.NOBUTTON) |\n+                                (ev.isMiddleButtonDown()    ? WCMouseEvent.BUTTON2 : WCMouseEvent.NOBUTTON) |\n+                                (ev.isSecondaryButtonDown() ? WCMouseEvent.BUTTON3 : WCMouseEvent.NOBUTTON));\n","filename":"modules\/javafx.web\/src\/main\/java\/javafx\/scene\/web\/WebView.java","additions":3,"deletions":2,"binary":false,"changes":5,"status":"modified"},{"patch":"@@ -48,1 +48,1 @@\n-    enum MouseButtonPressed : uint8_t { NoButtonPress = 0, LeftButtonPress, RightButtonPress, MiddleButtonPress = 4 };\n+    enum MouseButtonMask : uint8_t { NoButtonMask = 0, LeftButtonMask, RightButtonMask, MiddleButtonMask = 4 };\n@@ -58,4 +58,2 @@\n-#if PLATFORM(JAVA)\n-        PlatformMouseEvent(const IntPoint& position, const IntPoint& globalPosition, MouseButton button, unsigned short buttons, PlatformEvent::Type type,\n-                           int clickCount, bool shiftKey, bool ctrlKey, bool altKey, bool metaKey, WallTime timestamp, double force,\n-                           SyntheticClickType syntheticClickType, PointerID pointerId = mousePointerID)\n+        PlatformMouseEvent(const IntPoint& position, const IntPoint& globalPosition, MouseButton button, PlatformEvent::Type type,\n+                           int clickCount, bool shiftKey, bool ctrlKey, bool altKey, bool metaKey, WallTime timestamp, double force, SyntheticClickType syntheticClickType, PointerID pointerId = mousePointerID)\n@@ -70,1 +68,0 @@\n-            , m_buttons(buttons)\n@@ -73,2 +70,3 @@\n-#endif\n-       PlatformMouseEvent(const IntPoint& position, const IntPoint& globalPosition, MouseButton button, PlatformEvent::Type type,\n+\n+#if PLATFORM(JAVA)\n+        PlatformMouseEvent(const IntPoint& position, const IntPoint& globalPosition, MouseButton button, unsigned short buttons, PlatformEvent::Type type,\n@@ -85,0 +83,1 @@\n+            , m_buttons(buttons)\n@@ -87,0 +86,1 @@\n+#endif\n","filename":"modules\/javafx.web\/src\/main\/native\/Source\/WebCore\/platform\/PlatformMouseEvent.h","additions":8,"deletions":8,"binary":false,"changes":16,"status":"modified"},{"patch":"@@ -50,1 +50,1 @@\n-    unsigned short buttons = NoButtonPress;\n+    unsigned short buttons = NoButtonMask;\n@@ -52,1 +52,1 @@\n-        buttons |= LeftButtonPress;\n+        buttons |= LeftButtonMask;\n@@ -55,1 +55,1 @@\n-        buttons |= MiddleButtonPress;\n+        buttons |= MiddleButtonMask;\n@@ -58,1 +58,1 @@\n-        buttons |= RightButtonPress;\n+        buttons |= RightButtonMask;\n","filename":"modules\/javafx.web\/src\/main\/native\/Source\/WebCore\/platform\/java\/MouseEventJava.cpp","additions":4,"deletions":4,"binary":false,"changes":8,"status":"modified"},{"patch":"@@ -1751,1 +1751,1 @@\n-     jint id, jint button, jint buttons, jint clickCount,\n+     jint id, jint button, jint buttonMask, jint clickCount,\n@@ -1777,1 +1777,1 @@\n-                                                       getWebCoreMouseButtons(buttons),\n+                                                       getWebCoreMouseButtons(buttonMask),\n","filename":"modules\/javafx.web\/src\/main\/native\/Source\/WebKitLegacy\/java\/WebCoreSupport\/WebPage.cpp","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -60,1 +60,1 @@\n-import static org.junit.Assert.fail;\n+import static org.junit.Assert.*;\n@@ -88,1 +88,0 @@\n-    private static CountDownLatch loadLatch;\n@@ -117,1 +116,1 @@\n-                    loadLatch.countDown();\n+                    startupLatch.countDown();\n@@ -128,1 +127,1 @@\n-    public String mouseButtonDrag(MouseButton... button) {\n+    public int mouseButtonDrag(MouseButton... buttons) {\n@@ -131,2 +130,2 @@\n-                        (int)(scene.getWindow().getY() + scene.getY() + DY ));\n-            robot.mousePress(button);\n+                            (int)(scene.getWindow().getY() + scene.getY() + DY));\n+            robot.mousePress(buttons);\n@@ -135,8 +134,7 @@\n-        for (int i = 0; i < DRAG_DISTANCE; i++) {\n-                final int c = i;\n-                Util.runAndWait(() -> {\n-                    \/\/ Move the mouse backwards so that the pointer does not stay on the popup,if any.\n-                    robot.mouseMove((int)(scene.getWindow().getX() + scene.getX() + DX - c),\n-                        (int)(scene.getWindow().getY() + scene.getY() + DY) );\n-            });\n-        }\n+        Util.runAndWait(() -> {\n+            for (int i = 0; i < DRAG_DISTANCE; i++) {\n+                \/\/ Move the mouse backwards so that the pointer does not stay on the popup, if any.\n+                robot.mouseMove((int)(scene.getWindow().getX() + scene.getX() + DX - i),\n+                                (int)(scene.getWindow().getY() + scene.getY() + DY));\n+            }\n+        });\n@@ -147,1 +145,1 @@\n-            robot.mouseRelease(button);\n+            robot.mouseRelease(buttons);\n@@ -150,1 +148,1 @@\n-        return buttonMask;\n+        return Integer.parseInt(buttonMask);\n@@ -155,2 +153,2 @@\n-        int result = Integer.parseInt(mouseButtonDrag(MouseButton.PRIMARY));\n-        Assert.assertEquals(LEFT_BUTTON_DRAG,result);\n+        int result = mouseButtonDrag(MouseButton.PRIMARY);\n+        assertEquals(LEFT_BUTTON_DRAG, result);\n@@ -161,2 +159,2 @@\n-        int result = Integer.parseInt(mouseButtonDrag(MouseButton.SECONDARY));\n-        Assert.assertEquals(RIGHT_BUTTON_DRAG,result);\n+        int result = mouseButtonDrag(MouseButton.SECONDARY);\n+        assertEquals(RIGHT_BUTTON_DRAG, result);\n@@ -167,2 +165,2 @@\n-        int result = Integer.parseInt(mouseButtonDrag(MouseButton.MIDDLE));\n-        Assert.assertEquals(MIDDLE_BUTTON_DRAG,result);\n+        int result = mouseButtonDrag(MouseButton.MIDDLE);\n+        assertEquals(MIDDLE_BUTTON_DRAG, result);\n@@ -173,2 +171,2 @@\n-        int result = Integer.parseInt(mouseButtonDrag(MouseButton.PRIMARY, MouseButton.MIDDLE));\n-        Assert.assertEquals((LEFT_BUTTON_DRAG|MIDDLE_BUTTON_DRAG),result);\n+        int result = mouseButtonDrag(MouseButton.PRIMARY, MouseButton.MIDDLE);\n+        assertEquals((LEFT_BUTTON_DRAG | MIDDLE_BUTTON_DRAG), result);\n@@ -179,2 +177,2 @@\n-        int result = Integer.parseInt(mouseButtonDrag(MouseButton.MIDDLE,MouseButton.SECONDARY));\n-        Assert.assertEquals((MIDDLE_BUTTON_DRAG|RIGHT_BUTTON_DRAG),result);\n+        int result = mouseButtonDrag(MouseButton.MIDDLE, MouseButton.SECONDARY);\n+        assertEquals((MIDDLE_BUTTON_DRAG | RIGHT_BUTTON_DRAG), result);\n@@ -185,2 +183,2 @@\n-        int result = Integer.parseInt(mouseButtonDrag(MouseButton.PRIMARY, MouseButton.SECONDARY));\n-        Assert.assertEquals((LEFT_BUTTON_DRAG|RIGHT_BUTTON_DRAG),result);\n+        int result = mouseButtonDrag(MouseButton.PRIMARY, MouseButton.SECONDARY);\n+        assertEquals((LEFT_BUTTON_DRAG | RIGHT_BUTTON_DRAG), result);\n@@ -191,2 +189,2 @@\n-        int result = Integer.parseInt(mouseButtonDrag(MouseButton.PRIMARY, MouseButton.MIDDLE, MouseButton.SECONDARY));\n-        Assert.assertEquals((LEFT_BUTTON_DRAG|MIDDLE_BUTTON_DRAG|RIGHT_BUTTON_DRAG),result);\n+        int result = mouseButtonDrag(MouseButton.PRIMARY, MouseButton.MIDDLE, MouseButton.SECONDARY);\n+        assertEquals((LEFT_BUTTON_DRAG | MIDDLE_BUTTON_DRAG | RIGHT_BUTTON_DRAG), result);\n@@ -197,2 +195,1 @@\n-        startupLatch = new CountDownLatch(1);\n-        loadLatch  = new CountDownLatch(1);\n+        startupLatch = new CountDownLatch(2);\n@@ -200,1 +197,0 @@\n-        waitForLatch(loadLatch, 10, \"Timeout waiting for loading webpage().\");\n@@ -215,1 +211,1 @@\n-            robot.mouseRelease(MouseButton.PRIMARY,MouseButton.MIDDLE,MouseButton.SECONDARY);\n+            robot.mouseRelease(MouseButton.PRIMARY, MouseButton.MIDDLE, MouseButton.SECONDARY);\n","filename":"tests\/system\/src\/test\/java\/test\/robot\/javafx\/web\/PointerEventTest.java","additions":30,"deletions":34,"binary":false,"changes":64,"status":"modified"}]}