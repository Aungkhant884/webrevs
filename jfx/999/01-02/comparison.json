{"files":[{"patch":"@@ -45,1 +45,0 @@\n-import java.lang.reflect.Method;\n@@ -54,0 +53,1 @@\n+\n@@ -56,2 +56,0 @@\n-    private static final String SWT_INTERNAL_CLASS =\n-            \"org.eclipse.swt.internal.gtk.OS\";\n@@ -67,15 +65,2 @@\n-        \/\/check for SWT-GTK lib presence\n-        @SuppressWarnings(\"removal\")\n-        Class<?> OS = AccessController.\n-                doPrivileged((PrivilegedAction<Class<?>>) () -> {\n-                    try {\n-                        return Class.forName(SWT_INTERNAL_CLASS, true,\n-                                ClassLoader.getSystemClassLoader());\n-                    } catch (Exception e) {}\n-                    try {\n-                        return Class.forName(SWT_INTERNAL_CLASS, true,\n-                                Thread.currentThread().getContextClassLoader());\n-                    } catch (Exception e) {}\n-                    return null;\n-                });\n-        if (OS != null) {\n+        String gtkVersion = System.getProperty(\"org.eclipse.swt.internal.gtk.version\");\n+        if (gtkVersion != null && gtkVersion.contains(\".\")) {\n@@ -83,22 +68,4 @@\n-            logger.fine(\"SWT-GTK library found. Try to obtain GTK version.\");\n-            @SuppressWarnings(\"removal\")\n-            Method method = AccessController.\n-                    doPrivileged((PrivilegedAction<Method>) () -> {\n-                        try {\n-                            return OS.getMethod(\"gtk_major_version\");\n-                        } catch (Exception e) {\n-                            return null;\n-                        }\n-                    });\n-            int ver = 0;\n-            if (method != null) {\n-                try {\n-                    ver = ((Number)method.invoke(OS)).intValue();\n-                } catch (Exception e) {\n-                    logger.warning(\"Method gtk_major_version() of \" +\n-                         \"the org.eclipse.swt.internal.gtk.OS class \" +\n-                         \"returns error. SWT GTK version cannot be detected. \" +\n-                         \"GTK3 will be used as default.\");\n-                    ver = 3;\n-                }\n-            }\n+            logger.fine(String.format(\"SWT-GTK library found. Gtk Version = %s.\", gtkVersion));\n+            String[] vers = gtkVersion.split(\"\\\\.\");\n+            int ver = Integer.parseInt(vers[0]);\n+\n@@ -110,0 +77,1 @@\n+\n","filename":"modules\/javafx.graphics\/src\/main\/java\/com\/sun\/glass\/ui\/gtk\/GtkApplication.java","additions":8,"deletions":40,"binary":false,"changes":48,"status":"modified"}]}