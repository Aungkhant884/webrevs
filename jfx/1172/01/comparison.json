{"files":[{"patch":"@@ -346,0 +346,1 @@\n+        updateDisclosureNodeAndGraphic();\n","filename":"modules\/javafx.controls\/src\/main\/java\/javafx\/scene\/control\/skin\/TreeTableRowSkin.java","additions":1,"deletions":0,"binary":false,"changes":1,"status":"modified"},{"patch":"@@ -31,0 +31,1 @@\n+import static org.junit.jupiter.api.Assertions.assertFalse;\n@@ -48,0 +49,1 @@\n+import javafx.scene.shape.Rectangle;\n@@ -359,0 +361,45 @@\n+    \/\/ See JDK-8285700\n+    @Test\n+    public void testGraphicVisibilityOfTreeItem() {\n+        TreeTableView<String> tree = new TreeTableView<>();\n+        stageLoader = new StageLoader(tree);\n+\n+        TreeTableColumn<String, String> column = new TreeTableColumn<>(\"Column\");\n+        tree.getColumns().add(column);\n+        tree.setRoot(new TreeItem(\"Root\"));\n+\n+        for (int i = 0; i < 4; i++) {\n+            TreeItem parent = new TreeItem(\"item - \" + i, new Rectangle(10, 10));\n+            TreeItem subNode = new TreeItem(\"sub-node - \" + i, new Rectangle(10, 10));\n+            parent.getChildren().addAll(subNode);\n+            tree.getRoot().getChildren().add(parent);\n+        }\n+        tree.getRoot().setExpanded(true);\n+\n+        int itemNodeSize = tree.getRoot().getChildren().size();\n+        TreeItem treeItem = (TreeItem)tree.getRoot().getChildren().get(itemNodeSize - 2);\n+        TreeItem treeItemSubNode = (TreeItem)tree.getRoot().getChildren().get(itemNodeSize - 2).getChildren().get(0);\n+        TreeItem lastItem = (TreeItem)tree.getRoot().getChildren().get(itemNodeSize - 1);\n+\n+        Toolkit.getToolkit().firePulse();\n+        assertFalse(treeItem.isExpanded());\n+        double lastItemBeforeExpand = lastItem.getGraphic().localToScene(lastItem.getGraphic().getBoundsInLocal()).getMinY();\n+\n+        treeItem.setExpanded(true);\n+        Toolkit.getToolkit().firePulse();\n+        assertTrue(treeItem.isExpanded());\n+        assertNotEquals(lastItemBeforeExpand, lastItem.getGraphic().localToScene(lastItem.getGraphic().getBoundsInLocal()).getMinY());\n+        double treeItemSubNodeAfterExpand = treeItemSubNode.getGraphic().localToScene(treeItemSubNode.getGraphic().getBoundsInLocal()).getMinY();\n+\n+        treeItem.setExpanded(false);\n+        Toolkit.getToolkit().firePulse();\n+        assertFalse(treeItem.isExpanded());\n+        assertEquals(lastItemBeforeExpand, lastItem.getGraphic().localToScene(lastItem.getGraphic().getBoundsInLocal()).getMinY());\n+        assertNotEquals(treeItemSubNodeAfterExpand, treeItemSubNode.getGraphic().localToScene(treeItemSubNode.getGraphic().getBoundsInLocal()).getMinY());\n+\n+        treeItem.setExpanded(true);\n+        Toolkit.getToolkit().firePulse();\n+        assertTrue(treeItem.isExpanded());\n+        assertEquals(treeItemSubNodeAfterExpand, treeItemSubNode.getGraphic().localToScene(treeItemSubNode.getGraphic().getBoundsInLocal()).getMinY());\n+    }\n+\n","filename":"modules\/javafx.controls\/src\/test\/java\/test\/javafx\/scene\/control\/skin\/TreeTableRowSkinTest.java","additions":47,"deletions":0,"binary":false,"changes":47,"status":"modified"},{"patch":"@@ -42,0 +42,2 @@\n+import javafx.scene.paint.Color;\n+import javafx.scene.shape.Rectangle;\n@@ -117,0 +119,2 @@\n+    protected final CheckBox addGraphics;\n+    protected final CheckBox addSubNodes;\n@@ -153,0 +157,12 @@\n+        addGraphics = new CheckBox(\"add graphics\");\n+        addGraphics.setId(\"addGraphics\");\n+        addGraphics.selectedProperty().addListener((s, p, c) -> {\n+            updatePane();\n+        });\n+\n+        addSubNodes = new CheckBox(\"add sub-nodes\");\n+        addSubNodes.setId(\"addSubNodes\");\n+        addSubNodes.selectedProperty().addListener((s, p, c) -> {\n+            updatePane();\n+        });\n+\n@@ -170,0 +186,2 @@\n+        p.option(addGraphics);\n+        p.option(addSubNodes);\n@@ -566,0 +584,1 @@\n+                        TreeItem subNodeTreeItem = null;\n@@ -567,1 +586,12 @@\n-                            tree.getRoot().getChildren().add(new TreeItem(newItem()));\n+                            TreeItem treeItem = new TreeItem(newItem());\n+                            if (addSubNodes.isSelected()) {\n+                                subNodeTreeItem = new TreeItem(newItem());\n+                                treeItem.getChildren().add(subNodeTreeItem);\n+                            }\n+                            if (addGraphics.isSelected()) {\n+                                treeItem.setGraphic(new Rectangle(10, 10, Color.RED));\n+                                if (subNodeTreeItem != null) {\n+                                    subNodeTreeItem.setGraphic(new Rectangle(10, 10));\n+                                }\n+                            }\n+                            tree.getRoot().getChildren().add(treeItem);\n","filename":"tests\/manual\/monkey\/src\/com\/oracle\/tools\/fx\/monkey\/pages\/TreeTableViewPage.java","additions":31,"deletions":1,"binary":false,"changes":32,"status":"modified"}]}