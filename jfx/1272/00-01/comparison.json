{"files":[{"patch":"@@ -41,10 +41,5 @@\n-    if (srcPixels_arr == NULL ||\n-        dstPixels_arr == NULL ||\n-        srcw <= 0 ||\n-        srch <= 0 ||\n-        srcw > INT_MAX \/ srch ||\n-        dstw <= 0 ||\n-        dsth <= 0 ||\n-        dstw > INT_MAX \/ dsth ||\n-        (srcw * srch) > env->GetArrayLength(srcPixels_arr) ||\n-        (dstw * dsth) > env->GetArrayLength(dstPixels_arr) ||\n+    if ((checkRange(env,\n+                    dstPixels_arr,\n+                    dstw, dsth,\n+                    srcPixels_arr,\n+                    srcw, srch)) ||\n@@ -106,10 +101,5 @@\n-    if (srcPixels_arr == NULL ||\n-        dstPixels_arr == NULL ||\n-        srcw <= 0 ||\n-        srch <= 0 ||\n-        srcw > INT_MAX \/ srch ||\n-        dstw <= 0 ||\n-        dsth <= 0 ||\n-        dstw > INT_MAX \/ dsth ||\n-        (srcw * srch) > env->GetArrayLength(srcPixels_arr) ||\n-        (dstw * dsth) > env->GetArrayLength(dstPixels_arr) ||\n+    if ((checkRange(env,\n+                    dstPixels_arr,\n+                    dstw, dsth,\n+                    srcPixels_arr,\n+                    srcw, srch)) ||\n@@ -180,10 +170,5 @@\n-    if (srcPixels_arr == NULL ||\n-        dstPixels_arr == NULL ||\n-        srcw <= 0 ||\n-        srch <= 0 ||\n-        srcw > INT_MAX \/ srch ||\n-        dstw <= 0 ||\n-        dsth <= 0 ||\n-        dstw > INT_MAX \/ dsth ||\n-        (srcw * srch) > env->GetArrayLength(srcPixels_arr) ||\n-        (dstw * dsth) > env->GetArrayLength(dstPixels_arr) ||\n+    if ((checkRange(env,\n+                    dstPixels_arr,\n+                    dstw, dsth,\n+                    srcPixels_arr,\n+                    srcw, srch)) ||\n","filename":"modules\/javafx.graphics\/src\/main\/native-decora\/SSEBoxBlurPeer.cc","additions":15,"deletions":30,"binary":false,"changes":45,"status":"modified"},{"patch":"@@ -42,10 +42,5 @@\n-    if (srcPixels_arr == NULL ||\n-        dstPixels_arr == NULL ||\n-        srcw <= 0 ||\n-        srch <= 0 ||\n-        srcw > INT_MAX \/ srch ||\n-        dstw <= 0 ||\n-        dsth <= 0 ||\n-        dstw > INT_MAX \/ dsth ||\n-        (srcw * srch) > env->GetArrayLength(srcPixels_arr) ||\n-        (dstw * dsth) > env->GetArrayLength(dstPixels_arr) ||\n+    if ((checkRange(env,\n+                    dstPixels_arr,\n+                    dstw, dsth,\n+                    srcPixels_arr,\n+                    srcw, srch)) ||\n@@ -103,10 +98,5 @@\n-    if (srcPixels_arr == NULL ||\n-        dstPixels_arr == NULL ||\n-        srcw <= 0 ||\n-        srch <= 0 ||\n-        srcw > INT_MAX \/ srch ||\n-        dstw <= 0 ||\n-        dsth <= 0 ||\n-        dstw > INT_MAX \/ dsth ||\n-        (srcw * srch) > env->GetArrayLength(srcPixels_arr) ||\n-        (dstw * dsth) > env->GetArrayLength(dstPixels_arr) ||\n+    if ((checkRange(env,\n+                    dstPixels_arr,\n+                    dstw, dsth,\n+                    srcPixels_arr,\n+                    srcw, srch)) ||\n@@ -165,10 +155,5 @@\n-    if (srcPixels_arr == NULL ||\n-        dstPixels_arr == NULL ||\n-        srcw <= 0 ||\n-        srch <= 0 ||\n-        srcw > INT_MAX \/ srch ||\n-        dstw <= 0 ||\n-        dsth <= 0 ||\n-        dstw > INT_MAX \/ dsth ||\n-        (srcw * srch) > env->GetArrayLength(srcPixels_arr) ||\n-        (dstw * dsth) > env->GetArrayLength(dstPixels_arr) ||\n+    if ((checkRange(env,\n+                    dstPixels_arr,\n+                    dstw, dsth,\n+                    srcPixels_arr,\n+                    srcw, srch)) ||\n","filename":"modules\/javafx.graphics\/src\/main\/native-decora\/SSEBoxShadowPeer.cc","additions":15,"deletions":30,"binary":false,"changes":45,"status":"modified"},{"patch":"@@ -113,10 +113,5 @@\n-    if (srcPixels_arr == NULL ||\n-        dstPixels_arr == NULL ||\n-        srccols <= 0 ||\n-        srcrows <= 0 ||\n-        srccols > INT_MAX \/ srcrows ||\n-        dstcols <= 0 ||\n-        dstrows <= 0 ||\n-        dstcols > INT_MAX \/ dstrows ||\n-        (srccols * srcrows) > env->GetArrayLength(srcPixels_arr) ||\n-        (dstcols * dstrows) > env->GetArrayLength(dstPixels_arr) ||\n+    if ((checkRange(env,\n+                    dstPixels_arr,\n+                    dstcols, dstrows,\n+                    srcPixels_arr,\n+                    srccols, srcrows)) ||\n","filename":"modules\/javafx.graphics\/src\/main\/native-decora\/SSELinearConvolvePeer.cc","additions":5,"deletions":10,"binary":false,"changes":15,"status":"modified"},{"patch":"@@ -121,10 +121,5 @@\n-    if (srcPixels_arr == NULL ||\n-        dstPixels_arr == NULL ||\n-        srccols <= 0 ||\n-        srcrows <= 0 ||\n-        srccols > INT_MAX \/ srcrows ||\n-        dstcols <= 0 ||\n-        dstrows <= 0 ||\n-        dstcols > INT_MAX \/ dstrows ||\n-        (srccols * srcrows) > env->GetArrayLength(srcPixels_arr) ||\n-        (dstcols * dstrows) > env->GetArrayLength(dstPixels_arr) ||\n+    if ((checkRange(env,\n+                    dstPixels_arr,\n+                    dstcols, dstrows,\n+                    srcPixels_arr,\n+                    srccols, srcrows)) ||\n","filename":"modules\/javafx.graphics\/src\/main\/native-decora\/SSELinearConvolveShadowPeer.cc","additions":5,"deletions":10,"binary":false,"changes":15,"status":"modified"},{"patch":"@@ -186,0 +186,18 @@\n+\n+bool checkRange(JNIEnv *env,\n+                jintArray dstPixels_arr,\n+                jint dstw, jint dsth,\n+                jintArray srcPixels_arr,\n+                jint srcw, jint srch)\n+{\n+    return (srcPixels_arr == NULL ||\n+            dstPixels_arr == NULL ||\n+            srcw <= 0 ||\n+            srch <= 0 ||\n+            srcw > INT_MAX \/ srch ||\n+            dstw <= 0 ||\n+            dsth <= 0 ||\n+            dstw > INT_MAX \/ dsth ||\n+            (srcw * srch) > env->GetArrayLength(srcPixels_arr) ||\n+            (dstw * dsth) > env->GetArrayLength(dstPixels_arr));\n+}\n","filename":"modules\/javafx.graphics\/src\/main\/native-decora\/SSEUtils.cc","additions":18,"deletions":0,"binary":false,"changes":18,"status":"modified"},{"patch":"@@ -60,0 +60,6 @@\n+bool checkRange(JNIEnv *env,\n+                jintArray dstPixels_arr,\n+                jint dstw, jint dsth,\n+                jintArray srcPixels_arr,\n+                jint srcw, jint srch);\n+\n","filename":"modules\/javafx.graphics\/src\/main\/native-decora\/SSEUtils.h","additions":6,"deletions":0,"binary":false,"changes":6,"status":"modified"}]}