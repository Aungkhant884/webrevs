{"files":[{"patch":"@@ -943,1 +943,1 @@\n-    gint x, y, w, h, gtk_w, gtk_h;\n+    gint x, y, w, h, cw, ch;\n@@ -945,2 +945,3 @@\n-    gtk_w = event->width;\n-    gtk_h = event->height;\n+    \/\/content width \/ height\n+    cw = event->width;\n+    ch = event->height;\n@@ -948,2 +949,2 @@\n-    w = gtk_w + geometry.adjust_w;\n-    h = gtk_h + geometry.adjust_h;\n+    w = cw + geometry.adjust_w;\n+    h = ch + geometry.adjust_h;\n@@ -955,1 +956,1 @@\n-                            || geometry.current_cw != gtk_w || geometry.current_ch != gtk_h;\n+                            || geometry.current_cw != cw || geometry.current_ch != ch;\n@@ -961,2 +962,2 @@\n-    geometry.current_cw = gtk_w;\n-    geometry.current_ch = gtk_h;\n+    geometry.current_cw = cw;\n+    geometry.current_ch = ch;\n@@ -965,2 +966,2 @@\n-        geometry.last_cw = gtk_w;\n-        geometry.last_ch = gtk_h;\n+        geometry.last_cw = cw;\n+        geometry.last_ch = ch;\n@@ -1076,0 +1077,3 @@\n+    bool size_changed = false;\n+    bool pos_changed = false;\n+\n@@ -1083,5 +1087,7 @@\n-        apply_geometry();\n-        gtk_window_resize(GTK_WINDOW(gtk_widget), newW, newH);\n-\n-        if (!map_received) {\n-            size_position_notify(true, false);\n+        if (visible_received) {\n+            \/\/ call apply_geometry() to let gtk_window_resize succeed, because it's bound to\n+            \/\/ geometry constraints\n+            apply_geometry();\n+            gtk_window_resize(GTK_WINDOW(gtk_widget), newW, newH);\n+        } else {\n+            gtk_window_set_default_size(GTK_WINDOW(gtk_widget), newW, newH);\n@@ -1089,0 +1095,2 @@\n+\n+        size_changed = true;\n@@ -1095,3 +1103,2 @@\n-        if (newX != geometry.current_x || newY != geometry.current_y) {\n-            geometry.current_x = newX;\n-            geometry.current_y = newY;\n+        geometry.current_x = newX;\n+        geometry.current_y = newY;\n@@ -1099,1 +1106,1 @@\n-            gtk_window_move(GTK_WINDOW(gtk_widget), newX, newY);\n+        gtk_window_move(GTK_WINDOW(gtk_widget), newX, newY);\n@@ -1101,4 +1108,5 @@\n-            if (!map_received) {\n-                size_position_notify(false, true);\n-            }\n-        }\n+        pos_changed = true;\n+    }\n+\n+    if (size_changed || pos_changed) {\n+        size_position_notify(size_changed, pos_changed);\n","filename":"modules\/javafx.graphics\/src\/main\/native-glass\/gtk\/glass_window.cpp","additions":31,"deletions":23,"binary":false,"changes":54,"status":"modified"}]}