{"files":[{"patch":"@@ -210,1 +210,1 @@\n-        try (var output = new ByteArrayOutputStream(input.length())) {\n+        try (var output = new ByteArrayOutputStream(size(input))) {\n@@ -213,1 +213,1 @@\n-        } catch (IOException ignored) {\n+        } catch (IOException ex) {\n@@ -215,1 +215,1 @@\n-            return null;\n+            throw new AssertionError(ex);\n@@ -220,1 +220,21 @@\n-     * Decodes percent-encoded text as specified by RFC 3986, page 11.\n+     * Computes the payload size of the percent-encoded string.\n+     *\n+     * @param input the input string\n+     * @return the payload size in bytes\n+     *\/\n+    private static int size(String input) {\n+        int count = 0;\n+\n+        for (int i = 0, max = input.length(); i < max; ++i) {\n+            if (input.charAt(i) == '%') {\n+                i += 2;\n+            }\n+\n+            ++count;\n+        }\n+\n+        return count;\n+    }\n+\n+    \/**\n+     * Decodes percent-encoded text as specified by RFC 3986, section 2.1\n@@ -224,1 +244,1 @@\n-        enum ParseState {\n+        enum ExpectedCharacter {\n@@ -230,1 +250,1 @@\n-        ParseState parseState = ParseState.DEFAULT;\n+        ExpectedCharacter expectedCharacter = ExpectedCharacter.DEFAULT;\n@@ -236,1 +256,1 @@\n-            parseState = switch (parseState) {\n+            expectedCharacter = switch (expectedCharacter) {\n@@ -239,1 +259,1 @@\n-                        yield ParseState.FIRST_HEX_DIGIT;\n+                        yield ExpectedCharacter.FIRST_HEX_DIGIT;\n@@ -242,1 +262,1 @@\n-                        yield ParseState.DEFAULT;\n+                        yield ExpectedCharacter.DEFAULT;\n@@ -248,1 +268,1 @@\n-                    yield ParseState.SECOND_HEX_DIGIT;\n+                    yield ExpectedCharacter.SECOND_HEX_DIGIT;\n@@ -253,1 +273,1 @@\n-                    yield ParseState.DEFAULT;\n+                    yield ExpectedCharacter.DEFAULT;\n@@ -258,1 +278,1 @@\n-        if (parseState != ParseState.DEFAULT) {\n+        if (expectedCharacter != ExpectedCharacter.DEFAULT) {\n","filename":"modules\/javafx.graphics\/src\/main\/java\/com\/sun\/javafx\/util\/DataURI.java","additions":32,"deletions":12,"binary":false,"changes":44,"status":"modified"}]}