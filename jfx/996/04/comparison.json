{"files":[{"patch":"@@ -319,0 +319,1 @@\n+        final ContentDisplay contentDisplay = labeled.getContentDisplay();\n@@ -321,0 +322,1 @@\n+        boolean isIgnoreText = isIgnoreText();\n@@ -323,1 +325,1 @@\n-        if (!isIgnoreText()) {\n+        if (!isIgnoreText) {\n@@ -327,8 +329,1 @@\n-        double textWidth = 0.0;\n-        if (!emptyText) {\n-            textWidth = Utils.computeTextWidth(font, cleanText, 0);\n-        }\n-\n-        \/\/ Fix for RT-39889\n-        double graphicWidth = graphic == null ? 0.0 :\n-                Utils.boundedSize(graphic.prefWidth(-1), graphic.minWidth(-1), graphic.maxWidth(-1));\n+        double textWidth = emptyText ? 0.0 : Utils.computeTextWidth(font, cleanText, 0);\n@@ -336,1 +331,1 @@\n-        \/\/ Now add on the graphic, gap, and padding as appropriate\n+        double width;\n@@ -338,6 +333,1 @@\n-            return textWidth + widthPadding;\n-        } else if (isIgnoreText()) {\n-            return graphicWidth + widthPadding;\n-        } else if (labeled.getContentDisplay() == ContentDisplay.LEFT\n-                || labeled.getContentDisplay() == ContentDisplay.RIGHT) {\n-            return textWidth + labeled.getGraphicTextGap() + graphicWidth + widthPadding;\n+            width = textWidth;\n@@ -345,1 +335,12 @@\n-            return Math.max(textWidth, graphicWidth) + widthPadding;\n+            \/\/ Fix for RT-39889\n+            double graphicWidth = graphic == null ? 0.0 :\n+                    Utils.boundedSize(graphic.prefWidth(-1), graphic.minWidth(-1), graphic.maxWidth(-1));\n+\n+            if (isIgnoreText) {\n+                width = graphicWidth;\n+            } else if (contentDisplay == ContentDisplay.LEFT\n+                    || contentDisplay == ContentDisplay.RIGHT) {\n+                width = textWidth + labeled.getGraphicTextGap() + graphicWidth;\n+            } else {\n+                width = Math.max(textWidth, graphicWidth);\n+            }\n@@ -347,0 +348,2 @@\n+\n+        return width + widthPadding;\n@@ -355,0 +358,2 @@\n+        boolean isIgnoreText = isIgnoreText();\n+        boolean isIgnoreGraphic = isIgnoreGraphic();\n@@ -357,2 +362,2 @@\n-\n-        if (!isIgnoreText()) {\n+        double padding = topInset + bottomInset;\n+        if (!isIgnoreText) {\n@@ -360,0 +365,1 @@\n+            padding += topLabelPadding() + bottomLabelPadding();\n@@ -369,1 +375,1 @@\n-        if (!isIgnoreGraphic() &&\n+        if (!isIgnoreGraphic &&\n@@ -379,6 +385,13 @@\n-        \/\/ Now we want to add on the graphic if necessary!\n-        double h = textHeight;\n-        if (!isIgnoreGraphic()) {\n-            final Node graphic = labeled.getGraphic();\n-            if (contentDisplay == TOP || contentDisplay == BOTTOM) {\n-                h = graphic.prefHeight(width) + gap + textHeight;\n+        double height;\n+        if (isIgnoreGraphic) {\n+            height = textHeight;\n+        } else {\n+            \/\/ Calculate the graphic height and use based on contentDisplay value\n+            double graphicHeight = graphic == null ? 0.0 :\n+                Utils.boundedSize(graphic.prefHeight(width), graphic.minHeight(width), graphic.maxHeight(width));\n+\n+            \/\/ Add the graphic, gap, and padding as appropriate\n+            if (isIgnoreText) {\n+                height = graphicHeight;\n+            } else if (contentDisplay == TOP || contentDisplay == BOTTOM) {\n+                height = graphicHeight + gap + textHeight;\n@@ -386,1 +399,1 @@\n-                h = Math.max(textHeight, graphic.prefHeight(width));\n+                height = Math.max(textHeight, graphicHeight);\n@@ -390,7 +403,1 @@\n-        double padding = topInset + bottomInset;\n-\n-        if (!isIgnoreText()) {\n-            padding += topLabelPadding() + bottomLabelPadding();\n-        }\n-\n-        return  h + padding;\n+        return  height + padding;\n","filename":"modules\/javafx.controls\/src\/main\/java\/javafx\/scene\/control\/skin\/LabeledSkinBase.java","additions":41,"deletions":34,"binary":false,"changes":75,"status":"modified"},{"patch":"@@ -1252,2 +1252,1 @@\n-        final double lineHeight = Utils.computeTextHeight(label.getFont(), \" \", 0, text.getBoundsType());\n-        assertEquals(14 + 23 + lineHeight + 2, label.prefHeight(-1), 0);\n+        assertEquals(14 + 23, label.prefHeight(-1), 0);\n@@ -1263,2 +1262,1 @@\n-        final double lineHeight = Utils.computeTextHeight(label.getFont(), \" \", 0, text.getBoundsType());\n-        assertEquals(14 + 23 + lineHeight + 2, label.prefHeight(-1), 0);\n+        assertEquals(14 + 23, label.prefHeight(-1), 0);\n@@ -1315,2 +1313,1 @@\n-        final double lineHeight = Utils.computeTextHeight(label.getFont(), \" \", 0, text.getBoundsType());\n-        assertEquals(14 + 23 + lineHeight + 2, label.prefHeight(-1), 0);\n+        assertEquals(14 + 23, label.prefHeight(-1), 0);\n@@ -1326,2 +1323,1 @@\n-        final double lineHeight = Utils.computeTextHeight(label.getFont(), \" \", 0, text.getBoundsType());\n-        assertEquals(14 + 23 + lineHeight + 2, label.prefHeight(-1), 0);\n+        assertEquals(14 + 23, label.prefHeight(-1), 0);\n@@ -1810,2 +1806,1 @@\n-        final double lineHeight = Utils.computeTextHeight(label.getFont(), \" \", 0, text.getBoundsType());\n-        assertEquals(14 + 23 + lineHeight + 2, label.maxHeight(-1), 0);\n+        assertEquals(14 + 23, label.maxHeight(-1), 0);\n@@ -1821,2 +1816,1 @@\n-        final double lineHeight = Utils.computeTextHeight(label.getFont(), \" \", 0, text.getBoundsType());\n-        assertEquals(14 + 23 + lineHeight + 2, label.maxHeight(-1), 0);\n+        assertEquals(14 + 23, label.maxHeight(-1), 0);\n@@ -1873,2 +1867,1 @@\n-        final double lineHeight = Utils.computeTextHeight(label.getFont(), \" \", 0, text.getBoundsType());\n-        assertEquals(14 + 23 + lineHeight + 2, label.maxHeight(-1), 0);\n+        assertEquals(14 + 23, label.maxHeight(-1), 0);\n@@ -1884,2 +1877,1 @@\n-        final double lineHeight = Utils.computeTextHeight(label.getFont(), \" \", 0, text.getBoundsType());\n-        assertEquals(14 + 23 + lineHeight + 2, label.maxHeight(-1), 0);\n+        assertEquals(14 + 23, label.maxHeight(-1), 0);\n","filename":"modules\/javafx.controls\/src\/test\/java\/test\/javafx\/scene\/control\/skin\/LabelSkinTest.java","additions":8,"deletions":16,"binary":false,"changes":24,"status":"modified"}]}