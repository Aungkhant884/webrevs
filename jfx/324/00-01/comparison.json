{"files":[{"patch":"@@ -182,7 +182,11 @@\n-        if (PublicSuffixes.isPublicSuffix(cookie.getDomain())) {\n-            if (cookie.getDomain().equals(host)) {\n-                cookie.setDomain(\"\");\n-            } else {\n-                logger.finest(\"Domain is public suffix, \"\n-                        + \"ignoring cookie\");\n-                return;\n+        if (!PublicSuffixes.pslFileExists()) {\n+            cookie.setDomain(\"\");\n+        } else {\n+            if (PublicSuffixes.isPublicSuffix(cookie.getDomain())) {\n+                if (cookie.getDomain().equals(host)) {\n+                    cookie.setDomain(\"\");\n+                } else {\n+                    logger.finest(\"Domain is public suffix, \"\n+                            + \"ignoring cookie\");\n+                    return;\n+                }\n","filename":"modules\/javafx.web\/src\/main\/java\/com\/sun\/webkit\/network\/CookieManager.java","additions":11,"deletions":7,"binary":false,"changes":18,"status":"modified"},{"patch":"@@ -67,1 +67,1 @@\n-     * The mapping from domain names to public suffix list rules.\n+     * The mapping from top-level domain names to public suffix list rules.\n@@ -72,0 +72,12 @@\n+    \/*\n+     * Determines whether the public suffix list file is available.\n+     *\/\n+    private static final boolean pslFileExists = AccessController.doPrivileged(\n+        (PrivilegedAction<Boolean>) () -> {\n+            String javaHome = System.getProperty(\"java.home\");\n+            String resourceName = \"lib\/security\/public_suffix_list.dat\";\n+            File f = new File(javaHome, resourceName);\n+            return f.exists();\n+        });\n+\n+\n@@ -80,0 +92,8 @@\n+    \/**\n+     * Returns whether the public suffix list file is available.\n+     *\/\n+    static boolean pslFileExists() {\n+        return pslFileExists;\n+    }\n+\n+\n@@ -88,0 +108,3 @@\n+        if (!pslFileExists())\n+            return false;\n+\n","filename":"modules\/javafx.web\/src\/main\/java\/com\/sun\/webkit\/network\/PublicSuffixes.java","additions":24,"deletions":1,"binary":false,"changes":25,"status":"modified"}]}