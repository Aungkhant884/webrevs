{"files":[{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2010, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2010, 2023, Oracle and\/or its affiliates. All rights reserved.\n@@ -8244,1 +8244,1 @@\n-                } while (node != null && !node.focused.get());\n+                } while (node != null);\n@@ -8299,0 +8299,2 @@\n+        private int count; \/\/ the number of downstream focused nodes\n+\n@@ -8308,0 +8310,9 @@\n+\n+        @Override\n+        public void set(boolean value) {\n+            if (value && ++count == 1) {\n+                super.set(true);\n+            } else if (!value && --count == 0) {\n+                super.set(false);\n+            }\n+        }\n","filename":"modules\/javafx.graphics\/src\/main\/java\/javafx\/scene\/Node.java","additions":13,"deletions":2,"binary":false,"changes":15,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2010, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2010, 2023, Oracle and\/or its affiliates. All rights reserved.\n@@ -1014,1 +1014,1 @@\n-    @Test public void testMultiLevelFocusWithinIsPreserved() {\n+    @Test public void testMultiLevelFocusWithinIsPreservedWhenFocusedNodeIsRemoved() {\n@@ -1054,0 +1054,42 @@\n+    \/**\n+     * When a scene graph contains multiple nested focused nodes, the focusWithin bits that would\n+     * be cleared when a focused node is de-focused must not be cleared when we have another\n+     * focused downstream node.\n+     *\/\n+    @Test public void testMultiLevelFocusWithinIsPreservedWhenIntermediateFocusedNodeIsDefocused() {\n+        class N extends Group {\n+            N(Node... children) { super(children); }\n+            void _setFocused(boolean value) { setFocused(value); }\n+        }\n+\n+        N node1, node2, node3, node4;\n+\n+        scene.setRoot(\n+            node1 = new N(\n+                node2 = new N(\n+                    node3 = new N(\n+                        node4 = new N()\n+                    )\n+                )\n+            ));\n+\n+        node2._setFocused(true);\n+        node4._setFocused(true);\n+        assertIsFocusWithin(node1);\n+        assertIsFocusWithin(node2);\n+        assertIsFocusWithin(node3);\n+        assertIsFocusWithin(node4);\n+\n+        node2._setFocused(false);\n+        assertIsFocusWithin(node1);\n+        assertIsFocusWithin(node2);\n+        assertIsFocusWithin(node3);\n+        assertIsFocusWithin(node4);\n+\n+        node4._setFocused(false);\n+        assertNotFocusWithin(node1);\n+        assertNotFocusWithin(node2);\n+        assertNotFocusWithin(node3);\n+        assertNotFocusWithin(node4);\n+    }\n+\n","filename":"modules\/javafx.graphics\/src\/test\/java\/test\/javafx\/scene\/FocusTest.java","additions":44,"deletions":2,"binary":false,"changes":46,"status":"modified"}]}