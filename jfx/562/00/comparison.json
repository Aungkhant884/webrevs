{"files":[{"patch":"@@ -1,1 +1,1 @@\n-## xmlsoft.org: libxml2 v2.9.10\n+## xmlsoft.org: libxml2 v2.9.12\n@@ -30,0 +30,19 @@\n+=== copyright notices for hash.c, list.c, and the trio files ===\n+hash.c:\n+ * Copyright (C) 2000,2012 Bjorn Reese and Daniel Veillard.\n+list.c:\n+ * Copyright (C) 2000 Gary Pennington and Daniel Veillard.\n+the trio files:\n+ * Copyright (C) 1998 Bjorn Reese and Daniel Stenberg.\n+=== license text for hash.c, list.c, and the trio files ===\n+ *\n+ * Permission to use, copy, modify, and distribute this software for any\n+ * purpose with or without fee is hereby granted, provided that the above\n+ * copyright notice and this permission notice appear in all copies.\n+ *\n+ * THIS SOFTWARE IS PROVIDED ``AS IS'' AND WITHOUT ANY EXPRESS OR IMPLIED\n+ * WARRANTIES, INCLUDING, WITHOUT LIMITATION, THE IMPLIED WARRANTIES OF\n+ * MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE. THE AUTHORS AND\n+ * CONTRIBUTORS ACCEPT NO RESPONSIBILITY IN ANY CONCEIVABLE MANNER.\n+ *\n+\n","filename":"modules\/javafx.web\/src\/main\/legal\/libxml2.md","additions":20,"deletions":1,"binary":false,"changes":21,"status":"modified"},{"patch":"@@ -1,6 +0,0 @@\n-1. Download interested libxml tarball from http:\/\/xmlsoft.org\r\n-2. Extract contents into src directory\r\n-3. Run configure step with below options\r\n-          cscript configure.js compiler=msvc catalog=no xml_debug=no docb=no ftp=no http=no iconv=no legacy=no mem_debug=no modules=no regexps=no run_debug=no schemas=no schematron=no valid=no xinclude=no xptr=no zlib=no\r\n-4. Copy config.h & xmlversion.h to win32 dir\r\n-4. Remove files & directories which are not relevant to JavaFX WebKit\r\n","filename":"modules\/javafx.web\/src\/main\/native\/Source\/ThirdParty\/libxml\/README.javafx","additions":0,"deletions":6,"binary":false,"changes":6,"status":"deleted"},{"patch":"@@ -0,0 +1,43 @@\n+Updating libxml in OpenJFX:\n+\n+1. Download respective libxml source tarball from here: http:\/\/xmlsoft.org\/sources\n+2. Extract contents into `modules\/javafx.web\/src\/main\/native\/Source\/ThirdParty\/libxml\/src` directory.\n+3. We do not have any local changes in the libxml source but libxml source needs to be configured before integrating into JavaFX. Below are platform wise steps to configure.\n+\n+- For windows\n+4. Configure libxml.\n+        > cd modules\/javafx.web\/src\/main\/native\/Source\/ThirdParty\/libxml\/src\/win32\n+        > cscript configure.js compiler=msvc catalog=no xml_debug=no docb=no ftp=no http=no iconv=no legacy=no mem_debug=no modules=no regexps=no run_debug=no schemas=no schematron=no valid=no xinclude=no xptr=no zlib=no\n+\n+        - Above command generates a header file `libxml\\src\\include\\libxml\\xmlversion.h` and may update the `src\/config.h` file. (on all platforms)\n+4.1 Copy `libxml\\src\\include\\libxml\\xmlversion.h` to `libxml\\win32\\include\\libxml\\xmlversion.h'. xmlversion.h file defines several macros to control libxml features. We do not require all of the features to be enabled. Compare the generated `libxml\\src\\include\\libxml\\xmlversion.h` with existing `libxml\\win32\\include\\libxml\\xmlversion.h' and retain macro definitions from the later.\n+\n+4.2 Copy `libxml\\src\\config.h` to `libxml\\win32\\config.h`\n+\n+5. Remove files & directories which are not relevant to JavaFX WebKit.\n+   Use git clean command. (git clean -df modules\/)\n+\n+- For Mac\n+6. Configure libxml.\n+        > cd modules\/javafx.web\/src\/main\/native\/Source\/ThirdParty\/libxml\/src\n+        > .\/configure\n+\n+6.1 Copy `libxml\\src\\include\\libxml\\xmlversion.h` to `libxml\\mac\\include\\libxml\\xmlversion.h` and follow same guidelines as Windows to retain changes from our repo.\n+6.2 Copy libxml\\src\\config.h to libxml\\mac\\config.h\n+\n+- For Linux\n+6. Configure libxml.\n+        > cd modules\/javafx.web\/src\/main\/native\/Source\/ThirdParty\/libxml\/src\n+        > .\/configure\n+\n+6.1 Copy `libxml\\src\\include\\libxml\\xmlversion.h` to `libxml\\linux\\include\\libxml\\xmlversion.h` and follow same guidelines as Windows to retain changes from our repo.\n+6.2 Copy libxml\\src\\config.h to libxml\\linux\\config.h\n+\n+7. Helper commands for removing leading tabs and trailing whitespaces.\n+7.1 > cd modules\/javafx.web\/src\/main\/native\/Source\/ThirdParty\/libxml\n+7.2 Remove tabs from source files:\n+    > sudo apt install moreutils\n+    > find src\/ -name \"*.c\" -type f -exec bash -c 'expand -t 4 \"$0\" | sponge \"$0\"' {} \\;\n+    > find src\/ -name \"*.h\" -type f -exec bash -c 'expand -t 4 \"$0\" | sponge \"$0\"' {} \\;\n+7.3 Remove trailing whitespaces:\n+    > find . -type f -exec sed -i '' 's\/[[:space:]]\\{1,\\}$\/\/' {} \\+\n","filename":"modules\/javafx.web\/src\/main\/native\/Source\/ThirdParty\/libxml\/UPDATING.txt","additions":43,"deletions":0,"binary":false,"changes":43,"status":"added"},{"patch":"@@ -4,0 +4,3 @@\n+\/* A form that will not confuse apibuild.py *\/\n+#define ATTRIBUTE_DESTRUCTOR __attribute__((destructor))\n+\n@@ -13,0 +16,3 @@\n+\/* Define if __attribute__((destructor)) is accepted *\/\n+#define HAVE_ATTRIBUTE_DESTRUCTOR 1\n+\n@@ -127,1 +133,1 @@\n-\n+\/* #undef HAVE_RAND_R 1 *\/\n@@ -233,2 +239,1 @@\n-\/* Define to the sub-directory in which libtool stores uninstalled libraries.\n-   *\/\n+\/* Define to the sub-directory where libtool stores uninstalled libraries. *\/\n@@ -271,1 +276,1 @@\n-#define VERSION \"2.9.10\"\n+#define VERSION \"2.9.12\"\n","filename":"modules\/javafx.web\/src\/main\/native\/Source\/ThirdParty\/libxml\/linux\/config.h","additions":9,"deletions":4,"binary":false,"changes":13,"status":"modified"},{"patch":"@@ -2,2 +2,2 @@\n- * Summary: compile-time version informations\n- * Description: compile-time version informations for the XML library\n+ * Summary: compile-time version information\n+ * Description: compile-time version information for the XML library\n@@ -32,1 +32,1 @@\n-#define LIBXML_DOTTED_VERSION \"2.9.10\"\n+#define LIBXML_DOTTED_VERSION \"2.9.12\"\n@@ -39,1 +39,1 @@\n-#define LIBXML_VERSION 20910\n+#define LIBXML_VERSION 20912\n@@ -46,1 +46,1 @@\n-#define LIBXML_VERSION_STRING \"20910\"\n+#define LIBXML_VERSION_STRING \"20912\"\n@@ -61,1 +61,1 @@\n-#define LIBXML_TEST_VERSION xmlCheckVersion(20910);\n+#define LIBXML_TEST_VERSION xmlCheckVersion(20912);\n","filename":"modules\/javafx.web\/src\/main\/native\/Source\/ThirdParty\/libxml\/linux\/include\/libxml\/xmlversion.h","additions":6,"deletions":6,"binary":false,"changes":12,"status":"modified"},{"patch":"@@ -4,0 +4,3 @@\n+\/* A form that will not confuse apibuild.py *\/\n+#define ATTRIBUTE_DESTRUCTOR __attribute__((destructor))\n+\n@@ -13,0 +16,3 @@\n+\/* Define if __attribute__((destructor)) is accepted *\/\n+#define HAVE_ATTRIBUTE_DESTRUCTOR 1\n+\n@@ -127,1 +133,1 @@\n-\n+\/* #undef HAVE_RAND_R 1 *\/\n@@ -270,1 +276,1 @@\n-#define VERSION \"2.9.10\"\n+#define VERSION \"2.9.12\"\n","filename":"modules\/javafx.web\/src\/main\/native\/Source\/ThirdParty\/libxml\/mac\/config.h","additions":8,"deletions":2,"binary":false,"changes":10,"status":"modified"},{"patch":"@@ -2,2 +2,2 @@\n- * Summary: compile-time version informations\n- * Description: compile-time version informations for the XML library\n+ * Summary: compile-time version information\n+ * Description: compile-time version information for the XML library\n@@ -32,1 +32,1 @@\n-#define LIBXML_DOTTED_VERSION \"2.9.10\"\n+#define LIBXML_DOTTED_VERSION \"2.9.12\"\n@@ -39,1 +39,1 @@\n-#define LIBXML_VERSION 20910\n+#define LIBXML_VERSION 20912\n@@ -46,1 +46,1 @@\n-#define LIBXML_VERSION_STRING \"20910\"\n+#define LIBXML_VERSION_STRING \"20912\"\n@@ -61,1 +61,1 @@\n-#define LIBXML_TEST_VERSION xmlCheckVersion(20910);\n+#define LIBXML_TEST_VERSION xmlCheckVersion(20912);\n","filename":"modules\/javafx.web\/src\/main\/native\/Source\/ThirdParty\/libxml\/mac\/include\/libxml\/xmlversion.h","additions":6,"deletions":6,"binary":false,"changes":12,"status":"modified"},{"patch":"@@ -382,1 +382,1 @@\n-\t  regession tests for this\n+\t  regression tests for this\n@@ -478,1 +478,1 @@\n-\t  explicitely.\n+\t  explicitly.\n@@ -666,1 +666,1 @@\n-\t* HTMLparser.c: apparently it's okay to forget the semicolumn after\n+\t* HTMLparser.c: apparently it's okay to forget the semicolon after\n@@ -790,1 +790,1 @@\n-\t* python\/types.c: fix a memory errro when using namespace nodes\n+\t* python\/types.c: fix a memory error when using namespace nodes\n@@ -920,1 +920,1 @@\n-\t* parser.c: fix a memeory leak in internal subset parsing with\n+\t* parser.c: fix a memory leak in internal subset parsing with\n@@ -1233,1 +1233,1 @@\n-\t* valid.c: also fix the place wher it was called.\n+\t* valid.c: also fix the place where it was called.\n@@ -1427,1 +1427,1 @@\n-\t  never commited to CVS\n+\t  never committed to CVS\n@@ -1534,1 +1534,1 @@\n-\t  result\/HTML\/wired.html.sax: this affects the SAX event strem for\n+\t  result\/HTML\/wired.html.sax: this affects the SAX event stream for\n@@ -1630,1 +1630,1 @@\n-\t* valid.c: fixed a weird error where validity context whould not\n+\t* valid.c: fixed a weird error where validity context would not\n@@ -1743,1 +1743,1 @@\n-\t  for consistant handling.\n+\t  for consistent handling.\n@@ -1860,1 +1860,1 @@\n-\t  (hardcoding the intial value to 1) revealed that the\n+\t  (hardcoding the initial value to 1) revealed that the\n@@ -1915,1 +1915,1 @@\n-\t  those nastly \"warnigns\" from the docs of the clone\/adopt\n+\t  those nasty \"warnings\" from the docs of the clone\/adopt\n@@ -2036,1 +2036,1 @@\n-\t  It sits on an xmlXPathContext and need to be explicitely\n+\t  It sits on an xmlXPathContext and need to be explicitly\n@@ -2055,1 +2055,1 @@\n-\t  nastly namespace nodes need to be added with\n+\t  nasty namespace nodes need to be added with\n@@ -2066,1 +2066,1 @@\n-\t     This would allow to skipp all the namespace node specific\n+\t     This would allow to skip all the namespace node specific\n@@ -2488,1 +2488,1 @@\n-\t* NEWS configure.in libxml.spec.in testapi.c doc\/*: upated the news\n+\t* NEWS configure.in libxml.spec.in testapi.c doc\/*: updated the news\n@@ -2523,1 +2523,1 @@\n-\t* test\/ns7 resul\/\/ns7*: added to the regression tests\n+\t* test\/ns7 result\/ns7*: added to the regression tests\n@@ -2864,1 +2864,1 @@\n-\t* xmlregexp.c: commiting a some fixes and debug done yesterday in\n+\t* xmlregexp.c: committing a some fixes and debug done yesterday in\n@@ -2935,1 +2935,1 @@\n-\t  IDC target-nodes were interferring with IDC node-tables,\n+\t  IDC target-nodes were interfering with IDC node-tables,\n@@ -3056,1 +3056,1 @@\n-\t  aquisition story. Centralised and restructured component fixup.\n+\t  acquisition story. Centralised and restructured component fixup.\n@@ -3388,1 +3388,1 @@\n-\t  version gives slightly more informations.\n+\t  version gives slightly more information.\n@@ -3401,1 +3401,1 @@\n-\t  ##other tests commited by Kasimier, also added a small speedup\n+\t  ##other tests committed by Kasimier, also added a small speedup\n@@ -3427,1 +3427,1 @@\n-\t  result\/schemas\/any5_1_0.err: this slightly chnages the output\n+\t  result\/schemas\/any5_1_0.err: this slightly changes the output\n@@ -3471,1 +3471,1 @@\n-\t* test\/relaxng\/docbook_0.xml: get rid of the dependancy on a locally\n+\t* test\/relaxng\/docbook_0.xml: get rid of the dependency on a locally\n@@ -3525,1 +3525,1 @@\n-\t* schematron.c xmllint.c include\/libxml\/schematron.h: commiting\n+\t* schematron.c xmllint.c include\/libxml\/schematron.h: committing\n@@ -4032,1 +4032,1 @@\n-\t* include\/libxml\/valid.h valid.c: avoid name glob in agruments as\n+\t* include\/libxml\/valid.h valid.c: avoid name glob in arguments as\n@@ -4466,1 +4466,1 @@\n-\t  to add extra informations to doc\/libxml2-api.xml to separate\n+\t  to add extra information to doc\/libxml2-api.xml to separate\n@@ -4958,1 +4958,1 @@\n-\t* xmlschemas.c: Corrected an ambigious symbol-space for\n+\t* xmlschemas.c: Corrected an ambiguous symbol-space for\n@@ -4960,1 +4960,1 @@\n-\t  surpress compiler warnings.\n+\t  suppress compiler warnings.\n@@ -4981,1 +4981,1 @@\n-\t  Added machanism to store element information for the\n+\t  Added mechanism to store element information for the\n@@ -5031,1 +5031,1 @@\n-\t* parser.c: boosting common commnent parsing code, it was really\n+\t* parser.c: boosting common comment parsing code, it was really\n@@ -5182,1 +5182,1 @@\n-\t* xmlregexp.c: trying to add an API to get useful error informations\n+\t* xmlregexp.c: trying to add an API to get useful error information\n@@ -5283,1 +5283,1 @@\n-\t* python\/generator.py: added most required entires to\n+\t* python\/generator.py: added most required entries to\n@@ -5363,1 +5363,1 @@\n-\t  Changed the import and include machanism to share dictionaries.\n+\t  Changed the import and include mechanism to share dictionaries.\n@@ -5643,1 +5643,1 @@\n-\t* test\/slashdot16.xml: apparently missing from CVS, commited it\n+\t* test\/slashdot16.xml: apparently missing from CVS, committed it\n@@ -5870,1 +5870,1 @@\n-\t* xstc\/xstc.py:  Workaround to accomodate case insensitive\n+\t* xstc\/xstc.py:  Workaround to accommodate case insensitive\n@@ -5964,1 +5964,1 @@\n-\t  Simpified attribute wildcard creation and assignment to get rid \n+\t  Simplified attribute wildcard creation and assignment to get rid \n@@ -5981,1 +5981,1 @@\n-\t* xstc\/xstc.py: Workaround to accomodate case insensitive\n+\t* xstc\/xstc.py: Workaround to accommodate case insensitive\n@@ -6324,1 +6324,1 @@\n-\t* xmlsave.c: fixed bug whith missing NOTATION(s) serialization\n+\t* xmlsave.c: fixed bug with missing NOTATION(s) serialization\n@@ -6694,1 +6694,1 @@\n-\t  problem when substituing entities using the Reader, the entities\n+\t  problem when substituting entities using the Reader, the entities\n@@ -6850,1 +6850,1 @@\n-\t  ChangeLog page generation. The awk shoudl escape characters\n+\t  ChangeLog page generation. The awk should escape characters\n@@ -7052,1 +7052,1 @@\n-\t* xpath.c: relaxed id() to not check taht the name(s) passed\n+\t* xpath.c: relaxed id() to not check that the name(s) passed\n@@ -7065,1 +7065,1 @@\n-\t  include\/libxml\/xmlerror.h: fixed a recusive extention schemas\n+\t  include\/libxml\/xmlerror.h: fixed a recursive extension schemas\n@@ -7231,1 +7231,1 @@\n-\t* Makefile.am: use valgring fro the new Python based regression tests\n+\t* Makefile.am: use valgring for the new Python based regression tests\n@@ -7295,1 +7295,1 @@\n-\t* doc\/search.php: Minor change for later verson of php requiring\n+\t* doc\/search.php: Minor change for later version of php requiring\n@@ -7364,2 +7364,2 @@\n-\t* Makefile.am tree.c xmlsave.c include\/libxml\/xmlsave.h: commiting\n-\t  the new xmlsave module before the actuall big code change.\n+\t* Makefile.am tree.c xmlsave.c include\/libxml\/xmlsave.h: committing\n+\t  the new xmlsave module before the actual big code change.\n@@ -7875,1 +7875,1 @@\n-\t* rngparser.c: commiting the compact relax ng parser. It's not\n+\t* rngparser.c: committing the compact relax ng parser. It's not\n@@ -8029,1 +8029,1 @@\n-\t  dtd of element with mutiple namespace declarations\n+\t  dtd of element with multiple namespace declarations\n@@ -8410,1 +8410,1 @@\n-\t  <libxml\/hash.h> wasn't preceeded by <xml\/parser.h>\n+\t  <libxml\/hash.h> wasn't preceded by <xml\/parser.h>\n@@ -8433,1 +8433,1 @@\n-\t  header to add more informations, painful...\n+\t  header to add more information, painful...\n@@ -8575,1 +8575,1 @@\n-\t  informations extracted, improved the format and indexing.\n+\t  information extracted, improved the format and indexing.\n@@ -8777,1 +8777,1 @@\n-\t  to grab those informations.\n+\t  to grab those information.\n@@ -8887,1 +8887,1 @@\n-\t  makeing reader \"walker\" operating on preparsed document trees.\n+\t  making reader \"walker\" operating on preparsed document trees.\n@@ -9087,1 +9087,1 @@\n-\t  for PSVI type informations.\n+\t  for PSVI type information.\n@@ -9254,1 +9254,1 @@\n-\t  new error handling code, last error informations are stored\n+\t  new error handling code, last error information are stored\n@@ -9264,1 +9264,1 @@\n-\t  result\/valid\/*.err: some error messages were sligthly changed.\n+\t  result\/valid\/*.err: some error messages were slightly changed.\n@@ -9372,1 +9372,1 @@\n-\t  the attribute and element pool borken 2 commits ago.\n+\t  the attribute and element pool broken 2 commits ago.\n@@ -9439,1 +9439,1 @@\n-\t* xmlreader.c: cleanup of uneeded code\n+\t* xmlreader.c: cleanup of unneeded code\n@@ -9737,1 +9737,1 @@\n-\t  will change but commiting before changing for historical\n+\t  will change but committing before changing for historical\n@@ -10094,1 +10094,1 @@\n-\t  further small changes to elminate most of the remaining\n+\t  further small changes to eliminate most of the remaining\n@@ -10133,1 +10133,1 @@\n-\t  Bjorn Reese fix to reader for unsignificant white space\n+\t  Bjorn Reese fix to reader for insignificant white space\n@@ -10154,1 +10154,1 @@\n-\t* DOCBparser.c: removed 2 unsed vars\n+\t* DOCBparser.c: removed 2 unused vars\n@@ -10321,1 +10321,1 @@\n-\t* globals.c threads.c: fixes some problem when freeing unititialized\n+\t* globals.c threads.c: fixes some problem when freeing uninitialized\n@@ -10376,1 +10376,1 @@\n-\ttestThreads.  After fix, ran mutiple tests on various speed\n+\ttestThreads.  After fix, ran multiple tests on various speed\n@@ -10454,1 +10454,1 @@\n-\t* relaxng.c xmlschemas.c include\/libxml\/schemasInternals.h: commiting\n+\t* relaxng.c xmlschemas.c include\/libxml\/schemasInternals.h: committing\n@@ -11401,1 +11401,1 @@\n-\t* relaxng.c: guess what ! Relax-NG bugfixing, what a surprize...\n+\t* relaxng.c: guess what ! Relax-NG bugfixing, what a surprise...\n@@ -11932,1 +11932,1 @@\n-\t  brokeness\n+\t  brokenness\n@@ -11935,1 +11935,1 @@\n-\t* doc\/*: updated and rebuilt the doc for the release, includuding\n+\t* doc\/*: updated and rebuilt the doc for the release, including\n@@ -12095,1 +12095,1 @@\n-\t  extended the XmlTextReader API a bit, addding accessors for\n+\t  extended the XmlTextReader API a bit, adding accessors for\n@@ -12482,1 +12482,1 @@\n-\t* parser.c xpath.c: fixing #96925 wich was also dependent on the\n+\t* parser.c xpath.c: fixing #96925 which was also dependent on the\n@@ -12718,1 +12718,1 @@\n-\t* README: updated the contact informations\n+\t* README: updated the contact information\n@@ -13012,1 +13012,1 @@\n-\t* valid.c: try to provide file and line informations, not all\n+\t* valid.c: try to provide file and line information, not all\n@@ -13063,1 +13063,1 @@\n-\t* xmlIO.c: handle Windows sepecific file:\/\/localhost\/ semantic ...\n+\t* xmlIO.c: handle Windows specific file:\/\/localhost\/ semantic ...\n@@ -13397,1 +13397,1 @@\n-\t* tree.c: made xmlDocDump a wrapper arround xmlDocFormatDump\n+\t* tree.c: made xmlDocDump a wrapper around xmlDocFormatDump\n@@ -13502,1 +13502,1 @@\n-\t* xpath.c: fixing an XPath function evalutation bug pointed out\n+\t* xpath.c: fixing an XPath function evaluation bug pointed out\n@@ -13508,1 +13508,1 @@\n-\t* xpath.c include\/libxml\/xpathInternals.h: maked xmlXPathNodeSetAddNs() \n+\t* xpath.c include\/libxml\/xpathInternals.h: made xmlXPathNodeSetAddNs() \n@@ -13545,1 +13545,1 @@\n-\tand maked protocols comparisson case insensitive\n+\tand made protocols comparison case insensitive\n@@ -14002,1 +14002,1 @@\n-\t  uninitailized variable in xmlValidGetValidElements()\n+\t  uninitialized variable in xmlValidGetValidElements()\n@@ -14142,1 +14142,1 @@\n-\t* python\/*: commiting some Python bindings work done while travelling\n+\t* python\/*: committing some Python bindings work done while travelling\n@@ -14147,1 +14147,1 @@\n-\t  explicitely with memory debugging switched on\n+\t  explicitly with memory debugging switched on\n@@ -14499,1 +14499,1 @@\n-\t  python\/generator.py python\/libxml2class.txt: added more informations\n+\t  python\/generator.py python\/libxml2class.txt: added more information\n@@ -14546,1 +14546,1 @@\n-\t  python\/libxml_wrap.h: commited early version of a python binding\n+\t  python\/libxml_wrap.h: committed early version of a python binding\n@@ -15444,1 +15444,1 @@\n-\t  commited without review or aproval by Jens Finke <jens@gnome.org>\n+\t  committed without review or approval by Jens Finke <jens@gnome.org>\n@@ -15589,1 +15589,1 @@\n-\t  a few bug and optmization needs.\n+\t  a few bug and optimization needs.\n@@ -15877,1 +15877,1 @@\n-\t  optionnal to avoid breaking old apps added interface to switch\n+\t  optional to avoid breaking old apps added interface to switch\n@@ -16546,1 +16546,1 @@\n-\t* doc\/xml.html: update with 2.3.9 informations\n+\t* doc\/xml.html: update with 2.3.9 information\n@@ -16741,1 +16741,1 @@\n-\t  aways bind to the same code, cache this\n+\t  always bind to the same code, cache this\n@@ -16980,1 +16980,1 @@\n-\t  bug where the linktime verions of free() won't work ...\n+\t  bug where the linktime versions of free() won't work ...\n@@ -17379,1 +17379,1 @@\n-\t  hash functionnalities.\n+\t  hash functionalities.\n@@ -17517,1 +17517,1 @@\n-\t* xmlIO.c (xmlFileOpen, xmlFileOpenW): Removed unnecesary checks.\n+\t* xmlIO.c (xmlFileOpen, xmlFileOpenW): Removed unnecessary checks.\n@@ -17554,1 +17554,1 @@\n-\t* tree.c: make sure taht the parent and doc pointers are properly\n+\t* tree.c: make sure that the parent and doc pointers are properly\n@@ -17616,1 +17616,1 @@\n-\t* Makefile.am: applied patch fro make check from Martin Vidner\n+\t* Makefile.am: applied patch for make check from Martin Vidner\n@@ -17670,1 +17670,1 @@\n-\t  with namespace use when encountering QNames in XPath evalation,\n+\t  with namespace use when encountering QNames in XPath evaluation,\n@@ -17895,1 +17895,1 @@\n-\t* HTMLtree.c: forced body and html to be explicitely closed.\n+\t* HTMLtree.c: forced body and html to be explicitly closed.\n@@ -18040,1 +18040,1 @@\n-\t* debugXML.c testXPath.c xpath.[ch]: got pissed by some nastyness\n+\t* debugXML.c testXPath.c xpath.[ch]: got pissed by some nastiness\n@@ -18597,1 +18597,1 @@\n-\t* *.[ch] autoconf.sh : moved to an absolute addressing of includes :\n+\t* *.[ch] autoconf.sh : moved to an absolute addressing of includes : \n@@ -18898,1 +18898,1 @@\n-\t* HTMLtree.c: fixed a problem when outputing XML parsed docs as HTML\n+\t* HTMLtree.c: fixed a problem when outputting XML parsed docs as HTML\n@@ -18925,1 +18925,1 @@\n-\t  namespace recognition, and Dia as a resul :-(\n+\t  namespace recognition, and Dia as a result :-(\n@@ -18955,1 +18955,1 @@\n-\t  modified again, but PERef are still not handled correcly but\n+\t  modified again, but PERef are still not handled correctly but\n@@ -19045,2 +19045,2 @@\n-\t\t    main element, and other nastyness\n-\t* HTMLtree.c tree.c: accomodate the extended HTML supported\t    \n+\t\t    main element, and other nastiness\n+\t* HTMLtree.c tree.c: accommodate the extended HTML supported\t    \n@@ -19453,1 +19453,1 @@\n-\t* README: added informations about mailing-list and on-line\n+\t* README: added information about mailing-list and on-line\n@@ -19538,1 +19538,1 @@\n-\t* tree.[ch]: more cleanup on the API, made the tree mor conformant.\n+\t* tree.[ch]: more cleanup on the API, made the tree more conformant.\n@@ -19597,1 +19597,1 @@\n-\t  and changed NODEs contants for conformity with DOM Level 1\n+\t  and changed NODEs constants for conformity with DOM Level 1\n@@ -19634,1 +19634,1 @@\n-\t* error.h: New file.  Contains prototyes from `error.c'.\n+\t* error.h: New file.  Contains prototypes from `error.c'.\n@@ -19665,1 +19665,1 @@\n-\t* AUTHORS, Changelog: the original ones didn't get commited but the\n+\t* AUTHORS, Changelog: the original ones didn't get committed but the\n@@ -19671,1 +19671,1 @@\n-\t* integrated code developped at W3C\n+\t* integrated code developed at W3C\n","filename":"modules\/javafx.web\/src\/main\/native\/Source\/ThirdParty\/libxml\/src\/ChangeLog","additions":108,"deletions":108,"binary":false,"changes":216,"status":"modified"},{"patch":"@@ -72,1 +72,1 @@\n- * @extra:  extra informations\n+ * @extra:  extra information\n@@ -299,1 +299,1 @@\n-#define SKIP(val) ctxt->nbChars += (val),ctxt->input->cur += (val),ctxt->input->col+=(val)\n+#define SKIP(val) ctxt->input->cur += (val),ctxt->input->col+=(val)\n@@ -333,1 +333,1 @@\n-    ctxt->token = 0; ctxt->input->cur += l; ctxt->nbChars++;        \\\n+    ctxt->token = 0; ctxt->input->cur += l;             \\\n@@ -417,0 +417,4 @@\n+    const unsigned char *cur;\n+    unsigned char c;\n+    unsigned int val;\n+\n@@ -424,1 +428,46 @@\n-    if (ctxt->charset == XML_CHAR_ENCODING_UTF8) {\n+    if (ctxt->charset != XML_CHAR_ENCODING_UTF8) {\n+        xmlChar * guess;\n+        xmlCharEncodingHandlerPtr handler;\n+\n+        \/*\n+         * Assume it's a fixed length encoding (1) with\n+         * a compatible encoding for the ASCII set, since\n+         * HTML constructs only use < 128 chars\n+         *\/\n+        if ((int) *ctxt->input->cur < 0x80) {\n+            *len = 1;\n+            if ((*ctxt->input->cur == 0) &&\n+                (ctxt->input->cur < ctxt->input->end)) {\n+                htmlParseErrInt(ctxt, XML_ERR_INVALID_CHAR,\n+                                \"Char 0x%X out of allowed range\\n\", 0);\n+                return(' ');\n+            }\n+            return((int) *ctxt->input->cur);\n+        }\n+\n+        \/*\n+         * Humm this is bad, do an automatic flow conversion\n+         *\/\n+        guess = htmlFindEncoding(ctxt);\n+        if (guess == NULL) {\n+            xmlSwitchEncoding(ctxt, XML_CHAR_ENCODING_8859_1);\n+        } else {\n+            if (ctxt->input->encoding != NULL)\n+                xmlFree((xmlChar *) ctxt->input->encoding);\n+            ctxt->input->encoding = guess;\n+            handler = xmlFindCharEncodingHandler((const char *) guess);\n+            if (handler != NULL) {\n+                \/*\n+                 * Don't use UTF-8 encoder which isn't required and\n+                 * can produce invalid UTF-8.\n+                 *\/\n+                if (!xmlStrEqual(BAD_CAST handler->name, BAD_CAST \"UTF-8\"))\n+                    xmlSwitchToEncoding(ctxt, handler);\n+            } else {\n+                htmlParseErr(ctxt, XML_ERR_INVALID_ENCODING,\n+                             \"Unsupported encoding %s\", guess, NULL);\n+            }\n+        }\n+        ctxt->charset = XML_CHAR_ENCODING_UTF8;\n+    }\n+\n@@ -436,4 +485,1 @@\n-    const unsigned char *cur = ctxt->input->cur;\n-    unsigned char c;\n-    unsigned int val;\n-\n+    cur = ctxt->input->cur;\n@@ -442,0 +488,2 @@\n+        if ((c & 0x40) == 0)\n+            goto encoding_error;\n@@ -443,3 +491,3 @@\n-        xmlParserInputGrow(ctxt->input, INPUT_CHUNK);\n-                cur = ctxt->input->cur;\n-            }\n+            xmlParserInputGrow(ctxt->input, INPUT_CHUNK);\n+            cur = ctxt->input->cur;\n+        }\n@@ -447,1 +495,1 @@\n-        goto encoding_error;\n+            goto encoding_error;\n@@ -450,2 +498,9 @@\n-        if (cur[2] == 0) {\n-            xmlParserInputGrow(ctxt->input, INPUT_CHUNK);\n+            if (cur[2] == 0) {\n+                xmlParserInputGrow(ctxt->input, INPUT_CHUNK);\n+                cur = ctxt->input->cur;\n+            }\n+            if ((cur[2] & 0xc0) != 0x80)\n+                goto encoding_error;\n+            if ((c & 0xf0) == 0xf0) {\n+                if (cur[3] == 0) {\n+                    xmlParserInputGrow(ctxt->input, INPUT_CHUNK);\n@@ -454,23 +509,20 @@\n-        if ((cur[2] & 0xc0) != 0x80)\n-            goto encoding_error;\n-        if ((c & 0xf0) == 0xf0) {\n-            if (cur[3] == 0) {\n-            xmlParserInputGrow(ctxt->input, INPUT_CHUNK);\n-                        cur = ctxt->input->cur;\n-                    }\n-            if (((c & 0xf8) != 0xf0) ||\n-            ((cur[3] & 0xc0) != 0x80))\n-            goto encoding_error;\n-            \/* 4-byte code *\/\n-            *len = 4;\n-            val = (cur[0] & 0x7) << 18;\n-            val |= (cur[1] & 0x3f) << 12;\n-            val |= (cur[2] & 0x3f) << 6;\n-            val |= cur[3] & 0x3f;\n-        } else {\n-          \/* 3-byte code *\/\n-            *len = 3;\n-            val = (cur[0] & 0xf) << 12;\n-            val |= (cur[1] & 0x3f) << 6;\n-            val |= cur[2] & 0x3f;\n-        }\n+                if (((c & 0xf8) != 0xf0) ||\n+                    ((cur[3] & 0xc0) != 0x80))\n+                    goto encoding_error;\n+                \/* 4-byte code *\/\n+                *len = 4;\n+                val = (cur[0] & 0x7) << 18;\n+                val |= (cur[1] & 0x3f) << 12;\n+                val |= (cur[2] & 0x3f) << 6;\n+                val |= cur[3] & 0x3f;\n+                if (val < 0x10000)\n+                    goto encoding_error;\n+            } else {\n+              \/* 3-byte code *\/\n+                *len = 3;\n+                val = (cur[0] & 0xf) << 12;\n+                val |= (cur[1] & 0x3f) << 6;\n+                val |= cur[2] & 0x3f;\n+                if (val < 0x800)\n+                    goto encoding_error;\n+            }\n@@ -479,3 +531,5 @@\n-        *len = 2;\n-        val = (cur[0] & 0x1f) << 6;\n-        val |= cur[1] & 0x3f;\n+            *len = 2;\n+            val = (cur[0] & 0x1f) << 6;\n+            val |= cur[1] & 0x3f;\n+            if (val < 0x80)\n+                goto encoding_error;\n@@ -485,1 +539,1 @@\n-                \"Char 0x%X out of allowed range\\n\", val);\n+                            \"Char 0x%X out of allowed range\\n\", val);\n@@ -489,7 +543,7 @@\n-            if ((*ctxt->input->cur == 0) &&\n-                (ctxt->input->cur < ctxt->input->end)) {\n-                    htmlParseErrInt(ctxt, XML_ERR_INVALID_CHAR,\n-                \"Char 0x%X out of allowed range\\n\", 0);\n-                *len = 1;\n-                return(' ');\n-            }\n+        if ((*ctxt->input->cur == 0) &&\n+            (ctxt->input->cur < ctxt->input->end)) {\n+            htmlParseErrInt(ctxt, XML_ERR_INVALID_CHAR,\n+                            \"Char 0x%X out of allowed range\\n\", 0);\n+            *len = 1;\n+            return(' ');\n+        }\n@@ -500,36 +554,0 @@\n-    }\n-    \/*\n-     * Assume it's a fixed length encoding (1) with\n-     * a compatible encoding for the ASCII set, since\n-     * XML constructs only use < 128 chars\n-     *\/\n-    *len = 1;\n-    if ((int) *ctxt->input->cur < 0x80)\n-    return((int) *ctxt->input->cur);\n-\n-    \/*\n-     * Humm this is bad, do an automatic flow conversion\n-     *\/\n-    {\n-        xmlChar * guess;\n-        xmlCharEncodingHandlerPtr handler;\n-\n-        guess = htmlFindEncoding(ctxt);\n-        if (guess == NULL) {\n-            xmlSwitchEncoding(ctxt, XML_CHAR_ENCODING_8859_1);\n-        } else {\n-            if (ctxt->input->encoding != NULL)\n-                xmlFree((xmlChar *) ctxt->input->encoding);\n-            ctxt->input->encoding = guess;\n-            handler = xmlFindCharEncodingHandler((const char *) guess);\n-            if (handler != NULL) {\n-                xmlSwitchToEncoding(ctxt, handler);\n-            } else {\n-                htmlParseErr(ctxt, XML_ERR_INVALID_ENCODING,\n-                             \"Unsupported encoding %s\", guess, NULL);\n-            }\n-        }\n-        ctxt->charset = XML_CHAR_ENCODING_UTF8;\n-    }\n-\n-    return(xmlCurrentChar(ctxt, len));\n@@ -560,1 +578,10 @@\n-    ctxt->charset = XML_CHAR_ENCODING_8859_1;\n+    \/*\n+     * Don't switch encodings twice. Note that if there's an encoder, we\n+     * shouldn't receive invalid UTF-8 anyway.\n+     *\n+     * Note that if ctxt->input->buf == NULL, switching encodings is\n+     * impossible, see Gitlab issue #34.\n+     *\/\n+    if ((ctxt->input->buf != NULL) &&\n+        (ctxt->input->buf->encoder == NULL))\n+        xmlSwitchEncoding(ctxt, XML_CHAR_ENCODING_8859_1);\n@@ -587,1 +614,0 @@\n-        ctxt->nbChars++;\n@@ -1049,0 +1075,5 @@\n+typedef struct {\n+    const char *oldTag;\n+    const char *newTag;\n+} htmlStartCloseEntry;\n+\n@@ -1052,93 +1083,252 @@\n-static const char * const htmlStartClose[] = {\n-\"form\",     \"form\", \"p\", \"hr\", \"h1\", \"h2\", \"h3\", \"h4\", \"h5\", \"h6\",\n-        \"dl\", \"ul\", \"ol\", \"menu\", \"dir\", \"address\", \"pre\",\n-        \"listing\", \"xmp\", \"head\", NULL,\n-\"head\",     \"p\", NULL,\n-\"title\",    \"p\", NULL,\n-\"body\",     \"head\", \"style\", \"link\", \"title\", \"p\", NULL,\n-\"frameset\", \"head\", \"style\", \"link\", \"title\", \"p\", NULL,\n-\"li\",       \"p\", \"h1\", \"h2\", \"h3\", \"h4\", \"h5\", \"h6\", \"dl\", \"address\",\n-        \"pre\", \"listing\", \"xmp\", \"head\", \"li\", NULL,\n-\"hr\",       \"p\", \"head\", NULL,\n-\"h1\",       \"p\", \"head\", NULL,\n-\"h2\",       \"p\", \"head\", NULL,\n-\"h3\",       \"p\", \"head\", NULL,\n-\"h4\",       \"p\", \"head\", NULL,\n-\"h5\",       \"p\", \"head\", NULL,\n-\"h6\",       \"p\", \"head\", NULL,\n-\"dir\",      \"p\", \"head\", NULL,\n-\"address\",  \"p\", \"head\", \"ul\", NULL,\n-\"pre\",      \"p\", \"head\", \"ul\", NULL,\n-\"listing\",  \"p\", \"head\", NULL,\n-\"xmp\",      \"p\", \"head\", NULL,\n-\"blockquote\",   \"p\", \"head\", NULL,\n-\"dl\",       \"p\", \"dt\", \"menu\", \"dir\", \"address\", \"pre\", \"listing\",\n-        \"xmp\", \"head\", NULL,\n-\"dt\",       \"p\", \"menu\", \"dir\", \"address\", \"pre\", \"listing\", \"xmp\",\n-                \"head\", \"dd\", NULL,\n-\"dd\",       \"p\", \"menu\", \"dir\", \"address\", \"pre\", \"listing\", \"xmp\",\n-                \"head\", \"dt\", NULL,\n-\"ul\",       \"p\", \"head\", \"ol\", \"menu\", \"dir\", \"address\", \"pre\",\n-        \"listing\", \"xmp\", NULL,\n-\"ol\",       \"p\", \"head\", \"ul\", NULL,\n-\"menu\",     \"p\", \"head\", \"ul\", NULL,\n-\"p\",        \"p\", \"head\", \"h1\", \"h2\", \"h3\", \"h4\", \"h5\", \"h6\", FONTSTYLE, NULL,\n-\"div\",      \"p\", \"head\", NULL,\n-\"noscript\", \"script\", NULL,\n-\"center\",   \"font\", \"b\", \"i\", \"p\", \"head\", NULL,\n-\"a\",        \"a\", \"head\", NULL,\n-\"caption\",  \"p\", NULL,\n-\"colgroup\", \"caption\", \"colgroup\", \"col\", \"p\", NULL,\n-\"col\",      \"caption\", \"col\", \"p\", NULL,\n-\"table\",    \"p\", \"head\", \"h1\", \"h2\", \"h3\", \"h4\", \"h5\", \"h6\", \"pre\",\n-        \"listing\", \"xmp\", \"a\", NULL,\n-\"th\",       \"th\", \"td\", \"p\", \"span\", \"font\", \"a\", \"b\", \"i\", \"u\", NULL,\n-\"td\",       \"th\", \"td\", \"p\", \"span\", \"font\", \"a\", \"b\", \"i\", \"u\", NULL,\n-\"tr\",       \"th\", \"td\", \"tr\", \"caption\", \"col\", \"colgroup\", \"p\", NULL,\n-\"thead\",    \"caption\", \"col\", \"colgroup\", NULL,\n-\"tfoot\",    \"th\", \"td\", \"tr\", \"caption\", \"col\", \"colgroup\", \"thead\",\n-        \"tbody\", \"p\", NULL,\n-\"tbody\",    \"th\", \"td\", \"tr\", \"caption\", \"col\", \"colgroup\", \"thead\",\n-        \"tfoot\", \"tbody\", \"p\", NULL,\n-\"optgroup\", \"option\", NULL,\n-\"option\",   \"option\", NULL,\n-\"fieldset\", \"legend\", \"p\", \"head\", \"h1\", \"h2\", \"h3\", \"h4\", \"h5\", \"h6\",\n-        \"pre\", \"listing\", \"xmp\", \"a\", NULL,\n-\/* most tags in in FONTSTYLE, PHRASE and SPECIAL should close <head> *\/\n-\"tt\",       \"head\", NULL,\n-\"i\",        \"head\", NULL,\n-\"b\",        \"head\", NULL,\n-\"u\",        \"head\", NULL,\n-\"s\",        \"head\", NULL,\n-\"strike\",   \"head\", NULL,\n-\"big\",      \"head\", NULL,\n-\"small\",    \"head\", NULL,\n-\n-\"em\",       \"head\", NULL,\n-\"strong\",   \"head\", NULL,\n-\"dfn\",      \"head\", NULL,\n-\"code\",     \"head\", NULL,\n-\"samp\",     \"head\", NULL,\n-\"kbd\",      \"head\", NULL,\n-\"var\",      \"head\", NULL,\n-\"cite\",     \"head\", NULL,\n-\"abbr\",     \"head\", NULL,\n-\"acronym\",  \"head\", NULL,\n-\n-\/* \"a\" *\/\n-\"img\",      \"head\", NULL,\n-\/* \"applet\" *\/\n-\/* \"embed\" *\/\n-\/* \"object\" *\/\n-\"font\",     \"head\", NULL,\n-\/* \"basefont\" *\/\n-\"br\",       \"head\", NULL,\n-\/* \"script\" *\/\n-\"map\",      \"head\", NULL,\n-\"q\",        \"head\", NULL,\n-\"sub\",      \"head\", NULL,\n-\"sup\",      \"head\", NULL,\n-\"span\",     \"head\", NULL,\n-\"bdo\",      \"head\", NULL,\n-\"iframe\",   \"head\", NULL,\n-NULL\n+static const htmlStartCloseEntry htmlStartClose[] = {\n+    { \"a\", \"a\" },\n+    { \"a\", \"fieldset\" },\n+    { \"a\", \"table\" },\n+    { \"a\", \"td\" },\n+    { \"a\", \"th\" },\n+    { \"address\", \"dd\" },\n+    { \"address\", \"dl\" },\n+    { \"address\", \"dt\" },\n+    { \"address\", \"form\" },\n+    { \"address\", \"li\" },\n+    { \"address\", \"ul\" },\n+    { \"b\", \"center\" },\n+    { \"b\", \"p\" },\n+    { \"b\", \"td\" },\n+    { \"b\", \"th\" },\n+    { \"big\", \"p\" },\n+    { \"caption\", \"col\" },\n+    { \"caption\", \"colgroup\" },\n+    { \"caption\", \"tbody\" },\n+    { \"caption\", \"tfoot\" },\n+    { \"caption\", \"thead\" },\n+    { \"caption\", \"tr\" },\n+    { \"col\", \"col\" },\n+    { \"col\", \"colgroup\" },\n+    { \"col\", \"tbody\" },\n+    { \"col\", \"tfoot\" },\n+    { \"col\", \"thead\" },\n+    { \"col\", \"tr\" },\n+    { \"colgroup\", \"colgroup\" },\n+    { \"colgroup\", \"tbody\" },\n+    { \"colgroup\", \"tfoot\" },\n+    { \"colgroup\", \"thead\" },\n+    { \"colgroup\", \"tr\" },\n+    { \"dd\", \"dt\" },\n+    { \"dir\", \"dd\" },\n+    { \"dir\", \"dl\" },\n+    { \"dir\", \"dt\" },\n+    { \"dir\", \"form\" },\n+    { \"dir\", \"ul\" },\n+    { \"dl\", \"form\" },\n+    { \"dl\", \"li\" },\n+    { \"dt\", \"dd\" },\n+    { \"dt\", \"dl\" },\n+    { \"font\", \"center\" },\n+    { \"font\", \"td\" },\n+    { \"font\", \"th\" },\n+    { \"form\", \"form\" },\n+    { \"h1\", \"fieldset\" },\n+    { \"h1\", \"form\" },\n+    { \"h1\", \"li\" },\n+    { \"h1\", \"p\" },\n+    { \"h1\", \"table\" },\n+    { \"h2\", \"fieldset\" },\n+    { \"h2\", \"form\" },\n+    { \"h2\", \"li\" },\n+    { \"h2\", \"p\" },\n+    { \"h2\", \"table\" },\n+    { \"h3\", \"fieldset\" },\n+    { \"h3\", \"form\" },\n+    { \"h3\", \"li\" },\n+    { \"h3\", \"p\" },\n+    { \"h3\", \"table\" },\n+    { \"h4\", \"fieldset\" },\n+    { \"h4\", \"form\" },\n+    { \"h4\", \"li\" },\n+    { \"h4\", \"p\" },\n+    { \"h4\", \"table\" },\n+    { \"h5\", \"fieldset\" },\n+    { \"h5\", \"form\" },\n+    { \"h5\", \"li\" },\n+    { \"h5\", \"p\" },\n+    { \"h5\", \"table\" },\n+    { \"h6\", \"fieldset\" },\n+    { \"h6\", \"form\" },\n+    { \"h6\", \"li\" },\n+    { \"h6\", \"p\" },\n+    { \"h6\", \"table\" },\n+    { \"head\", \"a\" },\n+    { \"head\", \"abbr\" },\n+    { \"head\", \"acronym\" },\n+    { \"head\", \"address\" },\n+    { \"head\", \"b\" },\n+    { \"head\", \"bdo\" },\n+    { \"head\", \"big\" },\n+    { \"head\", \"blockquote\" },\n+    { \"head\", \"body\" },\n+    { \"head\", \"br\" },\n+    { \"head\", \"center\" },\n+    { \"head\", \"cite\" },\n+    { \"head\", \"code\" },\n+    { \"head\", \"dd\" },\n+    { \"head\", \"dfn\" },\n+    { \"head\", \"dir\" },\n+    { \"head\", \"div\" },\n+    { \"head\", \"dl\" },\n+    { \"head\", \"dt\" },\n+    { \"head\", \"em\" },\n+    { \"head\", \"fieldset\" },\n+    { \"head\", \"font\" },\n+    { \"head\", \"form\" },\n+    { \"head\", \"frameset\" },\n+    { \"head\", \"h1\" },\n+    { \"head\", \"h2\" },\n+    { \"head\", \"h3\" },\n+    { \"head\", \"h4\" },\n+    { \"head\", \"h5\" },\n+    { \"head\", \"h6\" },\n+    { \"head\", \"hr\" },\n+    { \"head\", \"i\" },\n+    { \"head\", \"iframe\" },\n+    { \"head\", \"img\" },\n+    { \"head\", \"kbd\" },\n+    { \"head\", \"li\" },\n+    { \"head\", \"listing\" },\n+    { \"head\", \"map\" },\n+    { \"head\", \"menu\" },\n+    { \"head\", \"ol\" },\n+    { \"head\", \"p\" },\n+    { \"head\", \"pre\" },\n+    { \"head\", \"q\" },\n+    { \"head\", \"s\" },\n+    { \"head\", \"samp\" },\n+    { \"head\", \"small\" },\n+    { \"head\", \"span\" },\n+    { \"head\", \"strike\" },\n+    { \"head\", \"strong\" },\n+    { \"head\", \"sub\" },\n+    { \"head\", \"sup\" },\n+    { \"head\", \"table\" },\n+    { \"head\", \"tt\" },\n+    { \"head\", \"u\" },\n+    { \"head\", \"ul\" },\n+    { \"head\", \"var\" },\n+    { \"head\", \"xmp\" },\n+    { \"hr\", \"form\" },\n+    { \"i\", \"center\" },\n+    { \"i\", \"p\" },\n+    { \"i\", \"td\" },\n+    { \"i\", \"th\" },\n+    { \"legend\", \"fieldset\" },\n+    { \"li\", \"li\" },\n+    { \"link\", \"body\" },\n+    { \"link\", \"frameset\" },\n+    { \"listing\", \"dd\" },\n+    { \"listing\", \"dl\" },\n+    { \"listing\", \"dt\" },\n+    { \"listing\", \"fieldset\" },\n+    { \"listing\", \"form\" },\n+    { \"listing\", \"li\" },\n+    { \"listing\", \"table\" },\n+    { \"listing\", \"ul\" },\n+    { \"menu\", \"dd\" },\n+    { \"menu\", \"dl\" },\n+    { \"menu\", \"dt\" },\n+    { \"menu\", \"form\" },\n+    { \"menu\", \"ul\" },\n+    { \"ol\", \"form\" },\n+    { \"ol\", \"ul\" },\n+    { \"option\", \"optgroup\" },\n+    { \"option\", \"option\" },\n+    { \"p\", \"address\" },\n+    { \"p\", \"blockquote\" },\n+    { \"p\", \"body\" },\n+    { \"p\", \"caption\" },\n+    { \"p\", \"center\" },\n+    { \"p\", \"col\" },\n+    { \"p\", \"colgroup\" },\n+    { \"p\", \"dd\" },\n+    { \"p\", \"dir\" },\n+    { \"p\", \"div\" },\n+    { \"p\", \"dl\" },\n+    { \"p\", \"dt\" },\n+    { \"p\", \"fieldset\" },\n+    { \"p\", \"form\" },\n+    { \"p\", \"frameset\" },\n+    { \"p\", \"h1\" },\n+    { \"p\", \"h2\" },\n+    { \"p\", \"h3\" },\n+    { \"p\", \"h4\" },\n+    { \"p\", \"h5\" },\n+    { \"p\", \"h6\" },\n+    { \"p\", \"head\" },\n+    { \"p\", \"hr\" },\n+    { \"p\", \"li\" },\n+    { \"p\", \"listing\" },\n+    { \"p\", \"menu\" },\n+    { \"p\", \"ol\" },\n+    { \"p\", \"p\" },\n+    { \"p\", \"pre\" },\n+    { \"p\", \"table\" },\n+    { \"p\", \"tbody\" },\n+    { \"p\", \"td\" },\n+    { \"p\", \"tfoot\" },\n+    { \"p\", \"th\" },\n+    { \"p\", \"title\" },\n+    { \"p\", \"tr\" },\n+    { \"p\", \"ul\" },\n+    { \"p\", \"xmp\" },\n+    { \"pre\", \"dd\" },\n+    { \"pre\", \"dl\" },\n+    { \"pre\", \"dt\" },\n+    { \"pre\", \"fieldset\" },\n+    { \"pre\", \"form\" },\n+    { \"pre\", \"li\" },\n+    { \"pre\", \"table\" },\n+    { \"pre\", \"ul\" },\n+    { \"s\", \"p\" },\n+    { \"script\", \"noscript\" },\n+    { \"small\", \"p\" },\n+    { \"span\", \"td\" },\n+    { \"span\", \"th\" },\n+    { \"strike\", \"p\" },\n+    { \"style\", \"body\" },\n+    { \"style\", \"frameset\" },\n+    { \"tbody\", \"tbody\" },\n+    { \"tbody\", \"tfoot\" },\n+    { \"td\", \"tbody\" },\n+    { \"td\", \"td\" },\n+    { \"td\", \"tfoot\" },\n+    { \"td\", \"th\" },\n+    { \"td\", \"tr\" },\n+    { \"tfoot\", \"tbody\" },\n+    { \"th\", \"tbody\" },\n+    { \"th\", \"td\" },\n+    { \"th\", \"tfoot\" },\n+    { \"th\", \"th\" },\n+    { \"th\", \"tr\" },\n+    { \"thead\", \"tbody\" },\n+    { \"thead\", \"tfoot\" },\n+    { \"title\", \"body\" },\n+    { \"title\", \"frameset\" },\n+    { \"tr\", \"tbody\" },\n+    { \"tr\", \"tfoot\" },\n+    { \"tr\", \"tr\" },\n+    { \"tt\", \"p\" },\n+    { \"u\", \"p\" },\n+    { \"u\", \"td\" },\n+    { \"u\", \"th\" },\n+    { \"ul\", \"address\" },\n+    { \"ul\", \"form\" },\n+    { \"ul\", \"menu\" },\n+    { \"ul\", \"ol\" },\n+    { \"ul\", \"pre\" },\n+    { \"xmp\", \"dd\" },\n+    { \"xmp\", \"dl\" },\n+    { \"xmp\", \"dt\" },\n+    { \"xmp\", \"fieldset\" },\n+    { \"xmp\", \"form\" },\n+    { \"xmp\", \"li\" },\n+    { \"xmp\", \"table\" },\n+    { \"xmp\", \"ul\" }\n@@ -1214,3 +1404,0 @@\n-static const char** htmlStartCloseIndex[100];\n-static int htmlStartCloseIndexinitialized = 0;\n-\n@@ -1226,3 +1413,1 @@\n- * Initialize the htmlStartCloseIndex for fast lookup of closing tags names.\n- * This is not reentrant. Call xmlInitParser() once before processing in\n- * case of use in multithreaded programs.\n+ * This is a no-op now.\n@@ -1232,1 +1417,1 @@\n-    int indx, i = 0;\n+}\n@@ -1234,1 +1419,4 @@\n-    if (htmlStartCloseIndexinitialized) return;\n+static int\n+htmlCompareTags(const void *key, const void *member) {\n+    const xmlChar *tag = (const xmlChar *) key;\n+    const htmlElemDesc *desc = (const htmlElemDesc *) member;\n@@ -1236,8 +1424,1 @@\n-    for (indx = 0;indx < 100;indx ++) htmlStartCloseIndex[indx] = NULL;\n-    indx = 0;\n-    while ((htmlStartClose[i] != NULL) && (indx < 100 - 1)) {\n-        htmlStartCloseIndex[indx++] = (const char**) &htmlStartClose[i];\n-    while (htmlStartClose[i] != NULL) i++;\n-    i++;\n-    }\n-    htmlStartCloseIndexinitialized = 1;\n+    return(xmlStrcasecmp(tag, BAD_CAST desc->name));\n@@ -1256,1 +1437,2 @@\n-    unsigned int i;\n+    if (tag == NULL)\n+        return(NULL);\n@@ -1258,6 +1440,3 @@\n-    for (i = 0; i < (sizeof(html40ElementTable) \/\n-                     sizeof(html40ElementTable[0]));i++) {\n-        if (!xmlStrcasecmp(tag, BAD_CAST html40ElementTable[i].name))\n-        return((htmlElemDescPtr) &html40ElementTable[i]);\n-    }\n-    return(NULL);\n+    return((const htmlElemDesc *) bsearch(tag, html40ElementTable,\n+                sizeof(html40ElementTable) \/ sizeof(htmlElemDesc),\n+                sizeof(htmlElemDesc), htmlCompareTags));\n@@ -1284,0 +1463,13 @@\n+static int\n+htmlCompareStartClose(const void *vkey, const void *member) {\n+    const htmlStartCloseEntry *key = (const htmlStartCloseEntry *) vkey;\n+    const htmlStartCloseEntry *entry = (const htmlStartCloseEntry *) member;\n+    int ret;\n+\n+    ret = strcmp(key->oldTag, entry->oldTag);\n+    if (ret == 0)\n+        ret = strcmp(key->newTag, entry->newTag);\n+\n+    return(ret);\n+}\n+\n@@ -1291,1 +1483,0 @@\n- * Initialize the htmlStartCloseIndex for fast lookup of closing tags names.\n@@ -1298,24 +1489,9 @@\n-    int i, indx;\n-    const char **closed = NULL;\n-\n-    if (htmlStartCloseIndexinitialized == 0)\n-        htmlInitAutoClose();\n-\n-    \/* inefficient, but not a big deal *\/\n-    for (indx = 0; indx < 100; indx++) {\n-        closed = htmlStartCloseIndex[indx];\n-        if (closed == NULL)\n-            return (0);\n-        if (xmlStrEqual(BAD_CAST * closed, newtag))\n-            break;\n-    }\n-\n-    i = closed - htmlStartClose;\n-    i++;\n-    while (htmlStartClose[i] != NULL) {\n-        if (xmlStrEqual(BAD_CAST htmlStartClose[i], oldtag)) {\n-            return (1);\n-        }\n-        i++;\n-    }\n-    return (0);\n+    htmlStartCloseEntry key;\n+    void *res;\n+\n+    key.oldTag = (const char *) oldtag;\n+    key.newTag = (const char *) newtag;\n+    res = bsearch(&key, htmlStartClose,\n+            sizeof(htmlStartClose) \/ sizeof(htmlStartCloseEntry),\n+            sizeof(htmlStartCloseEntry), htmlCompareStartClose);\n+    return(res != NULL);\n@@ -2485,1 +2661,0 @@\n-        ctxt->nbChars += count;\n@@ -2792,0 +2967,2 @@\n+    int err = 0;\n+    int quote;\n@@ -2794,10 +2971,4 @@\n-    if (CUR == '\"') {\n-        NEXT;\n-\n-        if (CUR_PTR < BASE_PTR)\n-            return(ret);\n-        startPosition = CUR_PTR - BASE_PTR;\n-\n-    while ((IS_CHAR_CH(CUR)) && (CUR != '\"')) {\n-        NEXT;\n-        len++;\n+    if ((CUR != '\"') && (CUR != '\\'')) {\n+    htmlParseErr(ctxt, XML_ERR_LITERAL_NOT_STARTED,\n+                 \"SystemLiteral \\\" or ' expected\\n\", NULL, NULL);\n+        return(NULL);\n@@ -2805,9 +2976,2 @@\n-    if (!IS_CHAR_CH(CUR)) {\n-        htmlParseErr(ctxt, XML_ERR_LITERAL_NOT_FINISHED,\n-             \"Unfinished SystemLiteral\\n\", NULL, NULL);\n-    } else {\n-        ret = xmlStrndup((BASE_PTR+startPosition), len);\n-        NEXT;\n-        }\n-    } else if (CUR == '\\'') {\n-        NEXT;\n+    quote = CUR;\n+    NEXT;\n@@ -2815,3 +2979,3 @@\n-        if (CUR_PTR < BASE_PTR)\n-            return(ret);\n-        startPosition = CUR_PTR - BASE_PTR;\n+    if (CUR_PTR < BASE_PTR)\n+        return(ret);\n+    startPosition = CUR_PTR - BASE_PTR;\n@@ -2819,1 +2983,7 @@\n-    while ((IS_CHAR_CH(CUR)) && (CUR != '\\'')) {\n+    while ((CUR != 0) && (CUR != quote)) {\n+        \/* TODO: Handle UTF-8 *\/\n+        if (!IS_CHAR_CH(CUR)) {\n+            htmlParseErrInt(ctxt, XML_ERR_INVALID_CHAR,\n+                            \"Invalid char in SystemLiteral 0x%X\\n\", CUR);\n+            err = 1;\n+        }\n@@ -2823,1 +2993,1 @@\n-    if (!IS_CHAR_CH(CUR)) {\n+    if (CUR != quote) {\n@@ -2825,1 +2995,1 @@\n-             \"Unfinished SystemLiteral\\n\", NULL, NULL);\n+                     \"Unfinished SystemLiteral\\n\", NULL, NULL);\n@@ -2827,1 +2997,0 @@\n-        ret = xmlStrndup((BASE_PTR+startPosition), len);\n@@ -2829,4 +2998,2 @@\n-        }\n-    } else {\n-    htmlParseErr(ctxt, XML_ERR_LITERAL_NOT_STARTED,\n-                 \" or ' expected\\n\", NULL, NULL);\n+        if (err == 0)\n+            ret = xmlStrndup((BASE_PTR+startPosition), len);\n@@ -2852,0 +3019,2 @@\n+    int err = 0;\n+    int quote;\n@@ -2853,0 +3022,9 @@\n+\n+    if ((CUR != '\"') && (CUR != '\\'')) {\n+    htmlParseErr(ctxt, XML_ERR_LITERAL_NOT_STARTED,\n+                 \"PubidLiteral \\\" or ' expected\\n\", NULL, NULL);\n+        return(NULL);\n+    }\n+    quote = CUR;\n+    NEXT;\n+\n@@ -2856,6 +3034,3 @@\n-    if (CUR == '\"') {\n-        NEXT;\n-\n-        if (CUR_PTR < BASE_PTR)\n-            return(ret);\n-        startPosition = CUR_PTR - BASE_PTR;\n+    if (CUR_PTR < BASE_PTR)\n+        return(ret);\n+    startPosition = CUR_PTR - BASE_PTR;\n@@ -2863,3 +3038,5 @@\n-        while (IS_PUBIDCHAR_CH(CUR)) {\n-            len++;\n-            NEXT;\n+    while ((CUR != 0) && (CUR != quote)) {\n+        if (!IS_PUBIDCHAR_CH(CUR)) {\n+            htmlParseErrInt(ctxt, XML_ERR_INVALID_CHAR,\n+                            \"Invalid char in PubidLiteral 0x%X\\n\", CUR);\n+            err = 1;\n@@ -2867,6 +3044,1 @@\n-\n-    if (CUR != '\"') {\n-        htmlParseErr(ctxt, XML_ERR_LITERAL_NOT_FINISHED,\n-                     \"Unfinished PubidLiteral\\n\", NULL, NULL);\n-    } else {\n-        ret = xmlStrndup((BASE_PTR + startPosition), len);\n+        len++;\n@@ -2875,6 +3047,0 @@\n-    } else if (CUR == '\\'') {\n-        NEXT;\n-\n-        if (CUR_PTR < BASE_PTR)\n-            return(ret);\n-        startPosition = CUR_PTR - BASE_PTR;\n@@ -2882,6 +3048,1 @@\n-        while ((IS_PUBIDCHAR_CH(CUR)) && (CUR != '\\'')){\n-            len++;\n-            NEXT;\n-        }\n-\n-    if (CUR != '\\'') {\n+    if (CUR != '\"') {\n@@ -2891,1 +3052,0 @@\n-        ret = xmlStrndup((BASE_PTR + startPosition), len);\n@@ -2893,4 +3053,2 @@\n-    }\n-    } else {\n-    htmlParseErr(ctxt, XML_ERR_LITERAL_NOT_STARTED,\n-                 \"PubidLiteral \\\" or ' expected\\n\", NULL, NULL);\n+        if (err == 0)\n+            ret = xmlStrndup((BASE_PTR + startPosition), len);\n@@ -2931,1 +3089,1 @@\n-    while (IS_CHAR_CH(cur)) {\n+    while (cur != 0) {\n@@ -2962,1 +3120,6 @@\n-    COPY_BUF(l,buf,nbchar,cur);\n+        if (IS_CHAR(cur)) {\n+        COPY_BUF(l,buf,nbchar,cur);\n+        } else {\n+            htmlParseErrInt(ctxt, XML_ERR_INVALID_CHAR,\n+                            \"Invalid char in CDATA 0x%X\\n\", cur);\n+        }\n@@ -2980,8 +3143,0 @@\n-    if ((!(IS_CHAR_CH(cur))) && (!((cur == 0) && (ctxt->progressive)))) {\n-        htmlParseErrInt(ctxt, XML_ERR_INVALID_CHAR,\n-                    \"Invalid char in CDATA 0x%X\\n\", cur);\n-        if (ctxt->input->cur < ctxt->input->end) {\n-            NEXT;\n-        }\n-    }\n-\n@@ -3235,1 +3390,1 @@\n-        while (IS_CHAR(cur) && (cur != '>')) {\n+        while ((cur != 0) && (cur != '>')) {\n@@ -3254,1 +3409,7 @@\n-        COPY_BUF(l,buf,len,cur);\n+                if (IS_CHAR(cur)) {\n+            COPY_BUF(l,buf,len,cur);\n+                } else {\n+                    htmlParseErrInt(ctxt, XML_ERR_INVALID_CHAR,\n+                                    \"Invalid char in processing instruction \"\n+                                    \"0x%X\\n\", cur);\n+                }\n@@ -3303,0 +3464,1 @@\n+    int next, nl;\n@@ -3324,1 +3486,1 @@\n-    if (!IS_CHAR(q))\n+    if (q == 0)\n@@ -3328,1 +3490,1 @@\n-    if (!IS_CHAR(r))\n+    if (r == 0)\n@@ -3332,1 +3494,1 @@\n-    while (IS_CHAR(cur) &&\n+    while ((cur != 0) &&\n@@ -3335,0 +3497,15 @@\n+    NEXTL(l);\n+    next = CUR_CHAR(nl);\n+    if (next == 0) {\n+        SHRINK;\n+        GROW;\n+        next = CUR_CHAR(nl);\n+    }\n+\n+    if ((q == '-') && (r == '-') && (cur == '!') && (next == '>')) {\n+      htmlParseErr(ctxt, XML_ERR_COMMENT_NOT_FINISHED,\n+               \"Comment incorrectly closed by '--!>'\", NULL, NULL);\n+      cur = '>';\n+      break;\n+    }\n+\n@@ -3348,1 +3525,7 @@\n-    COPY_BUF(ql,buf,len,q);\n+        if (IS_CHAR(q)) {\n+        COPY_BUF(ql,buf,len,q);\n+        } else {\n+            htmlParseErrInt(ctxt, XML_ERR_INVALID_CHAR,\n+                            \"Invalid char in comment 0x%X\\n\", q);\n+        }\n+\n@@ -3353,7 +3536,2 @@\n-    NEXTL(l);\n-    cur = CUR_CHAR(l);\n-    if (cur == 0) {\n-        SHRINK;\n-        GROW;\n-        cur = CUR_CHAR(l);\n-    }\n+    cur = next;\n+    l = nl;\n@@ -3362,1 +3540,1 @@\n-    if (IS_CHAR(cur)) {\n+    if (cur == '>') {\n@@ -3509,1 +3687,3 @@\n-        \/* We shouldn't try to resynchronize ... *\/\n+        \/* Ignore bogus content *\/\n+        while ((CUR != 0) && (CUR != '>'))\n+            NEXT;\n@@ -3511,1 +3691,2 @@\n-    NEXT;\n+    if (CUR == '>')\n+        NEXT;\n@@ -3789,1 +3970,1 @@\n-    while ((IS_CHAR_CH(CUR)) && (CUR != '>') &&\n+    while ((CUR != 0) && (CUR != '>') &&\n@@ -3845,1 +4026,1 @@\n-    while ((IS_CHAR_CH(CUR)) &&\n+    while ((CUR != 0) &&\n@@ -3848,2 +4029,0 @@\n-    long cons = ctxt->nbChars;\n-\n@@ -3908,1 +4087,1 @@\n-        while ((IS_CHAR_CH(CUR)) &&\n+        while ((CUR != 0) &&\n@@ -3916,6 +4095,0 @@\n-        if (cons == ctxt->nbChars) {\n-        htmlParseErr(ctxt, XML_ERR_INTERNAL_ERROR,\n-                     \"htmlParseStartTag: problem parsing attributes\\n\",\n-             NULL, NULL);\n-        break;\n-    }\n@@ -3989,1 +4162,1 @@\n-    if ((!IS_CHAR_CH(CUR)) || (CUR != '>')) {\n+    if (CUR != '>') {\n@@ -3992,8 +4165,3 @@\n-    if (ctxt->recovery) {\n-        \/*\n-         * We're not at the ending > !!\n-         * Error, unless in recover mode where we search forwards\n-         * until we find a >\n-         *\/\n-        while (CUR != '\\0' && CUR != '>') NEXT;\n-        NEXT;\n+        \/* Skip to next '>' *\/\n+        while ((CUR != 0) && (CUR != '>'))\n+            NEXT;\n@@ -4001,1 +4169,1 @@\n-    } else\n+    if (CUR == '>')\n@@ -4042,3 +4210,2 @@\n-    if (!xmlStrEqual(name, ctxt->name)) {\n-        if ((ctxt->name != NULL) && (!xmlStrEqual(ctxt->name, name))) {\n-            htmlParseErr(ctxt, XML_ERR_TAG_NAME_MISMATCH,\n+    if ((ctxt->name != NULL) && (!xmlStrEqual(ctxt->name, name))) {\n+        htmlParseErr(ctxt, XML_ERR_TAG_NAME_MISMATCH,\n@@ -4046,2 +4213,1 @@\n-             name, ctxt->name);\n-        }\n+                     name, ctxt->name);\n@@ -4162,2 +4328,0 @@\n-    long cons = ctxt->nbChars;\n-\n@@ -4191,1 +4355,1 @@\n-        while ((IS_CHAR_CH(CUR)) && (CUR != '>'))\n+                while ((CUR != 0) && (CUR != '>'))\n@@ -4283,9 +4447,0 @@\n-\n-        if (cons == ctxt->nbChars) {\n-        if (ctxt->node != NULL) {\n-            htmlParseErr(ctxt, XML_ERR_INTERNAL_ERROR,\n-                         \"detected an error in element content\\n\",\n-                 NULL, NULL);\n-        }\n-        break;\n-        }\n@@ -4406,1 +4561,1 @@\n-    while (IS_CHAR_CH(CUR)) {\n+    while (CUR != 0) {\n@@ -4423,1 +4578,1 @@\n-    if (!IS_CHAR_CH(CUR)) {\n+    if (CUR == 0) {\n@@ -4444,1 +4599,1 @@\n-    if (!IS_CHAR_CH(CUR)) {\n+    if (CUR == 0) {\n@@ -4562,2 +4717,0 @@\n-    long cons = ctxt->nbChars;\n-\n@@ -4593,1 +4746,1 @@\n-            while ((IS_CHAR_CH(CUR)) && (CUR != '>'))\n+            while ((CUR == 0) && (CUR != '>'))\n@@ -4697,9 +4850,0 @@\n-\n-        if (cons == ctxt->nbChars) {\n-        if (ctxt->node != NULL) {\n-            htmlParseErr(ctxt, XML_ERR_INTERNAL_ERROR,\n-                         \"detected an error in element content\\n\",\n-                 NULL, NULL);\n-        }\n-        break;\n-        }\n@@ -4969,1 +5113,0 @@\n-    ctxt->nbChars = 0;\n@@ -5129,1 +5272,1 @@\n- * @comment: flag to force checking inside comments\n+ * @ignoreattrval: skip over attribute values\n@@ -5143,2 +5286,1 @@\n-                        xmlChar next, xmlChar third, int iscomment,\n-                        int ignoreattrval)\n+                        xmlChar next, xmlChar third, int ignoreattrval)\n@@ -5149,1 +5291,0 @@\n-    int incomment = 0;\n@@ -5161,1 +5302,1 @@\n-    if (ctxt->checkIndex > base)\n+    if (ctxt->checkIndex > base) {\n@@ -5163,0 +5304,3 @@\n+        \/* Abuse hasPErefs member to restore current state. *\/\n+        invalue = ctxt->hasPErefs & 1 ? 1 : 0;\n+    }\n@@ -5178,8 +5322,0 @@\n-        if ((!incomment) && (base + 4 < len) && (!iscomment)) {\n-            if ((buf[base] == '<') && (buf[base + 1] == '!') &&\n-                (buf[base + 2] == '-') && (buf[base + 3] == '-')) {\n-                incomment = 1;\n-                \/* do not increment past <! - some people use <!--> *\/\n-                base += 2;\n-            }\n-        }\n@@ -5202,10 +5338,0 @@\n-        if (incomment) {\n-            if (base + 3 > len)\n-                return (-1);\n-            if ((buf[base] == '-') && (buf[base + 1] == '-') &&\n-                (buf[base + 2] == '>')) {\n-                incomment = 0;\n-                base += 2;\n-            }\n-            continue;\n-        }\n@@ -5238,2 +5364,6 @@\n-    if ((!incomment) && (!invalue))\n-        ctxt->checkIndex = base;\n+    ctxt->checkIndex = base;\n+    \/* Abuse hasPErefs member to track current state. *\/\n+    if (invalue)\n+        ctxt->hasPErefs |= 1;\n+    else\n+        ctxt->hasPErefs &= ~1;\n@@ -5256,1 +5386,1 @@\n- * htmlParseLookupChars:\n+ * htmlParseLookupCommentEnd:\n@@ -5258,2 +5388,0 @@\n- * @stop: Array of chars, which stop the lookup.\n- * @stopLen: Length of stop-Array\n@@ -5261,2 +5389,3 @@\n- * Try to find if any char of the stop-Array is available in the input\n- * stream.\n+ * Try to find a comment end tag in the input stream\n+ * The search includes \"-->\" as well as WHATWG-recommended incorrectly-closed tags.\n+ * (See https:\/\/html.spec.whatwg.org\/multipage\/parsing.html#parse-error-incorrectly-closed-comment)\n@@ -5266,0 +5395,1 @@\n+ * This wraps to htmlParseLookupSequence()\n@@ -5267,2 +5397,1 @@\n- * Returns the index to the current parsing point if a stopChar\n- *      is available, -1 otherwise.\n+ * Returns the index to the current parsing point if the full sequence is available, -1 otherwise.\n@@ -5271,2 +5400,1 @@\n-htmlParseLookupChars(htmlParserCtxtPtr ctxt, const xmlChar * stop,\n-                     int stopLen)\n+htmlParseLookupCommentEnd(htmlParserCtxtPtr ctxt)\n@@ -5274,9 +5402,2 @@\n-    int base, len;\n-    htmlParserInputPtr in;\n-    const xmlChar *buf;\n-    int incomment = 0;\n-    int i;\n-\n-    in = ctxt->input;\n-    if (in == NULL)\n-        return (-1);\n+    int mark = 0;\n+    int cur = CUR_PTR - BASE_PTR;\n@@ -5284,13 +5405,6 @@\n-    base = in->cur - in->base;\n-    if (base < 0)\n-        return (-1);\n-\n-    if (ctxt->checkIndex > base)\n-        base = ctxt->checkIndex;\n-\n-    if (in->buf == NULL) {\n-        buf = in->base;\n-        len = in->length;\n-    } else {\n-        buf = xmlBufContent(in->buf->buffer);\n-        len = xmlBufUse(in->buf->buffer);\n+    while (mark >= 0) {\n+    mark = htmlParseLookupSequence(ctxt, '-', '-', 0, 0);\n+    if ((mark < 0) ||\n+        (NXT(mark+2) == '>') ||\n+        ((NXT(mark+2) == '!') && (NXT(mark+3) == '>'))) {\n+        return mark;\n@@ -5298,26 +5412,1 @@\n-\n-    for (; base < len; base++) {\n-        if (!incomment && (base + 4 < len)) {\n-            if ((buf[base] == '<') && (buf[base + 1] == '!') &&\n-                (buf[base + 2] == '-') && (buf[base + 3] == '-')) {\n-                incomment = 1;\n-                \/* do not increment past <! - some people use <!--> *\/\n-                base += 2;\n-            }\n-        }\n-        if (incomment) {\n-            if (base + 3 > len)\n-                return (-1);\n-            if ((buf[base] == '-') && (buf[base + 1] == '-') &&\n-                (buf[base + 2] == '>')) {\n-                incomment = 0;\n-                base += 2;\n-            }\n-            continue;\n-        }\n-        for (i = 0; i < stopLen; ++i) {\n-            if (buf[base] == stop[i]) {\n-                ctxt->checkIndex = 0;\n-                return (base - (in->cur - in->base));\n-            }\n-        }\n+    ctxt->checkIndex = cur + mark + 1;\n@@ -5325,2 +5414,1 @@\n-    ctxt->checkIndex = base;\n-    return (-1);\n+    return mark;\n@@ -5329,0 +5417,1 @@\n+\n@@ -5422,0 +5511,6 @@\n+        \/*\n+         * This is done to make progress and avoid an infinite loop\n+         * if a parsing attempt was aborted by hitting a NUL byte. After\n+         * changing htmlCurrentChar, this probably isn't necessary anymore.\n+         * We should consider removing this check.\n+         *\/\n@@ -5462,1 +5557,1 @@\n-                (htmlParseLookupSequence(ctxt, '>', 0, 0, 0, 1) < 0))\n+                (htmlParseLookupSequence(ctxt, '>', 0, 0, 1) < 0))\n@@ -5495,1 +5590,1 @@\n-         * not enouth chars in buffer\n+         * not enough chars in buffer\n@@ -5508,2 +5603,1 @@\n-            if ((!terminate) &&\n-                (htmlParseLookupSequence(ctxt, '-', '-', '>', 1, 1) < 0))\n+            if ((!terminate) && (htmlParseLookupCommentEnd(ctxt) < 0))\n@@ -5519,1 +5613,1 @@\n-                (htmlParseLookupSequence(ctxt, '>', 0, 0, 0, 1) < 0))\n+                (htmlParseLookupSequence(ctxt, '>', 0, 0, 0) < 0))\n@@ -5533,1 +5627,1 @@\n-                (htmlParseLookupSequence(ctxt, '>', 0, 0, 0, 1) < 0))\n+                (htmlParseLookupSequence(ctxt, '>', 0, 0, 1) < 0))\n@@ -5549,1 +5643,1 @@\n-            ctxt->instate = XML_PARSER_START_TAG;\n+            ctxt->instate = XML_PARSER_CONTENT;\n@@ -5569,2 +5663,1 @@\n-            if ((!terminate) &&\n-                (htmlParseLookupSequence(ctxt, '-', '-', '>', 1, 1) < 0))\n+            if ((!terminate) && (htmlParseLookupCommentEnd(ctxt) < 0))\n@@ -5580,1 +5673,1 @@\n-                (htmlParseLookupSequence(ctxt, '>', 0, 0, 0, 1) < 0))\n+                (htmlParseLookupSequence(ctxt, '>', 0, 0, 0) < 0))\n@@ -5592,1 +5685,1 @@\n-            ctxt->instate = XML_PARSER_START_TAG;\n+            ctxt->instate = XML_PARSER_CONTENT;\n@@ -5617,2 +5710,1 @@\n-            if ((!terminate) &&\n-                (htmlParseLookupSequence(ctxt, '-', '-', '>', 1, 1) < 0))\n+            if ((!terminate) && (htmlParseLookupCommentEnd(ctxt) < 0))\n@@ -5628,1 +5720,1 @@\n-                (htmlParseLookupSequence(ctxt, '>', 0, 0, 0, 1) < 0))\n+                (htmlParseLookupSequence(ctxt, '>', 0, 0, 0) < 0))\n@@ -5663,1 +5755,1 @@\n-         * not enouth chars in buffer\n+         * not enough chars in buffer\n@@ -5692,1 +5784,1 @@\n-            (htmlParseLookupSequence(ctxt, '>', 0, 0, 0, 1) < 0))\n+            (htmlParseLookupSequence(ctxt, '>', 0, 0, 1) < 0))\n@@ -5784,1 +5876,0 @@\n-        long cons;\n@@ -5829,1 +5920,0 @@\n-        cons = ctxt->nbChars;\n@@ -5839,1 +5929,1 @@\n-            idx = htmlParseLookupSequence(ctxt, '<', '\/', 0, 0, 0);\n+            idx = htmlParseLookupSequence(ctxt, '<', '\/', 0, 0);\n@@ -5866,1 +5956,1 @@\n-                (htmlParseLookupSequence(ctxt, '>', 0, 0, 0, 1) < 0))\n+                (htmlParseLookupSequence(ctxt, '>', 0, 0, 1) < 0))\n@@ -5874,3 +5964,1 @@\n-            if ((!terminate) &&\n-                (htmlParseLookupSequence(\n-                ctxt, '-', '-', '>', 1, 1) < 0))\n+            if ((!terminate) && (htmlParseLookupCommentEnd(ctxt) < 0))\n@@ -5886,1 +5974,1 @@\n-                (htmlParseLookupSequence(ctxt, '>', 0, 0, 0, 1) < 0))\n+                (htmlParseLookupSequence(ctxt, '>', 0, 0, 0) < 0))\n@@ -5905,2 +5993,12 @@\n-            ctxt->instate = XML_PARSER_START_TAG;\n-            ctxt->checkIndex = 0;\n+                        if ((!terminate) && (next == 0))\n+                            goto done;\n+                        \/*\n+                         * Only switch to START_TAG if the next character\n+                         * starts a valid name. Otherwise, htmlParseStartTag\n+                         * might return without consuming all characters\n+                         * up to the final '>'.\n+                         *\/\n+                        if ((IS_ASCII_LETTER(next)) ||\n+                            (next == '_') || (next == ':') || (next == '.')) {\n+                            ctxt->instate = XML_PARSER_START_TAG;\n+                            ctxt->checkIndex = 0;\n@@ -5908,2 +6006,2 @@\n-            xmlGenericError(xmlGenericErrorContext,\n-                \"HPP: entering START_TAG\\n\");\n+                            xmlGenericError(xmlGenericErrorContext,\n+                                    \"HPP: entering START_TAG\\n\");\n@@ -5911,0 +6009,12 @@\n+                        } else {\n+                            htmlParseErr(ctxt, XML_ERR_NAME_REQUIRED,\n+                                         \"htmlParseTryOrFinish: \"\n+                                         \"invalid element name\\n\",\n+                                         NULL, NULL);\n+                            htmlCheckParagraph(ctxt);\n+                            if ((ctxt->sax != NULL) &&\n+                                (ctxt->sax->characters != NULL))\n+                                ctxt->sax->characters(ctxt->userData,\n+                                                      in->cur, 1);\n+                            NEXT;\n+                        }\n@@ -5912,11 +6022,0 @@\n-            } else if (cur == '&') {\n-            if ((!terminate) &&\n-                (htmlParseLookupChars(ctxt,\n-                                                  BAD_CAST \"; >\/\", 4) < 0))\n-                goto done;\n-#ifdef DEBUG_PUSH\n-            xmlGenericError(xmlGenericErrorContext,\n-                \"HPP: Parsing Reference\\n\");\n-#endif\n-            \/* TODO: check generation of subtrees if noent !!! *\/\n-            htmlParseReference(ctxt);\n@@ -5931,1 +6030,1 @@\n-                            (htmlParseLookupChars(ctxt, BAD_CAST \"<&\", 2) < 0))\n+                            (htmlParseLookupSequence(ctxt, '<', 0, 0, 0) < 0))\n@@ -5938,1 +6037,9 @@\n-            htmlParseCharData(ctxt);\n+                        while ((ctxt->instate != XML_PARSER_EOF) &&\n+                               (cur != '<') && (in->cur < in->end)) {\n+                            if (cur == '&') {\n+                    htmlParseReference(ctxt);\n+                            } else {\n+                    htmlParseCharData(ctxt);\n+                            }\n+                            cur = in->cur[0];\n+                        }\n@@ -5941,9 +6048,0 @@\n-        if (cons == ctxt->nbChars) {\n-            if (ctxt->node != NULL) {\n-            htmlParseErr(ctxt, XML_ERR_INTERNAL_ERROR,\n-                         \"detected an error in element content\\n\",\n-                     NULL, NULL);\n-            }\n-            NEXT;\n-            break;\n-        }\n@@ -5957,1 +6055,1 @@\n-            (htmlParseLookupSequence(ctxt, '>', 0, 0, 0, 1) < 0))\n+            (htmlParseLookupSequence(ctxt, '>', 0, 0, 0) < 0))\n@@ -6139,1 +6237,1 @@\n-    xmlBufSetInputBaseCur(ctxt->input->buf->buffer, ctxt->input, base, cur);\n+        xmlBufSetInputBaseCur(ctxt->input->buf->buffer, ctxt->input, base, cur);\n@@ -6686,1 +6784,0 @@\n-    ctxt->nbChars = 0;\n","filename":"modules\/javafx.web\/src\/main\/native\/Source\/ThirdParty\/libxml\/src\/HTMLparser.c","additions":604,"deletions":507,"binary":false,"changes":1111,"status":"modified"},{"patch":"@@ -229,1 +229,1 @@\n-     * encoding informations\n+     * encoding information\n@@ -348,1 +348,1 @@\n- * @extra:  extra informations\n+ * @extra:  extra information\n@@ -362,1 +362,1 @@\n- * @extra:  extra informations\n+ * @extra:  extra information\n@@ -521,1 +521,1 @@\n-    htmlNodeDumpFormatOutput(buf, doc, cur, encoding, format);\n+    htmlNodeDumpFormatOutput(buf, doc, cur, NULL, format);\n@@ -673,1 +673,0 @@\n- * @encoding:  the encoding string\n@@ -678,2 +677,1 @@\n-htmlAttrDumpOutput(xmlOutputBufferPtr buf, xmlDocPtr doc, xmlAttrPtr cur,\n-               const char *encoding ATTRIBUTE_UNUSED) {\n+htmlAttrDumpOutput(xmlOutputBufferPtr buf, xmlDocPtr doc, xmlAttrPtr cur) {\n@@ -709,0 +707,1 @@\n+        xmlChar *escaped;\n@@ -710,2 +709,0 @@\n-        \/* xmlURIEscapeStr() escapes '\"' so it can be safely used. *\/\n-        xmlBufCCat(buf->buffer, \"\\\"\");\n@@ -715,34 +712,10 @@\n-        \/* URI Escape everything, except server side includes. *\/\n-        for ( ; ; ) {\n-            xmlChar *escaped;\n-            xmlChar endChar;\n-            xmlChar *end = NULL;\n-            xmlChar *start = (xmlChar *)xmlStrstr(tmp, BAD_CAST \"<!--\");\n-            if (start != NULL) {\n-            end = (xmlChar *)xmlStrstr(tmp, BAD_CAST \"-->\");\n-            if (end != NULL) {\n-                *start = '\\0';\n-            }\n-            }\n-\n-            \/* Escape the whole string, or until start (set to '\\0'). *\/\n-            escaped = xmlURIEscapeStr(tmp, BAD_CAST\"@\/:=?;#%&,+\");\n-            if (escaped != NULL) {\n-                xmlBufCat(buf->buffer, escaped);\n-                xmlFree(escaped);\n-            } else {\n-                xmlBufCat(buf->buffer, tmp);\n-            }\n-\n-            if (end == NULL) { \/* Everything has been written. *\/\n-            break;\n-            }\n-\n-            \/* Do not escape anything within server side includes. *\/\n-            *start = '<'; \/* Restore the first character of \"<!--\". *\/\n-            end += 3; \/* strlen(\"-->\") *\/\n-            endChar = *end;\n-            *end = '\\0';\n-            xmlBufCat(buf->buffer, start);\n-            *end = endChar;\n-            tmp = end;\n+        \/*\n+         * the < and > have already been escaped at the entity level\n+         * And doing so here breaks server side includes\n+         *\/\n+        escaped = xmlURIEscapeStr(tmp, BAD_CAST\"@\/:=?;#%&,+<>\");\n+        if (escaped != NULL) {\n+            xmlBufWriteQuotedString(buf->buffer, escaped);\n+            xmlFree(escaped);\n+        } else {\n+            xmlBufWriteQuotedString(buf->buffer, value);\n@@ -750,2 +723,0 @@\n-\n-        xmlBufCCat(buf->buffer, \"\\\"\");\n@@ -762,44 +733,0 @@\n-\/**\n- * htmlAttrListDumpOutput:\n- * @buf:  the HTML buffer output\n- * @doc:  the document\n- * @cur:  the first attribute pointer\n- * @encoding:  the encoding string\n- *\n- * Dump a list of HTML attributes\n- *\/\n-static void\n-htmlAttrListDumpOutput(xmlOutputBufferPtr buf, xmlDocPtr doc, xmlAttrPtr cur, const char *encoding) {\n-    if (cur == NULL) {\n-    return;\n-    }\n-    while (cur != NULL) {\n-        htmlAttrDumpOutput(buf, doc, cur, encoding);\n-    cur = cur->next;\n-    }\n-}\n-\n-\n-\n-\/**\n- * htmlNodeListDumpOutput:\n- * @buf:  the HTML buffer output\n- * @doc:  the document\n- * @cur:  the first node\n- * @encoding:  the encoding string\n- * @format:  should formatting spaces been added\n- *\n- * Dump an HTML node list, recursive behaviour,children are printed too.\n- *\/\n-static void\n-htmlNodeListDumpOutput(xmlOutputBufferPtr buf, xmlDocPtr doc,\n-                   xmlNodePtr cur, const char *encoding, int format) {\n-    if (cur == NULL) {\n-    return;\n-    }\n-    while (cur != NULL) {\n-        htmlNodeDumpFormatOutput(buf, doc, cur, encoding, format);\n-    cur = cur->next;\n-    }\n-}\n-\n@@ -811,1 +738,1 @@\n- * @encoding:  the encoding string\n+ * @encoding:  the encoding string (unused)\n@@ -818,1 +745,4 @@\n-                     xmlNodePtr cur, const char *encoding, int format) {\n+                     xmlNodePtr cur, const char *encoding ATTRIBUTE_UNUSED,\n+                         int format) {\n+    xmlNodePtr root;\n+    xmlAttrPtr attr;\n@@ -826,66 +756,0 @@\n-    \/*\n-     * Special cases.\n-     *\/\n-    if (cur->type == XML_DTD_NODE)\n-    return;\n-    if ((cur->type == XML_HTML_DOCUMENT_NODE) ||\n-        (cur->type == XML_DOCUMENT_NODE)){\n-    htmlDocContentDumpOutput(buf, (xmlDocPtr) cur, encoding);\n-    return;\n-    }\n-    if (cur->type == XML_ATTRIBUTE_NODE) {\n-        htmlAttrDumpOutput(buf, doc, (xmlAttrPtr) cur, encoding);\n-    return;\n-    }\n-    if (cur->type == HTML_TEXT_NODE) {\n-    if (cur->content != NULL) {\n-        if (((cur->name == (const xmlChar *)xmlStringText) ||\n-         (cur->name != (const xmlChar *)xmlStringTextNoenc)) &&\n-        ((cur->parent == NULL) ||\n-         ((xmlStrcasecmp(cur->parent->name, BAD_CAST \"script\")) &&\n-          (xmlStrcasecmp(cur->parent->name, BAD_CAST \"style\"))))) {\n-        xmlChar *buffer;\n-\n-        buffer = xmlEncodeEntitiesReentrant(doc, cur->content);\n-        if (buffer != NULL) {\n-            xmlOutputBufferWriteString(buf, (const char *)buffer);\n-            xmlFree(buffer);\n-        }\n-        } else {\n-        xmlOutputBufferWriteString(buf, (const char *)cur->content);\n-        }\n-    }\n-    return;\n-    }\n-    if (cur->type == HTML_COMMENT_NODE) {\n-    if (cur->content != NULL) {\n-        xmlOutputBufferWriteString(buf, \"<!--\");\n-        xmlOutputBufferWriteString(buf, (const char *)cur->content);\n-        xmlOutputBufferWriteString(buf, \"-->\");\n-    }\n-    return;\n-    }\n-    if (cur->type == HTML_PI_NODE) {\n-    if (cur->name == NULL)\n-        return;\n-    xmlOutputBufferWriteString(buf, \"<?\");\n-    xmlOutputBufferWriteString(buf, (const char *)cur->name);\n-    if (cur->content != NULL) {\n-        xmlOutputBufferWriteString(buf, \" \");\n-        xmlOutputBufferWriteString(buf, (const char *)cur->content);\n-    }\n-    xmlOutputBufferWriteString(buf, \">\");\n-    return;\n-    }\n-    if (cur->type == HTML_ENTITY_REF_NODE) {\n-        xmlOutputBufferWriteString(buf, \"&\");\n-    xmlOutputBufferWriteString(buf, (const char *)cur->name);\n-        xmlOutputBufferWriteString(buf, \";\");\n-    return;\n-    }\n-    if (cur->type == HTML_PRESERVE_NODE) {\n-    if (cur->content != NULL) {\n-        xmlOutputBufferWriteString(buf, (const char *)cur->content);\n-    }\n-    return;\n-    }\n@@ -893,7 +757,13 @@\n-    \/*\n-     * Get specific HTML info for that node.\n-     *\/\n-    if (cur->ns == NULL)\n-    info = htmlTagLookup(cur->name);\n-    else\n-    info = NULL;\n+    root = cur;\n+    while (1) {\n+        switch (cur->type) {\n+        case XML_HTML_DOCUMENT_NODE:\n+        case XML_DOCUMENT_NODE:\n+            if (((xmlDocPtr) cur)->intSubset != NULL) {\n+                htmlDtdDumpOutput(buf, (xmlDocPtr) cur, NULL);\n+            }\n+            if (cur->children != NULL) {\n+                cur = cur->children;\n+                continue;\n+            }\n+            break;\n@@ -901,31 +771,10 @@\n-    xmlOutputBufferWriteString(buf, \"<\");\n-    if ((cur->ns != NULL) && (cur->ns->prefix != NULL)) {\n-        xmlOutputBufferWriteString(buf, (const char *)cur->ns->prefix);\n-    xmlOutputBufferWriteString(buf, \":\");\n-    }\n-    xmlOutputBufferWriteString(buf, (const char *)cur->name);\n-    if (cur->nsDef)\n-    xmlNsListDumpOutput(buf, cur->nsDef);\n-    if (cur->properties != NULL)\n-        htmlAttrListDumpOutput(buf, doc, cur->properties, encoding);\n-\n-    if ((info != NULL) && (info->empty)) {\n-        xmlOutputBufferWriteString(buf, \">\");\n-    if ((format) && (!info->isinline) && (cur->next != NULL)) {\n-        if ((cur->next->type != HTML_TEXT_NODE) &&\n-        (cur->next->type != HTML_ENTITY_REF_NODE) &&\n-        (cur->parent != NULL) &&\n-        (cur->parent->name != NULL) &&\n-        (cur->parent->name[0] != 'p')) \/* p, pre, param *\/\n-        xmlOutputBufferWriteString(buf, \"\\n\");\n-    }\n-    return;\n-    }\n-    if (((cur->type == XML_ELEMENT_NODE) || (cur->content == NULL)) &&\n-    (cur->children == NULL)) {\n-        if ((info != NULL) && (info->saveEndTag != 0) &&\n-        (xmlStrcmp(BAD_CAST info->name, BAD_CAST \"html\")) &&\n-        (xmlStrcmp(BAD_CAST info->name, BAD_CAST \"body\"))) {\n-        xmlOutputBufferWriteString(buf, \">\");\n-    } else {\n-        xmlOutputBufferWriteString(buf, \"><\/\");\n+        case XML_ELEMENT_NODE:\n+            \/*\n+             * Get specific HTML info for that node.\n+             *\/\n+            if (cur->ns == NULL)\n+                info = htmlTagLookup(cur->name);\n+            else\n+                info = NULL;\n+\n+            xmlOutputBufferWriteString(buf, \"<\");\n@@ -936,21 +785,8 @@\n-        xmlOutputBufferWriteString(buf, (const char *)cur->name);\n-        xmlOutputBufferWriteString(buf, \">\");\n-    }\n-    if ((format) && (cur->next != NULL) &&\n-            (info != NULL) && (!info->isinline)) {\n-        if ((cur->next->type != HTML_TEXT_NODE) &&\n-        (cur->next->type != HTML_ENTITY_REF_NODE) &&\n-        (cur->parent != NULL) &&\n-        (cur->parent->name != NULL) &&\n-        (cur->parent->name[0] != 'p')) \/* p, pre, param *\/\n-        xmlOutputBufferWriteString(buf, \"\\n\");\n-    }\n-    return;\n-    }\n-    xmlOutputBufferWriteString(buf, \">\");\n-    if ((cur->type != XML_ELEMENT_NODE) &&\n-    (cur->content != NULL)) {\n-        \/*\n-         * Uses the OutputBuffer property to automatically convert\n-         * invalids to charrefs\n-         *\/\n+            xmlOutputBufferWriteString(buf, (const char *)cur->name);\n+            if (cur->nsDef)\n+                xmlNsListDumpOutput(buf, cur->nsDef);\n+            attr = cur->properties;\n+            while (attr != NULL) {\n+                htmlAttrDumpOutput(buf, doc, attr);\n+                attr = attr->next;\n+            }\n@@ -958,34 +794,155 @@\n-            xmlOutputBufferWriteString(buf, (const char *) cur->content);\n-    }\n-    if (cur->children != NULL) {\n-        if ((format) && (info != NULL) && (!info->isinline) &&\n-        (cur->children->type != HTML_TEXT_NODE) &&\n-        (cur->children->type != HTML_ENTITY_REF_NODE) &&\n-        (cur->children != cur->last) &&\n-        (cur->name != NULL) &&\n-        (cur->name[0] != 'p')) \/* p, pre, param *\/\n-        xmlOutputBufferWriteString(buf, \"\\n\");\n-    htmlNodeListDumpOutput(buf, doc, cur->children, encoding, format);\n-        if ((format) && (info != NULL) && (!info->isinline) &&\n-        (cur->last->type != HTML_TEXT_NODE) &&\n-        (cur->last->type != HTML_ENTITY_REF_NODE) &&\n-        (cur->children != cur->last) &&\n-        (cur->name != NULL) &&\n-        (cur->name[0] != 'p')) \/* p, pre, param *\/\n-        xmlOutputBufferWriteString(buf, \"\\n\");\n-    }\n-    xmlOutputBufferWriteString(buf, \"<\/\");\n-    if ((cur->ns != NULL) && (cur->ns->prefix != NULL)) {\n-        xmlOutputBufferWriteString(buf, (const char *)cur->ns->prefix);\n-    xmlOutputBufferWriteString(buf, \":\");\n-    }\n-    xmlOutputBufferWriteString(buf, (const char *)cur->name);\n-    xmlOutputBufferWriteString(buf, \">\");\n-    if ((format) && (info != NULL) && (!info->isinline) &&\n-    (cur->next != NULL)) {\n-        if ((cur->next->type != HTML_TEXT_NODE) &&\n-        (cur->next->type != HTML_ENTITY_REF_NODE) &&\n-        (cur->parent != NULL) &&\n-        (cur->parent->name != NULL) &&\n-        (cur->parent->name[0] != 'p')) \/* p, pre, param *\/\n-        xmlOutputBufferWriteString(buf, \"\\n\");\n+            if ((info != NULL) && (info->empty)) {\n+                xmlOutputBufferWriteString(buf, \">\");\n+            } else if (cur->children == NULL) {\n+                if ((info != NULL) && (info->saveEndTag != 0) &&\n+                    (xmlStrcmp(BAD_CAST info->name, BAD_CAST \"html\")) &&\n+                    (xmlStrcmp(BAD_CAST info->name, BAD_CAST \"body\"))) {\n+                    xmlOutputBufferWriteString(buf, \">\");\n+                } else {\n+                    xmlOutputBufferWriteString(buf, \"><\/\");\n+                    if ((cur->ns != NULL) && (cur->ns->prefix != NULL)) {\n+                        xmlOutputBufferWriteString(buf,\n+                                (const char *)cur->ns->prefix);\n+                        xmlOutputBufferWriteString(buf, \":\");\n+                    }\n+                    xmlOutputBufferWriteString(buf, (const char *)cur->name);\n+                    xmlOutputBufferWriteString(buf, \">\");\n+                }\n+            } else {\n+                xmlOutputBufferWriteString(buf, \">\");\n+                if ((format) && (info != NULL) && (!info->isinline) &&\n+                    (cur->children->type != HTML_TEXT_NODE) &&\n+                    (cur->children->type != HTML_ENTITY_REF_NODE) &&\n+                    (cur->children != cur->last) &&\n+                    (cur->name != NULL) &&\n+                    (cur->name[0] != 'p')) \/* p, pre, param *\/\n+                    xmlOutputBufferWriteString(buf, \"\\n\");\n+                cur = cur->children;\n+                continue;\n+            }\n+\n+            if ((format) && (cur->next != NULL) &&\n+                (info != NULL) && (!info->isinline)) {\n+                if ((cur->next->type != HTML_TEXT_NODE) &&\n+                    (cur->next->type != HTML_ENTITY_REF_NODE) &&\n+                    (cur->parent != NULL) &&\n+                    (cur->parent->name != NULL) &&\n+                    (cur->parent->name[0] != 'p')) \/* p, pre, param *\/\n+                    xmlOutputBufferWriteString(buf, \"\\n\");\n+            }\n+\n+            break;\n+\n+        case XML_ATTRIBUTE_NODE:\n+            htmlAttrDumpOutput(buf, doc, (xmlAttrPtr) cur);\n+            break;\n+\n+        case HTML_TEXT_NODE:\n+            if (cur->content == NULL)\n+                break;\n+            if (((cur->name == (const xmlChar *)xmlStringText) ||\n+                 (cur->name != (const xmlChar *)xmlStringTextNoenc)) &&\n+                ((cur->parent == NULL) ||\n+                 ((xmlStrcasecmp(cur->parent->name, BAD_CAST \"script\")) &&\n+                  (xmlStrcasecmp(cur->parent->name, BAD_CAST \"style\"))))) {\n+                xmlChar *buffer;\n+\n+                buffer = xmlEncodeEntitiesReentrant(doc, cur->content);\n+                if (buffer != NULL) {\n+                    xmlOutputBufferWriteString(buf, (const char *)buffer);\n+                    xmlFree(buffer);\n+                }\n+            } else {\n+                xmlOutputBufferWriteString(buf, (const char *)cur->content);\n+            }\n+            break;\n+\n+        case HTML_COMMENT_NODE:\n+            if (cur->content != NULL) {\n+                xmlOutputBufferWriteString(buf, \"<!--\");\n+                xmlOutputBufferWriteString(buf, (const char *)cur->content);\n+                xmlOutputBufferWriteString(buf, \"-->\");\n+            }\n+            break;\n+\n+        case HTML_PI_NODE:\n+            if (cur->name != NULL) {\n+                xmlOutputBufferWriteString(buf, \"<?\");\n+                xmlOutputBufferWriteString(buf, (const char *)cur->name);\n+                if (cur->content != NULL) {\n+                    xmlOutputBufferWriteString(buf, \" \");\n+                    xmlOutputBufferWriteString(buf,\n+                            (const char *)cur->content);\n+                }\n+                xmlOutputBufferWriteString(buf, \">\");\n+            }\n+            break;\n+\n+        case HTML_ENTITY_REF_NODE:\n+            xmlOutputBufferWriteString(buf, \"&\");\n+            xmlOutputBufferWriteString(buf, (const char *)cur->name);\n+            xmlOutputBufferWriteString(buf, \";\");\n+            break;\n+\n+        case HTML_PRESERVE_NODE:\n+            if (cur->content != NULL) {\n+                xmlOutputBufferWriteString(buf, (const char *)cur->content);\n+            }\n+            break;\n+\n+        default:\n+            break;\n+        }\n+\n+        while (1) {\n+            if (cur == root)\n+                return;\n+            if (cur->next != NULL) {\n+                cur = cur->next;\n+                break;\n+            }\n+\n+            \/*\n+             * The parent should never be NULL here but we want to handle\n+             * corrupted documents gracefully.\n+             *\/\n+            if (cur->parent == NULL)\n+                return;\n+            cur = cur->parent;\n+\n+            if ((cur->type == XML_HTML_DOCUMENT_NODE) ||\n+                (cur->type == XML_DOCUMENT_NODE)) {\n+                xmlOutputBufferWriteString(buf, \"\\n\");\n+            } else {\n+                if ((format) && (cur->ns == NULL))\n+                    info = htmlTagLookup(cur->name);\n+                else\n+                    info = NULL;\n+\n+                if ((format) && (info != NULL) && (!info->isinline) &&\n+                    (cur->last->type != HTML_TEXT_NODE) &&\n+                    (cur->last->type != HTML_ENTITY_REF_NODE) &&\n+                    (cur->children != cur->last) &&\n+                    (cur->name != NULL) &&\n+                    (cur->name[0] != 'p')) \/* p, pre, param *\/\n+                    xmlOutputBufferWriteString(buf, \"\\n\");\n+\n+                xmlOutputBufferWriteString(buf, \"<\/\");\n+                if ((cur->ns != NULL) && (cur->ns->prefix != NULL)) {\n+                    xmlOutputBufferWriteString(buf, (const char *)cur->ns->prefix);\n+                    xmlOutputBufferWriteString(buf, \":\");\n+                }\n+                xmlOutputBufferWriteString(buf, (const char *)cur->name);\n+                xmlOutputBufferWriteString(buf, \">\");\n+\n+                if ((format) && (info != NULL) && (!info->isinline) &&\n+                    (cur->next != NULL)) {\n+                    if ((cur->next->type != HTML_TEXT_NODE) &&\n+                        (cur->next->type != HTML_ENTITY_REF_NODE) &&\n+                        (cur->parent != NULL) &&\n+                        (cur->parent->name != NULL) &&\n+                        (cur->parent->name[0] != 'p')) \/* p, pre, param *\/\n+                        xmlOutputBufferWriteString(buf, \"\\n\");\n+                }\n+            }\n+        }\n@@ -1000,1 +957,1 @@\n- * @encoding:  the encoding string\n+ * @encoding:  the encoding string (unused)\n@@ -1007,2 +964,2 @@\n-               xmlNodePtr cur, const char *encoding) {\n-    htmlNodeDumpFormatOutput(buf, doc, cur, encoding, 1);\n+               xmlNodePtr cur, const char *encoding ATTRIBUTE_UNUSED) {\n+    htmlNodeDumpFormatOutput(buf, doc, cur, NULL, 1);\n@@ -1015,1 +972,1 @@\n- * @encoding:  the encoding string\n+ * @encoding:  the encoding string (unused)\n@@ -1022,21 +979,3 @@\n-                           const char *encoding, int format) {\n-    int type;\n-\n-    xmlInitParser();\n-\n-    if ((buf == NULL) || (cur == NULL))\n-        return;\n-\n-    \/*\n-     * force to output the stuff as HTML, especially for entities\n-     *\/\n-    type = cur->type;\n-    cur->type = XML_HTML_DOCUMENT_NODE;\n-    if (cur->intSubset != NULL) {\n-        htmlDtdDumpOutput(buf, cur, NULL);\n-    }\n-    if (cur->children != NULL) {\n-        htmlNodeListDumpOutput(buf, cur, cur->children, encoding, format);\n-    }\n-    xmlOutputBufferWriteString(buf, \"\\n\");\n-    cur->type = (xmlElementType) type;\n+                           const char *encoding ATTRIBUTE_UNUSED,\n+                               int format) {\n+    htmlNodeDumpFormatOutput(buf, cur, (xmlNodePtr) cur, NULL, format);\n@@ -1049,1 +988,1 @@\n- * @encoding:  the encoding string\n+ * @encoding:  the encoding string (unused)\n@@ -1055,2 +994,2 @@\n-                     const char *encoding) {\n-    htmlDocContentDumpFormatOutput(buf, cur, encoding, 1);\n+                     const char *encoding ATTRIBUTE_UNUSED) {\n+    htmlNodeDumpFormatOutput(buf, cur, (xmlNodePtr) cur, NULL, 1);\n","filename":"modules\/javafx.web\/src\/main\/native\/Source\/ThirdParty\/libxml\/src\/HTMLtree.c","additions":217,"deletions":278,"binary":false,"changes":495,"status":"modified"},{"patch":"@@ -5,1 +5,1 @@\n-SUBDIRS = include . doc example xstc $(PYTHON_SUBDIR)\n+SUBDIRS = include . doc example fuzz xstc $(PYTHON_SUBDIR)\n@@ -7,1 +7,1 @@\n-DIST_SUBDIRS = include . doc example python xstc\n+DIST_SUBDIRS = include . doc example fuzz python xstc\n@@ -16,1 +16,1 @@\n-\t       testdict runxmlconf testrecurse testlimits\n+           testdict runxmlconf testrecurse testlimits\n@@ -32,3 +32,3 @@\n-\t\t     $(LIBXML2_VERSION_SCRIPT) \\\n-\t\t     -version-info $(LIBXML_VERSION_INFO) \\\n-\t\t     $(MODULE_PLATFORM_LIBS)\n+             $(LIBXML2_VERSION_SCRIPT) \\\n+             -version-info $(LIBXML_VERSION_INFO) \\\n+             $(MODULE_PLATFORM_LIBS)\n@@ -49,10 +49,10 @@\n-\t\tparser.c tree.c hash.c list.c xmlIO.c xmlmemory.c uri.c  \\\n-\t\tvalid.c xlink.c HTMLparser.c HTMLtree.c debugXML.c xpath.c  \\\n-\t\txpointer.c xinclude.c nanohttp.c nanoftp.c \\\n-\t\t$(docb_sources) \\\n-\t\tcatalog.c globals.c threads.c c14n.c xmlstring.c buf.c \\\n-\t\txmlregexp.c xmlschemas.c xmlschemastypes.c xmlunicode.c \\\n-\t\t$(trio_sources) \\\n-\t\txmlreader.c relaxng.c dict.c SAX2.c \\\n-\t\txmlwriter.c legacy.c chvalid.c pattern.c xmlsave.c \\\n-\t\txmlmodule.c schematron.c xzlib.c\n+        parser.c tree.c hash.c list.c xmlIO.c xmlmemory.c uri.c  \\\n+        valid.c xlink.c HTMLparser.c HTMLtree.c debugXML.c xpath.c  \\\n+        xpointer.c xinclude.c nanohttp.c nanoftp.c \\\n+        $(docb_sources) \\\n+        catalog.c globals.c threads.c c14n.c xmlstring.c buf.c \\\n+        xmlregexp.c xmlschemas.c xmlschemastypes.c xmlunicode.c \\\n+        $(trio_sources) \\\n+        xmlreader.c relaxng.c dict.c SAX2.c \\\n+        xmlwriter.c legacy.c chvalid.c pattern.c xmlsave.c \\\n+        xmlmodule.c schematron.c xzlib.c\n@@ -70,1 +70,1 @@\n-runtest_LDFLAGS = \n+runtest_LDFLAGS =\n@@ -75,1 +75,1 @@\n-testrecurse_LDFLAGS = \n+testrecurse_LDFLAGS =\n@@ -80,1 +80,1 @@\n-testlimits_LDFLAGS = \n+testlimits_LDFLAGS =\n@@ -85,1 +85,1 @@\n-testchar_LDFLAGS = \n+testchar_LDFLAGS =\n@@ -90,1 +90,1 @@\n-testdict_LDFLAGS = \n+testdict_LDFLAGS =\n@@ -95,1 +95,1 @@\n-runsuite_LDFLAGS = \n+runsuite_LDFLAGS =\n@@ -100,1 +100,1 @@\n-xmllint_LDFLAGS = \n+xmllint_LDFLAGS =\n@@ -105,1 +105,1 @@\n-testSAX_LDFLAGS = \n+testSAX_LDFLAGS =\n@@ -110,1 +110,1 @@\n-testHTML_LDFLAGS = \n+testHTML_LDFLAGS =\n@@ -115,1 +115,1 @@\n-xmlcatalog_LDFLAGS = \n+xmlcatalog_LDFLAGS =\n@@ -120,1 +120,1 @@\n-testXPath_LDFLAGS = \n+testXPath_LDFLAGS =\n@@ -125,1 +125,1 @@\n-testC14N_LDFLAGS = \n+testC14N_LDFLAGS =\n@@ -130,1 +130,1 @@\n-testThreads_LDFLAGS = \n+testThreads_LDFLAGS =\n@@ -135,1 +135,1 @@\n-testURI_LDFLAGS = \n+testURI_LDFLAGS =\n@@ -140,1 +140,1 @@\n-testRegexp_LDFLAGS = \n+testRegexp_LDFLAGS =\n@@ -145,1 +145,1 @@\n-testAutomata_LDFLAGS = \n+testAutomata_LDFLAGS =\n@@ -150,1 +150,1 @@\n-testSchemas_LDFLAGS = \n+testSchemas_LDFLAGS =\n@@ -155,1 +155,1 @@\n-testRelax_LDFLAGS = \n+testRelax_LDFLAGS =\n@@ -160,1 +160,1 @@\n-testReader_LDFLAGS = \n+testReader_LDFLAGS =\n@@ -165,1 +165,1 @@\n-testModule_LDFLAGS = \n+testModule_LDFLAGS =\n@@ -175,2 +175,2 @@\n-\t-@(if [ \"$(PYTHON)\" != \"\" ] ; then \\\n-\t    $(PYTHON) $(srcdir)\/gentest.py $(srcdir) ; fi )\n+    -@(if [ \"$(PYTHON)\" != \"\" ] ; then \\\n+        $(PYTHON) $(srcdir)\/gentest.py $(srcdir) ; fi )\n@@ -181,2 +181,2 @@\n-\t-@(if [ \"$(PYTHON)\" != \"\" ] ; then \\\n-\t    $(PYTHON) $(srcdir)\/gentest.py $(srcdir) ; fi )\n+    -@(if [ \"$(PYTHON)\" != \"\" ] ; then \\\n+        $(PYTHON) $(srcdir)\/gentest.py $(srcdir) ; fi )\n@@ -187,1 +187,1 @@\n-testapi_LDFLAGS = \n+testapi_LDFLAGS =\n@@ -192,1 +192,1 @@\n-runxmlconf_LDFLAGS = \n+runxmlconf_LDFLAGS =\n@@ -197,1 +197,1 @@\n-#testOOM_LDFLAGS = \n+#testOOM_LDFLAGS =\n@@ -203,10 +203,11 @@\n-\t[ -d test   ] || $(LN_S) $(srcdir)\/test   .\n-\t[ -d result ] || $(LN_S) $(srcdir)\/result .\n-\t$(CHECKER) .\/runtest$(EXEEXT) && \\\n-\t    $(CHECKER) .\/testrecurse$(EXEEXT) && \\\n-\t    ASAN_OPTIONS=\"$$ASAN_OPTIONS:detect_leaks=0\" $(CHECKER) .\/testapi$(EXEEXT) && \\\n-\t    $(CHECKER) .\/testchar$(EXEEXT) && \\\n-\t    $(CHECKER) .\/testdict$(EXEEXT) && \\\n-\t    $(CHECKER) .\/runxmlconf$(EXEEXT)\n-\t@(if [ \"$(PYTHON_SUBDIR)\" != \"\" ] ; then cd python ; \\\n-\t    $(MAKE) tests ; fi)\n+    [ -d test   ] || $(LN_S) $(srcdir)\/test   .\n+    [ -d result ] || $(LN_S) $(srcdir)\/result .\n+    $(CHECKER) .\/runtest$(EXEEXT) && \\\n+        $(CHECKER) .\/testrecurse$(EXEEXT) && \\\n+        ASAN_OPTIONS=\"$$ASAN_OPTIONS:detect_leaks=0\" $(CHECKER) .\/testapi$(EXEEXT) && \\\n+        $(CHECKER) .\/testchar$(EXEEXT) && \\\n+        $(CHECKER) .\/testdict$(EXEEXT) && \\\n+        $(CHECKER) .\/runxmlconf$(EXEEXT)\n+    @(if [ \"$(PYTHON_SUBDIR)\" != \"\" ] ; then cd python ; \\\n+        $(MAKE) tests ; fi)\n+    @cd fuzz; $(MAKE) tests\n@@ -217,3 +218,3 @@\n-\t@echo '## Running the regression tests under Valgrind'\n-\t@echo '## Go get a cup of coffee it is gonna take a while ...'\n-\t$(MAKE) CHECKER='valgrind -q' runtests\n+    @echo '## Running the regression tests under Valgrind'\n+    @echo '## Go get a cup of coffee it is gonna take a while ...'\n+    $(MAKE) CHECKER='valgrind -q' runtests\n@@ -222,2 +223,2 @@\n-\t@echo '## rebuilding for ASAN'\n-\t.\/configure CFLAGS=\"-fsanitize=address,undefined -Wformat -Werror=format-security -Werror=array-bounds -g\" CXXFLAGS=\"-fsanitize=address,undefined -Wformat -Werror=format-security -Werror=array-bounds -g\" LDFLAGS=\"-fsanitize=address,undefined\" CC=\"clang\" CXX=\"clang++\" --disable-shared ; OptimOff  ; $(MAKE) clean ; $(MAKE)\n+    @echo '## rebuilding for ASAN'\n+    .\/configure CFLAGS=\"-fsanitize=address,undefined -Wformat -Werror=format-security -Werror=array-bounds -g\" CXXFLAGS=\"-fsanitize=address,undefined -Wformat -Werror=format-security -Werror=array-bounds -g\" LDFLAGS=\"-fsanitize=address,undefined\" CC=\"clang\" CXX=\"clang++\" --disable-shared ; OptimOff  ; $(MAKE) clean ; $(MAKE)\n@@ -228,3 +229,3 @@\n-\t@(if [ \"$(PYTHON_SUBDIR)\" != \"\" ] ; then cd python ; \\\n-\t    $(MAKE) -s tests ; fi)\n-\t@(cd doc\/examples ; $(MAKE) -s tests)\n+    @(if [ \"$(PYTHON_SUBDIR)\" != \"\" ] ; then cd python ; \\\n+        $(MAKE) -s tests ; fi)\n+    @(cd doc\/examples ; $(MAKE) -s tests)\n@@ -233,2 +234,2 @@\n-\t@echo \"## Running the API regression tests this may take a little while\"\n-\t-@(ASAN_OPTIONS=\"$$ASAN_OPTIONS:detect_leaks=0\" $(CHECKER) $(top_builddir)\/testapi -q)\n+    @echo \"## Running the API regression tests this may take a little while\"\n+    -@(ASAN_OPTIONS=\"$$ASAN_OPTIONS:detect_leaks=0\" $(CHECKER) $(top_builddir)\/testapi -q)\n@@ -237,18 +238,18 @@\n-\t@(echo > .memdump)\n-\t@echo \"## HTML regression tests\"\n-\t-@(for i in $(srcdir)\/test\/HTML\/* ; do \\\n-\t  name=`basename $$i`; \\\n-\t  if [ ! -d $$i ] ; then \\\n-\t  if [ ! -f $(srcdir)\/result\/HTML\/$$name ] ; then \\\n-\t      echo New test file $$name ; \\\n-\t      $(CHECKER) $(top_builddir)\/testHTML $$i > $(srcdir)\/result\/HTML\/$$name 2>$(srcdir)\/result\/HTML\/$$name.err ; \\\n-\t  else \\\n-\t      log=`$(CHECKER) $(top_builddir)\/testHTML $$i > result.$$name 2> error.$$name ; \\\n-\t      grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\";\\\n-\t      diff $(srcdir)\/result\/HTML\/$$name result.$$name ; \\\n-\t      diff -b $(srcdir)\/result\/HTML\/$$name.err error.$$name ; \\\n-\t      $(CHECKER) $(top_builddir)\/testHTML result.$$name > result2.$$name 2>error.$$name ; \\\n-\t      diff result.$$name result2.$$name` ; \\\n-\t      if [ -n \"$$log\" ] ; then echo $$name result ; echo \"$$log\" ; fi ; \\\n-\t      rm result.$$name result2.$$name error.$$name ; \\\n-\t  fi ; fi ; done)\n+    @(echo > .memdump)\n+    @echo \"## HTML regression tests\"\n+    -@(for i in $(srcdir)\/test\/HTML\/* ; do \\\n+      name=`basename $$i`; \\\n+      if [ ! -d $$i ] ; then \\\n+      if [ ! -f $(srcdir)\/result\/HTML\/$$name ] ; then \\\n+          echo New test file $$name ; \\\n+          $(CHECKER) $(top_builddir)\/testHTML $$i > $(srcdir)\/result\/HTML\/$$name 2>$(srcdir)\/result\/HTML\/$$name.err ; \\\n+      else \\\n+          log=`$(CHECKER) $(top_builddir)\/testHTML $$i > result.$$name 2> error.$$name ; \\\n+          grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\";\\\n+          diff $(srcdir)\/result\/HTML\/$$name result.$$name ; \\\n+          diff -b $(srcdir)\/result\/HTML\/$$name.err error.$$name ; \\\n+          $(CHECKER) $(top_builddir)\/testHTML result.$$name > result2.$$name 2>error.$$name ; \\\n+          diff result.$$name result2.$$name` ; \\\n+          if [ -n \"$$log\" ] ; then echo $$name result ; echo \"$$log\" ; fi ; \\\n+          rm result.$$name result2.$$name error.$$name ; \\\n+      fi ; fi ; done)\n@@ -257,47 +258,47 @@\n-\t@echo \"## Push HTML regression tests\"\n-\t-@(for i in $(srcdir)\/test\/HTML\/* ; do \\\n-\t  name=`basename $$i`; \\\n-\t  if [ ! -d $$i ] ; then \\\n-\t  if [ ! -f $(srcdir)\/result\/HTML\/$$name ] ; then \\\n-\t      echo New test file $$name ; \\\n-\t      $(CHECKER) $(top_builddir)\/testHTML --push $$i > $(srcdir)\/result\/HTML\/$$name 2>$(srcdir)\/result\/HTML\/$$name.err ; \\\n-\t  else \\\n-\t      log=`$(CHECKER) $(top_builddir)\/testHTML --push $$i > result.$$name 2> error.$$name ; \\\n-\t      grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\";\\\n-\t      diff $(srcdir)\/result\/HTML\/$$name result.$$name ; \\\n-\t      cut -b 1-15 $(srcdir)\/result\/HTML\/$$name.err > errorcut.$$name; \\\n-\t      cut -b 1-15 error.$$name > errorcut2.$$name; \\\n-\t      diff -b errorcut.$$name errorcut2.$$name ; \\\n-\t      $(CHECKER) $(top_builddir)\/testHTML --push result.$$name > result2.$$name 2>error.$$name ; \\\n-\t      diff result.$$name result2.$$name` ; \\\n-\t      if [ -n \"$$log\" ] ; then echo $$name result ; echo \"$$log\" ; fi ; \\\n-\t      rm result.$$name result2.$$name error.$$name errorcut.$$name errorcut2.$$name ; \\\n-\t  fi ; fi ; done)\n-\t@echo \"## HTML SAX regression tests\"\n-\t-@(for i in $(srcdir)\/test\/HTML\/* ; do \\\n-\t  name=`basename $$i`; \\\n-\t  if [ ! -d $$i ] ; then \\\n-\t  if [ ! -f $(srcdir)\/result\/HTML\/$$name.sax ] ; then \\\n-\t      echo New test file $$name ; \\\n-\t      $(CHECKER) $(top_builddir)\/testHTML --sax $$i > $(srcdir)\/result\/HTML\/$$name.sax ; \\\n-\t  else \\\n-\t      log=`$(CHECKER) $(top_builddir)\/testHTML --sax $$i > result.$$name.sax ; \\\n-\t      grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\";\\\n-\t      diff $(srcdir)\/result\/HTML\/$$name.sax result.$$name.sax` ; \\\n-\t      if [ -n \"$$log\" ] ; then echo $$name result ; echo \"$$log\" ; fi ; \\\n-\t      rm result.$$name.sax ; \\\n-\t  fi ; fi ; done)\n-\t@echo \"## Push HTML SAX regression tests\"\n-\t-@(for i in $(srcdir)\/test\/HTML\/* ; do \\\n-\t  name=`basename $$i`; \\\n-\t  if [ ! -d $$i ] ; then \\\n-\t  if [ ! -f $(srcdir)\/result\/HTML\/$$name ] ; then \\\n-\t      echo New test file $$name ; \\\n-\t      $(CHECKER) $(top_builddir)\/testHTML --push --sax $$i > $(srcdir)\/result\/HTML\/$$name.sax ; \\\n-\t  else \\\n-\t      log=`$(CHECKER) $(top_builddir)\/testHTML --push --sax $$i 2>&1 > result.$$name.sax ; \\\n-\t      grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\";\\\n-\t      diff $(srcdir)\/result\/HTML\/$$name.sax result.$$name.sax` ; \\\n-\t      if [ -n \"$$log\" ] ; then echo $$name result ; echo \"$$log\" ; fi ; \\\n-\t      rm result.$$name.sax ; \\\n-\t  fi ; fi ; done)\n+    @echo \"## Push HTML regression tests\"\n+    -@(for i in $(srcdir)\/test\/HTML\/* ; do \\\n+      name=`basename $$i`; \\\n+      if [ ! -d $$i ] ; then \\\n+      if [ ! -f $(srcdir)\/result\/HTML\/$$name ] ; then \\\n+          echo New test file $$name ; \\\n+          $(CHECKER) $(top_builddir)\/testHTML --push $$i > $(srcdir)\/result\/HTML\/$$name 2>$(srcdir)\/result\/HTML\/$$name.err ; \\\n+      else \\\n+          log=`$(CHECKER) $(top_builddir)\/testHTML --push $$i > result.$$name 2> error.$$name ; \\\n+          grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\";\\\n+          diff $(srcdir)\/result\/HTML\/$$name result.$$name ; \\\n+          cut -b 1-15 $(srcdir)\/result\/HTML\/$$name.err > errorcut.$$name; \\\n+          cut -b 1-15 error.$$name > errorcut2.$$name; \\\n+          diff -b errorcut.$$name errorcut2.$$name ; \\\n+          $(CHECKER) $(top_builddir)\/testHTML --push result.$$name > result2.$$name 2>error.$$name ; \\\n+          diff result.$$name result2.$$name` ; \\\n+          if [ -n \"$$log\" ] ; then echo $$name result ; echo \"$$log\" ; fi ; \\\n+          rm result.$$name result2.$$name error.$$name errorcut.$$name errorcut2.$$name ; \\\n+      fi ; fi ; done)\n+    @echo \"## HTML SAX regression tests\"\n+    -@(for i in $(srcdir)\/test\/HTML\/* ; do \\\n+      name=`basename $$i`; \\\n+      if [ ! -d $$i ] ; then \\\n+      if [ ! -f $(srcdir)\/result\/HTML\/$$name.sax ] ; then \\\n+          echo New test file $$name ; \\\n+          $(CHECKER) $(top_builddir)\/testHTML --sax $$i > $(srcdir)\/result\/HTML\/$$name.sax ; \\\n+      else \\\n+          log=`$(CHECKER) $(top_builddir)\/testHTML --sax $$i > result.$$name.sax ; \\\n+          grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\";\\\n+          diff $(srcdir)\/result\/HTML\/$$name.sax result.$$name.sax` ; \\\n+          if [ -n \"$$log\" ] ; then echo $$name result ; echo \"$$log\" ; fi ; \\\n+          rm result.$$name.sax ; \\\n+      fi ; fi ; done)\n+    @echo \"## Push HTML SAX regression tests\"\n+    -@(for i in $(srcdir)\/test\/HTML\/* ; do \\\n+      name=`basename $$i`; \\\n+      if [ ! -d $$i ] ; then \\\n+      if [ ! -f $(srcdir)\/result\/HTML\/$$name ] ; then \\\n+          echo New test file $$name ; \\\n+          $(CHECKER) $(top_builddir)\/testHTML --push --sax $$i > $(srcdir)\/result\/HTML\/$$name.sax ; \\\n+      else \\\n+          log=`$(CHECKER) $(top_builddir)\/testHTML --push --sax $$i 2>&1 > result.$$name.sax ; \\\n+          grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\";\\\n+          diff $(srcdir)\/result\/HTML\/$$name.sax result.$$name.sax` ; \\\n+          if [ -n \"$$log\" ] ; then echo $$name result ; echo \"$$log\" ; fi ; \\\n+          rm result.$$name.sax ; \\\n+      fi ; fi ; done)\n@@ -306,37 +307,37 @@\n-\t@(echo > .memdump)\n-\t@echo \"## XML regression tests\"\n-\t-@(for i in $(srcdir)\/test\/* ; do \\\n-\t  name=`basename $$i`; \\\n-\t  if [ ! -d $$i ] ; then \\\n-\t  if [ ! -f $(srcdir)\/result\/$$name ] ; then \\\n-\t      echo New test file $$name ; \\\n-\t      $(CHECKER) $(top_builddir)\/xmllint $$i > $(srcdir)\/result\/$$name ; \\\n-\t      grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\"; \\\n-\t  else \\\n-\t      log=`$(CHECKER) $(top_builddir)\/xmllint $$i 2>&1 > result.$$name ; \\\n-\t      grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\"; \\\n-\t      diff $(srcdir)\/result\/$$name result.$$name ; \\\n-\t      $(CHECKER) $(top_builddir)\/xmllint result.$$name 2>&1 > result2.$$name | grep -v 'failed to load external entity' ; \\\n-\t      grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\"; \\\n-\t      diff result.$$name result2.$$name` ;\\\n-\t      if [ -n \"$$log\" ] ; then echo $$name result ; echo \"$$log\" ; fi ; \\\n-\t      rm result.$$name result2.$$name ; \\\n-\t  fi ; fi ; done)\n-\t@echo \"## XML regression tests on memory\"\n-\t-@(for i in $(srcdir)\/test\/* ; do \\\n-\t  name=`basename $$i`; \\\n-\t  if [ ! -d $$i ] ; then \\\n-\t  if [ ! -f $(srcdir)\/result\/$$name ] ; then \\\n-\t      echo New test file $$name ; \\\n-\t      $(CHECKER) $(top_builddir)\/xmllint --memory $$i > $(srcdir)\/result\/$$name ; \\\n-\t      grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\"; \\\n-\t  else \\\n-\t      log=`$(CHECKER) $(top_builddir)\/xmllint --memory $$i 2>&1 > result.$$name ; \\\n-\t      grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\";\\\n-\t      diff $(srcdir)\/result\/$$name result.$$name ; \\\n-\t      $(CHECKER) $(top_builddir)\/xmllint --memory result.$$name 2>&1 > result2.$$name | grep -v 'failed to load external entity' ; \\\n-\t      grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\"`; \\\n-\t      if [ -n \"$$log\" ] ; then echo $$name result ; echo \"$$log\" ; fi ; \\\n-\t      diff result.$$name result2.$$name ; \\\n-\t      rm result.$$name result2.$$name ; \\\n-\t  fi ; fi ; done)\n+    @(echo > .memdump)\n+    @echo \"## XML regression tests\"\n+    -@(for i in $(srcdir)\/test\/* ; do \\\n+      name=`basename $$i`; \\\n+      if [ ! -d $$i ] ; then \\\n+      if [ ! -f $(srcdir)\/result\/$$name ] ; then \\\n+          echo New test file $$name ; \\\n+          $(CHECKER) $(top_builddir)\/xmllint $$i > $(srcdir)\/result\/$$name ; \\\n+          grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\"; \\\n+      else \\\n+          log=`$(CHECKER) $(top_builddir)\/xmllint $$i 2>&1 > result.$$name ; \\\n+          grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\"; \\\n+          diff $(srcdir)\/result\/$$name result.$$name ; \\\n+          $(CHECKER) $(top_builddir)\/xmllint result.$$name 2>&1 > result2.$$name | grep -v 'failed to load external entity' ; \\\n+          grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\"; \\\n+          diff result.$$name result2.$$name` ;\\\n+          if [ -n \"$$log\" ] ; then echo $$name result ; echo \"$$log\" ; fi ; \\\n+          rm result.$$name result2.$$name ; \\\n+      fi ; fi ; done)\n+    @echo \"## XML regression tests on memory\"\n+    -@(for i in $(srcdir)\/test\/* ; do \\\n+      name=`basename $$i`; \\\n+      if [ ! -d $$i ] ; then \\\n+      if [ ! -f $(srcdir)\/result\/$$name ] ; then \\\n+          echo New test file $$name ; \\\n+          $(CHECKER) $(top_builddir)\/xmllint --memory $$i > $(srcdir)\/result\/$$name ; \\\n+          grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\"; \\\n+      else \\\n+          log=`$(CHECKER) $(top_builddir)\/xmllint --memory $$i 2>&1 > result.$$name ; \\\n+          grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\";\\\n+          diff $(srcdir)\/result\/$$name result.$$name ; \\\n+          $(CHECKER) $(top_builddir)\/xmllint --memory result.$$name 2>&1 > result2.$$name | grep -v 'failed to load external entity' ; \\\n+          grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\"`; \\\n+          if [ -n \"$$log\" ] ; then echo $$name result ; echo \"$$log\" ; fi ; \\\n+          diff result.$$name result2.$$name ; \\\n+          rm result.$$name result2.$$name ; \\\n+      fi ; fi ; done)\n@@ -345,19 +346,19 @@\n-\t@(echo > .memdump)\n-\t@echo \"## XML push regression tests\"\n-\t-@(for i in $(srcdir)\/test\/* ; do \\\n-\t  name=`basename $$i`; \\\n-\t  if [ ! -d $$i ] ; then \\\n-\t  if [ ! -f $(srcdir)\/result\/$$name ] ; then \\\n-\t      echo New test file $$name ; \\\n-\t      $(CHECKER) $(top_builddir)\/xmllint --push $$i > $(srcdir)\/result\/$$name ; \\\n-\t      grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\"; \\\n-\t  else \\\n-\t      log=`$(CHECKER) $(top_builddir)\/xmllint --push $$i 2>&1 > result.$$name ; \\\n-\t      grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\"; \\\n-\t      diff $(srcdir)\/result\/$$name result.$$name ; \\\n-\t      $(CHECKER) $(top_builddir)\/xmllint --push result.$$name 2>&1 > result2.$$name | grep -v 'failed to load external entity' ; \\\n-\t      grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\"; \\\n-\t      diff result.$$name result2.$$name` ; \\\n-\t      if [ -n \"$$log\" ] ; then echo $$name result ; echo \"$$log\" ; fi ; \\\n-\t      rm result.$$name result2.$$name ; \\\n-\t  fi ; fi ; done)\n+    @(echo > .memdump)\n+    @echo \"## XML push regression tests\"\n+    -@(for i in $(srcdir)\/test\/* ; do \\\n+      name=`basename $$i`; \\\n+      if [ ! -d $$i ] ; then \\\n+      if [ ! -f $(srcdir)\/result\/$$name ] ; then \\\n+          echo New test file $$name ; \\\n+          $(CHECKER) $(top_builddir)\/xmllint --push $$i > $(srcdir)\/result\/$$name ; \\\n+          grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\"; \\\n+      else \\\n+          log=`$(CHECKER) $(top_builddir)\/xmllint --push $$i 2>&1 > result.$$name ; \\\n+          grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\"; \\\n+          diff $(srcdir)\/result\/$$name result.$$name ; \\\n+          $(CHECKER) $(top_builddir)\/xmllint --push result.$$name 2>&1 > result2.$$name | grep -v 'failed to load external entity' ; \\\n+          grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\"; \\\n+          diff result.$$name result2.$$name` ; \\\n+          if [ -n \"$$log\" ] ; then echo $$name result ; echo \"$$log\" ; fi ; \\\n+          rm result.$$name result2.$$name ; \\\n+      fi ; fi ; done)\n@@ -366,19 +367,19 @@\n-\t@(echo > .memdump)\n-\t@echo \"## XML Namespaces regression tests\"\n-\t-@(for i in $(srcdir)\/test\/namespaces\/* ; do \\\n-\t  name=`basename $$i`; \\\n-\t  if [ ! -d $$i ] ; then \\\n-\t  if [ ! -f $(srcdir)\/result\/namespaces\/$$name ] ; then \\\n-\t      echo New test file $$name ; \\\n-\t      $(CHECKER) $(top_builddir)\/xmllint $$i \\\n-\t         2> $(srcdir)\/result\/namespaces\/$$name.err \\\n-\t\t > $(srcdir)\/result\/namespaces\/$$name ; \\\n-\t      grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\"; \\\n-\t  else \\\n-\t      log=`$(CHECKER) $(top_builddir)\/xmllint $$i 2> error.$$name > result.$$name ; \\\n-\t      grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\"; \\\n-\t      diff $(srcdir)\/result\/namespaces\/$$name result.$$name ; \\\n-\t      diff $(srcdir)\/result\/namespaces\/$$name.err error.$$name`; \\\n-\t      if [ -n \"$$log\" ] ; then echo $$name result ; echo \"$$log\" ; fi ; \\\n-\t      rm result.$$name error.$$name ; \\\n-\t  fi ; fi ; done)\n+    @(echo > .memdump)\n+    @echo \"## XML Namespaces regression tests\"\n+    -@(for i in $(srcdir)\/test\/namespaces\/* ; do \\\n+      name=`basename $$i`; \\\n+      if [ ! -d $$i ] ; then \\\n+      if [ ! -f $(srcdir)\/result\/namespaces\/$$name ] ; then \\\n+          echo New test file $$name ; \\\n+          $(CHECKER) $(top_builddir)\/xmllint $$i \\\n+             2> $(srcdir)\/result\/namespaces\/$$name.err \\\n+         > $(srcdir)\/result\/namespaces\/$$name ; \\\n+          grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\"; \\\n+      else \\\n+          log=`$(CHECKER) $(top_builddir)\/xmllint $$i 2> error.$$name > result.$$name ; \\\n+          grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\"; \\\n+          diff $(srcdir)\/result\/namespaces\/$$name result.$$name ; \\\n+          diff $(srcdir)\/result\/namespaces\/$$name.err error.$$name`; \\\n+          if [ -n \"$$log\" ] ; then echo $$name result ; echo \"$$log\" ; fi ; \\\n+          rm result.$$name error.$$name ; \\\n+      fi ; fi ; done)\n@@ -387,19 +388,19 @@\n-\t@(echo > .memdump)\n-\t@echo \"## xml:id regression tests\"\n-\t-@(for i in $(srcdir)\/test\/xmlid\/id_*.xml ; do \\\n-\t  name=`basename $$i`; \\\n-\t  if [ ! -d $$i ] ; then \\\n-\t  if [ ! -f $(srcdir)\/result\/xmlid\/$$name ] ; then \\\n-\t      echo New test file $$name ; \\\n-\t      $(CHECKER) $(top_builddir)\/testXPath -i $$i \"id('bar')\" \\\n-\t         2> $(srcdir)\/result\/xmlid\/$$name.err \\\n-\t\t > $(srcdir)\/result\/xmlid\/$$name ; \\\n-\t      grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\"; \\\n-\t  else \\\n-\t      log=`$(CHECKER) $(top_builddir)\/testXPath -i $$i \"id('bar')\" 2> error.$$name > result.$$name ; \\\n-\t      grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\"; \\\n-\t      diff $(srcdir)\/result\/xmlid\/$$name result.$$name ; \\\n-\t      diff $(srcdir)\/result\/xmlid\/$$name.err error.$$name` ; \\\n-\t      if [ -n \"$$log\" ] ; then echo $$name result ; echo \"$$log\" ; fi ; \\\n-\t      rm result.$$name error.$$name ; \\\n-\t  fi ; fi ; done)\n+    @(echo > .memdump)\n+    @echo \"## xml:id regression tests\"\n+    -@(for i in $(srcdir)\/test\/xmlid\/id_*.xml ; do \\\n+      name=`basename $$i`; \\\n+      if [ ! -d $$i ] ; then \\\n+      if [ ! -f $(srcdir)\/result\/xmlid\/$$name ] ; then \\\n+          echo New test file $$name ; \\\n+          $(CHECKER) $(top_builddir)\/testXPath -i $$i \"id('bar')\" \\\n+             2> $(srcdir)\/result\/xmlid\/$$name.err \\\n+         > $(srcdir)\/result\/xmlid\/$$name ; \\\n+          grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\"; \\\n+      else \\\n+          log=`$(CHECKER) $(top_builddir)\/testXPath -i $$i \"id('bar')\" 2> error.$$name > result.$$name ; \\\n+          grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\"; \\\n+          diff $(srcdir)\/result\/xmlid\/$$name result.$$name ; \\\n+          diff $(srcdir)\/result\/xmlid\/$$name.err error.$$name` ; \\\n+          if [ -n \"$$log\" ] ; then echo $$name result ; echo \"$$log\" ; fi ; \\\n+          rm result.$$name error.$$name ; \\\n+      fi ; fi ; done)\n@@ -408,54 +409,54 @@\n-\t@(echo > .memdump)\n-\t@echo \"## Error cases regression tests\"\n-\t-@(for i in $(srcdir)\/test\/errors\/*.xml ; do \\\n-\t  name=`basename $$i`; \\\n-\t  if [ ! -d $$i ] ; then \\\n-\t  if [ ! -f $(srcdir)\/result\/errors\/$$name ] ; then \\\n-\t      echo New test file $$name ; \\\n-\t      $(CHECKER) $(top_builddir)\/xmllint $$i \\\n-\t         2> $(srcdir)\/result\/errors\/$$name.err \\\n-\t\t > $(srcdir)\/result\/errors\/$$name ; \\\n-\t      grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\"; \\\n-\t  else \\\n-\t      log=`$(CHECKER) $(top_builddir)\/xmllint $$i 2> error.$$name > result.$$name ; \\\n-\t      grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\"; \\\n-\t      diff $(srcdir)\/result\/errors\/$$name result.$$name ; \\\n-\t      diff $(srcdir)\/result\/errors\/$$name.err error.$$name` ; \\\n-\t      if [ -n \"$$log\" ] ; then echo $$name result ; echo \"$$log\" ; fi ; \\\n-\t      rm result.$$name error.$$name ; \\\n-\t  fi ; fi ; done)\n-\t@echo \"## Error cases regression tests (old 1.0)\"\n-\t-@(for i in $(srcdir)\/test\/errors10\/*.xml ; do \\\n-\t  name=`basename $$i`; \\\n-\t  if [ ! -d $$i ] ; then \\\n-\t  if [ ! -f $(srcdir)\/result\/errors10\/$$name ] ; then \\\n-\t      echo New test file $$name ; \\\n-\t      $(CHECKER) $(top_builddir)\/xmllint --oldxml10 $$i \\\n-\t         2> $(srcdir)\/result\/errors10\/$$name.err \\\n-\t\t > $(srcdir)\/result\/errors10\/$$name ; \\\n-\t      grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\"; \\\n-\t  else \\\n-\t      log=`$(CHECKER) $(top_builddir)\/xmllint --oldxml10 $$i 2> error.$$name > result.$$name ; \\\n-\t      grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\"; \\\n-\t      diff $(srcdir)\/result\/errors10\/$$name result.$$name ; \\\n-\t      diff $(srcdir)\/result\/errors10\/$$name.err error.$$name` ; \\\n-\t      if [ -n \"$$log\" ] ; then echo $$name result ; echo \"$$log\" ; fi ; \\\n-\t      rm result.$$name error.$$name ; \\\n-\t  fi ; fi ; done)\n-\t@echo \"## Error cases stream regression tests\"\n-\t-@(for i in $(srcdir)\/test\/errors\/*.xml ; do \\\n-\t  name=`basename $$i`; \\\n-\t  if [ ! -d $$i ] ; then \\\n-\t  if [ ! -f $(srcdir)\/result\/errors\/$$name.str ] ; then \\\n-\t      echo New test file $$name ; \\\n-\t      $(CHECKER) $(top_builddir)\/xmllint --stream $$i \\\n-\t         2> $(srcdir)\/result\/errors\/$$name.str \\\n-\t\t > \/dev\/null ; \\\n-\t      grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\"; \\\n-\t  else \\\n-\t      log=`$(CHECKER) $(top_builddir)\/xmllint --stream $$i 2> error.$$name > \/dev\/null ; \\\n-\t      grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\"; \\\n-\t      diff $(srcdir)\/result\/errors\/$$name.str error.$$name` ; \\\n-\t      if [ -n \"$$log\" ] ; then echo $$name result ; echo \"$$log\" ; fi ; \\\n-\t      rm error.$$name ; \\\n-\t  fi ; fi ; done)\n+    @(echo > .memdump)\n+    @echo \"## Error cases regression tests\"\n+    -@(for i in $(srcdir)\/test\/errors\/*.xml ; do \\\n+      name=`basename $$i`; \\\n+      if [ ! -d $$i ] ; then \\\n+      if [ ! -f $(srcdir)\/result\/errors\/$$name ] ; then \\\n+          echo New test file $$name ; \\\n+          $(CHECKER) $(top_builddir)\/xmllint $$i \\\n+             2> $(srcdir)\/result\/errors\/$$name.err \\\n+         > $(srcdir)\/result\/errors\/$$name ; \\\n+          grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\"; \\\n+      else \\\n+          log=`$(CHECKER) $(top_builddir)\/xmllint $$i 2> error.$$name > result.$$name ; \\\n+          grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\"; \\\n+          diff $(srcdir)\/result\/errors\/$$name result.$$name ; \\\n+          diff $(srcdir)\/result\/errors\/$$name.err error.$$name` ; \\\n+          if [ -n \"$$log\" ] ; then echo $$name result ; echo \"$$log\" ; fi ; \\\n+          rm result.$$name error.$$name ; \\\n+      fi ; fi ; done)\n+    @echo \"## Error cases regression tests (old 1.0)\"\n+    -@(for i in $(srcdir)\/test\/errors10\/*.xml ; do \\\n+      name=`basename $$i`; \\\n+      if [ ! -d $$i ] ; then \\\n+      if [ ! -f $(srcdir)\/result\/errors10\/$$name ] ; then \\\n+          echo New test file $$name ; \\\n+          $(CHECKER) $(top_builddir)\/xmllint --oldxml10 $$i \\\n+             2> $(srcdir)\/result\/errors10\/$$name.err \\\n+         > $(srcdir)\/result\/errors10\/$$name ; \\\n+          grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\"; \\\n+      else \\\n+          log=`$(CHECKER) $(top_builddir)\/xmllint --oldxml10 $$i 2> error.$$name > result.$$name ; \\\n+          grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\"; \\\n+          diff $(srcdir)\/result\/errors10\/$$name result.$$name ; \\\n+          diff $(srcdir)\/result\/errors10\/$$name.err error.$$name` ; \\\n+          if [ -n \"$$log\" ] ; then echo $$name result ; echo \"$$log\" ; fi ; \\\n+          rm result.$$name error.$$name ; \\\n+      fi ; fi ; done)\n+    @echo \"## Error cases stream regression tests\"\n+    -@(for i in $(srcdir)\/test\/errors\/*.xml ; do \\\n+      name=`basename $$i`; \\\n+      if [ ! -d $$i ] ; then \\\n+      if [ ! -f $(srcdir)\/result\/errors\/$$name.str ] ; then \\\n+          echo New test file $$name ; \\\n+          $(CHECKER) $(top_builddir)\/xmllint --stream $$i \\\n+             2> $(srcdir)\/result\/errors\/$$name.str \\\n+         > \/dev\/null ; \\\n+          grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\"; \\\n+      else \\\n+          log=`$(CHECKER) $(top_builddir)\/xmllint --stream $$i 2> error.$$name > \/dev\/null ; \\\n+          grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\"; \\\n+          diff $(srcdir)\/result\/errors\/$$name.str error.$$name` ; \\\n+          if [ -n \"$$log\" ] ; then echo $$name result ; echo \"$$log\" ; fi ; \\\n+          rm error.$$name ; \\\n+      fi ; fi ; done)\n@@ -466,19 +467,19 @@\n-\t@(echo > .memdump)\n-\t@echo \"## XML entity subst regression tests\"\n-\t-@(for i in $(srcdir)\/test\/* ; do \\\n-\t  name=`basename $$i`; \\\n-\t  if [ ! -d $$i ] ; then \\\n-\t  if [ ! -f $(srcdir)\/result\/noent\/$$name ] ; then \\\n-\t      echo New test file $$name ; \\\n-\t      $(CHECKER) $(top_builddir)\/xmllint --noent $$i > $(srcdir)\/result\/noent\/$$name ; \\\n-\t      grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\"; \\\n-\t  else \\\n-\t      log=`$(CHECKER) $(top_builddir)\/xmllint --noent $$i 2>&1 > result.$$name ; \\\n-\t      grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\"; \\\n-\t      diff $(srcdir)\/result\/noent\/$$name result.$$name ; \\\n-\t      $(CHECKER) $(top_builddir)\/xmllint --noent result.$$name 2>&1 > result2.$$name ; \\\n-\t      grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\"; \\\n-\t      diff result.$$name result2.$$name` ; \\\n-\t      if [ -n \"$$log\" ] ; then echo $$name result ; echo \"$$log\" ; fi ; \\\n-\t      rm result.$$name result2.$$name ; \\\n-\t  fi ; fi ; done)\n+    @(echo > .memdump)\n+    @echo \"## XML entity subst regression tests\"\n+    -@(for i in $(srcdir)\/test\/* ; do \\\n+      name=`basename $$i`; \\\n+      if [ ! -d $$i ] ; then \\\n+      if [ ! -f $(srcdir)\/result\/noent\/$$name ] ; then \\\n+          echo New test file $$name ; \\\n+          $(CHECKER) $(top_builddir)\/xmllint --noent $$i > $(srcdir)\/result\/noent\/$$name ; \\\n+          grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\"; \\\n+      else \\\n+          log=`$(CHECKER) $(top_builddir)\/xmllint --noent $$i 2>&1 > result.$$name ; \\\n+          grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\"; \\\n+          diff $(srcdir)\/result\/noent\/$$name result.$$name ; \\\n+          $(CHECKER) $(top_builddir)\/xmllint --noent result.$$name 2>&1 > result2.$$name ; \\\n+          grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\"; \\\n+          diff result.$$name result2.$$name` ; \\\n+          if [ -n \"$$log\" ] ; then echo $$name result ; echo \"$$log\" ; fi ; \\\n+          rm result.$$name result2.$$name ; \\\n+      fi ; fi ; done)\n@@ -487,30 +488,30 @@\n-\t@(echo > .memdump)\n-\t@echo \"## URI module regression tests\"\n-\t-@(for i in $(srcdir)\/test\/URI\/*.data ; do \\\n-\t  name=`basename $$i`; \\\n-\t  if [ ! -d $$i ] ; then \\\n-\t  if [ ! -f $(srcdir)\/result\/URI\/$$name ] ; then \\\n-\t      echo New test file $$name ; \\\n-\t      $(CHECKER) $(top_builddir)\/testURI -base 'http:\/\/foo.com\/path\/to\/index.html?orig#help' < $$i > $(srcdir)\/result\/URI\/$$name ; \\\n-\t      grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\"; \\\n-\t  else \\\n-\t      log=`$(CHECKER) $(top_builddir)\/testURI -base 'http:\/\/foo.com\/path\/to\/index.html?orig#help' < $$i 2>&1 > result.$$name ; \\\n-\t      grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\";\\\n-\t      diff $(srcdir)\/result\/URI\/$$name result.$$name` ; \\\n-\t      if [ -n \"$$log\" ] ; then echo $$name result ; echo \"$$log\" ; fi ; \\\n-\t      rm result.$$name ; \\\n-\t  fi ; fi ; done)\n-\t-@(for i in $(srcdir)\/test\/URI\/*.uri ; do \\\n-\t  name=`basename $$i`; \\\n-\t  if [ ! -d $$i ] ; then \\\n-\t  if [ ! -f $(srcdir)\/result\/URI\/$$name ] ; then \\\n-\t      echo New test file $$name ; \\\n-\t      $(CHECKER) $(top_builddir)\/testURI < $$i > $(srcdir)\/result\/URI\/$$name ; \\\n-\t      grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\"; \\\n-\t  else \\\n-\t      log=`$(CHECKER) $(top_builddir)\/testURI < $$i 2>&1 > result.$$name ; \\\n-\t      grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\";\\\n-\t      diff $(srcdir)\/result\/URI\/$$name result.$$name` ; \\\n-\t      if [ -n \"$$log\" ] ; then echo $$name result ; echo \"$$log\" ; fi ; \\\n-\t      rm result.$$name ; \\\n-\t  fi ; fi ; done)\n+    @(echo > .memdump)\n+    @echo \"## URI module regression tests\"\n+    -@(for i in $(srcdir)\/test\/URI\/*.data ; do \\\n+      name=`basename $$i`; \\\n+      if [ ! -d $$i ] ; then \\\n+      if [ ! -f $(srcdir)\/result\/URI\/$$name ] ; then \\\n+          echo New test file $$name ; \\\n+          $(CHECKER) $(top_builddir)\/testURI -base 'http:\/\/foo.com\/path\/to\/index.html?orig#help' < $$i > $(srcdir)\/result\/URI\/$$name ; \\\n+          grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\"; \\\n+      else \\\n+          log=`$(CHECKER) $(top_builddir)\/testURI -base 'http:\/\/foo.com\/path\/to\/index.html?orig#help' < $$i 2>&1 > result.$$name ; \\\n+          grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\";\\\n+          diff $(srcdir)\/result\/URI\/$$name result.$$name` ; \\\n+          if [ -n \"$$log\" ] ; then echo $$name result ; echo \"$$log\" ; fi ; \\\n+          rm result.$$name ; \\\n+      fi ; fi ; done)\n+    -@(for i in $(srcdir)\/test\/URI\/*.uri ; do \\\n+      name=`basename $$i`; \\\n+      if [ ! -d $$i ] ; then \\\n+      if [ ! -f $(srcdir)\/result\/URI\/$$name ] ; then \\\n+          echo New test file $$name ; \\\n+          $(CHECKER) $(top_builddir)\/testURI < $$i > $(srcdir)\/result\/URI\/$$name ; \\\n+          grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\"; \\\n+      else \\\n+          log=`$(CHECKER) $(top_builddir)\/testURI < $$i 2>&1 > result.$$name ; \\\n+          grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\";\\\n+          diff $(srcdir)\/result\/URI\/$$name result.$$name` ; \\\n+          if [ -n \"$$log\" ] ; then echo $$name result ; echo \"$$log\" ; fi ; \\\n+          rm result.$$name ; \\\n+      fi ; fi ; done)\n@@ -519,36 +520,36 @@\n-\t@(echo > .memdump)\n-\t@echo \"## XPath regression tests\"\n-\t-@(if [ \"`$(top_builddir)\/testXPath | grep 'support not compiled in'`\" != \"\" ] ; \\\n-\t  then echo Skipping debug not compiled in ; exit 0 ; fi ; \\\n-\t  for i in $(srcdir)\/test\/XPath\/expr\/* ; do \\\n-\t  name=`basename $$i`; \\\n-\t  if [ ! -d $$i ] ; then \\\n-\t  if [ ! -f $(srcdir)\/result\/XPath\/expr\/$$name ] ; then \\\n-\t      echo New test file $$name ; \\\n-\t      $(CHECKER) $(top_builddir)\/testXPath -f --expr $$i > $(srcdir)\/result\/XPath\/expr\/$$name 2> \/dev\/null ; \\\n-\t      grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\";\\\n-\t  else \\\n-\t      log=`$(CHECKER) $(top_builddir)\/testXPath -f --expr $$i > result.$$name 2> \/dev\/null ; \\\n-\t      grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\";\\\n-\t      diff $(srcdir)\/result\/XPath\/expr\/$$name result.$$name` ; \\\n-\t      if [ -n \"$$log\" ] ; then echo $$name result ; echo \"$$log\" ; fi ; \\\n-\t      rm result.$$name ; \\\n-\t  fi ; fi ; done ; \\\n-\t  for i in $(srcdir)\/test\/XPath\/docs\/* ; do \\\n-\t  if [ ! -d $$i ] ; then \\\n-\t  doc=`basename $$i`; \\\n-\t  for j in $(srcdir)\/test\/XPath\/tests\/$$doc* ; do \\\n-\t  if [ ! -f $$j ] ; then continue ; fi ; \\\n-\t  name=`basename $$j`; \\\n-\t  if [ ! -d $$j ] ; then \\\n-\t  if [ ! -f $(srcdir)\/result\/XPath\/tests\/$$name ] ; then \\\n-\t      echo New test file $$name ; \\\n-\t      $(CHECKER) $(top_builddir)\/testXPath -f -i $$i $$j > $(srcdir)\/result\/XPath\/tests\/$$name ; \\\n-\t      grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\";\\\n-\t  else \\\n-\t      log=`$(CHECKER) $(top_builddir)\/testXPath -f -i $$i $$j > result.$$name ; \\\n-\t      grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\";\\\n-\t      diff $(srcdir)\/result\/XPath\/tests\/$$name result.$$name` ; \\\n-\t      if [ -n \"$$log\" ] ; then echo $$name result ; echo \"$$log\" ; fi ; \\\n-\t      rm result.$$name ; \\\n-\t  fi ; fi ; done ; fi ; done)\n+    @(echo > .memdump)\n+    @echo \"## XPath regression tests\"\n+    -@(if [ \"`$(top_builddir)\/testXPath | grep 'support not compiled in'`\" != \"\" ] ; \\\n+      then echo Skipping debug not compiled in ; exit 0 ; fi ; \\\n+      for i in $(srcdir)\/test\/XPath\/expr\/* ; do \\\n+      name=`basename $$i`; \\\n+      if [ ! -d $$i ] ; then \\\n+      if [ ! -f $(srcdir)\/result\/XPath\/expr\/$$name ] ; then \\\n+          echo New test file $$name ; \\\n+          $(CHECKER) $(top_builddir)\/testXPath -f --expr $$i > $(srcdir)\/result\/XPath\/expr\/$$name 2> \/dev\/null ; \\\n+          grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\";\\\n+      else \\\n+          log=`$(CHECKER) $(top_builddir)\/testXPath -f --expr $$i > result.$$name 2> \/dev\/null ; \\\n+          grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\";\\\n+          diff $(srcdir)\/result\/XPath\/expr\/$$name result.$$name` ; \\\n+          if [ -n \"$$log\" ] ; then echo $$name result ; echo \"$$log\" ; fi ; \\\n+          rm result.$$name ; \\\n+      fi ; fi ; done ; \\\n+      for i in $(srcdir)\/test\/XPath\/docs\/* ; do \\\n+      if [ ! -d $$i ] ; then \\\n+      doc=`basename $$i`; \\\n+      for j in $(srcdir)\/test\/XPath\/tests\/$$doc* ; do \\\n+      if [ ! -f $$j ] ; then continue ; fi ; \\\n+      name=`basename $$j`; \\\n+      if [ ! -d $$j ] ; then \\\n+      if [ ! -f $(srcdir)\/result\/XPath\/tests\/$$name ] ; then \\\n+          echo New test file $$name ; \\\n+          $(CHECKER) $(top_builddir)\/testXPath -f -i $$i $$j > $(srcdir)\/result\/XPath\/tests\/$$name ; \\\n+          grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\";\\\n+      else \\\n+          log=`$(CHECKER) $(top_builddir)\/testXPath -f -i $$i $$j > result.$$name ; \\\n+          grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\";\\\n+          diff $(srcdir)\/result\/XPath\/tests\/$$name result.$$name` ; \\\n+          if [ -n \"$$log\" ] ; then echo $$name result ; echo \"$$log\" ; fi ; \\\n+          rm result.$$name ; \\\n+      fi ; fi ; done ; fi ; done)\n@@ -557,22 +558,22 @@\n-\t@(echo > .memdump)\n-\t@echo \"## XPointer regression tests\"\n-\t-@(if [ \"`$(top_builddir)\/testXPath | grep 'support not compiled in'`\" != \"\" ] ; \\\n-\t  then echo Skipping debug not compiled in ; exit 0 ; fi ; \\\n-\t  for i in $(srcdir)\/test\/XPath\/docs\/* ; do \\\n-\t  if [ ! -d $$i ] ; then \\\n-\t  doc=`basename $$i`; \\\n-\t  for j in $(srcdir)\/test\/XPath\/xptr\/$$doc* ; do \\\n-\t  if [ ! -f $$j ] ; then continue ; fi ; \\\n-\t  name=`basename $$j`; \\\n-\t  if [ ! -d $$j ] ; then \\\n-\t  if [ ! -f $(srcdir)\/result\/XPath\/xptr\/$$name ] ; then \\\n-\t      echo New test file $$name ; \\\n-\t      $(CHECKER) $(top_builddir)\/testXPath -xptr -f -i $$i $$j > $(srcdir)\/result\/XPath\/xptr\/$$name 2> \/dev\/null ; \\\n-\t      grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\"; \\\n-\t  else \\\n-\t      log=`$(CHECKER) $(top_builddir)\/testXPath -xptr -f -i $$i $$j > result.$$name 2> \/dev\/null ; \\\n-\t      grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\";\\\n-\t      diff $(srcdir)\/result\/XPath\/xptr\/$$name result.$$name` ; \\\n-\t      if [ -n \"$$log\" ] ; then echo $$name result ; echo \"$$log\" ; fi ; \\\n-\t      rm result.$$name ; \\\n-\t  fi ; fi ; done ; fi ; done)\n+    @(echo > .memdump)\n+    @echo \"## XPointer regression tests\"\n+    -@(if [ \"`$(top_builddir)\/testXPath | grep 'support not compiled in'`\" != \"\" ] ; \\\n+      then echo Skipping debug not compiled in ; exit 0 ; fi ; \\\n+      for i in $(srcdir)\/test\/XPath\/docs\/* ; do \\\n+      if [ ! -d $$i ] ; then \\\n+      doc=`basename $$i`; \\\n+      for j in $(srcdir)\/test\/XPath\/xptr\/$$doc* ; do \\\n+      if [ ! -f $$j ] ; then continue ; fi ; \\\n+      name=`basename $$j`; \\\n+      if [ ! -d $$j ] ; then \\\n+      if [ ! -f $(srcdir)\/result\/XPath\/xptr\/$$name ] ; then \\\n+          echo New test file $$name ; \\\n+          $(CHECKER) $(top_builddir)\/testXPath -xptr -f -i $$i $$j > $(srcdir)\/result\/XPath\/xptr\/$$name 2> \/dev\/null ; \\\n+          grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\"; \\\n+      else \\\n+          log=`$(CHECKER) $(top_builddir)\/testXPath -xptr -f -i $$i $$j > result.$$name 2> \/dev\/null ; \\\n+          grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\";\\\n+          diff $(srcdir)\/result\/XPath\/xptr\/$$name result.$$name` ; \\\n+          if [ -n \"$$log\" ] ; then echo $$name result ; echo \"$$log\" ; fi ; \\\n+          rm result.$$name ; \\\n+      fi ; fi ; done ; fi ; done)\n@@ -581,64 +582,64 @@\n-\t@(echo > .memdump)\n-\t@echo \"## XInclude regression tests\"\n-\t-@(for i in $(srcdir)\/test\/XInclude\/docs\/* ; do \\\n-\t  name=`basename $$i`; \\\n-\t  if [ ! -d $$i ] ; then \\\n-\t  if [ ! -f $(srcdir)\/result\/XInclude\/$$name ] ; then \\\n-\t      echo New test file $$name ; \\\n-\t      $(CHECKER) $(top_builddir)\/xmllint --nowarning --xinclude $$i > $(srcdir)\/result\/XInclude\/$$name 2> $(srcdir)\/result\/XInclude\/$$name.err ; \\\n-\t      grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\";\\\n-\t  else \\\n-\t      log=`$(CHECKER) $(top_builddir)\/xmllint --nowarning --xinclude $$i > result.$$name 2>error.$$name ; \\\n-\t      grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\";\\\n-\t      diff $(srcdir)\/result\/XInclude\/$$name result.$$name ; \\\n-\t      diff $(srcdir)\/result\/XInclude\/$$name.err error.$$name` ; \\\n-\t      if [ -n \"$$log\" ] ; then echo $$name result ; echo \"$$log\" ; fi ; \\\n-\t      rm result.$$name error.$$name ; \\\n-\t  fi ; fi ; done)\n-\t-@(for i in $(srcdir)\/test\/XInclude\/docs\/* ; do \\\n-\t  name=`basename $$i`; \\\n-\t  if [ ! -d $$i ] ; then \\\n-\t  if [ ! -f $(srcdir)\/result\/XInclude\/$$name ] ; then \\\n-\t      echo New test file $$name ; \\\n-\t      $(CHECKER) $(top_builddir)\/xmllint --nowarning --noxincludenode $$i > $(srcdir)\/result\/XInclude\/$$name 2> $(srcdir)\/result\/XInclude\/$$name.err ; \\\n-\t      grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\";\\\n-\t  else \\\n-\t      log=`$(CHECKER) $(top_builddir)\/xmllint --nowarning --noxincludenode $$i > result.$$name 2>error.$$name ; \\\n-\t      grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\";\\\n-\t      diff $(srcdir)\/result\/XInclude\/$$name result.$$name ; \\\n-\t      diff $(srcdir)\/result\/XInclude\/$$name.err error.$$name` ; \\\n-\t      if [ -n \"$$log\" ] ; then echo $$name result ; echo \"$$log\" ; fi ; \\\n-\t      rm result.$$name error.$$name ; \\\n-\t  fi ; fi ; done)\n-\t@(echo > .memdump)\n-\t@echo \"## XInclude xmlReader regression tests\"\n-\t-@(for i in $(srcdir)\/test\/XInclude\/docs\/* ; do \\\n-\t  name=`basename $$i`; \\\n-\t  if [ ! -d $$i ] ; then \\\n-\t  if [ ! -f $(srcdir)\/result\/XInclude\/$$name.rdr ] ; then \\\n-\t      echo New test file $$name ; \\\n-\t      $(CHECKER) $(top_builddir)\/xmllint --nowarning --xinclude --stream --debug $$i > $(srcdir)\/result\/XInclude\/$$name.rdr ; \\\n-\t      grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\";\\\n-\t  else \\\n-\t      log=`$(CHECKER) $(top_builddir)\/xmllint --nowarning --xinclude --stream --debug $$i > result.$$name 2>error.$$name ; \\\n-\t      grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\";\\\n-\t      diff $(srcdir)\/result\/XInclude\/$$name.err error.$$name ; \\\n-\t      diff $(srcdir)\/result\/XInclude\/$$name.rdr result.$$name` ; \\\n-\t      if [ -n \"$$log\" ] ; then echo $$name result ; echo \"$$log\" ; fi ; \\\n-\t      rm result.$$name error.$$name ; \\\n-\t  fi ; fi ; done)\n-\t-@(for i in $(srcdir)\/test\/XInclude\/docs\/* ; do \\\n-\t  name=`basename $$i`; \\\n-\t  if [ ! -d $$i ] ; then \\\n-\t  if [ ! -f $(srcdir)\/result\/XInclude\/$$name.rdr ] ; then \\\n-\t      echo New test file $$name ; \\\n-\t      $(CHECKER) $(top_builddir)\/xmllint --nowarning --noxincludenode --stream --debug $$i > $(srcdir)\/result\/XInclude\/$$name.rdr ; \\\n-\t      grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\";\\\n-\t  else \\\n-\t      log=`$(CHECKER) $(top_builddir)\/xmllint --nowarning --xinclude --stream --debug $$i > result.$$name 2>error.$$name ; \\\n-\t      grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\";\\\n-\t      diff $(srcdir)\/result\/XInclude\/$$name.err error.$$name ; \\\n-\t      diff $(srcdir)\/result\/XInclude\/$$name.rdr result.$$name` ; \\\n-\t      if [ -n \"$$log\" ] ; then echo $$name result ; echo \"$$log\" ; fi ; \\\n-\t      rm result.$$name error.$$name ; \\\n-\t  fi ; fi ; done)\n+    @(echo > .memdump)\n+    @echo \"## XInclude regression tests\"\n+    -@(for i in $(srcdir)\/test\/XInclude\/docs\/* ; do \\\n+      name=`basename $$i`; \\\n+      if [ ! -d $$i ] ; then \\\n+      if [ ! -f $(srcdir)\/result\/XInclude\/$$name ] ; then \\\n+          echo New test file $$name ; \\\n+          $(CHECKER) $(top_builddir)\/xmllint --nowarning --xinclude $$i > $(srcdir)\/result\/XInclude\/$$name 2> $(srcdir)\/result\/XInclude\/$$name.err ; \\\n+          grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\";\\\n+      else \\\n+          log=`$(CHECKER) $(top_builddir)\/xmllint --nowarning --xinclude $$i > result.$$name 2>error.$$name ; \\\n+          grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\";\\\n+          diff $(srcdir)\/result\/XInclude\/$$name result.$$name ; \\\n+          diff $(srcdir)\/result\/XInclude\/$$name.err error.$$name` ; \\\n+          if [ -n \"$$log\" ] ; then echo $$name result ; echo \"$$log\" ; fi ; \\\n+          rm result.$$name error.$$name ; \\\n+      fi ; fi ; done)\n+    -@(for i in $(srcdir)\/test\/XInclude\/docs\/* ; do \\\n+      name=`basename $$i`; \\\n+      if [ ! -d $$i ] ; then \\\n+      if [ ! -f $(srcdir)\/result\/XInclude\/$$name ] ; then \\\n+          echo New test file $$name ; \\\n+          $(CHECKER) $(top_builddir)\/xmllint --nowarning --noxincludenode $$i > $(srcdir)\/result\/XInclude\/$$name 2> $(srcdir)\/result\/XInclude\/$$name.err ; \\\n+          grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\";\\\n+      else \\\n+          log=`$(CHECKER) $(top_builddir)\/xmllint --nowarning --noxincludenode $$i > result.$$name 2>error.$$name ; \\\n+          grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\";\\\n+          diff $(srcdir)\/result\/XInclude\/$$name result.$$name ; \\\n+          diff $(srcdir)\/result\/XInclude\/$$name.err error.$$name` ; \\\n+          if [ -n \"$$log\" ] ; then echo $$name result ; echo \"$$log\" ; fi ; \\\n+          rm result.$$name error.$$name ; \\\n+      fi ; fi ; done)\n+    @(echo > .memdump)\n+    @echo \"## XInclude xmlReader regression tests\"\n+    -@(for i in $(srcdir)\/test\/XInclude\/docs\/* ; do \\\n+      name=`basename $$i`; \\\n+      if [ ! -d $$i ] ; then \\\n+      if [ ! -f $(srcdir)\/result\/XInclude\/$$name.rdr ] ; then \\\n+          echo New test file $$name ; \\\n+          $(CHECKER) $(top_builddir)\/xmllint --nowarning --xinclude --stream --debug $$i > $(srcdir)\/result\/XInclude\/$$name.rdr ; \\\n+          grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\";\\\n+      else \\\n+          log=`$(CHECKER) $(top_builddir)\/xmllint --nowarning --xinclude --stream --debug $$i > result.$$name 2>error.$$name ; \\\n+          grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\";\\\n+          diff $(srcdir)\/result\/XInclude\/$$name.err error.$$name ; \\\n+          diff $(srcdir)\/result\/XInclude\/$$name.rdr result.$$name` ; \\\n+          if [ -n \"$$log\" ] ; then echo $$name result ; echo \"$$log\" ; fi ; \\\n+          rm result.$$name error.$$name ; \\\n+      fi ; fi ; done)\n+    -@(for i in $(srcdir)\/test\/XInclude\/docs\/* ; do \\\n+      name=`basename $$i`; \\\n+      if [ ! -d $$i ] ; then \\\n+      if [ ! -f $(srcdir)\/result\/XInclude\/$$name.rdr ] ; then \\\n+          echo New test file $$name ; \\\n+          $(CHECKER) $(top_builddir)\/xmllint --nowarning --noxincludenode --stream --debug $$i > $(srcdir)\/result\/XInclude\/$$name.rdr ; \\\n+          grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\";\\\n+      else \\\n+          log=`$(CHECKER) $(top_builddir)\/xmllint --nowarning --xinclude --stream --debug $$i > result.$$name 2>error.$$name ; \\\n+          grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\";\\\n+          diff $(srcdir)\/result\/XInclude\/$$name.err error.$$name ; \\\n+          diff $(srcdir)\/result\/XInclude\/$$name.rdr result.$$name` ; \\\n+          if [ -n \"$$log\" ] ; then echo $$name result ; echo \"$$log\" ; fi ; \\\n+          rm result.$$name error.$$name ; \\\n+      fi ; fi ; done)\n@@ -647,19 +648,19 @@\n-\t@(echo > .memdump)\n-\t@echo \"## Scripts regression tests\"\n-\t@echo \"## Some of the base computations may be different if srcdir != .\"\n-\t-@(for i in $(srcdir)\/test\/scripts\/*.script ; do \\\n-\t  name=`basename $$i .script`; \\\n-\t  xml=$(srcdir)\/test\/scripts\/`basename $$i .script`.xml; \\\n-\t  if [ -f $$xml ] ; then \\\n-\t  if [ ! -f $(srcdir)\/result\/scripts\/$$name ] ; then \\\n-\t      echo New test file $$name ; \\\n-\t      $(CHECKER) $(top_builddir)\/xmllint --shell $$xml < $$i > $(srcdir)\/result\/scripts\/$$name 2> $(srcdir)\/result\/scripts\/$$name.err ; \\\n-\t      grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\";\\\n-\t  else \\\n-\t      log=`$(CHECKER) $(top_builddir)\/xmllint --shell $$xml < $$i > result.$$name 2> result.$$name.err ; \\\n-\t      grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\";\\\n-\t      diff $(srcdir)\/result\/scripts\/$$name result.$$name ; \\\n-\t      diff $(srcdir)\/result\/scripts\/$$name.err result.$$name.err` ; \\\n-\t      if [ -n \"$$log\" ] ; then echo $$name result ; echo \"$$log\" ; fi ; \\\n-\t      rm result.$$name result.$$name.err ; \\\n-\t  fi ; fi ; done)\n+    @(echo > .memdump)\n+    @echo \"## Scripts regression tests\"\n+    @echo \"## Some of the base computations may be different if srcdir != .\"\n+    -@(for i in $(srcdir)\/test\/scripts\/*.script ; do \\\n+      name=`basename $$i .script`; \\\n+      xml=$(srcdir)\/test\/scripts\/`basename $$i .script`.xml; \\\n+      if [ -f $$xml ] ; then \\\n+      if [ ! -f $(srcdir)\/result\/scripts\/$$name ] ; then \\\n+          echo New test file $$name ; \\\n+          $(CHECKER) $(top_builddir)\/xmllint --shell $$xml < $$i > $(srcdir)\/result\/scripts\/$$name 2> $(srcdir)\/result\/scripts\/$$name.err ; \\\n+          grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\";\\\n+      else \\\n+          log=`$(CHECKER) $(top_builddir)\/xmllint --shell $$xml < $$i > result.$$name 2> result.$$name.err ; \\\n+          grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\";\\\n+          diff $(srcdir)\/result\/scripts\/$$name result.$$name ; \\\n+          diff $(srcdir)\/result\/scripts\/$$name.err result.$$name.err` ; \\\n+          if [ -n \"$$log\" ] ; then echo $$name result ; echo \"$$log\" ; fi ; \\\n+          rm result.$$name result.$$name.err ; \\\n+      fi ; fi ; done)\n@@ -668,52 +669,52 @@\n-\t@(echo > .memdump)\n-\t@echo \"## Catalog regression tests\"\n-\t-@(for i in $(srcdir)\/test\/catalogs\/*.script ; do \\\n-\t  name=`basename $$i .script`; \\\n-\t  xml=$(srcdir)\/test\/catalogs\/`basename $$i .script`.xml; \\\n-\t  if [ -f $$xml ] ; then \\\n-\t  if [ ! -f $(srcdir)\/result\/catalogs\/$$name ] ; then \\\n-\t      echo New test file $$name ; \\\n-\t      $(CHECKER) $(top_builddir)\/xmlcatalog --shell $$xml < $$i 2>&1 > $(srcdir)\/result\/catalogs\/$$name ; \\\n-\t      grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\";\\\n-\t  else \\\n-\t      log=`$(CHECKER) $(top_builddir)\/xmlcatalog --shell $$xml < $$i 2>&1 > result.$$name ; \\\n-\t      grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\";\\\n-\t      diff $(srcdir)\/result\/catalogs\/$$name result.$$name` ; \\\n-\t      if [ -n \"$$log\" ] ; then echo $$name result ; echo \"$$log\" ; fi ; \\\n-\t      rm result.$$name ; \\\n-\t  fi ; fi ; done)\n-\t-@(for i in $(srcdir)\/test\/catalogs\/*.script ; do \\\n-\t  name=`basename $$i .script`; \\\n-\t  sgml=$(srcdir)\/test\/catalogs\/`basename $$i .script`.sgml; \\\n-\t  if [ -f $$sgml ] ; then \\\n-\t  if [ ! -f $(srcdir)\/result\/catalogs\/$$name ] ; then \\\n-\t      echo New test file $$name ; \\\n-\t      $(CHECKER) $(top_builddir)\/xmlcatalog --shell $$sgml < $$i > $(srcdir)\/result\/catalogs\/$$name ; \\\n-\t      grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\";\\\n-\t  else \\\n-\t      log=`$(CHECKER) $(top_builddir)\/xmlcatalog --shell $$sgml < $$i > result.$$name ; \\\n-\t      grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\";\\\n-\t      diff $(srcdir)\/result\/catalogs\/$$name result.$$name` ; \\\n-\t      if [ -n \"$$log\" ] ; then echo $$name result ; echo \"$$log\" ; fi ; \\\n-\t      rm result.$$name ; \\\n-\t  fi ; fi ; done)\n-\t@echo \"## Add and del operations on XML Catalogs\"\n-\t-@($(CHECKER) $(top_builddir)\/xmlcatalog --create --noout $(srcdir)\/result\/catalogs\/mycatalog; \\\n-\tgrep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\"; \\\n-\t$(CHECKER) $(top_builddir)\/xmlcatalog --noout --add public Pubid sysid $(srcdir)\/result\/catalogs\/mycatalog; \\\n-\tgrep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\"; \\\n-\t$(CHECKER) $(top_builddir)\/xmlcatalog --noout --add public Pubid2 sysid2 $(srcdir)\/result\/catalogs\/mycatalog; \\\n-\tgrep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\"; \\\n-\t$(CHECKER) $(top_builddir)\/xmlcatalog --noout --add public Pubid3 sysid3 $(srcdir)\/result\/catalogs\/mycatalog; \\\n-\tgrep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\"; \\\n-\tdiff result\/catalogs\/mycatalog.full $(srcdir)\/result\/catalogs\/mycatalog; \\\n-\tgrep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\"; \\\n-\t$(CHECKER) $(top_builddir)\/xmlcatalog --noout --del sysid $(srcdir)\/result\/catalogs\/mycatalog; \\\n-\tgrep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\"; \\\n-\t$(CHECKER) $(top_builddir)\/xmlcatalog --noout --del sysid3 $(srcdir)\/result\/catalogs\/mycatalog; \\\n-\tgrep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\"; \\\n-\t$(CHECKER) $(top_builddir)\/xmlcatalog --noout --del sysid2 $(srcdir)\/result\/catalogs\/mycatalog; \\\n-\tgrep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\"; \\\n-\tdiff result\/catalogs\/mycatalog.empty $(srcdir)\/result\/catalogs\/mycatalog; \\\n-\tgrep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\"; \\\n-\trm -f $(srcdir)\/result\/catalogs\/mycatalog)\n+    @(echo > .memdump)\n+    @echo \"## Catalog regression tests\"\n+    -@(for i in $(srcdir)\/test\/catalogs\/*.script ; do \\\n+      name=`basename $$i .script`; \\\n+      xml=$(srcdir)\/test\/catalogs\/`basename $$i .script`.xml; \\\n+      if [ -f $$xml ] ; then \\\n+      if [ ! -f $(srcdir)\/result\/catalogs\/$$name ] ; then \\\n+          echo New test file $$name ; \\\n+          $(CHECKER) $(top_builddir)\/xmlcatalog --shell $$xml < $$i 2>&1 > $(srcdir)\/result\/catalogs\/$$name ; \\\n+          grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\";\\\n+      else \\\n+          log=`$(CHECKER) $(top_builddir)\/xmlcatalog --shell $$xml < $$i 2>&1 > result.$$name ; \\\n+          grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\";\\\n+          diff $(srcdir)\/result\/catalogs\/$$name result.$$name` ; \\\n+          if [ -n \"$$log\" ] ; then echo $$name result ; echo \"$$log\" ; fi ; \\\n+          rm result.$$name ; \\\n+      fi ; fi ; done)\n+    -@(for i in $(srcdir)\/test\/catalogs\/*.script ; do \\\n+      name=`basename $$i .script`; \\\n+      sgml=$(srcdir)\/test\/catalogs\/`basename $$i .script`.sgml; \\\n+      if [ -f $$sgml ] ; then \\\n+      if [ ! -f $(srcdir)\/result\/catalogs\/$$name ] ; then \\\n+          echo New test file $$name ; \\\n+          $(CHECKER) $(top_builddir)\/xmlcatalog --shell $$sgml < $$i > $(srcdir)\/result\/catalogs\/$$name ; \\\n+          grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\";\\\n+      else \\\n+          log=`$(CHECKER) $(top_builddir)\/xmlcatalog --shell $$sgml < $$i > result.$$name ; \\\n+          grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\";\\\n+          diff $(srcdir)\/result\/catalogs\/$$name result.$$name` ; \\\n+          if [ -n \"$$log\" ] ; then echo $$name result ; echo \"$$log\" ; fi ; \\\n+          rm result.$$name ; \\\n+      fi ; fi ; done)\n+    @echo \"## Add and del operations on XML Catalogs\"\n+    -@($(CHECKER) $(top_builddir)\/xmlcatalog --create --noout $(srcdir)\/result\/catalogs\/mycatalog; \\\n+    grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\"; \\\n+    $(CHECKER) $(top_builddir)\/xmlcatalog --noout --add public Pubid sysid $(srcdir)\/result\/catalogs\/mycatalog; \\\n+    grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\"; \\\n+    $(CHECKER) $(top_builddir)\/xmlcatalog --noout --add public Pubid2 sysid2 $(srcdir)\/result\/catalogs\/mycatalog; \\\n+    grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\"; \\\n+    $(CHECKER) $(top_builddir)\/xmlcatalog --noout --add public Pubid3 sysid3 $(srcdir)\/result\/catalogs\/mycatalog; \\\n+    grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\"; \\\n+    diff result\/catalogs\/mycatalog.full $(srcdir)\/result\/catalogs\/mycatalog; \\\n+    grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\"; \\\n+    $(CHECKER) $(top_builddir)\/xmlcatalog --noout --del sysid $(srcdir)\/result\/catalogs\/mycatalog; \\\n+    grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\"; \\\n+    $(CHECKER) $(top_builddir)\/xmlcatalog --noout --del sysid3 $(srcdir)\/result\/catalogs\/mycatalog; \\\n+    grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\"; \\\n+    $(CHECKER) $(top_builddir)\/xmlcatalog --noout --del sysid2 $(srcdir)\/result\/catalogs\/mycatalog; \\\n+    grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\"; \\\n+    diff result\/catalogs\/mycatalog.empty $(srcdir)\/result\/catalogs\/mycatalog; \\\n+    grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\"; \\\n+    rm -f $(srcdir)\/result\/catalogs\/mycatalog)\n@@ -722,18 +723,18 @@\n-\t@echo \"## SVG parsing regression tests\"\n-\t-@(for i in $(srcdir)\/test\/SVG\/* ; do \\\n-\t  name=`basename $$i`; \\\n-\t  if [ ! -d $$i ] ; then \\\n-\t  if [ ! -f $(srcdir)\/result\/SVG\/$$name ] ; then \\\n-\t      echo New test file $$name ; \\\n-\t      $(CHECKER) $(top_builddir)\/xmllint $$i > $(srcdir)\/result\/SVG\/$$name ; \\\n-\t      grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\";\\\n-\t  else \\\n-\t      echo Testing $$name ; \\\n-\t      $(CHECKER) $(top_builddir)\/xmllint $$i > result.$$name ; \\\n-\t      grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\";\\\n-\t      diff $(srcdir)\/result\/SVG\/$$name result.$$name ; \\\n-\t      $(CHECKER) $(top_builddir)\/xmllint result.$$name > result2.$$name ; \\\n-\t      grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\";\\\n-\t      diff result.$$name result2.$$name ; \\\n-\t      rm result.$$name result2.$$name ; \\\n-\t  fi ; fi ; done)\n+    @echo \"## SVG parsing regression tests\"\n+    -@(for i in $(srcdir)\/test\/SVG\/* ; do \\\n+      name=`basename $$i`; \\\n+      if [ ! -d $$i ] ; then \\\n+      if [ ! -f $(srcdir)\/result\/SVG\/$$name ] ; then \\\n+          echo New test file $$name ; \\\n+          $(CHECKER) $(top_builddir)\/xmllint $$i > $(srcdir)\/result\/SVG\/$$name ; \\\n+          grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\";\\\n+      else \\\n+          echo Testing $$name ; \\\n+          $(CHECKER) $(top_builddir)\/xmllint $$i > result.$$name ; \\\n+          grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\";\\\n+          diff $(srcdir)\/result\/SVG\/$$name result.$$name ; \\\n+          $(CHECKER) $(top_builddir)\/xmllint result.$$name > result2.$$name ; \\\n+          grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\";\\\n+          diff result.$$name result2.$$name ; \\\n+          rm result.$$name result2.$$name ; \\\n+      fi ; fi ; done)\n@@ -742,4 +743,4 @@\n-\t@echo \"## Threaded regression tests\"\n-\t-@($(CHECKER) $(top_builddir)\/testThreads ; \\\n-\t   grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\"; \\\n-\t   exit 0)\n+    @echo \"## Threaded regression tests\"\n+    -@($(CHECKER) $(top_builddir)\/testThreads ; \\\n+       grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\"; \\\n+       exit 0)\n@@ -748,62 +749,62 @@\n-\t@(echo > .memdump)\n-\t@echo \"## Reader regression tests\"\n-\t-@(for i in $(srcdir)\/test\/* ; do \\\n-\t  name=`basename $$i`; \\\n-\t  if [ ! -d $$i ] ; then \\\n-\t  if [ ! -f $(srcdir)\/result\/$$name.rdr ] ; then \\\n-\t      echo New test file $$name ; \\\n-\t      $(CHECKER) $(top_builddir)\/xmllint --nonet --debug --stream $$i > $(srcdir)\/result\/$$name.rdr 2>\/dev\/null ; \\\n-\t      grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\";\\\n-\t  else \\\n-\t      log=`$(CHECKER) $(top_builddir)\/xmllint --nonet --debug --stream $$i > result.$$name 2>\/dev\/null ; \\\n-\t      grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\";\\\n-\t      diff $(srcdir)\/result\/$$name.rdr result.$$name` ; \\\n-\t      if [ -n \"$$log\" ] ; then echo $$name result ; echo \"$$log\" ; fi ; \\\n-\t      rm result.$$name ; \\\n-\t  fi ; fi ; done)\n-\t@echo \"## Reader on memory regression tests\"\n-\t-@(for i in $(srcdir)\/test\/* ; do \\\n-\t  name=`basename $$i`; \\\n-\t  if [ ! -d $$i ] ; then \\\n-\t  if [ ! -f $(srcdir)\/result\/$$name.rdr ] ; then \\\n-\t      echo New test file $$name ; \\\n-\t      $(CHECKER) $(top_builddir)\/xmllint --memory --nonet --debug --stream $$i > $(srcdir)\/result\/$$name.rdr 2>\/dev\/null ; \\\n-\t      grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\";\\\n-\t  else \\\n-\t      log=`$(CHECKER) $(top_builddir)\/xmllint --memory --nonet --debug --stream $$i > result.$$name 2>\/dev\/null ; \\\n-\t      grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\";\\\n-\t      diff $(srcdir)\/result\/$$name.rdr result.$$name` ; \\\n-\t      if [ -n \"$$log\" ] ; then echo $$name result ; echo \"$$log\" ; fi ; \\\n-\t      rm result.$$name ; \\\n-\t  fi ; fi ; done)\n-\t@(echo > .memdump)\n-\t@echo \"## Walker regression tests\"\n-\t-@(for i in $(srcdir)\/test\/* ; do \\\n-\t  name=`basename $$i`; \\\n-\t  if [ ! -d $$i ] ; then \\\n-\t  if [ ! -f $(srcdir)\/result\/$$name.rdr ] ; then \\\n-\t      echo New test file $$name ; \\\n-\t      $(CHECKER) $(top_builddir)\/xmllint --nonet --debug --walker $$i > $(srcdir)\/result\/$$name.rdr 2>\/dev\/null ; \\\n-\t      grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\";\\\n-\t  else \\\n-\t      log=`$(CHECKER) $(top_builddir)\/xmllint --nonet --debug --walker $$i > result.$$name 2>\/dev\/null ; \\\n-\t      grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\";\\\n-\t      diff $(srcdir)\/result\/$$name.rdr result.$$name` ; \\\n-\t      if [ -n \"$$log\" ] ; then echo $$name result ; echo \"$$log\" ; fi ; \\\n-\t      rm result.$$name ; \\\n-\t  fi ; fi ; done)\n-\t@echo \"## Reader entities substitution regression tests\"\n-\t-@(for i in $(srcdir)\/test\/* ; do \\\n-\t  name=`basename $$i`; \\\n-\t  if [ ! -d $$i ] ; then \\\n-\t  if [ ! -f $(srcdir)\/result\/$$name.rde ] ; then \\\n-\t      echo New test file $$name ; \\\n-\t      $(CHECKER) $(top_builddir)\/xmllint --noent --nonet --debug --stream $$i > $(srcdir)\/result\/$$name.rde 2>\/dev\/null ; \\\n-\t      grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\";\\\n-\t  else \\\n-\t      log=`$(CHECKER) $(top_builddir)\/xmllint --noent --nonet --debug --stream $$i > result.$$name 2>\/dev\/null ; \\\n-\t      grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\";\\\n-\t      diff $(srcdir)\/result\/$$name.rde result.$$name` ; \\\n-\t      if [ -n \"$$log\" ] ; then echo $$name result ; echo \"$$log\" ; fi ; \\\n-\t      rm result.$$name ; \\\n-\t  fi ; fi ; done)\n+    @(echo > .memdump)\n+    @echo \"## Reader regression tests\"\n+    -@(for i in $(srcdir)\/test\/* ; do \\\n+      name=`basename $$i`; \\\n+      if [ ! -d $$i ] ; then \\\n+      if [ ! -f $(srcdir)\/result\/$$name.rdr ] ; then \\\n+          echo New test file $$name ; \\\n+          $(CHECKER) $(top_builddir)\/xmllint --nonet --debug --stream $$i > $(srcdir)\/result\/$$name.rdr 2>\/dev\/null ; \\\n+          grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\";\\\n+      else \\\n+          log=`$(CHECKER) $(top_builddir)\/xmllint --nonet --debug --stream $$i > result.$$name 2>\/dev\/null ; \\\n+          grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\";\\\n+          diff $(srcdir)\/result\/$$name.rdr result.$$name` ; \\\n+          if [ -n \"$$log\" ] ; then echo $$name result ; echo \"$$log\" ; fi ; \\\n+          rm result.$$name ; \\\n+      fi ; fi ; done)\n+    @echo \"## Reader on memory regression tests\"\n+    -@(for i in $(srcdir)\/test\/* ; do \\\n+      name=`basename $$i`; \\\n+      if [ ! -d $$i ] ; then \\\n+      if [ ! -f $(srcdir)\/result\/$$name.rdr ] ; then \\\n+          echo New test file $$name ; \\\n+          $(CHECKER) $(top_builddir)\/xmllint --memory --nonet --debug --stream $$i > $(srcdir)\/result\/$$name.rdr 2>\/dev\/null ; \\\n+          grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\";\\\n+      else \\\n+          log=`$(CHECKER) $(top_builddir)\/xmllint --memory --nonet --debug --stream $$i > result.$$name 2>\/dev\/null ; \\\n+          grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\";\\\n+          diff $(srcdir)\/result\/$$name.rdr result.$$name` ; \\\n+          if [ -n \"$$log\" ] ; then echo $$name result ; echo \"$$log\" ; fi ; \\\n+          rm result.$$name ; \\\n+      fi ; fi ; done)\n+    @(echo > .memdump)\n+    @echo \"## Walker regression tests\"\n+    -@(for i in $(srcdir)\/test\/* ; do \\\n+      name=`basename $$i`; \\\n+      if [ ! -d $$i ] ; then \\\n+      if [ ! -f $(srcdir)\/result\/$$name.rdr ] ; then \\\n+          echo New test file $$name ; \\\n+          $(CHECKER) $(top_builddir)\/xmllint --nonet --debug --walker $$i > $(srcdir)\/result\/$$name.rdr 2>\/dev\/null ; \\\n+          grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\";\\\n+      else \\\n+          log=`$(CHECKER) $(top_builddir)\/xmllint --nonet --debug --walker $$i > result.$$name 2>\/dev\/null ; \\\n+          grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\";\\\n+          diff $(srcdir)\/result\/$$name.rdr result.$$name` ; \\\n+          if [ -n \"$$log\" ] ; then echo $$name result ; echo \"$$log\" ; fi ; \\\n+          rm result.$$name ; \\\n+      fi ; fi ; done)\n+    @echo \"## Reader entities substitution regression tests\"\n+    -@(for i in $(srcdir)\/test\/* ; do \\\n+      name=`basename $$i`; \\\n+      if [ ! -d $$i ] ; then \\\n+      if [ ! -f $(srcdir)\/result\/$$name.rde ] ; then \\\n+          echo New test file $$name ; \\\n+          $(CHECKER) $(top_builddir)\/xmllint --noent --nonet --debug --stream $$i > $(srcdir)\/result\/$$name.rde 2>\/dev\/null ; \\\n+          grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\";\\\n+      else \\\n+          log=`$(CHECKER) $(top_builddir)\/xmllint --noent --nonet --debug --stream $$i > result.$$name 2>\/dev\/null ; \\\n+          grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\";\\\n+          diff $(srcdir)\/result\/$$name.rde result.$$name` ; \\\n+          if [ -n \"$$log\" ] ; then echo $$name result ; echo \"$$log\" ; fi ; \\\n+          rm result.$$name ; \\\n+      fi ; fi ; done)\n@@ -812,46 +813,46 @@\n-\t@(echo > .memdump)\n-\t@echo \"## SAX1 callbacks regression tests\"\n-\t-@(for i in $(srcdir)\/test\/* ; do \\\n-\t  name=`basename $$i`; \\\n-\t  if [ ! -d $$i ] ; then \\\n-\t  if [ ! -f $(srcdir)\/result\/$$name.sax ] ; then \\\n-\t      echo New test file $$name ; \\\n-\t      $(CHECKER) $(top_builddir)\/testSAX $$i > $(srcdir)\/result\/$$name.sax 2> \/dev\/null ; \\\n-\t      grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\";\\\n-\t  else \\\n-\t      log=`$(CHECKER) $(top_builddir)\/testSAX $$i > result.$$name 2> \/dev\/null ; \\\n-\t      grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\";\\\n-\t      diff $(srcdir)\/result\/$$name.sax result.$$name` ; \\\n-\t      if [ -n \"$$log\" ] ; then echo $$name result ; echo \"$$log\" ; fi ; \\\n-\t      rm result.$$name ; \\\n-\t  fi ; fi ; done)\n-\t@echo \"## SAX2 callbacks regression tests\"\n-\t-@(for i in $(srcdir)\/test\/* ; do \\\n-\t  name=`basename $$i`; \\\n-\t  if [ ! -d $$i ] ; then \\\n-\t  if [ ! -f $(srcdir)\/result\/$$name.sax2 ] ; then \\\n-\t      echo New test file $$name ; \\\n-\t      $(CHECKER) $(top_builddir)\/testSAX --sax2 $$i > $(srcdir)\/result\/$$name.sax2 2> \/dev\/null ; \\\n-\t      grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\";\\\n-\t  else \\\n-\t      log=`$(CHECKER) $(top_builddir)\/testSAX --sax2 $$i > result.$$name 2> \/dev\/null ; \\\n-\t      grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\";\\\n-\t      diff $(srcdir)\/result\/$$name.sax2 result.$$name` ; \\\n-\t      if [ -n \"$$log\" ] ; then echo $$name result ; echo \"$$log\" ; fi ; \\\n-\t      rm result.$$name ; \\\n-\t  fi ; fi ; done)\n-\t@echo \"## SAX2 callbacks regression tests with entity substitution\"\n-\t-@(for i in $(srcdir)\/test\/* ; do \\\n-\t  name=`basename $$i`; \\\n-\t  if [ ! -d $$i ] ; then \\\n-\t  if [ ! -f $(srcdir)\/result\/noent\/$$name.sax2 ] ; then \\\n-\t      echo New test file $$name ; \\\n-\t      $(CHECKER) $(top_builddir)\/testSAX --sax2 --noent $$i > $(srcdir)\/result\/noent\/$$name.sax2 2> \/dev\/null ; \\\n-\t      grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\";\\\n-\t  else \\\n-\t      log=`$(CHECKER) $(top_builddir)\/testSAX --sax2 --noent $$i > result.$$name 2> \/dev\/null ; \\\n-\t      grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\";\\\n-\t      diff $(srcdir)\/result\/noent\/$$name.sax2 result.$$name` ; \\\n-\t      if [ -n \"$$log\" ] ; then echo $$name result ; echo \"$$log\" ; fi ; \\\n-\t      rm result.$$name ; \\\n-\t  fi ; fi ; done)\n+    @(echo > .memdump)\n+    @echo \"## SAX1 callbacks regression tests\"\n+    -@(for i in $(srcdir)\/test\/* ; do \\\n+      name=`basename $$i`; \\\n+      if [ ! -d $$i ] ; then \\\n+      if [ ! -f $(srcdir)\/result\/$$name.sax ] ; then \\\n+          echo New test file $$name ; \\\n+          $(CHECKER) $(top_builddir)\/testSAX $$i > $(srcdir)\/result\/$$name.sax 2> \/dev\/null ; \\\n+          grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\";\\\n+      else \\\n+          log=`$(CHECKER) $(top_builddir)\/testSAX $$i > result.$$name 2> \/dev\/null ; \\\n+          grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\";\\\n+          diff $(srcdir)\/result\/$$name.sax result.$$name` ; \\\n+          if [ -n \"$$log\" ] ; then echo $$name result ; echo \"$$log\" ; fi ; \\\n+          rm result.$$name ; \\\n+      fi ; fi ; done)\n+    @echo \"## SAX2 callbacks regression tests\"\n+    -@(for i in $(srcdir)\/test\/* ; do \\\n+      name=`basename $$i`; \\\n+      if [ ! -d $$i ] ; then \\\n+      if [ ! -f $(srcdir)\/result\/$$name.sax2 ] ; then \\\n+          echo New test file $$name ; \\\n+          $(CHECKER) $(top_builddir)\/testSAX --sax2 $$i > $(srcdir)\/result\/$$name.sax2 2> \/dev\/null ; \\\n+          grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\";\\\n+      else \\\n+          log=`$(CHECKER) $(top_builddir)\/testSAX --sax2 $$i > result.$$name 2> \/dev\/null ; \\\n+          grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\";\\\n+          diff $(srcdir)\/result\/$$name.sax2 result.$$name` ; \\\n+          if [ -n \"$$log\" ] ; then echo $$name result ; echo \"$$log\" ; fi ; \\\n+          rm result.$$name ; \\\n+      fi ; fi ; done)\n+    @echo \"## SAX2 callbacks regression tests with entity substitution\"\n+    -@(for i in $(srcdir)\/test\/* ; do \\\n+      name=`basename $$i`; \\\n+      if [ ! -d $$i ] ; then \\\n+      if [ ! -f $(srcdir)\/result\/noent\/$$name.sax2 ] ; then \\\n+          echo New test file $$name ; \\\n+          $(CHECKER) $(top_builddir)\/testSAX --sax2 --noent $$i > $(srcdir)\/result\/noent\/$$name.sax2 2> \/dev\/null ; \\\n+          grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\";\\\n+      else \\\n+          log=`$(CHECKER) $(top_builddir)\/testSAX --sax2 --noent $$i > result.$$name 2> \/dev\/null ; \\\n+          grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\";\\\n+          diff $(srcdir)\/result\/noent\/$$name.sax2 result.$$name` ; \\\n+          if [ -n \"$$log\" ] ; then echo $$name result ; echo \"$$log\" ; fi ; \\\n+          rm result.$$name ; \\\n+      fi ; fi ; done)\n@@ -860,40 +861,40 @@\n-\t@(echo > .memdump)\n-\t@echo \"## Valid documents regression tests\"\n-\t-@(for i in $(srcdir)\/test\/VCM\/* ; do \\\n-\t  name=`basename $$i`; \\\n-\t  if [ ! -d $$i ] ; then \\\n-\t      log=`$(CHECKER) $(top_builddir)\/xmllint --valid --noout --nowarning $$i ; \\\n-\t      grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\"`;\\\n-\t      if [ -n \"$$log\" ] ; then echo $$name result ; echo \"$$log\" ; fi ; \\\n-\t  fi ; done ; exit 0)\n-\t@echo \"## Validity checking regression tests\"\n-\t-@(for i in $(srcdir)\/test\/VC\/* ; do \\\n-\t  name=`basename $$i`; \\\n-\t  if [ ! -d $$i ] ; then \\\n-\t  if [ ! -f $(srcdir)\/result\/VC\/$$name ] ; then \\\n-\t      echo New test file $$name ; \\\n-\t      $(CHECKER) $(top_builddir)\/xmllint --noout --valid $$i 2> $(srcdir)\/result\/VC\/$$name ; \\\n-\t      grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\";\\\n-\t  else \\\n-\t      log=`$(CHECKER) $(top_builddir)\/xmllint --noout --valid $$i 2> result.$$name ; \\\n-\t      grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\";\\\n-\t      diff $(srcdir)\/result\/VC\/$$name result.$$name` ; \\\n-\t      if [ -n \"$$log\" ] ; then echo $$name result ; echo \"$$log\" ; fi ; \\\n-\t      rm result.$$name ; \\\n-\t  fi ; fi ; done)\n-\t@echo \"## General documents valid regression tests\"\n-\t-@(for i in $(srcdir)\/test\/valid\/* ; do \\\n-\t  name=`basename $$i`; \\\n-\t  if [ ! -d $$i ] ; then \\\n-\t  if [ ! -f $(srcdir)\/result\/valid\/$$name ] ; then \\\n-\t      echo New test file $$name ; \\\n-\t      $(CHECKER) $(top_builddir)\/xmllint --valid $$i > $(srcdir)\/result\/valid\/$$name 2>$(srcdir)\/result\/valid\/$$name.err ; \\\n-\t      grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\";\\\n-\t  else \\\n-\t      log=`$(CHECKER) $(top_builddir)\/xmllint --valid $$i > result.$$name 2>error.$$name ; \\\n-\t      grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\";\\\n-\t      diff $(srcdir)\/result\/valid\/$$name result.$$name ; \\\n-\t      diff $(srcdir)\/result\/valid\/$$name.err error.$$name` ; \\\n-\t      if [ -n \"$$log\" ] ; then echo $$name result ; echo \"$$log\" ; fi ; \\\n-\t      rm result.$$name error.$$name ; \\\n-\t  fi ; fi ; done)\n+    @(echo > .memdump)\n+    @echo \"## Valid documents regression tests\"\n+    -@(for i in $(srcdir)\/test\/VCM\/* ; do \\\n+      name=`basename $$i`; \\\n+      if [ ! -d $$i ] ; then \\\n+          log=`$(CHECKER) $(top_builddir)\/xmllint --valid --noout --nowarning $$i ; \\\n+          grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\"`;\\\n+          if [ -n \"$$log\" ] ; then echo $$name result ; echo \"$$log\" ; fi ; \\\n+      fi ; done ; exit 0)\n+    @echo \"## Validity checking regression tests\"\n+    -@(for i in $(srcdir)\/test\/VC\/* ; do \\\n+      name=`basename $$i`; \\\n+      if [ ! -d $$i ] ; then \\\n+      if [ ! -f $(srcdir)\/result\/VC\/$$name ] ; then \\\n+          echo New test file $$name ; \\\n+          $(CHECKER) $(top_builddir)\/xmllint --noout --valid $$i 2> $(srcdir)\/result\/VC\/$$name ; \\\n+          grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\";\\\n+      else \\\n+          log=`$(CHECKER) $(top_builddir)\/xmllint --noout --valid $$i 2> result.$$name ; \\\n+          grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\";\\\n+          diff $(srcdir)\/result\/VC\/$$name result.$$name` ; \\\n+          if [ -n \"$$log\" ] ; then echo $$name result ; echo \"$$log\" ; fi ; \\\n+          rm result.$$name ; \\\n+      fi ; fi ; done)\n+    @echo \"## General documents valid regression tests\"\n+    -@(for i in $(srcdir)\/test\/valid\/* ; do \\\n+      name=`basename $$i`; \\\n+      if [ ! -d $$i ] ; then \\\n+      if [ ! -f $(srcdir)\/result\/valid\/$$name ] ; then \\\n+          echo New test file $$name ; \\\n+          $(CHECKER) $(top_builddir)\/xmllint --valid $$i > $(srcdir)\/result\/valid\/$$name 2>$(srcdir)\/result\/valid\/$$name.err ; \\\n+          grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\";\\\n+      else \\\n+          log=`$(CHECKER) $(top_builddir)\/xmllint --valid $$i > result.$$name 2>error.$$name ; \\\n+          grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\";\\\n+          diff $(srcdir)\/result\/valid\/$$name result.$$name ; \\\n+          diff $(srcdir)\/result\/valid\/$$name.err error.$$name` ; \\\n+          if [ -n \"$$log\" ] ; then echo $$name result ; echo \"$$log\" ; fi ; \\\n+          rm result.$$name error.$$name ; \\\n+      fi ; fi ; done)\n@@ -902,16 +903,18 @@\n-\t@(echo > .memdump)\n-\t@echo \"## Regexp regression tests\"\n-\t-@(for i in $(srcdir)\/test\/regexp\/* ; do \\\n-\t  name=`basename $$i`; \\\n-\t  if [ ! -d $$i ] ; then \\\n-\t  if [ ! -f $(srcdir)\/result\/regexp\/$$name ] ; then \\\n-\t      echo New test file $$name ; \\\n-\t      $(CHECKER) $(top_builddir)\/testRegexp -i $$i > $(srcdir)\/result\/regexp\/$$name; \\\n-\t      grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\";\\\n-\t  else \\\n-\t      log=`$(CHECKER) $(top_builddir)\/testRegexp -i $$i 2>&1 > result.$$name ; \\\n-\t      grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\";\\\n-\t      diff $(srcdir)\/result\/regexp\/$$name result.$$name` ; \\\n-\t      if [ -n \"$$log\" ] ; then echo $$name result ; echo \"$$log\" ; fi ; \\\n-\t      rm result.$$name ; \\\n-\t  fi ; fi ; done)\n+    @(echo > .memdump)\n+    @echo \"## Regexp regression tests\"\n+    -@(for i in $(srcdir)\/test\/regexp\/* ; do \\\n+      name=`basename $$i`; \\\n+      if [ ! -d $$i ] ; then \\\n+      if [ ! -f $(srcdir)\/result\/regexp\/$$name ] ; then \\\n+          echo New test file $$name ; \\\n+          $(CHECKER) $(top_builddir)\/testRegexp -i $$i > $(srcdir)\/result\/regexp\/$$name 2> $(srcdir)\/result\/regexp\/$$name.err ; \\\n+          if [ ! -s \"$(srcdir)\/result\/regexp\/$$name.err\" ] ; then rm $(srcdir)\/result\/regexp\/$$name.err; fi ; \\\n+          grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\";\\\n+      else \\\n+          log=`$(CHECKER) $(top_builddir)\/testRegexp -i $$i > result.$$name 2> error.$$name ; \\\n+          grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\";\\\n+          diff $(srcdir)\/result\/regexp\/$$name result.$$name ; \\\n+          if [ -s \"$(srcdir)\/result\/regexp\/$$name.err\" -o -s \"error.$$name\" ] ; then diff $(srcdir)\/result\/regexp\/$$name.err error.$$name ; fi` ; \\\n+          if [ -n \"$$log\" ] ; then echo $$name result ; echo $$log ; fi ; \\\n+          rm result.$$name error.$$name ; \\\n+      fi ; fi ; done)\n@@ -921,15 +924,15 @@\n-\t@echo \"## Formal expresssions regression tests\"\n-\t-@(for i in $(srcdir)\/test\/expr\/* ; do \\\n-\t  name=`basename $$i`; \\\n-\t  if [ ! -d $$i ] ; then \\\n-\t  if [ ! -f $(srcdir)\/result\/expr\/$$name ] ; then \\\n-\t      echo New test file $$name ; \\\n-\t      $(CHECKER) $(top_builddir)\/testRegexp --expr -i $$i > $(srcdir)\/result\/expr\/$$name; \\\n-\t      grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\";\\\n-\t  else \\\n-\t      log=`$(CHECKER) $(top_builddir)\/testRegexp --expr -i $$i 2>&1 > result.$$name ; \\\n-\t      grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\";\\\n-\t      diff $(srcdir)\/result\/expr\/$$name result.$$name` ; \\\n-\t      if [ -n \"$$log\" ] ; then echo $$name result ; echo \"$$log\" ; fi ; \\\n-\t      rm result.$$name ; \\\n-\t  fi ; fi ; done)\n+    @echo \"## Formal expressions regression tests\"\n+    -@(for i in $(srcdir)\/test\/expr\/* ; do \\\n+      name=`basename $$i`; \\\n+      if [ ! -d $$i ] ; then \\\n+      if [ ! -f $(srcdir)\/result\/expr\/$$name ] ; then \\\n+          echo New test file $$name ; \\\n+          $(CHECKER) $(top_builddir)\/testRegexp --expr -i $$i > $(srcdir)\/result\/expr\/$$name; \\\n+          grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\";\\\n+      else \\\n+          log=`$(CHECKER) $(top_builddir)\/testRegexp --expr -i $$i 2>&1 > result.$$name ; \\\n+          grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\";\\\n+          diff $(srcdir)\/result\/expr\/$$name result.$$name` ; \\\n+          if [ -n \"$$log\" ] ; then echo $$name result ; echo \"$$log\" ; fi ; \\\n+          rm result.$$name ; \\\n+      fi ; fi ; done)\n@@ -938,16 +941,16 @@\n-\t@(echo > .memdump)\n-\t@echo \"## Automata regression tests\"\n-\t-@(for i in $(srcdir)\/test\/automata\/* ; do \\\n-\t  name=`basename $$i`; \\\n-\t  if [ ! -d $$i ] ; then \\\n-\t  if [ ! -f $(srcdir)\/result\/automata\/$$name ] ; then \\\n-\t      echo New test file $$name ; \\\n-\t      $(CHECKER) $(top_builddir)\/testAutomata $$i > $(srcdir)\/result\/automata\/$$name; \\\n-\t      grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\";\\\n-\t  else \\\n-\t      log=`$(CHECKER) $(top_builddir)\/testAutomata $$i 2>&1 > result.$$name ; \\\n-\t      grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\";\\\n-\t      diff $(srcdir)\/result\/automata\/$$name result.$$name` ; \\\n-\t      if [ -n \"$$log\" ] ; then echo $$name result ; echo \"$$log\" ; fi ; \\\n-\t      rm result.$$name ; \\\n-\t  fi ; fi ; done)\n+    @(echo > .memdump)\n+    @echo \"## Automata regression tests\"\n+    -@(for i in $(srcdir)\/test\/automata\/* ; do \\\n+      name=`basename $$i`; \\\n+      if [ ! -d $$i ] ; then \\\n+      if [ ! -f $(srcdir)\/result\/automata\/$$name ] ; then \\\n+          echo New test file $$name ; \\\n+          $(CHECKER) $(top_builddir)\/testAutomata $$i > $(srcdir)\/result\/automata\/$$name; \\\n+          grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\";\\\n+      else \\\n+          log=`$(CHECKER) $(top_builddir)\/testAutomata $$i 2>&1 > result.$$name ; \\\n+          grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\";\\\n+          diff $(srcdir)\/result\/automata\/$$name result.$$name` ; \\\n+          if [ -n \"$$log\" ] ; then echo $$name result ; echo \"$$log\" ; fi ; \\\n+          rm result.$$name ; \\\n+      fi ; fi ; done)\n@@ -956,2 +959,2 @@\n-\t@echo \"## generating dba100000.xml\"\n-\t@($(PERL) $(top_srcdir)\/dbgenattr.pl 100000 > dba100000.xml)\n+    @echo \"## generating dba100000.xml\"\n+    @($(PERL) $(top_srcdir)\/dbgenattr.pl 100000 > dba100000.xml)\n@@ -960,21 +963,21 @@\n-\t@echo \"## Timing tests to try to detect performance\"\n-\t@echo \"## as well a memory usage breakage when streaming\"\n-\t@echo \"## 1\/ using the file interface\"\n-\t@echo \"## 2\/ using the memory interface\"\n-\t@echo \"## 3\/ repeated DOM parsing\"\n-\t@echo \"## 4\/ repeated DOM validation\"\n-\t-@($(top_builddir)\/xmllint --stream --timing dba100000.xml; \\\n-\t   MEM=`cat .memdump | grep \"MEMORY ALLOCATED\" | awk '{ print $$7}'`;\\\n-\t   if [ \"$$MEM\" != \"\" ] ; then echo Using $$MEM bytes ; fi ; \\\n-\t   grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\";\\\n-\t   exit 0)\n-\t-@($(top_builddir)\/xmllint --stream --timing --memory dba100000.xml; \\\n-\t   MEM=`cat .memdump | grep \"MEMORY ALLOCATED\" | awk '{ print $$7}'`;\\\n-\t   if [ \"$$MEM\" != \"\" ] ; then echo Using $$MEM bytes ; fi ; \\\n-\t   grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\";\\\n-\t   exit 0)\n-\t-@($(top_builddir)\/xmllint --noout --timing --repeat $(srcdir)\/test\/valid\/REC-xml-19980210.xml; \\\n-\t   MEM=`cat .memdump | grep \"MEMORY ALLOCATED\" | awk '{ print $$7}'`;\\\n-\t   if [ \"$$MEM\" != \"\" ] ; then echo Using $$MEM bytes ; fi ; \\\n-\t   grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\";\\\n-\t   exit 0)\n+    @echo \"## Timing tests to try to detect performance\"\n+    @echo \"## as well a memory usage breakage when streaming\"\n+    @echo \"## 1\/ using the file interface\"\n+    @echo \"## 2\/ using the memory interface\"\n+    @echo \"## 3\/ repeated DOM parsing\"\n+    @echo \"## 4\/ repeated DOM validation\"\n+    -@($(top_builddir)\/xmllint --stream --timing dba100000.xml; \\\n+       MEM=`cat .memdump | grep \"MEMORY ALLOCATED\" | awk '{ print $$7}'`;\\\n+       if [ \"$$MEM\" != \"\" ] ; then echo Using $$MEM bytes ; fi ; \\\n+       grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\";\\\n+       exit 0)\n+    -@($(top_builddir)\/xmllint --stream --timing --memory dba100000.xml; \\\n+       MEM=`cat .memdump | grep \"MEMORY ALLOCATED\" | awk '{ print $$7}'`;\\\n+       if [ \"$$MEM\" != \"\" ] ; then echo Using $$MEM bytes ; fi ; \\\n+       grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\";\\\n+       exit 0)\n+    -@($(top_builddir)\/xmllint --noout --timing --repeat $(srcdir)\/test\/valid\/REC-xml-19980210.xml; \\\n+       MEM=`cat .memdump | grep \"MEMORY ALLOCATED\" | awk '{ print $$7}'`;\\\n+       if [ \"$$MEM\" != \"\" ] ; then echo Using $$MEM bytes ; fi ; \\\n+       grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\";\\\n+       exit 0)\n@@ -983,5 +986,5 @@\n-\t-@($(top_builddir)\/xmllint --noout --timing --valid --repeat $(srcdir)\/test\/valid\/REC-xml-19980210.xml; \\\n-\t   MEM=`cat .memdump | grep \"MEMORY ALLOCATED\" | awk '{ print $$7}'`;\\\n-\t   if [ \"$$MEM\" != \"\" ] ; then echo Using $$MEM bytes ; fi ; \\\n-\t   grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\";\\\n-\t   exit 0)\n+    -@($(top_builddir)\/xmllint --noout --timing --valid --repeat $(srcdir)\/test\/valid\/REC-xml-19980210.xml; \\\n+       MEM=`cat .memdump | grep \"MEMORY ALLOCATED\" | awk '{ print $$7}'`;\\\n+       if [ \"$$MEM\" != \"\" ] ; then echo Using $$MEM bytes ; fi ; \\\n+       grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\";\\\n+       exit 0)\n@@ -990,27 +993,27 @@\n-\t@echo \"## C14N and XPath regression tests\"\n-\t-@(for m in with-comments without-comments 1-1-without-comments exc-without-comments ; do \\\n-\t    for i in $(srcdir)\/test\/c14n\/$$m\/*.xml ; do  \\\n-\t\tif [ ! -d $$i ] ; then \\\n-\t\t    name=`basename $$i .xml`; \\\n-\t\t    cmdline=\"$(CHECKER) $(top_builddir)\/testC14N --$$m $$i\"; \\\n-\t\t    if [ -f $(srcdir)\/test\/c14n\/$$m\/$$name.xpath ] ; then \\\n-\t\t\tcmdline=\"$$cmdline $(srcdir)\/test\/c14n\/$$m\/$$name.xpath\"; \\\n-\t\t\tif [ -f $(srcdir)\/test\/c14n\/$$m\/$$name.ns ] ; then \\\n-\t\t\t    cmdline=\"$$cmdline '`cat $(srcdir)\/test\/c14n\/$$m\/$$name.ns`'\"; \\\n-\t\t\tfi; \\\n-\t\t    fi; \\\n-\t\t    $$cmdline > $(srcdir)\/test\/c14n\/test.tmp 2> \/dev\/null; \\\n-\t\t    if [ $$? -eq 0 ]; then \\\n-\t\t\tdiff  $(srcdir)\/result\/c14n\/$$m\/$$name $(srcdir)\/test\/c14n\/test.tmp; \\\n-\t\t\tif [ $$? -ne 0 ]; then \\\n-\t\t\t    echo \"Test $$m\/$$name failed\"; \\\n-\t\t\t    cat $(srcdir)\/test\/c14n\/test.tmp; \\\n-\t\t\tfi; \\\n-\t\t    else \\\n-\t\t\techo \"C14N failed\"; \\\n-\t\t    fi; \\\n-\t\t    grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\";\\\n-\t\tfi; \\\n-\t\trm -f $(srcdir)\/test\/c14n\/test.tmp; \\\n-\t    done; \\\n-\tdone)\n+    @echo \"## C14N and XPath regression tests\"\n+    -@(for m in with-comments without-comments 1-1-without-comments exc-without-comments ; do \\\n+        for i in $(srcdir)\/test\/c14n\/$$m\/*.xml ; do  \\\n+        if [ ! -d $$i ] ; then \\\n+            name=`basename $$i .xml`; \\\n+            cmdline=\"$(CHECKER) $(top_builddir)\/testC14N --$$m $$i\"; \\\n+            if [ -f $(srcdir)\/test\/c14n\/$$m\/$$name.xpath ] ; then \\\n+            cmdline=\"$$cmdline $(srcdir)\/test\/c14n\/$$m\/$$name.xpath\"; \\\n+            if [ -f $(srcdir)\/test\/c14n\/$$m\/$$name.ns ] ; then \\\n+                cmdline=\"$$cmdline '`cat $(srcdir)\/test\/c14n\/$$m\/$$name.ns`'\"; \\\n+            fi; \\\n+            fi; \\\n+            $$cmdline > $(srcdir)\/test\/c14n\/test.tmp 2> \/dev\/null; \\\n+            if [ $$? -eq 0 ]; then \\\n+            diff  $(srcdir)\/result\/c14n\/$$m\/$$name $(srcdir)\/test\/c14n\/test.tmp; \\\n+            if [ $$? -ne 0 ]; then \\\n+                echo \"Test $$m\/$$name failed\"; \\\n+                cat $(srcdir)\/test\/c14n\/test.tmp; \\\n+            fi; \\\n+            else \\\n+            echo \"C14N failed\"; \\\n+            fi; \\\n+            grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\";\\\n+        fi; \\\n+        rm -f $(srcdir)\/test\/c14n\/test.tmp; \\\n+        done; \\\n+    done)\n@@ -1019,28 +1022,28 @@\n-\t@(echo > .memdump)\n-\t@echo \"## Schemas regression tests\"\n-\t-@(for i in $(srcdir)\/test\/schemas\/*_*.xsd ; do \\\n-\t  name=`basename $$i | sed 's+_.*++'`; \\\n-\t  sno=`basename $$i | sed 's+.*_\\(.*\\).xsd+\\1+'`; \\\n-\t  for j in $(srcdir)\/test\/schemas\/\"$$name\"_*.xml ; do \\\n-\t      if [ -f $$j ] ; then \\\n-\t      xno=`basename $$j | sed 's+.*_\\(.*\\).xml+\\1+'`; \\\n-\t      if [ ! -f $(srcdir)\/result\/schemas\/\"$$name\"_\"$$sno\"_\"$$xno\" ]; \\\n-\t      then \\\n-\t\t  echo New test file \"$$name\"_\"$$sno\"_\"$$xno\" ; \\\n-\t\t  $(CHECKER) $(top_builddir)\/testSchemas $$i $$j \\\n-\t\t    > $(srcdir)\/result\/schemas\/\"$$name\"_\"$$sno\"_\"$$xno\" \\\n-\t\t    2> $(srcdir)\/result\/schemas\/\"$$name\"_\"$$sno\"_\"$$xno\".err; \\\n-\t          grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\";\\\n-\t      else \\\n-\t          log=`$(CHECKER) $(top_builddir)\/testSchemas $$i $$j \\\n-\t\t    > res.$$name 2> err.$$name;\\\n-\t          grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\";\\\n-\t          diff $(srcdir)\/result\/schemas\/\"$$name\"_\"$$sno\"_\"$$xno\" \\\n-\t\t       res.$$name;\\\n-\t          diff $(srcdir)\/result\/schemas\/\"$$name\"_\"$$sno\"_\"$$xno\".err \\\n-\t\t       err.$$name;\\\n-\t\t  grep Unimplemented err.$$name`; \\\n-\t          if [ -n \"$$log\" ] ; then echo \"$$name\"_\"$$sno\"_\"$$xno\" result ; echo \"$$log\" ; fi ; \\\n-\t          rm res.$$name err.$$name ; \\\n-\t       fi ; fi ;\\\n-\t  done; done)\n+    @(echo > .memdump)\n+    @echo \"## Schemas regression tests\"\n+    -@(for i in $(srcdir)\/test\/schemas\/*_*.xsd ; do \\\n+      name=`basename $$i | sed 's+_.*++'`; \\\n+      sno=`basename $$i | sed 's+.*_\\(.*\\).xsd+\\1+'`; \\\n+      for j in $(srcdir)\/test\/schemas\/\"$$name\"_*.xml ; do \\\n+          if [ -f $$j ] ; then \\\n+          xno=`basename $$j | sed 's+.*_\\(.*\\).xml+\\1+'`; \\\n+          if [ ! -f $(srcdir)\/result\/schemas\/\"$$name\"_\"$$sno\"_\"$$xno\" ]; \\\n+          then \\\n+          echo New test file \"$$name\"_\"$$sno\"_\"$$xno\" ; \\\n+          $(CHECKER) $(top_builddir)\/testSchemas $$i $$j \\\n+            > $(srcdir)\/result\/schemas\/\"$$name\"_\"$$sno\"_\"$$xno\" \\\n+            2> $(srcdir)\/result\/schemas\/\"$$name\"_\"$$sno\"_\"$$xno\".err; \\\n+              grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\";\\\n+          else \\\n+              log=`$(CHECKER) $(top_builddir)\/testSchemas $$i $$j \\\n+            > res.$$name 2> err.$$name;\\\n+              grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\";\\\n+              diff $(srcdir)\/result\/schemas\/\"$$name\"_\"$$sno\"_\"$$xno\" \\\n+               res.$$name;\\\n+              diff $(srcdir)\/result\/schemas\/\"$$name\"_\"$$sno\"_\"$$xno\".err \\\n+               err.$$name;\\\n+          grep Unimplemented err.$$name`; \\\n+              if [ -n \"$$log\" ] ; then echo \"$$name\"_\"$$sno\"_\"$$xno\" result ; echo \"$$log\" ; fi ; \\\n+              rm res.$$name err.$$name ; \\\n+           fi ; fi ;\\\n+      done; done)\n@@ -1049,71 +1052,71 @@\n-\t@(echo > .memdump)\n-\t@echo \"## Relax-NG regression tests\"\n-\t-@(for i in $(srcdir)\/test\/relaxng\/*.rng ; do \\\n-\t  name=`basename $$i | sed 's+\\.rng++'`; \\\n-\t  if [ ! -f $(srcdir)\/result\/relaxng\/\"$$name\"_valid ] ; then \\\n-\t      echo New schemas $$name ; \\\n-\t      $(CHECKER) $(top_builddir)\/xmllint$(EXEEXT) --noout --relaxng $(srcdir)\/test\/relaxng\/tutorA.rng $$i \\\n-\t\t      > $(srcdir)\/result\/relaxng\/\"$$name\"_valid \\\n-\t\t      2> $(srcdir)\/result\/relaxng\/\"$$name\"_err; \\\n-\t      grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\";\\\n-\t  else \\\n-\t      log=`$(CHECKER) $(top_builddir)\/xmllint$(EXEEXT) --noout --relaxng $(srcdir)\/test\/relaxng\/tutorA.rng $$i \\\n-\t      > res.$$name 2> err.$$name;\\\n-\t      grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\";\\\n-\t      diff $(srcdir)\/result\/relaxng\/\"$$name\"_valid \\\n-\t\t   res.$$name;\\\n-\t      diff $(srcdir)\/result\/relaxng\/\"$$name\"_err \\\n-\t\t   err.$$name | grep -v \"error detected at\";\\\n-\t      grep Unimplemented err.$$name`; \\\n-\t      if [ -n \"$$log\" ] ; then echo schemas $$name result ; echo \"$$log\" ; fi ; \\\n-\t      rm res.$$name err.$$name ; \\\n-\t  fi; \\\n-\t  for j in $(srcdir)\/test\/relaxng\/\"$$name\"_*.xml ; do \\\n-\t      if [ -f $$j ] ; then \\\n-\t      xno=`basename $$j | sed 's+.*_\\(.*\\).xml+\\1+'`; \\\n-\t      if [ ! -f $(srcdir)\/result\/relaxng\/\"$$name\"_\"$$xno\" ]; \\\n-\t      then \\\n-\t\t  echo New test file \"$$name\"_\"$$xno\" ; \\\n-\t\t  $(CHECKER) $(top_builddir)\/xmllint$(EXEEXT) --noout --relaxng $$i $$j \\\n-\t\t    > $(srcdir)\/result\/relaxng\/\"$$name\"_\"$$xno\" \\\n-\t\t    2> $(srcdir)\/result\/relaxng\/\"$$name\"_\"$$xno\".err; \\\n-\t          grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\";\\\n-\t      else \\\n-\t          log=`$(CHECKER) $(top_builddir)\/xmllint$(EXEEXT) --noout --relaxng $$i $$j \\\n-\t\t    > res.$$name 2> err.$$name;\\\n-\t          grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\";\\\n-\t          diff $(srcdir)\/result\/relaxng\/\"$$name\"_\"$$xno\" \\\n-\t\t       res.$$name;\\\n-\t          diff $(srcdir)\/result\/relaxng\/\"$$name\"_\"$$xno\".err \\\n-\t\t       err.$$name | grep -v \"error detected at\";\\\n-\t\t  grep Unimplemented err.$$name`; \\\n-\t\t  if [ -n \"$$log\" ] ; then echo \"$$name\"_\"$$xno\" result ; echo \"$$log\" ; fi ; \\\n-\t          rm res.$$name err.$$name ; \\\n-\t       fi ; fi ; \\\n-\t  done; done)\n-\t@echo \"## Relax-NG streaming regression tests\"\n-\t-@(for i in $(srcdir)\/test\/relaxng\/*.rng ; do \\\n-\t  name=`basename $$i | sed 's+\\.rng++'`; \\\n-\t  for j in $(srcdir)\/test\/relaxng\/\"$$name\"_*.xml ; do \\\n-\t      if [ -f $$j ] ; then \\\n-\t      xno=`basename $$j | sed 's+.*_\\(.*\\).xml+\\1+'`; \\\n-\t      if [ ! -f $(srcdir)\/result\/relaxng\/\"$$name\"_\"$$xno\" ]; \\\n-\t      then \\\n-\t\t  echo New test file \"$$name\"_\"$$xno\" ; \\\n-\t\t  $(CHECKER) $(top_builddir)\/xmllint$(EXEEXT) --noout --relaxng $$i $$j \\\n-\t\t    > $(srcdir)\/result\/relaxng\/\"$$name\"_\"$$xno\" \\\n-\t\t    2> $(srcdir)\/result\/relaxng\/\"$$name\"_\"$$xno\".err; \\\n-\t          grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\";\\\n-\t      else \\\n-\t          log=`$(CHECKER) $(top_builddir)\/xmllint$(EXEEXT) --noout --stream --relaxng $$i $$j \\\n-\t\t    > res.$$name 2> err.$$name;\\\n-\t          grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\";\\\n-\t          diff $(srcdir)\/result\/relaxng\/\"$$name\"_\"$$xno\" res.$$name;\\\n-\t\t  if [ \"$$name\" != \"tutor10_1\" -a \"$$name\" != \"tutor10_2\" -a \"$$name\" != \"tutor3_2\" -a \"$$name\" != \"307377\" -a \"$$name\" != \"tutor8_2\" ] ; then \\\n-\t\t      diff $(srcdir)\/result\/relaxng\/\"$$name\"_\"$$xno\".err \\\n-\t\t\t   err.$$name | grep -v \"error detected at\";\\\n-\t\t  fi ; grep Unimplemented err.$$name`; \\\n-\t          if [ -n \"$$log\" ] ; then echo \"$$name\"_\"$$xno\" result ; echo \"$$log\" ; fi ; \\\n-\t          rm res.$$name err.$$name ; \\\n-\t       fi ; fi ; \\\n-\t  done; done)\n+    @(echo > .memdump)\n+    @echo \"## Relax-NG regression tests\"\n+    -@(for i in $(srcdir)\/test\/relaxng\/*.rng ; do \\\n+      name=`basename $$i | sed 's+\\.rng++'`; \\\n+      if [ ! -f $(srcdir)\/result\/relaxng\/\"$$name\"_valid ] ; then \\\n+          echo New schemas $$name ; \\\n+          $(CHECKER) $(top_builddir)\/xmllint$(EXEEXT) --noout --relaxng $(srcdir)\/test\/relaxng\/tutorA.rng $$i \\\n+              > $(srcdir)\/result\/relaxng\/\"$$name\"_valid \\\n+              2> $(srcdir)\/result\/relaxng\/\"$$name\"_err; \\\n+          grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\";\\\n+      else \\\n+          log=`$(CHECKER) $(top_builddir)\/xmllint$(EXEEXT) --noout --relaxng $(srcdir)\/test\/relaxng\/tutorA.rng $$i \\\n+          > res.$$name 2> err.$$name;\\\n+          grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\";\\\n+          diff $(srcdir)\/result\/relaxng\/\"$$name\"_valid \\\n+           res.$$name;\\\n+          diff $(srcdir)\/result\/relaxng\/\"$$name\"_err \\\n+           err.$$name | grep -v \"error detected at\";\\\n+          grep Unimplemented err.$$name`; \\\n+          if [ -n \"$$log\" ] ; then echo schemas $$name result ; echo \"$$log\" ; fi ; \\\n+          rm res.$$name err.$$name ; \\\n+      fi; \\\n+      for j in $(srcdir)\/test\/relaxng\/\"$$name\"_*.xml ; do \\\n+          if [ -f $$j ] ; then \\\n+          xno=`basename $$j | sed 's+.*_\\(.*\\).xml+\\1+'`; \\\n+          if [ ! -f $(srcdir)\/result\/relaxng\/\"$$name\"_\"$$xno\" ]; \\\n+          then \\\n+          echo New test file \"$$name\"_\"$$xno\" ; \\\n+          $(CHECKER) $(top_builddir)\/xmllint$(EXEEXT) --noout --relaxng $$i $$j \\\n+            > $(srcdir)\/result\/relaxng\/\"$$name\"_\"$$xno\" \\\n+            2> $(srcdir)\/result\/relaxng\/\"$$name\"_\"$$xno\".err; \\\n+              grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\";\\\n+          else \\\n+              log=`$(CHECKER) $(top_builddir)\/xmllint$(EXEEXT) --noout --relaxng $$i $$j \\\n+            > res.$$name 2> err.$$name;\\\n+              grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\";\\\n+              diff $(srcdir)\/result\/relaxng\/\"$$name\"_\"$$xno\" \\\n+               res.$$name;\\\n+              diff $(srcdir)\/result\/relaxng\/\"$$name\"_\"$$xno\".err \\\n+               err.$$name | grep -v \"error detected at\";\\\n+          grep Unimplemented err.$$name`; \\\n+          if [ -n \"$$log\" ] ; then echo \"$$name\"_\"$$xno\" result ; echo \"$$log\" ; fi ; \\\n+              rm res.$$name err.$$name ; \\\n+           fi ; fi ; \\\n+      done; done)\n+    @echo \"## Relax-NG streaming regression tests\"\n+    -@(for i in $(srcdir)\/test\/relaxng\/*.rng ; do \\\n+      name=`basename $$i | sed 's+\\.rng++'`; \\\n+      for j in $(srcdir)\/test\/relaxng\/\"$$name\"_*.xml ; do \\\n+          if [ -f $$j ] ; then \\\n+          xno=`basename $$j | sed 's+.*_\\(.*\\).xml+\\1+'`; \\\n+          if [ ! -f $(srcdir)\/result\/relaxng\/\"$$name\"_\"$$xno\" ]; \\\n+          then \\\n+          echo New test file \"$$name\"_\"$$xno\" ; \\\n+          $(CHECKER) $(top_builddir)\/xmllint$(EXEEXT) --noout --relaxng $$i $$j \\\n+            > $(srcdir)\/result\/relaxng\/\"$$name\"_\"$$xno\" \\\n+            2> $(srcdir)\/result\/relaxng\/\"$$name\"_\"$$xno\".err; \\\n+              grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\";\\\n+          else \\\n+              log=`$(CHECKER) $(top_builddir)\/xmllint$(EXEEXT) --noout --stream --relaxng $$i $$j \\\n+            > res.$$name 2> err.$$name;\\\n+              grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\";\\\n+              diff $(srcdir)\/result\/relaxng\/\"$$name\"_\"$$xno\" res.$$name;\\\n+          if [ \"$$name\" != \"tutor10_1\" -a \"$$name\" != \"tutor10_2\" -a \"$$name\" != \"tutor3_2\" -a \"$$name\" != \"307377\" -a \"$$name\" != \"tutor8_2\" ] ; then \\\n+              diff $(srcdir)\/result\/relaxng\/\"$$name\"_\"$$xno\".err \\\n+               err.$$name | grep -v \"error detected at\";\\\n+          fi ; grep Unimplemented err.$$name`; \\\n+              if [ -n \"$$log\" ] ; then echo \"$$name\"_\"$$xno\" result ; echo \"$$log\" ; fi ; \\\n+              rm res.$$name err.$$name ; \\\n+           fi ; fi ; \\\n+      done; done)\n@@ -1122,27 +1125,27 @@\n-\t@(echo > .memdump)\n-\t@echo \"## Schematron regression tests\"\n-\t-@(for i in $(srcdir)\/test\/schematron\/*.sct ; do \\\n-\t  name=`basename $$i | sed 's+\\.sct++'`; \\\n-\t  for j in $(srcdir)\/test\/schematron\/\"$$name\"_*.xml ; do \\\n-\t      if [ -f $$j ] ; then \\\n-\t      xno=`basename $$j | sed 's+.*_\\(.*\\).xml+\\1+'`; \\\n-\t      if [ ! -f $(srcdir)\/result\/schematron\/\"$$name\"_\"$$xno\" ]; \\\n-\t      then \\\n-\t\t  echo New test file \"$$name\"_\"$$xno\" ; \\\n-\t\t  $(CHECKER) $(top_builddir)\/xmllint$(EXEEXT) --schematron $$i $$j \\\n-\t\t    > $(srcdir)\/result\/schematron\/\"$$name\"_\"$$xno\" \\\n-\t\t    2> $(srcdir)\/result\/schematron\/\"$$name\"_\"$$xno\".err; \\\n-\t          grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\";\\\n-\t      else \\\n-\t          log=`$(CHECKER) $(top_builddir)\/xmllint$(EXEEXT) --schematron $$i $$j \\\n-\t\t    > res.$$name 2> err.$$name;\\\n-\t          grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\";\\\n-\t          diff $(srcdir)\/result\/schematron\/\"$$name\"_\"$$xno\" \\\n-\t\t       res.$$name;\\\n-\t          diff $(srcdir)\/result\/schematron\/\"$$name\"_\"$$xno\".err \\\n-\t\t       err.$$name | grep -v \"error detected at\";\\\n-\t\t  grep Unimplemented err.$$name`; \\\n-\t\t  if [ -n \"$$log\" ] ; then echo \"$$name\"_\"$$xno\" result ; echo \"$$log\" ; fi ; \\\n-\t          rm res.$$name err.$$name ; \\\n-\t       fi ; fi ; \\\n-\t  done; done)\n+    @(echo > .memdump)\n+    @echo \"## Schematron regression tests\"\n+    -@(for i in $(srcdir)\/test\/schematron\/*.sct ; do \\\n+      name=`basename $$i | sed 's+\\.sct++'`; \\\n+      for j in $(srcdir)\/test\/schematron\/\"$$name\"_*.xml ; do \\\n+          if [ -f $$j ] ; then \\\n+          xno=`basename $$j | sed 's+.*_\\(.*\\).xml+\\1+'`; \\\n+          if [ ! -f $(srcdir)\/result\/schematron\/\"$$name\"_\"$$xno\" ]; \\\n+          then \\\n+          echo New test file \"$$name\"_\"$$xno\" ; \\\n+          $(CHECKER) $(top_builddir)\/xmllint$(EXEEXT) --schematron $$i $$j \\\n+            > $(srcdir)\/result\/schematron\/\"$$name\"_\"$$xno\" \\\n+            2> $(srcdir)\/result\/schematron\/\"$$name\"_\"$$xno\".err; \\\n+              grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\";\\\n+          else \\\n+              log=`$(CHECKER) $(top_builddir)\/xmllint$(EXEEXT) --schematron $$i $$j \\\n+            > res.$$name 2> err.$$name;\\\n+              grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\";\\\n+              diff $(srcdir)\/result\/schematron\/\"$$name\"_\"$$xno\" \\\n+               res.$$name;\\\n+              diff $(srcdir)\/result\/schematron\/\"$$name\"_\"$$xno\".err \\\n+               err.$$name | grep -v \"error detected at\";\\\n+          grep Unimplemented err.$$name`; \\\n+          if [ -n \"$$log\" ] ; then echo \"$$name\"_\"$$xno\" result ; echo \"$$log\" ; fi ; \\\n+              rm res.$$name err.$$name ; \\\n+           fi ; fi ; \\\n+      done; done)\n@@ -1151,10 +1154,10 @@\n-\t@(if [ -x $(PYTHON) ] ; then \\\n-\t    PYTHONPATH=$(top_builddir)\/python:$(top_builddir)\/python\/.libs:$$PYTHONPATH ; \\\n-\t    export PYTHONPATH; \\\n-\t    LD_LIBRARY_PATH=\"$(top_builddir)\/.libs:$$LD_LIBRARY_PATH\" ; \\\n-\t    export LD_LIBRARY_PATH; \\\n-\t    echo \"## Relax-NG Python based test suite 1\" ; \\\n-\t    $(CHECKER) $(PYTHON) $(srcdir)\/check-relaxng-test-suite.py ; \\\n-\t    echo \"## Relax-NG Python based test suite 2\" ; \\\n-\t    $(CHECKER) $(PYTHON) $(srcdir)\/check-relaxng-test-suite2.py ; \\\n-\t  fi)\n+    @(if [ -x $(PYTHON) ] ; then \\\n+        PYTHONPATH=$(top_builddir)\/python:$(top_builddir)\/python\/.libs:$$PYTHONPATH ; \\\n+        export PYTHONPATH; \\\n+        LD_LIBRARY_PATH=\"$(top_builddir)\/.libs:$$LD_LIBRARY_PATH\" ; \\\n+        export LD_LIBRARY_PATH; \\\n+        echo \"## Relax-NG Python based test suite 1\" ; \\\n+        $(CHECKER) $(PYTHON) $(srcdir)\/check-relaxng-test-suite.py ; \\\n+        echo \"## Relax-NG Python based test suite 2\" ; \\\n+        $(CHECKER) $(PYTHON) $(srcdir)\/check-relaxng-test-suite2.py ; \\\n+      fi)\n@@ -1163,10 +1166,10 @@\n-\t@(if [ -x $(PYTHON) ] ; then \\\n-\t    PYTHONPATH=$(top_builddir)\/python:$(top_builddir)\/python\/.libs:$$PYTHONPATH; \\\n-\t    export PYTHONPATH; \\\n-\t    LD_LIBRARY_PATH=\"$(top_builddir)\/.libs:$$LD_LIBRARY_PATH\" ; \\\n-\t    export LD_LIBRARY_PATH; \\\n-\t    echo \"## XML Schemas datatypes Python based test suite\" ; \\\n-\t    echo \"## It is normal to see 11 errors reported\" ; \\\n-\t    $(CHECKER) $(PYTHON) $(srcdir)\/check-xsddata-test-suite.py ; \\\n-\t  fi)\n-\t@(if [ -x $(PYTHON) -a -d xstc ] ; then cd xstc ; $(MAKE) CHECKER=\"$(CHECKER)\" pytests ; fi)\n+    @(if [ -x $(PYTHON) ] ; then \\\n+        PYTHONPATH=$(top_builddir)\/python:$(top_builddir)\/python\/.libs:$$PYTHONPATH; \\\n+        export PYTHONPATH; \\\n+        LD_LIBRARY_PATH=\"$(top_builddir)\/.libs:$$LD_LIBRARY_PATH\" ; \\\n+        export LD_LIBRARY_PATH; \\\n+        echo \"## XML Schemas datatypes Python based test suite\" ; \\\n+        echo \"## It is normal to see 11 errors reported\" ; \\\n+        $(CHECKER) $(PYTHON) $(srcdir)\/check-xsddata-test-suite.py ; \\\n+      fi)\n+    @(if [ -x $(PYTHON) -a -d xstc ] ; then cd xstc ; $(MAKE) CHECKER=\"$(CHECKER)\" pytests ; fi)\n@@ -1175,22 +1178,22 @@\n-\t@(echo > .memdump)\n-\t@echo \"## Pattern regression tests\"\n-\t-@(for i in $(srcdir)\/test\/pattern\/*.pat ; do \\\n-\t  name=`basename $$i .pat`; \\\n-\t  if [ -f $(srcdir)\/test\/pattern\/$$name.xml ] ; then \\\n-\t  if [ ! -f $(srcdir)\/result\/pattern\/$$name ] ; then \\\n-\t      rm -f result.$$name ; \\\n-\t      echo New test file $$name ; \\\n-\t      for pat in `cat $$i` ; do \\\n-\t      $(CHECKER) $(top_builddir)\/xmllint --walker --pattern $$pat $(srcdir)\/test\/pattern\/$$name.xml >> $(srcdir)\/result\/pattern\/$$name ; \\\n-\t      grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\";\\\n-\t      done ;\\\n-\t  else \\\n-\t      rm -f result.$$name ; \\\n-\t      lst=`cat $$i` ; \\\n-\t      log=`for pat in $$lst ; do $(CHECKER) $(top_builddir)\/xmllint --walker --pattern $$pat $(srcdir)\/test\/pattern\/$$name.xml 2>&1 >> result.$$name ; \\\n-\t      grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\";\\\n-\t      done ;\\\n-\t      diff $(srcdir)\/result\/pattern\/$$name result.$$name` ; \\\n-\t      if [ -n \"$$log\" ] ; then echo $$name result ; echo \"$$log\" ; fi ; \\\n-\t      rm result.$$name ; \\\n-\t  fi ; fi ; done ;)\n+    @(echo > .memdump)\n+    @echo \"## Pattern regression tests\"\n+    -@(for i in $(srcdir)\/test\/pattern\/*.pat ; do \\\n+      name=`basename $$i .pat`; \\\n+      if [ -f $(srcdir)\/test\/pattern\/$$name.xml ] ; then \\\n+      if [ ! -f $(srcdir)\/result\/pattern\/$$name ] ; then \\\n+          rm -f result.$$name ; \\\n+          echo New test file $$name ; \\\n+          for pat in `cat $$i` ; do \\\n+          $(CHECKER) $(top_builddir)\/xmllint --walker --pattern $$pat $(srcdir)\/test\/pattern\/$$name.xml >> $(srcdir)\/result\/pattern\/$$name ; \\\n+          grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\";\\\n+          done ;\\\n+      else \\\n+          rm -f result.$$name ; \\\n+          lst=`cat $$i` ; \\\n+          log=`for pat in $$lst ; do $(CHECKER) $(top_builddir)\/xmllint --walker --pattern $$pat $(srcdir)\/test\/pattern\/$$name.xml 2>&1 >> result.$$name ; \\\n+          grep \"MORY ALLO\" .memdump  | grep -v \"MEMORY ALLOCATED : 0\";\\\n+          done ;\\\n+          diff $(srcdir)\/result\/pattern\/$$name result.$$name` ; \\\n+          if [ -n \"$$log\" ] ; then echo $$name result ; echo \"$$log\" ; fi ; \\\n+          rm result.$$name ; \\\n+      fi ; fi ; done ;)\n@@ -1199,2 +1202,2 @@\n-\t@echo \"## Module tests\"\n-\t@(.\/testModule$(EXEEXT))\n+    @echo \"## Module tests\"\n+    @(.\/testModule$(EXEEXT))\n@@ -1203,3 +1206,3 @@\n-\t-@(find . -name .\\#\\* -exec rm {} \\;)\n-\t-@(find . -name \\*.gcda -o -name \\*.gcno -exec rm -f {} \\;)\n-\t-@(find . -name \\*.orig -o -name \\*.rej -o -name \\*.old -exec rm -f {} \\;)\n+    -@(find . -name .\\#\\* -exec rm {} \\;)\n+    -@(find . -name \\*.gcda -o -name \\*.gcno -exec rm -f {} \\;)\n+    -@(find . -name \\*.orig -o -name \\*.rej -o -name \\*.old -exec rm -f {} \\;)\n@@ -1208,2 +1211,2 @@\n-\t-cp libxml2.spec $(distdir)\n-\t(cd $(srcdir) ; tar -cf - --exclude CVS --exclude .svn --exclude .git win32 macos os400 vms VxWorks bakefile test result) | (cd $(distdir); tar xf -)\n+    -cp libxml2.spec $(distdir)\n+    (cd $(srcdir) ; tar -cf - --exclude CVS --exclude .svn --exclude .git win32 macos os400 vms VxWorks bakefile test result) | (cd $(distdir); tar xf -)\n@@ -1212,1 +1215,1 @@\n-\t$(AMTAR) -chof - --exclude Tests --exclude test --exclude result $(distdir) | GZIP=$(GZIP_ENV) gzip -c >`echo \"$(distdir)\" | sed \"s+libxml2+libxml2-sources+\"`.tar.gz\n+    $(AMTAR) -chof - --exclude Tests --exclude test --exclude result $(distdir) | GZIP=$(GZIP_ENV) gzip -c >`echo \"$(distdir)\" | sed \"s+libxml2+libxml2-sources+\"`.tar.gz\n@@ -1215,4 +1218,4 @@\n-\t(mkdir -p $(distdir))\n-\t(cd $(srcdir) ; tar -cf - --exclude CVS --exclude .svn --exclude .git xstc\/Tests) | (cd $(distdir); tar xf -)\n-\ttar -cf - $(distdir)\/test $(distdir)\/result $(distdir)\/xstc\/Tests  $(distdir)\/Makefile.tests $(distdir)\/README $(distdir)\/README.tests $(distdir)\/AUTHORS $(distdir)\/testapi.c $(distdir)\/runtest.c $(distdir)\/runsuite.c | GZIP=$(GZIP_ENV) gzip -c >`echo \"$(distdir)\" | sed \"s+libxml2+libxml2-tests+\"`.tar.gz\n-\t@(rm -rf $(distdir)\/xstc\/Test)\n+    (mkdir -p $(distdir))\n+    (cd $(srcdir) ; tar -cf - --exclude CVS --exclude .svn --exclude .git xstc\/Tests) | (cd $(distdir); tar xf -)\n+    tar -cf - $(distdir)\/test $(distdir)\/result $(distdir)\/xstc\/Tests  $(distdir)\/Makefile.tests $(distdir)\/README $(distdir)\/README.tests $(distdir)\/AUTHORS $(distdir)\/testapi.c $(distdir)\/runtest.c $(distdir)\/runsuite.c | GZIP=$(GZIP_ENV) gzip -c >`echo \"$(distdir)\" | sed \"s+libxml2+libxml2-tests+\"`.tar.gz\n+    @(rm -rf $(distdir)\/xstc\/Test)\n@@ -1221,1 +1224,1 @@\n-\t@(rm -f libxml*.tar.gz COPYING.LIB)\n+    @(rm -f libxml*.tar.gz COPYING.LIB)\n@@ -1224,1 +1227,1 @@\n-\t@(unset CDPATH ; $(MAKE) dist-source dist && rpmbuild -ta $(distdir).tar.gz)\n+    @(unset CDPATH ; $(MAKE) dist-source dist && rpmbuild -ta $(distdir).tar.gz)\n@@ -1233,7 +1236,7 @@\n-\tsed -e 's?\\@XML_LIBDIR\\@?$(XML_LIBDIR)?g' \\\n-\t    -e 's?\\@XML_INCLUDEDIR\\@?$(XML_INCLUDEDIR)?g' \\\n-\t    -e 's?\\@VERSION\\@?$(VERSION)?g' \\\n-\t    -e 's?\\@XML_LIBS\\@?$(XML_LIBS)?g' \\\n-\t    -e 's?\\@XML_PRIVATE_LIBS\\@?$(XML_PRIVATE_LIBS)?g' \\\n-\t       < $(srcdir)\/xml2Conf.sh.in > xml2Conf.tmp \\\n-\t&& mv xml2Conf.tmp xml2Conf.sh\n+    sed -e 's?\\@XML_LIBDIR\\@?$(XML_LIBDIR)?g' \\\n+        -e 's?\\@XML_INCLUDEDIR\\@?$(XML_INCLUDEDIR)?g' \\\n+        -e 's?\\@VERSION\\@?$(VERSION)?g' \\\n+        -e 's?\\@XML_LIBS\\@?$(XML_LIBS)?g' \\\n+        -e 's?\\@XML_PRIVATE_LIBS\\@?$(XML_PRIVATE_LIBS)?g' \\\n+           < $(srcdir)\/xml2Conf.sh.in > xml2Conf.tmp \\\n+    && mv xml2Conf.tmp xml2Conf.sh\n@@ -1249,2 +1252,2 @@\n-\t     check-relaxng-test-suite.py check-relaxng-test-suite2.py \\\n-\t     check-xsddata-test-suite.py check-xinclude-test-suite.py \\\n+         check-relaxng-test-suite.py check-relaxng-test-suite2.py \\\n+         check-xsddata-test-suite.py check-xinclude-test-suite.py \\\n@@ -1252,9 +1255,10 @@\n-\t     $(man_MANS) libxml-2.0.pc.in libxml-2.0-uninstalled.pc.in \\\n-\t     libxml2-config.cmake.in autogen.sh \\\n-\t     trionan.c trionan.h triostr.c triostr.h trio.c trio.h \\\n-\t     triop.h triodef.h libxml.h elfgcchack.h xzlib.h buf.h \\\n-\t     enc.h save.h genUnicode.py TODO_SCHEMAS \\\n-\t     dbgen.pl dbgenattr.pl regressions.py regressions.xml \\\n-\t     README.tests Makefile.tests libxml2.syms timsort.h \\\n-\t     README.zOS \\\n-\t     $(CVS_EXTRA_DIST)\n+         $(man_MANS) libxml-2.0.pc.in libxml-2.0-uninstalled.pc.in \\\n+         libxml2-config.cmake.in autogen.sh \\\n+         trionan.c trionan.h triostr.c triostr.h trio.c trio.h \\\n+         triop.h triodef.h libxml.h elfgcchack.h xzlib.h buf.h \\\n+         enc.h save.h genUnicode.py TODO_SCHEMAS \\\n+         dbgen.pl dbgenattr.pl regressions.py regressions.xml \\\n+         README.tests Makefile.tests libxml2.syms timsort.h \\\n+         README.zOS \\\n+         CMakeLists.txt config.h.cmake.in libxml2-config.cmake.cmake.in \\\n+         $(CVS_EXTRA_DIST)\n@@ -1270,1 +1274,1 @@\n-# Install the tests program sources as examples \n+# Install the tests program sources as examples\n@@ -1276,8 +1280,8 @@\n-install-data-local: \n-\t$(MKDIR_P) $(DESTDIR)$(BASE_DIR)\/$(DOC_MODULE)\n-\t-$(INSTALL) -m 0644 $(srcdir)\/Copyright $(DESTDIR)$(BASE_DIR)\/$(DOC_MODULE)\n-\t$(MKDIR_P) $(DESTDIR)$(EXAMPLES_DIR)\n-\t-$(INSTALL) -m 0644 $(srcdir)\/xmllint.c $(DESTDIR)$(EXAMPLES_DIR)\n-\t-$(INSTALL) -m 0644 $(srcdir)\/testSAX.c $(DESTDIR)$(EXAMPLES_DIR)\n-\t-$(INSTALL) -m 0644 $(srcdir)\/testHTML.c $(DESTDIR)$(EXAMPLES_DIR)\n-\t-$(INSTALL) -m 0644 $(srcdir)\/testXPath.c $(DESTDIR)$(EXAMPLES_DIR)\n+install-data-local:\n+    $(MKDIR_P) $(DESTDIR)$(BASE_DIR)\/$(DOC_MODULE)\n+    -$(INSTALL) -m 0644 $(srcdir)\/Copyright $(DESTDIR)$(BASE_DIR)\/$(DOC_MODULE)\n+    $(MKDIR_P) $(DESTDIR)$(EXAMPLES_DIR)\n+    -$(INSTALL) -m 0644 $(srcdir)\/xmllint.c $(DESTDIR)$(EXAMPLES_DIR)\n+    -$(INSTALL) -m 0644 $(srcdir)\/testSAX.c $(DESTDIR)$(EXAMPLES_DIR)\n+    -$(INSTALL) -m 0644 $(srcdir)\/testHTML.c $(DESTDIR)$(EXAMPLES_DIR)\n+    -$(INSTALL) -m 0644 $(srcdir)\/testXPath.c $(DESTDIR)$(EXAMPLES_DIR)\n@@ -1286,7 +1290,7 @@\n-\trm -f $(DESTDIR)$(EXAMPLES_DIR)\/testXPath.c\n-\trm -f $(DESTDIR)$(EXAMPLES_DIR)\/testHTML.c\n-\trm -f $(DESTDIR)$(EXAMPLES_DIR)\/testSAX.c\n-\trm -f $(DESTDIR)$(EXAMPLES_DIR)\/xmllint.c\n-\trm -rf $(DESTDIR)$(EXAMPLES_DIR)\n-\trm -f $(DESTDIR)$(BASE_DIR)\/$(DOC_MODULE)\/Copyright\n-\trm -rf $(DESTDIR)$(BASE_DIR)\/$(DOC_MODULE)\n+    rm -f $(DESTDIR)$(EXAMPLES_DIR)\/testXPath.c\n+    rm -f $(DESTDIR)$(EXAMPLES_DIR)\/testHTML.c\n+    rm -f $(DESTDIR)$(EXAMPLES_DIR)\/testSAX.c\n+    rm -f $(DESTDIR)$(EXAMPLES_DIR)\/xmllint.c\n+    rm -rf $(DESTDIR)$(EXAMPLES_DIR)\n+    rm -f $(DESTDIR)$(BASE_DIR)\/$(DOC_MODULE)\/Copyright\n+    rm -rf $(DESTDIR)$(BASE_DIR)\/$(DOC_MODULE)\n@@ -1295,1 +1299,1 @@\n-\t$(CC) $(CFLAGS) -Iinclude -o tst tst.c .libs\/libxml2.a -lpthread -lm -lz -llzma\n+    $(CC) $(CFLAGS) -Iinclude -o tst tst.c .libs\/libxml2.a -lpthread -lm -lz -llzma\n@@ -1298,1 +1302,1 @@\n-\t$(MAKE) CC=cgcc\n+    $(MAKE) CC=cgcc\n@@ -1308,12 +1312,12 @@\n-\tif [ \"`echo $(LDFLAGS) | grep coverage`\" = \"\" ] ; then \\\n-\t    echo not configured with coverage; exit 1 ; fi\n-\tif [ ! -x $(LCOV) -o ! -x $(GENHTML) ] ; then \\\n-\t    echo Need $(LCOV) and $(GENHTML) excecutables; exit 1 ; fi\n-\t-@($(MAKE) check)\n-\t-@(.\/runsuite$(EXEEXT))\n-\tmkdir $(top_builddir)\/coverage\n-\t$(LCOV) -c -o $(top_builddir)\/coverage\/libxml2.info.tmp -d $(top_srcdir)\n-\t$(LCOV) -r $(top_builddir)\/coverage\/libxml2.info.tmp -o $(top_builddir)\/coverage\/libxml2.info *usr*\n-\trm $(top_builddir)\/coverage\/libxml2.info.tmp\n-\t$(GENHTML) -s -t \"libxml2\" -o $(top_builddir)\/coverage --legend $(top_builddir)\/coverage\/libxml2.info\n-\techo \"Coverage report is in $(top_builddir)\/coverage\/index.html\"\n+    if [ \"`echo $(LDFLAGS) | grep coverage`\" = \"\" ] ; then \\\n+        echo not configured with coverage; exit 1 ; fi\n+    if [ ! -x $(LCOV) -o ! -x $(GENHTML) ] ; then \\\n+        echo Need $(LCOV) and $(GENHTML) excecutables; exit 1 ; fi\n+    -@($(MAKE) check)\n+    -@(.\/runsuite$(EXEEXT))\n+    mkdir $(top_builddir)\/coverage\n+    $(LCOV) -c -o $(top_builddir)\/coverage\/libxml2.info.tmp -d $(top_srcdir)\n+    $(LCOV) -r $(top_builddir)\/coverage\/libxml2.info.tmp -o $(top_builddir)\/coverage\/libxml2.info *usr*\n+    rm $(top_builddir)\/coverage\/libxml2.info.tmp\n+    $(GENHTML) -s -t \"libxml2\" -o $(top_builddir)\/coverage --legend $(top_builddir)\/coverage\/libxml2.info\n+    echo \"Coverage report is in $(top_builddir)\/coverage\/index.html\"\n@@ -1322,1 +1326,1 @@\n-\trm -rf $(top_builddir)\/coverage\n+    rm -rf $(top_builddir)\/coverage\n","filename":"modules\/javafx.web\/src\/main\/native\/Source\/ThirdParty\/libxml\/src\/Makefile.am","additions":1025,"deletions":1021,"binary":false,"changes":2046,"status":"modified"},{"patch":"@@ -22,1 +22,1 @@\n-       the proper functionning of libxml2 main APIs while testapi does\n+       the proper functioning of libxml2 main APIs while testapi does\n","filename":"modules\/javafx.web\/src\/main\/native\/Source\/ThirdParty\/libxml\/src\/README","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -593,30 +593,0 @@\n-    if ((ret != NULL) &&\n-    ((ctxt->validate) || (ctxt->replaceEntities)) &&\n-    (ret->children == NULL) &&\n-    (ret->etype == XML_EXTERNAL_GENERAL_PARSED_ENTITY)) {\n-    int val;\n-\n-    \/*\n-     * for validation purposes we really need to fetch and\n-     * parse the external entity\n-     *\/\n-    xmlNodePtr children;\n-    unsigned long oldnbent = ctxt->nbentities;\n-\n-        val = xmlParseCtxtExternalEntity(ctxt, ret->URI,\n-                                 ret->ExternalID, &children);\n-    if (val == 0) {\n-        xmlAddChildList((xmlNodePtr) ret, children);\n-    } else {\n-        xmlFatalErrMsg(ctxt, XML_ERR_ENTITY_PROCESSING,\n-                   \"Failure to process entity %s\\n\", name, NULL);\n-        ctxt->validate = 0;\n-        return(NULL);\n-    }\n-    ret->owner = 1;\n-    if (ret->checked == 0) {\n-        ret->checked = (ctxt->nbentities - oldnbent + 1) * 2;\n-        if ((ret->content != NULL) && (xmlStrchr(ret->content, '<')))\n-            ret->checked |= 1;\n-    }\n-    }\n@@ -1696,16 +1666,0 @@\n-    \/*\n-     * Insert all the defaulted attributes from the DTD especially namespaces\n-     *\/\n-    if ((!ctxt->html) &&\n-    ((ctxt->myDoc->intSubset != NULL) ||\n-     (ctxt->myDoc->extSubset != NULL))) {\n-    xmlCheckDefaultedAttributes(ctxt, name, prefix, atts);\n-    }\n-\n-    \/*\n-     * process all the attributes whose name start with \"xmlns\"\n-     *\/\n-    if (atts != NULL) {\n-        i = 0;\n-    att = atts[i++];\n-    value = atts[i++];\n@@ -1713,0 +1667,16 @@\n+        \/*\n+         * Insert all the defaulted attributes from the DTD especially\n+         * namespaces\n+         *\/\n+        if ((ctxt->myDoc->intSubset != NULL) ||\n+            (ctxt->myDoc->extSubset != NULL)) {\n+            xmlCheckDefaultedAttributes(ctxt, name, prefix, atts);\n+        }\n+\n+        \/*\n+         * process all the attributes whose name start with \"xmlns\"\n+         *\/\n+        if (atts != NULL) {\n+            i = 0;\n+            att = atts[i++];\n+            value = atts[i++];\n@@ -1721,2 +1691,1 @@\n-    }\n-    }\n+        }\n@@ -1724,13 +1693,13 @@\n-    \/*\n-     * Search the namespace, note that since the attributes have been\n-     * processed, the local namespaces are available.\n-     *\/\n-    ns = xmlSearchNs(ctxt->myDoc, ret, prefix);\n-    if ((ns == NULL) && (parent != NULL))\n-    ns = xmlSearchNs(ctxt->myDoc, parent, prefix);\n-    if ((prefix != NULL) && (ns == NULL)) {\n-    ns = xmlNewNs(ret, NULL, prefix);\n-    xmlNsWarnMsg(ctxt, XML_NS_ERR_UNDEFINED_NAMESPACE,\n-             \"Namespace prefix %s is not defined\\n\",\n-             prefix, NULL);\n-    }\n+        \/*\n+         * Search the namespace, note that since the attributes have been\n+         * processed, the local namespaces are available.\n+         *\/\n+        ns = xmlSearchNs(ctxt->myDoc, ret, prefix);\n+        if ((ns == NULL) && (parent != NULL))\n+            ns = xmlSearchNs(ctxt->myDoc, parent, prefix);\n+        if ((prefix != NULL) && (ns == NULL)) {\n+            ns = xmlNewNs(ret, NULL, prefix);\n+            xmlNsWarnMsg(ctxt, XML_NS_ERR_UNDEFINED_NAMESPACE,\n+                         \"Namespace prefix %s is not defined\\n\",\n+                         prefix, NULL);\n+        }\n@@ -1738,7 +1707,8 @@\n-    \/*\n-     * set the namespace node, making sure that if the default namespace\n-     * is unbound on a parent we simply keep it NULL\n-     *\/\n-    if ((ns != NULL) && (ns->href != NULL) &&\n-    ((ns->href[0] != 0) || (ns->prefix != NULL)))\n-    xmlSetNs(ret, ns);\n+        \/*\n+         * set the namespace node, making sure that if the default namespace\n+         * is unbound on a parent we simply keep it NULL\n+         *\/\n+        if ((ns != NULL) && (ns->href != NULL) &&\n+            ((ns->href[0] != 0) || (ns->prefix != NULL)))\n+            xmlSetNs(ret, ns);\n+    }\n@@ -2206,1 +2176,1 @@\n- * It provides the namespace informations for the element, as well as\n+ * It provides the namespace information for the element, as well as\n@@ -2459,1 +2429,1 @@\n- * It provides the namespace informations for the element.\n+ * It provides the namespace information for the element.\n@@ -2526,1 +2496,1 @@\n- * xmlSAX2Characters:\n+ * xmlSAX2Text:\n@@ -2530,0 +2500,1 @@\n+ * @type: text or cdata\n@@ -2531,1 +2502,1 @@\n- * receiving some chars from the parser.\n+ * Append characters.\n@@ -2533,2 +2504,3 @@\n-void\n-xmlSAX2Characters(void *ctx, const xmlChar *ch, int len)\n+static void\n+xmlSAX2Text(xmlParserCtxtPtr ctxt, const xmlChar *ch, int len,\n+            xmlElementType type)\n@@ -2536,1 +2508,0 @@\n-    xmlParserCtxtPtr ctxt = (xmlParserCtxtPtr) ctx;\n@@ -2539,1 +2510,1 @@\n-    if (ctx == NULL) return;\n+    if (ctxt == NULL) return;\n@@ -2568,1 +2539,4 @@\n-        lastChild = xmlSAX2TextNode(ctxt, ch, len);\n+        if (type == XML_TEXT_NODE)\n+            lastChild = xmlSAX2TextNode(ctxt, ch, len);\n+        else\n+            lastChild = xmlNewCDataBlock(ctxt->myDoc, ch, len);\n@@ -2582,2 +2556,3 @@\n-        (lastChild->type == XML_TEXT_NODE) &&\n-        (lastChild->name == xmlStringText);\n+        (lastChild->type == type) &&\n+        ((type != XML_TEXT_NODE) ||\n+             (lastChild->name == xmlStringText));\n@@ -2640,1 +2615,4 @@\n-        lastChild = xmlSAX2TextNode(ctxt, ch, len);\n+            if (type == XML_TEXT_NODE)\n+                lastChild = xmlSAX2TextNode(ctxt, ch, len);\n+            else\n+                lastChild = xmlNewCDataBlock(ctxt->myDoc, ch, len);\n@@ -2652,0 +2630,14 @@\n+\/**\n+ * xmlSAX2Characters:\n+ * @ctx: the user data (XML parser context)\n+ * @ch:  a xmlChar string\n+ * @len: the number of xmlChar\n+ *\n+ * receiving some chars from the parser.\n+ *\/\n+void\n+xmlSAX2Characters(void *ctx, const xmlChar *ch, int len)\n+{\n+    xmlSAX2Text((xmlParserCtxtPtr) ctx, ch, len, XML_TEXT_NODE);\n+}\n+\n@@ -2808,21 +2800,1 @@\n-    xmlParserCtxtPtr ctxt = (xmlParserCtxtPtr) ctx;\n-    xmlNodePtr ret, lastChild;\n-\n-    if (ctx == NULL) return;\n-#ifdef DEBUG_SAX\n-    xmlGenericError(xmlGenericErrorContext,\n-        \"SAX.pcdata(%.10s, %d)\\n\", value, len);\n-#endif\n-    lastChild = xmlGetLastChild(ctxt->node);\n-#ifdef DEBUG_SAX_TREE\n-    xmlGenericError(xmlGenericErrorContext,\n-        \"add chars to %s \\n\", ctxt->node->name);\n-#endif\n-    if ((lastChild != NULL) &&\n-        (lastChild->type == XML_CDATA_SECTION_NODE)) {\n-    xmlTextConcat(lastChild, value, len);\n-    } else {\n-    ret = xmlNewCDataBlock(ctxt->myDoc, value, len);\n-    if (xmlAddChild(ctxt->node, ret) == NULL)\n-        xmlFreeNode(ret);\n-    }\n+    xmlSAX2Text((xmlParserCtxtPtr) ctx, value, len, XML_CDATA_SECTION_NODE);\n","filename":"modules\/javafx.web\/src\/main\/native\/Source\/ThirdParty\/libxml\/src\/SAX2.c","additions":73,"deletions":101,"binary":false,"changes":174,"status":"modified"},{"patch":"@@ -205,1 +205,1 @@\n-  => added some convertion routines provided by Martin Durst\n+  => added some conversion routines provided by Martin Durst\n@@ -215,1 +215,1 @@\n-   - make sure it is alled for all external entities referenced\n+   - make sure it is called for all external entities referenced\n@@ -248,2 +248,2 @@\n-  asbtraction of an input stream. A large part of the context is still\n-  located on the stack, moving to a state machine and putting everyting\n+  abstraction of an input stream. A large part of the context is still\n+  located on the stack, moving to a state machine and putting everything\n","filename":"modules\/javafx.web\/src\/main\/native\/Source\/ThirdParty\/libxml\/src\/TODO","additions":4,"deletions":4,"binary":false,"changes":8,"status":"modified"},{"patch":"@@ -86,1 +86,1 @@\n- * @extra:  extra informations\n+ * @extra:  extra information\n@@ -101,1 +101,1 @@\n- * @extra:  extra informations\n+ * @extra:  extra information\n","filename":"modules\/javafx.web\/src\/main\/native\/Source\/ThirdParty\/libxml\/src\/buf.c","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -3,0 +3,3 @@\n+\/* A form that will not confuse apibuild.py *\/\n+#undef ATTRIBUTE_DESTRUCTOR\n+\n@@ -12,0 +15,3 @@\n+\/* Define if __attribute__((destructor)) is accepted *\/\n+#undef HAVE_ATTRIBUTE_DESTRUCTOR\n+\n","filename":"modules\/javafx.web\/src\/main\/native\/Source\/ThirdParty\/libxml\/src\/config.h.in","additions":6,"deletions":0,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -3,1 +3,6 @@\n-AC_INIT\n+\n+m4_define([MAJOR_VERSION], 2)\n+m4_define([MINOR_VERSION], 9)\n+m4_define([MICRO_VERSION], 12)\n+\n+AC_INIT([libxml2],[MAJOR_VERSION.MINOR_VERSION.MICRO_VERSION])\n@@ -10,3 +15,3 @@\n-LIBXML_MAJOR_VERSION=2\n-LIBXML_MINOR_VERSION=9\n-LIBXML_MICRO_VERSION=10\n+LIBXML_MAJOR_VERSION=MAJOR_VERSION\n+LIBXML_MINOR_VERSION=MINOR_VERSION\n+LIBXML_MICRO_VERSION=MICRO_VERSION\n@@ -53,1 +58,1 @@\n-AM_INIT_AUTOMAKE(libxml2, $VERSION)\n+AM_INIT_AUTOMAKE([foreign])\n@@ -644,0 +649,11 @@\n+dnl Checking whether __attribute__((destructor)) is accepted by the compiler\n+AC_MSG_CHECKING([whether __attribute__((destructor)) is accepted])\n+AC_TRY_COMPILE2([\n+void __attribute__((destructor))\n+f(void) {}], [], [\n+  AC_MSG_RESULT(yes)\n+  AC_DEFINE([HAVE_ATTRIBUTE_DESTRUCTOR], [1],[Define if __attribute__((destructor)) is accepted])\n+  AC_DEFINE([ATTRIBUTE_DESTRUCTOR], [__attribute__((destructor))],[A form that will not confuse apibuild.py])],[\n+  AC_MSG_RESULT(no)])\n+\n+\n@@ -773,1 +789,1 @@\n-    # warnings we'd like to supress\n+    # warnings we'd like to suppress\n@@ -1506,2 +1522,2 @@\n-            AC_TRY_LINK([#include <unicode\/ucnv.h>],[\n-        UConverter *utf = ucnv_open(\"UTF-8\", NULL);],[\n+            AC_LINK_IFELSE([AC_LANG_PROGRAM([[#include <unicode\/ucnv.h>]], [[\n+        UConverter *utf = ucnv_open(\"UTF-8\", NULL);]])],[\n@@ -1518,2 +1534,2 @@\n-                AC_TRY_LINK([#include <unicode\/ucnv.h>],[\n-        UConverter *utf = ucnv_open(\"UTF-8\", NULL);],[\n+                AC_LINK_IFELSE([AC_LANG_PROGRAM([[#include <unicode\/ucnv.h>]], [[\n+        UConverter *utf = ucnv_open(\"UTF-8\", NULL);]])],[\n@@ -1629,1 +1645,1 @@\n-   WIN32_EXTRA_PYTHON_LIBADD=\"-L${pythondir}\/..\/..\/libs -lpython$(echo ${PYTHON_VERSION} | tr -d .)\"\n+       WIN32_EXTRA_PYTHON_LIBADD=\"-L${pythondir}\/..\/..\/libs -lpython$(echo ${PYTHON_VERSION} | tr -d .)\"\n@@ -1658,1 +1674,1 @@\n-dnl So do not redefine {v}snprintf to _{v}snprintf like follwing:\n+dnl So do not redefine {v}snprintf to _{v}snprintf like following:\n@@ -1707,1 +1723,1 @@\n-AC_CONFIG_FILES([libxml2.spec:libxml.spec.in Makefile include\/Makefile include\/libxml\/Makefile doc\/Makefile doc\/examples\/Makefile doc\/devhelp\/Makefile example\/Makefile python\/Makefile python\/tests\/Makefile xstc\/Makefile include\/libxml\/xmlversion.h libxml-2.0.pc libxml-2.0-uninstalled.pc libxml2-config.cmake])\n+AC_CONFIG_FILES([libxml2.spec:libxml.spec.in Makefile include\/Makefile include\/libxml\/Makefile doc\/Makefile doc\/examples\/Makefile doc\/devhelp\/Makefile example\/Makefile fuzz\/Makefile python\/Makefile python\/tests\/Makefile xstc\/Makefile include\/libxml\/xmlversion.h libxml-2.0.pc libxml-2.0-uninstalled.pc libxml2-config.cmake])\n","filename":"modules\/javafx.web\/src\/main\/native\/Source\/ThirdParty\/libxml\/src\/configure.ac","additions":29,"deletions":13,"binary":false,"changes":42,"status":"modified"},{"patch":"@@ -13,1 +13,1 @@\n- * MERCHANTIBILITY AND FITNESS FOR A PARTICULAR PURPOSE. THE AUTHORS AND\n+ * MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE. THE AUTHORS AND\n@@ -455,1 +455,1 @@\n-    value = *name;\n+    value += *name;\n","filename":"modules\/javafx.web\/src\/main\/native\/Source\/ThirdParty\/libxml\/src\/dict.c","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -79,1 +79,1 @@\n- * @extra:  extra informations\n+ * @extra:  extra information\n@@ -173,1 +173,1 @@\n- * The value of @outlen after return is the number of octets consumed.\n+ * The value of @outlen after return is the number of octets produced.\n@@ -220,1 +220,1 @@\n- * The value of @outlen after return is the number of octets consumed.\n+ * The value of @outlen after return is the number of octets produced.\n@@ -304,1 +304,1 @@\n- * The value of @outlen after return is the number of octets consumed.\n+ * The value of @outlen after return is the number of octets produced.\n@@ -376,0 +376,5 @@\n+    \/*\n+     * FIXME: Conversion functions must assure valid UTF-8, so we have\n+     * to check for UTF-8 validity. Preferably, this converter shouldn't\n+     * be used at all.\n+     *\/\n@@ -399,1 +404,1 @@\n- * The value of @outlen after return is the number of octets consumed.\n+ * The value of @outlen after return is the number of octets produced.\n@@ -499,1 +504,1 @@\n-    unsigned char* outend = out + *outlen;\n+    unsigned char* outend;\n@@ -506,0 +511,5 @@\n+    if (*outlen == 0) {\n+        *inlenb = 0;\n+        return(0);\n+    }\n+    outend = out + *outlen;\n@@ -1486,1 +1496,1 @@\n-    return;\n+        goto free_handler;\n@@ -1493,1 +1503,1 @@\n-    return;\n+        goto free_handler;\n@@ -1496,0 +1506,9 @@\n+    return;\n+\n+free_handler:\n+    if (handler != NULL) {\n+        if (handler->name != NULL) {\n+            xmlFree(handler->name);\n+        }\n+        xmlFree(handler);\n+    }\n@@ -1787,1 +1806,1 @@\n- * @in:  a pointer to an array of ISO Latin 1 chars\n+ * @in:  a pointer to an array of input bytes\n@@ -1798,1 +1817,1 @@\n- * The value of @outlen after return is the number of octets consumed.\n+ * The value of @outlen after return is the number of octets produced.\n@@ -1854,1 +1873,1 @@\n- * @in:  a pointer to an array of ISO Latin 1 chars\n+ * @in:  a pointer to an array of input bytes\n@@ -1866,1 +1885,1 @@\n- * The value of @outlen after return is the number of octets consumed.\n+ * The value of @outlen after return is the number of octets produced.\n@@ -1915,0 +1934,19 @@\n+\/**\n+ * xmlEncInputChunk:\n+ * @handler:  encoding handler\n+ * @out:  a pointer to an array of bytes to store the result\n+ * @outlen:  the length of @out\n+ * @in:  a pointer to an array of input bytes\n+ * @inlen:  the length of @in\n+ * @flush:  flush (ICU-related)\n+ *\n+ * Returns 0 if success, or\n+ *     -1 by lack of space, or\n+ *     -2 if the transcoding fails (for *in is not valid utf8 string or\n+ *        the result of transformation can't fit into the encoding we want), or\n+ *     -3 if there the last byte can't form a single output char.\n+ *\n+ * The value of @inlen after return is the number of octets consumed\n+ *     as the return value is 0, else unpredictable.\n+ * The value of @outlen after return is the number of octets produced.\n+ *\/\n@@ -1923,0 +1961,2 @@\n+        if (ret > 0)\n+           ret = 0;\n@@ -1944,1 +1984,19 @@\n-\/* Returns -4 if no output function was found. *\/\n+\/**\n+ * xmlEncOutputChunk:\n+ * @handler:  encoding handler\n+ * @out:  a pointer to an array of bytes to store the result\n+ * @outlen:  the length of @out\n+ * @in:  a pointer to an array of input bytes\n+ * @inlen:  the length of @in\n+ *\n+ * Returns 0 if success, or\n+ *     -1 by lack of space, or\n+ *     -2 if the transcoding fails (for *in is not valid utf8 string or\n+ *        the result of transformation can't fit into the encoding we want), or\n+ *     -3 if there the last byte can't form a single output char.\n+ *     -4 if no output function was found.\n+ *\n+ * The value of @inlen after return is the number of octets consumed\n+ *     as the return value is 0, else unpredictable.\n+ * The value of @outlen after return is the number of octets produced.\n+ *\/\n@@ -1952,0 +2010,2 @@\n+        if (ret > 0)\n+           ret = 0;\n@@ -2057,1 +2117,1 @@\n-    return(ret);\n+    return(written ? written : ret);\n@@ -2187,1 +2247,1 @@\n-    return(ret);\n+    return(c_out ? c_out : ret);\n@@ -2397,1 +2457,1 @@\n-    size_t writtentot = 0;\n+    int writtentot = 0;\n@@ -2430,1 +2490,1 @@\n-        return(0);\n+        return(c_out);\n@@ -2543,1 +2603,1 @@\n-    return(ret);\n+    return(writtentot ? writtentot : ret);\n@@ -2708,1 +2768,1 @@\n-    return(ret);\n+    return(writtentot ? writtentot : ret);\n","filename":"modules\/javafx.web\/src\/main\/native\/Source\/ThirdParty\/libxml\/src\/encoding.c","additions":79,"deletions":19,"binary":false,"changes":98,"status":"modified"},{"patch":"@@ -74,1 +74,1 @@\n- * @extra:  extra informations\n+ * @extra:  extra information\n@@ -213,1 +213,1 @@\n-    xmlEntityPtr ret;\n+    xmlEntityPtr ret, predef;\n@@ -226,0 +226,38 @@\n+            predef = xmlGetPredefinedEntity(name);\n+            if (predef != NULL) {\n+                int valid = 0;\n+\n+                \/* 4.6 Predefined Entities *\/\n+                if ((type == XML_INTERNAL_GENERAL_ENTITY) &&\n+                    (content != NULL)) {\n+                    int c = predef->content[0];\n+\n+                    if (((content[0] == c) && (content[1] == 0)) &&\n+                        ((c == '>') || (c == '\\'') || (c == '\"'))) {\n+                        valid = 1;\n+                    } else if ((content[0] == '&') && (content[1] == '#')) {\n+                        if (content[2] == 'x') {\n+                            xmlChar *hex = BAD_CAST \"0123456789ABCDEF\";\n+                            xmlChar ref[] = \"00;\";\n+\n+                            ref[0] = hex[c \/ 16 % 16];\n+                            ref[1] = hex[c % 16];\n+                            if (xmlStrcasecmp(&content[3], ref) == 0)\n+                                valid = 1;\n+                        } else {\n+                            xmlChar ref[] = \"00;\";\n+\n+                            ref[0] = '0' + c \/ 10 % 10;\n+                            ref[1] = '0' + c % 10;\n+                            if (xmlStrEqual(&content[2], ref))\n+                                valid = 1;\n+                        }\n+                    }\n+                }\n+                if (!valid) {\n+                    xmlEntitiesErr(XML_ERR_ENTITY_PROCESSING,\n+                            \"xmlAddEntity: invalid redeclaration of predefined\"\n+                            \" entity\");\n+                    return(NULL);\n+                }\n+            }\n@@ -669,0 +707,10 @@\n+         * It must match either:\n+         *   110xxxxx 10xxxxxx\n+         *   1110xxxx 10xxxxxx 10xxxxxx\n+         *   11110xxx 10xxxxxx 10xxxxxx 10xxxxxx\n+         * That is:\n+         *   cur[0] is 11xxxxxx\n+         *   cur[1] is 10xxxxxx\n+         *   cur[2] is 10xxxxxx if cur[0] is 111xxxxx\n+         *   cur[3] is 10xxxxxx if cur[0] is 1111xxxx\n+         *   cur[0] is not 11111xxx\n@@ -673,1 +721,5 @@\n-        if (*cur < 0xC0) {\n+        if (((cur[0] & 0xC0) != 0xC0) ||\n+            ((cur[1] & 0xC0) != 0x80) ||\n+            (((cur[0] & 0xE0) == 0xE0) && ((cur[2] & 0xC0) != 0x80)) ||\n+            (((cur[0] & 0xF0) == 0xF0) && ((cur[3] & 0xC0) != 0x80)) ||\n+            (((cur[0] & 0xF8) == 0xF8))) {\n","filename":"modules\/javafx.web\/src\/main\/native\/Source\/ThirdParty\/libxml\/src\/entities.c","additions":55,"deletions":3,"binary":false,"changes":58,"status":"modified"},{"patch":"@@ -149,1 +149,1 @@\n- * Displays the associated file and line informations for the current input\n+ * Displays the associated file and line information for the current input\n@@ -560,0 +560,1 @@\n+        char *href = NULL;\n@@ -567,2 +568,7 @@\n-            if (--inclcount < 0)\n-                break;\n+            if (inclcount > 0) {\n+                        --inclcount;\n+                    } else {\n+                        href = (char *) xmlGetProp(prev, BAD_CAST \"href\");\n+                        if (href != NULL)\n+                    break;\n+                    }\n@@ -573,9 +579,3 @@\n-    if (prev != NULL) {\n-        if (prev->type == XML_XINCLUDE_START) {\n-        prev->type = XML_ELEMENT_NODE;\n-        to->file = (char *) xmlGetProp(prev, BAD_CAST \"href\");\n-        prev->type = XML_XINCLUDE_START;\n-        } else {\n-        to->file = (char *) xmlGetProp(prev, BAD_CAST \"href\");\n-        }\n-    } else\n+        if (href != NULL)\n+            to->file = href;\n+    else\n@@ -646,1 +646,1 @@\n- * @extra:  extra informations\n+ * @extra:  extra information\n","filename":"modules\/javafx.web\/src\/main\/native\/Source\/ThirdParty\/libxml\/src\/error.c","additions":13,"deletions":13,"binary":false,"changes":26,"status":"modified"},{"patch":"@@ -218,1 +218,1 @@\n- * Global setting, asking the parser to print out debugging informations.\n+ * Global setting, asking the parser to print out debugging information.\n","filename":"modules\/javafx.web\/src\/main\/native\/Source\/ThirdParty\/libxml\/src\/globals.c","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -14,1 +14,1 @@\n- * MERCHANTIBILITY AND FITNESS FOR A PARTICULAR PURPOSE. THE AUTHORS AND\n+ * MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE. THE AUTHORS AND\n","filename":"modules\/javafx.web\/src\/main\/native\/Source\/ThirdParty\/libxml\/src\/hash.c","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -19,0 +19,3 @@\n+\n+#include <libxml\/xmlversion.h>\n+\n@@ -22,0 +25,3 @@\n+#include <libxml\/tree.h>\n+#include <libxml\/xpath.h>\n+\n@@ -26,4 +32,0 @@\n-#include <libxml\/xmlversion.h>\n-#include <libxml\/tree.h>\n-#include <libxml\/xpath.h>\n-\n","filename":"modules\/javafx.web\/src\/main\/native\/Source\/ThirdParty\/libxml\/src\/include\/libxml\/c14n.h","additions":6,"deletions":4,"binary":false,"changes":10,"status":"modified"},{"patch":"@@ -82,1 +82,1 @@\n- * The parser can be asked to collect Node informations, i.e. at what\n+ * The parser can be asked to collect Node information, i.e. at what\n@@ -172,0 +172,2 @@\n+typedef struct _xmlStartTag xmlStartTag;\n+\n@@ -234,1 +236,1 @@\n-    long               nbChars;       \/* number of xmlChar processed *\/\n+    long               nbChars;       \/* unused *\/\n@@ -283,1 +285,1 @@\n-    void *            *pushTab;       \/* array of data for push *\/\n+    xmlStartTag       *pushTab;       \/* array of data for push *\/\n@@ -299,1 +301,1 @@\n-     * the complete error informations for the last error.\n+     * the complete error information for the last error.\n@@ -332,1 +334,1 @@\n- * of the input generate data or structure informations.\n+ * of the input generate data or structure information.\n@@ -688,1 +690,1 @@\n- * It provides the namespace informations for the element, as well as\n+ * It provides the namespace information for the element, as well as\n@@ -710,1 +712,1 @@\n- * It provides the namespace informations for the element.\n+ * It provides the namespace information for the element.\n","filename":"modules\/javafx.web\/src\/main\/native\/Source\/ThirdParty\/libxml\/src\/include\/libxml\/parser.h","additions":9,"deletions":7,"binary":false,"changes":16,"status":"modified"},{"patch":"@@ -446,1 +446,1 @@\n-    void            *psvi;  \/* for type\/PSVI informations *\/\n+    void            *psvi;  \/* for type\/PSVI information *\/\n@@ -505,1 +505,1 @@\n-    void            *psvi;  \/* for type\/PSVI informations *\/\n+    void            *psvi;  \/* for type\/PSVI information *\/\n@@ -581,1 +581,1 @@\n-    void           *psvi;   \/* for type\/PSVI informations *\/\n+    void           *psvi;   \/* for type\/PSVI information *\/\n","filename":"modules\/javafx.web\/src\/main\/native\/Source\/ThirdParty\/libxml\/src\/include\/libxml\/tree.h","additions":3,"deletions":3,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -220,0 +220,2 @@\n+XMLPUBFUN int XMLCALL\n+    xmlPopOutputCallbacks           (void);\n","filename":"modules\/javafx.web\/src\/main\/native\/Source\/ThirdParty\/libxml\/src\/include\/libxml\/xmlIO.h","additions":2,"deletions":0,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -6,2 +6,0 @@\n- *\n- * Author: Igor Zlatovic <igor@zlatkovic.com>\n@@ -13,11 +11,20 @@\n-\/**\n- * XMLPUBFUN, XMLPUBVAR, XMLCALL\n- *\n- * Macros which declare an exportable function, an exportable variable and\n- * the calling convention used for functions.\n- *\n- * Please use an extra block for every platform\/compiler combination when\n- * modifying this, rather than overlong #ifdef lines. This helps\n- * readability as well as the fact that different compilers on the same\n- * platform might need different definitions.\n- *\/\n+#if defined(_WIN32) || defined(__CYGWIN__)\n+\/** DOC_DISABLE *\/\n+\n+#ifdef LIBXML_STATIC\n+  #define XMLPUBLIC\n+#elif defined(IN_LIBXML)\n+  #define XMLPUBLIC __declspec(dllexport)\n+#else\n+  #define XMLPUBLIC __declspec(dllimport)\n+#endif\n+\n+#if defined(LIBXML_FASTCALL)\n+  #define XMLCALL __fastcall\n+#else\n+  #define XMLCALL __cdecl\n+#endif\n+#define XMLCDECL __cdecl\n+\n+\/** DOC_ENABLE *\/\n+#else \/* not Windows *\/\n@@ -26,7 +33,1 @@\n- * XMLPUBFUN:\n- *\n- * Macros which declare an exportable function\n- *\/\n-#define XMLPUBFUN\n-\/**\n- * XMLPUBVAR:\n+ * XMLPUBLIC:\n@@ -34,1 +35,1 @@\n- * Macros which declare an exportable variable\n+ * Macro which declares a public symbol\n@@ -36,1 +37,2 @@\n-#define XMLPUBVAR extern\n+#define XMLPUBLIC\n+\n@@ -40,1 +42,1 @@\n- * Macros which declare the called convention for exported functions\n+ * Macro which declares the calling convention for exported functions\n@@ -43,0 +45,1 @@\n+\n@@ -51,26 +54,1 @@\n-\/** DOC_DISABLE *\/\n-\n-\/* Windows platform with MS compiler *\/\n-#if defined(_WIN32) && defined(_MSC_VER)\n-  #undef XMLPUBFUN\n-  #undef XMLPUBVAR\n-  #undef XMLCALL\n-  #undef XMLCDECL\n-  #if defined(IN_LIBXML) && !defined(LIBXML_STATIC)\n-    #define XMLPUBFUN __declspec(dllexport)\n-    #define XMLPUBVAR __declspec(dllexport)\n-  #else\n-    #define XMLPUBFUN\n-    #if !defined(LIBXML_STATIC)\n-      #define XMLPUBVAR __declspec(dllimport) extern\n-    #else\n-      #define XMLPUBVAR extern\n-    #endif\n-  #endif\n-  #if defined(LIBXML_FASTCALL)\n-    #define XMLCALL __fastcall\n-  #else\n-    #define XMLCALL __cdecl\n-  #endif\n-  #define XMLCDECL __cdecl\n-#endif\n+#endif \/* platform switch *\/\n@@ -78,46 +56,6 @@\n-\/* Windows platform with Borland compiler *\/\n-#if defined(_WIN32) && defined(__BORLANDC__)\n-  #undef XMLPUBFUN\n-  #undef XMLPUBVAR\n-  #undef XMLCALL\n-  #undef XMLCDECL\n-  #if defined(IN_LIBXML) && !defined(LIBXML_STATIC)\n-    #define XMLPUBFUN __declspec(dllexport)\n-    #define XMLPUBVAR __declspec(dllexport) extern\n-  #else\n-    #define XMLPUBFUN\n-    #if !defined(LIBXML_STATIC)\n-      #define XMLPUBVAR __declspec(dllimport) extern\n-    #else\n-      #define XMLPUBVAR extern\n-    #endif\n-  #endif\n-  #define XMLCALL __cdecl\n-  #define XMLCDECL __cdecl\n-#endif\n-\n-\/* Windows platform with GNU compiler (Mingw) *\/\n-#if defined(_WIN32) && defined(__MINGW32__)\n-  #undef XMLPUBFUN\n-  #undef XMLPUBVAR\n-  #undef XMLCALL\n-  #undef XMLCDECL\n-  \/*\n-   * if defined(IN_LIBXML) this raises problems on mingw with msys\n-   * _imp__xmlFree listed as missing. Try to workaround the problem\n-   * by also making that declaration when compiling client code.\n-   *\/\n-  #if defined(IN_LIBXML) && !defined(LIBXML_STATIC)\n-    #define XMLPUBFUN __declspec(dllexport)\n-    #define XMLPUBVAR __declspec(dllexport) extern\n-  #else\n-    #define XMLPUBFUN\n-    #if !defined(LIBXML_STATIC)\n-      #define XMLPUBVAR __declspec(dllimport) extern\n-    #else\n-      #define XMLPUBVAR extern\n-    #endif\n-  #endif\n-  #define XMLCALL __cdecl\n-  #define XMLCDECL __cdecl\n-#endif\n+\/*\n+ * XMLPUBFUN:\n+ *\n+ * Macro which declares an exportable function\n+ *\/\n+#define XMLPUBFUN XMLPUBLIC\n@@ -125,20 +63,6 @@\n-\/* Cygwin platform (does not define _WIN32), GNU compiler *\/\n-#if defined(__CYGWIN__)\n-  #undef XMLPUBFUN\n-  #undef XMLPUBVAR\n-  #undef XMLCALL\n-  #undef XMLCDECL\n-  #if defined(IN_LIBXML) && !defined(LIBXML_STATIC)\n-    #define XMLPUBFUN __declspec(dllexport)\n-    #define XMLPUBVAR __declspec(dllexport)\n-  #else\n-    #define XMLPUBFUN\n-    #if !defined(LIBXML_STATIC)\n-      #define XMLPUBVAR __declspec(dllimport) extern\n-    #else\n-      #define XMLPUBVAR extern\n-    #endif\n-  #endif\n-  #define XMLCALL __cdecl\n-  #define XMLCDECL __cdecl\n-#endif\n+\/**\n+ * XMLPUBVAR:\n+ *\n+ * Macro which declares an exportable variable\n+ *\/\n+#define XMLPUBVAR XMLPUBLIC extern\n","filename":"modules\/javafx.web\/src\/main\/native\/Source\/ThirdParty\/libxml\/src\/include\/libxml\/xmlexports.h","additions":39,"deletions":115,"binary":false,"changes":154,"status":"modified"},{"patch":"@@ -125,1 +125,1 @@\n- * This is used when file or node informations are not available\n+ * This is used when file or node information are not available\n","filename":"modules\/javafx.web\/src\/main\/native\/Source\/ThirdParty\/libxml\/src\/include\/libxml\/xmlschemas.h","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -2,2 +2,2 @@\n- * Summary: compile-time version informations\n- * Description: compile-time version informations for the XML library\n+ * Summary: compile-time version information\n+ * Description: compile-time version information for the XML library\n","filename":"modules\/javafx.web\/src\/main\/native\/Source\/ThirdParty\/libxml\/src\/include\/libxml\/xmlversion.h.in","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -362,2 +362,0 @@\n-    int maxDepth;\n-    int maxParserDepth;\n@@ -376,1 +374,1 @@\n- * An XPath parser context. It contains pure parsing informations,\n+ * An XPath parser context. It contains pure parsing information,\n","filename":"modules\/javafx.web\/src\/main\/native\/Source\/ThirdParty\/libxml\/src\/include\/libxml\/xpath.h","additions":1,"deletions":3,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -89,1 +89,1 @@\n- * internal error reporting routines, shared but not partof the API.\n+ * internal error reporting routines, shared but not part of the API.\n","filename":"modules\/javafx.web\/src\/main\/native\/Source\/ThirdParty\/libxml\/src\/libxml.h","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -2,0 +2,2 @@\n+# Simon Josefsson 2020-02-12\n+# Fix autoconf 2.70+ warnings\n@@ -61,1 +63,2 @@\n-      AC_TRY_RUN([\n+      AC_RUN_IFELSE(\n+            [AC_LANG_SOURCE([[\n@@ -131,1 +134,1 @@\n-        printf(\"*** modify your LD_LIBRARY_PATH enviroment variable, or edit \/etc\/ld.so.conf\\n\");\n+        printf(\"*** modify your LD_LIBRARY_PATH environment variable, or edit \/etc\/ld.so.conf\\n\");\n@@ -136,1 +139,1 @@\n-],, no_xml=yes,[echo $ac_n \"cross compiling; assumed OK... $ac_c\"])\n+]])],, no_xml=yes,[echo $ac_n \"cross compiling; assumed OK... $ac_c\"])\n@@ -159,1 +162,2 @@\n-          AC_TRY_LINK([\n+\t  AC_LINK_IFELSE(\n+            [AC_LANG_PROGRAM([[\n@@ -162,1 +166,1 @@\n-],      [ LIBXML_TEST_VERSION; return 0;],\n+]],    [[ LIBXML_TEST_VERSION; return 0;]])],\n","filename":"modules\/javafx.web\/src\/main\/native\/Source\/ThirdParty\/libxml\/src\/libxml.m4","additions":9,"deletions":5,"binary":false,"changes":14,"status":"modified"},{"patch":"@@ -5,1 +5,1 @@\n-# THis module sets the following variables:\n+# This module sets the following variables:\n@@ -9,7 +9,16 @@\n-#   LIBXML2_INCLUDE_DIRS      - Directory where libxml2 headers are located.\n-#   LIBXML2_LIBRARIES         - xml2 libraries to link against.\n-#   LIBXML2_VERSION_MAJOR     - The major version of libxml2.\n-#   LIBXML2_VERSION_MINOR     - The minor version of libxml2.\n-#   LIBXML2_VERSION_PATCH     - The patch version of libxml2.\n-#   LIBXML2_VERSION_STRING    - version number as a string (ex: \"2.3.4\")\n-#   LIBXML2_MODULES           - whether libxml2 as dso support\n+#   LIBXML2_INCLUDE_DIR        - Directory where LibXml2 headers are located.\n+#   LIBXML2_INCLUDE_DIRS       - list of the include directories needed to use LibXml2.\n+#   LIBXML2_LIBRARY            - path to the LibXml2 library.\n+#   LIBXML2_LIBRARIES          - xml2 libraries to link against.\n+#   LIBXML2_DEFINITIONS        - the compiler switches required for using LibXml2.\n+#   LIBXML2_VERSION_MAJOR      - The major version of libxml2.\n+#   LIBXML2_VERSION_MINOR      - The minor version of libxml2.\n+#   LIBXML2_VERSION_PATCH      - The patch version of libxml2.\n+#   LIBXML2_VERSION_STRING     - version number as a string (ex: \"2.3.4\")\n+#   LIBXML2_MODULES            - whether libxml2 has dso support\n+#   LIBXML2_XMLLINT_EXECUTABLE - path to the XML checking tool xmllint coming with LibXml2\n+#\n+# The following targets are defined:\n+#\n+#   LibXml2::LibXml2          - the LibXml2 library\n+#   LibXml2::xmllint          - the xmllint command-line executable\n@@ -23,0 +32,1 @@\n+set(LIBXML2_DEFINITIONS    \"@XML_CFLAGS@\")\n@@ -24,1 +34,1 @@\n-set(LIBXML2_INCLUDE_DIRS   ${_libxml2_rootdir}\/include ${_libxml2_rootdir}\/include\/libxml2)\n+set(LIBXML2_INCLUDE_DIR    ${_libxml2_rootdir}\/include\/libxml2)\n@@ -26,1 +36,0 @@\n-set(LIBXML2_LIBRARIES      -L${LIBXML2_LIBRARY_DIR} -lxml2)\n@@ -28,3 +37,33 @@\n-if(@WITH_THREADS@)\n-  find_package(Threads REQUIRED)\n-  list(APPEND LIBXML2_LIBRARIES ${CMAKE_THREAD_LIBS_INIT})\n+find_library(LIBXML2_LIBRARY NAMES xml2 HINTS ${LIBXML2_LIBRARY_DIR} NO_DEFAULT_PATH)\n+find_program(LIBXML2_XMLCATALOG_EXECUTABLE NAMES xmlcatalog HINTS ${_libxml2_rootdir}\/bin NO_DEFAULT_PATH)\n+find_program(LIBXML2_XMLLINT_EXECUTABLE NAMES xmllint HINTS ${_libxml2_rootdir}\/bin NO_DEFAULT_PATH)\n+\n+set(LIBXML2_LIBRARIES ${LIBXML2_LIBRARY})\n+set(LIBXML2_INCLUDE_DIRS ${LIBXML2_INCLUDE_DIR})\n+unset(LIBXML2_INTERFACE_LINK_LIBRARIES)\n+\n+include(CMakeFindDependencyMacro)\n+\n+set(LIBXML2_WITH_ICONV @WITH_ICONV@)\n+set(LIBXML2_WITH_THREADS @WITH_THREADS@)\n+set(LIBXML2_WITH_ICU @WITH_ICU@)\n+set(LIBXML2_WITH_LZMA @WITH_LZMA@)\n+set(LIBXML2_WITH_ZLIB @WITH_ZLIB@)\n+\n+if(LIBXML2_WITH_ICONV)\n+  find_dependency(Iconv)\n+  list(APPEND LIBXML2_LIBRARIES    ${Iconv_LIBRARIES})\n+  list(APPEND LIBXML2_INCLUDE_DIRS ${Iconv_INCLUDE_DIRS})\n+  list(APPEND LIBXML2_INTERFACE_LINK_LIBRARIES \"Iconv::Iconv\")\n+endif()\n+\n+if(LIBXML2_WITH_THREADS)\n+  find_dependency(Threads)\n+  list(APPEND LIBXML2_LIBRARIES    ${CMAKE_THREAD_LIBS_INIT})\n+  list(APPEND LIBXML2_INTERFACE_LINK_LIBRARIES \"\\$<LINK_ONLY:Threads::Threads>\")\n+endif()\n+\n+if(LIBXML2_WITH_ICU)\n+  find_dependency(ICU COMPONENTS data i18n uc)\n+  list(APPEND LIBXML2_LIBRARIES    ${ICU_LIBRARIES})\n+  list(APPEND LIBXML2_INTERFACE_LINK_LIBRARIES \"\\$<LINK_ONLY:ICU::data>;\\$<LINK_ONLY:ICU::i18n>;\\$<LINK_ONLY:ICU::uc>\")\n@@ -33,2 +72,2 @@\n-if(@WITH_LZMA@)\n-  find_package(LibLZMA REQUIRED)\n+if(LIBXML2_WITH_LZMA)\n+  find_dependency(LibLZMA)\n@@ -36,1 +75,1 @@\n-  list(APPEND LIBXML2_INCLUDE_DIRS ${LIBLZMA_INCLUDE_DIRS})\n+  list(APPEND LIBXML2_INTERFACE_LINK_LIBRARIES \"\\$<LINK_ONLY:LibLZMA::LibLZMA>\")\n@@ -39,2 +78,2 @@\n-if(@WITH_ZLIB@)\n-  find_package(ZLIB REQUIRED)\n+if(LIBXML2_WITH_ZLIB)\n+  find_dependency(ZLIB)\n@@ -42,1 +81,1 @@\n-  list(APPEND LIBXML2_INCLUDE_DIRS ${ZLIB_INCLUDE_DIRS})\n+  list(APPEND LIBXML2_INTERFACE_LINK_LIBRARIES \"\\$<LINK_ONLY:ZLIB::ZLIB>\")\n@@ -45,1 +84,9 @@\n-list(APPEND LIBXML2_LIBRARIES @ICU_LIBS@ @ICONV_LIBS@ @M_LIBS@ @WIN32_EXTRA_LIBADD@ @LIBS@)\n+if(UNIX)\n+  list(APPEND LIBXML2_LIBRARIES    m)\n+  list(APPEND LIBXML2_INTERFACE_LINK_LIBRARIES \"\\$<LINK_ONLY:m>\")\n+endif()\n+\n+if(WIN32)\n+  list(APPEND LIBXML2_LIBRARIES    ws2_32)\n+  list(APPEND LIBXML2_INTERFACE_LINK_LIBRARIES \"\\$<LINK_ONLY:ws2_32>\")\n+endif()\n@@ -50,1 +97,19 @@\n-mark_as_advanced( LIBXML2_INCLUDE_DIRS LIBXML2_LIBRARIES )\n+mark_as_advanced(LIBXML2_LIBRARY LIBXML2_XMLCATALOG_EXECUTABLE LIBXML2_XMLLINT_EXECUTABLE)\n+\n+if(NOT TARGET LibXml2::LibXml2 AND DEFINED LIBXML2_LIBRARY AND DEFINED LIBXML2_INCLUDE_DIRS)\n+  add_library(LibXml2::LibXml2 UNKNOWN IMPORTED)\n+  set_target_properties(LibXml2::LibXml2 PROPERTIES IMPORTED_LOCATION \"${LIBXML2_LIBRARY}\")\n+  set_target_properties(LibXml2::LibXml2 PROPERTIES INTERFACE_COMPILE_OPTIONS \"${LIBXML2_DEFINITIONS}\")\n+  set_target_properties(LibXml2::LibXml2 PROPERTIES INTERFACE_INCLUDE_DIRECTORIES \"${LIBXML2_INCLUDE_DIRS}\")\n+  set_target_properties(LibXml2::LibXml2 PROPERTIES INTERFACE_LINK_LIBRARIES \"${LIBXML2_INTERFACE_LINK_LIBRARIES}\")\n+endif()\n+\n+if(NOT TARGET LibXml2::xmlcatalog AND DEFINED LIBXML2_XMLCATALOG_EXECUTABLE)\n+  add_executable(LibXml2::xmlcatalog IMPORTED)\n+  set_target_properties(LibXml2::xmlcatalog PROPERTIES IMPORTED_LOCATION \"${LIBXML2_XMLCATALOG_EXECUTABLE}\")\n+endif()\n+\n+if(NOT TARGET LibXml2::xmllint AND DEFINED LIBXML2_XMLLINT_EXECUTABLE)\n+  add_executable(LibXml2::xmllint IMPORTED)\n+  set_target_properties(LibXml2::xmllint PROPERTIES IMPORTED_LOCATION \"${LIBXML2_XMLLINT_EXECUTABLE}\")\n+endif()\n","filename":"modules\/javafx.web\/src\/main\/native\/Source\/ThirdParty\/libxml\/src\/libxml2-config.cmake.in","additions":86,"deletions":21,"binary":false,"changes":107,"status":"modified"},{"patch":"@@ -5,1 +5,1 @@\n-Version: 2.9.10\n+Version: 2.9.12\n@@ -207,2 +207,2 @@\n-* Thu Feb 20 2020 Daniel Veillard <veillard@redhat.com>\n-- upstream release 2.9.10 see http:\/\/xmlsoft.org\/news.html\n+* Wed Jun 30 2021 Daniel Veillard <veillard@redhat.com>\n+- upstream release 2.9.12 see http:\/\/xmlsoft.org\/news.html\n","filename":"modules\/javafx.web\/src\/main\/native\/Source\/ThirdParty\/libxml\/src\/libxml2.spec","additions":3,"deletions":3,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -2289,0 +2289,7 @@\n+LIBXML2_2.9.11 {\n+    global:\n+\n+# xmlIO\n+  xmlPopOutputCallbacks;\n+} LIBXML2_2.9.8;\n+\n","filename":"modules\/javafx.web\/src\/main\/native\/Source\/ThirdParty\/libxml\/src\/libxml2.syms","additions":7,"deletions":0,"binary":false,"changes":7,"status":"modified"},{"patch":"@@ -12,1 +12,1 @@\n- * MERCHANTIBILITY AND FITNESS FOR A PARTICULAR PURPOSE. THE AUTHORS AND\n+ * MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE. THE AUTHORS AND\n","filename":"modules\/javafx.web\/src\/main\/native\/Source\/ThirdParty\/libxml\/src\/list.c","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -1,1 +1,3 @@\n-int test_main(int argc, char **argv);#define main(X,Y)  test_main(X,Y)\n\\ No newline at end of file\n+int test_main(int argc, char **argv);\n+\n+#define main(X,Y)    test_main(X,Y)\n","filename":"modules\/javafx.web\/src\/main\/native\/Source\/ThirdParty\/libxml\/src\/macos\/src\/XMLTestPrefix.h","additions":3,"deletions":1,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -1,1 +1,3 @@\n-int test_main(int argc, char* argv[]);#define main()        test_main(int argc, char* argv[])\n\\ No newline at end of file\n+int test_main(int argc, char* argv[]);\n+\n+#define main()      test_main(int argc, char* argv[])\n","filename":"modules\/javafx.web\/src\/main\/native\/Source\/ThirdParty\/libxml\/src\/macos\/src\/XMLTestPrefix2.h","additions":3,"deletions":1,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -1,1 +1,1 @@\n-\/**************** BEGIN GUSI CONFIGURATION ****************************\r *\r * GUSI Configuration section generated by GUSI Configurator\r * last modified: Wed Oct 31 17:07:45 2001\r *\r * This section will be overwritten by the next run of Configurator.\r *\/\r\r#define GUSI_SOURCE\r#include <GUSIConfig.h>\r#include <sys\/cdefs.h>\r\r\/* Declarations of Socket Factories *\/\r\r__BEGIN_DECLS\rvoid GUSIwithInetSockets();\rvoid GUSIwithLocalSockets();\rvoid GUSIwithMTInetSockets();\rvoid GUSIwithMTTcpSockets();\rvoid GUSIwithMTUdpSockets();\rvoid GUSIwithOTInetSockets();\rvoid GUSIwithOTTcpSockets();\rvoid GUSIwithOTUdpSockets();\rvoid GUSIwithPPCSockets();\rvoid GUSISetupFactories();\r__END_DECLS\r\r\/* Configure Socket Factories *\/\r\rvoid GUSISetupFactories()\r{\r#ifdef GUSISetupFactories_BeginHook\r\tGUSISetupFactories_BeginHook\r#endif\r\tGUSIwithInetSockets();\r#ifdef GUSISetupFactories_EndHook\r\tGUSISetupFactories_EndHook\r#endif\r}\r\r\/* Declarations of File Devices *\/\r\r__BEGIN_DECLS\rvoid GUSIwithNullSockets();\rvoid GUSISetupDevices();\r__END_DECLS\r\r\/* Configure File Devices *\/\r\rvoid GUSISetupDevices()\r{\r#ifdef GUSISetupDevices_BeginHook\r\tGUSISetupDevices_BeginHook\r#endif\r\tGUSIwithNullSockets();\r#ifdef GUSISetupDevices_EndHook\r\tGUSISetupDevices_EndHook\r#endif\r}\r\r#ifndef __cplusplus\r#error GUSISetupConfig() needs to be written in C++\r#endif\r\rGUSIConfiguration::FileSuffix\tsSuffices[] = {\r\t\"\", '????', '????'\r};\r\rextern \"C\" void GUSISetupConfig()\r{\r\tGUSIConfiguration * config =\r\t\tGUSIConfiguration::CreateInstance(GUSIConfiguration::kNoResource);\r\r\tconfig->ConfigureDefaultTypeCreator('TEXT', 'CWIE');\r\tconfig->ConfigureSuffices(\r\t\tsizeof(sSuffices)\/sizeof(GUSIConfiguration::FileSuffix)-1, sSuffices);\r}\r\r\/**************** END GUSI CONFIGURATION *************************\/\n\\ No newline at end of file\n+\/**************** BEGIN GUSI CONFIGURATION ****************************\r *\r * GUSI Configuration section generated by GUSI Configurator\r * last modified: Wed Oct 31 17:07:45 2001\r *\r * This section will be overwritten by the next run of Configurator.\r *\/\r\r#define GUSI_SOURCE\r#include <GUSIConfig.h>\r#include <sys\/cdefs.h>\r\r\/* Declarations of Socket Factories *\/\r\r__BEGIN_DECLS\rvoid GUSIwithInetSockets();\rvoid GUSIwithLocalSockets();\rvoid GUSIwithMTInetSockets();\rvoid GUSIwithMTTcpSockets();\rvoid GUSIwithMTUdpSockets();\rvoid GUSIwithOTInetSockets();\rvoid GUSIwithOTTcpSockets();\rvoid GUSIwithOTUdpSockets();\rvoid GUSIwithPPCSockets();\rvoid GUSISetupFactories();\r__END_DECLS\r\r\/* Configure Socket Factories *\/\r\rvoid GUSISetupFactories()\r{\r#ifdef GUSISetupFactories_BeginHook\r    GUSISetupFactories_BeginHook\r#endif\r    GUSIwithInetSockets();\r#ifdef GUSISetupFactories_EndHook\r   GUSISetupFactories_EndHook\r#endif\r}\r\r\/* Declarations of File Devices *\/\r\r__BEGIN_DECLS\rvoid GUSIwithNullSockets();\rvoid GUSISetupDevices();\r__END_DECLS\r\r\/* Configure File Devices *\/\r\rvoid GUSISetupDevices()\r{\r#ifdef GUSISetupDevices_BeginHook\r GUSISetupDevices_BeginHook\r#endif\r  GUSIwithNullSockets();\r#ifdef GUSISetupDevices_EndHook\r GUSISetupDevices_EndHook\r#endif\r}\r\r#ifndef __cplusplus\r#error GUSISetupConfig() needs to be written in C++\r#endif\r\rGUSIConfiguration::FileSuffix    sSuffices[] = {\r    \"\", '????', '????'\r};\r\rextern \"C\" void GUSISetupConfig()\r{\r GUSIConfiguration * config =\r       GUSIConfiguration::CreateInstance(GUSIConfiguration::kNoResource);\r\r    config->ConfigureDefaultTypeCreator('TEXT', 'CWIE');\r   config->ConfigureSuffices(\r     sizeof(sSuffices)\/sizeof(GUSIConfiguration::FileSuffix)-1, sSuffices);\r}\r\r\/**************** END GUSI CONFIGURATION *************************\/\n","filename":"modules\/javafx.web\/src\/main\/native\/Source\/ThirdParty\/libxml\/src\/macos\/src\/libxml2_GUSIConfig.cp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -1,1 +1,17 @@\n-#include <GUSICommandLine.h>#include <stdlib.h>#undef mainDECLARE_MAIN(test)REGISTER_MAIN_STARTREGISTER_MAIN(test)REGISTER_MAIN_ENDint main(){  (void) exec_commands();     return 0;}\n\\ No newline at end of file\n+#include <GUSICommandLine.h>\n+#include <stdlib.h>\n+\n+#undef main\n+\n+DECLARE_MAIN(test)\n+\n+REGISTER_MAIN_START\n+REGISTER_MAIN(test)\n+REGISTER_MAIN_END\n+\n+int main()\n+{\n+    (void) exec_commands();\n+\n+    return 0;\n+}\n","filename":"modules\/javafx.web\/src\/main\/native\/Source\/ThirdParty\/libxml\/src\/macos\/src\/macos_main.c","additions":17,"deletions":1,"binary":false,"changes":18,"status":"modified"},{"patch":"@@ -161,1 +161,1 @@\n- * @extra:  extra informations\n+ * @extra:  extra information\n@@ -175,1 +175,1 @@\n- * Currently it just checks for proxy informations,\n+ * Currently it just checks for proxy information,\n@@ -221,1 +221,1 @@\n- * Cleanup the FTP protocol layer. This cleanup proxy informations.\n+ * Cleanup the FTP protocol layer. This cleanup proxy information.\n@@ -253,1 +253,1 @@\n- * Setup the FTP proxy informations.\n+ * Setup the FTP proxy information.\n@@ -415,1 +415,1 @@\n- * A NULL URL cleans up proxy informations.\n+ * A NULL URL cleans up proxy information.\n@@ -1254,1 +1254,0 @@\n-    if (port != 0)\n@@ -1271,1 +1270,1 @@\n- * Returns -1 incase of error, 1 if CWD worked, 0 if it failed\n+ * Returns -1 in case of error, 1 if CWD worked, 0 if it failed\n@@ -1320,1 +1319,1 @@\n- * Returns -1 incase of error, 1 if DELE worked, 0 if it failed\n+ * Returns -1 in case of error, 1 if DELE worked, 0 if it failed\n@@ -1370,1 +1369,1 @@\n- * Returns -1 incase of error, 0 otherwise\n+ * Returns -1 in case of error, 0 otherwise\n@@ -1543,1 +1542,1 @@\n- * Returns -1 incase of error, 0 otherwise\n+ * Returns -1 in case of error, 0 otherwise\n@@ -1594,1 +1593,1 @@\n- * Returns -1 incase of error, the length of data parsed otherwise\n+ * Returns -1 in case of error, the length of data parsed otherwise\n@@ -1722,1 +1721,1 @@\n- * Returns -1 incase of error, 0 otherwise\n+ * Returns -1 in case of error, 0 otherwise\n@@ -1897,1 +1896,1 @@\n- * Returns -1 incase of error, 0 otherwise\n+ * Returns -1 in case of error, 0 otherwise\n@@ -2027,1 +2026,1 @@\n- * Returns -1 incase of error, 0 otherwise\n+ * Returns -1 in case of error, 0 otherwise\n","filename":"modules\/javafx.web\/src\/main\/native\/Source\/ThirdParty\/libxml\/src\/nanoftp.c","additions":13,"deletions":14,"binary":false,"changes":27,"status":"modified"},{"patch":"@@ -163,1 +163,1 @@\n- * @extra:  extra informations\n+ * @extra:  extra information\n@@ -216,1 +216,1 @@\n- * Currently it just checks for proxy informations\n+ * Currently it just checks for proxy information\n@@ -347,1 +347,1 @@\n- * A NULL URL cleans up proxy informations.\n+ * A NULL URL cleans up proxy information.\n@@ -653,1 +653,1 @@\n- * the HTTP protocol informations from the answer header.\n+ * the HTTP protocol information from the answer header.\n@@ -696,1 +696,1 @@\n- * Try to extract useful informations from the server answer.\n+ * Try to extract useful information from the server answer.\n@@ -1628,1 +1628,1 @@\n- * Returns -1 in case of failure, 0 incase of success. The contentType,\n+ * Returns -1 in case of failure, 0 in case of success. The contentType,\n@@ -1678,1 +1678,1 @@\n- * Returns -1 in case of failure, 0 incase of success.\n+ * Returns -1 in case of failure, 0 in case of success.\n","filename":"modules\/javafx.web\/src\/main\/native\/Source\/ThirdParty\/libxml\/src\/nanohttp.c","additions":7,"deletions":7,"binary":false,"changes":14,"status":"modified"},{"patch":"@@ -90,0 +90,7 @@\n+struct _xmlStartTag {\n+    const xmlChar *prefix;\n+    const xmlChar *URI;\n+    int line;\n+    int nsNr;\n+};\n+\n@@ -136,0 +143,1 @@\n+    int i;\n@@ -173,0 +181,22 @@\n+\n+    \/*\n+     * Prevent entity exponential check, not just replacement while\n+     * parsing the DTD\n+     * The check is potentially costly so do that only once in a thousand\n+     *\/\n+    if ((ctxt->instate == XML_PARSER_DTD) && (ctxt->nbentities > 10000) &&\n+        (ctxt->nbentities % 1024 == 0)) {\n+    for (i = 0;i < ctxt->inputNr;i++) {\n+        consumed += ctxt->inputTab[i]->consumed +\n+                   (ctxt->inputTab[i]->cur - ctxt->inputTab[i]->base);\n+    }\n+    if (ctxt->nbentities > consumed * XML_PARSER_NON_LINEAR) {\n+        xmlFatalErr(ctxt, XML_ERR_ENTITY_LOOP, NULL);\n+        ctxt->instate = XML_PARSER_EOF;\n+        return (1);\n+    }\n+    consumed = 0;\n+    }\n+\n+\n+\n@@ -1076,0 +1106,1 @@\n+    xmlSAXHandlerPtr sax;\n@@ -1077,0 +1108,1 @@\n+    sax = ctxt->sax;\n@@ -1078,3 +1110,5 @@\n-    if ((ctxt->sax) &&  (ctxt->sax->initialized == XML_SAX2_MAGIC) &&\n-        ((ctxt->sax->startElementNs != NULL) ||\n-         (ctxt->sax->endElementNs != NULL))) ctxt->sax2 = 1;\n+    if ((sax) &&  (sax->initialized == XML_SAX2_MAGIC) &&\n+        ((sax->startElementNs != NULL) ||\n+         (sax->endElementNs != NULL) ||\n+         ((sax->startElement == NULL) && (sax->endElement == NULL))))\n+        ctxt->sax2 = 1;\n@@ -1837,0 +1871,2 @@\n+ * @line:  the current line number for error messages\n+ * @nsNr:  the number of namespaces pushed on the namespace table\n@@ -1844,1 +1880,1 @@\n-           const xmlChar *prefix, const xmlChar *URI, int nsNr)\n+           const xmlChar *prefix, const xmlChar *URI, int line, int nsNr)\n@@ -1846,0 +1882,2 @@\n+    xmlStartTag *tag;\n+\n@@ -1848,1 +1886,1 @@\n-        void **tmp2;\n+        xmlStartTag *tmp2;\n@@ -1858,2 +1896,2 @@\n-        tmp2 = (void **) xmlRealloc((void * *)ctxt->pushTab,\n-                                    ctxt->nameMax * 3 *\n+        tmp2 = (xmlStartTag *) xmlRealloc((void * *)ctxt->pushTab,\n+                                    ctxt->nameMax *\n@@ -1867,1 +1905,1 @@\n-        ctxt->pushTab = (void **) xmlMalloc(ctxt->nameMax * 3 *\n+        ctxt->pushTab = (xmlStartTag *) xmlMalloc(ctxt->nameMax *\n@@ -1874,3 +1912,5 @@\n-    ctxt->pushTab[ctxt->nameNr * 3] = (void *) prefix;\n-    ctxt->pushTab[ctxt->nameNr * 3 + 1] = (void *) URI;\n-    ctxt->pushTab[ctxt->nameNr * 3 + 2] = (void *) (ptrdiff_t) nsNr;\n+    tag = &ctxt->pushTab[ctxt->nameNr];\n+    tag->prefix = prefix;\n+    tag->URI = URI;\n+    tag->line = line;\n+    tag->nsNr = nsNr;\n@@ -2058,1 +2098,1 @@\n-    ctxt->nbChars += (val),ctxt->input->cur += (val),ctxt->input->col+=(val);           \\\n+    ctxt->input->cur += (val),ctxt->input->col+=(val);          \\\n@@ -2069,1 +2109,0 @@\n-    ctxt->nbChars++;                        \\\n@@ -2122,1 +2161,0 @@\n-    ctxt->nbChars++;                        \\\n@@ -2159,1 +2197,1 @@\n-    if ((ctxt->inputNr == 1) && (ctxt->instate != XML_PARSER_DTD)) {\n+    if (ctxt->instate != XML_PARSER_DTD) {\n@@ -2335,1 +2373,0 @@\n-        ctxt->nbChars ++;\n@@ -2364,1 +2401,0 @@\n-        ctxt->nbChars ++;\n@@ -2687,1 +2723,2 @@\n-        if (rep == NULL)\n+        if (rep == NULL) {\n+                    ent->content[0] = 0;\n@@ -2689,0 +2726,1 @@\n+                }\n@@ -2743,1 +2781,3 @@\n-        if (rep == NULL)\n+        if (rep == NULL) {\n+                    if (ent->content != NULL)\n+                        ent->content[0] = 0;\n@@ -2745,0 +2785,1 @@\n+                }\n@@ -3336,1 +3377,0 @@\n-        ctxt->nbChars += count;\n@@ -3459,1 +3499,0 @@\n-        ctxt->nbChars += count;\n@@ -3496,1 +3535,0 @@\n-    ctxt->input->col++;\n@@ -3500,0 +3538,1 @@\n+    ctxt->input->col += in - ctxt->input->cur;\n@@ -3915,1 +3954,0 @@\n-    if (c == 0) break;\n@@ -4210,0 +4248,1 @@\n+        SHRINK;\n@@ -4297,0 +4336,1 @@\n+        SHRINK;\n@@ -4512,1 +4552,1 @@\n-    } while (((*in >= 0x20) && (*in <= 0x7F)) || (*in == 0x09));\n+    } while (((*in >= 0x20) && (*in <= 0x7F)) || (*in == 0x09) || (*in == 0x0a));\n@@ -4577,0 +4617,1 @@\n+        SHRINK;\n@@ -4782,0 +4823,1 @@\n+        SHRINK;\n@@ -4993,1 +5035,1 @@\n-    } while (((*in >= 0x20) && (*in <= 0x7F)) || (*in == 0x09));\n+    } while (((*in >= 0x20) && (*in <= 0x7F)) || (*in == 0x09) || (*in == 0x0a));\n@@ -5057,1 +5099,1 @@\n- * part of the document before any doctype informations\n+ * part of the document before any doctype information\n@@ -5192,0 +5234,1 @@\n+            SHRINK;\n@@ -6088,1 +6131,4 @@\n-        if (ret == NULL) return(NULL);\n+        if (ret == NULL) {\n+            xmlFreeDocElementContent(ctxt->myDoc, cur);\n+                    return(NULL);\n+                }\n@@ -6095,1 +6141,4 @@\n-        if (n == NULL) return(NULL);\n+        if (n == NULL) {\n+            xmlFreeDocElementContent(ctxt->myDoc, ret);\n+                    return(NULL);\n+                }\n@@ -6198,0 +6247,2 @@\n+        if (cur == NULL)\n+            return(NULL);\n@@ -6331,0 +6382,5 @@\n+            if (last == NULL) {\n+        if (ret != NULL)\n+            xmlFreeDocElementContent(ctxt->myDoc, ret);\n+        return(NULL);\n+            }\n@@ -6648,1 +6704,1 @@\n-    int id = ctxt->input->id;\n+            int id = ctxt->input->id;\n@@ -6650,2 +6706,2 @@\n-    SKIP(3);\n-    SKIP_BLANKS;\n+            SKIP(3);\n+            SKIP_BLANKS;\n@@ -6653,6 +6709,6 @@\n-    if (CMP7(CUR_PTR, 'I', 'N', 'C', 'L', 'U', 'D', 'E')) {\n-    SKIP(7);\n-    SKIP_BLANKS;\n-    if (RAW != '[') {\n-        xmlFatalErr(ctxt, XML_ERR_CONDSEC_INVALID, NULL);\n-        xmlHaltParser(ctxt);\n+            if (CMP7(CUR_PTR, 'I', 'N', 'C', 'L', 'U', 'D', 'E')) {\n+                SKIP(7);\n+                SKIP_BLANKS;\n+                if (RAW != '[') {\n+                    xmlFatalErr(ctxt, XML_ERR_CONDSEC_INVALID, NULL);\n+                    xmlHaltParser(ctxt);\n@@ -6661,2 +6717,2 @@\n-        if (ctxt->input->id != id) {\n-        xmlFatalErrMsg(ctxt, XML_ERR_ENTITY_BOUNDARY,\n+                if (ctxt->input->id != id) {\n+                    xmlFatalErrMsg(ctxt, XML_ERR_ENTITY_BOUNDARY,\n@@ -6665,2 +6721,2 @@\n-        }\n-        NEXT;\n+                }\n+                NEXT;\n@@ -6677,1 +6733,1 @@\n-        }\n+                    }\n@@ -6679,1 +6735,1 @@\n-    }\n+                }\n@@ -6682,3 +6738,3 @@\n-    } else if (CMP6(CUR_PTR, 'I', 'G', 'N', 'O', 'R', 'E')) {\n-    int state;\n-    xmlParserInputState instate;\n+            } else if (CMP6(CUR_PTR, 'I', 'G', 'N', 'O', 'R', 'E')) {\n+                int state;\n+                xmlParserInputState instate;\n@@ -6687,5 +6743,5 @@\n-    SKIP(6);\n-    SKIP_BLANKS;\n-    if (RAW != '[') {\n-        xmlFatalErr(ctxt, XML_ERR_CONDSEC_INVALID, NULL);\n-        xmlHaltParser(ctxt);\n+                SKIP(6);\n+                SKIP_BLANKS;\n+                if (RAW != '[') {\n+                    xmlFatalErr(ctxt, XML_ERR_CONDSEC_INVALID, NULL);\n+                    xmlHaltParser(ctxt);\n@@ -6694,2 +6750,2 @@\n-        if (ctxt->input->id != id) {\n-        xmlFatalErrMsg(ctxt, XML_ERR_ENTITY_BOUNDARY,\n+                if (ctxt->input->id != id) {\n+                    xmlFatalErrMsg(ctxt, XML_ERR_ENTITY_BOUNDARY,\n@@ -6698,2 +6754,2 @@\n-        }\n-        NEXT;\n+                }\n+                NEXT;\n@@ -6701,1 +6757,1 @@\n-    \/*\n+                \/*\n@@ -6704,5 +6760,5 @@\n-     *\/\n-    state = ctxt->disableSAX;\n-    instate = ctxt->instate;\n-    if (ctxt->recovery == 0) ctxt->disableSAX = 1;\n-    ctxt->instate = XML_PARSER_IGNORE;\n+                 *\/\n+                state = ctxt->disableSAX;\n+                instate = ctxt->instate;\n+                if (ctxt->recovery == 0) ctxt->disableSAX = 1;\n+                ctxt->instate = XML_PARSER_IGNORE;\n@@ -6711,2 +6767,2 @@\n-      if ((RAW == '<') && (NXT(1) == '!') && (NXT(2) == '[')) {\n-        SKIP(3);\n+                    if ((RAW == '<') && (NXT(1) == '!') && (NXT(2) == '[')) {\n+                        SKIP(3);\n@@ -6718,1 +6774,1 @@\n-      }\n+                        }\n@@ -6726,1 +6782,1 @@\n-      NEXT;\n+                        NEXT;\n@@ -6728,1 +6784,1 @@\n-    }\n+                }\n@@ -6730,2 +6786,2 @@\n-    ctxt->disableSAX = state;\n-    ctxt->instate = instate;\n+                ctxt->disableSAX = state;\n+                ctxt->instate = instate;\n@@ -6736,1 +6792,1 @@\n-    }\n+        }\n@@ -6743,3 +6799,3 @@\n-    } else {\n-    xmlFatalErr(ctxt, XML_ERR_CONDSEC_INVALID_KEYWORD, NULL);\n-    xmlHaltParser(ctxt);\n+            } else {\n+                xmlFatalErr(ctxt, XML_ERR_CONDSEC_INVALID_KEYWORD, NULL);\n+                xmlHaltParser(ctxt);\n@@ -6747,1 +6803,1 @@\n-    }\n+            }\n@@ -6752,1 +6808,1 @@\n-        xmlFatalErrMsg(ctxt, XML_ERR_ENTITY_BOUNDARY,\n+                xmlFatalErrMsg(ctxt, XML_ERR_ENTITY_BOUNDARY,\n@@ -6755,2 +6811,2 @@\n-    }\n-        SKIP(3);\n+            }\n+            SKIP(3);\n@@ -6768,1 +6824,1 @@\n-    }\n+        }\n@@ -6856,0 +6912,1 @@\n+    int oldstate;\n@@ -6867,0 +6924,4 @@\n+    \/* Avoid expansion of parameter entities when skipping blanks. *\/\n+    oldstate = ctxt->instate;\n+    ctxt->instate = XML_PARSER_START;\n+\n@@ -6894,0 +6955,1 @@\n+        ctxt->instate = oldstate;\n@@ -6913,0 +6975,2 @@\n+\n+    ctxt->instate = oldstate;\n@@ -7150,0 +7214,1 @@\n+            xmlHaltParser(ctxt);\n@@ -7163,21 +7228,27 @@\n-        if (ctxt->replaceEntities) {\n-            \/*\n-             * Prune it directly in the generated document\n-             * except for single text nodes.\n-             *\/\n-            if (((list->type == XML_TEXT_NODE) &&\n-             (list->next == NULL)) ||\n-            (ctxt->parseMode == XML_PARSE_READER)) {\n-            list->parent = (xmlNodePtr) ent;\n-            list = NULL;\n-            ent->owner = 1;\n-            } else {\n-            ent->owner = 0;\n-            while (list != NULL) {\n-                list->parent = (xmlNodePtr) ctxt->node;\n-                list->doc = ctxt->myDoc;\n-                if (list->next == NULL)\n-                ent->last = list;\n-                list = list->next;\n-            }\n-            list = ent->children;\n+                \/*\n+                 * Prune it directly in the generated document\n+                 * except for single text nodes.\n+                 *\/\n+                if ((ctxt->replaceEntities == 0) ||\n+                    (ctxt->parseMode == XML_PARSE_READER) ||\n+                    ((list->type == XML_TEXT_NODE) &&\n+                     (list->next == NULL))) {\n+                    ent->owner = 1;\n+                    while (list != NULL) {\n+                        list->parent = (xmlNodePtr) ent;\n+                        xmlSetTreeDoc(list, ent->doc);\n+                        if (list->next == NULL)\n+                            ent->last = list;\n+                        list = list->next;\n+                    }\n+                    list = NULL;\n+                } else {\n+                    ent->owner = 0;\n+                    while (list != NULL) {\n+                        list->parent = (xmlNodePtr) ctxt->node;\n+                        list->doc = ctxt->myDoc;\n+                        if (list->next == NULL)\n+                            ent->last = list;\n+                        list = list->next;\n+                    }\n+                    list = ent->children;\n@@ -7185,2 +7256,2 @@\n-            if (ent->etype == XML_EXTERNAL_GENERAL_PARSED_ENTITY)\n-              xmlAddEntityReference(ent, list, NULL);\n+                    if (ent->etype == XML_EXTERNAL_GENERAL_PARSED_ENTITY)\n+                        xmlAddEntityReference(ent, list, NULL);\n@@ -7188,11 +7259,1 @@\n-            }\n-        } else {\n-            ent->owner = 1;\n-            while (list != NULL) {\n-            list->parent = (xmlNodePtr) ent;\n-            xmlSetTreeDoc(list, ent->doc);\n-            if (list->next == NULL)\n-                ent->last = list;\n-            list = list->next;\n-            }\n-        }\n+                }\n@@ -7928,0 +7989,3 @@\n+        if (xmlParserEntityCheck(ctxt, 0, entity, 0))\n+            return;\n+\n@@ -8633,1 +8697,1 @@\n-        if (name == NULL) name = BAD_CAST \"unparseable\";\n+        if (name == NULL) name = BAD_CAST \"unparsable\";\n@@ -8826,0 +8890,1 @@\n+            ctxt->input->col += in - ctxt->input->cur;\n@@ -9626,2 +9691,1 @@\n-xmlParseEndTag2(xmlParserCtxtPtr ctxt, const xmlChar *prefix,\n-                const xmlChar *URI, int line, int nsNr, int tlen) {\n+xmlParseEndTag2(xmlParserCtxtPtr ctxt, const xmlStartTag *tag) {\n@@ -9629,1 +9693,0 @@\n-    size_t curLength;\n@@ -9638,14 +9701,1 @@\n-    curLength = ctxt->input->end - ctxt->input->cur;\n-    if ((tlen > 0) && (curLength >= (size_t)tlen) &&\n-        (xmlStrncmp(ctxt->input->cur, ctxt->name, tlen) == 0)) {\n-        if ((curLength >= (size_t)(tlen + 1)) &&\n-        (ctxt->input->cur[tlen] == '>')) {\n-        ctxt->input->cur += tlen + 1;\n-        ctxt->input->col += tlen + 1;\n-        goto done;\n-    }\n-    ctxt->input->cur += tlen;\n-    ctxt->input->col += tlen;\n-    name = (xmlChar*)1;\n-    } else {\n-    if (prefix == NULL)\n+    if (tag->prefix == NULL)\n@@ -9654,2 +9704,1 @@\n-        name = xmlParseQNameAndCompare(ctxt, ctxt->name, prefix);\n-    }\n+        name = xmlParseQNameAndCompare(ctxt, ctxt->name, tag->prefix);\n@@ -9676,3 +9725,1 @@\n-        if (name == NULL) name = BAD_CAST \"unparseable\";\n-        if ((line == 0) && (ctxt->node != NULL))\n-            line = ctxt->node->line;\n+        if (name == NULL) name = BAD_CAST \"unparsable\";\n@@ -9681,1 +9728,1 @@\n-                        ctxt->name, line, name);\n+                        ctxt->name, tag->line, name);\n@@ -9687,1 +9734,0 @@\n-done:\n@@ -9690,1 +9736,2 @@\n-    ctxt->sax->endElementNs(ctxt->userData, ctxt->name, prefix, URI);\n+    ctxt->sax->endElementNs(ctxt->userData, ctxt->name, tag->prefix,\n+                                tag->URI);\n@@ -9693,3 +9740,2 @@\n-    if (nsNr != 0)\n-    nsPop(ctxt, nsNr);\n-    return;\n+    if (tag->nsNr != 0)\n+    nsPop(ctxt, tag->nsNr);\n@@ -9777,0 +9823,1 @@\n+        SHRINK;\n@@ -9810,1 +9857,1 @@\n- * xmlParseContent:\n+ * xmlParseContentInternal:\n@@ -9813,3 +9860,2 @@\n- * Parse a content:\n- *\n- * [43] content ::= (element | CharData | Reference | CDSect | PI | Comment)*\n+ * Parse a content sequence. Stops at EOF or '<\/'. Leaves checking of\n+ * unexpected EOF to the caller.\n@@ -9818,2 +9864,2 @@\n-void\n-xmlParseContent(xmlParserCtxtPtr ctxt) {\n+static void\n+xmlParseContentInternal(xmlParserCtxtPtr ctxt) {\n@@ -9894,0 +9940,24 @@\n+\/**\n+ * xmlParseContent:\n+ * @ctxt:  an XML parser context\n+ *\n+ * Parse a content sequence. Stops at EOF or '<\/'.\n+ *\n+ * [43] content ::= (element | CharData | Reference | CDSect | PI | Comment)*\n+ *\/\n+\n+void\n+xmlParseContent(xmlParserCtxtPtr ctxt) {\n+    int nameNr = ctxt->nameNr;\n+\n+    xmlParseContentInternal(ctxt);\n+\n+    if ((ctxt->instate != XML_PARSER_EOF) && (ctxt->nameNr > nameNr)) {\n+        const xmlChar *name = ctxt->nameTab[ctxt->nameNr - 1];\n+        int line = ctxt->pushTab[ctxt->nameNr - 1].line;\n+        xmlFatalErrMsgStrIntStr(ctxt, XML_ERR_TAG_NOT_FINISHED,\n+                \"Premature end of data in tag %s line %d\\n\",\n+        name, line, NULL);\n+    }\n+}\n+\n@@ -9912,1 +9982,2 @@\n-    xmlParseContent(ctxt);\n+\n+    xmlParseContentInternal(ctxt);\n@@ -9915,0 +9986,10 @@\n+\n+    if (CUR == 0) {\n+        const xmlChar *name = ctxt->nameTab[ctxt->nameNr - 1];\n+        int line = ctxt->pushTab[ctxt->nameNr - 1].line;\n+        xmlFatalErrMsgStrIntStr(ctxt, XML_ERR_TAG_NOT_FINISHED,\n+                \"Premature end of data in tag %s line %d\\n\",\n+        name, line, NULL);\n+        return;\n+    }\n+\n@@ -9973,6 +10054,1 @@\n-    if (ctxt->sax2)\n-        nameNsPush(ctxt, name, prefix, URI, ctxt->nsNr - nsNr);\n-#ifdef LIBXML_SAX1_ENABLED\n-    else\n-    namePush(ctxt, name);\n-#endif \/* LIBXML_SAX1_ENABLED *\/\n+    nameNsPush(ctxt, name, prefix, URI, line, ctxt->nsNr - nsNr);\n@@ -10058,1 +10134,1 @@\n-     *\/\n+ *\/\n@@ -10065,1 +10141,1 @@\n-    return;\n+        return;\n@@ -10071,4 +10147,1 @@\n-        const xmlChar *prefix = ctxt->pushTab[ctxt->nameNr * 3 - 3];\n-        const xmlChar *URI = ctxt->pushTab[ctxt->nameNr * 3 - 2];\n-        int nsNr = (ptrdiff_t) ctxt->pushTab[ctxt->nameNr * 3 - 1];\n-    xmlParseEndTag2(ctxt, prefix, URI, 0, nsNr, 0);\n+    xmlParseEndTag2(ctxt, &ctxt->pushTab[ctxt->nameNr - 1]);\n@@ -10078,1 +10151,1 @@\n-      else\n+    else\n@@ -11349,0 +11422,1 @@\n+                int line = ctxt->input->line;\n@@ -11446,6 +11520,1 @@\n-        if (ctxt->sax2)\n-            nameNsPush(ctxt, name, prefix, URI, ctxt->nsNr - nsNr);\n-#ifdef LIBXML_SAX1_ENABLED\n-        else\n-            namePush(ctxt, name);\n-#endif \/* LIBXML_SAX1_ENABLED *\/\n+                nameNsPush(ctxt, name, prefix, URI, line, ctxt->nsNr - nsNr);\n@@ -11568,5 +11637,1 @@\n-            xmlParseEndTag2(ctxt,\n-                    (void *) ctxt->pushTab[ctxt->nameNr * 3 - 3],\n-                    (void *) ctxt->pushTab[ctxt->nameNr * 3 - 2], 0,\n-                    (int) (ptrdiff_t)\n-                                ctxt->pushTab[ctxt->nameNr * 3 - 1], 0);\n+                xmlParseEndTag2(ctxt, &ctxt->pushTab[ctxt->nameNr - 1]);\n@@ -12899,7 +12964,1 @@\n-    xmlParserCtxtPtr ctxt;\n-    xmlDocPtr newDoc;\n-    xmlNodePtr newRoot;\n-    xmlSAXHandlerPtr oldsax = NULL;\n-    int ret = 0;\n-    xmlChar start[4];\n-    xmlCharEncoding enc;\n+    void *userData;\n@@ -12908,88 +12967,0 @@\n-\n-    if (((ctx->depth > 40) && ((ctx->options & XML_PARSE_HUGE) == 0)) ||\n-        (ctx->depth > 1024)) {\n-    return(XML_ERR_ENTITY_LOOP);\n-    }\n-\n-    if (lst != NULL)\n-        *lst = NULL;\n-    if ((URL == NULL) && (ID == NULL))\n-    return(-1);\n-    if (ctx->myDoc == NULL) \/* @@ relax but check for dereferences *\/\n-    return(-1);\n-\n-    ctxt = xmlCreateEntityParserCtxtInternal(URL, ID, NULL, ctx);\n-    if (ctxt == NULL) {\n-    return(-1);\n-    }\n-\n-    oldsax = ctxt->sax;\n-    ctxt->sax = ctx->sax;\n-    xmlDetectSAX2(ctxt);\n-    newDoc = xmlNewDoc(BAD_CAST \"1.0\");\n-    if (newDoc == NULL) {\n-    xmlFreeParserCtxt(ctxt);\n-    return(-1);\n-    }\n-    newDoc->properties = XML_DOC_INTERNAL;\n-    if (ctx->myDoc->dict) {\n-    newDoc->dict = ctx->myDoc->dict;\n-    xmlDictReference(newDoc->dict);\n-    }\n-    if (ctx->myDoc != NULL) {\n-    newDoc->intSubset = ctx->myDoc->intSubset;\n-    newDoc->extSubset = ctx->myDoc->extSubset;\n-    }\n-    if (ctx->myDoc->URL != NULL) {\n-    newDoc->URL = xmlStrdup(ctx->myDoc->URL);\n-    }\n-    newRoot = xmlNewDocNode(newDoc, NULL, BAD_CAST \"pseudoroot\", NULL);\n-    if (newRoot == NULL) {\n-    ctxt->sax = oldsax;\n-    xmlFreeParserCtxt(ctxt);\n-    newDoc->intSubset = NULL;\n-    newDoc->extSubset = NULL;\n-        xmlFreeDoc(newDoc);\n-    return(-1);\n-    }\n-    xmlAddChild((xmlNodePtr) newDoc, newRoot);\n-    nodePush(ctxt, newDoc->children);\n-    if (ctx->myDoc == NULL) {\n-    ctxt->myDoc = newDoc;\n-    } else {\n-    ctxt->myDoc = ctx->myDoc;\n-    newDoc->children->doc = ctx->myDoc;\n-    }\n-\n-    \/*\n-     * Get the 4 first bytes and decode the charset\n-     * if enc != XML_CHAR_ENCODING_NONE\n-     * plug some encoding conversion routines.\n-     *\/\n-    GROW\n-    if ((ctxt->input->end - ctxt->input->cur) >= 4) {\n-    start[0] = RAW;\n-    start[1] = NXT(1);\n-    start[2] = NXT(2);\n-    start[3] = NXT(3);\n-    enc = xmlDetectCharEncoding(start, 4);\n-    if (enc != XML_CHAR_ENCODING_NONE) {\n-        xmlSwitchEncoding(ctxt, enc);\n-    }\n-    }\n-\n-    \/*\n-     * Parse a possible text declaration first\n-     *\/\n-    if ((CMP5(CUR_PTR, '<', '?', 'x', 'm', 'l')) && (IS_BLANK_CH(NXT(5)))) {\n-    xmlParseTextDecl(ctxt);\n-    \/*\n-     * An XML-1.0 document can't reference an entity not XML-1.0\n-     *\/\n-    if ((xmlStrEqual(ctx->version, BAD_CAST \"1.0\")) &&\n-        (!xmlStrEqual(ctxt->input->version, BAD_CAST \"1.0\"))) {\n-        xmlFatalErrMsg(ctxt, XML_ERR_VERSION_MISMATCH,\n-                       \"Version mismatch between document and entity\\n\");\n-    }\n-    }\n-\n@@ -12997,2 +12968,2 @@\n-     * If the user provided its own SAX callbacks then reuse the\n-     * useData callback field, otherwise the expected setup in a\n+     * If the user provided their own SAX callbacks, then reuse the\n+     * userData callback field, otherwise the expected setup in a\n@@ -13002,50 +12973,1 @@\n-        ctxt->userData = ctxt;\n-    else\n-        ctxt->userData = ctx->userData;\n-\n-    \/*\n-     * Doing validity checking on chunk doesn't make sense\n-     *\/\n-    ctxt->instate = XML_PARSER_CONTENT;\n-    ctxt->validate = ctx->validate;\n-    ctxt->valid = ctx->valid;\n-    ctxt->loadsubset = ctx->loadsubset;\n-    ctxt->depth = ctx->depth + 1;\n-    ctxt->replaceEntities = ctx->replaceEntities;\n-    if (ctxt->validate) {\n-    ctxt->vctxt.error = ctx->vctxt.error;\n-    ctxt->vctxt.warning = ctx->vctxt.warning;\n-    } else {\n-    ctxt->vctxt.error = NULL;\n-    ctxt->vctxt.warning = NULL;\n-    }\n-    ctxt->vctxt.nodeTab = NULL;\n-    ctxt->vctxt.nodeNr = 0;\n-    ctxt->vctxt.nodeMax = 0;\n-    ctxt->vctxt.node = NULL;\n-    if (ctxt->dict != NULL) xmlDictFree(ctxt->dict);\n-    ctxt->dict = ctx->dict;\n-    ctxt->str_xml = xmlDictLookup(ctxt->dict, BAD_CAST \"xml\", 3);\n-    ctxt->str_xmlns = xmlDictLookup(ctxt->dict, BAD_CAST \"xmlns\", 5);\n-    ctxt->str_xml_ns = xmlDictLookup(ctxt->dict, XML_XML_NAMESPACE, 36);\n-    ctxt->dictNames = ctx->dictNames;\n-    ctxt->attsDefault = ctx->attsDefault;\n-    ctxt->attsSpecial = ctx->attsSpecial;\n-    ctxt->linenumbers = ctx->linenumbers;\n-\n-    xmlParseContent(ctxt);\n-\n-    ctx->validate = ctxt->validate;\n-    ctx->valid = ctxt->valid;\n-    if ((RAW == '<') && (NXT(1) == '\/')) {\n-    xmlFatalErr(ctxt, XML_ERR_NOT_WELL_BALANCED, NULL);\n-    } else if (RAW != 0) {\n-    xmlFatalErr(ctxt, XML_ERR_EXTRA_CONTENT, NULL);\n-    }\n-    if (ctxt->node != newDoc->children) {\n-    xmlFatalErr(ctxt, XML_ERR_NOT_WELL_BALANCED, NULL);\n-    }\n-\n-    if (!ctxt->wellFormed) {\n-        if (ctxt->errNo == 0)\n-        ret = 1;\n+        userData = NULL;\n@@ -13053,29 +12975,4 @@\n-        ret = ctxt->errNo;\n-    } else {\n-    if (lst != NULL) {\n-        xmlNodePtr cur;\n-\n-        \/*\n-         * Return the newly created nodeset after unlinking it from\n-         * they pseudo parent.\n-         *\/\n-        cur = newDoc->children->children;\n-        *lst = cur;\n-        while (cur != NULL) {\n-        cur->parent = NULL;\n-        cur = cur->next;\n-        }\n-            newDoc->children->children = NULL;\n-    }\n-    ret = 0;\n-    }\n-    ctxt->sax = oldsax;\n-    ctxt->dict = NULL;\n-    ctxt->attsDefault = NULL;\n-    ctxt->attsSpecial = NULL;\n-    xmlFreeParserCtxt(ctxt);\n-    newDoc->intSubset = NULL;\n-    newDoc->extSubset = NULL;\n-    xmlFreeDoc(newDoc);\n-\n-    return(ret);\n+        userData = ctx->userData;\n+    return xmlParseExternalEntityPrivate(ctx->myDoc, ctx, ctx->sax,\n+                                         userData, ctx->depth + 1,\n+                                         URL, ID, lst);\n@@ -13088,1 +12985,1 @@\n- * @sax:  the SAX handler bloc (possibly NULL)\n+ * @sax:  the SAX handler block (possibly NULL)\n@@ -13131,19 +13028,0 @@\n-    if (oldctxt != NULL) {\n-    ctxt->_private = oldctxt->_private;\n-    ctxt->loadsubset = oldctxt->loadsubset;\n-    ctxt->validate = oldctxt->validate;\n-    ctxt->external = oldctxt->external;\n-    ctxt->record_info = oldctxt->record_info;\n-    ctxt->node_seq.maximum = oldctxt->node_seq.maximum;\n-    ctxt->node_seq.length = oldctxt->node_seq.length;\n-    ctxt->node_seq.buffer = oldctxt->node_seq.buffer;\n-    } else {\n-    \/*\n-     * Doing validity checking on chunk without context\n-     * doesn't make sense\n-     *\/\n-    ctxt->_private = NULL;\n-    ctxt->validate = 0;\n-    ctxt->external = 2;\n-    ctxt->loadsubset = 0;\n-    }\n@@ -13159,3 +13037,0 @@\n-    ctxt->node_seq.maximum = 0;\n-    ctxt->node_seq.length = 0;\n-    ctxt->node_seq.buffer = NULL;\n@@ -13166,7 +13041,10 @@\n-    newDoc->intSubset = doc->intSubset;\n-    newDoc->extSubset = doc->extSubset;\n-    newDoc->dict = doc->dict;\n-    xmlDictReference(newDoc->dict);\n-\n-    if (doc->URL != NULL) {\n-    newDoc->URL = xmlStrdup(doc->URL);\n+    if (doc) {\n+        newDoc->intSubset = doc->intSubset;\n+        newDoc->extSubset = doc->extSubset;\n+        if (doc->dict) {\n+            newDoc->dict = doc->dict;\n+            xmlDictReference(newDoc->dict);\n+        }\n+        if (doc->URL != NULL) {\n+            newDoc->URL = xmlStrdup(doc->URL);\n+        }\n@@ -13178,3 +13056,0 @@\n-    ctxt->node_seq.maximum = 0;\n-    ctxt->node_seq.length = 0;\n-    ctxt->node_seq.buffer = NULL;\n@@ -13189,2 +13064,6 @@\n-    ctxt->myDoc = doc;\n-    newRoot->doc = doc;\n+    if (doc == NULL) {\n+        ctxt->myDoc = newDoc;\n+    } else {\n+        ctxt->myDoc = doc;\n+        newRoot->doc = doc;\n+    }\n@@ -13214,0 +13093,8 @@\n+        \/*\n+         * An XML-1.0 document can't reference an entity not XML-1.0\n+         *\/\n+        if ((xmlStrEqual(oldctxt->version, BAD_CAST \"1.0\")) &&\n+            (!xmlStrEqual(ctxt->input->version, BAD_CAST \"1.0\"))) {\n+            xmlFatalErrMsg(ctxt, XML_ERR_VERSION_MISMATCH,\n+                           \"Version mismatch between document and entity\\n\");\n+        }\n@@ -13218,0 +13105,35 @@\n+    if (oldctxt != NULL) {\n+    ctxt->_private = oldctxt->_private;\n+    ctxt->loadsubset = oldctxt->loadsubset;\n+    ctxt->validate = oldctxt->validate;\n+    ctxt->valid = oldctxt->valid;\n+    ctxt->replaceEntities = oldctxt->replaceEntities;\n+        if (oldctxt->validate) {\n+            ctxt->vctxt.error = oldctxt->vctxt.error;\n+            ctxt->vctxt.warning = oldctxt->vctxt.warning;\n+            ctxt->vctxt.userData = oldctxt->vctxt.userData;\n+        }\n+    ctxt->external = oldctxt->external;\n+        if (ctxt->dict) xmlDictFree(ctxt->dict);\n+        ctxt->dict = oldctxt->dict;\n+        ctxt->str_xml = xmlDictLookup(ctxt->dict, BAD_CAST \"xml\", 3);\n+        ctxt->str_xmlns = xmlDictLookup(ctxt->dict, BAD_CAST \"xmlns\", 5);\n+        ctxt->str_xml_ns = xmlDictLookup(ctxt->dict, XML_XML_NAMESPACE, 36);\n+        ctxt->dictNames = oldctxt->dictNames;\n+        ctxt->attsDefault = oldctxt->attsDefault;\n+        ctxt->attsSpecial = oldctxt->attsSpecial;\n+        ctxt->linenumbers = oldctxt->linenumbers;\n+    ctxt->record_info = oldctxt->record_info;\n+    ctxt->node_seq.maximum = oldctxt->node_seq.maximum;\n+    ctxt->node_seq.length = oldctxt->node_seq.length;\n+    ctxt->node_seq.buffer = oldctxt->node_seq.buffer;\n+    } else {\n+    \/*\n+     * Doing validity checking on chunk without context\n+     * doesn't make sense\n+     *\/\n+    ctxt->_private = NULL;\n+    ctxt->validate = 0;\n+    ctxt->external = 2;\n+    ctxt->loadsubset = 0;\n+    }\n@@ -13277,0 +13199,5 @@\n+        ctxt->dict = NULL;\n+        ctxt->attsDefault = NULL;\n+        ctxt->attsSpecial = NULL;\n+        oldctxt->validate = ctxt->validate;\n+        oldctxt->valid = ctxt->valid;\n@@ -13296,1 +13223,1 @@\n- * @sax:  the SAX handler bloc (possibly NULL)\n+ * @sax:  the SAX handler block (possibly NULL)\n@@ -13322,2 +13249,2 @@\n- * @doc:  the document the chunk pertains to\n- * @sax:  the SAX handler bloc (possibly NULL)\n+ * @doc:  the document the chunk pertains to (must not be NULL)\n+ * @sax:  the SAX handler block (possibly NULL)\n@@ -13774,2 +13701,2 @@\n- * @doc:  the document the chunk pertains to\n- * @sax:  the SAX handler bloc (possibly NULL)\n+ * @doc:  the document the chunk pertains to (must not be NULL)\n+ * @sax:  the SAX handler block (possibly NULL)\n@@ -13846,0 +13773,1 @@\n+    \/* doc == NULL is only supported for historic reasons *\/\n@@ -13862,0 +13790,1 @@\n+    \/* doc == NULL is only supported for historic reasons *\/\n@@ -13931,1 +13860,1 @@\n-    if(doc != NULL)\n+    \/* This leaks the namespace list if doc == NULL *\/\n@@ -14214,1 +14143,1 @@\n-    if (ret != NULL) {\n+    if ((ret != NULL) && (ctxt->input->buf != NULL)) {\n@@ -14745,0 +14674,4 @@\n+#if defined(_WIN32) && (!defined(LIBXML_STATIC) || defined(LIBXML_STATIC_FOR_DLL))\n+    atexit(xmlCleanupParser);\n+#endif\n+\n@@ -14823,0 +14756,14 @@\n+#if defined(HAVE_ATTRIBUTE_DESTRUCTOR) && !defined(LIBXML_STATIC) && \\\n+    !defined(_WIN32)\n+static void\n+ATTRIBUTE_DESTRUCTOR\n+xmlDestructor(void) {\n+    \/*\n+     * Calling custom deallocation functions in a destructor can cause\n+     * problems, for example with Nokogiri.\n+     *\/\n+    if (xmlFree == free)\n+        xmlCleanupParser();\n+}\n+#endif\n+\n@@ -14911,1 +14858,0 @@\n-    ctxt->nbChars = 0;\n","filename":"modules\/javafx.web\/src\/main\/native\/Source\/ThirdParty\/libxml\/src\/parser.c","additions":336,"deletions":390,"binary":false,"changes":726,"status":"modified"},{"patch":"@@ -108,1 +108,1 @@\n- * @extra:  extra informations\n+ * @extra:  extra information\n@@ -168,1 +168,1 @@\n- * @str:  error informations\n+ * @str:  error information\n@@ -522,2 +522,0 @@\n-\n-        ctxt->nbChars++;\n@@ -536,1 +534,0 @@\n-        ctxt->nbChars++;\n@@ -680,1 +677,0 @@\n-            ctxt->nbChars++;\n@@ -696,1 +692,0 @@\n-        ctxt->nbChars++;\n@@ -1161,0 +1156,5 @@\n+             *\n+             * FIXME: Encoders might buffer partial byte sequences, so\n+             * this probably can't work. We should return an error and\n+             * make sure that callers never try to switch the encoding\n+             * twice.\n@@ -1751,1 +1751,0 @@\n-    ctxt->nbChars = 0;\n@@ -1880,1 +1879,1 @@\n- *      Handling of node informations               *\n+ *      Handling of node information                *\n","filename":"modules\/javafx.web\/src\/main\/native\/Source\/ThirdParty\/libxml\/src\/parserInternals.c","additions":8,"deletions":9,"binary":false,"changes":17,"status":"modified"},{"patch":"@@ -888,2 +888,0 @@\n-#elif defined(HAVE_WIN32_THREADS) && !defined(HAVE_COMPILER_TLS) && (!defined(LIBXML_STATIC) || defined(LIBXML_STATIC_FOR_DLL))\n-    InitializeCriticalSection(&cleanup_helpers_cs);\n@@ -961,0 +959,3 @@\n+#if !defined(LIBXML_STATIC) || defined(LIBXML_STATIC_FOR_DLL)\n+            InitializeCriticalSection(&cleanup_helpers_cs);\n+#endif\n","filename":"modules\/javafx.web\/src\/main\/native\/Source\/ThirdParty\/libxml\/src\/threads.c","additions":3,"deletions":2,"binary":false,"changes":5,"status":"modified"},{"patch":"@@ -73,1 +73,1 @@\n- * @extra:  extra informations\n+ * @extra:  extra information\n@@ -86,1 +86,1 @@\n- * @extra:  extra informations\n+ * @extra:  extra information\n@@ -1067,1 +1067,1 @@\n- * if availabe.\n+ * if available.\n@@ -1084,1 +1084,1 @@\n- * if availabe.\n+ * if available.\n@@ -1279,1 +1279,1 @@\n-    const xmlChar *cur = value, *end = cur + len;\n+    const xmlChar *cur, *end;\n@@ -1285,0 +1285,2 @@\n+    cur = value;\n+    end = cur + len;\n@@ -1311,0 +1313,10 @@\n+                    \/*\n+                     * If you find an integer overflow here when fuzzing,\n+                     * the bug is probably elsewhere. This function should\n+                     * only receive entities that were already validated by\n+                     * the parser, typically by xmlParseAttValueComplex\n+                     * calling xmlStringDecodeEntities.\n+                     *\n+                     * So it's better *not* to check for overflow to\n+                     * potentially discover new bugs.\n+                     *\/\n@@ -1339,0 +1351,1 @@\n+                    \/* Don't check for integer overflow, see above. *\/\n@@ -1518,0 +1531,1 @@\n+                    \/* Don't check for integer overflow, see above. *\/\n@@ -1540,0 +1554,1 @@\n+                    \/* Don't check for integer overflow, see above. *\/\n@@ -1650,0 +1665,4 @@\n+        if (node == NULL) {\n+            xmlBufFree(buf);\n+            return(NULL);\n+        }\n@@ -1885,6 +1904,0 @@\n-        if(!xmlCheckUTF8(value)) {\n-            xmlTreeErr(XML_TREE_NOT_UTF8, (xmlNodePtr) doc,\n-                       NULL);\n-            if (doc != NULL)\n-                doc->encoding = xmlStrdup(BAD_CAST \"ISO-8859-1\");\n-        }\n@@ -2010,0 +2023,5 @@\n+ * NOTE: @value is supposed to be a piece of XML CDATA, so it allows entity\n+ *       references, but XML special chars need to be escaped first by using\n+ *       xmlEncodeEntitiesReentrant(). Use xmlNewProp() if you don't need\n+ *       entities support.\n+ *\n@@ -3709,0 +3727,5 @@\n+        (cur->type != XML_DOCUMENT_NODE) &&\n+#ifdef LIBXML_DOCB_ENABLED\n+        (cur->type != XML_DOCB_DOCUMENT_NODE) &&\n+#endif\n+        (cur->type != XML_HTML_DOCUMENT_NODE) &&\n@@ -3732,1 +3755,1 @@\n-    cur = next;\n+        cur = next;\n@@ -4069,1 +4092,1 @@\n-         * we cant be sure, that the namespace we found is identified\n+         * we can't be sure, that the namespace we found is identified\n@@ -4550,0 +4573,1 @@\n+    ret->type = doc->type;\n@@ -4872,1 +4896,3 @@\n-            next = cur->parent;\n+            xmlFree(buf);\n+            xmlFree(buffer);\n+            return (NULL);\n@@ -6567,0 +6593,10 @@\n+        } else if (xmlStrEqual(nsName, XML_XML_NAMESPACE)) {\n+        \/*\n+        * The XML namespace must be bound to prefix 'xml'.\n+        *\/\n+        attrDecl = xmlGetDtdQAttrDesc(doc->intSubset,\n+        elemQName, name, BAD_CAST \"xml\");\n+        if ((attrDecl == NULL) && (doc->extSubset != NULL)) {\n+        attrDecl = xmlGetDtdQAttrDesc(doc->extSubset,\n+            elemQName, name, BAD_CAST \"xml\");\n+        }\n@@ -6913,6 +6949,0 @@\n-        if(!xmlCheckUTF8(value)) {\n-            xmlTreeErr(XML_TREE_NOT_UTF8, (xmlNodePtr) node->doc,\n-                       NULL);\n-                if (node->doc != NULL)\n-                    node->doc->encoding = xmlStrdup(BAD_CAST \"ISO-8859-1\");\n-        }\n@@ -7246,1 +7276,1 @@\n-     * the perceived buffer size has shrinked accordingly\n+     * the perceived buffer size has shrunk accordingly\n@@ -7603,1 +7633,1 @@\n-         * We can add it in the space previously shrinked\n+         * We can add it in the space previously shrunk\n","filename":"modules\/javafx.web\/src\/main\/native\/Source\/ThirdParty\/libxml\/src\/tree.c","additions":52,"deletions":22,"binary":false,"changes":74,"status":"modified"},{"patch":"@@ -13,1 +13,1 @@\n- * MERCHANTIBILITY AND FITNESS FOR A PARTICULAR PURPOSE. THE AUTHORS AND\n+ * MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE. THE AUTHORS AND\n","filename":"modules\/javafx.web\/src\/main\/native\/Source\/ThirdParty\/libxml\/src\/triodef.h","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -13,1 +13,1 @@\n- * MERCHANTIBILITY AND FITNESS FOR A PARTICULAR PURPOSE. THE AUTHORS AND\n+ * MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE. THE AUTHORS AND\n@@ -126,2 +126,2 @@\n- * endianess by the compiler, which means that we can support any\n- * kind of endianess. The individual bytes are then used as an index\n+ * endianness by the compiler, which means that we can support any\n+ * kind of endianness. The individual bytes are then used as an index\n","filename":"modules\/javafx.web\/src\/main\/native\/Source\/ThirdParty\/libxml\/src\/trionan.c","additions":3,"deletions":3,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -13,1 +13,1 @@\n- * MERCHANTIBILITY AND FITNESS FOR A PARTICULAR PURPOSE. THE AUTHORS AND\n+ * MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE. THE AUTHORS AND\n","filename":"modules\/javafx.web\/src\/main\/native\/Source\/ThirdParty\/libxml\/src\/trionan.h","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -14,0 +14,1 @@\n+#include <limits.h>\n@@ -332,3 +333,8 @@\n-        port = port * 10 + (*cur - '0');\n-            if (port > 99999999)\n-                port = 99999999;\n+            int digit = *cur - '0';\n+\n+            if (port > INT_MAX \/ 10)\n+                return(1);\n+            port *= 10;\n+            if (port > INT_MAX - digit)\n+                return(1);\n+        port += digit;\n@@ -351,1 +357,1 @@\n- * Parse an user informations part and fills in the appropriate fields\n+ * Parse an user information part and fills in the appropriate fields\n@@ -1751,5 +1757,0 @@\n-#define NULLCHK(p) if(!p) { \\\n-         xmlURIErrMemory(\"escaping URI value\\n\"); \\\n-         xmlFreeURI(uri); \\\n-         return NULL; } \\\n-\n@@ -1777,0 +1778,6 @@\n+#define NULLCHK(p) if(!p) { \\\n+         xmlURIErrMemory(\"escaping URI value\\n\"); \\\n+         xmlFreeURI(uri); \\\n+         xmlFree(ret); \\\n+         return NULL; } \\\n+\n@@ -1807,1 +1814,1 @@\n-        ret = xmlStrcat(ret, BAD_CAST \"\/\/\");\n+            ret = xmlStrcat(ret, BAD_CAST \"\/\/\");\n","filename":"modules\/javafx.web\/src\/main\/native\/Source\/ThirdParty\/libxml\/src\/uri.c","additions":17,"deletions":10,"binary":false,"changes":27,"status":"modified"},{"patch":"@@ -53,1 +53,1 @@\n- * @extra:  extra informations\n+ * @extra:  extra information\n@@ -92,1 +92,1 @@\n- * @extra:  extra informations\n+ * @extra:  extra information\n@@ -134,3 +134,3 @@\n- * @str1:  extra informations\n- * @str2:  extra informations\n- * @str3:  extra informations\n+ * @str1:  extra information\n+ * @str2:  extra information\n+ * @str3:  extra information\n@@ -138,1 +138,1 @@\n- * Handle a validation error, provide contextual informations\n+ * Handle a validation error, provide contextual information\n@@ -177,3 +177,3 @@\n- * @str1:  extra informations\n- * @int2:  extra informations\n- * @str3:  extra informations\n+ * @str1:  extra information\n+ * @int2:  extra information\n+ * @str3:  extra information\n@@ -181,1 +181,1 @@\n- * Handle a validation error, provide contextual informations\n+ * Handle a validation error, provide contextual information\n@@ -1177,1 +1177,1 @@\n- * Dump the occurence operator of an element.\n+ * Dump the occurrence operator of an element.\n@@ -1216,4 +1216,4 @@\n-        case XML_ELEMENT_CONTENT_PCDATA:\n-            xmlBufferWriteChar(buf, \"#PCDATA\");\n-        break;\n-    case XML_ELEMENT_CONTENT_ELEMENT:\n+            case XML_ELEMENT_CONTENT_PCDATA:\n+                xmlBufferWriteChar(buf, \"#PCDATA\");\n+                break;\n+            case XML_ELEMENT_CONTENT_ELEMENT:\n@@ -1222,2 +1222,2 @@\n-        xmlBufferWriteChar(buf, \":\");\n-        }\n+                    xmlBufferWriteChar(buf, \":\");\n+                }\n@@ -1225,3 +1225,3 @@\n-        break;\n-    case XML_ELEMENT_CONTENT_SEQ:\n-    case XML_ELEMENT_CONTENT_OR:\n+                break;\n+            case XML_ELEMENT_CONTENT_SEQ:\n+            case XML_ELEMENT_CONTENT_OR:\n@@ -1235,2 +1235,2 @@\n-    default:\n-        xmlErrValid(NULL, XML_ERR_INTERNAL_ERROR,\n+            default:\n+                xmlErrValid(NULL, XML_ERR_INTERNAL_ERROR,\n@@ -1238,2 +1238,2 @@\n-            NULL);\n-    }\n+                        NULL);\n+        }\n@@ -1250,1 +1250,1 @@\n-        xmlBufferWriteChar(buf, \")\");\n+                xmlBufferWriteChar(buf, \")\");\n@@ -1260,2 +1260,2 @@\n-        break;\n-    }\n+                break;\n+            }\n@@ -5437,1 +5437,1 @@\n-     * Buid a minimal representation of this node content\n+     * Build a minimal representation of this node content\n@@ -5922,3 +5922,2 @@\n-        case XML_ELEMENT_TYPE_ELEMENT:\n-            if (len > 0) {\n-            int i;\n+        case XML_ELEMENT_TYPE_ELEMENT: {\n+                    int i;\n@@ -5926,4 +5925,4 @@\n-            for (i = 0;i < len;i++) {\n-                if (!IS_BLANK_CH(data[i])) {\n-                xmlErrValidNode(ctxt, state->node,\n-                        XML_DTD_CONTENT_MODEL,\n+                    for (i = 0;i < len;i++) {\n+                        if (!IS_BLANK_CH(data[i])) {\n+                            xmlErrValidNode(ctxt, state->node,\n+                                            XML_DTD_CONTENT_MODEL,\n@@ -5931,3 +5930,12 @@\n-                       state->node->name, NULL, NULL);\n-                ret = 0;\n-                goto done;\n+                                   state->node->name, NULL, NULL);\n+                            ret = 0;\n+                            goto done;\n+                        }\n+                    }\n+                    \/*\n+                     * TODO:\n+                     * VC: Standalone Document Declaration\n+                     *  element types with element content, if white space\n+                     *  occurs directly within any instance of those types.\n+                     *\/\n+                    break;\n@@ -5935,9 +5943,0 @@\n-            }\n-            \/*\n-             * TODO:\n-             * VC: Standalone Document Declaration\n-             *  element types with element content, if white space\n-             *  occurs directly within any instance of those types.\n-             *\/\n-            }\n-            break;\n","filename":"modules\/javafx.web\/src\/main\/native\/Source\/ThirdParty\/libxml\/src\/valid.c","additions":46,"deletions":47,"binary":false,"changes":93,"status":"modified"},{"patch":"@@ -109,0 +109,5 @@\n+# append CFLAGS etc. passed on command line\n+CPPFLAGS = $(CPPFLAGS) $(EXTRA_CPPFLAGS)\n+CFLAGS = $(CFLAGS) $(EXTRA_CFLAGS)\n+LDFLAGS = $(LDFLAGS) $(EXTRA_LDFLAGS)\n+\n","filename":"modules\/javafx.web\/src\/main\/native\/Source\/ThirdParty\/libxml\/src\/win32\/Makefile.msvc","additions":5,"deletions":0,"binary":false,"changes":5,"status":"modified"},{"patch":"@@ -26,1 +26,1 @@\n-\t   2.2.2 Compatability problems with MSVC (and probably CYGWIN)\n+\t   2.2.2 Compatibility problems with MSVC (and probably CYGWIN)\n@@ -191,1 +191,1 @@\n-2.2.2 Compatability problems with MSVC (and probably CYGWIN)\n+2.2.2 Compatibility problems with MSVC (and probably CYGWIN)\n","filename":"modules\/javafx.web\/src\/main\/native\/Source\/ThirdParty\/libxml\/src\/win32\/Readme.txt","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -168,1 +168,1 @@\n-\ttxt += \"  include:    Additional search path for the compiler, particularily\\n\";\n+\ttxt += \"  include:    Additional search path for the compiler, particularly\\n\";\n@@ -170,1 +170,1 @@\n-\ttxt += \"  lib:        Additional search path for the linker, particularily\\n\";\n+\ttxt += \"  lib:        Additional search path for the linker, particularly\\n\";\n@@ -211,9 +211,9 @@\n-\t\tif (s.search(\/^LIBXML_MAJOR_VERSION=\/) != -1) {\n-\t\t\tvf.WriteLine(s);\n-\t\t\tverMajor = s.substring(s.indexOf(\"=\") + 1, s.length)\n-\t\t} else if(s.search(\/^LIBXML_MINOR_VERSION=\/) != -1) {\n-\t\t\tvf.WriteLine(s);\n-\t\t\tverMinor = s.substring(s.indexOf(\"=\") + 1, s.length)\n-\t\t} else if(s.search(\/^LIBXML_MICRO_VERSION=\/) != -1) {\n-\t\t\tvf.WriteLine(s);\n-\t\t\tverMicro = s.substring(s.indexOf(\"=\") + 1, s.length)\n+\t\tif (m = s.match(\/^m4_define\\(\\[MAJOR_VERSION\\], (\\w+)\\)\/)) {\n+\t\t\tvf.WriteLine(\"LIBXML_MAJOR_VERSION=\" + m[1]);\n+\t\t\tverMajor = m[1];\n+\t\t} else if(m = s.match(\/^m4_define\\(\\[MINOR_VERSION\\], (\\w+)\\)\/)) {\n+\t\t\tvf.WriteLine(\"LIBXML_MINOR_VERSION=\" + m[1]);\n+\t\t\tverMinor = m[1];\n+\t\t} else if(m = s.match(\/^m4_define\\(\\[MICRO_VERSION\\], (\\w+)\\)\/)) {\n+\t\t\tvf.WriteLine(\"LIBXML_MICRO_VERSION=\" + m[1]);\n+\t\t\tverMicro = m[1];\n@@ -222,1 +222,1 @@\n-\t\t\tverMicroSuffix = s.substring(s.indexOf(\"=\") + 1, s.length)\n+\t\t\tverMicroSuffix = s.substring(s.indexOf(\"=\") + 1, s.length);\n@@ -283,1 +283,1 @@\n-\tversionFile = \"rcVersion.h\"\n+\tversionFile = \"rcVersion.h\";\n@@ -294,1 +294,1 @@\n-\tvf.Close()\n+\tvf.Close();\n@@ -433,1 +433,1 @@\n-\tf.WriteLine(\"steps. Extract the contents of the archive whereever you wish and\");\n+\tf.WriteLine(\"steps. Extract the contents of the archive wherever you wish and\");\n@@ -547,2 +547,0 @@\n-\t\telse if (opt == \"incdir\")\n-\t\t\tbuildIncPrefix = arg.substring(opt.length + 1, arg.length);\n","filename":"modules\/javafx.web\/src\/main\/native\/Source\/ThirdParty\/libxml\/src\/win32\/configure.js","additions":15,"deletions":17,"binary":false,"changes":32,"status":"modified"},{"patch":"@@ -227,1 +227,1 @@\n- * @extra:  extra informations\n+ * @extra:  extra information\n@@ -241,1 +241,1 @@\n- * @extra:  extra informations\n+ * @extra:  extra information\n@@ -419,1 +419,1 @@\n- * @extra:  extra informations\n+ * @extra:  extra information\n@@ -432,1 +432,1 @@\n- * @extra:  extra informations\n+ * @extra:  extra information\n@@ -563,0 +563,27 @@\n+\n+\/**\n+ * xmlPopOutputCallbacks:\n+ *\n+ * Remove the top output callbacks from the output stack. This includes the\n+ * compiled-in I\/O.\n+ *\n+ * Returns the number of output callback registered or -1 in case of error.\n+ *\/\n+int\n+xmlPopOutputCallbacks(void)\n+{\n+    if (!xmlOutputCallbackInitialized)\n+        return(-1);\n+\n+    if (xmlOutputCallbackNr <= 0)\n+        return(-1);\n+\n+    xmlOutputCallbackNr--;\n+    xmlOutputCallbackTable[xmlOutputCallbackNr].matchcallback = NULL;\n+    xmlOutputCallbackTable[xmlOutputCallbackNr].opencallback = NULL;\n+    xmlOutputCallbackTable[xmlOutputCallbackNr].writecallback = NULL;\n+    xmlOutputCallbackTable[xmlOutputCallbackNr].closecallback = NULL;\n+\n+    return(xmlOutputCallbackNr);\n+}\n+\n@@ -3377,4 +3404,1 @@\n-            if (out->writecallback)\n-        nbchars = xmlBufUse(out->conv);\n-            else\n-                nbchars = ret;\n+            nbchars = ret >= 0 ? ret : 0;\n@@ -3385,4 +3409,1 @@\n-            if (out->writecallback)\n-        nbchars = xmlBufUse(out->buffer);\n-            else\n-                nbchars = chunk;\n+            nbchars = chunk;\n@@ -3394,2 +3415,2 @@\n-    if ((nbchars < MINLEN) && (len <= 0))\n-        goto done;\n+            if ((nbchars < MINLEN) && (len <= 0))\n+                goto done;\n@@ -3419,1 +3440,1 @@\n-        out->written += ret;\n+                out->written += ret;\n@@ -3575,4 +3596,1 @@\n-            if (out->writecallback)\n-        nbchars = xmlBufUse(out->conv);\n-            else\n-                nbchars = ret;\n+            nbchars = ret >= 0 ? ret : 0;\n@@ -3584,4 +3602,1 @@\n-            if (out->writecallback)\n-        nbchars = xmlBufUse(out->buffer);\n-            else\n-                nbchars = chunk;\n+            nbchars = chunk;\n@@ -3593,2 +3608,2 @@\n-    if ((nbchars < MINLEN) && (len <= 0))\n-        goto done;\n+            if ((nbchars < MINLEN) && (len <= 0))\n+                goto done;\n@@ -3618,1 +3633,1 @@\n-        out->written += ret;\n+                out->written += ret;\n@@ -3715,1 +3730,1 @@\n-    out->written += ret;\n+        out->written += ret;\n","filename":"modules\/javafx.web\/src\/main\/native\/Source\/ThirdParty\/libxml\/src\/xmlIO.c","additions":42,"deletions":27,"binary":false,"changes":69,"status":"modified"},{"patch":"@@ -78,1 +78,1 @@\n- * Each of the blocks allocated begin with a header containing informations\n+ * Each of the blocks allocated begin with a header containing information\n","filename":"modules\/javafx.web\/src\/main\/native\/Source\/ThirdParty\/libxml\/src\/xmlmemory.c","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -51,0 +51,7 @@\n+#ifdef FUZZING_BUILD_MODE_UNSAFE_FOR_PRODUCTION\n+\/* Keeping free objects can hide memory errors. *\/\n+#define MAX_FREE_NODES 1\n+#else\n+#define MAX_FREE_NODES 100\n+#endif\n+\n@@ -355,3 +362,1 @@\n-    if ((cur->parent != NULL) && (cur->parent->doc != NULL) &&\n-    ((cur->parent->doc->intSubset != NULL) ||\n-     (cur->parent->doc->extSubset != NULL))) {\n+    if ((cur->parent != NULL) && (cur->parent->doc != NULL)) {\n@@ -360,1 +365,3 @@\n-        if (xmlIsRef(cur->parent->doc, cur->parent, cur))\n+    if (((cur->parent->doc->intSubset != NULL) ||\n+         (cur->parent->doc->extSubset != NULL)) &&\n+            (xmlIsRef(cur->parent->doc, cur->parent, cur)))\n@@ -368,1 +375,1 @@\n-        (reader->ctxt->freeAttrsNr < 100)) {\n+        (reader->ctxt->freeAttrsNr < MAX_FREE_NODES)) {\n@@ -469,1 +476,1 @@\n-        (reader->ctxt->freeElemsNr < 100)) {\n+        (reader->ctxt->freeElemsNr < MAX_FREE_NODES)) {\n@@ -479,1 +486,1 @@\n-    cur = next;\n+        cur = next;\n@@ -557,1 +564,1 @@\n-    (reader->ctxt->freeElemsNr < 100)) {\n+    (reader->ctxt->freeElemsNr < MAX_FREE_NODES)) {\n@@ -1164,1 +1171,0 @@\n-    xmlParserCtxtPtr ctxt = reader->ctxt;\n@@ -1168,10 +1174,0 @@\n-        \/*\n-         * Case where the underlying tree is not available, lookup the entity\n-         * and walk it.\n-         *\/\n-        if ((node->children == NULL) && (ctxt->sax != NULL) &&\n-        (ctxt->sax->getEntity != NULL)) {\n-        node->children = (xmlNodePtr)\n-            ctxt->sax->getEntity(ctxt, node->name);\n-        }\n-\n@@ -1505,0 +1501,2 @@\n+                if (oldnode == tmp)\n+                    oldnode = NULL;\n@@ -1590,1 +1588,2 @@\n-    if ((reader->xinclude) && (reader->node != NULL) &&\n+    if ((reader->xinclude) && (reader->in_xinclude == 0) &&\n+        (reader->node != NULL) &&\n@@ -1622,10 +1621,0 @@\n-    \/*\n-     * Case where the underlying tree is not available, lookup the entity\n-     * and walk it.\n-     *\/\n-    if ((reader->node->children == NULL) && (reader->ctxt->sax != NULL) &&\n-        (reader->ctxt->sax->getEntity != NULL)) {\n-        reader->node->children = (xmlNodePtr)\n-        reader->ctxt->sax->getEntity(reader->ctxt, reader->node->name);\n-    }\n-\n@@ -2339,0 +2328,1 @@\n+#ifdef LIBXML_VALID_ENABLED\n@@ -2344,1 +2334,1 @@\n-#endif\n+#endif \/* LIBXML_REGEXP_ENABLED *\/\n@@ -2349,0 +2339,1 @@\n+#endif \/* LIBXML_VALID_ENABLED *\/\n@@ -3031,1 +3022,1 @@\n- *          Acces API to the current node           *\n+ *          Access API to the current node          *\n@@ -3846,1 +3837,1 @@\n- * specification only the value true is accepted. The broken bahaviour of\n+ * specification only the value true is accepted. The broken behaviour of\n@@ -3908,0 +3899,1 @@\n+                ctxt->options |= XML_PARSE_DTDVALID;\n@@ -3911,0 +3903,1 @@\n+                ctxt->options &= ~XML_PARSE_DTDVALID;\n@@ -3916,0 +3909,1 @@\n+                ctxt->options |= XML_PARSE_NOENT;\n@@ -3918,0 +3912,1 @@\n+                ctxt->options &= ~XML_PARSE_NOENT;\n","filename":"modules\/javafx.web\/src\/main\/native\/Source\/ThirdParty\/libxml\/src\/xmlreader.c","additions":28,"deletions":33,"binary":false,"changes":61,"status":"modified"},{"patch":"@@ -103,1 +103,1 @@\n- * @extra:  extra informations\n+ * @extra:  extra information\n@@ -117,1 +117,1 @@\n- * @extra:  extra informations\n+ * @extra:  extra information\n@@ -593,1 +593,0 @@\n-static void xmlNodeListDumpOutput(xmlSaveCtxtPtr ctxt, xmlNodePtr cur);\n@@ -708,0 +707,1 @@\n+    xmlNodePtr cur;\n@@ -745,1 +745,3 @@\n-    xmlNodeListDumpOutput(ctxt, dtd->children);\n+    for (cur = dtd->children; cur != NULL; cur = cur->next) {\n+        xmlNodeDumpOutputInternal(ctxt, cur);\n+    }\n@@ -779,49 +781,0 @@\n-\/**\n- * xmlAttrListDumpOutput:\n- * @buf:  the XML buffer output\n- * @doc:  the document\n- * @cur:  the first attribute pointer\n- * @encoding:  an optional encoding string\n- *\n- * Dump a list of XML attributes\n- *\/\n-static void\n-xmlAttrListDumpOutput(xmlSaveCtxtPtr ctxt, xmlAttrPtr cur) {\n-    if (cur == NULL) return;\n-    while (cur != NULL) {\n-        xmlAttrDumpOutput(ctxt, cur);\n-    cur = cur->next;\n-    }\n-}\n-\n-\n-\n-\/**\n- * xmlNodeListDumpOutput:\n- * @cur:  the first node\n- *\n- * Dump an XML node list, recursive behaviour, children are printed too.\n- *\/\n-static void\n-xmlNodeListDumpOutput(xmlSaveCtxtPtr ctxt, xmlNodePtr cur) {\n-    xmlOutputBufferPtr buf;\n-\n-    if (cur == NULL) return;\n-    buf = ctxt->buf;\n-    while (cur != NULL) {\n-    if ((ctxt->format == 1) && (xmlIndentTreeOutput) &&\n-        ((cur->type == XML_ELEMENT_NODE) ||\n-         (cur->type == XML_COMMENT_NODE) ||\n-         (cur->type == XML_PI_NODE)))\n-        xmlOutputBufferWrite(buf, ctxt->indent_size *\n-                             (ctxt->level > ctxt->indent_nr ?\n-                  ctxt->indent_nr : ctxt->level),\n-                 ctxt->indent);\n-        xmlNodeDumpOutputInternal(ctxt, cur);\n-    if (ctxt->format == 1) {\n-        xmlOutputBufferWrite(buf, 1, \"\\n\");\n-    }\n-    cur = cur->next;\n-    }\n-}\n-\n@@ -830,1 +783,1 @@\n- * xmlNodeDumpOutputInternal:\n+ * htmlNodeDumpOutputInternal:\n@@ -896,2 +849,3 @@\n-    int format;\n-    xmlNodePtr tmp;\n+    int format = ctxt->format;\n+    xmlNodePtr tmp, root, unformattedNode = NULL;\n+    xmlAttrPtr attr;\n@@ -903,44 +857,97 @@\n-    if (cur->type == XML_XINCLUDE_START)\n-    return;\n-    if (cur->type == XML_XINCLUDE_END)\n-    return;\n-    if ((cur->type == XML_DOCUMENT_NODE) ||\n-        (cur->type == XML_HTML_DOCUMENT_NODE)) {\n-    xmlDocContentDumpOutput(ctxt, (xmlDocPtr) cur);\n-    return;\n-    }\n-#ifdef LIBXML_HTML_ENABLED\n-    if (ctxt->options & XML_SAVE_XHTML) {\n-        xhtmlNodeDumpOutput(ctxt, cur);\n-        return;\n-    }\n-    if (((cur->type != XML_NAMESPACE_DECL) && (cur->doc != NULL) &&\n-         (cur->doc->type == XML_HTML_DOCUMENT_NODE) &&\n-         ((ctxt->options & XML_SAVE_AS_XML) == 0)) ||\n-        (ctxt->options & XML_SAVE_AS_HTML)) {\n-    htmlNodeDumpOutputInternal(ctxt, cur);\n-    return;\n-    }\n-#endif\n-    if (cur->type == XML_DTD_NODE) {\n-        xmlDtdDumpOutput(ctxt, (xmlDtdPtr) cur);\n-    return;\n-    }\n-    if (cur->type == XML_DOCUMENT_FRAG_NODE) {\n-        xmlNodeListDumpOutput(ctxt, cur->children);\n-    return;\n-    }\n-    if (cur->type == XML_ELEMENT_DECL) {\n-        xmlBufDumpElementDecl(buf->buffer, (xmlElementPtr) cur);\n-    return;\n-    }\n-    if (cur->type == XML_ATTRIBUTE_DECL) {\n-        xmlBufDumpAttributeDecl(buf->buffer, (xmlAttributePtr) cur);\n-    return;\n-    }\n-    if (cur->type == XML_ENTITY_DECL) {\n-        xmlBufDumpEntityDecl(buf->buffer, (xmlEntityPtr) cur);\n-    return;\n-    }\n-    if (cur->type == XML_TEXT_NODE) {\n-    if (cur->content != NULL) {\n+\n+    root = cur;\n+    while (1) {\n+        switch (cur->type) {\n+        case XML_DOCUMENT_NODE:\n+        case XML_HTML_DOCUMENT_NODE:\n+        xmlDocContentDumpOutput(ctxt, (xmlDocPtr) cur);\n+        break;\n+\n+        case XML_DTD_NODE:\n+            xmlDtdDumpOutput(ctxt, (xmlDtdPtr) cur);\n+            break;\n+\n+        case XML_DOCUMENT_FRAG_NODE:\n+            if (cur->children != NULL) {\n+                cur = cur->children;\n+                continue;\n+            }\n+        break;\n+\n+        case XML_ELEMENT_DECL:\n+            xmlBufDumpElementDecl(buf->buffer, (xmlElementPtr) cur);\n+            break;\n+\n+        case XML_ATTRIBUTE_DECL:\n+            xmlBufDumpAttributeDecl(buf->buffer, (xmlAttributePtr) cur);\n+            break;\n+\n+        case XML_ENTITY_DECL:\n+            xmlBufDumpEntityDecl(buf->buffer, (xmlEntityPtr) cur);\n+            break;\n+\n+        case XML_ELEMENT_NODE:\n+        if ((cur != root) && (ctxt->format == 1) && (xmlIndentTreeOutput))\n+        xmlOutputBufferWrite(buf, ctxt->indent_size *\n+                     (ctxt->level > ctxt->indent_nr ?\n+                      ctxt->indent_nr : ctxt->level),\n+                     ctxt->indent);\n+\n+            xmlOutputBufferWrite(buf, 1, \"<\");\n+            if ((cur->ns != NULL) && (cur->ns->prefix != NULL)) {\n+                xmlOutputBufferWriteString(buf, (const char *)cur->ns->prefix);\n+                xmlOutputBufferWrite(buf, 1, \":\");\n+            }\n+            xmlOutputBufferWriteString(buf, (const char *)cur->name);\n+            if (cur->nsDef)\n+                xmlNsListDumpOutputCtxt(ctxt, cur->nsDef);\n+            for (attr = cur->properties; attr != NULL; attr = attr->next)\n+                xmlAttrDumpOutput(ctxt, attr);\n+\n+            if (cur->children == NULL) {\n+                if ((ctxt->options & XML_SAVE_NO_EMPTY) == 0) {\n+                    if (ctxt->format == 2)\n+                        xmlOutputBufferWriteWSNonSig(ctxt, 0);\n+                    xmlOutputBufferWrite(buf, 2, \"\/>\");\n+                } else {\n+                    if (ctxt->format == 2)\n+                        xmlOutputBufferWriteWSNonSig(ctxt, 1);\n+                    xmlOutputBufferWrite(buf, 3, \"><\/\");\n+                    if ((cur->ns != NULL) && (cur->ns->prefix != NULL)) {\n+                        xmlOutputBufferWriteString(buf,\n+                                (const char *)cur->ns->prefix);\n+                        xmlOutputBufferWrite(buf, 1, \":\");\n+                    }\n+                    xmlOutputBufferWriteString(buf, (const char *)cur->name);\n+                    if (ctxt->format == 2)\n+                        xmlOutputBufferWriteWSNonSig(ctxt, 0);\n+                    xmlOutputBufferWrite(buf, 1, \">\");\n+                }\n+            } else {\n+                if (ctxt->format == 1) {\n+                    tmp = cur->children;\n+                    while (tmp != NULL) {\n+                        if ((tmp->type == XML_TEXT_NODE) ||\n+                            (tmp->type == XML_CDATA_SECTION_NODE) ||\n+                            (tmp->type == XML_ENTITY_REF_NODE)) {\n+                            ctxt->format = 0;\n+                            unformattedNode = cur;\n+                            break;\n+                        }\n+                        tmp = tmp->next;\n+                    }\n+                }\n+                if (ctxt->format == 2)\n+                    xmlOutputBufferWriteWSNonSig(ctxt, 1);\n+                xmlOutputBufferWrite(buf, 1, \">\");\n+                if (ctxt->format == 1) xmlOutputBufferWrite(buf, 1, \"\\n\");\n+                if (ctxt->level >= 0) ctxt->level++;\n+                cur = cur->children;\n+                continue;\n+            }\n+\n+            break;\n+\n+        case XML_TEXT_NODE:\n+        if (cur->content == NULL)\n+                break;\n@@ -955,1 +962,1 @@\n-    }\n+        break;\n@@ -957,69 +964,27 @@\n-    return;\n-    }\n-    if (cur->type == XML_PI_NODE) {\n-    if (cur->content != NULL) {\n-        xmlOutputBufferWrite(buf, 2, \"<?\");\n-        xmlOutputBufferWriteString(buf, (const char *)cur->name);\n-        if (cur->content != NULL) {\n-            if (ctxt->format == 2)\n-                xmlOutputBufferWriteWSNonSig(ctxt, 0);\n-            else\n-                xmlOutputBufferWrite(buf, 1, \" \");\n-        xmlOutputBufferWriteString(buf, (const char *)cur->content);\n-        }\n-        xmlOutputBufferWrite(buf, 2, \"?>\");\n-    } else {\n-        xmlOutputBufferWrite(buf, 2, \"<?\");\n-        xmlOutputBufferWriteString(buf, (const char *)cur->name);\n-        if (ctxt->format == 2)\n-            xmlOutputBufferWriteWSNonSig(ctxt, 0);\n-        xmlOutputBufferWrite(buf, 2, \"?>\");\n-    }\n-    return;\n-    }\n-    if (cur->type == XML_COMMENT_NODE) {\n-    if (cur->content != NULL) {\n-        xmlOutputBufferWrite(buf, 4, \"<!--\");\n-        xmlOutputBufferWriteString(buf, (const char *)cur->content);\n-        xmlOutputBufferWrite(buf, 3, \"-->\");\n-    }\n-    return;\n-    }\n-    if (cur->type == XML_ENTITY_REF_NODE) {\n-        xmlOutputBufferWrite(buf, 1, \"&\");\n-    xmlOutputBufferWriteString(buf, (const char *)cur->name);\n-        xmlOutputBufferWrite(buf, 1, \";\");\n-    return;\n-    }\n-    if (cur->type == XML_CDATA_SECTION_NODE) {\n-    if (cur->content == NULL || *cur->content == '\\0') {\n-        xmlOutputBufferWrite(buf, 12, \"<![CDATA[]]>\");\n-    } else {\n-        start = end = cur->content;\n-        while (*end != '\\0') {\n-        if ((*end == ']') && (*(end + 1) == ']') &&\n-            (*(end + 2) == '>')) {\n-            end = end + 2;\n-            xmlOutputBufferWrite(buf, 9, \"<![CDATA[\");\n-            xmlOutputBufferWrite(buf, end - start, (const char *)start);\n-            xmlOutputBufferWrite(buf, 3, \"]]>\");\n-            start = end;\n-        }\n-        end++;\n-        }\n-        if (start != end) {\n-        xmlOutputBufferWrite(buf, 9, \"<![CDATA[\");\n-        xmlOutputBufferWriteString(buf, (const char *)start);\n-        xmlOutputBufferWrite(buf, 3, \"]]>\");\n-        }\n-    }\n-    return;\n-    }\n-    if (cur->type == XML_ATTRIBUTE_NODE) {\n-    xmlAttrDumpOutput(ctxt, (xmlAttrPtr) cur);\n-    return;\n-    }\n-    if (cur->type == XML_NAMESPACE_DECL) {\n-    xmlNsDumpOutputCtxt(ctxt, (xmlNsPtr) cur);\n-    return;\n-    }\n+        case XML_PI_NODE:\n+        if ((cur != root) && (ctxt->format == 1) && (xmlIndentTreeOutput))\n+        xmlOutputBufferWrite(buf, ctxt->indent_size *\n+                     (ctxt->level > ctxt->indent_nr ?\n+                      ctxt->indent_nr : ctxt->level),\n+                     ctxt->indent);\n+\n+            if (cur->content != NULL) {\n+                xmlOutputBufferWrite(buf, 2, \"<?\");\n+                xmlOutputBufferWriteString(buf, (const char *)cur->name);\n+                if (cur->content != NULL) {\n+                    if (ctxt->format == 2)\n+                        xmlOutputBufferWriteWSNonSig(ctxt, 0);\n+                    else\n+                        xmlOutputBufferWrite(buf, 1, \" \");\n+                    xmlOutputBufferWriteString(buf,\n+                            (const char *)cur->content);\n+                }\n+                xmlOutputBufferWrite(buf, 2, \"?>\");\n+            } else {\n+                xmlOutputBufferWrite(buf, 2, \"<?\");\n+                xmlOutputBufferWriteString(buf, (const char *)cur->name);\n+                if (ctxt->format == 2)\n+                    xmlOutputBufferWriteWSNonSig(ctxt, 0);\n+                xmlOutputBufferWrite(buf, 2, \"?>\");\n+            }\n+            break;\n@@ -1027,9 +992,55 @@\n-    format = ctxt->format;\n-    if (format == 1) {\n-    tmp = cur->children;\n-    while (tmp != NULL) {\n-        if ((tmp->type == XML_TEXT_NODE) ||\n-        (tmp->type == XML_CDATA_SECTION_NODE) ||\n-        (tmp->type == XML_ENTITY_REF_NODE)) {\n-        ctxt->format = 0;\n-        break;\n+        case XML_COMMENT_NODE:\n+        if ((cur != root) && (ctxt->format == 1) && (xmlIndentTreeOutput))\n+        xmlOutputBufferWrite(buf, ctxt->indent_size *\n+                     (ctxt->level > ctxt->indent_nr ?\n+                      ctxt->indent_nr : ctxt->level),\n+                     ctxt->indent);\n+\n+            if (cur->content != NULL) {\n+                xmlOutputBufferWrite(buf, 4, \"<!--\");\n+                xmlOutputBufferWriteString(buf, (const char *)cur->content);\n+                xmlOutputBufferWrite(buf, 3, \"-->\");\n+            }\n+            break;\n+\n+        case XML_ENTITY_REF_NODE:\n+            xmlOutputBufferWrite(buf, 1, \"&\");\n+            xmlOutputBufferWriteString(buf, (const char *)cur->name);\n+            xmlOutputBufferWrite(buf, 1, \";\");\n+            break;\n+\n+        case XML_CDATA_SECTION_NODE:\n+            if (cur->content == NULL || *cur->content == '\\0') {\n+                xmlOutputBufferWrite(buf, 12, \"<![CDATA[]]>\");\n+            } else {\n+                start = end = cur->content;\n+                while (*end != '\\0') {\n+                    if ((*end == ']') && (*(end + 1) == ']') &&\n+                        (*(end + 2) == '>')) {\n+                        end = end + 2;\n+                        xmlOutputBufferWrite(buf, 9, \"<![CDATA[\");\n+                        xmlOutputBufferWrite(buf, end - start,\n+                                (const char *)start);\n+                        xmlOutputBufferWrite(buf, 3, \"]]>\");\n+                        start = end;\n+                    }\n+                    end++;\n+                }\n+                if (start != end) {\n+                    xmlOutputBufferWrite(buf, 9, \"<![CDATA[\");\n+                    xmlOutputBufferWriteString(buf, (const char *)start);\n+                    xmlOutputBufferWrite(buf, 3, \"]]>\");\n+                }\n+            }\n+            break;\n+\n+        case XML_ATTRIBUTE_NODE:\n+            xmlAttrDumpOutput(ctxt, (xmlAttrPtr) cur);\n+            break;\n+\n+        case XML_NAMESPACE_DECL:\n+            xmlNsDumpOutputCtxt(ctxt, (xmlNsPtr) cur);\n+            break;\n+\n+        default:\n+            break;\n@@ -1037,8 +1048,0 @@\n-        tmp = tmp->next;\n-    }\n-    }\n-    xmlOutputBufferWrite(buf, 1, \"<\");\n-    if ((cur->ns != NULL) && (cur->ns->prefix != NULL)) {\n-        xmlOutputBufferWriteString(buf, (const char *)cur->ns->prefix);\n-    xmlOutputBufferWrite(buf, 1, \":\");\n-    }\n@@ -1046,36 +1049,11 @@\n-    xmlOutputBufferWriteString(buf, (const char *)cur->name);\n-    if (cur->nsDef)\n-        xmlNsListDumpOutputCtxt(ctxt, cur->nsDef);\n-    if (cur->properties != NULL)\n-        xmlAttrListDumpOutput(ctxt, cur->properties);\n-\n-    if (((cur->type == XML_ELEMENT_NODE) || (cur->content == NULL)) &&\n-    (cur->children == NULL) && ((ctxt->options & XML_SAVE_NO_EMPTY) == 0)) {\n-        if (ctxt->format == 2)\n-            xmlOutputBufferWriteWSNonSig(ctxt, 0);\n-        xmlOutputBufferWrite(buf, 2, \"\/>\");\n-    ctxt->format = format;\n-    return;\n-    }\n-    if (ctxt->format == 2)\n-        xmlOutputBufferWriteWSNonSig(ctxt, 1);\n-    xmlOutputBufferWrite(buf, 1, \">\");\n-    if ((cur->type != XML_ELEMENT_NODE) && (cur->content != NULL)) {\n-    xmlOutputBufferWriteEscape(buf, cur->content, ctxt->escape);\n-    }\n-    if (cur->children != NULL) {\n-    if (ctxt->format == 1) xmlOutputBufferWrite(buf, 1, \"\\n\");\n-    if (ctxt->level >= 0) ctxt->level++;\n-    xmlNodeListDumpOutput(ctxt, cur->children);\n-    if (ctxt->level > 0) ctxt->level--;\n-    if ((xmlIndentTreeOutput) && (ctxt->format == 1))\n-        xmlOutputBufferWrite(buf, ctxt->indent_size *\n-                             (ctxt->level > ctxt->indent_nr ?\n-                  ctxt->indent_nr : ctxt->level),\n-                 ctxt->indent);\n-    }\n-    xmlOutputBufferWrite(buf, 2, \"<\/\");\n-    if ((cur->ns != NULL) && (cur->ns->prefix != NULL)) {\n-        xmlOutputBufferWriteString(buf, (const char *)cur->ns->prefix);\n-    xmlOutputBufferWrite(buf, 1, \":\");\n-    }\n+        while (1) {\n+            if (cur == root)\n+                return;\n+            if ((ctxt->format == 1) &&\n+                (cur->type != XML_XINCLUDE_START) &&\n+                (cur->type != XML_XINCLUDE_END))\n+                xmlOutputBufferWrite(buf, 1, \"\\n\");\n+            if (cur->next != NULL) {\n+                cur = cur->next;\n+                break;\n+            }\n@@ -1083,5 +1061,35 @@\n-    xmlOutputBufferWriteString(buf, (const char *)cur->name);\n-    if (ctxt->format == 2)\n-        xmlOutputBufferWriteWSNonSig(ctxt, 0);\n-    xmlOutputBufferWrite(buf, 1, \">\");\n-    ctxt->format = format;\n+            \/*\n+             * The parent should never be NULL here but we want to handle\n+             * corrupted documents gracefully.\n+             *\/\n+            if (cur->parent == NULL)\n+                return;\n+            cur = cur->parent;\n+\n+            if (cur->type == XML_ELEMENT_NODE) {\n+                if (ctxt->level > 0) ctxt->level--;\n+                if ((xmlIndentTreeOutput) && (ctxt->format == 1))\n+                    xmlOutputBufferWrite(buf, ctxt->indent_size *\n+                                         (ctxt->level > ctxt->indent_nr ?\n+                                          ctxt->indent_nr : ctxt->level),\n+                                         ctxt->indent);\n+\n+                xmlOutputBufferWrite(buf, 2, \"<\/\");\n+                if ((cur->ns != NULL) && (cur->ns->prefix != NULL)) {\n+                    xmlOutputBufferWriteString(buf,\n+                            (const char *)cur->ns->prefix);\n+                    xmlOutputBufferWrite(buf, 1, \":\");\n+                }\n+\n+                xmlOutputBufferWriteString(buf, (const char *)cur->name);\n+                if (ctxt->format == 2)\n+                    xmlOutputBufferWriteWSNonSig(ctxt, 0);\n+                xmlOutputBufferWrite(buf, 1, \">\");\n+\n+                if (cur == unformattedNode) {\n+                    ctxt->format = format;\n+                    unformattedNode = NULL;\n+                }\n+            }\n+        }\n+    }\n@@ -1227,1 +1235,3 @@\n-        xmlOutputBufferWrite(buf, 1, \"\\n\");\n+                if ((child->type != XML_XINCLUDE_START) &&\n+                    (child->type != XML_XINCLUDE_END))\n+                    xmlOutputBufferWrite(buf, 1, \"\\n\");\n@@ -1398,34 +1408,0 @@\n-\/**\n- * xhtmlNodeListDumpOutput:\n- * @buf:  the XML buffer output\n- * @doc:  the XHTML document\n- * @cur:  the first node\n- * @level: the imbrication level for indenting\n- * @format: is formatting allowed\n- * @encoding:  an optional encoding string\n- *\n- * Dump an XML node list, recursive behaviour, children are printed too.\n- * Note that @format = 1 provide node indenting only if xmlIndentTreeOutput = 1\n- * or xmlKeepBlanksDefault(0) was called\n- *\/\n-static void\n-xhtmlNodeListDumpOutput(xmlSaveCtxtPtr ctxt, xmlNodePtr cur) {\n-    xmlOutputBufferPtr buf;\n-\n-    if (cur == NULL) return;\n-    buf = ctxt->buf;\n-    while (cur != NULL) {\n-    if ((ctxt->format == 1) && (xmlIndentTreeOutput) &&\n-        (cur->type == XML_ELEMENT_NODE))\n-        xmlOutputBufferWrite(buf, ctxt->indent_size *\n-                             (ctxt->level > ctxt->indent_nr ?\n-                  ctxt->indent_nr : ctxt->level),\n-                 ctxt->indent);\n-        xhtmlNodeDumpOutput(ctxt, cur);\n-    if (ctxt->format == 1) {\n-        xmlOutputBufferWrite(buf, 1, \"\\n\");\n-    }\n-    cur = cur->next;\n-    }\n-}\n-\n@@ -1445,2 +1421,2 @@\n-    int format, addmeta = 0;\n-    xmlNodePtr tmp;\n+    int format = ctxt->format, addmeta;\n+    xmlNodePtr tmp, root, unformattedNode = NULL;\n@@ -1448,1 +1424,1 @@\n-    xmlOutputBufferPtr buf;\n+    xmlOutputBufferPtr buf = ctxt->buf;\n@@ -1451,36 +1427,183 @@\n-    if ((cur->type == XML_DOCUMENT_NODE) ||\n-        (cur->type == XML_HTML_DOCUMENT_NODE)) {\n-        xmlDocContentDumpOutput(ctxt, (xmlDocPtr) cur);\n-    return;\n-    }\n-    if (cur->type == XML_XINCLUDE_START)\n-    return;\n-    if (cur->type == XML_XINCLUDE_END)\n-    return;\n-    if (cur->type == XML_NAMESPACE_DECL) {\n-    xmlNsDumpOutputCtxt(ctxt, (xmlNsPtr) cur);\n-    return;\n-    }\n-    if (cur->type == XML_DTD_NODE) {\n-        xmlDtdDumpOutput(ctxt, (xmlDtdPtr) cur);\n-    return;\n-    }\n-    if (cur->type == XML_DOCUMENT_FRAG_NODE) {\n-        xhtmlNodeListDumpOutput(ctxt, cur->children);\n-    return;\n-    }\n-    buf = ctxt->buf;\n-    if (cur->type == XML_ELEMENT_DECL) {\n-        xmlBufDumpElementDecl(buf->buffer, (xmlElementPtr) cur);\n-    return;\n-    }\n-    if (cur->type == XML_ATTRIBUTE_DECL) {\n-        xmlBufDumpAttributeDecl(buf->buffer, (xmlAttributePtr) cur);\n-    return;\n-    }\n-    if (cur->type == XML_ENTITY_DECL) {\n-        xmlBufDumpEntityDecl(buf->buffer, (xmlEntityPtr) cur);\n-    return;\n-    }\n-    if (cur->type == XML_TEXT_NODE) {\n-    if (cur->content != NULL) {\n+\n+    root = cur;\n+    while (1) {\n+        switch (cur->type) {\n+        case XML_DOCUMENT_NODE:\n+        case XML_HTML_DOCUMENT_NODE:\n+            xmlDocContentDumpOutput(ctxt, (xmlDocPtr) cur);\n+        break;\n+\n+        case XML_NAMESPACE_DECL:\n+        xmlNsDumpOutputCtxt(ctxt, (xmlNsPtr) cur);\n+        break;\n+\n+        case XML_DTD_NODE:\n+            xmlDtdDumpOutput(ctxt, (xmlDtdPtr) cur);\n+        break;\n+\n+        case XML_DOCUMENT_FRAG_NODE:\n+            if (cur->children) {\n+                cur = cur->children;\n+                continue;\n+            }\n+            break;\n+\n+        case XML_ELEMENT_DECL:\n+            xmlBufDumpElementDecl(buf->buffer, (xmlElementPtr) cur);\n+        break;\n+\n+        case XML_ATTRIBUTE_DECL:\n+            xmlBufDumpAttributeDecl(buf->buffer, (xmlAttributePtr) cur);\n+        break;\n+\n+        case XML_ENTITY_DECL:\n+            xmlBufDumpEntityDecl(buf->buffer, (xmlEntityPtr) cur);\n+        break;\n+\n+        case XML_ELEMENT_NODE:\n+            addmeta = 0;\n+\n+        if ((cur != root) && (ctxt->format == 1) && (xmlIndentTreeOutput))\n+        xmlOutputBufferWrite(buf, ctxt->indent_size *\n+                     (ctxt->level > ctxt->indent_nr ?\n+                      ctxt->indent_nr : ctxt->level),\n+                     ctxt->indent);\n+\n+            xmlOutputBufferWrite(buf, 1, \"<\");\n+            if ((cur->ns != NULL) && (cur->ns->prefix != NULL)) {\n+                xmlOutputBufferWriteString(buf, (const char *)cur->ns->prefix);\n+                xmlOutputBufferWrite(buf, 1, \":\");\n+            }\n+\n+            xmlOutputBufferWriteString(buf, (const char *)cur->name);\n+            if (cur->nsDef)\n+                xmlNsListDumpOutputCtxt(ctxt, cur->nsDef);\n+            if ((xmlStrEqual(cur->name, BAD_CAST \"html\") &&\n+                (cur->ns == NULL) && (cur->nsDef == NULL))) {\n+                \/*\n+                 * 3.1.1. Strictly Conforming Documents A.3.1.1 3\/\n+                 *\/\n+                xmlOutputBufferWriteString(buf,\n+                        \" xmlns=\\\"http:\/\/www.w3.org\/1999\/xhtml\\\"\");\n+            }\n+            if (cur->properties != NULL)\n+                xhtmlAttrListDumpOutput(ctxt, cur->properties);\n+\n+            if ((cur->parent != NULL) &&\n+                (cur->parent->parent == (xmlNodePtr) cur->doc) &&\n+                xmlStrEqual(cur->name, BAD_CAST\"head\") &&\n+                xmlStrEqual(cur->parent->name, BAD_CAST\"html\")) {\n+\n+                tmp = cur->children;\n+                while (tmp != NULL) {\n+                    if (xmlStrEqual(tmp->name, BAD_CAST\"meta\")) {\n+                        xmlChar *httpequiv;\n+\n+                        httpequiv = xmlGetProp(tmp, BAD_CAST\"http-equiv\");\n+                        if (httpequiv != NULL) {\n+                            if (xmlStrcasecmp(httpequiv,\n+                                        BAD_CAST\"Content-Type\") == 0) {\n+                                xmlFree(httpequiv);\n+                                break;\n+                            }\n+                            xmlFree(httpequiv);\n+                        }\n+                    }\n+                    tmp = tmp->next;\n+                }\n+                if (tmp == NULL)\n+                    addmeta = 1;\n+            }\n+\n+            if (cur->children == NULL) {\n+                if (((cur->ns == NULL) || (cur->ns->prefix == NULL)) &&\n+                    ((xhtmlIsEmpty(cur) == 1) && (addmeta == 0))) {\n+                    \/*\n+                     * C.2. Empty Elements\n+                     *\/\n+                    xmlOutputBufferWrite(buf, 3, \" \/>\");\n+                } else {\n+                    if (addmeta == 1) {\n+                        xmlOutputBufferWrite(buf, 1, \">\");\n+                        if (ctxt->format == 1) {\n+                            xmlOutputBufferWrite(buf, 1, \"\\n\");\n+                            if (xmlIndentTreeOutput)\n+                                xmlOutputBufferWrite(buf, ctxt->indent_size *\n+                                    (ctxt->level + 1 > ctxt->indent_nr ?\n+                                    ctxt->indent_nr : ctxt->level + 1),\n+                                    ctxt->indent);\n+                        }\n+                        xmlOutputBufferWriteString(buf,\n+                                \"<meta http-equiv=\\\"Content-Type\\\" \"\n+                                \"content=\\\"text\/html; charset=\");\n+                        if (ctxt->encoding) {\n+                            xmlOutputBufferWriteString(buf,\n+                                    (const char *)ctxt->encoding);\n+                        } else {\n+                            xmlOutputBufferWrite(buf, 5, \"UTF-8\");\n+                        }\n+                        xmlOutputBufferWrite(buf, 4, \"\\\" \/>\");\n+                        if (ctxt->format == 1)\n+                            xmlOutputBufferWrite(buf, 1, \"\\n\");\n+                    } else {\n+                        xmlOutputBufferWrite(buf, 1, \">\");\n+                    }\n+                    \/*\n+                     * C.3. Element Minimization and Empty Element Content\n+                     *\/\n+                    xmlOutputBufferWrite(buf, 2, \"<\/\");\n+                    if ((cur->ns != NULL) && (cur->ns->prefix != NULL)) {\n+                        xmlOutputBufferWriteString(buf,\n+                                (const char *)cur->ns->prefix);\n+                        xmlOutputBufferWrite(buf, 1, \":\");\n+                    }\n+                    xmlOutputBufferWriteString(buf, (const char *)cur->name);\n+                    xmlOutputBufferWrite(buf, 1, \">\");\n+                }\n+            } else {\n+                xmlOutputBufferWrite(buf, 1, \">\");\n+                if (addmeta == 1) {\n+                    if (ctxt->format == 1) {\n+                        xmlOutputBufferWrite(buf, 1, \"\\n\");\n+                        if (xmlIndentTreeOutput)\n+                            xmlOutputBufferWrite(buf, ctxt->indent_size *\n+                                (ctxt->level + 1 > ctxt->indent_nr ?\n+                                ctxt->indent_nr : ctxt->level + 1),\n+                                ctxt->indent);\n+                    }\n+                    xmlOutputBufferWriteString(buf,\n+                            \"<meta http-equiv=\\\"Content-Type\\\" \"\n+                            \"content=\\\"text\/html; charset=\");\n+                    if (ctxt->encoding) {\n+                        xmlOutputBufferWriteString(buf,\n+                                (const char *)ctxt->encoding);\n+                    } else {\n+                        xmlOutputBufferWrite(buf, 5, \"UTF-8\");\n+                    }\n+                    xmlOutputBufferWrite(buf, 4, \"\\\" \/>\");\n+                }\n+\n+                if (ctxt->format == 1) {\n+                    tmp = cur->children;\n+                    while (tmp != NULL) {\n+                        if ((tmp->type == XML_TEXT_NODE) ||\n+                            (tmp->type == XML_ENTITY_REF_NODE)) {\n+                            unformattedNode = cur;\n+                            ctxt->format = 0;\n+                            break;\n+                        }\n+                        tmp = tmp->next;\n+                    }\n+                }\n+\n+                if (ctxt->format == 1) xmlOutputBufferWrite(buf, 1, \"\\n\");\n+                if (ctxt->level >= 0) ctxt->level++;\n+                cur = cur->children;\n+                continue;\n+            }\n+\n+            break;\n+\n+        case XML_TEXT_NODE:\n+        if (cur->content == NULL)\n+                break;\n@@ -1496,69 +1619,0 @@\n-    }\n-\n-    return;\n-    }\n-    if (cur->type == XML_PI_NODE) {\n-    if (cur->content != NULL) {\n-        xmlOutputBufferWrite(buf, 2, \"<?\");\n-        xmlOutputBufferWriteString(buf, (const char *)cur->name);\n-        if (cur->content != NULL) {\n-        xmlOutputBufferWrite(buf, 1, \" \");\n-        xmlOutputBufferWriteString(buf, (const char *)cur->content);\n-        }\n-        xmlOutputBufferWrite(buf, 2, \"?>\");\n-    } else {\n-        xmlOutputBufferWrite(buf, 2, \"<?\");\n-        xmlOutputBufferWriteString(buf, (const char *)cur->name);\n-        xmlOutputBufferWrite(buf, 2, \"?>\");\n-    }\n-    return;\n-    }\n-    if (cur->type == XML_COMMENT_NODE) {\n-    if (cur->content != NULL) {\n-        xmlOutputBufferWrite(buf, 4, \"<!--\");\n-        xmlOutputBufferWriteString(buf, (const char *)cur->content);\n-        xmlOutputBufferWrite(buf, 3, \"-->\");\n-    }\n-    return;\n-    }\n-    if (cur->type == XML_ENTITY_REF_NODE) {\n-        xmlOutputBufferWrite(buf, 1, \"&\");\n-    xmlOutputBufferWriteString(buf, (const char *)cur->name);\n-        xmlOutputBufferWrite(buf, 1, \";\");\n-    return;\n-    }\n-    if (cur->type == XML_CDATA_SECTION_NODE) {\n-    if (cur->content == NULL || *cur->content == '\\0') {\n-        xmlOutputBufferWrite(buf, 12, \"<![CDATA[]]>\");\n-    } else {\n-        start = end = cur->content;\n-        while (*end != '\\0') {\n-        if (*end == ']' && *(end + 1) == ']' && *(end + 2) == '>') {\n-            end = end + 2;\n-            xmlOutputBufferWrite(buf, 9, \"<![CDATA[\");\n-            xmlOutputBufferWrite(buf, end - start, (const char *)start);\n-            xmlOutputBufferWrite(buf, 3, \"]]>\");\n-            start = end;\n-        }\n-        end++;\n-        }\n-        if (start != end) {\n-        xmlOutputBufferWrite(buf, 9, \"<![CDATA[\");\n-        xmlOutputBufferWriteString(buf, (const char *)start);\n-        xmlOutputBufferWrite(buf, 3, \"]]>\");\n-        }\n-    }\n-    return;\n-    }\n-    if (cur->type == XML_ATTRIBUTE_NODE) {\n-        xmlAttrDumpOutput(ctxt, (xmlAttrPtr) cur);\n-    return;\n-    }\n-\n-    format = ctxt->format;\n-    if (format == 1) {\n-    tmp = cur->children;\n-    while (tmp != NULL) {\n-        if ((tmp->type == XML_TEXT_NODE) ||\n-        (tmp->type == XML_ENTITY_REF_NODE)) {\n-        format = 0;\n@@ -1566,9 +1620,0 @@\n-        }\n-        tmp = tmp->next;\n-    }\n-    }\n-    xmlOutputBufferWrite(buf, 1, \"<\");\n-    if ((cur->ns != NULL) && (cur->ns->prefix != NULL)) {\n-        xmlOutputBufferWriteString(buf, (const char *)cur->ns->prefix);\n-    xmlOutputBufferWrite(buf, 1, \":\");\n-    }\n@@ -1576,32 +1621,8 @@\n-    xmlOutputBufferWriteString(buf, (const char *)cur->name);\n-    if (cur->nsDef)\n-        xmlNsListDumpOutputCtxt(ctxt, cur->nsDef);\n-    if ((xmlStrEqual(cur->name, BAD_CAST \"html\") &&\n-    (cur->ns == NULL) && (cur->nsDef == NULL))) {\n-    \/*\n-     * 3.1.1. Strictly Conforming Documents A.3.1.1 3\/\n-     *\/\n-    xmlOutputBufferWriteString(buf,\n-        \" xmlns=\\\"http:\/\/www.w3.org\/1999\/xhtml\\\"\");\n-    }\n-    if (cur->properties != NULL)\n-        xhtmlAttrListDumpOutput(ctxt, cur->properties);\n-\n-    if ((cur->type == XML_ELEMENT_NODE) &&\n-        (cur->parent != NULL) &&\n-        (cur->parent->parent == (xmlNodePtr) cur->doc) &&\n-        xmlStrEqual(cur->name, BAD_CAST\"head\") &&\n-        xmlStrEqual(cur->parent->name, BAD_CAST\"html\")) {\n-\n-        tmp = cur->children;\n-        while (tmp != NULL) {\n-            if (xmlStrEqual(tmp->name, BAD_CAST\"meta\")) {\n-                xmlChar *httpequiv;\n-\n-                httpequiv = xmlGetProp(tmp, BAD_CAST\"http-equiv\");\n-                if (httpequiv != NULL) {\n-                    if (xmlStrcasecmp(httpequiv, BAD_CAST\"Content-Type\") == 0) {\n-                        xmlFree(httpequiv);\n-                        break;\n-                    }\n-                    xmlFree(httpequiv);\n+        case XML_PI_NODE:\n+            if (cur->content != NULL) {\n+                xmlOutputBufferWrite(buf, 2, \"<?\");\n+                xmlOutputBufferWriteString(buf, (const char *)cur->name);\n+                if (cur->content != NULL) {\n+                    xmlOutputBufferWrite(buf, 1, \" \");\n+                    xmlOutputBufferWriteString(buf,\n+                            (const char *)cur->content);\n@@ -1609,0 +1630,5 @@\n+                xmlOutputBufferWrite(buf, 2, \"?>\");\n+            } else {\n+                xmlOutputBufferWrite(buf, 2, \"<?\");\n+                xmlOutputBufferWriteString(buf, (const char *)cur->name);\n+                xmlOutputBufferWrite(buf, 2, \"?>\");\n@@ -1610,5 +1636,1 @@\n-            tmp = tmp->next;\n-        }\n-        if (tmp == NULL)\n-            addmeta = 1;\n-    }\n+            break;\n@@ -1616,16 +1638,5 @@\n-    if ((cur->type == XML_ELEMENT_NODE) && (cur->children == NULL)) {\n-    if (((cur->ns == NULL) || (cur->ns->prefix == NULL)) &&\n-        ((xhtmlIsEmpty(cur) == 1) && (addmeta == 0))) {\n-        \/*\n-         * C.2. Empty Elements\n-         *\/\n-        xmlOutputBufferWrite(buf, 3, \" \/>\");\n-    } else {\n-        if (addmeta == 1) {\n-            xmlOutputBufferWrite(buf, 1, \">\");\n-            if (ctxt->format == 1) {\n-                xmlOutputBufferWrite(buf, 1, \"\\n\");\n-                if (xmlIndentTreeOutput)\n-                    xmlOutputBufferWrite(buf, ctxt->indent_size *\n-                    (ctxt->level + 1 > ctxt->indent_nr ?\n-                    ctxt->indent_nr : ctxt->level + 1), ctxt->indent);\n+        case XML_COMMENT_NODE:\n+            if (cur->content != NULL) {\n+                xmlOutputBufferWrite(buf, 4, \"<!--\");\n+                xmlOutputBufferWriteString(buf, (const char *)cur->content);\n+                xmlOutputBufferWrite(buf, 3, \"-->\");\n@@ -1633,4 +1644,11 @@\n-            xmlOutputBufferWriteString(buf,\n-                \"<meta http-equiv=\\\"Content-Type\\\" content=\\\"text\/html; charset=\");\n-            if (ctxt->encoding) {\n-                xmlOutputBufferWriteString(buf, (const char *)ctxt->encoding);\n+            break;\n+\n+        case XML_ENTITY_REF_NODE:\n+            xmlOutputBufferWrite(buf, 1, \"&\");\n+            xmlOutputBufferWriteString(buf, (const char *)cur->name);\n+            xmlOutputBufferWrite(buf, 1, \";\");\n+            break;\n+\n+        case XML_CDATA_SECTION_NODE:\n+            if (cur->content == NULL || *cur->content == '\\0') {\n+                xmlOutputBufferWrite(buf, 12, \"<![CDATA[]]>\");\n@@ -1638,1 +1656,18 @@\n-                xmlOutputBufferWrite(buf, 5, \"UTF-8\");\n+                start = end = cur->content;\n+                while (*end != '\\0') {\n+                    if (*end == ']' && *(end + 1) == ']' &&\n+                        *(end + 2) == '>') {\n+                        end = end + 2;\n+                        xmlOutputBufferWrite(buf, 9, \"<![CDATA[\");\n+                        xmlOutputBufferWrite(buf, end - start,\n+                                (const char *)start);\n+                        xmlOutputBufferWrite(buf, 3, \"]]>\");\n+                        start = end;\n+                    }\n+                    end++;\n+                }\n+                if (start != end) {\n+                    xmlOutputBufferWrite(buf, 9, \"<![CDATA[\");\n+                    xmlOutputBufferWriteString(buf, (const char *)start);\n+                    xmlOutputBufferWrite(buf, 3, \"]]>\");\n+                }\n@@ -1640,34 +1675,8 @@\n-            xmlOutputBufferWrite(buf, 4, \"\\\" \/>\");\n-            if (ctxt->format == 1)\n-                xmlOutputBufferWrite(buf, 1, \"\\n\");\n-        } else {\n-            xmlOutputBufferWrite(buf, 1, \">\");\n-        }\n-        \/*\n-         * C.3. Element Minimization and Empty Element Content\n-         *\/\n-        xmlOutputBufferWrite(buf, 2, \"<\/\");\n-        if ((cur->ns != NULL) && (cur->ns->prefix != NULL)) {\n-        xmlOutputBufferWriteString(buf, (const char *)cur->ns->prefix);\n-        xmlOutputBufferWrite(buf, 1, \":\");\n-        }\n-        xmlOutputBufferWriteString(buf, (const char *)cur->name);\n-        xmlOutputBufferWrite(buf, 1, \">\");\n-    }\n-    return;\n-    }\n-    xmlOutputBufferWrite(buf, 1, \">\");\n-    if (addmeta == 1) {\n-        if (ctxt->format == 1) {\n-            xmlOutputBufferWrite(buf, 1, \"\\n\");\n-            if (xmlIndentTreeOutput)\n-                xmlOutputBufferWrite(buf, ctxt->indent_size *\n-                (ctxt->level + 1 > ctxt->indent_nr ?\n-                ctxt->indent_nr : ctxt->level + 1), ctxt->indent);\n-        }\n-        xmlOutputBufferWriteString(buf,\n-            \"<meta http-equiv=\\\"Content-Type\\\" content=\\\"text\/html; charset=\");\n-        if (ctxt->encoding) {\n-            xmlOutputBufferWriteString(buf, (const char *)ctxt->encoding);\n-        } else {\n-            xmlOutputBufferWrite(buf, 5, \"UTF-8\");\n+            break;\n+\n+        case XML_ATTRIBUTE_NODE:\n+            xmlAttrDumpOutput(ctxt, (xmlAttrPtr) cur);\n+        break;\n+\n+        default:\n+            break;\n@@ -1675,5 +1684,0 @@\n-        xmlOutputBufferWrite(buf, 4, \"\\\" \/>\");\n-    }\n-    if ((cur->type != XML_ELEMENT_NODE) && (cur->content != NULL)) {\n-    xmlOutputBufferWriteEscape(buf, cur->content, ctxt->escape);\n-    }\n@@ -1681,55 +1685,8 @@\n-#if 0\n-    \/*\n-    * This was removed due to problems with HTML processors.\n-    * See bug #345147.\n-    *\/\n-    \/*\n-     * 4.8. Script and Style elements\n-     *\/\n-    if ((cur->type == XML_ELEMENT_NODE) &&\n-    ((xmlStrEqual(cur->name, BAD_CAST \"script\")) ||\n-     (xmlStrEqual(cur->name, BAD_CAST \"style\"))) &&\n-    ((cur->ns == NULL) ||\n-     (xmlStrEqual(cur->ns->href, XHTML_NS_NAME)))) {\n-    xmlNodePtr child = cur->children;\n-\n-    while (child != NULL) {\n-        if (child->type == XML_TEXT_NODE) {\n-        if ((xmlStrchr(child->content, '<') == NULL) &&\n-            (xmlStrchr(child->content, '&') == NULL) &&\n-            (xmlStrstr(child->content, BAD_CAST \"]]>\") == NULL)) {\n-            \/* Nothing to escape, so just output as is... *\/\n-            \/* FIXME: Should we do something about \"--\" also? *\/\n-            int level = ctxt->level;\n-            int indent = ctxt->format;\n-\n-            ctxt->level = 0;\n-            ctxt->format = 0;\n-            xmlOutputBufferWriteString(buf, (const char *) child->content);\n-            \/* (We cannot use xhtmlNodeDumpOutput() here because\n-             * we wish to leave '>' unescaped!) *\/\n-            ctxt->level = level;\n-            ctxt->format = indent;\n-        } else {\n-            \/* We must use a CDATA section.  Unfortunately,\n-             * this will break CSS and JavaScript when read by\n-             * a browser in HTML4-compliant mode. :-( *\/\n-            start = end = child->content;\n-            while (*end != '\\0') {\n-            if (*end == ']' &&\n-                *(end + 1) == ']' &&\n-                *(end + 2) == '>') {\n-                end = end + 2;\n-                xmlOutputBufferWrite(buf, 9, \"<![CDATA[\");\n-                xmlOutputBufferWrite(buf, end - start,\n-                         (const char *)start);\n-                xmlOutputBufferWrite(buf, 3, \"]]>\");\n-                start = end;\n-            }\n-            end++;\n-            }\n-            if (start != end) {\n-            xmlOutputBufferWrite(buf, 9, \"<![CDATA[\");\n-            xmlOutputBufferWrite(buf, end - start,\n-                                 (const char *)start);\n-            xmlOutputBufferWrite(buf, 3, \"]]>\");\n+        while (1) {\n+            if (cur == root)\n+                return;\n+            if (ctxt->format == 1)\n+                xmlOutputBufferWrite(buf, 1, \"\\n\");\n+            if (cur->next != NULL) {\n+                cur = cur->next;\n+                break;\n@@ -1737,4 +1694,0 @@\n-        }\n-        } else {\n-        int level = ctxt->level;\n-        int indent = ctxt->format;\n@@ -1742,10 +1695,22 @@\n-        ctxt->level = 0;\n-        ctxt->format = 0;\n-        xhtmlNodeDumpOutput(ctxt, child);\n-        ctxt->level = level;\n-        ctxt->format = indent;\n-        }\n-        child = child->next;\n-    }\n-    }\n-#endif\n+            \/*\n+             * The parent should never be NULL here but we want to handle\n+             * corrupted documents gracefully.\n+             *\/\n+            if (cur->parent == NULL)\n+                return;\n+            cur = cur->parent;\n+\n+            if (cur->type == XML_ELEMENT_NODE) {\n+                if (ctxt->level > 0) ctxt->level--;\n+                if ((xmlIndentTreeOutput) && (ctxt->format == 1))\n+                    xmlOutputBufferWrite(buf, ctxt->indent_size *\n+                                         (ctxt->level > ctxt->indent_nr ?\n+                                          ctxt->indent_nr : ctxt->level),\n+                                         ctxt->indent);\n+\n+                xmlOutputBufferWrite(buf, 2, \"<\/\");\n+                if ((cur->ns != NULL) && (cur->ns->prefix != NULL)) {\n+                    xmlOutputBufferWriteString(buf,\n+                            (const char *)cur->ns->prefix);\n+                    xmlOutputBufferWrite(buf, 1, \":\");\n+                }\n@@ -1753,2 +1718,2 @@\n-    if (cur->children != NULL) {\n-    int indent = ctxt->format;\n+                xmlOutputBufferWriteString(buf, (const char *)cur->name);\n+                xmlOutputBufferWrite(buf, 1, \">\");\n@@ -1756,16 +1721,6 @@\n-    if (format == 1) xmlOutputBufferWrite(buf, 1, \"\\n\");\n-    if (ctxt->level >= 0) ctxt->level++;\n-    ctxt->format = format;\n-    xhtmlNodeListDumpOutput(ctxt, cur->children);\n-    if (ctxt->level > 0) ctxt->level--;\n-    ctxt->format = indent;\n-    if ((xmlIndentTreeOutput) && (format == 1))\n-        xmlOutputBufferWrite(buf, ctxt->indent_size *\n-                             (ctxt->level > ctxt->indent_nr ?\n-                  ctxt->indent_nr : ctxt->level),\n-                 ctxt->indent);\n-    }\n-    xmlOutputBufferWrite(buf, 2, \"<\/\");\n-    if ((cur->ns != NULL) && (cur->ns->prefix != NULL)) {\n-        xmlOutputBufferWriteString(buf, (const char *)cur->ns->prefix);\n-    xmlOutputBufferWrite(buf, 1, \":\");\n+                if (cur == unformattedNode) {\n+                    ctxt->format = format;\n+                    unformattedNode = NULL;\n+                }\n+            }\n+        }\n@@ -1773,3 +1728,0 @@\n-\n-    xmlOutputBufferWriteString(buf, (const char *)cur->name);\n-    xmlOutputBufferWrite(buf, 1, \">\");\n@@ -1805,0 +1757,1 @@\n+        xmlCharEncCloseFunc(ret->handler);\n@@ -1834,0 +1787,1 @@\n+        xmlCharEncCloseFunc(ret->handler);\n@@ -1856,2 +1810,0 @@\n-    xmlOutputBufferPtr out_buff;\n-    xmlCharEncodingHandlerPtr handler;\n@@ -1861,14 +1813,5 @@\n-\n-    if (encoding != NULL) {\n-        handler = xmlFindCharEncodingHandler(encoding);\n-        if (handler == NULL) {\n-            xmlFree(ret);\n-            return(NULL);\n-        }\n-    } else\n-        handler = NULL;\n-    out_buff = xmlOutputBufferCreateBuffer(buffer, handler);\n-    if (out_buff == NULL) {\n-        xmlFree(ret);\n-        if (handler) xmlCharEncCloseFunc(handler);\n-        return(NULL);\n+    ret->buf = xmlOutputBufferCreateBuffer(buffer, ret->handler);\n+    if (ret->buf == NULL) {\n+        xmlCharEncCloseFunc(ret->handler);\n+    xmlFreeSaveCtxt(ret);\n+    return(NULL);\n@@ -1876,2 +1819,0 @@\n-\n-    ret->buf = out_buff;\n@@ -1905,0 +1846,1 @@\n+        xmlCharEncCloseFunc(ret->handler);\n@@ -1945,1 +1887,1 @@\n-xmlSaveTree(xmlSaveCtxtPtr ctxt, xmlNodePtr node)\n+xmlSaveTree(xmlSaveCtxtPtr ctxt, xmlNodePtr cur)\n@@ -1949,2 +1891,15 @@\n-    if ((ctxt == NULL) || (node == NULL)) return(-1);\n-    xmlNodeDumpOutputInternal(ctxt, node);\n+    if ((ctxt == NULL) || (cur == NULL)) return(-1);\n+#ifdef LIBXML_HTML_ENABLED\n+    if (ctxt->options & XML_SAVE_XHTML) {\n+        xhtmlNodeDumpOutput(ctxt, cur);\n+        return(ret);\n+    }\n+    if (((cur->type != XML_NAMESPACE_DECL) && (cur->doc != NULL) &&\n+         (cur->doc->type == XML_HTML_DOCUMENT_NODE) &&\n+         ((ctxt->options & XML_SAVE_AS_XML) == 0)) ||\n+        (ctxt->options & XML_SAVE_AS_HTML)) {\n+    htmlNodeDumpOutputInternal(ctxt, cur);\n+    return(ret);\n+    }\n+#endif\n+    xmlNodeDumpOutputInternal(ctxt, cur);\n","filename":"modules\/javafx.web\/src\/main\/native\/Source\/ThirdParty\/libxml\/src\/xmlsave.c","additions":543,"deletions":588,"binary":false,"changes":1131,"status":"modified"},{"patch":"@@ -133,2 +133,0 @@\n-    register int tmp;\n-\n@@ -138,0 +136,3 @@\n+#ifdef FUZZING_BUILD_MODE_UNSAFE_FOR_PRODUCTION\n+    return(strcmp((const char *)str1, (const char *)str2));\n+#else\n@@ -139,1 +140,1 @@\n-        tmp = *str1++ - *str2;\n+        int tmp = *str1++ - *str2;\n@@ -143,0 +144,1 @@\n+#endif\n@@ -161,0 +163,3 @@\n+#ifdef FUZZING_BUILD_MODE_UNSAFE_FOR_PRODUCTION\n+    return(strcmp((const char *)str1, (const char *)str2) == 0);\n+#else\n@@ -165,0 +170,1 @@\n+#endif\n@@ -207,2 +213,0 @@\n-    register int tmp;\n-\n@@ -213,3 +217,2 @@\n-#ifdef __GNUC__\n-    tmp = strncmp((const char *)str1, (const char *)str2, len);\n-    return tmp;\n+#ifdef FUZZING_BUILD_MODE_UNSAFE_FOR_PRODUCTION\n+    return(strncmp((const char *)str1, (const char *)str2, len));\n@@ -218,1 +221,1 @@\n-        tmp = *str1++ - *str2;\n+        int tmp = *str1++ - *str2;\n","filename":"modules\/javafx.web\/src\/main\/native\/Source\/ThirdParty\/libxml\/src\/xmlstring.c","additions":12,"deletions":9,"binary":false,"changes":21,"status":"modified"},{"patch":"@@ -138,0 +138,11 @@\n+\/*\n+ * XPATH_MAX_RECRUSION_DEPTH:\n+ * Maximum amount of nested functions calls when parsing or evaluating\n+ * expressions\n+ *\/\n+#ifdef FUZZING_BUILD_MODE_UNSAFE_FOR_PRODUCTION\n+#define XPATH_MAX_RECURSION_DEPTH 500\n+#else\n+#define XPATH_MAX_RECURSION_DEPTH 5000\n+#endif\n+\n@@ -480,8 +491,0 @@\n-#ifndef INFINITY\n-#define INFINITY (DBL_MAX * DBL_MAX)\n-#endif\n-\n-#ifndef NAN\n-#define NAN (INFINITY \/ INFINITY)\n-#endif\n-\n@@ -497,0 +500,1 @@\n+ATTRIBUTE_NO_SANITIZE(\"float-divide-by-zero\")\n@@ -499,3 +503,5 @@\n-    xmlXPathNAN = NAN;\n-    xmlXPathPINF = INFINITY;\n-    xmlXPathNINF = -INFINITY;\n+    \/* MSVC doesn't allow division by zero in constant expressions. *\/\n+    double zero = 0.0;\n+    xmlXPathNAN = 0.0 \/ zero;\n+    xmlXPathPINF = 1.0 \/ zero;\n+    xmlXPathNINF = -xmlXPathPINF;\n@@ -530,1 +536,1 @@\n-    if (val >= INFINITY)\n+    if (val >= xmlXPathPINF)\n@@ -532,1 +538,1 @@\n-    if (val <= -INFINITY)\n+    if (val <= -xmlXPathPINF)\n@@ -622,1 +628,1 @@\n- * @extra:  extra informations\n+ * @extra:  extra information\n@@ -665,1 +671,1 @@\n- * @extra:  extra informations\n+ * @extra:  extra information\n@@ -1749,1 +1755,0 @@\n-\/* REVISIT TODO: Make this static when committing *\/\n@@ -2064,1 +2069,0 @@\n-\/* REVISIT TODO: Make this static when committing *\/\n@@ -3950,1 +3954,1 @@\n-{\n+    {\n@@ -4031,1 +4035,1 @@\n-{\n+    {\n@@ -5867,1 +5871,1 @@\n-    return(NAN);\n+    return(xmlXPathNAN);\n@@ -5870,1 +5874,1 @@\n-    return(NAN);\n+    return(xmlXPathNAN);\n@@ -5891,1 +5895,1 @@\n-    return(NAN);\n+    return(xmlXPathNAN);\n@@ -5911,1 +5915,1 @@\n-    return(NAN);\n+    return(xmlXPathNAN);\n@@ -5917,1 +5921,1 @@\n-    ret = NAN;\n+    ret = xmlXPathNAN;\n@@ -5937,1 +5941,1 @@\n-    ret = NAN;\n+    ret = xmlXPathNAN;\n@@ -6123,3 +6127,0 @@\n-    ret->maxDepth = INT_MAX;\n-    ret->maxParserDepth = INT_MAX;\n-\n@@ -7567,1 +7568,1 @@\n-    ctxt->value->floatval = NAN;\n+    ctxt->value->floatval = xmlXPathNAN;\n@@ -9125,1 +9126,1 @@\n-        i = (int) in;\n+        i = (int)in;\n@@ -9146,1 +9147,1 @@\n-    }\n+        }\n@@ -9944,1 +9945,1 @@\n-                                        max * sizeof(xmlChar));\n+                                     max * sizeof(xmlChar));\n@@ -9997,1 +9998,1 @@\n-        return(NAN);\n+        return(xmlXPathNAN);\n@@ -10033,1 +10034,1 @@\n-        return(NAN);\n+        return(xmlXPathNAN);\n@@ -10066,1 +10067,1 @@\n-    if (*cur != 0) return(NAN);\n+    if (*cur != 0) return(xmlXPathNAN);\n@@ -10091,0 +10092,1 @@\n+    xmlXPathObjectPtr num;\n@@ -10163,2 +10165,7 @@\n-    PUSH_LONG_EXPR(XPATH_OP_VALUE, XPATH_NUMBER, 0, 0,\n-                   xmlXPathCacheNewFloat(ctxt->context, ret), NULL);\n+    num = xmlXPathCacheNewFloat(ctxt->context, ret);\n+    if (num == NULL) {\n+    ctxt->error = XPATH_MEMORY_ERROR;\n+    } else if (PUSH_LONG_EXPR(XPATH_OP_VALUE, XPATH_NUMBER, 0, 0, num,\n+                              NULL) == -1) {\n+        xmlXPathReleaseObject(ctxt->context, num);\n+    }\n@@ -10226,0 +10233,1 @@\n+    xmlXPathObjectPtr lit;\n@@ -10253,2 +10261,7 @@\n-    PUSH_LONG_EXPR(XPATH_OP_VALUE, XPATH_STRING, 0, 0,\n-               xmlXPathCacheNewString(ctxt->context, ret), NULL);\n+    lit = xmlXPathCacheNewString(ctxt->context, ret);\n+    if (lit == NULL) {\n+    ctxt->error = XPATH_MEMORY_ERROR;\n+    } else if (PUSH_LONG_EXPR(XPATH_OP_VALUE, XPATH_STRING, 0, 0, lit,\n+                              NULL) == -1) {\n+        xmlXPathReleaseObject(ctxt->context, lit);\n+    }\n@@ -10291,2 +10304,4 @@\n-    PUSH_LONG_EXPR(XPATH_OP_VARIABLE, 0, 0, 0,\n-               name, prefix);\n+    if (PUSH_LONG_EXPR(XPATH_OP_VARIABLE, 0, 0, 0, name, prefix) == -1) {\n+        xmlFree(prefix);\n+        xmlFree(name);\n+    }\n@@ -10399,2 +10414,4 @@\n-    PUSH_LONG_EXPR(XPATH_OP_FUNCTION, nbargs, 0, 0,\n-               name, prefix);\n+    if (PUSH_LONG_EXPR(XPATH_OP_FUNCTION, nbargs, 0, 0, name, prefix) == -1) {\n+        xmlFree(prefix);\n+        xmlFree(name);\n+    }\n@@ -10937,1 +10954,1 @@\n-        if (xpctxt->depth >= xpctxt->maxParserDepth)\n+        if (xpctxt->depth >= XPATH_MAX_RECURSION_DEPTH)\n@@ -10939,1 +10956,5 @@\n-        xpctxt->depth += 1;\n+        \/*\n+         * Parsing a single '(' pushes about 10 functions on the call stack\n+         * before recursing!\n+         *\/\n+        xpctxt->depth += 10;\n@@ -11041,1 +11062,1 @@\n-                 xmlXPathTypeVal *type, const xmlChar **prefix,\n+                 xmlXPathTypeVal *type, xmlChar **prefix,\n@@ -11272,1 +11293,1 @@\n-    const xmlChar *prefix = NULL;\n+    xmlChar *prefix = NULL;\n@@ -11382,3 +11403,5 @@\n-        PUSH_FULL_EXPR(XPATH_OP_COLLECT, op1, ctxt->comp->last, axis,\n-               test, type, (void *)prefix, (void *)name);\n-\n+        if (PUSH_FULL_EXPR(XPATH_OP_COLLECT, op1, ctxt->comp->last, axis,\n+                           test, type, (void *)prefix, (void *)name) == -1) {\n+            xmlFree(prefix);\n+            xmlFree(name);\n+        }\n@@ -11599,1 +11622,1 @@\n-                xmlNodeSetPtr set,\n+              xmlNodeSetPtr set,\n@@ -11602,1 +11625,1 @@\n-                int hasNsNodes)\n+              int hasNsNodes)\n@@ -11652,1 +11675,1 @@\n-            goto exit;\n+            break;\n@@ -11656,2 +11679,2 @@\n-            goto exit;\n-    }\n+            break;\n+        }\n@@ -11675,9 +11698,1 @@\n-                \/* Clear remaining nodes and exit loop. *\/\n-                if (hasNsNodes) {\n-                    for (i++; i < set->nodeNr; i++) {\n-                        node = set->nodeTab[i];\n-                        if ((node != NULL) &&\n-                            (node->type == XML_NAMESPACE_DECL))\n-                            xmlXPathNodeSetFreeNs((xmlNsPtr) node);\n-                    }\n-                }\n+                i += 1;\n@@ -11691,0 +11706,9 @@\n+    \/* Free remaining nodes. *\/\n+    if (hasNsNodes) {\n+        for (; i < set->nodeNr; i++) {\n+            xmlNodePtr node = set->nodeTab[i];\n+            if ((node != NULL) && (node->type == XML_NAMESPACE_DECL))\n+                xmlXPathNodeSetFreeNs((xmlNsPtr) node);\n+        }\n+    }\n+\n@@ -11711,1 +11735,0 @@\n-exit:\n@@ -11716,1 +11739,1 @@\n-    }\n+}\n@@ -11726,1 +11749,1 @@\n-    *\n+ *\n@@ -11730,1 +11753,1 @@\n-    *\/\n+ *\/\n@@ -11750,2 +11773,2 @@\n-        oldcs = xpctxt->contextSize;\n-        oldpp = xpctxt->proximityPosition;\n+    oldcs = xpctxt->contextSize;\n+    oldpp = xpctxt->proximityPosition;\n@@ -11770,2 +11793,2 @@\n-        (contextNode->doc != NULL))\n-        xpctxt->doc = contextNode->doc;\n+            (contextNode->doc != NULL))\n+            xpctxt->doc = contextNode->doc;\n@@ -11776,1 +11799,1 @@\n-            goto exit;\n+            break;\n@@ -11780,1 +11803,1 @@\n-            goto exit;\n+            break;\n@@ -11787,1 +11810,1 @@\n-        }\n+            }\n@@ -11798,4 +11821,1 @@\n-                \/* Clear remaining nodes and exit loop. *\/\n-                for (i++; i < locset->locNr; i++) {\n-                    xmlXPathFreeObject(locset->locTab[i]);\n-        }\n+                i += 1;\n@@ -11803,1 +11823,1 @@\n-    }\n+            }\n@@ -11806,0 +11826,1 @@\n+        }\n@@ -11807,1 +11828,4 @@\n-}\n+\n+    \/* Free remaining nodes. *\/\n+    for (; i < locset->locNr; i++)\n+        xmlXPathFreeObject(locset->locTab[i]);\n@@ -11827,1 +11851,1 @@\n-        }\n+    }\n@@ -11829,1 +11853,0 @@\n-exit:\n@@ -11834,1 +11857,1 @@\n-        }\n+}\n@@ -11849,1 +11872,1 @@\n-        *\/\n+ *\/\n@@ -11859,1 +11882,1 @@\n-        \/*\n+    \/*\n@@ -11861,1 +11884,1 @@\n-        *\/\n+    *\/\n@@ -11866,2 +11889,2 @@\n-        }\n-        if (ctxt->context->depth >= ctxt->context->maxDepth)\n+    }\n+        if (ctxt->context->depth >= XPATH_MAX_RECURSION_DEPTH)\n@@ -12583,1 +12606,1 @@\n-    if (ctxt->context->depth >= ctxt->context->maxDepth)\n+    if (ctxt->context->depth >= XPATH_MAX_RECURSION_DEPTH)\n@@ -12724,1 +12747,1 @@\n-    if (ctxt->context->depth >= ctxt->context->maxDepth)\n+    if (ctxt->context->depth >= XPATH_MAX_RECURSION_DEPTH)\n@@ -12895,1 +12918,1 @@\n-        \/*\n+    \/*\n@@ -12897,1 +12920,1 @@\n-        *\/\n+    *\/\n@@ -12905,1 +12928,1 @@\n-    }\n+        }\n@@ -12919,1 +12942,1 @@\n-    return(total);\n+    return (total);\n@@ -12942,1 +12965,1 @@\n-    if (ctxt->context->depth >= ctxt->context->maxDepth)\n+    if (ctxt->context->depth >= XPATH_MAX_RECURSION_DEPTH)\n@@ -13508,3 +13531,3 @@\n-    xmlGenericError(xmlGenericErrorContext,\n-                    \"XPath: unknown precompiled operation %d\\n\", op->op);\n-    ctxt->error = XPATH_INVALID_OPERAND;\n+            xmlGenericError(xmlGenericErrorContext,\n+                            \"XPath: unknown precompiled operation %d\\n\", op->op);\n+            ctxt->error = XPATH_INVALID_OPERAND;\n@@ -13818,1 +13841,2 @@\n-        if ((cur == NULL) || (cur == limit))\n+        if ((cur == NULL) || (cur == limit) ||\n+                (cur->type == XML_DOCUMENT_NODE))\n@@ -14089,2 +14113,1 @@\n-    stream = xmlPatterncompile(str, dict, XML_PATTERN_XPATH,\n-            &namespaces[0]);\n+    stream = xmlPatterncompile(str, dict, XML_PATTERN_XPATH, namespaces);\n@@ -14176,1 +14199,1 @@\n-        if (ctxt->depth >= ctxt->maxDepth)\n+        if (ctxt->depth >= XPATH_MAX_RECURSION_DEPTH)\n@@ -14209,1 +14232,1 @@\n-    xmlXPathInit();\n+    xmlInitParser();\n@@ -14298,1 +14321,1 @@\n-    xmlXPathInit();\n+    xmlInitParser();\n@@ -14420,1 +14443,1 @@\n-    }\n+        }\n@@ -14443,1 +14466,1 @@\n-    xmlXPathInit();\n+    xmlInitParser();\n","filename":"modules\/javafx.web\/src\/main\/native\/Source\/ThirdParty\/libxml\/src\/xpath.c","additions":130,"deletions":107,"binary":false,"changes":237,"status":"modified"},{"patch":"@@ -2,2 +2,2 @@\n- * Summary: compile-time version informations\n- * Description: compile-time version informations for the XML library\n+ * Summary: compile-time version information\n+ * Description: compile-time version information for the XML library\n@@ -32,1 +32,1 @@\n-#define LIBXML_DOTTED_VERSION \"2.9.10\"\n+#define LIBXML_DOTTED_VERSION \"2.9.12\"\n@@ -39,1 +39,1 @@\n-#define LIBXML_VERSION 20910\n+#define LIBXML_VERSION 20912\n@@ -46,1 +46,1 @@\n-#define LIBXML_VERSION_STRING \"20910\"\n+#define LIBXML_VERSION_STRING \"20912\"\n@@ -61,1 +61,1 @@\n-#define LIBXML_TEST_VERSION xmlCheckVersion(20910);\n+#define LIBXML_TEST_VERSION xmlCheckVersion(20912);\n","filename":"modules\/javafx.web\/src\/main\/native\/Source\/ThirdParty\/libxml\/win32\/include\/libxml\/xmlversion.h","additions":6,"deletions":6,"binary":false,"changes":12,"status":"modified"}]}