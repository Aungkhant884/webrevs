{"files":[{"patch":"@@ -65,2 +65,0 @@\n-#define GLASS_GDK_KEY_CONSTANT(key) (GDK_KEY_ ## key)\n-\n","filename":"modules\/javafx.graphics\/src\/main\/native-glass\/gtk\/glass_general.h","additions":0,"deletions":2,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -34,199 +34,209 @@\n-static gboolean key_initialized = FALSE;\n-static GHashTable *keymap;\n-\n-static void glass_g_hash_table_insert_int(GHashTable *table, gint key, gint value)\n-{\n-    g_hash_table_insert(table, GINT_TO_POINTER(key), GINT_TO_POINTER(value));\n-}\n-\n-static void initialize_key()\n-{\n-    keymap = g_hash_table_new(g_direct_hash, g_direct_equal);\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(Return), com_sun_glass_events_KeyEvent_VK_ENTER);\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(BackSpace), com_sun_glass_events_KeyEvent_VK_BACKSPACE);\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(Tab), com_sun_glass_events_KeyEvent_VK_TAB);\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(Clear), com_sun_glass_events_KeyEvent_VK_CLEAR); \/\/XXX what is this?\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(Pause), com_sun_glass_events_KeyEvent_VK_PAUSE);\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(Escape), com_sun_glass_events_KeyEvent_VK_ESCAPE);\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(space), com_sun_glass_events_KeyEvent_VK_SPACE);\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(Delete), com_sun_glass_events_KeyEvent_VK_DELETE);\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(Print), com_sun_glass_events_KeyEvent_VK_PRINTSCREEN); \/\/XXX is correct?\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(Insert), com_sun_glass_events_KeyEvent_VK_INSERT);\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(Help), com_sun_glass_events_KeyEvent_VK_HELP); \/\/XXX what is this?\n-\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(Shift_L), com_sun_glass_events_KeyEvent_VK_SHIFT);\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(Shift_R), com_sun_glass_events_KeyEvent_VK_SHIFT); \/\/XXX is this correct?\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(Control_L), com_sun_glass_events_KeyEvent_VK_CONTROL);\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(Control_R), com_sun_glass_events_KeyEvent_VK_CONTROL);\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(Alt_L), com_sun_glass_events_KeyEvent_VK_ALT);\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(Alt_R), com_sun_glass_events_KeyEvent_VK_ALT_GRAPH);\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(Super_L), com_sun_glass_events_KeyEvent_VK_WINDOWS);\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(Super_R), com_sun_glass_events_KeyEvent_VK_WINDOWS);\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(Menu), com_sun_glass_events_KeyEvent_VK_CONTEXT_MENU);\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(Meta_L), com_sun_glass_events_KeyEvent_VK_WINDOWS);\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(Meta_R), com_sun_glass_events_KeyEvent_VK_CONTEXT_MENU);\/\/XXX is this correct?\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(Caps_Lock), com_sun_glass_events_KeyEvent_VK_CAPS_LOCK);\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(Num_Lock), com_sun_glass_events_KeyEvent_VK_NUM_LOCK);\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(Scroll_Lock), com_sun_glass_events_KeyEvent_VK_SCROLL_LOCK);\n-\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(Page_Up), com_sun_glass_events_KeyEvent_VK_PAGE_UP);\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(Prior), com_sun_glass_events_KeyEvent_VK_PAGE_UP);\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(Page_Down), com_sun_glass_events_KeyEvent_VK_PAGE_DOWN);\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(Next), com_sun_glass_events_KeyEvent_VK_PAGE_DOWN);\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(End), com_sun_glass_events_KeyEvent_VK_END);\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(Home), com_sun_glass_events_KeyEvent_VK_HOME);\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(Left), com_sun_glass_events_KeyEvent_VK_LEFT);\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(Right), com_sun_glass_events_KeyEvent_VK_RIGHT);\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(Up), com_sun_glass_events_KeyEvent_VK_UP);\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(Down), com_sun_glass_events_KeyEvent_VK_DOWN);\n-\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(comma), com_sun_glass_events_KeyEvent_VK_COMMA);\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(minus), com_sun_glass_events_KeyEvent_VK_MINUS);\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(period), com_sun_glass_events_KeyEvent_VK_PERIOD);\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(slash), com_sun_glass_events_KeyEvent_VK_SLASH);\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(semicolon), com_sun_glass_events_KeyEvent_VK_SEMICOLON);\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(equal), com_sun_glass_events_KeyEvent_VK_EQUALS);\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(bracketleft), com_sun_glass_events_KeyEvent_VK_OPEN_BRACKET);\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(bracketright), com_sun_glass_events_KeyEvent_VK_CLOSE_BRACKET);\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(backslash), com_sun_glass_events_KeyEvent_VK_BACK_SLASH);\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(bar), com_sun_glass_events_KeyEvent_VK_BACK_SLASH);\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(KP_Multiply), com_sun_glass_events_KeyEvent_VK_MULTIPLY);\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(KP_Add), com_sun_glass_events_KeyEvent_VK_ADD);\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(KP_Separator), com_sun_glass_events_KeyEvent_VK_SEPARATOR);\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(KP_Subtract), com_sun_glass_events_KeyEvent_VK_SUBTRACT);\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(KP_Decimal), com_sun_glass_events_KeyEvent_VK_DECIMAL);\n-\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(apostrophe), com_sun_glass_events_KeyEvent_VK_QUOTE);\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(grave), com_sun_glass_events_KeyEvent_VK_BACK_QUOTE);\n-\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(ampersand), com_sun_glass_events_KeyEvent_VK_AMPERSAND);\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(asterisk), com_sun_glass_events_KeyEvent_VK_ASTERISK);\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(quotedbl), com_sun_glass_events_KeyEvent_VK_DOUBLE_QUOTE);\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(less), com_sun_glass_events_KeyEvent_VK_LESS);\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(greater), com_sun_glass_events_KeyEvent_VK_GREATER);\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(braceleft), com_sun_glass_events_KeyEvent_VK_BRACELEFT);\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(braceright), com_sun_glass_events_KeyEvent_VK_BRACERIGHT);\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(at), com_sun_glass_events_KeyEvent_VK_AT);\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(colon), com_sun_glass_events_KeyEvent_VK_COLON);\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(asciicircum), com_sun_glass_events_KeyEvent_VK_CIRCUMFLEX);\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(dollar), com_sun_glass_events_KeyEvent_VK_DOLLAR);\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(EuroSign), com_sun_glass_events_KeyEvent_VK_EURO_SIGN);\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(exclam), com_sun_glass_events_KeyEvent_VK_EXCLAMATION);\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(exclamdown), com_sun_glass_events_KeyEvent_VK_INV_EXCLAMATION);\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(parenleft), com_sun_glass_events_KeyEvent_VK_LEFT_PARENTHESIS);\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(numbersign), com_sun_glass_events_KeyEvent_VK_NUMBER_SIGN);\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(plus), com_sun_glass_events_KeyEvent_VK_PLUS);\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(parenright), com_sun_glass_events_KeyEvent_VK_RIGHT_PARENTHESIS);\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(underscore), com_sun_glass_events_KeyEvent_VK_UNDERSCORE);\n-\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(0), com_sun_glass_events_KeyEvent_VK_0);\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(1), com_sun_glass_events_KeyEvent_VK_1);\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(2), com_sun_glass_events_KeyEvent_VK_2);\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(3), com_sun_glass_events_KeyEvent_VK_3);\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(4), com_sun_glass_events_KeyEvent_VK_4);\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(5), com_sun_glass_events_KeyEvent_VK_5);\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(6), com_sun_glass_events_KeyEvent_VK_6);\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(7), com_sun_glass_events_KeyEvent_VK_7);\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(8), com_sun_glass_events_KeyEvent_VK_8);\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(9), com_sun_glass_events_KeyEvent_VK_9);\n-\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(a), com_sun_glass_events_KeyEvent_VK_A);\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(b), com_sun_glass_events_KeyEvent_VK_B);\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(c), com_sun_glass_events_KeyEvent_VK_C);\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(d), com_sun_glass_events_KeyEvent_VK_D);\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(e), com_sun_glass_events_KeyEvent_VK_E);\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(f), com_sun_glass_events_KeyEvent_VK_F);\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(g), com_sun_glass_events_KeyEvent_VK_G);\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(h), com_sun_glass_events_KeyEvent_VK_H);\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(i), com_sun_glass_events_KeyEvent_VK_I);\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(j), com_sun_glass_events_KeyEvent_VK_J);\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(k), com_sun_glass_events_KeyEvent_VK_K);\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(l), com_sun_glass_events_KeyEvent_VK_L);\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(m), com_sun_glass_events_KeyEvent_VK_M);\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(n), com_sun_glass_events_KeyEvent_VK_N);\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(o), com_sun_glass_events_KeyEvent_VK_O);\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(p), com_sun_glass_events_KeyEvent_VK_P);\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(q), com_sun_glass_events_KeyEvent_VK_Q);\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(r), com_sun_glass_events_KeyEvent_VK_R);\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(s), com_sun_glass_events_KeyEvent_VK_S);\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(t), com_sun_glass_events_KeyEvent_VK_T);\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(u), com_sun_glass_events_KeyEvent_VK_U);\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(v), com_sun_glass_events_KeyEvent_VK_V);\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(w), com_sun_glass_events_KeyEvent_VK_W);\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(x), com_sun_glass_events_KeyEvent_VK_X);\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(y), com_sun_glass_events_KeyEvent_VK_Y);\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(z), com_sun_glass_events_KeyEvent_VK_Z);\n-\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(A), com_sun_glass_events_KeyEvent_VK_A);\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(B), com_sun_glass_events_KeyEvent_VK_B);\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(C), com_sun_glass_events_KeyEvent_VK_C);\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(D), com_sun_glass_events_KeyEvent_VK_D);\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(E), com_sun_glass_events_KeyEvent_VK_E);\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(F), com_sun_glass_events_KeyEvent_VK_F);\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(G), com_sun_glass_events_KeyEvent_VK_G);\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(H), com_sun_glass_events_KeyEvent_VK_H);\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(I), com_sun_glass_events_KeyEvent_VK_I);\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(J), com_sun_glass_events_KeyEvent_VK_J);\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(K), com_sun_glass_events_KeyEvent_VK_K);\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(L), com_sun_glass_events_KeyEvent_VK_L);\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(M), com_sun_glass_events_KeyEvent_VK_M);\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(N), com_sun_glass_events_KeyEvent_VK_N);\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(O), com_sun_glass_events_KeyEvent_VK_O);\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(P), com_sun_glass_events_KeyEvent_VK_P);\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(Q), com_sun_glass_events_KeyEvent_VK_Q);\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(R), com_sun_glass_events_KeyEvent_VK_R);\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(S), com_sun_glass_events_KeyEvent_VK_S);\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(T), com_sun_glass_events_KeyEvent_VK_T);\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(U), com_sun_glass_events_KeyEvent_VK_U);\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(V), com_sun_glass_events_KeyEvent_VK_V);\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(W), com_sun_glass_events_KeyEvent_VK_W);\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(X), com_sun_glass_events_KeyEvent_VK_X);\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(Y), com_sun_glass_events_KeyEvent_VK_Y);\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(Z), com_sun_glass_events_KeyEvent_VK_Z);\n-\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(KP_0), com_sun_glass_events_KeyEvent_VK_NUMPAD0);\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(KP_1), com_sun_glass_events_KeyEvent_VK_NUMPAD1);\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(KP_2), com_sun_glass_events_KeyEvent_VK_NUMPAD2);\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(KP_3), com_sun_glass_events_KeyEvent_VK_NUMPAD3);\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(KP_4), com_sun_glass_events_KeyEvent_VK_NUMPAD4);\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(KP_5), com_sun_glass_events_KeyEvent_VK_NUMPAD5);\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(KP_6), com_sun_glass_events_KeyEvent_VK_NUMPAD6);\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(KP_7), com_sun_glass_events_KeyEvent_VK_NUMPAD7);\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(KP_8), com_sun_glass_events_KeyEvent_VK_NUMPAD8);\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(KP_9), com_sun_glass_events_KeyEvent_VK_NUMPAD9);\n-\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(KP_Enter), com_sun_glass_events_KeyEvent_VK_ENTER);\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(KP_Home), com_sun_glass_events_KeyEvent_VK_HOME);\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(KP_Left), com_sun_glass_events_KeyEvent_VK_LEFT);\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(KP_Up), com_sun_glass_events_KeyEvent_VK_UP);\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(KP_Right), com_sun_glass_events_KeyEvent_VK_RIGHT);\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(KP_Down), com_sun_glass_events_KeyEvent_VK_DOWN);\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(KP_Prior), com_sun_glass_events_KeyEvent_VK_PAGE_UP);\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(KP_Page_Up), com_sun_glass_events_KeyEvent_VK_PAGE_UP);\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(KP_Next), com_sun_glass_events_KeyEvent_VK_PAGE_DOWN);\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(KP_Page_Down), com_sun_glass_events_KeyEvent_VK_PAGE_DOWN);\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(KP_End), com_sun_glass_events_KeyEvent_VK_END);\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(KP_Insert), com_sun_glass_events_KeyEvent_VK_INSERT);\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(KP_Delete), com_sun_glass_events_KeyEvent_VK_DELETE);\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(KP_Divide), com_sun_glass_events_KeyEvent_VK_DIVIDE);\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(KP_Begin),\n-            com_sun_glass_events_KeyEvent_VK_CLEAR); \/\/ 5 key on keypad with Num Lock turned off\n-\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(F1), com_sun_glass_events_KeyEvent_VK_F1);\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(F2), com_sun_glass_events_KeyEvent_VK_F2);\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(F3), com_sun_glass_events_KeyEvent_VK_F3);\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(F4), com_sun_glass_events_KeyEvent_VK_F4);\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(F5), com_sun_glass_events_KeyEvent_VK_F5);\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(F6), com_sun_glass_events_KeyEvent_VK_F6);\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(F7), com_sun_glass_events_KeyEvent_VK_F7);\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(F8), com_sun_glass_events_KeyEvent_VK_F8);\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(F9), com_sun_glass_events_KeyEvent_VK_F9);\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(F10), com_sun_glass_events_KeyEvent_VK_F10);\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(F11), com_sun_glass_events_KeyEvent_VK_F11);\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(F12), com_sun_glass_events_KeyEvent_VK_F12);\n-}\n-\n-static void init_keymap() {\n-    if (!key_initialized) {\n-        initialize_key();\n-        key_initialized = TRUE;\n+\/\/ NOTE: This must be ordered by gdk_key\n+static const struct {\n+  unsigned short gdk_key;\n+  unsigned short glass_key;\n+} gdk_to_glass_keys[] = {\n+    { GDK_KEY_space, com_sun_glass_events_KeyEvent_VK_SPACE },\n+    { GDK_KEY_exclam, com_sun_glass_events_KeyEvent_VK_EXCLAMATION },\n+    { GDK_KEY_quotedbl, com_sun_glass_events_KeyEvent_VK_DOUBLE_QUOTE },\n+    { GDK_KEY_numbersign, com_sun_glass_events_KeyEvent_VK_NUMBER_SIGN },\n+    { GDK_KEY_dollar, com_sun_glass_events_KeyEvent_VK_DOLLAR },\n+    { GDK_KEY_ampersand, com_sun_glass_events_KeyEvent_VK_AMPERSAND },\n+    { GDK_KEY_apostrophe, com_sun_glass_events_KeyEvent_VK_QUOTE },\n+    { GDK_KEY_parenleft, com_sun_glass_events_KeyEvent_VK_LEFT_PARENTHESIS },\n+    { GDK_KEY_parenright, com_sun_glass_events_KeyEvent_VK_RIGHT_PARENTHESIS },\n+    { GDK_KEY_asterisk, com_sun_glass_events_KeyEvent_VK_ASTERISK },\n+    { GDK_KEY_plus, com_sun_glass_events_KeyEvent_VK_PLUS },\n+    { GDK_KEY_comma, com_sun_glass_events_KeyEvent_VK_COMMA },\n+    { GDK_KEY_minus, com_sun_glass_events_KeyEvent_VK_MINUS },\n+    { GDK_KEY_period, com_sun_glass_events_KeyEvent_VK_PERIOD },\n+    { GDK_KEY_slash, com_sun_glass_events_KeyEvent_VK_SLASH },\n+    { GDK_KEY_0, com_sun_glass_events_KeyEvent_VK_0 },\n+    { GDK_KEY_1, com_sun_glass_events_KeyEvent_VK_1 },\n+    { GDK_KEY_2, com_sun_glass_events_KeyEvent_VK_2 },\n+    { GDK_KEY_3, com_sun_glass_events_KeyEvent_VK_3 },\n+    { GDK_KEY_4, com_sun_glass_events_KeyEvent_VK_4 },\n+    { GDK_KEY_5, com_sun_glass_events_KeyEvent_VK_5 },\n+    { GDK_KEY_6, com_sun_glass_events_KeyEvent_VK_6 },\n+    { GDK_KEY_7, com_sun_glass_events_KeyEvent_VK_7 },\n+    { GDK_KEY_8, com_sun_glass_events_KeyEvent_VK_8 },\n+    { GDK_KEY_9, com_sun_glass_events_KeyEvent_VK_9 },\n+    { GDK_KEY_colon, com_sun_glass_events_KeyEvent_VK_COLON },\n+    { GDK_KEY_semicolon, com_sun_glass_events_KeyEvent_VK_SEMICOLON },\n+    { GDK_KEY_less, com_sun_glass_events_KeyEvent_VK_LESS },\n+    { GDK_KEY_equal, com_sun_glass_events_KeyEvent_VK_EQUALS },\n+    { GDK_KEY_greater, com_sun_glass_events_KeyEvent_VK_GREATER },\n+    { GDK_KEY_at, com_sun_glass_events_KeyEvent_VK_AT },\n+    { GDK_KEY_A, com_sun_glass_events_KeyEvent_VK_A },\n+    { GDK_KEY_B, com_sun_glass_events_KeyEvent_VK_B },\n+    { GDK_KEY_C, com_sun_glass_events_KeyEvent_VK_C },\n+    { GDK_KEY_D, com_sun_glass_events_KeyEvent_VK_D },\n+    { GDK_KEY_E, com_sun_glass_events_KeyEvent_VK_E },\n+    { GDK_KEY_F, com_sun_glass_events_KeyEvent_VK_F },\n+    { GDK_KEY_G, com_sun_glass_events_KeyEvent_VK_G },\n+    { GDK_KEY_H, com_sun_glass_events_KeyEvent_VK_H },\n+    { GDK_KEY_I, com_sun_glass_events_KeyEvent_VK_I },\n+    { GDK_KEY_J, com_sun_glass_events_KeyEvent_VK_J },\n+    { GDK_KEY_K, com_sun_glass_events_KeyEvent_VK_K },\n+    { GDK_KEY_L, com_sun_glass_events_KeyEvent_VK_L },\n+    { GDK_KEY_M, com_sun_glass_events_KeyEvent_VK_M },\n+    { GDK_KEY_N, com_sun_glass_events_KeyEvent_VK_N },\n+    { GDK_KEY_O, com_sun_glass_events_KeyEvent_VK_O },\n+    { GDK_KEY_P, com_sun_glass_events_KeyEvent_VK_P },\n+    { GDK_KEY_Q, com_sun_glass_events_KeyEvent_VK_Q },\n+    { GDK_KEY_R, com_sun_glass_events_KeyEvent_VK_R },\n+    { GDK_KEY_S, com_sun_glass_events_KeyEvent_VK_S },\n+    { GDK_KEY_T, com_sun_glass_events_KeyEvent_VK_T },\n+    { GDK_KEY_U, com_sun_glass_events_KeyEvent_VK_U },\n+    { GDK_KEY_V, com_sun_glass_events_KeyEvent_VK_V },\n+    { GDK_KEY_W, com_sun_glass_events_KeyEvent_VK_W },\n+    { GDK_KEY_X, com_sun_glass_events_KeyEvent_VK_X },\n+    { GDK_KEY_Y, com_sun_glass_events_KeyEvent_VK_Y },\n+    { GDK_KEY_Z, com_sun_glass_events_KeyEvent_VK_Z },\n+    { GDK_KEY_bracketleft, com_sun_glass_events_KeyEvent_VK_OPEN_BRACKET },\n+    { GDK_KEY_backslash, com_sun_glass_events_KeyEvent_VK_BACK_SLASH },\n+    { GDK_KEY_bracketright, com_sun_glass_events_KeyEvent_VK_CLOSE_BRACKET },\n+    { GDK_KEY_asciicircum, com_sun_glass_events_KeyEvent_VK_CIRCUMFLEX },\n+    { GDK_KEY_underscore, com_sun_glass_events_KeyEvent_VK_UNDERSCORE },\n+    { GDK_KEY_grave, com_sun_glass_events_KeyEvent_VK_BACK_QUOTE },\n+    { GDK_KEY_a, com_sun_glass_events_KeyEvent_VK_A },\n+    { GDK_KEY_b, com_sun_glass_events_KeyEvent_VK_B },\n+    { GDK_KEY_c, com_sun_glass_events_KeyEvent_VK_C },\n+    { GDK_KEY_d, com_sun_glass_events_KeyEvent_VK_D },\n+    { GDK_KEY_e, com_sun_glass_events_KeyEvent_VK_E },\n+    { GDK_KEY_f, com_sun_glass_events_KeyEvent_VK_F },\n+    { GDK_KEY_g, com_sun_glass_events_KeyEvent_VK_G },\n+    { GDK_KEY_h, com_sun_glass_events_KeyEvent_VK_H },\n+    { GDK_KEY_i, com_sun_glass_events_KeyEvent_VK_I },\n+    { GDK_KEY_j, com_sun_glass_events_KeyEvent_VK_J },\n+    { GDK_KEY_k, com_sun_glass_events_KeyEvent_VK_K },\n+    { GDK_KEY_l, com_sun_glass_events_KeyEvent_VK_L },\n+    { GDK_KEY_m, com_sun_glass_events_KeyEvent_VK_M },\n+    { GDK_KEY_n, com_sun_glass_events_KeyEvent_VK_N },\n+    { GDK_KEY_o, com_sun_glass_events_KeyEvent_VK_O },\n+    { GDK_KEY_p, com_sun_glass_events_KeyEvent_VK_P },\n+    { GDK_KEY_q, com_sun_glass_events_KeyEvent_VK_Q },\n+    { GDK_KEY_r, com_sun_glass_events_KeyEvent_VK_R },\n+    { GDK_KEY_s, com_sun_glass_events_KeyEvent_VK_S },\n+    { GDK_KEY_t, com_sun_glass_events_KeyEvent_VK_T },\n+    { GDK_KEY_u, com_sun_glass_events_KeyEvent_VK_U },\n+    { GDK_KEY_v, com_sun_glass_events_KeyEvent_VK_V },\n+    { GDK_KEY_w, com_sun_glass_events_KeyEvent_VK_W },\n+    { GDK_KEY_x, com_sun_glass_events_KeyEvent_VK_X },\n+    { GDK_KEY_y, com_sun_glass_events_KeyEvent_VK_Y },\n+    { GDK_KEY_z, com_sun_glass_events_KeyEvent_VK_Z },\n+    { GDK_KEY_braceleft, com_sun_glass_events_KeyEvent_VK_BRACELEFT },\n+    { GDK_KEY_bar, com_sun_glass_events_KeyEvent_VK_BACK_SLASH },\n+    { GDK_KEY_braceright, com_sun_glass_events_KeyEvent_VK_BRACERIGHT },\n+    { GDK_KEY_exclamdown, com_sun_glass_events_KeyEvent_VK_INV_EXCLAMATION },\n+    { GDK_KEY_EuroSign, com_sun_glass_events_KeyEvent_VK_EURO_SIGN },\n+    { GDK_KEY_ISO_Level3_Shift, com_sun_glass_events_KeyEvent_VK_ALT_GRAPH },\n+    { GDK_KEY_dead_grave, com_sun_glass_events_KeyEvent_VK_DEAD_GRAVE },\n+    { GDK_KEY_dead_acute, com_sun_glass_events_KeyEvent_VK_DEAD_ACUTE },\n+    { GDK_KEY_dead_circumflex, com_sun_glass_events_KeyEvent_VK_DEAD_CIRCUMFLEX },\n+    { GDK_KEY_dead_tilde, com_sun_glass_events_KeyEvent_VK_DEAD_TILDE },\n+    { GDK_KEY_dead_macron, com_sun_glass_events_KeyEvent_VK_DEAD_MACRON },\n+    { GDK_KEY_dead_breve, com_sun_glass_events_KeyEvent_VK_DEAD_BREVE },\n+    { GDK_KEY_dead_abovedot, com_sun_glass_events_KeyEvent_VK_DEAD_ABOVEDOT },\n+    { GDK_KEY_dead_diaeresis, com_sun_glass_events_KeyEvent_VK_DEAD_DIAERESIS },\n+    { GDK_KEY_dead_abovering, com_sun_glass_events_KeyEvent_VK_DEAD_ABOVERING },\n+    { GDK_KEY_dead_doubleacute, com_sun_glass_events_KeyEvent_VK_DEAD_DOUBLEACUTE },\n+    { GDK_KEY_dead_caron, com_sun_glass_events_KeyEvent_VK_DEAD_CARON },\n+    { GDK_KEY_dead_cedilla, com_sun_glass_events_KeyEvent_VK_DEAD_CEDILLA },\n+    { GDK_KEY_dead_ogonek, com_sun_glass_events_KeyEvent_VK_DEAD_OGONEK },\n+    { GDK_KEY_dead_iota, com_sun_glass_events_KeyEvent_VK_DEAD_IOTA },\n+    { GDK_KEY_dead_voiced_sound, com_sun_glass_events_KeyEvent_VK_DEAD_VOICED_SOUND },\n+    { GDK_KEY_dead_semivoiced_sound, com_sun_glass_events_KeyEvent_VK_DEAD_SEMIVOICED_SOUND },\n+    { GDK_KEY_BackSpace, com_sun_glass_events_KeyEvent_VK_BACKSPACE },\n+    { GDK_KEY_Tab, com_sun_glass_events_KeyEvent_VK_TAB },\n+    { GDK_KEY_Clear, com_sun_glass_events_KeyEvent_VK_CLEAR },\n+    { GDK_KEY_Return, com_sun_glass_events_KeyEvent_VK_ENTER },\n+    { GDK_KEY_Pause, com_sun_glass_events_KeyEvent_VK_PAUSE },\n+    { GDK_KEY_Scroll_Lock, com_sun_glass_events_KeyEvent_VK_SCROLL_LOCK },\n+    { GDK_KEY_Escape, com_sun_glass_events_KeyEvent_VK_ESCAPE },\n+    { GDK_KEY_Home, com_sun_glass_events_KeyEvent_VK_HOME },\n+    { GDK_KEY_Left, com_sun_glass_events_KeyEvent_VK_LEFT },\n+    { GDK_KEY_Up, com_sun_glass_events_KeyEvent_VK_UP },\n+    { GDK_KEY_Right, com_sun_glass_events_KeyEvent_VK_RIGHT },\n+    { GDK_KEY_Down, com_sun_glass_events_KeyEvent_VK_DOWN },\n+    { GDK_KEY_Page_Up, com_sun_glass_events_KeyEvent_VK_PAGE_UP },\n+    { GDK_KEY_Prior, com_sun_glass_events_KeyEvent_VK_PAGE_UP },\n+    { GDK_KEY_Page_Down, com_sun_glass_events_KeyEvent_VK_PAGE_DOWN },\n+    { GDK_KEY_Next, com_sun_glass_events_KeyEvent_VK_PAGE_DOWN },\n+    { GDK_KEY_End, com_sun_glass_events_KeyEvent_VK_END },\n+    { GDK_KEY_Print, com_sun_glass_events_KeyEvent_VK_PRINTSCREEN },\n+    { GDK_KEY_Insert, com_sun_glass_events_KeyEvent_VK_INSERT },\n+    { GDK_KEY_Menu, com_sun_glass_events_KeyEvent_VK_CONTEXT_MENU },\n+    { GDK_KEY_Help, com_sun_glass_events_KeyEvent_VK_HELP },\n+    { GDK_KEY_Num_Lock, com_sun_glass_events_KeyEvent_VK_NUM_LOCK },\n+    { GDK_KEY_KP_Enter, com_sun_glass_events_KeyEvent_VK_ENTER },\n+    { GDK_KEY_KP_Home, com_sun_glass_events_KeyEvent_VK_HOME },\n+    { GDK_KEY_KP_Left, com_sun_glass_events_KeyEvent_VK_LEFT },\n+    { GDK_KEY_KP_Up, com_sun_glass_events_KeyEvent_VK_UP },\n+    { GDK_KEY_KP_Right, com_sun_glass_events_KeyEvent_VK_RIGHT },\n+    { GDK_KEY_KP_Down, com_sun_glass_events_KeyEvent_VK_DOWN },\n+    { GDK_KEY_KP_Prior, com_sun_glass_events_KeyEvent_VK_PAGE_UP },\n+    { GDK_KEY_KP_Page_Up, com_sun_glass_events_KeyEvent_VK_PAGE_UP },\n+    { GDK_KEY_KP_Next, com_sun_glass_events_KeyEvent_VK_PAGE_DOWN },\n+    { GDK_KEY_KP_Page_Down, com_sun_glass_events_KeyEvent_VK_PAGE_DOWN },\n+    { GDK_KEY_KP_End, com_sun_glass_events_KeyEvent_VK_END },\n+    { GDK_KEY_KP_Begin, com_sun_glass_events_KeyEvent_VK_CLEAR },\n+    { GDK_KEY_KP_Insert, com_sun_glass_events_KeyEvent_VK_INSERT },\n+    { GDK_KEY_KP_Delete, com_sun_glass_events_KeyEvent_VK_DELETE },\n+    { GDK_KEY_KP_Multiply, com_sun_glass_events_KeyEvent_VK_MULTIPLY },\n+    { GDK_KEY_KP_Add, com_sun_glass_events_KeyEvent_VK_ADD },\n+    { GDK_KEY_KP_Separator, com_sun_glass_events_KeyEvent_VK_SEPARATOR },\n+    { GDK_KEY_KP_Subtract, com_sun_glass_events_KeyEvent_VK_SUBTRACT },\n+    { GDK_KEY_KP_Decimal, com_sun_glass_events_KeyEvent_VK_DECIMAL },\n+    { GDK_KEY_KP_Divide, com_sun_glass_events_KeyEvent_VK_DIVIDE },\n+    { GDK_KEY_KP_0, com_sun_glass_events_KeyEvent_VK_NUMPAD0 },\n+    { GDK_KEY_KP_1, com_sun_glass_events_KeyEvent_VK_NUMPAD1 },\n+    { GDK_KEY_KP_2, com_sun_glass_events_KeyEvent_VK_NUMPAD2 },\n+    { GDK_KEY_KP_3, com_sun_glass_events_KeyEvent_VK_NUMPAD3 },\n+    { GDK_KEY_KP_4, com_sun_glass_events_KeyEvent_VK_NUMPAD4 },\n+    { GDK_KEY_KP_5, com_sun_glass_events_KeyEvent_VK_NUMPAD5 },\n+    { GDK_KEY_KP_6, com_sun_glass_events_KeyEvent_VK_NUMPAD6 },\n+    { GDK_KEY_KP_7, com_sun_glass_events_KeyEvent_VK_NUMPAD7 },\n+    { GDK_KEY_KP_8, com_sun_glass_events_KeyEvent_VK_NUMPAD8 },\n+    { GDK_KEY_KP_9, com_sun_glass_events_KeyEvent_VK_NUMPAD9 },\n+    { GDK_KEY_F1, com_sun_glass_events_KeyEvent_VK_F1 },\n+    { GDK_KEY_F2, com_sun_glass_events_KeyEvent_VK_F2 },\n+    { GDK_KEY_F3, com_sun_glass_events_KeyEvent_VK_F3 },\n+    { GDK_KEY_F4, com_sun_glass_events_KeyEvent_VK_F4 },\n+    { GDK_KEY_F5, com_sun_glass_events_KeyEvent_VK_F5 },\n+    { GDK_KEY_F6, com_sun_glass_events_KeyEvent_VK_F6 },\n+    { GDK_KEY_F7, com_sun_glass_events_KeyEvent_VK_F7 },\n+    { GDK_KEY_F8, com_sun_glass_events_KeyEvent_VK_F8 },\n+    { GDK_KEY_F9, com_sun_glass_events_KeyEvent_VK_F9 },\n+    { GDK_KEY_F10, com_sun_glass_events_KeyEvent_VK_F10 },\n+    { GDK_KEY_F11, com_sun_glass_events_KeyEvent_VK_F11 },\n+    { GDK_KEY_F12, com_sun_glass_events_KeyEvent_VK_F12 },\n+    { GDK_KEY_Shift_L, com_sun_glass_events_KeyEvent_VK_SHIFT },\n+    { GDK_KEY_Shift_R, com_sun_glass_events_KeyEvent_VK_SHIFT },\n+    { GDK_KEY_Control_L, com_sun_glass_events_KeyEvent_VK_CONTROL },\n+    { GDK_KEY_Control_R, com_sun_glass_events_KeyEvent_VK_CONTROL },\n+    { GDK_KEY_Caps_Lock, com_sun_glass_events_KeyEvent_VK_CAPS_LOCK },\n+    { GDK_KEY_Meta_L, com_sun_glass_events_KeyEvent_VK_WINDOWS },\n+    { GDK_KEY_Meta_R, com_sun_glass_events_KeyEvent_VK_CONTEXT_MENU },\n+    { GDK_KEY_Alt_L, com_sun_glass_events_KeyEvent_VK_ALT },\n+    { GDK_KEY_Alt_R, com_sun_glass_events_KeyEvent_VK_ALT_GRAPH },\n+    { GDK_KEY_Super_L, com_sun_glass_events_KeyEvent_VK_WINDOWS },\n+    { GDK_KEY_Super_R, com_sun_glass_events_KeyEvent_VK_WINDOWS },\n+    { GDK_KEY_Delete, com_sun_glass_events_KeyEvent_VK_DELETE }\n+};\n+\n+jint gdk_keyval_to_glass(guint keyval) {\n+    int min = 0;\n+    int max = G_N_ELEMENTS(gdk_to_glass_keys) - 1;\n+    int mid;\n+\n+    \/\/ binary search\n+    while (max >= min) {\n+        mid = (min + max) \/ 2;\n+        if (gdk_to_glass_keys[mid].gdk_key < keyval) {\n+            min = mid + 1;\n+        } else if (gdk_to_glass_keys[mid].gdk_key > keyval) {\n+            max = mid - 1;\n+        } else {\n+            return gdk_to_glass_keys[mid].glass_key;\n+        }\n@@ -234,1 +244,0 @@\n-}\n@@ -236,4 +245,1 @@\n-jint gdk_keyval_to_glass(guint keyval)\n-{\n-    init_keymap();\n-    return GPOINTER_TO_INT(g_hash_table_lookup(keymap, GINT_TO_POINTER(keyval)));\n+    return com_sun_glass_events_KeyEvent_VK_UNDEFINED;\n@@ -243,2 +249,0 @@\n-    init_keymap();\n-\n@@ -252,2 +256,1 @@\n-    jint key = GPOINTER_TO_INT(g_hash_table_lookup(keymap,\n-            GINT_TO_POINTER(keyValue)));\n+    jint key = gdk_keyval_to_glass(e->keyval);\n@@ -265,2 +268,1 @@\n-        key = GPOINTER_TO_INT(g_hash_table_lookup(keymap,\n-                GINT_TO_POINTER(keyValue)));\n+        key = gdk_keyval_to_glass(keyValue);\n@@ -273,9 +275,6 @@\n-    gint result = -1;\n-    GHashTableIter iter;\n-    gpointer key, value;\n-    init_keymap();\n-    g_hash_table_iter_init(&iter, keymap);\n-    while (g_hash_table_iter_next(&iter, &key, &value)) {\n-        if (code == GPOINTER_TO_INT(value)) {\n-            result = GPOINTER_TO_INT(key);\n-            break;\n+    int max = G_N_ELEMENTS(gdk_to_glass_keys);\n+\n+    \/\/ cant't do binary search because it's unorderd\n+    for (int i = 0; i < max; i++) {\n+        if (gdk_to_glass_keys[i].glass_key == code) {\n+            return gdk_to_glass_keys[i].gdk_key;\n@@ -284,1 +283,2 @@\n-    return result;\n+\n+    return -1;\n@@ -287,2 +287,1 @@\n-jint gdk_modifier_mask_to_glass(guint mask)\n-{\n+jint gdk_modifier_mask_to_glass(guint mask) {\n@@ -316,1 +315,1 @@\n-            return 0;\n+            return com_sun_glass_events_KeyEvent_MODIFIER_NONE;\n","filename":"modules\/javafx.graphics\/src\/main\/native-glass\/gtk\/glass_key.cpp","additions":222,"deletions":223,"binary":false,"changes":445,"status":"modified"},{"patch":"@@ -462,16 +462,0 @@\n-    } else {\n-#ifdef GLASS_GTK2\n-        if (key == 0) {\n-            \/\/ Work around \"bug\" fixed in gtk-3.0:\n-            \/\/ http:\/\/mail.gnome.org\/archives\/commits-list\/2011-March\/msg06832.html\n-            switch (event->keyval) {\n-            case 0xFF08 \/* Backspace *\/: key =  '\\b';\n-            case 0xFF09 \/* Tab       *\/: key =  '\\t';\n-            case 0xFF0A \/* Linefeed  *\/: key =  '\\n';\n-            case 0xFF0B \/* Vert. Tab *\/: key =  '\\v';\n-            case 0xFF0D \/* Return    *\/: key =  '\\r';\n-            case 0xFF1B \/* Escape    *\/: key =  '\\033';\n-            case 0xFFFF \/* Delete    *\/: key =  '\\177';\n-            }\n-        }\n-#endif\n@@ -489,8 +473,0 @@\n-    if (jview) {\n-        if (press) {\n-            mainEnv->CallVoidMethod(jview, jViewNotifyKey,\n-                    com_sun_glass_events_KeyEvent_PRESS,\n-                    glassKey,\n-                    jChars,\n-                    glassModifier);\n-            CHECK_JNI_EXCEPTION(mainEnv)\n@@ -498,16 +474,19 @@\n-            if (jview && key > 0) { \/\/ TYPED events should only be sent for printable characters.\n-                mainEnv->CallVoidMethod(jview, jViewNotifyKey,\n-                        com_sun_glass_events_KeyEvent_TYPED,\n-                        com_sun_glass_events_KeyEvent_VK_UNDEFINED,\n-                        jChars,\n-                        glassModifier);\n-                CHECK_JNI_EXCEPTION(mainEnv)\n-            }\n-        } else {\n-            mainEnv->CallVoidMethod(jview, jViewNotifyKey,\n-                    com_sun_glass_events_KeyEvent_RELEASE,\n-                    glassKey,\n-                    jChars,\n-                    glassModifier);\n-            CHECK_JNI_EXCEPTION(mainEnv)\n-        }\n+    if (!jview) {\n+        return;\n+    }\n+\n+    mainEnv->CallVoidMethod(jview, jViewNotifyKey,\n+            (press) ? com_sun_glass_events_KeyEvent_PRESS\n+                    : com_sun_glass_events_KeyEvent_RELEASE,\n+            glassKey,\n+            jChars,\n+            glassModifier);\n+    CHECK_JNI_EXCEPTION(mainEnv)\n+\n+    if (press && key > 0) { \/\/ TYPED events should only be sent for printable characters.\n+        mainEnv->CallVoidMethod(jview, jViewNotifyKey,\n+                com_sun_glass_events_KeyEvent_TYPED,\n+                com_sun_glass_events_KeyEvent_VK_UNDEFINED,\n+                jChars,\n+                glassModifier);\n+        CHECK_JNI_EXCEPTION(mainEnv)\n","filename":"modules\/javafx.graphics\/src\/main\/native-glass\/gtk\/glass_window.cpp","additions":19,"deletions":40,"binary":false,"changes":59,"status":"modified"}]}