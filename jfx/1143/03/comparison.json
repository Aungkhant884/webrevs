{"files":[{"patch":"@@ -37,2 +37,1 @@\n-static void glass_g_hash_table_insert_int(GHashTable *table, gint key, gint value)\n-{\n+static void glass_g_hash_table_insert_int(GHashTable *table, gint key, gint value) {\n@@ -42,2 +41,1 @@\n-static void initialize_key()\n-{\n+static void initialize_key() {\n@@ -48,1 +46,1 @@\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(Clear), com_sun_glass_events_KeyEvent_VK_CLEAR); \/\/XXX what is this?\n+    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(Clear), com_sun_glass_events_KeyEvent_VK_CLEAR);\n@@ -53,1 +51,1 @@\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(Print), com_sun_glass_events_KeyEvent_VK_PRINTSCREEN); \/\/XXX is correct?\n+    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(Print), com_sun_glass_events_KeyEvent_VK_PRINTSCREEN);\n@@ -55,1 +53,1 @@\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(Help), com_sun_glass_events_KeyEvent_VK_HELP); \/\/XXX what is this?\n+    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(Help), com_sun_glass_events_KeyEvent_VK_HELP);\n@@ -58,1 +56,1 @@\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(Shift_R), com_sun_glass_events_KeyEvent_VK_SHIFT); \/\/XXX is this correct?\n+    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(Shift_R), com_sun_glass_events_KeyEvent_VK_SHIFT);\n@@ -67,1 +65,1 @@\n-    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(Meta_R), com_sun_glass_events_KeyEvent_VK_CONTEXT_MENU);\/\/XXX is this correct?\n+    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(Meta_R), com_sun_glass_events_KeyEvent_VK_CONTEXT_MENU);\n@@ -227,0 +225,18 @@\n+\n+    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(ISO_Level3_Shift), com_sun_glass_events_KeyEvent_VK_ALT_GRAPH);\n+    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(dead_grave), com_sun_glass_events_KeyEvent_VK_DEAD_GRAVE);\n+    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(dead_acute), com_sun_glass_events_KeyEvent_VK_DEAD_ACUTE);\n+    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(dead_circumflex), com_sun_glass_events_KeyEvent_VK_DEAD_CIRCUMFLEX);\n+    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(dead_tilde), com_sun_glass_events_KeyEvent_VK_DEAD_TILDE);\n+    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(dead_macron), com_sun_glass_events_KeyEvent_VK_DEAD_MACRON);\n+    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(dead_breve), com_sun_glass_events_KeyEvent_VK_DEAD_BREVE);\n+    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(dead_abovedot), com_sun_glass_events_KeyEvent_VK_DEAD_ABOVEDOT);\n+    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(dead_diaeresis), com_sun_glass_events_KeyEvent_VK_DEAD_DIAERESIS);\n+    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(dead_abovering), com_sun_glass_events_KeyEvent_VK_DEAD_ABOVERING);\n+    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(dead_doubleacute), com_sun_glass_events_KeyEvent_VK_DEAD_DOUBLEACUTE);\n+    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(dead_caron), com_sun_glass_events_KeyEvent_VK_DEAD_CARON);\n+    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(dead_cedilla), com_sun_glass_events_KeyEvent_VK_DEAD_CEDILLA);\n+    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(dead_ogonek), com_sun_glass_events_KeyEvent_VK_DEAD_OGONEK);\n+    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(dead_iota), com_sun_glass_events_KeyEvent_VK_DEAD_IOTA);\n+    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(dead_voiced_sound), com_sun_glass_events_KeyEvent_VK_DEAD_VOICED_SOUND);\n+    glass_g_hash_table_insert_int(keymap, GLASS_GDK_KEY_CONSTANT(dead_semivoiced_sound), com_sun_glass_events_KeyEvent_VK_DEAD_SEMIVOICED_SOUND);\n@@ -236,2 +252,1 @@\n-jint gdk_keyval_to_glass(guint keyval)\n-{\n+jint gdk_keyval_to_glass(guint keyval) {\n@@ -287,2 +302,1 @@\n-jint gdk_modifier_mask_to_glass(guint mask)\n-{\n+jint gdk_modifier_mask_to_glass(guint mask) {\n@@ -316,1 +330,1 @@\n-            return 0;\n+            return com_sun_glass_events_KeyEvent_MODIFIER_NONE;\n","filename":"modules\/javafx.graphics\/src\/main\/native-glass\/gtk\/glass_key.cpp","additions":28,"deletions":14,"binary":false,"changes":42,"status":"modified"},{"patch":"@@ -462,16 +462,0 @@\n-    } else {\n-#ifdef GLASS_GTK2\n-        if (key == 0) {\n-            \/\/ Work around \"bug\" fixed in gtk-3.0:\n-            \/\/ http:\/\/mail.gnome.org\/archives\/commits-list\/2011-March\/msg06832.html\n-            switch (event->keyval) {\n-            case 0xFF08 \/* Backspace *\/: key =  '\\b';\n-            case 0xFF09 \/* Tab       *\/: key =  '\\t';\n-            case 0xFF0A \/* Linefeed  *\/: key =  '\\n';\n-            case 0xFF0B \/* Vert. Tab *\/: key =  '\\v';\n-            case 0xFF0D \/* Return    *\/: key =  '\\r';\n-            case 0xFF1B \/* Escape    *\/: key =  '\\033';\n-            case 0xFFFF \/* Delete    *\/: key =  '\\177';\n-            }\n-        }\n-#endif\n@@ -489,8 +473,0 @@\n-    if (jview) {\n-        if (press) {\n-            mainEnv->CallVoidMethod(jview, jViewNotifyKey,\n-                    com_sun_glass_events_KeyEvent_PRESS,\n-                    glassKey,\n-                    jChars,\n-                    glassModifier);\n-            CHECK_JNI_EXCEPTION(mainEnv)\n@@ -498,16 +474,19 @@\n-            if (jview && key > 0) { \/\/ TYPED events should only be sent for printable characters.\n-                mainEnv->CallVoidMethod(jview, jViewNotifyKey,\n-                        com_sun_glass_events_KeyEvent_TYPED,\n-                        com_sun_glass_events_KeyEvent_VK_UNDEFINED,\n-                        jChars,\n-                        glassModifier);\n-                CHECK_JNI_EXCEPTION(mainEnv)\n-            }\n-        } else {\n-            mainEnv->CallVoidMethod(jview, jViewNotifyKey,\n-                    com_sun_glass_events_KeyEvent_RELEASE,\n-                    glassKey,\n-                    jChars,\n-                    glassModifier);\n-            CHECK_JNI_EXCEPTION(mainEnv)\n-        }\n+    if (!jview) {\n+        return;\n+    }\n+\n+    mainEnv->CallVoidMethod(jview, jViewNotifyKey,\n+            (press) ? com_sun_glass_events_KeyEvent_PRESS\n+                    : com_sun_glass_events_KeyEvent_RELEASE,\n+            glassKey,\n+            jChars,\n+            glassModifier);\n+    CHECK_JNI_EXCEPTION(mainEnv)\n+\n+    if (press && key > 0) { \/\/ TYPED events should only be sent for printable characters.\n+        mainEnv->CallVoidMethod(jview, jViewNotifyKey,\n+                com_sun_glass_events_KeyEvent_TYPED,\n+                com_sun_glass_events_KeyEvent_VK_UNDEFINED,\n+                jChars,\n+                glassModifier);\n+        CHECK_JNI_EXCEPTION(mainEnv)\n","filename":"modules\/javafx.graphics\/src\/main\/native-glass\/gtk\/glass_window.cpp","additions":19,"deletions":40,"binary":false,"changes":59,"status":"modified"}]}