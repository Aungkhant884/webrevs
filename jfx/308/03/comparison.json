{"files":[{"patch":"@@ -946,0 +946,7 @@\n+    \/**\n+     * Cached snapScale values, used for to determine if snapped cached insets values\n+     * should be invalidated because screen scale has changed.\n+     *\/\n+    private double lastUsedSnapScaleY = 0;\n+    private double lastUsedSnapScaleX = 0;\n+\n@@ -948,0 +955,2 @@\n+        lastUsedSnapScaleX = getSnapScaleX();\n+        lastUsedSnapScaleY = getSnapScaleY();\n@@ -949,11 +958,5 @@\n-        if (_snapToPixel) {\n-            snappedTopInset = Math.ceil(insets.getTop());\n-            snappedRightInset = Math.ceil(insets.getRight());\n-            snappedBottomInset = Math.ceil(insets.getBottom());\n-            snappedLeftInset = Math.ceil(insets.getLeft());\n-        } else {\n-            snappedTopInset = insets.getTop();\n-            snappedRightInset = insets.getRight();\n-            snappedBottomInset = insets.getBottom();\n-            snappedLeftInset = insets.getLeft();\n-        }\n+        final boolean snap = isSnapToPixel();\n+        snappedTopInset = snapSpaceY(insets.getTop(), snap);\n+        snappedRightInset = snapSpaceX(insets.getRight(), snap);\n+        snappedBottomInset = snapSpaceY(insets.getBottom(), snap);\n+        snappedLeftInset = snapSpaceX(insets.getLeft(), snap);\n@@ -1821,0 +1824,5 @@\n+        \/\/ invalidate the cached values for snapped inset dimensions\n+        \/\/ if the screen scale changed since they were last computed.\n+        if (lastUsedSnapScaleY != getSnapScaleY()) {\n+            updateSnappedInsets();\n+        }\n@@ -1832,0 +1840,3 @@\n+        if (lastUsedSnapScaleY != getSnapScaleY()) {\n+            updateSnappedInsets();\n+        }\n@@ -1843,0 +1854,3 @@\n+        if (lastUsedSnapScaleX != getSnapScaleX()) {\n+            updateSnappedInsets();\n+        }\n@@ -1854,0 +1868,3 @@\n+        if (lastUsedSnapScaleX != getSnapScaleX()) {\n+            updateSnappedInsets();\n+        }\n","filename":"modules\/javafx.graphics\/src\/main\/java\/javafx\/scene\/layout\/Region.java","additions":28,"deletions":11,"binary":false,"changes":39,"status":"modified"},{"patch":"@@ -615,4 +615,0 @@\n-    private static double snapSpace(double value, boolean snapToPixel) {\n-        return snapToPixel ? Math.round(value) : value;\n-    }\n-\n@@ -630,5 +626,4 @@\n-        final boolean snap = isSnapToPixel();\n-        double top = margin != null? snapSpace(margin.getTop(), snap) : 0;\n-        double bottom = margin != null? snapSpace(margin.getBottom(), snap) : 0;\n-        double left = margin != null? snapSpace(margin.getLeft(), snap) : 0;\n-        double right = margin != null? snapSpace(margin.getRight(), snap) : 0;\n+        double top = margin != null? snapSpaceY(margin.getTop()) : 0;\n+        double bottom = margin != null? snapSpaceY(margin.getBottom()) : 0;\n+        double left = margin != null? snapSpaceX(margin.getLeft()) : 0;\n+        double right = margin != null? snapSpaceX(margin.getRight()) : 0;\n@@ -649,5 +644,4 @@\n-        final boolean snap = isSnapToPixel();\n-        double top = margin != null? snapSpace(margin.getTop(), snap) : 0;\n-        double bottom = margin != null? snapSpace(margin.getBottom(), snap) : 0;\n-        double left = margin != null? snapSpace(margin.getLeft(), snap) : 0;\n-        double right = margin != null? snapSpace(margin.getRight(), snap) : 0;\n+        double top = margin != null? snapSpaceY(margin.getTop()) : 0;\n+        double bottom = margin != null? snapSpaceY(margin.getBottom()) : 0;\n+        double left = margin != null? snapSpaceX(margin.getLeft()) : 0;\n+        double right = margin != null? snapSpaceX(margin.getRight()) : 0;\n","filename":"modules\/javafx.graphics\/src\/main\/java\/javafx\/scene\/text\/TextFlow.java","additions":8,"deletions":14,"binary":false,"changes":22,"status":"modified"}]}