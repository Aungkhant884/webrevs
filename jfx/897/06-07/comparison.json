{"files":[{"patch":"@@ -72,1 +72,0 @@\n-                pref[i] = clip(c.getPrefWidth(), c.getMinWidth(), c.getMaxWidth());\n@@ -74,0 +73,2 @@\n+                \/\/ TODO use integers or round\n+                pref[i] = clip(c.getPrefWidth(), c.getMinWidth(), c.getMaxWidth());\n@@ -81,2 +82,1 @@\n-        boolean needsAnotherPass = false;\n-\n+        boolean needsAnotherPass;\n@@ -84,0 +84,1 @@\n+            needsAnotherPass = false;\n@@ -144,2 +145,0 @@\n-            if (needsAnotherPass) {\n-            }\n@@ -327,0 +326,1 @@\n+            double w1 = sumSizes(); \/\/ FIX\n@@ -337,1 +337,9 @@\n-                adj = distributeDeltaRemainingColumns(-delta);\n+                distributeDeltaRemainingColumns(-delta);\n+                adj = 0.0;\n+                \n+                double w2 = sumSizes(); \/\/ FIX\n+                if(w1 != w2) {\n+                    System.err.println(\"ERR 2 sum sizes before=\"  + w1 + \" after=\" + w2 + \" adj=\" + adj + \" delta=\" + delta);\n+\/\/                    adj = w1-w2;\n+                }\n+                \n@@ -455,5 +463,2 @@\n-    protected double distributeDeltaRemainingColumns(double delta) {\n-        boolean needsAnotherPass = false;\n-        double adj = 0.0;\n-\n-        do {\n+    protected void distributeDeltaRemainingColumns(double delta) {\n+        for(;;) {\n@@ -468,1 +473,2 @@\n-                return adj;\n+                System.err.println(\"zero total\");\n+                return;\n@@ -471,1 +477,2 @@\n-            double rem = 0.0; \/\/ remainder from previous column\n+            double rem = 0.0; \/\/ remainder from the previous column\n+            boolean needsAnotherPass = false;\n@@ -485,1 +492,6 @@\n-                } else if (w > max[i]) {\n+                    double ch = (w - size[i]);\n+                    if(ch != 0) {\n+                        System.err.println(\"min ch=\" + ch);\n+                    }\n+                    delta -= ch;\n+               } else if (w > max[i]) {\n@@ -490,0 +502,5 @@\n+                    double ch = (w - size[i]);\n+                    if(ch != 0) {\n+                        System.err.println(\"max ch=\" + ch);\n+                    }\n+                    delta -= ch;\n@@ -495,5 +512,4 @@\n-            }\n-\n-            if (Math.abs(delta) < 1.0) {\n-                if (Math.abs(delta) >= 0.5) {\n-                    adj = Math.signum(delta);\n+                \n+                if(needsAnotherPass) {\n+                    resetSizeChanges();\n+                    break;\n@@ -501,1 +517,0 @@\n-                needsAnotherPass = false;\n@@ -504,1 +519,6 @@\n-        } while (needsAnotherPass);\n+\/\/            if (Math.abs(delta) < 1.0) {\n+\/\/                if (Math.abs(delta) >= 0.5) {\n+\/\/                    adj = Math.signum(delta);\n+\/\/                }\n+\/\/                needsAnotherPass = false;\n+\/\/            }\n@@ -506,1 +526,21 @@\n-        return adj;\n+            if (!needsAnotherPass) {\n+                return;\n+            }\n+        }\n+    }\n+    \n+    private void resetSizeChanges() {\n+        \/\/ reset size changes\n+        for (int i = 0; i < count; i++) {\n+            if (!skip.get(i)) {\n+                size[i] = columns.get(i).getWidth();\n+            }\n+        }\n+    }\n+\n+    private double sumSizes() {\n+        double sum = 0.0;\n+        for (int i = 0; i < count; i++) {\n+            sum += size[i];\n+        }\n+        return sum;\n","filename":"modules\/javafx.controls\/src\/main\/java\/com\/sun\/javafx\/scene\/control\/ResizeHelper.java","additions":62,"deletions":22,"binary":false,"changes":84,"status":"modified"},{"patch":"@@ -174,2 +174,2 @@\n-        demoSelector.getSelectionModel().selectFirst();\n-        policySelector.getSelectionModel().selectFirst();\n+        demoSelector.getSelectionModel().select(Demo.FIXED_MIDDLE); \/\/ selectFirst();\n+        policySelector.getSelectionModel().select(Policy.AUTO_RESIZE_SUBSEQUENT_COLUMNS); \/\/ selectFirst();\n","filename":"tests\/manual\/tester\/src\/com\/oracle\/javafx\/tester\/ATableViewResizeTester.java","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"}]}