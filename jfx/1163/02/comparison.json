{"files":[{"patch":"@@ -861,0 +861,3 @@\n+            if (oldIndex > cellCount) {\n+                oldIndex = cellCount;\n+            }\n@@ -2991,1 +2994,5 @@\n-    private int computeCurrentIndex() {\n+    \/**\n+     * Compute the index of the first visible cell\n+     * This has package access ONLY FOR TESTING.\n+     *\/\n+    int computeCurrentIndex() {\n","filename":"modules\/javafx.controls\/src\/main\/java\/javafx\/scene\/control\/skin\/VirtualFlow.java","additions":8,"deletions":1,"binary":false,"changes":9,"status":"modified"},{"patch":"@@ -83,0 +83,4 @@\n+    public int shim_computeCurrentIndex() {\n+        return super.computeCurrentIndex();\n+    }\n+\n","filename":"modules\/javafx.controls\/src\/shims\/java\/javafx\/scene\/control\/skin\/VirtualFlowShim.java","additions":4,"deletions":0,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -73,0 +73,1 @@\n+    private int prefSizeCounter;\n@@ -81,0 +82,1 @@\n+        prefSizeCounter = 0;\n@@ -102,0 +104,1 @@\n+                prefSizeCounter++;\n@@ -117,0 +120,1 @@\n+                prefSizeCounter++;\n@@ -1716,0 +1720,32 @@\n+\n+    @Test\n+    public void testLowerCellCount() {\n+        flow.setCellCount(10000);\n+        int idx = flow.shim_computeCurrentIndex();\n+        assertEquals(0, idx);\n+\n+        assertTrue(prefSizeCounter < 500);\n+        int cntr = prefSizeCounter;\n+        flow.scrollTo(9999);\n+        pulse();\n+        idx = flow.shim_computeCurrentIndex();\n+        assertTrue(idx < 10000);\n+        int newCounter = prefSizeCounter - cntr;\n+        assertTrue(newCounter < 100);\n+        cntr = prefSizeCounter;\n+\n+        flow.setCellCount(5000);\n+        idx = flow.shim_computeCurrentIndex();\n+        assertTrue(idx < 5000);\n+        newCounter = prefSizeCounter - cntr;\n+        assertTrue(newCounter < 100);\n+        cntr = prefSizeCounter;\n+\n+        pulse();\n+        idx = flow.shim_computeCurrentIndex();\n+        assertTrue(idx < 5000);\n+        newCounter = prefSizeCounter - cntr;\n+\n+        assertTrue(newCounter < 100);\n+\n+    }\n","filename":"modules\/javafx.controls\/src\/test\/java\/test\/javafx\/scene\/control\/skin\/VirtualFlowTest.java","additions":36,"deletions":0,"binary":false,"changes":36,"status":"modified"}]}