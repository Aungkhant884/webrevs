{"files":[{"patch":"@@ -532,2 +532,2 @@\n-        if (obj instanceof BitSet<?> bitSet) {  \/\/ fast path if other is a BitSet\n-            return equalsBitSet(bitSet);\n+        if (getClass() == obj.getClass()) {  \/\/ fast path if other is exact same type of BitSet\n+            return equalsBitSet((BitSet<?>) obj);\n","filename":"modules\/javafx.graphics\/src\/main\/java\/com\/sun\/javafx\/css\/BitSet.java","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -29,0 +29,1 @@\n+import static org.junit.jupiter.api.Assertions.assertNotEquals;\n@@ -31,0 +32,1 @@\n+import java.util.Set;\n@@ -36,0 +38,3 @@\n+import com.sun.javafx.css.PseudoClassState;\n+import com.sun.javafx.css.PseudoClassStateShim;\n+import com.sun.javafx.css.StyleClassSet;\n@@ -40,0 +45,1 @@\n+import javafx.css.StyleClass;\n@@ -137,0 +143,35 @@\n+\n+    @Test\n+    void twoNonEmptyBitSetsWithSamePatternAndSizeShouldNotBeConsideredEqualsWhenElementTypesAreDifferent() {\n+        StyleClassSet set1 = new StyleClassSet();\n+        PseudoClassState set2 = new PseudoClassState();\n+\n+        PseudoClass pseudoClass = PseudoClass.getPseudoClass(\"abc\");\n+\n+        int index = PseudoClassStateShim.pseudoClassMap.get(pseudoClass.getPseudoClassName());\n+\n+        set1.add(new StyleClass(\"xyz\", index));  \/\/ no idea why this is public API, but I'll take it\n+        set2.add(pseudoClass);\n+\n+        \/*\n+         * The two sets above contain elements of different types (PseudoClass and StyleClass)\n+         * and therefore should never be equal, despite their bit pattern being the same:\n+         *\/\n+\n+        assertNotEquals(set1, set2);\n+    }\n+\n+    @Test\n+    void twoEmptyBitSetsShouldBeEqual() {\n+\n+        \/*\n+         * Per Set contract, the empty set is equal to any other empty set.\n+         *\/\n+\n+        assertEquals(new StyleClassSet(), new PseudoClassState());\n+        assertEquals(new PseudoClassState(), new StyleClassSet());\n+        assertEquals(Set.of(), new PseudoClassState());\n+        assertEquals(new PseudoClassState(), Set.of());\n+        assertEquals(Set.of(), new StyleClassSet());\n+        assertEquals(new StyleClassSet(), Set.of());\n+    }\n","filename":"modules\/javafx.graphics\/src\/test\/java\/test\/com\/sun\/javafx\/css\/BitSetTest.java","additions":41,"deletions":0,"binary":false,"changes":41,"status":"modified"}]}