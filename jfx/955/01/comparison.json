{"files":[{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2013, 2018, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2013, 2022, Oracle and\/or its affiliates. All rights reserved.\n@@ -30,0 +30,3 @@\n+\n+import test.util.Util;\n+\n@@ -70,0 +73,1 @@\n+    private Robot robot;\n@@ -91,0 +95,3 @@\n+        robot = new Robot();\n+        Util.parkCursor(robot);\n+\n@@ -116,2 +123,1 @@\n-            Robot r = new Robot();\n-            rgb[0] = r.getPixelColor(x + SIZE\/2, y + SIZE\/2);\n+            rgb[0] = robot.getPixelColor(x + SIZE\/2, y + SIZE\/2);\n","filename":"tests\/system\/src\/test\/java\/test\/robot\/javafx\/embed\/swing\/RT30650GUI.java","additions":9,"deletions":3,"binary":false,"changes":12,"status":"modified"},{"patch":"@@ -55,0 +55,1 @@\n+import org.junit.Before;\n@@ -298,0 +299,5 @@\n+    @Before\n+    public void before() {\n+        Util.parkCursor(robot);\n+    }\n+\n@@ -308,5 +314,1 @@\n-        try {\n-            Thread.sleep(DELAY);\n-        } catch (Exception ex) {\n-            fail(\"Thread was interrupted.\" + ex);\n-        }\n+        Util.sleep(DELAY);\n","filename":"tests\/system\/src\/test\/java\/test\/robot\/javafx\/scene\/PixelBufferDrawTest.java","additions":7,"deletions":5,"binary":false,"changes":12,"status":"modified"},{"patch":"@@ -28,1 +28,0 @@\n-import static org.junit.Assert.fail;\n@@ -33,1 +32,0 @@\n-import java.util.concurrent.TimeUnit;\n@@ -147,5 +145,1 @@\n-        double x = stage.getX() + stage.getWidth();\n-        double y = stage.getY() + stage.getHeight();\n-        Util.runAndWait(() -> {\n-            robot.mouseMove(x,y);\n-        });\n+        Util.parkCursor(robot);\n","filename":"tests\/system\/src\/test\/java\/test\/robot\/javafx\/scene\/RobotTest.java","additions":1,"deletions":7,"binary":false,"changes":8,"status":"modified"},{"patch":"@@ -46,0 +46,1 @@\n+import org.junit.Before;\n@@ -115,0 +116,5 @@\n+    @Before\n+    public void before() {\n+        Util.parkCursor(robot);\n+    }\n+\n","filename":"tests\/system\/src\/test\/java\/test\/robot\/javafx\/scene\/canvas\/ImageSmoothingDrawTest.java","additions":6,"deletions":0,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -29,1 +29,3 @@\n-import org.junit.Before;\n+import javafx.geometry.Bounds;\n+import javafx.scene.paint.Color;\n+\n@@ -35,3 +37,0 @@\n-import javafx.geometry.Bounds;\n-import javafx.scene.paint.Color;\n-\n@@ -46,9 +45,0 @@\n-    @Before\n-    public void before() {\n-        double x = stage.getX() + stage.getWidth();\n-        double y = stage.getY() + stage.getHeight();\n-        runAndWait(() -> {\n-            getRobot().mouseMove(x,y);\n-        });\n-    }\n-\n","filename":"tests\/system\/src\/test\/java\/test\/robot\/javafx\/scene\/layout\/RegionBackgroundImageUITest.java","additions":3,"deletions":13,"binary":false,"changes":16,"status":"modified"},{"patch":"@@ -104,0 +104,1 @@\n+        Util.parkCursor(robot);\n","filename":"tests\/system\/src\/test\/java\/test\/robot\/testharness\/VisualTestBase.java","additions":1,"deletions":0,"binary":false,"changes":1,"status":"modified"},{"patch":"@@ -43,0 +43,3 @@\n+import javafx.geometry.Rectangle2D;\n+import javafx.scene.robot.Robot;\n+import javafx.stage.Screen;\n@@ -398,0 +401,23 @@\n+\n+    \/**\n+     * Moves the cursor outside of the Stage to avoid it interfering with Robot tests.\n+     * The cursor is moved to a point close to the lower right corner of the primary screen,\n+     * avoiding any areas occupied by dock, tray, or Active Corners.\n+     * <p>\n+     * This method can be called from any thread.\n+     *\/\n+    public static void parkCursor(Robot robot) {\n+        Runnable park = () -> {\n+            Rectangle2D r = Screen.getPrimary().getVisualBounds();\n+            double activeCornersMargin = 5.0;\n+            double x = r.getMaxX() - activeCornersMargin;\n+            double y = r.getMaxY() - activeCornersMargin;\n+            robot.mouseMove(x, y);\n+        };\n+\n+        if (Platform.isFxApplicationThread()) {\n+            park.run();\n+        } else {\n+            runAndWait(park);\n+        }\n+    }\n","filename":"tests\/system\/src\/test\/java\/test\/util\/Util.java","additions":26,"deletions":0,"binary":false,"changes":26,"status":"modified"}]}