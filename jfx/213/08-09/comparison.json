{"files":[{"patch":"@@ -573,0 +573,38 @@\n+    private void fillShapeMasked(Graphics g, Shape shape, Paint paint) {\n+        Rectangle clipRectangle = getClipRectNoClone();\n+        RTTexture paintRtTexture = g.getResourceFactory().createRTTexture(\n+                clipRectangle.width, clipRectangle.height, Texture.WrapMode.CLAMP_NOT_NEEDED);\n+        Graphics g1 = paintRtTexture.createGraphics();\n+        state.apply(g1);\n+        g1.setPaint(paint);\n+        g1.fill(shape);\n+\n+        RTImage maskImage = (RTImage) (state.getClipMaskImageNoClone());\n+        Image nativeMaskImage = Image.fromByteBgraPreData(maskImage.getPixelBuffer(), maskImage.getWidth(),\n+                maskImage.getHeight(), 0, maskImage.getPixelScale());\n+        Texture maskTexture = g.getResourceFactory().createTexture(PixelFormat.BYTE_BGRA_PRE,\n+                Texture.Usage.STATIC, Texture.WrapMode.CLAMP_NOT_NEEDED,\n+                nativeMaskImage.getWidth(), nativeMaskImage.getHeight());\n+        maskTexture.update(nativeMaskImage, 0, 0, nativeMaskImage.getWidth(),\n+                nativeMaskImage.getHeight());\n+        RTTexture maskRtTexture = g.getResourceFactory().createRTTexture(clipRectangle.width,\n+                clipRectangle.height, Texture.WrapMode.CLAMP_NOT_NEEDED);\n+        Graphics g2 = maskRtTexture.createGraphics();\n+        g2.drawTexture(maskTexture, 0, 0, clipRectangle.width, clipRectangle.height,\n+                0, 0, nativeMaskImage.getWidth(), nativeMaskImage.getHeight());\n+        maskTexture.dispose();\n+        FilterContext filterContext = getFilterContext(g);\n+        PrDrawable imagePrDrawable = PrDrawable.create(filterContext, paintRtTexture);\n+        PrDrawable maskPrDrawable = PrDrawable.create(filterContext, maskRtTexture);\n+        Blend blend = new Blend(Blend.Mode.SRC_IN,\n+                new PassThrough(maskPrDrawable, clipRectangle.width, clipRectangle.height),\n+                new PassThrough(imagePrDrawable, clipRectangle.width, clipRectangle.height));\n+\n+        Affine3D tx = new Affine3D(g.getTransformNoClone());\n+        g.setTransform(BaseTransform.IDENTITY_TRANSFORM);\n+        PrEffectHelper.render(blend, g, clipRectangle.x, clipRectangle.y, null);\n+        g.setTransform(tx);\n+        paintRtTexture.dispose();\n+        maskRtTexture.dispose();\n+    }\n+\n@@ -602,0 +640,2 @@\n+                } else if (state.getClipMaskImageNoClone() != null) {\n+                    fillShapeMasked(g, new RoundRectangle2D(x, y, w, h, arcW, arcH), paint);\n@@ -1847,0 +1887,2 @@\n+                    } else if (state.getClipMaskImageNoClone() != null) {\n+                        fillShapeMasked(g, p2d, paint);\n","filename":"modules\/javafx.web\/src\/main\/java\/com\/sun\/javafx\/webkit\/prism\/WCGraphicsPrismContext.java","additions":42,"deletions":0,"binary":false,"changes":42,"status":"modified"}]}