{"files":[{"patch":"@@ -282,1 +282,4 @@\n-                    getSelectionModel().clearSelection();\n+                    SingleSelectionModel<T> selectionModel = getSelectionModel();\n+                    if (selectionModel != null) {\n+                        selectionModel.clearSelection();\n+                    }\n","filename":"modules\/javafx.controls\/src\/main\/java\/javafx\/scene\/control\/ComboBox.java","additions":4,"deletions":1,"binary":false,"changes":5,"status":"modified"},{"patch":"@@ -325,3 +325,7 @@\n-                T item = comboBox.getSelectionModel().getSelectedItem();\n-                listView.getSelectionModel().clearSelection();\n-                listView.getSelectionModel().select(item);\n+                SingleSelectionModel<T> selectionModel = comboBox.getSelectionModel();\n+\n+                if (selectionModel != null) {\n+                    T item = selectionModel.getSelectedItem();\n+                    listView.getSelectionModel().clearSelection();\n+                    listView.getSelectionModel().select(item);\n+                }\n","filename":"modules\/javafx.controls\/src\/main\/java\/javafx\/scene\/control\/skin\/ComboBoxListViewSkin.java","additions":7,"deletions":3,"binary":false,"changes":10,"status":"modified"},{"patch":"@@ -307,1 +307,1 @@\n-    @Test public void testNullSelectionModelDoesNotThrowNPEOnValueChange() {\n+    @Test public void testNullSelectionModelDoesNotThrowNPEInSkinOnLayout() {\n@@ -317,0 +317,24 @@\n+        comboBox.setButtonCell(buttonCell);\n+        comboBox.setItems(items);\n+\n+        comboBox.setValue(items.get(1));\n+        comboBox.setSelectionModel(null);\n+\n+        comboBox.layout();\n+\n+        assertEquals(items.get(1), comboBox.getButtonCell().getText());\n+    }\n+\n+    @Test public void testNullSelectionModelDoesNotThrowNPEOnEditableChange() {\n+        ObservableList<String> items = FXCollections.observableArrayList(\"ITEM1\", \"ITEM2\");\n+\n+        comboBox.setEditable(true);\n+        comboBox.setItems(items);\n+        comboBox.setSelectionModel(null);\n+        comboBox.setEditable(false);\n+\n+        assertNull(comboBox.getValue());\n+    }\n+\n+    @Test public void testNullSelectionModelDoesNotThrowNPEOnValueChange() {\n+        ObservableList<String> items = FXCollections.observableArrayList(\"ITEM1\", \"ITEM2\");\n@@ -319,1 +343,0 @@\n-        comboBox.setButtonCell(buttonCell);\n","filename":"modules\/javafx.controls\/src\/test\/java\/test\/javafx\/scene\/control\/ComboBoxTest.java","additions":25,"deletions":2,"binary":false,"changes":27,"status":"modified"}]}