{"files":[{"patch":"@@ -894,7 +894,2 @@\n-                double vPixelValue;\n-                if (nodeHeight > 0.0) {\n-                    vPixelValue = vRange \/ nodeHeight;\n-                }\n-                else {\n-                    vPixelValue = 0.0;\n-                }\n+                double hDelta = nodeHeight - contentHeight;\n+                double vPixelValue = hDelta > 0.0 ? vRange \/ hDelta : 0.0;\n@@ -926,8 +921,2 @@\n-                double hPixelValue;\n-                if (nodeWidth > 0.0) {\n-                    hPixelValue = hRange \/ nodeWidth;\n-                }\n-                else {\n-                    hPixelValue = 0.0;\n-                }\n-\n+                double wDelta = nodeWidth - contentWidth;\n+                double hPixelValue = wDelta > 0.0 ? hRange \/ wDelta : 0.0;\n@@ -1001,1 +990,2 @@\n-            double sdx = dx * (hsb.getMax() - hsb.getMin()) \/ (nodeWidth - contentWidth);\n+            double wd = nodeWidth - contentWidth;\n+            double sdx = wd > 0.0 ? dx * (hsb.getMax() - hsb.getMin()) \/ wd : 0;\n@@ -1008,1 +998,2 @@\n-            double sdy = dy * (vsb.getMax() - vsb.getMin()) \/ (nodeHeight - contentHeight);\n+            double hd = nodeHeight - contentHeight;\n+            double sdy = hd > 0.0 ? dy * (vsb.getMax() - vsb.getMin()) \/ hd : 0.0;\n@@ -1182,1 +1173,2 @@\n-        double minX = Math.min((- x \/ (hsb.getMax() - hsb.getMin()) * (nodeWidth - contentWidth)), 0);\n+        double hsbRange = hsb.getMax() - hsb.getMin();\n+        double minX = hsbRange > 0 ? Math.min(-x \/ hsbRange * (nodeWidth - contentWidth), 0) : 0;\n@@ -1190,1 +1182,2 @@\n-        double minY = Math.min((- posY \/ (vsb.getMax() - vsb.getMin()) * (nodeHeight - contentHeight)), 0);\n+        double vsbRange = vsb.getMax() - vsb.getMin();\n+        double minY = vsbRange > 0 ? Math.min(-posY \/ vsbRange * (nodeHeight - contentHeight), 0) : 0;\n","filename":"modules\/javafx.controls\/src\/main\/java\/javafx\/scene\/control\/skin\/ScrollPaneSkin.java","additions":12,"deletions":19,"binary":false,"changes":31,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2011, 2015, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2011, 2021, Oracle and\/or its affiliates. All rights reserved.\n@@ -748,0 +748,5 @@\n+    @Test\n+    public void testScrollDeltaIsIndependentOfScrollPaneHeight() {\n+        var content = new Rectangle();\n+        content.setHeight(200);\n+        content.setWidth(100);\n@@ -749,0 +754,44 @@\n+        var scrollPane = new ScrollPane();\n+        scrollPane.setSkin(new ScrollPaneSkinMock(scrollPane));\n+        scrollPane.setContent(content);\n+        scrollPane.setPrefWidth(100);\n+        scrollPane.setPrefHeight(100);\n+\n+        Stage stage = new Stage();\n+        stage.setScene(new Scene(new Group(scrollPane), 500, 500));\n+        stage.show();\n+\n+        Event.fireEvent(content, new ScrollEvent(\n+            ScrollEvent.SCROLL,\n+            50, 50,\n+            50, 50,\n+            false, false, false, false, true, false,\n+            0.0, -10.0, 0.0, -10.0,\n+            ScrollEvent.HorizontalTextScrollUnits.NONE, 0.0,\n+            ScrollEvent.VerticalTextScrollUnits.NONE, 0.0,\n+            0, null));\n+\n+        double firstY = content.getLocalToSceneTransform().transform(0, 0).getY();\n+        scrollPane.setPrefHeight(150);\n+        scrollPane.setVvalue(0);\n+\n+        stage.close();\n+        stage = new Stage();\n+        stage.setScene(new Scene(new Group(scrollPane), 500, 500));\n+        stage.show();\n+\n+        Event.fireEvent(content, new ScrollEvent(\n+            ScrollEvent.SCROLL,\n+            50, 50,\n+            50, 50,\n+            false, false, false, false, true, false,\n+            0.0, -10.0, 0.0, -10.0,\n+            ScrollEvent.HorizontalTextScrollUnits.NONE, 0.0,\n+            ScrollEvent.VerticalTextScrollUnits.NONE, 0.0,\n+            0, null));\n+\n+        double secondY = content.getLocalToSceneTransform().transform(0, 0).getY();\n+        stage.close();\n+\n+        assertEquals(firstY, secondY, 0.001);\n+    }\n","filename":"modules\/javafx.controls\/src\/test\/java\/test\/javafx\/scene\/control\/skin\/ScrollPaneSkinTest.java","additions":50,"deletions":1,"binary":false,"changes":51,"status":"modified"}]}