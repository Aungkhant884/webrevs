{"files":[{"patch":"@@ -749,1 +749,1 @@\n-    \/\/ the GDK_BUTTON_RELEASE will be put at the end of the queue bacause\n+    \/\/ the GDK_BUTTON_RELEASE will be put at the end of the queue because\n@@ -758,0 +758,1 @@\n+    GdkWindow *ignore = NULL;\n@@ -761,0 +762,1 @@\n+        ignore = ctx->drag_view->get_window();\n@@ -763,1 +765,1 @@\n-    gdk_drag_find_window_for_screen(ctx->dnd_ctx, NULL, gdk_screen_get_default(),\n+    gdk_drag_find_window_for_screen(ctx->dnd_ctx, ignore, gdk_screen_get_default(),\n@@ -808,4 +810,2 @@\n-static void process_dnd_source_drag_status(DragSourceContext *ctx, GdkEvent *event) {\n-    GdkEventDND *eventDnd = &event->dnd;\n-    GdkDragAction selected = gdk_drag_context_get_selected_action(eventDnd->context);\n-    GdkCursor* cursor;\n+static GdkCursor * get_action_cursor(GdkDragAction selected) {\n+    GdkCursor* cursor = NULL;\n@@ -834,6 +834,0 @@\n-    } else {\n-        cursor = gdk_cursor_new_from_name(gdk_display_get_default(), \"dnd-no-drop\");\n-\n-        if (cursor == NULL) {\n-            cursor = gdk_cursor_new_from_name(gdk_display_get_default(), \"no-drop\");\n-        }\n@@ -843,1 +837,1 @@\n-        cursor = gdk_cursor_new_from_name(gdk_display_get_default(), \"dnd-none\");\n+        cursor = gdk_cursor_new_from_name(gdk_display_get_default(), \"dnd-no-drop\");\n@@ -846,1 +840,1 @@\n-            cursor = gdk_cursor_new_from_name(gdk_display_get_default(), \"grabbing\");\n+            cursor = gdk_cursor_new_from_name(gdk_display_get_default(), \"no-drop\");\n@@ -850,1 +844,8 @@\n-    gdk_pointer_grab(ctx->dnd_window, FALSE, GDK_MOUSE_EVENTS_MASK, NULL, cursor, GDK_CURRENT_TIME);\n+    return cursor;\n+}\n+\n+static void process_dnd_source_drag_status(DragSourceContext *ctx, GdkEvent *event) {\n+    GdkEventDND *eventDnd = &event->dnd;\n+    GdkDragAction selected = gdk_drag_context_get_selected_action(eventDnd->context);\n+    gdk_pointer_grab(ctx->dnd_window, FALSE, GDK_MOUSE_EVENTS_MASK, NULL,\n+                        get_action_cursor(selected), GDK_CURRENT_TIME);\n@@ -911,0 +912,2 @@\n+    g_object_set_data(G_OBJECT(ctx->dnd_window), SOURCE_DND_CONTEXT, ctx);\n+\n@@ -916,1 +919,2 @@\n-        gdk_pointer_grab(ctx->dnd_window, FALSE, GDK_MOUSE_EVENTS_MASK, NULL, NULL, GDK_CURRENT_TIME);\n+        gdk_pointer_grab(ctx->dnd_window, FALSE, GDK_MOUSE_EVENTS_MASK, NULL,\n+                         get_action_cursor(GDK_ACTION_DEFAULT), GDK_CURRENT_TIME);\n@@ -919,1 +923,0 @@\n-    g_object_set_data(G_OBJECT(ctx->dnd_window), SOURCE_DND_CONTEXT, ctx);\n@@ -950,4 +953,0 @@\n-    if (!in_drag) {\n-        return true;\n-    }\n-\n@@ -956,1 +955,1 @@\n-    if (!window) {\n+    if (!in_drag || !window) {\n@@ -961,2 +960,1 @@\n-    if (drag_view != NULL && event->type == GDK_EXPOSE &&\n-        window == drag_view->get_window()) {\n+    if (drag_view != NULL && event->type == GDK_EXPOSE && window == drag_view->get_window()) {\n@@ -970,1 +968,1 @@\n-    if (ctx == NULL) {\n+    if (!ctx) {\n@@ -980,0 +978,1 @@\n+    \/\/ the window has grab\n","filename":"modules\/javafx.graphics\/src\/main\/native-glass\/gtk\/glass_dnd.cpp","additions":24,"deletions":25,"binary":false,"changes":49,"status":"modified"}]}