{"files":[{"patch":"@@ -25,0 +25,1 @@\n+\n@@ -30,0 +31,1 @@\n+import javafx.scene.input.MouseButton;\n@@ -31,0 +33,1 @@\n+import javafx.scene.robot.Robot;\n@@ -33,3 +36,0 @@\n-import javafx.scene.control.Tooltip;\n-import javafx.scene.input.MouseButton;\n-import javafx.scene.robot.Robot;\n@@ -38,0 +38,1 @@\n+import javafx.scene.control.Tooltip;\n@@ -47,1 +48,1 @@\n- * Unit test for verifying Slider NPE error.\n+ * Test for verifying Slider NPE error.\n@@ -49,1 +50,1 @@\n- * There is 1 tests in this file.\n+ * There is 1 test in this file.\n@@ -56,0 +57,1 @@\n+\n@@ -58,0 +60,4 @@\n+    static CountDownLatch tooltipLatch = new CountDownLatch(1);\n+    static Robot robot;\n+    static Slider slider;\n+\n@@ -61,2 +67,1 @@\n-    static Robot robot;\n-    static Slider slider;\n+\n@@ -65,13 +70,1 @@\n-    final int DRAG_DISTANCE = 10;\n-\n-    public static void main(String[] args) {\n-        initFX();\n-        try {\n-            SliderTooltipNPETest test = new SliderTooltipNPETest();\n-            test.testSliderTooltipNPE();\n-        } catch (Throwable e) {\n-            e.printStackTrace();\n-        } finally {\n-            exit();\n-        }\n-    }\n+    static final int DRAG_DISTANCE = 10;\n@@ -81,1 +74,5 @@\n-        dragSliderAfterTooltipDisplayed(DRAG_DISTANCE, true);\n+        dragSliderAfterTooltipDisplayed(DRAG_DISTANCE);\n+        if (exception != null) {\n+            exception.printStackTrace();\n+            throw exception;\n+        }\n@@ -84,1 +81,1 @@\n-    private void dragSliderAfterTooltipDisplayed(int dragDistance, boolean xIncr) throws Throwable {\n+    private void dragSliderAfterTooltipDisplayed(int dragDistance) throws Exception {\n@@ -88,2 +85,4 @@\n-            robot.mouseMove((int)(scene.getWindow().getX() + scene.getX() + SCENE_WIDTH\/2),\n-                (int)(scene.getWindow().getY() + scene.getY() + SCENE_HEIGHT\/2));\n+            robot.mouseMove((int)(scene.getWindow().getX() + scene.getX() +\n+                                slider.getLayoutX() + slider.getLayoutBounds().getWidth()\/2),\n+                            (int)(scene.getWindow().getY() + scene.getY() +\n+                                slider.getLayoutY() + slider.getLayoutBounds().getHeight()\/2));\n@@ -92,1 +91,2 @@\n-        Thread.sleep(3000); \/\/ Wait for tooltip to be displayed\n+        Util.waitForLatch(tooltipLatch, 5, \"Timeout waiting for tooltip to display\");\n+        Thread.sleep(2000); \/\/ Wait for tooltip to display\n@@ -101,7 +101,4 @@\n-                if (xIncr) {\n-                robot.mouseMove((int)(scene.getWindow().getX() + scene.getX() + SCENE_WIDTH\/2) + c,\n-                    (int)(scene.getWindow().getY() + scene.getY() + SCENE_HEIGHT\/2));\n-                } else {\n-                    robot.mouseMove((int)(scene.getWindow().getX() + scene.getX() + SCENE_WIDTH\/2),\n-                        (int)(scene.getWindow().getY() + scene.getY() + SCENE_HEIGHT\/2) + c);\n-                }\n+            robot.mouseMove((int)(scene.getWindow().getX() + scene.getX() +\n+                                slider.getLayoutX() + slider.getLayoutBounds().getWidth()\/2) + c,\n+                            (int)(scene.getWindow().getY() + scene.getY() +\n+                                slider.getLayoutY() + slider.getLayoutBounds().getHeight()\/2));\n@@ -114,4 +111,0 @@\n-\n-        if (exception != null) {\n-            throw exception;\n-        }\n@@ -121,0 +114,1 @@\n+\n@@ -125,1 +119,1 @@\n-            slider = new Slider(0, 100, 50);\n+\n@@ -128,0 +122,3 @@\n+            tooltip.setOnShown(event -> Platform.runLater(tooltipLatch::countDown));\n+\n+            slider = new Slider(0, 100, 50);\n@@ -129,0 +126,1 @@\n+\n@@ -132,2 +130,0 @@\n-            stage.addEventHandler(WindowEvent.WINDOW_SHOWN, e ->\n-                    Platform.runLater(startupLatch::countDown));\n@@ -135,0 +131,1 @@\n+            stage.setOnShown(event -> Platform.runLater(startupLatch::countDown));\n@@ -136,0 +133,1 @@\n+\n","filename":"tests\/system\/src\/test\/java\/test\/robot\/javafx\/scene\/SliderTooltipNPETest.java","additions":37,"deletions":39,"binary":false,"changes":76,"status":"modified"}]}