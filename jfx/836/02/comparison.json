{"files":[{"patch":"@@ -3072,0 +3072,2 @@\n+    private boolean recalculating = false;\n+\n@@ -3073,0 +3075,2 @@\n+        if (recalculating) return;\n+        recalculating = true;\n@@ -3076,1 +3080,0 @@\n-        double estSize = estimatedSize \/ itemCount;\n@@ -3096,1 +3099,1 @@\n-        estSize = estimatedSize \/ itemCount;\n+        double estSize = estimatedSize \/ itemCount;\n@@ -3110,1 +3113,1 @@\n-\n+        recalculating = false;\n","filename":"modules\/javafx.controls\/src\/main\/java\/javafx\/scene\/control\/skin\/VirtualFlow.java","additions":6,"deletions":3,"binary":false,"changes":9,"status":"modified"},{"patch":"@@ -3910,0 +3910,29 @@\n+    private List<TreeItem<String>> generateChildren(int lvl) {\n+        List<TreeItem<String>> children = new ArrayList<>();\n+        for (int idx = 0; idx < 10; idx++) {\n+            TreeItem<String> child = new TreeItem<>(\"Child lvl. \" + lvl + \" idx. \" + idx);\n+            child.setExpanded(true);\n+            if (lvl <= 2) {\n+                child.getChildren().addAll(generateChildren(lvl + 1));\n+            }\n+            children.add(child);\n+        }\n+        return children;\n+    }\n+\n+    \/\/ JDK-8290348\n+    @Test\n+    public void testCheckPositionAfterCollapsed() {\n+        TreeItem<String> rootNode = new TreeItem<>(\"Root\");\n+        rootNode.setExpanded(true);\n+        rootNode.getChildren().addAll(generateChildren(1));\n+        TreeView<String> treeView = new TreeView<>(rootNode);\n+        treeView.scrollTo(100);\n+        IndexedCell expandedCell = VirtualFlowTestUtils.getCell(treeView, 100);\n+        Toolkit.getToolkit().firePulse();\n+        rootNode.getChildren().get(1).setExpanded(false);\n+        Toolkit.getToolkit().firePulse();\n+        IndexedCell scrolledCell = VirtualFlowTestUtils.getCell(treeView, 100);\n+        assertTrue(scrolledCell.isVisible());\n+    }\n+\n","filename":"modules\/javafx.controls\/src\/test\/java\/test\/javafx\/scene\/control\/TreeViewTest.java","additions":29,"deletions":0,"binary":false,"changes":29,"status":"modified"}]}