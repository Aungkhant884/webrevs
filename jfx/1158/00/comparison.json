{"files":[{"patch":"@@ -1101,3 +1101,9 @@\n-\n-                    resources = ResourceBundle.getBundle(value, Locale.getDefault(),\n-                            FXMLLoader.this.resources.getClass().getClassLoader());\n+                    final ResourceBundle loaderResources = FXMLLoader.this.resources;\n+                    if (loaderResources == null) {\n+                        resources = ResourceBundle.getBundle(value, Locale.getDefault());\n+                    } else {\n+                        final ClassLoader cl = loaderResources.getClass().getClassLoader();\n+                        resources = cl == null ?\n+                                ResourceBundle.getBundle(value, Locale.getDefault()) :\n+                                ResourceBundle.getBundle(value, Locale.getDefault(), cl);\n+                    }\n","filename":"modules\/javafx.fxml\/src\/main\/java\/javafx\/fxml\/FXMLLoader.java","additions":9,"deletions":3,"binary":false,"changes":12,"status":"modified"},{"patch":"@@ -0,0 +1,79 @@\n+\/*\n+ * Copyright (c) 2010, 2023, Oracle and\/or its affiliates. All rights reserved.\n+ * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+ *\n+ * This code is free software; you can redistribute it and\/or modify it\n+ * under the terms of the GNU General Public License version 2 only, as\n+ * published by the Free Software Foundation.  Oracle designates this\n+ * particular file as subject to the \"Classpath\" exception as provided\n+ * by Oracle in the LICENSE file that accompanied this code.\n+ *\n+ * This code is distributed in the hope that it will be useful, but WITHOUT\n+ * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+ * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+ * version 2 for more details (a copy is included in the LICENSE file that\n+ * accompanied this code).\n+ *\n+ * You should have received a copy of the GNU General Public License version\n+ * 2 along with this work; if not, write to the Free Software Foundation,\n+ * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n+ *\n+ * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n+ * or visit www.oracle.com if you need additional information or have any\n+ * questions.\n+ *\/\n+\n+package test.javafx.fxml;\n+\n+import javafx.fxml.FXMLLoader;\n+import javafx.fxml.LoadException;\n+import org.junit.jupiter.api.Test;\n+\n+import java.io.IOException;\n+import java.util.MissingResourceException;\n+import java.util.ResourceBundle;\n+\n+import static org.junit.jupiter.api.Assertions.assertEquals;\n+import static org.junit.jupiter.api.Assertions.assertTrue;\n+import static org.junit.jupiter.api.Assertions.fail;\n+\n+class FXMLLoaderIncludeResourcesTest {\n+\n+    @Test\n+    void testIncludeNotFound() {\n+        final var loader = new FXMLLoader(getClass().getResource(\"fxmlloader_include_resource_test_not_found.fxml\"));\n+        try {\n+            loader.load();\n+            fail(\"Expected MissingResourceException\");\n+        } catch (final LoadException e) {\n+            assertTrue(e.getCause() instanceof MissingResourceException);\n+        } catch (final IOException e) {\n+            fail(\"Expected MissingResourceException\");\n+        }\n+    }\n+\n+    @Test\n+    void testIncludeRootNonNullResources() throws IOException {\n+        final var loader = new FXMLLoader(getClass().getResource(\"fxmlloader_include_resource_test.fxml\"));\n+        final var innerBundle = ResourceBundle.getBundle(\"test.javafx.fxml.fxmlloader_include_resource_test_inner\");\n+        loader.setResources(innerBundle);\n+        final Widget root = loader.load();\n+        final var inner = root.getChildren().get(0);\n+        assertEquals(innerBundle.getString(\"inner\"), inner.getName());\n+        final var child = inner.getChildren().get(0);\n+        final var nestedBundle = ResourceBundle.getBundle(\"test.javafx.fxml.fxmlloader_include_resource_test_nested\");\n+        assertEquals(nestedBundle.getString(\"nested\"), child.getName());\n+    }\n+\n+    @Test\n+    void testIncludeRootNullResources() throws IOException {\n+        final var loader = new FXMLLoader(getClass().getResource(\"fxmlloader_include_resource_test.fxml\"));\n+        final Widget root = loader.load();\n+        final var inner = root.getChildren().get(0);\n+        final var innerBundle = ResourceBundle.getBundle(\"test.javafx.fxml.fxmlloader_include_resource_test_inner\");\n+        assertEquals(innerBundle.getString(\"inner\"), inner.getName());\n+        final var child = inner.getChildren().get(0);\n+        final var nestedBundle = ResourceBundle.getBundle(\"test.javafx.fxml.fxmlloader_include_resource_test_nested\");\n+        assertEquals(nestedBundle.getString(\"nested\"), child.getName());\n+    }\n+}\n","filename":"modules\/javafx.fxml\/src\/test\/java\/test\/javafx\/fxml\/FXMLLoaderIncludeResourcesTest.java","additions":79,"deletions":0,"binary":false,"changes":79,"status":"added"},{"patch":"@@ -0,0 +1,30 @@\n+<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n+<!--\n+Copyright (c) 2010, 2023, Oracle and\/or its affiliates. All rights reserved.\n+DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+\n+This code is free software; you can redistribute it and\/or modify it\n+under the terms of the GNU General Public License version 2 only, as\n+published by the Free Software Foundation.  Oracle designates this\n+particular file as subject to the \"Classpath\" exception as provided\n+by Oracle in the LICENSE file that accompanied this code.\n+\n+This code is distributed in the hope that it will be useful, but WITHOUT\n+ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+version 2 for more details (a copy is included in the LICENSE file that\n+accompanied this code).\n+\n+You should have received a copy of the GNU General Public License version\n+2 along with this work; if not, write to the Free Software Foundation,\n+Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n+\n+Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n+or visit www.oracle.com if you need additional information or have any\n+questions.\n+-->\n+\n+<?import test.javafx.fxml.Widget?>\n+<Widget xmlns:fx=\"http:\/\/javafx.com\/fxml\">\n+    <fx:include source=\"fxmlloader_include_resource_test_inner.fxml\" resources=\"test\/javafx\/fxml\/fxmlloader_include_resource_test_inner\"\/>\n+<\/Widget>\n\\ No newline at end of file\n","filename":"modules\/javafx.fxml\/src\/test\/resources\/test\/javafx\/fxml\/fxmlloader_include_resource_test.fxml","additions":30,"deletions":0,"binary":false,"changes":30,"status":"added"},{"patch":"@@ -0,0 +1,30 @@\n+<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n+<!--\n+Copyright (c) 2010, 2023, Oracle and\/or its affiliates. All rights reserved.\n+DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+\n+This code is free software; you can redistribute it and\/or modify it\n+under the terms of the GNU General Public License version 2 only, as\n+published by the Free Software Foundation.  Oracle designates this\n+particular file as subject to the \"Classpath\" exception as provided\n+by Oracle in the LICENSE file that accompanied this code.\n+\n+This code is distributed in the hope that it will be useful, but WITHOUT\n+ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+version 2 for more details (a copy is included in the LICENSE file that\n+accompanied this code).\n+\n+You should have received a copy of the GNU General Public License version\n+2 along with this work; if not, write to the Free Software Foundation,\n+Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n+\n+Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n+or visit www.oracle.com if you need additional information or have any\n+questions.\n+-->\n+\n+<?import test.javafx.fxml.Widget?>\n+<Widget name=\"%inner\" xmlns:fx=\"http:\/\/javafx.com\/fxml\/1\" >\n+    <fx:include source=\"\/test\/javafx\/fxml\/fxmlloader_include_resource_test_nested.fxml\" resources=\"test\/javafx\/fxml\/fxmlloader_include_resource_test_nested\"\/>\n+<\/Widget>\n","filename":"modules\/javafx.fxml\/src\/test\/resources\/test\/javafx\/fxml\/fxmlloader_include_resource_test_inner.fxml","additions":30,"deletions":0,"binary":false,"changes":30,"status":"added"},{"patch":"@@ -0,0 +1,1 @@\n+inner=inner\n\\ No newline at end of file\n","filename":"modules\/javafx.fxml\/src\/test\/resources\/test\/javafx\/fxml\/fxmlloader_include_resource_test_inner.properties","additions":1,"deletions":0,"binary":false,"changes":1,"status":"added"},{"patch":"@@ -0,0 +1,28 @@\n+<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n+<!--\n+Copyright (c) 2010, 2023, Oracle and\/or its affiliates. All rights reserved.\n+DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+\n+This code is free software; you can redistribute it and\/or modify it\n+under the terms of the GNU General Public License version 2 only, as\n+published by the Free Software Foundation.  Oracle designates this\n+particular file as subject to the \"Classpath\" exception as provided\n+by Oracle in the LICENSE file that accompanied this code.\n+\n+This code is distributed in the hope that it will be useful, but WITHOUT\n+ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+version 2 for more details (a copy is included in the LICENSE file that\n+accompanied this code).\n+\n+You should have received a copy of the GNU General Public License version\n+2 along with this work; if not, write to the Free Software Foundation,\n+Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n+\n+Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n+or visit www.oracle.com if you need additional information or have any\n+questions.\n+-->\n+\n+<?import test.javafx.fxml.Widget?>\n+<Widget name=\"%nested\" xmlns:fx=\"http:\/\/javafx.com\/fxml\" \/>\n","filename":"modules\/javafx.fxml\/src\/test\/resources\/test\/javafx\/fxml\/fxmlloader_include_resource_test_nested.fxml","additions":28,"deletions":0,"binary":false,"changes":28,"status":"added"},{"patch":"@@ -0,0 +1,1 @@\n+nested=nested\n\\ No newline at end of file\n","filename":"modules\/javafx.fxml\/src\/test\/resources\/test\/javafx\/fxml\/fxmlloader_include_resource_test_nested.properties","additions":1,"deletions":0,"binary":false,"changes":1,"status":"added"},{"patch":"@@ -0,0 +1,30 @@\n+<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n+<!--\n+Copyright (c) 2010, 2023, Oracle and\/or its affiliates. All rights reserved.\n+DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+\n+This code is free software; you can redistribute it and\/or modify it\n+under the terms of the GNU General Public License version 2 only, as\n+published by the Free Software Foundation.  Oracle designates this\n+particular file as subject to the \"Classpath\" exception as provided\n+by Oracle in the LICENSE file that accompanied this code.\n+\n+This code is distributed in the hope that it will be useful, but WITHOUT\n+ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+version 2 for more details (a copy is included in the LICENSE file that\n+accompanied this code).\n+\n+You should have received a copy of the GNU General Public License version\n+2 along with this work; if not, write to the Free Software Foundation,\n+Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n+\n+Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n+or visit www.oracle.com if you need additional information or have any\n+questions.\n+-->\n+\n+<?import test.javafx.fxml.Widget?>\n+<Widget xmlns:fx=\"http:\/\/javafx.com\/fxml\">\n+    <fx:include source=\"fxmlloader_include_resource_test_inner.fxml\" resources=\"fxmlloader_include_resource_test_not_found\"\/>\n+<\/Widget>\n\\ No newline at end of file\n","filename":"modules\/javafx.fxml\/src\/test\/resources\/test\/javafx\/fxml\/fxmlloader_include_resource_test_not_found.fxml","additions":30,"deletions":0,"binary":false,"changes":30,"status":"added"}]}