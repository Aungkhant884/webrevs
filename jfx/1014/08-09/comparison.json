{"files":[{"patch":"@@ -38,0 +38,1 @@\n+import java.util.Arrays;\n@@ -40,0 +41,1 @@\n+import java.util.Set;\n@@ -83,1 +85,1 @@\n-        textArea.setText(\"preferences = \" + formatPrefs(cachedPreferences.entrySet().stream()));\n+        textArea.setText(\"preferences = \" + formatPrefs(cachedPreferences.entrySet()));\n@@ -87,2 +89,3 @@\n-                Stream<Map.Entry<String, Object>> changed = Platform.getPreferences().entrySet().stream()\n-                        .filter(entry -> !Objects.equals(entry.getValue(), cachedPreferences.get(entry.getKey())));\n+                Set<Map.Entry<String, Object>> changed = Platform.getPreferences().entrySet().stream()\n+                        .filter(entry -> !Objects.equals(entry.getValue(), cachedPreferences.get(entry.getKey())))\n+                        .collect(Collectors.toSet());\n@@ -90,3 +93,4 @@\n-                double scrollTop = textArea.getScrollTop();\n-                textArea.setText(textArea.getText() + \"changed = \" + formatPrefs(changed));\n-                textArea.setScrollTop(scrollTop);\n+                if (changed.size() > 0) {\n+                    double scrollTop = textArea.getScrollTop();\n+                    textArea.setText(textArea.getText() + \"changed = \" + formatPrefs(changed));\n+                    textArea.setScrollTop(scrollTop);\n@@ -94,1 +98,2 @@\n-                cachedPreferences = new HashMap<>(Platform.getPreferences());\n+                    cachedPreferences = new HashMap<>(Platform.getPreferences());\n+                }\n@@ -105,2 +110,2 @@\n-    private static String formatPrefs(Stream<Map.Entry<String, Object>> prefs) {\n-        String entries = prefs\n+    private static String formatPrefs(Set<Map.Entry<String, Object>> prefs) {\n+        String entries = prefs.stream()\n@@ -108,1 +113,6 @@\n-                .map(Object::toString)\n+                .map(entry -> {\n+                    if (entry.getValue() instanceof Object[] array) {\n+                        return entry.getKey() + \"=\" + Arrays.toString(array);\n+                    }\n+                    return entry.getKey() + \"=\" + entry.getValue();\n+                })\n","filename":"tests\/manual\/events\/PlatformPreferencesTest.java","additions":20,"deletions":10,"binary":false,"changes":30,"status":"modified"}]}