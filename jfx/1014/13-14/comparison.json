{"files":[{"patch":"@@ -198,2 +198,0 @@\n-\n-        \/\/ The given preference map may contain null values, which indicates that a mapping was removed.\n@@ -201,1 +199,0 @@\n-        effectivePreferences.entrySet().removeIf(entry -> entry.getValue() == null);\n@@ -207,0 +204,3 @@\n+        \/\/ The new mappings may contain null values, which indicates that a mapping was removed.\n+        effectivePreferences.entrySet().removeIf(entry -> entry.getValue() == null);\n+\n","filename":"modules\/javafx.graphics\/src\/main\/java\/com\/sun\/javafx\/application\/preferences\/PlatformPreferences.java","additions":3,"deletions":3,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -34,0 +34,1 @@\n+import java.util.HashMap;\n@@ -123,0 +124,19 @@\n+    @Test\n+    void testUpdatePreferencesWithNullValueRemovesMapping() {\n+        var content = Map.of(\n+            \"red\", Color.RED,\n+            \"blue\", Color.BLUE,\n+            \"str\", \"foo\",\n+            \"bool\", true);\n+        prefs.update(content);\n+        assertEquals(content, prefs);\n+\n+        prefs.update(new HashMap<>() {{ put(\"red\", null); }});\n+        assertEquals(\n+            Map.of(\n+                \"blue\", Color.BLUE,\n+                \"str\", \"foo\",\n+                \"bool\", true),\n+            prefs);\n+    }\n+\n@@ -146,0 +166,1 @@\n+        assertEquals(2, observer.getCallsNumber());\n@@ -152,0 +173,1 @@\n+        assertEquals(1, observer.getCallsNumber());\n@@ -158,0 +180,1 @@\n+        assertEquals(1, observer.getCallsNumber());\n@@ -166,0 +189,6 @@\n+\n+        \/\/ If a key is mapped to null, the mapping is removed\n+        prefs.update(new HashMap<>() {{ put(\"foo\", null); }});\n+        assertEquals(1, observer.getCallsNumber());\n+        observer.assertRemoved(0, tup(\"foo\", \"bar2\"));\n+        observer.clear();\n","filename":"modules\/javafx.graphics\/src\/test\/java\/test\/com\/sun\/javafx\/application\/preferences\/PlatformPreferencesTest.java","additions":29,"deletions":0,"binary":false,"changes":29,"status":"modified"}]}