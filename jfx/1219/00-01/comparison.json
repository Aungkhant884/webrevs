{"files":[{"patch":"@@ -92,0 +92,4 @@\n+    public static void removeRecord(DisposerRecord rec) {\n+        disposerInstance.records.remove(rec);\n+    }\n+\n","filename":"modules\/javafx.swing\/src\/main\/java\/com\/sun\/javafx\/embed\/swing\/Disposer.java","additions":4,"deletions":0,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -167,2 +167,3 @@\n-    public DisposerRecord createSwingNodeDisposer(WeakReference<LightweightFrameWrapper> frame) {\n-        return new SwingNodeDisposer(frame);\n+    public DisposerRecord createSwingNodeDisposer(Object frame) {\n+        LightweightFrameWrapper lwFrame = (LightweightFrameWrapper)frame;\n+        return new SwingNodeDisposer(lwFrame);\n@@ -235,1 +236,1 @@\n-        WeakReference<LightweightFrameWrapper> lwFrame;\n+        LightweightFrameWrapper lwFrame;\n@@ -237,1 +238,1 @@\n-        SwingNodeDisposer(WeakReference<LightweightFrameWrapper> ref) {\n+        SwingNodeDisposer(LightweightFrameWrapper ref) {\n@@ -243,4 +244,3 @@\n-            LightweightFrameWrapper lwFramePtr = lwFrame.get();\n-            if (lwFramePtr != null) {\n-                lwFramePtr.dispose();\n-                lwFramePtr = null;\n+            if (lwFrame != null) {\n+                lwFrame.dispose();\n+                lwFrame = null;\n@@ -249,0 +249,1 @@\n+\n","filename":"modules\/javafx.swing\/src\/main\/java\/com\/sun\/javafx\/embed\/swing\/newimpl\/SwingNodeInteropN.java","additions":9,"deletions":8,"binary":false,"changes":17,"status":"modified"},{"patch":"@@ -73,0 +73,1 @@\n+import com.sun.javafx.embed.swing.DisposerRecord;\n@@ -255,0 +256,1 @@\n+    private DisposerRecord rec;\n@@ -365,1 +367,3 @@\n-            swNodeIOP.disposeFrame(lwFrame);\n+            rec.dispose();\n+            Disposer.removeRecord(rec);\n+            rec = null;\n@@ -385,4 +389,2 @@\n-            WeakReference<LightweightFrameWrapper> lwFramePtr =\n-                    new WeakReference<LightweightFrameWrapper>(\n-                                             (LightweightFrameWrapper)lwFrame);\n-            Disposer.addRecord(this, swNodeIOP.createSwingNodeDisposer(lwFramePtr));\n+            rec = swNodeIOP.createSwingNodeDisposer(lwFrame);\n+            Disposer.addRecord(this, rec);\n","filename":"modules\/javafx.swing\/src\/main\/java\/javafx\/embed\/swing\/SwingNode.java","additions":7,"deletions":5,"binary":false,"changes":12,"status":"modified"}]}