{"files":[{"patch":"@@ -2395,0 +2395,4 @@\n+                    if (inits.isReset()) {\n+                        inits.assign(initsWhenTrue);\n+                        uninits.assign(uninitsWhenTrue);\n+                    }\n","filename":"src\/jdk.compiler\/share\/classes\/com\/sun\/tools\/javac\/comp\/Flow.java","additions":4,"deletions":0,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2017, 2019, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2017, 2021, Oracle and\/or its affiliates. All rights reserved.\n@@ -26,1 +26,1 @@\n- * @bug 8262891\n+ * @bug 8262891 8268663\n@@ -46,0 +46,3 @@\n+        runIfTrue(this::typeGuardIfTrueIfStatement);\n+        runIfTrue(this::typeGuardIfTrueSwitchExpression);\n+        runIfTrue(this::typeGuardIfTrueSwitchStatement);\n@@ -55,0 +58,6 @@\n+    void runIfTrue(Function<Object, String> convert) {\n+        assertEquals(\"true\", convert.apply(0));\n+        assertEquals(\"second\", convert.apply(2));\n+        assertEquals(\"any\", convert.apply(\"\"));\n+    }\n+\n@@ -87,0 +96,29 @@\n+    String typeGuardIfTrueSwitchStatement(Object o) {\n+        Object o2 = \"\";\n+        switch (o) {\n+            case Integer i && i == 0 && i < 1 && o2 instanceof String s: o = s + String.valueOf(i); return \"true\";\n+            case Integer i && i == 0 || i > 1: o = String.valueOf(i); return \"second\";\n+            case Object x: return \"any\";\n+        }\n+    }\n+\n+    String typeGuardIfTrueSwitchExpression(Object o) {\n+        Object o2 = \"\";\n+        return switch (o) {\n+            case Integer i && i == 0 && i < 1 && o2 instanceof String s: o = s + String.valueOf(i); yield \"true\";\n+            case Integer i && i == 0 || i > 1: o = String.valueOf(i); yield \"second\";\n+            case Object x: yield \"any\";\n+        };\n+    }\n+\n+    String typeGuardIfTrueIfStatement(Object o) {\n+        Object o2 = \"\";\n+        if (o != null && o instanceof (Integer i && i == 0 && i < 1) && (o = i) != null && o2 instanceof String s) {\n+            return s != null ? \"true\" : null;\n+        } else if (o != null && o instanceof (Integer i && i == 0 || i > 1) && (o = i) != null) {\n+            return \"second\";\n+        } else {\n+            return \"any\";\n+        }\n+    }\n+\n","filename":"test\/langtools\/tools\/javac\/patterns\/Guards.java","additions":40,"deletions":2,"binary":false,"changes":42,"status":"modified"},{"patch":"@@ -193,0 +193,12 @@\n+    Object guardWithMatchingStatement(Object o1, Object o2) {\n+        switch (o1) {\n+            case String s && s.isEmpty() || o2 instanceof Number n: return n;\n+            default: return null;\n+        }\n+    }\n+    Object guardWithMatchingExpression(Object o1, Object o2) {\n+        return switch (o1) {\n+            case String s && s.isEmpty() || o2 instanceof Number n -> n;\n+            default -> null;\n+        };\n+    }\n","filename":"test\/langtools\/tools\/javac\/patterns\/SwitchErrors.java","additions":12,"deletions":0,"binary":false,"changes":12,"status":"modified"},{"patch":"@@ -31,0 +31,2 @@\n+SwitchErrors.java:195:76: compiler.err.cant.resolve.location: kindname.variable, n, , , (compiler.misc.location: kindname.class, SwitchErrors, null)\n+SwitchErrors.java:201:71: compiler.err.cant.resolve.location: kindname.variable, n, , , (compiler.misc.location: kindname.class, SwitchErrors, null)\n@@ -44,1 +46,1 @@\n-41 errors\n+43 errors\n","filename":"test\/langtools\/tools\/javac\/patterns\/SwitchErrors.out","additions":3,"deletions":1,"binary":false,"changes":4,"status":"modified"}]}