{"files":[{"patch":"@@ -563,1 +563,0 @@\n-    @SuppressWarnings(\"removal\")\n@@ -631,4 +630,4 @@\n-            String factoryClassName = StaticProperty.jdkSerialFilterFactory();\n-            if (factoryClassName == null) {\n-                \/\/ Fallback to security property\n-                factoryClassName = AccessController.doPrivileged((PrivilegedAction<String>) () ->\n+            @SuppressWarnings(\"removal\")\n+            String factoryClassName = StaticProperty.jdkSerialFilterFactory() != null\n+                    ? StaticProperty.jdkSerialFilterFactory()\n+                    : AccessController.doPrivileged((PrivilegedAction<String>) () ->\n@@ -636,1 +635,0 @@\n-            }\n@@ -638,4 +636,4 @@\n-            String filterString = StaticProperty.jdkSerialFilter();\n-            if (filterString == null) {\n-                \/\/ Fallback to security property\n-                filterString = AccessController.doPrivileged((PrivilegedAction<String>) () ->\n+            @SuppressWarnings(\"removal\")\n+            String filterString = StaticProperty.jdkSerialFilter() != null\n+                    ? StaticProperty.jdkSerialFilter()\n+                    : AccessController.doPrivileged((PrivilegedAction<String>) () ->\n@@ -643,1 +641,0 @@\n-            }\n@@ -746,0 +743,1 @@\n+            @SuppressWarnings(\"removal\")\n@@ -839,0 +837,1 @@\n+            @SuppressWarnings(\"removal\")\n","filename":"src\/java.base\/share\/classes\/java\/io\/ObjectInputFilter.java","additions":10,"deletions":11,"binary":false,"changes":21,"status":"modified"},{"patch":"@@ -75,1 +75,0 @@\n-@SuppressWarnings(\"removal\")\n@@ -227,2 +226,0 @@\n-        InputStream stream = null;\n-\n@@ -231,9 +228,7 @@\n-            if (System.getSecurityManager() != null) {\n-                stream = AccessController.doPrivileged(new PrivilegedAction<>() {\n-                    public InputStream run() {\n-                        return StringPrep.class.getResourceAsStream(IDN_PROFILE);\n-                    }\n-                });\n-            } else {\n-                stream = StringPrep.class.getResourceAsStream(IDN_PROFILE);\n-            }\n+            @SuppressWarnings(\"removal\")\n+            InputStream stream = System.getSecurityManager() != null\n+                    ? AccessController.doPrivileged(new PrivilegedAction<>() {\n+                            public InputStream run() {\n+                                return StringPrep.class.getResourceAsStream(IDN_PROFILE);\n+                            }})\n+                    : StringPrep.class.getResourceAsStream(IDN_PROFILE);\n","filename":"src\/java.base\/share\/classes\/java\/net\/IDN.java","additions":7,"deletions":12,"binary":false,"changes":19,"status":"modified"},{"patch":"@@ -205,1 +205,0 @@\n-@SuppressWarnings(\"removal\")\n@@ -294,2 +293,4 @@\n-        CONF_PATH = Path.of(AccessController.doPrivileged((PrivilegedAction<String>)\n-                () -> System.getProperty(\"java.home\")), \"conf\", \"chronology\");\n+        @SuppressWarnings(\"removal\")\n+        String javaHome = AccessController.doPrivileged((PrivilegedAction<String>)\n+                        () -> System.getProperty(\"java.home\"));\n+        CONF_PATH = Path.of(javaHome, \"conf\", \"chronology\");\n@@ -850,1 +851,1 @@\n-        try (InputStream is = AccessController.doPrivileged(getResourceAction, null, perm1, perm2)) {\n+        try (@SuppressWarnings(\"removal\") InputStream is = AccessController.doPrivileged(getResourceAction, null, perm1, perm2)) {\n@@ -1045,0 +1046,1 @@\n+    @SuppressWarnings(\"removal\")\n","filename":"src\/java.base\/share\/classes\/java\/time\/chrono\/HijrahChronology.java","additions":6,"deletions":4,"binary":false,"changes":10,"status":"modified"},{"patch":"@@ -130,1 +130,0 @@\n-@SuppressWarnings(\"removal\")\n@@ -150,13 +149,20 @@\n-        final List<ZoneRulesProvider> loaded = new ArrayList<>();\n-        AccessController.doPrivileged(new PrivilegedAction<>() {\n-            public Object run() {\n-                String prop = System.getProperty(\"java.time.zone.DefaultZoneRulesProvider\");\n-                if (prop != null) {\n-                    try {\n-                        Class<?> c = Class.forName(prop, true, ClassLoader.getSystemClassLoader());\n-                        @SuppressWarnings(\"deprecation\")\n-                        ZoneRulesProvider provider = ZoneRulesProvider.class.cast(c.newInstance());\n-                        registerProvider(provider);\n-                        loaded.add(provider);\n-                    } catch (Exception x) {\n-                        throw new Error(x);\n+        @SuppressWarnings(\"removal\")\n+        final List<ZoneRulesProvider> loaded =\n+                AccessController.doPrivileged(new PrivilegedAction<List<ZoneRulesProvider>>() {\n+                    public List<ZoneRulesProvider> run() {\n+                        List<ZoneRulesProvider> result = new ArrayList<>();\n+                        String prop = System.getProperty(\"java.time.zone.DefaultZoneRulesProvider\");\n+                        if (prop != null) {\n+                            try {\n+                                Class<?> c = Class.forName(prop, true, ClassLoader.getSystemClassLoader());\n+                                @SuppressWarnings(\"deprecation\")\n+                                ZoneRulesProvider provider = ZoneRulesProvider.class.cast(c.newInstance());\n+                                registerProvider(provider);\n+                                result.add(provider);\n+                            } catch (Exception x) {\n+                                throw new Error(x);\n+                            }\n+                        } else {\n+                            registerProvider(new TzdbZoneRulesProvider());\n+                        }\n+                        return result;\n@@ -164,6 +170,1 @@\n-                } else {\n-                    registerProvider(new TzdbZoneRulesProvider());\n-                }\n-                return null;\n-            }\n-        });\n+                });\n","filename":"src\/java.base\/share\/classes\/java\/time\/zone\/ZoneRulesProvider.java","additions":21,"deletions":20,"binary":false,"changes":41,"status":"modified"},{"patch":"@@ -114,1 +114,0 @@\n-@SuppressWarnings(\"removal\")\n@@ -213,0 +212,5 @@\n+        initStatic();\n+    }\n+\n+    @SuppressWarnings(\"removal\")\n+    private static void initStatic() {\n","filename":"src\/java.base\/share\/classes\/java\/util\/Currency.java","additions":5,"deletions":1,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -50,1 +50,1 @@\n-@SuppressWarnings({\"removal\",\"serial\"})\n+@SuppressWarnings(\"serial\")\n@@ -385,2 +385,2 @@\n-            MethodHandles.Lookup l = MethodHandles.lookup();\n-            BASE = l.findVarHandle(Striped64.class,\n+            MethodHandles.Lookup l1 = MethodHandles.lookup();\n+            BASE = l1.findVarHandle(Striped64.class,\n@@ -388,1 +388,1 @@\n-            CELLSBUSY = l.findVarHandle(Striped64.class,\n+            CELLSBUSY = l1.findVarHandle(Striped64.class,\n@@ -390,1 +390,2 @@\n-            l = java.security.AccessController.doPrivileged(\n+            @SuppressWarnings(\"removal\")\n+            MethodHandles.Lookup l2 = java.security.AccessController.doPrivileged(\n@@ -399,1 +400,1 @@\n-            THREAD_PROBE = l.findVarHandle(Thread.class,\n+            THREAD_PROBE = l2.findVarHandle(Thread.class,\n","filename":"src\/java.base\/share\/classes\/java\/util\/concurrent\/atomic\/Striped64.java","additions":7,"deletions":6,"binary":false,"changes":13,"status":"modified"},{"patch":"@@ -36,1 +36,0 @@\n-@SuppressWarnings(\"removal\")\n@@ -47,3 +46,2 @@\n-    private static String tempFileTemplate;\n-\n-    static {\n+    @SuppressWarnings(\"removal\")\n+    private static String tempFileTemplate =\n@@ -51,18 +49,6 @@\n-            new java.security.PrivilegedAction<Void>() {\n-                public Void run() {\n-                tempFileTemplate =\n-                    System.getProperty(\"content.types.temp.file.template\",\n-                                       \"\/tmp\/%s\");\n-\n-                mailcapLocations = new String[] {\n-                    System.getProperty(\"user.mailcap\"),\n-                    StaticProperty.userHome() + \"\/.mailcap\",\n-                    \"\/etc\/mailcap\",\n-                    \"\/usr\/etc\/mailcap\",\n-                    \"\/usr\/local\/etc\/mailcap\",\n-                };\n-                return null;\n-            }\n-        });\n-    }\n-\n+                new java.security.PrivilegedAction<String>() {\n+                    public String run() {\n+                        return System.getProperty(\"content.types.temp.file.template\",\n+                                \"\/tmp\/%s\");\n+                    }\n+                });\n@@ -80,0 +66,1 @@\n+        @SuppressWarnings(\"removal\")\n@@ -223,1 +210,14 @@\n-    protected static String[] mailcapLocations;\n+    @SuppressWarnings(\"removal\")\n+    protected static String[] mailcapLocations =\n+        java.security.AccessController.doPrivileged(\n+                new java.security.PrivilegedAction<String[]>() {\n+                    public String[] run() {\n+                        return new String[]{\n+                                System.getProperty(\"user.mailcap\"),\n+                                StaticProperty.userHome() + \"\/.mailcap\",\n+                                \"\/etc\/mailcap\",\n+                                \"\/usr\/etc\/mailcap\",\n+                                \"\/usr\/local\/etc\/mailcap\",\n+                        };\n+                    }\n+                });\n@@ -391,0 +391,1 @@\n+            @SuppressWarnings(\"removal\")\n","filename":"src\/java.base\/share\/classes\/sun\/net\/www\/MimeTable.java","additions":24,"deletions":23,"binary":false,"changes":47,"status":"modified"},{"patch":"@@ -56,1 +56,0 @@\n-@SuppressWarnings(\"removal\")\n@@ -73,3 +72,2 @@\n-    static final boolean serializeAuth;\n-    static {\n-        serializeAuth = java.security.AccessController.doPrivileged(\n+    @SuppressWarnings(\"removal\")\n+    static final boolean serializeAuth = java.security.AccessController.doPrivileged(\n@@ -78,1 +76,0 @@\n-    }\n","filename":"src\/java.base\/share\/classes\/sun\/net\/www\/protocol\/http\/AuthenticationInfo.java","additions":2,"deletions":5,"binary":false,"changes":7,"status":"modified"},{"patch":"@@ -60,1 +60,0 @@\n-@SuppressWarnings(\"removal\")\n@@ -252,0 +251,5 @@\n+        loadTZDB();\n+    }\n+\n+    @SuppressWarnings(\"removal\")\n+    private static void loadTZDB() {\n","filename":"src\/java.base\/share\/classes\/sun\/util\/calendar\/ZoneInfoFile.java","additions":5,"deletions":1,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -477,0 +477,1 @@\n+        @SuppressWarnings(\"removal\")\n@@ -601,0 +602,1 @@\n+        @SuppressWarnings(\"removal\")\n@@ -888,0 +890,1 @@\n+    @SuppressWarnings(\"removal\")\n@@ -923,0 +926,1 @@\n+            @SuppressWarnings(\"removal\")\n@@ -1015,0 +1019,5 @@\n+        loadNativeLib();\n+    }\n+\n+    @SuppressWarnings(\"removal\")\n+    private static void loadNativeLib() {\n","filename":"src\/java.management\/share\/classes\/java\/lang\/management\/ManagementFactory.java","additions":9,"deletions":0,"binary":false,"changes":9,"status":"modified"},{"patch":"@@ -84,1 +84,1 @@\n-@SuppressWarnings({\"removal\",\"serial\"})  \/\/ serialVersionUID not constant\n+@SuppressWarnings(\"serial\")  \/\/ serialVersionUID not constant\n@@ -122,10 +122,2 @@\n-        String form = null;\n-        boolean compat = false;\n-        try {\n-            GetPropertyAction act = new GetPropertyAction(\"jmx.serial.form\");\n-            form = AccessController.doPrivileged(act);\n-            compat = \"1.0\".equals(form);  \/\/ form may be null\n-        } catch (Exception e) {\n-            \/\/ OK: No compat with 1.0\n-        }\n-        serialForm = form;\n+        serialForm = getForm();\n+        boolean compat = \"1.0\".equals(serialForm);  \/\/ serialForm may be null\n@@ -140,0 +132,13 @@\n+\n+    @SuppressWarnings(\"removal\")\n+    private static String getForm() {\n+        String form = null;\n+        try {\n+            GetPropertyAction act = new GetPropertyAction(\"jmx.serial.form\");\n+            return  AccessController.doPrivileged(act);\n+        } catch (Exception e) {\n+            \/\/ OK: No compat with 1.0\n+            return null;\n+        }\n+    }\n+\n","filename":"src\/java.management\/share\/classes\/javax\/management\/modelmbean\/DescriptorSupport.java","additions":16,"deletions":11,"binary":false,"changes":27,"status":"modified"},{"patch":"@@ -58,1 +58,0 @@\n-@SuppressWarnings(\"removal\")\n@@ -167,12 +166,1 @@\n-            \/\/ Create cleaner to expire idle connections\n-            PrivilegedAction<Void> pa = new PrivilegedAction<Void>() {\n-                public Void run() {\n-                    Thread t = InnocuousThread.newSystemThread(\n-                            \"LDAP PoolCleaner\",\n-                            new PoolCleaner(idleTimeout, pools));\n-                    assert t.getContextClassLoader() == null;\n-                    t.setDaemon(true);\n-                    t.start();\n-                    return null;\n-                }};\n-            AccessController.doPrivileged(pa);\n+            startCleanerThread();\n@@ -186,0 +174,16 @@\n+    @SuppressWarnings(\"removal\")\n+    private static void startCleanerThread() {\n+        \/\/ Create cleaner to expire idle connections\n+        PrivilegedAction<Void> pa = new PrivilegedAction<Void>() {\n+            public Void run() {\n+                Thread t = InnocuousThread.newSystemThread(\n+                        \"LDAP PoolCleaner\",\n+                        new PoolCleaner(idleTimeout, pools));\n+                assert t.getContextClassLoader() == null;\n+                t.setDaemon(true);\n+                t.start();\n+                return null;\n+            }};\n+        AccessController.doPrivileged(pa);\n+    }\n+\n@@ -399,0 +403,1 @@\n+    @SuppressWarnings(\"removal\")\n@@ -404,0 +409,1 @@\n+    @SuppressWarnings(\"removal\")\n@@ -409,0 +415,1 @@\n+    @SuppressWarnings(\"removal\")\n","filename":"src\/java.naming\/share\/classes\/com\/sun\/jndi\/ldap\/LdapPoolManager.java","additions":20,"deletions":13,"binary":false,"changes":33,"status":"modified"},{"patch":"@@ -79,1 +79,0 @@\n-@SuppressWarnings(\"removal\")\n@@ -83,0 +82,5 @@\n+        loadPrefsLib();\n+    }\n+\n+    @SuppressWarnings(\"removal\")\n+    private static void loadPrefsLib() {\n","filename":"src\/java.prefs\/macosx\/classes\/java\/util\/prefs\/MacOSXPreferencesFile.java","additions":5,"deletions":1,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -49,1 +49,0 @@\n-@SuppressWarnings(\"removal\")\n@@ -53,0 +52,5 @@\n+        loadPrefsLib();\n+    }\n+\n+    @SuppressWarnings(\"removal\")\n+    private static void loadPrefsLib() {\n@@ -63,0 +67,1 @@\n+    @SuppressWarnings(\"removal\")\n@@ -114,0 +119,1 @@\n+    @SuppressWarnings(\"removal\")\n@@ -181,0 +187,1 @@\n+    @SuppressWarnings(\"removal\")\n@@ -448,0 +455,5 @@\n+        addShutdownHook();\n+    }\n+\n+    @SuppressWarnings(\"removal\")\n+    private static void addShutdownHook() {\n@@ -516,0 +528,1 @@\n+    @SuppressWarnings(\"removal\")\n@@ -585,0 +598,1 @@\n+    @SuppressWarnings(\"removal\")\n@@ -632,0 +646,1 @@\n+    @SuppressWarnings(\"removal\")\n@@ -665,0 +680,1 @@\n+    @SuppressWarnings(\"removal\")\n@@ -703,0 +719,1 @@\n+    @SuppressWarnings(\"removal\")\n@@ -737,0 +754,1 @@\n+    @SuppressWarnings(\"removal\")\n@@ -786,0 +804,1 @@\n+    @SuppressWarnings(\"removal\")\n","filename":"src\/java.prefs\/unix\/classes\/java\/util\/prefs\/FileSystemPreferences.java","additions":20,"deletions":1,"binary":false,"changes":21,"status":"modified"},{"patch":"@@ -47,1 +47,0 @@\n-@SuppressWarnings(\"removal\")\n@@ -51,0 +50,5 @@\n+        loadPrefsLib();\n+    }\n+\n+    @SuppressWarnings(\"removal\")\n+    private static void loadPrefsLib() {\n","filename":"src\/java.prefs\/windows\/classes\/java\/util\/prefs\/WindowsPreferences.java","additions":5,"deletions":1,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -85,1 +85,0 @@\n-@SuppressWarnings(\"removal\")\n@@ -95,0 +94,1 @@\n+    @SuppressWarnings(\"removal\")\n@@ -100,0 +100,1 @@\n+    @SuppressWarnings(\"removal\")\n@@ -105,0 +106,1 @@\n+    @SuppressWarnings(\"removal\")\n@@ -125,2 +127,5 @@\n-    private static final AccessControlContext SOCKET_ACC;\n-    static {\n+    @SuppressWarnings(\"removal\")\n+    private static final AccessControlContext SOCKET_ACC = createSocketAcc();\n+\n+    @SuppressWarnings(\"removal\")\n+    private static AccessControlContext createSocketAcc() {\n@@ -130,1 +135,1 @@\n-        SOCKET_ACC = new AccessControlContext(pd);\n+        return new AccessControlContext(pd);\n@@ -254,0 +259,1 @@\n+        @SuppressWarnings(\"removal\")\n@@ -493,0 +499,1 @@\n+        @SuppressWarnings(\"removal\")\n@@ -518,0 +525,1 @@\n+            @SuppressWarnings(\"removal\")\n","filename":"src\/java.rmi\/share\/classes\/sun\/rmi\/transport\/DGCClient.java","additions":12,"deletions":4,"binary":false,"changes":16,"status":"modified"},{"patch":"@@ -67,1 +67,1 @@\n-@SuppressWarnings({\"removal\",\"deprecation\"})\n+@SuppressWarnings(\"deprecation\")\n@@ -71,0 +71,1 @@\n+    @SuppressWarnings(\"removal\")\n@@ -76,0 +77,1 @@\n+    @SuppressWarnings(\"removal\")\n@@ -81,0 +83,1 @@\n+    @SuppressWarnings(\"removal\")\n@@ -86,0 +89,1 @@\n+    @SuppressWarnings(\"removal\")\n@@ -123,0 +127,1 @@\n+    @SuppressWarnings(\"removal\")\n@@ -318,0 +323,5 @@\n+        exportSingleton();\n+    }\n+\n+    @SuppressWarnings(\"removal\")\n+    private static void exportSingleton() {\n","filename":"src\/java.rmi\/share\/classes\/sun\/rmi\/transport\/DGCImpl.java","additions":11,"deletions":1,"binary":false,"changes":12,"status":"modified"},{"patch":"@@ -86,1 +86,1 @@\n-@SuppressWarnings({\"removal\",\"deprecation\"})\n+@SuppressWarnings(\"deprecation\")\n@@ -90,0 +90,1 @@\n+    @SuppressWarnings(\"removal\")\n@@ -95,0 +96,1 @@\n+    @SuppressWarnings(\"removal\")\n@@ -101,0 +103,1 @@\n+    @SuppressWarnings(\"removal\")\n@@ -111,0 +114,1 @@\n+                @SuppressWarnings(\"removal\")\n@@ -125,2 +129,5 @@\n-    private static final AccessControlContext NOPERMS_ACC;\n-    static {\n+    @SuppressWarnings(\"removal\")\n+    private static final AccessControlContext NOPERMS_ACC = createNopermsAcc();\n+\n+    @SuppressWarnings(\"removal\")\n+    private static AccessControlContext createNopermsAcc() {\n@@ -129,1 +136,1 @@\n-        NOPERMS_ACC = new AccessControlContext(pd);\n+        return new AccessControlContext(pd);\n@@ -151,0 +158,1 @@\n+    @SuppressWarnings(\"removal\")\n@@ -301,1 +309,2 @@\n-    protected void checkAcceptPermission(AccessControlContext acc) {\n+    protected void checkAcceptPermission(@SuppressWarnings(\"removal\") AccessControlContext acc) {\n+        @SuppressWarnings(\"removal\")\n@@ -341,0 +350,1 @@\n+                @SuppressWarnings(\"removal\")\n@@ -353,0 +363,1 @@\n+            @SuppressWarnings(\"removal\")\n@@ -649,0 +660,1 @@\n+        @SuppressWarnings(\"removal\")\n@@ -651,0 +663,1 @@\n+        @SuppressWarnings(\"removal\")\n@@ -654,0 +667,1 @@\n+        @SuppressWarnings(\"removal\")\n@@ -672,0 +686,1 @@\n+        @SuppressWarnings(\"removal\")\n@@ -697,0 +712,1 @@\n+        @SuppressWarnings(\"removal\")\n","filename":"src\/java.rmi\/share\/classes\/sun\/rmi\/transport\/tcp\/TCPTransport.java","additions":21,"deletions":5,"binary":false,"changes":26,"status":"modified"},{"patch":"@@ -48,1 +48,0 @@\n-@SuppressWarnings(\"removal\")\n@@ -51,1 +50,8 @@\n-    private static final long CURRENT_PID;\n+    private static final long CURRENT_PID = pid();\n+\n+    @SuppressWarnings(\"removal\")\n+    private static long pid() {\n+        PrivilegedAction<ProcessHandle> pa = () -> ProcessHandle.current();\n+        return AccessController.doPrivileged(pa).pid();\n+    }\n+\n@@ -54,3 +60,0 @@\n-        PrivilegedAction<ProcessHandle> pa = ProcessHandle::current;\n-        CURRENT_PID = AccessController.doPrivileged(pa).pid();\n-\n","filename":"src\/jdk.attach\/share\/classes\/sun\/tools\/attach\/HotSpotVirtualMachine.java","additions":8,"deletions":5,"binary":false,"changes":13,"status":"modified"},{"patch":"@@ -74,1 +74,0 @@\n-@SuppressWarnings(\"removal\")\n@@ -191,0 +190,1 @@\n+                    @SuppressWarnings(\"removal\")\n@@ -361,0 +361,1 @@\n+                @SuppressWarnings(\"removal\")\n@@ -1092,0 +1093,5 @@\n+        loadSctpLibrary();\n+    }\n+\n+    @SuppressWarnings(\"removal\")\n+    private static void loadSctpLibrary() {\n","filename":"src\/jdk.sctp\/unix\/classes\/sun\/nio\/ch\/sctp\/SctpChannelImpl.java","additions":7,"deletions":1,"binary":false,"changes":8,"status":"modified"},{"patch":"@@ -43,1 +43,0 @@\n-@SuppressWarnings(\"removal\")\n@@ -45,0 +44,1 @@\n+    @SuppressWarnings(\"removal\")\n@@ -107,0 +107,1 @@\n+         @SuppressWarnings(\"removal\")\n@@ -116,1 +117,1 @@\n-                                                         SecurityManager sm)\n+                                                         @SuppressWarnings(\"removal\") SecurityManager sm)\n@@ -339,0 +340,5 @@\n+        loadSctpLibrary();\n+    }\n+\n+    @SuppressWarnings(\"removal\")\n+    private static void loadSctpLibrary() {\n","filename":"src\/jdk.sctp\/unix\/classes\/sun\/nio\/ch\/sctp\/SctpNet.java","additions":8,"deletions":2,"binary":false,"changes":10,"status":"modified"}]}