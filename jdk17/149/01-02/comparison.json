{"files":[{"patch":"@@ -54,1 +54,1 @@\n-Thread* ProgrammableUpcallHandler::maybe_attach_and_get_thread(bool* should_detach) {\n+JavaThread* ProgrammableUpcallHandler::maybe_attach_and_get_thread(bool* should_detach) {\n@@ -67,1 +67,1 @@\n-  return thread;\n+  return thread->as_Java_thread();\n@@ -76,2 +76,2 @@\n-Thread* ProgrammableUpcallHandler::on_entry(OptimizedEntryBlob::FrameData* context) {\n-  JavaThread* thread = maybe_attach_and_get_thread(&context->should_detach)->as_Java_thread();\n+JavaThread* ProgrammableUpcallHandler::on_entry(OptimizedEntryBlob::FrameData* context) {\n+  JavaThread* thread = maybe_attach_and_get_thread(&context->should_detach);\n@@ -86,1 +86,1 @@\n-  \/\/ After this, we are official in Java Code. This needs to be done before we change any of the thread local\n+  \/\/ After this, we are officially in Java Code. This needs to be done before we change any of the thread local\n@@ -92,1 +92,1 @@\n-  \/\/ to prepare for stop\/suspend (flush register windows on sparcs, cache sp, or other state).\n+  \/\/ to prepare for stop\/suspend (cache sp, or other state).\n@@ -114,2 +114,0 @@\n-  assert (thread->thread_state() != _thread_in_native, \"cannot set native pc to NULL\");\n-\n@@ -117,1 +115,1 @@\n-  if(clear_pending_exception) {\n+  if (clear_pending_exception) {\n@@ -143,6 +141,0 @@\n-  \/\/ State has been restored now make the anchor frame visible for the profiler.\n-  \/\/ Do this after the transition because this allows us to put an assert\n-  \/\/ the Java->native transition which checks to see that stack is not walkable\n-  \/\/ on sparc\/ia64 which will catch violations of the reseting of last_Java_frame\n-  \/\/ invariants (i.e. _flags always cleared on return to Java)\n-\n@@ -164,1 +156,1 @@\n-  Thread* thread = maybe_attach_and_get_thread(&should_detach);\n+  JavaThread* thread = maybe_attach_and_get_thread(&should_detach);\n","filename":"src\/hotspot\/share\/prims\/universalUpcallHandler.cpp","additions":8,"deletions":16,"binary":false,"changes":24,"status":"modified"},{"patch":"@@ -51,1 +51,1 @@\n-  static Thread* maybe_attach_and_get_thread(bool* should_detach);\n+  static JavaThread* maybe_attach_and_get_thread(bool* should_detach);\n@@ -54,1 +54,1 @@\n-  static Thread* on_entry(OptimizedEntryBlob::FrameData* context);\n+  static JavaThread* on_entry(OptimizedEntryBlob::FrameData* context);\n","filename":"src\/hotspot\/share\/prims\/universalUpcallHandler.hpp","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -1971,2 +1971,2 @@\n-         \"unexpected frame info: has_last_frame=%d, java_call_counter=%d\",\n-         has_last_Java_frame(), java_call_counter());\n+         \"unexpected frame info: has_last_frame=%s, java_call_counter=%d\",\n+         has_last_Java_frame() ? \"true\" : \"false\", java_call_counter());\n","filename":"src\/hotspot\/share\/runtime\/thread.cpp","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"}]}