{"files":[{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2003, 2020, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2003, 2021, Oracle and\/or its affiliates. All rights reserved.\n@@ -24,1 +24,1 @@\n-\/*\n+ \/*\n@@ -26,1 +26,1 @@\n- * @bug 4856966 8242332\n+ * @bug 4856966 8242332 8269276\n@@ -35,1 +35,0 @@\n-\n@@ -50,2 +49,1 @@\n-        List<String> ALGS = getSupportedAlgorithms(\"MessageDigest\",\n-                \"SHA\", p);\n+        List<String> ALGS = getSupportedAlgorithms(\"MessageDigest\", \"SHA\", p);\n@@ -78,4 +76,5 @@\n-        MessageDigest md = MessageDigest.getInstance(alg, \"SUN\");\n-        byte[] d1 = md.digest(data1);\n-        md = MessageDigest.getInstance(alg, p);\n-        byte[] d2 = md.digest(data1);\n+        MessageDigest md1 = MessageDigest.getInstance(alg, \"SUN\");\n+        byte[] d1 = md1.digest(data1);\n+        MessageDigest md2 = MessageDigest.getInstance(alg, p);\n+        checkInstances(md1, md2);\n+        byte[] d2 = md2.digest(data1);\n@@ -83,1 +82,1 @@\n-        byte[] d3 = md.digest(data1);\n+        byte[] d3 = md2.digest(data1);\n@@ -85,4 +84,4 @@\n-        md.update(data2);\n-        md.update((byte)0);\n-        md.reset();\n-        byte[] d4 = md.digest(data1);\n+        md2.update(data2);\n+        md2.update((byte) 0);\n+        md2.reset();\n+        byte[] d4 = md2.digest(data1);\n@@ -97,0 +96,13 @@\n+\n+    private static void checkInstances(MessageDigest md1, MessageDigest md2)\n+            throws Exception {\n+        if (md1.equals(md2)) {\n+            throw new RuntimeException(\"MD instances should be different\");\n+        }\n+        if (!md1.getAlgorithm().equals(md2.getAlgorithm())) {\n+            throw new RuntimeException(\"Algorithm name should equal\");\n+        }\n+        if (md1.getProvider().equals(md2.getProvider())) {\n+            throw new RuntimeException(\"Provider name should be different\");\n+        }\n+    }\n","filename":"test\/jdk\/sun\/security\/pkcs11\/MessageDigest\/ReinitDigest.java","additions":27,"deletions":15,"binary":false,"changes":42,"status":"modified"}]}