{"files":[{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 1997, 2020, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 1997, 2021, Oracle and\/or its affiliates. All rights reserved.\n@@ -1840,0 +1840,1 @@\n+    int res;\n@@ -1996,2 +1997,2 @@\n-        if (setsockopt(fd, IPPROTO_IP, (join ? IP_ADD_MEMBERSHIP:IP_DROP_MEMBERSHIP),\n-                       (char *) &mname, mname_len) < 0) {\n+        res = setsockopt(fd, IPPROTO_IP, (join ? IP_ADD_MEMBERSHIP:IP_DROP_MEMBERSHIP),\n+                       (char *) &mname, mname_len);\n@@ -1999,0 +2000,8 @@\n+#ifdef __APPLE__\n+        if (res < 0 && errno == ENOMEM) {\n+            res = setsockopt(fd, IPPROTO_IP, (join ? IP_ADD_MEMBERSHIP:IP_DROP_MEMBERSHIP),\n+                       (char *) &mname, mname_len);\n+        }\n+#endif\n+\n+        if (res < 0) {\n@@ -2099,2 +2108,2 @@\n-        if (setsockopt(fd, IPPROTO_IPV6, (join ? ADD_MEMBERSHIP : DRP_MEMBERSHIP),\n-                       (char *) &mname6, sizeof (mname6)) < 0) {\n+        res = setsockopt(fd, IPPROTO_IPV6, (join ? ADD_MEMBERSHIP : DRP_MEMBERSHIP),\n+                       (char *) &mname6, sizeof(mname6));\n@@ -2102,0 +2111,7 @@\n+#ifdef __APPLE__\n+        if (res < 0 && errno == ENOMEM) {\n+            res = setsockopt(fd, IPPROTO_IPV6, (join ? ADD_MEMBERSHIP : DRP_MEMBERSHIP),\n+                       (char *) &mname6, sizeof(mname6));\n+        }\n+#endif\n+        if (res < 0) {\n","filename":"src\/java.base\/unix\/native\/libnet\/PlainDatagramSocketImpl.c","additions":21,"deletions":5,"binary":false,"changes":26,"status":"modified"},{"patch":"@@ -609,1 +609,0 @@\n-java\/net\/MulticastSocket\/Promiscuous.java                       8265369 macosx-aarch64\n","filename":"test\/jdk\/ProblemList.txt","additions":0,"deletions":1,"binary":false,"changes":1,"status":"modified"}]}