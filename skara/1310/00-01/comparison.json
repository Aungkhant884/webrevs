{"files":[{"patch":"@@ -67,1 +67,1 @@\n-            reply.println(\"this repository is not allowed to use the `csr` command.\");\n+            reply.println(\"This repository has not been configured to use the `csr` command.\");\n","filename":"bots\/pr\/src\/main\/java\/org\/openjdk\/skara\/bots\/pr\/CSRCommand.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -83,1 +83,1 @@\n-            reply.println(\"this repository is not allowed to use the `jep` command.\");\n+            reply.println(\"This repository has not been configured to use the `jep` command.\");\n","filename":"bots\/pr\/src\/main\/java\/org\/openjdk\/skara\/bots\/pr\/JEPCommand.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -672,1 +672,1 @@\n-            assertLastCommentContains(pr, \"this repository is not allowed to use the `csr` command.\");\n+            assertLastCommentContains(pr, \"This repository has not been configured to use the `csr` command.\");\n","filename":"bots\/pr\/src\/test\/java\/org\/openjdk\/skara\/bots\/pr\/CSRTests.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -431,0 +431,45 @@\n+\n+    @Test\n+    void testEnableJepConfig(TestInfo testInfo) throws IOException {\n+        try (var credentials = new HostCredentials(testInfo);\n+             var tempFolder = new TemporaryDirectory()) {\n+            var author = credentials.getHostedRepository();\n+            var bot = credentials.getHostedRepository();\n+            var issueProject = credentials.getIssueProject();\n+            var censusBuilder = credentials.getCensusBuilder()\n+                    .addAuthor(author.forge().currentUser().id());\n+\n+            \/\/ Populate the projects repository\n+            var localRepo = CheckableRepository.init(tempFolder.path(), author.repositoryType(),\n+                    Path.of(\"appendable.txt\"), Set.of(\"issues\"), null);\n+            var masterHash = localRepo.resolve(\"master\").orElseThrow();\n+            localRepo.push(masterHash, author.url(), \"master\", true);\n+\n+            var mainIssue = issueProject.createIssue(\"The main issue\", List.of(\"main\"), Map.of(\"issuetype\", JSON.of(\"Bug\")));\n+            var jepIssue = issueProject.createIssue(\"The jep issue\", List.of(\"Jep body\"),\n+                    Map.of(\"issuetype\", JSON.of(\"JEP\"), \"status\", JSON.object().put(\"name\", \"Submitted\"), JEP_NUMBER, JSON.of(\"123\")));\n+\n+            \/\/ Make a change with a corresponding PR\n+            var editHash = CheckableRepository.appendAndCommit(localRepo);\n+            localRepo.push(editHash, author.url(), \"edit\", true);\n+            var pr = credentials.createPullRequest(author, \"master\", \"edit\", mainIssue.id() + \": \" + mainIssue.title());\n+\n+            \/\/ Test the PR bot with jep disable\n+            var disableJepBot = PullRequestBot.newBuilder().repo(bot).issueProject(issueProject)\n+                            .enableJep(false).censusRepo(censusBuilder.build()).build();\n+            pr.addComment(\"\/jep TEST-2\");\n+            TestBotRunner.runPeriodicItems(disableJepBot);\n+            assertLastCommentContains(pr, \"This repository has not been configured to use the `jep` command.\");\n+            assertFalse(pr.labelNames().contains(JEPCommand.JEP_LABEL));\n+            assertFalse(pr.body().contains(\"- [ ] Change requires a JEP request to be targeted\"));\n+\n+            \/\/ Test the PR bot with jep enable\n+            var enableJepBot = PullRequestBot.newBuilder().repo(bot).issueProject(issueProject)\n+                    .enableJep(true).censusRepo(censusBuilder.build()).build();\n+            pr.addComment(\"\/jep TEST-2\");\n+            TestBotRunner.runPeriodicItems(enableJepBot);\n+            assertLastCommentContains(pr, \"pull request will not be integrated until the\");\n+            assertTrue(pr.labelNames().contains(JEPCommand.JEP_LABEL));\n+            assertTrue(pr.body().contains(\"- [ ] Change requires a JEP request to be targeted\"));\n+        }\n+    }\n","filename":"bots\/pr\/src\/test\/java\/org\/openjdk\/skara\/bots\/pr\/JEPCommandTests.java","additions":45,"deletions":0,"binary":false,"changes":45,"status":"modified"}]}