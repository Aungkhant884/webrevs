{"files":[{"patch":"@@ -195,9 +195,6 @@\n-                if (issue.state() == Issue.State.OPEN) {\n-                    log.info(\"Resolving issue \" + issue.id());\n-                    issue.setState(Issue.State.RESOLVED);\n-                    if (issue.assignees().isEmpty()) {\n-                        var username = findIssueUsername(commit, scratchPath);\n-                        if (username.isPresent()) {\n-                            var assignee = issueProject.issueTracker().user(username.get());\n-                            assignee.ifPresent(hostUser -> issue.setAssignees(List.of(hostUser)));\n-                        }\n+                log.info(\"Resolving issue \" + issue.id() + \" from state \" + issue.state());\n+                if (issue.assignees().isEmpty()) {\n+                    var username = findIssueUsername(commit, scratchPath);\n+                    if (username.isPresent()) {\n+                        var assignee = issueProject.issueTracker().user(username.get());\n+                        assignee.ifPresent(hostUser -> issue.setAssignees(List.of(hostUser)));\n@@ -206,0 +203,6 @@\n+\n+                if (!issue.isFixed()) {\n+                    issue.setState(Issue.State.RESOLVED);\n+                } else {\n+                    log.info(\"The issue was already resolved\");\n+                }\n@@ -314,14 +317,11 @@\n-                if (issue.state() == Issue.State.OPEN) {\n-                    log.info(\"Resolving issue \" + issue.id());\n-                    issue.setState(Issue.State.RESOLVED);\n-                    var assignees = issue.assignees();\n-                    \/\/ Due to a bug in the backport plugin, certain users can't be assigned directly.\n-                    \/\/ Work around this by overwriting the assignee afterwards if the current assignee\n-                    \/\/ is the bot user.\n-                    if (assignees.isEmpty() || (assignees.size() == 1 && assignees.get(0).equals(issueProject.issueTracker().currentUser()))) {\n-                        if (username.isPresent()) {\n-                            var assignee = issueProject.issueTracker().user(username.get());\n-                            if (assignee.isPresent()) {\n-                                log.info(\"Setting assignee for issue \" + issue.id() + \" to \" + assignee.get());\n-                                issue.setAssignees(List.of(assignee.get()));\n-                            }\n+                log.info(\"Resolving issue \" + issue.id() + \" from state \" + issue.state());\n+                var assignees = issue.assignees();\n+                \/\/ Due to a bug in the backport plugin, certain users can't be assigned directly.\n+                \/\/ Work around this by overwriting the assignee afterwards if the current assignee\n+                \/\/ is the bot user.\n+                if (assignees.isEmpty() || (assignees.size() == 1 && assignees.get(0).equals(issueProject.issueTracker().currentUser()))) {\n+                    if (username.isPresent()) {\n+                        var assignee = issueProject.issueTracker().user(username.get());\n+                        if (assignee.isPresent()) {\n+                            log.info(\"Setting assignee for issue \" + issue.id() + \" to \" + assignee.get());\n+                            issue.setAssignees(List.of(assignee.get()));\n@@ -331,0 +331,5 @@\n+                if (!issue.isFixed()) {\n+                    issue.setState(Issue.State.RESOLVED);\n+                } else {\n+                    log.info(\"The issue was already resolved\");\n+                }\n","filename":"bots\/notify\/src\/main\/java\/org\/openjdk\/skara\/bots\/notify\/issue\/IssueNotifier.java","additions":28,"deletions":23,"binary":false,"changes":51,"status":"modified"},{"patch":"@@ -1781,1 +1781,1 @@\n-            assertEquals(List.of(), updatedIssue.assignees());\n+            assertEquals(List.of(issueProject.issueTracker().currentUser()), updatedIssue.assignees());\n","filename":"bots\/notify\/src\/test\/java\/org\/openjdk\/skara\/bots\/notify\/issue\/IssueNotifierTests.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"}]}