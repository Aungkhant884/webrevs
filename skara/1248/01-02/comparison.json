{"files":[{"patch":"@@ -83,1 +83,1 @@\n-            var csr = jbsIssue.get().links().stream()\n+            var csrOptional = jbsIssue.get().links().stream()\n@@ -85,2 +85,2 @@\n-                    .findAny().flatMap(Link::issue).orElse(null);\n-            if (csr == null) {\n+                    .findAny().flatMap(Link::issue);\n+            if (csrOptional.isEmpty()) {\n@@ -88,0 +88,1 @@\n+                continue;\n@@ -89,1 +90,0 @@\n-            log.info(\"Found CSR for \" + describe(pr) + \". It has id \" + csr.id());\n@@ -91,0 +91,2 @@\n+            var csr = csrOptional.get();\n+            log.info(\"Found CSR for \" + describe(pr) + \". It has id \" + csr.id());\n","filename":"bots\/csr\/src\/main\/java\/org\/openjdk\/skara\/bots\/csr\/CSRBot.java","additions":6,"deletions":4,"binary":false,"changes":10,"status":"modified"},{"patch":"@@ -32,0 +32,1 @@\n+import java.util.Optional;\n@@ -58,0 +59,5 @@\n+    private static Optional<Link> csrLink(Issue issue) {\n+        return issue == null ? Optional.empty() : issue.links().stream()\n+                .filter(link -> link.relationship().isPresent() && \"csr for\".equals(link.relationship().get())).findAny();\n+    }\n+\n@@ -100,2 +106,1 @@\n-            var csrLink = jbsIssue.get().links().stream()\n-                    .filter(link -> link.relationship().isPresent() && \"csr for\".equals(link.relationship().get())).findAny();\n+            var csrLink = csrLink(jbsIssue.get());\n@@ -110,2 +115,2 @@\n-            var csrIssue = csrLink.flatMap(Link::issue).orElse(null);\n-            if (csrIssue == null) {\n+            var csrOptional = csrLink.flatMap(Link::issue);\n+            if (csrOptional.isEmpty()) {\n@@ -120,0 +125,1 @@\n+            var csrIssue = csrOptional.get();\n@@ -165,4 +171,2 @@\n-        var csr = jbsIssue.get().links().stream()\n-                .filter(link -> link.relationship().isPresent() && \"csr for\".equals(link.relationship().get()))\n-                .findAny().flatMap(Link::issue).orElse(null);\n-        if (csr == null && !labels.contains(CSR_LABEL)) {\n+        var csrOptional = csrLink(jbsIssue.get()).flatMap(Link::issue);\n+        if (csrOptional.isEmpty()) {\n@@ -175,0 +179,1 @@\n+        var csr = csrOptional.get();\n","filename":"bots\/pr\/src\/main\/java\/org\/openjdk\/skara\/bots\/pr\/CSRCommand.java","additions":13,"deletions":8,"binary":false,"changes":21,"status":"modified"},{"patch":"@@ -139,1 +139,1 @@\n-        org.openjdk.skara.issuetracker.Issue csr = jbsIssue.get().links().stream()\n+        var csr = jbsIssue.get().links().stream()\n@@ -141,2 +141,2 @@\n-                .findAny().flatMap(Link::issue).orElse(null);\n-        if (csr == null) {\n+                .findAny().flatMap(Link::issue);\n+        if (csr.isEmpty()) {\n@@ -145,1 +145,1 @@\n-            return Issue.fromStringRelaxed(csr.id() + \": \" + csr.title());\n+            return Issue.fromStringRelaxed(csr.get().id() + \": \" + csr.get().title());\n","filename":"bots\/pr\/src\/main\/java\/org\/openjdk\/skara\/bots\/pr\/CheckRun.java","additions":4,"deletions":4,"binary":false,"changes":8,"status":"modified"}]}