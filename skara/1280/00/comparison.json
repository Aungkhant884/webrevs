{"files":[{"patch":"@@ -311,8 +311,12 @@\n-                var resolvedInBuild = jdkVersion.resolvedInBuild();\n-                if (resolvedInBuild.isPresent()) {\n-                    if (!resolvedInBuild.get().equals(\"team\")) { \/\/ Special case - team build resolved are ignored\n-                        int resolvedInBuildNumber = jdkVersion.resolvedInBuildNumber();\n-                        if (resolvedInBuildNumber < 31) {\n-                            ret.add(jdkVersion.feature());\n-                        } else if (resolvedInBuildNumber < 60) {\n-                            ret.add(jdkVersion.feature() + \"+bpr\");\n+                if (bprException(jdkVersion, numericFeature)) {\n+                    ret.add(jdkVersion.feature());\n+                } else {\n+                    var resolvedInBuild = jdkVersion.resolvedInBuild();\n+                    if (resolvedInBuild.isPresent()) {\n+                        if (!resolvedInBuild.get().equals(\"team\")) { \/\/ Special case - team build resolved are ignored\n+                            int resolvedInBuildNumber = jdkVersion.resolvedInBuildNumber();\n+                            if (resolvedInBuildNumber < 30) {\n+                                ret.add(jdkVersion.feature());\n+                            } else if (resolvedInBuildNumber < 60) {\n+                                ret.add(jdkVersion.feature() + \"+bpr\");\n+                            }\n@@ -320,0 +324,2 @@\n+                    } else {\n+                        ret.add(jdkVersion.feature());\n@@ -321,2 +327,0 @@\n-                } else {\n-                    ret.add(jdkVersion.feature());\n@@ -333,0 +337,15 @@\n+    \/**\n+     * The general BPR rule cannot be applied to releases that have 30 or more actual builds.\n+     *\n+     * @return true if such a release is identified.\n+     *\/\n+    private static boolean bprException(JdkVersion jdkVersion, int numericFeature) {\n+        if (jdkVersion.interim().isPresent()) {\n+            var numericInterim = Integer.parseInt(jdkVersion.interim().get());\n+            if ((numericFeature == 7 && numericInterim == 40) || (numericFeature == 8 && numericInterim == 26)) {\n+                return true;\n+            }\n+        }\n+        return false;\n+    }\n+\n","filename":"jbs\/src\/main\/java\/org\/openjdk\/skara\/jbs\/Backports.java","additions":29,"deletions":10,"binary":false,"changes":39,"status":"modified"},{"patch":"@@ -840,0 +840,33 @@\n+\n+    @Test\n+    void jdk7u40(TestInfo testInfo) throws IOException {\n+        try (var credentials = new HostCredentials(testInfo)) {\n+            var backports = new BackportManager(credentials, \"17\");\n+            backports.assertLabeled();\n+\n+            backports.addBackports(\"7u40\/b31\", \"7u45\", \"8u60\");\n+            backports.assertLabeled(\"7u45\");\n+        }\n+    }\n+\n+    @Test\n+    void jdk8u26(TestInfo testInfo) throws IOException {\n+        try (var credentials = new HostCredentials(testInfo)) {\n+            var backports = new BackportManager(credentials, \"17\");\n+            backports.assertLabeled();\n+\n+            backports.addBackports(\"8u26\/b31\", \"8u30\");\n+            backports.assertLabeled(\"8u30\");\n+        }\n+    }\n+\n+    @Test\n+    void bpr7and8(TestInfo testInfo) throws IOException {\n+        try (var credentials = new HostCredentials(testInfo)) {\n+            var backports = new BackportManager(credentials, \"17\");\n+            backports.assertLabeled();\n+\n+            backports.addBackports(\"8u291\", \"8u281\/b30\", \"7u300\/b30\", \"7u310\");\n+            backports.assertLabeled();\n+        }\n+    }\n","filename":"jbs\/src\/test\/java\/org\/openjdk\/skara\/jbs\/BackportsTests.java","additions":33,"deletions":0,"binary":false,"changes":33,"status":"modified"}]}