{"files":[{"patch":"@@ -196,5 +196,0 @@\n-    private String getFullName(String username) {\n-        var details = user(username);\n-        return details.get().fullName();\n-    }\n-\n@@ -207,2 +202,5 @@\n-        return HostUser.create(json.get(\"id\").asInt(), json.get(\"login\").asString(),\n-                               () -> getFullName(json.get(\"login\").asString()));\n+        return HostUser.builder()\n+                       .id(json.get(\"id\").asInt())\n+                       .username(json.get(\"login\").asString())\n+                       .supplier(() -> user(json.get(\"login\").asString()).orElseThrow())\n+                       .build();\n@@ -287,1 +285,6 @@\n-        return HostUser.create(id, login, name, email);\n+        return HostUser.builder()\n+                       .id(id)\n+                       .username(login)\n+                       .fullName(name)\n+                       .email(email)\n+                       .build();\n","filename":"forge\/src\/main\/java\/org\/openjdk\/skara\/forge\/github\/GitHubHost.java","additions":11,"deletions":8,"binary":false,"changes":19,"status":"modified"},{"patch":"@@ -152,1 +152,6 @@\n-        return HostUser.create(id, username, name, email);\n+        return HostUser.builder()\n+                       .id(id)\n+                       .username(username)\n+                       .fullName(name)\n+                       .email(email)\n+                       .build();\n","filename":"forge\/src\/main\/java\/org\/openjdk\/skara\/forge\/gitlab\/GitLabHost.java","additions":6,"deletions":1,"binary":false,"changes":7,"status":"modified"},{"patch":"@@ -30,4 +30,3 @@\n-    private final String id;\n-    private final String username;\n-    private final Supplier<String> nameSupplier;\n-    private String name;\n+    private String id;\n+    private String username;\n+    private String fullName;\n@@ -35,0 +34,13 @@\n+    private final Supplier<HostUser> supplier;\n+\n+    public static class Builder {\n+        private String id;\n+        private String username;\n+        private String fullName;\n+        private String email;\n+        private Supplier<HostUser> supplier;\n+\n+        public Builder id(int id) {\n+            this.id = String.valueOf(id);\n+            return this;\n+        }\n@@ -36,7 +48,4 @@\n-    private HostUser(String id, String username, String name) {\n-        this.id = id ;\n-        this.username = username;\n-        this.nameSupplier = null;\n-        this.name = name;\n-        this.email = null;\n-    }\n+        public Builder id(String id) {\n+            this.id = id;\n+            return this;\n+        }\n@@ -44,7 +53,4 @@\n-    private HostUser(String id, String username, Supplier<String> nameSupplier) {\n-        this.id = id ;\n-        this.username = username;\n-        this.nameSupplier = nameSupplier;\n-        this.name = null;\n-        this.email = null;\n-    }\n+        public Builder username(String username) {\n+            this.username = username;\n+            return this;\n+        }\n@@ -52,7 +58,4 @@\n-    private HostUser(String id, String username, String name, String email) {\n-        this.id = id ;\n-        this.username = username;\n-        this.nameSupplier = null;\n-        this.name = name;\n-        this.email = email;\n-    }\n+        public Builder fullName(String fullName) {\n+            this.fullName = fullName;\n+            return this;\n+        }\n@@ -60,2 +63,13 @@\n-    public static HostUser create(int id, String username, Supplier<String> nameSupplier) {\n-        return new HostUser(String.valueOf(id), username, nameSupplier);\n+        public Builder email(String email) {\n+            this.email = email;\n+            return this;\n+        }\n+\n+        public Builder supplier(Supplier<HostUser> supplier) {\n+            this.supplier = supplier;\n+            return this;\n+        }\n+\n+        public HostUser build() {\n+            return new HostUser(id, username, fullName, email, supplier);\n+        }\n@@ -64,2 +78,6 @@\n-    public static HostUser create(int id, String username, String name, String email) {\n-        return new HostUser(String.valueOf(id), username, name, email);\n+    private HostUser(String id, String username, String fullName, String email, Supplier<HostUser> supplier) {\n+        this.id = id;\n+        this.username = username;\n+        this.fullName = fullName;\n+        this.email = email;\n+        this.supplier = supplier;\n@@ -68,2 +86,2 @@\n-    public static HostUser create(String id, String username, String name, String email) {\n-        return new HostUser(id, username, name, email);\n+    public static Builder builder() {\n+        return new Builder();\n@@ -72,2 +90,2 @@\n-    public static HostUser create(String id, String username, String name) {\n-        return new HostUser(id, username, name);\n+    public static HostUser create(String id, String username, String fullName) {\n+        return builder().id(id).username(username).fullName(fullName).build();\n@@ -76,2 +94,2 @@\n-    public static HostUser create(int id, String username, String name) {\n-        return new HostUser(String.valueOf(id), username, name);\n+    public static HostUser create(int id, String username, String fullName) {\n+        return builder().id(id).username(username).fullName(fullName).build();\n@@ -81,2 +99,2 @@\n-    public boolean equals(Object o) {\n-        if (this == o) {\n+    public boolean equals(Object other) {\n+        if (this == other) {\n@@ -85,1 +103,1 @@\n-        if (o == null || getClass() != o.getClass()) {\n+        if (other == null || getClass() != other.getClass()) {\n@@ -88,3 +106,3 @@\n-        HostUser that = (HostUser) o;\n-        return id.equals(that.id) &&\n-                Objects.equals(username, that.username);\n+        HostUser o = (HostUser) other;\n+        return Objects.equals(id(), o.id()) &&\n+               Objects.equals(username(), o.username());\n@@ -98,0 +116,8 @@\n+    private void update() {\n+        var result = supplier.get();\n+        id = result.id;\n+        username = result.username;\n+        fullName = result.fullName;\n+        email = result.email;\n+    }\n+\n@@ -99,0 +125,3 @@\n+        if (id == null) {\n+            update();\n+        }\n@@ -103,0 +132,3 @@\n+        if (username == null) {\n+            update();\n+        }\n@@ -107,2 +139,2 @@\n-        if (name == null) {\n-            name = nameSupplier.get();\n+        if (fullName == null) {\n+            update();\n@@ -110,1 +142,1 @@\n-        return name;\n+        return fullName;\n@@ -114,0 +146,3 @@\n+        if (id == null || username == null || fullName == null) {\n+            update();\n+        }\n@@ -122,1 +157,1 @@\n-                \", name='\" + name + '\\'' +\n+                \", fullName='\" + fullName + '\\'' +\n","filename":"host\/src\/main\/java\/org\/openjdk\/skara\/host\/HostUser.java","additions":80,"deletions":45,"binary":false,"changes":125,"status":"modified"},{"patch":"@@ -117,4 +117,6 @@\n-            currentUser = HostUser.create(data.get(\"name\").asString(),\n-                                          data.get(\"name\").asString(),\n-                                          data.get(\"displayName\").asString(),\n-                                          data.get(\"emailAddress\").asString());\n+            currentUser = HostUser.builder()\n+                                  .id(data.get(\"name\").asString())\n+                                  .username(data.get(\"name\").asString())\n+                                  .fullName(data.get(\"displayName\").asString())\n+                                  .email(data.get(\"emailAddress\").asString())\n+                                  .build();\n","filename":"issuetracker\/src\/main\/java\/org\/openjdk\/skara\/issuetracker\/jira\/JiraHost.java","additions":6,"deletions":4,"binary":false,"changes":10,"status":"modified"},{"patch":"@@ -437,4 +437,7 @@\n-        return Optional.of(HostUser.create(data.get(\"name\").asString(),\n-                                           data.get(\"name\").asString(),\n-                                           data.get(\"displayName\").asString(),\n-                                           data.get(\"emailAddress\").asString()));\n+        var hostUser = HostUser.builder()\n+                              .id(data.get(\"name\").asString())\n+                              .username(data.get(\"name\").asString())\n+                              .fullName(data.get(\"displayName\").asString())\n+                              .email(data.get(\"emailAddress\").asString())\n+                              .build();\n+        return Optional.of(hostUser);\n","filename":"issuetracker\/src\/main\/java\/org\/openjdk\/skara\/issuetracker\/jira\/JiraProject.java","additions":7,"deletions":4,"binary":false,"changes":11,"status":"modified"}]}