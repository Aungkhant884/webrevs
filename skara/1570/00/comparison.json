{"files":[{"patch":"@@ -366,1 +366,2 @@\n-            var webrevPath = scratchPath.resolve(\"mlbridge-webrevs\");\n+            var jsonWebrevPath = scratchPath.resolve(\"mlbridge-webrevs\").resolve(\"json\");\n+            var htmlWebrevPath = scratchPath.resolve(\"mlbridge-webrevs\").resolve(\"html\");\n@@ -401,1 +402,1 @@\n-            var webrevGenerator = bot.webrevStorage().generator(pr, localRepo, webrevPath, hostedRepositoryPool);\n+            var webrevGenerator = bot.webrevStorage().generator(pr, localRepo, jsonWebrevPath, htmlWebrevPath, hostedRepositoryPool);\n","filename":"bots\/mlbridge\/src\/main\/java\/org\/openjdk\/skara\/bots\/mlbridge\/ArchiveWorkItem.java","additions":3,"deletions":2,"binary":false,"changes":5,"status":"modified"},{"patch":"@@ -287,1 +287,2 @@\n-    private URI createAndArchive(PullRequest pr, Repository localRepository, Path scratchPath, Diff diff, Hash base, Hash head, String identifier,\n+    private URI createAndArchive(PullRequest pr, Repository localRepository, Path jsonScratchPath, Path htmlScratchPath,\n+                                 Diff diff, Hash base, Hash head, String identifier,\n@@ -294,1 +295,0 @@\n-            var outputFolder = scratchPath.resolve(relativeFolder);\n@@ -299,0 +299,1 @@\n+                var outputFolder = jsonScratchPath.resolve(relativeFolder);\n@@ -310,0 +311,1 @@\n+                var outputFolder = htmlScratchPath.resolve(relativeFolder);\n@@ -331,1 +333,2 @@\n-    WebrevGenerator generator(PullRequest pr, Repository localRepository, Path scratchPath, HostedRepositoryPool hostedRepositoryPool) {\n+    WebrevGenerator generator(PullRequest pr, Repository localRepository, Path jsonScratchPath, Path htmlScratchPath,\n+                              HostedRepositoryPool hostedRepositoryPool) {\n@@ -339,2 +342,2 @@\n-                    if (jsonLocalStorage == null && !(jsonStorage == null)) {\n-                        jsonLocalStorage = hostedRepositoryPool.checkout(jsonStorage, storageRef, scratchPath);\n+                    if (generateJSON && jsonLocalStorage == null && !(jsonStorage == null)) {\n+                        jsonLocalStorage = hostedRepositoryPool.checkout(jsonStorage, storageRef, jsonScratchPath);\n@@ -342,2 +345,2 @@\n-                    if (htmlLocalStorage == null && !(htmlStorage == null)) {\n-                        htmlLocalStorage = hostedRepositoryPool.checkout(htmlStorage, storageRef, scratchPath);\n+                    if (generateHTML && htmlLocalStorage == null && !(htmlStorage == null)) {\n+                        htmlLocalStorage = hostedRepositoryPool.checkout(htmlStorage, storageRef, htmlScratchPath);\n@@ -353,1 +356,1 @@\n-                var uri = createAndArchive(pr, localRepository, scratchPath, null, base, head, identifier, jsonLocalStorage, htmlLocalStorage);\n+                var uri = createAndArchive(pr, localRepository, jsonScratchPath, htmlScratchPath, null, base, head, identifier, jsonLocalStorage, htmlLocalStorage);\n@@ -360,1 +363,1 @@\n-                var uri = createAndArchive(pr, localRepository, scratchPath, diff, diff.from(), diff.to(), identifier, jsonLocalStorage, htmlLocalStorage);\n+                var uri = createAndArchive(pr, localRepository, jsonScratchPath, htmlScratchPath, diff, diff.from(), diff.to(), identifier, jsonLocalStorage, htmlLocalStorage);\n","filename":"bots\/mlbridge\/src\/main\/java\/org\/openjdk\/skara\/bots\/mlbridge\/WebrevStorage.java","additions":12,"deletions":9,"binary":false,"changes":21,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2019, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2019, 2023, Oracle and\/or its affiliates. All rights reserved.\n@@ -73,1 +73,2 @@\n-            var scratchFolder = tempFolder.path().resolve(\"scratch\");\n+            var jsonScratchFolder = tempFolder.path().resolve(\"scratch\").resolve(\"json\");\n+            var htmlScratchFolder = tempFolder.path().resolve(\"scratch\").resolve(\"html\");\n@@ -75,1 +76,1 @@\n-            var generator = storage.generator(pr, prRepo, scratchFolder, new HostedRepositoryPool(seedPath));\n+            var generator = storage.generator(pr, prRepo, jsonScratchFolder, htmlScratchFolder, new HostedRepositoryPool(seedPath));\n@@ -127,1 +128,2 @@\n-            var scratchFolder = tempFolder.path().resolve(\"scratch\");\n+            var jsonScratchFolder = tempFolder.path().resolve(\"scratch\").resolve(\"json\");\n+            var htmlScratchFolder = tempFolder.path().resolve(\"scratch\").resolve(\"html\");\n@@ -129,1 +131,1 @@\n-            var generator = storage.generator(pr, prRepo, scratchFolder, new HostedRepositoryPool(seedPath));\n+            var generator = storage.generator(pr, prRepo, jsonScratchFolder, htmlScratchFolder, new HostedRepositoryPool(seedPath));\n@@ -211,2 +213,3 @@\n-            var scratchFolder = tempFolder.path().resolve(\"scratch\");\n-            var generatorProgressMarker = scratchFolder.resolve(\"test\/\" + pr.id() + \"\/00\/nanoduke.ico\");\n+            var jsonScratchFolder = tempFolder.path().resolve(\"scratch\").resolve(\"json\");\n+            var htmlScratchFolder = tempFolder.path().resolve(\"scratch\").resolve(\"html\");\n+            var generatorProgressMarker = htmlScratchFolder.resolve(\"test\/\" + pr.id() + \"\/00\/nanoduke.ico\");\n@@ -214,1 +217,1 @@\n-            var generator = storage.generator(pr, prRepo, scratchFolder, new HostedRepositoryPool(seedPath));\n+            var generator = storage.generator(pr, prRepo, jsonScratchFolder, htmlScratchFolder, new HostedRepositoryPool(seedPath));\n","filename":"bots\/mlbridge\/src\/test\/java\/org\/openjdk\/skara\/bots\/mlbridge\/WebrevStorageTests.java","additions":11,"deletions":8,"binary":false,"changes":19,"status":"modified"}]}