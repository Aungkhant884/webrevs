{"files":[{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2020, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2020, 2021, Oracle and\/or its affiliates. All rights reserved.\n@@ -61,1 +61,1 @@\n-            reply.println(\"only the pull request author and [Reviewers](https:\/\/openjdk.java.net\/bylaws#reviewer) are allowed to require a CSR.\");\n+            reply.println(\"only the pull request author and [Reviewers](https:\/\/openjdk.java.net\/bylaws#reviewer) are allowed to use the `csr` command.\");\n","filename":"bots\/pr\/src\/main\/java\/org\/openjdk\/skara\/bots\/pr\/CSRCommand.java","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2019, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2019, 2021, Oracle and\/or its affiliates. All rights reserved.\n@@ -187,0 +187,1 @@\n+            var anotherPerson = credentials.getHostedRepository();\n@@ -192,1 +193,2 @@\n-                                           .addCommitter(author.forge().currentUser().id());\n+                                           .addCommitter(author.forge().currentUser().id())\n+                                           .addCommitter(anotherPerson.forge().currentUser().id());\n@@ -207,0 +209,15 @@\n+            \/\/ Require CSR from another person who is not a reviewer and is not the author\n+            var prAsAnother = anotherPerson.pullRequest(pr.id());\n+            prAsAnother.addComment(\"\/csr\");\n+            TestBotRunner.runPeriodicItems(prBot);\n+            assertLastCommentContains(prAsAnother, \"only the pull request author and [Reviewers]\");\n+            assertLastCommentContains(prAsAnother, \"are allowed to use the `csr` command.\");\n+            assertFalse(prAsAnother.labelNames().contains(\"csr\"));\n+\n+            \/\/ Stating that a CSR is not needed should not work\n+            prAsAnother.addComment(\"\/csr unneeded\");\n+            TestBotRunner.runPeriodicItems(prBot);\n+            assertLastCommentContains(prAsAnother, \"only the pull request author and [Reviewers]\");\n+            assertLastCommentContains(prAsAnother, \"are allowed to use the `csr` command.\");\n+            assertFalse(prAsAnother.labelNames().contains(\"csr\"));\n+\n@@ -223,0 +240,7 @@\n+\n+            \/\/ Stating that a CSR is not needed should not work\n+            prAsAnother.addComment(\"\/csr unneeded\");\n+            TestBotRunner.runPeriodicItems(prBot);\n+            assertLastCommentContains(prAsAnother, \"only the pull request author and [Reviewers]\");\n+            assertLastCommentContains(prAsAnother, \"are allowed to use the `csr` command.\");\n+            assertTrue(prAsAnother.labelNames().contains(\"csr\"));\n","filename":"bots\/pr\/src\/test\/java\/org\/openjdk\/skara\/bots\/pr\/CSRTests.java","additions":26,"deletions":2,"binary":false,"changes":28,"status":"modified"}]}