{"files":[{"patch":"@@ -26,0 +26,1 @@\n+import org.openjdk.skara.census.Namespace;\n@@ -104,1 +105,5 @@\n-                    reply.println(\"Reviewer `\" + reviewer.username() + \"` has already made an authenticated review of this PR, and does not need to be credited manually.\");\n+                    if (hasMadeAuthenticatedApproveReview(pr.reviews(), reviewer, namespace)) {\n+                        reply.println(\"Reviewer `\" + reviewer.username() + \"` has already made an authenticated review of this PR, and does not need to be credited manually.\");\n+                    } else {\n+                        reply.println(\"Reviewer `\" + reviewer.username() + \"` has already made an authenticated review of this PR, but did not approve it. Manually crediting them is not allowed.\");\n+                    }\n@@ -134,0 +139,6 @@\n+    private boolean hasMadeAuthenticatedApproveReview(List<Review> reviews, Contributor reviewer, Namespace namespace) {\n+        return reviews.stream()\n+                .filter(review -> review.verdict().equals(Review.Verdict.APPROVED))\n+                .anyMatch(review -> namespace.get(review.reviewer().id()).username().equals(reviewer.username()));\n+    }\n+\n","filename":"bots\/pr\/src\/main\/java\/org\/openjdk\/skara\/bots\/pr\/ReviewerCommand.java","additions":12,"deletions":1,"binary":false,"changes":13,"status":"modified"},{"patch":"@@ -529,0 +529,14 @@\n+            pr.addComment(\"\/reviewer credit integrationreviewer2\");\n+            TestBotRunner.runPeriodicItems(prBot);\n+            assertLastCommentContains(pr,\n+                    \"Reviewer `integrationreviewer2` has already made an authenticated review of this PR, \" +\n+                            \"and does not need to be credited manually.\");\n+\n+            var reviewPr = integrator.pullRequest(pr.id());\n+            reviewPr.addReview(Review.Verdict.NONE, \"My comments\");\n+            pr.addComment(\"\/reviewer credit integrationreviewer1\");\n+            TestBotRunner.runPeriodicItems(prBot);\n+            assertLastCommentContains(pr,\n+                    \"Reviewer `integrationreviewer1` has already made an authenticated review of this PR, \" +\n+                            \"but did not approve it. Manually crediting them is not allowed.\");\n+\n","filename":"bots\/pr\/src\/test\/java\/org\/openjdk\/skara\/bots\/pr\/ReviewerTests.java","additions":14,"deletions":0,"binary":false,"changes":14,"status":"modified"}]}