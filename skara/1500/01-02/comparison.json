{"files":[{"patch":"@@ -447,14 +447,1 @@\n-        boolean isClean = !commit.isMerge();\n-        if (!isClean) {\n-            isClean = true;\n-            var commitMessageBody = localRepo.commitMessageBody(commit.hash());\n-            if (commitMessageBody.isPresent()) {\n-                var lines = commitMessageBody.get();\n-                for (int i = 0; i < lines.size() - 1; i++) {\n-                    if (lines.get(i).startsWith(\"diff\") && lines.get(i + 1).startsWith(\"index\")) {\n-                        isClean = false;\n-                        break;\n-                    }\n-                }\n-            }\n-        }\n+        boolean isClean = !commit.isMerge() || localRepo.isEmptyCommit(commit.hash());\n","filename":"bots\/pr\/src\/main\/java\/org\/openjdk\/skara\/bots\/pr\/CheckRun.java","additions":1,"deletions":14,"binary":false,"changes":15,"status":"modified"},{"patch":"@@ -186,1 +186,1 @@\n-    Optional<List<String>> commitMessageBody(Hash hash);\n+    boolean isEmptyCommit(Hash hash);\n","filename":"vcs\/src\/main\/java\/org\/openjdk\/skara\/vcs\/Repository.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -1732,1 +1732,1 @@\n-    public Optional<List<String>> commitMessageBody(Hash hash) {\n+    public boolean isEmptyCommit(Hash hash) {\n@@ -1735,1 +1735,10 @@\n-            return res.status() == 0 ? Optional.of(res.stdout()) : Optional.empty();\n+            if (res.status() != 0) {\n+                return false;\n+            }\n+            var lines = res.stdout();\n+            for (int i = 0; i < lines.size() - 1; i++) {\n+                if (lines.get(i).startsWith(\"diff\") && lines.get(i + 1).startsWith(\"index\")) {\n+                    return false;\n+                }\n+            }\n+            return true;\n","filename":"vcs\/src\/main\/java\/org\/openjdk\/skara\/vcs\/git\/GitRepository.java","additions":11,"deletions":2,"binary":false,"changes":13,"status":"modified"},{"patch":"@@ -1528,1 +1528,1 @@\n-    public Optional<List<String>> commitMessageBody(Hash hash) {\n+    public boolean isEmptyCommit(Hash hash) {\n","filename":"vcs\/src\/main\/java\/org\/openjdk\/skara\/vcs\/hg\/HgRepository.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"}]}