{"files":[{"patch":"@@ -36,1 +36,0 @@\n-import java.nio.file.Path;\n@@ -42,0 +41,2 @@\n+import static org.openjdk.skara.bots.common.CommandNameEnum.backport;\n+\n@@ -56,0 +57,5 @@\n+    @Override\n+    public String name() {\n+        return backport.name();\n+    }\n+\n@@ -67,1 +73,1 @@\n-    public void handle(PullRequestBot bot, PullRequest pr, CensusInstance censusInstance, Path scratchPath, CommandInvocation command,\n+    public void handle(PullRequestBot bot, PullRequest pr, CensusInstance censusInstance, ScratchArea scratchArea, CommandInvocation command,\n@@ -174,1 +180,1 @@\n-            Path scratchPath, CommandInvocation command, List<Comment> allComments, PrintWriter reply) {\n+            ScratchArea scratchArea, CommandInvocation command, List<Comment> allComments, PrintWriter reply) {\n@@ -236,3 +242,3 @@\n-                var localRepoDir = scratchPath.resolve(\"backport-command\")\n-                                              .resolve(targetRepo.name())\n-                                              .resolve(\"fork\");\n+                var localRepoDir = scratchArea.get(this)\n+                        .resolve(targetRepo.name())\n+                        .resolve(\"fork\");\n","filename":"bots\/pr\/src\/main\/java\/org\/openjdk\/skara\/bots\/pr\/BackportCommand.java","additions":12,"deletions":6,"binary":false,"changes":18,"status":"modified"},{"patch":"@@ -30,1 +30,0 @@\n-import java.nio.file.Path;\n@@ -35,0 +34,1 @@\n+import static org.openjdk.skara.bots.common.CommandNameEnum.csr;\n@@ -81,1 +81,1 @@\n-    public void handle(PullRequestBot bot, PullRequest pr, CensusInstance censusInstance, Path scratchPath, CommandInvocation command, List<Comment> allComments, PrintWriter reply) {\n+    public void handle(PullRequestBot bot, PullRequest pr, CensusInstance censusInstance, ScratchArea scratchArea, CommandInvocation command, List<Comment> allComments, PrintWriter reply) {\n@@ -183,0 +183,5 @@\n+    @Override\n+    public String name() {\n+        return csr.name();\n+    }\n+\n","filename":"bots\/pr\/src\/main\/java\/org\/openjdk\/skara\/bots\/pr\/CSRCommand.java","additions":7,"deletions":2,"binary":false,"changes":9,"status":"modified"},{"patch":"@@ -250,2 +250,2 @@\n-    public Collection<WorkItem> prRun(Path scratchPath) {\n-        var seedPath = bot.seedStorage().orElse(scratchPath.resolve(\"seeds\"));\n+    public Collection<WorkItem> prRun(ScratchArea scratchArea) {\n+        var seedPath = bot.seedStorage().orElse(scratchArea.getSeeds());\n@@ -257,1 +257,1 @@\n-            census = CensusInstance.createCensusInstance(hostedRepositoryPool, bot.censusRepo(), bot.censusRef(), scratchPath.resolve(\"census\"), pr,\n+            census = CensusInstance.createCensusInstance(hostedRepositoryPool, bot.censusRepo(), bot.censusRef(), scratchArea.getCensus(), pr,\n@@ -340,1 +340,1 @@\n-                    var localRepo = materializeLocalRepo(scratchPath, hostedRepositoryPool);\n+                    var localRepo = materializeLocalRepo(scratchArea, hostedRepositoryPool);\n@@ -462,1 +462,1 @@\n-                Repository localRepo = materializeLocalRepo(scratchPath, hostedRepositoryPool);\n+                Repository localRepo = materializeLocalRepo(scratchArea, hostedRepositoryPool);\n@@ -512,1 +512,1 @@\n-    private Repository materializeLocalRepo(Path scratchPath, HostedRepositoryPool hostedRepositoryPool) throws IOException {\n+    private Repository materializeLocalRepo(ScratchArea scratchArea, HostedRepositoryPool hostedRepositoryPool) throws IOException {\n@@ -514,1 +514,1 @@\n-            var localRepoPath = scratchPath.resolve(\"pr\").resolve(\"check\").resolve(pr.repository().name());\n+            var localRepoPath = scratchArea.get(pr.repository());\n","filename":"bots\/pr\/src\/main\/java\/org\/openjdk\/skara\/bots\/pr\/CheckWorkItem.java","additions":7,"deletions":7,"binary":false,"changes":14,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2021, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2021, 2023, Oracle and\/or its affiliates. All rights reserved.\n@@ -29,1 +29,0 @@\n-import java.nio.file.Path;\n@@ -32,0 +31,2 @@\n+import static org.openjdk.skara.bots.common.CommandNameEnum.clean;\n+\n@@ -42,0 +43,5 @@\n+    @Override\n+    public String name() {\n+        return clean.name();\n+    }\n+\n@@ -48,1 +54,1 @@\n-    public void handle(PullRequestBot bot, PullRequest pr, CensusInstance censusInstance, Path scratchPath, CommandInvocation command, List<Comment> allComments, PrintWriter reply)\n+    public void handle(PullRequestBot bot, PullRequest pr, CensusInstance censusInstance, ScratchArea scratchArea, CommandInvocation command, List<Comment> allComments, PrintWriter reply)\n","filename":"bots\/pr\/src\/main\/java\/org\/openjdk\/skara\/bots\/pr\/CleanCommand.java","additions":9,"deletions":3,"binary":false,"changes":12,"status":"modified"},{"patch":"@@ -32,1 +32,0 @@\n-import java.nio.file.Path;\n@@ -71,1 +70,1 @@\n-        public void handle(PullRequestBot bot, PullRequest pr, CensusInstance censusInstance, Path scratchPath, CommandInvocation command, List<Comment> allComments, PrintWriter reply) {\n+        public void handle(PullRequestBot bot, PullRequest pr, CensusInstance censusInstance, ScratchArea scratchArea, CommandInvocation command, List<Comment> allComments, PrintWriter reply) {\n@@ -83,1 +82,1 @@\n-        public void handle(PullRequestBot bot, HostedCommit hash, LimitedCensusInstance censusInstance, Path scratchPath, CommandInvocation command, List<Comment> allComments, PrintWriter reply) {\n+        public void handle(PullRequestBot bot, HostedCommit hash, LimitedCensusInstance censusInstance, ScratchArea scratchArea, CommandInvocation command, List<Comment> allComments, PrintWriter reply) {\n@@ -98,0 +97,5 @@\n+\n+        @Override\n+        public String name() {\n+            return help.name();\n+        }\n","filename":"bots\/pr\/src\/main\/java\/org\/openjdk\/skara\/bots\/pr\/CommandExtractor.java","additions":7,"deletions":3,"binary":false,"changes":10,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2019, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2019, 2023, Oracle and\/or its affiliates. All rights reserved.\n@@ -30,1 +30,0 @@\n-import java.nio.file.Path;\n@@ -36,1 +35,3 @@\n-    default void handle(PullRequestBot bot, PullRequest pr, CensusInstance censusInstance, Path scratchPath,\n+    String name();\n+\n+    default void handle(PullRequestBot bot, PullRequest pr, CensusInstance censusInstance, ScratchArea scratchArea,\n@@ -40,1 +41,1 @@\n-    default void handle(PullRequestBot bot, PullRequest pr, CensusInstance censusInstance, Path scratchPath, CommandInvocation command,\n+    default void handle(PullRequestBot bot, PullRequest pr, CensusInstance censusInstance, ScratchArea scratchArea, CommandInvocation command,\n@@ -42,1 +43,1 @@\n-        handle(bot, pr, censusInstance, scratchPath, command, allComments, reply);\n+        handle(bot, pr, censusInstance, scratchArea, command, allComments, reply);\n@@ -45,1 +46,1 @@\n-    default void handle(PullRequestBot bot, HostedCommit commit, LimitedCensusInstance censusInstance, Path scratchPath,\n+    default void handle(PullRequestBot bot, HostedCommit commit, LimitedCensusInstance censusInstance, ScratchArea scratchArea,\n","filename":"bots\/pr\/src\/main\/java\/org\/openjdk\/skara\/bots\/pr\/CommandHandler.java","additions":7,"deletions":6,"binary":false,"changes":13,"status":"modified"},{"patch":"@@ -90,1 +90,1 @@\n-    private void processCommand(Path scratchPath, HostedCommit commit, LimitedCensusInstance censusInstance,\n+    private void processCommand(ScratchArea scratchArea, HostedCommit commit, LimitedCensusInstance censusInstance,\n@@ -106,1 +106,1 @@\n-                handler.get().handle(bot, commit, censusInstance, scratchPath, command, comments, printer);\n+                handler.get().handle(bot, commit, censusInstance, scratchArea, command, comments, printer);\n@@ -182,1 +182,1 @@\n-            processCommand(scratchPath, commit, census, command, allComments);\n+            processCommand(new ScratchArea(scratchPath, bot.name()), commit, census, command, allComments);\n","filename":"bots\/pr\/src\/main\/java\/org\/openjdk\/skara\/bots\/pr\/CommitCommandWorkItem.java","additions":3,"deletions":3,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -31,1 +31,0 @@\n-import java.nio.file.Path;\n@@ -35,0 +34,2 @@\n+import static org.openjdk.skara.bots.common.CommandNameEnum.contributor;\n+\n@@ -97,1 +98,1 @@\n-    public void handle(PullRequestBot bot, PullRequest pr, CensusInstance censusInstance, Path scratchPath, CommandInvocation command, List<Comment> allComments, PrintWriter reply) {\n+    public void handle(PullRequestBot bot, PullRequest pr, CensusInstance censusInstance, ScratchArea scratchArea, CommandInvocation command, List<Comment> allComments, PrintWriter reply) {\n@@ -149,0 +150,5 @@\n+    @Override\n+    public String name() {\n+        return contributor.name();\n+    }\n+\n","filename":"bots\/pr\/src\/main\/java\/org\/openjdk\/skara\/bots\/pr\/ContributorCommand.java","additions":8,"deletions":2,"binary":false,"changes":10,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2019, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2019, 2023, Oracle and\/or its affiliates. All rights reserved.\n@@ -31,1 +31,0 @@\n-import java.nio.file.Path;\n@@ -40,0 +39,2 @@\n+import static org.openjdk.skara.bots.common.CommandNameEnum.integrate;\n+\n@@ -78,1 +79,1 @@\n-    public void handle(PullRequestBot bot, PullRequest pr, CensusInstance censusInstance, Path scratchPath, CommandInvocation command, List<Comment> allComments, PrintWriter reply) {\n+    public void handle(PullRequestBot bot, PullRequest pr, CensusInstance censusInstance, ScratchArea scratchArea, CommandInvocation command, List<Comment> allComments, PrintWriter reply) {\n@@ -164,1 +165,1 @@\n-        Optional<Hash> prepushHash = checkForPrePushHash(bot, pr, scratchPath, allComments, \"integrate\");\n+        Optional<Hash> prepushHash = checkForPrePushHash(bot, pr, scratchArea, allComments);\n@@ -194,1 +195,1 @@\n-            Repository localRepo = materializeLocalRepo(bot, pr, scratchPath, \"integrate\");\n+            Repository localRepo = materializeLocalRepo(bot, pr, scratchArea);\n@@ -276,3 +277,3 @@\n-    static Repository materializeLocalRepo(PullRequestBot bot, PullRequest pr, Path scratchPath, String subdir) throws IOException {\n-        var path = scratchPath.resolve(subdir).resolve(pr.repository().name());\n-        var seedPath = bot.seedStorage().orElse(scratchPath.resolve(\"seeds\"));\n+    static Repository materializeLocalRepo(PullRequestBot bot, PullRequest pr, ScratchArea scratchArea) throws IOException {\n+        var path = scratchArea.get(pr.repository());\n+        var seedPath = bot.seedStorage().orElse(scratchArea.getSeeds());\n@@ -288,2 +289,2 @@\n-    static Optional<Hash> checkForPrePushHash(PullRequestBot bot, PullRequest pr, Path scratchPath,\n-                                              List<Comment> allComments, String subdir) {\n+    static Optional<Hash> checkForPrePushHash(PullRequestBot bot, PullRequest pr, ScratchArea scratchArea,\n+                                              List<Comment> allComments) {\n@@ -300,1 +301,1 @@\n-                var localRepo = materializeLocalRepo(bot, pr, scratchPath, subdir);\n+                var localRepo = materializeLocalRepo(bot, pr, scratchArea);\n@@ -372,0 +373,5 @@\n+    @Override\n+    public String name() {\n+        return integrate.name();\n+    }\n+\n","filename":"bots\/pr\/src\/main\/java\/org\/openjdk\/skara\/bots\/pr\/IntegrateCommand.java","additions":17,"deletions":11,"binary":false,"changes":28,"status":"modified"},{"patch":"@@ -33,1 +33,0 @@\n-import java.nio.file.Path;\n@@ -39,1 +38,1 @@\n-\n+import static org.openjdk.skara.bots.common.CommandNameEnum.issue;\n@@ -274,1 +273,1 @@\n-    public void handle(PullRequestBot bot, PullRequest pr, CensusInstance censusInstance, Path scratchPath, CommandInvocation command, List<Comment> allComments, PrintWriter reply) {\n+    public void handle(PullRequestBot bot, PullRequest pr, CensusInstance censusInstance, ScratchArea scratchArea, CommandInvocation command, List<Comment> allComments, PrintWriter reply) {\n@@ -312,0 +311,5 @@\n+    @Override\n+    public String name() {\n+        return issue.name();\n+    }\n+\n","filename":"bots\/pr\/src\/main\/java\/org\/openjdk\/skara\/bots\/pr\/IssueCommand.java","additions":7,"deletions":3,"binary":false,"changes":10,"status":"modified"},{"patch":"@@ -31,1 +31,0 @@\n-import java.nio.file.Path;\n@@ -35,0 +34,1 @@\n+import static org.openjdk.skara.bots.common.CommandNameEnum.jep;\n@@ -86,1 +86,1 @@\n-    public void handle(PullRequestBot bot, PullRequest pr, CensusInstance censusInstance, Path scratchPath, CommandInvocation command,\n+    public void handle(PullRequestBot bot, PullRequest pr, CensusInstance censusInstance, ScratchArea scratchArea, CommandInvocation command,\n@@ -164,0 +164,5 @@\n+    @Override\n+    public String name() {\n+        return jep.name();\n+    }\n+\n","filename":"bots\/pr\/src\/main\/java\/org\/openjdk\/skara\/bots\/pr\/JEPCommand.java","additions":7,"deletions":2,"binary":false,"changes":9,"status":"modified"},{"patch":"@@ -29,1 +29,0 @@\n-import java.nio.file.Path;\n@@ -34,0 +33,2 @@\n+import static org.openjdk.skara.bots.common.CommandNameEnum.label;\n+\n@@ -58,1 +59,1 @@\n-    public void handle(PullRequestBot bot, PullRequest pr, CensusInstance censusInstance, Path scratchPath, CommandInvocation command, List<Comment> allComments, PrintWriter reply) {\n+    public void handle(PullRequestBot bot, PullRequest pr, CensusInstance censusInstance, ScratchArea scratchArea, CommandInvocation command, List<Comment> allComments, PrintWriter reply) {\n@@ -177,0 +178,5 @@\n+    @Override\n+    public String name() {\n+        return label.name();\n+    }\n+\n","filename":"bots\/pr\/src\/main\/java\/org\/openjdk\/skara\/bots\/pr\/LabelCommand.java","additions":8,"deletions":2,"binary":false,"changes":10,"status":"modified"},{"patch":"@@ -32,1 +32,0 @@\n-import java.nio.file.Path;\n@@ -119,1 +118,1 @@\n-    public Collection<WorkItem> prRun(Path scratchPath) {\n+    public Collection<WorkItem> prRun(ScratchArea scratchArea) {\n@@ -149,2 +148,2 @@\n-            var path = scratchPath.resolve(\"pr\").resolve(\"labeler\").resolve(pr.repository().name());\n-            var seedPath = bot.seedStorage().orElse(scratchPath.resolve(\"seeds\"));\n+            var path = scratchArea.get(pr.repository());\n+            var seedPath = bot.seedStorage().orElse(scratchArea.getSeeds());\n","filename":"bots\/pr\/src\/main\/java\/org\/openjdk\/skara\/bots\/pr\/LabelerWorkItem.java","additions":3,"deletions":4,"binary":false,"changes":7,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2021, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2021, 2023, Oracle and\/or its affiliates. All rights reserved.\n@@ -30,1 +30,0 @@\n-import java.nio.file.Path;\n@@ -33,0 +32,2 @@\n+import static org.openjdk.skara.bots.common.CommandNameEnum.open;\n+\n@@ -43,0 +44,5 @@\n+    @Override\n+    public String name() {\n+        return open.name();\n+    }\n+\n@@ -49,1 +55,1 @@\n-    public void handle(PullRequestBot bot, PullRequest pr, CensusInstance censusInstance, Path scratchPath, CommandInvocation command, List<Comment> allComments, PrintWriter reply)\n+    public void handle(PullRequestBot bot, PullRequest pr, CensusInstance censusInstance, ScratchArea scratchArea, CommandInvocation command, List<Comment> allComments, PrintWriter reply)\n","filename":"bots\/pr\/src\/main\/java\/org\/openjdk\/skara\/bots\/pr\/OpenCommand.java","additions":9,"deletions":3,"binary":false,"changes":12,"status":"modified"},{"patch":"@@ -33,1 +33,0 @@\n-import java.nio.file.Path;\n@@ -54,1 +53,1 @@\n-        public void handle(PullRequestBot bot, PullRequest pr, CensusInstance censusInstance, Path scratchPath, CommandInvocation command, List<Comment> allComments, PrintWriter reply) {\n+        public void handle(PullRequestBot bot, PullRequest pr, CensusInstance censusInstance, ScratchArea scratchArea, CommandInvocation command, List<Comment> allComments, PrintWriter reply) {\n@@ -62,0 +61,5 @@\n+\n+        @Override\n+        public String name() {\n+            return \"invalidCommand\";\n+        }\n@@ -116,1 +120,1 @@\n-    private void processCommand(PullRequest pr, CensusInstance censusInstance, Path scratchPath, CommandInvocation command, List<Comment> allComments,\n+    private void processCommand(PullRequest pr, CensusInstance censusInstance, ScratchArea scratchArea, CommandInvocation command, List<Comment> allComments,\n@@ -133,1 +137,1 @@\n-                        handler.get().handle(bot, commit, censusInstance, scratchPath, command, allComments, printer);\n+                        handler.get().handle(bot, commit, censusInstance, scratchArea, command, allComments, printer);\n@@ -154,1 +158,1 @@\n-                    handler.get().handle(bot, pr, censusInstance, scratchPath, command, allComments, printer, labelsToAdd, labelsToRemove);\n+                    handler.get().handle(bot, pr, censusInstance, scratchArea, command, allComments, printer, labelsToAdd, labelsToRemove);\n@@ -178,1 +182,1 @@\n-    public Collection<WorkItem> prRun(Path scratchPath) {\n+    public Collection<WorkItem> prRun(ScratchArea scratchArea) {\n@@ -195,1 +199,1 @@\n-        var seedPath = bot.seedStorage().orElse(scratchPath.resolve(\"seeds\"));\n+        var seedPath = bot.seedStorage().orElse(scratchArea.getSeeds());\n@@ -200,1 +204,1 @@\n-            census = CensusInstance.createCensusInstance(hostedRepositoryPool, bot.censusRepo(), bot.censusRef(), scratchPath.resolve(\"census\"), pr,\n+            census = CensusInstance.createCensusInstance(hostedRepositoryPool, bot.censusRepo(), bot.censusRef(), scratchArea.getCensus(), pr,\n@@ -212,1 +216,1 @@\n-            processCommand(pr, census, scratchPath.resolve(\"pr\").resolve(\"command\"), command, comments, false);\n+            processCommand(pr, census, scratchArea, command, comments, false);\n@@ -216,1 +220,1 @@\n-            processCommand(pr, census, scratchPath.resolve(\"pr\").resolve(\"command\"), command, comments, true);\n+            processCommand(pr, census, scratchArea, command, comments, true);\n","filename":"bots\/pr\/src\/main\/java\/org\/openjdk\/skara\/bots\/pr\/PullRequestCommandWorkItem.java","additions":14,"deletions":10,"binary":false,"changes":24,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2019, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2019, 2023, Oracle and\/or its affiliates. All rights reserved.\n@@ -125,1 +125,2 @@\n-        return prRun(scratchPath);\n+        ScratchArea scratchArea = new ScratchArea(scratchPath, bot.name());\n+        return prRun(scratchArea);\n@@ -138,1 +139,1 @@\n-    abstract Collection<WorkItem> prRun(Path scratchPath);\n+    abstract Collection<WorkItem> prRun(ScratchArea scratchArea);\n","filename":"bots\/pr\/src\/main\/java\/org\/openjdk\/skara\/bots\/pr\/PullRequestWorkItem.java","additions":4,"deletions":3,"binary":false,"changes":7,"status":"modified"},{"patch":"@@ -30,1 +30,0 @@\n-import java.nio.file.Path;\n@@ -34,0 +33,2 @@\n+import static org.openjdk.skara.bots.common.CommandNameEnum.reviewer;\n+\n@@ -70,1 +71,1 @@\n-    public void handle(PullRequestBot bot, PullRequest pr, CensusInstance censusInstance, Path scratchPath, CommandInvocation command, List<Comment> allComments, PrintWriter reply) {\n+    public void handle(PullRequestBot bot, PullRequest pr, CensusInstance censusInstance, ScratchArea scratchArea, CommandInvocation command, List<Comment> allComments, PrintWriter reply) {\n@@ -137,0 +138,5 @@\n+\n+    @Override\n+    public String name() {\n+        return reviewer.name();\n+    }\n","filename":"bots\/pr\/src\/main\/java\/org\/openjdk\/skara\/bots\/pr\/ReviewerCommand.java","additions":8,"deletions":2,"binary":false,"changes":10,"status":"modified"},{"patch":"@@ -29,1 +29,0 @@\n-import java.nio.file.Path;\n@@ -34,0 +33,1 @@\n+import static org.openjdk.skara.bots.common.CommandNameEnum.reviewers;\n@@ -78,1 +78,1 @@\n-    public void handle(PullRequestBot bot, PullRequest pr, CensusInstance censusInstance, Path scratchPath, CommandInvocation command, List<Comment> allComments, PrintWriter reply) {\n+    public void handle(PullRequestBot bot, PullRequest pr, CensusInstance censusInstance, ScratchArea scratchArea, CommandInvocation command, List<Comment> allComments, PrintWriter reply) {\n@@ -167,0 +167,5 @@\n+    @Override\n+    public String name() {\n+        return reviewers.name();\n+    }\n+\n","filename":"bots\/pr\/src\/main\/java\/org\/openjdk\/skara\/bots\/pr\/ReviewersCommand.java","additions":7,"deletions":2,"binary":false,"changes":9,"status":"modified"},{"patch":"@@ -0,0 +1,60 @@\n+\/*\n+ * Copyright (c) 2023, Oracle and\/or its affiliates. All rights reserved.\n+ * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+ *\n+ * This code is free software; you can redistribute it and\/or modify it\n+ * under the terms of the GNU General Public License version 2 only, as\n+ * published by the Free Software Foundation.\n+ *\n+ * This code is distributed in the hope that it will be useful, but WITHOUT\n+ * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+ * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+ * version 2 for more details (a copy is included in the LICENSE file that\n+ * accompanied this code).\n+ *\n+ * You should have received a copy of the GNU General Public License version\n+ * 2 along with this work; if not, write to the Free Software Foundation,\n+ * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n+ *\n+ * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n+ * or visit www.oracle.com if you need additional information or have any\n+ * questions.\n+ *\/\n+package org.openjdk.skara.bots.pr;\n+\n+import org.openjdk.skara.forge.HostedRepository;\n+\n+import java.nio.file.Path;\n+\n+public class ScratchArea {\n+    private final Path root;\n+    private final String botName;\n+\n+    public ScratchArea(Path root, String botName) {\n+        this.root = root;\n+        this.botName = botName;\n+    }\n+\n+    \/**\n+     *  Return a global repository path for this repository\n+     *\/\n+    public Path get(HostedRepository repo) {\n+        return root.resolve(botName).resolve(\"repos\").resolve(repo.name());\n+    }\n+\n+    \/**\n+     *  Return a path suitable for this command\n+     *\/\n+    public Path get(CommandHandler commandHandler) {\n+        return root.resolve(botName).resolve(\"command\").resolve(commandHandler.name());\n+    }\n+\n+    public Path getSeeds() {\n+        return root.resolve(\"seeds\");\n+    }\n+\n+    public Path getCensus() {\n+        return root.resolve(\"census\");\n+    }\n+\n+}\n","filename":"bots\/pr\/src\/main\/java\/org\/openjdk\/skara\/bots\/pr\/ScratchArea.java","additions":60,"deletions":0,"binary":false,"changes":60,"status":"added"},{"patch":"@@ -30,1 +30,0 @@\n-import java.nio.file.Path;\n@@ -36,0 +35,2 @@\n+import static org.openjdk.skara.bots.common.CommandNameEnum.sponsor;\n+\n@@ -40,1 +41,1 @@\n-    public void handle(PullRequestBot bot, PullRequest pr, CensusInstance censusInstance, Path scratchPath, CommandInvocation command, List<Comment> allComments, PrintWriter reply) {\n+    public void handle(PullRequestBot bot, PullRequest pr, CensusInstance censusInstance, ScratchArea scratchArea, CommandInvocation command, List<Comment> allComments, PrintWriter reply) {\n@@ -50,1 +51,1 @@\n-        Optional<Hash> prePushHash = IntegrateCommand.checkForPrePushHash(bot, pr, scratchPath, allComments, \"sponsor\");\n+        Optional<Hash> prePushHash = IntegrateCommand.checkForPrePushHash(bot, pr, scratchArea, allComments);\n@@ -97,1 +98,1 @@\n-            var localRepo = IntegrateCommand.materializeLocalRepo(bot, pr, scratchPath, \"sponsor\");\n+            var localRepo = IntegrateCommand.materializeLocalRepo(bot, pr, scratchArea);\n@@ -155,0 +156,5 @@\n+\n+    @Override\n+    public String name() {\n+        return sponsor.name();\n+    }\n","filename":"bots\/pr\/src\/main\/java\/org\/openjdk\/skara\/bots\/pr\/SponsorCommand.java","additions":10,"deletions":4,"binary":false,"changes":14,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2019, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2019, 2023, Oracle and\/or its affiliates. All rights reserved.\n@@ -29,1 +29,0 @@\n-import java.nio.file.Path;\n@@ -34,0 +33,2 @@\n+import static org.openjdk.skara.bots.common.CommandNameEnum.summary;\n+\n@@ -37,1 +38,1 @@\n-    public void handle(PullRequestBot bot, PullRequest pr, CensusInstance censusInstance, Path scratchPath, CommandInvocation command, List<Comment> allComments, PrintWriter reply) {\n+    public void handle(PullRequestBot bot, PullRequest pr, CensusInstance censusInstance, ScratchArea scratchArea, CommandInvocation command, List<Comment> allComments, PrintWriter reply) {\n@@ -85,0 +86,5 @@\n+    @Override\n+    public String name() {\n+        return summary.name();\n+    }\n+\n","filename":"bots\/pr\/src\/main\/java\/org\/openjdk\/skara\/bots\/pr\/SummaryCommand.java","additions":9,"deletions":3,"binary":false,"changes":12,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2021, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2021, 2023, Oracle and\/or its affiliates. All rights reserved.\n@@ -33,1 +33,0 @@\n-import java.nio.file.Path;\n@@ -37,0 +36,2 @@\n+import static org.openjdk.skara.bots.common.CommandNameEnum.tag;\n+\n@@ -47,0 +48,5 @@\n+    @Override\n+    public String name() {\n+        return tag.name();\n+    }\n+\n@@ -59,1 +65,1 @@\n-            Path scratchPath, CommandInvocation command, List<Comment> allComments, PrintWriter reply) {\n+            ScratchArea scratchArea, CommandInvocation command, List<Comment> allComments, PrintWriter reply) {\n@@ -86,2 +92,2 @@\n-            var localRepoDir = scratchPath.resolve(\"tag-command\")\n-                                          .resolve(bot.repo().name());\n+            var localRepoDir = scratchArea.get(this)\n+                    .resolve(bot.repo().name());\n","filename":"bots\/pr\/src\/main\/java\/org\/openjdk\/skara\/bots\/pr\/TagCommand.java","additions":11,"deletions":5,"binary":false,"changes":16,"status":"modified"},{"patch":"@@ -2652,1 +2652,1 @@\n-                checkWorkItem.prRun(scratchFolder.path());\n+                checkWorkItem.prRun(new ScratchArea(scratchFolder.path(), checkBot.name()));\n@@ -2660,1 +2660,1 @@\n-                checkWorkItem.prRun(scratchFolder.path());\n+                checkWorkItem.prRun(new ScratchArea(scratchFolder.path(), checkBot.name()));\n","filename":"bots\/pr\/src\/test\/java\/org\/openjdk\/skara\/bots\/pr\/CheckTests.java","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"}]}