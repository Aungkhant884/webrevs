{"files":[{"patch":"@@ -52,2 +52,2 @@\n-        if (!censusInstance.isReviewer(command.user())) {\n-            reply.println(\"Only [Reviewers](https:\/\/openjdk.java.net\/bylaws#reviewer) are allowed to change the number of required reviewers.\");\n+        if (!pr.author().equals(command.user()) && !censusInstance.isReviewer(command.user())) {\n+            reply.println(\"Only the author of the pull request or [Reviewers](https:\/\/openjdk.java.net\/bylaws#reviewer) are allowed to change the number of required reviewers.\");\n","filename":"bots\/pr\/src\/main\/java\/org\/openjdk\/skara\/bots\/pr\/ReviewersCommand.java","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -31,0 +31,1 @@\n+import java.util.List;\n@@ -253,0 +254,34 @@\n+\n+    @Test\n+    void prAuthorShouldBeAllowedToExecute(TestInfo testInfo) throws IOException {\n+        try (var credentials = new HostCredentials(testInfo);\n+             var tempFolder = new TemporaryDirectory()) {\n+            var author = credentials.getHostedRepository();\n+            var bot = credentials.getHostedRepository();\n+\n+            var censusBuilder = credentials.getCensusBuilder()\n+                                           .addCommitter(author.forge().currentUser().id());\n+            var prBot = PullRequestBot.newBuilder().repo(bot).censusRepo(censusBuilder.build()).build();\n+\n+            \/\/ Populate the projects repository\n+            var localRepoFolder = tempFolder.path().resolve(\"localrepo\");\n+            var localRepo = CheckableRepository.init(localRepoFolder, author.repositoryType());\n+            var masterHash = localRepo.resolve(\"master\").orElseThrow();\n+            assertFalse(CheckableRepository.hasBeenEdited(localRepo));\n+            localRepo.push(masterHash, author.url(), \"master\", true);\n+\n+            \/\/ Make a change with a corresponding PR\n+            var editHash = CheckableRepository.appendAndCommit(localRepo);\n+            localRepo.push(editHash, author.url(), \"edit\", true);\n+            var pr = credentials.createPullRequest(author, \"master\", \"edit\", \"123: This is a pull request\");\n+\n+            var authorPR = author.pullRequest(pr.id());\n+\n+            \/\/ The author deems that two reviewers are required\n+            authorPR.addComment(\"\/reviewers 2\");\n+\n+            \/\/ The bot should reply with a success message\n+            TestBotRunner.runPeriodicItems(prBot);\n+            assertLastCommentContains(authorPR,\"The number of required reviews for this PR is now set to 2 (with at least 1 of role reviewers).\");\n+        }\n+    }\n","filename":"bots\/pr\/src\/test\/java\/org\/openjdk\/skara\/bots\/pr\/ReviewersTests.java","additions":35,"deletions":0,"binary":false,"changes":35,"status":"modified"}]}