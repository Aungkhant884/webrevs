{"files":[{"patch":"@@ -78,3 +78,4 @@\n-                                              config.get(\"log\").get(\"slack\").get(\"username\").asString(),\n-                                              maxRate,\n-                                              details);\n+                    config.get(\"log\").get(\"slack\").get(\"username\").asString(),\n+                    config.get(\"log\").get(\"slack\").get(\"configname\").asString(),\n+                    maxRate,\n+                    details);\n","filename":"bots\/cli\/src\/main\/java\/org\/openjdk\/skara\/bots\/cli\/BotLauncher.java","additions":4,"deletions":3,"binary":false,"changes":7,"status":"modified"},{"patch":"@@ -41,0 +41,1 @@\n+    private final String configName;\n@@ -47,1 +48,1 @@\n-    BotSlackHandler(URI webhookUrl, String username, Duration minimumSeparation, Map<String, String> links) {\n+    BotSlackHandler(URI webhookUrl, String username, String configName, Duration minimumSeparation, Map<String, String> links) {\n@@ -50,0 +51,1 @@\n+        this.configName = configName;\n@@ -120,1 +122,1 @@\n-                            .map(record -> \"`\" + record.getLevel().getName() + \"` \" + record.getMessage())\n+                            .map(this::formatMessage)\n@@ -131,2 +133,10 @@\n-        var message = \"`\" + record.getLevel().getName() + \"` \" + record.getMessage();\n-        publishToSlack(message);\n+        publishToSlack(formatMessage(record));\n+    }\n+\n+    private String formatMessage(LogRecord record) {\n+        var message = new StringBuilder();\n+        if (configName != null) {\n+            message.append(\"`\").append(configName).append(\"` \");\n+        }\n+        message.append(\"`\").append(record.getLevel().getName()).append(\"` \").append(record.getMessage());\n+        return message.toString();\n","filename":"bots\/cli\/src\/main\/java\/org\/openjdk\/skara\/bots\/cli\/BotSlackHandler.java","additions":14,"deletions":4,"binary":false,"changes":18,"status":"modified"},{"patch":"@@ -48,1 +48,1 @@\n-            var handler = new BotSlackHandler(receiver.getEndpoint(), \"test\", Duration.ofSeconds(1), new HashMap<>());\n+            var handler = new BotSlackHandler(receiver.getEndpoint(), \"test\", \"testc\", Duration.ofSeconds(1), new HashMap<>());\n@@ -55,1 +55,16 @@\n-            assertTrue(requests.get(0).get(\"text\").asString().contains(\"Hello\"));\n+            assertEquals(\"`testc` `INFO` Hello\", requests.get(0).get(\"text\").asString());\n+        }\n+    }\n+\n+    @Test\n+    void noUser() throws IOException {\n+\n+        try (var receiver = new RestReceiver()) {\n+            var handler = new BotSlackHandler(receiver.getEndpoint(), null, null, Duration.ofSeconds(1), new HashMap<>());\n+            var record = new LogRecord(Level.INFO, \"Hello\");\n+            handler.publish(record);\n+\n+            var requests = receiver.getRequests();\n+            assertEquals(1, requests.size(), requests.toString());\n+            assertNull(requests.get(0).get(\"username\"));\n+            assertEquals(\"`INFO` Hello\", requests.get(0).get(\"text\").asString());\n@@ -63,1 +78,1 @@\n-            var handler = new BotSlackHandler(receiver.getEndpoint(), \"test\", maxDuration, new HashMap<>());\n+            var handler = new BotSlackHandler(receiver.getEndpoint(), \"test\", null, maxDuration, new HashMap<>());\n@@ -99,1 +114,1 @@\n-            var handler = new BotSlackHandler(receiver.getEndpoint(), \"test\", Duration.ofMillis(1), new HashMap<>());\n+            var handler = new BotSlackHandler(receiver.getEndpoint(), \"test\", null, Duration.ofMillis(1), new HashMap<>());\n@@ -120,1 +135,1 @@\n-            var handler = new BotSlackHandler(receiver.getEndpoint(), \"test\", Duration.ofMillis(1), details);\n+            var handler = new BotSlackHandler(receiver.getEndpoint(), \"test\", null, Duration.ofMillis(1), details);\n@@ -142,1 +157,1 @@\n-            var handler = new BotSlackHandler(receiver.getEndpoint(), \"test\", Duration.ofMillis(1), details);\n+            var handler = new BotSlackHandler(receiver.getEndpoint(), \"test\", null, Duration.ofMillis(1), details);\n@@ -159,1 +174,1 @@\n-            var handler = new BotSlackHandler(receiver.getEndpoint(), \"test\", Duration.ZERO, new HashMap<>());\n+            var handler = new BotSlackHandler(receiver.getEndpoint(), \"test\", null, Duration.ZERO, new HashMap<>());\n@@ -179,1 +194,1 @@\n-            var handler = new BotSlackHandler(receiver.getEndpoint(), \"test\", Duration.ZERO, details);\n+            var handler = new BotSlackHandler(receiver.getEndpoint(), \"test\", null, Duration.ZERO, details);\n","filename":"bots\/cli\/src\/test\/java\/org\/openjdk\/skara\/bots\/cli\/BotSlackHandlerTests.java","additions":23,"deletions":8,"binary":false,"changes":31,"status":"modified"}]}