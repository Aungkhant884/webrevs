{"files":[{"patch":"@@ -40,0 +40,1 @@\n+    private final String token;\n@@ -42,1 +43,1 @@\n-    private ProfileHandler(Path configurationPath, int maxDuration) {\n+    private ProfileHandler(Path configurationPath, int maxDuration, String token) {\n@@ -45,0 +46,1 @@\n+        this.token = token;\n@@ -111,0 +113,21 @@\n+        var authHeader = exchange.getRequestHeaders().getFirst(\"Authorization\");\n+        if (authHeader == null) {\n+            log.log(Level.WARNING, \"Authorization HTTP header missing\");\n+            exchange.sendResponseHeaders(401, 0);\n+            exchange.getResponseBody().close();\n+            return;\n+        }\n+        var authParts = authHeader.split(\" \");\n+        if (authParts.length != 2 || !authParts[0].equals(\"token\")) {\n+            log.log(Level.WARNING, \"Authorization HTTP header has wrong format\");\n+            exchange.sendResponseHeaders(401, 0);\n+            exchange.getResponseBody().close();\n+            return;\n+        }\n+        if (!authParts[1].equals(token)) {\n+            log.log(Level.WARNING, \"Wrong authorization token: \" + authParts[1]);\n+            exchange.sendResponseHeaders(401, 0);\n+            exchange.getResponseBody().close();\n+            return;\n+        }\n+\n@@ -123,1 +146,2 @@\n-        return new ProfileHandler(configurationPath, maxDuration);\n+        var token = configuration.get(\"token\").asString();\n+        return new ProfileHandler(configurationPath, maxDuration, token);\n","filename":"bot\/src\/main\/java\/org\/openjdk\/skara\/bot\/ProfileHandler.java","additions":26,"deletions":2,"binary":false,"changes":28,"status":"modified"}]}