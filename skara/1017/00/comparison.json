{"files":[{"patch":"@@ -35,0 +35,1 @@\n+import java.util.function.Consumer;\n@@ -39,0 +40,1 @@\n+    private final Consumer<RuntimeException> onError;\n@@ -73,1 +75,1 @@\n-    CommitCommandWorkItem(PullRequestBot bot, CommitComment commitComment) {\n+    CommitCommandWorkItem(PullRequestBot bot, CommitComment commitComment, Consumer<RuntimeException> onError) {\n@@ -76,0 +78,1 @@\n+        this.onError = onError;\n@@ -165,0 +168,5 @@\n+\n+    @Override\n+    public void handleRuntimeException(RuntimeException e) {\n+        onError.accept(e);\n+    }\n","filename":"bots\/pr\/src\/main\/java\/org\/openjdk\/skara\/bots\/pr\/CommitCommandWorkItem.java","additions":9,"deletions":1,"binary":false,"changes":10,"status":"modified"},{"patch":"@@ -174,1 +174,3 @@\n-            ret.add(new CommitCommandWorkItem(this, commitComment));\n+            processedCommitComments.add(commitComment.id());\n+            ret.add(new CommitCommandWorkItem(this, commitComment,\n+                                              e -> processedCommitComments.remove(commitComment.id())));\n@@ -183,2 +185,0 @@\n-        List<CommitComment> commitComments = List.of();\n-\n@@ -194,8 +194,4 @@\n-        commitComments = remoteRepo.recentCommitComments().stream()\n-                                   .filter(cc -> !processedCommitComments.contains(cc.id()))\n-                                   .collect(Collectors.toList());\n-        if (!commitComments.isEmpty()) {\n-            processedCommitComments.addAll(commitComments.stream()\n-                                                         .map(Comment::id)\n-                                                         .collect(Collectors.toList()));\n-        }\n+        var commitComments = remoteRepo.recentCommitComments()\n+                                       .stream()\n+                                       .filter(cc -> !processedCommitComments.contains(cc.id()))\n+                                       .collect(Collectors.toList());\n","filename":"bots\/pr\/src\/main\/java\/org\/openjdk\/skara\/bots\/pr\/PullRequestBot.java","additions":7,"deletions":11,"binary":false,"changes":18,"status":"modified"}]}