{"files":[{"patch":"@@ -99,3 +99,0 @@\n-            if (includeTags && !branchPatterns.isEmpty()) {\n-                throw new IllegalStateException(\"Cannot include tags with only selected branches (tags are *not* per branch)\");\n-            }\n","filename":"bots\/mirror\/src\/main\/java\/org\/openjdk\/skara\/bots\/mirror\/MirrorBotFactory.java","additions":0,"deletions":3,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -155,27 +155,0 @@\n-    @Test\n-    public void testThrowsWithBranchesAndTagsIncluded() {\n-        try (var tempFolder = new TemporaryDirectory()) {\n-            String jsonString = \"\"\"\n-                    {\n-                      \"repositories\": [\n-                        {\n-                          \"from\": \"from1\",\n-                          \"to\": \"to1\",\n-                          \"branches\": \"master\",\n-                          \"tags\": \"include\"\n-                        }\n-                      ]\n-                    }\n-                    \"\"\";\n-            var jsonConfig = JWCC.parse(jsonString).asObject();\n-\n-            var testBotFactory = TestBotFactory.newBuilder()\n-                    .addHostedRepository(\"from1\", new TestHostedRepository(\"from1\"))\n-                    .addHostedRepository(\"to1\", new TestHostedRepository(\"to1\"))\n-                    .storagePath(tempFolder.path().resolve(\"storage\"))\n-                    .build();\n-\n-            assertThrows(IllegalStateException.class, () -> testBotFactory.createBots(MirrorBotFactory.NAME, jsonConfig));\n-        }\n-    }\n-\n@@ -212,0 +185,6 @@\n+                        {\n+                          \"from\": \"from6\",\n+                          \"to\": \"to6\",\n+                          \"branches\": [\"master\", \"dev\"],\n+                          \"tags\": \"include\"\n+                        },\n@@ -223,0 +202,1 @@\n+                    .addHostedRepository(\"from6\", new TestHostedRepository(\"from6\"))\n@@ -228,0 +208,1 @@\n+                    .addHostedRepository(\"to6\", new TestHostedRepository(\"to6\"))\n@@ -232,1 +213,1 @@\n-            assertEquals(5, bots.size());\n+            assertEquals(6, bots.size());\n@@ -265,0 +246,7 @@\n+\n+            MirrorBot mirrorBot6 = (MirrorBot) bots.get(5);\n+            assertEquals(\"MirrorBot@from6->to6 (master,dev) [tags included]\", mirrorBot6.toString());\n+            assertTrue(mirrorBot6.isIncludeTags());\n+            assertFalse(mirrorBot6.isOnlyTags());\n+            assertEquals(List.of(\"master\", \"dev\"),\n+                         mirrorBot6.getBranchPatterns().stream().map(Pattern::toString).toList());\n","filename":"bots\/mirror\/src\/test\/java\/org\/openjdk\/skara\/bots\/mirror\/MirrorBotFactoryTest.java","additions":16,"deletions":28,"binary":false,"changes":44,"status":"modified"}]}