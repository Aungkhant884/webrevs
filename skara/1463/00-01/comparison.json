{"files":[{"patch":"@@ -77,2 +77,0 @@\n-    private Optional<JdkVersion> versionOpt;\n-\n@@ -123,1 +121,1 @@\n-    private List<Issue> issues(boolean withCsr, boolean withJep) {\n+    private List<Issue> issues() {\n@@ -129,6 +127,9 @@\n-            if (withCsr) {\n-                issues.addAll(getCsrIssues(issues));\n-            }\n-            if (withJep) {\n-                getJepIssue().ifPresent(issues::add);\n-            }\n+            return issues;\n+        }\n+        return List.of();\n+    }\n+\n+    private List<Issue> issuesWithCSRAndJEP(List<Issue> issues, List<org.openjdk.skara.issuetracker.Issue> csrIssueTrackerIssues) {\n+        if (!issues.isEmpty()) {\n+            issues.addAll(getCsrIssues(csrIssueTrackerIssues));\n+            getJepIssue().ifPresent(issues::add);\n@@ -143,1 +144,1 @@\n-    private List<org.openjdk.skara.issuetracker.Issue> getCsrIssueTrackerIssues(List<Issue> issues) {\n+    private List<org.openjdk.skara.issuetracker.Issue> getCsrIssueTrackerIssues(List<Issue> issues, JdkVersion version) {\n@@ -148,2 +149,1 @@\n-        versionOpt = BotUtils.getVersion(pr);\n-        if (versionOpt.isEmpty()) {\n+        if (version == null) {\n@@ -158,1 +158,1 @@\n-            Backports.findCsr(jbsIssueOpt.get(), versionOpt.get())\n+            Backports.findCsr(jbsIssueOpt.get(), version)\n@@ -167,1 +167,1 @@\n-    private List<Issue> getCsrIssues(List<Issue> issues) {\n+    private List<Issue> getCsrIssues(List<org.openjdk.skara.issuetracker.Issue> CsrIssueTrackerIssues) {\n@@ -169,1 +169,1 @@\n-        return getCsrIssueTrackerIssues(issues).stream()\n+        return CsrIssueTrackerIssues.stream()\n@@ -268,1 +268,1 @@\n-    private Map<String, Boolean> botSpecificProgresses() {\n+    private Map<String, Boolean> botSpecificProgresses(List<org.openjdk.skara.issuetracker.Issue> csrIssueTrackerIssues, JdkVersion version) {\n@@ -271,1 +271,1 @@\n-        var csrIssues = getCsrIssueTrackerIssues(issues(false, false)).stream()\n+        var csrIssues = csrIssueTrackerIssues.stream()\n@@ -277,1 +277,1 @@\n-            ret.put(\"Change requires a CSR request matching fixVersion \" + (versionOpt.isPresent() ? versionOpt.get().raw() : \"(No fixVersion in .jcheck\/conf)\")\n+            ret.put(\"Change requires a CSR request matching fixVersion \" + (version != null ? version.raw() : \"(No fixVersion in .jcheck\/conf)\")\n@@ -325,1 +325,1 @@\n-    private List<String> botSpecificIntegrationBlockers() {\n+    private List<String> botSpecificIntegrationBlockers(List<Issue> issues) {\n@@ -328,1 +328,0 @@\n-        var issues = issues(false, false);\n@@ -617,1 +616,1 @@\n-                                    List<String> integrationBlockers, boolean reviewNeeded) {\n+                                    List<String> integrationBlockers, boolean reviewNeeded, List<Issue> allIssues) {\n@@ -644,1 +643,0 @@\n-        var issues = issues(true, true);\n@@ -646,1 +644,1 @@\n-        if (issueProject != null && !issues.isEmpty()) {\n+        if (issueProject != null && !allIssues.isEmpty()) {\n@@ -648,1 +646,1 @@\n-            if (issues.size() > 1) {\n+            if (allIssues.size() > 1) {\n@@ -652,1 +650,1 @@\n-            for (var currentIssue : issues) {\n+            for (var currentIssue : allIssues) {\n@@ -1128,0 +1126,6 @@\n+\n+            var version = BotUtils.getVersion(pr).orElse(null);\n+            \/\/ issues without CSR issues and JEP issues\n+            var issues = issues();\n+            var csrIssueTrackerIssues = getCsrIssueTrackerIssues(issues, version);\n+\n@@ -1156,1 +1160,1 @@\n-                additionalProgresses = botSpecificProgresses();\n+                additionalProgresses = botSpecificProgresses(csrIssueTrackerIssues, version);\n@@ -1161,1 +1165,1 @@\n-            var integrationBlockers = botSpecificIntegrationBlockers();\n+            var integrationBlockers = botSpecificIntegrationBlockers(issues);\n@@ -1167,1 +1171,1 @@\n-            var statusMessage = getStatusMessage(visitor, additionalErrors, additionalProgresses, integrationBlockers, reviewNeeded);\n+            var statusMessage = getStatusMessage(visitor, additionalErrors, additionalProgresses, integrationBlockers, reviewNeeded, issuesWithCSRAndJEP(issues, csrIssueTrackerIssues));\n","filename":"bots\/pr\/src\/main\/java\/org\/openjdk\/skara\/bots\/pr\/CheckRun.java","additions":32,"deletions":28,"binary":false,"changes":60,"status":"modified"}]}