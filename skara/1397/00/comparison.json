{"files":[{"patch":"@@ -101,0 +101,5 @@\n+            if (logstashConf.contains(\"replacements\")) {\n+                for (var field : logstashConf.get(\"replacements\").asArray()) {\n+                    handler.addReplacement(field.get(\"pattern\").asString(), field.get(\"replacement\").asString());\n+                }\n+            }\n","filename":"bots\/cli\/src\/main\/java\/org\/openjdk\/skara\/bots\/cli\/BotLauncher.java","additions":5,"deletions":0,"binary":false,"changes":5,"status":"modified"},{"patch":"@@ -50,0 +50,4 @@\n+    private record RegexReplacement(Pattern pattern, String replacement) {}\n+\n+    private final List<RegexReplacement> regexReplacements = new ArrayList<>();\n+\n@@ -84,0 +88,4 @@\n+    void addReplacement(String pattern, String replacement) {\n+        regexReplacements.add(new RegexReplacement(Pattern.compile(pattern), replacement));\n+    }\n+\n@@ -100,0 +108,14 @@\n+    private String applyReplacements(String s) {\n+        CharSequence ret = s;\n+        for (RegexReplacement regexReplacement : regexReplacements) {\n+            var matcher = regexReplacement.pattern.matcher(ret);\n+            var sb = new StringBuilder();\n+            while (matcher.find()) {\n+                matcher.appendReplacement(sb, regexReplacement.replacement);\n+            }\n+            matcher.appendTail(sb);\n+            ret = sb;\n+        }\n+        return ret.toString();\n+    }\n+\n@@ -110,1 +132,1 @@\n-        query.put(\"message\", record.getMessage());\n+        query.put(\"message\", applyReplacements(record.getMessage()));\n","filename":"bots\/cli\/src\/main\/java\/org\/openjdk\/skara\/bots\/cli\/BotLogstashHandler.java","additions":23,"deletions":1,"binary":false,"changes":24,"status":"modified"}]}