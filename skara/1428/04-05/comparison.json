{"files":[{"patch":"@@ -241,0 +241,1 @@\n+        var revFlag = arguments.contains(\"rev\");\n@@ -242,4 +243,14 @@\n-        var working_tree = arguments.contains(\"working-tree\");\n-        \/\/ These two flags are mutually exclusive\n-        if (staged && working_tree) {\n-            System.err.println(String.format(\"error: can only use one of --staged or --working-tree\"));\n+        var workingTree = arguments.contains(\"working-tree\");\n+        int flagCount = 0;\n+        if (revFlag) {\n+            flagCount++;\n+        }\n+        if (staged) {\n+            flagCount++;\n+        }\n+        if (workingTree) {\n+            flagCount++;\n+        }\n+        \/\/ These three flags are mutually exclusive\n+        if (flagCount > 1) {\n+            System.err.println(String.format(\"error: can only use one of --staged, --working-tree or --rev\"));\n@@ -267,1 +278,1 @@\n-        \/\/ This four flags are mutually exclusive\n+        \/\/ These four flags are mutually exclusive\n@@ -269,2 +280,2 @@\n-            System.err.println(String.format(\"error: you can only choose one from using jcheck \" +\n-                    \"configuration in work space or in a specified commit\"));\n+            System.err.println(String.format(\"error: can only use one of --conf-rev, --conf-staged, \" +\n+                    \"--conf-working-tree or --conf-file\"));\n@@ -277,0 +288,4 @@\n+            if (rev == null || rev.startsWith(\"--\")) {\n+                System.err.println(String.format(\"error: must enter rev after --conf-rev\"));\n+                return 1;\n+            }\n@@ -291,1 +306,1 @@\n-            var content = repo.stagedFile(Path.of(\".jcheck\/conf\"));\n+            var content = repo.stagedFileContents(Path.of(\".jcheck\/conf\"));\n@@ -304,1 +319,1 @@\n-        else if (confFile || confWorkingTree || working_tree) {\n+        else if (confFile || confWorkingTree || workingTree) {\n@@ -323,1 +338,1 @@\n-        if (working_tree) {\n+        if (workingTree) {\n@@ -336,0 +351,3 @@\n+            } catch (Exception e) {\n+                System.err.println(String.format(\"error: exception thrown during jcheck: %s\", e.getMessage()));\n+                return 1;\n","filename":"cli\/src\/main\/java\/org\/openjdk\/skara\/cli\/GitJCheck.java","additions":28,"deletions":10,"binary":false,"changes":38,"status":"modified"},{"patch":"@@ -357,1 +357,1 @@\n-    public Optional<List<String>> stagedFile(Path p) {\n+    public Optional<List<String>> stagedFileContents(Path p) {\n","filename":"jcheck\/src\/test\/java\/org\/openjdk\/skara\/jcheck\/TestRepository.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -180,1 +180,1 @@\n-    Optional<List<String>> stagedFile(Path p);\n+    Optional<List<String>> stagedFileContents(Path p);\n","filename":"vcs\/src\/main\/java\/org\/openjdk\/skara\/vcs\/ReadOnlyRepository.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -1018,0 +1018,5 @@\n+    private Optional<String> email() throws IOException {\n+        var lines = config(\"user.email\");\n+        return lines.size() == 1 ? Optional.of(lines.get(0)) : Optional.empty();\n+    }\n+\n@@ -1684,0 +1689,1 @@\n+\n@@ -1689,1 +1695,1 @@\n-        var author = new Author(\"jcheck\", \"jcheck@none.none\");\n+        var author = new Author(username().orElse(\"jcheck\"), email().orElse(\"jcheck@none.none\"));\n@@ -1694,0 +1700,1 @@\n+\n@@ -1699,1 +1706,1 @@\n-        var author = new Author(\"jcheck\", \"jcheck@none.none\");\n+        var author = new Author(username().orElse(\"jcheck\"), email().orElse(\"jcheck@none.none\"));\n","filename":"vcs\/src\/main\/java\/org\/openjdk\/skara\/vcs\/git\/GitRepository.java","additions":9,"deletions":2,"binary":false,"changes":11,"status":"modified"},{"patch":"@@ -1518,1 +1518,1 @@\n-    public Optional<List<String>> stagedFile(Path p) {\n+    public Optional<List<String>> stagedFileContents(Path p) {\n","filename":"vcs\/src\/main\/java\/org\/openjdk\/skara\/vcs\/hg\/HgRepository.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"}]}