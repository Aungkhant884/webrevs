{"files":[{"patch":"@@ -69,4 +69,2 @@\n-    private static JCheckConfiguration configuration(HostedRepositoryPool hostedRepositoryPool, HostedRepository remoteRepo, String name, String ref) throws IOException {\n-        var confFile = hostedRepositoryPool.lines(remoteRepo, Path.of(name), ref).orElseThrow(\n-                () -> new IOException(\"Failed to read jcheck configuration from \" + name + \":\" + ref));\n-        return JCheckConfiguration.parse(confFile);\n+    private static Optional<JCheckConfiguration> configuration(HostedRepositoryPool hostedRepositoryPool, HostedRepository remoteRepo, String name, String ref) throws IOException {\n+        return hostedRepositoryPool.lines(remoteRepo, Path.of(name), ref).map(JCheckConfiguration::parse);\n@@ -75,1 +73,1 @@\n-    static CensusInstance create(HostedRepositoryPool hostedRepositoryPool,\n+    static Optional<CensusInstance> create(HostedRepositoryPool hostedRepositoryPool,\n@@ -82,1 +80,1 @@\n-    static CensusInstance create(HostedRepositoryPool hostedRepositoryPool,\n+    static Optional<CensusInstance> create(HostedRepositoryPool hostedRepositoryPool,\n@@ -94,1 +92,1 @@\n-            JCheckConfiguration configuration;\n+            Optional<JCheckConfiguration> configuration;\n@@ -103,0 +101,3 @@\n+            if (configuration.isEmpty()) {\n+                return Optional.empty();\n+            }\n@@ -104,1 +105,1 @@\n-            var project = project(configuration, census);\n+            var project = project(configuration.get(), census);\n@@ -106,1 +107,1 @@\n-            return new CensusInstance(census, configuration, project, namespace);\n+            return Optional.of(new CensusInstance(census, configuration.get(), project, namespace));\n","filename":"bots\/pr\/src\/main\/java\/org\/openjdk\/skara\/bots\/pr\/CensusInstance.java","additions":10,"deletions":9,"binary":false,"changes":19,"status":"modified"},{"patch":"@@ -216,1 +216,1 @@\n-                                           bot.confOverrideRepository().orElse(null), bot.confOverrideName(), bot.confOverrideRef());\n+                                           bot.confOverrideRepository().orElse(null), bot.confOverrideName(), bot.confOverrideRef()).orElseThrow();\n","filename":"bots\/pr\/src\/main\/java\/org\/openjdk\/skara\/bots\/pr\/CheckWorkItem.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -153,5 +153,0 @@\n-        var census = CensusInstance.create(hostedRepositoryPool, bot.censusRepo(), bot.censusRef(),\n-                                           scratchPath.resolve(\"census\"), bot.repo(), commit.hash().hex(),\n-                                           bot.confOverrideRepository().orElse(null),\n-                                           bot.confOverrideName(),\n-                                           bot.confOverrideRef());\n@@ -160,1 +155,0 @@\n-\n@@ -164,1 +158,16 @@\n-            processCommand(scratchPath, commit, census, nextCommand.get(), allComments);\n+            var census = CensusInstance.create(hostedRepositoryPool, bot.censusRepo(), bot.censusRef(),\n+                                               scratchPath.resolve(\"census\"), bot.repo(), commit.hash().hex(),\n+                                               bot.confOverrideRepository().orElse(null),\n+                                               bot.confOverrideName(),\n+                                               bot.confOverrideRef());\n+            var command = nextCommand.get();\n+            if (census.isEmpty()) {\n+                var writer = new StringWriter();\n+                var printer = new PrintWriter(writer);\n+                printer.println(String.format(commandReplyMarker, command.id()));\n+                printer.println(\"@\" + command.user().username() +\n+                                \" there is no `.jcheck\/conf` present at revision \" +\n+                                commit.hash().abbreviate() + \" - cannot process command.\");\n+            } else {\n+                processCommand(scratchPath, commit, census.get(), command, allComments);\n+            }\n","filename":"bots\/pr\/src\/main\/java\/org\/openjdk\/skara\/bots\/pr\/CommitCommandWorkItem.java","additions":16,"deletions":7,"binary":false,"changes":23,"status":"modified"},{"patch":"@@ -220,1 +220,1 @@\n-                                           bot.confOverrideRepository().orElse(null), bot.confOverrideName(), bot.confOverrideRef());\n+                                           bot.confOverrideRepository().orElse(null), bot.confOverrideName(), bot.confOverrideRef()).orElseThrow();\n","filename":"bots\/pr\/src\/main\/java\/org\/openjdk\/skara\/bots\/pr\/PullRequestCommandWorkItem.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"}]}