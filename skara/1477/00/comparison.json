{"files":[{"patch":"@@ -49,0 +49,2 @@\n+    \/\/ Should this class handle log level filtering or leave that to the subclass\n+    private final boolean filterOnLevel;\n@@ -50,1 +52,2 @@\n-    public BotTaskAggregationHandler() {\n+    public BotTaskAggregationHandler(boolean filterOnLevel) {\n+        this.filterOnLevel = filterOnLevel;\n@@ -79,1 +82,3 @@\n-                    publishSingle(record);\n+                    if (!filterOnLevel || record.getLevel().intValue() >= getLevel().intValue()) {\n+                        publishSingle(record);\n+                    }\n@@ -84,1 +89,3 @@\n-            threadEntry.logs.add(record);\n+            if (!filterOnLevel || record.getLevel().intValue() >= getLevel().intValue()) {\n+                threadEntry.logs.add(record);\n+            }\n","filename":"bot\/src\/main\/java\/org\/openjdk\/skara\/bot\/BotTaskAggregationHandler.java","additions":10,"deletions":3,"binary":false,"changes":13,"status":"modified"},{"patch":"@@ -41,0 +41,1 @@\n+        super(false);\n","filename":"bot\/src\/test\/java\/org\/openjdk\/skara\/bot\/BotTaskAggregationHandlerTests.java","additions":1,"deletions":0,"binary":false,"changes":1,"status":"modified"},{"patch":"@@ -49,0 +49,1 @@\n+        super(true);\n@@ -111,11 +112,1 @@\n-        var maxLevel = task.stream()\n-                           .map(record -> record.getLevel().intValue())\n-                           .max(Integer::compareTo)\n-                           .orElseThrow();\n-\n-        if (maxLevel < getLevel().intValue()) {\n-            return;\n-        }\n-\n-        var important = task.stream()\n-                            .filter(record -> record.getLevel().intValue() >= getLevel().intValue())\n+        var message = task.stream()\n@@ -124,1 +115,3 @@\n-        publishToSlack(important);\n+        if (!message.isEmpty()) {\n+            publishToSlack(message);\n+        }\n@@ -129,4 +122,0 @@\n-        if (record.getLevel().intValue() < getLevel().intValue()) {\n-            return;\n-        }\n-\n","filename":"bots\/cli\/src\/main\/java\/org\/openjdk\/skara\/bots\/cli\/BotSlackHandler.java","additions":5,"deletions":16,"binary":false,"changes":21,"status":"modified"}]}