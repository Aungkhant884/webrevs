{"files":[{"patch":"@@ -59,3 +59,2 @@\n-  int offset = other._offset;\n-  if (_offset == OffsetTop) return Offset(offset);\n-  if (offset == OffsetTop) return Offset(_offset);\n+  if (_offset == OffsetTop) return other;\n+  if (other._offset == OffsetTop) return *this;\n@@ -63,1 +62,1 @@\n-  if (_offset != offset) return bottom;\n+  if (_offset != other._offset) return bottom;\n@@ -4990,1 +4989,7 @@\n-  return make(ptr(), const_oop(), new_ary, klass(), klass_is_exact(), _offset, _field_offset, _instance_id, _speculative, _inline_depth, _is_autobox_cache);\n+  const TypeAryPtr* res = make(ptr(), const_oop(), new_ary, klass(), klass_is_exact(), _offset, _field_offset, _instance_id, _speculative, _inline_depth, _is_autobox_cache);\n+  \/\/ We keep the speculative part if it contains information about flat-\/nullability.\n+  \/\/ Make sure it's removed if it's not better than the non-speculative type anymore.\n+  if (res->speculative() == res->remove_speculative()) {\n+    return res->remove_speculative();\n+  }\n+  return res;\n@@ -5002,0 +5007,2 @@\n+  \/\/ We keep the speculative part if it contains information about flat-\/nullability.\n+  \/\/ Make sure it's removed if it's not better than the non-speculative type anymore.\n@@ -5209,1 +5216,1 @@\n-        field_off = Offset::bottom;\n+        field_off = (field_off == Offset::top) ? Offset::top : Offset::bottom;\n","filename":"src\/hotspot\/share\/opto\/type.cpp","additions":13,"deletions":6,"binary":false,"changes":19,"status":"modified"}]}