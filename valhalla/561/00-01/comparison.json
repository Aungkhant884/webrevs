{"files":[{"patch":"@@ -138,6 +138,14 @@\n-        kill_dead_locals();\n-        Node* call = make_runtime_call(RC_NO_LEAF | RC_NO_IO,\n-                                       OptoRuntime::load_unknown_inline_type(),\n-                                       OptoRuntime::load_unknown_inline_Java(),\n-                                       NULL, TypeRawPtr::BOTTOM,\n-                                       ary, idx);\n+        Node* call = NULL;\n+        {\n+          \/\/ Re-execute flattened array load if runtime call triggers deoptimization\n+          PreserveReexecuteState preexecs(this);\n+          jvms()->set_bci(_bci);\n+          jvms()->set_should_reexecute(true);\n+          inc_sp(2);\n+          kill_dead_locals();\n+          call = make_runtime_call(RC_NO_LEAF | RC_NO_IO,\n+                                   OptoRuntime::load_unknown_inline_type(),\n+                                   OptoRuntime::load_unknown_inline_Java(),\n+                                   NULL, TypeRawPtr::BOTTOM,\n+                                   ary, idx);\n+        }\n","filename":"src\/hotspot\/share\/opto\/parse2.cpp","additions":14,"deletions":6,"binary":false,"changes":20,"status":"modified"}]}