{"files":[{"patch":"@@ -1171,1 +1171,1 @@\n-  if (EnableValhalla) {\n+  if (EnablePrimitiveClasses) {\n@@ -1188,1 +1188,1 @@\n-  if (EnableValhalla) {\n+  if (UseFlatArray) {\n@@ -2612,1 +2612,1 @@\n-  if (!EnableValhalla) {\n+  if (!EnablePrimitiveClasses) {\n@@ -2920,1 +2920,1 @@\n-     if (!EnableValhalla) {\n+     if (!EnablePrimitiveClasses) {\n@@ -3920,1 +3920,1 @@\n-  if (EnableValhalla) {\n+  if (EnablePrimitiveClasses) {\n","filename":"src\/hotspot\/cpu\/aarch64\/templateTable_aarch64.cpp","additions":5,"deletions":5,"binary":false,"changes":10,"status":"modified"},{"patch":"@@ -1189,1 +1189,1 @@\n-  if (EnableValhalla) {\n+  if (EnablePrimitiveClasses) {\n@@ -1205,1 +1205,1 @@\n-  if (EnableValhalla) {\n+  if (UseFlatArray) {\n@@ -2981,1 +2981,1 @@\n-  if (!EnableValhalla) {\n+  if (!EnablePrimitiveClasses) {\n@@ -2992,5 +2992,10 @@\n-      if (EnableValhalla) {\n-        Label is_null_free_inline_type, uninitialized;\n-        \/\/ Issue below if the static field has not been initialized yet\n-        __ test_field_is_null_free_inline_type(flags2, rscratch1, is_null_free_inline_type);\n-          \/\/ field is not a null free inline type\n+      Label is_null_free_inline_type, uninitialized;\n+      \/\/ Issue below if the static field has not been initialized yet\n+      __ test_field_is_null_free_inline_type(flags2, rscratch1, is_null_free_inline_type);\n+        \/\/ field is not a null free inline type\n+        __ push(atos);\n+        __ jmp(Done);\n+      \/\/ field is a null free inline type, must not return null even if uninitialized\n+      __ bind(is_null_free_inline_type);\n+          __ testptr(rax, rax);\n+        __ jcc(Assembler::zero, uninitialized);\n@@ -2999,21 +3004,15 @@\n-        \/\/ field is a null free inline type, must not return null even if uninitialized\n-        __ bind(is_null_free_inline_type);\n-           __ testptr(rax, rax);\n-          __ jcc(Assembler::zero, uninitialized);\n-            __ push(atos);\n-            __ jmp(Done);\n-          __ bind(uninitialized);\n-            __ andl(flags2, ConstantPoolCacheEntry::field_index_mask);\n-  #ifdef _LP64\n-            Label slow_case, finish;\n-            __ movptr(rbx, Address(obj, java_lang_Class::klass_offset()));\n-            __ cmpb(Address(rbx, InstanceKlass::init_state_offset()), InstanceKlass::fully_initialized);\n-            __ jcc(Assembler::notEqual, slow_case);\n-          __ get_default_value_oop(rbx, rscratch1, rax);\n-          __ jmp(finish);\n-          __ bind(slow_case);\n-  #endif \/\/ LP64\n-            __ call_VM(rax, CAST_FROM_FN_PTR(address, InterpreterRuntime::uninitialized_static_inline_type_field),\n-                  obj, flags2);\n-  #ifdef _LP64\n-            __ bind(finish);\n+        __ bind(uninitialized);\n+          __ andl(flags2, ConstantPoolCacheEntry::field_index_mask);\n+#ifdef _LP64\n+          Label slow_case, finish;\n+          __ movptr(rbx, Address(obj, java_lang_Class::klass_offset()));\n+          __ cmpb(Address(rbx, InstanceKlass::init_state_offset()), InstanceKlass::fully_initialized);\n+          __ jcc(Assembler::notEqual, slow_case);\n+        __ get_default_value_oop(rbx, rscratch1, rax);\n+        __ jmp(finish);\n+        __ bind(slow_case);\n+#endif \/\/ LP64\n+          __ call_VM(rax, CAST_FROM_FN_PTR(address, InterpreterRuntime::uninitialized_static_inline_type_field),\n+                obj, flags2);\n+#ifdef _LP64\n+          __ bind(finish);\n@@ -3021,1 +3020,0 @@\n-      }\n@@ -3027,3 +3025,1 @@\n-      if (EnableValhalla) {\n-        __ test_field_is_null_free_inline_type(flags2, rscratch1, is_inline_type);\n-      }\n+      __ test_field_is_null_free_inline_type(flags2, rscratch1, is_inline_type);\n@@ -3038,20 +3034,10 @@\n-      if (EnableValhalla) {\n-        __ bind(is_inline_type);\n-          __ test_field_is_inlined(flags2, rscratch1, is_inlined);\n-            \/\/ field is not inlined\n-            __ movptr(rax, rcx);  \/\/ small dance required to preserve the klass_holder somewhere\n-            pop_and_check_object(obj);\n-            __ push(rax);\n-            __ load_heap_oop(rax, field);\n-            __ pop(rcx);\n-            __ testptr(rax, rax);\n-            __ jcc(Assembler::notZero, nonnull);\n-              __ andl(flags2, ConstantPoolCacheEntry::field_index_mask);\n-              __ get_inline_type_field_klass(rcx, flags2, rbx);\n-              __ get_default_value_oop(rbx, rcx, rax);\n-            __ bind(nonnull);\n-            __ verify_oop(rax);\n-            __ push(atos);\n-            __ jmp(rewrite_inline);\n-          __ bind(is_inlined);\n-          \/\/ field is inlined\n+      __ bind(is_inline_type);\n+        __ test_field_is_inlined(flags2, rscratch1, is_inlined);\n+          \/\/ field is not inlined\n+          __ movptr(rax, rcx);  \/\/ small dance required to preserve the klass_holder somewhere\n+          pop_and_check_object(obj);\n+          __ push(rax);\n+          __ load_heap_oop(rax, field);\n+          __ pop(rcx);\n+          __ testptr(rax, rax);\n+          __ jcc(Assembler::notZero, nonnull);\n@@ -3059,9 +3045,16 @@\n-            pop_and_check_object(rax);\n-            __ read_inlined_field(rcx, flags2, rbx, rax);\n-            __ verify_oop(rax);\n-            __ push(atos);\n-        __ bind(rewrite_inline);\n-        if (rc == may_rewrite) {\n-          patch_bytecode(Bytecodes::_fast_qgetfield, bc, rbx);\n-        }\n-        __ jmp(Done);\n+            __ get_inline_type_field_klass(rcx, flags2, rbx);\n+            __ get_default_value_oop(rbx, rcx, rax);\n+          __ bind(nonnull);\n+          __ verify_oop(rax);\n+          __ push(atos);\n+          __ jmp(rewrite_inline);\n+        __ bind(is_inlined);\n+        \/\/ field is inlined\n+          __ andl(flags2, ConstantPoolCacheEntry::field_index_mask);\n+          pop_and_check_object(rax);\n+          __ read_inlined_field(rcx, flags2, rbx, rax);\n+          __ verify_oop(rax);\n+          __ push(atos);\n+      __ bind(rewrite_inline);\n+      if (rc == may_rewrite) {\n+        patch_bytecode(Bytecodes::_fast_qgetfield, bc, rbx);\n@@ -3069,0 +3062,1 @@\n+        __ jmp(Done);\n@@ -3374,1 +3368,1 @@\n-    if (!EnableValhalla) {\n+    if (!EnablePrimitiveClasses) {\n@@ -3387,5 +3381,3 @@\n-        if (EnableValhalla) {\n-          __ test_field_is_not_null_free_inline_type(flags2, rscratch1, is_inline_type);\n-          __ null_check(rax);\n-          __ bind(is_inline_type);\n-        }\n+        __ test_field_is_not_null_free_inline_type(flags2, rscratch1, is_inline_type);\n+        __ null_check(rax);\n+        __ bind(is_inline_type);\n@@ -3396,3 +3388,1 @@\n-        if (EnableValhalla) {\n-          __ test_field_is_null_free_inline_type(flags2, rscratch1, is_inline_type);\n-        }\n+        __ test_field_is_null_free_inline_type(flags2, rscratch1, is_inline_type);\n@@ -3408,23 +3398,20 @@\n-        if (EnableValhalla) {\n-          \/\/ Implementation of the inline type semantic\n-          __ bind(is_inline_type);\n-          __ null_check(rax);\n-          __ test_field_is_inlined(flags2, rscratch1, is_inlined);\n-          \/\/ field is not inlined\n-          pop_and_check_object(obj);\n-          \/\/ Store into the field\n-          do_oop_store(_masm, field, rax);\n-          __ jmp(rewrite_inline);\n-          __ bind(is_inlined);\n-          \/\/ field is inlined\n-          pop_and_check_object(obj);\n-          assert_different_registers(rax, rdx, obj, off);\n-          __ load_klass(rdx, rax, rscratch1);\n-          __ data_for_oop(rax, rax, rdx);\n-          __ addptr(obj, off);\n-          __ access_value_copy(IN_HEAP, rax, obj, rdx);\n-          __ bind(rewrite_inline);\n-          if (rc == may_rewrite) {\n-            patch_bytecode(Bytecodes::_fast_qputfield, bc, rbx, true, byte_no);\n-          }\n-          __ jmp(Done);\n+        \/\/ Implementation of the inline type semantic\n+        __ bind(is_inline_type);\n+        __ null_check(rax);\n+        __ test_field_is_inlined(flags2, rscratch1, is_inlined);\n+        \/\/ field is not inlined\n+        pop_and_check_object(obj);\n+        \/\/ Store into the field\n+        do_oop_store(_masm, field, rax);\n+        __ jmp(rewrite_inline);\n+        __ bind(is_inlined);\n+        \/\/ field is inlined\n+        pop_and_check_object(obj);\n+        assert_different_registers(rax, rdx, obj, off);\n+        __ load_klass(rdx, rax, rscratch1);\n+        __ data_for_oop(rax, rax, rdx);\n+        __ addptr(obj, off);\n+        __ access_value_copy(IN_HEAP, rax, obj, rdx);\n+        __ bind(rewrite_inline);\n+        if (rc == may_rewrite) {\n+          patch_bytecode(Bytecodes::_fast_qputfield, bc, rbx, true, byte_no);\n@@ -3432,0 +3419,1 @@\n+        __ jmp(Done);\n@@ -4467,1 +4455,1 @@\n-  if (EnableValhalla) {\n+  if (EnablePrimitiveClasses) {\n","filename":"src\/hotspot\/cpu\/x86\/templateTable_x86.cpp","additions":83,"deletions":95,"binary":false,"changes":178,"status":"modified"},{"patch":"@@ -3328,1 +3328,1 @@\n-    \/\/ JVM_ACC_VALUE, JVM_ACC_PRIMITIVE, and JVM_ACC_IDENTITY are defined for class file version 62 and later\n+    \/\/ JVM_ACC_VALUE, JVM_ACC_PRIMITIVE, and JVM_ACC_IDENTITY are defined depending on version and feature flag\n@@ -4801,3 +4801,1 @@\n-  if (!EnableValhalla) {\n-    if (is_value_class || is_primitive_class) {\n-      const char* bad_flag = is_primitive_class ? \"ACC_PRIMITIVE\" : \"ACC_VALUE\";\n+  if (is_value_class && !EnableValhalla) {\n@@ -4808,2 +4806,13 @@\n-        \"Class modifier %s in class %s requires option -XX:+EnableValhalla\",\n-        bad_flag, _class_name->as_C_string()\n+        \"Class modifier ACC_VALUE in class %s requires option -XX:+EnableValhalla\",\n+        _class_name->as_C_string()\n+      );\n+    return;\n+  }\n+\n+  if (is_primitive_class && !EnablePrimitiveClasses) {\n+      ResourceMark rm(THREAD);\n+      Exceptions::fthrow(\n+        THREAD_AND_LOCATION,\n+        vmSymbols::java_lang_ClassFormatError(),\n+        \"Class modifier ACC_PRIMITIVE in class %s requires option -XX:+EnablePrimitiveClasses\",\n+        _class_name->as_C_string()\n@@ -4811,1 +4820,0 @@\n-    }\n@@ -5229,1 +5237,1 @@\n-      if (_major_version < 51 \/* CONSTANT_CLASS_DESCRIPTORS *\/ ) {\n+      if ( (_major_version < 51 \/* CONSTANT_CLASS_DESCRIPTORS *\/ ) || (!EnablePrimitiveClasses)) {\n@@ -5231,1 +5239,1 @@\n-                              \"in descriptor in class file %s\",\n+                              \"in descriptor in class file %s, requires option -XX:+EnablePrimitiveClasses\",\n@@ -5405,1 +5413,1 @@\n-  if (!supports_inline_types() && (signature->is_Q_signature() || signature->is_Q_array_signature())) {\n+  if ((!supports_inline_types() || !EnablePrimitiveClasses) && (signature->is_Q_signature() || signature->is_Q_array_signature())) {\n@@ -6177,1 +6185,1 @@\n-  \/\/ JVM_ACC_VALUE and JVM_ACC_PRIMITIVE are defined for class file version 55 and later\n+  \/\/ Are JVM_ACC_VALUE and JVM_ACC_PRIMITIVE support (version and feature check)\n@@ -6550,1 +6558,1 @@\n-  if (EnableValhalla) {\n+  if (EnablePrimitiveClasses) {\n","filename":"src\/hotspot\/share\/classfile\/classFileParser.cpp","additions":20,"deletions":12,"binary":false,"changes":32,"status":"modified"},{"patch":"@@ -918,17 +918,7 @@\n-    for (int i = 0; i < methods()->length(); i++) {\n-      Method* m = methods()->at(i);\n-      for (SignatureStream ss(m->signature()); !ss.is_done(); ss.next()) {\n-        if (ss.is_reference()) {\n-          if (ss.is_array()) {\n-            continue;\n-          }\n-          if (ss.type() == T_PRIMITIVE_OBJECT) {\n-            Symbol* symb = ss.as_symbol();\n-            if (symb == name()) continue;\n-            oop loader = class_loader();\n-            oop protection_domain = this->protection_domain();\n-            Klass* klass = SystemDictionary::resolve_or_fail(symb,\n-                                                             Handle(THREAD, loader), Handle(THREAD, protection_domain), true,\n-                                                             CHECK_false);\n-            if (klass == NULL) {\n-              THROW_(vmSymbols::java_lang_LinkageError(), false);\n+    if (EnablePrimitiveClasses) {\n+      for (int i = 0; i < methods()->length(); i++) {\n+        Method* m = methods()->at(i);\n+        for (SignatureStream ss(m->signature()); !ss.is_done(); ss.next()) {\n+          if (ss.is_reference()) {\n+            if (ss.is_array()) {\n+              continue;\n@@ -936,6 +926,18 @@\n-            if (!klass->is_inline_klass()) {\n-              Exceptions::fthrow(\n-                THREAD_AND_LOCATION,\n-                vmSymbols::java_lang_IncompatibleClassChangeError(),\n-                \"class %s is not an inline type\",\n-                klass->external_name());\n+            if (ss.type() == T_PRIMITIVE_OBJECT) {\n+              Symbol* symb = ss.as_symbol();\n+              if (symb == name()) continue;\n+              oop loader = class_loader();\n+              oop protection_domain = this->protection_domain();\n+              Klass* klass = SystemDictionary::resolve_or_fail(symb,\n+                                                              Handle(THREAD, loader), Handle(THREAD, protection_domain), true,\n+                                                              CHECK_false);\n+              if (klass == NULL) {\n+                THROW_(vmSymbols::java_lang_LinkageError(), false);\n+              }\n+              if (!klass->is_inline_klass()) {\n+                Exceptions::fthrow(\n+                  THREAD_AND_LOCATION,\n+                  vmSymbols::java_lang_IncompatibleClassChangeError(),\n+                  \"class %s is not an inline type\",\n+                  klass->external_name());\n+              }\n@@ -1266,1 +1268,1 @@\n-  if (EnableValhalla) {\n+  if (EnablePrimitiveClasses) {\n","filename":"src\/hotspot\/share\/oops\/instanceKlass.cpp","additions":26,"deletions":24,"binary":false,"changes":50,"status":"modified"},{"patch":"@@ -274,1 +274,1 @@\n-  if (EnableValhalla) {\n+  if (UseFlatArray) {\n","filename":"src\/hotspot\/share\/oops\/objArrayKlass.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -3035,16 +3035,2 @@\n-  if (EnableValhalla) {\n-    \/\/ create_property(\"valhalla.enableValhalla\", \"true\", InternalProperty)\n-    const char* prop_name = \"valhalla.enableValhalla\";\n-    const char* prop_value = \"true\";\n-    const size_t prop_len = strlen(prop_name) + strlen(prop_value) + 2;\n-    char* property = AllocateHeap(prop_len, mtArguments);\n-    int ret = jio_snprintf(property, prop_len, \"%s=%s\", prop_name, prop_value);\n-    if (ret < 0 || ret >= (int)prop_len) {\n-      FreeHeap(property);\n-      return JNI_ENOMEM;\n-    }\n-    bool added = add_property(property, UnwriteableProperty, InternalProperty);\n-    FreeHeap(property);\n-    if (!added) {\n-      return JNI_ENOMEM;\n-    }\n+  if (!EnableValhalla) {\n+    EnablePrimitiveClasses = false;\n","filename":"src\/hotspot\/share\/runtime\/arguments.cpp","additions":2,"deletions":16,"binary":false,"changes":18,"status":"modified"},{"patch":"@@ -2054,0 +2054,3 @@\n+  product(bool, EnablePrimitiveClasses, true,                               \\\n+          \"Enable experimental Valhalla primitive classes\")                 \\\n+                                                                            \\\n","filename":"src\/hotspot\/share\/runtime\/globals.hpp","additions":3,"deletions":0,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -1285,1 +1285,1 @@\n-#define UseFlatArray (EnableValhalla && (FlatArrayElementMaxSize != 0))\n+#define UseFlatArray (EnablePrimitiveClasses && (FlatArrayElementMaxSize != 0))\n","filename":"src\/hotspot\/share\/utilities\/globalDefinitions.hpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -29,1 +29,1 @@\n- * @run main\/othervm\n+ * @run main\/othervm -XX:+EnableValhalla -XX:+EnablePrimitiveClasses\n","filename":"test\/hotspot\/jtreg\/compiler\/valhalla\/inlinetypes\/BlackholeTest.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -37,0 +37,2 @@\n+                         \"-XX:+EnableValhalla\",\n+                         \"-XX:+EnablePrimitiveClasses\",\n@@ -48,0 +50,2 @@\n+                         \"-XX:+EnableValhalla\",\n+                         \"-XX:+EnablePrimitiveClasses\",\n@@ -59,0 +63,2 @@\n+                         \"-XX:+EnableValhalla\",\n+                         \"-XX:+EnablePrimitiveClasses\",\n@@ -71,0 +77,2 @@\n+                         \"-XX:+EnableValhalla\",\n+                         \"-XX:+EnablePrimitiveClasses\",\n@@ -81,0 +89,2 @@\n+                         \"-XX:+EnableValhalla\",\n+                         \"-XX:+EnablePrimitiveClasses\",\n@@ -91,0 +101,2 @@\n+                         \"-XX:+EnableValhalla\",\n+                         \"-XX:+EnablePrimitiveClasses\",\n","filename":"test\/hotspot\/jtreg\/compiler\/valhalla\/inlinetypes\/InlineTypes.java","additions":12,"deletions":0,"binary":false,"changes":12,"status":"modified"},{"patch":"@@ -89,1 +89,2 @@\n-            String[] arg = {\"-XX:CompileCommand=quiet\", \"-XX:CompileCommand=compileonly,TestArrayAccessDeopt::test*\", \"-XX:-UseArrayLoadStoreProfile\",\n+            String[] arg = {\"-XX:+EnableValhalla\", \"-XX:+EnablePrimitiveClasses\",\n+                            \"-XX:CompileCommand=quiet\", \"-XX:CompileCommand=compileonly,TestArrayAccessDeopt::test*\", \"-XX:-UseArrayLoadStoreProfile\",\n","filename":"test\/hotspot\/jtreg\/compiler\/valhalla\/inlinetypes\/TestArrayAccessDeopt.java","additions":2,"deletions":1,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -29,1 +29,2 @@\n- * @run main\/othervm -XX:CompileCommand=dontinline,compiler.valhalla.inlinetypes.TestArrayCopyWithOops::test*\n+ * @run main\/othervm -XX:+EnableValhalla -XX:+EnablePrimitiveClasses\n+ *                   -XX:CompileCommand=dontinline,compiler.valhalla.inlinetypes.TestArrayCopyWithOops::test*\n@@ -33,1 +34,2 @@\n- * @run main\/othervm -XX:CompileCommand=dontinline,compiler.valhalla.inlinetypes.TestArrayCopyWithOops::test*\n+ * @run main\/othervm -XX:+EnableValhalla -XX:+EnablePrimitiveClasses\n+ *                   -XX:CompileCommand=dontinline,compiler.valhalla.inlinetypes.TestArrayCopyWithOops::test*\n","filename":"test\/hotspot\/jtreg\/compiler\/valhalla\/inlinetypes\/TestArrayCopyWithOops.java","additions":4,"deletions":2,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -52,4 +52,4 @@\n-        scenarios[2].addFlags(\"-XX:-MonomorphicArrayCheck\", \"-XX:-UncommonNullCast\", \"-XX:+StressArrayCopyMacroNode\");\n-        scenarios[3].addFlags(\"-XX:-MonomorphicArrayCheck\", \"-XX:FlatArrayElementMaxSize=-1\", \"-XX:-UncommonNullCast\");\n-        scenarios[4].addFlags(\"-XX:-MonomorphicArrayCheck\", \"-XX:-UncommonNullCast\");\n-        scenarios[5].addFlags(\"-XX:-MonomorphicArrayCheck\", \"-XX:-UncommonNullCast\", \"-XX:+StressArrayCopyMacroNode\");\n+        scenarios[2].addFlags(\"-XX:+EnableValhalla\", \"-XX:+EnablePrimitiveClasses\", \"-XX:-MonomorphicArrayCheck\", \"-XX:-UncommonNullCast\", \"-XX:+StressArrayCopyMacroNode\");\n+        scenarios[3].addFlags(\"-XX:+EnableValhalla\", \"-XX:+EnablePrimitiveClasses\", \"-XX:-MonomorphicArrayCheck\", \"-XX:FlatArrayElementMaxSize=-1\", \"-XX:-UncommonNullCast\");\n+        scenarios[4].addFlags(\"-XX:+EnableValhalla\", \"-XX:+EnablePrimitiveClasses\", \"-XX:-MonomorphicArrayCheck\", \"-XX:-UncommonNullCast\");\n+        scenarios[5].addFlags(\"-XX:+EnableValhalla\", \"-XX:+EnablePrimitiveClasses\", \"-XX:-MonomorphicArrayCheck\", \"-XX:-UncommonNullCast\", \"-XX:+StressArrayCopyMacroNode\");\n","filename":"test\/hotspot\/jtreg\/compiler\/valhalla\/inlinetypes\/TestArrays.java","additions":4,"deletions":4,"binary":false,"changes":8,"status":"modified"},{"patch":"@@ -35,1 +35,1 @@\n- * @run main\/othervm -Xbatch -XX:TypeProfileLevel=222\n+ * @run main\/othervm -XX:+EnableValhalla -XX:+EnablePrimitiveClasses -Xbatch -XX:TypeProfileLevel=222\n@@ -39,1 +39,1 @@\n- * @run main\/othervm -Xbatch -XX:TypeProfileLevel=222\n+ * @run main\/othervm -XX:+EnableValhalla -XX:+EnablePrimitiveClasses -Xbatch -XX:TypeProfileLevel=222\n","filename":"test\/hotspot\/jtreg\/compiler\/valhalla\/inlinetypes\/TestBimorphicInlining.java","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -39,1 +39,2 @@\n- * @run main\/othervm -XX:InlineFieldMaxFlatSize=0 -XX:FlatArrayElementMaxSize=0\n+ * @run main\/othervm -XX:+EnableValhalla -XX:+EnablePrimitiveClasses\n+ *                   -XX:InlineFieldMaxFlatSize=0 -XX:FlatArrayElementMaxSize=0\n@@ -42,1 +43,2 @@\n- * @run main\/othervm -XX:InlineFieldMaxFlatSize=0 -XX:FlatArrayElementMaxSize=0\n+ * @run main\/othervm -XX:+EnableValhalla -XX:+EnablePrimitiveClasses\n+ *                   -XX:InlineFieldMaxFlatSize=0 -XX:FlatArrayElementMaxSize=0\n@@ -46,1 +48,2 @@\n- * @run main\/othervm -XX:InlineFieldMaxFlatSize=0 -XX:FlatArrayElementMaxSize=0\n+ * @run main\/othervm -XX:+EnableValhalla -XX:+EnablePrimitiveClasses\n+ *                   -XX:InlineFieldMaxFlatSize=0 -XX:FlatArrayElementMaxSize=0\n@@ -50,1 +53,2 @@\n- * @run main\/othervm -XX:InlineFieldMaxFlatSize=0 -XX:FlatArrayElementMaxSize=0\n+ * @run main\/othervm -XX:+EnableValhalla -XX:+EnablePrimitiveClasses\n+ *                   -XX:InlineFieldMaxFlatSize=0 -XX:FlatArrayElementMaxSize=0\n","filename":"test\/hotspot\/jtreg\/compiler\/valhalla\/inlinetypes\/TestBufferTearing.java","additions":8,"deletions":4,"binary":false,"changes":12,"status":"modified"},{"patch":"@@ -31,1 +31,2 @@\n- * @run main\/othervm -XX:InlineFieldMaxFlatSize=-1 -XX:FlatArrayElementMaxSize=-1\n+ * @run main\/othervm -XX:+EnableValhalla -XX:+EnablePrimitiveClasses\n+ *                   -XX:InlineFieldMaxFlatSize=-1 -XX:FlatArrayElementMaxSize=-1\n","filename":"test\/hotspot\/jtreg\/compiler\/valhalla\/inlinetypes\/TestBufferTearingC1.java","additions":2,"deletions":1,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -49,0 +49,1 @@\n+                             \"-XX:+EnableValhalla\", \"-XX:+EnablePrimitiveClasses\",\n@@ -52,0 +53,1 @@\n+                             \"-XX:+EnableValhalla\", \"-XX:+EnablePrimitiveClasses\",\n@@ -55,0 +57,1 @@\n+                             \"-XX:+EnableValhalla\", \"-XX:+EnablePrimitiveClasses\",\n@@ -58,0 +61,1 @@\n+                             \"-XX:+EnableValhalla\", \"-XX:+EnablePrimitiveClasses\",\n@@ -61,0 +65,1 @@\n+                             \"-XX:+EnableValhalla\", \"-XX:+EnablePrimitiveClasses\",\n","filename":"test\/hotspot\/jtreg\/compiler\/valhalla\/inlinetypes\/TestC1.java","additions":5,"deletions":0,"binary":false,"changes":5,"status":"modified"},{"patch":"@@ -33,1 +33,1 @@\n- * @run main\/othervm -Xcomp -XX:TieredStopAtLevel=1 -ea\n+ * @run main\/othervm -XX:+EnableValhalla -XX:+EnablePrimitiveClasses -Xcomp -XX:TieredStopAtLevel=1 -ea\n","filename":"test\/hotspot\/jtreg\/compiler\/valhalla\/inlinetypes\/TestC1ValueNumbering.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -31,1 +31,2 @@\n- * @run main\/othervm -Xbootclasspath\/a:. -XX:+UnlockDiagnosticVMOptions -XX:+WhiteBoxAPI\n+ * @run main\/othervm -XX:+EnableValhalla -XX:+EnablePrimitiveClasses\n+ *                   -Xbootclasspath\/a:. -XX:+UnlockDiagnosticVMOptions -XX:+WhiteBoxAPI\n@@ -33,1 +34,2 @@\n- * @run main\/othervm -Xbootclasspath\/a:. -XX:+UnlockDiagnosticVMOptions -XX:+WhiteBoxAPI\n+ * @run main\/othervm -XX:+EnableValhalla -XX:+EnablePrimitiveClasses\n+ *                   -Xbootclasspath\/a:. -XX:+UnlockDiagnosticVMOptions -XX:+WhiteBoxAPI\n@@ -38,1 +40,2 @@\n- * @run main\/othervm -Xbootclasspath\/a:. -XX:+UnlockDiagnosticVMOptions -XX:+WhiteBoxAPI\n+ * @run main\/othervm -XX:+EnableValhalla -XX:+EnablePrimitiveClasses\n+ *                   -Xbootclasspath\/a:. -XX:+UnlockDiagnosticVMOptions -XX:+WhiteBoxAPI\n@@ -43,1 +46,2 @@\n- * @run main\/othervm -Xbootclasspath\/a:. -XX:+UnlockDiagnosticVMOptions -XX:+WhiteBoxAPI\n+ * @run main\/othervm -XX:+EnableValhalla -XX:+EnablePrimitiveClasses\n+ *                   -Xbootclasspath\/a:. -XX:+UnlockDiagnosticVMOptions -XX:+WhiteBoxAPI\n@@ -48,1 +52,2 @@\n- * @run main\/othervm -Xbootclasspath\/a:. -XX:+UnlockDiagnosticVMOptions -XX:+WhiteBoxAPI\n+ * @run main\/othervm -XX:+EnableValhalla -XX:+EnablePrimitiveClasses\n+ *                   -Xbootclasspath\/a:. -XX:+UnlockDiagnosticVMOptions -XX:+WhiteBoxAPI\n","filename":"test\/hotspot\/jtreg\/compiler\/valhalla\/inlinetypes\/TestC2CCalls.java","additions":10,"deletions":5,"binary":false,"changes":15,"status":"modified"},{"patch":"@@ -49,0 +49,1 @@\n+                             \"-XX:+EnableValhalla\", \"-XX:+EnablePrimitiveClasses\",\n@@ -54,0 +55,1 @@\n+                             \"-XX:+EnableValhalla\", \"-XX:+EnablePrimitiveClasses\",\n@@ -62,0 +64,1 @@\n+                             \"-XX:+EnableValhalla\", \"-XX:+EnablePrimitiveClasses\",\n@@ -68,0 +71,1 @@\n+                             \"-XX:+EnableValhalla\", \"-XX:+EnablePrimitiveClasses\",\n@@ -72,0 +76,1 @@\n+                             \"-XX:+EnableValhalla\", \"-XX:+EnablePrimitiveClasses\",\n","filename":"test\/hotspot\/jtreg\/compiler\/valhalla\/inlinetypes\/TestCallingConventionC1.java","additions":5,"deletions":0,"binary":false,"changes":5,"status":"modified"},{"patch":"@@ -28,1 +28,1 @@\n- * @run main\/othervm -Xbatch TestDeadAllocationRemoval\n+ * @run main\/othervm -XX:+EnableValhalla -XX:+EnablePrimitiveClasses -Xbatch TestDeadAllocationRemoval\n","filename":"test\/hotspot\/jtreg\/compiler\/valhalla\/inlinetypes\/TestDeadAllocationRemoval.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -41,1 +41,2 @@\n- * @run main\/othervm -Xbootclasspath\/a:. -XX:+IgnoreUnrecognizedVMOptions -XX:+UnlockDiagnosticVMOptions -XX:+WhiteBoxAPI\n+ * @run main\/othervm -XX:+EnableValhalla -XX:+EnablePrimitiveClasses\n+ *                   -Xbootclasspath\/a:. -XX:+IgnoreUnrecognizedVMOptions -XX:+UnlockDiagnosticVMOptions -XX:+WhiteBoxAPI\n@@ -44,1 +45,2 @@\n- * @run main\/othervm -Xbootclasspath\/a:. -XX:+IgnoreUnrecognizedVMOptions -XX:+UnlockDiagnosticVMOptions -XX:+WhiteBoxAPI\n+ * @run main\/othervm -XX:+EnableValhalla -XX:+EnablePrimitiveClasses\n+ *                   -Xbootclasspath\/a:. -XX:+IgnoreUnrecognizedVMOptions -XX:+UnlockDiagnosticVMOptions -XX:+WhiteBoxAPI\n@@ -47,1 +49,2 @@\n- * @run main\/othervm -Xbootclasspath\/a:. -XX:+IgnoreUnrecognizedVMOptions -XX:+UnlockDiagnosticVMOptions -XX:+WhiteBoxAPI\n+ * @run main\/othervm -XX:+EnableValhalla -XX:+EnablePrimitiveClasses\n+ *                   -Xbootclasspath\/a:. -XX:+IgnoreUnrecognizedVMOptions -XX:+UnlockDiagnosticVMOptions -XX:+WhiteBoxAPI\n@@ -52,1 +55,2 @@\n- * @run main\/othervm -Xbootclasspath\/a:. -XX:+IgnoreUnrecognizedVMOptions -XX:+UnlockDiagnosticVMOptions -XX:+WhiteBoxAPI\n+ * @run main\/othervm -XX:+EnableValhalla -XX:+EnablePrimitiveClasses\n+ *                   -Xbootclasspath\/a:. -XX:+IgnoreUnrecognizedVMOptions -XX:+UnlockDiagnosticVMOptions -XX:+WhiteBoxAPI\n@@ -57,1 +61,2 @@\n- * @run main\/othervm -Xbootclasspath\/a:. -XX:+IgnoreUnrecognizedVMOptions -XX:+UnlockDiagnosticVMOptions -XX:+WhiteBoxAPI\n+ * @run main\/othervm -XX:+EnableValhalla -XX:+EnablePrimitiveClasses\n+ *                   -Xbootclasspath\/a:. -XX:+IgnoreUnrecognizedVMOptions -XX:+UnlockDiagnosticVMOptions -XX:+WhiteBoxAPI\n@@ -62,1 +67,2 @@\n- * @run main\/othervm -Xbootclasspath\/a:. -XX:+IgnoreUnrecognizedVMOptions -XX:+UnlockDiagnosticVMOptions -XX:+WhiteBoxAPI\n+ * @run main\/othervm -XX:+EnableValhalla -XX:+EnablePrimitiveClasses\n+ *                   -Xbootclasspath\/a:. -XX:+IgnoreUnrecognizedVMOptions -XX:+UnlockDiagnosticVMOptions -XX:+WhiteBoxAPI\n@@ -67,1 +73,2 @@\n- * @run main\/othervm -Xbootclasspath\/a:. -XX:+IgnoreUnrecognizedVMOptions -XX:+UnlockDiagnosticVMOptions -XX:+WhiteBoxAPI\n+ * @run main\/othervm -XX:+EnableValhalla -XX:+EnablePrimitiveClasses\n+ *                   -Xbootclasspath\/a:. -XX:+IgnoreUnrecognizedVMOptions -XX:+UnlockDiagnosticVMOptions -XX:+WhiteBoxAPI\n@@ -72,1 +79,2 @@\n- * @run main\/othervm -Xbootclasspath\/a:. -XX:+IgnoreUnrecognizedVMOptions -XX:+UnlockDiagnosticVMOptions -XX:+WhiteBoxAPI\n+ * @run main\/othervm -XX:+EnableValhalla -XX:+EnablePrimitiveClasses\n+ *                   -Xbootclasspath\/a:. -XX:+IgnoreUnrecognizedVMOptions -XX:+UnlockDiagnosticVMOptions -XX:+WhiteBoxAPI\n","filename":"test\/hotspot\/jtreg\/compiler\/valhalla\/inlinetypes\/TestDeoptimizationWhenBuffering.java","additions":16,"deletions":8,"binary":false,"changes":24,"status":"modified"},{"patch":"@@ -29,1 +29,1 @@\n- * @run main\/othervm -XX:-BackgroundCompilation TestFlatArrayAliasesCardMark\n+ * @run main\/othervm -XX:+EnableValhalla -XX:+EnablePrimitiveClasses -XX:-BackgroundCompilation TestFlatArrayAliasesCardMark\n","filename":"test\/hotspot\/jtreg\/compiler\/valhalla\/inlinetypes\/TestFlatArrayAliasesCardMark.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -28,3 +28,3 @@\n- * @run main\/othervm -Xbatch TestFlatArrayThreshold\n- * @run main\/othervm -XX:FlatArrayElementMaxOops=1 -Xbatch TestFlatArrayThreshold\n- * @run main\/othervm -XX:FlatArrayElementMaxSize=1 -Xbatch TestFlatArrayThreshold\n+ * @run main\/othervm -XX:+EnableValhalla -XX:+EnablePrimitiveClasses -Xbatch TestFlatArrayThreshold\n+ * @run main\/othervm -XX:+EnableValhalla -XX:+EnablePrimitiveClasses -XX:FlatArrayElementMaxOops=1 -Xbatch TestFlatArrayThreshold\n+ * @run main\/othervm -XX:+EnableValhalla -XX:+EnablePrimitiveClasses -XX:FlatArrayElementMaxSize=1 -Xbatch TestFlatArrayThreshold\n","filename":"test\/hotspot\/jtreg\/compiler\/valhalla\/inlinetypes\/TestFlatArrayThreshold.java","additions":3,"deletions":3,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -28,1 +28,1 @@\n- * @run main\/othervm -Xbatch\n+ * @run main\/othervm -XX:+EnableValhalla -XX:+EnablePrimitiveClasses -Xbatch\n@@ -30,1 +30,1 @@\n- * @run main\/othervm -Xbatch -XX:FlatArrayElementMaxSize=0\n+ * @run main\/othervm -XX:+EnableValhalla -XX:+EnablePrimitiveClasses -Xbatch -XX:FlatArrayElementMaxSize=0\n","filename":"test\/hotspot\/jtreg\/compiler\/valhalla\/inlinetypes\/TestGenerated.java","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -50,0 +50,1 @@\n+                        \"-XX:+EnableValhalla\", \"-XX:+EnablePrimitiveClasses\",\n@@ -54,0 +55,1 @@\n+                        \"-XX:+EnableValhalla\", \"-XX:+EnablePrimitiveClasses\",\n@@ -59,0 +61,1 @@\n+                        \"-XX:+EnableValhalla\", \"-XX:+EnablePrimitiveClasses\",\n@@ -62,0 +65,1 @@\n+                        \"-XX:+EnableValhalla\", \"-XX:+EnablePrimitiveClasses\",\n@@ -67,0 +71,1 @@\n+                        \"-XX:+EnableValhalla\", \"-XX:+EnablePrimitiveClasses\",\n","filename":"test\/hotspot\/jtreg\/compiler\/valhalla\/inlinetypes\/TestGetfieldChains.java","additions":5,"deletions":0,"binary":false,"changes":5,"status":"modified"},{"patch":"@@ -32,1 +32,2 @@\n- * @run main\/othervm -XX:CompileCommand=dontinline,compiler.valhalla.inlinetypes.TestIsSubstitutableReresolution::test\n+ * @run main\/othervm -XX:+EnableValhalla -XX:+EnablePrimitiveClasses\n+ *                   -XX:CompileCommand=dontinline,compiler.valhalla.inlinetypes.TestIsSubstitutableReresolution::test\n","filename":"test\/hotspot\/jtreg\/compiler\/valhalla\/inlinetypes\/TestIsSubstitutableReresolution.java","additions":2,"deletions":1,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -50,0 +50,1 @@\n+                        \"-XX:+EnableValhalla\", \"-XX:+EnablePrimitiveClasses\",\n@@ -56,0 +57,1 @@\n+                        \"-XX:+EnableValhalla\", \"-XX:+EnablePrimitiveClasses\",\n@@ -61,0 +63,1 @@\n+                        \"-XX:+EnableValhalla\", \"-XX:+EnablePrimitiveClasses\",\n@@ -67,0 +70,1 @@\n+                        \"-XX:+EnableValhalla\", \"-XX:+EnablePrimitiveClasses\",\n@@ -75,0 +79,1 @@\n+                        \"-XX:+EnableValhalla\", \"-XX:+EnablePrimitiveClasses\",\n@@ -82,0 +87,1 @@\n+                        \"-XX:+EnableValhalla\", \"-XX:+EnablePrimitiveClasses\",\n","filename":"test\/hotspot\/jtreg\/compiler\/valhalla\/inlinetypes\/TestLWorldProfiling.java","additions":6,"deletions":0,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -28,1 +28,1 @@\n- * @run main\/othervm -Xcomp -XX:CompileCommand=compileonly,TestLoopUnswitchingWithFlatArrayCheck::test TestLoopUnswitchingWithFlatArrayCheck\n+ * @run main\/othervm -XX:+EnableValhalla -XX:+EnablePrimitiveClasses -Xcomp -XX:CompileCommand=compileonly,TestLoopUnswitchingWithFlatArrayCheck::test TestLoopUnswitchingWithFlatArrayCheck\n","filename":"test\/hotspot\/jtreg\/compiler\/valhalla\/inlinetypes\/TestLoopUnswitchingWithFlatArrayCheck.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -30,1 +30,1 @@\n- * @run main\/othervm -Xbatch -XX:-UseTypeProfile\n+ * @run main\/othervm -XX:+EnableValhalla -XX:+EnablePrimitiveClasses -Xbatch -XX:-UseTypeProfile\n","filename":"test\/hotspot\/jtreg\/compiler\/valhalla\/inlinetypes\/TestNativeClone.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -32,1 +32,1 @@\n- * @run main\/othervm -Xcomp\n+ * @run main\/othervm -XX:+EnableValhalla -XX:+EnablePrimitiveClasses -Xcomp\n@@ -35,1 +35,1 @@\n- * @run main\/othervm -Xcomp -XX:TieredStopAtLevel=1\n+ * @run main\/othervm -XX:+EnableValhalla -XX:+EnablePrimitiveClasses -Xcomp -XX:TieredStopAtLevel=1\n","filename":"test\/hotspot\/jtreg\/compiler\/valhalla\/inlinetypes\/TestNestmateAccess.java","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -30,1 +30,2 @@\n- * @run main\/othervm\/timeout=300 -Xbootclasspath\/a:. -XX:+UnlockDiagnosticVMOptions -XX:+WhiteBoxAPI\n+ * @run main\/othervm\/timeout=300 -XX:+EnableValhalla -XX:+EnablePrimitiveClasses\n+ *                               -Xbootclasspath\/a:. -XX:+UnlockDiagnosticVMOptions -XX:+WhiteBoxAPI\n","filename":"test\/hotspot\/jtreg\/compiler\/valhalla\/inlinetypes\/TestNewAcmp.java","additions":2,"deletions":1,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -30,1 +30,1 @@\n- * @run main\/othervm -Xbatch compiler.valhalla.inlinetypes.TestOptimizeKlassCmp\n+ * @run main\/othervm -XX:+EnableValhalla -XX:+EnablePrimitiveClasses -Xbatch compiler.valhalla.inlinetypes.TestOptimizeKlassCmp\n","filename":"test\/hotspot\/jtreg\/compiler\/valhalla\/inlinetypes\/TestOptimizeKlassCmp.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -27,1 +27,2 @@\n- * @run main\/othervm -XX:CompileCommand=dontinline,TestSafepointAtPollReturn::test* -XX:+UnlockDiagnosticVMOptions\n+ * @run main\/othervm -XX:+EnableValhalla -XX:+EnablePrimitiveClasses\n+ *                   -XX:CompileCommand=dontinline,TestSafepointAtPollReturn::test* -XX:+UnlockDiagnosticVMOptions\n","filename":"test\/hotspot\/jtreg\/compiler\/valhalla\/inlinetypes\/TestSafepointAtPollReturn.java","additions":2,"deletions":1,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -30,1 +30,2 @@\n- * @run main\/othervm -XX:CompileCommand=exclude,compiler.valhalla.inlinetypes.TestStressReturnBuffering::caller -Xmx4m\n+ * @run main\/othervm -XX:+EnableValhalla -XX:+EnablePrimitiveClasses\n+ *                   -XX:CompileCommand=exclude,compiler.valhalla.inlinetypes.TestStressReturnBuffering::caller -Xmx4m\n","filename":"test\/hotspot\/jtreg\/compiler\/valhalla\/inlinetypes\/TestStressReturnBuffering.java","additions":2,"deletions":1,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -33,1 +33,2 @@\n- * @run main\/othervm -Xbootclasspath\/a:. -XX:+UnlockDiagnosticVMOptions -XX:+WhiteBoxAPI -Xbatch\n+ * @run main\/othervm -Xbootclasspath\/a:. -XX:+EnableValhalla -XX:+EnablePrimitiveClasses\n+ *                   -XX:+UnlockDiagnosticVMOptions -XX:+WhiteBoxAPI -Xbatch\n","filename":"test\/hotspot\/jtreg\/compiler\/valhalla\/inlinetypes\/TestTrivialMethods.java","additions":2,"deletions":1,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -29,1 +29,2 @@\n- * @run main\/othervm -XX:+IgnoreUnrecognizedVMOptions -XX:+UnlockDiagnosticVMOptions\n+ * @run main\/othervm -XX:+EnableValhalla -XX:+EnablePrimitiveClasses\n+ *                   -XX:+IgnoreUnrecognizedVMOptions -XX:+UnlockDiagnosticVMOptions\n@@ -34,1 +35,2 @@\n- * @run main\/othervm -XX:+IgnoreUnrecognizedVMOptions -XX:+UnlockDiagnosticVMOptions\n+ * @run main\/othervm -XX:+EnableValhalla -XX:+EnablePrimitiveClasses\n+ *                   -XX:+IgnoreUnrecognizedVMOptions -XX:+UnlockDiagnosticVMOptions\n@@ -39,1 +41,2 @@\n- * @run main\/othervm -XX:+IgnoreUnrecognizedVMOptions -XX:+UnlockDiagnosticVMOptions\n+ * @run main\/othervm -XX:+EnableValhalla -XX:+EnablePrimitiveClasses\n+ *                   -XX:+IgnoreUnrecognizedVMOptions -XX:+UnlockDiagnosticVMOptions\n","filename":"test\/hotspot\/jtreg\/compiler\/valhalla\/inlinetypes\/TestUnexpectedMemBar.java","additions":6,"deletions":3,"binary":false,"changes":9,"status":"modified"},{"patch":"@@ -30,1 +30,2 @@\n- * @run main\/othervm -XX:CompileCommand=compileonly,*::<init> -Xcomp -XX:-TieredCompilation\n+ * @run main\/othervm -XX:+EnableValhalla -XX:-EnablePrimitiveClasses\n+ *                   -XX:CompileCommand=compileonly,*::<init> -Xcomp -XX:-TieredCompilation\n","filename":"test\/hotspot\/jtreg\/compiler\/valhalla\/inlinetypes\/TestUninitializedValueClass.java","additions":2,"deletions":1,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -29,1 +29,2 @@\n- * @run main\/othervm -Xcomp\n+ * @run main\/othervm -XX:+EnableValhalla -XX:+EnablePrimitiveClasses\n+ *                   -Xcomp\n@@ -32,1 +33,2 @@\n- * @run main\/othervm -Xcomp -XX:FlatArrayElementMaxSize=0\n+ * @run main\/othervm -XX:+EnableValhalla -XX:+EnablePrimitiveClasses\n+ *                   -Xcomp -XX:FlatArrayElementMaxSize=0\n@@ -35,1 +37,2 @@\n- * @run main\/othervm -Xcomp\n+ * @run main\/othervm -XX:+EnableValhalla -XX:+EnablePrimitiveClasses\n+ *                   -Xcomp\n@@ -37,1 +40,2 @@\n- * @run main\/othervm -Xcomp -XX:FlatArrayElementMaxSize=0\n+ * @run main\/othervm -XX:+EnableValhalla -XX:+EnablePrimitiveClasses\n+ *                   -Xcomp -XX:FlatArrayElementMaxSize=0\n@@ -39,1 +43,2 @@\n- * @run main\/othervm -Xcomp -XX:-TieredCompilation\n+ * @run main\/othervm -XX:+EnableValhalla -XX:+EnablePrimitiveClasses\n+ *                   -Xcomp -XX:-TieredCompilation\n@@ -42,1 +47,2 @@\n- * @run main\/othervm -Xcomp -XX:-TieredCompilation -XX:FlatArrayElementMaxSize=0\n+ * @run main\/othervm -XX:+EnableValhalla -XX:+EnablePrimitiveClasses\n+ *                   -Xcomp -XX:-TieredCompilation -XX:FlatArrayElementMaxSize=0\n@@ -45,1 +51,2 @@\n- * @run main\/othervm -Xcomp -XX:-TieredCompilation\n+ * @run main\/othervm -XX:+EnableValhalla -XX:+EnablePrimitiveClasses\n+ *                   -Xcomp -XX:-TieredCompilation\n@@ -47,1 +54,2 @@\n- * @run main\/othervm -Xcomp -XX:-TieredCompilation -XX:FlatArrayElementMaxSize=0\n+ * @run main\/othervm -XX:+EnableValhalla -XX:+EnablePrimitiveClasses\n+ *                   -Xcomp -XX:-TieredCompilation -XX:FlatArrayElementMaxSize=0\n","filename":"test\/hotspot\/jtreg\/compiler\/valhalla\/inlinetypes\/TestUnloadedInlineTypeArray.java","additions":16,"deletions":8,"binary":false,"changes":24,"status":"modified"},{"patch":"@@ -56,1 +56,2 @@\n-        final String[] flags = {\/\/ Prevent IR Test Framework from loading classes\n+        final String[] flags = { \"-XX:+EnableValhalla\" ,\"-XX:+EnablePrimitiveClasses\",\n+                                \/\/ Prevent IR Test Framework from loading classes\n","filename":"test\/hotspot\/jtreg\/compiler\/valhalla\/inlinetypes\/TestUnloadedInlineTypeField.java","additions":2,"deletions":1,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -30,1 +30,2 @@\n- * @run main\/othervm -Xbootclasspath\/a:. -XX:+UnlockDiagnosticVMOptions -XX:+WhiteBoxAPI\n+ * @run main\/othervm -XX:+EnableValhalla -XX:+EnablePrimitiveClasses\n+ *                   -Xbootclasspath\/a:. -XX:+UnlockDiagnosticVMOptions -XX:+WhiteBoxAPI\n","filename":"test\/hotspot\/jtreg\/compiler\/valhalla\/inlinetypes\/TestUnloadedReturnTypes.java","additions":2,"deletions":1,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -28,1 +28,1 @@\n- * @run main\/othervm -Xcomp -XX:CompileCommand=compileonly,TestUnresolvedDefault::test TestUnresolvedDefault\n+ * @run main\/othervm -XX:+EnableValhalla -XX:+EnablePrimitiveClasses -Xcomp -XX:CompileCommand=compileonly,TestUnresolvedDefault::test TestUnresolvedDefault\n","filename":"test\/hotspot\/jtreg\/compiler\/valhalla\/inlinetypes\/TestUnresolvedDefault.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -30,1 +30,1 @@\n- * @run main\/othervm TestUnresolvedInlineClass\n+ * @run main\/othervm -XX:+EnableValhalla -XX:+EnablePrimitiveClasses TestUnresolvedInlineClass\n@@ -54,1 +54,1 @@\n-            String[] arg = {\"-XX:+InlineTypePassFieldsAsArgs\", \"TestUnresolvedInlineClass\", \"run\"};\n+            String[] arg = {\"-XX:+EnableValhalla\", \"-XX:+EnablePrimitiveClasses\", \"-XX:+InlineTypePassFieldsAsArgs\", \"TestUnresolvedInlineClass\", \"run\"};\n","filename":"test\/hotspot\/jtreg\/compiler\/valhalla\/inlinetypes\/TestUnresolvedInlineClass.java","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -29,1 +29,2 @@\n- * @run main\/othervm -XX:CompileCommand=dontinline,TestWithSpeculativeTypes::*\n+ * @run main\/othervm -XX:+EnableValhalla -XX:+EnablePrimitiveClasses\n+ *                   -XX:CompileCommand=dontinline,TestWithSpeculativeTypes::*\n","filename":"test\/hotspot\/jtreg\/compiler\/valhalla\/inlinetypes\/TestWithSpeculativeTypes.java","additions":2,"deletions":1,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -46,0 +46,1 @@\n+                        \"-XX:+EnableValhalla\", \"-XX:+EnablePrimitiveClasses\",\n@@ -49,0 +50,1 @@\n+                        \"-XX:+EnableValhalla\", \"-XX:+EnablePrimitiveClasses\",\n@@ -52,0 +54,1 @@\n+                        \"-XX:+EnableValhalla\", \"-XX:+EnablePrimitiveClasses\",\n@@ -54,0 +57,1 @@\n+                        \"-XX:+EnableValhalla\", \"-XX:+EnablePrimitiveClasses\",\n@@ -58,0 +62,1 @@\n+                        \"-XX:+EnableValhalla\", \"-XX:+EnablePrimitiveClasses\",\n","filename":"test\/hotspot\/jtreg\/compiler\/valhalla\/inlinetypes\/TestWithfieldC1.java","additions":5,"deletions":0,"binary":false,"changes":5,"status":"modified"},{"patch":"@@ -39,1 +39,2 @@\n- * @run main\/othervm -Xbootclasspath\/a:boot -Xbootclasspath\/a:. -XX:+UnlockDiagnosticVMOptions -XX:+WhiteBoxAPI\n+ * @run main\/othervm -XX:+EnableValhalla -XX:+EnablePrimitiveClasses\n+ *                   -Xbootclasspath\/a:boot -Xbootclasspath\/a:. -XX:+UnlockDiagnosticVMOptions -XX:+WhiteBoxAPI\n","filename":"test\/hotspot\/jtreg\/compiler\/valhalla\/inlinetypes\/bootstrap\/TestBootClassloader.java","additions":2,"deletions":1,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -33,1 +33,1 @@\n- * @run main runtime.valhalla.inlinetypes.CheckcastTest\n+ * @run main\/othervm -XX:+EnableValhalla -XX:+EnablePrimitiveClasses runtime.valhalla.inlinetypes.CheckcastTest\n","filename":"test\/hotspot\/jtreg\/runtime\/valhalla\/inlinetypes\/CheckcastTest.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -32,1 +32,1 @@\n- * @run main runtime.valhalla.inlinetypes.CircularityTest\n+ * @run main\/othervm -XX:+EnableValhalla -XX:+EnablePrimitiveClasses runtime.valhalla.inlinetypes.CircularityTest\n","filename":"test\/hotspot\/jtreg\/runtime\/valhalla\/inlinetypes\/CircularityTest.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -31,1 +31,1 @@\n-* @run main runtime.valhalla.inlinetypes.ClassInitializationFailuresTest\n+* @run main\/othervm -XX:+EnableValhalla -XX:+EnablePrimitiveClasses runtime.valhalla.inlinetypes.ClassInitializationFailuresTest\n","filename":"test\/hotspot\/jtreg\/runtime\/valhalla\/inlinetypes\/ClassInitializationFailuresTest.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -35,1 +35,1 @@\n- * @run main\/othervm runtime.valhalla.inlinetypes.ClassPrintLayoutDcmd\n+ * @run main\/othervm -XX:+EnableValhalla -XX:+EnablePrimitiveClasses runtime.valhalla.inlinetypes.ClassPrintLayoutDcmd\n","filename":"test\/hotspot\/jtreg\/runtime\/valhalla\/inlinetypes\/ClassPrintLayoutDcmd.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -52,1 +52,1 @@\n- * @run main\/othervm -Xmx128m\n+ * @run main\/othervm -XX:+EnableValhalla -XX:+EnablePrimitiveClasses -Xmx128m\n","filename":"test\/hotspot\/jtreg\/runtime\/valhalla\/inlinetypes\/CreationErrorTest.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -34,1 +34,1 @@\n- * @run main\/othervm -XX:InlineFieldMaxFlatSize=128 runtime.valhalla.inlinetypes.EmptyInlineTest\n+ * @run main\/othervm -XX:+EnableValhalla -XX:+EnablePrimitiveClasses -XX:InlineFieldMaxFlatSize=128 runtime.valhalla.inlinetypes.EmptyInlineTest\n","filename":"test\/hotspot\/jtreg\/runtime\/valhalla\/inlinetypes\/EmptyInlineTest.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -34,1 +34,1 @@\n- * @run main\/othervm -XX:+UnlockDiagnosticVMOptions -XX:ForceNonTearable=* runtime.valhalla.inlinetypes.FlattenableSemanticTest\n+ * @run main\/othervm -XX:+EnableValhalla -XX:+EnablePrimitiveClasses -XX:+UnlockDiagnosticVMOptions -XX:ForceNonTearable=* runtime.valhalla.inlinetypes.FlattenableSemanticTest\n","filename":"test\/hotspot\/jtreg\/runtime\/valhalla\/inlinetypes\/FlattenableSemanticTest.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -30,1 +30,1 @@\n- * @run main HiddenInlineClassTest\n+ * @run main\/othervm -XX:+EnableValhalla -XX:-EnablePrimitiveClasses HiddenInlineClassTest\n","filename":"test\/hotspot\/jtreg\/runtime\/valhalla\/inlinetypes\/HiddenInlineClassTest.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -33,1 +33,1 @@\n- * @run main\/othervm -Xms16m -Xmx16m -XX:+UseSerialGC\n+ * @run main\/othervm -XX:+EnableValhalla -XX:+EnablePrimitiveClasses -Xms16m -Xmx16m -XX:+UseSerialGC\n","filename":"test\/hotspot\/jtreg\/runtime\/valhalla\/inlinetypes\/Ifacmp.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -44,1 +44,2 @@\n- * @run main\/othervm -XX:+UseSerialGC -Xmx128m -XX:InlineFieldMaxFlatSize=128\n+ * @run main\/othervm -XX:+EnableValhalla -XX:+EnablePrimitiveClasses\n+ *                   -XX:+UseSerialGC -Xmx128m -XX:InlineFieldMaxFlatSize=128\n@@ -58,1 +59,2 @@\n- * @run main\/othervm -XX:+UseG1GC -Xmx128m -XX:InlineFieldMaxFlatSize=128\n+ * @run main\/othervm -XX:+EnableValhalla -XX:+EnablePrimitiveClasses\n+ *                   -XX:+UseG1GC -Xmx128m -XX:InlineFieldMaxFlatSize=128\n@@ -72,1 +74,2 @@\n- * @run main\/othervm -XX:+UseParallelGC -Xmx128m -XX:InlineFieldMaxFlatSize=128\n+ * @run main\/othervm -XX:+EnableValhalla -XX:+EnablePrimitiveClasses\n+ *                   -XX:+UseParallelGC -Xmx128m -XX:InlineFieldMaxFlatSize=128\n@@ -86,1 +89,2 @@\n- * @run main\/othervm -XX:+UnlockExperimentalVMOptions -XX:+UseZGC -Xmx128m\n+ * @run main\/othervm -XX:+EnableValhalla -XX:+EnablePrimitiveClasses\n+ *                   -XX:+UnlockExperimentalVMOptions -XX:+UseZGC -Xmx128m\n","filename":"test\/hotspot\/jtreg\/runtime\/valhalla\/inlinetypes\/InlineOops.java","additions":8,"deletions":4,"binary":false,"changes":12,"status":"modified"},{"patch":"@@ -38,3 +38,3 @@\n- * @run main\/othervm -XX:FlatArrayElementMaxSize=-1 runtime.valhalla.inlinetypes.InlineTypeArray\n- * @run main\/othervm -XX:FlatArrayElementMaxSize=0  runtime.valhalla.inlinetypes.InlineTypeArray\n- * @run main\/othervm -XX:+UnlockDiagnosticVMOptions -XX:ForceNonTearable=* runtime.valhalla.inlinetypes.InlineTypeArray\n+ * @run main\/othervm -XX:+EnableValhalla -XX:+EnablePrimitiveClasses -XX:FlatArrayElementMaxSize=-1 runtime.valhalla.inlinetypes.InlineTypeArray\n+ * @run main\/othervm -XX:+EnableValhalla -XX:+EnablePrimitiveClasses -XX:FlatArrayElementMaxSize=0  runtime.valhalla.inlinetypes.InlineTypeArray\n+ * @run main\/othervm -XX:+EnableValhalla -XX:+EnablePrimitiveClasses -XX:+UnlockDiagnosticVMOptions -XX:ForceNonTearable=* runtime.valhalla.inlinetypes.InlineTypeArray\n","filename":"test\/hotspot\/jtreg\/runtime\/valhalla\/inlinetypes\/InlineTypeArray.java","additions":3,"deletions":3,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -31,2 +31,2 @@\n- * @compile -XDallowFlattenabilityModifiers InlineTypeCreation.java Point.java Long8Inline.java Person.java\n- * @run main runtime.valhalla.inlinetypes.InlineTypeCreation\n+ * @compile InlineTypeCreation.java Point.java Long8Inline.java Person.java\n+ * @run main\/othervm -XX:+EnableValhalla -XX:+EnablePrimitiveClasses runtime.valhalla.inlinetypes.InlineTypeCreation\n","filename":"test\/hotspot\/jtreg\/runtime\/valhalla\/inlinetypes\/InlineTypeCreation.java","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -36,1 +36,2 @@\n- * @run main\/othervm -XX:FlatArrayElementMaxSize=-1 -XX:+UseCompressedOops\n+ * @run main\/othervm -XX:+EnableValhalla -XX:+EnablePrimitiveClasses\n+ *                   -XX:FlatArrayElementMaxSize=-1 -XX:+UseCompressedOops\n@@ -39,1 +40,2 @@\n- * @run main\/othervm -XX:FlatArrayElementMaxSize=-1 -XX:-UseCompressedOops\n+ * @run main\/othervm -XX:+EnableValhalla -XX:+EnablePrimitiveClasses\n+ *                   -XX:FlatArrayElementMaxSize=-1 -XX:-UseCompressedOops\n@@ -42,1 +44,2 @@\n- * @run main\/othervm -XX:FlatArrayElementMaxSize=-1\n+ * @run main\/othervm -XX:+EnableValhalla -XX:+EnablePrimitiveClasses\n+ *                   -XX:FlatArrayElementMaxSize=-1\n@@ -45,1 +48,2 @@\n- * @run main\/othervm -XX:+UnlockDiagnosticVMOptions -XX:FlatArrayElementMaxSize=-1\n+ * @run main\/othervm -XX:+EnableValhalla -XX:+EnablePrimitiveClasses\n+ *                   -XX:+UnlockDiagnosticVMOptions -XX:FlatArrayElementMaxSize=-1\n","filename":"test\/hotspot\/jtreg\/runtime\/valhalla\/inlinetypes\/InlineTypeDensity.java","additions":8,"deletions":4,"binary":false,"changes":12,"status":"modified"},{"patch":"@@ -32,1 +32,1 @@\n- * @run main runtime.valhalla.inlinetypes.InlineTypeGetField\n+ * @run main\/othervm -XX:+EnableValhalla -XX:+EnablePrimitiveClasses runtime.valhalla.inlinetypes.InlineTypeGetField\n","filename":"test\/hotspot\/jtreg\/runtime\/valhalla\/inlinetypes\/InlineTypeGetField.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -53,1 +53,2 @@\n- * @run main\/othervm -Xmx128m -XX:+ExplicitGCInvokesConcurrent\n+ * @run main\/othervm -XX:+EnableValhalla -XX:+EnablePrimitiveClasses\n+ *                   -Xmx128m -XX:+ExplicitGCInvokesConcurrent\n@@ -57,1 +58,2 @@\n- * @run main\/othervm -Xmx128m -XX:+ExplicitGCInvokesConcurrent\n+ * @run main\/othervm -XX:+EnableValhalla -XX:+EnablePrimitiveClasses\n+ *                   -Xmx128m -XX:+ExplicitGCInvokesConcurrent\n","filename":"test\/hotspot\/jtreg\/runtime\/valhalla\/inlinetypes\/InlineTypesTest.java","additions":4,"deletions":2,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -28,1 +28,1 @@\n- * @run main\/native runtime.valhalla.inlinetypes.InlineWithJni\n+ * @run main\/othervm\/native -XX:+EnableValhalla -XX:-EnablePrimitiveClasses runtime.valhalla.inlinetypes.InlineWithJni\n@@ -30,1 +30,1 @@\n-public primitive final class InlineWithJni {\n+public value class InlineWithJni {\n","filename":"test\/hotspot\/jtreg\/runtime\/valhalla\/inlinetypes\/InlineWithJni.java","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -30,1 +30,1 @@\n- * @run main\/othervm MultiANewArrayTest\n+ * @run main\/othervm -XX:+EnableValhalla -XX:+EnablePrimitiveClasses MultiANewArrayTest\n","filename":"test\/hotspot\/jtreg\/runtime\/valhalla\/inlinetypes\/MultiANewArrayTest\/MultiANewArrayTest.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -35,3 +35,3 @@\n- * @run main\/othervm -XX:+UseCompressedClassPointers runtime.valhalla.inlinetypes.ObjectMethods\n- * @run main\/othervm -XX:-UseCompressedClassPointers runtime.valhalla.inlinetypes.ObjectMethods\n- * @run main\/othervm -noverify runtime.valhalla.inlinetypes.ObjectMethods noverify\n+ * @run main\/othervm -XX:+EnableValhalla -XX:-EnablePrimitiveClasses -XX:+UseCompressedClassPointers runtime.valhalla.inlinetypes.ObjectMethods\n+ * @run main\/othervm -XX:+EnableValhalla -XX:-EnablePrimitiveClasses -XX:-UseCompressedClassPointers runtime.valhalla.inlinetypes.ObjectMethods\n+ * @run main\/othervm -XX:+EnableValhalla -XX:-EnablePrimitiveClasses -noverify runtime.valhalla.inlinetypes.ObjectMethods noverify\n@@ -58,1 +58,1 @@\n-        checkGetClass(val, MyInt.ref.class);\n+        checkGetClass(val, MyInt.class);\n@@ -215,2 +215,2 @@\n-    static final primitive class MyInt {\n-        final int value;\n+    static value class MyInt {\n+        int value;\n","filename":"test\/hotspot\/jtreg\/runtime\/valhalla\/inlinetypes\/ObjectMethods.java","additions":6,"deletions":6,"binary":false,"changes":12,"status":"modified"},{"patch":"@@ -33,1 +33,1 @@\n- * @run main runtime.valhalla.inlinetypes.QuickeningTest\n+ * @run main\/othervm -XX:+EnableValhalla -XX:+EnablePrimitiveClasses runtime.valhalla.inlinetypes.QuickeningTest\n","filename":"test\/hotspot\/jtreg\/runtime\/valhalla\/inlinetypes\/QuickeningTest.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -32,1 +32,1 @@\n- * @run main runtime.valhalla.inlinetypes.StaticFieldsTest\n+ * @run main\/othervm -XX:+EnableValhalla -XX:+EnablePrimitiveClasses runtime.valhalla.inlinetypes.StaticFieldsTest\n","filename":"test\/hotspot\/jtreg\/runtime\/valhalla\/inlinetypes\/StaticFieldsTest.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -30,1 +30,1 @@\n- * @run main runtime.valhalla.inlinetypes.Test8186715\n+ * @run main\/othervm -XX:+EnableValhalla -XX:+EnablePrimitiveClasses runtime.valhalla.inlinetypes.Test8186715\n","filename":"test\/hotspot\/jtreg\/runtime\/valhalla\/inlinetypes\/Test8186715.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -42,1 +42,1 @@\n- * @run main\/othervm runtime.valhalla.inlinetypes.TestBytecodeLib\n+ * @run main\/othervm -XX:+EnableValhalla -XX:+EnablePrimitiveClasses runtime.valhalla.inlinetypes.TestBytecodeLib\n","filename":"test\/hotspot\/jtreg\/runtime\/valhalla\/inlinetypes\/TestBytecodeLib.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -29,1 +29,1 @@\n- * @run main\/othervm -Xmx128m -XX:InlineFieldMaxFlatSize=32\n+ * @run main\/othervm -XX:+EnableValhalla -XX:+EnablePrimitiveClasses -Xmx128m -XX:InlineFieldMaxFlatSize=32\n","filename":"test\/hotspot\/jtreg\/runtime\/valhalla\/inlinetypes\/TestFieldNullability.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -33,1 +33,1 @@\n- * @run main\/othervm runtime.valhalla.inlinetypes.TestFieldTypeMismatch\n+ * @run main\/othervm -XX:+EnableValhalla -XX:+EnablePrimitiveClasses runtime.valhalla.inlinetypes.TestFieldTypeMismatch\n","filename":"test\/hotspot\/jtreg\/runtime\/valhalla\/inlinetypes\/TestFieldTypeMismatch.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -32,2 +32,2 @@\n- * @compile -XDallowFlattenabilityModifiers Point.java TestInheritedInlineTypeFields.java\n- * @run main\/othervm runtime.valhalla.inlinetypes.TestInheritedInlineTypeFields\n+ * @compile Point.java TestInheritedInlineTypeFields.java\n+ * @run main\/othervm -XX:+EnableValhalla -XX:+EnablePrimitiveClasses runtime.valhalla.inlinetypes.TestInheritedInlineTypeFields\n","filename":"test\/hotspot\/jtreg\/runtime\/valhalla\/inlinetypes\/TestInheritedInlineTypeFields.java","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -34,1 +34,1 @@\n- * @run main\/othervm\/native TestJNIIsSameObject\n+ * @run main\/othervm\/native -XX:+EnableValhalla -XX:+EnablePrimitiveClasses TestJNIIsSameObject\n","filename":"test\/hotspot\/jtreg\/runtime\/valhalla\/inlinetypes\/TestJNIIsSameObject.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -31,2 +31,2 @@\n- * @compile -XDallowFlattenabilityModifiers Point.java JumboInline.java UninitializedInlineFieldsTest.java\n- * @run main\/othervm -XX:InlineFieldMaxFlatSize=64 runtime.valhalla.inlinetypes.UninitializedInlineFieldsTest\n+ * @compile Point.java JumboInline.java UninitializedInlineFieldsTest.java\n+ * @run main\/othervm -XX:+EnableValhalla -XX:+EnablePrimitiveClasses -XX:InlineFieldMaxFlatSize=64 runtime.valhalla.inlinetypes.UninitializedInlineFieldsTest\n","filename":"test\/hotspot\/jtreg\/runtime\/valhalla\/inlinetypes\/UninitializedInlineFieldsTest.java","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -32,1 +32,1 @@\n- * @run main\/othervm -XX:FlatArrayElementMaxSize=-1 -XX:InlineFieldMaxFlatSize=-1 runtime.valhalla.inlinetypes.UnsafeTest\n+ * @run main\/othervm -XX:+EnableValhalla -XX:+EnablePrimitiveClasses -XX:FlatArrayElementMaxSize=-1 -XX:InlineFieldMaxFlatSize=-1 runtime.valhalla.inlinetypes.UnsafeTest\n","filename":"test\/hotspot\/jtreg\/runtime\/valhalla\/inlinetypes\/UnsafeTest.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -33,2 +33,2 @@\n- * @compile -XDallowFlattenabilityModifiers VDefaultTest.java\n- * @run main runtime.valhalla.inlinetypes.VDefaultTest\n+ * @compile VDefaultTest.java\n+ * @run main\/othervm -XX:+EnableValhalla -XX:+EnablePrimitiveClasses runtime.valhalla.inlinetypes.VDefaultTest\n","filename":"test\/hotspot\/jtreg\/runtime\/valhalla\/inlinetypes\/VDefaultTest.java","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -41,0 +41,1 @@\n+        Collections.addAll(argsList, \"-XX:+EnableValhalla\", \"-XX:-EnablePrimitiveClasses\");\n@@ -46,1 +47,1 @@\n-    static void checkFor(ProcessBuilder pb, String... outputStrings) throws Exception {\n+    static void checkFor(ProcessBuilder pb, String expected) throws Exception {\n@@ -48,3 +49,0 @@\n-        for (String s: outputStrings) {\n-            out.shouldContain(s);\n-        }\n@@ -52,0 +50,1 @@\n+        out.shouldContain(expected);\n","filename":"test\/hotspot\/jtreg\/runtime\/valhalla\/inlinetypes\/ValuePreloadTest.java","additions":3,"deletions":4,"binary":false,"changes":7,"status":"modified"},{"patch":"@@ -45,1 +45,2 @@\n- * @run main\/othervm -XX:+UnlockDiagnosticVMOptions -XX:ForceNonTearable=\n+ * @run main\/othervm -XX:+EnableValhalla -XX:+EnablePrimitiveClasses\n+ *                   -XX:+UnlockDiagnosticVMOptions -XX:ForceNonTearable=\n@@ -49,1 +50,2 @@\n- * @run main\/othervm -XX:+UnlockDiagnosticVMOptions -XX:ForceNonTearable=*\n+ * @run main\/othervm -XX:+EnableValhalla -XX:+EnablePrimitiveClasses\n+ *                   -XX:+UnlockDiagnosticVMOptions -XX:ForceNonTearable=*\n@@ -53,1 +55,2 @@\n- * @run main\/othervm -DSTEP_COUNT=10000000 -XX:InlineFieldMaxFlatSize=128 -XX:FlatArrayElementMaxSize=-1\n+ * @run main\/othervm -XX:+EnableValhalla -XX:+EnablePrimitiveClasses\n+ *                   -DSTEP_COUNT=10000000 -XX:InlineFieldMaxFlatSize=128 -XX:FlatArrayElementMaxSize=-1\n@@ -56,1 +59,2 @@\n- * @run main\/othervm -XX:+UnlockDiagnosticVMOptions -XX:ForceNonTearable=\n+ * @run main\/othervm -XX:+EnableValhalla -XX:+EnablePrimitiveClasses\n+ *                   -XX:+UnlockDiagnosticVMOptions -XX:ForceNonTearable=\n@@ -60,1 +64,2 @@\n- * @run main\/othervm -XX:+UnlockDiagnosticVMOptions -XX:ForceNonTearable=\n+ * @run main\/othervm -XX:+EnableValhalla -XX:+EnablePrimitiveClasses\n+ *                   -XX:+UnlockDiagnosticVMOptions -XX:ForceNonTearable=\n@@ -64,1 +69,2 @@\n- * @run main\/othervm -XX:+UnlockDiagnosticVMOptions -XX:ForceNonTearable=*\n+ * @run main\/othervm -XX:+EnableValhalla -XX:+EnablePrimitiveClasses\n+ *                   -XX:+UnlockDiagnosticVMOptions -XX:ForceNonTearable=*\n","filename":"test\/hotspot\/jtreg\/runtime\/valhalla\/inlinetypes\/ValueTearing.java","additions":12,"deletions":6,"binary":false,"changes":18,"status":"modified"},{"patch":"@@ -35,1 +35,1 @@\n- * @run main runtime.valhalla.inlinetypes.VarArgsArray\n+ * @run main\/othervm -XX:+EnableValhalla -XX:+EnablePrimitiveClasses runtime.valhalla.inlinetypes.VarArgsArray\n","filename":"test\/hotspot\/jtreg\/runtime\/valhalla\/inlinetypes\/VarArgsArray.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -31,1 +31,1 @@\n- * @run main\/othervm -XX:InlineFieldMaxFlatSize=128 runtime.valhalla.inlinetypes.VolatileTest\n+ * @run main\/othervm -XX:+EnableValhalla -XX:+EnablePrimitiveClasses -XX:InlineFieldMaxFlatSize=128 runtime.valhalla.inlinetypes.VolatileTest\n","filename":"test\/hotspot\/jtreg\/runtime\/valhalla\/inlinetypes\/VolatileTest.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -35,1 +35,1 @@\n- * @run main\/othervm runtime.valhalla.inlinetypes.WithFieldAccessorTest\n+ * @run main\/othervm -XX:+EnableValhalla -XX:+EnablePrimitiveClasses runtime.valhalla.inlinetypes.WithFieldAccessorTest\n","filename":"test\/hotspot\/jtreg\/runtime\/valhalla\/inlinetypes\/WithFieldAccessorTest.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -35,1 +35,1 @@\n- * @run main runtime.valhalla.inlinetypes.WithFieldTest\n+ * @run main\/othervm -XX:+EnableValhalla -XX:+EnablePrimitiveClasses runtime.valhalla.inlinetypes.WithFieldTest\n","filename":"test\/hotspot\/jtreg\/runtime\/valhalla\/inlinetypes\/WithFieldTest.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -30,1 +30,1 @@\n- * @run main\/othervm -XX:+EnableValhalla -Xverify:remote ACC_CFETest\n+ * @run main\/othervm -XX:+EnableValhalla -XX:-EnablePrimitiveClasses -Xverify:remote ACC_CFETest\n","filename":"test\/hotspot\/jtreg\/runtime\/valhalla\/inlinetypes\/classfileparser\/ACC_CFETest.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -30,1 +30,1 @@\n- * @run main\/othervm -XX:+EnableValhalla ACC_ICCETest\n+ * @run main\/othervm -XX:+EnableValhalla -XX:-EnablePrimitiveClasses ACC_ICCETest\n","filename":"test\/hotspot\/jtreg\/runtime\/valhalla\/inlinetypes\/classfileparser\/ACC_ICCETest.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2018, 2020, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2018, 2022, Oracle and\/or its affiliates. All rights reserved.\n@@ -26,2 +26,2 @@\n- * @summary test that if a class file has ACC_PRIMITIVE set then it must be run\n- *          with option -XX:+EnableValhalla.\n+ * @summary test that if a class file has ACC_VALUE or ACC_PRIMITIVE set then it must be run\n+ *          with option -XX:+ÉnableValhalla or -XX:+EnablePrimitiveClasses respectively.\n@@ -29,1 +29,2 @@\n- * @run main\/othervm -XX:-EnableValhalla BadACCValue\n+ * @run main\/othervm -XX:-EnableValhalla -XX:-EnablePrimitiveClasses BadACCValue ACC_VALUE\n+ * @run main\/othervm -XX:+EnableValhalla -XX:-EnablePrimitiveClasses BadACCValue ACC_PRIMIITVE\n@@ -35,1 +36,1 @@\n-        System.out.println(\"Testing: \" + test_name);\n+        System.out.println(\"Testing: \" + test_name + \" Expecting CFE with message: \" + message);\n@@ -38,0 +39,1 @@\n+            throw new RuntimeException(\"Managed to load primitive class with -XX:-EnablePrimitiveClasses\");\n@@ -46,4 +48,5 @@\n-\n-        \/\/ Test ACC_PRIMITIVE causes a CFE unless -XX:+EnableValhalla is specified.\n-        runTest(\"ValueFieldNotFinal\",\n-                \"Class modifier ACC_PRIMITIVE in class ValueFieldNotFinal requires option -XX:+EnableValhalla\");\n+        \/\/ Test correct error message for disabled Valhalla features\n+        String message = args[0].equals(\"ACC_VALUE\") ?\n+            \"Class modifier ACC_VALUE in class ValueFieldNotFinal requires option -XX:+EnableValhalla\" :\n+            \"Class modifier ACC_PRIMITIVE in class ValueFieldNotFinal requires option -XX:+EnablePrimitiveClasses\";\n+        runTest(\"ValueFieldNotFinal\", message);\n","filename":"test\/hotspot\/jtreg\/runtime\/valhalla\/inlinetypes\/classfileparser\/BadACCValue.java","additions":12,"deletions":9,"binary":false,"changes":21,"status":"modified"},{"patch":"@@ -29,1 +29,1 @@\n- * @run main\/othervm -Xverify:remote BadInlineTypes\n+ * @run main\/othervm -XX:+EnableValhalla -XX:+EnablePrimitiveClasses -Xverify:remote BadInlineTypes\n","filename":"test\/hotspot\/jtreg\/runtime\/valhalla\/inlinetypes\/classfileparser\/BadInlineTypes.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -0,0 +1,74 @@\n+\/*\n+ * Copyright (c) 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+ *\n+ * This code is free software; you can redistribute it and\/or modify it\n+ * under the terms of the GNU General Public License version 2 only, as\n+ * published by the Free Software Foundation.\n+ *\n+ * This code is distributed in the hope that it will be useful, but WITHOUT\n+ * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+ * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+ * version 2 for more details (a copy is included in the LICENSE file that\n+ * accompanied this code).\n+ *\n+ * You should have received a copy of the GNU General Public License version\n+ * 2 along with this work; if not, write to the Free Software Foundation,\n+ * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n+ *\n+ * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n+ * or visit www.oracle.com if you need additional information or have any\n+ * questions.\n+ *\n+ *\/\n+\/*\n+ * @test PrimitiveUsers\n+ * @summary test that if a class file uses primitive classes, -XX:+EnablePrimitiveClasses must be set.\n+ * @compile PrimitiveUsers.jcod\n+ * @run main\/othervm -XX:+EnableValhalla -XX:+EnablePrimitiveClasses PrimitiveUsers true\n+ * @run main\/othervm -XX:+EnableValhalla -XX:-EnablePrimitiveClasses PrimitiveUsers false\n+ *\/\n+\n+public class PrimitiveUsers {\n+\n+    static final String[][] TEST_CASE_ERROR = {\n+        { \"PrimitiveUsersField\",         \"Field \\\"p\\\" in class PrimitiveUsersField has illegal signature \\\"QMyPrimitive;\\\"\" },\n+        { \"PrimitiveUsersStaticQArg\",    \"Class name contains illegal Q-signature in descriptor in class file PrimitiveUsersStaticQArg, requires option -XX:+EnablePrimitiveClasses\" },\n+        { \"PrimitiveUsersStaticQReturn\", \"Class name contains illegal Q-signature in descriptor in class file PrimitiveUsersStaticQReturn, requires option -XX:+EnablePrimitiveClasses\" },\n+        { \"PrimitiveUsersQArg\",    \"Class name contains illegal Q-signature in descriptor in class file PrimitiveUsersQArg, requires option -XX:+EnablePrimitiveClasses\" },\n+        { \"PrimitiveUsersQReturn\", \"Class name contains illegal Q-signature in descriptor in class file PrimitiveUsersQReturn, requires option -XX:+EnablePrimitiveClasses\" }\n+    };\n+\n+    public static void testLoadCasesEnabled() throws Throwable {\n+        for (String[] caseAndError : TEST_CASE_ERROR) {\n+            Class.forName(caseAndError[0]);\n+        }\n+    }\n+\n+    public static void testLoadCasesDisabled() throws Throwable {\n+        for (String[] caseAndError : TEST_CASE_ERROR) {\n+            try {\n+                Class.forName(caseAndError[0]);\n+                throw new RuntimeException(\"Test case \" + caseAndError[0] + \" loaded with out failure\");\n+            } catch (Throwable t) {\n+                if (!(t instanceof ClassFormatError)) {\n+                    t.printStackTrace();\n+                    throw t;\n+                }\n+                if (!t.getMessage().equals(caseAndError[1])) {\n+                    t.printStackTrace();\n+                    throw new RuntimeException(\"Wrong CFE error: \" +  t.getMessage() + \" expected: \" + caseAndError[1]);\n+                }\n+            }\n+        }\n+    }\n+\n+    public static void main(String[] args) throws Throwable {\n+        if (args[0].equals(\"true\")) {\n+            testLoadCasesEnabled();\n+        } else {\n+            \/\/ Test correct error message for disabled primitive class feature\n+            testLoadCasesDisabled();\n+        }\n+    }\n+}\n","filename":"test\/hotspot\/jtreg\/runtime\/valhalla\/inlinetypes\/classfileparser\/PrimitiveUsers.java","additions":74,"deletions":0,"binary":false,"changes":74,"status":"added"},{"patch":"@@ -0,0 +1,588 @@\n+\/*\n+ * Copyright (c) 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+ *\n+ * This code is free software; you can redistribute it and\/or modify it\n+ * under the terms of the GNU General Public License version 2 only, as\n+ * published by the Free Software Foundation.\n+ *\n+ * This code is distributed in the hope that it will be useful, but WITHOUT\n+ * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+ * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+ * version 2 for more details (a copy is included in the LICENSE file that\n+ * accompanied this code).\n+ *\n+ * You should have received a copy of the GNU General Public License version\n+ * 2 along with this work; if not, write to the Free Software Foundation,\n+ * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n+ *\n+ * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n+ * or visit www.oracle.com if you need additional information or have any\n+ * questions.\n+ *\n+ *\/\n+\n+\n+\/*\n+ These test classes contains variations of Q-type signature uses which should\n+ only work with +EnablePrimitiveClasses\n+\n+ The original source with all the illegal cases looks like this, then below\n+ are classes with a single aspect declared (for each line in the prototype\n+ class listed)\n+\n+ public class PrimitiveUsers {\n+    MyPrimitive p;\n+    public static void staticCheckQArg(MyPrimitive p) {}\n+    public static MyPrimitive staticCheckQReturn() { return MyPrimitive.default; }\n+    public void checkQArg(MyPrimitive p) {}\n+    public MyPrimitive checkQReturn() { return MyPrimitive.default; }\n+ }\n+*\/\n+\n+\/\/ Use Q-signature field...\n+\n+class PrimitiveUsersField {\n+  0xCAFEBABE;\n+  0; \/\/ minor version\n+  64; \/\/ version\n+  [] { \/\/ Constant Pool\n+    ; \/\/ first element is empty\n+    Method #2 #3; \/\/ #1\n+    class #4; \/\/ #2\n+    NameAndType #5 #6; \/\/ #3\n+    Utf8 \"java\/lang\/Object\"; \/\/ #4\n+    Utf8 \"<init>\"; \/\/ #5\n+    Utf8 \"()V\"; \/\/ #6\n+    class #8; \/\/ #7\n+    Utf8 \"PrimitiveUsersField\"; \/\/ #8\n+    Utf8 \"p\"; \/\/ #9\n+    Utf8 \"QMyPrimitive;\"; \/\/ #10\n+    Utf8 \"Code\"; \/\/ #11\n+    Utf8 \"LineNumberTable\"; \/\/ #12\n+    Utf8 \"SourceFile\"; \/\/ #13\n+    Utf8 \"PrimitiveUsersField.java\"; \/\/ #14\n+  } \/\/ Constant Pool\n+\n+  0x0021; \/\/ access\n+  #7;\/\/ this_cpx\n+  #2;\/\/ super_cpx\n+\n+  [] { \/\/ Interfaces\n+  } \/\/ Interfaces\n+\n+  [] { \/\/ Fields\n+    {  \/\/ field\n+      0x0000; \/\/ access\n+      #9; \/\/ name_index\n+      #10; \/\/ descriptor_index\n+      [] { \/\/ Attributes\n+      } \/\/ Attributes\n+    }\n+  } \/\/ Fields\n+\n+  [] { \/\/ Methods\n+    {  \/\/ method\n+      0x0001; \/\/ access\n+      #5; \/\/ name_index\n+      #6; \/\/ descriptor_index\n+      [] { \/\/ Attributes\n+        Attr(#11) { \/\/ Code\n+          1; \/\/ max_stack\n+          1; \/\/ max_locals\n+          Bytes[]{\n+            0x2AB70001B1;\n+          }\n+          [] { \/\/ Traps\n+          } \/\/ end Traps\n+          [] { \/\/ Attributes\n+            Attr(#12) { \/\/ LineNumberTable\n+              [] { \/\/ line_number_table\n+                0  2;\n+              }\n+            } \/\/ end LineNumberTable\n+          } \/\/ Attributes\n+        } \/\/ end Code\n+      } \/\/ Attributes\n+    }\n+  } \/\/ Methods\n+\n+  [] { \/\/ Attributes\n+    Attr(#13) { \/\/ SourceFile\n+      #14;\n+    } \/\/ end SourceFile\n+  } \/\/ Attributes\n+} \/\/ end class PrimitiveUsersField\n+\n+\n+\/\/ Static method q-sig in arg\n+\n+class PrimitiveUsersStaticQArg {\n+  0xCAFEBABE;\n+  0; \/\/ minor version\n+  64; \/\/ version\n+  [] { \/\/ Constant Pool\n+    ; \/\/ first element is empty\n+    Method #2 #3; \/\/ #1\n+    class #4; \/\/ #2\n+    NameAndType #5 #6; \/\/ #3\n+    Utf8 \"java\/lang\/Object\"; \/\/ #4\n+    Utf8 \"<init>\"; \/\/ #5\n+    Utf8 \"()V\"; \/\/ #6\n+    class #8; \/\/ #7\n+    Utf8 \"PrimitiveUsersStaticQArg\"; \/\/ #8\n+    Utf8 \"Code\"; \/\/ #9\n+    Utf8 \"LineNumberTable\"; \/\/ #10\n+    Utf8 \"staticCheckQArg\"; \/\/ #11\n+    Utf8 \"(QMyPrimitive;)V\"; \/\/ #12\n+    Utf8 \"SourceFile\"; \/\/ #13\n+    Utf8 \"PrimitiveUsersStaticQArg.java\"; \/\/ #14\n+  } \/\/ Constant Pool\n+\n+  0x0021; \/\/ access\n+  #7;\/\/ this_cpx\n+  #2;\/\/ super_cpx\n+\n+  [] { \/\/ Interfaces\n+  } \/\/ Interfaces\n+\n+  [] { \/\/ Fields\n+  } \/\/ Fields\n+\n+  [] { \/\/ Methods\n+    {  \/\/ method\n+      0x0001; \/\/ access\n+      #5; \/\/ name_index\n+      #6; \/\/ descriptor_index\n+      [] { \/\/ Attributes\n+        Attr(#9) { \/\/ Code\n+          1; \/\/ max_stack\n+          1; \/\/ max_locals\n+          Bytes[]{\n+            0x2AB70001B1;\n+          }\n+          [] { \/\/ Traps\n+          } \/\/ end Traps\n+          [] { \/\/ Attributes\n+            Attr(#10) { \/\/ LineNumberTable\n+              [] { \/\/ line_number_table\n+                0  2;\n+              }\n+            } \/\/ end LineNumberTable\n+          } \/\/ Attributes\n+        } \/\/ end Code\n+      } \/\/ Attributes\n+    }\n+    ;\n+    {  \/\/ method\n+      0x0009; \/\/ access\n+      #11; \/\/ name_index\n+      #12; \/\/ descriptor_index\n+      [] { \/\/ Attributes\n+        Attr(#9) { \/\/ Code\n+          0; \/\/ max_stack\n+          1; \/\/ max_locals\n+          Bytes[]{\n+            0xB1;\n+          }\n+          [] { \/\/ Traps\n+          } \/\/ end Traps\n+          [] { \/\/ Attributes\n+            Attr(#10) { \/\/ LineNumberTable\n+              [] { \/\/ line_number_table\n+                0  4;\n+              }\n+            } \/\/ end LineNumberTable\n+          } \/\/ Attributes\n+        } \/\/ end Code\n+      } \/\/ Attributes\n+    }\n+  } \/\/ Methods\n+\n+  [] { \/\/ Attributes\n+    Attr(#13) { \/\/ SourceFile\n+      #14;\n+    } \/\/ end SourceFile\n+  } \/\/ Attributes\n+} \/\/ end class PrimitiveUsersStaticQArg\n+\n+\/\/ Static method q-sig in return\n+\n+class PrimitiveUsersStaticQReturn {\n+  0xCAFEBABE;\n+  0; \/\/ minor version\n+  64; \/\/ version\n+  [] { \/\/ Constant Pool\n+    ; \/\/ first element is empty\n+    Method #2 #3; \/\/ #1\n+    class #4; \/\/ #2\n+    NameAndType #5 #6; \/\/ #3\n+    Utf8 \"java\/lang\/Object\"; \/\/ #4\n+    Utf8 \"<init>\"; \/\/ #5\n+    Utf8 \"()V\"; \/\/ #6\n+    class #8; \/\/ #7\n+    Utf8 \"MyPrimitive\"; \/\/ #8\n+    class #10; \/\/ #9\n+    Utf8 \"PrimitiveUsersStaticQReturn\"; \/\/ #10\n+    Utf8 \"Code\"; \/\/ #11\n+    Utf8 \"LineNumberTable\"; \/\/ #12\n+    Utf8 \"staticCheckQReturn\"; \/\/ #13\n+    Utf8 \"()QMyPrimitive;\"; \/\/ #14\n+    Utf8 \"SourceFile\"; \/\/ #15\n+    Utf8 \"PrimitiveUsersStaticQReturn.java\"; \/\/ #16\n+  } \/\/ Constant Pool\n+\n+  0x0021; \/\/ access\n+  #9;\/\/ this_cpx\n+  #2;\/\/ super_cpx\n+\n+  [] { \/\/ Interfaces\n+  } \/\/ Interfaces\n+\n+  [] { \/\/ Fields\n+  } \/\/ Fields\n+\n+  [] { \/\/ Methods\n+    {  \/\/ method\n+      0x0001; \/\/ access\n+      #5; \/\/ name_index\n+      #6; \/\/ descriptor_index\n+      [] { \/\/ Attributes\n+        Attr(#11) { \/\/ Code\n+          1; \/\/ max_stack\n+          1; \/\/ max_locals\n+          Bytes[]{\n+            0x2AB70001B1;\n+          }\n+          [] { \/\/ Traps\n+          } \/\/ end Traps\n+          [] { \/\/ Attributes\n+            Attr(#12) { \/\/ LineNumberTable\n+              [] { \/\/ line_number_table\n+                0  2;\n+              }\n+            } \/\/ end LineNumberTable\n+          } \/\/ Attributes\n+        } \/\/ end Code\n+      } \/\/ Attributes\n+    }\n+    ;\n+    {  \/\/ method\n+      0x0009; \/\/ access\n+      #13; \/\/ name_index\n+      #14; \/\/ descriptor_index\n+      [] { \/\/ Attributes\n+        Attr(#11) { \/\/ Code\n+          1; \/\/ max_stack\n+          0; \/\/ max_locals\n+          Bytes[]{\n+            0xCB0007B0;\n+          }\n+          [] { \/\/ Traps\n+          } \/\/ end Traps\n+          [] { \/\/ Attributes\n+            Attr(#12) { \/\/ LineNumberTable\n+              [] { \/\/ line_number_table\n+                0  5;\n+              }\n+            } \/\/ end LineNumberTable\n+          } \/\/ Attributes\n+        } \/\/ end Code\n+      } \/\/ Attributes\n+    }\n+  } \/\/ Methods\n+\n+  [] { \/\/ Attributes\n+    Attr(#15) { \/\/ SourceFile\n+      #16;\n+    } \/\/ end SourceFile\n+  } \/\/ Attributes\n+} \/\/ end class PrimitiveUsersStaticQReturn\n+\n+\/\/ Method with q-sig in arg\n+\n+class PrimitiveUsersQArg {\n+  0xCAFEBABE;\n+  0; \/\/ minor version\n+  64; \/\/ version\n+  [] { \/\/ Constant Pool\n+    ; \/\/ first element is empty\n+    Method #2 #3; \/\/ #1\n+    class #4; \/\/ #2\n+    NameAndType #5 #6; \/\/ #3\n+    Utf8 \"java\/lang\/Object\"; \/\/ #4\n+    Utf8 \"<init>\"; \/\/ #5\n+    Utf8 \"()V\"; \/\/ #6\n+    class #8; \/\/ #7\n+    Utf8 \"PrimitiveUsersQArg\"; \/\/ #8\n+    Utf8 \"Code\"; \/\/ #9\n+    Utf8 \"LineNumberTable\"; \/\/ #10\n+    Utf8 \"checkQArg\"; \/\/ #11\n+    Utf8 \"(QMyPrimitive;)V\"; \/\/ #12\n+    Utf8 \"SourceFile\"; \/\/ #13\n+    Utf8 \"PrimitiveUsersQArg.java\"; \/\/ #14\n+  } \/\/ Constant Pool\n+\n+  0x0021; \/\/ access\n+  #7;\/\/ this_cpx\n+  #2;\/\/ super_cpx\n+\n+  [] { \/\/ Interfaces\n+  } \/\/ Interfaces\n+\n+  [] { \/\/ Fields\n+  } \/\/ Fields\n+\n+  [] { \/\/ Methods\n+    {  \/\/ method\n+      0x0001; \/\/ access\n+      #5; \/\/ name_index\n+      #6; \/\/ descriptor_index\n+      [] { \/\/ Attributes\n+        Attr(#9) { \/\/ Code\n+          1; \/\/ max_stack\n+          1; \/\/ max_locals\n+          Bytes[]{\n+            0x2AB70001B1;\n+          }\n+          [] { \/\/ Traps\n+          } \/\/ end Traps\n+          [] { \/\/ Attributes\n+            Attr(#10) { \/\/ LineNumberTable\n+              [] { \/\/ line_number_table\n+                0  2;\n+              }\n+            } \/\/ end LineNumberTable\n+          } \/\/ Attributes\n+        } \/\/ end Code\n+      } \/\/ Attributes\n+    }\n+    ;\n+    {  \/\/ method\n+      0x0001; \/\/ access\n+      #11; \/\/ name_index\n+      #12; \/\/ descriptor_index\n+      [] { \/\/ Attributes\n+        Attr(#9) { \/\/ Code\n+          0; \/\/ max_stack\n+          2; \/\/ max_locals\n+          Bytes[]{\n+            0xB1;\n+          }\n+          [] { \/\/ Traps\n+          } \/\/ end Traps\n+          [] { \/\/ Attributes\n+            Attr(#10) { \/\/ LineNumberTable\n+              [] { \/\/ line_number_table\n+                0  6;\n+              }\n+            } \/\/ end LineNumberTable\n+          } \/\/ Attributes\n+        } \/\/ end Code\n+      } \/\/ Attributes\n+    }\n+  } \/\/ Methods\n+\n+  [] { \/\/ Attributes\n+    Attr(#13) { \/\/ SourceFile\n+      #14;\n+    } \/\/ end SourceFile\n+  } \/\/ Attributes\n+} \/\/ end class PrimitiveUsersQArg\n+\n+\/\/ Method with q-sig in return\n+\n+class PrimitiveUsersQReturn {\n+  0xCAFEBABE;\n+  0; \/\/ minor version\n+  64; \/\/ version\n+  [] { \/\/ Constant Pool\n+    ; \/\/ first element is empty\n+    Method #2 #3; \/\/ #1\n+    class #4; \/\/ #2\n+    NameAndType #5 #6; \/\/ #3\n+    Utf8 \"java\/lang\/Object\"; \/\/ #4\n+    Utf8 \"<init>\"; \/\/ #5\n+    Utf8 \"()V\"; \/\/ #6\n+    class #8; \/\/ #7\n+    Utf8 \"MyPrimitive\"; \/\/ #8\n+    class #10; \/\/ #9\n+    Utf8 \"PrimitiveUsersQReturn\"; \/\/ #10\n+    Utf8 \"Code\"; \/\/ #11\n+    Utf8 \"LineNumberTable\"; \/\/ #12\n+    Utf8 \"checkQReturn\"; \/\/ #13\n+    Utf8 \"()QMyPrimitive;\"; \/\/ #14\n+    Utf8 \"SourceFile\"; \/\/ #15\n+    Utf8 \"PrimitiveUsersQReturn.java\"; \/\/ #16\n+  } \/\/ Constant Pool\n+\n+  0x0021; \/\/ access\n+  #9;\/\/ this_cpx\n+  #2;\/\/ super_cpx\n+\n+  [] { \/\/ Interfaces\n+  } \/\/ Interfaces\n+\n+  [] { \/\/ Fields\n+  } \/\/ Fields\n+\n+  [] { \/\/ Methods\n+    {  \/\/ method\n+      0x0001; \/\/ access\n+      #5; \/\/ name_index\n+      #6; \/\/ descriptor_index\n+      [] { \/\/ Attributes\n+        Attr(#11) { \/\/ Code\n+          1; \/\/ max_stack\n+          1; \/\/ max_locals\n+          Bytes[]{\n+            0x2AB70001B1;\n+          }\n+          [] { \/\/ Traps\n+          } \/\/ end Traps\n+          [] { \/\/ Attributes\n+            Attr(#12) { \/\/ LineNumberTable\n+              [] { \/\/ line_number_table\n+                0  2;\n+              }\n+            } \/\/ end LineNumberTable\n+          } \/\/ Attributes\n+        } \/\/ end Code\n+      } \/\/ Attributes\n+    }\n+    ;\n+    {  \/\/ method\n+      0x0001; \/\/ access\n+      #13; \/\/ name_index\n+      #14; \/\/ descriptor_index\n+      [] { \/\/ Attributes\n+        Attr(#11) { \/\/ Code\n+          1; \/\/ max_stack\n+          1; \/\/ max_locals\n+          Bytes[]{\n+            0xCB0007B0;\n+          }\n+          [] { \/\/ Traps\n+          } \/\/ end Traps\n+          [] { \/\/ Attributes\n+            Attr(#12) { \/\/ LineNumberTable\n+              [] { \/\/ line_number_table\n+                0  7;\n+              }\n+            } \/\/ end LineNumberTable\n+          } \/\/ Attributes\n+        } \/\/ end Code\n+      } \/\/ Attributes\n+    }\n+  } \/\/ Methods\n+\n+  [] { \/\/ Attributes\n+    Attr(#15) { \/\/ SourceFile\n+      #16;\n+    } \/\/ end SourceFile\n+  } \/\/ Attributes\n+} \/\/ end class PrimitiveUsersQReturn\n+\n+\n+\/\/ Legal primitive class MyPrimitive for enabled use cases\n+\n+class MyPrimitive {\n+  0xCAFEBABE;\n+  0; \/\/ minor version\n+  64; \/\/ version\n+  [] { \/\/ Constant Pool\n+    ; \/\/ first element is empty\n+    Method #2 #3; \/\/ #1\n+    class #4; \/\/ #2\n+    NameAndType #5 #6; \/\/ #3\n+    Utf8 \"MyPrimitive\"; \/\/ #4\n+    Utf8 \"<init>\"; \/\/ #5\n+    Utf8 \"(I)QMyPrimitive;\"; \/\/ #6\n+    Field #2 #8; \/\/ #7\n+    NameAndType #9 #10; \/\/ #8\n+    Utf8 \"id\"; \/\/ #9\n+    Utf8 \"I\"; \/\/ #10\n+    class #12; \/\/ #11\n+    Utf8 \"java\/lang\/Object\"; \/\/ #12\n+    Utf8 \"()QMyPrimitive;\"; \/\/ #13\n+    Utf8 \"Code\"; \/\/ #14\n+    Utf8 \"LineNumberTable\"; \/\/ #15\n+    Utf8 \"SourceFile\"; \/\/ #16\n+    Utf8 \"MyPrimitive.java\"; \/\/ #17\n+  } \/\/ Constant Pool\n+\n+  0x0851; \/\/ access\n+  #2;\/\/ this_cpx\n+  #11;\/\/ super_cpx\n+\n+  [] { \/\/ Interfaces\n+  } \/\/ Interfaces\n+\n+  [] { \/\/ Fields\n+    {  \/\/ field\n+      0x0010; \/\/ access\n+      #9; \/\/ name_index\n+      #10; \/\/ descriptor_index\n+      [] { \/\/ Attributes\n+      } \/\/ Attributes\n+    }\n+  } \/\/ Fields\n+\n+  [] { \/\/ Methods\n+    {  \/\/ method\n+      0x0009; \/\/ access\n+      #5; \/\/ name_index\n+      #13; \/\/ descriptor_index\n+      [] { \/\/ Attributes\n+        Attr(#14) { \/\/ Code\n+          1; \/\/ max_stack\n+          1; \/\/ max_locals\n+          Bytes[]{\n+            0x03B800014B2AB0;\n+          }\n+          [] { \/\/ Traps\n+          } \/\/ end Traps\n+          [] { \/\/ Attributes\n+            Attr(#15) { \/\/ LineNumberTable\n+              [] { \/\/ line_number_table\n+                0  6;\n+              }\n+            } \/\/ end LineNumberTable\n+          } \/\/ Attributes\n+        } \/\/ end Code\n+      } \/\/ Attributes\n+    }\n+    ;\n+    {  \/\/ method\n+      0x0009; \/\/ access\n+      #5; \/\/ name_index\n+      #6; \/\/ descriptor_index\n+      [] { \/\/ Attributes\n+        Attr(#14) { \/\/ Code\n+          2; \/\/ max_stack\n+          2; \/\/ max_locals\n+          Bytes[]{\n+            0xCB00024C1A2B5FCC;\n+            0x00074C2BB0;\n+          }\n+          [] { \/\/ Traps\n+          } \/\/ end Traps\n+          [] { \/\/ Attributes\n+            Attr(#15) { \/\/ LineNumberTable\n+              [] { \/\/ line_number_table\n+                0  7;\n+              }\n+            } \/\/ end LineNumberTable\n+          } \/\/ Attributes\n+        } \/\/ end Code\n+      } \/\/ Attributes\n+    }\n+  } \/\/ Methods\n+\n+  [] { \/\/ Attributes\n+    Attr(#16) { \/\/ SourceFile\n+      #17;\n+    } \/\/ end SourceFile\n+  } \/\/ Attributes\n+} \/\/ end class MyPrimitive\n+\n","filename":"test\/hotspot\/jtreg\/runtime\/valhalla\/inlinetypes\/classfileparser\/PrimitiveUsers.jcod","additions":588,"deletions":0,"binary":false,"changes":588,"status":"added"},{"patch":"@@ -33,1 +33,1 @@\n- * @run main\/othervm -verify TestClassModifiers\n+ * @run main\/othervm -XX:+EnableValhalla -XX:-EnablePrimitiveClasses -verify TestClassModifiers\n","filename":"test\/hotspot\/jtreg\/runtime\/valhalla\/inlinetypes\/testClassModifiers\/TestClassModifiers.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -32,1 +32,1 @@\n- * @run main\/othervm -verify TestSuperClasses\n+ * @run main\/othervm -XX:+EnableValhalla -XX:+EnablePrimitiveClasses -verify TestSuperClasses\n","filename":"test\/hotspot\/jtreg\/runtime\/valhalla\/inlinetypes\/testSupers\/TestSuperClasses.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -27,1 +27,1 @@\n- * @run main\/othervm -Xverify:remote VTAssignability\n+ * @run main\/othervm -XX:+EnableValhalla -XX:+EnablePrimitiveClasses -Xverify:remote VTAssignability\n","filename":"test\/hotspot\/jtreg\/runtime\/valhalla\/inlinetypes\/verifier\/VTAssignability.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -28,1 +28,1 @@\n- * @run main\/othervm -Xverify:remote VTMonitor\n+ * @run main\/othervm -XX:+EnableValhalla -XX:+EnablePrimitiveClasses -Xverify:remote VTMonitor\n","filename":"test\/hotspot\/jtreg\/runtime\/valhalla\/inlinetypes\/verifier\/VTMonitor.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -30,1 +30,1 @@\n- * @run main\/othervm -verify VerifierInlineTypes\n+ * @run main\/othervm -XX:+EnableValhalla -XX:+EnablePrimitiveClasses -verify VerifierInlineTypes\n","filename":"test\/hotspot\/jtreg\/runtime\/valhalla\/inlinetypes\/verifier\/VerifierInlineTypes.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -30,1 +30,1 @@\n- * @run main\/othervm -Xverify:remote RunWithfieldTests\n+ * @run main\/othervm -XX:+EnableValhalla -XX:+EnablePrimitiveClasses -Xverify:remote RunWithfieldTests\n","filename":"test\/hotspot\/jtreg\/runtime\/valhalla\/inlinetypes\/withfieldTests\/RunWithfieldTests.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -30,1 +30,1 @@\n- * @run main\/othervm\/native -agentlib:FieldAccessModify FieldAccessModify\n+ * @run main\/othervm\/native -agentlib:FieldAccessModify -XX:+EnableValhalla -XX:+EnablePrimitiveClasses FieldAccessModify\n","filename":"test\/hotspot\/jtreg\/serviceability\/jvmti\/Valhalla\/FieldAccessModify\/FieldAccessModify.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -28,1 +28,1 @@\n- * @run main HeapDump\n+ * @run main\/othervm -XX:+EnableValhalla -XX:+EnablePrimitiveClasses HeapDump\n","filename":"test\/hotspot\/jtreg\/serviceability\/jvmti\/Valhalla\/HeapDump\/HeapDump.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -308,0 +308,1 @@\n+                        \"-XX:+EnableValhalla\", \"-XX:+EnablePrimitiveClasses\",\n","filename":"test\/jdk\/java\/lang\/instrument\/valhalla\/RedefinePrimitive.java","additions":1,"deletions":0,"binary":false,"changes":1,"status":"modified"},{"patch":"@@ -28,2 +28,2 @@\n- * @run testng\/othervm -XX:FlatArrayElementMaxSize=-1 ArrayElementVarHandleTest\n- * @run testng\/othervm -XX:FlatArrayElementMaxSize=0  ArrayElementVarHandleTest\n+ * @run testng\/othervm -XX:+EnableValhalla -XX:+EnablePrimitiveClasses -XX:FlatArrayElementMaxSize=-1 ArrayElementVarHandleTest\n+ * @run testng\/othervm -XX:+EnableValhalla -XX:+EnablePrimitiveClasses -XX:FlatArrayElementMaxSize=0  ArrayElementVarHandleTest\n","filename":"test\/jdk\/valhalla\/valuetypes\/ArrayElementVarHandleTest.java","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -29,1 +29,1 @@\n- * @run testng\/othervm --enable-preview BasicTest\n+ * @run testng\/othervm --enable-preview -XX:+EnableValhalla -XX:+EnablePrimitiveClasses BasicTest\n","filename":"test\/jdk\/valhalla\/valuetypes\/BasicTest.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -26,1 +26,1 @@\n- * @run testng\/othervm LambdaConversion\n+ * @run testng\/othervm -XX:+EnableValhalla -XX:+EnablePrimitiveClasses LambdaConversion\n","filename":"test\/jdk\/valhalla\/valuetypes\/LambdaConversion.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -27,1 +27,1 @@\n- * @run testng\/othervm LambdaTest\n+ * @run testng\/othervm -XX:+EnableValhalla -XX:+EnablePrimitiveClasses LambdaTest\n","filename":"test\/jdk\/valhalla\/valuetypes\/LambdaTest.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -28,2 +28,2 @@\n- * @run testng\/othervm --enable-preview -XX:InlineFieldMaxFlatSize=128 MHZeroValue\n- * @run testng\/othervm --enable-preview -XX:InlineFieldMaxFlatSize=0 MHZeroValue\n+ * @run testng\/othervm --enable-preview -XX:+EnableValhalla -XX:+EnablePrimitiveClasses -XX:InlineFieldMaxFlatSize=128 MHZeroValue\n+ * @run testng\/othervm --enable-preview -XX:+EnableValhalla -XX:+EnablePrimitiveClasses -XX:InlineFieldMaxFlatSize=0 MHZeroValue\n","filename":"test\/jdk\/valhalla\/valuetypes\/MHZeroValue.java","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -28,1 +28,1 @@\n- * @run testng\/othervm MethodHandleTest\n+ * @run testng\/othervm -XX:+EnableValhalla -XX:+EnablePrimitiveClasses MethodHandleTest\n","filename":"test\/jdk\/valhalla\/valuetypes\/MethodHandleTest.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -26,1 +26,1 @@\n- * @run main MethodReference\n+ * @run main\/othervm -XX:+EnableValhalla -XX:+EnablePrimitiveClasses MethodReference\n","filename":"test\/jdk\/valhalla\/valuetypes\/MethodReference.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -26,1 +26,1 @@\n- * @run main Nest\n+ * @run main\/othervm -XX:+EnableValhalla -XX:+EnablePrimitiveClasses Nest\n","filename":"test\/jdk\/valhalla\/valuetypes\/Nest.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -28,2 +28,2 @@\n- * @run testng\/othervm -Dvalue.bsm.salt=1 ObjectMethods\n- * @run testng\/othervm -Dvalue.bsm.salt=1 -XX:InlineFieldMaxFlatSize=0 ObjectMethods\n+ * @run testng\/othervm -XX:+EnableValhalla -XX:+EnablePrimitiveClasses -Dvalue.bsm.salt=1 ObjectMethods\n+ * @run testng\/othervm -XX:+EnableValhalla -XX:+EnablePrimitiveClasses -Dvalue.bsm.salt=1 -XX:InlineFieldMaxFlatSize=0 ObjectMethods\n","filename":"test\/jdk\/valhalla\/valuetypes\/ObjectMethods.java","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -28,1 +28,1 @@\n- * @run testng ObjectMethodsViaCondy\n+ * @run testng\/othervm -XX:+EnableValhalla -XX:+EnablePrimitiveClasses ObjectMethodsViaCondy\n","filename":"test\/jdk\/valhalla\/valuetypes\/ObjectMethodsViaCondy.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -26,1 +26,2 @@\n- * @run testng\/othervm ObjectNewInstance\n+ * @run testng\/othervm -XX:+EnableValhalla -XX:+EnablePrimitiveClasses ObjectNewInstance\n+ * @run testng\/othervm -XX:+EnableValhalla -XX:-EnablePrimitiveClasses ObjectNewInstance\n","filename":"test\/jdk\/valhalla\/valuetypes\/ObjectNewInstance.java","additions":2,"deletions":1,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -28,1 +28,1 @@\n- * @run testng\/othervm PrimitiveTypeConversionTest\n+ * @run testng\/othervm -XX:+EnableValhalla -XX:+EnablePrimitiveClasses PrimitiveTypeConversionTest\n","filename":"test\/jdk\/valhalla\/valuetypes\/PrimitiveTypeConversionTest.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -27,1 +27,1 @@\n- * @run testng\/othervm ProxyTest\n+ * @run testng\/othervm -XX:+EnableValhalla -XX:+EnablePrimitiveClasses ProxyTest\n","filename":"test\/jdk\/valhalla\/valuetypes\/ProxyTest.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -28,2 +28,2 @@\n- * @run testng\/othervm QTypeDescriptorTest\n- * @run testng\/othervm -Dsun.reflect.noInflation=true QTypeDescriptorTest\n+ * @run testng\/othervm -XX:+EnableValhalla -XX:+EnablePrimitiveClasses QTypeDescriptorTest\n+ * @run testng\/othervm -XX:+EnableValhalla -XX:+EnablePrimitiveClasses -Dsun.reflect.noInflation=true QTypeDescriptorTest\n","filename":"test\/jdk\/valhalla\/valuetypes\/QTypeDescriptorTest.java","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -29,1 +29,1 @@\n- * @run testng\/othervm --enable-preview Reflection\n+ * @run testng\/othervm --enable-preview -XX:+EnableValhalla -XX:+EnablePrimitiveClasses Reflection\n","filename":"test\/jdk\/valhalla\/valuetypes\/Reflection.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -28,1 +28,1 @@\n- * @run testng\/othervm Serialization\n+ * @run testng\/othervm -XX:+EnableValhalla -XX:+EnablePrimitiveClasses Serialization\n","filename":"test\/jdk\/valhalla\/valuetypes\/Serialization.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -28,1 +28,1 @@\n- * @run testng\/othervm StaticFactoryMethodHandleTest\n+ * @run testng\/othervm -XX:+EnableValhalla -XX:+EnablePrimitiveClasses StaticFactoryMethodHandleTest\n","filename":"test\/jdk\/valhalla\/valuetypes\/StaticFactoryMethodHandleTest.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -29,1 +29,1 @@\n- * @run testng\/othervm StaticFactoryTest\n+ * @run testng\/othervm -XX:+EnableValhalla -XX:+EnablePrimitiveClasses StaticFactoryTest\n","filename":"test\/jdk\/valhalla\/valuetypes\/StaticFactoryTest.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -28,1 +28,1 @@\n- * @run testng StreamTest\n+ * @run testng\/othervm -XX:+EnableValhalla -XX:+EnablePrimitiveClasses StreamTest\n","filename":"test\/jdk\/valhalla\/valuetypes\/StreamTest.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -29,1 +29,1 @@\n- * @run testng SubstitutabilityTest\n+ * @run testng\/othervm -XX:+EnableValhalla -XX:+EnablePrimitiveClasses SubstitutabilityTest\n","filename":"test\/jdk\/valhalla\/valuetypes\/SubstitutabilityTest.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -28,2 +28,2 @@\n- * @run testng\/othervm --enable-preview -XX:InlineFieldMaxFlatSize=128 UninitializedValueTest\n- * @run testng\/othervm --enable-preview -XX:InlineFieldMaxFlatSize=0 UninitializedValueTest\n+ * @run testng\/othervm --enable-preview -XX:+EnableValhalla -XX:+EnablePrimitiveClasses -XX:InlineFieldMaxFlatSize=128 UninitializedValueTest\n+ * @run testng\/othervm --enable-preview -XX:+EnableValhalla -XX:+EnablePrimitiveClasses -XX:InlineFieldMaxFlatSize=0 UninitializedValueTest\n","filename":"test\/jdk\/valhalla\/valuetypes\/UninitializedValueTest.java","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -27,2 +27,2 @@\n- * @run testng\/othervm -XX:FlatArrayElementMaxSize=-1 ValueArray\n- * @run testng\/othervm -XX:FlatArrayElementMaxSize=0  ValueArray\n+ * @run testng\/othervm -XX:+EnableValhalla -XX:+EnablePrimitiveClasses -XX:FlatArrayElementMaxSize=-1 ValueArray\n+ * @run testng\/othervm -XX:+EnableValhalla -XX:+EnablePrimitiveClasses -XX:FlatArrayElementMaxSize=0  ValueArray\n","filename":"test\/jdk\/valhalla\/valuetypes\/ValueArray.java","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -29,1 +29,1 @@\n- * @run testng\/othervm --enable-preview ValueConstantDesc\n+ * @run testng\/othervm --enable-preview -XX:+EnableValhalla -XX:+EnablePrimitiveClasses ValueConstantDesc\n","filename":"test\/jdk\/valhalla\/valuetypes\/ValueConstantDesc.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -35,1 +35,1 @@\n- * @run testng\/othervm WeakReferenceTest\n+ * @run testng\/othervm -XX:+EnableValhalla -XX:+EnablePrimitiveClasses WeakReferenceTest\n","filename":"test\/jdk\/valhalla\/valuetypes\/WeakReferenceTest.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"}]}