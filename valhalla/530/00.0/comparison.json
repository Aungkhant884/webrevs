{"files":[{"patch":"@@ -123,3 +123,0 @@\n-        dfltTargetMeta = new Name[] { names.PACKAGE, names.TYPE,\n-            names.FIELD, names.RECORD_COMPONENT, names.METHOD, names.CONSTRUCTOR,\n-            names.ANNOTATION_TYPE, names.LOCAL_VARIABLE, names.PARAMETER, names.MODULE };\n@@ -164,0 +161,1 @@\n+        allowModules = Feature.MODULES.allowedInSource(source);\n@@ -198,0 +196,4 @@\n+    \/** Are modules allowed\n+     *\/\n+    private final boolean allowModules;\n+\n@@ -3486,14 +3488,1 @@\n-            Set<Name> targets = new HashSet<>();\n-            targets.add(names.ANNOTATION_TYPE);\n-            targets.add(names.CONSTRUCTOR);\n-            targets.add(names.FIELD);\n-            if (allowRecords) {\n-                targets.add(names.RECORD_COMPONENT);\n-            }\n-            targets.add(names.LOCAL_VARIABLE);\n-            targets.add(names.METHOD);\n-            targets.add(names.PACKAGE);\n-            targets.add(names.PARAMETER);\n-            targets.add(names.TYPE);\n-\n-            defaultTargets = java.util.Collections.unmodifiableSet(targets);\n+            defaultTargets = Set.of(defaultTargetMetaInfo());\n@@ -3699,1 +3688,1 @@\n-    public final Name[] dfltTargetMeta;\n+    private Name[] dfltTargetMeta;\n@@ -3701,0 +3690,18 @@\n+        if (dfltTargetMeta == null) {\n+            ArrayList<Name> defaultTargets = new ArrayList<>();\n+            defaultTargets.add(names.PACKAGE);\n+            defaultTargets.add(names.TYPE);\n+            defaultTargets.add(names.FIELD);\n+            defaultTargets.add(names.METHOD);\n+            defaultTargets.add(names.CONSTRUCTOR);\n+            defaultTargets.add(names.ANNOTATION_TYPE);\n+            defaultTargets.add(names.LOCAL_VARIABLE);\n+            defaultTargets.add(names.PARAMETER);\n+            if (allowRecords) {\n+              defaultTargets.add(names.RECORD_COMPONENT);\n+            }\n+            if (allowModules) {\n+              defaultTargets.add(names.MODULE);\n+            }\n+            dfltTargetMeta = defaultTargets.toArray(new Name[0]);\n+        }\n","filename":"src\/jdk.compiler\/share\/classes\/com\/sun\/tools\/javac\/comp\/Check.java","additions":25,"deletions":18,"binary":false,"changes":43,"status":"modified"}]}