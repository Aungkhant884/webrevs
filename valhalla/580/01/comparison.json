{"files":[{"patch":"@@ -1187,0 +1187,1 @@\n+    MN_FLATTENED             = 0x00400000, \/\/ flattened field\n","filename":"src\/hotspot\/share\/classfile\/javaClasses.hpp","additions":1,"deletions":0,"binary":false,"changes":1,"status":"modified"},{"patch":"@@ -134,1 +134,2 @@\n-  TRUSTED_FINAL        = java_lang_invoke_MemberName::MN_TRUSTED_FINAL,\n+  TRUSTED_FINAL         = java_lang_invoke_MemberName::MN_TRUSTED_FINAL,\n+  FLATTENED             = java_lang_invoke_MemberName::MN_FLATTENED,\n@@ -353,3 +354,0 @@\n-  if (fd.is_inlined()) {\n-    flags |= JVM_ACC_FIELD_INLINED;\n-  }\n@@ -357,0 +355,1 @@\n+  if (fd.is_inlined()) flags |= FLATTENED;;\n@@ -1130,0 +1129,1 @@\n+    template(java_lang_invoke_MemberName,MN_FLATTENED) \\\n","filename":"src\/hotspot\/share\/prims\/methodHandles.cpp","additions":4,"deletions":4,"binary":false,"changes":8,"status":"modified"},{"patch":"@@ -353,0 +353,7 @@\n+UNSAFE_ENTRY(jboolean, Unsafe_IsFlattenedField(JNIEnv *env, jobject unsafe, jobject o)) {\n+  oop f = JNIHandles::resolve_non_null(o);\n+  Klass* k = java_lang_Class::as_Klass(java_lang_reflect_Field::clazz(f));\n+  int slot = java_lang_reflect_Field::slot(f);\n+  return InstanceKlass::cast(k)->field_is_inlined(slot);\n+} UNSAFE_END\n+\n@@ -1042,0 +1049,1 @@\n+    {CC \"isFlattenedField0\", CC \"(\" OBJ \")Z\",                    FN_PTR(Unsafe_IsFlattenedField)},\n","filename":"src\/hotspot\/share\/prims\/unsafe.cpp","additions":8,"deletions":0,"binary":false,"changes":8,"status":"modified"},{"patch":"@@ -881,3 +881,0 @@\n-  if (fd->is_inlined()) {\n-    modifiers |= JVM_ACC_FIELD_INLINED;\n-  }\n","filename":"src\/hotspot\/share\/runtime\/reflection.cpp","additions":0,"deletions":3,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -91,1 +91,0 @@\n-  JVM_ACC_FIELD_INLINED                   = 0x00008000, \/\/ field is inlined\n@@ -97,2 +96,1 @@\n-                                       JVM_ACC_FIELD_HAS_GENERIC_SIGNATURE |\n-                                       JVM_ACC_FIELD_INLINED,\n+                                       JVM_ACC_FIELD_HAS_GENERIC_SIGNATURE,\n","filename":"src\/hotspot\/share\/utilities\/accessFlags.hpp","additions":1,"deletions":3,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -461,1 +461,0 @@\n-    static final int FLATTENED   = 0x00008000;\n@@ -477,1 +476,1 @@\n-    public boolean isFlattened() { return (flags & FLATTENED) == FLATTENED; }\n+    public boolean isFlattened() { return (flags & MN_FLATTENED) == MN_FLATTENED; }\n@@ -490,0 +489,1 @@\n+    \/\/ modifiers exported by the JVM:\n","filename":"src\/java.base\/share\/classes\/java\/lang\/invoke\/MemberName.java","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -121,0 +121,1 @@\n+            MN_FLATTENED             = 0x00400000, \/\/ flattened field\n","filename":"src\/java.base\/share\/classes\/java\/lang\/invoke\/MethodHandleNatives.java","additions":1,"deletions":0,"binary":false,"changes":1,"status":"modified"},{"patch":"@@ -336,1 +336,0 @@\n-    static final int FLATTENED   = 0x00008000;      \/\/ HotSpot-specific bit\n","filename":"src\/java.base\/share\/classes\/java\/lang\/reflect\/Modifier.java","additions":0,"deletions":1,"binary":false,"changes":1,"status":"modified"},{"patch":"@@ -180,1 +180,0 @@\n-    private static final int JVM_ACC_FIELD_INLINED = 0x00008000; \/\/ HotSpot-specific bit\n@@ -186,1 +185,4 @@\n-        return (f.getModifiers() & JVM_ACC_FIELD_INLINED) == JVM_ACC_FIELD_INLINED;\n+        if (f == null) {\n+            throw new NullPointerException();\n+        }\n+        return isFlattenedField0(f);\n@@ -189,0 +191,2 @@\n+    private native boolean isFlattenedField0(Object o);\n+\n","filename":"src\/java.base\/share\/classes\/jdk\/internal\/misc\/Unsafe.java","additions":6,"deletions":2,"binary":false,"changes":8,"status":"modified"}]}