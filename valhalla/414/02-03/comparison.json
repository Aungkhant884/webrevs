{"files":[{"patch":"@@ -114,16 +114,6 @@\n-  if (null_free) {\n-    if (klass->is_loaded()) {\n-      bool is_array_flattened = false;\n-      GUARDED_VM_ENTRY(\n-        EXCEPTION_CONTEXT;\n-        Klass* ak = InlineKlass::cast(klass->get_Klass())->null_free_inline_array_klass(THREAD);\n-        if (HAS_PENDING_EXCEPTION) {\n-          CLEAR_PENDING_EXCEPTION;\n-        } else {\n-          if (ak != NULL && ak->is_flatArray_klass()) {\n-            is_array_flattened = true;\n-          }\n-        }\n-      )\n-      if (is_array_flattened) {\n-        return ciFlatArrayKlass::make(klass);\n+  if (null_free && klass->is_loaded()) {\n+    GUARDED_VM_ENTRY(\n+      EXCEPTION_CONTEXT;\n+      Klass* ak = InlineKlass::cast(klass->get_Klass())->null_free_inline_array_klass(THREAD);\n+      if (HAS_PENDING_EXCEPTION) {\n+        CLEAR_PENDING_EXCEPTION;\n@@ -131,1 +121,3 @@\n-        return ciObjArrayKlass::make(klass, true);\n+        if (ak != NULL && ak->is_flatArray_klass()) {\n+          return ciFlatArrayKlass::make(klass);\n+        }\n@@ -133,3 +125,2 @@\n-    } else {\n-      return ciEnv::unloaded_ciobjarrayklass();\n-    }\n+    )\n+    return ciObjArrayKlass::make(klass, true);\n@@ -137,1 +128,1 @@\n-    return ciObjArrayKlass::make(klass);\n+    return ciObjArrayKlass::make(klass, null_free);\n","filename":"src\/hotspot\/share\/ci\/ciArrayKlass.cpp","additions":12,"deletions":21,"binary":false,"changes":33,"status":"modified"}]}