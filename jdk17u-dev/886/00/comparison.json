{"files":[{"patch":"@@ -27,0 +27,1 @@\n+import java.util.Comparator;\n@@ -53,1 +54,1 @@\n-        boolean foundJitRestart = false;\n+        boolean checkJitRestartCompilation = false;\n@@ -57,2 +58,2 @@\n-                System.out.println(\"JIT restart event found for BlobType \" + btype);\n-                foundJitRestart = true;\n+                System.out.println(\"JIT restart event \/ Compilation event check for BlobType \" + btype + \" was successful\");\n+                checkJitRestartCompilation = true;\n@@ -61,1 +62,1 @@\n-        Asserts.assertTrue(foundJitRestart, \"No JIT restart event found\");\n+        Asserts.assertTrue(checkJitRestartCompilation, \"No JIT restart event found and unexpected compilation seen\");\n@@ -69,0 +70,1 @@\n+        r.enable(EventNames.Compilation);\n@@ -77,0 +79,1 @@\n+        System.out.println(\"---------------------------------------------\");\n@@ -79,0 +82,1 @@\n+        events.sort(Comparator.comparing(RecordedEvent::getStartTime));\n@@ -80,0 +84,1 @@\n+        boolean compilationCanHappen = true;\n@@ -82,0 +87,7 @@\n+            if (evt.getEventType().getName().equals(\"jdk.CodeCacheFull\")) {\n+                System.out.println(\"--> jdk.CodeCacheFull found\");\n+                compilationCanHappen = false;\n+            }\n+            if (evt.getEventType().getName().equals(\"jdk.Compilation\") && !compilationCanHappen) {\n+                return false;\n+            }\n@@ -83,0 +95,1 @@\n+                System.out.println(\"--> jdk.JitRestart found\");\n@@ -85,0 +98,1 @@\n+                System.out.println(\"JIT restart event found for BlobType \" + btype);\n@@ -88,1 +102,5 @@\n-        return false;\n+        System.out.println(\"---------------------------------------------\");\n+\n+        \/\/ in some seldom cases we do not see the JitRestart event; but then\n+        \/\/ do not fail (as long as no compilation happened before)\n+        return true;\n","filename":"test\/jdk\/jdk\/jfr\/event\/compiler\/TestJitRestart.java","additions":23,"deletions":5,"binary":false,"changes":28,"status":"modified"}]}