{"files":[{"patch":"@@ -16773,2 +16773,3 @@\n-       iRegI_R0 result, iRegINoSp tmp1, iRegINoSp tmp2, iRegINoSp tmp3,\n-       iRegINoSp tmp4, iRegINoSp tmp5, iRegINoSp tmp6, rFlagsReg cr)\n+                          iRegI_R0 result, iRegINoSp tmp1, iRegINoSp tmp2,\n+                          iRegINoSp tmp3, iRegINoSp tmp4, iRegINoSp tmp5, iRegINoSp tmp6,\n+                          vRegD_V0 vtmp0, vRegD_V1 vtmp1, rFlagsReg cr)\n@@ -16779,2 +16780,4 @@\n-         TEMP tmp1, TEMP tmp2, TEMP tmp3, TEMP tmp4, TEMP tmp5, TEMP tmp6, KILL cr);\n-  format %{ \"String IndexOf $str1,$cnt1,$str2,$cnt2 -> $result (UU)\" %}\n+         TEMP tmp1, TEMP tmp2, TEMP tmp3, TEMP tmp4, TEMP tmp5, TEMP tmp6,\n+         TEMP vtmp0, TEMP vtmp1, KILL cr);\n+  format %{ \"String IndexOf $str1,$cnt1,$str2,$cnt2 -> $result (UU) \"\n+            \"# KILL $str1 $cnt1 $str2 $cnt2 $tmp1 $tmp2 $tmp3 $tmp4 $tmp5 $tmp6 V0-V1 cr\" %}\n@@ -16794,2 +16797,3 @@\n-       iRegI_R0 result, iRegINoSp tmp1, iRegINoSp tmp2, iRegINoSp tmp3,\n-       iRegINoSp tmp4, iRegINoSp tmp5, iRegINoSp tmp6, rFlagsReg cr)\n+                          iRegI_R0 result, iRegINoSp tmp1, iRegINoSp tmp2, iRegINoSp tmp3,\n+                          iRegINoSp tmp4, iRegINoSp tmp5, iRegINoSp tmp6,\n+                          vRegD_V0 vtmp0, vRegD_V1 vtmp1, rFlagsReg cr)\n@@ -16800,2 +16804,4 @@\n-         TEMP tmp1, TEMP tmp2, TEMP tmp3, TEMP tmp4, TEMP tmp5, TEMP tmp6, KILL cr);\n-  format %{ \"String IndexOf $str1,$cnt1,$str2,$cnt2 -> $result (LL)\" %}\n+         TEMP tmp1, TEMP tmp2, TEMP tmp3, TEMP tmp4, TEMP tmp5, TEMP tmp6,\n+         TEMP vtmp0, TEMP vtmp1, KILL cr);\n+  format %{ \"String IndexOf $str1,$cnt1,$str2,$cnt2 -> $result (LL) \"\n+            \"# KILL $str1 $cnt1 $str2 $cnt2 $tmp1 $tmp2 $tmp3 $tmp4 $tmp5 $tmp6 V0-V1 cr\" %}\n@@ -16815,2 +16821,3 @@\n-       iRegI_R0 result, iRegINoSp tmp1, iRegINoSp tmp2, iRegINoSp tmp3,\n-       iRegINoSp tmp4, iRegINoSp tmp5, iRegINoSp tmp6, rFlagsReg cr)\n+                          iRegI_R0 result, iRegINoSp tmp1, iRegINoSp tmp2,iRegINoSp tmp3,\n+                          iRegINoSp tmp4, iRegINoSp tmp5, iRegINoSp tmp6,\n+                          vRegD_V0 vtmp0, vRegD_V1 vtmp1, rFlagsReg cr)\n@@ -16821,2 +16828,4 @@\n-         TEMP tmp1, TEMP tmp2, TEMP tmp3, TEMP tmp4, TEMP tmp5, TEMP tmp6, KILL cr);\n-  format %{ \"String IndexOf $str1,$cnt1,$str2,$cnt2 -> $result (UL)\" %}\n+         TEMP tmp1, TEMP tmp2, TEMP tmp3, TEMP tmp4, TEMP tmp5,\n+         TEMP tmp6, TEMP vtmp0, TEMP vtmp1, KILL cr);\n+  format %{ \"String IndexOf $str1,$cnt1,$str2,$cnt2 -> $result (UL) \"\n+            \"# KILL $str1 cnt1 $str2 $cnt2 $tmp1 $tmp2 $tmp3 $tmp4 $tmp5 $tmp6 V0-V1 cr\" %}\n@@ -16836,2 +16845,2 @@\n-                 immI_le_4 int_cnt2, iRegI_R0 result, iRegINoSp tmp1, iRegINoSp tmp2,\n-                 iRegINoSp tmp3, iRegINoSp tmp4, rFlagsReg cr)\n+                              immI_le_4 int_cnt2, iRegI_R0 result, iRegINoSp tmp1,\n+                              iRegINoSp tmp2, iRegINoSp tmp3, iRegINoSp tmp4, rFlagsReg cr)\n@@ -16843,1 +16852,2 @@\n-  format %{ \"String IndexOf $str1,$cnt1,$str2,$int_cnt2 -> $result (UU)\" %}\n+  format %{ \"String IndexOf $str1,$cnt1,$str2,$int_cnt2 -> $result (UU) \"\n+            \"# KILL $str1 $cnt1 $str2 $tmp1 $tmp2 $tmp3 $tmp4 cr\" %}\n@@ -16857,2 +16867,2 @@\n-                 immI_le_4 int_cnt2, iRegI_R0 result, iRegINoSp tmp1, iRegINoSp tmp2,\n-                 iRegINoSp tmp3, iRegINoSp tmp4, rFlagsReg cr)\n+                              immI_le_4 int_cnt2, iRegI_R0 result, iRegINoSp tmp1,\n+                              iRegINoSp tmp2, iRegINoSp tmp3, iRegINoSp tmp4, rFlagsReg cr)\n@@ -16864,1 +16874,2 @@\n-  format %{ \"String IndexOf $str1,$cnt1,$str2,$int_cnt2 -> $result (LL)\" %}\n+  format %{ \"String IndexOf $str1,$cnt1,$str2,$int_cnt2 -> $result (LL) \"\n+            \"# KILL $str1 $cnt1 $str2 $tmp1 $tmp2 $tmp3 $tmp4 cr\" %}\n@@ -16878,2 +16889,2 @@\n-                 immI_1 int_cnt2, iRegI_R0 result, iRegINoSp tmp1, iRegINoSp tmp2,\n-                 iRegINoSp tmp3, iRegINoSp tmp4, rFlagsReg cr)\n+                              immI_1 int_cnt2, iRegI_R0 result, iRegINoSp tmp1,\n+                              iRegINoSp tmp2, iRegINoSp tmp3, iRegINoSp tmp4, rFlagsReg cr)\n@@ -16885,1 +16896,2 @@\n-  format %{ \"String IndexOf $str1,$cnt1,$str2,$int_cnt2 -> $result (UL)\" %}\n+  format %{ \"String IndexOf $str1,$cnt1,$str2,$int_cnt2 -> $result (UL) \"\n+            \"# KILL $str1 $cnt1 $str2 $tmp1 $tmp2 $tmp3 $tmp4 cr\" %}\n@@ -16970,0 +16982,2 @@\n+                       vRegD_V0 vtmp0, vRegD_V1 vtmp1, vRegD_V2 vtmp2, vRegD_V3 vtmp3,\n+                       vRegD_V4 vtmp4, vRegD_V5 vtmp5, vRegD_V6 vtmp6, vRegD_V7 vtmp7,\n@@ -16974,1 +16988,3 @@\n-  effect(KILL tmp, USE_KILL ary1, USE_KILL ary2, TEMP tmp1, TEMP tmp2, TEMP tmp3, KILL cr);\n+  effect(KILL tmp, USE_KILL ary1, USE_KILL ary2, TEMP tmp1, TEMP tmp2, TEMP tmp3,\n+         TEMP vtmp0, TEMP vtmp1, TEMP vtmp2, TEMP vtmp3, TEMP vtmp4, TEMP vtmp5,\n+         TEMP vtmp6, TEMP vtmp7, KILL cr);\n@@ -16976,1 +16992,1 @@\n-  format %{ \"Array Equals $ary1,ary2 -> $result    \/\/ KILL $tmp\" %}\n+  format %{ \"Array Equals $ary1,ary2 -> $result # KILL $ary1 $ary2 $tmp $tmp1 $tmp2 $tmp3 V0-V7 cr\" %}\n@@ -16991,0 +17007,2 @@\n+                       vRegD_V0 vtmp0, vRegD_V1 vtmp1, vRegD_V2 vtmp2, vRegD_V3 vtmp3,\n+                       vRegD_V4 vtmp4, vRegD_V5 vtmp5, vRegD_V6 vtmp6, vRegD_V7 vtmp7,\n@@ -16995,1 +17013,3 @@\n-  effect(KILL tmp, USE_KILL ary1, USE_KILL ary2, TEMP tmp1, TEMP tmp2, TEMP tmp3, KILL cr);\n+  effect(KILL tmp, USE_KILL ary1, USE_KILL ary2, TEMP tmp1, TEMP tmp2, TEMP tmp3,\n+         TEMP vtmp0, TEMP vtmp1, TEMP vtmp2, TEMP vtmp3, TEMP vtmp4, TEMP vtmp5,\n+         TEMP vtmp6, TEMP vtmp7, KILL cr);\n@@ -16997,1 +17017,1 @@\n-  format %{ \"Array Equals $ary1,ary2 -> $result    \/\/ KILL $tmp\" %}\n+  format %{ \"Array Equals $ary1,ary2 -> $result # KILL $ary1 $ary2 $tmp $tmp1 $tmp2 $tmp3 V0-V7 cr\" %}\n@@ -17027,2 +17047,2 @@\n-                         vRegD_V0 tmp1, vRegD_V1 tmp2,\n-                         vRegD_V2 tmp3, vRegD_V3 tmp4,\n+                         vRegD_V0 vtmp0, vRegD_V1 vtmp1, vRegD_V2 vtmp2,\n+                         vRegD_V3 vtmp3, vRegD_V4 vtmp4, vRegD_V5 vtmp5,\n@@ -17032,1 +17052,1 @@\n-  effect(TEMP tmp1, TEMP tmp2, TEMP tmp3, TEMP tmp4,\n+  effect(TEMP vtmp0, TEMP vtmp1, TEMP vtmp2, TEMP vtmp3, TEMP vtmp4, TEMP vtmp5,\n@@ -17035,1 +17055,1 @@\n-  format %{ \"String Compress $src,$dst,$len -> $result  \/\/ KILL $src,$dst\" %}\n+  format %{ \"String Compress $src,$dst,$len -> $result # KILL $src $dst V0-V5 cr\" %}\n@@ -17038,3 +17058,3 @@\n-                           $result$$Register,\n-                           $tmp1$$FloatRegister, $tmp2$$FloatRegister,\n-                           $tmp3$$FloatRegister, $tmp4$$FloatRegister);\n+                           $result$$Register, $vtmp0$$FloatRegister, $vtmp1$$FloatRegister,\n+                           $vtmp2$$FloatRegister, $vtmp3$$FloatRegister,\n+                           $vtmp4$$FloatRegister, $vtmp5$$FloatRegister);\n@@ -17046,2 +17066,3 @@\n-instruct string_inflate(Universe dummy, iRegP_R0 src, iRegP_R1 dst, iRegI_R2 len,\n-                        vRegD_V0 tmp1, vRegD_V1 tmp2, vRegD_V2 tmp3, iRegP_R3 tmp4, rFlagsReg cr)\n+instruct string_inflate(Universe dummy, iRegP_R0 src, iRegP_R1 dst, iRegI_R2 len, iRegP_R3 tmp,\n+                        vRegD_V0 vtmp0, vRegD_V1 vtmp1, vRegD_V2 vtmp2, vRegD_V3 vtmp3,\n+                        vRegD_V4 vtmp4, vRegD_V5 vtmp5, vRegD_V6 vtmp6, rFlagsReg cr)\n@@ -17050,1 +17071,3 @@\n-  effect(TEMP tmp1, TEMP tmp2, TEMP tmp3, TEMP tmp4, USE_KILL src, USE_KILL dst, USE_KILL len, KILL cr);\n+  effect(TEMP vtmp0, TEMP vtmp1, TEMP vtmp2, TEMP vtmp3,\n+         TEMP vtmp4, TEMP vtmp5, TEMP vtmp6, TEMP tmp,\n+         USE_KILL src, USE_KILL dst, USE_KILL len, KILL cr);\n@@ -17052,1 +17075,1 @@\n-  format %{ \"String Inflate $src,$dst    \/\/ KILL $tmp1, $tmp2\" %}\n+  format %{ \"String Inflate $src,$dst # KILL $tmp $src $dst $len V0-V6 cr\" %}\n@@ -17055,2 +17078,2 @@\n-                                        $tmp1$$FloatRegister, $tmp2$$FloatRegister,\n-                                        $tmp3$$FloatRegister, $tmp4$$Register);\n+                                        $vtmp0$$FloatRegister, $vtmp1$$FloatRegister,\n+                                        $vtmp2$$FloatRegister, $tmp$$Register);\n@@ -17067,2 +17090,2 @@\n-                          vRegD_V0 vtmp0, vRegD_V1 vtmp1,\n-                          vRegD_V2 vtmp2, vRegD_V3 vtmp3,\n+                          vRegD_V0 vtmp0, vRegD_V1 vtmp1, vRegD_V2 vtmp2,\n+                          vRegD_V3 vtmp3, vRegD_V4 vtmp4, vRegD_V5 vtmp5,\n@@ -17073,2 +17096,2 @@\n-  effect(USE_KILL src, USE_KILL dst, USE len,\n-         KILL vtmp0, KILL vtmp1, KILL vtmp2, KILL vtmp3, KILL cr);\n+  effect(USE_KILL src, USE_KILL dst, USE len, KILL vtmp0, KILL vtmp1,\n+         KILL vtmp2, KILL vtmp3, KILL vtmp4, KILL vtmp5, KILL cr);\n@@ -17076,1 +17099,1 @@\n-  format %{ \"Encode ISO array $src,$dst,$len -> $result\" %}\n+  format %{ \"Encode ISO array $src,$dst,$len -> $result # KILL $src $dst V0-V5 cr\" %}\n@@ -17081,1 +17104,2 @@\n-                        $vtmp2$$FloatRegister, $vtmp3$$FloatRegister);\n+                        $vtmp2$$FloatRegister, $vtmp3$$FloatRegister,\n+                        $vtmp4$$FloatRegister, $vtmp5$$FloatRegister);\n@@ -17087,2 +17111,2 @@\n-                            vRegD_V0 vtmp0, vRegD_V1 vtmp1,\n-                            vRegD_V2 vtmp2, vRegD_V3 vtmp3,\n+                            vRegD_V0 vtmp0, vRegD_V1 vtmp1, vRegD_V2 vtmp2,\n+                            vRegD_V3 vtmp3, vRegD_V4 vtmp4, vRegD_V5 vtmp5,\n@@ -17093,2 +17117,2 @@\n-  effect(USE_KILL src, USE_KILL dst, USE len,\n-         KILL vtmp0, KILL vtmp1, KILL vtmp2, KILL vtmp3, KILL cr);\n+  effect(USE_KILL src, USE_KILL dst, USE len, KILL vtmp0, KILL vtmp1,\n+         KILL vtmp2, KILL vtmp3, KILL vtmp4, KILL vtmp5, KILL cr);\n@@ -17096,1 +17120,1 @@\n-  format %{ \"Encode ASCII array $src,$dst,$len -> $result\" %}\n+  format %{ \"Encode ASCII array $src,$dst,$len -> $result # KILL $src $dst V0-V5 cr\" %}\n@@ -17101,1 +17125,2 @@\n-                        $vtmp2$$FloatRegister, $vtmp3$$FloatRegister);\n+                        $vtmp2$$FloatRegister, $vtmp3$$FloatRegister,\n+                        $vtmp4$$FloatRegister, $vtmp5$$FloatRegister);\n","filename":"src\/hotspot\/cpu\/aarch64\/aarch64.ad","additions":75,"deletions":50,"binary":false,"changes":125,"status":"modified"},{"patch":"@@ -46,0 +46,1 @@\n+\/\/ Clobbers: rscratch1, rscratch2, rflags. May also clobber v0-v1, when icnt1==-1.\n","filename":"src\/hotspot\/cpu\/aarch64\/c2_MacroAssembler_aarch64.cpp","additions":1,"deletions":0,"binary":false,"changes":1,"status":"modified"},{"patch":"@@ -4517,0 +4517,2 @@\n+\/\/ Clobbers: rscratch1, rscratch2, rflags\n+\/\/ May also clobber v0-v7 when (!UseSimpleArrayEquals && UseSIMDForArrayEquals)\n@@ -5052,0 +5054,1 @@\n+\/\/ Clobbers: src, dst, res, rscratch1, rscratch2, rflags\n@@ -5055,1 +5058,2 @@\n-                                      FloatRegister vtmp2, FloatRegister vtmp3)\n+                                      FloatRegister vtmp2, FloatRegister vtmp3,\n+                                      FloatRegister vtmp4, FloatRegister vtmp5)\n@@ -5074,2 +5078,2 @@\n-    FloatRegister vlo0 = v4;\n-    FloatRegister vlo1 = v5;\n+    FloatRegister vlo0 = vtmp4;\n+    FloatRegister vlo1 = vtmp5;\n@@ -5148,0 +5152,1 @@\n+\/\/ Clobbers: src, dst, len, rflags, rscratch1, v0-v6\n@@ -5256,2 +5261,3 @@\n-                                         FloatRegister tmp2, FloatRegister tmp3) {\n-  encode_iso_array(src, dst, len, res, false, tmp0, tmp1, tmp2, tmp3);\n+                                         FloatRegister tmp2, FloatRegister tmp3,\n+                                         FloatRegister tmp4, FloatRegister tmp5) {\n+  encode_iso_array(src, dst, len, res, false, tmp0, tmp1, tmp2, tmp3, tmp4, tmp5);\n","filename":"src\/hotspot\/cpu\/aarch64\/macroAssembler_aarch64.cpp","additions":11,"deletions":5,"binary":false,"changes":16,"status":"modified"},{"patch":"@@ -1278,1 +1278,2 @@\n-                           FloatRegister vtmp2, FloatRegister vtmp3);\n+                           FloatRegister vtmp2, FloatRegister vtmp3,\n+                           FloatRegister vtmp4, FloatRegister vtmp5);\n@@ -1283,1 +1284,2 @@\n-                        FloatRegister vtmp2, FloatRegister vtmp3);\n+                        FloatRegister vtmp2, FloatRegister vtmp3,\n+                        FloatRegister vtmp4, FloatRegister vtmp5);\n","filename":"src\/hotspot\/cpu\/aarch64\/macroAssembler_aarch64.hpp","additions":4,"deletions":2,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -4985,0 +4985,1 @@\n+  \/\/ Clobbers: v0-v7 when UseSIMDForArrayEquals, rscratch1, rscratch2\n@@ -5431,0 +5432,2 @@\n+  \/\/ Clobbers: rscratch1, rscratch2, v0, v1, rflags\n+  \/\/\n@@ -5745,0 +5748,1 @@\n+  \/\/ Clobbers: r0, r1, r3, rscratch1, rflags, v0-v6\n","filename":"src\/hotspot\/cpu\/aarch64\/stubGenerator_aarch64.cpp","additions":4,"deletions":0,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -0,0 +1,296 @@\n+\/*\n+ * Copyright (c) 2023, Arm Limited. All rights reserved.\n+ * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+ *\n+ * This code is free software; you can redistribute it and\/or modify it\n+ * under the terms of the GNU General Public License version 2 only, as\n+ * published by the Free Software Foundation.\n+ *\n+ * This code is distributed in the hope that it will be useful, but WITHOUT\n+ * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+ * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+ * version 2 for more details (a copy is included in the LICENSE file that\n+ * accompanied this code).\n+ *\n+ * You should have received a copy of the GNU General Public License version\n+ * 2 along with this work; if not, write to the Free Software Foundation,\n+ * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n+ *\n+ * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n+ * or visit www.oracle.com if you need additional information or have any\n+ * questions.\n+ *\/\n+\n+\/*\n+ * @test\n+ * @bug 8307572\n+ * @summary Verify vector register clobbering in some aarch64 intrinsics\n+ * @library \/compiler\/patches \/test\/lib\n+ * @build java.base\/java.lang.Helper\n+ * @run main\/othervm -Xbatch -XX:CompileThreshold=100 -XX:-TieredCompilation compiler.c2.aarch64.TestIntrinsicsRegStress\n+ *\/\n+\n+package compiler.c2.aarch64;\n+\n+import java.util.Arrays;\n+\n+public class TestIntrinsicsRegStress {\n+\n+    final int LENGTH = 1024;\n+    final int ITER = 10000;\n+    final int NUM = 32;\n+\n+    byte[] ba;\n+    char[] ca;\n+    char[] cb;\n+    float[] fv;\n+\n+    String str;\n+    String[] strings;\n+    String needle = \"01234567890123456789\";\n+\n+    public void init() {\n+        ca = new char[LENGTH];\n+        fv = new float[NUM];\n+        strings = new String[NUM];\n+        for (int i = 0; i < LENGTH; i++) {\n+            ca[i] = (char) ('a' + i % NUM);\n+        }\n+        cb = ca.clone();\n+        str = new String(ca);\n+        for (int i = 0; i < NUM; i++) {\n+            fv[i] = 1;\n+        }\n+        for (int i = 0; i < NUM; i++) {\n+            strings[i] = str.substring(i) + needle;\n+        }\n+    }\n+\n+    public void checkIndexOf(int iter) {\n+        float t0 = 0;\n+        float t1 = fv[1] * fv[0];\n+        float t2 = fv[2] * fv[0];\n+        float t3 = fv[3] * fv[0];\n+        float t4 = fv[4] * fv[0];\n+        float t5 = fv[5] * fv[0];\n+        float t6 = fv[6] * fv[0];\n+        float t7 = fv[7] * fv[0];\n+        float t8 = fv[8] * fv[0];\n+        float t9 = fv[9] * fv[0];\n+        float t10 = fv[10] * fv[0];\n+        float t11 = fv[11] * fv[0];\n+        float t12 = fv[12] * fv[0];\n+        float t13 = fv[13] * fv[0];\n+        float t14 = fv[14] * fv[0];\n+        float t15 = fv[15] * fv[0];\n+        float t16 = fv[16] * fv[0];\n+        float t17 = fv[17] * fv[0];\n+        float t18 = fv[18] * fv[0];\n+        float t19 = fv[19] * fv[0];\n+        float t20 = fv[20] * fv[0];\n+        float t21 = fv[21] * fv[0];\n+        float t22 = fv[22] * fv[0];\n+        float t23 = fv[23] * fv[0];\n+        float t24 = fv[24] * fv[0];\n+        float t25 = fv[25] * fv[0];\n+        float t26 = fv[26] * fv[0];\n+        float t27 = fv[27] * fv[0];\n+        float t28 = fv[28] * fv[0];\n+        float t29 = fv[29] * fv[0];\n+        float t30 = fv[30] * fv[0];\n+\n+        int result = strings[iter % NUM].indexOf(needle);\n+\n+        if (result > LENGTH - NUM \/ 2) {\n+            \/\/ Use fp registers as many as possible and try to make them\n+            \/\/ live across above intrinsic function.\n+            t0 += t1 - t2 + t3 - t4 + t5 - t6 + t7 - t8 + t9 - t10 + t11 - t12 + t13 - t14 + t15\n+                    - t16 + t17 - t18 + t19 - t20 + t21 - t22 + t23 - t24 + t25 - t26 + t27 - t28\n+                    + t29 - t30; \/\/ 0\n+        }\n+        fv[31] += t0 + t2 - t11 + t16 - t29;\n+    }\n+\n+    public void testIndexOf() {\n+        for (int i = 0; i < ITER; i++) {\n+            checkIndexOf(i);\n+        }\n+    }\n+\n+    public void checkArraysEquals() {\n+        float t0 = 0;\n+        float t1 = fv[1] * fv[0];\n+        float t2 = fv[2] * fv[0];\n+        float t3 = fv[3] * fv[0];\n+        float t4 = fv[4] * fv[0];\n+        float t5 = fv[5] * fv[0];\n+        float t6 = fv[6] * fv[0];\n+        float t7 = fv[7] * fv[0];\n+        float t8 = fv[8] * fv[0];\n+        float t9 = fv[9] * fv[0];\n+        float t10 = fv[10] * fv[0];\n+        float t11 = fv[11] * fv[0];\n+        float t12 = fv[12] * fv[0];\n+        float t13 = fv[13] * fv[0];\n+        float t14 = fv[14] * fv[0];\n+        float t15 = fv[15] * fv[0];\n+        float t16 = fv[16] * fv[0];\n+        float t17 = fv[17] * fv[0];\n+        float t18 = fv[18] * fv[0];\n+        float t19 = fv[19] * fv[0];\n+        float t20 = fv[20] * fv[0];\n+        float t21 = fv[21] * fv[0];\n+        float t22 = fv[22] * fv[0];\n+        float t23 = fv[23] * fv[0];\n+        float t24 = fv[24] * fv[0];\n+        float t25 = fv[25] * fv[0];\n+        float t26 = fv[26] * fv[0];\n+        float t27 = fv[27] * fv[0];\n+        float t28 = fv[28] * fv[0];\n+        float t29 = fv[29] * fv[0];\n+        float t30 = fv[30] * fv[0];\n+\n+        if (Arrays.equals(ca, cb)) {\n+            \/\/ Use fp registers as many as possible and try to make them\n+            \/\/ live across above intrinsic function.\n+            t0 += t1 - t2 + t3 - t4 + t5 - t6 + t7 - t8 + t9 - t10 + t11 - t12 + t13 - t14 + t15\n+                    - t16 + t17 - t18 + t19 - t20 + t21 - t22 + t23 - t24 + t25 - t26 + t27 - t28\n+                    + t29 - t30; \/\/ 0\n+        }\n+        fv[31] += t0 + t2 - t11 + t16 - t29;\n+    }\n+\n+    public void testArraysEquals() {\n+        for (int i = 0; i < ITER; i++) {\n+            checkArraysEquals();\n+        }\n+    }\n+\n+    public void checkCompress(int iter) {\n+        float t0 = 0;\n+        float t1 = fv[1] * fv[0];\n+        float t2 = fv[2] * fv[0];\n+        float t3 = fv[3] * fv[0];\n+        float t4 = fv[4] * fv[0];\n+        float t5 = fv[5] * fv[0];\n+        float t6 = fv[6] * fv[0];\n+        float t7 = fv[7] * fv[0];\n+        float t8 = fv[8] * fv[0];\n+        float t9 = fv[9] * fv[0];\n+        float t10 = fv[10] * fv[0];\n+        float t11 = fv[11] * fv[0];\n+        float t12 = fv[12] * fv[0];\n+        float t13 = fv[13] * fv[0];\n+        float t14 = fv[14] * fv[0];\n+        float t15 = fv[15] * fv[0];\n+        float t16 = fv[16] * fv[0];\n+        float t17 = fv[17] * fv[0];\n+        float t18 = fv[18] * fv[0];\n+        float t19 = fv[19] * fv[0];\n+        float t20 = fv[20] * fv[0];\n+        float t21 = fv[21] * fv[0];\n+        float t22 = fv[22] * fv[0];\n+        float t23 = fv[23] * fv[0];\n+        float t24 = fv[24] * fv[0];\n+        float t25 = fv[25] * fv[0];\n+        float t26 = fv[26] * fv[0];\n+        float t27 = fv[27] * fv[0];\n+        float t28 = fv[28] * fv[0];\n+        float t29 = fv[29] * fv[0];\n+        float t30 = fv[30] * fv[0];\n+\n+        ba = Helper.compressChar(ca, 0, LENGTH, 0, LENGTH);\n+\n+        if (ba[iter % LENGTH] > (byte) ('a' + 5)) {\n+            \/\/ Use fp registers as many as possible and try to make them\n+            \/\/ live across above intrinsic function.\n+            t0 += t1 - t2 + t3 - t4 + t5 - t6 + t7 - t8 + t9 - t10 + t11 - t12 + t13 - t14 + t15\n+                    - t16 + t17 - t18 + t19 - t20 + t21 - t22 + t23 - t24 + t25 - t26 + t27 - t28\n+                    + t29 - t30; \/\/ 0\n+        }\n+        fv[31] += t0 + t2 - t11 + t16 - t29;\n+    }\n+\n+    public void testCompress() {\n+        for (int i = 0; i < ITER; i++) {\n+            checkCompress(i);\n+        }\n+    }\n+\n+    public void checkInflate(int iter) {\n+        float t0 = 0;\n+        float t1 = fv[1] * fv[0];\n+        float t2 = fv[2] * fv[0];\n+        float t3 = fv[3] * fv[0];\n+        float t4 = fv[4] * fv[0];\n+        float t5 = fv[5] * fv[0];\n+        float t6 = fv[6] * fv[0];\n+        float t7 = fv[7] * fv[0];\n+        float t8 = fv[8] * fv[0];\n+        float t9 = fv[9] * fv[0];\n+        float t10 = fv[10] * fv[0];\n+        float t11 = fv[11] * fv[0];\n+        float t12 = fv[12] * fv[0];\n+        float t13 = fv[13] * fv[0];\n+        float t14 = fv[14] * fv[0];\n+        float t15 = fv[15] * fv[0];\n+        float t16 = fv[16] * fv[0];\n+        float t17 = fv[17] * fv[0];\n+        float t18 = fv[18] * fv[0];\n+        float t19 = fv[19] * fv[0];\n+        float t20 = fv[20] * fv[0];\n+        float t21 = fv[21] * fv[0];\n+        float t22 = fv[22] * fv[0];\n+        float t23 = fv[23] * fv[0];\n+        float t24 = fv[24] * fv[0];\n+        float t25 = fv[25] * fv[0];\n+        float t26 = fv[26] * fv[0];\n+        float t27 = fv[27] * fv[0];\n+        float t28 = fv[28] * fv[0];\n+        float t29 = fv[29] * fv[0];\n+        float t30 = fv[30] * fv[0];\n+\n+        str.getChars(0, LENGTH, ca, 0);\n+\n+        if (ca[iter % LENGTH] > (byte) ('a' + NUM \/ 2)) {\n+            \/\/ Use fp registers as many as possible and try to make them\n+            \/\/ live across above intrinsic function.\n+            t0 += t1 - t2 + t3 - t4 + t5 - t6 + t7 - t8 + t9 - t10 + t11 - t12 + t13 - t14 + t15\n+                    - t16 + t17 - t18 + t19 - t20 + t21 - t22 + t23 - t24 + t25 - t26 + t27 - t28\n+                    + t29 - t30; \/\/ 0\n+        }\n+        fv[31] += t0 + t2 - t11 + t16 - t29;\n+    }\n+\n+    public void testInflate() {\n+        for (int i = 0; i < ITER; i++) {\n+            checkInflate(i);\n+        }\n+    }\n+\n+    public void verifyAndReset() {\n+        if (fv[31] != 1.0) {\n+            throw new RuntimeException(\"Failed with \" + Float.toString(fv[31]));\n+        } else {\n+            System.out.println(\"Success!\");\n+        }\n+        fv[31] = 1.0f;\n+    }\n+\n+    public static void main(String[] args) {\n+        TestIntrinsicsRegStress t = new TestIntrinsicsRegStress();\n+        t.init();\n+\n+        t.testIndexOf();\n+        t.verifyAndReset();\n+\n+        t.testArraysEquals();\n+        t.verifyAndReset();\n+\n+        t.testCompress();\n+        t.verifyAndReset();\n+\n+        t.testInflate();\n+        t.verifyAndReset();\n+    }\n+}\n","filename":"test\/hotspot\/jtreg\/compiler\/c2\/aarch64\/TestIntrinsicsRegStress.java","additions":296,"deletions":0,"binary":false,"changes":296,"status":"added"}]}