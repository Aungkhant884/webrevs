{"files":[{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2001, 2020, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2001, 2021, Oracle and\/or its affiliates. All rights reserved.\n@@ -323,0 +323,2 @@\n+            final String testThreadName = \"thread2\";\n+\n@@ -345,1 +347,1 @@\n-            getEventSet();\n+            getEventSetForThreadStartDeath(testThreadName);\n@@ -360,1 +362,1 @@\n-            getEventSet();\n+            getEventSetForThreadStartDeath(testThreadName);\n","filename":"test\/hotspot\/jtreg\/vmTestbase\/nsk\/jdi\/EventIterator\/nextEvent\/nextevent001.java","additions":5,"deletions":3,"binary":false,"changes":8,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2001, 2020, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2001, 2021, Oracle and\/or its affiliates. All rights reserved.\n@@ -269,1 +269,1 @@\n-            breakpointForCommunication();\n+            breakpointForCommunication(debuggeeName);\n","filename":"test\/hotspot\/jtreg\/vmTestbase\/nsk\/jdi\/EventRequestManager\/methodEntryRequests\/methentreq002.java","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -200,0 +200,21 @@\n+    \/\/ Similar to breakpointForCommunication, but skips Locatable events from unexpected locations.\n+    \/\/ It's useful for cases when enabled event requests can cause notifications from system threads\n+    \/\/ (like MethodEntryRequest, MethodExitRequest).\n+    protected void breakpointForCommunication(String debuggeeName) throws JDITestRuntimeException {\n+        log2(\"breakpointForCommunication\");\n+        while (true) {\n+            getEventSet();\n+\n+            Event event = eventIterator.nextEvent();\n+            if (event instanceof BreakpointEvent) {\n+                return;\n+            }\n+            if (EventFilters.filtered(event, debuggeeName)) {\n+                log2(\"  got unexpected event: \" + event + \", skipping\");\n+                eventSet.resume();\n+            } else {\n+                throw new JDITestRuntimeException(\"** event '\" + event + \"' IS NOT a breakpoint **\");\n+            }\n+        }\n+    }\n+\n","filename":"test\/hotspot\/jtreg\/vmTestbase\/nsk\/share\/jdi\/JDIBase.java","additions":21,"deletions":0,"binary":false,"changes":21,"status":"modified"}]}