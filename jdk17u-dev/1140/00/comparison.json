{"files":[{"patch":"@@ -36,0 +36,1 @@\n+import java.util.TimeZone;\n@@ -42,1 +43,4 @@\n-    private static String CUSTOM_TZ = \"MEZ-1MESZ,M3.5.0,M10.5.0\";\n+    \/\/ Northern Hemisphere\n+    private static String CUSTOM_TZ = \"MEZ-1MESZ,M3.5.0,M10.5.0\/3\";\n+    \/\/ Simulate Southern Hemisphere\n+    private static String CUSTOM_TZ2 = \"MEZ-1MESZ,M10.5.0,M3.5.0\/3\";\n@@ -49,0 +53,3 @@\n+            pb.environment().put(\"TZ\", CUSTOM_TZ2);\n+            output = ProcessTools.executeProcess(pb);\n+            output.shouldHaveExitValue(0);\n@@ -54,1 +61,1 @@\n-    \/* TZ code will always be set to \"MEZ-1MESZ,M3.5.0,M10.5.0\".\n+    \/* TZ is set to \"MEZ-1MESZ,M3.5.0,M10.5.0\/3\", it will be the northern hemisphere.\n@@ -60,2 +67,11 @@\n-        if (new SimpleTimeZone(3600000, \"MEZ-1MESZ\", Calendar.MARCH, -1, Calendar.SUNDAY, 0,\n-                Calendar.OCTOBER, -1, Calendar.SUNDAY, 0).inDaylightTime(time)) {\n+        String tzStr = System.getenv(\"TZ\");\n+        if (tzStr == null)\n+            throw new RuntimeException(\"Got unexpected timezone information: TZ is null\");\n+        boolean nor = CUSTOM_TZ.equals(tzStr);\n+        TimeZone tz = new SimpleTimeZone(3600000, tzStr,\n+            nor ? Calendar.MARCH : Calendar.OCTOBER, -1,\n+            Calendar.SUNDAY, 3600000, SimpleTimeZone.UTC_TIME,\n+            nor ? Calendar.OCTOBER : Calendar.MARCH, -1,\n+            Calendar.SUNDAY, 3600000, SimpleTimeZone.UTC_TIME,\n+            3600000);\n+        if (tz.inDaylightTime(time)) {\n@@ -71,1 +87,1 @@\n-        throw new RuntimeException(\"Got unexpected timezone information: \" + time);\n+        throw new RuntimeException(\"Got unexpected timezone information: \" + tzStr + \" \" + time);\n","filename":"test\/jdk\/java\/util\/TimeZone\/CustomTzIDCheckDST.java","additions":21,"deletions":5,"binary":false,"changes":26,"status":"modified"}]}