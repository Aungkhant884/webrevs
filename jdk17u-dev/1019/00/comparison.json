{"files":[{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2018, 2020, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2018, 2022, Oracle and\/or its affiliates. All rights reserved.\n@@ -87,1 +87,1 @@\n- * @build Http2TestServer LineBodyHandlerTest HttpServerAdapters\n+ * @build Http2TestServer LineBodyHandlerTest HttpServerAdapters ReferenceTracker\n@@ -104,0 +104,4 @@\n+    final ReferenceTracker TRACKER = ReferenceTracker.INSTANCE;\n+    final AtomicInteger clientCount = new AtomicInteger();\n+    HttpClient sharedClient;\n+\n@@ -192,1 +196,5 @@\n-        return HttpClient.newBuilder()\n+        if (sharedClient != null) {\n+            return sharedClient;\n+        }\n+        clientCount.incrementAndGet();\n+        return sharedClient = TRACKER.track(HttpClient.newBuilder()\n@@ -195,1 +203,1 @@\n-                .build();\n+                .build());\n@@ -698,0 +706,10 @@\n+        sharedClient = null;\n+        try {\n+            System.gc();\n+            Thread.sleep(200);\n+        } catch (InterruptedException io) {\n+            \/\/ don't care;\n+        }\n+        AssertionError fail = TRACKER.check(500);\n+        System.out.printf(\"Tear down: %s client created.%n\", clientCount.get());\n+        System.err.printf(\"Tear down: %s client created.%n\", clientCount.get());\n@@ -702,0 +720,1 @@\n+        if (fail != null) throw fail;\n","filename":"test\/jdk\/java\/net\/httpclient\/LineBodyHandlerTest.java","additions":23,"deletions":4,"binary":false,"changes":27,"status":"modified"}]}