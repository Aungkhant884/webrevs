{"files":[{"patch":"@@ -48,0 +48,2 @@\n+        int timeout = 2000;\n+        int n = 10;\n@@ -49,7 +51,7 @@\n-            try {\n-                \/\/ Send SIGPIPE to the thread every second\n-                for (int i = 0; i < 10; i++) {\n-                    if (NativeThread.signal(osThreadId, NativeThread.SIGPIPE) != 0) {\n-                        System.out.println(\"Failed to send signal\");\n-                        System.exit(1);\n-                    }\n+            \/\/ Send SIGPIPE to the thread every second\n+            for (int i = 0; i < n; i++) {\n+                if (NativeThread.signal(osThreadId, NativeThread.SIGPIPE) != 0) {\n+                    System.out.println(\"Test FAILED: failed to send signal\");\n+                    System.exit(1);\n+                }\n+                try {\n@@ -57,0 +59,3 @@\n+                } catch (InterruptedException e) {\n+                    System.out.println(\"Test FAILED: unexpected interrupt\");\n+                    System.exit(1);\n@@ -58,5 +63,0 @@\n-            } catch (Exception e) {\n-                e.printStackTrace();\n-            } finally {\n-                System.out.println(\"Test FAILED\");\n-                System.exit(1);\n@@ -64,0 +64,3 @@\n+            System.out.println(\"Test FAILED: Socket.connect blocked \" + n + \" seconds, \" +\n+                    \"expected around \" + timeout \/ 1000 + \" seconds\");\n+            System.exit(1);\n@@ -68,0 +71,2 @@\n+        long startMillis = System.currentTimeMillis();\n+\n@@ -71,1 +76,1 @@\n-            socket.connect(new InetSocketAddress(\"192.168.255.255\", 8080), 2000);\n+            socket.connect(new InetSocketAddress(\"192.168.255.255\", 8080), timeout);\n@@ -73,1 +78,7 @@\n-            System.out.println(\"Test passed\");\n+            long duration = System.currentTimeMillis() - startMillis;\n+            if (duration >= timeout) {\n+                System.out.println(\"Test passed\");\n+            } else {\n+                System.out.println(\"Test FAILED: duration \" + duration + \" ms, expected >= \" + timeout + \" ms\");\n+                System.exit(1);\n+            }\n","filename":"test\/jdk\/java\/net\/Socket\/B8312065.java","additions":25,"deletions":14,"binary":false,"changes":39,"status":"modified"}]}