{"files":[{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2007, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2007, 2021, Oracle and\/or its affiliates. All rights reserved.\n@@ -24,1 +24,1 @@\n-\/**\n+\/*\n@@ -28,1 +28,1 @@\n- * @run main\/manual=yesno LCDTextAndGraphicsState\n+ * @run main\/manual LCDTextAndGraphicsState\n@@ -30,2 +30,20 @@\n-import java.awt.*;\n-import java.awt.geom.*;\n+\n+import java.awt.AlphaComposite;\n+import java.awt.BorderLayout;\n+import java.awt.Button;\n+import java.awt.Color;\n+import java.awt.Component;\n+import java.awt.Dimension;\n+import java.awt.Frame;\n+import java.awt.GradientPaint;\n+import java.awt.Graphics;\n+import java.awt.Graphics2D;\n+import java.awt.GridLayout;\n+import java.awt.Panel;\n+import java.awt.RenderingHints;\n+import java.awt.Shape;\n+import java.awt.TextArea;\n+import java.awt.event.ActionEvent;\n+import java.awt.geom.RoundRectangle2D;\n+import java.util.concurrent.CountDownLatch;\n+import java.util.concurrent.TimeUnit;\n@@ -35,1 +53,4 @@\n-    String text = \"This test passes only if this text appears SIX TIMES\";\n+    private static final Frame testFrame = new Frame(\"Composite and Text Test\");\n+    private static final String text = \"This test passes only if this text appears SIX TIMES else fail\";\n+    private static volatile boolean testResult;\n+    private static volatile CountDownLatch countDownLatch;\n@@ -38,1 +59,0 @@\n-\n@@ -42,4 +62,3 @@\n-\n-        test1(g.create(0,   0, 500, 200));\n-        test2(g.create(0, 200, 500, 200));\n-        test3(g.create(0, 400, 500, 200));\n+        test1(g.create(0, 0, 500, 100));\n+        test2(g.create(0, 100, 500, 100));\n+        test3(g.create(0, 200, 500, 100));\n@@ -53,1 +72,1 @@\n-        g2d.drawString(text, 10, 50);\n+        g2d.drawString(text, 10, 20);\n@@ -56,1 +75,1 @@\n-        g2d.drawString(text, 10, 80);\n+        g2d.drawString(text, 10, 50);\n@@ -64,1 +83,1 @@\n-        g2d.drawString(text, 10, 50);\n+        g2d.drawString(text, 10, 20);\n@@ -67,1 +86,1 @@\n-        g2d.drawString(text, 10, 80);\n+        g2d.drawString(text, 10, 50);\n@@ -75,2 +94,2 @@\n-        g2d.drawString(text, 10, 50);\n-        Shape s = new RoundRectangle2D.Double(0, 60, 400, 50, 5, 5);\n+        g2d.drawString(text, 10, 20);\n+        Shape s = new RoundRectangle2D.Double(0, 30, 400, 50, 5, 5);\n@@ -78,1 +97,1 @@\n-        g2d.drawString(text, 10, 80);\n+        g2d.drawString(text, 10, 50);\n@@ -82,1 +101,6 @@\n-        return new Dimension(500,600);\n+        return new Dimension(500,300);\n+    }\n+\n+    public static void disposeUI() {\n+        countDownLatch.countDown();\n+        testFrame.dispose();\n@@ -85,1 +109,34 @@\n-    public static void main(String[] args) throws Exception {\n+    public static void createTestUI() {\n+        testFrame.add(new LCDTextAndGraphicsState(), BorderLayout.NORTH);\n+        Panel resultButtonPanel = new Panel(new GridLayout(1, 2));\n+        Button passButton = new Button(\"Pass\");\n+        passButton.addActionListener((ActionEvent e) -> {\n+            testResult = true;\n+            disposeUI();\n+        });\n+        Button failButton = new Button(\"Fail\");\n+        failButton.addActionListener(e -> {\n+            testResult = false;\n+            disposeUI();\n+        });\n+        resultButtonPanel.add(passButton);\n+        resultButtonPanel.add(failButton);\n+\n+        Panel controlUI = new Panel(new BorderLayout());\n+        TextArea instructions = new TextArea(\n+                \"Instructions:\\n\" +\n+                \"If you see the text six times above, press Pass.\\n\" +\n+                \"If not, press Fail.\",\n+                3,\n+                50,\n+                TextArea.SCROLLBARS_NONE\n+        );\n+        instructions.setEditable(false);\n+        controlUI.add(instructions, BorderLayout.CENTER);\n+        controlUI.add(resultButtonPanel, BorderLayout.SOUTH);\n+\n+        testFrame.add(controlUI, BorderLayout.SOUTH);\n+        testFrame.pack();\n+        testFrame.setLocationRelativeTo(null);\n+        testFrame.setVisible(true);\n+    }\n@@ -87,4 +144,9 @@\n-        Frame f = new Frame(\"Composite and Text Test\");\n-        f.add(new LCDTextAndGraphicsState(), BorderLayout.CENTER);\n-        f.pack();\n-        f.setVisible(true);\n+    public static void main(String[] args) throws InterruptedException {\n+        countDownLatch = new CountDownLatch(1);\n+        createTestUI();\n+        if (!countDownLatch.await(10, TimeUnit.MINUTES)) {\n+            throw new RuntimeException(\"Timeout : No action was performed on the test UI.\");\n+        }\n+        if (!testResult) {\n+            throw new RuntimeException(\"Test failed!\");\n+        }\n","filename":"test\/jdk\/java\/awt\/Graphics\/LCDTextAndGraphicsState.java","additions":86,"deletions":24,"binary":false,"changes":110,"status":"modified"}]}