{"files":[{"patch":"@@ -325,0 +325,2 @@\n+            int maxUnexpected = 10; \/\/ if we get there too often we may\n+                                    \/\/ want to reassess the diagnosis\n@@ -326,0 +328,1 @@\n+                boolean accepted = false;\n@@ -336,1 +339,3 @@\n-                    assert query != null;\n+                    if (query == null) {\n+                        throw new IOException(\"expected query not found in: \" + uriPath);\n+                    }\n@@ -342,1 +347,1 @@\n-                        len = Integer.parseInt(query.split(\"=\")[1]);\n+                        len = Integer.parseInt(qv);\n@@ -345,0 +350,4 @@\n+                    \/\/ if we get an exception past this point\n+                    \/\/ we will rethrow it\n+                    accepted = true;\n+\n@@ -347,1 +356,1 @@\n-                    out.println(name  + \": headers written, writing \" + len  + \" body bytes\");\n+                    out.println(name + \": headers written, writing \" + len + \" body bytes\");\n@@ -349,1 +358,1 @@\n-                    for (int i = 0; i< len; i++) {\n+                    for (int i = 0; i < len; i++) {\n@@ -353,3 +362,10 @@\n-                } catch (IOException e) {\n-                    if (!closed)\n-                        throw new UncheckedIOException(\"Unexpected\", e);\n+                } catch (IOException | RuntimeException e) {\n+                    if (!closed) {\n+                        if (--maxUnexpected <= 0 || accepted) {\n+                            if (e instanceof IOException io)\n+                                throw new UncheckedIOException(io);\n+                            else throw (RuntimeException) e;\n+                        }\n+                        out.println(\"ignoring unexpected exception: \" + e);\n+                        continue;\n+                    }\n","filename":"test\/jdk\/java\/net\/httpclient\/ResponseBodyBeforeError.java","additions":23,"deletions":7,"binary":false,"changes":30,"status":"modified"}]}