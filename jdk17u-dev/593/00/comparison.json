{"files":[{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2020, 2021, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2020, 2022, Oracle and\/or its affiliates. All rights reserved.\n@@ -28,0 +28,1 @@\n+#include <stdlib.h>\n@@ -183,5 +184,1 @@\n-        if (exitCode != 0) {\n-            JP_THROW(tstrings::any() << \"Child process exited with code \"\n-                                                                << exitCode);\n-        }\n-\n+        exit(exitCode);\n","filename":"src\/jdk.jpackage\/windows\/native\/applauncher\/WinLauncher.cpp","additions":3,"deletions":6,"binary":false,"changes":9,"status":"modified"},{"patch":"@@ -73,0 +73,2 @@\n+\n+        System.exit(Integer.getInteger(\"jpackage.test.exitCode\", 0));\n","filename":"test\/jdk\/tools\/jpackage\/apps\/Hello.java","additions":2,"deletions":0,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -373,0 +373,2 @@\n+            } else if (\"jpackage.test.exitCode\".equals(name)) {\n+                expectedExitCode = Integer.parseInt(value);\n@@ -424,2 +426,2 @@\n-                    removePath).executeAndRepeatUntilExitCode(0, attempts,\n-                            waitBetweenAttemptsSeconds);\n+                    removePath).executeAndRepeatUntilExitCode(expectedExitCode,\n+                            attempts, waitBetweenAttemptsSeconds);\n@@ -471,0 +473,1 @@\n+        private int expectedExitCode;\n","filename":"test\/jdk\/tools\/jpackage\/helpers\/jdk\/jpackage\/test\/HelloApp.java","additions":5,"deletions":2,"binary":false,"changes":7,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2019, 2020, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2019, 2022, Oracle and\/or its affiliates. All rights reserved.\n@@ -352,0 +352,11 @@\n+    @Test\n+    @Parameter(\"1\")\n+    @Parameter(\"123\")\n+    public void testExitCode(int exitCode) {\n+        JPackageCommand cmd = JPackageCommand\n+                .helloAppImage()\n+                .addArguments(\"--java-options\", String.format(\n+                        \"-Djpackage.test.exitCode=%d\", exitCode));\n+        cmd.executeAndAssertHelloAppImageCreated();\n+    }\n+\n","filename":"test\/jdk\/tools\/jpackage\/share\/jdk\/jpackage\/tests\/BasicTest.java","additions":12,"deletions":1,"binary":false,"changes":13,"status":"modified"}]}