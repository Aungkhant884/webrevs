{"files":[{"patch":"@@ -212,0 +212,12 @@\n+    public static enum RV_VENDOR {\n+        \/\/ NSS\n+        CKR_NSS_CERTDB_FAILED(0xCE534351L),\n+        CKR_NSS_KEYDB_FAILED(0xCE534352L);\n+\n+        private final long value;\n+\n+        RV_VENDOR(long value) {\n+            this.value = value;\n+        }\n+    };\n+\n@@ -218,2 +230,13 @@\n-        \/\/ for unknown PKCS11 return values, just use hex as its string\n-        return \"0x\" + Functions.toFullHexString((int)errorCode);\n+        \/\/ for unknown PKCS11 return values, use hex as its string\n+        String res = \"0x\" + Functions.toFullHexString((int)errorCode);\n+        \/\/ for vendor-defined values, check the enum for vendors and include\n+        \/\/ potential matches\n+        if ((errorCode & 0x80000000L) != 0) {\n+            for (RV_VENDOR r : RV_VENDOR.values()) {\n+                if (r.value == errorCode) {\n+                    res += \"(\" + r.name() + \")\";\n+                    break;\n+                }\n+            }\n+        }\n+        return res;\n","filename":"src\/jdk.crypto.cryptoki\/share\/classes\/sun\/security\/pkcs11\/wrapper\/PKCS11Exception.java","additions":25,"deletions":2,"binary":false,"changes":27,"status":"modified"}]}