{"files":[{"patch":"@@ -41,0 +41,1 @@\n+  uintx _claim_token;\n@@ -44,1 +45,2 @@\n-    _satb_qset(satb_qset) { }\n+    _satb_qset(satb_qset),\n+    _claim_token(Threads::thread_claim_token()) { }\n@@ -47,2 +49,4 @@\n-    \/\/ Transfer any partial buffer to the qset for completed buffer processing.\n-    _satb_qset.flush_queue(ShenandoahThreadLocalData::satb_mark_queue(thread));\n+    if (thread->claim_threads_do(true, _claim_token)) {\n+      \/\/ Transfer any partial buffer to the qset for completed buffer processing.\n+      _satb_qset.flush_queue(ShenandoahThreadLocalData::satb_mark_queue(thread));\n+    }\n@@ -95,1 +99,1 @@\n-  size_t _trashed_oops;\n+  volatile size_t _trashed_oops;\n@@ -100,1 +104,3 @@\n-    _trashed_oops(0) {}\n+    _trashed_oops(0) {\n+    Threads::change_thread_claim_token();\n+  }\n@@ -112,1 +118,1 @@\n-    Threads::possibly_parallel_threads_do(true \/*par*\/, &flusher);\n+    Threads::threads_do(&flusher);\n","filename":"src\/hotspot\/share\/gc\/shenandoah\/shenandoahOldGeneration.cpp","additions":12,"deletions":6,"binary":false,"changes":18,"status":"modified"}]}