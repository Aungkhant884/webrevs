{"files":[{"patch":"@@ -236,1 +236,0 @@\n-  uint tenuring_threshold = ShenandoahGenerationalMaxTenuringAge;\n@@ -241,1 +240,9 @@\n-  for (uint i = ShenandoahGenerationalMaxTenuringAge - 1; i > MAX2((uint)ShenandoahGenerationalMinTenuringAge, (uint)0); i--) {\n+  uint upper_bound = ShenandoahGenerationalMaxTenuringAge - 1;\n+  const uint prev_tt = previous_tenuring_threshold();\n+  if (ShenandoahGenerationalCensusIgnoreOlderCohorts && prev_tt > 0) {\n+     \/\/ We stay below the computed tenuring threshold for the last cycle plus 1,\n+     \/\/ ignoring the mortality rates of any older cohorts.\n+     upper_bound = MIN2(upper_bound, prev_tt + 1);\n+  }\n+  uint tenuring_threshold = upper_bound;\n+  for (uint i = upper_bound; i > MAX2((uint)ShenandoahGenerationalMinTenuringAge, (uint)0); i--) {\n","filename":"src\/hotspot\/share\/gc\/shenandoah\/shenandoahAgeCensus.cpp","additions":9,"deletions":2,"binary":false,"changes":11,"status":"modified"},{"patch":"@@ -167,0 +167,11 @@\n+  \/\/ Return the tenuring threshold computed for the previous epoch\n+  uint previous_tenuring_threshold() const {\n+    assert(_epoch < MAX_SNAPSHOTS, \"Error\");\n+    uint prev = _epoch - 1;\n+    if (prev >= MAX_SNAPSHOTS) {\n+      \/\/ _epoch is 0\n+      prev = MAX_SNAPSHOTS - 1;\n+    }\n+    return _tenuring_threshold[prev];\n+  }\n+\n","filename":"src\/hotspot\/share\/gc\/shenandoah\/shenandoahAgeCensus.hpp","additions":11,"deletions":0,"binary":false,"changes":11,"status":"modified"},{"patch":"@@ -45,0 +45,5 @@\n+  product(bool, ShenandoahGenerationalCensusIgnoreOlderCohorts, false,      \\\n+                                                               EXPERIMENTAL,\\\n+          \"(Generational mode only) Ignore mortality rates older than the \" \\\n+          \" oldest cohort under the tenuring age for the last cycle.\" )     \\\n+                                                                            \\\n","filename":"src\/hotspot\/share\/gc\/shenandoah\/shenandoah_globals.hpp","additions":5,"deletions":0,"binary":false,"changes":5,"status":"modified"}]}