{"files":[{"patch":"@@ -66,1 +66,2 @@\n-  if (heap->mode()->is_generational() && heap->is_in_old(field) && heap->is_in_young(value)) {\n+  assert(ShenandoahCardBarrier, \"Card-mark barrier should be on\");\n+  if (heap->is_in_old(field) && heap->is_in_young(value)) {\n@@ -84,1 +85,3 @@\n-  card_mark_barrier(field, value);\n+  if (ShenandoahCardBarrier) {\n+    card_mark_barrier(field, value);\n+  }\n@@ -90,1 +93,3 @@\n-  card_mark_barrier(field, value);\n+  if (ShenandoahCardBarrier) {\n+    card_mark_barrier(field, value);\n+  }\n@@ -386,3 +391,1 @@\n-      if (heap->is_in_old(addr) && heap->is_in_young(discovered_head)) {\n-        heap->mark_card_as_dirty(addr);\n-      }\n+      card_mark_barrier(addr, discovered_head);\n","filename":"src\/hotspot\/share\/gc\/shenandoah\/shenandoahReferenceProcessor.cpp","additions":9,"deletions":6,"binary":false,"changes":15,"status":"modified"}]}