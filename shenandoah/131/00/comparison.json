{"files":[{"patch":"@@ -34,0 +34,2 @@\n+  _success_old_gcs(0),\n+  _interrupted_old_gcs(0),\n@@ -86,0 +88,8 @@\n+void ShenandoahCollectorPolicy::record_success_old() {\n+  _success_old_gcs++;\n+}\n+\n+void ShenandoahCollectorPolicy::record_interrupted_old() {\n+  _interrupted_old_gcs++;\n+}\n+\n@@ -117,1 +127,1 @@\n-  out->print_cr(SIZE_FORMAT_W(5) \" successful concurrent GCs\",         _success_concurrent_gcs);\n+  out->print_cr(SIZE_FORMAT_W(5) \" Successful Concurrent GCs\",         _success_concurrent_gcs);\n@@ -122,0 +132,4 @@\n+  out->print_cr(SIZE_FORMAT_W(5) \" Completed Old GCs\",                 _success_old_gcs);\n+  out->print_cr(\"  \" SIZE_FORMAT_W(5) \" interruptions\",                _interrupted_old_gcs);\n+  out->cr();\n+\n","filename":"src\/hotspot\/share\/gc\/shenandoah\/shenandoahCollectorPolicy.cpp","additions":15,"deletions":1,"binary":false,"changes":16,"status":"modified"},{"patch":"@@ -42,0 +42,2 @@\n+  size_t _success_old_gcs;\n+  size_t _interrupted_old_gcs;\n@@ -67,0 +69,2 @@\n+  void record_success_old();\n+  void record_interrupted_old();\n","filename":"src\/hotspot\/share\/gc\/shenandoah\/shenandoahCollectorPolicy.hpp","additions":4,"deletions":0,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -606,1 +606,2 @@\n-      _generation->swap_remembered_set();\n+        ShenandoahGCPhase phase(ShenandoahPhaseTimings::init_swap_rset);\n+        _generation->swap_remembered_set();\n@@ -615,0 +616,1 @@\n+      ShenandoahGCPhase phase(ShenandoahPhaseTimings::init_transfer_satb);\n","filename":"src\/hotspot\/share\/gc\/shenandoah\/shenandoahConcurrentGC.cpp","additions":3,"deletions":1,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -327,21 +327,1 @@\n-      \/\/ Commit worker statistics to cycle data\n-      heap->phase_timings()->flush_par_workers_to_cycle();\n-      if (ShenandoahPacing) {\n-        heap->pacer()->flush_stats_to_cycle();\n-      }\n-\n-      \/\/ Print GC stats for current cycle\n-      {\n-        LogTarget(Info, gc, stats) lt;\n-        if (lt.is_enabled()) {\n-          ResourceMark rm;\n-          LogStream ls(lt);\n-          heap->phase_timings()->print_cycle_on(&ls);\n-          if (ShenandoahPacing) {\n-            heap->pacer()->print_cycle_on(&ls);\n-          }\n-        }\n-      }\n-\n-      \/\/ Commit statistics to globals\n-      heap->phase_timings()->flush_cycle_to_global();\n+      process_phase_timings(heap);\n@@ -398,0 +378,25 @@\n+void ShenandoahControlThread::process_phase_timings(const ShenandoahHeap* heap) {\n+\n+  \/\/ Commit worker statistics to cycle data\n+  heap->phase_timings()->flush_par_workers_to_cycle();\n+  if (ShenandoahPacing) {\n+    heap->pacer()->flush_stats_to_cycle();\n+  }\n+\n+  \/\/ Print GC stats for current cycle\n+  {\n+    LogTarget(Info, gc, stats) lt;\n+    if (lt.is_enabled()) {\n+      ResourceMark rm;\n+      LogStream ls(lt);\n+      heap->phase_timings()->print_cycle_on(&ls);\n+      if (ShenandoahPacing) {\n+        heap->pacer()->print_cycle_on(&ls);\n+      }\n+    }\n+  }\n+\n+  \/\/ Commit statistics to globals\n+  heap->phase_timings()->flush_cycle_to_global();\n+}\n+\n@@ -471,0 +476,3 @@\n+\n+  process_phase_timings(heap);\n+\n@@ -481,5 +489,0 @@\n-    \/\/ TODO: Bit of a hack here to keep the phase timings happy as we transition\n-    \/\/ to concurrent old marking. We need to revisit this.\n-    heap->phase_timings()->flush_par_workers_to_cycle();\n-    heap->phase_timings()->flush_cycle_to_global();\n-\n@@ -534,1 +537,1 @@\n-    heap->shenandoah_policy()->record_success_concurrent();\n+    heap->shenandoah_policy()->record_success_old();\n@@ -548,0 +551,3 @@\n+    if (_requested_gc_cause == GCCause::_shenandoah_concurrent_gc) {\n+      heap->shenandoah_policy()->record_interrupted_old();\n+    }\n@@ -757,0 +763,1 @@\n+\n","filename":"src\/hotspot\/share\/gc\/shenandoah\/shenandoahControlThread.cpp","additions":34,"deletions":27,"binary":false,"changes":61,"status":"modified"},{"patch":"@@ -135,0 +135,2 @@\n+  void process_phase_timings(const ShenandoahHeap* heap);\n+\n","filename":"src\/hotspot\/share\/gc\/shenandoah\/shenandoahControlThread.hpp","additions":2,"deletions":0,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -56,0 +56,2 @@\n+  f(init_swap_rset,                                 \"  Swap Remembered Set\")           \\\n+  f(init_transfer_satb,                             \"  Transfer Old From SATB\")        \\\n@@ -69,2 +71,0 @@\n-  f(coalesce_and_fill,                              \"Coalesce and Fill Old Dead\")      \\\n-  SHENANDOAH_PAR_PHASE_DO(coalesce_and_fill_,       \"    CFOD: \", f)                   \\\n@@ -103,0 +103,2 @@\n+  f(coalesce_and_fill,                              \"Coalesce and Fill Old Dead\")      \\\n+  SHENANDOAH_PAR_PHASE_DO(coalesce_and_fill_,       \"    CFOD: \", f)                   \\\n","filename":"src\/hotspot\/share\/gc\/shenandoah\/shenandoahPhaseTimings.hpp","additions":4,"deletions":2,"binary":false,"changes":6,"status":"modified"}]}