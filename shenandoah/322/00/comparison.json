{"files":[{"patch":"@@ -56,1 +56,1 @@\n-  if (heap->mode()->is_generational()) {\n+  if (ShenandoahCardBarrier) {\n@@ -161,3 +161,1 @@\n-  if (!_heap->mode()->is_generational()) {\n-    return;\n-  }\n+  assert(ShenandoahCardBarrier, \"Did you mean to enable ShenandoahCardBarrier?\");\n","filename":"src\/hotspot\/share\/gc\/shenandoah\/shenandoahBarrierSet.cpp","additions":2,"deletions":4,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -190,4 +190,3 @@\n-  if (ShenandoahHeap::heap()->mode()->is_generational()) {\n-    volatile CardTable::CardValue* byte = card_table()->byte_for(field);\n-    *byte = CardTable::dirty_card_val();\n-  }\n+  assert(ShenandoahCardBarrier, \"Did you mean to enable ShenandoahCardBarrier?\");\n+  volatile CardTable::CardValue* byte = card_table()->byte_for(field);\n+  *byte = CardTable::dirty_card_val();\n@@ -283,2 +282,4 @@\n-  ShenandoahBarrierSet* bs = ShenandoahBarrierSet::barrier_set();\n-  bs->write_ref_field_post<decorators>(addr);\n+  if (ShenandoahCardBarrier) {\n+    ShenandoahBarrierSet* bs = ShenandoahBarrierSet::barrier_set();\n+    bs->write_ref_field_post<decorators>(addr);\n+  }\n@@ -306,1 +307,3 @@\n-  bs->write_ref_field_post<decorators>(addr);\n+  if (ShenandoahCardBarrier) {\n+    bs->write_ref_field_post<decorators>(addr);\n+  }\n@@ -317,1 +320,3 @@\n-  bs->write_ref_field_post<decorators>(addr);\n+  if (ShenandoahCardBarrier) {\n+    bs->write_ref_field_post<decorators>(addr);\n+  }\n@@ -335,1 +340,3 @@\n-  bs->write_ref_field_post<decorators>(addr);\n+  if (ShenandoahCardBarrier) {\n+    bs->write_ref_field_post<decorators>(addr);\n+  }\n@@ -346,1 +353,3 @@\n-  bs->write_ref_field_post<decorators>(addr);\n+  if (ShenandoahCardBarrier) {\n+    bs->write_ref_field_post<decorators>(addr);\n+  }\n@@ -370,1 +379,3 @@\n-  bs->write_ref_array((HeapWord*) dst, length);\n+  if (ShenandoahCardBarrier) {\n+    bs->write_ref_array((HeapWord*) dst, length);\n+  }\n","filename":"src\/hotspot\/share\/gc\/shenandoah\/shenandoahBarrierSet.inline.hpp","additions":22,"deletions":11,"binary":false,"changes":33,"status":"modified"}]}