{"files":[{"patch":"@@ -98,1 +98,1 @@\n-  bool is_global = (_generation->generation_mode() == GLOBAL);\n+  bool is_global = _generation->is_global();\n","filename":"src\/hotspot\/share\/gc\/shenandoah\/heuristics\/shenandoahAdaptiveHeuristics.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -103,1 +103,1 @@\n-  assert(_generation->generation_mode() != OLD, \"Old GC invokes ShenandoahOldHeuristics::choose_collection_set()\");\n+  assert(!_generation->is_old(), \"Old GC invokes ShenandoahOldHeuristics::choose_collection_set()\");\n@@ -143,1 +143,1 @@\n-        assert (_generation->generation_mode() != OLD, \"OLD is handled elsewhere\");\n+        assert(!_generation->is_old(), \"OLD is handled elsewhere\");\n@@ -371,3 +371,3 @@\n-  return ((_generation->generation_mode() == GLOBAL)\n-          || (_generation->generation_mode() == YOUNG && region->affiliation() == YOUNG_GENERATION)\n-          || (_generation->generation_mode() == OLD && region->affiliation() == OLD_GENERATION));\n+  return _generation->is_global()\n+          || (_generation->is_young() && region->is_young())\n+          || (_generation->is_old()   && region->is_old());\n@@ -377,4 +377,1 @@\n-  size_t min_free_threshold =\n-      _generation->generation_mode() == GenerationMode::OLD\n-          ? ShenandoahOldMinFreeThreshold\n-          : ShenandoahMinFreeThreshold;\n+  size_t min_free_threshold = _generation->is_old() ? ShenandoahOldMinFreeThreshold : ShenandoahMinFreeThreshold;\n","filename":"src\/hotspot\/share\/gc\/shenandoah\/heuristics\/shenandoahHeuristics.cpp","additions":6,"deletions":9,"binary":false,"changes":15,"status":"modified"},{"patch":"@@ -77,1 +77,1 @@\n-  \/\/ if (_generation->generation_mode() == GLOBAL) _region_data represents\n+  \/\/ if (_generation->type() == GLOBAL) _region_data represents\n@@ -79,1 +79,1 @@\n-  \/\/ if (_generation->generation_mode() == OLD) _region_data represents\n+  \/\/ if (_generation->type() == OLD) _region_data represents\n@@ -81,1 +81,1 @@\n-  \/\/ if (_generation->generation_mode() == YOUNG) _region_data represents\n+  \/\/ if (_generation->type() == YOUNG) _region_data represents\n","filename":"src\/hotspot\/share\/gc\/shenandoah\/heuristics\/shenandoahHeuristics.hpp","additions":3,"deletions":3,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -47,1 +47,1 @@\n-  assert(_generation->generation_mode() == OLD, \"This service only available for old-gc heuristics\");\n+  assert(_generation->is_old(), \"This service only available for old-gc heuristics\");\n@@ -215,1 +215,1 @@\n-  assert(_generation->generation_mode() == OLD, \"This service only available for old-gc heuristics\");\n+  assert(_generation->is_old(), \"This service only available for old-gc heuristics\");\n","filename":"src\/hotspot\/share\/gc\/shenandoah\/heuristics\/shenandoahOldHeuristics.cpp","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -29,1 +29,0 @@\n-#include \"gc\/shenandoah\/shenandoahHeap.inline.hpp\"\n@@ -67,49 +66,0 @@\n-\n-const char* affiliation_name(oop ptr) {\n-  ShenandoahHeap* heap = ShenandoahHeap::heap();\n-  assert(heap->is_in(ptr), \"Oop must be in the heap.\");\n-  ShenandoahHeapRegion* region = heap->heap_region_containing(ptr);\n-  return affiliation_name(region->affiliation());\n-}\n-\n-const char affiliation_code(ShenandoahRegionAffiliation type) {\n-  switch(type) {\n-    case ShenandoahRegionAffiliation::FREE:\n-      return 'F';\n-    case ShenandoahRegionAffiliation::YOUNG_GENERATION:\n-      return 'Y';\n-    case ShenandoahRegionAffiliation::OLD_GENERATION:\n-      return 'O';\n-    default:\n-      ShouldNotReachHere();\n-      return 'X';\n-  }\n-}\n-\n-const char* affiliation_name(ShenandoahRegionAffiliation type) {\n-  switch (type) {\n-    case ShenandoahRegionAffiliation::FREE:\n-      return \"FREE\";\n-    case ShenandoahRegionAffiliation::YOUNG_GENERATION:\n-      return \"YOUNG\";\n-    case ShenandoahRegionAffiliation::OLD_GENERATION:\n-      return \"OLD\";\n-    default:\n-      ShouldNotReachHere();\n-      return nullptr;\n-  }\n-}\n-\n-const char* generation_name(GenerationMode mode) {\n-  switch (mode) {\n-    case GenerationMode::GLOBAL:\n-      return \"Global\";\n-    case GenerationMode::OLD:\n-      return \"Old\";\n-    case GenerationMode::YOUNG:\n-      return \"Young\";\n-    default:\n-      ShouldNotReachHere();\n-      return nullptr;\n-  }\n-}\n","filename":"src\/hotspot\/share\/gc\/shenandoah\/mode\/shenandoahGenerationalMode.cpp","additions":0,"deletions":50,"binary":false,"changes":50,"status":"modified"},{"patch":"@@ -29,18 +29,0 @@\n-#include \"oops\/oopsHierarchy.hpp\"\n-\n-enum GenerationMode {\n-  YOUNG,\n-  OLD,\n-  GLOBAL\n-};\n-\n-enum ShenandoahRegionAffiliation {\n-  FREE,\n-  YOUNG_GENERATION,\n-  OLD_GENERATION\n-};\n-\n-const char* affiliation_name(oop ptr);\n-const char* affiliation_name(ShenandoahRegionAffiliation type);\n-const char affiliation_code(ShenandoahRegionAffiliation type);\n-const char* generation_name(GenerationMode mode);\n","filename":"src\/hotspot\/share\/gc\/shenandoah\/mode\/shenandoahGenerationalMode.hpp","additions":0,"deletions":18,"binary":false,"changes":18,"status":"modified"},{"patch":"@@ -0,0 +1,62 @@\n+\/*\n+ * Copyright Amazon.com Inc. or its affiliates. All Rights Reserved.\n+ * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+ *\n+ * This code is free software; you can redistribute it and\/or modify it\n+ * under the terms of the GNU General Public License version 2 only, as\n+ * published by the Free Software Foundation.\n+ *\n+ * This code is distributed in the hope that it will be useful, but WITHOUT\n+ * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+ * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+ * version 2 for more details (a copy is included in the LICENSE file that\n+ * accompanied this code).\n+ *\n+ * You should have received a copy of the GNU General Public License version\n+ * 2 along with this work; if not, write to the Free Software Foundation,\n+ * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n+ *\n+ * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n+ * or visit www.oracle.com if you need additional information or have any\n+ * questions.\n+ *\n+ *\/\n+\n+#ifndef SHARE_GC_SHENANDOAH_SHENANDOAHAFFILIATION_HPP\n+#define SHARE_GC_SHENANDOAH_SHENANDOAHAFFILIATION_HPP\n+\n+enum ShenandoahAffiliation {\n+  FREE,\n+  YOUNG_GENERATION,\n+  OLD_GENERATION,\n+};\n+\n+inline const char* shenandoah_affiliation_code(ShenandoahAffiliation type) {\n+  switch(type) {\n+    case FREE:\n+      return \"F\";\n+    case YOUNG_GENERATION:\n+      return \"Y\";\n+    case OLD_GENERATION:\n+      return \"O\";\n+    default:\n+      ShouldNotReachHere();\n+      return \"?\";\n+  }\n+}\n+\n+inline const char* shenandoah_affiliation_name(ShenandoahAffiliation type) {\n+  switch (type) {\n+    case FREE:\n+      return \"FREE\";\n+    case YOUNG_GENERATION:\n+      return \"YOUNG\";\n+    case OLD_GENERATION:\n+      return \"OLD\";\n+    default:\n+      ShouldNotReachHere();\n+      return \"?\";\n+  }\n+}\n+\n+#endif \/\/ SHARE_GC_SHENANDOAH_SHENANDOAHAFFILIATION_HPP\n","filename":"src\/hotspot\/share\/gc\/shenandoah\/shenandoahAffiliation.hpp","additions":62,"deletions":0,"binary":false,"changes":62,"status":"added"},{"patch":"@@ -28,0 +28,1 @@\n+#include \"gc\/shenandoah\/shenandoahAffiliation.hpp\"\n@@ -29,1 +30,0 @@\n-#include \"gc\/shenandoah\/mode\/shenandoahGenerationalMode.hpp\"\n@@ -65,1 +65,1 @@\n-  ShenandoahRegionAffiliation const _affiliation;\n+  ShenandoahAffiliation const _affiliation;\n@@ -70,1 +70,1 @@\n-  ShenandoahAllocRequest(size_t _min_size, size_t _requested_size, Type _alloc_type, ShenandoahRegionAffiliation affiliation) :\n+  ShenandoahAllocRequest(size_t _min_size, size_t _requested_size, Type _alloc_type, ShenandoahAffiliation affiliation) :\n@@ -80,1 +80,1 @@\n-    return ShenandoahAllocRequest(min_size, requested_size, _alloc_tlab, ShenandoahRegionAffiliation::YOUNG_GENERATION);\n+    return ShenandoahAllocRequest(min_size, requested_size, _alloc_tlab, ShenandoahAffiliation::YOUNG_GENERATION);\n@@ -84,1 +84,1 @@\n-    return ShenandoahAllocRequest(min_size, requested_size, _alloc_gclab, ShenandoahRegionAffiliation::YOUNG_GENERATION);\n+    return ShenandoahAllocRequest(min_size, requested_size, _alloc_gclab, ShenandoahAffiliation::YOUNG_GENERATION);\n@@ -88,1 +88,1 @@\n-    return ShenandoahAllocRequest(min_size, requested_size, _alloc_plab, ShenandoahRegionAffiliation::OLD_GENERATION);\n+    return ShenandoahAllocRequest(min_size, requested_size, _alloc_plab, ShenandoahAffiliation::OLD_GENERATION);\n@@ -91,1 +91,1 @@\n-  static inline ShenandoahAllocRequest for_shared_gc(size_t requested_size, ShenandoahRegionAffiliation affiliation) {\n+  static inline ShenandoahAllocRequest for_shared_gc(size_t requested_size, ShenandoahAffiliation affiliation) {\n@@ -96,1 +96,1 @@\n-    return ShenandoahAllocRequest(0, requested_size, _alloc_shared, ShenandoahRegionAffiliation::YOUNG_GENERATION);\n+    return ShenandoahAllocRequest(0, requested_size, _alloc_shared, ShenandoahAffiliation::YOUNG_GENERATION);\n@@ -182,1 +182,1 @@\n-  ShenandoahRegionAffiliation affiliation() const {\n+  ShenandoahAffiliation affiliation() const {\n@@ -185,0 +185,4 @@\n+\n+  const char* affiliation_name() const {\n+    return shenandoah_affiliation_name(_affiliation);\n+  }\n","filename":"src\/hotspot\/share\/gc\/shenandoah\/shenandoahAllocRequest.hpp","additions":13,"deletions":9,"binary":false,"changes":22,"status":"modified"},{"patch":"@@ -93,1 +93,1 @@\n-  if (r->affiliation() == YOUNG_GENERATION) {\n+  if (r->is_young()) {\n@@ -99,1 +99,1 @@\n-  } else if (r->affiliation() == OLD_GENERATION) {\n+  } else if (r->is_old()) {\n","filename":"src\/hotspot\/share\/gc\/shenandoah\/shenandoahCollectionSet.cpp","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -189,1 +189,1 @@\n-  if (!heap->cancelled_gc() && heap->mode()->is_generational() && _generation->generation_mode() == GLOBAL) {\n+  if (!heap->cancelled_gc() && heap->mode()->is_generational() && _generation->is_global()) {\n@@ -372,1 +372,1 @@\n-  if (_generation->generation_mode() == YOUNG) {\n+  if (_generation->is_young()) {\n@@ -624,1 +624,1 @@\n-      if (_generation->generation_mode() == YOUNG || (_generation->generation_mode() == GLOBAL && ShenandoahVerify)) {\n+      if (_generation->is_young() || (_generation->is_global() && ShenandoahVerify)) {\n@@ -632,1 +632,1 @@\n-    if (_generation->generation_mode() == GLOBAL) {\n+    if (_generation->is_global()) {\n","filename":"src\/hotspot\/share\/gc\/shenandoah\/shenandoahConcurrentGC.cpp","additions":4,"deletions":4,"binary":false,"changes":8,"status":"modified"},{"patch":"@@ -49,1 +49,1 @@\n-template <GenerationMode GENERATION>\n+template <ShenandoahGenerationType GENERATION>\n@@ -98,1 +98,1 @@\n-template<GenerationMode GENERATION>\n+template<ShenandoahGenerationType GENERATION>\n@@ -144,1 +144,1 @@\n-template<GenerationMode GENERATION>\n+template<ShenandoahGenerationType GENERATION>\n@@ -162,1 +162,1 @@\n-template<GenerationMode GENERATION>\n+template<ShenandoahGenerationType GENERATION>\n@@ -176,1 +176,1 @@\n-template<GenerationMode GENERATION>\n+template<ShenandoahGenerationType GENERATION>\n@@ -192,1 +192,1 @@\n-  switch (_generation->generation_mode()) {\n+  switch (_generation->type()) {\n@@ -233,1 +233,1 @@\n-    switch (_generation->generation_mode()) {\n+    switch (_generation->type()) {\n@@ -303,1 +303,1 @@\n-  switch (_generation->generation_mode()) {\n+  switch (_generation->type()) {\n","filename":"src\/hotspot\/share\/gc\/shenandoah\/shenandoahConcurrentMark.cpp","additions":8,"deletions":8,"binary":false,"changes":16,"status":"modified"},{"patch":"@@ -30,1 +30,1 @@\n-template <GenerationMode GENERATION>\n+template <ShenandoahGenerationType GENERATION>\n@@ -32,1 +32,1 @@\n-template<GenerationMode GENERATION>\n+template<ShenandoahGenerationType GENERATION>\n@@ -37,2 +37,2 @@\n-  template <GenerationMode GENERATION> friend class ShenandoahConcurrentMarkingTask;\n-  template <GenerationMode GENERATION> friend class ShenandoahFinalMarkingTask;\n+  template <ShenandoahGenerationType GENERATION> friend class ShenandoahConcurrentMarkingTask;\n+  template <ShenandoahGenerationType GENERATION> friend class ShenandoahFinalMarkingTask;\n","filename":"src\/hotspot\/share\/gc\/shenandoah\/shenandoahConcurrentMark.hpp","additions":4,"deletions":4,"binary":false,"changes":8,"status":"modified"},{"patch":"@@ -63,1 +63,1 @@\n-  _requested_generation(GenerationMode::GLOBAL),\n+  _requested_generation(ShenandoahGenerationType::GLOBAL),\n@@ -95,1 +95,1 @@\n-  GenerationMode generation = GLOBAL;\n+  ShenandoahGenerationType generation = GLOBAL;\n@@ -150,1 +150,1 @@\n-      generation = _degen_generation->generation_mode();\n+      generation = _degen_generation->type();\n@@ -462,1 +462,1 @@\n-  const ShenandoahHeap* heap, const GenerationMode generation, GCCause::Cause cause) {\n+        const ShenandoahHeap* heap, const ShenandoahGenerationType generation, GCCause::Cause cause) {\n@@ -684,1 +684,1 @@\n-    assert(generation->generation_mode() != OLD, \"Old GC takes a different control path\");\n+    assert(!generation->is_old(), \"Old GC takes a different control path\");\n@@ -755,1 +755,1 @@\n-  if (_degen_generation->generation_mode() == GLOBAL) {\n+  if (_degen_generation->is_global()) {\n@@ -759,1 +759,1 @@\n-    assert(_degen_generation->generation_mode() == YOUNG, \"Expected degenerated young cycle, if not global.\");\n+    assert(_degen_generation->is_young(), \"Expected degenerated young cycle, if not global.\");\n@@ -825,1 +825,1 @@\n-bool ShenandoahControlThread::request_concurrent_gc(GenerationMode generation) {\n+bool ShenandoahControlThread::request_concurrent_gc(ShenandoahGenerationType generation) {\n@@ -841,1 +841,1 @@\n-    log_info(gc)(\"Preempting old generation mark to allow %s GC.\", generation_name(generation));\n+    log_info(gc)(\"Preempting old generation mark to allow %s GC.\", shenandoah_generation_name(generation));\n@@ -861,1 +861,1 @@\n-bool ShenandoahControlThread::preempt_old_marking(GenerationMode generation) {\n+bool ShenandoahControlThread::preempt_old_marking(ShenandoahGenerationType generation) {\n","filename":"src\/hotspot\/share\/gc\/shenandoah\/shenandoahControlThread.cpp","additions":10,"deletions":10,"binary":false,"changes":20,"status":"modified"},{"patch":"@@ -93,1 +93,1 @@\n-  GenerationMode       _requested_generation;\n+  ShenandoahGenerationType       _requested_generation;\n@@ -138,1 +138,1 @@\n-  bool preempt_old_marking(GenerationMode generation);\n+  bool preempt_old_marking(ShenandoahGenerationType generation);\n@@ -160,1 +160,1 @@\n-  bool request_concurrent_gc(GenerationMode generation);\n+  bool request_concurrent_gc(ShenandoahGenerationType generation);\n@@ -175,1 +175,1 @@\n-                                       const GenerationMode generation,\n+                                       const ShenandoahGenerationType generation,\n","filename":"src\/hotspot\/share\/gc\/shenandoah\/shenandoahControlThread.hpp","additions":4,"deletions":4,"binary":false,"changes":8,"status":"modified"},{"patch":"@@ -95,1 +95,1 @@\n-    if (_generation->generation_mode() == GenerationMode::GLOBAL) {\n+    if (_generation->is_global()) {\n@@ -135,1 +135,1 @@\n-      heap->set_unload_classes((!heap->mode()->is_generational() || _generation->generation_mode() == GLOBAL) && _generation->heuristics()->can_unload_classes());\n+      heap->set_unload_classes((!heap->mode()->is_generational() || _generation->is_global()) && _generation->heuristics()->can_unload_classes());\n@@ -137,1 +137,1 @@\n-      if (heap->mode()->is_generational() && (_generation->generation_mode() == YOUNG || (_generation->generation_mode() == GLOBAL && ShenandoahVerify))) {\n+      if (heap->mode()->is_generational() && (_generation->is_young() || (_generation->is_global() && ShenandoahVerify))) {\n@@ -187,1 +187,1 @@\n-      if (heap->mode()->is_generational() && _generation->generation_mode() == GLOBAL) {\n+      if (heap->mode()->is_generational() && _generation->is_global()) {\n","filename":"src\/hotspot\/share\/gc\/shenandoah\/shenandoahDegeneratedGC.cpp","additions":4,"deletions":4,"binary":false,"changes":8,"status":"modified"},{"patch":"@@ -27,0 +27,1 @@\n+#include \"gc\/shenandoah\/shenandoahAffiliation.hpp\"\n@@ -74,1 +75,1 @@\n-  ShenandoahRegionAffiliation affiliation = ShenandoahRegionAffiliation::OLD_GENERATION;\n+  ShenandoahAffiliation affiliation = ShenandoahAffiliation::OLD_GENERATION;\n@@ -95,1 +96,1 @@\n-HeapWord* ShenandoahFreeSet::allocate_with_affiliation(ShenandoahRegionAffiliation affiliation, ShenandoahAllocRequest& req, bool& in_new_region) {\n+HeapWord* ShenandoahFreeSet::allocate_with_affiliation(ShenandoahAffiliation affiliation, ShenandoahAllocRequest& req, bool& in_new_region) {\n@@ -109,1 +110,1 @@\n-  log_debug(gc, free)(\"Could not allocate collector region with affiliation: %s for request \" PTR_FORMAT, affiliation_name(affiliation), p2i(&req));\n+  log_debug(gc, free)(\"Could not allocate collector region with affiliation: %s for request \" PTR_FORMAT, shenandoah_affiliation_name(affiliation), p2i(&req));\n@@ -131,1 +132,1 @@\n-      case ShenandoahRegionAffiliation::OLD_GENERATION:\n+      case ShenandoahAffiliation::OLD_GENERATION:\n@@ -138,1 +139,1 @@\n-      case ShenandoahRegionAffiliation::YOUNG_GENERATION:\n+      case ShenandoahAffiliation::YOUNG_GENERATION:\n@@ -145,1 +146,1 @@\n-      case ShenandoahRegionAffiliation::FREE:\n+      case ShenandoahAffiliation::FREE:\n@@ -158,1 +159,1 @@\n-        if (is_mutator_free(idx) && (allow_new_region || r->affiliation() != ShenandoahRegionAffiliation::FREE)) {\n+        if (is_mutator_free(idx) && (allow_new_region || r->is_affiliated())) {\n@@ -192,1 +193,1 @@\n-        if (req.affiliation() == ShenandoahRegionAffiliation::OLD_GENERATION) {\n+        if (req.is_old()) {\n@@ -253,1 +254,1 @@\n-  if (r->affiliation() == ShenandoahRegionAffiliation::FREE) {\n+  if (!r->is_affiliated()) {\n@@ -271,1 +272,1 @@\n-           affiliation_name(req.affiliation()), affiliation_name(r->affiliation()));\n+           req.affiliation_name(), r->affiliation_name());\n@@ -334,1 +335,1 @@\n-          assert(r->affiliation() == ShenandoahRegionAffiliation::OLD_GENERATION, \"All PLABs reside in old-gen\");\n+          assert(r->is_old(), \"All PLABs reside in old-gen\");\n@@ -386,1 +387,1 @@\n-        assert(r->affiliation() == ShenandoahRegionAffiliation::OLD_GENERATION, \"All PLABs reside in old-gen\");\n+        assert(r->is_old(), \"All PLABs reside in old-gen\");\n@@ -419,1 +420,1 @@\n-      if (r->affiliation() == ShenandoahRegionAffiliation::OLD_GENERATION) {\n+      if (r->is_old()) {\n@@ -495,1 +496,1 @@\n-  assert(req.affiliation() == ShenandoahRegionAffiliation::YOUNG_GENERATION, \"Humongous regions always allocated in YOUNG\");\n+  assert(req.is_young(), \"Humongous regions always allocated in YOUNG\");\n@@ -576,1 +577,1 @@\n-                        p2i(r->bottom()), p2i(r->end()), p2i(ctx->top_bitmap(r)), affiliation_name(req.affiliation()));\n+                        p2i(r->bottom()), p2i(r->end()), p2i(ctx->top_bitmap(r)), req.affiliation_name());\n","filename":"src\/hotspot\/share\/gc\/shenandoah\/shenandoahFreeSet.cpp","additions":16,"deletions":15,"binary":false,"changes":31,"status":"modified"},{"patch":"@@ -52,1 +52,1 @@\n-  HeapWord* allocate_with_affiliation(ShenandoahRegionAffiliation affiliation, ShenandoahAllocRequest& req, bool& in_new_region);\n+  HeapWord* allocate_with_affiliation(ShenandoahAffiliation affiliation, ShenandoahAllocRequest& req, bool& in_new_region);\n","filename":"src\/hotspot\/share\/gc\/shenandoah\/shenandoahFreeSet.hpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -454,1 +454,1 @@\n-  ShenandoahRegionAffiliation    _from_affiliation;\n+  ShenandoahAffiliation          _from_affiliation;\n@@ -481,1 +481,1 @@\n-      if (_from_affiliation == ShenandoahRegionAffiliation::OLD_GENERATION) {\n+      if (_from_affiliation == ShenandoahAffiliation::OLD_GENERATION) {\n@@ -487,1 +487,1 @@\n-        assert(_from_affiliation == ShenandoahRegionAffiliation::YOUNG_GENERATION, \"from_region must be OLD or YOUNG\");\n+        assert(_from_affiliation == ShenandoahAffiliation::YOUNG_GENERATION, \"from_region must be OLD or YOUNG\");\n@@ -539,1 +539,1 @@\n-    if ((_from_affiliation == ShenandoahRegionAffiliation::YOUNG_GENERATION) &&\n+    if ((_from_affiliation == ShenandoahAffiliation::YOUNG_GENERATION) &&\n@@ -561,1 +561,1 @@\n-    if (promote_object || (_from_affiliation == ShenandoahRegionAffiliation::OLD_GENERATION)) {\n+    if (promote_object || (_from_affiliation == ShenandoahAffiliation::OLD_GENERATION)) {\n@@ -596,1 +596,1 @@\n-      assert(_from_affiliation == ShenandoahRegionAffiliation::YOUNG_GENERATION,\n+      assert(_from_affiliation == ShenandoahAffiliation::YOUNG_GENERATION,\n@@ -752,1 +752,1 @@\n-                    worker_id, affiliation_name(from_region->affiliation()),\n+                    worker_id, from_region->affiliation_name(),\n@@ -887,1 +887,1 @@\n-                 affiliation_name(r->affiliation()),  r->index());\n+                 r->affiliation_name(),  r->index());\n@@ -892,1 +892,1 @@\n-                 \"Humongous Start %s Region \" SIZE_FORMAT \" should have live\", affiliation_name(r->affiliation()),  r->index());\n+                 \"Humongous Start %s Region \" SIZE_FORMAT \" should have live\", r->affiliation_name(),  r->index());\n@@ -897,1 +897,1 @@\n-               \"Humongous Continuation %s Region \" SIZE_FORMAT \" should have live\", affiliation_name(r->affiliation()),  r->index());\n+               \"Humongous Continuation %s Region \" SIZE_FORMAT \" should have live\", r->affiliation_name(),  r->index());\n@@ -1392,1 +1392,1 @@\n-        ShenandoahRegionAffiliation original_affiliation = r->affiliation();\n+        ShenandoahAffiliation original_affiliation = r->affiliation();\n","filename":"src\/hotspot\/share\/gc\/shenandoah\/shenandoahFullGC.cpp","additions":11,"deletions":11,"binary":false,"changes":22,"status":"modified"},{"patch":"@@ -780,1 +780,1 @@\n-  assert(generation_mode() != OLD, \"Only YOUNG and GLOBAL GC perform evacuations\");\n+  assert(!is_old(), \"Only YOUNG and GLOBAL GC perform evacuations\");\n@@ -787,1 +787,1 @@\n-    if (generation_mode() == YOUNG) {\n+    if (is_young()) {\n@@ -845,1 +845,1 @@\n-    if (contains(r) && (r->affiliation() != FREE)) {\n+    if (contains(r) && r->is_affiliated()) {\n@@ -882,1 +882,1 @@\n-ShenandoahGeneration::ShenandoahGeneration(GenerationMode generation_mode,\n+ShenandoahGeneration::ShenandoahGeneration(ShenandoahGenerationType type,\n@@ -886,1 +886,1 @@\n-  _generation_mode(generation_mode),\n+  _type(type),\n@@ -918,1 +918,1 @@\n-  assert(generation_mode() == YOUNG, \"Should only scan remembered set for young generation.\");\n+  assert(is_young(), \"Should only scan remembered set for young generation.\");\n","filename":"src\/hotspot\/share\/gc\/shenandoah\/shenandoahGeneration.cpp","additions":6,"deletions":6,"binary":false,"changes":12,"status":"modified"},{"patch":"@@ -30,1 +30,1 @@\n-#include \"gc\/shenandoah\/mode\/shenandoahGenerationalMode.hpp\"\n+#include \"gc\/shenandoah\/shenandoahGenerationType.hpp\"\n@@ -38,0 +38,1 @@\n+class ShenandoahMode;\n@@ -41,1 +42,1 @@\n-  GenerationMode const _generation_mode;\n+  ShenandoahGenerationType const _type;\n@@ -73,1 +74,1 @@\n-  ShenandoahGeneration(GenerationMode generation_mode, uint max_workers, size_t max_capacity, size_t soft_max_capacity);\n+  ShenandoahGeneration(ShenandoahGenerationType type, uint max_workers, size_t max_capacity, size_t soft_max_capacity);\n@@ -76,3 +77,3 @@\n-  bool is_young() const  { return _generation_mode == YOUNG; }\n-  bool is_old() const    { return _generation_mode == OLD; }\n-  bool is_global() const { return _generation_mode == GLOBAL; }\n+  bool is_young() const  { return _type == YOUNG; }\n+  bool is_old() const    { return _type == OLD; }\n+  bool is_global() const { return _type == GLOBAL; }\n@@ -80,1 +81,1 @@\n-  inline GenerationMode generation_mode() const { return _generation_mode; }\n+  inline ShenandoahGenerationType type() const { return _type; }\n","filename":"src\/hotspot\/share\/gc\/shenandoah\/shenandoahGeneration.hpp","additions":8,"deletions":7,"binary":false,"changes":15,"status":"modified"},{"patch":"@@ -0,0 +1,48 @@\n+\/*\n+ * Copyright Amazon.com Inc. or its affiliates. All Rights Reserved.\n+ * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+ *\n+ * This code is free software; you can redistribute it and\/or modify it\n+ * under the terms of the GNU General Public License version 2 only, as\n+ * published by the Free Software Foundation.\n+ *\n+ * This code is distributed in the hope that it will be useful, but WITHOUT\n+ * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+ * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+ * version 2 for more details (a copy is included in the LICENSE file that\n+ * accompanied this code).\n+ *\n+ * You should have received a copy of the GNU General Public License version\n+ * 2 along with this work; if not, write to the Free Software Foundation,\n+ * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n+ *\n+ * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n+ * or visit www.oracle.com if you need additional information or have any\n+ * questions.\n+ *\n+ *\/\n+\n+#ifndef SHARE_GC_SHENANDOAH_SHENANDOAHGENERATIONTYPE_HPP\n+#define SHARE_GC_SHENANDOAH_SHENANDOAHGENERATIONTYPE_HPP\n+\n+enum ShenandoahGenerationType {\n+    YOUNG,\n+    OLD,\n+    GLOBAL\n+};\n+\n+inline const char* shenandoah_generation_name(ShenandoahGenerationType mode) {\n+  switch (mode) {\n+    case GLOBAL:\n+      return \"Global\";\n+    case OLD:\n+      return \"Old\";\n+    case YOUNG:\n+      return \"Young\";\n+    default:\n+      ShouldNotReachHere();\n+      return \"?\";\n+  }\n+}\n+\n+#endif \/\/ SHARE_GC_SHENANDOAH_SHENANDOAHGENERATIONTYPE_HPP\n","filename":"src\/hotspot\/share\/gc\/shenandoah\/shenandoahGenerationType.hpp","additions":48,"deletions":0,"binary":false,"changes":48,"status":"added"},{"patch":"@@ -376,1 +376,1 @@\n-      _affiliations[i] = ShenandoahRegionAffiliation::FREE;\n+      _affiliations[i] = ShenandoahAffiliation::FREE;\n@@ -452,1 +452,1 @@\n-  switch (generation->generation_mode()) {\n+  switch (generation->type()) {\n@@ -463,1 +463,1 @@\n-  switch (generation->generation_mode()) {\n+  switch (generation->type()) {\n@@ -691,1 +691,1 @@\n-  return _gc_generation != nullptr && _gc_generation->generation_mode() == YOUNG;\n+  return _gc_generation != nullptr && _gc_generation->is_young();\n@@ -1296,1 +1296,1 @@\n-        if (req.affiliation() == ShenandoahRegionAffiliation::OLD_GENERATION) {\n+        if (req.is_old()) {\n@@ -1341,1 +1341,1 @@\n-        if ((req.affiliation() == ShenandoahRegionAffiliation::OLD_GENERATION) && req.is_gc_alloc() &&\n+        if (req.is_old() && req.is_gc_alloc() &&\n@@ -1853,2 +1853,1 @@\n-  if (mode()->is_generational() &&\n-      ((generation->generation_mode() == GLOBAL) || upgraded_to_full())) {\n+  if (mode()->is_generational() && (generation->is_global() || upgraded_to_full())) {\n@@ -2641,1 +2640,1 @@\n-        if (!_heap->mode()->is_generational() || (r->affiliation() == ShenandoahRegionAffiliation::YOUNG_GENERATION)) {\n+        if (!_heap->mode()->is_generational() || r->is_young()) {\n@@ -2644,2 +2643,2 @@\n-        } else if (r->affiliation() == ShenandoahRegionAffiliation::OLD_GENERATION) {\n-          if (_heap->active_generation()->generation_mode() == GLOBAL) {\n+        } else if (r->is_old()) {\n+          if (_heap->active_generation()->is_global()) {\n@@ -2670,1 +2669,1 @@\n-                 affiliation_name(r->affiliation()), r->index());\n+                 r->affiliation_name(), r->index());\n@@ -2682,1 +2681,1 @@\n-    if (_heap->mode()->is_generational() && (_heap->active_generation()->generation_mode() != GLOBAL)) {\n+    if (_heap->mode()->is_generational() && !_heap->active_generation()->is_global()) {\n@@ -2695,1 +2694,1 @@\n-        if (r->is_active() && !r->is_cset() && (r->affiliation() == ShenandoahRegionAffiliation::OLD_GENERATION)) {\n+        if (r->is_active() && !r->is_cset() && r->is_old()) {\n@@ -3117,1 +3116,1 @@\n-  if (region->affiliation() != OLD_GENERATION) {\n+  if (!region->is_old()) {\n@@ -3125,1 +3124,1 @@\n-  if (region->affiliation() != YOUNG_GENERATION) {\n+  if (!region->is_young()) {\n@@ -3150,1 +3149,1 @@\n-  if (is_old_bitmap_stable() || active_generation()->generation_mode() == GLOBAL) {\n+  if (is_old_bitmap_stable() || active_generation()->is_global()) {\n@@ -3285,1 +3284,1 @@\n-  if (is_old_bitmap_stable() || active_generation()->generation_mode() == GLOBAL) {\n+  if (is_old_bitmap_stable() || active_generation()->is_global()) {\n@@ -3302,1 +3301,1 @@\n-ShenandoahGeneration* ShenandoahHeap::generation_for(ShenandoahRegionAffiliation affiliation) const {\n+ShenandoahGeneration* ShenandoahHeap::generation_for(ShenandoahAffiliation affiliation) const {\n","filename":"src\/hotspot\/share\/gc\/shenandoah\/shenandoahHeap.cpp","additions":18,"deletions":19,"binary":false,"changes":37,"status":"modified"},{"patch":"@@ -32,1 +32,0 @@\n-#include \"gc\/shenandoah\/mode\/shenandoahGenerationalMode.hpp\"\n@@ -38,0 +37,1 @@\n+#include \"gc\/shenandoah\/shenandoahGenerationType.hpp\"\n@@ -71,0 +71,1 @@\n+class ShenandoahMode;\n@@ -120,1 +121,1 @@\n-template<GenerationMode GENERATION>\n+template<ShenandoahGenerationType GENERATION>\n@@ -273,1 +274,1 @@\n-  uint8_t* _affiliations;       \/\/ Holds array of enum ShenandoahRegionAffiliation, including FREE status in non-generational mode\n+  uint8_t* _affiliations;       \/\/ Holds array of enum ShenandoahAffiliation, including FREE status in non-generational mode\n@@ -549,1 +550,1 @@\n-  ShenandoahGeneration*      generation_for(ShenandoahRegionAffiliation affiliation) const;\n+  ShenandoahGeneration*      generation_for(ShenandoahAffiliation affiliation) const;\n@@ -614,2 +615,2 @@\n-  inline void assert_lock_for_affiliation(ShenandoahRegionAffiliation orig_affiliation,\n-                                          ShenandoahRegionAffiliation new_affiliation);\n+  inline void assert_lock_for_affiliation(ShenandoahAffiliation orig_affiliation,\n+                                          ShenandoahAffiliation new_affiliation);\n@@ -637,2 +638,2 @@\n-  inline ShenandoahRegionAffiliation region_affiliation(const ShenandoahHeapRegion* r);\n-  inline void set_affiliation(ShenandoahHeapRegion* r, ShenandoahRegionAffiliation new_affiliation);\n+  inline ShenandoahAffiliation region_affiliation(const ShenandoahHeapRegion* r);\n+  inline void set_affiliation(ShenandoahHeapRegion* r, ShenandoahAffiliation new_affiliation);\n@@ -640,2 +641,2 @@\n-  inline ShenandoahRegionAffiliation region_affiliation(size_t index);\n-  inline void set_affiliation(size_t index, ShenandoahRegionAffiliation new_affiliation);\n+  inline ShenandoahAffiliation region_affiliation(size_t index);\n+  inline void set_affiliation(size_t index, ShenandoahAffiliation new_affiliation);\n@@ -783,1 +784,1 @@\n-  inline oop try_evacuate_object(oop src, Thread* thread, ShenandoahHeapRegion* from_region, ShenandoahRegionAffiliation target_gen);\n+  inline oop try_evacuate_object(oop src, Thread* thread, ShenandoahHeapRegion* from_region, ShenandoahAffiliation target_gen);\n","filename":"src\/hotspot\/share\/gc\/shenandoah\/shenandoahHeap.hpp","additions":12,"deletions":11,"binary":false,"changes":23,"status":"modified"},{"patch":"@@ -345,1 +345,1 @@\n-  ShenandoahRegionAffiliation target_gen = r->affiliation();\n+  ShenandoahAffiliation target_gen = r->affiliation();\n@@ -370,1 +370,1 @@\n-                                               ShenandoahRegionAffiliation target_gen) {\n+                                               ShenandoahAffiliation target_gen) {\n@@ -578,1 +578,1 @@\n-  case ShenandoahRegionAffiliation::FREE:\n+  case ShenandoahAffiliation::FREE:\n@@ -581,1 +581,1 @@\n-  case ShenandoahRegionAffiliation::YOUNG_GENERATION:\n+  case ShenandoahAffiliation::YOUNG_GENERATION:\n@@ -584,1 +584,1 @@\n-  case ShenandoahRegionAffiliation::OLD_GENERATION:\n+  case ShenandoahAffiliation::OLD_GENERATION:\n@@ -594,1 +594,1 @@\n-  return is_in(p) && (_affiliations[heap_region_index_containing(p)] == ShenandoahRegionAffiliation::YOUNG_GENERATION);\n+  return is_in(p) && (_affiliations[heap_region_index_containing(p)] == ShenandoahAffiliation::YOUNG_GENERATION);\n@@ -598,1 +598,1 @@\n-  return is_in(p) && (_affiliations[heap_region_index_containing(p)] == ShenandoahRegionAffiliation::OLD_GENERATION);\n+  return is_in(p) && (_affiliations[heap_region_index_containing(p)] == ShenandoahAffiliation::OLD_GENERATION);\n@@ -605,2 +605,2 @@\n-inline ShenandoahRegionAffiliation ShenandoahHeap::region_affiliation(const ShenandoahHeapRegion *r) {\n-  return (ShenandoahRegionAffiliation) _affiliations[r->index()];\n+inline ShenandoahAffiliation ShenandoahHeap::region_affiliation(const ShenandoahHeapRegion *r) {\n+  return (ShenandoahAffiliation) _affiliations[r->index()];\n@@ -609,2 +609,2 @@\n-inline void ShenandoahHeap::assert_lock_for_affiliation(ShenandoahRegionAffiliation orig_affiliation,\n-                                                        ShenandoahRegionAffiliation new_affiliation) {\n+inline void ShenandoahHeap::assert_lock_for_affiliation(ShenandoahAffiliation orig_affiliation,\n+                                                        ShenandoahAffiliation new_affiliation) {\n@@ -625,1 +625,1 @@\n-  if ((orig_affiliation == ShenandoahRegionAffiliation::FREE) || (new_affiliation == ShenandoahRegionAffiliation::FREE)) {\n+  if ((orig_affiliation == ShenandoahAffiliation::FREE) || (new_affiliation == ShenandoahAffiliation::FREE)) {\n@@ -631,1 +631,1 @@\n-inline void ShenandoahHeap::set_affiliation(ShenandoahHeapRegion* r, ShenandoahRegionAffiliation new_affiliation) {\n+inline void ShenandoahHeap::set_affiliation(ShenandoahHeapRegion* r, ShenandoahAffiliation new_affiliation) {\n@@ -638,2 +638,2 @@\n-inline ShenandoahRegionAffiliation ShenandoahHeap::region_affiliation(size_t index) {\n-  return (ShenandoahRegionAffiliation) _affiliations[index];\n+inline ShenandoahAffiliation ShenandoahHeap::region_affiliation(size_t index) {\n+  return (ShenandoahAffiliation) _affiliations[index];\n@@ -642,1 +642,1 @@\n-inline void ShenandoahHeap::set_affiliation(size_t index, ShenandoahRegionAffiliation new_affiliation) {\n+inline void ShenandoahHeap::set_affiliation(size_t index, ShenandoahAffiliation new_affiliation) {\n","filename":"src\/hotspot\/share\/gc\/shenandoah\/shenandoahHeap.inline.hpp","additions":16,"deletions":16,"binary":false,"changes":32,"status":"modified"},{"patch":"@@ -97,1 +97,1 @@\n-void ShenandoahHeapRegion::make_regular_allocation(ShenandoahRegionAffiliation affiliation) {\n+void ShenandoahHeapRegion::make_regular_allocation(ShenandoahAffiliation affiliation) {\n@@ -174,1 +174,1 @@\n-void ShenandoahHeapRegion::make_humongous_start_bypass(ShenandoahRegionAffiliation affiliation) {\n+void ShenandoahHeapRegion::make_humongous_start_bypass(ShenandoahAffiliation affiliation) {\n@@ -205,1 +205,1 @@\n-void ShenandoahHeapRegion::make_humongous_cont_bypass(ShenandoahRegionAffiliation affiliation) {\n+void ShenandoahHeapRegion::make_humongous_cont_bypass(ShenandoahAffiliation affiliation) {\n@@ -250,1 +250,1 @@\n-      assert(affiliation() != FREE, \"Pinned region should not be FREE\");\n+      assert(is_affiliated(), \"Pinned region should be affiliated\");\n@@ -412,13 +412,1 @@\n-  switch (ShenandoahHeap::heap()->region_affiliation(this)) {\n-    case ShenandoahRegionAffiliation::FREE:\n-      st->print(\"|F\");\n-      break;\n-    case ShenandoahRegionAffiliation::YOUNG_GENERATION:\n-      st->print(\"|Y\");\n-      break;\n-    case ShenandoahRegionAffiliation::OLD_GENERATION:\n-      st->print(\"|O\");\n-      break;\n-    default:\n-      ShouldNotReachHere();\n-  }\n+  st->print(\"|%s\", shenandoah_affiliation_code(affiliation()));\n@@ -937,1 +925,1 @@\n-void ShenandoahHeapRegion::set_affiliation(ShenandoahRegionAffiliation new_affiliation) {\n+void ShenandoahHeapRegion::set_affiliation(ShenandoahAffiliation new_affiliation) {\n@@ -940,1 +928,1 @@\n-  ShenandoahRegionAffiliation region_affiliation = heap->region_affiliation(this);\n+  ShenandoahAffiliation region_affiliation = heap->region_affiliation(this);\n@@ -945,1 +933,1 @@\n-                  index(), affiliation_name(region_affiliation), affiliation_name(new_affiliation),\n+                  index(), shenandoah_affiliation_name(region_affiliation), shenandoah_affiliation_name(new_affiliation),\n@@ -972,1 +960,1 @@\n-    index(), affiliation_name(region_affiliation), affiliation_name(new_affiliation));\n+    index(), shenandoah_affiliation_name(region_affiliation), shenandoah_affiliation_name(new_affiliation));\n@@ -974,1 +962,1 @@\n-  if (region_affiliation == ShenandoahRegionAffiliation::YOUNG_GENERATION) {\n+  if (region_affiliation == ShenandoahAffiliation::YOUNG_GENERATION) {\n@@ -976,1 +964,1 @@\n-  } else if (region_affiliation == ShenandoahRegionAffiliation::OLD_GENERATION) {\n+  } else if (region_affiliation == ShenandoahAffiliation::OLD_GENERATION) {\n","filename":"src\/hotspot\/share\/gc\/shenandoah\/shenandoahHeapRegion.cpp","additions":11,"deletions":23,"binary":false,"changes":34,"status":"modified"},{"patch":"@@ -30,0 +30,1 @@\n+#include \"gc\/shenandoah\/shenandoahAffiliation.hpp\"\n@@ -171,1 +172,1 @@\n-  void make_regular_allocation(ShenandoahRegionAffiliation affiliation);\n+  void make_regular_allocation(ShenandoahAffiliation affiliation);\n@@ -176,2 +177,2 @@\n-  void make_humongous_start_bypass(ShenandoahRegionAffiliation affiliation);\n-  void make_humongous_cont_bypass(ShenandoahRegionAffiliation affiliation);\n+  void make_humongous_start_bypass(ShenandoahAffiliation affiliation);\n+  void make_humongous_cont_bypass(ShenandoahAffiliation affiliation);\n@@ -204,0 +205,1 @@\n+  inline bool is_affiliated() const;\n@@ -447,1 +449,2 @@\n-  inline ShenandoahRegionAffiliation affiliation() const;\n+  inline ShenandoahAffiliation affiliation() const;\n+  inline const char* affiliation_name() const;\n@@ -449,1 +452,1 @@\n-  void set_affiliation(ShenandoahRegionAffiliation new_affiliation);\n+  void set_affiliation(ShenandoahAffiliation new_affiliation);\n","filename":"src\/hotspot\/share\/gc\/shenandoah\/shenandoahHeapRegion.hpp","additions":8,"deletions":5,"binary":false,"changes":13,"status":"modified"},{"patch":"@@ -162,1 +162,1 @@\n-         affiliation_name(affiliation()), index(), live_bytes, used_bytes, s * HeapWordSize);\n+         affiliation_name(), index(), live_bytes, used_bytes, s * HeapWordSize);\n@@ -209,1 +209,1 @@\n-inline ShenandoahRegionAffiliation ShenandoahHeapRegion::affiliation() const {\n+inline ShenandoahAffiliation ShenandoahHeapRegion::affiliation() const {\n@@ -213,0 +213,4 @@\n+inline const char* ShenandoahHeapRegion::affiliation_name() const {\n+  return shenandoah_affiliation_name(affiliation());\n+}\n+\n@@ -226,1 +230,1 @@\n-  return ShenandoahHeap::heap()->region_affiliation(this) == YOUNG_GENERATION;\n+  return affiliation() == YOUNG_GENERATION;\n@@ -230,1 +234,5 @@\n-  return ShenandoahHeap::heap()->region_affiliation(this) == OLD_GENERATION;\n+  return affiliation() == OLD_GENERATION;\n+}\n+\n+inline bool ShenandoahHeapRegion::is_affiliated() const {\n+  return affiliation() != FREE;\n","filename":"src\/hotspot\/share\/gc\/shenandoah\/shenandoahHeapRegion.inline.hpp","additions":12,"deletions":4,"binary":false,"changes":16,"status":"modified"},{"patch":"@@ -158,1 +158,1 @@\n-  switch (generation->generation_mode()) {\n+  switch (generation->type()) {\n","filename":"src\/hotspot\/share\/gc\/shenandoah\/shenandoahHeapRegionCounters.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -66,1 +66,1 @@\n-template <GenerationMode GENERATION, bool CANCELLABLE, StringDedupMode STRING_DEDUP>\n+template <ShenandoahGenerationType GENERATION, bool CANCELLABLE, StringDedupMode STRING_DEDUP>\n@@ -90,1 +90,1 @@\n-void ShenandoahMark::mark_loop(GenerationMode generation, uint worker_id, TaskTerminator* terminator, ShenandoahReferenceProcessor *rp, StringDedup::Requests* const req) {\n+void ShenandoahMark::mark_loop(ShenandoahGenerationType generation, uint worker_id, TaskTerminator* terminator, ShenandoahReferenceProcessor *rp, StringDedup::Requests* const req) {\n@@ -109,2 +109,2 @@\n-void ShenandoahMark::mark_loop(GenerationMode generation, uint worker_id, TaskTerminator* terminator, ShenandoahReferenceProcessor *rp,\n-               bool cancellable, StringDedupMode dedup_mode, StringDedup::Requests* const req) {\n+void ShenandoahMark::mark_loop(ShenandoahGenerationType generation, uint worker_id, TaskTerminator* terminator, ShenandoahReferenceProcessor *rp,\n+                               bool cancellable, StringDedupMode dedup_mode, StringDedup::Requests* const req) {\n@@ -138,1 +138,1 @@\n-template <class T, GenerationMode GENERATION, bool CANCELLABLE, StringDedupMode STRING_DEDUP>\n+template <class T, ShenandoahGenerationType GENERATION, bool CANCELLABLE, StringDedupMode STRING_DEDUP>\n@@ -147,1 +147,1 @@\n-  assert(heap->active_generation()->generation_mode() == GENERATION, \"Sanity\");\n+  assert(heap->active_generation()->type() == GENERATION, \"Sanity\");\n","filename":"src\/hotspot\/share\/gc\/shenandoah\/shenandoahMark.cpp","additions":6,"deletions":6,"binary":false,"changes":12,"status":"modified"},{"patch":"@@ -47,1 +47,1 @@\n-  template<class T, GenerationMode GENERATION>\n+  template<class T, ShenandoahGenerationType GENERATION>\n@@ -78,1 +78,1 @@\n-  template <class T, GenerationMode GENERATION, bool CANCELLABLE, StringDedupMode STRING_DEDUP>\n+  template <class T, ShenandoahGenerationType GENERATION, bool CANCELLABLE, StringDedupMode STRING_DEDUP>\n@@ -81,1 +81,1 @@\n-  template <GenerationMode GENERATION, bool CANCELLABLE, StringDedupMode STRING_DEDUP>\n+  template <ShenandoahGenerationType GENERATION, bool CANCELLABLE, StringDedupMode STRING_DEDUP>\n@@ -84,1 +84,1 @@\n-  template <GenerationMode GENERATION>\n+  template <ShenandoahGenerationType GENERATION>\n@@ -95,1 +95,1 @@\n-  void mark_loop(GenerationMode generation, uint worker_id, TaskTerminator* terminator, ShenandoahReferenceProcessor *rp,\n+  void mark_loop(ShenandoahGenerationType generation, uint worker_id, TaskTerminator* terminator, ShenandoahReferenceProcessor *rp,\n@@ -98,1 +98,1 @@\n-  void mark_loop(GenerationMode generation, uint worker_id, TaskTerminator* terminator, ShenandoahReferenceProcessor *rp,\n+  void mark_loop(ShenandoahGenerationType generation, uint worker_id, TaskTerminator* terminator, ShenandoahReferenceProcessor *rp,\n","filename":"src\/hotspot\/share\/gc\/shenandoah\/shenandoahMark.hpp","additions":6,"deletions":6,"binary":false,"changes":12,"status":"modified"},{"patch":"@@ -117,1 +117,1 @@\n-    assert(region->affiliation() != FREE, \"Do not count live data within Free Regular Region \" SIZE_FORMAT, region_idx);\n+    assert(region->is_affiliated(), \"Do not count live data within Free Regular Region \" SIZE_FORMAT, region_idx);\n@@ -132,1 +132,1 @@\n-    assert(region->affiliation() != FREE, \"Do not count live data within FREE Humongous Start Region \" SIZE_FORMAT, region_idx);\n+    assert(region->is_affiliated(), \"Do not count live data within FREE Humongous Start Region \" SIZE_FORMAT, region_idx);\n@@ -136,1 +136,1 @@\n-      assert(chain_reg->affiliation() != FREE, \"Do not count live data within FREE Humongous Continuation Region \" SIZE_FORMAT, i);\n+      assert(chain_reg->is_affiliated(), \"Do not count live data within FREE Humongous Continuation Region \" SIZE_FORMAT, i);\n@@ -239,1 +239,1 @@\n-template <GenerationMode GENERATION>\n+template <ShenandoahGenerationType GENERATION>\n@@ -264,1 +264,1 @@\n-template<GenerationMode GENERATION>\n+template<ShenandoahGenerationType GENERATION>\n@@ -277,1 +277,1 @@\n-template<class T, GenerationMode GENERATION>\n+template<class T, ShenandoahGenerationType GENERATION>\n","filename":"src\/hotspot\/share\/gc\/shenandoah\/shenandoahMark.inline.hpp","additions":6,"deletions":6,"binary":false,"changes":12,"status":"modified"},{"patch":"@@ -43,1 +43,1 @@\n-    if ((r->affiliation() != FREE) && heap->is_bitmap_slice_committed(r) && !is_bitmap_clear_range(r->bottom(), r->end())) {\n+    if (r->is_affiliated() && heap->is_bitmap_slice_committed(r) && !is_bitmap_clear_range(r->bottom(), r->end())) {\n@@ -85,1 +85,1 @@\n-                affiliation_name(r->affiliation()), r->index(), p2i(top_bitmap));\n+                r->affiliation_name(), r->index(), p2i(top_bitmap));\n@@ -87,1 +87,1 @@\n-  if (r->affiliation() != FREE) {\n+  if (r->is_affiliated()) {\n","filename":"src\/hotspot\/share\/gc\/shenandoah\/shenandoahMarkingContext.cpp","additions":3,"deletions":3,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -77,1 +77,1 @@\n-  if (r->affiliation() != FREE) {\n+  if (r->is_affiliated()) {\n@@ -93,1 +93,1 @@\n-                  affiliation_name(r->affiliation()), idx, (unsigned long long) old_tams, (unsigned long long) new_tams);\n+                  r->affiliation_name(), idx, (unsigned long long) old_tams, (unsigned long long) new_tams);\n@@ -97,1 +97,1 @@\n-                    affiliation_name(r->affiliation()), idx);\n+                    r->affiliation_name(), idx);\n","filename":"src\/hotspot\/share\/gc\/shenandoah\/shenandoahMarkingContext.inline.hpp","additions":3,"deletions":3,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -262,1 +262,1 @@\n-  if (from->generation_mode() == YOUNG) {\n+  if (from->is_young()) {\n@@ -282,1 +282,1 @@\n-  assert(from->generation_mode() == YOUNG, \"Expect to transfer from young\");\n+  assert(from->is_young(), \"Expect to transfer from young\");\n@@ -297,1 +297,1 @@\n-  assert(to->generation_mode() == YOUNG, \"Can only transfer between young and old.\");\n+  assert(to->is_young(), \"Can only transfer between young and old.\");\n","filename":"src\/hotspot\/share\/gc\/shenandoah\/shenandoahMmuTracker.cpp","additions":3,"deletions":3,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -57,1 +57,1 @@\n-    assert(_mark.generation()->generation_mode() == OLD, \"Generation of Old-Gen GC should be OLD\");\n+    assert(_mark.generation()->is_old(), \"Generation of Old-Gen GC should be OLD\");\n","filename":"src\/hotspot\/share\/gc\/shenandoah\/shenandoahOldGC.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -184,1 +184,2 @@\n-  return region->affiliation() != YOUNG_GENERATION;\n+  \/\/ TODO: Should this be region->is_old() instead?\n+  return !region->is_young();\n","filename":"src\/hotspot\/share\/gc\/shenandoah\/shenandoahOldGeneration.cpp","additions":2,"deletions":1,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -50,1 +50,1 @@\n-  template <class T, GenerationMode GENERATION>\n+  template <class T, ShenandoahGenerationType GENERATION>\n@@ -74,1 +74,1 @@\n-  template <class T, GenerationMode GENERATION>\n+  template <class T, ShenandoahGenerationType GENERATION>\n@@ -85,1 +85,1 @@\n-template <GenerationMode GENERATION>\n+template <ShenandoahGenerationType GENERATION>\n@@ -99,1 +99,1 @@\n-template <GenerationMode GENERATION>\n+template <ShenandoahGenerationType GENERATION>\n","filename":"src\/hotspot\/share\/gc\/shenandoah\/shenandoahOopClosures.hpp","additions":4,"deletions":4,"binary":false,"changes":8,"status":"modified"},{"patch":"@@ -33,1 +33,1 @@\n-template<class T, GenerationMode GENERATION>\n+template<class T, ShenandoahGenerationType GENERATION>\n@@ -38,1 +38,1 @@\n-template<class T, GenerationMode GENERATION>\n+template<class T, ShenandoahGenerationType GENERATION>\n","filename":"src\/hotspot\/share\/gc\/shenandoah\/shenandoahOopClosures.inline.hpp","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -29,1 +29,0 @@\n-#include \"gc\/shenandoah\/mode\/shenandoahGenerationalMode.hpp\"\n@@ -390,1 +389,1 @@\n-          p2i(reference), reference_type_name(type), affiliation_name(reference));\n+          p2i(reference), reference_type_name(type), ShenandoahHeap::heap()->heap_region_containing(reference)->affiliation_name());\n","filename":"src\/hotspot\/share\/gc\/shenandoah\/shenandoahReferenceProcessor.cpp","additions":1,"deletions":2,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -40,1 +40,1 @@\n-template<GenerationMode GENERATION>\n+template<ShenandoahGenerationType GENERATION>\n@@ -56,1 +56,1 @@\n-template<GenerationMode GENERATION>\n+template<ShenandoahGenerationType GENERATION>\n@@ -62,1 +62,1 @@\n-template <GenerationMode GENERATION>\n+template <ShenandoahGenerationType GENERATION>\n@@ -119,1 +119,1 @@\n-    if (_generation->generation_mode() == YOUNG) {\n+    if (_generation->is_young()) {\n@@ -140,1 +140,1 @@\n-  switch (_generation->generation_mode()) {\n+  switch (_generation->type()) {\n@@ -162,1 +162,1 @@\n-  mark_loop(_generation->generation_mode(),\n+  mark_loop(_generation->type(),\n","filename":"src\/hotspot\/share\/gc\/shenandoah\/shenandoahSTWMark.cpp","additions":6,"deletions":6,"binary":false,"changes":12,"status":"modified"},{"patch":"@@ -88,1 +88,1 @@\n-    if (region->affiliation() == OLD_GENERATION) {\n+    if (region->is_old()) {\n","filename":"src\/hotspot\/share\/gc\/shenandoah\/shenandoahScanRemembered.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -38,0 +38,1 @@\n+#include \"gc\/shenandoah\/mode\/shenandoahMode.hpp\"\n","filename":"src\/hotspot\/share\/gc\/shenandoah\/shenandoahScanRemembered.inline.hpp","additions":1,"deletions":0,"binary":false,"changes":1,"status":"modified"},{"patch":"@@ -58,1 +58,1 @@\n-  return region->affiliation() != OLD_GENERATION;\n+  return !region->is_old();\n","filename":"src\/hotspot\/share\/gc\/shenandoah\/shenandoahYoungGeneration.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"}]}