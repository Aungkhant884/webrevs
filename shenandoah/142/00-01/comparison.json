{"files":[{"patch":"@@ -837,2 +837,2 @@\n-      \/\/ If generational, leave affiliation alone.\n-      r->make_regular_bypass(!is_generational);\n+      \/\/ Leave afffiliation unchanged.\n+      r->make_regular_bypass();\n@@ -1272,1 +1272,5 @@\n-      r->make_regular_bypass(!is_generational);\n+      if (!is_generational) {\n+        r->make_young_maybe();\n+      }\n+      \/\/ else, generational mode compaction has already established affiliation.\n+      r->make_regular_bypass();\n@@ -1346,2 +1350,2 @@\n-          \/\/ Consider regions emptied by humongous evacuation to be young\n-          r->make_regular_bypass(true);\n+          \/\/ Leave humongous region affiliation unchanged.\n+          r->make_regular_bypass();\n","filename":"src\/hotspot\/share\/gc\/shenandoah\/shenandoahFullGC.cpp","additions":9,"deletions":5,"binary":false,"changes":14,"status":"modified"},{"patch":"@@ -113,1 +113,21 @@\n-void ShenandoahHeapRegion::make_regular_bypass(bool make_young_affiliation) {\n+\/\/ Change affiliation to YOUNG_GENERATION if _state is not _pinned_cset, _regular, or _pinned.  This implements\n+\/\/ behavior previously performed as a side effect of make_regular_bypass().\n+void ShenandoahHeapRegion::make_young_maybe() {\n+ switch (_state) {\n+   case _empty_uncommitted:\n+   case _empty_committed:\n+   case _cset:\n+   case _humongous_start:\n+   case _humongous_cont:\n+     set_affiliation(YOUNG_GENERATION);\n+     return;\n+   case _pinned_cset:\n+   case _regular:\n+   case _pinned:\n+     return;\n+   default:\n+     assert(false, \"Unexpected _state in make_young_maybe\");\n+  }\n+}\n+\n+void ShenandoahHeapRegion::make_regular_bypass() {\n@@ -125,3 +145,0 @@\n-      if (make_young_affiliation) {\n-        set_affiliation(YOUNG_GENERATION);\n-      }\n","filename":"src\/hotspot\/share\/gc\/shenandoah\/shenandoahHeapRegion.cpp","additions":21,"deletions":4,"binary":false,"changes":25,"status":"modified"},{"patch":"@@ -172,1 +172,2 @@\n-  void make_regular_bypass(bool make_young_affiliation);\n+  void make_young_maybe();\n+  void make_regular_bypass();\n","filename":"src\/hotspot\/share\/gc\/shenandoah\/shenandoahHeapRegion.hpp","additions":2,"deletions":1,"binary":false,"changes":3,"status":"modified"}]}