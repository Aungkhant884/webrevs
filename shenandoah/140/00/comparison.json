{"files":[{"patch":"@@ -48,1 +48,16 @@\n-    return !_heap->requires_marking(entry);\n+    if (!_heap->requires_marking(entry)) {\n+      \/\/ The object is already marked, don't need to mark it again\n+      return true;\n+    }\n+\n+    if (_heap->mode()->is_generational() && _heap->is_concurrent_old_mark_in_progress()) {\n+      \/\/ The SATB barrier is left on during concurrent marking of the old generation.\n+      \/\/ It is possible for the barrier to record an address of a reachable object\n+      \/\/ which exists in the collection set of a young generation collection. Once the\n+      \/\/ object is evacuated, the address left in the SATB buffer is no longer valid (or safe).\n+      ShenandoahHeapRegion* region = _heap->heap_region_containing(entry);\n+      return !region->is_active() || region->is_cset();\n+    }\n+\n+    \/\/ Keep this object in the SATB buffer.\n+    return false;\n","filename":"src\/hotspot\/share\/gc\/shenandoah\/shenandoahSATBMarkQueueSet.cpp","additions":16,"deletions":1,"binary":false,"changes":17,"status":"modified"}]}