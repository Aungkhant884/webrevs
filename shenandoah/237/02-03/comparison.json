{"files":[{"patch":"@@ -457,0 +457,1 @@\n+    ShenandoahHeapRegion* r = _heap->heap_region_containing(array_addr);\n@@ -460,1 +461,0 @@\n-      ShenandoahHeapRegion* r = _heap->heap_region_containing(array_addr);\n@@ -466,2 +466,1 @@\n-      ShenandoahHeapRegion* r = _heap->heap_region_containing(array);\n-      if (r->is_old() || !_heap->marking_context()->allocated_after_mark_start(array_addr)) {\n+      if (r->is_old() || (array_addr < _heap->marking_context()->top_at_mark_start(r))) {\n@@ -470,1 +469,1 @@\n-    } else if (!_heap->marking_context()->allocated_after_mark_start(array_addr)) {\n+    } else if (array_addr < _heap->marking_context()->top_at_mark_start(r)) {\n@@ -475,0 +474,1 @@\n+    \/\/ Incremental Update mode, marking\n@@ -476,1 +476,3 @@\n-    if (!_heap->marking_context()->allocated_after_mark_start(reinterpret_cast<HeapWord*>(array))) {\n+    HeapWord* array_addr = reinterpret_cast<HeapWord*>(array);\n+    ShenandoahHeapRegion* r = _heap->heap_region_containing(array_addr);\n+    if (array_addr < _heap->marking_context()->top_at_mark_start(r)) {\n","filename":"src\/hotspot\/share\/gc\/shenandoah\/shenandoahBarrierSet.inline.hpp","additions":7,"deletions":5,"binary":false,"changes":12,"status":"modified"}]}