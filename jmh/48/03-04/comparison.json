{"files":[{"patch":"@@ -49,2 +49,8 @@\n-    static final String BLACKHOLE_MODE_PROP_NAME = \"jmh.blackhole.mode\";\n-    static final String BLACKHOLE_MODE_AUTODETECT_NAME = \"jmh.blackhole.autoDetect\";\n+    static final String BLACKHOLE_MODE_NAME       = \"jmh.blackhole.mode\";\n+    static final String BLACKHOLE_AUTODETECT_NAME = \"jmh.blackhole.autoDetect\";\n+    static final String BLACKHOLE_DEBUG_NAME      = \"jmh.blackhole.debug\";\n+\n+    static final boolean BLACKHOLE_MODE_AUTODETECT =\n+            Boolean.parseBoolean(System.getProperty(BLACKHOLE_AUTODETECT_NAME, \"true\"));\n+    static final boolean BLACKHOLE_MODE_DEBUG =\n+            Boolean.parseBoolean(System.getProperty(BLACKHOLE_DEBUG_NAME, \"false\"));\n@@ -242,1 +248,1 @@\n-    private static BlackholeDetectMode blackholeDetectMode;\n+    private static BlackholeSelect blackholeSelect;\n@@ -250,1 +256,1 @@\n-        String propMode = System.getProperty(BLACKHOLE_MODE_PROP_NAME);\n+        String propMode = System.getProperty(BLACKHOLE_MODE_NAME);\n@@ -254,1 +260,1 @@\n-                blackholeDetectMode = BlackholeDetectMode.FORCED;\n+                blackholeSelect = BlackholeSelect.FORCED;\n@@ -269,2 +275,1 @@\n-        String autoDetectProp = System.getProperty(BLACKHOLE_MODE_AUTODETECT_NAME, \"true\");\n-        if (Boolean.parseBoolean(autoDetectProp)) {\n+        if (BLACKHOLE_MODE_AUTODETECT) {\n@@ -273,1 +278,1 @@\n-                blackholeDetectMode = BlackholeDetectMode.AUTO;\n+                blackholeSelect = BlackholeSelect.AUTO;\n@@ -280,1 +285,1 @@\n-        blackholeDetectMode = BlackholeDetectMode.FALLBACK;\n+        blackholeSelect = BlackholeSelect.FALLBACK;\n@@ -284,1 +289,1 @@\n-    private static BlackholeDetectMode blackholeDetectMode() {\n+    private static BlackholeSelect blackholeSelect() {\n@@ -286,1 +291,1 @@\n-        return blackholeDetectMode;\n+        return blackholeSelect;\n@@ -291,1 +296,1 @@\n-        out.print(\"# Blackhole mode: \" + mode.desc() + \" (\" + blackholeDetectMode().desc() + \")\");\n+        out.print(\"# Blackhole mode: \" + mode.desc() + \" (\" + blackholeSelect().desc() + \")\");\n@@ -322,3 +327,3 @@\n-    private enum BlackholeDetectMode {\n-        FALLBACK(\"fallback, use -D\" + BLACKHOLE_MODE_PROP_NAME + \" to force another mode\"),\n-        AUTO(\"auto-detected, use -D\" + BLACKHOLE_MODE_AUTODETECT_NAME + \"=false to disable\"),\n+    private enum BlackholeSelect {\n+        FALLBACK(\"fallback, use -D\" + BLACKHOLE_MODE_NAME + \" to force another mode\"),\n+        AUTO(\"auto-detected, use -D\" + BLACKHOLE_AUTODETECT_NAME + \"=false to disable\"),\n@@ -330,1 +335,1 @@\n-        BlackholeDetectMode(String desc) {\n+        BlackholeSelect(String desc) {\n@@ -349,0 +354,2 @@\n+            debug(\"Blackhole command errors test:\");\n+\n@@ -351,2 +358,5 @@\n-                if (l.contains(\"CompilerOracle\")) return false;\n-                if (l.contains(\"CompileCommand\")) return false;\n+                debug(l);\n+                if (l.contains(\"CompilerOracle\") || l.contains(\"CompileCommand\")) {\n+                    debug(\"Found the suspected error line, no compiler blackholes.\");\n+                    return false;\n+                }\n@@ -364,0 +374,2 @@\n+            debug(\"Blackhole command acceptance test:\");\n+\n@@ -366,2 +378,5 @@\n-                if (l.contains(\"CompilerOracle\")) return true;\n-                if (l.contains(\"CompileCommand\")) return true;\n+                debug(l);\n+                if (l.contains(\"CompilerOracle\") || l.contains(\"CompileCommand\")) {\n+                    debug(\"Found the acceptance line, compiler blackholes are available.\");\n+                    return true;\n+                }\n@@ -372,0 +387,1 @@\n+        debug(\"Compiler blackholes are not available.\");\n@@ -375,0 +391,6 @@\n+    private static void debug(String msg) {\n+        if (BLACKHOLE_MODE_DEBUG) {\n+            System.out.println(msg);\n+        }\n+    }\n+\n","filename":"jmh-core\/src\/main\/java\/org\/openjdk\/jmh\/runner\/CompilerHints.java","additions":42,"deletions":20,"binary":false,"changes":62,"status":"modified"}]}