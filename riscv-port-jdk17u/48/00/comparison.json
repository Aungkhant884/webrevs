{"files":[{"patch":"@@ -3485,1 +3485,1 @@\n-Address MacroAssembler::add_memory_helper(const Address dst) {\n+Address MacroAssembler::add_memory_helper(const Address dst, Register tmp) {\n@@ -3490,1 +3490,1 @@\n-      return form_address(t1, dst.base(), dst.offset());\n+      return form_address(tmp, dst.base(), dst.offset());\n@@ -3492,2 +3492,2 @@\n-      la(t1, dst);\n-      return Address(t1);\n+      la(tmp, dst);\n+      return Address(tmp);\n@@ -3497,1 +3497,1 @@\n-void MacroAssembler::increment(const Address dst, int64_t value) {\n+void MacroAssembler::increment(const Address dst, int64_t value, Register tmp1, Register tmp2) {\n@@ -3501,5 +3501,5 @@\n-  Address adr = add_memory_helper(dst);\n-  assert(!adr.uses(t0), \"invalid dst for address increment\");\n-  ld(t0, adr);\n-  add(t0, t0, value, t1);\n-  sd(t0, adr);\n+  Address adr = add_memory_helper(dst, tmp2);\n+  assert(!adr.uses(tmp1), \"invalid dst for address increment\");\n+  ld(tmp1, adr);\n+  add(tmp1, tmp1, value, tmp2);\n+  sd(tmp1, adr);\n@@ -3508,1 +3508,1 @@\n-void MacroAssembler::incrementw(const Address dst, int32_t value) {\n+void MacroAssembler::incrementw(const Address dst, int32_t value, Register tmp1, Register tmp2) {\n@@ -3512,5 +3512,5 @@\n-  Address adr = add_memory_helper(dst);\n-  assert(!adr.uses(t0), \"invalid dst for address increment\");\n-  lwu(t0, adr);\n-  addw(t0, t0, value, t1);\n-  sw(t0, adr);\n+  Address adr = add_memory_helper(dst, tmp2);\n+  assert(!adr.uses(tmp1), \"invalid dst for address increment\");\n+  lwu(tmp1, adr);\n+  addw(tmp1, tmp1, value, tmp2);\n+  sw(tmp1, adr);\n@@ -3519,1 +3519,1 @@\n-void MacroAssembler::decrement(const Address dst, int64_t value) {\n+void MacroAssembler::decrement(const Address dst, int64_t value, Register tmp1, Register tmp2) {\n@@ -3523,5 +3523,5 @@\n-  Address adr = add_memory_helper(dst);\n-  assert(!adr.uses(t0), \"invalid dst for address decrement\");\n-  ld(t0, adr);\n-  sub(t0, t0, value, t1);\n-  sd(t0, adr);\n+  Address adr = add_memory_helper(dst, tmp2);\n+  assert(!adr.uses(tmp1), \"invalid dst for address decrement\");\n+  ld(tmp1, adr);\n+  sub(tmp1, tmp1, value, tmp2);\n+  sd(tmp1, adr);\n@@ -3530,1 +3530,1 @@\n-void MacroAssembler::decrementw(const Address dst, int32_t value) {\n+void MacroAssembler::decrementw(const Address dst, int32_t value, Register tmp1, Register tmp2) {\n@@ -3534,5 +3534,5 @@\n-  Address adr = add_memory_helper(dst);\n-  assert(!adr.uses(t0), \"invalid dst for address decrement\");\n-  lwu(t0, adr);\n-  subw(t0, t0, value, t1);\n-  sw(t0, adr);\n+  Address adr = add_memory_helper(dst, tmp2);\n+  assert(!adr.uses(tmp1), \"invalid dst for address decrement\");\n+  lwu(tmp1, adr);\n+  subw(tmp1, tmp1, value, tmp2);\n+  sw(tmp1, adr);\n","filename":"src\/hotspot\/cpu\/riscv\/macroAssembler_riscv.cpp","additions":28,"deletions":28,"binary":false,"changes":56,"status":"modified"},{"patch":"@@ -987,2 +987,2 @@\n-  void increment(const Address dst, int64_t value = 1);\n-  void incrementw(const Address dst, int32_t value = 1);\n+  void increment(const Address dst, int64_t value = 1, Register tmp1 = t0, Register tmp2 = t1);\n+  void incrementw(const Address dst, int32_t value = 1, Register tmp1 = t0, Register tmp2 = t1);\n@@ -990,2 +990,2 @@\n-  void decrement(const Address dst, int64_t value = 1);\n-  void decrementw(const Address dst, int32_t value = 1);\n+  void decrement(const Address dst, int64_t value = 1, Register tmp1 = t0, Register tmp2 = t1);\n+  void decrementw(const Address dst, int32_t value = 1, Register tmp1 = t0, Register tmp2 = t1);\n@@ -1187,1 +1187,1 @@\n-  Address add_memory_helper(const Address dst);\n+  Address add_memory_helper(const Address dst, Register tmp);\n","filename":"src\/hotspot\/cpu\/riscv\/macroAssembler_riscv.hpp","additions":5,"deletions":5,"binary":false,"changes":10,"status":"modified"},{"patch":"@@ -2391,3 +2391,1 @@\n-    __ ld(tmp, Address(disp_hdr, ObjectMonitor::recursions_offset_in_bytes() - markWord::monitor_value));\n-    __ add(tmp, tmp, 1u);\n-    __ sd(tmp, Address(disp_hdr, ObjectMonitor::recursions_offset_in_bytes() - markWord::monitor_value));\n+    __ increment(Address(disp_hdr, ObjectMonitor::recursions_offset_in_bytes() - markWord::monitor_value), 1, t0, tmp);\n","filename":"src\/hotspot\/cpu\/riscv\/riscv.ad","additions":1,"deletions":3,"binary":false,"changes":4,"status":"modified"}]}