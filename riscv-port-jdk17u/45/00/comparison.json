{"files":[{"patch":"@@ -264,1 +264,1 @@\n-    __ push_vp(_vp_regs, sp);\n+    __ push_v(_vp_regs, sp);\n@@ -269,1 +269,1 @@\n-    __ pop_vp(_vp_regs, sp);\n+    __ pop_v(_vp_regs, sp);\n","filename":"src\/hotspot\/cpu\/riscv\/gc\/z\/zBarrierSetAssembler_riscv.cpp","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -929,1 +929,1 @@\n-  push_reg(0xc00, sp); \/\/ save x10, x11\n+  push_reg(RegSet::of(x10, x11), sp); \/\/ save x10, x11\n@@ -942,1 +942,1 @@\n-  pop_reg(0xc00, sp);\n+  pop_reg(RegSet::of(x10, x11), sp);\n","filename":"src\/hotspot\/cpu\/riscv\/interp_masm_riscv.cpp","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -1207,1 +1207,1 @@\n-\/\/ Push lots of registers in the bit set supplied.  Don't push sp.\n+\/\/ Push integer registers in the bitset supplied. Don't push sp.\n@@ -1217,1 +1217,1 @@\n-    addi(stack, stack, - count * wordSize - offset);\n+    addi(stack, stack, -count * wordSize - offset);\n@@ -1221,1 +1221,1 @@\n-    DEBUG_ONLY(words_pushed ++;)\n+    DEBUG_ONLY(words_pushed++;)\n@@ -1238,1 +1238,1 @@\n-    DEBUG_ONLY(words_popped ++;)\n+    DEBUG_ONLY(words_popped++;)\n@@ -1249,2 +1249,2 @@\n-\/\/ Push float registers in the bitset, except sp.\n-\/\/ Return the number of heapwords pushed.\n+\/\/ Push floating-point registers in the bitset supplied.\n+\/\/ Return the number of words pushed\n@@ -1252,1 +1252,1 @@\n-  int words_pushed = 0;\n+  DEBUG_ONLY(int words_pushed = 0;)\n@@ -1263,1 +1263,1 @@\n-    words_pushed++;\n+    DEBUG_ONLY(words_pushed++;)\n@@ -1267,0 +1267,1 @@\n+\n@@ -1271,1 +1272,1 @@\n-  int words_popped = 0;\n+  DEBUG_ONLY(int words_popped = 0;)\n@@ -1278,1 +1279,1 @@\n-    words_popped++;\n+    DEBUG_ONLY(words_popped++;)\n@@ -1286,0 +1287,1 @@\n+\n@@ -1290,1 +1292,3 @@\n-int MacroAssembler::push_vp(unsigned int bitset, Register stack) {\n+\/\/ Push vector registers in the bitset supplied.\n+\/\/ Return the number of words pushed\n+int MacroAssembler::push_v(unsigned int bitset, Register stack) {\n@@ -1295,7 +1299,1 @@\n-  int count = 0;\n-  for (int reg = 31; reg >= 0; reg--) {\n-    if ((1U << 31) & bitset) {\n-      regs[count++] = reg;\n-    }\n-    bitset <<= 1;\n-  }\n+  int count = bitset_to_regs(bitset, regs);\n@@ -1311,1 +1309,1 @@\n-int MacroAssembler::pop_vp(unsigned int bitset, Register stack) {\n+int MacroAssembler::pop_v(unsigned int bitset, Register stack) {\n@@ -1316,7 +1314,1 @@\n-  int count = 0;\n-  for (int reg = 31; reg >= 0; reg--) {\n-    if ((1U << 31) & bitset) {\n-      regs[count++] = reg;\n-    }\n-    bitset <<= 1;\n-  }\n+  int count = bitset_to_regs(bitset, regs);\n@@ -1342,1 +1334,1 @@\n-      fsd(as_FloatRegister(i), Address(sp, wordSize * (offset ++)));\n+      fsd(as_FloatRegister(i), Address(sp, wordSize * (offset++)));\n@@ -1351,1 +1343,1 @@\n-      fld(as_FloatRegister(i), Address(sp, wordSize * (offset ++)));\n+      fld(as_FloatRegister(i), Address(sp, wordSize * (offset++)));\n@@ -1361,1 +1353,1 @@\n-  push_reg(0xffffffe0, sp);\n+  push_reg(RegSet::range(x5, x31), sp);\n@@ -1397,1 +1389,1 @@\n-  pop_reg(0xffffffe0, sp);\n+  pop_reg(RegSet::range(x5, x31), sp);\n","filename":"src\/hotspot\/cpu\/riscv\/macroAssembler_riscv.cpp","additions":22,"deletions":30,"binary":false,"changes":52,"status":"modified"},{"patch":"@@ -530,2 +530,11 @@\n-  void push_reg(RegSet regs, Register stack) { if (regs.bits()) { push_reg(regs.bits(), stack); } }\n-  void pop_reg(RegSet regs, Register stack) { if (regs.bits()) { pop_reg(regs.bits(), stack); } }\n+private:\n+  int push_reg(unsigned int bitset, Register stack);\n+  int pop_reg(unsigned int bitset, Register stack);\n+  int push_fp(unsigned int bitset, Register stack);\n+  int pop_fp(unsigned int bitset, Register stack);\n+#ifdef COMPILER2\n+  int push_v(unsigned int bitset, Register stack);\n+  int pop_v(unsigned int bitset, Register stack);\n+#endif \/\/ COMPILER2\n+\n+public:\n@@ -534,2 +543,2 @@\n-  int  push_reg(unsigned int bitset, Register stack);\n-  int  pop_reg(unsigned int bitset, Register stack);\n+  void push_reg(RegSet regs, Register stack) { if (regs.bits()) push_reg(regs.bits(), stack); }\n+  void pop_reg(RegSet regs, Register stack)  { if (regs.bits()) pop_reg(regs.bits(), stack); }\n@@ -537,1 +546,1 @@\n-  void pop_fp(FloatRegSet regs, Register stack) { if (regs.bits()) pop_fp(regs.bits(), stack); }\n+  void pop_fp(FloatRegSet regs, Register stack)  { if (regs.bits()) pop_fp(regs.bits(), stack); }\n@@ -539,2 +548,2 @@\n-  void push_vp(VectorRegSet regs, Register stack) { if (regs.bits()) push_vp(regs.bits(), stack); }\n-  void pop_vp(VectorRegSet regs, Register stack) { if (regs.bits()) pop_vp(regs.bits(), stack); }\n+  void push_v(VectorRegSet regs, Register stack) { if (regs.bits()) push_v(regs.bits(), stack); }\n+  void pop_v(VectorRegSet regs, Register stack)  { if (regs.bits()) pop_v(regs.bits(), stack); }\n@@ -1124,6 +1133,0 @@\n-  int push_fp(unsigned int bitset, Register stack);\n-  int pop_fp(unsigned int bitset, Register stack);\n-\n-  int push_vp(unsigned int bitset, Register stack);\n-  int pop_vp(unsigned int bitset, Register stack);\n-\n","filename":"src\/hotspot\/cpu\/riscv\/macroAssembler_riscv.hpp","additions":16,"deletions":13,"binary":false,"changes":29,"status":"modified"},{"patch":"@@ -602,1 +602,1 @@\n-    __ push_reg(0x3000, sp);   \/\/ save c_rarg2 and c_rarg3\n+    __ push_reg(RegSet::of(c_rarg2, c_rarg3), sp); \/\/ save c_rarg2 and c_rarg3\n@@ -638,1 +638,1 @@\n-    __ pop_reg(0x3000, sp);   \/\/ pop c_rarg2 and c_rarg3\n+    __ pop_reg(RegSet::of(c_rarg2, c_rarg3), sp);  \/\/ pop c_rarg2 and c_rarg3\n@@ -643,1 +643,1 @@\n-    __ pop_reg(0x3000, sp);   \/\/ pop c_rarg2 and c_rarg3\n+    __ pop_reg(RegSet::of(c_rarg2, c_rarg3), sp); \/\/ pop c_rarg2 and c_rarg3\n","filename":"src\/hotspot\/cpu\/riscv\/stubGenerator_riscv.cpp","additions":3,"deletions":3,"binary":false,"changes":6,"status":"modified"}]}