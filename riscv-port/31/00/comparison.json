{"files":[{"patch":"@@ -240,1 +240,1 @@\n-  reg_save_frame_size = 32 \/* float *\/ + 32 \/* integer *\/\n+  reg_save_frame_size = 32 \/* float *\/ + 30 \/* integer excluding x3, x4 *\/\n@@ -265,1 +265,1 @@\n-                                                                                        x28,  x29, x30, x31};\n+                                                                                        x28, x29, x30, x31};\n@@ -290,1 +290,1 @@\n-  __ push_reg(RegSet::range(x3, x31), sp);    \/\/ integer registers except ra(x1) & sp(x2)\n+  __ push_reg(RegSet::range(x5, x31), sp);    \/\/ integer registers except ra(x1) & sp(x2) & gp(x3) & tp(x4)\n@@ -299,1 +299,1 @@\n-    \/\/ we define reg_save_layout = 64 as the fixed frame size,\n+    \/\/ we define reg_save_layout = 62 as the fixed frame size,\n@@ -320,1 +320,1 @@\n-  __ pop_reg(RegSet::range(x3, x31), sp);   \/\/ integer registers except ra(x1) & sp(x2)\n+  __ pop_reg(RegSet::range(x5, x31), sp);   \/\/ integer registers except ra(x1) & sp(x2) & gp(x3) & tp(x4)\n@@ -336,2 +336,2 @@\n-  \/\/ integer registers except ra(x1) & sp(x2) & x10\n-  __ pop_reg(RegSet::range(x3, x9), sp);   \/\/ pop zr, x3 ~ x9\n+  \/\/ integer registers except ra(x1) & sp(x2) & gp(x3) & tp(x4) & x10\n+  __ pop_reg(RegSet::range(x5, x9), sp);   \/\/ pop zr, x5 ~ x9\n@@ -352,1 +352,1 @@\n-  \/\/ we save x0, x3 ~ x31, except x1, x2\n+  \/\/ we save x0, x5 ~ x31, except x1, x2, x3, x4\n@@ -355,2 +355,2 @@\n-  \/\/ 3: loop starts from x3\n-  for (i = 3; i < FrameMap::nof_cpu_regs; i++) {\n+  \/\/ 3: loop starts from x5\n+  for (i = 5; i < FrameMap::nof_cpu_regs; i++) {\n","filename":"src\/hotspot\/cpu\/riscv\/c1_Runtime1_riscv.cpp","additions":10,"deletions":10,"binary":false,"changes":20,"status":"modified"},{"patch":"@@ -1121,1 +1121,1 @@\n-\/\/ Push all the integer registers, except zr(x0) & sp(x2).\n+\/\/ Push all the integer registers, except zr(x0) & sp(x2) & gp(x3) & tp(x4).\n@@ -1123,1 +1123,1 @@\n-  push_reg(0xfffffffa, sp);\n+  push_reg(0xffffffe2, sp);\n@@ -1126,0 +1126,1 @@\n+\/\/ Pop all the integer registers, except zr(x0) & sp(x2) & gp(x3) & tp(x4).\n@@ -1127,1 +1128,1 @@\n-  pop_reg(0xfffffffa, sp);\n+  pop_reg(0xffffffe2, sp);\n@@ -1131,2 +1132,2 @@\n-  \/\/ integer registers, except zr(x0) & ra(x1) & sp(x2)\n-  push_reg(0xfffffff8, sp);\n+  \/\/ integer registers, except zr(x0) & ra(x1) & sp(x2) & gp(x3) & tp(x4)\n+  push_reg(0xffffffe0, sp);\n@@ -1167,2 +1168,2 @@\n-  \/\/ integer registers, except zr(x0) & ra(x1) & sp(x2)\n-  pop_reg(0xfffffff8, sp);\n+  \/\/ integer registers, except zr(x0) & ra(x1) & sp(x2) & gp(x3) & tp(x4)\n+  pop_reg(0xffffffe0, sp);\n","filename":"src\/hotspot\/cpu\/riscv\/macroAssembler_riscv.cpp","additions":8,"deletions":7,"binary":false,"changes":15,"status":"modified"},{"patch":"@@ -93,1 +93,1 @@\n-  \/\/ gregs:30, float_register:32; except: x1(ra) & x2(sp)\n+  \/\/ gregs:28, float_register:32; except: x1(ra) & x2(sp) & gp(x3) & tp(x4)\n@@ -103,2 +103,2 @@\n-  \/\/ |---x3---|\n-  \/\/ |   x4   |\n+  \/\/ |---x5---|\n+  \/\/ |   x6   |\n@@ -128,2 +128,2 @@\n-    assert (r->encoding() > 2, \"ra and sp not saved\");\n-    return x0_offset_in_bytes() + (r->encoding() - 2 \/* x1, x2*\/) * wordSize;\n+    assert (r->encoding() > 4, \"ra, sp, gp and tp not saved\");\n+    return x0_offset_in_bytes() + (r->encoding() - 4 \/* x1, x2, x3, x4 *\/) * wordSize;\n@@ -138,1 +138,1 @@\n-           (RegisterImpl::number_of_registers - 1) *\n+           (RegisterImpl::number_of_registers - 3) *\n@@ -193,1 +193,1 @@\n-  \/\/ ignore zr, ra and sp, being ignored also by push_CPU_state (pushing zr only for stack alignment)\n+  \/\/ ignore zr, ra, sp, gp and tp, being ignored also by push_CPU_state (pushing zr only for stack alignment)\n@@ -196,1 +196,1 @@\n-  for (int i = 3; i < RegisterImpl::number_of_registers; i++, sp_offset_in_slots += step_in_slots) {\n+  for (int i = 5; i < RegisterImpl::number_of_registers; i++, sp_offset_in_slots += step_in_slots) {\n","filename":"src\/hotspot\/cpu\/riscv\/sharedRuntime_riscv.cpp","additions":8,"deletions":8,"binary":false,"changes":16,"status":"modified"}]}