{"files":[{"patch":"@@ -2723,5 +2723,0 @@\n-\/\/\n-\/\/ FIXME: RISC-V does not yet support TLSDESC (Thread-Local Storage\n-\/\/ Descriptors), once supported, we should repalce Thread::current\n-\/\/ with JavaThread::riscv64_get_thread_helper() to reduce the clbber\n-\/\/ of non-callee save context.\n@@ -2734,2 +2729,6 @@\n-  call_VM_leaf_base(CAST_FROM_FN_PTR(address, Thread::current), 0);\n-  mv(thread, x10); \/\/ x10 is function call_vm_leaf_base return value, return java_thread value.\n+  int32_t offset = 0;\n+  movptr_with_offset(ra, CAST_FROM_FN_PTR(address, Thread::current), offset);\n+  jalr(ra, ra, offset);\n+  if (thread != x10) {\n+    mv(thread, x10);\n+  }\n","filename":"src\/hotspot\/cpu\/riscv\/macroAssembler_riscv.cpp","additions":6,"deletions":7,"binary":false,"changes":13,"status":"modified"},{"patch":"@@ -168,5 +168,0 @@\n-\/\/ TODO: Implement JavaThread::riscv64_get_thread_helper and revert this change\n-#if defined(RISCV)\n-#define USE_LIBRARY_BASED_TLS_ONLY 1\n-#endif\n-\n","filename":"src\/hotspot\/share\/utilities\/globalDefinitions_gcc.hpp","additions":0,"deletions":5,"binary":false,"changes":5,"status":"modified"}]}