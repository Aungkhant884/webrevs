{"files":[{"patch":"@@ -1345,1 +1345,1 @@\n-    bool _prev_in_compressible_region;\n+    bool _saved_in_compressible_region;\n@@ -1349,1 +1349,1 @@\n-    , _prev_in_compressible_region(_masm->in_compressible_region()) {\n+    , _saved_in_compressible_region(_masm->in_compressible_region()) {\n@@ -1353,1 +1353,1 @@\n-      _masm->set_in_compressible_region(_prev_in_compressible_region);\n+      _masm->set_in_compressible_region(_saved_in_compressible_region);\n@@ -1840,1 +1840,0 @@\n-\/\/ add -> c.add\n@@ -1843,1 +1842,2 @@\n-    if (check_rvc()) {                                                                         \\\n+    \/* add -> c.add *\/                                                                         \\\n+    if (do_compress()) {                                                                       \\\n@@ -1858,1 +1858,0 @@\n-\/\/ sub\/subw -> c.sub\/c.subw\n@@ -1861,1 +1860,2 @@\n-    if (check_rvc() &&                                                                       \\\n+    \/* sub\/subw -> c.sub\/c.subw *\/                                                           \\\n+    if (do_compress() &&                                                                     \\\n@@ -1875,1 +1875,0 @@\n-\/\/ xor\/or\/and\/addw -> c.xor\/c.or\/c.and\/c.addw\n@@ -1878,1 +1877,2 @@\n-    if (check_rvc()) {                                                                       \\\n+    \/* and\/or\/xor\/addw -> c.and\/c.or\/c.xor\/c.addw *\/                                         \\\n+    if (do_compress()) {                                                                     \\\n@@ -1898,1 +1898,1 @@\n-  bool check_rvc() const {\n+  bool do_compress() const {\n@@ -1944,1 +1944,0 @@\n-\/\/ lw -> c.lwsp\/c.lw\n@@ -1947,1 +1946,2 @@\n-    if (check_rvc()) {                                                                       \\\n+    \/* lw -> c.lwsp\/c.lw *\/                                                                  \\\n+    if (do_compress()) {                                                                     \\\n@@ -1964,1 +1964,0 @@\n-\/\/ ld -> c.ldsp\/c.ld\n@@ -1967,1 +1966,2 @@\n-    if (check_rvc()) {                                                                       \\\n+    \/* ld -> c.ldsp\/c.ld *\/                                                                  \\\n+    if (do_compress()) {                                                                     \\\n@@ -1984,1 +1984,0 @@\n-\/\/ fld -> c.fldsp\/c.fld\n@@ -1987,1 +1986,2 @@\n-    if (check_rvc()) {                                                                       \\\n+    \/* fld -> c.fldsp\/c.fld *\/                                                               \\\n+    if (do_compress()) {                                                                     \\\n@@ -2004,1 +2004,0 @@\n-\/\/ sd -> c.sdsp\/c.sd\n@@ -2007,1 +2006,2 @@\n-    if (check_rvc()) {                                                                       \\\n+    \/* sd -> c.sdsp\/c.sd *\/                                                                  \\\n+    if (do_compress()) {                                                                     \\\n@@ -2024,1 +2024,0 @@\n-\/\/ sw -> c.swsp\/c.sw\n@@ -2027,1 +2026,2 @@\n-    if (check_rvc()) {                                                                       \\\n+    \/* sw -> c.swsp\/c.sw *\/                                                                  \\\n+    if (do_compress()) {                                                                     \\\n@@ -2044,1 +2044,0 @@\n-\/\/ fsd -> c.fsdsp\/c.fsd\n@@ -2047,1 +2046,2 @@\n-    if (check_rvc()) {                                                                       \\\n+    \/* fsd -> c.fsdsp\/c.fsd *\/                                                               \\\n+    if (do_compress()) {                                                                     \\\n@@ -2066,2 +2066,0 @@\n-\/\/ beq\/bne -> c.beqz\/c.bnez\n-\n@@ -2070,1 +2068,2 @@\n-    if (check_rvc() &&                                                                       \\\n+    \/* beq\/bne -> c.beqz\/c.bnez *\/                                                           \\\n+    if (do_compress() &&                                                                     \\\n@@ -2087,1 +2086,0 @@\n-\/\/ jal -> c.j\n@@ -2090,1 +2088,2 @@\n-    if (check_rvc() && offset != 0 && Rd == x0 && is_imm_in_range(offset, 11, 1)) {          \\\n+    \/* jal -> c.j *\/                                                                         \\\n+    if (do_compress() && offset != 0 && Rd == x0 && is_imm_in_range(offset, 11, 1)) {        \\\n@@ -2102,1 +2101,0 @@\n-\/\/ jalr -> c.jr\/c.jalr\n@@ -2105,1 +2103,2 @@\n-    if (check_rvc() && (offset == 0 && Rs != x0)) {                                          \\\n+    \/* jalr -> c.jr\/c.jalr *\/                                                                \\\n+    if (do_compress() && (offset == 0 && Rs != x0)) {                                        \\\n@@ -2124,1 +2123,0 @@\n-\/\/ ebreak -> c.ebreak\n@@ -2127,1 +2125,2 @@\n-    if (check_rvc()) {                                                 \\\n+    \/* ebreak -> c.ebreak *\/                                           \\\n+    if (do_compress()) {                                               \\\n@@ -2141,1 +2140,0 @@\n-\/\/ li -> c.li\n@@ -2144,1 +2142,2 @@\n-    if (check_rvc() && (is_imm_in_range(imm, 6, 0) && Rd != x0)) {                           \\\n+    \/* li -> c.li *\/                                                                         \\\n+    if (do_compress() && (is_imm_in_range(imm, 6, 0) && Rd != x0)) {                         \\\n@@ -2155,1 +2154,1 @@\n-\/\/ addi -> c.addi\/c.nop\/c.mv\/c.addi16sp\/c.addi4spn.\n+\/\/ --------------------------\n@@ -2158,1 +2157,2 @@\n-    if (check_rvc()) {                                                                       \\\n+    \/* addi -> c.addi\/c.nop\/c.mv\/c.addi16sp\/c.addi4spn *\/                                    \\\n+    if (do_compress()) {                                                                     \\\n@@ -2183,1 +2183,0 @@\n-\/\/ addiw -> c.addiw\n@@ -2186,1 +2185,2 @@\n-    if (check_rvc() && (Rd == Rs1 && Rd != x0 && is_imm_in_range(imm, 6, 0))) {              \\\n+    \/* addiw -> c.addiw *\/                                                                   \\\n+    if (do_compress() && (Rd == Rs1 && Rd != x0 && is_imm_in_range(imm, 6, 0))) {            \\\n@@ -2198,1 +2198,0 @@\n-\/\/ and_imm12 -> c.andi\n@@ -2201,1 +2200,2 @@\n-    if (check_rvc() &&                                                                       \\\n+    \/* and_imm12 -> c.andi *\/                                                                \\\n+    if (do_compress() &&                                                                     \\\n@@ -2216,1 +2216,0 @@\n-\/\/ slli -> c.slli\n@@ -2219,1 +2218,2 @@\n-    if (check_rvc() && (Rd == Rs1 && Rd != x0 && shamt != 0)) {                              \\\n+    \/* slli -> c.slli *\/                                                                     \\\n+    if (do_compress() && (Rd == Rs1 && Rd != x0 && shamt != 0)) {                            \\\n@@ -2231,1 +2231,0 @@\n-\/\/ srai\/srli -> c.srai\/c.srli\n@@ -2234,1 +2233,2 @@\n-    if (check_rvc() && (Rd == Rs1 && Rd->is_compressed_valid() && shamt != 0)) {             \\\n+    \/* srai\/srli -> c.srai\/c.srli *\/                                                         \\\n+    if (do_compress() && (Rd == Rs1 && Rd->is_compressed_valid() && shamt != 0)) {           \\\n@@ -2249,1 +2249,0 @@\n-\/\/ lui -> c.lui\n@@ -2252,1 +2251,2 @@\n-    if (check_rvc() && (Rd != x0 && Rd != x2 && imm != 0 && is_imm_in_range(imm, 18, 0))) {  \\\n+    \/* lui -> c.lui *\/                                                                       \\\n+    if (do_compress() && (Rd != x0 && Rd != x2 && imm != 0 && is_imm_in_range(imm, 18, 0))) { \\\n@@ -2265,1 +2265,2 @@\n-    if (check_rvc()) {                                                  \\\n+    \/* The illegal instruction in RVC is presented by a 16-bit 0. *\/    \\\n+    if (do_compress()) {                                                \\\n","filename":"src\/hotspot\/cpu\/riscv\/assembler_riscv.hpp","additions":47,"deletions":46,"binary":false,"changes":93,"status":"modified"},{"patch":"@@ -95,1 +95,1 @@\n-  product(bool, UseRVC, false, EXPERIMENTAL, \"Use RVC instructions\")             \\\n+  product(bool, UseRVC, false, EXPERIMENTAL, \"Use RVC instructions\")\n","filename":"src\/hotspot\/cpu\/riscv\/globals_riscv.hpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"}]}