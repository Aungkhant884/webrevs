{"files":[{"patch":"@@ -437,0 +437,1 @@\n+\n@@ -438,1 +439,2 @@\n-  LIBHARFBUZZ_LIBS := $(HARFBUZZ_LIBS)\n+   LIBFONTMANAGER_EXTRA_SRC =\n+   BUILD_LIBFONTMANAGER_FONTLIB += $(HARFBUZZ_LIBS)\n@@ -440,57 +442,25 @@\n-  HARFBUZZ_CFLAGS := -DHAVE_OT -DHAVE_FALLBACK -DHAVE_UCDN -DHAVE_ROUND\n-\n-  # This is better than adding EXPORT_ALL_SYMBOLS\n-  ifneq ($(filter $(TOOLCHAIN_TYPE), gcc clang), )\n-    HARFBUZZ_CFLAGS += -DHB_EXTERN=__attribute__\\(\\(visibility\\(\\\"default\\\"\\)\\)\\)\n-  else ifeq ($(TOOLCHAIN_TYPE), microsoft)\n-    HARFBUZZ_CFLAGS += -DHB_EXTERN=__declspec\\(dllexport\\)\n-  endif\n-\n-  ifeq ($(call isTargetOs, windows), false)\n-    HARFBUZZ_CFLAGS += -DGETPAGESIZE -DHAVE_MPROTECT -DHAVE_PTHREAD \\\n-                      -DHAVE_SYSCONF -DHAVE_SYS_MMAN_H -DHAVE_UNISTD_H \\\n-                      -DHB_NO_PRAGMA_GCC_DIAGNOSTIC\n-  endif\n-  ifeq ($(call isTargetOs, linux macosx), true)\n-    HARFBUZZ_CFLAGS += -DHAVE_INTEL_ATOMIC_PRIMITIVES\n-  endif\n-  ifeq ($(call isTargetOs, macosx), true)\n-    HARFBUZZ_CFLAGS += -DHAVE_CORETEXT\n-  endif\n-  ifeq ($(call isTargetOs, macosx), false)\n-    LIBHARFBUZZ_EXCLUDE_FILES += harfbuzz\/hb-coretext.cc\n-  endif\n-  # hb-ft.cc is not presently needed, and requires freetype 2.4.2 or later.\n-  LIBHARFBUZZ_EXCLUDE_FILES += harfbuzz\/hb-ft.cc\n-\n-  LIBHARFBUZZ_CFLAGS += $(HARFBUZZ_CFLAGS)\n-\n-  # For use by libfontmanager:\n-  ifeq ($(call isTargetOs, windows), true)\n-    LIBHARFBUZZ_LIBS := $(SUPPORT_OUTPUTDIR)\/native\/$(MODULE)\/libharfbuzz\/harfbuzz.lib\n-  else\n-    LIBHARFBUZZ_LIBS := -lharfbuzz\n-  endif\n-\n-  LIBHARFBUZZ_EXTRA_HEADER_DIRS := \\\n-    libharfbuzz\/hb-ucdn \\\n-    #\n-\n-  LIBHARFBUZZ_OPTIMIZATION := HIGH\n-\n-  LIBHARFBUZZ_CFLAGS += $(X_CFLAGS) -DLE_STANDALONE -DHEADLESS\n-\n-  $(eval $(call SetupJdkLibrary, BUILD_LIBHARFBUZZ, \\\n-      NAME := harfbuzz, \\\n-      EXCLUDE_FILES := $(LIBHARFBUZZ_EXCLUDE_FILES), \\\n-      TOOLCHAIN := TOOLCHAIN_LINK_CXX, \\\n-      CFLAGS := $(CFLAGS_JDKLIB) $(LIBHARFBUZZ_CFLAGS), \\\n-      CXXFLAGS := $(CXXFLAGS_JDKLIB) $(LIBHARFBUZZ_CFLAGS), \\\n-      OPTIMIZATION := $(LIBHARFBUZZ_OPTIMIZATION), \\\n-      CFLAGS_windows = -DCC_NOEX, \\\n-      EXTRA_HEADER_DIRS := $(LIBHARFBUZZ_EXTRA_HEADER_DIRS), \\\n-      WARNINGS_AS_ERRORS_xlc := false, \\\n-      DISABLED_WARNINGS_gcc := type-limits missing-field-initializers strict-aliasing, \\\n-      DISABLED_WARNINGS_CXX_gcc := reorder delete-non-virtual-dtor strict-overflow \\\n-        maybe-uninitialized class-memaccess, \\\n-      DISABLED_WARNINGS_clang := unused-value incompatible-pointer-types \\\n+   LIBFONTMANAGER_EXTRA_SRC = libharfbuzz\n+   HARFBUZZ_CFLAGS := -DHAVE_OT -DHAVE_FALLBACK -DHAVE_UCDN -DHAVE_ROUND\n+\n+   ifeq ($(call isTargetOs, windows), false)\n+     HARFBUZZ_CFLAGS += -DGETPAGESIZE -DHAVE_MPROTECT -DHAVE_PTHREAD \\\n+                        -DHAVE_SYSCONF -DHAVE_SYS_MMAN_H -DHAVE_UNISTD_H \\\n+                        -DHB_NO_PRAGMA_GCC_DIAGNOSTIC\n+   endif\n+   ifeq ($(call isTargetOs, linux macosx), true)\n+     HARFBUZZ_CFLAGS += -DHAVE_INTEL_ATOMIC_PRIMITIVES\n+   endif\n+   ifeq ($(call isTargetOs, macosx), true)\n+     HARFBUZZ_CFLAGS += -DHAVE_CORETEXT\n+   endif\n+\n+   ifeq ($(call isTargetOs, macosx), false)\n+     LIBFONTMANAGER_EXCLUDE_FILES += libharfbuzz\/hb-coretext.cc\n+   endif\n+   # hb-ft.cc is not presently needed, and requires freetype 2.4.2 or later.\n+   LIBFONTMANAGER_EXCLUDE_FILES += libharfbuzz\/hb-ft.cc\n+\n+   HARFBUZZ_DISABLED_WARNINGS_gcc := type-limits missing-field-initializers strict-aliasing\n+   HARFBUZZ_DISABLED_WARNINGS_CXX_gcc := reorder delete-non-virtual-dtor strict-overflow \\\n+        maybe-uninitialized class-memaccess\n+   HARFBUZZ_DISABLED_WARNINGS_clang := unused-value incompatible-pointer-types \\\n@@ -498,15 +468,2 @@\n-        undef missing-field-initializers, \\\n-      DISABLED_WARNINGS_microsoft := 4267 4244 4090 4146 4334 4819 4101 4068 4805 4138, \\\n-      LDFLAGS := $(LDFLAGS_JDKLIB) \\\n-        $(call SET_SHARED_LIBRARY_ORIGIN), \\\n-      LDFLAGS_unix := -L$(INSTALL_LIBRARIES_HERE), \\\n-      LDFLAGS_aix := -Wl$(COMMA)-berok, \\\n-      LIBS := $(BUILD_LIBHARFBUZZ), \\\n-      LIBS_unix := $(LIBM) $(LIBCXX), \\\n-      LIBS_macosx := -framework CoreText -framework CoreFoundation -framework CoreGraphics, \\\n-      LIBS_windows := user32.lib, \\\n-  ))\n-\n-  ifeq ($(FREETYPE_TO_USE), bundled)\n-    $(BUILD_LIBHARFBUZZ): $(BUILD_LIBFREETYPE)\n-  endif\n+        undef missing-field-initializers\n+   HARFBUZZ_DISABLED_WARNINGS_microsoft := 4267 4244 4090 4146 4334 4819 4101 4068 4805 4138\n@@ -514,1 +471,1 @@\n-  TARGETS += $(BUILD_LIBHARFBUZZ)\n+   LIBFONTMANAGER_CFLAGS += $(HARFBUZZ_CFLAGS)\n@@ -518,1 +475,0 @@\n-###########################################################################\n@@ -522,0 +478,1 @@\n+    libharfbuzz\/hb-ucdn \\\n@@ -529,2 +486,2 @@\n-LIBFONTMANAGER_CFLAGS += $(LIBFREETYPE_CFLAGS) $(HARFBUZZ_FLAGS)\n-BUILD_LIBFONTMANAGER_FONTLIB += $(LIBHARFBUZZ_LIBS) $(LIBFREETYPE_LIBS)\n+LIBFONTMANAGER_CFLAGS += $(LIBFREETYPE_CFLAGS)\n+BUILD_LIBFONTMANAGER_FONTLIB +=  $(LIBFREETYPE_LIBS)\n@@ -532,1 +489,1 @@\n-LIBFONTMANAGER_OPTIMIZATION := HIGH\n+LIBFONTMANAGER_OPTIMIZATION := HIGHEST\n@@ -570,0 +527,1 @@\n+    EXTRA_SRC := $(LIBFONTMANAGER_EXTRA_SRC), \\\n@@ -571,3 +529,4 @@\n-    DISABLED_WARNINGS_gcc := sign-compare unused-function int-to-pointer-cast, \\\n-    DISABLED_WARNINGS_clang := sign-compare, \\\n-    DISABLED_WARNINGS_microsoft := 4018 4146 4244 4996, \\\n+    DISABLED_WARNINGS_gcc := sign-compare unused-function int-to-pointer-cast $(HARFBUZZ_DISABLED_WARNINGS_gcc), \\\n+    DISABLED_WARNINGS_CXX_gcc := $(HARFBUZZ_DISABLED_WARNINGS_CXX_gcc), \\\n+    DISABLED_WARNINGS_clang := sign-compare $(HARFBUZZ_DISABLED_WARNINGS_clang), \\\n+    DISABLED_WARNINGS_microsoft := 4018 4996 $(HARFBUZZ_DISABLED_WARNINGS_microsoft), \\\n@@ -581,1 +540,1 @@\n-    LIBS_macosx := -lawt_lwawt, \\\n+    LIBS_macosx := -lawt_lwawt -framework CoreText -framework CoreFoundation -framework CoreGraphics, \\\n@@ -588,4 +547,0 @@\n-ifeq ($(USE_EXTERNAL_HARFBUZZ), false)\n-  $(BUILD_LIBFONTMANAGER): $(BUILD_LIBHARFBUZZ)\n-endif\n-\n","filename":"make\/modules\/java.desktop\/lib\/Awt2dLibraries.gmk","additions":41,"deletions":86,"binary":false,"changes":127,"status":"modified"}]}