{"files":[{"patch":"@@ -49,1 +49,1 @@\n-                new String[]{ \"\", \"volatile\" }\n+                new String[]{ \"\", \"volatile\", \"sync\" }\n@@ -56,1 +56,1 @@\n-                new String[]{ \"\", \"volatile\" }\n+                new String[]{ \"\", \"volatile\", \"sync\" }\n@@ -63,1 +63,1 @@\n-                new String[]{ \"\", \"volatile\" }\n+                new String[]{ \"\", \"volatile\", \"final\", \"sync\" }\n@@ -70,1 +70,1 @@\n-                new String[]{ \"\", \"volatile\", \"final\" }\n+                new String[]{ \"\", \"volatile\", \"final\", \"sync\" }\n@@ -73,1 +73,0 @@\n-\n@@ -78,1 +77,1 @@\n-                new String[]{ \"\", \"volatile\" }\n+                new String[]{ \"\", \"volatile\", \"sync\" }\n@@ -85,1 +84,1 @@\n-                new String[]{ \"\", \"volatile\" }\n+                new String[]{ \"\", \"volatile\", \"sync\" }\n@@ -92,1 +91,1 @@\n-                new String[]{ \"\", \"volatile\" }\n+                new String[]{ \"\", \"volatile\", \"sync\" }\n@@ -99,1 +98,1 @@\n-                new String[]{ \"\", \"volatile\" }\n+                new String[]{ \"\", \"volatile\", \"sync\" }\n@@ -106,1 +105,1 @@\n-                new String[]{ \"\", \"volatile\" }\n+                new String[]{ \"\", \"volatile\", \"sync\" }\n@@ -113,1 +112,1 @@\n-                new String[]{ \"\", \"volatile\" }\n+                new String[]{ \"\", \"volatile\", \"sync\" }\n@@ -120,1 +119,1 @@\n-                new String[]{ \"\", \"volatile\" }\n+                new String[]{ \"\", \"volatile\", \"sync\" }\n@@ -127,1 +126,1 @@\n-                new String[]{ \"\", \"volatile\" }\n+                new String[]{ \"\", \"volatile\", \"sync\" }\n@@ -134,1 +133,1 @@\n-                new String[]{ \"\", \"volatile\" }\n+                new String[]{ \"\", \"volatile\", \"sync\" }\n@@ -141,1 +140,1 @@\n-                new String[]{ \"\", \"volatile\" }\n+                new String[]{ \"\", \"volatile\", \"sync\" }\n@@ -148,1 +147,1 @@\n-                new String[]{ \"\", \"volatile\" }\n+                new String[]{ \"\", \"volatile\", \"sync\" }\n@@ -176,1 +175,1 @@\n-                new String[]{ \"\", \"volatile\" }\n+                new String[]{ \"\", \"volatile\", \"sync\" }\n@@ -183,1 +182,1 @@\n-                new String[]{ \"\", \"volatile\" }\n+                new String[]{ \"\", \"volatile\", \"sync\" }\n@@ -190,1 +189,1 @@\n-                new String[]{ \"\", \"volatile\" }\n+                new String[]{ \"\", \"volatile\", \"sync\" }\n@@ -197,1 +196,1 @@\n-                new String[]{ \"\", \"volatile\" }\n+                new String[]{ \"\", \"volatile\", \"sync\" }\n@@ -203,1 +202,1 @@\n-            String pack = PREFIX + \".\" + label + \".\" + (modifier.equals(\"\") ? \"plain\" : modifier + \"s\");\n+            String pack = PREFIX + \".\" + label + \".\" + packageModifier(modifier);\n@@ -218,0 +217,26 @@\n+    private static String packageModifier(String modifier) {\n+        switch (modifier) {\n+            case \"\":\n+                return \"plain\";\n+            case \"sync\":\n+                return \"sync\";\n+            case \"volatile\":\n+            case \"final\":\n+                return modifier + \"s\";\n+            default:\n+                throw new IllegalArgumentException(\"Unknown modifier: \" + modifier);\n+        }\n+    }\n+\n+    private static String fieldModifier(String modifier) {\n+        switch (modifier) {\n+            case \"\":\n+            case \"sync\":\n+                return \"\";\n+            case \"volatile\":\n+            case \"final\":\n+                return modifier + \" \";\n+            default:\n+                throw new IllegalArgumentException(\"Unknown modifier: \" + modifier);\n+        }\n+    }\n@@ -230,1 +255,1 @@\n-        map.put(\"modifier\", (modifier.equals(\"\") ? \"\" : modifier + \" \"));\n+        map.put(\"modifier\", fieldModifier(modifier));\n@@ -244,1 +269,2 @@\n-                !(type.equals(\"double\") || type.equals(\"long\"));\n+                !(type.equals(\"double\") || type.equals(\"long\")) ||\n+                modifier.equals(\"sync\");\n@@ -248,1 +274,2 @@\n-        return (modifier.equals(\"volatile\") && !label.contains(\"array\"));\n+        return (modifier.equals(\"volatile\") && !label.contains(\"array\")) ||\n+                modifier.equals(\"sync\");\n","filename":"jcstress-test-gen\/src\/main\/java\/org\/openjdk\/jcstress\/chapters\/Chapter0aTestGenerator.java","additions":51,"deletions":24,"binary":false,"changes":75,"status":"modified"},{"patch":"@@ -55,1 +55,2 @@\n-                \"acqrel.fields\"\n+                \"acqrel.fields\",\n+                new String[]{ \"volatile\", \"sync\" }\n@@ -59,8 +60,36 @@\n-    private static void makeTests(String dest, String template, String label) throws IOException {\n-        String pack = PREFIX + \".\" + label + \".volatiles\";\n-        for (String typeV : TYPES_V) {\n-            for (String typeG : TYPES_G) {\n-                String name = testName(typeG, typeV);\n-                String res = Spp.spp(template,\n-                        keys(\"volatile\", typeG, label),\n-                        vars(\"volatile\", typeG, typeV, pack, name));\n+    private static String packageModifier(String modifier) {\n+        switch (modifier) {\n+            case \"\":\n+                return \"plain\";\n+            case \"sync\":\n+                return \"sync\";\n+            case \"volatile\":\n+            case \"final\":\n+                return modifier + \"s\";\n+            default:\n+                throw new IllegalArgumentException(\"Unknown modifier: \" + modifier);\n+        }\n+    }\n+\n+    private static String fieldModifier(String modifier) {\n+        switch (modifier) {\n+            case \"\":\n+            case \"sync\":\n+                return \"\";\n+            case \"volatile\":\n+            case \"final\":\n+                return modifier + \" \";\n+            default:\n+                throw new IllegalArgumentException(\"Unknown modifier: \" + modifier);\n+        }\n+    }\n+\n+    private static void makeTests(String dest, String template, String label, String[] modifiers) throws IOException {\n+        for (String modifier : modifiers) {\n+            String pack = PREFIX + \".\" + label + \".\" + packageModifier(modifier);\n+            for (String typeV : TYPES_V) {\n+                for (String typeG : TYPES_G) {\n+                    String name = testName(typeG, typeV);\n+                    String res = Spp.spp(template,\n+                            keys(modifier, typeG, label),\n+                            vars(modifier, typeG, typeV, pack, name));\n@@ -68,1 +97,2 @@\n-                GeneratorUtils.writeOut(dest, pack, name, res);\n+                    GeneratorUtils.writeOut(dest, pack, name, res);\n+                }\n@@ -92,1 +122,1 @@\n-        map.put(\"modifier\", (modifier.equals(\"\") ? \"\" : modifier + \" \"));\n+        map.put(\"modifier\", fieldModifier(modifier));\n","filename":"jcstress-test-gen\/src\/main\/java\/org\/openjdk\/jcstress\/chapters\/Chapter0eTestGenerator.java","additions":41,"deletions":11,"binary":false,"changes":52,"status":"modified"},{"patch":"@@ -46,0 +46,3 @@\n+#if[sync]\n+        synchronized (this) {\n+#end[sync]\n@@ -47,0 +50,3 @@\n+#if[sync]\n+        }\n+#end[sync]\n@@ -51,0 +57,3 @@\n+#if[sync]\n+        synchronized (this) {\n+#end[sync]\n@@ -52,0 +61,3 @@\n+#if[sync]\n+        }\n+#end[sync]\n","filename":"jcstress-test-gen\/src\/main\/resources\/accessAtomic\/X-ArrayAtomicityTest.java.template","additions":12,"deletions":0,"binary":false,"changes":12,"status":"modified"},{"patch":"@@ -46,0 +46,3 @@\n+#if[sync]\n+        synchronized (this) {\n+#end[sync]\n@@ -47,0 +50,3 @@\n+#if[sync]\n+        }\n+#end[sync]\n@@ -51,0 +57,3 @@\n+#if[sync]\n+        synchronized (this) {\n+#end[sync]\n@@ -52,0 +61,3 @@\n+#if[sync]\n+        }\n+#end[sync]\n","filename":"jcstress-test-gen\/src\/main\/resources\/accessAtomic\/X-FieldAtomicityTest.java.template","additions":12,"deletions":0,"binary":false,"changes":12,"status":"modified"},{"patch":"@@ -46,0 +46,3 @@\n+#if[sync]\n+        synchronized (this) {\n+#end[sync]\n@@ -47,0 +50,3 @@\n+#if[sync]\n+        }\n+#end[sync]\n@@ -51,0 +57,3 @@\n+#if[sync]\n+        synchronized (this) {\n+#end[sync]\n@@ -52,0 +61,3 @@\n+#if[sync]\n+        }\n+#end[sync]\n","filename":"jcstress-test-gen\/src\/main\/resources\/accessAtomic\/X-FieldConflictAtomicityTest.java.template","additions":12,"deletions":0,"binary":false,"changes":12,"status":"modified"},{"patch":"@@ -58,0 +58,3 @@\n+#if[sync]\n+        synchronized (this) {\n+#end[sync]\n@@ -61,0 +64,3 @@\n+#if[sync]\n+        }\n+#end[sync]\n@@ -65,3 +71,12 @@\n-        $typeV$ v1 = v;\n-        $typeG$ g1 = g;\n-        $typeV$ v2 = v;\n+        $typeV$ v1;\n+        $typeG$ g1;\n+        $typeV$ v2;\n+#if[sync]\n+        synchronized (this) {\n+#end[sync]\n+        v1 = v;\n+        g1 = g;\n+        v2 = v;\n+#if[sync]\n+        }\n+#end[sync]\n","filename":"jcstress-test-gen\/src\/main\/resources\/acqrel\/X-FieldAcqRelTest.java.template","additions":18,"deletions":3,"binary":false,"changes":21,"status":"modified"},{"patch":"@@ -47,0 +47,3 @@\n+#if[sync]\n+        synchronized (this) {\n+#end[sync]\n@@ -48,0 +51,3 @@\n+#if[sync]\n+        }\n+#end[sync]\n@@ -52,0 +58,3 @@\n+#if[sync]\n+        synchronized (this) {\n+#end[sync]\n@@ -53,0 +62,4 @@\n+#if[sync]\n+        }\n+        synchronized (this) {\n+#end[sync]\n@@ -54,0 +67,3 @@\n+#if[sync]\n+        }\n+#end[sync]\n","filename":"jcstress-test-gen\/src\/main\/resources\/coherence\/X-ArrayCoherenceTest.java.template","additions":16,"deletions":0,"binary":false,"changes":16,"status":"modified"},{"patch":"@@ -47,0 +47,3 @@\n+#if[sync]\n+        synchronized (this) {\n+#end[sync]\n@@ -48,0 +51,3 @@\n+#if[sync]\n+        }\n+#end[sync]\n@@ -52,0 +58,3 @@\n+#if[sync]\n+        synchronized (this) {\n+#end[sync]\n@@ -53,0 +62,4 @@\n+#if[sync]\n+        }\n+        synchronized (this) {\n+#end[sync]\n@@ -54,0 +67,3 @@\n+#if[sync]\n+        }\n+#end[sync]\n","filename":"jcstress-test-gen\/src\/main\/resources\/coherence\/X-FieldCoherenceTest.java.template","additions":16,"deletions":0,"binary":false,"changes":16,"status":"modified"},{"patch":"@@ -45,0 +45,3 @@\n+#if[sync]\n+        synchronized (this) {\n+#end[sync]\n@@ -46,0 +49,3 @@\n+#if[sync]\n+        }\n+#end[sync]\n@@ -50,1 +56,8 @@\n-        $type$[] a = arr;\n+        $type$[] a;\n+#if[sync]\n+        synchronized (this) {\n+#end[sync]\n+        a = arr;\n+#if[sync]\n+        }\n+#end[sync]\n","filename":"jcstress-test-gen\/src\/main\/resources\/defaultValues\/X-ArrayDefaultValuesTest.java.template","additions":14,"deletions":1,"binary":false,"changes":15,"status":"modified"},{"patch":"@@ -47,0 +47,3 @@\n+#if[sync]\n+        synchronized (this) {\n+#end[sync]\n@@ -48,0 +51,3 @@\n+#if[sync]\n+        }\n+#end[sync]\n@@ -53,0 +59,7 @@\n+#if[sync]\n+        synchronized (this) {\n+#end[sync]\n+        a = arr;\n+#if[sync]\n+        }\n+#end[sync]\n","filename":"jcstress-test-gen\/src\/main\/resources\/defaultValues\/X-ArrayLargeDefaultValuesTest.java.template","additions":13,"deletions":0,"binary":false,"changes":13,"status":"modified"},{"patch":"@@ -49,0 +49,3 @@\n+#if[sync]\n+        synchronized (this) {\n+#end[sync]\n@@ -50,0 +53,3 @@\n+#if[sync]\n+        }\n+#end[sync]\n@@ -54,1 +60,8 @@\n-        Data d = this.data;\n+        Data d;\n+#if[sync]\n+        synchronized (this) {\n+#end[sync]\n+        d = this.data;\n+#if[sync]\n+        }\n+#end[sync]\n","filename":"jcstress-test-gen\/src\/main\/resources\/defaultValues\/X-FieldDefaultValuesTest.java.template","additions":14,"deletions":1,"binary":false,"changes":15,"status":"modified"},{"patch":"@@ -44,0 +44,3 @@\n+#if[sync]\n+        synchronized (this) {\n+#end[sync]\n@@ -45,0 +48,3 @@\n+#if[sync]\n+        }\n+#end[sync]\n@@ -49,1 +55,8 @@\n-        Object a = arr;\n+        Object a;\n+#if[sync]\n+        synchronized (this) {\n+#end[sync]\n+        a = arr;\n+#if[sync]\n+        }\n+#end[sync]\n","filename":"jcstress-test-gen\/src\/main\/resources\/init\/X-ArrayInitClassTest.java.template","additions":14,"deletions":1,"binary":false,"changes":15,"status":"modified"},{"patch":"@@ -38,1 +38,1 @@\n-    $modifier$ Object arr;\n+    $modifier$ $type$[] arr;\n@@ -42,0 +42,3 @@\n+#if[sync]\n+        synchronized (this) {\n+#end[sync]\n@@ -43,0 +46,3 @@\n+#if[sync]\n+        }\n+#end[sync]\n@@ -47,1 +53,8 @@\n-        Object a = arr;\n+        $type$[] a;\n+#if[sync]\n+        synchronized (this) {\n+#end[sync]\n+        a = arr;\n+#if[sync]\n+        }\n+#end[sync]\n@@ -51,1 +64,1 @@\n-            r.r1 = (($type$[])a).length;\n+            r.r1 = a.length;\n","filename":"jcstress-test-gen\/src\/main\/resources\/init\/X-ArrayInitLengthTest.java.template","additions":16,"deletions":3,"binary":false,"changes":19,"status":"modified"},{"patch":"@@ -48,0 +48,3 @@\n+#if[sync]\n+        synchronized (this) {\n+#end[sync]\n@@ -51,0 +54,3 @@\n+#if[sync]\n+        }\n+#end[sync]\n@@ -55,1 +61,8 @@\n-        $type$[] a = arr;\n+        $type$[] a;\n+#if[sync]\n+        synchronized (this) {\n+#end[sync]\n+        a = arr;\n+#if[sync]\n+        }\n+#end[sync]\n","filename":"jcstress-test-gen\/src\/main\/resources\/init\/X-ArrayInitTest.java.template","additions":14,"deletions":1,"binary":false,"changes":15,"status":"modified"},{"patch":"@@ -41,0 +41,3 @@\n+#if[sync]\n+        synchronized (this) {\n+#end[sync]\n@@ -42,0 +45,3 @@\n+#if[sync]\n+        }\n+#end[sync]\n@@ -46,1 +52,8 @@\n-        Object a = arr;\n+        Object a;\n+#if[sync]\n+        synchronized (this) {\n+#end[sync]\n+        a = arr;\n+#if[sync]\n+        }\n+#end[sync]\n","filename":"jcstress-test-gen\/src\/main\/resources\/init\/X-ArrayLargeInitClassTest.java.template","additions":14,"deletions":1,"binary":false,"changes":15,"status":"modified"},{"patch":"@@ -38,1 +38,1 @@\n-    $modifier$ Object arr;\n+    $modifier$ $type$[] arr;\n@@ -42,0 +42,3 @@\n+#if[sync]\n+        synchronized (this) {\n+#end[sync]\n@@ -43,0 +46,3 @@\n+#if[sync]\n+        }\n+#end[sync]\n@@ -47,1 +53,8 @@\n-        Object a = arr;\n+        $type$[] a;\n+#if[sync]\n+        synchronized (this) {\n+#end[sync]\n+        a = arr;\n+#if[sync]\n+        }\n+#end[sync]\n@@ -51,1 +64,1 @@\n-            r.r1 = (($type$[])a).length;\n+            r.r1 = a.length;\n","filename":"jcstress-test-gen\/src\/main\/resources\/init\/X-ArrayLargeInitLengthTest.java.template","additions":16,"deletions":3,"binary":false,"changes":19,"status":"modified"},{"patch":"@@ -48,0 +48,3 @@\n+#if[sync]\n+        synchronized (this) {\n+#end[sync]\n@@ -51,0 +54,3 @@\n+#if[sync]\n+        }\n+#end[sync]\n@@ -55,1 +61,8 @@\n-        $type$[] a = arr;\n+        $type$[] a;\n+#if[sync]\n+        synchronized (this) {\n+#end[sync]\n+        a = arr;\n+#if[sync]\n+        }\n+#end[sync]\n","filename":"jcstress-test-gen\/src\/main\/resources\/init\/X-ArrayLargeInitTest.java.template","additions":14,"deletions":1,"binary":false,"changes":15,"status":"modified"},{"patch":"@@ -43,0 +43,3 @@\n+#if[sync]\n+        synchronized (this) {\n+#end[sync]\n@@ -44,0 +47,3 @@\n+#if[sync]\n+        }\n+#end[sync]\n@@ -48,1 +54,8 @@\n-        Object d = this.data;\n+        Object d;\n+#if[sync]\n+        synchronized (this) {\n+#end[sync]\n+        d = this.data;\n+#if[sync]\n+        }\n+#end[sync]\n","filename":"jcstress-test-gen\/src\/main\/resources\/init\/X-FieldInitClassTest.java.template","additions":14,"deletions":1,"binary":false,"changes":15,"status":"modified"},{"patch":"@@ -52,0 +52,3 @@\n+#if[sync]\n+        synchronized (this) {\n+#end[sync]\n@@ -53,0 +56,3 @@\n+#if[sync]\n+        }\n+#end[sync]\n@@ -57,1 +63,8 @@\n-        Data d = this.data;\n+        Data d;\n+#if[sync]\n+        synchronized (this) {\n+#end[sync]\n+        d = this.data;\n+#if[sync]\n+        }\n+#end[sync]\n","filename":"jcstress-test-gen\/src\/main\/resources\/init\/X-FieldInitTest.java.template","additions":14,"deletions":1,"binary":false,"changes":15,"status":"modified"},{"patch":"@@ -48,0 +48,3 @@\n+#if[sync]\n+        synchronized (this) {\n+#end[sync]\n@@ -49,0 +52,3 @@\n+#if[sync]\n+        }\n+#end[sync]\n@@ -53,0 +59,3 @@\n+#if[sync]\n+        synchronized (this) {\n+#end[sync]\n@@ -54,0 +63,3 @@\n+#if[sync]\n+        }\n+#end[sync]\n","filename":"jcstress-test-gen\/src\/main\/resources\/tearing\/X-ArrayLargeTearingTest.java.template","additions":12,"deletions":0,"binary":false,"changes":12,"status":"modified"},{"patch":"@@ -45,0 +45,3 @@\n+#if[sync]\n+        synchronized (this) {\n+#end[sync]\n@@ -46,0 +49,3 @@\n+#if[sync]\n+        }\n+#end[sync]\n@@ -50,0 +56,3 @@\n+#if[sync]\n+        synchronized (this) {\n+#end[sync]\n@@ -51,0 +60,3 @@\n+#if[sync]\n+        }\n+#end[sync]\n","filename":"jcstress-test-gen\/src\/main\/resources\/tearing\/X-ArrayTearingTest.java.template","additions":12,"deletions":0,"binary":false,"changes":12,"status":"modified"},{"patch":"@@ -50,0 +50,3 @@\n+#if[sync]\n+        synchronized (this) {\n+#end[sync]\n@@ -51,0 +54,3 @@\n+#if[sync]\n+        }\n+#end[sync]\n@@ -55,0 +61,3 @@\n+#if[sync]\n+        synchronized (this) {\n+#end[sync]\n@@ -56,0 +65,3 @@\n+#if[sync]\n+        }\n+#end[sync]\n","filename":"jcstress-test-gen\/src\/main\/resources\/tearing\/X-FieldTearingTest.java.template","additions":12,"deletions":0,"binary":false,"changes":12,"status":"modified"}]}