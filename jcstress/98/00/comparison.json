{"files":[{"patch":"@@ -34,0 +34,1 @@\n+import org.openjdk.jcstress.infra.runners.TestConfig;\n@@ -35,0 +36,1 @@\n+import org.openjdk.jcstress.os.SchedulingClass;\n@@ -36,0 +38,1 @@\n+import org.openjdk.jcstress.vm.CompileMode;\n@@ -353,1 +356,4 @@\n-        sorted.sort(Comparator.comparing((TestResult t) -> StringUtils.join(t.getConfig().jvmArgs, \",\")));\n+        sorted.sort(Comparator\n+                .comparing((TestResult t) -> t.getConfig().getCompileMode())\n+                .thenComparing((TestResult t) -> t.getConfig().getSchedulingClass().toString())\n+                .thenComparing((TestResult t) -> StringUtils.join(t.getConfig().jvmArgs, \",\")));\n@@ -365,14 +371,1 @@\n-        o.println(\"<h3>Test configurations<\/h3>\");\n-\n-        o.println(\"<table>\");\n-        int configs = 0;\n-        for (TestResult r : sorted) {\n-            o.println(\"<tr>\");\n-            o.println(\"<td nowrap><b>TC \" + (configs + 1) + \"<\/b><\/td>\");\n-            o.println(\"<td nowrap>\" + r.getConfig() + \"<\/td>\");\n-            o.println(\"<\/tr>\");\n-            configs++;\n-        }\n-        o.println(\"<\/table>\");\n-\n-        o.println(\"<h3>Observed states<\/h3>\");\n+        o.println(\"<h3>Results<\/h3>\");\n@@ -385,1 +378,2 @@\n-        o.println(\"<table cellpadding=5>\");\n+        o.println(\"<table cellpadding=5 border=1>\");\n+\n@@ -387,6 +381,5 @@\n-        o.println(\"<th>Observed state<\/th>\");\n-        for (int c = 0; c < configs; c++) {\n-            o.println(\"<th nowrap>TC \" + (c+1) + \"<\/th>\");\n-        }\n-        o.println(\"<th>Expectation<\/th>\");\n-        o.println(\"<th>Interpretation<\/th>\");\n+        o.println(\"<th>Compilation Mode<\/th>\");\n+        o.println(\"<th>Scheduling Class<\/th>\");\n+        o.println(\"<th>Java Options<\/th>\");\n+        o.println(\"<th>Status<\/th>\");\n+        o.println(\"<th colspan=\" + keys.size() + \">Observed States<\/th>\");\n@@ -395,0 +388,2 @@\n+        o.println(\"<tr>\");\n+        o.println(\"<th colspan=4><\/th>\");\n@@ -396,5 +391,3 @@\n-            o.println(\"<tr>\");\n-            o.println(\"<td align='center'>\" + key + \"<\/td>\");\n-\n-            String description = \"\";\n-            Expect expect = null;\n+            o.println(\"<th nowrap align='center'>\" + key + \"<\/th>\");\n+        }\n+        o.println(\"<\/tr>\");\n@@ -402,0 +395,3 @@\n+        o.println(\"<tr>\");\n+        o.println(\"<td colspan=4><\/td>\");\n+        for (String key : keys) {\n@@ -405,5 +401,2 @@\n-                    o.println(\"<td align='right' width='\" + 30D\/configs + \"%' bgColor=\" + selectHTMLColor(c.expect, c.count == 0) + \">\" + c.count + \"<\/td>\");\n-                    description = c.description;\n-                    expect = c.expect;\n-                } else {\n-                    o.println(\"<td align='right' width='\" + 30D\/configs + \"%' bgColor=\" + selectHTMLColor(Expect.ACCEPTABLE, true) + \">0<\/td>\");\n+                    o.println(\"<td>\" + c.expect + \"<\/td>\");\n+                    break;\n@@ -412,4 +405,0 @@\n-\n-            o.println(\"<td>\" + expect + \"<\/td>\");\n-            o.println(\"<td>\" + description + \"<\/td>\");\n-            o.println(\"<\/tr>\");\n@@ -417,0 +406,1 @@\n+        o.println(\"<\/tr>\");\n@@ -419,1 +409,12 @@\n-        o.println(\"<td><\/td>\");\n+        o.println(\"<td colspan=4><\/td>\");\n+        for (String key : keys) {\n+            for (TestResult r : sorted) {\n+                GradingResult c = r.grading().gradingResults.get(key);\n+                if (c != null) {\n+                    o.println(\"<td>\" + c.description + \"<\/td>\");\n+                    break;\n+                }\n+            }\n+        }\n+        o.println(\"<\/tr>\");\n+\n@@ -421,0 +422,11 @@\n+            o.println(\"<tr>\");\n+\n+            TestConfig cfg = r.getConfig();\n+            o.println(\"<td nowrap valign=top width=10><pre>\" + CompileMode.description(cfg.compileMode, cfg.actorNames) + \"<\/pre><\/td>\");\n+            o.println(\"<td nowrap valign=top width=10><pre>\" + SchedulingClass.description(cfg.shClass, cfg.actorNames) + \"<\/pre><\/td>\");\n+            o.println(\"<td        valign=top width=10>\");\n+            if (!cfg.jvmArgs.isEmpty()) {\n+                o.println(\"<pre>\" + cfg.jvmArgs + \"<\/pre>\");\n+            }\n+            o.println(\"<\/td>\");\n+\n@@ -424,0 +436,10 @@\n+\n+            for (String key : keys) {\n+                GradingResult c = r.grading().gradingResults.get(key);\n+                if (c != null) {\n+                    o.println(\"<td align='right' width='\" + 100D\/keys.size() + \"%' bgColor=\" + selectHTMLColor(c.expect, c.count == 0) + \">\" + c.count + \"<\/td>\");\n+                } else {\n+                    o.println(\"<td align='right' width='\" + 100D\/keys.size() + \"%' bgColor=\" + selectHTMLColor(Expect.ACCEPTABLE, true) + \">0<\/td>\");\n+                }\n+            }\n+            o.println(\"<\/tr>\");\n@@ -425,3 +447,0 @@\n-        o.println(\"<td><\/td>\");\n-        o.println(\"<td><\/td>\");\n-        o.println(\"<\/tr>\");\n@@ -435,1 +454,1 @@\n-                o.println(\"<p><b>\" + r.getConfig() + \"<\/b><\/p>\");\n+                resultHeader(o, r);\n@@ -449,1 +468,1 @@\n-                o.println(\"<p><b>\" + r.getConfig() + \"<\/b><\/p>\");\n+                resultHeader(o, r);\n@@ -463,1 +482,1 @@\n-                o.println(\"<p><b>\" + r.getConfig() + \"<\/b><\/p>\");\n+                resultHeader(o, r);\n@@ -476,0 +495,12 @@\n+    private void resultHeader(PrintWriter o, TestResult r) {\n+        TestConfig cfg = r.getConfig();\n+        o.println(\"<p><b>\");\n+        o.println(\"<pre>\" + CompileMode.description(cfg.compileMode, cfg.actorNames) + \"<\/pre>\");\n+        o.println(\"<pre>\" + SchedulingClass.description(cfg.shClass, cfg.actorNames) + \"<\/pre>\");\n+        o.println(\"\");\n+        if (!cfg.jvmArgs.isEmpty()) {\n+            o.println(\"<pre>\" + cfg.jvmArgs + \"<\/pre>\");\n+        }\n+        o.println(\"<\/b><\/p>\");\n+    }\n+\n","filename":"jcstress-core\/src\/main\/java\/org\/openjdk\/jcstress\/infra\/grading\/HTMLReportPrinter.java","additions":74,"deletions":43,"binary":false,"changes":117,"status":"modified"},{"patch":"@@ -108,4 +108,0 @@\n-    @Override\n-    public String toString() {\n-        return \"JVM options: \" + jvmArgs +\"; Compile mode: \" + getCompileMode();\n-    }\n","filename":"jcstress-core\/src\/main\/java\/org\/openjdk\/jcstress\/infra\/runners\/TestConfig.java","additions":0,"deletions":4,"binary":false,"changes":4,"status":"modified"}]}