{"files":[{"patch":"@@ -48,0 +48,2 @@\n+        IllegalStateException ex = new IllegalStateException(\"Cannot get Unsafe\");\n+\n@@ -50,13 +52,3 @@\n-        } catch (SecurityException se) {\n-            try {\n-                return java.security.AccessController.doPrivileged\n-                    ((java.security.PrivilegedExceptionAction<sun.misc.Unsafe>) () -> {\n-                        java.lang.reflect.Field f = sun.misc\n-                            .Unsafe.class.getDeclaredField(\"theUnsafe\");\n-                        f.setAccessible(true);\n-                        return (sun.misc.Unsafe) f.get(null);\n-                    });\n-            } catch (java.security.PrivilegedActionException e) {\n-                throw new RuntimeException(\"Could not initialize intrinsics\",\n-                                           e.getCause());\n-            }\n+        } catch (SecurityException e) {\n+            \/\/ Fall-through\n+            ex.addSuppressed(e);\n@@ -64,0 +56,11 @@\n+\n+        try {\n+            java.lang.reflect.Field f = sun.misc.Unsafe.class.getDeclaredField(\"theUnsafe\");\n+            f.setAccessible(true);\n+            return (sun.misc.Unsafe) f.get(null);\n+        } catch (IllegalAccessException | NoSuchFieldException e) {\n+            \/\/ Fall-through\n+            ex.addSuppressed(e);\n+        }\n+\n+        throw ex;\n","filename":"jcstress-core\/src\/main\/java\/org\/openjdk\/jcstress\/util\/UnsafeHolder.java","additions":16,"deletions":13,"binary":false,"changes":29,"status":"modified"},{"patch":"@@ -28,1 +28,0 @@\n-import java.security.ProtectionDomain;\n@@ -159,4 +158,0 @@\n-    public abstract Class<?> defineClass(String name, byte[] b, int off, int len,\n-                                       ClassLoader loader,\n-                                       ProtectionDomain protectionDomain);\n-\n","filename":"jcstress-core\/src\/main\/java\/sun\/misc\/Unsafe.java","additions":0,"deletions":5,"binary":false,"changes":5,"status":"modified"}]}