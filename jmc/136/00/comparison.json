{"files":[{"patch":"@@ -9,0 +9,1 @@\n+BASEDIR=\"\"\n@@ -22,40 +23,2 @@\n-function err_log() {\n-    echo \"$@\" >&2\n-}\n-\n-trap 'err_report $LINENO' ERR\n-trap 'exitTrap' EXIT\n-\n-function printHelp() {\n-    echo \"usage: call .\/$(basename \"$0\") with the following options:\"\n-    {\n-        printf \" \\t%s\\t%s\\n\" \"--test\" \"to run the tests\"\n-        printf \" \\t%s\\t%s\\n\" \"--testUi\" \"to run the tests including UI tests\"\n-        printf \" \\t%s\\t%s\\n\" \"--packageJmc\" \"to package JMC\"\n-        printf \" \\t%s\\t%s\\n\" \"--clean\" \"to run maven clean\"\n-        printf \" \\t%s\\t%s\\n\" \"--run\" \"to run JMC once it was packaged\"\n-        printf \" \\t%s\\t%s\\n\" \"--help\" \"to show this help dialog\"\n-    } | column -ts $'\\t'\n-}\n-\n-if [ $# -eq 0 ]; then\n-    printHelp\n-    exit 0\n-fi\n-\n-function runTests() {\n-    mvn verify\n-}\n-\n-function runUiTests() {\n-    mvn verify -P uitests\n-}\n-\n-function packageJmc() {\n-    local timestamp\n-    timestamp=\"$(date +%Y%m%d%H%M%S)\"\n-    local BASEDIR\n-    BASEDIR=$(mvn help:evaluate -Dexpression=project.build.directory --non-recursive -q -DforceStdout)\n-\n-    mkdir -p \"${BASEDIR}\" # just in case clean was called before\n-\n+function startJetty() {\n+    local timestamp=\"$(date +%Y%m%d%H%M%S)\"\n@@ -65,1 +28,0 @@\n-    local packageLog=\"${BASEDIR}\/build_${timestamp}.4.package.log\"\n@@ -101,0 +63,41 @@\n+}\n+\n+function err_log() {\n+    echo \"$@\" >&2\n+}\n+\n+trap 'err_report $LINENO' ERR\n+trap 'exitTrap' EXIT\n+\n+function printHelp() {\n+    echo \"usage: call .\/$(basename \"$0\") with the following options:\"\n+    {\n+        printf \" \\t%s\\t%s\\n\" \"--test\" \"to run the tests\"\n+        printf \" \\t%s\\t%s\\n\" \"--testUi\" \"to run the tests including UI tests\"\n+        printf \" \\t%s\\t%s\\n\" \"--packageJmc\" \"to package JMC\"\n+        printf \" \\t%s\\t%s\\n\" \"--clean\" \"to run maven clean\"\n+        printf \" \\t%s\\t%s\\n\" \"--run\" \"to run JMC once it was packaged\"\n+        printf \" \\t%s\\t%s\\n\" \"--help\" \"to show this help dialog\"\n+    } | column -ts $'\\t'\n+}\n+\n+if [ $# -eq 0 ]; then\n+    printHelp\n+    exit 0\n+fi\n+\n+function runTests() {\n+    echo \"$(date +%T) running tests\"\n+    mvn verify\n+}\n+\n+function runUiTests() {\n+    startJetty\n+    echo \"$(date +%T) running UI tests\"\n+    mvn verify -P uitests\n+}\n+\n+function packageJmc() {\n+    startJetty\n+    local packageLog=\"${BASEDIR}\/build_$(date +%Y%m%d%H%M%S).4.package.log\"\n+\n@@ -114,0 +117,1 @@\n+    echo \"$(date +%T) running clean up\"\n@@ -138,3 +142,0 @@\n-    local BASEDIR\n-    BASEDIR=\"$(mvn help:evaluate -Dexpression=project.build.directory --non-recursive -q -DforceStdout)\"\n-\n@@ -201,0 +202,3 @@\n+\n+    BASEDIR=$(mvn help:evaluate -Dexpression=project.build.directory --non-recursive -q -DforceStdout)\n+    mkdir -p \"${BASEDIR}\" # just in case clean was called before\n","filename":"build.sh","additions":48,"deletions":44,"binary":false,"changes":92,"status":"modified"}]}