{"files":[{"patch":"@@ -190,1 +190,0 @@\n-\n@@ -285,1 +284,0 @@\n-\t\tprivate volatile boolean isInvalid;\n@@ -288,0 +286,1 @@\n+\t\tprivate volatile boolean isInvalid;\n@@ -303,0 +302,3 @@\n+\t\t\tif (isInvalid) {\n+\t\t\t\treturn abort();\n+\t\t\t}\n@@ -304,1 +306,1 @@\n-\t\t\tString jsonModel = view.toJSonModel(traceNode).toString();\n+\t\t\tString jsonModel = view.toJSonModel(traceNode, this).toString();\n@@ -306,1 +308,4 @@\n-\t\t\t\tview.modelState = ModelState.ABORTED;\n+\t\t\t\treturn abort();\n+\t\t\t} else {\n+\t\t\t\tview.modelState = ModelState.READY;\n+\t\t\t\tDisplayToolkit.inDisplayThread().execute(() -> view.setModel(items, jsonModel));\n@@ -309,2 +314,4 @@\n-\t\t\tview.modelState = ModelState.READY;\n-\t\t\tDisplayToolkit.inDisplayThread().execute(() -> view.setModel(items, jsonModel));\n+\t\t}\n+\n+\t\tprivate Void abort() {\n+\t\t\tview.modelState = ModelState.ABORTED;\n@@ -492,1 +499,1 @@\n-\tprivate StringBuilder toJSonModel(TraceNode root) {\n+\tprivate StringBuilder toJSonModel(TraceNode root, ModelRebuildCallable rebuildCallable) {\n@@ -496,1 +503,1 @@\n-\t\trenderChildren(builder, root);\n+\t\trenderChildren(builder, root, rebuildCallable);\n@@ -501,1 +508,1 @@\n-\tprivate static void render(StringBuilder builder, TraceNode node) {\n+\tprivate static void render(StringBuilder builder, TraceNode node, ModelRebuildCallable rebuildCallable) {\n@@ -505,1 +512,1 @@\n-\t\trenderChildren(builder, node);\n+\t\trenderChildren(builder, node, rebuildCallable);\n@@ -509,3 +516,4 @@\n-\tprivate static void renderChildren(StringBuilder builder, TraceNode node) {\n-\t\tfor (int i = 0; i < node.getChildren().size(); i++) {\n-\t\t\trender(builder, node.getChildren().get(i));\n+\tprivate static void renderChildren(StringBuilder builder, TraceNode node, ModelRebuildCallable rebuildCallable) {\n+\t\tint i = 0;\n+\t\twhile (i < node.getChildren().size() && !rebuildCallable.isInvalid) {\n+\t\t\trender(builder, node.getChildren().get(i), rebuildCallable);\n@@ -515,0 +523,1 @@\n+\t\t\ti++;\n","filename":"application\/org.openjdk.jmc.flightrecorder.flameview\/src\/main\/java\/org\/openjdk\/jmc\/flightrecorder\/flameview\/views\/FlameGraphView.java","additions":22,"deletions":13,"binary":false,"changes":35,"status":"modified"}]}