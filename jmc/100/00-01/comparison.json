{"files":[{"patch":"@@ -15,1 +15,1 @@\n-function exit() {\n+function exitTrap() {\n@@ -27,1 +27,1 @@\n-trap 'exit' EXIT\n+trap 'exitTrap' EXIT\n@@ -36,0 +36,1 @@\n+        printf \" \\t%s\\t%s\\n\" \"--run\" \"to run JMC once it was packaged\"\n@@ -67,1 +68,1 @@\n-        echo \"directory releng\/third-party not found\"\n+        err_log \"directory releng\/third-party not found\"\n@@ -85,1 +86,1 @@\n-        echo \"could not go to project root directory\"\n+        err_log \"could not go to project root directory\"\n@@ -89,1 +90,1 @@\n-        echo \"directory core not found\"\n+        err_log \"directory core not found\"\n@@ -97,1 +98,1 @@\n-        echo \"could not go to project root directory\"\n+        err_log \"could not go to project root directory\"\n@@ -103,1 +104,7 @@\n-    echo \"You can now run jmc by calling ${BASEDIR}\/products\/org.openjdk.jmc\/linux\/gtk\/x86_64\/JDK\\ Mission\\ Control\/jmc\"\n+    if [[ \"${OSTYPE}\" =~ \"linux\"* ]]; then\n+        echo \"You can now run jmc by calling ${BASEDIR}\/products\/org.openjdk.jmc\/linux\/gtk\/x86_64\/JDK\\ Mission\\ Control\/jmc\"\n+    elif [[ \"${OSTYPE}\" =~ \"darwin\"* ]]; then\n+        echo \"You can now run jmc by calling ${BASEDIR}\/products\/org.openjdk.jmc\/macosx\/cocoa\/x86_64\/JDK\\ Mission\\ Control.app\/Contents\/MacOS\/jmc\"\n+    else\n+        err_log \"unknown OS type: \\\"${OSTYPE}\\\". Please check your package in ${BASEDIR}\/products\/org.openjdk.jmc\/\"\n+    fi\n@@ -110,1 +117,1 @@\n-        echo \"directory core not found\"\n+        err_log \"directory core not found\"\n@@ -115,1 +122,1 @@\n-        echo \"could not go to project root directory\"\n+        err_log \"could not go to project root directory\"\n@@ -120,1 +127,1 @@\n-        echo \"directory releng\/third-party not found\"\n+        err_log \"directory releng\/third-party not found\"\n@@ -125,1 +132,1 @@\n-        echo \"could not go to project root directory\"\n+        err_log \"could not go to project root directory\"\n@@ -130,0 +137,22 @@\n+function run() {\n+    local BASEDIR\n+    BASEDIR=\"$(mvn help:evaluate -Dexpression=project.build.directory --non-recursive -q -DforceStdout)\"\n+\n+    local path\n+    if [[ \"${OSTYPE}\" =~ \"linux\"* ]]; then\n+        path=\"${BASEDIR}\/products\/org.openjdk.jmc\/linux\/gtk\/x86_64\/JDK Mission Control\/jmc\"\n+    elif [[ \"${OSTYPE}\" =~ \"darwin\"* ]]; then\n+        path=\"${BASEDIR}\/products\/org.openjdk.jmc\/macosx\/cocoa\/x86_64\/JDK Mission Control.app\/Contents\/MacOS\/jmc\"\n+    else\n+        err_log \"unknown OS type: ${OSTYPE}\"\n+        exit 1\n+    fi\n+\n+    if [ -f \"${path}\" ]; then\n+        exec \"${path}\"\n+    else\n+        err_log \"JMC not found in \\\"${path}\\\". Did you call --packageJmc before?\"\n+        exit 1\n+    fi\n+}\n+\n@@ -149,0 +178,3 @@\n+            --run)\n+                run\n+                ;;\n@@ -150,1 +182,1 @@\n-                echo \"unknown argument \\\"$1\\\"\"\n+                err_log \"unknown argument \\\"$1\\\"\"\n@@ -159,0 +191,13 @@\n+function checkPreconditions() {\n+    if ! command -v   mvn &> \/dev\/null ; then\n+        err_log \"It seems you do not have maven installed. Please ensure you have it installend and executable as \\\"mvn\\\".\"\n+        exit 1\n+    fi\n+\n+    if ! command -v   java &> \/dev\/null ; then\n+        err_log \"It seems you do not have java installed. Please ensure you have it installend and executable as \\\"java\\\".\"\n+        exit 1\n+    fi\n+}\n+\n+checkPreconditions\n","filename":"build.sh","additions":57,"deletions":12,"binary":false,"changes":69,"status":"modified"}]}