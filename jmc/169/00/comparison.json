{"files":[{"patch":"@@ -3,1 +3,1 @@\n- * \n+ *\n@@ -13,1 +13,1 @@\n- * \n+ *\n@@ -16,1 +16,1 @@\n- * \n+ *\n@@ -20,1 +20,1 @@\n- * \n+ *\n@@ -23,1 +23,1 @@\n- * \n+ *\n@@ -49,1 +49,1 @@\n-\t * Returns the list of {@link TransformDescriptor}s for the named class.\n+\t * Returns the unmodifiable list of {@link TransformDescriptor}s for the named class.\n@@ -53,1 +53,2 @@\n-\t * @return the list of transformation metadata for the named class.\n+\t * @return the list of transformation metadata for the named class; may be empty but never\n+\t *         {@code null}.\n@@ -97,1 +98,1 @@\n-\t * \n+\t *\n@@ -105,1 +106,1 @@\n-\t * \n+\t *\n","filename":"agent\/src\/main\/java\/org\/openjdk\/jmc\/agent\/TransformRegistry.java","additions":10,"deletions":9,"binary":false,"changes":19,"status":"modified"},{"patch":"@@ -3,1 +3,1 @@\n- * \n+ *\n@@ -13,1 +13,1 @@\n- * \n+ *\n@@ -16,1 +16,1 @@\n- * \n+ *\n@@ -20,1 +20,1 @@\n- * \n+ *\n@@ -23,1 +23,1 @@\n- * \n+ *\n@@ -64,0 +64,1 @@\n+import org.openjdk.jmc.agent.Field;\n@@ -69,1 +70,0 @@\n-import org.openjdk.jmc.agent.Field;\n@@ -159,1 +159,1 @@\n-\t\t\t\t\t\tadd(registry, td);\n+\t\t\t\t\t\tregistry.add(td);\n@@ -179,2 +179,2 @@\n-\tprivate static void add(DefaultTransformRegistry registry, TransformDescriptor td) {\n-\t\tList<TransformDescriptor> transformDataList = registry.getTransformData(td.getClassName());\n+\tprivate void add(TransformDescriptor td) {\n+\t\tList<TransformDescriptor> transformDataList = transformData.get(td.getClassName());\n@@ -183,1 +183,1 @@\n-\t\t\tregistry.transformData.put(td.getClassName(), transformDataList);\n+\t\t\ttransformData.put(td.getClassName(), transformDataList);\n@@ -456,1 +456,2 @@\n-\t\treturn transformData.get(className);\n+\t\tList<TransformDescriptor> data = transformData.get(className);\n+\t\treturn data != null ? data : Collections.emptyList();\n@@ -484,0 +485,1 @@\n+\t@Override\n@@ -503,1 +505,1 @@\n-\t\t\t\t\t\t\tadd(this, td);\n+\t\t\t\t\t\t\tadd(td);\n@@ -530,0 +532,1 @@\n+\t@Override\n@@ -540,0 +543,1 @@\n+\t@Override\n@@ -544,0 +548,1 @@\n+\t@Override\n@@ -548,0 +553,1 @@\n+\t@Override\n@@ -552,0 +558,1 @@\n+\t@Override\n@@ -556,0 +563,1 @@\n+\t@Override\n","filename":"agent\/src\/main\/java\/org\/openjdk\/jmc\/agent\/impl\/DefaultTransformRegistry.java","additions":20,"deletions":12,"binary":false,"changes":32,"status":"modified"},{"patch":"@@ -3,1 +3,1 @@\n- * \n+ *\n@@ -13,1 +13,1 @@\n- * \n+ *\n@@ -16,1 +16,1 @@\n- * \n+ *\n@@ -20,1 +20,1 @@\n- * \n+ *\n@@ -23,1 +23,1 @@\n- * \n+ *\n@@ -138,1 +138,1 @@\n-\t\tassertTrue(classesCleared.size() == 1);\n+\t\tassertEquals(1, classesCleared.size());\n@@ -140,1 +140,1 @@\n-\t\tassertNull(registry.getTransformData(Type.getInternalName(InstrumentMe.class)));\n+\t\tassertEquals(0, registry.getTransformData(Type.getInternalName(InstrumentMe.class)).size());\n","filename":"agent\/src\/test\/java\/org\/openjdk\/jmc\/agent\/test\/TestDefaultTransformRegistry.java","additions":7,"deletions":7,"binary":false,"changes":14,"status":"modified"}]}