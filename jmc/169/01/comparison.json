{"files":[{"patch":"@@ -2,2 +2,2 @@\n- * Copyright (c) 2018, Oracle and\/or its affiliates. All rights reserved.\n- * \n+ * Copyright (c) 2018, 2020, Oracle and\/or its affiliates. All rights reserved.\n+ *\n@@ -13,1 +13,1 @@\n- * \n+ *\n@@ -16,1 +16,1 @@\n- * \n+ *\n@@ -20,1 +20,1 @@\n- * \n+ *\n@@ -23,1 +23,1 @@\n- * \n+ *\n@@ -49,1 +49,1 @@\n-\t * Returns the list of {@link TransformDescriptor}s for the named class.\n+\t * Returns the unmodifiable list of {@link TransformDescriptor}s for the named class.\n@@ -53,1 +53,2 @@\n-\t * @return the list of transformation metadata for the named class.\n+\t * @return the list of transformation metadata for the named class; may be empty but never\n+\t *         {@code null}.\n@@ -97,1 +98,1 @@\n-\t * \n+\t *\n@@ -105,1 +106,1 @@\n-\t * \n+\t *\n","filename":"agent\/src\/main\/java\/org\/openjdk\/jmc\/agent\/TransformRegistry.java","additions":11,"deletions":10,"binary":false,"changes":21,"status":"modified"},{"patch":"@@ -3,1 +3,1 @@\n- * \n+ *\n@@ -13,1 +13,1 @@\n- * \n+ *\n@@ -16,1 +16,1 @@\n- * \n+ *\n@@ -20,1 +20,1 @@\n- * \n+ *\n@@ -23,1 +23,1 @@\n- * \n+ *\n@@ -64,0 +64,2 @@\n+import org.openjdk.jmc.agent.Agent;\n+import org.openjdk.jmc.agent.Field;\n@@ -69,2 +71,0 @@\n-import org.openjdk.jmc.agent.Agent;\n-import org.openjdk.jmc.agent.Field;\n@@ -160,1 +160,1 @@\n-\t\t\t\t\t\tadd(registry, td);\n+\t\t\t\t\t\tregistry.add(td);\n@@ -180,2 +180,2 @@\n-\tprivate static void add(DefaultTransformRegistry registry, TransformDescriptor td) {\n-\t\tList<TransformDescriptor> transformDataList = registry.getTransformData(td.getClassName());\n+\tprivate void add(TransformDescriptor td) {\n+\t\tList<TransformDescriptor> transformDataList = transformData.get(td.getClassName());\n@@ -184,1 +184,1 @@\n-\t\t\tregistry.transformData.put(td.getClassName(), transformDataList);\n+\t\t\ttransformData.put(td.getClassName(), transformDataList);\n@@ -457,1 +457,2 @@\n-\t\treturn transformData.get(className);\n+\t\tList<TransformDescriptor> data = transformData.get(className);\n+\t\treturn data != null ? data : Collections.emptyList();\n@@ -485,0 +486,1 @@\n+\t@Override\n@@ -504,1 +506,1 @@\n-\t\t\t\t\t\t\tadd(this, td);\n+\t\t\t\t\t\t\tadd(td);\n@@ -531,0 +533,1 @@\n+\t@Override\n@@ -541,0 +544,1 @@\n+\t@Override\n@@ -545,0 +549,1 @@\n+\t@Override\n@@ -549,0 +554,1 @@\n+\t@Override\n@@ -553,0 +559,1 @@\n+\t@Override\n@@ -557,0 +564,1 @@\n+\t@Override\n","filename":"agent\/src\/main\/java\/org\/openjdk\/jmc\/agent\/impl\/DefaultTransformRegistry.java","additions":21,"deletions":13,"binary":false,"changes":34,"status":"modified"},{"patch":"@@ -2,2 +2,2 @@\n- * Copyright (c) 2018, Oracle and\/or its affiliates. All rights reserved.\n- * \n+ * Copyright (c) 2018, 2020, Oracle and\/or its affiliates. All rights reserved.\n+ *\n@@ -13,1 +13,1 @@\n- * \n+ *\n@@ -16,1 +16,1 @@\n- * \n+ *\n@@ -20,1 +20,1 @@\n- * \n+ *\n@@ -23,1 +23,1 @@\n- * \n+ *\n@@ -138,1 +138,1 @@\n-\t\tassertTrue(classesCleared.size() == 1);\n+\t\tassertEquals(1, classesCleared.size());\n@@ -140,1 +140,1 @@\n-\t\tassertNull(registry.getTransformData(Type.getInternalName(InstrumentMe.class)));\n+\t\tassertEquals(0, registry.getTransformData(Type.getInternalName(InstrumentMe.class)).size());\n","filename":"agent\/src\/test\/java\/org\/openjdk\/jmc\/agent\/test\/TestDefaultTransformRegistry.java","additions":8,"deletions":8,"binary":false,"changes":16,"status":"modified"}]}