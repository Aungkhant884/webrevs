{"files":[{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2020, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2020, 2023, Oracle and\/or its affiliates. All rights reserved.\n@@ -36,0 +36,1 @@\n+import java.util.Iterator;\n@@ -43,1 +44,0 @@\n-import org.openjdk.jmc.common.util.StringToolkit;\n@@ -101,2 +101,27 @@\n-\t\t\t\t\t\t\tString joined = StringToolkit.join(results, \",\"); \/\/$NON-NLS-1$\n-\t\t\t\t\t\t\ts = s.replace(group, encodeIfNeeded(joined, withHtml));\n+\t\t\t\t\t\t\tStringBuilder collection = new StringBuilder();\n+\n+\t\t\t\t\t\t\tIterator<?> iter = results.iterator();\n+\t\t\t\t\t\t\twhile (iter.hasNext()) {\n+\t\t\t\t\t\t\t\tObject typedResultInstance = iter.next();\n+\t\t\t\t\t\t\t\tif (typedResultInstance instanceof IDisplayable) {\n+\t\t\t\t\t\t\t\t\tcollection.append(encodeIfNeeded(\n+\t\t\t\t\t\t\t\t\t\t\t((IDisplayable) typedResultInstance).displayUsing(IDisplayable.AUTO),\n+\t\t\t\t\t\t\t\t\t\t\twithHtml));\n+\t\t\t\t\t\t\t\t} else if (typedResultInstance instanceof IMCFrame) {\n+\t\t\t\t\t\t\t\t\tcollection.append(encodeIfNeeded(StacktraceFormatToolkit\n+\t\t\t\t\t\t\t\t\t\t\t.formatFrame((IMCFrame) typedResultInstance, DEFAULT_SEPARATOR), withHtml));\n+\t\t\t\t\t\t\t\t} else if (typedResultInstance instanceof IMCStackTrace) {\n+\t\t\t\t\t\t\t\t\tcollection.append(encodeIfNeeded(\n+\t\t\t\t\t\t\t\t\t\t\tFormatToolkit.getHumanReadable((IMCStackTrace) typedResultInstance),\n+\t\t\t\t\t\t\t\t\t\t\twithHtml));\n+\t\t\t\t\t\t\t\t} else {\n+\t\t\t\t\t\t\t\t\tcollection\n+\t\t\t\t\t\t\t\t\t\t\t.append(encodeIfNeeded(typedResult.format(typedResultInstance), withHtml));\n+\t\t\t\t\t\t\t\t}\n+\n+\t\t\t\t\t\t\t\tif (!iter.hasNext()) {\n+\t\t\t\t\t\t\t\t\tbreak;\n+\t\t\t\t\t\t\t\t}\n+\t\t\t\t\t\t\t\tcollection.append(\",\");\n+\t\t\t\t\t\t\t}\n+\t\t\t\t\t\t\ts = s.replace(group, collection.toString());\n","filename":"core\/org.openjdk.jmc.flightrecorder.rules\/src\/main\/java\/org\/openjdk\/jmc\/flightrecorder\/rules\/ResultToolkit.java","additions":29,"deletions":4,"binary":false,"changes":33,"status":"modified"}]}