{"files":[{"patch":"@@ -64,1 +64,1 @@\n-        java-version: '11.0.18'\n+        java-version: '17'\n","filename":".github\/workflows\/validate.yml","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -41,0 +41,1 @@\n+import java.util.ArrayList;\n@@ -54,0 +55,1 @@\n+import org.openjdk.jmc.common.version.JavaVersionSupport;\n@@ -69,0 +71,1 @@\n+import org.openjdk.jmc.rjmx.ConnectionToolkit;\n@@ -90,1 +93,1 @@\n-\t\t\t\tpropertyRoots, \"root\");\n+\t\t\t\tremoveUnsupportedRootNodes(propertyRoots), \"root\");\n@@ -105,1 +108,1 @@\n-\t\t\t\t\t\"org\", \"IN_CONFIGURATION\"), propertyRoots, \"root\");\n+\t\t\t\t\t\"org\", \"IN_CONFIGURATION\"), removeUnsupportedRootNodes(propertyRoots), \"root\");\n@@ -116,1 +119,1 @@\n-\t\t\t\tpropertyRoots, \"root\");\n+\t\t\t\tremoveUnsupportedRootNodes(propertyRoots), \"root\");\n@@ -125,1 +128,1 @@\n-\t\t\t\tpropertyRoots, \"root\");\n+\t\t\t\tremoveUnsupportedRootNodes(propertyRoots), \"root\");\n@@ -149,1 +152,2 @@\n-\t\t\/\/ FIXME: Should we include extraTestOption and enabledButWrongForTest here, with either IN_CONFIGURATION style, or some new disabled\/error style?\n+\t\t\/\/ FIXME: Should we include extraTestOption and enabledButWrongForTest here,\n+\t\t\/\/ with either IN_CONFIGURATION style, or some new disabled\/error style?\n@@ -151,1 +155,2 @@\n-\t\tassertOptions(threadAllocation, Arrays.asList(\"Enabled\", \"IN_BOTH\", \"Period\", \"IN_BOTH\")); \/\/ \"extraTestOption\", \"IN_CONFIGURATION\"\n+\t\tassertOptions(threadAllocation, Arrays.asList(\"Enabled\", \"IN_BOTH\", \"Period\", \"IN_BOTH\")); \/\/ \"extraTestOption\",\n+\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\/\/ \"IN_CONFIGURATION\"\n@@ -154,1 +159,2 @@\n-\t\tassertOptions(classLoadingStatistics, Arrays.asList(\"Period\", \"IN_BOTH\", \"Enabled\", \"IN_BOTH\")); \/\/ \"enabledButWrongForTest\", \"IN_CONFIGURATION\"\n+\t\tassertOptions(classLoadingStatistics, Arrays.asList(\"Period\", \"IN_BOTH\", \"Enabled\", \"IN_BOTH\")); \/\/ \"enabledButWrongForTest\",\n+\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\/\/ \"IN_CONFIGURATION\"\n@@ -187,1 +193,2 @@\n-\t\t\/\/ FIXME: Should we include extraTestOption and enabledButWrongForTest here, with either IN_CONFIGURATION style, or some new disabled\/error style?\n+\t\t\/\/ FIXME: Should we include extraTestOption and enabledButWrongForTest here,\n+\t\t\/\/ with either IN_CONFIGURATION style, or some new disabled\/error style?\n@@ -189,1 +196,2 @@\n-\t\tassertOptions(threadAllocation, Arrays.asList(\"Enabled\", \"IN_BOTH\", \"Period\", \"IN_BOTH\")); \/\/ \"extraTestOption\", \"IN_CONFIGURATION\"\n+\t\tassertOptions(threadAllocation, Arrays.asList(\"Enabled\", \"IN_BOTH\", \"Period\", \"IN_BOTH\")); \/\/ \"extraTestOption\",\n+\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\/\/ \"IN_CONFIGURATION\"\n@@ -192,1 +200,2 @@\n-\t\tassertOptions(classLoadingStatistics, Arrays.asList(\"Period\", \"IN_BOTH\", \"Enabled\", \"IN_SERVER\")); \/\/ \"enabledButWrongForTest\", \"IN_CONFIGURATION\"\n+\t\tassertOptions(classLoadingStatistics, Arrays.asList(\"Period\", \"IN_BOTH\", \"Enabled\", \"IN_SERVER\")); \/\/ \"enabledButWrongForTest\",\n+\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\/\/ \"IN_CONFIGURATION\"\n@@ -244,0 +253,5 @@\n+\t\tString[] expected = new String[] {\"Enabled\", \"Period\", \"Stack Trace\", \"Threshold\"};\n+\t\tif (ConnectionToolkit.isJavaVersionAboveOrEqual(getConnectionHandle(), JavaVersionSupport.JDK_16)) {\n+\t\t\t\/\/ probably related to https:\/\/bugs.openjdk.java.net\/browse\/JDK-8257602\n+\t\t\texpected = new String[] {\"Enabled\", \"Event Emission Throttle\", \"Period\", \"Stack Trace\", \"Threshold\"};\n+\t\t}\n@@ -245,1 +259,1 @@\n-\t\t\t\tnew String[] {\"Enabled\", \"Period\", \"Stack Trace\", \"Threshold\"}, props.toArray());\n+\t\t\t\texpected, props.toArray());\n@@ -290,1 +304,2 @@\n-\t\/\/ TODO: Add more tests: Other categories, labels, descriptions, option label and descriptions, content types.\n+\t\/\/ TODO: Add more tests: Other categories, labels, descriptions, option label\n+\t\/\/ and descriptions, content types.\n@@ -321,0 +336,12 @@\n+\tprivate <T extends PathElement> Collection<T> removeUnsupportedRootNodes(Collection<T> actualNodes) {\n+\t\tList<T> res = new ArrayList<T>();\n+\t\tfor (T pathElement : actualNodes) {\n+\t\t\tif (!pathElement.getName().equals(\"jdk\")) {\n+\t\t\t\t\/\/ jdk named root nodes are related to nodes that are not supported in newer\n+\t\t\t\t\/\/ JDKs like jdk.SafepointWaitBlocked (removed in JDK 13)\n+\t\t\t\tres.add(pathElement);\n+\t\t\t}\n+\t\t}\n+\t\treturn res;\n+\t}\n+\n@@ -338,1 +365,1 @@\n-\t\t\t\tactualNodesNames.containsAll(expectedNodesNames) && expectedNodesNames.containsAll(actualNodesNames));\n+\t\t\t\tactualNodesNames.containsAll(expectedNodesNames));\n","filename":"application\/tests\/org.openjdk.jmc.flightrecorder.controlpanel.ui.test\/src\/test\/java\/org\/openjdk\/jmc\/flightrecorder\/controlpanel\/ui\/test\/PropertyContentBuilderTest.java","additions":40,"deletions":13,"binary":false,"changes":53,"status":"modified"},{"patch":"@@ -37,2 +37,2 @@\n-import java.text.SimpleDateFormat;\n-import java.util.Date;\n+import java.time.Instant;\n+import java.time.format.DateTimeFormatter;\n@@ -55,2 +55,0 @@\n-\tprivate static final SimpleDateFormat FORMATTER = new SimpleDateFormat(\"HH:mm:ss\");\n-\n@@ -67,0 +65,3 @@\n+\n+\t\tDateTimeFormatter dateTimeFormatter = DateTimeFormatter.ofPattern(\"HH:mm:ss\");\n+\n@@ -71,1 +72,1 @@\n-\t\t\t\treturn FORMATTER.format(new Date(value.longValue()));\n+\t\t\t\treturn dateTimeFormatter.format(Instant.ofEpochMilli(value.longValue()));\n","filename":"application\/tests\/org.openjdk.jmc.greychart.test\/src\/test\/java\/org\/openjdk\/jmc\/greychart\/testutil\/GreyChartPanelTester.java","additions":6,"deletions":5,"binary":false,"changes":11,"status":"modified"},{"patch":"@@ -67,0 +67,5 @@\n+\tpublic static final JavaVersion JDK_13 = new JavaVersion(13, 0);\n+\tpublic static final JavaVersion JDK_14 = new JavaVersion(14, 0);\n+\tpublic static final JavaVersion JDK_15 = new JavaVersion(15, 0);\n+\tpublic static final JavaVersion JDK_16 = new JavaVersion(16, 0);\n+\tpublic static final JavaVersion JDK_17 = new JavaVersion(17, 0);\n","filename":"core\/org.openjdk.jmc.common\/src\/main\/java\/org\/openjdk\/jmc\/common\/version\/JavaVersionSupport.java","additions":5,"deletions":0,"binary":false,"changes":5,"status":"modified"},{"patch":"@@ -20,1 +20,1 @@\n-Next set up your JDKs in your Eclipse. Download and install a JDK 8 and JDK 11 (or the very latest update of the latest JDK), then open _Window | Preferences_ and then select _Java \/ Installed JREs_. Add your favourite JKD 8 and JDK 11 JDKs (_Add…_) and then use _Java \/ Installed JREs \/ Execution Environments_ to set them as defaults for the JDK 8 and JDK 11 execution environments.\n+Next set up your JDKs in your Eclipse. Download and install a JDK 17 distribution, then open _Window | Preferences_ and then select _Java \/ Installed JREs_. Add your favourite JDK 17 (_Add…_) and then use _Java \/ Installed JREs \/ Execution Environments_ to set them as defaults for the JDK 17 execution environments.\n@@ -30,2 +30,2 @@\n-Ensure Eclipse compiler is set to Java 11, go to _Preferences | Java \/ Compiler_ then for\n-_Compiler compliance level_ choose `11`.\n+Ensure Eclipse compiler is set to Java 17, go to _Preferences | Java \/ Compiler_ then for\n+_Compiler compliance level_ choose `17`.\n@@ -86,1 +86,3 @@\n-For dynamic working sets, see http:\/\/hirt.se\/blog\/?p=1149.\n\\ No newline at end of file\n+For dynamic working sets, see http:\/\/hirt.se\/blog\/?p=1149.\n+\n+For testing: Run all tests as \"JUnit Plugin-In Test\" tests in eclipse and use the scripts in the `scripts` folder for running the tests. Run the class `org.openjdk.jmc.rjmx.test.testutil.JVMKeepAlive` with the VM arguments `-Dcom.sun.management.jmxremote.port=7091 -Dcom.sun.management.jmxremote.authenticate=false -Dcom.sun.management.jmxremote.ssl=false` alongside.\n","filename":"docs\/devguide\/README.md","additions":6,"deletions":4,"binary":false,"changes":10,"status":"modified"}]}