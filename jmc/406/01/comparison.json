{"files":[{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2018, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2018, 2022, Oracle and\/or its affiliates. All rights reserved.\n@@ -35,0 +35,3 @@\n+import java.util.regex.Matcher;\n+import java.util.regex.Pattern;\n+\n@@ -81,0 +84,8 @@\n+\n+\tpublic static boolean isPasswordValid(final String password) {\n+\t\tPattern PASSWORD_PATTERN = Pattern\n+\t\t\t\t.compile(\"^(?=.*[0-9])(?=.*[a-z])(?=.*[A-Z])(?=.*[!@#(&)[{-}]:;',?\/*~$^+=<>]).{8,20}$\"); \/\/$NON-NLS-1$\n+\n+\t\tMatcher matcher = PASSWORD_PATTERN.matcher(password);\n+\t\treturn matcher.matches();\n+\t}\n","filename":"application\/org.openjdk.jmc.ui.common\/src\/main\/java\/org\/openjdk\/jmc\/ui\/common\/security\/PersistentCredentials.java","additions":12,"deletions":1,"binary":false,"changes":13,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2018, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2018, 2022, Oracle and\/or its affiliates. All rights reserved.\n@@ -35,0 +35,3 @@\n+import java.util.regex.Matcher;\n+import java.util.regex.Pattern;\n+\n@@ -48,0 +51,1 @@\n+import org.openjdk.jmc.ui.common.security.PersistentCredentials;\n@@ -61,1 +65,0 @@\n-\tprivate static final int MIN_PASSWORD_LENGTH = 5;\n@@ -151,4 +154,2 @@\n-\t\tif (passwordField.getText().length() < MIN_PASSWORD_LENGTH) {\n-\t\t\tsetErrorMessage(\n-\t\t\t\t\tNLS.bind(Messages.MasterPasswordWizardPage_ERROR_MESSAGE_PASSWORD_SHORTER_THAN_X_CHARACTERS_TEXT,\n-\t\t\t\t\t\t\tMIN_PASSWORD_LENGTH));\n+\t\tif (!PersistentCredentials.isPasswordValid(passwordField.getText())) {\n+\t\t\tsetErrorMessage(Messages.MasterPasswordWizardPage_ERROR_MESSAGE_PASSWORD_VALIDATION_FAILED);\n","filename":"application\/org.openjdk.jmc.ui\/src\/main\/java\/org\/openjdk\/jmc\/ui\/security\/MasterPasswordWizardPage.java","additions":7,"deletions":6,"binary":false,"changes":13,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2018, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2018, 2022, Oracle and\/or its affiliates. All rights reserved.\n@@ -45,1 +45,1 @@\n-\tpublic static String MasterPasswordWizardPage_ERROR_MESSAGE_PASSWORD_SHORTER_THAN_X_CHARACTERS_TEXT;\n+\tpublic static String MasterPasswordWizardPage_ERROR_MESSAGE_PASSWORD_VALIDATION_FAILED;\n","filename":"application\/org.openjdk.jmc.ui\/src\/main\/java\/org\/openjdk\/jmc\/ui\/security\/Messages.java","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n-#  Copyright (c) 2018, Oracle and\/or its affiliates. All rights reserved.\n+#  Copyright (c) 2018, 2022, Oracle and\/or its affiliates. All rights reserved.\n@@ -43,1 +43,1 @@\n-MasterPasswordWizardPage_ERROR_MESSAGE_PASSWORD_SHORTER_THAN_X_CHARACTERS_TEXT=Passwords must be at least {0} characters!\n+MasterPasswordWizardPage_ERROR_MESSAGE_PASSWORD_VALIDATION_FAILED=Password must contain at least one lowercase character, one uppercase character, one digit, one special character, and a length between 8 to 20.\n","filename":"application\/org.openjdk.jmc.ui\/src\/main\/resources\/org\/openjdk\/jmc\/ui\/security\/messages.properties","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -0,0 +1,59 @@\n+\/*\n+ * Copyright (c) 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * \n+ * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+ *\n+ * The contents of this file are subject to the terms of either the Universal Permissive License\n+ * v 1.0 as shown at http:\/\/oss.oracle.com\/licenses\/upl\n+ *\n+ * or the following license:\n+ *\n+ * Redistribution and use in source and binary forms, with or without modification, are permitted\n+ * provided that the following conditions are met:\n+ * \n+ * 1. Redistributions of source code must retain the above copyright notice, this list of conditions\n+ * and the following disclaimer.\n+ * \n+ * 2. Redistributions in binary form must reproduce the above copyright notice, this list of\n+ * conditions and the following disclaimer in the documentation and\/or other materials provided with\n+ * the distribution.\n+ * \n+ * 3. Neither the name of the copyright holder nor the names of its contributors may be used to\n+ * endorse or promote products derived from this software without specific prior written permission.\n+ * \n+ * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\" AND ANY EXPRESS OR\n+ * IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n+ * FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR\n+ * CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL\n+ * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n+ * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,\n+ * WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY\n+ * WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n+ *\/\n+package org.openjdk.jmc.ui.test.security;\n+\n+import org.junit.Test;\n+import static org.junit.Assert.assertFalse;\n+import static org.junit.Assert.assertTrue;\n+\n+import org.openjdk.jmc.ui.common.security.PersistentCredentials;\n+\n+@SuppressWarnings(\"nls\")\n+public class MasterPasswordTest {\n+\n+\tprivate final String invalidPwdValue = \"Jmc20\";\n+\tprivate final String validPwdValue = \"Jmc@2022\";\n+\n+\t@Test\n+\tpublic void testInvalidMasterPassword() throws Exception {\n+\t\tboolean result = PersistentCredentials.isPasswordValid(invalidPwdValue);\n+\t\tassertFalse(result);\n+\t}\n+\n+\t@Test\n+\tpublic void testValidMasterPassword() throws Exception {\n+\t\tboolean result = PersistentCredentials.isPasswordValid(validPwdValue);\n+\t\tassertTrue(result);\n+\t}\n+\n+}\n","filename":"application\/tests\/org.openjdk.jmc.ui.test\/src\/test\/java\/org\/openjdk\/jmc\/ui\/test\/security\/MasterPasswordTest.java","additions":59,"deletions":0,"binary":false,"changes":59,"status":"added"}]}