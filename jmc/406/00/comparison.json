{"files":[{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2018, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2018, 2022, Oracle and\/or its affiliates. All rights reserved.\n@@ -35,0 +35,3 @@\n+import java.util.regex.Matcher;\n+import java.util.regex.Pattern;\n+\n@@ -61,1 +64,0 @@\n-\tprivate static final int MIN_PASSWORD_LENGTH = 5;\n@@ -65,0 +67,3 @@\n+\tprivate static final Pattern PASSWORD_PATTERN = Pattern\n+\t\t\t.compile(\"^(?=.*[0-9])(?=.*[a-z])(?=.*[A-Z])(?=.*[!@#(&)[{-}]:;',?\/*~$^+=<>]).{8,20}$\"); \/\/$NON-NLS-1$\n+\n@@ -151,4 +156,2 @@\n-\t\tif (passwordField.getText().length() < MIN_PASSWORD_LENGTH) {\n-\t\t\tsetErrorMessage(\n-\t\t\t\t\tNLS.bind(Messages.MasterPasswordWizardPage_ERROR_MESSAGE_PASSWORD_SHORTER_THAN_X_CHARACTERS_TEXT,\n-\t\t\t\t\t\t\tMIN_PASSWORD_LENGTH));\n+\t\tif (!isValid(passwordField.getText())) {\n+\t\t\tsetErrorMessage(Messages.MasterPasswordWizardPage_ERROR_MESSAGE_PASSWORD_VALIDATION_FAILED);\n@@ -167,0 +170,5 @@\n+\tpublic static boolean isValid(final String password) {\n+\t\tMatcher matcher = PASSWORD_PATTERN.matcher(password);\n+\t\treturn matcher.matches();\n+\t}\n+\n","filename":"application\/org.openjdk.jmc.ui\/src\/main\/java\/org\/openjdk\/jmc\/ui\/security\/MasterPasswordWizardPage.java","additions":14,"deletions":6,"binary":false,"changes":20,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2018, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2018, 2022, Oracle and\/or its affiliates. All rights reserved.\n@@ -45,1 +45,1 @@\n-\tpublic static String MasterPasswordWizardPage_ERROR_MESSAGE_PASSWORD_SHORTER_THAN_X_CHARACTERS_TEXT;\n+\tpublic static String MasterPasswordWizardPage_ERROR_MESSAGE_PASSWORD_VALIDATION_FAILED;\n","filename":"application\/org.openjdk.jmc.ui\/src\/main\/java\/org\/openjdk\/jmc\/ui\/security\/Messages.java","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n-#  Copyright (c) 2018, Oracle and\/or its affiliates. All rights reserved.\n+#  Copyright (c) 2018, 2022, Oracle and\/or its affiliates. All rights reserved.\n@@ -43,1 +43,1 @@\n-MasterPasswordWizardPage_ERROR_MESSAGE_PASSWORD_SHORTER_THAN_X_CHARACTERS_TEXT=Passwords must be at least {0} characters!\n+MasterPasswordWizardPage_ERROR_MESSAGE_PASSWORD_VALIDATION_FAILED=Password must contain at least one lowercase character, one uppercase character, one digit, one special character, and a length between 8 to 20.\n","filename":"application\/org.openjdk.jmc.ui\/src\/main\/resources\/org\/openjdk\/jmc\/ui\/security\/messages.properties","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"}]}