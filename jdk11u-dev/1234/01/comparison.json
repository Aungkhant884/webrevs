{"files":[{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 1998, 2018, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 1998, 2020, Oracle and\/or its affiliates. All rights reserved.\n@@ -66,1 +66,1 @@\n-    int codepage;\n+    int codepage = 0;\n@@ -72,1 +72,4 @@\n-    if (GetLocaleInfo(lcid,\n+    if (lcid == 0) { \/\/ for sun.jnu.encoding\n+        codepage = GetACP();\n+        _itoa_s(codepage, ret + 2, 14, 10);\n+    } else if (GetLocaleInfo(lcid,\n@@ -74,4 +77,2 @@\n-                      ret+2, 14) == 0) {\n-        codepage = 1252;\n-    } else {\n-        codepage = atoi(ret+2);\n+                      ret + 2, 14) != 0) {\n+        codepage = atoi(ret + 2);\n@@ -82,0 +83,1 @@\n+    case 65001:\n@@ -148,0 +150,2 @@\n+    else if (cp == 65001)\n+        sprintf(buf, \"UTF-8\");\n@@ -668,2 +672,2 @@\n-        LCID systemDefaultLCID = GetSystemDefaultLCID();\n-        LCID userDefaultUILang = GetUserDefaultUILanguage();\n+        LANGID userDefaultUILang = GetUserDefaultUILanguage();\n+        LCID userDefaultUILCID = MAKELCID(userDefaultUILang, SORTIDFROMLCID(userDefaultLCID));\n@@ -683,2 +687,2 @@\n-                PRIMARYLANGID(LANGIDFROMLCID(userDefaultUILang))) {\n-                userDefaultUILang = userDefaultLCID;\n+                PRIMARYLANGID(userDefaultUILang)) {\n+                userDefaultUILCID = userDefaultLCID;\n@@ -699,1 +703,1 @@\n-            SetupI18nProps(userDefaultUILang,\n+            SetupI18nProps(userDefaultUILCID,\n@@ -706,1 +710,4 @@\n-            sprops.sun_jnu_encoding = getEncodingInternal(systemDefaultLCID);\n+            sprops.sun_jnu_encoding = getEncodingInternal(0);\n+            if (sprops.sun_jnu_encoding == NULL) {\n+                sprops.sun_jnu_encoding = \"UTF-8\";\n+            }\n","filename":"src\/java.base\/windows\/native\/libjava\/java_props_md.c","additions":20,"deletions":13,"binary":false,"changes":33,"status":"modified"}]}