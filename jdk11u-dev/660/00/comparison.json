{"files":[{"patch":"@@ -127,1 +127,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB3(SetTag, jvmti, obj, threadTag))) {\n+    if (!NSK_JVMTI_VERIFY(jvmti->SetTag(obj, threadTag))) {\n@@ -156,4 +156,1 @@\n-                NSK_CPP_STUB4(GetStaticFieldID, jni,\n-                                                debugeeClass,\n-                                                \"thread\",\n-                                                THREAD_CLS_SIGNATURE)) != NULL )) {\n+                jni->GetStaticFieldID(debugeeClass, \"thread\", THREAD_CLS_SIGNATURE)) != NULL)) {\n@@ -165,3 +162,1 @@\n-                NSK_CPP_STUB3(GetStaticObjectField, jni,\n-                                                    debugeeClass,\n-                                                    fid )) != NULL )) {\n+                jni->GetStaticObjectField(debugeeClass, fid)) != NULL)) {\n@@ -173,2 +168,1 @@\n-        if (!NSK_JNI_VERIFY(jni, (globalRefThread =\n-                 NSK_CPP_STUB2(NewGlobalRef, jni, localRefThread)) != NULL))\n+        if (!NSK_JNI_VERIFY(jni, (globalRefThread = jni->NewGlobalRef(localRefThread)) != NULL))\n@@ -178,6 +172,4 @@\n-        if (!NSK_JVMTI_VERIFY(\n-                NSK_CPP_STUB5(IterateOverReachableObjects, jvmti,\n-                                                           heapRootCallback,\n-                                                           stackReferenceCallback,\n-                                                           objectReferenceCallback,\n-                                                           NULL \/*user_data*\/))) {\n+        if (!NSK_JVMTI_VERIFY(jvmti->IterateOverReachableObjects(heapRootCallback,\n+                                                                 stackReferenceCallback,\n+                                                                 objectReferenceCallback,\n+                                                                 NULL \/*user_data*\/))) {\n@@ -237,2 +229,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(AddCapabilities,\n-            jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->AddCapabilities(&caps)))\n@@ -241,2 +232,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(GetCapabilities,\n-            jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->GetCapabilities(&caps)))\n","filename":"test\/hotspot\/jtreg\/vmTestbase\/nsk\/jvmti\/scenarios\/allocation\/AP06\/ap06t001\/ap06t001.cpp","additions":10,"deletions":20,"binary":false,"changes":30,"status":"modified"},{"patch":"@@ -114,1 +114,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB3(SetTag, jvmti, target, tag))) {\n+    if (!NSK_JVMTI_VERIFY(jvmti->SetTag(target, tag))) {\n@@ -121,2 +121,1 @@\n-    if (!NSK_JNI_VERIFY(jni, (root =\n-            NSK_CPP_STUB2(NewGlobalRef, jni, obj)) != NULL))\n+    if (!NSK_JNI_VERIFY(jni, (root = jni->NewGlobalRef(obj)) != NULL))\n@@ -138,6 +137,4 @@\n-        if (!NSK_JVMTI_VERIFY(\n-                NSK_CPP_STUB5(IterateOverReachableObjects, jvmti,\n-                                                           heapRootCallback,\n-                                                           stackReferenceCallback,\n-                                                           objectReferenceCallback,\n-                                                           NULL \/*user_data*\/))) {\n+        if (!NSK_JVMTI_VERIFY(jvmti->IterateOverReachableObjects(heapRootCallback,\n+                                                                 stackReferenceCallback,\n+                                                                 objectReferenceCallback,\n+                                                                 NULL \/*user_data*\/))) {\n@@ -150,6 +147,2 @@\n-            if (!NSK_JVMTI_VERIFY(\n-                    NSK_CPP_STUB4(IterateOverObjectsReachableFromObject,\n-                        jvmti,\n-                        root,\n-                        objectReferenceCallback,\n-                        NULL \/*user_data*\/))) {\n+            if (!NSK_JVMTI_VERIFY(jvmti->IterateOverObjectsReachableFromObject(\n+                    root, objectReferenceCallback, NULL \/*user_data*\/))) {\n@@ -161,1 +154,1 @@\n-        NSK_TRACE(NSK_CPP_STUB2(DeleteGlobalRef, jni, root));\n+        NSK_TRACE(jni->DeleteGlobalRef(root));\n@@ -194,2 +187,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(AddCapabilities,\n-            jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->AddCapabilities(&caps)))\n@@ -198,2 +190,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(GetCapabilities,\n-            jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->GetCapabilities(&caps)))\n","filename":"test\/hotspot\/jtreg\/vmTestbase\/nsk\/jvmti\/scenarios\/allocation\/AP07\/ap07t001\/ap07t001.cpp","additions":11,"deletions":20,"binary":false,"changes":31,"status":"modified"},{"patch":"@@ -114,1 +114,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB3(SetTag, jvmti, target, tag))) {\n+    if (!NSK_JVMTI_VERIFY(jvmti->SetTag(target, tag))) {\n@@ -131,6 +131,4 @@\n-        if (!NSK_JVMTI_VERIFY(\n-                NSK_CPP_STUB5(IterateOverReachableObjects, jvmti,\n-                                                           heapRootCallback,\n-                                                           stackReferenceCallback,\n-                                                           objectReferenceCallback,\n-                                                           NULL \/*user_data*\/))) {\n+        if (!NSK_JVMTI_VERIFY(jvmti->IterateOverReachableObjects(heapRootCallback,\n+                                                                 stackReferenceCallback,\n+                                                                 objectReferenceCallback,\n+                                                                 NULL \/*user_data*\/))) {\n@@ -172,2 +170,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(AddCapabilities,\n-            jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->AddCapabilities(&caps)))\n@@ -176,2 +173,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(GetCapabilities,\n-            jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->GetCapabilities(&caps)))\n","filename":"test\/hotspot\/jtreg\/vmTestbase\/nsk\/jvmti\/scenarios\/allocation\/AP07\/ap07t002\/ap07t002.cpp","additions":7,"deletions":11,"binary":false,"changes":18,"status":"modified"},{"patch":"@@ -135,1 +135,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB3(SetTag, jvmti, target, tag))) {\n+    if (!NSK_JVMTI_VERIFY(jvmti->SetTag(target, tag))) {\n@@ -142,2 +142,1 @@\n-    if (!NSK_JNI_VERIFY(jni, (referrer =\n-            NSK_CPP_STUB2(NewGlobalRef, jni, ref)) != NULL))\n+    if (!NSK_JNI_VERIFY(jni, (referrer = jni->NewGlobalRef(ref)) != NULL))\n@@ -158,6 +157,3 @@\n-        if (!NSK_JVMTI_VERIFY(\n-                NSK_CPP_STUB4(IterateOverObjectsReachableFromObject,\n-                    jvmti,\n-                    referrer,\n-                    objectReferenceCallback,\n-                    NULL \/*user_data*\/))) {\n+        if (!NSK_JVMTI_VERIFY(jvmti->IterateOverObjectsReachableFromObject(referrer,\n+                                                                           objectReferenceCallback,\n+                                                                           NULL \/*user_data*\/))) {\n@@ -195,1 +191,1 @@\n-        NSK_TRACE(NSK_CPP_STUB2(DeleteGlobalRef, jni, referrer));\n+        NSK_TRACE(jni->DeleteGlobalRef(referrer));\n@@ -227,2 +223,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(AddCapabilities,\n-            jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->AddCapabilities(&caps)))\n@@ -231,2 +226,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(GetCapabilities,\n-            jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->GetCapabilities(&caps)))\n","filename":"test\/hotspot\/jtreg\/vmTestbase\/nsk\/jvmti\/scenarios\/allocation\/AP09\/ap09t001\/ap09t001.cpp","additions":8,"deletions":14,"binary":false,"changes":22,"status":"modified"},{"patch":"@@ -64,2 +64,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(SetEnvironmentLocalStorage,\n-            jvmti_env, (const void*) &stor))) {\n+    if (!NSK_JVMTI_VERIFY(jvmti_env->SetEnvironmentLocalStorage((const void*) &stor))) {\n@@ -74,2 +73,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(GetEnvironmentLocalStorage,\n-            jvmti_env, (void**) &obtainedData))) {\n+    if (!NSK_JVMTI_VERIFY(jvmti_env->GetEnvironmentLocalStorage((void**) &obtainedData))) {\n@@ -92,2 +90,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-            NSK_CPP_STUB2(GetCurrentThreadCpuTimerInfo, jvmti_env, &timer_info1 ))) {\n+    if (!NSK_JVMTI_VERIFY(jvmti_env->GetCurrentThreadCpuTimerInfo(&timer_info1))) {\n@@ -116,2 +113,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-            NSK_CPP_STUB2(GetCurrentThreadCpuTime, jvmti_env, &nanos ))) {\n+    if (!NSK_JVMTI_VERIFY(jvmti_env->GetCurrentThreadCpuTime(&nanos))) {\n@@ -125,2 +121,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-            NSK_CPP_STUB2(GetTimerInfo, jvmti_env, &timer_info2 ))) {\n+    if (!NSK_JVMTI_VERIFY(jvmti_env->GetTimerInfo(&timer_info2))) {\n@@ -150,2 +145,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-            NSK_CPP_STUB2(GetTime, jvmti_env, &nanos ))) {\n+    if (!NSK_JVMTI_VERIFY(jvmti_env->GetTime(&nanos))) {\n@@ -225,4 +219,3 @@\n-        if (!NSK_JVMTI_VERIFY(\n-                NSK_CPP_STUB4(IterateOverHeap, jvmti,\n-                    JVMTI_HEAP_OBJECT_UNTAGGED, heapObjectCallback,\n-                    &user_data))) {\n+        if (!NSK_JVMTI_VERIFY(jvmti->IterateOverHeap(JVMTI_HEAP_OBJECT_UNTAGGED,\n+                                                     heapObjectCallback,\n+                                                     &user_data))) {\n@@ -278,2 +271,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(AddCapabilities,\n-            jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->AddCapabilities(&caps)))\n@@ -282,2 +274,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(GetCapabilities,\n-            jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->GetCapabilities(&caps)))\n@@ -301,2 +292,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB3(SetEventCallbacks,\n-            jvmti, &callbacks, sizeof(callbacks))))\n+    if (!NSK_JVMTI_VERIFY(jvmti->SetEventCallbacks(&callbacks, sizeof(callbacks))))\n@@ -306,2 +296,3 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB4(SetEventNotificationMode,\n-            jvmti, JVMTI_ENABLE, JVMTI_EVENT_GARBAGE_COLLECTION_START, NULL)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->SetEventNotificationMode(JVMTI_ENABLE,\n+                                                          JVMTI_EVENT_GARBAGE_COLLECTION_START,\n+                                                          NULL)))\n@@ -309,2 +300,3 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB4(SetEventNotificationMode,\n-            jvmti, JVMTI_ENABLE, JVMTI_EVENT_GARBAGE_COLLECTION_FINISH, NULL)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->SetEventNotificationMode(JVMTI_ENABLE,\n+                                                          JVMTI_EVENT_GARBAGE_COLLECTION_FINISH,\n+                                                          NULL)))\n@@ -312,2 +304,3 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB4(SetEventNotificationMode,\n-            jvmti, JVMTI_ENABLE, JVMTI_EVENT_OBJECT_FREE, NULL)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->SetEventNotificationMode(JVMTI_ENABLE,\n+                                                          JVMTI_EVENT_OBJECT_FREE,\n+                                                          NULL)))\n","filename":"test\/hotspot\/jtreg\/vmTestbase\/nsk\/jvmti\/scenarios\/allocation\/AP10\/ap10t001\/ap10t001.cpp","additions":21,"deletions":28,"binary":false,"changes":49,"status":"modified"},{"patch":"@@ -46,2 +46,1 @@\n-        if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB4(GetClassSignature, jvmti,\n-                classes[i], &signature, &generic)))\n+        if (!NSK_JVMTI_VERIFY(jvmti->GetClassSignature(classes[i], &signature, &generic)))\n@@ -55,1 +54,1 @@\n-            NSK_CPP_STUB2(Deallocate, jvmti, (unsigned char*)signature);\n+            jvmti->Deallocate((unsigned char*)signature);\n@@ -58,1 +57,1 @@\n-            NSK_CPP_STUB2(Deallocate, jvmti, (unsigned char*)generic);\n+            jvmti->Deallocate((unsigned char*)generic);\n@@ -77,1 +76,1 @@\n-        if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(GetPhase, jvmti, &phase ))) {\n+        if (!NSK_JVMTI_VERIFY(jvmti->GetPhase(&phase))) {\n@@ -88,2 +87,1 @@\n-        if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB4(GetClassSignature, jvmti,\n-                object_klass, &signature, &generic))) {\n+        if (!NSK_JVMTI_VERIFY(jvmti->GetClassSignature(object_klass, &signature, &generic))) {\n@@ -94,2 +92,1 @@\n-        if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB3(GetThreadInfo, jvmti,\n-                thread, &threadInfo))) {\n+        if (!NSK_JVMTI_VERIFY(jvmti->GetThreadInfo(thread, &threadInfo))) {\n@@ -111,2 +108,1 @@\n-        if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB3(GetAllThreads, jvmti,\n-                 &threadCount, &threads))) {\n+        if (!NSK_JVMTI_VERIFY(jvmti->GetAllThreads(&threadCount, &threads))) {\n@@ -118,1 +114,1 @@\n-            found = NSK_CPP_STUB3(IsSameObject, jni, threads[i], thread);\n+            found = jni->IsSameObject(threads[i], thread);\n@@ -137,2 +133,1 @@\n-        if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB3(GetLoadedClasses, jvmti,\n-                 &classCount, &classes))) {\n+        if (!NSK_JVMTI_VERIFY(jvmti->GetLoadedClasses(&classCount, &classes))) {\n@@ -150,1 +145,1 @@\n-            NSK_CPP_STUB2(Deallocate, jvmti, (unsigned char*)classes);\n+            jvmti->Deallocate((unsigned char*)classes);\n@@ -158,2 +153,2 @@\n-        klass = NSK_CPP_STUB2(GetObjectClass, jni, object);\n-        if (!(NSK_CPP_STUB3(IsSameObject, jni, object_klass, klass))) {\n+        klass = jni->GetObjectClass(object);\n+        if (!(jni->IsSameObject(object_klass, klass))) {\n@@ -170,2 +165,1 @@\n-        if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB3(GetObjectSize, jvmti,\n-                 object, &objSize))) {\n+        if (!NSK_JVMTI_VERIFY(jvmti->GetObjectSize(object, &objSize))) {\n@@ -184,1 +178,1 @@\n-        NSK_CPP_STUB2(Deallocate, jvmti, (unsigned char*)signature);\n+        jvmti->Deallocate((unsigned char*)signature);\n@@ -187,1 +181,1 @@\n-        NSK_CPP_STUB2(Deallocate, jvmti, (unsigned char*)generic);\n+        jvmti->Deallocate((unsigned char*)generic);\n@@ -237,1 +231,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(AddCapabilities, jvmti, &caps))) {\n+    if (!NSK_JVMTI_VERIFY(jvmti->AddCapabilities(&caps))) {\n@@ -243,3 +237,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-            NSK_CPP_STUB3(SetEventCallbacks, jvmti,\n-                &callbacks, sizeof(callbacks))))\n+    if (!NSK_JVMTI_VERIFY(jvmti->SetEventCallbacks(&callbacks, sizeof(callbacks))))\n@@ -250,2 +242,1 @@\n-            NSK_CPP_STUB4(SetEventNotificationMode, jvmti, JVMTI_ENABLE,\n-                JVMTI_EVENT_VM_OBJECT_ALLOC, NULL)))\n+            jvmti->SetEventNotificationMode(JVMTI_ENABLE, JVMTI_EVENT_VM_OBJECT_ALLOC, NULL)))\n","filename":"test\/hotspot\/jtreg\/vmTestbase\/nsk\/jvmti\/scenarios\/allocation\/AP11\/ap11t001\/ap11t001.cpp","additions":18,"deletions":27,"binary":false,"changes":45,"status":"modified"},{"patch":"@@ -80,2 +80,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB3(SetTag,\n-         jvmti, obj, tag))) {\n+    if (!NSK_JVMTI_VERIFY(jvmti->SetTag(obj, tag))) {\n@@ -130,2 +129,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(AddCapabilities,\n-            jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->AddCapabilities(&caps)))\n@@ -134,2 +132,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(GetCapabilities,\n-            jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->GetCapabilities(&caps)))\n@@ -150,2 +147,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB3(SetEventCallbacks,\n-            jvmti, &callbacks, sizeof(callbacks))))\n+    if (!NSK_JVMTI_VERIFY(jvmti->SetEventCallbacks(&callbacks, sizeof(callbacks))))\n@@ -155,2 +151,3 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB4(SetEventNotificationMode,\n-            jvmti, JVMTI_ENABLE, JVMTI_EVENT_OBJECT_FREE, NULL)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->SetEventNotificationMode(JVMTI_ENABLE,\n+                                                          JVMTI_EVENT_OBJECT_FREE,\n+                                                          NULL)))\n@@ -158,2 +155,3 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB4(SetEventNotificationMode,\n-            jvmti, JVMTI_ENABLE, JVMTI_EVENT_VM_DEATH, NULL)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->SetEventNotificationMode(JVMTI_ENABLE,\n+                                                          JVMTI_EVENT_VM_DEATH,\n+                                                          NULL)))\n","filename":"test\/hotspot\/jtreg\/vmTestbase\/nsk\/jvmti\/scenarios\/allocation\/AP12\/ap12t001\/ap12t001.cpp","additions":10,"deletions":12,"binary":false,"changes":22,"status":"modified"},{"patch":"@@ -55,2 +55,1 @@\n-    if (!NSK_JNI_VERIFY(jni_env, (newClassSize =\n-            NSK_CPP_STUB2(GetArrayLength, jni_env, byteCode)) > 0)) {\n+    if (!NSK_JNI_VERIFY(jni_env, (newClassSize = jni_env->GetArrayLength(byteCode)) > 0)) {\n@@ -63,2 +62,1 @@\n-            NSK_CPP_STUB3(GetByteArrayElements, jni_env, byteCode,\n-                                                        &isCopy)) != NULL)) {\n+            jni_env->GetByteArrayElements(byteCode, &isCopy)) != NULL)) {\n@@ -70,2 +68,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB3(Allocate, jvmti,\n-                                newClassSize, &newClassBytes))) {\n+    if (!NSK_JVMTI_VERIFY(jvmti->Allocate(newClassSize, &newClassBytes))) {\n@@ -85,1 +82,1 @@\n-    NSK_TRACE(NSK_CPP_STUB4(ReleaseByteArrayElements, jni_env, byteCode, elements, JNI_ABORT));\n+    NSK_TRACE(jni_env->ReleaseByteArrayElements(byteCode, elements, JNI_ABORT));\n@@ -101,1 +98,1 @@\n-             NSK_CPP_STUB2(NewGlobalRef, jni_env, cls)) != NULL)) {\n+             jni_env->NewGlobalRef(cls)) != NULL)) {\n@@ -132,3 +129,1 @@\n-        if (!NSK_JVMTI_VERIFY(\n-                NSK_CPP_STUB3(Allocate, jvmti_env, class_data_len,\n-                                &arr))) {\n+        if (!NSK_JVMTI_VERIFY(jvmti_env->Allocate(class_data_len, &arr))) {\n@@ -184,3 +179,3 @@\n-    if (!NSK_JVMTI_VERIFY(\n-            NSK_CPP_STUB4(SetEventNotificationMode, jvmti, JVMTI_DISABLE,\n-                                JVMTI_EVENT_CLASS_FILE_LOAD_HOOK, NULL))) {\n+    if (!NSK_JVMTI_VERIFY(jvmti->SetEventNotificationMode(JVMTI_DISABLE,\n+                                                          JVMTI_EVENT_CLASS_FILE_LOAD_HOOK,\n+                                                          NULL))) {\n@@ -208,2 +203,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-            NSK_CPP_STUB3(RedefineClasses, jvmti, 1, &oldClassDef))) {\n+    if (!NSK_JVMTI_VERIFY(jvmti->RedefineClasses(1, &oldClassDef))) {\n@@ -222,1 +216,1 @@\n-    NSK_CPP_STUB2(DeleteGlobalRef, agentJNI, oldClassDef.klass);\n+    agentJNI->DeleteGlobalRef(oldClassDef.klass);\n@@ -259,1 +253,1 @@\n-        if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(AddCapabilities, jvmti, &caps)))\n+        if (!NSK_JVMTI_VERIFY(jvmti->AddCapabilities(&caps)))\n@@ -270,2 +264,1 @@\n-        if (!NSK_JVMTI_VERIFY(\n-                NSK_CPP_STUB3(SetEventCallbacks, jvmti, &callbacks, size))) {\n+        if (!NSK_JVMTI_VERIFY(jvmti->SetEventCallbacks(&callbacks, size))) {\n@@ -277,3 +270,3 @@\n-    if (!NSK_JVMTI_VERIFY(\n-            NSK_CPP_STUB4(SetEventNotificationMode, jvmti, JVMTI_ENABLE,\n-                                JVMTI_EVENT_CLASS_FILE_LOAD_HOOK, NULL))) {\n+    if (!NSK_JVMTI_VERIFY(jvmti->SetEventNotificationMode(JVMTI_ENABLE,\n+                                                          JVMTI_EVENT_CLASS_FILE_LOAD_HOOK,\n+                                                          NULL))) {\n","filename":"test\/hotspot\/jtreg\/vmTestbase\/nsk\/jvmti\/scenarios\/bcinstr\/BI01\/bi01t001\/bi01t001.cpp","additions":16,"deletions":23,"binary":false,"changes":39,"status":"modified"},{"patch":"@@ -57,2 +57,1 @@\n-    if (!NSK_JNI_VERIFY(jni_env, (newClassSize[ind] =\n-            NSK_CPP_STUB2(GetArrayLength, jni_env, byteCode)) > 0)) {\n+    if (!NSK_JNI_VERIFY(jni_env, (newClassSize[ind] = jni_env->GetArrayLength(byteCode)) > 0)) {\n@@ -65,2 +64,1 @@\n-            NSK_CPP_STUB3(GetByteArrayElements, jni_env, byteCode,\n-                                                        &isCopy)) != NULL)) {\n+            jni_env->GetByteArrayElements(byteCode, &isCopy)) != NULL)) {\n@@ -72,2 +70,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB3(Allocate, jvmti,\n-                                newClassSize[ind], &newClassBytes[ind]))) {\n+    if (!NSK_JVMTI_VERIFY(jvmti->Allocate(newClassSize[ind], &newClassBytes[ind]))) {\n@@ -87,1 +84,1 @@\n-    NSK_TRACE(NSK_CPP_STUB4(ReleaseByteArrayElements, jni_env, byteCode, elements, JNI_ABORT));\n+    NSK_TRACE(jni_env->ReleaseByteArrayElements(byteCode, elements, JNI_ABORT));\n@@ -103,1 +100,1 @@\n-             NSK_CPP_STUB2(NewGlobalRef, jni_env, cls)) != NULL)) {\n+             jni_env->NewGlobalRef(cls)) != NULL)) {\n@@ -134,3 +131,1 @@\n-        if (!NSK_JVMTI_VERIFY(\n-                NSK_CPP_STUB3(Allocate, jvmti_env, class_data_len,\n-                                &arr))) {\n+        if (!NSK_JVMTI_VERIFY(jvmti_env->Allocate(class_data_len, &arr))) {\n@@ -192,3 +187,3 @@\n-    if (!NSK_JVMTI_VERIFY(\n-            NSK_CPP_STUB4(SetEventNotificationMode, jvmti, JVMTI_DISABLE,\n-                                JVMTI_EVENT_CLASS_FILE_LOAD_HOOK, NULL))) {\n+    if (!NSK_JVMTI_VERIFY(jvmti->SetEventNotificationMode(JVMTI_DISABLE,\n+                                                          JVMTI_EVENT_CLASS_FILE_LOAD_HOOK,\n+                                                          NULL))) {\n@@ -219,3 +214,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-            NSK_CPP_STUB3(RedefineClasses, jvmti, TOTAL_INSTRUMENTED_CLASSES,\n-                            oldClassDef))) {\n+    if (!NSK_JVMTI_VERIFY(jvmti->RedefineClasses(TOTAL_INSTRUMENTED_CLASSES, oldClassDef))) {\n@@ -235,1 +228,1 @@\n-        NSK_CPP_STUB2(DeleteGlobalRef, agentJNI, oldClassDef[i].klass);\n+        agentJNI->DeleteGlobalRef(oldClassDef[i].klass);\n@@ -273,1 +266,1 @@\n-        if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(AddCapabilities, jvmti, &caps)))\n+        if (!NSK_JVMTI_VERIFY(jvmti->AddCapabilities(&caps)))\n@@ -284,2 +277,1 @@\n-        if (!NSK_JVMTI_VERIFY(\n-                NSK_CPP_STUB3(SetEventCallbacks, jvmti, &callbacks, size))) {\n+        if (!NSK_JVMTI_VERIFY(jvmti->SetEventCallbacks(&callbacks, size))) {\n@@ -291,3 +283,3 @@\n-    if (!NSK_JVMTI_VERIFY(\n-            NSK_CPP_STUB4(SetEventNotificationMode, jvmti, JVMTI_ENABLE,\n-                                JVMTI_EVENT_CLASS_FILE_LOAD_HOOK, NULL))) {\n+    if (!NSK_JVMTI_VERIFY(jvmti->SetEventNotificationMode(JVMTI_ENABLE,\n+                                                          JVMTI_EVENT_CLASS_FILE_LOAD_HOOK,\n+                                                          NULL))) {\n","filename":"test\/hotspot\/jtreg\/vmTestbase\/nsk\/jvmti\/scenarios\/bcinstr\/BI01\/bi01t002\/bi01t002.cpp","additions":16,"deletions":24,"binary":false,"changes":40,"status":"modified"},{"patch":"@@ -66,1 +66,1 @@\n-                    NSK_CPP_STUB2(GetArrayLength, jni_env, classBytes)) > 0)) {\n+                    jni_env->GetArrayLength(classBytes)) > 0)) {\n@@ -72,1 +72,1 @@\n-                    NSK_CPP_STUB3(GetByteArrayElements, jni_env, classBytes, NULL))\n+                    jni_env->GetByteArrayElements(classBytes, NULL))\n@@ -89,2 +89,1 @@\n-    if (!NSK_JNI_VERIFY(jni, (debugeeClass =\n-            NSK_CPP_STUB2(FindClass, jni, DEBUGEE_CLASS_NAME)) != NULL))\n+    if (!NSK_JNI_VERIFY(jni, (debugeeClass = jni->FindClass(DEBUGEE_CLASS_NAME)) != NULL))\n@@ -93,2 +92,1 @@\n-    if (!NSK_JNI_VERIFY(jni, (debugeeClass = (jclass)\n-            NSK_CPP_STUB2(NewGlobalRef, jni, debugeeClass)) != NULL))\n+    if (!NSK_JNI_VERIFY(jni, (debugeeClass = (jclass)jni->NewGlobalRef(debugeeClass)) != NULL))\n@@ -98,2 +96,1 @@\n-            NSK_CPP_STUB4(GetStaticFieldID, jni, debugeeClass,\n-                \"newClassBytes\", \"[B\")) != NULL))\n+            jni->GetStaticFieldID(debugeeClass, \"newClassBytes\", \"[B\")) != NULL))\n@@ -103,1 +100,1 @@\n-            NSK_CPP_STUB3(GetStaticObjectField, jni, debugeeClass, field))\n+            jni->GetStaticObjectField(debugeeClass, field))\n@@ -107,2 +104,1 @@\n-    if (!NSK_JNI_VERIFY(jni, (classBytes = (jbyteArray)\n-            NSK_CPP_STUB2(NewGlobalRef, jni, classBytes)) != NULL))\n+    if (!NSK_JNI_VERIFY(jni, (classBytes = (jbyteArray)jni->NewGlobalRef(classBytes)) != NULL))\n@@ -111,2 +107,3 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB4(SetEventNotificationMode,\n-            jvmti, JVMTI_ENABLE, JVMTI_EVENT_CLASS_FILE_LOAD_HOOK, NULL)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->SetEventNotificationMode(JVMTI_ENABLE,\n+                                                          JVMTI_EVENT_CLASS_FILE_LOAD_HOOK,\n+                                                          NULL)))\n@@ -143,2 +140,3 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB4(SetEventNotificationMode,\n-            jvmti, JVMTI_DISABLE, JVMTI_EVENT_CLASS_FILE_LOAD_HOOK, NULL)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->SetEventNotificationMode(JVMTI_DISABLE,\n+                                                          JVMTI_EVENT_CLASS_FILE_LOAD_HOOK,\n+                                                          NULL)))\n@@ -147,2 +145,2 @@\n-    NSK_TRACE(NSK_CPP_STUB2(DeleteGlobalRef, jni, debugeeClass));\n-    NSK_TRACE(NSK_CPP_STUB2(DeleteGlobalRef, jni, classBytes));\n+    NSK_TRACE(jni->DeleteGlobalRef(debugeeClass));\n+    NSK_TRACE(jni->DeleteGlobalRef(classBytes));\n@@ -186,1 +184,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(AddCapabilities, jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->AddCapabilities(&caps)))\n@@ -194,2 +192,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB3(SetEventCallbacks,\n-            jvmti, &callbacks, sizeof(callbacks))))\n+    if (!NSK_JVMTI_VERIFY(jvmti->SetEventCallbacks(&callbacks, sizeof(callbacks))))\n","filename":"test\/hotspot\/jtreg\/vmTestbase\/nsk\/jvmti\/scenarios\/bcinstr\/BI02\/bi02t001\/bi02t001.cpp","additions":17,"deletions":20,"binary":false,"changes":37,"status":"modified"},{"patch":"@@ -55,2 +55,1 @@\n-    if (!NSK_JNI_VERIFY(jni, (debugeeClass =\n-            NSK_CPP_STUB2(FindClass, jni, DEBUGEE_CLASS_NAME)) != NULL))\n+    if (!NSK_JNI_VERIFY(jni, (debugeeClass = jni->FindClass(DEBUGEE_CLASS_NAME)) != NULL))\n@@ -59,2 +58,1 @@\n-    if (!NSK_JNI_VERIFY(jni, (debugeeClass = (jclass)\n-            NSK_CPP_STUB2(NewGlobalRef, jni, debugeeClass)) != NULL))\n+    if (!NSK_JNI_VERIFY(jni, (debugeeClass = (jclass)jni->NewGlobalRef(debugeeClass)) != NULL))\n@@ -64,2 +62,1 @@\n-            NSK_CPP_STUB4(GetStaticFieldID, jni, debugeeClass,\n-                \"newClassBytes\", \"[B\")) != NULL))\n+            jni->GetStaticFieldID(debugeeClass, \"newClassBytes\", \"[B\")) != NULL))\n@@ -69,1 +66,1 @@\n-            NSK_CPP_STUB3(GetStaticObjectField, jni, debugeeClass, field))\n+            jni->GetStaticObjectField(debugeeClass, field))\n@@ -73,2 +70,1 @@\n-    if (!NSK_JNI_VERIFY(jni, (classBytes = (jbyteArray)\n-            NSK_CPP_STUB2(NewGlobalRef, jni, classBytes)) != NULL))\n+    if (!NSK_JNI_VERIFY(jni, (classBytes = (jbyteArray)jni->NewGlobalRef(classBytes)) != NULL))\n@@ -78,2 +74,1 @@\n-    if (!NSK_JNI_VERIFY(jni, (testedClass =\n-            NSK_CPP_STUB2(FindClass, jni, CLASS_NAME)) != NULL))\n+    if (!NSK_JNI_VERIFY(jni, (testedClass = jni->FindClass(CLASS_NAME)) != NULL))\n@@ -82,2 +77,1 @@\n-    if (!NSK_JNI_VERIFY(jni, (testedClass = (jclass)\n-            NSK_CPP_STUB2(NewGlobalRef, jni, testedClass)) != NULL))\n+    if (!NSK_JNI_VERIFY(jni, (testedClass = (jclass)jni->NewGlobalRef(testedClass)) != NULL))\n@@ -96,2 +90,1 @@\n-    if (!NSK_JNI_VERIFY(jni, (class_def.class_byte_count =\n-            NSK_CPP_STUB2(GetArrayLength, jni, classBytes)) > 0))\n+    if (!NSK_JNI_VERIFY(jni, (class_def.class_byte_count = jni->GetArrayLength(classBytes)) > 0))\n@@ -101,1 +94,1 @@\n-            NSK_CPP_STUB3(GetByteArrayElements, jni, classBytes, NULL))\n+            jni->GetByteArrayElements(classBytes, NULL))\n@@ -106,1 +99,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB3(RedefineClasses, jvmti, 1, &class_def)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->RedefineClasses(1, &class_def)))\n@@ -135,3 +128,3 @@\n-    NSK_TRACE(NSK_CPP_STUB2(DeleteGlobalRef, jni, debugeeClass));\n-    NSK_TRACE(NSK_CPP_STUB2(DeleteGlobalRef, jni, classBytes));\n-    NSK_TRACE(NSK_CPP_STUB2(DeleteGlobalRef, jni, testedClass));\n+    NSK_TRACE(jni->DeleteGlobalRef(debugeeClass));\n+    NSK_TRACE(jni->DeleteGlobalRef(classBytes));\n+    NSK_TRACE(jni->DeleteGlobalRef(testedClass));\n@@ -174,1 +167,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(AddCapabilities, jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->AddCapabilities(&caps)))\n","filename":"test\/hotspot\/jtreg\/vmTestbase\/nsk\/jvmti\/scenarios\/bcinstr\/BI02\/bi02t002\/bi02t002.cpp","additions":14,"deletions":21,"binary":false,"changes":35,"status":"modified"},{"patch":"@@ -66,1 +66,1 @@\n-                    NSK_CPP_STUB2(GetArrayLength, jni_env, classBytes)) > 0)) {\n+                    jni_env->GetArrayLength(classBytes)) > 0)) {\n@@ -72,1 +72,1 @@\n-                    NSK_CPP_STUB3(GetByteArrayElements, jni_env, classBytes, NULL))\n+                    jni_env->GetByteArrayElements(classBytes, NULL))\n@@ -89,2 +89,1 @@\n-    if (!NSK_JNI_VERIFY(jni, (debugeeClass =\n-            NSK_CPP_STUB2(FindClass, jni, DEBUGEE_CLASS_NAME)) != NULL))\n+    if (!NSK_JNI_VERIFY(jni, (debugeeClass = jni->FindClass(DEBUGEE_CLASS_NAME)) != NULL))\n@@ -93,2 +92,1 @@\n-    if (!NSK_JNI_VERIFY(jni, (debugeeClass = (jclass)\n-            NSK_CPP_STUB2(NewGlobalRef, jni, debugeeClass)) != NULL))\n+    if (!NSK_JNI_VERIFY(jni, (debugeeClass = (jclass)jni->NewGlobalRef(debugeeClass)) != NULL))\n@@ -98,2 +96,1 @@\n-            NSK_CPP_STUB4(GetStaticFieldID, jni, debugeeClass,\n-                \"newClassBytes\", \"[B\")) != NULL))\n+            jni->GetStaticFieldID(debugeeClass, \"newClassBytes\", \"[B\")) != NULL))\n@@ -103,1 +100,1 @@\n-            NSK_CPP_STUB3(GetStaticObjectField, jni, debugeeClass, field))\n+            jni->GetStaticObjectField(debugeeClass, field))\n@@ -107,2 +104,1 @@\n-    if (!NSK_JNI_VERIFY(jni, (classBytes = (jbyteArray)\n-            NSK_CPP_STUB2(NewGlobalRef, jni, classBytes)) != NULL))\n+    if (!NSK_JNI_VERIFY(jni, (classBytes = (jbyteArray)jni->NewGlobalRef(classBytes)) != NULL))\n@@ -111,2 +107,3 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB4(SetEventNotificationMode,\n-            jvmti, JVMTI_ENABLE, JVMTI_EVENT_CLASS_FILE_LOAD_HOOK, NULL)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->SetEventNotificationMode(JVMTI_ENABLE,\n+                                                          JVMTI_EVENT_CLASS_FILE_LOAD_HOOK,\n+                                                          NULL)))\n@@ -143,2 +140,3 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB4(SetEventNotificationMode,\n-            jvmti, JVMTI_DISABLE, JVMTI_EVENT_CLASS_FILE_LOAD_HOOK, NULL)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->SetEventNotificationMode(JVMTI_DISABLE,\n+                                                          JVMTI_EVENT_CLASS_FILE_LOAD_HOOK,\n+                                                          NULL)))\n@@ -147,2 +145,2 @@\n-    NSK_TRACE(NSK_CPP_STUB2(DeleteGlobalRef, jni, debugeeClass));\n-    NSK_TRACE(NSK_CPP_STUB2(DeleteGlobalRef, jni, classBytes));\n+    NSK_TRACE(jni->DeleteGlobalRef(debugeeClass));\n+    NSK_TRACE(jni->DeleteGlobalRef(classBytes));\n@@ -186,1 +184,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(AddCapabilities, jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->AddCapabilities(&caps)))\n@@ -194,2 +192,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB3(SetEventCallbacks,\n-            jvmti, &callbacks, sizeof(callbacks))))\n+    if (!NSK_JVMTI_VERIFY(jvmti->SetEventCallbacks(&callbacks, sizeof(callbacks))))\n","filename":"test\/hotspot\/jtreg\/vmTestbase\/nsk\/jvmti\/scenarios\/bcinstr\/BI03\/bi03t001\/bi03t001.cpp","additions":17,"deletions":20,"binary":false,"changes":37,"status":"modified"},{"patch":"@@ -55,2 +55,1 @@\n-    if (!NSK_JNI_VERIFY(jni, (debugeeClass =\n-            NSK_CPP_STUB2(FindClass, jni, DEBUGEE_CLASS_NAME)) != NULL))\n+    if (!NSK_JNI_VERIFY(jni, (debugeeClass = jni->FindClass(DEBUGEE_CLASS_NAME)) != NULL))\n@@ -59,2 +58,1 @@\n-    if (!NSK_JNI_VERIFY(jni, (debugeeClass = (jclass)\n-            NSK_CPP_STUB2(NewGlobalRef, jni, debugeeClass)) != NULL))\n+    if (!NSK_JNI_VERIFY(jni, (debugeeClass = (jclass)jni->NewGlobalRef(debugeeClass)) != NULL))\n@@ -64,2 +62,1 @@\n-            NSK_CPP_STUB4(GetStaticFieldID, jni, debugeeClass,\n-                \"newClassBytes\", \"[B\")) != NULL))\n+            jni->GetStaticFieldID(debugeeClass, \"newClassBytes\", \"[B\")) != NULL))\n@@ -69,1 +66,1 @@\n-            NSK_CPP_STUB3(GetStaticObjectField, jni, debugeeClass, field))\n+            jni->GetStaticObjectField(debugeeClass, field))\n@@ -73,2 +70,1 @@\n-    if (!NSK_JNI_VERIFY(jni, (classBytes = (jbyteArray)\n-            NSK_CPP_STUB2(NewGlobalRef, jni, classBytes)) != NULL))\n+    if (!NSK_JNI_VERIFY(jni, (classBytes = (jbyteArray)jni->NewGlobalRef(classBytes)) != NULL))\n@@ -78,2 +74,1 @@\n-    if (!NSK_JNI_VERIFY(jni, (testedClass =\n-            NSK_CPP_STUB2(FindClass, jni, CLASS_NAME)) != NULL))\n+    if (!NSK_JNI_VERIFY(jni, (testedClass = jni->FindClass(CLASS_NAME)) != NULL))\n@@ -82,2 +77,1 @@\n-    if (!NSK_JNI_VERIFY(jni, (testedClass = (jclass)\n-            NSK_CPP_STUB2(NewGlobalRef, jni, testedClass)) != NULL))\n+    if (!NSK_JNI_VERIFY(jni, (testedClass = (jclass)jni->NewGlobalRef(testedClass)) != NULL))\n@@ -96,2 +90,1 @@\n-    if (!NSK_JNI_VERIFY(jni, (class_def.class_byte_count =\n-            NSK_CPP_STUB2(GetArrayLength, jni, classBytes)) > 0))\n+    if (!NSK_JNI_VERIFY(jni, (class_def.class_byte_count = jni->GetArrayLength(classBytes)) > 0))\n@@ -101,1 +94,1 @@\n-            NSK_CPP_STUB3(GetByteArrayElements, jni, classBytes, NULL))\n+            jni->GetByteArrayElements(classBytes, NULL))\n@@ -106,1 +99,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB3(RedefineClasses, jvmti, 1, &class_def)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->RedefineClasses(1, &class_def)))\n@@ -135,3 +128,3 @@\n-    NSK_TRACE(NSK_CPP_STUB2(DeleteGlobalRef, jni, debugeeClass));\n-    NSK_TRACE(NSK_CPP_STUB2(DeleteGlobalRef, jni, classBytes));\n-    NSK_TRACE(NSK_CPP_STUB2(DeleteGlobalRef, jni, testedClass));\n+    NSK_TRACE(jni->DeleteGlobalRef(debugeeClass));\n+    NSK_TRACE(jni->DeleteGlobalRef(classBytes));\n+    NSK_TRACE(jni->DeleteGlobalRef(testedClass));\n@@ -174,1 +167,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(AddCapabilities, jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->AddCapabilities(&caps)))\n","filename":"test\/hotspot\/jtreg\/vmTestbase\/nsk\/jvmti\/scenarios\/bcinstr\/BI03\/bi03t002\/bi03t002.cpp","additions":14,"deletions":21,"binary":false,"changes":35,"status":"modified"},{"patch":"@@ -72,3 +72,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB3(Allocate, jvmti,\n-                                classDef.class_byte_count,\n-                                &newClassBytes))) {\n+    if (!NSK_JVMTI_VERIFY(jvmti->Allocate(classDef.class_byte_count, &newClassBytes))) {\n@@ -102,2 +100,1 @@\n-    if (!NSK_JNI_VERIFY(jni, (classDef.klass =\n-            NSK_CPP_STUB2(FindClass, jni, TESTED_CLASS_NAME)) != NULL)) {\n+    if (!NSK_JNI_VERIFY(jni, (classDef.klass = jni->FindClass(TESTED_CLASS_NAME)) != NULL)) {\n@@ -109,1 +106,1 @@\n-            NSK_CPP_STUB2(NewGlobalRef, jni, classDef.klass)) != NULL)) {\n+            jni->NewGlobalRef(classDef.klass)) != NULL)) {\n@@ -123,2 +120,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-            NSK_CPP_STUB3(RedefineClasses, jvmti, 1, &classDef))) {\n+    if (!NSK_JVMTI_VERIFY(jvmti->RedefineClasses(1, &classDef))) {\n@@ -129,1 +125,1 @@\n-    NSK_CPP_STUB2(DeleteGlobalRef, jni, classDef.klass);\n+    jni->DeleteGlobalRef(classDef.klass);\n@@ -166,1 +162,1 @@\n-        if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(AddCapabilities, jvmti, &caps)))\n+        if (!NSK_JVMTI_VERIFY(jvmti->AddCapabilities(&caps)))\n","filename":"test\/hotspot\/jtreg\/vmTestbase\/nsk\/jvmti\/scenarios\/bcinstr\/BI04\/bi04t002\/bi04t002.cpp","additions":6,"deletions":10,"binary":false,"changes":16,"status":"modified"},{"patch":"@@ -82,2 +82,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-           NSK_CPP_STUB3(GetAllThreads, jvmti, &threads_count, &threads)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->GetAllThreads(&threads_count, &threads)))\n@@ -95,2 +94,1 @@\n-        if (!NSK_JVMTI_VERIFY(\n-                NSK_CPP_STUB3(GetThreadInfo, jvmti, threads[i], &info)))\n+        if (!NSK_JVMTI_VERIFY(jvmti->GetThreadInfo(threads[i], &info)))\n@@ -108,2 +106,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-            NSK_CPP_STUB2(Deallocate, jvmti, (unsigned char*)threads)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->Deallocate((unsigned char*)threads)))\n@@ -113,2 +110,1 @@\n-    if (!NSK_JNI_VERIFY(jni, (klass =\n-            NSK_CPP_STUB2(GetObjectClass, jni, thread)) != NULL))\n+    if (!NSK_JNI_VERIFY(jni, (klass = jni->GetObjectClass(thread)) != NULL))\n@@ -118,2 +114,1 @@\n-    if (!NSK_JNI_VERIFY(jni, (method =\n-            NSK_CPP_STUB4(GetMethodID, jni, klass, \"run\", \"()V\")) != NULL))\n+    if (!NSK_JNI_VERIFY(jni, (method = jni->GetMethodID(klass, \"run\", \"()V\")) != NULL))\n@@ -124,2 +119,1 @@\n-            NSK_CPP_STUB4(GetFieldID, jni, klass,\n-                \"waitingMonitor\", \"Ljava\/lang\/Object;\")) != NULL))\n+            jni->GetFieldID(klass, \"waitingMonitor\", \"Ljava\/lang\/Object;\")) != NULL))\n@@ -139,2 +133,1 @@\n-    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY,\n-            NSK_CPP_STUB2(SuspendThread, jvmti, thread)))\n+    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY, jvmti->SuspendThread(thread)))\n@@ -144,2 +137,1 @@\n-    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY,\n-            NSK_CPP_STUB2(ResumeThread, jvmti, thread)))\n+    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY, jvmti->ResumeThread(thread)))\n@@ -150,1 +142,1 @@\n-            NSK_CPP_STUB4(SuspendThreadList, jvmti, 1, &thread, &err)))\n+            jvmti->SuspendThreadList(1, &thread, &err)))\n@@ -155,1 +147,1 @@\n-            NSK_CPP_STUB4(ResumeThreadList, jvmti, 1, &thread, &err)))\n+            jvmti->ResumeThreadList(1, &thread, &err)))\n@@ -171,2 +163,1 @@\n-    if (!NSK_JNI_VERIFY(jni, (cls =\n-            NSK_CPP_STUB2(FindClass, jni, THREAD_DEATH_CLASS_NAME)) != NULL))\n+    if (!NSK_JNI_VERIFY(jni, (cls = jni->FindClass(THREAD_DEATH_CLASS_NAME)) != NULL))\n@@ -176,2 +167,1 @@\n-            NSK_CPP_STUB4(GetMethodID, jni, cls,\n-                THREAD_DEATH_CTOR_NAME, THREAD_DEATH_CTOR_SIGNATURE)) != NULL))\n+            jni->GetMethodID(cls, THREAD_DEATH_CTOR_NAME, THREAD_DEATH_CTOR_SIGNATURE)) != NULL))\n@@ -180,2 +170,1 @@\n-    if (!NSK_JNI_VERIFY(jni, (exception =\n-            NSK_CPP_STUB3(NewObject, jni, cls, ctor)) != NULL))\n+    if (!NSK_JNI_VERIFY(jni, (exception = jni->NewObject(cls, ctor)) != NULL))\n@@ -186,1 +175,1 @@\n-            NSK_CPP_STUB3(StopThread, jvmti, thread, exception)))\n+            jvmti->StopThread(thread, exception)))\n@@ -190,2 +179,1 @@\n-    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY,\n-            NSK_CPP_STUB2(InterruptThread, jvmti, thread)))\n+    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY, jvmti->InterruptThread(thread)))\n@@ -205,1 +193,1 @@\n-            NSK_CPP_STUB4(GetOwnedMonitorInfo, jvmti, thread, &count, &monitors)))\n+            jvmti->GetOwnedMonitorInfo(thread, &count, &monitors)))\n@@ -218,1 +206,1 @@\n-            NSK_CPP_STUB3(GetCurrentContendedMonitor, jvmti, thread, &monitor)))\n+            jvmti->GetCurrentContendedMonitor(thread, &monitor)))\n@@ -228,2 +216,1 @@\n-    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY,\n-            NSK_CPP_STUB2(PopFrame, jvmti, thread)))\n+    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY, jvmti->PopFrame(thread)))\n@@ -272,2 +259,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-            NSK_CPP_STUB3(SetTag, jvmti, thread, TAG_VALUE)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->SetTag(thread, TAG_VALUE)))\n@@ -277,2 +263,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-            NSK_CPP_STUB3(GetTag, jvmti, thread, &tag)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->GetTag(thread, &tag)))\n@@ -283,3 +268,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-            NSK_CPP_STUB6(GetObjectsWithTags, jvmti, 1, &tag,\n-                &count, &res_objects, &res_tags)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->GetObjectsWithTags(1, &tag, &count, &res_objects, &res_tags)))\n@@ -290,2 +273,1 @@\n-            NSK_CPP_STUB4(IterateOverHeap, jvmti, JVMTI_HEAP_OBJECT_TAGGED,\n-                HeapObject, &dummy_user_data)))\n+            jvmti->IterateOverHeap(JVMTI_HEAP_OBJECT_TAGGED, HeapObject, &dummy_user_data)))\n@@ -295,3 +277,2 @@\n-    if (!NSK_JVMTI_VERIFY(\n-            NSK_CPP_STUB5(IterateOverInstancesOfClass, jvmti, klass,\n-                JVMTI_HEAP_OBJECT_UNTAGGED, HeapObject, &dummy_user_data)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->IterateOverInstancesOfClass(\n+            klass, JVMTI_HEAP_OBJECT_UNTAGGED, HeapObject, &dummy_user_data)))\n@@ -301,3 +282,2 @@\n-    if (!NSK_JVMTI_VERIFY(\n-            NSK_CPP_STUB4(IterateOverObjectsReachableFromObject, jvmti, thread,\n-                ObjectReference, &dummy_user_data)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->IterateOverObjectsReachableFromObject(\n+            thread, ObjectReference, &dummy_user_data)))\n@@ -307,3 +287,2 @@\n-    if (!NSK_JVMTI_VERIFY(\n-            NSK_CPP_STUB5(IterateOverReachableObjects, jvmti,\n-                HeapRoot, StackReference, ObjectReference, &dummy_user_data)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->IterateOverReachableObjects(\n+            HeapRoot, StackReference, ObjectReference, &dummy_user_data)))\n@@ -328,2 +307,1 @@\n-            NSK_CPP_STUB4(GetLocalVariableTable, jvmti, method, &count,\n-                &local_variable_table)))\n+            jvmti->GetLocalVariableTable(method, &count, &local_variable_table)))\n@@ -334,1 +312,1 @@\n-            NSK_CPP_STUB5(GetLocalObject, jvmti, thread, 0, 0, &object_value)))\n+            jvmti->GetLocalObject(thread, 0, 0, &object_value)))\n@@ -339,1 +317,1 @@\n-            NSK_CPP_STUB5(GetLocalInt, jvmti, thread, 0, 0, &int_value)))\n+            jvmti->GetLocalInt(thread, 0, 0, &int_value)))\n@@ -344,1 +322,1 @@\n-            NSK_CPP_STUB5(GetLocalLong, jvmti, thread, 0, 0, &long_value)))\n+            jvmti->GetLocalLong(thread, 0, 0, &long_value)))\n@@ -349,1 +327,1 @@\n-            NSK_CPP_STUB5(GetLocalFloat, jvmti, thread, 0, 0, &float_value)))\n+            jvmti->GetLocalFloat(thread, 0, 0, &float_value)))\n@@ -354,1 +332,1 @@\n-            NSK_CPP_STUB5(GetLocalDouble, jvmti, thread, 0, 0, &double_value)))\n+            jvmti->GetLocalDouble(thread, 0, 0, &double_value)))\n@@ -359,1 +337,1 @@\n-            NSK_CPP_STUB5(SetLocalObject, jvmti, thread, 0, 0, thread)))\n+            jvmti->SetLocalObject(thread, 0, 0, thread)))\n@@ -364,1 +342,1 @@\n-            NSK_CPP_STUB5(SetLocalInt, jvmti, thread, 0, 0, (jint)0)))\n+            jvmti->SetLocalInt(thread, 0, 0, (jint)0)))\n@@ -369,1 +347,1 @@\n-            NSK_CPP_STUB5(SetLocalLong, jvmti, thread, 0, 0, (jlong)0)))\n+            jvmti->SetLocalLong(thread, 0, 0, (jlong)0)))\n@@ -374,1 +352,1 @@\n-            NSK_CPP_STUB5(SetLocalFloat, jvmti, thread, 0, 0, (jfloat)0.0)))\n+            jvmti->SetLocalFloat(thread, 0, 0, (jfloat)0.0)))\n@@ -379,1 +357,1 @@\n-            NSK_CPP_STUB5(SetLocalDouble, jvmti, thread, 0, 0, (jdouble)0.0)))\n+            jvmti->SetLocalDouble(thread, 0, 0, (jdouble)0.0)))\n@@ -394,1 +372,1 @@\n-            NSK_CPP_STUB3(GetSourceFileName, jvmti, klass, &name)))\n+            jvmti->GetSourceFileName(klass, &name)))\n@@ -399,1 +377,1 @@\n-            NSK_CPP_STUB3(GetSourceDebugExtension, jvmti, klass, &name)))\n+            jvmti->GetSourceDebugExtension(klass, &name)))\n@@ -404,2 +382,1 @@\n-            NSK_CPP_STUB4(GetLineNumberTable, jvmti, method, &count,\n-                &line_number_table)))\n+            jvmti->GetLineNumberTable(method, &count, &line_number_table)))\n@@ -421,1 +398,1 @@\n-            NSK_CPP_STUB3(RedefineClasses, jvmti, 1, &class_def)))\n+            jvmti->RedefineClasses(1, &class_def)))\n@@ -434,1 +411,1 @@\n-            NSK_CPP_STUB3(GetObjectMonitorUsage, jvmti, thread, &monitor_info)))\n+            jvmti->GetObjectMonitorUsage(thread, &monitor_info)))\n@@ -447,1 +424,1 @@\n-            NSK_CPP_STUB4(IsFieldSynthetic, jvmti, klass, field, &is_synthetic)))\n+            jvmti->IsFieldSynthetic(klass, field, &is_synthetic)))\n@@ -452,1 +429,1 @@\n-            NSK_CPP_STUB3(IsMethodSynthetic, jvmti, method, &is_synthetic)))\n+            jvmti->IsMethodSynthetic(method, &is_synthetic)))\n@@ -466,1 +443,1 @@\n-            NSK_CPP_STUB4(GetBytecodes, jvmti, method, &count, &bytecodes)))\n+            jvmti->GetBytecodes(method, &count, &bytecodes)))\n@@ -480,1 +457,1 @@\n-            NSK_CPP_STUB2(GetCurrentThreadCpuTimerInfo, jvmti, &info)))\n+            jvmti->GetCurrentThreadCpuTimerInfo(&info)))\n@@ -485,1 +462,1 @@\n-            NSK_CPP_STUB2(GetCurrentThreadCpuTime, jvmti, &nanos)))\n+            jvmti->GetCurrentThreadCpuTime(&nanos)))\n@@ -499,1 +476,1 @@\n-            NSK_CPP_STUB2(GetThreadCpuTimerInfo, jvmti, &info)))\n+            jvmti->GetThreadCpuTimerInfo(&info)))\n@@ -504,1 +481,1 @@\n-            NSK_CPP_STUB3(GetThreadCpuTime, jvmti, thread, &nanos)))\n+            jvmti->GetThreadCpuTime(thread, &nanos)))\n@@ -600,1 +577,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(GetPotentialCapabilities, jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->GetPotentialCapabilities(&caps)))\n@@ -612,1 +589,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(AddCapabilities, jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->AddCapabilities(&caps)))\n@@ -618,1 +595,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(GetCapabilities, jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->GetCapabilities(&caps)))\n@@ -630,1 +607,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(RelinquishCapabilities, jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->RelinquishCapabilities(&caps)))\n@@ -636,1 +613,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(GetCapabilities, jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->GetCapabilities(&caps)))\n@@ -648,1 +625,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(AddCapabilities, jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->AddCapabilities(&caps)))\n@@ -651,1 +628,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(GetCapabilities, jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->GetCapabilities(&caps)))\n","filename":"test\/hotspot\/jtreg\/vmTestbase\/nsk\/jvmti\/scenarios\/capability\/CM01\/cm01t001\/cm01t001.cpp","additions":58,"deletions":81,"binary":false,"changes":139,"status":"modified"},{"patch":"@@ -75,2 +75,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-           NSK_CPP_STUB3(GetAllThreads, jvmti, &threads_count, &threads)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->GetAllThreads(&threads_count, &threads)))\n@@ -88,2 +87,1 @@\n-        if (!NSK_JVMTI_VERIFY(\n-                NSK_CPP_STUB3(GetThreadInfo, jvmti, threads[i], &info)))\n+        if (!NSK_JVMTI_VERIFY(jvmti->GetThreadInfo(threads[i], &info)))\n@@ -101,2 +99,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-            NSK_CPP_STUB2(Deallocate, jvmti, (unsigned char*)threads)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->Deallocate((unsigned char*)threads)))\n@@ -106,2 +103,1 @@\n-    if (!NSK_JNI_VERIFY(jni, (klass =\n-            NSK_CPP_STUB2(GetObjectClass, jni, thread)) != NULL))\n+    if (!NSK_JNI_VERIFY(jni, (klass = jni->GetObjectClass(thread)) != NULL))\n@@ -111,2 +107,1 @@\n-    if (!NSK_JNI_VERIFY(jni, (method =\n-            NSK_CPP_STUB4(GetMethodID, jni, klass, \"run\", \"()V\")) != NULL))\n+    if (!NSK_JNI_VERIFY(jni, (method = jni->GetMethodID(klass, \"run\", \"()V\")) != NULL))\n@@ -117,2 +112,1 @@\n-            NSK_CPP_STUB4(GetFieldID, jni, klass,\n-                \"waitingMonitor\", \"Ljava\/lang\/Object;\")) != NULL))\n+            jni->GetFieldID(klass, \"waitingMonitor\", \"Ljava\/lang\/Object;\")) != NULL))\n@@ -132,2 +126,1 @@\n-    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY,\n-            NSK_CPP_STUB2(SuspendThread, jvmti, thread)))\n+    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY, jvmti->SuspendThread(thread)))\n@@ -137,2 +130,1 @@\n-    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY,\n-            NSK_CPP_STUB2(ResumeThread, jvmti, thread)))\n+    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY, jvmti->ResumeThread(thread)))\n@@ -143,1 +135,1 @@\n-            NSK_CPP_STUB4(SuspendThreadList, jvmti, 1, &thread, &err)))\n+            jvmti->SuspendThreadList(1, &thread, &err)))\n@@ -148,1 +140,1 @@\n-            NSK_CPP_STUB4(ResumeThreadList, jvmti, 1, &thread, &err)))\n+            jvmti->ResumeThreadList(1, &thread, &err)))\n@@ -164,2 +156,1 @@\n-    if (!NSK_JNI_VERIFY(jni, (cls =\n-            NSK_CPP_STUB2(FindClass, jni, THREAD_DEATH_CLASS_NAME)) != NULL))\n+    if (!NSK_JNI_VERIFY(jni, (cls = jni->FindClass(THREAD_DEATH_CLASS_NAME)) != NULL))\n@@ -169,2 +160,1 @@\n-            NSK_CPP_STUB4(GetMethodID, jni, cls,\n-                THREAD_DEATH_CTOR_NAME, THREAD_DEATH_CTOR_SIGNATURE)) != NULL))\n+            jni->GetMethodID(cls, THREAD_DEATH_CTOR_NAME, THREAD_DEATH_CTOR_SIGNATURE)) != NULL))\n@@ -173,2 +163,1 @@\n-    if (!NSK_JNI_VERIFY(jni, (exception =\n-            NSK_CPP_STUB3(NewObject, jni, cls, ctor)) != NULL))\n+    if (!NSK_JNI_VERIFY(jni, (exception = jni->NewObject(cls, ctor)) != NULL))\n@@ -179,1 +168,1 @@\n-            NSK_CPP_STUB3(StopThread, jvmti, thread, exception)))\n+            jvmti->StopThread(thread, exception)))\n@@ -183,2 +172,1 @@\n-    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY,\n-            NSK_CPP_STUB2(InterruptThread, jvmti, thread)))\n+    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY, jvmti->InterruptThread(thread)))\n@@ -198,1 +186,1 @@\n-            NSK_CPP_STUB4(GetOwnedMonitorInfo, jvmti, thread, &count, &monitors)))\n+            jvmti->GetOwnedMonitorInfo(thread, &count, &monitors)))\n@@ -211,1 +199,1 @@\n-            NSK_CPP_STUB3(GetCurrentContendedMonitor, jvmti, thread, &monitor)))\n+            jvmti->GetCurrentContendedMonitor(thread, &monitor)))\n@@ -221,2 +209,1 @@\n-    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY,\n-            NSK_CPP_STUB2(PopFrame, jvmti, thread)))\n+    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY, jvmti->PopFrame(thread)))\n@@ -266,1 +253,1 @@\n-            NSK_CPP_STUB3(SetTag, jvmti, thread, TAG_VALUE)))\n+            jvmti->SetTag(thread, TAG_VALUE)))\n@@ -270,2 +257,1 @@\n-    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY,\n-            NSK_CPP_STUB3(GetTag, jvmti, thread, &tag)))\n+    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY, jvmti->GetTag(thread, &tag)))\n@@ -277,2 +263,1 @@\n-            NSK_CPP_STUB6(GetObjectsWithTags, jvmti, 1, &tag,\n-                &count, &res_objects, &res_tags)))\n+            jvmti->GetObjectsWithTags(1, &tag, &count, &res_objects, &res_tags)))\n@@ -283,2 +268,1 @@\n-            NSK_CPP_STUB4(IterateOverHeap, jvmti, JVMTI_HEAP_OBJECT_TAGGED,\n-                HeapObject, &dummy_user_data)))\n+            jvmti->IterateOverHeap(JVMTI_HEAP_OBJECT_TAGGED, HeapObject, &dummy_user_data)))\n@@ -289,2 +273,4 @@\n-            NSK_CPP_STUB5(IterateOverInstancesOfClass, jvmti, klass,\n-                JVMTI_HEAP_OBJECT_UNTAGGED, HeapObject, &dummy_user_data)))\n+            jvmti->IterateOverInstancesOfClass(klass,\n+                                               JVMTI_HEAP_OBJECT_UNTAGGED,\n+                                               HeapObject,\n+                                               &dummy_user_data)))\n@@ -295,2 +281,3 @@\n-            NSK_CPP_STUB4(IterateOverObjectsReachableFromObject, jvmti, thread,\n-                ObjectReference, &dummy_user_data)))\n+            jvmti->IterateOverObjectsReachableFromObject(thread,\n+                                                         ObjectReference,\n+                                                         &dummy_user_data)))\n@@ -301,2 +288,4 @@\n-            NSK_CPP_STUB5(IterateOverReachableObjects, jvmti,\n-                HeapRoot, StackReference, ObjectReference, &dummy_user_data)))\n+            jvmti->IterateOverReachableObjects(HeapRoot,\n+                                               StackReference,\n+                                               ObjectReference,\n+                                               &dummy_user_data)))\n@@ -321,2 +310,1 @@\n-            NSK_CPP_STUB4(GetLocalVariableTable, jvmti, method, &count,\n-                &local_variable_table)))\n+            jvmti->GetLocalVariableTable(method, &count, &local_variable_table)))\n@@ -327,1 +315,1 @@\n-            NSK_CPP_STUB5(GetLocalObject, jvmti, thread, 0, 0, &object_value)))\n+            jvmti->GetLocalObject(thread, 0, 0, &object_value)))\n@@ -332,1 +320,1 @@\n-            NSK_CPP_STUB5(GetLocalInt, jvmti, thread, 0, 0, &int_value)))\n+            jvmti->GetLocalInt(thread, 0, 0, &int_value)))\n@@ -337,1 +325,1 @@\n-            NSK_CPP_STUB5(GetLocalLong, jvmti, thread, 0, 0, &long_value)))\n+            jvmti->GetLocalLong(thread, 0, 0, &long_value)))\n@@ -342,1 +330,1 @@\n-            NSK_CPP_STUB5(GetLocalFloat, jvmti, thread, 0, 0, &float_value)))\n+            jvmti->GetLocalFloat(thread, 0, 0, &float_value)))\n@@ -347,1 +335,1 @@\n-            NSK_CPP_STUB5(GetLocalDouble, jvmti, thread, 0, 0, &double_value)))\n+            jvmti->GetLocalDouble(thread, 0, 0, &double_value)))\n@@ -352,1 +340,1 @@\n-            NSK_CPP_STUB5(SetLocalObject, jvmti, thread, 0, 0, thread)))\n+            jvmti->SetLocalObject(thread, 0, 0, thread)))\n@@ -357,1 +345,1 @@\n-            NSK_CPP_STUB5(SetLocalInt, jvmti, thread, 0, 0, (jint)0)))\n+            jvmti->SetLocalInt(thread, 0, 0, (jint)0)))\n@@ -362,1 +350,1 @@\n-            NSK_CPP_STUB5(SetLocalLong, jvmti, thread, 0, 0, (jlong)0)))\n+            jvmti->SetLocalLong(thread, 0, 0, (jlong)0)))\n@@ -367,1 +355,1 @@\n-            NSK_CPP_STUB5(SetLocalFloat, jvmti, thread, 0, 0, (jfloat)0.0)))\n+            jvmti->SetLocalFloat(thread, 0, 0, (jfloat)0.0)))\n@@ -372,1 +360,1 @@\n-            NSK_CPP_STUB5(SetLocalDouble, jvmti, thread, 0, 0, (jdouble)0.0)))\n+            jvmti->SetLocalDouble(thread, 0, 0, (jdouble)0.0)))\n@@ -387,1 +375,1 @@\n-            NSK_CPP_STUB3(GetSourceFileName, jvmti, klass, &name)))\n+            jvmti->GetSourceFileName(klass, &name)))\n@@ -392,1 +380,1 @@\n-            NSK_CPP_STUB3(GetSourceDebugExtension, jvmti, klass, &name)))\n+            jvmti->GetSourceDebugExtension(klass, &name)))\n@@ -397,2 +385,1 @@\n-            NSK_CPP_STUB4(GetLineNumberTable, jvmti, method, &count,\n-                &line_number_table)))\n+            jvmti->GetLineNumberTable(method, &count, &line_number_table)))\n@@ -414,1 +401,1 @@\n-            NSK_CPP_STUB3(RedefineClasses, jvmti, 1, &class_def)))\n+            jvmti->RedefineClasses(1, &class_def)))\n@@ -427,1 +414,1 @@\n-            NSK_CPP_STUB3(GetObjectMonitorUsage, jvmti, thread, &monitor_info)))\n+            jvmti->GetObjectMonitorUsage(thread, &monitor_info)))\n@@ -440,1 +427,1 @@\n-            NSK_CPP_STUB4(IsFieldSynthetic, jvmti, klass, field, &is_synthetic)))\n+            jvmti->IsFieldSynthetic(klass, field, &is_synthetic)))\n@@ -445,1 +432,1 @@\n-            NSK_CPP_STUB3(IsMethodSynthetic, jvmti, method, &is_synthetic)))\n+            jvmti->IsMethodSynthetic(method, &is_synthetic)))\n@@ -458,2 +445,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-            NSK_CPP_STUB4(GetBytecodes, jvmti, method, &count, &bytecodes)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->GetBytecodes(method, &count, &bytecodes)))\n@@ -461,1 +447,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(Deallocate, jvmti, bytecodes)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->Deallocate(bytecodes)))\n@@ -475,1 +461,1 @@\n-            NSK_CPP_STUB2(GetCurrentThreadCpuTimerInfo, jvmti, &info)))\n+            jvmti->GetCurrentThreadCpuTimerInfo(&info)))\n@@ -480,1 +466,1 @@\n-            NSK_CPP_STUB2(GetCurrentThreadCpuTime, jvmti, &nanos)))\n+            jvmti->GetCurrentThreadCpuTime(&nanos)))\n@@ -494,1 +480,1 @@\n-            NSK_CPP_STUB2(GetThreadCpuTimerInfo, jvmti, &info)))\n+            jvmti->GetThreadCpuTimerInfo(&info)))\n@@ -499,1 +485,1 @@\n-            NSK_CPP_STUB3(GetThreadCpuTime, jvmti, thread, &nanos)))\n+            jvmti->GetThreadCpuTime(thread, &nanos)))\n@@ -595,1 +581,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(GetPotentialCapabilities, jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->GetPotentialCapabilities(&caps)))\n@@ -607,1 +593,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(AddCapabilities, jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->AddCapabilities(&caps)))\n@@ -613,1 +599,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(GetCapabilities, jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->GetCapabilities(&caps)))\n@@ -625,1 +611,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(RelinquishCapabilities, jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->RelinquishCapabilities(&caps)))\n@@ -631,1 +617,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(GetCapabilities, jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->GetCapabilities(&caps)))\n@@ -643,1 +629,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(AddCapabilities, jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->AddCapabilities(&caps)))\n@@ -646,1 +632,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(GetCapabilities, jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->GetCapabilities(&caps)))\n","filename":"test\/hotspot\/jtreg\/vmTestbase\/nsk\/jvmti\/scenarios\/capability\/CM01\/cm01t002\/cm01t002.cpp","additions":64,"deletions":78,"binary":false,"changes":142,"status":"modified"},{"patch":"@@ -77,2 +77,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-           NSK_CPP_STUB3(GetAllThreads, jvmti, &threads_count, &threads)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->GetAllThreads(&threads_count, &threads)))\n@@ -90,2 +89,1 @@\n-        if (!NSK_JVMTI_VERIFY(\n-                NSK_CPP_STUB3(GetThreadInfo, jvmti, threads[i], &info)))\n+        if (!NSK_JVMTI_VERIFY(jvmti->GetThreadInfo(threads[i], &info)))\n@@ -103,2 +101,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-            NSK_CPP_STUB2(Deallocate, jvmti, (unsigned char*)threads)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->Deallocate((unsigned char*)threads)))\n@@ -108,2 +105,1 @@\n-    if (!NSK_JNI_VERIFY(jni, (klass =\n-            NSK_CPP_STUB2(GetObjectClass, jni, thread)) != NULL))\n+    if (!NSK_JNI_VERIFY(jni, (klass = jni->GetObjectClass(thread)) != NULL))\n@@ -113,2 +109,1 @@\n-    if (!NSK_JNI_VERIFY(jni, (method =\n-            NSK_CPP_STUB4(GetMethodID, jni, klass, \"run\", \"()V\")) != NULL))\n+    if (!NSK_JNI_VERIFY(jni, (method = jni->GetMethodID(klass, \"run\", \"()V\")) != NULL))\n@@ -119,2 +114,1 @@\n-            NSK_CPP_STUB4(GetFieldID, jni, klass,\n-                \"waitingMonitor\", \"Ljava\/lang\/Object;\")) != NULL))\n+            jni->GetFieldID(klass, \"waitingMonitor\", \"Ljava\/lang\/Object;\")) != NULL))\n@@ -134,2 +128,1 @@\n-    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY,\n-            NSK_CPP_STUB2(SuspendThread, jvmti, thread)))\n+    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY, jvmti->SuspendThread(thread)))\n@@ -139,2 +132,1 @@\n-    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY,\n-            NSK_CPP_STUB2(ResumeThread, jvmti, thread)))\n+    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY, jvmti->ResumeThread(thread)))\n@@ -145,1 +137,1 @@\n-            NSK_CPP_STUB4(SuspendThreadList, jvmti, 1, &thread, &err)))\n+            jvmti->SuspendThreadList(1, &thread, &err)))\n@@ -150,1 +142,1 @@\n-            NSK_CPP_STUB4(ResumeThreadList, jvmti, 1, &thread, &err)))\n+            jvmti->ResumeThreadList(1, &thread, &err)))\n@@ -166,2 +158,1 @@\n-    if (!NSK_JNI_VERIFY(jni, (cls =\n-            NSK_CPP_STUB2(FindClass, jni, THREAD_DEATH_CLASS_NAME)) != NULL))\n+    if (!NSK_JNI_VERIFY(jni, (cls = jni->FindClass(THREAD_DEATH_CLASS_NAME)) != NULL))\n@@ -171,2 +162,1 @@\n-            NSK_CPP_STUB4(GetMethodID, jni, cls,\n-                THREAD_DEATH_CTOR_NAME, THREAD_DEATH_CTOR_SIGNATURE)) != NULL))\n+            jni->GetMethodID(cls, THREAD_DEATH_CTOR_NAME, THREAD_DEATH_CTOR_SIGNATURE)) != NULL))\n@@ -175,2 +165,1 @@\n-    if (!NSK_JNI_VERIFY(jni, (exception =\n-            NSK_CPP_STUB3(NewObject, jni, cls, ctor)) != NULL))\n+    if (!NSK_JNI_VERIFY(jni, (exception = jni->NewObject(cls, ctor)) != NULL))\n@@ -181,1 +170,1 @@\n-            NSK_CPP_STUB3(StopThread, jvmti, thread, exception)))\n+            jvmti->StopThread(thread, exception)))\n@@ -185,2 +174,1 @@\n-    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY,\n-            NSK_CPP_STUB2(InterruptThread, jvmti, thread)))\n+    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY, jvmti->InterruptThread(thread)))\n@@ -200,1 +188,1 @@\n-            NSK_CPP_STUB4(GetOwnedMonitorInfo, jvmti, thread, &count, &monitors)))\n+            jvmti->GetOwnedMonitorInfo(thread, &count, &monitors)))\n@@ -213,1 +201,1 @@\n-            NSK_CPP_STUB3(GetCurrentContendedMonitor, jvmti, thread, &monitor)))\n+            jvmti->GetCurrentContendedMonitor(thread, &monitor)))\n@@ -223,2 +211,1 @@\n-    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY,\n-            NSK_CPP_STUB2(PopFrame, jvmti, thread)))\n+    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY, jvmti->PopFrame(thread)))\n@@ -268,1 +255,1 @@\n-            NSK_CPP_STUB3(SetTag, jvmti, thread, TAG_VALUE)))\n+            jvmti->SetTag(thread, TAG_VALUE)))\n@@ -272,2 +259,1 @@\n-    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY,\n-            NSK_CPP_STUB3(GetTag, jvmti, thread, &tag)))\n+    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY, jvmti->GetTag(thread, &tag)))\n@@ -279,2 +265,1 @@\n-            NSK_CPP_STUB6(GetObjectsWithTags, jvmti, 1, &tag,\n-                &count, &res_objects, &res_tags)))\n+            jvmti->GetObjectsWithTags(1, &tag, &count, &res_objects, &res_tags)))\n@@ -285,2 +270,1 @@\n-            NSK_CPP_STUB4(IterateOverHeap, jvmti, JVMTI_HEAP_OBJECT_TAGGED,\n-                HeapObject, &dummy_user_data)))\n+            jvmti->IterateOverHeap(JVMTI_HEAP_OBJECT_TAGGED, HeapObject, &dummy_user_data)))\n@@ -291,2 +275,4 @@\n-            NSK_CPP_STUB5(IterateOverInstancesOfClass, jvmti, klass,\n-                JVMTI_HEAP_OBJECT_UNTAGGED, HeapObject, &dummy_user_data)))\n+            jvmti->IterateOverInstancesOfClass(klass,\n+                                               JVMTI_HEAP_OBJECT_UNTAGGED,\n+                                               HeapObject,\n+                                               &dummy_user_data)))\n@@ -297,2 +283,3 @@\n-            NSK_CPP_STUB4(IterateOverObjectsReachableFromObject, jvmti, thread,\n-                ObjectReference, &dummy_user_data)))\n+            jvmti->IterateOverObjectsReachableFromObject(thread,\n+                                                         ObjectReference,\n+                                                         &dummy_user_data)))\n@@ -303,2 +290,4 @@\n-            NSK_CPP_STUB5(IterateOverReachableObjects, jvmti,\n-                HeapRoot, StackReference, ObjectReference, &dummy_user_data)))\n+            jvmti->IterateOverReachableObjects(HeapRoot,\n+                                               StackReference,\n+                                               ObjectReference,\n+                                               &dummy_user_data)))\n@@ -323,2 +312,1 @@\n-            NSK_CPP_STUB4(GetLocalVariableTable, jvmti, method, &count,\n-                &local_variable_table)))\n+            jvmti->GetLocalVariableTable(method, &count, &local_variable_table)))\n@@ -329,1 +317,1 @@\n-            NSK_CPP_STUB5(GetLocalObject, jvmti, thread, 0, 0, &object_value)))\n+            jvmti->GetLocalObject(thread, 0, 0, &object_value)))\n@@ -334,1 +322,1 @@\n-            NSK_CPP_STUB5(GetLocalInt, jvmti, thread, 0, 0, &int_value)))\n+            jvmti->GetLocalInt(thread, 0, 0, &int_value)))\n@@ -339,1 +327,1 @@\n-            NSK_CPP_STUB5(GetLocalLong, jvmti, thread, 0, 0, &long_value)))\n+            jvmti->GetLocalLong(thread, 0, 0, &long_value)))\n@@ -344,1 +332,1 @@\n-            NSK_CPP_STUB5(GetLocalFloat, jvmti, thread, 0, 0, &float_value)))\n+            jvmti->GetLocalFloat(thread, 0, 0, &float_value)))\n@@ -349,1 +337,1 @@\n-            NSK_CPP_STUB5(GetLocalDouble, jvmti, thread, 0, 0, &double_value)))\n+            jvmti->GetLocalDouble(thread, 0, 0, &double_value)))\n@@ -354,1 +342,1 @@\n-            NSK_CPP_STUB5(SetLocalObject, jvmti, thread, 0, 0, thread)))\n+            jvmti->SetLocalObject(thread, 0, 0, thread)))\n@@ -359,1 +347,1 @@\n-            NSK_CPP_STUB5(SetLocalInt, jvmti, thread, 0, 0, (jint)0)))\n+            jvmti->SetLocalInt(thread, 0, 0, (jint)0)))\n@@ -364,1 +352,1 @@\n-            NSK_CPP_STUB5(SetLocalLong, jvmti, thread, 0, 0, (jlong)0)))\n+            jvmti->SetLocalLong(thread, 0, 0, (jlong)0)))\n@@ -369,1 +357,1 @@\n-            NSK_CPP_STUB5(SetLocalFloat, jvmti, thread, 0, 0, (jfloat)0.0)))\n+            jvmti->SetLocalFloat(thread, 0, 0, (jfloat)0.0)))\n@@ -374,1 +362,1 @@\n-            NSK_CPP_STUB5(SetLocalDouble, jvmti, thread, 0, 0, (jdouble)0.0)))\n+            jvmti->SetLocalDouble(thread, 0, 0, (jdouble)0.0)))\n@@ -389,1 +377,1 @@\n-            NSK_CPP_STUB3(GetSourceFileName, jvmti, klass, &name)))\n+            jvmti->GetSourceFileName(klass, &name)))\n@@ -394,1 +382,1 @@\n-            NSK_CPP_STUB3(GetSourceDebugExtension, jvmti, klass, &name)))\n+            jvmti->GetSourceDebugExtension(klass, &name)))\n@@ -399,2 +387,1 @@\n-            NSK_CPP_STUB4(GetLineNumberTable, jvmti, method, &count,\n-                &line_number_table)))\n+            jvmti->GetLineNumberTable(method, &count, &line_number_table)))\n@@ -416,1 +403,1 @@\n-            NSK_CPP_STUB3(RedefineClasses, jvmti, 1, &class_def)))\n+            jvmti->RedefineClasses(1, &class_def)))\n@@ -429,1 +416,1 @@\n-            NSK_CPP_STUB3(GetObjectMonitorUsage, jvmti, thread, &monitor_info)))\n+            jvmti->GetObjectMonitorUsage(thread, &monitor_info)))\n@@ -441,2 +428,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-            NSK_CPP_STUB4(IsFieldSynthetic, jvmti, klass, field, &is_synthetic)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->IsFieldSynthetic(klass, field, &is_synthetic)))\n@@ -446,2 +432,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-            NSK_CPP_STUB3(IsMethodSynthetic, jvmti, method, &is_synthetic)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->IsMethodSynthetic(method, &is_synthetic)))\n@@ -461,1 +446,1 @@\n-            NSK_CPP_STUB4(GetBytecodes, jvmti, method, &count, &bytecodes)))\n+            jvmti->GetBytecodes(method, &count, &bytecodes)))\n@@ -475,1 +460,1 @@\n-            NSK_CPP_STUB2(GetCurrentThreadCpuTimerInfo, jvmti, &info)))\n+            jvmti->GetCurrentThreadCpuTimerInfo(&info)))\n@@ -480,1 +465,1 @@\n-            NSK_CPP_STUB2(GetCurrentThreadCpuTime, jvmti, &nanos)))\n+            jvmti->GetCurrentThreadCpuTime(&nanos)))\n@@ -494,1 +479,1 @@\n-            NSK_CPP_STUB2(GetThreadCpuTimerInfo, jvmti, &info)))\n+            jvmti->GetThreadCpuTimerInfo(&info)))\n@@ -499,1 +484,1 @@\n-            NSK_CPP_STUB3(GetThreadCpuTime, jvmti, thread, &nanos)))\n+            jvmti->GetThreadCpuTime(thread, &nanos)))\n@@ -595,1 +580,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(GetPotentialCapabilities, jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->GetPotentialCapabilities(&caps)))\n@@ -607,1 +592,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(AddCapabilities, jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->AddCapabilities(&caps)))\n@@ -613,1 +598,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(GetCapabilities, jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->GetCapabilities(&caps)))\n@@ -625,1 +610,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(RelinquishCapabilities, jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->RelinquishCapabilities(&caps)))\n@@ -631,1 +616,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(GetCapabilities, jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->GetCapabilities(&caps)))\n@@ -643,1 +628,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(AddCapabilities, jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->AddCapabilities(&caps)))\n@@ -646,1 +631,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(GetCapabilities, jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->GetCapabilities(&caps)))\n","filename":"test\/hotspot\/jtreg\/vmTestbase\/nsk\/jvmti\/scenarios\/capability\/CM01\/cm01t003\/cm01t003.cpp","additions":63,"deletions":78,"binary":false,"changes":141,"status":"modified"},{"patch":"@@ -75,2 +75,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-           NSK_CPP_STUB3(GetAllThreads, jvmti, &threads_count, &threads)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->GetAllThreads(&threads_count, &threads)))\n@@ -88,2 +87,1 @@\n-        if (!NSK_JVMTI_VERIFY(\n-                NSK_CPP_STUB3(GetThreadInfo, jvmti, threads[i], &info)))\n+        if (!NSK_JVMTI_VERIFY(jvmti->GetThreadInfo(threads[i], &info)))\n@@ -101,2 +99,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-            NSK_CPP_STUB2(Deallocate, jvmti, (unsigned char*)threads)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->Deallocate((unsigned char*)threads)))\n@@ -106,2 +103,1 @@\n-    if (!NSK_JNI_VERIFY(jni, (klass =\n-            NSK_CPP_STUB2(GetObjectClass, jni, thread)) != NULL))\n+    if (!NSK_JNI_VERIFY(jni, (klass = jni->GetObjectClass(thread)) != NULL))\n@@ -111,2 +107,1 @@\n-    if (!NSK_JNI_VERIFY(jni, (method =\n-            NSK_CPP_STUB4(GetMethodID, jni, klass, \"run\", \"()V\")) != NULL))\n+    if (!NSK_JNI_VERIFY(jni, (method = jni->GetMethodID(klass, \"run\", \"()V\")) != NULL))\n@@ -117,2 +112,1 @@\n-            NSK_CPP_STUB4(GetFieldID, jni, klass,\n-                \"waitingMonitor\", \"Ljava\/lang\/Object;\")) != NULL))\n+            jni->GetFieldID(klass, \"waitingMonitor\", \"Ljava\/lang\/Object;\")) != NULL))\n@@ -132,2 +126,1 @@\n-    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY,\n-            NSK_CPP_STUB2(SuspendThread, jvmti, thread)))\n+    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY, jvmti->SuspendThread(thread)))\n@@ -137,2 +130,1 @@\n-    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY,\n-            NSK_CPP_STUB2(ResumeThread, jvmti, thread)))\n+    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY, jvmti->ResumeThread(thread)))\n@@ -143,1 +135,1 @@\n-            NSK_CPP_STUB4(SuspendThreadList, jvmti, 1, &thread, &err)))\n+            jvmti->SuspendThreadList(1, &thread, &err)))\n@@ -148,1 +140,1 @@\n-            NSK_CPP_STUB4(ResumeThreadList, jvmti, 1, &thread, &err)))\n+            jvmti->ResumeThreadList(1, &thread, &err)))\n@@ -164,2 +156,1 @@\n-    if (!NSK_JNI_VERIFY(jni, (cls =\n-            NSK_CPP_STUB2(FindClass, jni, THREAD_DEATH_CLASS_NAME)) != NULL))\n+    if (!NSK_JNI_VERIFY(jni, (cls = jni->FindClass(THREAD_DEATH_CLASS_NAME)) != NULL))\n@@ -169,2 +160,1 @@\n-            NSK_CPP_STUB4(GetMethodID, jni, cls,\n-                THREAD_DEATH_CTOR_NAME, THREAD_DEATH_CTOR_SIGNATURE)) != NULL))\n+            jni->GetMethodID(cls, THREAD_DEATH_CTOR_NAME, THREAD_DEATH_CTOR_SIGNATURE)) != NULL))\n@@ -173,2 +163,1 @@\n-    if (!NSK_JNI_VERIFY(jni, (exception =\n-            NSK_CPP_STUB3(NewObject, jni, cls, ctor)) != NULL))\n+    if (!NSK_JNI_VERIFY(jni, (exception = jni->NewObject(cls, ctor)) != NULL))\n@@ -179,1 +168,1 @@\n-            NSK_CPP_STUB3(StopThread, jvmti, thread, exception)))\n+            jvmti->StopThread(thread, exception)))\n@@ -183,2 +172,1 @@\n-    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY,\n-            NSK_CPP_STUB2(InterruptThread, jvmti, thread)))\n+    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY, jvmti->InterruptThread(thread)))\n@@ -197,2 +185,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-            NSK_CPP_STUB4(GetOwnedMonitorInfo, jvmti, thread, &count, &monitors)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->GetOwnedMonitorInfo(thread, &count, &monitors)))\n@@ -211,1 +198,1 @@\n-            NSK_CPP_STUB3(GetCurrentContendedMonitor, jvmti, thread, &monitor)))\n+            jvmti->GetCurrentContendedMonitor(thread, &monitor)))\n@@ -221,2 +208,1 @@\n-    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY,\n-            NSK_CPP_STUB2(PopFrame, jvmti, thread)))\n+    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY, jvmti->PopFrame(thread)))\n@@ -266,1 +252,1 @@\n-            NSK_CPP_STUB3(SetTag, jvmti, thread, TAG_VALUE)))\n+            jvmti->SetTag(thread, TAG_VALUE)))\n@@ -270,2 +256,1 @@\n-    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY,\n-            NSK_CPP_STUB3(GetTag, jvmti, thread, &tag)))\n+    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY, jvmti->GetTag(thread, &tag)))\n@@ -277,2 +262,1 @@\n-            NSK_CPP_STUB6(GetObjectsWithTags, jvmti, 1, &tag,\n-                &count, &res_objects, &res_tags)))\n+            jvmti->GetObjectsWithTags(1, &tag, &count, &res_objects, &res_tags)))\n@@ -283,2 +267,1 @@\n-            NSK_CPP_STUB4(IterateOverHeap, jvmti, JVMTI_HEAP_OBJECT_TAGGED,\n-                HeapObject, &dummy_user_data)))\n+            jvmti->IterateOverHeap(JVMTI_HEAP_OBJECT_TAGGED, HeapObject, &dummy_user_data)))\n@@ -289,2 +272,4 @@\n-            NSK_CPP_STUB5(IterateOverInstancesOfClass, jvmti, klass,\n-                JVMTI_HEAP_OBJECT_UNTAGGED, HeapObject, &dummy_user_data)))\n+            jvmti->IterateOverInstancesOfClass(klass,\n+                                               JVMTI_HEAP_OBJECT_UNTAGGED,\n+                                               HeapObject,\n+                                               &dummy_user_data)))\n@@ -295,2 +280,3 @@\n-            NSK_CPP_STUB4(IterateOverObjectsReachableFromObject, jvmti, thread,\n-                ObjectReference, &dummy_user_data)))\n+            jvmti->IterateOverObjectsReachableFromObject(thread,\n+                                                         ObjectReference,\n+                                                         &dummy_user_data)))\n@@ -301,2 +287,4 @@\n-            NSK_CPP_STUB5(IterateOverReachableObjects, jvmti,\n-                HeapRoot, StackReference, ObjectReference, &dummy_user_data)))\n+            jvmti->IterateOverReachableObjects(HeapRoot,\n+                                               StackReference,\n+                                               ObjectReference,\n+                                               &dummy_user_data)))\n@@ -321,2 +309,1 @@\n-            NSK_CPP_STUB4(GetLocalVariableTable, jvmti, method, &count,\n-                &local_variable_table)))\n+            jvmti->GetLocalVariableTable(method, &count, &local_variable_table)))\n@@ -327,1 +314,1 @@\n-            NSK_CPP_STUB5(GetLocalObject, jvmti, thread, 0, 0, &object_value)))\n+            jvmti->GetLocalObject(thread, 0, 0, &object_value)))\n@@ -332,1 +319,1 @@\n-            NSK_CPP_STUB5(GetLocalInt, jvmti, thread, 0, 0, &int_value)))\n+            jvmti->GetLocalInt(thread, 0, 0, &int_value)))\n@@ -337,1 +324,1 @@\n-            NSK_CPP_STUB5(GetLocalLong, jvmti, thread, 0, 0, &long_value)))\n+            jvmti->GetLocalLong(thread, 0, 0, &long_value)))\n@@ -342,1 +329,1 @@\n-            NSK_CPP_STUB5(GetLocalFloat, jvmti, thread, 0, 0, &float_value)))\n+            jvmti->GetLocalFloat(thread, 0, 0, &float_value)))\n@@ -347,1 +334,1 @@\n-            NSK_CPP_STUB5(GetLocalDouble, jvmti, thread, 0, 0, &double_value)))\n+            jvmti->GetLocalDouble(thread, 0, 0, &double_value)))\n@@ -352,1 +339,1 @@\n-            NSK_CPP_STUB5(SetLocalObject, jvmti, thread, 0, 0, thread)))\n+            jvmti->SetLocalObject(thread, 0, 0, thread)))\n@@ -357,1 +344,1 @@\n-            NSK_CPP_STUB5(SetLocalInt, jvmti, thread, 0, 0, (jint)0)))\n+            jvmti->SetLocalInt(thread, 0, 0, (jint)0)))\n@@ -362,1 +349,1 @@\n-            NSK_CPP_STUB5(SetLocalLong, jvmti, thread, 0, 0, (jlong)0)))\n+            jvmti->SetLocalLong(thread, 0, 0, (jlong)0)))\n@@ -367,1 +354,1 @@\n-            NSK_CPP_STUB5(SetLocalFloat, jvmti, thread, 0, 0, (jfloat)0.0)))\n+            jvmti->SetLocalFloat(thread, 0, 0, (jfloat)0.0)))\n@@ -372,1 +359,1 @@\n-            NSK_CPP_STUB5(SetLocalDouble, jvmti, thread, 0, 0, (jdouble)0.0)))\n+            jvmti->SetLocalDouble(thread, 0, 0, (jdouble)0.0)))\n@@ -387,1 +374,1 @@\n-            NSK_CPP_STUB3(GetSourceFileName, jvmti, klass, &name)))\n+            jvmti->GetSourceFileName(klass, &name)))\n@@ -392,1 +379,1 @@\n-            NSK_CPP_STUB3(GetSourceDebugExtension, jvmti, klass, &name)))\n+            jvmti->GetSourceDebugExtension(klass, &name)))\n@@ -397,2 +384,1 @@\n-            NSK_CPP_STUB4(GetLineNumberTable, jvmti, method, &count,\n-                &line_number_table)))\n+            jvmti->GetLineNumberTable(method, &count, &line_number_table)))\n@@ -414,1 +400,1 @@\n-            NSK_CPP_STUB3(RedefineClasses, jvmti, 1, &class_def)))\n+            jvmti->RedefineClasses(1, &class_def)))\n@@ -427,1 +413,1 @@\n-            NSK_CPP_STUB3(GetObjectMonitorUsage, jvmti, thread, &monitor_info)))\n+            jvmti->GetObjectMonitorUsage(thread, &monitor_info)))\n@@ -440,1 +426,1 @@\n-            NSK_CPP_STUB4(IsFieldSynthetic, jvmti, klass, field, &is_synthetic)))\n+            jvmti->IsFieldSynthetic(klass, field, &is_synthetic)))\n@@ -445,1 +431,1 @@\n-            NSK_CPP_STUB3(IsMethodSynthetic, jvmti, method, &is_synthetic)))\n+            jvmti->IsMethodSynthetic(method, &is_synthetic)))\n@@ -459,1 +445,1 @@\n-            NSK_CPP_STUB4(GetBytecodes, jvmti, method, &count, &bytecodes)))\n+            jvmti->GetBytecodes(method, &count, &bytecodes)))\n@@ -473,1 +459,1 @@\n-            NSK_CPP_STUB2(GetCurrentThreadCpuTimerInfo, jvmti, &info)))\n+            jvmti->GetCurrentThreadCpuTimerInfo(&info)))\n@@ -478,1 +464,1 @@\n-            NSK_CPP_STUB2(GetCurrentThreadCpuTime, jvmti, &nanos)))\n+            jvmti->GetCurrentThreadCpuTime(&nanos)))\n@@ -492,1 +478,1 @@\n-            NSK_CPP_STUB2(GetThreadCpuTimerInfo, jvmti, &info)))\n+            jvmti->GetThreadCpuTimerInfo(&info)))\n@@ -497,1 +483,1 @@\n-            NSK_CPP_STUB3(GetThreadCpuTime, jvmti, thread, &nanos)))\n+            jvmti->GetThreadCpuTime(thread, &nanos)))\n@@ -593,1 +579,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(GetPotentialCapabilities, jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->GetPotentialCapabilities(&caps)))\n@@ -605,1 +591,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(AddCapabilities, jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->AddCapabilities(&caps)))\n@@ -611,1 +597,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(GetCapabilities, jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->GetCapabilities(&caps)))\n@@ -623,1 +609,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(RelinquishCapabilities, jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->RelinquishCapabilities(&caps)))\n@@ -629,1 +615,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(GetCapabilities, jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->GetCapabilities(&caps)))\n@@ -641,1 +627,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(AddCapabilities, jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->AddCapabilities(&caps)))\n@@ -644,1 +630,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(GetCapabilities, jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->GetCapabilities(&caps)))\n","filename":"test\/hotspot\/jtreg\/vmTestbase\/nsk\/jvmti\/scenarios\/capability\/CM01\/cm01t004\/cm01t004.cpp","additions":63,"deletions":77,"binary":false,"changes":140,"status":"modified"},{"patch":"@@ -75,2 +75,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-           NSK_CPP_STUB3(GetAllThreads, jvmti, &threads_count, &threads)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->GetAllThreads(&threads_count, &threads)))\n@@ -88,2 +87,1 @@\n-        if (!NSK_JVMTI_VERIFY(\n-                NSK_CPP_STUB3(GetThreadInfo, jvmti, threads[i], &info)))\n+        if (!NSK_JVMTI_VERIFY(jvmti->GetThreadInfo(threads[i], &info)))\n@@ -101,2 +99,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-            NSK_CPP_STUB2(Deallocate, jvmti, (unsigned char*)threads)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->Deallocate((unsigned char*)threads)))\n@@ -106,2 +103,1 @@\n-    if (!NSK_JNI_VERIFY(jni, (klass =\n-            NSK_CPP_STUB2(GetObjectClass, jni, thread)) != NULL))\n+    if (!NSK_JNI_VERIFY(jni, (klass = jni->GetObjectClass(thread)) != NULL))\n@@ -111,2 +107,1 @@\n-    if (!NSK_JNI_VERIFY(jni, (method =\n-            NSK_CPP_STUB4(GetMethodID, jni, klass, \"run\", \"()V\")) != NULL))\n+    if (!NSK_JNI_VERIFY(jni, (method = jni->GetMethodID(klass, \"run\", \"()V\")) != NULL))\n@@ -117,2 +112,1 @@\n-            NSK_CPP_STUB4(GetFieldID, jni, klass,\n-                \"waitingMonitor\", \"Ljava\/lang\/Object;\")) != NULL))\n+            jni->GetFieldID(klass, \"waitingMonitor\", \"Ljava\/lang\/Object;\")) != NULL))\n@@ -132,2 +126,1 @@\n-    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY,\n-            NSK_CPP_STUB2(SuspendThread, jvmti, thread)))\n+    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY, jvmti->SuspendThread(thread)))\n@@ -137,2 +130,1 @@\n-    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY,\n-            NSK_CPP_STUB2(ResumeThread, jvmti, thread)))\n+    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY, jvmti->ResumeThread(thread)))\n@@ -143,1 +135,1 @@\n-            NSK_CPP_STUB4(SuspendThreadList, jvmti, 1, &thread, &err)))\n+            jvmti->SuspendThreadList(1, &thread, &err)))\n@@ -148,1 +140,1 @@\n-            NSK_CPP_STUB4(ResumeThreadList, jvmti, 1, &thread, &err)))\n+            jvmti->ResumeThreadList(1, &thread, &err)))\n@@ -164,2 +156,1 @@\n-    if (!NSK_JNI_VERIFY(jni, (cls =\n-            NSK_CPP_STUB2(FindClass, jni, THREAD_DEATH_CLASS_NAME)) != NULL))\n+    if (!NSK_JNI_VERIFY(jni, (cls = jni->FindClass(THREAD_DEATH_CLASS_NAME)) != NULL))\n@@ -169,2 +160,1 @@\n-            NSK_CPP_STUB4(GetMethodID, jni, cls,\n-                THREAD_DEATH_CTOR_NAME, THREAD_DEATH_CTOR_SIGNATURE)) != NULL))\n+            jni->GetMethodID(cls, THREAD_DEATH_CTOR_NAME, THREAD_DEATH_CTOR_SIGNATURE)) != NULL))\n@@ -173,2 +163,1 @@\n-    if (!NSK_JNI_VERIFY(jni, (exception =\n-            NSK_CPP_STUB3(NewObject, jni, cls, ctor)) != NULL))\n+    if (!NSK_JNI_VERIFY(jni, (exception = jni->NewObject(cls, ctor)) != NULL))\n@@ -179,1 +168,1 @@\n-            NSK_CPP_STUB3(StopThread, jvmti, thread, exception)))\n+            jvmti->StopThread(thread, exception)))\n@@ -183,2 +172,1 @@\n-    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY,\n-            NSK_CPP_STUB2(InterruptThread, jvmti, thread)))\n+    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY, jvmti->InterruptThread(thread)))\n@@ -198,1 +186,1 @@\n-            NSK_CPP_STUB4(GetOwnedMonitorInfo, jvmti, thread, &count, &monitors)))\n+            jvmti->GetOwnedMonitorInfo(thread, &count, &monitors)))\n@@ -210,2 +198,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-            NSK_CPP_STUB3(GetCurrentContendedMonitor, jvmti, thread, &monitor)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->GetCurrentContendedMonitor(thread, &monitor)))\n@@ -221,2 +208,1 @@\n-    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY,\n-            NSK_CPP_STUB2(PopFrame, jvmti, thread)))\n+    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY, jvmti->PopFrame(thread)))\n@@ -266,1 +252,1 @@\n-            NSK_CPP_STUB3(SetTag, jvmti, thread, TAG_VALUE)))\n+            jvmti->SetTag(thread, TAG_VALUE)))\n@@ -270,2 +256,1 @@\n-    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY,\n-            NSK_CPP_STUB3(GetTag, jvmti, thread, &tag)))\n+    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY, jvmti->GetTag(thread, &tag)))\n@@ -277,2 +262,1 @@\n-            NSK_CPP_STUB6(GetObjectsWithTags, jvmti, 1, &tag,\n-                &count, &res_objects, &res_tags)))\n+            jvmti->GetObjectsWithTags(1, &tag, &count, &res_objects, &res_tags)))\n@@ -283,2 +267,1 @@\n-            NSK_CPP_STUB4(IterateOverHeap, jvmti, JVMTI_HEAP_OBJECT_TAGGED,\n-                HeapObject, &dummy_user_data)))\n+            jvmti->IterateOverHeap(JVMTI_HEAP_OBJECT_TAGGED, HeapObject, &dummy_user_data)))\n@@ -289,2 +272,4 @@\n-            NSK_CPP_STUB5(IterateOverInstancesOfClass, jvmti, klass,\n-                JVMTI_HEAP_OBJECT_UNTAGGED, HeapObject, &dummy_user_data)))\n+            jvmti->IterateOverInstancesOfClass(klass,\n+                                               JVMTI_HEAP_OBJECT_UNTAGGED,\n+                                               HeapObject,\n+                                               &dummy_user_data)))\n@@ -295,2 +280,3 @@\n-            NSK_CPP_STUB4(IterateOverObjectsReachableFromObject, jvmti, thread,\n-                ObjectReference, &dummy_user_data)))\n+            jvmti->IterateOverObjectsReachableFromObject(thread,\n+                                                         ObjectReference,\n+                                                         &dummy_user_data)))\n@@ -301,2 +287,4 @@\n-            NSK_CPP_STUB5(IterateOverReachableObjects, jvmti,\n-                HeapRoot, StackReference, ObjectReference, &dummy_user_data)))\n+            jvmti->IterateOverReachableObjects(HeapRoot,\n+                                               StackReference,\n+                                               ObjectReference,\n+                                               &dummy_user_data)))\n@@ -321,2 +309,1 @@\n-            NSK_CPP_STUB4(GetLocalVariableTable, jvmti, method, &count,\n-                &local_variable_table)))\n+            jvmti->GetLocalVariableTable(method, &count, &local_variable_table)))\n@@ -327,1 +314,1 @@\n-            NSK_CPP_STUB5(GetLocalObject, jvmti, thread, 0, 0, &object_value)))\n+            jvmti->GetLocalObject(thread, 0, 0, &object_value)))\n@@ -332,1 +319,1 @@\n-            NSK_CPP_STUB5(GetLocalInt, jvmti, thread, 0, 0, &int_value)))\n+            jvmti->GetLocalInt(thread, 0, 0, &int_value)))\n@@ -337,1 +324,1 @@\n-            NSK_CPP_STUB5(GetLocalLong, jvmti, thread, 0, 0, &long_value)))\n+            jvmti->GetLocalLong(thread, 0, 0, &long_value)))\n@@ -342,1 +329,1 @@\n-            NSK_CPP_STUB5(GetLocalFloat, jvmti, thread, 0, 0, &float_value)))\n+            jvmti->GetLocalFloat(thread, 0, 0, &float_value)))\n@@ -347,1 +334,1 @@\n-            NSK_CPP_STUB5(GetLocalDouble, jvmti, thread, 0, 0, &double_value)))\n+            jvmti->GetLocalDouble(thread, 0, 0, &double_value)))\n@@ -352,1 +339,1 @@\n-            NSK_CPP_STUB5(SetLocalObject, jvmti, thread, 0, 0, thread)))\n+            jvmti->SetLocalObject(thread, 0, 0, thread)))\n@@ -357,1 +344,1 @@\n-            NSK_CPP_STUB5(SetLocalInt, jvmti, thread, 0, 0, (jint)0)))\n+            jvmti->SetLocalInt(thread, 0, 0, (jint)0)))\n@@ -362,1 +349,1 @@\n-            NSK_CPP_STUB5(SetLocalLong, jvmti, thread, 0, 0, (jlong)0)))\n+            jvmti->SetLocalLong(thread, 0, 0, (jlong)0)))\n@@ -367,1 +354,1 @@\n-            NSK_CPP_STUB5(SetLocalFloat, jvmti, thread, 0, 0, (jfloat)0.0)))\n+            jvmti->SetLocalFloat(thread, 0, 0, (jfloat)0.0)))\n@@ -372,1 +359,1 @@\n-            NSK_CPP_STUB5(SetLocalDouble, jvmti, thread, 0, 0, (jdouble)0.0)))\n+            jvmti->SetLocalDouble(thread, 0, 0, (jdouble)0.0)))\n@@ -387,1 +374,1 @@\n-            NSK_CPP_STUB3(GetSourceFileName, jvmti, klass, &name)))\n+            jvmti->GetSourceFileName(klass, &name)))\n@@ -392,1 +379,1 @@\n-            NSK_CPP_STUB3(GetSourceDebugExtension, jvmti, klass, &name)))\n+            jvmti->GetSourceDebugExtension(klass, &name)))\n@@ -397,2 +384,1 @@\n-            NSK_CPP_STUB4(GetLineNumberTable, jvmti, method, &count,\n-                &line_number_table)))\n+            jvmti->GetLineNumberTable(method, &count, &line_number_table)))\n@@ -414,1 +400,1 @@\n-            NSK_CPP_STUB3(RedefineClasses, jvmti, 1, &class_def)))\n+            jvmti->RedefineClasses(1, &class_def)))\n@@ -427,1 +413,1 @@\n-            NSK_CPP_STUB3(GetObjectMonitorUsage, jvmti, thread, &monitor_info)))\n+            jvmti->GetObjectMonitorUsage(thread, &monitor_info)))\n@@ -440,1 +426,1 @@\n-            NSK_CPP_STUB4(IsFieldSynthetic, jvmti, klass, field, &is_synthetic)))\n+            jvmti->IsFieldSynthetic(klass, field, &is_synthetic)))\n@@ -445,1 +431,1 @@\n-            NSK_CPP_STUB3(IsMethodSynthetic, jvmti, method, &is_synthetic)))\n+            jvmti->IsMethodSynthetic(method, &is_synthetic)))\n@@ -459,1 +445,1 @@\n-            NSK_CPP_STUB4(GetBytecodes, jvmti, method, &count, &bytecodes)))\n+            jvmti->GetBytecodes(method, &count, &bytecodes)))\n@@ -473,1 +459,1 @@\n-            NSK_CPP_STUB2(GetCurrentThreadCpuTimerInfo, jvmti, &info)))\n+            jvmti->GetCurrentThreadCpuTimerInfo(&info)))\n@@ -478,1 +464,1 @@\n-            NSK_CPP_STUB2(GetCurrentThreadCpuTime, jvmti, &nanos)))\n+            jvmti->GetCurrentThreadCpuTime(&nanos)))\n@@ -492,1 +478,1 @@\n-            NSK_CPP_STUB2(GetThreadCpuTimerInfo, jvmti, &info)))\n+            jvmti->GetThreadCpuTimerInfo(&info)))\n@@ -497,1 +483,1 @@\n-            NSK_CPP_STUB3(GetThreadCpuTime, jvmti, thread, &nanos)))\n+            jvmti->GetThreadCpuTime(thread, &nanos)))\n@@ -593,1 +579,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(GetPotentialCapabilities, jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->GetPotentialCapabilities(&caps)))\n@@ -605,1 +591,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(AddCapabilities, jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->AddCapabilities(&caps)))\n@@ -611,1 +597,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(GetCapabilities, jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->GetCapabilities(&caps)))\n@@ -623,1 +609,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(RelinquishCapabilities, jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->RelinquishCapabilities(&caps)))\n@@ -629,1 +615,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(GetCapabilities, jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->GetCapabilities(&caps)))\n@@ -641,1 +627,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(AddCapabilities, jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->AddCapabilities(&caps)))\n@@ -644,1 +630,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(GetCapabilities, jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->GetCapabilities(&caps)))\n","filename":"test\/hotspot\/jtreg\/vmTestbase\/nsk\/jvmti\/scenarios\/capability\/CM01\/cm01t005\/cm01t005.cpp","additions":63,"deletions":77,"binary":false,"changes":140,"status":"modified"},{"patch":"@@ -75,2 +75,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-           NSK_CPP_STUB3(GetAllThreads, jvmti, &threads_count, &threads)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->GetAllThreads(&threads_count, &threads)))\n@@ -88,2 +87,1 @@\n-        if (!NSK_JVMTI_VERIFY(\n-                NSK_CPP_STUB3(GetThreadInfo, jvmti, threads[i], &info)))\n+        if (!NSK_JVMTI_VERIFY(jvmti->GetThreadInfo(threads[i], &info)))\n@@ -101,2 +99,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-            NSK_CPP_STUB2(Deallocate, jvmti, (unsigned char*)threads)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->Deallocate((unsigned char*)threads)))\n@@ -106,2 +103,1 @@\n-    if (!NSK_JNI_VERIFY(jni, (klass =\n-            NSK_CPP_STUB2(GetObjectClass, jni, thread)) != NULL))\n+    if (!NSK_JNI_VERIFY(jni, (klass = jni->GetObjectClass(thread)) != NULL))\n@@ -111,2 +107,1 @@\n-    if (!NSK_JNI_VERIFY(jni, (method =\n-            NSK_CPP_STUB4(GetMethodID, jni, klass, \"run\", \"()V\")) != NULL))\n+    if (!NSK_JNI_VERIFY(jni, (method = jni->GetMethodID(klass, \"run\", \"()V\")) != NULL))\n@@ -117,2 +112,1 @@\n-            NSK_CPP_STUB4(GetFieldID, jni, klass,\n-                \"waitingMonitor\", \"Ljava\/lang\/Object;\")) != NULL))\n+            jni->GetFieldID(klass, \"waitingMonitor\", \"Ljava\/lang\/Object;\")) != NULL))\n@@ -132,2 +126,1 @@\n-    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY,\n-            NSK_CPP_STUB2(SuspendThread, jvmti, thread)))\n+    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY, jvmti->SuspendThread(thread)))\n@@ -137,2 +130,1 @@\n-    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY,\n-            NSK_CPP_STUB2(ResumeThread, jvmti, thread)))\n+    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY, jvmti->ResumeThread(thread)))\n@@ -143,1 +135,1 @@\n-            NSK_CPP_STUB4(SuspendThreadList, jvmti, 1, &thread, &err)))\n+            jvmti->SuspendThreadList(1, &thread, &err)))\n@@ -148,1 +140,1 @@\n-            NSK_CPP_STUB4(ResumeThreadList, jvmti, 1, &thread, &err)))\n+            jvmti->ResumeThreadList(1, &thread, &err)))\n@@ -164,2 +156,1 @@\n-    if (!NSK_JNI_VERIFY(jni, (cls =\n-            NSK_CPP_STUB2(FindClass, jni, THREAD_DEATH_CLASS_NAME)) != NULL))\n+    if (!NSK_JNI_VERIFY(jni, (cls = jni->FindClass(THREAD_DEATH_CLASS_NAME)) != NULL))\n@@ -169,2 +160,1 @@\n-            NSK_CPP_STUB4(GetMethodID, jni, cls,\n-                THREAD_DEATH_CTOR_NAME, THREAD_DEATH_CTOR_SIGNATURE)) != NULL))\n+            jni->GetMethodID(cls, THREAD_DEATH_CTOR_NAME, THREAD_DEATH_CTOR_SIGNATURE)) != NULL))\n@@ -173,2 +163,1 @@\n-    if (!NSK_JNI_VERIFY(jni, (exception =\n-            NSK_CPP_STUB3(NewObject, jni, cls, ctor)) != NULL))\n+    if (!NSK_JNI_VERIFY(jni, (exception = jni->NewObject(cls, ctor)) != NULL))\n@@ -179,1 +168,1 @@\n-            NSK_CPP_STUB3(StopThread, jvmti, thread, exception)))\n+            jvmti->StopThread(thread, exception)))\n@@ -183,2 +172,1 @@\n-    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY,\n-            NSK_CPP_STUB2(InterruptThread, jvmti, thread)))\n+    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY, jvmti->InterruptThread(thread)))\n@@ -198,1 +186,1 @@\n-            NSK_CPP_STUB4(GetOwnedMonitorInfo, jvmti, thread, &count, &monitors)))\n+            jvmti->GetOwnedMonitorInfo(thread, &count, &monitors)))\n@@ -211,1 +199,1 @@\n-            NSK_CPP_STUB3(GetCurrentContendedMonitor, jvmti, thread, &monitor)))\n+            jvmti->GetCurrentContendedMonitor(thread, &monitor)))\n@@ -221,2 +209,1 @@\n-    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY,\n-            NSK_CPP_STUB2(PopFrame, jvmti, thread)))\n+    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY, jvmti->PopFrame(thread)))\n@@ -266,1 +253,1 @@\n-            NSK_CPP_STUB3(SetTag, jvmti, thread, TAG_VALUE)))\n+            jvmti->SetTag(thread, TAG_VALUE)))\n@@ -270,2 +257,1 @@\n-    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY,\n-            NSK_CPP_STUB3(GetTag, jvmti, thread, &tag)))\n+    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY, jvmti->GetTag(thread, &tag)))\n@@ -277,2 +263,1 @@\n-            NSK_CPP_STUB6(GetObjectsWithTags, jvmti, 1, &tag,\n-                &count, &res_objects, &res_tags)))\n+            jvmti->GetObjectsWithTags(1, &tag, &count, &res_objects, &res_tags)))\n@@ -283,2 +268,1 @@\n-            NSK_CPP_STUB4(IterateOverHeap, jvmti, JVMTI_HEAP_OBJECT_TAGGED,\n-                HeapObject, &dummy_user_data)))\n+            jvmti->IterateOverHeap(JVMTI_HEAP_OBJECT_TAGGED, HeapObject, &dummy_user_data)))\n@@ -289,2 +273,4 @@\n-            NSK_CPP_STUB5(IterateOverInstancesOfClass, jvmti, klass,\n-                JVMTI_HEAP_OBJECT_UNTAGGED, HeapObject, &dummy_user_data)))\n+            jvmti->IterateOverInstancesOfClass(klass,\n+                                               JVMTI_HEAP_OBJECT_UNTAGGED,\n+                                               HeapObject,\n+                                               &dummy_user_data)))\n@@ -295,2 +281,3 @@\n-            NSK_CPP_STUB4(IterateOverObjectsReachableFromObject, jvmti, thread,\n-                ObjectReference, &dummy_user_data)))\n+            jvmti->IterateOverObjectsReachableFromObject(thread,\n+                                                         ObjectReference,\n+                                                         &dummy_user_data)))\n@@ -301,2 +288,4 @@\n-            NSK_CPP_STUB5(IterateOverReachableObjects, jvmti,\n-                HeapRoot, StackReference, ObjectReference, &dummy_user_data)))\n+            jvmti->IterateOverReachableObjects(HeapRoot,\n+                                               StackReference,\n+                                               ObjectReference,\n+                                               &dummy_user_data)))\n@@ -321,2 +310,1 @@\n-            NSK_CPP_STUB4(GetLocalVariableTable, jvmti, method, &count,\n-                &local_variable_table)))\n+            jvmti->GetLocalVariableTable(method, &count, &local_variable_table)))\n@@ -327,1 +315,1 @@\n-            NSK_CPP_STUB5(GetLocalObject, jvmti, thread, 0, 0, &object_value)))\n+            jvmti->GetLocalObject(thread, 0, 0, &object_value)))\n@@ -332,1 +320,1 @@\n-            NSK_CPP_STUB5(GetLocalInt, jvmti, thread, 0, 0, &int_value)))\n+            jvmti->GetLocalInt(thread, 0, 0, &int_value)))\n@@ -337,1 +325,1 @@\n-            NSK_CPP_STUB5(GetLocalLong, jvmti, thread, 0, 0, &long_value)))\n+            jvmti->GetLocalLong(thread, 0, 0, &long_value)))\n@@ -342,1 +330,1 @@\n-            NSK_CPP_STUB5(GetLocalFloat, jvmti, thread, 0, 0, &float_value)))\n+            jvmti->GetLocalFloat(thread, 0, 0, &float_value)))\n@@ -347,1 +335,1 @@\n-            NSK_CPP_STUB5(GetLocalDouble, jvmti, thread, 0, 0, &double_value)))\n+            jvmti->GetLocalDouble(thread, 0, 0, &double_value)))\n@@ -352,1 +340,1 @@\n-            NSK_CPP_STUB5(SetLocalObject, jvmti, thread, 0, 0, thread)))\n+            jvmti->SetLocalObject(thread, 0, 0, thread)))\n@@ -357,1 +345,1 @@\n-            NSK_CPP_STUB5(SetLocalInt, jvmti, thread, 0, 0, (jint)0)))\n+            jvmti->SetLocalInt(thread, 0, 0, (jint)0)))\n@@ -362,1 +350,1 @@\n-            NSK_CPP_STUB5(SetLocalLong, jvmti, thread, 0, 0, (jlong)0)))\n+            jvmti->SetLocalLong(thread, 0, 0, (jlong)0)))\n@@ -367,1 +355,1 @@\n-            NSK_CPP_STUB5(SetLocalFloat, jvmti, thread, 0, 0, (jfloat)0.0)))\n+            jvmti->SetLocalFloat(thread, 0, 0, (jfloat)0.0)))\n@@ -372,1 +360,1 @@\n-            NSK_CPP_STUB5(SetLocalDouble, jvmti, thread, 0, 0, (jdouble)0.0)))\n+            jvmti->SetLocalDouble(thread, 0, 0, (jdouble)0.0)))\n@@ -387,1 +375,1 @@\n-            NSK_CPP_STUB3(GetSourceFileName, jvmti, klass, &name)))\n+            jvmti->GetSourceFileName(klass, &name)))\n@@ -392,1 +380,1 @@\n-            NSK_CPP_STUB3(GetSourceDebugExtension, jvmti, klass, &name)))\n+            jvmti->GetSourceDebugExtension(klass, &name)))\n@@ -397,2 +385,1 @@\n-            NSK_CPP_STUB4(GetLineNumberTable, jvmti, method, &count,\n-                &line_number_table)))\n+            jvmti->GetLineNumberTable(method, &count, &line_number_table)))\n@@ -414,1 +401,1 @@\n-            NSK_CPP_STUB3(RedefineClasses, jvmti, 1, &class_def)))\n+            jvmti->RedefineClasses(1, &class_def)))\n@@ -426,2 +413,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-            NSK_CPP_STUB3(GetObjectMonitorUsage, jvmti, thread, &monitor_info)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->GetObjectMonitorUsage(thread, &monitor_info)))\n@@ -440,1 +426,1 @@\n-            NSK_CPP_STUB4(IsFieldSynthetic, jvmti, klass, field, &is_synthetic)))\n+            jvmti->IsFieldSynthetic(klass, field, &is_synthetic)))\n@@ -445,1 +431,1 @@\n-            NSK_CPP_STUB3(IsMethodSynthetic, jvmti, method, &is_synthetic)))\n+            jvmti->IsMethodSynthetic(method, &is_synthetic)))\n@@ -459,1 +445,1 @@\n-            NSK_CPP_STUB4(GetBytecodes, jvmti, method, &count, &bytecodes)))\n+            jvmti->GetBytecodes(method, &count, &bytecodes)))\n@@ -473,1 +459,1 @@\n-            NSK_CPP_STUB2(GetCurrentThreadCpuTimerInfo, jvmti, &info)))\n+            jvmti->GetCurrentThreadCpuTimerInfo(&info)))\n@@ -478,1 +464,1 @@\n-            NSK_CPP_STUB2(GetCurrentThreadCpuTime, jvmti, &nanos)))\n+            jvmti->GetCurrentThreadCpuTime(&nanos)))\n@@ -492,1 +478,1 @@\n-            NSK_CPP_STUB2(GetThreadCpuTimerInfo, jvmti, &info)))\n+            jvmti->GetThreadCpuTimerInfo(&info)))\n@@ -497,1 +483,1 @@\n-            NSK_CPP_STUB3(GetThreadCpuTime, jvmti, thread, &nanos)))\n+            jvmti->GetThreadCpuTime(thread, &nanos)))\n@@ -593,1 +579,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(GetPotentialCapabilities, jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->GetPotentialCapabilities(&caps)))\n@@ -605,1 +591,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(AddCapabilities, jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->AddCapabilities(&caps)))\n@@ -611,1 +597,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(GetCapabilities, jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->GetCapabilities(&caps)))\n@@ -623,1 +609,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(RelinquishCapabilities, jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->RelinquishCapabilities(&caps)))\n@@ -629,1 +615,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(GetCapabilities, jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->GetCapabilities(&caps)))\n@@ -641,1 +627,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(AddCapabilities, jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->AddCapabilities(&caps)))\n@@ -644,1 +630,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(GetCapabilities, jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->GetCapabilities(&caps)))\n","filename":"test\/hotspot\/jtreg\/vmTestbase\/nsk\/jvmti\/scenarios\/capability\/CM01\/cm01t006\/cm01t006.cpp","additions":63,"deletions":77,"binary":false,"changes":140,"status":"modified"},{"patch":"@@ -75,2 +75,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-           NSK_CPP_STUB3(GetAllThreads, jvmti, &threads_count, &threads)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->GetAllThreads(&threads_count, &threads)))\n@@ -88,2 +87,1 @@\n-        if (!NSK_JVMTI_VERIFY(\n-                NSK_CPP_STUB3(GetThreadInfo, jvmti, threads[i], &info)))\n+        if (!NSK_JVMTI_VERIFY(jvmti->GetThreadInfo(threads[i], &info)))\n@@ -101,2 +99,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-            NSK_CPP_STUB2(Deallocate, jvmti, (unsigned char*)threads)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->Deallocate((unsigned char*)threads)))\n@@ -106,2 +103,1 @@\n-    if (!NSK_JNI_VERIFY(jni, (klass =\n-            NSK_CPP_STUB2(GetObjectClass, jni, thread)) != NULL))\n+    if (!NSK_JNI_VERIFY(jni, (klass = jni->GetObjectClass(thread)) != NULL))\n@@ -111,2 +107,1 @@\n-    if (!NSK_JNI_VERIFY(jni, (method =\n-            NSK_CPP_STUB4(GetMethodID, jni, klass, \"run\", \"()V\")) != NULL))\n+    if (!NSK_JNI_VERIFY(jni, (method = jni->GetMethodID(klass, \"run\", \"()V\")) != NULL))\n@@ -116,2 +111,1 @@\n-    if (!NSK_JNI_VERIFY(jni, (field =\n-            NSK_CPP_STUB4(GetFieldID, jni, klass, \"waitingFlag\", \"Z\")) != NULL))\n+    if (!NSK_JNI_VERIFY(jni, (field = jni->GetFieldID(klass, \"waitingFlag\", \"Z\")) != NULL))\n@@ -131,2 +125,1 @@\n-    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY,\n-            NSK_CPP_STUB2(SuspendThread, jvmti, thread)))\n+    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY, jvmti->SuspendThread(thread)))\n@@ -136,2 +129,1 @@\n-    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY,\n-            NSK_CPP_STUB2(ResumeThread, jvmti, thread)))\n+    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY, jvmti->ResumeThread(thread)))\n@@ -142,1 +134,1 @@\n-            NSK_CPP_STUB4(SuspendThreadList, jvmti, 1, &thread, &err)))\n+            jvmti->SuspendThreadList(1, &thread, &err)))\n@@ -147,1 +139,1 @@\n-            NSK_CPP_STUB4(ResumeThreadList, jvmti, 1, &thread, &err)))\n+            jvmti->ResumeThreadList(1, &thread, &err)))\n@@ -163,2 +155,1 @@\n-    if (!NSK_JNI_VERIFY(jni, (cls =\n-            NSK_CPP_STUB2(FindClass, jni, THREAD_DEATH_CLASS_NAME)) != NULL))\n+    if (!NSK_JNI_VERIFY(jni, (cls = jni->FindClass(THREAD_DEATH_CLASS_NAME)) != NULL))\n@@ -168,2 +159,1 @@\n-            NSK_CPP_STUB4(GetMethodID, jni, cls,\n-                THREAD_DEATH_CTOR_NAME, THREAD_DEATH_CTOR_SIGNATURE)) != NULL))\n+            jni->GetMethodID(cls, THREAD_DEATH_CTOR_NAME, THREAD_DEATH_CTOR_SIGNATURE)) != NULL))\n@@ -172,2 +162,1 @@\n-    if (!NSK_JNI_VERIFY(jni, (exception =\n-            NSK_CPP_STUB3(NewObject, jni, cls, ctor)) != NULL))\n+    if (!NSK_JNI_VERIFY(jni, (exception = jni->NewObject(cls, ctor)) != NULL))\n@@ -178,1 +167,1 @@\n-            NSK_CPP_STUB3(StopThread, jvmti, thread, exception)))\n+            jvmti->StopThread(thread, exception)))\n@@ -182,2 +171,1 @@\n-    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY,\n-            NSK_CPP_STUB2(InterruptThread, jvmti, thread)))\n+    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY, jvmti->InterruptThread(thread)))\n@@ -197,1 +185,1 @@\n-            NSK_CPP_STUB4(GetOwnedMonitorInfo, jvmti, thread, &count, &monitors)))\n+            jvmti->GetOwnedMonitorInfo(thread, &count, &monitors)))\n@@ -210,1 +198,1 @@\n-            NSK_CPP_STUB3(GetCurrentContendedMonitor, jvmti, thread, &monitor)))\n+            jvmti->GetCurrentContendedMonitor(thread, &monitor)))\n@@ -226,1 +214,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(AddCapabilities, jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->AddCapabilities(&caps)))\n@@ -228,1 +216,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(SuspendThread, jvmti, thread)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->SuspendThread(thread)))\n@@ -234,1 +222,1 @@\n-    err = NSK_CPP_STUB2(PopFrame, jvmti, thread);\n+    err = jvmti->PopFrame(thread);\n@@ -240,1 +228,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(ResumeThread, jvmti, thread)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->ResumeThread(thread)))\n@@ -242,1 +230,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(RelinquishCapabilities, jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->RelinquishCapabilities(&caps)))\n@@ -286,1 +274,1 @@\n-            NSK_CPP_STUB3(SetTag, jvmti, thread, TAG_VALUE)))\n+            jvmti->SetTag(thread, TAG_VALUE)))\n@@ -290,2 +278,1 @@\n-    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY,\n-            NSK_CPP_STUB3(GetTag, jvmti, thread, &tag)))\n+    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY, jvmti->GetTag(thread, &tag)))\n@@ -297,2 +284,1 @@\n-            NSK_CPP_STUB6(GetObjectsWithTags, jvmti, 1, &tag,\n-                &count, &res_objects, &res_tags)))\n+            jvmti->GetObjectsWithTags(1, &tag, &count, &res_objects, &res_tags)))\n@@ -303,2 +289,3 @@\n-            NSK_CPP_STUB4(IterateOverHeap, jvmti, JVMTI_HEAP_OBJECT_TAGGED,\n-                HeapObject, &dummy_user_data)))\n+            jvmti->IterateOverHeap(JVMTI_HEAP_OBJECT_TAGGED,\n+                                   HeapObject,\n+                                   &dummy_user_data)))\n@@ -309,2 +296,4 @@\n-            NSK_CPP_STUB5(IterateOverInstancesOfClass, jvmti, klass,\n-                JVMTI_HEAP_OBJECT_UNTAGGED, HeapObject, &dummy_user_data)))\n+            jvmti->IterateOverInstancesOfClass(klass,\n+                                               JVMTI_HEAP_OBJECT_UNTAGGED,\n+                                               HeapObject,\n+                                               &dummy_user_data)))\n@@ -315,2 +304,3 @@\n-            NSK_CPP_STUB4(IterateOverObjectsReachableFromObject, jvmti, thread,\n-                ObjectReference, &dummy_user_data)))\n+            jvmti->IterateOverObjectsReachableFromObject(thread,\n+                                                         ObjectReference,\n+                                                         &dummy_user_data)))\n@@ -321,2 +311,4 @@\n-            NSK_CPP_STUB5(IterateOverReachableObjects, jvmti,\n-                HeapRoot, StackReference, ObjectReference, &dummy_user_data)))\n+            jvmti->IterateOverReachableObjects(HeapRoot,\n+                                               StackReference,\n+                                               ObjectReference,\n+                                               &dummy_user_data)))\n@@ -341,2 +333,1 @@\n-            NSK_CPP_STUB4(GetLocalVariableTable, jvmti, method, &count,\n-                &local_variable_table)))\n+            jvmti->GetLocalVariableTable(method, &count, &local_variable_table)))\n@@ -347,1 +338,1 @@\n-            NSK_CPP_STUB5(GetLocalObject, jvmti, thread, 0, 0, &object_value)))\n+            jvmti->GetLocalObject(thread, 0, 0, &object_value)))\n@@ -352,1 +343,1 @@\n-            NSK_CPP_STUB5(GetLocalInt, jvmti, thread, 0, 0, &int_value)))\n+            jvmti->GetLocalInt(thread, 0, 0, &int_value)))\n@@ -357,1 +348,1 @@\n-            NSK_CPP_STUB5(GetLocalLong, jvmti, thread, 0, 0, &long_value)))\n+            jvmti->GetLocalLong(thread, 0, 0, &long_value)))\n@@ -362,1 +353,1 @@\n-            NSK_CPP_STUB5(GetLocalFloat, jvmti, thread, 0, 0, &float_value)))\n+            jvmti->GetLocalFloat(thread, 0, 0, &float_value)))\n@@ -367,1 +358,1 @@\n-            NSK_CPP_STUB5(GetLocalDouble, jvmti, thread, 0, 0, &double_value)))\n+            jvmti->GetLocalDouble(thread, 0, 0, &double_value)))\n@@ -372,1 +363,1 @@\n-            NSK_CPP_STUB5(SetLocalObject, jvmti, thread, 0, 0, thread)))\n+            jvmti->SetLocalObject(thread, 0, 0, thread)))\n@@ -377,1 +368,1 @@\n-            NSK_CPP_STUB5(SetLocalInt, jvmti, thread, 0, 0, (jint)0)))\n+            jvmti->SetLocalInt(thread, 0, 0, (jint)0)))\n@@ -382,1 +373,1 @@\n-            NSK_CPP_STUB5(SetLocalLong, jvmti, thread, 0, 0, (jlong)0)))\n+            jvmti->SetLocalLong(thread, 0, 0, (jlong)0)))\n@@ -387,1 +378,1 @@\n-            NSK_CPP_STUB5(SetLocalFloat, jvmti, thread, 0, 0, (jfloat)0.0)))\n+            jvmti->SetLocalFloat(thread, 0, 0, (jfloat)0.0)))\n@@ -392,1 +383,1 @@\n-            NSK_CPP_STUB5(SetLocalDouble, jvmti, thread, 0, 0, (jdouble)0.0)))\n+            jvmti->SetLocalDouble(thread, 0, 0, (jdouble)0.0)))\n@@ -407,1 +398,1 @@\n-            NSK_CPP_STUB3(GetSourceFileName, jvmti, klass, &name)))\n+            jvmti->GetSourceFileName(klass, &name)))\n@@ -412,1 +403,1 @@\n-            NSK_CPP_STUB3(GetSourceDebugExtension, jvmti, klass, &name)))\n+            jvmti->GetSourceDebugExtension(klass, &name)))\n@@ -417,2 +408,1 @@\n-            NSK_CPP_STUB4(GetLineNumberTable, jvmti, method, &count,\n-                &line_number_table)))\n+            jvmti->GetLineNumberTable(method, &count, &line_number_table)))\n@@ -434,1 +424,1 @@\n-            NSK_CPP_STUB3(RedefineClasses, jvmti, 1, &class_def)))\n+            jvmti->RedefineClasses(1, &class_def)))\n@@ -447,1 +437,1 @@\n-            NSK_CPP_STUB3(GetObjectMonitorUsage, jvmti, thread, &monitor_info)))\n+            jvmti->GetObjectMonitorUsage(thread, &monitor_info)))\n@@ -460,1 +450,1 @@\n-            NSK_CPP_STUB4(IsFieldSynthetic, jvmti, klass, field, &is_synthetic)))\n+            jvmti->IsFieldSynthetic(klass, field, &is_synthetic)))\n@@ -465,1 +455,1 @@\n-            NSK_CPP_STUB3(IsMethodSynthetic, jvmti, method, &is_synthetic)))\n+            jvmti->IsMethodSynthetic(method, &is_synthetic)))\n@@ -479,1 +469,1 @@\n-            NSK_CPP_STUB4(GetBytecodes, jvmti, method, &count, &bytecodes)))\n+            jvmti->GetBytecodes(method, &count, &bytecodes)))\n@@ -493,1 +483,1 @@\n-            NSK_CPP_STUB2(GetCurrentThreadCpuTimerInfo, jvmti, &info)))\n+            jvmti->GetCurrentThreadCpuTimerInfo(&info)))\n@@ -498,1 +488,1 @@\n-            NSK_CPP_STUB2(GetCurrentThreadCpuTime, jvmti, &nanos)))\n+            jvmti->GetCurrentThreadCpuTime(&nanos)))\n@@ -512,1 +502,1 @@\n-            NSK_CPP_STUB2(GetThreadCpuTimerInfo, jvmti, &info)))\n+            jvmti->GetThreadCpuTimerInfo(&info)))\n@@ -517,1 +507,1 @@\n-            NSK_CPP_STUB3(GetThreadCpuTime, jvmti, thread, &nanos)))\n+            jvmti->GetThreadCpuTime(thread, &nanos)))\n@@ -613,1 +603,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(GetPotentialCapabilities, jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->GetPotentialCapabilities(&caps)))\n@@ -625,1 +615,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(AddCapabilities, jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->AddCapabilities(&caps)))\n@@ -631,1 +621,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(GetCapabilities, jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->GetCapabilities(&caps)))\n@@ -643,1 +633,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(RelinquishCapabilities, jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->RelinquishCapabilities(&caps)))\n@@ -649,1 +639,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(GetCapabilities, jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->GetCapabilities(&caps)))\n@@ -661,1 +651,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(AddCapabilities, jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->AddCapabilities(&caps)))\n@@ -664,1 +654,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(GetCapabilities, jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->GetCapabilities(&caps)))\n","filename":"test\/hotspot\/jtreg\/vmTestbase\/nsk\/jvmti\/scenarios\/capability\/CM01\/cm01t007\/cm01t007.cpp","additions":69,"deletions":79,"binary":false,"changes":148,"status":"modified"},{"patch":"@@ -79,2 +79,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-           NSK_CPP_STUB3(GetAllThreads, jvmti, &threads_count, &threads)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->GetAllThreads(&threads_count, &threads)))\n@@ -92,2 +91,1 @@\n-        if (!NSK_JVMTI_VERIFY(\n-                NSK_CPP_STUB3(GetThreadInfo, jvmti, threads[i], &info)))\n+        if (!NSK_JVMTI_VERIFY(jvmti->GetThreadInfo(threads[i], &info)))\n@@ -105,2 +103,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-            NSK_CPP_STUB2(Deallocate, jvmti, (unsigned char*)threads)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->Deallocate((unsigned char*)threads)))\n@@ -110,2 +107,1 @@\n-    if (!NSK_JNI_VERIFY(jni, (klass =\n-            NSK_CPP_STUB2(GetObjectClass, jni, thread)) != NULL))\n+    if (!NSK_JNI_VERIFY(jni, (klass = jni->GetObjectClass(thread)) != NULL))\n@@ -115,2 +111,1 @@\n-    if (!NSK_JNI_VERIFY(jni, (method =\n-            NSK_CPP_STUB4(GetMethodID, jni, klass, \"run\", \"()V\")) != NULL))\n+    if (!NSK_JNI_VERIFY(jni, (method = jni->GetMethodID(klass, \"run\", \"()V\")) != NULL))\n@@ -121,2 +116,1 @@\n-            NSK_CPP_STUB4(GetFieldID, jni, klass,\n-                \"waitingMonitor\", \"Ljava\/lang\/Object;\")) != NULL))\n+            jni->GetFieldID(klass, \"waitingMonitor\", \"Ljava\/lang\/Object;\")) != NULL))\n@@ -136,2 +130,1 @@\n-    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY,\n-            NSK_CPP_STUB2(SuspendThread, jvmti, thread)))\n+    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY, jvmti->SuspendThread(thread)))\n@@ -141,2 +134,1 @@\n-    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY,\n-            NSK_CPP_STUB2(ResumeThread, jvmti, thread)))\n+    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY, jvmti->ResumeThread(thread)))\n@@ -147,1 +139,1 @@\n-            NSK_CPP_STUB4(SuspendThreadList, jvmti, 1, &thread, &err)))\n+            jvmti->SuspendThreadList(1, &thread, &err)))\n@@ -152,1 +144,1 @@\n-            NSK_CPP_STUB4(ResumeThreadList, jvmti, 1, &thread, &err)))\n+            jvmti->ResumeThreadList(1, &thread, &err)))\n@@ -168,2 +160,1 @@\n-    if (!NSK_JNI_VERIFY(jni, (cls =\n-            NSK_CPP_STUB2(FindClass, jni, THREAD_DEATH_CLASS_NAME)) != NULL))\n+    if (!NSK_JNI_VERIFY(jni, (cls = jni->FindClass(THREAD_DEATH_CLASS_NAME)) != NULL))\n@@ -173,2 +164,1 @@\n-            NSK_CPP_STUB4(GetMethodID, jni, cls,\n-                THREAD_DEATH_CTOR_NAME, THREAD_DEATH_CTOR_SIGNATURE)) != NULL))\n+            jni->GetMethodID(cls, THREAD_DEATH_CTOR_NAME, THREAD_DEATH_CTOR_SIGNATURE)) != NULL))\n@@ -177,2 +167,1 @@\n-    if (!NSK_JNI_VERIFY(jni, (exception =\n-            NSK_CPP_STUB3(NewObject, jni, cls, ctor)) != NULL))\n+    if (!NSK_JNI_VERIFY(jni, (exception = jni->NewObject(cls, ctor)) != NULL))\n@@ -183,1 +172,1 @@\n-            NSK_CPP_STUB3(StopThread, jvmti, thread, exception)))\n+            jvmti->StopThread(thread, exception)))\n@@ -187,2 +176,1 @@\n-    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY,\n-            NSK_CPP_STUB2(InterruptThread, jvmti, thread)))\n+    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY, jvmti->InterruptThread(thread)))\n@@ -202,1 +190,1 @@\n-            NSK_CPP_STUB4(GetOwnedMonitorInfo, jvmti, thread, &count, &monitors)))\n+            jvmti->GetOwnedMonitorInfo(thread, &count, &monitors)))\n@@ -215,1 +203,1 @@\n-            NSK_CPP_STUB3(GetCurrentContendedMonitor, jvmti, thread, &monitor)))\n+            jvmti->GetCurrentContendedMonitor(thread, &monitor)))\n@@ -225,2 +213,1 @@\n-    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY,\n-            NSK_CPP_STUB2(PopFrame, jvmti, thread)))\n+    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY, jvmti->PopFrame(thread)))\n@@ -270,1 +257,1 @@\n-            NSK_CPP_STUB3(SetTag, jvmti, thread, TAG_VALUE)))\n+            jvmti->SetTag(thread, TAG_VALUE)))\n@@ -274,2 +261,1 @@\n-    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY,\n-            NSK_CPP_STUB3(GetTag, jvmti, thread, &tag)))\n+    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY, jvmti->GetTag(thread, &tag)))\n@@ -281,2 +267,1 @@\n-            NSK_CPP_STUB6(GetObjectsWithTags, jvmti, 1, &tag,\n-                &count, &res_objects, &res_tags)))\n+            jvmti->GetObjectsWithTags(1, &tag, &count, &res_objects, &res_tags)))\n@@ -287,2 +272,1 @@\n-            NSK_CPP_STUB4(IterateOverHeap, jvmti, JVMTI_HEAP_OBJECT_TAGGED,\n-                HeapObject, &dummy_user_data)))\n+            jvmti->IterateOverHeap(JVMTI_HEAP_OBJECT_TAGGED, HeapObject, &dummy_user_data)))\n@@ -293,2 +277,4 @@\n-            NSK_CPP_STUB5(IterateOverInstancesOfClass, jvmti, klass,\n-                JVMTI_HEAP_OBJECT_UNTAGGED, HeapObject, &dummy_user_data)))\n+            jvmti->IterateOverInstancesOfClass(klass,\n+                                               JVMTI_HEAP_OBJECT_UNTAGGED,\n+                                               HeapObject,\n+                                               &dummy_user_data)))\n@@ -299,2 +285,3 @@\n-            NSK_CPP_STUB4(IterateOverObjectsReachableFromObject, jvmti, thread,\n-                ObjectReference, &dummy_user_data)))\n+            jvmti->IterateOverObjectsReachableFromObject(thread,\n+                                                         ObjectReference,\n+                                                         &dummy_user_data)))\n@@ -305,2 +292,4 @@\n-            NSK_CPP_STUB5(IterateOverReachableObjects, jvmti,\n-                HeapRoot, StackReference, ObjectReference, &dummy_user_data)))\n+            jvmti->IterateOverReachableObjects(HeapRoot,\n+                                               StackReference,\n+                                               ObjectReference,\n+                                               &dummy_user_data)))\n@@ -325,2 +314,1 @@\n-            NSK_CPP_STUB4(GetLocalVariableTable, jvmti, method, &count,\n-                &local_variable_table)))\n+            jvmti->GetLocalVariableTable(method, &count, &local_variable_table)))\n@@ -331,1 +319,1 @@\n-            NSK_CPP_STUB5(GetLocalObject, jvmti, thread, 0, 0, &object_value)))\n+            jvmti->GetLocalObject(thread, 0, 0, &object_value)))\n@@ -336,1 +324,1 @@\n-            NSK_CPP_STUB5(GetLocalInt, jvmti, thread, 0, 0, &int_value)))\n+            jvmti->GetLocalInt(thread, 0, 0, &int_value)))\n@@ -341,1 +329,1 @@\n-            NSK_CPP_STUB5(GetLocalLong, jvmti, thread, 0, 0, &long_value)))\n+            jvmti->GetLocalLong(thread, 0, 0, &long_value)))\n@@ -346,1 +334,1 @@\n-            NSK_CPP_STUB5(GetLocalFloat, jvmti, thread, 0, 0, &float_value)))\n+            jvmti->GetLocalFloat(thread, 0, 0, &float_value)))\n@@ -351,1 +339,1 @@\n-            NSK_CPP_STUB5(GetLocalDouble, jvmti, thread, 0, 0, &double_value)))\n+            jvmti->GetLocalDouble(thread, 0, 0, &double_value)))\n@@ -356,1 +344,1 @@\n-            NSK_CPP_STUB5(SetLocalObject, jvmti, thread, 0, 0, thread)))\n+            jvmti->SetLocalObject(thread, 0, 0, thread)))\n@@ -361,1 +349,1 @@\n-            NSK_CPP_STUB5(SetLocalInt, jvmti, thread, 0, 0, (jint)0)))\n+            jvmti->SetLocalInt(thread, 0, 0, (jint)0)))\n@@ -366,1 +354,1 @@\n-            NSK_CPP_STUB5(SetLocalLong, jvmti, thread, 0, 0, (jlong)0)))\n+            jvmti->SetLocalLong(thread, 0, 0, (jlong)0)))\n@@ -371,1 +359,1 @@\n-            NSK_CPP_STUB5(SetLocalFloat, jvmti, thread, 0, 0, (jfloat)0.0)))\n+            jvmti->SetLocalFloat(thread, 0, 0, (jfloat)0.0)))\n@@ -376,1 +364,1 @@\n-            NSK_CPP_STUB5(SetLocalDouble, jvmti, thread, 0, 0, (jdouble)0.0)))\n+            jvmti->SetLocalDouble(thread, 0, 0, (jdouble)0.0)))\n@@ -391,1 +379,1 @@\n-            NSK_CPP_STUB3(GetSourceFileName, jvmti, klass, &name)))\n+            jvmti->GetSourceFileName(klass, &name)))\n@@ -396,1 +384,1 @@\n-            NSK_CPP_STUB3(GetSourceDebugExtension, jvmti, klass, &name)))\n+            jvmti->GetSourceDebugExtension(klass, &name)))\n@@ -401,2 +389,1 @@\n-            NSK_CPP_STUB4(GetLineNumberTable, jvmti, method, &count,\n-                &line_number_table)))\n+            jvmti->GetLineNumberTable(method, &count, &line_number_table)))\n@@ -418,1 +405,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB3(RedefineClasses, jvmti, 1, &class_def)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->RedefineClasses(1, &class_def)))\n@@ -422,2 +409,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-            NSK_CPP_STUB3(IsMethodObsolete, jvmti, method, &is_obsolete)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->IsMethodObsolete(method, &is_obsolete)))\n@@ -436,1 +422,1 @@\n-            NSK_CPP_STUB3(GetObjectMonitorUsage, jvmti, thread, &monitor_info)))\n+            jvmti->GetObjectMonitorUsage(thread, &monitor_info)))\n@@ -449,1 +435,1 @@\n-            NSK_CPP_STUB4(IsFieldSynthetic, jvmti, klass, field, &is_synthetic)))\n+            jvmti->IsFieldSynthetic(klass, field, &is_synthetic)))\n@@ -454,1 +440,1 @@\n-            NSK_CPP_STUB3(IsMethodSynthetic, jvmti, method, &is_synthetic)))\n+            jvmti->IsMethodSynthetic(method, &is_synthetic)))\n@@ -468,1 +454,1 @@\n-            NSK_CPP_STUB4(GetBytecodes, jvmti, method, &count, &bytecodes)))\n+            jvmti->GetBytecodes(method, &count, &bytecodes)))\n@@ -482,1 +468,1 @@\n-            NSK_CPP_STUB2(GetCurrentThreadCpuTimerInfo, jvmti, &info)))\n+            jvmti->GetCurrentThreadCpuTimerInfo(&info)))\n@@ -487,1 +473,1 @@\n-            NSK_CPP_STUB2(GetCurrentThreadCpuTime, jvmti, &nanos)))\n+            jvmti->GetCurrentThreadCpuTime(&nanos)))\n@@ -501,1 +487,1 @@\n-            NSK_CPP_STUB2(GetThreadCpuTimerInfo, jvmti, &info)))\n+            jvmti->GetThreadCpuTimerInfo(&info)))\n@@ -506,1 +492,1 @@\n-            NSK_CPP_STUB3(GetThreadCpuTime, jvmti, thread, &nanos)))\n+            jvmti->GetThreadCpuTime(thread, &nanos)))\n@@ -524,2 +510,1 @@\n-        if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB3(Allocate,\n-            jvmti, class_data_len, &klass_bytes)))\n+        if (!NSK_JVMTI_VERIFY(jvmti->Allocate(class_data_len, &klass_bytes)))\n@@ -531,2 +516,2 @@\n-        NSK_JVMTI_VERIFY(NSK_CPP_STUB4(SetEventNotificationMode,\n-            jvmti, JVMTI_DISABLE, JVMTI_EVENT_CLASS_FILE_LOAD_HOOK, NULL));\n+        NSK_JVMTI_VERIFY(\n+            jvmti->SetEventNotificationMode(JVMTI_DISABLE, JVMTI_EVENT_CLASS_FILE_LOAD_HOOK, NULL));\n@@ -627,1 +612,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(GetPotentialCapabilities, jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->GetPotentialCapabilities(&caps)))\n@@ -639,1 +624,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(AddCapabilities, jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->AddCapabilities(&caps)))\n@@ -645,1 +630,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(GetCapabilities, jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->GetCapabilities(&caps)))\n@@ -657,1 +642,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(RelinquishCapabilities, jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->RelinquishCapabilities(&caps)))\n@@ -663,1 +648,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(GetCapabilities, jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->GetCapabilities(&caps)))\n@@ -675,1 +660,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(AddCapabilities, jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->AddCapabilities(&caps)))\n@@ -678,1 +663,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(GetCapabilities, jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->GetCapabilities(&caps)))\n@@ -689,2 +674,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB3(SetEventCallbacks,\n-            jvmti, &callbacks, sizeof(callbacks))))\n+    if (!NSK_JVMTI_VERIFY(jvmti->SetEventCallbacks(&callbacks, sizeof(callbacks))))\n@@ -692,2 +676,2 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB4(SetEventNotificationMode,\n-            jvmti, JVMTI_ENABLE, JVMTI_EVENT_CLASS_FILE_LOAD_HOOK, NULL)))\n+    if (!NSK_JVMTI_VERIFY(\n+        jvmti->SetEventNotificationMode(JVMTI_ENABLE, JVMTI_EVENT_CLASS_FILE_LOAD_HOOK, NULL)))\n","filename":"test\/hotspot\/jtreg\/vmTestbase\/nsk\/jvmti\/scenarios\/capability\/CM01\/cm01t008\/cm01t008.cpp","additions":70,"deletions":86,"binary":false,"changes":156,"status":"modified"},{"patch":"@@ -77,2 +77,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-           NSK_CPP_STUB3(GetAllThreads, jvmti, &threads_count, &threads)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->GetAllThreads(&threads_count, &threads)))\n@@ -90,2 +89,1 @@\n-        if (!NSK_JVMTI_VERIFY(\n-                NSK_CPP_STUB3(GetThreadInfo, jvmti, threads[i], &info)))\n+        if (!NSK_JVMTI_VERIFY(jvmti->GetThreadInfo(threads[i], &info)))\n@@ -103,2 +101,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-            NSK_CPP_STUB2(Deallocate, jvmti, (unsigned char*)threads)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->Deallocate((unsigned char*)threads)))\n@@ -108,2 +105,1 @@\n-    if (!NSK_JNI_VERIFY(jni, (klass =\n-            NSK_CPP_STUB2(GetObjectClass, jni, thread)) != NULL))\n+    if (!NSK_JNI_VERIFY(jni, (klass = jni->GetObjectClass(thread)) != NULL))\n@@ -113,2 +109,1 @@\n-    if (!NSK_JNI_VERIFY(jni, (method =\n-            NSK_CPP_STUB4(GetMethodID, jni, klass, \"run\", \"()V\")) != NULL))\n+    if (!NSK_JNI_VERIFY(jni, (method = jni->GetMethodID(klass, \"run\", \"()V\")) != NULL))\n@@ -119,2 +114,1 @@\n-            NSK_CPP_STUB4(GetFieldID, jni, klass,\n-                \"waitingMonitor\", \"Ljava\/lang\/Object;\")) != NULL))\n+            jni->GetFieldID(klass, \"waitingMonitor\", \"Ljava\/lang\/Object;\")) != NULL))\n@@ -134,2 +128,1 @@\n-    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY,\n-            NSK_CPP_STUB2(SuspendThread, jvmti, thread)))\n+    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY, jvmti->SuspendThread(thread)))\n@@ -139,2 +132,1 @@\n-    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY,\n-            NSK_CPP_STUB2(ResumeThread, jvmti, thread)))\n+    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY, jvmti->ResumeThread(thread)))\n@@ -145,1 +137,1 @@\n-            NSK_CPP_STUB4(SuspendThreadList, jvmti, 1, &thread, &err)))\n+            jvmti->SuspendThreadList(1, &thread, &err)))\n@@ -150,1 +142,1 @@\n-            NSK_CPP_STUB4(ResumeThreadList, jvmti, 1, &thread, &err)))\n+            jvmti->ResumeThreadList(1, &thread, &err)))\n@@ -166,2 +158,1 @@\n-    if (!NSK_JNI_VERIFY(jni, (cls =\n-            NSK_CPP_STUB2(FindClass, jni, THREAD_DEATH_CLASS_NAME)) != NULL))\n+    if (!NSK_JNI_VERIFY(jni, (cls = jni->FindClass(THREAD_DEATH_CLASS_NAME)) != NULL))\n@@ -171,2 +162,1 @@\n-            NSK_CPP_STUB4(GetMethodID, jni, cls,\n-                THREAD_DEATH_CTOR_NAME, THREAD_DEATH_CTOR_SIGNATURE)) != NULL))\n+            jni->GetMethodID(cls, THREAD_DEATH_CTOR_NAME, THREAD_DEATH_CTOR_SIGNATURE)) != NULL))\n@@ -175,2 +165,1 @@\n-    if (!NSK_JNI_VERIFY(jni, (exception =\n-            NSK_CPP_STUB3(NewObject, jni, cls, ctor)) != NULL))\n+    if (!NSK_JNI_VERIFY(jni, (exception = jni->NewObject(cls, ctor)) != NULL))\n@@ -180,1 +169,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(InterruptThread, jvmti, thread)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->InterruptThread(thread)))\n@@ -184,1 +173,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB3(StopThread, jvmti, thread, exception)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->StopThread(thread, exception)))\n@@ -198,1 +187,1 @@\n-            NSK_CPP_STUB4(GetOwnedMonitorInfo, jvmti, thread, &count, &monitors)))\n+            jvmti->GetOwnedMonitorInfo(thread, &count, &monitors)))\n@@ -211,1 +200,1 @@\n-            NSK_CPP_STUB3(GetCurrentContendedMonitor, jvmti, thread, &monitor)))\n+            jvmti->GetCurrentContendedMonitor(thread, &monitor)))\n@@ -221,2 +210,1 @@\n-    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY,\n-            NSK_CPP_STUB2(PopFrame, jvmti, thread)))\n+    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY, jvmti->PopFrame(thread)))\n@@ -266,1 +254,1 @@\n-            NSK_CPP_STUB3(SetTag, jvmti, thread, TAG_VALUE)))\n+            jvmti->SetTag(thread, TAG_VALUE)))\n@@ -270,2 +258,1 @@\n-    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY,\n-            NSK_CPP_STUB3(GetTag, jvmti, thread, &tag)))\n+    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY, jvmti->GetTag(thread, &tag)))\n@@ -277,2 +264,1 @@\n-            NSK_CPP_STUB6(GetObjectsWithTags, jvmti, 1, &tag,\n-                &count, &res_objects, &res_tags)))\n+            jvmti->GetObjectsWithTags(1, &tag, &count, &res_objects, &res_tags)))\n@@ -283,2 +269,1 @@\n-            NSK_CPP_STUB4(IterateOverHeap, jvmti, JVMTI_HEAP_OBJECT_TAGGED,\n-                HeapObject, &dummy_user_data)))\n+            jvmti->IterateOverHeap(JVMTI_HEAP_OBJECT_TAGGED, HeapObject, &dummy_user_data)))\n@@ -289,2 +274,4 @@\n-            NSK_CPP_STUB5(IterateOverInstancesOfClass, jvmti, klass,\n-                JVMTI_HEAP_OBJECT_UNTAGGED, HeapObject, &dummy_user_data)))\n+            jvmti->IterateOverInstancesOfClass(klass,\n+                                               JVMTI_HEAP_OBJECT_UNTAGGED,\n+                                               HeapObject,\n+                                               &dummy_user_data)))\n@@ -295,2 +282,3 @@\n-            NSK_CPP_STUB4(IterateOverObjectsReachableFromObject, jvmti, thread,\n-                ObjectReference, &dummy_user_data)))\n+            jvmti->IterateOverObjectsReachableFromObject(thread,\n+                                                         ObjectReference,\n+                                                         &dummy_user_data)))\n@@ -301,2 +289,4 @@\n-            NSK_CPP_STUB5(IterateOverReachableObjects, jvmti,\n-                HeapRoot, StackReference, ObjectReference, &dummy_user_data)))\n+            jvmti->IterateOverReachableObjects(HeapRoot,\n+                                               StackReference,\n+                                               ObjectReference,\n+                                               &dummy_user_data)))\n@@ -321,2 +311,1 @@\n-            NSK_CPP_STUB4(GetLocalVariableTable, jvmti, method, &count,\n-                &local_variable_table)))\n+            jvmti->GetLocalVariableTable(method, &count, &local_variable_table)))\n@@ -327,1 +316,1 @@\n-            NSK_CPP_STUB5(GetLocalObject, jvmti, thread, 0, 0, &object_value)))\n+            jvmti->GetLocalObject(thread, 0, 0, &object_value)))\n@@ -332,1 +321,1 @@\n-            NSK_CPP_STUB5(GetLocalInt, jvmti, thread, 0, 0, &int_value)))\n+            jvmti->GetLocalInt(thread, 0, 0, &int_value)))\n@@ -337,1 +326,1 @@\n-            NSK_CPP_STUB5(GetLocalLong, jvmti, thread, 0, 0, &long_value)))\n+            jvmti->GetLocalLong(thread, 0, 0, &long_value)))\n@@ -342,1 +331,1 @@\n-            NSK_CPP_STUB5(GetLocalFloat, jvmti, thread, 0, 0, &float_value)))\n+            jvmti->GetLocalFloat(thread, 0, 0, &float_value)))\n@@ -347,1 +336,1 @@\n-            NSK_CPP_STUB5(GetLocalDouble, jvmti, thread, 0, 0, &double_value)))\n+            jvmti->GetLocalDouble(thread, 0, 0, &double_value)))\n@@ -352,1 +341,1 @@\n-            NSK_CPP_STUB5(SetLocalObject, jvmti, thread, 0, 0, thread)))\n+            jvmti->SetLocalObject(thread, 0, 0, thread)))\n@@ -357,1 +346,1 @@\n-            NSK_CPP_STUB5(SetLocalInt, jvmti, thread, 0, 0, (jint)0)))\n+            jvmti->SetLocalInt(thread, 0, 0, (jint)0)))\n@@ -362,1 +351,1 @@\n-            NSK_CPP_STUB5(SetLocalLong, jvmti, thread, 0, 0, (jlong)0)))\n+            jvmti->SetLocalLong(thread, 0, 0, (jlong)0)))\n@@ -367,1 +356,1 @@\n-            NSK_CPP_STUB5(SetLocalFloat, jvmti, thread, 0, 0, (jfloat)0.0)))\n+            jvmti->SetLocalFloat(thread, 0, 0, (jfloat)0.0)))\n@@ -372,1 +361,1 @@\n-            NSK_CPP_STUB5(SetLocalDouble, jvmti, thread, 0, 0, (jdouble)0.0)))\n+            jvmti->SetLocalDouble(thread, 0, 0, (jdouble)0.0)))\n@@ -387,1 +376,1 @@\n-            NSK_CPP_STUB3(GetSourceFileName, jvmti, klass, &name)))\n+            jvmti->GetSourceFileName(klass, &name)))\n@@ -392,1 +381,1 @@\n-            NSK_CPP_STUB3(GetSourceDebugExtension, jvmti, klass, &name)))\n+            jvmti->GetSourceDebugExtension(klass, &name)))\n@@ -397,2 +386,1 @@\n-            NSK_CPP_STUB4(GetLineNumberTable, jvmti, method, &count,\n-                &line_number_table)))\n+            jvmti->GetLineNumberTable(method, &count, &line_number_table)))\n@@ -414,1 +402,1 @@\n-            NSK_CPP_STUB3(RedefineClasses, jvmti, 1, &class_def)))\n+            jvmti->RedefineClasses(1, &class_def)))\n@@ -427,1 +415,1 @@\n-            NSK_CPP_STUB3(GetObjectMonitorUsage, jvmti, thread, &monitor_info)))\n+            jvmti->GetObjectMonitorUsage(thread, &monitor_info)))\n@@ -440,1 +428,1 @@\n-            NSK_CPP_STUB4(IsFieldSynthetic, jvmti, klass, field, &is_synthetic)))\n+            jvmti->IsFieldSynthetic(klass, field, &is_synthetic)))\n@@ -445,1 +433,1 @@\n-            NSK_CPP_STUB3(IsMethodSynthetic, jvmti, method, &is_synthetic)))\n+            jvmti->IsMethodSynthetic(method, &is_synthetic)))\n@@ -459,1 +447,1 @@\n-            NSK_CPP_STUB4(GetBytecodes, jvmti, method, &count, &bytecodes)))\n+            jvmti->GetBytecodes(method, &count, &bytecodes)))\n@@ -473,1 +461,1 @@\n-            NSK_CPP_STUB2(GetCurrentThreadCpuTimerInfo, jvmti, &info)))\n+            jvmti->GetCurrentThreadCpuTimerInfo(&info)))\n@@ -478,1 +466,1 @@\n-            NSK_CPP_STUB2(GetCurrentThreadCpuTime, jvmti, &nanos)))\n+            jvmti->GetCurrentThreadCpuTime(&nanos)))\n@@ -492,1 +480,1 @@\n-            NSK_CPP_STUB2(GetThreadCpuTimerInfo, jvmti, &info)))\n+            jvmti->GetThreadCpuTimerInfo(&info)))\n@@ -497,1 +485,1 @@\n-            NSK_CPP_STUB3(GetThreadCpuTime, jvmti, thread, &nanos)))\n+            jvmti->GetThreadCpuTime(thread, &nanos)))\n@@ -593,1 +581,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(GetPotentialCapabilities, jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->GetPotentialCapabilities(&caps)))\n@@ -605,1 +593,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(AddCapabilities, jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->AddCapabilities(&caps)))\n@@ -611,1 +599,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(GetCapabilities, jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->GetCapabilities(&caps)))\n@@ -623,1 +611,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(RelinquishCapabilities, jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->RelinquishCapabilities(&caps)))\n@@ -629,1 +617,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(GetCapabilities, jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->GetCapabilities(&caps)))\n@@ -641,1 +629,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(AddCapabilities, jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->AddCapabilities(&caps)))\n@@ -644,1 +632,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(GetCapabilities, jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->GetCapabilities(&caps)))\n","filename":"test\/hotspot\/jtreg\/vmTestbase\/nsk\/jvmti\/scenarios\/capability\/CM01\/cm01t009\/cm01t009.cpp","additions":63,"deletions":75,"binary":false,"changes":138,"status":"modified"},{"patch":"@@ -76,2 +76,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-           NSK_CPP_STUB3(GetAllThreads, jvmti, &threads_count, &threads)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->GetAllThreads(&threads_count, &threads)))\n@@ -89,2 +88,1 @@\n-        if (!NSK_JVMTI_VERIFY(\n-                NSK_CPP_STUB3(GetThreadInfo, jvmti, threads[i], &info)))\n+        if (!NSK_JVMTI_VERIFY(jvmti->GetThreadInfo(threads[i], &info)))\n@@ -102,2 +100,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-            NSK_CPP_STUB2(Deallocate, jvmti, (unsigned char*)threads)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->Deallocate((unsigned char*)threads)))\n@@ -107,2 +104,1 @@\n-    if (!NSK_JNI_VERIFY(jni, (klass =\n-            NSK_CPP_STUB2(GetObjectClass, jni, thread)) != NULL))\n+    if (!NSK_JNI_VERIFY(jni, (klass = jni->GetObjectClass(thread)) != NULL))\n@@ -112,2 +108,1 @@\n-    if (!NSK_JNI_VERIFY(jni, (method =\n-            NSK_CPP_STUB4(GetMethodID, jni, klass, \"run\", \"()V\")) != NULL))\n+    if (!NSK_JNI_VERIFY(jni, (method = jni->GetMethodID(klass, \"run\", \"()V\")) != NULL))\n@@ -118,2 +113,1 @@\n-            NSK_CPP_STUB4(GetFieldID, jni, klass,\n-                \"waitingMonitor\", \"Ljava\/lang\/Object;\")) != NULL))\n+            jni->GetFieldID(klass, \"waitingMonitor\", \"Ljava\/lang\/Object;\")) != NULL))\n@@ -133,2 +127,1 @@\n-    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY,\n-            NSK_CPP_STUB2(SuspendThread, jvmti, thread)))\n+    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY, jvmti->SuspendThread(thread)))\n@@ -138,2 +131,1 @@\n-    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY,\n-            NSK_CPP_STUB2(ResumeThread, jvmti, thread)))\n+    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY, jvmti->ResumeThread(thread)))\n@@ -144,1 +136,1 @@\n-            NSK_CPP_STUB4(SuspendThreadList, jvmti, 1, &thread, &err)))\n+            jvmti->SuspendThreadList(1, &thread, &err)))\n@@ -149,1 +141,1 @@\n-            NSK_CPP_STUB4(ResumeThreadList, jvmti, 1, &thread, &err)))\n+            jvmti->ResumeThreadList(1, &thread, &err)))\n@@ -165,2 +157,1 @@\n-    if (!NSK_JNI_VERIFY(jni, (cls =\n-            NSK_CPP_STUB2(FindClass, jni, THREAD_DEATH_CLASS_NAME)) != NULL))\n+    if (!NSK_JNI_VERIFY(jni, (cls = jni->FindClass(THREAD_DEATH_CLASS_NAME)) != NULL))\n@@ -170,2 +161,1 @@\n-            NSK_CPP_STUB4(GetMethodID, jni, cls,\n-                THREAD_DEATH_CTOR_NAME, THREAD_DEATH_CTOR_SIGNATURE)) != NULL))\n+            jni->GetMethodID(cls, THREAD_DEATH_CTOR_NAME, THREAD_DEATH_CTOR_SIGNATURE)) != NULL))\n@@ -174,2 +164,1 @@\n-    if (!NSK_JNI_VERIFY(jni, (exception =\n-            NSK_CPP_STUB3(NewObject, jni, cls, ctor)) != NULL))\n+    if (!NSK_JNI_VERIFY(jni, (exception = jni->NewObject(cls, ctor)) != NULL))\n@@ -180,1 +169,1 @@\n-            NSK_CPP_STUB3(StopThread, jvmti, thread, exception)))\n+            jvmti->StopThread(thread, exception)))\n@@ -184,2 +173,1 @@\n-    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY,\n-            NSK_CPP_STUB2(InterruptThread, jvmti, thread)))\n+    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY, jvmti->InterruptThread(thread)))\n@@ -199,1 +187,1 @@\n-            NSK_CPP_STUB4(GetOwnedMonitorInfo, jvmti, thread, &count, &monitors)))\n+            jvmti->GetOwnedMonitorInfo(thread, &count, &monitors)))\n@@ -212,1 +200,1 @@\n-            NSK_CPP_STUB3(GetCurrentContendedMonitor, jvmti, thread, &monitor)))\n+            jvmti->GetCurrentContendedMonitor(thread, &monitor)))\n@@ -222,2 +210,1 @@\n-    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY,\n-            NSK_CPP_STUB2(PopFrame, jvmti, thread)))\n+    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY, jvmti->PopFrame(thread)))\n@@ -267,1 +254,1 @@\n-            NSK_CPP_STUB3(SetTag, jvmti, thread, TAG_VALUE)))\n+            jvmti->SetTag(thread, TAG_VALUE)))\n@@ -271,2 +258,1 @@\n-    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY,\n-            NSK_CPP_STUB3(GetTag, jvmti, thread, &tag)))\n+    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY, jvmti->GetTag(thread, &tag)))\n@@ -278,2 +264,1 @@\n-            NSK_CPP_STUB6(GetObjectsWithTags, jvmti, 1, &tag,\n-                &count, &res_objects, &res_tags)))\n+            jvmti->GetObjectsWithTags(1, &tag, &count, &res_objects, &res_tags)))\n@@ -284,2 +269,1 @@\n-            NSK_CPP_STUB4(IterateOverHeap, jvmti, JVMTI_HEAP_OBJECT_TAGGED,\n-                HeapObject, &dummy_user_data)))\n+            jvmti->IterateOverHeap(JVMTI_HEAP_OBJECT_TAGGED, HeapObject, &dummy_user_data)))\n@@ -290,2 +274,4 @@\n-            NSK_CPP_STUB5(IterateOverInstancesOfClass, jvmti, klass,\n-                JVMTI_HEAP_OBJECT_UNTAGGED, HeapObject, &dummy_user_data)))\n+            jvmti->IterateOverInstancesOfClass(klass,\n+                                               JVMTI_HEAP_OBJECT_UNTAGGED,\n+                                               HeapObject,\n+                                               &dummy_user_data)))\n@@ -296,2 +282,3 @@\n-            NSK_CPP_STUB4(IterateOverObjectsReachableFromObject, jvmti, thread,\n-                ObjectReference, &dummy_user_data)))\n+            jvmti->IterateOverObjectsReachableFromObject(thread,\n+                                                         ObjectReference,\n+                                                         &dummy_user_data)))\n@@ -302,2 +289,4 @@\n-            NSK_CPP_STUB5(IterateOverReachableObjects, jvmti,\n-                HeapRoot, StackReference, ObjectReference, &dummy_user_data)))\n+            jvmti->IterateOverReachableObjects(HeapRoot,\n+                                               StackReference,\n+                                               ObjectReference,\n+                                               &dummy_user_data)))\n@@ -322,2 +311,1 @@\n-            NSK_CPP_STUB4(GetLocalVariableTable, jvmti, method, &count,\n-                &local_variable_table)))\n+            jvmti->GetLocalVariableTable(method, &count, &local_variable_table)))\n@@ -328,1 +316,1 @@\n-            NSK_CPP_STUB5(GetLocalObject, jvmti, thread, 0, 0, &object_value)))\n+            jvmti->GetLocalObject(thread, 0, 0, &object_value)))\n@@ -333,1 +321,1 @@\n-            NSK_CPP_STUB5(GetLocalInt, jvmti, thread, 0, 0, &int_value)))\n+            jvmti->GetLocalInt(thread, 0, 0, &int_value)))\n@@ -338,1 +326,1 @@\n-            NSK_CPP_STUB5(GetLocalLong, jvmti, thread, 0, 0, &long_value)))\n+            jvmti->GetLocalLong(thread, 0, 0, &long_value)))\n@@ -343,1 +331,1 @@\n-            NSK_CPP_STUB5(GetLocalFloat, jvmti, thread, 0, 0, &float_value)))\n+            jvmti->GetLocalFloat(thread, 0, 0, &float_value)))\n@@ -348,1 +336,1 @@\n-            NSK_CPP_STUB5(GetLocalDouble, jvmti, thread, 0, 0, &double_value)))\n+            jvmti->GetLocalDouble(thread, 0, 0, &double_value)))\n@@ -353,1 +341,1 @@\n-            NSK_CPP_STUB5(SetLocalObject, jvmti, thread, 0, 0, thread)))\n+            jvmti->SetLocalObject(thread, 0, 0, thread)))\n@@ -358,1 +346,1 @@\n-            NSK_CPP_STUB5(SetLocalInt, jvmti, thread, 0, 0, (jint)0)))\n+            jvmti->SetLocalInt(thread, 0, 0, (jint)0)))\n@@ -363,1 +351,1 @@\n-            NSK_CPP_STUB5(SetLocalLong, jvmti, thread, 0, 0, (jlong)0)))\n+            jvmti->SetLocalLong(thread, 0, 0, (jlong)0)))\n@@ -368,1 +356,1 @@\n-            NSK_CPP_STUB5(SetLocalFloat, jvmti, thread, 0, 0, (jfloat)0.0)))\n+            jvmti->SetLocalFloat(thread, 0, 0, (jfloat)0.0)))\n@@ -373,1 +361,1 @@\n-            NSK_CPP_STUB5(SetLocalDouble, jvmti, thread, 0, 0, (jdouble)0.0)))\n+            jvmti->SetLocalDouble(thread, 0, 0, (jdouble)0.0)))\n@@ -387,2 +375,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-            NSK_CPP_STUB3(GetSourceFileName, jvmti, klass, &name)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->GetSourceFileName(klass, &name)))\n@@ -393,1 +380,1 @@\n-            NSK_CPP_STUB3(GetSourceDebugExtension, jvmti, klass, &name)))\n+            jvmti->GetSourceDebugExtension(klass, &name)))\n@@ -398,2 +385,1 @@\n-            NSK_CPP_STUB4(GetLineNumberTable, jvmti, method, &count,\n-                &line_number_table)))\n+            jvmti->GetLineNumberTable(method, &count, &line_number_table)))\n@@ -415,1 +401,1 @@\n-            NSK_CPP_STUB3(RedefineClasses, jvmti, 1, &class_def)))\n+            jvmti->RedefineClasses(1, &class_def)))\n@@ -428,1 +414,1 @@\n-            NSK_CPP_STUB3(GetObjectMonitorUsage, jvmti, thread, &monitor_info)))\n+            jvmti->GetObjectMonitorUsage(thread, &monitor_info)))\n@@ -441,1 +427,1 @@\n-            NSK_CPP_STUB4(IsFieldSynthetic, jvmti, klass, field, &is_synthetic)))\n+            jvmti->IsFieldSynthetic(klass, field, &is_synthetic)))\n@@ -446,1 +432,1 @@\n-            NSK_CPP_STUB3(IsMethodSynthetic, jvmti, method, &is_synthetic)))\n+            jvmti->IsMethodSynthetic(method, &is_synthetic)))\n@@ -460,1 +446,1 @@\n-            NSK_CPP_STUB4(GetBytecodes, jvmti, method, &count, &bytecodes)))\n+            jvmti->GetBytecodes(method, &count, &bytecodes)))\n@@ -474,1 +460,1 @@\n-            NSK_CPP_STUB2(GetCurrentThreadCpuTimerInfo, jvmti, &info)))\n+            jvmti->GetCurrentThreadCpuTimerInfo(&info)))\n@@ -479,1 +465,1 @@\n-            NSK_CPP_STUB2(GetCurrentThreadCpuTime, jvmti, &nanos)))\n+            jvmti->GetCurrentThreadCpuTime(&nanos)))\n@@ -493,1 +479,1 @@\n-            NSK_CPP_STUB2(GetThreadCpuTimerInfo, jvmti, &info)))\n+            jvmti->GetThreadCpuTimerInfo(&info)))\n@@ -498,1 +484,1 @@\n-            NSK_CPP_STUB3(GetThreadCpuTime, jvmti, thread, &nanos)))\n+            jvmti->GetThreadCpuTime(thread, &nanos)))\n@@ -594,1 +580,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(GetPotentialCapabilities, jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->GetPotentialCapabilities(&caps)))\n@@ -606,1 +592,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(AddCapabilities, jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->AddCapabilities(&caps)))\n@@ -612,1 +598,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(GetCapabilities, jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->GetCapabilities(&caps)))\n@@ -624,1 +610,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(RelinquishCapabilities, jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->RelinquishCapabilities(&caps)))\n@@ -630,1 +616,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(GetCapabilities, jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->GetCapabilities(&caps)))\n@@ -642,1 +628,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(AddCapabilities, jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->AddCapabilities(&caps)))\n@@ -645,1 +631,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(GetCapabilities, jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->GetCapabilities(&caps)))\n","filename":"test\/hotspot\/jtreg\/vmTestbase\/nsk\/jvmti\/scenarios\/capability\/CM01\/cm01t010\/cm01t010.cpp","additions":63,"deletions":77,"binary":false,"changes":140,"status":"modified"},{"patch":"@@ -86,2 +86,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-           NSK_CPP_STUB3(GetAllThreads, jvmti, &threads_count, &threads)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->GetAllThreads(&threads_count, &threads)))\n@@ -99,2 +98,1 @@\n-        if (!NSK_JVMTI_VERIFY(\n-                NSK_CPP_STUB3(GetThreadInfo, jvmti, threads[i], &info)))\n+        if (!NSK_JVMTI_VERIFY(jvmti->GetThreadInfo(threads[i], &info)))\n@@ -112,2 +110,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-            NSK_CPP_STUB2(Deallocate, jvmti, (unsigned char*)threads)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->Deallocate((unsigned char*)threads)))\n@@ -117,2 +114,1 @@\n-    if (!NSK_JNI_VERIFY(jni, (klass =\n-            NSK_CPP_STUB2(GetObjectClass, jni, thread)) != NULL))\n+    if (!NSK_JNI_VERIFY(jni, (klass = jni->GetObjectClass(thread)) != NULL))\n@@ -122,2 +118,1 @@\n-    if (!NSK_JNI_VERIFY(jni, (method =\n-            NSK_CPP_STUB4(GetMethodID, jni, klass, \"run\", \"()V\")) != NULL))\n+    if (!NSK_JNI_VERIFY(jni, (method = jni->GetMethodID(klass, \"run\", \"()V\")) != NULL))\n@@ -128,2 +123,1 @@\n-            NSK_CPP_STUB4(GetFieldID, jni, klass,\n-                \"waitingMonitor\", \"Ljava\/lang\/Object;\")) != NULL))\n+            jni->GetFieldID(klass, \"waitingMonitor\", \"Ljava\/lang\/Object;\")) != NULL))\n@@ -143,2 +137,1 @@\n-    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY,\n-            NSK_CPP_STUB2(SuspendThread, jvmti, thread)))\n+    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY, jvmti->SuspendThread(thread)))\n@@ -148,2 +141,1 @@\n-    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY,\n-            NSK_CPP_STUB2(ResumeThread, jvmti, thread)))\n+    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY, jvmti->ResumeThread(thread)))\n@@ -154,1 +146,1 @@\n-            NSK_CPP_STUB4(SuspendThreadList, jvmti, 1, &thread, &err)))\n+            jvmti->SuspendThreadList(1, &thread, &err)))\n@@ -159,1 +151,1 @@\n-            NSK_CPP_STUB4(ResumeThreadList, jvmti, 1, &thread, &err)))\n+            jvmti->ResumeThreadList(1, &thread, &err)))\n@@ -175,2 +167,1 @@\n-    if (!NSK_JNI_VERIFY(jni, (cls =\n-            NSK_CPP_STUB2(FindClass, jni, THREAD_DEATH_CLASS_NAME)) != NULL))\n+    if (!NSK_JNI_VERIFY(jni, (cls = jni->FindClass(THREAD_DEATH_CLASS_NAME)) != NULL))\n@@ -180,2 +171,1 @@\n-            NSK_CPP_STUB4(GetMethodID, jni, cls,\n-                THREAD_DEATH_CTOR_NAME, THREAD_DEATH_CTOR_SIGNATURE)) != NULL))\n+            jni->GetMethodID(cls, THREAD_DEATH_CTOR_NAME, THREAD_DEATH_CTOR_SIGNATURE)) != NULL))\n@@ -184,2 +174,1 @@\n-    if (!NSK_JNI_VERIFY(jni, (exception =\n-            NSK_CPP_STUB3(NewObject, jni, cls, ctor)) != NULL))\n+    if (!NSK_JNI_VERIFY(jni, (exception = jni->NewObject(cls, ctor)) != NULL))\n@@ -190,1 +179,1 @@\n-            NSK_CPP_STUB3(StopThread, jvmti, thread, exception)))\n+            jvmti->StopThread(thread, exception)))\n@@ -194,2 +183,1 @@\n-    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY,\n-            NSK_CPP_STUB2(InterruptThread, jvmti, thread)))\n+    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY, jvmti->InterruptThread(thread)))\n@@ -209,1 +197,1 @@\n-            NSK_CPP_STUB4(GetOwnedMonitorInfo, jvmti, thread, &count, &monitors)))\n+            jvmti->GetOwnedMonitorInfo(thread, &count, &monitors)))\n@@ -222,1 +210,1 @@\n-            NSK_CPP_STUB3(GetCurrentContendedMonitor, jvmti, thread, &monitor)))\n+            jvmti->GetCurrentContendedMonitor(thread, &monitor)))\n@@ -232,2 +220,1 @@\n-    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY,\n-            NSK_CPP_STUB2(PopFrame, jvmti, thread)))\n+    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY, jvmti->PopFrame(thread)))\n@@ -277,1 +264,1 @@\n-            NSK_CPP_STUB3(SetTag, jvmti, thread, TAG_VALUE)))\n+            jvmti->SetTag(thread, TAG_VALUE)))\n@@ -281,2 +268,1 @@\n-    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY,\n-            NSK_CPP_STUB3(GetTag, jvmti, thread, &tag)))\n+    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY, jvmti->GetTag(thread, &tag)))\n@@ -288,2 +274,1 @@\n-            NSK_CPP_STUB6(GetObjectsWithTags, jvmti, 1, &tag,\n-                &count, &res_objects, &res_tags)))\n+            jvmti->GetObjectsWithTags(1, &tag, &count, &res_objects, &res_tags)))\n@@ -294,2 +279,1 @@\n-            NSK_CPP_STUB4(IterateOverHeap, jvmti, JVMTI_HEAP_OBJECT_TAGGED,\n-                HeapObject, &dummy_user_data)))\n+            jvmti->IterateOverHeap(JVMTI_HEAP_OBJECT_TAGGED, HeapObject, &dummy_user_data)))\n@@ -300,2 +284,4 @@\n-            NSK_CPP_STUB5(IterateOverInstancesOfClass, jvmti, klass,\n-                JVMTI_HEAP_OBJECT_UNTAGGED, HeapObject, &dummy_user_data)))\n+            jvmti->IterateOverInstancesOfClass(klass,\n+                                               JVMTI_HEAP_OBJECT_UNTAGGED,\n+                                               HeapObject,\n+                                               &dummy_user_data)))\n@@ -306,2 +292,3 @@\n-            NSK_CPP_STUB4(IterateOverObjectsReachableFromObject, jvmti, thread,\n-                ObjectReference, &dummy_user_data)))\n+            jvmti->IterateOverObjectsReachableFromObject(thread,\n+                                                         ObjectReference,\n+                                                         &dummy_user_data)))\n@@ -312,2 +299,4 @@\n-            NSK_CPP_STUB5(IterateOverReachableObjects, jvmti,\n-                HeapRoot, StackReference, ObjectReference, &dummy_user_data)))\n+            jvmti->IterateOverReachableObjects(HeapRoot,\n+                                               StackReference,\n+                                               ObjectReference,\n+                                               &dummy_user_data)))\n@@ -336,3 +325,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-            NSK_CPP_STUB4(GetLocalVariableTable, jvmti, method, &count,\n-                &local_variable_table)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->GetLocalVariableTable(method, &count, &local_variable_table)))\n@@ -344,1 +331,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(AddCapabilities, jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->AddCapabilities(&caps)))\n@@ -346,1 +333,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(SuspendThread, jvmti, thread)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->SuspendThread(thread)))\n@@ -353,2 +340,2 @@\n-            if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB5(GetLocalObject, jvmti,\n-                    thread, 1, local_variable_table[i].slot, &object_value)))\n+            if (!NSK_JVMTI_VERIFY(\n+                    jvmti->GetLocalObject(thread, 1, local_variable_table[i].slot, &object_value)))\n@@ -358,2 +345,2 @@\n-            if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB5(SetLocalObject, jvmti,\n-                    thread, 1, local_variable_table[i].slot, object_value)))\n+            if (!NSK_JVMTI_VERIFY(\n+                    jvmti->SetLocalObject(thread, 1, local_variable_table[i].slot, object_value)))\n@@ -363,2 +350,2 @@\n-            if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB5(GetLocalInt, jvmti,\n-                    thread, 1, local_variable_table[i].slot, &int_value)))\n+            if (!NSK_JVMTI_VERIFY(\n+                    jvmti->GetLocalInt(thread, 1, local_variable_table[i].slot, &int_value)))\n@@ -368,2 +355,2 @@\n-            if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB5(SetLocalInt, jvmti,\n-                    thread, 1, local_variable_table[i].slot, int_value)))\n+            if (!NSK_JVMTI_VERIFY(\n+                    jvmti->SetLocalInt(thread, 1, local_variable_table[i].slot, int_value)))\n@@ -373,2 +360,2 @@\n-            if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB5(GetLocalLong, jvmti,\n-                    thread, 1, local_variable_table[i].slot, &long_value)))\n+            if (!NSK_JVMTI_VERIFY(\n+                    jvmti->GetLocalLong(thread, 1, local_variable_table[i].slot, &long_value)))\n@@ -378,2 +365,2 @@\n-            if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB5(SetLocalLong, jvmti,\n-                    thread, 1, local_variable_table[i].slot, long_value)))\n+            if (!NSK_JVMTI_VERIFY(\n+                    jvmti->SetLocalLong(thread, 1, local_variable_table[i].slot, long_value)))\n@@ -383,2 +370,2 @@\n-            if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB5(GetLocalFloat, jvmti,\n-                    thread, 1, local_variable_table[i].slot, &float_value)))\n+            if (!NSK_JVMTI_VERIFY(\n+                    jvmti->GetLocalFloat(thread, 1, local_variable_table[i].slot, &float_value)))\n@@ -388,2 +375,2 @@\n-            if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB5(SetLocalFloat, jvmti,\n-                    thread, 1, local_variable_table[i].slot, float_value)))\n+            if (!NSK_JVMTI_VERIFY(\n+                    jvmti->SetLocalFloat(thread, 1, local_variable_table[i].slot, float_value)))\n@@ -393,2 +380,2 @@\n-            if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB5(GetLocalDouble, jvmti,\n-                    thread, 1, local_variable_table[i].slot, &double_value)))\n+            if (!NSK_JVMTI_VERIFY(\n+                    jvmti->GetLocalDouble(thread, 1, local_variable_table[i].slot, &double_value)))\n@@ -398,2 +385,2 @@\n-            if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB5(SetLocalDouble, jvmti,\n-                    thread, 1, local_variable_table[i].slot, double_value)))\n+            if (!NSK_JVMTI_VERIFY(\n+                    jvmti->SetLocalDouble(thread, 1, local_variable_table[i].slot, double_value)))\n@@ -405,1 +392,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(ResumeThread, jvmti, thread)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->ResumeThread(thread)))\n@@ -407,1 +394,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(RelinquishCapabilities, jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->RelinquishCapabilities(&caps)))\n@@ -411,2 +398,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(Deallocate, jvmti,\n-            (unsigned char*)local_variable_table)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->Deallocate((unsigned char*)local_variable_table)))\n@@ -427,1 +413,1 @@\n-            NSK_CPP_STUB3(GetSourceFileName, jvmti, klass, &name)))\n+            jvmti->GetSourceFileName(klass, &name)))\n@@ -432,1 +418,1 @@\n-            NSK_CPP_STUB3(GetSourceDebugExtension, jvmti, klass, &name)))\n+            jvmti->GetSourceDebugExtension(klass, &name)))\n@@ -437,2 +423,1 @@\n-            NSK_CPP_STUB4(GetLineNumberTable, jvmti, method, &count,\n-                &line_number_table)))\n+            jvmti->GetLineNumberTable(method, &count, &line_number_table)))\n@@ -454,1 +439,1 @@\n-            NSK_CPP_STUB3(RedefineClasses, jvmti, 1, &class_def)))\n+            jvmti->RedefineClasses(1, &class_def)))\n@@ -467,1 +452,1 @@\n-            NSK_CPP_STUB3(GetObjectMonitorUsage, jvmti, thread, &monitor_info)))\n+            jvmti->GetObjectMonitorUsage(thread, &monitor_info)))\n@@ -480,1 +465,1 @@\n-            NSK_CPP_STUB4(IsFieldSynthetic, jvmti, klass, field, &is_synthetic)))\n+            jvmti->IsFieldSynthetic(klass, field, &is_synthetic)))\n@@ -485,1 +470,1 @@\n-            NSK_CPP_STUB3(IsMethodSynthetic, jvmti, method, &is_synthetic)))\n+            jvmti->IsMethodSynthetic(method, &is_synthetic)))\n@@ -499,1 +484,1 @@\n-            NSK_CPP_STUB4(GetBytecodes, jvmti, method, &count, &bytecodes)))\n+            jvmti->GetBytecodes(method, &count, &bytecodes)))\n@@ -513,1 +498,1 @@\n-            NSK_CPP_STUB2(GetCurrentThreadCpuTimerInfo, jvmti, &info)))\n+            jvmti->GetCurrentThreadCpuTimerInfo(&info)))\n@@ -518,1 +503,1 @@\n-            NSK_CPP_STUB2(GetCurrentThreadCpuTime, jvmti, &nanos)))\n+            jvmti->GetCurrentThreadCpuTime(&nanos)))\n@@ -532,1 +517,1 @@\n-            NSK_CPP_STUB2(GetThreadCpuTimerInfo, jvmti, &info)))\n+            jvmti->GetThreadCpuTimerInfo(&info)))\n@@ -537,1 +522,1 @@\n-            NSK_CPP_STUB3(GetThreadCpuTime, jvmti, thread, &nanos)))\n+            jvmti->GetThreadCpuTime(thread, &nanos)))\n@@ -633,1 +618,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(GetPotentialCapabilities, jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->GetPotentialCapabilities(&caps)))\n@@ -645,1 +630,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(AddCapabilities, jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->AddCapabilities(&caps)))\n@@ -651,1 +636,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(GetCapabilities, jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->GetCapabilities(&caps)))\n@@ -663,1 +648,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(RelinquishCapabilities, jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->RelinquishCapabilities(&caps)))\n@@ -669,1 +654,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(GetCapabilities, jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->GetCapabilities(&caps)))\n@@ -681,1 +666,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(AddCapabilities, jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->AddCapabilities(&caps)))\n@@ -684,1 +669,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(GetCapabilities, jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->GetCapabilities(&caps)))\n","filename":"test\/hotspot\/jtreg\/vmTestbase\/nsk\/jvmti\/scenarios\/capability\/CM01\/cm01t011\/cm01t011.cpp","additions":78,"deletions":93,"binary":false,"changes":171,"status":"modified"},{"patch":"@@ -79,2 +79,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-           NSK_CPP_STUB3(GetAllThreads, jvmti, &threads_count, &threads)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->GetAllThreads(&threads_count, &threads)))\n@@ -92,2 +91,1 @@\n-        if (!NSK_JVMTI_VERIFY(\n-                NSK_CPP_STUB3(GetThreadInfo, jvmti, threads[i], &info)))\n+        if (!NSK_JVMTI_VERIFY(jvmti->GetThreadInfo(threads[i], &info)))\n@@ -105,2 +103,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-            NSK_CPP_STUB2(Deallocate, jvmti, (unsigned char*)threads)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->Deallocate((unsigned char*)threads)))\n@@ -110,2 +107,1 @@\n-    if (!NSK_JNI_VERIFY(jni, (klass =\n-            NSK_CPP_STUB2(GetObjectClass, jni, thread)) != NULL))\n+    if (!NSK_JNI_VERIFY(jni, (klass = jni->GetObjectClass(thread)) != NULL))\n@@ -115,2 +111,1 @@\n-    if (!NSK_JNI_VERIFY(jni, (method =\n-            NSK_CPP_STUB4(GetMethodID, jni, klass, \"run\", \"()V\")) != NULL))\n+    if (!NSK_JNI_VERIFY(jni, (method = jni->GetMethodID(klass, \"run\", \"()V\")) != NULL))\n@@ -121,2 +116,1 @@\n-            NSK_CPP_STUB4(GetFieldID, jni, klass,\n-                \"waitingMonitor\", \"Ljava\/lang\/Object;\")) != NULL))\n+            jni->GetFieldID(klass, \"waitingMonitor\", \"Ljava\/lang\/Object;\")) != NULL))\n@@ -136,1 +130,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(SuspendThread, jvmti, thread)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->SuspendThread(thread)))\n@@ -140,1 +134,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(ResumeThread, jvmti, thread)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->ResumeThread(thread)))\n@@ -144,2 +138,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-            NSK_CPP_STUB4(SuspendThreadList, jvmti, 1, &thread, &err)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->SuspendThreadList(1, &thread, &err)))\n@@ -149,2 +142,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-            NSK_CPP_STUB4(ResumeThreadList, jvmti, 1, &thread, &err)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->ResumeThreadList(1, &thread, &err)))\n@@ -166,2 +158,1 @@\n-    if (!NSK_JNI_VERIFY(jni, (cls =\n-            NSK_CPP_STUB2(FindClass, jni, THREAD_DEATH_CLASS_NAME)) != NULL))\n+    if (!NSK_JNI_VERIFY(jni, (cls = jni->FindClass(THREAD_DEATH_CLASS_NAME)) != NULL))\n@@ -171,2 +162,1 @@\n-            NSK_CPP_STUB4(GetMethodID, jni, cls,\n-                THREAD_DEATH_CTOR_NAME, THREAD_DEATH_CTOR_SIGNATURE)) != NULL))\n+            jni->GetMethodID(cls, THREAD_DEATH_CTOR_NAME, THREAD_DEATH_CTOR_SIGNATURE)) != NULL))\n@@ -175,2 +165,1 @@\n-    if (!NSK_JNI_VERIFY(jni, (exception =\n-            NSK_CPP_STUB3(NewObject, jni, cls, ctor)) != NULL))\n+    if (!NSK_JNI_VERIFY(jni, (exception = jni->NewObject(cls, ctor)) != NULL))\n@@ -181,1 +170,1 @@\n-            NSK_CPP_STUB3(StopThread, jvmti, thread, exception)))\n+            jvmti->StopThread(thread, exception)))\n@@ -185,2 +174,1 @@\n-    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY,\n-            NSK_CPP_STUB2(InterruptThread, jvmti, thread)))\n+    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY, jvmti->InterruptThread(thread)))\n@@ -200,1 +188,1 @@\n-            NSK_CPP_STUB4(GetOwnedMonitorInfo, jvmti, thread, &count, &monitors)))\n+            jvmti->GetOwnedMonitorInfo(thread, &count, &monitors)))\n@@ -213,1 +201,1 @@\n-            NSK_CPP_STUB3(GetCurrentContendedMonitor, jvmti, thread, &monitor)))\n+            jvmti->GetCurrentContendedMonitor(thread, &monitor)))\n@@ -223,2 +211,1 @@\n-    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY,\n-            NSK_CPP_STUB2(PopFrame, jvmti, thread)))\n+    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY, jvmti->PopFrame(thread)))\n@@ -268,1 +255,1 @@\n-            NSK_CPP_STUB3(SetTag, jvmti, thread, TAG_VALUE)))\n+            jvmti->SetTag(thread, TAG_VALUE)))\n@@ -272,2 +259,1 @@\n-    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY,\n-            NSK_CPP_STUB3(GetTag, jvmti, thread, &tag)))\n+    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY, jvmti->GetTag(thread, &tag)))\n@@ -279,2 +265,1 @@\n-            NSK_CPP_STUB6(GetObjectsWithTags, jvmti, 1, &tag,\n-                &count, &res_objects, &res_tags)))\n+            jvmti->GetObjectsWithTags(1, &tag, &count, &res_objects, &res_tags)))\n@@ -285,2 +270,1 @@\n-            NSK_CPP_STUB4(IterateOverHeap, jvmti, JVMTI_HEAP_OBJECT_TAGGED,\n-                HeapObject, &dummy_user_data)))\n+            jvmti->IterateOverHeap(JVMTI_HEAP_OBJECT_TAGGED, HeapObject, &dummy_user_data)))\n@@ -291,2 +275,4 @@\n-            NSK_CPP_STUB5(IterateOverInstancesOfClass, jvmti, klass,\n-                JVMTI_HEAP_OBJECT_UNTAGGED, HeapObject, &dummy_user_data)))\n+            jvmti->IterateOverInstancesOfClass(klass,\n+                                               JVMTI_HEAP_OBJECT_UNTAGGED,\n+                                               HeapObject,\n+                                               &dummy_user_data)))\n@@ -297,2 +283,3 @@\n-            NSK_CPP_STUB4(IterateOverObjectsReachableFromObject, jvmti, thread,\n-                ObjectReference, &dummy_user_data)))\n+            jvmti->IterateOverObjectsReachableFromObject(thread,\n+                                                         ObjectReference,\n+                                                         &dummy_user_data)))\n@@ -303,2 +290,4 @@\n-            NSK_CPP_STUB5(IterateOverReachableObjects, jvmti,\n-                HeapRoot, StackReference, ObjectReference, &dummy_user_data)))\n+            jvmti->IterateOverReachableObjects(HeapRoot,\n+                                               StackReference,\n+                                               ObjectReference,\n+                                               &dummy_user_data)))\n@@ -323,2 +312,1 @@\n-            NSK_CPP_STUB4(GetLocalVariableTable, jvmti, method, &count,\n-                &local_variable_table)))\n+            jvmti->GetLocalVariableTable(method, &count, &local_variable_table)))\n@@ -329,1 +317,1 @@\n-            NSK_CPP_STUB5(GetLocalObject, jvmti, thread, 0, 0, &object_value)))\n+            jvmti->GetLocalObject(thread, 0, 0, &object_value)))\n@@ -334,1 +322,1 @@\n-            NSK_CPP_STUB5(GetLocalInt, jvmti, thread, 0, 0, &int_value)))\n+            jvmti->GetLocalInt(thread, 0, 0, &int_value)))\n@@ -339,1 +327,1 @@\n-            NSK_CPP_STUB5(GetLocalLong, jvmti, thread, 0, 0, &long_value)))\n+            jvmti->GetLocalLong(thread, 0, 0, &long_value)))\n@@ -344,1 +332,1 @@\n-            NSK_CPP_STUB5(GetLocalFloat, jvmti, thread, 0, 0, &float_value)))\n+            jvmti->GetLocalFloat(thread, 0, 0, &float_value)))\n@@ -349,1 +337,1 @@\n-            NSK_CPP_STUB5(GetLocalDouble, jvmti, thread, 0, 0, &double_value)))\n+            jvmti->GetLocalDouble(thread, 0, 0, &double_value)))\n@@ -354,1 +342,1 @@\n-            NSK_CPP_STUB5(SetLocalObject, jvmti, thread, 0, 0, thread)))\n+            jvmti->SetLocalObject(thread, 0, 0, thread)))\n@@ -359,1 +347,1 @@\n-            NSK_CPP_STUB5(SetLocalInt, jvmti, thread, 0, 0, (jint)0)))\n+            jvmti->SetLocalInt(thread, 0, 0, (jint)0)))\n@@ -364,1 +352,1 @@\n-            NSK_CPP_STUB5(SetLocalLong, jvmti, thread, 0, 0, (jlong)0)))\n+            jvmti->SetLocalLong(thread, 0, 0, (jlong)0)))\n@@ -369,1 +357,1 @@\n-            NSK_CPP_STUB5(SetLocalFloat, jvmti, thread, 0, 0, (jfloat)0.0)))\n+            jvmti->SetLocalFloat(thread, 0, 0, (jfloat)0.0)))\n@@ -374,1 +362,1 @@\n-            NSK_CPP_STUB5(SetLocalDouble, jvmti, thread, 0, 0, (jdouble)0.0)))\n+            jvmti->SetLocalDouble(thread, 0, 0, (jdouble)0.0)))\n@@ -389,1 +377,1 @@\n-            NSK_CPP_STUB3(GetSourceFileName, jvmti, klass, &name)))\n+            jvmti->GetSourceFileName(klass, &name)))\n@@ -394,1 +382,1 @@\n-            NSK_CPP_STUB3(GetSourceDebugExtension, jvmti, klass, &name)))\n+            jvmti->GetSourceDebugExtension(klass, &name)))\n@@ -399,2 +387,1 @@\n-            NSK_CPP_STUB4(GetLineNumberTable, jvmti, method, &count,\n-                &line_number_table)))\n+            jvmti->GetLineNumberTable(method, &count, &line_number_table)))\n@@ -416,1 +403,1 @@\n-            NSK_CPP_STUB3(RedefineClasses, jvmti, 1, &class_def)))\n+            jvmti->RedefineClasses(1, &class_def)))\n@@ -429,1 +416,1 @@\n-            NSK_CPP_STUB3(GetObjectMonitorUsage, jvmti, thread, &monitor_info)))\n+            jvmti->GetObjectMonitorUsage(thread, &monitor_info)))\n@@ -442,1 +429,1 @@\n-            NSK_CPP_STUB4(IsFieldSynthetic, jvmti, klass, field, &is_synthetic)))\n+            jvmti->IsFieldSynthetic(klass, field, &is_synthetic)))\n@@ -447,1 +434,1 @@\n-            NSK_CPP_STUB3(IsMethodSynthetic, jvmti, method, &is_synthetic)))\n+            jvmti->IsMethodSynthetic(method, &is_synthetic)))\n@@ -461,1 +448,1 @@\n-            NSK_CPP_STUB4(GetBytecodes, jvmti, method, &count, &bytecodes)))\n+            jvmti->GetBytecodes(method, &count, &bytecodes)))\n@@ -475,1 +462,1 @@\n-            NSK_CPP_STUB2(GetCurrentThreadCpuTimerInfo, jvmti, &info)))\n+            jvmti->GetCurrentThreadCpuTimerInfo(&info)))\n@@ -480,1 +467,1 @@\n-            NSK_CPP_STUB2(GetCurrentThreadCpuTime, jvmti, &nanos)))\n+            jvmti->GetCurrentThreadCpuTime(&nanos)))\n@@ -494,1 +481,1 @@\n-            NSK_CPP_STUB2(GetThreadCpuTimerInfo, jvmti, &info)))\n+            jvmti->GetThreadCpuTimerInfo(&info)))\n@@ -499,1 +486,1 @@\n-            NSK_CPP_STUB3(GetThreadCpuTime, jvmti, thread, &nanos)))\n+            jvmti->GetThreadCpuTime(thread, &nanos)))\n@@ -595,1 +582,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(GetPotentialCapabilities, jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->GetPotentialCapabilities(&caps)))\n@@ -607,1 +594,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(AddCapabilities, jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->AddCapabilities(&caps)))\n@@ -613,1 +600,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(GetCapabilities, jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->GetCapabilities(&caps)))\n@@ -625,1 +612,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(RelinquishCapabilities, jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->RelinquishCapabilities(&caps)))\n@@ -631,1 +618,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(GetCapabilities, jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->GetCapabilities(&caps)))\n@@ -643,1 +630,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(AddCapabilities, jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->AddCapabilities(&caps)))\n@@ -646,1 +633,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(GetCapabilities, jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->GetCapabilities(&caps)))\n","filename":"test\/hotspot\/jtreg\/vmTestbase\/nsk\/jvmti\/scenarios\/capability\/CM01\/cm01t012\/cm01t012.cpp","additions":63,"deletions":76,"binary":false,"changes":139,"status":"modified"},{"patch":"@@ -76,2 +76,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-           NSK_CPP_STUB3(GetAllThreads, jvmti, &threads_count, &threads)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->GetAllThreads(&threads_count, &threads)))\n@@ -89,2 +88,1 @@\n-        if (!NSK_JVMTI_VERIFY(\n-                NSK_CPP_STUB3(GetThreadInfo, jvmti, threads[i], &info)))\n+        if (!NSK_JVMTI_VERIFY(jvmti->GetThreadInfo(threads[i], &info)))\n@@ -102,2 +100,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-            NSK_CPP_STUB2(Deallocate, jvmti, (unsigned char*)threads)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->Deallocate((unsigned char*)threads)))\n@@ -107,2 +104,1 @@\n-    if (!NSK_JNI_VERIFY(jni, (klass =\n-            NSK_CPP_STUB2(GetObjectClass, jni, thread)) != NULL))\n+    if (!NSK_JNI_VERIFY(jni, (klass = jni->GetObjectClass(thread)) != NULL))\n@@ -112,2 +108,1 @@\n-    if (!NSK_JNI_VERIFY(jni, (method =\n-            NSK_CPP_STUB4(GetMethodID, jni, klass, \"run\", \"()V\")) != NULL))\n+    if (!NSK_JNI_VERIFY(jni, (method = jni->GetMethodID(klass, \"run\", \"()V\")) != NULL))\n@@ -118,2 +113,1 @@\n-            NSK_CPP_STUB4(GetFieldID, jni, klass,\n-                \"waitingMonitor\", \"Ljava\/lang\/Object;\")) != NULL))\n+            jni->GetFieldID(klass, \"waitingMonitor\", \"Ljava\/lang\/Object;\")) != NULL))\n@@ -133,2 +127,1 @@\n-    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY,\n-            NSK_CPP_STUB2(SuspendThread, jvmti, thread)))\n+    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY, jvmti->SuspendThread(thread)))\n@@ -138,2 +131,1 @@\n-    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY,\n-            NSK_CPP_STUB2(ResumeThread, jvmti, thread)))\n+    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY, jvmti->ResumeThread(thread)))\n@@ -144,1 +136,1 @@\n-            NSK_CPP_STUB4(SuspendThreadList, jvmti, 1, &thread, &err)))\n+            jvmti->SuspendThreadList(1, &thread, &err)))\n@@ -149,1 +141,1 @@\n-            NSK_CPP_STUB4(ResumeThreadList, jvmti, 1, &thread, &err)))\n+            jvmti->ResumeThreadList(1, &thread, &err)))\n@@ -165,2 +157,1 @@\n-    if (!NSK_JNI_VERIFY(jni, (cls =\n-            NSK_CPP_STUB2(FindClass, jni, THREAD_DEATH_CLASS_NAME)) != NULL))\n+    if (!NSK_JNI_VERIFY(jni, (cls = jni->FindClass(THREAD_DEATH_CLASS_NAME)) != NULL))\n@@ -170,2 +161,1 @@\n-            NSK_CPP_STUB4(GetMethodID, jni, cls,\n-                THREAD_DEATH_CTOR_NAME, THREAD_DEATH_CTOR_SIGNATURE)) != NULL))\n+            jni->GetMethodID(cls, THREAD_DEATH_CTOR_NAME, THREAD_DEATH_CTOR_SIGNATURE)) != NULL))\n@@ -174,2 +164,1 @@\n-    if (!NSK_JNI_VERIFY(jni, (exception =\n-            NSK_CPP_STUB3(NewObject, jni, cls, ctor)) != NULL))\n+    if (!NSK_JNI_VERIFY(jni, (exception = jni->NewObject(cls, ctor)) != NULL))\n@@ -180,1 +169,1 @@\n-            NSK_CPP_STUB3(StopThread, jvmti, thread, exception)))\n+            jvmti->StopThread(thread, exception)))\n@@ -184,2 +173,1 @@\n-    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY,\n-            NSK_CPP_STUB2(InterruptThread, jvmti, thread)))\n+    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY, jvmti->InterruptThread(thread)))\n@@ -199,1 +187,1 @@\n-            NSK_CPP_STUB4(GetOwnedMonitorInfo, jvmti, thread, &count, &monitors)))\n+            jvmti->GetOwnedMonitorInfo(thread, &count, &monitors)))\n@@ -212,1 +200,1 @@\n-            NSK_CPP_STUB3(GetCurrentContendedMonitor, jvmti, thread, &monitor)))\n+            jvmti->GetCurrentContendedMonitor(thread, &monitor)))\n@@ -222,2 +210,1 @@\n-    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY,\n-            NSK_CPP_STUB2(PopFrame, jvmti, thread)))\n+    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY, jvmti->PopFrame(thread)))\n@@ -267,1 +254,1 @@\n-            NSK_CPP_STUB3(SetTag, jvmti, thread, TAG_VALUE)))\n+            jvmti->SetTag(thread, TAG_VALUE)))\n@@ -271,2 +258,1 @@\n-    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY,\n-            NSK_CPP_STUB3(GetTag, jvmti, thread, &tag)))\n+    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY, jvmti->GetTag(thread, &tag)))\n@@ -278,2 +264,1 @@\n-            NSK_CPP_STUB6(GetObjectsWithTags, jvmti, 1, &tag,\n-                &count, &res_objects, &res_tags)))\n+            jvmti->GetObjectsWithTags(1, &tag, &count, &res_objects, &res_tags)))\n@@ -284,2 +269,1 @@\n-            NSK_CPP_STUB4(IterateOverHeap, jvmti, JVMTI_HEAP_OBJECT_TAGGED,\n-                HeapObject, &dummy_user_data)))\n+            jvmti->IterateOverHeap(JVMTI_HEAP_OBJECT_TAGGED, HeapObject, &dummy_user_data)))\n@@ -290,2 +274,4 @@\n-            NSK_CPP_STUB5(IterateOverInstancesOfClass, jvmti, klass,\n-                JVMTI_HEAP_OBJECT_UNTAGGED, HeapObject, &dummy_user_data)))\n+            jvmti->IterateOverInstancesOfClass(klass,\n+                                               JVMTI_HEAP_OBJECT_UNTAGGED,\n+                                               HeapObject,\n+                                               &dummy_user_data)))\n@@ -296,2 +282,3 @@\n-            NSK_CPP_STUB4(IterateOverObjectsReachableFromObject, jvmti, thread,\n-                ObjectReference, &dummy_user_data)))\n+            jvmti->IterateOverObjectsReachableFromObject(thread,\n+                                                         ObjectReference,\n+                                                         &dummy_user_data)))\n@@ -302,2 +289,4 @@\n-            NSK_CPP_STUB5(IterateOverReachableObjects, jvmti,\n-                HeapRoot, StackReference, ObjectReference, &dummy_user_data)))\n+            jvmti->IterateOverReachableObjects(HeapRoot,\n+                                               StackReference,\n+                                               ObjectReference,\n+                                               &dummy_user_data)))\n@@ -322,2 +311,1 @@\n-            NSK_CPP_STUB4(GetLocalVariableTable, jvmti, method, &count,\n-                &local_variable_table)))\n+            jvmti->GetLocalVariableTable(method, &count, &local_variable_table)))\n@@ -328,1 +316,1 @@\n-            NSK_CPP_STUB5(GetLocalObject, jvmti, thread, 0, 0, &object_value)))\n+            jvmti->GetLocalObject(thread, 0, 0, &object_value)))\n@@ -333,1 +321,1 @@\n-            NSK_CPP_STUB5(GetLocalInt, jvmti, thread, 0, 0, &int_value)))\n+            jvmti->GetLocalInt(thread, 0, 0, &int_value)))\n@@ -338,1 +326,1 @@\n-            NSK_CPP_STUB5(GetLocalLong, jvmti, thread, 0, 0, &long_value)))\n+            jvmti->GetLocalLong(thread, 0, 0, &long_value)))\n@@ -343,1 +331,1 @@\n-            NSK_CPP_STUB5(GetLocalFloat, jvmti, thread, 0, 0, &float_value)))\n+            jvmti->GetLocalFloat(thread, 0, 0, &float_value)))\n@@ -348,1 +336,1 @@\n-            NSK_CPP_STUB5(GetLocalDouble, jvmti, thread, 0, 0, &double_value)))\n+            jvmti->GetLocalDouble(thread, 0, 0, &double_value)))\n@@ -353,1 +341,1 @@\n-            NSK_CPP_STUB5(SetLocalObject, jvmti, thread, 0, 0, thread)))\n+            jvmti->SetLocalObject(thread, 0, 0, thread)))\n@@ -358,1 +346,1 @@\n-            NSK_CPP_STUB5(SetLocalInt, jvmti, thread, 0, 0, (jint)0)))\n+            jvmti->SetLocalInt(thread, 0, 0, (jint)0)))\n@@ -363,1 +351,1 @@\n-            NSK_CPP_STUB5(SetLocalLong, jvmti, thread, 0, 0, (jlong)0)))\n+            jvmti->SetLocalLong(thread, 0, 0, (jlong)0)))\n@@ -368,1 +356,1 @@\n-            NSK_CPP_STUB5(SetLocalFloat, jvmti, thread, 0, 0, (jfloat)0.0)))\n+            jvmti->SetLocalFloat(thread, 0, 0, (jfloat)0.0)))\n@@ -373,1 +361,1 @@\n-            NSK_CPP_STUB5(SetLocalDouble, jvmti, thread, 0, 0, (jdouble)0.0)))\n+            jvmti->SetLocalDouble(thread, 0, 0, (jdouble)0.0)))\n@@ -388,1 +376,1 @@\n-            NSK_CPP_STUB3(GetSourceFileName, jvmti, klass, &name)))\n+            jvmti->GetSourceFileName(klass, &name)))\n@@ -393,1 +381,1 @@\n-            NSK_CPP_STUB3(GetSourceDebugExtension, jvmti, klass, &name)))\n+            jvmti->GetSourceDebugExtension(klass, &name)))\n@@ -397,3 +385,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-            NSK_CPP_STUB4(GetLineNumberTable, jvmti, method, &count,\n-                &line_number_table)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->GetLineNumberTable(method, &count, &line_number_table)))\n@@ -415,1 +401,1 @@\n-            NSK_CPP_STUB3(RedefineClasses, jvmti, 1, &class_def)))\n+            jvmti->RedefineClasses(1, &class_def)))\n@@ -428,1 +414,1 @@\n-            NSK_CPP_STUB3(GetObjectMonitorUsage, jvmti, thread, &monitor_info)))\n+            jvmti->GetObjectMonitorUsage(thread, &monitor_info)))\n@@ -441,1 +427,1 @@\n-            NSK_CPP_STUB4(IsFieldSynthetic, jvmti, klass, field, &is_synthetic)))\n+            jvmti->IsFieldSynthetic(klass, field, &is_synthetic)))\n@@ -446,1 +432,1 @@\n-            NSK_CPP_STUB3(IsMethodSynthetic, jvmti, method, &is_synthetic)))\n+            jvmti->IsMethodSynthetic(method, &is_synthetic)))\n@@ -460,1 +446,1 @@\n-            NSK_CPP_STUB4(GetBytecodes, jvmti, method, &count, &bytecodes)))\n+            jvmti->GetBytecodes(method, &count, &bytecodes)))\n@@ -474,1 +460,1 @@\n-            NSK_CPP_STUB2(GetCurrentThreadCpuTimerInfo, jvmti, &info)))\n+            jvmti->GetCurrentThreadCpuTimerInfo(&info)))\n@@ -479,1 +465,1 @@\n-            NSK_CPP_STUB2(GetCurrentThreadCpuTime, jvmti, &nanos)))\n+            jvmti->GetCurrentThreadCpuTime(&nanos)))\n@@ -493,1 +479,1 @@\n-            NSK_CPP_STUB2(GetThreadCpuTimerInfo, jvmti, &info)))\n+            jvmti->GetThreadCpuTimerInfo(&info)))\n@@ -498,1 +484,1 @@\n-            NSK_CPP_STUB3(GetThreadCpuTime, jvmti, thread, &nanos)))\n+            jvmti->GetThreadCpuTime(thread, &nanos)))\n@@ -594,1 +580,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(GetPotentialCapabilities, jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->GetPotentialCapabilities(&caps)))\n@@ -606,1 +592,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(AddCapabilities, jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->AddCapabilities(&caps)))\n@@ -612,1 +598,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(GetCapabilities, jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->GetCapabilities(&caps)))\n@@ -624,1 +610,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(RelinquishCapabilities, jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->RelinquishCapabilities(&caps)))\n@@ -630,1 +616,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(GetCapabilities, jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->GetCapabilities(&caps)))\n@@ -642,1 +628,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(AddCapabilities, jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->AddCapabilities(&caps)))\n@@ -645,1 +631,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(GetCapabilities, jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->GetCapabilities(&caps)))\n","filename":"test\/hotspot\/jtreg\/vmTestbase\/nsk\/jvmti\/scenarios\/capability\/CM01\/cm01t013\/cm01t013.cpp","additions":63,"deletions":77,"binary":false,"changes":140,"status":"modified"},{"patch":"@@ -77,2 +77,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-           NSK_CPP_STUB3(GetAllThreads, jvmti, &threads_count, &threads)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->GetAllThreads(&threads_count, &threads)))\n@@ -90,2 +89,1 @@\n-        if (!NSK_JVMTI_VERIFY(\n-                NSK_CPP_STUB3(GetThreadInfo, jvmti, threads[i], &info)))\n+        if (!NSK_JVMTI_VERIFY(jvmti->GetThreadInfo(threads[i], &info)))\n@@ -103,2 +101,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-            NSK_CPP_STUB2(Deallocate, jvmti, (unsigned char*)threads)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->Deallocate((unsigned char*)threads)))\n@@ -108,2 +105,1 @@\n-    if (!NSK_JNI_VERIFY(jni, (klass =\n-            NSK_CPP_STUB2(GetObjectClass, jni, thread)) != NULL))\n+    if (!NSK_JNI_VERIFY(jni, (klass = jni->GetObjectClass(thread)) != NULL))\n@@ -113,2 +109,1 @@\n-    if (!NSK_JNI_VERIFY(jni, (method =\n-            NSK_CPP_STUB4(GetMethodID, jni, klass, \"run\", \"()V\")) != NULL))\n+    if (!NSK_JNI_VERIFY(jni, (method = jni->GetMethodID(klass, \"run\", \"()V\")) != NULL))\n@@ -119,2 +114,1 @@\n-            NSK_CPP_STUB4(GetFieldID, jni, klass,\n-                \"waitingMonitor\", \"Ljava\/lang\/Object;\")) != NULL))\n+            jni->GetFieldID(klass, \"waitingMonitor\", \"Ljava\/lang\/Object;\")) != NULL))\n@@ -133,1 +127,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(GetPotentialCapabilities, jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->GetPotentialCapabilities(&caps)))\n@@ -151,1 +145,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(AddCapabilities, jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->AddCapabilities(&caps)))\n@@ -163,1 +157,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(GetCapabilities, jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->GetCapabilities(&caps)))\n@@ -185,1 +179,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(RelinquishCapabilities, jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->RelinquishCapabilities(&caps)))\n@@ -199,2 +193,1 @@\n-    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY,\n-            NSK_CPP_STUB2(SuspendThread, jvmti, thread)))\n+    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY, jvmti->SuspendThread(thread)))\n@@ -204,2 +197,1 @@\n-    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY,\n-            NSK_CPP_STUB2(ResumeThread, jvmti, thread)))\n+    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY, jvmti->ResumeThread(thread)))\n@@ -210,1 +202,1 @@\n-            NSK_CPP_STUB4(SuspendThreadList, jvmti, 1, &thread, &err)))\n+            jvmti->SuspendThreadList(1, &thread, &err)))\n@@ -215,1 +207,1 @@\n-            NSK_CPP_STUB4(ResumeThreadList, jvmti, 1, &thread, &err)))\n+            jvmti->ResumeThreadList(1, &thread, &err)))\n@@ -231,2 +223,1 @@\n-    if (!NSK_JNI_VERIFY(jni, (cls =\n-            NSK_CPP_STUB2(FindClass, jni, THREAD_DEATH_CLASS_NAME)) != NULL))\n+    if (!NSK_JNI_VERIFY(jni, (cls = jni->FindClass(THREAD_DEATH_CLASS_NAME)) != NULL))\n@@ -236,2 +227,1 @@\n-            NSK_CPP_STUB4(GetMethodID, jni, cls,\n-                THREAD_DEATH_CTOR_NAME, THREAD_DEATH_CTOR_SIGNATURE)) != NULL))\n+            jni->GetMethodID(cls, THREAD_DEATH_CTOR_NAME, THREAD_DEATH_CTOR_SIGNATURE)) != NULL))\n@@ -240,2 +230,1 @@\n-    if (!NSK_JNI_VERIFY(jni, (exception =\n-            NSK_CPP_STUB3(NewObject, jni, cls, ctor)) != NULL))\n+    if (!NSK_JNI_VERIFY(jni, (exception = jni->NewObject(cls, ctor)) != NULL))\n@@ -246,1 +235,1 @@\n-            NSK_CPP_STUB3(StopThread, jvmti, thread, exception)))\n+            jvmti->StopThread(thread, exception)))\n@@ -250,2 +239,1 @@\n-    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY,\n-            NSK_CPP_STUB2(InterruptThread, jvmti, thread)))\n+    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY, jvmti->InterruptThread(thread)))\n@@ -265,1 +253,1 @@\n-            NSK_CPP_STUB4(GetOwnedMonitorInfo, jvmti, thread, &count, &monitors)))\n+            jvmti->GetOwnedMonitorInfo(thread, &count, &monitors)))\n@@ -278,1 +266,1 @@\n-            NSK_CPP_STUB3(GetCurrentContendedMonitor, jvmti, thread, &monitor)))\n+            jvmti->GetCurrentContendedMonitor(thread, &monitor)))\n@@ -288,2 +276,1 @@\n-    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY,\n-            NSK_CPP_STUB2(PopFrame, jvmti, thread)))\n+    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY, jvmti->PopFrame(thread)))\n@@ -333,1 +320,1 @@\n-            NSK_CPP_STUB3(SetTag, jvmti, thread, TAG_VALUE)))\n+            jvmti->SetTag(thread, TAG_VALUE)))\n@@ -337,2 +324,1 @@\n-    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY,\n-            NSK_CPP_STUB3(GetTag, jvmti, thread, &tag)))\n+    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY, jvmti->GetTag(thread, &tag)))\n@@ -344,2 +330,1 @@\n-            NSK_CPP_STUB6(GetObjectsWithTags, jvmti, 1, &tag,\n-                &count, &res_objects, &res_tags)))\n+            jvmti->GetObjectsWithTags(1, &tag, &count, &res_objects, &res_tags)))\n@@ -350,2 +335,1 @@\n-            NSK_CPP_STUB4(IterateOverHeap, jvmti, JVMTI_HEAP_OBJECT_TAGGED,\n-                HeapObject, &dummy_user_data)))\n+            jvmti->IterateOverHeap(JVMTI_HEAP_OBJECT_TAGGED, HeapObject, &dummy_user_data)))\n@@ -356,2 +340,4 @@\n-            NSK_CPP_STUB5(IterateOverInstancesOfClass, jvmti, klass,\n-                JVMTI_HEAP_OBJECT_UNTAGGED, HeapObject, &dummy_user_data)))\n+            jvmti->IterateOverInstancesOfClass(klass,\n+                                               JVMTI_HEAP_OBJECT_UNTAGGED,\n+                                               HeapObject,\n+                                               &dummy_user_data)))\n@@ -362,2 +348,3 @@\n-            NSK_CPP_STUB4(IterateOverObjectsReachableFromObject, jvmti, thread,\n-                ObjectReference, &dummy_user_data)))\n+            jvmti->IterateOverObjectsReachableFromObject(thread,\n+                                                         ObjectReference,\n+                                                         &dummy_user_data)))\n@@ -368,2 +355,4 @@\n-            NSK_CPP_STUB5(IterateOverReachableObjects, jvmti,\n-                HeapRoot, StackReference, ObjectReference, &dummy_user_data)))\n+            jvmti->IterateOverReachableObjects(HeapRoot,\n+                                               StackReference,\n+                                               ObjectReference,\n+                                               &dummy_user_data)))\n@@ -388,2 +377,1 @@\n-            NSK_CPP_STUB4(GetLocalVariableTable, jvmti, method, &count,\n-                &local_variable_table)))\n+            jvmti->GetLocalVariableTable(method, &count, &local_variable_table)))\n@@ -394,1 +382,1 @@\n-            NSK_CPP_STUB5(GetLocalObject, jvmti, thread, 0, 0, &object_value)))\n+            jvmti->GetLocalObject(thread, 0, 0, &object_value)))\n@@ -399,1 +387,1 @@\n-            NSK_CPP_STUB5(GetLocalInt, jvmti, thread, 0, 0, &int_value)))\n+            jvmti->GetLocalInt(thread, 0, 0, &int_value)))\n@@ -404,1 +392,1 @@\n-            NSK_CPP_STUB5(GetLocalLong, jvmti, thread, 0, 0, &long_value)))\n+            jvmti->GetLocalLong(thread, 0, 0, &long_value)))\n@@ -409,1 +397,1 @@\n-            NSK_CPP_STUB5(GetLocalFloat, jvmti, thread, 0, 0, &float_value)))\n+            jvmti->GetLocalFloat(thread, 0, 0, &float_value)))\n@@ -414,1 +402,1 @@\n-            NSK_CPP_STUB5(GetLocalDouble, jvmti, thread, 0, 0, &double_value)))\n+            jvmti->GetLocalDouble(thread, 0, 0, &double_value)))\n@@ -419,1 +407,1 @@\n-            NSK_CPP_STUB5(SetLocalObject, jvmti, thread, 0, 0, thread)))\n+            jvmti->SetLocalObject(thread, 0, 0, thread)))\n@@ -424,1 +412,1 @@\n-            NSK_CPP_STUB5(SetLocalInt, jvmti, thread, 0, 0, (jint)0)))\n+            jvmti->SetLocalInt(thread, 0, 0, (jint)0)))\n@@ -429,1 +417,1 @@\n-            NSK_CPP_STUB5(SetLocalLong, jvmti, thread, 0, 0, (jlong)0)))\n+            jvmti->SetLocalLong(thread, 0, 0, (jlong)0)))\n@@ -434,1 +422,1 @@\n-            NSK_CPP_STUB5(SetLocalFloat, jvmti, thread, 0, 0, (jfloat)0.0)))\n+            jvmti->SetLocalFloat(thread, 0, 0, (jfloat)0.0)))\n@@ -439,1 +427,1 @@\n-            NSK_CPP_STUB5(SetLocalDouble, jvmti, thread, 0, 0, (jdouble)0.0)))\n+            jvmti->SetLocalDouble(thread, 0, 0, (jdouble)0.0)))\n@@ -454,1 +442,1 @@\n-            NSK_CPP_STUB3(GetSourceFileName, jvmti, klass, &name)))\n+            jvmti->GetSourceFileName(klass, &name)))\n@@ -459,1 +447,1 @@\n-            NSK_CPP_STUB3(GetSourceDebugExtension, jvmti, klass, &name)))\n+            jvmti->GetSourceDebugExtension(klass, &name)))\n@@ -464,2 +452,1 @@\n-            NSK_CPP_STUB4(GetLineNumberTable, jvmti, method, &count,\n-                &line_number_table)))\n+            jvmti->GetLineNumberTable(method, &count, &line_number_table)))\n@@ -481,1 +468,1 @@\n-            NSK_CPP_STUB3(RedefineClasses, jvmti, 1, &class_def)))\n+            jvmti->RedefineClasses(1, &class_def)))\n@@ -494,1 +481,1 @@\n-            NSK_CPP_STUB3(GetObjectMonitorUsage, jvmti, thread, &monitor_info)))\n+            jvmti->GetObjectMonitorUsage(thread, &monitor_info)))\n@@ -507,1 +494,1 @@\n-            NSK_CPP_STUB4(IsFieldSynthetic, jvmti, klass, field, &is_synthetic)))\n+            jvmti->IsFieldSynthetic(klass, field, &is_synthetic)))\n@@ -512,1 +499,1 @@\n-            NSK_CPP_STUB3(IsMethodSynthetic, jvmti, method, &is_synthetic)))\n+            jvmti->IsMethodSynthetic(method, &is_synthetic)))\n@@ -526,2 +513,1 @@\n-        if (!NSK_JVMTI_VERIFY(\n-                NSK_CPP_STUB4(GetBytecodes, jvmti, method, &count, &bytecodes)))\n+        if (!NSK_JVMTI_VERIFY(jvmti->GetBytecodes(method, &count, &bytecodes)))\n@@ -529,1 +515,1 @@\n-        if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(Deallocate, jvmti, bytecodes)))\n+        if (!NSK_JVMTI_VERIFY(jvmti->Deallocate(bytecodes)))\n@@ -534,1 +520,1 @@\n-                NSK_CPP_STUB4(GetBytecodes, jvmti, method, &count, &bytecodes)))\n+                jvmti->GetBytecodes(method, &count, &bytecodes)))\n@@ -549,1 +535,1 @@\n-            NSK_CPP_STUB2(GetCurrentThreadCpuTimerInfo, jvmti, &info)))\n+            jvmti->GetCurrentThreadCpuTimerInfo(&info)))\n@@ -554,1 +540,1 @@\n-            NSK_CPP_STUB2(GetCurrentThreadCpuTime, jvmti, &nanos)))\n+            jvmti->GetCurrentThreadCpuTime(&nanos)))\n@@ -568,1 +554,1 @@\n-            NSK_CPP_STUB2(GetThreadCpuTimerInfo, jvmti, &info)))\n+            jvmti->GetThreadCpuTimerInfo(&info)))\n@@ -573,1 +559,1 @@\n-            NSK_CPP_STUB3(GetThreadCpuTime, jvmti, thread, &nanos)))\n+            jvmti->GetThreadCpuTime(thread, &nanos)))\n","filename":"test\/hotspot\/jtreg\/vmTestbase\/nsk\/jvmti\/scenarios\/capability\/CM01\/cm01t014\/cm01t014.cpp","additions":62,"deletions":76,"binary":false,"changes":138,"status":"modified"},{"patch":"@@ -79,2 +79,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-           NSK_CPP_STUB3(GetAllThreads, jvmti, &threads_count, &threads)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->GetAllThreads(&threads_count, &threads)))\n@@ -92,2 +91,1 @@\n-        if (!NSK_JVMTI_VERIFY(\n-                NSK_CPP_STUB3(GetThreadInfo, jvmti, threads[i], &info)))\n+        if (!NSK_JVMTI_VERIFY(jvmti->GetThreadInfo(threads[i], &info)))\n@@ -105,2 +103,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-            NSK_CPP_STUB2(Deallocate, jvmti, (unsigned char*)threads)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->Deallocate((unsigned char*)threads)))\n@@ -110,2 +107,1 @@\n-    if (!NSK_JNI_VERIFY(jni, (klass =\n-            NSK_CPP_STUB2(GetObjectClass, jni, thread)) != NULL))\n+    if (!NSK_JNI_VERIFY(jni, (klass = jni->GetObjectClass(thread)) != NULL))\n@@ -115,2 +111,1 @@\n-    if (!NSK_JNI_VERIFY(jni, (method =\n-            NSK_CPP_STUB4(GetMethodID, jni, klass, \"run\", \"()V\")) != NULL))\n+    if (!NSK_JNI_VERIFY(jni, (method = jni->GetMethodID(klass, \"run\", \"()V\")) != NULL))\n@@ -121,2 +116,1 @@\n-            NSK_CPP_STUB4(GetFieldID, jni, klass,\n-                \"waitingMonitor\", \"Ljava\/lang\/Object;\")) != NULL))\n+            jni->GetFieldID(klass, \"waitingMonitor\", \"Ljava\/lang\/Object;\")) != NULL))\n@@ -135,1 +129,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(GetPotentialCapabilities, jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->GetPotentialCapabilities(&caps)))\n@@ -153,1 +147,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(AddCapabilities, jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->AddCapabilities(&caps)))\n@@ -165,1 +159,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(GetCapabilities, jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->GetCapabilities(&caps)))\n@@ -187,1 +181,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(RelinquishCapabilities, jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->RelinquishCapabilities(&caps)))\n@@ -201,2 +195,1 @@\n-    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY,\n-            NSK_CPP_STUB2(SuspendThread, jvmti, thread)))\n+    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY, jvmti->SuspendThread(thread)))\n@@ -206,2 +199,1 @@\n-    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY,\n-            NSK_CPP_STUB2(ResumeThread, jvmti, thread)))\n+    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY, jvmti->ResumeThread(thread)))\n@@ -212,1 +204,1 @@\n-            NSK_CPP_STUB4(SuspendThreadList, jvmti, 1, &thread, &err)))\n+            jvmti->SuspendThreadList(1, &thread, &err)))\n@@ -217,1 +209,1 @@\n-            NSK_CPP_STUB4(ResumeThreadList, jvmti, 1, &thread, &err)))\n+            jvmti->ResumeThreadList(1, &thread, &err)))\n@@ -233,2 +225,1 @@\n-    if (!NSK_JNI_VERIFY(jni, (cls =\n-            NSK_CPP_STUB2(FindClass, jni, THREAD_DEATH_CLASS_NAME)) != NULL))\n+    if (!NSK_JNI_VERIFY(jni, (cls = jni->FindClass(THREAD_DEATH_CLASS_NAME)) != NULL))\n@@ -238,2 +229,1 @@\n-            NSK_CPP_STUB4(GetMethodID, jni, cls,\n-                THREAD_DEATH_CTOR_NAME, THREAD_DEATH_CTOR_SIGNATURE)) != NULL))\n+            jni->GetMethodID(cls, THREAD_DEATH_CTOR_NAME, THREAD_DEATH_CTOR_SIGNATURE)) != NULL))\n@@ -242,2 +232,1 @@\n-    if (!NSK_JNI_VERIFY(jni, (exception =\n-            NSK_CPP_STUB3(NewObject, jni, cls, ctor)) != NULL))\n+    if (!NSK_JNI_VERIFY(jni, (exception = jni->NewObject(cls, ctor)) != NULL))\n@@ -248,1 +237,1 @@\n-            NSK_CPP_STUB3(StopThread, jvmti, thread, exception)))\n+            jvmti->StopThread(thread, exception)))\n@@ -252,2 +241,1 @@\n-    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY,\n-            NSK_CPP_STUB2(InterruptThread, jvmti, thread)))\n+    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY, jvmti->InterruptThread(thread)))\n@@ -267,1 +255,1 @@\n-            NSK_CPP_STUB4(GetOwnedMonitorInfo, jvmti, thread, &count, &monitors)))\n+            jvmti->GetOwnedMonitorInfo(thread, &count, &monitors)))\n@@ -280,1 +268,1 @@\n-            NSK_CPP_STUB3(GetCurrentContendedMonitor, jvmti, thread, &monitor)))\n+            jvmti->GetCurrentContendedMonitor(thread, &monitor)))\n@@ -290,2 +278,1 @@\n-    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY,\n-            NSK_CPP_STUB2(PopFrame, jvmti, thread)))\n+    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY, jvmti->PopFrame(thread)))\n@@ -335,1 +322,1 @@\n-            NSK_CPP_STUB3(SetTag, jvmti, thread, TAG_VALUE)))\n+            jvmti->SetTag(thread, TAG_VALUE)))\n@@ -339,2 +326,1 @@\n-    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY,\n-            NSK_CPP_STUB3(GetTag, jvmti, thread, &tag)))\n+    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY, jvmti->GetTag(thread, &tag)))\n@@ -346,2 +332,1 @@\n-            NSK_CPP_STUB6(GetObjectsWithTags, jvmti, 1, &tag,\n-                &count, &res_objects, &res_tags)))\n+            jvmti->GetObjectsWithTags(1, &tag, &count, &res_objects, &res_tags)))\n@@ -352,2 +337,1 @@\n-            NSK_CPP_STUB4(IterateOverHeap, jvmti, JVMTI_HEAP_OBJECT_TAGGED,\n-                HeapObject, &dummy_user_data)))\n+            jvmti->IterateOverHeap(JVMTI_HEAP_OBJECT_TAGGED, HeapObject, &dummy_user_data)))\n@@ -358,2 +342,4 @@\n-            NSK_CPP_STUB5(IterateOverInstancesOfClass, jvmti, klass,\n-                JVMTI_HEAP_OBJECT_UNTAGGED, HeapObject, &dummy_user_data)))\n+            jvmti->IterateOverInstancesOfClass(klass,\n+                                               JVMTI_HEAP_OBJECT_UNTAGGED,\n+                                               HeapObject,\n+                                               &dummy_user_data)))\n@@ -364,2 +350,3 @@\n-            NSK_CPP_STUB4(IterateOverObjectsReachableFromObject, jvmti, thread,\n-                ObjectReference, &dummy_user_data)))\n+            jvmti->IterateOverObjectsReachableFromObject(thread,\n+                                                         ObjectReference,\n+                                                         &dummy_user_data)))\n@@ -370,2 +357,4 @@\n-            NSK_CPP_STUB5(IterateOverReachableObjects, jvmti,\n-                HeapRoot, StackReference, ObjectReference, &dummy_user_data)))\n+            jvmti->IterateOverReachableObjects(HeapRoot,\n+                                               StackReference,\n+                                               ObjectReference,\n+                                               &dummy_user_data)))\n@@ -390,2 +379,1 @@\n-            NSK_CPP_STUB4(GetLocalVariableTable, jvmti, method, &count,\n-                &local_variable_table)))\n+            jvmti->GetLocalVariableTable(method, &count, &local_variable_table)))\n@@ -396,1 +384,1 @@\n-            NSK_CPP_STUB5(GetLocalObject, jvmti, thread, 0, 0, &object_value)))\n+            jvmti->GetLocalObject(thread, 0, 0, &object_value)))\n@@ -401,1 +389,1 @@\n-            NSK_CPP_STUB5(GetLocalInt, jvmti, thread, 0, 0, &int_value)))\n+            jvmti->GetLocalInt(thread, 0, 0, &int_value)))\n@@ -406,1 +394,1 @@\n-            NSK_CPP_STUB5(GetLocalLong, jvmti, thread, 0, 0, &long_value)))\n+            jvmti->GetLocalLong(thread, 0, 0, &long_value)))\n@@ -411,1 +399,1 @@\n-            NSK_CPP_STUB5(GetLocalFloat, jvmti, thread, 0, 0, &float_value)))\n+            jvmti->GetLocalFloat(thread, 0, 0, &float_value)))\n@@ -416,1 +404,1 @@\n-            NSK_CPP_STUB5(GetLocalDouble, jvmti, thread, 0, 0, &double_value)))\n+            jvmti->GetLocalDouble(thread, 0, 0, &double_value)))\n@@ -421,1 +409,1 @@\n-            NSK_CPP_STUB5(SetLocalObject, jvmti, thread, 0, 0, thread)))\n+            jvmti->SetLocalObject(thread, 0, 0, thread)))\n@@ -426,1 +414,1 @@\n-            NSK_CPP_STUB5(SetLocalInt, jvmti, thread, 0, 0, (jint)0)))\n+            jvmti->SetLocalInt(thread, 0, 0, (jint)0)))\n@@ -431,1 +419,1 @@\n-            NSK_CPP_STUB5(SetLocalLong, jvmti, thread, 0, 0, (jlong)0)))\n+            jvmti->SetLocalLong(thread, 0, 0, (jlong)0)))\n@@ -436,1 +424,1 @@\n-            NSK_CPP_STUB5(SetLocalFloat, jvmti, thread, 0, 0, (jfloat)0.0)))\n+            jvmti->SetLocalFloat(thread, 0, 0, (jfloat)0.0)))\n@@ -441,1 +429,1 @@\n-            NSK_CPP_STUB5(SetLocalDouble, jvmti, thread, 0, 0, (jdouble)0.0)))\n+            jvmti->SetLocalDouble(thread, 0, 0, (jdouble)0.0)))\n@@ -456,1 +444,1 @@\n-            NSK_CPP_STUB3(GetSourceFileName, jvmti, klass, &name)))\n+            jvmti->GetSourceFileName(klass, &name)))\n@@ -461,1 +449,1 @@\n-            NSK_CPP_STUB3(GetSourceDebugExtension, jvmti, klass, &name)))\n+            jvmti->GetSourceDebugExtension(klass, &name)))\n@@ -466,2 +454,1 @@\n-            NSK_CPP_STUB4(GetLineNumberTable, jvmti, method, &count,\n-                &line_number_table)))\n+            jvmti->GetLineNumberTable(method, &count, &line_number_table)))\n@@ -483,1 +470,1 @@\n-            NSK_CPP_STUB3(RedefineClasses, jvmti, 1, &class_def)))\n+            jvmti->RedefineClasses(1, &class_def)))\n@@ -496,1 +483,1 @@\n-            NSK_CPP_STUB3(GetObjectMonitorUsage, jvmti, thread, &monitor_info)))\n+            jvmti->GetObjectMonitorUsage(thread, &monitor_info)))\n@@ -509,2 +496,1 @@\n-        if (!NSK_JVMTI_VERIFY(\n-                NSK_CPP_STUB4(IsFieldSynthetic, jvmti, klass, field, &is_synthetic)))\n+        if (!NSK_JVMTI_VERIFY(jvmti->IsFieldSynthetic(klass, field, &is_synthetic)))\n@@ -514,2 +500,1 @@\n-        if (!NSK_JVMTI_VERIFY(\n-                NSK_CPP_STUB3(IsMethodSynthetic, jvmti, method, &is_synthetic)))\n+        if (!NSK_JVMTI_VERIFY(jvmti->IsMethodSynthetic(method, &is_synthetic)))\n@@ -520,1 +505,1 @@\n-                NSK_CPP_STUB4(IsFieldSynthetic, jvmti, klass, field, &is_synthetic)))\n+                jvmti->IsFieldSynthetic(klass, field, &is_synthetic)))\n@@ -525,1 +510,1 @@\n-                NSK_CPP_STUB3(IsMethodSynthetic, jvmti, method, &is_synthetic)))\n+                jvmti->IsMethodSynthetic(method, &is_synthetic)))\n@@ -540,1 +525,1 @@\n-            NSK_CPP_STUB4(GetBytecodes, jvmti, method, &count, &bytecodes)))\n+            jvmti->GetBytecodes(method, &count, &bytecodes)))\n@@ -554,1 +539,1 @@\n-            NSK_CPP_STUB2(GetCurrentThreadCpuTimerInfo, jvmti, &info)))\n+            jvmti->GetCurrentThreadCpuTimerInfo(&info)))\n@@ -559,1 +544,1 @@\n-            NSK_CPP_STUB2(GetCurrentThreadCpuTime, jvmti, &nanos)))\n+            jvmti->GetCurrentThreadCpuTime(&nanos)))\n@@ -573,1 +558,1 @@\n-            NSK_CPP_STUB2(GetThreadCpuTimerInfo, jvmti, &info)))\n+            jvmti->GetThreadCpuTimerInfo(&info)))\n@@ -578,1 +563,1 @@\n-            NSK_CPP_STUB3(GetThreadCpuTime, jvmti, thread, &nanos)))\n+            jvmti->GetThreadCpuTime(thread, &nanos)))\n","filename":"test\/hotspot\/jtreg\/vmTestbase\/nsk\/jvmti\/scenarios\/capability\/CM01\/cm01t015\/cm01t015.cpp","additions":62,"deletions":77,"binary":false,"changes":139,"status":"modified"},{"patch":"@@ -77,2 +77,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-           NSK_CPP_STUB3(GetAllThreads, jvmti, &threads_count, &threads)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->GetAllThreads(&threads_count, &threads)))\n@@ -90,2 +89,1 @@\n-        if (!NSK_JVMTI_VERIFY(\n-                NSK_CPP_STUB3(GetThreadInfo, jvmti, threads[i], &info)))\n+        if (!NSK_JVMTI_VERIFY(jvmti->GetThreadInfo(threads[i], &info)))\n@@ -103,2 +101,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-            NSK_CPP_STUB2(Deallocate, jvmti, (unsigned char*)threads)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->Deallocate((unsigned char*)threads)))\n@@ -108,2 +105,1 @@\n-    if (!NSK_JNI_VERIFY(jni, (klass =\n-            NSK_CPP_STUB2(GetObjectClass, jni, thread)) != NULL))\n+    if (!NSK_JNI_VERIFY(jni, (klass = jni->GetObjectClass(thread)) != NULL))\n@@ -113,2 +109,1 @@\n-    if (!NSK_JNI_VERIFY(jni, (method =\n-            NSK_CPP_STUB4(GetMethodID, jni, klass, \"run\", \"()V\")) != NULL))\n+    if (!NSK_JNI_VERIFY(jni, (method = jni->GetMethodID(klass, \"run\", \"()V\")) != NULL))\n@@ -119,2 +114,1 @@\n-            NSK_CPP_STUB4(GetFieldID, jni, klass,\n-                \"waitingMonitor\", \"Ljava\/lang\/Object;\")) != NULL))\n+            jni->GetFieldID(klass, \"waitingMonitor\", \"Ljava\/lang\/Object;\")) != NULL))\n@@ -133,1 +127,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(GetPotentialCapabilities, jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->GetPotentialCapabilities(&caps)))\n@@ -151,1 +145,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(AddCapabilities, jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->AddCapabilities(&caps)))\n@@ -163,1 +157,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(GetCapabilities, jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->GetCapabilities(&caps)))\n@@ -185,1 +179,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(RelinquishCapabilities, jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->RelinquishCapabilities(&caps)))\n@@ -199,2 +193,1 @@\n-    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY,\n-            NSK_CPP_STUB2(SuspendThread, jvmti, thread)))\n+    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY, jvmti->SuspendThread(thread)))\n@@ -204,2 +197,1 @@\n-    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY,\n-            NSK_CPP_STUB2(ResumeThread, jvmti, thread)))\n+    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY, jvmti->ResumeThread(thread)))\n@@ -210,1 +202,1 @@\n-            NSK_CPP_STUB4(SuspendThreadList, jvmti, 1, &thread, &err)))\n+            jvmti->SuspendThreadList(1, &thread, &err)))\n@@ -215,1 +207,1 @@\n-            NSK_CPP_STUB4(ResumeThreadList, jvmti, 1, &thread, &err)))\n+            jvmti->ResumeThreadList(1, &thread, &err)))\n@@ -231,2 +223,1 @@\n-    if (!NSK_JNI_VERIFY(jni, (cls =\n-            NSK_CPP_STUB2(FindClass, jni, THREAD_DEATH_CLASS_NAME)) != NULL))\n+    if (!NSK_JNI_VERIFY(jni, (cls = jni->FindClass(THREAD_DEATH_CLASS_NAME)) != NULL))\n@@ -236,2 +227,1 @@\n-            NSK_CPP_STUB4(GetMethodID, jni, cls,\n-                THREAD_DEATH_CTOR_NAME, THREAD_DEATH_CTOR_SIGNATURE)) != NULL))\n+            jni->GetMethodID(cls, THREAD_DEATH_CTOR_NAME, THREAD_DEATH_CTOR_SIGNATURE)) != NULL))\n@@ -240,2 +230,1 @@\n-    if (!NSK_JNI_VERIFY(jni, (exception =\n-            NSK_CPP_STUB3(NewObject, jni, cls, ctor)) != NULL))\n+    if (!NSK_JNI_VERIFY(jni, (exception = jni->NewObject(cls, ctor)) != NULL))\n@@ -246,1 +235,1 @@\n-            NSK_CPP_STUB3(StopThread, jvmti, thread, exception)))\n+            jvmti->StopThread(thread, exception)))\n@@ -250,2 +239,1 @@\n-    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY,\n-            NSK_CPP_STUB2(InterruptThread, jvmti, thread)))\n+    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY, jvmti->InterruptThread(thread)))\n@@ -265,1 +253,1 @@\n-            NSK_CPP_STUB4(GetOwnedMonitorInfo, jvmti, thread, &count, &monitors)))\n+            jvmti->GetOwnedMonitorInfo(thread, &count, &monitors)))\n@@ -278,1 +266,1 @@\n-            NSK_CPP_STUB3(GetCurrentContendedMonitor, jvmti, thread, &monitor)))\n+            jvmti->GetCurrentContendedMonitor(thread, &monitor)))\n@@ -288,2 +276,1 @@\n-    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY,\n-            NSK_CPP_STUB2(PopFrame, jvmti, thread)))\n+    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY, jvmti->PopFrame(thread)))\n@@ -333,1 +320,1 @@\n-            NSK_CPP_STUB3(SetTag, jvmti, thread, TAG_VALUE)))\n+            jvmti->SetTag(thread, TAG_VALUE)))\n@@ -337,2 +324,1 @@\n-    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY,\n-            NSK_CPP_STUB3(GetTag, jvmti, thread, &tag)))\n+    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY, jvmti->GetTag(thread, &tag)))\n@@ -344,2 +330,1 @@\n-            NSK_CPP_STUB6(GetObjectsWithTags, jvmti, 1, &tag,\n-                &count, &res_objects, &res_tags)))\n+            jvmti->GetObjectsWithTags(1, &tag, &count, &res_objects, &res_tags)))\n@@ -350,2 +335,1 @@\n-            NSK_CPP_STUB4(IterateOverHeap, jvmti, JVMTI_HEAP_OBJECT_TAGGED,\n-                HeapObject, &dummy_user_data)))\n+            jvmti->IterateOverHeap(JVMTI_HEAP_OBJECT_TAGGED, HeapObject, &dummy_user_data)))\n@@ -356,2 +340,4 @@\n-            NSK_CPP_STUB5(IterateOverInstancesOfClass, jvmti, klass,\n-                JVMTI_HEAP_OBJECT_UNTAGGED, HeapObject, &dummy_user_data)))\n+            jvmti->IterateOverInstancesOfClass(klass,\n+                                               JVMTI_HEAP_OBJECT_UNTAGGED,\n+                                               HeapObject,\n+                                               &dummy_user_data)))\n@@ -362,2 +348,3 @@\n-            NSK_CPP_STUB4(IterateOverObjectsReachableFromObject, jvmti, thread,\n-                ObjectReference, &dummy_user_data)))\n+            jvmti->IterateOverObjectsReachableFromObject(thread,\n+                                                         ObjectReference,\n+                                                         &dummy_user_data)))\n@@ -368,2 +355,4 @@\n-            NSK_CPP_STUB5(IterateOverReachableObjects, jvmti,\n-                HeapRoot, StackReference, ObjectReference, &dummy_user_data)))\n+            jvmti->IterateOverReachableObjects(HeapRoot,\n+                                               StackReference,\n+                                               ObjectReference,\n+                                               &dummy_user_data)))\n@@ -388,2 +377,1 @@\n-            NSK_CPP_STUB4(GetLocalVariableTable, jvmti, method, &count,\n-                &local_variable_table)))\n+            jvmti->GetLocalVariableTable(method, &count, &local_variable_table)))\n@@ -394,1 +382,1 @@\n-            NSK_CPP_STUB5(GetLocalObject, jvmti, thread, 0, 0, &object_value)))\n+            jvmti->GetLocalObject(thread, 0, 0, &object_value)))\n@@ -399,1 +387,1 @@\n-            NSK_CPP_STUB5(GetLocalInt, jvmti, thread, 0, 0, &int_value)))\n+            jvmti->GetLocalInt(thread, 0, 0, &int_value)))\n@@ -404,1 +392,1 @@\n-            NSK_CPP_STUB5(GetLocalLong, jvmti, thread, 0, 0, &long_value)))\n+            jvmti->GetLocalLong(thread, 0, 0, &long_value)))\n@@ -409,1 +397,1 @@\n-            NSK_CPP_STUB5(GetLocalFloat, jvmti, thread, 0, 0, &float_value)))\n+            jvmti->GetLocalFloat(thread, 0, 0, &float_value)))\n@@ -414,1 +402,1 @@\n-            NSK_CPP_STUB5(GetLocalDouble, jvmti, thread, 0, 0, &double_value)))\n+            jvmti->GetLocalDouble(thread, 0, 0, &double_value)))\n@@ -419,1 +407,1 @@\n-            NSK_CPP_STUB5(SetLocalObject, jvmti, thread, 0, 0, thread)))\n+            jvmti->SetLocalObject(thread, 0, 0, thread)))\n@@ -424,1 +412,1 @@\n-            NSK_CPP_STUB5(SetLocalInt, jvmti, thread, 0, 0, (jint)0)))\n+            jvmti->SetLocalInt(thread, 0, 0, (jint)0)))\n@@ -429,1 +417,1 @@\n-            NSK_CPP_STUB5(SetLocalLong, jvmti, thread, 0, 0, (jlong)0)))\n+            jvmti->SetLocalLong(thread, 0, 0, (jlong)0)))\n@@ -434,1 +422,1 @@\n-            NSK_CPP_STUB5(SetLocalFloat, jvmti, thread, 0, 0, (jfloat)0.0)))\n+            jvmti->SetLocalFloat(thread, 0, 0, (jfloat)0.0)))\n@@ -439,1 +427,1 @@\n-            NSK_CPP_STUB5(SetLocalDouble, jvmti, thread, 0, 0, (jdouble)0.0)))\n+            jvmti->SetLocalDouble(thread, 0, 0, (jdouble)0.0)))\n@@ -454,1 +442,1 @@\n-            NSK_CPP_STUB3(GetSourceFileName, jvmti, klass, &name)))\n+            jvmti->GetSourceFileName(klass, &name)))\n@@ -459,1 +447,1 @@\n-            NSK_CPP_STUB3(GetSourceDebugExtension, jvmti, klass, &name)))\n+            jvmti->GetSourceDebugExtension(klass, &name)))\n@@ -464,2 +452,1 @@\n-            NSK_CPP_STUB4(GetLineNumberTable, jvmti, method, &count,\n-                &line_number_table)))\n+            jvmti->GetLineNumberTable(method, &count, &line_number_table)))\n@@ -481,1 +468,1 @@\n-            NSK_CPP_STUB3(RedefineClasses, jvmti, 1, &class_def)))\n+            jvmti->RedefineClasses(1, &class_def)))\n@@ -494,2 +481,1 @@\n-        if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB3(GetObjectMonitorUsage, jvmti,\n-                thread, &monitor_info)))\n+        if (!NSK_JVMTI_VERIFY(jvmti->GetObjectMonitorUsage(thread, &monitor_info)))\n@@ -500,2 +486,1 @@\n-                NSK_CPP_STUB3(GetObjectMonitorUsage, jvmti,\n-                    thread, &monitor_info)))\n+                jvmti->GetObjectMonitorUsage(thread, &monitor_info)))\n@@ -515,1 +500,1 @@\n-            NSK_CPP_STUB4(IsFieldSynthetic, jvmti, klass, field, &is_synthetic)))\n+            jvmti->IsFieldSynthetic(klass, field, &is_synthetic)))\n@@ -520,1 +505,1 @@\n-            NSK_CPP_STUB3(IsMethodSynthetic, jvmti, method, &is_synthetic)))\n+            jvmti->IsMethodSynthetic(method, &is_synthetic)))\n@@ -534,1 +519,1 @@\n-            NSK_CPP_STUB4(GetBytecodes, jvmti, method, &count, &bytecodes)))\n+            jvmti->GetBytecodes(method, &count, &bytecodes)))\n@@ -548,1 +533,1 @@\n-            NSK_CPP_STUB2(GetCurrentThreadCpuTimerInfo, jvmti, &info)))\n+            jvmti->GetCurrentThreadCpuTimerInfo(&info)))\n@@ -553,1 +538,1 @@\n-            NSK_CPP_STUB2(GetCurrentThreadCpuTime, jvmti, &nanos)))\n+            jvmti->GetCurrentThreadCpuTime(&nanos)))\n@@ -567,1 +552,1 @@\n-            NSK_CPP_STUB2(GetThreadCpuTimerInfo, jvmti, &info)))\n+            jvmti->GetThreadCpuTimerInfo(&info)))\n@@ -572,1 +557,1 @@\n-            NSK_CPP_STUB3(GetThreadCpuTime, jvmti, thread, &nanos)))\n+            jvmti->GetThreadCpuTime(thread, &nanos)))\n","filename":"test\/hotspot\/jtreg\/vmTestbase\/nsk\/jvmti\/scenarios\/capability\/CM01\/cm01t016\/cm01t016.cpp","additions":61,"deletions":76,"binary":false,"changes":137,"status":"modified"},{"patch":"@@ -79,2 +79,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-           NSK_CPP_STUB3(GetAllThreads, jvmti, &threads_count, &threads)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->GetAllThreads(&threads_count, &threads)))\n@@ -92,2 +91,1 @@\n-        if (!NSK_JVMTI_VERIFY(\n-                NSK_CPP_STUB3(GetThreadInfo, jvmti, threads[i], &info)))\n+        if (!NSK_JVMTI_VERIFY(jvmti->GetThreadInfo(threads[i], &info)))\n@@ -105,2 +103,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-            NSK_CPP_STUB2(Deallocate, jvmti, (unsigned char*)threads)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->Deallocate((unsigned char*)threads)))\n@@ -110,2 +107,1 @@\n-    if (!NSK_JNI_VERIFY(jni, (klass =\n-            NSK_CPP_STUB2(GetObjectClass, jni, thread)) != NULL))\n+    if (!NSK_JNI_VERIFY(jni, (klass = jni->GetObjectClass(thread)) != NULL))\n@@ -115,2 +111,1 @@\n-    if (!NSK_JNI_VERIFY(jni, (method =\n-            NSK_CPP_STUB4(GetMethodID, jni, klass, \"run\", \"()V\")) != NULL))\n+    if (!NSK_JNI_VERIFY(jni, (method = jni->GetMethodID(klass, \"run\", \"()V\")) != NULL))\n@@ -121,2 +116,1 @@\n-            NSK_CPP_STUB4(GetFieldID, jni, klass,\n-                \"waitingMonitor\", \"Ljava\/lang\/Object;\")) != NULL))\n+            jni->GetFieldID(klass, \"waitingMonitor\", \"Ljava\/lang\/Object;\")) != NULL))\n@@ -135,1 +129,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(GetPotentialCapabilities, jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->GetPotentialCapabilities(&caps)))\n@@ -153,1 +147,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(AddCapabilities, jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->AddCapabilities(&caps)))\n@@ -165,1 +159,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(GetCapabilities, jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->GetCapabilities(&caps)))\n@@ -187,1 +181,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(RelinquishCapabilities, jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->RelinquishCapabilities(&caps)))\n@@ -201,2 +195,1 @@\n-    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY,\n-            NSK_CPP_STUB2(SuspendThread, jvmti, thread)))\n+    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY, jvmti->SuspendThread(thread)))\n@@ -206,2 +199,1 @@\n-    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY,\n-            NSK_CPP_STUB2(ResumeThread, jvmti, thread)))\n+    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY, jvmti->ResumeThread(thread)))\n@@ -212,1 +204,1 @@\n-            NSK_CPP_STUB4(SuspendThreadList, jvmti, 1, &thread, &err)))\n+            jvmti->SuspendThreadList(1, &thread, &err)))\n@@ -217,1 +209,1 @@\n-            NSK_CPP_STUB4(ResumeThreadList, jvmti, 1, &thread, &err)))\n+            jvmti->ResumeThreadList(1, &thread, &err)))\n@@ -233,2 +225,1 @@\n-    if (!NSK_JNI_VERIFY(jni, (cls =\n-            NSK_CPP_STUB2(FindClass, jni, THREAD_DEATH_CLASS_NAME)) != NULL))\n+    if (!NSK_JNI_VERIFY(jni, (cls = jni->FindClass(THREAD_DEATH_CLASS_NAME)) != NULL))\n@@ -238,2 +229,1 @@\n-            NSK_CPP_STUB4(GetMethodID, jni, cls,\n-                THREAD_DEATH_CTOR_NAME, THREAD_DEATH_CTOR_SIGNATURE)) != NULL))\n+            jni->GetMethodID(cls, THREAD_DEATH_CTOR_NAME, THREAD_DEATH_CTOR_SIGNATURE)) != NULL))\n@@ -242,2 +232,1 @@\n-    if (!NSK_JNI_VERIFY(jni, (exception =\n-            NSK_CPP_STUB3(NewObject, jni, cls, ctor)) != NULL))\n+    if (!NSK_JNI_VERIFY(jni, (exception = jni->NewObject(cls, ctor)) != NULL))\n@@ -248,1 +237,1 @@\n-        if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(InterruptThread, jvmti, thread)))\n+        if (!NSK_JVMTI_VERIFY(jvmti->InterruptThread(thread)))\n@@ -252,2 +241,1 @@\n-        if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB3(StopThread, jvmti,\n-                thread, exception)))\n+        if (!NSK_JVMTI_VERIFY(jvmti->StopThread(thread, exception)))\n@@ -258,1 +246,1 @@\n-                NSK_CPP_STUB3(StopThread, jvmti, thread, exception)))\n+                jvmti->StopThread(thread, exception)))\n@@ -263,1 +251,1 @@\n-                NSK_CPP_STUB2(InterruptThread, jvmti, thread)))\n+                jvmti->InterruptThread(thread)))\n@@ -278,1 +266,1 @@\n-            NSK_CPP_STUB4(GetOwnedMonitorInfo, jvmti, thread, &count, &monitors)))\n+            jvmti->GetOwnedMonitorInfo(thread, &count, &monitors)))\n@@ -291,1 +279,1 @@\n-            NSK_CPP_STUB3(GetCurrentContendedMonitor, jvmti, thread, &monitor)))\n+            jvmti->GetCurrentContendedMonitor(thread, &monitor)))\n@@ -301,2 +289,1 @@\n-    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY,\n-            NSK_CPP_STUB2(PopFrame, jvmti, thread)))\n+    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY, jvmti->PopFrame(thread)))\n@@ -346,1 +333,1 @@\n-            NSK_CPP_STUB3(SetTag, jvmti, thread, TAG_VALUE)))\n+            jvmti->SetTag(thread, TAG_VALUE)))\n@@ -350,2 +337,1 @@\n-    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY,\n-            NSK_CPP_STUB3(GetTag, jvmti, thread, &tag)))\n+    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY, jvmti->GetTag(thread, &tag)))\n@@ -357,2 +343,1 @@\n-            NSK_CPP_STUB6(GetObjectsWithTags, jvmti, 1, &tag,\n-                &count, &res_objects, &res_tags)))\n+            jvmti->GetObjectsWithTags(1, &tag, &count, &res_objects, &res_tags)))\n@@ -363,2 +348,1 @@\n-            NSK_CPP_STUB4(IterateOverHeap, jvmti, JVMTI_HEAP_OBJECT_TAGGED,\n-                HeapObject, &dummy_user_data)))\n+            jvmti->IterateOverHeap(JVMTI_HEAP_OBJECT_TAGGED, HeapObject, &dummy_user_data)))\n@@ -369,2 +353,4 @@\n-            NSK_CPP_STUB5(IterateOverInstancesOfClass, jvmti, klass,\n-                JVMTI_HEAP_OBJECT_UNTAGGED, HeapObject, &dummy_user_data)))\n+            jvmti->IterateOverInstancesOfClass(klass,\n+                                               JVMTI_HEAP_OBJECT_UNTAGGED,\n+                                               HeapObject,\n+                                               &dummy_user_data)))\n@@ -375,2 +361,3 @@\n-            NSK_CPP_STUB4(IterateOverObjectsReachableFromObject, jvmti, thread,\n-                ObjectReference, &dummy_user_data)))\n+            jvmti->IterateOverObjectsReachableFromObject(thread,\n+                                                         ObjectReference,\n+                                                         &dummy_user_data)))\n@@ -381,2 +368,4 @@\n-            NSK_CPP_STUB5(IterateOverReachableObjects, jvmti,\n-                HeapRoot, StackReference, ObjectReference, &dummy_user_data)))\n+            jvmti->IterateOverReachableObjects(HeapRoot,\n+                                               StackReference,\n+                                               ObjectReference,\n+                                               &dummy_user_data)))\n@@ -401,2 +390,1 @@\n-            NSK_CPP_STUB4(GetLocalVariableTable, jvmti, method, &count,\n-                &local_variable_table)))\n+            jvmti->GetLocalVariableTable(method, &count, &local_variable_table)))\n@@ -407,1 +395,1 @@\n-            NSK_CPP_STUB5(GetLocalObject, jvmti, thread, 0, 0, &object_value)))\n+            jvmti->GetLocalObject(thread, 0, 0, &object_value)))\n@@ -412,1 +400,1 @@\n-            NSK_CPP_STUB5(GetLocalInt, jvmti, thread, 0, 0, &int_value)))\n+            jvmti->GetLocalInt(thread, 0, 0, &int_value)))\n@@ -417,1 +405,1 @@\n-            NSK_CPP_STUB5(GetLocalLong, jvmti, thread, 0, 0, &long_value)))\n+            jvmti->GetLocalLong(thread, 0, 0, &long_value)))\n@@ -422,1 +410,1 @@\n-            NSK_CPP_STUB5(GetLocalFloat, jvmti, thread, 0, 0, &float_value)))\n+            jvmti->GetLocalFloat(thread, 0, 0, &float_value)))\n@@ -427,1 +415,1 @@\n-            NSK_CPP_STUB5(GetLocalDouble, jvmti, thread, 0, 0, &double_value)))\n+            jvmti->GetLocalDouble(thread, 0, 0, &double_value)))\n@@ -432,1 +420,1 @@\n-            NSK_CPP_STUB5(SetLocalObject, jvmti, thread, 0, 0, thread)))\n+            jvmti->SetLocalObject(thread, 0, 0, thread)))\n@@ -437,1 +425,1 @@\n-            NSK_CPP_STUB5(SetLocalInt, jvmti, thread, 0, 0, (jint)0)))\n+            jvmti->SetLocalInt(thread, 0, 0, (jint)0)))\n@@ -442,1 +430,1 @@\n-            NSK_CPP_STUB5(SetLocalLong, jvmti, thread, 0, 0, (jlong)0)))\n+            jvmti->SetLocalLong(thread, 0, 0, (jlong)0)))\n@@ -447,1 +435,1 @@\n-            NSK_CPP_STUB5(SetLocalFloat, jvmti, thread, 0, 0, (jfloat)0.0)))\n+            jvmti->SetLocalFloat(thread, 0, 0, (jfloat)0.0)))\n@@ -452,1 +440,1 @@\n-            NSK_CPP_STUB5(SetLocalDouble, jvmti, thread, 0, 0, (jdouble)0.0)))\n+            jvmti->SetLocalDouble(thread, 0, 0, (jdouble)0.0)))\n@@ -467,1 +455,1 @@\n-            NSK_CPP_STUB3(GetSourceFileName, jvmti, klass, &name)))\n+            jvmti->GetSourceFileName(klass, &name)))\n@@ -472,1 +460,1 @@\n-            NSK_CPP_STUB3(GetSourceDebugExtension, jvmti, klass, &name)))\n+            jvmti->GetSourceDebugExtension(klass, &name)))\n@@ -477,2 +465,1 @@\n-            NSK_CPP_STUB4(GetLineNumberTable, jvmti, method, &count,\n-                &line_number_table)))\n+            jvmti->GetLineNumberTable(method, &count, &line_number_table)))\n@@ -494,1 +481,1 @@\n-            NSK_CPP_STUB3(RedefineClasses, jvmti, 1, &class_def)))\n+            jvmti->RedefineClasses(1, &class_def)))\n@@ -507,1 +494,1 @@\n-            NSK_CPP_STUB3(GetObjectMonitorUsage, jvmti, thread, &monitor_info)))\n+            jvmti->GetObjectMonitorUsage(thread, &monitor_info)))\n@@ -520,1 +507,1 @@\n-            NSK_CPP_STUB4(IsFieldSynthetic, jvmti, klass, field, &is_synthetic)))\n+            jvmti->IsFieldSynthetic(klass, field, &is_synthetic)))\n@@ -525,1 +512,1 @@\n-            NSK_CPP_STUB3(IsMethodSynthetic, jvmti, method, &is_synthetic)))\n+            jvmti->IsMethodSynthetic(method, &is_synthetic)))\n@@ -539,1 +526,1 @@\n-            NSK_CPP_STUB4(GetBytecodes, jvmti, method, &count, &bytecodes)))\n+            jvmti->GetBytecodes(method, &count, &bytecodes)))\n@@ -553,1 +540,1 @@\n-            NSK_CPP_STUB2(GetCurrentThreadCpuTimerInfo, jvmti, &info)))\n+            jvmti->GetCurrentThreadCpuTimerInfo(&info)))\n@@ -558,1 +545,1 @@\n-            NSK_CPP_STUB2(GetCurrentThreadCpuTime, jvmti, &nanos)))\n+            jvmti->GetCurrentThreadCpuTime(&nanos)))\n@@ -572,1 +559,1 @@\n-            NSK_CPP_STUB2(GetThreadCpuTimerInfo, jvmti, &info)))\n+            jvmti->GetThreadCpuTimerInfo(&info)))\n@@ -577,1 +564,1 @@\n-            NSK_CPP_STUB3(GetThreadCpuTime, jvmti, thread, &nanos)))\n+            jvmti->GetThreadCpuTime(thread, &nanos)))\n","filename":"test\/hotspot\/jtreg\/vmTestbase\/nsk\/jvmti\/scenarios\/capability\/CM01\/cm01t017\/cm01t017.cpp","additions":62,"deletions":75,"binary":false,"changes":137,"status":"modified"},{"patch":"@@ -81,2 +81,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-           NSK_CPP_STUB3(GetAllThreads, jvmti, &threads_count, &threads)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->GetAllThreads(&threads_count, &threads)))\n@@ -94,2 +93,1 @@\n-        if (!NSK_JVMTI_VERIFY(\n-                NSK_CPP_STUB3(GetThreadInfo, jvmti, threads[i], &info)))\n+        if (!NSK_JVMTI_VERIFY(jvmti->GetThreadInfo(threads[i], &info)))\n@@ -107,2 +105,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-            NSK_CPP_STUB2(Deallocate, jvmti, (unsigned char*)threads)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->Deallocate((unsigned char*)threads)))\n@@ -112,2 +109,1 @@\n-    if (!NSK_JNI_VERIFY(jni, (klass =\n-            NSK_CPP_STUB2(GetObjectClass, jni, thread)) != NULL))\n+    if (!NSK_JNI_VERIFY(jni, (klass = jni->GetObjectClass(thread)) != NULL))\n@@ -117,2 +113,1 @@\n-    if (!NSK_JNI_VERIFY(jni, (method =\n-            NSK_CPP_STUB4(GetMethodID, jni, klass, \"run\", \"()V\")) != NULL))\n+    if (!NSK_JNI_VERIFY(jni, (method = jni->GetMethodID(klass, \"run\", \"()V\")) != NULL))\n@@ -123,2 +118,1 @@\n-            NSK_CPP_STUB4(GetFieldID, jni, klass,\n-                \"waitingMonitor\", \"Ljava\/lang\/Object;\")) != NULL))\n+            jni->GetFieldID(klass, \"waitingMonitor\", \"Ljava\/lang\/Object;\")) != NULL))\n@@ -137,1 +131,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(GetPotentialCapabilities, jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->GetPotentialCapabilities(&caps)))\n@@ -155,1 +149,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(AddCapabilities, jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->AddCapabilities(&caps)))\n@@ -167,1 +161,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(GetCapabilities, jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->GetCapabilities(&caps)))\n@@ -189,1 +183,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(RelinquishCapabilities, jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->RelinquishCapabilities(&caps)))\n@@ -204,1 +198,1 @@\n-        if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(SuspendThread, jvmti, thread)))\n+        if (!NSK_JVMTI_VERIFY(jvmti->SuspendThread(thread)))\n@@ -208,1 +202,1 @@\n-        if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(ResumeThread, jvmti, thread)))\n+        if (!NSK_JVMTI_VERIFY(jvmti->ResumeThread(thread)))\n@@ -212,2 +206,1 @@\n-        if (!NSK_JVMTI_VERIFY(\n-                NSK_CPP_STUB4(SuspendThreadList, jvmti, 1, &thread, &err)))\n+        if (!NSK_JVMTI_VERIFY(jvmti->SuspendThreadList(1, &thread, &err)))\n@@ -217,2 +210,1 @@\n-        if (!NSK_JVMTI_VERIFY(\n-                NSK_CPP_STUB4(ResumeThreadList, jvmti, 1, &thread, &err)))\n+        if (!NSK_JVMTI_VERIFY(jvmti->ResumeThreadList(1, &thread, &err)))\n@@ -223,1 +215,1 @@\n-                NSK_CPP_STUB2(SuspendThread, jvmti, thread)))\n+                jvmti->SuspendThread(thread)))\n@@ -228,1 +220,1 @@\n-                NSK_CPP_STUB2(ResumeThread, jvmti, thread)))\n+                jvmti->ResumeThread(thread)))\n@@ -233,1 +225,1 @@\n-                NSK_CPP_STUB4(SuspendThreadList, jvmti, 1, &thread, &err)))\n+                jvmti->SuspendThreadList(1, &thread, &err)))\n@@ -238,1 +230,1 @@\n-                NSK_CPP_STUB4(ResumeThreadList, jvmti, 1, &thread, &err)))\n+                jvmti->ResumeThreadList(1, &thread, &err)))\n@@ -255,2 +247,1 @@\n-    if (!NSK_JNI_VERIFY(jni, (cls =\n-            NSK_CPP_STUB2(FindClass, jni, THREAD_DEATH_CLASS_NAME)) != NULL))\n+    if (!NSK_JNI_VERIFY(jni, (cls = jni->FindClass(THREAD_DEATH_CLASS_NAME)) != NULL))\n@@ -260,2 +251,1 @@\n-            NSK_CPP_STUB4(GetMethodID, jni, cls,\n-                THREAD_DEATH_CTOR_NAME, THREAD_DEATH_CTOR_SIGNATURE)) != NULL))\n+            jni->GetMethodID(cls, THREAD_DEATH_CTOR_NAME, THREAD_DEATH_CTOR_SIGNATURE)) != NULL))\n@@ -264,2 +254,1 @@\n-    if (!NSK_JNI_VERIFY(jni, (exception =\n-            NSK_CPP_STUB3(NewObject, jni, cls, ctor)) != NULL))\n+    if (!NSK_JNI_VERIFY(jni, (exception = jni->NewObject(cls, ctor)) != NULL))\n@@ -270,1 +259,1 @@\n-            NSK_CPP_STUB3(StopThread, jvmti, thread, exception)))\n+            jvmti->StopThread(thread, exception)))\n@@ -274,2 +263,1 @@\n-    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY,\n-            NSK_CPP_STUB2(InterruptThread, jvmti, thread)))\n+    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY, jvmti->InterruptThread(thread)))\n@@ -289,1 +277,1 @@\n-            NSK_CPP_STUB4(GetOwnedMonitorInfo, jvmti, thread, &count, &monitors)))\n+            jvmti->GetOwnedMonitorInfo(thread, &count, &monitors)))\n@@ -302,1 +290,1 @@\n-            NSK_CPP_STUB3(GetCurrentContendedMonitor, jvmti, thread, &monitor)))\n+            jvmti->GetCurrentContendedMonitor(thread, &monitor)))\n@@ -312,2 +300,1 @@\n-    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY,\n-            NSK_CPP_STUB2(PopFrame, jvmti, thread)))\n+    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY, jvmti->PopFrame(thread)))\n@@ -357,1 +344,1 @@\n-            NSK_CPP_STUB3(SetTag, jvmti, thread, TAG_VALUE)))\n+            jvmti->SetTag(thread, TAG_VALUE)))\n@@ -361,2 +348,1 @@\n-    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY,\n-            NSK_CPP_STUB3(GetTag, jvmti, thread, &tag)))\n+    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY, jvmti->GetTag(thread, &tag)))\n@@ -368,2 +354,1 @@\n-            NSK_CPP_STUB6(GetObjectsWithTags, jvmti, 1, &tag,\n-                &count, &res_objects, &res_tags)))\n+            jvmti->GetObjectsWithTags(1, &tag, &count, &res_objects, &res_tags)))\n@@ -374,2 +359,1 @@\n-            NSK_CPP_STUB4(IterateOverHeap, jvmti, JVMTI_HEAP_OBJECT_TAGGED,\n-                HeapObject, &dummy_user_data)))\n+            jvmti->IterateOverHeap(JVMTI_HEAP_OBJECT_TAGGED, HeapObject, &dummy_user_data)))\n@@ -380,2 +364,4 @@\n-            NSK_CPP_STUB5(IterateOverInstancesOfClass, jvmti, klass,\n-                JVMTI_HEAP_OBJECT_UNTAGGED, HeapObject, &dummy_user_data)))\n+            jvmti->IterateOverInstancesOfClass(klass,\n+                                               JVMTI_HEAP_OBJECT_UNTAGGED,\n+                                               HeapObject,\n+                                               &dummy_user_data)))\n@@ -386,2 +372,3 @@\n-            NSK_CPP_STUB4(IterateOverObjectsReachableFromObject, jvmti, thread,\n-                ObjectReference, &dummy_user_data)))\n+            jvmti->IterateOverObjectsReachableFromObject(thread,\n+                                                         ObjectReference,\n+                                                         &dummy_user_data)))\n@@ -392,2 +379,4 @@\n-            NSK_CPP_STUB5(IterateOverReachableObjects, jvmti,\n-                HeapRoot, StackReference, ObjectReference, &dummy_user_data)))\n+            jvmti->IterateOverReachableObjects(HeapRoot,\n+                                               StackReference,\n+                                               ObjectReference,\n+                                               &dummy_user_data)))\n@@ -412,2 +401,1 @@\n-            NSK_CPP_STUB4(GetLocalVariableTable, jvmti, method, &count,\n-                &local_variable_table)))\n+            jvmti->GetLocalVariableTable(method, &count, &local_variable_table)))\n@@ -418,1 +406,1 @@\n-            NSK_CPP_STUB5(GetLocalObject, jvmti, thread, 0, 0, &object_value)))\n+            jvmti->GetLocalObject(thread, 0, 0, &object_value)))\n@@ -423,1 +411,1 @@\n-            NSK_CPP_STUB5(GetLocalInt, jvmti, thread, 0, 0, &int_value)))\n+            jvmti->GetLocalInt(thread, 0, 0, &int_value)))\n@@ -428,1 +416,1 @@\n-            NSK_CPP_STUB5(GetLocalLong, jvmti, thread, 0, 0, &long_value)))\n+            jvmti->GetLocalLong(thread, 0, 0, &long_value)))\n@@ -433,1 +421,1 @@\n-            NSK_CPP_STUB5(GetLocalFloat, jvmti, thread, 0, 0, &float_value)))\n+            jvmti->GetLocalFloat(thread, 0, 0, &float_value)))\n@@ -438,1 +426,1 @@\n-            NSK_CPP_STUB5(GetLocalDouble, jvmti, thread, 0, 0, &double_value)))\n+            jvmti->GetLocalDouble(thread, 0, 0, &double_value)))\n@@ -443,1 +431,1 @@\n-            NSK_CPP_STUB5(SetLocalObject, jvmti, thread, 0, 0, thread)))\n+            jvmti->SetLocalObject(thread, 0, 0, thread)))\n@@ -448,1 +436,1 @@\n-            NSK_CPP_STUB5(SetLocalInt, jvmti, thread, 0, 0, (jint)0)))\n+            jvmti->SetLocalInt(thread, 0, 0, (jint)0)))\n@@ -453,1 +441,1 @@\n-            NSK_CPP_STUB5(SetLocalLong, jvmti, thread, 0, 0, (jlong)0)))\n+            jvmti->SetLocalLong(thread, 0, 0, (jlong)0)))\n@@ -458,1 +446,1 @@\n-            NSK_CPP_STUB5(SetLocalFloat, jvmti, thread, 0, 0, (jfloat)0.0)))\n+            jvmti->SetLocalFloat(thread, 0, 0, (jfloat)0.0)))\n@@ -463,1 +451,1 @@\n-            NSK_CPP_STUB5(SetLocalDouble, jvmti, thread, 0, 0, (jdouble)0.0)))\n+            jvmti->SetLocalDouble(thread, 0, 0, (jdouble)0.0)))\n@@ -478,1 +466,1 @@\n-            NSK_CPP_STUB3(GetSourceFileName, jvmti, klass, &name)))\n+            jvmti->GetSourceFileName(klass, &name)))\n@@ -483,1 +471,1 @@\n-            NSK_CPP_STUB3(GetSourceDebugExtension, jvmti, klass, &name)))\n+            jvmti->GetSourceDebugExtension(klass, &name)))\n@@ -488,2 +476,1 @@\n-            NSK_CPP_STUB4(GetLineNumberTable, jvmti, method, &count,\n-                &line_number_table)))\n+            jvmti->GetLineNumberTable(method, &count, &line_number_table)))\n@@ -505,1 +492,1 @@\n-            NSK_CPP_STUB3(RedefineClasses, jvmti, 1, &class_def)))\n+            jvmti->RedefineClasses(1, &class_def)))\n@@ -518,1 +505,1 @@\n-            NSK_CPP_STUB3(GetObjectMonitorUsage, jvmti, thread, &monitor_info)))\n+            jvmti->GetObjectMonitorUsage(thread, &monitor_info)))\n@@ -531,1 +518,1 @@\n-            NSK_CPP_STUB4(IsFieldSynthetic, jvmti, klass, field, &is_synthetic)))\n+            jvmti->IsFieldSynthetic(klass, field, &is_synthetic)))\n@@ -536,1 +523,1 @@\n-            NSK_CPP_STUB3(IsMethodSynthetic, jvmti, method, &is_synthetic)))\n+            jvmti->IsMethodSynthetic(method, &is_synthetic)))\n@@ -550,1 +537,1 @@\n-            NSK_CPP_STUB4(GetBytecodes, jvmti, method, &count, &bytecodes)))\n+            jvmti->GetBytecodes(method, &count, &bytecodes)))\n@@ -564,1 +551,1 @@\n-            NSK_CPP_STUB2(GetCurrentThreadCpuTimerInfo, jvmti, &info)))\n+            jvmti->GetCurrentThreadCpuTimerInfo(&info)))\n@@ -569,1 +556,1 @@\n-            NSK_CPP_STUB2(GetCurrentThreadCpuTime, jvmti, &nanos)))\n+            jvmti->GetCurrentThreadCpuTime(&nanos)))\n@@ -583,1 +570,1 @@\n-            NSK_CPP_STUB2(GetThreadCpuTimerInfo, jvmti, &info)))\n+            jvmti->GetThreadCpuTimerInfo(&info)))\n@@ -588,1 +575,1 @@\n-            NSK_CPP_STUB3(GetThreadCpuTime, jvmti, thread, &nanos)))\n+            jvmti->GetThreadCpuTime(thread, &nanos)))\n","filename":"test\/hotspot\/jtreg\/vmTestbase\/nsk\/jvmti\/scenarios\/capability\/CM01\/cm01t018\/cm01t018.cpp","additions":64,"deletions":77,"binary":false,"changes":141,"status":"modified"},{"patch":"@@ -76,2 +76,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-           NSK_CPP_STUB3(GetAllThreads, jvmti, &threads_count, &threads)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->GetAllThreads(&threads_count, &threads)))\n@@ -89,2 +88,1 @@\n-        if (!NSK_JVMTI_VERIFY(\n-                NSK_CPP_STUB3(GetThreadInfo, jvmti, threads[i], &info)))\n+        if (!NSK_JVMTI_VERIFY(jvmti->GetThreadInfo(threads[i], &info)))\n@@ -102,2 +100,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-            NSK_CPP_STUB2(Deallocate, jvmti, (unsigned char*)threads)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->Deallocate((unsigned char*)threads)))\n@@ -107,2 +104,1 @@\n-    if (!NSK_JNI_VERIFY(jni, (klass =\n-            NSK_CPP_STUB2(GetObjectClass, jni, thread)) != NULL))\n+    if (!NSK_JNI_VERIFY(jni, (klass = jni->GetObjectClass(thread)) != NULL))\n@@ -112,2 +108,1 @@\n-    if (!NSK_JNI_VERIFY(jni, (method =\n-            NSK_CPP_STUB4(GetMethodID, jni, klass, \"run\", \"()V\")) != NULL))\n+    if (!NSK_JNI_VERIFY(jni, (method = jni->GetMethodID(klass, \"run\", \"()V\")) != NULL))\n@@ -118,2 +113,1 @@\n-            NSK_CPP_STUB4(GetFieldID, jni, klass,\n-                \"waitingMonitor\", \"Ljava\/lang\/Object;\")) != NULL))\n+            jni->GetFieldID(klass, \"waitingMonitor\", \"Ljava\/lang\/Object;\")) != NULL))\n@@ -133,2 +127,1 @@\n-    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY,\n-            NSK_CPP_STUB2(SuspendThread, jvmti, thread)))\n+    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY, jvmti->SuspendThread(thread)))\n@@ -138,2 +131,1 @@\n-    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY,\n-            NSK_CPP_STUB2(ResumeThread, jvmti, thread)))\n+    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY, jvmti->ResumeThread(thread)))\n@@ -144,1 +136,1 @@\n-            NSK_CPP_STUB4(SuspendThreadList, jvmti, 1, &thread, &err)))\n+            jvmti->SuspendThreadList(1, &thread, &err)))\n@@ -149,1 +141,1 @@\n-            NSK_CPP_STUB4(ResumeThreadList, jvmti, 1, &thread, &err)))\n+            jvmti->ResumeThreadList(1, &thread, &err)))\n@@ -165,2 +157,1 @@\n-    if (!NSK_JNI_VERIFY(jni, (cls =\n-            NSK_CPP_STUB2(FindClass, jni, THREAD_DEATH_CLASS_NAME)) != NULL))\n+    if (!NSK_JNI_VERIFY(jni, (cls = jni->FindClass(THREAD_DEATH_CLASS_NAME)) != NULL))\n@@ -170,2 +161,1 @@\n-            NSK_CPP_STUB4(GetMethodID, jni, cls,\n-                THREAD_DEATH_CTOR_NAME, THREAD_DEATH_CTOR_SIGNATURE)) != NULL))\n+            jni->GetMethodID(cls, THREAD_DEATH_CTOR_NAME, THREAD_DEATH_CTOR_SIGNATURE)) != NULL))\n@@ -174,2 +164,1 @@\n-    if (!NSK_JNI_VERIFY(jni, (exception =\n-            NSK_CPP_STUB3(NewObject, jni, cls, ctor)) != NULL))\n+    if (!NSK_JNI_VERIFY(jni, (exception = jni->NewObject(cls, ctor)) != NULL))\n@@ -180,1 +169,1 @@\n-            NSK_CPP_STUB3(StopThread, jvmti, thread, exception)))\n+            jvmti->StopThread(thread, exception)))\n@@ -184,2 +173,1 @@\n-    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY,\n-            NSK_CPP_STUB2(InterruptThread, jvmti, thread)))\n+    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY, jvmti->InterruptThread(thread)))\n@@ -199,1 +187,1 @@\n-            NSK_CPP_STUB4(GetOwnedMonitorInfo, jvmti, thread, &count, &monitors)))\n+            jvmti->GetOwnedMonitorInfo(thread, &count, &monitors)))\n@@ -212,1 +200,1 @@\n-            NSK_CPP_STUB3(GetCurrentContendedMonitor, jvmti, thread, &monitor)))\n+            jvmti->GetCurrentContendedMonitor(thread, &monitor)))\n@@ -222,2 +210,1 @@\n-    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY,\n-            NSK_CPP_STUB2(PopFrame, jvmti, thread)))\n+    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY, jvmti->PopFrame(thread)))\n@@ -267,1 +254,1 @@\n-            NSK_CPP_STUB3(SetTag, jvmti, thread, TAG_VALUE)))\n+            jvmti->SetTag(thread, TAG_VALUE)))\n@@ -271,2 +258,1 @@\n-    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY,\n-            NSK_CPP_STUB3(GetTag, jvmti, thread, &tag)))\n+    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY, jvmti->GetTag(thread, &tag)))\n@@ -278,2 +264,1 @@\n-            NSK_CPP_STUB6(GetObjectsWithTags, jvmti, 1, &tag,\n-                &count, &res_objects, &res_tags)))\n+            jvmti->GetObjectsWithTags(1, &tag, &count, &res_objects, &res_tags)))\n@@ -284,2 +269,1 @@\n-            NSK_CPP_STUB4(IterateOverHeap, jvmti, JVMTI_HEAP_OBJECT_TAGGED,\n-                HeapObject, &dummy_user_data)))\n+            jvmti->IterateOverHeap(JVMTI_HEAP_OBJECT_TAGGED, HeapObject, &dummy_user_data)))\n@@ -290,2 +274,4 @@\n-            NSK_CPP_STUB5(IterateOverInstancesOfClass, jvmti, klass,\n-                JVMTI_HEAP_OBJECT_UNTAGGED, HeapObject, &dummy_user_data)))\n+            jvmti->IterateOverInstancesOfClass(klass,\n+                                               JVMTI_HEAP_OBJECT_UNTAGGED,\n+                                               HeapObject,\n+                                               &dummy_user_data)))\n@@ -296,2 +282,3 @@\n-            NSK_CPP_STUB4(IterateOverObjectsReachableFromObject, jvmti, thread,\n-                ObjectReference, &dummy_user_data)))\n+            jvmti->IterateOverObjectsReachableFromObject(thread,\n+                                                         ObjectReference,\n+                                                         &dummy_user_data)))\n@@ -302,2 +289,4 @@\n-            NSK_CPP_STUB5(IterateOverReachableObjects, jvmti,\n-                HeapRoot, StackReference, ObjectReference, &dummy_user_data)))\n+            jvmti->IterateOverReachableObjects(HeapRoot,\n+                                               StackReference,\n+                                               ObjectReference,\n+                                               &dummy_user_data)))\n@@ -322,2 +311,1 @@\n-            NSK_CPP_STUB4(GetLocalVariableTable, jvmti, method, &count,\n-                &local_variable_table)))\n+            jvmti->GetLocalVariableTable(method, &count, &local_variable_table)))\n@@ -328,1 +316,1 @@\n-            NSK_CPP_STUB5(GetLocalObject, jvmti, thread, 0, 0, &object_value)))\n+            jvmti->GetLocalObject(thread, 0, 0, &object_value)))\n@@ -333,1 +321,1 @@\n-            NSK_CPP_STUB5(GetLocalInt, jvmti, thread, 0, 0, &int_value)))\n+            jvmti->GetLocalInt(thread, 0, 0, &int_value)))\n@@ -338,1 +326,1 @@\n-            NSK_CPP_STUB5(GetLocalLong, jvmti, thread, 0, 0, &long_value)))\n+            jvmti->GetLocalLong(thread, 0, 0, &long_value)))\n@@ -343,1 +331,1 @@\n-            NSK_CPP_STUB5(GetLocalFloat, jvmti, thread, 0, 0, &float_value)))\n+            jvmti->GetLocalFloat(thread, 0, 0, &float_value)))\n@@ -348,1 +336,1 @@\n-            NSK_CPP_STUB5(GetLocalDouble, jvmti, thread, 0, 0, &double_value)))\n+            jvmti->GetLocalDouble(thread, 0, 0, &double_value)))\n@@ -353,1 +341,1 @@\n-            NSK_CPP_STUB5(SetLocalObject, jvmti, thread, 0, 0, thread)))\n+            jvmti->SetLocalObject(thread, 0, 0, thread)))\n@@ -358,1 +346,1 @@\n-            NSK_CPP_STUB5(SetLocalInt, jvmti, thread, 0, 0, (jint)0)))\n+            jvmti->SetLocalInt(thread, 0, 0, (jint)0)))\n@@ -363,1 +351,1 @@\n-            NSK_CPP_STUB5(SetLocalLong, jvmti, thread, 0, 0, (jlong)0)))\n+            jvmti->SetLocalLong(thread, 0, 0, (jlong)0)))\n@@ -368,1 +356,1 @@\n-            NSK_CPP_STUB5(SetLocalFloat, jvmti, thread, 0, 0, (jfloat)0.0)))\n+            jvmti->SetLocalFloat(thread, 0, 0, (jfloat)0.0)))\n@@ -373,1 +361,1 @@\n-            NSK_CPP_STUB5(SetLocalDouble, jvmti, thread, 0, 0, (jdouble)0.0)))\n+            jvmti->SetLocalDouble(thread, 0, 0, (jdouble)0.0)))\n@@ -388,1 +376,1 @@\n-            NSK_CPP_STUB3(GetSourceFileName, jvmti, klass, &name)))\n+            jvmti->GetSourceFileName(klass, &name)))\n@@ -393,1 +381,1 @@\n-            NSK_CPP_STUB3(GetSourceDebugExtension, jvmti, klass, &name)))\n+            jvmti->GetSourceDebugExtension(klass, &name)))\n@@ -398,2 +386,1 @@\n-            NSK_CPP_STUB4(GetLineNumberTable, jvmti, method, &count,\n-                &line_number_table)))\n+            jvmti->GetLineNumberTable(method, &count, &line_number_table)))\n@@ -415,1 +402,1 @@\n-            NSK_CPP_STUB3(RedefineClasses, jvmti, 1, &class_def)))\n+            jvmti->RedefineClasses(1, &class_def)))\n@@ -428,1 +415,1 @@\n-            NSK_CPP_STUB3(GetObjectMonitorUsage, jvmti, thread, &monitor_info)))\n+            jvmti->GetObjectMonitorUsage(thread, &monitor_info)))\n@@ -441,1 +428,1 @@\n-            NSK_CPP_STUB4(IsFieldSynthetic, jvmti, klass, field, &is_synthetic)))\n+            jvmti->IsFieldSynthetic(klass, field, &is_synthetic)))\n@@ -446,1 +433,1 @@\n-            NSK_CPP_STUB3(IsMethodSynthetic, jvmti, method, &is_synthetic)))\n+            jvmti->IsMethodSynthetic(method, &is_synthetic)))\n@@ -460,1 +447,1 @@\n-            NSK_CPP_STUB4(GetBytecodes, jvmti, method, &count, &bytecodes)))\n+            jvmti->GetBytecodes(method, &count, &bytecodes)))\n@@ -474,1 +461,1 @@\n-            NSK_CPP_STUB2(GetCurrentThreadCpuTimerInfo, jvmti, &info)))\n+            jvmti->GetCurrentThreadCpuTimerInfo(&info)))\n@@ -479,1 +466,1 @@\n-            NSK_CPP_STUB2(GetCurrentThreadCpuTime, jvmti, &nanos)))\n+            jvmti->GetCurrentThreadCpuTime(&nanos)))\n@@ -493,1 +480,1 @@\n-            NSK_CPP_STUB2(GetThreadCpuTimerInfo, jvmti, &info)))\n+            jvmti->GetThreadCpuTimerInfo(&info)))\n@@ -498,1 +485,1 @@\n-            NSK_CPP_STUB3(GetThreadCpuTime, jvmti, thread, &nanos)))\n+            jvmti->GetThreadCpuTime(thread, &nanos)))\n@@ -594,1 +581,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(GetPotentialCapabilities, jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->GetPotentialCapabilities(&caps)))\n@@ -606,1 +593,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(AddCapabilities, jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->AddCapabilities(&caps)))\n@@ -612,1 +599,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(GetCapabilities, jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->GetCapabilities(&caps)))\n@@ -624,1 +611,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(RelinquishCapabilities, jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->RelinquishCapabilities(&caps)))\n@@ -630,1 +617,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(GetCapabilities, jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->GetCapabilities(&caps)))\n@@ -642,1 +629,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(AddCapabilities, jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->AddCapabilities(&caps)))\n@@ -645,1 +632,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(GetCapabilities, jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->GetCapabilities(&caps)))\n","filename":"test\/hotspot\/jtreg\/vmTestbase\/nsk\/jvmti\/scenarios\/capability\/CM01\/cm01t019\/cm01t019.cpp","additions":63,"deletions":76,"binary":false,"changes":139,"status":"modified"},{"patch":"@@ -77,2 +77,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-           NSK_CPP_STUB3(GetAllThreads, jvmti, &threads_count, &threads)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->GetAllThreads(&threads_count, &threads)))\n@@ -90,2 +89,1 @@\n-        if (!NSK_JVMTI_VERIFY(\n-                NSK_CPP_STUB3(GetThreadInfo, jvmti, threads[i], &info)))\n+        if (!NSK_JVMTI_VERIFY(jvmti->GetThreadInfo(threads[i], &info)))\n@@ -103,2 +101,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-            NSK_CPP_STUB2(Deallocate, jvmti, (unsigned char*)threads)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->Deallocate((unsigned char*)threads)))\n@@ -108,2 +105,1 @@\n-    if (!NSK_JNI_VERIFY(jni, (klass =\n-            NSK_CPP_STUB2(GetObjectClass, jni, thread)) != NULL))\n+    if (!NSK_JNI_VERIFY(jni, (klass = jni->GetObjectClass(thread)) != NULL))\n@@ -113,2 +109,1 @@\n-    if (!NSK_JNI_VERIFY(jni, (method =\n-            NSK_CPP_STUB4(GetMethodID, jni, klass, \"run\", \"()V\")) != NULL))\n+    if (!NSK_JNI_VERIFY(jni, (method = jni->GetMethodID(klass, \"run\", \"()V\")) != NULL))\n@@ -119,2 +114,1 @@\n-            NSK_CPP_STUB4(GetFieldID, jni, klass,\n-                \"waitingMonitor\", \"Ljava\/lang\/Object;\")) != NULL))\n+            jni->GetFieldID(klass, \"waitingMonitor\", \"Ljava\/lang\/Object;\")) != NULL))\n@@ -134,2 +128,1 @@\n-    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY,\n-            NSK_CPP_STUB2(SuspendThread, jvmti, thread)))\n+    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY, jvmti->SuspendThread(thread)))\n@@ -139,2 +132,1 @@\n-    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY,\n-            NSK_CPP_STUB2(ResumeThread, jvmti, thread)))\n+    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY, jvmti->ResumeThread(thread)))\n@@ -145,1 +137,1 @@\n-            NSK_CPP_STUB4(SuspendThreadList, jvmti, 1, &thread, &err)))\n+            jvmti->SuspendThreadList(1, &thread, &err)))\n@@ -150,1 +142,1 @@\n-            NSK_CPP_STUB4(ResumeThreadList, jvmti, 1, &thread, &err)))\n+            jvmti->ResumeThreadList(1, &thread, &err)))\n@@ -166,2 +158,1 @@\n-    if (!NSK_JNI_VERIFY(jni, (cls =\n-            NSK_CPP_STUB2(FindClass, jni, THREAD_DEATH_CLASS_NAME)) != NULL))\n+    if (!NSK_JNI_VERIFY(jni, (cls = jni->FindClass(THREAD_DEATH_CLASS_NAME)) != NULL))\n@@ -171,2 +162,1 @@\n-            NSK_CPP_STUB4(GetMethodID, jni, cls,\n-                THREAD_DEATH_CTOR_NAME, THREAD_DEATH_CTOR_SIGNATURE)) != NULL))\n+            jni->GetMethodID(cls, THREAD_DEATH_CTOR_NAME, THREAD_DEATH_CTOR_SIGNATURE)) != NULL))\n@@ -175,2 +165,1 @@\n-    if (!NSK_JNI_VERIFY(jni, (exception =\n-            NSK_CPP_STUB3(NewObject, jni, cls, ctor)) != NULL))\n+    if (!NSK_JNI_VERIFY(jni, (exception = jni->NewObject(cls, ctor)) != NULL))\n@@ -181,1 +170,1 @@\n-            NSK_CPP_STUB3(StopThread, jvmti, thread, exception)))\n+            jvmti->StopThread(thread, exception)))\n@@ -185,2 +174,1 @@\n-    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY,\n-            NSK_CPP_STUB2(InterruptThread, jvmti, thread)))\n+    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY, jvmti->InterruptThread(thread)))\n@@ -200,1 +188,1 @@\n-            NSK_CPP_STUB4(GetOwnedMonitorInfo, jvmti, thread, &count, &monitors)))\n+            jvmti->GetOwnedMonitorInfo(thread, &count, &monitors)))\n@@ -213,1 +201,1 @@\n-            NSK_CPP_STUB3(GetCurrentContendedMonitor, jvmti, thread, &monitor)))\n+            jvmti->GetCurrentContendedMonitor(thread, &monitor)))\n@@ -223,2 +211,1 @@\n-    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY,\n-            NSK_CPP_STUB2(PopFrame, jvmti, thread)))\n+    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY, jvmti->PopFrame(thread)))\n@@ -268,1 +255,1 @@\n-            NSK_CPP_STUB3(SetTag, jvmti, thread, TAG_VALUE)))\n+            jvmti->SetTag(thread, TAG_VALUE)))\n@@ -272,2 +259,1 @@\n-    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY,\n-            NSK_CPP_STUB3(GetTag, jvmti, thread, &tag)))\n+    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY, jvmti->GetTag(thread, &tag)))\n@@ -279,2 +265,1 @@\n-            NSK_CPP_STUB6(GetObjectsWithTags, jvmti, 1, &tag,\n-                &count, &res_objects, &res_tags)))\n+            jvmti->GetObjectsWithTags(1, &tag, &count, &res_objects, &res_tags)))\n@@ -285,2 +270,1 @@\n-            NSK_CPP_STUB4(IterateOverHeap, jvmti, JVMTI_HEAP_OBJECT_TAGGED,\n-                HeapObject, &dummy_user_data)))\n+            jvmti->IterateOverHeap(JVMTI_HEAP_OBJECT_TAGGED, HeapObject, &dummy_user_data)))\n@@ -291,2 +275,4 @@\n-            NSK_CPP_STUB5(IterateOverInstancesOfClass, jvmti, klass,\n-                JVMTI_HEAP_OBJECT_UNTAGGED, HeapObject, &dummy_user_data)))\n+            jvmti->IterateOverInstancesOfClass(klass,\n+                                               JVMTI_HEAP_OBJECT_UNTAGGED,\n+                                               HeapObject,\n+                                               &dummy_user_data)))\n@@ -297,2 +283,3 @@\n-            NSK_CPP_STUB4(IterateOverObjectsReachableFromObject, jvmti, thread,\n-                ObjectReference, &dummy_user_data)))\n+            jvmti->IterateOverObjectsReachableFromObject(thread,\n+                                                         ObjectReference,\n+                                                         &dummy_user_data)))\n@@ -303,2 +290,4 @@\n-            NSK_CPP_STUB5(IterateOverReachableObjects, jvmti,\n-                HeapRoot, StackReference, ObjectReference, &dummy_user_data)))\n+            jvmti->IterateOverReachableObjects(HeapRoot,\n+                                               StackReference,\n+                                               ObjectReference,\n+                                               &dummy_user_data)))\n@@ -323,2 +312,1 @@\n-            NSK_CPP_STUB4(GetLocalVariableTable, jvmti, method, &count,\n-                &local_variable_table)))\n+            jvmti->GetLocalVariableTable(method, &count, &local_variable_table)))\n@@ -329,1 +317,1 @@\n-            NSK_CPP_STUB5(GetLocalObject, jvmti, thread, 0, 0, &object_value)))\n+            jvmti->GetLocalObject(thread, 0, 0, &object_value)))\n@@ -334,1 +322,1 @@\n-            NSK_CPP_STUB5(GetLocalInt, jvmti, thread, 0, 0, &int_value)))\n+            jvmti->GetLocalInt(thread, 0, 0, &int_value)))\n@@ -339,1 +327,1 @@\n-            NSK_CPP_STUB5(GetLocalLong, jvmti, thread, 0, 0, &long_value)))\n+            jvmti->GetLocalLong(thread, 0, 0, &long_value)))\n@@ -344,1 +332,1 @@\n-            NSK_CPP_STUB5(GetLocalFloat, jvmti, thread, 0, 0, &float_value)))\n+            jvmti->GetLocalFloat(thread, 0, 0, &float_value)))\n@@ -349,1 +337,1 @@\n-            NSK_CPP_STUB5(GetLocalDouble, jvmti, thread, 0, 0, &double_value)))\n+            jvmti->GetLocalDouble(thread, 0, 0, &double_value)))\n@@ -354,1 +342,1 @@\n-            NSK_CPP_STUB5(SetLocalObject, jvmti, thread, 0, 0, thread)))\n+            jvmti->SetLocalObject(thread, 0, 0, thread)))\n@@ -359,1 +347,1 @@\n-            NSK_CPP_STUB5(SetLocalInt, jvmti, thread, 0, 0, (jint)0)))\n+            jvmti->SetLocalInt(thread, 0, 0, (jint)0)))\n@@ -364,1 +352,1 @@\n-            NSK_CPP_STUB5(SetLocalLong, jvmti, thread, 0, 0, (jlong)0)))\n+            jvmti->SetLocalLong(thread, 0, 0, (jlong)0)))\n@@ -369,1 +357,1 @@\n-            NSK_CPP_STUB5(SetLocalFloat, jvmti, thread, 0, 0, (jfloat)0.0)))\n+            jvmti->SetLocalFloat(thread, 0, 0, (jfloat)0.0)))\n@@ -374,1 +362,1 @@\n-            NSK_CPP_STUB5(SetLocalDouble, jvmti, thread, 0, 0, (jdouble)0.0)))\n+            jvmti->SetLocalDouble(thread, 0, 0, (jdouble)0.0)))\n@@ -389,1 +377,1 @@\n-            NSK_CPP_STUB3(GetSourceFileName, jvmti, klass, &name)))\n+            jvmti->GetSourceFileName(klass, &name)))\n@@ -394,1 +382,1 @@\n-            NSK_CPP_STUB3(GetSourceDebugExtension, jvmti, klass, &name)))\n+            jvmti->GetSourceDebugExtension(klass, &name)))\n@@ -399,2 +387,1 @@\n-            NSK_CPP_STUB4(GetLineNumberTable, jvmti, method, &count,\n-                &line_number_table)))\n+            jvmti->GetLineNumberTable(method, &count, &line_number_table)))\n@@ -416,1 +403,1 @@\n-            NSK_CPP_STUB3(RedefineClasses, jvmti, 1, &class_def)))\n+            jvmti->RedefineClasses(1, &class_def)))\n@@ -429,1 +416,1 @@\n-            NSK_CPP_STUB3(GetObjectMonitorUsage, jvmti, thread, &monitor_info)))\n+            jvmti->GetObjectMonitorUsage(thread, &monitor_info)))\n@@ -442,1 +429,1 @@\n-            NSK_CPP_STUB4(IsFieldSynthetic, jvmti, klass, field, &is_synthetic)))\n+            jvmti->IsFieldSynthetic(klass, field, &is_synthetic)))\n@@ -447,1 +434,1 @@\n-            NSK_CPP_STUB3(IsMethodSynthetic, jvmti, method, &is_synthetic)))\n+            jvmti->IsMethodSynthetic(method, &is_synthetic)))\n@@ -461,1 +448,1 @@\n-            NSK_CPP_STUB4(GetBytecodes, jvmti, method, &count, &bytecodes)))\n+            jvmti->GetBytecodes(method, &count, &bytecodes)))\n@@ -474,2 +461,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-            NSK_CPP_STUB2(GetCurrentThreadCpuTimerInfo, jvmti, &info)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->GetCurrentThreadCpuTimerInfo(&info)))\n@@ -479,2 +465,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-            NSK_CPP_STUB2(GetCurrentThreadCpuTime, jvmti, &nanos)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->GetCurrentThreadCpuTime(&nanos)))\n@@ -494,1 +479,1 @@\n-            NSK_CPP_STUB2(GetThreadCpuTimerInfo, jvmti, &info)))\n+            jvmti->GetThreadCpuTimerInfo(&info)))\n@@ -499,1 +484,1 @@\n-            NSK_CPP_STUB3(GetThreadCpuTime, jvmti, thread, &nanos)))\n+            jvmti->GetThreadCpuTime(thread, &nanos)))\n@@ -595,1 +580,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(GetPotentialCapabilities, jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->GetPotentialCapabilities(&caps)))\n@@ -607,1 +592,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(AddCapabilities, jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->AddCapabilities(&caps)))\n@@ -613,1 +598,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(GetCapabilities, jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->GetCapabilities(&caps)))\n@@ -625,1 +610,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(RelinquishCapabilities, jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->RelinquishCapabilities(&caps)))\n@@ -631,1 +616,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(GetCapabilities, jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->GetCapabilities(&caps)))\n@@ -643,1 +628,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(AddCapabilities, jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->AddCapabilities(&caps)))\n@@ -646,1 +631,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(GetCapabilities, jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->GetCapabilities(&caps)))\n","filename":"test\/hotspot\/jtreg\/vmTestbase\/nsk\/jvmti\/scenarios\/capability\/CM01\/cm01t020\/cm01t020.cpp","additions":63,"deletions":78,"binary":false,"changes":141,"status":"modified"},{"patch":"@@ -77,2 +77,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-           NSK_CPP_STUB3(GetAllThreads, jvmti, &threads_count, &threads)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->GetAllThreads(&threads_count, &threads)))\n@@ -90,2 +89,1 @@\n-        if (!NSK_JVMTI_VERIFY(\n-                NSK_CPP_STUB3(GetThreadInfo, jvmti, threads[i], &info)))\n+        if (!NSK_JVMTI_VERIFY(jvmti->GetThreadInfo(threads[i], &info)))\n@@ -103,2 +101,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-            NSK_CPP_STUB2(Deallocate, jvmti, (unsigned char*)threads)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->Deallocate((unsigned char*)threads)))\n@@ -108,2 +105,1 @@\n-    if (!NSK_JNI_VERIFY(jni, (klass =\n-            NSK_CPP_STUB2(GetObjectClass, jni, thread)) != NULL))\n+    if (!NSK_JNI_VERIFY(jni, (klass = jni->GetObjectClass(thread)) != NULL))\n@@ -113,2 +109,1 @@\n-    if (!NSK_JNI_VERIFY(jni, (method =\n-            NSK_CPP_STUB4(GetMethodID, jni, klass, \"run\", \"()V\")) != NULL))\n+    if (!NSK_JNI_VERIFY(jni, (method = jni->GetMethodID(klass, \"run\", \"()V\")) != NULL))\n@@ -119,2 +114,1 @@\n-            NSK_CPP_STUB4(GetFieldID, jni, klass,\n-                \"waitingMonitor\", \"Ljava\/lang\/Object;\")) != NULL))\n+            jni->GetFieldID(klass, \"waitingMonitor\", \"Ljava\/lang\/Object;\")) != NULL))\n@@ -134,2 +128,1 @@\n-    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY,\n-            NSK_CPP_STUB2(SuspendThread, jvmti, thread)))\n+    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY, jvmti->SuspendThread(thread)))\n@@ -139,2 +132,1 @@\n-    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY,\n-            NSK_CPP_STUB2(ResumeThread, jvmti, thread)))\n+    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY, jvmti->ResumeThread(thread)))\n@@ -145,1 +137,1 @@\n-            NSK_CPP_STUB4(SuspendThreadList, jvmti, 1, &thread, &err)))\n+            jvmti->SuspendThreadList(1, &thread, &err)))\n@@ -150,1 +142,1 @@\n-            NSK_CPP_STUB4(ResumeThreadList, jvmti, 1, &thread, &err)))\n+            jvmti->ResumeThreadList(1, &thread, &err)))\n@@ -166,2 +158,1 @@\n-    if (!NSK_JNI_VERIFY(jni, (cls =\n-            NSK_CPP_STUB2(FindClass, jni, THREAD_DEATH_CLASS_NAME)) != NULL))\n+    if (!NSK_JNI_VERIFY(jni, (cls = jni->FindClass(THREAD_DEATH_CLASS_NAME)) != NULL))\n@@ -171,2 +162,1 @@\n-            NSK_CPP_STUB4(GetMethodID, jni, cls,\n-                THREAD_DEATH_CTOR_NAME, THREAD_DEATH_CTOR_SIGNATURE)) != NULL))\n+            jni->GetMethodID(cls, THREAD_DEATH_CTOR_NAME, THREAD_DEATH_CTOR_SIGNATURE)) != NULL))\n@@ -175,2 +165,1 @@\n-    if (!NSK_JNI_VERIFY(jni, (exception =\n-            NSK_CPP_STUB3(NewObject, jni, cls, ctor)) != NULL))\n+    if (!NSK_JNI_VERIFY(jni, (exception = jni->NewObject(cls, ctor)) != NULL))\n@@ -181,1 +170,1 @@\n-            NSK_CPP_STUB3(StopThread, jvmti, thread, exception)))\n+            jvmti->StopThread(thread, exception)))\n@@ -185,2 +174,1 @@\n-    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY,\n-            NSK_CPP_STUB2(InterruptThread, jvmti, thread)))\n+    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY, jvmti->InterruptThread(thread)))\n@@ -200,1 +188,1 @@\n-            NSK_CPP_STUB4(GetOwnedMonitorInfo, jvmti, thread, &count, &monitors)))\n+            jvmti->GetOwnedMonitorInfo(thread, &count, &monitors)))\n@@ -213,1 +201,1 @@\n-            NSK_CPP_STUB3(GetCurrentContendedMonitor, jvmti, thread, &monitor)))\n+            jvmti->GetCurrentContendedMonitor(thread, &monitor)))\n@@ -223,2 +211,1 @@\n-    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY,\n-            NSK_CPP_STUB2(PopFrame, jvmti, thread)))\n+    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY, jvmti->PopFrame(thread)))\n@@ -268,1 +255,1 @@\n-            NSK_CPP_STUB3(SetTag, jvmti, thread, TAG_VALUE)))\n+            jvmti->SetTag(thread, TAG_VALUE)))\n@@ -272,2 +259,1 @@\n-    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY,\n-            NSK_CPP_STUB3(GetTag, jvmti, thread, &tag)))\n+    if (!NSK_JVMTI_VERIFY_CODE(JVMTI_ERROR_MUST_POSSESS_CAPABILITY, jvmti->GetTag(thread, &tag)))\n@@ -279,2 +265,1 @@\n-            NSK_CPP_STUB6(GetObjectsWithTags, jvmti, 1, &tag,\n-                &count, &res_objects, &res_tags)))\n+            jvmti->GetObjectsWithTags(1, &tag, &count, &res_objects, &res_tags)))\n@@ -285,2 +270,1 @@\n-            NSK_CPP_STUB4(IterateOverHeap, jvmti, JVMTI_HEAP_OBJECT_TAGGED,\n-                HeapObject, &dummy_user_data)))\n+            jvmti->IterateOverHeap(JVMTI_HEAP_OBJECT_TAGGED, HeapObject, &dummy_user_data)))\n@@ -291,2 +275,4 @@\n-            NSK_CPP_STUB5(IterateOverInstancesOfClass, jvmti, klass,\n-                JVMTI_HEAP_OBJECT_UNTAGGED, HeapObject, &dummy_user_data)))\n+            jvmti->IterateOverInstancesOfClass(klass,\n+                                               JVMTI_HEAP_OBJECT_UNTAGGED,\n+                                               HeapObject,\n+                                               &dummy_user_data)))\n@@ -297,2 +283,3 @@\n-            NSK_CPP_STUB4(IterateOverObjectsReachableFromObject, jvmti, thread,\n-                ObjectReference, &dummy_user_data)))\n+            jvmti->IterateOverObjectsReachableFromObject(thread,\n+                                                         ObjectReference,\n+                                                         &dummy_user_data)))\n@@ -303,2 +290,4 @@\n-            NSK_CPP_STUB5(IterateOverReachableObjects, jvmti,\n-                HeapRoot, StackReference, ObjectReference, &dummy_user_data)))\n+            jvmti->IterateOverReachableObjects(HeapRoot,\n+                                               StackReference,\n+                                               ObjectReference,\n+                                               &dummy_user_data)))\n@@ -323,2 +312,1 @@\n-            NSK_CPP_STUB4(GetLocalVariableTable, jvmti, method, &count,\n-                &local_variable_table)))\n+            jvmti->GetLocalVariableTable(method, &count, &local_variable_table)))\n@@ -329,1 +317,1 @@\n-            NSK_CPP_STUB5(GetLocalObject, jvmti, thread, 0, 0, &object_value)))\n+            jvmti->GetLocalObject(thread, 0, 0, &object_value)))\n@@ -334,1 +322,1 @@\n-            NSK_CPP_STUB5(GetLocalInt, jvmti, thread, 0, 0, &int_value)))\n+            jvmti->GetLocalInt(thread, 0, 0, &int_value)))\n@@ -339,1 +327,1 @@\n-            NSK_CPP_STUB5(GetLocalLong, jvmti, thread, 0, 0, &long_value)))\n+            jvmti->GetLocalLong(thread, 0, 0, &long_value)))\n@@ -344,1 +332,1 @@\n-            NSK_CPP_STUB5(GetLocalFloat, jvmti, thread, 0, 0, &float_value)))\n+            jvmti->GetLocalFloat(thread, 0, 0, &float_value)))\n@@ -349,1 +337,1 @@\n-            NSK_CPP_STUB5(GetLocalDouble, jvmti, thread, 0, 0, &double_value)))\n+            jvmti->GetLocalDouble(thread, 0, 0, &double_value)))\n@@ -354,1 +342,1 @@\n-            NSK_CPP_STUB5(SetLocalObject, jvmti, thread, 0, 0, thread)))\n+            jvmti->SetLocalObject(thread, 0, 0, thread)))\n@@ -359,1 +347,1 @@\n-            NSK_CPP_STUB5(SetLocalInt, jvmti, thread, 0, 0, (jint)0)))\n+            jvmti->SetLocalInt(thread, 0, 0, (jint)0)))\n@@ -364,1 +352,1 @@\n-            NSK_CPP_STUB5(SetLocalLong, jvmti, thread, 0, 0, (jlong)0)))\n+            jvmti->SetLocalLong(thread, 0, 0, (jlong)0)))\n@@ -369,1 +357,1 @@\n-            NSK_CPP_STUB5(SetLocalFloat, jvmti, thread, 0, 0, (jfloat)0.0)))\n+            jvmti->SetLocalFloat(thread, 0, 0, (jfloat)0.0)))\n@@ -374,1 +362,1 @@\n-            NSK_CPP_STUB5(SetLocalDouble, jvmti, thread, 0, 0, (jdouble)0.0)))\n+            jvmti->SetLocalDouble(thread, 0, 0, (jdouble)0.0)))\n@@ -389,1 +377,1 @@\n-            NSK_CPP_STUB3(GetSourceFileName, jvmti, klass, &name)))\n+            jvmti->GetSourceFileName(klass, &name)))\n@@ -394,1 +382,1 @@\n-            NSK_CPP_STUB3(GetSourceDebugExtension, jvmti, klass, &name)))\n+            jvmti->GetSourceDebugExtension(klass, &name)))\n@@ -399,2 +387,1 @@\n-            NSK_CPP_STUB4(GetLineNumberTable, jvmti, method, &count,\n-                &line_number_table)))\n+            jvmti->GetLineNumberTable(method, &count, &line_number_table)))\n@@ -416,1 +403,1 @@\n-            NSK_CPP_STUB3(RedefineClasses, jvmti, 1, &class_def)))\n+            jvmti->RedefineClasses(1, &class_def)))\n@@ -429,1 +416,1 @@\n-            NSK_CPP_STUB3(GetObjectMonitorUsage, jvmti, thread, &monitor_info)))\n+            jvmti->GetObjectMonitorUsage(thread, &monitor_info)))\n@@ -442,1 +429,1 @@\n-            NSK_CPP_STUB4(IsFieldSynthetic, jvmti, klass, field, &is_synthetic)))\n+            jvmti->IsFieldSynthetic(klass, field, &is_synthetic)))\n@@ -447,1 +434,1 @@\n-            NSK_CPP_STUB3(IsMethodSynthetic, jvmti, method, &is_synthetic)))\n+            jvmti->IsMethodSynthetic(method, &is_synthetic)))\n@@ -461,1 +448,1 @@\n-            NSK_CPP_STUB4(GetBytecodes, jvmti, method, &count, &bytecodes)))\n+            jvmti->GetBytecodes(method, &count, &bytecodes)))\n@@ -475,1 +462,1 @@\n-            NSK_CPP_STUB2(GetCurrentThreadCpuTimerInfo, jvmti, &info)))\n+            jvmti->GetCurrentThreadCpuTimerInfo(&info)))\n@@ -480,1 +467,1 @@\n-            NSK_CPP_STUB2(GetCurrentThreadCpuTime, jvmti, &nanos)))\n+            jvmti->GetCurrentThreadCpuTime(&nanos)))\n@@ -493,2 +480,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-            NSK_CPP_STUB2(GetThreadCpuTimerInfo, jvmti, &info)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->GetThreadCpuTimerInfo(&info)))\n@@ -498,2 +484,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-            NSK_CPP_STUB3(GetThreadCpuTime, jvmti, thread, &nanos)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->GetThreadCpuTime(thread, &nanos)))\n@@ -595,1 +580,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(GetPotentialCapabilities, jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->GetPotentialCapabilities(&caps)))\n@@ -607,1 +592,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(AddCapabilities, jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->AddCapabilities(&caps)))\n@@ -613,1 +598,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(GetCapabilities, jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->GetCapabilities(&caps)))\n@@ -625,1 +610,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(RelinquishCapabilities, jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->RelinquishCapabilities(&caps)))\n@@ -631,1 +616,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(GetCapabilities, jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->GetCapabilities(&caps)))\n@@ -643,1 +628,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(AddCapabilities, jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->AddCapabilities(&caps)))\n@@ -646,1 +631,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(GetCapabilities, jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->GetCapabilities(&caps)))\n","filename":"test\/hotspot\/jtreg\/vmTestbase\/nsk\/jvmti\/scenarios\/capability\/CM01\/cm01t021\/cm01t021.cpp","additions":63,"deletions":78,"binary":false,"changes":141,"status":"modified"},{"patch":"@@ -102,2 +102,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB5(GetMethodName,\n-            jvmti_env, method, &name, &signature, NULL))) {\n+    if (!NSK_JVMTI_VERIFY(jvmti_env->GetMethodName(method, &name, &signature, NULL))) {\n@@ -110,1 +109,1 @@\n-        NSK_CPP_STUB2(Deallocate, jvmti_env, (unsigned char*)name);\n+        jvmti_env->Deallocate((unsigned char*)name);\n@@ -112,1 +111,1 @@\n-        NSK_CPP_STUB2(Deallocate, jvmti_env, (unsigned char*)signature);\n+        jvmti_env->Deallocate((unsigned char*)signature);\n@@ -129,2 +128,2 @@\n-        NSK_CPP_STUB2(Deallocate, jvmti_env, (unsigned char*)name);\n-        NSK_CPP_STUB2(Deallocate, jvmti_env, (unsigned char*)sig);\n+        jvmti_env->Deallocate((unsigned char*)name);\n+        jvmti_env->Deallocate((unsigned char*)sig);\n@@ -142,2 +141,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB3(GetThreadInfo, jvmti_env,\n-            thread, &info))) {\n+    if (!NSK_JVMTI_VERIFY(jvmti_env->GetThreadInfo(thread, &info))) {\n@@ -159,2 +157,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB3(GetThreadInfo, jvmti_env,\n-            thread, &info))) {\n+    if (!NSK_JVMTI_VERIFY(jvmti_env->GetThreadInfo(thread, &info))) {\n@@ -176,2 +173,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB3(GetThreadInfo, jvmti_env,\n-            thread, &info))) {\n+    if (!NSK_JVMTI_VERIFY(jvmti_env->GetThreadInfo(thread, &info))) {\n@@ -193,2 +189,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB3(GetThreadInfo, jvmti_env,\n-            thread, &info))) {\n+    if (!NSK_JVMTI_VERIFY(jvmti_env->GetThreadInfo(thread, &info))) {\n@@ -210,2 +205,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB4(GetClassSignature, jvmti_env,\n-            object_klass, &signature, NULL))) {\n+    if (!NSK_JVMTI_VERIFY(jvmti_env->GetClassSignature(object_klass, &signature, NULL))) {\n@@ -217,1 +211,1 @@\n-        NSK_CPP_STUB2(Deallocate, jvmti_env, (unsigned char*)signature);\n+        jvmti_env->Deallocate((unsigned char*)signature);\n@@ -229,1 +223,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(GetPhase, jvmti_env, &phase))) {\n+    if (!NSK_JVMTI_VERIFY(jvmti_env->GetPhase(&phase))) {\n@@ -237,2 +231,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB5(GetMethodName,\n-            jvmti_env, method, &name, &signature, NULL))) {\n+    if (!NSK_JVMTI_VERIFY(jvmti_env->GetMethodName(method, &name, &signature, NULL))) {\n@@ -246,1 +239,1 @@\n-        NSK_CPP_STUB2(Deallocate, jvmti_env, (unsigned char*)name);\n+        jvmti_env->Deallocate((unsigned char*)name);\n@@ -248,1 +241,1 @@\n-        NSK_CPP_STUB2(Deallocate, jvmti_env, (unsigned char*)signature);\n+        jvmti_env->Deallocate((unsigned char*)signature);\n@@ -283,2 +276,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-           NSK_CPP_STUB3(GetAllThreads, jvmti, &threads_count, &threads)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->GetAllThreads(&threads_count, &threads)))\n@@ -296,2 +288,1 @@\n-        if (!NSK_JVMTI_VERIFY(\n-                NSK_CPP_STUB3(GetThreadInfo, jvmti, threads[i], &info)))\n+        if (!NSK_JVMTI_VERIFY(jvmti->GetThreadInfo(threads[i], &info)))\n@@ -308,2 +299,1 @@\n-    if (!NSK_JNI_VERIFY(jni, (thread =\n-            NSK_CPP_STUB2(NewGlobalRef, jni, thread)) != NULL))\n+    if (!NSK_JNI_VERIFY(jni, (thread = jni->NewGlobalRef(thread)) != NULL))\n@@ -313,2 +303,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-            NSK_CPP_STUB2(Deallocate, jvmti, (unsigned char*)threads)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->Deallocate((unsigned char*)threads)))\n@@ -318,2 +307,1 @@\n-    if (!NSK_JNI_VERIFY(jni, (klass =\n-            NSK_CPP_STUB2(GetObjectClass, jni, thread)) != NULL))\n+    if (!NSK_JNI_VERIFY(jni, (klass = jni->GetObjectClass(thread)) != NULL))\n@@ -333,1 +321,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(GetCapabilities, jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->GetCapabilities(&caps)))\n@@ -376,2 +364,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-            NSK_CPP_STUB4(GetOwnedMonitorInfo, jvmti, thread, &count, &monitors)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->GetOwnedMonitorInfo(thread, &count, &monitors)))\n@@ -389,2 +376,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-            NSK_CPP_STUB3(GetCurrentContendedMonitor, jvmti, thread, &monitor)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->GetCurrentContendedMonitor(thread, &monitor)))\n@@ -442,2 +428,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-            NSK_CPP_STUB3(SetTag, jvmti, thread, TAG_VALUE)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->SetTag(thread, TAG_VALUE)))\n@@ -447,2 +432,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-            NSK_CPP_STUB3(GetTag, jvmti, thread, &tag)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->GetTag(thread, &tag)))\n@@ -453,3 +437,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-            NSK_CPP_STUB6(GetObjectsWithTags, jvmti, 1, &tag,\n-                &count, &res_objects, &res_tags)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->GetObjectsWithTags(1, &tag, &count, &res_objects, &res_tags)))\n@@ -460,2 +442,1 @@\n-            NSK_CPP_STUB4(IterateOverHeap, jvmti, JVMTI_HEAP_OBJECT_TAGGED,\n-                HeapObject, &dummy_user_data)))\n+            jvmti->IterateOverHeap(JVMTI_HEAP_OBJECT_TAGGED, HeapObject, &dummy_user_data)))\n@@ -466,2 +447,4 @@\n-            NSK_CPP_STUB5(IterateOverInstancesOfClass, jvmti, klass,\n-                JVMTI_HEAP_OBJECT_UNTAGGED, HeapObject, &dummy_user_data)))\n+            jvmti->IterateOverInstancesOfClass(klass,\n+                                               JVMTI_HEAP_OBJECT_UNTAGGED,\n+                                               HeapObject,\n+                                               &dummy_user_data)))\n@@ -472,2 +455,3 @@\n-            NSK_CPP_STUB4(IterateOverObjectsReachableFromObject, jvmti, thread,\n-                ThreadObjectReference, &dummy_user_data)))\n+            jvmti->IterateOverObjectsReachableFromObject(thread,\n+                                                         ThreadObjectReference,\n+                                                         &dummy_user_data)))\n@@ -478,2 +462,4 @@\n-            NSK_CPP_STUB5(IterateOverReachableObjects, jvmti,\n-                HeapRoot, StackReference, ObjectReference, &dummy_user_data)))\n+            jvmti->IterateOverReachableObjects(HeapRoot,\n+                                               StackReference,\n+                                               ObjectReference,\n+                                               &dummy_user_data)))\n@@ -491,2 +477,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-            NSK_CPP_STUB3(GetObjectMonitorUsage, jvmti, thread, &monitor_info)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->GetObjectMonitorUsage(thread, &monitor_info)))\n@@ -505,2 +490,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-            NSK_CPP_STUB2(GetCurrentThreadCpuTimerInfo, jvmti, &info)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->GetCurrentThreadCpuTimerInfo(&info)))\n@@ -510,2 +494,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-            NSK_CPP_STUB2(GetCurrentThreadCpuTime, jvmti, &nanos)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->GetCurrentThreadCpuTime(&nanos)))\n@@ -524,2 +507,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-            NSK_CPP_STUB2(GetThreadCpuTimerInfo, jvmti, &info)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->GetThreadCpuTimerInfo(&info)))\n@@ -529,2 +511,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-            NSK_CPP_STUB3(GetThreadCpuTime, jvmti, thread, &nanos)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->GetThreadCpuTime(thread, &nanos)))\n@@ -644,1 +625,1 @@\n-    NSK_TRACE(NSK_CPP_STUB2(DeleteGlobalRef, jni, thread));\n+    NSK_TRACE(jni->DeleteGlobalRef(thread));\n@@ -709,1 +690,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(AddCapabilities, jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->AddCapabilities(&caps)))\n@@ -726,2 +707,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB3(SetEventCallbacks,\n-            jvmti, &callbacks, sizeof(callbacks))))\n+    if (!NSK_JVMTI_VERIFY(jvmti->SetEventCallbacks(&callbacks, sizeof(callbacks))))\n@@ -731,2 +711,2 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB4(SetEventNotificationMode,\n-            jvmti, JVMTI_ENABLE, JVMTI_EVENT_CLASS_FILE_LOAD_HOOK, NULL)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->SetEventNotificationMode(\n+            JVMTI_ENABLE, JVMTI_EVENT_CLASS_FILE_LOAD_HOOK, NULL)))\n@@ -734,2 +714,2 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB4(SetEventNotificationMode,\n-            jvmti, JVMTI_ENABLE, JVMTI_EVENT_COMPILED_METHOD_LOAD, NULL)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->SetEventNotificationMode(\n+            JVMTI_ENABLE, JVMTI_EVENT_COMPILED_METHOD_LOAD, NULL)))\n@@ -737,2 +717,2 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB4(SetEventNotificationMode,\n-            jvmti, JVMTI_ENABLE, JVMTI_EVENT_COMPILED_METHOD_UNLOAD, NULL)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->SetEventNotificationMode(\n+            JVMTI_ENABLE, JVMTI_EVENT_COMPILED_METHOD_UNLOAD, NULL)))\n@@ -740,2 +720,2 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB4(SetEventNotificationMode,\n-            jvmti, JVMTI_ENABLE, JVMTI_EVENT_MONITOR_CONTENDED_ENTER, NULL)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->SetEventNotificationMode(\n+            JVMTI_ENABLE, JVMTI_EVENT_MONITOR_CONTENDED_ENTER, NULL)))\n@@ -743,2 +723,2 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB4(SetEventNotificationMode,\n-            jvmti, JVMTI_ENABLE, JVMTI_EVENT_MONITOR_CONTENDED_ENTERED, NULL)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->SetEventNotificationMode(\n+            JVMTI_ENABLE, JVMTI_EVENT_MONITOR_CONTENDED_ENTERED, NULL)))\n@@ -746,2 +726,2 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB4(SetEventNotificationMode,\n-            jvmti, JVMTI_ENABLE, JVMTI_EVENT_MONITOR_WAIT, NULL)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->SetEventNotificationMode(\n+            JVMTI_ENABLE, JVMTI_EVENT_MONITOR_WAIT, NULL)))\n@@ -749,2 +729,2 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB4(SetEventNotificationMode,\n-            jvmti, JVMTI_ENABLE, JVMTI_EVENT_MONITOR_WAITED, NULL)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->SetEventNotificationMode(\n+            JVMTI_ENABLE, JVMTI_EVENT_MONITOR_WAITED, NULL)))\n@@ -752,2 +732,2 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB4(SetEventNotificationMode,\n-            jvmti, JVMTI_ENABLE, JVMTI_EVENT_VM_OBJECT_ALLOC, NULL)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->SetEventNotificationMode(\n+            JVMTI_ENABLE, JVMTI_EVENT_VM_OBJECT_ALLOC, NULL)))\n@@ -755,2 +735,2 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB4(SetEventNotificationMode,\n-            jvmti, JVMTI_ENABLE, JVMTI_EVENT_NATIVE_METHOD_BIND, NULL)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->SetEventNotificationMode(\n+            JVMTI_ENABLE, JVMTI_EVENT_NATIVE_METHOD_BIND, NULL)))\n@@ -758,2 +738,2 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB4(SetEventNotificationMode,\n-            jvmti, JVMTI_ENABLE, JVMTI_EVENT_GARBAGE_COLLECTION_START, NULL)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->SetEventNotificationMode(\n+            JVMTI_ENABLE, JVMTI_EVENT_GARBAGE_COLLECTION_START, NULL)))\n@@ -761,2 +741,2 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB4(SetEventNotificationMode,\n-            jvmti, JVMTI_ENABLE, JVMTI_EVENT_GARBAGE_COLLECTION_FINISH, NULL)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->SetEventNotificationMode(\n+            JVMTI_ENABLE, JVMTI_EVENT_GARBAGE_COLLECTION_FINISH, NULL)))\n@@ -764,2 +744,2 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB4(SetEventNotificationMode,\n-            jvmti, JVMTI_ENABLE, JVMTI_EVENT_OBJECT_FREE, NULL)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->SetEventNotificationMode(\n+            JVMTI_ENABLE, JVMTI_EVENT_OBJECT_FREE, NULL)))\n","filename":"test\/hotspot\/jtreg\/vmTestbase\/nsk\/jvmti\/scenarios\/capability\/CM02\/cm02t001\/cm02t001.cpp","additions":70,"deletions":90,"binary":false,"changes":160,"status":"modified"},{"patch":"@@ -98,2 +98,1 @@\n-        if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB3(Allocate,\n-                jvmti_env, class_data_len, &klass_bytes)))\n+        if (!NSK_JVMTI_VERIFY(jvmti_env->Allocate(class_data_len, &klass_bytes)))\n@@ -105,2 +104,3 @@\n-        NSK_JVMTI_VERIFY(NSK_CPP_STUB4(SetEventNotificationMode,\n-            jvmti_env, JVMTI_DISABLE, JVMTI_EVENT_CLASS_FILE_LOAD_HOOK, NULL));\n+        NSK_JVMTI_VERIFY(\n+            jvmti_env->SetEventNotificationMode(\n+                JVMTI_DISABLE, JVMTI_EVENT_CLASS_FILE_LOAD_HOOK, NULL));\n@@ -119,2 +119,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-           NSK_CPP_STUB3(ClearFieldAccessWatch, jvmti_env, klass, field)))\n+    if (!NSK_JVMTI_VERIFY(jvmti_env->ClearFieldAccessWatch(klass, field)))\n@@ -123,2 +122,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB6(GetFieldName,\n-            jvmti_env, field_klass, field, &name, &signature, NULL))) {\n+    if (!NSK_JVMTI_VERIFY(jvmti_env->GetFieldName(field_klass, field, &name, &signature, NULL))) {\n@@ -130,1 +128,1 @@\n-        NSK_CPP_STUB2(Deallocate, jvmti_env, (unsigned char*)name);\n+        jvmti_env->Deallocate((unsigned char*)name);\n@@ -132,1 +130,1 @@\n-        NSK_CPP_STUB2(Deallocate, jvmti_env, (unsigned char*)signature);\n+        jvmti_env->Deallocate((unsigned char*)signature);\n@@ -145,2 +143,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB6(GetFieldName,\n-            jvmti_env, field_klass, field, &name, &signature, NULL))) {\n+    if (!NSK_JVMTI_VERIFY(jvmti_env->GetFieldName(field_klass, field, &name, &signature, NULL))) {\n@@ -152,1 +149,1 @@\n-        NSK_CPP_STUB2(Deallocate, jvmti_env, (unsigned char*)name);\n+        jvmti_env->Deallocate((unsigned char*)name);\n@@ -154,1 +151,1 @@\n-        NSK_CPP_STUB2(Deallocate, jvmti_env, (unsigned char*)signature);\n+        jvmti_env->Deallocate((unsigned char*)signature);\n@@ -165,2 +162,3 @@\n-    NSK_JVMTI_VERIFY(NSK_CPP_STUB4(SetEventNotificationMode,\n-        jvmti_env, JVMTI_DISABLE, JVMTI_EVENT_SINGLE_STEP, NULL));\n+    NSK_JVMTI_VERIFY(\n+        jvmti_env->SetEventNotificationMode(\n+            JVMTI_DISABLE, JVMTI_EVENT_SINGLE_STEP, NULL));\n@@ -168,2 +166,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB5(GetMethodName,\n-            jvmti_env, method, &name, &signature, NULL))) {\n+    if (!NSK_JVMTI_VERIFY(jvmti_env->GetMethodName(method, &name, &signature, NULL))) {\n@@ -175,1 +172,1 @@\n-        NSK_CPP_STUB2(Deallocate, jvmti_env, (unsigned char*)name);\n+        jvmti_env->Deallocate((unsigned char*)name);\n@@ -177,1 +174,1 @@\n-        NSK_CPP_STUB2(Deallocate, jvmti_env, (unsigned char*)signature);\n+        jvmti_env->Deallocate((unsigned char*)signature);\n@@ -189,2 +186,1 @@\n-    if (!NSK_JNI_VERIFY(jni_env, (klass =\n-            NSK_CPP_STUB2(GetObjectClass, jni_env, exception)) != NULL)) {\n+    if (!NSK_JNI_VERIFY(jni_env, (klass = jni_env->GetObjectClass(exception)) != NULL)) {\n@@ -194,2 +190,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB4(GetClassSignature, jvmti_env,\n-            klass, &signature, NULL))) {\n+    if (!NSK_JVMTI_VERIFY(jvmti_env->GetClassSignature(klass, &signature, NULL))) {\n@@ -201,1 +196,1 @@\n-        NSK_CPP_STUB2(Deallocate, jvmti_env, (unsigned char*)signature);\n+        jvmti_env->Deallocate((unsigned char*)signature);\n@@ -212,2 +207,1 @@\n-    if (!NSK_JNI_VERIFY(jni_env, (klass =\n-            NSK_CPP_STUB2(GetObjectClass, jni_env, exception)) != NULL)) {\n+    if (!NSK_JNI_VERIFY(jni_env, (klass = jni_env->GetObjectClass(exception)) != NULL)) {\n@@ -217,2 +211,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB4(GetClassSignature, jvmti_env,\n-            klass, &signature, NULL))) {\n+    if (!NSK_JVMTI_VERIFY(jvmti_env->GetClassSignature(klass, &signature, NULL))) {\n@@ -224,1 +217,1 @@\n-        NSK_CPP_STUB2(Deallocate, jvmti_env, (unsigned char*)signature);\n+        jvmti_env->Deallocate((unsigned char*)signature);\n@@ -234,2 +227,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB5(GetMethodName,\n-            jvmti_env, method, &name, &signature, NULL))) {\n+    if (!NSK_JVMTI_VERIFY(jvmti_env->GetMethodName(method, &name, &signature, NULL))) {\n@@ -241,1 +233,1 @@\n-        NSK_CPP_STUB2(Deallocate, jvmti_env, (unsigned char*)name);\n+        jvmti_env->Deallocate((unsigned char*)name);\n@@ -243,1 +235,1 @@\n-        NSK_CPP_STUB2(Deallocate, jvmti_env, (unsigned char*)signature);\n+        jvmti_env->Deallocate((unsigned char*)signature);\n@@ -245,1 +237,1 @@\n-    NSK_CPP_STUB3(NotifyFramePop, jvmti_env, thread, 0);\n+    jvmti_env->NotifyFramePop(thread, 0);\n@@ -256,2 +248,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB5(GetMethodName,\n-            jvmti_env, method, &name, &signature, NULL))) {\n+    if (!NSK_JVMTI_VERIFY(jvmti_env->GetMethodName(method, &name, &signature, NULL))) {\n@@ -263,1 +254,1 @@\n-        NSK_CPP_STUB2(Deallocate, jvmti_env, (unsigned char*)name);\n+        jvmti_env->Deallocate((unsigned char*)name);\n@@ -265,1 +256,1 @@\n-        NSK_CPP_STUB2(Deallocate, jvmti_env, (unsigned char*)signature);\n+        jvmti_env->Deallocate((unsigned char*)signature);\n@@ -275,2 +266,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB5(GetMethodName,\n-            jvmti_env, method, &name, &signature, NULL))) {\n+    if (!NSK_JVMTI_VERIFY(jvmti_env->GetMethodName(method, &name, &signature, NULL))) {\n@@ -282,1 +272,1 @@\n-        NSK_CPP_STUB2(Deallocate, jvmti_env, (unsigned char*)name);\n+        jvmti_env->Deallocate((unsigned char*)name);\n@@ -284,1 +274,1 @@\n-        NSK_CPP_STUB2(Deallocate, jvmti_env, (unsigned char*)signature);\n+        jvmti_env->Deallocate((unsigned char*)signature);\n@@ -295,2 +285,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB5(GetMethodName,\n-            jvmti_env, method, &name, &signature, NULL))) {\n+    if (!NSK_JVMTI_VERIFY(jvmti_env->GetMethodName(method, &name, &signature, NULL))) {\n@@ -302,1 +291,1 @@\n-        NSK_CPP_STUB2(Deallocate, jvmti_env, (unsigned char*)name);\n+        jvmti_env->Deallocate((unsigned char*)name);\n@@ -304,1 +293,1 @@\n-        NSK_CPP_STUB2(Deallocate, jvmti_env, (unsigned char*)signature);\n+        jvmti_env->Deallocate((unsigned char*)signature);\n@@ -319,2 +308,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-           NSK_CPP_STUB3(GetAllThreads, jvmti, &threads_count, &threads)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->GetAllThreads(&threads_count, &threads)))\n@@ -332,2 +320,1 @@\n-        if (!NSK_JVMTI_VERIFY(\n-                NSK_CPP_STUB3(GetThreadInfo, jvmti, threads[i], &info)))\n+        if (!NSK_JVMTI_VERIFY(jvmti->GetThreadInfo(threads[i], &info)))\n@@ -344,2 +331,1 @@\n-    if (!NSK_JNI_VERIFY(jni, (thread =\n-            NSK_CPP_STUB2(NewGlobalRef, jni, thread)) != NULL))\n+    if (!NSK_JNI_VERIFY(jni, (thread = jni->NewGlobalRef(thread)) != NULL))\n@@ -349,2 +335,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-            NSK_CPP_STUB2(Deallocate, jvmti, (unsigned char*)threads)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->Deallocate((unsigned char*)threads)))\n@@ -354,2 +339,1 @@\n-    if (!NSK_JNI_VERIFY(jni, (klass =\n-            NSK_CPP_STUB2(GetObjectClass, jni, thread)) != NULL))\n+    if (!NSK_JNI_VERIFY(jni, (klass = jni->GetObjectClass(thread)) != NULL))\n@@ -359,2 +343,1 @@\n-    if (!NSK_JNI_VERIFY(jni, (method =\n-            NSK_CPP_STUB4(GetMethodID, jni, klass, \"delay\", \"()V\")) != NULL))\n+    if (!NSK_JNI_VERIFY(jni, (method = jni->GetMethodID(klass, \"delay\", \"()V\")) != NULL))\n@@ -364,2 +347,1 @@\n-    if (!NSK_JNI_VERIFY(jni, (field =\n-            NSK_CPP_STUB4(GetFieldID, jni, klass, \"waitingFlag\", \"Z\")) != NULL))\n+    if (!NSK_JNI_VERIFY(jni, (field = jni->GetFieldID(klass, \"waitingFlag\", \"Z\")) != NULL))\n@@ -375,2 +357,1 @@\n-    if (!NSK_JNI_VERIFY(jni, (method =\n-            NSK_CPP_STUB4(GetMethodID, jni, klass, \"letItGo\", \"()V\")) != NULL))\n+    if (!NSK_JNI_VERIFY(jni, (method = jni->GetMethodID(klass, \"letItGo\", \"()V\")) != NULL))\n@@ -380,2 +361,1 @@\n-    if (!NSK_JNI_VERIFY(jni, (field =\n-            NSK_CPP_STUB4(GetFieldID, jni, klass, \"waitingFlag\", \"Z\")) != NULL))\n+    if (!NSK_JNI_VERIFY(jni, (field = jni->GetFieldID(klass, \"waitingFlag\", \"Z\")) != NULL))\n@@ -384,2 +364,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-           NSK_CPP_STUB3(SetFieldAccessWatch, jvmti, klass, field)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->SetFieldAccessWatch(klass, field)))\n@@ -388,2 +367,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-           NSK_CPP_STUB3(SetFieldModificationWatch, jvmti, klass, field)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->SetFieldModificationWatch(klass, field)))\n@@ -392,1 +370,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB3(SetBreakpoint, jvmti, method, 0)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->SetBreakpoint(method, 0)))\n@@ -396,2 +374,2 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB4(SetEventNotificationMode,\n-            jvmti, JVMTI_ENABLE, JVMTI_EVENT_SINGLE_STEP, NULL)))\n+    if (!NSK_JVMTI_VERIFY(\n+            jvmti->SetEventNotificationMode(JVMTI_ENABLE, JVMTI_EVENT_SINGLE_STEP, NULL)))\n@@ -399,2 +377,2 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB4(SetEventNotificationMode,\n-            jvmti, JVMTI_ENABLE, JVMTI_EVENT_EXCEPTION, NULL)))\n+    if (!NSK_JVMTI_VERIFY(\n+            jvmti->SetEventNotificationMode(JVMTI_ENABLE, JVMTI_EVENT_EXCEPTION, NULL)))\n@@ -402,2 +380,2 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB4(SetEventNotificationMode,\n-            jvmti, JVMTI_ENABLE, JVMTI_EVENT_EXCEPTION_CATCH, NULL)))\n+    if (!NSK_JVMTI_VERIFY(\n+            jvmti->SetEventNotificationMode(JVMTI_ENABLE, JVMTI_EVENT_EXCEPTION_CATCH, NULL)))\n@@ -405,2 +383,2 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB4(SetEventNotificationMode,\n-            jvmti, JVMTI_ENABLE, JVMTI_EVENT_METHOD_ENTRY, thread)))\n+    if (!NSK_JVMTI_VERIFY(\n+            jvmti->SetEventNotificationMode(JVMTI_ENABLE, JVMTI_EVENT_METHOD_ENTRY, thread)))\n@@ -408,2 +386,2 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB4(SetEventNotificationMode,\n-            jvmti, JVMTI_ENABLE, JVMTI_EVENT_METHOD_EXIT, thread)))\n+    if (!NSK_JVMTI_VERIFY(\n+            jvmti->SetEventNotificationMode(JVMTI_ENABLE, JVMTI_EVENT_METHOD_EXIT, thread)))\n@@ -423,1 +401,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(GetCapabilities, jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->GetCapabilities(&caps)))\n@@ -474,2 +452,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-            NSK_CPP_STUB4(GetBytecodes, jvmti, method, &count, &bytecodes)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->GetBytecodes(method, &count, &bytecodes)))\n@@ -477,1 +454,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(Deallocate, jvmti, bytecodes)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->Deallocate(bytecodes)))\n@@ -489,2 +466,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-            NSK_CPP_STUB4(IsFieldSynthetic, jvmti, klass, field, &is_synthetic)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->IsFieldSynthetic(klass, field, &is_synthetic)))\n@@ -494,2 +470,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-            NSK_CPP_STUB3(IsMethodSynthetic, jvmti, method, &is_synthetic)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->IsMethodSynthetic(method, &is_synthetic)))\n@@ -514,1 +489,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB3(RedefineClasses, jvmti, 1, &class_def)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->RedefineClasses(1, &class_def)))\n@@ -518,2 +493,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-            NSK_CPP_STUB3(IsMethodObsolete, jvmti, method, &is_obsolete)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->IsMethodObsolete(method, &is_obsolete)))\n@@ -531,2 +505,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-            NSK_CPP_STUB3(GetSourceFileName, jvmti, klass, &name)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->GetSourceFileName(klass, &name)))\n@@ -545,3 +518,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-            NSK_CPP_STUB4(GetLineNumberTable, jvmti, method, &count,\n-                &line_number_table)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->GetLineNumberTable(method, &count, &line_number_table)))\n@@ -560,1 +531,1 @@\n-            NSK_CPP_STUB3(GetSourceDebugExtension, jvmti, klass, &name)))\n+            jvmti->GetSourceDebugExtension(klass, &name)))\n@@ -579,3 +550,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-            NSK_CPP_STUB4(GetLocalVariableTable, jvmti, method, &count,\n-                &local_variable_table)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->GetLocalVariableTable(method, &count, &local_variable_table)))\n@@ -586,1 +555,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(SuspendThread, jvmti, thread)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->SuspendThread(thread)))\n@@ -592,2 +561,2 @@\n-            if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB5(GetLocalObject, jvmti,\n-                    thread, 1, local_variable_table[i].slot, &object_value)))\n+            if (!NSK_JVMTI_VERIFY(\n+                    jvmti->GetLocalObject(thread, 1, local_variable_table[i].slot, &object_value)))\n@@ -597,2 +566,2 @@\n-            if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB5(SetLocalObject, jvmti,\n-                    thread, 1, local_variable_table[i].slot, object_value)))\n+            if (!NSK_JVMTI_VERIFY(\n+                    jvmti->SetLocalObject(thread, 1, local_variable_table[i].slot, object_value)))\n@@ -602,2 +571,2 @@\n-            if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB5(GetLocalInt, jvmti,\n-                    thread, 1, local_variable_table[i].slot, &int_value)))\n+            if (!NSK_JVMTI_VERIFY(\n+                    jvmti->GetLocalInt(thread, 1, local_variable_table[i].slot, &int_value)))\n@@ -607,2 +576,2 @@\n-            if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB5(SetLocalInt, jvmti,\n-                    thread, 1, local_variable_table[i].slot, int_value)))\n+            if (!NSK_JVMTI_VERIFY(\n+                    jvmti->SetLocalInt(thread, 1, local_variable_table[i].slot, int_value)))\n@@ -612,2 +581,2 @@\n-            if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB5(GetLocalLong, jvmti,\n-                    thread, 1, local_variable_table[i].slot, &long_value)))\n+            if (!NSK_JVMTI_VERIFY(\n+                    jvmti->GetLocalLong(thread, 1, local_variable_table[i].slot, &long_value)))\n@@ -617,2 +586,2 @@\n-            if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB5(SetLocalLong, jvmti,\n-                    thread, 1, local_variable_table[i].slot, long_value)))\n+            if (!NSK_JVMTI_VERIFY(\n+                    jvmti->SetLocalLong(thread, 1, local_variable_table[i].slot, long_value)))\n@@ -622,2 +591,2 @@\n-            if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB5(GetLocalFloat, jvmti,\n-                    thread, 1, local_variable_table[i].slot, &float_value)))\n+            if (!NSK_JVMTI_VERIFY(\n+                    jvmti->GetLocalFloat(thread, 1, local_variable_table[i].slot, &float_value)))\n@@ -627,2 +596,2 @@\n-            if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB5(SetLocalFloat, jvmti,\n-                    thread, 1, local_variable_table[i].slot, float_value)))\n+            if (!NSK_JVMTI_VERIFY(\n+                    jvmti->SetLocalFloat(thread, 1, local_variable_table[i].slot, float_value)))\n@@ -632,2 +601,2 @@\n-            if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB5(GetLocalDouble, jvmti,\n-                    thread, 1, local_variable_table[i].slot, &double_value)))\n+            if (!NSK_JVMTI_VERIFY(\n+                    jvmti->GetLocalDouble(thread, 1, local_variable_table[i].slot, &double_value)))\n@@ -637,2 +606,2 @@\n-            if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB5(SetLocalDouble, jvmti,\n-                    thread, 1, local_variable_table[i].slot, double_value)))\n+            if (!NSK_JVMTI_VERIFY(\n+                    jvmti->SetLocalDouble(thread, 1, local_variable_table[i].slot, double_value)))\n@@ -645,1 +614,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(ResumeThread, jvmti, thread)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->ResumeThread(thread)))\n@@ -648,2 +617,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(Deallocate, jvmti,\n-            (unsigned char*)local_variable_table)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->Deallocate((unsigned char*)local_variable_table)))\n@@ -661,1 +629,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(SuspendThread, jvmti, thread)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->SuspendThread(thread)))\n@@ -665,1 +633,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(ResumeThread, jvmti, thread)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->ResumeThread(thread)))\n@@ -669,2 +637,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-            NSK_CPP_STUB4(SuspendThreadList, jvmti, 1, &thread, &err)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->SuspendThreadList(1, &thread, &err)))\n@@ -674,2 +641,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-            NSK_CPP_STUB4(ResumeThreadList, jvmti, 1, &thread, &err)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->ResumeThreadList(1, &thread, &err)))\n@@ -688,1 +654,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(SuspendThread, jvmti, thread)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->SuspendThread(thread)))\n@@ -695,1 +661,1 @@\n-    err = NSK_CPP_STUB2(PopFrame, jvmti, thread);\n+    err = jvmti->PopFrame(thread);\n@@ -701,1 +667,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(ResumeThread, jvmti, thread)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->ResumeThread(thread)))\n@@ -717,2 +683,1 @@\n-    if (!NSK_JNI_VERIFY(jni, (cls =\n-            NSK_CPP_STUB2(FindClass, jni, THREAD_DEATH_CLASS_NAME)) != NULL))\n+    if (!NSK_JNI_VERIFY(jni, (cls = jni->FindClass(THREAD_DEATH_CLASS_NAME)) != NULL))\n@@ -722,2 +687,1 @@\n-            NSK_CPP_STUB4(GetMethodID, jni, cls,\n-                THREAD_DEATH_CTOR_NAME, THREAD_DEATH_CTOR_SIGNATURE)) != NULL))\n+            jni->GetMethodID(cls, THREAD_DEATH_CTOR_NAME, THREAD_DEATH_CTOR_SIGNATURE)) != NULL))\n@@ -726,2 +690,1 @@\n-    if (!NSK_JNI_VERIFY(jni, (exception =\n-            NSK_CPP_STUB3(NewObject, jni, cls, ctor)) != NULL))\n+    if (!NSK_JNI_VERIFY(jni, (exception = jni->NewObject(cls, ctor)) != NULL))\n@@ -731,1 +694,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(InterruptThread, jvmti, thread)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->InterruptThread(thread)))\n@@ -735,1 +698,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB3(StopThread, jvmti, thread, exception)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->StopThread(thread, exception)))\n@@ -850,1 +813,1 @@\n-    NSK_TRACE(NSK_CPP_STUB2(DeleteGlobalRef, jni, thread));\n+    NSK_TRACE(jni->DeleteGlobalRef(thread));\n@@ -919,1 +882,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(AddCapabilities, jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->AddCapabilities(&caps)))\n@@ -934,2 +897,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB3(SetEventCallbacks,\n-            jvmti, &callbacks, sizeof(callbacks))))\n+    if (!NSK_JVMTI_VERIFY(jvmti->SetEventCallbacks(&callbacks, sizeof(callbacks))))\n@@ -939,2 +901,2 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB4(SetEventNotificationMode,\n-            jvmti, JVMTI_ENABLE, JVMTI_EVENT_CLASS_FILE_LOAD_HOOK, NULL)))\n+    if (!NSK_JVMTI_VERIFY(\n+            jvmti->SetEventNotificationMode(JVMTI_ENABLE, JVMTI_EVENT_CLASS_FILE_LOAD_HOOK, NULL)))\n@@ -942,2 +904,2 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB4(SetEventNotificationMode,\n-            jvmti, JVMTI_ENABLE, JVMTI_EVENT_FIELD_ACCESS, NULL)))\n+    if (!NSK_JVMTI_VERIFY(\n+            jvmti->SetEventNotificationMode(JVMTI_ENABLE, JVMTI_EVENT_FIELD_ACCESS, NULL)))\n@@ -945,2 +907,2 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB4(SetEventNotificationMode,\n-            jvmti, JVMTI_ENABLE, JVMTI_EVENT_FIELD_MODIFICATION, NULL)))\n+    if (!NSK_JVMTI_VERIFY(\n+            jvmti->SetEventNotificationMode(JVMTI_ENABLE, JVMTI_EVENT_FIELD_MODIFICATION, NULL)))\n@@ -948,2 +910,2 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB4(SetEventNotificationMode,\n-            jvmti, JVMTI_ENABLE, JVMTI_EVENT_BREAKPOINT, NULL)))\n+    if (!NSK_JVMTI_VERIFY(\n+            jvmti->SetEventNotificationMode(JVMTI_ENABLE, JVMTI_EVENT_BREAKPOINT, NULL)))\n@@ -951,2 +913,2 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB4(SetEventNotificationMode,\n-            jvmti, JVMTI_ENABLE, JVMTI_EVENT_FRAME_POP, NULL)))\n+    if (!NSK_JVMTI_VERIFY(\n+            jvmti->SetEventNotificationMode(JVMTI_ENABLE, JVMTI_EVENT_FRAME_POP, NULL)))\n","filename":"test\/hotspot\/jtreg\/vmTestbase\/nsk\/jvmti\/scenarios\/capability\/CM03\/cm03t001\/cm03t001.cpp","additions":117,"deletions":155,"binary":false,"changes":272,"status":"modified"},{"patch":"@@ -57,2 +57,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-           NSK_CPP_STUB3(GetAllThreads, jvmti, &threads_count, &threads)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->GetAllThreads(&threads_count, &threads)))\n@@ -70,2 +69,1 @@\n-        if (!NSK_JVMTI_VERIFY(\n-                NSK_CPP_STUB3(GetThreadInfo, jvmti, threads[i], &info)))\n+        if (!NSK_JVMTI_VERIFY(jvmti->GetThreadInfo(threads[i], &info)))\n@@ -82,2 +80,1 @@\n-            if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(\n-                    Deallocate, jvmti, (unsigned char*)info.name)))\n+            if (!NSK_JVMTI_VERIFY(jvmti->Deallocate((unsigned char*)info.name)))\n@@ -89,2 +86,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-            NSK_CPP_STUB2(Deallocate, jvmti, (unsigned char*)threads)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->Deallocate((unsigned char*)threads)))\n@@ -94,2 +90,1 @@\n-    if (!NSK_JNI_VERIFY(jni, (klass =\n-            NSK_CPP_STUB2(GetObjectClass, jni, thread)) != NULL))\n+    if (!NSK_JNI_VERIFY(jni, (klass = jni->GetObjectClass(thread)) != NULL))\n@@ -99,2 +94,1 @@\n-    if (!NSK_JNI_VERIFY(jni, (field =\n-            NSK_CPP_STUB4(GetFieldID, jni, klass, \"M1\", FIELD_SIG)) != NULL))\n+    if (!NSK_JNI_VERIFY(jni, (field = jni->GetFieldID(klass, \"M1\", FIELD_SIG)) != NULL))\n@@ -103,2 +97,1 @@\n-    if (!NSK_JNI_VERIFY(jni, (object_M1 =\n-            NSK_CPP_STUB3(GetObjectField, jni, thread, field)) != NULL))\n+    if (!NSK_JNI_VERIFY(jni, (object_M1 = jni->GetObjectField(thread, field)) != NULL))\n@@ -108,2 +101,1 @@\n-    if (!NSK_JNI_VERIFY(jni, (field =\n-            NSK_CPP_STUB4(GetFieldID, jni, klass, \"M2\", FIELD_SIG)) != NULL))\n+    if (!NSK_JNI_VERIFY(jni, (field = jni->GetFieldID(klass, \"M2\", FIELD_SIG)) != NULL))\n@@ -112,2 +104,1 @@\n-    if (!NSK_JNI_VERIFY(jni, (object_M2 =\n-            NSK_CPP_STUB3(GetObjectField, jni, thread, field)) != NULL))\n+    if (!NSK_JNI_VERIFY(jni, (object_M2 = jni->GetObjectField(thread, field)) != NULL))\n@@ -129,2 +120,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB3(\n-            GetObjectMonitorUsage, jvmti, object, &inf)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->GetObjectMonitorUsage(object, &inf)))\n@@ -137,2 +127,1 @@\n-            if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB3(\n-                    GetThreadInfo, jvmti, inf.owner, &tinf))) {\n+            if (!NSK_JVMTI_VERIFY(jvmti->GetThreadInfo(inf.owner, &tinf))) {\n@@ -143,2 +132,1 @@\n-                    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(\n-                            Deallocate, jvmti, (unsigned char*)tinf.name)))\n+                    if (!NSK_JVMTI_VERIFY(jvmti->Deallocate((unsigned char*)tinf.name)))\n@@ -155,2 +143,1 @@\n-                if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB3(\n-                        GetThreadInfo, jvmti, inf.waiters[i], &tinf))) {\n+                if (!NSK_JVMTI_VERIFY(jvmti->GetThreadInfo(inf.waiters[i], &tinf))) {\n@@ -162,2 +149,1 @@\n-                        if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(\n-                                Deallocate, jvmti, (unsigned char*)tinf.name)))\n+                        if (!NSK_JVMTI_VERIFY(jvmti->Deallocate((unsigned char*)tinf.name)))\n@@ -174,2 +160,1 @@\n-                if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB3(\n-                        GetThreadInfo, jvmti, inf.notify_waiters[i], &tinf))) {\n+                if (!NSK_JVMTI_VERIFY(jvmti->GetThreadInfo(inf.notify_waiters[i], &tinf))) {\n@@ -181,2 +166,1 @@\n-                        if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(\n-                                Deallocate, jvmti, (unsigned char*)tinf.name)))\n+                        if (!NSK_JVMTI_VERIFY(jvmti->Deallocate((unsigned char*)tinf.name)))\n@@ -191,2 +175,1 @@\n-    if (!NSK_JNI_VERIFY(jni, (NSK_CPP_STUB3(\n-            IsSameObject, jni, inf.owner, thread)) == JNI_TRUE))\n+    if (!NSK_JNI_VERIFY(jni, (jni->IsSameObject(inf.owner, thread)) == JNI_TRUE))\n@@ -206,2 +189,1 @@\n-        if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(\n-                Deallocate, jvmti, (unsigned char*)inf.waiters)))\n+        if (!NSK_JVMTI_VERIFY(jvmti->Deallocate((unsigned char*)inf.waiters)))\n@@ -211,2 +193,1 @@\n-        if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(\n-                Deallocate, jvmti, (unsigned char*)inf.notify_waiters)))\n+        if (!NSK_JVMTI_VERIFY(jvmti->Deallocate((unsigned char*)inf.notify_waiters)))\n@@ -282,1 +263,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(AddCapabilities, jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->AddCapabilities(&caps)))\n","filename":"test\/hotspot\/jtreg\/vmTestbase\/nsk\/jvmti\/scenarios\/contention\/TC01\/tc01t001\/tc01t001.cpp","additions":20,"deletions":39,"binary":false,"changes":59,"status":"modified"},{"patch":"@@ -55,2 +55,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB5(\n-            GetFrameLocation, jvmti, thread, 0, &method, &location)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->GetFrameLocation(thread, 0, &method, &location)))\n@@ -65,2 +64,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB4(\n-            GetLineNumberTable, jvmti, method, &count, &table)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->GetLineNumberTable(method, &count, &table)))\n@@ -84,2 +82,1 @@\n-        if (!NSK_JVMTI_VERIFY(\n-                NSK_CPP_STUB2(Deallocate, jvmti, (unsigned char*)table)))\n+        if (!NSK_JVMTI_VERIFY(jvmti->Deallocate((unsigned char*)table)))\n@@ -111,2 +108,2 @@\n-    if (NSK_CPP_STUB3(IsSameObject, jni, thread, thr) &&\n-            NSK_CPP_STUB3(IsSameObject, jni, object_M, obj)) {\n+    if (jni->IsSameObject(thread, thr) &&\n+            jni->IsSameObject(object_M, obj)) {\n@@ -155,2 +152,2 @@\n-    if (NSK_CPP_STUB3(IsSameObject, jni, thread, thr) &&\n-            NSK_CPP_STUB3(IsSameObject, jni, object_M, obj)) {\n+    if (jni->IsSameObject(thread, thr) &&\n+            jni->IsSameObject(object_M, obj)) {\n@@ -197,2 +194,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-           NSK_CPP_STUB3(GetAllThreads, jvmti, &threads_count, &threads)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->GetAllThreads(&threads_count, &threads)))\n@@ -210,2 +206,1 @@\n-        if (!NSK_JVMTI_VERIFY(\n-                NSK_CPP_STUB3(GetThreadInfo, jvmti, threads[i], &info)))\n+        if (!NSK_JVMTI_VERIFY(jvmti->GetThreadInfo(threads[i], &info)))\n@@ -222,2 +217,1 @@\n-            if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(\n-                    Deallocate, jvmti, (unsigned char*)info.name)))\n+            if (!NSK_JVMTI_VERIFY(jvmti->Deallocate((unsigned char*)info.name)))\n@@ -229,2 +223,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-            NSK_CPP_STUB2(Deallocate, jvmti, (unsigned char*)threads)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->Deallocate((unsigned char*)threads)))\n@@ -239,2 +232,1 @@\n-    if (!NSK_JNI_VERIFY(jni, (thread =\n-            NSK_CPP_STUB2(NewGlobalRef, jni, thread)) != NULL))\n+    if (!NSK_JNI_VERIFY(jni, (thread = jni->NewGlobalRef(thread)) != NULL))\n@@ -244,2 +236,1 @@\n-    if (!NSK_JNI_VERIFY(jni, (klass =\n-            NSK_CPP_STUB2(GetObjectClass, jni, thread)) != NULL))\n+    if (!NSK_JNI_VERIFY(jni, (klass = jni->GetObjectClass(thread)) != NULL))\n@@ -249,2 +240,1 @@\n-    if (!NSK_JNI_VERIFY(jni, (field =\n-            NSK_CPP_STUB4(GetFieldID, jni, klass, \"M\", FIELD_SIG)) != NULL))\n+    if (!NSK_JNI_VERIFY(jni, (field = jni->GetFieldID(klass, \"M\", FIELD_SIG)) != NULL))\n@@ -253,2 +243,1 @@\n-    if (!NSK_JNI_VERIFY(jni, (object_M =\n-            NSK_CPP_STUB3(GetObjectField, jni, thread, field)) != NULL))\n+    if (!NSK_JNI_VERIFY(jni, (object_M = jni->GetObjectField(thread, field)) != NULL))\n@@ -258,2 +247,1 @@\n-    if (!NSK_JNI_VERIFY(jni, (object_M =\n-            NSK_CPP_STUB2(NewGlobalRef, jni, object_M)) != NULL))\n+    if (!NSK_JNI_VERIFY(jni, (object_M = jni->NewGlobalRef(object_M)) != NULL))\n@@ -264,2 +252,2 @@\n-            NSK_CPP_STUB4(SetEventNotificationMode, jvmti, JVMTI_ENABLE,\n-                JVMTI_EVENT_MONITOR_CONTENDED_ENTER, NULL)))\n+            jvmti->SetEventNotificationMode(\n+                JVMTI_ENABLE, JVMTI_EVENT_MONITOR_CONTENDED_ENTER, NULL)))\n@@ -270,2 +258,2 @@\n-            NSK_CPP_STUB4(SetEventNotificationMode, jvmti, JVMTI_ENABLE,\n-                JVMTI_EVENT_MONITOR_CONTENDED_ENTERED, NULL)))\n+            jvmti->SetEventNotificationMode(\n+                JVMTI_ENABLE, JVMTI_EVENT_MONITOR_CONTENDED_ENTERED, NULL)))\n@@ -281,2 +269,2 @@\n-            NSK_CPP_STUB4(SetEventNotificationMode, jvmti, JVMTI_DISABLE,\n-                JVMTI_EVENT_MONITOR_CONTENDED_ENTERED, NULL)))\n+            jvmti->SetEventNotificationMode(\n+                JVMTI_DISABLE, JVMTI_EVENT_MONITOR_CONTENDED_ENTERED, NULL)))\n@@ -367,1 +355,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(AddCapabilities, jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->AddCapabilities(&caps)))\n@@ -373,3 +361,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-            NSK_CPP_STUB3(SetEventCallbacks, jvmti,\n-                &callbacks, sizeof(callbacks))))\n+    if (!NSK_JVMTI_VERIFY(jvmti->SetEventCallbacks(&callbacks, sizeof(callbacks))))\n","filename":"test\/hotspot\/jtreg\/vmTestbase\/nsk\/jvmti\/scenarios\/contention\/TC02\/tc02t001\/tc02t001.cpp","additions":24,"deletions":38,"binary":false,"changes":62,"status":"modified"},{"patch":"@@ -60,2 +60,2 @@\n-        if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB3(GetCurrentContendedMonitor,\n-                jvmti, threadList[pThread].thread, &monitor)))\n+        if (!NSK_JVMTI_VERIFY(\n+                jvmti->GetCurrentContendedMonitor(threadList[pThread].thread, &monitor)))\n@@ -64,2 +64,1 @@\n-            if (!NSK_JNI_VERIFY(jni, (klass =\n-                    NSK_CPP_STUB2(GetObjectClass, jni, monitor)) != NULL))\n+            if (!NSK_JNI_VERIFY(jni, (klass = jni->GetObjectClass(monitor)) != NULL))\n@@ -67,2 +66,1 @@\n-            if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB4(\n-                    GetClassSignature, jvmti, klass, &name, NULL)))\n+            if (!NSK_JVMTI_VERIFY(jvmti->GetClassSignature(klass, &name, NULL)))\n@@ -71,1 +69,1 @@\n-            NSK_CPP_STUB2(Deallocate, jvmti, (unsigned char*)name);\n+            jvmti->Deallocate((unsigned char*)name);\n@@ -75,2 +73,1 @@\n-        if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB3(GetObjectMonitorUsage,\n-                jvmti, monitor, &usageInfo)))\n+        if (!NSK_JVMTI_VERIFY(jvmti->GetObjectMonitorUsage(monitor, &usageInfo)))\n@@ -81,2 +78,1 @@\n-            if (NSK_CPP_STUB3(IsSameObject, jni,\n-                    threadList[cThread].thread, usageInfo.owner))\n+            if (jni->IsSameObject(threadList[cThread].thread, usageInfo.owner))\n@@ -86,2 +82,1 @@\n-            NSK_CPP_STUB2(Deallocate, jvmti,\n-                    (unsigned char*)usageInfo.waiters);\n+            jvmti->Deallocate((unsigned char*)usageInfo.waiters);\n@@ -90,2 +85,1 @@\n-            NSK_CPP_STUB2(Deallocate, jvmti,\n-                    (unsigned char*)usageInfo.notify_waiters);\n+            jvmti->Deallocate((unsigned char*)usageInfo.notify_waiters);\n@@ -116,2 +110,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-           NSK_CPP_STUB3(GetAllThreads, jvmti, &threads_count, &threads)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->GetAllThreads(&threads_count, &threads)))\n@@ -123,2 +116,2 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB3(Allocate, jvmti,\n-            threads_count*sizeof(threadDesc), (unsigned char**)&threadList)))\n+    if (!NSK_JVMTI_VERIFY(\n+            jvmti->Allocate(threads_count*sizeof(threadDesc), (unsigned char**)&threadList)))\n@@ -132,2 +125,1 @@\n-        if (!NSK_JVMTI_VERIFY(\n-                NSK_CPP_STUB3(GetThreadInfo, jvmti, threads[i], &info)))\n+        if (!NSK_JVMTI_VERIFY(jvmti->GetThreadInfo(threads[i], &info)))\n@@ -144,2 +136,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-            NSK_CPP_STUB2(Deallocate, jvmti, (unsigned char*)threads)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->Deallocate((unsigned char*)threads)))\n@@ -153,2 +144,2 @@\n-                if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB3(GetCurrentContendedMonitor,\n-                        jvmti, threadList[pThread].thread, &monitor)))\n+                if (!NSK_JVMTI_VERIFY(\n+                        jvmti->GetCurrentContendedMonitor(threadList[pThread].thread, &monitor)))\n@@ -158,2 +149,1 @@\n-                if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB3(GetObjectMonitorUsage,\n-                        jvmti, monitor, &usageInfo)))\n+                if (!NSK_JVMTI_VERIFY(jvmti->GetObjectMonitorUsage(monitor, &usageInfo)))\n@@ -164,2 +154,1 @@\n-                    if (NSK_CPP_STUB3(IsSameObject, jni,\n-                            threadList[cThread].thread, usageInfo.owner))\n+                    if (jni->IsSameObject(threadList[cThread].thread, usageInfo.owner))\n@@ -169,2 +158,1 @@\n-                    NSK_CPP_STUB2(Deallocate, jvmti,\n-                            (unsigned char*)usageInfo.waiters);\n+                    jvmti->Deallocate((unsigned char*)usageInfo.waiters);\n@@ -173,2 +161,1 @@\n-                    NSK_CPP_STUB2(Deallocate, jvmti,\n-                            (unsigned char*)usageInfo.notify_waiters);\n+                    jvmti->Deallocate((unsigned char*)usageInfo.notify_waiters);\n@@ -197,2 +184,1 @@\n-            if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(\n-                    Deallocate, jvmti, (unsigned char*)threadList[i].name)))\n+            if (!NSK_JVMTI_VERIFY(jvmti->Deallocate((unsigned char*)threadList[i].name)))\n@@ -264,1 +250,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(AddCapabilities, jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->AddCapabilities(&caps)))\n","filename":"test\/hotspot\/jtreg\/vmTestbase\/nsk\/jvmti\/scenarios\/contention\/TC03\/tc03t001\/tc03t001.cpp","additions":22,"deletions":36,"binary":false,"changes":58,"status":"modified"},{"patch":"@@ -60,2 +60,2 @@\n-        if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB3(GetCurrentContendedMonitor,\n-                jvmti, threadList[pThread].thread, &monitor)))\n+        if (!NSK_JVMTI_VERIFY(\n+                jvmti->GetCurrentContendedMonitor(threadList[pThread].thread, &monitor)))\n@@ -64,2 +64,1 @@\n-            if (!NSK_JNI_VERIFY(jni, (klass =\n-                    NSK_CPP_STUB2(GetObjectClass, jni, monitor)) != NULL))\n+            if (!NSK_JNI_VERIFY(jni, (klass = jni->GetObjectClass(monitor)) != NULL))\n@@ -67,2 +66,1 @@\n-            if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB4(\n-                    GetClassSignature, jvmti, klass, &name, NULL)))\n+            if (!NSK_JVMTI_VERIFY(jvmti->GetClassSignature(klass, &name, NULL)))\n@@ -71,1 +69,1 @@\n-            NSK_CPP_STUB2(Deallocate, jvmti, (unsigned char*)name);\n+            jvmti->Deallocate((unsigned char*)name);\n@@ -75,2 +73,1 @@\n-        if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB3(GetObjectMonitorUsage,\n-                jvmti, monitor, &usageInfo)))\n+        if (!NSK_JVMTI_VERIFY(jvmti->GetObjectMonitorUsage(monitor, &usageInfo)))\n@@ -81,2 +78,1 @@\n-            if (NSK_CPP_STUB3(IsSameObject, jni,\n-                    threadList[cThread].thread, usageInfo.owner))\n+            if (jni->IsSameObject(threadList[cThread].thread, usageInfo.owner))\n@@ -86,2 +82,1 @@\n-            NSK_CPP_STUB2(Deallocate, jvmti,\n-                    (unsigned char*)usageInfo.waiters);\n+            jvmti->Deallocate((unsigned char*)usageInfo.waiters);\n@@ -90,2 +85,1 @@\n-            NSK_CPP_STUB2(Deallocate, jvmti,\n-                    (unsigned char*)usageInfo.notify_waiters);\n+            jvmti->Deallocate((unsigned char*)usageInfo.notify_waiters);\n@@ -116,2 +110,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-           NSK_CPP_STUB3(GetAllThreads, jvmti, &threads_count, &threads)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->GetAllThreads(&threads_count, &threads)))\n@@ -123,2 +116,2 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB3(Allocate, jvmti,\n-            threads_count*sizeof(threadDesc), (unsigned char**)&threadList)))\n+    if (!NSK_JVMTI_VERIFY(\n+            jvmti->Allocate(threads_count*sizeof(threadDesc), (unsigned char**)&threadList)))\n@@ -132,2 +125,1 @@\n-        if (!NSK_JVMTI_VERIFY(\n-                NSK_CPP_STUB3(GetThreadInfo, jvmti, threads[i], &info)))\n+        if (!NSK_JVMTI_VERIFY(jvmti->GetThreadInfo(threads[i], &info)))\n@@ -144,2 +136,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-            NSK_CPP_STUB2(Deallocate, jvmti, (unsigned char*)threads)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->Deallocate((unsigned char*)threads)))\n@@ -153,2 +144,2 @@\n-                if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB3(GetCurrentContendedMonitor,\n-                        jvmti, threadList[pThread].thread, &monitor)))\n+                if (!NSK_JVMTI_VERIFY(\n+                        jvmti->GetCurrentContendedMonitor(threadList[pThread].thread, &monitor)))\n@@ -158,2 +149,1 @@\n-                if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB3(GetObjectMonitorUsage,\n-                        jvmti, monitor, &usageInfo)))\n+                if (!NSK_JVMTI_VERIFY(jvmti->GetObjectMonitorUsage(monitor, &usageInfo)))\n@@ -164,2 +154,1 @@\n-                    if (NSK_CPP_STUB3(IsSameObject, jni,\n-                            threadList[cThread].thread, usageInfo.owner))\n+                    if (jni->IsSameObject(threadList[cThread].thread, usageInfo.owner))\n@@ -169,2 +158,1 @@\n-                    NSK_CPP_STUB2(Deallocate, jvmti,\n-                            (unsigned char*)usageInfo.waiters);\n+                    jvmti->Deallocate((unsigned char*)usageInfo.waiters);\n@@ -173,2 +161,1 @@\n-                    NSK_CPP_STUB2(Deallocate, jvmti,\n-                            (unsigned char*)usageInfo.notify_waiters);\n+                    jvmti->Deallocate((unsigned char*)usageInfo.notify_waiters);\n@@ -197,2 +184,1 @@\n-            if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(\n-                    Deallocate, jvmti, (unsigned char*)threadList[i].name)))\n+            if (!NSK_JVMTI_VERIFY(jvmti->Deallocate((unsigned char*)threadList[i].name)))\n@@ -264,1 +250,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(AddCapabilities, jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->AddCapabilities(&caps)))\n","filename":"test\/hotspot\/jtreg\/vmTestbase\/nsk\/jvmti\/scenarios\/contention\/TC03\/tc03t002\/tc03t002.cpp","additions":22,"deletions":36,"binary":false,"changes":58,"status":"modified"},{"patch":"@@ -47,1 +47,1 @@\n-    jboolean status = NSK_JVMTI_VERIFY(NSK_CPP_STUB2(RawMonitorEnter, jvmti, syncLock));\n+    jboolean status = NSK_JVMTI_VERIFY(jvmti->RawMonitorEnter(syncLock));\n@@ -54,1 +54,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(RawMonitorExit, jvmti, syncLock)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->RawMonitorExit(syncLock)))\n@@ -76,1 +76,1 @@\n-    if (NSK_CPP_STUB3(IsInstanceOf, jni, obj, object_M)) {\n+    if (jni->IsInstanceOf(obj, object_M)) {\n@@ -99,1 +99,1 @@\n-    if (NSK_CPP_STUB3(IsInstanceOf, jni, obj, object_M)) {\n+    if (jni->IsInstanceOf(obj, object_M)) {\n@@ -121,1 +121,1 @@\n-    if (NSK_CPP_STUB3(IsSameObject, jni, object_M, obj)) {\n+    if (jni->IsSameObject(object_M, obj)) {\n@@ -129,2 +129,1 @@\n-        if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB3(GetObjectMonitorUsage,\n-                jvmti, obj, &usageInfo))) {\n+        if (!NSK_JVMTI_VERIFY(jvmti->GetObjectMonitorUsage(obj, &usageInfo))) {\n@@ -133,2 +132,1 @@\n-            if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(\n-                    InterruptThread, jvmti, usageInfo.owner)))\n+            if (!NSK_JVMTI_VERIFY(jvmti->InterruptThread(usageInfo.owner)))\n@@ -154,1 +152,1 @@\n-    if (NSK_CPP_STUB3(IsSameObject, jni, object_M, obj)) {\n+    if (jni->IsSameObject(object_M, obj)) {\n@@ -169,2 +167,1 @@\n-    if (!NSK_JNI_VERIFY(jni, (object_M =\n-            NSK_CPP_STUB2(FindClass, jni, CLASS_NAME)) != NULL))\n+    if (!NSK_JNI_VERIFY(jni, (object_M = jni->FindClass(CLASS_NAME)) != NULL))\n@@ -173,2 +170,1 @@\n-    if (!NSK_JNI_VERIFY(jni, (object_M = (jclass)\n-            NSK_CPP_STUB2(NewGlobalRef, jni, object_M)) != NULL))\n+    if (!NSK_JNI_VERIFY(jni, (object_M = (jclass)jni->NewGlobalRef(object_M)) != NULL))\n@@ -177,2 +173,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-            NSK_CPP_STUB3(CreateRawMonitor, jvmti, \"_syncLock\", &syncLock)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->CreateRawMonitor(\"_syncLock\", &syncLock)))\n@@ -183,2 +178,1 @@\n-            NSK_CPP_STUB4(SetEventNotificationMode, jvmti, JVMTI_ENABLE,\n-                JVMTI_EVENT_MONITOR_WAIT, NULL)))\n+            jvmti->SetEventNotificationMode(JVMTI_ENABLE, JVMTI_EVENT_MONITOR_WAIT, NULL)))\n@@ -189,2 +183,1 @@\n-            NSK_CPP_STUB4(SetEventNotificationMode, jvmti, JVMTI_ENABLE,\n-                JVMTI_EVENT_MONITOR_WAITED, NULL)))\n+            jvmti->SetEventNotificationMode(JVMTI_ENABLE, JVMTI_EVENT_MONITOR_WAITED, NULL)))\n@@ -195,2 +188,2 @@\n-            NSK_CPP_STUB4(SetEventNotificationMode, jvmti, JVMTI_ENABLE,\n-                JVMTI_EVENT_MONITOR_CONTENDED_ENTER, NULL)))\n+            jvmti->SetEventNotificationMode(\n+                JVMTI_ENABLE, JVMTI_EVENT_MONITOR_CONTENDED_ENTER, NULL)))\n@@ -201,2 +194,2 @@\n-            NSK_CPP_STUB4(SetEventNotificationMode, jvmti, JVMTI_ENABLE,\n-                JVMTI_EVENT_MONITOR_CONTENDED_ENTERED, NULL)))\n+            jvmti->SetEventNotificationMode(\n+                JVMTI_ENABLE, JVMTI_EVENT_MONITOR_CONTENDED_ENTERED, NULL)))\n@@ -212,2 +205,1 @@\n-            NSK_CPP_STUB4(SetEventNotificationMode, jvmti, JVMTI_DISABLE,\n-                JVMTI_EVENT_MONITOR_WAIT, NULL)))\n+            jvmti->SetEventNotificationMode(JVMTI_DISABLE, JVMTI_EVENT_MONITOR_WAIT, NULL)))\n@@ -218,2 +210,1 @@\n-            NSK_CPP_STUB4(SetEventNotificationMode, jvmti, JVMTI_DISABLE,\n-                JVMTI_EVENT_MONITOR_WAITED, NULL)))\n+            jvmti->SetEventNotificationMode(JVMTI_DISABLE, JVMTI_EVENT_MONITOR_WAITED, NULL)))\n@@ -224,2 +215,2 @@\n-            NSK_CPP_STUB4(SetEventNotificationMode, jvmti, JVMTI_DISABLE,\n-                JVMTI_EVENT_MONITOR_CONTENDED_ENTER, NULL)))\n+            jvmti->SetEventNotificationMode(\n+                JVMTI_DISABLE, JVMTI_EVENT_MONITOR_CONTENDED_ENTER, NULL)))\n@@ -230,2 +221,2 @@\n-            NSK_CPP_STUB4(SetEventNotificationMode, jvmti, JVMTI_DISABLE,\n-                JVMTI_EVENT_MONITOR_CONTENDED_ENTERED, NULL)))\n+            jvmti->SetEventNotificationMode(\n+                JVMTI_DISABLE, JVMTI_EVENT_MONITOR_CONTENDED_ENTERED, NULL)))\n@@ -234,2 +225,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-            NSK_CPP_STUB2(DestroyRawMonitor, jvmti, syncLock)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->DestroyRawMonitor(syncLock)))\n@@ -339,1 +329,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(AddCapabilities, jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->AddCapabilities(&caps)))\n@@ -347,2 +337,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB3(SetEventCallbacks, jvmti,\n-            &callbacks, sizeof(callbacks))))\n+    if (!NSK_JVMTI_VERIFY(jvmti->SetEventCallbacks(&callbacks, sizeof(callbacks))))\n","filename":"test\/hotspot\/jtreg\/vmTestbase\/nsk\/jvmti\/scenarios\/contention\/TC04\/tc04t001\/tc04t001.cpp","additions":26,"deletions":37,"binary":false,"changes":63,"status":"modified"},{"patch":"@@ -75,4 +75,3 @@\n-    if (NSK_CPP_STUB3(IsSameObject, jni, thread, thr) &&\n-            NSK_CPP_STUB3(IsSameObject, jni, object_M, obj)) {\n-        if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB3(\n-                GetThreadCpuTime, jvmti, thr, &waitThreadCpuTime))) {\n+    if (jni->IsSameObject(thread, thr) &&\n+            jni->IsSameObject(object_M, obj)) {\n+        if (!NSK_JVMTI_VERIFY(jvmti->GetThreadCpuTime(thr, &waitThreadCpuTime))) {\n@@ -81,2 +80,1 @@\n-        if (!NSK_JVMTI_VERIFY(\n-                NSK_CPP_STUB2(GetTime, jvmti, &waitTime))) {\n+        if (!NSK_JVMTI_VERIFY(jvmti->GetTime(&waitTime))) {\n@@ -116,4 +114,3 @@\n-    if (NSK_CPP_STUB3(IsSameObject, jni, thread, thr) &&\n-            NSK_CPP_STUB3(IsSameObject, jni, object_M, obj)) {\n-        if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB3(\n-                GetThreadCpuTime, jvmti, thr, &waitedThreadCpuTime))) {\n+    if (jni->IsSameObject(thread, thr) &&\n+            jni->IsSameObject(object_M, obj)) {\n+        if (!NSK_JVMTI_VERIFY(jvmti->GetThreadCpuTime(thr, &waitedThreadCpuTime))) {\n@@ -122,2 +119,1 @@\n-        if (!NSK_JVMTI_VERIFY(\n-                NSK_CPP_STUB2(GetTime, jvmti, &waitedTime))) {\n+        if (!NSK_JVMTI_VERIFY(jvmti->GetTime(&waitedTime))) {\n@@ -152,2 +148,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-           NSK_CPP_STUB3(GetAllThreads, jvmti, &threads_count, &threads)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->GetAllThreads(&threads_count, &threads)))\n@@ -165,2 +160,1 @@\n-        if (!NSK_JVMTI_VERIFY(\n-                NSK_CPP_STUB3(GetThreadInfo, jvmti, threads[i], &info)))\n+        if (!NSK_JVMTI_VERIFY(jvmti->GetThreadInfo(threads[i], &info)))\n@@ -177,2 +171,1 @@\n-            if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(\n-                    Deallocate, jvmti, (unsigned char*)info.name)))\n+            if (!NSK_JVMTI_VERIFY(jvmti->Deallocate((unsigned char*)info.name)))\n@@ -184,2 +177,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-            NSK_CPP_STUB2(Deallocate, jvmti, (unsigned char*)threads)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->Deallocate((unsigned char*)threads)))\n@@ -194,2 +186,1 @@\n-    if (!NSK_JNI_VERIFY(jni, (thread =\n-            NSK_CPP_STUB2(NewGlobalRef, jni, thread)) != NULL))\n+    if (!NSK_JNI_VERIFY(jni, (thread = jni->NewGlobalRef(thread)) != NULL))\n@@ -199,2 +190,1 @@\n-    if (!NSK_JNI_VERIFY(jni, (klass =\n-            NSK_CPP_STUB2(GetObjectClass, jni, thread)) != NULL))\n+    if (!NSK_JNI_VERIFY(jni, (klass = jni->GetObjectClass(thread)) != NULL))\n@@ -204,2 +194,1 @@\n-    if (!NSK_JNI_VERIFY(jni, (field =\n-            NSK_CPP_STUB4(GetFieldID, jni, klass, \"M\", FIELD_SIG)) != NULL))\n+    if (!NSK_JNI_VERIFY(jni, (field = jni->GetFieldID(klass, \"M\", FIELD_SIG)) != NULL))\n@@ -208,2 +197,1 @@\n-    if (!NSK_JNI_VERIFY(jni, (object_M =\n-            NSK_CPP_STUB3(GetObjectField, jni, thread, field)) != NULL))\n+    if (!NSK_JNI_VERIFY(jni, (object_M = jni->GetObjectField(thread, field)) != NULL))\n@@ -213,2 +201,1 @@\n-    if (!NSK_JNI_VERIFY(jni, (object_M =\n-            NSK_CPP_STUB2(NewGlobalRef, jni, object_M)) != NULL))\n+    if (!NSK_JNI_VERIFY(jni, (object_M = jni->NewGlobalRef(object_M)) != NULL))\n@@ -219,2 +206,1 @@\n-            NSK_CPP_STUB4(SetEventNotificationMode, jvmti, JVMTI_ENABLE,\n-                JVMTI_EVENT_MONITOR_WAIT, NULL)))\n+            jvmti->SetEventNotificationMode(JVMTI_ENABLE, JVMTI_EVENT_MONITOR_WAIT, NULL)))\n@@ -225,2 +211,1 @@\n-            NSK_CPP_STUB4(SetEventNotificationMode, jvmti, JVMTI_ENABLE,\n-                JVMTI_EVENT_MONITOR_WAITED, NULL)))\n+            jvmti->SetEventNotificationMode(JVMTI_ENABLE, JVMTI_EVENT_MONITOR_WAITED, NULL)))\n@@ -236,2 +221,1 @@\n-            NSK_CPP_STUB4(SetEventNotificationMode, jvmti, JVMTI_DISABLE,\n-                JVMTI_EVENT_MONITOR_WAIT, NULL)))\n+            jvmti->SetEventNotificationMode(JVMTI_DISABLE, JVMTI_EVENT_MONITOR_WAIT, NULL)))\n@@ -242,2 +226,1 @@\n-            NSK_CPP_STUB4(SetEventNotificationMode, jvmti, JVMTI_DISABLE,\n-                JVMTI_EVENT_MONITOR_WAITED, NULL)))\n+            jvmti->SetEventNotificationMode(JVMTI_DISABLE, JVMTI_EVENT_MONITOR_WAITED, NULL)))\n@@ -346,1 +329,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(AddCapabilities, jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->AddCapabilities(&caps)))\n@@ -352,2 +335,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB3(SetEventCallbacks, jvmti,\n-            &callbacks, sizeof(callbacks))))\n+    if (!NSK_JVMTI_VERIFY(jvmti->SetEventCallbacks(&callbacks, sizeof(callbacks))))\n","filename":"test\/hotspot\/jtreg\/vmTestbase\/nsk\/jvmti\/scenarios\/contention\/TC05\/tc05t001\/tc05t001.cpp","additions":23,"deletions":41,"binary":false,"changes":64,"status":"modified"},{"patch":"@@ -57,1 +57,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(RawMonitorEnter, jvmti, syncLock)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->RawMonitorEnter(syncLock)))\n@@ -62,1 +62,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(RawMonitorExit, jvmti, syncLock)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->RawMonitorExit(syncLock)))\n@@ -95,3 +95,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-            NSK_CPP_STUB4(GetClassSignature, jvmti_env, klass,\n-                                &className, &generic))) {\n+    if (!NSK_JVMTI_VERIFY(jvmti_env->GetClassSignature(klass, &className, &generic))) {\n@@ -110,1 +108,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(GetPhase, jvmti_env, &phase))) {\n+    if (!NSK_JVMTI_VERIFY(jvmti_env->GetPhase(&phase))) {\n@@ -128,2 +126,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(Deallocate,\n-            jvmti_env, (unsigned char*)className))) {\n+    if (!NSK_JVMTI_VERIFY(jvmti_env->Deallocate((unsigned char*)className))) {\n@@ -133,2 +130,1 @@\n-        if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(Deallocate,\n-                jvmti_env, (unsigned char*)generic))) {\n+        if (!NSK_JVMTI_VERIFY(jvmti_env->Deallocate((unsigned char*)generic))) {\n@@ -148,2 +144,1 @@\n-    if (!NSK_JNI_VERIFY(jni_env, (classObject =\n-            NSK_CPP_STUB2(GetObjectClass, jni_env, thread)) != NULL)) {\n+    if (!NSK_JNI_VERIFY(jni_env, (classObject = jni_env->GetObjectClass(thread)) != NULL)) {\n@@ -154,3 +149,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-            NSK_CPP_STUB4(GetClassSignature, jvmti_env, classObject,\n-                                &className, &generic))) {\n+    if (!NSK_JVMTI_VERIFY(jvmti_env->GetClassSignature(classObject, &className, &generic))) {\n@@ -169,1 +162,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(GetPhase, jvmti_env, &phase))) {\n+    if (!NSK_JVMTI_VERIFY(jvmti_env->GetPhase(&phase))) {\n@@ -187,2 +180,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(Deallocate,\n-            jvmti_env, (unsigned char*)className))) {\n+    if (!NSK_JVMTI_VERIFY(jvmti_env->Deallocate((unsigned char*)className))) {\n@@ -192,2 +184,1 @@\n-        if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(Deallocate,\n-                jvmti_env, (unsigned char*)generic))) {\n+        if (!NSK_JVMTI_VERIFY(jvmti_env->Deallocate((unsigned char*)generic))) {\n@@ -203,1 +194,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(GetPhase, jvmti_env, &phase))) {\n+    if (!NSK_JVMTI_VERIFY(jvmti_env->GetPhase(&phase))) {\n@@ -224,1 +215,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(GetPhase, jvmti_env, &phase))) {\n+    if (!NSK_JVMTI_VERIFY(jvmti_env->GetPhase(&phase))) {\n@@ -245,1 +236,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(GetPhase, jvmti_env, &phase))) {\n+    if (!NSK_JVMTI_VERIFY(jvmti_env->GetPhase(&phase))) {\n@@ -260,2 +251,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-            NSK_CPP_STUB2(DestroyRawMonitor, jvmti, syncLock)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->DestroyRawMonitor(syncLock)))\n@@ -297,3 +287,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-            NSK_CPP_STUB4(SetEventNotificationMode, jvmti, enable,\n-                                            event, NULL))) {\n+    if (!NSK_JVMTI_VERIFY(jvmti->SetEventNotificationMode(enable, event, NULL))) {\n@@ -372,4 +360,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-            NSK_CPP_STUB3(SetEventCallbacks, jvmti,\n-                                &eventCallbacks,\n-                                sizeof(eventCallbacks))))\n+    if (!NSK_JVMTI_VERIFY(jvmti->SetEventCallbacks(&eventCallbacks, sizeof(eventCallbacks))))\n@@ -449,2 +434,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-            NSK_CPP_STUB3(CreateRawMonitor, jvmti, \"_syncLock\", &syncLock))) {\n+    if (!NSK_JVMTI_VERIFY(jvmti->CreateRawMonitor(\"_syncLock\", &syncLock))) {\n","filename":"test\/hotspot\/jtreg\/vmTestbase\/nsk\/jvmti\/scenarios\/events\/EM01\/em01t001\/em01t001.cpp","additions":18,"deletions":34,"binary":false,"changes":52,"status":"modified"},{"patch":"@@ -68,2 +68,1 @@\n-    if (!NSK_JNI_VERIFY(jni_env, (klass =\n-            NSK_CPP_STUB2(GetObjectClass, jni_env, loader)) != NULL)) {\n+    if (!NSK_JNI_VERIFY(jni_env, (klass = jni_env->GetObjectClass(loader)) != NULL)) {\n@@ -74,3 +73,3 @@\n-    if (!NSK_JNI_VERIFY(jni_env, (methodID =\n-            NSK_CPP_STUB4(GetMethodID, jni_env, klass, \"loadClass\",\n-                        \"(Ljava\/lang\/String;)Ljava\/lang\/Class;\")) != NULL)) {\n+    if (!NSK_JNI_VERIFY(jni_env,\n+            (methodID = jni_env->GetMethodID(\n+                klass, \"loadClass\", \"(Ljava\/lang\/String;)Ljava\/lang\/Class;\")) != NULL)) {\n@@ -82,2 +81,1 @@\n-            NSK_CPP_STUB4(CallObjectMethod, jni_env, loader, methodID,\n-                                    className)) != NULL)) {\n+            jni_env->CallObjectMethod(loader, methodID, className)) != NULL)) {\n@@ -102,2 +100,1 @@\n-            NSK_CPP_STUB4(GetStaticFieldID, jni_env, klass,\n-                        \"toProvokePreparation\", \"I\")) != NULL)) {\n+            jni_env->GetStaticFieldID(klass, \"toProvokePreparation\", \"I\")) != NULL)) {\n@@ -122,2 +119,1 @@\n-    if (!NSK_JNI_VERIFY(jni_env, (klass =\n-            NSK_CPP_STUB2(GetObjectClass, jni_env, thread)) != NULL)) {\n+    if (!NSK_JNI_VERIFY(jni_env, (klass = jni_env->GetObjectClass(thread)) != NULL)) {\n@@ -129,1 +125,1 @@\n-            NSK_CPP_STUB4(GetMethodID, jni_env, klass, \"start\", \"()V\")) != NULL)) {\n+            jni_env->GetMethodID(klass, \"start\", \"()V\")) != NULL)) {\n@@ -134,2 +130,1 @@\n-    if (!NSK_JNI_VERIFY_VOID(jni_env,\n-            NSK_CPP_STUB3(CallVoidMethod, jni_env, thread, methodID)) ) {\n+    if (!NSK_JNI_VERIFY_VOID(jni_env,jni_env->CallVoidMethod(thread, methodID)) ) {\n@@ -149,1 +144,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(RawMonitorEnter, jvmti, syncLock)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->RawMonitorEnter(syncLock)))\n@@ -154,1 +149,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(RawMonitorExit, jvmti, syncLock)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->RawMonitorExit(syncLock)))\n@@ -187,3 +182,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-            NSK_CPP_STUB4(GetClassSignature, jvmti_env, klass,\n-                                &className, &generic))) {\n+    if (!NSK_JVMTI_VERIFY(jvmti_env->GetClassSignature(klass, &className, &generic))) {\n@@ -202,1 +195,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(GetPhase, jvmti_env, &phase))) {\n+    if (!NSK_JVMTI_VERIFY(jvmti_env->GetPhase(&phase))) {\n@@ -220,2 +213,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(Deallocate,\n-            jvmti_env, (unsigned char*)className))) {\n+    if (!NSK_JVMTI_VERIFY(jvmti_env->Deallocate((unsigned char*)className))) {\n@@ -225,2 +217,1 @@\n-        if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(Deallocate,\n-                jvmti_env, (unsigned char*)generic))) {\n+        if (!NSK_JVMTI_VERIFY(jvmti_env->Deallocate((unsigned char*)generic))) {\n@@ -240,2 +231,1 @@\n-    if (!NSK_JNI_VERIFY(jni_env, (classObject =\n-            NSK_CPP_STUB2(GetObjectClass, jni_env, thread)) != NULL)) {\n+    if (!NSK_JNI_VERIFY(jni_env, (classObject = jni_env->GetObjectClass(thread)) != NULL)) {\n@@ -246,3 +236,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-            NSK_CPP_STUB4(GetClassSignature, jvmti_env, classObject,\n-                                &className, &generic))) {\n+    if (!NSK_JVMTI_VERIFY(jvmti_env->GetClassSignature(classObject, &className, &generic))) {\n@@ -261,1 +249,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(GetPhase, jvmti_env, &phase))) {\n+    if (!NSK_JVMTI_VERIFY(jvmti_env->GetPhase(&phase))) {\n@@ -279,2 +267,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(Deallocate,\n-            jvmti_env, (unsigned char*)className))) {\n+    if (!NSK_JVMTI_VERIFY(jvmti_env->Deallocate((unsigned char*)className))) {\n@@ -284,2 +271,1 @@\n-        if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(Deallocate,\n-                jvmti_env, (unsigned char*)generic))) {\n+        if (!NSK_JVMTI_VERIFY(jvmti_env->Deallocate((unsigned char*)generic))) {\n@@ -295,1 +281,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(GetPhase, jvmti_env, &phase))) {\n+    if (!NSK_JVMTI_VERIFY(jvmti_env->GetPhase(&phase))) {\n@@ -316,1 +302,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(GetPhase, jvmti_env, &phase))) {\n+    if (!NSK_JVMTI_VERIFY(jvmti_env->GetPhase(&phase))) {\n@@ -337,1 +323,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(GetPhase, jvmti_env, &phase))) {\n+    if (!NSK_JVMTI_VERIFY(jvmti_env->GetPhase(&phase))) {\n@@ -352,2 +338,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-            NSK_CPP_STUB2(DestroyRawMonitor, jvmti, syncLock)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->DestroyRawMonitor(syncLock)))\n@@ -396,3 +381,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-            NSK_CPP_STUB4(SetEventNotificationMode, jvmti, enable,\n-                                            event, NULL))) {\n+    if (!NSK_JVMTI_VERIFY(jvmti->SetEventNotificationMode(enable, event, NULL))) {\n@@ -471,4 +454,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-            NSK_CPP_STUB3(SetEventCallbacks, jvmti,\n-                                &eventCallbacks,\n-                                sizeof(eventCallbacks))))\n+    if (!NSK_JVMTI_VERIFY(jvmti->SetEventCallbacks(&eventCallbacks, sizeof(eventCallbacks))))\n@@ -547,2 +527,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-            NSK_CPP_STUB3(CreateRawMonitor, jvmti, \"_syncLock\", &syncLock))) {\n+    if (!NSK_JVMTI_VERIFY(jvmti->CreateRawMonitor(\"_syncLock\", &syncLock))) {\n","filename":"test\/hotspot\/jtreg\/vmTestbase\/nsk\/jvmti\/scenarios\/events\/EM01\/em01t002\/em01t002.cpp","additions":27,"deletions":48,"binary":false,"changes":75,"status":"modified"},{"patch":"@@ -71,2 +71,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-           NSK_CPP_STUB3(GetAllThreads, jvmti, &threads_count, &threads)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->GetAllThreads(&threads_count, &threads)))\n@@ -84,2 +83,1 @@\n-        if (!NSK_JVMTI_VERIFY(\n-                NSK_CPP_STUB3(GetThreadInfo, jvmti, threads[i], &info)))\n+        if (!NSK_JVMTI_VERIFY(jvmti->GetThreadInfo(threads[i], &info)))\n@@ -95,2 +93,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-            NSK_CPP_STUB2(Deallocate, jvmti, (unsigned char*)threads)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->Deallocate((unsigned char*)threads)))\n@@ -111,2 +108,1 @@\n-    if (!NSK_JNI_VERIFY(jni, (klass =\n-            NSK_CPP_STUB2(FindClass, jni, className)) != NULL))\n+    if (!NSK_JNI_VERIFY(jni, (klass = jni->FindClass(className)) != NULL))\n@@ -116,2 +112,1 @@\n-            NSK_CPP_STUB4(GetStaticFieldID, jni, klass, objFieldName,\n-                                signature)) != NULL))\n+            jni->GetStaticFieldID(klass, objFieldName, signature)) != NULL))\n@@ -120,1 +115,1 @@\n-    return NSK_CPP_STUB3(GetStaticObjectField, jni, klass, fieldID);\n+    return jni->GetStaticObjectField(klass, fieldID);\n@@ -133,2 +128,1 @@\n-    if (!NSK_JNI_VERIFY(jni, (mainThread =\n-            NSK_CPP_STUB2(NewGlobalRef, jni, mainThread)) != NULL))\n+    if (!NSK_JNI_VERIFY(jni, (mainThread = jni->NewGlobalRef(mainThread)) != NULL))\n@@ -143,2 +137,1 @@\n-    if (!NSK_JNI_VERIFY(jni, (startObject =\n-            NSK_CPP_STUB2(NewGlobalRef, jni, startObject)) != NULL))\n+    if (!NSK_JNI_VERIFY(jni, (startObject = jni->NewGlobalRef(startObject)) != NULL))\n@@ -154,2 +147,1 @@\n-    if (!NSK_JNI_VERIFY(jni, (endObject =\n-            NSK_CPP_STUB2(NewGlobalRef, jni, endObject)) != NULL))\n+    if (!NSK_JNI_VERIFY(jni, (endObject = jni->NewGlobalRef(endObject)) != NULL))\n@@ -165,2 +157,1 @@\n-    if (!NSK_JNI_VERIFY(jni, (debuggeeThread =\n-            NSK_CPP_STUB2(NewGlobalRef, jni, debuggeeThread)) != NULL))\n+    if (!NSK_JNI_VERIFY(jni, (debuggeeThread = jni->NewGlobalRef(debuggeeThread)) != NULL))\n@@ -179,2 +170,2 @@\n-            NSK_CPP_STUB4(SetEventNotificationMode, jvmti, JVMTI_DISABLE,\n-                JVMTI_EVENT_MONITOR_CONTENDED_ENTER, NULL)))\n+            jvmti->SetEventNotificationMode(\n+                JVMTI_DISABLE, JVMTI_EVENT_MONITOR_CONTENDED_ENTER, NULL)))\n@@ -184,4 +175,4 @@\n-    NSK_CPP_STUB2(DeleteGlobalRef, jni, startObject);\n-    NSK_CPP_STUB2(DeleteGlobalRef, jni, endObject);\n-    NSK_CPP_STUB2(DeleteGlobalRef, jni, debuggeeThread);\n-    NSK_CPP_STUB2(DeleteGlobalRef, jni, mainThread);\n+    jni->DeleteGlobalRef(startObject);\n+    jni->DeleteGlobalRef(endObject);\n+    jni->DeleteGlobalRef(debuggeeThread);\n+    jni->DeleteGlobalRef(mainThread);\n@@ -222,2 +213,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-            NSK_CPP_STUB3(GetThreadInfo, jvmti, thread, &info)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->GetThreadInfo(thread, &info)))\n@@ -234,1 +224,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(RawMonitorEnter, jvmti, syncLock)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->RawMonitorEnter(syncLock)))\n@@ -239,1 +229,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(RawMonitorExit, jvmti, syncLock)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->RawMonitorExit(syncLock)))\n@@ -330,2 +320,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-            NSK_CPP_STUB2(DestroyRawMonitor, jvmti, syncLock)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->DestroyRawMonitor(syncLock)))\n@@ -423,2 +412,2 @@\n-    if (NSK_CPP_STUB3(IsSameObject, jni_env, expectedThread, thread) &&\n-            NSK_CPP_STUB3(IsSameObject, jni_env, expectedObject, object)) {\n+    if (jni_env->IsSameObject(expectedThread, thread) &&\n+            jni_env->IsSameObject(expectedObject, object)) {\n@@ -429,1 +418,1 @@\n-        if (NSK_CPP_STUB3(IsSameObject, jni_env, expectedObject, endObject))\n+        if (jni_env->IsSameObject(expectedObject, endObject))\n@@ -509,2 +498,2 @@\n-    if (NSK_CPP_STUB3(IsSameObject, jni_env, expectedThread, thread) &&\n-            NSK_CPP_STUB3(IsSameObject, jni_env, expectedObject, object)) {\n+    if (jni_env->IsSameObject(expectedThread, thread) &&\n+            jni_env->IsSameObject(expectedObject, object)) {\n@@ -515,1 +504,1 @@\n-        if (NSK_CPP_STUB3(IsSameObject, jni_env, expectedObject, endObject))\n+        if (jni_env->IsSameObject(expectedObject, endObject))\n@@ -575,2 +564,1 @@\n-                NSK_CPP_STUB4(SetEventNotificationMode, jvmti,\n-                    JVMTI_ENABLE, event, NULL))) {\n+                jvmti->SetEventNotificationMode(JVMTI_ENABLE, event, NULL))) {\n@@ -582,3 +570,1 @@\n-        if (!NSK_JVMTI_VERIFY(\n-                NSK_CPP_STUB4(SetEventNotificationMode, jvmti,\n-                    JVMTI_ENABLE, event, NULL))) {\n+        if (!NSK_JVMTI_VERIFY(jvmti->SetEventNotificationMode(JVMTI_ENABLE, event, NULL))) {\n@@ -682,4 +668,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-            NSK_CPP_STUB3(SetEventCallbacks, jvmti,\n-                                &eventCallbacks,\n-                                sizeof(eventCallbacks))))\n+    if (!NSK_JVMTI_VERIFY(jvmti->SetEventCallbacks(&eventCallbacks, sizeof(eventCallbacks))))\n@@ -774,2 +757,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-            NSK_CPP_STUB3(CreateRawMonitor, jvmti, \"_syncLock\", &syncLock))) {\n+    if (!NSK_JVMTI_VERIFY(jvmti->CreateRawMonitor(\"_syncLock\", &syncLock))) {\n@@ -785,1 +767,1 @@\n-        if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(AddCapabilities, jvmti, &caps)))\n+        if (!NSK_JVMTI_VERIFY(jvmti->AddCapabilities(&caps)))\n","filename":"test\/hotspot\/jtreg\/vmTestbase\/nsk\/jvmti\/scenarios\/events\/EM02\/em02t001\/em02t001.cpp","additions":31,"deletions":49,"binary":false,"changes":80,"status":"modified"},{"patch":"@@ -153,1 +153,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(RawMonitorEnter, jvmti, syncLock)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->RawMonitorEnter(syncLock)))\n@@ -158,1 +158,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(RawMonitorExit, jvmti, syncLock)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->RawMonitorExit(syncLock)))\n@@ -180,2 +180,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-            NSK_CPP_STUB2(DestroyRawMonitor, jvmti, syncLock)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->DestroyRawMonitor(syncLock)))\n@@ -348,2 +347,1 @@\n-                NSK_CPP_STUB4(SetEventNotificationMode, jvmti,\n-                    JVMTI_ENABLE, event, NULL))) {\n+                jvmti->SetEventNotificationMode(JVMTI_ENABLE, event, NULL))) {\n@@ -355,3 +353,1 @@\n-        if (!NSK_JVMTI_VERIFY(\n-                NSK_CPP_STUB4(SetEventNotificationMode, jvmti,\n-                    JVMTI_ENABLE, event, NULL))) {\n+        if (!NSK_JVMTI_VERIFY(jvmti->SetEventNotificationMode(JVMTI_ENABLE, event, NULL))) {\n@@ -453,4 +449,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-            NSK_CPP_STUB3(SetEventCallbacks, jvmti,\n-                                &eventCallbacks,\n-                                sizeof(eventCallbacks))))\n+    if (!NSK_JVMTI_VERIFY(jvmti->SetEventCallbacks(&eventCallbacks, sizeof(eventCallbacks))))\n@@ -522,2 +515,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-            NSK_CPP_STUB3(CreateRawMonitor, jvmti, \"_syncLock\", &syncLock))) {\n+    if (!NSK_JVMTI_VERIFY(jvmti->CreateRawMonitor(\"_syncLock\", &syncLock))) {\n@@ -533,1 +525,1 @@\n-        if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(AddCapabilities, jvmti, &caps)))\n+        if (!NSK_JVMTI_VERIFY(jvmti->AddCapabilities(&caps)))\n","filename":"test\/hotspot\/jtreg\/vmTestbase\/nsk\/jvmti\/scenarios\/events\/EM02\/em02t002\/em02t002.cpp","additions":8,"deletions":16,"binary":false,"changes":24,"status":"modified"},{"patch":"@@ -137,1 +137,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(RawMonitorEnter, jvmti, syncLock)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->RawMonitorEnter(syncLock)))\n@@ -142,1 +142,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(RawMonitorExit, jvmti, syncLock)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->RawMonitorExit(syncLock)))\n@@ -162,2 +162,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-            NSK_CPP_STUB2(DestroyRawMonitor, jvmti, syncLock)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->DestroyRawMonitor(syncLock)))\n@@ -268,3 +267,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-            NSK_CPP_STUB5(\n-                GetMethodName, jvmti, method, &name, &sign, &genc))) {\n+    if (!NSK_JVMTI_VERIFY(jvmti->GetMethodName(method, &name, &sign, &genc))) {\n@@ -280,2 +277,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(Deallocate,\n-            jvmti, (unsigned char*)name))) {\n+    if (!NSK_JVMTI_VERIFY(jvmti->Deallocate((unsigned char*)name))) {\n@@ -284,2 +280,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(Deallocate,\n-            jvmti, (unsigned char*)sign))) {\n+    if (!NSK_JVMTI_VERIFY(jvmti->Deallocate((unsigned char*)sign))) {\n@@ -289,2 +284,1 @@\n-        if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(Deallocate,\n-                jvmti, (unsigned char*)genc))) {\n+        if (!NSK_JVMTI_VERIFY(jvmti->Deallocate((unsigned char*)genc))) {\n@@ -341,3 +335,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-            NSK_CPP_STUB5(\n-                GetMethodName, jvmti, method, &name, &sign, &genc))) {\n+    if (!NSK_JVMTI_VERIFY(jvmti->GetMethodName(method, &name, &sign, &genc))) {\n@@ -351,2 +343,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(Deallocate,\n-            jvmti, (unsigned char*)name))) {\n+    if (!NSK_JVMTI_VERIFY(jvmti->Deallocate((unsigned char*)name))) {\n@@ -355,2 +346,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(Deallocate,\n-            jvmti, (unsigned char*)sign))) {\n+    if (!NSK_JVMTI_VERIFY(jvmti->Deallocate((unsigned char*)sign))) {\n@@ -360,2 +350,1 @@\n-        if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(Deallocate,\n-                jvmti, (unsigned char*)genc))) {\n+        if (!NSK_JVMTI_VERIFY(jvmti->Deallocate((unsigned char*)genc))) {\n@@ -392,2 +381,1 @@\n-                NSK_CPP_STUB4(SetEventNotificationMode, jvmti,\n-                    JVMTI_ENABLE, event, NULL))) {\n+                jvmti->SetEventNotificationMode(JVMTI_ENABLE, event, NULL))) {\n@@ -399,3 +387,1 @@\n-        if (!NSK_JVMTI_VERIFY(\n-                NSK_CPP_STUB4(SetEventNotificationMode, jvmti,\n-                    JVMTI_ENABLE, event, NULL))) {\n+        if (!NSK_JVMTI_VERIFY(jvmti->SetEventNotificationMode(JVMTI_ENABLE, event, NULL))) {\n@@ -501,4 +487,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-            NSK_CPP_STUB3(SetEventCallbacks, jvmti,\n-                                &eventCallbacks,\n-                                sizeof(eventCallbacks))))\n+    if (!NSK_JVMTI_VERIFY(jvmti->SetEventCallbacks(&eventCallbacks, sizeof(eventCallbacks))))\n@@ -571,2 +554,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-            NSK_CPP_STUB3(CreateRawMonitor, jvmti, \"_syncLock\", &syncLock))) {\n+    if (!NSK_JVMTI_VERIFY(jvmti->CreateRawMonitor(\"_syncLock\", &syncLock))) {\n@@ -582,1 +564,1 @@\n-        if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(AddCapabilities, jvmti, &caps)))\n+        if (!NSK_JVMTI_VERIFY(jvmti->AddCapabilities(&caps)))\n","filename":"test\/hotspot\/jtreg\/vmTestbase\/nsk\/jvmti\/scenarios\/events\/EM02\/em02t003\/em02t003.cpp","additions":16,"deletions":34,"binary":false,"changes":50,"status":"modified"},{"patch":"@@ -149,1 +149,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(RawMonitorEnter, jvmti, syncLock)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->RawMonitorEnter(syncLock)))\n@@ -154,1 +154,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(RawMonitorExit, jvmti, syncLock)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->RawMonitorExit(syncLock)))\n@@ -174,2 +174,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-            NSK_CPP_STUB2(DestroyRawMonitor, jvmti, syncLock)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->DestroyRawMonitor(syncLock)))\n@@ -313,1 +312,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(GetPhase, jvmti_env, &phase))) {\n+    if (!NSK_JVMTI_VERIFY(jvmti_env->GetPhase(&phase))) {\n@@ -321,3 +320,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-            NSK_CPP_STUB5(\n-                GetMethodName, jvmti_env, method, &name, &sign, &genc))) {\n+    if (!NSK_JVMTI_VERIFY(jvmti_env->GetMethodName(method, &name, &sign, &genc))) {\n@@ -334,2 +331,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(Deallocate,\n-            jvmti_env, (unsigned char*)name))) {\n+    if (!NSK_JVMTI_VERIFY(jvmti_env->Deallocate((unsigned char*)name))) {\n@@ -338,2 +334,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(Deallocate,\n-            jvmti_env, (unsigned char*)sign))) {\n+    if (!NSK_JVMTI_VERIFY(jvmti_env->Deallocate((unsigned char*)sign))) {\n@@ -343,2 +338,1 @@\n-        if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(Deallocate,\n-                jvmti_env, (unsigned char*)genc))) {\n+        if (!NSK_JVMTI_VERIFY(jvmti_env->Deallocate((unsigned char*)genc))) {\n@@ -358,1 +352,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(GetPhase, jvmti_env, &phase))) {\n+    if (!NSK_JVMTI_VERIFY(jvmti_env->GetPhase(&phase))) {\n@@ -366,3 +360,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-            NSK_CPP_STUB5(\n-                GetMethodName, jvmti_env, method, &name, &sign, &genc))) {\n+    if (!NSK_JVMTI_VERIFY(jvmti_env->GetMethodName(method, &name, &sign, &genc))) {\n@@ -379,2 +371,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(Deallocate,\n-            jvmti_env, (unsigned char*)name))) {\n+    if (!NSK_JVMTI_VERIFY(jvmti_env->Deallocate((unsigned char*)name))) {\n@@ -383,2 +374,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(Deallocate,\n-            jvmti_env, (unsigned char*)sign))) {\n+    if (!NSK_JVMTI_VERIFY(jvmti_env->Deallocate((unsigned char*)sign))) {\n@@ -388,2 +378,1 @@\n-        if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(Deallocate,\n-                jvmti_env, (unsigned char*)genc))) {\n+        if (!NSK_JVMTI_VERIFY(jvmti_env->Deallocate((unsigned char*)genc))) {\n@@ -401,2 +390,1 @@\n-                NSK_CPP_STUB4(SetEventNotificationMode, jvmti,\n-                    JVMTI_ENABLE, event, NULL))) {\n+                jvmti->SetEventNotificationMode(JVMTI_ENABLE, event, NULL))) {\n@@ -408,3 +396,1 @@\n-        if (!NSK_JVMTI_VERIFY(\n-                NSK_CPP_STUB4(SetEventNotificationMode, jvmti,\n-                    JVMTI_ENABLE, event, NULL))) {\n+        if (!NSK_JVMTI_VERIFY(jvmti->SetEventNotificationMode(JVMTI_ENABLE, event, NULL))) {\n@@ -508,4 +494,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-            NSK_CPP_STUB3(SetEventCallbacks, jvmti,\n-                                &eventCallbacks,\n-                                sizeof(eventCallbacks))))\n+    if (!NSK_JVMTI_VERIFY(jvmti->SetEventCallbacks(&eventCallbacks, sizeof(eventCallbacks))))\n@@ -577,2 +560,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-            NSK_CPP_STUB3(CreateRawMonitor, jvmti, \"_syncLock\", &syncLock))) {\n+    if (!NSK_JVMTI_VERIFY(jvmti->CreateRawMonitor(\"_syncLock\", &syncLock))) {\n@@ -588,1 +570,1 @@\n-        if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(AddCapabilities, jvmti, &caps)))\n+        if (!NSK_JVMTI_VERIFY(jvmti->AddCapabilities(&caps)))\n","filename":"test\/hotspot\/jtreg\/vmTestbase\/nsk\/jvmti\/scenarios\/events\/EM02\/em02t004\/em02t004.cpp","additions":18,"deletions":36,"binary":false,"changes":54,"status":"modified"},{"patch":"@@ -136,1 +136,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(RawMonitorEnter, jvmti, syncLock)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->RawMonitorEnter(syncLock)))\n@@ -141,1 +141,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(RawMonitorExit, jvmti, syncLock)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->RawMonitorExit(syncLock)))\n@@ -161,2 +161,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-            NSK_CPP_STUB2(DestroyRawMonitor, jvmti, syncLock)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->DestroyRawMonitor(syncLock)))\n@@ -305,3 +304,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-            NSK_CPP_STUB4(GetClassSignature, jvmti_env, object_klass,\n-                                &sign_ptr, &gen_ptr))) {\n+    if (!NSK_JVMTI_VERIFY(jvmti_env->GetClassSignature(object_klass, &sign_ptr, &gen_ptr))) {\n@@ -316,1 +313,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(GetPhase, jvmti_env, &phase))) {\n+    if (!NSK_JVMTI_VERIFY(jvmti_env->GetPhase(&phase))) {\n@@ -329,2 +326,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(Deallocate,\n-            jvmti_env, (unsigned char*)sign_ptr))) {\n+    if (!NSK_JVMTI_VERIFY(jvmti_env->Deallocate((unsigned char*)sign_ptr))) {\n@@ -334,2 +330,1 @@\n-        if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(Deallocate,\n-                jvmti_env, (unsigned char*)gen_ptr))) {\n+        if (!NSK_JVMTI_VERIFY(jvmti_env->Deallocate((unsigned char*)gen_ptr))) {\n@@ -349,3 +344,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-            NSK_CPP_STUB4(GetClassSignature, jvmti_env, object_klass,\n-                                &sign_ptr, &gen_ptr))) {\n+    if (!NSK_JVMTI_VERIFY(jvmti_env->GetClassSignature(object_klass, &sign_ptr, &gen_ptr))) {\n@@ -360,1 +353,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(GetPhase, jvmti_env, &phase))) {\n+    if (!NSK_JVMTI_VERIFY(jvmti_env->GetPhase(&phase))) {\n@@ -373,2 +366,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(Deallocate,\n-            jvmti_env, (unsigned char*)sign_ptr))) {\n+    if (!NSK_JVMTI_VERIFY(jvmti_env->Deallocate((unsigned char*)sign_ptr))) {\n@@ -378,2 +370,1 @@\n-        if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(Deallocate,\n-                jvmti_env, (unsigned char*)gen_ptr))) {\n+        if (!NSK_JVMTI_VERIFY(jvmti_env->Deallocate((unsigned char*)gen_ptr))) {\n@@ -391,2 +382,1 @@\n-                NSK_CPP_STUB4(SetEventNotificationMode, jvmti,\n-                    JVMTI_ENABLE, event, NULL))) {\n+                jvmti->SetEventNotificationMode(JVMTI_ENABLE, event, NULL))) {\n@@ -398,3 +388,1 @@\n-        if (!NSK_JVMTI_VERIFY(\n-                NSK_CPP_STUB4(SetEventNotificationMode, jvmti,\n-                    JVMTI_ENABLE, event, NULL))) {\n+        if (!NSK_JVMTI_VERIFY(jvmti->SetEventNotificationMode(JVMTI_ENABLE, event, NULL))) {\n@@ -493,4 +481,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-            NSK_CPP_STUB3(SetEventCallbacks, jvmti,\n-                                &eventCallbacks,\n-                                sizeof(eventCallbacks))))\n+    if (!NSK_JVMTI_VERIFY(jvmti->SetEventCallbacks(&eventCallbacks, sizeof(eventCallbacks))))\n@@ -556,2 +541,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-            NSK_CPP_STUB3(CreateRawMonitor, jvmti, \"_syncLock\", &syncLock))) {\n+    if (!NSK_JVMTI_VERIFY(jvmti->CreateRawMonitor(\"_syncLock\", &syncLock))) {\n@@ -567,1 +551,1 @@\n-        if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(AddCapabilities, jvmti, &caps)))\n+        if (!NSK_JVMTI_VERIFY(jvmti->AddCapabilities(&caps)))\n","filename":"test\/hotspot\/jtreg\/vmTestbase\/nsk\/jvmti\/scenarios\/events\/EM02\/em02t005\/em02t005.cpp","additions":16,"deletions":32,"binary":false,"changes":48,"status":"modified"}]}