{"files":[{"patch":"@@ -33,6 +33,7 @@\n-import java.security.*;\n-import javax.crypto.*;\n-import javax.crypto.spec.*;\n-import java.math.*;\n-\n-import java.util.*;\n+import java.security.GeneralSecurityException;\n+import java.security.Provider;\n+import java.util.Arrays;\n+import javax.crypto.Cipher;\n+import javax.crypto.SecretKey;\n+import javax.crypto.spec.GCMParameterSpec;\n+import javax.crypto.spec.SecretKeySpec;\n@@ -310,8 +311,13 @@\n-            double ver = getNSSInfo(\"nss\");\n-            if (ver < 3.251d && p.getName().contains(\"SunPKCS11-NSS\") &&\n-                System.getProperty(\"os.name\").equals(\"SunOS\")) {\n-                \/\/ buggy behaviour from solaris on 11.2 OS (nss < 3.251)\n-                System.out.println(\"Skipping: SunPKCS11-NSS: Old NSS: \" + ver);\n-                return; \/\/ OK\n-            } else {\n-                throw e;\n+            System.out.println(\"Exception occured using \" + p.getName() + \" version \" + p.getVersionStr());\n+\n+            if (isNSS(p)) {\n+                double ver = getNSSInfo(\"nss\");\n+                String osName = System.getProperty(\"os.name\");\n+                if (ver < 3.251d && osName.equals(\"SunOS\")) {\n+                    \/\/ buggy behaviour from solaris on 11.2 OS (nss < 3.251)\n+                    System.out.println(\"Skipping: SunPKCS11-NSS: Old NSS: \" + ver);\n+                    return; \/\/ OK\n+                } else if (ver > 3.139 && ver < 3.15 && osName.equals(\"Linux\")) {\n+                    \/\/ warn about buggy behaviour on Linux with nss 3.14\n+                    System.out.println(\"Warning: old NSS \" + ver + \" might be problematic, consider upgrading it\");\n+                }\n@@ -319,0 +325,1 @@\n+            throw e;\n","filename":"test\/jdk\/sun\/security\/pkcs11\/Cipher\/TestKATForGCM.java","additions":21,"deletions":14,"binary":false,"changes":35,"status":"modified"}]}