{"files":[{"patch":"@@ -499,5 +499,1 @@\n-        BOOL result = item->m_trayIcon->SendTrayMessage(NIM_ADD);\n-        \/\/ 6270114: Instructs the taskbar to behave according to the Shell version 5.0\n-        if (result) {\n-            item->m_trayIcon->SendTrayMessage(NIM_SETVERSION);\n-        }\n+        item->m_trayIcon->AddTrayIcon();\n@@ -751,1 +747,1 @@\n-    SendTrayMessage(NIM_MODIFY);\n+    ModifyTrayIcon();\n@@ -819,4 +815,4 @@\n-    BOOL result = trayIcon->SendTrayMessage(jupdate == JNI_TRUE ? NIM_MODIFY : NIM_ADD);\n-    \/\/ 6270114: Instructs the taskbar to behave according to the Shell version 5.0\n-    if (result && jupdate == JNI_FALSE) {\n-        trayIcon->SendTrayMessage(NIM_SETVERSION);\n+    if (jupdate == JNI_TRUE) {\n+        trayIcon->ModifyTrayIcon();\n+    } else {\n+        trayIcon->AddTrayIcon();\n@@ -871,1 +867,1 @@\n-    SendTrayMessage(NIM_MODIFY);\n+    ModifyTrayIcon();\n","filename":"src\/java.desktop\/windows\/native\/libawt\/windows\/awt_TrayIcon.cpp","additions":7,"deletions":11,"binary":false,"changes":18,"status":"modified"},{"patch":"@@ -55,1 +55,0 @@\n-    BOOL SendTrayMessage(DWORD dwMessage);\n@@ -157,0 +156,14 @@\n+    BOOL SendTrayMessage(DWORD dwMessage);\n+\n+    INLINE void AddTrayIcon() {\n+        BOOL result = SendTrayMessage(NIM_ADD);\n+        \/\/ 6270114: Instructs the taskbar to behave according to the Shell version 5.0\n+        if (result) {\n+            SendTrayMessage(NIM_SETVERSION);\n+        }\n+    }\n+\n+    INLINE void ModifyTrayIcon() {\n+        SendTrayMessage(NIM_MODIFY);\n+    }\n+\n","filename":"src\/java.desktop\/windows\/native\/libawt\/windows\/awt_TrayIcon.h","additions":14,"deletions":1,"binary":false,"changes":15,"status":"modified"}]}