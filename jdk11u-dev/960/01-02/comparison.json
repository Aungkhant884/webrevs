{"files":[{"patch":"@@ -2,2 +2,2 @@\n-\/\/ Copyright (c) 2003, 2019, Oracle and\/or its affiliates. All rights reserved.\n-\/\/ Copyright (c) 2014, 2019, Red Hat, Inc. All rights reserved.\n+\/\/ Copyright (c) 2003, 2022, Oracle and\/or its affiliates. All rights reserved.\n+\/\/ Copyright (c) 2014, 2022, Red Hat, Inc. All rights reserved.\n@@ -2535,0 +2535,2 @@\n+  \/\/ This encoding class is generated automatically from ad_encode.m4.\n+  \/\/ DO NOT EDIT ANYTHING IN THIS SECTION OF THE FILE\n@@ -2541,0 +2543,2 @@\n+  \/\/ This encoding class is generated automatically from ad_encode.m4.\n+  \/\/ DO NOT EDIT ANYTHING IN THIS SECTION OF THE FILE\n@@ -2547,0 +2551,2 @@\n+  \/\/ This encoding class is generated automatically from ad_encode.m4.\n+  \/\/ DO NOT EDIT ANYTHING IN THIS SECTION OF THE FILE\n@@ -2553,0 +2559,2 @@\n+  \/\/ This encoding class is generated automatically from ad_encode.m4.\n+  \/\/ DO NOT EDIT ANYTHING IN THIS SECTION OF THE FILE\n@@ -2559,0 +2567,2 @@\n+  \/\/ This encoding class is generated automatically from ad_encode.m4.\n+  \/\/ DO NOT EDIT ANYTHING IN THIS SECTION OF THE FILE\n@@ -2565,0 +2575,2 @@\n+  \/\/ This encoding class is generated automatically from ad_encode.m4.\n+  \/\/ DO NOT EDIT ANYTHING IN THIS SECTION OF THE FILE\n@@ -2571,0 +2583,2 @@\n+  \/\/ This encoding class is generated automatically from ad_encode.m4.\n+  \/\/ DO NOT EDIT ANYTHING IN THIS SECTION OF THE FILE\n@@ -2577,0 +2591,2 @@\n+  \/\/ This encoding class is generated automatically from ad_encode.m4.\n+  \/\/ DO NOT EDIT ANYTHING IN THIS SECTION OF THE FILE\n@@ -2583,0 +2599,2 @@\n+  \/\/ This encoding class is generated automatically from ad_encode.m4.\n+  \/\/ DO NOT EDIT ANYTHING IN THIS SECTION OF THE FILE\n@@ -2589,0 +2607,2 @@\n+  \/\/ This encoding class is generated automatically from ad_encode.m4.\n+  \/\/ DO NOT EDIT ANYTHING IN THIS SECTION OF THE FILE\n@@ -2595,0 +2615,2 @@\n+  \/\/ This encoding class is generated automatically from ad_encode.m4.\n+  \/\/ DO NOT EDIT ANYTHING IN THIS SECTION OF THE FILE\n@@ -2601,0 +2623,2 @@\n+  \/\/ This encoding class is generated automatically from ad_encode.m4.\n+  \/\/ DO NOT EDIT ANYTHING IN THIS SECTION OF THE FILE\n@@ -2607,0 +2631,2 @@\n+  \/\/ This encoding class is generated automatically from ad_encode.m4.\n+  \/\/ DO NOT EDIT ANYTHING IN THIS SECTION OF THE FILE\n@@ -2613,0 +2639,2 @@\n+  \/\/ This encoding class is generated automatically from ad_encode.m4.\n+  \/\/ DO NOT EDIT ANYTHING IN THIS SECTION OF THE FILE\n@@ -2619,0 +2647,2 @@\n+  \/\/ This encoding class is generated automatically from ad_encode.m4.\n+  \/\/ DO NOT EDIT ANYTHING IN THIS SECTION OF THE FILE\n@@ -2625,0 +2655,2 @@\n+  \/\/ This encoding class is generated automatically from ad_encode.m4.\n+  \/\/ DO NOT EDIT ANYTHING IN THIS SECTION OF THE FILE\n@@ -2631,0 +2663,2 @@\n+  \/\/ This encoding class is generated automatically from ad_encode.m4.\n+  \/\/ DO NOT EDIT ANYTHING IN THIS SECTION OF THE FILE\n@@ -2637,0 +2671,2 @@\n+  \/\/ This encoding class is generated automatically from ad_encode.m4.\n+  \/\/ DO NOT EDIT ANYTHING IN THIS SECTION OF THE FILE\n@@ -2643,0 +2679,2 @@\n+  \/\/ This encoding class is generated automatically from ad_encode.m4.\n+  \/\/ DO NOT EDIT ANYTHING IN THIS SECTION OF THE FILE\n@@ -2649,0 +2687,2 @@\n+  \/\/ This encoding class is generated automatically from ad_encode.m4.\n+  \/\/ DO NOT EDIT ANYTHING IN THIS SECTION OF THE FILE\n@@ -2656,0 +2696,2 @@\n+  \/\/ This encoding class is generated automatically from ad_encode.m4.\n+  \/\/ DO NOT EDIT ANYTHING IN THIS SECTION OF THE FILE\n@@ -2662,0 +2704,2 @@\n+  \/\/ This encoding class is generated automatically from ad_encode.m4.\n+  \/\/ DO NOT EDIT ANYTHING IN THIS SECTION OF THE FILE\n@@ -2668,0 +2712,2 @@\n+  \/\/ This encoding class is generated automatically from ad_encode.m4.\n+  \/\/ DO NOT EDIT ANYTHING IN THIS SECTION OF THE FILE\n@@ -2674,0 +2720,2 @@\n+  \/\/ This encoding class is generated automatically from ad_encode.m4.\n+  \/\/ DO NOT EDIT ANYTHING IN THIS SECTION OF THE FILE\n@@ -2680,0 +2728,2 @@\n+  \/\/ This encoding class is generated automatically from ad_encode.m4.\n+  \/\/ DO NOT EDIT ANYTHING IN THIS SECTION OF THE FILE\n@@ -2694,0 +2744,2 @@\n+  \/\/ This encoding class is generated automatically from ad_encode.m4.\n+  \/\/ DO NOT EDIT ANYTHING IN THIS SECTION OF THE FILE\n@@ -2700,0 +2752,2 @@\n+  \/\/ This encoding class is generated automatically from ad_encode.m4.\n+  \/\/ DO NOT EDIT ANYTHING IN THIS SECTION OF THE FILE\n@@ -2706,0 +2760,2 @@\n+  \/\/ This encoding class is generated automatically from ad_encode.m4.\n+  \/\/ DO NOT EDIT ANYTHING IN THIS SECTION OF THE FILE\n@@ -2712,0 +2768,2 @@\n+  \/\/ This encoding class is generated automatically from ad_encode.m4.\n+  \/\/ DO NOT EDIT ANYTHING IN THIS SECTION OF THE FILE\n@@ -2718,0 +2776,2 @@\n+  \/\/ This encoding class is generated automatically from ad_encode.m4.\n+  \/\/ DO NOT EDIT ANYTHING IN THIS SECTION OF THE FILE\n@@ -2724,0 +2784,2 @@\n+  \/\/ This encoding class is generated automatically from ad_encode.m4.\n+  \/\/ DO NOT EDIT ANYTHING IN THIS SECTION OF THE FILE\n@@ -2729,1 +2791,1 @@\n-\n+ \n","filename":"src\/hotspot\/cpu\/aarch64\/aarch64.ad","additions":65,"deletions":3,"binary":false,"changes":68,"status":"modified"},{"patch":"@@ -1,1 +1,1 @@\n-dnl Copyright (c) 2014, Red Hat Inc. All rights reserved.\n+dnl Copyright (c) 2014, 2022 Red Hat Inc. All rights reserved.\n@@ -26,3 +26,20 @@\n-define(choose, `loadStore($1, &MacroAssembler::$3, $2, $4,\n-               $5, $6, $7, $8);dnl\n-\n+dnl\n+dnl\n+define(LOAD,`\n+  \/\/ This encoding class is generated automatically from ad_encode.m4.\n+  \/\/ DO NOT EDIT ANYTHING IN THIS SECTION OF THE FILE\n+  enc_class aarch64_enc_$2($1 dst, memory mem) %{\n+    $3Register dst_reg = as_$3Register($dst$$reg);\n+    loadStore(MacroAssembler(&cbuf), &MacroAssembler::$2, dst_reg, $mem->opcode(),\n+               as_Register($mem$$base), $mem$$index, $mem$$scale, $mem$$disp);\n+  %}')dnl\n+dnl\n+dnl\n+dnl\n+define(LOADV,`\n+  \/\/ This encoding class is generated automatically from ad_encode.m4.\n+  \/\/ DO NOT EDIT ANYTHING IN THIS SECTION OF THE FILE\n+  enc_class aarch64_enc_$2($1 dst, memory mem) %{\n+    FloatRegister dst_reg = as_FloatRegister($dst$$reg);\n+    loadStore(MacroAssembler(&cbuf), &MacroAssembler::ldr, dst_reg, MacroAssembler::$3,\n+       $mem->opcode(), as_Register($mem$$base), $mem$$index, $mem$$scale, $mem$$disp);\n@@ -30,21 +47,3 @@\n-define(access, `\n-    $3Register $1_reg = as_$3Register($$1$$reg);\n-    $4choose(MacroAssembler(&cbuf), $1_reg,$2,$mem->opcode(),\n-        as_Register($mem$$base),$mem$$index,$mem$$scale,$mem$$disp)')dnl\n-define(load,`\n-  enc_class aarch64_enc_$2($1 dst, memory mem) %{dnl\n-access(dst,$2,$3)')dnl\n-load(iRegI,ldrsbw)\n-load(iRegI,ldrsb)\n-load(iRegI,ldrb)\n-load(iRegL,ldrb)\n-load(iRegI,ldrshw)\n-load(iRegI,ldrsh)\n-load(iRegI,ldrh)\n-load(iRegL,ldrh)\n-load(iRegI,ldrw)\n-load(iRegL,ldrw)\n-load(iRegL,ldrsw)\n-load(iRegL,ldr)\n-load(vRegF,ldrs,Float)\n-load(vRegD,ldrd,Float)\n+dnl\n+dnl\n+dnl\n@@ -52,2 +51,10 @@\n-  enc_class aarch64_enc_$2($1 src, memory mem) %{dnl\n-access(src,$2,$3,$4)')dnl\n+  \/\/ This encoding class is generated automatically from ad_encode.m4.\n+  \/\/ DO NOT EDIT ANYTHING IN THIS SECTION OF THE FILE\n+  enc_class aarch64_enc_$2($1 src, memory mem) %{\n+    $3Register src_reg = as_$3Register($src$$reg);\n+    $4loadStore(MacroAssembler(&cbuf), &MacroAssembler::$2, src_reg, $mem->opcode(),\n+               as_Register($mem$$base), $mem$$index, $mem$$scale, $mem$$disp);\n+  %}')dnl\n+dnl\n+dnl\n+dnl\n@@ -55,0 +62,24 @@\n+  \/\/ This encoding class is generated automatically from ad_encode.m4.\n+  \/\/ DO NOT EDIT ANYTHING IN THIS SECTION OF THE FILE\n+  enc_class aarch64_enc_$2`'0(memory mem) %{\n+    MacroAssembler _masm(&cbuf);\n+    $4loadStore(_masm, &MacroAssembler::$2, zr, $mem->opcode(),\n+               as_Register($mem$$base), $mem$$index, $mem$$scale, $mem$$disp);\n+  %}')dnl\n+dnl\n+dnl\n+dnl\n+define(STOREL,`\n+  \/\/ This encoding class is generated automatically from ad_encode.m4.\n+  \/\/ DO NOT EDIT ANYTHING IN THIS SECTION OF THE FILE\n+  enc_class aarch64_enc_$2($1 src, memory mem) %{\n+    $3Register src_reg = as_$3Register($src$$reg);\n+    $4loadStore(MacroAssembler(&cbuf), &MacroAssembler::$2, src_reg, $mem->opcode(),\n+               as_Register($mem$$base), $mem$$index, $mem$$scale, $mem$$disp, $5);\n+  %}')dnl\n+dnl\n+dnl\n+dnl\n+define(STOREL0,`\n+  \/\/ This encoding class is generated automatically from ad_encode.m4.\n+  \/\/ DO NOT EDIT ANYTHING IN THIS SECTION OF THE FILE\n@@ -57,2 +88,34 @@\n-    choose(_masm,zr,$2,$mem->opcode(),\n-        as_$3Register($mem$$base),$mem$$index,$mem$$scale,$mem$$disp)')dnl\n+    $4loadStore(_masm, &MacroAssembler::$2, zr, $mem->opcode(),\n+               as_Register($mem$$base), $mem$$index, $mem$$scale, $mem$$disp, $5);\n+  %}')dnl\n+dnl\n+dnl\n+dnl\n+define(STOREV,`\n+  \/\/ This encoding class is generated automatically from ad_encode.m4.\n+  \/\/ DO NOT EDIT ANYTHING IN THIS SECTION OF THE FILE\n+  enc_class aarch64_enc_$2($1 src, memory mem) %{\n+    FloatRegister src_reg = as_FloatRegister($src$$reg);\n+    loadStore(MacroAssembler(&cbuf), &MacroAssembler::str, src_reg, MacroAssembler::$3,\n+       $mem->opcode(), as_Register($mem$$base), $mem$$index, $mem$$scale, $mem$$disp);\n+  %}')dnl\n+dnl\n+dnl\n+dnl\n+LOAD(iRegI,ldrsbw)\n+LOAD(iRegI,ldrsb)\n+LOAD(iRegI,ldrb)\n+LOAD(iRegL,ldrb)\n+LOAD(iRegI,ldrshw)\n+LOAD(iRegI,ldrsh)\n+LOAD(iRegI,ldrh)\n+LOAD(iRegL,ldrh)\n+LOAD(iRegI,ldrw)\n+LOAD(iRegL,ldrw)\n+LOAD(iRegL,ldrsw)\n+LOAD(iRegL,ldr)\n+LOAD(vRegF,ldrs,Float)\n+LOAD(vRegD,ldrd,Float)\n+LOADV(vecD,ldrvS,S)\n+LOADV(vecD,ldrvD,D)\n+LOADV(vecX,ldrvQ,Q)\n@@ -61,5 +124,15 @@\n-STORE(iRegI,strh)\n-STORE0(iRegI,strh)\n-STORE(iRegI,strw)\n-STORE0(iRegI,strw)\n-STORE(iRegL,str,,\n+\n+  \/\/ This encoding class is generated automatically from ad_encode.m4.\n+  \/\/ DO NOT EDIT ANYTHING IN THIS SECTION OF THE FILE\n+  enc_class aarch64_enc_strb0_ordered(memory mem) %{\n+    MacroAssembler _masm(&cbuf);\n+    __ membar(Assembler::StoreStore);\n+    loadStore(_masm, &MacroAssembler::strb, zr, $mem->opcode(),\n+               as_Register($mem$$base), $mem$$index, $mem$$scale, $mem$$disp);\n+  %}dnl\n+\n+STOREL(iRegI,strh,,,2)\n+STOREL0(iRegI,strh,,,2)\n+STOREL(iRegI,strw,,,4)\n+STOREL0(iRegI,strw,,,4)\n+STOREL(iRegL,str,,\n@@ -74,2 +147,2 @@\n-    ')\n-STORE0(iRegL,str)\n+    ',8)\n+STOREL0(iRegL,str,,,8)\n@@ -78,21 +151,3 @@\n-\n-  enc_class aarch64_enc_strw_immn(immN src, memory mem) %{\n-    MacroAssembler _masm(&cbuf);\n-    address con = (address)$src$$constant;\n-    \/\/ need to do this the hard way until we can manage relocs\n-    \/\/ for 32 bit constants\n-    __ movoop(rscratch2, (jobject)con);\n-    if (con) __ encode_heap_oop_not_null(rscratch2);\n-    choose(_masm,rscratch2,strw,$mem->opcode(),\n-        as_Register($mem$$base),$mem$$index,$mem$$scale,$mem$$disp)\n-\n-  enc_class aarch64_enc_strw_immnk(immN src, memory mem) %{\n-    MacroAssembler _masm(&cbuf);\n-    address con = (address)$src$$constant;\n-    \/\/ need to do this the hard way until we can manage relocs\n-    \/\/ for 32 bit constants\n-    __ movoop(rscratch2, (jobject)con);\n-    __ encode_klass_not_null(rscratch2);\n-    choose(_masm,rscratch2,strw,$mem->opcode(),\n-        as_Register($mem$$base),$mem$$index,$mem$$scale,$mem$$disp)\n-\n+STOREV(vecD,strvS,S)\n+STOREV(vecD,strvD,D)\n+STOREV(vecX,strvQ,Q)\n","filename":"src\/hotspot\/cpu\/aarch64\/ad_encode.m4","additions":112,"deletions":57,"binary":false,"changes":169,"status":"modified"}]}