{"files":[{"patch":"@@ -524,1 +524,1 @@\n-  declare_constant(Deoptimization::Reason_LIMIT)                          \\\n+  declare_constant(Deoptimization::Reason_TRAP_HISTORY_LENGTH)            \\\n","filename":"src\/hotspot\/share\/jvmci\/vmStructs_jvmci.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -34,0 +34,1 @@\n+#include \"runtime\/deoptimization.hpp\"\n@@ -1986,1 +1987,1 @@\n-    _trap_hist_limit    = 24 JVMCI_ONLY(+5),   \/\/ decoupled from Deoptimization::Reason_LIMIT\n+    _trap_hist_limit    = Deoptimization::Reason_TRAP_HISTORY_LENGTH,\n@@ -2002,0 +2003,1 @@\n+      \/\/ JVMCI separates trap history for OSR compilations from normal compilations\n@@ -2024,1 +2026,1 @@\n-      assert((uint)reason < JVMCI_ONLY(2*) _trap_hist_limit, \"oob\");\n+      assert((uint)reason < ARRAY_SIZE(_trap_hist._array), \"oob\");\n@@ -2031,1 +2033,1 @@\n-      assert((uint)reason < JVMCI_ONLY(2*) _trap_hist_limit, \"oob\");\n+      assert((uint)reason < ARRAY_SIZE(_trap_hist._array), \"oob\");\n","filename":"src\/hotspot\/share\/oops\/methodData.hpp","additions":5,"deletions":3,"binary":false,"changes":8,"status":"modified"},{"patch":"@@ -1994,1 +1994,2 @@\n-      idx += Reason_LIMIT;\n+      \/\/ Upper half of history array used for traps in OSR compilations\n+      idx += Reason_TRAP_HISTORY_LENGTH;\n","filename":"src\/hotspot\/share\/runtime\/deoptimization.cpp","additions":2,"deletions":1,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -41,0 +41,1 @@\n+  \/\/ Note: Keep this enum in sync. with Deoptimization::_trap_reason_name.\n@@ -91,0 +92,3 @@\n+    \/\/ Used to define MethodData::_trap_hist_limit where Reason_tenured isn't included\n+    Reason_TRAP_HISTORY_LENGTH,\n+\n@@ -92,2 +96,1 @@\n-    \/\/ Related to MethodData::_trap_hist_limit where Reason_tenured isn't included\n-    Reason_tenured,               \/\/ age of the code has reached the limit\n+    Reason_tenured = Reason_TRAP_HISTORY_LENGTH, \/\/ age of the code has reached the limit\n@@ -96,2 +99,0 @@\n-    \/\/ Note:  Keep this enum in sync. with _trap_reason_name.\n-    Reason_RECORDED_LIMIT = Reason_profile_predicate  \/\/ some are not recorded per bc\n@@ -102,0 +103,1 @@\n+    Reason_RECORDED_LIMIT = Reason_profile_predicate,  \/\/ some are not recorded per bc\n@@ -105,0 +107,1 @@\n+  \/\/ Note: Keep this enum in sync. with Deoptimization::_trap_action_name.\n@@ -112,1 +115,0 @@\n-    \/\/ Note:  Keep this enum in sync. with _trap_action_name.\n","filename":"src\/hotspot\/share\/runtime\/deoptimization.hpp","additions":7,"deletions":5,"binary":false,"changes":12,"status":"modified"},{"patch":"@@ -326,1 +326,1 @@\n-    final int deoptReasonOSROffset = getConstant(\"Deoptimization::Reason_LIMIT\", Integer.class);\n+    final int deoptReasonOSROffset = getConstant(\"Deoptimization::Reason_TRAP_HISTORY_LENGTH\", Integer.class);\n","filename":"src\/jdk.internal.vm.ci\/share\/classes\/jdk.vm.ci.hotspot\/src\/jdk\/vm\/ci\/hotspot\/HotSpotVMConfig.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"}]}