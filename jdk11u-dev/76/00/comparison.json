{"files":[{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2002, 2018, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2002, 2019, Oracle and\/or its affiliates. All rights reserved.\n@@ -59,1 +59,2 @@\n-    \/\/ 2. Prefer the stronger bulk cipher, in the order of AES_256(GCM),\n+    \/\/ 2. Prefer forward secrecy cipher suites.\n+    \/\/ 3. Prefer the stronger bulk cipher, in the order of AES_256(GCM),\n@@ -61,1 +62,1 @@\n-    \/\/ 3. Prefer the stronger MAC algorithm, in the order of SHA384,\n+    \/\/ 4. Prefer the stronger MAC algorithm, in the order of SHA384,\n@@ -63,1 +64,1 @@\n-    \/\/ 4. Prefer the better performance of key exchange and digital\n+    \/\/ 5. Prefer the better performance of key exchange and digital\n@@ -65,1 +66,1 @@\n-    \/\/    RSA, ECDH-ECDSA, ECDH-RSA, DHE-RSA, DHE-DSS.\n+    \/\/    DHE-RSA, DHE-DSS, ECDH-ECDSA, ECDH-RSA, RSA.\n@@ -67,3 +68,1 @@\n-    TLS_AES_128_GCM_SHA256(\n-            0x1301, true, \"TLS_AES_128_GCM_SHA256\",\n-            ProtocolVersion.PROTOCOLS_OF_13, B_AES_128_GCM_IV, H_SHA256),\n+    \/\/ TLS 1.3 cipher suites.\n@@ -73,0 +72,3 @@\n+    TLS_AES_128_GCM_SHA256(\n+            0x1301, true, \"TLS_AES_128_GCM_SHA256\",\n+            ProtocolVersion.PROTOCOLS_OF_13, B_AES_128_GCM_IV, H_SHA256),\n@@ -104,1 +106,5 @@\n-    \/\/ AES_256(GCM)\n+    \/\/\n+    \/\/ Forward screcy cipher suites.\n+    \/\/\n+\n+    \/\/ AES_256(GCM) - ECDHE\n@@ -113,10 +119,4 @@\n-    TLS_RSA_WITH_AES_256_GCM_SHA384(\n-            0x009D, true, \"TLS_RSA_WITH_AES_256_GCM_SHA384\", \"\",\n-            ProtocolVersion.PROTOCOLS_OF_12,\n-            K_RSA, B_AES_256_GCM, M_NULL, H_SHA384),\n-    TLS_ECDH_ECDSA_WITH_AES_256_GCM_SHA384(\n-            0xC02E, true, \"TLS_ECDH_ECDSA_WITH_AES_256_GCM_SHA384\", \"\",\n-            ProtocolVersion.PROTOCOLS_OF_12,\n-            K_ECDH_ECDSA, B_AES_256_GCM, M_NULL, H_SHA384),\n-    TLS_ECDH_RSA_WITH_AES_256_GCM_SHA384(\n-            0xC032, true, \"TLS_ECDH_RSA_WITH_AES_256_GCM_SHA384\", \"\",\n+\n+    \/\/ AES_128(GCM) - ECDHE\n+    TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256(\n+            0xC02F, true, \"TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256\", \"\",\n@@ -124,1 +124,3 @@\n-            K_ECDH_RSA, B_AES_256_GCM, M_NULL, H_SHA384),\n+            K_ECDHE_RSA, B_AES_128_GCM, M_NULL, H_SHA256),\n+\n+    \/\/ AES_256(GCM) - DHE\n@@ -138,17 +140,1 @@\n-    \/\/ AES_128(GCM)\n-    TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256(\n-            0xC02F, true, \"TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256\", \"\",\n-            ProtocolVersion.PROTOCOLS_OF_12,\n-            K_ECDHE_RSA, B_AES_128_GCM, M_NULL, H_SHA256),\n-    TLS_RSA_WITH_AES_128_GCM_SHA256(\n-            0x009C, true, \"TLS_RSA_WITH_AES_128_GCM_SHA256\", \"\",\n-            ProtocolVersion.PROTOCOLS_OF_12,\n-            K_RSA, B_AES_128_GCM, M_NULL, H_SHA256),\n-    TLS_ECDH_ECDSA_WITH_AES_128_GCM_SHA256(\n-            0xC02D, true, \"TLS_ECDH_ECDSA_WITH_AES_128_GCM_SHA256\", \"\",\n-            ProtocolVersion.PROTOCOLS_OF_12,\n-            K_ECDH_ECDSA, B_AES_128_GCM, M_NULL, H_SHA256),\n-    TLS_ECDH_RSA_WITH_AES_128_GCM_SHA256(\n-            0xC031, true, \"TLS_ECDH_RSA_WITH_AES_128_GCM_SHA256\", \"\",\n-            ProtocolVersion.PROTOCOLS_OF_12,\n-            K_ECDH_RSA, B_AES_128_GCM, M_NULL, H_SHA256),\n+    \/\/ AES_128(GCM) - DHE\n@@ -164,1 +150,1 @@\n-    \/\/ AES_256(CBC)\n+    \/\/ AES_256(CBC) - ECDHE\n@@ -173,2 +159,4 @@\n-    TLS_RSA_WITH_AES_256_CBC_SHA256(\n-            0x003D, true, \"TLS_RSA_WITH_AES_256_CBC_SHA256\", \"\",\n+\n+    \/\/ AES_128(CBC) - ECDHE\n+    TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256(\n+            0xC023, true, \"TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256\", \"\",\n@@ -176,1 +164,51 @@\n-            K_RSA, B_AES_256, M_SHA256, H_SHA256),\n+            K_ECDHE_ECDSA, B_AES_128, M_SHA256, H_SHA256),\n+    TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256(\n+            0xC027, true, \"TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256\", \"\",\n+            ProtocolVersion.PROTOCOLS_OF_12,\n+            K_ECDHE_RSA, B_AES_128, M_SHA256, H_SHA256),\n+\n+    \/\/ AES_256(CBC) - DHE\n+    TLS_DHE_RSA_WITH_AES_256_CBC_SHA256(\n+            0x006B, true, \"TLS_DHE_RSA_WITH_AES_256_CBC_SHA256\", \"\",\n+            ProtocolVersion.PROTOCOLS_OF_12,\n+            K_DHE_RSA, B_AES_256, M_SHA256, H_SHA256),\n+    TLS_DHE_DSS_WITH_AES_256_CBC_SHA256(\n+            0x006A, true, \"TLS_DHE_DSS_WITH_AES_256_CBC_SHA256\", \"\",\n+            ProtocolVersion.PROTOCOLS_OF_12,\n+            K_DHE_DSS, B_AES_256, M_SHA256, H_SHA256),\n+\n+    \/\/ AES_128(CBC) - DHE\n+    TLS_DHE_RSA_WITH_AES_128_CBC_SHA256(\n+            0x0067, true, \"TLS_DHE_RSA_WITH_AES_128_CBC_SHA256\", \"\",\n+            ProtocolVersion.PROTOCOLS_OF_12,\n+            K_DHE_RSA, B_AES_128, M_SHA256, H_SHA256),\n+    TLS_DHE_DSS_WITH_AES_128_CBC_SHA256(\n+            0x0040, true, \"TLS_DHE_DSS_WITH_AES_128_CBC_SHA256\", \"\",\n+            ProtocolVersion.PROTOCOLS_OF_12,\n+            K_DHE_DSS, B_AES_128, M_SHA256, H_SHA256),\n+\n+    \/\/\n+    \/\/ not forward screcy cipher suites.\n+    \/\/\n+\n+    \/\/ AES_256(GCM)\n+    TLS_ECDH_ECDSA_WITH_AES_256_GCM_SHA384(\n+            0xC02E, true, \"TLS_ECDH_ECDSA_WITH_AES_256_GCM_SHA384\", \"\",\n+            ProtocolVersion.PROTOCOLS_OF_12,\n+            K_ECDH_ECDSA, B_AES_256_GCM, M_NULL, H_SHA384),\n+    TLS_ECDH_RSA_WITH_AES_256_GCM_SHA384(\n+            0xC032, true, \"TLS_ECDH_RSA_WITH_AES_256_GCM_SHA384\", \"\",\n+            ProtocolVersion.PROTOCOLS_OF_12,\n+            K_ECDH_RSA, B_AES_256_GCM, M_NULL, H_SHA384),\n+\n+    \/\/ AES_128(GCM)\n+    TLS_ECDH_ECDSA_WITH_AES_128_GCM_SHA256(\n+            0xC02D, true, \"TLS_ECDH_ECDSA_WITH_AES_128_GCM_SHA256\", \"\",\n+            ProtocolVersion.PROTOCOLS_OF_12,\n+            K_ECDH_ECDSA, B_AES_128_GCM, M_NULL, H_SHA256),\n+    TLS_ECDH_RSA_WITH_AES_128_GCM_SHA256(\n+            0xC031, true, \"TLS_ECDH_RSA_WITH_AES_128_GCM_SHA256\", \"\",\n+            ProtocolVersion.PROTOCOLS_OF_12,\n+            K_ECDH_RSA, B_AES_128_GCM, M_NULL, H_SHA256),\n+\n+    \/\/ AES_256(CBC)\n@@ -185,2 +223,4 @@\n-    TLS_DHE_RSA_WITH_AES_256_CBC_SHA256(\n-            0x006B, true, \"TLS_DHE_RSA_WITH_AES_256_CBC_SHA256\", \"\",\n+\n+    \/\/ AES_128(CBC)\n+    TLS_ECDH_ECDSA_WITH_AES_128_CBC_SHA256(\n+            0xC025, true, \"TLS_ECDH_ECDSA_WITH_AES_128_CBC_SHA256\", \"\",\n@@ -188,3 +228,3 @@\n-            K_DHE_RSA, B_AES_256, M_SHA256, H_SHA256),\n-    TLS_DHE_DSS_WITH_AES_256_CBC_SHA256(\n-            0x006A, true, \"TLS_DHE_DSS_WITH_AES_256_CBC_SHA256\", \"\",\n+            K_ECDH_ECDSA, B_AES_128, M_SHA256, H_SHA256),\n+    TLS_ECDH_RSA_WITH_AES_128_CBC_SHA256(\n+            0xC029, true, \"TLS_ECDH_RSA_WITH_AES_128_CBC_SHA256\", \"\",\n@@ -192,1 +232,5 @@\n-            K_DHE_DSS, B_AES_256, M_SHA256, H_SHA256),\n+            K_ECDH_RSA, B_AES_128, M_SHA256, H_SHA256),\n+\n+    \/\/\n+    \/\/ Legacy, used for compatibility\n+    \/\/\n@@ -194,0 +238,1 @@\n+    \/\/ AES_256(CBC) - ECDHE - Using SHA\n@@ -202,6 +247,4 @@\n-    TLS_RSA_WITH_AES_256_CBC_SHA(\n-            0x0035, true, \"TLS_RSA_WITH_AES_256_CBC_SHA\", \"\",\n-            ProtocolVersion.PROTOCOLS_TO_12,\n-            K_RSA, B_AES_256, M_SHA, H_SHA256),\n-    TLS_ECDH_ECDSA_WITH_AES_256_CBC_SHA(\n-            0xC005, true, \"TLS_ECDH_ECDSA_WITH_AES_256_CBC_SHA\", \"\",\n+\n+    \/\/ AES_128(CBC) - ECDHE - using SHA\n+    TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA(\n+            0xC009, true, \"TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA\", \"\",\n@@ -209,3 +252,3 @@\n-            K_ECDH_ECDSA, B_AES_256, M_SHA, H_SHA256),\n-    TLS_ECDH_RSA_WITH_AES_256_CBC_SHA(\n-            0xC00F, true, \"TLS_ECDH_RSA_WITH_AES_256_CBC_SHA\", \"\",\n+            K_ECDHE_ECDSA, B_AES_128, M_SHA, H_SHA256),\n+    TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA(\n+            0xC013, true, \"TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA\", \"\",\n@@ -213,1 +256,3 @@\n-            K_ECDH_RSA, B_AES_256, M_SHA, H_SHA256),\n+            K_ECDHE_RSA, B_AES_128, M_SHA, H_SHA256),\n+\n+    \/\/ AES_256(CBC) - DHE - Using SHA\n@@ -223,32 +268,3 @@\n-    \/\/ AES_128(CBC)\n-    TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256(\n-            0xC023, true, \"TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256\", \"\",\n-            ProtocolVersion.PROTOCOLS_OF_12,\n-            K_ECDHE_ECDSA, B_AES_128, M_SHA256, H_SHA256),\n-    TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256(\n-            0xC027, true, \"TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256\", \"\",\n-            ProtocolVersion.PROTOCOLS_OF_12,\n-            K_ECDHE_RSA, B_AES_128, M_SHA256, H_SHA256),\n-    TLS_RSA_WITH_AES_128_CBC_SHA256(\n-            0x003C, true, \"TLS_RSA_WITH_AES_128_CBC_SHA256\", \"\",\n-            ProtocolVersion.PROTOCOLS_OF_12,\n-            K_RSA, B_AES_128, M_SHA256, H_SHA256),\n-    TLS_ECDH_ECDSA_WITH_AES_128_CBC_SHA256(\n-            0xC025, true, \"TLS_ECDH_ECDSA_WITH_AES_128_CBC_SHA256\", \"\",\n-            ProtocolVersion.PROTOCOLS_OF_12,\n-            K_ECDH_ECDSA, B_AES_128, M_SHA256, H_SHA256),\n-    TLS_ECDH_RSA_WITH_AES_128_CBC_SHA256(\n-            0xC029, true, \"TLS_ECDH_RSA_WITH_AES_128_CBC_SHA256\", \"\",\n-            ProtocolVersion.PROTOCOLS_OF_12,\n-            K_ECDH_RSA, B_AES_128, M_SHA256, H_SHA256),\n-    TLS_DHE_RSA_WITH_AES_128_CBC_SHA256(\n-            0x0067, true, \"TLS_DHE_RSA_WITH_AES_128_CBC_SHA256\", \"\",\n-            ProtocolVersion.PROTOCOLS_OF_12,\n-            K_DHE_RSA, B_AES_128, M_SHA256, H_SHA256),\n-    TLS_DHE_DSS_WITH_AES_128_CBC_SHA256(\n-            0x0040, true, \"TLS_DHE_DSS_WITH_AES_128_CBC_SHA256\", \"\",\n-            ProtocolVersion.PROTOCOLS_OF_12,\n-            K_DHE_DSS, B_AES_128, M_SHA256, H_SHA256),\n-\n-    TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA(\n-            0xC009, true, \"TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA\", \"\",\n+    \/\/ AES_128(CBC) - DHE - using SHA\n+    TLS_DHE_RSA_WITH_AES_128_CBC_SHA(\n+            0x0033, true, \"TLS_DHE_RSA_WITH_AES_128_CBC_SHA\", \"\",\n@@ -256,3 +272,3 @@\n-            K_ECDHE_ECDSA, B_AES_128, M_SHA, H_SHA256),\n-    TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA(\n-            0xC013, true, \"TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA\", \"\",\n+            K_DHE_RSA, B_AES_128, M_SHA, H_SHA256),\n+    TLS_DHE_DSS_WITH_AES_128_CBC_SHA(\n+            0x0032, true, \"TLS_DHE_DSS_WITH_AES_128_CBC_SHA\", \"\",\n@@ -260,3 +276,5 @@\n-            K_ECDHE_RSA, B_AES_128, M_SHA, H_SHA256),\n-    TLS_RSA_WITH_AES_128_CBC_SHA(\n-            0x002F, true, \"TLS_RSA_WITH_AES_128_CBC_SHA\", \"\",\n+            K_DHE_DSS, B_AES_128, M_SHA, H_SHA256),\n+\n+    \/\/ AES_256(CBC) - using SHA, not forward screcy\n+    TLS_ECDH_ECDSA_WITH_AES_256_CBC_SHA(\n+            0xC005, true, \"TLS_ECDH_ECDSA_WITH_AES_256_CBC_SHA\", \"\",\n@@ -264,1 +282,7 @@\n-            K_RSA, B_AES_128, M_SHA, H_SHA256),\n+            K_ECDH_ECDSA, B_AES_256, M_SHA, H_SHA256),\n+    TLS_ECDH_RSA_WITH_AES_256_CBC_SHA(\n+            0xC00F, true, \"TLS_ECDH_RSA_WITH_AES_256_CBC_SHA\", \"\",\n+            ProtocolVersion.PROTOCOLS_TO_12,\n+            K_ECDH_RSA, B_AES_256, M_SHA, H_SHA256),\n+\n+    \/\/ AES_128(CBC) - using SHA, not forward screcy\n@@ -273,2 +297,32 @@\n-    TLS_DHE_RSA_WITH_AES_128_CBC_SHA(\n-            0x0033, true, \"TLS_DHE_RSA_WITH_AES_128_CBC_SHA\", \"\",\n+\n+    \/\/\n+    \/\/ deprecated, used for compatibility\n+    \/\/\n+\n+    \/\/ RSA, AES_256(GCM)\n+    TLS_RSA_WITH_AES_256_GCM_SHA384(\n+            0x009D, true, \"TLS_RSA_WITH_AES_256_GCM_SHA384\", \"\",\n+            ProtocolVersion.PROTOCOLS_OF_12,\n+            K_RSA, B_AES_256_GCM, M_NULL, H_SHA384),\n+\n+    \/\/ RSA, AES_128(GCM)\n+    TLS_RSA_WITH_AES_128_GCM_SHA256(\n+            0x009C, true, \"TLS_RSA_WITH_AES_128_GCM_SHA256\", \"\",\n+            ProtocolVersion.PROTOCOLS_OF_12,\n+            K_RSA, B_AES_128_GCM, M_NULL, H_SHA256),\n+\n+    \/\/ RSA, AES_256(CBC)\n+    TLS_RSA_WITH_AES_256_CBC_SHA256(\n+            0x003D, true, \"TLS_RSA_WITH_AES_256_CBC_SHA256\", \"\",\n+            ProtocolVersion.PROTOCOLS_OF_12,\n+            K_RSA, B_AES_256, M_SHA256, H_SHA256),\n+\n+    \/\/ RSA, AES_128(CBC)\n+    TLS_RSA_WITH_AES_128_CBC_SHA256(\n+            0x003C, true, \"TLS_RSA_WITH_AES_128_CBC_SHA256\", \"\",\n+            ProtocolVersion.PROTOCOLS_OF_12,\n+            K_RSA, B_AES_128, M_SHA256, H_SHA256),\n+\n+    \/\/ RSA, AES_256(CBC) - using SHA, not forward screcy\n+    TLS_RSA_WITH_AES_256_CBC_SHA(\n+            0x0035, true, \"TLS_RSA_WITH_AES_256_CBC_SHA\", \"\",\n@@ -276,3 +330,5 @@\n-            K_DHE_RSA, B_AES_128, M_SHA, H_SHA256),\n-    TLS_DHE_DSS_WITH_AES_128_CBC_SHA(\n-            0x0032, true, \"TLS_DHE_DSS_WITH_AES_128_CBC_SHA\", \"\",\n+            K_RSA, B_AES_256, M_SHA, H_SHA256),\n+\n+    \/\/ RSA, AES_128(CBC) - using SHA, not forward screcy\n+    TLS_RSA_WITH_AES_128_CBC_SHA(\n+            0x002F, true, \"TLS_RSA_WITH_AES_128_CBC_SHA\", \"\",\n@@ -280,1 +336,1 @@\n-            K_DHE_DSS, B_AES_128, M_SHA, H_SHA256),\n+            K_RSA, B_AES_128, M_SHA, H_SHA256),\n@@ -282,1 +338,1 @@\n-    \/\/ 3DES_EDE\n+    \/\/ 3DES_EDE, forward secrecy.\n@@ -291,13 +347,0 @@\n-    SSL_RSA_WITH_3DES_EDE_CBC_SHA(\n-            0x000A, true, \"SSL_RSA_WITH_3DES_EDE_CBC_SHA\",\n-                          \"TLS_RSA_WITH_3DES_EDE_CBC_SHA\",\n-            ProtocolVersion.PROTOCOLS_TO_12,\n-            K_RSA, B_3DES, M_SHA, H_SHA256),\n-    TLS_ECDH_ECDSA_WITH_3DES_EDE_CBC_SHA(\n-            0xC003, true, \"TLS_ECDH_ECDSA_WITH_3DES_EDE_CBC_SHA\", \"\",\n-            ProtocolVersion.PROTOCOLS_TO_12,\n-            K_ECDH_ECDSA, B_3DES, M_SHA, H_SHA256),\n-    TLS_ECDH_RSA_WITH_3DES_EDE_CBC_SHA(\n-            0xC00D, true, \"TLS_ECDH_RSA_WITH_3DES_EDE_CBC_SHA\", \"\",\n-            ProtocolVersion.PROTOCOLS_TO_12,\n-            K_ECDH_RSA, B_3DES, M_SHA, H_SHA256),\n@@ -315,0 +358,15 @@\n+    \/\/ 3DES_EDE, not forward secrecy.\n+    TLS_ECDH_ECDSA_WITH_3DES_EDE_CBC_SHA(\n+            0xC003, true, \"TLS_ECDH_ECDSA_WITH_3DES_EDE_CBC_SHA\", \"\",\n+            ProtocolVersion.PROTOCOLS_TO_12,\n+            K_ECDH_ECDSA, B_3DES, M_SHA, H_SHA256),\n+    TLS_ECDH_RSA_WITH_3DES_EDE_CBC_SHA(\n+            0xC00D, true, \"TLS_ECDH_RSA_WITH_3DES_EDE_CBC_SHA\", \"\",\n+            ProtocolVersion.PROTOCOLS_TO_12,\n+            K_ECDH_RSA, B_3DES, M_SHA, H_SHA256),\n+    SSL_RSA_WITH_3DES_EDE_CBC_SHA(\n+            0x000A, true, \"SSL_RSA_WITH_3DES_EDE_CBC_SHA\",\n+                          \"TLS_RSA_WITH_3DES_EDE_CBC_SHA\",\n+            ProtocolVersion.PROTOCOLS_TO_12,\n+            K_RSA, B_3DES, M_SHA, H_SHA256),\n+\n","filename":"src\/java.base\/share\/classes\/sun\/security\/ssl\/CipherSuite.java","additions":174,"deletions":116,"binary":false,"changes":290,"status":"modified"},{"patch":"@@ -26,1 +26,1 @@\n- * @bug 4750141 4895631 8217579\n+ * @bug 4750141 4895631 8217579 8163326\n@@ -28,1 +28,1 @@\n- * @run main CheckCipherSuites default\n+ * @run main\/othervm CheckCipherSuites default\n@@ -41,1 +41,1 @@\n-        \"TLS_AES_128_GCM_SHA256\",\n+        \/\/ TLS 1.3 cipher suites\n@@ -43,0 +43,1 @@\n+        \"TLS_AES_128_GCM_SHA256\",\n@@ -44,0 +45,2 @@\n+\n+        \/\/ Suite B compliant cipher suites\n@@ -46,0 +49,2 @@\n+\n+        \/\/ Not suite B, but we want it to position the suite early\n@@ -47,0 +52,2 @@\n+\n+        \/\/ AES_256(GCM) - ECDHE - forward screcy\n@@ -49,3 +56,5 @@\n-        \"TLS_RSA_WITH_AES_256_GCM_SHA384\",\n-        \"TLS_ECDH_ECDSA_WITH_AES_256_GCM_SHA384\",\n-        \"TLS_ECDH_RSA_WITH_AES_256_GCM_SHA384\",\n+\n+        \/\/ AES_128(GCM) - ECDHE - forward screcy\n+        \"TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256\",\n+\n+        \/\/ AES_256(GCM) - DHE - forward screcy\n@@ -55,4 +64,2 @@\n-        \"TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256\",\n-        \"TLS_RSA_WITH_AES_128_GCM_SHA256\",\n-        \"TLS_ECDH_ECDSA_WITH_AES_128_GCM_SHA256\",\n-        \"TLS_ECDH_RSA_WITH_AES_128_GCM_SHA256\",\n+\n+        \/\/ AES_128(GCM) - DHE - forward screcy\n@@ -61,0 +68,2 @@\n+\n+        \/\/ AES_256(CBC) - ECDHE - forward screcy\n@@ -63,12 +72,2 @@\n-        \"TLS_RSA_WITH_AES_256_CBC_SHA256\",\n-        \"TLS_ECDH_ECDSA_WITH_AES_256_CBC_SHA384\",\n-        \"TLS_ECDH_RSA_WITH_AES_256_CBC_SHA384\",\n-        \"TLS_DHE_RSA_WITH_AES_256_CBC_SHA256\",\n-        \"TLS_DHE_DSS_WITH_AES_256_CBC_SHA256\",\n-        \"TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA\",\n-        \"TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA\",\n-        \"TLS_RSA_WITH_AES_256_CBC_SHA\",\n-        \"TLS_ECDH_ECDSA_WITH_AES_256_CBC_SHA\",\n-        \"TLS_ECDH_RSA_WITH_AES_256_CBC_SHA\",\n-        \"TLS_DHE_RSA_WITH_AES_256_CBC_SHA\",\n-        \"TLS_DHE_DSS_WITH_AES_256_CBC_SHA\",\n+\n+        \/\/ AES_256(CBC) - ECDHE - forward screcy\n@@ -77,3 +76,6 @@\n-        \"TLS_RSA_WITH_AES_128_CBC_SHA256\",\n-        \"TLS_ECDH_ECDSA_WITH_AES_128_CBC_SHA256\",\n-        \"TLS_ECDH_RSA_WITH_AES_128_CBC_SHA256\",\n+\n+        \/\/ AES_256(CBC) - DHE - forward screcy\n+        \"TLS_DHE_RSA_WITH_AES_256_CBC_SHA256\",\n+        \"TLS_DHE_DSS_WITH_AES_256_CBC_SHA256\",\n+\n+        \/\/ AES_128(CBC) - DHE - forward screcy\n@@ -82,0 +84,22 @@\n+\n+        \/\/ AES_256(GCM) - not forward screcy\n+        \"TLS_ECDH_ECDSA_WITH_AES_256_GCM_SHA384\",\n+        \"TLS_ECDH_RSA_WITH_AES_256_GCM_SHA384\",\n+\n+        \/\/ AES_128(GCM) - not forward screcy\n+        \"TLS_ECDH_ECDSA_WITH_AES_128_GCM_SHA256\",\n+        \"TLS_ECDH_RSA_WITH_AES_128_GCM_SHA256\",\n+\n+        \/\/ AES_256(CBC) - not forward screcy\n+        \"TLS_ECDH_ECDSA_WITH_AES_256_CBC_SHA384\",\n+        \"TLS_ECDH_RSA_WITH_AES_256_CBC_SHA384\",\n+\n+        \/\/ AES_128(CBC) - not forward screcy\n+        \"TLS_ECDH_ECDSA_WITH_AES_128_CBC_SHA256\",\n+        \"TLS_ECDH_RSA_WITH_AES_128_CBC_SHA256\",\n+\n+        \/\/ AES_256(CBC) - ECDHE - using SHA\n+        \"TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA\",\n+        \"TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA\",\n+\n+        \/\/ AES_128(CBC) - ECDHE - using SHA\n@@ -84,3 +108,6 @@\n-        \"TLS_RSA_WITH_AES_128_CBC_SHA\",\n-        \"TLS_ECDH_ECDSA_WITH_AES_128_CBC_SHA\",\n-        \"TLS_ECDH_RSA_WITH_AES_128_CBC_SHA\",\n+\n+        \/\/ AES_256(CBC) - DHE - using SHA\n+        \"TLS_DHE_RSA_WITH_AES_256_CBC_SHA\",\n+        \"TLS_DHE_DSS_WITH_AES_256_CBC_SHA\",\n+\n+        \/\/ AES_128(CBC) - DHE - using SHA\n@@ -89,0 +116,16 @@\n+\n+        \/\/ AES_256(CBC) - using SHA, not forward screcy\n+        \"TLS_ECDH_ECDSA_WITH_AES_256_CBC_SHA\",\n+        \"TLS_ECDH_RSA_WITH_AES_256_CBC_SHA\",\n+\n+        \/\/ AES_128(CBC) - using SHA, not forward screcy\n+        \"TLS_ECDH_ECDSA_WITH_AES_128_CBC_SHA\",\n+        \"TLS_ECDH_RSA_WITH_AES_128_CBC_SHA\",\n+\n+        \/\/ deprecated\n+        \"TLS_RSA_WITH_AES_256_GCM_SHA384\",\n+        \"TLS_RSA_WITH_AES_128_GCM_SHA256\",\n+        \"TLS_RSA_WITH_AES_256_CBC_SHA256\",\n+        \"TLS_RSA_WITH_AES_128_CBC_SHA256\",\n+        \"TLS_RSA_WITH_AES_256_CBC_SHA\",\n+        \"TLS_RSA_WITH_AES_128_CBC_SHA\",\n@@ -98,3 +141,0 @@\n-        \"TLS_RSA_WITH_AES_128_GCM_SHA256\",\n-        \"TLS_ECDH_ECDSA_WITH_AES_128_GCM_SHA256\",\n-        \"TLS_ECDH_RSA_WITH_AES_128_GCM_SHA256\",\n@@ -105,3 +145,0 @@\n-        \"TLS_RSA_WITH_AES_128_CBC_SHA256\",\n-        \"TLS_ECDH_ECDSA_WITH_AES_128_CBC_SHA256\",\n-        \"TLS_ECDH_RSA_WITH_AES_128_CBC_SHA256\",\n@@ -110,0 +147,4 @@\n+        \"TLS_ECDH_ECDSA_WITH_AES_128_GCM_SHA256\",\n+        \"TLS_ECDH_RSA_WITH_AES_128_GCM_SHA256\",\n+        \"TLS_ECDH_ECDSA_WITH_AES_128_CBC_SHA256\",\n+        \"TLS_ECDH_RSA_WITH_AES_128_CBC_SHA256\",\n@@ -112,3 +153,0 @@\n-        \"TLS_RSA_WITH_AES_128_CBC_SHA\",\n-        \"TLS_ECDH_ECDSA_WITH_AES_128_CBC_SHA\",\n-        \"TLS_ECDH_RSA_WITH_AES_128_CBC_SHA\",\n@@ -117,0 +155,5 @@\n+        \"TLS_ECDH_ECDSA_WITH_AES_128_CBC_SHA\",\n+        \"TLS_ECDH_RSA_WITH_AES_128_CBC_SHA\",\n+        \"TLS_RSA_WITH_AES_128_GCM_SHA256\",\n+        \"TLS_RSA_WITH_AES_128_CBC_SHA256\",\n+        \"TLS_RSA_WITH_AES_128_CBC_SHA\",\n@@ -123,1 +166,1 @@\n-        \"TLS_AES_128_GCM_SHA256\",\n+        \/\/ TLS 1.3 cipher suites\n@@ -125,0 +168,1 @@\n+        \"TLS_AES_128_GCM_SHA256\",\n@@ -126,0 +170,2 @@\n+\n+        \/\/ Suite B compliant cipher suites\n@@ -128,0 +174,2 @@\n+\n+        \/\/ Not suite B, but we want it to position the suite early\n@@ -129,0 +177,2 @@\n+\n+        \/\/ AES_256(GCM) - ECDHE - forward screcy\n@@ -131,3 +181,5 @@\n-        \"TLS_RSA_WITH_AES_256_GCM_SHA384\",\n-        \"TLS_ECDH_ECDSA_WITH_AES_256_GCM_SHA384\",\n-        \"TLS_ECDH_RSA_WITH_AES_256_GCM_SHA384\",\n+\n+        \/\/ AES_128(GCM) - ECDHE - forward screcy\n+        \"TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256\",\n+\n+        \/\/ AES_256(GCM) - DHE - forward screcy\n@@ -137,4 +189,2 @@\n-        \"TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256\",\n-        \"TLS_RSA_WITH_AES_128_GCM_SHA256\",\n-        \"TLS_ECDH_ECDSA_WITH_AES_128_GCM_SHA256\",\n-        \"TLS_ECDH_RSA_WITH_AES_128_GCM_SHA256\",\n+\n+        \/\/ AES_128(GCM) - DHE - forward screcy\n@@ -143,0 +193,2 @@\n+\n+        \/\/ AES_256(CBC) - ECDHE - forward screcy\n@@ -145,12 +197,2 @@\n-        \"TLS_RSA_WITH_AES_256_CBC_SHA256\",\n-        \"TLS_ECDH_ECDSA_WITH_AES_256_CBC_SHA384\",\n-        \"TLS_ECDH_RSA_WITH_AES_256_CBC_SHA384\",\n-        \"TLS_DHE_RSA_WITH_AES_256_CBC_SHA256\",\n-        \"TLS_DHE_DSS_WITH_AES_256_CBC_SHA256\",\n-        \"TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA\",\n-        \"TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA\",\n-        \"TLS_RSA_WITH_AES_256_CBC_SHA\",\n-        \"TLS_ECDH_ECDSA_WITH_AES_256_CBC_SHA\",\n-        \"TLS_ECDH_RSA_WITH_AES_256_CBC_SHA\",\n-        \"TLS_DHE_RSA_WITH_AES_256_CBC_SHA\",\n-        \"TLS_DHE_DSS_WITH_AES_256_CBC_SHA\",\n+\n+        \/\/ AES_256(CBC) - ECDHE - forward screcy\n@@ -159,3 +201,6 @@\n-        \"TLS_RSA_WITH_AES_128_CBC_SHA256\",\n-        \"TLS_ECDH_ECDSA_WITH_AES_128_CBC_SHA256\",\n-        \"TLS_ECDH_RSA_WITH_AES_128_CBC_SHA256\",\n+\n+        \/\/ AES_256(CBC) - DHE - forward screcy\n+        \"TLS_DHE_RSA_WITH_AES_256_CBC_SHA256\",\n+        \"TLS_DHE_DSS_WITH_AES_256_CBC_SHA256\",\n+\n+        \/\/ AES_128(CBC) - DHE - forward screcy\n@@ -164,0 +209,22 @@\n+\n+        \/\/ AES_256(GCM) - not forward screcy\n+        \"TLS_ECDH_ECDSA_WITH_AES_256_GCM_SHA384\",\n+        \"TLS_ECDH_RSA_WITH_AES_256_GCM_SHA384\",\n+\n+        \/\/ AES_128(GCM) - not forward screcy\n+        \"TLS_ECDH_ECDSA_WITH_AES_128_GCM_SHA256\",\n+        \"TLS_ECDH_RSA_WITH_AES_128_GCM_SHA256\",\n+\n+        \/\/ AES_256(CBC) - not forward screcy\n+        \"TLS_ECDH_ECDSA_WITH_AES_256_CBC_SHA384\",\n+        \"TLS_ECDH_RSA_WITH_AES_256_CBC_SHA384\",\n+\n+        \/\/ AES_128(CBC) - not forward screcy\n+        \"TLS_ECDH_ECDSA_WITH_AES_128_CBC_SHA256\",\n+        \"TLS_ECDH_RSA_WITH_AES_128_CBC_SHA256\",\n+\n+        \/\/ AES_256(CBC) - ECDHE - using SHA\n+        \"TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA\",\n+        \"TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA\",\n+\n+        \/\/ AES_128(CBC) - ECDHE - using SHA\n@@ -166,3 +233,6 @@\n-        \"TLS_RSA_WITH_AES_128_CBC_SHA\",\n-        \"TLS_ECDH_ECDSA_WITH_AES_128_CBC_SHA\",\n-        \"TLS_ECDH_RSA_WITH_AES_128_CBC_SHA\",\n+\n+        \/\/ AES_256(CBC) - DHE - using SHA\n+        \"TLS_DHE_RSA_WITH_AES_256_CBC_SHA\",\n+        \"TLS_DHE_DSS_WITH_AES_256_CBC_SHA\",\n+\n+        \/\/ AES_128(CBC) - DHE - using SHA\n@@ -171,0 +241,16 @@\n+\n+        \/\/ AES_256(CBC) - using SHA, not forward screcy\n+        \"TLS_ECDH_ECDSA_WITH_AES_256_CBC_SHA\",\n+        \"TLS_ECDH_RSA_WITH_AES_256_CBC_SHA\",\n+\n+        \/\/ AES_128(CBC) - using SHA, not forward screcy\n+        \"TLS_ECDH_ECDSA_WITH_AES_128_CBC_SHA\",\n+        \"TLS_ECDH_RSA_WITH_AES_128_CBC_SHA\",\n+\n+        \/\/ deprecated\n+        \"TLS_RSA_WITH_AES_256_GCM_SHA384\",\n+        \"TLS_RSA_WITH_AES_128_GCM_SHA256\",\n+        \"TLS_RSA_WITH_AES_256_CBC_SHA256\",\n+        \"TLS_RSA_WITH_AES_128_CBC_SHA256\",\n+        \"TLS_RSA_WITH_AES_256_CBC_SHA\",\n+        \"TLS_RSA_WITH_AES_128_CBC_SHA\",\n@@ -180,3 +266,0 @@\n-        \"TLS_RSA_WITH_AES_128_GCM_SHA256\",\n-        \"TLS_ECDH_ECDSA_WITH_AES_128_GCM_SHA256\",\n-        \"TLS_ECDH_RSA_WITH_AES_128_GCM_SHA256\",\n@@ -187,3 +270,0 @@\n-        \"TLS_RSA_WITH_AES_128_CBC_SHA256\",\n-        \"TLS_ECDH_ECDSA_WITH_AES_128_CBC_SHA256\",\n-        \"TLS_ECDH_RSA_WITH_AES_128_CBC_SHA256\",\n@@ -192,0 +272,4 @@\n+        \"TLS_ECDH_ECDSA_WITH_AES_128_GCM_SHA256\",\n+        \"TLS_ECDH_RSA_WITH_AES_128_GCM_SHA256\",\n+        \"TLS_ECDH_ECDSA_WITH_AES_128_CBC_SHA256\",\n+        \"TLS_ECDH_RSA_WITH_AES_128_CBC_SHA256\",\n@@ -194,3 +278,0 @@\n-        \"TLS_RSA_WITH_AES_128_CBC_SHA\",\n-        \"TLS_ECDH_ECDSA_WITH_AES_128_CBC_SHA\",\n-        \"TLS_ECDH_RSA_WITH_AES_128_CBC_SHA\",\n@@ -199,0 +280,5 @@\n+        \"TLS_ECDH_ECDSA_WITH_AES_128_CBC_SHA\",\n+        \"TLS_ECDH_RSA_WITH_AES_128_CBC_SHA\",\n+        \"TLS_RSA_WITH_AES_128_GCM_SHA256\",\n+        \"TLS_RSA_WITH_AES_128_CBC_SHA256\",\n+        \"TLS_RSA_WITH_AES_128_CBC_SHA\",\n@@ -231,1 +317,2 @@\n-        SSLSocketFactory factory = (SSLSocketFactory)SSLSocketFactory.getDefault();\n+        SSLSocketFactory factory =\n+                (SSLSocketFactory)SSLSocketFactory.getDefault();\n@@ -260,1 +347,0 @@\n-\n","filename":"test\/jdk\/javax\/net\/ssl\/sanity\/ciphersuites\/CheckCipherSuites.java","additions":160,"deletions":74,"binary":false,"changes":234,"status":"modified"},{"patch":"@@ -35,1 +35,0 @@\n-\n@@ -44,113 +43,147 @@\n-        \"TLS_AES_128_GCM_SHA256\",\n-        \"TLS_AES_256_GCM_SHA384\",\n-        \"TLS_CHACHA20_POLY1305_SHA256\",\n-        \"TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384\",\n-        \"TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256\",\n-        \"TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256\",\n-        \"TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384\",\n-        \"TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256\",\n-        \"TLS_RSA_WITH_AES_256_GCM_SHA384\",\n-        \"TLS_ECDH_ECDSA_WITH_AES_256_GCM_SHA384\",\n-        \"TLS_ECDH_RSA_WITH_AES_256_GCM_SHA384\",\n-        \"TLS_DHE_RSA_WITH_AES_256_GCM_SHA384\",\n-        \"TLS_DHE_RSA_WITH_CHACHA20_POLY1305_SHA256\",\n-        \"TLS_DHE_DSS_WITH_AES_256_GCM_SHA384\",\n-        \"TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256\",\n-        \"TLS_RSA_WITH_AES_128_GCM_SHA256\",\n-        \"TLS_ECDH_ECDSA_WITH_AES_128_GCM_SHA256\",\n-        \"TLS_ECDH_RSA_WITH_AES_128_GCM_SHA256\",\n-        \"TLS_DHE_RSA_WITH_AES_128_GCM_SHA256\",\n-        \"TLS_DHE_DSS_WITH_AES_128_GCM_SHA256\",\n-\n-        \"TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384\",\n-        \"TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384\",\n-        \"TLS_RSA_WITH_AES_256_CBC_SHA256\",\n-        \"TLS_ECDH_ECDSA_WITH_AES_256_CBC_SHA384\",\n-        \"TLS_ECDH_RSA_WITH_AES_256_CBC_SHA384\",\n-        \"TLS_DHE_RSA_WITH_AES_256_CBC_SHA256\",\n-        \"TLS_DHE_DSS_WITH_AES_256_CBC_SHA256\",\n-        \"TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA\",\n-        \"TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA\",\n-        \"TLS_RSA_WITH_AES_256_CBC_SHA\",\n-        \"TLS_ECDH_ECDSA_WITH_AES_256_CBC_SHA\",\n-        \"TLS_ECDH_RSA_WITH_AES_256_CBC_SHA\",\n-        \"TLS_DHE_RSA_WITH_AES_256_CBC_SHA\",\n-        \"TLS_DHE_DSS_WITH_AES_256_CBC_SHA\",\n-        \"TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256\",\n-        \"TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256\",\n-        \"TLS_RSA_WITH_AES_128_CBC_SHA256\",\n-        \"TLS_ECDH_ECDSA_WITH_AES_128_CBC_SHA256\",\n-        \"TLS_ECDH_RSA_WITH_AES_128_CBC_SHA256\",\n-        \"TLS_DHE_RSA_WITH_AES_128_CBC_SHA256\",\n-        \"TLS_DHE_DSS_WITH_AES_128_CBC_SHA256\",\n-        \"TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA\",\n-        \"TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA\",\n-        \"TLS_RSA_WITH_AES_128_CBC_SHA\",\n-        \"TLS_ECDH_ECDSA_WITH_AES_128_CBC_SHA\",\n-        \"TLS_ECDH_RSA_WITH_AES_128_CBC_SHA\",\n-        \"TLS_DHE_RSA_WITH_AES_128_CBC_SHA\",\n-        \"TLS_DHE_DSS_WITH_AES_128_CBC_SHA\",\n-\n-        \"TLS_ECDHE_ECDSA_WITH_3DES_EDE_CBC_SHA\",\n-        \"TLS_ECDHE_RSA_WITH_3DES_EDE_CBC_SHA\",\n-        \"SSL_RSA_WITH_3DES_EDE_CBC_SHA\",\n-        \"TLS_ECDH_ECDSA_WITH_3DES_EDE_CBC_SHA\",\n-        \"TLS_ECDH_RSA_WITH_3DES_EDE_CBC_SHA\",\n-        \"SSL_DHE_RSA_WITH_3DES_EDE_CBC_SHA\",\n-        \"SSL_DHE_DSS_WITH_3DES_EDE_CBC_SHA\",\n-\n-        \"TLS_EMPTY_RENEGOTIATION_INFO_SCSV\",\n-\n-        \"TLS_DH_anon_WITH_AES_256_GCM_SHA384\",\n-        \"TLS_DH_anon_WITH_AES_128_GCM_SHA256\",\n-\n-        \"TLS_DH_anon_WITH_AES_256_CBC_SHA256\",\n-        \"TLS_ECDH_anon_WITH_AES_256_CBC_SHA\",\n-        \"TLS_DH_anon_WITH_AES_256_CBC_SHA\",\n-        \"TLS_DH_anon_WITH_AES_128_CBC_SHA256\",\n-        \"TLS_ECDH_anon_WITH_AES_128_CBC_SHA\",\n-        \"TLS_DH_anon_WITH_AES_128_CBC_SHA\",\n-        \"TLS_ECDH_anon_WITH_3DES_EDE_CBC_SHA\",\n-        \"SSL_DH_anon_WITH_3DES_EDE_CBC_SHA\",\n-\n-        \"TLS_ECDHE_ECDSA_WITH_RC4_128_SHA\",\n-        \"TLS_ECDHE_RSA_WITH_RC4_128_SHA\",\n-        \"SSL_RSA_WITH_RC4_128_SHA\",\n-        \"TLS_ECDH_ECDSA_WITH_RC4_128_SHA\",\n-        \"TLS_ECDH_RSA_WITH_RC4_128_SHA\",\n-        \"SSL_RSA_WITH_RC4_128_MD5\",\n-        \"TLS_ECDH_anon_WITH_RC4_128_SHA\",\n-        \"SSL_DH_anon_WITH_RC4_128_MD5\",\n-\n-        \"SSL_RSA_WITH_DES_CBC_SHA\",\n-        \"SSL_DHE_RSA_WITH_DES_CBC_SHA\",\n-        \"SSL_DHE_DSS_WITH_DES_CBC_SHA\",\n-        \"SSL_DH_anon_WITH_DES_CBC_SHA\",\n-        \"SSL_RSA_EXPORT_WITH_DES40_CBC_SHA\",\n-        \"SSL_DHE_RSA_EXPORT_WITH_DES40_CBC_SHA\",\n-        \"SSL_DHE_DSS_EXPORT_WITH_DES40_CBC_SHA\",\n-        \"SSL_DH_anon_EXPORT_WITH_DES40_CBC_SHA\",\n-\n-        \"SSL_RSA_EXPORT_WITH_RC4_40_MD5\",\n-        \"SSL_DH_anon_EXPORT_WITH_RC4_40_MD5\",\n-\n-        \"TLS_RSA_WITH_NULL_SHA256\",\n-        \"TLS_ECDHE_ECDSA_WITH_NULL_SHA\",\n-        \"TLS_ECDHE_RSA_WITH_NULL_SHA\",\n-        \"SSL_RSA_WITH_NULL_SHA\",\n-        \"TLS_ECDH_ECDSA_WITH_NULL_SHA\",\n-        \"TLS_ECDH_RSA_WITH_NULL_SHA\",\n-        \"TLS_ECDH_anon_WITH_NULL_SHA\",\n-        \"SSL_RSA_WITH_NULL_MD5\",\n-\n-        \"TLS_KRB5_WITH_3DES_EDE_CBC_SHA\",\n-        \"TLS_KRB5_WITH_3DES_EDE_CBC_MD5\",\n-        \"TLS_KRB5_WITH_RC4_128_SHA\",\n-        \"TLS_KRB5_WITH_RC4_128_MD5\",\n-        \"TLS_KRB5_WITH_DES_CBC_SHA\",\n-        \"TLS_KRB5_WITH_DES_CBC_MD5\",\n-        \"TLS_KRB5_EXPORT_WITH_DES_CBC_40_SHA\",\n-        \"TLS_KRB5_EXPORT_WITH_DES_CBC_40_MD5\",\n-        \"TLS_KRB5_EXPORT_WITH_RC4_40_SHA\",\n-        \"TLS_KRB5_EXPORT_WITH_RC4_40_MD5\"\n-    );\n+                    \/\/ TLS 1.3 cipher suites.\n+                    \"TLS_AES_256_GCM_SHA384\",\n+                    \"TLS_AES_128_GCM_SHA256\",\n+                    \"TLS_CHACHA20_POLY1305_SHA256\",\n+                    \/\/ Suite B compliant cipher suites, see RFC 6460.\n+                    \"TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384\",\n+                    \"TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256\",\n+                    \/\/ Not suite B, but we want it to position the suite early\n+                    \/\/in the list of 1.2 suites.\n+                    \"TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256\",\n+                    \/\/\n+                    \/\/ Forward secrecy cipher suites.\n+                    \/\/\n+                    \/\/ AES_256(GCM) - ECDHE\n+                    \"TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384\",\n+                    \"TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256\",\n+                    \/\/ AES_128(GCM) - ECDHE\n+                    \"TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256\",\n+                    \/\/ AES_256(GCM) - DHE\n+                    \"TLS_DHE_RSA_WITH_AES_256_GCM_SHA384\",\n+                    \"TLS_DHE_RSA_WITH_CHACHA20_POLY1305_SHA256\",\n+                    \"TLS_DHE_DSS_WITH_AES_256_GCM_SHA384\",\n+                    \/\/ AES_128(GCM) - DHE\n+                    \"TLS_DHE_RSA_WITH_AES_128_GCM_SHA256\",\n+                    \"TLS_DHE_DSS_WITH_AES_128_GCM_SHA256\",\n+                    \/\/ AES_256(CBC) - ECDHE\n+                    \"TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384\",\n+                    \"TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384\",\n+                    \/\/ AES_128(CBC) - ECDHE\n+                    \"TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256\",\n+                    \"TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256\",\n+                    \/\/ AES_256(CBC) - DHE\n+                    \"TLS_DHE_RSA_WITH_AES_256_CBC_SHA256\",\n+                    \"TLS_DHE_DSS_WITH_AES_256_CBC_SHA256\",\n+                    \/\/ AES_128(CBC) - DHE\n+                    \"TLS_DHE_RSA_WITH_AES_128_CBC_SHA256\",\n+                    \"TLS_DHE_DSS_WITH_AES_128_CBC_SHA256\",\n+                    \/\/\n+                    \/\/ Not forward secret cipher suites.\n+                    \/\/\n+                    \/\/ AES_256(GCM)\n+                    \"TLS_ECDH_ECDSA_WITH_AES_256_GCM_SHA384\",\n+                    \"TLS_ECDH_RSA_WITH_AES_256_GCM_SHA384\",\n+                    \/\/ AES_128(GCM)\n+                    \"TLS_ECDH_ECDSA_WITH_AES_128_GCM_SHA256\",\n+                    \"TLS_ECDH_RSA_WITH_AES_128_GCM_SHA256\",\n+                    \/\/ AES_256(CBC)\n+                    \"TLS_ECDH_ECDSA_WITH_AES_256_CBC_SHA384\",\n+                    \"TLS_ECDH_RSA_WITH_AES_256_CBC_SHA384\",\n+                    \/\/ AES_128(CBC)\n+                    \"TLS_ECDH_ECDSA_WITH_AES_128_CBC_SHA256\",\n+                    \"TLS_ECDH_RSA_WITH_AES_128_CBC_SHA256\",\n+                    \/\/\n+                    \/\/ Legacy, used for compatibility\n+                    \/\/\n+                    \/\/ AES_256(CBC) - ECDHE - Using SHA\n+                    \"TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA\",\n+                    \"TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA\",\n+                    \/\/ AES_128(CBC) - ECDHE - using SHA\n+                    \"TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA\",\n+                    \"TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA\",\n+                    \/\/ AES_256(CBC) - DHE - Using SHA\n+                    \"TLS_DHE_RSA_WITH_AES_256_CBC_SHA\",\n+                    \"TLS_DHE_DSS_WITH_AES_256_CBC_SHA\",\n+                    \/\/ AES_128(CBC) - DHE - using SHA\n+                    \"TLS_DHE_RSA_WITH_AES_128_CBC_SHA\",\n+                    \"TLS_DHE_DSS_WITH_AES_128_CBC_SHA\",\n+                    \/\/ AES_256(CBC) - using SHA, not forward secrecy\n+                    \"TLS_ECDH_ECDSA_WITH_AES_256_CBC_SHA\",\n+                    \"TLS_ECDH_RSA_WITH_AES_256_CBC_SHA\",\n+                    \/\/ AES_128(CBC) - using SHA, not forward secrecy\n+                    \"TLS_ECDH_ECDSA_WITH_AES_128_CBC_SHA\",\n+                    \"TLS_ECDH_RSA_WITH_AES_128_CBC_SHA\",\n+                    \/\/\n+                    \/\/ Deprecated, used for compatibility\n+                    \/\/\n+                    \/\/ RSA, AES_256(GCM)\n+                    \"TLS_RSA_WITH_AES_256_GCM_SHA384\",\n+                    \/\/ RSA, AES_128(GCM)\n+                    \"TLS_RSA_WITH_AES_128_GCM_SHA256\",\n+                    \/\/ RSA, AES_256(CBC)\n+                    \"TLS_RSA_WITH_AES_256_CBC_SHA256\",\n+                    \/\/ RSA, AES_128(CBC)\n+                    \"TLS_RSA_WITH_AES_128_CBC_SHA256\",\n+                    \/\/ RSA, AES_256(CBC) - using SHA, not forward secrecy\n+                    \"TLS_RSA_WITH_AES_256_CBC_SHA\",\n+                    \/\/ RSA, AES_128(CBC) - using SHA, not forward secrecy\n+                    \"TLS_RSA_WITH_AES_128_CBC_SHA\",\n+                    \/\/ 3DES_EDE, forward secrecy.\n+                    \"TLS_ECDHE_ECDSA_WITH_3DES_EDE_CBC_SHA\",\n+                    \"TLS_ECDHE_RSA_WITH_3DES_EDE_CBC_SHA\",\n+                    \"SSL_DHE_RSA_WITH_3DES_EDE_CBC_SHA\",\n+                    \"SSL_DHE_DSS_WITH_3DES_EDE_CBC_SHA\",\n+                    \/\/ 3DES_EDE, not forward secrecy.\n+                    \"TLS_ECDH_ECDSA_WITH_3DES_EDE_CBC_SHA\",\n+                    \"TLS_ECDH_RSA_WITH_3DES_EDE_CBC_SHA\",\n+                    \"SSL_RSA_WITH_3DES_EDE_CBC_SHA\",\n+                    \/\/ Renegotiation protection request Signalling\n+                    \/\/ Cipher Suite Value (SCSV).\n+                    \"TLS_EMPTY_RENEGOTIATION_INFO_SCSV\",\n+                    \/\/ Definition of the Cipher Suites that are supported but not\n+                    \/\/ enabled by default.\n+                    \"TLS_DH_anon_WITH_AES_256_GCM_SHA384\",\n+                    \"TLS_DH_anon_WITH_AES_128_GCM_SHA256\",\n+                    \"TLS_DH_anon_WITH_AES_256_CBC_SHA256\",\n+                    \"TLS_ECDH_anon_WITH_AES_256_CBC_SHA\",\n+                    \"TLS_DH_anon_WITH_AES_256_CBC_SHA\",\n+                    \"TLS_DH_anon_WITH_AES_128_CBC_SHA256\",\n+                    \"TLS_ECDH_anon_WITH_AES_128_CBC_SHA\",\n+                    \"TLS_DH_anon_WITH_AES_128_CBC_SHA\",\n+                    \"TLS_ECDH_anon_WITH_3DES_EDE_CBC_SHA\",\n+                    \"SSL_DH_anon_WITH_3DES_EDE_CBC_SHA\",\n+                    \/\/ RC4\n+                    \"TLS_ECDHE_ECDSA_WITH_RC4_128_SHA\",\n+                    \"TLS_ECDHE_RSA_WITH_RC4_128_SHA\",\n+                    \"SSL_RSA_WITH_RC4_128_SHA\",\n+                    \"TLS_ECDH_ECDSA_WITH_RC4_128_SHA\",\n+                    \"TLS_ECDH_RSA_WITH_RC4_128_SHA\",\n+                    \"SSL_RSA_WITH_RC4_128_MD5\",\n+                    \"TLS_ECDH_anon_WITH_RC4_128_SHA\",\n+                    \"SSL_DH_anon_WITH_RC4_128_MD5\",\n+                    \/\/ Weak cipher suites obsoleted in TLS 1.2 [RFC 5246]\n+                    \"SSL_RSA_WITH_DES_CBC_SHA\",\n+                    \"SSL_DHE_RSA_WITH_DES_CBC_SHA\",\n+                    \"SSL_DHE_DSS_WITH_DES_CBC_SHA\",\n+                    \"SSL_DH_anon_WITH_DES_CBC_SHA\",\n+                    \/\/ Weak cipher suites obsoleted in TLS 1.1  [RFC 4346]\n+                    \"SSL_RSA_EXPORT_WITH_DES40_CBC_SHA\",\n+                    \"SSL_DHE_RSA_EXPORT_WITH_DES40_CBC_SHA\",\n+                    \"SSL_DHE_DSS_EXPORT_WITH_DES40_CBC_SHA\",\n+                    \"SSL_DH_anon_EXPORT_WITH_DES40_CBC_SHA\",\n+                    \"SSL_RSA_EXPORT_WITH_RC4_40_MD5\",\n+                    \"SSL_DH_anon_EXPORT_WITH_RC4_40_MD5\",\n+                    \/\/ No traffic encryption cipher suites\n+                    \"TLS_RSA_WITH_NULL_SHA256\",\n+                    \"TLS_ECDHE_ECDSA_WITH_NULL_SHA\",\n+                    \"TLS_ECDHE_RSA_WITH_NULL_SHA\",\n+                    \"SSL_RSA_WITH_NULL_SHA\",\n+                    \"TLS_ECDH_ECDSA_WITH_NULL_SHA\",\n+                    \"TLS_ECDH_RSA_WITH_NULL_SHA\",\n+                    \"TLS_ECDH_anon_WITH_NULL_SHA\",\n+                    \"SSL_RSA_WITH_NULL_MD5\",\n+                    \/\/ Definition of the cipher suites that are not supported but the names\n+                    \/\/ are known.\n+                    \"TLS_AES_128_CCM_SHA256\",\n+                    \"TLS_AES_128_CCM_8_SHA256\"\n+            );\n@@ -162,1 +195,0 @@\n-\n@@ -166,1 +198,1 @@\n-                 \"All supported cipher suites\");\n+                \"All supported cipher suites\");\n","filename":"test\/jdk\/javax\/net\/ssl\/sanity\/ciphersuites\/CipherSuitesInOrder.java","additions":148,"deletions":116,"binary":false,"changes":264,"status":"modified"}]}