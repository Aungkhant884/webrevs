{"files":[{"patch":"@@ -46,2 +46,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-            NSK_CPP_STUB3(SetVerboseFlag, jvmti, JVMTI_VERBOSE_OTHER, JNI_TRUE)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->SetVerboseFlag(JVMTI_VERBOSE_OTHER, JNI_TRUE)))\n@@ -50,2 +49,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-            NSK_CPP_STUB3(SetVerboseFlag, jvmti, JVMTI_VERBOSE_OTHER, JNI_FALSE)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->SetVerboseFlag(JVMTI_VERBOSE_OTHER, JNI_FALSE)))\n@@ -54,2 +52,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-            NSK_CPP_STUB3(SetVerboseFlag, jvmti, JVMTI_VERBOSE_GC, JNI_TRUE)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->SetVerboseFlag(JVMTI_VERBOSE_GC, JNI_TRUE)))\n@@ -58,2 +55,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-            NSK_CPP_STUB3(SetVerboseFlag, jvmti, JVMTI_VERBOSE_GC, JNI_FALSE)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->SetVerboseFlag(JVMTI_VERBOSE_GC, JNI_FALSE)))\n@@ -62,2 +58,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-            NSK_CPP_STUB3(SetVerboseFlag, jvmti, JVMTI_VERBOSE_CLASS, JNI_TRUE)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->SetVerboseFlag(JVMTI_VERBOSE_CLASS, JNI_TRUE)))\n@@ -66,2 +61,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-            NSK_CPP_STUB3(SetVerboseFlag, jvmti, JVMTI_VERBOSE_CLASS, JNI_FALSE)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->SetVerboseFlag(JVMTI_VERBOSE_CLASS, JNI_FALSE)))\n@@ -70,2 +64,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-            NSK_CPP_STUB3(SetVerboseFlag, jvmti, JVMTI_VERBOSE_JNI, JNI_TRUE)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->SetVerboseFlag(JVMTI_VERBOSE_JNI, JNI_TRUE)))\n@@ -74,2 +67,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-            NSK_CPP_STUB3(SetVerboseFlag, jvmti, JVMTI_VERBOSE_JNI, JNI_FALSE)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->SetVerboseFlag(JVMTI_VERBOSE_JNI, JNI_FALSE)))\n@@ -86,1 +78,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(GetPhase, jvmti, &phase)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->GetPhase(&phase)))\n@@ -108,1 +100,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(RawMonitorEnter, jvmti, access_lock)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->RawMonitorEnter(access_lock)))\n@@ -111,1 +103,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(GetPhase, jvmti, &curr_phase)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->GetPhase(&curr_phase)))\n@@ -124,1 +116,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(RawMonitorExit, jvmti, access_lock)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->RawMonitorExit(access_lock)))\n@@ -138,1 +130,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(GetPhase, jvmti, &phase)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->GetPhase(&phase)))\n@@ -184,3 +176,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-            NSK_CPP_STUB3(CreateRawMonitor, jvmti,\n-                \"_access_lock\", &access_lock)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->CreateRawMonitor(\"_access_lock\", &access_lock)))\n@@ -189,1 +179,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(GetPhase, jvmti, &phase)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->GetPhase(&phase)))\n@@ -202,3 +192,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-            NSK_CPP_STUB3(SetEventCallbacks, jvmti,\n-                &callbacks, sizeof(callbacks))))\n+    if (!NSK_JVMTI_VERIFY(jvmti->SetEventCallbacks(&callbacks, sizeof(callbacks))))\n@@ -209,2 +197,1 @@\n-            NSK_CPP_STUB4(SetEventNotificationMode, jvmti, JVMTI_ENABLE,\n-                JVMTI_EVENT_VM_INIT, NULL)))\n+            jvmti->SetEventNotificationMode(JVMTI_ENABLE, JVMTI_EVENT_VM_INIT, NULL)))\n@@ -215,2 +202,1 @@\n-            NSK_CPP_STUB4(SetEventNotificationMode, jvmti, JVMTI_ENABLE,\n-                JVMTI_EVENT_CLASS_FILE_LOAD_HOOK, NULL)))\n+            jvmti->SetEventNotificationMode(JVMTI_ENABLE, JVMTI_EVENT_CLASS_FILE_LOAD_HOOK, NULL)))\n","filename":"test\/hotspot\/jtreg\/vmTestbase\/nsk\/jvmti\/SetVerboseFlag\/setvrbflag001\/setvrbflag001.cpp","additions":18,"deletions":32,"binary":false,"changes":50,"status":"modified"},{"patch":"@@ -50,2 +50,1 @@\n-            NSK_CPP_STUB3(SetVerboseFlag, jvmti,\n-                (jvmtiVerboseFlag)(-1), JNI_TRUE)))\n+            jvmti->SetVerboseFlag((jvmtiVerboseFlag)(-1), JNI_TRUE)))\n","filename":"test\/hotspot\/jtreg\/vmTestbase\/nsk\/jvmti\/SetVerboseFlag\/setvrbflag002\/setvrbflag002.cpp","additions":1,"deletions":2,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -66,9 +66,5 @@\n-    if (!NSK_JNI_VERIFY(env, (mid = NSK_CPP_STUB4(GetMethodID,\n-            env, klass, METHODS[0], METHOD_SIGS[0])) != NULL))\n-        NSK_CPP_STUB2(FatalError, env,\n-            \"failed to get ID for the java method\\n\");\n-\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB3(SetBreakpoint,\n-            jvmti_env, mid, 0)))\n-        NSK_CPP_STUB2(FatalError, env,\n-            \"failed to set breakpoint\\n\");\n+    if (!NSK_JNI_VERIFY(env, (mid = env->GetMethodID(klass, METHODS[0], METHOD_SIGS[0])) != NULL))\n+        env->FatalError(\"failed to get ID for the java method\\n\");\n+\n+    if (!NSK_JVMTI_VERIFY(jvmti_env->SetBreakpoint(mid, 0)))\n+        env->FatalError(\"failed to set breakpoint\\n\");\n@@ -85,4 +81,2 @@\n-        if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB4(GetClassSignature,\n-                                            jvmti_env, klass, &sig, &generic)))\n-            NSK_CPP_STUB2(FatalError, env,\n-                          \"failed to obtain a class signature\\n\");\n+        if (!NSK_JVMTI_VERIFY(jvmti_env->GetClassSignature(klass, &sig, &generic)))\n+            env->FatalError(\"failed to obtain a class signature\\n\");\n@@ -109,2 +103,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB3(GetMethodDeclaringClass,\n-            jvmti_env, method, &klass)))\n+    if (!NSK_JVMTI_VERIFY(jvmti_env->GetMethodDeclaringClass(method, &klass)))\n@@ -113,4 +106,2 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB4(GetClassSignature,\n-            jvmti_env, klass, &sig, &generic)))\n-        NSK_CPP_STUB2(FatalError, env,\n-            \"Breakpoint: failed to obtain a class signature\\n\");\n+    if (!NSK_JVMTI_VERIFY(jvmti_env->GetClassSignature(klass, &sig, &generic)))\n+        env->FatalError(\"Breakpoint: failed to obtain a class signature\\n\");\n@@ -121,2 +112,1 @@\n-        if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB4(SetEventNotificationMode,\n-                jvmti_env, JVMTI_ENABLE, JVMTI_EVENT_SINGLE_STEP, thr))) {\n+        if (!NSK_JVMTI_VERIFY(jvmti_env->SetEventNotificationMode(JVMTI_ENABLE, JVMTI_EVENT_SINGLE_STEP, thr))) {\n@@ -145,2 +135,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB5(GetMethodName,\n-            jvmti_env, method, &methNam, &methSig, NULL))) {\n+    if (!NSK_JVMTI_VERIFY(jvmti_env->GetMethodName(method, &methNam, &methSig, NULL))) {\n@@ -151,2 +140,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB3(GetMethodDeclaringClass,\n-            jvmti_env, method, &klass))) {\n+    if (!NSK_JVMTI_VERIFY(jvmti_env->GetMethodDeclaringClass(method, &klass))) {\n@@ -157,2 +145,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB4(GetClassSignature,\n-            jvmti_env, klass, &sig, &generic))) {\n+    if (!NSK_JVMTI_VERIFY(jvmti_env->GetClassSignature(klass, &sig, &generic))) {\n@@ -190,2 +177,1 @@\n-            if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB4(SetEventNotificationMode,\n-                    jvmti_env, JVMTI_DISABLE, JVMTI_EVENT_SINGLE_STEP, thread))) {\n+            if (!NSK_JVMTI_VERIFY(jvmti_env->SetEventNotificationMode(JVMTI_DISABLE, JVMTI_EVENT_SINGLE_STEP, thread))) {\n@@ -198,2 +184,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(Deallocate,\n-            jvmti_env, (unsigned char*) methNam))) {\n+    if (!NSK_JVMTI_VERIFY(jvmti_env->Deallocate((unsigned char*) methNam))) {\n@@ -203,2 +188,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(Deallocate,\n-            jvmti_env, (unsigned char*) methSig))) {\n+    if (!NSK_JVMTI_VERIFY(jvmti_env->Deallocate((unsigned char*) methSig))) {\n@@ -264,2 +248,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(AddCapabilities,\n-            jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->AddCapabilities(&caps)))\n@@ -268,2 +251,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(GetCapabilities,\n-            jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->GetCapabilities(&caps)))\n@@ -282,2 +264,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB3(SetEventCallbacks,\n-            jvmti, &callbacks, sizeof(callbacks))))\n+    if (!NSK_JVMTI_VERIFY(jvmti->SetEventCallbacks(&callbacks, sizeof(callbacks))))\n@@ -287,2 +268,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB4(SetEventNotificationMode,\n-            jvmti, JVMTI_ENABLE, JVMTI_EVENT_VM_START, NULL)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->SetEventNotificationMode(JVMTI_ENABLE, JVMTI_EVENT_VM_START, NULL)))\n@@ -290,2 +270,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB4(SetEventNotificationMode,\n-            jvmti, JVMTI_ENABLE, JVMTI_EVENT_CLASS_LOAD, NULL)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->SetEventNotificationMode(JVMTI_ENABLE, JVMTI_EVENT_CLASS_LOAD, NULL)))\n@@ -293,2 +272,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB4(SetEventNotificationMode,\n-            jvmti, JVMTI_ENABLE, JVMTI_EVENT_BREAKPOINT, NULL)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->SetEventNotificationMode(JVMTI_ENABLE, JVMTI_EVENT_BREAKPOINT, NULL)))\n@@ -298,2 +276,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB3(CreateRawMonitor,\n-            jvmti, \"agent lock\", &agent_lock)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->CreateRawMonitor(\"agent lock\", &agent_lock)))\n","filename":"test\/hotspot\/jtreg\/vmTestbase\/nsk\/jvmti\/SingleStep\/singlestep001\/singlestep001.cpp","additions":24,"deletions":47,"binary":false,"changes":71,"status":"modified"},{"patch":"@@ -53,2 +53,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(GetPhase,\n-            jvmti_env, &phase))) {\n+    if (!NSK_JVMTI_VERIFY(jvmti_env->GetPhase(&phase))) {\n@@ -108,2 +107,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(AddCapabilities,\n-            jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->AddCapabilities(&caps)))\n@@ -112,2 +110,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(GetCapabilities,\n-            jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->GetCapabilities(&caps)))\n@@ -124,2 +121,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB3(SetEventCallbacks,\n-            jvmti, &callbacks, sizeof(callbacks))))\n+    if (!NSK_JVMTI_VERIFY(jvmti->SetEventCallbacks(&callbacks, sizeof(callbacks))))\n@@ -129,2 +125,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB4(SetEventNotificationMode,\n-            jvmti, JVMTI_ENABLE, JVMTI_EVENT_SINGLE_STEP, NULL)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->SetEventNotificationMode(JVMTI_ENABLE, JVMTI_EVENT_SINGLE_STEP, NULL)))\n@@ -132,2 +127,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB4(SetEventNotificationMode,\n-            jvmti, JVMTI_ENABLE, JVMTI_EVENT_VM_DEATH, NULL)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->SetEventNotificationMode(JVMTI_ENABLE, JVMTI_EVENT_VM_DEATH, NULL)))\n","filename":"test\/hotspot\/jtreg\/vmTestbase\/nsk\/jvmti\/SingleStep\/singlestep002\/singlestep002.cpp","additions":6,"deletions":12,"binary":false,"changes":18,"status":"modified"},{"patch":"@@ -67,9 +67,5 @@\n-    if (!NSK_JNI_VERIFY(env, (mid = NSK_CPP_STUB4(GetMethodID,\n-            env, klass, METHODS[0][0], METHODS[0][1])) != NULL))\n-        NSK_CPP_STUB2(FatalError, env,\n-            \"failed to get ID for the java method\\n\");\n-\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB3(SetBreakpoint,\n-            jvmti_env, mid, 0)))\n-        NSK_CPP_STUB2(FatalError, env,\n-            \"failed to set breakpoint\\n\");\n+    if (!NSK_JNI_VERIFY(env, (mid = env->GetMethodID(klass, METHODS[0][0], METHODS[0][1])) != NULL))\n+        env->FatalError(\"failed to get ID for the java method\\n\");\n+\n+    if (!NSK_JVMTI_VERIFY(jvmti_env->SetBreakpoint(mid, 0)))\n+        env->FatalError(\"failed to set breakpoint\\n\");\n@@ -83,4 +79,2 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB4(GetClassSignature,\n-            jvmti_env, klass, &sig, &generic)))\n-        NSK_CPP_STUB2(FatalError, env,\n-            \"failed to obtain a class signature\\n\");\n+    if (!NSK_JVMTI_VERIFY(jvmti_env->GetClassSignature(klass, &sig, &generic)))\n+        env->FatalError(\"failed to obtain a class signature\\n\");\n@@ -104,2 +98,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB3(GetMethodDeclaringClass,\n-            jvmti_env, method, &klass)))\n+    if (!NSK_JVMTI_VERIFY(jvmti_env->GetMethodDeclaringClass(method, &klass)))\n@@ -108,4 +101,2 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB4(GetClassSignature,\n-            jvmti_env, klass, &sig, &generic)))\n-        NSK_CPP_STUB2(FatalError, env,\n-            \"Breakpoint: failed to obtain a class signature\\n\");\n+    if (!NSK_JVMTI_VERIFY(jvmti_env->GetClassSignature(klass, &sig, &generic)))\n+        env->FatalError(\"Breakpoint: failed to obtain a class signature\\n\");\n@@ -116,2 +107,1 @@\n-        if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB4(SetEventNotificationMode,\n-                jvmti_env, JVMTI_ENABLE, JVMTI_EVENT_SINGLE_STEP, thr))) {\n+        if (!NSK_JVMTI_VERIFY(jvmti_env->SetEventNotificationMode(JVMTI_ENABLE, JVMTI_EVENT_SINGLE_STEP, thr))) {\n@@ -141,2 +131,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB5(GetMethodName,\n-            jvmti_env, method, &methNam, &methSig, NULL))) {\n+    if (!NSK_JVMTI_VERIFY(jvmti_env->GetMethodName(method, &methNam, &methSig, NULL))) {\n@@ -147,2 +136,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB3(GetMethodDeclaringClass,\n-            jvmti_env, method, &klass))) {\n+    if (!NSK_JVMTI_VERIFY(jvmti_env->GetMethodDeclaringClass(method, &klass))) {\n@@ -153,2 +141,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB4(GetClassSignature,\n-            jvmti_env, klass, &sig, &generic))) {\n+    if (!NSK_JVMTI_VERIFY(jvmti_env->GetClassSignature(klass, &sig, &generic))) {\n@@ -189,2 +176,1 @@\n-                    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB4(SetEventNotificationMode,\n-                            jvmti_env, JVMTI_DISABLE, JVMTI_EVENT_SINGLE_STEP, thread))) {\n+                    if (!NSK_JVMTI_VERIFY(jvmti_env->SetEventNotificationMode(JVMTI_DISABLE, JVMTI_EVENT_SINGLE_STEP, thread))) {\n@@ -199,2 +185,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(Deallocate,\n-            jvmti_env, (unsigned char*) methNam))) {\n+    if (!NSK_JVMTI_VERIFY(jvmti_env->Deallocate((unsigned char*) methNam))) {\n@@ -204,2 +189,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(Deallocate,\n-            jvmti_env, (unsigned char*) methSig))) {\n+    if (!NSK_JVMTI_VERIFY(jvmti_env->Deallocate((unsigned char*) methSig))) {\n@@ -281,2 +265,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(AddCapabilities,\n-            jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->AddCapabilities(&caps)))\n@@ -285,2 +268,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(GetCapabilities,\n-            jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->GetCapabilities(&caps)))\n@@ -297,2 +279,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB3(SetEventCallbacks,\n-            jvmti, &callbacks, sizeof(callbacks))))\n+    if (!NSK_JVMTI_VERIFY(jvmti->SetEventCallbacks(&callbacks, sizeof(callbacks))))\n@@ -302,2 +283,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB4(SetEventNotificationMode,\n-            jvmti, JVMTI_ENABLE, JVMTI_EVENT_CLASS_LOAD, NULL)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->SetEventNotificationMode(JVMTI_ENABLE, JVMTI_EVENT_CLASS_LOAD, NULL)))\n@@ -305,2 +285,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB4(SetEventNotificationMode,\n-            jvmti, JVMTI_ENABLE, JVMTI_EVENT_BREAKPOINT, NULL)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->SetEventNotificationMode(JVMTI_ENABLE, JVMTI_EVENT_BREAKPOINT, NULL)))\n","filename":"test\/hotspot\/jtreg\/vmTestbase\/nsk\/jvmti\/SingleStep\/singlestep003\/singlestep003.cpp","additions":22,"deletions":43,"binary":false,"changes":65,"status":"modified"},{"patch":"@@ -65,2 +65,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-           NSK_CPP_STUB3(GetAllThreads, jvmti, &threads_count, &threads)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->GetAllThreads(&threads_count, &threads)))\n@@ -78,2 +77,1 @@\n-        if (!NSK_JVMTI_VERIFY(\n-                NSK_CPP_STUB3(GetThreadInfo, jvmti, threads[i], &info)))\n+        if (!NSK_JVMTI_VERIFY(jvmti->GetThreadInfo(threads[i], &info)))\n@@ -96,2 +94,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-            NSK_CPP_STUB2(Deallocate, jvmti, (unsigned char*)threads)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->Deallocate((unsigned char*)threads)))\n@@ -102,2 +99,1 @@\n-    if (!NSK_JNI_VERIFY(jni, (cls =\n-            NSK_CPP_STUB2(FindClass, jni, THREAD_DEATH_CLASS_NAME)) != NULL))\n+    if (!NSK_JNI_VERIFY(jni, (cls = jni->FindClass(THREAD_DEATH_CLASS_NAME)) != NULL))\n@@ -107,2 +103,1 @@\n-            NSK_CPP_STUB4(GetMethodID, jni, cls,\n-                THREAD_DEATH_CTOR_NAME, THREAD_DEATH_CTOR_SIGNATURE)) != NULL))\n+            jni->GetMethodID(cls, THREAD_DEATH_CTOR_NAME, THREAD_DEATH_CTOR_SIGNATURE)) != NULL))\n@@ -111,2 +106,1 @@\n-    if (!NSK_JNI_VERIFY(jni, (threadDeath =\n-            NSK_CPP_STUB3(NewObject, jni, cls, ctor)) != NULL))\n+    if (!NSK_JNI_VERIFY(jni, (threadDeath = jni->NewObject(cls, ctor)) != NULL))\n@@ -136,2 +130,1 @@\n-        if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB3(StopThread,\n-                jvmti, runningThread, threadDeath)))\n+        if (!NSK_JVMTI_VERIFY(jvmti->StopThread(runningThread, threadDeath)))\n@@ -145,2 +138,1 @@\n-        if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB3(StopThread,\n-                jvmti, waitingThread, threadDeath)))\n+        if (!NSK_JVMTI_VERIFY(jvmti->StopThread(waitingThread, threadDeath)))\n@@ -154,2 +146,1 @@\n-        if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB3(StopThread,\n-                jvmti, sleepingThread, threadDeath)))\n+        if (!NSK_JVMTI_VERIFY(jvmti->StopThread(sleepingThread, threadDeath)))\n@@ -197,1 +188,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(AddCapabilities, jvmti, &caps))) {\n+    if (!NSK_JVMTI_VERIFY(jvmti->AddCapabilities(&caps))) {\n","filename":"test\/hotspot\/jtreg\/vmTestbase\/nsk\/jvmti\/StopThread\/stopthrd007\/stopthrd007.cpp","additions":10,"deletions":19,"binary":false,"changes":29,"status":"modified"},{"patch":"@@ -61,2 +61,1 @@\n-        if (!NSK_JVMTI_VERIFY(\n-                NSK_CPP_STUB2(SuspendThread, jvmti, testedThread))) {\n+        if (!NSK_JVMTI_VERIFY(jvmti->SuspendThread(testedThread))) {\n@@ -75,2 +74,1 @@\n-            if (!NSK_JVMTI_VERIFY(\n-                    NSK_CPP_STUB3(GetThreadState, jvmti, testedThread, &state))) {\n+            if (!NSK_JVMTI_VERIFY(jvmti->GetThreadState(testedThread, &state))) {\n@@ -91,2 +89,1 @@\n-        if (!NSK_JVMTI_VERIFY(\n-                NSK_CPP_STUB2(ResumeThread, jvmti, testedThread))) {\n+        if (!NSK_JVMTI_VERIFY(jvmti->ResumeThread(testedThread))) {\n@@ -101,1 +98,1 @@\n-        NSK_TRACE(NSK_CPP_STUB2(DeleteGlobalRef, jni, testedThread));\n+        NSK_TRACE(jni->DeleteGlobalRef(testedThread));\n@@ -142,2 +139,1 @@\n-        if (!NSK_JVMTI_VERIFY(\n-                NSK_CPP_STUB2(AddCapabilities, jvmti, &suspendCaps)))\n+        if (!NSK_JVMTI_VERIFY(jvmti->AddCapabilities(&suspendCaps)))\n","filename":"test\/hotspot\/jtreg\/vmTestbase\/nsk\/jvmti\/SuspendThread\/suspendthrd001\/suspendthrd001.cpp","additions":5,"deletions":9,"binary":false,"changes":14,"status":"modified"},{"patch":"@@ -78,2 +78,1 @@\n-        if (!NSK_JVMTI_VERIFY(\n-                NSK_CPP_STUB2(SuspendThread, jvmti, testedThread))) {\n+        if (!NSK_JVMTI_VERIFY(jvmti->SuspendThread(testedThread))) {\n@@ -107,2 +106,1 @@\n-        if (!NSK_JVMTI_VERIFY(\n-                NSK_CPP_STUB2(ResumeThread, jvmti, testedThread))) {\n+        if (!NSK_JVMTI_VERIFY(jvmti->ResumeThread(testedThread))) {\n@@ -117,1 +115,1 @@\n-        NSK_TRACE(NSK_CPP_STUB2(DeleteGlobalRef, jni, testedThread));\n+        NSK_TRACE(jni->DeleteGlobalRef(testedThread));\n@@ -132,1 +130,1 @@\n-                NSK_CPP_STUB3(IsSameObject, jni, testedThread, thread)) {\n+                jni->IsSameObject(testedThread, thread)) {\n@@ -173,2 +171,1 @@\n-        if (!NSK_JVMTI_VERIFY(\n-                NSK_CPP_STUB2(AddCapabilities, jvmti, &suspendCaps)))\n+        if (!NSK_JVMTI_VERIFY(jvmti->AddCapabilities(&suspendCaps)))\n@@ -183,2 +180,1 @@\n-        if (!NSK_JVMTI_VERIFY(\n-                NSK_CPP_STUB3(SetEventCallbacks, jvmti, &callbacks, sizeof(callbacks))))\n+        if (!NSK_JVMTI_VERIFY(jvmti->SetEventCallbacks(&callbacks, sizeof(callbacks))))\n","filename":"test\/hotspot\/jtreg\/vmTestbase\/nsk\/jvmti\/SuspendThread\/suspendthrd002\/suspendthrd002.cpp","additions":6,"deletions":10,"binary":false,"changes":16,"status":"modified"},{"patch":"@@ -66,2 +66,1 @@\n-        if (!NSK_JVMTI_VERIFY(\n-                NSK_CPP_STUB2(SuspendThread, jvmti, testedThread))) {\n+        if (!NSK_JVMTI_VERIFY(jvmti->SuspendThread(testedThread))) {\n@@ -81,2 +80,1 @@\n-            if (!NSK_JVMTI_VERIFY(\n-                    NSK_CPP_STUB3(GetThreadState, jvmti, testedThread, &state))) {\n+            if (!NSK_JVMTI_VERIFY(jvmti->GetThreadState(testedThread, &state))) {\n@@ -97,2 +95,1 @@\n-        if (!NSK_JVMTI_VERIFY(\n-                NSK_CPP_STUB2(ResumeThread, jvmti, testedThread))) {\n+        if (!NSK_JVMTI_VERIFY(jvmti->ResumeThread(testedThread))) {\n@@ -110,1 +107,1 @@\n-            l_err = NSK_CPP_STUB2(SuspendThread, jvmti, testedThread);\n+            l_err = jvmti->SuspendThread(testedThread);\n@@ -120,2 +117,1 @@\n-            if (!NSK_JVMTI_VERIFY(\n-                    NSK_CPP_STUB2(ResumeThread, jvmti, testedThread))) {\n+            if (!NSK_JVMTI_VERIFY(jvmti->ResumeThread(testedThread))) {\n@@ -140,1 +136,1 @@\n-        NSK_TRACE(NSK_CPP_STUB2(DeleteGlobalRef, jni, testedThread));\n+        NSK_TRACE(jni->DeleteGlobalRef(testedThread));\n@@ -183,2 +179,1 @@\n-        if (!NSK_JVMTI_VERIFY(\n-                NSK_CPP_STUB2(AddCapabilities, jvmti, &suspendCaps)))\n+        if (!NSK_JVMTI_VERIFY(jvmti->AddCapabilities(&suspendCaps)))\n","filename":"test\/hotspot\/jtreg\/vmTestbase\/nsk\/jvmti\/SuspendThread\/suspendthrd003\/suspendthrd003.cpp","additions":7,"deletions":12,"binary":false,"changes":19,"status":"modified"},{"patch":"@@ -65,3 +65,2 @@\n-        if (!NSK_JVMTI_VERIFY(\n-                NSK_CPP_STUB3(Allocate, jvmti, (threadsCount * sizeof(jthread)),\n-                                                (unsigned char**)&threads))) {\n+        if (!NSK_JVMTI_VERIFY(jvmti->Allocate((threadsCount * sizeof(jthread)),\n+                                              (unsigned char**)&threads))) {\n@@ -74,3 +73,2 @@\n-        if (!NSK_JVMTI_VERIFY(\n-                NSK_CPP_STUB3(Allocate, jvmti, (threadsCount * sizeof(jvmtiError)),\n-                                                (unsigned char**)&results))) {\n+        if (!NSK_JVMTI_VERIFY(jvmti->Allocate((threadsCount * sizeof(jvmtiError)),\n+                                              (unsigned char**)&results))) {\n@@ -87,2 +85,1 @@\n-        if (!NSK_JVMTI_VERIFY(\n-                NSK_CPP_STUB4(SuspendThreadList, jvmti, threadsCount, threads, results))) {\n+        if (!NSK_JVMTI_VERIFY(jvmti->SuspendThreadList(threadsCount, threads, results))) {\n@@ -110,2 +107,1 @@\n-            if (!NSK_JVMTI_VERIFY(\n-                    NSK_CPP_STUB3(GetThreadState, jvmti, threads[i], &state))) {\n+            if (!NSK_JVMTI_VERIFY(jvmti->GetThreadState(threads[i], &state))) {\n@@ -126,2 +122,1 @@\n-        if (!NSK_JVMTI_VERIFY(\n-                NSK_CPP_STUB4(ResumeThreadList, jvmti, threadsCount, threads, results))) {\n+        if (!NSK_JVMTI_VERIFY(jvmti->ResumeThreadList(threadsCount, threads, results))) {\n@@ -139,1 +134,1 @@\n-                NSK_TRACE(NSK_CPP_STUB2(DeleteGlobalRef, jni, threads[i]));\n+                NSK_TRACE(jni->DeleteGlobalRef(threads[i]));\n@@ -143,2 +138,1 @@\n-        if (!NSK_JVMTI_VERIFY(\n-                NSK_CPP_STUB2(Deallocate, jvmti, (unsigned char*)threads))) {\n+        if (!NSK_JVMTI_VERIFY(jvmti->Deallocate((unsigned char*)threads))) {\n@@ -149,2 +143,1 @@\n-        if (!NSK_JVMTI_VERIFY(\n-                NSK_CPP_STUB2(Deallocate, jvmti, (unsigned char*)results))) {\n+        if (!NSK_JVMTI_VERIFY(jvmti->Deallocate((unsigned char*)results))) {\n@@ -176,2 +169,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-            NSK_CPP_STUB3(GetAllThreads, jvmti, &count, &threads))) {\n+    if (!NSK_JVMTI_VERIFY(jvmti->GetAllThreads(&count, &threads))) {\n@@ -186,2 +178,1 @@\n-        if (!NSK_JVMTI_VERIFY(\n-                NSK_CPP_STUB3(GetThreadInfo, jvmti, threads[i], &info))) {\n+        if (!NSK_JVMTI_VERIFY(jvmti->GetThreadInfo(threads[i], &info))) {\n@@ -202,2 +193,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-                NSK_CPP_STUB2(Deallocate, jvmti, (unsigned char*)threads))) {\n+    if (!NSK_JVMTI_VERIFY(jvmti->Deallocate((unsigned char*)threads))) {\n@@ -221,1 +211,1 @@\n-                    NSK_CPP_STUB2(NewGlobalRef, jni, foundThreads[i])) != NULL)) {\n+                    jni->NewGlobalRef(foundThreads[i])) != NULL)) {\n@@ -269,2 +259,1 @@\n-        if (!NSK_JVMTI_VERIFY(\n-                NSK_CPP_STUB2(AddCapabilities, jvmti, &suspendCaps)))\n+        if (!NSK_JVMTI_VERIFY(jvmti->AddCapabilities(&suspendCaps)))\n","filename":"test\/hotspot\/jtreg\/vmTestbase\/nsk\/jvmti\/SuspendThreadList\/suspendthrdlst001\/suspendthrdlst001.cpp","additions":15,"deletions":26,"binary":false,"changes":41,"status":"modified"},{"patch":"@@ -76,3 +76,2 @@\n-        if (!NSK_JVMTI_VERIFY(\n-                NSK_CPP_STUB3(Allocate, jvmti, (threadsCount * sizeof(jthread)),\n-                                                (unsigned char**)&threads))) {\n+        if (!NSK_JVMTI_VERIFY(jvmti->Allocate((threadsCount * sizeof(jthread)),\n+                                              (unsigned char**)&threads))) {\n@@ -85,3 +84,2 @@\n-        if (!NSK_JVMTI_VERIFY(\n-                NSK_CPP_STUB3(Allocate, jvmti, (threadsCount * sizeof(jvmtiError)),\n-                                                (unsigned char**)&results))) {\n+        if (!NSK_JVMTI_VERIFY(jvmti->Allocate((threadsCount * sizeof(jvmtiError)),\n+                                              (unsigned char**)&results))) {\n@@ -98,2 +96,1 @@\n-        if (!NSK_JVMTI_VERIFY(\n-                NSK_CPP_STUB4(SuspendThreadList, jvmti, threadsCount, threads, results))) {\n+        if (!NSK_JVMTI_VERIFY(jvmti->SuspendThreadList(threadsCount, threads, results))) {\n@@ -141,2 +138,1 @@\n-        if (!NSK_JVMTI_VERIFY(\n-                NSK_CPP_STUB4(ResumeThreadList, jvmti, threadsCount, threads, results))) {\n+        if (!NSK_JVMTI_VERIFY(jvmti->ResumeThreadList(threadsCount, threads, results))) {\n@@ -154,1 +150,1 @@\n-                NSK_TRACE(NSK_CPP_STUB2(DeleteGlobalRef, jni, threads[i]));\n+                NSK_TRACE(jni->DeleteGlobalRef(threads[i]));\n@@ -158,2 +154,1 @@\n-        if (!NSK_JVMTI_VERIFY(\n-                NSK_CPP_STUB2(Deallocate, jvmti, (unsigned char*)threads))) {\n+        if (!NSK_JVMTI_VERIFY(jvmti->Deallocate((unsigned char*)threads))) {\n@@ -164,2 +159,1 @@\n-        if (!NSK_JVMTI_VERIFY(\n-                NSK_CPP_STUB2(Deallocate, jvmti, (unsigned char*)results))) {\n+        if (!NSK_JVMTI_VERIFY(jvmti->Deallocate((unsigned char*)results))) {\n@@ -191,2 +185,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-            NSK_CPP_STUB3(GetAllThreads, jvmti, &count, &threads))) {\n+    if (!NSK_JVMTI_VERIFY(jvmti->GetAllThreads(&count, &threads))) {\n@@ -201,2 +194,1 @@\n-        if (!NSK_JVMTI_VERIFY(\n-                NSK_CPP_STUB3(GetThreadInfo, jvmti, threads[i], &info))) {\n+        if (!NSK_JVMTI_VERIFY(jvmti->GetThreadInfo(threads[i], &info))) {\n@@ -217,2 +209,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-                NSK_CPP_STUB2(Deallocate, jvmti, (unsigned char*)threads))) {\n+    if (!NSK_JVMTI_VERIFY(jvmti->Deallocate((unsigned char*)threads))) {\n@@ -236,1 +227,1 @@\n-                    NSK_CPP_STUB2(NewGlobalRef, jni, foundThreads[i])) != NULL)) {\n+                    jni->NewGlobalRef(foundThreads[i])) != NULL)) {\n@@ -256,1 +247,1 @@\n-                NSK_CPP_STUB3(IsSameObject, jni, threads[i], thread)) {\n+                jni->IsSameObject(threads[i], thread)) {\n@@ -304,2 +295,1 @@\n-        if (!NSK_JVMTI_VERIFY(\n-                NSK_CPP_STUB2(AddCapabilities, jvmti, &suspendCaps)))\n+        if (!NSK_JVMTI_VERIFY(jvmti->AddCapabilities(&suspendCaps)))\n@@ -314,2 +304,1 @@\n-        if (!NSK_JVMTI_VERIFY(\n-                NSK_CPP_STUB3(SetEventCallbacks, jvmti, &callbacks, sizeof(callbacks))))\n+        if (!NSK_JVMTI_VERIFY(jvmti->SetEventCallbacks(&callbacks, sizeof(callbacks))))\n","filename":"test\/hotspot\/jtreg\/vmTestbase\/nsk\/jvmti\/SuspendThreadList\/suspendthrdlst002\/suspendthrdlst002.cpp","additions":16,"deletions":27,"binary":false,"changes":43,"status":"modified"},{"patch":"@@ -60,3 +60,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-            NSK_CPP_STUB4(SetEventNotificationMode, jvmti, enable,\n-                                            event, NULL))) {\n+    if (!NSK_JVMTI_VERIFY(jvmti->SetEventNotificationMode(enable, event, NULL))) {\n@@ -95,4 +93,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-            NSK_CPP_STUB3(SetEventCallbacks, jvmti,\n-                                &eventCallbacks,\n-                                sizeof(eventCallbacks))))\n+    if (!NSK_JVMTI_VERIFY(jvmti->SetEventCallbacks(&eventCallbacks, sizeof(eventCallbacks))))\n","filename":"test\/hotspot\/jtreg\/vmTestbase\/nsk\/jvmti\/ThreadEnd\/threadend002\/threadend002.cpp","additions":2,"deletions":7,"binary":false,"changes":9,"status":"modified"},{"patch":"@@ -122,1 +122,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(RawMonitorEnter, jvmti, agent_start_lock))) {\n+    if (!NSK_JVMTI_VERIFY(jvmti->RawMonitorEnter(agent_start_lock))) {\n@@ -127,1 +127,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(RawMonitorNotifyAll, jvmti, agent_start_lock))) {\n+    if (!NSK_JVMTI_VERIFY(jvmti->RawMonitorNotifyAll(agent_start_lock))) {\n@@ -132,1 +132,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(RawMonitorExit, jvmti, agent_start_lock))) {\n+    if (!NSK_JVMTI_VERIFY(jvmti->RawMonitorExit(agent_start_lock))) {\n@@ -141,1 +141,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(RawMonitorEnter, jvmti, thr_start_lock))) {\n+    if (!NSK_JVMTI_VERIFY(jvmti->RawMonitorEnter(thr_start_lock))) {\n@@ -150,1 +150,1 @@\n-            if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB3(RawMonitorWait, jvmti, thr_start_lock, (jlong)0))) {\n+            if (!NSK_JVMTI_VERIFY(jvmti->RawMonitorWait(thr_start_lock, (jlong)0))) {\n@@ -158,1 +158,1 @@\n-             * next_thread = NSK_CPP_STUB2(NewGlobalRef, env, next_thread);\n+             * next_thread = env->NewGlobalRef(next_thread);\n@@ -160,1 +160,1 @@\n-            if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(SuspendThread, jvmti, next_thread))) {\n+            if (!NSK_JVMTI_VERIFY(jvmti->SuspendThread(next_thread))) {\n@@ -168,2 +168,2 @@\n-            temp = NSK_CPP_STUB2(NewGlobalRef, env, next_thread);\n-            NSK_CPP_STUB2(DeleteGlobalRef, env, temp);\n+            temp = env->NewGlobalRef(next_thread);\n+            env->DeleteGlobalRef(temp);\n@@ -171,1 +171,1 @@\n-            if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(ResumeThread, jvmti, next_thread))) {\n+            if (!NSK_JVMTI_VERIFY(jvmti->ResumeThread(next_thread))) {\n@@ -178,1 +178,1 @@\n-            if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB3(GetThreadState, jvmti, next_thread, &thrStat))) {\n+            if (!NSK_JVMTI_VERIFY(jvmti->GetThreadState(next_thread, &thrStat))) {\n@@ -188,1 +188,1 @@\n-                NSK_CPP_STUB2(FatalError, env, \"[agent] could not recover\");\n+                env->FatalError(\"[agent] could not recover\");\n@@ -191,1 +191,1 @@\n-            NSK_CPP_STUB2(DeleteGlobalRef, env, next_thread);\n+            env->DeleteGlobalRef(next_thread);\n@@ -195,1 +195,1 @@\n-            if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(RawMonitorEnter, jvmti, thr_resume_lock))) {\n+            if (!NSK_JVMTI_VERIFY(jvmti->RawMonitorEnter(thr_resume_lock))) {\n@@ -202,1 +202,1 @@\n-            if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(RawMonitorNotify, jvmti, thr_resume_lock))) {\n+            if (!NSK_JVMTI_VERIFY(jvmti->RawMonitorNotify(thr_resume_lock))) {\n@@ -207,1 +207,1 @@\n-            if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(RawMonitorExit, jvmti, thr_resume_lock))) {\n+            if (!NSK_JVMTI_VERIFY(jvmti->RawMonitorExit(thr_resume_lock))) {\n@@ -218,1 +218,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(RawMonitorExit, jvmti, thr_start_lock))) {\n+    if (!NSK_JVMTI_VERIFY(jvmti->RawMonitorExit(thr_start_lock))) {\n@@ -233,1 +233,1 @@\n-    if (NSK_CPP_STUB3(IsSameObject, env, agent_thread, thread) == JNI_TRUE) {\n+    if (env->IsSameObject(agent_thread, thread) == JNI_TRUE) {\n@@ -243,1 +243,1 @@\n-        if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(RawMonitorEnter, jvmti_env, agent_start_lock))) {\n+        if (!NSK_JVMTI_VERIFY(jvmti_env->RawMonitorEnter(agent_start_lock))) {\n@@ -251,2 +251,1 @@\n-            if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB3(RawMonitorWait,\n-                    jvmti_env, agent_start_lock, (jlong)WAIT_TIME))) {\n+            if (!NSK_JVMTI_VERIFY(jvmti_env->RawMonitorWait(agent_start_lock, (jlong)WAIT_TIME))) {\n@@ -258,1 +257,1 @@\n-        if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(RawMonitorExit, jvmti_env, agent_start_lock))) {\n+        if (!NSK_JVMTI_VERIFY(jvmti_env->RawMonitorExit(agent_start_lock))) {\n@@ -266,1 +265,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(GetPhase, jvmti_env, &phase))) {\n+    if (!NSK_JVMTI_VERIFY(jvmti_env->GetPhase(&phase))) {\n@@ -274,1 +273,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(RawMonitorEnter, jvmti_env, thr_event_lock))) {\n+    if (!NSK_JVMTI_VERIFY(jvmti_env->RawMonitorEnter(thr_event_lock))) {\n@@ -284,2 +283,1 @@\n-            if (!NSK_JVMTI_VERIFY(\n-                    NSK_CPP_STUB3(GetThreadInfo, jvmti_env, thread, &inf))) {\n+            if (!NSK_JVMTI_VERIFY(jvmti_env->GetThreadInfo(thread, &inf))) {\n@@ -294,1 +292,1 @@\n-        if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(RawMonitorEnter, jvmti_env, thr_start_lock))) {\n+        if (!NSK_JVMTI_VERIFY(jvmti_env->RawMonitorEnter(thr_start_lock))) {\n@@ -302,1 +300,1 @@\n-        if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(RawMonitorEnter, jvmti_env, thr_resume_lock))) {\n+        if (!NSK_JVMTI_VERIFY(jvmti_env->RawMonitorEnter(thr_resume_lock))) {\n@@ -308,1 +306,1 @@\n-        next_thread = NSK_CPP_STUB2(NewGlobalRef, env, thread);\n+        next_thread = env->NewGlobalRef(thread);\n@@ -312,1 +310,1 @@\n-        if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(RawMonitorNotify, jvmti_env, thr_start_lock))) {\n+        if (!NSK_JVMTI_VERIFY(jvmti_env->RawMonitorNotify(thr_start_lock))) {\n@@ -317,1 +315,1 @@\n-        if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(RawMonitorExit, jvmti_env, thr_start_lock))) {\n+        if (!NSK_JVMTI_VERIFY(jvmti_env->RawMonitorExit(thr_start_lock))) {\n@@ -323,2 +321,1 @@\n-        if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB3(RawMonitorWait,\n-                jvmti_env, thr_resume_lock, (jlong)WAIT_TIME ))) {\n+        if (!NSK_JVMTI_VERIFY(jvmti_env->RawMonitorWait(thr_resume_lock, (jlong)WAIT_TIME ))) {\n@@ -331,1 +328,1 @@\n-            NSK_CPP_STUB2(FatalError, env, \"[ThreadStart hook] could not recover\");\n+            env->FatalError(\"[ThreadStart hook] could not recover\");\n@@ -335,1 +332,1 @@\n-        if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(RawMonitorExit, jvmti_env, thr_resume_lock))) {\n+        if (!NSK_JVMTI_VERIFY(jvmti_env->RawMonitorExit(thr_resume_lock))) {\n@@ -341,1 +338,1 @@\n-        if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB3(GetThreadState, jvmti_env, thread, &thrStat))) {\n+        if (!NSK_JVMTI_VERIFY(jvmti_env->GetThreadState(thread, &thrStat))) {\n@@ -351,1 +348,1 @@\n-            NSK_CPP_STUB2(FatalError, env, \"[ThreadStart hook] could not recover\");\n+            env->FatalError(\"[ThreadStart hook] could not recover\");\n@@ -357,1 +354,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(RawMonitorExit, jvmti_env, thr_event_lock))) {\n+    if (!NSK_JVMTI_VERIFY(jvmti_env->RawMonitorExit(thr_event_lock))) {\n@@ -371,2 +368,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB4(SetEventNotificationMode,\n-            jvmti_env, JVMTI_ENABLE, JVMTI_EVENT_THREAD_START, NULL))) {\n+    if (!NSK_JVMTI_VERIFY(jvmti_env->SetEventNotificationMode(JVMTI_ENABLE, JVMTI_EVENT_THREAD_START, NULL))) {\n@@ -378,2 +374,1 @@\n-    if (!NSK_VERIFY((cls =\n-            NSK_CPP_STUB2(FindClass, env, \"java\/lang\/Thread\")) != NULL)) {\n+    if (!NSK_VERIFY((cls = env->FindClass(\"java\/lang\/Thread\")) != NULL)) {\n@@ -386,2 +381,1 @@\n-    if (!NSK_VERIFY((mid =\n-            NSK_CPP_STUB4(GetMethodID, env, cls, \"<init>\", \"()V\")) != NULL)) {\n+    if (!NSK_VERIFY((mid = env->GetMethodID(cls, \"<init>\", \"()V\")) != NULL)) {\n@@ -394,2 +388,1 @@\n-    if (!NSK_VERIFY((agent_thread =\n-            NSK_CPP_STUB3(NewObject, env, cls, mid)) != NULL)) {\n+    if (!NSK_VERIFY((agent_thread = env->NewObject(cls, mid)) != NULL)) {\n@@ -401,1 +394,1 @@\n-    agent_thread = (jthread) NSK_CPP_STUB2(NewGlobalRef, env, agent_thread);\n+    agent_thread = (jthread) env->NewGlobalRef(agent_thread);\n@@ -413,1 +406,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(RawMonitorEnter, jvmti_env, agent_start_lock))) {\n+    if (!NSK_JVMTI_VERIFY(jvmti_env->RawMonitorEnter(agent_start_lock))) {\n@@ -418,2 +411,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB5(RunAgentThread,\n-            jvmti_env, agent_thread, debug_agent, NULL, JVMTI_THREAD_NORM_PRIORITY))) {\n+    if (!NSK_JVMTI_VERIFY(jvmti_env->RunAgentThread(agent_thread, debug_agent, NULL, JVMTI_THREAD_NORM_PRIORITY))) {\n@@ -424,1 +416,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB3(RawMonitorWait, jvmti_env, agent_start_lock, (jlong)0))) {\n+    if (!NSK_JVMTI_VERIFY(jvmti_env->RawMonitorWait(agent_start_lock, (jlong)0))) {\n@@ -429,1 +421,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(RawMonitorExit, jvmti_env, agent_start_lock))) {\n+    if (!NSK_JVMTI_VERIFY(jvmti_env->RawMonitorExit(agent_start_lock))) {\n@@ -467,1 +459,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(GetPotentialCapabilities, jvmti, &caps))) {\n+    if (!NSK_JVMTI_VERIFY(jvmti->GetPotentialCapabilities(&caps))) {\n@@ -472,1 +464,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(AddCapabilities, jvmti, &caps))) {\n+    if (!NSK_JVMTI_VERIFY(jvmti->AddCapabilities(&caps))) {\n@@ -477,1 +469,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(GetCapabilities, jvmti, &caps))) {\n+    if (!NSK_JVMTI_VERIFY(jvmti->GetCapabilities(&caps))) {\n@@ -487,1 +479,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB3(CreateRawMonitor, jvmti, \"_agent_start_lock\", &agent_start_lock))) {\n+    if (!NSK_JVMTI_VERIFY(jvmti->CreateRawMonitor(\"_agent_start_lock\", &agent_start_lock))) {\n@@ -492,1 +484,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB3(CreateRawMonitor, jvmti, \"_thr_event_lock\", &thr_event_lock))) {\n+    if (!NSK_JVMTI_VERIFY(jvmti->CreateRawMonitor(\"_thr_event_lock\", &thr_event_lock))) {\n@@ -497,1 +489,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB3(CreateRawMonitor, jvmti, \"_thr_start_lock\", &thr_start_lock))) {\n+    if (!NSK_JVMTI_VERIFY(jvmti->CreateRawMonitor(\"_thr_start_lock\", &thr_start_lock))) {\n@@ -502,1 +494,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB3(CreateRawMonitor, jvmti, \"_thr_resume_lock\", &thr_resume_lock))) {\n+    if (!NSK_JVMTI_VERIFY(jvmti->CreateRawMonitor(\"_thr_resume_lock\", &thr_resume_lock))) {\n@@ -511,1 +503,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB3(SetEventCallbacks, jvmti, &callbacks, sizeof(callbacks)))) {\n+    if (!NSK_JVMTI_VERIFY(jvmti->SetEventCallbacks(&callbacks, sizeof(callbacks)))) {\n@@ -516,2 +508,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB4(SetEventNotificationMode,\n-            jvmti, JVMTI_ENABLE, JVMTI_EVENT_VM_INIT, NULL))) {\n+    if (!NSK_JVMTI_VERIFY(jvmti->SetEventNotificationMode(JVMTI_ENABLE, JVMTI_EVENT_VM_INIT, NULL))) {\n@@ -522,2 +513,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB4(SetEventNotificationMode,\n-            jvmti, JVMTI_ENABLE, JVMTI_EVENT_VM_DEATH, NULL))) {\n+    if (!NSK_JVMTI_VERIFY(jvmti->SetEventNotificationMode(JVMTI_ENABLE, JVMTI_EVENT_VM_DEATH, NULL))) {\n","filename":"test\/hotspot\/jtreg\/vmTestbase\/nsk\/jvmti\/ThreadStart\/threadstart002\/threadstart002.cpp","additions":54,"deletions":64,"binary":false,"changes":118,"status":"modified"},{"patch":"@@ -51,2 +51,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(GetPhase,\n-            jvmti, &phase)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->GetPhase(&phase)))\n@@ -91,2 +90,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB3(SetEventCallbacks,\n-            jvmti, &callbacks, sizeof(callbacks))))\n+    if (!NSK_JVMTI_VERIFY(jvmti->SetEventCallbacks(&callbacks, sizeof(callbacks))))\n@@ -96,2 +94,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB4(SetEventNotificationMode,\n-            jvmti, JVMTI_ENABLE, JVMTI_EVENT_VM_DEATH, NULL)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->SetEventNotificationMode(JVMTI_ENABLE, JVMTI_EVENT_VM_DEATH, NULL)))\n","filename":"test\/hotspot\/jtreg\/vmTestbase\/nsk\/jvmti\/VMDeath\/vmdeath001\/vmdeath001.cpp","additions":3,"deletions":6,"binary":false,"changes":9,"status":"modified"},{"patch":"@@ -64,2 +64,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB4(GetClassSignature, jvmti,\n-            object_klass, &signature, &generic))) {\n+    if (!NSK_JVMTI_VERIFY(jvmti->GetClassSignature(object_klass, &signature, &generic))) {\n@@ -73,1 +72,1 @@\n-        NSK_CPP_STUB2(Deallocate, jvmti, (unsigned char*)signature);\n+        jvmti->Deallocate((unsigned char*)signature);\n@@ -76,1 +75,1 @@\n-        NSK_CPP_STUB2(Deallocate, jvmti, (unsigned char*)generic);\n+        jvmti->Deallocate((unsigned char*)generic);\n@@ -133,1 +132,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(AddCapabilities, jvmti, &caps))) {\n+    if (!NSK_JVMTI_VERIFY(jvmti->AddCapabilities(&caps))) {\n@@ -139,3 +138,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-            NSK_CPP_STUB3(SetEventCallbacks, jvmti,\n-                &callbacks, sizeof(callbacks))))\n+    if (!NSK_JVMTI_VERIFY(jvmti->SetEventCallbacks(&callbacks, sizeof(callbacks))))\n@@ -146,2 +143,1 @@\n-            NSK_CPP_STUB4(SetEventNotificationMode, jvmti, JVMTI_ENABLE,\n-                JVMTI_EVENT_VM_OBJECT_ALLOC, NULL)))\n+            jvmti->SetEventNotificationMode(JVMTI_ENABLE, JVMTI_EVENT_VM_OBJECT_ALLOC, NULL)))\n","filename":"test\/hotspot\/jtreg\/vmTestbase\/nsk\/jvmti\/VMObjectAlloc\/vmobjalloc001\/vmobjalloc001.cpp","additions":6,"deletions":10,"binary":false,"changes":16,"status":"modified"},{"patch":"@@ -145,4 +145,2 @@\n-    if (!NSK_JVMTI_VERIFY(\n-            NSK_CPP_STUB3(Allocate, jvmti,\n-                                    (*objectsCount * sizeof(ObjectDesc)),\n-                                    (unsigned char**) objectDescList))) {\n+    if (!NSK_JVMTI_VERIFY(jvmti->Allocate((*objectsCount * sizeof(ObjectDesc)),\n+                                          (unsigned char**) objectDescList))) {\n@@ -183,2 +181,1 @@\n-    if (!NSK_JNI_VERIFY(jni, (*debugeeClass =\n-            NSK_CPP_STUB2(FindClass, jni, DEBUGEE_CLASS_NAME)) != NULL)) {\n+    if (!NSK_JNI_VERIFY(jni, (*debugeeClass = jni->FindClass(DEBUGEE_CLASS_NAME)) != NULL)) {\n@@ -193,1 +190,1 @@\n-            NSK_CPP_STUB2(FindClass, jni, ROOT_OBJECT_CLASS_NAME)) != NULL)) {\n+            jni->FindClass(ROOT_OBJECT_CLASS_NAME)) != NULL)) {\n@@ -198,3 +195,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB3(SetTag, jvmti,\n-                                                *rootObjectClass,\n-                                                ROOT_CLASS_TAG))) {\n+    if (!NSK_JVMTI_VERIFY(jvmti->SetTag(*rootObjectClass, ROOT_CLASS_TAG))) {\n@@ -211,1 +206,1 @@\n-            NSK_CPP_STUB2(FindClass, jni, CHAIN_OBJECT_CLASS_NAME)) != NULL)) {\n+            jni->FindClass(CHAIN_OBJECT_CLASS_NAME)) != NULL)) {\n@@ -216,3 +211,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB3(SetTag, jvmti,\n-                                                *chainObjectClass,\n-                                                CHAIN_CLASS_TAG))) {\n+    if (!NSK_JVMTI_VERIFY(jvmti->SetTag(*chainObjectClass, CHAIN_CLASS_TAG))) {\n@@ -244,4 +237,1 @@\n-            NSK_CPP_STUB4(GetStaticFieldID, jni,\n-                                            debugeeClass,\n-                                            OBJECT_FIELD_NAME,\n-                                            ROOT_OBJECT_CLASS_SIG)) != NULL)) {\n+            jni->GetStaticFieldID(debugeeClass, OBJECT_FIELD_NAME, ROOT_OBJECT_CLASS_SIG)) != NULL)) {\n@@ -256,3 +246,1 @@\n-            NSK_CPP_STUB4(GetFieldID, jni, rootObjectClass,\n-                          REACHABLE_CHAIN_FIELD_NAME,\n-                          CHAIN_OBJECT_CLASS_SIG)) != NULL)) {\n+            jni->GetFieldID(rootObjectClass, REACHABLE_CHAIN_FIELD_NAME, CHAIN_OBJECT_CLASS_SIG)) != NULL)) {\n@@ -267,3 +255,1 @@\n-            NSK_CPP_STUB4(GetFieldID, jni, rootObjectClass,\n-                          UNREACHABLE_CHAIN_FIELD_NAME,\n-                          CHAIN_OBJECT_CLASS_SIG)) != NULL)) {\n+            jni->GetFieldID(rootObjectClass, UNREACHABLE_CHAIN_FIELD_NAME, CHAIN_OBJECT_CLASS_SIG)) != NULL)) {\n@@ -279,2 +265,1 @@\n-            NSK_CPP_STUB4(GetFieldID, jni, chainObjectClass,\n-                          NEXT_FIELD_NAME, CHAIN_OBJECT_CLASS_SIG)) != NULL)) {\n+            jni->GetFieldID(chainObjectClass, NEXT_FIELD_NAME, CHAIN_OBJECT_CLASS_SIG)) != NULL)) {\n@@ -289,2 +274,1 @@\n-            NSK_CPP_STUB3(GetStaticObjectField, jni,\n-                          debugeeClass, rootObjectField)) != NULL)) {\n+            jni->GetStaticObjectField(debugeeClass, rootObjectField)) != NULL)) {\n@@ -297,2 +281,1 @@\n-    if (!NSK_JNI_VERIFY(jni, (*rootObjectPtr =\n-            NSK_CPP_STUB2(NewGlobalRef, jni, *rootObjectPtr)) != NULL)) {\n+    if (!NSK_JNI_VERIFY(jni, (*rootObjectPtr = jni->NewGlobalRef(*rootObjectPtr)) != NULL)) {\n@@ -331,2 +314,1 @@\n-    if (!NSK_JNI_VERIFY(jni, (nextObj =\n-         NSK_CPP_STUB3(GetObjectField, jni, currObj, refField)) != NULL)) {\n+    if (!NSK_JNI_VERIFY(jni, (nextObj = jni->GetObjectField(currObj, refField)) != NULL)) {\n@@ -342,1 +324,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB3(SetTag, jvmti, nextObj, objTag))) {\n+    if (!NSK_JVMTI_VERIFY(jvmti->SetTag(nextObj, objTag))) {\n@@ -362,1 +344,1 @@\n-    NSK_TRACE(NSK_CPP_STUB2(DeleteLocalRef, jni, nextObj));\n+    NSK_TRACE(jni->DeleteLocalRef(nextObj));\n@@ -414,3 +396,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB3(SetTag, jvmti,\n-                                                *rootObjectPtr,\n-                                                ROOT_OBJECT_TAG))\n+    if (!NSK_JVMTI_VERIFY(jvmti->SetTag(*rootObjectPtr, ROOT_OBJECT_TAG))\n@@ -534,1 +514,1 @@\n-        NSK_TRACE(NSK_CPP_STUB2(DeleteGlobalRef, jni, rootObject));\n+        NSK_TRACE(jni->DeleteGlobalRef(rootObject));\n@@ -539,2 +519,1 @@\n-        if (!NSK_JVMTI_VERIFY(\n-            NSK_CPP_STUB2(Deallocate, jvmti, (unsigned char*)objectDescList))) {\n+        if (!NSK_JVMTI_VERIFY(jvmti->Deallocate((unsigned char*)objectDescList))) {\n@@ -789,8 +768,5 @@\n-    if (!NSK_JVMTI_VERIFY(\n-            NSK_CPP_STUB6(FollowReferences, jvmti,\n-                                            (jint)   0,    \/* heap_filter    *\/\n-                                            (jclass) NULL, \/* class          *\/\n-                                            rootObject,    \/* initial_object *\/\n-                                            &heapCallbacks,\n-                                            (const void *) &fakeUserData))\n-    ) {\n+    if (!NSK_JVMTI_VERIFY(jvmti->FollowReferences((jint)   0,    \/* heap_filter    *\/\n+                                                  (jclass) NULL, \/* class          *\/\n+                                                  rootObject,    \/* initial_object *\/\n+                                                  &heapCallbacks,\n+                                                  (const void *) &fakeUserData))) {\n@@ -859,1 +835,1 @@\n-        if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(AddCapabilities, jvmti, &caps))) {\n+        if (!NSK_JVMTI_VERIFY(jvmti->AddCapabilities(&caps))) {\n","filename":"test\/hotspot\/jtreg\/vmTestbase\/nsk\/jvmti\/unit\/FollowReferences\/followref001\/followref001.cpp","additions":25,"deletions":49,"binary":false,"changes":74,"status":"modified"},{"patch":"@@ -122,2 +122,1 @@\n-    if (!NSK_JNI_VERIFY(jni, (obj =\n-            NSK_CPP_STUB3(GetObjectField, jni, firstObject, firstField)) != NULL)) {\n+    if (!NSK_JNI_VERIFY(jni, (obj = jni->GetObjectField(firstObject, firstField)) != NULL)) {\n@@ -133,1 +132,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB3(SetTag, jvmti, obj, objTag))) {\n+    if (!NSK_JVMTI_VERIFY(jvmti->SetTag(obj, objTag))) {\n@@ -150,1 +149,1 @@\n-    NSK_TRACE(NSK_CPP_STUB2(DeleteLocalRef, jni, obj));\n+    NSK_TRACE(jni->DeleteLocalRef(obj));\n@@ -177,3 +176,2 @@\n-    if (!NSK_JVMTI_VERIFY(\n-            NSK_CPP_STUB3(Allocate, jvmti, (*objectsCount * sizeof(ObjectDesc)),\n-                                             (unsigned char**)objectDescList))) {\n+    if (!NSK_JVMTI_VERIFY(jvmti->Allocate((*objectsCount * sizeof(ObjectDesc)),\n+                                          (unsigned char**)objectDescList))) {\n@@ -199,2 +197,1 @@\n-    if (!NSK_JNI_VERIFY(jni, (debugeeClass =\n-            NSK_CPP_STUB2(FindClass, jni, DEBUGEE_CLASS_NAME)) != NULL)) {\n+    if (!NSK_JNI_VERIFY(jni, (debugeeClass = jni->FindClass(DEBUGEE_CLASS_NAME)) != NULL)) {\n@@ -208,2 +205,1 @@\n-    if (!NSK_JNI_VERIFY(jni, (rootObjectClass =\n-            NSK_CPP_STUB2(FindClass, jni, ROOT_OBJECT_CLASS_NAME)) != NULL)) {\n+    if (!NSK_JNI_VERIFY(jni, (rootObjectClass = jni->FindClass(ROOT_OBJECT_CLASS_NAME)) != NULL)) {\n@@ -215,1 +211,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB3(SetTag, jvmti, rootObjectClass, rootClassTag))) {\n+    if (!NSK_JVMTI_VERIFY(jvmti->SetTag(rootObjectClass, rootClassTag))) {\n@@ -223,1 +219,1 @@\n-            NSK_CPP_STUB2(FindClass, jni, CHAIN_OBJECT_CLASS_NAME)) != NULL)) {\n+            jni->FindClass(CHAIN_OBJECT_CLASS_NAME)) != NULL)) {\n@@ -229,1 +225,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB3(SetTag, jvmti, chainObjectClass, chainClassTag))) {\n+    if (!NSK_JVMTI_VERIFY(jvmti->SetTag(chainObjectClass, chainClassTag))) {\n@@ -237,2 +233,1 @@\n-            NSK_CPP_STUB4(GetStaticFieldID, jni, debugeeClass,\n-                            OBJECT_FIELD_NAME, ROOT_OBJECT_CLASS_SIG)) != NULL)) {\n+            jni->GetStaticFieldID(debugeeClass, OBJECT_FIELD_NAME, ROOT_OBJECT_CLASS_SIG)) != NULL)) {\n@@ -247,2 +242,1 @@\n-            NSK_CPP_STUB4(GetFieldID, jni, rootObjectClass,\n-                        REACHABLE_CHAIN_FIELD_NAME, CHAIN_OBJECT_CLASS_SIG)) != NULL)) {\n+            jni->GetFieldID(rootObjectClass, REACHABLE_CHAIN_FIELD_NAME, CHAIN_OBJECT_CLASS_SIG)) != NULL)) {\n@@ -257,2 +251,1 @@\n-            NSK_CPP_STUB4(GetFieldID, jni, rootObjectClass,\n-                          UNREACHABLE_CHAIN_FIELD_NAME, CHAIN_OBJECT_CLASS_SIG)) != NULL)) {\n+            jni->GetFieldID(rootObjectClass, UNREACHABLE_CHAIN_FIELD_NAME, CHAIN_OBJECT_CLASS_SIG)) != NULL)) {\n@@ -267,2 +260,1 @@\n-            NSK_CPP_STUB4(GetFieldID, jni, chainObjectClass,\n-                          TAIL_FIELD_NAME, CHAIN_OBJECT_CLASS_SIG)) != NULL)) {\n+            jni->GetFieldID(chainObjectClass, TAIL_FIELD_NAME, CHAIN_OBJECT_CLASS_SIG)) != NULL)) {\n@@ -277,2 +269,1 @@\n-            NSK_CPP_STUB3(GetStaticObjectField, jni, debugeeClass,\n-                                                    objectField)) != NULL)) {\n+            jni->GetStaticObjectField(debugeeClass, objectField)) != NULL)) {\n@@ -285,2 +276,1 @@\n-    if (!NSK_JNI_VERIFY(jni, (*rootObject =\n-            NSK_CPP_STUB2(NewGlobalRef, jni, *rootObject)) != NULL)) {\n+    if (!NSK_JNI_VERIFY(jni, (*rootObject = jni->NewGlobalRef(*rootObject)) != NULL)) {\n@@ -296,1 +286,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB3(SetTag, jvmti, *rootObject, rootObjectTag))) {\n+    if (!NSK_JVMTI_VERIFY(jvmti->SetTag(*rootObject, rootObjectTag))) {\n@@ -409,1 +399,1 @@\n-        NSK_TRACE(NSK_CPP_STUB2(DeleteGlobalRef, jni, rootObject));\n+        NSK_TRACE(jni->DeleteGlobalRef(rootObject));\n@@ -414,2 +404,1 @@\n-        if (!NSK_JVMTI_VERIFY(\n-            NSK_CPP_STUB2(Deallocate, jvmti, (unsigned char*)objectDescList))) {\n+        if (!NSK_JVMTI_VERIFY(jvmti->Deallocate((unsigned char*)objectDescList))) {\n@@ -648,8 +637,5 @@\n-        if (!NSK_JVMTI_VERIFY(\n-                NSK_CPP_STUB6(FollowReferences, jvmti,\n-                    heap_filter,\n-                    (jclass) NULL, \/* class          *\/\n-                    rootObject,    \/* initial_object *\/\n-                    &heapCallbacks,\n-                    (const void *) &fakeUserData)))\n-        {\n+        if (!NSK_JVMTI_VERIFY(jvmti->FollowReferences(heap_filter,\n+                                                      (jclass) NULL, \/* class          *\/\n+                                                      rootObject,    \/* initial_object *\/\n+                                                      &heapCallbacks,\n+                                                      (const void *) &fakeUserData))) {\n@@ -684,8 +670,5 @@\n-        if (!NSK_JVMTI_VERIFY(\n-                NSK_CPP_STUB6(FollowReferences, jvmti,\n-                    heap_filter,\n-                    (jclass) NULL, \/* class          *\/\n-                    rootObject,    \/* initial_object *\/\n-                    &heapCallbacks,\n-                    (const void *) &fakeUserData)))\n-        {\n+        if (!NSK_JVMTI_VERIFY(jvmti->FollowReferences(heap_filter,\n+                                                      (jclass) NULL, \/* class          *\/\n+                                                      rootObject,    \/* initial_object *\/\n+                                                      &heapCallbacks,\n+                                                      (const void *) &fakeUserData))) {\n@@ -754,1 +737,1 @@\n-        if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(AddCapabilities, jvmti, &caps))) {\n+        if (!NSK_JVMTI_VERIFY(jvmti->AddCapabilities(&caps))) {\n","filename":"test\/hotspot\/jtreg\/vmTestbase\/nsk\/jvmti\/unit\/FollowReferences\/followref002\/followref002.cpp","additions":30,"deletions":47,"binary":false,"changes":77,"status":"modified"},{"patch":"@@ -141,2 +141,1 @@\n-    if (!NSK_JNI_VERIFY(jni, (obj =\n-            NSK_CPP_STUB3(GetObjectField, jni, firstObject, firstField)) != NULL)) {\n+    if (!NSK_JNI_VERIFY(jni, (obj = jni->GetObjectField(firstObject, firstField)) != NULL)) {\n@@ -149,1 +148,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB3(SetTag, jvmti, obj, objTag))) {\n+    if (!NSK_JVMTI_VERIFY(jvmti->SetTag(obj, objTag))) {\n@@ -160,1 +159,1 @@\n-    NSK_TRACE(NSK_CPP_STUB2(DeleteLocalRef, jni, obj));\n+    NSK_TRACE(jni->DeleteLocalRef(obj));\n@@ -181,3 +180,2 @@\n-    if (!NSK_JVMTI_VERIFY(\n-            NSK_CPP_STUB3(Allocate, jvmti, (*objectsCount * sizeof(ObjectDesc)),\n-                                             (unsigned char**)objectDescList))) {\n+    if (!NSK_JVMTI_VERIFY(jvmti->Allocate((*objectsCount * sizeof(ObjectDesc)),\n+                                          (unsigned char**)objectDescList))) {\n@@ -203,2 +201,1 @@\n-    if (!NSK_JNI_VERIFY(jni, (debugeeClass =\n-            NSK_CPP_STUB2(FindClass, jni, DEBUGEE_CLASS_NAME)) != NULL)) {\n+    if (!NSK_JNI_VERIFY(jni, (debugeeClass = jni->FindClass(DEBUGEE_CLASS_NAME)) != NULL)) {\n@@ -212,2 +209,1 @@\n-    if (!NSK_JNI_VERIFY(jni, (rootObjectClass =\n-            NSK_CPP_STUB2(FindClass, jni, ROOT_OBJECT_CLASS_NAME)) != NULL)) {\n+    if (!NSK_JNI_VERIFY(jni, (rootObjectClass = jni->FindClass(ROOT_OBJECT_CLASS_NAME)) != NULL)) {\n@@ -219,1 +215,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB3(SetTag, jvmti, rootObjectClass, rootClassTag))) {\n+    if (!NSK_JVMTI_VERIFY(jvmti->SetTag(rootObjectClass, rootClassTag))) {\n@@ -228,1 +224,1 @@\n-            NSK_CPP_STUB2(FindClass, jni, CHAIN_OBJECT_CLASS_NAME)) != NULL)) {\n+            jni->FindClass(CHAIN_OBJECT_CLASS_NAME)) != NULL)) {\n@@ -235,1 +231,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB3(SetTag, jvmti, chainObjectClass, chainClassTag))) {\n+    if (!NSK_JVMTI_VERIFY(jvmti->SetTag(chainObjectClass, chainClassTag))) {\n@@ -244,2 +240,1 @@\n-            NSK_CPP_STUB4(GetStaticFieldID, jni, debugeeClass,\n-                            OBJECT_FIELD_NAME, ROOT_OBJECT_CLASS_SIG)) != NULL)) {\n+            jni->GetStaticFieldID(debugeeClass, OBJECT_FIELD_NAME, ROOT_OBJECT_CLASS_SIG)) != NULL)) {\n@@ -254,2 +249,1 @@\n-            NSK_CPP_STUB4(GetFieldID, jni, rootObjectClass,\n-                        REACHABLE_CHAIN_FIELD_NAME, CHAIN_OBJECT_CLASS_SIG)) != NULL)) {\n+            jni->GetFieldID(rootObjectClass, REACHABLE_CHAIN_FIELD_NAME, CHAIN_OBJECT_CLASS_SIG)) != NULL)) {\n@@ -264,2 +258,1 @@\n-            NSK_CPP_STUB4(GetFieldID, jni, rootObjectClass,\n-                          UNREACHABLE_CHAIN_FIELD_NAME, CHAIN_OBJECT_CLASS_SIG)) != NULL)) {\n+            jni->GetFieldID(rootObjectClass, UNREACHABLE_CHAIN_FIELD_NAME, CHAIN_OBJECT_CLASS_SIG)) != NULL)) {\n@@ -274,2 +267,1 @@\n-            NSK_CPP_STUB4(GetFieldID, jni, chainObjectClass,\n-                          TAIL_FIELD_NAME, CHAIN_OBJECT_CLASS_SIG)) != NULL)) {\n+            jni->GetFieldID(chainObjectClass, TAIL_FIELD_NAME, CHAIN_OBJECT_CLASS_SIG)) != NULL)) {\n@@ -284,2 +276,1 @@\n-            NSK_CPP_STUB3(GetStaticObjectField, jni, debugeeClass,\n-                                                    objectField)) != NULL)) {\n+            jni->GetStaticObjectField(debugeeClass, objectField)) != NULL)) {\n@@ -292,2 +283,1 @@\n-    if (!NSK_JNI_VERIFY(jni, (*rootObject =\n-            NSK_CPP_STUB2(NewGlobalRef, jni, *rootObject)) != NULL)) {\n+    if (!NSK_JNI_VERIFY(jni, (*rootObject = jni->NewGlobalRef(*rootObject)) != NULL)) {\n@@ -303,1 +293,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB3(SetTag, jvmti, *rootObject, rootObjectTag))) {\n+    if (!NSK_JVMTI_VERIFY(jvmti->SetTag(*rootObject, rootObjectTag))) {\n@@ -409,1 +399,1 @@\n-        NSK_TRACE(NSK_CPP_STUB2(DeleteGlobalRef, jni, rootObject));\n+        NSK_TRACE(jni->DeleteGlobalRef(rootObject));\n@@ -414,2 +404,1 @@\n-        if (!NSK_JVMTI_VERIFY(\n-            NSK_CPP_STUB2(Deallocate, jvmti, (unsigned char*)objectDescList))) {\n+        if (!NSK_JVMTI_VERIFY(jvmti->Deallocate((unsigned char*)objectDescList))) {\n@@ -952,8 +941,5 @@\n-        if (!NSK_JVMTI_VERIFY(\n-                NSK_CPP_STUB6(FollowReferences, jvmti,\n-                    (jint)   0,     \/* heap_filter    *\/\n-                    (jclass)  NULL, \/* class          *\/\n-                    (jobject) NULL, \/* initial_object *\/\n-                    &heapCallbacks,\n-                    (const void *) &fakeUserData)))\n-        {\n+        if (!NSK_JVMTI_VERIFY(jvmti->FollowReferences((jint)   0,     \/* heap_filter    *\/\n+                                                      (jclass)  NULL, \/* class          *\/\n+                                                      (jobject) NULL, \/* initial_object *\/\n+                                                      &heapCallbacks,\n+                                                      (const void *) &fakeUserData))) {\n@@ -993,8 +979,5 @@\n-        if (!NSK_JVMTI_VERIFY(\n-                NSK_CPP_STUB6(FollowReferences, jvmti,\n-                    heap_filter,\n-                    (jclass)  NULL, \/* class          *\/\n-                    (jobject) NULL, \/* initial_object *\/\n-                    &heapCallbacks,\n-                    (const void *) &fakeUserData)))\n-        {\n+        if (!NSK_JVMTI_VERIFY(jvmti->FollowReferences(heap_filter,\n+                                                      (jclass)  NULL, \/* class          *\/\n+                                                      (jobject) NULL, \/* initial_object *\/\n+                                                      &heapCallbacks,\n+                                                      (const void *) &fakeUserData))) {\n@@ -1089,1 +1072,1 @@\n-        if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(AddCapabilities, jvmti, &caps))) {\n+        if (!NSK_JVMTI_VERIFY(jvmti->AddCapabilities(&caps))) {\n","filename":"test\/hotspot\/jtreg\/vmTestbase\/nsk\/jvmti\/unit\/FollowReferences\/followref003\/followref003.cpp","additions":30,"deletions":47,"binary":false,"changes":77,"status":"modified"},{"patch":"@@ -149,1 +149,1 @@\n-    if  ( ! NSK_JNI_VERIFY(jni, (klass = NSK_CPP_STUB2(FindClass, jni, JAVA_LANG_STRING_CLASS_NAME)) != NULL) ) {\n+    if  ( ! NSK_JNI_VERIFY(jni, (klass = jni->FindClass(JAVA_LANG_STRING_CLASS_NAME)) != NULL) ) {\n@@ -154,1 +154,1 @@\n-    if ( ! NSK_JNI_VERIFY(jni, (g_jniGlobalRef = NSK_CPP_STUB2(NewGlobalRef, jni, klass)) != NULL) ) {\n+    if ( ! NSK_JNI_VERIFY(jni, (g_jniGlobalRef = jni->NewGlobalRef(klass)) != NULL) ) {\n@@ -158,1 +158,1 @@\n-    if ( ! NSK_JNI_VERIFY(jni, (g_jniWeakGlobalRef = NSK_CPP_STUB2(NewWeakGlobalRef, jni, klass)) != NULL) ) {\n+    if ( ! NSK_JNI_VERIFY(jni, (g_jniWeakGlobalRef = jni->NewWeakGlobalRef(klass)) != NULL) ) {\n@@ -182,7 +182,5 @@\n-    retCode = NSK_CPP_STUB6(FollowReferences,\n-                              jvmti,\n-                              (jint) 0,                 \/* heap filter *\/\n-                              NULL,                     \/* class *\/\n-                              NULL,                     \/* inital object *\/\n-                              &g_heapCallbacks,\n-                              (const void *) &g_fakeUserData);\n+    retCode = jvmti->FollowReferences((jint) 0,                 \/* heap filter *\/\n+                                      NULL,                     \/* class *\/\n+                                      NULL,                     \/* inital object *\/\n+                                      &g_heapCallbacks,\n+                                      (const void *) &g_fakeUserData);\n@@ -250,1 +248,1 @@\n-        if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(AddCapabilities, jvmti, &caps))) {\n+        if (!NSK_JVMTI_VERIFY(jvmti->AddCapabilities(&caps))) {\n","filename":"test\/hotspot\/jtreg\/vmTestbase\/nsk\/jvmti\/unit\/FollowReferences\/followref004\/followref004.cpp","additions":9,"deletions":11,"binary":false,"changes":20,"status":"modified"},{"patch":"@@ -48,7 +48,5 @@\n-    retCode = NSK_CPP_STUB6(FollowReferences,\n-                              jvmti,\n-                              (jint) 0,                 \/* heap filter *\/\n-                              NULL,                     \/* class *\/\n-                              NULL,                     \/* inital object *\/\n-                              &g_wrongHeapCallbacks,\n-                              (const void *) &g_fakeUserData);\n+    retCode = jvmti->FollowReferences((jint) 0,                 \/* heap filter *\/\n+                                      NULL,                     \/* class *\/\n+                                      NULL,                     \/* inital object *\/\n+                                      &g_wrongHeapCallbacks,\n+                                      (const void *) &g_fakeUserData);\n@@ -61,6 +59,4 @@\n-    retCode = NSK_CPP_STUB5(IterateThroughHeap,\n-                              jvmti,\n-                              (jint) 0,                 \/* heap filter *\/\n-                              NULL,                     \/* class *\/\n-                              &g_wrongHeapCallbacks,\n-                              (const void *) &g_fakeUserData);\n+    retCode = jvmti->IterateThroughHeap((jint) 0,                 \/* heap filter *\/\n+                                        NULL,                     \/* class *\/\n+                                        &g_wrongHeapCallbacks,\n+                                        (const void *) &g_fakeUserData);\n@@ -73,4 +69,1 @@\n-    retCode = NSK_CPP_STUB3(GetTag,\n-                              jvmti,\n-                              (jobject) &g_wrongHeapCallbacks,\n-                              &tag);\n+    retCode = jvmti->GetTag((jobject) &g_wrongHeapCallbacks, &tag);\n@@ -83,4 +76,1 @@\n-    retCode = NSK_CPP_STUB3(SetTag,\n-                              jvmti,\n-                              (jobject) &g_wrongHeapCallbacks,\n-                              tag);\n+    retCode = jvmti->SetTag((jobject) &g_wrongHeapCallbacks, tag);\n@@ -93,7 +83,1 @@\n-    retCode = NSK_CPP_STUB6(GetObjectsWithTags,\n-                              jvmti,\n-                              1,\n-                              &tag,\n-                              &cnt,\n-                              &pObjs,\n-                              &pObjTags);\n+    retCode = jvmti->GetObjectsWithTags(1, &tag, &cnt, &pObjs, &pObjTags);\n@@ -151,1 +135,1 @@\n-        if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(AddCapabilities, jvmti, &caps))) {\n+        if (!NSK_JVMTI_VERIFY(jvmti->AddCapabilities(&caps))) {\n","filename":"test\/hotspot\/jtreg\/vmTestbase\/nsk\/jvmti\/unit\/FollowReferences\/followref005\/followref005.cpp","additions":13,"deletions":29,"binary":false,"changes":42,"status":"modified"},{"patch":"@@ -52,7 +52,5 @@\n-    retCode = NSK_CPP_STUB6(FollowReferences,\n-                              jvmti,\n-                              (jint) 0,                 \/* heap filter *\/\n-                              (jclass) &g_wrongHeapCallbacks ,   \/* invalid class, but valid memory address *\/\n-                              NULL,                     \/* inital object *\/\n-                              &g_wrongHeapCallbacks,\n-                              (const void *) &g_fakeUserData);\n+    retCode = jvmti->FollowReferences((jint) 0,                 \/* heap filter *\/\n+                                      (jclass) &g_wrongHeapCallbacks ,   \/* invalid class, but valid memory address *\/\n+                                      NULL,                     \/* inital object *\/\n+                                      &g_wrongHeapCallbacks,\n+                                      (const void *) &g_fakeUserData);\n@@ -78,7 +76,5 @@\n-    retCode = NSK_CPP_STUB6(FollowReferences,\n-                            jvmti,\n-                            (jint) 0,               \/\/ heap filter\n-                            NULL,                   \/\/ class\n-                            (jobject) &g_wrongHeapCallbacks,  \/\/ invalid inital object\n-                            &emptyHeapCallbacks,    \/\/ No callbacks\n-                            (const void *) &g_fakeUserData);\n+    retCode = jvmti->FollowReferences((jint) 0,               \/\/ heap filter\n+                                      NULL,                   \/\/ class\n+                                      (jobject) &g_wrongHeapCallbacks,  \/\/ invalid inital object\n+                                      &emptyHeapCallbacks,    \/\/ No callbacks\n+                                      (const void *) &g_fakeUserData);\n@@ -93,7 +89,5 @@\n-    retCode = NSK_CPP_STUB6(FollowReferences,\n-                              jvmti,\n-                              (jint) 0,     \/* heap filter *\/\n-                              NULL,         \/* class *\/\n-                              NULL,         \/* inital object *\/\n-                              NULL,\n-                              (const void *) &g_fakeUserData);\n+    retCode = jvmti->FollowReferences((jint) 0,     \/* heap filter *\/\n+                                      NULL,         \/* class *\/\n+                                      NULL,         \/* inital object *\/\n+                                      NULL,\n+                                      (const void *) &g_fakeUserData);\n@@ -107,4 +101,2 @@\n-    retCode = NSK_CPP_STUB3(GetTag,\n-                              jvmti,\n-                              (jobject) &g_wrongHeapCallbacks,  \/* invalid inital object *\/\n-                              &tag);\n+    retCode = jvmti->GetTag((jobject) &g_wrongHeapCallbacks,  \/* invalid inital object *\/\n+                            &tag);\n@@ -118,4 +110,1 @@\n-    retCode = NSK_CPP_STUB3(GetTag,\n-                              jvmti,\n-                              NULL,\n-                              &tag);\n+    retCode = jvmti->GetTag(NULL, &tag);\n@@ -129,4 +118,1 @@\n-    retCode = NSK_CPP_STUB3(GetTag,\n-                              jvmti,\n-                              (jobject) &g_wrongHeapCallbacks,\n-                              NULL);\n+    retCode = jvmti->GetTag((jobject) &g_wrongHeapCallbacks, NULL);\n@@ -141,4 +127,2 @@\n-    retCode = NSK_CPP_STUB3(SetTag,\n-                              jvmti,\n-                              (jobject) &g_wrongHeapCallbacks,  \/* invalid inital object *\/\n-                              tag);\n+    retCode = jvmti->SetTag((jobject) &g_wrongHeapCallbacks,  \/* invalid inital object *\/\n+                            tag);\n@@ -152,4 +136,1 @@\n-    retCode = NSK_CPP_STUB3(GetTag,\n-                              jvmti,\n-                              NULL,\n-                              &tag);\n+    retCode = jvmti->GetTag(NULL, &tag);\n@@ -173,2 +154,1 @@\n-    if (!NSK_JNI_VERIFY(jni, (klass =\n-            NSK_CPP_STUB2(FindClass, jni, szClassName)) != NULL)) {\n+    if (!NSK_JNI_VERIFY(jni, (klass = jni->FindClass(szClassName)) != NULL)) {\n@@ -179,7 +159,5 @@\n-    retCode = NSK_CPP_STUB6(FollowReferences,\n-                              jvmti,\n-                              (jint) 0,     \/* heap filter *\/\n-                              klass, \/* class *\/\n-                              NULL,         \/* inital object *\/\n-                              &g_wrongHeapCallbacks,\n-                              (const void *) &g_fakeUserData);\n+    retCode = jvmti->FollowReferences((jint) 0,     \/* heap filter *\/\n+                                      klass, \/* class *\/\n+                                      NULL,         \/* inital object *\/\n+                                      &g_wrongHeapCallbacks,\n+                                      (const void *) &g_fakeUserData);\n@@ -255,1 +233,1 @@\n-        if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(AddCapabilities, jvmti, &caps))) {\n+        if (!NSK_JVMTI_VERIFY(jvmti->AddCapabilities(&caps))) {\n","filename":"test\/hotspot\/jtreg\/vmTestbase\/nsk\/jvmti\/unit\/FollowReferences\/followref006\/followref006.cpp","additions":29,"deletions":51,"binary":false,"changes":80,"status":"modified"},{"patch":"@@ -32,1 +32,1 @@\n-            NSK_CPP_STUB2(GetObjectClass, env, _obj)) != NULL))\\\n+            env->GetObjectClass(_obj)) != NULL))\\\n@@ -37,2 +37,1 @@\n-    if (!NSK_JNI_VERIFY_VOID(env, NSK_CPP_STUB3(CallStaticVoidMethod, env,\\\n-                            _class, method)))\\\n+    if (!NSK_JNI_VERIFY_VOID(env, env->CallStaticVoidMethod(_class, method)))\\\n@@ -43,2 +42,1 @@\n-            NSK_CPP_STUB4(GetStaticMethodID, env, _class,\\\n-                _methodName, _sig)) != NULL))\\\n+            env->GetStaticMethodID(_class, _methodName, _sig)) != NULL))\\\n@@ -49,2 +47,1 @@\n-            NSK_CPP_STUB4(GetMethodID, env, _class,\\\n-                _methodName, _sig)) != NULL))\\\n+            env->GetMethodID(_class, _methodName, _sig)) != NULL))\\\n@@ -55,2 +52,1 @@\n-    if (!NSK_JNI_VERIFY_VOID(env, NSK_CPP_STUB3(CallVoidMethod, env, _obj,\\\n-                                                    method)))\\\n+    if (!NSK_JNI_VERIFY_VOID(env, env->CallVoidMethod(_obj, method)))\\\n@@ -74,3 +70,1 @@\n-                                     NSK_CPP_STUB5(CallIntMethod, env, obj,\n-                                                   method, maxDepth,\n-                                                   currentDepth))) {\n+                                     env->CallIntMethod(obj, method, maxDepth, currentDepth))) {\n@@ -82,4 +76,1 @@\n-                                     NSK_CPP_STUB6(CallIntMethod, env, obj,\n-                                                   method, maxDepth,\n-                                                   currentDepth,\n-                                                   returnToJava))) {\n+                                     env->CallIntMethod(obj, method, maxDepth, currentDepth, returnToJava))) {\n","filename":"test\/hotspot\/jtreg\/vmTestbase\/nsk\/monitoring\/share\/StackTraceController.cpp","additions":7,"deletions":16,"binary":false,"changes":23,"status":"modified"},{"patch":"@@ -34,1 +34,1 @@\n-            NSK_CPP_STUB2(FindClass, env, _className)) != NULL))\\\n+            env->FindClass(_className)) != NULL))\\\n@@ -39,1 +39,1 @@\n-            NSK_CPP_STUB2(GetObjectClass, env, _obj)) != NULL))\\\n+            env->GetObjectClass(_obj)) != NULL))\\\n@@ -44,2 +44,1 @@\n-            NSK_CPP_STUB4(GetStaticFieldID, env, _class,\\\n-                _fieldName, _fieldSig)) != NULL))\\\n+            env->GetStaticFieldID(_class, _fieldName, _fieldSig)) != NULL))\\\n@@ -50,2 +49,1 @@\n-    _value = NSK_CPP_STUB3(GetStaticObjectField, env, _class, \\\n-                                field)\n+    _value = env->GetStaticObjectField(_class, field)\n@@ -55,1 +53,1 @@\n-    _value = NSK_CPP_STUB3(GetStaticBooleanField, env, _class, field)\n+    _value = env->GetStaticBooleanField(_class, field)\n@@ -59,2 +57,1 @@\n-            NSK_CPP_STUB4(GetFieldID, env, _class,\\\n-                _fieldName, _fieldSig)) != NULL))\\\n+            env->GetFieldID(_class, _fieldName, _fieldSig)) != NULL))\\\n@@ -65,1 +62,1 @@\n-    _value = NSK_CPP_STUB3(GetIntField, env, _obj, field)\n+    _value = env->GetIntField(_obj, field)\n@@ -69,1 +66,1 @@\n-    _value = NSK_CPP_STUB3(GetBooleanField, env, _obj, field)\n+    _value = env->GetBooleanField(_obj, field)\n@@ -73,1 +70,1 @@\n-    _value = NSK_CPP_STUB3(GetLongField, env, _obj, field)\n+    _value = env->GetLongField(_obj, field)\n@@ -77,1 +74,1 @@\n-    _value = NSK_CPP_STUB3(GetStaticIntField, env, _class, field)\n+    _value = env->GetStaticIntField(_class, field)\n@@ -81,1 +78,1 @@\n-    NSK_CPP_STUB4(SetIntField, env, _obj, field, _newValue)\n+    env->SetIntField(_obj, field, _newValue)\n@@ -85,1 +82,1 @@\n-    _value = NSK_CPP_STUB3(GetObjectField, env, _obj, field)\n+    _value = env->GetObjectField(_obj, field)\n@@ -89,1 +86,1 @@\n-    NSK_CPP_STUB3(GetObjectArrayElement, env, _arr, _index)\n+    env->GetObjectArrayElement(_arr, _index)\n@@ -92,1 +89,1 @@\n-    NSK_CPP_STUB4(SetObjectArrayElement, env, _arr, _index, _newValue)\n+    env->SetObjectArrayElement(_arr, _index, _newValue)\n@@ -96,2 +93,1 @@\n-            NSK_CPP_STUB4(GetStaticMethodID, env, _class,\\\n-                _methodName, _sig)) != NULL))\\\n+            env->GetStaticMethodID(_class, _methodName, _sig)) != NULL))\\\n@@ -102,2 +98,1 @@\n-            NSK_CPP_STUB4(GetMethodID, env, _class,\\\n-                _methodName, _sig)) != NULL))\\\n+            env->GetMethodID(_class, _methodName, _sig)) != NULL))\\\n@@ -108,2 +103,1 @@\n-    if (!NSK_JNI_VERIFY_VOID(env, NSK_CPP_STUB3(CallStaticVoidMethod, env,\\\n-                            _class, method)))\\\n+    if (!NSK_JNI_VERIFY_VOID(env, env->CallStaticVoidMethod(_class, method)))\\\n@@ -114,2 +108,1 @@\n-    if (!NSK_JNI_VERIFY_VOID(env, NSK_CPP_STUB4(CallStaticVoidMethod, env,\\\n-                                                    _class, method, _param)))\\\n+    if (!NSK_JNI_VERIFY_VOID(env, env->CallStaticVoidMethod(_class, method, _param)))\\\n@@ -120,1 +113,1 @@\n-    _value = NSK_CPP_STUB4(CallStaticObjectMethod, env, _class, method, _param)\n+    _value = env->CallStaticObjectMethod(_class, method, _param)\n@@ -124,2 +117,1 @@\n-    if (!NSK_JNI_VERIFY_VOID(env, NSK_CPP_STUB3(CallVoidMethod, env, _obj,\\\n-                                                    method)))\\\n+    if (!NSK_JNI_VERIFY_VOID(env, env->CallVoidMethod(_obj, method)))\\\n@@ -130,2 +122,1 @@\n-    if (!NSK_JNI_VERIFY_VOID(env, NSK_CPP_STUB4(CallVoidMethod, env, _obj,\\\n-                                                    method, _param)))\\\n+    if (!NSK_JNI_VERIFY_VOID(env, env->CallVoidMethod(_obj, method, _param)))\\\n@@ -136,2 +127,1 @@\n-    if (!NSK_JNI_VERIFY_VOID(env, NSK_CPP_STUB5(CallVoidMethod, env, _obj, \\\n-                                                    method, _param1, _param2)))\\\n+    if (!NSK_JNI_VERIFY_VOID(env, env->CallVoidMethod(_obj, method, _param1, _param2)))\\\n@@ -142,1 +132,1 @@\n-    _value = NSK_CPP_STUB3(CallIntMethod, env, _obj, method)\n+    _value = env->CallIntMethod(_obj, method)\n@@ -147,1 +137,1 @@\n-            NSK_CPP_STUB4(NewObject, env, _class, method, _params)) != NULL))\\\n+            env->NewObject(_class, method, _params)) != NULL))\\\n@@ -151,1 +141,1 @@\n-    NSK_JNI_VERIFY(env, NSK_CPP_STUB2(MonitorEnter, env, x) == 0)\n+    NSK_JNI_VERIFY(env, env->MonitorEnter(x) == 0)\n@@ -154,1 +144,1 @@\n-    NSK_JNI_VERIFY(env, NSK_CPP_STUB2(MonitorExit, env, x) == 0)\n+    NSK_JNI_VERIFY(env, env->MonitorExit(x) == 0)\n@@ -158,1 +148,1 @@\n-   jmsg = NSK_CPP_STUB2(NewStringUTF, env, msg);\\\n+   jmsg = env->NewStringUTF(msg);\\\n@@ -500,1 +490,1 @@\n-             NSK_CPP_STUB2(GetJavaVM, env, &vm) == 0)) {\n+             env->GetJavaVM(&vm) == 0)) {\n@@ -505,1 +495,1 @@\n-             NSK_CPP_STUB3(GetEnv, vm, (void **)&jvmti, JVMTI_VERSION_1)\n+             vm->GetEnv((void **)&jvmti, JVMTI_VERSION_1)\n@@ -511,1 +501,1 @@\n-             NSK_CPP_STUB3(GetThreadState, jvmti, (jthread)thread, &state)\n+             jvmti->GetThreadState((jthread)thread, &state)\n@@ -517,1 +507,1 @@\n-        if (!NSK_JNI_VERIFY(env, (ThreadState = NSK_CPP_STUB2(FindClass, env, \"java\/lang\/Thread$State\")) != NULL))\n+        if (!NSK_JNI_VERIFY(env, (ThreadState = env->FindClass(\"java\/lang\/Thread$State\")) != NULL))\n@@ -520,1 +510,1 @@\n-        if (!NSK_JNI_VERIFY(env, (method = NSK_CPP_STUB4(GetStaticMethodID, env, ThreadState, \"valueOf\", \"(Ljava\/lang\/String;)Ljava\/lang\/Thread$State;\")) != NULL))\n+        if (!NSK_JNI_VERIFY(env, (method = env->GetStaticMethodID(ThreadState, \"valueOf\", \"(Ljava\/lang\/String;)Ljava\/lang\/Thread$State;\")) != NULL))\n@@ -522,1 +512,1 @@\n-        threadState = NSK_CPP_STUB4(CallStaticObjectMethod, env, ThreadState, method, stateName);\n+        threadState = env->CallStaticObjectMethod(ThreadState, method, stateName);\n","filename":"test\/hotspot\/jtreg\/vmTestbase\/nsk\/monitoring\/share\/ThreadController.cpp","additions":33,"deletions":43,"binary":false,"changes":76,"status":"modified"},{"patch":"@@ -30,1 +30,1 @@\n-             NSK_CPP_STUB2(FindClass, env, _className)) != NULL))\\\n+             env->FindClass(_className)) != NULL))\\\n@@ -35,1 +35,1 @@\n-             NSK_CPP_STUB2(GetObjectClass, env, _obj)) != NULL))\\\n+             env->GetObjectClass(_obj)) != NULL))\\\n@@ -40,1 +40,1 @@\n-        _value = NSK_CPP_STUB3(GetObjectField, env, _obj, field)\n+        _value = env->GetObjectField(_obj, field)\n@@ -44,2 +44,1 @@\n-             NSK_CPP_STUB4(GetFieldID, env, _class,\\\n-             _fieldName, _fieldSig)) != NULL))\\\n+             env->GetFieldID(_class, _fieldName, _fieldSig)) != NULL))\\\n@@ -50,2 +49,1 @@\n-             NSK_CPP_STUB4(GetMethodID, env, _class,\\\n-             _methodName, _sig)) != NULL)) \\\n+             env->GetMethodID(_class, _methodName, _sig)) != NULL)) \\\n@@ -56,2 +54,1 @@\n-        if (!NSK_JNI_VERIFY_VOID(env, NSK_CPP_STUB3(CallVoidMethod, env, _obj,\\\n-             method))) \\\n+        if (!NSK_JNI_VERIFY_VOID(env, env->CallVoidMethod(_obj, method))) \\\n","filename":"test\/hotspot\/jtreg\/vmTestbase\/nsk\/monitoring\/share\/thread\/Deadlock.cpp","additions":6,"deletions":9,"binary":false,"changes":15,"status":"modified"},{"patch":"@@ -30,1 +30,1 @@\n-             NSK_CPP_STUB2(FindClass, env, _className)) != NULL))\\\n+             env->FindClass(_className)) != NULL))\\\n@@ -35,1 +35,1 @@\n-             NSK_CPP_STUB2(GetObjectClass, env, _obj)) != NULL))\\\n+             env->GetObjectClass(_obj)) != NULL))\\\n@@ -40,1 +40,1 @@\n-        _value = NSK_CPP_STUB3(GetObjectField, env, _obj, field)\n+        _value = env->GetObjectField(_obj, field)\n@@ -44,2 +44,1 @@\n-             NSK_CPP_STUB4(GetFieldID, env, _class,\\\n-             _fieldName, _fieldSig)) != NULL))\\\n+             env->GetFieldID(_class, _fieldName, _fieldSig)) != NULL))\\\n@@ -50,2 +49,1 @@\n-             NSK_CPP_STUB4(GetMethodID, env, _class,\\\n-             _methodName, _sig)) != NULL))\\\n+             env->GetMethodID(_class, _methodName, _sig)) != NULL))\\\n@@ -56,2 +54,1 @@\n-        if (!NSK_JNI_VERIFY_VOID(env, NSK_CPP_STUB3(CallVoidMethod, env, _obj,\\\n-             method)))\\\n+        if (!NSK_JNI_VERIFY_VOID(env, env->CallVoidMethod(_obj, method)))\\\n","filename":"test\/hotspot\/jtreg\/vmTestbase\/nsk\/monitoring\/share\/thread\/LockingThreads.cpp","additions":6,"deletions":9,"binary":false,"changes":15,"status":"modified"},{"patch":"@@ -32,1 +32,1 @@\n-            NSK_CPP_STUB2(FindClass, env, _className)) != NULL))\\\n+            env->FindClass(_className)) != NULL))\\\n@@ -37,1 +37,1 @@\n-            NSK_CPP_STUB2(GetObjectClass, env, _obj)) != NULL))\\\n+            env->GetObjectClass(_obj)) != NULL))\\\n@@ -42,2 +42,1 @@\n-            NSK_CPP_STUB4(GetStaticFieldID, env, _class,\\\n-                _fieldName, _fieldSig)) != NULL))\\\n+            env->GetStaticFieldID(_class, _fieldName, _fieldSig)) != NULL))\\\n@@ -48,2 +47,1 @@\n-    _value = NSK_CPP_STUB3(GetStaticObjectField, env, _class, \\\n-                                field)\n+    _value = env->GetStaticObjectField(_class, field)\n@@ -53,1 +51,1 @@\n-    _value = NSK_CPP_STUB3(GetStaticBooleanField, env, _class, field)\n+    _value = env->GetStaticBooleanField(_class, field)\n@@ -57,2 +55,1 @@\n-            NSK_CPP_STUB4(GetFieldID, env, _class,\\\n-                _fieldName, _fieldSig)) != NULL))\\\n+            env->GetFieldID(_class, _fieldName, _fieldSig)) != NULL))\\\n@@ -63,1 +60,1 @@\n-    _value = NSK_CPP_STUB3(GetIntField, env, _obj, field)\n+    _value = env->GetIntField(_obj, field)\n@@ -67,1 +64,1 @@\n-    _value = NSK_CPP_STUB3(GetLongField, env, _obj, field)\n+    _value = env->GetLongField(_obj, field)\n@@ -71,1 +68,1 @@\n-    _value = NSK_CPP_STUB3(GetStaticIntField, env, _class, field)\n+    _value = env->GetStaticIntField(_class, field)\n@@ -75,1 +72,1 @@\n-    NSK_CPP_STUB4(SetIntField, env, _obj, field, _newValue)\n+    env->SetIntField(_obj, field, _newValue)\n@@ -79,1 +76,1 @@\n-    _value = NSK_CPP_STUB3(GetObjectField, env, _obj, field)\n+    _value = env->GetObjectField(_obj, field)\n@@ -83,1 +80,1 @@\n-    NSK_CPP_STUB3(GetObjectArrayElement, env, _arr, _index)\n+    env->GetObjectArrayElement(_arr, _index)\n@@ -86,1 +83,1 @@\n-    NSK_CPP_STUB4(SetObjectArrayElement, env, _arr, _index, _newValue)\n+    env->SetObjectArrayElement(_arr, _index, _newValue)\n@@ -90,2 +87,1 @@\n-            NSK_CPP_STUB4(GetStaticMethodID, env, _class,\\\n-                _methodName, _sig)) != NULL))\\\n+            env->GetStaticMethodID(_class, _methodName, _sig)) != NULL))\\\n@@ -96,2 +92,1 @@\n-            NSK_CPP_STUB4(GetMethodID, env, _class,\\\n-                _methodName, _sig)) != NULL))\\\n+            env->GetMethodID(_class, _methodName, _sig)) != NULL))\\\n@@ -102,2 +97,1 @@\n-    if (!NSK_JNI_VERIFY_VOID(env, NSK_CPP_STUB3(CallStaticVoidMethod, env,\\\n-                            _class, method)))\\\n+    if (!NSK_JNI_VERIFY_VOID(env, env->CallStaticVoidMethod(_class, method)))\\\n@@ -108,2 +102,1 @@\n-    if (!NSK_JNI_VERIFY_VOID(env, NSK_CPP_STUB4(CallStaticVoidMethod, env,\\\n-                                                    _class, method, _param)))\\\n+    if (!NSK_JNI_VERIFY_VOID(env, env->CallStaticVoidMethod(_class, method, _param)))\\\n@@ -114,2 +107,1 @@\n-    if (!NSK_JNI_VERIFY_VOID(env, NSK_CPP_STUB3(CallVoidMethod, env, _obj,\\\n-                                                    method)))\\\n+    if (!NSK_JNI_VERIFY_VOID(env, env->CallVoidMethod(_obj, method)))\\\n@@ -120,2 +112,1 @@\n-    if (!NSK_JNI_VERIFY_VOID(env, NSK_CPP_STUB4(CallVoidMethod, env, _obj,\\\n-                                                    method, _param)))\\\n+    if (!NSK_JNI_VERIFY_VOID(env, env->CallVoidMethod(_obj, method, _param)))\\\n@@ -126,2 +117,1 @@\n-    if (!NSK_JNI_VERIFY_VOID(env, NSK_CPP_STUB5(CallVoidMethod, env, _obj, \\\n-                                                    method, _param1, _param2)))\\\n+    if (!NSK_JNI_VERIFY_VOID(env, env->CallVoidMethod(_obj, method, _param1, _param2)))\\\n@@ -132,1 +122,1 @@\n-    _value = NSK_CPP_STUB3(CallIntMethod, env, _obj, method)\n+    _value = env->CallIntMethod(_obj, method)\n@@ -137,1 +127,1 @@\n-            NSK_CPP_STUB4(NewObject, env, _class, method, _params)) != NULL))\\\n+            env->NewObject(_class, method, _params)) != NULL))\\\n@@ -141,1 +131,1 @@\n-    NSK_JNI_VERIFY(env, NSK_CPP_STUB2(MonitorEnter, env, x) == 0)\n+    NSK_JNI_VERIFY(env, env->MonitorEnter(x) == 0)\n@@ -144,1 +134,1 @@\n-    NSK_JNI_VERIFY(env, NSK_CPP_STUB2(MonitorExit, env, x) == 0)\n+    NSK_JNI_VERIFY(env, env->MonitorExit(x) == 0)\n@@ -148,1 +138,1 @@\n-   jmsg = NSK_CPP_STUB2(NewStringUTF, env, msg);\\\n+   jmsg = env->NewStringUTF(msg);\\\n","filename":"test\/hotspot\/jtreg\/vmTestbase\/nsk\/monitoring\/share\/thread\/RecursiveMonitoringThread.cpp","additions":25,"deletions":35,"binary":false,"changes":60,"status":"modified"},{"patch":"@@ -163,4 +163,2 @@\n-        if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB4(GetClassSignature,\n-                jvmti_env, klass, &cls_sig, \/*&generic*\/NULL)))\n-            NSK_CPP_STUB2(FatalError, jni_env,\n-                \"JVMTIagent: failed to get class signature\\n\");\n+        if (!NSK_JVMTI_VERIFY(jvmti_env->GetClassSignature(klass, &cls_sig, \/*&generic*\/NULL)))\n+            jni_env->FatalError(\"JVMTIagent: failed to get class signature\\n\");\n@@ -248,4 +246,2 @@\n-        if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB3(GetMethodDeclaringClass,\n-                jvmti_env, method, &decl_clazz)))\n-            NSK_CPP_STUB2(FatalError, jni_env,\n-                \"JVMTIagent: failed to get method declaring class\\n\");\n+        if (!NSK_JVMTI_VERIFY(jvmti_env->GetMethodDeclaringClass(method, &decl_clazz)))\n+            jni_env->FatalError(\"JVMTIagent: failed to get method declaring class\\n\");\n@@ -254,2 +250,1 @@\n-            NSK_CPP_STUB2(FatalError, jni_env,\n-                \"JVMTIagent: failed to hotswap class\\n\");\n+            jni_env->FatalError(\"JVMTIagent: failed to hotswap class\\n\");\n@@ -422,4 +417,2 @@\n-        if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB3(GetMethodDeclaringClass,\n-                jvmti_env, method, &decl_clazz)))\n-            NSK_CPP_STUB2(FatalError, jni_env,\n-                \"JVMTIagent: failed to get method declaring class\\n\");\n+        if (!NSK_JVMTI_VERIFY(jvmti_env->GetMethodDeclaringClass(method, &decl_clazz)))\n+            jni_env->FatalError(\"JVMTIagent: failed to get method declaring class\\n\");\n@@ -428,2 +421,1 @@\n-            NSK_CPP_STUB2(FatalError, jni_env,\n-                \"JVMTIagent: failed to hotswap class\\n\");\n+            jni_env->FatalError(\"JVMTIagent: failed to hotswap class\\n\");\n@@ -446,4 +438,2 @@\n-        if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB3(GetMethodDeclaringClass,\n-                jvmti_env, method, &decl_clazz)))\n-            NSK_CPP_STUB2(FatalError, jni_env,\n-                \"JVMTIagent: failed to get method declaring class\\n\");\n+        if (!NSK_JVMTI_VERIFY(jvmti_env->GetMethodDeclaringClass(method, &decl_clazz)))\n+            jni_env->FatalError(\"JVMTIagent: failed to get method declaring class\\n\");\n@@ -452,2 +442,1 @@\n-            NSK_CPP_STUB2(FatalError, jni_env,\n-                \"JVMTIagent: failed to hotswap class\\n\");\n+            jni_env->FatalError(\"JVMTIagent: failed to hotswap class\\n\");\n@@ -480,4 +469,2 @@\n-        if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB3(GetMethodDeclaringClass,\n-                jvmti_env, method, &decl_clazz)))\n-            NSK_CPP_STUB2(FatalError, jni_env,\n-                \"JVMTIagent: failed to get method declaring class\\n\");\n+        if (!NSK_JVMTI_VERIFY(jvmti_env->GetMethodDeclaringClass(method, &decl_clazz)))\n+            jni_env->FatalError(\"JVMTIagent: failed to get method declaring class\\n\");\n@@ -486,2 +473,1 @@\n-            NSK_CPP_STUB2(FatalError, jni_env,\n-                \"JVMTIagent: failed to hotswap class\\n\");\n+            jni_env->FatalError(\"JVMTIagent: failed to hotswap class\\n\");\n@@ -493,4 +479,2 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(RawMonitorEnter,\n-            jvmti, eventLock)))\n-        NSK_CPP_STUB2(FatalError, jni_env,\n-            \"JVMTIagent: failed to enter a raw monitor\\n\");\n+    if (!NSK_JVMTI_VERIFY(jvmti->RawMonitorEnter(eventLock)))\n+        jni_env->FatalError(\"JVMTIagent: failed to enter a raw monitor\\n\");\n@@ -500,4 +484,2 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(RawMonitorExit,\n-            jvmti, eventLock)))\n-        NSK_CPP_STUB2(FatalError, jni_env,\n-            \"JVMTIagent: failed to exit a raw monitor\\n\");\n+    if (!NSK_JVMTI_VERIFY(jvmti->RawMonitorExit(eventLock)))\n+        jni_env->FatalError(\"JVMTIagent: failed to exit a raw monitor\\n\");\n@@ -519,4 +501,2 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(GetCapabilities,\n-            jvmti, &capabil)))\n-        NSK_CPP_STUB2(FatalError, jni_env,\n-            \"JVMTIagent: failed to get capabilities\\n\");\n+    if (!NSK_JVMTI_VERIFY(jvmti->GetCapabilities(&capabil)))\n+        jni_env->FatalError(\"JVMTIagent: failed to get capabilities\\n\");\n@@ -577,2 +557,1 @@\n-    if (!NSK_JNI_VERIFY(jni_env, (shortTestName = NSK_CPP_STUB3(GetStringUTFChars,\n-            jni_env, shortName, NULL)) != NULL)) {\n+    if (!NSK_JNI_VERIFY(jni_env, (shortTestName = jni_env->GetStringUTFChars(shortName, NULL)) != NULL)) {\n@@ -585,2 +564,1 @@\n-    if (!NSK_JNI_VERIFY(jni_env, (rasCls = NSK_CPP_STUB2(NewGlobalRef,\n-            jni_env, cls)) != NULL)) {\n+    if (!NSK_JNI_VERIFY(jni_env, (rasCls = jni_env->NewGlobalRef(cls)) != NULL)) {\n@@ -608,2 +586,1 @@\n-        NSK_CPP_STUB2(FatalError, jni_env,\n-            \"JVMTIagent: cannot allocate memory for class_info\\n\");\n+        jni_env->FatalError(\"JVMTIagent: cannot allocate memory for class_info\\n\");\n@@ -614,2 +591,1 @@\n-    if (!NSK_JNI_VERIFY(jni_env, ((*_clsInfo).cls = NSK_CPP_STUB2(NewGlobalRef,\n-            jni_env, clazz)) != NULL)) {\n+    if (!NSK_JNI_VERIFY(jni_env, ((*_clsInfo).cls = jni_env->NewGlobalRef(clazz)) != NULL)) {\n@@ -620,2 +596,1 @@\n-        NSK_CPP_STUB2(FatalError, jni_env,\n-            \"JVMTIagent: unable to create a new global reference of class\\n\");\n+        jni_env->FatalError(\"JVMTIagent: unable to create a new global reference of class\\n\");\n@@ -625,4 +600,2 @@\n-        NSK_CPP_STUB4(GetStaticMethodID, jni_env, rasCls,\n-            \"loadFromClassFile\", \"(Ljava\/lang\/String;)[B\")) != NULL))\n-        NSK_CPP_STUB2(FatalError, jni_env,\n-            \"JVMTIagent: unable to get ID of the method \\\"loadFromClassFile\\\"\\n\");\n+        jni_env->GetStaticMethodID(rasCls, \"loadFromClassFile\", \"(Ljava\/lang\/String;)[B\")) != NULL))\n+        jni_env->FatalError(\"JVMTIagent: unable to get ID of the method \\\"loadFromClassFile\\\"\\n\");\n@@ -630,2 +603,1 @@\n-    classBytes = (jbyteArray) NSK_CPP_STUB4(CallStaticObjectMethod,\n-        jni_env, rasCls, mid, NSK_CPP_STUB2(NewStringUTF, jni_env, cls_sig));\n+    classBytes = (jbyteArray) jni_env->CallStaticObjectMethod(rasCls, mid, jni_env->NewStringUTF(cls_sig));\n@@ -635,1 +607,1 @@\n-    (*_clsInfo).bCount = NSK_CPP_STUB2(GetArrayLength, jni_env, classBytes);\n+    (*_clsInfo).bCount = jni_env->GetArrayLength(classBytes);\n@@ -638,1 +610,1 @@\n-        NSK_CPP_STUB3(GetByteArrayElements, jni_env, classBytes, &isCopy);\n+        jni_env->GetByteArrayElements(classBytes, &isCopy);\n@@ -656,1 +628,1 @@\n-    NSK_TRACE(NSK_CPP_STUB2(DeleteGlobalRef, jni_env, rasCls));\n+    NSK_TRACE(jni_env->DeleteGlobalRef(rasCls));\n@@ -661,4 +633,2 @@\n-        if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(Deallocate,\n-                jvmti, (unsigned char*) clsInfoCurr->clazzsig)))\n-            NSK_CPP_STUB2(FatalError, jni_env,\n-                \"JVMTIagent: failed to deallocate memory for clazzsig\\n\");\n+        if (!NSK_JVMTI_VERIFY(jvmti->Deallocate((unsigned char*) clsInfoCurr->clazzsig)))\n+            jni_env->FatalError(\"JVMTIagent: failed to deallocate memory for clazzsig\\n\");\n@@ -666,1 +636,1 @@\n-        NSK_TRACE(NSK_CPP_STUB2(DeleteGlobalRef, jni_env, clsInfoCurr->cls));\n+        NSK_TRACE(jni_env->DeleteGlobalRef(clsInfoCurr->cls));\n@@ -682,4 +652,2 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB4(GetClassSignature,\n-            jvmti, clazz, &clazzsig, \/*&generic*\/NULL)))\n-        NSK_CPP_STUB2(FatalError, jni_env,\n-            \"JVMTIagent: findAndHotSwap: failed to get class signature\\n\");\n+    if (!NSK_JVMTI_VERIFY(jvmti->GetClassSignature(clazz, &clazzsig, \/*&generic*\/NULL)))\n+        jni_env->FatalError(\"JVMTIagent: findAndHotSwap: failed to get class signature\\n\");\n@@ -699,4 +667,2 @@\n-                if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(Deallocate,\n-                        jvmti, (unsigned char*) clazzsig)))\n-                    NSK_CPP_STUB2(FatalError, jni_env,\n-                        \"JVMTIagent: findAndHotSwap: failed to deallocate memory for clazzsig\\n\");\n+                if (!NSK_JVMTI_VERIFY(jvmti->Deallocate((unsigned char*) clazzsig)))\n+                    jni_env->FatalError(\"JVMTIagent: findAndHotSwap: failed to deallocate memory for clazzsig\\n\");\n@@ -715,4 +681,2 @@\n-                    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(Deallocate,\n-                            jvmti, (unsigned char*) clazzsig)))\n-                        NSK_CPP_STUB2(FatalError, jni_env,\n-                            \"JVMTIagent: findAndHotSwap: failed to deallocate memory for clazzsig\\n\");\n+                    if (!NSK_JVMTI_VERIFY(jvmti->Deallocate((unsigned char*) clazzsig)))\n+                        jni_env->FatalError(\"JVMTIagent: findAndHotSwap: failed to deallocate memory for clazzsig\\n\");\n@@ -754,2 +718,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB3(RedefineClasses,\n-            jvmti, 1, &classDef)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->RedefineClasses(1, &classDef)))\n@@ -775,2 +738,1 @@\n-            if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB4(SetEventNotificationMode,\n-                    jvmti, JVMTI_ENABLE, JVMTI_EVENT_SINGLE_STEP, NULL)))\n+            if (!NSK_JVMTI_VERIFY(jvmti->SetEventNotificationMode(JVMTI_ENABLE, JVMTI_EVENT_SINGLE_STEP, NULL)))\n@@ -792,2 +754,1 @@\n-            if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB4(SetEventNotificationMode,\n-                    jvmti, JVMTI_ENABLE, JVMTI_EVENT_METHOD_ENTRY, NULL)))\n+            if (!NSK_JVMTI_VERIFY(jvmti->SetEventNotificationMode(JVMTI_ENABLE, JVMTI_EVENT_METHOD_ENTRY, NULL)))\n@@ -803,2 +764,1 @@\n-            if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB4(SetEventNotificationMode,\n-                    jvmti, JVMTI_ENABLE, JVMTI_EVENT_METHOD_EXIT, NULL)))\n+            if (!NSK_JVMTI_VERIFY(jvmti->SetEventNotificationMode(JVMTI_ENABLE, JVMTI_EVENT_METHOD_EXIT, NULL)))\n@@ -820,2 +780,1 @@\n-            if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB4(SetEventNotificationMode,\n-                    jvmti, JVMTI_ENABLE, JVMTI_EVENT_EXCEPTION_CATCH, NULL)))\n+            if (!NSK_JVMTI_VERIFY(jvmti->SetEventNotificationMode(JVMTI_ENABLE, JVMTI_EVENT_EXCEPTION_CATCH, NULL)))\n@@ -830,2 +789,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB3(SetEventCallbacks,\n-            jvmti, &callbacks, sizeof(callbacks))))\n+    if (!NSK_JVMTI_VERIFY(jvmti->SetEventCallbacks(&callbacks, sizeof(callbacks))))\n@@ -859,2 +817,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(AddCapabilities,\n-            jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->AddCapabilities(&caps)))\n@@ -868,2 +825,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB4(SetEventNotificationMode,\n-            jvmti, JVMTI_ENABLE, JVMTI_EVENT_BREAKPOINT, NULL)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->SetEventNotificationMode(JVMTI_ENABLE, JVMTI_EVENT_BREAKPOINT, NULL)))\n@@ -878,2 +834,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB4(SetEventNotificationMode,\n-            jvmti, JVMTI_ENABLE, JVMTI_EVENT_CLASS_FILE_LOAD_HOOK, NULL)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->SetEventNotificationMode(JVMTI_ENABLE, JVMTI_EVENT_CLASS_FILE_LOAD_HOOK, NULL)))\n@@ -888,2 +843,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB4(SetEventNotificationMode,\n-            jvmti, JVMTI_ENABLE, JVMTI_EVENT_CLASS_LOAD, NULL)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->SetEventNotificationMode(JVMTI_ENABLE, JVMTI_EVENT_CLASS_LOAD, NULL)))\n@@ -898,2 +852,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB4(SetEventNotificationMode,\n-            jvmti, JVMTI_ENABLE, JVMTI_EVENT_CLASS_PREPARE, NULL)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->SetEventNotificationMode(JVMTI_ENABLE, JVMTI_EVENT_CLASS_PREPARE, NULL)))\n@@ -908,2 +861,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB4(SetEventNotificationMode,\n-            jvmti, JVMTI_ENABLE, JVMTI_EVENT_COMPILED_METHOD_LOAD, NULL)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->SetEventNotificationMode(JVMTI_ENABLE, JVMTI_EVENT_COMPILED_METHOD_LOAD, NULL)))\n@@ -918,2 +870,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB4(SetEventNotificationMode,\n-            jvmti, JVMTI_ENABLE, JVMTI_EVENT_COMPILED_METHOD_UNLOAD, NULL)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->SetEventNotificationMode(JVMTI_ENABLE, JVMTI_EVENT_COMPILED_METHOD_UNLOAD, NULL)))\n@@ -928,2 +879,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB4(SetEventNotificationMode,\n-            jvmti, JVMTI_ENABLE, JVMTI_EVENT_DATA_DUMP_REQUEST, NULL)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->SetEventNotificationMode(JVMTI_ENABLE, JVMTI_EVENT_DATA_DUMP_REQUEST, NULL)))\n@@ -938,2 +888,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB4(SetEventNotificationMode,\n-            jvmti, JVMTI_ENABLE, JVMTI_EVENT_DYNAMIC_CODE_GENERATED, NULL)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->SetEventNotificationMode(JVMTI_ENABLE, JVMTI_EVENT_DYNAMIC_CODE_GENERATED, NULL)))\n@@ -948,2 +897,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB4(SetEventNotificationMode,\n-            jvmti, JVMTI_ENABLE, JVMTI_EVENT_EXCEPTION, NULL)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->SetEventNotificationMode(JVMTI_ENABLE, JVMTI_EVENT_EXCEPTION, NULL)))\n@@ -958,2 +906,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB4(SetEventNotificationMode,\n-            jvmti, JVMTI_ENABLE, JVMTI_EVENT_FIELD_ACCESS, NULL)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->SetEventNotificationMode(JVMTI_ENABLE, JVMTI_EVENT_FIELD_ACCESS, NULL)))\n@@ -968,2 +915,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB4(SetEventNotificationMode,\n-            jvmti, JVMTI_ENABLE, JVMTI_EVENT_FIELD_MODIFICATION, NULL)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->SetEventNotificationMode(JVMTI_ENABLE, JVMTI_EVENT_FIELD_MODIFICATION, NULL)))\n@@ -978,2 +924,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB4(SetEventNotificationMode,\n-            jvmti, JVMTI_ENABLE, JVMTI_EVENT_FRAME_POP, NULL)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->SetEventNotificationMode(JVMTI_ENABLE, JVMTI_EVENT_FRAME_POP, NULL)))\n@@ -988,2 +933,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB4(SetEventNotificationMode,\n-            jvmti, JVMTI_ENABLE, JVMTI_EVENT_GARBAGE_COLLECTION_FINISH, NULL)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->SetEventNotificationMode(JVMTI_ENABLE, JVMTI_EVENT_GARBAGE_COLLECTION_FINISH, NULL)))\n@@ -998,2 +942,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB4(SetEventNotificationMode,\n-            jvmti, JVMTI_ENABLE, JVMTI_EVENT_GARBAGE_COLLECTION_START, NULL)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->SetEventNotificationMode(JVMTI_ENABLE, JVMTI_EVENT_GARBAGE_COLLECTION_START, NULL)))\n@@ -1008,2 +951,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB4(SetEventNotificationMode,\n-            jvmti, JVMTI_ENABLE, JVMTI_EVENT_MONITOR_CONTENDED_ENTER, NULL)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->SetEventNotificationMode(JVMTI_ENABLE, JVMTI_EVENT_MONITOR_CONTENDED_ENTER, NULL)))\n@@ -1018,2 +960,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB4(SetEventNotificationMode,\n-            jvmti, JVMTI_ENABLE, JVMTI_EVENT_MONITOR_CONTENDED_ENTERED, NULL)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->SetEventNotificationMode(JVMTI_ENABLE, JVMTI_EVENT_MONITOR_CONTENDED_ENTERED, NULL)))\n@@ -1028,2 +969,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB4(SetEventNotificationMode,\n-            jvmti, JVMTI_ENABLE, JVMTI_EVENT_MONITOR_WAIT, NULL)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->SetEventNotificationMode(JVMTI_ENABLE, JVMTI_EVENT_MONITOR_WAIT, NULL)))\n@@ -1038,2 +978,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB4(SetEventNotificationMode,\n-            jvmti, JVMTI_ENABLE, JVMTI_EVENT_MONITOR_WAITED, NULL)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->SetEventNotificationMode(JVMTI_ENABLE, JVMTI_EVENT_MONITOR_WAITED, NULL)))\n@@ -1048,2 +987,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB4(SetEventNotificationMode,\n-            jvmti, JVMTI_ENABLE, JVMTI_EVENT_NATIVE_METHOD_BIND, NULL)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->SetEventNotificationMode(JVMTI_ENABLE, JVMTI_EVENT_NATIVE_METHOD_BIND, NULL)))\n@@ -1058,2 +996,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB4(SetEventNotificationMode,\n-            jvmti, JVMTI_ENABLE, JVMTI_EVENT_OBJECT_FREE, NULL)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->SetEventNotificationMode(JVMTI_ENABLE, JVMTI_EVENT_OBJECT_FREE, NULL)))\n@@ -1068,2 +1005,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB4(SetEventNotificationMode,\n-            jvmti, JVMTI_ENABLE, JVMTI_EVENT_THREAD_END, NULL)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->SetEventNotificationMode(JVMTI_ENABLE, JVMTI_EVENT_THREAD_END, NULL)))\n@@ -1078,2 +1014,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB4(SetEventNotificationMode,\n-            jvmti, JVMTI_ENABLE, JVMTI_EVENT_THREAD_START, NULL)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->SetEventNotificationMode(JVMTI_ENABLE, JVMTI_EVENT_THREAD_START, NULL)))\n@@ -1088,2 +1023,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB4(SetEventNotificationMode,\n-            jvmti, JVMTI_ENABLE, JVMTI_EVENT_VM_DEATH, NULL)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->SetEventNotificationMode(JVMTI_ENABLE, JVMTI_EVENT_VM_DEATH, NULL)))\n@@ -1098,2 +1032,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB4(SetEventNotificationMode,\n-            jvmti, JVMTI_ENABLE, JVMTI_EVENT_VM_INIT, NULL)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->SetEventNotificationMode(JVMTI_ENABLE, JVMTI_EVENT_VM_INIT, NULL)))\n@@ -1108,2 +1041,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB4(SetEventNotificationMode,\n-            jvmti, JVMTI_ENABLE, JVMTI_EVENT_VM_START, NULL)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->SetEventNotificationMode(JVMTI_ENABLE, JVMTI_EVENT_VM_START, NULL)))\n@@ -1118,2 +1050,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB4(SetEventNotificationMode,\n-            jvmti, JVMTI_ENABLE, JVMTI_EVENT_VM_OBJECT_ALLOC, NULL)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->SetEventNotificationMode(JVMTI_ENABLE, JVMTI_EVENT_VM_OBJECT_ALLOC, NULL)))\n@@ -1123,2 +1054,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB3(SetEventCallbacks,\n-            jvmti, &callbacks, sizeof(callbacks))))\n+    if (!NSK_JVMTI_VERIFY(jvmti->SetEventCallbacks(&callbacks, sizeof(callbacks))))\n@@ -1131,1 +1061,1 @@\n-    if (NSK_CPP_STUB1(ExceptionOccurred, jni_env)) {\n+    if (jni_env->ExceptionOccurred()) {\n@@ -1133,2 +1063,2 @@\n-        NSK_CPP_STUB1(ExceptionDescribe, jni_env);\n-        NSK_CPP_STUB1(ExceptionClear, jni_env);\n+        jni_env->ExceptionDescribe();\n+        jni_env->ExceptionClear();\n@@ -1136,2 +1066,1 @@\n-        NSK_CPP_STUB2(FatalError, jni_env,\n-            \"JVMTIagent: exception occurred in java code, aborting\\n\");\n+        jni_env->FatalError(\"JVMTIagent: exception occurred in java code, aborting\\n\");\n@@ -1232,1 +1161,1 @@\n-            NSK_CPP_STUB2(FatalError, jni_env, error_msg);\n+            jni_env->FatalError(error_msg);\n@@ -1260,2 +1189,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB3(CreateRawMonitor,\n-            jvmti, \"_event_lock\", &eventLock)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->CreateRawMonitor(\"_event_lock\", &eventLock)))\n","filename":"test\/hotspot\/jtreg\/vmTestbase\/nsk\/share\/JVMTIagent.cpp","additions":80,"deletions":152,"binary":false,"changes":232,"status":"modified"},{"patch":"@@ -208,1 +208,1 @@\n-            NSK_CPP_STUB2(FindClass, jni, TARGET_APP_CLASS_NAME)) != NULL)) {\n+            jni->FindClass(TARGET_APP_CLASS_NAME)) != NULL)) {\n@@ -213,1 +213,1 @@\n-            NSK_CPP_STUB2(NewGlobalRef, jni, localTargetAppClass)) != NULL)) {\n+            jni->NewGlobalRef(localTargetAppClass)) != NULL)) {\n@@ -220,2 +220,1 @@\n-            NSK_CPP_STUB4(GetStaticMethodID, jni, targetAppClass,\n-                    AGENT_LOADED_METHOD_NAME, AGENT_LOADED_METHOD_SIGNATURE)) != NULL))\n+            jni->GetStaticMethodID(targetAppClass, AGENT_LOADED_METHOD_NAME, AGENT_LOADED_METHOD_SIGNATURE)) != NULL))\n@@ -226,1 +225,1 @@\n-        NSK_CPP_STUB2(NewStringUTF, jni, agentName)) != NULL))\n+        jni->NewStringUTF(agentName)) != NULL))\n@@ -229,1 +228,1 @@\n-    NSK_CPP_STUB4(CallStaticVoidMethod, jni, targetAppClass, agentLoadedMethod, agentNameString);\n+    jni->CallStaticVoidMethod(targetAppClass, agentLoadedMethod, agentNameString);\n@@ -258,2 +257,1 @@\n-            NSK_CPP_STUB4(GetStaticMethodID, jni, targetAppClass,\n-                    AGENT_FINISHED_METHOD_NAME, AGENT_FINISHED_METHOD_SIGNATURE)) != NULL))\n+            jni->GetStaticMethodID(targetAppClass, AGENT_FINISHED_METHOD_NAME, AGENT_FINISHED_METHOD_SIGNATURE)) != NULL))\n@@ -263,1 +261,1 @@\n-    if (!NSK_JNI_VERIFY(jni, (agentNameString = NSK_CPP_STUB2(NewStringUTF, jni, agentName)) != NULL))\n+    if (!NSK_JNI_VERIFY(jni, (agentNameString = jni->NewStringUTF(agentName)) != NULL))\n@@ -266,2 +264,1 @@\n-    NSK_CPP_STUB5(CallStaticVoidMethod, jni, targetAppClass,\n-            agentFinishedMethod, agentNameString, success ? JNI_TRUE : JNI_FALSE);\n+    jni->CallStaticVoidMethod(targetAppClass, agentFinishedMethod, agentNameString, success ? JNI_TRUE : JNI_FALSE);\n@@ -280,1 +277,1 @@\n-    NSK_CPP_STUB3(GetEnv, vm, (void**)&jni, JNI_VERSION_1_2);\n+    vm->GetEnv((void**)&jni, JNI_VERSION_1_2);\n","filename":"test\/hotspot\/jtreg\/vmTestbase\/nsk\/share\/aod\/aod.cpp","additions":9,"deletions":12,"binary":false,"changes":21,"status":"modified"},{"patch":"@@ -45,1 +45,1 @@\n-Typical example of usage of NSK_JNI_VERIFY and NSK_CPP_STUB macroses\n+Typical example of usage of the NSK_JNI_VERIFY macro\n@@ -50,1 +50,1 @@\n-            NSK_CPP_STUB2(FindClass, jni, class_name) != NULL)) {\n+            jni->FindClass(class_name) != NULL)) {\n@@ -58,1 +58,1 @@\n-            NSK_CPP_STUB2(FindClass, jni, class_name)) != NULL)) {\n+            jni->FindClass(class_name)) != NULL)) {\n","filename":"test\/hotspot\/jtreg\/vmTestbase\/nsk\/share\/jni\/README","additions":3,"deletions":3,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -56,1 +56,1 @@\n-    NSK_TRACE(throwable = NSK_CPP_STUB1(ExceptionOccurred, jni));\n+    NSK_TRACE(throwable = jni->ExceptionOccurred());\n@@ -59,2 +59,2 @@\n-        NSK_TRACE(NSK_CPP_STUB1(ExceptionDescribe, jni));\n-        NSK_TRACE(NSK_CPP_STUB1(ExceptionClear, jni));\n+        NSK_TRACE(jni->ExceptionDescribe());\n+        NSK_TRACE(jni->ExceptionClear());\n","filename":"test\/hotspot\/jtreg\/vmTestbase\/nsk\/share\/jni\/jni_tools.cpp","additions":3,"deletions":3,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -54,2 +54,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-            NSK_CPP_STUB2(AddToBootstrapClassLoaderSearch, jvmti, segment))) {\n+    if (!NSK_JVMTI_VERIFY(jvmti->AddToBootstrapClassLoaderSearch(segment))) {\n@@ -71,2 +70,1 @@\n-    if (!NSK_JVMTI_VERIFY_CODE(expectedError,\n-            NSK_CPP_STUB2(AddToBootstrapClassLoaderSearch, jvmti, segment))) {\n+    if (!NSK_JVMTI_VERIFY_CODE(expectedError, jvmti->AddToBootstrapClassLoaderSearch(segment))) {\n@@ -126,1 +124,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(GetPhase, jvmti, &phase))) {\n+    if (!NSK_JVMTI_VERIFY(jvmti->GetPhase(&phase))) {\n@@ -221,2 +219,1 @@\n-        if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB3(SetEventCallbacks, jvmti,\n-                                            &eventCallbacks, sizeof(eventCallbacks)))) {\n+        if (!NSK_JVMTI_VERIFY(jvmti->SetEventCallbacks(&eventCallbacks, sizeof(eventCallbacks)))) {\n","filename":"test\/hotspot\/jtreg\/vmTestbase\/nsk\/share\/jvmti\/AddToBootstrapClassLoaderSearch\/bootclssearch_agent.cpp","additions":4,"deletions":7,"binary":false,"changes":11,"status":"modified"},{"patch":"@@ -54,2 +54,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-            NSK_CPP_STUB2(AddToSystemClassLoaderSearch, jvmti, segment))) {\n+    if (!NSK_JVMTI_VERIFY(jvmti->AddToSystemClassLoaderSearch(segment))) {\n@@ -71,2 +70,1 @@\n-    if (!NSK_JVMTI_VERIFY_CODE(expectedError,\n-            NSK_CPP_STUB2(AddToSystemClassLoaderSearch, jvmti, segment))) {\n+    if (!NSK_JVMTI_VERIFY_CODE(expectedError, jvmti->AddToSystemClassLoaderSearch(segment))) {\n@@ -126,1 +124,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(GetPhase, jvmti, &phase))) {\n+    if (!NSK_JVMTI_VERIFY(jvmti->GetPhase(&phase))) {\n@@ -221,2 +219,1 @@\n-        if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB3(SetEventCallbacks, jvmti,\n-                                            &eventCallbacks, sizeof(eventCallbacks)))) {\n+        if (!NSK_JVMTI_VERIFY(jvmti->SetEventCallbacks(&eventCallbacks, sizeof(eventCallbacks)))) {\n","filename":"test\/hotspot\/jtreg\/vmTestbase\/nsk\/share\/jvmti\/AddToSystemClassLoaderSearch\/systemclssearch_agent.cpp","additions":4,"deletions":7,"binary":false,"changes":11,"status":"modified"},{"patch":"@@ -120,1 +120,1 @@\n-Typical example of usage of NSK_JVMTI_VERIFY and NSK_CPP_STUB macroses\n+Typical example of usage of the NSK_JVMTI_VERIFY macro\n@@ -124,2 +124,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-            NSK_CPP_STUB2(GetVersion, jvmti, &version) != NULL)) {\n+    if (!NSK_JVMTI_VERIFY(jvmti->GetVersion(&version) != NULL)) {\n@@ -132,2 +131,1 @@\n-    if (!NSK_JVMTI_VERIFY(err =\n-            NSK_CPP_STUB2(GetVersion, jvmti, &version))) {\n+    if (!NSK_JVMTI_VERIFY(err = jvmti->GetVersion(&version))) {\n","filename":"test\/hotspot\/jtreg\/vmTestbase\/nsk\/share\/jvmti\/README","additions":3,"deletions":5,"binary":false,"changes":8,"status":"modified"},{"patch":"@@ -80,1 +80,1 @@\n-    return NSK_CPP_STUB3(CreateRawMonitor, jvmti_env, \"agent_data_monitor\", &data->monitor);\n+    return jvmti_env->CreateRawMonitor(\"agent_data_monitor\", &data->monitor);\n@@ -96,1 +96,1 @@\n-    return NSK_CPP_STUB2(DestroyRawMonitor, jvmti_env, data->monitor);\n+    return jvmti_env->DestroyRawMonitor(data->monitor);\n@@ -102,2 +102,1 @@\n-    if (!NSK_VERIFY(\n-            NSK_CPP_STUB3(GetEnv, javaVM, (void **)&jvmti_env, JVMTI_VERSION_1_1) == JNI_OK)) {\n+    if (!NSK_VERIFY(javaVM->GetEnv((void **)&jvmti_env, JVMTI_VERSION_1_1) == JNI_OK)) {\n@@ -119,2 +118,1 @@\n-        if (!NSK_JVMTI_VERIFY(\n-                NSK_CPP_STUB1(DisposeEnvironment, jvmti_env))) {\n+        if (!NSK_JVMTI_VERIFY(jvmti_env->DisposeEnvironment())) {\n@@ -168,1 +166,1 @@\n-        NSK_CPP_STUB2(DeleteGlobalRef, agentJNI, agentThread);\n+        agentJNI->DeleteGlobalRef(agentThread);\n@@ -187,2 +185,1 @@\n-    if (!NSK_JNI_VERIFY(jni_env, (threadClass =\n-            NSK_CPP_STUB2(FindClass, jni_env, THREAD_CLASS_NAME)) != NULL)) {\n+    if (!NSK_JNI_VERIFY(jni_env, (threadClass = jni_env->FindClass(THREAD_CLASS_NAME)) != NULL)) {\n@@ -193,1 +190,1 @@\n-            NSK_CPP_STUB4(GetMethodID, jni_env, threadClass, THREAD_CTOR_NAME, THREAD_CTOR_SIGNATURE)) != NULL))\n+            jni_env->GetMethodID(threadClass, THREAD_CTOR_NAME, THREAD_CTOR_SIGNATURE)) != NULL))\n@@ -196,2 +193,1 @@\n-    if (!NSK_JNI_VERIFY(jni_env, (threadName =\n-            NSK_CPP_STUB2(NewStringUTF, jni_env, THREAD_NAME)) != NULL))\n+    if (!NSK_JNI_VERIFY(jni_env, (threadName = jni_env->NewStringUTF(THREAD_NAME)) != NULL))\n@@ -201,1 +197,1 @@\n-            NSK_CPP_STUB4(NewObject, jni_env, threadClass, threadCtor, threadName)) != NULL))\n+            jni_env->NewObject(threadClass, threadCtor, threadName)) != NULL))\n@@ -205,2 +201,2 @@\n-            NSK_CPP_STUB2(NewGlobalRef, jni_env, threadObject)) != NULL)) {\n-        NSK_CPP_STUB2(DeleteLocalRef, jni_env, threadObject);\n+            jni_env->NewGlobalRef(threadObject)) != NULL)) {\n+        jni_env->DeleteLocalRef(threadObject);\n@@ -212,4 +208,3 @@\n-            NSK_CPP_STUB5(RunAgentThread, jvmti_env, agentThread,\n-                            &agentThreadWrapper, agentThreadArg, THREAD_PRIORITY))) {\n-        NSK_CPP_STUB2(DeleteGlobalRef, jni_env, threadGlobalRef);\n-        NSK_CPP_STUB2(DeleteLocalRef, jni_env, threadObject);\n+            jvmti_env->RunAgentThread(agentThread, &agentThreadWrapper, agentThreadArg, THREAD_PRIORITY))) {\n+        jni_env->DeleteGlobalRef(threadGlobalRef);\n+        jni_env->DeleteLocalRef(threadObject);\n@@ -398,2 +393,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-            NSK_CPP_STUB3(GetLoadedClasses, jvmti_env, &count, &classes))) {\n+    if (!NSK_JVMTI_VERIFY(jvmti_env->GetLoadedClasses(&count, &classes))) {\n@@ -408,2 +402,1 @@\n-        if (!NSK_JVMTI_VERIFY(\n-                NSK_CPP_STUB4(GetClassSignature, jvmti_env, classes[i], &sig, &generic))) {\n+        if (!NSK_JVMTI_VERIFY(jvmti_env->GetClassSignature(classes[i], &sig, &generic))) {\n@@ -418,4 +411,2 @@\n-        if (!(NSK_JVMTI_VERIFY(\n-                    NSK_CPP_STUB2(Deallocate, jvmti_env, (unsigned char*)sig))\n-                && NSK_JVMTI_VERIFY(\n-                    NSK_CPP_STUB2(Deallocate, jvmti_env, (unsigned char*)generic)))) {\n+        if (!(NSK_JVMTI_VERIFY(jvmti_env->Deallocate((unsigned char*)sig))\n+                && NSK_JVMTI_VERIFY(jvmti_env->Deallocate((unsigned char*)generic)))) {\n@@ -430,2 +421,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-                NSK_CPP_STUB2(Deallocate, jvmti_env, (unsigned char*)classes))) {\n+    if (!NSK_JVMTI_VERIFY(jvmti_env->Deallocate((unsigned char*)classes))) {\n@@ -437,1 +427,1 @@\n-                NSK_CPP_STUB2(NewGlobalRef, jni_env, foundClass)) != NULL)) {\n+                jni_env->NewGlobalRef(foundClass)) != NULL)) {\n@@ -457,2 +447,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-            NSK_CPP_STUB3(GetAllThreads, jvmti_env, &count, &threads))) {\n+    if (!NSK_JVMTI_VERIFY(jvmti_env->GetAllThreads(&count, &threads))) {\n@@ -466,2 +455,1 @@\n-        if (!NSK_JVMTI_VERIFY(\n-                NSK_CPP_STUB3(GetThreadInfo, jvmti_env, threads[i], &info))) {\n+        if (!NSK_JVMTI_VERIFY(jvmti_env->GetThreadInfo(threads[i], &info))) {\n@@ -478,2 +466,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-                NSK_CPP_STUB2(Deallocate, jvmti_env, (unsigned char*)threads))) {\n+    if (!NSK_JVMTI_VERIFY(jvmti_env->Deallocate((unsigned char*)threads))) {\n@@ -485,1 +472,1 @@\n-                NSK_CPP_STUB2(NewGlobalRef, jni_env, foundThread)) != NULL)) {\n+                jni_env->NewGlobalRef(foundThread)) != NULL)) {\n@@ -502,2 +489,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-            NSK_CPP_STUB2(AddCapabilities, jvmti_env, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti_env->AddCapabilities(&caps)))\n@@ -518,2 +504,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-            NSK_CPP_STUB2(AddCapabilities, jvmti_env, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti_env->AddCapabilities(&caps)))\n@@ -532,1 +517,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB4(GetLineNumberTable, jvmti_env, method, &count, &table)))\n+    if (!NSK_JVMTI_VERIFY(jvmti_env->GetLineNumberTable(method, &count, &table)))\n@@ -542,1 +527,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(Deallocate, jvmti_env, (unsigned char*)table)))\n+    if (!NSK_JVMTI_VERIFY(jvmti_env->Deallocate((unsigned char*)table)))\n@@ -556,1 +541,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB3(SetBreakpoint, jvmti_env, method, location)))\n+    if (!NSK_JVMTI_VERIFY(jvmti_env->SetBreakpoint(method, location)))\n@@ -570,1 +555,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB3(ClearBreakpoint, jvmti_env, method, location)))\n+    if (!NSK_JVMTI_VERIFY(jvmti_env->ClearBreakpoint(method, location)))\n@@ -583,3 +568,1 @@\n-        if (!NSK_JVMTI_VERIFY(\n-                NSK_CPP_STUB4(SetEventNotificationMode, jvmti_env, enable,\n-                                                list[i], thread))) {\n+        if (!NSK_JVMTI_VERIFY(jvmti_env->SetEventNotificationMode(enable, list[i], thread))) {\n@@ -627,1 +610,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(GetPhase, jvmti_env, &phase))) {\n+    if (!NSK_JVMTI_VERIFY(jvmti_env->GetPhase(&phase))) {\n@@ -635,2 +618,1 @@\n-    if (NSK_JVMTI_VERIFY(\n-            NSK_CPP_STUB5(GetMethodName, jvmti_env, mid, &name, &sig, NULL))) {\n+    if (NSK_JVMTI_VERIFY(jvmti_env->GetMethodName(mid, &name, &sig, NULL))) {\n@@ -640,4 +622,2 @@\n-            if (NSK_JVMTI_VERIFY(\n-                    NSK_CPP_STUB3(GetMethodDeclaringClass, jvmti_env, mid, &cls))\n-             && NSK_JVMTI_VERIFY(\n-                    NSK_CPP_STUB4(GetClassSignature, jvmti_env, cls, &class_sig, NULL))\n+            if (NSK_JVMTI_VERIFY(jvmti_env->GetMethodDeclaringClass(mid, &cls))\n+             && NSK_JVMTI_VERIFY(jvmti_env->GetClassSignature(cls, &class_sig, NULL))\n@@ -653,1 +633,1 @@\n-        NSK_CPP_STUB2(Deallocate, jvmti_env, (unsigned char*)name);\n+        jvmti_env->Deallocate((unsigned char*)name);\n@@ -656,1 +636,1 @@\n-        NSK_CPP_STUB2(Deallocate, jvmti_env, (unsigned char*)sig);\n+        jvmti_env->Deallocate((unsigned char*)sig);\n@@ -659,1 +639,1 @@\n-        NSK_CPP_STUB2(Deallocate, jvmti_env, (unsigned char*)class_sig);\n+        jvmti_env->Deallocate((unsigned char*)class_sig);\n@@ -684,1 +664,1 @@\n-        if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(AddCapabilities, jvmti_env, &caps)))\n+        if (!NSK_JVMTI_VERIFY(jvmti_env->AddCapabilities(&caps)))\n@@ -689,3 +669,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-            NSK_CPP_STUB3(SetEventCallbacks, jvmti_env, callbacks,\n-                sizeof(jvmtiEventCallbacks))))\n+    if (!NSK_JVMTI_VERIFY(jvmti_env->SetEventCallbacks(callbacks, sizeof(jvmtiEventCallbacks))))\n@@ -695,2 +673,1 @@\n-            NSK_CPP_STUB4(SetEventNotificationMode, jvmti_env, JVMTI_ENABLE,\n-                JVMTI_EVENT_NATIVE_METHOD_BIND, NULL)))\n+            jvmti_env->SetEventNotificationMode(JVMTI_ENABLE, JVMTI_EVENT_NATIVE_METHOD_BIND, NULL)))\n@@ -734,1 +711,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(GetCapabilities, jvmti_env, &caps))) {\n+    if (!NSK_JVMTI_VERIFY(jvmti_env->GetCapabilities(&caps))) {\n","filename":"test\/hotspot\/jtreg\/vmTestbase\/nsk\/share\/jvmti\/agent_tools.cpp","additions":42,"deletions":65,"binary":false,"changes":107,"status":"modified"},{"patch":"@@ -90,1 +90,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(Deallocate, jvmti, mem))) {\n+    if (!NSK_JVMTI_VERIFY(jvmti->Deallocate(mem))) {\n@@ -104,1 +104,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB4(GetClassSignature, jvmti, klass, &className, NULL))) {\n+    if (!NSK_JVMTI_VERIFY(jvmti->GetClassSignature(klass, &className, NULL))) {\n@@ -119,1 +119,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB3(GetThreadInfo, jvmti, thread, &info))){\n+    if (!NSK_JVMTI_VERIFY(jvmti->GetThreadInfo(thread, &info))){\n@@ -164,2 +164,1 @@\n-    if (!NSK_JNI_VERIFY(jni,\n-            (klass = NSK_CPP_STUB2(FindClass, jni, \"java\/lang\/Thread\")) != NULL )) {\n+    if (!NSK_JNI_VERIFY(jni, (klass = jni->FindClass(\"java\/lang\/Thread\")) != NULL )) {\n@@ -170,1 +169,1 @@\n-            (threadConstructor = NSK_CPP_STUB4(GetMethodID, jni, klass, \"<init>\", \"()V\") )  != NULL )) {\n+            (threadConstructor = jni->GetMethodID(klass, \"<init>\", \"()V\") )  != NULL )) {\n@@ -176,1 +175,1 @@\n-            (thread = NSK_CPP_STUB4(NewObject, jni, klass, threadConstructor, NULL)) != NULL ) ) {\n+            (thread = jni->NewObject(klass, threadConstructor, NULL)) != NULL ) ) {\n@@ -181,2 +180,1 @@\n-    if (!NSK_JNI_VERIFY(jni, (thread =\n-        NSK_CPP_STUB2(NewGlobalRef, jni, thread)) != NULL)) {\n+    if (!NSK_JNI_VERIFY(jni, (thread = jni->NewGlobalRef(thread)) != NULL)) {\n@@ -196,2 +194,1 @@\n-    if (!NSK_JNI_VERIFY(jni, (threadNameString =\n-        NSK_CPP_STUB2(NewStringUTF, jni, threadName)) != NULL))\n+    if (!NSK_JNI_VERIFY(jni, (threadNameString = jni->NewStringUTF(threadName)) != NULL))\n@@ -200,2 +197,1 @@\n-    if (!NSK_JNI_VERIFY(jni,\n-            (klass = NSK_CPP_STUB2(FindClass, jni, \"java\/lang\/Thread\")) != NULL )) {\n+    if (!NSK_JNI_VERIFY(jni, (klass = jni->FindClass(\"java\/lang\/Thread\")) != NULL )) {\n@@ -206,1 +202,1 @@\n-            (threadConstructor = NSK_CPP_STUB4(GetMethodID, jni, klass, \"<init>\", \"(Ljava\/lang\/String;)V\") )  != NULL )) {\n+            (threadConstructor = jni->GetMethodID(klass, \"<init>\", \"(Ljava\/lang\/String;)V\") )  != NULL )) {\n@@ -212,1 +208,1 @@\n-            (thread = NSK_CPP_STUB4(NewObject, jni, klass, threadConstructor, threadNameString)) != NULL ) ) {\n+            (thread = jni->NewObject(klass, threadConstructor, threadNameString)) != NULL ) ) {\n@@ -217,2 +213,1 @@\n-    if (!NSK_JNI_VERIFY(jni, (thread =\n-        NSK_CPP_STUB2(NewGlobalRef, jni, thread)) != NULL)) {\n+    if (!NSK_JNI_VERIFY(jni, (thread = jni->NewGlobalRef(thread)) != NULL)) {\n","filename":"test\/hotspot\/jtreg\/vmTestbase\/nsk\/share\/jvmti\/aod\/jvmti_aod.cpp","additions":12,"deletions":17,"binary":false,"changes":29,"status":"modified"},{"patch":"@@ -71,2 +71,2 @@\n-#define nsk_jvmti_aod_enableEvent(X,Y)  NSK_JVMTI_VERIFY( NSK_CPP_STUB4(SetEventNotificationMode, X, JVMTI_ENABLE, Y, NULL))\n-#define nsk_jvmti_aod_disableEvent(X,Y) NSK_JVMTI_VERIFY( NSK_CPP_STUB4(SetEventNotificationMode, X, JVMTI_DISABLE, Y, NULL))\n+#define nsk_jvmti_aod_enableEvent(X,Y)  NSK_JVMTI_VERIFY(X->SetEventNotificationMode(JVMTI_ENABLE, Y, NULL))\n+#define nsk_jvmti_aod_disableEvent(X,Y) NSK_JVMTI_VERIFY(X->SetEventNotificationMode(JVMTI_DISABLE, Y, NULL))\n","filename":"test\/hotspot\/jtreg\/vmTestbase\/nsk\/share\/jvmti\/aod\/jvmti_aod.h","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -81,2 +81,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB3(RedefineClasses,\n-            jvmti, classCount, class_def)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->RedefineClasses(classCount, class_def)))\n@@ -106,2 +105,1 @@\n-        if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB3(Allocate, jvmti_env,\n-                name_len, (unsigned char**) &names[classCount]))) {\n+        if (!NSK_JVMTI_VERIFY(jvmti_env->Allocate(name_len, (unsigned char**) &names[classCount]))) {\n@@ -112,2 +110,1 @@\n-        if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB3(Allocate,\n-                jvmti_env, class_data_len, (unsigned char**)\n+        if (!NSK_JVMTI_VERIFY(jvmti_env->Allocate(class_data_len, (unsigned char**)\n@@ -136,2 +133,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB5(GetMethodName,\n-            jvmti_env, method, &name, &signature, NULL))) {\n+    if (!NSK_JVMTI_VERIFY(jvmti_env->GetMethodName(method, &name, &signature, NULL))) {\n@@ -144,1 +140,1 @@\n-        NSK_CPP_STUB2(Deallocate, jvmti_env, (unsigned char*)name);\n+        jvmti_env->Deallocate((unsigned char*)name);\n@@ -146,1 +142,1 @@\n-        NSK_CPP_STUB2(Deallocate, jvmti_env, (unsigned char*)signature);\n+        jvmti_env->Deallocate((unsigned char*)signature);\n@@ -171,2 +167,1 @@\n-            if (!NSK_JNI_VERIFY(jni_env, (klass =\n-                    NSK_CPP_STUB2(GetObjectClass, jni_env, exception)) != NULL)) {\n+            if (!NSK_JNI_VERIFY(jni_env, (klass = jni_env->GetObjectClass(exception)) != NULL)) {\n@@ -176,2 +171,1 @@\n-            if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB4(GetClassSignature, jvmti_env,\n-                    klass, &signature, NULL))) {\n+            if (!NSK_JVMTI_VERIFY(jvmti_env->GetClassSignature(klass, &signature, NULL))) {\n@@ -184,1 +178,1 @@\n-                NSK_CPP_STUB2(Deallocate, jvmti_env, (unsigned char*)signature);\n+                jvmti_env->Deallocate((unsigned char*)signature);\n@@ -193,2 +187,2 @@\n-            if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB4(SetEventNotificationMode,\n-                    jvmti_env, ((newFlag) ? JVMTI_DISABLE : JVMTI_ENABLE),\n+            if (!NSK_JVMTI_VERIFY(jvmti_env->SetEventNotificationMode(\n+                    ((newFlag) ? JVMTI_DISABLE : JVMTI_ENABLE),\n@@ -200,2 +194,1 @@\n-            jint profileCount = NSK_CPP_STUB3(GetStaticIntField, jni_env,\n-                profile_klass, count_field);\n+            jint profileCount = jni_env->GetStaticIntField(profile_klass, count_field);\n@@ -218,2 +211,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB4(SetEventNotificationMode,\n-            jvmti, JVMTI_DISABLE, JVMTI_EVENT_CLASS_FILE_LOAD_HOOK, NULL)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->SetEventNotificationMode(JVMTI_DISABLE, JVMTI_EVENT_CLASS_FILE_LOAD_HOOK, NULL)))\n@@ -223,2 +215,1 @@\n-        if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB4(SetEventNotificationMode,\n-                jvmti, JVMTI_ENABLE, JVMTI_EVENT_SINGLE_STEP, NULL)))\n+        if (!NSK_JVMTI_VERIFY(jvmti->SetEventNotificationMode(JVMTI_ENABLE, JVMTI_EVENT_SINGLE_STEP, NULL)))\n@@ -228,2 +219,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB3(CreateRawMonitor,\n-            jvmti, \"waitLock\", &waitLock)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->CreateRawMonitor(\"waitLock\", &waitLock)))\n@@ -234,2 +224,1 @@\n-        if (!NSK_JNI_VERIFY(jni, (old_class_def[i].klass =\n-                NSK_CPP_STUB2(FindClass, jni, names[i])) != NULL))\n+        if (!NSK_JNI_VERIFY(jni, (old_class_def[i].klass = jni->FindClass(names[i])) != NULL))\n@@ -239,2 +228,1 @@\n-                NSK_CPP_STUB2(NewGlobalRef, jni,\n-                    old_class_def[i].klass)) != NULL))\n+                jni->NewGlobalRef(old_class_def[i].klass)) != NULL))\n@@ -246,2 +234,1 @@\n-        if (!NSK_JNI_VERIFY(jni, (profile_klass =\n-                NSK_CPP_STUB2(FindClass, jni, PROFILE_CLASS_NAME)) != NULL))\n+        if (!NSK_JNI_VERIFY(jni, (profile_klass = jni->FindClass(PROFILE_CLASS_NAME)) != NULL))\n@@ -251,1 +238,1 @@\n-                NSK_CPP_STUB2(NewGlobalRef, jni, profile_klass)) != NULL))\n+                jni->NewGlobalRef(profile_klass)) != NULL))\n@@ -255,3 +242,3 @@\n-                NSK_CPP_STUB4(GetStaticFieldID, jni, profile_klass,\n-                    (bci_mode == BCI_MODE_CALL) ? \"callCount\" : \"allocCount\",\n-                    \"I\")) != NULL))\n+                jni->GetStaticFieldID(profile_klass,\n+                                      (bci_mode == BCI_MODE_CALL) ? \"callCount\" : \"allocCount\",\n+                                      \"I\")) != NULL))\n@@ -260,2 +247,1 @@\n-        if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB3(Allocate, jvmti,\n-                classCount * sizeof(jvmtiClassDefinition),\n+        if (!NSK_JVMTI_VERIFY(jvmti->Allocate(classCount * sizeof(jvmtiClassDefinition),\n@@ -276,2 +262,1 @@\n-        if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB4(SetEventNotificationMode,\n-                jvmti, JVMTI_ENABLE, JVMTI_EVENT_EXCEPTION, NULL)))\n+        if (!NSK_JVMTI_VERIFY(jvmti->SetEventNotificationMode(JVMTI_ENABLE, JVMTI_EVENT_EXCEPTION, NULL)))\n@@ -288,1 +273,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(RawMonitorEnter, jvmti, waitLock)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->RawMonitorEnter(waitLock)))\n@@ -291,2 +276,1 @@\n-    if (!NSK_JVMTI_VERIFY(\n-            NSK_CPP_STUB3(RawMonitorWait, jvmti, waitLock, millis)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->RawMonitorWait(waitLock, millis)))\n@@ -295,1 +279,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(RawMonitorExit, jvmti, waitLock)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->RawMonitorExit(waitLock)))\n@@ -323,2 +307,1 @@\n-        if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB4(SetEventNotificationMode,\n-                jvmti, JVMTI_DISABLE, JVMTI_EVENT_EXCEPTION, NULL)))\n+        if (!NSK_JVMTI_VERIFY(jvmti->SetEventNotificationMode(JVMTI_DISABLE, JVMTI_EVENT_EXCEPTION, NULL)))\n@@ -337,2 +320,2 @@\n-                if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB4(SetEventNotificationMode,\n-                        jvmti, (((i % 2)==0) ? JVMTI_DISABLE : JVMTI_ENABLE),\n+                if (!NSK_JVMTI_VERIFY(jvmti->SetEventNotificationMode(\n+                        (((i % 2)==0) ? JVMTI_DISABLE : JVMTI_ENABLE),\n@@ -344,2 +327,1 @@\n-                jint profileCount = NSK_CPP_STUB3(GetStaticIntField, jni,\n-                    profile_klass, count_field);\n+                jint profileCount = jni->GetStaticIntField(profile_klass, count_field);\n@@ -355,2 +337,1 @@\n-        if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB4(SetEventNotificationMode,\n-                jvmti, JVMTI_DISABLE, JVMTI_EVENT_SINGLE_STEP, NULL)))\n+        if (!NSK_JVMTI_VERIFY(jvmti->SetEventNotificationMode(JVMTI_DISABLE, JVMTI_EVENT_SINGLE_STEP, NULL)))\n@@ -449,2 +430,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB3(Allocate, jvmti,\n-            max_classes * sizeof(char*), (unsigned char**) &names)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->Allocate(max_classes * sizeof(char*), (unsigned char**) &names)))\n@@ -453,2 +433,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB3(Allocate, jvmti,\n-            max_classes * sizeof(jvmtiClassDefinition),\n+    if (!NSK_JVMTI_VERIFY(jvmti->Allocate(max_classes * sizeof(jvmtiClassDefinition),\n@@ -468,1 +447,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(AddCapabilities, jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->AddCapabilities(&caps)))\n@@ -484,2 +463,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB3(SetEventCallbacks,\n-            jvmti, &callbacks, sizeof(callbacks))))\n+    if (!NSK_JVMTI_VERIFY(jvmti->SetEventCallbacks(&callbacks, sizeof(callbacks))))\n@@ -489,2 +467,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB4(SetEventNotificationMode,\n-            jvmti, JVMTI_ENABLE, JVMTI_EVENT_CLASS_FILE_LOAD_HOOK, NULL)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->SetEventNotificationMode(JVMTI_ENABLE, JVMTI_EVENT_CLASS_FILE_LOAD_HOOK, NULL)))\n@@ -492,2 +469,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB4(SetEventNotificationMode,\n-            jvmti, JVMTI_ENABLE, JVMTI_EVENT_COMPILED_METHOD_LOAD, NULL)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->SetEventNotificationMode(JVMTI_ENABLE, JVMTI_EVENT_COMPILED_METHOD_LOAD, NULL)))\n","filename":"test\/hotspot\/jtreg\/vmTestbase\/nsk\/share\/jvmti\/hotswap\/HotSwap.cpp","additions":38,"deletions":62,"binary":false,"changes":100,"status":"modified"},{"patch":"@@ -118,1 +118,1 @@\n-    if ( ! NSK_VERIFY(NSK_CPP_STUB3(SetTag, jvmti, o, tag) == JVMTI_ERROR_NONE) ) {\n+    if ( ! NSK_VERIFY(jvmti->SetTag(o, tag) == JVMTI_ERROR_NONE) ) {\n@@ -123,1 +123,1 @@\n-    if ( ! NSK_VERIFY(NSK_CPP_STUB3(GetObjectHashCode, jvmti, o, &hashCode) == JVMTI_ERROR_NONE) ) {\n+    if ( ! NSK_VERIFY(jvmti->GetObjectHashCode(o, &hashCode) == JVMTI_ERROR_NONE) ) {\n@@ -134,1 +134,1 @@\n-        if ( ! NSK_VERIFY((s = NSK_CPP_STUB3(GetStringUTFChars, jni, sInfo, &fCopy)) != NULL) ) {\n+        if ( ! NSK_VERIFY((s = jni->GetStringUTFChars(sInfo, &fCopy)) != NULL) ) {\n@@ -146,1 +146,1 @@\n-        NSK_CPP_STUB3(ReleaseStringUTFChars, jni, sInfo, s);\n+        jni->ReleaseStringUTFChars(sInfo, s);\n@@ -163,1 +163,1 @@\n-    if ( ! NSK_VERIFY((r = NSK_CPP_STUB3(GetTag, jvmti, o, &tag)) == JVMTI_ERROR_NONE) ) {\n+    if ( ! NSK_VERIFY((r = jvmti->GetTag(o, &tag)) == JVMTI_ERROR_NONE) ) {\n@@ -227,1 +227,1 @@\n-    if ( ! NSK_VERIFY((r = NSK_CPP_STUB3(GetTag, jvmti, from, &tagFrom)) == JVMTI_ERROR_NONE) ) {\n+    if ( ! NSK_VERIFY((r = jvmti->GetTag(from, &tagFrom)) == JVMTI_ERROR_NONE) ) {\n@@ -234,1 +234,1 @@\n-    if ( ! NSK_VERIFY((r = NSK_CPP_STUB3(GetTag, jvmti, to, &tagTo)) == JVMTI_ERROR_NONE) ) {\n+    if ( ! NSK_VERIFY((r = jvmti->GetTag(to, &tagTo)) == JVMTI_ERROR_NONE) ) {\n","filename":"test\/hotspot\/jtreg\/vmTestbase\/nsk\/share\/jvmti\/jvmti_FollowRefObjects.cpp","additions":7,"deletions":7,"binary":false,"changes":14,"status":"modified"},{"patch":"@@ -463,2 +463,1 @@\n-    if (!NSK_JNI_VERIFY(jni, (str_obj =\n-            NSK_CPP_STUB2(NewStringUTF, jni, context.options.string)) != NULL)) {\n+    if (!NSK_JNI_VERIFY(jni, (str_obj = jni->NewStringUTF(context.options.string)) != NULL)) {\n@@ -648,1 +647,1 @@\n-    jvmtiError error = NSK_CPP_STUB3(CreateRawMonitor, env, name, monitor);\n+    jvmtiError error = env->CreateRawMonitor(name, monitor);\n@@ -662,1 +661,1 @@\n-    jvmtiError error = NSK_CPP_STUB2(RawMonitorEnter, env, monitor);\n+    jvmtiError error = env->RawMonitorEnter(monitor);\n@@ -667,1 +666,1 @@\n-    jvmtiError error = NSK_CPP_STUB2(RawMonitorExit, env, monitor);\n+    jvmtiError error = env->RawMonitorExit(monitor);\n@@ -672,1 +671,1 @@\n-    jvmtiError error = NSK_CPP_STUB2(RawMonitorNotify, env, monitor);\n+    jvmtiError error = env->RawMonitorNotify(monitor);\n@@ -677,1 +676,1 @@\n-    jvmtiError error = NSK_CPP_STUB3(RawMonitorWait, env, monitor, millis);\n+    jvmtiError error = env->RawMonitorWait(monitor, millis);\n@@ -682,1 +681,1 @@\n-    jvmtiError error = NSK_CPP_STUB2(GetPhase, env, phase);\n+    jvmtiError error = env->GetPhase(phase);\n","filename":"test\/hotspot\/jtreg\/vmTestbase\/nsk\/share\/jvmti\/jvmti_tools.cpp","additions":7,"deletions":8,"binary":false,"changes":15,"status":"modified"},{"patch":"@@ -61,4 +61,0 @@\n-    - access native JVM environment in a compiler independent manner\n-\n-        NSK_CPP_STUBn(function, env, arg1, ..., argn)\n-\n@@ -93,1 +89,1 @@\n-Typical example of using macroses NSK_CPP_STUB and NSK_VERIFY\n+Typical example of using the NSK_VERIFY macro\n@@ -98,1 +94,1 @@\n-            NSK_CPP_STUB3(GetEnv, jvm, &env, JNI_VERSION_1_2) == JNI_OK)) {\n+            jvm->GetEnv(&env, JNI_VERSION_1_2) == JNI_OK)) {\n","filename":"test\/hotspot\/jtreg\/vmTestbase\/nsk\/share\/native\/README","additions":2,"deletions":6,"binary":false,"changes":8,"status":"modified"},{"patch":"@@ -41,19 +41,0 @@\n-\/**\n- * Use examples:\n- *\n- *     jfieldID id = NSK_CPP_STUB3(jni,GetFieldID,clazz,name,sig);\n- *\n- *     jvmtiError code = NSK_CPP_STUB0(jvmti,DisposeEnvironment);\n- *\n- *\/\n-\n-#define NSK_CPP_STUB1(Func,env)  env->Func()\n-#define NSK_CPP_STUB2(Func,env,a)  env->Func(a)\n-#define NSK_CPP_STUB3(Func,env,a,b)  env->Func(a,b)\n-#define NSK_CPP_STUB4(Func,env,a,b,c)  env->Func(a,b,c)\n-#define NSK_CPP_STUB5(Func,env,a,b,c,d)  env->Func(a,b,c,d)\n-#define NSK_CPP_STUB6(Func,env,a,b,c,d,e)  env->Func(a,b,c,d,e)\n-#define NSK_CPP_STUB7(Func,env,a,b,c,d,e,f)  env->Func(a,b,c,d,e,f)\n-#define NSK_CPP_STUB8(Func,env,a,b,c,d,e,f,g)  env->Func(a,b,c,d,e,f,g)\n-#define NSK_CPP_STUB9(Func,env,a,b,c,d,e,f,g,h)  env->Func(a,b,c,d,e,f,g,h)\n-\n","filename":"test\/hotspot\/jtreg\/vmTestbase\/nsk\/share\/native\/nsk_tools.h","additions":0,"deletions":19,"binary":false,"changes":19,"status":"modified"},{"patch":"@@ -32,2 +32,2 @@\n-#define EXCEPTION_CLEAR NSK_CPP_STUB1(ExceptionClear, env)\n-#define EXCEPTION_OCCURRED NSK_CPP_STUB1(ExceptionOccurred, env)\n+#define EXCEPTION_CLEAR env->ExceptionClear()\n+#define EXCEPTION_OCCURRED env->ExceptionOccurred()\n@@ -40,2 +40,1 @@\n-            if (NSK_CPP_STUB3(IsInstanceOf, env, exception, \\\n-                        exceptionClass) == JNI_TRUE) { \\\n+            if (env->IsInstanceOf(exception, exceptionClass) == JNI_TRUE) { \\\n@@ -49,1 +48,1 @@\n-            NSK_CPP_STUB2(FindClass, env, _className)) != NULL))\\\n+            env->FindClass(_className)) != NULL))\\\n@@ -54,1 +53,1 @@\n-            NSK_CPP_STUB2(GetObjectClass, env, _obj)) != NULL))\\\n+            env->GetObjectClass(_obj)) != NULL))\\\n@@ -59,2 +58,1 @@\n-            NSK_CPP_STUB4(GetFieldID, env, _class,\\\n-                _fieldName, _fieldSig)) != NULL))\\\n+            env->GetFieldID(_class, _fieldName, _fieldSig)) != NULL))\\\n@@ -65,2 +63,1 @@\n-            NSK_CPP_STUB4(GetStaticFieldID, env, _class,\\\n-                _fieldName, _fieldSig)) != NULL))\\\n+            env->GetStaticFieldID(_class, _fieldName, _fieldSig)) != NULL))\\\n@@ -71,1 +68,1 @@\n-    _value = NSK_CPP_STUB3(GetStaticBooleanField, env, _class, field)\n+    _value = env->GetStaticBooleanField(_class, field)\n@@ -75,1 +72,1 @@\n-    _value = NSK_CPP_STUB3(GetStaticIntField, env, _class, field)\n+    _value = env->GetStaticIntField(_class, field)\n@@ -79,2 +76,1 @@\n-    _value = NSK_CPP_STUB3(GetStaticObjectField, env, _class, \\\n-                                field)\n+    _value = env->GetStaticObjectField(_class, field)\n@@ -84,1 +80,1 @@\n-    _value = NSK_CPP_STUB3(GetIntField, env, _obj, field)\n+    _value = env->GetIntField(_obj, field)\n@@ -88,1 +84,1 @@\n-    NSK_CPP_STUB4(SetIntField, env, _obj, field, _newValue)\n+    env->SetIntField(_obj, field, _newValue)\n@@ -92,1 +88,1 @@\n-    NSK_CPP_STUB4(SetStaticIntField, env, _class, field, _newValue)\n+    env->SetStaticIntField(_class, field, _newValue)\n@@ -96,1 +92,1 @@\n-    _value = NSK_CPP_STUB3(GetObjectField, env, _obj, field)\n+    _value = env->GetObjectField(_obj, field)\n@@ -100,2 +96,1 @@\n-            NSK_CPP_STUB4(GetStaticMethodID, env, _class,\\\n-                _methodName, _sig)) != NULL))\\\n+            env->GetStaticMethodID(_class, _methodName, _sig)) != NULL))\\\n@@ -106,2 +101,1 @@\n-            NSK_CPP_STUB4(GetMethodID, env, _class,\\\n-                _methodName, _sig)) != NULL))\\\n+            env->GetMethodID(_class, _methodName, _sig)) != NULL))\\\n@@ -112,2 +106,1 @@\n-    if (!NSK_JNI_VERIFY_VOID(env, NSK_CPP_STUB3(CallStaticVoidMethod, env,\\\n-                            _class, method)))\\\n+    if (!NSK_JNI_VERIFY_VOID(env, env->CallStaticVoidMethod(_class, method)))\\\n@@ -118,2 +111,1 @@\n-    if (!NSK_JNI_VERIFY_VOID(env, NSK_CPP_STUB4(CallStaticVoidMethod, env,\\\n-                                                    _class, method, _param)))\\\n+    if (!NSK_JNI_VERIFY_VOID(env, env->CallStaticVoidMethod(_class, method, _param)))\\\n@@ -124,2 +116,1 @@\n-    if (!NSK_JNI_VERIFY_VOID(env, NSK_CPP_STUB3(CallVoidMethod, env, _obj,\\\n-                                                    method)))\\\n+    if (!NSK_JNI_VERIFY_VOID(env, env->CallVoidMethod(_obj, method)))\\\n@@ -130,2 +121,1 @@\n-    if (!NSK_JNI_VERIFY_VOID(env, NSK_CPP_STUB4(CallVoidMethod, env, _obj,\\\n-                                                    method, _param)))\\\n+    if (!NSK_JNI_VERIFY_VOID(env, env->CallVoidMethod(_obj, method, _param)))\\\n@@ -135,1 +125,1 @@\n-    NSK_JNI_VERIFY(env, NSK_CPP_STUB2(MonitorEnter, env, x) == 0)\n+    NSK_JNI_VERIFY(env, env->MonitorEnter(x) == 0)\n@@ -138,1 +128,1 @@\n-    NSK_JNI_VERIFY(env, NSK_CPP_STUB2(MonitorExit, env, x) == 0)\n+    NSK_JNI_VERIFY(env, env->MonitorExit(x) == 0)\n","filename":"test\/hotspot\/jtreg\/vmTestbase\/nsk\/stress\/strace\/nsk_strace.h","additions":22,"deletions":32,"binary":false,"changes":54,"status":"modified"},{"patch":"@@ -90,1 +90,1 @@\n-        NSK_CPP_STUB3(CallStaticVoidMethod, env, threadClass, method);\n+        env->CallStaticVoidMethod(threadClass, method);\n@@ -94,1 +94,1 @@\n-        NSK_CPP_STUB3(CallVoidMethod, env, obj, method);\n+        env->CallVoidMethod(obj, method);\n","filename":"test\/hotspot\/jtreg\/vmTestbase\/nsk\/stress\/strace\/strace005.cpp","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -91,1 +91,1 @@\n-        NSK_CPP_STUB3(CallStaticVoidMethod, env, threadClass, method);\n+        env->CallStaticVoidMethod(threadClass, method);\n@@ -95,1 +95,1 @@\n-        NSK_CPP_STUB3(CallVoidMethod, env, obj, method);\n+        env->CallVoidMethod(obj, method);\n","filename":"test\/hotspot\/jtreg\/vmTestbase\/nsk\/stress\/strace\/strace006.cpp","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -91,1 +91,1 @@\n-        if ( ! NSK_JVMTI_VERIFY(NSK_CPP_STUB4(SetEventNotificationMode, jvmti_env, JVMTI_DISABLE, JVMTI_EVENT_SINGLE_STEP, NULL)) )\n+        if ( ! NSK_JVMTI_VERIFY(jvmti_env->SetEventNotificationMode(JVMTI_DISABLE, JVMTI_EVENT_SINGLE_STEP, NULL)) )\n@@ -97,1 +97,1 @@\n-        if ( ! NSK_JVMTI_VERIFY(NSK_CPP_STUB4(SetEventNotificationMode, jvmti_env, JVMTI_ENABLE, JVMTI_EVENT_SINGLE_STEP, NULL)) )\n+        if ( ! NSK_JVMTI_VERIFY(jvmti_env->SetEventNotificationMode(JVMTI_ENABLE, JVMTI_EVENT_SINGLE_STEP, NULL)) )\n@@ -102,1 +102,1 @@\n-            if ( ! NSK_JVMTI_VERIFY(NSK_CPP_STUB2(PopFrame, jvmti_env, thread)) )\n+            if ( ! NSK_JVMTI_VERIFY(jvmti_env->PopFrame(thread)) )\n@@ -106,1 +106,1 @@\n-            if ( ! NSK_JVMTI_VERIFY(NSK_CPP_STUB2(ForceEarlyReturnVoid, jvmti_env, thread)) )\n+            if ( ! NSK_JVMTI_VERIFY(jvmti_env->ForceEarlyReturnVoid(thread)) )\n@@ -144,1 +144,1 @@\n-    if ( ! NSK_JVMTI_VERIFY(NSK_CPP_STUB3(GetMethodDeclaringClass, jvmti_env, method, &clazz)) )\n+    if ( ! NSK_JVMTI_VERIFY(jvmti_env->GetMethodDeclaringClass(method, &clazz)) )\n@@ -203,1 +203,1 @@\n-    if ( ! NSK_JVMTI_VERIFY(NSK_CPP_STUB2(AddCapabilities, gJvmtiEnv, &caps)) )\n+    if ( ! NSK_JVMTI_VERIFY(gJvmtiEnv->AddCapabilities(&caps)) )\n@@ -210,1 +210,1 @@\n-    if ( ! NSK_JVMTI_VERIFY(NSK_CPP_STUB3(SetEventCallbacks, gJvmtiEnv, &callbacks, sizeof(callbacks))) )\n+    if ( ! NSK_JVMTI_VERIFY(gJvmtiEnv->SetEventCallbacks(&callbacks, sizeof(callbacks))) )\n@@ -213,1 +213,1 @@\n-    if ( ! NSK_JVMTI_VERIFY(NSK_CPP_STUB4(SetEventNotificationMode, gJvmtiEnv, JVMTI_ENABLE, JVMTI_EVENT_METHOD_ENTRY, NULL) ) )\n+    if ( ! NSK_JVMTI_VERIFY(gJvmtiEnv->SetEventNotificationMode(JVMTI_ENABLE, JVMTI_EVENT_METHOD_ENTRY, NULL) ) )\n@@ -216,1 +216,1 @@\n-    if ( ! NSK_JVMTI_VERIFY(NSK_CPP_STUB4(SetEventNotificationMode, gJvmtiEnv, JVMTI_DISABLE, JVMTI_EVENT_SINGLE_STEP, NULL) ) )\n+    if ( ! NSK_JVMTI_VERIFY(gJvmtiEnv->SetEventNotificationMode(JVMTI_DISABLE, JVMTI_EVENT_SINGLE_STEP, NULL) ) )\n","filename":"test\/hotspot\/jtreg\/vmTestbase\/vm\/mlvm\/indy\/func\/jvmti\/share\/IndyRedefineClass.cpp","additions":9,"deletions":9,"binary":false,"changes":18,"status":"modified"},{"patch":"@@ -92,1 +92,1 @@\n-                NSK_JVMTI_VERIFY(NSK_CPP_STUB4(SetEventNotificationMode, jvmti_env, JVMTI_ENABLE, JVMTI_EVENT_SINGLE_STEP, NULL));\n+                NSK_JVMTI_VERIFY(jvmti_env->SetEventNotificationMode(JVMTI_ENABLE, JVMTI_EVENT_SINGLE_STEP, NULL));\n@@ -119,1 +119,1 @@\n-    NSK_JVMTI_VERIFY(NSK_CPP_STUB4(SetEventNotificationMode, gJvmtiEnv, JVMTI_DISABLE, JVMTI_EVENT_SINGLE_STEP, NULL));\n+    NSK_JVMTI_VERIFY(gJvmtiEnv->SetEventNotificationMode(JVMTI_DISABLE, JVMTI_EVENT_SINGLE_STEP, NULL));\n@@ -122,1 +122,1 @@\n-        if ( ! NSK_JVMTI_VERIFY(NSK_CPP_STUB3(SetBreakpoint, jvmti_env, method, location)) )\n+        if ( ! NSK_JVMTI_VERIFY(jvmti_env->SetBreakpoint(method, location)) )\n@@ -125,1 +125,1 @@\n-        NSK_JVMTI_VERIFY(NSK_CPP_STUB4(SetEventNotificationMode, gJvmtiEnv, JVMTI_ENABLE, JVMTI_EVENT_BREAKPOINT, NULL));\n+        NSK_JVMTI_VERIFY(gJvmtiEnv->SetEventNotificationMode(JVMTI_ENABLE, JVMTI_EVENT_BREAKPOINT, NULL));\n@@ -129,1 +129,1 @@\n-        NSK_JVMTI_VERIFY(NSK_CPP_STUB2(PopFrame, gJvmtiEnv, thread));\n+        NSK_JVMTI_VERIFY(gJvmtiEnv->PopFrame(thread));\n@@ -133,1 +133,1 @@\n-            NSK_JVMTI_VERIFY(NSK_CPP_STUB2(PopFrame, gJvmtiEnv, thread));\n+            NSK_JVMTI_VERIFY(gJvmtiEnv->PopFrame(thread));\n@@ -161,2 +161,2 @@\n-    NSK_JVMTI_VERIFY(NSK_CPP_STUB3(ClearBreakpoint, jvmti_env, method, location));\n-    NSK_JVMTI_VERIFY(NSK_CPP_STUB4(SetEventNotificationMode, gJvmtiEnv, JVMTI_DISABLE, JVMTI_EVENT_BREAKPOINT, NULL));\n+    NSK_JVMTI_VERIFY(jvmti_env->ClearBreakpoint(method, location));\n+    NSK_JVMTI_VERIFY(gJvmtiEnv->SetEventNotificationMode(JVMTI_DISABLE, JVMTI_EVENT_BREAKPOINT, NULL));\n@@ -166,1 +166,1 @@\n-    NSK_JVMTI_VERIFY(NSK_CPP_STUB3(ForceEarlyReturnInt, jvmti_env, thread, 0));\n+    NSK_JVMTI_VERIFY(jvmti_env->ForceEarlyReturnInt(thread, 0));\n@@ -190,1 +190,1 @@\n-    if ( ! NSK_JVMTI_VERIFY(NSK_CPP_STUB2(AddCapabilities, gJvmtiEnv, &caps)) )\n+    if ( ! NSK_JVMTI_VERIFY(gJvmtiEnv->AddCapabilities(&caps)) )\n@@ -198,1 +198,1 @@\n-    if ( ! NSK_JVMTI_VERIFY(NSK_CPP_STUB3(SetEventCallbacks, gJvmtiEnv, &callbacks, sizeof(callbacks))) )\n+    if ( ! NSK_JVMTI_VERIFY(gJvmtiEnv->SetEventCallbacks(&callbacks, sizeof(callbacks))) )\n@@ -201,1 +201,1 @@\n-    if ( ! NSK_JVMTI_VERIFY(NSK_CPP_STUB4(SetEventNotificationMode, gJvmtiEnv, JVMTI_ENABLE, JVMTI_EVENT_METHOD_ENTRY, NULL) ) )\n+    if ( ! NSK_JVMTI_VERIFY(gJvmtiEnv->SetEventNotificationMode(JVMTI_ENABLE, JVMTI_EVENT_METHOD_ENTRY, NULL) ) )\n","filename":"test\/hotspot\/jtreg\/vmTestbase\/vm\/mlvm\/indy\/func\/jvmti\/stepBreakPopReturn\/stepBreakPopReturn.cpp","additions":12,"deletions":12,"binary":false,"changes":24,"status":"modified"},{"patch":"@@ -51,1 +51,1 @@\n-    if ( ! NSK_JNI_VERIFY(pEnv, (mhClass = NSK_CPP_STUB2(GetObjectClass, pEnv, mhToCall)) != NULL) )\n+    if ( ! NSK_JNI_VERIFY(pEnv, (mhClass = pEnv->GetObjectClass(mhToCall)) != NULL) )\n@@ -54,3 +54,1 @@\n-    if ( ! NSK_JNI_VERIFY(pEnv, NULL != (mid = NSK_CPP_STUB4(GetMethodID, pEnv, mhClass,\n-            \"invokeWithArguments\",\n-            \"([Ljava\/lang\/Object;)Ljava\/lang\/Object;\"))) )\n+    if ( ! NSK_JNI_VERIFY(pEnv, NULL != (mid = pEnv->GetMethodID(mhClass, \"invokeWithArguments\", \"([Ljava\/lang\/Object;)Ljava\/lang\/Object;\"))) )\n@@ -59,1 +57,1 @@\n-    NSK_JNI_VERIFY(pEnv, NULL != (objectClass = NSK_CPP_STUB2(FindClass, pEnv, \"java\/lang\/Object\")));\n+    NSK_JNI_VERIFY(pEnv, NULL != (objectClass = pEnv->FindClass(\"java\/lang\/Object\")));\n@@ -61,1 +59,1 @@\n-    NSK_JNI_VERIFY(pEnv, NULL != (arguments = NSK_CPP_STUB4(NewObjectArray, pEnv, ARGS_COUNT, objectClass, NULL)));\n+    NSK_JNI_VERIFY(pEnv, NULL != (arguments = pEnv->NewObjectArray(ARGS_COUNT, objectClass, NULL)));\n@@ -63,6 +61,6 @@\n-    NSK_JNI_VERIFY_VOID(pEnv, NSK_CPP_STUB4(SetObjectArrayElement, pEnv, arguments, 0, a1));\n-    NSK_JNI_VERIFY_VOID(pEnv, NSK_CPP_STUB4(SetObjectArrayElement, pEnv, arguments, 1, a2));\n-    NSK_JNI_VERIFY_VOID(pEnv, NSK_CPP_STUB4(SetObjectArrayElement, pEnv, arguments, 2, a3));\n-    NSK_JNI_VERIFY_VOID(pEnv, NSK_CPP_STUB4(SetObjectArrayElement, pEnv, arguments, 3, a4));\n-    NSK_JNI_VERIFY_VOID(pEnv, NSK_CPP_STUB4(SetObjectArrayElement, pEnv, arguments, 4, a5));\n-    NSK_JNI_VERIFY_VOID(pEnv, NSK_CPP_STUB4(SetObjectArrayElement, pEnv, arguments, 5, a6));\n+    NSK_JNI_VERIFY_VOID(pEnv, pEnv->SetObjectArrayElement(arguments, 0, a1));\n+    NSK_JNI_VERIFY_VOID(pEnv, pEnv->SetObjectArrayElement(arguments, 1, a2));\n+    NSK_JNI_VERIFY_VOID(pEnv, pEnv->SetObjectArrayElement(arguments, 2, a3));\n+    NSK_JNI_VERIFY_VOID(pEnv, pEnv->SetObjectArrayElement(arguments, 3, a4));\n+    NSK_JNI_VERIFY_VOID(pEnv, pEnv->SetObjectArrayElement(arguments, 4, a5));\n+    NSK_JNI_VERIFY_VOID(pEnv, pEnv->SetObjectArrayElement(arguments, 5, a6));\n@@ -71,1 +69,1 @@\n-    NSK_JNI_VERIFY(pEnv, NULL != (result = NSK_CPP_STUB4(CallObjectMethod, pEnv, mhToCall, mid, arguments)));\n+    NSK_JNI_VERIFY(pEnv, NULL != (result = pEnv->CallObjectMethod(mhToCall, mid, arguments)));\n","filename":"test\/hotspot\/jtreg\/vmTestbase\/vm\/mlvm\/meth\/stress\/jni\/nativeAndMH\/nativeAndMH.cpp","additions":11,"deletions":13,"binary":false,"changes":24,"status":"modified"},{"patch":"@@ -39,1 +39,1 @@\n-    if ( ! NSK_VERIFY((pStr = NSK_CPP_STUB3(GetStringUTFChars, pEnv, src, NULL)) != NULL) ) {\n+    if ( ! NSK_VERIFY((pStr = pEnv->GetStringUTFChars(src, NULL)) != NULL) ) {\n@@ -43,1 +43,1 @@\n-    len = NSK_CPP_STUB2(GetStringUTFLength, pEnv, src) + 1;\n+    len = pEnv->GetStringUTFLength(src) + 1;\n@@ -47,1 +47,1 @@\n-    NSK_CPP_STUB3(ReleaseStringUTFChars, pEnv, src, pStr);\n+    pEnv->ReleaseStringUTFChars(src, pStr);\n@@ -56,1 +56,1 @@\n-    if ( ! NSK_JVMTI_VERIFY(NSK_CPP_STUB5(GetMethodName, pJvmtiEnv, method, &szName, NULL, NULL)) ) {\n+    if ( ! NSK_JVMTI_VERIFY(pJvmtiEnv->GetMethodName(method, &szName, NULL, NULL)) ) {\n@@ -60,2 +60,2 @@\n-    if ( ! NSK_JVMTI_VERIFY(NSK_CPP_STUB3(GetMethodDeclaringClass, pJvmtiEnv, method, &clazz)) ) {\n-        NSK_JVMTI_VERIFY(NSK_CPP_STUB2(Deallocate, pJvmtiEnv, (unsigned char*) szName));\n+    if ( ! NSK_JVMTI_VERIFY(pJvmtiEnv->GetMethodDeclaringClass(method, &clazz)) ) {\n+        NSK_JVMTI_VERIFY(pJvmtiEnv->Deallocate((unsigned char*) szName));\n@@ -65,2 +65,2 @@\n-    if ( ! NSK_JVMTI_VERIFY(NSK_CPP_STUB4(GetClassSignature, pJvmtiEnv, clazz, &szSignature, NULL)) ) {\n-        NSK_JVMTI_VERIFY(NSK_CPP_STUB2(Deallocate, pJvmtiEnv, (unsigned char*) szName));\n+    if ( ! NSK_JVMTI_VERIFY(pJvmtiEnv->GetClassSignature(clazz, &szSignature, NULL)) ) {\n+        NSK_JVMTI_VERIFY(pJvmtiEnv->Deallocate((unsigned char*) szName));\n@@ -78,2 +78,2 @@\n-    NSK_JVMTI_VERIFY(NSK_CPP_STUB2(Deallocate, pJvmtiEnv, (unsigned char*) szName));\n-    NSK_JVMTI_VERIFY(NSK_CPP_STUB2(Deallocate, pJvmtiEnv, (unsigned char*) szSignature));\n+    NSK_JVMTI_VERIFY(pJvmtiEnv->Deallocate((unsigned char*) szName));\n+    NSK_JVMTI_VERIFY(pJvmtiEnv->Deallocate((unsigned char*) szSignature));\n@@ -114,1 +114,1 @@\n-    if ( ! NSK_JVMTI_VERIFY(NSK_CPP_STUB3(GetThreadLocalStorage, pJvmtiEnv, thread, &tls)) )\n+    if ( ! NSK_JVMTI_VERIFY(pJvmtiEnv->GetThreadLocalStorage(thread, &tls)) )\n@@ -123,1 +123,1 @@\n-        if ( ! NSK_JVMTI_VERIFY(NSK_CPP_STUB3(SetThreadLocalStorage, pJvmtiEnv, thread, tls)) )\n+        if ( ! NSK_JVMTI_VERIFY(pJvmtiEnv->SetThreadLocalStorage(thread, tls)) )\n","filename":"test\/hotspot\/jtreg\/vmTestbase\/vm\/mlvm\/share\/mlvmJvmtiUtils.cpp","additions":12,"deletions":12,"binary":false,"changes":24,"status":"modified"},{"patch":"@@ -59,1 +59,1 @@\n-            (classDef.class_byte_count = \/* jsize *\/ NSK_CPP_STUB2(GetArrayLength, env, bytecodeArray)) > 0)) {\n+            (classDef.class_byte_count = \/* jsize *\/ env->GetArrayLength(bytecodeArray)) > 0)) {\n@@ -64,1 +64,1 @@\n-            (classDef.class_bytes = (const unsigned char *) \/* jbyte* *\/ NSK_CPP_STUB3(GetByteArrayElements, env, bytecodeArray, NULL)) != NULL)) {\n+            (classDef.class_bytes = (const unsigned char *) \/* jbyte* *\/ env->GetByteArrayElements(bytecodeArray, NULL)) != NULL)) {\n@@ -69,1 +69,1 @@\n-            NSK_CPP_STUB3(RedefineClasses, test_jvmti, 1, &classDef))) {\n+            test_jvmti->RedefineClasses(1, &classDef))) {\n@@ -75,1 +75,1 @@\n-            NSK_CPP_STUB4(ReleaseByteArrayElements, env, bytecodeArray, (jbyte*)classDef.class_bytes, JNI_ABORT))) {\n+            env->ReleaseByteArrayElements(bytecodeArray, (jbyte*)classDef.class_bytes, JNI_ABORT))) {\n@@ -94,2 +94,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(AddCapabilities,\n-            test_jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(test_jvmti->AddCapabilities(&caps)))\n@@ -98,2 +97,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(GetCapabilities,\n-            test_jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(test_jvmti->GetCapabilities(&caps)))\n","filename":"test\/hotspot\/jtreg\/vmTestbase\/vm\/runtime\/defmeth\/shared\/redefineClasses.cpp","additions":6,"deletions":8,"binary":false,"changes":14,"status":"modified"}]}