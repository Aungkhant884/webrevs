{"files":[{"patch":"@@ -27,0 +27,1 @@\n+ * @library \/test\/lib\n@@ -40,0 +41,1 @@\n+import jdk.test.lib.net.URIBuilder;\n@@ -66,1 +68,7 @@\n-            URL url = new URL (\"http:\/\/127.0.0.1:\"+p1+\"\/test1\/smallfile.txt\");\n+            URL url = URIBuilder.newBuilder()\n+                .scheme(\"http\")\n+                .loopback()\n+                .port(p1)\n+                .path(\"\/test1\/smallfile.txt\")\n+                .toURLUnchecked();\n+            System.out.println(\"URL: \" + url);\n@@ -72,1 +80,7 @@\n-            url = new URL (\"http:\/\/127.0.0.1:\"+p1+\"\/test1\/doesntexist.txt\");\n+            url = URIBuilder.newBuilder()\n+                .scheme(\"http\")\n+                .loopback()\n+                .port(p1)\n+                .path(\"\/test1\/doesntexist.txt\")\n+                .toURLUnchecked();\n+            System.out.println(\"URL: \" + url);\n","filename":"test\/jdk\/com\/sun\/net\/httpserver\/TestLogging.java","additions":16,"deletions":2,"binary":false,"changes":18,"status":"modified"},{"patch":"@@ -27,0 +27,1 @@\n+ * @library \/test\/lib\n@@ -39,0 +40,2 @@\n+import jdk.test.lib.net.URIBuilder;\n+\n@@ -79,1 +82,7 @@\n-            url = new URL (\"http:\/\/127.0.0.1:\"+port+\"\/foo\");\n+            url = URIBuilder.newBuilder()\n+                .scheme(\"http\")\n+                .loopback()\n+                .port(port)\n+                .path(\"\/foo\")\n+                .toURLUnchecked();\n+            System.out.println(\"URL: \" + url);\n","filename":"test\/jdk\/com\/sun\/net\/httpserver\/bugs\/6725892\/Test.java","additions":10,"deletions":1,"binary":false,"changes":11,"status":"modified"},{"patch":"@@ -27,0 +27,1 @@\n+ * @library \/test\/lib\n@@ -35,0 +36,1 @@\n+import jdk.test.lib.net.URIBuilder;\n@@ -99,1 +101,7 @@\n-                URL url = new URL(\"http:\/\/127.0.0.1:\"+port+\"\/test\");\n+                URL url = URIBuilder.newBuilder()\n+                    .scheme(\"http\")\n+                    .loopback()\n+                    .port(port)\n+                    .path(\"\/test\")\n+                    .toURLUnchecked();\n+                System.out.println(\"URL: \" + url);\n","filename":"test\/jdk\/com\/sun\/net\/httpserver\/bugs\/B6373555.java","additions":9,"deletions":1,"binary":false,"changes":10,"status":"modified"},{"patch":"@@ -26,0 +26,1 @@\n+ * @library \/test\/lib\n@@ -34,0 +35,1 @@\n+import java.net.InetAddress;\n@@ -37,0 +39,2 @@\n+import jdk.test.lib.net.URIBuilder;\n+\n@@ -93,1 +97,8 @@\n-                                HttpURLConnection connection = getHttpURLConnection(new URL(\"http:\/\/127.0.0.1:\"+port+\"\/server\/\"), 10000);\n+                                URL url = URIBuilder.newBuilder()\n+                                    .scheme(\"http\")\n+                                    .loopback()\n+                                    .port(port)\n+                                    .path(\"\/server\/\")\n+                                    .toURLUnchecked();\n+                                System.out.println(\"URL: \" + url);\n+                                HttpURLConnection connection = getHttpURLConnection(url, 10000);\n","filename":"test\/jdk\/com\/sun\/net\/httpserver\/bugs\/B6401598.java","additions":12,"deletions":1,"binary":false,"changes":13,"status":"modified"},{"patch":"@@ -27,0 +27,1 @@\n+ * @library \/test\/lib\n@@ -33,0 +34,1 @@\n+import jdk.test.lib.net.URIBuilder;\n@@ -84,1 +86,7 @@\n-            cm.put(new URI(\"http:\/\/127.0.0.1\/\"), header);\n+            URI uri = URIBuilder.newBuilder()\n+                .scheme(\"http\")\n+                .loopback()\n+                .path(\"\/\")\n+                .buildUnchecked();\n+            System.out.println(\"URI: \" + uri);\n+            cm.put(uri, header);\n","filename":"test\/jdk\/java\/net\/HttpCookie\/ExpiredCookieTest.java","additions":9,"deletions":1,"binary":false,"changes":10,"status":"modified"},{"patch":"@@ -27,0 +27,1 @@\n+ * @library \/test\/lib\n@@ -32,0 +33,1 @@\n+import java.net.InetAddress;\n@@ -40,0 +42,1 @@\n+import jdk.test.lib.net.URIBuilder;\n@@ -55,1 +58,6 @@\n-        URL url = URI.create(\"http:\/\/127.0.0.1\/\").toURL();\n+        URL url = URIBuilder.newBuilder()\n+            .scheme(\"http\")\n+            .loopback()\n+            .path(\"\/\")\n+            .toURLUnchecked();\n+        System.out.println(\"URL: \" + url);\n","filename":"test\/jdk\/java\/net\/HttpURLConnection\/NoProxyTest.java","additions":9,"deletions":1,"binary":false,"changes":10,"status":"modified"},{"patch":"@@ -26,0 +26,1 @@\n+ * @library \/test\/lib\n@@ -31,0 +32,1 @@\n+import jdk.test.lib.net.URIBuilder;\n@@ -34,1 +36,6 @@\n-        URL url = new URL(\"http:\/\/127.0.0.1\/\");\n+        URL url = URIBuilder.newBuilder()\n+            .scheme(\"http\")\n+            .loopback()\n+            .path(\"\/\")\n+            .toURLUnchecked();\n+        System.out.println(\"URL: \" + url);\n","filename":"test\/jdk\/java\/net\/ProxySelector\/NullSelector.java","additions":8,"deletions":1,"binary":false,"changes":9,"status":"modified"},{"patch":"@@ -27,0 +27,1 @@\n+ * @library \/test\/lib\n@@ -41,0 +42,1 @@\n+import jdk.test.lib.net.URIBuilder;\n@@ -66,1 +68,1 @@\n-    static String urlstring, redirstring;\n+    static URL url, redir;\n@@ -81,2 +83,14 @@\n-        urlstring = \"http:\/\/127.0.0.1:\" + Integer.toString(port)+\"\/test\/foo\";\n-        redirstring = urlstring + \"\/redirect\/bar\";\n+        url = URIBuilder.newBuilder()\n+            .scheme(\"http\")\n+            .loopback()\n+            .port(port)\n+            .path(\"\/test\/foo\")\n+            .toURLUnchecked();\n+        System.out.println(\"URL: \" + url);\n+        redir = URIBuilder.newBuilder()\n+            .scheme(\"http\")\n+            .loopback()\n+            .port(port)\n+            .path(\"\/test\/foo\/redirect\/bar\")\n+            .toURLUnchecked();\n+        System.out.println(\"Redir URL: \" + redir);\n@@ -84,1 +98,0 @@\n-        URL url = new URL (urlstring);\n@@ -117,1 +130,1 @@\n-                rmap.add(\"Location\", redirstring);\n+                rmap.add(\"Location\", redir.toString());\n","filename":"test\/jdk\/java\/net\/ResponseCache\/Test2.java","additions":18,"deletions":5,"binary":false,"changes":23,"status":"modified"},{"patch":"@@ -53,0 +53,1 @@\n+import jdk.test.lib.net.URIBuilder;\n@@ -161,2 +162,6 @@\n-        String s = \"http:\/\/127.0.0.1:\" + port + \"\/\";\n-        return new URL(s);\n+        return URIBuilder.newBuilder()\n+            .scheme(\"http\")\n+            .loopback()\n+            .port(port)\n+            .path(\"\/\")\n+            .toURL();\n","filename":"test\/jdk\/java\/net\/URLClassLoader\/closetest\/CloseTest.java","additions":7,"deletions":2,"binary":false,"changes":9,"status":"modified"},{"patch":"@@ -27,0 +27,1 @@\n+ * @library \/test\/lib\n@@ -33,0 +34,1 @@\n+import jdk.test.lib.net.URIBuilder;\n@@ -71,1 +73,6 @@\n-            URL url = new URL (\"http:\/\/127.0.0.1:\"+ss.getLocalPort());\n+            URL url = URIBuilder.newBuilder()\n+                .scheme(\"http\")\n+                .loopback()\n+                .port(ss.getLocalPort())\n+                .toURL();\n+            System.out.println(\"URL: \" + url);\n","filename":"test\/jdk\/java\/net\/URLConnection\/TimeoutTest.java","additions":8,"deletions":1,"binary":false,"changes":9,"status":"modified"},{"patch":"@@ -27,0 +27,1 @@\n+ * @library \/test\/lib\n@@ -32,0 +33,1 @@\n+import jdk.test.lib.net.URIBuilder;\n@@ -40,1 +42,7 @@\n-            URL url = new URL (\"http:\/\/joe@127.0.0.1\/a\/b\");\n+            URL url = URIBuilder.newBuilder()\n+                .scheme(\"http\")\n+                .userInfo(\"joe\")\n+                .loopback()\n+                .path(\"\/a\/b\")\n+                .toURL();\n+            System.out.println(\"URL: \" + url);\n","filename":"test\/jdk\/java\/net\/URLPermission\/OpenURL.java","additions":9,"deletions":1,"binary":false,"changes":10,"status":"modified"},{"patch":"@@ -42,0 +42,1 @@\n+import jdk.test.lib.net.URIBuilder;\n@@ -46,0 +47,1 @@\n+ * @library \/test\/lib\n@@ -63,1 +65,7 @@\n-        URI uri = URI.create(\"http:\/\/127.0.0.1:\" + Integer.toString(port) + \"\/foo\");\n+        URI uri = URIBuilder.newBuilder()\n+            .scheme(\"http\")\n+            .loopback()\n+            .port(port)\n+            .path(\"\/foo\")\n+            .buildUnchecked();\n+        System.out.println(\"URI: \" + uri);\n","filename":"test\/jdk\/java\/net\/httpclient\/LargeResponseContent.java","additions":9,"deletions":1,"binary":false,"changes":10,"status":"modified"},{"patch":"@@ -26,0 +26,1 @@\n+ * @library \/test\/lib\n@@ -29,0 +30,1 @@\n+\n@@ -31,0 +33,1 @@\n+import jdk.test.lib.net.URIBuilder;\n@@ -34,1 +37,1 @@\n-        String url;\n+        URL url;\n@@ -36,1 +39,1 @@\n-        Fetcher(String url) {\n+        Fetcher(URL url) {\n@@ -42,2 +45,1 @@\n-                InputStream in =\n-                    (new URL(url)).openConnection().getInputStream();\n+                InputStream in = url.openConnection().getInputStream();\n@@ -108,1 +110,6 @@\n-        String url = \"http:\/\/127.0.0.1:\"+ss.getLocalPort();\n+        URL url = URIBuilder.newBuilder()\n+            .scheme(\"http\")\n+            .loopback()\n+            .port(ss.getLocalPort())\n+            .toURL();\n+        System.out.println(\"URL: \" + url);\n","filename":"test\/jdk\/sun\/net\/www\/http\/KeepAliveCache\/KeepAliveTimerThread.java","additions":12,"deletions":5,"binary":false,"changes":17,"status":"modified"},{"patch":"@@ -27,0 +27,1 @@\n+ * @library \/test\/lib\n@@ -36,0 +37,2 @@\n+import jdk.test.lib.net.URIBuilder;\n+\n@@ -61,1 +64,7 @@\n-        URL u = new URL(\"http:\/\/127.0.0.1:\"+s.getAddress().getPort()+\"\/f\");\n+        URL u = URIBuilder.newBuilder()\n+            .scheme(\"http\")\n+            .loopback()\n+            .port(s.getAddress().getPort())\n+            .path(\"\/f\")\n+            .toURL();\n+        System.out.println(\"URL: \" + u);\n","filename":"test\/jdk\/sun\/net\/www\/protocol\/http\/6550798\/test.java","additions":10,"deletions":1,"binary":false,"changes":11,"status":"modified"},{"patch":"@@ -42,1 +42,5 @@\n-            URL u = new URL (\"http:\/\/127.0.0.1:\"+port+\"\/foo\\nbar\");\n+            URL u = new URL(\"http\",\n+                InetAddress.getLoopbackAddress().getHostAddress(),\n+                port,\n+                \"\/foo\\nbar\");\n+            System.out.println(\"URL: \" + u);\n","filename":"test\/jdk\/sun\/net\/www\/protocol\/http\/B6890349.java","additions":5,"deletions":1,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -27,0 +27,1 @@\n+ * @library \/test\/lib\n@@ -37,0 +38,3 @@\n+\n+import jdk.test.lib.net.URIBuilder;\n+\n@@ -47,2 +51,7 @@\n-        String u = \"http:\/\/127.0.0.1:\" + port + \"\/foo\";\n-        URL url = new URL(u);\n+        URL url = URIBuilder.newBuilder()\n+            .scheme(\"http\")\n+            .loopback()\n+            .port(port)\n+            .path(\"\/foo\")\n+            .toURL();\n+        System.out.println(\"URL: \" + url);\n","filename":"test\/jdk\/sun\/net\/www\/protocol\/http\/B8012625.java","additions":11,"deletions":2,"binary":false,"changes":13,"status":"modified"},{"patch":"@@ -26,0 +26,1 @@\n+ * @library \/test\/lib\n@@ -37,0 +38,1 @@\n+import java.net.InetAddress;\n@@ -42,0 +44,1 @@\n+import jdk.test.lib.net.URIBuilder;\n@@ -60,1 +63,7 @@\n-            this.url = new URL(\"http:\/\/127.0.0.1:\" + port + \"\/foo.html\");\n+            this.url = URIBuilder.newBuilder()\n+                .scheme(\"http\")\n+                .loopback()\n+                .port(port)\n+                .path(\"\/foo.html\")\n+                .toURLUnchecked();\n+            System.out.println(\"Client URL: \" + this.url);\n","filename":"test\/jdk\/sun\/net\/www\/protocol\/http\/NoNTLM.java","additions":10,"deletions":1,"binary":false,"changes":11,"status":"modified"},{"patch":"@@ -42,0 +42,1 @@\n+import jdk.test.lib.net.URIBuilder;\n@@ -58,2 +59,2 @@\n-            runTest(\"http:\/\/127.0.0.1:\"+port+\"\/test\/\", null);\n-            runTest(\"https:\/\/127.0.0.1:\"+sslPort+\"\/test\/\", ctx);\n+            runTest(\"http\", port, null);\n+            runTest(\"https\", sslPort, ctx);\n@@ -68,1 +69,1 @@\n-    public static void runTest(String baseURL, SSLContext ctx) throws Exception\n+    public static void runTest(String scheme, int port, SSLContext ctx) throws Exception\n@@ -71,1 +72,8 @@\n-        URL url = new URL(baseURL + \"a\");\n+\n+        URL url = URIBuilder.newBuilder()\n+            .scheme(scheme)\n+            .loopback()\n+            .port(port)\n+            .path(\"\/test\/a\")\n+            .toURL();\n+        System.out.println(\"URL: \" + url);\n@@ -110,1 +118,2 @@\n-        String baseURL;\n+        String scheme;\n+        int port;\n@@ -112,2 +121,3 @@\n-        Handler(String baseURL) {\n-            this.baseURL = baseURL;\n+        Handler(String scheme, int port) {\n+          this.scheme = scheme;\n+          this.port = port;\n@@ -121,0 +131,6 @@\n+                URL baseURL = URIBuilder.newBuilder()\n+                    .scheme(scheme)\n+                    .loopback()\n+                    .path(\"\/test\/b\")\n+                    .port(port)\n+                    .toURLUnchecked();\n@@ -128,1 +144,1 @@\n-                    h.add(\"Location\", baseURL + \"b\");\n+                    h.add(\"Location\", baseURL.toString());\n@@ -156,1 +172,1 @@\n-        String base = \"http:\/\/127.0.0.1:\"+port+\"\/test\";\n+\n@@ -158,1 +174,1 @@\n-        context.setHandler(new Handler(base));\n+        context.setHandler(new Handler(\"http\", port));\n@@ -172,1 +188,1 @@\n-        String base = \"https:\/\/127.0.0.1:\"+port+\"\/test\";\n+\n@@ -174,1 +190,1 @@\n-        context.setHandler(new Handler(base));\n+        context.setHandler(new Handler(\"https\", port));\n","filename":"test\/jdk\/sun\/net\/www\/protocol\/http\/RedirectOnPost.java","additions":28,"deletions":12,"binary":false,"changes":40,"status":"modified"},{"patch":"@@ -27,0 +27,1 @@\n+ * @library \/test\/lib\n@@ -37,0 +38,1 @@\n+import jdk.test.lib.net.URIBuilder;\n@@ -103,1 +105,6 @@\n-            URL url = new URL (\"http:\/\/127.0.0.1:\"+server.getLocalPort()+\"\/\");\n+            URL url = URIBuilder.newBuilder()\n+                .scheme(\"http\")\n+                .loopback()\n+                .port(server.getLocalPort())\n+                .path(\"\/\")\n+                .toURL();\n","filename":"test\/jdk\/sun\/net\/www\/protocol\/http\/ResponseCacheStream.java","additions":8,"deletions":1,"binary":false,"changes":9,"status":"modified"},{"patch":"@@ -27,0 +27,1 @@\n+ * @library \/test\/lib\n@@ -33,0 +34,1 @@\n+import jdk.test.lib.net.URIBuilder;\n@@ -66,1 +68,6 @@\n-            URL url = new URL(\"http:\/\/127.0.0.1:\"+port);\n+            URL url = URIBuilder.newBuilder()\n+                .scheme(\"http\")\n+                .loopback()\n+                .port(port)\n+                .toURL();\n+            System.out.println(\"URL: \" + url);\n","filename":"test\/jdk\/sun\/net\/www\/protocol\/http\/RetryUponTimeout.java","additions":8,"deletions":1,"binary":false,"changes":9,"status":"modified"},{"patch":"@@ -29,0 +29,1 @@\n+ * @library \/test\/lib\n@@ -36,0 +37,1 @@\n+import jdk.test.lib.net.URIBuilder;\n@@ -70,1 +72,6 @@\n-            URL url = new URL (\"http:\/\/127.0.0.1:\"+server.getLocalPort()+\"\/\");\n+            URL url = URIBuilder.newBuilder()\n+                .scheme(\"http\")\n+                .loopback()\n+                .port(server.getLocalPort())\n+                .path(\"\/\")\n+                .toURL();\n","filename":"test\/jdk\/sun\/net\/www\/protocol\/http\/SetChunkedStreamingMode.java","additions":8,"deletions":1,"binary":false,"changes":9,"status":"modified"},{"patch":"@@ -27,0 +27,1 @@\n+ * @library \/test\/lib\n@@ -35,0 +36,1 @@\n+import jdk.test.lib.net.URIBuilder;\n@@ -92,1 +94,6 @@\n-        URL url = new URL (\"http:\/\/127.0.0.1:\"+port);\n+        URL url = URIBuilder.newBuilder()\n+            .scheme(\"http\")\n+            .loopback()\n+            .port(port)\n+            .toURL();\n+        System.out.println(\"URL: \" + url);\n","filename":"test\/jdk\/sun\/net\/www\/protocol\/http\/UserAgent.java","additions":8,"deletions":1,"binary":false,"changes":9,"status":"modified"},{"patch":"@@ -26,0 +26,1 @@\n+ * @library \/test\/lib\n@@ -45,0 +46,1 @@\n+import jdk.test.lib.net.URIBuilder;\n@@ -713,1 +715,6 @@\n-            URL url = new URL(\"https:\/\/127.0.0.1:\" + serverPort+\"\/\");\n+            URL url = URIBuilder.newBuilder()\n+                .scheme(\"https\")\n+                .loopback()\n+                .port(serverPort)\n+                .path(\"\/\")\n+                .toURL();\n","filename":"test\/jdk\/sun\/net\/www\/protocol\/https\/HttpsURLConnection\/IPAddressDNSIdentities.java","additions":8,"deletions":1,"binary":false,"changes":9,"status":"modified"},{"patch":"@@ -31,0 +31,1 @@\n+ * @library \/test\/lib\n@@ -48,0 +49,1 @@\n+import jdk.test.lib.net.URIBuilder;\n@@ -717,1 +719,6 @@\n-            URL url = new URL(\"https:\/\/127.0.0.1:\" + serverPort+\"\/\");\n+            URL url = URIBuilder.newBuilder()\n+                .scheme(\"https\")\n+                .loopback()\n+                .port(serverPort)\n+                .path(\"\/\")\n+                .toURL();\n","filename":"test\/jdk\/sun\/net\/www\/protocol\/https\/HttpsURLConnection\/IPAddressIPIdentities.java","additions":8,"deletions":1,"binary":false,"changes":9,"status":"modified"}]}