{"files":[{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2014, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2014, 2020, Oracle and\/or its affiliates. All rights reserved.\n@@ -31,1 +31,20 @@\n-class AbstractMethodErrorTest {\n+\/*\n+ * @test\n+ * @bug 8035437\n+ * @summary Verifies that java.lang.AbstractMethodError is not thrown when\n+ *          serializing improper version of DocumentImpl class as reported in XERCESJ-1007.\n+ *          Test preconditions and steps:\n+ *          - Compiles test version of org.w3c.dom.Node and org.w3c.dom.Document\n+ *          - Compiles DocumentImpl overriding java.xml module with Node and Document\n+ *          - Runs AbstractMethodErrorTest overriding java.xml only with DocumentImpl class\n+ *            Hence, the interfaces compiled in the first step need to be removed\n+ *            from the test folder in order to reproduce the bug scenario. At the time of writing,\n+ *            the clean command was not able to resolve paths generated by compile\/module\n+ * @library \/test\/lib\n+ * @compile --patch-module java.xml=${test.src} org\/w3c\/dom\/Document.java\n+ * org\/w3c\/dom\/Node.java com\/sun\/org\/apache\/xerces\/internal\/dom\/DocumentImpl.java\n+ * @clean org.w3c.dom.*\n+ * @run main\/othervm --patch-module java.xml=${test.class.path} AbstractMethodErrorTest\n+ *\/\n+\n+public class AbstractMethodErrorTest {\n@@ -42,5 +61,1 @@\n-        \/* We should have here incorrect document without getXmlVersion() method:\n-         * Such Document is generated by replacing the JDK bootclasses with it's\n-         * own Node,Document and DocumentImpl classes (see run.sh). According to\n-         * XERCESJ-1007 the AbstractMethodError should be thrown in such case.\n-         *\/\n+        \/\/ We should have here incorrect document without getXmlVersion() method\n","filename":"test\/jdk\/javax\/xml\/jaxp\/common\/8035437\/AbstractMethodErrorTest.java","additions":22,"deletions":7,"binary":false,"changes":29,"status":"modified"},{"patch":"","filename":"test\/jdk\/javax\/xml\/jaxp\/common\/8035437\/com\/sun\/org\/apache\/xerces\/internal\/dom\/DocumentImpl.java","additions":0,"deletions":0,"binary":false,"changes":0,"previous_filename":"test\/jdk\/javax\/xml\/jaxp\/common\/8035437\/patch-src2\/com\/sun\/org\/apache\/xerces\/internal\/dom\/DocumentImpl.java","status":"renamed"},{"patch":"","filename":"test\/jdk\/javax\/xml\/jaxp\/common\/8035437\/org\/w3c\/dom\/Document.java","additions":0,"deletions":0,"binary":false,"changes":0,"previous_filename":"test\/jdk\/javax\/xml\/jaxp\/common\/8035437\/patch-src1\/org\/w3c\/dom\/Document.java","status":"renamed"},{"patch":"","filename":"test\/jdk\/javax\/xml\/jaxp\/common\/8035437\/org\/w3c\/dom\/Node.java","additions":0,"deletions":0,"binary":false,"changes":0,"previous_filename":"test\/jdk\/javax\/xml\/jaxp\/common\/8035437\/patch-src1\/org\/w3c\/dom\/Node.java","status":"renamed"},{"patch":"@@ -1,75 +0,0 @@\n-#!\/bin\/sh\n-\n-##\n-# Copyright (c) 2014, Oracle and\/or its affiliates. All rights reserved.\n-# DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n-#\n-# This code is free software; you can redistribute it and\/or modify it\n-# under the terms of the GNU General Public License version 2 only, as\n-# published by the Free Software Foundation.\n-#\n-# This code is distributed in the hope that it will be useful, but WITHOUT\n-# ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n-# FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n-# version 2 for more details (a copy is included in the LICENSE file that\n-# accompanied this code).\n-#\n-# You should have received a copy of the GNU General Public License version\n-# 2 along with this work; if not, write to the Free Software Foundation,\n-# Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n-#\n-# Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n-# or visit www.oracle.com if you need additional information or have any\n-# questions.\n-##\n-\n-# @test\n-# @bug 8035437\n-# @summary Tests that java.lang.AbstractMethodError is not thrown when\n-#    serializing improper version of DocumentImpl class.\n-\n-OS=`uname -s`\n-case \"$OS\" in\n-  SunOS )\n-    PS=\":\"\n-    ;;\n-  Linux )\n-    PS=\":\"\n-    ;;\n-  Darwin )\n-    PS=\":\"\n-    ;;\n-  AIX )\n-    PS=\":\"\n-    ;;\n-  Windows*)\n-    PS=\";\"\n-    ;;\n-  CYGWIN*)\n-    PS=\";\"\n-    ;;\n-  * )\n-    echo \"Unrecognized system!\"\n-    exit 1;\n-    ;;\n-esac\n-\n-mkdir -p exec\/java.xml compile\/java.xml\n-\n-$COMPILEJAVA\/bin\/javac ${TESTJAVACOPTS} ${TESTTOOLVMOPTS} \\\n-   -d compile\/java.xml --patch-module java.xml=$TESTSRC\/patch-src1 \\\n-   $TESTSRC\/patch-src1\/org\/w3c\/dom\/Document.java \\\n-   $TESTSRC\/patch-src1\/org\/w3c\/dom\/Node.java || exit 1\n-\n-$COMPILEJAVA\/bin\/javac ${TESTJAVACOPTS} ${TESTTOOLVMOPTS} \\\n-   -d exec\/java.xml --patch-module java.xml=compile\/java.xml${PS}$TESTSRC\/patch-src2 \\\n-   $TESTSRC\/patch-src2\/com\/sun\/org\/apache\/xerces\/internal\/dom\/DocumentImpl.java \\\n-   || exit 2\n-\n-$COMPILEJAVA\/bin\/javac ${TESTJAVACOPTS} ${TESTTOOLVMOPTS} \\\n-   $TESTSRC\/AbstractMethodErrorTest.java -d exec || exit 3\n-\n-$TESTJAVA\/bin\/java ${TESTVMOPTS} --patch-module java.xml=exec -cp exec AbstractMethodErrorTest || exit 4\n-\n-exit 0\n-\n","filename":"test\/jdk\/javax\/xml\/jaxp\/common\/8035437\/run.sh","additions":0,"deletions":75,"binary":false,"changes":75,"status":"deleted"}]}