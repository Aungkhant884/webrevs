{"files":[{"patch":"@@ -28,0 +28,4 @@\n+import java.awt.GraphicsConfiguration;\n+import java.awt.GraphicsDevice;\n+import java.awt.GraphicsEnvironment;\n+import java.awt.Point;\n@@ -32,0 +36,1 @@\n+import java.io.File;\n@@ -34,0 +39,1 @@\n+import javax.imageio.ImageIO;\n@@ -106,1 +112,2 @@\n-                return popupMenu.getBounds();\n+                return new Rectangle(popupMenu.getLocationOnScreen(),\n+                        popupMenu.getSize());\n@@ -111,0 +118,1 @@\n+        BufferedImage redFrame = robot.createScreenCapture(frame.getBounds());\n@@ -116,0 +124,1 @@\n+                lowerFrame.invalidate();\n@@ -120,0 +129,1 @@\n+        robot.delay(1000); \/\/ Give frame time to repaint\n@@ -122,0 +132,1 @@\n+        BufferedImage greenFrame = robot.createScreenCapture(frame.getBounds());\n@@ -124,0 +135,27 @@\n+            try {\n+                GraphicsDevice[] devices = GraphicsEnvironment.getLocalGraphicsEnvironment().getScreenDevices();\n+                for (int i = 0; i < devices.length; i++) {\n+                    GraphicsConfiguration[] screens = devices[i].getConfigurations();\n+                    for (int j = 0; j < screens.length; j++) {\n+                        BufferedImage fullScreen = robot.createScreenCapture(screens[j].getBounds());\n+                        if (screens[j].getBounds().intersects(popupRectangle)) {\n+                            Graphics g = fullScreen.getGraphics();\n+                            g.setColor(Color.CYAN);\n+                            g.drawRect(popupRectangle.x - 1, popupRectangle.y - 1,\n+                                    popupRectangle.width + 2, popupRectangle.height + 2);\n+                            g.dispose();\n+                        }\n+                        ImageIO.write(fullScreen, \"png\", new File(\"dev\" + i + \"scr\" + j + \".png\"));\n+                    }\n+                }\n+                ImageIO.write(redFrame, \"png\", new File(\"redframe.png\"));\n+                ImageIO.write(redBackgroundCapture, \"png\", new File(\"redbg.png\"));\n+                ImageIO.write(greenFrame, \"png\", new File(\"greenframe.png\"));\n+                ImageIO.write(greenBackgroundCapture, \"png\", new File(\"greenbg.png\"));\n+            } finally {\n+                SwingUtilities.invokeAndWait(() -> {\n+                    frame.dispose();\n+                    lowerFrame.dispose();\n+                });\n+            }\n+            robot.waitForIdle();\n@@ -151,1 +189,0 @@\n-        result.setLocation(0, 0);\n@@ -153,0 +190,1 @@\n+        result.setLocationRelativeTo(null);\n","filename":"test\/jdk\/javax\/swing\/JPopupMenu\/7156657\/bug7156657.java","additions":40,"deletions":2,"binary":false,"changes":42,"status":"modified"}]}