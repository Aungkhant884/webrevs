{"files":[{"patch":"@@ -32,1 +32,1 @@\n-            NSK_CPP_STUB2(GetObjectClass, env, _obj)) != NULL))\\\n+            env->GetObjectClass(_obj)) != NULL))\\\n@@ -37,2 +37,1 @@\n-    if (!NSK_JNI_VERIFY_VOID(env, NSK_CPP_STUB3(CallStaticVoidMethod, env,\\\n-                            _class, method)))\\\n+    if (!NSK_JNI_VERIFY_VOID(env, env->CallStaticVoidMethod(_class, method)))\\\n@@ -43,2 +42,1 @@\n-            NSK_CPP_STUB4(GetStaticMethodID, env, _class,\\\n-                _methodName, _sig)) != NULL))\\\n+            env->GetStaticMethodID(_class, _methodName, _sig)) != NULL))\\\n@@ -49,2 +47,1 @@\n-            NSK_CPP_STUB4(GetMethodID, env, _class,\\\n-                _methodName, _sig)) != NULL))\\\n+            env->GetMethodID(_class, _methodName, _sig)) != NULL))\\\n@@ -55,2 +52,1 @@\n-    if (!NSK_JNI_VERIFY_VOID(env, NSK_CPP_STUB3(CallVoidMethod, env, _obj,\\\n-                                                    method)))\\\n+    if (!NSK_JNI_VERIFY_VOID(env, env->CallVoidMethod(_obj, method)))\\\n@@ -74,3 +70,1 @@\n-                                     NSK_CPP_STUB5(CallIntMethod, env, obj,\n-                                                   method, maxDepth,\n-                                                   currentDepth))) {\n+                                     env->CallIntMethod(obj, method, maxDepth, currentDepth))) {\n@@ -82,4 +76,1 @@\n-                                     NSK_CPP_STUB6(CallIntMethod, env, obj,\n-                                                   method, maxDepth,\n-                                                   currentDepth,\n-                                                   returnToJava))) {\n+                                     env->CallIntMethod(obj, method, maxDepth, currentDepth, returnToJava))) {\n","filename":"test\/hotspot\/jtreg\/vmTestbase\/nsk\/monitoring\/share\/StackTraceController.cpp","additions":7,"deletions":16,"binary":false,"changes":23,"status":"modified"},{"patch":"@@ -34,1 +34,1 @@\n-            NSK_CPP_STUB2(FindClass, env, _className)) != NULL))\\\n+            env->FindClass(_className)) != NULL))\\\n@@ -39,1 +39,1 @@\n-            NSK_CPP_STUB2(GetObjectClass, env, _obj)) != NULL))\\\n+            env->GetObjectClass(_obj)) != NULL))\\\n@@ -44,2 +44,1 @@\n-            NSK_CPP_STUB4(GetStaticFieldID, env, _class,\\\n-                _fieldName, _fieldSig)) != NULL))\\\n+            env->GetStaticFieldID(_class, _fieldName, _fieldSig)) != NULL))\\\n@@ -50,2 +49,1 @@\n-    _value = NSK_CPP_STUB3(GetStaticObjectField, env, _class, \\\n-                                field)\n+    _value = env->GetStaticObjectField(_class, field)\n@@ -55,1 +53,1 @@\n-    _value = NSK_CPP_STUB3(GetStaticBooleanField, env, _class, field)\n+    _value = env->GetStaticBooleanField(_class, field)\n@@ -59,2 +57,1 @@\n-            NSK_CPP_STUB4(GetFieldID, env, _class,\\\n-                _fieldName, _fieldSig)) != NULL))\\\n+            env->GetFieldID(_class, _fieldName, _fieldSig)) != NULL))\\\n@@ -65,1 +62,1 @@\n-    _value = NSK_CPP_STUB3(GetIntField, env, _obj, field)\n+    _value = env->GetIntField(_obj, field)\n@@ -69,1 +66,1 @@\n-    _value = NSK_CPP_STUB3(GetBooleanField, env, _obj, field)\n+    _value = env->GetBooleanField(_obj, field)\n@@ -73,1 +70,1 @@\n-    _value = NSK_CPP_STUB3(GetLongField, env, _obj, field)\n+    _value = env->GetLongField(_obj, field)\n@@ -77,1 +74,1 @@\n-    _value = NSK_CPP_STUB3(GetStaticIntField, env, _class, field)\n+    _value = env->GetStaticIntField(_class, field)\n@@ -81,1 +78,1 @@\n-    NSK_CPP_STUB4(SetIntField, env, _obj, field, _newValue)\n+    env->SetIntField(_obj, field, _newValue)\n@@ -85,1 +82,1 @@\n-    _value = NSK_CPP_STUB3(GetObjectField, env, _obj, field)\n+    _value = env->GetObjectField(_obj, field)\n@@ -89,1 +86,1 @@\n-    NSK_CPP_STUB3(GetObjectArrayElement, env, _arr, _index)\n+    env->GetObjectArrayElement(_arr, _index)\n@@ -92,1 +89,1 @@\n-    NSK_CPP_STUB4(SetObjectArrayElement, env, _arr, _index, _newValue)\n+    env->SetObjectArrayElement(_arr, _index, _newValue)\n@@ -96,2 +93,1 @@\n-            NSK_CPP_STUB4(GetStaticMethodID, env, _class,\\\n-                _methodName, _sig)) != NULL))\\\n+            env->GetStaticMethodID(_class, _methodName, _sig)) != NULL))\\\n@@ -102,2 +98,1 @@\n-            NSK_CPP_STUB4(GetMethodID, env, _class,\\\n-                _methodName, _sig)) != NULL))\\\n+            env->GetMethodID(_class, _methodName, _sig)) != NULL))\\\n@@ -108,2 +103,1 @@\n-    if (!NSK_JNI_VERIFY_VOID(env, NSK_CPP_STUB3(CallStaticVoidMethod, env,\\\n-                            _class, method)))\\\n+    if (!NSK_JNI_VERIFY_VOID(env, env->CallStaticVoidMethod(_class, method)))\\\n@@ -114,2 +108,1 @@\n-    if (!NSK_JNI_VERIFY_VOID(env, NSK_CPP_STUB4(CallStaticVoidMethod, env,\\\n-                                                    _class, method, _param)))\\\n+    if (!NSK_JNI_VERIFY_VOID(env, env->CallStaticVoidMethod(_class, method, _param)))\\\n@@ -120,1 +113,1 @@\n-    _value = NSK_CPP_STUB4(CallStaticObjectMethod, env, _class, method, _param)\n+    _value = env->CallStaticObjectMethod(_class, method, _param)\n@@ -124,2 +117,1 @@\n-    if (!NSK_JNI_VERIFY_VOID(env, NSK_CPP_STUB3(CallVoidMethod, env, _obj,\\\n-                                                    method)))\\\n+    if (!NSK_JNI_VERIFY_VOID(env, env->CallVoidMethod(_obj, method)))\\\n@@ -130,2 +122,1 @@\n-    if (!NSK_JNI_VERIFY_VOID(env, NSK_CPP_STUB4(CallVoidMethod, env, _obj,\\\n-                                                    method, _param)))\\\n+    if (!NSK_JNI_VERIFY_VOID(env, env->CallVoidMethod(_obj, method, _param)))\\\n@@ -136,2 +127,1 @@\n-    if (!NSK_JNI_VERIFY_VOID(env, NSK_CPP_STUB5(CallVoidMethod, env, _obj, \\\n-                                                    method, _param1, _param2)))\\\n+    if (!NSK_JNI_VERIFY_VOID(env, env->CallVoidMethod(_obj, method, _param1, _param2)))\\\n@@ -142,1 +132,1 @@\n-    _value = NSK_CPP_STUB3(CallIntMethod, env, _obj, method)\n+    _value = env->CallIntMethod(_obj, method)\n@@ -147,1 +137,1 @@\n-            NSK_CPP_STUB4(NewObject, env, _class, method, _params)) != NULL))\\\n+            env->NewObject(_class, method, _params)) != NULL))\\\n@@ -151,1 +141,1 @@\n-    NSK_JNI_VERIFY(env, NSK_CPP_STUB2(MonitorEnter, env, x) == 0)\n+    NSK_JNI_VERIFY(env, env->MonitorEnter(x) == 0)\n@@ -154,1 +144,1 @@\n-    NSK_JNI_VERIFY(env, NSK_CPP_STUB2(MonitorExit, env, x) == 0)\n+    NSK_JNI_VERIFY(env, env->MonitorExit(x) == 0)\n@@ -158,1 +148,1 @@\n-   jmsg = NSK_CPP_STUB2(NewStringUTF, env, msg);\\\n+   jmsg = env->NewStringUTF(msg);\\\n@@ -500,1 +490,1 @@\n-             NSK_CPP_STUB2(GetJavaVM, env, &vm) == 0)) {\n+             env->GetJavaVM(&vm) == 0)) {\n@@ -505,1 +495,1 @@\n-             NSK_CPP_STUB3(GetEnv, vm, (void **)&jvmti, JVMTI_VERSION_1)\n+             vm->GetEnv((void **)&jvmti, JVMTI_VERSION_1)\n@@ -511,1 +501,1 @@\n-             NSK_CPP_STUB3(GetThreadState, jvmti, (jthread)thread, &state)\n+             jvmti->GetThreadState((jthread)thread, &state)\n@@ -517,1 +507,1 @@\n-        if (!NSK_JNI_VERIFY(env, (ThreadState = NSK_CPP_STUB2(FindClass, env, \"java\/lang\/Thread$State\")) != NULL))\n+        if (!NSK_JNI_VERIFY(env, (ThreadState = env->FindClass(\"java\/lang\/Thread$State\")) != NULL))\n@@ -520,1 +510,1 @@\n-        if (!NSK_JNI_VERIFY(env, (method = NSK_CPP_STUB4(GetStaticMethodID, env, ThreadState, \"valueOf\", \"(Ljava\/lang\/String;)Ljava\/lang\/Thread$State;\")) != NULL))\n+        if (!NSK_JNI_VERIFY(env, (method = env->GetStaticMethodID(ThreadState, \"valueOf\", \"(Ljava\/lang\/String;)Ljava\/lang\/Thread$State;\")) != NULL))\n@@ -522,1 +512,1 @@\n-        threadState = NSK_CPP_STUB4(CallStaticObjectMethod, env, ThreadState, method, stateName);\n+        threadState = env->CallStaticObjectMethod(ThreadState, method, stateName);\n","filename":"test\/hotspot\/jtreg\/vmTestbase\/nsk\/monitoring\/share\/ThreadController.cpp","additions":33,"deletions":43,"binary":false,"changes":76,"status":"modified"},{"patch":"@@ -30,1 +30,1 @@\n-             NSK_CPP_STUB2(FindClass, env, _className)) != NULL))\\\n+             env->FindClass(_className)) != NULL))\\\n@@ -35,1 +35,1 @@\n-             NSK_CPP_STUB2(GetObjectClass, env, _obj)) != NULL))\\\n+             env->GetObjectClass(_obj)) != NULL))\\\n@@ -40,1 +40,1 @@\n-        _value = NSK_CPP_STUB3(GetObjectField, env, _obj, field)\n+        _value = env->GetObjectField(_obj, field)\n@@ -44,2 +44,1 @@\n-             NSK_CPP_STUB4(GetFieldID, env, _class,\\\n-             _fieldName, _fieldSig)) != NULL))\\\n+             env->GetFieldID(_class, _fieldName, _fieldSig)) != NULL))\\\n@@ -50,2 +49,1 @@\n-             NSK_CPP_STUB4(GetMethodID, env, _class,\\\n-             _methodName, _sig)) != NULL)) \\\n+             env->GetMethodID(_class, _methodName, _sig)) != NULL)) \\\n@@ -56,2 +54,1 @@\n-        if (!NSK_JNI_VERIFY_VOID(env, NSK_CPP_STUB3(CallVoidMethod, env, _obj,\\\n-             method))) \\\n+        if (!NSK_JNI_VERIFY_VOID(env, env->CallVoidMethod(_obj, method))) \\\n","filename":"test\/hotspot\/jtreg\/vmTestbase\/nsk\/monitoring\/share\/thread\/Deadlock.cpp","additions":6,"deletions":9,"binary":false,"changes":15,"status":"modified"},{"patch":"@@ -30,1 +30,1 @@\n-             NSK_CPP_STUB2(FindClass, env, _className)) != NULL))\\\n+             env->FindClass(_className)) != NULL))\\\n@@ -35,1 +35,1 @@\n-             NSK_CPP_STUB2(GetObjectClass, env, _obj)) != NULL))\\\n+             env->GetObjectClass(_obj)) != NULL))\\\n@@ -40,1 +40,1 @@\n-        _value = NSK_CPP_STUB3(GetObjectField, env, _obj, field)\n+        _value = env->GetObjectField(_obj, field)\n@@ -44,2 +44,1 @@\n-             NSK_CPP_STUB4(GetFieldID, env, _class,\\\n-             _fieldName, _fieldSig)) != NULL))\\\n+             env->GetFieldID(_class, _fieldName, _fieldSig)) != NULL))\\\n@@ -50,2 +49,1 @@\n-             NSK_CPP_STUB4(GetMethodID, env, _class,\\\n-             _methodName, _sig)) != NULL))\\\n+             env->GetMethodID(_class, _methodName, _sig)) != NULL))\\\n@@ -56,2 +54,1 @@\n-        if (!NSK_JNI_VERIFY_VOID(env, NSK_CPP_STUB3(CallVoidMethod, env, _obj,\\\n-             method)))\\\n+        if (!NSK_JNI_VERIFY_VOID(env, env->CallVoidMethod(_obj, method)))\\\n","filename":"test\/hotspot\/jtreg\/vmTestbase\/nsk\/monitoring\/share\/thread\/LockingThreads.cpp","additions":6,"deletions":9,"binary":false,"changes":15,"status":"modified"},{"patch":"@@ -32,1 +32,1 @@\n-            NSK_CPP_STUB2(FindClass, env, _className)) != NULL))\\\n+            env->FindClass(_className)) != NULL))\\\n@@ -37,1 +37,1 @@\n-            NSK_CPP_STUB2(GetObjectClass, env, _obj)) != NULL))\\\n+            env->GetObjectClass(_obj)) != NULL))\\\n@@ -42,2 +42,1 @@\n-            NSK_CPP_STUB4(GetStaticFieldID, env, _class,\\\n-                _fieldName, _fieldSig)) != NULL))\\\n+            env->GetStaticFieldID(_class, _fieldName, _fieldSig)) != NULL))\\\n@@ -48,2 +47,1 @@\n-    _value = NSK_CPP_STUB3(GetStaticObjectField, env, _class, \\\n-                                field)\n+    _value = env->GetStaticObjectField(_class, field)\n@@ -53,1 +51,1 @@\n-    _value = NSK_CPP_STUB3(GetStaticBooleanField, env, _class, field)\n+    _value = env->GetStaticBooleanField(_class, field)\n@@ -57,2 +55,1 @@\n-            NSK_CPP_STUB4(GetFieldID, env, _class,\\\n-                _fieldName, _fieldSig)) != NULL))\\\n+            env->GetFieldID(_class, _fieldName, _fieldSig)) != NULL))\\\n@@ -63,1 +60,1 @@\n-    _value = NSK_CPP_STUB3(GetIntField, env, _obj, field)\n+    _value = env->GetIntField(_obj, field)\n@@ -67,1 +64,1 @@\n-    _value = NSK_CPP_STUB3(GetLongField, env, _obj, field)\n+    _value = env->GetLongField(_obj, field)\n@@ -71,1 +68,1 @@\n-    _value = NSK_CPP_STUB3(GetStaticIntField, env, _class, field)\n+    _value = env->GetStaticIntField(_class, field)\n@@ -75,1 +72,1 @@\n-    NSK_CPP_STUB4(SetIntField, env, _obj, field, _newValue)\n+    env->SetIntField(_obj, field, _newValue)\n@@ -79,1 +76,1 @@\n-    _value = NSK_CPP_STUB3(GetObjectField, env, _obj, field)\n+    _value = env->GetObjectField(_obj, field)\n@@ -83,1 +80,1 @@\n-    NSK_CPP_STUB3(GetObjectArrayElement, env, _arr, _index)\n+    env->GetObjectArrayElement(_arr, _index)\n@@ -86,1 +83,1 @@\n-    NSK_CPP_STUB4(SetObjectArrayElement, env, _arr, _index, _newValue)\n+    env->SetObjectArrayElement(_arr, _index, _newValue)\n@@ -90,2 +87,1 @@\n-            NSK_CPP_STUB4(GetStaticMethodID, env, _class,\\\n-                _methodName, _sig)) != NULL))\\\n+            env->GetStaticMethodID(_class, _methodName, _sig)) != NULL))\\\n@@ -96,2 +92,1 @@\n-            NSK_CPP_STUB4(GetMethodID, env, _class,\\\n-                _methodName, _sig)) != NULL))\\\n+            env->GetMethodID(_class, _methodName, _sig)) != NULL))\\\n@@ -102,2 +97,1 @@\n-    if (!NSK_JNI_VERIFY_VOID(env, NSK_CPP_STUB3(CallStaticVoidMethod, env,\\\n-                            _class, method)))\\\n+    if (!NSK_JNI_VERIFY_VOID(env, env->CallStaticVoidMethod(_class, method)))\\\n@@ -108,2 +102,1 @@\n-    if (!NSK_JNI_VERIFY_VOID(env, NSK_CPP_STUB4(CallStaticVoidMethod, env,\\\n-                                                    _class, method, _param)))\\\n+    if (!NSK_JNI_VERIFY_VOID(env, env->CallStaticVoidMethod(_class, method, _param)))\\\n@@ -114,2 +107,1 @@\n-    if (!NSK_JNI_VERIFY_VOID(env, NSK_CPP_STUB3(CallVoidMethod, env, _obj,\\\n-                                                    method)))\\\n+    if (!NSK_JNI_VERIFY_VOID(env, env->CallVoidMethod(_obj, method)))\\\n@@ -120,2 +112,1 @@\n-    if (!NSK_JNI_VERIFY_VOID(env, NSK_CPP_STUB4(CallVoidMethod, env, _obj,\\\n-                                                    method, _param)))\\\n+    if (!NSK_JNI_VERIFY_VOID(env, env->CallVoidMethod(_obj, method, _param)))\\\n@@ -126,2 +117,1 @@\n-    if (!NSK_JNI_VERIFY_VOID(env, NSK_CPP_STUB5(CallVoidMethod, env, _obj, \\\n-                                                    method, _param1, _param2)))\\\n+    if (!NSK_JNI_VERIFY_VOID(env, env->CallVoidMethod(_obj, method, _param1, _param2)))\\\n@@ -132,1 +122,1 @@\n-    _value = NSK_CPP_STUB3(CallIntMethod, env, _obj, method)\n+    _value = env->CallIntMethod(_obj, method)\n@@ -137,1 +127,1 @@\n-            NSK_CPP_STUB4(NewObject, env, _class, method, _params)) != NULL))\\\n+            env->NewObject(_class, method, _params)) != NULL))\\\n@@ -141,1 +131,1 @@\n-    NSK_JNI_VERIFY(env, NSK_CPP_STUB2(MonitorEnter, env, x) == 0)\n+    NSK_JNI_VERIFY(env, env->MonitorEnter(x) == 0)\n@@ -144,1 +134,1 @@\n-    NSK_JNI_VERIFY(env, NSK_CPP_STUB2(MonitorExit, env, x) == 0)\n+    NSK_JNI_VERIFY(env, env->MonitorExit(x) == 0)\n@@ -148,1 +138,1 @@\n-   jmsg = NSK_CPP_STUB2(NewStringUTF, env, msg);\\\n+   jmsg = env->NewStringUTF(msg);\\\n","filename":"test\/hotspot\/jtreg\/vmTestbase\/nsk\/monitoring\/share\/thread\/RecursiveMonitoringThread.cpp","additions":25,"deletions":35,"binary":false,"changes":60,"status":"modified"},{"patch":"@@ -163,4 +163,2 @@\n-        if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB4(GetClassSignature,\n-                jvmti_env, klass, &cls_sig, \/*&generic*\/NULL)))\n-            NSK_CPP_STUB2(FatalError, jni_env,\n-                \"JVMTIagent: failed to get class signature\\n\");\n+        if (!NSK_JVMTI_VERIFY(jvmti_env->GetClassSignature(klass, &cls_sig, \/*&generic*\/NULL)))\n+            jni_env->FatalError(\"JVMTIagent: failed to get class signature\\n\");\n@@ -248,4 +246,2 @@\n-        if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB3(GetMethodDeclaringClass,\n-                jvmti_env, method, &decl_clazz)))\n-            NSK_CPP_STUB2(FatalError, jni_env,\n-                \"JVMTIagent: failed to get method declaring class\\n\");\n+        if (!NSK_JVMTI_VERIFY(jvmti_env->GetMethodDeclaringClass(method, &decl_clazz)))\n+            jni_env->FatalError(\"JVMTIagent: failed to get method declaring class\\n\");\n@@ -254,2 +250,1 @@\n-            NSK_CPP_STUB2(FatalError, jni_env,\n-                \"JVMTIagent: failed to hotswap class\\n\");\n+            jni_env->FatalError(\"JVMTIagent: failed to hotswap class\\n\");\n@@ -422,4 +417,2 @@\n-        if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB3(GetMethodDeclaringClass,\n-                jvmti_env, method, &decl_clazz)))\n-            NSK_CPP_STUB2(FatalError, jni_env,\n-                \"JVMTIagent: failed to get method declaring class\\n\");\n+        if (!NSK_JVMTI_VERIFY(jvmti_env->GetMethodDeclaringClass(method, &decl_clazz)))\n+            jni_env->FatalError(\"JVMTIagent: failed to get method declaring class\\n\");\n@@ -428,2 +421,1 @@\n-            NSK_CPP_STUB2(FatalError, jni_env,\n-                \"JVMTIagent: failed to hotswap class\\n\");\n+            jni_env->FatalError(\"JVMTIagent: failed to hotswap class\\n\");\n@@ -446,4 +438,2 @@\n-        if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB3(GetMethodDeclaringClass,\n-                jvmti_env, method, &decl_clazz)))\n-            NSK_CPP_STUB2(FatalError, jni_env,\n-                \"JVMTIagent: failed to get method declaring class\\n\");\n+        if (!NSK_JVMTI_VERIFY(jvmti_env->GetMethodDeclaringClass(method, &decl_clazz)))\n+            jni_env->FatalError(\"JVMTIagent: failed to get method declaring class\\n\");\n@@ -452,2 +442,1 @@\n-            NSK_CPP_STUB2(FatalError, jni_env,\n-                \"JVMTIagent: failed to hotswap class\\n\");\n+            jni_env->FatalError(\"JVMTIagent: failed to hotswap class\\n\");\n@@ -480,4 +469,2 @@\n-        if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB3(GetMethodDeclaringClass,\n-                jvmti_env, method, &decl_clazz)))\n-            NSK_CPP_STUB2(FatalError, jni_env,\n-                \"JVMTIagent: failed to get method declaring class\\n\");\n+        if (!NSK_JVMTI_VERIFY(jvmti_env->GetMethodDeclaringClass(method, &decl_clazz)))\n+            jni_env->FatalError(\"JVMTIagent: failed to get method declaring class\\n\");\n@@ -486,2 +473,1 @@\n-            NSK_CPP_STUB2(FatalError, jni_env,\n-                \"JVMTIagent: failed to hotswap class\\n\");\n+            jni_env->FatalError(\"JVMTIagent: failed to hotswap class\\n\");\n@@ -493,4 +479,2 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(RawMonitorEnter,\n-            jvmti, eventLock)))\n-        NSK_CPP_STUB2(FatalError, jni_env,\n-            \"JVMTIagent: failed to enter a raw monitor\\n\");\n+    if (!NSK_JVMTI_VERIFY(jvmti->RawMonitorEnter(eventLock)))\n+        jni_env->FatalError(\"JVMTIagent: failed to enter a raw monitor\\n\");\n@@ -500,4 +484,2 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(RawMonitorExit,\n-            jvmti, eventLock)))\n-        NSK_CPP_STUB2(FatalError, jni_env,\n-            \"JVMTIagent: failed to exit a raw monitor\\n\");\n+    if (!NSK_JVMTI_VERIFY(jvmti->RawMonitorExit(eventLock)))\n+        jni_env->FatalError(\"JVMTIagent: failed to exit a raw monitor\\n\");\n@@ -519,4 +501,2 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(GetCapabilities,\n-            jvmti, &capabil)))\n-        NSK_CPP_STUB2(FatalError, jni_env,\n-            \"JVMTIagent: failed to get capabilities\\n\");\n+    if (!NSK_JVMTI_VERIFY(jvmti->GetCapabilities(&capabil)))\n+        jni_env->FatalError(\"JVMTIagent: failed to get capabilities\\n\");\n@@ -577,2 +557,1 @@\n-    if (!NSK_JNI_VERIFY(jni_env, (shortTestName = NSK_CPP_STUB3(GetStringUTFChars,\n-            jni_env, shortName, NULL)) != NULL)) {\n+    if (!NSK_JNI_VERIFY(jni_env, (shortTestName = jni_env->GetStringUTFChars(shortName, NULL)) != NULL)) {\n@@ -585,2 +564,1 @@\n-    if (!NSK_JNI_VERIFY(jni_env, (rasCls = NSK_CPP_STUB2(NewGlobalRef,\n-            jni_env, cls)) != NULL)) {\n+    if (!NSK_JNI_VERIFY(jni_env, (rasCls = jni_env->NewGlobalRef(cls)) != NULL)) {\n@@ -608,2 +586,1 @@\n-        NSK_CPP_STUB2(FatalError, jni_env,\n-            \"JVMTIagent: cannot allocate memory for class_info\\n\");\n+        jni_env->FatalError(\"JVMTIagent: cannot allocate memory for class_info\\n\");\n@@ -614,2 +591,1 @@\n-    if (!NSK_JNI_VERIFY(jni_env, ((*_clsInfo).cls = NSK_CPP_STUB2(NewGlobalRef,\n-            jni_env, clazz)) != NULL)) {\n+    if (!NSK_JNI_VERIFY(jni_env, ((*_clsInfo).cls = jni_env->NewGlobalRef(clazz)) != NULL)) {\n@@ -620,2 +596,1 @@\n-        NSK_CPP_STUB2(FatalError, jni_env,\n-            \"JVMTIagent: unable to create a new global reference of class\\n\");\n+        jni_env->FatalError(\"JVMTIagent: unable to create a new global reference of class\\n\");\n@@ -625,4 +600,2 @@\n-        NSK_CPP_STUB4(GetStaticMethodID, jni_env, rasCls,\n-            \"loadFromClassFile\", \"(Ljava\/lang\/String;)[B\")) != NULL))\n-        NSK_CPP_STUB2(FatalError, jni_env,\n-            \"JVMTIagent: unable to get ID of the method \\\"loadFromClassFile\\\"\\n\");\n+        jni_env->GetStaticMethodID(rasCls, \"loadFromClassFile\", \"(Ljava\/lang\/String;)[B\")) != NULL))\n+        jni_env->FatalError(\"JVMTIagent: unable to get ID of the method \\\"loadFromClassFile\\\"\\n\");\n@@ -630,2 +603,1 @@\n-    classBytes = (jbyteArray) NSK_CPP_STUB4(CallStaticObjectMethod,\n-        jni_env, rasCls, mid, NSK_CPP_STUB2(NewStringUTF, jni_env, cls_sig));\n+    classBytes = (jbyteArray) jni_env->CallStaticObjectMethod(rasCls, mid, jni_env->NewStringUTF(cls_sig));\n@@ -635,1 +607,1 @@\n-    (*_clsInfo).bCount = NSK_CPP_STUB2(GetArrayLength, jni_env, classBytes);\n+    (*_clsInfo).bCount = jni_env->GetArrayLength(classBytes);\n@@ -638,1 +610,1 @@\n-        NSK_CPP_STUB3(GetByteArrayElements, jni_env, classBytes, &isCopy);\n+        jni_env->GetByteArrayElements(classBytes, &isCopy);\n@@ -656,1 +628,1 @@\n-    NSK_TRACE(NSK_CPP_STUB2(DeleteGlobalRef, jni_env, rasCls));\n+    NSK_TRACE(jni_env->DeleteGlobalRef(rasCls));\n@@ -661,4 +633,2 @@\n-        if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(Deallocate,\n-                jvmti, (unsigned char*) clsInfoCurr->clazzsig)))\n-            NSK_CPP_STUB2(FatalError, jni_env,\n-                \"JVMTIagent: failed to deallocate memory for clazzsig\\n\");\n+        if (!NSK_JVMTI_VERIFY(jvmti->Deallocate((unsigned char*) clsInfoCurr->clazzsig)))\n+            jni_env->FatalError(\"JVMTIagent: failed to deallocate memory for clazzsig\\n\");\n@@ -666,1 +636,1 @@\n-        NSK_TRACE(NSK_CPP_STUB2(DeleteGlobalRef, jni_env, clsInfoCurr->cls));\n+        NSK_TRACE(jni_env->DeleteGlobalRef(clsInfoCurr->cls));\n@@ -682,4 +652,2 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB4(GetClassSignature,\n-            jvmti, clazz, &clazzsig, \/*&generic*\/NULL)))\n-        NSK_CPP_STUB2(FatalError, jni_env,\n-            \"JVMTIagent: findAndHotSwap: failed to get class signature\\n\");\n+    if (!NSK_JVMTI_VERIFY(jvmti->GetClassSignature(clazz, &clazzsig, \/*&generic*\/NULL)))\n+        jni_env->FatalError(\"JVMTIagent: findAndHotSwap: failed to get class signature\\n\");\n@@ -699,4 +667,2 @@\n-                if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(Deallocate,\n-                        jvmti, (unsigned char*) clazzsig)))\n-                    NSK_CPP_STUB2(FatalError, jni_env,\n-                        \"JVMTIagent: findAndHotSwap: failed to deallocate memory for clazzsig\\n\");\n+                if (!NSK_JVMTI_VERIFY(jvmti->Deallocate((unsigned char*) clazzsig)))\n+                    jni_env->FatalError(\"JVMTIagent: findAndHotSwap: failed to deallocate memory for clazzsig\\n\");\n@@ -715,4 +681,2 @@\n-                    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(Deallocate,\n-                            jvmti, (unsigned char*) clazzsig)))\n-                        NSK_CPP_STUB2(FatalError, jni_env,\n-                            \"JVMTIagent: findAndHotSwap: failed to deallocate memory for clazzsig\\n\");\n+                    if (!NSK_JVMTI_VERIFY(jvmti->Deallocate((unsigned char*) clazzsig)))\n+                        jni_env->FatalError(\"JVMTIagent: findAndHotSwap: failed to deallocate memory for clazzsig\\n\");\n@@ -754,2 +718,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB3(RedefineClasses,\n-            jvmti, 1, &classDef)))\n+    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB3(jvmti->RedefineClasses(1, &classDef)))\n@@ -775,2 +738,1 @@\n-            if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB4(SetEventNotificationMode,\n-                    jvmti, JVMTI_ENABLE, JVMTI_EVENT_SINGLE_STEP, NULL)))\n+            if (!NSK_JVMTI_VERIFY(jvmti->SetEventNotificationMode(JVMTI_ENABLE, JVMTI_EVENT_SINGLE_STEP, NULL)))\n@@ -792,2 +754,1 @@\n-            if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB4(SetEventNotificationMode,\n-                    jvmti, JVMTI_ENABLE, JVMTI_EVENT_METHOD_ENTRY, NULL)))\n+            if (!NSK_JVMTI_VERIFY(jvmti->SetEventNotificationMode(JVMTI_ENABLE, JVMTI_EVENT_METHOD_ENTRY, NULL)))\n@@ -803,2 +764,1 @@\n-            if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB4(SetEventNotificationMode,\n-                    jvmti, JVMTI_ENABLE, JVMTI_EVENT_METHOD_EXIT, NULL)))\n+            if (!NSK_JVMTI_VERIFY(jvmti->SetEventNotificationMode(JVMTI_ENABLE, JVMTI_EVENT_METHOD_EXIT, NULL)))\n@@ -820,2 +780,1 @@\n-            if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB4(SetEventNotificationMode,\n-                    jvmti, JVMTI_ENABLE, JVMTI_EVENT_EXCEPTION_CATCH, NULL)))\n+            if (!NSK_JVMTI_VERIFY(jvmti->SetEventNotificationMode(JVMTI_ENABLE, JVMTI_EVENT_EXCEPTION_CATCH, NULL)))\n@@ -830,2 +789,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB3(SetEventCallbacks,\n-            jvmti, &callbacks, sizeof(callbacks))))\n+    if (!NSK_JVMTI_VERIFY(jvmti->SetEventCallbacks(&callbacks, sizeof(callbacks))))\n@@ -859,2 +817,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(AddCapabilities,\n-            jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->AddCapabilities(&caps)))\n@@ -868,2 +825,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB4(SetEventNotificationMode,\n-            jvmti, JVMTI_ENABLE, JVMTI_EVENT_BREAKPOINT, NULL)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->SetEventNotificationMode(JVMTI_ENABLE, JVMTI_EVENT_BREAKPOINT, NULL)))\n@@ -878,2 +834,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB4(SetEventNotificationMode,\n-            jvmti, JVMTI_ENABLE, JVMTI_EVENT_CLASS_FILE_LOAD_HOOK, NULL)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->SetEventNotificationMode(JVMTI_ENABLE, JVMTI_EVENT_CLASS_FILE_LOAD_HOOK, NULL)))\n@@ -888,2 +843,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB4(SetEventNotificationMode,\n-            jvmti, JVMTI_ENABLE, JVMTI_EVENT_CLASS_LOAD, NULL)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->SetEventNotificationMode(JVMTI_ENABLE, JVMTI_EVENT_CLASS_LOAD, NULL)))\n@@ -898,2 +852,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB4(SetEventNotificationMode,\n-            jvmti, JVMTI_ENABLE, JVMTI_EVENT_CLASS_PREPARE, NULL)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->SetEventNotificationMode(JVMTI_ENABLE, JVMTI_EVENT_CLASS_PREPARE, NULL)))\n@@ -908,2 +861,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB4(SetEventNotificationMode,\n-            jvmti, JVMTI_ENABLE, JVMTI_EVENT_COMPILED_METHOD_LOAD, NULL)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->SetEventNotificationMode(JVMTI_ENABLE, JVMTI_EVENT_COMPILED_METHOD_LOAD, NULL)))\n@@ -918,2 +870,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB4(SetEventNotificationMode,\n-            jvmti, JVMTI_ENABLE, JVMTI_EVENT_COMPILED_METHOD_UNLOAD, NULL)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->SetEventNotificationMode(JVMTI_ENABLE, JVMTI_EVENT_COMPILED_METHOD_UNLOAD, NULL)))\n@@ -928,2 +879,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB4(SetEventNotificationMode,\n-            jvmti, JVMTI_ENABLE, JVMTI_EVENT_DATA_DUMP_REQUEST, NULL)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->SetEventNotificationMode(JVMTI_ENABLE, JVMTI_EVENT_DATA_DUMP_REQUEST, NULL)))\n@@ -938,2 +888,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB4(SetEventNotificationMode,\n-            jvmti, JVMTI_ENABLE, JVMTI_EVENT_DYNAMIC_CODE_GENERATED, NULL)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->SetEventNotificationMode(JVMTI_ENABLE, JVMTI_EVENT_DYNAMIC_CODE_GENERATED, NULL)))\n@@ -948,2 +897,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB4(SetEventNotificationMode,\n-            jvmti, JVMTI_ENABLE, JVMTI_EVENT_EXCEPTION, NULL)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->SetEventNotificationMode(JVMTI_ENABLE, JVMTI_EVENT_EXCEPTION, NULL)))\n@@ -958,2 +906,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB4(SetEventNotificationMode,\n-            jvmti, JVMTI_ENABLE, JVMTI_EVENT_FIELD_ACCESS, NULL)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->SetEventNotificationMode(JVMTI_ENABLE, JVMTI_EVENT_FIELD_ACCESS, NULL)))\n@@ -968,2 +915,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB4(SetEventNotificationMode,\n-            jvmti, JVMTI_ENABLE, JVMTI_EVENT_FIELD_MODIFICATION, NULL)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->SetEventNotificationMode(JVMTI_ENABLE, JVMTI_EVENT_FIELD_MODIFICATION, NULL)))\n@@ -978,2 +924,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB4(SetEventNotificationMode,\n-            jvmti, JVMTI_ENABLE, JVMTI_EVENT_FRAME_POP, NULL)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->SetEventNotificationMode(JVMTI_ENABLE, JVMTI_EVENT_FRAME_POP, NULL)))\n@@ -988,2 +933,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB4(SetEventNotificationMode,\n-            jvmti, JVMTI_ENABLE, JVMTI_EVENT_GARBAGE_COLLECTION_FINISH, NULL)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->SetEventNotificationMode(JVMTI_ENABLE, JVMTI_EVENT_GARBAGE_COLLECTION_FINISH, NULL)))\n@@ -998,2 +942,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB4(SetEventNotificationMode,\n-            jvmti, JVMTI_ENABLE, JVMTI_EVENT_GARBAGE_COLLECTION_START, NULL)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->SetEventNotificationMode(JVMTI_ENABLE, JVMTI_EVENT_GARBAGE_COLLECTION_START, NULL)))\n@@ -1008,2 +951,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB4(SetEventNotificationMode,\n-            jvmti, JVMTI_ENABLE, JVMTI_EVENT_MONITOR_CONTENDED_ENTER, NULL)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->SetEventNotificationMode(JVMTI_ENABLE, JVMTI_EVENT_MONITOR_CONTENDED_ENTER, NULL)))\n@@ -1018,2 +960,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB4(SetEventNotificationMode,\n-            jvmti, JVMTI_ENABLE, JVMTI_EVENT_MONITOR_CONTENDED_ENTERED, NULL)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->SetEventNotificationMode(JVMTI_ENABLE, JVMTI_EVENT_MONITOR_CONTENDED_ENTERED, NULL)))\n@@ -1028,2 +969,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB4(SetEventNotificationMode,\n-            jvmti, JVMTI_ENABLE, JVMTI_EVENT_MONITOR_WAIT, NULL)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->SetEventNotificationMode(JVMTI_ENABLE, JVMTI_EVENT_MONITOR_WAIT, NULL)))\n@@ -1038,2 +978,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB4(SetEventNotificationMode,\n-            jvmti, JVMTI_ENABLE, JVMTI_EVENT_MONITOR_WAITED, NULL)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->SetEventNotificationMode(JVMTI_ENABLE, JVMTI_EVENT_MONITOR_WAITED, NULL)))\n@@ -1048,2 +987,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB4(SetEventNotificationMode,\n-            jvmti, JVMTI_ENABLE, JVMTI_EVENT_NATIVE_METHOD_BIND, NULL)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->SetEventNotificationMode(JVMTI_ENABLE, JVMTI_EVENT_NATIVE_METHOD_BIND, NULL)))\n@@ -1058,2 +996,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB4(SetEventNotificationMode,\n-            jvmti, JVMTI_ENABLE, JVMTI_EVENT_OBJECT_FREE, NULL)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->SetEventNotificationMode(JVMTI_ENABLE, JVMTI_EVENT_OBJECT_FREE, NULL)))\n@@ -1068,2 +1005,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB4(SetEventNotificationMode,\n-            jvmti, JVMTI_ENABLE, JVMTI_EVENT_THREAD_END, NULL)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->SetEventNotificationMode(JVMTI_ENABLE, JVMTI_EVENT_THREAD_END, NULL)))\n@@ -1078,2 +1014,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB4(SetEventNotificationMode,\n-            jvmti, JVMTI_ENABLE, JVMTI_EVENT_THREAD_START, NULL)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->SetEventNotificationMode(JVMTI_ENABLE, JVMTI_EVENT_THREAD_START, NULL)))\n@@ -1088,2 +1023,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB4(SetEventNotificationMode,\n-            jvmti, JVMTI_ENABLE, JVMTI_EVENT_VM_DEATH, NULL)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->SetEventNotificationMode(JVMTI_ENABLE, JVMTI_EVENT_VM_DEATH, NULL)))\n@@ -1098,2 +1032,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB4(SetEventNotificationMode,\n-            jvmti, JVMTI_ENABLE, JVMTI_EVENT_VM_INIT, NULL)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->SetEventNotificationMode(JVMTI_ENABLE, JVMTI_EVENT_VM_INIT, NULL)))\n@@ -1108,2 +1041,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB4(SetEventNotificationMode,\n-            jvmti, JVMTI_ENABLE, JVMTI_EVENT_VM_START, NULL)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->SetEventNotificationMode(JVMTI_ENABLE, JVMTI_EVENT_VM_START, NULL)))\n@@ -1118,2 +1050,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB4(SetEventNotificationMode,\n-            jvmti, JVMTI_ENABLE, JVMTI_EVENT_VM_OBJECT_ALLOC, NULL)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->SetEventNotificationMode(JVMTI_ENABLE, JVMTI_EVENT_VM_OBJECT_ALLOC, NULL)))\n@@ -1123,2 +1054,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB3(SetEventCallbacks,\n-            jvmti, &callbacks, sizeof(callbacks))))\n+    if (!NSK_JVMTI_VERIFY(jvmti->SetEventCallbacks(&callbacks, sizeof(callbacks))))\n@@ -1131,1 +1061,1 @@\n-    if (NSK_CPP_STUB1(ExceptionOccurred, jni_env)) {\n+    if (jni_env->ExceptionOccurred()) {\n@@ -1133,2 +1063,2 @@\n-        NSK_CPP_STUB1(ExceptionDescribe, jni_env);\n-        NSK_CPP_STUB1(ExceptionClear, jni_env);\n+        jni_env->ExceptionDescribe();\n+        jni_env->ExceptionClear();\n@@ -1136,2 +1066,1 @@\n-        NSK_CPP_STUB2(FatalError, jni_env,\n-            \"JVMTIagent: exception occurred in java code, aborting\\n\");\n+        jni_env->FatalError(\"JVMTIagent: exception occurred in java code, aborting\\n\");\n@@ -1232,1 +1161,1 @@\n-            NSK_CPP_STUB2(FatalError, jni_env, error_msg);\n+            jni_env->FatalError(error_msg);\n@@ -1260,2 +1189,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB3(CreateRawMonitor,\n-            jvmti, \"_event_lock\", &eventLock)))\n+    if (!NSK_JVMTI_VERIFY(jvmti->CreateRawMonitor(\"_event_lock\", &eventLock)))\n","filename":"test\/hotspot\/jtreg\/vmTestbase\/nsk\/share\/JVMTIagent.cpp","additions":80,"deletions":152,"binary":false,"changes":232,"status":"modified"},{"patch":"@@ -208,1 +208,1 @@\n-            NSK_CPP_STUB2(FindClass, jni, TARGET_APP_CLASS_NAME)) != NULL)) {\n+            jni->FindClass(TARGET_APP_CLASS_NAME)) != NULL)) {\n@@ -213,1 +213,1 @@\n-            NSK_CPP_STUB2(NewGlobalRef, jni, localTargetAppClass)) != NULL)) {\n+            jni->NewGlobalRef(localTargetAppClass)) != NULL)) {\n@@ -220,2 +220,1 @@\n-            NSK_CPP_STUB4(GetStaticMethodID, jni, targetAppClass,\n-                    AGENT_LOADED_METHOD_NAME, AGENT_LOADED_METHOD_SIGNATURE)) != NULL))\n+            jni->GetStaticMethodID(targetAppClass, AGENT_LOADED_METHOD_NAME, AGENT_LOADED_METHOD_SIGNATURE)) != NULL))\n@@ -226,1 +225,1 @@\n-        NSK_CPP_STUB2(NewStringUTF, jni, agentName)) != NULL))\n+        jni->NewStringUTF(agentName)) != NULL))\n@@ -229,1 +228,1 @@\n-    NSK_CPP_STUB4(CallStaticVoidMethod, jni, targetAppClass, agentLoadedMethod, agentNameString);\n+    jni->CallStaticVoidMethod(targetAppClass, agentLoadedMethod, agentNameString);\n@@ -258,2 +257,1 @@\n-            NSK_CPP_STUB4(GetStaticMethodID, jni, targetAppClass,\n-                    AGENT_FINISHED_METHOD_NAME, AGENT_FINISHED_METHOD_SIGNATURE)) != NULL))\n+            jni->GetStaticMethodID(targetAppClass, AGENT_FINISHED_METHOD_NAME, AGENT_FINISHED_METHOD_SIGNATURE)) != NULL))\n@@ -263,1 +261,1 @@\n-    if (!NSK_JNI_VERIFY(jni, (agentNameString = NSK_CPP_STUB2(NewStringUTF, jni, agentName)) != NULL))\n+    if (!NSK_JNI_VERIFY(jni, (agentNameString = jni->NewStringUTF(agentName)) != NULL))\n@@ -266,2 +264,1 @@\n-    NSK_CPP_STUB5(CallStaticVoidMethod, jni, targetAppClass,\n-            agentFinishedMethod, agentNameString, success ? JNI_TRUE : JNI_FALSE);\n+    jni->CallStaticVoidMethod(targetAppClass, agentFinishedMethod, agentNameString, success ? JNI_TRUE : JNI_FALSE);\n@@ -280,1 +277,1 @@\n-    NSK_CPP_STUB3(GetEnv, vm, (void**)&jni, JNI_VERSION_1_2);\n+    vm->GetEnv((void**)&jni, JNI_VERSION_1_2);\n","filename":"test\/hotspot\/jtreg\/vmTestbase\/nsk\/share\/aod\/aod.cpp","additions":9,"deletions":12,"binary":false,"changes":21,"status":"modified"},{"patch":"@@ -50,1 +50,1 @@\n-            NSK_CPP_STUB2(FindClass, jni, class_name) != NULL)) {\n+            jni->FindClass(class_name) != NULL)) {\n@@ -58,1 +58,1 @@\n-            NSK_CPP_STUB2(FindClass, jni, class_name)) != NULL)) {\n+            jni->FindClass(class_name)) != NULL)) {\n","filename":"test\/hotspot\/jtreg\/vmTestbase\/nsk\/share\/jni\/README","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -56,1 +56,1 @@\n-    NSK_TRACE(throwable = NSK_CPP_STUB1(ExceptionOccurred, jni));\n+    NSK_TRACE(throwable = jni->ExceptionOccurred());\n@@ -59,2 +59,2 @@\n-        NSK_TRACE(NSK_CPP_STUB1(ExceptionDescribe, jni));\n-        NSK_TRACE(NSK_CPP_STUB1(ExceptionClear, jni));\n+        NSK_TRACE(jni->ExceptionDescribe());\n+        NSK_TRACE(jni->ExceptionClear());\n","filename":"test\/hotspot\/jtreg\/vmTestbase\/nsk\/share\/jni\/jni_tools.cpp","additions":3,"deletions":3,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -98,1 +98,1 @@\n-            NSK_CPP_STUB3(GetEnv, jvm, &env, JNI_VERSION_1_2) == JNI_OK)) {\n+            jvm->GetEnv(&env, JNI_VERSION_1_2) == JNI_OK)) {\n","filename":"test\/hotspot\/jtreg\/vmTestbase\/nsk\/share\/native\/README","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -32,2 +32,2 @@\n-#define EXCEPTION_CLEAR NSK_CPP_STUB1(ExceptionClear, env)\n-#define EXCEPTION_OCCURRED NSK_CPP_STUB1(ExceptionOccurred, env)\n+#define EXCEPTION_CLEAR env->ExceptionClear()\n+#define EXCEPTION_OCCURRED env->ExceptionOccurred()\n@@ -40,2 +40,1 @@\n-            if (NSK_CPP_STUB3(IsInstanceOf, env, exception, \\\n-                        exceptionClass) == JNI_TRUE) { \\\n+            if (env->IsInstanceOf(exception, exceptionClass) == JNI_TRUE) { \\\n@@ -49,1 +48,1 @@\n-            NSK_CPP_STUB2(FindClass, env, _className)) != NULL))\\\n+            env->FindClass(_className)) != NULL))\\\n@@ -54,1 +53,1 @@\n-            NSK_CPP_STUB2(GetObjectClass, env, _obj)) != NULL))\\\n+            env->GetObjectClass(_obj)) != NULL))\\\n@@ -59,2 +58,1 @@\n-            NSK_CPP_STUB4(GetFieldID, env, _class,\\\n-                _fieldName, _fieldSig)) != NULL))\\\n+            env->GetFieldID(_class, _fieldName, _fieldSig)) != NULL))\\\n@@ -65,2 +63,1 @@\n-            NSK_CPP_STUB4(GetStaticFieldID, env, _class,\\\n-                _fieldName, _fieldSig)) != NULL))\\\n+            env->GetStaticFieldID(_class, _fieldName, _fieldSig)) != NULL))\\\n@@ -71,1 +68,1 @@\n-    _value = NSK_CPP_STUB3(GetStaticBooleanField, env, _class, field)\n+    _value = env->GetStaticBooleanField(_class, field)\n@@ -75,1 +72,1 @@\n-    _value = NSK_CPP_STUB3(GetStaticIntField, env, _class, field)\n+    _value = env->GetStaticIntField(_class, field)\n@@ -79,2 +76,1 @@\n-    _value = NSK_CPP_STUB3(GetStaticObjectField, env, _class, \\\n-                                field)\n+    _value = env->GetStaticObjectField(_class, field)\n@@ -84,1 +80,1 @@\n-    _value = NSK_CPP_STUB3(GetIntField, env, _obj, field)\n+    _value = env->GetIntField(_obj, field)\n@@ -88,1 +84,1 @@\n-    NSK_CPP_STUB4(SetIntField, env, _obj, field, _newValue)\n+    env->SetIntField(_obj, field, _newValue)\n@@ -92,1 +88,1 @@\n-    NSK_CPP_STUB4(SetStaticIntField, env, _class, field, _newValue)\n+    env->SetStaticIntField(_class, field, _newValue)\n@@ -96,1 +92,1 @@\n-    _value = NSK_CPP_STUB3(GetObjectField, env, _obj, field)\n+    _value = env->GetObjectField(_obj, field)\n@@ -100,2 +96,1 @@\n-            NSK_CPP_STUB4(GetStaticMethodID, env, _class,\\\n-                _methodName, _sig)) != NULL))\\\n+            env->GetStaticMethodID(_class, _methodName, _sig)) != NULL))\\\n@@ -106,2 +101,1 @@\n-            NSK_CPP_STUB4(GetMethodID, env, _class,\\\n-                _methodName, _sig)) != NULL))\\\n+            env->GetMethodID(_class, _methodName, _sig)) != NULL))\\\n@@ -112,2 +106,1 @@\n-    if (!NSK_JNI_VERIFY_VOID(env, NSK_CPP_STUB3(CallStaticVoidMethod, env,\\\n-                            _class, method)))\\\n+    if (!NSK_JNI_VERIFY_VOID(env, env->CallStaticVoidMethod(_class, method)))\\\n@@ -118,2 +111,1 @@\n-    if (!NSK_JNI_VERIFY_VOID(env, NSK_CPP_STUB4(CallStaticVoidMethod, env,\\\n-                                                    _class, method, _param)))\\\n+    if (!NSK_JNI_VERIFY_VOID(env, env->CallStaticVoidMethod(_class, method, _param)))\\\n@@ -124,2 +116,1 @@\n-    if (!NSK_JNI_VERIFY_VOID(env, NSK_CPP_STUB3(CallVoidMethod, env, _obj,\\\n-                                                    method)))\\\n+    if (!NSK_JNI_VERIFY_VOID(env, env->CallVoidMethod(_obj, method)))\\\n@@ -130,2 +121,1 @@\n-    if (!NSK_JNI_VERIFY_VOID(env, NSK_CPP_STUB4(CallVoidMethod, env, _obj,\\\n-                                                    method, _param)))\\\n+    if (!NSK_JNI_VERIFY_VOID(env, env->CallVoidMethod(_obj, method, _param)))\\\n@@ -135,1 +125,1 @@\n-    NSK_JNI_VERIFY(env, NSK_CPP_STUB2(MonitorEnter, env, x) == 0)\n+    NSK_JNI_VERIFY(env, env->MonitorEnter(x) == 0)\n@@ -138,1 +128,1 @@\n-    NSK_JNI_VERIFY(env, NSK_CPP_STUB2(MonitorExit, env, x) == 0)\n+    NSK_JNI_VERIFY(env, env->MonitorExit(x) == 0)\n","filename":"test\/hotspot\/jtreg\/vmTestbase\/nsk\/stress\/strace\/nsk_strace.h","additions":22,"deletions":32,"binary":false,"changes":54,"status":"modified"},{"patch":"@@ -90,1 +90,1 @@\n-        NSK_CPP_STUB3(CallStaticVoidMethod, env, threadClass, method);\n+        env->CallStaticVoidMethod(threadClass, method);\n@@ -94,1 +94,1 @@\n-        NSK_CPP_STUB3(CallVoidMethod, env, obj, method);\n+        env->CallVoidMethod(obj, method);\n","filename":"test\/hotspot\/jtreg\/vmTestbase\/nsk\/stress\/strace\/strace005.cpp","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -91,1 +91,1 @@\n-        NSK_CPP_STUB3(CallStaticVoidMethod, env, threadClass, method);\n+        env->CallStaticVoidMethod(threadClass, method);\n@@ -95,1 +95,1 @@\n-        NSK_CPP_STUB3(CallVoidMethod, env, obj, method);\n+        env->CallVoidMethod(obj, method);\n","filename":"test\/hotspot\/jtreg\/vmTestbase\/nsk\/stress\/strace\/strace006.cpp","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -51,1 +51,1 @@\n-    if ( ! NSK_JNI_VERIFY(pEnv, (mhClass = NSK_CPP_STUB2(GetObjectClass, pEnv, mhToCall)) != NULL) )\n+    if ( ! NSK_JNI_VERIFY(pEnv, (mhClass = pEnv->GetObjectClass(mhToCall)) != NULL) )\n@@ -54,3 +54,1 @@\n-    if ( ! NSK_JNI_VERIFY(pEnv, NULL != (mid = NSK_CPP_STUB4(GetMethodID, pEnv, mhClass,\n-            \"invokeWithArguments\",\n-            \"([Ljava\/lang\/Object;)Ljava\/lang\/Object;\"))) )\n+    if ( ! NSK_JNI_VERIFY(pEnv, NULL != (mid = pEnv->GetMethodID(mhClass, \"invokeWithArguments\", \"([Ljava\/lang\/Object;)Ljava\/lang\/Object;\"))) )\n@@ -59,1 +57,1 @@\n-    NSK_JNI_VERIFY(pEnv, NULL != (objectClass = NSK_CPP_STUB2(FindClass, pEnv, \"java\/lang\/Object\")));\n+    NSK_JNI_VERIFY(pEnv, NULL != (objectClass = pEnv->FindClass(\"java\/lang\/Object\")));\n@@ -61,1 +59,1 @@\n-    NSK_JNI_VERIFY(pEnv, NULL != (arguments = NSK_CPP_STUB4(NewObjectArray, pEnv, ARGS_COUNT, objectClass, NULL)));\n+    NSK_JNI_VERIFY(pEnv, NULL != (arguments = pEnv->NewObjectArray(ARGS_COUNT, objectClass, NULL)));\n@@ -63,6 +61,6 @@\n-    NSK_JNI_VERIFY_VOID(pEnv, NSK_CPP_STUB4(SetObjectArrayElement, pEnv, arguments, 0, a1));\n-    NSK_JNI_VERIFY_VOID(pEnv, NSK_CPP_STUB4(SetObjectArrayElement, pEnv, arguments, 1, a2));\n-    NSK_JNI_VERIFY_VOID(pEnv, NSK_CPP_STUB4(SetObjectArrayElement, pEnv, arguments, 2, a3));\n-    NSK_JNI_VERIFY_VOID(pEnv, NSK_CPP_STUB4(SetObjectArrayElement, pEnv, arguments, 3, a4));\n-    NSK_JNI_VERIFY_VOID(pEnv, NSK_CPP_STUB4(SetObjectArrayElement, pEnv, arguments, 4, a5));\n-    NSK_JNI_VERIFY_VOID(pEnv, NSK_CPP_STUB4(SetObjectArrayElement, pEnv, arguments, 5, a6));\n+    NSK_JNI_VERIFY_VOID(pEnv, pEnv->SetObjectArrayElement(arguments, 0, a1));\n+    NSK_JNI_VERIFY_VOID(pEnv, pEnv->SetObjectArrayElement(arguments, 1, a2));\n+    NSK_JNI_VERIFY_VOID(pEnv, pEnv->SetObjectArrayElement(arguments, 2, a3));\n+    NSK_JNI_VERIFY_VOID(pEnv, pEnv->SetObjectArrayElement(arguments, 3, a4));\n+    NSK_JNI_VERIFY_VOID(pEnv, pEnv->SetObjectArrayElement(arguments, 4, a5));\n+    NSK_JNI_VERIFY_VOID(pEnv, pEnv->SetObjectArrayElement(arguments, 5, a6));\n@@ -71,1 +69,1 @@\n-    NSK_JNI_VERIFY(pEnv, NULL != (result = NSK_CPP_STUB4(CallObjectMethod, pEnv, mhToCall, mid, arguments)));\n+    NSK_JNI_VERIFY(pEnv, NULL != (result = pEnv->CallObjectMethod(mhToCall, mid, arguments)));\n","filename":"test\/hotspot\/jtreg\/vmTestbase\/vm\/mlvm\/meth\/stress\/jni\/nativeAndMH\/nativeAndMH.cpp","additions":11,"deletions":13,"binary":false,"changes":24,"status":"modified"},{"patch":"@@ -39,1 +39,1 @@\n-    if ( ! NSK_VERIFY((pStr = NSK_CPP_STUB3(GetStringUTFChars, pEnv, src, NULL)) != NULL) ) {\n+    if ( ! NSK_VERIFY((pStr = pEnv->GetStringUTFChars(src, NULL)) != NULL) ) {\n@@ -43,1 +43,1 @@\n-    len = NSK_CPP_STUB2(GetStringUTFLength, pEnv, src) + 1;\n+    len = pEnv->GetStringUTFLength(src) + 1;\n@@ -47,1 +47,1 @@\n-    NSK_CPP_STUB3(ReleaseStringUTFChars, pEnv, src, pStr);\n+    pEnv->ReleaseStringUTFChars(src, pStr);\n@@ -56,1 +56,1 @@\n-    if ( ! NSK_JVMTI_VERIFY(NSK_CPP_STUB5(GetMethodName, pJvmtiEnv, method, &szName, NULL, NULL)) ) {\n+    if ( ! NSK_JVMTI_VERIFY(pJvmtiEnv->GetMethodName(method, &szName, NULL, NULL)) ) {\n@@ -60,2 +60,2 @@\n-    if ( ! NSK_JVMTI_VERIFY(NSK_CPP_STUB3(GetMethodDeclaringClass, pJvmtiEnv, method, &clazz)) ) {\n-        NSK_JVMTI_VERIFY(NSK_CPP_STUB2(Deallocate, pJvmtiEnv, (unsigned char*) szName));\n+    if ( ! NSK_JVMTI_VERIFY(pJvmtiEnv->GetMethodDeclaringClass(method, &clazz)) ) {\n+        NSK_JVMTI_VERIFY(pJvmtiEnv->Deallocate((unsigned char*) szName));\n@@ -65,2 +65,2 @@\n-    if ( ! NSK_JVMTI_VERIFY(NSK_CPP_STUB4(GetClassSignature, pJvmtiEnv, clazz, &szSignature, NULL)) ) {\n-        NSK_JVMTI_VERIFY(NSK_CPP_STUB2(Deallocate, pJvmtiEnv, (unsigned char*) szName));\n+    if ( ! NSK_JVMTI_VERIFY(pJvmtiEnv->GetClassSignature(clazz, &szSignature, NULL)) ) {\n+        NSK_JVMTI_VERIFY(pJvmtiEnv->Deallocate((unsigned char*) szName));\n@@ -78,2 +78,2 @@\n-    NSK_JVMTI_VERIFY(NSK_CPP_STUB2(Deallocate, pJvmtiEnv, (unsigned char*) szName));\n-    NSK_JVMTI_VERIFY(NSK_CPP_STUB2(Deallocate, pJvmtiEnv, (unsigned char*) szSignature));\n+    NSK_JVMTI_VERIFY(pJvmtiEnv->Deallocate((unsigned char*) szName));\n+    NSK_JVMTI_VERIFY(pJvmtiEnv->Deallocate((unsigned char*) szSignature));\n@@ -114,1 +114,1 @@\n-    if ( ! NSK_JVMTI_VERIFY(NSK_CPP_STUB3(GetThreadLocalStorage, pJvmtiEnv, thread, &tls)) )\n+    if ( ! NSK_JVMTI_VERIFY(pJvmtiEnv->GetThreadLocalStorage(thread, &tls)) )\n@@ -123,1 +123,1 @@\n-        if ( ! NSK_JVMTI_VERIFY(NSK_CPP_STUB3(SetThreadLocalStorage, pJvmtiEnv, thread, tls)) )\n+        if ( ! NSK_JVMTI_VERIFY(pJvmtiEnv->SetThreadLocalStorage(thread, tls)) )\n","filename":"test\/hotspot\/jtreg\/vmTestbase\/vm\/mlvm\/share\/mlvmJvmtiUtils.cpp","additions":12,"deletions":12,"binary":false,"changes":24,"status":"modified"},{"patch":"@@ -59,1 +59,1 @@\n-            (classDef.class_byte_count = \/* jsize *\/ NSK_CPP_STUB2(GetArrayLength, env, bytecodeArray)) > 0)) {\n+            (classDef.class_byte_count = \/* jsize *\/ env->GetArrayLength(bytecodeArray)) > 0)) {\n@@ -64,1 +64,1 @@\n-            (classDef.class_bytes = (const unsigned char *) \/* jbyte* *\/ NSK_CPP_STUB3(GetByteArrayElements, env, bytecodeArray, NULL)) != NULL)) {\n+            (classDef.class_bytes = (const unsigned char *) \/* jbyte* *\/ env->GetByteArrayElements(bytecodeArray, NULL)) != NULL)) {\n@@ -69,1 +69,1 @@\n-            NSK_CPP_STUB3(RedefineClasses, test_jvmti, 1, &classDef))) {\n+            test_jvmti->RedefineClasses(1, &classDef))) {\n@@ -75,1 +75,1 @@\n-            NSK_CPP_STUB4(ReleaseByteArrayElements, env, bytecodeArray, (jbyte*)classDef.class_bytes, JNI_ABORT))) {\n+            env->ReleaseByteArrayElements(bytecodeArray, (jbyte*)classDef.class_bytes, JNI_ABORT))) {\n@@ -94,2 +94,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(AddCapabilities,\n-            test_jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(test_jvmti->AddCapabilities(&caps)))\n@@ -98,2 +97,1 @@\n-    if (!NSK_JVMTI_VERIFY(NSK_CPP_STUB2(GetCapabilities,\n-            test_jvmti, &caps)))\n+    if (!NSK_JVMTI_VERIFY(test_jvmti->GetCapabilities(&caps)))\n","filename":"test\/hotspot\/jtreg\/vmTestbase\/vm\/runtime\/defmeth\/shared\/redefineClasses.cpp","additions":6,"deletions":8,"binary":false,"changes":14,"status":"modified"}]}