{"files":[{"patch":"@@ -89,17 +89,0 @@\n-\n-\/* DEBUG -- to check if the threads taking turns in right order\n-        boolean race = false;\n-        for (int i = 1; i < 2*tc04t001Thread.INCREMENT_LIMIT; i++) {\n-             if (tc04t001Thread.passOrder[i] == tc04t001Thread.passOrder[i-1]) {\n-                race = true;\n-                System.out.println(\"Race condition in the test:\");\n-                System.out.println(\"passOrder[\" + (i-1) + \"]:\"\n-                    + tc04t001Thread.passOrder[i-1]);\n-                System.out.println(\"passOrder[\" + (i) + \"]:\"\n-                    + tc04t001Thread.passOrder[i]);\n-             }\n-        }\n-        if (race)\n-            System.out.println(\"There was a race condition in the test.\");\n-*\/\n-\n@@ -120,5 +103,0 @@\n-\/* DEBUG -- to check if the threads taking turns in right order\n-    static volatile int iter = 0;\n-    static volatile int passOrder[] =\n-        new int[INCREMENT_LIMIT*tc04t001.THREADS_LIMIT];\n-*\/\n@@ -138,1 +116,0 @@\n-            lastEnterEventsCount = enterEventsCount();\n@@ -148,3 +125,0 @@\n-\/* DEBUG -- to check if the threads taking turns in right order\n-        passOrder[iter++] = i;\n-*\/\n@@ -153,0 +127,1 @@\n+        boolean done = false;\n@@ -161,0 +136,4 @@\n+            done = (tc04t001.threadsDoneSignal.getCount() == 1);\n+            if (done) {\n+                break; \/\/ This thread is the only remaining thread, no more contention\n+            }\n@@ -162,0 +141,1 @@\n+                System.out.println(\"Thread-\" + i + \": increment event: \" + enterEventsCount());\n@@ -165,1 +145,0 @@\n-        System.out.println(\"Thread-\" + i + \": increment event: \" + enterEventsCount());\n@@ -167,1 +146,1 @@\n-        if (enterEventsCount() == lastEnterEventsCount) {\n+        if (!done && enterEventsCount() == lastEnterEventsCount) {\n@@ -172,0 +151,1 @@\n+        lastEnterEventsCount = enterEventsCount();\n","filename":"test\/hotspot\/jtreg\/vmTestbase\/nsk\/jvmti\/scenarios\/contention\/TC04\/tc04t001.java","additions":8,"deletions":28,"binary":false,"changes":36,"status":"modified"}]}