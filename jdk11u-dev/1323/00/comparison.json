{"files":[{"patch":"@@ -41,1 +41,0 @@\n-  BUNDLE_ID := $(MACOSX_BUNDLE_ID_BASE).$(VERSION_SHORT)\n@@ -44,2 +43,0 @@\n-  BUNDLE_PLATFORM_VERSION := $(VERSION_FEATURE).$(VERSION_INTERIM)\n-  BUNDLE_VERSION := $(VERSION_NUMBER)\n@@ -78,1 +75,1 @@\n-          @@ID@@ => $(BUNDLE_ID).jdk ; \\\n+          @@ID@@ => $(MACOSX_BUNDLE_ID_BASE).jdk ; \\\n@@ -81,3 +78,4 @@\n-          @@PLATFORM_VERSION@@ => $(BUNDLE_PLATFORM_VERSION) ; \\\n-          @@VERSION@@ => $(BUNDLE_VERSION) ; \\\n-          @@VENDOR@@ => $(BUNDLE_VENDOR) , \\\n+          @@VERSION@@ => $(VERSION_NUMBER) ; \\\n+          @@BUILD_VERSION@@ => $(MACOSX_BUNDLE_BUILD_VERSION) ; \\\n+          @@VENDOR@@ => $(BUNDLE_VENDOR) ; \\\n+          @@MACOSX_VERSION_MIN@@ => $(MACOSX_VERSION_MIN) , \\\n@@ -90,1 +88,1 @@\n-          @@ID@@ => $(BUNDLE_ID).jre ; \\\n+          @@ID@@ => $(MACOSX_BUNDLE_ID_BASE).jre ; \\\n@@ -93,3 +91,4 @@\n-          @@PLATFORM_VERSION@@ => $(BUNDLE_PLATFORM_VERSION) ; \\\n-          @@VERSION@@ => $(BUNDLE_VERSION) ; \\\n-          @@VENDOR@@ => $(BUNDLE_VENDOR) , \\\n+          @@VERSION@@ => $(VERSION_NUMBER) ; \\\n+          @@BUILD_VERSION@@ => $(BUNDLE_BUILD_VERSION) ; \\\n+          @@VENDOR@@ => $(BUNDLE_VENDOR) ; \\\n+          @@MACOSX_VERSION_MIN@@ => $(MACOSX_VERSION_MIN) , \\\n","filename":"make\/MacBundles.gmk","additions":10,"deletions":11,"binary":false,"changes":21,"status":"modified"},{"patch":"@@ -79,28 +79,0 @@\n-  # Set the MACOSX Bundle Name base\n-  AC_ARG_WITH(macosx-bundle-name-base, [AS_HELP_STRING([--with-macosx-bundle-name-base],\n-      [Set the MacOSX Bundle Name base. This is the base name for calculating MacOSX Bundle Names.\n-      @<:@not specified@:>@])])\n-  if test \"x$with_macosx_bundle_name_base\" = xyes; then\n-    AC_MSG_ERROR([--with-macosx-bundle-name-base must have a value])\n-  elif [ ! [[ $with_macosx_bundle_name_base =~ ^[[:print:]]*$ ]] ]; then\n-    AC_MSG_ERROR([--with-macosx-bundle-name-base contains non-printing characters: $with_macosx_bundle_name_base])\n-  elif test \"x$with_macosx_bundle_name_base\" != x; then\n-    # Set MACOSX_BUNDLE_NAME_BASE to the configured value.\n-    MACOSX_BUNDLE_NAME_BASE=\"$with_macosx_bundle_name_base\"\n-  fi\n-  AC_SUBST(MACOSX_BUNDLE_NAME_BASE)\n-\n-  # Set the MACOSX Bundle ID base\n-  AC_ARG_WITH(macosx-bundle-id-base, [AS_HELP_STRING([--with-macosx-bundle-id-base],\n-      [Set the MacOSX Bundle ID base. This is the base ID for calculating MacOSX Bundle IDs.\n-      @<:@not specified@:>@])])\n-  if test \"x$with_macosx_bundle_id_base\" = xyes; then\n-    AC_MSG_ERROR([--with-macosx-bundle-id-base must have a value])\n-  elif [ ! [[ $with_macosx_bundle_id_base =~ ^[[:print:]]*$ ]] ]; then\n-    AC_MSG_ERROR([--with-macosx-bundle-id-base contains non-printing characters: $with_macosx_bundle_id_base])\n-  elif test \"x$with_macosx_bundle_id_base\" != x; then\n-    # Set MACOSX_BUNDLE_ID_BASE to the configured value.\n-    MACOSX_BUNDLE_ID_BASE=\"$with_macosx_bundle_id_base\"\n-  fi\n-  AC_SUBST(MACOSX_BUNDLE_ID_BASE)\n-\n@@ -514,0 +486,54 @@\n+  # Set the MACOSX Bundle Name base\n+  AC_ARG_WITH(macosx-bundle-name-base, [AS_HELP_STRING([--with-macosx-bundle-name-base],\n+      [Set the MacOSX Bundle Name base. This is the base name for calculating MacOSX Bundle Names.\n+      @<:@not specified@:>@])])\n+  if test \"x$with_macosx_bundle_name_base\" = xyes; then\n+    AC_MSG_ERROR([--with-macosx-bundle-name-base must have a value])\n+  elif [ ! [[ $with_macosx_bundle_name_base =~ ^[[:print:]]*$ ]] ]; then\n+    AC_MSG_ERROR([--with-macosx-bundle-name-base contains non-printing characters: $with_macosx_bundle_name_base])\n+  elif test \"x$with_macosx_bundle_name_base\" != x; then\n+    # Set MACOSX_BUNDLE_NAME_BASE to the configured value.\n+    MACOSX_BUNDLE_NAME_BASE=\"$with_macosx_bundle_name_base\"\n+  fi\n+  AC_SUBST(MACOSX_BUNDLE_NAME_BASE)\n+\n+  # Set the MACOSX Bundle ID base\n+  AC_ARG_WITH(macosx-bundle-id-base, [AS_HELP_STRING([--with-macosx-bundle-id-base],\n+      [Set the MacOSX Bundle ID base. This is the base ID for calculating MacOSX Bundle IDs.\n+      @<:@not specified@:>@])])\n+  if test \"x$with_macosx_bundle_id_base\" = xyes; then\n+    AC_MSG_ERROR([--with-macosx-bundle-id-base must have a value])\n+  elif [ ! [[ $with_macosx_bundle_id_base =~ ^[[:print:]]*$ ]] ]; then\n+    AC_MSG_ERROR([--with-macosx-bundle-id-base contains non-printing characters: $with_macosx_bundle_id_base])\n+  elif test \"x$with_macosx_bundle_id_base\" != x; then\n+    # Set MACOSX_BUNDLE_ID_BASE to the configured value.\n+    MACOSX_BUNDLE_ID_BASE=\"$with_macosx_bundle_id_base\"\n+  else\n+    # If using the default value, append the VERSION_PRE if there is one\n+    # to make it possible to tell official builds apart from developer builds\n+    if test \"x$VERSION_PRE\" != x; then\n+      MACOSX_BUNDLE_ID_BASE=\"$MACOSX_BUNDLE_ID_BASE-$VERSION_PRE\"\n+    fi\n+  fi\n+  AC_SUBST(MACOSX_BUNDLE_ID_BASE)\n+\n+  # Set the MACOSX CFBundleVersion field\n+  AC_ARG_WITH(macosx-bundle-build-version, [AS_HELP_STRING([--with-macosx-bundle-build-version],\n+      [Set the MacOSX Bundle CFBundleVersion field. This key is a machine-readable\n+      string composed of one to three period-separated integers and should represent the\n+      build version. Defaults to the build number.])])\n+  if test \"x$with_macosx_bundle_build_version\" = xyes; then\n+    AC_MSG_ERROR([--with-macosx-bundle-build-version must have a value])\n+  elif [ ! [[ $with_macosx_bundle_build_version =~ ^[0-9\\.]*$ ]] ]; then\n+    AC_MSG_ERROR([--with-macosx-bundle-build-version contains non numbers and periods: $with_macosx_bundle_build_version])\n+  elif test \"x$with_macosx_bundle_build_version\" != x; then\n+    MACOSX_BUNDLE_BUILD_VERSION=\"$with_macosx_bundle_build_version\"\n+  else\n+    MACOSX_BUNDLE_BUILD_VERSION=\"$VERSION_BUILD\"\n+    # If VERSION_OPT consists of only numbers and periods, add it.\n+    if [ [[ $VERSION_OPT =~ ^[0-9\\.]+$ ]] ]; then\n+      MACOSX_BUNDLE_BUILD_VERSION+=\".$VERSION_OPT\"\n+    fi\n+  fi\n+  AC_SUBST(MACOSX_BUNDLE_BUILD_VERSION)\n+\n","filename":"make\/autoconf\/jdk-version.m4","additions":54,"deletions":28,"binary":false,"changes":82,"status":"modified"},{"patch":"@@ -172,0 +172,1 @@\n+MACOSX_BUNDLE_BUILD_VERSION=@MACOSX_BUNDLE_BUILD_VERSION@\n","filename":"make\/autoconf\/spec.gmk.in","additions":1,"deletions":0,"binary":false,"changes":1,"status":"modified"},{"patch":"@@ -1185,1 +1185,1 @@\n-        var optString = input.build_id_data.ciBuildNumber;\n+        var ciBuildNumber = input.build_id_data.ciBuildNumber;\n@@ -1191,1 +1191,5 @@\n-                     \"--with-version-opt=\" + optString);\n+                      \"--with-version-opt=\" + ciBuildNumber);\n+        if (input.target_os == \"macosx\") {\n+            args = concat(args, \"--with-macosx-bundle-build-version=\"\n+                          + common.build_number + \".\" + ciBuildNumber);\n+        }\n","filename":"make\/conf\/jib-profiles.js","additions":6,"deletions":2,"binary":false,"changes":8,"status":"modified"},{"patch":"@@ -20,1 +20,1 @@\n-        <string>1.0<\/string>\n+        <string>@@VERSION@@<\/string>\n@@ -24,1 +24,1 @@\n-        <string>@@VERSION@@<\/string>\n+        <string>@@BUILD_VERSION@@<\/string>\n@@ -36,1 +36,1 @@\n-                <string>10.6.0<\/string>\n+                <string>@@MACOSX_VERSION_MIN@@<\/string>\n@@ -38,1 +38,1 @@\n-                <string>@@PLATFORM_VERSION@@<\/string>\n+                <string>@@VERSION@@<\/string>\n","filename":"make\/data\/bundle\/JDK-Info.plist","additions":4,"deletions":4,"binary":false,"changes":8,"status":"modified"},{"patch":"@@ -20,1 +20,1 @@\n-        <string>1.0<\/string>\n+        <string>@@VERSION@@<\/string>\n@@ -24,1 +24,1 @@\n-        <string>@@VERSION@@<\/string>\n+        <string>@@BUILD_VERSION@@<\/string>\n@@ -32,1 +32,1 @@\n-                <string>10.6.0<\/string>\n+                <string>@@MACOSX_VERSION_MIN@@<\/string>\n@@ -34,1 +34,1 @@\n-                <string>@@PLATFORM_VERSION@@<\/string>\n+                <string>@@VERSION@@<\/string>\n","filename":"make\/data\/bundle\/JRE-Info.plist","additions":4,"deletions":4,"binary":false,"changes":8,"status":"modified"},{"patch":"@@ -10,2 +10,0 @@\n-        <string>1.0<\/string>\n-        <key>CFBundleVersion<\/key>\n@@ -13,0 +11,2 @@\n+        <key>CFBundleVersion<\/key>\n+        <string>@@BUILD_VERSION@@<\/string>\n@@ -15,0 +15,1 @@\n+        @@EXTRA@@\n","filename":"make\/data\/bundle\/cmdline-Info.plist","additions":3,"deletions":2,"binary":false,"changes":5,"previous_filename":"src\/java.base\/macosx\/native\/launcher\/Info-cmdline.plist","status":"renamed"},{"patch":"@@ -122,3 +122,1 @@\n-      $1_PLIST_SRC_FILE := Info-privileged.plist\n-    else\n-      $1_PLIST_SRC_FILE := Info-cmdline.plist\n+      $1_PLIST_EXTRA := <key>SecTaskAccess<\/key><string>allowed<\/string>\n@@ -132,1 +130,1 @@\n-        SOURCE_FILES := $$(TOPDIR)\/src\/java.base\/macosx\/native\/launcher\/$$($1_PLIST_SRC_FILE), \\\n+        SOURCE_FILES := $(TOPDIR)\/make\/data\/bundle\/cmdline-Info.plist, \\\n@@ -135,1 +133,1 @@\n-            @@ID@@ => $(MACOSX_BUNDLE_ID_BASE).$(VERSION_SHORT).$1 ; \\\n+            @@ID@@ => $(MACOSX_BUNDLE_ID_BASE).$1 ; \\\n@@ -137,0 +135,2 @@\n+            @@BUILD_VERSION@@ => $(MACOSX_BUNDLE_BUILD_VERSION) ; \\\n+            @@EXTRA@@ => $$($1_PLIST_EXTRA), \\\n@@ -218,0 +218,4 @@\n+\n+  ifeq ($(call isTargetOs, macosx), true)\n+    $$(BUILD_LAUNCHER_$1): $$($1_PLIST_FILE)\n+  endif\n","filename":"make\/launcher\/LauncherCommon.gmk","additions":9,"deletions":5,"binary":false,"changes":14,"status":"modified"},{"patch":"@@ -1,18 +0,0 @@\n-<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n-<!DOCTYPE plist PUBLIC \"-\/\/Apple\/\/DTD PLIST 1.0\/\/EN\" \"http:\/\/www.apple.com\/DTDs\/PropertyList-1.0.dtd\">\n-<plist version=\"1.0\">\n-<dict>\n-        <key>CFBundleIdentifier<\/key>\n-        <string>@@ID@@<\/string>\n-        <key>CFBundleInfoDictionaryVersion<\/key>\n-        <string>6.0<\/string>\n-        <key>CFBundleName<\/key>\n-        <string>OpenJDK Command<\/string>\n-        <key>CFBundleShortVersionString<\/key>\n-        <string>1.0<\/string>\n-        <key>CFBundleVersion<\/key>\n-        <string>@@VERSION@@<\/string>\n-        <key>SecTaskAccess<\/key>\n-        <string>allowed<\/string>\n-<\/dict>\n-<\/plist>\n","filename":"src\/java.base\/macosx\/native\/launcher\/Info-privileged.plist","additions":0,"deletions":18,"binary":false,"changes":18,"status":"deleted"}]}