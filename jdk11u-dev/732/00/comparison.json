{"files":[{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 1996, 2019, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 1996, 2021, Oracle and\/or its affiliates. All rights reserved.\n@@ -50,0 +50,1 @@\n+#include \"math.h\"\n@@ -2237,2 +2238,2 @@\n-    DWORD i;\n-    for (i = 0; i < rgndata->rdh.nCount; i++, r++) {\n+        DWORD i;\n+        for (i = 0; i < rgndata->rdh.nCount; i++, r++) {\n@@ -2250,0 +2251,9 @@\n+        \/\/ The Windows may request to update the small region of pixels that\n+        \/\/ cannot be represented in the user's space, in this case, we will\n+        \/\/ request to repaint the smallest non-empty bounding box in the user's\n+        \/\/ space\n+        int screen = GetScreenImOn();\n+        Devices::InstanceAccess devices;\n+        AwtWin32GraphicsDevice* device = devices->GetDevice(screen);\n+        float scaleX = (device == NULL) ? 1 : device->GetScaleX();\n+        float scaleY = (device == NULL) ? 1 : device->GetScaleY();\n@@ -2252,5 +2262,5 @@\n-                DoCallback(\"handleExpose\", \"(IIII)V\",\n-                           ScaleDownX(un[i]->left),\n-                           ScaleDownY(un[i]->top),\n-                           ScaleDownX(un[i]->right - un[i]->left),\n-                           ScaleDownY(un[i]->bottom - un[i]->top));\n+                int x1 = floor(un[i]->left \/ scaleX);\n+                int y1 = floor(un[i]->top \/ scaleY);\n+                int x2 = ceil(un[i]->right \/ scaleX);\n+                int y2 = ceil(un[i]->bottom  \/ scaleY);\n+                DoCallback(\"handleExpose\", \"(IIII)V\", x1, y1, x2 - x1, y2 - y1);\n","filename":"src\/java.desktop\/windows\/native\/libawt\/windows\/awt_Component.cpp","additions":18,"deletions":8,"binary":false,"changes":26,"status":"modified"},{"patch":"@@ -56,1 +56,1 @@\n- * @bug 8147440 8147016\n+ * @bug 8147440 8147016 8270874\n","filename":"test\/jdk\/java\/awt\/Window\/WindowResizingOnDPIChanging\/WindowResizingOnMovingToAnotherDisplay.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"}]}