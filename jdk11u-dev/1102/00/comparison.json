{"files":[{"patch":"@@ -442,2 +442,2 @@\n-  if (PrintIdealGraphLevel > 0) {\n-    FLAG_SET_ERGO(bool, PrintIdealGraph, true);\n+  if (FLAG_IS_CMDLINE(PrintIdealGraph) && !PrintIdealGraph) {\n+    FLAG_SET_ERGO(intx, PrintIdealGraphLevel, -1);\n","filename":"src\/hotspot\/share\/compiler\/compilerDefinitions.cpp","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -377,1 +377,3 @@\n-          \"System-wide value, 0=nothing is printed, 4=all details printed. \"\\\n+          \"System-wide value, -1=printing is disabled, \"                    \\\n+          \"0=print nothing except IGVPrintLevel directives, \"               \\\n+          \"4=all details printed. \"                                         \\\n@@ -380,1 +382,1 @@\n-          range(0, 4)                                                       \\\n+          range(-1, 4)                                                      \\\n","filename":"src\/hotspot\/share\/opto\/c2_globals.hpp","additions":4,"deletions":2,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -686,1 +686,0 @@\n-                  _printer(IdealGraphPrinter::printer()),\n@@ -688,0 +687,1 @@\n+                  NOT_PRODUCT(_printer(NULL) COMMA)\n@@ -709,5 +709,0 @@\n-#ifndef PRODUCT\n-  if (_printer != NULL) {\n-    _printer->set_compile(this);\n-  }\n-#endif\n@@ -872,1 +867,1 @@\n-  if (_printer && _printer->should_print(1)) {\n+  if (should_print(1)) {\n@@ -1005,1 +1000,0 @@\n-    _printer(NULL),\n@@ -1007,0 +1001,1 @@\n+    NOT_PRODUCT(_printer(NULL) COMMA)\n","filename":"src\/hotspot\/share\/opto\/compile.cpp","additions":3,"deletions":8,"binary":false,"changes":11,"status":"modified"},{"patch":"@@ -748,1 +748,1 @@\n-  void begin_method() {\n+  void begin_method(int level = 1) {\n@@ -750,1 +750,1 @@\n-    if (_printer && _printer->should_print(1)) {\n+    if (_method != NULL && should_print(level)) {\n@@ -757,0 +757,18 @@\n+  bool should_print(int level = 1) {\n+#ifndef PRODUCT\n+    if (PrintIdealGraphLevel < 0) { \/\/ disabled by the user\n+      return false;\n+    }\n+\n+    bool need = directive()->IGVPrintLevelOption >= level;\n+    if (need && !_printer) {\n+      _printer = IdealGraphPrinter::printer();\n+      assert(_printer != NULL, \"_printer is NULL when we need it!\");\n+      _printer->set_compile(this);\n+    }\n+    return need;\n+#else\n+    return false;\n+#endif\n+  }\n+\n@@ -769,1 +787,1 @@\n-    if (_printer && _printer->should_print(level)) {\n+    if (_printer && should_print(level)) {\n@@ -786,1 +804,1 @@\n-    if (_printer && _printer->should_print(level)) {\n+    if (_printer && should_print(level)) {\n","filename":"src\/hotspot\/share\/opto\/compile.hpp","additions":22,"deletions":4,"binary":false,"changes":26,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2007, 2018, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2007, 2020, Oracle and\/or its affiliates. All rights reserved.\n@@ -78,4 +78,0 @@\n-  if (!PrintIdealGraph) {\n-    return NULL;\n-  }\n-\n@@ -673,1 +669,1 @@\n-  if (!_current_method || !_should_send_method || !should_print(level)) return;\n+  if (!_current_method || !_should_send_method || !C->should_print(level)) return;\n@@ -723,5 +719,0 @@\n-\/\/ Should method be printed?\n-bool IdealGraphPrinter::should_print(int level) {\n-  return C->directive()->IGVPrintLevelOption >= level;\n-}\n-\n","filename":"src\/hotspot\/share\/opto\/idealGraphPrinter.cpp","additions":2,"deletions":11,"binary":false,"changes":13,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2007, 2015, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2007, 2020, Oracle and\/or its affiliates. All rights reserved.\n@@ -136,1 +136,0 @@\n-  bool should_print(int level);\n","filename":"src\/hotspot\/share\/opto\/idealGraphPrinter.hpp","additions":1,"deletions":2,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 1998, 2018, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 1998, 2020, Oracle and\/or its affiliates. All rights reserved.\n@@ -2858,2 +2858,2 @@\n-  IdealGraphPrinter *printer = C->printer();\n-  if (printer && printer->should_print(1)) {\n+  if (C->should_print(1)) {\n+    IdealGraphPrinter* printer = C->printer();\n","filename":"src\/hotspot\/share\/opto\/parse2.cpp","additions":3,"deletions":3,"binary":false,"changes":6,"status":"modified"}]}