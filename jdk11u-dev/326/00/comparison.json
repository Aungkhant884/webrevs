{"files":[{"patch":"@@ -4259,1 +4259,1 @@\n-    thread->cleanup_failed_attach_current_thread();\n+    thread->cleanup_failed_attach_current_thread(daemon);\n","filename":"src\/hotspot\/share\/prims\/jni.cpp","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -2002,0 +2002,4 @@\n+\n+  \/\/ Capture daemon status before the thread is marked as terminated.\n+  bool daemon = is_daemon(threadObj());\n+\n@@ -2075,1 +2079,1 @@\n-  Threads::remove(this);\n+  Threads::remove(this, daemon);\n@@ -2093,1 +2097,1 @@\n-void JavaThread::cleanup_failed_attach_current_thread() {\n+void JavaThread::cleanup_failed_attach_current_thread(bool is_daemon) {\n@@ -2115,1 +2119,1 @@\n-  Threads::remove(this);\n+  Threads::remove(this, is_daemon);\n@@ -4443,1 +4447,1 @@\n-void Threads::remove(JavaThread* p) {\n+void Threads::remove(JavaThread* p, bool is_daemon) {\n@@ -4472,3 +4476,1 @@\n-    oop threadObj = p->threadObj();\n-    bool daemon = true;\n-    if (!is_daemon(threadObj)) {\n+    if (!is_daemon) {\n@@ -4476,1 +4478,0 @@\n-      daemon = false;\n@@ -4484,1 +4485,1 @@\n-    ThreadService::remove_thread(p, daemon);\n+    ThreadService::remove_thread(p, is_daemon);\n","filename":"src\/hotspot\/share\/runtime\/thread.cpp","additions":10,"deletions":9,"binary":false,"changes":19,"status":"modified"},{"patch":"@@ -1182,1 +1182,1 @@\n-  void cleanup_failed_attach_current_thread();\n+  void cleanup_failed_attach_current_thread(bool is_daemon);\n@@ -2175,1 +2175,1 @@\n-  static void remove(JavaThread* p);\n+  static void remove(JavaThread* p, bool is_daemon);\n","filename":"src\/hotspot\/share\/runtime\/thread.hpp","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -61,1 +61,1 @@\n-    Threads::remove(this);\n+    Threads::remove(this, false);\n@@ -102,1 +102,1 @@\n-    Threads::remove(this);\n+    Threads::remove(this, false);\n","filename":"test\/hotspot\/gtest\/utilities\/utilitiesHelper.inline.hpp","additions":2,"deletions":2,"binary":false,"changes":4,"status":"modified"}]}