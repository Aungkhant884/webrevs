{"files":[{"patch":"@@ -36,0 +36,1 @@\n+import jdk.javadoc.internal.doclets.formats.html.markup.ContentBuilder;\n@@ -84,1 +85,1 @@\n-     * @param body the document tree to which the navigation bar header will be added\n+     * @param header the document tree to which the navigation bar header will be added\n@@ -86,1 +87,1 @@\n-    protected abstract void addNavigationBarHeader(Content body);\n+    protected abstract void addNavigationBarHeader(Content header);\n@@ -91,1 +92,1 @@\n-     * @param body the document tree to which the navigation bar footer will be added\n+     * @param footer the document tree to which the navigation bar footer will be added\n@@ -93,1 +94,1 @@\n-    protected abstract void addNavigationBarFooter(Content body);\n+    protected abstract void addNavigationBarFooter(Content footer);\n@@ -98,1 +99,1 @@\n-     * @param body the document tree to which the overview header will be added\n+     * @param main the document tree to which the overview header will be added\n@@ -100,1 +101,1 @@\n-    protected abstract void addOverviewHeader(Content body);\n+    protected abstract void addOverviewHeader(Content main);\n@@ -105,1 +106,1 @@\n-     * @param body the document tree to which the modules list will be added\n+     * @param main the document tree to which the modules list will be added\n@@ -107,1 +108,1 @@\n-    protected abstract void addModulesList(Content body);\n+    protected abstract void addModulesList(Content main);\n@@ -115,1 +116,1 @@\n-     * @param body the document tree to which the modules list will be added\n+     * @param main the document tree to which the modules list will be added\n@@ -119,1 +120,1 @@\n-            String tableSummary, Content body, ModuleElement mdle);\n+            String tableSummary, Content main, ModuleElement mdle);\n@@ -133,5 +134,11 @@\n-        addNavigationBarHeader(body);\n-        addOverviewHeader(body);\n-        addIndex(body);\n-        addOverview(body);\n-        addNavigationBarFooter(body);\n+        Content header = createTagIfAllowed(HtmlTag.HEADER, HtmlTree::HEADER, ContentBuilder::new);\n+        addNavigationBarHeader(header);\n+        Content main = createTagIfAllowed(HtmlTag.MAIN, HtmlTree::MAIN, ContentBuilder::new);\n+        addOverviewHeader(main);\n+        addIndex(header, main);\n+        addOverview(main);\n+        Content footer = createTagIfAllowed(HtmlTag.FOOTER, HtmlTree::FOOTER, ContentBuilder::new);\n+        addNavigationBarFooter(footer);\n+        body.addContent(header);\n+        body.addContent(main);\n+        body.addContent(footer);\n@@ -156,5 +163,11 @@\n-        addNavigationBarHeader(body);\n-        addOverviewHeader(body);\n-        addModulePackagesIndex(body, mdle);\n-        addOverview(body);\n-        addNavigationBarFooter(body);\n+        Content header = createTagIfAllowed(HtmlTag.HEADER, HtmlTree::HEADER, ContentBuilder::new);\n+        addNavigationBarHeader(header);\n+        Content main = createTagIfAllowed(HtmlTag.MAIN, HtmlTree::MAIN, ContentBuilder::new);\n+        addOverviewHeader(main);\n+        addModulePackagesIndex(header, main, mdle);\n+        addOverview(main);\n+        Content footer = createTagIfAllowed(HtmlTag.FOOTER, HtmlTree::FOOTER, ContentBuilder::new);\n+        addNavigationBarFooter(footer);\n+        body.addContent(header);\n+        body.addContent(main);\n+        body.addContent(footer);\n@@ -168,1 +181,1 @@\n-     * @param body the document tree to which the overview will be added\n+     * @param main the document tree to which the overview will be added\n@@ -170,1 +183,1 @@\n-    protected void addOverview(Content body) { }\n+    protected void addOverview(Content main) { }\n@@ -175,1 +188,2 @@\n-     * @param body the document tree to which the index will be added\n+     * @param header the document tree to which the navigational links will be added\n+     * @param main the document tree to which the modules list will be added\n@@ -177,1 +191,1 @@\n-    protected void addIndex(Content body) {\n+    protected void addIndex(Content header, Content main) {\n@@ -181,1 +195,1 @@\n-                configuration.getText(\"doclet.modules\")), body);\n+                configuration.getText(\"doclet.modules\")), header, main);\n@@ -187,1 +201,2 @@\n-     * @param body the document tree to which the index will be added\n+     * @param header the document tree to which the navigational links will be added\n+     * @param main the document tree to which the module packages list will be added\n@@ -190,1 +205,1 @@\n-    protected void addModulePackagesIndex(Content body, ModuleElement mdle) {\n+    protected void addModulePackagesIndex(Content header, Content main, ModuleElement mdle) {\n@@ -194,1 +209,1 @@\n-                configuration.getText(\"doclet.modules\")), body, mdle);\n+                configuration.getText(\"doclet.modules\")), header, main, mdle);\n@@ -204,1 +219,2 @@\n-     * @param body the document tree to which the index contents will be added\n+     * @param header the document tree to which the navgational links will be added\n+     * @param main the document tree to which the modules list will be added\n@@ -207,4 +223,2 @@\n-            String tableSummary, Content body) {\n-        HtmlTree htmlTree = (configuration.allowTag(HtmlTag.NAV))\n-                ? HtmlTree.NAV()\n-                : new HtmlTree(HtmlTag.DIV);\n+            String tableSummary, Content header, Content main) {\n+        HtmlTree htmlTree = (HtmlTree)createTagIfAllowed(HtmlTag.NAV, HtmlTree::NAV, () -> new HtmlTree(HtmlTag.DIV));\n@@ -216,2 +230,2 @@\n-        body.addContent(htmlTree);\n-        addModulesList(body);\n+        header.addContent(htmlTree);\n+        addModulesList(main);\n@@ -226,1 +240,2 @@\n-     * @param body the document tree to which the index contents will be added\n+     * @param header the document tree to which the navigational links will be added\n+     * @param main the document tree to which the module packages list will be added\n@@ -230,4 +245,2 @@\n-            String tableSummary, Content body, ModuleElement mdle) {\n-        HtmlTree htmlTree = (configuration.allowTag(HtmlTag.NAV))\n-                ? HtmlTree.NAV()\n-                : new HtmlTree(HtmlTag.DIV);\n+            String tableSummary, Content header, Content main, ModuleElement mdle) {\n+        HtmlTree htmlTree = (HtmlTree)createTagIfAllowed(HtmlTag.NAV, HtmlTree::NAV, () -> new HtmlTree(HtmlTag.DIV));\n@@ -240,2 +253,2 @@\n-        body.addContent(htmlTree);\n-        addModulePackagesList(modules, text, tableSummary, body, mdle);\n+        header.addContent(htmlTree);\n+        addModulePackagesList(modules, text, tableSummary, main, mdle);\n","filename":"src\/jdk.javadoc\/share\/classes\/jdk\/javadoc\/internal\/doclets\/formats\/html\/AbstractModuleIndexWriter.java","additions":55,"deletions":42,"binary":false,"changes":97,"status":"modified"},{"patch":"@@ -32,0 +32,1 @@\n+import jdk.javadoc.internal.doclets.formats.html.markup.ContentBuilder;\n@@ -81,1 +82,1 @@\n-     * @param body the document tree to which the navigation bar header will be added\n+     * @param header the document tree to which the navigation bar header will be added\n@@ -83,1 +84,1 @@\n-    protected abstract void addNavigationBarHeader(Content body);\n+    protected abstract void addNavigationBarHeader(Content header);\n@@ -95,1 +96,1 @@\n-     * @param body the document tree to which the overview header will be added\n+     * @param footer the document tree to which the overview header will be added\n@@ -97,1 +98,1 @@\n-    protected abstract void addOverviewHeader(Content body);\n+    protected abstract void addOverviewHeader(Content footer);\n@@ -102,1 +103,1 @@\n-     * @param body the document tree to which the packages list will be added\n+     * @param main the document tree to which the packages list will be added\n@@ -104,1 +105,1 @@\n-    protected abstract void addPackagesList(Content body);\n+    protected abstract void addPackagesList(Content main);\n@@ -118,5 +119,11 @@\n-        addNavigationBarHeader(body);\n-        addOverviewHeader(body);\n-        addIndex(body);\n-        addOverview(body);\n-        addNavigationBarFooter(body);\n+        Content header = createTagIfAllowed(HtmlTag.HEADER, HtmlTree::HEADER, ContentBuilder::new);\n+        addNavigationBarHeader(header);\n+        Content main = createTagIfAllowed(HtmlTag.MAIN, HtmlTree::MAIN, ContentBuilder::new);\n+        addOverviewHeader(main);\n+        addIndex(header, main);\n+        addOverview(main);\n+        Content footer = createTagIfAllowed(HtmlTag.FOOTER, HtmlTree::FOOTER, ContentBuilder::new);\n+        addNavigationBarFooter(footer);\n+        body.addContent(header);\n+        body.addContent(main);\n+        body.addContent(footer);\n@@ -130,1 +137,1 @@\n-     * @param body the document tree to which the overview will be added\n+     * @param main the document tree to which the overview will be added\n@@ -132,1 +139,1 @@\n-    protected void addOverview(Content body) { }\n+    protected void addOverview(Content main) { }\n@@ -137,1 +144,2 @@\n-     * @param body the document tree to which the index will be added\n+     * @param header the document tree to which the navigation links will be added\n+     * @param main the document tree to which the packages list will be added\n@@ -139,2 +147,2 @@\n-    protected void addIndex(Content body) {\n-        addIndexContents(body);\n+    protected void addIndex(Content header, Content main) {\n+        addIndexContents(header, main);\n@@ -147,1 +155,2 @@\n-     * @param body the document tree to which the index contents will be added\n+     * @param header the document tree to which navigation links will be added\n+     * @param main the document tree to which the packages list will be added\n@@ -149,1 +158,1 @@\n-    protected void addIndexContents(Content body) {\n+    protected void addIndexContents(Content header, Content main) {\n@@ -151,3 +160,1 @@\n-            HtmlTree htmlTree = (configuration.allowTag(HtmlTag.NAV))\n-                    ? HtmlTree.NAV()\n-                    : new HtmlTree(HtmlTag.DIV);\n+            HtmlTree htmlTree = (HtmlTree)createTagIfAllowed(HtmlTag.NAV, HtmlTree::NAV, () -> new HtmlTree(HtmlTag.DIV));\n@@ -161,2 +168,2 @@\n-            body.addContent(htmlTree);\n-            addPackagesList(body);\n+            header.addContent(htmlTree);\n+            addPackagesList(main);\n","filename":"src\/jdk.javadoc\/share\/classes\/jdk\/javadoc\/internal\/doclets\/formats\/html\/AbstractPackageIndexWriter.java","additions":30,"deletions":23,"binary":false,"changes":53,"status":"modified"},{"patch":"@@ -32,0 +32,1 @@\n+import jdk.javadoc.internal.doclets.formats.html.markup.ContentBuilder;\n@@ -117,0 +118,1 @@\n+        Content htmlTree = createTagIfAllowed(HtmlTag.MAIN, HtmlTree::MAIN, ContentBuilder::new);\n@@ -119,1 +121,1 @@\n-        body.addContent(heading);\n+        htmlTree.addContent(heading);\n@@ -123,3 +125,2 @@\n-        HtmlTree htmlTree = (configuration.allowTag(HtmlTag.MAIN))\n-                ? HtmlTree.MAIN(HtmlStyle.indexContainer, ul)\n-                : HtmlTree.DIV(HtmlStyle.indexContainer, ul);\n+        HtmlTree div = HtmlTree.DIV(HtmlStyle.indexContainer, ul);\n+        htmlTree.addContent(div);\n","filename":"src\/jdk.javadoc\/share\/classes\/jdk\/javadoc\/internal\/doclets\/formats\/html\/AllClassesFrameWriter.java","additions":5,"deletions":4,"binary":false,"changes":9,"status":"modified"},{"patch":"@@ -32,0 +32,1 @@\n+import java.util.function.Supplier;\n@@ -2096,0 +2097,16 @@\n+\n+    \/**\n+     * Creates the HTML tag if the tag is supported by this specific HTML version\n+     * otherwise return the Content instance provided by Supplier ifNotSupported.\n+     * @param tag the HTML tag\n+     * @param ifSupported create this instance if HTML tag is supported\n+     * @param ifNotSupported create this instance if HTML tag is not supported\n+     * @return\n+     *\/\n+    protected Content createTagIfAllowed(HtmlTag tag, Supplier<Content> ifSupported, Supplier<Content> ifNotSupported) {\n+        if (configuration.allowTag(tag)) {\n+            return ifSupported.get();\n+        } else {\n+            return ifNotSupported.get();\n+        }\n+    }\n","filename":"src\/jdk.javadoc\/share\/classes\/jdk\/javadoc\/internal\/doclets\/formats\/html\/HtmlDocletWriter.java","additions":17,"deletions":0,"binary":false,"changes":17,"status":"modified"},{"patch":"@@ -86,1 +86,1 @@\n-    protected void addModulesList(Content body) {\n+    protected void addModulesList(Content main) {\n@@ -89,3 +89,1 @@\n-        HtmlTree htmlTree = (configuration.allowTag(HtmlTag.MAIN))\n-                ? HtmlTree.MAIN(HtmlStyle.indexContainer, heading)\n-                : HtmlTree.DIV(HtmlStyle.indexContainer, heading);\n+        HtmlTree htmlTree = HtmlTree.DIV(HtmlStyle.indexContainer, heading);\n@@ -98,1 +96,1 @@\n-        body.addContent(htmlTree);\n+        main.addContent(htmlTree);\n@@ -129,1 +127,1 @@\n-    protected void addNavigationBarHeader(Content body) {\n+    protected void addNavigationBarHeader(Content header) {\n@@ -138,1 +136,1 @@\n-        body.addContent(heading);\n+        header.addContent(heading);\n@@ -176,1 +174,1 @@\n-    protected void addNavigationBarFooter(Content body) {\n+    protected void addNavigationBarFooter(Content footer) {\n@@ -178,1 +176,1 @@\n-        body.addContent(p);\n+        footer.addContent(p);\n@@ -182,1 +180,1 @@\n-            String tableSummary, Content body, ModuleElement mdle) {\n+            String tableSummary, Content main, ModuleElement mdle) {\n","filename":"src\/jdk.javadoc\/share\/classes\/jdk\/javadoc\/internal\/doclets\/formats\/html\/ModuleIndexFrameWriter.java","additions":8,"deletions":10,"binary":false,"changes":18,"status":"modified"},{"patch":"@@ -59,5 +59,0 @@\n-    \/**\n-     * HTML tree for main tag.\n-     *\/\n-    private final HtmlTree htmlTree = HtmlTree.MAIN();\n-\n@@ -88,1 +83,2 @@\n-     * @param body the documentation tree to which the index will be added\n+     * @param header the documentation tree to which the navigational links will be added\n+     * @param main the documentation tree to which the modules list will be added\n@@ -91,2 +87,2 @@\n-    protected void addIndex(Content body) {\n-        addIndexContents(body);\n+    protected void addIndex(Content header, Content main) {\n+        addIndexContents(header, main);\n@@ -98,1 +94,2 @@\n-     * @param body the document tree to which the index contents will be added\n+     * @param header the document tree to which the navigational links will be added\n+     * @param main the document tree to which the modules list will be added\n@@ -100,4 +97,2 @@\n-    protected void addIndexContents(Content body) {\n-        HtmlTree htmltree = (configuration.allowTag(HtmlTag.NAV))\n-                ? HtmlTree.NAV()\n-                : new HtmlTree(HtmlTag.DIV);\n+    protected void addIndexContents(Content header, Content main) {\n+        HtmlTree htmltree = (HtmlTree)createTagIfAllowed(HtmlTag.NAV, HtmlTree::NAV, () -> new HtmlTree(HtmlTag.DIV));\n@@ -111,2 +106,2 @@\n-        body.addContent(htmltree);\n-        addModulesList(body);\n+        header.addContent(htmltree);\n+        addModulesList(main);\n@@ -118,1 +113,1 @@\n-     * @param body the content tree to which the module list will be added\n+     * @param main the content tree to which the module list will be added\n@@ -121,1 +116,1 @@\n-    protected void addModulesList(Content body) {\n+    protected void addModulesList(Content main) {\n@@ -157,5 +152,1 @@\n-            if (configuration.allowTag(HtmlTag.MAIN)) {\n-                htmlTree.addContent(div);\n-            } else {\n-                body.addContent(div);\n-            }\n+            main.addContent(div);\n@@ -174,1 +165,1 @@\n-     * @param body the documentation tree to which the overview header will be added\n+     * @param main the documentation tree to which the overview header will be added\n@@ -177,2 +168,2 @@\n-    protected void addOverviewHeader(Content body) {\n-        addConfigurationTitle(body);\n+    protected void addOverviewHeader(Content main) {\n+        addConfigurationTitle(main);\n@@ -183,5 +174,1 @@\n-            if (configuration.allowTag(HtmlTag.MAIN)) {\n-                htmlTree.addContent(div);\n-            } else {\n-                body.addContent(div);\n-            }\n+            main.addContent(div);\n@@ -204,12 +191,0 @@\n-    \/**\n-     * For HTML 5, add the htmlTree to the body. For HTML 4, do nothing.\n-     *\n-     * @param body the documentation tree to which the overview will be added\n-     *\/\n-    @Override\n-    protected void addOverview(Content body) {\n-        if (configuration.allowTag(HtmlTag.MAIN)) {\n-            body.addContent(htmlTree);\n-        }\n-    }\n-\n@@ -221,1 +196,1 @@\n-     * @param body the documentation tree to which the navigation bar header will be added\n+     * @param header the documentation tree to which the navigation bar header will be added\n@@ -224,5 +199,2 @@\n-    protected void addNavigationBarHeader(Content body) {\n-        Content tree = (configuration.allowTag(HtmlTag.HEADER))\n-                ? HtmlTree.HEADER()\n-                : body;\n-        addTop(tree);\n+    protected void addNavigationBarHeader(Content header) {\n+        addTop(header);\n@@ -230,4 +202,1 @@\n-        tree.addContent(navBar.getContent(true));\n-        if (configuration.allowTag(HtmlTag.HEADER)) {\n-            body.addContent(tree);\n-        }\n+        header.addContent(navBar.getContent(true));\n@@ -240,1 +209,1 @@\n-     * @param body the documentation tree to which the navigation bar footer will be added\n+     * @param footer the documentation tree to which the navigation bar footer will be added\n@@ -243,4 +212,1 @@\n-    protected void addNavigationBarFooter(Content body) {\n-        Content htmltree = (configuration.allowTag(HtmlTag.FOOTER))\n-                ? HtmlTree.FOOTER()\n-                : body;\n+    protected void addNavigationBarFooter(Content footer) {\n@@ -248,5 +214,2 @@\n-        htmltree.addContent(navBar.getContent(false));\n-        addBottom(htmltree);\n-        if (configuration.allowTag(HtmlTag.FOOTER)) {\n-            body.addContent(htmltree);\n-        }\n+        footer.addContent(navBar.getContent(false));\n+        addBottom(footer);\n@@ -257,1 +220,1 @@\n-            String tableSummary, Content body, ModuleElement mdle) {\n+            String tableSummary, Content main, ModuleElement mdle) {\n","filename":"src\/jdk.javadoc\/share\/classes\/jdk\/javadoc\/internal\/doclets\/formats\/html\/ModuleIndexWriter.java","additions":26,"deletions":63,"binary":false,"changes":89,"status":"modified"},{"patch":"@@ -87,1 +87,1 @@\n-            String tableSummary, Content body, ModuleElement mdle) {\n+            String tableSummary, Content main, ModuleElement mdle) {\n@@ -93,3 +93,1 @@\n-        HtmlTree htmlTree = (configuration.allowTag(HtmlTag.MAIN))\n-                ? HtmlTree.MAIN(HtmlStyle.indexContainer, heading)\n-                : HtmlTree.DIV(HtmlStyle.indexContainer, heading);\n+        HtmlTree htmlTree = HtmlTree.DIV(HtmlStyle.indexContainer, heading);\n@@ -105,1 +103,1 @@\n-        body.addContent(htmlTree);\n+        main.addContent(htmlTree);\n@@ -160,1 +158,1 @@\n-    protected void addNavigationBarHeader(Content body) {\n+    protected void addNavigationBarHeader(Content header) {\n@@ -169,1 +167,1 @@\n-        body.addContent(heading);\n+        header.addContent(heading);\n@@ -235,1 +233,1 @@\n-    protected void addNavigationBarFooter(Content body) {\n+    protected void addNavigationBarFooter(Content footer) {\n@@ -237,1 +235,1 @@\n-        body.addContent(p);\n+        footer.addContent(p);\n","filename":"src\/jdk.javadoc\/share\/classes\/jdk\/javadoc\/internal\/doclets\/formats\/html\/ModulePackageIndexFrameWriter.java","additions":7,"deletions":9,"binary":false,"changes":16,"status":"modified"},{"patch":"@@ -80,1 +80,1 @@\n-    protected void addPackagesList(Content body) {\n+    protected void addPackagesList(Content main) {\n@@ -83,3 +83,1 @@\n-        HtmlTree htmlTree = (configuration.allowTag(HtmlTag.MAIN))\n-                ? HtmlTree.MAIN(HtmlStyle.indexContainer, heading)\n-                : HtmlTree.DIV(HtmlStyle.indexContainer, heading);\n+        HtmlTree htmlTree = HtmlTree.DIV(HtmlStyle.indexContainer, heading);\n@@ -97,1 +95,1 @@\n-        body.addContent(htmlTree);\n+        main.addContent(htmlTree);\n@@ -127,1 +125,1 @@\n-    protected void addNavigationBarHeader(Content body) {\n+    protected void addNavigationBarHeader(Content header) {\n@@ -136,1 +134,1 @@\n-        body.addContent(heading);\n+        header.addContent(heading);\n@@ -178,1 +176,1 @@\n-    protected void addNavigationBarFooter(Content body) {\n+    protected void addNavigationBarFooter(Content footer) {\n@@ -180,1 +178,1 @@\n-        body.addContent(p);\n+        footer.addContent(p);\n","filename":"src\/jdk.javadoc\/share\/classes\/jdk\/javadoc\/internal\/doclets\/formats\/html\/PackageIndexFrameWriter.java","additions":7,"deletions":9,"binary":false,"changes":16,"status":"modified"},{"patch":"@@ -59,5 +59,0 @@\n-    \/**\n-     * HTML tree for main tag.\n-     *\/\n-    private final HtmlTree htmlTree = HtmlTree.MAIN();\n-\n@@ -93,1 +88,2 @@\n-     * @param body the documentation tree to which the index will be added\n+     * @param header the documentation tree to which the navigational links will be added\n+     * @param main the documentation tree to which the packages list will be added\n@@ -96,2 +92,2 @@\n-    protected void addIndex(Content body) {\n-        addIndexContents(body);\n+    protected void addIndex(Content header, Content main) {\n+        addIndexContents(header, main);\n@@ -104,1 +100,1 @@\n-    protected void addPackagesList(Content body) {\n+    protected void addPackagesList(Content main) {\n@@ -139,5 +135,1 @@\n-            if (configuration.allowTag(HtmlTag.MAIN)) {\n-                htmlTree.addContent(div);\n-            } else {\n-                body.addContent(div);\n-            }\n+            main.addContent(div);\n@@ -156,1 +148,1 @@\n-     * @param body the documentation tree to which the overview header will be added\n+     * @param main the documentation tree to which the overview header will be added\n@@ -159,2 +151,2 @@\n-    protected void addOverviewHeader(Content body) {\n-        addConfigurationTitle(body);\n+    protected void addOverviewHeader(Content main) {\n+        addConfigurationTitle(main);\n@@ -165,5 +157,1 @@\n-            if (configuration.allowTag(HtmlTag.MAIN)) {\n-                htmlTree.addContent(div);\n-            } else {\n-                body.addContent(div);\n-            }\n+            main.addContent(div);\n@@ -186,12 +174,0 @@\n-    \/**\n-     * For HTML 5, add the htmlTree to the body. For HTML 4, do nothing.\n-     *\n-     * @param body the documentation tree to which the overview will be added\n-     *\/\n-    @Override\n-    protected void addOverview(Content body) {\n-        if (configuration.allowTag(HtmlTag.MAIN)) {\n-            body.addContent(htmlTree);\n-        }\n-    }\n-\n@@ -203,1 +179,1 @@\n-     * @param body the documentation tree to which the navigation bar header will be added\n+     * @param header the documentation tree to which the navigation bar header will be added\n@@ -206,5 +182,2 @@\n-    protected void addNavigationBarHeader(Content body) {\n-        Content tree = (configuration.allowTag(HtmlTag.HEADER))\n-                ? HtmlTree.HEADER()\n-                : body;\n-        addTop(tree);\n+    protected void addNavigationBarHeader(Content header) {\n+        addTop(header);\n@@ -212,4 +185,1 @@\n-        tree.addContent(navBar.getContent(true));\n-        if (configuration.allowTag(HtmlTag.HEADER)) {\n-            body.addContent(tree);\n-        }\n+        header.addContent(navBar.getContent(true));\n@@ -222,1 +192,1 @@\n-     * @param body the documentation tree to which the navigation bar footer will be added\n+     * @param footer the documentation tree to which the navigation bar footer will be added\n@@ -225,4 +195,1 @@\n-    protected void addNavigationBarFooter(Content body) {\n-        Content tree = (configuration.allowTag(HtmlTag.FOOTER))\n-                ? HtmlTree.FOOTER()\n-                : body;\n+    protected void addNavigationBarFooter(Content footer) {\n@@ -230,5 +197,2 @@\n-        tree.addContent(navBar.getContent(false));\n-        addBottom(tree);\n-        if (configuration.allowTag(HtmlTag.FOOTER)) {\n-            body.addContent(tree);\n-        }\n+        footer.addContent(navBar.getContent(false));\n+        addBottom(footer);\n","filename":"src\/jdk.javadoc\/share\/classes\/jdk\/javadoc\/internal\/doclets\/formats\/html\/PackageIndexWriter.java","additions":18,"deletions":54,"binary":false,"changes":72,"status":"modified"},{"patch":"@@ -0,0 +1,223 @@\n+\/*\n+ * Copyright (c) 2018, Oracle and\/or its affiliates. All rights reserved.\n+ * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+ *\n+ * This code is free software; you can redistribute it and\/or modify it\n+ * under the terms of the GNU General Public License version 2 only, as\n+ * published by the Free Software Foundation.  Oracle designates this\n+ * particular file as subject to the \"Classpath\" exception as provided\n+ * by Oracle in the LICENSE file that accompanied this code.\n+ *\n+ * This code is distributed in the hope that it will be useful, but WITHOUT\n+ * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+ * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+ * version 2 for more details (a copy is included in the LICENSE file that\n+ * accompanied this code).\n+ *\n+ * You should have received a copy of the GNU General Public License version\n+ * 2 along with this work; if not, write to the Free Software Foundation,\n+ * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n+ *\n+ * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n+ * or visit www.oracle.com if you need additional information or have any\n+ * questions.\n+ *\/\n+\n+\/*\n+ * @test\n+ * @bug 8210047\n+ * @summary some pages contains content outside of landmark region\n+ * @library \/tools\/lib ..\/lib\n+ * @modules\n+ *      jdk.javadoc\/jdk.javadoc.internal.tool\n+ *      jdk.compiler\/com.sun.tools.javac.api\n+ *      jdk.compiler\/com.sun.tools.javac.main\n+ * @build JavadocTester\n+ * @run main TestHtmlLankmarkRegions\n+ *\/\n+\n+\n+import java.nio.file.Path;\n+import java.nio.file.Paths;\n+\n+import builder.ClassBuilder;\n+import toolbox.ModuleBuilder;\n+import toolbox.ToolBox;\n+\n+public class TestHtmlLankmarkRegions extends JavadocTester {\n+\n+    final ToolBox tb;\n+\n+    public static void main(String... args) throws Exception {\n+        TestHtmlLankmarkRegions tester = new TestHtmlLankmarkRegions();\n+        tester.runTests(m -> new Object[]{Paths.get(m.getName())});\n+    }\n+\n+    TestHtmlLankmarkRegions() {\n+        tb = new ToolBox();\n+    }\n+\n+    @Test\n+    void testModules(Path base) throws Exception {\n+        Path srcDir = base.resolve(\"src\");\n+        createModules(srcDir);\n+\n+        Path outDir = base.resolve(\"out\");\n+        javadoc(\"-d\", outDir.toString(),\n+                \"-doctitle\", \"Document Title\",\n+                \"-header\", \"Test Header\",\n+                \"--frames\",\n+                \"--module-source-path\", srcDir.toString(),\n+                \"--module\", \"m1,m2\");\n+\n+        checkExit(Exit.OK);\n+\n+        checkOrder(\"module-overview-frame.html\",\n+                \"<header role=\\\"banner\\\">\\n\"\n+                + \"<h1 title=\\\"Test Header\\\" class=\\\"bar\\\">Test Header<\/h1>\\n\"\n+                + \"<nav role=\\\"navigation\\\" class=\\\"indexNav\\\">\",\n+                \"<main role=\\\"main\\\">\\n\"\n+                + \"<div class=\\\"indexContainer\\\">\\n\"\n+                + \"<h2 title=\\\"Modules\\\">Modules<\/h2>\\n\"\n+                + \"<ul title=\\\"Modules\\\">\",\n+                \"<footer role=\\\"contentinfo\\\">\");\n+\n+        checkOrder(\"m1\/module-frame.html\",\n+                \"<header role=\\\"banner\\\">\\n\"\n+                + \"<h1 title=\\\"Test Header\\\" class=\\\"bar\\\">Test Header<\/h1>\\n\"\n+                + \"<nav role=\\\"navigation\\\" class=\\\"indexNav\\\">\",\n+                \"<main role=\\\"main\\\">\\n\"\n+                + \"<div class=\\\"indexContainer\\\">\\n\"\n+                + \"<h2 title=\\\"m1\\\"><a href=\\\"module-summary.html\\\" target=\\\"classFrame\\\">m1<\/a>&nbsp;Packages<\/h2>\",\n+                \"<footer role=\\\"contentinfo\\\">\");\n+\n+        checkOrder(\"overview-summary.html\",\n+                \"<header role=\\\"banner\\\">\\n\"\n+                + \"<nav role=\\\"navigation\\\">\",\n+                \"<main role=\\\"main\\\">\\n\"\n+                + \"<div class=\\\"header\\\">\\n\"\n+                + \"<h1 class=\\\"title\\\">Document Title<\/h1>\",\n+                \"<footer role=\\\"contentinfo\\\">\\n\"\n+                + \"<nav role=\\\"navigation\\\">\");\n+    }\n+\n+    @Test\n+    void testModulesHtml4(Path base) throws Exception {\n+        Path srcDir = base.resolve(\"src\");\n+        createModules(srcDir);\n+\n+        Path outDir = base.resolve(\"out2\");\n+        javadoc(\"-d\", outDir.toString(),\n+                \"-doctitle\", \"Document Title\",\n+                \"-header\", \"Test Header\",\n+                \"--frames\",\n+                \"--module-source-path\", srcDir.toString(),\n+                \"--module\", \"m1,m2\",\n+                \"-html4\");\n+\n+        checkExit(Exit.OK);\n+\n+        checkOrder(\"module-overview-frame.html\",\n+                \"<h1 title=\\\"Test Header\\\" class=\\\"bar\\\">Test Header<\/h1>\\n\"\n+                + \"<div class=\\\"indexNav\\\">\",\n+                \"<div class=\\\"indexContainer\\\">\\n\"\n+                + \"<h2 title=\\\"Modules\\\">Modules<\/h2>\\n\"\n+                + \"<ul title=\\\"Modules\\\">\");\n+\n+        checkOrder(\"m1\/module-frame.html\",\n+                \"<h1 title=\\\"Test Header\\\" class=\\\"bar\\\">Test Header<\/h1>\\n\"\n+                + \"<div class=\\\"indexNav\\\">\",\n+                \"<div class=\\\"indexContainer\\\">\\n\"\n+                + \"<h2 title=\\\"m1\\\"><a href=\\\"module-summary.html\\\" target=\\\"classFrame\\\">m1<\/a>&nbsp;Packages<\/h2>\");\n+\n+        checkOrder(\"overview-summary.html\",\n+                \"<div class=\\\"fixedNav\\\">\",\n+                \"<div class=\\\"header\\\">\\n\"\n+                + \"<h1 class=\\\"title\\\">Document Title<\/h1>\",\n+                \"<div class=\\\"bottomNav\\\"><a name=\\\"navbar.bottom\\\">\");\n+    }\n+\n+    @Test\n+    void testPackages(Path base) throws Exception {\n+        Path srcDir = base.resolve(\"src\");\n+        createPackages(srcDir);\n+\n+        Path outDir = base.resolve(\"out3\");\n+        javadoc(\"-d\", outDir.toString(),\n+                \"-doctitle\", \"Document Title\",\n+                \"-header\", \"Test Header\",\n+                \"--frames\",\n+                \"-sourcepath\", srcDir.toString(),\n+                \"pkg1\", \"pkg2\");\n+\n+        checkExit(Exit.OK);\n+\n+        checkOrder(\"overview-summary.html\",\n+                \"<header role=\\\"banner\\\">\\n\"\n+                + \"<nav role=\\\"navigation\\\">\",\n+                \"<main role=\\\"main\\\">\\n\"\n+                + \"<div class=\\\"header\\\">\\n\"\n+                + \"<h1 class=\\\"title\\\">Document Title<\/h1>\",\n+                \"<footer role=\\\"contentinfo\\\">\\n\" +\n+                        \"<nav role=\\\"navigation\\\">\");\n+\n+        checkOrder(\"overview-frame.html\",\n+                \"<header role=\\\"banner\\\">\\n\"\n+                + \"<h1 title=\\\"Test Header\\\" class=\\\"bar\\\">Test Header<\/h1>\\n\"\n+                + \"<nav role=\\\"navigation\\\" class=\\\"indexNav\\\">\",\n+                \"<main role=\\\"main\\\">\\n\"\n+                + \"<div class=\\\"indexContainer\\\">\\n\"\n+                + \"<h2 title=\\\"Packages\\\">Packages<\/h2>\",\n+                \"<footer role=\\\"contentinfo\\\">\");\n+    }\n+\n+    @Test\n+    void testPackagesHtml4(Path base) throws Exception {\n+        Path srcDir = base.resolve(\"src\");\n+        createPackages(srcDir);\n+\n+        Path outDir = base.resolve(\"out4\");\n+        javadoc(\"-d\", outDir.toString(),\n+                \"-doctitle\", \"Document Title\",\n+                \"-header\", \"Test Header\",\n+                \"--frames\",\n+                \"-sourcepath\", srcDir.toString(),\n+                \"pkg1\", \"pkg2\",\n+                \"-html4\");\n+\n+        checkExit(Exit.OK);\n+\n+        checkOrder(\"overview-summary.html\",\n+                \"<div class=\\\"fixedNav\\\">\",\n+                \"<div class=\\\"header\\\">\\n\"\n+                + \"<h1 class=\\\"title\\\">Document Title<\/h1>\",\n+                \"<div class=\\\"bottomNav\\\"><a name=\\\"navbar.bottom\\\">\");\n+\n+        checkOrder(\"overview-frame.html\",\n+                \"<h1 title=\\\"Test Header\\\" class=\\\"bar\\\">Test Header<\/h1>\\n\"\n+                + \"<div class=\\\"indexNav\\\">\",\n+                \"<div class=\\\"indexContainer\\\">\\n\"\n+                + \"<h2 title=\\\"Packages\\\">Packages<\/h2>\"\n+        );\n+    }\n+\n+    void createModules(Path srcDir) throws Exception {\n+        new ModuleBuilder(tb, \"m1\")\n+                .classes(\"package p1; public class a{}\")\n+                .classes(\"package p2; public class b{}\")\n+                .write(srcDir);\n+        new ModuleBuilder(tb, \"m2\")\n+                .classes(\"package p3; public class c{}\")\n+                .classes(\"package p4; public class d{}\")\n+                .write(srcDir);\n+    }\n+\n+    void createPackages(Path srcDir) throws Exception {\n+        new ClassBuilder(tb, \"pkg1.A\")\n+                .setModifiers(\"public\", \"class\")\n+                .write(srcDir);\n+        new ClassBuilder(tb, \"pkg2.B\")\n+                .setModifiers(\"public\", \"class\")\n+                .write(srcDir);\n+    }\n+}\n","filename":"test\/langtools\/jdk\/javadoc\/doclet\/testHtmlLandmarkRegions\/TestHtmlLankmarkRegions.java","additions":223,"deletions":0,"binary":false,"changes":223,"status":"added"},{"patch":"@@ -27,1 +27,1 @@\n- *      8202624 8221871\n+ *      8202624 8221871 8210047\n@@ -109,1 +109,2 @@\n-                \"<main role=\\\"main\\\" class=\\\"indexContainer\\\">\\n\"\n+                \"<main role=\\\"main\\\">\\n\"\n+                + \"<div class=\\\"indexContainer\\\">\\n\"\n@@ -116,1 +117,3 @@\n-                \"<main role=\\\"main\\\" class=\\\"indexContainer\\\">\\n\"\n+                \"<main role=\\\"main\\\">\\n\"\n+                + \"<h1 class=\\\"bar\\\">All&nbsp;Classes<\/h1>\\n\"\n+                + \"<div class=\\\"indexContainer\\\">\\n\"\n@@ -124,1 +127,3 @@\n-                \"<main role=\\\"main\\\" class=\\\"indexContainer\\\">\\n\"\n+                \"<main role=\\\"main\\\">\\n\"\n+                + \"<h1 class=\\\"bar\\\">All&nbsp;Classes<\/h1>\\n\"\n+                + \"<div class=\\\"indexContainer\\\">\\n\"\n@@ -628,1 +633,1 @@\n-                \"<div class=\\\"indexContainer\\\">\\n\"\n+                \"<main class=\\\"indexContainer\\\">\\n\"\n@@ -635,1 +640,1 @@\n-                \"<div class=\\\"indexContainer\\\">\\n\"\n+                \"<main class=\\\"indexContainer\\\">\\n\"\n@@ -643,1 +648,1 @@\n-                \"<div class=\\\"indexContainer\\\">\\n\"\n+                \"<main class=\\\"indexContainer\\\">\\n\"\n","filename":"test\/langtools\/jdk\/javadoc\/doclet\/testHtmlVersion\/TestHtmlVersion.java","additions":12,"deletions":7,"binary":false,"changes":19,"status":"modified"},{"patch":"@@ -26,1 +26,1 @@\n- * @bug 8173302 8182765 8196202\n+ * @bug 8173302 8182765 8196202 8210047\n@@ -98,1 +98,2 @@\n-                \"<div class=\\\"header\\\">\\n\"\n+                \"<main role=\\\"main\\\">\\n\"\n+                + \"<div class=\\\"header\\\">\\n\"\n@@ -101,1 +102,0 @@\n-                + \"<main role=\\\"main\\\">\\n\"\n","filename":"test\/langtools\/jdk\/javadoc\/doclet\/testOverview\/TestOverview.java","additions":3,"deletions":3,"binary":false,"changes":6,"status":"modified"}]}