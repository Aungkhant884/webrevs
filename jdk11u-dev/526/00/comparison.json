{"files":[{"patch":"@@ -154,1 +154,0 @@\n-java\/awt\/KeyboardFocusmanager\/TypeAhead\/SubMenuShowTest\/SubMenuShowTest.html 8198624 macosx-all\n@@ -935,2 +934,0 @@\n- \n-############################################################################\n@@ -938,0 +935,1 @@\n+############################################################################\n","filename":"test\/jdk\/ProblemList.txt","additions":1,"deletions":3,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -1,48 +0,0 @@\n-<!--\n- Copyright (c) 2006, 2016, Oracle and\/or its affiliates. All rights reserved.\n- DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n-\n- This code is free software; you can redistribute it and\/or modify it\n- under the terms of the GNU General Public License version 2 only, as\n- published by the Free Software Foundation.\n-\n- This code is distributed in the hope that it will be useful, but WITHOUT\n- ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n- FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n- version 2 for more details (a copy is included in the LICENSE file that\n- accompanied this code).\n-\n- You should have received a copy of the GNU General Public License version\n- 2 along with this work; if not, write to the Free Software Foundation,\n- Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n-\n- Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n- or visit www.oracle.com if you need additional information or have any\n- questions.\n--->\n-\n-<html>\n-<!--\n-  @test\n-  @key headful\n-  @bug        6380743\n-  @summary    Submenu should be shown by mnemonic key press.\n-  @author     anton.tarasov@...: area=awt.focus\n-  @library    ..\/..\/..\/regtesthelpers\n-  @library    ..\/..\/..\/..\/..\/lib\/testlibrary\n-  @build      Util\n-  @build      jdk.testlibrary.OSInfo\n-  @run        applet SubMenuShowTest.html\n-  -->\n-<head>\n-<title>SubMenuShowTest<\/title>\n-<\/head>\n-<body>\n- \n-<h1>SubMenuShowTest<br>Bug ID: 6380743<\/h1>\n- \n-<p>See the dialog box (usually in upper left corner) for instructions<\/p>\n- \n-<APPLET CODE=SubMenuShowTest.class WIDTH=200 HEIGHT=200><\/APPLET>\n-<\/body>\n-<\/html>\n","filename":"test\/jdk\/java\/awt\/KeyboardFocusmanager\/TypeAhead\/SubMenuShowTest\/SubMenuShowTest.html","additions":0,"deletions":48,"binary":false,"changes":48,"status":"deleted"},{"patch":"@@ -25,5 +25,9 @@\n-  test\n-  @bug       6380743 8158380\n-  @summary   Submenu should be shown by mnemonic key press.\n-  @author    anton.tarasov@...: area=awt.focus\n-  @run       applet SubMenuShowTest.html\n+  @test\n+  @key headful\n+  @bug 6380743 8158380 8198624\n+  @summary Submenu should be shown by mnemonic key press.\n+  @author anton.tarasov@...: area=awt.focus\n+  @library ..\/..\/..\/regtesthelpers\n+  @library ..\/..\/..\/..\/..\/lib\/testlibrary\n+  @build Util\n+  @run main SubMenuShowTest\n@@ -32,4 +36,10 @@\n-import java.awt.*;\n-import java.awt.event.*;\n-import javax.swing.*;\n-import java.applet.Applet;\n+import java.awt.Robot;\n+import java.awt.BorderLayout;\n+import java.awt.event.KeyEvent;\n+import java.awt.event.ActionListener;\n+import java.awt.event.ActionEvent;\n+import javax.swing.SwingUtilities;\n+import javax.swing.JFrame;\n+import javax.swing.JMenuBar;\n+import javax.swing.JMenu;\n+import javax.swing.JMenuItem;\n@@ -37,1 +47,0 @@\n-import java.lang.reflect.InvocationTargetException;\n@@ -41,13 +50,25 @@\n-public class SubMenuShowTest extends Applet {\n-    Robot robot;\n-    JFrame frame = new JFrame(\"Test Frame\");\n-    JMenuBar bar = new JMenuBar();\n-    JMenu menu = new JMenu(\"Menu\");\n-    JMenu submenu = new JMenu(\"More\");\n-    JMenuItem item = new JMenuItem(\"item\");\n-    AtomicBoolean activated = new AtomicBoolean(false);\n-\n-    public static void main(String[] args) {\n-        SubMenuShowTest app = new SubMenuShowTest();\n-        app.init();\n-        app.start();\n+public class SubMenuShowTest {\n+    private static Robot robot;\n+    private static JFrame frame;\n+    private static JMenuBar bar;\n+    private static JMenu menu;\n+    private static JMenu submenu;\n+    private static JMenuItem item;\n+    private static AtomicBoolean activated = new AtomicBoolean(false);\n+\n+    public static void main(String[] args) throws Exception {\n+        SwingUtilities.invokeAndWait(SubMenuShowTest::createAndShowGUI);\n+\n+        try {\n+            robot = new Robot();\n+            robot.setAutoDelay(100);\n+            robot.setAutoWaitForIdle(true);\n+\n+            doTest();\n+        } catch (Exception ex) {\n+            throw new RuntimeException(\"Test failed: Exception thrown:\"+ex);\n+        } finally {\n+            dispose();\n+        }\n+\n+        System.out.println(\"Test passed.\");\n@@ -56,4 +77,7 @@\n-    public void init() {\n-        robot = Util.createRobot();\n-        robot.setAutoDelay(200);\n-        robot.setAutoWaitForIdle(true);\n+    public static void dispose() throws Exception {\n+        if(frame != null) {\n+            SwingUtilities.invokeAndWait(() -> {\n+                frame.dispose();\n+            });\n+        }\n+    }\n@@ -61,0 +85,1 @@\n+    public static void createAndShowGUI() {\n@@ -64,2 +89,5 @@\n-        this.setLayout (new BorderLayout ());\n-    }\n+        frame = new JFrame(\"Test Frame\");\n+        bar = new JMenuBar();\n+        menu = new JMenu(\"Menu\");\n+        submenu = new JMenu(\"More\");\n+        item = new JMenuItem(\"item\");\n@@ -67,1 +95,1 @@\n-    public void start() {\n+        frame.setLayout (new BorderLayout ());\n@@ -87,0 +115,1 @@\n+    }\n@@ -88,0 +117,1 @@\n+    public static void doTest() {\n@@ -106,2 +136,2 @@\n-        if (!Util.waitForCondition(activated, 2000)) {\n-            throw new TestFailedException(\"a submenu wasn't activated by mnemonic key press\");\n+        if (!Util.waitForCondition(activated, 1500)) {\n+            throw new TestFailedException(\"A submenu wasn't activated by mnemonic key press\");\n@@ -109,2 +139,0 @@\n-\n-        System.out.println(\"Test passed.\");\n@@ -119,1 +147,0 @@\n-\n","filename":"test\/jdk\/java\/awt\/KeyboardFocusmanager\/TypeAhead\/SubMenuShowTest\/SubMenuShowTest.java","additions":62,"deletions":35,"binary":false,"changes":97,"status":"modified"}]}