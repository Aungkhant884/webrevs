{"files":[{"patch":"@@ -70,1 +70,1 @@\n-        HeapDumpReader reader = new HeapDumpReader(new File(path));\n+        HeapDumpReader reader = new HeapDumpReader(new File(path), out);\n","filename":"jol-cli\/src\/main\/java\/org\/openjdk\/jol\/operations\/HeapDumpEstimates.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -67,1 +67,1 @@\n-        HeapDumpReader reader = new HeapDumpReader(new File(path));\n+        HeapDumpReader reader = new HeapDumpReader(new File(path), out);\n","filename":"jol-cli\/src\/main\/java\/org\/openjdk\/jol\/operations\/HeapDumpStats.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -90,1 +90,1 @@\n-            HeapDumpReader reader = new HeapDumpReader(new File(arg));\n+            HeapDumpReader reader = new HeapDumpReader(new File(arg), System.out);\n","filename":"jol-cli\/src\/main\/java\/org\/openjdk\/jol\/operations\/ObjectShapes.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -135,1 +135,1 @@\n-            HeapDumpReader reader = new HeapDumpReader(new File(path)) {\n+            HeapDumpReader reader = new HeapDumpReader(new File(path), null) {\n","filename":"jol-cli\/src\/main\/java\/org\/openjdk\/jol\/operations\/StringCompress.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -29,0 +29,1 @@\n+import org.openjdk.jol.util.IOUtils;\n@@ -31,8 +32,1 @@\n-import java.io.BufferedInputStream;\n-import java.io.ByteArrayOutputStream;\n-import java.io.EOFException;\n-import java.io.File;\n-import java.io.FileInputStream;\n-import java.io.FileNotFoundException;\n-import java.io.IOException;\n-import java.io.InputStream;\n+import java.io.*;\n@@ -60,0 +54,1 @@\n+    private final PrintStream verboseOut;\n@@ -68,1 +63,1 @@\n-    public HeapDumpReader(File file) throws IOException {\n+    public HeapDumpReader(File file, PrintStream verboseOut) throws IOException {\n@@ -70,0 +65,1 @@\n+        this.verboseOut = verboseOut;\n@@ -115,0 +111,7 @@\n+        long lastPrint = 0L;\n+        final long printEach = 256 * 1024 * 1024;\n+\n+        if (verboseOut != null) {\n+            verboseOut.print(\"Read progress: \");\n+        }\n+\n@@ -116,0 +119,4 @@\n+            if ((verboseOut != null) && (readBytes - lastPrint > printEach)) {\n+                verboseOut.print(readBytes \/ 1000 \/ 1000 + \"M... \");\n+                lastPrint = readBytes;\n+            }\n@@ -163,0 +170,4 @@\n+        if (verboseOut != null) {\n+            verboseOut.println(\"DONE\");\n+        }\n+\n","filename":"jol-core\/src\/main\/java\/org\/openjdk\/jol\/heap\/HeapDumpReader.java","additions":20,"deletions":9,"binary":false,"changes":29,"status":"modified"}]}