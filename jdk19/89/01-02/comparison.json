{"files":[{"patch":"@@ -41,1 +41,3 @@\n-        setAppImageSupplier(MacAppImageBuilder::new);\n+        setAppImageSupplier(imageOutDir -> {\n+            return new MacAppImageBuilder(imageOutDir, isDependentTask());\n+        });\n","filename":"src\/jdk.jpackage\/macosx\/classes\/jdk\/jpackage\/internal\/MacAppBundler.java","additions":3,"deletions":1,"binary":false,"changes":4,"status":"modified"},{"patch":"@@ -93,0 +93,2 @@\n+    private final boolean withPackageFile;\n+\n@@ -246,1 +248,1 @@\n-    public MacAppImageBuilder(Path imageOutDir) {\n+    public MacAppImageBuilder(Path imageOutDir, boolean withPackageFile) {\n@@ -250,0 +252,1 @@\n+        this.withPackageFile = withPackageFile;\n@@ -312,0 +315,5 @@\n+        if (withPackageFile) {\n+            new PackageFile(APP_NAME.fetchFrom(params)).save(\n+                    ApplicationLayout.macAppImage().resolveAt(root));\n+        }\n+\n","filename":"src\/jdk.jpackage\/macosx\/classes\/jdk\/jpackage\/internal\/MacAppImageBuilder.java","additions":9,"deletions":1,"binary":false,"changes":10,"status":"modified"},{"patch":"@@ -118,2 +118,1 @@\n-                .setDependentTask(true).\n-                setCreatePackageFile(true);\n+                .setDependentTask(true);\n","filename":"src\/jdk.jpackage\/macosx\/classes\/jdk\/jpackage\/internal\/MacBaseInstallerBundler.java","additions":1,"deletions":2,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2015, 2022, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2015, 2021, Oracle and\/or its affiliates. All rights reserved.\n@@ -50,1 +50,0 @@\n-    protected boolean createPackageFile;\n@@ -57,4 +56,0 @@\n-    public void setCreatePackageFile(boolean v) {\n-        createPackageFile = v;\n-    }\n-\n@@ -86,4 +81,0 @@\n-        if (createPackageFile) {\n-            new PackageFile(APP_NAME.fetchFrom(params)).save(\n-                    ApplicationLayout.macAppImage().resolveAt(root));\n-        }\n","filename":"src\/jdk.jpackage\/share\/classes\/jdk\/jpackage\/internal\/AbstractAppImageBuilder.java","additions":1,"deletions":10,"binary":false,"changes":11,"status":"modified"},{"patch":"@@ -115,3 +115,2 @@\n-    final AppImageBundler setCreatePackageFile(boolean v) {\n-        createPackageFile = v;\n-        return this;\n+    final boolean isDependentTask() {\n+        return dependentTask;\n@@ -178,1 +177,0 @@\n-        appBuilder.setCreatePackageFile(createPackageFile);\n@@ -195,1 +193,0 @@\n-    private boolean createPackageFile;\n","filename":"src\/jdk.jpackage\/share\/classes\/jdk\/jpackage\/internal\/AppImageBundler.java","additions":2,"deletions":5,"binary":false,"changes":7,"status":"modified"},{"patch":"@@ -2,1 +2,1 @@\n- * Copyright (c) 2019, 2021, Oracle and\/or its affiliates. All rights reserved.\n+ * Copyright (c) 2019, 2022, Oracle and\/or its affiliates. All rights reserved.\n@@ -25,0 +25,1 @@\n+import jdk.jpackage.internal.ApplicationLayout;\n@@ -78,1 +79,2 @@\n-            Path launcherPath = dmgImage.resolve(Path.of(\"Contents\", \"MacOS\", cmd.name()));\n+            Path launcherPath = ApplicationLayout.platformAppImage()\n+                    .resolveAt(dmgImage).launchersDirectory().resolve(cmd.name());\n","filename":"test\/jdk\/tools\/jpackage\/macosx\/SigningPackageTest.java","additions":4,"deletions":2,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -25,0 +25,1 @@\n+import jdk.jpackage.internal.ApplicationLayout;\n@@ -87,1 +88,0 @@\n-            Path launcherPath = dmgImage.resolve(Path.of(\"Contents\", \"MacOS\", cmd.name()));\n@@ -92,0 +92,2 @@\n+                Path launcherPath = ApplicationLayout.platformAppImage()\n+                    .resolveAt(dmgImage).launchersDirectory().resolve(cmd.name());\n","filename":"test\/jdk\/tools\/jpackage\/macosx\/SigningPackageTwoStepTest.java","additions":3,"deletions":1,"binary":false,"changes":4,"status":"modified"}]}