{"files":[{"patch":"@@ -56,1 +56,1 @@\n-    final static int MAX_THREADS_LIMIT = 32;\n+    final static int MAX_THREADS_LIMIT = 20;\n","filename":"test\/hotspot\/jtreg\/serviceability\/jvmti\/events\/FramePop\/framepop02\/framepop02.java","additions":1,"deletions":1,"binary":false,"changes":2,"status":"modified"},{"patch":"@@ -72,1 +72,1 @@\n-int isTestThread(JNIEnv *jni, jvmtiEnv *jvmti, jthread thr) {\n+bool isTestThread(JNIEnv *jni, jvmtiEnv *jvmti, jthread thr) {\n@@ -177,1 +177,5 @@\n-  RawMonitorLocker rml(jvmti, jni, agent_lock);\n+  if (!isTestThread(jni, jvmti, thr)) {\n+    return; \/\/ not a tested thread\n+  }\n+\n+  RawMonitorLocker arml(jvmti, jni, agent_lock);\n@@ -186,12 +190,10 @@\n-  if (isTestThread(jni, jvmti, thr)) {\n-    if (printdump == JNI_TRUE) {\n-      print_current_time();\n-      fflush(0);\n-      LOG(\">>> %sMethod entry\\n>>>\", (isNative == JNI_TRUE) ? \"Native \" : \"\");\n-      printInfo(jni, jvmti, thr, method, frameCount);\n-    }\n-    if (isNative == JNI_FALSE) {\n-      RawMonitorLocker rml(jvmti, jni, event_lock);\n-      push(jni, thr, method, frameCount);\n-      check_jvmti_status(jni, jvmti->NotifyFramePop(thr, 0), \"Error in NotifyFramePop.\");\n-    }\n+  if (printdump == JNI_TRUE) {\n+    print_current_time();\n+    fflush(0);\n+    LOG(\">>> %sMethod entry\\n>>>\", (isNative == JNI_TRUE) ? \"Native \" : \"\");\n+    printInfo(jni, jvmti, thr, method, frameCount);\n+  }\n+  if (isNative == JNI_FALSE) {\n+    RawMonitorLocker erml(jvmti, jni, event_lock);\n+    push(jni, thr, method, frameCount);\n+    check_jvmti_status(jni, jvmti->NotifyFramePop(thr, 0), \"Error in NotifyFramePop.\");\n@@ -216,1 +218,5 @@\n-  RawMonitorLocker rml(jvmti, jni, agent_lock);\n+  if (!isTestThread(jni, jvmti, thr)) {\n+    return; \/\/ not a tested thread\n+  }\n+\n+  RawMonitorLocker arml(jvmti, jni, agent_lock);\n@@ -223,9 +229,5 @@\n-  if (isTestThread(jni, jvmti, thr)) {\n-    if (printdump == JNI_TRUE) {\n-      print_current_time();\n-      fflush(0);\n-      LOG(\" >>> Frame Pop\\n>>>\");\n-      printInfo(jni, jvmti, thr, method, frameCount);\n-    }\n-    RawMonitorLocker rml(jvmti, jni, event_lock);\n-    pop(jvmti, (JNIEnv *)jni, thr, method, frameCount);\n+  if (printdump == JNI_TRUE) {\n+    print_current_time();\n+    fflush(0);\n+    LOG(\" >>> Frame Pop\\n>>>\");\n+    printInfo(jni, jvmti, thr, method, frameCount);\n@@ -233,0 +235,2 @@\n+  RawMonitorLocker erml(jvmti, jni, event_lock);\n+  pop(jvmti, (JNIEnv *)jni, thr, method, frameCount);\n","filename":"test\/hotspot\/jtreg\/serviceability\/jvmti\/events\/FramePop\/framepop02\/libframepop02.cpp","additions":28,"deletions":24,"binary":false,"changes":52,"status":"modified"}]}