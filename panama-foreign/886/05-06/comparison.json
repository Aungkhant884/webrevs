{"files":[{"patch":"@@ -96,1 +96,0 @@\n-    @Stable\n@@ -98,1 +97,0 @@\n-    @Stable\n@@ -100,1 +98,0 @@\n-    @Stable\n@@ -115,1 +112,1 @@\n-        SequenceLayout seq = requireLayoutType(SequenceLayout.class);\n+        SequenceLayout seq = requireSequenceLayout();\n@@ -121,1 +118,1 @@\n-        SequenceLayout seq = requireLayoutType(SequenceLayout.class);\n+        SequenceLayout seq = requireSequenceLayout();\n@@ -134,1 +131,1 @@\n-        SequenceLayout seq = requireLayoutType(SequenceLayout.class);\n+        SequenceLayout seq = requireSequenceLayout();\n@@ -142,1 +139,1 @@\n-        GroupLayout g = requireLayoutType(GroupLayout.class);\n+        GroupLayout g = requireGroupLayout();\n@@ -163,1 +160,1 @@\n-        GroupLayout g = requireLayoutType(GroupLayout.class);\n+        GroupLayout g = requireGroupLayout();\n@@ -181,4 +178,6 @@\n-        AddressLayout addressLayout = requireLayoutType(AddressLayout.class);\n-        var derefLayout = addressLayout.targetLayout()\n-                .orElseThrow(() -> badLayoutPath(\n-                        String.format(\"no targetLayout: %s (%s)\", layout, breadcrumbs())));\n+        if (!(layout instanceof AddressLayout addressLayout) ||\n+                addressLayout.targetLayout().isEmpty()) {\n+            throw badLayoutPath(\n+                    String.format(\"Cannot dereference layout: %s (%s)\", layout, breadcrumbs()));\n+        }\n+        MemoryLayout derefLayout = addressLayout.targetLayout().get();\n@@ -323,1 +322,9 @@\n-    private <T extends MemoryLayout> T requireLayoutType(Class<T> layoutClass) {\n+    private SequenceLayout requireSequenceLayout() {\n+        return requireLayoutType(SequenceLayout.class, \"sequence\");\n+    }\n+\n+    private GroupLayout requireGroupLayout() {\n+        return requireLayoutType(GroupLayout.class, \"group\");\n+    }\n+\n+    private <T extends MemoryLayout> T requireLayoutType(Class<T> layoutClass, String name) {\n@@ -325,5 +332,0 @@\n-            var name = layoutClass.getSimpleName();\n-            var type = name\n-                    \/\/ Take what is before \"Layout\"\n-                    .substring(0, name.indexOf(\"Layout\"))\n-                    .toLowerCase(Locale.ROOT);\n@@ -332,1 +334,1 @@\n-                            type, type, layout, breadcrumbs()));\n+                            name, name, layout, breadcrumbs()));\n","filename":"src\/java.base\/share\/classes\/jdk\/internal\/foreign\/LayoutPath.java","additions":21,"deletions":19,"binary":false,"changes":40,"status":"modified"}]}