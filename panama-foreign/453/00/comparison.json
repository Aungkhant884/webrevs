{"files":[{"patch":"@@ -104,1 +104,1 @@\n-            return SourceVersion.isKeyword(name) ? (name + \"_\") : name;\n+            return SourceVersion.isKeyword(name) || isRestrictedTypeName(name) ? (name + \"_\") : name;\n@@ -108,0 +108,8 @@\n+    private static boolean isRestrictedTypeName(String name) {\n+        return switch (name) {\n+            case \"var\", \"yield\", \"record\",\n+                \"sealed\", \"permits\" -> true;\n+            default -> false;\n+        };\n+    }\n+\n","filename":"src\/jdk.incubator.jextract\/share\/classes\/jdk\/internal\/jextract\/impl\/Utils.java","additions":9,"deletions":1,"binary":false,"changes":10,"status":"modified"},{"patch":"@@ -0,0 +1,53 @@\n+\/*\n+ * Copyright (c) 2021, Oracle and\/or its affiliates. All rights reserved.\n+ * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+ *\n+ * This code is free software; you can redistribute it and\/or modify it\n+ * under the terms of the GNU General Public License version 2 only, as\n+ * published by the Free Software Foundation.\n+ *\n+ * This code is distributed in the hope that it will be useful, but WITHOUT\n+ * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+ * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+ * version 2 for more details (a copy is included in the LICENSE file that\n+ * accompanied this code).\n+ *\n+ * You should have received a copy of the GNU General Public License version\n+ * 2 along with this work; if not, write to the Free Software Foundation,\n+ * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n+ *\n+ * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n+ * or visit www.oracle.com if you need additional information or have any\n+ * questions.\n+ *\/\n+\n+import java.nio.file.Path;\n+import org.testng.annotations.Test;\n+import static org.testng.Assert.assertNotNull;\n+\n+\/*\n+ * @test\n+ * @modules jdk.incubator.jextract\n+ * @library \/test\/lib\n+ * @build JextractToolRunner\n+ * @bug 8261893\n+ * @summary jextract generates class names that are restricted type names\n+ * @run testng\/othervm -Dforeign.restricted=permit -Duser.language=en --add-modules jdk.incubator.jextract Test8240181\n+ *\/\n+public class Test8261893 extends JextractToolRunner {\n+    @Test\n+    public void test() {\n+        Path test8261893Output = getOutputFilePath(\"test8261893gen\");\n+        Path test8261893H = getInputFilePath(\"test8261893.h\");\n+        run(\"-d\", test8261893Output.toString(), test8261893H.toString()).checkSuccess();\n+        try(Loader loader = classLoader(test8261893Output)) {\n+            assertNotNull(loader.loadClass(\"test8261893_h$permits_\");\n+            assertNotNull(loader.loadClass(\"test8261893_h$record_\");\n+            assertNotNull(loader.loadClass(\"test8261893_h$sealed_\");\n+            assertNotNull(loader.loadClass(\"test8261893_h$var_\");\n+            assertNotNull(loader.loadClass(\"test8261893_h$yield_\");\n+        } finally {\n+            deleteDir(test8261893Output);\n+        }\n+    }\n+}\n","filename":"test\/jdk\/tools\/jextract\/Test8261893.java","additions":53,"deletions":0,"binary":false,"changes":53,"status":"added"},{"patch":"@@ -0,0 +1,44 @@\n+\/*\n+ * Copyright (c) 2021, Oracle and\/or its affiliates. All rights reserved.\n+ * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n+ *\n+ * This code is free software; you can redistribute it and\/or modify it\n+ * under the terms of the GNU General Public License version 2 only, as\n+ * published by the Free Software Foundation.\n+ *\n+ * This code is distributed in the hope that it will be useful, but WITHOUT\n+ * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+ * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+ * version 2 for more details (a copy is included in the LICENSE file that\n+ * accompanied this code).\n+ *\n+ * You should have received a copy of the GNU General Public License version\n+ * 2 along with this work; if not, write to the Free Software Foundation,\n+ * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n+ *\n+ * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n+ * or visit www.oracle.com if you need additional information or have any\n+ * questions.\n+ *\/\n+\n+typedef struct {\n+  int x, y;\n+} permits;\n+\n+struct record {\n+  int foo;\n+};\n+\n+union sealed {\n+  float i;\n+  int j;\n+};\n+\n+struct var {\n+  int x;\n+};\n+\n+typedef struct {\n+  int bar;\n+} yield;\n+\n","filename":"test\/jdk\/tools\/jextract\/test8261893.h","additions":44,"deletions":0,"binary":false,"changes":44,"status":"added"}]}