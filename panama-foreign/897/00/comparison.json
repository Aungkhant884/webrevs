{"files":[{"patch":"@@ -37,1 +37,0 @@\n-import jdk.internal.misc.Unsafe;\n@@ -53,4 +52,9 @@\n-    private static final long MAX_ALIGN_1 = ValueLayout.JAVA_BYTE.byteAlignment();\n-    private static final long MAX_ALIGN_2 = ValueLayout.JAVA_SHORT.byteAlignment();\n-    private static final long MAX_ALIGN_4 = ValueLayout.JAVA_INT.byteAlignment();\n-    private static final long MAX_ALIGN_8 = ValueLayout.JAVA_LONG.byteAlignment();\n+    \/\/ Constants defining the maximum alignment supported by various kinds of heap arrays.\n+    \/\/ While for most arrays, the maximum alignment is constant (the size, in bytes, of the array elements),\n+    \/\/ note that the alignment of a long[]\/double[] depends on the platform: it's 4-byte on x86, but 8 bytes on x64\n+    \/\/ (as specified by the JAVA_LONG layout constant).\n+\n+    private static final long MAX_ALIGN_BYTE_ARRAY = ValueLayout.JAVA_BYTE.byteAlignment();\n+    private static final long MAX_ALIGN_SHORT_ARRAY = ValueLayout.JAVA_SHORT.byteAlignment();\n+    private static final long MAX_ALIGN_INT_ARRAY = ValueLayout.JAVA_INT.byteAlignment();\n+    private static final long MAX_ALIGN_LONG_ARRAY = ValueLayout.JAVA_LONG.byteAlignment();\n@@ -119,1 +123,1 @@\n-            return MAX_ALIGN_1;\n+            return MAX_ALIGN_BYTE_ARRAY;\n@@ -153,1 +157,1 @@\n-            return MAX_ALIGN_2;\n+            return MAX_ALIGN_SHORT_ARRAY;\n@@ -187,1 +191,1 @@\n-            return MAX_ALIGN_2;\n+            return MAX_ALIGN_SHORT_ARRAY;\n@@ -221,1 +225,1 @@\n-            return MAX_ALIGN_4;\n+            return MAX_ALIGN_INT_ARRAY;\n@@ -255,1 +259,1 @@\n-            return MAX_ALIGN_8;\n+            return MAX_ALIGN_LONG_ARRAY;\n@@ -289,1 +293,1 @@\n-            return MAX_ALIGN_4;\n+            return MAX_ALIGN_INT_ARRAY;\n@@ -323,1 +327,1 @@\n-            return MAX_ALIGN_8;\n+            return MAX_ALIGN_LONG_ARRAY;\n","filename":"src\/java.base\/share\/classes\/jdk\/internal\/foreign\/HeapMemorySegmentImpl.java","additions":16,"deletions":12,"binary":false,"changes":28,"status":"modified"}]}