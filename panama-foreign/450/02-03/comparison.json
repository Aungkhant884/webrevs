{"files":[{"patch":"@@ -261,3 +261,3 @@\n-        if (l instanceof ValueLayout) {\n-            append(typeToLayoutName((ValueLayout) l));\n-        } else if (l instanceof SequenceLayout) {\n+        if (l instanceof ValueLayout val) {\n+            append(typeToLayoutName(val));\n+        } else if (l instanceof SequenceLayout seq) {\n@@ -265,2 +265,2 @@\n-            if (((SequenceLayout) l).elementCount().isPresent()) {\n-                append(((SequenceLayout) l).elementCount().getAsLong() + \", \");\n+            if (seq.elementCount().isPresent()) {\n+                append(seq.elementCount().getAsLong() + \", \");\n@@ -268,1 +268,1 @@\n-            emitLayoutString(((SequenceLayout) l).elementLayout());\n+            emitLayoutString(seq.elementLayout());\n","filename":"src\/jdk.incubator.jextract\/share\/classes\/jdk\/internal\/jextract\/impl\/ConstantBuilder.java","additions":6,"deletions":6,"binary":false,"changes":12,"status":"modified"},{"patch":"@@ -173,0 +173,1 @@\n+            currentBuilder.classBegin();\n","filename":"src\/jdk.incubator.jextract\/share\/classes\/jdk\/internal\/jextract\/impl\/OutputFactory.java","additions":1,"deletions":0,"binary":false,"changes":1,"status":"modified"},{"patch":"@@ -57,1 +57,0 @@\n-        classBegin();\n@@ -76,3 +75,5 @@\n-        super.classBegin();\n-        addLayout(layoutField(), ((Type.Declared)structType).tree().layout().get())\n-                .emitGetter(this, MEMBER_MODS, Constant.SUFFIX_ONLY);\n+        if (!inAnonymousNested()) {\n+            super.classBegin();\n+            addLayout(layoutField(), ((Type.Declared) structType).tree().layout().get())\n+                    .emitGetter(this, MEMBER_MODS, Constant.SUFFIX_ONLY);\n+        }\n@@ -83,1 +84,1 @@\n-        if (prefixElementNames.isEmpty()) {\n+        if (!inAnonymousNested()) {\n@@ -100,0 +101,4 @@\n+    boolean inAnonymousNested() {\n+        return !prefixElementNames.isEmpty();\n+    }\n+\n","filename":"src\/jdk.incubator.jextract\/share\/classes\/jdk\/internal\/jextract\/impl\/StructBuilder.java","additions":10,"deletions":5,"binary":false,"changes":15,"status":"modified"}]}