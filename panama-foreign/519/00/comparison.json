{"files":[{"patch":"@@ -137,3 +137,2 @@\n-                cleanup.next = prev;\n-                ResourceCleanup newSegment = (ResourceCleanup) FST.compareAndExchangeRelease(this, prev, cleanup);\n-                if (newSegment == ResourceCleanup.CLOSED_LIST) {\n+                if (prev == ResourceCleanup.CLOSED_LIST) {\n+                    cleanup.next = null; \/\/ Release, as long as two threads can't add same cleanup it's ok\n@@ -142,2 +141,0 @@\n-                } else if (newSegment == prev) {\n-                    return; \/\/victory\n@@ -145,0 +142,4 @@\n+                cleanup.next = prev;\n+                if (FST.compareAndSet(this, prev, cleanup)) {\n+                    return; \/\/victory\n+                };\n","filename":"src\/jdk.incubator.foreign\/share\/classes\/jdk\/internal\/foreign\/SharedScope.java","additions":6,"deletions":5,"binary":false,"changes":11,"status":"modified"}]}