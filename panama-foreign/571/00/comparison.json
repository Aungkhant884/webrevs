{"files":[{"patch":"@@ -8,68 +8,69 @@\n-  <style type=\"text\/css\">\n-      code{white-space: pre-wrap;}\n-      span.smallcaps{font-variant: small-caps;}\n-      span.underline{text-decoration: underline;}\n-      div.column{display: inline-block; vertical-align: top; width: 50%;}\n-  <\/style>\n-  <style type=\"text\/css\">\n-a.sourceLine { display: inline-block; line-height: 1.25; }\n-a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }\n-a.sourceLine:empty { height: 1.2em; }\n-.sourceCode { overflow: visible; }\n-code.sourceCode { white-space: pre; position: relative; }\n-div.sourceCode { margin: 1em 0; }\n-pre.sourceCode { margin: 0; }\n-@media screen {\n-div.sourceCode { overflow: auto; }\n-}\n-@media print {\n-code.sourceCode { white-space: pre-wrap; }\n-a.sourceLine { text-indent: -1em; padding-left: 1em; }\n-}\n-pre.numberSource a.sourceLine\n-  { position: relative; left: -4em; }\n-pre.numberSource a.sourceLine::before\n-  { content: attr(title);\n-    position: relative; left: -1em; text-align: right; vertical-align: baseline;\n-    border: none; pointer-events: all; display: inline-block;\n-    -webkit-touch-callout: none; -webkit-user-select: none;\n-    -khtml-user-select: none; -moz-user-select: none;\n-    -ms-user-select: none; user-select: none;\n-    padding: 0 4px; width: 4em;\n-    color: #aaaaaa;\n-  }\n-pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }\n-div.sourceCode\n-  {  }\n-@media screen {\n-a.sourceLine::before { text-decoration: underline; }\n-}\n-code span.al { color: #ff0000; font-weight: bold; } \/* Alert *\/\n-code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } \/* Annotation *\/\n-code span.at { color: #7d9029; } \/* Attribute *\/\n-code span.bn { color: #40a070; } \/* BaseN *\/\n-code span.bu { } \/* BuiltIn *\/\n-code span.cf { color: #007020; font-weight: bold; } \/* ControlFlow *\/\n-code span.ch { color: #4070a0; } \/* Char *\/\n-code span.cn { color: #880000; } \/* Constant *\/\n-code span.co { color: #60a0b0; font-style: italic; } \/* Comment *\/\n-code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } \/* CommentVar *\/\n-code span.do { color: #ba2121; font-style: italic; } \/* Documentation *\/\n-code span.dt { color: #902000; } \/* DataType *\/\n-code span.dv { color: #40a070; } \/* DecVal *\/\n-code span.er { color: #ff0000; font-weight: bold; } \/* Error *\/\n-code span.ex { } \/* Extension *\/\n-code span.fl { color: #40a070; } \/* Float *\/\n-code span.fu { color: #06287e; } \/* Function *\/\n-code span.im { } \/* Import *\/\n-code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } \/* Information *\/\n-code span.kw { color: #007020; font-weight: bold; } \/* Keyword *\/\n-code span.op { color: #666666; } \/* Operator *\/\n-code span.ot { color: #007020; } \/* Other *\/\n-code span.pp { color: #bc7a00; } \/* Preprocessor *\/\n-code span.sc { color: #4070a0; } \/* SpecialChar *\/\n-code span.ss { color: #bb6688; } \/* SpecialString *\/\n-code span.st { color: #4070a0; } \/* String *\/\n-code span.va { color: #19177c; } \/* Variable *\/\n-code span.vs { color: #4070a0; } \/* VerbatimString *\/\n-code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } \/* Warning *\/\n+  <style>\n+    code{white-space: pre-wrap;}\n+    span.smallcaps{font-variant: small-caps;}\n+    span.underline{text-decoration: underline;}\n+    div.column{display: inline-block; vertical-align: top; width: 50%;}\n+    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}\n+    ul.task-list{list-style: none;}\n+    pre > code.sourceCode { white-space: pre; position: relative; }\n+    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }\n+    pre > code.sourceCode > span:empty { height: 1.2em; }\n+    code.sourceCode > span { color: inherit; text-decoration: inherit; }\n+    div.sourceCode { margin: 1em 0; }\n+    pre.sourceCode { margin: 0; }\n+    @media screen {\n+    div.sourceCode { overflow: auto; }\n+    }\n+    @media print {\n+    pre > code.sourceCode { white-space: pre-wrap; }\n+    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }\n+    }\n+    pre.numberSource code\n+      { counter-reset: source-line 0; }\n+    pre.numberSource code > span\n+      { position: relative; left: -4em; counter-increment: source-line; }\n+    pre.numberSource code > span > a:first-child::before\n+      { content: counter(source-line);\n+        position: relative; left: -1em; text-align: right; vertical-align: baseline;\n+        border: none; display: inline-block;\n+        -webkit-touch-callout: none; -webkit-user-select: none;\n+        -khtml-user-select: none; -moz-user-select: none;\n+        -ms-user-select: none; user-select: none;\n+        padding: 0 4px; width: 4em;\n+        color: #aaaaaa;\n+      }\n+    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }\n+    div.sourceCode\n+      {   }\n+    @media screen {\n+    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }\n+    }\n+    code span.al { color: #ff0000; font-weight: bold; } \/* Alert *\/\n+    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } \/* Annotation *\/\n+    code span.at { color: #7d9029; } \/* Attribute *\/\n+    code span.bn { color: #40a070; } \/* BaseN *\/\n+    code span.bu { } \/* BuiltIn *\/\n+    code span.cf { color: #007020; font-weight: bold; } \/* ControlFlow *\/\n+    code span.ch { color: #4070a0; } \/* Char *\/\n+    code span.cn { color: #880000; } \/* Constant *\/\n+    code span.co { color: #60a0b0; font-style: italic; } \/* Comment *\/\n+    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } \/* CommentVar *\/\n+    code span.do { color: #ba2121; font-style: italic; } \/* Documentation *\/\n+    code span.dt { color: #902000; } \/* DataType *\/\n+    code span.dv { color: #40a070; } \/* DecVal *\/\n+    code span.er { color: #ff0000; font-weight: bold; } \/* Error *\/\n+    code span.ex { } \/* Extension *\/\n+    code span.fl { color: #40a070; } \/* Float *\/\n+    code span.fu { color: #06287e; } \/* Function *\/\n+    code span.im { } \/* Import *\/\n+    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } \/* Information *\/\n+    code span.kw { color: #007020; font-weight: bold; } \/* Keyword *\/\n+    code span.op { color: #666666; } \/* Operator *\/\n+    code span.ot { color: #007020; } \/* Other *\/\n+    code span.pp { color: #bc7a00; } \/* Preprocessor *\/\n+    code span.sc { color: #4070a0; } \/* SpecialChar *\/\n+    code span.ss { color: #bb6688; } \/* SpecialString *\/\n+    code span.st { color: #4070a0; } \/* String *\/\n+    code span.va { color: #19177c; } \/* Variable *\/\n+    code span.vs { color: #4070a0; } \/* VerbatimString *\/\n+    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } \/* Warning *\/\n@@ -78,0 +79,3 @@\n+  <!--[if lt IE 9]>\n+    <script src=\"\/\/cdnjs.cloudflare.com\/ajax\/libs\/html5shiv\/3.7.3\/html5shiv-printshiv.min.js\"><\/script>\n+  <![endif]-->\n@@ -80,1 +84,5 @@\n-<nav id=\"TOC\">\n+<nav id=\"TOC\" role=\"doc-toc\">\n+<ul>\n+<li><a href=\"#using-the-jextract-tool\">Using the <code>jextract<\/code> tool<\/a>\n+<ul>\n+<li><a href=\"#hello-world\">Hello World<\/a>\n@@ -82,2 +90,0 @@\n-<li><a href=\"#using-the-jextract-tool\">Using the <code>jextract<\/code> tool<\/a><ul>\n-<li><a href=\"#hello-world\">Hello World<\/a><ul>\n@@ -91,1 +97,2 @@\n-<li><a href=\"#embedding-python-interpreter-in-your-java-program-mac-os\">Embedding Python interpreter in your Java program (Mac OS)<\/a><ul>\n+<li><a href=\"#embedding-python-interpreter-in-your-java-program-mac-os\">Embedding Python interpreter in your Java program (Mac OS)<\/a>\n+<ul>\n@@ -96,1 +103,2 @@\n-<li><a href=\"#using-readline-library-from-java-code-mac-os\">Using readline library from Java code (Mac OS)<\/a><ul>\n+<li><a href=\"#using-readline-library-from-java-code-mac-os\">Using readline library from Java code (Mac OS)<\/a>\n+<ul>\n@@ -101,1 +109,2 @@\n-<li><a href=\"#using-libcurl-from-java-mac-os\">Using libcurl from Java (Mac OS)<\/a><ul>\n+<li><a href=\"#using-libcurl-from-java-mac-os\">Using libcurl from Java (Mac OS)<\/a>\n+<ul>\n@@ -106,1 +115,2 @@\n-<li><a href=\"#using-blas-library\">Using BLAS library<\/a><ul>\n+<li><a href=\"#using-blas-library\">Using BLAS library<\/a>\n+<ul>\n@@ -112,1 +122,2 @@\n-<li><a href=\"#using-lapack-library-mac-os\">Using LAPACK library (Mac OS)<\/a><ul>\n+<li><a href=\"#using-lapack-library-mac-os\">Using LAPACK library (Mac OS)<\/a>\n+<ul>\n@@ -117,1 +128,2 @@\n-<li><a href=\"#using-libproc-library-to-list-processes-from-java-mac-os\">Using libproc library to list processes from Java (Mac OS)<\/a><ul>\n+<li><a href=\"#using-libproc-library-to-list-processes-from-java-mac-os\">Using libproc library to list processes from Java (Mac OS)<\/a>\n+<ul>\n@@ -122,1 +134,2 @@\n-<li><a href=\"#using-libgit2-from-java-mac-os\">Using libgit2 from Java (Mac OS)<\/a><ul>\n+<li><a href=\"#using-libgit2-from-java-mac-os\">Using libgit2 from Java (Mac OS)<\/a>\n+<ul>\n@@ -129,1 +142,2 @@\n-<li><a href=\"#using-sqlite3-library-from-java-mac-os\">Using sqlite3 library from Java (Mac OS)<\/a><ul>\n+<li><a href=\"#using-sqlite3-library-from-java-mac-os\">Using sqlite3 library from Java (Mac OS)<\/a>\n+<ul>\n@@ -134,1 +148,2 @@\n-<li><a href=\"#using-opengl-library-from-java-mac-os\">Using OpenGL library from Java (Mac OS)<\/a><ul>\n+<li><a href=\"#using-opengl-library-from-java-mac-os\">Using OpenGL library from Java (Mac OS)<\/a>\n+<ul>\n@@ -139,1 +154,2 @@\n-<li><a href=\"#using-tensorflow-mac-os\">Using tensorflow (Mac OS)<\/a><ul>\n+<li><a href=\"#using-tensorflow-mac-os\">Using tensorflow (Mac OS)<\/a>\n+<ul>\n@@ -146,1 +162,2 @@\n-<li><a href=\"#using-time.h-mac-os\">Using time.h (Mac OS)<\/a><ul>\n+<li><a href=\"#using-time.h-mac-os\">Using time.h (Mac OS)<\/a>\n+<ul>\n@@ -151,1 +168,2 @@\n-<li><a href=\"#using-libclang-library-mac-os\">Using libclang library (Mac OS)<\/a><ul>\n+<li><a href=\"#using-libclang-library-mac-os\">Using libclang library (Mac OS)<\/a>\n+<ul>\n@@ -174,1 +192,6 @@\n-<li><code>--filter &lt;String&gt;<\/code> - simple string-based filtering mechanism; only symbols from headers whose absolute path contains the specified string will be included in the generated API<\/li>\n+<li>--include-function <String> - name of function to include<\/li>\n+<li>--include-macro <String> - name of constant macro to include<\/li>\n+<li>--include-struct <String> - name of struct definition to include<\/li>\n+<li>--include-typedef <String> - name of type definition to include<\/li>\n+<li>--include-union <String> - name of union definition to include<\/li>\n+<li>--include-var <String> - name of global variable to include<\/li>\n@@ -180,8 +203,8 @@\n-<div class=\"sourceCode\" id=\"cb1\"><pre class=\"sourceCode c\"><code class=\"sourceCode c\"><a class=\"sourceLine\" id=\"cb1-1\" title=\"1\"><\/a>\n-<a class=\"sourceLine\" id=\"cb1-2\" title=\"2\"><span class=\"pp\">#ifndef helloworld_h<\/span><\/a>\n-<a class=\"sourceLine\" id=\"cb1-3\" title=\"3\"><span class=\"pp\">#define helloworld_h<\/span><\/a>\n-<a class=\"sourceLine\" id=\"cb1-4\" title=\"4\"><\/a>\n-<a class=\"sourceLine\" id=\"cb1-5\" title=\"5\"><span class=\"kw\">extern<\/span> <span class=\"dt\">void<\/span> helloworld(<span class=\"dt\">void<\/span>);<\/a>\n-<a class=\"sourceLine\" id=\"cb1-6\" title=\"6\"><\/a>\n-<a class=\"sourceLine\" id=\"cb1-7\" title=\"7\"><span class=\"pp\">#endif <\/span><span class=\"co\">\/* helloworld_h *\/<\/span><\/a>\n-<a class=\"sourceLine\" id=\"cb1-8\" title=\"8\"><\/a><\/code><\/pre><\/div>\n+<div class=\"sourceCode\" id=\"cb1\"><pre class=\"sourceCode c\"><code class=\"sourceCode c\"><span id=\"cb1-1\"><a href=\"#cb1-1\"><\/a><\/span>\n+<span id=\"cb1-2\"><a href=\"#cb1-2\"><\/a><span class=\"pp\">#ifndef helloworld_h<\/span><\/span>\n+<span id=\"cb1-3\"><a href=\"#cb1-3\"><\/a><span class=\"pp\">#define helloworld_h<\/span><\/span>\n+<span id=\"cb1-4\"><a href=\"#cb1-4\"><\/a><\/span>\n+<span id=\"cb1-5\"><a href=\"#cb1-5\"><\/a><span class=\"kw\">extern<\/span> <span class=\"dt\">void<\/span> helloworld(<span class=\"dt\">void<\/span>);<\/span>\n+<span id=\"cb1-6\"><a href=\"#cb1-6\"><\/a><\/span>\n+<span id=\"cb1-7\"><a href=\"#cb1-7\"><\/a><span class=\"pp\">#endif <\/span><span class=\"co\">\/* helloworld_h *\/<\/span><\/span>\n+<span id=\"cb1-8\"><a href=\"#cb1-8\"><\/a><\/span><\/code><\/pre><\/div>\n@@ -189,8 +212,8 @@\n-<div class=\"sourceCode\" id=\"cb2\"><pre class=\"sourceCode c\"><code class=\"sourceCode c\"><a class=\"sourceLine\" id=\"cb2-1\" title=\"1\"><\/a>\n-<a class=\"sourceLine\" id=\"cb2-2\" title=\"2\"><span class=\"pp\">#include <\/span><span class=\"im\">&lt;stdio.h&gt;<\/span><\/a>\n-<a class=\"sourceLine\" id=\"cb2-3\" title=\"3\"><\/a>\n-<a class=\"sourceLine\" id=\"cb2-4\" title=\"4\"><span class=\"pp\">#include <\/span><span class=\"im\">&quot;helloworld.h&quot;<\/span><\/a>\n-<a class=\"sourceLine\" id=\"cb2-5\" title=\"5\"><\/a>\n-<a class=\"sourceLine\" id=\"cb2-6\" title=\"6\"><span class=\"dt\">void<\/span> helloworld(<span class=\"dt\">void<\/span>) {<\/a>\n-<a class=\"sourceLine\" id=\"cb2-7\" title=\"7\">    printf(<span class=\"st\">&quot;Hello World!<\/span><span class=\"sc\">\\n<\/span><span class=\"st\">&quot;<\/span>);<\/a>\n-<a class=\"sourceLine\" id=\"cb2-8\" title=\"8\">}<\/a><\/code><\/pre><\/div>\n+<div class=\"sourceCode\" id=\"cb2\"><pre class=\"sourceCode c\"><code class=\"sourceCode c\"><span id=\"cb2-1\"><a href=\"#cb2-1\"><\/a><\/span>\n+<span id=\"cb2-2\"><a href=\"#cb2-2\"><\/a><span class=\"pp\">#include <\/span><span class=\"im\">&lt;stdio.h&gt;<\/span><\/span>\n+<span id=\"cb2-3\"><a href=\"#cb2-3\"><\/a><\/span>\n+<span id=\"cb2-4\"><a href=\"#cb2-4\"><\/a><span class=\"pp\">#include <\/span><span class=\"im\">&quot;helloworld.h&quot;<\/span><\/span>\n+<span id=\"cb2-5\"><a href=\"#cb2-5\"><\/a><\/span>\n+<span id=\"cb2-6\"><a href=\"#cb2-6\"><\/a><span class=\"dt\">void<\/span> helloworld(<span class=\"dt\">void<\/span>) {<\/span>\n+<span id=\"cb2-7\"><a href=\"#cb2-7\"><\/a>    printf(<span class=\"st\">&quot;Hello World!<\/span><span class=\"sc\">\\n<\/span><span class=\"st\">&quot;<\/span>);<\/span>\n+<span id=\"cb2-8\"><a href=\"#cb2-8\"><\/a>}<\/span><\/code><\/pre><\/div>\n@@ -198,2 +221,2 @@\n-<div class=\"sourceCode\" id=\"cb3\"><pre class=\"sourceCode sh\"><code class=\"sourceCode bash\"><a class=\"sourceLine\" id=\"cb3-1\" title=\"1\"><\/a>\n-<a class=\"sourceLine\" id=\"cb3-2\" title=\"2\"><span class=\"fu\">cc<\/span> -shared -o libhelloworld.dylib helloworld.c<\/a><\/code><\/pre><\/div>\n+<div class=\"sourceCode\" id=\"cb3\"><pre class=\"sourceCode sh\"><code class=\"sourceCode bash\"><span id=\"cb3-1\"><a href=\"#cb3-1\"><\/a><\/span>\n+<span id=\"cb3-2\"><a href=\"#cb3-2\"><\/a><span class=\"fu\">cc<\/span> -shared -o libhelloworld.dylib helloworld.c<\/span><\/code><\/pre><\/div>\n@@ -201,2 +224,2 @@\n-<div class=\"sourceCode\" id=\"cb4\"><pre class=\"sourceCode sh\"><code class=\"sourceCode bash\"><a class=\"sourceLine\" id=\"cb4-1\" title=\"1\"><\/a>\n-<a class=\"sourceLine\" id=\"cb4-2\" title=\"2\"><span class=\"ex\">jextract<\/span> -t org.hello -lhelloworld helloworld.h<\/a><\/code><\/pre><\/div>\n+<div class=\"sourceCode\" id=\"cb4\"><pre class=\"sourceCode sh\"><code class=\"sourceCode bash\"><span id=\"cb4-1\"><a href=\"#cb4-1\"><\/a><\/span>\n+<span id=\"cb4-2\"><a href=\"#cb4-2\"><\/a><span class=\"ex\">jextract<\/span> -t org.hello -lhelloworld helloworld.h<\/span><\/code><\/pre><\/div>\n@@ -204,8 +227,8 @@\n-<div class=\"sourceCode\" id=\"cb5\"><pre class=\"sourceCode java\"><code class=\"sourceCode java\"><a class=\"sourceLine\" id=\"cb5-1\" title=\"1\"><\/a>\n-<a class=\"sourceLine\" id=\"cb5-2\" title=\"2\"><span class=\"kw\">import static<\/span><span class=\"im\"> org.hello.helloworld_h.*;<\/span><\/a>\n-<a class=\"sourceLine\" id=\"cb5-3\" title=\"3\"><\/a>\n-<a class=\"sourceLine\" id=\"cb5-4\" title=\"4\"><span class=\"kw\">public<\/span> <span class=\"kw\">class<\/span> HelloWorld {<\/a>\n-<a class=\"sourceLine\" id=\"cb5-5\" title=\"5\">    <span class=\"kw\">public<\/span> <span class=\"dt\">static<\/span> <span class=\"dt\">void<\/span> <span class=\"fu\">main<\/span>(<span class=\"bu\">String<\/span>[] args) {<\/a>\n-<a class=\"sourceLine\" id=\"cb5-6\" title=\"6\">        <span class=\"fu\">helloworld<\/span>();<\/a>\n-<a class=\"sourceLine\" id=\"cb5-7\" title=\"7\">    }<\/a>\n-<a class=\"sourceLine\" id=\"cb5-8\" title=\"8\">}<\/a><\/code><\/pre><\/div>\n+<div class=\"sourceCode\" id=\"cb5\"><pre class=\"sourceCode java\"><code class=\"sourceCode java\"><span id=\"cb5-1\"><a href=\"#cb5-1\"><\/a><\/span>\n+<span id=\"cb5-2\"><a href=\"#cb5-2\"><\/a><span class=\"kw\">import static<\/span><span class=\"im\"> org.hello.helloworld_h.*;<\/span><\/span>\n+<span id=\"cb5-3\"><a href=\"#cb5-3\"><\/a><\/span>\n+<span id=\"cb5-4\"><a href=\"#cb5-4\"><\/a><span class=\"kw\">public<\/span> <span class=\"kw\">class<\/span> HelloWorld {<\/span>\n+<span id=\"cb5-5\"><a href=\"#cb5-5\"><\/a>    <span class=\"kw\">public<\/span> <span class=\"dt\">static<\/span> <span class=\"dt\">void<\/span> <span class=\"fu\">main<\/span>(<span class=\"bu\">String<\/span>[] args) {<\/span>\n+<span id=\"cb5-6\"><a href=\"#cb5-6\"><\/a>        <span class=\"fu\">helloworld<\/span>();<\/span>\n+<span id=\"cb5-7\"><a href=\"#cb5-7\"><\/a>    }<\/span>\n+<span id=\"cb5-8\"><a href=\"#cb5-8\"><\/a>}<\/span><\/code><\/pre><\/div>\n@@ -213,2 +236,2 @@\n-<div class=\"sourceCode\" id=\"cb6\"><pre class=\"sourceCode sh\"><code class=\"sourceCode bash\"><a class=\"sourceLine\" id=\"cb6-1\" title=\"1\"><\/a>\n-<a class=\"sourceLine\" id=\"cb6-2\" title=\"2\"><span class=\"ex\">java<\/span> -Dforeign.restricted=permit --add-modules jdk.incubator.foreign HelloWorld.java<\/a><\/code><\/pre><\/div>\n+<div class=\"sourceCode\" id=\"cb6\"><pre class=\"sourceCode sh\"><code class=\"sourceCode bash\"><span id=\"cb6-1\"><a href=\"#cb6-1\"><\/a><\/span>\n+<span id=\"cb6-2\"><a href=\"#cb6-2\"><\/a><span class=\"ex\">java<\/span> --enable-native-access=ALL-UNNAMED --add-modules jdk.incubator.foreign HelloWorld.java<\/span><\/code><\/pre><\/div>\n@@ -217,7 +240,7 @@\n-<div class=\"sourceCode\" id=\"cb7\"><pre class=\"sourceCode sh\"><code class=\"sourceCode bash\"><a class=\"sourceLine\" id=\"cb7-1\" title=\"1\"><\/a>\n-<a class=\"sourceLine\" id=\"cb7-2\" title=\"2\"><span class=\"ex\">jextract<\/span> \\<\/a>\n-<a class=\"sourceLine\" id=\"cb7-3\" title=\"3\">  -l python2.7 \\<\/a>\n-<a class=\"sourceLine\" id=\"cb7-4\" title=\"4\">  -I \/Applications\/Xcode.app\/Contents\/Developer\/Platforms\/MacOSX.platform\/Developer\/SDKs\/MacOSX.sdk\/usr\/include \\<\/a>\n-<a class=\"sourceLine\" id=\"cb7-5\" title=\"5\">  -I \/Applications\/Xcode.app\/Contents\/Developer\/Platforms\/MacOSX.platform\/Developer\/SDKs\/MacOSX.sdk\/usr\/include\/python2.7\/ \\<\/a>\n-<a class=\"sourceLine\" id=\"cb7-6\" title=\"6\">  -t org.python \\<\/a>\n-<a class=\"sourceLine\" id=\"cb7-7\" title=\"7\">   \/Applications\/Xcode.app\/Contents\/Developer\/Platforms\/MacOSX.platform\/Developer\/SDKs\/MacOSX.sdk\/usr\/include\/python2.7\/Python.h<\/a><\/code><\/pre><\/div>\n+<div class=\"sourceCode\" id=\"cb7\"><pre class=\"sourceCode sh\"><code class=\"sourceCode bash\"><span id=\"cb7-1\"><a href=\"#cb7-1\"><\/a><\/span>\n+<span id=\"cb7-2\"><a href=\"#cb7-2\"><\/a><span class=\"ex\">jextract<\/span> \\<\/span>\n+<span id=\"cb7-3\"><a href=\"#cb7-3\"><\/a>  -l python2.7 \\<\/span>\n+<span id=\"cb7-4\"><a href=\"#cb7-4\"><\/a>  -I \/Applications\/Xcode.app\/Contents\/Developer\/Platforms\/MacOSX.platform\/Developer\/SDKs\/MacOSX.sdk\/usr\/include \\<\/span>\n+<span id=\"cb7-5\"><a href=\"#cb7-5\"><\/a>  -I \/Applications\/Xcode.app\/Contents\/Developer\/Platforms\/MacOSX.platform\/Developer\/SDKs\/MacOSX.sdk\/usr\/include\/python2.7\/ \\<\/span>\n+<span id=\"cb7-6\"><a href=\"#cb7-6\"><\/a>  -t org.python \\<\/span>\n+<span id=\"cb7-7\"><a href=\"#cb7-7\"><\/a>   \/Applications\/Xcode.app\/Contents\/Developer\/Platforms\/MacOSX.platform\/Developer\/SDKs\/MacOSX.sdk\/usr\/include\/python2.7\/Python.h<\/span><\/code><\/pre><\/div>\n@@ -225,17 +248,20 @@\n-<div class=\"sourceCode\" id=\"cb8\"><pre class=\"sourceCode java\"><code class=\"sourceCode java\"><a class=\"sourceLine\" id=\"cb8-1\" title=\"1\"><\/a>\n-<a class=\"sourceLine\" id=\"cb8-2\" title=\"2\"><span class=\"kw\">import static<\/span><span class=\"im\"> jdk.incubator.foreign.CLinker.*;<\/span><\/a>\n-<a class=\"sourceLine\" id=\"cb8-3\" title=\"3\"><span class=\"kw\">import static<\/span><span class=\"im\"> jdk.incubator.foreign.MemoryAddress.NULL;<\/span><\/a>\n-<a class=\"sourceLine\" id=\"cb8-4\" title=\"4\"><span class=\"co\">\/\/ import jextracted python &#39;header&#39; class<\/span><\/a>\n-<a class=\"sourceLine\" id=\"cb8-5\" title=\"5\"><span class=\"kw\">import static<\/span><span class=\"im\"> org.python.Python_h.*;<\/span><\/a>\n-<a class=\"sourceLine\" id=\"cb8-6\" title=\"6\"><\/a>\n-<a class=\"sourceLine\" id=\"cb8-7\" title=\"7\"><span class=\"kw\">public<\/span> <span class=\"kw\">class<\/span> PythonMain {<\/a>\n-<a class=\"sourceLine\" id=\"cb8-8\" title=\"8\">    <span class=\"kw\">public<\/span> <span class=\"dt\">static<\/span> <span class=\"dt\">void<\/span> <span class=\"fu\">main<\/span>(<span class=\"bu\">String<\/span>[] args) {<\/a>\n-<a class=\"sourceLine\" id=\"cb8-9\" title=\"9\">        <span class=\"bu\">String<\/span> script = <span class=\"st\">&quot;print(sum([33, 55, 66])); print(&#39;Hello from Python!&#39;)<\/span><span class=\"sc\">\\n<\/span><span class=\"st\">&quot;<\/span>;<\/a>\n-<a class=\"sourceLine\" id=\"cb8-10\" title=\"10\"><\/a>\n-<a class=\"sourceLine\" id=\"cb8-11\" title=\"11\">        <span class=\"fu\">Py_Initialize<\/span>();<\/a>\n-<a class=\"sourceLine\" id=\"cb8-12\" title=\"12\">        <span class=\"kw\">try<\/span> (var str = <span class=\"fu\">toCString<\/span>(script)) {<\/a>\n-<a class=\"sourceLine\" id=\"cb8-13\" title=\"13\">            <span class=\"fu\">PyRun_SimpleStringFlags<\/span>(str, NULL);<\/a>\n-<a class=\"sourceLine\" id=\"cb8-14\" title=\"14\">            <span class=\"fu\">Py_Finalize<\/span>();<\/a>\n-<a class=\"sourceLine\" id=\"cb8-15\" title=\"15\">        }<\/a>\n-<a class=\"sourceLine\" id=\"cb8-16\" title=\"16\">    }<\/a>\n-<a class=\"sourceLine\" id=\"cb8-17\" title=\"17\">}<\/a><\/code><\/pre><\/div>\n+<div class=\"sourceCode\" id=\"cb8\"><pre class=\"sourceCode java\"><code class=\"sourceCode java\"><span id=\"cb8-1\"><a href=\"#cb8-1\"><\/a><\/span>\n+<span id=\"cb8-2\"><a href=\"#cb8-2\"><\/a><span class=\"kw\">import<\/span><span class=\"im\"> jdk.incubator.foreign.ResourceScope;<\/span><\/span>\n+<span id=\"cb8-3\"><a href=\"#cb8-3\"><\/a><span class=\"kw\">import static<\/span><span class=\"im\"> jdk.incubator.foreign.CLinker.*;<\/span><\/span>\n+<span id=\"cb8-4\"><a href=\"#cb8-4\"><\/a><span class=\"kw\">import static<\/span><span class=\"im\"> jdk.incubator.foreign.MemoryAddress.NULL;<\/span><\/span>\n+<span id=\"cb8-5\"><a href=\"#cb8-5\"><\/a><span class=\"co\">\/\/ import jextracted python &#39;header&#39; class<\/span><\/span>\n+<span id=\"cb8-6\"><a href=\"#cb8-6\"><\/a><span class=\"kw\">import static<\/span><span class=\"im\"> org.python.Python_h.*;<\/span><\/span>\n+<span id=\"cb8-7\"><a href=\"#cb8-7\"><\/a><span class=\"kw\">import<\/span><span class=\"im\"> org.python.*;<\/span><\/span>\n+<span id=\"cb8-8\"><a href=\"#cb8-8\"><\/a><\/span>\n+<span id=\"cb8-9\"><a href=\"#cb8-9\"><\/a><span class=\"kw\">public<\/span> <span class=\"kw\">class<\/span> PythonMain {<\/span>\n+<span id=\"cb8-10\"><a href=\"#cb8-10\"><\/a>    <span class=\"kw\">public<\/span> <span class=\"dt\">static<\/span> <span class=\"dt\">void<\/span> <span class=\"fu\">main<\/span>(<span class=\"bu\">String<\/span>[] args) {<\/span>\n+<span id=\"cb8-11\"><a href=\"#cb8-11\"><\/a>        <span class=\"bu\">String<\/span> script = <span class=\"st\">&quot;print(sum([33, 55, 66])); print(&#39;Hello from Python!&#39;)<\/span><span class=\"sc\">\\n<\/span><span class=\"st\">&quot;<\/span>;<\/span>\n+<span id=\"cb8-12\"><a href=\"#cb8-12\"><\/a><\/span>\n+<span id=\"cb8-13\"><a href=\"#cb8-13\"><\/a>        <span class=\"fu\">Py_Initialize<\/span>();<\/span>\n+<span id=\"cb8-14\"><a href=\"#cb8-14\"><\/a>        <span class=\"kw\">try<\/span> (var scope = ResourceScope.<span class=\"fu\">newConfinedScope<\/span>()) {<\/span>\n+<span id=\"cb8-15\"><a href=\"#cb8-15\"><\/a>            var str = <span class=\"fu\">toCString<\/span>(script, scope);<\/span>\n+<span id=\"cb8-16\"><a href=\"#cb8-16\"><\/a>            <span class=\"fu\">PyRun_SimpleStringFlags<\/span>(str, NULL);<\/span>\n+<span id=\"cb8-17\"><a href=\"#cb8-17\"><\/a>            <span class=\"fu\">Py_Finalize<\/span>();<\/span>\n+<span id=\"cb8-18\"><a href=\"#cb8-18\"><\/a>        }<\/span>\n+<span id=\"cb8-19\"><a href=\"#cb8-19\"><\/a>    }<\/span>\n+<span id=\"cb8-20\"><a href=\"#cb8-20\"><\/a>}<\/span><\/code><\/pre><\/div>\n@@ -243,4 +269,4 @@\n-<div class=\"sourceCode\" id=\"cb9\"><pre class=\"sourceCode sh\"><code class=\"sourceCode bash\"><a class=\"sourceLine\" id=\"cb9-1\" title=\"1\"><\/a>\n-<a class=\"sourceLine\" id=\"cb9-2\" title=\"2\"><span class=\"ex\">java<\/span> -Dforeign.restricted=permit --add-modules jdk.incubator.foreign \\<\/a>\n-<a class=\"sourceLine\" id=\"cb9-3\" title=\"3\">    -Djava.library.path=\/System\/Library\/Frameworks\/Python.framework\/Versions\/2.7\/lib \\<\/a>\n-<a class=\"sourceLine\" id=\"cb9-4\" title=\"4\">    PythonMain.java<\/a><\/code><\/pre><\/div>\n+<div class=\"sourceCode\" id=\"cb9\"><pre class=\"sourceCode sh\"><code class=\"sourceCode bash\"><span id=\"cb9-1\"><a href=\"#cb9-1\"><\/a><\/span>\n+<span id=\"cb9-2\"><a href=\"#cb9-2\"><\/a><span class=\"ex\">java<\/span> --enable-native-access=ALL-UNNAMED --add-modules jdk.incubator.foreign \\<\/span>\n+<span id=\"cb9-3\"><a href=\"#cb9-3\"><\/a>    -Djava.library.path=\/System\/Library\/Frameworks\/Python.framework\/Versions\/2.7\/lib \\<\/span>\n+<span id=\"cb9-4\"><a href=\"#cb9-4\"><\/a>    PythonMain.java<\/span><\/code><\/pre><\/div>\n@@ -249,5 +275,5 @@\n-<div class=\"sourceCode\" id=\"cb10\"><pre class=\"sourceCode sh\"><code class=\"sourceCode bash\"><a class=\"sourceLine\" id=\"cb10-1\" title=\"1\"><\/a>\n-<a class=\"sourceLine\" id=\"cb10-2\" title=\"2\"><span class=\"ex\">jextract<\/span> \\<\/a>\n-<a class=\"sourceLine\" id=\"cb10-3\" title=\"3\">  -l readline -t org.unix \\<\/a>\n-<a class=\"sourceLine\" id=\"cb10-4\" title=\"4\">  -I \/Applications\/Xcode.app\/Contents\/Developer\/Platforms\/MacOSX.platform\/Developer\/SDKs\/MacOSX.sdk\/usr\/include \\<\/a>\n-<a class=\"sourceLine\" id=\"cb10-5\" title=\"5\">   \/Applications\/Xcode.app\/Contents\/Developer\/Platforms\/MacOSX.platform\/Developer\/SDKs\/MacOSX.sdk\/usr\/include\/readline\/readline.h<\/a><\/code><\/pre><\/div>\n+<div class=\"sourceCode\" id=\"cb10\"><pre class=\"sourceCode sh\"><code class=\"sourceCode bash\"><span id=\"cb10-1\"><a href=\"#cb10-1\"><\/a><\/span>\n+<span id=\"cb10-2\"><a href=\"#cb10-2\"><\/a><span class=\"ex\">jextract<\/span> \\<\/span>\n+<span id=\"cb10-3\"><a href=\"#cb10-3\"><\/a>  -l readline -t org.unix \\<\/span>\n+<span id=\"cb10-4\"><a href=\"#cb10-4\"><\/a>  -I \/Applications\/Xcode.app\/Contents\/Developer\/Platforms\/MacOSX.platform\/Developer\/SDKs\/MacOSX.sdk\/usr\/include \\<\/span>\n+<span id=\"cb10-5\"><a href=\"#cb10-5\"><\/a>   \/Applications\/Xcode.app\/Contents\/Developer\/Platforms\/MacOSX.platform\/Developer\/SDKs\/MacOSX.sdk\/usr\/include\/readline\/readline.h<\/span><\/code><\/pre><\/div>\n@@ -255,17 +281,23 @@\n-<div class=\"sourceCode\" id=\"cb11\"><pre class=\"sourceCode java\"><code class=\"sourceCode java\"><a class=\"sourceLine\" id=\"cb11-1\" title=\"1\"><\/a>\n-<a class=\"sourceLine\" id=\"cb11-2\" title=\"2\"><span class=\"kw\">import static<\/span><span class=\"im\"> org.unix.readline_h.*;<\/span><\/a>\n-<a class=\"sourceLine\" id=\"cb11-3\" title=\"3\"><span class=\"kw\">import static<\/span><span class=\"im\"> jdk.incubator.foreign.CLinker.*;<\/span><\/a>\n-<a class=\"sourceLine\" id=\"cb11-4\" title=\"4\"><\/a>\n-<a class=\"sourceLine\" id=\"cb11-5\" title=\"5\"><span class=\"kw\">public<\/span> <span class=\"kw\">class<\/span> Readline {<\/a>\n-<a class=\"sourceLine\" id=\"cb11-6\" title=\"6\">    <span class=\"kw\">public<\/span> <span class=\"dt\">static<\/span> <span class=\"dt\">void<\/span> <span class=\"fu\">main<\/span>(<span class=\"bu\">String<\/span>[] args) {<\/a>\n-<a class=\"sourceLine\" id=\"cb11-7\" title=\"7\">        <span class=\"kw\">try<\/span> (var str = <span class=\"fu\">toCString<\/span>(<span class=\"st\">&quot;name? &quot;<\/span>)) {<\/a>\n-<a class=\"sourceLine\" id=\"cb11-8\" title=\"8\">            <span class=\"co\">\/\/ call &quot;readline&quot; API<\/span><\/a>\n-<a class=\"sourceLine\" id=\"cb11-9\" title=\"9\">            var p = <span class=\"fu\">readline<\/span>(str);<\/a>\n-<a class=\"sourceLine\" id=\"cb11-10\" title=\"10\"><\/a>\n-<a class=\"sourceLine\" id=\"cb11-11\" title=\"11\">            <span class=\"co\">\/\/ print char* as is<\/span><\/a>\n-<a class=\"sourceLine\" id=\"cb11-12\" title=\"12\">            <span class=\"bu\">System<\/span>.<span class=\"fu\">out<\/span>.<span class=\"fu\">println<\/span>(p);<\/a>\n-<a class=\"sourceLine\" id=\"cb11-13\" title=\"13\">            <span class=\"co\">\/\/ convert char* ptr from readline as Java String &amp; print it<\/span><\/a>\n-<a class=\"sourceLine\" id=\"cb11-14\" title=\"14\">            <span class=\"bu\">System<\/span>.<span class=\"fu\">out<\/span>.<span class=\"fu\">println<\/span>(<span class=\"st\">&quot;Hello, &quot;<\/span> + <span class=\"fu\">toJavaStringRestricted<\/span>(p));<\/a>\n-<a class=\"sourceLine\" id=\"cb11-15\" title=\"15\">        }<\/a>\n-<a class=\"sourceLine\" id=\"cb11-16\" title=\"16\">    }<\/a>\n-<a class=\"sourceLine\" id=\"cb11-17\" title=\"17\">}<\/a><\/code><\/pre><\/div>\n+<div class=\"sourceCode\" id=\"cb11\"><pre class=\"sourceCode java\"><code class=\"sourceCode java\"><span id=\"cb11-1\"><a href=\"#cb11-1\"><\/a><\/span>\n+<span id=\"cb11-2\"><a href=\"#cb11-2\"><\/a><span class=\"kw\">import<\/span><span class=\"im\"> jdk.incubator.foreign.ResourceScope;<\/span><\/span>\n+<span id=\"cb11-3\"><a href=\"#cb11-3\"><\/a><span class=\"kw\">import static<\/span><span class=\"im\"> org.unix.readline_h.*;<\/span><\/span>\n+<span id=\"cb11-4\"><a href=\"#cb11-4\"><\/a><span class=\"kw\">import static<\/span><span class=\"im\"> jdk.incubator.foreign.CLinker.*;<\/span><\/span>\n+<span id=\"cb11-5\"><a href=\"#cb11-5\"><\/a><span class=\"kw\">import<\/span><span class=\"im\"> org.unix.*;<\/span><\/span>\n+<span id=\"cb11-6\"><a href=\"#cb11-6\"><\/a><\/span>\n+<span id=\"cb11-7\"><a href=\"#cb11-7\"><\/a><span class=\"kw\">public<\/span> <span class=\"kw\">class<\/span> Readline {<\/span>\n+<span id=\"cb11-8\"><a href=\"#cb11-8\"><\/a>    <span class=\"kw\">public<\/span> <span class=\"dt\">static<\/span> <span class=\"dt\">void<\/span> <span class=\"fu\">main<\/span>(<span class=\"bu\">String<\/span>[] args) {<\/span>\n+<span id=\"cb11-9\"><a href=\"#cb11-9\"><\/a>       <span class=\"kw\">try<\/span> (var scope = ResourceScope.<span class=\"fu\">newConfinedScope<\/span>()) {<\/span>\n+<span id=\"cb11-10\"><a href=\"#cb11-10\"><\/a>            var url = <span class=\"fu\">toCString<\/span>(<span class=\"st\">&quot;name? &quot;<\/span>, scope);<\/span>\n+<span id=\"cb11-11\"><a href=\"#cb11-11\"><\/a><\/span>\n+<span id=\"cb11-12\"><a href=\"#cb11-12\"><\/a>            <span class=\"co\">\/\/ call &quot;readline&quot; API<\/span><\/span>\n+<span id=\"cb11-13\"><a href=\"#cb11-13\"><\/a>            var p = <span class=\"fu\">readline<\/span>(url);<\/span>\n+<span id=\"cb11-14\"><a href=\"#cb11-14\"><\/a><\/span>\n+<span id=\"cb11-15\"><a href=\"#cb11-15\"><\/a>            <span class=\"co\">\/\/ print char* as is<\/span><\/span>\n+<span id=\"cb11-16\"><a href=\"#cb11-16\"><\/a>            <span class=\"bu\">System<\/span>.<span class=\"fu\">out<\/span>.<span class=\"fu\">println<\/span>(p);<\/span>\n+<span id=\"cb11-17\"><a href=\"#cb11-17\"><\/a>            <span class=\"co\">\/\/ convert char* ptr from readline as Java String &amp; print it<\/span><\/span>\n+<span id=\"cb11-18\"><a href=\"#cb11-18\"><\/a>            <span class=\"bu\">System<\/span>.<span class=\"fu\">out<\/span>.<span class=\"fu\">println<\/span>(<span class=\"st\">&quot;Hello, &quot;<\/span> + <span class=\"fu\">toJavaString<\/span>(p));<\/span>\n+<span id=\"cb11-19\"><a href=\"#cb11-19\"><\/a><\/span>\n+<span id=\"cb11-20\"><a href=\"#cb11-20\"><\/a>            <span class=\"fu\">freeMemory<\/span>(p);<\/span>\n+<span id=\"cb11-21\"><a href=\"#cb11-21\"><\/a>        }<\/span>\n+<span id=\"cb11-22\"><a href=\"#cb11-22\"><\/a>    }<\/span>\n+<span id=\"cb11-23\"><a href=\"#cb11-23\"><\/a>}<\/span><\/code><\/pre><\/div>\n@@ -273,1 +305,1 @@\n-<pre><code>java -Dforeign.restricted=permit --add-modules jdk.incubator.foreign \\\n+<pre><code>java --enable-native-access=ALL-UNNAMED --add-modules jdk.incubator.foreign \\\n@@ -278,5 +310,5 @@\n-<div class=\"sourceCode\" id=\"cb13\"><pre class=\"sourceCode sh\"><code class=\"sourceCode bash\"><a class=\"sourceLine\" id=\"cb13-1\" title=\"1\"><\/a>\n-<a class=\"sourceLine\" id=\"cb13-2\" title=\"2\"><span class=\"ex\">jextract<\/span> -t org.unix -lcurl \\<\/a>\n-<a class=\"sourceLine\" id=\"cb13-3\" title=\"3\">  -I \/Applications\/Xcode.app\/Contents\/Developer\/Platforms\/MacOSX.platform\/Developer\/SDKs\/MacOSX.sdk\/usr\/include\/ \\<\/a>\n-<a class=\"sourceLine\" id=\"cb13-4\" title=\"4\">  -I \/Applications\/Xcode.app\/Contents\/Developer\/Platforms\/MacOSX.platform\/Developer\/SDKs\/MacOSX.sdk\/usr\/include\/curl\/ \\<\/a>\n-<a class=\"sourceLine\" id=\"cb13-5\" title=\"5\">  \/Applications\/Xcode.app\/Contents\/Developer\/Platforms\/MacOSX.platform\/Developer\/SDKs\/MacOSX.sdk\/usr\/include\/curl\/curl.h<\/a><\/code><\/pre><\/div>\n+<div class=\"sourceCode\" id=\"cb13\"><pre class=\"sourceCode sh\"><code class=\"sourceCode bash\"><span id=\"cb13-1\"><a href=\"#cb13-1\"><\/a><\/span>\n+<span id=\"cb13-2\"><a href=\"#cb13-2\"><\/a><span class=\"ex\">jextract<\/span> -t org.unix -lcurl \\<\/span>\n+<span id=\"cb13-3\"><a href=\"#cb13-3\"><\/a>  -I \/Applications\/Xcode.app\/Contents\/Developer\/Platforms\/MacOSX.platform\/Developer\/SDKs\/MacOSX.sdk\/usr\/include\/ \\<\/span>\n+<span id=\"cb13-4\"><a href=\"#cb13-4\"><\/a>  -I \/Applications\/Xcode.app\/Contents\/Developer\/Platforms\/MacOSX.platform\/Developer\/SDKs\/MacOSX.sdk\/usr\/include\/curl\/ \\<\/span>\n+<span id=\"cb13-5\"><a href=\"#cb13-5\"><\/a>  \/Applications\/Xcode.app\/Contents\/Developer\/Platforms\/MacOSX.platform\/Developer\/SDKs\/MacOSX.sdk\/usr\/include\/curl\/curl.h<\/span><\/code><\/pre><\/div>\n@@ -284,24 +316,27 @@\n-<div class=\"sourceCode\" id=\"cb14\"><pre class=\"sourceCode java\"><code class=\"sourceCode java\"><a class=\"sourceLine\" id=\"cb14-1\" title=\"1\"><\/a>\n-<a class=\"sourceLine\" id=\"cb14-2\" title=\"2\"><span class=\"kw\">import static<\/span><span class=\"im\"> jdk.incubator.foreign.MemoryAddress.NULL;<\/span><\/a>\n-<a class=\"sourceLine\" id=\"cb14-3\" title=\"3\"><span class=\"kw\">import static<\/span><span class=\"im\"> org.jextract.curl_h.*;<\/span><\/a>\n-<a class=\"sourceLine\" id=\"cb14-4\" title=\"4\"><span class=\"kw\">import static<\/span><span class=\"im\"> jdk.incubator.foreign.CLinker.*;<\/span><\/a>\n-<a class=\"sourceLine\" id=\"cb14-5\" title=\"5\"><\/a>\n-<a class=\"sourceLine\" id=\"cb14-6\" title=\"6\"><span class=\"kw\">public<\/span> <span class=\"kw\">class<\/span> CurlMain {<\/a>\n-<a class=\"sourceLine\" id=\"cb14-7\" title=\"7\">   <span class=\"kw\">public<\/span> <span class=\"dt\">static<\/span> <span class=\"dt\">void<\/span> <span class=\"fu\">main<\/span>(<span class=\"bu\">String<\/span>[] args) {<\/a>\n-<a class=\"sourceLine\" id=\"cb14-8\" title=\"8\">       var urlStr = args[<span class=\"dv\">0<\/span>];<\/a>\n-<a class=\"sourceLine\" id=\"cb14-9\" title=\"9\">       <span class=\"fu\">curl_global_init<\/span>(<span class=\"fu\">CURL_GLOBAL_DEFAULT<\/span>());<\/a>\n-<a class=\"sourceLine\" id=\"cb14-10\" title=\"10\">       var curl = <span class=\"fu\">curl_easy_init<\/span>();<\/a>\n-<a class=\"sourceLine\" id=\"cb14-11\" title=\"11\">       <span class=\"kw\">if<\/span>(!curl.<span class=\"fu\">equals<\/span>(NULL)) {<\/a>\n-<a class=\"sourceLine\" id=\"cb14-12\" title=\"12\">           <span class=\"kw\">try<\/span> (var url = <span class=\"fu\">toCString<\/span>(urlStr)) {<\/a>\n-<a class=\"sourceLine\" id=\"cb14-13\" title=\"13\">               <span class=\"fu\">curl_easy_setopt<\/span>(curl, <span class=\"fu\">CURLOPT_URL<\/span>(), url.<span class=\"fu\">address<\/span>());<\/a>\n-<a class=\"sourceLine\" id=\"cb14-14\" title=\"14\">               <span class=\"dt\">int<\/span> res = <span class=\"fu\">curl_easy_perform<\/span>(curl);<\/a>\n-<a class=\"sourceLine\" id=\"cb14-15\" title=\"15\">               <span class=\"kw\">if<\/span> (res != <span class=\"fu\">CURLE_OK<\/span>()) {<\/a>\n-<a class=\"sourceLine\" id=\"cb14-16\" title=\"16\">                   <span class=\"bu\">String<\/span> error = <span class=\"fu\">toJavaStringRestricted<\/span>(<span class=\"fu\">curl_easy_strerror<\/span>(res));<\/a>\n-<a class=\"sourceLine\" id=\"cb14-17\" title=\"17\">                   <span class=\"bu\">System<\/span>.<span class=\"fu\">out<\/span>.<span class=\"fu\">println<\/span>(<span class=\"st\">&quot;Curl error: &quot;<\/span> + error);<\/a>\n-<a class=\"sourceLine\" id=\"cb14-18\" title=\"18\">                   <span class=\"fu\">curl_easy_cleanup<\/span>(curl);<\/a>\n-<a class=\"sourceLine\" id=\"cb14-19\" title=\"19\">               }<\/a>\n-<a class=\"sourceLine\" id=\"cb14-20\" title=\"20\">           }<\/a>\n-<a class=\"sourceLine\" id=\"cb14-21\" title=\"21\">       }<\/a>\n-<a class=\"sourceLine\" id=\"cb14-22\" title=\"22\">       <span class=\"fu\">curl_global_cleanup<\/span>();<\/a>\n-<a class=\"sourceLine\" id=\"cb14-23\" title=\"23\">   }<\/a>\n-<a class=\"sourceLine\" id=\"cb14-24\" title=\"24\">}<\/a><\/code><\/pre><\/div>\n+<div class=\"sourceCode\" id=\"cb14\"><pre class=\"sourceCode java\"><code class=\"sourceCode java\"><span id=\"cb14-1\"><a href=\"#cb14-1\"><\/a><\/span>\n+<span id=\"cb14-2\"><a href=\"#cb14-2\"><\/a><span class=\"kw\">import<\/span><span class=\"im\"> jdk.incubator.foreign.ResourceScope;<\/span><\/span>\n+<span id=\"cb14-3\"><a href=\"#cb14-3\"><\/a><span class=\"kw\">import static<\/span><span class=\"im\"> jdk.incubator.foreign.MemoryAddress.NULL;<\/span><\/span>\n+<span id=\"cb14-4\"><a href=\"#cb14-4\"><\/a><span class=\"kw\">import static<\/span><span class=\"im\"> org.jextract.curl_h.*;<\/span><\/span>\n+<span id=\"cb14-5\"><a href=\"#cb14-5\"><\/a><span class=\"kw\">import static<\/span><span class=\"im\"> jdk.incubator.foreign.CLinker.*;<\/span><\/span>\n+<span id=\"cb14-6\"><a href=\"#cb14-6\"><\/a><span class=\"kw\">import<\/span><span class=\"im\"> org.jextract.*;<\/span><\/span>\n+<span id=\"cb14-7\"><a href=\"#cb14-7\"><\/a><\/span>\n+<span id=\"cb14-8\"><a href=\"#cb14-8\"><\/a><span class=\"kw\">public<\/span> <span class=\"kw\">class<\/span> CurlMain {<\/span>\n+<span id=\"cb14-9\"><a href=\"#cb14-9\"><\/a>   <span class=\"kw\">public<\/span> <span class=\"dt\">static<\/span> <span class=\"dt\">void<\/span> <span class=\"fu\">main<\/span>(<span class=\"bu\">String<\/span>[] args) {<\/span>\n+<span id=\"cb14-10\"><a href=\"#cb14-10\"><\/a>       var urlStr = args[<span class=\"dv\">0<\/span>];<\/span>\n+<span id=\"cb14-11\"><a href=\"#cb14-11\"><\/a>       <span class=\"fu\">curl_global_init<\/span>(<span class=\"fu\">CURL_GLOBAL_DEFAULT<\/span>());<\/span>\n+<span id=\"cb14-12\"><a href=\"#cb14-12\"><\/a>       var curl = <span class=\"fu\">curl_easy_init<\/span>();<\/span>\n+<span id=\"cb14-13\"><a href=\"#cb14-13\"><\/a>       <span class=\"kw\">if<\/span>(!curl.<span class=\"fu\">equals<\/span>(NULL)) {<\/span>\n+<span id=\"cb14-14\"><a href=\"#cb14-14\"><\/a>           <span class=\"kw\">try<\/span> (var scope = ResourceScope.<span class=\"fu\">newConfinedScope<\/span>()) {<\/span>\n+<span id=\"cb14-15\"><a href=\"#cb14-15\"><\/a>               var url = <span class=\"fu\">toCString<\/span>(urlStr, scope);<\/span>\n+<span id=\"cb14-16\"><a href=\"#cb14-16\"><\/a>               <span class=\"fu\">curl_easy_setopt<\/span>(curl, <span class=\"fu\">CURLOPT_URL<\/span>(), url.<span class=\"fu\">address<\/span>());<\/span>\n+<span id=\"cb14-17\"><a href=\"#cb14-17\"><\/a>               <span class=\"dt\">int<\/span> res = <span class=\"fu\">curl_easy_perform<\/span>(curl);<\/span>\n+<span id=\"cb14-18\"><a href=\"#cb14-18\"><\/a>               <span class=\"kw\">if<\/span> (res != <span class=\"fu\">CURLE_OK<\/span>()) {<\/span>\n+<span id=\"cb14-19\"><a href=\"#cb14-19\"><\/a>                   <span class=\"bu\">String<\/span> error = <span class=\"fu\">toJavaString<\/span>(<span class=\"fu\">curl_easy_strerror<\/span>(res));<\/span>\n+<span id=\"cb14-20\"><a href=\"#cb14-20\"><\/a>                   <span class=\"bu\">System<\/span>.<span class=\"fu\">out<\/span>.<span class=\"fu\">println<\/span>(<span class=\"st\">&quot;Curl error: &quot;<\/span> + error);<\/span>\n+<span id=\"cb14-21\"><a href=\"#cb14-21\"><\/a>                   <span class=\"fu\">curl_easy_cleanup<\/span>(curl);<\/span>\n+<span id=\"cb14-22\"><a href=\"#cb14-22\"><\/a>               }<\/span>\n+<span id=\"cb14-23\"><a href=\"#cb14-23\"><\/a>           }<\/span>\n+<span id=\"cb14-24\"><a href=\"#cb14-24\"><\/a>       }<\/span>\n+<span id=\"cb14-25\"><a href=\"#cb14-25\"><\/a>       <span class=\"fu\">curl_global_cleanup<\/span>();<\/span>\n+<span id=\"cb14-26\"><a href=\"#cb14-26\"><\/a>   }<\/span>\n+<span id=\"cb14-27\"><a href=\"#cb14-27\"><\/a>}<\/span><\/code><\/pre><\/div>\n@@ -309,4 +344,4 @@\n-<div class=\"sourceCode\" id=\"cb15\"><pre class=\"sourceCode sh\"><code class=\"sourceCode bash\"><a class=\"sourceLine\" id=\"cb15-1\" title=\"1\"><\/a>\n-<a class=\"sourceLine\" id=\"cb15-2\" title=\"2\"><span class=\"co\"># run this shell script by passing a URL as first argument<\/span><\/a>\n-<a class=\"sourceLine\" id=\"cb15-3\" title=\"3\"><span class=\"ex\">java<\/span> -Dforeign.restricted=permit --add-modules jdk.incubator.foreign \\<\/a>\n-<a class=\"sourceLine\" id=\"cb15-4\" title=\"4\">    -Djava.library.path=\/usr\/lib CurlMain.java <span class=\"va\">$*<\/span><\/a><\/code><\/pre><\/div>\n+<div class=\"sourceCode\" id=\"cb15\"><pre class=\"sourceCode sh\"><code class=\"sourceCode bash\"><span id=\"cb15-1\"><a href=\"#cb15-1\"><\/a><\/span>\n+<span id=\"cb15-2\"><a href=\"#cb15-2\"><\/a><span class=\"co\"># run this shell script by passing a URL as first argument<\/span><\/span>\n+<span id=\"cb15-3\"><a href=\"#cb15-3\"><\/a><span class=\"ex\">java<\/span> --enable-native-access=ALL-UNNAMED --add-modules jdk.incubator.foreign \\<\/span>\n+<span id=\"cb15-4\"><a href=\"#cb15-4\"><\/a>    -Djava.library.path=\/usr\/lib CurlMain.java <span class=\"va\">$*<\/span><\/span><\/code><\/pre><\/div>\n@@ -319,2 +354,2 @@\n-<div class=\"sourceCode\" id=\"cb16\"><pre class=\"sourceCode sh\"><code class=\"sourceCode bash\"><a class=\"sourceLine\" id=\"cb16-1\" title=\"1\"><\/a>\n-<a class=\"sourceLine\" id=\"cb16-2\" title=\"2\"><span class=\"ex\">brew<\/span> install openblas<\/a><\/code><\/pre><\/div>\n+<div class=\"sourceCode\" id=\"cb16\"><pre class=\"sourceCode sh\"><code class=\"sourceCode bash\"><span id=\"cb16-1\"><a href=\"#cb16-1\"><\/a><\/span>\n+<span id=\"cb16-2\"><a href=\"#cb16-2\"><\/a><span class=\"ex\">brew<\/span> install openblas<\/span><\/code><\/pre><\/div>\n@@ -324,4 +359,4 @@\n-<div class=\"sourceCode\" id=\"cb17\"><pre class=\"sourceCode sh\"><code class=\"sourceCode bash\"><a class=\"sourceLine\" id=\"cb17-1\" title=\"1\"><\/a>\n-<a class=\"sourceLine\" id=\"cb17-2\" title=\"2\"><span class=\"ex\">jextract<\/span> -C <span class=\"st\">&quot;-D FORCE_OPENBLAS_COMPLEX_STRUCT&quot;<\/span> \\<\/a>\n-<a class=\"sourceLine\" id=\"cb17-3\" title=\"3\">  -I \/Applications\/Xcode.app\/Contents\/Developer\/Platforms\/MacOSX.platform\/Developer\/SDKs\/MacOSX.sdk\/usr\/include \\<\/a>\n-<a class=\"sourceLine\" id=\"cb17-4\" title=\"4\">  -l openblas -t blas \/usr\/local\/opt\/openblas\/include\/cblas.h<\/a><\/code><\/pre><\/div>\n+<div class=\"sourceCode\" id=\"cb17\"><pre class=\"sourceCode sh\"><code class=\"sourceCode bash\"><span id=\"cb17-1\"><a href=\"#cb17-1\"><\/a><\/span>\n+<span id=\"cb17-2\"><a href=\"#cb17-2\"><\/a><span class=\"ex\">jextract<\/span> -C <span class=\"st\">&quot;-D FORCE_OPENBLAS_COMPLEX_STRUCT&quot;<\/span> \\<\/span>\n+<span id=\"cb17-3\"><a href=\"#cb17-3\"><\/a>  -I \/Applications\/Xcode.app\/Contents\/Developer\/Platforms\/MacOSX.platform\/Developer\/SDKs\/MacOSX.sdk\/usr\/include \\<\/span>\n+<span id=\"cb17-4\"><a href=\"#cb17-4\"><\/a>  -l openblas -t blas \/usr\/local\/opt\/openblas\/include\/cblas.h<\/span><\/code><\/pre><\/div>\n@@ -329,47 +364,49 @@\n-<div class=\"sourceCode\" id=\"cb18\"><pre class=\"sourceCode java\"><code class=\"sourceCode java\"><a class=\"sourceLine\" id=\"cb18-1\" title=\"1\"><\/a>\n-<a class=\"sourceLine\" id=\"cb18-2\" title=\"2\"><span class=\"kw\">import<\/span><span class=\"im\"> jdk.incubator.foreign.MemoryAddress;<\/span><\/a>\n-<a class=\"sourceLine\" id=\"cb18-3\" title=\"3\"><span class=\"kw\">import<\/span><span class=\"im\"> jdk.incubator.foreign.MemoryAccess;<\/span><\/a>\n-<a class=\"sourceLine\" id=\"cb18-4\" title=\"4\"><span class=\"kw\">import<\/span><span class=\"im\"> jdk.incubator.foreign.NativeScope;<\/span><\/a>\n-<a class=\"sourceLine\" id=\"cb18-5\" title=\"5\"><span class=\"kw\">import<\/span><span class=\"im\"> blas.*;<\/span><\/a>\n-<a class=\"sourceLine\" id=\"cb18-6\" title=\"6\"><span class=\"kw\">import static<\/span><span class=\"im\"> blas.cblas_h.*;<\/span><\/a>\n-<a class=\"sourceLine\" id=\"cb18-7\" title=\"7\"><span class=\"kw\">import static<\/span><span class=\"im\"> jdk.incubator.foreign.CLinker.*;<\/span><\/a>\n-<a class=\"sourceLine\" id=\"cb18-8\" title=\"8\"><\/a>\n-<a class=\"sourceLine\" id=\"cb18-9\" title=\"9\"><span class=\"kw\">public<\/span> <span class=\"kw\">class<\/span> TestBlas {<\/a>\n-<a class=\"sourceLine\" id=\"cb18-10\" title=\"10\">    <span class=\"kw\">public<\/span> <span class=\"dt\">static<\/span> <span class=\"dt\">void<\/span> <span class=\"fu\">main<\/span>(<span class=\"bu\">String<\/span>[] args) {<\/a>\n-<a class=\"sourceLine\" id=\"cb18-11\" title=\"11\">        <span class=\"dt\">int<\/span> Layout;<\/a>\n-<a class=\"sourceLine\" id=\"cb18-12\" title=\"12\">        <span class=\"dt\">int<\/span> transa;<\/a>\n-<a class=\"sourceLine\" id=\"cb18-13\" title=\"13\"><\/a>\n-<a class=\"sourceLine\" id=\"cb18-14\" title=\"14\">        <span class=\"dt\">double<\/span> alpha, beta;<\/a>\n-<a class=\"sourceLine\" id=\"cb18-15\" title=\"15\">        <span class=\"dt\">int<\/span> m, n, lda, incx, incy, i;<\/a>\n-<a class=\"sourceLine\" id=\"cb18-16\" title=\"16\"><\/a>\n-<a class=\"sourceLine\" id=\"cb18-17\" title=\"17\">        Layout = <span class=\"fu\">CblasColMajor<\/span>();<\/a>\n-<a class=\"sourceLine\" id=\"cb18-18\" title=\"18\">        transa = <span class=\"fu\">CblasNoTrans<\/span>();<\/a>\n-<a class=\"sourceLine\" id=\"cb18-19\" title=\"19\"><\/a>\n-<a class=\"sourceLine\" id=\"cb18-20\" title=\"20\">        m = <span class=\"dv\">4<\/span>; <span class=\"co\">\/* Size of Column ( the number of rows ) *\/<\/span><\/a>\n-<a class=\"sourceLine\" id=\"cb18-21\" title=\"21\">        n = <span class=\"dv\">4<\/span>; <span class=\"co\">\/* Size of Row ( the number of columns ) *\/<\/span><\/a>\n-<a class=\"sourceLine\" id=\"cb18-22\" title=\"22\">        lda = <span class=\"dv\">4<\/span>; <span class=\"co\">\/* Leading dimension of 5 * 4 matrix is 5 *\/<\/span><\/a>\n-<a class=\"sourceLine\" id=\"cb18-23\" title=\"23\">        incx = <span class=\"dv\">1<\/span>;<\/a>\n-<a class=\"sourceLine\" id=\"cb18-24\" title=\"24\">        incy = <span class=\"dv\">1<\/span>;<\/a>\n-<a class=\"sourceLine\" id=\"cb18-25\" title=\"25\">        alpha = <span class=\"dv\">1<\/span>;<\/a>\n-<a class=\"sourceLine\" id=\"cb18-26\" title=\"26\">        beta = <span class=\"dv\">0<\/span>;<\/a>\n-<a class=\"sourceLine\" id=\"cb18-27\" title=\"27\"><\/a>\n-<a class=\"sourceLine\" id=\"cb18-28\" title=\"28\">        <span class=\"kw\">try<\/span> (var scope = NativeScope.<span class=\"fu\">unboundedScope<\/span>()) {<\/a>\n-<a class=\"sourceLine\" id=\"cb18-29\" title=\"29\">            var a = scope.<span class=\"fu\">allocateArray<\/span>(C_DOUBLE, <span class=\"kw\">new<\/span> <span class=\"dt\">double<\/span>[] {<\/a>\n-<a class=\"sourceLine\" id=\"cb18-30\" title=\"30\">                <span class=\"fl\">1.<\/span><span class=\"dv\">0<\/span>, <span class=\"fl\">2.<\/span><span class=\"dv\">0<\/span>, <span class=\"fl\">3.<\/span><span class=\"dv\">0<\/span>, <span class=\"fl\">4.<\/span><span class=\"dv\">0<\/span>,<\/a>\n-<a class=\"sourceLine\" id=\"cb18-31\" title=\"31\">                <span class=\"fl\">1.<\/span><span class=\"dv\">0<\/span>, <span class=\"fl\">1.<\/span><span class=\"dv\">0<\/span>, <span class=\"fl\">1.<\/span><span class=\"dv\">0<\/span>, <span class=\"fl\">1.<\/span><span class=\"dv\">0<\/span>,<\/a>\n-<a class=\"sourceLine\" id=\"cb18-32\" title=\"32\">                <span class=\"fl\">3.<\/span><span class=\"dv\">0<\/span>, <span class=\"fl\">4.<\/span><span class=\"dv\">0<\/span>, <span class=\"fl\">5.<\/span><span class=\"dv\">0<\/span>, <span class=\"fl\">6.<\/span><span class=\"dv\">0<\/span>,<\/a>\n-<a class=\"sourceLine\" id=\"cb18-33\" title=\"33\">                <span class=\"fl\">5.<\/span><span class=\"dv\">0<\/span>, <span class=\"fl\">6.<\/span><span class=\"dv\">0<\/span>, <span class=\"fl\">7.<\/span><span class=\"dv\">0<\/span>, <span class=\"fl\">8.<\/span><span class=\"dv\">0<\/span><\/a>\n-<a class=\"sourceLine\" id=\"cb18-34\" title=\"34\">            });<\/a>\n-<a class=\"sourceLine\" id=\"cb18-35\" title=\"35\">            var x = scope.<span class=\"fu\">allocateArray<\/span>(C_DOUBLE, <span class=\"kw\">new<\/span> <span class=\"dt\">double<\/span>[] {<\/a>\n-<a class=\"sourceLine\" id=\"cb18-36\" title=\"36\">                <span class=\"fl\">1.<\/span><span class=\"dv\">0<\/span>, <span class=\"fl\">2.<\/span><span class=\"dv\">0<\/span>, <span class=\"fl\">1.<\/span><span class=\"dv\">0<\/span>, <span class=\"fl\">1.<\/span><span class=\"dv\">0<\/span><\/a>\n-<a class=\"sourceLine\" id=\"cb18-37\" title=\"37\">            });<\/a>\n-<a class=\"sourceLine\" id=\"cb18-38\" title=\"38\">            var y = scope.<span class=\"fu\">allocateArray<\/span>(C_DOUBLE, n);<\/a>\n-<a class=\"sourceLine\" id=\"cb18-39\" title=\"39\"><\/a>\n-<a class=\"sourceLine\" id=\"cb18-40\" title=\"40\">            <span class=\"fu\">cblas_dgemv<\/span>(Layout, transa, m, n, alpha, a, lda, x, incx, beta, y, incy);<\/a>\n-<a class=\"sourceLine\" id=\"cb18-41\" title=\"41\">            <span class=\"co\">\/* Print y *\/<\/span><\/a>\n-<a class=\"sourceLine\" id=\"cb18-42\" title=\"42\">            <span class=\"kw\">for<\/span> (i = <span class=\"dv\">0<\/span>; i &lt; n; i++) {<\/a>\n-<a class=\"sourceLine\" id=\"cb18-43\" title=\"43\">                <span class=\"bu\">System<\/span>.<span class=\"fu\">out<\/span>.<span class=\"fu\">print<\/span>(<span class=\"bu\">String<\/span><span class=\"fu\">.format<\/span>(<span class=\"st\">&quot; y<\/span><span class=\"sc\">%d<\/span><span class=\"st\"> = <\/span><span class=\"sc\">%f\\n<\/span><span class=\"st\">&quot;<\/span>, i, MemoryAccess.<span class=\"fu\">getDoubleAtIndex<\/span>(y, i)));<\/a>\n-<a class=\"sourceLine\" id=\"cb18-44\" title=\"44\">            }<\/a>\n-<a class=\"sourceLine\" id=\"cb18-45\" title=\"45\">        }<\/a>\n-<a class=\"sourceLine\" id=\"cb18-46\" title=\"46\">    }<\/a>\n-<a class=\"sourceLine\" id=\"cb18-47\" title=\"47\">}<\/a><\/code><\/pre><\/div>\n+<div class=\"sourceCode\" id=\"cb18\"><pre class=\"sourceCode java\"><code class=\"sourceCode java\"><span id=\"cb18-1\"><a href=\"#cb18-1\"><\/a><\/span>\n+<span id=\"cb18-2\"><a href=\"#cb18-2\"><\/a><span class=\"kw\">import<\/span><span class=\"im\"> jdk.incubator.foreign.MemoryAddress;<\/span><\/span>\n+<span id=\"cb18-3\"><a href=\"#cb18-3\"><\/a><span class=\"kw\">import<\/span><span class=\"im\"> jdk.incubator.foreign.MemoryAccess;<\/span><\/span>\n+<span id=\"cb18-4\"><a href=\"#cb18-4\"><\/a><span class=\"kw\">import<\/span><span class=\"im\"> jdk.incubator.foreign.ResourceScope;<\/span><\/span>\n+<span id=\"cb18-5\"><a href=\"#cb18-5\"><\/a><span class=\"kw\">import<\/span><span class=\"im\"> jdk.incubator.foreign.SegmentAllocator;<\/span><\/span>\n+<span id=\"cb18-6\"><a href=\"#cb18-6\"><\/a><span class=\"kw\">import<\/span><span class=\"im\"> blas.*;<\/span><\/span>\n+<span id=\"cb18-7\"><a href=\"#cb18-7\"><\/a><span class=\"kw\">import static<\/span><span class=\"im\"> blas.cblas_h.*;<\/span><\/span>\n+<span id=\"cb18-8\"><a href=\"#cb18-8\"><\/a><span class=\"kw\">import static<\/span><span class=\"im\"> jdk.incubator.foreign.CLinker.*;<\/span><\/span>\n+<span id=\"cb18-9\"><a href=\"#cb18-9\"><\/a><\/span>\n+<span id=\"cb18-10\"><a href=\"#cb18-10\"><\/a><span class=\"kw\">public<\/span> <span class=\"kw\">class<\/span> TestBlas {<\/span>\n+<span id=\"cb18-11\"><a href=\"#cb18-11\"><\/a>    <span class=\"kw\">public<\/span> <span class=\"dt\">static<\/span> <span class=\"dt\">void<\/span> <span class=\"fu\">main<\/span>(<span class=\"bu\">String<\/span>[] args) {<\/span>\n+<span id=\"cb18-12\"><a href=\"#cb18-12\"><\/a>        <span class=\"dt\">int<\/span> Layout;<\/span>\n+<span id=\"cb18-13\"><a href=\"#cb18-13\"><\/a>        <span class=\"dt\">int<\/span> transa;<\/span>\n+<span id=\"cb18-14\"><a href=\"#cb18-14\"><\/a><\/span>\n+<span id=\"cb18-15\"><a href=\"#cb18-15\"><\/a>        <span class=\"dt\">double<\/span> alpha, beta;<\/span>\n+<span id=\"cb18-16\"><a href=\"#cb18-16\"><\/a>        <span class=\"dt\">int<\/span> m, n, lda, incx, incy, i;<\/span>\n+<span id=\"cb18-17\"><a href=\"#cb18-17\"><\/a><\/span>\n+<span id=\"cb18-18\"><a href=\"#cb18-18\"><\/a>        Layout = <span class=\"fu\">CblasColMajor<\/span>();<\/span>\n+<span id=\"cb18-19\"><a href=\"#cb18-19\"><\/a>        transa = <span class=\"fu\">CblasNoTrans<\/span>();<\/span>\n+<span id=\"cb18-20\"><a href=\"#cb18-20\"><\/a><\/span>\n+<span id=\"cb18-21\"><a href=\"#cb18-21\"><\/a>        m = <span class=\"dv\">4<\/span>; <span class=\"co\">\/* Size of Column ( the number of rows ) *\/<\/span><\/span>\n+<span id=\"cb18-22\"><a href=\"#cb18-22\"><\/a>        n = <span class=\"dv\">4<\/span>; <span class=\"co\">\/* Size of Row ( the number of columns ) *\/<\/span><\/span>\n+<span id=\"cb18-23\"><a href=\"#cb18-23\"><\/a>        lda = <span class=\"dv\">4<\/span>; <span class=\"co\">\/* Leading dimension of 5 * 4 matrix is 5 *\/<\/span><\/span>\n+<span id=\"cb18-24\"><a href=\"#cb18-24\"><\/a>        incx = <span class=\"dv\">1<\/span>;<\/span>\n+<span id=\"cb18-25\"><a href=\"#cb18-25\"><\/a>        incy = <span class=\"dv\">1<\/span>;<\/span>\n+<span id=\"cb18-26\"><a href=\"#cb18-26\"><\/a>        alpha = <span class=\"dv\">1<\/span>;<\/span>\n+<span id=\"cb18-27\"><a href=\"#cb18-27\"><\/a>        beta = <span class=\"dv\">0<\/span>;<\/span>\n+<span id=\"cb18-28\"><a href=\"#cb18-28\"><\/a><\/span>\n+<span id=\"cb18-29\"><a href=\"#cb18-29\"><\/a>        <span class=\"kw\">try<\/span> (var scope = ResourceScope.<span class=\"fu\">newConfinedScope<\/span>()) {<\/span>\n+<span id=\"cb18-30\"><a href=\"#cb18-30\"><\/a>            var allocator = SegmentAllocator.<span class=\"fu\">ofScope<\/span>(scope);<\/span>\n+<span id=\"cb18-31\"><a href=\"#cb18-31\"><\/a>            var a = allocator.<span class=\"fu\">allocateArray<\/span>(C_DOUBLE, <span class=\"kw\">new<\/span> <span class=\"dt\">double<\/span>[] {<\/span>\n+<span id=\"cb18-32\"><a href=\"#cb18-32\"><\/a>                <span class=\"fl\">1.<\/span><span class=\"dv\">0<\/span>, <span class=\"fl\">2.<\/span><span class=\"dv\">0<\/span>, <span class=\"fl\">3.<\/span><span class=\"dv\">0<\/span>, <span class=\"fl\">4.<\/span><span class=\"dv\">0<\/span>,<\/span>\n+<span id=\"cb18-33\"><a href=\"#cb18-33\"><\/a>                <span class=\"fl\">1.<\/span><span class=\"dv\">0<\/span>, <span class=\"fl\">1.<\/span><span class=\"dv\">0<\/span>, <span class=\"fl\">1.<\/span><span class=\"dv\">0<\/span>, <span class=\"fl\">1.<\/span><span class=\"dv\">0<\/span>,<\/span>\n+<span id=\"cb18-34\"><a href=\"#cb18-34\"><\/a>                <span class=\"fl\">3.<\/span><span class=\"dv\">0<\/span>, <span class=\"fl\">4.<\/span><span class=\"dv\">0<\/span>, <span class=\"fl\">5.<\/span><span class=\"dv\">0<\/span>, <span class=\"fl\">6.<\/span><span class=\"dv\">0<\/span>,<\/span>\n+<span id=\"cb18-35\"><a href=\"#cb18-35\"><\/a>                <span class=\"fl\">5.<\/span><span class=\"dv\">0<\/span>, <span class=\"fl\">6.<\/span><span class=\"dv\">0<\/span>, <span class=\"fl\">7.<\/span><span class=\"dv\">0<\/span>, <span class=\"fl\">8.<\/span><span class=\"dv\">0<\/span><\/span>\n+<span id=\"cb18-36\"><a href=\"#cb18-36\"><\/a>            });<\/span>\n+<span id=\"cb18-37\"><a href=\"#cb18-37\"><\/a>            var x = allocator.<span class=\"fu\">allocateArray<\/span>(C_DOUBLE, <span class=\"kw\">new<\/span> <span class=\"dt\">double<\/span>[] {<\/span>\n+<span id=\"cb18-38\"><a href=\"#cb18-38\"><\/a>                <span class=\"fl\">1.<\/span><span class=\"dv\">0<\/span>, <span class=\"fl\">2.<\/span><span class=\"dv\">0<\/span>, <span class=\"fl\">1.<\/span><span class=\"dv\">0<\/span>, <span class=\"fl\">1.<\/span><span class=\"dv\">0<\/span><\/span>\n+<span id=\"cb18-39\"><a href=\"#cb18-39\"><\/a>            });<\/span>\n+<span id=\"cb18-40\"><a href=\"#cb18-40\"><\/a>            var y = allocator.<span class=\"fu\">allocateArray<\/span>(C_DOUBLE, n);<\/span>\n+<span id=\"cb18-41\"><a href=\"#cb18-41\"><\/a><\/span>\n+<span id=\"cb18-42\"><a href=\"#cb18-42\"><\/a>            <span class=\"fu\">cblas_dgemv<\/span>(Layout, transa, m, n, alpha, a, lda, x, incx, beta, y, incy);<\/span>\n+<span id=\"cb18-43\"><a href=\"#cb18-43\"><\/a>            <span class=\"co\">\/* Print y *\/<\/span><\/span>\n+<span id=\"cb18-44\"><a href=\"#cb18-44\"><\/a>            <span class=\"kw\">for<\/span> (i = <span class=\"dv\">0<\/span>; i &lt; n; i++) {<\/span>\n+<span id=\"cb18-45\"><a href=\"#cb18-45\"><\/a>                <span class=\"bu\">System<\/span>.<span class=\"fu\">out<\/span>.<span class=\"fu\">print<\/span>(<span class=\"bu\">String<\/span><span class=\"fu\">.format<\/span>(<span class=\"st\">&quot; y<\/span><span class=\"sc\">%d<\/span><span class=\"st\"> = <\/span><span class=\"sc\">%f\\n<\/span><span class=\"st\">&quot;<\/span>, i, MemoryAccess.<span class=\"fu\">getDoubleAtIndex<\/span>(y, i)));<\/span>\n+<span id=\"cb18-46\"><a href=\"#cb18-46\"><\/a>            }<\/span>\n+<span id=\"cb18-47\"><a href=\"#cb18-47\"><\/a>        }<\/span>\n+<span id=\"cb18-48\"><a href=\"#cb18-48\"><\/a>    }<\/span>\n+<span id=\"cb18-49\"><a href=\"#cb18-49\"><\/a>}<\/span><\/code><\/pre><\/div>\n@@ -377,5 +414,5 @@\n-<div class=\"sourceCode\" id=\"cb19\"><pre class=\"sourceCode sh\"><code class=\"sourceCode bash\"><a class=\"sourceLine\" id=\"cb19-1\" title=\"1\"><\/a>\n-<a class=\"sourceLine\" id=\"cb19-2\" title=\"2\"><span class=\"ex\">jextract<\/span> \\<\/a>\n-<a class=\"sourceLine\" id=\"cb19-3\" title=\"3\">  -C <span class=\"st\">&quot;-D FORCE_OPENBLAS_COMPLEX_STRUCT&quot;<\/span> \\<\/a>\n-<a class=\"sourceLine\" id=\"cb19-4\" title=\"4\">  -I \/Applications\/Xcode.app\/Contents\/Developer\/Platforms\/MacOSX.platform\/Developer\/SDKs\/MacOSX.sdk\/usr\/include \\<\/a>\n-<a class=\"sourceLine\" id=\"cb19-5\" title=\"5\">  -l openblas -t blas \/usr\/local\/opt\/openblas\/include\/cblas.h<\/a><\/code><\/pre><\/div>\n+<div class=\"sourceCode\" id=\"cb19\"><pre class=\"sourceCode sh\"><code class=\"sourceCode bash\"><span id=\"cb19-1\"><a href=\"#cb19-1\"><\/a><\/span>\n+<span id=\"cb19-2\"><a href=\"#cb19-2\"><\/a><span class=\"ex\">jextract<\/span> \\<\/span>\n+<span id=\"cb19-3\"><a href=\"#cb19-3\"><\/a>  -C <span class=\"st\">&quot;-D FORCE_OPENBLAS_COMPLEX_STRUCT&quot;<\/span> \\<\/span>\n+<span id=\"cb19-4\"><a href=\"#cb19-4\"><\/a>  -I \/Applications\/Xcode.app\/Contents\/Developer\/Platforms\/MacOSX.platform\/Developer\/SDKs\/MacOSX.sdk\/usr\/include \\<\/span>\n+<span id=\"cb19-5\"><a href=\"#cb19-5\"><\/a>  -l openblas -t blas \/usr\/local\/opt\/openblas\/include\/cblas.h<\/span><\/code><\/pre><\/div>\n@@ -385,6 +422,5 @@\n-<div class=\"sourceCode\" id=\"cb20\"><pre class=\"sourceCode sh\"><code class=\"sourceCode bash\"><a class=\"sourceLine\" id=\"cb20-1\" title=\"1\"><\/a>\n-<a class=\"sourceLine\" id=\"cb20-2\" title=\"2\"><span class=\"ex\">jextract<\/span> \\<\/a>\n-<a class=\"sourceLine\" id=\"cb20-3\" title=\"3\">   -I \/Applications\/Xcode.app\/Contents\/Developer\/Platforms\/MacOSX.platform\/Developer\/SDKs\/MacOSX.sdk\/usr\/include \\<\/a>\n-<a class=\"sourceLine\" id=\"cb20-4\" title=\"4\">   -l lapacke -t lapack \\<\/a>\n-<a class=\"sourceLine\" id=\"cb20-5\" title=\"5\">   --filter lapacke.h \\<\/a>\n-<a class=\"sourceLine\" id=\"cb20-6\" title=\"6\">   \/usr\/local\/opt\/lapack\/include\/lapacke.h<\/a><\/code><\/pre><\/div>\n+<div class=\"sourceCode\" id=\"cb20\"><pre class=\"sourceCode sh\"><code class=\"sourceCode bash\"><span id=\"cb20-1\"><a href=\"#cb20-1\"><\/a><\/span>\n+<span id=\"cb20-2\"><a href=\"#cb20-2\"><\/a><span class=\"ex\">jextract<\/span> \\<\/span>\n+<span id=\"cb20-3\"><a href=\"#cb20-3\"><\/a>   -I \/Applications\/Xcode.app\/Contents\/Developer\/Platforms\/MacOSX.platform\/Developer\/SDKs\/MacOSX.sdk\/usr\/include \\<\/span>\n+<span id=\"cb20-4\"><a href=\"#cb20-4\"><\/a>   -l lapacke -t lapack \\<\/span>\n+<span id=\"cb20-5\"><a href=\"#cb20-5\"><\/a>   \/usr\/local\/opt\/lapack\/include\/lapacke.h<\/span><\/code><\/pre><\/div>\n@@ -392,57 +428,59 @@\n-<div class=\"sourceCode\" id=\"cb21\"><pre class=\"sourceCode java\"><code class=\"sourceCode java\"><a class=\"sourceLine\" id=\"cb21-1\" title=\"1\"><\/a>\n-<a class=\"sourceLine\" id=\"cb21-2\" title=\"2\"><span class=\"kw\">import<\/span><span class=\"im\"> jdk.incubator.foreign.MemoryAccess;<\/span><\/a>\n-<a class=\"sourceLine\" id=\"cb21-3\" title=\"3\"><span class=\"kw\">import<\/span><span class=\"im\"> jdk.incubator.foreign.MemoryAddress;<\/span><\/a>\n-<a class=\"sourceLine\" id=\"cb21-4\" title=\"4\"><span class=\"kw\">import<\/span><span class=\"im\"> jdk.incubator.foreign.MemorySegment;<\/span><\/a>\n-<a class=\"sourceLine\" id=\"cb21-5\" title=\"5\"><span class=\"kw\">import<\/span><span class=\"im\"> jdk.incubator.foreign.NativeScope;<\/span><\/a>\n-<a class=\"sourceLine\" id=\"cb21-6\" title=\"6\"><span class=\"kw\">import<\/span><span class=\"im\"> lapack.*;<\/span><\/a>\n-<a class=\"sourceLine\" id=\"cb21-7\" title=\"7\"><span class=\"kw\">import static<\/span><span class=\"im\"> lapack.lapacke_h.*;<\/span><\/a>\n-<a class=\"sourceLine\" id=\"cb21-8\" title=\"8\"><span class=\"kw\">import static<\/span><span class=\"im\"> jdk.incubator.foreign.CLinker.*;<\/span><\/a>\n-<a class=\"sourceLine\" id=\"cb21-9\" title=\"9\"><\/a>\n-<a class=\"sourceLine\" id=\"cb21-10\" title=\"10\"><span class=\"kw\">public<\/span> <span class=\"kw\">class<\/span> TestLapack {<\/a>\n-<a class=\"sourceLine\" id=\"cb21-11\" title=\"11\">    <span class=\"kw\">public<\/span> <span class=\"dt\">static<\/span> <span class=\"dt\">void<\/span> <span class=\"fu\">main<\/span>(<span class=\"bu\">String<\/span>[] args) {<\/a>\n-<a class=\"sourceLine\" id=\"cb21-12\" title=\"12\"><\/a>\n-<a class=\"sourceLine\" id=\"cb21-13\" title=\"13\">        <span class=\"co\">\/* Locals *\/<\/span><\/a>\n-<a class=\"sourceLine\" id=\"cb21-14\" title=\"14\">        <span class=\"kw\">try<\/span> (var scope = NativeScope.<span class=\"fu\">unboundedScope<\/span>()) {<\/a>\n-<a class=\"sourceLine\" id=\"cb21-15\" title=\"15\">            var A = scope.<span class=\"fu\">allocateArray<\/span>(C_DOUBLE, <span class=\"kw\">new<\/span> <span class=\"dt\">double<\/span>[]{<\/a>\n-<a class=\"sourceLine\" id=\"cb21-16\" title=\"16\">                    <span class=\"dv\">1<\/span>, <span class=\"dv\">2<\/span>, <span class=\"dv\">3<\/span>, <span class=\"dv\">4<\/span>, <span class=\"dv\">5<\/span>, <span class=\"dv\">1<\/span>, <span class=\"dv\">3<\/span>, <span class=\"dv\">5<\/span>, <span class=\"dv\">2<\/span>, <span class=\"dv\">4<\/span>, <span class=\"dv\">1<\/span>, <span class=\"dv\">4<\/span>, <span class=\"dv\">2<\/span>, <span class=\"dv\">5<\/span>, <span class=\"dv\">3<\/span><\/a>\n-<a class=\"sourceLine\" id=\"cb21-17\" title=\"17\">            });<\/a>\n-<a class=\"sourceLine\" id=\"cb21-18\" title=\"18\">            var b = scope.<span class=\"fu\">allocateArray<\/span>(C_DOUBLE, <span class=\"kw\">new<\/span> <span class=\"dt\">double<\/span>[]{<\/a>\n-<a class=\"sourceLine\" id=\"cb21-19\" title=\"19\">                    -<span class=\"dv\">10<\/span>, <span class=\"dv\">12<\/span>, <span class=\"dv\">14<\/span>, <span class=\"dv\">16<\/span>, <span class=\"dv\">18<\/span>, -<span class=\"dv\">3<\/span>, <span class=\"dv\">14<\/span>, <span class=\"dv\">12<\/span>, <span class=\"dv\">16<\/span>, <span class=\"dv\">16<\/span><\/a>\n-<a class=\"sourceLine\" id=\"cb21-20\" title=\"20\">            });<\/a>\n-<a class=\"sourceLine\" id=\"cb21-21\" title=\"21\">            <span class=\"dt\">int<\/span> info, m, n, lda, ldb, nrhs;<\/a>\n-<a class=\"sourceLine\" id=\"cb21-22\" title=\"22\"><\/a>\n-<a class=\"sourceLine\" id=\"cb21-23\" title=\"23\">            <span class=\"co\">\/* Initialization *\/<\/span><\/a>\n-<a class=\"sourceLine\" id=\"cb21-24\" title=\"24\">            m = <span class=\"dv\">5<\/span>;<\/a>\n-<a class=\"sourceLine\" id=\"cb21-25\" title=\"25\">            n = <span class=\"dv\">3<\/span>;<\/a>\n-<a class=\"sourceLine\" id=\"cb21-26\" title=\"26\">            nrhs = <span class=\"dv\">2<\/span>;<\/a>\n-<a class=\"sourceLine\" id=\"cb21-27\" title=\"27\">            lda = <span class=\"dv\">5<\/span>;<\/a>\n-<a class=\"sourceLine\" id=\"cb21-28\" title=\"28\">            ldb = <span class=\"dv\">5<\/span>;<\/a>\n-<a class=\"sourceLine\" id=\"cb21-29\" title=\"29\"><\/a>\n-<a class=\"sourceLine\" id=\"cb21-30\" title=\"30\">            <span class=\"co\">\/* Print Entry Matrix *\/<\/span><\/a>\n-<a class=\"sourceLine\" id=\"cb21-31\" title=\"31\">            <span class=\"fu\">print_matrix_colmajor<\/span>(<span class=\"st\">&quot;Entry Matrix A&quot;<\/span>, m, n, A, lda );<\/a>\n-<a class=\"sourceLine\" id=\"cb21-32\" title=\"32\">            <span class=\"co\">\/* Print Right Rand Side *\/<\/span><\/a>\n-<a class=\"sourceLine\" id=\"cb21-33\" title=\"33\">            <span class=\"fu\">print_matrix_colmajor<\/span>(<span class=\"st\">&quot;Right Hand Side b&quot;<\/span>, n, nrhs, b, ldb );<\/a>\n-<a class=\"sourceLine\" id=\"cb21-34\" title=\"34\">            <span class=\"bu\">System<\/span>.<span class=\"fu\">out<\/span>.<span class=\"fu\">println<\/span>();<\/a>\n-<a class=\"sourceLine\" id=\"cb21-35\" title=\"35\">            <\/a>\n-<a class=\"sourceLine\" id=\"cb21-36\" title=\"36\">            <span class=\"co\">\/* Executable statements *\/<\/span><\/a>\n-<a class=\"sourceLine\" id=\"cb21-37\" title=\"37\">            <span class=\"co\">\/\/            printf( &quot;LAPACKE_dgels (col-major, high-level) Example Program Results\\n&quot; );<\/span><\/a>\n-<a class=\"sourceLine\" id=\"cb21-38\" title=\"38\">            <span class=\"co\">\/* Solve least squares problem*\/<\/span><\/a>\n-<a class=\"sourceLine\" id=\"cb21-39\" title=\"39\">            info = <span class=\"fu\">LAPACKE_dgels<\/span>(<span class=\"fu\">LAPACK_COL_MAJOR<\/span>(), (<span class=\"dt\">byte<\/span>)<span class=\"ch\">&#39;N&#39;<\/span>, m, n, nrhs, A, lda, b, ldb);<\/a>\n-<a class=\"sourceLine\" id=\"cb21-40\" title=\"40\"> <\/a>\n-<a class=\"sourceLine\" id=\"cb21-41\" title=\"41\">            <span class=\"co\">\/* Print Solution *\/<\/span><\/a>\n-<a class=\"sourceLine\" id=\"cb21-42\" title=\"42\">            <span class=\"fu\">print_matrix_colmajor<\/span>(<span class=\"st\">&quot;Solution&quot;<\/span>, n, nrhs, b, ldb );<\/a>\n-<a class=\"sourceLine\" id=\"cb21-43\" title=\"43\">            <span class=\"bu\">System<\/span>.<span class=\"fu\">out<\/span>.<span class=\"fu\">println<\/span>();<\/a>\n-<a class=\"sourceLine\" id=\"cb21-44\" title=\"44\">            <span class=\"bu\">System<\/span>.<span class=\"fu\">exit<\/span>(info);<\/a>\n-<a class=\"sourceLine\" id=\"cb21-45\" title=\"45\">        }   <\/a>\n-<a class=\"sourceLine\" id=\"cb21-46\" title=\"46\">    }   <\/a>\n-<a class=\"sourceLine\" id=\"cb21-47\" title=\"47\">    <\/a>\n-<a class=\"sourceLine\" id=\"cb21-48\" title=\"48\">    <span class=\"dt\">static<\/span> <span class=\"dt\">void<\/span> <span class=\"fu\">print_matrix_colmajor<\/span>(<span class=\"bu\">String<\/span> msg, <span class=\"dt\">int<\/span> m, <span class=\"dt\">int<\/span> n, MemorySegment mat, <span class=\"dt\">int<\/span> ldm) {<\/a>\n-<a class=\"sourceLine\" id=\"cb21-49\" title=\"49\">        <span class=\"dt\">int<\/span> i, j;<\/a>\n-<a class=\"sourceLine\" id=\"cb21-50\" title=\"50\">        <span class=\"bu\">System<\/span>.<span class=\"fu\">out.printf<\/span>(<span class=\"st\">&quot;<\/span><span class=\"sc\">\\n<\/span><span class=\"st\"> <\/span><span class=\"sc\">%s\\n<\/span><span class=\"st\">&quot;<\/span>, msg);<\/a>\n-<a class=\"sourceLine\" id=\"cb21-51\" title=\"51\"><\/a>\n-<a class=\"sourceLine\" id=\"cb21-52\" title=\"52\">        <span class=\"kw\">for<\/span>( i = <span class=\"dv\">0<\/span>; i &lt; m; i++ ) {<\/a>\n-<a class=\"sourceLine\" id=\"cb21-53\" title=\"53\">            <span class=\"kw\">for<\/span>( j = <span class=\"dv\">0<\/span>; j &lt; n; j++ ) <span class=\"bu\">System<\/span>.<span class=\"fu\">out.printf<\/span>(<span class=\"st\">&quot; <\/span><span class=\"sc\">%6.2f<\/span><span class=\"st\">&quot;<\/span>, MemoryAccess.<span class=\"fu\">getDoubleAtIndex<\/span>(mat, i+j*ldm));<\/a>\n-<a class=\"sourceLine\" id=\"cb21-54\" title=\"54\">            <span class=\"bu\">System<\/span>.<span class=\"fu\">out.printf<\/span>( <span class=\"st\">&quot;<\/span><span class=\"sc\">\\n<\/span><span class=\"st\">&quot;<\/span> );<\/a>\n-<a class=\"sourceLine\" id=\"cb21-55\" title=\"55\">        }<\/a>\n-<a class=\"sourceLine\" id=\"cb21-56\" title=\"56\">    }<\/a>\n-<a class=\"sourceLine\" id=\"cb21-57\" title=\"57\">}<\/a><\/code><\/pre><\/div>\n+<div class=\"sourceCode\" id=\"cb21\"><pre class=\"sourceCode java\"><code class=\"sourceCode java\"><span id=\"cb21-1\"><a href=\"#cb21-1\"><\/a><\/span>\n+<span id=\"cb21-2\"><a href=\"#cb21-2\"><\/a><span class=\"kw\">import<\/span><span class=\"im\"> jdk.incubator.foreign.MemoryAccess;<\/span><\/span>\n+<span id=\"cb21-3\"><a href=\"#cb21-3\"><\/a><span class=\"kw\">import<\/span><span class=\"im\"> jdk.incubator.foreign.MemoryAddress;<\/span><\/span>\n+<span id=\"cb21-4\"><a href=\"#cb21-4\"><\/a><span class=\"kw\">import<\/span><span class=\"im\"> jdk.incubator.foreign.MemorySegment;<\/span><\/span>\n+<span id=\"cb21-5\"><a href=\"#cb21-5\"><\/a><span class=\"kw\">import<\/span><span class=\"im\"> jdk.incubator.foreign.ResourceScope;<\/span><\/span>\n+<span id=\"cb21-6\"><a href=\"#cb21-6\"><\/a><span class=\"kw\">import<\/span><span class=\"im\"> jdk.incubator.foreign.SegmentAllocator;<\/span><\/span>\n+<span id=\"cb21-7\"><a href=\"#cb21-7\"><\/a><span class=\"kw\">import<\/span><span class=\"im\"> lapack.*;<\/span><\/span>\n+<span id=\"cb21-8\"><a href=\"#cb21-8\"><\/a><span class=\"kw\">import static<\/span><span class=\"im\"> lapack.lapacke_h.*;<\/span><\/span>\n+<span id=\"cb21-9\"><a href=\"#cb21-9\"><\/a><span class=\"kw\">import static<\/span><span class=\"im\"> jdk.incubator.foreign.CLinker.*;<\/span><\/span>\n+<span id=\"cb21-10\"><a href=\"#cb21-10\"><\/a><\/span>\n+<span id=\"cb21-11\"><a href=\"#cb21-11\"><\/a><span class=\"kw\">public<\/span> <span class=\"kw\">class<\/span> TestLapack {<\/span>\n+<span id=\"cb21-12\"><a href=\"#cb21-12\"><\/a>    <span class=\"kw\">public<\/span> <span class=\"dt\">static<\/span> <span class=\"dt\">void<\/span> <span class=\"fu\">main<\/span>(<span class=\"bu\">String<\/span>[] args) {<\/span>\n+<span id=\"cb21-13\"><a href=\"#cb21-13\"><\/a><\/span>\n+<span id=\"cb21-14\"><a href=\"#cb21-14\"><\/a>        <span class=\"co\">\/* Locals *\/<\/span><\/span>\n+<span id=\"cb21-15\"><a href=\"#cb21-15\"><\/a>        <span class=\"kw\">try<\/span> (var scope = ResourceScope.<span class=\"fu\">newConfinedScope<\/span>()) {<\/span>\n+<span id=\"cb21-16\"><a href=\"#cb21-16\"><\/a>            var allocator = SegmentAllocator.<span class=\"fu\">ofScope<\/span>(scope);<\/span>\n+<span id=\"cb21-17\"><a href=\"#cb21-17\"><\/a>            var A = allocator.<span class=\"fu\">allocateArray<\/span>(C_DOUBLE, <span class=\"kw\">new<\/span> <span class=\"dt\">double<\/span>[]{<\/span>\n+<span id=\"cb21-18\"><a href=\"#cb21-18\"><\/a>                    <span class=\"dv\">1<\/span>, <span class=\"dv\">2<\/span>, <span class=\"dv\">3<\/span>, <span class=\"dv\">4<\/span>, <span class=\"dv\">5<\/span>, <span class=\"dv\">1<\/span>, <span class=\"dv\">3<\/span>, <span class=\"dv\">5<\/span>, <span class=\"dv\">2<\/span>, <span class=\"dv\">4<\/span>, <span class=\"dv\">1<\/span>, <span class=\"dv\">4<\/span>, <span class=\"dv\">2<\/span>, <span class=\"dv\">5<\/span>, <span class=\"dv\">3<\/span><\/span>\n+<span id=\"cb21-19\"><a href=\"#cb21-19\"><\/a>            });<\/span>\n+<span id=\"cb21-20\"><a href=\"#cb21-20\"><\/a>            var b = allocator.<span class=\"fu\">allocateArray<\/span>(C_DOUBLE, <span class=\"kw\">new<\/span> <span class=\"dt\">double<\/span>[]{<\/span>\n+<span id=\"cb21-21\"><a href=\"#cb21-21\"><\/a>                    -<span class=\"dv\">10<\/span>, <span class=\"dv\">12<\/span>, <span class=\"dv\">14<\/span>, <span class=\"dv\">16<\/span>, <span class=\"dv\">18<\/span>, -<span class=\"dv\">3<\/span>, <span class=\"dv\">14<\/span>, <span class=\"dv\">12<\/span>, <span class=\"dv\">16<\/span>, <span class=\"dv\">16<\/span><\/span>\n+<span id=\"cb21-22\"><a href=\"#cb21-22\"><\/a>            });<\/span>\n+<span id=\"cb21-23\"><a href=\"#cb21-23\"><\/a>            <span class=\"dt\">int<\/span> info, m, n, lda, ldb, nrhs;<\/span>\n+<span id=\"cb21-24\"><a href=\"#cb21-24\"><\/a><\/span>\n+<span id=\"cb21-25\"><a href=\"#cb21-25\"><\/a>            <span class=\"co\">\/* Initialization *\/<\/span><\/span>\n+<span id=\"cb21-26\"><a href=\"#cb21-26\"><\/a>            m = <span class=\"dv\">5<\/span>;<\/span>\n+<span id=\"cb21-27\"><a href=\"#cb21-27\"><\/a>            n = <span class=\"dv\">3<\/span>;<\/span>\n+<span id=\"cb21-28\"><a href=\"#cb21-28\"><\/a>            nrhs = <span class=\"dv\">2<\/span>;<\/span>\n+<span id=\"cb21-29\"><a href=\"#cb21-29\"><\/a>            lda = <span class=\"dv\">5<\/span>;<\/span>\n+<span id=\"cb21-30\"><a href=\"#cb21-30\"><\/a>            ldb = <span class=\"dv\">5<\/span>;<\/span>\n+<span id=\"cb21-31\"><a href=\"#cb21-31\"><\/a><\/span>\n+<span id=\"cb21-32\"><a href=\"#cb21-32\"><\/a>            <span class=\"co\">\/* Print Entry Matrix *\/<\/span><\/span>\n+<span id=\"cb21-33\"><a href=\"#cb21-33\"><\/a>            <span class=\"fu\">print_matrix_colmajor<\/span>(<span class=\"st\">&quot;Entry Matrix A&quot;<\/span>, m, n, A, lda );<\/span>\n+<span id=\"cb21-34\"><a href=\"#cb21-34\"><\/a>            <span class=\"co\">\/* Print Right Rand Side *\/<\/span><\/span>\n+<span id=\"cb21-35\"><a href=\"#cb21-35\"><\/a>            <span class=\"fu\">print_matrix_colmajor<\/span>(<span class=\"st\">&quot;Right Hand Side b&quot;<\/span>, n, nrhs, b, ldb );<\/span>\n+<span id=\"cb21-36\"><a href=\"#cb21-36\"><\/a>            <span class=\"bu\">System<\/span>.<span class=\"fu\">out<\/span>.<span class=\"fu\">println<\/span>();<\/span>\n+<span id=\"cb21-37\"><a href=\"#cb21-37\"><\/a><\/span>\n+<span id=\"cb21-38\"><a href=\"#cb21-38\"><\/a>            <span class=\"co\">\/* Executable statements *\/<\/span><\/span>\n+<span id=\"cb21-39\"><a href=\"#cb21-39\"><\/a>            <span class=\"co\">\/\/            printf( &quot;LAPACKE_dgels (col-major, high-level) Example Program Results\\n&quot; );<\/span><\/span>\n+<span id=\"cb21-40\"><a href=\"#cb21-40\"><\/a>            <span class=\"co\">\/* Solve least squares problem*\/<\/span><\/span>\n+<span id=\"cb21-41\"><a href=\"#cb21-41\"><\/a>            info = <span class=\"fu\">LAPACKE_dgels<\/span>(<span class=\"fu\">LAPACK_COL_MAJOR<\/span>(), (<span class=\"dt\">byte<\/span>)<span class=\"ch\">&#39;N&#39;<\/span>, m, n, nrhs, A, lda, b, ldb);<\/span>\n+<span id=\"cb21-42\"><a href=\"#cb21-42\"><\/a><\/span>\n+<span id=\"cb21-43\"><a href=\"#cb21-43\"><\/a>            <span class=\"co\">\/* Print Solution *\/<\/span><\/span>\n+<span id=\"cb21-44\"><a href=\"#cb21-44\"><\/a>            <span class=\"fu\">print_matrix_colmajor<\/span>(<span class=\"st\">&quot;Solution&quot;<\/span>, n, nrhs, b, ldb );<\/span>\n+<span id=\"cb21-45\"><a href=\"#cb21-45\"><\/a>            <span class=\"bu\">System<\/span>.<span class=\"fu\">out<\/span>.<span class=\"fu\">println<\/span>();<\/span>\n+<span id=\"cb21-46\"><a href=\"#cb21-46\"><\/a>            <span class=\"bu\">System<\/span>.<span class=\"fu\">exit<\/span>(info);<\/span>\n+<span id=\"cb21-47\"><a href=\"#cb21-47\"><\/a>        }<\/span>\n+<span id=\"cb21-48\"><a href=\"#cb21-48\"><\/a>    }<\/span>\n+<span id=\"cb21-49\"><a href=\"#cb21-49\"><\/a><\/span>\n+<span id=\"cb21-50\"><a href=\"#cb21-50\"><\/a>    <span class=\"dt\">static<\/span> <span class=\"dt\">void<\/span> <span class=\"fu\">print_matrix_colmajor<\/span>(<span class=\"bu\">String<\/span> msg, <span class=\"dt\">int<\/span> m, <span class=\"dt\">int<\/span> n, MemorySegment mat, <span class=\"dt\">int<\/span> ldm) {<\/span>\n+<span id=\"cb21-51\"><a href=\"#cb21-51\"><\/a>        <span class=\"dt\">int<\/span> i, j;<\/span>\n+<span id=\"cb21-52\"><a href=\"#cb21-52\"><\/a>        <span class=\"bu\">System<\/span>.<span class=\"fu\">out.printf<\/span>(<span class=\"st\">&quot;<\/span><span class=\"sc\">\\n<\/span><span class=\"st\"> <\/span><span class=\"sc\">%s\\n<\/span><span class=\"st\">&quot;<\/span>, msg);<\/span>\n+<span id=\"cb21-53\"><a href=\"#cb21-53\"><\/a><\/span>\n+<span id=\"cb21-54\"><a href=\"#cb21-54\"><\/a>        <span class=\"kw\">for<\/span>( i = <span class=\"dv\">0<\/span>; i &lt; m; i++ ) {<\/span>\n+<span id=\"cb21-55\"><a href=\"#cb21-55\"><\/a>            <span class=\"kw\">for<\/span>( j = <span class=\"dv\">0<\/span>; j &lt; n; j++ ) <span class=\"bu\">System<\/span>.<span class=\"fu\">out.printf<\/span>(<span class=\"st\">&quot; <\/span><span class=\"sc\">%6.2f<\/span><span class=\"st\">&quot;<\/span>, MemoryAccess.<span class=\"fu\">getDoubleAtIndex<\/span>(mat, i+j*ldm));<\/span>\n+<span id=\"cb21-56\"><a href=\"#cb21-56\"><\/a>            <span class=\"bu\">System<\/span>.<span class=\"fu\">out.printf<\/span>( <span class=\"st\">&quot;<\/span><span class=\"sc\">\\n<\/span><span class=\"st\">&quot;<\/span> );<\/span>\n+<span id=\"cb21-57\"><a href=\"#cb21-57\"><\/a>        }<\/span>\n+<span id=\"cb21-58\"><a href=\"#cb21-58\"><\/a>    }<\/span>\n+<span id=\"cb21-59\"><a href=\"#cb21-59\"><\/a>}<\/span><\/code><\/pre><\/div>\n@@ -450,5 +488,5 @@\n-<div class=\"sourceCode\" id=\"cb22\"><pre class=\"sourceCode sh\"><code class=\"sourceCode bash\"><a class=\"sourceLine\" id=\"cb22-1\" title=\"1\"><\/a>\n-<a class=\"sourceLine\" id=\"cb22-2\" title=\"2\"><span class=\"ex\">java<\/span> -Dforeign.restricted=permit \\<\/a>\n-<a class=\"sourceLine\" id=\"cb22-3\" title=\"3\">    --add-modules jdk.incubator.foreign \\<\/a>\n-<a class=\"sourceLine\" id=\"cb22-4\" title=\"4\">    -Djava.library.path=\/usr\/local\/opt\/lapack\/lib \\<\/a>\n-<a class=\"sourceLine\" id=\"cb22-5\" title=\"5\">    TestLapack.java<\/a><\/code><\/pre><\/div>\n+<div class=\"sourceCode\" id=\"cb22\"><pre class=\"sourceCode sh\"><code class=\"sourceCode bash\"><span id=\"cb22-1\"><a href=\"#cb22-1\"><\/a><\/span>\n+<span id=\"cb22-2\"><a href=\"#cb22-2\"><\/a><span class=\"ex\">java<\/span> --enable-native-access=ALL-UNNAMED \\<\/span>\n+<span id=\"cb22-3\"><a href=\"#cb22-3\"><\/a>    --add-modules jdk.incubator.foreign \\<\/span>\n+<span id=\"cb22-4\"><a href=\"#cb22-4\"><\/a>    -Djava.library.path=\/usr\/local\/opt\/lapack\/lib \\<\/span>\n+<span id=\"cb22-5\"><a href=\"#cb22-5\"><\/a>    TestLapack.java<\/span><\/code><\/pre><\/div>\n@@ -457,6 +495,5 @@\n-<div class=\"sourceCode\" id=\"cb23\"><pre class=\"sourceCode sh\"><code class=\"sourceCode bash\"><a class=\"sourceLine\" id=\"cb23-1\" title=\"1\"><\/a>\n-<a class=\"sourceLine\" id=\"cb23-2\" title=\"2\"><span class=\"ex\">jextract<\/span> \\<\/a>\n-<a class=\"sourceLine\" id=\"cb23-3\" title=\"3\">  -t org.unix \\<\/a>\n-<a class=\"sourceLine\" id=\"cb23-4\" title=\"4\">  -I \/Applications\/Xcode.app\/Contents\/Developer\/Platforms\/MacOSX.platform\/Developer\/SDKs\/MacOSX.sdk\/usr\/include \\<\/a>\n-<a class=\"sourceLine\" id=\"cb23-5\" title=\"5\">  --filter libproc.h \\<\/a>\n-<a class=\"sourceLine\" id=\"cb23-6\" title=\"6\">  \/Applications\/Xcode.app\/Contents\/Developer\/Platforms\/MacOSX.platform\/Developer\/SDKs\/MacOSX.sdk\/usr\/include\/libproc.h<\/a><\/code><\/pre><\/div>\n+<div class=\"sourceCode\" id=\"cb23\"><pre class=\"sourceCode sh\"><code class=\"sourceCode bash\"><span id=\"cb23-1\"><a href=\"#cb23-1\"><\/a><\/span>\n+<span id=\"cb23-2\"><a href=\"#cb23-2\"><\/a><span class=\"ex\">jextract<\/span> \\<\/span>\n+<span id=\"cb23-3\"><a href=\"#cb23-3\"><\/a>  -t org.unix \\<\/span>\n+<span id=\"cb23-4\"><a href=\"#cb23-4\"><\/a>  -I \/Applications\/Xcode.app\/Contents\/Developer\/Platforms\/MacOSX.platform\/Developer\/SDKs\/MacOSX.sdk\/usr\/include \\<\/span>\n+<span id=\"cb23-5\"><a href=\"#cb23-5\"><\/a>  \/Applications\/Xcode.app\/Contents\/Developer\/Platforms\/MacOSX.platform\/Developer\/SDKs\/MacOSX.sdk\/usr\/include\/libproc.h<\/span><\/code><\/pre><\/div>\n@@ -464,34 +501,36 @@\n-<div class=\"sourceCode\" id=\"cb24\"><pre class=\"sourceCode java\"><code class=\"sourceCode java\"><a class=\"sourceLine\" id=\"cb24-1\" title=\"1\"><\/a>\n-<a class=\"sourceLine\" id=\"cb24-2\" title=\"2\"><span class=\"kw\">import<\/span><span class=\"im\"> jdk.incubator.foreign.CLinker;<\/span><\/a>\n-<a class=\"sourceLine\" id=\"cb24-3\" title=\"3\"><span class=\"kw\">import<\/span><span class=\"im\"> jdk.incubator.foreign.MemorySegment;<\/span><\/a>\n-<a class=\"sourceLine\" id=\"cb24-4\" title=\"4\"><span class=\"kw\">import<\/span><span class=\"im\"> jdk.incubator.foreign.NativeScope;<\/span><\/a>\n-<a class=\"sourceLine\" id=\"cb24-5\" title=\"5\"><span class=\"kw\">import<\/span><span class=\"im\"> org.unix.*;<\/span><\/a>\n-<a class=\"sourceLine\" id=\"cb24-6\" title=\"6\"><span class=\"kw\">import static<\/span><span class=\"im\"> jdk.incubator.foreign.MemoryAddress.NULL;<\/span><\/a>\n-<a class=\"sourceLine\" id=\"cb24-7\" title=\"7\"><span class=\"kw\">import static<\/span><span class=\"im\"> org.unix.libproc_h.*;<\/span><\/a>\n-<a class=\"sourceLine\" id=\"cb24-8\" title=\"8\"><\/a>\n-<a class=\"sourceLine\" id=\"cb24-9\" title=\"9\"><span class=\"kw\">public<\/span> <span class=\"kw\">class<\/span> LibprocMain {<\/a>\n-<a class=\"sourceLine\" id=\"cb24-10\" title=\"10\">    <span class=\"kw\">private<\/span> <span class=\"dt\">static<\/span> <span class=\"dt\">final<\/span> <span class=\"dt\">int<\/span> NAME_BUF_MAX = <span class=\"dv\">256<\/span>;<\/a>\n-<a class=\"sourceLine\" id=\"cb24-11\" title=\"11\"><\/a>\n-<a class=\"sourceLine\" id=\"cb24-12\" title=\"12\">    <span class=\"kw\">public<\/span> <span class=\"dt\">static<\/span> <span class=\"dt\">void<\/span> <span class=\"fu\">main<\/span>(<span class=\"bu\">String<\/span>[] args) {<\/a>\n-<a class=\"sourceLine\" id=\"cb24-13\" title=\"13\">        <span class=\"kw\">try<\/span> (var scope = NativeScope.<span class=\"fu\">unboundedScope<\/span>()) {<\/a>\n-<a class=\"sourceLine\" id=\"cb24-14\" title=\"14\">            <span class=\"co\">\/\/ get the number of processes<\/span><\/a>\n-<a class=\"sourceLine\" id=\"cb24-15\" title=\"15\">            <span class=\"dt\">int<\/span> numPids = <span class=\"fu\">proc_listallpids<\/span>(NULL, <span class=\"dv\">0<\/span>);<\/a>\n-<a class=\"sourceLine\" id=\"cb24-16\" title=\"16\">            <span class=\"co\">\/\/ allocate an array<\/span><\/a>\n-<a class=\"sourceLine\" id=\"cb24-17\" title=\"17\">            var pids = scope.<span class=\"fu\">allocateArray<\/span>(CLinker.<span class=\"fu\">C_INT<\/span>, numPids);<\/a>\n-<a class=\"sourceLine\" id=\"cb24-18\" title=\"18\">            <span class=\"co\">\/\/ list all the pids into the native array<\/span><\/a>\n-<a class=\"sourceLine\" id=\"cb24-19\" title=\"19\">            <span class=\"fu\">proc_listallpids<\/span>(pids, numPids);<\/a>\n-<a class=\"sourceLine\" id=\"cb24-20\" title=\"20\">            <span class=\"co\">\/\/ convert native array to java array<\/span><\/a>\n-<a class=\"sourceLine\" id=\"cb24-21\" title=\"21\">            <span class=\"dt\">int<\/span>[] jpids = pids.<span class=\"fu\">toIntArray<\/span>();<\/a>\n-<a class=\"sourceLine\" id=\"cb24-22\" title=\"22\">            <span class=\"co\">\/\/ buffer for process name<\/span><\/a>\n-<a class=\"sourceLine\" id=\"cb24-23\" title=\"23\">            var nameBuf = scope.<span class=\"fu\">allocateArray<\/span>(CLinker.<span class=\"fu\">C_CHAR<\/span>, NAME_BUF_MAX);<\/a>\n-<a class=\"sourceLine\" id=\"cb24-24\" title=\"24\">            <span class=\"kw\">for<\/span> (<span class=\"dt\">int<\/span> i = <span class=\"dv\">0<\/span>; i &lt; jpids.<span class=\"fu\">length<\/span>; i++) {<\/a>\n-<a class=\"sourceLine\" id=\"cb24-25\" title=\"25\">                <span class=\"dt\">int<\/span> pid = jpids[i];<\/a>\n-<a class=\"sourceLine\" id=\"cb24-26\" title=\"26\">                <span class=\"co\">\/\/ get the process name<\/span><\/a>\n-<a class=\"sourceLine\" id=\"cb24-27\" title=\"27\">                <span class=\"fu\">proc_name<\/span>(pid, nameBuf, NAME_BUF_MAX);<\/a>\n-<a class=\"sourceLine\" id=\"cb24-28\" title=\"28\">                <span class=\"bu\">String<\/span> procName = CLinker.<span class=\"fu\">toJavaString<\/span>(nameBuf);<\/a>\n-<a class=\"sourceLine\" id=\"cb24-29\" title=\"29\">                <span class=\"co\">\/\/ print pid and process name<\/span><\/a>\n-<a class=\"sourceLine\" id=\"cb24-30\" title=\"30\">                <span class=\"bu\">System<\/span>.<span class=\"fu\">out.printf<\/span>(<span class=\"st\">&quot;<\/span><span class=\"sc\">%d<\/span><span class=\"st\"> <\/span><span class=\"sc\">%s\\n<\/span><span class=\"st\">&quot;<\/span>, pid, procName);<\/a>\n-<a class=\"sourceLine\" id=\"cb24-31\" title=\"31\">            }<\/a>\n-<a class=\"sourceLine\" id=\"cb24-32\" title=\"32\">        }<\/a>\n-<a class=\"sourceLine\" id=\"cb24-33\" title=\"33\">    }<\/a>\n-<a class=\"sourceLine\" id=\"cb24-34\" title=\"34\">}<\/a><\/code><\/pre><\/div>\n+<div class=\"sourceCode\" id=\"cb24\"><pre class=\"sourceCode java\"><code class=\"sourceCode java\"><span id=\"cb24-1\"><a href=\"#cb24-1\"><\/a><\/span>\n+<span id=\"cb24-2\"><a href=\"#cb24-2\"><\/a><span class=\"kw\">import<\/span><span class=\"im\"> jdk.incubator.foreign.CLinker;<\/span><\/span>\n+<span id=\"cb24-3\"><a href=\"#cb24-3\"><\/a><span class=\"kw\">import<\/span><span class=\"im\"> jdk.incubator.foreign.MemorySegment;<\/span><\/span>\n+<span id=\"cb24-4\"><a href=\"#cb24-4\"><\/a><span class=\"kw\">import<\/span><span class=\"im\"> jdk.incubator.foreign.ResourceScope;<\/span><\/span>\n+<span id=\"cb24-5\"><a href=\"#cb24-5\"><\/a><span class=\"kw\">import<\/span><span class=\"im\"> jdk.incubator.foreign.SegmentAllocator;<\/span><\/span>\n+<span id=\"cb24-6\"><a href=\"#cb24-6\"><\/a><span class=\"kw\">import<\/span><span class=\"im\"> org.unix.*;<\/span><\/span>\n+<span id=\"cb24-7\"><a href=\"#cb24-7\"><\/a><span class=\"kw\">import static<\/span><span class=\"im\"> jdk.incubator.foreign.MemoryAddress.NULL;<\/span><\/span>\n+<span id=\"cb24-8\"><a href=\"#cb24-8\"><\/a><span class=\"kw\">import static<\/span><span class=\"im\"> org.unix.libproc_h.*;<\/span><\/span>\n+<span id=\"cb24-9\"><a href=\"#cb24-9\"><\/a><\/span>\n+<span id=\"cb24-10\"><a href=\"#cb24-10\"><\/a><span class=\"kw\">public<\/span> <span class=\"kw\">class<\/span> LibprocMain {<\/span>\n+<span id=\"cb24-11\"><a href=\"#cb24-11\"><\/a>    <span class=\"kw\">private<\/span> <span class=\"dt\">static<\/span> <span class=\"dt\">final<\/span> <span class=\"dt\">int<\/span> NAME_BUF_MAX = <span class=\"dv\">256<\/span>;<\/span>\n+<span id=\"cb24-12\"><a href=\"#cb24-12\"><\/a><\/span>\n+<span id=\"cb24-13\"><a href=\"#cb24-13\"><\/a>    <span class=\"kw\">public<\/span> <span class=\"dt\">static<\/span> <span class=\"dt\">void<\/span> <span class=\"fu\">main<\/span>(<span class=\"bu\">String<\/span>[] args) {<\/span>\n+<span id=\"cb24-14\"><a href=\"#cb24-14\"><\/a>        <span class=\"kw\">try<\/span> (var scope = ResourceScope.<span class=\"fu\">newConfinedScope<\/span>()) {<\/span>\n+<span id=\"cb24-15\"><a href=\"#cb24-15\"><\/a>            var allocator = SegmentAllocator.<span class=\"fu\">ofScope<\/span>(scope);<\/span>\n+<span id=\"cb24-16\"><a href=\"#cb24-16\"><\/a>            <span class=\"co\">\/\/ get the number of processes<\/span><\/span>\n+<span id=\"cb24-17\"><a href=\"#cb24-17\"><\/a>            <span class=\"dt\">int<\/span> numPids = <span class=\"fu\">proc_listallpids<\/span>(NULL, <span class=\"dv\">0<\/span>);<\/span>\n+<span id=\"cb24-18\"><a href=\"#cb24-18\"><\/a>            <span class=\"co\">\/\/ allocate an array<\/span><\/span>\n+<span id=\"cb24-19\"><a href=\"#cb24-19\"><\/a>            var pids = allocator.<span class=\"fu\">allocateArray<\/span>(CLinker.<span class=\"fu\">C_INT<\/span>, numPids);<\/span>\n+<span id=\"cb24-20\"><a href=\"#cb24-20\"><\/a>            <span class=\"co\">\/\/ list all the pids into the native array<\/span><\/span>\n+<span id=\"cb24-21\"><a href=\"#cb24-21\"><\/a>            <span class=\"fu\">proc_listallpids<\/span>(pids, numPids);<\/span>\n+<span id=\"cb24-22\"><a href=\"#cb24-22\"><\/a>            <span class=\"co\">\/\/ convert native array to java array<\/span><\/span>\n+<span id=\"cb24-23\"><a href=\"#cb24-23\"><\/a>            <span class=\"dt\">int<\/span>[] jpids = pids.<span class=\"fu\">toIntArray<\/span>();<\/span>\n+<span id=\"cb24-24\"><a href=\"#cb24-24\"><\/a>            <span class=\"co\">\/\/ buffer for process name<\/span><\/span>\n+<span id=\"cb24-25\"><a href=\"#cb24-25\"><\/a>            var nameBuf = allocator.<span class=\"fu\">allocateArray<\/span>(CLinker.<span class=\"fu\">C_CHAR<\/span>, NAME_BUF_MAX);<\/span>\n+<span id=\"cb24-26\"><a href=\"#cb24-26\"><\/a>            <span class=\"kw\">for<\/span> (<span class=\"dt\">int<\/span> i = <span class=\"dv\">0<\/span>; i &lt; jpids.<span class=\"fu\">length<\/span>; i++) {<\/span>\n+<span id=\"cb24-27\"><a href=\"#cb24-27\"><\/a>                <span class=\"dt\">int<\/span> pid = jpids[i];<\/span>\n+<span id=\"cb24-28\"><a href=\"#cb24-28\"><\/a>                <span class=\"co\">\/\/ get the process name<\/span><\/span>\n+<span id=\"cb24-29\"><a href=\"#cb24-29\"><\/a>                <span class=\"fu\">proc_name<\/span>(pid, nameBuf, NAME_BUF_MAX);<\/span>\n+<span id=\"cb24-30\"><a href=\"#cb24-30\"><\/a>                <span class=\"bu\">String<\/span> procName = CLinker.<span class=\"fu\">toJavaString<\/span>(nameBuf);<\/span>\n+<span id=\"cb24-31\"><a href=\"#cb24-31\"><\/a>                <span class=\"co\">\/\/ print pid and process name<\/span><\/span>\n+<span id=\"cb24-32\"><a href=\"#cb24-32\"><\/a>                <span class=\"bu\">System<\/span>.<span class=\"fu\">out.printf<\/span>(<span class=\"st\">&quot;<\/span><span class=\"sc\">%d<\/span><span class=\"st\"> <\/span><span class=\"sc\">%s\\n<\/span><span class=\"st\">&quot;<\/span>, pid, procName);<\/span>\n+<span id=\"cb24-33\"><a href=\"#cb24-33\"><\/a>            }<\/span>\n+<span id=\"cb24-34\"><a href=\"#cb24-34\"><\/a>        }<\/span>\n+<span id=\"cb24-35\"><a href=\"#cb24-35\"><\/a>    }<\/span>\n+<span id=\"cb24-36\"><a href=\"#cb24-36\"><\/a>}<\/span><\/code><\/pre><\/div>\n@@ -499,4 +538,4 @@\n-<div class=\"sourceCode\" id=\"cb25\"><pre class=\"sourceCode sh\"><code class=\"sourceCode bash\"><a class=\"sourceLine\" id=\"cb25-1\" title=\"1\"><\/a>\n-<a class=\"sourceLine\" id=\"cb25-2\" title=\"2\"><span class=\"ex\">java<\/span> -Dforeign.restricted=permit \\<\/a>\n-<a class=\"sourceLine\" id=\"cb25-3\" title=\"3\">    --add-modules jdk.incubator.foreign \\<\/a>\n-<a class=\"sourceLine\" id=\"cb25-4\" title=\"4\">    -Djava.library.path=\/usr\/lib LibprocMain.java<\/a><\/code><\/pre><\/div>\n+<div class=\"sourceCode\" id=\"cb25\"><pre class=\"sourceCode sh\"><code class=\"sourceCode bash\"><span id=\"cb25-1\"><a href=\"#cb25-1\"><\/a><\/span>\n+<span id=\"cb25-2\"><a href=\"#cb25-2\"><\/a><span class=\"ex\">java<\/span> --enable-native-access=ALL-UNNAMED \\<\/span>\n+<span id=\"cb25-3\"><a href=\"#cb25-3\"><\/a>    --add-modules jdk.incubator.foreign \\<\/span>\n+<span id=\"cb25-4\"><a href=\"#cb25-4\"><\/a>    -Djava.library.path=\/usr\/lib LibprocMain.java<\/span><\/code><\/pre><\/div>\n@@ -512,7 +551,7 @@\n-<div class=\"sourceCode\" id=\"cb26\"><pre class=\"sourceCode sh\"><code class=\"sourceCode bash\"><a class=\"sourceLine\" id=\"cb26-1\" title=\"1\"><\/a>\n-<a class=\"sourceLine\" id=\"cb26-2\" title=\"2\"><span class=\"ex\">jextract<\/span> \\<\/a>\n-<a class=\"sourceLine\" id=\"cb26-3\" title=\"3\">  -t com.github -lgit2 \\<\/a>\n-<a class=\"sourceLine\" id=\"cb26-4\" title=\"4\">  -I \/Applications\/Xcode.app\/Contents\/Developer\/Platforms\/MacOSX.platform\/Developer\/SDKs\/MacOSX.sdk\/usr\/include\/ \\<\/a>\n-<a class=\"sourceLine\" id=\"cb26-5\" title=\"5\">  -I <span class=\"va\">${LIBGIT2_HOME}<\/span>\/include\/ \\<\/a>\n-<a class=\"sourceLine\" id=\"cb26-6\" title=\"6\">  -I <span class=\"va\">${LIBGIT2_HOME}<\/span>\/include\/git2 \\<\/a>\n-<a class=\"sourceLine\" id=\"cb26-7\" title=\"7\">  <span class=\"va\">${LIBGIT2_HOME}<\/span>\/include\/git2.h<\/a><\/code><\/pre><\/div>\n+<div class=\"sourceCode\" id=\"cb26\"><pre class=\"sourceCode sh\"><code class=\"sourceCode bash\"><span id=\"cb26-1\"><a href=\"#cb26-1\"><\/a><\/span>\n+<span id=\"cb26-2\"><a href=\"#cb26-2\"><\/a><span class=\"ex\">jextract<\/span> \\<\/span>\n+<span id=\"cb26-3\"><a href=\"#cb26-3\"><\/a>  -t com.github -lgit2 \\<\/span>\n+<span id=\"cb26-4\"><a href=\"#cb26-4\"><\/a>  -I \/Applications\/Xcode.app\/Contents\/Developer\/Platforms\/MacOSX.platform\/Developer\/SDKs\/MacOSX.sdk\/usr\/include\/ \\<\/span>\n+<span id=\"cb26-5\"><a href=\"#cb26-5\"><\/a>  -I <span class=\"va\">${LIBGIT2_HOME}<\/span>\/include\/ \\<\/span>\n+<span id=\"cb26-6\"><a href=\"#cb26-6\"><\/a>  -I <span class=\"va\">${LIBGIT2_HOME}<\/span>\/include\/git2 \\<\/span>\n+<span id=\"cb26-7\"><a href=\"#cb26-7\"><\/a>  <span class=\"va\">${LIBGIT2_HOME}<\/span>\/include\/git2.h<\/span><\/code><\/pre><\/div>\n@@ -520,23 +559,26 @@\n-<div class=\"sourceCode\" id=\"cb27\"><pre class=\"sourceCode java\"><code class=\"sourceCode java\"><a class=\"sourceLine\" id=\"cb27-1\" title=\"1\"><\/a>\n-<a class=\"sourceLine\" id=\"cb27-2\" title=\"2\"><span class=\"kw\">import<\/span><span class=\"im\"> jdk.incubator.foreign.MemoryAddress;<\/span><\/a>\n-<a class=\"sourceLine\" id=\"cb27-3\" title=\"3\"><span class=\"kw\">import<\/span><span class=\"im\"> jdk.incubator.foreign.NativeScope;<\/span><\/a>\n-<a class=\"sourceLine\" id=\"cb27-4\" title=\"4\"><span class=\"kw\">import static<\/span><span class=\"im\"> com.github.git2_h.*;<\/span><\/a>\n-<a class=\"sourceLine\" id=\"cb27-5\" title=\"5\"><span class=\"kw\">import static<\/span><span class=\"im\"> jdk.incubator.foreign.CLinker.*;<\/span><\/a>\n-<a class=\"sourceLine\" id=\"cb27-6\" title=\"6\"><span class=\"kw\">import static<\/span><span class=\"im\"> jdk.incubator.foreign.MemoryAddress.NULL;<\/span><\/a>\n-<a class=\"sourceLine\" id=\"cb27-7\" title=\"7\"><\/a>\n-<a class=\"sourceLine\" id=\"cb27-8\" title=\"8\"><span class=\"kw\">public<\/span> <span class=\"kw\">class<\/span> GitClone {<\/a>\n-<a class=\"sourceLine\" id=\"cb27-9\" title=\"9\">    <span class=\"kw\">public<\/span> <span class=\"dt\">static<\/span> <span class=\"dt\">void<\/span> <span class=\"fu\">main<\/span>(<span class=\"bu\">String<\/span>[] args) {<\/a>\n-<a class=\"sourceLine\" id=\"cb27-10\" title=\"10\">          <span class=\"kw\">if<\/span> (args.<span class=\"fu\">length<\/span> != <span class=\"dv\">2<\/span>) {<\/a>\n-<a class=\"sourceLine\" id=\"cb27-11\" title=\"11\">              <span class=\"bu\">System<\/span>.<span class=\"fu\">err<\/span>.<span class=\"fu\">println<\/span>(<span class=\"st\">&quot;java GitClone &lt;url&gt; &lt;path&gt;&quot;<\/span>);<\/a>\n-<a class=\"sourceLine\" id=\"cb27-12\" title=\"12\">              <span class=\"bu\">System<\/span>.<span class=\"fu\">exit<\/span>(<span class=\"dv\">1<\/span>);<\/a>\n-<a class=\"sourceLine\" id=\"cb27-13\" title=\"13\">          }<\/a>\n-<a class=\"sourceLine\" id=\"cb27-14\" title=\"14\">          <span class=\"fu\">git_libgit2_init<\/span>();<\/a>\n-<a class=\"sourceLine\" id=\"cb27-15\" title=\"15\">          <span class=\"kw\">try<\/span> (var scope = NativeScope.<span class=\"fu\">unboundedScope<\/span>()) {<\/a>\n-<a class=\"sourceLine\" id=\"cb27-16\" title=\"16\">              var repo = scope.<span class=\"fu\">allocate<\/span>(C_POINTER);<\/a>\n-<a class=\"sourceLine\" id=\"cb27-17\" title=\"17\">              var url = <span class=\"fu\">toCString<\/span>(args[<span class=\"dv\">0<\/span>], scope);<\/a>\n-<a class=\"sourceLine\" id=\"cb27-18\" title=\"18\">              var path = <span class=\"fu\">toCString<\/span>(args[<span class=\"dv\">1<\/span>], scope);<\/a>\n-<a class=\"sourceLine\" id=\"cb27-19\" title=\"19\">              <span class=\"bu\">System<\/span>.<span class=\"fu\">out<\/span>.<span class=\"fu\">println<\/span>(<span class=\"fu\">git_clone<\/span>(repo, url, path, NULL));<\/a>\n-<a class=\"sourceLine\" id=\"cb27-20\" title=\"20\">          }<\/a>\n-<a class=\"sourceLine\" id=\"cb27-21\" title=\"21\">          <span class=\"fu\">git_libgit2_shutdown<\/span>();<\/a>\n-<a class=\"sourceLine\" id=\"cb27-22\" title=\"22\">    }<\/a>\n-<a class=\"sourceLine\" id=\"cb27-23\" title=\"23\">}<\/a><\/code><\/pre><\/div>\n+<div class=\"sourceCode\" id=\"cb27\"><pre class=\"sourceCode java\"><code class=\"sourceCode java\"><span id=\"cb27-1\"><a href=\"#cb27-1\"><\/a><\/span>\n+<span id=\"cb27-2\"><a href=\"#cb27-2\"><\/a><span class=\"kw\">import<\/span><span class=\"im\"> jdk.incubator.foreign.MemoryAddress;<\/span><\/span>\n+<span id=\"cb27-3\"><a href=\"#cb27-3\"><\/a><span class=\"kw\">import<\/span><span class=\"im\"> jdk.incubator.foreign.ResourceScope;<\/span><\/span>\n+<span id=\"cb27-4\"><a href=\"#cb27-4\"><\/a><span class=\"kw\">import<\/span><span class=\"im\"> jdk.incubator.foreign.SegmentAllocator;<\/span><\/span>\n+<span id=\"cb27-5\"><a href=\"#cb27-5\"><\/a><span class=\"kw\">import static<\/span><span class=\"im\"> com.github.git2_h.*;<\/span><\/span>\n+<span id=\"cb27-6\"><a href=\"#cb27-6\"><\/a><span class=\"kw\">import static<\/span><span class=\"im\"> jdk.incubator.foreign.CLinker.*;<\/span><\/span>\n+<span id=\"cb27-7\"><a href=\"#cb27-7\"><\/a><span class=\"kw\">import static<\/span><span class=\"im\"> jdk.incubator.foreign.MemoryAddress.NULL;<\/span><\/span>\n+<span id=\"cb27-8\"><a href=\"#cb27-8\"><\/a><span class=\"kw\">import<\/span><span class=\"im\"> com.github.*;<\/span><\/span>\n+<span id=\"cb27-9\"><a href=\"#cb27-9\"><\/a><\/span>\n+<span id=\"cb27-10\"><a href=\"#cb27-10\"><\/a><span class=\"kw\">public<\/span> <span class=\"kw\">class<\/span> GitClone {<\/span>\n+<span id=\"cb27-11\"><a href=\"#cb27-11\"><\/a>    <span class=\"kw\">public<\/span> <span class=\"dt\">static<\/span> <span class=\"dt\">void<\/span> <span class=\"fu\">main<\/span>(<span class=\"bu\">String<\/span>[] args) {<\/span>\n+<span id=\"cb27-12\"><a href=\"#cb27-12\"><\/a>          <span class=\"kw\">if<\/span> (args.<span class=\"fu\">length<\/span> != <span class=\"dv\">2<\/span>) {<\/span>\n+<span id=\"cb27-13\"><a href=\"#cb27-13\"><\/a>              <span class=\"bu\">System<\/span>.<span class=\"fu\">err<\/span>.<span class=\"fu\">println<\/span>(<span class=\"st\">&quot;java GitClone &lt;url&gt; &lt;path&gt;&quot;<\/span>);<\/span>\n+<span id=\"cb27-14\"><a href=\"#cb27-14\"><\/a>              <span class=\"bu\">System<\/span>.<span class=\"fu\">exit<\/span>(<span class=\"dv\">1<\/span>);<\/span>\n+<span id=\"cb27-15\"><a href=\"#cb27-15\"><\/a>          }<\/span>\n+<span id=\"cb27-16\"><a href=\"#cb27-16\"><\/a>          <span class=\"fu\">git_libgit2_init<\/span>();<\/span>\n+<span id=\"cb27-17\"><a href=\"#cb27-17\"><\/a>          <span class=\"kw\">try<\/span> (var scope = ResourceScope.<span class=\"fu\">newConfinedScope<\/span>()) {<\/span>\n+<span id=\"cb27-18\"><a href=\"#cb27-18\"><\/a>              var allocator = SegmentAllocator.<span class=\"fu\">ofScope<\/span>(scope);<\/span>\n+<span id=\"cb27-19\"><a href=\"#cb27-19\"><\/a>              var repo = allocator.<span class=\"fu\">allocate<\/span>(C_POINTER);<\/span>\n+<span id=\"cb27-20\"><a href=\"#cb27-20\"><\/a>              var url = <span class=\"fu\">toCString<\/span>(args[<span class=\"dv\">0<\/span>], scope);<\/span>\n+<span id=\"cb27-21\"><a href=\"#cb27-21\"><\/a>              var path = <span class=\"fu\">toCString<\/span>(args[<span class=\"dv\">1<\/span>], scope);<\/span>\n+<span id=\"cb27-22\"><a href=\"#cb27-22\"><\/a>              <span class=\"bu\">System<\/span>.<span class=\"fu\">out<\/span>.<span class=\"fu\">println<\/span>(<span class=\"fu\">git_clone<\/span>(repo, url, path, NULL));<\/span>\n+<span id=\"cb27-23\"><a href=\"#cb27-23\"><\/a>          }<\/span>\n+<span id=\"cb27-24\"><a href=\"#cb27-24\"><\/a>          <span class=\"fu\">git_libgit2_shutdown<\/span>();<\/span>\n+<span id=\"cb27-25\"><a href=\"#cb27-25\"><\/a>    }<\/span>\n+<span id=\"cb27-26\"><a href=\"#cb27-26\"><\/a>}<\/span><\/code><\/pre><\/div>\n@@ -544,6 +586,6 @@\n-<div class=\"sourceCode\" id=\"cb28\"><pre class=\"sourceCode sh\"><code class=\"sourceCode bash\"><a class=\"sourceLine\" id=\"cb28-1\" title=\"1\"><\/a>\n-<a class=\"sourceLine\" id=\"cb28-2\" title=\"2\"><span class=\"co\"># file run.sh<\/span><\/a>\n-<a class=\"sourceLine\" id=\"cb28-3\" title=\"3\"><\/a>\n-<a class=\"sourceLine\" id=\"cb28-4\" title=\"4\"><span class=\"ex\">java<\/span> -Dforeign.restricted=permit --add-modules jdk.incubator.foreign \\<\/a>\n-<a class=\"sourceLine\" id=\"cb28-5\" title=\"5\">    -Djava.library.path=<span class=\"va\">${LIBGIT2_HOME}<\/span>\/build\/ \\<\/a>\n-<a class=\"sourceLine\" id=\"cb28-6\" title=\"6\">    GitClone.java <span class=\"va\">$*<\/span><\/a><\/code><\/pre><\/div>\n+<div class=\"sourceCode\" id=\"cb28\"><pre class=\"sourceCode sh\"><code class=\"sourceCode bash\"><span id=\"cb28-1\"><a href=\"#cb28-1\"><\/a><\/span>\n+<span id=\"cb28-2\"><a href=\"#cb28-2\"><\/a><span class=\"co\"># file run.sh<\/span><\/span>\n+<span id=\"cb28-3\"><a href=\"#cb28-3\"><\/a><\/span>\n+<span id=\"cb28-4\"><a href=\"#cb28-4\"><\/a><span class=\"ex\">java<\/span> --enable-native-access=ALL-UNNAMED --add-modules jdk.incubator.foreign \\<\/span>\n+<span id=\"cb28-5\"><a href=\"#cb28-5\"><\/a>    -Djava.library.path=<span class=\"va\">${LIBGIT2_HOME}<\/span>\/build\/ \\<\/span>\n+<span id=\"cb28-6\"><a href=\"#cb28-6\"><\/a>    GitClone.java <span class=\"va\">$*<\/span><\/span><\/code><\/pre><\/div>\n@@ -551,2 +593,2 @@\n-<div class=\"sourceCode\" id=\"cb29\"><pre class=\"sourceCode sh\"><code class=\"sourceCode bash\"><a class=\"sourceLine\" id=\"cb29-1\" title=\"1\"><\/a>\n-<a class=\"sourceLine\" id=\"cb29-2\" title=\"2\"><span class=\"fu\">sh<\/span> run.sh https:\/\/github.com\/libgit2\/libgit2.git libgit2<\/a><\/code><\/pre><\/div>\n+<div class=\"sourceCode\" id=\"cb29\"><pre class=\"sourceCode sh\"><code class=\"sourceCode bash\"><span id=\"cb29-1\"><a href=\"#cb29-1\"><\/a><\/span>\n+<span id=\"cb29-2\"><a href=\"#cb29-2\"><\/a><span class=\"fu\">sh<\/span> run.sh https:\/\/github.com\/libgit2\/libgit2.git libgit2<\/span><\/code><\/pre><\/div>\n@@ -555,5 +597,5 @@\n-<div class=\"sourceCode\" id=\"cb30\"><pre class=\"sourceCode sh\"><code class=\"sourceCode bash\"><a class=\"sourceLine\" id=\"cb30-1\" title=\"1\"><\/a>\n-<a class=\"sourceLine\" id=\"cb30-2\" title=\"2\"><span class=\"ex\">jextract<\/span> \\<\/a>\n-<a class=\"sourceLine\" id=\"cb30-3\" title=\"3\">  -I \/Applications\/Xcode.app\/Contents\/Developer\/Platforms\/MacOSX.platform\/Developer\/SDKs\/MacOSX.sdk\/usr\/include \\<\/a>\n-<a class=\"sourceLine\" id=\"cb30-4\" title=\"4\">  \/Applications\/Xcode.app\/Contents\/Developer\/Platforms\/MacOSX.platform\/Developer\/SDKs\/MacOSX.sdk\/usr\/include\/sqlite3.h \\<\/a>\n-<a class=\"sourceLine\" id=\"cb30-5\" title=\"5\">  -t org.sqlite -lsqlite3<\/a><\/code><\/pre><\/div>\n+<div class=\"sourceCode\" id=\"cb30\"><pre class=\"sourceCode sh\"><code class=\"sourceCode bash\"><span id=\"cb30-1\"><a href=\"#cb30-1\"><\/a><\/span>\n+<span id=\"cb30-2\"><a href=\"#cb30-2\"><\/a><span class=\"ex\">jextract<\/span> \\<\/span>\n+<span id=\"cb30-3\"><a href=\"#cb30-3\"><\/a>  -I \/Applications\/Xcode.app\/Contents\/Developer\/Platforms\/MacOSX.platform\/Developer\/SDKs\/MacOSX.sdk\/usr\/include \\<\/span>\n+<span id=\"cb30-4\"><a href=\"#cb30-4\"><\/a>  \/Applications\/Xcode.app\/Contents\/Developer\/Platforms\/MacOSX.platform\/Developer\/SDKs\/MacOSX.sdk\/usr\/include\/sqlite3.h \\<\/span>\n+<span id=\"cb30-5\"><a href=\"#cb30-5\"><\/a>  -t org.sqlite -lsqlite3<\/span><\/code><\/pre><\/div>\n@@ -561,93 +603,97 @@\n-<div class=\"sourceCode\" id=\"cb31\"><pre class=\"sourceCode java\"><code class=\"sourceCode java\"><a class=\"sourceLine\" id=\"cb31-1\" title=\"1\"><\/a>\n-<a class=\"sourceLine\" id=\"cb31-2\" title=\"2\"><span class=\"kw\">import<\/span><span class=\"im\"> jdk.incubator.foreign.MemoryAddress;<\/span><\/a>\n-<a class=\"sourceLine\" id=\"cb31-3\" title=\"3\"><span class=\"kw\">import<\/span><span class=\"im\"> jdk.incubator.foreign.MemoryAccess;<\/span><\/a>\n-<a class=\"sourceLine\" id=\"cb31-4\" title=\"4\"><span class=\"kw\">import<\/span><span class=\"im\"> jdk.incubator.foreign.NativeScope;<\/span><\/a>\n-<a class=\"sourceLine\" id=\"cb31-5\" title=\"5\"><span class=\"kw\">import static<\/span><span class=\"im\"> jdk.incubator.foreign.MemoryAddress.NULL;<\/span><\/a>\n-<a class=\"sourceLine\" id=\"cb31-6\" title=\"6\"><span class=\"kw\">import static<\/span><span class=\"im\"> org.sqlite.sqlite3_h.*;<\/span><\/a>\n-<a class=\"sourceLine\" id=\"cb31-7\" title=\"7\"><span class=\"kw\">import static<\/span><span class=\"im\"> jdk.incubator.foreign.CLinker.*;<\/span><\/a>\n-<a class=\"sourceLine\" id=\"cb31-8\" title=\"8\"><\/a>\n-<a class=\"sourceLine\" id=\"cb31-9\" title=\"9\"><span class=\"kw\">public<\/span> <span class=\"kw\">class<\/span> SqliteMain {<\/a>\n-<a class=\"sourceLine\" id=\"cb31-10\" title=\"10\">   <span class=\"kw\">public<\/span> <span class=\"dt\">static<\/span> <span class=\"dt\">void<\/span> <span class=\"fu\">main<\/span>(<span class=\"bu\">String<\/span>[] args) <span class=\"kw\">throws<\/span> <span class=\"bu\">Exception<\/span> {<\/a>\n-<a class=\"sourceLine\" id=\"cb31-11\" title=\"11\">        <span class=\"kw\">try<\/span> (var scope = NativeScope.<span class=\"fu\">unboundedScope<\/span>()) {<\/a>\n-<a class=\"sourceLine\" id=\"cb31-12\" title=\"12\">            <span class=\"co\">\/\/ char** errMsgPtrPtr;<\/span><\/a>\n-<a class=\"sourceLine\" id=\"cb31-13\" title=\"13\">            var errMsgPtrPtr = scope.<span class=\"fu\">allocate<\/span>(C_POINTER);<\/a>\n-<a class=\"sourceLine\" id=\"cb31-14\" title=\"14\"><\/a>\n-<a class=\"sourceLine\" id=\"cb31-15\" title=\"15\">            <span class=\"co\">\/\/ sqlite3** dbPtrPtr;<\/span><\/a>\n-<a class=\"sourceLine\" id=\"cb31-16\" title=\"16\">            var dbPtrPtr = scope.<span class=\"fu\">allocate<\/span>(C_POINTER);<\/a>\n-<a class=\"sourceLine\" id=\"cb31-17\" title=\"17\"><\/a>\n-<a class=\"sourceLine\" id=\"cb31-18\" title=\"18\">            <span class=\"dt\">int<\/span> rc = <span class=\"fu\">sqlite3_open<\/span>(<span class=\"fu\">toCString<\/span>(<span class=\"st\">&quot;employee.db&quot;<\/span>,scope), dbPtrPtr);<\/a>\n-<a class=\"sourceLine\" id=\"cb31-19\" title=\"19\">            <span class=\"kw\">if<\/span> (rc != <span class=\"dv\">0<\/span>) {<\/a>\n-<a class=\"sourceLine\" id=\"cb31-20\" title=\"20\">                <span class=\"bu\">System<\/span>.<span class=\"fu\">err<\/span>.<span class=\"fu\">println<\/span>(<span class=\"st\">&quot;sqlite3_open failed: &quot;<\/span> + rc);<\/a>\n-<a class=\"sourceLine\" id=\"cb31-21\" title=\"21\">                <span class=\"kw\">return<\/span>;<\/a>\n-<a class=\"sourceLine\" id=\"cb31-22\" title=\"22\">            } <span class=\"kw\">else<\/span> {<\/a>\n-<a class=\"sourceLine\" id=\"cb31-23\" title=\"23\">                <span class=\"bu\">System<\/span>.<span class=\"fu\">out<\/span>.<span class=\"fu\">println<\/span>(<span class=\"st\">&quot;employee db opened&quot;<\/span>);<\/a>\n-<a class=\"sourceLine\" id=\"cb31-24\" title=\"24\">            }<\/a>\n-<a class=\"sourceLine\" id=\"cb31-25\" title=\"25\"><\/a>\n-<a class=\"sourceLine\" id=\"cb31-26\" title=\"26\">            <span class=\"co\">\/\/ sqlite3* dbPtr;<\/span><\/a>\n-<a class=\"sourceLine\" id=\"cb31-27\" title=\"27\">            var dbPtr = MemoryAccess.<span class=\"fu\">getAddress<\/span>(dbPtrPtr);<\/a>\n-<a class=\"sourceLine\" id=\"cb31-28\" title=\"28\"><\/a>\n-<a class=\"sourceLine\" id=\"cb31-29\" title=\"29\">            <span class=\"co\">\/\/ create a new table<\/span><\/a>\n-<a class=\"sourceLine\" id=\"cb31-30\" title=\"30\">            var sql = <span class=\"fu\">toCString<\/span>(<\/a>\n-<a class=\"sourceLine\" id=\"cb31-31\" title=\"31\">                <span class=\"st\">&quot;CREATE TABLE EMPLOYEE (&quot;<\/span>  +<\/a>\n-<a class=\"sourceLine\" id=\"cb31-32\" title=\"32\">                <span class=\"st\">&quot;  ID INT PRIMARY KEY NOT NULL,&quot;<\/span> +<\/a>\n-<a class=\"sourceLine\" id=\"cb31-33\" title=\"33\">                <span class=\"st\">&quot;  NAME TEXT NOT NULL,&quot;<\/span>    +<\/a>\n-<a class=\"sourceLine\" id=\"cb31-34\" title=\"34\">                <span class=\"st\">&quot;  SALARY REAL NOT NULL )&quot;<\/span>, scope);<\/a>\n-<a class=\"sourceLine\" id=\"cb31-35\" title=\"35\"><\/a>\n-<a class=\"sourceLine\" id=\"cb31-36\" title=\"36\">            rc = <span class=\"fu\">sqlite3_exec<\/span>(dbPtr, sql, NULL, NULL, errMsgPtrPtr);<\/a>\n-<a class=\"sourceLine\" id=\"cb31-37\" title=\"37\"><\/a>\n-<a class=\"sourceLine\" id=\"cb31-38\" title=\"38\">            <span class=\"kw\">if<\/span> (rc != <span class=\"dv\">0<\/span>) {<\/a>\n-<a class=\"sourceLine\" id=\"cb31-39\" title=\"39\">                <span class=\"bu\">System<\/span>.<span class=\"fu\">err<\/span>.<span class=\"fu\">println<\/span>(<span class=\"st\">&quot;sqlite3_exec failed: &quot;<\/span> + rc);<\/a>\n-<a class=\"sourceLine\" id=\"cb31-40\" title=\"40\">                <span class=\"bu\">System<\/span>.<span class=\"fu\">err<\/span>.<span class=\"fu\">println<\/span>(<span class=\"st\">&quot;SQL error: &quot;<\/span> + <span class=\"fu\">toJavaStringRestricted<\/span>(MemoryAccess.<span class=\"fu\">getAddress<\/span>(errMsgPtrPtr)));<\/a>\n-<a class=\"sourceLine\" id=\"cb31-41\" title=\"41\">                <span class=\"fu\">sqlite3_free<\/span>(MemoryAccess.<span class=\"fu\">getAddress<\/span>(errMsgPtrPtr));<\/a>\n-<a class=\"sourceLine\" id=\"cb31-42\" title=\"42\">            } <span class=\"kw\">else<\/span> {<\/a>\n-<a class=\"sourceLine\" id=\"cb31-43\" title=\"43\">                <span class=\"bu\">System<\/span>.<span class=\"fu\">out<\/span>.<span class=\"fu\">println<\/span>(<span class=\"st\">&quot;employee table created&quot;<\/span>);<\/a>\n-<a class=\"sourceLine\" id=\"cb31-44\" title=\"44\">            }<\/a>\n-<a class=\"sourceLine\" id=\"cb31-45\" title=\"45\"><\/a>\n-<a class=\"sourceLine\" id=\"cb31-46\" title=\"46\">            <span class=\"co\">\/\/ insert two rows<\/span><\/a>\n-<a class=\"sourceLine\" id=\"cb31-47\" title=\"47\">            sql = <span class=\"fu\">toCString<\/span>(<\/a>\n-<a class=\"sourceLine\" id=\"cb31-48\" title=\"48\">                <span class=\"st\">&quot;INSERT INTO EMPLOYEE (ID,NAME,SALARY) &quot;<\/span> +<\/a>\n-<a class=\"sourceLine\" id=\"cb31-49\" title=\"49\">                    <span class=\"st\">&quot;VALUES (134, &#39;Xyz&#39;, 200000.0); &quot;<\/span> +<\/a>\n-<a class=\"sourceLine\" id=\"cb31-50\" title=\"50\">                <span class=\"st\">&quot;INSERT INTO EMPLOYEE (ID,NAME,SALARY) &quot;<\/span> +<\/a>\n-<a class=\"sourceLine\" id=\"cb31-51\" title=\"51\">                    <span class=\"st\">&quot;VALUES (333, &#39;Abc&#39;, 100000.0);&quot;<\/span>, scope<\/a>\n-<a class=\"sourceLine\" id=\"cb31-52\" title=\"52\">            );<\/a>\n-<a class=\"sourceLine\" id=\"cb31-53\" title=\"53\">            rc = <span class=\"fu\">sqlite3_exec<\/span>(dbPtr, sql, NULL, NULL, errMsgPtrPtr);<\/a>\n-<a class=\"sourceLine\" id=\"cb31-54\" title=\"54\"><\/a>\n-<a class=\"sourceLine\" id=\"cb31-55\" title=\"55\">            <span class=\"kw\">if<\/span> (rc != <span class=\"dv\">0<\/span>) {<\/a>\n-<a class=\"sourceLine\" id=\"cb31-56\" title=\"56\">                <span class=\"bu\">System<\/span>.<span class=\"fu\">err<\/span>.<span class=\"fu\">println<\/span>(<span class=\"st\">&quot;sqlite3_exec failed: &quot;<\/span> + rc);<\/a>\n-<a class=\"sourceLine\" id=\"cb31-57\" title=\"57\">                <span class=\"bu\">System<\/span>.<span class=\"fu\">err<\/span>.<span class=\"fu\">println<\/span>(<span class=\"st\">&quot;SQL error: &quot;<\/span> + <span class=\"fu\">toJavaStringRestricted<\/span>(MemoryAccess.<span class=\"fu\">getAddress<\/span>(errMsgPtrPtr)));<\/a>\n-<a class=\"sourceLine\" id=\"cb31-58\" title=\"58\">                <span class=\"fu\">sqlite3_free<\/span>(MemoryAccess.<span class=\"fu\">getAddress<\/span>(errMsgPtrPtr));<\/a>\n-<a class=\"sourceLine\" id=\"cb31-59\" title=\"59\">            } <span class=\"kw\">else<\/span> {<\/a>\n-<a class=\"sourceLine\" id=\"cb31-60\" title=\"60\">                <span class=\"bu\">System<\/span>.<span class=\"fu\">out<\/span>.<span class=\"fu\">println<\/span>(<span class=\"st\">&quot;rows inserted&quot;<\/span>);<\/a>\n-<a class=\"sourceLine\" id=\"cb31-61\" title=\"61\">            }<\/a>\n-<a class=\"sourceLine\" id=\"cb31-62\" title=\"62\"><\/a>\n-<a class=\"sourceLine\" id=\"cb31-63\" title=\"63\">            <span class=\"dt\">int<\/span>[] rowNum = <span class=\"kw\">new<\/span> <span class=\"dt\">int<\/span>[<span class=\"dv\">1<\/span>];<\/a>\n-<a class=\"sourceLine\" id=\"cb31-64\" title=\"64\">            <span class=\"co\">\/\/ callback to print rows from SELECT query<\/span><\/a>\n-<a class=\"sourceLine\" id=\"cb31-65\" title=\"65\">            var callback = sqlite3_exec$callback.<span class=\"fu\">allocate<\/span>((a, argc, argv, columnNames) -&gt; {<\/a>\n-<a class=\"sourceLine\" id=\"cb31-66\" title=\"66\">                <span class=\"bu\">System<\/span>.<span class=\"fu\">out<\/span>.<span class=\"fu\">println<\/span>(<span class=\"st\">&quot;Row num: &quot;<\/span> + rowNum[<span class=\"dv\">0<\/span>]++);<\/a>\n-<a class=\"sourceLine\" id=\"cb31-67\" title=\"67\">                <span class=\"bu\">System<\/span>.<span class=\"fu\">out<\/span>.<span class=\"fu\">println<\/span>(<span class=\"st\">&quot;numColumns = &quot;<\/span> + argc);<\/a>\n-<a class=\"sourceLine\" id=\"cb31-68\" title=\"68\">                var argv_seg = argv.<span class=\"fu\">asSegmentRestricted<\/span>(C_POINTER.<span class=\"fu\">byteSize<\/span>() * argc);<\/a>\n-<a class=\"sourceLine\" id=\"cb31-69\" title=\"69\">                var columnNames_seg = columnNames.<span class=\"fu\">asSegmentRestricted<\/span>(C_POINTER.<span class=\"fu\">byteSize<\/span>() * argc);<\/a>\n-<a class=\"sourceLine\" id=\"cb31-70\" title=\"70\">                <span class=\"kw\">for<\/span> (<span class=\"dt\">int<\/span> i = <span class=\"dv\">0<\/span>; i &lt; argc; i++) {<\/a>\n-<a class=\"sourceLine\" id=\"cb31-71\" title=\"71\">                     <span class=\"bu\">String<\/span> name = <span class=\"fu\">toJavaStringRestricted<\/span>(MemoryAccess.<span class=\"fu\">getAddressAtIndex<\/span>(columnNames_seg, i));<\/a>\n-<a class=\"sourceLine\" id=\"cb31-72\" title=\"72\">                     <span class=\"bu\">String<\/span> value = <span class=\"fu\">toJavaStringRestricted<\/span>(MemoryAccess.<span class=\"fu\">getAddressAtIndex<\/span>(argv_seg, i));<\/a>\n-<a class=\"sourceLine\" id=\"cb31-73\" title=\"73\">                     <span class=\"bu\">System<\/span>.<span class=\"fu\">out.printf<\/span>(<span class=\"st\">&quot;<\/span><span class=\"sc\">%s<\/span><span class=\"st\"> = <\/span><span class=\"sc\">%s\\n<\/span><span class=\"st\">&quot;<\/span>, name, value);<\/a>\n-<a class=\"sourceLine\" id=\"cb31-74\" title=\"74\">                }<\/a>\n-<a class=\"sourceLine\" id=\"cb31-75\" title=\"75\">                <span class=\"kw\">return<\/span> <span class=\"dv\">0<\/span>;<\/a>\n-<a class=\"sourceLine\" id=\"cb31-76\" title=\"76\">            }, scope);<\/a>\n-<a class=\"sourceLine\" id=\"cb31-77\" title=\"77\"><\/a>\n-<a class=\"sourceLine\" id=\"cb31-78\" title=\"78\">            <span class=\"co\">\/\/ select query<\/span><\/a>\n-<a class=\"sourceLine\" id=\"cb31-79\" title=\"79\">            sql = <span class=\"fu\">toCString<\/span>(<span class=\"st\">&quot;SELECT * FROM EMPLOYEE&quot;<\/span>, scope);<\/a>\n-<a class=\"sourceLine\" id=\"cb31-80\" title=\"80\">            rc = <span class=\"fu\">sqlite3_exec<\/span>(dbPtr, sql, callback, NULL, errMsgPtrPtr);<\/a>\n-<a class=\"sourceLine\" id=\"cb31-81\" title=\"81\"><\/a>\n-<a class=\"sourceLine\" id=\"cb31-82\" title=\"82\">            <span class=\"kw\">if<\/span> (rc != <span class=\"dv\">0<\/span>) {<\/a>\n-<a class=\"sourceLine\" id=\"cb31-83\" title=\"83\">                <span class=\"bu\">System<\/span>.<span class=\"fu\">err<\/span>.<span class=\"fu\">println<\/span>(<span class=\"st\">&quot;sqlite3_exec failed: &quot;<\/span> + rc);<\/a>\n-<a class=\"sourceLine\" id=\"cb31-84\" title=\"84\">                <span class=\"bu\">System<\/span>.<span class=\"fu\">err<\/span>.<span class=\"fu\">println<\/span>(<span class=\"st\">&quot;SQL error: &quot;<\/span> + <span class=\"fu\">toJavaStringRestricted<\/span>(MemoryAccess.<span class=\"fu\">getAddress<\/span>(errMsgPtrPtr)));<\/a>\n-<a class=\"sourceLine\" id=\"cb31-85\" title=\"85\">                <span class=\"fu\">sqlite3_free<\/span>(MemoryAccess.<span class=\"fu\">getAddress<\/span>(errMsgPtrPtr));<\/a>\n-<a class=\"sourceLine\" id=\"cb31-86\" title=\"86\">            } <span class=\"kw\">else<\/span> {<\/a>\n-<a class=\"sourceLine\" id=\"cb31-87\" title=\"87\">                <span class=\"bu\">System<\/span>.<span class=\"fu\">out<\/span>.<span class=\"fu\">println<\/span>(<span class=\"st\">&quot;done&quot;<\/span>);<\/a>\n-<a class=\"sourceLine\" id=\"cb31-88\" title=\"88\">            }<\/a>\n-<a class=\"sourceLine\" id=\"cb31-89\" title=\"89\"><\/a>\n-<a class=\"sourceLine\" id=\"cb31-90\" title=\"90\">            <span class=\"fu\">sqlite3_close<\/span>(dbPtr);<\/a>\n-<a class=\"sourceLine\" id=\"cb31-91\" title=\"91\">        }<\/a>\n-<a class=\"sourceLine\" id=\"cb31-92\" title=\"92\">    }<\/a>\n-<a class=\"sourceLine\" id=\"cb31-93\" title=\"93\">}<\/a><\/code><\/pre><\/div>\n+<div class=\"sourceCode\" id=\"cb31\"><pre class=\"sourceCode java\"><code class=\"sourceCode java\"><span id=\"cb31-1\"><a href=\"#cb31-1\"><\/a><\/span>\n+<span id=\"cb31-2\"><a href=\"#cb31-2\"><\/a><span class=\"kw\">import<\/span><span class=\"im\"> jdk.incubator.foreign.MemoryAddress;<\/span><\/span>\n+<span id=\"cb31-3\"><a href=\"#cb31-3\"><\/a><span class=\"kw\">import<\/span><span class=\"im\"> jdk.incubator.foreign.MemoryAccess;<\/span><\/span>\n+<span id=\"cb31-4\"><a href=\"#cb31-4\"><\/a><span class=\"kw\">import<\/span><span class=\"im\"> jdk.incubator.foreign.ResourceScope;<\/span><\/span>\n+<span id=\"cb31-5\"><a href=\"#cb31-5\"><\/a><span class=\"kw\">import<\/span><span class=\"im\"> jdk.incubator.foreign.SegmentAllocator;<\/span><\/span>\n+<span id=\"cb31-6\"><a href=\"#cb31-6\"><\/a><span class=\"kw\">import<\/span><span class=\"im\"> org.sqlite.*;<\/span><\/span>\n+<span id=\"cb31-7\"><a href=\"#cb31-7\"><\/a><span class=\"kw\">import static<\/span><span class=\"im\"> jdk.incubator.foreign.MemoryAddress.NULL;<\/span><\/span>\n+<span id=\"cb31-8\"><a href=\"#cb31-8\"><\/a><span class=\"kw\">import static<\/span><span class=\"im\"> org.sqlite.sqlite3_h.*;<\/span><\/span>\n+<span id=\"cb31-9\"><a href=\"#cb31-9\"><\/a><span class=\"kw\">import static<\/span><span class=\"im\"> jdk.incubator.foreign.CLinker.*;<\/span><\/span>\n+<span id=\"cb31-10\"><a href=\"#cb31-10\"><\/a><\/span>\n+<span id=\"cb31-11\"><a href=\"#cb31-11\"><\/a><span class=\"kw\">public<\/span> <span class=\"kw\">class<\/span> SqliteMain {<\/span>\n+<span id=\"cb31-12\"><a href=\"#cb31-12\"><\/a>   <span class=\"kw\">public<\/span> <span class=\"dt\">static<\/span> <span class=\"dt\">void<\/span> <span class=\"fu\">main<\/span>(<span class=\"bu\">String<\/span>[] args) <span class=\"kw\">throws<\/span> <span class=\"bu\">Exception<\/span> {<\/span>\n+<span id=\"cb31-13\"><a href=\"#cb31-13\"><\/a>        <span class=\"kw\">try<\/span> (var scope = ResourceScope.<span class=\"fu\">newConfinedScope<\/span>()) {<\/span>\n+<span id=\"cb31-14\"><a href=\"#cb31-14\"><\/a>            var allocator = SegmentAllocator.<span class=\"fu\">ofScope<\/span>(scope);<\/span>\n+<span id=\"cb31-15\"><a href=\"#cb31-15\"><\/a>            <span class=\"co\">\/\/ char** errMsgPtrPtr;<\/span><\/span>\n+<span id=\"cb31-16\"><a href=\"#cb31-16\"><\/a>            var errMsgPtrPtr = allocator.<span class=\"fu\">allocate<\/span>(C_POINTER);<\/span>\n+<span id=\"cb31-17\"><a href=\"#cb31-17\"><\/a><\/span>\n+<span id=\"cb31-18\"><a href=\"#cb31-18\"><\/a>            <span class=\"co\">\/\/ sqlite3** dbPtrPtr;<\/span><\/span>\n+<span id=\"cb31-19\"><a href=\"#cb31-19\"><\/a>            var dbPtrPtr = allocator.<span class=\"fu\">allocate<\/span>(C_POINTER);<\/span>\n+<span id=\"cb31-20\"><a href=\"#cb31-20\"><\/a><\/span>\n+<span id=\"cb31-21\"><a href=\"#cb31-21\"><\/a>            <span class=\"dt\">int<\/span> rc = <span class=\"fu\">sqlite3_open<\/span>(<span class=\"fu\">toCString<\/span>(<span class=\"st\">&quot;employee.db&quot;<\/span>,scope), dbPtrPtr);<\/span>\n+<span id=\"cb31-22\"><a href=\"#cb31-22\"><\/a>            <span class=\"kw\">if<\/span> (rc != <span class=\"dv\">0<\/span>) {<\/span>\n+<span id=\"cb31-23\"><a href=\"#cb31-23\"><\/a>                <span class=\"bu\">System<\/span>.<span class=\"fu\">err<\/span>.<span class=\"fu\">println<\/span>(<span class=\"st\">&quot;sqlite3_open failed: &quot;<\/span> + rc);<\/span>\n+<span id=\"cb31-24\"><a href=\"#cb31-24\"><\/a>                <span class=\"kw\">return<\/span>;<\/span>\n+<span id=\"cb31-25\"><a href=\"#cb31-25\"><\/a>            } <span class=\"kw\">else<\/span> {<\/span>\n+<span id=\"cb31-26\"><a href=\"#cb31-26\"><\/a>                <span class=\"bu\">System<\/span>.<span class=\"fu\">out<\/span>.<span class=\"fu\">println<\/span>(<span class=\"st\">&quot;employee db opened&quot;<\/span>);<\/span>\n+<span id=\"cb31-27\"><a href=\"#cb31-27\"><\/a>            }<\/span>\n+<span id=\"cb31-28\"><a href=\"#cb31-28\"><\/a><\/span>\n+<span id=\"cb31-29\"><a href=\"#cb31-29\"><\/a>            <span class=\"co\">\/\/ sqlite3* dbPtr;<\/span><\/span>\n+<span id=\"cb31-30\"><a href=\"#cb31-30\"><\/a>            var dbPtr = MemoryAccess.<span class=\"fu\">getAddress<\/span>(dbPtrPtr);<\/span>\n+<span id=\"cb31-31\"><a href=\"#cb31-31\"><\/a><\/span>\n+<span id=\"cb31-32\"><a href=\"#cb31-32\"><\/a>            <span class=\"co\">\/\/ create a new table<\/span><\/span>\n+<span id=\"cb31-33\"><a href=\"#cb31-33\"><\/a>            var sql = <span class=\"fu\">toCString<\/span>(<\/span>\n+<span id=\"cb31-34\"><a href=\"#cb31-34\"><\/a>                <span class=\"st\">&quot;CREATE TABLE EMPLOYEE (&quot;<\/span>  +<\/span>\n+<span id=\"cb31-35\"><a href=\"#cb31-35\"><\/a>                <span class=\"st\">&quot;  ID INT PRIMARY KEY NOT NULL,&quot;<\/span> +<\/span>\n+<span id=\"cb31-36\"><a href=\"#cb31-36\"><\/a>                <span class=\"st\">&quot;  NAME TEXT NOT NULL,&quot;<\/span>    +<\/span>\n+<span id=\"cb31-37\"><a href=\"#cb31-37\"><\/a>                <span class=\"st\">&quot;  SALARY REAL NOT NULL )&quot;<\/span>, scope);<\/span>\n+<span id=\"cb31-38\"><a href=\"#cb31-38\"><\/a><\/span>\n+<span id=\"cb31-39\"><a href=\"#cb31-39\"><\/a>            rc = <span class=\"fu\">sqlite3_exec<\/span>(dbPtr, sql, NULL, NULL, errMsgPtrPtr);<\/span>\n+<span id=\"cb31-40\"><a href=\"#cb31-40\"><\/a><\/span>\n+<span id=\"cb31-41\"><a href=\"#cb31-41\"><\/a>            <span class=\"kw\">if<\/span> (rc != <span class=\"dv\">0<\/span>) {<\/span>\n+<span id=\"cb31-42\"><a href=\"#cb31-42\"><\/a>                <span class=\"bu\">System<\/span>.<span class=\"fu\">err<\/span>.<span class=\"fu\">println<\/span>(<span class=\"st\">&quot;sqlite3_exec failed: &quot;<\/span> + rc);<\/span>\n+<span id=\"cb31-43\"><a href=\"#cb31-43\"><\/a>                <span class=\"bu\">System<\/span>.<span class=\"fu\">err<\/span>.<span class=\"fu\">println<\/span>(<span class=\"st\">&quot;SQL error: &quot;<\/span> + <span class=\"fu\">toJavaString<\/span>(MemoryAccess.<span class=\"fu\">getAddress<\/span>(errMsgPtrPtr)));<\/span>\n+<span id=\"cb31-44\"><a href=\"#cb31-44\"><\/a>                <span class=\"fu\">sqlite3_free<\/span>(MemoryAccess.<span class=\"fu\">getAddress<\/span>(errMsgPtrPtr));<\/span>\n+<span id=\"cb31-45\"><a href=\"#cb31-45\"><\/a>            } <span class=\"kw\">else<\/span> {<\/span>\n+<span id=\"cb31-46\"><a href=\"#cb31-46\"><\/a>                <span class=\"bu\">System<\/span>.<span class=\"fu\">out<\/span>.<span class=\"fu\">println<\/span>(<span class=\"st\">&quot;employee table created&quot;<\/span>);<\/span>\n+<span id=\"cb31-47\"><a href=\"#cb31-47\"><\/a>            }<\/span>\n+<span id=\"cb31-48\"><a href=\"#cb31-48\"><\/a><\/span>\n+<span id=\"cb31-49\"><a href=\"#cb31-49\"><\/a>            <span class=\"co\">\/\/ insert two rows<\/span><\/span>\n+<span id=\"cb31-50\"><a href=\"#cb31-50\"><\/a>            sql = <span class=\"fu\">toCString<\/span>(<\/span>\n+<span id=\"cb31-51\"><a href=\"#cb31-51\"><\/a>                <span class=\"st\">&quot;INSERT INTO EMPLOYEE (ID,NAME,SALARY) &quot;<\/span> +<\/span>\n+<span id=\"cb31-52\"><a href=\"#cb31-52\"><\/a>                    <span class=\"st\">&quot;VALUES (134, &#39;Xyz&#39;, 200000.0); &quot;<\/span> +<\/span>\n+<span id=\"cb31-53\"><a href=\"#cb31-53\"><\/a>                <span class=\"st\">&quot;INSERT INTO EMPLOYEE (ID,NAME,SALARY) &quot;<\/span> +<\/span>\n+<span id=\"cb31-54\"><a href=\"#cb31-54\"><\/a>                    <span class=\"st\">&quot;VALUES (333, &#39;Abc&#39;, 100000.0);&quot;<\/span>, scope<\/span>\n+<span id=\"cb31-55\"><a href=\"#cb31-55\"><\/a>            );<\/span>\n+<span id=\"cb31-56\"><a href=\"#cb31-56\"><\/a>            rc = <span class=\"fu\">sqlite3_exec<\/span>(dbPtr, sql, NULL, NULL, errMsgPtrPtr);<\/span>\n+<span id=\"cb31-57\"><a href=\"#cb31-57\"><\/a><\/span>\n+<span id=\"cb31-58\"><a href=\"#cb31-58\"><\/a>            <span class=\"kw\">if<\/span> (rc != <span class=\"dv\">0<\/span>) {<\/span>\n+<span id=\"cb31-59\"><a href=\"#cb31-59\"><\/a>                <span class=\"bu\">System<\/span>.<span class=\"fu\">err<\/span>.<span class=\"fu\">println<\/span>(<span class=\"st\">&quot;sqlite3_exec failed: &quot;<\/span> + rc);<\/span>\n+<span id=\"cb31-60\"><a href=\"#cb31-60\"><\/a>                <span class=\"bu\">System<\/span>.<span class=\"fu\">err<\/span>.<span class=\"fu\">println<\/span>(<span class=\"st\">&quot;SQL error: &quot;<\/span> + <span class=\"fu\">toJavaString<\/span>(MemoryAccess.<span class=\"fu\">getAddress<\/span>(errMsgPtrPtr)));<\/span>\n+<span id=\"cb31-61\"><a href=\"#cb31-61\"><\/a>                <span class=\"fu\">sqlite3_free<\/span>(MemoryAccess.<span class=\"fu\">getAddress<\/span>(errMsgPtrPtr));<\/span>\n+<span id=\"cb31-62\"><a href=\"#cb31-62\"><\/a>            } <span class=\"kw\">else<\/span> {<\/span>\n+<span id=\"cb31-63\"><a href=\"#cb31-63\"><\/a>                <span class=\"bu\">System<\/span>.<span class=\"fu\">out<\/span>.<span class=\"fu\">println<\/span>(<span class=\"st\">&quot;rows inserted&quot;<\/span>);<\/span>\n+<span id=\"cb31-64\"><a href=\"#cb31-64\"><\/a>            }<\/span>\n+<span id=\"cb31-65\"><a href=\"#cb31-65\"><\/a><\/span>\n+<span id=\"cb31-66\"><a href=\"#cb31-66\"><\/a>            <span class=\"dt\">int<\/span>[] rowNum = <span class=\"kw\">new<\/span> <span class=\"dt\">int<\/span>[<span class=\"dv\">1<\/span>];<\/span>\n+<span id=\"cb31-67\"><a href=\"#cb31-67\"><\/a>            <span class=\"co\">\/\/ callback to print rows from SELECT query<\/span><\/span>\n+<span id=\"cb31-68\"><a href=\"#cb31-68\"><\/a>            var callback = sqlite3_exec$callback.<span class=\"fu\">allocate<\/span>((a, argc, argv, columnNames) -&gt; {<\/span>\n+<span id=\"cb31-69\"><a href=\"#cb31-69\"><\/a>                <span class=\"bu\">System<\/span>.<span class=\"fu\">out<\/span>.<span class=\"fu\">println<\/span>(<span class=\"st\">&quot;Row num: &quot;<\/span> + rowNum[<span class=\"dv\">0<\/span>]++);<\/span>\n+<span id=\"cb31-70\"><a href=\"#cb31-70\"><\/a>                <span class=\"bu\">System<\/span>.<span class=\"fu\">out<\/span>.<span class=\"fu\">println<\/span>(<span class=\"st\">&quot;numColumns = &quot;<\/span> + argc);<\/span>\n+<span id=\"cb31-71\"><a href=\"#cb31-71\"><\/a>                var argv_seg = argv.<span class=\"fu\">asSegment<\/span>(C_POINTER.<span class=\"fu\">byteSize<\/span>() * argc, scope);<\/span>\n+<span id=\"cb31-72\"><a href=\"#cb31-72\"><\/a>                var columnNames_seg = columnNames.<span class=\"fu\">asSegment<\/span>(C_POINTER.<span class=\"fu\">byteSize<\/span>() * argc, scope);<\/span>\n+<span id=\"cb31-73\"><a href=\"#cb31-73\"><\/a>                <span class=\"kw\">for<\/span> (<span class=\"dt\">int<\/span> i = <span class=\"dv\">0<\/span>; i &lt; argc; i++) {<\/span>\n+<span id=\"cb31-74\"><a href=\"#cb31-74\"><\/a>                     <span class=\"bu\">String<\/span> name = <span class=\"fu\">toJavaString<\/span>(MemoryAccess.<span class=\"fu\">getAddressAtIndex<\/span>(columnNames_seg, i));<\/span>\n+<span id=\"cb31-75\"><a href=\"#cb31-75\"><\/a>                     <span class=\"bu\">String<\/span> value = <span class=\"fu\">toJavaString<\/span>(MemoryAccess.<span class=\"fu\">getAddressAtIndex<\/span>(argv_seg, i));<\/span>\n+<span id=\"cb31-76\"><a href=\"#cb31-76\"><\/a>                     <span class=\"bu\">System<\/span>.<span class=\"fu\">out.printf<\/span>(<span class=\"st\">&quot;<\/span><span class=\"sc\">%s<\/span><span class=\"st\"> = <\/span><span class=\"sc\">%s\\n<\/span><span class=\"st\">&quot;<\/span>, name, value);<\/span>\n+<span id=\"cb31-77\"><a href=\"#cb31-77\"><\/a>                }<\/span>\n+<span id=\"cb31-78\"><a href=\"#cb31-78\"><\/a>                <span class=\"kw\">return<\/span> <span class=\"dv\">0<\/span>;<\/span>\n+<span id=\"cb31-79\"><a href=\"#cb31-79\"><\/a>            }, scope);<\/span>\n+<span id=\"cb31-80\"><a href=\"#cb31-80\"><\/a><\/span>\n+<span id=\"cb31-81\"><a href=\"#cb31-81\"><\/a>            <span class=\"co\">\/\/ select query<\/span><\/span>\n+<span id=\"cb31-82\"><a href=\"#cb31-82\"><\/a>            sql = <span class=\"fu\">toCString<\/span>(<span class=\"st\">&quot;SELECT * FROM EMPLOYEE&quot;<\/span>, scope);<\/span>\n+<span id=\"cb31-83\"><a href=\"#cb31-83\"><\/a>            rc = <span class=\"fu\">sqlite3_exec<\/span>(dbPtr, sql, callback, NULL, errMsgPtrPtr);<\/span>\n+<span id=\"cb31-84\"><a href=\"#cb31-84\"><\/a><\/span>\n+<span id=\"cb31-85\"><a href=\"#cb31-85\"><\/a>            <span class=\"kw\">if<\/span> (rc != <span class=\"dv\">0<\/span>) {<\/span>\n+<span id=\"cb31-86\"><a href=\"#cb31-86\"><\/a>                <span class=\"bu\">System<\/span>.<span class=\"fu\">err<\/span>.<span class=\"fu\">println<\/span>(<span class=\"st\">&quot;sqlite3_exec failed: &quot;<\/span> + rc);<\/span>\n+<span id=\"cb31-87\"><a href=\"#cb31-87\"><\/a>                <span class=\"bu\">System<\/span>.<span class=\"fu\">err<\/span>.<span class=\"fu\">println<\/span>(<span class=\"st\">&quot;SQL error: &quot;<\/span> + <span class=\"fu\">toJavaString<\/span>(MemoryAccess.<span class=\"fu\">getAddress<\/span>(errMsgPtrPtr)));<\/span>\n+<span id=\"cb31-88\"><a href=\"#cb31-88\"><\/a>                <span class=\"fu\">sqlite3_free<\/span>(MemoryAccess.<span class=\"fu\">getAddress<\/span>(errMsgPtrPtr));<\/span>\n+<span id=\"cb31-89\"><a href=\"#cb31-89\"><\/a>            } <span class=\"kw\">else<\/span> {<\/span>\n+<span id=\"cb31-90\"><a href=\"#cb31-90\"><\/a>                <span class=\"bu\">System<\/span>.<span class=\"fu\">out<\/span>.<span class=\"fu\">println<\/span>(<span class=\"st\">&quot;done&quot;<\/span>);<\/span>\n+<span id=\"cb31-91\"><a href=\"#cb31-91\"><\/a>            }<\/span>\n+<span id=\"cb31-92\"><a href=\"#cb31-92\"><\/a><\/span>\n+<span id=\"cb31-93\"><a href=\"#cb31-93\"><\/a>            <span class=\"fu\">sqlite3_close<\/span>(dbPtr);<\/span>\n+<span id=\"cb31-94\"><a href=\"#cb31-94\"><\/a>        }<\/span>\n+<span id=\"cb31-95\"><a href=\"#cb31-95\"><\/a>    }<\/span>\n+<span id=\"cb31-96\"><a href=\"#cb31-96\"><\/a>}<\/span>\n+<span id=\"cb31-97\"><a href=\"#cb31-97\"><\/a><\/span><\/code><\/pre><\/div>\n@@ -655,4 +701,4 @@\n-<div class=\"sourceCode\" id=\"cb32\"><pre class=\"sourceCode sh\"><code class=\"sourceCode bash\"><a class=\"sourceLine\" id=\"cb32-1\" title=\"1\"><\/a>\n-<a class=\"sourceLine\" id=\"cb32-2\" title=\"2\"><span class=\"ex\">java<\/span> -Dforeign.restricted=permit \\<\/a>\n-<a class=\"sourceLine\" id=\"cb32-3\" title=\"3\">   --add-modules jdk.incubator.foreign \\<\/a>\n-<a class=\"sourceLine\" id=\"cb32-4\" title=\"4\">   -Djava.library.path=\/usr\/lib SqliteMain.java<\/a><\/code><\/pre><\/div>\n+<div class=\"sourceCode\" id=\"cb32\"><pre class=\"sourceCode sh\"><code class=\"sourceCode bash\"><span id=\"cb32-1\"><a href=\"#cb32-1\"><\/a><\/span>\n+<span id=\"cb32-2\"><a href=\"#cb32-2\"><\/a><span class=\"ex\">java<\/span> --enable-native-access=ALL-UNNAMED \\<\/span>\n+<span id=\"cb32-3\"><a href=\"#cb32-3\"><\/a>   --add-modules jdk.incubator.foreign \\<\/span>\n+<span id=\"cb32-4\"><a href=\"#cb32-4\"><\/a>   -Djava.library.path=\/usr\/lib SqliteMain.java<\/span><\/code><\/pre><\/div>\n@@ -661,5 +707,5 @@\n-<div class=\"sourceCode\" id=\"cb33\"><pre class=\"sourceCode sh\"><code class=\"sourceCode bash\"><a class=\"sourceLine\" id=\"cb33-1\" title=\"1\"><\/a>\n-<a class=\"sourceLine\" id=\"cb33-2\" title=\"2\"><span class=\"ex\">jextract<\/span> -t opengl -lGL -l\/System\/Library\/Frameworks\/GLUT.framework\/Versions\/Current\/GLUT \\<\/a>\n-<a class=\"sourceLine\" id=\"cb33-3\" title=\"3\">  -I \/Applications\/Xcode.app\/Contents\/Developer\/Platforms\/MacOSX.platform\/Developer\/SDKs\/MacOSX.sdk\/usr\/include\/ \\<\/a>\n-<a class=\"sourceLine\" id=\"cb33-4\" title=\"4\">  -C-F\/Applications\/Xcode.app\/Contents\/Developer\/Platforms\/MacOSX.platform\/Developer\/SDKs\/MacOSX.sdk\/System\/Library\/Frameworks \\<\/a>\n-<a class=\"sourceLine\" id=\"cb33-5\" title=\"5\">  \/Applications\/Xcode.app\/Contents\/Developer\/Platforms\/MacOSX.platform\/Developer\/SDKs\/MacOSX.sdk\/System\/Library\/Frameworks\/GLUT.framework\/Headers\/glut.h<\/a><\/code><\/pre><\/div>\n+<div class=\"sourceCode\" id=\"cb33\"><pre class=\"sourceCode sh\"><code class=\"sourceCode bash\"><span id=\"cb33-1\"><a href=\"#cb33-1\"><\/a><\/span>\n+<span id=\"cb33-2\"><a href=\"#cb33-2\"><\/a><span class=\"ex\">jextract<\/span> -t opengl -lGL -l\/System\/Library\/Frameworks\/GLUT.framework\/Versions\/Current\/GLUT \\<\/span>\n+<span id=\"cb33-3\"><a href=\"#cb33-3\"><\/a>  -I \/Applications\/Xcode.app\/Contents\/Developer\/Platforms\/MacOSX.platform\/Developer\/SDKs\/MacOSX.sdk\/usr\/include\/ \\<\/span>\n+<span id=\"cb33-4\"><a href=\"#cb33-4\"><\/a>  -C-F\/Applications\/Xcode.app\/Contents\/Developer\/Platforms\/MacOSX.platform\/Developer\/SDKs\/MacOSX.sdk\/System\/Library\/Frameworks \\<\/span>\n+<span id=\"cb33-5\"><a href=\"#cb33-5\"><\/a>  \/Applications\/Xcode.app\/Contents\/Developer\/Platforms\/MacOSX.platform\/Developer\/SDKs\/MacOSX.sdk\/System\/Library\/Frameworks\/GLUT.framework\/Headers\/glut.h<\/span><\/code><\/pre><\/div>\n@@ -667,58 +713,61 @@\n-<div class=\"sourceCode\" id=\"cb34\"><pre class=\"sourceCode java\"><code class=\"sourceCode java\"><a class=\"sourceLine\" id=\"cb34-1\" title=\"1\"><\/a>\n-<a class=\"sourceLine\" id=\"cb34-2\" title=\"2\"><span class=\"kw\">import<\/span><span class=\"im\"> jdk.incubator.foreign.CLinker;<\/span><\/a>\n-<a class=\"sourceLine\" id=\"cb34-3\" title=\"3\"><span class=\"kw\">import static<\/span><span class=\"im\"> jdk.incubator.foreign.CLinker.*;<\/span><\/a>\n-<a class=\"sourceLine\" id=\"cb34-4\" title=\"4\"><span class=\"kw\">import<\/span><span class=\"im\"> jdk.incubator.foreign.NativeScope;<\/span><\/a>\n-<a class=\"sourceLine\" id=\"cb34-5\" title=\"5\"><span class=\"kw\">import static<\/span><span class=\"im\"> opengl.glut_h.*;<\/span><\/a>\n-<a class=\"sourceLine\" id=\"cb34-6\" title=\"6\"><\/a>\n-<a class=\"sourceLine\" id=\"cb34-7\" title=\"7\"><span class=\"kw\">public<\/span> <span class=\"kw\">class<\/span> Teapot {<\/a>\n-<a class=\"sourceLine\" id=\"cb34-8\" title=\"8\">    <span class=\"kw\">private<\/span> <span class=\"dt\">float<\/span> rot = <span class=\"dv\">0<\/span>;<\/a>\n-<a class=\"sourceLine\" id=\"cb34-9\" title=\"9\"><\/a>\n-<a class=\"sourceLine\" id=\"cb34-10\" title=\"10\">    <span class=\"fu\">Teapot<\/span>(NativeScope scope) {<\/a>\n-<a class=\"sourceLine\" id=\"cb34-11\" title=\"11\">        <span class=\"co\">\/\/ Reset Background<\/span><\/a>\n-<a class=\"sourceLine\" id=\"cb34-12\" title=\"12\">        <span class=\"fu\">glClearColor<\/span>(<span class=\"fl\">0f<\/span>, <span class=\"fl\">0f<\/span>, <span class=\"fl\">0f<\/span>, <span class=\"fl\">0f<\/span>);<\/a>\n-<a class=\"sourceLine\" id=\"cb34-13\" title=\"13\">        <span class=\"co\">\/\/ Setup Lighting<\/span><\/a>\n-<a class=\"sourceLine\" id=\"cb34-14\" title=\"14\">        <span class=\"fu\">glShadeModel<\/span>(<span class=\"fu\">GL_SMOOTH<\/span>());<\/a>\n-<a class=\"sourceLine\" id=\"cb34-15\" title=\"15\">        var pos = scope.<span class=\"fu\">allocateArray<\/span>(C_FLOAT, <span class=\"kw\">new<\/span> <span class=\"dt\">float<\/span>[] {<span class=\"fl\">0.0f<\/span>, <span class=\"fl\">15.0f<\/span>, -<span class=\"fl\">15.0f<\/span>, <span class=\"dv\">0<\/span>});<\/a>\n-<a class=\"sourceLine\" id=\"cb34-16\" title=\"16\">        <span class=\"fu\">glLightfv<\/span>(<span class=\"fu\">GL_LIGHT0<\/span>(), <span class=\"fu\">GL_POSITION<\/span>(), pos);<\/a>\n-<a class=\"sourceLine\" id=\"cb34-17\" title=\"17\">        var spec = scope.<span class=\"fu\">allocateArray<\/span>(C_FLOAT, <span class=\"kw\">new<\/span> <span class=\"dt\">float<\/span>[] {<span class=\"dv\">1<\/span>, <span class=\"dv\">1<\/span>, <span class=\"dv\">1<\/span>, <span class=\"dv\">0<\/span>});<\/a>\n-<a class=\"sourceLine\" id=\"cb34-18\" title=\"18\">        <span class=\"fu\">glLightfv<\/span>(<span class=\"fu\">GL_LIGHT0<\/span>(), <span class=\"fu\">GL_AMBIENT<\/span>(), spec);<\/a>\n-<a class=\"sourceLine\" id=\"cb34-19\" title=\"19\">        <span class=\"fu\">glLightfv<\/span>(<span class=\"fu\">GL_LIGHT0<\/span>(), <span class=\"fu\">GL_DIFFUSE<\/span>(), spec);<\/a>\n-<a class=\"sourceLine\" id=\"cb34-20\" title=\"20\">        <span class=\"fu\">glLightfv<\/span>(<span class=\"fu\">GL_LIGHT0<\/span>(), <span class=\"fu\">GL_SPECULAR<\/span>(), spec);<\/a>\n-<a class=\"sourceLine\" id=\"cb34-21\" title=\"21\">        var shini = scope.<span class=\"fu\">allocate<\/span>(C_FLOAT, <span class=\"dv\">113<\/span>);<\/a>\n-<a class=\"sourceLine\" id=\"cb34-22\" title=\"22\">        <span class=\"fu\">glMaterialfv<\/span>(<span class=\"fu\">GL_FRONT<\/span>(), <span class=\"fu\">GL_SHININESS<\/span>(), shini);<\/a>\n-<a class=\"sourceLine\" id=\"cb34-23\" title=\"23\">        <span class=\"fu\">glEnable<\/span>(<span class=\"fu\">GL_LIGHTING<\/span>());<\/a>\n-<a class=\"sourceLine\" id=\"cb34-24\" title=\"24\">        <span class=\"fu\">glEnable<\/span>(<span class=\"fu\">GL_LIGHT0<\/span>());<\/a>\n-<a class=\"sourceLine\" id=\"cb34-25\" title=\"25\">        <span class=\"fu\">glEnable<\/span>(<span class=\"fu\">GL_DEPTH_TEST<\/span>());<\/a>\n-<a class=\"sourceLine\" id=\"cb34-26\" title=\"26\">    }<\/a>\n-<a class=\"sourceLine\" id=\"cb34-27\" title=\"27\"><\/a>\n-<a class=\"sourceLine\" id=\"cb34-28\" title=\"28\">    <span class=\"dt\">void<\/span> <span class=\"fu\">display<\/span>() {<\/a>\n-<a class=\"sourceLine\" id=\"cb34-29\" title=\"29\">        <span class=\"fu\">glClear<\/span>(<span class=\"fu\">GL_COLOR_BUFFER_BIT<\/span>() | <span class=\"fu\">GL_DEPTH_BUFFER_BIT<\/span>());<\/a>\n-<a class=\"sourceLine\" id=\"cb34-30\" title=\"30\">        <span class=\"fu\">glPushMatrix<\/span>();<\/a>\n-<a class=\"sourceLine\" id=\"cb34-31\" title=\"31\">        <span class=\"fu\">glRotatef<\/span>(-<span class=\"fl\">20f<\/span>, <span class=\"fl\">1f<\/span>, <span class=\"fl\">1f<\/span>, <span class=\"fl\">0f<\/span>);<\/a>\n-<a class=\"sourceLine\" id=\"cb34-32\" title=\"32\">        <span class=\"fu\">glRotatef<\/span>(rot, <span class=\"fl\">0f<\/span>, <span class=\"fl\">1f<\/span>, <span class=\"fl\">0f<\/span>);<\/a>\n-<a class=\"sourceLine\" id=\"cb34-33\" title=\"33\">        <span class=\"fu\">glutSolidTeapot<\/span>(<span class=\"fl\">0.5d<\/span>);<\/a>\n-<a class=\"sourceLine\" id=\"cb34-34\" title=\"34\">        <span class=\"fu\">glPopMatrix<\/span>();<\/a>\n-<a class=\"sourceLine\" id=\"cb34-35\" title=\"35\">        <span class=\"fu\">glutSwapBuffers<\/span>();<\/a>\n-<a class=\"sourceLine\" id=\"cb34-36\" title=\"36\">    }<\/a>\n-<a class=\"sourceLine\" id=\"cb34-37\" title=\"37\"><\/a>\n-<a class=\"sourceLine\" id=\"cb34-38\" title=\"38\">    <span class=\"dt\">void<\/span> <span class=\"fu\">onIdle<\/span>() {<\/a>\n-<a class=\"sourceLine\" id=\"cb34-39\" title=\"39\">        rot += <span class=\"fl\">0.<\/span><span class=\"dv\">1<\/span>;<\/a>\n-<a class=\"sourceLine\" id=\"cb34-40\" title=\"40\">        <span class=\"fu\">glutPostRedisplay<\/span>();<\/a>\n-<a class=\"sourceLine\" id=\"cb34-41\" title=\"41\">    }<\/a>\n-<a class=\"sourceLine\" id=\"cb34-42\" title=\"42\"><\/a>\n-<a class=\"sourceLine\" id=\"cb34-43\" title=\"43\">    <span class=\"kw\">public<\/span> <span class=\"dt\">static<\/span> <span class=\"dt\">void<\/span> <span class=\"fu\">main<\/span>(<span class=\"bu\">String<\/span>[] args) {<\/a>\n-<a class=\"sourceLine\" id=\"cb34-44\" title=\"44\">        <span class=\"kw\">try<\/span> (var scope = NativeScope.<span class=\"fu\">unboundedScope<\/span>()) {<\/a>\n-<a class=\"sourceLine\" id=\"cb34-45\" title=\"45\">            var argc = scope.<span class=\"fu\">allocate<\/span>(C_INT, <span class=\"dv\">0<\/span>);<\/a>\n-<a class=\"sourceLine\" id=\"cb34-46\" title=\"46\">            <span class=\"fu\">glutInit<\/span>(argc, argc);<\/a>\n-<a class=\"sourceLine\" id=\"cb34-47\" title=\"47\">            <span class=\"fu\">glutInitDisplayMode<\/span>(<span class=\"fu\">GLUT_DOUBLE<\/span>() | <span class=\"fu\">GLUT_RGB<\/span>() | <span class=\"fu\">GLUT_DEPTH<\/span>());<\/a>\n-<a class=\"sourceLine\" id=\"cb34-48\" title=\"48\">            <span class=\"fu\">glutInitWindowSize<\/span>(<span class=\"dv\">500<\/span>, <span class=\"dv\">500<\/span>);<\/a>\n-<a class=\"sourceLine\" id=\"cb34-49\" title=\"49\">            <span class=\"fu\">glutCreateWindow<\/span>(CLinker.<span class=\"fu\">toCString<\/span>(<span class=\"st\">&quot;Hello Panama!&quot;<\/span>, scope));<\/a>\n-<a class=\"sourceLine\" id=\"cb34-50\" title=\"50\">            var teapot = <span class=\"kw\">new<\/span> <span class=\"fu\">Teapot<\/span>(scope);<\/a>\n-<a class=\"sourceLine\" id=\"cb34-51\" title=\"51\">            var displayStub = glutDisplayFunc$func.<span class=\"fu\">allocate<\/span>(teapot::display, scope);<\/a>\n-<a class=\"sourceLine\" id=\"cb34-52\" title=\"52\">            var idleStub = glutIdleFunc$func.<span class=\"fu\">allocate<\/span>(teapot::onIdle, scope);<\/a>\n-<a class=\"sourceLine\" id=\"cb34-53\" title=\"53\">            <span class=\"fu\">glutDisplayFunc<\/span>(displayStub);<\/a>\n-<a class=\"sourceLine\" id=\"cb34-54\" title=\"54\">            <span class=\"fu\">glutIdleFunc<\/span>(idleStub);<\/a>\n-<a class=\"sourceLine\" id=\"cb34-55\" title=\"55\">            <span class=\"fu\">glutMainLoop<\/span>();<\/a>\n-<a class=\"sourceLine\" id=\"cb34-56\" title=\"56\">        }<\/a>\n-<a class=\"sourceLine\" id=\"cb34-57\" title=\"57\">    }<\/a>\n-<a class=\"sourceLine\" id=\"cb34-58\" title=\"58\">}<\/a><\/code><\/pre><\/div>\n+<div class=\"sourceCode\" id=\"cb34\"><pre class=\"sourceCode java\"><code class=\"sourceCode java\"><span id=\"cb34-1\"><a href=\"#cb34-1\"><\/a><\/span>\n+<span id=\"cb34-2\"><a href=\"#cb34-2\"><\/a><span class=\"kw\">import<\/span><span class=\"im\"> jdk.incubator.foreign.CLinker;<\/span><\/span>\n+<span id=\"cb34-3\"><a href=\"#cb34-3\"><\/a><span class=\"kw\">import<\/span><span class=\"im\"> jdk.incubator.foreign.ResourceScope;<\/span><\/span>\n+<span id=\"cb34-4\"><a href=\"#cb34-4\"><\/a><span class=\"kw\">import<\/span><span class=\"im\"> jdk.incubator.foreign.SegmentAllocator;<\/span><\/span>\n+<span id=\"cb34-5\"><a href=\"#cb34-5\"><\/a><span class=\"kw\">import<\/span><span class=\"im\"> opengl.*;<\/span><\/span>\n+<span id=\"cb34-6\"><a href=\"#cb34-6\"><\/a><span class=\"kw\">import static<\/span><span class=\"im\"> jdk.incubator.foreign.CLinker.*;<\/span><\/span>\n+<span id=\"cb34-7\"><a href=\"#cb34-7\"><\/a><span class=\"kw\">import static<\/span><span class=\"im\"> opengl.glut_h.*;<\/span><\/span>\n+<span id=\"cb34-8\"><a href=\"#cb34-8\"><\/a><\/span>\n+<span id=\"cb34-9\"><a href=\"#cb34-9\"><\/a><span class=\"kw\">public<\/span> <span class=\"kw\">class<\/span> Teapot {<\/span>\n+<span id=\"cb34-10\"><a href=\"#cb34-10\"><\/a>    <span class=\"kw\">private<\/span> <span class=\"dt\">float<\/span> rot = <span class=\"dv\">0<\/span>;<\/span>\n+<span id=\"cb34-11\"><a href=\"#cb34-11\"><\/a><\/span>\n+<span id=\"cb34-12\"><a href=\"#cb34-12\"><\/a>    <span class=\"fu\">Teapot<\/span>(SegmentAllocator allocator) {<\/span>\n+<span id=\"cb34-13\"><a href=\"#cb34-13\"><\/a>        <span class=\"co\">\/\/ Reset Background<\/span><\/span>\n+<span id=\"cb34-14\"><a href=\"#cb34-14\"><\/a>        <span class=\"fu\">glClearColor<\/span>(<span class=\"fl\">0f<\/span>, <span class=\"fl\">0f<\/span>, <span class=\"fl\">0f<\/span>, <span class=\"fl\">0f<\/span>);<\/span>\n+<span id=\"cb34-15\"><a href=\"#cb34-15\"><\/a>        <span class=\"co\">\/\/ Setup Lighting<\/span><\/span>\n+<span id=\"cb34-16\"><a href=\"#cb34-16\"><\/a>        <span class=\"fu\">glShadeModel<\/span>(<span class=\"fu\">GL_SMOOTH<\/span>());<\/span>\n+<span id=\"cb34-17\"><a href=\"#cb34-17\"><\/a>        var pos = allocator.<span class=\"fu\">allocateArray<\/span>(C_FLOAT, <span class=\"kw\">new<\/span> <span class=\"dt\">float<\/span>[] {<span class=\"fl\">0.0f<\/span>, <span class=\"fl\">15.0f<\/span>, -<span class=\"fl\">15.0f<\/span>, <span class=\"dv\">0<\/span>});<\/span>\n+<span id=\"cb34-18\"><a href=\"#cb34-18\"><\/a>        <span class=\"fu\">glLightfv<\/span>(<span class=\"fu\">GL_LIGHT0<\/span>(), <span class=\"fu\">GL_POSITION<\/span>(), pos);<\/span>\n+<span id=\"cb34-19\"><a href=\"#cb34-19\"><\/a>        var spec = allocator.<span class=\"fu\">allocateArray<\/span>(C_FLOAT, <span class=\"kw\">new<\/span> <span class=\"dt\">float<\/span>[] {<span class=\"dv\">1<\/span>, <span class=\"dv\">1<\/span>, <span class=\"dv\">1<\/span>, <span class=\"dv\">0<\/span>});<\/span>\n+<span id=\"cb34-20\"><a href=\"#cb34-20\"><\/a>        <span class=\"fu\">glLightfv<\/span>(<span class=\"fu\">GL_LIGHT0<\/span>(), <span class=\"fu\">GL_AMBIENT<\/span>(), spec);<\/span>\n+<span id=\"cb34-21\"><a href=\"#cb34-21\"><\/a>        <span class=\"fu\">glLightfv<\/span>(<span class=\"fu\">GL_LIGHT0<\/span>(), <span class=\"fu\">GL_DIFFUSE<\/span>(), spec);<\/span>\n+<span id=\"cb34-22\"><a href=\"#cb34-22\"><\/a>        <span class=\"fu\">glLightfv<\/span>(<span class=\"fu\">GL_LIGHT0<\/span>(), <span class=\"fu\">GL_SPECULAR<\/span>(), spec);<\/span>\n+<span id=\"cb34-23\"><a href=\"#cb34-23\"><\/a>        var shini = allocator.<span class=\"fu\">allocate<\/span>(C_FLOAT, <span class=\"dv\">113<\/span>);<\/span>\n+<span id=\"cb34-24\"><a href=\"#cb34-24\"><\/a>        <span class=\"fu\">glMaterialfv<\/span>(<span class=\"fu\">GL_FRONT<\/span>(), <span class=\"fu\">GL_SHININESS<\/span>(), shini);<\/span>\n+<span id=\"cb34-25\"><a href=\"#cb34-25\"><\/a>        <span class=\"fu\">glEnable<\/span>(<span class=\"fu\">GL_LIGHTING<\/span>());<\/span>\n+<span id=\"cb34-26\"><a href=\"#cb34-26\"><\/a>        <span class=\"fu\">glEnable<\/span>(<span class=\"fu\">GL_LIGHT0<\/span>());<\/span>\n+<span id=\"cb34-27\"><a href=\"#cb34-27\"><\/a>        <span class=\"fu\">glEnable<\/span>(<span class=\"fu\">GL_DEPTH_TEST<\/span>());<\/span>\n+<span id=\"cb34-28\"><a href=\"#cb34-28\"><\/a>    }<\/span>\n+<span id=\"cb34-29\"><a href=\"#cb34-29\"><\/a><\/span>\n+<span id=\"cb34-30\"><a href=\"#cb34-30\"><\/a>    <span class=\"dt\">void<\/span> <span class=\"fu\">display<\/span>() {<\/span>\n+<span id=\"cb34-31\"><a href=\"#cb34-31\"><\/a>        <span class=\"fu\">glClear<\/span>(<span class=\"fu\">GL_COLOR_BUFFER_BIT<\/span>() | <span class=\"fu\">GL_DEPTH_BUFFER_BIT<\/span>());<\/span>\n+<span id=\"cb34-32\"><a href=\"#cb34-32\"><\/a>        <span class=\"fu\">glPushMatrix<\/span>();<\/span>\n+<span id=\"cb34-33\"><a href=\"#cb34-33\"><\/a>        <span class=\"fu\">glRotatef<\/span>(-<span class=\"fl\">20f<\/span>, <span class=\"fl\">1f<\/span>, <span class=\"fl\">1f<\/span>, <span class=\"fl\">0f<\/span>);<\/span>\n+<span id=\"cb34-34\"><a href=\"#cb34-34\"><\/a>        <span class=\"fu\">glRotatef<\/span>(rot, <span class=\"fl\">0f<\/span>, <span class=\"fl\">1f<\/span>, <span class=\"fl\">0f<\/span>);<\/span>\n+<span id=\"cb34-35\"><a href=\"#cb34-35\"><\/a>        <span class=\"fu\">glutSolidTeapot<\/span>(<span class=\"fl\">0.5d<\/span>);<\/span>\n+<span id=\"cb34-36\"><a href=\"#cb34-36\"><\/a>        <span class=\"fu\">glPopMatrix<\/span>();<\/span>\n+<span id=\"cb34-37\"><a href=\"#cb34-37\"><\/a>        <span class=\"fu\">glutSwapBuffers<\/span>();<\/span>\n+<span id=\"cb34-38\"><a href=\"#cb34-38\"><\/a>    }<\/span>\n+<span id=\"cb34-39\"><a href=\"#cb34-39\"><\/a><\/span>\n+<span id=\"cb34-40\"><a href=\"#cb34-40\"><\/a>    <span class=\"dt\">void<\/span> <span class=\"fu\">onIdle<\/span>() {<\/span>\n+<span id=\"cb34-41\"><a href=\"#cb34-41\"><\/a>        rot += <span class=\"fl\">0.<\/span><span class=\"dv\">1<\/span>;<\/span>\n+<span id=\"cb34-42\"><a href=\"#cb34-42\"><\/a>        <span class=\"fu\">glutPostRedisplay<\/span>();<\/span>\n+<span id=\"cb34-43\"><a href=\"#cb34-43\"><\/a>    }<\/span>\n+<span id=\"cb34-44\"><a href=\"#cb34-44\"><\/a><\/span>\n+<span id=\"cb34-45\"><a href=\"#cb34-45\"><\/a>    <span class=\"kw\">public<\/span> <span class=\"dt\">static<\/span> <span class=\"dt\">void<\/span> <span class=\"fu\">main<\/span>(<span class=\"bu\">String<\/span>[] args) {<\/span>\n+<span id=\"cb34-46\"><a href=\"#cb34-46\"><\/a>        <span class=\"kw\">try<\/span> (var scope = ResourceScope.<span class=\"fu\">newConfinedScope<\/span>()) {<\/span>\n+<span id=\"cb34-47\"><a href=\"#cb34-47\"><\/a>            var allocator = SegmentAllocator.<span class=\"fu\">ofScope<\/span>(scope);<\/span>\n+<span id=\"cb34-48\"><a href=\"#cb34-48\"><\/a>            var argc = allocator.<span class=\"fu\">allocate<\/span>(C_INT, <span class=\"dv\">0<\/span>);<\/span>\n+<span id=\"cb34-49\"><a href=\"#cb34-49\"><\/a>            <span class=\"fu\">glutInit<\/span>(argc, argc);<\/span>\n+<span id=\"cb34-50\"><a href=\"#cb34-50\"><\/a>            <span class=\"fu\">glutInitDisplayMode<\/span>(<span class=\"fu\">GLUT_DOUBLE<\/span>() | <span class=\"fu\">GLUT_RGB<\/span>() | <span class=\"fu\">GLUT_DEPTH<\/span>());<\/span>\n+<span id=\"cb34-51\"><a href=\"#cb34-51\"><\/a>            <span class=\"fu\">glutInitWindowSize<\/span>(<span class=\"dv\">500<\/span>, <span class=\"dv\">500<\/span>);<\/span>\n+<span id=\"cb34-52\"><a href=\"#cb34-52\"><\/a>            <span class=\"fu\">glutCreateWindow<\/span>(CLinker.<span class=\"fu\">toCString<\/span>(<span class=\"st\">&quot;Hello Panama!&quot;<\/span>, scope));<\/span>\n+<span id=\"cb34-53\"><a href=\"#cb34-53\"><\/a>            var teapot = <span class=\"kw\">new<\/span> <span class=\"fu\">Teapot<\/span>(allocator);<\/span>\n+<span id=\"cb34-54\"><a href=\"#cb34-54\"><\/a>            var displayStub = glutDisplayFunc$func.<span class=\"fu\">allocate<\/span>(teapot::display, scope);<\/span>\n+<span id=\"cb34-55\"><a href=\"#cb34-55\"><\/a>            var idleStub = glutIdleFunc$func.<span class=\"fu\">allocate<\/span>(teapot::onIdle, scope);<\/span>\n+<span id=\"cb34-56\"><a href=\"#cb34-56\"><\/a>            <span class=\"fu\">glutDisplayFunc<\/span>(displayStub);<\/span>\n+<span id=\"cb34-57\"><a href=\"#cb34-57\"><\/a>            <span class=\"fu\">glutIdleFunc<\/span>(idleStub);<\/span>\n+<span id=\"cb34-58\"><a href=\"#cb34-58\"><\/a>            <span class=\"fu\">glutMainLoop<\/span>();<\/span>\n+<span id=\"cb34-59\"><a href=\"#cb34-59\"><\/a>        }<\/span>\n+<span id=\"cb34-60\"><a href=\"#cb34-60\"><\/a>    }<\/span>\n+<span id=\"cb34-61\"><a href=\"#cb34-61\"><\/a>}<\/span><\/code><\/pre><\/div>\n@@ -726,3 +775,3 @@\n-<div class=\"sourceCode\" id=\"cb35\"><pre class=\"sourceCode sh\"><code class=\"sourceCode bash\"><a class=\"sourceLine\" id=\"cb35-1\" title=\"1\"><\/a>\n-<a class=\"sourceLine\" id=\"cb35-2\" title=\"2\"><span class=\"ex\">java<\/span> -XstartOnFirstThread -Dforeign.restricted=permit --add-modules jdk.incubator.foreign \\<\/a>\n-<a class=\"sourceLine\" id=\"cb35-3\" title=\"3\">    -Djava.library.path=.:\/System\/Library\/Frameworks\/OpenGL.framework\/Versions\/Current\/Libraries\/ Teapot.java <span class=\"va\">$*<\/span><\/a><\/code><\/pre><\/div>\n+<div class=\"sourceCode\" id=\"cb35\"><pre class=\"sourceCode sh\"><code class=\"sourceCode bash\"><span id=\"cb35-1\"><a href=\"#cb35-1\"><\/a><\/span>\n+<span id=\"cb35-2\"><a href=\"#cb35-2\"><\/a><span class=\"ex\">java<\/span> -XstartOnFirstThread --enable-native-access=ALL-UNNAMED --add-modules jdk.incubator.foreign \\<\/span>\n+<span id=\"cb35-3\"><a href=\"#cb35-3\"><\/a>    -Djava.library.path=.:\/System\/Library\/Frameworks\/OpenGL.framework\/Versions\/Current\/Libraries\/ Teapot.java <span class=\"va\">$*<\/span><\/span><\/code><\/pre><\/div>\n@@ -737,9 +786,9 @@\n-<div class=\"sourceCode\" id=\"cb36\"><pre class=\"sourceCode sh\"><code class=\"sourceCode bash\"><a class=\"sourceLine\" id=\"cb36-1\" title=\"1\"><\/a>\n-<a class=\"sourceLine\" id=\"cb36-2\" title=\"2\"><span class=\"ex\">jextract<\/span> --source \\<\/a>\n-<a class=\"sourceLine\" id=\"cb36-3\" title=\"3\">  -I \/Applications\/Xcode.app\/Contents\/Developer\/Platforms\/MacOSX.platform\/Developer\/SDKs\/MacOSX.sdk\/usr\/include\/ \\<\/a>\n-<a class=\"sourceLine\" id=\"cb36-4\" title=\"4\">  -t org.tensorflow \\<\/a>\n-<a class=\"sourceLine\" id=\"cb36-5\" title=\"5\">  -I <span class=\"va\">${LIBTENSORFLOW_HOME}<\/span>\/include \\<\/a>\n-<a class=\"sourceLine\" id=\"cb36-6\" title=\"6\">  -l <span class=\"va\">${LIBTENSORFLOW_HOME}<\/span>\/lib\/libtensorflow.dylib \\<\/a>\n-<a class=\"sourceLine\" id=\"cb36-7\" title=\"7\">  <span class=\"va\">${LIBTENSORFLOW_HOME}<\/span>\/include\/tensorflow\/c\/c_api.h<\/a>\n-<a class=\"sourceLine\" id=\"cb36-8\" title=\"8\"><\/a>\n-<a class=\"sourceLine\" id=\"cb36-9\" title=\"9\"><span class=\"ex\">javac<\/span> --add-modules jdk.incubator.foreign org\/tensorflow\/*.java<\/a><\/code><\/pre><\/div>\n+<div class=\"sourceCode\" id=\"cb36\"><pre class=\"sourceCode sh\"><code class=\"sourceCode bash\"><span id=\"cb36-1\"><a href=\"#cb36-1\"><\/a><\/span>\n+<span id=\"cb36-2\"><a href=\"#cb36-2\"><\/a><span class=\"ex\">jextract<\/span> --source \\<\/span>\n+<span id=\"cb36-3\"><a href=\"#cb36-3\"><\/a>  -I \/Applications\/Xcode.app\/Contents\/Developer\/Platforms\/MacOSX.platform\/Developer\/SDKs\/MacOSX.sdk\/usr\/include\/ \\<\/span>\n+<span id=\"cb36-4\"><a href=\"#cb36-4\"><\/a>  -t org.tensorflow \\<\/span>\n+<span id=\"cb36-5\"><a href=\"#cb36-5\"><\/a>  -I <span class=\"va\">${LIBTENSORFLOW_HOME}<\/span>\/include \\<\/span>\n+<span id=\"cb36-6\"><a href=\"#cb36-6\"><\/a>  -l <span class=\"va\">${LIBTENSORFLOW_HOME}<\/span>\/lib\/libtensorflow.dylib \\<\/span>\n+<span id=\"cb36-7\"><a href=\"#cb36-7\"><\/a>  <span class=\"va\">${LIBTENSORFLOW_HOME}<\/span>\/include\/tensorflow\/c\/c_api.h<\/span>\n+<span id=\"cb36-8\"><a href=\"#cb36-8\"><\/a><\/span>\n+<span id=\"cb36-9\"><a href=\"#cb36-9\"><\/a><span class=\"ex\">javac<\/span> --add-modules jdk.incubator.foreign org\/tensorflow\/*.java<\/span><\/code><\/pre><\/div>\n@@ -749,32 +798,32 @@\n-<div class=\"sourceCode\" id=\"cb37\"><pre class=\"sourceCode python\"><code class=\"sourceCode python\"><a class=\"sourceLine\" id=\"cb37-1\" title=\"1\"><\/a>\n-<a class=\"sourceLine\" id=\"cb37-2\" title=\"2\"><span class=\"im\">import<\/span> tensorflow <span class=\"im\">as<\/span> tf<\/a>\n-<a class=\"sourceLine\" id=\"cb37-3\" title=\"3\"><span class=\"im\">from<\/span> tensorflow.keras <span class=\"im\">import<\/span> models, layers<\/a>\n-<a class=\"sourceLine\" id=\"cb37-4\" title=\"4\"><span class=\"im\">from<\/span> tensorflow.keras.datasets <span class=\"im\">import<\/span> mnist<\/a>\n-<a class=\"sourceLine\" id=\"cb37-5\" title=\"5\"><\/a>\n-<a class=\"sourceLine\" id=\"cb37-6\" title=\"6\">model <span class=\"op\">=<\/span> tf.keras.models.Sequential([<\/a>\n-<a class=\"sourceLine\" id=\"cb37-7\" title=\"7\">  tf.keras.layers.Flatten(input_shape<span class=\"op\">=<\/span>(<span class=\"dv\">28<\/span>, <span class=\"dv\">28<\/span>)),<\/a>\n-<a class=\"sourceLine\" id=\"cb37-8\" title=\"8\">  tf.keras.layers.Dense(<span class=\"dv\">128<\/span>,activation<span class=\"op\">=<\/span><span class=\"st\">&#39;relu&#39;<\/span>),<\/a>\n-<a class=\"sourceLine\" id=\"cb37-9\" title=\"9\">  tf.keras.layers.Dense(<span class=\"dv\">10<\/span>, activation<span class=\"op\">=<\/span><span class=\"st\">&#39;softmax&#39;<\/span>)<\/a>\n-<a class=\"sourceLine\" id=\"cb37-10\" title=\"10\">])<\/a>\n-<a class=\"sourceLine\" id=\"cb37-11\" title=\"11\"><\/a>\n-<a class=\"sourceLine\" id=\"cb37-12\" title=\"12\">model.<span class=\"bu\">compile<\/span>(<\/a>\n-<a class=\"sourceLine\" id=\"cb37-13\" title=\"13\">    loss<span class=\"op\">=<\/span><span class=\"st\">&#39;sparse_categorical_crossentropy&#39;<\/span>,<\/a>\n-<a class=\"sourceLine\" id=\"cb37-14\" title=\"14\">    optimizer<span class=\"op\">=<\/span>tf.keras.optimizers.Adam(<span class=\"fl\">0.001<\/span>),<\/a>\n-<a class=\"sourceLine\" id=\"cb37-15\" title=\"15\">    metrics<span class=\"op\">=<\/span>[<span class=\"st\">&#39;accuracy&#39;<\/span>],<\/a>\n-<a class=\"sourceLine\" id=\"cb37-16\" title=\"16\">)<\/a>\n-<a class=\"sourceLine\" id=\"cb37-17\" title=\"17\"><\/a>\n-<a class=\"sourceLine\" id=\"cb37-18\" title=\"18\"><span class=\"bu\">print<\/span>(model.summary())<\/a>\n-<a class=\"sourceLine\" id=\"cb37-19\" title=\"19\"><\/a>\n-<a class=\"sourceLine\" id=\"cb37-20\" title=\"20\">(train_images, train_labels), (test_images, test_labels) <span class=\"op\">=<\/span> mnist.load_data()<\/a>\n-<a class=\"sourceLine\" id=\"cb37-21\" title=\"21\"><\/a>\n-<a class=\"sourceLine\" id=\"cb37-22\" title=\"22\">train_images <span class=\"op\">=<\/span> train_images<span class=\"op\">\/<\/span><span class=\"fl\">255.0<\/span><\/a>\n-<a class=\"sourceLine\" id=\"cb37-23\" title=\"23\">test_images <span class=\"op\">=<\/span> test_images<span class=\"op\">\/<\/span><span class=\"fl\">255.0<\/span><\/a>\n-<a class=\"sourceLine\" id=\"cb37-24\" title=\"24\"><\/a>\n-<a class=\"sourceLine\" id=\"cb37-25\" title=\"25\">model.fit(train_images, train_labels,<\/a>\n-<a class=\"sourceLine\" id=\"cb37-26\" title=\"26\">    epochs<span class=\"op\">=<\/span><span class=\"dv\">4<\/span>, batch_size<span class=\"op\">=<\/span><span class=\"dv\">128<\/span>, verbose<span class=\"op\">=<\/span><span class=\"dv\">1<\/span>)<\/a>\n-<a class=\"sourceLine\" id=\"cb37-27\" title=\"27\"><\/a>\n-<a class=\"sourceLine\" id=\"cb37-28\" title=\"28\">test_loss, test_accuracy <span class=\"op\">=<\/span> model.evaluate(test_images, test_labels)<\/a>\n-<a class=\"sourceLine\" id=\"cb37-29\" title=\"29\"><\/a>\n-<a class=\"sourceLine\" id=\"cb37-30\" title=\"30\"><span class=\"bu\">print<\/span>(test_loss, test_accuracy)<\/a>\n-<a class=\"sourceLine\" id=\"cb37-31\" title=\"31\"><\/a>\n-<a class=\"sourceLine\" id=\"cb37-32\" title=\"32\">model.save(<span class=\"st\">&quot;saved_mnist_model&quot;<\/span>)<\/a><\/code><\/pre><\/div>\n+<div class=\"sourceCode\" id=\"cb37\"><pre class=\"sourceCode python\"><code class=\"sourceCode python\"><span id=\"cb37-1\"><a href=\"#cb37-1\"><\/a><\/span>\n+<span id=\"cb37-2\"><a href=\"#cb37-2\"><\/a><span class=\"im\">import<\/span> tensorflow <span class=\"im\">as<\/span> tf<\/span>\n+<span id=\"cb37-3\"><a href=\"#cb37-3\"><\/a><span class=\"im\">from<\/span> tensorflow.keras <span class=\"im\">import<\/span> models, layers<\/span>\n+<span id=\"cb37-4\"><a href=\"#cb37-4\"><\/a><span class=\"im\">from<\/span> tensorflow.keras.datasets <span class=\"im\">import<\/span> mnist<\/span>\n+<span id=\"cb37-5\"><a href=\"#cb37-5\"><\/a><\/span>\n+<span id=\"cb37-6\"><a href=\"#cb37-6\"><\/a>model <span class=\"op\">=<\/span> tf.keras.models.Sequential([<\/span>\n+<span id=\"cb37-7\"><a href=\"#cb37-7\"><\/a>  tf.keras.layers.Flatten(input_shape<span class=\"op\">=<\/span>(<span class=\"dv\">28<\/span>, <span class=\"dv\">28<\/span>)),<\/span>\n+<span id=\"cb37-8\"><a href=\"#cb37-8\"><\/a>  tf.keras.layers.Dense(<span class=\"dv\">128<\/span>,activation<span class=\"op\">=<\/span><span class=\"st\">&#39;relu&#39;<\/span>),<\/span>\n+<span id=\"cb37-9\"><a href=\"#cb37-9\"><\/a>  tf.keras.layers.Dense(<span class=\"dv\">10<\/span>, activation<span class=\"op\">=<\/span><span class=\"st\">&#39;softmax&#39;<\/span>)<\/span>\n+<span id=\"cb37-10\"><a href=\"#cb37-10\"><\/a>])<\/span>\n+<span id=\"cb37-11\"><a href=\"#cb37-11\"><\/a><\/span>\n+<span id=\"cb37-12\"><a href=\"#cb37-12\"><\/a>model.<span class=\"bu\">compile<\/span>(<\/span>\n+<span id=\"cb37-13\"><a href=\"#cb37-13\"><\/a>    loss<span class=\"op\">=<\/span><span class=\"st\">&#39;sparse_categorical_crossentropy&#39;<\/span>,<\/span>\n+<span id=\"cb37-14\"><a href=\"#cb37-14\"><\/a>    optimizer<span class=\"op\">=<\/span>tf.keras.optimizers.Adam(<span class=\"fl\">0.001<\/span>),<\/span>\n+<span id=\"cb37-15\"><a href=\"#cb37-15\"><\/a>    metrics<span class=\"op\">=<\/span>[<span class=\"st\">&#39;accuracy&#39;<\/span>],<\/span>\n+<span id=\"cb37-16\"><a href=\"#cb37-16\"><\/a>)<\/span>\n+<span id=\"cb37-17\"><a href=\"#cb37-17\"><\/a><\/span>\n+<span id=\"cb37-18\"><a href=\"#cb37-18\"><\/a><span class=\"bu\">print<\/span>(model.summary())<\/span>\n+<span id=\"cb37-19\"><a href=\"#cb37-19\"><\/a><\/span>\n+<span id=\"cb37-20\"><a href=\"#cb37-20\"><\/a>(train_images, train_labels), (test_images, test_labels) <span class=\"op\">=<\/span> mnist.load_data()<\/span>\n+<span id=\"cb37-21\"><a href=\"#cb37-21\"><\/a><\/span>\n+<span id=\"cb37-22\"><a href=\"#cb37-22\"><\/a>train_images <span class=\"op\">=<\/span> train_images<span class=\"op\">\/<\/span><span class=\"fl\">255.0<\/span><\/span>\n+<span id=\"cb37-23\"><a href=\"#cb37-23\"><\/a>test_images <span class=\"op\">=<\/span> test_images<span class=\"op\">\/<\/span><span class=\"fl\">255.0<\/span><\/span>\n+<span id=\"cb37-24\"><a href=\"#cb37-24\"><\/a><\/span>\n+<span id=\"cb37-25\"><a href=\"#cb37-25\"><\/a>model.fit(train_images, train_labels,<\/span>\n+<span id=\"cb37-26\"><a href=\"#cb37-26\"><\/a>    epochs<span class=\"op\">=<\/span><span class=\"dv\">4<\/span>, batch_size<span class=\"op\">=<\/span><span class=\"dv\">128<\/span>, verbose<span class=\"op\">=<\/span><span class=\"dv\">1<\/span>)<\/span>\n+<span id=\"cb37-27\"><a href=\"#cb37-27\"><\/a><\/span>\n+<span id=\"cb37-28\"><a href=\"#cb37-28\"><\/a>test_loss, test_accuracy <span class=\"op\">=<\/span> model.evaluate(test_images, test_labels)<\/span>\n+<span id=\"cb37-29\"><a href=\"#cb37-29\"><\/a><\/span>\n+<span id=\"cb37-30\"><a href=\"#cb37-30\"><\/a><span class=\"bu\">print<\/span>(test_loss, test_accuracy)<\/span>\n+<span id=\"cb37-31\"><a href=\"#cb37-31\"><\/a><\/span>\n+<span id=\"cb37-32\"><a href=\"#cb37-32\"><\/a>model.save(<span class=\"st\">&quot;saved_mnist_model&quot;<\/span>)<\/span><\/code><\/pre><\/div>\n@@ -782,50 +831,52 @@\n-<div class=\"sourceCode\" id=\"cb38\"><pre class=\"sourceCode java\"><code class=\"sourceCode java\"><a class=\"sourceLine\" id=\"cb38-1\" title=\"1\"><\/a>\n-<a class=\"sourceLine\" id=\"cb38-2\" title=\"2\"><span class=\"kw\">import<\/span><span class=\"im\"> jdk.incubator.foreign.*;<\/span><\/a>\n-<a class=\"sourceLine\" id=\"cb38-3\" title=\"3\"><span class=\"kw\">import static<\/span><span class=\"im\"> jdk.incubator.foreign.CLinker.*;<\/span><\/a>\n-<a class=\"sourceLine\" id=\"cb38-4\" title=\"4\"><span class=\"kw\">import static<\/span><span class=\"im\"> jdk.incubator.foreign.MemoryAccess.*;<\/span><\/a>\n-<a class=\"sourceLine\" id=\"cb38-5\" title=\"5\"><span class=\"kw\">import static<\/span><span class=\"im\"> jdk.incubator.foreign.MemoryAddress.*;<\/span><\/a>\n-<a class=\"sourceLine\" id=\"cb38-6\" title=\"6\"><span class=\"kw\">import static<\/span><span class=\"im\"> org.tensorflow.c_api_h.*;<\/span><\/a>\n-<a class=\"sourceLine\" id=\"cb38-7\" title=\"7\"><\/a>\n-<a class=\"sourceLine\" id=\"cb38-8\" title=\"8\"><span class=\"co\">\/\/ simple program that loads saved model and prints basic info on operations in it<\/span><\/a>\n-<a class=\"sourceLine\" id=\"cb38-9\" title=\"9\"><\/a>\n-<a class=\"sourceLine\" id=\"cb38-10\" title=\"10\"><span class=\"kw\">public<\/span> <span class=\"kw\">class<\/span> TensorflowLoadSavedModel {<\/a>\n-<a class=\"sourceLine\" id=\"cb38-11\" title=\"11\">    <span class=\"kw\">public<\/span> <span class=\"dt\">static<\/span> <span class=\"dt\">void<\/span> <span class=\"fu\">main<\/span>(<span class=\"bu\">String<\/span><span class=\"kw\">... <\/span>args) <span class=\"kw\">throws<\/span> <span class=\"bu\">Exception<\/span> {<\/a>\n-<a class=\"sourceLine\" id=\"cb38-12\" title=\"12\">        <span class=\"bu\">System<\/span>.<span class=\"fu\">out<\/span>.<span class=\"fu\">println<\/span>(<span class=\"st\">&quot;TensorFlow C library version: &quot;<\/span> + <span class=\"fu\">toJavaStringRestricted<\/span>(<span class=\"fu\">TF_Version<\/span>()));<\/a>\n-<a class=\"sourceLine\" id=\"cb38-13\" title=\"13\"><\/a>\n-<a class=\"sourceLine\" id=\"cb38-14\" title=\"14\">        <span class=\"kw\">if<\/span> (args.<span class=\"fu\">length<\/span> == <span class=\"dv\">0<\/span>) {<\/a>\n-<a class=\"sourceLine\" id=\"cb38-15\" title=\"15\">            <span class=\"bu\">System<\/span>.<span class=\"fu\">err<\/span>.<span class=\"fu\">println<\/span>(<span class=\"st\">&quot;java TensorflowLoadSavedModel &lt;saved model dir&gt;&quot;<\/span>);<\/a>\n-<a class=\"sourceLine\" id=\"cb38-16\" title=\"16\">            <span class=\"bu\">System<\/span>.<span class=\"fu\">exit<\/span>(<span class=\"dv\">1<\/span>);<\/a>\n-<a class=\"sourceLine\" id=\"cb38-17\" title=\"17\">        }<\/a>\n-<a class=\"sourceLine\" id=\"cb38-18\" title=\"18\"><\/a>\n-<a class=\"sourceLine\" id=\"cb38-19\" title=\"19\">        <span class=\"kw\">try<\/span> (var scope = NativeScope.<span class=\"fu\">unboundedScope<\/span>()) {<\/a>\n-<a class=\"sourceLine\" id=\"cb38-20\" title=\"20\">            var graph = <span class=\"fu\">TF_NewGraph<\/span>();<\/a>\n-<a class=\"sourceLine\" id=\"cb38-21\" title=\"21\">            var status = <span class=\"fu\">TF_NewStatus<\/span>();<\/a>\n-<a class=\"sourceLine\" id=\"cb38-22\" title=\"22\">            var sessionOpts = <span class=\"fu\">TF_NewSessionOptions<\/span>();<\/a>\n-<a class=\"sourceLine\" id=\"cb38-23\" title=\"23\"><\/a>\n-<a class=\"sourceLine\" id=\"cb38-24\" title=\"24\">            var savedModelDir = <span class=\"fu\">toCString<\/span>(args[<span class=\"dv\">0<\/span>], scope);<\/a>\n-<a class=\"sourceLine\" id=\"cb38-25\" title=\"25\">            var tags = scope.<span class=\"fu\">allocate<\/span>(C_POINTER, <span class=\"fu\">toCString<\/span>(<span class=\"st\">&quot;serve&quot;<\/span>, scope));<\/a>\n-<a class=\"sourceLine\" id=\"cb38-26\" title=\"26\">            var session = <span class=\"fu\">TF_LoadSessionFromSavedModel<\/span>(sessionOpts, NULL, savedModelDir, tags, <span class=\"dv\">1<\/span>, graph, NULL, status);<\/a>\n-<a class=\"sourceLine\" id=\"cb38-27\" title=\"27\"><\/a>\n-<a class=\"sourceLine\" id=\"cb38-28\" title=\"28\">            <span class=\"kw\">if<\/span> (<span class=\"fu\">TF_GetCode<\/span>(status) != <span class=\"fu\">TF_OK<\/span>()) {<\/a>\n-<a class=\"sourceLine\" id=\"cb38-29\" title=\"29\">                <span class=\"bu\">System<\/span>.<span class=\"fu\">err.printf<\/span>(<span class=\"st\">&quot;cannot load session from saved model: <\/span><span class=\"sc\">%s\\n<\/span><span class=\"st\">&quot;<\/span>,<\/a>\n-<a class=\"sourceLine\" id=\"cb38-30\" title=\"30\">                    <span class=\"fu\">toJavaStringRestricted<\/span>(<span class=\"fu\">TF_Message<\/span>(status)));<\/a>\n-<a class=\"sourceLine\" id=\"cb38-31\" title=\"31\">            } <span class=\"kw\">else<\/span> {<\/a>\n-<a class=\"sourceLine\" id=\"cb38-32\" title=\"32\">                <span class=\"bu\">System<\/span>.<span class=\"fu\">err<\/span>.<span class=\"fu\">println<\/span>(<span class=\"st\">&quot;load session from saved model works!&quot;<\/span>);<\/a>\n-<a class=\"sourceLine\" id=\"cb38-33\" title=\"33\">            }<\/a>\n-<a class=\"sourceLine\" id=\"cb38-34\" title=\"34\"><\/a>\n-<a class=\"sourceLine\" id=\"cb38-35\" title=\"35\">            <span class=\"co\">\/\/ print operations<\/span><\/a>\n-<a class=\"sourceLine\" id=\"cb38-36\" title=\"36\">            var size = scope.<span class=\"fu\">allocate<\/span>(C_LONG_LONG);<\/a>\n-<a class=\"sourceLine\" id=\"cb38-37\" title=\"37\">            var operation = NULL;<\/a>\n-<a class=\"sourceLine\" id=\"cb38-38\" title=\"38\">            <span class=\"kw\">while<\/span> (!(operation = <span class=\"fu\">TF_GraphNextOperation<\/span>(graph, size)).<span class=\"fu\">equals<\/span>(NULL)) {<\/a>\n-<a class=\"sourceLine\" id=\"cb38-39\" title=\"39\">                <span class=\"bu\">System<\/span>.<span class=\"fu\">out.printf<\/span>(<span class=\"st\">&quot;<\/span><span class=\"sc\">%s<\/span><span class=\"st\"> : <\/span><span class=\"sc\">%s\\n<\/span><span class=\"st\">&quot;<\/span>,<\/a>\n-<a class=\"sourceLine\" id=\"cb38-40\" title=\"40\">                    <span class=\"fu\">toJavaStringRestricted<\/span>(<span class=\"fu\">TF_OperationName<\/span>(operation)),<\/a>\n-<a class=\"sourceLine\" id=\"cb38-41\" title=\"41\">                    <span class=\"fu\">toJavaStringRestricted<\/span>(<span class=\"fu\">TF_OperationOpType<\/span>(operation)));<\/a>\n-<a class=\"sourceLine\" id=\"cb38-42\" title=\"42\">            }<\/a>\n-<a class=\"sourceLine\" id=\"cb38-43\" title=\"43\"><\/a>\n-<a class=\"sourceLine\" id=\"cb38-44\" title=\"44\">            <span class=\"fu\">TF_DeleteGraph<\/span>(graph);<\/a>\n-<a class=\"sourceLine\" id=\"cb38-45\" title=\"45\">            <span class=\"fu\">TF_DeleteSession<\/span>(session, status);<\/a>\n-<a class=\"sourceLine\" id=\"cb38-46\" title=\"46\">            <span class=\"fu\">TF_DeleteSessionOptions<\/span>(sessionOpts);<\/a>\n-<a class=\"sourceLine\" id=\"cb38-47\" title=\"47\">            <span class=\"fu\">TF_DeleteStatus<\/span>(status);<\/a>\n-<a class=\"sourceLine\" id=\"cb38-48\" title=\"48\">        }<\/a>\n-<a class=\"sourceLine\" id=\"cb38-49\" title=\"49\">    }<\/a>\n-<a class=\"sourceLine\" id=\"cb38-50\" title=\"50\">}<\/a><\/code><\/pre><\/div>\n+<div class=\"sourceCode\" id=\"cb38\"><pre class=\"sourceCode java\"><code class=\"sourceCode java\"><span id=\"cb38-1\"><a href=\"#cb38-1\"><\/a><\/span>\n+<span id=\"cb38-2\"><a href=\"#cb38-2\"><\/a><span class=\"kw\">import<\/span><span class=\"im\"> jdk.incubator.foreign.*;<\/span><\/span>\n+<span id=\"cb38-3\"><a href=\"#cb38-3\"><\/a><span class=\"kw\">import static<\/span><span class=\"im\"> jdk.incubator.foreign.CLinker.*;<\/span><\/span>\n+<span id=\"cb38-4\"><a href=\"#cb38-4\"><\/a><span class=\"kw\">import static<\/span><span class=\"im\"> jdk.incubator.foreign.MemoryAccess.*;<\/span><\/span>\n+<span id=\"cb38-5\"><a href=\"#cb38-5\"><\/a><span class=\"kw\">import static<\/span><span class=\"im\"> jdk.incubator.foreign.MemoryAddress.*;<\/span><\/span>\n+<span id=\"cb38-6\"><a href=\"#cb38-6\"><\/a><span class=\"kw\">import static<\/span><span class=\"im\"> org.tensorflow.c_api_h.*;<\/span><\/span>\n+<span id=\"cb38-7\"><a href=\"#cb38-7\"><\/a><span class=\"kw\">import<\/span><span class=\"im\"> org.tensorflow.*;<\/span><\/span>\n+<span id=\"cb38-8\"><a href=\"#cb38-8\"><\/a><\/span>\n+<span id=\"cb38-9\"><a href=\"#cb38-9\"><\/a><span class=\"co\">\/\/ simple program that loads saved model and prints basic info on operations in it<\/span><\/span>\n+<span id=\"cb38-10\"><a href=\"#cb38-10\"><\/a><\/span>\n+<span id=\"cb38-11\"><a href=\"#cb38-11\"><\/a><span class=\"kw\">public<\/span> <span class=\"kw\">class<\/span> TensorflowLoadSavedModel {<\/span>\n+<span id=\"cb38-12\"><a href=\"#cb38-12\"><\/a>    <span class=\"kw\">public<\/span> <span class=\"dt\">static<\/span> <span class=\"dt\">void<\/span> <span class=\"fu\">main<\/span>(<span class=\"bu\">String<\/span><span class=\"kw\">... <\/span>args) <span class=\"kw\">throws<\/span> <span class=\"bu\">Exception<\/span> {<\/span>\n+<span id=\"cb38-13\"><a href=\"#cb38-13\"><\/a>        <span class=\"bu\">System<\/span>.<span class=\"fu\">out<\/span>.<span class=\"fu\">println<\/span>(<span class=\"st\">&quot;TensorFlow C library version: &quot;<\/span> + <span class=\"fu\">toJavaString<\/span>(<span class=\"fu\">TF_Version<\/span>()));<\/span>\n+<span id=\"cb38-14\"><a href=\"#cb38-14\"><\/a><\/span>\n+<span id=\"cb38-15\"><a href=\"#cb38-15\"><\/a>        <span class=\"kw\">if<\/span> (args.<span class=\"fu\">length<\/span> == <span class=\"dv\">0<\/span>) {<\/span>\n+<span id=\"cb38-16\"><a href=\"#cb38-16\"><\/a>            <span class=\"bu\">System<\/span>.<span class=\"fu\">err<\/span>.<span class=\"fu\">println<\/span>(<span class=\"st\">&quot;java TensorflowLoadSavedModel &lt;saved model dir&gt;&quot;<\/span>);<\/span>\n+<span id=\"cb38-17\"><a href=\"#cb38-17\"><\/a>            <span class=\"bu\">System<\/span>.<span class=\"fu\">exit<\/span>(<span class=\"dv\">1<\/span>);<\/span>\n+<span id=\"cb38-18\"><a href=\"#cb38-18\"><\/a>        }<\/span>\n+<span id=\"cb38-19\"><a href=\"#cb38-19\"><\/a><\/span>\n+<span id=\"cb38-20\"><a href=\"#cb38-20\"><\/a>        <span class=\"kw\">try<\/span> (var scope = ResourceScope.<span class=\"fu\">newConfinedScope<\/span>()) {<\/span>\n+<span id=\"cb38-21\"><a href=\"#cb38-21\"><\/a>            var allocator = SegmentAllocator.<span class=\"fu\">ofScope<\/span>(scope);<\/span>\n+<span id=\"cb38-22\"><a href=\"#cb38-22\"><\/a>            var graph = <span class=\"fu\">TF_NewGraph<\/span>();<\/span>\n+<span id=\"cb38-23\"><a href=\"#cb38-23\"><\/a>            var status = <span class=\"fu\">TF_NewStatus<\/span>();<\/span>\n+<span id=\"cb38-24\"><a href=\"#cb38-24\"><\/a>            var sessionOpts = <span class=\"fu\">TF_NewSessionOptions<\/span>();<\/span>\n+<span id=\"cb38-25\"><a href=\"#cb38-25\"><\/a><\/span>\n+<span id=\"cb38-26\"><a href=\"#cb38-26\"><\/a>            var savedModelDir = <span class=\"fu\">toCString<\/span>(args[<span class=\"dv\">0<\/span>], scope);<\/span>\n+<span id=\"cb38-27\"><a href=\"#cb38-27\"><\/a>            var tags = allocator.<span class=\"fu\">allocate<\/span>(C_POINTER, <span class=\"fu\">toCString<\/span>(<span class=\"st\">&quot;serve&quot;<\/span>, scope));<\/span>\n+<span id=\"cb38-28\"><a href=\"#cb38-28\"><\/a>            var session = <span class=\"fu\">TF_LoadSessionFromSavedModel<\/span>(sessionOpts, NULL, savedModelDir, tags, <span class=\"dv\">1<\/span>, graph, NULL, status);<\/span>\n+<span id=\"cb38-29\"><a href=\"#cb38-29\"><\/a><\/span>\n+<span id=\"cb38-30\"><a href=\"#cb38-30\"><\/a>            <span class=\"kw\">if<\/span> (<span class=\"fu\">TF_GetCode<\/span>(status) != <span class=\"fu\">TF_OK<\/span>()) {<\/span>\n+<span id=\"cb38-31\"><a href=\"#cb38-31\"><\/a>                <span class=\"bu\">System<\/span>.<span class=\"fu\">err.printf<\/span>(<span class=\"st\">&quot;cannot load session from saved model: <\/span><span class=\"sc\">%s\\n<\/span><span class=\"st\">&quot;<\/span>,<\/span>\n+<span id=\"cb38-32\"><a href=\"#cb38-32\"><\/a>                    <span class=\"fu\">toJavaString<\/span>(<span class=\"fu\">TF_Message<\/span>(status)));<\/span>\n+<span id=\"cb38-33\"><a href=\"#cb38-33\"><\/a>            } <span class=\"kw\">else<\/span> {<\/span>\n+<span id=\"cb38-34\"><a href=\"#cb38-34\"><\/a>                <span class=\"bu\">System<\/span>.<span class=\"fu\">err<\/span>.<span class=\"fu\">println<\/span>(<span class=\"st\">&quot;load session from saved model works!&quot;<\/span>);<\/span>\n+<span id=\"cb38-35\"><a href=\"#cb38-35\"><\/a>            }<\/span>\n+<span id=\"cb38-36\"><a href=\"#cb38-36\"><\/a><\/span>\n+<span id=\"cb38-37\"><a href=\"#cb38-37\"><\/a>            <span class=\"co\">\/\/ print operations<\/span><\/span>\n+<span id=\"cb38-38\"><a href=\"#cb38-38\"><\/a>            var size = allocator.<span class=\"fu\">allocate<\/span>(C_LONG_LONG);<\/span>\n+<span id=\"cb38-39\"><a href=\"#cb38-39\"><\/a>            var operation = NULL;<\/span>\n+<span id=\"cb38-40\"><a href=\"#cb38-40\"><\/a>            <span class=\"kw\">while<\/span> (!(operation = <span class=\"fu\">TF_GraphNextOperation<\/span>(graph, size)).<span class=\"fu\">equals<\/span>(NULL)) {<\/span>\n+<span id=\"cb38-41\"><a href=\"#cb38-41\"><\/a>                <span class=\"bu\">System<\/span>.<span class=\"fu\">out.printf<\/span>(<span class=\"st\">&quot;<\/span><span class=\"sc\">%s<\/span><span class=\"st\"> : <\/span><span class=\"sc\">%s\\n<\/span><span class=\"st\">&quot;<\/span>,<\/span>\n+<span id=\"cb38-42\"><a href=\"#cb38-42\"><\/a>                    <span class=\"fu\">toJavaString<\/span>(<span class=\"fu\">TF_OperationName<\/span>(operation)),<\/span>\n+<span id=\"cb38-43\"><a href=\"#cb38-43\"><\/a>                    <span class=\"fu\">toJavaString<\/span>(<span class=\"fu\">TF_OperationOpType<\/span>(operation)));<\/span>\n+<span id=\"cb38-44\"><a href=\"#cb38-44\"><\/a>            }<\/span>\n+<span id=\"cb38-45\"><a href=\"#cb38-45\"><\/a><\/span>\n+<span id=\"cb38-46\"><a href=\"#cb38-46\"><\/a>            <span class=\"fu\">TF_DeleteGraph<\/span>(graph);<\/span>\n+<span id=\"cb38-47\"><a href=\"#cb38-47\"><\/a>            <span class=\"fu\">TF_DeleteSession<\/span>(session, status);<\/span>\n+<span id=\"cb38-48\"><a href=\"#cb38-48\"><\/a>            <span class=\"fu\">TF_DeleteSessionOptions<\/span>(sessionOpts);<\/span>\n+<span id=\"cb38-49\"><a href=\"#cb38-49\"><\/a>            <span class=\"fu\">TF_DeleteStatus<\/span>(status);<\/span>\n+<span id=\"cb38-50\"><a href=\"#cb38-50\"><\/a>        }<\/span>\n+<span id=\"cb38-51\"><a href=\"#cb38-51\"><\/a>    }<\/span>\n+<span id=\"cb38-52\"><a href=\"#cb38-52\"><\/a>}<\/span><\/code><\/pre><\/div>\n@@ -833,3 +884,3 @@\n-<div class=\"sourceCode\" id=\"cb39\"><pre class=\"sourceCode sh\"><code class=\"sourceCode bash\"><a class=\"sourceLine\" id=\"cb39-1\" title=\"1\"><\/a>\n-<a class=\"sourceLine\" id=\"cb39-2\" title=\"2\"><span class=\"ex\">java<\/span> -Dforeign.restricted=permit --add-modules jdk.incubator.foreign \\<\/a>\n-<a class=\"sourceLine\" id=\"cb39-3\" title=\"3\">   TensorflowLoadSavedModel.java saved_mnist_model<\/a><\/code><\/pre><\/div>\n+<div class=\"sourceCode\" id=\"cb39\"><pre class=\"sourceCode sh\"><code class=\"sourceCode bash\"><span id=\"cb39-1\"><a href=\"#cb39-1\"><\/a><\/span>\n+<span id=\"cb39-2\"><a href=\"#cb39-2\"><\/a><span class=\"ex\">java<\/span> --enable-native-access=ALL-UNNAMED --add-modules jdk.incubator.foreign \\<\/span>\n+<span id=\"cb39-3\"><a href=\"#cb39-3\"><\/a>   TensorflowLoadSavedModel.java saved_mnist_model<\/span><\/code><\/pre><\/div>\n@@ -838,4 +889,4 @@\n-<div class=\"sourceCode\" id=\"cb40\"><pre class=\"sourceCode sh\"><code class=\"sourceCode bash\"><a class=\"sourceLine\" id=\"cb40-1\" title=\"1\"><\/a>\n-<a class=\"sourceLine\" id=\"cb40-2\" title=\"2\"><span class=\"ex\">jextract<\/span> -t org.unix \\<\/a>\n-<a class=\"sourceLine\" id=\"cb40-3\" title=\"3\">  -I \/Applications\/Xcode.app\/Contents\/Developer\/Platforms\/MacOSX.platform\/Developer\/SDKs\/MacOSX.sdk\/usr\/include \\<\/a>\n-<a class=\"sourceLine\" id=\"cb40-4\" title=\"4\">   \/Applications\/Xcode.app\/Contents\/Developer\/Platforms\/MacOSX.platform\/Developer\/SDKs\/MacOSX.sdk\/usr\/include\/time.h<\/a><\/code><\/pre><\/div>\n+<div class=\"sourceCode\" id=\"cb40\"><pre class=\"sourceCode sh\"><code class=\"sourceCode bash\"><span id=\"cb40-1\"><a href=\"#cb40-1\"><\/a><\/span>\n+<span id=\"cb40-2\"><a href=\"#cb40-2\"><\/a><span class=\"ex\">jextract<\/span> -t org.unix \\<\/span>\n+<span id=\"cb40-3\"><a href=\"#cb40-3\"><\/a>  -I \/Applications\/Xcode.app\/Contents\/Developer\/Platforms\/MacOSX.platform\/Developer\/SDKs\/MacOSX.sdk\/usr\/include \\<\/span>\n+<span id=\"cb40-4\"><a href=\"#cb40-4\"><\/a>   \/Applications\/Xcode.app\/Contents\/Developer\/Platforms\/MacOSX.platform\/Developer\/SDKs\/MacOSX.sdk\/usr\/include\/time.h<\/span><\/code><\/pre><\/div>\n@@ -843,15 +894,17 @@\n-<div class=\"sourceCode\" id=\"cb41\"><pre class=\"sourceCode java\"><code class=\"sourceCode java\"><a class=\"sourceLine\" id=\"cb41-1\" title=\"1\"><\/a>\n-<a class=\"sourceLine\" id=\"cb41-2\" title=\"2\"><span class=\"kw\">import static<\/span><span class=\"im\"> org.unix.time_h.*;<\/span><\/a>\n-<a class=\"sourceLine\" id=\"cb41-3\" title=\"3\"><span class=\"kw\">import static<\/span><span class=\"im\"> jdk.incubator.foreign.CLinker.*;<\/span><\/a>\n-<a class=\"sourceLine\" id=\"cb41-4\" title=\"4\"><span class=\"kw\">import<\/span><span class=\"im\"> jdk.incubator.foreign.*;<\/span><\/a>\n-<a class=\"sourceLine\" id=\"cb41-5\" title=\"5\"><\/a>\n-<a class=\"sourceLine\" id=\"cb41-6\" title=\"6\"><span class=\"kw\">public<\/span> <span class=\"kw\">class<\/span> PanamaTime {<\/a>\n-<a class=\"sourceLine\" id=\"cb41-7\" title=\"7\">    <span class=\"kw\">public<\/span> <span class=\"dt\">static<\/span> <span class=\"dt\">void<\/span> <span class=\"fu\">main<\/span>(<span class=\"bu\">String<\/span>[] args) {<\/a>\n-<a class=\"sourceLine\" id=\"cb41-8\" title=\"8\">        <span class=\"kw\">try<\/span> (NativeScope scope = NativeScope.<span class=\"fu\">unboundedScope<\/span>()) {<\/a>\n-<a class=\"sourceLine\" id=\"cb41-9\" title=\"9\">            var now = scope.<span class=\"fu\">allocate<\/span>(C_LONG, <span class=\"bu\">System<\/span>.<span class=\"fu\">currentTimeMillis<\/span>() \/ <span class=\"dv\">1000<\/span>);<\/a>\n-<a class=\"sourceLine\" id=\"cb41-10\" title=\"10\">            MemorySegment time = tm.<span class=\"fu\">allocate<\/span>(scope);<\/a>\n-<a class=\"sourceLine\" id=\"cb41-11\" title=\"11\">            <span class=\"fu\">localtime_r<\/span>(now, time);<\/a>\n-<a class=\"sourceLine\" id=\"cb41-12\" title=\"12\">            <span class=\"bu\">System<\/span>.<span class=\"fu\">err.printf<\/span>(<span class=\"st\">&quot;Time = <\/span><span class=\"sc\">%d<\/span><span class=\"st\">:<\/span><span class=\"sc\">%d\\n<\/span><span class=\"st\">&quot;<\/span>, tm.<span class=\"fu\">tm_hour<\/span>$<span class=\"fu\">get<\/span>(time), tm.<span class=\"fu\">tm_min<\/span>$<span class=\"fu\">get<\/span>(time));<\/a>\n-<a class=\"sourceLine\" id=\"cb41-13\" title=\"13\">        }<\/a>\n-<a class=\"sourceLine\" id=\"cb41-14\" title=\"14\">    }<\/a>\n-<a class=\"sourceLine\" id=\"cb41-15\" title=\"15\">}<\/a><\/code><\/pre><\/div>\n+<div class=\"sourceCode\" id=\"cb41\"><pre class=\"sourceCode java\"><code class=\"sourceCode java\"><span id=\"cb41-1\"><a href=\"#cb41-1\"><\/a><\/span>\n+<span id=\"cb41-2\"><a href=\"#cb41-2\"><\/a><span class=\"kw\">import static<\/span><span class=\"im\"> org.unix.time_h.*;<\/span><\/span>\n+<span id=\"cb41-3\"><a href=\"#cb41-3\"><\/a><span class=\"kw\">import static<\/span><span class=\"im\"> jdk.incubator.foreign.CLinker.*;<\/span><\/span>\n+<span id=\"cb41-4\"><a href=\"#cb41-4\"><\/a><span class=\"kw\">import<\/span><span class=\"im\"> jdk.incubator.foreign.*;<\/span><\/span>\n+<span id=\"cb41-5\"><a href=\"#cb41-5\"><\/a><span class=\"kw\">import<\/span><span class=\"im\"> org.unix.*;<\/span><\/span>\n+<span id=\"cb41-6\"><a href=\"#cb41-6\"><\/a><\/span>\n+<span id=\"cb41-7\"><a href=\"#cb41-7\"><\/a><span class=\"kw\">public<\/span> <span class=\"kw\">class<\/span> PanamaTime {<\/span>\n+<span id=\"cb41-8\"><a href=\"#cb41-8\"><\/a>    <span class=\"kw\">public<\/span> <span class=\"dt\">static<\/span> <span class=\"dt\">void<\/span> <span class=\"fu\">main<\/span>(<span class=\"bu\">String<\/span>[] args) {<\/span>\n+<span id=\"cb41-9\"><a href=\"#cb41-9\"><\/a>        <span class=\"kw\">try<\/span> (var scope = ResourceScope.<span class=\"fu\">newConfinedScope<\/span>()) {<\/span>\n+<span id=\"cb41-10\"><a href=\"#cb41-10\"><\/a>            var allocator = SegmentAllocator.<span class=\"fu\">ofScope<\/span>(scope);<\/span>\n+<span id=\"cb41-11\"><a href=\"#cb41-11\"><\/a>            var now = allocator.<span class=\"fu\">allocate<\/span>(C_LONG, <span class=\"bu\">System<\/span>.<span class=\"fu\">currentTimeMillis<\/span>() \/ <span class=\"dv\">1000<\/span>);<\/span>\n+<span id=\"cb41-12\"><a href=\"#cb41-12\"><\/a>            MemorySegment time = tm.<span class=\"fu\">allocate<\/span>(scope);<\/span>\n+<span id=\"cb41-13\"><a href=\"#cb41-13\"><\/a>            <span class=\"fu\">localtime_r<\/span>(now, time);<\/span>\n+<span id=\"cb41-14\"><a href=\"#cb41-14\"><\/a>            <span class=\"bu\">System<\/span>.<span class=\"fu\">err.printf<\/span>(<span class=\"st\">&quot;Time = <\/span><span class=\"sc\">%d<\/span><span class=\"st\">:<\/span><span class=\"sc\">%d\\n<\/span><span class=\"st\">&quot;<\/span>, tm.<span class=\"fu\">tm_hour<\/span>$<span class=\"fu\">get<\/span>(time), tm.<span class=\"fu\">tm_min<\/span>$<span class=\"fu\">get<\/span>(time));<\/span>\n+<span id=\"cb41-15\"><a href=\"#cb41-15\"><\/a>        }<\/span>\n+<span id=\"cb41-16\"><a href=\"#cb41-16\"><\/a>    }<\/span>\n+<span id=\"cb41-17\"><a href=\"#cb41-17\"><\/a>}<\/span><\/code><\/pre><\/div>\n@@ -859,2 +912,2 @@\n-<div class=\"sourceCode\" id=\"cb42\"><pre class=\"sourceCode sh\"><code class=\"sourceCode bash\"><a class=\"sourceLine\" id=\"cb42-1\" title=\"1\"><\/a>\n-<a class=\"sourceLine\" id=\"cb42-2\" title=\"2\"><span class=\"ex\">java<\/span> -Dforeign.restricted=permit --add-modules jdk.incubator.foreign PanamaTime.java<\/a><\/code><\/pre><\/div>\n+<div class=\"sourceCode\" id=\"cb42\"><pre class=\"sourceCode sh\"><code class=\"sourceCode bash\"><span id=\"cb42-1\"><a href=\"#cb42-1\"><\/a><\/span>\n+<span id=\"cb42-2\"><a href=\"#cb42-2\"><\/a><span class=\"ex\">java<\/span> --enable-native-access=ALL-UNNAMED --add-modules jdk.incubator.foreign PanamaTime.java<\/span><\/code><\/pre><\/div>\n@@ -863,9 +916,9 @@\n-<div class=\"sourceCode\" id=\"cb43\"><pre class=\"sourceCode sh\"><code class=\"sourceCode bash\"><a class=\"sourceLine\" id=\"cb43-1\" title=\"1\"><\/a>\n-<a class=\"sourceLine\" id=\"cb43-2\" title=\"2\"><span class=\"co\"># LIBCLANG_HOME is the directory where you&#39;ve installed llvm 9.x or above<\/span><\/a>\n-<a class=\"sourceLine\" id=\"cb43-3\" title=\"3\"><\/a>\n-<a class=\"sourceLine\" id=\"cb43-4\" title=\"4\"><span class=\"ex\">jextract<\/span> --source -t org.llvm.clang -lclang \\<\/a>\n-<a class=\"sourceLine\" id=\"cb43-5\" title=\"5\">  -I \/Applications\/Xcode.app\/Contents\/Developer\/Platforms\/MacOSX.platform\/Developer\/SDKs\/MacOSX.sdk\/usr\/include\/ \\<\/a>\n-<a class=\"sourceLine\" id=\"cb43-6\" title=\"6\">  -I <span class=\"va\">${LIBCLANG_HOME}<\/span>\/include\/ \\<\/a>\n-<a class=\"sourceLine\" id=\"cb43-7\" title=\"7\">  -I <span class=\"va\">${LIBCLANG_HOME}<\/span>\/include\/clang-c \\<\/a>\n-<a class=\"sourceLine\" id=\"cb43-8\" title=\"8\">  <span class=\"va\">${LIBCLANG_HOME}<\/span>\/include\/clang-c\/Index.h<\/a>\n-<a class=\"sourceLine\" id=\"cb43-9\" title=\"9\"><span class=\"ex\">javac<\/span> --add-modules jdk.incubator.foreign org\/llvm\/clang\/*.java<\/a><\/code><\/pre><\/div>\n+<div class=\"sourceCode\" id=\"cb43\"><pre class=\"sourceCode sh\"><code class=\"sourceCode bash\"><span id=\"cb43-1\"><a href=\"#cb43-1\"><\/a><\/span>\n+<span id=\"cb43-2\"><a href=\"#cb43-2\"><\/a><span class=\"co\"># LIBCLANG_HOME is the directory where you&#39;ve installed llvm 9.x or above<\/span><\/span>\n+<span id=\"cb43-3\"><a href=\"#cb43-3\"><\/a><\/span>\n+<span id=\"cb43-4\"><a href=\"#cb43-4\"><\/a><span class=\"ex\">jextract<\/span> --source -t org.llvm.clang -lclang \\<\/span>\n+<span id=\"cb43-5\"><a href=\"#cb43-5\"><\/a>  -I \/Applications\/Xcode.app\/Contents\/Developer\/Platforms\/MacOSX.platform\/Developer\/SDKs\/MacOSX.sdk\/usr\/include\/ \\<\/span>\n+<span id=\"cb43-6\"><a href=\"#cb43-6\"><\/a>  -I <span class=\"va\">${LIBCLANG_HOME}<\/span>\/include\/ \\<\/span>\n+<span id=\"cb43-7\"><a href=\"#cb43-7\"><\/a>  -I <span class=\"va\">${LIBCLANG_HOME}<\/span>\/include\/clang-c \\<\/span>\n+<span id=\"cb43-8\"><a href=\"#cb43-8\"><\/a>  <span class=\"va\">${LIBCLANG_HOME}<\/span>\/include\/clang-c\/Index.h<\/span>\n+<span id=\"cb43-9\"><a href=\"#cb43-9\"><\/a><span class=\"ex\">javac<\/span> --add-modules jdk.incubator.foreign org\/llvm\/clang\/*.java<\/span><\/code><\/pre><\/div>\n@@ -873,58 +926,59 @@\n-<div class=\"sourceCode\" id=\"cb44\"><pre class=\"sourceCode java\"><code class=\"sourceCode java\"><a class=\"sourceLine\" id=\"cb44-1\" title=\"1\"><\/a>\n-<a class=\"sourceLine\" id=\"cb44-2\" title=\"2\"><span class=\"kw\">import<\/span><span class=\"im\"> jdk.incubator.foreign.*;<\/span><\/a>\n-<a class=\"sourceLine\" id=\"cb44-3\" title=\"3\"><span class=\"kw\">import static<\/span><span class=\"im\"> jdk.incubator.foreign.CLinker.*;<\/span><\/a>\n-<a class=\"sourceLine\" id=\"cb44-4\" title=\"4\"><span class=\"kw\">import static<\/span><span class=\"im\"> jdk.incubator.foreign.MemoryAddress.NULL;<\/span><\/a>\n-<a class=\"sourceLine\" id=\"cb44-5\" title=\"5\"><span class=\"kw\">import static<\/span><span class=\"im\"> org.llvm.clang.Index_h.*;<\/span><\/a>\n-<a class=\"sourceLine\" id=\"cb44-6\" title=\"6\"><\/a>\n-<a class=\"sourceLine\" id=\"cb44-7\" title=\"7\"><span class=\"kw\">public<\/span> <span class=\"kw\">class<\/span> ASTPrinter {<\/a>\n-<a class=\"sourceLine\" id=\"cb44-8\" title=\"8\">    <span class=\"kw\">private<\/span> <span class=\"dt\">static<\/span> <span class=\"bu\">String<\/span> <span class=\"fu\">asJavaString<\/span>(MemorySegment clangStr) {<\/a>\n-<a class=\"sourceLine\" id=\"cb44-9\" title=\"9\">        <span class=\"bu\">String<\/span> str = <span class=\"fu\">toJavaStringRestricted<\/span>(<span class=\"fu\">clang_getCString<\/span>(clangStr));<\/a>\n-<a class=\"sourceLine\" id=\"cb44-10\" title=\"10\">        <span class=\"fu\">clang_disposeString<\/span>(clangStr);<\/a>\n-<a class=\"sourceLine\" id=\"cb44-11\" title=\"11\">        <span class=\"kw\">return<\/span> str;<\/a>\n-<a class=\"sourceLine\" id=\"cb44-12\" title=\"12\">    }<\/a>\n-<a class=\"sourceLine\" id=\"cb44-13\" title=\"13\"><\/a>\n-<a class=\"sourceLine\" id=\"cb44-14\" title=\"14\">    <span class=\"kw\">public<\/span> <span class=\"dt\">static<\/span> <span class=\"dt\">void<\/span> <span class=\"fu\">main<\/span>(<span class=\"bu\">String<\/span>[] args) {<\/a>\n-<a class=\"sourceLine\" id=\"cb44-15\" title=\"15\">        <span class=\"kw\">if<\/span> (args.<span class=\"fu\">length<\/span> == <span class=\"dv\">0<\/span>) {<\/a>\n-<a class=\"sourceLine\" id=\"cb44-16\" title=\"16\">            <span class=\"bu\">System<\/span>.<span class=\"fu\">err<\/span>.<span class=\"fu\">println<\/span>(<span class=\"st\">&quot;java ASTPrinter &lt;C source or header&gt;&quot;<\/span>);<\/a>\n-<a class=\"sourceLine\" id=\"cb44-17\" title=\"17\">            <span class=\"bu\">System<\/span>.<span class=\"fu\">exit<\/span>(<span class=\"dv\">1<\/span>);<\/a>\n-<a class=\"sourceLine\" id=\"cb44-18\" title=\"18\">        }<\/a>\n-<a class=\"sourceLine\" id=\"cb44-19\" title=\"19\"><\/a>\n-<a class=\"sourceLine\" id=\"cb44-20\" title=\"20\">        <span class=\"kw\">try<\/span> (var scope = NativeScope.<span class=\"fu\">unboundedScope<\/span>()) {<\/a>\n-<a class=\"sourceLine\" id=\"cb44-21\" title=\"21\">            <span class=\"co\">\/\/ parse the C header\/source passed from the command line<\/span><\/a>\n-<a class=\"sourceLine\" id=\"cb44-22\" title=\"22\">            var index = <span class=\"fu\">clang_createIndex<\/span>(<span class=\"dv\">0<\/span>, <span class=\"dv\">0<\/span>);<\/a>\n-<a class=\"sourceLine\" id=\"cb44-23\" title=\"23\">            var tu = <span class=\"fu\">clang_parseTranslationUnit<\/span>(index, <span class=\"fu\">toCString<\/span>(args[<span class=\"dv\">0<\/span>], scope),<\/a>\n-<a class=\"sourceLine\" id=\"cb44-24\" title=\"24\">                    NULL, <span class=\"dv\">0<\/span>, NULL, <span class=\"dv\">0<\/span>, <span class=\"fu\">CXTranslationUnit_None<\/span>());<\/a>\n-<a class=\"sourceLine\" id=\"cb44-25\" title=\"25\">            <span class=\"co\">\/\/ array trick to update within lambda<\/span><\/a>\n-<a class=\"sourceLine\" id=\"cb44-26\" title=\"26\">            var level = <span class=\"kw\">new<\/span> <span class=\"dt\">int<\/span>[<span class=\"dv\">1<\/span>];<\/a>\n-<a class=\"sourceLine\" id=\"cb44-27\" title=\"27\">            var visitor = <span class=\"kw\">new<\/span> MemorySegment[<span class=\"dv\">1<\/span>];<\/a>\n-<a class=\"sourceLine\" id=\"cb44-28\" title=\"28\"><\/a>\n-<a class=\"sourceLine\" id=\"cb44-29\" title=\"29\">            <span class=\"co\">\/\/ clang Cursor visitor callback<\/span><\/a>\n-<a class=\"sourceLine\" id=\"cb44-30\" title=\"30\">            visitor[<span class=\"dv\">0<\/span>] = clang_visitChildren$visitor.<span class=\"fu\">allocate<\/span>((cursor, parent, data) -&gt; {<\/a>\n-<a class=\"sourceLine\" id=\"cb44-31\" title=\"31\">                var kind = <span class=\"fu\">clang_getCursorKind<\/span>(cursor);<\/a>\n-<a class=\"sourceLine\" id=\"cb44-32\" title=\"32\">                var name = <span class=\"fu\">asJavaString<\/span>(<span class=\"fu\">clang_getCursorSpelling<\/span>(cursor));<\/a>\n-<a class=\"sourceLine\" id=\"cb44-33\" title=\"33\">                var kindName = <span class=\"fu\">asJavaString<\/span>(<span class=\"fu\">clang_getCursorKindSpelling<\/span>(kind));<\/a>\n-<a class=\"sourceLine\" id=\"cb44-34\" title=\"34\">                <span class=\"bu\">System<\/span>.<span class=\"fu\">out.printf<\/span>(<span class=\"st\">&quot;<\/span><span class=\"sc\">%s<\/span><span class=\"st\"> <\/span><span class=\"sc\">%s<\/span><span class=\"st\"> <\/span><span class=\"sc\">%s<\/span><span class=\"st\">&quot;<\/span>, <span class=\"st\">&quot; &quot;<\/span>.<span class=\"fu\">repeat<\/span>(level[<span class=\"dv\">0<\/span>]), kindName, name);<\/a>\n-<a class=\"sourceLine\" id=\"cb44-35\" title=\"35\">                var type = <span class=\"fu\">clang_getCursorType<\/span>(cursor);<\/a>\n-<a class=\"sourceLine\" id=\"cb44-36\" title=\"36\">                <span class=\"kw\">if<\/span> (CXType.<span class=\"fu\">kind<\/span>$<span class=\"fu\">get<\/span>(type) != <span class=\"fu\">CXType_Invalid<\/span>()) {<\/a>\n-<a class=\"sourceLine\" id=\"cb44-37\" title=\"37\">                    var typeName = <span class=\"fu\">asJavaString<\/span>(<span class=\"fu\">clang_getTypeSpelling<\/span>(type));<\/a>\n-<a class=\"sourceLine\" id=\"cb44-38\" title=\"38\">                    <span class=\"bu\">System<\/span>.<span class=\"fu\">out.printf<\/span>(<span class=\"st\">&quot; &lt;<\/span><span class=\"sc\">%s<\/span><span class=\"st\">&gt;&quot;<\/span>, typeName);<\/a>\n-<a class=\"sourceLine\" id=\"cb44-39\" title=\"39\">                }<\/a>\n-<a class=\"sourceLine\" id=\"cb44-40\" title=\"40\">                <span class=\"bu\">System<\/span>.<span class=\"fu\">out<\/span>.<span class=\"fu\">println<\/span>();<\/a>\n-<a class=\"sourceLine\" id=\"cb44-41\" title=\"41\"><\/a>\n-<a class=\"sourceLine\" id=\"cb44-42\" title=\"42\">                <span class=\"co\">\/\/ visit children<\/span><\/a>\n-<a class=\"sourceLine\" id=\"cb44-43\" title=\"43\">                level[<span class=\"dv\">0<\/span>]++;<\/a>\n-<a class=\"sourceLine\" id=\"cb44-44\" title=\"44\">                <span class=\"fu\">clang_visitChildren<\/span>(cursor, visitor[<span class=\"dv\">0<\/span>], NULL);<\/a>\n-<a class=\"sourceLine\" id=\"cb44-45\" title=\"45\">                level[<span class=\"dv\">0<\/span>]--;<\/a>\n-<a class=\"sourceLine\" id=\"cb44-46\" title=\"46\"><\/a>\n-<a class=\"sourceLine\" id=\"cb44-47\" title=\"47\">                <span class=\"kw\">return<\/span> <span class=\"fu\">CXChildVisit_Continue<\/span>();<\/a>\n-<a class=\"sourceLine\" id=\"cb44-48\" title=\"48\">            });<\/a>\n-<a class=\"sourceLine\" id=\"cb44-49\" title=\"49\"><\/a>\n-<a class=\"sourceLine\" id=\"cb44-50\" title=\"50\">            <span class=\"co\">\/\/ get the AST root and visit it<\/span><\/a>\n-<a class=\"sourceLine\" id=\"cb44-51\" title=\"51\">            var root = <span class=\"fu\">clang_getTranslationUnitCursor<\/span>(tu);<\/a>\n-<a class=\"sourceLine\" id=\"cb44-52\" title=\"52\">            <span class=\"fu\">clang_visitChildren<\/span>(root, visitor[<span class=\"dv\">0<\/span>], NULL);<\/a>\n-<a class=\"sourceLine\" id=\"cb44-53\" title=\"53\"><\/a>\n-<a class=\"sourceLine\" id=\"cb44-54\" title=\"54\">            <span class=\"fu\">clang_disposeTranslationUnit<\/span>(tu);<\/a>\n-<a class=\"sourceLine\" id=\"cb44-55\" title=\"55\">            <span class=\"fu\">clang_disposeIndex<\/span>(index);<\/a>\n-<a class=\"sourceLine\" id=\"cb44-56\" title=\"56\">        }<\/a>\n-<a class=\"sourceLine\" id=\"cb44-57\" title=\"57\">    }<\/a>\n-<a class=\"sourceLine\" id=\"cb44-58\" title=\"58\">}<\/a><\/code><\/pre><\/div>\n+<div class=\"sourceCode\" id=\"cb44\"><pre class=\"sourceCode java\"><code class=\"sourceCode java\"><span id=\"cb44-1\"><a href=\"#cb44-1\"><\/a><\/span>\n+<span id=\"cb44-2\"><a href=\"#cb44-2\"><\/a><span class=\"kw\">import<\/span><span class=\"im\"> jdk.incubator.foreign.*;<\/span><\/span>\n+<span id=\"cb44-3\"><a href=\"#cb44-3\"><\/a><span class=\"kw\">import static<\/span><span class=\"im\"> jdk.incubator.foreign.CLinker.*;<\/span><\/span>\n+<span id=\"cb44-4\"><a href=\"#cb44-4\"><\/a><span class=\"kw\">import static<\/span><span class=\"im\"> jdk.incubator.foreign.MemoryAddress.NULL;<\/span><\/span>\n+<span id=\"cb44-5\"><a href=\"#cb44-5\"><\/a><span class=\"kw\">import static<\/span><span class=\"im\"> org.llvm.clang.Index_h.*;<\/span><\/span>\n+<span id=\"cb44-6\"><a href=\"#cb44-6\"><\/a><span class=\"kw\">import<\/span><span class=\"im\"> org.llvm.clang.*;<\/span><\/span>\n+<span id=\"cb44-7\"><a href=\"#cb44-7\"><\/a><\/span>\n+<span id=\"cb44-8\"><a href=\"#cb44-8\"><\/a><span class=\"kw\">public<\/span> <span class=\"kw\">class<\/span> ASTPrinter {<\/span>\n+<span id=\"cb44-9\"><a href=\"#cb44-9\"><\/a>    <span class=\"kw\">private<\/span> <span class=\"dt\">static<\/span> <span class=\"bu\">String<\/span> <span class=\"fu\">asJavaString<\/span>(MemorySegment clangStr) {<\/span>\n+<span id=\"cb44-10\"><a href=\"#cb44-10\"><\/a>        <span class=\"bu\">String<\/span> str = <span class=\"fu\">toJavaString<\/span>(<span class=\"fu\">clang_getCString<\/span>(clangStr));<\/span>\n+<span id=\"cb44-11\"><a href=\"#cb44-11\"><\/a>        <span class=\"fu\">clang_disposeString<\/span>(clangStr);<\/span>\n+<span id=\"cb44-12\"><a href=\"#cb44-12\"><\/a>        <span class=\"kw\">return<\/span> str;<\/span>\n+<span id=\"cb44-13\"><a href=\"#cb44-13\"><\/a>    }<\/span>\n+<span id=\"cb44-14\"><a href=\"#cb44-14\"><\/a><\/span>\n+<span id=\"cb44-15\"><a href=\"#cb44-15\"><\/a>    <span class=\"kw\">public<\/span> <span class=\"dt\">static<\/span> <span class=\"dt\">void<\/span> <span class=\"fu\">main<\/span>(<span class=\"bu\">String<\/span>[] args) {<\/span>\n+<span id=\"cb44-16\"><a href=\"#cb44-16\"><\/a>        <span class=\"kw\">if<\/span> (args.<span class=\"fu\">length<\/span> == <span class=\"dv\">0<\/span>) {<\/span>\n+<span id=\"cb44-17\"><a href=\"#cb44-17\"><\/a>            <span class=\"bu\">System<\/span>.<span class=\"fu\">err<\/span>.<span class=\"fu\">println<\/span>(<span class=\"st\">&quot;java ASTPrinter &lt;C source or header&gt;&quot;<\/span>);<\/span>\n+<span id=\"cb44-18\"><a href=\"#cb44-18\"><\/a>            <span class=\"bu\">System<\/span>.<span class=\"fu\">exit<\/span>(<span class=\"dv\">1<\/span>);<\/span>\n+<span id=\"cb44-19\"><a href=\"#cb44-19\"><\/a>        }<\/span>\n+<span id=\"cb44-20\"><a href=\"#cb44-20\"><\/a><\/span>\n+<span id=\"cb44-21\"><a href=\"#cb44-21\"><\/a>        <span class=\"kw\">try<\/span> (var scope = ResourceScope.<span class=\"fu\">newConfinedScope<\/span>()) {<\/span>\n+<span id=\"cb44-22\"><a href=\"#cb44-22\"><\/a>            <span class=\"co\">\/\/ parse the C header\/source passed from the command line<\/span><\/span>\n+<span id=\"cb44-23\"><a href=\"#cb44-23\"><\/a>            var index = <span class=\"fu\">clang_createIndex<\/span>(<span class=\"dv\">0<\/span>, <span class=\"dv\">0<\/span>);<\/span>\n+<span id=\"cb44-24\"><a href=\"#cb44-24\"><\/a>            var tu = <span class=\"fu\">clang_parseTranslationUnit<\/span>(index, <span class=\"fu\">toCString<\/span>(args[<span class=\"dv\">0<\/span>], scope),<\/span>\n+<span id=\"cb44-25\"><a href=\"#cb44-25\"><\/a>                    NULL, <span class=\"dv\">0<\/span>, NULL, <span class=\"dv\">0<\/span>, <span class=\"fu\">CXTranslationUnit_None<\/span>());<\/span>\n+<span id=\"cb44-26\"><a href=\"#cb44-26\"><\/a>            <span class=\"co\">\/\/ array trick to update within lambda<\/span><\/span>\n+<span id=\"cb44-27\"><a href=\"#cb44-27\"><\/a>            var level = <span class=\"kw\">new<\/span> <span class=\"dt\">int<\/span>[<span class=\"dv\">1<\/span>];<\/span>\n+<span id=\"cb44-28\"><a href=\"#cb44-28\"><\/a>            var visitor = <span class=\"kw\">new<\/span> MemoryAddress[<span class=\"dv\">1<\/span>];<\/span>\n+<span id=\"cb44-29\"><a href=\"#cb44-29\"><\/a><\/span>\n+<span id=\"cb44-30\"><a href=\"#cb44-30\"><\/a>            <span class=\"co\">\/\/ clang Cursor visitor callback<\/span><\/span>\n+<span id=\"cb44-31\"><a href=\"#cb44-31\"><\/a>            visitor[<span class=\"dv\">0<\/span>] = CXCursorVisitor.<span class=\"fu\">allocate<\/span>((cursor, parent, data) -&gt; {<\/span>\n+<span id=\"cb44-32\"><a href=\"#cb44-32\"><\/a>                var kind = <span class=\"fu\">clang_getCursorKind<\/span>(cursor);<\/span>\n+<span id=\"cb44-33\"><a href=\"#cb44-33\"><\/a>                var name = <span class=\"fu\">asJavaString<\/span>(<span class=\"fu\">clang_getCursorSpelling<\/span>(scope, cursor));<\/span>\n+<span id=\"cb44-34\"><a href=\"#cb44-34\"><\/a>                var kindName = <span class=\"fu\">asJavaString<\/span>(<span class=\"fu\">clang_getCursorKindSpelling<\/span>(scope, kind));<\/span>\n+<span id=\"cb44-35\"><a href=\"#cb44-35\"><\/a>                <span class=\"bu\">System<\/span>.<span class=\"fu\">out.printf<\/span>(<span class=\"st\">&quot;<\/span><span class=\"sc\">%s<\/span><span class=\"st\"> <\/span><span class=\"sc\">%s<\/span><span class=\"st\"> <\/span><span class=\"sc\">%s<\/span><span class=\"st\">&quot;<\/span>, <span class=\"st\">&quot; &quot;<\/span>.<span class=\"fu\">repeat<\/span>(level[<span class=\"dv\">0<\/span>]), kindName, name);<\/span>\n+<span id=\"cb44-36\"><a href=\"#cb44-36\"><\/a>                var type = <span class=\"fu\">clang_getCursorType<\/span>(scope, cursor);<\/span>\n+<span id=\"cb44-37\"><a href=\"#cb44-37\"><\/a>                <span class=\"kw\">if<\/span> (CXType.<span class=\"fu\">kind<\/span>$<span class=\"fu\">get<\/span>(type) != <span class=\"fu\">CXType_Invalid<\/span>()) {<\/span>\n+<span id=\"cb44-38\"><a href=\"#cb44-38\"><\/a>                    var typeName = <span class=\"fu\">asJavaString<\/span>(<span class=\"fu\">clang_getTypeSpelling<\/span>(scope, type));<\/span>\n+<span id=\"cb44-39\"><a href=\"#cb44-39\"><\/a>                    <span class=\"bu\">System<\/span>.<span class=\"fu\">out.printf<\/span>(<span class=\"st\">&quot; &lt;<\/span><span class=\"sc\">%s<\/span><span class=\"st\">&gt;&quot;<\/span>, typeName);<\/span>\n+<span id=\"cb44-40\"><a href=\"#cb44-40\"><\/a>                }<\/span>\n+<span id=\"cb44-41\"><a href=\"#cb44-41\"><\/a>                <span class=\"bu\">System<\/span>.<span class=\"fu\">out<\/span>.<span class=\"fu\">println<\/span>();<\/span>\n+<span id=\"cb44-42\"><a href=\"#cb44-42\"><\/a><\/span>\n+<span id=\"cb44-43\"><a href=\"#cb44-43\"><\/a>                <span class=\"co\">\/\/ visit children<\/span><\/span>\n+<span id=\"cb44-44\"><a href=\"#cb44-44\"><\/a>                level[<span class=\"dv\">0<\/span>]++;<\/span>\n+<span id=\"cb44-45\"><a href=\"#cb44-45\"><\/a>                <span class=\"fu\">clang_visitChildren<\/span>(cursor, visitor[<span class=\"dv\">0<\/span>], NULL);<\/span>\n+<span id=\"cb44-46\"><a href=\"#cb44-46\"><\/a>                level[<span class=\"dv\">0<\/span>]--;<\/span>\n+<span id=\"cb44-47\"><a href=\"#cb44-47\"><\/a><\/span>\n+<span id=\"cb44-48\"><a href=\"#cb44-48\"><\/a>                <span class=\"kw\">return<\/span> <span class=\"fu\">CXChildVisit_Continue<\/span>();<\/span>\n+<span id=\"cb44-49\"><a href=\"#cb44-49\"><\/a>            });<\/span>\n+<span id=\"cb44-50\"><a href=\"#cb44-50\"><\/a><\/span>\n+<span id=\"cb44-51\"><a href=\"#cb44-51\"><\/a>            <span class=\"co\">\/\/ get the AST root and visit it<\/span><\/span>\n+<span id=\"cb44-52\"><a href=\"#cb44-52\"><\/a>            var root = <span class=\"fu\">clang_getTranslationUnitCursor<\/span>(scope, tu);<\/span>\n+<span id=\"cb44-53\"><a href=\"#cb44-53\"><\/a>            <span class=\"fu\">clang_visitChildren<\/span>(root, visitor[<span class=\"dv\">0<\/span>], NULL);<\/span>\n+<span id=\"cb44-54\"><a href=\"#cb44-54\"><\/a><\/span>\n+<span id=\"cb44-55\"><a href=\"#cb44-55\"><\/a>            <span class=\"fu\">clang_disposeTranslationUnit<\/span>(tu);<\/span>\n+<span id=\"cb44-56\"><a href=\"#cb44-56\"><\/a>            <span class=\"fu\">clang_disposeIndex<\/span>(index);<\/span>\n+<span id=\"cb44-57\"><a href=\"#cb44-57\"><\/a>        }<\/span>\n+<span id=\"cb44-58\"><a href=\"#cb44-58\"><\/a>    }<\/span>\n+<span id=\"cb44-59\"><a href=\"#cb44-59\"><\/a>}<\/span><\/code><\/pre><\/div>\n@@ -932,3 +986,5 @@\n-<div class=\"sourceCode\" id=\"cb45\"><pre class=\"sourceCode sh\"><code class=\"sourceCode bash\"><a class=\"sourceLine\" id=\"cb45-1\" title=\"1\"><\/a>\n-<a class=\"sourceLine\" id=\"cb45-2\" title=\"2\"><span class=\"ex\">java<\/span> -Dforeign.restricted=permit --add-modules jdk.incubator.foreign \\<\/a>\n-<a class=\"sourceLine\" id=\"cb45-3\" title=\"3\">    ASTPrinter.java <span class=\"va\">$*<\/span><\/a><\/code><\/pre><\/div>\n+<div class=\"sourceCode\" id=\"cb45\"><pre class=\"sourceCode sh\"><code class=\"sourceCode bash\"><span id=\"cb45-1\"><a href=\"#cb45-1\"><\/a><\/span>\n+<span id=\"cb45-2\"><a href=\"#cb45-2\"><\/a><span class=\"ex\">java<\/span> --enable-native-access=ALL-UNNAMED \\<\/span>\n+<span id=\"cb45-3\"><a href=\"#cb45-3\"><\/a>    -Djava.library.path=<span class=\"va\">${LIBCLANG_HOME}<\/span>\/lib \\<\/span>\n+<span id=\"cb45-4\"><a href=\"#cb45-4\"><\/a>    --add-modules jdk.incubator.foreign \\<\/span>\n+<span id=\"cb45-5\"><a href=\"#cb45-5\"><\/a>    ASTPrinter.java <span class=\"va\">$*<\/span><\/span><\/code><\/pre><\/div>\n","filename":"doc\/panama_jextract.html","additions":815,"deletions":759,"binary":false,"changes":1574,"status":"modified"},{"patch":"@@ -19,1 +19,6 @@\n-* `--filter <String>` - simple string-based filtering mechanism; only symbols from headers whose absolute path contains the specified string will be included in the generated API\n+* --include-function <String> - name of function to include\n+* --include-macro <String>    - name of constant macro to include\n+* --include-struct <String>   - name of struct definition to include\n+* --include-typedef <String>  - name of type definition to include\n+* --include-union <String>    - name of union definition to include\n+* --include-var <String>      - name of global variable to include\n@@ -89,1 +94,1 @@\n-java -Dforeign.restricted=permit --add-modules jdk.incubator.foreign HelloWorld.java\n+java --enable-native-access=ALL-UNNAMED --add-modules jdk.incubator.foreign HelloWorld.java\n@@ -112,0 +117,1 @@\n+import jdk.incubator.foreign.ResourceScope;\n@@ -116,0 +122,1 @@\n+import org.python.*;\n@@ -122,1 +129,2 @@\n-        try (var str = toCString(script)) {\n+        try (var scope = ResourceScope.newConfinedScope()) {\n+            var str = toCString(script, scope);\n@@ -135,1 +143,1 @@\n-java -Dforeign.restricted=permit --add-modules jdk.incubator.foreign \\\n+java --enable-native-access=ALL-UNNAMED --add-modules jdk.incubator.foreign \\\n@@ -158,0 +166,1 @@\n+import jdk.incubator.foreign.ResourceScope;\n@@ -160,0 +169,1 @@\n+import org.unix.*;\n@@ -163,1 +173,3 @@\n-        try (var str = toCString(\"name? \")) {\n+       try (var scope = ResourceScope.newConfinedScope()) {\n+            var url = toCString(\"name? \", scope);\n+\n@@ -165,1 +177,1 @@\n-            var p = readline(str);\n+            var p = readline(url);\n@@ -170,1 +182,3 @@\n-            System.out.println(\"Hello, \" + toJavaStringRestricted(p));\n+            System.out.println(\"Hello, \" + toJavaString(p));\n+\n+            freeMemory(p);\n@@ -180,1 +194,1 @@\n-java -Dforeign.restricted=permit --add-modules jdk.incubator.foreign \\\n+java --enable-native-access=ALL-UNNAMED --add-modules jdk.incubator.foreign \\\n@@ -202,0 +216,1 @@\n+import jdk.incubator.foreign.ResourceScope;\n@@ -205,0 +220,1 @@\n+import org.jextract.*;\n@@ -212,1 +228,2 @@\n-           try (var url = toCString(urlStr)) {\n+           try (var scope = ResourceScope.newConfinedScope()) {\n+               var url = toCString(urlStr, scope);\n@@ -216,1 +233,1 @@\n-                   String error = toJavaStringRestricted(curl_easy_strerror(res));\n+                   String error = toJavaString(curl_easy_strerror(res));\n@@ -233,1 +250,1 @@\n-java -Dforeign.restricted=permit --add-modules jdk.incubator.foreign \\\n+java --enable-native-access=ALL-UNNAMED --add-modules jdk.incubator.foreign \\\n@@ -276,1 +293,2 @@\n-import jdk.incubator.foreign.NativeScope;\n+import jdk.incubator.foreign.ResourceScope;\n+import jdk.incubator.foreign.SegmentAllocator;\n@@ -300,2 +318,3 @@\n-        try (var scope = NativeScope.unboundedScope()) {\n-            var a = scope.allocateArray(C_DOUBLE, new double[] {\n+        try (var scope = ResourceScope.newConfinedScope()) {\n+            var allocator = SegmentAllocator.ofScope(scope);\n+            var a = allocator.allocateArray(C_DOUBLE, new double[] {\n@@ -307,1 +326,1 @@\n-            var x = scope.allocateArray(C_DOUBLE, new double[] {\n+            var x = allocator.allocateArray(C_DOUBLE, new double[] {\n@@ -310,1 +329,1 @@\n-            var y = scope.allocateArray(C_DOUBLE, n);\n+            var y = allocator.allocateArray(C_DOUBLE, n);\n@@ -320,0 +339,1 @@\n+\n@@ -344,1 +364,0 @@\n-   --filter lapacke.h \\\n@@ -356,1 +375,2 @@\n-import jdk.incubator.foreign.NativeScope;\n+import jdk.incubator.foreign.ResourceScope;\n+import jdk.incubator.foreign.SegmentAllocator;\n@@ -365,2 +385,3 @@\n-        try (var scope = NativeScope.unboundedScope()) {\n-            var A = scope.allocateArray(C_DOUBLE, new double[]{\n+        try (var scope = ResourceScope.newConfinedScope()) {\n+            var allocator = SegmentAllocator.ofScope(scope);\n+            var A = allocator.allocateArray(C_DOUBLE, new double[]{\n@@ -369,1 +390,1 @@\n-            var b = scope.allocateArray(C_DOUBLE, new double[]{\n+            var b = allocator.allocateArray(C_DOUBLE, new double[]{\n@@ -386,1 +407,1 @@\n-            \n+\n@@ -391,1 +412,1 @@\n- \n+\n@@ -396,3 +417,3 @@\n-        }   \n-    }   \n-    \n+        }\n+    }\n+\n@@ -416,1 +437,1 @@\n-java -Dforeign.restricted=permit \\\n+java --enable-native-access=ALL-UNNAMED \\\n@@ -431,1 +452,0 @@\n-  --filter libproc.h \\\n@@ -442,1 +462,2 @@\n-import jdk.incubator.foreign.NativeScope;\n+import jdk.incubator.foreign.ResourceScope;\n+import jdk.incubator.foreign.SegmentAllocator;\n@@ -451,1 +472,2 @@\n-        try (var scope = NativeScope.unboundedScope()) {\n+        try (var scope = ResourceScope.newConfinedScope()) {\n+            var allocator = SegmentAllocator.ofScope(scope);\n@@ -455,1 +477,1 @@\n-            var pids = scope.allocateArray(CLinker.C_INT, numPids);\n+            var pids = allocator.allocateArray(CLinker.C_INT, numPids);\n@@ -461,1 +483,1 @@\n-            var nameBuf = scope.allocateArray(CLinker.C_CHAR, NAME_BUF_MAX);\n+            var nameBuf = allocator.allocateArray(CLinker.C_CHAR, NAME_BUF_MAX);\n@@ -480,1 +502,1 @@\n-java -Dforeign.restricted=permit \\\n+java --enable-native-access=ALL-UNNAMED \\\n@@ -513,1 +535,2 @@\n-import jdk.incubator.foreign.NativeScope;\n+import jdk.incubator.foreign.ResourceScope;\n+import jdk.incubator.foreign.SegmentAllocator;\n@@ -517,0 +540,1 @@\n+import com.github.*;\n@@ -525,2 +549,3 @@\n-          try (var scope = NativeScope.unboundedScope()) {\n-              var repo = scope.allocate(C_POINTER);\n+          try (var scope = ResourceScope.newConfinedScope()) {\n+              var allocator = SegmentAllocator.ofScope(scope);\n+              var repo = allocator.allocate(C_POINTER);\n@@ -543,1 +568,1 @@\n-java -Dforeign.restricted=permit --add-modules jdk.incubator.foreign \\\n+java --enable-native-access=ALL-UNNAMED --add-modules jdk.incubator.foreign \\\n@@ -575,1 +600,3 @@\n-import jdk.incubator.foreign.NativeScope;\n+import jdk.incubator.foreign.ResourceScope;\n+import jdk.incubator.foreign.SegmentAllocator;\n+import org.sqlite.*;\n@@ -582,1 +609,2 @@\n-        try (var scope = NativeScope.unboundedScope()) {\n+        try (var scope = ResourceScope.newConfinedScope()) {\n+            var allocator = SegmentAllocator.ofScope(scope);\n@@ -584,1 +612,1 @@\n-            var errMsgPtrPtr = scope.allocate(C_POINTER);\n+            var errMsgPtrPtr = allocator.allocate(C_POINTER);\n@@ -587,1 +615,1 @@\n-            var dbPtrPtr = scope.allocate(C_POINTER);\n+            var dbPtrPtr = allocator.allocate(C_POINTER);\n@@ -611,1 +639,1 @@\n-                System.err.println(\"SQL error: \" + toJavaStringRestricted(MemoryAccess.getAddress(errMsgPtrPtr)));\n+                System.err.println(\"SQL error: \" + toJavaString(MemoryAccess.getAddress(errMsgPtrPtr)));\n@@ -628,1 +656,1 @@\n-                System.err.println(\"SQL error: \" + toJavaStringRestricted(MemoryAccess.getAddress(errMsgPtrPtr)));\n+                System.err.println(\"SQL error: \" + toJavaString(MemoryAccess.getAddress(errMsgPtrPtr)));\n@@ -639,2 +667,2 @@\n-                var argv_seg = argv.asSegmentRestricted(C_POINTER.byteSize() * argc);\n-                var columnNames_seg = columnNames.asSegmentRestricted(C_POINTER.byteSize() * argc);\n+                var argv_seg = argv.asSegment(C_POINTER.byteSize() * argc, scope);\n+                var columnNames_seg = columnNames.asSegment(C_POINTER.byteSize() * argc, scope);\n@@ -642,2 +670,2 @@\n-                     String name = toJavaStringRestricted(MemoryAccess.getAddressAtIndex(columnNames_seg, i));\n-                     String value = toJavaStringRestricted(MemoryAccess.getAddressAtIndex(argv_seg, i));\n+                     String name = toJavaString(MemoryAccess.getAddressAtIndex(columnNames_seg, i));\n+                     String value = toJavaString(MemoryAccess.getAddressAtIndex(argv_seg, i));\n@@ -655,1 +683,1 @@\n-                System.err.println(\"SQL error: \" + toJavaStringRestricted(MemoryAccess.getAddress(errMsgPtrPtr)));\n+                System.err.println(\"SQL error: \" + toJavaString(MemoryAccess.getAddress(errMsgPtrPtr)));\n@@ -666,0 +694,1 @@\n+\n@@ -672,1 +701,1 @@\n-java -Dforeign.restricted=permit \\\n+java --enable-native-access=ALL-UNNAMED \\\n@@ -695,0 +724,3 @@\n+import jdk.incubator.foreign.ResourceScope;\n+import jdk.incubator.foreign.SegmentAllocator;\n+import opengl.*;\n@@ -696,1 +728,0 @@\n-import jdk.incubator.foreign.NativeScope;\n@@ -702,1 +733,1 @@\n-    Teapot(NativeScope scope) {\n+    Teapot(SegmentAllocator allocator) {\n@@ -707,1 +738,1 @@\n-        var pos = scope.allocateArray(C_FLOAT, new float[] {0.0f, 15.0f, -15.0f, 0});\n+        var pos = allocator.allocateArray(C_FLOAT, new float[] {0.0f, 15.0f, -15.0f, 0});\n@@ -709,1 +740,1 @@\n-        var spec = scope.allocateArray(C_FLOAT, new float[] {1, 1, 1, 0});\n+        var spec = allocator.allocateArray(C_FLOAT, new float[] {1, 1, 1, 0});\n@@ -713,1 +744,1 @@\n-        var shini = scope.allocate(C_FLOAT, 113);\n+        var shini = allocator.allocate(C_FLOAT, 113);\n@@ -736,2 +767,3 @@\n-        try (var scope = NativeScope.unboundedScope()) {\n-            var argc = scope.allocate(C_INT, 0);\n+        try (var scope = ResourceScope.newConfinedScope()) {\n+            var allocator = SegmentAllocator.ofScope(scope);\n+            var argc = allocator.allocate(C_INT, 0);\n@@ -742,1 +774,1 @@\n-            var teapot = new Teapot(scope);\n+            var teapot = new Teapot(allocator);\n@@ -758,1 +790,1 @@\n-java -XstartOnFirstThread -Dforeign.restricted=permit --add-modules jdk.incubator.foreign \\\n+java -XstartOnFirstThread --enable-native-access=ALL-UNNAMED --add-modules jdk.incubator.foreign \\\n@@ -840,0 +872,1 @@\n+import org.tensorflow.*;\n@@ -845,1 +878,1 @@\n-        System.out.println(\"TensorFlow C library version: \" + toJavaStringRestricted(TF_Version()));\n+        System.out.println(\"TensorFlow C library version: \" + toJavaString(TF_Version()));\n@@ -852,1 +885,2 @@\n-        try (var scope = NativeScope.unboundedScope()) {\n+        try (var scope = ResourceScope.newConfinedScope()) {\n+            var allocator = SegmentAllocator.ofScope(scope);\n@@ -858,1 +892,1 @@\n-            var tags = scope.allocate(C_POINTER, toCString(\"serve\", scope));\n+            var tags = allocator.allocate(C_POINTER, toCString(\"serve\", scope));\n@@ -863,1 +897,1 @@\n-                    toJavaStringRestricted(TF_Message(status)));\n+                    toJavaString(TF_Message(status)));\n@@ -869,1 +903,1 @@\n-            var size = scope.allocate(C_LONG_LONG);\n+            var size = allocator.allocate(C_LONG_LONG);\n@@ -873,2 +907,2 @@\n-                    toJavaStringRestricted(TF_OperationName(operation)),\n-                    toJavaStringRestricted(TF_OperationOpType(operation)));\n+                    toJavaString(TF_OperationName(operation)),\n+                    toJavaString(TF_OperationOpType(operation)));\n@@ -891,1 +925,1 @@\n-java -Dforeign.restricted=permit --add-modules jdk.incubator.foreign \\\n+java --enable-native-access=ALL-UNNAMED --add-modules jdk.incubator.foreign \\\n@@ -916,0 +950,1 @@\n+import org.unix.*;\n@@ -919,2 +954,3 @@\n-        try (NativeScope scope = NativeScope.unboundedScope()) {\n-            var now = scope.allocate(C_LONG, System.currentTimeMillis() \/ 1000);\n+        try (var scope = ResourceScope.newConfinedScope()) {\n+            var allocator = SegmentAllocator.ofScope(scope);\n+            var now = allocator.allocate(C_LONG, System.currentTimeMillis() \/ 1000);\n@@ -935,1 +971,1 @@\n-java -Dforeign.restricted=permit --add-modules jdk.incubator.foreign PanamaTime.java\n+java --enable-native-access=ALL-UNNAMED --add-modules jdk.incubator.foreign PanamaTime.java\n@@ -964,0 +1000,1 @@\n+import org.llvm.clang.*;\n@@ -967,1 +1004,1 @@\n-        String str = toJavaStringRestricted(clang_getCString(clangStr));\n+        String str = toJavaString(clang_getCString(clangStr));\n@@ -978,1 +1015,1 @@\n-        try (var scope = NativeScope.unboundedScope()) {\n+        try (var scope = ResourceScope.newConfinedScope()) {\n@@ -985,1 +1022,1 @@\n-            var visitor = new MemorySegment[1];\n+            var visitor = new MemoryAddress[1];\n@@ -988,1 +1025,1 @@\n-            visitor[0] = clang_visitChildren$visitor.allocate((cursor, parent, data) -> {\n+            visitor[0] = CXCursorVisitor.allocate((cursor, parent, data) -> {\n@@ -990,2 +1027,2 @@\n-                var name = asJavaString(clang_getCursorSpelling(cursor));\n-                var kindName = asJavaString(clang_getCursorKindSpelling(kind));\n+                var name = asJavaString(clang_getCursorSpelling(scope, cursor));\n+                var kindName = asJavaString(clang_getCursorKindSpelling(scope, kind));\n@@ -993,1 +1030,1 @@\n-                var type = clang_getCursorType(cursor);\n+                var type = clang_getCursorType(scope, cursor);\n@@ -995,1 +1032,1 @@\n-                    var typeName = asJavaString(clang_getTypeSpelling(type));\n+                    var typeName = asJavaString(clang_getTypeSpelling(scope, type));\n@@ -1009,1 +1046,1 @@\n-            var root = clang_getTranslationUnitCursor(tu);\n+            var root = clang_getTranslationUnitCursor(scope, tu);\n@@ -1024,1 +1061,3 @@\n-java -Dforeign.restricted=permit --add-modules jdk.incubator.foreign \\\n+java --enable-native-access=ALL-UNNAMED \\\n+    -Djava.library.path=${LIBCLANG_HOME}\/lib \\\n+    --add-modules jdk.incubator.foreign \\\n","filename":"doc\/panama_jextract.md","additions":118,"deletions":79,"binary":false,"changes":197,"status":"modified"}]}