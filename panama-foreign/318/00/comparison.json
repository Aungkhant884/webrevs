{"files":[{"patch":"@@ -281,0 +281,1 @@\n+        checkValidState();\n@@ -298,0 +299,1 @@\n+        checkValidState();\n@@ -301,4 +303,0 @@\n-        closeNoCheck();\n-    }\n-\n-    private final void closeNoCheck() {\n","filename":"src\/jdk.incubator.foreign\/share\/classes\/jdk\/internal\/foreign\/AbstractMemorySegmentImpl.java","additions":2,"deletions":4,"binary":false,"changes":6,"status":"modified"},{"patch":"@@ -105,1 +105,0 @@\n-        checkValidState();\n@@ -122,1 +121,0 @@\n-        checkValidState();\n@@ -135,1 +133,0 @@\n-        checkValidState();\n","filename":"src\/jdk.incubator.foreign\/share\/classes\/jdk\/internal\/foreign\/MemoryScope.java","additions":0,"deletions":3,"binary":false,"changes":3,"status":"modified"},{"patch":"@@ -36,0 +36,1 @@\n+import java.lang.reflect.InvocationTargetException;\n@@ -86,0 +87,16 @@\n+    @Test(dataProvider = \"segmentOperations\")\n+    public void testOpAfterClose(SegmentMember member) throws Throwable {\n+        MemorySegment segment = MemorySegment.allocateNative(4);\n+        segment.close();\n+        try {\n+            Object o = member.method.invoke(segment, member.params);\n+            assertFalse(member.isConfined());\n+        } catch (InvocationTargetException ex) {\n+            assertTrue(member.isConfined());\n+            Throwable target = ex.getTargetException();\n+            assertTrue(target instanceof NullPointerException ||\n+                          target instanceof UnsupportedOperationException ||\n+                          target instanceof IllegalStateException);\n+        }\n+    }\n+\n","filename":"test\/jdk\/java\/foreign\/TestSegments.java","additions":17,"deletions":0,"binary":false,"changes":17,"status":"modified"}]}