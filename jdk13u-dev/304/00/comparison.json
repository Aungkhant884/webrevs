{"files":[{"patch":"@@ -540,0 +540,1 @@\n+\n@@ -541,1 +542,2 @@\n-  LIBHARFBUZZ_LIBS := $(HARFBUZZ_LIBS)\n+  LIBFONTMANAGER_EXTRA_SRC =\n+  BUILD_LIBFONTMANAGER_FONTLIB += $(HARFBUZZ_LIBS)\n@@ -543,0 +545,1 @@\n+  LIBFONTMANAGER_EXTRA_SRC = libharfbuzz\n@@ -545,7 +548,0 @@\n-  # This is better than adding EXPORT_ALL_SYMBOLS\n-  ifneq ($(filter $(TOOLCHAIN_TYPE), gcc clang), )\n-    HARFBUZZ_CFLAGS += -DHB_EXTERN=__attribute__\\(\\(visibility\\(\\\"default\\\"\\)\\)\\)\n-  else ifeq ($(TOOLCHAIN_TYPE), microsoft)\n-    HARFBUZZ_CFLAGS += -DHB_EXTERN=__declspec\\(dllexport\\)\n-  endif\n-\n@@ -554,2 +550,2 @@\n-                      -DHAVE_SYSCONF -DHAVE_SYS_MMAN_H -DHAVE_UNISTD_H \\\n-                      -DHB_NO_PRAGMA_GCC_DIAGNOSTIC\n+                       -DHAVE_SYSCONF -DHAVE_SYS_MMAN_H -DHAVE_UNISTD_H \\\n+                       -DHB_NO_PRAGMA_GCC_DIAGNOSTIC\n@@ -566,5 +562,0 @@\n-  ifeq ($(call isTargetOs, macosx), false)\n-    LIBHARFBUZZ_EXCLUDE_FILES += harfbuzz\/hb-coretext.cc\n-  endif\n-  # hb-ft.cc is not presently needed, and requires freetype 2.4.2 or later.\n-  LIBHARFBUZZ_EXCLUDE_FILES += harfbuzz\/hb-ft.cc\n@@ -572,7 +563,4 @@\n-  LIBHARFBUZZ_CFLAGS += $(HARFBUZZ_CFLAGS)\n-\n-  # For use by libfontmanager:\n-  ifeq ($(call isTargetOs, windows), true)\n-    LIBHARFBUZZ_LIBS := $(SUPPORT_OUTPUTDIR)\/native\/$(MODULE)\/libharfbuzz\/harfbuzz.lib\n-  else\n-    LIBHARFBUZZ_LIBS := -lharfbuzz\n+  # Early re-canonizing has to be disabled to workaround an internal XlC compiler error\n+  # when building libharfbuzz\n+  ifeq ($(call isTargetOs, aix), true)\n+    HARFBUZZ_CFLAGS += -qdebug=necan\n@@ -581,37 +569,2 @@\n-  LIBHARFBUZZ_EXTRA_HEADER_DIRS := \\\n-    libharfbuzz\/hb-ucdn \\\n-    #\n-\n-  LIBHARFBUZZ_OPTIMIZATION := HIGH\n-\n-  LIBHARFBUZZ_CFLAGS += $(X_CFLAGS) -DLE_STANDALONE -DHEADLESS\n-\n-  $(eval $(call SetupJdkLibrary, BUILD_LIBHARFBUZZ, \\\n-      NAME := harfbuzz, \\\n-      EXCLUDE_FILES := $(LIBHARFBUZZ_EXCLUDE_FILES), \\\n-      TOOLCHAIN := TOOLCHAIN_LINK_CXX, \\\n-      CFLAGS := $(CFLAGS_JDKLIB) $(LIBHARFBUZZ_CFLAGS), \\\n-      CXXFLAGS := $(CXXFLAGS_JDKLIB) $(LIBHARFBUZZ_CFLAGS), \\\n-      OPTIMIZATION := $(LIBHARFBUZZ_OPTIMIZATION), \\\n-      CFLAGS_windows = -DCC_NOEX, \\\n-      EXTRA_HEADER_DIRS := $(LIBHARFBUZZ_EXTRA_HEADER_DIRS), \\\n-      WARNINGS_AS_ERRORS_xlc := false, \\\n-      DISABLED_WARNINGS_gcc := type-limits missing-field-initializers strict-aliasing, \\\n-      DISABLED_WARNINGS_CXX_gcc := reorder delete-non-virtual-dtor strict-overflow \\\n-        maybe-uninitialized class-memaccess, \\\n-      DISABLED_WARNINGS_clang := unused-value incompatible-pointer-types \\\n-        tautological-constant-out-of-range-compare int-to-pointer-cast \\\n-        undef missing-field-initializers, \\\n-      DISABLED_WARNINGS_microsoft := 4267 4244 4090 4146 4334 4819 4101 4068 4805 4138, \\\n-      LDFLAGS := $(LDFLAGS_JDKLIB) \\\n-        $(call SET_SHARED_LIBRARY_ORIGIN), \\\n-      LDFLAGS_unix := -L$(INSTALL_LIBRARIES_HERE), \\\n-      LDFLAGS_aix := -Wl$(COMMA)-berok, \\\n-      LIBS := $(BUILD_LIBHARFBUZZ), \\\n-      LIBS_unix := $(LIBM) $(LIBCXX), \\\n-      LIBS_macosx := -framework CoreText -framework CoreFoundation -framework CoreGraphics, \\\n-      LIBS_windows := user32.lib, \\\n-  ))\n-\n-  ifeq ($(FREETYPE_TO_USE), bundled)\n-    $(BUILD_LIBHARFBUZZ): $(BUILD_LIBFREETYPE)\n+  ifeq ($(call isTargetOs, macosx), false)\n+    LIBFONTMANAGER_EXCLUDE_FILES += libharfbuzz\/hb-coretext.cc\n@@ -619,0 +572,17 @@\n+  # hb-ft.cc is not presently needed, and requires freetype 2.4.2 or later.\n+  LIBFONTMANAGER_EXCLUDE_FILES += libharfbuzz\/hb-ft.cc\n+\n+  HARFBUZZ_DISABLED_WARNINGS_gcc := type-limits missing-field-initializers strict-aliasing\n+  HARFBUZZ_DISABLED_WARNINGS_CXX_gcc := reorder delete-non-virtual-dtor strict-overflow \\\n+       maybe-uninitialized class-memaccess\n+  HARFBUZZ_DISABLED_WARNINGS_clang := unused-value incompatible-pointer-types \\\n+       tautological-constant-out-of-range-compare int-to-pointer-cast \\\n+       undef missing-field-initializers\n+  HARFBUZZ_DISABLED_WARNINGS_microsoft := 4267 4244 4090 4146 4334 4819 4101 4068 4805 4138\n+  HARFBUZZ_DISABLED_WARNINGS_C_solstudio := \\\n+        E_INTEGER_OVERFLOW_DETECTED \\\n+        E_ARG_INCOMPATIBLE_WITH_ARG_L \\\n+        E_ENUM_VAL_OVERFLOWS_INT_MAX\n+  HARFBUZZ_DISABLED_WARNINGS_CXX_solstudio := \\\n+        truncwarn wvarhidenmem wvarhidemem wbadlkginit identexpected \\\n+        hidevf w_novirtualdescr arrowrtn2 unknownpragma\n@@ -620,1 +590,1 @@\n-  TARGETS += $(BUILD_LIBHARFBUZZ)\n+  LIBFONTMANAGER_CFLAGS += $(HARFBUZZ_CFLAGS)\n@@ -624,1 +594,0 @@\n-###########################################################################\n@@ -628,0 +597,1 @@\n+    libharfbuzz\/hb-ucdn \\\n@@ -635,2 +605,2 @@\n-LIBFONTMANAGER_CFLAGS += $(LIBFREETYPE_CFLAGS) $(HARFBUZZ_FLAGS)\n-BUILD_LIBFONTMANAGER_FONTLIB += $(LIBHARFBUZZ_LIBS) $(LIBFREETYPE_LIBS)\n+LIBFONTMANAGER_CFLAGS += $(LIBFREETYPE_CFLAGS)\n+BUILD_LIBFONTMANAGER_FONTLIB +=  $(LIBFREETYPE_LIBS)\n@@ -638,1 +608,1 @@\n-LIBFONTMANAGER_OPTIMIZATION := HIGH\n+LIBFONTMANAGER_OPTIMIZATION := HIGHEST\n@@ -676,0 +646,1 @@\n+    EXTRA_SRC := $(LIBFONTMANAGER_EXTRA_SRC), \\\n@@ -677,10 +648,6 @@\n-    DISABLED_WARNINGS_gcc := sign-compare unused-function int-to-pointer-cast, \\\n-    DISABLED_WARNINGS_clang := sign-compare, \\\n-    DISABLED_WARNINGS_microsoft := 4018 4146 4244 4996, \\\n-    DISABLED_WARNINGS_C_solstudio = \\\n-        E_INTEGER_OVERFLOW_DETECTED \\\n-        E_ARG_INCOMPATIBLE_WITH_ARG_L \\\n-        E_ENUM_VAL_OVERFLOWS_INT_MAX, \\\n-    DISABLED_WARNINGS_CXX_solstudio := \\\n-        truncwarn wvarhidenmem wvarhidemem wbadlkginit identexpected \\\n-        hidevf w_novirtualdescr arrowrtn2 refmemnoconstr_aggr unknownpragma, \\\n+    DISABLED_WARNINGS_gcc := sign-compare unused-function int-to-pointer-cast $(HARFBUZZ_DISABLED_WARNINGS_gcc), \\\n+    DISABLED_WARNINGS_CXX_gcc := $(HARFBUZZ_DISABLED_WARNINGS_CXX_gcc), \\\n+    DISABLED_WARNINGS_clang := sign-compare $(HARFBUZZ_DISABLED_WARNINGS_clang), \\\n+    DISABLED_WARNINGS_C_solstudio := $(HARFBUZZ_DISABLED_WARNINGS_C_solstudio), \\\n+    DISABLED_WARNINGS_CXX_solstudio := $(HARFBUZZ_DISABLED_WARNINGS_CXX_solstudio), \\\n+    DISABLED_WARNINGS_microsoft := 4018 4996 $(HARFBUZZ_DISABLED_WARNINGS_microsoft), \\\n@@ -694,1 +661,1 @@\n-    LIBS_macosx := -lawt_lwawt, \\\n+    LIBS_macosx := -lawt_lwawt -framework CoreText -framework CoreFoundation -framework CoreGraphics, \\\n@@ -701,4 +668,0 @@\n-ifeq ($(USE_EXTERNAL_HARFBUZZ), false)\n-  $(BUILD_LIBFONTMANAGER): $(BUILD_LIBHARFBUZZ)\n-endif\n-\n","filename":"make\/lib\/Awt2dLibraries.gmk","additions":42,"deletions":79,"binary":false,"changes":121,"status":"modified"}]}