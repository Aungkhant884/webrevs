{"files":[{"patch":"@@ -97,12 +97,0 @@\n-static time_t get_timezone(const struct tm* time_struct) {\n-#if defined(_ALLBSD_SOURCE)\n-  return time_struct->tm_gmtoff;\n-#elif defined(_WINDOWS)\n-  long zone;\n-  _get_timezone(&zone);\n-  return static_cast<time_t>(zone);\n-#else\n-  return timezone;\n-#endif\n-}\n-\n@@ -161,1 +149,0 @@\n-  const time_t zone = get_timezone(&time_struct);\n@@ -163,2 +150,0 @@\n-  \/\/ If daylight savings time is in effect,\n-  \/\/ we are 1 hour East of our time zone\n@@ -168,4 +153,0 @@\n-  time_t UTC_to_local = zone;\n-  if (time_struct.tm_isdst > 0) {\n-    UTC_to_local = UTC_to_local - seconds_per_hour;\n-  }\n@@ -174,2 +155,16 @@\n-  if (utc) {\n-    UTC_to_local = 0;\n+  time_t UTC_to_local = 0;\n+  if (!utc) {\n+#if defined(_WINDOWS)\n+    long zone;\n+    _get_timezone(&zone);\n+    UTC_to_local = static_cast<time_t>(zone);\n+\n+    \/\/ If daylight savings time is in effect,\n+    \/\/ we are 1 hour East of our time zone\n+    if (time_struct.tm_isdst > 0) {\n+      UTC_to_local = UTC_to_local - seconds_per_hour;\n+    }\n+#else\n+    \/\/ tm_gmtoff already includes adjustment for daylight saving\n+    UTC_to_local = -(time_struct.tm_gmtoff);\n+#endif\n","filename":"src\/hotspot\/share\/runtime\/os.cpp","additions":16,"deletions":21,"binary":false,"changes":37,"status":"modified"}]}