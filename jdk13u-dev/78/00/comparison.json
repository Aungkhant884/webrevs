{"files":[{"patch":"@@ -110,1 +110,1 @@\n-                    linkerPath = (options.linkerpath != null) ? options.linkerpath : getWindowsLinkPath();\n+                    linkerPath = (options.linkerpath != null) ? options.linkerpath : getWindowsLinkPath(main);\n@@ -130,0 +130,2 @@\n+\n+        main.printer.printlnVerbose(\"Found linker: \" + linkerPath);\n@@ -162,1 +164,1 @@\n-    private static String getWindowsLinkPath() throws Exception {\n+    private static String getWindowsLinkPath(Main main) throws Exception {\n@@ -169,1 +171,4 @@\n-            e.printStackTrace();\n+            main.printer.printlnVerbose(\"Could not find VC14 or newer version of linker: \" + e.getMessage());\n+            if (main.options.debug) {\n+                e.printStackTrace();\n+            }\n@@ -205,1 +210,1 @@\n-            throw new InternalError(\"Could not read the ProgramFiles(x86) environment variable\");\n+            throw new IllegalStateException(\"Could not read the ProgramFiles(x86) environment variable\");\n@@ -207,1 +212,2 @@\n-        Path vswhere = Paths.get(programFilesX86 + \"\\\\Microsoft Visual Studio\\\\Installer\\\\vswhere.exe\");\n+        String vswherePath = programFilesX86 + \"\\\\Microsoft Visual Studio\\\\Installer\\\\vswhere.exe\";\n+        Path vswhere = Paths.get(vswherePath);\n@@ -209,1 +215,1 @@\n-            return null;\n+            throw new IllegalStateException(\"Could not find \" + vswherePath);\n@@ -223,1 +229,1 @@\n-            throw new InternalError(errorMessage);\n+            throw new IllegalStateException(\"vswhere error: \" + errorMessage);\n@@ -226,1 +232,1 @@\n-        String installationPath = getLines(process.getInputStream()).findFirst().orElseThrow(() -> new InternalError(\"Unexpected empty output from vswhere\"));\n+        String installationPath = getLines(process.getInputStream()).findFirst().orElseThrow(() -> new IllegalStateException(\"Unexpected empty output from vswhere\"));\n@@ -230,1 +236,1 @@\n-            throw new InternalError(vcToolsVersionFilePath.toString() + \" is empty\");\n+            throw new IllegalStateException(vcToolsVersionFilePath.toString() + \" is empty\");\n@@ -235,1 +241,1 @@\n-            throw new InternalError(\"Linker at path \" + linkPath.toString() + \" does not exist\");\n+            throw new IllegalStateException(\"Linker at path \" + linkPath.toString() + \" does not exist\");\n","filename":"src\/jdk.aot\/share\/classes\/jdk.tools.jaotc\/src\/jdk\/tools\/jaotc\/Linker.java","additions":16,"deletions":10,"binary":false,"changes":26,"status":"modified"}]}